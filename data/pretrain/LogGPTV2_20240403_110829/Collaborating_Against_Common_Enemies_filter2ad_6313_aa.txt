title:Collaborating Against Common Enemies
author:Sachin Katti and
Balachander Krishnamurthy and
Dina Katabi
Collaborating Against Common Enemies
Sachin Katti Balachander Krishnamurthy Dina Katabi
MIT
AT&T Labs–Research
MIT
Abstract
This paper presents the ﬁrst wide-scale study of correlated
attacks, i.e., attacks mounted by the same source IP against
diﬀerent networks. Using a large dataset from 1700 in-
trusion detection systems (IDSs), we show that correlated
attacks are prevalent in the current Internet; 20% of all of-
fending sources mount correlated attacks and they account
for more than 40% of all the IDS alerts in our logs. We
also reveal important characteristics of these attacks. Cor-
related attacks appear at diﬀerent networks within a few
minutes of each other, indicating the diﬃculty of warding
oﬀ these attacks by occasional oﬄine exchange of lists of
malicious IP addresses. Furthermore, correlated attacks are
highly targeted. The 1700 IDSs can be divided into small
groups with 4-6 members that do not change with time;
IDSs in the same group experience a large number of corre-
lated attacks, while IDSs in diﬀerent groups see almost no
correlated attacks. Our results have important implications
on collaborative intrusion detection of common attackers.
They show that collaborating IDSs need to exchange alert
information in realtime. Further, exchanging alerts among
the few ﬁxed IDSs in the same correlation group achieves
almost the same beneﬁts as collaborating with all IDSs,
while dramatically reducing the overhead.
1 INTRODUCTION
In this paper, we study correlated attacks, which we de-
ﬁne as attacks mounted by the same source IP against
diﬀerent networks. Currently, about 30,000 new ma-
chines are compromised daily [25], and then used to
launch attacks on other parts of the Internet. In many
cases, the same machines are involved in multiple at-
tacks against diﬀerent networks [25]–i.e., correlated at-
tacks.
In addition to being an Internet phenomenon
worthy of careful study, correlated attacks are impor-
tant for collaborative intrusion detection. The intru-
sion detection system (IDS) at a network can exchange
information about recent alerts and oﬀending IPs with
other IDSs. Future packets from suspicious source IPs
can be ﬂagged to be dropped or scrutinized. Such col-
laboration is most eﬀective when it happens between
networks experiencing correlated attacks.1
We present the ﬁrst large scale empirical investiga-
tion of attack correlation in the Internet. We analyze
logs from 1700 IDS/ﬁrewalls deployed in US and Eu-
rope. Our data is rich; in addition to sanitized logs
from DSHIELD [2] and multiple universities, it con-
tains detailed attack logs from 40 IDSs maintained by
a Tier-1 provider to protect its customer networks. The
logs cover 1-3 months, and a big chunk of the IP ad-
dress space. In contrast to prior work, which has fo-
cused on the design of collaborative intrusion detection
systems [28, 29, 21, 9, 26, 22], we address the following
two questions:
• How prevalent is attack correlation in the current
Internet? Although collaboration to detect com-
mon attackers seems plausible, there is no quan-
tiﬁcation of the potential beneﬁts. Measurements
of the frequency with which diﬀerent networks be-
come victims of a common attacker, the types of
shared attacks, and the quantity of the resulting
IDS alerts are important to gauge whether collab-
oration is worth the eﬀort.
• How can an IDS pick trusted and eﬀective collab-
orators? Allowing IDSs to exchange alerts to col-
laborate against common attackers requires ad-
dressing two issues: overhead and trust. Exchang-
ing alert data with thousands of IDSs in realtime
is a resource intensive task. Hence, an IDS needs
to pick its collaborators intelligently to minimize
the overhead and maximize the utility of the col-
laboration. Furthermore, two networks need to
establish trust before they can exchange IDS data.
Otherwise, a network cannot ensure the informa-
tion it receives is not maliciously manipulated to
make certain IP addresses look as attackers. Also,
it cannot ensure that the information it provides
will not leak internal vulnerabilities to malicious
entities.
Our study results in 4 major ﬁndings.
(a) The extent of attack correlation: Correlated
attacks are prevalent in the Internet; 20% of the of-
USENIX Association
Internet Measurement Conference 2005  
365
fending IP sources attack multiple networks, and these
common attackers are responsible for 40% of the total
alerts in our dataset. Further, shared attackers attack
diﬀerent networks within a few minutes of each other,
emphasizing the advantage of realtime IDS collabora-
tion, as opposed to sharing attack logs oﬄine.
(b) Reducing collaboration overhead by exploit-
ing correlation structure: We analyze the spatial
structure of attack correlation. We discover that the
1700 IDSs in our dataset can be divided into small
groups of 4-6 members (about 0.4% of the IDSs in our
set); IDSs in the same group experience highly cor-
related attacks, whereas IDSs in diﬀerent groups see
uncorrelated attacks. Collaborating with only IDSs in
the same correlation group achieves the same utility
obtained from collaborating with all IDSs, while dra-
matically reducing the collaboration overhead.
The small correlation groups seem to arise from re-
cent attack trends.
In particular, victim sites in the
same group may be on a single hit list, or might be
natural targets of a particular exploit like the Santy
worm which attacked popular phpBB discussion fo-
rums scoured from search engines. We examined the
correlated attacks in each group for cases where full at-
tack details are available. Indeed, each group seems to
be characterized by a speciﬁc attack type, e.g., there
are SMTP groups, NT groups, IIS groups. This in-
dicates that targeted attacks create small correlation
groups of sites that run particular software/services.
(c) Scalable Trust Establishment: Our measure-
ments reveal that correlation groups are fairly stable
and their membership persists for the duration of the
dataset (1-3 months). Thus, each network needs to col-
laborate with only 4-6 ﬁxed networks in its group. The
small number of IDSs in a group and their persistent
membership allows a network to check their credibility
oﬄine and establish trust using an out-of-band mech-
anism such as legal contracts or reputation.
A network still needs to learn who is in its correlation
group. This service can be provided by a few trusted
nonproﬁt organizations, like CERT [1] and DSHIELD
[2], or commercial entities. They receive sanitized alert
data, (containing only time and oﬀending source IP),
from participating networks, analyze it for attack cor-
relation, and inform the participating networks about
others in their correlation group. The process is scal-
able because correlation groups are persistent for long
intervals (months) and do not need frequent updates.
Indeed, DSHIELD already has the means to provide
this service to its participant networks.
(d) The importance of picking the right col-
laborators: We provide rough estimates of the over-
head and detection capability obtained via diﬀerent
choices of collaborating IDSs. We focus on collabo-
ration to quickly blacklist malicious IP sources. Using
a trace driven simulation, we compare the following
schemes: (1) correlation-based collaboration (CBC),
where each IDS collaborates with only IDSs in its cor-
relation group; (2) random collaborators, where an IDS
collaborates with the same number of IDSs in its corre-
lation group but picks the identity of its collaborators
randomly.
(3) local detection with no collaboration;
(4) collaboration with all IDSs in the dataset;
The results of our evaluation emphasize the impor-
tance of picking the right collaborators. Mainly:
• CBC has almost as good detection capability as
collaborating with all IDSs, but generates less
than 0.3% of the traﬃc overhead. It detects 95%
of the attackers detected by collaborating with
all IDSs and reduces alert volumes by nearly the
same amount.
• In comparison with local detection, CBC increases
the number of detected common attackers at an
IDS by 30% and speeds up blacklisting for about
75% of the common attackers. As a result of
the blacklisting, correlation-based collaboration
reduces the size of the log that the administra-
tor has to examine by an additional 38%.
• Replacing the IDSs in the correlation group by
random collaborators reduces the detection capa-
bilities dramatically and does not add much be-
yond local detection.
Table 1 deﬁnes the terms used in this paper.
2 DATASET AND METHOD
2.1 Dataset
Our dataset is both large and rich. We use logs col-
lected at 1700 diﬀerent IDSs deployed in US and Eu-
rope. Our logs can be divided into 3 distinct sets based
on their origin: (1) 40 IDSs on diﬀerent networks in a
Tier-1 ISP; (2) DSHIELD Logs; (3) University logs.
The logs cover periods of 1-3 months. They span a
relatively large fraction of IP address space.
In ad-
dition to a /8 ISP space, the DSHIELD data contain
logs from many /16 and /24 networks. This is the ﬁrst
studied dataset of its size that provides detailed alert
information from deployed IDSs in the commercial In-
ternet. Table 2 provides a summary description of the
dataset. A detailed description is below.
(a) ISP Logs: We have logs from 40 IDSs deployed in
a large ISP with a /8 address space. The IDS boxes
protect diﬀerent customer networks and span a large
geographic area, but they are all administered by the
ISP and hence have identical characteristics and signa-
ture sets. The signature set is large and diverse con-
366
Internet Measurement Conference 2005 
USENIX Association
Term
Correlated Attacks
Alert
Correlated IDSs
Correlation Group of IDSs
Correlation Vector of IDS i
Blacklist
Deﬁnition
Two attacks are correlated if they are mounted by the same source IP.
An alarm raised by a sensor when it encounters a suspicious event, e.g. a packet or set of
packets that contain a known exploit.
Two IDSs are said to be correlated if more than 10% of their attacks are correlated.
A set of IDSs whose attacks are highly correlated.
is ~vi = (vi1, ..., vij , ..), where vij = 1 if j ∈ correlation group of i, and otherwise vij = 0.
A list of suspicious IP addresses whose packets are dropped or given unfavorable treatment.
Table 1: Deﬁnitions of terms used in the paper
# of IDSs
Address space
Period
Richness
Avg #alerts/day/IDS
ISP dataset
40
Class A
July 1 - August 30, 2004
Dec. 15, 2004 - Jan. 15, 2005
Detailed alerts,
unanonymized
40000
DSHIELD
1657
5 Class B, 45 Class C and
several smaller networks
Dec. 15, 2004 -
Jan. 15, 2005
Dest. IP addresses
anonymized
15000
University datasets
3
2 Class B, 1 Class C
Dec. 15, 2004 -
Jan. 15, 2005
Detailed alerts,
unanonymized
30000
Table 2: Description of the 3 datasets
a)
ISP Dataset log record
Time
Direction
Source IP
Destination IP
Alert Type
Attack information
Sensor ID
10:00:07
[In]
164.120.83.253
10.0.0.1
RPC:PROTOCOL−EVADE
(tcp,dp=32789,sp=20)
(ABCDEF)
b)
DSHIELD log record
Date
Time
Provider Hash
Alert Count
Source IP
Source port 
Destination IP
Destination port
TCP Flags
2004−12−20
10:00:07
12345678
10
164.120.83.253
20
*.0.0.1
32789
S
Figure 1: Log records for the ISP dataset and the DSHIELD dataset. The ISP dataset also has packet
headers for each log record. The DSHIELD dataset has the destination IP anonymized.
sisting of over 500 diﬀerent alerts. The logs contain full
unanonymized packet headers for all suspicious pack-
ets, as shown in Figure 1a. Hence unlike the DSHIELD
data described below, we have access to the oﬀending
packet as well as the nature of the oﬀense. The logs
cover two separate periods: one period from July 1
to August 30, 2004 and the other from December 15,
2004 to January 15, 2005. The data exhibits a large
amount of variation in the kind of attacks seen (over
100 diﬀerent attack types) as well as the distribution
of attacking IP addresses (over 100000 unique source
addresses) and 40000 alerts/day/IDS.
(b) DSHIELD Logs: DSHIELD is a global repository
set up as a research initiative as part of the SANS insti-
tute. Participating organizations provide IDS/ﬁrewall
logs, which DSHIELD uses for detection and analysis
of new vulnerabilities, and blacklist generation. Since
the IDS systems which participate in DSHIELD em-
ploy widely varying software, DSHIELD uses a mini-
mal record format for its logs and scrubs the high order
8 bits of the destination IP address, as shown in Fig-
ure 1b. The entities participating in DSHIELD vary in
size from several Class B networks to smaller Class C
networks and are distributed throughout the globe [28,
2]. The logs are of substantial size with nearly 15000
alerts/day/IDS. We have collected DSHIELD logs from
1657 IDSs for the period from Dec. 15, 2004 to Jan.
15, 2005 corresponding to the ISP dataset.
(c) University Logs: Finally, we collect a set of logs
from IDS/ﬁrewall systems deployed at 3 universities
U1, U2 and U3. Of these we have access to raw data
complete with packet headers and nature of oﬀense de-
tected in U1. The second university U2 provided us
with logs from running the Bro IDS [19], but with pro-
tected addresses anonymized. The signature set de-
ployed is diﬀerent and the alerts consist mostly of scans
of IP addresses as well as port-scans. The third univer-
sity U3 provided us with ﬁrewall logs which consisted
of blocked connection attempts. The University logs
generate 30000 alerts/day/IDS on the average.
USENIX Association
Internet Measurement Conference 2005  
367
n
o
i
t
c
a
r
F
e
v
i
t
a
u
m
u
C
l
e
c
r
u
o
s
e
m
a
s
m
o
r
f
s
t
r
e
a
f
o
l
 1
 0.95
 0.9
 0.85
 0.8
 0.75
 0.7
 0.65
 0.01
Knee at 10 mins
CDF
 0.1