INSERT INTO geometry_columns VALUES (
'buildings', 'footprint_gid',
'building_area_geom',1, 5, 2, 0);
INSERT INTO geometry_columns VALUES (
'ponds', 'shores_gid',
'pond_geom',1, 11, 2, 0);
INSERT INTO geometry_columns VALUES (
'named_places', 'boundary_gid',
'named_place_geom',1, 5, 2, 0);
INSERT INTO geometry_columns VALUES (
'map_neatlines', 'neatline_gid',
'map_neatline_geom',1, 5, 2, 0);
C.3.2.4 Normalized geometry schema test queries
-- Conformance Item B1
SELECT f_table_name
FROM geometry_columns;
-- Conformance Item B2
SELECT g_table_name
FROM geometry_columns;
-- Conformance Item B3
SELECT storage_type
FROM geometry_columns
WHERE f_table_name = 'streams';
-- Conformance Item B4
SELECT geometry_type
FROM geometry_columns
WHERE f_table_name = 'streams';
-- Conformance Item B5
SELECT coord_dimension
FROM geometry_columns
WHERE f_table_name = 'streams';
-- Conformance Item B6
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. OGC 06-104r4
SELECT srid
FROM geometry_columns
WHERE f_table_name = 'streams';
-- Conformance Item B7
SELECT srtext
FROM SPATIAL_REF_SYS
WHERE SRID = 101;
C.3.3 Geometry types and functions
The scope of this test determines that
a) the database of the test (once inserted) is accessible via the schema defined in this standard;
b) that the functionality defined in this standard is implemented as described.
Table B.4 shows the queries that accomplish the first part of this test.
Table C 4: Queries that accomplish the test of geometry types and functions
ID Functionality Tested Query Description Answer
T1 GEOMETRY_COLUMNS For this test, we will check to see lakes, road_segments, divided_routes,
table/view is created/updated that all of the feature tables are buildings, forests, bridges,
properly represented by entries in the named_places, streams, ponds,
GEOMETRY_COLUMNS map_neatlinesa
table/view.
T2 GEOMETRY_COLUMNS For this test, we will check to see Centerline
table/view is created/updated that the correct geometry column
properly for the streams table is
represented in the
GEOMETRY_COLUMNS
table/view.
T3 GEOMETRY_COLUMNS For this test, we will check to see 2
table/view is created/updated that the correct coordinate
properly dimension for the streams table
is represented in the
GEOMETRY_COLUMNS
table/view.
T4 GEOMETRY_COLUMNS For this test, we will check to see 101b
table/view is created/updated that the correct value of srid for
properly the streams table is represented
in the GEOMETRY_COLUMNS
table/view.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. lxxxix
OGC 06-104r4 Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
ID Functionality Tested Query Description Answer
T5 SPATIAL_REF_SYS table/view For this test, we will check to see 'PROJCS["UTM_ZONE_14N",
is created/updated properly that the correct value of srtext is GEOGCS["World Geodetic System 72",
represented in the DATUM["WGS_72",
SPATIAL_REF_SYS table/view. ELLIPSOID["NWL_10D", 6378135,
298.26]], PRIMEM["Greenwich", 0],
UNIT["Meter", 1.0]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",
500000.0],
PARAMETER["False_Northing", 0.0],
PARAMETER["Central_Meridian", -
99.0], PARAMETER["Scale_Factor",
0.9996],
PARAMETER["Latitude_of_origin",
0.0], UNIT["Meter", 1.0]]'
T6 Dimension(g Geometry) : Integer For this test, we will determine 2
the dimension of Blue Lake.
T7 GeometryType(g Geometry) : For this test, we will determine 'MULTILINESTRING'
String the type of Route 75.
T8 AsText(g Geometry) : String For this test, we will determine 'POLYGON( ( 67 13, 67 18, 59 18, 59
the WKT representation of 13, 67 13) )' c
Goose Island.
T9 AsBinary(g Geometry) : Blob For this test, we will determine 'POLYGON( ( 67 13, 67 18, 59 18, 59
the WKB representation of 13, 67 13) )' c
Goose Island. We will test by
applying AsText to the result of
PolyFromText to the result of
AsBinary.
T10 SRID(g Geometry) : Integer For this test, we will determine 101b
the SRID of Goose Island.
T11 IsEmpty(g Geometry) : Integer For this test, we will determine 0
whether the geometry of a Some commercial SQL
segment of Route 5 is empty. implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T12 IsSimple(g Geometry) : Integer For this test, we will determine 1
whether the geometry of a Some commercial SQL
segment of Blue Lake is simple. implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T13 Boundary(g Geometry) : For this test, we will determine 'LINESTRING( 67 13, 67 18, 59 18, 59
Geometry the boundary of Goose Island. 13, 67 13 )'
or
‗MULTILINESTRING (( 67 13, 67 18,
59 18, 59 13, 67 13 ))'
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. OGC 06-104r4
ID Functionality Tested Query Description Answer
T14 Envelope(g Geometry) : Integer For this test, we will determine ‗POLYGON( ( 59 13, 59 18, 67 18, 67
the envelope of Goose Island. 13, 59 13) )'
T15 X(p Point) : Double Precision For this test we will determine the 44,00
X coordinate of Cam Bridge.
T16 Y(p Point) : Double Precision For this test we will determine the 31,00
Y coordinate of Cam Bridge.
T17 StartPoint(c Curve) : Point For this test, we will determine 'POINT( 0 18 )'
the start point of road
segment 102.
T18 EndPoint(c Curve) : Point For this test, we will determine 'POINT( 44 31 )'
the end point of road
segment 102.
T19 IsClosed(c Curve) : Integer For this test, we will determine 1
the boundary of Goose Island. Some commercial SQL
implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T20 IsRing(c Curve) : Integer For this test, we will determine 1
the boundary of Goose Island. Some commercial SQL
implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T21 Length(c Curve) : Double For this test, we will determine 26,00 (in metres)
Precision the length of road segment 106.
T22 NumPoints(l LineString) : Integer For this test, we will determine 5
the number of points in road
segment 102.
T23 PointN(l LineString, n Integer) : For this test, we will determine 'POINT( 0 18 )'
Point the 1st point in road
segment 102.
T24 Centroid(s Surface) : Point For this test, we will determine 'POINT( 53 15.5 )' d
the centroid of Goose Island.
T25 PointOnSurface(s Surface) : For this test, we will determine a 1
Point point on Goose Islande. Some commercial SQL
implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T26 Area(s Surface) : Double For this test, we will determine 40,00 (square metres)
Precision the area of Goose Island.
T27 ExteriorRing(p Polygon) : For this test, we will determine 'LINESTRING(52 18, 66 23, 73 9, 48
LineString the exterior ring of Blue Lake. 6, 52 18)'
T28 NumInteriorRings(p Polygon) : For this test, we will determine 1
Integer the number of interior rings of
Blue Lake.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. xci
OGC 06-104r4 Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
ID Functionality Tested Query Description Answer
T29 InteriorRingN(p Polygon, n For this test, we will determine 'LINESTRING(59 18, 67 18, 67 13, 59
Integer) : LineString the first interior ring of Blue Lake. 13, 59 18)'
T30 NumGeometries(g For this test, we will determine 2
GeomCollection) : Integer the number of geometries in
Route 75.
T31 GeometryN(g GeomCollection, n For this test, we will determine 'LINESTRING( 16 0, 16 23, 16 48 )'
Integer) : Geometry the second geometry in
Route 75.
T32 IsClosed(mc MultiCurve) : For this test, we will determine if 0
Integer the geometry of Route 75 is Some commercial SQL
closed. implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T33 Length(mc MultiCurve) : Double For this test, we will determine 96,00 (in metres)
Precision the length of Route 75.
T34 Centroid(ms MultiSurface) : Point For this test, we will determine 'POINT( 25 42 )' d
the centroid of the ponds.
T35 PointOnSurface(ms For this test, we will determine a 1
MultiSurface) : Point point on the ponds.e Some commercial SQL
implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T36 Area(ms MultiSurface) : Double For this test, we will determine 8,00 (in square metres)
Precision the area of the ponds.
T37 Equals(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of Goose Island is Some commercial SQL
equal to the same geometry as implementations with type extensibility
constructed from it's WKT systems support only BOOLEAN return
representation. values. Expected test results should be
adjusted accordingly.
T38 Disjoint(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of Route 75 is Some commercial SQL
disjoint from the geometry of implementations with type extensibility
Ashton. systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T39 Touches(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of Cam Stream Some commercial SQL
touches the geometry of Blue implementations with type extensibility
Lake. systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. OGC 06-104r4
ID Functionality Tested Query Description Answer
T40 Within(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of the house at Some commercial SQL
215 Main Street is within Ashton. implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T41 Overlaps(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of Green Forest Some commercial SQL
overlaps the geometry of implementations with type extensibility
Ashton. systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T42 Crosses(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of road Some commercial SQL
segment 101 crosses the implementations with type extensibility
geometry of Route 75. systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T43 Intersects(g1 Geometry, g2 For this test, we will determine if 1
Geometry) : Integer the geometry of road Some commercial SQL
segment 101 intersects the implementations with type extensibility
geometry of Route 75. systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T44 Contains(g1 Geometry, g2 For this test, we will determine if 0
Geometry) : Integer the geometry of Green Forest Some commercial SQL
contains the geometry of Ashton. implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T45 Relate(g1 Geometry, g2 For this test, we will determine if 1
Geometry, PatternMatrix String) : the geometry of Green Forest Some commercial SQL
Integer relates to the geometry of Ashton implementations with type extensibility
using the pattern "TTTTTTTTT". systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T46 Distance(g1 Geometry, g2 For this test, we will determine 12 (in metres)
Geometry) : Double Precision the distance between Cam
Bridge and Ashton.
T47 Intersection(g1 Geometry, g2 For this test, we will determine 'POINT( 52 18 )'
Geometry) : Geometry the intersection between Cam
Stream and Blue Lake.
T48 Difference(g1 Geometry, g2 For this test, we will determine 'POLYGON( ( 56 34, 62 48, 84 48, 84
Geometry) : Geometry the difference between Ashton 42, 56 34) )'
and Green Forest. or
'MULTIPOLYGON( ( 56 34, 62 48, 84
48, 84 42, 56 34) )'c
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. xciii
OGC 06-104r4 Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
ID Functionality Tested Query Description Answer
T49 Union(g1 Geometry, g2 For this test, we will determine 'POLYGON((52 18,66 23,73 9,48 6,52
Geometry) : Integer the union of Blue Lake and 18))'
Goose Island. or
'MULTIPOLYGON((52 18,66 23,73
9,48 6,52 18))' c
T50 SymDifference(g1 Geometry, g2 For this test, we will determine 'POLYGON((52 18,66 23,73 9,48 6,52
Geometry) : Integer the symmetric difference of Blue 18))'
Lake and Goose Island. or
'MULTIPOLYGON((52 18,66 23,73
9,48 6,52 18))' c
T51 Buffer(g Geometry, d Double For this test, we will make a 15 1
Precision) : Geometry mbuffer about Cam Bridge.f Some commercial SQL
implementations with type extensibility
systems support only BOOLEAN return
values. Expected test results should be
adjusted accordingly.
T52 ConvexHull(g Geometry) : For this test, we will determine 'POLYGON((52 18,66 23,73 9,48 6,52
Geometry the convex hull of Blue Lake. 18))'
or
'MULTIPOLYGON((52 18,66 23,73
9,48 6,52 18))'c
a Additional feature tables that are not part of this test will be also be returned if present.
b If SRID 101 already exists, or if the system assigns SRID values, appropriate adjustments should be made in the test suite.
c Polygon rotation is not defined by this standard; actual polygon rotation may be in a clockwise or counter-clockwise direction.
d No specific algorithm is specified for the Centroid function; answers may vary with implementation.
e For this test we will have to uses the Contains function (which we don't test until later).
f This test counts the number of buildings contained in the buffer that is generated. This test only works because we have a single
bridge record, two building records, and we selected the buffer size such that only one of the buildings is contained in the buffer.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved.
Copyright © 2007 Open Geospatial Consortium, Inc. All Rights Reserved. OGC 06-104r4
C.3.3.1 Geometry types and functions schema construction
CREATE TABLE spatial_ref_sys (
srid INTEGER NOT NULL PRIMARY KEY,
auth_name CHARACTER VARYING,
auth_srid INTEGER,
srtext CHARACTER VARYING(2048));
-- Lakes
CREATE TABLE lakes (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
shore POLYGON);
-- Road Segments
CREATE TABLE road_segments (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
aliases CHARACTER VARYING(64),
num_lanes INTEGER,
centerlineLINESTRING);
-- Divided Routes
CREATE TABLE divided_routes (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
num_lanes INTEGER,
centerlines MULTILINESTRING);
-- Forests
CREATE TABLE forests (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
boundary MULTIPOLYGON);
-- Bridges
CREATE TABLE bridges (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
position POINT);
-- Streams
CREATE TABLE streams (
fid INTEGER NOT NULL PRIMARY KEY,
name CHARACTER VARYING(64),
centerline LINESTRING);
-- Buildings
CREATE TABLE buildings (
fid INTEGER NOT NULL PRIMARY KEY,