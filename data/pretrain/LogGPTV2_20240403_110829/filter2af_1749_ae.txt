Luckycat = 0.556T  
Desert Falcons = 0.541T  
Sphinx = 0.487T  
1.php group = 0.351T  
OlympicDestroyer = 0.345T  
Hellsing = 0.243T  
Gravityrat = 0.137T
获得到相关数据后，我们可以做出如下的一些关于未知情况的有意义推断：
  1. 绝大多数常规的APT介于0.35T～4T之间，而高于9T以上则是威胁极高的精英黑客组织的作品。
  2. 关于APT3(Operation Clandestine Wolf)，APT5(Leouncia)APT12(也被称做Etumbot,IXESHE)，APT10(又名CVNX、Stone Panda、MenuPass和POTASSIUM), APT16,APT18(Wekby),APT19(Codoso Team) ,APT29(来自俄罗斯),APT30,APT33(来自伊朗), 可知以上APT组织的攻击能力应该介于DragonFly APT ～ DeputyDog(APT17) 之间[28]，因为根据攻击代码分析及相互组织之间的关联进行推断，攻击能力范围在 0.609T～ 3.502T。
  3. Platinum攻击力高达620.299T，但攻击范围仅限于东南亚，显得很不可思议，是否仍然存在Platinum的变种在其它地区，而这仅仅是因为我们还没发现呢？
  4. 使用0Day漏洞攻击的组织，其攻击力多数在1.8T以上，而大多数可称作定向攻击的水平介于0.1T～1.5T之间。5T~15T的攻击力是实力出众的攻击组织，15T~100T是具有强力国家背景支持的网络攻击力量。100T以上的攻击能力则是具有国家战略意图或是网络战范畴下需要考量的一股军事攻击力量。
  5. 依据量化能力的评估可知，大多数的一般性的攻击事件（广告欺诈，DDOS攻击，僵尸网络，垃圾邮件目标的恶意软件，游戏盗号，盗取信息）的攻击力也都在0.1T～2T之间。所以这部分的所谓高级持续性威胁APT是不能说明其技术上的特殊性及其独到之处的，但同样也不能否认其具有国家力量支持的特点。
  6. 就每一次的攻击性行动而言，很难说清其具有持续性的意图，所以当我们谈论很多APT时也将这些行动加入其中，有些行动显然具有持续性的关注，渗透入侵达成必要目的，例如使用社工技巧配合0Day漏洞来达到精准的攻击投放，但有些所谓的APT演员的行动则不是这样的情况，更多是散网式的尝试性的攻击形式（Advanced Tentative Threat ，ATT），很难说明这样的攻击意向有多大，成功的几率有多高，但这样的行动每天都在发生，且非常高的频率，这也可称为高级尝试性威胁ATT。 
  7. 从攻击力的前30名代表组织来看，美国拥有绝对的顶尖实力处于第一梯队，以Turla，APT28为代表的俄罗斯处于一流水平的第二梯队。值得注意的是朝鲜APT组织处于中等偏上的技术水平，这一点反倒并不印证经济实力等同于网络攻击能力。 
  8. 对以上数据计算平均值s' = 57.47532857 ， 计算标准差σ = sqrt(Σ(s-s')^2/n) = 196.0908065 ，所以对应变异系数 σ/s' = 3.4117，该变异系数的值非常高，说明APT组织之间的攻击能力差异非常之大。对于网络空间安全而言这是显而易见的，各国攻击组织能力差异巨大，经验上看，排名前20%的APT组织是很难防御的，我们希望能够监控后80%的攻击组织是否能维持在一个相对较低的攻击力水平区间，为了衡量这一情况我们引入一个威胁指数 x = 后80%的攻击组织的平均攻击力/9T =3.149894737/9 = 0.34998; 根据以上分析得知，5T以上已经具有非常强的攻击能力，故计算一个临界警报值0.556；所以当威胁指数x >> 0.556时，说明整个网络空间产生的APT攻击事件对安全防御而言处于危险的告警状态，接近~1时，则说明绝大多数APT组织的攻击能力已经大幅度提升，网络对抗进入到新的阶段。
目前APT中的高级的含义，更多是用来区别是否具有国家背景的攻击组织，而不是从技术角度的高级来认定的，所以很难想象，APT中的高级这个词竟是被安全公司自己弄丢了本原的含义。从最初的Stuxnet，Flame，Duqu，APT中的“高级”从来没有被怀疑过，但后续的带有些赚取眼球的各种分析报告中，无限制的使用，慢慢地让这个共识失去了最初应该被定义的含义。当然，就APT本身来说也是用来区分网络战的含义，它告诉相关人员这不是网络战而是一次APT攻击。但终归，安全行业不应该牺牲我们研究的准确性来机会主义地促进推广业务，这会降低行业的技术要求水准。
对高级威胁防御的困惑是，以往针对恶意程序的处理方式都是以时间换空间的，即某一时间点单点受害，获取其相关信息提取样本，通过不断更新在以后的时间当中来保护多点大众。但APT不给你机会，单点受害就功亏一溃。故防御的二十四字方针是：引入终端，顺藤摸瓜，分析入口，关联进程，沙箱防护，危险还原。
而我们强调攻击者具有攻击力的体现，更重要的一个原因是检验我们的防御产品，能否做到针对9T以下的完整的防护，而对高于20T以上的攻击力能否做到预警？
## 沉舟侧畔千帆过 - 最后的问题
从事信息安全工作已经有很多年时间，但APT的定义是最为模糊的一个，它的不够清晰，不利于我们展开防御。我一直思考研究高级威胁本质是否是一个真问题。目前我确信，至少有3个方面会使我们在安全认识上取得进展：
  1. 从最初，我们只关心能否检测目标样本，到开始关心攻击者背后的意图。从高级威胁概念的被提出，再到给高级威胁的攻击能力一个清晰的表述上，进而给攻击能力画出一个基本的大致界限范围是我想做的事情。我虽不知未来是否会有超出1000T的攻击力，因为... 但若有，我也可以有勇气去直视这一事实。
  2. 防御者如何确保具体防御能力有效是存在困惑的，要让检测能力，威胁情报，亦或是可感知等具体的概念落地，必须有实效的测量手段来检验。改造原有攻击样本或是构造新的攻击能力在2T～30T之间的攻击组合，来验证防御体系是否真正有效果，这种方式是最直接的，攻击能力的量化可以起到对防御的检验作用，相比对威胁事件的可感知而言让防御能力变的看得见，是更为重要的事情。 
  3. 对攻击意向的研究将会深刻的影响防御体系设计的最终方向，它将开启一个全新的安全视角，解决什么样的因素导致什么企业遭受潜在的多大攻击力的预测问题，进而动态的进行防御能力的调整。而防御能力更像是场舞台的脚本剧，它是被精心设计出的针对性的“保卫战”。
## 0x06 APT十问
下面这些是研究这个问题过程中产生的一些想法以及看到相关人员对这方面问题的疑问，故一并记下，取其中10个问题回应，仅供大家参考。
**1-**  
Q: 从APT攻击的表象归纳出本质的理论如何保证其正确性？
A：我认为以表面现象及感受到的事件的数据结果来建立理论是错误的，至少是不能因此推导出本因的。
正确的情况是，设定的理论决定你能看到什么表象及什么样的APT问题，APT事件都可以归纳在理论结果当中，本文尝试建立一个认识高级威胁本质的实践的理论框架。当一例攻击事件产生后，它在表象能力上产生的结果就是最后呈现给我们的影响。这个影响与攻击事件相关的直观就是经验性的认定。一个关于APT经验性的直观认定在被规定后的对象就是我们所说的APT事件。而我们经验性的直观认定被包含在实践框架所预设的结果当中。
**2-**  
Q：如果APT问题是价值判断问题，那么价值的标准如何确定？
A：确切的说APT问题是基于价值的综合判断，是主观上对APT素材的认定及攻击者背后意向的肯定。在这一推理过程中，APT素材是相对容易区分的，包括特殊编写的工具或是成熟的流行工具的再次利用。攻击意向的判断基于两点，1）时间上的延续性
2） 被攻击者的范围的设定 。
时间上的延续性是说是否可以肯定攻击者在之前的时间范围内曾发起过攻击。被攻击者的范围的设定是指攻击者仅仅限于某种类型的目标（能源，石油，银行...)
而不是限于整体互联网或局部互联网内无明确目标的攻击。
**3-**  
Q：基于Kill Chain的威胁划分是否有道理，基于这一理论来做APT防御是否可行？
A：Kill Chainc划分了一个攻击者所走的路径，是绝大多数的攻击路径。但没有人能保证攻击者只走这个路径。
划分步骤是分解问题，具体落实工作还要到检测的实体上来，而不是哪一步骤下设置一个检测点。
**4-**  
Q： APT和普通攻击的区别是什么？
A：
APT和普通攻击没有本质区别。从网络安全产生之初到目前大规模网络安全事件突起，APT一直都存在，只是我们没有加以区分。从Stuxnet起人们开始区分这一攻击方式，到目前能慢慢的接受白象一类也属于APT攻击。至此，我们已经能心平气和的去思考这一常见的网络攻击现象。APT是攻击类事件里面的明星，除此外无任何区别。但我们还是可以划分出一个边界来梳理APT情况，以攻击能力+统计目标来考虑，
  1. 重攻击+重目的 = Stuxnet，Duqu.. ； >30T 以上的攻击能力
  2. 轻攻击+重目的 = BlackEnergy，Shamoon；5T～10T之间的攻击能力
  3. 轻攻击+轻目的 = Patchwork，海莲花，非常多APT都是这一类型,准确说是网络间谍行动，介于0.1T ～ 4T之间的攻击能力
  4. 重攻击+轻目的 = 花费很大的资本但却实现很小的目的这很不现实的。
就此还可以继续划分为，武力打击类，间谍刺探类，信息盗取类，而最初我们仅认为是重攻击+重目的+武力打击 => APT
（Stuxnet）到目前接受轻攻击+轻目的+间谍刺探类 ～= APT (Patchwork ... ) 这就是这个APT这个词混乱的原因，
轻攻击+轻目的+间谍刺探类 = target attack
更适合。当我们通过对概念加以精确规定后，我们就可以减轻概念带来的混淆，也使得其他任何想要检查对比这一概念的人易于判断我们是否真正明确澄清了该概念的含义。
**5-**  
Q： APT研究和防御的发展以后会有哪些阶段？
A：
现阶段，只有APT表象对于研究者来说才是真实的被给予的体验，研究者从来没有也不会超越其体验之外的APT攻击事件。确切地说，若APT可被研究，其一切皆是表象。下一个阶段将是对攻击者意向猜解，进而对意向产生的动因进行把握，引导以及转化攻击表象的手段。
**6-**  
Q：采用归纳的方式来总结APT的规律，如何保证这是正确的？
A：对于确定性问题，归纳方式是最好的解决方法，但对于APT这样的问题，不能用明确的概念及定义来描述的问题，归纳本身是不具有绝对说服力的。我们的出发点是演绎方式，我们是在假设激活函数F,攻击意向E一定的条件下,进行归纳总结的。我研究目标具有多个变量，如果不确定其中之一，是没有办法同时讨论这两个变量的。
**7-**  
Q:如何识别更多的APT表象？
A:APT表象问题是外部的，防御系统内部需要有相关的属性去响应这些外部的表象，换句话说如果系统内部不具有相当多的关于每一例APT案例的属性分析，那么很难去识别更多的APT问题。APT表象也分为2大类：1）重复性的利用；2）创新出来的新表象。对于1）可以使用过往经验来解决，对于2）则需要综合分析判断，以此来增加防御系统的新知识。
**8-**  
Q：当我们谈论APT时更多的是指哪些令人关注的地方？
A：我们谈论APT时更多的是概念直观当中自己所能够接受理解的高级威胁，但实际的情况是从经验直观中所观察到的情况，这里存在着非常大的概念边界的模糊差异。我们关注的是这次的APT是不是超越以往的经验中的案例，并以此来更新自己关于高级威胁的认知。
**9-**  
Q: 如果APT的决定因素仅在于攻击者意向和攻击素材，那如何构造出千变万化的不同形态的攻击能力与攻击组织？
A：构成APT的意向，素材不同，APT表象就会不同，同一因素的构成方式或比例不同，APT表象就不同。刺激APT的因素不同，APT表象也会不同。即便刺激因素相同，但如果刺激的强度不同，APT的表象同样会不同，攻击组织的技术水平参差不齐，即便攻击素材与意向相同最终也很难呈现一样的表象。
**10** -  
Q：对APT的深入研究，最终是否可以取得防御的全面的胜利？
A： 不存在任何完美的成就，一切都在创造之中。我们看不到终点，而只看到走向终点的道路。光辉的顶点尚未到达，细致入微的改进还在继续. - 歌德
## 0x07 附录
详细信息见：
《附录一：主要感染模块~WTR4132.tmp的逆向分析》
《附录二：主要感染模块~WTR4132.tmp攻击载荷部分的逆向分析》
《附录三：通过lnk漏洞加载的～WTR4141.tmp的逆向分析》
《附录四：内核rootkit-MRXNet.sys的逆向分析》
《附录五：关于内核提权漏洞CVE-2010-2743的分析与利用》
《附录六：关于Windows Shell远程代码执行漏洞CVE-2010-2568的分析与利用》
《附录七：关于打印机远程任意代码执行漏洞CVE-2010-2729的分析与利用》
《附录八：关于Windows 计划任务导致内核提权漏洞CVE-2010-3338的分析与利用》
《附录九：ITW 0Day：LNK远程代码执行漏洞（CVE-2017-8464）的简要分析》
《附录十：Symantec赛门铁壳通报的Stuxnet相关信息摘要》
《附录十一：APT高级威胁组织攻击力量化列表》
//--依据文中提出的高级威胁评估模型进行的相关分析报告