connections to a queue manager, grouped by queue.
Each queue accounting message can contain up to 100 records, with every record relating to an
activity performed by the application with respect to a specific queue.
Accounting messages are recorded only for local queues. If an application makes an MQI call against
an alias queue, the accounting data is recorded against the base queue, and, for a remote queue, the
accounting data is recorded against the transmission queue.
Note: As the information relates to MQI operations performed by IBM MQ applications, the information
does not include operations relating to a streaming queue, unless the operation is directly on that queue
by the application.
Related reference
“MQI accounting message data” on page 156
Use this page to view the structure of an MQI accounting message
“Queue accounting message data” on page 167
IBM MQ Monitoring and performance 137
Use this page to view the structure of a queue accounting message
Accounting message format
Accounting messages comprise a set of PCF fields that consist of a message descriptor and message
data.
Message descriptor
• An accounting message MQMD (message descriptor)
Accounting message data
• An accounting message MQCFH (PCF header)
• Accounting message data that is always returned
• Accounting message data that is returned if available
The accounting message MQCFH (PCF header) contains information about the application, and the
interval for which the accounting data was recorded.
Accounting message data comprises PCF parameters that store the accounting information. The content
of accounting messages depends on the message category as follows:
MQI accounting message
MQI accounting message data consists of a number of PCF parameters, but no PCF groups.
Queue accounting message
Queue accounting message data consists of a number of PCF parameters, and in the range 1 through
100 QAccountingData PCF groups.
There is one QAccountingData PCF group for every queue that had accounting data collected. If
an application accesses more than 100 queues, multiple accounting messages are generated. Each
message has the SeqNumber in the MQCFH (PCF header) updated accordingly, and the last message
in the sequence has the Control parameter in the MQCFH specified as MQCFC_LAST.
Accounting information collection
Use queue and queue manager attributes to control the collection of accounting information. You can also
use MQCONNX options to control collection at the connection level.
Controlling the collection of MQI accounting information
Use the queue manager attribute ACCTMQI to control the collection of MQI accounting information.
To change the value of this attribute, use the MQSC command, ALTER QMGR, and specify the parameter
ACCTMQI. Accounting messages are generated only for connections that begin after accounting is
enabled. The ACCTMQI parameter can have the following values:
ON
MQI accounting information is collected for every connection to the queue manager.
OFF
MQI accounting information is not collected. This is the default value.
For example, to enable MQI accounting information collection use the following MQSC command:
ALTER QMGR ACCTMQI(ON)
Queue accounting information
Use the queue attribute ACCTQ and the queue manager attribute ACCTQ to control the collection of queue
accounting information.
To change the value of the queue attribute, use the MQSC command, ALTER QLOCAL, and specify the
parameter ACCTQ. Accounting messages are generated only for connections that begin after accounting
is enabled. Note that changes to this value are only effective for connections to the queue manager that
occur after the change to the attribute.
138 Monitoring and Performance for IBM MQ
The queue attribute ACCTQ can have the following values:
ON
Queue accounting information for this queue is collected for every connection to the queue manager
that opens the queue.
OFF
Queue accounting information for this queue is not collected.
QMGR
The collection of queue accounting information for this queue is controlled according to the value of
the queue manager attribute ACCTQ. This is the default value.
To change the value of the queue manager attribute, use the MQSC command, ALTER QMGR and specify
the parameter ACCTQ. The queue manager attribute ACCTQ can have the following values:
ON
Queue accounting information is collected for queues that have the queue attribute ACCTQ set as
QMGR.
OFF
Queue accounting information is not collected for queues that have the queue attribute ACCTQ set as
QMGR. This is the default value.
NONE
The collection of queue accounting information is disabled for all queues, regardless of the queue
attribute ACCTQ.
If the queue manager attribute, ACCTQ, is set to NONE, the collection of queue accounting information is
disabled for all queues, regardless of the queue attribute ACCTQ.
For example, to enable accounting information collection for the queue, Q1, use the following MQSC
command:
ALTER QLOCAL(Q1) ACCTQ(ON)
To enable accounting information collection for all queues that specify the queue attribute ACCTQ as
QMGR, use the following MQSC command:
ALTER QMGR ACCTQ(ON)
MQCONNX options for controlling accounting information collection
Use the ConnectOpts parameter on the MQCONNX call to modify the collection of both MQI and queue
accounting information at the connection level by overriding the effective values of the queue manager
attributes ACCTMQI and ACCTQ
The ConnectOpts parameter can have the following values:
MQCNO_ACCOUNTING_MQI_ENABLED
If the value of the queue manager attribute ACCTMQI is specified as OFF, MQI accounting is enabled
for this connection. This is equivalent of the queue manager attribute ACCTMQI being specified as ON.
If the value of the queue manager attribute ACCTMQI is not specified as OFF, this attribute has no
effect.
MQCNO_ACCOUNTING_MQI_DISABLED
If the value of the queue manager attribute ACCTMQI is specified as ON, MQI accounting is disabled
for this connection. This is equivalent of the queue manager attribute ACCTMQI being specified as
OFF.
If the value of the queue manager attribute ACCTMQI is not specified as ON, this attribute has no
effect.
IBM MQ Monitoring and performance 139
MQCNO_ACCOUNTING_Q_ENABLED
If the value of the queue manager attribute ACCTQ is specified as OFF, queue accounting is enabled
for this connection. All queues with ACCTQ specified as QMGR, are enabled for queue accounting. This
is equivalent of the queue manager attribute ACCTQ being specified as ON.
If the value of the queue manager attribute ACCTQ is not specified as OFF, this attribute has no effect.
MQCNO_ACCOUNTING_Q_DISABLED
If the value of the queue manager attribute ACCTQ is specified as ON, queue accounting is disabled
for this connection. This is equivalent of the queue manager attribute ACCTQ being specified as OFF.
If the value of the queue manager attribute ACCTQ is not specified as ON, this attribute has no effect.
These overrides are by disabled by default. To enable them, set the queue manager attribute ACCTCONO
to ENABLED. To enable accounting overrides for individual connections use the following MQSC
command:
ALTER QMGR ACCTCONO(ENABLED)
Accounting message generation when applications disconnect
Accounting messages are generated when an application disconnects from the queue manager.
Intermediate accounting messages are also written for long running IBM MQ applications.
Accounting messages are generated in either of the following ways when an application disconnects:
• The application issues an MQDISC call
• The queue manager recognises that the application has terminated
Intermediate accounting messages are written for long running IBM MQ applications when the interval
since the connection was established or since the last intermediate accounting message that was
written exceeds the configured interval. The queue manager attribute, ACCTINT, specifies the time,
in seconds, after which intermediate accounting messages can be automatically written. Accounting
messages are generated only when the application interacts with the queue manager, so applications
that remain connected to the queue manager for long periods without executing MQI requests do not
generate accounting messages until the execution of the first MQI request following the completion of the
accounting interval.
The default accounting interval is 1800 seconds (30 minutes). For example, to change the accounting
interval to 900 seconds (15 minutes) use the following MQSC command:
ALTER QMGR ACCTINT(900)
Statistics messages
Statistics messages record information about the activities occurring in an IBM MQ system. An statistics
messages is a PCF message that contains a number of PCF structures.
Statistics messages are delivered to the system queue (SYSTEM.ADMIN.STATISTICS.QUEUE) at
configured intervals, whenever there is some activity.
Statistics messages are in the following categories:
MQI statistics messages
MQI statistics messages contain information relating to the number of MQI calls made during a
configured interval. For example, the information can include the number of MQI calls issued by a
queue manager.
Queue statistics messages
Queue statistics messages contain information relating to the activity of a queue during a configured
interval. The information includes the number of messages put on, and retrieved from, the queue, and
the total number of bytes processed by a queue.
140 Monitoring and Performance for IBM MQ
Each queue statistics message can contain up to 100 records, with each record relating to the activity
per queue for which statistics were collected.
Statistics messages are recorded only for local queues. If an application makes an MQI call against
an alias queue, the statistics data is recorded against the base queue, and, for a remote queue, the
statistics data is recorded against the transmission queue.
Channel statistics messages
Channel statistics messages contain information relating to the activity of a channel during a
configured interval. For example the information might be the number of messages transferred by
the channel, or the number of bytes transferred by the channel.
Each channel statistics message contains up to 100 records, with each record relating to the activity
per channel for which statistics were collected.
Note: As the information relates to activities occurring in an IBM MQ system, the information does include
operations relating to streaming queues.
Related reference
“Controlling MQI statistics collection” on page 142
Use the queue manager attribute STATMQI to control the collection of MQI statistics information.
“Controlling queue statistics collection” on page 142
Use the queue attribute STATQ and the queue manager attribute STATQ to control the collection of queue
statistics information
“Controlling channel statistics collection” on page 143
Use the channel attribute STATCHL to control the collection of channel statistics information. You can also
set queue manager attributes to control information collection.
Statistics messages format
Statistics messages comprise a set of PCF fields that consist of a message descriptor and message data.
Message descriptor
• A statistics message MQMD (message descriptor)
Accounting message data
• A statistics message MQCFH (PCF header)
• Statistics message data that is always returned
• Statistics message data that is returned if available
The statistics message MQCFH (PCF header) contains information about the interval for which the
statistics data was recorded.
Statistics message data comprises PCF parameters that store the statistics information. The content of
statistics messages depends on the message category as follows:
MQI statistics message
MQI statistics message data consists of a number of PCF parameters, but no PCF groups.
Queue statistics message
Queue statistics message data consists of a number of PCF parameters, and in the range 1 through
100 QStatisticsData PCF groups.
There is one QStatisticsData PCF group for every queue was active in the interval. If more than 100
queues were active in the interval, multiple statistics messages are generated. Each message has the
SeqNumber in the MQCFH (PCF header) updated accordingly, and the last message in the sequence
has the Control parameter in the MQCFH specified as MQCFC_LAST.
Channel statistics message
Channel statistics message data consists of a number of PCF parameters, and in the range 1 through
100 ChlStatisticsData PCF groups.
IBM MQ Monitoring and performance 141
There is one ChlStatisticsData PCF group for every channel that was active in the interval. If more than
100 channels were active in the interval, multiple statistics messages are generated. Each message
has the SeqNumber in the MQCFH (PCF header) updated accordingly, and the last message in the
sequence has the Control parameter in the MQCFH specified as MQCFC_LAST.
Statistics information collection
Use queue, queue manager, and channel attributes to control the collection of statistics information
Controlling MQI statistics collection
Use the queue manager attribute STATMQI to control the collection of MQI statistics information.
To change the value of this attribute, use the MQSC command, ALTER QMGR and specify the parameter
STATMQI. Statistics messages are generated only for queues that are opened after statistics collection
has been enabled. The STATMQI parameter can have the following values:
ON
MQI statistics information is collected for every connection to the queue manager.
OFF
MQI statistics information is not collected. This is the default value.
For example, to enable MQI statistics information collection use the following MQSC command:
ALTER QMGR STATMQI(ON)
Controlling queue statistics collection
Use the queue attribute STATQ and the queue manager attribute STATQ to control the collection of queue
statistics information
You can enable or disable queue statistics information collection for individual queues or for multiple
queues. To control individual queues, set the queue attribute STATQ. You enable or disable queue
statistics information collection at the queue manager level by using the queue manager attribute STATQ.
For all queues that have the queue attribute STATQ specified with the value QMGR, queue statistics
information collection is controlled at the queue manager level.
Queue statistics are incremented only for operations using IBM MQ MQI Object Handles that were opened
after statistics collection has been enabled.
Queue Statistics messages are generated only for queues for which statistics data has been collected in
the previous time period.
The same queue can have several put operations and get operations through several Object Handles.
Some Object Handles might have been opened before statistics collection was enabled, but others were
opened afterwards. Therefore, it is possible for the queue statistics to record the activity of some put
operations and get operations, and not all.
To ensure that the Queue Statistics are recording the activity of all applications, you must close and
reopen new Object Handles on the queue, or queues, that you are monitoring. The best way to achieve
this, is to end and restart all applications after enabling statistics collection.
To change the value of the queue attribute STATQ, use the MQSC command, ALTER QLOCAL and specify
the parameter STATQ. The queue attribute STATQ can have the following values:
ON
Queue statistics information is collected for every connection to the queue manager that opens the
queue.
OFF
Queue statistics information for this queue is not collected.
QMGR
The collection of queue statistics information for this queue is controlled according to the value of the
queue manager attribute, STATQ. This is the default value.
142 Monitoring and Performance for IBM MQ
To change the value of the queue manager attribute STATQ, use the MQSC command, ALTER QMGR and
specify the parameter STATQ. The queue manager attribute STATQ can have the following values:
ON
Queue statistics information is collected for queues that have the queue attribute STATQ set as QMGR
OFF
Queue statistics information is not collected for queues that have the queue attribute STATQ set as
QMGR. This is the default value.
NONE
The collection of queue statistics information is disabled for all queues, regardless of the queue
attribute STATQ.
If the queue manager attribute STATQ is set to NONE, the collection of queue statistics information is
disabled for all queues, regardless of the queue attribute STATQ.
For example, to enable statistics information collection for the queue, Q1, use the following MQSC
command:
ALTER QLOCAL(Q1) STATQ(ON)
To enable statistics information collection for all queues that specify the queue attribute STATQ as QMGR,
use the following MQSC command:
ALTER QMGR STATQ(ON)
Controlling channel statistics collection
Use the channel attribute STATCHL to control the collection of channel statistics information. You can also
set queue manager attributes to control information collection.
You can enable or disable channel statistics information collection for individual channels, or for multiple
channels. To control individual channels, you must set the channel attribute STATCHL to enable or
disable channel statistic information collection. To control many channels together, you enable or disable
channel statistics information collection at the queue manager level by using the queue manager attribute
STATCHL. For all channels that have the channel attribute STATCHL specified with the value QMGR,
channel statistics information collection is controlled at the queue manager level.
Automatically defined cluster-sender channels are not IBM MQ objects, so do not have attributes in the
same way as channel objects. To control automatically defined cluster-sender channels, use the queue
manager attribute STATACLS. This attribute determines whether automatically defined cluster-sender
channels within a queue manager are enabled or disabled for channel statistics information collection.
You can set channel statistics information collection to one of the three monitoring levels: low, medium or
high. You can set the monitoring level at either object level or at the queue manager level. The choice of
which level to use is dependent on your system. Collecting statistics information data might require some
instructions that are relatively expensive computationally, so to reduce the impact of channel statistics
information collection, the medium and low monitoring options measure a sample of the data at regular
intervals rather than collecting data all the time. Table 22 on page 143 summarizes the levels available
with channel statistics information collection:
Table 22. Detail level of channel statistics information collection
Level Description Usage
Low Measure a small sample of the data, at For objects that process a high volume of
regular intervals. messages.
Medium Measure a sample of the data, at regular For most objects.
intervals.
IBM MQ Monitoring and performance 143
Table 22. Detail level of channel statistics information collection (continued)
Level Description Usage
High Measure all data, at regular intervals. For objects that process only a few messages
per second, on which the most current
information is important.
To change the value of the channel attribute STATCHL, use the MQSC command, ALTER CHANNEL and
specify the parameter STATCHL.
To change the value of the queue manager attribute STATCHL, use the MQSC command, ALTER QMGR and
specify the parameter STATCHL.
To change the value of the queue manager attribute STATACLS, use the MQSC command, ALTER QMGR
and specify the parameter STATACLS.
The channel attribute, STATCHL, can have the following values:
LOW
Channel statistics information is collected with a low level of detail.
MEDIUM
Channel statistics information is collected with a medium level of detail.
HIGH
Channel statistics information is collected with a high level of detail.
OFF
Channel statistics information is not collected for this channel.
QMGR
The channel attribute is set as QMGR. The collection of statistics information for this channel is
controlled by the value of the queue manager attribute, STATCHL.
This is the default value.
On z/OS systems, enabling this parameter simply turns on statistics data collection,
regardless of the value you select. Specifying LOW, MEDIUM, or HIGH makes no difference to your results.
This parameter must be enabled in order to collect channel accounting records.
The queue manager attribute, STATCHL, can have the following values:
LOW
Channel statistics information is collected with a low level of detail, for all channels that have the
channel attribute STATCHL set as QMGR.
MEDIUM
Channel statistics information is collected with a medium level of detail, for all channels that have the
channel attribute STATCHL set as QMGR.
HIGH
Channel statistics information is collected with a high level of detail, for all channels that have the
channel attribute STATCHL set as QMGR.
OFF
Channel statistics information is not collected for all channels that have the channel attribute
STATCHL set as QMGR.
This is the default value.
NONE
The collection of channel statistics information is disabled for all channel, regardless of the channel
attribute STATCHL.
144 Monitoring and Performance for IBM MQ
On z/OS systems, enabling this parameter simply turns on statistics data collection,
regardless of the value you select. Specifying LOW, MEDIUM, or HIGH makes no difference to your results.
This parameter must be enabled in order to collect channel accounting records.
The queue manager attribute, STATACLS, can have the following values:
LOW
Statistics information is collected with a low level of detail for automatically defined cluster-sender
channels.
MEDIUM
Statistics information is collected with a medium level of detail for automatically defined cluster-
sender channels.
HIGH
Statistics information is collected with a high level of detail for automatically defined cluster-sender
channels.
OFF
Statistics information is not collected for automatically defined cluster-sender channels.
QMGR
The collection of statistics information for automatically defined cluster-sender channels is controlled
by the value of the queue manager attribute, STATCHL.
This is the default value.
On z/OS systems, enabling this parameter simply turns on statistics data collection,
regardless of the value you select. Specifying LOW, MEDIUM, or HIGH makes no difference to your results.
This parameter must be enabled in order to collect channel accounting records.
For example, to enable statistics information collection, with a medium level of detail, for the sender
channel QM1.TO.QM2, use the following MQSC command:
ALTER CHANNEL(QM1.TO.QM2) CHLTYPE(SDR) STATCHL(MEDIUM)
To enable statistics information collection, at a medium level of detail, for all channels that specify the