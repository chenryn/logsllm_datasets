4
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:34 UTC from IEEE Xplore.  Restrictions apply. 
signedandtheirauthenticitycanbeveriﬁed.Forexample,DNScachepoisoningattacks(asweknowthemtoday)wouldnotworkbecauseforgedresponsescanbeidentiﬁedanddiscarded.DNSSECseemstobethepanaceaforthevulnerabilitiesofDNS.Unfortunately,althoughDNSSECwasproposedbackinJanuary1997[9],alltheseyearshavenotbeenenoughforittobeadoptedanddeployedinalarge-scale.Thereasonsforthisarecontroversial.Thereseemtobeproblemsrelatedtobothtechnologicaland“political”issues.Fromthetechnologicalpointofview,probablythemainobstaclesofarhasbeentheuseofaNSECresourcerecordthatcanallowzoneenumeration.ThisisviewedbymanyasasecurityproblemforDNSSECandhasonlyrecentlybeensolvedwiththeintroductionofNSEC3[15].Furthermore,keymanagementforDNSSECisfairlycomplex[14].Themainnon-technicalpointofcontroversyderivesfromquestionssuchas,“whoownstherootnameservers?”.ThisisanimportantquestionbecauseDNSSECreliesonachainoftrustthatdependsonsigningzonesandsub-zones,withsigningtherootnameserversbeingtheprincipalanchoroftrust.Ofcourse,differentnationsaroundtheworldhavedifferentopinionsaboutwhoownstherootnameserversandis,therefore,entitletosigntheirzones.Itisnotclearwhentheseproblemswillbesolved,andatthemomentthedeploymentofDNSSECisreducedtoasmallnumberofisolatedislandsoftrust[21].Becausealarge-scaledeploymentofDNSSECmaynotberealizedinthenearfuture,afewalternativetechniquesforprotectingagainstbrute-forcepoisoningattackshavere-centlybeenproposed[7,12,5,11,20].ThesetechniquesarebasedonthecurrentDNSprotocol,andworkbyin-creasingtheentropyofDNSqueriesinordertomakeforg-ingavalidresponsemoredifﬁcult.Forexample,UDPsourceportrandomization[12]wasﬁrstproposedandim-plementedbyBernsteinindjbdns[4],andhasbeenrecentlyimplementedbyothermajorRDNSvendorsinresponsetotheKaminsky’sattack[8].Inpractice,wheneveranRDNSissuesaDNSquery,itselectsthesourceUDPport1fromwhichthequeryissentatrandom.Thistechniquesigniﬁ-cantlyincreasesthehardnessofpoisoningattacksbecausenowtheattackerneedsnotonlytoguesstheTXID,butalsotosendtheforgedresponsestothecorrectUDPport.Un-fortunately,UDPsourceportrandomizationmaynotbeef-fectiveincertainpracticalscenarios.AsigniﬁcantfractionofRDNSresolversaroundtheInternetresidebehindaload-balancerorﬁrewalldevicesthatimplementnetworkaddressandporttranslation(NAT/PAT).Manyofthesedevicesper-formsomeformofporttranslationthatreducestherandom-nessoftheUDPsourceportsgeneratedbyRDNSresolverstoaguessable(e.g.,“roundrobin-like”)useoftheports[8].Suchsettingsarenotuncommon.Forexample,Leonardet1AlthoughDNSqueriesoverTCParepossible,thevastmajorityofqueriesaretransmittedoverUDP.al.showedthat32%ofRDNSresolversintheirstudyusesomesortof“hidden”forwarder[16].ApossiblesolutionwouldbetomovetheRDNSinfrontoftheNAT/PAT,butthismaynotbealwayspossibleoreasytodo,dependingonthespeciﬁcnetworkarchitectureorconﬁguration(forex-ample,achangeinthenetworkarchitecturemayexposetheRDNStootherkindsofattacks,besidecachepoisoning).Dagonetal.[7]recentlyproposedthe0x20-bitencoding,whichusesarandomcombinationoflower-andupper-caseletterstowritedomainnamequeries,andworksindepen-dentlyfromthepresenceofNAT/PATplacedinfrontofRDNSresolvers.Unfortunately,theamountofadditionalentropyintroducedbythe0x20-bitencodingisafunctionofthelengthofthequerieddomainname.Forexample,forshortpopulardomainnameslikehp.com,hi5.com,cnn.com,etc.,the0x20-bitencodingonlyadds5or6bitsofentropy2.Thismakespoisoningattacksalittleharder,butsurelynotinfeasible,asweshowinSection3.5.Sev-eralotherpopulardomainnamesfromthetop500globaldomainsaccordingtoAlexa(alexa.com)containevenlessthan6alphabeticcharactersthatcanbeusedforthe0x20-bitencoding(e.g.,163.com,56.com,126.com,etc.,forwhich0x20-bitencodingoffersonly3additionalbitsofentropy).BernsteinrecentlyproposedDNSCurve[5]asanalter-nativetoDNSSEC.DNSCurveuseshigh-speedelliptic-curvecryptography,andsimpliﬁesthekeymanagementproblemthataffectsDNSSEC.ThemaincriticismagainstDNSCurvecomesfromthefactthatnodetailedspeciﬁ-cationshaveyetbeenwritten(e.g.,intheformofInter-netdraftsorRFCs),andnoimplementationiscurrentlyavailabletothepublic.FromthelimiteddocumentationcurrentlyavailableDNSCurveseemssuperiortoDNSSEC,particularlyintermsofkeymanagement,however,thelatterhasbeenspeciﬁedincompletedetailinseveralRFCs[1,2,3,9],andhasbeenimplementedbymostDNSvendorsandthoroughlytested.Also,similartoDNSSEC,DNSCurvestillrequiressigniﬁcantchangesattherootandtop-level-domain(TLD)nameserversandmaythereforeincursomeofthesame“political”problemsthathavesofarpreventedalarge-scaledeploymentofDNSSEC.Earlier,BernsteinalsoproposedatechniquecalledDNScookies[6],whichmakesuseofwildcardsandTXTrecordstofetchsignedIPad-dresses.ItisworthnotingthatalthoughourWSECDNSsolution(discussedbelow)makesuseofwildcardandTXTrecords,thetechniqueweproposeisverydifferentfromDNScookies.WeuseTXTrecordsonlytoverifyifazoneisorisnotWSEC-enabled,andusewildcardCNAMErecords2Itisworthnotingthatalthoughthesedomainnamesareoftenqueriedusingthepreﬁxwww.(e.g.,www.msn.com),whichwouldadd3morebitsofentropy,Kaminsky-styleattacks[13]canbeinitiatedbyqueriestonon-existentdomainnamesofthetype000.hp.com,001.hp.com,etc.,whichdonotallow0x20tointroduceanyadditionalentropycomparedtothebasedomain.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
5
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:34 UTC from IEEE Xplore.  Restrictions apply. 
forresolvingDNSqueriesinasecureway.Wedonotpro-posetosigntheresponse,insteadweproposetouseaone-timerandomnumber(ornonce)foreachquerytodistin-guishvalidanswersfrombogusones.Furthermore,tothebestofourknowledge,nodetailedspeciﬁcationsorpub-licationsexistforDNScookies,andnoimplementationorexperimentalresultsarepubliclyavailable.Becauseofspaceconstraints,webrieﬂydiscussaddi-tionalnon-publishedrelatedworkinanextendedversionofthispaper[22].1.2Ourcontribution:WSECDNSInthispaperweproposeanovelsolutiontobrute-forceDNScachepoisoningattacksthatisbasedonincreasingtheentropyofDNSqueriestothepointthatcachepoison-ingattacksbecomepracticallyinfeasible.Towardsthisend,wepresentWildcardSECure(WSEC)DNS,anewDNSqueryprocessthatleveragesexistingpropertiesoftheDNSprotocol.OursolutiontakesadvantageofthedeﬁnitionofwildcarddomainnamesgiveninRFC1034[18]andRFC4592[17],andofTXTresourcerecords[19].Inpractice,thebasicideaistowiselyusewildcarddomainnamessothatwecanprependarandomstringtothequerieddo-mainnamesandstillobtainacorrectanswer.Theseran-domstringshavetheeffectofsigniﬁcantlyincreasingtheentropyofDNSqueries,thusmakingvalidanswersdifﬁculttoguess.Contraryto0x20-bitencoding[7],WSECDNSprotectsshortdomainnames(e.g.,hp.com,hi5.com,cnn.com,etc.)aswellaslongerones.Also,WSECDNSprotectsagainstpoisoningattacksindependentlyfromUDPsourceportrandomization.Therefore,eveninthosecaseswhenportrandomizationismadeineffectivebythepres-enceofdevicessuchasloadbalancersorﬁrewallsthatper-formporttranslationwithoutpreservingrandomness[8],WSECDNSstillmakesbrute-forcecachepoisoningattackspracticallyinfeasible.AnimportantadvantageofourapproachisthatDNSop-eratorsarenotobligatedtoimplementoursolution,becauseWSECDNSguaranteescompletebackwardcompatibilitywithcurrentnameserverconﬁgurations.However,recur-siveDNS(RDNS)resolversthatintendtotakeadvantageofthesecuritybeneﬁtsofWSECDNSmustimplementsomenewfunctionalities.Ontheotherhand,collaboratingDNSoperatorswhowanttoprotecttheirdomainnamesagainstpossiblecachepoisoningmustbewillingtomakesimpleconﬁgurationchangestotheirnameservers,byeditingtheirconﬁgurationzone-ﬁlesaccordingtotherecommendationsreportedinthispaper.WSECDNSprovidesawaytoprotectRDNSresolversfrombrute-forcecachepoisoningattacks,includingKamin-sky’sattack[13].Wearguethisisveryimportant,con-sideringtheseriousconsequencesofsuccessfulDNScachepoisoning,andtheuncertaintyaroundwhenDNSSECwillbewidelyadopted.UnlikeDNSSEC,WSECDNSdoesnotneedsupportfrompoliticalinstitutions(whicharein-volvedintheprocessofsigningtherootandtopleveldo-mainnameserversforDNSSEC).Rather,WSECDNSonlyrequirescollaborationbetweenadministratorsofRDNSre-solversandauthoritativenameservers,makingincrementaldeploymentpossibleduetoitsbackwardcompatibility.Wearguethatsupportofincrementaldeploymentisaveryim-portantproperty,becauseupdatingalltheDNSresolversandnameserversaroundtheInternetatonetimeisnotfea-sible.2BackgroundandThreatModelAtraditionalbrute-forceDNScachepoisoningattackscenarioisasfollows.AssumeanattackertriestopoisontheIPaddressofwww.example.com.Theattackerﬁrstsendsaqueryforwww.example.comtotheRDNS,thusforcingittoinitiatetherecursivequeryprocessandinteractwiththeauthoritativenameservers.IftheattackerisabletoguesstheTXIDandsourceUDPport,andsendwell-crafted(spoofed)responsepacketstotheRDNSbeforethelegitimateanswerfromtherealauthoritativenameserverisreceived,theDNSpoisoningattackwillbesuccessful.ThisattackworksbecausetheRDNSwillaccepttheﬁrstvalidansweritreceives.Asaresult,itwillstoretheIPaddress(orotherRRinformation)thattheattackersentinthepos-itivecachefortheentiretimetolive(TTL)chosenbytheattacker.Theconsequenceisthatallclientsusingthatpar-ticularRDNSserverwillsubsequentlyreceivetheattacker’sIPaddresseverytimetheyqueryforwww.example.com.Forexample,everytimetheuserswanttovisitawebpageonthatdomain,theymayberedirectedtotheattacker’sma-liciouswebsite.Thismayexposetheuserstoavarietyofat-tackssuchasinformationtheftormalwareinfection.IftheattackerisnotabletoforgeavalidanswerbeforetherealvalidanswerarrivesattheRDNS,theattackerwillneedtowaituntiltherelatedgenuinecacheentryfortheIPaddressofwww.example.comexpiresbeforeretrying.Recently,DanKaminskydiscoveredaﬂawintheDNSprotocol[13]thatallowsanattackertoperformsuccessfulcachepoisoningattackswithlittleeffort,comparedtothetraditionalpoisoningattack.Duetospaceconstraints,wedeferthedescriptionofKaminsky’sattackto[22].HereitisimportanttonotethatKaminsky’sattackisanotherwayofperformingbrute-forcecachepoisoningagainsttheRDNS.Unlike“traditional”poisoningattacks,thegreatestadvan-tageofKaminsky’sattackisthatifthepoisoningattackdoesnotsucceedattheﬁrsttrial,theattackercanimme-diatelyretry,withouttheneedtowaitfortheTTLofthegenuinecacheentrytoexpire.Thisgreatlyimprovestheprobabilityofsuccessoftheattackinagiventimewindow,asweshowinSection3.5.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
6
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:34 UTC from IEEE Xplore.  Restrictions apply. 
ThreatModelInthisworkweaddressbrute-forceDNScachepoisoningattacks,bothtraditionalandKaminsky’sstyle.Similarlytopreviouswork[12,7],weassumetheattackerdoesnothavevisibilityoftheDNStrafﬁcﬂow-ingfromtheRDNStothelegitimateauthoritativenameserver(iftheattackerhadsuchvisibilitytherewouldbenoneedtolaunchtraditionalorKaminsky’sstylepoisoningat-tacks,becausetherewouldbenothingtoguessandonlyoneforgedpacketwouldbesufﬁcienttopoisonthecache).Atthesametime,weassumetheattackerisabletoforgeDNSresponsesandsendthemtotheRDNSusingaverylargebandwidth3WSECDNSRFC1034requiresthatvalidresponsestoDNSqueriesmustreportacopyofthequerieddomainnameintheques-tionsection.WeproposetotakeadvantageofthissimplepropertyoftheDNSprotocol,andtoleveragetheuseofwildcarddomainnamesasdeﬁnedinRFC1034andRFC4592toincreasetheentropyofDNSqueriesinordertomakebrute-forcecachepoisoningattackspracticallyinfea-sible.Awildcarddomainnameisadomainnamehavingitsinitial(i.e.,leftmostorleastsigniﬁcant)labelbethe“*”character[17].Forexample*.www.example.comisawildcarddomain,where“*”isinterpretedas“anyvalidcombinationofcharacters”.3.1ConﬁgurationRequirementsWSECDNSrequiresnosoftwarechangefornameservers.However,DNSoperatorswhowanttobeneﬁtfromthesecuritypropertiesoftheWSECDNSqueryprocessmustapplysimpleconﬁgurationchangestotheirzone-ﬁles.Azone-ﬁleisaconﬁgurationﬁleusedbyanameservertoloadinformationaboutazone3(e.g.,example.com),anditssubdomains(e.g.,www.example.com,mail.example.com,etc.).Theinformationcarriedbyzone-ﬁlesiswrittenintermsofresourcerecords(RR).Forex-ample,RRsoftypeAareusedtoreportIPaddressesinIPv4format,CNAMERRsareusedfornamealiasing,TXTrecordsareusedtocarrydescriptiveinformationaboutadomainname.Figure1showsanexamplezone-ﬁlethatdescribesthecontent(i.e.,sub-domainsandresourcerecords)ofthezoneexample.com4.Considertheconﬁgurationline:3azonecanbedeﬁnedasaportion,orsub-tree,ofthetree-structureddomainnamedatabase[18].4Noticethattheconﬁgurationlinesmarkedwiththecomment“;WSEC”inFigure1aretheonesthathavebeenaddedtothezone-ﬁleinordertoenableWSECDNSqueries.Itisalsoworthnoticethatthead-ditionalconﬁgurationlinesneededinordertoenableWSECDNSqueriescanbegeneratedautomaticallybywritingasimplescriptwhichtakestheoriginalzoneﬁleininputandfollowsthestepsdescribedabovetoproduceFigure1:ExampleofWSEC-compliantzoneﬁlewrittenusingthesyntaxforBIND9.5(www.isc.org)nameservers.wwwINA10.0.1.6Thistellsthenameserverthatthedomainnamewww.example.comownstheIPaddress10.0.0.6.InordertoenableWSECDNSqueriesforagivenzone(e.g.,thezoneexample.comandallitssub-domains),thefollowingmodiﬁcationsneedtobeappliedtoitsrelatedzone-ﬁle:a)AddtwoTXTresourcerecords(RRs)thatcontainin-formationaboutwhetherWSECqueriesaresupportedornotforthedomainsinthatzone.Forexample,inFigure1thelines:*86400INTXT|wsecdns=enabled|_test_._wsecdns_86400INTXT|wsecdns=enabled|havebeenaddedforthispurpose.Thestring|wsecdns=enabled|isusedtocommunicatethefactthatthezoneexample.comsupportsWSECDNSqueries(the“”charactersintest.wsecdnsareusedtoavoidcollisionswithotherpreexistentnamesinthezone).b)TwoCNAMERRsareintroducedforeachnon-wildcarddomainnameinthezone,.Forexample(seeFigure1),iftheoriginalzone-ﬁlecontainsanRRofanytypeforwww.example.com,theWSEC-compliantversionofthezone-ﬁlemustcontaintwoadditionallinesofthetype:*._wsecdns_.wwwINCNAMEwww*._test_.wsecdns_.wwwINCNAME_test_.wsecdns_thenewWSEC-compliantzoneﬁle.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
7