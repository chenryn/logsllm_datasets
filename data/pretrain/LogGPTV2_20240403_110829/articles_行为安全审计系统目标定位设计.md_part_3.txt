  图5-1涉及的行为审计的方法和内容在具体的应用过程中会有一定的差别，但是其整体思想是统一的，即对信息系统行为审计主要由审计人员人工判断和软件识别的方式综合实现。
信息系统行为审计方法在实施中重点关注的是要通过相关安全技术产品的日志内容对用户行为、策略执行等情况进行分析审查，得出真实有效结论。而在信息系统行为审计管理中，如何将相关安全产品进行有效部署、综合运用，如何根据相关日志进行分析，降低审计日志数据误报、提高审计有效性等，是审计方法实施的难点和细节，应予以重视。
## 行为安全审计过程设计
  根据前面建立的信息系统行为审计业务模型，信息系统行为审计一般可以分为计划阶段、实施阶段、评价阶段和后续阶段。具体过程及阶段任务如图5-2所示。
![C:\\Users\\liys7_000\\Desktop\\行为审计图片\\图4-信息系统行为审计过程.png](media/image6.png){width="5.761111111111111in"
height="1.2173611111111111in"}
[]{#_Toc444091891 .anchor}图5‑2行为安全审计过程
  （1）计划阶段是行为审计过程的起点。合理规范的审计计划有利于帮助审计人员有的放矢去调查、取证，形成正确的审计结论，实现审计目标。计划阶段主要任务包括：了解信息系统基本情况和内部控制措施；确定审计工作的内容和审计重点；编制审计计划以及明确审计方法采集审计数据等。
 （2）实施阶段根据计划阶段确定的范围、重点、步骤和方法，定期或者根据事件触发有针对性的取证、评价，并形成审计结论的过程。主要工作包括：对信息系统安全控制措施进行检查、评价；对用户行为及数据进行判断、检查等。
 （3）评价阶段是审计人员运用专业判断，综合所收集到的相关证据，以经过核实的审计证据为依据，形成审计意见，出具审计报告。审计报告中除了对信息系统的用户行为发表审计意见外，还针对信息系统内部控制和管理等方面提出相关建议。
 （4）在后续阶段中，审计人员对信息系统审计中发现的重大问题和漏洞应持续跟踪，对相关的整改措施进行监督，对整改工作的效果进行检查和评价，并判断审计报告中指出的问题是否得以解决，必要时可以提出在下次审计中予以重点关注。
# 行为安全审计全生命周期管理应用设计
针对信息系统用户行为从制度、技术、管理、检查和整改等方面具体开展行为安全审计管理，具体行为审计管理如图6-1：
![C:\\Users\\liys7_000\\Desktop\\行为审计图片\\图5-行为审计全生命周期管理.png](media/image7.png){width="3.4277777777777776in"
height="2.9854166666666666in"}
[]{#_Toc422355556 .anchor}图6‑1行为安全审计全生命周期管理
（1）在制度要求上，由信息化管理部门组织建设信息系统一级管理制度，涉及系统管理、行为规范和安全审计等，从总体上对信息系统运行管理、行为安全提出具体监管要求；
（2）在策略控制上，信息化管理部门根据一级管理制度细化信息系统安全控制策略，形成并建立有效的符合涉密信息系统管理要求的安全技术防护体系，相关业务部门根据业务实际情况制定部门二级管理制度落实和补充一级管理制度要求，形成补充信息系统安全控制策略，保证信息系统行为监管全面、有效；
（3）在落实监管规范时，信息系统管理人员根据安全控制策略的要求，配置信息系统具体的安全监管防护产品，执行安全控制措施，确保相关安全产品功能有效、监管到位；
（4）在检查分析阶段，信息系统的审计人员根据行为安全审计支撑应用的相关分析功能有针对性地对用户行为实施审计，对突发事件进行快速定位与行为追溯，日常管理形成月度审计报告;
（5）最后，在整改闭环阶段，针对审计中发现的异常行为和安全隐患，系统管理人员对其进行督促整改并调整相应的技术和管理措施，进而从制度、策略和控制上进行补充、优化和完善。
从规范制定、用户执行和监管审计到规范再完善、用户再学习和监管审计再补充的动态管理过程，真正实现了对行为审计工作全生命周期的分段实施、统一管理，确保了审计工作的针对性、全面性和长效性。信息系统行为审计过程的动态调整和完善，也有利于信息系统安全审计管理水平的不断提高。
# 行为安全审计支撑应用目标架构设计
本章主要给出两种不同情况下的行为安全审计支撑应用目标架构设计，一种是不考虑公司已建成安全审计类系统的独立目标架构，另一种是结合S6000、I6000、大数据平台等采集分析类应用的现状架构，在独立目标结构上调整形成的行为安全审计支撑应用的融合目标架构设计。
## 独立目标架构视图
行为安全审计支撑应用基于B/S结构设计，通过在终端计算机中植入代理程序实现桌面管理功能，记录用户行为，存入日志中心、日志中心到大数据平台做数据对接进行离线分析。应用前台使用Web浏览器方式进行操作配置管理和客户端注册，后台通过关系数据库对用户数据加以统计和存储。在不考虑现有采集分析类应用的情况下，独立目标架构图如图7-1所示。
![](media/image8.png){width="5.742361111111111in" height="3.15625in"}
[]{#_Toc444091893 .anchor}图7‑1行为安全审计独立目标架构
（1）安全产品（D1）：接入公司其他安全产品采集的安全信息。通过统一的接口，将安全产品采集的信息进行标准化后接入行为日志中心库。
（2）用户终端代理程序（D2），采集客户端计算机资产信息，检测客户端设备状态行为等信息，执行安全策略管理模块分发的各种管理策略，并将客户端设备违规信息报送给安全策略管理模块。在具体实现的应用功能上，行为审计支撑应用应提供完整的用户行为日志记录功能，包括对用户终端的网络访问、应用系统访问、安全策略设置及执行、系统安全漏洞、违规软件及进程、病毒情况、文档操作、文档打印输出、光驱读写、移动硬盘使用和违规外联等情况进行实时的记录和监控。
（3）行为大数据库(C1)：依托大数据存储组件和技术，存储信息系统和IT基础设施中获取的用户行为日志历史数据，包括结构化日志数据和视频、文本、图片等非结构化数据，用于离线行为数据分析及事后审计。
（4）行为日志中心库（C2）：一个实时数据库，用于存储安全产品及用户终端代理实时采集的信息行为数据，为实时行为数据分析提供数据支撑。
（5）中央身份权限库（C3）：中央身份权限库中存放着公司所有信息系统用户的身份权限信息、应用资源信息，通过中央身份权限库与行为数据进行关联、对比，可以更加精准判断用户行为的合规性。同时通过中央身份权限库，对本应用的进行权限管控，实时行为数据分析时需要确定该操作有相应的权限才可以对行为日志中心库进行读取操作。
（6）基础设施资源库（C4），用于存放所有基础设施的基本信息，包括资产属性、运行属性和安全属性。采用关系型数据库。
（7）管理信息库（C5），用于存放和管理各种策略、系统组件运行参数配置、网络客户端设备信息、补丁及相关信息、报警和日志等各种信息。采用关系型数据库。
（8）分析算法组件（B1）：采用挖掘工具R语言、Mahout等大数据分析挖掘工具，并融合、优化传统数据挖掘算法与分布式挖掘算法构建分布式数据挖掘算法库，支撑处理行为日志历史数据分析挖掘和建模。
（9）搜索组件（B2）：采用全文搜索引擎，实现高效搜索，能根据搜索关键字及搜索条件等快速从海量的数据中发现所要查找的内容，提供丰富的查询语法，支撑实时行为数据分析应用。
（10）代理管理器与扫描器（B3、B4），作为应用数据处理中心，从管理信息库获取来自控制台的各种策略和命令操作，发送到客户端和扫描器后执行。代理管理器接收扫描器的信息和客户端程序提供的各类状态和报警信息，发送至管理信息库，管理人员可通过安全策略管理模块查阅。上级区域和下级区域之间的命令和数据均通过上下级区域管理器传达。设备扫描器用于扫描网络中主机状态，查看是否已经安装注册程序，巡检网络设备状态变化信息，及时通知客户端驻留程序更新应用参数。对终端计算机违规行为的阻断也是由扫描器在接收控制台命令后执行。
（11）应用平台组件（B5）：应用平台组件是构建应用的基础支撑，包括但不局限于流程服务能力、即插即用服务、多数据源服务、数据交换服务等。
（12）离线行为数据分析应用（A1）：基于大数据分析技术，对海量的用户行为数据进行离线分析，分析用户操作流程，发现盗用、越权访问、违规操作、恶意破坏和篡改等不安全的用户行为，为事后审计提供依据。
（13）实时行为数据分析应用（A2）：基于大数据分析及高效搜索技术，实现对用户行为数据的实时分析，及时发现违规的用户行为，实现信息系统行为安全实时预警。
（14）数据模型管理工具（A3）：根据信息通信业务应用的数据特性，充分借鉴CIM、ITIL
V3、PAS55、COBIT、ISO
2000、OSA-CBM等成熟模型，为各种采集及业务应用提供数据模型管理工具，实现数据模型的新建、编辑、删除等操作。
（15）安全策略管理模块（A4）：作为应用的管理配置中心，基于Web浏览器方式工作，用于系统应用策略制订、配置系统组件运行参数以及维护系统等操作，并显示网络设备和该系统组件状态信息、报警信息和各种日志记录等。在安全策略管理模块进行的所有操作和结果数据均存储在管理信息库中。
（16）应用平台配置（A5）：应用平台维护人员对应用平台进行相关的配置。
## 融合目标架构视图
本章主要在评估了S6000、I6000、大数据平台、桌面终端等采集分析类应用的现状架构，根据现状架构的关系基础上进一步提出对后续行为安全审计支撑应用的目标架构设计。
![](media/image9.png){width="5.652083333333334in"
height="3.1597222222222223in"}
图7‑2行为安全审计目标架构关系
![](media/image10.png){width="5.627777777777778in"
height="2.966666666666667in"}
[]{#_Toc444091894 .anchor}图7‑2行为安全审计融合目标架构
**（1）补充定义、识别行为类数据标签及采集数据源。**前期技术处组织S6000、I6000等按照采集的数据源划分了安全类、存储类、机房类、网络类、应用类、终端类和主机类七类数据，并进一步将这些数据归纳为了安全类与运行类，但是对信息系统行为类的数据未进行归纳，不利于用户行为追溯的关联分析，本项目应补充对用户行为类数据进行归纳。
**（2）完善统一采集规范，增强行为审计数据采集能力。**基于S6000、I6000的前期成果，进一步规范行为数据的主动采集、被动采集、采集内容、采集格式等。制定统一的数据源采集规范，如采集范围、采集内容、采集频率、采集对象、采集接口标准等内容，在此基础上构建统一的行为安全数据采集策略，根据行为审计的要求按需采集，减小采集消耗、负担。
**（3）设计统一存储架构，标准化存储与提高数据防篡改能力。**根据前期调研结果日志数据存储分散，格式不统一、日志防篡改能力不同、存储保存时间不同。进一步加强统一防篡改能力、统一日志格式、日志存储保存时间等。基于S6000、I6000、大数据平台的前期成果，制定统一的日志数据范式化加工机制。通过对采集的数据进行加工，过滤日志数据，减少脏数据和无关紧要的杂音，降低需要入库的日志存储量，同时对收集到日志数据的进行补全。
制定统一的数据存储机制和存储策略，为后续的审计业务提供标准化、规范化的行为安全审计数据。
制定统一的审计数据业务模型，按照公共数据模型的定义对数据进行封装，支撑上层安全分析策略的快速构建与应用。
**（4）设计用户行为安全审计数据可视化管理工具，提供审计数据的统一视图。**设计用户行为审计数据的可视化管理工具，对用户行为审计数据进行统一管理，做到用户行为审计数据采集、存储、加工、应用全过程监控。
**（5）完善数据共享机制。**共享I6000的资源库，以I6000的资源模型为基准，形成共用的统一基础设施资源库。行为安全审计通过I6000提供的标准接口对资源数据进行读区。同一资源的资产属性、运行属性由I6000进行维护，安全属性由S6000进行维护，并实时同步。资源的新增、删除及资源模型关联关系，仍由I6000进行维护，并同步到行为安全审计。