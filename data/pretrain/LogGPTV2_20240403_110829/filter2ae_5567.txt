# IoT_reaper 僵尸网络最新情况更新（10月25日）

## 译文声明
本文为翻译文章，原文来源：安全客。译文仅供参考，具体内容及含义以原文为准。

**传送门**
[【僵尸网络】IoT_reaper: 一个正在快速扩张的新IoT僵尸网络](http://bobao.360.cn/learning/detail/4582.html)

## 前言
自周五晚上首次披露了 **IoT_reaper** 后，我们收到了来自安全社区和各方的大量问题。以下是对常见疑问的快速更新。

## IoT_reaper 样本投递历史
通过蜜罐观察到的 **IoT_reaper** 样本历史投递情况如下：

- 主要传播的恶意代码位于以下URL：
  - 下载地址: `hxxp://162.211.183.192/sa`
  - 投递者: `119.82.26.157`
  - 时间范围: 10-04至10-17
  - 样本MD5: 7个, 详细见文末IoC

此URL上的样本之间内聚关系较强，我们称之为S簇。进一步分析显示，S簇还包括其他一些样本；此外，还有一个LUA簇和其他较小的未知簇。

### S簇的样本构成
我们认为S簇包含以下URL上的样本：
- `hxxp://162.211.183.192/sa`
- `hxxp://162.211.183.192/sa5`
- `hxxp://162.211.183.192/sm`
- `hxxp://162.211.183.192/sml`

这些样本的命名策略可能是这样的：
- `sa`: arm
- `sa5`: arm5
- `sm`: mips
- `sml`: mips 小端

### S簇的C2布局、感染机制和数字疑问
- **Loader**: 负责通过漏洞植入恶意代码
- **Downloader**: 提供恶意代码下载
- **Reporter**: 接收bot扫描到的易感染设备信息
- **Controller**: 控制bot并发送控制指令

我们推测，在reporter和loader之间有一个队列，reporter会将收集到的易感染设备信息推入队列，等待loader处理。

与S簇感染相关的数字近日来引起了安全社区的混淆。我们观察到的数字如下：
- 单台reporter已汇报的易感染设备数：超过2百万，截至2017-10-18
- 单台controller累积控制设备数：超过28千，截至2017-10-24

这两个数字之间的显著差距可能由多种原因造成，例如攻击者的实现导致队列中加入了大量不存在相应漏洞的设备，或者loader处理能力不足而被动积压，也可能是攻击者主动抑制了感染速度以减少暴露风险，或其他未知原因。

### S簇单台C2感染情况统计（2017-10-13 至 2017-10-23）
- **时间分布**
- **国家分布**
- **被感染的前十个国家**

### S簇的近期样本变化情况
我们会持续监控视野内的样本变化。在10月23日，我们检测到S簇的以下URL内容发生变化：
- `hxxp://162.211.183.192/sa`

变化情况如下表所示：
- 新集成了一个**新的漏洞利用**
- 心跳指向 `e.hl852.com` 和 `e.hl859.com`
- 样本中内置了**9个硬编码的IP地址**，扫描时会包含这些地址
- 这些IP地址上有共计34个端口会被频繁扫描，其中17个端口是硬编码的，另外17个端口虽然会被频繁扫描但未直接硬编码

这第九个漏洞利用在样本中的调用过程如下：
- **9个硬编码的IP地址**:
  - `217.155.58.226`
  - `85.229.43.75`
  - `213.185.228.42`
  - `218.186.0.186`
  - `103.56.233.78`
  - `103.245.77.113`
  - `116.58.254.40`
  - `201.242.171.137`
  - `36.85.177.3`

对应的，我们可以观察到这些IP地址的流量在上述时间点后开始增加。

### S簇的C2 DNS流量变化
S簇先后使用了以下一组C2，对应的DNS流量图见后：
- `e.hi8520.com`：对应图中最上方蓝色曲线
- `e.hl852.com`：对应图中中间绿色曲线
- `e.ha859.com`：对应图中底部黄色曲线

### IoC
- `hxxp://162.211.183.192/sa` MD5: `41ef6a5c5b2fde1b367685c7b8b3c154`
- `hxxp://162.211.183.192/sa` MD5: `f9ec2427377cbc6afb4a7ff011e0de77`
- `hxxp://162.211.183.192/sa` MD5: `76be3db77c7eb56825fe60009de2a8f2`
- `hxxp://162.211.183.192/sa5` MD5: `95b448bdf6b6c97a33e1d1dbe41678eb`
- `hxxp://162.211.183.192/sa` MD5: `e9a03dbde09c6b0a83eefc9c295711d7`
- `hxxp://162.211.183.192/sa` MD5: `3d680273377b67e6491051abe17759db`
- `hxxp://162.211.183.192/sa` MD5: `726d0626f66d5cacfeff36ed954dad70`

**传送门**
[【僵尸网络】IoT_reaper: 一个正在快速扩张的新IoT僵尸网络](http://bobao.360.cn/learning/detail/4582.html)