Who am I and what am I doing?
• Airscanner.com
– Mobile Security (AV, firewall, sniffer)
• Dissemination of Information
– Reverse-engineering is a tool…not a weapon
– Knowing your computer
– Don’t steal…pay the programmers
Legal Issues
•
Laws
–No person shall circumvent a technological measure 
that effectively controls access to a work protected under 
this title.
–to ''circumvent a technological measure'' means to 
descramble a scrambled work, to decrypt an encrypted 
work, or otherwise to avoid, bypass, remove, deactivate, 
or impair a technological measure, without the authority 
of the copyright owner;
•
Encryption Research & Security Testing
–identify and analyze flaws and vulnerabilities of 
encryption technologies applied to copyrighted works
–accessing a …computer system…solely for the purpose 
of …investigating… a security flaw or vulnerability…
Windows CE Architecture
• Processors
– Power&Processing = Heat
– Reduced Instruction Set Computer (RISC)
• ARM (1987): StrongARM, Xscale
• WinCE, ARM Linux, EPOC
• Intel bought DEC (StrongARM) 
– Larger Cache
– Dynamic Voltage
– StrongARM 2.5 million transistors / Xscale 5 
million
– Lower power usage at higher speed
Architecture Cont. – Kernel/Process
• Kernel
– Reduced Windows 2000 (No 16 bit or MS-DOS)
– Core DLL issues
– DLLs are run from ROM 
• Can’t break a program when its executing DLL code
• Processes (32) with dedicated 32MB/Process
– 512x64k memory blocks, 16 registers per thread
– Kernel (OS) & User (3rd party programs) Mode
– Processes are isolated but threads share data
Architecture Cont. – Memory
• Memory
– RAM (Program & Objects)
• Lose power - lose programs and objects (files)
– ROM
• Store OS files
• Compression
• eXecute In Place – Save memory (No Compression)
– Object Store (Files)
• Registry: Configuration settings
• Programs: Compressed area for 3rd party programs
• Databases: Structured storage 
Architecture Cont. – GWES/Scheduler
• Graphics, Windowing and Event 
Subsystem 
– Handles all messaging
– Your friend (Popups)
– PostMessage, SendMessage, 
SendThreadMessage
• Scheduler
– Multitasking
– Assigns processor time at thread level
Reverse Engineering Fundamentals
• Prerequisites
– ASM (concept)
– Hex to Binary to ASCII to Decimal
– ARM Processor
• Registers
• Opcodes
ASCII
D
E
F
C
O
N
HEX
44 
45
46
43
4F 
4E 
Decimal
068
069
070
067
079
078
Binary
01000100
01000101
01000110 
01000011
01001111 
01001110 
ARM Registers
• Registers
– 37 Total @ 32 bit each
– Register purpose changes depending on mode
– R0 – R14 + PC(R15)
– R15(PC): Program Counter – Current address of 
execution
– R14: Link Register (LR) – Hold sub routine return 
address.
– R13: Stack Pointer (SP)
– Status (NZCO)
• R31: Negative / Less Than
• R30: Zero (Equal)
• R29: Carry / Borrow / Extend
• R28: Overflow 
ARM Registers
ARM Opcodes – MOV, CMP
• Move (MOV) – XX XX A0 EX
– MOV R3, R1:
01 30 A0 E1
– MOV R2, #1:
01 20 A0 E3 
• Compare (CMP) – XX XX 5X EX
– CMP
R2, R3:
03 00 52 E1
– CMP R4, #1:
01 00 54 E3
ARM Status Flags
• Status Flags
– CMP R0, R1
– MOVS R0, R1  /  ANDS R0, R1, 0xFF
N
Z
C
R0 >= R10
R0=R11
R0>=R11
N
Z
C
R1  8)){
MessageBox(strToShort);
}else{
if (strSerial == m_Serial){
MessageBox(strValid);
}else{
MessageBox(strInvalid);
}}}
Summary
• Tools
– Disassembler
– Debugger
– Hex Editor
• ARM Processor
– Opcodes
– Registers
• Reverse it
– Locate weakness
– Watch execution
– Patch it
References
• www.ka0s.net
• www.dataworm.net
• http://www.eecs.umich.edu/speech/docs/arm/ARM7TDMIvE.pdf
• http://www.ra.informatik.uni-
stuttgart.de/~ghermanv/Lehre/SOC02/ARM_Presentation.pdf
• class.et.byu.edu/eet441/notes/arminst.ppt 
• http://www.ngine.de/gbadoc/armref.pdf
• http://wheelie.tees.ac.uk/users/a.clements/ARMinfo/ARMnote.htm
• http://www3.mb.sympatico.ca/~reimann/andrew/asm/armref.pdf
• www.arm.com
• www.airscanner.com