ponents (3-layer policy model and route decision model) both beneﬁt the whole
algorithm. Compared with single-kind policy models, our 3-layer policy model
increases the accuracy by up to 133%. Route decision model based on learning
to rank performs up to 313% better than predicting route decisions by default
policies. Furthermore, we analyze the inferred policies and our route decision
model. We ﬁnd that most of ASes set preﬁx policies for CDN ASes. Most of the
violations of the standard preference rule are related to p2p links in European
IXPs.
A bunch of works on the security of Internet routing are based on a complete
and accurate Internet routing map. However, almost all existing works use stan-
dard policies which perform poorly to get the Internet routing map. Prior works
[49] have proven that the success of a system or the analysis in simulation does
not guarantee success or the same ﬁndings in the real-world. Therefore, in future
work, we will focus on analyzing the change and the impact on those security
systems after we get a more accurate Internet routing map.
Acknowledgement. We thank the anonymous reviewers and our shepherd, Romain
Fontugne, for their comments and suggestions that help signiﬁcantly improve our paper.
This work was supported in part by the National Natural Science Foundation of China
under Grant 62072269 and in part by the National Key Research and Development
Program of China under Grant 2020YFE0200500.
240
T. Wu et al.
A The Inﬂuence of Bias
The bias of BGP routing data is a general challenge in Internet-scale measure-
ment studies because BGP routing data is collected from a few vantage points.
In this section, we want to investigate the inﬂuence of bias on the accuracy of
RouteInfer, i.e., how the accuracy of RouteInfer varies with the distance to van-
tage points. We deﬁne the distance of vantage points as the minimum routing hop
to vantage points. For example, there are two paths AS1, AS2, AS3, AS4 and
AS5, AS6, AS7, AS3, AS8. In this scenario, AS1 and AS5 are vantage points. In
the ﬁrst path, AS3 is 2 hops from AS1. In the second path, AS3 is 3 hops from
AS5. Therefore, the distance between AS3 to vantage points is 2 hops. Again,
we split the routing data into a training set and a test set. We use the training
set as the input of RouteInfer and use the test set to evaluate the accuracy of
inferred paths. We classify the paths in the test set by their distance to vantage
points. The result is shown in Fig. 18.
We can see that as the distance increases, the accuracy is higher. Thus, bias
has little inﬂuence on the performance of RouteInfer.
Fig. 18. Distance to vantage points
vs. accuracy
Fig. 19. Convergence time
B Convergence Time
RouteInfer simulates the process of routing decision and routing announcement
of the Internet. We need to wait until the simulation gets convergence to get
inferred paths. In this section, we analyze the convergence time of one simulation.
The result is shown in Fig. 19.
The convergence time is between 2.62 s to 6.35 s. Average convergence time
is 4.28 s.
C The Intuition of Choosing Routes from High Tier ASes
In this section, we will explain the details of the reason why we think route
decisions are related to the tier of the next-hop AS. We focus on the Tier-1 ASes
RouteInfer: Inferring Interdomain Paths
241
and the ASes which connect with Tier-1 ASes. Like the experiments by the BGP
routing table in Sect. 3, we split BGP routing data into a training set (90%) and
a test set (10%). The training set is used to infer business relationships between
ASes. The business relationships are then used to infer the paths. We use the test
set to check whether the predictions of route decisions are right. For the Tier-
1 ASes, we ﬁnd that about 50.09% wrong predictions of their route decisions
are because the Tier-1 AS chooses the route from a Non-Tier1 AS according to
standard policies rather than the route from another Tier-1 AS in reality. For
the ASes which connect with Tier-1 ASes, we ﬁnd that about 58.04% wrong
predictions of their route decisions are because the ASes choose the route from a
Non-Tier1 AS according to standard policies rather than the route from another
Tier-1 AS in reality. Therefore, we ﬁnd that many Tier1 AS prefer the routes
from other Tier1 AS. Besides, if an AS connects to a Tier1 AS, the AS may
prefer the routes from the Tier1 AS. Our intuition is based on these ﬁndings.
D The Pseudocode of Route Decision Model
run simulation for p
for AS a whose path is known do
Algorithm 1. Route decision model based on LambdaMART
Input: AS topology; AS relationships; IXP data; Routing policies;
Output: A route decision model which can predict route decisions of stranger ASes;
1: for all preﬁx p do
2:
3:
4:
5:
6:
7:
8:
9: end for
10: set number of trees N , number of training samples m, number of leaves per tree
br ← best route of a
for candidate route cr of a do
extract feature vectors from (a, br, cr)
end for
end for
for i = 0 to m do
F0(xi) = 0
L, learning rate η
11: for i = 0 to m do
12:
13: end for
14: for k = 0 to N do
15:
16:
17:
18:
19:
∂Fk−1(xi)
yi = λi
wi =
end for
{Rlk}L
γlk =
Fk(xi) = Fk−1(xi) + η
xi∈Rlk
xi∈Rlk
20:
(cid:2)
(cid:2)
∂yi
21:
22: end for
l=1 // Create L leaf tree on {xi, yi}m
i=1
yi
wi // Assign leaf values based on Newton step
(cid:2)
l γlkI(xi ∈ Rlk) // Take step with learning rate η
242
T. Wu et al.
References
1. Lychev, R., Goldberg, S., Schapira, M.: BGP security in partial deployment: is the
juice worth the squeeze? In: Proceedings of the ACM SIGCOMM 2013 Conference
on SIGCOMM, pp. 171–182 (2013)
2. Cohen, A., Gilad, Y., Herzberg, A., Schapira, M.: Jumpstarting BGP security with
path-end validation. In: Proceedings of the 2016 ACM SIGCOMM Conference, pp.
342–355 (2016)
3. Gilad, Y., Cohen, A., Herzberg, A., Schapira, M., Shulman, H.: Are we there yet?
On RPKI’s deployment and security. In: NDSS (2017)
4. Madhyastha, H.V., Katz-Bassett, E., Anderson, T.E., Krishnamurthy, A.,
Venkataramani, A.: iPlane nano: path prediction for peer-to-peer applications. In:
NSDI, vol. 9, pp. 137–152 (2009)
5. Apostolaki, M., Marti, G., M¨uller, J., Vanbever, L.: SABRE: protecting bitcoin
against routing attacks. In: 26th Annual Network and Distributed System Security
Symposium, NDSS 2019, San Diego, California, USA, 24–27 February 2019 (2019)
6. Tran, M., Shenoi, A., Kang, M.S.: On the routing-aware peering against network-
eclipse attacks in bitcoin. In: 30th USENIX Security Symposium (USENIX Security
21) (2021)
7. Apostolaki, M., Zohar, A., Vanbever, L.: Hijacking bitcoin: routing attacks on
cryptocurrencies. In: 2017 IEEE Symposium on Security and Privacy (SP), pp.
375–392. IEEE (2017)
8. Tran, M., Choi, I., Moon, G.J., Vu, A.V., Kang, M.S.: A stealthier partitioning
attack against bitcoin peer-to-peer network. In: 2020 IEEE Symposium on Security
and Privacy (SP), pp. 894–909. IEEE (2020)
9. Nasr, M., Zolfaghari, H., Houmansadr, A.: The waterfall of liberty: decoy rout-
ing circumvention that resists routing attacks. In: Proceedings of the 2017 ACM
SIGSAC Conference on Computer and Communications Security, pp. 2037–2052
(2017)
10. Houmansadr, A., Wong, E.L., Shmatikov, V.: No direction home: the true cost of
routing around decoys. In: 21st Annual Network and Distributed System Security
Symposium, NDSS 2014, San Diego, California, USA, 23–26 February 2014 (2014)
11. RisNithyanand, R., Starov, O., Zair, A., Gill, P., Schapira, M.: Measuring and
mitigating AS-level adversaries against Tor. In: 23rd Annual Network and Dis-
tributed System Security Symposium, NDSS 2016, San Diego, California, USA,
21–24 February 2016. The Internet Society (2016)
12. Gao, L., Rexford, J.: Stable internet routing without global coordination.
IEEE/ACM Trans. Netw. 9(6), 681–692 (2001)
13. M¨uhlbauer, W., Uhlig, S., Bingjie, F., Meulle, M., Maennel, O.: In search for
an appropriate granularity to model routing policies. ACM SIGCOMM Comput.
Commun. Rev. 37(4), 145–156 (2007)
14. Anwar, R., Niaz, H., Choﬀnes, D., Cunha, ´I., Gill, P., Katz-Bassett, E.: Investigat-
ing interdomain routing policies in the wild. In: Proceedings of the 2015 Internet
Measurement Conference, pp. 71–77 (2015)
15. M¨uhlbauer, W., Feldmann, A., Maennel, O., Roughan, M., Uhlig, S.: Building
an AS-topology model that captures route diversity. ACM SIGCOMM Comput.
Commun. Rev. 36(4), 195–206 (2006)
16. Qiu, J., Gao, L.: AS path inference by exploiting known AS paths. In: Proceedings
of IEEE GLOBECOM. Citeseer (2005)
RouteInfer: Inferring Interdomain Paths
243
17. Singh, R., Tench, D., Gill, P., McGregor, A.: PredictRoute: a network path predic-
tion toolkit. In: Proceedings of the ACM on Measurement and Analysis of Com-
puting Systems, vol. 5, no. 2, pp. 1–24 (2021)
18. Gill, P., Schapira, M., Goldberg, S.: Modeling on quicksand: dealing with the
scarcity of ground truth in interdomain routing data. ACM SIGCOMM Comput.
Commun. Rev. 42(1), 40–46 (2012)
19. Gao, L.: On inferring autonomous system relationships in the internet. IEEE/ACM
Trans. Netw, 9(6), 733–745 (2001)
20. Mao, Z.M., Qiu, L., Wang, J., Zhang, Y.: On AS-level path inference. In: Proceed-
ings of the 2005 ACM SIGMETRICS International Conference on Measurement
and Modeling of Computer Systems, pp. 339–349 (2005)
21. Deng, W., M¨uhlbauer, W., Yang, Y., Zhu, P., Xicheng, L., Plattner, B.: Shedding
light on the use of AS relationships for path inference. J. Commun. Netw. 14(3),
336–345 (2012)
22. Giotsas, V., Zhou, S.: Valley-free violation in internet routing - analysis based on
BGP community data. In: 2012 IEEE International Conference on Communications
(ICC), pp. 1193–1197. IEEE (2012)
23. Tian, Z., Shen, S., Shi, W., Xiaojiang, D., Guizani, M., Xiang, Yu.: A data-driven
method for future internet route decision modeling. Futur. Gener. Comput. Syst.
95, 212–220 (2019)
24. Luckie, M., Huﬀaker, B., Dhamdhere, A., Giotsas, V., Claﬀy, K.C.: AS relation-
ships, customer cones, and validation. In: Proceedings of the 2013 Conference on
Internet Measurement Conference, pp. 243–256 (2013)
25. The Internet Routing Registry - RADb. https://www.radb.net/
26. AS Relationships
- CAIDA.
https://www.caida.org/catalog/datasets/as-
relationships/
27. AS Rank: A ranking of the largest Autonomous Systems. https://asrank.caida.
org/
28. Liu, T.-Y.: Learning to rank for information retrieval (2011)
29. Burges, C.J.C.: From RankNet to LambdaRank to LambdaMART: an overview.
Learning 11(23–581), 81 (2010)
30. Routeviews - University of Oregon Route Views Project. http://www.routeviews.
org/routeviews/
31. Routing Information Service (RIS) - RIPE Network. https://www.ripe.net/
analyse/internet-measurements/routing-information-service-ris
32. Isolario project. https://www.isolario.it/
33. Jasinska, E., Hilliard, N., Raszuk, R., Bakker, N.: RFC7947: internet exchange
BGP route server (2016)
34. Oliveira, R., Pei, D., Willinger, W., Zhang, B., Zhang, L.: The (in) completeness of
the observed Internet AS-level structure. IEEE/ACM Trans. Netw. 18(1), 109–122
(2009)
35. Alaettinoglu, C.: Routing Policy Speciﬁcation Language (RPSL). RFC 2622, 1–69
(1999)
36. AS286. https://as286.net/AS286-communities.html
37. AS9002. https://lg.retn.net/bgp-communities.html
38. One Step. https://onestep.net/
39. PeeringDB. https://www.peeringdb.com/
40. Euro-IX. https://www.euro-ix.net/en/
41. Internet Exchange Point Datasets—PCH. https://www.pch.net/ixp/data
42. Burges, C., et al.: Learning to rank using gradient descent. In: Proceedings of the
22nd International Conference on Machine Learning, pp. 89–96 (2005)
244
T. Wu et al.
43. Burges, C., Ragno, R., Le, Q.: Learning to rank with nonsmooth cost functions. In:
Advances in Neural Information Processing Systems, vol. 19, pp. 193–200 (2006)
44. Chang, Y., Chapelle, O., Liu, T.-Y.: The Yahoo! learning to rank challenge. http://
learningtorankchallenge.yahoo.com
45. Giotsas, V., Luckie, M., Huﬀaker, B., Claﬀy, K.C.: Inferring complex as relation-
ships. In: Proceedings of the 2014 Conference on Internet Measurement Conference,
pp. 23–30 (2014)
46. Jin, Y., Scott, C., Dhamdhere, A., Giotsas, V., Krishnamurthy, A., Shenker, S.:
Stable and practical AS relationship inference with Problink. In: 16th USENIX
Symposium on Networked Systems Design and Implementation (NSDI 19), pp.
581–598 (2019)
47. Jin, Z., Shi, X., Yang, Y., Yin, X., Wang, Z., Wu, J.: TopoScope: recover AS
relationships from fragmentary observations. In: Proceedings of the ACM Internet
Measurement Conference, pp. 266–280 (2020)
48. List of Internet exchange points by size. https://en.wikipedia.org/wiki/List of
Internet exchange points by size
49. Smith, J.M., Birkeland, K., McDaniel, T., Schuchard, M.: Withdrawing the BGP
re-routing curtain: understanding the security impact of BGP poisoning through
real-world measurements. In: NDSS (2020)