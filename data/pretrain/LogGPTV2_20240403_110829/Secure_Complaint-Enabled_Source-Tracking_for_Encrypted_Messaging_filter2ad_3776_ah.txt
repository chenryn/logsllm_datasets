https://signal.org/docs/specifications/doubleratchet/.
[26] Katitza Rodriguez and Seth Schoen. 2020. FAQ: Why Brazilâ€™s Plan to Mandate
Traceability in Private Messaging Apps Will Break Userâ€™s Expectation of Pri-
vacy and Security. https://www.eff.org/deeplinks/2020/08/faq-why-brazils-plan-
mandate-traceability-private-messaging-apps-will-break-users.
[27] Prasanto K Roy. 2019. Why India wants to track WhatsApp messages. https:
//www.bbc.com/news/world-asia-india-50167569.
[28] Manish Singh. 2020. India likely to force Facebook, WhatsApp to identify the
originator of messages. https://techcrunch.com/2020/01/21/india-likely-to-force-
facebook-whatsapp-to-identify-the-originator-of-messages/.
[29] Manish Singh. 2020. WhatsApp is now delivering roughly 100 billion messages a
day. https://techcrunch.com/2020/10/29/whatsapp-is-now-delivering-roughly-
100-billion-messages-a-day/.
[30] Udbhav Tiwari
and Jochai Ben-Avie.
analysis:
Brazilâ€™s fake news law harms privacy, security, and free expression.
https://blog.mozilla.org/netpolicy/2020/06/29/brazils-fake-news-law-harms-
privacy-security-and-free-expression/.
Mozillaâ€™s
2020.
[31] Nirvan Tyagi, Paul Grubbs, Julia Len, Ian Miers, and Thomas Ristenpart. 2019.
Asymmetric Message Franking: Content Moderation for Metadata-Private End-
to-End Encryption. IACR Cryptol. ePrint Arch. 2019 (2019), 565.
[32] Nirvan Tyagi, Ian Miers, and Thomas Ristenpart. 2019. Traceback for End-to-End
Encrypted Messaging. In Proceedings of the 2019 ACM SIGSAC Conference on
Computer and Communications Security (London, United Kingdom) (CCS â€™19).
Association for Computing Machinery, New York, NY, USA, 413â€“430. https:
//doi.org/10.1145/3319535.3354243
[33] Nik Unger, Sergej Dechand, Joseph Bonneau, Sascha Fahl, Perl Henning, Ian Gold-
berg, and Matthew Smith. 2015. SoK: Secure Messaging. In 2015 IEEE Symposium
on Security and Privacy. IEEE, San Jose, 232â€“249.
[34] Nik Unger and Ian Goldberg. 2015. Deniable Key Exchanges for Secure Mes-
saging. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and
Communications Security (CCS â€™15). Association for Computing Machinery, New
York, NY, USA, 1211â€“1223. https://doi.org/10.1145/2810103.2813616
[35] Nik Unger and Ian Goldberg. 2018. Improved Strongly Deniable Authenticated
Key Exchanges for Secure Messaging. Proceedings on Privacy Enhancing Tech-
nologies 2018, 1 (Jan. 2018), 21â€“66. https://doi.org/10.1515/popets-2018-0003
[36] Jelle van den Hooff, David Lazar, Matei Zaharia, and Nickolai Zeldovich. 2015.
Vuvuzela: scalable private messaging resistant to traffic analysis. In Proceedings
of the 25th Symposium on Operating Systems Principles, SOSP 2015, Monterey, CA,
USA, October 4-7, 2015. Association for Computing Machinery, New York, NY,
United States, 137â€“152.
[37] Nihal Vatandas, Rosario Gennaro, Bertrand Ithurburn, and Hugo Krawczyk. 2020.
On the Cryptographic Deniability of the Signal Protocol. In ACNS 2020. Springer,
Rome, Italy, 188â€“209.
[38] S.R. Verschoor. 2020. double-ratchet: Pure Rust implementation of the Double
Ratchet algorithm. https://github.com/sebastianv89/double-ratchet.
A DEFERRED DEFINITIONS
A.1 Platform Confidentiality
The platform confidentiality game gives the adversary oracles
goodSend and goodRec for sending messages between honest users
and malSend and malRec to send a malicious from or to a mali-
cious user, respectively. We separate the sending and receiving of
messages into separate oracles to allow the adversary to launch
attacks that involve delivering message data to unintended recip-
ients or otherwise tampering with the message delivery process.
Additionally, the report oracle allows a user to report a message to
the platform.
To further strengthen the adversary, we allow for a platform
to create a set Uğ‘šğ‘ğ‘™ of platform-controlled users that can collude
with the platform using the getUser oracle passed with ğ‘šğ‘ğ‘™ğ‘ˆ ğ‘ ğ‘’ğ‘Ÿ
set to true. We define the set of honest users Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ as the set
of users not controlled by the adversary, each created by a call to
getUser with ğ‘šğ‘ğ‘™ğ‘ˆ ğ‘ ğ‘’ğ‘Ÿ set to false. These honest users are created by
running the newUser protocol with the adversary as the platform,
and adding the new user to the set of users only if the protocol is
successful. The adversary is given access to oracles send(Â·, ğ‘ˆ , Â·) and
receive(Â·, Â·, ğ‘ˆ) for ğ‘ˆ âˆˆ Uğ‘šğ‘ğ‘™ to send and receive messages from
malicious users in the underlying messaging scheme.
As in the user confidentiality game, messages are identified by a
unique identifier ğ‘šğ‘–ğ‘‘, trees are identified by ğ‘¡ğ‘–ğ‘‘, the identifier of
the message at their root. When set to âŠ¥, the ğ‘¡ğ‘–ğ‘‘ value acts as a
flag for messages that canâ€™t be revealed to be the adversary without
allowing it to trivially win the confidentiality game.
The game keeps track of messages sent and received in tables
ğ‘‡ğ‘ ğ‘’ğ‘›ğ‘‘ andğ‘‡ğ‘Ÿğ‘’ğ‘, respectively. The tableğ‘‡ğ‘ğ‘¢ğ‘¡â„ additionally keeps track
of authoring data (ad) received by honest users when they author
a new message. The goodSend oracle represents the challenge por-
tion of the game. It allows the adversary to choose two messages
ğ‘0 and ğ‘1, one of which will actually be sent between two honest
users, and the adversary must guess which message was sent. The
ğ‘ğ‘–s include an associated value ğ‘ğ‘–[type] that determines whether
they are new messages or forwarded messages. If the type is new,
then ğ‘ğ‘– is simply a message plaintext to be sent. Otherwise, ğ‘ğ‘– is
the ğ‘šğ‘–ğ‘‘ value for a message to be forwarded.
A.2 Deniability
Here, we present an extended discussion of our deniability def-
initions discussed in Section 3.4, and present formalizations of
deniability for source-tracking schemes.
Deniability, or the guarantee that only the messaging platform
can prove that a sender sent a message, is a common goal of many
secure messaging applications [22]. Because source-tracking is de-
signed to be applied on top of these existing messaging applications,
it is important that source-tracking schemes preserve the messaging
applicationâ€™s deniability guarantees.
One of the key settings where deniability is important is pro-
tection for whistleblowers who use the messaging application to
anonymously relay sensitive information. From this perspective,
deniability for source-tracking schemes becomes particularly im-
portant because we want to guarantee that not only the source of
the forwarded message can deny sending it, but also that interme-
diate users along the path who may have reported or forwarded
the message to an authority can deny this action if their messages
are compromised.
Prior works [10, 11, 13, 31, 33] have investigated the large space
of potential deniability definitions and their associated tradeoffs
with notions of authentication and unforgeability.
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1497return âŠ¥
goodSend(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘0, ğ‘1)
if ğ‘ˆğ‘  âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ :
ğ‘šğ‘–ğ‘‘ â†R {0, 1}ğ‘›
for ğ‘– âˆˆ {0, 1} :
if ğ‘ğ‘– [type] = new :
ğ‘šğ‘– â† ğ‘ğ‘–
ğ‘¡ğ‘–ğ‘‘ğ‘– â† ğ‘šğ‘–ğ‘‘
else :
ğ‘šğ‘–ğ‘‘ğ‘– â† ğ‘ğ‘–
if ğ‘šğ‘–ğ‘‘ğ‘– âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆ (ğ‘–)
if ğ‘ˆ (ğ‘–)
, ğ‘ˆ (ğ‘–)
ğ‘Ÿ â‰  ğ‘ˆğ‘  : return âŠ¥
ğ‘ 
ğ‘Ÿ
return âŠ¥
, ğ‘šğ‘–, fdğ‘–, ğ‘¡ğ‘–ğ‘‘ğ‘–) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘ğ‘– ]
return âŠ¥
malSend(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’)
if ğ‘ˆğ‘  âˆ‰ Uğ‘šğ‘ğ‘™ âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ : return âŠ¥
(ğ‘š, fd) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
if fd = âŠ¥ :
ğ‘šğ‘–ğ‘‘ â†R {0, 1}ğ‘›
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd, ğ‘šğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘
malRec(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘)
if ğ‘ˆğ‘  âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uğ‘šğ‘ğ‘™ : return âŠ¥
//case 1: c corresponds to a new message
if ğ‘[ğ‘¡ ğ‘¦ğ‘ğ‘’] = ğ‘›ğ‘’ğ‘¤ : ğ‘š â† ğ‘
ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ A,ğ‘
ğ‘†ğ‘‡ ,E
(pk, sk) â† KGen(ğ‘ğ‘ğ‘Ÿğ‘ğ‘šğ‘ )
ğ‘â€² â† AO (pk, sk)
return ğ‘â€²
getUser(ğ‘ˆ , ğ‘–ğ‘ ğ‘€ğ‘ğ‘™)
if ğ‘ˆ âˆˆ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆª ğ‘ˆğ‘šğ‘ğ‘™ :
return âŠ¥
if ğ‘–ğ‘ ğ‘€ğ‘ğ‘™ :
return ğ‘ˆğ‘šğ‘ğ‘™ .ğ‘ğ‘‘ğ‘‘(ğ‘ˆ)
ad â† âŸ¨ğ‘ˆğ‘›ğ‘’ğ‘¤, AâŸ©(ğ‘ˆ , pk)
if ad = âŠ¥ : return âŠ¥
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆ ] â† ad
return ğ‘ˆâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ .ğ‘ğ‘‘ğ‘‘(ğ‘ˆ)
ğ‘¡ğ‘–ğ‘‘ â† âŠ¥
return âŠ¥
return âŠ¥
if ğ‘ğ‘ [ğ‘¡ ğ‘¦ğ‘ğ‘’] = new :
if ğ‘š0 â‰  ğ‘š1 âˆ¨ ğ‘¡ğ‘–ğ‘‘0 â‰  ğ‘¡ğ‘–ğ‘‘1 âˆ¨ ğ‘¡ğ‘–ğ‘‘0 = âŠ¥ âˆ¨ ğ‘¡ğ‘–ğ‘‘1 = âŠ¥ :
ad â† ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ], ğ‘šğ‘ ğ‘” â† (ğ‘šğ‘, ad)
(adâ€², ğ‘’) â† âŸ¨ğ‘ˆğ‘ğ‘¢ğ‘¡â„(ğ‘šğ‘ ğ‘”), AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ] â† adâ€²
else :
ğ‘šğ‘ ğ‘” â† (ğ‘šğ‘, fdğ‘)
(fd, ğ‘’) â† âŸ¨ğ‘ˆğ‘“ ğ‘¤ğ‘‘ (ğ‘šğ‘ ğ‘”), AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘ğ‘] â† (ğ‘ˆ (ğ‘)
, ğ‘ˆğ‘ , ğ‘šğ‘, fd, ğ‘¡ğ‘–ğ‘‘ğ‘)
report(ğ‘šğ‘–ğ‘‘)
if ğ‘šğ‘–ğ‘‘ âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd, ğ‘¡ğ‘–ğ‘‘) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘]
//check if report contents can be revealed
if ğ‘¡ğ‘–ğ‘‘ = âŠ¥ :
return âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘ (fd), AâŸ©(ğ‘š, pk)
goodRec(ğ‘šğ‘–ğ‘‘, ğ‘’)
if ğ‘šğ‘–ğ‘‘ âˆ‰ ğ‘‡ğ‘ ğ‘’ğ‘›ğ‘‘ :
(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, ğ‘’â€², ğ‘¡ğ‘–ğ‘‘) â† ğ‘‡ğ‘ ğ‘’ğ‘›ğ‘‘ [ğ‘šğ‘–ğ‘‘]
if ğ‘ˆğ‘  âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ :
return âŠ¥
(ğ‘šâ€², fd) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
if fd = âŠ¥ :
ğ‘šğ‘–ğ‘‘â€² â†R {0, 1}ğ‘›, if ğ‘’ â‰  ğ‘’â€² : ğ‘¡ğ‘–ğ‘‘ â† âŠ¥
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘â€²] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd, ğ‘¡ğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘â€²
Figure 7: Platform confidentiality game and oracles. The adversary is also given access to send(Â·, ğ‘ˆ , Â·) and receive(Â·, Â·, ğ‘ˆ) oracles for the
underlying encrypted messaging scheme for all adversary-controlled users ğ‘ˆ âˆˆ Uğ‘šğ‘ğ‘™ .
ad â† ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ], ğ‘šğ‘ ğ‘” â† (ğ‘š, ad)
(adâ€², ğ‘’) â† âŸ¨ğ‘ˆğ‘ğ‘¢ğ‘¡â„(ğ‘šğ‘ ğ‘”), AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ] â† adâ€²
//case 2: c corresponds to a forward
else : ğ‘šğ‘–ğ‘‘ â† ğ‘
if ğ‘šğ‘–ğ‘‘ âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆ â€²
if ğ‘ˆ â€²
ğ‘šğ‘ ğ‘” â† (ğ‘š, fd)
fdâ€², ğ‘’ â† âŸ¨ğ‘ˆğ‘“ ğ‘¤ğ‘‘ (ğ‘šğ‘ ğ‘”), AâŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆ â€²
ğ‘‡ğ‘ ğ‘’ğ‘›ğ‘‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, ğ‘šğ‘, ğ‘¡ğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘
ğ‘ , ğ‘ˆ â€²
ğ‘Ÿ â‰  ğ‘ˆğ‘  âˆ¨ ğ‘¡ğ‘–ğ‘‘ = âŠ¥ :
ğ‘Ÿ , ğ‘š, fd, ğ‘¡ğ‘–ğ‘‘) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘]
return âŠ¥
ğ‘ , ğ‘ˆ â€²
ğ‘Ÿ , ğ‘š, fdâ€², ğ‘¡ğ‘–ğ‘‘)
return âŠ¥
return âŠ¥
return âŠ¥
ğ‘ 
While there are many different flavors of deniability definitions
that could be extended to source-tracking, we chose to focus on def-
initions that were reasonable with respect to the current deniability
guarantees offered by secure messaging systems. Online deniabil-
ity, which guarantees a user can maintain deniability even when a
third party interacts with it during the protocol to gain evidence
of the userâ€™s participation, is a strong form of deniability that has
been shown not to hold for the Signal messaging protocol [34, 35].
Instead, we focus on offline deniability, which guarantees a user can
deny participating in a conversation in the event that a transcript
of the exchange is provided to a third party. This form of deniabil-
ity has been shown to hold for the Signal protocol under strong
assumptions [33, 37]. We show that our source-tracking schemes
satisfy the strongest form of offline deniability using the simulated
transcript approach of [11], meaning that any user can forge a
transcript of a forwarding path and report that is indistinguishable
from a real transcript to a third party who holds the long-term keys
for all involved users, assuming that the underlying messaging
scheme satisfies this guarantee as well. This is stated formally in
the following definition:
Definition A.1 (Deniability of an Encrypted Messaging Scheme).
We say an encrypted messaging scheme
E = (send(ğ‘š, ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ), receive(ğ‘ğ‘¡, ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ))
satisfies deniability if there exists an efficient simulation algorithm
SimE(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š) that produces a transcript of ğ‘ˆğ‘  sending the mes-
sage ğ‘š using E to ğ‘ˆğ‘Ÿ without access to the private keys of ğ‘ˆğ‘  or