Primary and alternate WINS server addresses for the alternate configuration for the connection 
Advanced TCP/IP properties 
If you have specified an alternate configuration, you can also specify the IPv4 addresses of a primary 
and an alternate WINS server. Figure 12-1 shows an example of configuring a primary WINS server on 
the Alternate Configuration tab. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 346 
Figure 12-1  Primary and alternate WINS servers on the Alternate Configuration tab 
To manually configure IPv4 addresses of WINS servers or to configure additional settings on a WINS 
client, open the properties dialog box for the Internet Protocol Version 4 (TCP/IPv4) or Internet 
Protocol (TCP/IP) component, click Advanced on the General tab, and then click the WINS tab. 
Figure 12-2 shows an example. 
Figure 12-2  The WINS tab from the advanced configuration of the Internet Protocol Version 4 (TCP/IPv4) component 
On the WINS tab, you can configure an ordered list of WINS servers that the computer queries. The 
WINS servers configured in WINS addresses, in order of use override the WINS server addresses 
received through DHCP. 
Manual Configuration of the WINS Client Using Netsh 
You can also configure the IPv4 addresses of WINS servers from the command line using the Netsh 
tool and the following command: 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 347 
netsh interface ip set wins [name=]ConnectionName [source=]dhcp|static 
[addr=]IPv4Address|none  
The netsh interface ip set wins command parameters are as follows: 
ConnectionName is the name of the connection as it appears in the Network Connections folder. 
source is either dhcp, which sets DHCP as the source for configuring WINS servers for the specific 
connection, or static, which sets the source for configuring WINS servers to the WINS tab in the 
advanced properties of the Internet Protocol Version 4 (TCP/IPv4) or Internet Protocol (TCP/IP) 
component. 
IPv4Address is either an IPv4 address for a WINS server or none, which clears the list of WINS 
servers. 
To configure a remote computer, use the –r RemoteComputer parameter as the last parameter in the 
command line. You can specify RemoteComputer with either a computer name or an IPv4 address. 
Configuration of the WINS Client for Remote Access Clients 
Remote access clients (using either dial-up access or a virtual private network connection) obtain the 
initial configuration of a primary and an alternate WINS server during the negotiation of the Point-to-
Point Protocol (PPP) connection. RFC 1877 defines the Internet Protocol Control Protocol (IPCP) 
Primary NBNS Server Address and Secondary NBNS Server Address options. Computers running 
Windows XP or Windows Server 2003 also use a DHCPInform message to obtain an updated list of 
WINS servers. If a remote access server running Windows Server 2003 is correctly configured with the 
DHCP Relay Agent routing protocol component, the remote access server forwards the DHCPInform 
message to a DHCP server and forwards the response (a DHCPAck message) back to the remote 
access client. 
If the remote access client receives a response to the DHCPInform message, the WINS servers in the 
DHCPAck message replace the WINS servers configured using IPCP. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 348 
The WINS Server Service 
The WINS Server service in Windows Server 2003 supports the following features: 
An RFC-compliant NBNS  
Static mapping maintenance 
You can manually add entries to the WINS server database for the NetBIOS names of non-WINS 
clients. 
WINS server replication 
To ensure that NetBT nodes can resolve any NetBIOS name on the network by querying any WINS 
server, the WINS Server service supports database replication between WINS servers. 
Installing the WINS Server Service 
To install the WINS Server service on Windows Server 2008, do the following: 
1. Click Start, point to Programs, point to Administrative Tools, and then click Server Manager. 
2. In the console tree, right-click Features, and then click Add Features. 
3. Under Features, select the WINS Server check box, and then click Next. 
4. Click Install.  
You can install the WINS Server service for Windows Server 2003 in the following ways: 
As a Windows component using the Add or Remove Programs item in Control Panel. 
With the Manage Your Server Wizard. 
To install the WINS Server service with the Add or Remove Programs item in Control Panel, use the 
following steps: 
1. Click Start, click Control Panel, double-click Add or Remove Programs, and then click 
Add/Remove Windows Components. 
2. In Components, select the Networking Services check box, and then click Details.  
3. In Subcomponents of Networking Services, select the Windows Internet Name Service (WINS) 
check box, click OK, and then click Next.  
4. If prompted, in Copy files from, type the full path to the installation files for Windows Server 2003, 
and then click OK. 
To install the WINS Server service, you must be a member of the Administrators group on the local 
computer, or you must have been delegated the appropriate authority. If the computer is joined to a 
domain, members of the Domain Admins group might be able to perform this procedure. 
To configure the WINS Server service, you configure the properties for the WINS server, static 
mappings, and replication. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 349 
Properties of the WINS Server 
To modify the properties of a WINS server, open the WINS snap-in, right-click the name of the server in 
the tree, and then click Properties. Figure 12-3 shows an example of the resulting properties dialog 
box. 
Figure 12-3  The properties dialog box for a WINS server 
From this dialog box, you can configure properties on the following tabs: 
General  You can specify how often to refresh the WINS statistics that appear in the Active 
Registrations node in the WINS snap-in, what the path to the WINS backup database is, and whether 
to backup the WINS database when the WINS Server service is shut down. 
Intervals  You can specify various WINS server timers that Table 12-1 lists. 
Database Verification  You can enable the periodic checking of database consistency to help maintain 
database integrity among WINS servers in a large network. 
Advanced  You can enable the logging of detailed events to the system event log and enable and 
configure burst handling to distribute peak loads during WINS client registration or renewal. You can 
also specify the path for the WINS database, the starting version ID number (used to track changes in 
the local WINS database), and whether to allow NetBIOS names that are compatible with Microsoft 
LAN Manager. 
Configuration option 
Description 
Renewal Interval 
Specifies how often a client must reregister its name. 
This is the TTL for the NetBIOS name registration or 
renewal. The default value is six days. 
Extinction Interval 
Specifies the interval between when a database entry 
is marked as released and when it is marked as 
extinct. The default depends on the renewal interval 
and, if the WINS server has replication partners, on 
the maximum replication time interval. You cannot 
specify an interval that is longer than six days. 
Extinction Timeout 
Specifies the interval between when an entry is 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 350 
marked extinct and when the entry is removed from 
the database. The default depends on the renewal 
interval and, if the WINS server has replication 
partners, on the maximum replication time interval. 
The default value is six days. 
Verification Interval 
Specifies the interval after which the WINS server 
must verify whether old names that it does not own are 
still active. The default depends on the extinction 
interval. You cannot specify an interval that is longer 
than 24 days. 
Table 12-1  WINS server timers 
Static Entries for Non-WINS Clients 
If a WINS client tries to connect to a non-WINS client on a remote subnet, the name of the non-WINS 
client cannot be resolved because it is not registered with the WINS server. On a network that has 
NetBT nodes that do not support WINS (non-WINS clients), you can configure static mappings of the 
NetBIOS names used by each non-WINS client to its IPv4 address. By configuring these mappings in a 
WINS server database, you ensure that a WINS client can resolve NetBIOS names of non-WINS clients 
without having to maintain a local or central Lmhosts file. 
To configure a static mapping, do the following: 
1. Open the WINS snap-in, open a server name in the tree, right-click Active Registrations, and then 
click New Static Mapping. 
2. In the New Static Mapping dialog box, type the computer name of the non-WINS client in Computer 
name. 
3. In NetBIOS scope, type the NetBIOS scope ID for the computer name if needed. The use of a 
NetBIOS scope ID is not recommended. For more information about NetBIOS scope IDs, see 
Chapter 11, "NetBIOS over TCP/IP." 
4. In Type, click the entry type to indicate whether the name is a unique name or a kind of group with a 
special name, as described in Table 12-2. 
5. In IP address, type the IPv4 address of the non-WINS client. 
6. Click OK. 
The mapping is immediately added as an entry in the WINS database. 
Type option 
Description 
Unique 
A unique name maps to a single IPv4 address. 
Group 
Also referred to as a normal group. When adding an 
entry to a group by using the WINS snap-in, you must 
type the computer name and IPv4 address. However, 
the WINS database does not store the IPv4 addresses 
of individual members of a group. Because the 
member addresses are not stored, you can add as 
many members as you want to a group. Clients send 
broadcast name packets to communicate with group 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 351 
members. 
Domain Name 
A NetBIOS name-to-IPv4 address mapping that has 
0x1C as the 16th byte of the NetBIOS name. A 
domain name is a NetBIOS Internet group that stores 
up to 25 addresses for group members. For 
registrations after the 25th address, WINS overwrites 
a replicated address or, if none exist, WINS overwrites 
the oldest registration. 
Internet Group 
Internet groups are user-defined groups that enable 
you to group resources, such as printers, for easy 
reference. An Internet group can store up to 25 
addresses for members. A group member that was 
added by a WINS client, however, does not replace a 
group member added by using the WINS snap-in or by 
importing an Lmhosts file. 
Multihomed 
A unique name that can have more than one address. 
This type of entry is used for a computer with multiple 
network adapters or assigned IP addresses 
(multihomed computers). You can register up to 25 
addresses as multihomed. For registrations after the 
25th address, WINS overwrites a replicated address 
or, if none exist, WINS overwrites the oldest 
registration. 
Table 12-2  Static WINS mapping type options 
Figure 12-4 shows an example of a static WINS mapping. 
Figure 12-4  An example of a WINS static mapping 
Database Replication Between WINS Servers 
You can configure all WINS servers on a network to fully replicate their database entries with other 
WINS servers. This functionality ensures that a name registered with one WINS server is eventually 
replicated to all other WINS servers and allows any WINS client, regardless of which WINS server it is 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 352 
configured with, to resolve any valid NetBIOS name on the network. Database replication can occur 
whenever the WINS database changes, including when a NetBIOS name is released.  
Replicating databases allows a WINS server to resolve NetBIOS names that have been registered with 
other WINS servers. For example, if Host A registered with WINS Server 1 and Host B registered with 
WINS Server 2, NetBIOS applications on Host A and Host B cannot communicate unless WINS Server 
1 and WINS Server 2 replicate their databases to each other. 
To replicate database entries between a pair of WINS servers, you must configure each WINS server 
as a pull partner, a push partner, or both with the other WINS server. 
A push partner is a WINS server that sends a message to its pull partners, notifying them that it has 
new WINS database entries. When a WINS server’s pull partner responds to the message with a 
replication request, the WINS server sends (pushes) copies of its new WINS database entries (also 
known as replicas) to the requesting pull partner. 
A pull partner is a WINS server that pulls WINS database entries from its push partners by requesting 
any new WINS database entries that the push partners have. The pull partner requests the new WINS 
database entries that have a higher version number than the last entry the pull partner received during 
the most recent replication. 
Figure 12-5 shows an example replication configuration between WINS servers in Sydney and Seattle 
and the resulting information flow. 
Figure 12-5  Example push-and-pull partner configuration and resulting information flow 
Although you configure push and pull partners separately, the typical configuration is to have two WINS 
servers exchange information in both directions. In this case, both WINS servers will be push and pull 
partners with each other. 
WINS servers replicate only any new entries in their databases. Servers do not replicate their entire 
WINS databases each time replication occurs. 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 353 
Push and Pull Operations 
The initiation of information being exchanged between two WINS servers can happen through either a 
push operation or a pull operation. In a push operation, a WINS server notifies its pull partners that it 
has new entries that it wants to send. The WINS server sends out a directed “Have new entries” 
notification to all pull partners. The pull partners respond with a “Send new entries” notification. The 
originating WINS server then sends the new entries. 
To initiate a push operation, the WINS Server service relies on a push trigger specified during the 
configuration of WINS replication. A push trigger is based on a threshold of a certain number of entries 
that have changed, regardless of the time it takes to reach the threshold. 
Figure 12-6 shows the push operation. 
Figure 12-6  The push operation 
Using the example in Figure 12-6, the Sydney WINS server has been configured with a push trigger of 
1000 entries. When 1000 entries in the Sydney WINS database have changed, it initiates a push 
operation with the Seattle WINS server. 
In a pull operation, pull partners send a “Send new entries” notification to their push partners. The push 
partners then respond with all the new entries. To initiate a pull operation, the WINS Server service 
relies on a pull trigger specified during the configuration of WINS replication. A pull trigger is based on 
scheduled times, regardless of the number of entries to be sent. 
Figure 12-7 shows the pull operation. 
Figure 12-7  The pull operation 
In the example in Figure 12-7, the Seattle WINS server has been configured with a pull trigger of every 
day at 12:00 AM. At 12:00 AM each day, the Seattle WINS server initiates a pull operation with the 
Sydney WINS server. 
For both push and pull operations, the data flows from the push partner to the pull partner. The push 
partner always pushes the actual replicated entries to the pull partner. The main difference between 
Chapter 12 – Windows Internet Name Service Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 354 
push and pull operations is the nature of the trigger (number of changed entries or a scheduled time) 
and which replication partner sends the first notification. 
Configuring a WINS Server as a Push or Pull Partner 
Determining whether to configure a WINS server as a pull partner or a push partner depends on the 
network environment. Keep these rules in mind when you configure WINS server replication: 
Configure pull replication between sites, especially across slow links, because you can configure pull 
replication to occur at specific intervals. 
Configure push replication when servers are connected by fast links, because push replication occurs 
when the configured number of updated WINS database entries is reached. 
Figure 12-8 shows an example of WINS server replication. 
Figure 12-8  Example of a WINS server replication configuration 
In this example: 
All WINS servers at each site use push replication to push their new database entries to a single server 
at their site. 