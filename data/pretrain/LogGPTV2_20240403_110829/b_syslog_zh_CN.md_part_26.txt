### 优化后的文本

#### 错误消息：341006
**错误消息**：%ASA-3-341006: 存储设备不可用。未能停止模块 %s 的恢复。
**说明**：所有 SSD 都已发生故障或在系统处于恢复状态下被删除。系统尝试停止恢复，但操作失败。
**建议的操作**：更换已删除或故障的硬盘，并重新加载 ASA。

#### 错误消息：341007
**错误消息**：%ASA-3-341007: 存储设备不可用。模块 %s 的恢复已被停止。此过程可能需要几分钟时间完成。
**说明**：所有 SSD 都已发生故障或在系统处于恢复状态下被删除。系统正在停止恢复软件模块。
**建议的操作**：更换已删除或故障的硬盘，并重新加载软件模块。

#### 错误消息：341008
**错误消息**：%ASA-3-341008: 未找到存储设备。模块 %s 的自动启动已取消。请安装驱动器并重新加载以再次尝试。
**说明**：系统进入启动状态后，所有 SSD 在重新加载系统前都已发生故障或被删除。由于启动期间的默认操作是自动启动软件模块，因此因无可用存储设备而受阻。
**建议的操作**：更换已删除或故障的硬盘，并重新加载软件模块。

#### 错误消息：341010
**错误消息**：%ASA-6-341010: 序列号为 ser_no 的存储设备 [插入 | 移除] 到 bay_no 槽位。
**说明**：ASA 检测到存储设备的插入或移除事件，并立即生成此系统日志消息。
**建议的操作**：无需执行任何操作。

#### 错误消息：341011
**错误消息**：%ASA-3-341011: 序列号为 ser_no 的存储设备在 bay_no 槽位出现故障。
**说明**：ASA 每 10 分钟轮询一次 HDD 的运行状态，如果 HDD 处于故障状态，则生成此系统日志消息。
**建议的操作**：无需执行任何操作。

#### 错误消息：342001
**错误消息**：%ASA-7-342001: REST API 代理成功启动。
**说明**：必须先成功启动 REST API 代理，REST API 客户端才能配置 ASA。
**建议的操作**：无。

#### 错误消息：342002
**错误消息**：%ASA-3-342002: REST API 代理失败，原因：reason。
**说明**：REST API 代理可能无法启动，或者因各种原因崩溃，具体原因在消息中指定。
**建议的操作**：根据记录的原因采取相应措施。例如，当 Java 进程耗尽内存时，REST API 代理会崩溃。此时，需重启 REST API 代理。如果重启不成功，请联系 Cisco TAC 确定根本原因并修复。

#### 错误消息：342003
**错误消息**：%ASA-3-342003: 收到 REST API 代理故障通知。代理将自动重启。
**说明**：已收到来自 REST API 代理的故障通知，系统正在尝试重新启动该代理。
**建议的操作**：无。

#### 错误消息：342004
**错误消息**：%ASA-3-342004: 自动重启 REST API 代理失败，经过 5 次尝试后仍无法启动。使用 'no rest-api agent' 和 'rest-api agent' 命令手动重启代理。
**说明**：多次尝试后，REST API 代理仍然无法启动。
**建议的操作**：查看系统日志 %ASA-3-342002（如有记录），以了解故障背后的原因。输入 `no rest-api agent` 命令禁用 REST API 代理，然后使用 `rest-api agent` 命令重新启用。

#### 错误消息：342005
**错误消息**：%ASA-7-342005: REST API 映像已成功安装。
**说明**：必须先成功安装 REST API 映像，才能启动 REST API 代理。
**建议的操作**：无。

#### 错误消息：342006
**错误消息**：%ASA-3-342006: 安装 REST API 映像失败，原因：reason。
**说明**：REST API 映像可能因以下原因之一而安装失败：版本检查失败、映像验证失败、找不到映像文件、闪存空间不足或挂载失败。
**建议的操作**：管理员应修复故障并尝试使用 `rest-api image` 重新安装映像。

#### 错误消息：342007
**错误消息**：%ASA-7-342007: REST API 映像已成功卸载。
**说明**：必须先成功卸载旧的 REST API 映像，才能安装新的映像。
**建议的操作**：无。

#### 错误消息：342008
**错误消息**：%ASA-3-342008: 卸载 REST API 映像失败，原因：reason。
**说明**：由于以下原因之一而无法卸载 REST API 映像：卸载失败或 REST 代理已启用。
**建议的操作**：管理员应先禁用 REST 代理，然后尝试卸载 REST API 映像。

### 第 4 章 系统日志消息 400000-450001

本章包含以下各节：
- ID 介于 400000 到 409128 之间的消息
- ID 介于 410001 到 450001 之间的消息

#### ID 介于 400000 到 409128 之间的消息

**错误消息**：%ASA-4-4000nn: IPS:number string from IP_address to IP_address on interface interface_name
**说明**：消息 400000 至 400051 是思科入侵防御服务签名消息。
**建议的操作**：参阅 Cisco.com 上的《思科入侵防御服务用户指南》。

在此版本中，并非所有签名消息都受 ASA 支持。IPS 消息均以 4-4000nn 开头，并采用以下格式：
- number：签名编号。有关更多信息，请参阅 Cisco.com 上的《思科入侵防御服务用户指南》。
- string：签名消息 - 与 NetRanger 签名消息基本相同。
- IP_address：签名适用的本地到远程地址。
- interface_name：发起签名的接口名称。

例如：
- %ASA-4-400013 IPS:2003 ICMP redirect from 10.4.1.2 to 10.2.1.1 on interface dmz
- %ASA-4-400032 IPS:4051 UDP Snork attack from 10.1.1.1 to 192.168.1.1 on interface outside

下表列出了支持的签名消息。

| 消息编号 | 签名 ID | 签名标题 | 签名类型 |
|----------|---------|----------|----------|
| 400000   | 1000    | IP选项-错误选项列表 | Informational |
| 400001   | 1001    | IP选项-记录数据包路由 | Informational |
| 400002   | 1002    | IP选项-时间戳 | Informational |
| 400003   | 1003    | IP选项-安全 | Informational |
| 400004   | 1004    | IP选项-松散源路由 | Informational |
| 400005   | 1005    | IP选项-SATNETID | Informational |
| 400006   | 1006    | IP选项-严格源路由 | Informational |
| 400007   | 1100    | IP分段攻击 | 攻击 |
| 400008   | 1102    | 不可能的IP数据包 | 攻击 |
| 400009   | 1103    | IP分段重叠 | 攻击 |
| 400010   | 2000    | ICMP回应应答 | Informational |
| 400011   | 2001    | ICMP主机不可达 | Informational |
| 400012   | 2002    | ICMP源抑制 | Informational |
| 400013   | 2003    | ICMP重定向 | Informational |
| 400014   | 2004    | ICMP回应请求 | Informational |
| 400015   | 2005    | 数据报的ICMP超时 | Informational |
| 400016   | 2006    | 数据报上的ICMP参数问题 | Informational |
| 400017   | 2007    | ICMP时间戳请求 | Informational |
| 400018   | 2008    | ICMP时间戳应答 | Informational |
| 400019   | 2009    | ICMP信息请求 | Informational |
| 400020   | 2010    | ICMP信息应答 | Informational |
| 400021   | 2011    | ICMP地址掩码请求 | Informational |
| 400022   | 2012    | ICMP地址掩码应答 | Informational |
| 400023   | 2150    | 分段的ICMP流量 | 攻击 |
| 400024   | 2151    | 大ICMP流量 | 攻击 |
| 400025   | 2154    | 死亡之Ping攻击 | 攻击 |
| 400026   | 3040    | TCPNULL标志 | 攻击 |
| 400027   | 3041    | TCPSYN+FIN标志 | 攻击 |
| 400028   | 3042    | 仅TCPFIN标志 | 攻击 |
| 400029   | 3153    | 指定了不正确的FTP地址 | Informational |
| 400030   | 3154    | 指定了不正确的FTP端口 | Informational |
| 400031   | 4050    | UDP炸弹攻击 | 攻击 |
| 400032   | 4051    | UDPSnork攻击 | 攻击 |
| 400033   | 4052    | UDPChargenDoS攻击 | 攻击 |
| 400034   | 6050    | DNSHINFO请求 | Informational |
| 400035   | 6051    | DNS区域传输 | Informational |
| 400036   | 6052    | 来自高端口的DNS区域传输 | Informational |
| 400037   | 6053    | 所有记录的DNS请求 | Informational |
| 400038   | 6100    | RPC端口注册 | Informational |
| 400039   | 6101    | RPC端口取消注册 | Informational |
| 400040   | 6102    | RPC转储 | Informational |
| 400041   | 6103    | 通过代理发送的RPC请求 | 攻击 |
| 400042   | 6150    | ypserv（YP服务器后台守护程序）端口映射请求 | Informational |
| 400043   | 6151    | ypserv（YP绑定后台守护程序）端口映射请求 | Informational |
| 400044   | 6152    | yppasswdd（YP密码后台守护程序）端口映射请求 | Informational |
| 400045   | 6153    | ypupdated（YP更新后台守护程序）端口映射请求 | Informational |
| 400046   | 6154    | ypxfrd（YP传输后台守护程序）端口映射请求 | Informational |
| 400047   | 6155    | mountd（装载后台守护程序）端口映射请求 | Informational |
| 400048   | 6175    | rexd（远程执行后台守护程序）端口映射请求 | Informational |
| 400049   | 6180    | rexd（远程执行后台守护程序）尝试 | Informational |
| 400050   | 6190    | statd缓冲区溢出 | 攻击 |

#### 错误消息：401001
**错误消息**：%ASA-4-401001: 规避规则已清除
**说明**：已输入 `clear shun` 命令以删除内存中的现有规避规则。记录规避活动的机制已启用。
**建议的操作**：无需执行任何操作。

#### 错误消息：401002
**错误消息**：%ASA-4-401002: 规避规则添加：IP_address IP_address port port
**说明**：已输入 `shun` 命令，其中第一个 IP 地址是被规避的主机。其他地址和端口可选，用于终止连接（若可用）。记录规避活动的机制已启用。
**建议的操作**：无需执行任何操作。

#### 错误消息：401003
**错误消息**：%ASA-4-401003: 规避规则删除：IP_address
**说明**：单台被规避的主机已从规避规则数据库中删除。记录规避活动的机制已启用。
**建议的操作**：无需执行任何操作。

#### 错误消息：401004
**错误消息**：%ASA-4-401004: 被规避的数据包：IP_address = IP_address on interface interface_name
**说明**：由于 IPSRC 定义的主机是规避规则数据库中的主机，因此数据包已被丢弃。被规避的主机无法在规避它的接口上传输流量。例如，互联网上的外部主机可能会被外部接口规避。系统提供被规避主机的活动记录。此消息和消息 %ASA-4-401005 可用于进一步评估有关此主机的风险。
**建议的操作**：无需执行任何操作。

#### 错误消息：401005
**错误消息**：%ASA-4-401005: 添加规避规则失败：无法为 IP_address IP_address port port 分配资源
**说明**：ASA 内存不足，无法应用规避规则。
**建议的操作**：思科 IPS 应继续尝试应用此规则。请尝试回收内存并重新手动应用规避规则，或等待思科 IPS 执行此操作。

#### 错误消息：402114
**错误消息**：%ASA-4-402114: IPSEC: 收到了一个协议数据包 (SPI=spi, 序列号=seq_num) 从 remote_IP 到 local_IP，具有无效的 SPI。
- protocol: IPsec 协议
- spi: IPsec 安全参数索引
- seq_num: IPsec 序列号
- remote_IP: 隧道远程终端的 IP 地址
- username: 与 IPsec 隧道关联的用户名
- local_IP: 隧道本地终端的 IP 地址
**说明**：收到了指定 SA 数据库中不存在的 SPI 的 IPsec 数据包。这可能是 IPsec 对等体之间 SA 老化存在细微差异引起的临时情况，也可能是因为本地 SA 已清除所引起的。这也可能表示 IPsec 对等体发送的数据包不正确，这可能属于攻击操作。此消息的出现频率限制为每五秒内最多一次。
**建议的操作**：对等体可能不会确认本地 SA 已清除。如果从本地路由器建立新连接，则这两个对等体随后可能成功地重新建立连接。否则，如果问题持续超过一小段时间，则请尝试建立新连接或联系对等体管理员。

#### 错误消息：402115
**错误消息**：%ASA-4-402115: IPSEC: 从 remote_IP 到 local_IP 收到了 act_prot 数据而不是 exp_prot 数据。
- remote_IP: 隧道远程终端的 IP 地址
- local_IP: 隧道本地终端的 IP 地址
- act_prot: 收到的 IPsec 协议
- exp_prot: 预期 IPsec 协议
**说明**：收到了缺少预期 ESP 报头的 IPsec 数据包。对等体正在发送与协商的安全策略不匹配的数据包，这可能表示受到了攻击。此消息的出现频率限制为每五秒内最多一次。
**建议的操作**：联系对等体管理员。

#### 错误消息：402116
**错误消息**：%ASA-4-402116: IPSEC: 收到了一个协议数据包 (SPI=spi, 序列号=seq_num) 从 remote_IP (username) 到 local_IP。解封的内部数据包与协商策略不符。数据包指定其目标为 pkt_daddr，其源为 pkt_saddr，其协议为 pkt_prot。SA 指定其本地代理为 id_daddr/id_dmask/id_dprot/id_dport，其远程代理为 id_saddr/id_smask/id_sprot/id_sport。
- protocol: IPsec 协议
- spi: IPsec 安全参数索引
- seq_num: IPsec 序列号
- remote_IP: 隧道远程终端的 IP 地址
- username: 与 IPsec 隧道关联的用户名
- local_IP: 隧道本地终端的 IP 地址
- pkt_daddr: 解封的数据包的目的地址
- pkt_saddr: 解封的数据包的源地址
- pkt_prot: 解封的数据包的传输协议
- id_daddr: 本地代理 IP 地址
- id_dmask: 本地代理 IP 子网掩码
**说明**：解封的 IPsec 数据包与协商的身份不匹配。对等体正在通过此安全关联发送其他流量，这可能是由对等体的安全关联选择错误引起的，也可能是攻击活动。此消息的出现频率限制为每五秒内最多一次。
**建议的操作**：联系对等体管理员。