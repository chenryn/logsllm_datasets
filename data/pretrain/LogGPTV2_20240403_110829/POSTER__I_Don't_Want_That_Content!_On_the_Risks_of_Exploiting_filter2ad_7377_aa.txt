# POSTER: I Don't Want That Content! On the Risks of Exploiting Bitcoin's Blockchain as a Content Store

**Authors:**
- Roman Matzutt
- Oliver Hohlfeld
- Martin Henze
- Robin Rawiel
- Jan Henrik Ziegeldorf
- Klaus Wehrle

**Affiliation:**
Communication and Distributed Systems, RWTH Aachen University, Germany

**Contact:**
PI: EMAIL

## Abstract
Bitcoin has revolutionized digital currencies, and its underlying blockchain technology has been successfully applied to various other domains. The blockchain maintains every transaction in a persistent, distributed, and tamper-proof log, which all participants must replicate locally. While this is a key innovation and a desirable feature, it can also be misused to store harmful content. This paper examines how blockchains, particularly Bitcoin's, can be used to store (malicious and illegal) content that, once stored, cannot be removed and is replicated by every participating user. We study the evolution of content storage in Bitcoin's blockchain, classify the stored content, and discuss the implications of allowing arbitrary data storage in globally replicated blockchains.

## 1. Introduction
Bitcoin [9] and its underlying blockchain technology have transformed digital currencies and influenced other research areas. As of August 2016, Bitcoin remains the most popular cryptocurrency with a market capitalization of $9.52 billion [6] and approximately 5,200 active nodes [4]. Motivated by its success, the blockchain has been adapted to other domains, including distributed naming services [1], digital notary services [7], and smart contracts [13]. This highlights that blockchain technology is both a practical paradigm for securing sensitive assets and an active area of research.

While Bitcoin is designed as a cryptographic currency, the underlying blockchain can be (mis-)used as a general-purpose content store. Although this possibility has been discussed [8, 2] and some example contents have been identified [11], it has received less attention than other well-studied properties of Bitcoin, such as financial privacy [14, 15]. Our work aims to fill this gap by providing a systematic analysis of arbitrary content in Bitcoin's blockchain. Storing arbitrary content on a blockchain can be critical to the system's operability: users must download the entire blockchain (or trust potentially malicious peers) to participate. Furthermore, since a blockchain is a persistent and tamper-proof write-only log, its contents are virtually unerasable. Injecting arbitrary (and potentially malicious or illegal) content can harm the entire system, as users are forced to download and store illegal content. Our preliminary analysis reveals that Bitcoin's blockchain contains roughly 400 links to illegal services, which each user stores on their hard disk.

We assess this risk by surveying different methods for data storage in Bitcoin's blockchain and empirically analyzing the content. Our analysis focuses on Bitcoin because it is the oldest and most widespread blockchain-based system, providing the largest dataset. We show the chronological development of content storage methods and discuss the motivations for storing arbitrary data in the blockchain. This work aims to open a debate on the appropriate use of blockchain technology in single-purpose systems (e.g., Bitcoin) as a general-purpose persistent content store.

## 2. Storing Blockchain Content
We briefly introduce the concept of blockchains and the methods used to embed arbitrary content into them. Blockchains consist of a chain of cryptographically linked blocks holding use-case-specific data. For example, Bitcoin's blockchain is intended to hold monetary transactions from one user to another. Technically, Bitcoin uses a stack-based scripting language to specify the conditions under which bitcoins can be spent (in an output script). Funds can only be spent in new transactions containing an input script that satisfies these conditions. Output scripts typically require a user to create a signature that can be verified with a specific public key. Although Bitcoin's scripting language is more powerful, the Bitcoin reference client only accepts standard transactions of up to 100 KB that use output scripts from a restricted set of templates. However, miners can include non-standard transactions that do not follow these rules.

### Methods for Storing Arbitrary Data in Bitcoin's Blockchain:
1. **Coinbase Transactions:** These transactions reward miners with newly created bitcoins. The input script of a coinbase transaction encodes the block's position in the blockchain in a variable-length field. Inconsistencies between this length field and the input script can contain up to 100 bytes of arbitrary data. Miners use this for additional randomness or unofficial feature voting.
   
2. **P2PK(H) Transactions:** Pay-to-Pubkey (P2PK) and Pay-to-Pubkey-Hash (P2PKH) transactions are the most widely used standard transactions in Bitcoin. Users can replace the public key (hash) with up to 65 bytes (resp. 20 bytes) of data per output script at the expense of making the bitcoins permanently unspendable. A single transaction can hold up to 83.2 KB of arbitrary data distributed over 4,161 P2PKH outputs (or 98.3 KB using 1,513 obsolete P2PK outputs).

3. **Nulldata Transactions:** Added to the reference client in June 2013 (development version) and March 2014 (release version), nulldata transactions allow users to attach small pieces of data to regular transactions without destroying bitcoins. Nulldata transactions may only hold up to 83 bytes.

4. **Non-Standard Transactions:** Output scripts can be extended with semantically irrelevant parts, such as dead if-branches or noneffective stack operations. Such transactions can combine content storage with a transaction behavior equivalent to a P2PK(H) transaction without destroying bitcoins. This method allows for storing up to 99.6 KB for a transaction of standard size, but most miners discard such transactions.

## 3. Evolution of Content Storage
To assess the impact of arbitrary content on blockchain-based systems, we analyze the evolution of content stored on Bitcoin's blockchain. We employ heuristics to detect transactions holding non-transactional data and extract:
- All coinbase transactions with â‰¥ 10 printable ASCII characters or known vote flags.
- All P2PK(H) and multisig transactions with at least 90% of printable ASCII characters.
- All nulldata transactions with non-empty payloads.
- All non-standard transactions containing output scripts not using a standard transaction template.

Our heuristics might occasionally lead to false positives, with a probability of < 10^-5 for P2PKH transactions and coinbase transactions (which have a median length of 18 bytes).

Based on our heuristics, we analyzed the Bitcoin blockchain from its emergence in 2009 until the end of July 2016, covering approximately 146 million transactions (77.67 GB of data). Figure 1 depicts the rise of data storage per transaction type. In total, 0.80% of the transactions store data in the blockchain.

![Figure 1: Evolution of number of transactions with arbitrary data for individual storage methods.](path_to_figure_1)

---

This optimized text provides a clearer, more coherent, and professional presentation of the original content.