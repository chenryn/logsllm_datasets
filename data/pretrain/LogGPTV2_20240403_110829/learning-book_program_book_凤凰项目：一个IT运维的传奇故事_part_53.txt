---
## Page 178
响哦。
韦斯打断他：“不，不，不，比尔说的是“部署步骤’。我们不要转移话题—”
韦斯正说着，我回想起埃瑞克一定要我像个工厂经理那样思考，而不是像个工作中心主管那样思考。我突
然意识到，也许他的意思是我应该跨越开发部和IT运维部之间的部门界限。
“你们两个说得都对。“我打断书斯和威廉，说道，“威廉，你介意把所有步骤都写在白板上吗？我建议从“代
码提交'开始，写出移交给我们团队之前的所有步骤。”
他点点头，走到白板前开始面方框，一边曲一边讲解那些步骤。接下来的十分钟里，他证明了一共有一白
多个步骤，包括在开发环境下运行的自动测试、创建与开发相吻合的QA环境、朝其中部署代码、运行所有
测试、部署并移至与QA相吻合的新仿真环境、负载测试，最后再把接力棒传给IT运维部。
威廉弄完后，白板上有了三十个方框。
我看了看书斯，发现他并没有显得烦躁不安，反而看起来像是陷入了沉思，一边望着图表，一边摩着下
巴。
我示意布伦特和韦斯顺着威廉的步骤继续写下去。
布伦特站起身来，开始面方框，这些方框表示要部署的代码包，准备新的服务器实例，载入并配置操作系
统、数据库及应用程序，对网络、防火墙及负载平衡器开展各种变更，随后进行测试，确保部署大功告
成。
每个都有着不同的机器、人员、方法和测评。也许IT工作比生产制造复杂得多。IT工作不仅是无形的，因
我凝视看整个图表，令人惊讶的是，它让我想起了工厂车间。其中的一个个步骤就像是一个个工作中心
此更难追踪，而且可能出错的地方也要多得多。
有无数的配置需要正确地设定，系统要有足够的内存，所有文件都要安装到正确的位置，所有代码和整个
环境也需要正确地操作。
哪怕是一个小小的失误就能让一切崩塌。这显然意味着，我们应该比生产制造领域更加严格，更守纪律
更有规划性，
我等不及想把这些告诉埃瑞克。
意识到我们面临挑战的重要性和深远影响，我走向白板，拿起了红色记号笔。我说：“我要对之前上线期间
存在问题的步骤画上大大的红星。”
我一边开始在白板上作记号，一边解释：“由于没有新的QA环境，我们使用了一个旧的版本：由于测试失
败，我们对QA环境进行了代玛和环境变更，而这从未回到开发或生产环境之中：由于我们从未把全部环境
都同步，下一轮时又遇到了同样的问题。”
我画了一连串的红星，又走向布伦特的方框。“由于没有正确的部署指南，我们经过五个来回才拿到了正确
的代码包和部署脚本。由于没有正确地搭建环境，在生产中又发生了崩溃。没有正确搭建环境的问题我之
前已经提过了。”
尽管我并非有意为之，但完成后，威廉和布伦特的方框边上几乎全都标上了红星。
我转过身，当大家领会到我这么做的用意时，每个人脸上都写满了沮丧。我意识到自己犯了一个潜在的错
误，急忙补充道：“看，我不是为了责怪谁，或者说我们干得很精。我只是想把我们做的事确切地写下来，
对每个步骤有一些客观的考量。我们一起来攻克白板上的问题，而不要相互指责，好吗？”
帕蒂说：“你知道，这让我想起了我以前见过工厂里的人一直使用的一件东西，要是现在有工厂里的人走进
来，我猜他们会认为我们创建了一张·价值流图”。你介意我添加一些元素吗？”
---
## Page 179
我把记号笔递给她，坐回椅子上。
她询问了每个方框里操作步骤所需的时间，然后在方框上方简单记下数字。接着，她询问这个步骤是否通
常是工作必须等待的地方，然后在方框前画上三角形，代表半成品。
天哪。对帕蒂来说，我们的部署和工厂生产线之间的相似性，并不是什么学术问题。她是真的把我们的部
署当作一条工厂生产线了！
她用的是精益生产的工具和技巧，制造业的从业人员用其记录并改进流程。
突然之间，我明白了埃瑞克提到的"部署管道"指的是什么。尽管与在制造工厂里不同，你无法看到我们的
工作，但它依然是一条价值流。
我更正了自已的观点。那是我们的价值流。我相信，我们即将找到办法，让通过其间的工作流明显增加。
帕蒂记录完各步骤的时长后，修改了方框，用短标签表示流程步骤。她在一块单独的白板上写下两个要
点：“环境"和"部署”。
她指者自己刚才写的内容说：“在现有流程下，有两个间题不断出现：在部署流程的每个阶段，在我们需要
的时候，部署环境却总是没有就绪，即使已经准备就绪了，也需要大量返工才能让它们彼此同步。对吗？“
韦斯哼了一声，说：“没必要讲得那么直白吧，不过你是对的。”
她继续说：“返工和准备时间过长间题的另一个显著来源是代码打包流程，在此阶段，IT运维部对经过开爱
部检查的内容进行版本控制，然后生成部署包。尽管克里斯和他的团队尽可能地记录代码和配置，总还有
东西会遗漏，这些东西只有在部署之后，代码无法在环境中运行时才会被发现。对吗？”
这一次，韦斯没有立刻回答。布伦特抢在他前头说：“完全正确，威康大概能理解这些问题：发布指南从不
更新，所以我们总要手忙脚乱地收十残局，只好重写安装脚本，并且一次又一次地安装..”
“没错。"威廉说着，坚定地点点头。
“那么，我建议我们聚焦这两个方面，“她说着看了看白板，随后再次坐下，“有什么建议吗？”
布伦特说：“也许威廉和我可以一起编一本关于部署运行的书，把我们从错误中吸取的各种教训都收集起
来？”
我点点头，倾听每个人的想法，但是似乎没有人提出我们所需要的那种突破性建议。埃增克描述过如何减
少车门冲压流程的准备时间。他似乎暗示过那很重要。但是，为什么？
“让每个项目团队都拼凑出一个生产环境是不可行的，我们要做的事，必须让我们向这个一天十个部署'的
目标迈进一大步。“我说，“这就意味着我们需要大量的自动化操作。布伦特，我们要怎么做才能创建一个
通用环境创建流程，从而在同一时刻同时构建开发、QA和生产环境，并让它们保持同步？“
“有趣的想法。"布伦特看着白板说。他站起身来，画了三个方框，分别叫作“开发”、“QA"和“生产”。然后
他在它们下方面了另一个叫作“构建过程*的方框，这个方框有三个箭头，分别指向上方的三个方框。
环境，开发人员至少就能真正在一个与生产环境相似的环境下编写代码了。单单这一点就是个巨大的改
进。”
他从嘴里拿出记号笔盖，继续说道：“为了构建风凰的环境，我们编写并使用了很多脚本。只要做些记录和
梳理工作，我敢打赌，我们可以在几天内凑出一些有用的东西来。”
我对克里斯说：“这看起来很有希望。如果能把环境标准化，并把这些环境投入开发部、QA和IT运维部的
日常使用，我们就能消除大部分在部署流程中因差异而导致的悲剧。“
---
## Page 180
克里斯看起来很兴奋。“布伦特，要是你和其他人都不介意，我想邀请你参加我们的团队冲刺，那样我们就
能尽早把环境创建整合到开发流程之中。当前，我们最关注的是在项目结束时拿出可部署的代码。我提议
我们改变这一需求。在每次为期三周的冲刺间隔里，我们不仅应该拿出可部署的代码，还应该拥有部署这
些代码的确切环境，并在版本控制中一并对部署环境的情况进行检查。”
研究一下刚才帕蒂强调的另一个问题吗？即使我们采纳了克里斯的建议，仍然存在部署脚本的问题。假如
我们有一根魔法棒，一旦有一个新的QA环境，我们应该怎样部署代码？我们每次部署的时候，都像打乒乓
球那样不断把代码、脚本以及天晓得其他什么东西来回传来传去。”
帕蒂附和道：“在生产车间里，一且看到工作往回走，那就是返工。一且发生此事，可以肯定，文档记录和
信息流的数量将会变得很少，那就意味着没有可复制的东西，而且随着我们加快速度，久而久之，情况会
继续恶化。他们把这个称为"非价值附加*活动或者·废料'。”
她看着画满方框的第一块白板说：“如果我们重新设计流程，就需要让正确的人员事先介入，这就像是制造
工程组确保所有零部件都设计得有利于生产，而生产线也规划得有利于零部件的流转，理想状态下达到单
一工作流。”
我点点头，想着帕蒂的介绍与今天早些时候埃增克的建议很类似，不禁微笑起来。
我对威廉和布伦特说：“好吧，伙计们，你们有魔法棒了：你们要身先士卒。告诉我，你们会怎样设计生产
线，让工作永远不会往回走，让工作流快速高效地向前移动？”
他们俩都一脸茫然地看着我，我有些恼火地说：“你们有一根魔法棒！使用它！”
“这根魔法棒有多大？"威廉问。
我重复了之前对玛姬说的话：“这是一根非常强大的魔法棒。它能做任何事。”
威廉走到白板前，指着一个名叫“代码提交"的方框说：“如果我能挥舞这根魔法棒，我就会改变这个步骤。
不再通过源代码控制从开发部获得源代码或编译代码，而是希望拿到准备部署的打包好的代码。”
做这件事。她将负责开发交接。一旦代码被标记为“准备测试”，我们就要生成并提交代码包，那会触发一个
QA环境的自动部署，今后，也许连生产环境也能自动部署，“
包？”
“开什么玩笑？“布伦特大笑着说，“不管这个人是谁，今年余下的时间里我都会请他喝啤酒！我喜欢这个主
意。而且我希望能帮助构建新的部署工具。我说过，我写过一大堆工具，我们可以从这些工具入手。
我能感受到会议室里涌动的活力和兴奋之情。我很惊讶，从我们认为”一天十个部署"的目标是一种妄想，
到思考如何接近这个目标，转变过程是如此之快。
突然，帕蒂拍起头说：“等一下。整个风凰模块都要处理客户购买数据，这必须受到保护，难道约翰的团队
不该也派个人加人进来吗？”
我们面面相观，同意他也应该参与。我再一次惊叹，作为一个组织，我们的改变是如此之大。
---