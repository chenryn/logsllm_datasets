  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Barnaby_prime Function = Permanent Modification 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Jtagulator  
=  
Awesome Sauce 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Thank You  
Joe Grand! 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Software Symbiote Defense on 
•   ARM, MIPS 
•   Cisco 7961G 
•   Cisco 2821 & 1841 
•   HP 2055 LaserJet
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
There is NO protection from a 
polyculture… 
A cacophony can play nice…. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Market & Legal 
Implications 
Why vendors seem not to care,  
for now…. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
The market doesn’t care? 
•  What you don’t see won’t hurt you… 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
More of this is needed? 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Or this…. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
It’s not just about function and price  
•  What if our phones attack our servers? 
•  The legal liability issues have not been 
tested 
–  But they will be… 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
And then  there is government… 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Customer awareness means… 
•  Vendors will respond… 
•  Software Symbiotes are ready  
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
SunSet	
  @	
  P3wnT0wn	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
More About Software Symbiote Technology 
[www.redballoonsecurity.com] 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
OffenseDemo 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Reverse tunnel from printer to outside host. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Offense konsole launched. printer added as target. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Synscan command issued over tunnel to printer. 
Printer synscans inside network and finds targets. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Printer used to find MAC to IP mappings. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Recon4 renamed to phone2 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
ARP poisoning phone2. Phone2 now thinks printer 
is its TFTP server. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Proxy built from from printer to outside host. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
SSH in from outside, through printer proxy, to phone 
using authorized_keys file (supplied by printer). 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Phone has MTD with world write permission and 
utilities to erase and write NAND flash. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Small block written to MTD containing small filesystem 
with one setuid, shell-popping binary. Root shell earned. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
All offense targets containing the packet scrubber rootkit 
added to konsole. Heartbeat devices through tunnel to 
find memory fingerprints. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Using memory fingerprint, we can lookup pre-computed 
values about the printer in offline firmware database. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Getinfo for the 2821 router. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Use command and control packets to read phone 
memory. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Use command and control to write phone memory. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Read phone memory again to see results of write 
operation. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Normal Cisco router behavior: three bad enable secrets 
keeps user at unprivileged level. ‘show version’ shows 
router information. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
The barnaby command makes multiple writes to the 2821 router. It makes the check 
password function always return success and overwrites the ‘show version’ string. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Enable secret bypassed. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Barnaby Jack’s face in ‘show version’ output. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Enable bypass and Barns on the 1841 router. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Offense Demo 
Results of making printer DOS router. CPU goes to 
99% utilization. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
DefenseDemo 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Defense Konsole. All Symbiote protected targets 
reporting that they are secure. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Cisco 7961 exploit launched. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Symbiote detects change in static region of memory. 
Reported checksum changes and phone state now reports 
that it has been exploited. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
‘show cdp neighbor’ modified to change router 
memory, simulating exploit. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Symbiote detects 2821 router exploit. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Similar simulated attack on the 1841 router. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Symbiote detects 1841 router exploit. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
Defense Demo 
Using the printer command and control write command 
to change printer memory. Symbiote detects the exploit. 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
More About Software Symbiote Technology 
[www.redballoonsecurity.com] 
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013	
8/1/13	
Cui,	
  Costello,	
  Kataria,	
  Stolfo,	
  Blackhat	
  USA	
2013