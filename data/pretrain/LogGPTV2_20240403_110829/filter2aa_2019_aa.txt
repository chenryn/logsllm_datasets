Chip & PIN is definitely broken
Credit Card skimming and PIN harvesting
in an EMV world
Andrea Barisani
Daniele Bianco
Chip & PIN is definitely broken ­ v1.3
 Copyright 2011 Inverse Path S.r.l.
Adam Laurie
Zac Franken
What is EMV?
EMV stands for Europay, MasterCard and VISA, the global 
standard for inter-operation of integrated circuit cards (IC cards 
or "chip cards") and IC card capable point of sale (POS) terminals 
and automated teller machines (ATMs), for authenticating credit 
and debit card transactions.
IC card systems based on EMV are being phased in across the 
world, under names such as "IC Credit" and "Chip and PIN".
Source: Wikipedia
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Why EMV?
 ICC / smartcard
 improved security over existing magnetic stripe technology
 “offline” card verification and transaction approval
 multiple applications on one card
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Liability shift
 liability shifts away from the merchant to the bank in most 
cases (though if merchant does not roll EMV then liability 
explicitly shifts to it)
 however the cardholder is assumed to be liable unless they 
can unquestionably prove they were not present for the 
transaction, did not authorize the transaction, and did not 
inadvertently assist the transaction through PIN disclosure
 PIN verification, with the help of EMV, increasingly becomes 
“proof” of cardholder presence
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Liability shift
 VISA Zero Liability fine print (US):
Does not apply to ATM transactions, PIN transactions not processed by Visa, or 
certain commercial card transactions. Individual provisional credit amounts are 
provided on a provisional basis and may be withheld, delayed, limited, or 
rescinded by your issuer based on factors such as gross negligence or fraud, 
delay in reporting unauthorized use, investigation and verification of claim and 
account standing and history. You must notify your financial institution 
immediately of any unauthorized use. Transaction at issue must be posted to 
your account before provisional credit may be issued. For specific restrictions, 
limitations and other details, please consult your issuer.
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Liability shift
Canadian Imperial Bank of Commerce (CIBC) spokesman Rob 
McLeod said in relation to a $81,276 fraud case: “our records 
show that this was a chip-and-PIN transaction. This means [the 
customer] personal card and personal PIN number were used 
in carrying out this transaction. As a result, [the customer] is 
liable for the transaction.”
The Globe and Mail, 14 Jun 2011
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV adoption
 03/2006 EPC Card Fraud Prevention Task Force presentation: 
“Ban of magstripe fallback foreseen (date to be decided)”
 as of 03/2011 magstripe fallback is still accepted pretty much 
everywhere
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV is broken
 S. J. Murdoch, S. Drimer, R. Anderson, M. Bond, “Chip and PIN 
is Broken” - University of Cambridge
 the excellent group of researchers from Cambridge proved 
that stolen cards can be successfully used without knowing the 
PIN
 the industry claims difficult practicality of the attacks, at least 
one bank rolled out detection/blocking procedures
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Skimming, Cloning and PIN harvesting
 skimmer: hidden electronic device that intercepts card <> 
terminal communication and collects available data
 we analyze the practicality of credit card information 
skimming, cloning and PIN harvesting on POS terminals
 we intentionally ignore magstripe skimming (which is still 
effective and widely used) and focus on the chip interface
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
ATM skimmers
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV skimmers
 we predict that skimming the chip will become an extremely 
appealing target to fraudsters
 the chip interface is inherently accessible
 it becomes impossible for the user to verify if the terminal has 
been tampered as the chip interface is not visible (unlike most 
magstripe one for POS terminals)
 an EMV skimmer could go undetected for a very long time 
and requires little installation effort
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV skimmer
 trivial installation by “hooking” with a special card
 powered by the POS itself
 data can be downloaded with a special card recognized by the 
skimmer
 little development effort + cheap
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV smartcards
 information is stored on a filesystem organized in applications, 
files and records
 the terminal talks to the card via APDU messages for reading 
records and issuing commands
   Examples:
   00A404000E315041592E5359532E4444463031  ICC exchange
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Terminal <> ICC exchange
1
|
initiate application processing
2
|
read application data
3
|
offline data authentication (if indicated in the AIP)
4
|
cardholder verification (if indicated in the AIP)
5
|
issuer script processing
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Read application data
 stored with BER-TLV templates and read by the terminal, some 
examples:
       tag name
      ----|----------------------------------------
        4f Application Identifier (VISA)
      5f2d Language Preference (itenfrde)
      9f1f Track 1 Discretionary Data
        57 Track 2 Equivalent Data
      5f25 Application Effective Date
      5f24 Application Expiration Date
        5a Application PAN (credit card number)
        8e Cardholder Verification Method (CVM) List
      5f20 Cardholder Name
      9f36 Application Transaction Counter (ATC)
      9f17 PIN Try Counter
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV application data - magstripe clone
 Copyright 2011 Inverse Path S.r.l.
The CVV (228) matches the magstripe one only for cards that do 
not use iCVV (a different stored value to protect against this 
attack, introduced in January 2008 but not present on all cards)
Chip & PIN is definitely broken ­ v1.3
EMV application data - magstripe clone
 while the service code on the magstripe might indicate that 
the chip must be used, inserting a card without a readable 
chip will trigger magstripe fallback on all tested terminals 
 EMV skimmers cannot clone successfully to magstripe if iCVV 
is used
 however it is fair to say that  the possibility of massive 
harvesting + being protected by a 3 digits code is not a 
comforting scenario
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
EMV application data - online usage
 application data can be used to perform Card Not Present 
transactions (online, phone, ...) with parties that do not check
Card Security Code (CVV, CVV2, ...) and do not employ 3-D 
secure (Verified by Visa, MasterCard SecureCode also known 
as phishing heaven)
 if you think that the amount of websites that do not check the 
security code is negligible...think again
 ironically one of the authors has been defrauded on such sites 
while this presentation was being written...
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
 Copyright 2011 Inverse Path S.r.l.
optional security code
Chip & PIN is definitely broken ­ v1.3
Offline data authentication
 depending on the chip technology three methods are 
available: Static Data Authentication (SDA), Dynamic Data 
Authentication (DDA), Combined Data Authentication (CDA)
 used by the terminal to validate the authenticity of the card
 enables offline transactions where supported
 never used by ATM (always online)
 Visa and MasterCard mandate all cards issued after 2011 to 
use DDA
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Static Data Authentication (SDA) cards
 cheapest and most widely used technology
 selected records (advertised by the card and customized by 
the issuer) are signed with a static signature
 symmetric key is used for online transactions
 offline PIN verification is always cleartext
     8f: Certificate Authority Public Key Index (PKI)  
     90: Issuer PK Certificate
   9f32: Issuer PK Exponent
     92: Issuer PK Remainder
     93: Signed Static Application Data
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Dynamic Data Authentication (DDA) cards
 chip is more expensive, rare usage as of 2011
 static data validation (against hash within certificate)
 dynamic data validation, terminal asks the card to sign data + 
random number with ICC PK
 ICC PK embeds PAN (limiting private key usage to this card)
 offline PIN verification can be cleartext or enciphered
     8f: Certificate Authority Public Key Index (PKI)
     90: Issuer PK Certificate       9f46: ICC PK Certificate
   9f32: Issuer PK Exponent          9f47: ICC PK Exponent
     92: Issuer PK Remainder         9f48: ICC PK Remainder
   9f49: Dynamic Data Authentication Data Object List (DDOL)
 Copyright 2011 Inverse Path S.r.l.
Chip & PIN is definitely broken ­ v1.3
Chip cloning
 SDA cards can be cloned and used without PIN for offline 
transactions only (“Yes” card)
 DDA cards clone ineffective for offline and online transactions, 
however a valid DDA card can be used to pass offline 
authentication and perform fake offline transaction (not tied 
to the authentication)
 offline transactions are rare in EU
 Copyright 2011 Inverse Path S.r.l.