### 漏洞评估与安全测试

**术语澄清**
从专业术语的角度来看，本章节所描述的漏洞评估实际上是指安全测试工具而非安全评估工具。为保持语言的一致性，应将其称为“漏洞测试”，但我们继续沿用CISSP官方知识体系中的描述。

### 15.2.1 漏洞扫描
漏洞扫描是一种自动化过程，用于探测系统、应用程序和网络中的潜在弱点，这些弱点可能被攻击者利用。这类扫描工具提供快速且易于操作的测试方法，无需手动干预即可执行繁琐的任务。大多数工具支持周期性的预定扫描，并能生成报告，显示不同时间点的安全风险变化情况。

漏洞扫描主要分为以下三种类型：网络发现扫描、网络漏洞扫描和Web应用程序漏洞扫描。每种类型的扫描都有多种工具可以实现。

#### 警告
值得注意的是，信息安全专家并不是唯一拥有漏洞测试工具的人。攻击者同样可以使用这些工具，在尝试入侵前对目标系统进行漏洞测试。通过这种方式，攻击者能够识别出最易受攻击的系统并集中资源进行攻击。

### 1. 网络发现扫描
网络发现扫描通过多种技术对一系列IP地址进行扫描，以查找开放网络端口的系统。这种扫描并不直接检测系统的漏洞，而是生成一份关于网络中活动系统的报告及端口清单。这份清单展示了防火墙和服务器之间公开的端口路径。

网络发现扫描器使用多种技术来识别远程系统中的开放端口，常见的技术包括：
- **TCP SYN扫描**：向每个被扫描的端口发送带有SYN标志的数据包，代表请求建立新连接。如果收到SYN和ACK标志的响应，则表明该端口是开放的。此扫描也被称为“半开放”扫描。
- **TCP连接扫描**：尝试与指定端口上的远程系统建立全连接。当用户没有权限运行“半开放”扫描时，可以采用这种方法。
- **TCP ACK扫描**：发送带有ACK标志的数据包，表明它是现有连接的一部分。
- **Xmas扫描**：发送带有FIN、PSH和URG标志的数据包，由于其标志设置丰富，因此得名“圣诞树”。

**提示**
若对TCP三次握手的具体机制不熟悉，可以在第11章“网络安全架构与保护网络组件”中找到详细解释。

nmap是一款广泛使用的开源网络发现扫描工具，最初于1997年发布，至今仍在维护和更新。绝大多数安全专家在其职业生涯中都会定期使用nmap。您可以通过http://nmap.org下载免费版本或获取更多信息。

当nmap扫描系统时，它能够识别每个网络端口的状态：
- **开放**：端口在远程系统上是开放的，有一个应用程序正在监听该端口。
- **关闭**：端口在远程系统上可用，但没有应用程序监听。
- **过滤**：nmap无法确定端口状态，可能是由于防火墙干扰了连接请求。

图15.1展示了nmap在Linux系统中扫描一个Web服务器的例子。使用者执行以下命令：
```
nmap -vv 52.4.85.159
```
nmap软件开始对该IP地址进行详细模式下的端口扫描。扫描结果显示，系统有三个活动端口：22（开放）、80（开放）和443（关闭）。这表明该系统正在接受SSH和HTTP连接请求，但未启用HTTPS服务。

**分析结果**
- **22/tcp open ssh**：系统在TCP端口22上接受连接，通常用于SSH服务。
- **80/tcp open http**：系统在端口80上接受HTTP连接请求，用于Web页面传输。
- **443/tcp closed https**：防火墙允许访问端口443，但系统未运行相应的HTTPS服务。

从这些结果中，我们可以推断出该系统很可能是一台Web服务器，允许来自外部的非加密连接。攻击者可能会进一步探索该系统，例如：
- 在浏览器中输入`http://52.4.85.159`查看Web服务器的默认页面。
- 由于连接未加密，攻击者可能试图窃取敏感信息。
- 开放的SSH端口可能成为暴力破解的目标，以获得进一步的系统访问权限。

此外，nmap还支持对整个网络范围内的系统进行扫描。例如，图15.3展示了对192.168.1.0/24网段的扫描结果，涵盖了192.168.1.0到192.168.1.255的所有IP地址。

希望这些优化后的文本能够更加清晰、连贯和专业。