within the current tab. If no proper record is found, the global
tracing method is run to identify the previous access record
from the user’s entire past access records. In most cases, our
scheme analyzes a single user’s access records in one browser
tab, so the analysis is more efﬁcient than the one that do not
minimize the scope of the analysis. The details of the four
methods mentioned above are elaborated below.
Reload tracing A "reload" transition type indicates that
the page is reloaded. This includes the following cases: (1)
The reload button/menu on the browser was pressed/selected,
(2) the same URL as the previous access was entered in the
address bar of the browser, (3) the session was reconstructed
by selecting one of the recently closed tabs in the browser’s
history menu, and (4) a browser set to continue where its user
left off on startup was started. In all cases, the tab URL and
96    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
Source-tab tracing•Referertracing•Mainframe tracingIn-tab tracing•Referertracing•Mainframe tracingGlobal tracing•Referertracing•Origin tracing•Mainframe tracingReload tracing•In-tab reload tracing•Global reload tracingTransition type = reload?Source tabid?Access record  found?TrueFalseExistDoesn’t existNoYesEndStartStabrecord by running the main frame tracing technique.
Identifying access path entry points
3.2
The processes described in Section 3.1 are iterated until they
identify the ﬁrst access of the hazardous path, i.e., the entry
point. We regard an access that do not follow links and is
discontinuous from the previous access as an entry point. The
following types of accesses are considered as entry points.
Bookmark access A user may jump to the desired page by
selecting a bookmark entry on the browser. We determine that
the user came to the page by selecting a bookmark when the
transition type is set to "auto_bookmark."
Session reconstruction Sessions can be reconstructed, for
example, by selecting one of the recently closed tabs in the
browser’s history menu. We determine that the user came to
the page by reconstructing a past session if the transition type
was set to "reload" and no access was found on the same tab
for more than a predeﬁned amount of time. Note that we do
not include the access records prior to session reconstruction
in the hazardous path in this paper, but we could include such
access records in the path for different analyses.
Web search A user can ﬁnd various pages of interests by
submitting a new search query on general web search engines.
We determine that a new web search is initiated if (1) the
URL is one of the top pages of major search engines2, or (2)
the transition type is "form_submit" and the URL is a search
result page of major search engines3. Access records with a
source tab ID are excluded because there must be precedent
accesses in the speciﬁed tab. Note that site-speciﬁc search
engines that are often available for many streaming services
and pornography sites are not included.
Omnibar access The omnibar on the Chrome browser
combines an address bar with the Google search box. Users
can use the omnibar to initiate a web search or access
their browsing history. The omnibar also suggests keywords
to improve search results. The transition type "generated"
identiﬁes access that is based on the selection of choices
provided by the omnibar.
2In this work, we use the following URLs to determine the top
pages of major search engines: https://www.baidu.com/, https://www.
bing.com/, https://duckduckgo.com/, https://www.google.co.jp/,
https://www.google.com/, https://www.yahoo.co.jp/, and https:
//www.yahoo.com/.
3In this work, we determine URLs containing one of the following strings
as search result pages: https://www.baidu.com/s?, https://www.bing.
com/search, https://duckduckgo.com/?q=, https://www.google.co.
jp/, https://www.google.com/search?, https://search.yahoo.co.
jp/search, or https://search.yahoo.com/search.
Address typing Users often enter a new URL to initiate
another browsing activity; however, as part of ongoing
browsing activity, they also often modify the current URL
in the address bar to browse another page, e.g., the top page
of the current site. Therefore, we consider the page with the
"typed" transition type as an entry point if the domain of the
page differs from the previous page. Note that if the typed
URL is one of the major search engines, we see it as an
initiation of a new access path; however, we label the access
as a web search rather than new URL typing.
Start page access When the Chrome browser starts, the
page speciﬁed by the program argument or set as the default
opens. If the transition type is "start_page," we consider that
the browser was launched and that the page was speciﬁed in
the program argument or set as the default page. Note that the
transition type is set to "start_page" if a user accesses a link
on an external application, e.g., an email application, because
the Chrome browser is then launched with the URL of the
link as its argument on the OS.
3.3 Case Studies
We extract hazardous paths by applying the techniques
described in Sections 3.1 and 3.2. Two cases are described in
this section to demonstrate their effectiveness.
Table 1 shows an entire hazardous path that reaches a
URL labeled "SOCIAL_ENGINEERING" by GSB. First,
the in-tab tracing method identiﬁed access to a subframe
page in the same tab at 16:14:40 as its previous access using
referer information. It then identiﬁed access to a main frame
page in the same tab at 16:14:39 as its previous access using
referer information. Then, the global tracing method identiﬁed
access to a main frame page at 16:14:13 in another tab as
its previous access using referer information. The in-tab
tracing method then identiﬁed access to a main frame page at
16:13:54 in the same tab as its previous access using referer
information. Now, we see that the page’s transition type was
set to "auto_bookmark;" thus we consider this page as the
initial access of the hazardous path.
Table 2 shows an entire hazardous path that reaches a URL
labeled "MALWARE" by GSB. Our in-tab tracing method
identiﬁed the latest past main frame access in the same tab
at 15:33:37 as its previous access. Note that the record of
the main frame access was complemented using the scheme
mentioned in Section 2.3. Our in-tab tracing method then
identiﬁed the latest past main frame accesses in the same tab
at 15:33:26, 15:32:35, and 15:32:08 as the previous accesses.
The source-tab tracing method then identiﬁed the latest past
main frame access on the source tab at 15:31:50 as its previous
access. Similarly, the in-tab tracing method identiﬁed previous
accesses by monitoring main frame and referer information.
Identiﬁcation of these previous accesses led to the initial
access, which was accessed from a bookmark, at 15:26:57.
USENIX Association
23rd International Symposium on Research in Attacks, Intrusions and Defenses    97
Table 1: Hazardous path on August 19, 2019 ("SOCIAL_ENGINEERING" label was set by GSB)
Time
(JST)
16:13:54
16:14:13
16:14:39
16:14:40
16:14:41
Tab URL(cropped)
ID
193
193
200
200
200
https://avgle.com/video/UNXIII —
https://avgle.com/search/video
—
https://avgle.com/video/odaqWq —
https://olmsoneenh.info/ajWpZ. —
https://10-81.s.cdn15.com/cr/3
—
Source Transition
tab ID
Resource
type
type
auto_bookmark mframe
form_submit
mframe
mframe
link
sub_frame
auto_subframe
—
image
Tracing method
in-tab (referer)
global (referer)
in-tab (referer)
in-tab (referer)
—
mframe: main_frame
Time
(JST)
15:26:57
15:27:14
15:27:26
15:28:28
15:31:50
15:32:08
15:32:35
15:33:26
15:33:37
15:33:37
Table 2: Hazardous path extracted on August 28, 2019 ("MALWARE" label was set by GSB)
Tab URL(cropped)
ID
182
182
182
182
http://javtorrent.re/category/
http://javtorrent.re/?s=080819
http://javtorrent.re/uncensore
http://javtorrent.re/?s=HEYZO-
Source Transition
tab ID
Resource
type
type
auto_bookmark mframe
mframe
form_submit
mframe
link
form_submit
mframe
Tracing method
in-tab (referer)
in-tab (referer)
in-tab (mframe)
in-tab (mframe)
(omitted 18 access records)
182
403
403
403
403
403
http://javtorrent.re/uncensore
https://www.google.com/search?
https://7mmtv.tv/zh/uncensored
https://www.google.com/search?
http://javhuge.com/Momoki%20
http://javhuge.com/zb_users/th
182
link
link
link
link
—
—
mframe
mframe
mframe
mframe
complemented
stylesheet
source-tab (mframe)
in-tab (mframe)
in-tab (mframe)
in-tab (mframe)
in-tab (mframe)
—
4 Unveiling User Behavior
Web access data collected at the user side reveals user IDs and
browser tab IDs, enabling us to efﬁciently reconstruct access
paths, as described in Section 3. It also provides data that are
not collected on the network, such as transition type. With
the transition type information, we can identify access path
entry points as described in Section 3.2, and such information
can be used to analyze user behavior. In this section, we
demonstrate the usability of the data collected on the user side
by analyzing them and unveiling user behavior. Speciﬁcally,
we answer the following questions: (1) what are the initial
accesses of hazardous paths? (2) what is the risk level of
bookmarked URLs? (3) how long does it take for users to
reach malicious URLs? and (4) how many active browser tabs
do users open when accessing malicious URLs? Answers
to these questions may not directly provide any solution
for improving user protections; however, they will deepen
understanding of victims and will be a basis for future studies.
4.1 Path entry point analysis
Considering the measures implemented by recent browsers,
accidentally reaching a malicious URL from the ISP’s portal
site or via a major search engine has become increasingly
infrequent; however, users still reach malicious URLs through
mframe: main_frame, o_referer: origin-only referer
Table 3: Types of path entries (February 2019–January 2020)
Types of
initial accesses
Bookmark access
Web search
955 (14.5%)
Session reconstruction 814 (12.3%)
689 (10.4%)
Omnibar access
646 (9.8%)
Address typing
179 (2.7%)
Start page access
Link access
107 (1.6%)
Total
Entries of
Entries of
hazardous paths
all paths
3,213 (48.7%) 1,331,170 (38.6%)
541,046 (15.7%)
600,366 (17.4%)
581,223 (16.8%)
89,966 (2.6%)
307,536 (8.9%)
6,496 (100%) 4,403,471 (100%)
—
web browsing. To understand their browsing activities, we
analyze the types of initial accesses on hazardous paths, i.e.,
hazardous path entry points. Table 3 shows the breakdown
of the types of initial accesses on hazardous paths over 12
months. These types are identiﬁed based on the deﬁnition
provided in Section 3.2. For reference, it also shows the
breakdown of the types of initial accesses on all paths
including hazardous and non-hazardous paths.
"Bookmark access" was the most frequent entry point.
Many users reach malicious URLs via a bookmark, which
shortens the path from a portal site or search engine to
malicious sites. "Web search" was the second most frequent
98    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
entry point. Users enter a hazardous path by submitting a
query to a general search engine. One typical scenario of this
entry type was that users obtained a keyword from the web
before they submitted a query to a search engine. For example,
while browsing the adult section of a legitimate shopping
site, a user found the identiﬁer of a pornographic video, e.g.,
product code. The identiﬁer was used to retrieve the web
and, consequently, the user reached an illegitimate site, which
eventually lead to a malicious URL. "Session reconstruction"
accounted for third most frequent entry points. If we combine
the paths before and after the session reconstructions, the path
will become lengthy. Naturally, a lengthy path has a higher
probability of reaching malicious URLs because more sites
are visited, including those that are many hops away from the
search engine result pages or browsers’ start pages. "Omnibar
access" was the fourth most frequent entry point, followed by
"address typing." All of these path entry types shorten the path
between the portal site or search engine and the malicious
site. In this context, they are shortcuts in the access path to a
malicious URL. "Start page access" was also found to be an
entry point to hazardous paths; however, the number of this
type of entry point is small compared with the other types.
Apart from these, several entry points are labeled as "link
access." These are cases where the transition type of the
access record is "link," though no appropriate previous access
is found within the log we analyzed, making the access
record discontinuous. Considering the meaning of the label
"link" assigned by the Google API, there should be some
previous accesses prior to the entry. The lack of previous
accesses may occur due to either of the following reasons.
First, previous access was performed prior to the ﬁrst log
record. Accesses prior to the ﬁrst day of the month could not
be traced because we conduct per-month analysis in this work.
Second, the collected logs are incomplete, be it intentionally
or accidentally, as we discussed in Section 2.3.
Figure 3 shows the breakdown of the types of initial
accesses on hazardous paths for each month. The general
trend of the breakdown is the same during these months
except July 2019. There were several users who typed
many URLs in the address bar of the browser in July 2019
and reached malicious URLs, though their motivations were
unknown.
4.2 Bookmarked URL analysis
Table 4 shows the domains of bookmarked URLs, i.e.,
bookmark domains, that most frequently reach malicious
URLs in descending order of the number of accesses. Note
that only the accesses through the selection of bookmark
entries are counted. As can be seen, the list includes
pornography sites, illegal book/manga sharing sites, and ﬁle
sharing sites. However, it also contains legitimate search
engines, such as google.com and yahoo.co.jp. Considering
the total number of accesses on any path, the percentage of
Figure 3: Breakdown of the types of path entries
Table 4: Top 10 bookmark domains that most frequently reach
malicious URLs (February 2019–January 2020)
Access counts on
all paths
3,566
1,260