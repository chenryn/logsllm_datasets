visible, but they remain within the document and therefore can be use to extract information. 
Errors and negligent or malicious behaviors may cause this kind of data be part of the 
documents the organization publishes or send out. 
 Figure 33: Data hidden by document’s format 
3.7 OTHER PLACES WHERE TO LOOK FOR DATA 
The list of places where undesired data may appear is very long: comments, style sheets, 
hyperlinks to Intranet servers, or even parameters or variable names in VBScript macros… All 
this data can be easily retrieved using a hexadecimal editor or a string extraction program. 
Figure 34: Strings extracted from an OOXML file using bintext 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 19 of 29 
3.8 HIDDEN METADATA 
So far, this part about Microsoft Office has dealt with metadata and information easily 
accessible, and sometimes editable, by the user. But there is another kind of data that is stored 
inside documents and is not available to the user. 
These metadata are used by Microsoft Office in order to perform its own tasks. And they may 
contain compromising information such as software versions, authors, revision history, the last 
person who edited it and when he did it, the last time the document was printed, which printer 
was used, total editing time for the document, information about e-mail messages including e-
mail addresses, and even, in some earlier versions of Office, a Global Unique ID that identifies 
the computer on which the document was edited. 
Figure 35: Extracted document’s metadata using Libextractor 
3.9 DATABASE CONNECTIONS 
Information stored in a particular file depends on the Microsoft Office version used and the file 
format. Sometimes, if document is using an external source to be constructed even information 
about databases and ODBC drivers can be retrieved. The following image shows a SELECT 
query, configured ODBC drivers, the database server, database itself and the password too.   
Figure 36: Database info 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 20 of 29 
Putting it in clear text in figure 36, we have: 
SELECT pruebas_0.apellidos, pruebas_0.nombre, pruebas_0.tlf FROM  
pruebasmetadata.pruebas   pruebas_0 
DATABASE=pruebasmetadata 
DRIVER={MySQL ODBC 3.51 Driver} OPTION=0 
PWD=PassMETADATA 
PORT=0 SERVER=servidor 
UID=UsuarioMETADATA 
A hexadecimal editor is, again, all it takes to read this data from a document. As can be seen, 
this is a special document created to generate documents changing some special parts which 
are coming from a database repository. 
3.10 PRINTERS 
As it was seen before, revision history provides information about user accounts and paths that 
may relate to server names and shared resources. Another compromising hidden piece of 
information that can be found inside documents is printer data. 
Figure 37: Information about printer 
As in ODF documents, sensitivity of this information depends on the way printer had been 
configured.  When the printer is shared on a server, it can appear in UNC format, thus providing 
a server name and a shared resource and even the server’s IP address, revealing the way the 
internal network has been addressed. 
Although this is quite important by itself it is giving more information to a potential attacker just 
because if document´s creator is using that printer then it means that user has access to that 
resource so, of course, that user is a valid one in server’s. Hence, at the end, it´s also possible 
to discover information about network’s ACLs. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 21 of 29 
Figure 38: Printer in UNC format 
Microsoft Office versions prior to Office 97 seldom include this information into document 
metadata. But all versions do update it if they find it, changing its value to the name of the 
printer currently in use, even if the document is not printed: a simple edition and saving is all it 
takes. Hence, documents which have been used by the organization since those old Office 97 
times must be carefully inspected for printer data. 
3.11 DOCUMENT ANALYSIS AND CLEANING 
Cleaning Microsoft Office documents before sending or publishing them is a must, since they 
may contain huge amounts of undesired data. The ultimate tool for accomplishing this task is 
the “Inspect Document” option available in Office 2007. It searches for all metadata and hidden 
information, including printer data or revision history, and gives the user the option to remove it 
all from the document. No matter what version of Microsoft Office was used no create and edit 
the document, “Inspect Document” will clean it with only a few clicks. 
Figure 39: Preparing document in Microsoft Office 2007 (yes, it´s Spanish) 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 22 of 29 
Previous versions of Microsoft Office didn’t provide this option. For that reason, Microsoft 
released a plug-in to improve software with cleaning options. This tool is known as RHDTool 
and it´s available for downloading in the following URL:  
http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=144e54ed-d43e-
42ca-bc7b-5446d34e5360  
Figure 40: RHDTool 
Also, Microsoft has published some guides to help users to minimize the amount of metadata in 
their documents (their URLs are in the References section of this paper).  
Another option is using third party tools, like Metadata Extractor o Doc Scrubble. It must be 
said, anyway, that from the tests made it can be deduced that sometimes these tools don’t clean 
all metadata and hidden information. For example, the following image shows DocScrubble 
options, and, for instance, although a document was cleaned using DocScrubble, it keeps 
containing printer data. 
Figure 41: Printer info remains inside the file 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 23 of 29 
It has been said that converting Microsoft Office to other formats may be a solution to the 
problems stated in this article, in particular, converting them to PDF format. But PDF files store 
information too, both in the “Data Dictionary” and in XMP streams. 
These metadata may include user accounts, file paths, URLs pointing to Intranet servers, e-mail 
message headers including e-mail addresses, information about the Operating System and 
more. 
Figure 42: PDF Metadata including Intranet references 
But even converting documents to TXT format may not be enough, even if they contain no 
metadata at all. When a document is published in the corporate web, it becomes available to 
web search engines, as Google, MSN Search or Yahoo. And this search engines create new 
metadata about them: they give them a title, provide an abstract of their content as part of the 
results and store a cached version. 
As that search engine generated metadata is created based upon the document content, any 
lost data that the document contains may turn into metadata. 
4 METADATA EXTRACTION TOOLS 
There are several tools to retrieve metadata from documents, depending on their format. 
Maybe, libextractor is the best known of them all. It features a library of functions to access 
document’s properties and a standalone program, called “extract” which parses and extracts 
metadata from several file formats, including Microsoft Office documents, ODT, PDF and many 
more. The support for Microsoft Word DOC files includes extraction of the revision history, being 
one of the few tools freely available to accomplish this task. 
Metagoofil is a program that downloads documents from web sites and afterwards extracts 
metadata from them using extract tool, making the process of fingerprinting corporate networks 
easier. 
Exiftool is another open source metadata extraction tool. Originally designed to extract EXIF 
information from image files, it can process a huge amount of file formats, including again 
Microsoft Office Documents. When present, it can retrieve GUID information from old versions 
Microsoft Word files. Another remarkable feature of Exiftool is the way it deals with PDF 
documents, being able to extract both Data Dictionary and XMP metadata. It has an option that 
allows in deep scanning for XMP metadata even if it has been disassociated from the PDF file 
main tree structure. Both extract and exiftool are command line utilities. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 24 of 29 
There are tools to extract metadata through a GUI, like ExifReader. Anyway, this kind of 
programs tends to be less flexible and powerful than their command line alternatives. 
But all these programs deal mostly with metadata and don’t pay much attention to hidden 
information, with the exception of extract and its revision history processing. Neither printer 
information, templates paths, nor database information can be obtained by them. To solve this 
problem, new tools have to be made. And that’s why the FOCA tool was created. 
FOCA uses web search engines to locate documents, download them and extracts metadata 
and hidden information from them. It can retrieve information from several file formats, including 
Microsoft Office documents, ODF, Word Perfect files and more, and the range of information 
obtained is wider that the one achieved with any other tool mentioned here. 
5 SEARCH ENGINES 
When a document is published in the corporate web, it becomes available to web search 
engines, such as Google, Live Search or Yahoo. These search engines create new metadata 
about them: they give them a title, provide an abstract of their content as part of the results and 
store a cached version. 
As that search-engine-generated metadata is created based upon document’s content, any lost 
data document contains may turn into metadata. That is even worse if document does not 
contain title or customized metadata helping search engines to create a short description of it. 
With a little Google Hacking work, addressing metadata fields as the “title” through using 
searching options as “intitle”, compromising information can be retrieved. There is no need for 
even downloading documents hence organizations may not even notice someone is accessing 
sensitive data. 
Figure 43: Fbi.gov users gathered by Google 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 25 of 29 
Of course, this kind of data can be found in documents created or edited on Linux, and all Unix 
flavors, systems too: 
Figure 44: *NIX users 
All this information becomes available to anyone who has Internet access. And it may remain 
available even after documents were modified or removed from web site due to the cache 
feature most web search engines provide. 
Cached copies from documents may appear tagged with the words “Cache” or “HTML version”, 
and they are stored by the search engine systems themselves, thus giving little control to 
website owners and administrators on their contents and access rights. Of course, search 
engines companies provide tools which allow webmasters to remove contents from their 
indexes, but those tools may be useless for massive document management. Besides, 
monitoring accesses through search engine caches is, at least, a taught task for organizations 
and website administrators. 
6. FOCA 
Just as a proof of concept, FOCA is been developed. FOCA, which stands for “Fingerprinting 
Organization with Collected Archives” is an automated tool for downloading documents 
published in websites, extracting metadata and analyzing data. Now it´s an on growth project 
which is being improved day by day. 
FOCA searches for links to documents using Google and Microsoft Live Search engines. This 
tool is not using any special Google key to access the API, so if Google or Microsoft Live asks 
for a CAPTHA value then FOCA will stop and show up the CAPTCAH, waiting for it to continue. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 26 of 29 
Figure 45: 1394 office documents published in Blackhat web site 
A big website can store between three and five thousand Office documents so, in a normal 
search for links maybe between zero and five CAPTCHAs can be required (depending on the 
Google and Microsoft security policies in that moment). After collecting all the links, all 
documents can be downloaded using a multi thread engine to retrieve all of them as fastest as 
possible.  
Figure 46: FOCA downloading files 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 27 of 29 
Once retrieved, FOCA allows extracting metadata from all documents. Today FOCA supports 
DOC, XLS, PPT, PPS, DOCX, PPTX, PPSX, XLSX, SWX, ODT, ODS, ODP, PDF, and WPD 
documents. In the following image the metadata extracted from a public document is shown. In 
this case, the document is a (great) David Litchfiled work. 
Figure 47: Metadata stored in a Microsoft Doc published at Blackhat.com (in English) 
Once all documents are analyzed FOCA will collect three special lists. First one with discovered 
users, second one with paths to files and the last one with printers. Besides, using FOCA is 
easy to track where the metadata is stored in order to analyze deeply a real environment. 
Figure 48: Tracking Metadata in files 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 28 of 29 
FOCA will also search for new servers in the domain name server using Google Sets and 
Wikipedia categories based in the server names found and at the end, a view more or less 
complete depending in the amount of data obtained will be printed. 
There is an on-line version of FOCA which can be used by anyone in the following URL: 
http://www.informatica64.com/FOCA.  
Figure 49: FOCA, on-line version 
7 SECURE WEB PUBLISHING 
Removing metadata from documents is not an easy task. As far as users can not be relied on to 
ensure document security and the volume of published information increases faster and faster, 
organizations must find ways to make it automatically. 
Among the systems involved in document security, web servers play a fundamental role, as they 
are the logical boundary between Internet and the organization. MetaShield Protector is a 
solution for sanitizing documents on the fly as they are served to users by IIS web servers. It 
replaces document metadata so that they contribute to security and offer a normalized public 
image of the organization. 
CONCLUSIONS 
Any document can have associated metadata that contain lost information or hidden data. In 
particular, Microsoft Office and OpenOffice documents may contain data about the internal 
network, its user accounts and machines, shared resources, services provided, operating 
systems, and more. 
Organizations must take this information into account before publishing documents on the web 
or sending them by e-mail. Cleaning these documents is a must, as it is taking care of how web 
search engines index them. 
Keep an eye in the information you know you published and the one you maybe publish without 
knowing it. 
Disclosing Private Information from Metadata, hidden info and lost data 
Page 29 of 29 
REFERENCES 
EXIF [Exchangeable Image File Format] 
http://en.wikipedia.org/wiki/Exif  
IPTC [International Press Telecommunications Council] 
http://en.wikipedia.org/wiki/IPTC  
XMP [Extensible Metadata Platform] 
http://en.wikipedia.org/wiki/Extensible_Metadata_Platform  
WD97: Cómo minimizar metadatos en documento de Microsoft Word 
http://support.microsoft.com/kb/223790  
Cómo minimizar metadatos en documentos de Microsoft Word 2000 
http://support.microsoft.com/kb/237361  
How to minimize metadata in Word 2002 
http://support.microsoft.com/default.aspx?scid=kb;EN-US;290945  
Cómo minimizar metadatos en Word 2003 
http://support.microsoft.com/kb/825576/ 
How to minimize metadata in Microsoft Excel workbooks 
http://support.microsoft.com/default.aspx?scid=kb;EN-US;223789  
Ppt97: Cómo minimizar metadatos en presentaciones de Microsoft PowerPoint 
http://support.microsoft.com/kb/223793/  
PPT2000: How to Minimize Metadata in Microsoft PowerPoint Presentations 
http://support.microsoft.com/default.aspx?scid=kb;EN-US;314797   
How to minimize the amount of metadata in PowerPoint 2002 presentations 
http://support.microsoft.com/kb/314800/EN-US/  
Microsoft Word bytes Tony Blair in the butt 
http://www.computerbytesman.com/privacy/blair.htm 
Word list generation for bruteforce cracking 
http://www.reversing.org/node/view/9  
Utilidades 
ExifReader 
http://www.takenet.or.jp/~ryuuji/minisoft/exifread/english/  
Wlgen 
http://www.reversing.org/node/view/8  
OOMetaExtractor 
http://www.codeplex.com/oometaextractor  
DocScrubber  
http://www.javacoolsoftware.com/docscrubber/index.html  
Metadata Extraction Tool 
http://www.drewnoakes.com/code/exif/releases/ 
Libextractor 
http://gnunet.org/libextractor/  
Bintext 
http://www.foundstone.com/us/resources/proddesc/bintext.htm  
Metagoofil 
http://www.edge-security.com/metagoofil.php  
Foca Online 
http://www.informatica64.com/foca