1
OLONLWNW-记次绕waf
⼀、前⾔
⼆、第⼀次⻅这样的waf
三、⼲翻waf
做项⽬遇到，感觉有点意思记录⼀下。
打开这个站的时候就注意到了这个站⽤了之前我审过的⼀个框架具体是哪个就不说了。
本来想着直接打就⾏了结果有点意思。
java的框架存在两处权限绕过
第⼀处
第⼆处
我本着直接打完交洞的想法使⽤第⼆种权限绕过⽅式没想到看到了如下界⾯
⼀、前⾔
⼆、第⼀次⻅这样的waf
Plain Text
复制代码
Plain Text
复制代码
/xxx/../api/user
1
/api/user;1.js
1
2
我⼲了啥就拦我了，第⼀次⻅拦我分号。之前阿⾥云waf也不这么拦我啊
/api/user;?upload=file 拦截
试试..呢
/xxx/../api/user  拦截
三、⼲翻waf
3
/xxx/..;/api/use  拦截
各种编码、参数污染、垃圾数据包都被拦了
4
看来不能从这些⽅⾯下⼿，还是回到分号和..上
/xxx/api/user; 拦截
/xxx/api/user?;  不拦
5
但是这样不能使⽤;1.js绕，因为getRequestURI()是获取不到问号后⾯的那把问号编码呢
/xxx/api/user%3f;
但是这样就匹配不到我原来的路由也没⽤。然后我⼜测试了
/xxx/%3f/../../api/user  被拦
此时想到再⽤..;
因为之前测阿⾥云waf的时候发现../拦截..;/不拦截
那么这个waf可能是拦截../和;
分号可以⽤问号编码绕过然后我再插⼊分号不就绕过了
/xxx/%3f/..;/..;/api/user
接下来就可以正常上传了
然后上传jsp⼜遇到waf了，⽤⼀个双引号和java unicode特性绕了
6