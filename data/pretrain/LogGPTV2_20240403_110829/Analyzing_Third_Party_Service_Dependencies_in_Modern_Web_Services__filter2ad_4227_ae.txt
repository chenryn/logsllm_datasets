Third Party CDN to no CDN
Private to Third Party
Single Third Party to Private
Critical dependency
2 (9.5%)
0 (0.0%)
1 (4.76%)
0 (+0%)
Table 8: Trends in 𝐶𝐴 → 𝐶𝐷𝑁 dependency in 2016 vs. 2020. There
is no significant change in critical dependency of CAs.
moved from having no CDN in 2016 to having a third party CDN in
2020 including a major CA Let’s Encrypt as shown in Table 8. How-
ever, 2 CAs have also moved from having third-party CDNs to not
having CDNs in 2020. Hence, third party and critical dependency
has remained overall unchanged.
5.3 𝐶𝐷𝑁 −→ 𝐷𝑁 𝑆 Dependency
We observe 86 CDNs in total, out of which 31 (36%) use a third
party DNS provider and 15(17.4%) of them are critically dependent
as shown in Table 6. However, the critically dependent ones are
not significant CDN providers as they support only 1.5% of the
top-100K websites using CDNs.
We find that 290 additional websites are now dependent on a
third party as they use a private CDN, which in turn uses a third-
party DNS provider. These websites include twitter.com, airbnb.com,
and squarespace.com.
Observation 11: Major CDN providers use private DNS, hence
we see little to no change in the impact of DNS providers as a
result of 𝐶𝐷𝑁 → 𝐷𝑁 𝑆 dependency.
Figure 9a and 9b show the change in concentration and impact
of the top 5 DNS providers respectively when we also consider
𝐶𝐷𝑁 → 𝐷𝑁 𝑆 dependency. There is no significant change in the
concentration of major providers as they use a private DNS. Only
Fastly in the top 5 CDN providers, uses a third-party DNS provider
Dyn. We observed that AWS DNS serves 16 of the CDNs, 7 of which
use AWS exclusively. However, these 7 CDNs serve only 2% of the
top-100K websites using a CDN.
643
Analyzing Third Party Service Dependencies in Modern Web Services: Have We Learned from the Mirai-Dyn Incident?
IMC ’20, October 27–29, 2020, Virtual Event, USA
Service
DNS
CDN
CA
Third-Party Dependency Critical Dependency
102 (51%)
32 (16%)
200 (100%)
92 (46%)
32 (16%)
156 (78%)
Table 10: Trends in third-party dependency of top 200 US hospitals.
Hospitals are as critically dependent as websites.
Service
DNS
Cloud
3rd-Party Dep.
21 (91.3%)
15 (65.2%)
Redundancy Critical Dependency
1 (4.43%)
0 (0%)
8 (34.7%)
5 (21.7%)
Table 11: Trends in third party dependency of top smart home
companies. Critical dependency is also prevalent in smart home ser-
vices.
DNS dependency is less prevalent (51%) in hospitals as compared to
Alexa websites (89%). However, redundancy is equally rare, 90% hos-
pitals that use a third party DNS are not redundantly provisioned,
similar to the Alexa top-100K websites (95%). We observe that 16%
of the hospitals use CDNs and all of them use a third-party CDN.
CDN usage is less (16%) in hospitals as compared to Alexa websites
(33.2%). Critical dependency on CDNs is 100% similar to Alexa web-
sites (85%). Akamai is the most concentrated CDN provider which
covers 7% of the hospitals. We notice that all hospitals support
HTTPS and 22% of the hospitals support OCSP stapling. This is
slightly more than Alexa sites, where 17% support OCSP stapling.
To summarize, third-party dependency is less for hospital web-
sites relative to Alexa websites. However, trends in critical depen-
dency are similar.
6.2 Case Study II - Smart Home Companies
Outage of smart home services can have serious consequences
[54, 61], e.g., in 2017, an Amazon S3 outage caused many smart
home devices (locks, lights, etc.) to not function [25].
Hence, we analyze 23 smart home companies for third-party
dependencies, including smart home frameworks like Samsung
SmartThings, Yonomi, Amazon, etc., and smart home devices such
as Lifx, Philips Hue, etc. Of these 23 companies, 14 operate locally
and on the cloud while 9 smart home companies are cloud-only.
Table 11 shows the trends we observe in smart home companies
concerning third-party dependencies. Only 3 companies (Philips
Hue, Apple Homekit, and Amazon Alexa) use a private DNS and
only 1 company uses redundancy. Of the remaining 21, 13 have
local fail-over and hence 8 are critically dependent including Log-
itech Harmony, Yonomi, Brilliant Tech, IFTTT, Petnet, Ecobee, Ring
Security, etc. These trends of third party and critical dependency
on DNS providers are similar to Alexa websites.
In terms of cloud usage, all companies use the cloud, while 15 use
third-party cloud, and none of them are redundantly provisioned.
Of these 15, only 5 lack local fail-over, and hence they are critically
dependent on their cloud provider. These include Petnet, IFTTT,
Logitech Harmony, Ecobee, and Ring Security. Moreover, we ob-
serve that 11 of the 15 smart home companies that use a third party
cloud, use Amazon as their cloud provider, while 13 use Amazon
DNS. All in all, third party and critical dependency have similar
trends in smart home companies as in Alexa websites.
(a)
(b)
Figure 9: The Figure 9a and 9b show the top-5 3rd party DNS
providers in terms of concentration and impact respectively in the
top 100K websites when we consider 𝐶𝐷𝑁 → 𝐷𝑁 𝑆 and when we
just consider 𝑊 𝑒𝑏 → 𝐷𝑁 𝑆 dependency. Indirect dependencies am-
plify provider concentration and impact.
Pvt to Single Third Party
Single Third Party to Private
Redundancy to No Redundancy
No Redundancy to Redundancy
Critical dependency
0 (0.0%)
1 (2.1%)
1 (2.1%)
2 (4.25%)
-2 (-4.25%)
Table 9: Trends in 𝐶𝐷𝑁 → 𝐷𝑁 𝑆 dependency in 2016 vs. 2020. Crit-
ical dependency has decreased in 2020 relative to 2016.
2016 vs. 2020: We observe 47 distinct CDNs in the 2016 data. Of
these 47 CDNs, 12 (25.5%) used third party DNS providers in 2016.
8 (17%) were critically dependent on a single third-party DNS
provider in 2016. Of those 8 CDNs, 2 (Netlify, Kinx CDN) have
adopted redundancy in 2020, and 1 (GoCache) has moved to a pri-
vate DNS as shown in Table 9. However, 1 redundantly provisioned
CA (Zenedge) in 2016 has moved to a single third-party CDN in
2020. Hence, critical dependency has decreased by 4.25%.
6 Additional Case Studies
The previous section considers the Alexa top-100K websites. How-
ever, this tangled web of dependencies extends into other domains.
We present two example case studies of specific market verticals
that highlight the impact of third party dependencies outside of
popular websites.
6.1 Case Study I - Hospitals
Internet outages for hospitals can hamper hospital operations e.g.,
electronic health record (EHR) system hosted on a remote server,
electronic transfer of prescriptions, and emails, etc. In fact, on
March 22, 2020 a DDoS attack targeted a Paris hospital authority
AP-HP, which manages 39 public hospitals, during the coronavirus
pandemic [11]. Also, in the 2016 Dyn attack, AthenaHealth and
AllScripts also suffered outage [40] since they used Dyn.
We analyze third-party DNS, CDN and CA dependencies in the
top 200 US hospitals [46]. Table 10 shows the percentage of hospi-
tals that use third party DNS, CDN, and CA and that are critically
dependent. 51% of the hospitals use a third party DNS and only 6%
have redundancy. GoDaddy DNS is the most concentrated provider
which covers 13% of these hospitals. We observe that third party
644
IMC ’20, October 27–29, 2020, Virtual Event, USA
Aqsa Kashaf, Vyas Sekar, and Yuvraj Agarwal
7 Related Work
Content Dependency measurements: Prior work has analyzed
the third party content-level dependencies of websites. Kumar
et al., [35] study HTTPS adoption and Podins et al., [48] measure
the implementation of Content Security Policy, among third-party
web content. Other efforts (e.g., [43, 47]) analyze malicious third
party content such as JavaScript or fonts. Ruohonen et al., looks at
the prevalence of cross-domain TCP connections [52]. Ikram et al.,
look at dependency chains in loading third party web content [29],
while Urban et al., study how content dependencies change with
repeated visits [62]. Our focus is on infrastructural dependencies
and not on third party content.
Dependency and Concentration Analysis: Simeonovski et al., [55]
analyze global scale threats where bad actors can be a country, an
autonomous system or a service provider such as DNS or an Email
server. Closer in spirit to our work, Allman analyzed DNS robust-
ness of websites and makes a case for adding redundancy [3]. Other
work looked at the behavior of Dyn and NS1 clients to make a
case for DNS redundnacy [1]. NSDMiner discovers network service
dependencies such as ISPs, from passively observed network traf-
fic [45]. Other work looks at the dependency of websites on hosting
providers [60] and the dependency of government websites on CAs
and content providers [27]. Hoang et al., study web co-location
using DNS measurements [26]. Similarly, Dell et al., analyze third
party infrastructural dependencies of websites from a large scale
DNS dataset [15]. Most of these efforts focus on concentration and
overlook indirect dependencies in their analysis.
Other complementary efforts study internal backend infrastruc-
ture dependencies for debugging (e.g., [37]).
Understanding CDN and hosting: Several studies have focused
on understanding CDNs and hosting infrastructure [2, 12, 34, 42, 56].
Other work maps the growing infrastructure and edge deployment
by popular content providers (e.g., [8]). Recent work points out an
increasing adoption of DDoS protection services by Websites [30].
Cangialosi et al.,[9] analyzes prevalence of private key sharing by
websites with hosting providers. These are complementary to our
work as we do not consider the hosting infrastructure and capacity
bottlenecks of service providers.
Internet measurement: Zmap [19] and Censys [18] present mech-
anisms to scan the Internet to understand vulnerable services. Our
focus on web infrastructure is complementary to this work. Other
work has analyzed the use of TLS, the certificate ecosystem, and the
use of Certificate Revocation in the wild (e.g., [13, 14, 32, 39, 63, 67]).
These suggest potential attacks that could be executed via the third
party services we analyze here.
Website complexity and performance: Butkiewicz et al., study
the impact of the complexity of the website as measured in terms of
the number of third-party objects on the website load time (e.g., [7]).
Other work analyzes the critical paths to understand if and how
specific content affects the page load time (e.g., [64]). However,
our focus is on the infrastructure services at a higher level than
individual websites. Other work focuses on the privacy implications
of the tracking services that appear on the website (e.g., [33, 36, 51]).
This is orthogonal to our work.
8 Discussion
We conclude with implications of our findings and some recom-
mendations for different stakeholders.
8.1 Trends of concern
Critical Inter-service Dependencies: Critical dependencies be-
tween service providers (Section 6) further increase the websites’
exposure to risk resulting from their critical dependencies. As a
result of indirect dependencies, the number of critical dependen-
cies per website increases, e.g., 25% of top-100K websites have 3
critical dependencies per website as compared to 9.6% when we
just consider direct dependencies. Moreover, indirect dependencies
amplify a provider’s impact; e.g., CloudFlare impacts 44% of the
top-100K websites vs. 24% when we only consider direct dependen-
cies, DNSMadeEasy and Incapsula impact 25% of the websites from
1-2%.
Lessons Learned?: Between 2016 to 2020, we observe 1% to 5%
increase in critical dependency in websites (Section 4). While the
providers directly impacted by Dyn have adapted somewhat, it
seems that lessons from the Dyn attack have been only acted upon
by a handful who were directly impacted.
Increasing Concentration: As others also note, concentration is
increasing (Figure 6). These potential single points of failure can
become attractive targets for malicious actors.
Prevalence across sectors: Our preliminary case studies of two
other sectors (Section 6) suggest that third-party dependencies
proliferate across sectors leaving them vulnerable to Dyn-like inci-
dents [24].
8.2 Recommendations
Websites: An obvious recommendation for websites is that they
need to build in more resilience and redundancy when using third-
party services. While many of these third-party providers have
multiple points of presence, which introduces some redundancy
within their infrastructure, they are not immune to failures e.g.,
the incidents mentioned in Section 2. We also acknowledge that
third party providers have certain benefits such as better quality
of service, higher capacity etc. which small websites cannot afford
on their own. Moreover, websites need to understand the hidden
dependencies of the third-party services they use as they maybe
indirectly exposed to potential threats. For example, if a website
uses multiple CDN providers but those CDNs use the same DNS
provider. Similarly, if indirect dependencies of a website are also
redundantly provisioned, it makes the website less prone to outages.
The types of analysis we have performed can be made available as
a neutral service that websites can query before making business
decisions.
Service Providers: Service providers should support and encour-
age redundancy; e.g., Dyn offers “secondary” DNS configurations