# G0050: APT32

## Description
[APT32](https://attack.mitre.org/groups/G0050) is a threat group that has been active since at least 2014. The group primarily targets private sector industries, foreign governments, dissidents, and journalists, with a particular focus on Southeast Asian countries such as Vietnam, the Philippines, Laos, and Cambodia. APT32 frequently employs strategic web compromises to infiltrate their victims. It is believed that the group is based in Vietnam. (Citations: [FireEye APT32 May 2017](https://attack.mitre.org/groups/G0050), [Volexity OceanLotus Nov 2017](https://attack.mitre.org/groups/G0050), [ESET OceanLotus](https://attack.mitre.org/groups/G0050))

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Hidden Window](https://attack.mitre.org/techniques/T1143/) | APT32 uses the `WindowStyle` parameter to conceal PowerShell windows. | Windows event logs, PowerShell logs, process command-line parameters, process monitoring, file monitoring |
| Linux, macOS, Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | APT32 utilizes `cmd.exe` for execution. | Process monitoring, process command-line parameters |
| Windows, macOS | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Software Packing](https://attack.mitre.org/techniques/T1045/) | APT32 uses UPX to pack their macOS backdoor. | Binary file metadata |
| Linux, Windows, macOS | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222/) | APT32's macOS backdoor changes the permission of the file it wants to execute to 755. | File monitoring, process monitoring, process command-line parameters, Windows event logs |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [File Deletion](https://attack.mitre.org/techniques/T1107/) | APT32's macOS backdoor can receive a "delete" command. | File monitoring, process command-line parameters, binary file metadata |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Persistence](https://attack.mitre.org/tactics/persistence/) | [Hidden Files and Directories](https://attack.mitre.org/techniques/T1158/) | APT32's macOS backdoor hides the clientID file using the `chflags` function. | File monitoring, process monitoring, process command-line parameters |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [Service Execution](https://attack.mitre.org/techniques/T1035/) | APT32's backdoor uses Windows services to execute its malicious payload. | Windows Registry, process monitoring, process command-line parameters |
| Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Modify Registry](https://attack.mitre.org/techniques/T1112/) | APT32's backdoor modifies the Windows Registry to store the backdoor's configuration. | Windows Registry, file monitoring, process monitoring, process command-line parameters, Windows event logs |
| Linux, Windows, macOS | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Data Compressed](https://attack.mitre.org/techniques/T1002/) | APT32's backdoor uses LZMA compression before exfiltrating data. | Binary file metadata, file monitoring, process command-line parameters, process monitoring |
| Windows | [Discovery](https://attack.mitre.org/tactics/discovery/) | [Query Registry](https://attack.mitre.org/techniques/T1012/) | APT32's backdoor queries the Windows Registry to gather system information. | Windows Registry, process monitoring, process command-line parameters |
| Linux, macOS, Windows | [Discovery](https://attack.mitre.org/tactics/discovery/) | [File and Directory Discovery](https://attack.mitre.org/techniques/T1083/) | APT32's backdoor lists files and directories on a machine. | File monitoring, process monitoring, process command-line parameters |
| Linux, macOS, Windows | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Data Encrypted](https://attack.mitre.org/techniques/T1022/) | APT32's backdoors encrypt data before exfiltration, including using RC4 encryption. | File monitoring, process monitoring, process command-line parameters, binary file metadata |
| Linux, macOS, Windows | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Exfiltration Over Command and Control Channel](https://attack.mitre.org/techniques/T1041/) | APT32's backdoor exfiltrates data using the already opened channel with its C&C server. | User interface, process monitoring |
| Linux, Windows, macOS | [Execution](https://attack.mitre.org/tactics/execution/) | [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203/) | APT32 uses RTF documents that include an exploit to execute malicious code (e.g., CVE-2017-11882). | Anti-virus, system calls, process monitoring |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Uncommonly Used Port](https://attack.mitre.org/techniques/T1065/) | APT32's backdoor can use HTTP over an uncommon TCP port (e.g., 14146) specified in the backdoor configuration. | Netflow/Enclave netflow, process use of network, process monitoring |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Commonly Used Port](https://attack.mitre.org/techniques/T1043/) | APT32 uses port 80 for C2 communications. | Packet capture, Netflow/Enclave netflow, process use of network, process monitoring |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Scripting](https://attack.mitre.org/techniques/T1064/) | APT32 uses macros, PowerShell scripts, COM scriptlets, and VBS scripts. | Process monitoring, file monitoring, process command-line parameters |
| Windows, Office 365 | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Office Application Startup](https://attack.mitre.org/techniques/T1137/) | APT32 installs a backdoor macro in Microsoft Outlook for persistence. | Process monitoring, process command-line parameters, Windows Registry, file monitoring |
| Windows, Linux, macOS | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | APT32 uses Mimikatz, GetPassword_x64, and customized versions of Windows Credential Dumper, HookChangePassword, and Outlook Credential Dumper to harvest credentials. | API monitoring, process monitoring, PowerShell logs, process command-line parameters |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060/) | APT32 establishes persistence using Registry Run keys to execute PowerShell and VBS scripts, as well as to run their backdoor directly. | Windows Registry, file monitoring |
| Windows, macOS, Linux, Office 365, SaaS | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | APT32 sends spearphishing emails containing malicious links. | Packet capture, web proxy, email gateway, detonation chamber, SSL/TLS inspection, DNS records, mail server |
| Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Mshta](https://attack.mitre.org/techniques/T1170/) | APT32 uses `mshta.exe` for code execution. | Process monitoring, process command-line parameters |