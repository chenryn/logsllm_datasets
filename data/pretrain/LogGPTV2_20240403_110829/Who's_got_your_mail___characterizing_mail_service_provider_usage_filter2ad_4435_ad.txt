certificates. Table 4 shows how we filter data collected for a day’s
snapshot.
4.4 Providers and Companies
On the data thus gathered, we then use the priority-based ap-
proach (Section 3) to determine the mail providers for the domains.
Our methodology outputs provider IDs (in the form of registered
domains) as mail providers. For example, our methodology tags
google.com as the provider ID for netflix.com (as seen in Table 1).
The provider ID google.com can then be associated with the mail
service provider company, which is Google in this case. However, a
single company may have multiple provider IDs, which can either
be the result of different services operated by the company or dif-
ferent sources of data (certificates, Banner/EHLO messages, or MX)
used to derive the provider ID. Table 5 shows various provider IDs
used by Microsoft and ProofPoint identified in our datasets as well
as the ASN information of the mail infrastructure.
For our analyses, we ultimately want to aggregate the registered
domains that make up provider IDs into the companies that operate
these names. This step requires a certain amount of manual work,
which makes a blanket analysis of providers infeasible. Instead,
Company Provider ID
outlook.com
office365.us
hotmail.com
outlook.cn
outlook.de
Microsoft
ASN
8075 (Microsoft)
200517 (MS Deutschland)
58593 (Blue Cloud)
ProofPoint
gpphosted.com
ppops.net
pphosted.com
ppe-hosted.com
52129 (ProofPoint)
26211 (ProofPoint)
22843 (ProofPoint)
13916 (ProofPoint)
15830 (Telecity Group)
Table 5: Provider IDs operated by Microsoft and ProofPoint
identified in our datasets.
we focus on the most prominent mail providers. We investigate
frequently-occurring names to identify prominent provider IDs. We
then map these provider IDs to companies by examining relevant
information (e.g., ASN and the provider ID itself) and searching on
the Internet.7 We use the resulting company information as input
for our analyses in Section 5.
5 ANALYSIS
In this section we characterize various aspects of mail providers
identified for our target set of popular and random domains (Sec-
tion 4). We characterize the market share, infrastructure and ser-
vices provided by the dominant companies in e-mail delivery, their
trends over time with particular focus on e-mail security services
and web hosting companies, the dynamics of domains switching
companies over the span of our data set, and mail provider prefer-
ences across different countries.
5.1 Market Share of Top Companies
We start by examining the most popular companies that MX records
refer to. We use the priority-based approach from Section 3 to
identify the provider IDs most prevalent. We then associate these
provider IDs with companies (Section 4.4).
Figure 5 shows the top five companies for the three sets of do-
mains in the most recent snapshot in our dataset (June 2021).8 Since
prior work [30, 31] has demonstrated that the nature of domains
in Alexa vary with ranks, we also present the five top companies
for domains in the Alexa Top 1k, 10k and 100k. Finally, for .gov
domains we also identify the top five companies separately for
federal and non-federal domains.
For Alexa domains of different ranks, the top two are consistently
mail hosting providers (Google and Microsoft). For the top 1k, 10k
and 100k domains, the third most popular company is ProofPoint,
an e-mail security company. However, when considering all Alexa
domains, the third company is Yandex, a Russian mail hosting
7Note that our list of provider IDs associated with a company is never meant to be
exhaustive. Identifying domain names owned by the same company is a research
question by itself [40].
8The appendix contains a longer table that lists the number and percentage of the top
15 companies in each set of domains. Provider IDs associated with each company can
be found in our GitHub repository: https://github.com/ucsdsysnet/mx_inference
130
IMC ’21, November 2–4, 2021, Virtual Event, USA
Liu, Akiwate, Jonker, Mirian, Savage, and Voelker
rank highly among the random domain set, Section 5.2.2 shows
that such services are increasing in popularity over time.
5.2 Longitudinal Trends
5.2.1 Top Companies. While Figure 5 shows the most recent break-
down for the top companies, we now use the full data set to examine
the breakdown for top companies longitudinally over time.
For each of the companies from the Alexa data set in Figure 5,
Figure 6 shows the percentage and number of domains whose MX
records point to those companies over the four years of our data
set. Each curve corresponds to one of the companies. While not
dramatic, the trends are all steady increases over time. The top
five companies combined are used by 40.1% of MX records in 2017,
and the total increases to 49.0% by June 2021. Google dominates
the market with Gmail, with Microsoft and Outlook a notable sec-
ond, and both continue to steadily increase market share. Google
increases from 26.2% to 28.5% from 2017–2021, and Microsoft like-
wise increases from 7.9% to 10.8%.
Notably, ProofPoint and Mimecast are both in the top five and
increase their market share over the past four years. These compa-
nies are not mail providers, but instead provide an e-mail security
service. We explore the rise of such e-mail security services in more
detail in Section 5.2.2.
The Self-Hosting curve shows the percentage of domains that
host their own SMTP server, rather than using a separate provider.
We estimate the number of domains that are self-hosted by looking
for domains whose provider ID is the same as its registered domain
name. The trend for self-hosting is the opposite that of the top com-
panies. The percentage of domains that self-host steadily decreased
over the four years of our data set, falling from 11.7% in 2017 to
7.9% in 2021. Section 5.3 below explores where they switch to in
more detail.
Figures 6d and 6g similarly shows the trends over time for the
top companies serving the random .com and .gov data sets in Fig-
ure 5. We note that Censys is only intermittently successful in
scanning EIG for unknown reasons. Thus, for the longitudinal re-
sults we show OVH instead, which is the six largest company in
.com domains and scanned reliably over time. As with the Alexa
data set, the market share of the dominant mail providers (Google
and Microsoft) increases over time for .com and .gov domains.10
The consolidation of Google and Microsoft applies not only to pop-
ular domains, but domains across the full distribution. In contrast,
though, the market share of hosting providers is steadily decreasing
(GoDaddy and UnitedInternet) or flat (OVH) over time. Either there
are fewer customers of hosting providers overall, or more of their
customers switch away from using the default mail service of the
hosting provider.
While the random .com data set has over five times the number
of Alexa domains (580,537 vs. 93,538), the number of self-hosted do-
mains in .com is significantly smaller than that of the Alexa domains
(1,836 vs. 7,407 in June 2021) and this number slightly decreased
over the last four years. This result matches our expectation that
most .com domains are small sites hosted with other companies.
10Not for Google in .gov dataset from 2019-12 to 2021-06. A quick sanity check suggests
that the majority of the domains moving away from Google were moving to Microsoft.
131
Figure 5: Top providers and the number and percentage of
domains using these companies in different sets of domain
names (Jun. 2021).
provider. We suspect this likely reflects the presence of many .ru
domains in the long tail of Alexa domains.
We observe similar phenomena in .gov domains: Microsoft and
Google are the most prominent companies (although their market
shares are reversed), followed by several e-mail security companies
(Barracuda, ProofPoint and Mimecast). That said, we observe a non-
negligible amount of domains pointing at mail servers operated by
the US Department of Health (hhs.gov) and the US Department of
Treasury (treasury.gov) among federal domains. Manually check-
ing a random sample suggests that most of these domains are either
directly operated by or closely related to the two departments.
Finally, for .com domains, we note a slightly different company
distribution. While Google and Microsoft still have a significant
presence, the other companies are web hosting providers (GoDaddy,
UnitedInternet, and EIG). Indeed, GoDaddy by far has the dominant
market share among the random .com domains.9 In contrast to the
Alexa and .gov sets, the random domains reflect the full distribution
of sites using MX records. This distribution has a long tail with
many small sites, and it is not surprising that many of them operate
using the infrastructure of their hosting provider. Finally, while
e-mail security services such as ProofPoint and Mimecast do not
9Given GoDaddy’s dominance, we performed sanity checks to ensure that the domains
using GoDaddy are not simply parked domains. Indeed, when we registered a domain
or published a website using the registered domain with GoDaddy, GoDaddy did not
automatically set up the MX record for the domain. Instead, GoDaddy only configured
an MX record for the domain when an e-mail address was created and associated with
the domain.
Who’s Got Your Mail? Characterizing Mail Service Provider Usage
IMC ’21, November 2–4, 2021, Virtual Event, USA
Figure 6: Market share of different types of services from 2017 to 2021. Note that the y-axes of all graphs show the same
quantities, but the value ranges are distinct to each graph.
5.2.2 E-mail Security Services. Figure 6a highlighted ProofPoint
and Mimecast in the top five companies used by popular domains.
These companies provide e-mail security services that can operate
as a third-party filter for inbound e-mail delivery, removing the
need to purchase and manage a local appliance. Customers use
MX records to direct mail agents to deliver mail intended for the
customer to the security provider instead, either by explicitly using
a provider domain in the MX record (e.g., ge.com, which has MX
mx0a-00176a02.pphosted.com) or by using a customer domain whose
A record uses a provider IP address (e.g., albabotanica.com, which
has MX record mx1.haingrp.com that resolves to a ProofPoint IP).
The provider then performs spam filtering, phishing detection,
URL rewriting, etc., on behalf of the customer, and subsequently
forwards the customer’s mail to the customer’s servers.
The rise of ProofPoint and Mimecast suggests that such compa-
nies are becoming a more attractive service option. To explore this
point further, in addition to ProofPoint and Mimecast, we manually
identified three other popular companies in the third-party e-mail
security market across our data sets. Figures 6b, 6e, and 6h show
the percentage of MX records that refer to each of five prominent
third-party e-mail security companies over time for the Alexa, .com,
and .gov domains, respectively. The results confirm that these ser-
vices are becoming increasingly attractive for both popular and
random domains, as security incidents via e-mail continue to be a
major concern.
5.2.3 Web Hosting Companies. Web hosting companies like Go-
Daddy make it convenient for hosted domains to use company
infrastructure for a variety of services including e-mail delivery. As
132
0.0%10.0%20.0%30.0%40.0%50.0%010000200003000040000(a) Top Companies in AlexaGoogleMicrosoftYandexProofPointMimecastTop5 TotalSelf-Hosted0.0%1.0%2.0%3.0%4.0%5.0%6.0%7.0%0100020003000400050006000(b) Popular E-mail Security Companies in AlexaProofPointMimecastBarracudaCisco IronportAppRiverTotal0.0%0.5%1.0%1.5%2.0%2.5%3.0%3.5%050010001500200025003000(c) Popular Web Hosting Companies in AlexaGoDaddyOVHUnitedInternetUkraine.uaNameCheapTotal0.0%10.0%20.0%30.0%40.0%50.0%050000100000150000200000250000300000(d) Top Companies in COMGoDaddyGoogleMicrosoftUnitedInternetOVHTop5 TotalSelf-Hosted0.0%0.2%0.4%0.6%0.8%010002000300040005000(e) Popular E-mail Security Companies in COMProofPointMimecastBarracudaCisco IronportAppRiverTotal0.0%5.0%10.0%15.0%20.0%25.0%30.0%35.0%40.0%050000100000150000200000(f) Popular Web Hosting Companies in COMGoDaddyOVHUnitedInternetUkraine.uaNameCheapTotal0.0%10.0%20.0%30.0%40.0%50.0%2017-062017-122018-062018-122019-062019-122020-062020-122021-06025050075010001250150017502000(g) Top Companies in GOVMicrosoftGoogleBarracudaProofPointMimecastTop5 TotalSelf-Hosted0.0%2.5%5.0%7.5%10.0%12.5%15.0%17.5%2017-062017-122018-062018-122019-062019-122020-062020-122021-060100200300400500600(h) Popular E-mail Security Companies in GOVProofPointMimecastBarracudaCisco IronportAppRiverTotal0.0%0.2%0.5%0.8%1.0%1.2%1.5%1.8%2017-062017-122018-062018-122019-062019-122020-062020-122021-060102030405060(i) Popular Web Hosting Companies in GOVGoDaddyOVHUnitedInternetUkraine.uaNameCheapTotalNumber of domains using the providersPercentage of domains using the providersIMC ’21, November 2–4, 2021, Virtual Event, USA
Liu, Akiwate, Jonker, Mirian, Savage, and Voelker
2017 and 2021. While self-hosted domains switched to providers
across all categories, more than a quarter of them changed their
mail provider to Google or Microsoft — a quantity larger than the
sum of domains that switched to providers ranked in the remaining
top 100.
Figure 7: Sankey graph that demonstrates churn in Mail
Providers for Alexa domains from 2017 to 2021
we saw in Figure 6d, though, fewer domains over time are taking ad-
vantage of hosting company e-mail delivery. We expand upon these
results by manually identifying the top five Web hosting companies
in both data sets.
Figures 6c, 6f and 6i show the number and percentage of MX
records referring to each of these companies in the Alexa, .com, and
.gov data sets, respectively. In both cases the trends are the same.
The most popular hosting companies (GoDaddy and UnitedInternet)
have fewer domains using their e-mail delivery services over time,
and the trend is particularly pronounced among the large sites
using popular domains in the Alexa data set. The remaining hosting
companies are comparatively flat.
5.3 Churn
Recall that the set of domains we study have valid MX records for
the entire duration of our data set. During this time there is churn
in the values of the MX records that reflect administrative decisions
about mail delivery. Some domains that initially used Google, for
instance, may switch to Microsoft during the four years. Similarly,
other domains that were self-hosting might switch to Google.
Figure 7 is a Sankey diagram illustrating changes in MX records
between the first snapshot in the Alexa data set (June 2017) and
the last (June 2021). The diagram groups the domains into various
categories: the top three third-party mail hosting providers (Google,
Microsoft, Yandex); the remaining top 100 providers; self-hosted
domains; all other providers; and the residual set that either had
no responding SMTP server or timed out during a Censys scan. For
each category, the diagram shows the number of domains using that
company that did not change, the number of domains that used the
company in 2017 but switched to another by 2021 (outgoing flows),
and the number of domains that switched to use the company by
2021 (incoming flows).
While the use of the top companies increased over time, the
diagram shows that domains from all of the various categories con-
tributed to this increase (e.g., the incoming flows to Google). From
the perspective of domains that switched providers, we in particular
highlight the changes that occurred to self-hosted domains between
5.4 Mail Provider Preferences by Country
Finally, we explore the existence of national biases in e-mail service
provider choice. Since we have no easy mechanical way to classify
the national origin of individual gTLD domains (such as those in
.com) we focused on country code top-level domains (ccTLDs) found
in our stable subset of the Alexa top 1M list as a proxy. We consider
fifteen ccTLDs, namely: .br (Brazil), .ar (Argentina), .uk (the United
Kingdom), .fr (France), .de (Germany), .it (Italy), .es (Spain), .ro
(Romania), .ca (Canada), .au (Australia), .ru (Russia), .cn (China),
.jp (Japan), .in (India) and .sg (Singapore); thus we assume, for
example, that domains under .ru are likely Russian in origin.11
Among the domains in these ccTLDs, we focus on the use of four
popular e-mail service providers: Google, Microsoft, Tencent and
Yandex, representing the two dominant e-mail service providers in
the US and each of the dominant e-mail service providers in China
and Russia, respectively. For each of these four providers, Figure 8
shows the percentage (and absolute number) of domains in each of
our ccTLD sets that that make use of the service (June 2021).
There are two clear takeaways. First, Google and Microsoft, the
two dominant US-based e-mail service providers, appear to be in
wide use by organizations outside the US — particularly across
Europe, North America, South America, large parts of Asia and,
to a lesser extent, Russia (but not China). For example, 65% of the
.br domains in our set host mail with Google or Microsoft (sig-
nificantly exceeding even the baseline market share for our stable
Alexa domains of 39.3%). This is of note because under US law
(particularly as clarified by the recent Cloud Act’s modification to
the Stored Communications Act [1]) providers operating in the US
can be legally compelled to provide information under their control
(including e-mail content) to US law enforcement regardless of the
location of the data, or the nationality or residency of the customer
using the data. The second clear result is that Yandex and Tencent
are comparatively isolated — primarily serving domains only from
the ccTLD matching their own country of origin. Indeed, the hand-
ful of deviations from these patterns primarily reflect domains for
companies whose national origin is not reflected by their choice of
ccTLD.12
It is an open question the extent to which this discrepancy is
driven entirely by market power and infrastructure deployment
(i.e., that domain holders do not consider the jurisdictional risk of
hosting mail service with a foreign-owned company and are simply
picking those who are best able to support their feature, perfor-
mance, availability and price requirements) or if it also reflects an
explicit trust decision (i.e., that European and Brazilian companies
are sufficiently comfortable being subject to US jurisdiction that
11While there are individual instances that may deviate from this assumption (e.g.,
google.ru), we believe it is predominately true in aggregate (i.e., across the 10,000
plus .ru domains we consider, the majority are Russian-operated).
12For example, Shein is a Chinese-owned apparel company that operates in the UK