[9] P. Hoffman and P. McManus. DNS Queries over HTTPS
(DoH). RFC 8484, RFC Editor, October 2018.
[10] A. Mayrhofer. The edns(0) padding option. RFC 7830,
RFC Editor, May 2016.
[11] Google Public DNS over HTTPS (DoH) supports RFC
8484 standard. https://security.googleblog.com/2019/06/
google-public-dns-over-https-doh.html. Accessed: 2019-
04-03.
[12] Cloudﬂare DNS over HTTPS.
https://developers.
cloudﬂare.com/1.1.1.1/dns-over-https/. Accessed: 2018-
05-07.
[13] Selena Deckelmann.
dns over https (doh) – testing
on beta. https://blog.mozilla.org/futurereleases/2018/09/
13/dns-over-https-doh-testing-on-beta, 2018.
accessed:
2018-12-30.
[14] Mozilla Support.
Firefox DNS-over-HTTPS: About
https:
the US rollout of DNS over HTTPS.
//support.mozilla.org/en-US/kb/ﬁrefox-dns-over-https#
w about-the-us-rollout-of-dns-over-https.
2020-01-07.
Accessed:
DOH! DNS
over HTTPS
explained.
https://labs.ripe.net/Members/gih/
doh-dns-over-https-explained, 2018. Accessed: 2018-
12-27.
[15] Geoff Huston.
[16] Andriy Panchenko, Fabian Lanze, Andreas Zinnen, Mar-
tin Henze, Jan Pennekamp, Klaus Wehrle, and Thomas
Engel. Website ﬁngerprinting at internet scale. In Net-
work & Distributed System Security Symposium (NDSS),
pages 1–15. IEEE Computer Society, 2016.
[17] Tao Wang and Ian Goldberg. On realistically attacking tor
with website ﬁngerprinting. In Privacy Enhancing Tech-
nologies Symposium (PETS), pages 21–36. De Gruyter
Open, 2016.
[18] Jamie Hayes and George Danezis.
k-ﬁngerprinting:
A robust scalable website ﬁngerprinting technique.
In
USENIX Security Symposium, pages 1–17. USENIX As-
sociation, 2016.
15
[19] Payap Sirinam, Mohsen Imani, Marc Juarez, and
Matthew Wright. Deep ﬁngerprinting: Undermining web-
site ﬁngerprinting defenses with deep learning. In ACM
Conference on Computer and Communications Security
(CCS), pages 1928–1943. ACM, 2018.
[20] Andrew M. White, Austin R. Matthews, Kevin Z. Snow,
Phonotactic reconstruction of
and Fabian Monrose.
encrypted voip conversations: Hookt on fon-iks. In IEEE
Symposium on Security and Privacy (S&P 2011), 2011.
[21] Se Eun Oh, Shuai Li, and Nicholas Hopper. Fingerprint-
ing keywords in search queries over tor. PoPETs, 2017.
Initial Performance Mea-
surements (Q1 2018). https://dnsprivacy.org/wiki/pages/
viewpage.action?pageId=14025132, 2018.
Accessed:
2018-12-27.
[22] The DNS Privacy Project.
[23] The DNS Privacy Project.
Initial Performance Mea-
surements (Q4 2018). https://dnsprivacy.org/wiki/pages/
viewpage.action?pageId=17629326, 2018.
Accessed:
2018-12-27.
[24] Austin Hounsel, Kevin Borgolte, Paul Schmitt, Jordan
Holland, and Nick Feamster. Analyzing the costs (and
beneﬁts) of DNS, DoT, and DoH for the modern web.
CoRR, abs/1907.08089, 2019.
[25] Timm Bottger, Felix Cuadrado, Gianni Antichi,
Eder Leao Fernandes, Gareth Tyson, Ignacio Castro,
and Steve Uhlig. An empirical study of the cost of
DNS-over-HTTPs. 2019.
I know why you went
[26] Brad Miller, Ling Huang, Anthony D Joseph, and J Doug
to the clinic: Risks
Tygar.
In Privacy
and realization of HTTPS trafﬁc analysis.
Enhancing Technologies Symposium (PETS), pages 143–
163. Springer, 2014.
[27] Xiapu Luo, Peng Zhou, Edmond W. W. Chan, Wenke
Lee, Rocky K. C. Chang, and Roberto Perdisci.
HTTPOS: Sealing information leaks with browser-side
obfuscation of encrypted ﬂows. In Network & Distributed
System Security Symposium (NDSS). IEEE Computer
Society, 2011.
[28] Milad Nasr, Amir Houmansadr, and Arya Mazumdar.
Compressive trafﬁc analysis: A new paradigm for scal-
able trafﬁc analysis.
In ACM SIGSAC Conference on
Computer and Communications Security, CCS, 2017.
[29] DNS over Tor. https://developers.cloudﬂare.com/1.1.1.1/
fun-stuff/dns-over-tor/. Accessed: 2018-12-09.
[30] Tao Wang and Ian Goldberg. Improved Website Finger-
printing on Tor.
In ACM Workshop on Privacy in the
Electronic Society (WPES), pages 201–212. ACM, 2013.
[31] iodine. https://code.kryo.se/iodine/. Accessed: 2019-05-
[32] Spamhaus. https://www.spamhaus.org/zen/. Accessed:
13.
2019-05-13.
[33] Anonymous. Towards a comprehensive picture of the
In USENIX Security
great ﬁrewall’s dns censorship.
Symposium. USENIX Association, 2014.
[34] Paul Pearce, Ben Jones, Frank Li, Roya Ensaﬁ, Nick
Feamster, Nick Weaver, and Vern Paxson. Global mea-
surement of dns manipulation.
In USENIX Security
Symposium. USENIX, page 22, 2017.
[35] Saikat Guha and Paul Francis.
Identity trail: Covert
surveillance using DNS. In Privacy Enhancing Technolo-
gies Symposium (PETS), 2007.
[36] DNSSEC: DNS Security Extensions. https://www.dnssec.
net/. Accessed: 2018-12-09.
[37] DNSCrypt. https://dnscrypt.info/. Accessed: 2018-12-09.
DOH! DNS
over HTTPS
[38] G. Huston.
https://blog.apnic.net/2018/10/12/
Accessed: 2018-12-
explained.
doh-dns-over-https-explained/.
26.
[39] Kenji Baheux.
Experimenting with
provider DNS-over-HTTPS
//blog.mozilla.org/futurereleases/2018/09/13/
dns-over-https-doh-testing-on-beta, 2019.
2019-09-13.
upgrade.
same-
https:
accessed:
[40] T. Reddy, D. Wing, and P. Patil. Dns over datagram
transport layer security (dtls). RFC 8094, RFC Editor,
February 2017.
[41] Speciﬁcation of DNS over Dedicated QUIC Connections.
https://www.ietf.org/id/draft-huitema-quic-dnsoquic-05.
txt. Accessed: 2018-12-09.
[42] Haya Shulman.
Pretty bad privacy: Pitfalls of DNS
In Proceedings of the 13th Workshop on
encryption.
Privacy in the Electronic Society. ACM, 2014.
[43] Dominik Herrmann, Christian Banse, and Hannes Feder-
rath. Behavior-based tracking: Exploiting characteristic
patterns in DNS trafﬁc. Computers & Security, 2013.
[44] Basileal Imana, Aleksandra Korolova, and John S. Hei-
Enumerating Privacy Leaks in DNS Data
demann.
Collected above the Recursive. 2017.
[45] DNS-OARC: Domain Name System Operations Analysis
and Research Center. https://www.dns-oarc.net/tools/dsc.
Accessed: 2018-11-26.
[46] DNS-STATS: ICANN’s IMRS DNS Statistics. https://
www.dns.icann.org/imrs/stats. Accessed: 2018-12-06.
[47] Use DNS data to identify malware patient zero.
https://docs.splunk.com/Documentation/ES/5.2.0/
Usecases/PatientZero. Accessed: 2018-12-06.
[48] DNS Analytics. https://constellix.com/dns/dns-analytics/.
Accessed: 2018-12-06.
[49] Anonymous. The collateral damage of internet censorship
by dns injection. SIGCOMM Comput. Commun. Rev.,
42(3):21–27, 2012.
[50] Alerts about BGP hijacks, leaks, and outages. https://
bgpstream.com/. Accessed: 2019-05-13.
[51] Xiang Cai, Xin Cheng Zhang, Brijesh Joshi, and Rob
Johnson. Touching from a distance: Website ﬁnger-
printing attacks and defenses.
In ACM Conference on
Computer and Communications Security (CCS), pages
605–616. ACM, 2012.
[52] Tao Wang, Xiang Cai, Rishab Nithyanand, Rob John-
son, and Ian Goldberg. Effective attacks and provable
defenses for website ﬁngerprinting. In USENIX Security
Symposium, pages 143–157. USENIX Association, 2014.
[53] Vera Rimmer, Davy Preuveneers, Marc Juarez, Tom
Van Goethem, and Wouter Joosen. Automated website
ﬁngerprinting through deep learning.
In Network &
Distributed System Security Symposium (NDSS). Internet
Society, 2018.
[54] Allison McDonald, Matthew Bernhard, Luke Valenta,
Benjamin VanderSloot, Will Scott, Nick Sullivan, J Alex
Halderman, and Roya Ensaﬁ. 403 forbidden: A global
view of cdn geoblocking. In Proceedings of the Internet
Measurement Conference 2018, pages 218–230. ACM,
2018.
[55] Roberto Gonzalez, Claudio Soriente, and Nikolaos
Laoutaris. User proﬁling in the time of https.
In Pro-
ceedings of the 2016 Internet Measurement Conference,
pages 373–379. ACM, 2016.
[56] Marc Liberatore and Brian Neil Levine.
”Inferring
the source of encrypted HTTP connections”.
In ACM
Conference on Computer and Communications Security
(CCS), pages 255–263. ACM, 2006.
[57] Kevin P. Dyer, Scott E. Coull, Thomas Ristenpart, and
Thomas Shrimpton. Peek-a-Boo, I still see you: Why
efﬁcient trafﬁc analysis countermeasures fail.
In IEEE
Symposium on Security and Privacy (S&P), pages 332–
346. IEEE, 2012.
[58] Qixiang Sun, Daniel R Simon, Yi-Min Wang, Wilf Rus-
sel, Venkata N. Padmanabhan, and Lili Qiu. Statistical
identiﬁcation of encrypted web browsing trafﬁc. In IEEE
Symposium on Security and Privacy (S&P), pages 19–30.
IEEE, 2002.
[59] Andrew Hintz.
Fingerprinting websites using trafﬁc
analysis. In Privacy Enhancing Technologies Symposium
(PETS), pages 171–178. Springer, 2003.
[60] Dominik Herrmann, Rolf Wendolsky, and Hannes Fed-
errath. Website ﬁngerprinting: attacking popular pri-
vacy enhancing technologies with the multinomial Na¨ıve-
Bayes classiﬁer. In ACM Workshop on Cloud Computing
Security, pages 31–42. ACM, 2009.
[61] Andriy Panchenko, Lukas Niessen, Andreas Zinnen, and
Thomas Engel. Website ﬁngerprinting in onion routing
based anonymization networks.
In ACM Workshop on
Privacy in the Electronic Society (WPES), pages 103–
114. ACM, 2011.
[62] Mario Almeida, Alessandro Finamore, Diego Perino,
Narseo Vallina-Rodriguez, and Matteo Varvello. Dissect-
ing dns stakeholders in mobile networks.
In Proceed-
ings of the 13th International Conference on emerging
Networking EXperiments and Technologies, pages 28–34.
ACM, 2017.
[63] David Plonka and Paul Barford. Context-aware clustering
In Proceedings of the 8th ACM
of dns query trafﬁc.
SIGCOMM conference on Internet measurement, pages
217–230. ACM, 2008.
[64] Rebekah Houser, Zhou Li, Chase Cotton, and Haining
Wang. An investigation on information leakage of DNS
over TLS.
the 15th International
Conference on Emerging Networking Experiments And
Technologies (CONEXT), pages 123–137, 2019.
In Proceedings of
[65] Rob Jansen, Marc Juarez, Rafael Galvez, Tariq Elahi,
and Claudia Diaz. Inside job: Applying trafﬁc analysis
to measure tor from within.
In Network & Distributed
System Security Symposium (NDSS). Internet Society,
2018.
[66] Trevor Hastie, Robert Tibshirani, and Jerome Friedman.
The Elements of Statistical Learning. Springer Series in
Statistics. Springer New York Inc., New York, NY, USA,
2001.
[67] Rebekah Overdorf, Marc Juarez, Gunes Acar, Rachel
Greenstadt, and Claudia Diaz. How unique is your onion?
an analysis of the ﬁngerprintability of tor onion services.
In ACM Conference on Computer and Communications
Security (CCS), pages 2021–2036. ACM, 2017.
[68] Marc Juarez, Mohsen Imani, Mike Perry, Claudia Diaz,
and Matthew Wright. Toward an efﬁcient website ﬁnger-
16
printing defense. In European Symposium on Research
in Computer Security (ESORICS), pages 27–46. Springer,
2016.
[69] Ariel Stolerman, Rebekah Overdorf, Sadia Afroz, and
Rachel Greenstadt. Breaking the closed-world assump-
tion in stylometric authorship attribution.
In IFIP Int.
Conf. Digital Forensics, 2014.
[70] Muhammad Ahmad Bashir and Christo Wilson. Diffusion
of user tracking data in the online advertising ecosystem.
2018.
[71] Marc Juarez, Sadia Afroz, Gunes Acar, Claudia Diaz,
and Rachel Greenstadt. A critical evaluation of website
ﬁngerprinting attacks. In ACM Conference on Computer
and Communications Security (CCS), pages 263–274.
ACM, 2014.
[72] John S Otto, Mario A S´anchez, John P Rula, and Fabi´an E
Bustamante. Content delivery and the natural evolution
of DNS: remote dns trends, performance issues and
alternative solutions. In Proceedings of the 2012 Internet
Measurement Conference, pages 523–536. ACM, 2012.
[73] John P Rula and Fabian E Bustamante. Behind the
curtain: Cellular dns and content replica selection.
In
Proceedings of the 2014 Conference on Internet Mea-
surement Conference, pages 59–72. ACM, 2014.
[74] Platon Kotzias, Abbas Razaghpanah, Johanna Amann,
Kenneth G Paterson, Narseo Vallina-Rodriguez, and Juan
Caballero. Coming of age: A longitudinal study of tls
deployment. In Proceedings of the Internet Measurement
Conference, pages 415–428. ACM, 2018.
[75] J. Damas, M. Graff, and P. Vixie. Extension mechanisms
for dns (edns(0)). RFC 6891, RFC Editor, April 2013.
[76] Padding Policies for Extension Mechanisms for DNS
(EDNS(0)). https://tools.ietf.org/html/rfc8467. Accessed:
2019-05-10.
[77] Michael Carl Tschantz, Sadia Afroz, Anonymous, and
Vern Paxson. Sok: Towards grounding censorship cir-
cumvention in empiricism.
In IEEE Symposium on
Security and Privacy (S&P), pages 914–933. IEEE, 2016.
[78] Sheharbano Khattak, Tariq Elahi, Laurent Simon,
Colleen M Swanson, Steven J Murdoch, and Ian Gold-
berg.
SoK: Making sense of censorship resistance
systems. Privacy Enhancing Technologies Symposium
(PETS), 2016(4):37–61, 2016.
[79] URL testing lists intended for discovering website cen-
sorship. https://github.com/citizenlab/test-lists. Accessed:
2019-09-11.
[80] Paul Schmitt, Anne Edmundson, Allison Mankin, and
Nick Feamster. Oblivious dns: practical privacy for dns
queries. Proceedings on Privacy Enhancing Technolo-
gies, 2019(2):228–244, 2019.
[81] Davis Yoshida and Jordan Boyd-Graber. Using confusion
graphs to understand classiﬁer error. In Proceedings of
the Workshop on Human-Computer Question Answering,
pages 48–52, 2016.
APPENDIX
A. Datasets
Table IX provides an expanded version of
overview.
B. Performance metrics.
In this section, we provide an overview of our classifer
evaluation metrics. We use standard metrics to evaluate the
the dataset
performance of our classiﬁer: Precision, Recall and F1-Score.
We compute these metrics per class, where each class repre-
sents a webpage. We compute these metrics on a class as if it
was a “one vs. all” binary classiﬁcation: we call “positives” the
samples that belong to that class and “negatives” the samples
that belong to the rest of classes. Precision is the ratio of true
positives to the total number of samples that were classiﬁed
as positive (true positives and false positives). Recall is the
ratio of true positives to the total number of positives (true
positives and false negatives). The F1-score is the harmonic
mean of precision and recall.