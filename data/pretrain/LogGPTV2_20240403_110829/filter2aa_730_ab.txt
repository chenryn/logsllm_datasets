26
6,65%
UTC -4
1000
74
3
6
16
99
9,90%
UTC -5
1000
53
13
11
6
83
8,30%
UTC -6
1000
30
10
9
68
117
11,70%
UTC -7
1000
92
11
8
62
173
17,30%
UTC -8
21
3
1
0
0
4
19,05%
UTC -9
10
0
1
0
0
1
10,00%
UTC -10
2
0
0
0
0
0
0,00%
UTC -11
6
0
0
0
0
0
0,00%
@unapibageek - @ssantosv
statistics
1000 SAMPLES WITH  AAPT  TIMEZONE  DISCLOSURE
% of samples identified as malware
@unapibageek - @ssantosv
MALWARE (1000 SAMPLES) ANALYZED  WITH  FILE/CERTiFICATE  DATETIMES
Type
# of APKs
Detected only by 
1 AV
Detected only by 
2 AV
Detected only by 
3 AV
Detected by +3 
AV
TOTAL
% detected
UTC +0
1000
35
16
11
107
169
16,90%
UTC +1
1000
58
8
2
26
94
9,40%
UTC +2
1000
76
13
16
80
185
18,50%
UTC +3
1000
91
28
15
60
194
19,40%
UTC +4
1000
72
27
18
65
182
18,20%
UTC +5
1000
58
29
31
153
271
27,10%
UTC +6
1000
98
24
16
70
208
20,80%
UTC +7
1000
53
20
3
43
119
11,90%
UTC +8
1000
83
31
16
218
348
34,80%
UTC +9
1000
71
51
3
36
161
16,10%
UTC +10
1000
43
7
16
44
110
11,00%
UTC +11
1000
53
12
7
139
211
21,10%
UTC +12
1000
55
10
1
59
125
12,50%
UTC -1
1000
17
6
3
31
57
5,70%
UTC -2
1000
29
9
6
29
73
7,30%
UTC -3
1000
36
3
4
40
83
8,30%
UTC -4
1000
59
11
5
145
220
22,00%
UTC -5
1000
49
7
2
153
211
21,10%
UTC -6
1000
43
15
8
383
449
44,90%
UTC -7
1000
33
11
7
23
74
7,40%
UTC -8
1000
35
10
4
32
81
8,10%
UTC -9
276
16
4
2
24
46
16,67%
UTC -10
588
36
21
4
24
85
14,46%
UTC -11
293
26
4
1
20
51
17,41%
Is this useful for malware?
@unapibageek - @ssantosv
statistics
1000 APKS WITH  FILE/CERTiFICATE DATETIMES (do not forget DST!)
% of samples identified as malware
@unapibageek - @ssantosv
statistics
DISTRIBUTION OF MALWARE BY 
TIMEZONE AND USING…
3807 APKS IDENTIFIED AS MALWARE WITH 
FILE/CERTIFICATE  DATETIMES
2055 APKS IDENTIFIED AS MALWARE WITH 
AAPT  TIMEZONE  DISCLOSURE
@unapibageek - @ssantosv
statistics
IN OUR DATABASE, THE STANDARD RATE IS: FOR EACH 
RANDOM 1000APKS WE IDENTIFY 60 AS MALWARE, So:
1000 APKs sample
# APKs Detected by +3 AV
Times more likely to be malware than 
Standard Rate
UTC +5
153
2,55
UTC +8
218
3,63
UTC -5
153
2,55
UTC -6
383
6,38
UTC +4
72
1,20
UTC +8
126
2,10
IN SHORT: AN UTC-6 APK IS 6,38 TIMES MORE LIKELY 
TO BE  MALWARE THAN STANDARD RATE
@unapibageek - @ssantosv
EXAMPLES
@unapibageek - @ssantosv
EXAMPLES
FILE/CERTiFICATE DATETIMES 
REAL EXAMPLE: DEATHRING
AAPT  TIMEZONE  DISCLOSURE REAL EXAMPLE:  JUDY
@unapibageek - @ssantosv
EXAMPLES
CHINESE COMPILED APKS IN THE SPOTLIGHT
@unapibageek - @ssantosv
EXAMPLES
HIDDAD MALWARE, COMES FROM…
@unapibageek - @ssantosv
EXAMPLES
BOTH TECHNIQUES EXAMPLES:
certificateValidFrom
signatureFileLastUpdateDate
oldestDateFile
File/Certificate DateTime Technique
2016/12/04 07:27:57
2016/12/04 10:30:14
1980/01/01 03:00:00
03:02:17
2016/12/03 16:21:02
2016/12/03 19:24:30
1980/01/01 03:00:00
03:03:28
2016/12/03 11:52:30
2016/12/03 14:55:54
1980/01/01 03:00:00
03:03:24
@unapibageek - @ssantosv
EXAMPLES
BOTH TECHNIQUES EXAMPLES:
certificateValidFrom
signatureFileLastUpdateDate
oldestDateFile
File/Certificate DateTime Technique
2016/12/04 07:27:57
2016/12/04 10:30:14
1980/01/01 03:00:00
03:02:17
2016/12/03 16:21:02
2016/12/03 19:24:30
1980/01/01 03:00:00
03:03:28
2016/12/03 11:52:30
2016/12/03 14:55:54
1980/01/01 03:00:00
03:03:24
FULLY 
AUTOMATED?
@unapibageek - @ssantosv
@unapibageek - @ssantosv
metadata
WANNACRY METADATA, THE INSPIRATION
@unapibageek - @ssantosv
metadata
WANNACRY METADATA, THE INSPIRATION
@unapibageek - @ssantosv
metadata
WAS IT USEFUL IN ANDROID MALWARE?
@unapibageek - @ssantosv
metadata
WAS IT USEFUL IN ANDROID MALWARE?
@unapibageek - @ssantosv
strings
./aapt d --values strings android_app.apk
@unapibageek - @ssantosv
strings
./aapt d --values resources android_app.apk
| grep '^ *resource.*:string/' --after-context=1 > output.txt
@unapibageek - @ssantosv
Our tool
@unapibageek - @ssantosv
Conclusions & Future Work
We presented different ways for not just leaking
timezone but as well…
•
Possibly detecting automated malware creation
•
Possible better Machine learning features in 
detecting APK malware
•
A tool for a quick view of all this useful
information around APKs metadata
Future work should be more accurate about DST and 
using more samples
@unapibageek - @ssantosv
Thank you!
Sheila Ayelen Berta
Sergio De Los Santos
Security Researcher – ElevenPaths
(Telefonica Digital cyber security unit)
@UnaPibaGeek
PI:EMAIL
Head of Research – ElevenPaths
(Telefonica Digital cyber security unit)
@ssantosv
PI:EMAIL