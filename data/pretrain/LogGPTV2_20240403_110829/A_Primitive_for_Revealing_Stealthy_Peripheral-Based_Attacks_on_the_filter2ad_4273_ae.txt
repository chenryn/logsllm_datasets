(cid:7)
(cid:12)(cid:13)(cid:14)(cid:15)(cid:6)(cid:5)(cid:11)(cid:16)(cid:17)(cid:11)(cid:21)(cid:22)(cid:23)(cid:11)(cid:21)(cid:16)(cid:5)(cid:6)(cid:3)
(cid:6)(cid:7)(cid:5) (cid:8)(cid:9)(cid:3)(cid:3) (cid:10)(cid:2)(cid:3)(cid:3) (cid:10)(cid:11)(cid:4)(cid:12)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:9)
(cid:2)
(cid:11)
(cid:10)
(cid:4)
(cid:9)
(cid:8)
(cid:7)
(cid:6)
(cid:5)
(cid:4)
(cid:3)
(cid:2)
(cid:1)
(cid:17)
(cid:16)
(cid:11)
(cid:5)
(cid:6)
(cid:15)
(cid:14)
(cid:13)
(cid:12)
(cid:11)(cid:12)(cid:13)
(cid:9)
(cid:2)
(cid:11)
(cid:10)
(cid:4)
(cid:9)
(cid:8)
(cid:7)
(cid:6)
(cid:5)
(cid:4)
(cid:3)
(cid:2)
(cid:1)
(cid:17)
(cid:16)
(cid:11)
(cid:5)
(cid:6)
(cid:15)
(cid:14)
(cid:13)
(cid:12)
(cid:3)
(cid:9)
(cid:16)
(cid:2)
(cid:20)
(cid:4)
(cid:8)
(cid:3)
(cid:9)
(cid:8)
(cid:5)
(cid:19)
(cid:11)
(cid:3)
(cid:13)
(cid:18)
(cid:3)
(cid:9)
(cid:16)
(cid:2)
(cid:20)
(cid:4)
(cid:8)
(cid:3)
(cid:9)
(cid:8)
(cid:5)
(cid:19)
(cid:11)
(cid:3)
(cid:13)
(cid:18)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:9)
(cid:2)
(cid:11)
(cid:10)
(cid:4)
(cid:9)
(cid:8)
(cid:7)
(cid:6)
(cid:5)
(cid:4)
(cid:3)
(cid:2)
(cid:1)
(cid:17)
(cid:16)
(cid:11)
(cid:5)
(cid:6)
(cid:15)
(cid:14)
(cid:13)
(cid:12)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:4)(cid:3)
(cid:5)
(cid:3)
(cid:1)(cid:5)
(cid:1)(cid:4)(cid:3)
(cid:1)(cid:4)(cid:5)
(cid:1)(cid:2)(cid:3)
(cid:6)(cid:7)(cid:8)
(cid:6)(cid:9)(cid:10)
(cid:21)(cid:22)(cid:23)(cid:11)(cid:24)(cid:5)(cid:6)(cid:25)(cid:13)(cid:6)(cid:9)(cid:4)(cid:10)
(cid:6)(cid:7)(cid:8)
(cid:9)(cid:10)(cid:9)
(cid:21)(cid:20)(cid:5)(cid:6)(cid:3)(cid:3)(cid:11)(cid:19)(cid:6)(cid:3)(cid:20)(cid:3)
(cid:2)
(cid:6)
(cid:7)
(cid:8)
(cid:21)(cid:22)(cid:23)(cid:11)(cid:24)(cid:2)(cid:25)(cid:6)(cid:11)(cid:2)(cid:9)(cid:11)(cid:26)(cid:18)
(cid:13)(cid:14)(cid:15)
(cid:19)(cid:6)(cid:3)(cid:20)(cid:11)(cid:21)(cid:22)(cid:8)(cid:20)(cid:17)(cid:16)(cid:5)(cid:14)(cid:3)
(cid:11)(cid:12)(cid:13)
Fig. 7. Determining an Adequate Tolerance Value T : Figures (a) – (f) present
the discrepancy of Aa computations when evaluating BARM with diﬀerent tests.
BARM performed 100 runs on each test to determine Aa. With discrepancy we mean
the diﬀerence between the maximum and minimum Aa value. Figures (a) – (f) visualize
the discrepancy in the form of boxplots. For each test the respective minimum, lower
quartile, median, upper quartile as well as maximum Aa value is depicted. The small
point between minimum and maximum is the average Aa value. The Aa values range
mostly between −10 and 10. The highest absolute value is 19, see Figure (e) X61s.
5.2 Performance Overhead When Permanently Monitoring
Since BARM aﬀects only the host CPU and the main memory directly, we
evaluated the performance overhead for those two resources. BARM does not
access the harddisk and the network card when monitoring.
We evaluated BARM on a 64 bit Ubuntu kernel (version 3.5.0-26). During
our tests we run the host CPU with maximum frequency thereby facilitating the
host CPU to cause as much bus activity as possible. Furthermore, we executed
our test with 1 CPU bus master as well as with 2 CPU bus masters to determine
if the number of CPU bus masters has any impact on the performance overhead.
Eventually, we need to use more processor registers (PMUs) with a second CPU
bus master. Another important point is the evaluation of the sampling interval.
Hence, we conﬁgured BARM with diﬀerent intervals and checked the overhead.
To measure the overhead we used Time Stamp Counters (TSC, processor register
that counts clock cycles after a platform reset [25, Section 17.12]) for all our tests.
5.3 A Use Case to Demonstrate BARM’s Eﬀectiveness
Even if we do not consider all platform bus masters in our presented PoC imple-
mention we can demonstrate the eﬀectiveness of BARM. This is possible because
Revealing Stealthy Peripheral-Based Attacks on Main Memory
15
(cid:2)
(cid:7)
(cid:6)
(cid:5)
(cid:4)
(cid:3)
(cid:2)
(cid:1)
(cid:11)
(cid:4)
(cid:2)
(cid:10)
(cid:9)
(cid:2)
(cid:7)
(cid:8)
(cid:23)(cid:25)(cid:29)
(cid:2)
(cid:7)
(cid:6)
(cid:5)
(cid:4)
(cid:3)
(cid:2)
(cid:1)
(cid:11)
(cid:4)
(cid:2)
(cid:10)
(cid:9)
(cid:2)
(cid:7)
(cid:8)
(cid:8)(cid:2)(cid:1)(cid:4)
(cid:8)(cid:2)(cid:1)(cid:11)
(cid:8)(cid:2)(cid:1)(cid:10)
(cid:8)(cid:2)(cid:1)(cid:9)
(cid:8)(cid:2)(cid:1)(cid:8)
(cid:8)
(cid:1)(cid:2)(cid:3)(cid:3)
(cid:1)(cid:2)(cid:3)(cid:7)
(cid:1)(cid:2)(cid:3)(cid:6)
(cid:1)(cid:2)(cid:3)(cid:5)
(cid:1)(cid:2)(cid:3)(cid:4)
(cid:8)(cid:2)(cid:1)(cid:4)
(cid:8)(cid:2)(cid:1)(cid:11)
(cid:8)(cid:2)(cid:1)(cid:10)
(cid:8)(cid:2)(cid:1)(cid:9)
(cid:8)(cid:2)(cid:1)(cid:8)
(cid:8)
(cid:1)(cid:2)(cid:3)(cid:3)
(cid:1)(cid:2)(cid:3)(cid:7)
(cid:1)(cid:2)(cid:3)(cid:6)
(cid:1)(cid:2)(cid:3)(cid:5)
(cid:1)(cid:2)(cid:3)(cid:4)
(cid:8)(cid:2)(cid:1)(cid:4)