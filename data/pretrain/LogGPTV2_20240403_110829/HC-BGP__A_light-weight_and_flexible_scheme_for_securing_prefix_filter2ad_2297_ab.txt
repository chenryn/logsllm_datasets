24
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:20 UTC from IEEE Xplore.  Restrictions apply. 
preﬁxhijackingattackswithfalseorigin.Fortherarecasesofannouncingnew(sub)preﬁxes,aninitializationstepisper-formedtobootstrapthehashchain,whichinvolvesaslightlymorecomputationallyexpensiveasymmetric-keyalgorithm.Theinitializationisoptimizedtoonlyrequirepublickeyex-changelimitedtotwoneighboringASesinsteadofaglobalPKI.Topreventtamperingwiththeinitializationprocessandthereplayattackduringthesubsequentroutepropagation,weex-ploittheInternethierarchicalstructureandthebusinessrela-tionshipamongASestoimposeapartialorderingontheroutepropagation.WeprovethatnoreplayattackcansucceedifeveryASfollowstheguideline.NotethatthepartialorderingdoesnotchangetheBGProuteselectionwhenpreventingthereplayattack.Insummary,HC-BGPisalight-weightapproachtoprovidepreﬁxownershipsecuritywithoutaglobalPKI.Moreover,itsdesigntoconnectthesub-preﬁxannouncementwithcover-preﬁxownershipiseffectiveinpreventingsub-preﬁxhijack-ingattacks.Furthermore,usingourscheme,networkopera-torscanstillenjoytheﬂexibilityofcommonroutingpracticessuchasmulti-homing,preﬁxaggregation,andde-aggregation.Thepaperisorganizedasfollows.Wegivethebackgroundofpreﬁxhijackingandanoverviewofproposedprotocolin§2.Weconductempiricaldataanalysisin§3.WepresenttheHC-BGPprotocolin§4,§5,and§7.Weﬁnallyevaluateitsperformancein§8and§9.2BackgroundandOverviewPreﬁxhijackingisaseriousBGPsecuritythreatbywhichattackersstealIPaddressesbelongingtoothernetworks.TheattackerASinjectsfalseroutesintotheglobalroutingtablebyannouncinganothernetwork’spreﬁx.Thestolenaddressblockscanbeusedforothermaliciousactivitiessuchasspam-mingordenial-of-serviceattackswheretheattacker’sidentityisconcealed.ThefundamentalproblemthataccountsforthisattackisalackofpreﬁxownershipauthenticationintheBGPsystem.Inthefollowing,weﬁrstreviewseveraltypesofpre-ﬁxhijackingattacks.Wethendescribeourthreatmodel,fol-lowedbyourdesignrequirementsandcomparisontoexistingwork.2.1PreﬁxhijackingattackswithfalseoriginIPpreﬁxhijackingcanbecarriedoutinseveralways[10,24,4].Theattackercaneitherblackholethevictim’strafﬁcbyadvertisinganinvalidroutewithafalseorigin,orinterceptthetrafﬁcbyinsertingafalsenexthop,possiblyleavingtheoriginASunchanged.Inthispaper,wefocusontheattackwithfalseoriginwhichisduetoalackofaddresscertiﬁcationandusuallyresultsinsevereconsequencesuchasreachabil-ityproblems.Interception-basedhijackcanbepartiallyad-dressedbyencryptionbasedsolutions[21].Thefalse-originpreﬁxhijackingcanbefurthercategorizedbasedonsizeoftheaddressblockannounced.Belowarethetwocategories,asillustratedinFigure1.AS1AS2AS3VictimAttackerInject route: 10.1.0.0 /1610.1.0.0/16Polluted ASesNonpolluted ASesAS1AS2AS3VictimAttackerInject route:   10.1.1.0/2410.1.0.0/16Polluted ASesTraffic to 10.1.1.1Traffic to 10.1.1.1Full prefix hijackSub-prefix hijackTrafficFig.1.Preﬁxhijackingattacks.Fullpreﬁxhijack,wheretheattackerannouncesexactlythesamepreﬁxalreadyannouncedbythevictim.Othernet-workswillselectonesuchroutetoadopt.Inthiscase,theInternetispartiallypolluted.Forexample,inFigure1(a),boththeattackerandthevictimannouncethesamepreﬁx10.1.0.0/16.Consequently,AS2andAS3mayprefertheat-tacker’sroutebecauseoftheshorterASpath.Sub-preﬁxhijack,wheretheattackerannouncesonlyasubnetofapreﬁxannouncedbythevictimandthissubnetisnotannouncedpreviously.Unlessﬁltered,thisnewsub-preﬁxisinjectedintotheforwardingtableregardlessoftherouteoftheexistingpreﬁx.Duetothelongestpreﬁxmatchingpol-icy,trafﬁcdestinedtothissubnetfollowsthefalserouteofthesub-preﬁx.Therefore,mostoftheInternetislikelypol-luted.InFigure1(b),theattackerannouncesthesub-preﬁx10.1.1.0/24.ThisrouteislikelyacceptedbyallotherASesasanewforwardingtableentry.Hence,trafﬁcdestinedtoIPssuchas10.1.1.1ismisledtotheattacker.Therehavebeenseveralreal-worldexamplesofpreﬁxhi-jacking.Themostrecenthijackingattack,however,pol-lutesmostoftheInternet:sub-preﬁxhijackingattackontheYouTubepreﬁx[16].OnFebruary24,2008around18:50,PakistanTelecom(AS17557)announced208.65.153.0/24tohijackYouTube(AS36561)’spreﬁx208.65.152.0/22.Be-causeitwasanewpreﬁx,mostASesadoptedit.YouTubewasblackholedforalmosttwohours.Ataround20:07,YouTubealsobegantoannounce208.65.153.0/24toreversetheef-fect.Until21:10,PakistanTelecom’sproviderPCCWGlobal(AS3491)startedtowithdrawthefalseroute.TheincidentcausedseverereachabilityproblemsforalmostallYouTubeusers.Accordingly,thescopeofaffectednetworksismuchlargerthanprevioushijackingincidents.2.2ThreatmodelWedescribethethreatmodel.GivenanetworkG,eachASisassignedasetofIPpreﬁxes.EachAScanonlyan-nouncepreﬁxesitowns.ApreﬁxpisthesetofIPaddressesannouncedinasingleroutingannouncement.Asub-preﬁxp(cid:2)ofpisasubsetoftheaddressesinp,i.e.,p(cid:2)⊂p,wherepasp(cid:2)’scover-preﬁx.Amongallthesub-preﬁxesofp,wedeﬁnethelargestsub-preﬁxp(cid:2)asthedirectsub-preﬁxofp,i.e.,if¬∃p2,p(cid:2)⊂p2⊂p,thenp(cid:2)isthedirectsub-preﬁxofpandpisthedirectcover-preﬁx.Insubsequentdiscussions,werefercover-preﬁxasdirectcover-preﬁx.Weﬁrstdeﬁnetheattacksofinterest,preﬁxhijackingat-tackswithfalseorigin.IfpbelongstoAS1,thenanyotherASxannouncingpwithASxastheoriginAS,isconsidered978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
25
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:20 UTC from IEEE Xplore.  Restrictions apply. 
ashijackingwithfalseorigin.Thistypeofattackhastwosub-categories:1)AnAScanadvertiseapreﬁxoriginatedfromanotherAS.2)AnAScanadvertiseanysubsetofan-otherpreﬁxoriginatedfromanotherAS.Wenotethesetwocategoriescoverallknownhijackingincidentsinthepast.AfterASxhijacksp,inmostcases,itblackholesaportionofallthetrafﬁcdestinedtoAS1.ButitcanalsotunnelthetrafﬁcbacktoAS1tobemorestealthytocarryoutaninter-ceptionattack[4].Wealsoconsiderthisattacktype.NotethatwedonotconsideranyattacksmodifyingotherpartsoftheASpath,e.g.,modifyingpath(ASx,AS2,AS1)tobe(ASx,AS1).2.3SolutionrequirementsApracticalprotocolthatcanpreventtheaboveattacksshouldsatisfythefollowingrequirements.1.EnsuringOriginAttestation:Itshouldpreventbothfullpreﬁxandsub-preﬁxfalse-originhijacking.Ifanattackerad-vertisesthepreﬁxcurrentlyannouncedbyitsowner,oranewsub-preﬁxcoveredbyalargerpreﬁxownedbyothernetworks,theroutetotheattackershouldbediscarded.2.Flexible:ItshouldsupporttheﬂexibilityforlegitimatemultipleoriginAS(MOAS)andtrafﬁcengineering.Onepre-ﬁxcanbeannouncedbytwoASesforseverallegitimaterea-sons[25]:thepreﬁxoftheexchangepointsisusuallyan-nouncedbymorethanoneASconnectedattheexchangepoint;asmallcustomerwithoutitsownASnumbermayuseaprivateASnumbertomulti-hometotwoproviderswhichannouncethepreﬁxsimultaneously.Oursolutionneedstoac-commodatethesedynamics.Fortrafﬁcengineeringpurposes,onepreﬁxcouldbede-aggregatedtomultiplesub-preﬁxesannouncedindependentlyofthepreﬁx.Ontheotherhand,theownercanalsoaggregateasetofsub-preﬁxestoasinglelargepreﬁxtolimitroutingtablesize.Oursolutionalsoneedstoprovideﬂexibilityforaggregation/de-aggregationoperations.3.Incrementallydeployable:LikeallothersecureBGPprotocols,itisimpossibletoforceallASestoadoptthenewprotocolsimultaneously.Theadoptabilityofaprotocolhighlydependsonitsincrementalbeneﬁt[8].ThenewprotocolneedstosupportincrementaldeploymenttoprovideenoughincentivesforISPstodeployit.4.Light-weight:AmajorconcernforpreviouslyproposedsecureBGPprotocolsisthehighoverheadforbothcomputa-tionandstorage.Toensurepracticaladoptability,weneedtodesignasolutionwithlowoverhead.TheproposedHC-BGPsatisﬁesallfourrequirements.2.4ComparisonwithprevioussecureBGPprotocolsSeveralprotocolshavebeenproposedtoenhanceBGPsecuritybyincorporatingcryptographicmechanismstopro-videconﬁdentiality,integrity,andoriginauthentication.S-BGP[19]istheﬁrstcomprehensivesecureroutingprotocol.Itreliesontwopublickeyinfrastructures(PKIs)tosecureASidentityandassociationbetweennetworksandASes.Eachroutecontainstwoattestations(digitallysignedsignatures),onefortheoriginauthenticationandonefortheroutein-tegrity.Inreality,duetothelargenumberofsignandverifyoperations,S-BGPistoocostlytodeploy.MostofthefollowupworktoS-BGPfocusonreducingthecomputationalcomplexityofthesecondsecuritypropertiesofS-BGP,i.e.,generating/verifyingtherouteattestation.Forexample,SPV[11]utilizespurelysymmetriccryptographicprimitives,asetofone-timesignatures,toimproveefﬁciency.Butleretal.[7]reducedthecomplexityofS-BGPbyexplor-ingpathstability.Alongtheangleofreducingtheoverheadofasymmetrickey,Henetal.[23]proposedaschemeusingkeychaintoimproveitsperformance.Onlyoneexistingwork,Se-cureOriginBGP(soBGP)[17],focusesonprovidingaddressattestation.However,soBGPstillusesonePKItoauthenticatetheaddressownershipandASidentity.EachsoBGProuterﬁrstbuildsatopologydatabasesecurely,includingtheaddressownership,organizationrelationshipandtopology.Aielloetal.buildsanaddressownershipproofsystem[3]whichstillusesacentralizedinfrastructurerequiringgatheringaddressdelegationinformation.Insummary,allprevioussecureBGPprotocolsleavethepreﬁxownershipassuranceunchanged.S-BGPreliesontheaddressattestationwiththeassistancefromthecentralizedtrustentityICANN.SPVproposesusingidentitybasedcryp-tography(IBC)tomakethepublickeydistributionmoreﬂex-ible.However,theseaddressattestationmethodssufferfrom:1)dependenceonaglobalPKI;2)theneedforaveriﬁcationoperationforeachroutingupdate;3)inﬂexibilityfororiginASchanges;4)inabilitytohandlesubpreﬁxhijacking.Incontrast,HC-BGPisanewapproachtopreﬁxowner-shipauthenticationthatisbothmoreefﬁcientandﬂexiblethanpreviousapproaches.Ourschemeusesthelight-weighthashchainmechanismandthelessfrequentcryptographicopera-tions,andhenceisefﬁcientintermsofcomputationalcom-plexityandmemoryconsumption.OurschemedoesnotrelyonaglobalPKI,andhenceitprovidesmuchmoreﬂexibilityfortrafﬁcengineeringintermsoforiginASchanges,addressallocation/de-allocation.3HypothesisandempiricalanalysisOurgoalistodesignapracticalandefﬁcientsolutiontosecurepreﬁxownership.Towardsthisgoal,weﬁrstseektogaininsightsintoseveralkeycharacteristicsofthepreﬁxesannouncedintheInternet.Weinvestigatetwohypothesesthatdirectlyrelatetothedesignofanefﬁcientsecureprotocol:Hypothesis1:Foreachpreﬁx,thesetofitsoriginASesisquitestable.Thispropertydirectlyaffectsfrequencyforupdatingthesecureassociation.Hypothesis2:Theaggregation/de-aggregationdynamicsforeachpreﬁxisinfrequent.Thispropertyrelatestotheasso-ciationchangesacrosspreﬁxes.Toanalyzethesetwohypotheses,weperformanin-depthanalysisofthedynamicsoftheoriginchangesaswellasthedistributionofthepreﬁxes/sub-preﬁxes.WestudytheseaspectsusingthreemonthsofBGPdata,978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
26
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:20 UTC from IEEE Xplore.  Restrictions apply. 
fromDec.2007toFeb.2008,fromallvantagepointsinRouteViews[2].First,tosupporttheﬂexibilityofMOAS,westudiedthefrequencyandstabilityofsuchchanges.Wefoundthatacrosstheentirethreemonths,only1935(0.9%)preﬁxeshadMOASbehavior.Amongthem,97%hadonly2originASes,asshowninFigure2.Acrosstheentirethreemonths,weonlyobserve52preﬁxesannouncedbyneworiginASes.ThismeansthatthesetoforiginASesforeachMOASpreﬁxisquitestable.Second,weneededtoprovidetheﬂexibilityofthecoexis-tenceofthepreﬁxandsub-preﬁx.Wefoundthatamongthetotalof214,043preﬁxesintheglobalroutingtable,only8%(17115)hadsub-preﬁxes.Amongthem,thoughsomepre-ﬁxeshadmanysub-preﬁxes,wefoundthat90%hadlessthan10directsub-preﬁxes,asshowninFigure3.Finally,weanalyzedthedynamicsofaggregation/de-aggregation.InFigure4,eachAggregationeventreferstowhenonesub-preﬁxiswithdrawn,anditscover-preﬁxstillexists,andeachDe-aggregationeventreferstowhenwhenanewsub-preﬁxisannounced.Thedurationofaggregationisthetimeperiodwhenonlythecover-preﬁxexists,andthedu-rationofde-aggregationistheperiodwhenonlythesub-preﬁxexists.Theﬁgureshowsaggregationandde-aggregationoc-currarely.Theshortdurationsoflessthan10minutesaremostlikelyduetoBGPconvergence.Fromtheaboveanalysis,wedrawthefollowingobserva-tionsconﬁrmingthetwohypothesesabovewhicharethenex-ploitedinthedesignofHC-BGP.1.OnlyafewpreﬁxeshavemorethanoneoriginAS.Amongthem,mosthaveonlytwooriginASes.2.ThesetoforiginASesforMOASpreﬁxesisstable.3.Majorityofthepreﬁxesdonothavesub-preﬁxes.4.Neitherpreﬁxaggregation/de-aggregationnorpreﬁxori-ginchangesareoften.AkeyobservationthatguidesourHC-BGPprotocoldesignisthatmostoftheproposedsecureBGPprotocolsrequireori-ginauthenticationuponanyUPDATEmessageforthispre-ﬁx.Incontrast,becauseourproblemistodefendagainstthefraudulentorigin(sub)preﬁxhijacking,weonlyneedtoauthenticatethebindingbetweenagivenoriginASandthepreﬁx,whichisthus,onlyneededwhenthebindingchanges.Guidedbythisobservation,wecandesignamuchmoreefﬁ-cientprotocoltosecurethisbinding.4HC-BGPProtocolWenowpresentHC-BGP,anewsecureBGPprotocolthatpreventsbothfullpreﬁxandsub-preﬁxhijackingattacks.Weﬁrstdescribetheone-wayhashchainbuildingblock,ourtrustmodel,followedbytheprotocol.4.1One-wayhashchainsOne-wayhashchainisawidelyusedlight-weightcrypto-graphicmethodtoprovidesecurity.ItwasﬁrstproposedbyLamport[14]forpasswordprotection.Usingacryptographichashfunctionh(s),aclientﬁrstneedstouseothersecuritymethodstonotifytheserveroftheinitialvaluehn(s).Forsubsequentcommunication,theclientonlyneedstopresentTable1.Terminologyh()hashchainfunctionpapreﬁxˆpthedirectcover-preﬁxofpspthesecretofpreﬁxphn(sp)theinitialvalueofhashchainforpreﬁxphc(sp)thecurrentvalueofhashchainforpreﬁxpk−irouterR(cid:2)isprivatekeyk+irouterR(cid:2)ispublickeyk=hn−1(s)totheserver.Theservercomputesh(k)=h(hn−1(s))tocomparewiththepre-storedhn(s).Iftheymatch,theserververiﬁestheclientidentity.Hashchainhasthefollowingkeyproperties.Itisusefulincaseswhereanauthenticationisdoneonce,allthefollowingvaluesforsubsequentauthenticationcanbederivedefﬁcientlybyrepeatedlycomputingthehashfunctionvalue.Theotherendcaneasilyverifyeachnewvalue.Theone-wayhashfunc-tionguaranteesthatgivenavaluehi(s),itiscomputationallyinfeasiblefortheattackertoderivethesecrets.Moreover,manyhashfunctionscanprovidethesecondpre-imagecol-lisionresistant:itisimpossibletoﬁndanothers(cid:2)suchthath(s(cid:2))=hi+1(s).HC-BGPuseshashchainstosecurethebindingbetweentheoriginASandthepreﬁxefﬁcientlyinallsubsequentUP-DATEmessagesoncetheﬁrstbindingisauthenticated.4.2TrustmodelAsdiscussedin§2.4,allprevioussecureBGPprotocolsrequireaglobalPKItoprovideauthenticity.EveryASintheInternetmustestablishatrustrelationshipwiththisglobalen-tityanddependonitforanychanges.EachASneedstoholdallotherASes’keys.Especially,foraddressattestation,allexistingsecureBGPmethodsrelyonthePKI.Thishasim-posedsigniﬁcantmanagementburden,andhasreceivedafairshareofcriticism[20].Unlikepreviouswork,werelyontherelationshipbetweeneverypairofneighboringASestoprovideauthenticity.WedonotrequireeachAStoknowallotherASes’key.Instead,eachASestablishesatrustrelationshipwithitsdirectlycon-nectedneighbors:ifASAandASBareneighbors,AandBtrustseachother,denotedasA↔B.Thispair-wisetrustmodelisconsistentwiththecurrentcommercialrelationshipestablishedbetweenASes.Thus,thetrustiseasytoestablishinpractice;forinstance,thekeysbetweentwoentitiescanbeexchangedinthecontract.Thetwotnetitiescanevendecidetouseeithersymmetrickeyorasymmetrickeyﬂexiblythem-selves.Inthecontextofpreﬁxhijacking,weassumethateachAStrustsitsproviderwhichdoesnothaveincentivestohijackcustomers’addressesascustomertrafﬁcwillalwaystraversesitsnetwork.Moreover,weassumeallTier-1ASesaretrust-worthyastheyarelargeISPswithcarefulnetworkmanage-ment.Historically,therehasbeennoknowneventsofanyTier-1ASlaunchinghijacking.Notethatthetrustrelation-shipisestablishedattheASlevel.Weassumealltherouters978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
27