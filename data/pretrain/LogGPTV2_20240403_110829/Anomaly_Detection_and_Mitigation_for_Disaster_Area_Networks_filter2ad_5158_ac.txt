the number of deliveries of each message is propagated slower than usual and
the message is kept in the network for a longer time than needed increasing the
transmission of packets around a 25%.
Obviously, the application of these techniques reduces the performance of
the network if enabled indeﬁnitely (we lose some of the strengths of RWG). This
is the reason why they are not an integrated part of the protocol speciﬁcation.
Instead, it is best to apply them just during an interval (Im) after the detection
of an attack. Further studies should show what are the optimal intervals to select
for Im in a given network environment.
5.4 Evaluation metrics
Given the chaotic nature of the scenario we would not be able to use the classic
detection rate (DR) and false positive rate (FPR) metrics for evaluation. This
is due to the fact that the success of the approach is not measurable with those
metrics neither on a per node basis nor on a network wide (average) basis. The
locality of the attackers, the nature of the partitions, and the mobility of the
nodes, all aﬀect the results so that there are no meaningful homogeneous out-
comes using these metrics. However, we will come back to them and analyse the
above locality aspects in Section 5.6. Our main evaluation metrics for detection
and mitigation are instead:
– K-Delivery Rate (KDR): Depending on the connectivity of the network,
the message load, and the dynamics only a proportion of the messages sent
are ﬁnally k-delivered. Thus, a good metric to evaluate the possible eﬀects
of an attack and its mitigation is the number of messages which are in fact
k-delivered over the interval of study.
– Packet Transmission Rate (PTR): Another relevant metric is the num-
ber of packets transmitted during the interval of study. Besides being an
indicator of the usage of bandwidth as a resource, the PTR is an indicator
of the energy spent by the nodes, since the more transmissions the more
energy is consumed.
5.5 Detection and mitigation results
The detection approach proposed in Section 4 has been tested with the two at-
tacks and two combinations described in Section 5.2 (continuous and transient).
In the following, whenever an attack is sensed the anomaly detector enables both
mitigations at the same time (ignores ACK packets with possible bogus IDs, and
does not update the informed vector on ACK packets received). The Im interval
is selected as 200 seconds.
Fig. 4 shows the eﬀect of applying the detection and mitigation to the contin-
uous draining attack. When the detection and mitigation mechanism is disabled
the PTR in the network is around 90% higher than the normal rate as a result
of the attack (except during the initial peak which is higher). However, when
the mechanism is enabled, the PTR increases, but as soon as the attack be-
comes detected in most of the nodes, the mitigation actions are taken and the
attack impact is reduced. Fig. 5 shows the transient draining attack, which as
in the previous case increases the PTR with the same proportions. Nonetheless,
in this case an initial peak of the PTR with mitigation is noticeable since the
PTR in the simulation without attack is also increasing. In this case it is worth
mentioning that after the attack, the number of packets sent gradually returns
to the normality as the mitigation is disabled within Im of detecting in each
node. In both cases the detection delay observed is about 10-30 seconds after
the beginning of the attack for nodes close to the attackers.
Fig. 6 shows the eﬀect of applying the detection and mitigation to the con-
tinuous grey hole attack. When the mechanism is disabled and the attack starts
the KDR drastically drops to around 10% of the normal rate. With the mech-
anism enabled the KDR also drops, but not so low, and after a certain period
it stabilises to values slightly below the values without an attack . In Fig. 7 the
impact of the transient grey hole attack is shown, which as in the previous case
drastically decreases the delivery ratio. The detection and mitigation responds
similarly, but in this case it can be observed that the mechanism helps to a
fast recovery once the attack has ended. With this attack the detection delay
is longer and highly dependant on each node. The nodes close to the attackers
show a detection delay around 10-60 seconds after the beginning of the attack
for both continuous and transient modes. It is worth to say that this is a complex
attack to mitigate since once the informed vector is sent there is a contagious
impact on the other partitions while the mitigation is not enabled everywhere
(since the detection is not strong enough in some places with the same threshold
everywhere).
The results shown demonstrate that the approach is successful in creating
a resistance to the attacks that conform to the given threat model despite the
diﬃculties that the complexity of IC-MANET bring to the picture.
5.6 Locality and classic metrics
The most usual evaluation metrics for measuring the anomaly detection per-
formance are the Detection Rate (DR) 1 and the False Positive Rate (FPR) 2.
In this section we show why these metrics are less meaningful in IC-MANET.
We begin by discussing how to apply the metrics in the evaluation. To calculate
these metrics we need to determine whether during the period of alarm the node
was under attack. In intermittently connected networks the concept of being
under attack for a particular node is not clear. Just considering a ﬁxed attack
interval for all the nodes is meaningless, since attacks do not always take place
in a well-determined time interval and conﬁned space. Nodes can be isolated
from the attackers during some periods or can be too far from the attackers to
be signiﬁcantly aﬀected by them. Besides, some attacks can be propagated fur-
ther even if their source has stopped attacking, such as some types of ﬂooding
attacks. Hence, our attempt to account for the classic DR and FPR metrics,
1 DR = T P/(T P + F N ) where TP stands for true positives and FN for false negatives
2 F P R = F P/(F P + T N ) where TN stands for true negatives
)
c
e
s
/
s
t
k
p
(
s
n
o
s
s
m
s
n
a
r
t
f
i
i
o
r
e
b
m
u
N
)
c
e
s
/
s
t
k
p
(
s
n
o
s
s
m
s
n
a
r
t
f
i
i
o
r
e
b
m
u
N
Attack without detection and mitigation
Attack with detection and mitigation
No attack
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 4: Draining continuous attack
Attack without detection and mitigation
Attack with detection and mitigation
No attack
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 5: Draining transient attack
)
c
e
s
/
g
s
m
(
s
e
g
a
s
s
e
m
d
e
r
e
v
i
l
e
d
-
K
)
c
e
s
/
g
s
m
(
s
e
g
a
s
s
e
m
d
e
r
e
v
i
l
e
d
-
K
No attack
Attack with detection and mitigation
Attack without detection and mitigation
Load introduced
 18
 16
 14
 12