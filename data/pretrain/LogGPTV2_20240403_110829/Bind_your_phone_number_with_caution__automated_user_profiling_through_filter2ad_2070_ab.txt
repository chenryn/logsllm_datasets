rate is 14.18%. This number is consistent with the oﬃcial
released data 13.73%, which veriﬁes the representative of
our sampling. The distribution of the phone numbers in
each segment is shown in Figure 2. Note that no user pro-
ﬁles correspond to the phone number segment +861521070,
which is unallocated yet according to our further investiga-
tion. Among those 14179 users, not all of them upload their
information completely. Over 55.13% of them have their
proﬁle fully completed as shown in Figure 3, indicating that
most of the users indeed rely on social applications to main-
tain their social connections, thus they eager to put more
details of their personal information online to facilitate the
interaction with other people. Only 12.43% ﬁll nothing but
the required ﬁelds of WeChat ID and name. Even so, their
phone numbers already connect with the WeChat accounts
and may be leaked to attackers.
Figure 3: The Completeness of Optional Pro(cid:12)le
Fields
4.3 Horizontal Collaboration
Horizontal collaboration performs across multiple applica-
tions. We choose MiTalk Messenger [1] as our target which is
a free and cross-platform messenger application whose users
has already reached 17 million until August 2012. MiTalk
provides a seamless connection between users’ accounts and
their address books to facilitate users’ social connections.
In this phase, we use segment +861521098 which has un-
covered maximum number of user proﬁles in previous exper-
iment on WeChat. In the experiment, among those 10,000
phone numbers, 360 MiTalk user accounts have been re-
turned (denoted as M ) from MiTalk server and been added
to our MiTalk friend list. MiTalk provides a more compre-
hensive proﬁle scheme, including user name, gender, birth-
day, photo links, location he currently stays, and the names
of schools and companies. Almost all the users have more
than one photo link which can be visited directly via brows-
er, and 30% of them maintain school and company name
ﬁelds which are regarded as privacy for strangers.
As illustrated in Section 2.2, horizontal collaboration in-
cludes two parts: broad union and deep intersection. 116
new users are found in MiTalk. After broad union we totally
have 2052 phone numbers and corresponding user accounts.
In terms of deep intersection, we integrate user proﬁles ob-
tained from WeChat and MiTalk and totally 244 users are
found to have registered both applications. We then perfor-
m consistency and authenticity analysis based on these 244
users proﬁles (denoted as D).
4.4 Consistency and Authenticity Analysis
We ﬁnd that 34.02% of users in D share similar display
names in both applications, which inspires us to further ﬁnd
out in what degree their names are the oﬃcial names. We
leverage the Chinese Bai Jia Xing (aka. Hundred Family
Surnames) data set to match oﬃcial names. Typical Chi-
nese names begin with one of the surnames in Bai Jia Xing
as family name and followed by a given name of one or two
Chinese characters length. We believe that display names in
formal Chinese full name format are probably users’ oﬃcial
names. Through regular pattern matching, we investigate
the display names from W , M and D to ﬁnd out the ra-
tio of formal Chinese full name in respective dataset. The
results are shown in Table 1 that in M 48.33% of users’ dis-
play names are probably oﬃcial names, which is quite higher
than that of W , 31.24%, indicating that MiTalk users tend
to register accounts using oﬃcial names. This may be as-
cribed to the fact that MiTalk promotionally recommends
users to provide personal information as truthful as pos-
sible when registering, so as to facilitate the contact with
their friends. This “seamless” strategy makes users lean to
trust other MiTalk users. They naturally believe that the
uploaded proﬁles are only prepared for their friends by de-
fault. The case in D outperforms those in W and M that
it reaches a ratio of 59.43%, which implies users, registered
in both applications, are more adhered to and trust messen-
ger applications; thus are more willing to use real personal
information for registration.
It also makes us realize that
through deep intersection, more comprehensive and truth-
ful user proﬁles can be aggregated not only because of the
correlation but also the user habit.
We also spot another odd phenomenon - the gender in-
consistency. Presented in Table 2, 54.1% of the users in D
have their gender ﬁelds contradicted in both applications.
This phenomenon is called inconsistency which has also been
found in diﬀerent types of social networks [3]. Moreover,
among all “gender inconsistency” users, those who appear
“male in MiTalk and female in WeChat” account for 68.9%
(90/132). To further determine the likely-to-be-true gender
of each user, the winner-take-all strategy which favors ma-
jority cases if more than two choices are available could be
employed. Yet, it is still hard to conﬁrm a user’s gender just
by comparing results from two applications. However, we
have noticed that the proportion of male and female gender
is more unbalanced in WeChat proﬁles. In addition, based
on the name authenticity analysis presented above, we deem
user proﬁles in MiTalk to be more trustworthy which is con-
vincing after we manually check the display name ﬁeld of
inconsistency users in D.
1762(12.43%)437(3.08%)4163(29.36%)7817(55.13%)02000400060008000100000123#(cid:3)users#(cid:3)optional(cid:3)profile(cid:3)fields338Dataset
WeChat (W )
MiTalk (M )
Deep intersection set (D)
Total # Users # Users with Real Name
Rate
14179
360
244
4430
174
145
31.24%
48.33%
59.43%
Table 1: Comparison of Name Authenticity Analysis Results from Three Dataset - WeChat, MiTalk and
Deep Intersection Set
WeChat
MiTalk
Male Female
Male
Female
37
90
42
57
Table 2: Gender Consistency of Deep Intersection
Set
Step Field
Value
t106322XXXX
0
1
2
WeChat ID
WeChat name WangXX
Phone number +861521098XXXX
QQ name
Date of birth
Blood type
Hometown
Address
Zip code
E-mail address
Home page
Real name
Marital status
Blogs
Photos
Status
Occupation
Name of school China University of Geosciences
TianXX
1990.11.09
O
Yulin, Shannxi Province
Xueyuan Rd, Haidian Distinct
100083
PI:EMAIL
http:// X.qzone.qq.com
WangXX
X
106 blogs
628 photos
213 status
Student
Figure 4: Vertical Penetration Process
4.5 Vertical Penetration
In this section, we manually conduct a case study using
deep intersection dataset D to concisely demonstrate verti-
cal penetration.
Created by the same company, WeChat is designed to
share the same account database as QQ which is the most
popular IM (Instant Messaging) software in China. We
choose a user whose WeChat ID is “t106322XXXX” with
last four digits replaced by letter ‘X’ for privacy concern.
As shown in Figure 4, we query “user search function” of
QQ using the last ten digits of the WeChat ID as QQ ac-
count ID by our speculation, and as expected a single match
ﬁnally returns. We then collect additional proﬁle ﬁelds ex-
cept those from WeChat, from which we know that this QQ
account belongs to a young man from Shannxi, China, born
on November 9th 1990, and currently stays in Beijing, Chi-
na. In addition, we also ﬁnd his personal home page address.
However, until now we are not sure the owner of this QQ ac-
count is exactly the one has WeChat ID of “t106322XXXX”.
We then go one step further - visiting his personal home
page, where a pre-deﬁned question asking for the answer of
“real name” shows up for access control. By inputting the
display name of this WeChat account, we successfully log in!
Until now, we can safely conclude that the aforementioned
QQ account and WeChat account are indeed belong to the
Table 3: Pro(cid:12)le Fields Seized in Each Penetration
Step
same person. Finally, the home page reveals more informa-
tion about the young man as shown in Table 3 which also
illustrates incremental proﬁle ﬁelds we collect along each
step.
We can also infer from the pre-deﬁned access control ques-
tion that the home page is supposed to be visited by the
friends who really know this young man. However, we, as
strangers, have successfully obtained his personal informa-
tion, even private secretes.
We argue that for attackers who intend to crack someone,
manual work should be a price worth paying. As it can be
seen that vertical penetration can provide a wealth of infor-
mation which is crucial for earning trust when camouﬂaging,
boosting the implementation of online fraud.
5. COUNTERMEASURE
By abusing Address Book Matching, we have successful-
ly gathered users’ phone numbers and corresponding user
accounts in large scale, however, attackers will be no excep-
tion. It seems like throwing away the apple because of the
core to disable this promising function. Therefore, in this
section, we propose several feasible alternatives for develop-
ers to avoid this issue by tackling the key factor - the es-
tablishment of connection between real phone numbers and
virtual user accounts in ﬂawed messenger applications: 1)
Make phone numbers be queried with a one-at-a-time con-
straint, which meets users’ needs and meanwhile removes the
chance for attackers to launch large scale attacks. 2) Only re-
turn the display names of application accounts, rather than
detailed proﬁles nor corresponding phone numbers. This
339could be applied to applications with real-name system in
which users can identify their real world friends by the of-
ﬁcial names. 3) Return the phone numbers and the names
which should be exactly identical to the ones stored in the
address book. No account information should be accessed,
making sure no virtual and real identity connections are ac-
quired. 4) Recommend a user U those who also have U in
their address books. This is the way particularly suitable
for phone number based relationship management which is
generally bilateral.
6. RELATED WORK
Privacy Analysis of Applications. Privacy issues of
applications are widely studied. W. Enck et al.
[8] imple-
ments TanitDroid, a dynamic taint analysis tool, that mod-
iﬁes Android’s Dalvik VM and determines the violation of
privacy when there is tainted sensitive data ﬂowing out of
the phone. PiOS [7] is another privacy leakage analyzing tool
performing static taint analysis on iOS application binaries.
In terms of preventing privacy leakage, works such as Mock-
Droid [4] and TISSA [11] allow users to give resource access
permission to an application, whereas the system reports
empty or unavailable when application requests access. Dif-
ferently, we leverage existing Address Book Matching func-
tion to gather private user proﬁles without considering the
information ﬂow internally.
Automated User Pro(cid:12)ling. Leyla Bilge et al.
[5]
achieves automated identity theft via proﬁling users on SNS
(Social Networking Services) by employing friendship rela-
tion. M. Balduzzi et al. [3] abuses registered e-mail address
querying which is designed for users to search friends on
SNS. They collected a large number of users’ personal in-
formation by crawling and connecting their proﬁles. In our
paper, we try to get user information from applications and
the techniques are quite diﬀerent from crawling webpages.
Problems with Misusing Phone Numbers in Com-
munication Applications. Sebastian Schrittwieser et al.
[10] analyze several popular message and VoIP applications,
ﬁnding that most such applications treat users’ phone num-
bers as their account identiﬁers. They show some security
ﬂaws in terms of authentication mechanisms, such as ac-
count hijack or ID spoof. Diﬀering from their work, our ex-
periments show that contact matching technology, adopted
by many messenger applications today, has exhibited severe
privacy leakage problem because phone numbers are used as
external identiﬁers of user accounts which can be exploited
by attackers to seize other users’ accounts.
7. CONCLUSION
We exploit Address Book Matching, a novel feature of s-
martphone messenger applications, to collect user proﬁles.
To our best knowledge, this work is the ﬁrst to collect user
proﬁles via smartphone applications. The consistency and
authenticity of collected user proﬁles are further analyzed.
Results show that smartphone users prone to leave truthful
personal information in mobile messenger applications, how-
ever, for diﬀerent applications, users’ conﬁdence may vary
due to diﬀerent registration rules and promotion strategies.
Finally, we analyze main factors that make this abusing pos-
sible and provide countermeasures for application develop-
ers. Developers should be cautious and do their best to pre-
vent the exposure of the mapping information when users’
phone numbers are linked with their application accounts.
8. ACKNOWLEDGMENTS
This work was supported by National Program on Key Ba-
sic Research Project (Grant No. 2012CB315804), National
Natural Science Foundation of China (Grant No. 61073179
and No. 91118006), National Science and Technology Major
Project (Grant No. 2011ZX03002-005-02) and Beijing Mu-
nicipal Natural Science Foundation (Grant No. 4122086).
9. REFERENCES
[1] Mitalk messenger. http://www.miliao.com/.
[2] Wechat. http://weixin.qq.com.
[3] M. Balduzzi, C. Platzer, T. Holz, E. Kirda,
D. Balzarotti, and C. Kruegel. Abusing social
networks for automated user proﬁling. In S. Jha,
R. Sommer, and C. Kreibich, editors, Recent Advances
in Intrusion Detection, volume 6307 of Lecture Notes
in Computer Science, pages 422–441. 2010.
[4] A. R. Beresford, A. Rice, N. Skehin, and R. Sohan.
Mockdroid: trading privacy for application
functionality on smartphones. In Proceedings of the
12th Workshop on Mobile Computing Systems and
Applications, HotMobile ’11, pages 49–54, New York,
NY, USA, 2011.
[5] L. Bilge, T. Strufe, D. Balzarotti, and E. Kirda. All
your contacts are belong to us: automated identity
theft attacks on social networks. In Proceedings of the
18th international conference on World wide web,
WWW ’09, pages 551–560, New York, NY, USA, 2009.
[6] A. Braunstein, L. Granka, and J. Staddon. Indirect
content privacy surveys: measuring privacy without
asking about it. In Proceedings of the Seventh
Symposium on Usable Privacy and Security, SOUPS
’11, pages 15:1–15:14, New York, NY, USA, 2011.
[7] M. Egele, C. Kruegel, E. Kirda, and G. Vigna. PiOS:
Detecting privacy leaks in iOS applications. In
Proceedings of the 18th Annual Network & Distributed
System Security Symposium (NDSS), Feb. 2011.
[8] W. Enck, P. Gilbert, B.-G. Chun, L. P. Cox, J. Jung,
P. McDaniel, and A. N. Sheth. Taintdroid: an
information-ﬂow tracking system for realtime privacy
monitoring on smartphones. In Proceedings of the 9th
USENIX conference on Operating systems design and
implementation, OSDI’10, pages 1–6, Berkeley, CA,
USA, 2010.
[9] M. Jakobsson, N. Johnson, and P. Finn. Why and how
to perform fraud experiments. IEEE Security and
Privacy, 6(2):66–68, Mar. 2008.
[10] S. Schrittwieser, P. Fruehwirt, P. Kieseberg,
M. Leithner, M. Mulazzani, M. Huber, and E. Weippl.
Guess who is texting you? evaluating the security of
smartphone messaging applications. In Network and
Distributed System Security Symposium (NDSS 2012),
2012.
[11] Y. Zhou, X. Zhang, X. Jiang, and V. W. Freeh.
Taming information-stealing smartphone applications
(on android). In Proceedings of the 4th international
conference on Trust and trustworthy computing,
TRUST’11, pages 93–107, Berlin, Heidelberg, 2011.
340