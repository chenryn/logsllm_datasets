anew. Negative caching times are typically much shorter than the
TTL of the root DNSKEY RRset (currently 48 hours).
Clients relying on resolvers with an incorrectly configured trust
anchor may receive responses with the SERVFAIL error code be-
cause the resolver failed to perform DNSSEC validation. ICANN’s
KSK rollover design team expected the number of resolvers that
could not update their trust anchor to be low [2]. This degree of
confidence was based on the RFC 5011 mechanism implemented
by most resolvers and that we describe in the next section. In Sec-
tion 4.2, we measure the actual impact of the rollover on resolvers
and clients.
Response Size Changes. Due to the KSK/ZSK split, the size of most
responses remains the same during the KSK rollover. Only the size
of a DNSKEY response changes. Fig. 3 illustrates the sizes of various
Figure 3: DNSKEY response sizes during the rollover.
DNSKEY responses that occur throughout the rollover process, vary-
ing from 864 to 1,425 octets. The sizes shown in the figure include
the question and standard EDNS0 data. Some root servers have
deployed DNS cookies, which adds another 28 octets to the sizes
shown. These response sizes can exceed the Maximum Transmis-
sion Unit (MTU) of some networks, which can cause fragmentation
of UDP packets. Firewalls and other middle-boxes sometimes block
fragmented packets [11, 12], which can hinder resolvers when try-
ing to receive the DNSKEY record set and thus make it impossible
for them to validate signatures. The measurements carried out by
ICANN and the community leading up to the rollover indicated up
to 6% of resolvers could be affected by this problem. These serve less
than 1% of users and most do not perform DNSSEC validation [2].
Root servers may also receive an increased number of ICMP pack-
ets signaling the packet size exceeds the network’s MTU. Clients
relying on these resolvers could experience an increased response
time or receive a DNS SERVFAIL response. We study the impact of
increased response sizes during the revocation in Section 4.3, when
the highest packet size during the rollover process occured.
2.2.2 Updating Trust Anchors. DNSSEC allows validators to auto-
matically update their trust anchors through an in-band mechanism
in the DNS, known as RFC 5011 [13], which works as follows. At
the start of a rollover, the new key (KSK-2017, introduced at I) is
added to the DNSKEY RRset, but the RRset is only signed with the
then current trust anchor (KSK-2010). This signals to resolvers that
support RFC 5011 that they should start the process of accepting the
newly introduced key as a trust anchor. Acceptance is not effective
immediately; instead, a hold-down timer starts, lasting 30 days. Only
if the resolver has seen the new key consistently throughout the
hold-down period will it accept the new key. This prevents mali-
cious actors who have gained access to a trust anchor from instantly
injecting a new trust anchor. Once the new trust anchor comes into
Phase A (27 Oct ’16)KSK-2017 is generatedPhase B (2 Feb ’17)KSK-2017 replicatedto second HSM andpublished by IANAPhase C (27 Apr ’17)First signed DNSKEYset including KSK-2017Phase D (11 Jul ’17)KSK-2017 publishedin root zone, resolversstart RFC 5011 processPhase D (27 Sep ’17)ICANN haltsrollover processPhase D (18 Sep ’18)ICANN resumesrollover processRFC 5011 hold-downendsPhase E (11 Oct ’18)Moment of rolloverRoot DNSKEY set nowsigned with KSK-2017Phase E (13 Oct ’18)TTL of RRSIG on root DNSKEY set withKSK-2010 expiresDuring the rolloverSection 4.2Phase F (11 Jan ’19)Revocation of KSK-2010published in root zonePhase F (22 Mar ’19)KSK-2010 removed fromroot zone DNSKEY setPhase G (16 May ’19)KSK-2010 deletedfrom first HSMRFC 5011 hold-downendsBefore the rolloverSection 4.1After the rolloverSection 4.3IIIIIIIVVVIPhase H (14 Aug ’19)KSK-2010 deletedfrom second HSM86411391 KSK, 1 ZSK1 KSK, 2 ZSK2 KSK, 1 ZSK2 KSK, 2 ZSK11391414KSK RevocationKSKRevoked RRSIGZSKRevoked KSKRRSIGKSKRRSIGZSKKSKRRSIGZSKZSKKSKRRSIGZSKKSKKSKRRSIGZSKKSKZSK1425IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Müller et al.
effect, the old one may be revoked. In RFC 5011 this is achieved by
publishing a DNSKEY RRset in which the old key is marked with a
revocation flag (at V). Again, after a 30-day hold-down the trust
anchor is then removed by resolvers. Most resolver software (e.g.
BIND, Unbound and Knot) supports RFC 5011 and among popular
implementations, only PowerDNS lacks support. The widespread
support of RFC 5011 gave the Rollover Design Team confidence
that most resolvers would pick up the new key on time [2].
This KSK rollover was the first real test of RFC 5011. Since the
publication of RFC 5011 in 2007, new technologies have been intro-
duced that were not considered back then. This includes widespread
use of virtual machines and containers, configuration management
tools such as Puppet and Ansible, and DNS resolvers running on
inexpensive, and hard-to-update home and small office routers.
Where RFC 5011 specifies an in-band approach, an out-of-band
approach is discussed in RFC 7958 [14]. In this approach, resolvers
and other applications can retrieve keys and/or hashes directly from
the website of IANA as an XML document. Applications can use
various approaches to validate correctness of this information, e.g.,
trusting protections provided by TLS or a digital (PGP) signature
file, published separately. The Unbound resolver software uses this
mechanism in situations when updates via RFC 5011 fail [15].
With both mechanisms, it is not possible for third parties to
determine which resolvers have configured KSK-2017. To address
this, new resolver software supports protocols that try to provide
this insight. We use these protocols to measure the deployment of
KSK-2017 in Sections 4.1.1 and 4.3.1 and discuss their use in Sec-
tion 6.
3 DATASETS AND METHODOLOGY
We use a broad set of passive and active measurements at different
vantage points in the DNS hierarchy to cover the most critical
phases of the rollover. We discuss these datasets and how we use
them to analyse the rollover below. We also make the processed data
sets and the accompanying scripts for each figure available [16].
3.1 Passive Measurements
The DNS root system has 13 root server identities, each of which is
run by one operator [17]. At various stages of the rollover, we use
passive datasets from select root servers or aggregate data for all
of the root servers from a public repository. More specifically, we
use the following datasets:
Root Queries. The Domain Name System Operations Analysis
and Research Center (DNS-OARC) collects DNS traces from var-
ious name servers including the root system. This includes their
well-known annual Day-in-the-Life (DITL) datasets [18]. Given the
significance of the KSK rollover, DNS-OARC co-ordinated a DITL
data collection from root operators spanning an 82-hour window
around the dates of the actual rollover. We utilized this data, avail-
able to researchers and DNS-OARC members, to provide a holistic
view of root query traffic during the rollover.
Our analysis, however, extends to well before and after the
rollover. To support this, we make use of query datasets collected
at three root servers, A, B and J. This non-public longitudinal data,
spanning 2017–2019, was made available by Verisign (A/J Root)
and the University of Southern California’s Information Sciences
Query String
_ta-4a5c
_ta-4a5c-4f66
_ta-3039
_ta-4a5c-4f66-8235 KSK-2010 & -2017 and a non-IANA trust anchor
Table 1: Root zone RFC 8145 trust anchor signals.
Which trust anchor(s)?
Only KSK-2010
Both KSK-2010 and KSK-2017
Has a non-IANA trust anchor
Institute (B Root). These datasets are used throughout the analy-
sis in Section 4 whenever we require detailed information about
specific resolvers that exhibit anomalous behavior. Note, however,
that other root servers might show different query patterns [19].
RSSAC Measurements. The ICANN Root Server System Advisory
Committee (RSSAC) [20] advises ICANN about operational matters
relating to the DNS root system. RSSAC defined a set of metrics that
all root server operators are expected to publish on a daily basis [21].
The resulting data is published as YAML files, accessible through
a public GitHub repository [22], with data going back to 2013. In
this paper, we make use of the RSSAC002 data on traffic sizes to the
root, as a proxy for DNSKEY queries in Section 4.3.2 and to estimate
the impact of the increased DNSKEY RRset size in Section 4.3.3. The
data is available for all root servers, except G Root.
Trust Anchor Signals. RFC 8145 [3] describes a protocol allowing
DNSSEC validators to signal the keys in their trust anchor set.
RFC 8145 signals are 16-bit “key tags,” encoded as hexadecimal
values in DNS queries. KSK-2010 has key tag 19036, or 4a5c in
hexadecimal. KSK-2017 has keytag 20326, or 4f66 in hexadecimal.
A validator that implements RFC 8145 periodically sends a query
whose first label starts with the string “_ta-” followed by a hyphen-
separated list of hexadecimal key tag values. It then appends the
name of the zone to which the keys belong.2 Table 1 shows root
zone trust anchor signal strings and their meanings.
In this paper we use two RFC 8145 data sets: (i) all trust anchor
signals received by A, B and J Root from up to 100,000 distinct IP
addresses daily, and (ii) trust anchor signals provided to ICANN
by most of the root server operators from up to 200,000 distinct
IP addresses daily; ICANN provided us with a subset of this data
covering February 1st to March 29th, 2018.
3.2 Active Measurements
Resolver State. By using only data collected at the root, we miss
the perspective of the client. To add this perspective, we rely on
public measurements [23], that make use of the RIPE Atlas mea-
surement network [24]. An Atlas probe is a device from which
we can actively send DNS queries through its recursive resolvers,
pre-configured by the probe owner or learned through DHCP. This
allows us to observe the transition from KSK-2010 to KSK-2017
(event IV) and the revocation of KSK-2010 (event V) from the per-
spective of resolvers and measure whether they continue to vali-
date DNSSEC signatures successfully. The public measurements we
leverage consist of two queries sent every hour and check whether
resolvers validate correctly. The first query asks for the A record
of a domain with a valid signature, the second for a domain with
2In case of the root zone there is nothing to append. An example non-root zone trust
anchor signal with appended zone is _ta-4b61.dlv.isc.org.
Roll, Roll, Roll your Root
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
DNS response code
Valid Signature Bogus Signature
State
NOERROR
NOERROR
SERVFAIL
NOERROR
SERVFAIL
other
insecure
secure
bogus
Table 2: Combination of response codes indicating the state
of the measured resolver.
a bogus signature. The response codes of both measurements can
be combined (see Table 2) to establish if a resolver (i) does not vali-
date DNSSEC signatures (state insecure), (ii) validates signatures
correctly (state secure) or (iii) fails to validate (state bogus). Secure
resolvers changing state to insecure or bogus at any stage of the
rollover may be indicative of that resolver experiencing problems.
In addition to the public measurements, we schedule our own mea-
surement which queries each resolver for the DNSKEY RRset of the
root, to measure uptake of KSK-2017 during the rollover.
Using 10,004 RIPE Atlas probes (all probes available at the time
of our measurement) and their recursive resolvers gives 18,277 van-
tage points (VPs), located in 3,647 autonomous systems (ASs). To
find how many resolvers these VPs cover, we send hourly queries
for a domain under our control, using the probe ID and a ran-
dom string as a sub-label to avoid caching. Our authoritative name
server responds with the IP address of the resolver that served the
query. Using this method, we observe 35,719 upstream IPs located in
3,141 ASs over the period in which we conducted the measurement.
Root Sentinel. As discussed, RFC 8145 allows resolvers to signal
which trust anchors it uses to upstream authoritative name servers.
What was lacking, however, is a way for resolver users and other
third parties to actively ask resolvers which trust anchors they
use. This led to the introduction of RFC 8509, the so-called “Root
Sentinel” [25]. Given that the specification was only finalized in
December 2018, it could not reliably be used to monitor the root KSK
rollover (although we do observe early implementations). We do,
however, include Root Sentinel measurements to study adoption
of this new form of telemetry and to observe the revocation of
KSK-2010 in 2019 from the perspective of resolvers.
The Root Sentinel is an active measurement mechanism. A client
can send two special queries to resolvers to ask what trust anchors
they currently have to validate DNSSEC responses. The first query
type allows a client to ask if a DNSKEY with a certain key tag is a trust
anchor, the second type allows a client to ask the inverse (whether
a specific DNSKEY is not a trust anchor). The resolver returns a valid
response to the first type if the specified key is a trust anchor, and a
SERVFAIL error if it is not. For the second query type, the opposite
behavior applies. Table 3 shows what the queries look like. Note,
while RFC 8145 uses hexadecimally encoded key tags, RFC 8509
uses decimal key tags. Thus, to query for the presence of KSK-2010
and KSK-2017, ... -is-ta-19036 and ... -is-ta-20326 are used.
Our goal is to examine (i) how many resolvers support Root
Sentinel queries, and for those that do, (ii) if they correctly have
the new key (KSK-2017) and remove the old key (KSK-2010) when
it is revoked (event V). To do so, we set up a domain under our
control. The name server for this domain is configured to return
Query String
Is  a trust anchor?
Yes
No
root-key-sentinel-is-ta-
root-key-sentinel-not-ta-
Valid response
SERVFAIL
SERVFAIL
Valid response
Table 3: RFC 8509 Root Sentinel queries
a DNSSEC-signed A record for Root Sentinel queries. We then use
RIPE Atlas to issue four Root Sentinel queries (i.e., each of the
two Root Sentinel queries for the old and new key) under our test
domain. For this measurement, we extended our coverage of the
global resolver population by including additional measurements
using the Luminati proxy network [26]. This gives us more visibility
in residential networks. Luminati is a paid HTTP/S proxy service
enabling clients to route traffic via the Hola Unblocker Network.
Luminati currently provides over 187 million potential exit nodes.