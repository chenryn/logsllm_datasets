Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
(+)andthemodeledsystem(solidline).Resultsshowthatthemodelisabletorenderthebehavioroftherealsystem.5.3ControlevaluationThissectionpresentstheresultsoftheevaluationoftheim-plementedfeedbackcontrollerspresentedinSection4whenappliedtothePostgreSQLdatabaseserverthathoststheTPC-Cdatabase.TheresultsoftheexperimentsconductedwiththeAM-Cavailability-maximizingcontrollerareﬁrstpresentedinSection5.3.1,andtheresultsofthePM-Cperformance-maximizingcontrollerarethendescribedinSection5.3.2.5.3.1AM-Cavailability-maximizingcontrolInthissection,weevaluatetheproposedAM-Cavailability-maximizingfeedbackcontrollerpresentedinSection4.1.Here,weconsideraperformanceconstraintlimitingthemax-imumaverageclientrequestlatencyto8s.TheroleofAM-Cisthustoguarantythatperformanceconstraintwhilemax-imizingserviceavailability,throughonlinefeedbackcontroloftheserverMPL.Weusetwoscenariitoevaluatethiscon-troller,eachoneillustratingavariationofoneofthetwoex-ogeneousinputvariablesofthesystem,i.e.theﬁrstscenarioconsidersachangingworkloadmix,andthesecondscenariohandlesavaryingworkloadamountN.Figure6describestheﬁrstscenariowheretheworkloadmixvariesfromM1toM2andthenbacktoM1(c.f.Fig-ure6(a)),whiletheworkloadamountNisof80clients.TheworkloadmixM1consistsofread-writerequestswhiletheworkloadmixM2generatesread-onlyrequests.Figures6(b),6(c)and6(d)presentthevariationovertimeofrespectivelytheserverMPL,theaverageclientrequestlatencyandtheclientrequestabandonrate,comparingthenon-controlledbasesystemwithaclosedloop-basedcontrolledsystem.No-ticethatthesuddenchangeofMPLafterthe20thand40thminutescorrespondtoworkloadmixchanges,whichalsohasanimpactonthelatencyandabandonrate.ResultsdemonstratethattheAM-CcontrollerisabletodynamicallyadjustMPLinordertoguaranteethelatencyperformanceconstraintwhilekeepingtheserviceavailabilitytoitsmaximum,withanabandonrateminimizedto0%withM1andto9%inaveragewithM2.Whereas,inthebasesystemwhereconcurrencyontheserverisnotcontrolledandpotentiallyunlimited,theQoSisnotguaranteedandperfor-mancegetsworsewithalatencyoverheadofupto30%.Figure7presentsanotherdynamicsofthesystem,thatisthevariationoftheserverworkloadamountovertime(c.f.Figure7(a))whentheworkloadmixremainsatM1.Figures7(b),7(c)and7(d)presentthevariationovertimeofrespectivelytheserverMPL,theaverageclientrequestlatencyandtheclientrequestabandonrate,comparingthenon-controlledbasesystemwiththecontrolledsystem.No-ticethat,duetoTPC-Cclientthinktime,thenumberofac-tiveclientsatanygiventimemaybedifferentfrom(lower(a)Workloadmix(b)MPLofcontrolledsystem(c)Latency(d)AbandonrateFigure6.Systembehavioruponworkloadmixvariation–AM-C-basedcontrolledsys-temvs.non-controlledsystem978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
396
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
(a)Workloadamount(b)MPLofcontrolledsystem(c)Latency(d)Abandonrate(e)Admittedconcurrentclients(Ne)vs.MPLFigure7.Systembehavioruponworkloadamountvariation–AM-C-basedcontrolledsystemvs.non-controlledsystemthan)theactualloadgeneratedbyTPC-Cclientemulatoratthattime.ResultsshowthatthecontrolledMPLisabletoadjustitsvaluetotheoptimalvaluesothattheperformanceconstraintisguaranteed.Whereasinthecaseofthenon-controlledsystem,thelatencygrowsupto14.4s,withanoverheadofupto80%comparedtothecontrolledsystem.Inthecontrolledsystem,theabandonrateismainainedbe-low5%withupto75clients(i.e.duringtheﬁrsthalfoftheexperiment).Then,theabandonrateincreaseswiththein-creaseofconcurrentclientsinthesystem,toattainitshighestvaluewhenthenumberofclientsismaximum,inordertokeeplatencybelowthetargetmaximumlatency.Noticethatattheendoftheexperiment(betweenthe18thand25thmin-utes),itseemsjustiﬁabletohaveahighabandonratesincela-tencyattainsitsmaximumauthorizedvalue(c.f.Figure7(b))andclientrequestrejectionisnecessaryatthattimetoguar-antythelatencyconstraint.However,duringtheﬁrstpartoftheexperimentwherelatencyislowerthantheauthorizedmaximumlatency,havinganabandonratewhichishigherthat0%isquestionable.ThisisexplainedinFigure7(e)bythestochasticnatureoftheworkloadwhereMPLisal-wayshigherthantheaverageNebutwherepunctually,theremaybeaclientamountthatishigherthanMPLandthus,anon-nullabandonrateisobservedatthattime(asdepictedbycirclesinFigure7(e)).Tofacethisissue,animprovedAM-Cavailability-maximizingcontrollawconsistsintak-ingintoaccountsystemunderloadsituationsanthus,mini-mizeabanonratefurther(i.e.increaseMPL)aslongasthelatencyconstraintisguaranteed.Duetospacelimitation,wearenotabletopresentresultsforthisscenario.5.3.2PM-Cperformance-maximizingcontrolInthissection,weevaluatetheproposedPM-Cperformance-maximizingfeedbackcontrollerpresentedinSection4.2.Here,weconsideranavailabilityconstraintlimitingthemaximumclientrequestabandonrateto10%.TheroleofPM-Cisthustoguarantythisavailabilityconstraintwhilemaximizingserviceperformance,throughonlinefeedbackcontroloftheserverMPL.Figure8presentsthevariationofsystembehavioranddy-namiccontrolwhentheexogeneousinputvariableofwork-loadmixMchanges1.InFigure8(a),theworkloadmixvariesfromM1toM2andthenbacktoM1whenthework-loadamountNisof80clients.TheworkloadmixM1con-sistsofread-writerequestswhiletheworkloadmixM2gen-eratesread-onlyrequests.Figures8(b),8(c)and8(d)presentthevariationovertimeofrespectivelytheserverMPL,theclientrequestabandonrateandtheaverageclientrequestla-tency,comparingthenon-controlledbasesystemwithacon-trolledsystem.Hereagain,wenoticeasuddenchangeintheMPLwhentheworkloadmixsuddenlychanges,withanim-pactonthelatencyandabandonrate.1Duetospacelimitation,resultswithavaryingamoutofworkloadNarenotpresented.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
397
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
ResultsdemonstratethatthePM-CcontrollerisabletodynamicallyadjustMPLinordertoguarantytheabandonrateconstraintwhilekeepingserviceperformancetoitsmax-imum,withanaveragelatencyminimizedto4swithM1andto8swithM2.Comparedtoanon-controlledsystem,thisimprovessystemlatencybyupto20%.6RelatedWorkSystemconﬁgurationisacrucialissuefortheperformanceandavailabilityofserversystems[18,19].MuchrelatedworkhasbeendoneintheareaofsystemQoSmanagement,investigatingtechniquessuchasadmissioncontrol,servicedifferentiation,servicedegradationandrequestscheduling.Duetospacelimitation,webrieﬂyoverviewtheworkrelatedtoadmissioncontrolforserversystemmanagement.Whiletheimprovementofserverperformanceandavailabilityisusuallyachievedbysystemadministratorsusingad-hoctun-ing[6,21],newapproachestendtoappeartoeasethemanage-mentofsuchsystems.Menasc´eet.al.proposeaheuristicforthemanagementoftheQoSofserversthroughthedetermina-tionofthemulti-programminglevel(MPL)ofserversusingthehill-climbingoptimizationtechnique[20].Althroughper-formingwellinavarietyofapplications,hill-climbingdoesnotguaranteeoptimality.In[9],asimilartechniqueisap-plied;howevertheMPLisdeterminedofﬂineandthus,doesnotadapttochangingworkloads.OthersolutionstoMPLidentiﬁcationwereproposedspeciﬁcallytosomeservertech-nologies,suchastransactionalservers[26].Otherapproachesaimatmodelingthesysteminordertocharacterizeitscapac-ity.In[10],asimulation-basedstudyisconductedandananalyticmodelisproposedtoadjustserverMPLaccordingtochangingworkloads.However,thismodelisrestrictedtoperformancefunctionswithaparabolashapeandthus,doesnotapplytocriteriasuchasrequestlatencyandabandonratethatusuallyunderlyservicelevelobjectives(SLOs)asperceivedbyclients.Otherworksaimingatapplyingcon-troltheorytoserversystemsappearedinthelastdecade.Aﬁrstapproachconsistsinapplyingwell-knownlinearcon-troltheoryonserversmodeledasSISO(single-inputsingle-output)orMIMO(multiple-inputsmultiple-outputs)black-boxes[25,7].Nevertheless,duetotheintrinsicnon-linearbehaviorofthesesystems,linearcontroltheorydoesnotpro-videmuchsuccess.Otherapproachesarebasedonnon-linearmodelsderivedfromqueuingtheory[28,30]withatheoret-icalproposalin[15,16,24].Theresultingmodelsinterest-inglypredicttheperformanceofthesystem,butthisisob-tainedattheexpenseofahardcalibrationofmodelparame-tersinordertoprovideaccurateresults.TheproposedAM/PM-Csystemdiffersfromtheprevi-ousworksinmanyrespects.Itappliescontroltheorybasedonﬂuidapproximation,whichresultsinasimplernon-linearmodelwithveryfewexternalparameters.Fluidapproxima-tionissuccessfullyusedtomodelandcontrolvarioussystemsinotherareassuchascarﬂowcontrolandpopulationmodels.(a)Workloadmix(b)MPLofcontrolledsystem(c)Abandonrate(d)LatencyFigure8.Systembehavioruponworkloadmixvariation–PM-C-basedcontrolledsys-temvs.non-controlledsystem978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
398
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:35:50 UTC from IEEE Xplore.  Restrictions apply. 
Inthepresentwork,weapplyittomodelandcontrolserversystems,andshowhowthisallowstoprovidecombinedguar-anteesonserviceperformanceandserviceavailability.7ConclusionThispaperpresentsthedesign,implementationandevalu-ationofanonlinearcontinuous-timemodelbasedontheﬂuidﬂowcontroltheory,uponwhichadmissioncontrolofserversisderivedforoptimalconﬁgurationofservers.Twovari-antsofcontrolareproposedfortwodifferentQoSobjectives.AM-Cisanavailability-maximizingoptimalserveradmis-sioncontrolthatachievesthehighestserviceavailabilitygivenaﬁxedperformanceconstraint.PM-Cisaperformance-maximizingoptimalserveradmissioncontrolthatmeetsade-siredavailabilitytargetwiththehighestperformance.Ourexperimentsshowthattheproposedtechniquesimproveper-formancebyupto30%whileguaranteeingavailabilitycon-straints.WhilethispaperconcentratesonQoSmetricssuchasclientrequestlatencyandabandonrate,webelievethatboththeproposedmodelingandcontroltechniquesmayapplytoothermetrics,suchasserverthroughput.Althoughthepro-posedmodelingandadmissioncontrollawswereappliedtoadatabaseserver,webelievethattheycouldbeeasilyappliedtoanyseversystemwhereadmissioncontrolholds(e.g.webservers,applicationservers,etc.).Furthermore,weareinter-estedinhowthesemodelingandcontroltechniquescanbeappliedtodistributedsystems.References[1]T.Abdelzaher,Y.Lu,R.Zhang,andD.Henriksson.Practi-calapplicationofcontroltheorytoWebservices.AmericanControlConference,June2004.[2]Amazon.comInc,2007.http://www.amazon.com/.[3]AppleInc.QuickTimeStreamingServer,2007.http://www.apple.com/quicktime/streamingserver/.[4]M.ArlittandT.Jin.WorkloadCharacterizationofthe1998WorldCupWebSite.TechnicalReportHPL-1999-35(R.1),HPLaboratoriesPaloAlto,Sept.1999.[5]M.ArlittandC.L.Williamson.Webserverworkloadchar-acterization:thesearchforinvariants.SIGMETRICSPer-form.Eval.Rev.,24(1):126–137,1996.[6]M.Brown.OptimizingApacheServerPerformance,Feb.2008.http://www.serverwatch.com/tutorials/article.php/3436911.[7]Y.Diao,N.Gandhi,J.Hellerstein,S.Parekh,andD.Tilbury.UsingMIMOfeedbackcontroltoenforcepoliciesforinter-relatedmetricswithapplicationtotheApacheWebserver.NetworkOperationsandManagementSymposium,2002.[8]J.A.Dilley.WebServerWorkloadCharacterization.Tech-nicalReportHPL-96-160,HPLaboratories,Dec.1996.[9]S.Elnikety,E.Nahum,J.Tracey,andW.Zwaenepoel.AMethodforTransparentAdmissionControlandRequestSchedulinginE-CommerceWebSites.In13thinternationalconferenceonWorldWideWeb,NewYork,NY,May2004.[10]H.-U.HeissandR.Wagner.AdaptiveLoadControlinTrans-actionProcessingSystems.In17thInternationalConferenceonVeryLargeDataBases,SanFrancisco,CA,1991.[11]J.Hyman,A.A.Lazar,andG.Paciﬁci.JointSchedulingandAdmissionControlforATS-basedSwitchingNodes.InACMSIGCOMM),Baltimore,MA,Aug.1992.[12]IronMountain.TheBusinessCaseforDisasterRecov-eryPlanning:CalculatingtheCostofDowntime,2001.http://www.ironmountain.com/dataprotection/resources/CostOfDowntimeIrnMtn.pdf.[13]R.E.Kalman.ANewApproachtoLinearFilteringandPredictionProblems.TransactionsoftheASME–JournalofBasicEngineering,82(SeriesD):35–45,1960.[14]H.Khalil.NonlinearSystems.PrenticeHall,2002.[15]M.Kihl,A.Robertsson,andB.Wittenmark.Analysisofadmissioncontrolmechanismsusingnon-linearcontrolthe-ory.8thIEEEInternationalSymposiumonComputersandCommunication,pages1306–1311vol.2,July2003.[16]M.Kihl,A.Robertsson,andB.Wittenmark.Performancemodellingandcontrolofserversystemsusingnon-linearcontroltheory.In18thInternationalTeletrafﬁcCongress,Berlin,Germany,Sept.2003.[17]J.D.C.Little.AproofforthequeueingformulaL=λW.OperationResearch,9:383–387,1961.[18]C.Loosley,F.Douglas,andA.Mimo.High-PerformanceClient/Server.JohnWiley&Sons,Nov.1997.[19]E.MarcusandH.Stern.BlueprintsforHighAvailability.Wiley,Sept.2003.[20]D.A.Menasc´e,D.Barbara,andR.Dodge.PreservingQoSofE-CommerceSitesThroughSelf-Tuning:APerformanceModelApproach.InACMConferenceonElectronicCom-merce,Tampa,FL,Oct.2001.[21]Microsoft.OptimizingDatabasePer-formance.http://msdn.microsoft.com/en-us/library/aa273605(SQL.80).aspx.[22]NorthAmericanSystemsInternationalInc.TheTrueCostofDowntime,2008.http://www.nasi.com/downtimecost.php.[23]PostgreSQL,2008.http://www.postgresql.org/.[24]A.Robertsson,B.Wittenmark,M.Kihl,andM.Andersson.Admissioncontrolforwebserversystems-designandex-perimentalevaluation.43rdIEEEConferenceonDecisionandControl,Dec.2004.[25]S.ParekhandN.GandhiandJ.HellersteinandD.TilburyandT.JayramandJ.Bigus.UsingControlTheorytoAchieveServiceLevelObjectivesInPerformanceManage-ment.Real-TimeSyst.,23(1-2):127–141,2002.[26]B.Schroeder,M.Harchol-Balter,A.Iyengar,E.Nahum,andA.Wierman.Howtodetermineagoodmulti-programminglevelforexternalscheduling.In22ndInternationalConfer-enceonDataEngineering,Atlanta,GA,Apr.2006.[27]Sendmail.org,2007.http://www.sendmail.org/.[28]D.TipperandM.Sundareshan.Numericalmethodsformodelingcomputernetworksundernonstationarycondi-tions.IEEEJournalonSelectedAreasinCommunications,8(9):1682–1695,Dec.1990.[29]TPC-C.Tpctransactionprocessingperformancecouncil,2008.http://www.tpc.org/tpcc/.[30]W.-P.Wang,D.Tipper,andS.Banerjee.Asimpleapprox-imationformodelingnonstationaryqueues.IEEEINFO-COM,Mar.1996.