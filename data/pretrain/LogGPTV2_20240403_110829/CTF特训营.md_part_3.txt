数
作
用
-h, -help
显示帮助文档
-u URL, --url=URL
对指定urdl进行扫描
-r REQUEST_FILE
REQUEST_FILE为包含HTTP请求的数据包文件，可以从Burp中导出
--data=DATA
指定POST数据
--dbs
查询数据库
--tables
查询表
 --columns
查询字段
-dump
转储数据
-DDB
指定数据库名
-T TBL
指定表名
-C COL
指定字段名
--users
查询数据库用户
--privileges
查询用户权限
-threads=NUM
设置线程数，可以根据自己电脑的性能和网络状态在NUM处指定数字，在Bool
盲注时可以提高速度
--user-agent=AGENT
自定义 User-Agent
-random-agent
随机选择User-Agent
--tamper=TAMPER
指定Tamper对Payload进行处理，可以指定多个Tamper，之间使用逗号分隔
Tamper通常用来绕过一些过滤或者WAF，此处将为大家列举一
些常见Tamper的功能（见表1-6）。这些Tamper脚本存放在Sqlmap目
录下的tamper目录中，大家可以通过这些Tamper的代码学习一些绕
过技巧（后面的章节也会介绍一些常见的绕过方法），或者是自己尝
试编写有针对性的Tamper。
表1-6常用Tamper及作用
Tamper文件名
作用
Tamper文件名
作用
greatest.py
用Greates函数替代大于号
base64cncode.py
川Base64 编码 Payload
cqualtolike.py
用ike普代等号
spacc2comment.py
使用注释符转换空格
charencode.py
用URL编码 Payload
unmagicquotes.py
宽字节绕过GPC
randomcase.py
随机大小写
apostrophemask.py
用urf8替代引号
---
## Page 27
CTF特训营：技术详解、解题方法与
1.2Sqlmap
27/1144
此外，Sqlmap还存在sqlmapapi.py，可以方便地通过API进行调
度。更多的Sqlmap指令可在官方文档中找到，文档地址为：https://
github.com/sqlmapproject/sqlmap/wiki
---
## Page 28
CTF特训营：技术详解、解题方法与
1.3浏览器与插件
28/1144
1.3浏览器与插件
由于比赛时可能会遇到兼容性方面的问题，并且题自有可能会对
浏览器做出限制，或者需要考察特定浏览器的漏洞，所以笔者建议大
家将lE、Firefox（并发者版本）及Chrome等主流浏览器各安装一
个。本节主要介绍Chrome的插件，Firefox中也会有类似的插件。笔
者不推荐用正来答题，不过还请读者根据自己的喜好自行选择
在Chrome中安装扩展可直接在地址栏中输入chrome://
extensions/并按回车键进入，也可以依次选择右上角的设置一更多工
具一扩展进入相同的界面。
这里推荐儿个在日常和CTF比赛中比较常用的Chrome浏览器插
件。
1.DeveloperTools
DeveloperTools是Chrome浏览器自带的开发者工具，也是最常
用到的功能，它集成Elements、Console、Sources、Network
Application等丰富的开发工具于一体，可以让Chrome对网页的元素
样式和脚本进行实时编辑、调试和监控。这里简单介绍一下常用面板
---
## Page 29
CTF特训营：技术详解、解题方法与
1.3浏览器与插件
29/1144
的功能。
Elements：查看网页源码经过浏览器渲染后的所有元素，可手
动修改元素的属性和样式，并在浏览器中得到实时的反馈。
Console：记录并显示开发者或浏览器输出的日志和调试信息
并可以作为与JS进行实时交互的命令行Shell
Sources：通常用于下断点调试JS。
Network：记录发起请求后服务器响应的各种资源信息（包括状
态码、资源类型、大小、耗时等），可以查看每个请求和响应的元信
息。
Application：记录网站加载的所有资源信息，包括存储数据
(LocalStorage、SessionStorage、IndexedDB、WebSQL、
Cookies）、缓存数据、字体、图片、脚本、样式表等。
Security：从技术层面判断当前网页的安全性，如，是否有可疑
代码、证书是否合法、通信链路是否安全等。注意，其并不能判断该
网站是否为钓鱼网站或是否含有欺诈信息！
在CTF比赛中，需要处理JS相关的题目时，可以在Console面板
---
## Page 30
CTF特训营：技术详解、解题方法与
1.3浏览器与插件
30/1144
中直接运行JS代码，而在xSS题目中，在Elements面板中可以方便地
定位元素的位置等。
2.Hasher
一款可以快速计算常见哈希算法（MD5/SHA1/HMAC/CRC等）、
常用加密算法（AES/DES/RC4等）、编码转换（Base64/ROT13/
HTML字符实体等）、网络地址转换、时间转换及进制转换等功能的
工具，与前面Burp中的Decoder模块类似。
3.ProxySwitchyOmega
这是Chrome的一款代理插件，可以在多个代理配置文件之间快
速切换。在前面的小节中我们说过，Burp切换代理时不是十分方便
这时候就可以将Burp与它结合，从而实现点击鼠标就能完成代理的切
换。此外，在遇到内网渗透相关的题目时，打通socket隧道后也可以
用它来让浏览器全局使用代理进行内网渗透。同时，它还可以配合
“梯子”以实现科学上网
4.EditThisCookie
EditThisCookie是一个Cookie管理器，它可以方便地添加、删
---
## Page 31
CTF特训营：技术详解、解题方法与
1.3浏览器与插件
31/1144
除、修改、查询和锁定站点的Cookies。这个插件可以配合xSS的题
自使用，例如，当我们获得管理员的Cookies后，可以方便地修改这
个站点的Cookies，从而以管理员的身份登录并进行后续获取flag的操
作。
5.User-AgentSwitcherforChrome
这款工具可以让我们方便地进行User-Agen的切换，这一点在某
些限制User-Agen的题自中可能会用到，比如模拟微信客户端UA进
行访问等。
6.Wappalyzer
这款插件可以方便地查看当前站点的服务器型号、版本、服务器
端语言等信息，可以帮我们进行一些初步的信息收集。不过，此处获
取到的信息仅可作为参考，因为部分比赛题目会使用障眼法来影响你
的判断，例如，Apache服务器返回了一个伪造的llIS头。
7.SelectorGadget和xPathHelper
这两个插件都是用来定位、提取和选择指定元素的XPath，通常
配合爬虫使用。
---
## Page 32
CTF特训营：技术详解、解题方法与
1.3浏览器与插件
32/1144
当然，Chrome中的插件还有很多，这里就不再一一举例说明
了。希望大家在CTF比赛或是实际的渗透测试中也能发掘出一些好用
的插件，并提高熟练度
---
## Page 33
CTF特训营：技术详解、解题方法与
1.4 Nmap
33/1144
1.4Nmap
说到Nmap，想必大家在入门之前都听说过。它的设计自标是快
速地扫描大型网络，当然，用它扫描单个主机也没有问题。它可以使
我们方便地发现网络上有哪些主机，这些主机可以提供什么服务（应
用程序名和版本），这些服务运行在什么操作系统（包括版本信息）
上。Nmap还可以探测到这些主机使用了件么类型的报文过滤器或防
火墙，以及其他一些很有用的功能。下面就来简单介绍一下Nmap的
基本命令和使用方法。Nmap的命令格式如下：
nmap[扫描类型选项{目标或目标集合]
我们先简单介绍下主机发现相关的参数选项，如表1-7所示。
接下来是扫描参数选项，如表1-8所示。
然后是扫描速度设定的参数选项，如表1-9所示。
最后是扫描端口的常见参数选项，如表1-10所示
表1-7Nmap常用的主机发现相关的参数
---
## Page 34
CTF特训营：技术详解、解题方法与
1.4 Nmap
34/1144
参数
作用
参数
作用
-sP
使用Ping扫描
-PE:-PP;-PM
使用ICMPPing types扫描
-PO
不使用Ping扫描
-PR
使用ARPPing扫描
-PS
使用TCP SYNPING扫描
n
禁止DNS反向解析
-PA
使用TCPSYNACK扫描
-R
反向解析域名
-PU
使用UDPPing扫描
表1-8Nmap常用的扫描参数
选项
作用
选项
作用
T
时序扫描
sW
TCP窗口扫描
-pl-F
端口扫描顺序
-SM
TCP maimon扫描
-sS
TCPSYN扫描（默认）
--scanflags
自定义TCP扫描
sT
TCP连接扫描
-s1
空闲扫描
-sU
UDP扫描
-s0
IP扫描
-sN;-sF;-sX
隐蔽扫描
-b
FTP Bounce扫捕
-SA
TCPACK扫描
表1-9
Nmap常用的扫描速度相关的参数
选项
作用
选项
作用
-T0;-T1
侵速扫描，躲避IDS与WAF等
-T4
快速扫
-T2
稍慢速扫描
-T5
极速扫
-T3
默认
表1-10
）Nmap常用的扫描端口相关的参数
选项
作用
选项
作用
-F
快速扫描端口（只扫描最常用的100个端口）
top-ports
开放率高的1000个端口的扫描（默认）
-
按照端口号从小到大的顺序进行扫描
P
只扫描特定端口，如：-p22，100-1024，
6666
一般来说，如果我们输入命令nmap192.168.1.1，实际上Nmap
使用的是SYN扫描192.168.1.1开放率最高的1000个端口。笔者在实
---
## Page 35
CTF特训营：技术详解、解题方法与
1.4 Nmap
35/1144
践中经常使用的扫描命令是
nmap-sS-sV-p-192.168.1.1
签
nmap -v -T4 -A 192.168.1.1/24
此外，Nmap扫描器还支持自定义扫描脚本（NSE），并提供了
大量的常见服务的相关脚本，如SQL注入检测脚本、SMB漏洞扫描脚
本、FTP爆破脚本等。
更加详细和全面的Nmap资料，大家可以在Nmap官网上获取
官方文档地址为：https://nmap.org/book/man.html。
---
## Page 36
CTF特训营：技术详解、解题方法与
第2章SQL注入攻击
36/1144
第2章SQL注入攻击
SQL注入在国内CTF比赛中的地位特别高，基本上是每次比赛的
必出题。有时候还不只一道题，一道题也不只有一个数据库，可能是
与SSRF、XSS等漏洞配合出题等，这时候就需要我们根据不同的环
境随机应变。在这里，我们主要介绍基于MySQL的注入。
在本章中，我们假设你已经有一定的SQL基础，熟悉常见的增
(insert）删（delete）改（update）查（select）语句，了解常见的查
询（比如联合查询、连接查询等），知道基本的数据库的权限控制
并了解PHP的基本语法和常见的参数传递方法（如GET、POST
等。
---
## Page 37
CTF特训营：技术详解、解题方法与
2.1什么是SQL注入
37/1144
2.1什么是SQL注入
首先简单介绍一下SQL注入的成因。开发人员在开发过程中，直
接将URL中的参数、HTTPBody中的Post参数或其他外来的用户输入
（如Cookies，UserAgent等）与SQL语句进行拼接，造成待执行的
SQL语句可控，从而使我们可以执行任意SQL语句。
了解了SQL注入的成因之后，我们再来简要介绍下常见SQL注入
的分类，具体如下。
1）可回显的注入
可以联合查询的注入。
报错注入。
通过注入进行DNS请求，从而达到可回显的自的。
2）不可回显的注入
Bool盲注。
时间盲注。
---
## Page 38
CTF特训营：技术详解、解题方法与，
2.1什么是SQL注入
38/1144
3）二次注入
通常作为一种业务逻辑较为复杂的题目出现，一般需要自己编写
脚本以实现自动化注入。
SQL注入在CTF比赛中十分常见，涉及各种数据库。一般的CTF
比赛中，出题人都会变相地增加一层WAF（比如，对关键字进行过
滤等），然后只留下一个思路的解题路径，这时候我们需要快速找到
并绕过这个点，然后得到flag。
---
## Page 39
CTF特训营：技术详解、解题方法与
2.2可以联合查询的SQL注入
39/1144
2.2可以联合查询的SQL注入
在可以联合查询的题目中，一般会将数据库查询的数据回显到页
面中，比如下面这个例子（测试样例代码时需要关闭GPC）：
.mysq_error().')
Snum=mysq_numrows(Sresult);
我们注意看上方SQL语句中的Sid变量，该变量会将GET获取到
的参数直接拼接到SQL语句中，假如此时传入如下参数
?id=-1'union+select+1+-