解析为 E 地址)的第一个步骤是查看本地 ARP 缓存。 如果本地 ARP 缓存中 已经存在所需的信息，
那么就会使用这些信息 。 有时， 使用名为 ARP 缓存污染的技术会滥用这种活动， 此时攻击者会在
ARP 缓存中插入伪造的信息。 如果 ARP 缓存中不存在所需的信息， 那么就会传输-个采用广播形
式的 ARP 请求。 如果被查询地址的所有者位于本地子网 内 ， 那么它就能够响应所需的信息。 如果被
查询地址的所有者不在本地子网内 ， 那么系统会默认使用默认的网关来传输通信数据。 随后 ， 默认
的网关(也就是路 由 器)需要执行 自 己的 ARP 或 RARP 进程。
3. 常见的应用层协议
在 TCPIIP 模型的应用层(包括 OSI 模型的会话层、 表示层和应用层)上， 驻留着许多特定于应用
或服务的协议 。 对于 CISSP 考试来说， 了 解这些协议的基础知识及相关的服务端 口 十分重要:
远程登录(Telnet)， TCP 端口 23 这是一个终端仿真网络应用 ， 支持能够执行命令和运行应用
程序的远程连通性 ， 但是不支持文件传输。
文件传输协议(FTP)， TCP 端口 20和21 这是一个支持文件交换的网络应用 ， 文件交换要求
进行匿名 的或特定的 身份认证。
普通文件传输协议σFTP)， UDP 端口 69 这是一个支持文件交换的网络应用 ， 文件交换不要
第 11 章 网络安全架构与保护网络组件
求进行身份认证。
简单邮件传输协议(SMTP)， TCP 端口 25 这个协议用于从客户端 向邮件服务器以及从一个邮
件服务器向 另一个邮件服务器传送邮件 。
邮局协议(POP3)， TCP 端口 11。 这个协议用于将邮件服务器收件箱中 的邮件传送至邮件客
户端。
互联网消息访问协议(IMAP)， TCP 端口 1 43 这个协议用于将邮件服务器收件箱中的邮件传输
至邮件客户端。 IMAP 比 POP3 更安全， 并且能够从邮件服务器中取出邮件头 ， 在不必先下载至本
地客户 端的情况下就可 以 直接从邮件服务器中删除邮件 。
动态主机配置协议(DHCP)， UDP 端 口 67 和 68 DHCP 将端 口 67 用于服务器点对点响应， 将
端 口 68 用于客户端请求广播。 在系统启动时， DHCP 用 于为系统指派 TCPIIP 配置设置。 DHCP 提
供了对网络寻址的集中化控制 。
超文本传输协议(HTTP)， TCP 端 口 8。 这个协议用于从 Web 服务器 向 Web 浏览器传送 Web
页面元素。
安全套接宇层(SSL)， TCP 端 口 443 这是一个在会话层上运作的、 像 VPN 一样的安全协议。
SSL 原本设计用于支持安全的 Web 通信。ITTPS)， 不过它能够保护任何应用层协议通信的安全。
行式打印后台程序(LPD)， TCP 端 口 51 5 这是一个用于管理打印作业以及向打印机发送打印
作业的网络服务。
X 视窗(X Window) ， TCP 端 口 6000-6063 这是一个用于命令行操作系统的 GUI APIo
引导协议(BootP)/动态主机配置协议(DHCP)， UDP 端口 67和68 这个协议用于通过 自 动分
配 E 配置 以及下载基本 的 OS 元素来连接无盘工作站和网络。 BootP 是 DHCP 的前身 。
网络文件系统(NFS)， TCP端口2049 这是一个用于支持在不同系统之间共享文件的网络服务。
简单网络管理协议(SNMP)， UDP 端 口 1 61 (UDP 端口 1 62 用于跟踪信息) 这个网络服务被用
于通过从中 央监控站轮询监控设备来收集网络健康和状况信息 。
1 1 .2.2 分层协议的应用
正如你从前面的章节中看到的， TCPIIP 协议套件包括几十个跨越不同协议桔层的单独协议。 因
此， TCPIIP 是一个多层协议。 TCPIIP 的 多层设计有许多好处， 特别是关系到它的封装机制。 例如，
Web 服务器和 Web 浏览器之间的通信工作在一个典型的网络连接上， Hπp 封装在 TCP 中 ， TCP
又封装在E中 ， 而 IP 又封装在 以太网中。 这个封装可以用 以 下方式进行展示:
[ Ethernet [ IP [ TCP [ HTTP 1 1 1 1
然而， 这不是 TCPIIP 封装支持的程度。 除此之外， 它也可 以添加额外的封装层。 例如， 添加
SSL/TLS 加密通信会使得 HTTP 和 TCP 之间插入一种新的封装 :
[ Ethernet [ IP [ TCP [ SSL [ HTTP 1 1 1 1 1
同理， 又可 以用诸如 IPSec 的网络层加密进行进一步封装:
[ Ethernet [ I PSec [ IP [ TCP [ SSL [ HTTP 1 1 1 1 1 1
然而， 封装并不总是用于 良好的初衷。 有许多隐蔽的信道通信机制， 在一个授权的协议中使用
封装隐藏或隔离另一个未授权的协议。 例如， 如果一个网络阻止 盯P 但允许 H口p， 那么利用诸如
31 3
314
CISSP 官方学 习指南(第 7 版)
HTTP 隧道的工具就可 以 用来绕过这个限制 。 这导致出现以下所示的封装结构 :
[ Ethernet [ IP [ TCP [ HTTP [ FTP 1 1 1 1
通常情况下， HπP 带有与 自己Web 相关的载荷， 但通过 HTTP 隧道工具， 标准的有效载荷被
另 一个协议取代。 这种错误封装甚至可以在较低的协议战中 出现。 例如， ICMP 通常用于网络健康
测试而不是一般通信。 然而， 随着诸如 Loki 的 出现， ICMP 被转换为支持 TCP 通信的隧道协议。
Loki 的封装结构如下 :
[ Ethernet [ IP [ I CMP [ TCP [ HTTP 1 1 1 1 1
另 一个关注的领域是， 对无界封装的支持将带来在 VLAN 之间跳跃的能力。 VLAN 通过逻辑标
签分离实现网络分段。 这种被称为跳跃攻击的攻击通过创建二次封装 æEE 802. 1 Q VLAN 标签的方
式来进行:
[ Ethernet [ VLANl [ VLAN2 [ IP [ TCP [ HTTP 1 1 1 1 1 1
通过这样的两次封装， 第一次遇到的交换机将剥离第一个 VLAN 标签， 接下来的交换机将被内
部 VLAN 标签欺骗并将流量转移到其他 VLAN 中 。
多层协议提供 以 下好处:
• 可 以在更高层使用更为广泛的协议
• 封装可 以和不同 的层进行合作
• 在更为复杂的网络中 支持灵活性和弹性
多层协议有 以下几个缺点 :
• 允许隐蔽信道
• 过滤机制可被绕行
• 逻辑上实现的网络段边界可 以被逾越
DNP3
DNP3(分布式网络协议)是CISSP CBK专 门提出 的与多层协议相关的 内 容。 DNP3主要用 于电力和
水利行业的使用和管理， 主要用 来支持数据采集系统和系绞J主制设备之间 的通信， 包含子站计算机、
RTU(远和冬端单元， 通过嵌入式rf;i!快理器来控制设备)、 æD(智能电子设备)和SCADA主站(即控制 中心)。
DNP3是一个开放的公共标准。 DNP3是一个多层协议且功能类似于TCP店， 因为它有链路、 传输矛口传输
层。 关于DNP3的更多 细节 ， 请查看h即://www.dnp.orglAboutUsIDNP3%20Primer%20Rev今ωA抖t
1 1 .2.3 TCP/I P 的ß弱'性
TCPIIP 的脆弱性有很多。 在各种操作系统中， 不正确地实现 TCP/IP 堆找很容易遭受缓冲区溢
出攻击、 SYN 泛洪攻击、 各种 DoS 攻击、 碎片攻击、 过长数据包攻击、 欺骗攻击、 中 间人攻击、
劫持攻击 以及编码错误攻击。
除了这些侵入式攻击以外， TCPIIP(以及大多数协议)还常常遭受通过监控或嗅探进行的被动式
攻击。 网络监控是对信息流量模式进行监控， 从而获得网络相关信息的行为。 数据包嗅探是从网络
中捕获数据包井期望从信息数据包内容中抽取出有用信息的行为。 有效的数据包嗅探器可以抽取出
用户名、 密码、 电子邮件地址、 加密密钥 、 信用卡号、 IP 地址和系统名等信息。
第 11 章 网络安全架构与保护网络组件
数据包嗅探和其他攻击在第 1 3 章 会有进一步的讨论。
1 1 .2.4 :t或名 解析
寻址和命名操作是使网络通信成为可能的重要组成部分。 如果没有寻址方案， 那么互联的计算
机就无法被区 分或指定通信的目的地。 同样， 如果没有命名方案， 那么人们就不得不凭借记忆和依
赖编号系统来识别计算机。 例如， 记忆 "Google.com" 比记忆 " 64.233. 1 87.99 " 容易得多 。 因此，
绝大多数命名方案是为人制定的 ， 而不是为计算机制定的。
理解在基于 TCP/IP 的网络中使用的寻址和命名 的基本概念相当重要。 我们应当意识到三个不同
的层。 它们在这里以相反顺序进行罗 列 ， 这是因为这三层是最为基础的 。
• 第三层或底层 ， 是 MAC 地址层。 MAC 地址或硬件地址是 " 永久 " 的物理地址。
• 第二层或中间层 ， 是 IP 地址层。 IP 地址是在 MAC 地址上 " 临时 " 赋予的逻辑地址。
• 最顶层是域名 。 域名 或计算机名 是在 IP 地址上 " 临时 " 赋予的友好转换约定。
"永久" 与 "临时" 地址
为这两个形容词加上 引 号的原 因 走它们并不完全准确 。 MAC 地址被设计为永久的物理地址。
但是， 某些 N1C 支持 MAC 地址变化， 而且大多数现代主制牛 系 统(包括 Windows 和 Linux)也能够做
到这一点。 N1C 支持 MAC 地址变化时 ， 变化在硬件上发生 。 操作系 统支持 MAC 地址变化时， 变
化只 在内存 中 发生 ， 不 过对其他所有 网 络实体来说 ， 就像硬件发生 了 变化一样，
因 为 只是逻辑的 ， 并且 DHCP 或管理员 能够随时对其进行修改， 所以 E 地址是临时的。 然而，
现实中还存在一些 系统静态分配 E 地址的例子。 同样， 计算机名 或 DNS 名 也是逻辑的 ， 因 此能够
被管理员 史改。
命名和寻址系统为每个网络连接组件授予其所需的信息， 并使这些系统尽可能简单地使用这些
信息。 人们得到人性化的域名 ， 网络连接协议得到与路由器友好的 E 地址 ， 网络接口则得到物理地
址。 不过， 为了允许彼此之间 的互操作性， 上述三种模式必须被链接在一起。 因此， 人们开发了域
名 系统ρNS)和 ARP/RARP 系统。 DNS 将人性化的域名解析为相应的 IP 地址 。 随后， ARP将IP 地
址解析为相应的 MAC 地址。 这两种解析操作都具有 自 己的逆过程， 也就是 DNS 逆向查找和 RARP
(请参看本章前面的 " ARP 和反向 ARP " 部分) 。
阅读更多 的 DNS 内 容
关于对 DNS 最新的 阐述， 包括其操作、 已知问题以 及 Dan Kaminski 漏洞， i青访问"An I1Iustrated
Guide to theKaminsky DNS Vulnerabili旷'(htφ:llunixwiz.netltechtips/iguide-kaminsky-dn岳阳ln.html)。
有 关 DNS 的描述， 尤其是对抗 Kaminski 漏 洞 ， 请访 问 www.dnssec.net。
1 1 .3 汇聚协议
汇聚协议是专业或专有协议和标准协议的融合， 例如 TCPIIP 协议。 汇聚协议的主要好处是使用
现有的 TCPIIP 网络基础设施支持特殊或专有主机而不用特殊部署修改后的网络硬件。这能有效地节
315
316
CISSP 官方学 习指南(第 7 版)
约成本。 然而， 作为专有协议的实现， 并不是所有的汇聚协议提供相同 的吞吐量或可靠性。 这里描
述 了一些汇聚协议的常见例子:
以太网光纤通道(FCoE) 光纤通道是网络存储解决方案(存储区域网络(SA1'。或网络附加存储