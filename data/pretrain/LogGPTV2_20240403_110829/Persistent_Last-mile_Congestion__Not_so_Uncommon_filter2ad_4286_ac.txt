Results presented in this paper have several implications for
the networking community.
We believe the original version of BBR [6] that disregards
packet loss may be detrimental in the context of persistent
last-mile congestion, as it may put more burden to already
overwhelmed devices. Thus, the improvements brought by
BBR v2 (i.e. account for loss and ECN) are essential in this
context [20].
Special care is also required when working with measure-
ment platforms, such as RIPE Atlas. For instance, geolocation
studies and services based on latency [4, 8, 27] should avoid
making inferences during peak hours and with probes affected
by persistent last-mile congestion. More generally, we rec-
ommend inspecting last-mile latency for any Internet delay
study as last-mile congestion may induce wrong inferences.
Although omitted here for brevity, we have made a few
more observations in Japan using Atlas anchor‚Äôs delay (Ap-
pendix B) and IPv6 traffic (Appendix C) and noticed that the
use of IPoE (instead of PPPoE) for IPv6 in most Japanese
ISPs help circumvent congested legacy devices. This could
suggest that the newer IPv6 infrastructure scales better but
this could also be due to the different traffic volume carried by
each protocol. Comparing protocol performances is however
beyond the scope of this paper and left for future work.
7 CONCLUSIONS
In this paper we have presented an analysis of persistent
last-mile congestion and found that this type of congestion
appears consistently for Atlas probes located in 10% of moni-
tored ASes, including large eyeball networks. In addition, we
recorded persistent last-mile congested probes in 55% more
ASes during the COVID-19 outbreak. Our detailed analysis
of Japan‚Äôs major ISPs with the help of CDN logs confirmed
that detected last-mile congestion has a drastic impact on
users throughput.
Figure 7: Aggregated last-mile queuing delay and
throughput for ISP A and ISP C. Cropped at 3.5ms
and 60Mbps for better visibility.
The top plot of Figure 6 shows the median throughput
for ISP A and ISP B broadband, both marked by significant
daily drops. The throughput for these networks decreases to
less than half during peak hours approximately coinciding
with delay increases observed in Figure 5.
We can also check the PPPoE hypothesis by comparing
these results to mobile users throughput. Figure 6 middle plot
depicts the median throughput for ISP A and ISP B mobile
users (ISP A mobile users are from a different AS). We see
no similarity between broadband and mobile throughputs,
cellular networks show consistent performance by maintain-
ing median throughput above 20Mbps. ISP C throughput
also exhibits no significant daily drop for both broadband
and mobile users (bottom plot). The stable performances of
ISP C and cellular networks also confirm that the observed
throughput drops are not due to congestion at the CDN.
4.3 Delay and throughput correlation
To better understand the relationship between delay and
throughput fluctuations, we cross-reference both datasets.
For congested ASes, we find that there is clear non-linear
correlations between delay and throughput, hence we report
correlation using Spearman‚Äôs rank correlation coefficient. Fig-
ure 7 shows the relationship between delay and throughput.
For ISP A (left plot) delay increases concur with throughput
decreases (ùúå = ‚àí0.6). For instance, we always observe low
throughput when aggregated delay is above 1ms. For ISP C
(right plot) there is absolutely no correlation between the
two metrics (ùúå = 0.0), meaning that throughput and delay
fluctuations are driven by different factors.
Although these results cannot imply causation, they agree
with our hypothesis hence support previous observations [19].
We also argue that this is strong evidence of persistent last-
mile congestion and thus validate the monitoring technique
of ¬ß2.
5 LIMITATIONS
The above analysis have several limitations that should be
taken into consideration when interpreting these results.
425
0123Agg. queuing delay (ms)0102030405060Throughput (Mbps)ISP_A0123Agg. queuing delay (ms)0102030405060Throughput (Mbps)ISP_CPersistent Last-mile Congestion: Not so Uncommon
IMC ‚Äô20, October 27‚Äì29, 2020, Virtual Event, USA
REFERENCES
[1] Persistent Last-mile Congestion. Survey Results.
https://
last-mile-congestion.github.io/.
[2] APNIC Labs. Visible ASNs: Customer Populations (Est.). https://
stats.labs.apnic.net/aspop/.
[3] V. Bajpai, S. J. Eravuchira, and J. Sch¬®onw¬®alder. Dissecting
last-mile latency characteristics. SIGCOMM Comput. Commun.
Rev., 47(5):25‚Äì34, Oct. 2017.
[4] Z. S. Bischof, R. Fontugne, and F. E. Bustamante. Untangling the
world-wide mesh of undersea cables. In Proceedings of the 17th
ACM Workshop on Hot Topics in Networks, HotNets ‚Äô18, page
78‚Äì84, New York, NY, USA, 2018. Association for Computing
Machinery.
[5] M. Candela, V. Luconi, and A. Vecchio. Impact of the covid-19
pandemic on the internet latency: a large-scale study, 2020.
[6] N. Cardwell, Y. Cheng, C. S. Gunn, S. H. Yeganeh, and V. Jacob-
son. Bbr: congestion-based congestion control. Communications
of the ACM, 60(2):58‚Äì66, 2017.
[7] A. Dhamdhere, D. D. Clark, A. Gamero-Garrido, M. Luckie,
R. K. Mok, G. Akiwate, K. Gogia, V. Bajpai, A. C. Snoeren, and
K. Claffy. Inferring persistent interdomain congestion. In ACM
SIGCOMM, pages 1‚Äì15, 2018.
[8] B. Du, M. Candela, B. Huffaker, A. C. Snoeren, and k. claffy. Ripe
ipmap active geolocation: mechanism and performance evaluation.
ACM SIGCOMM Computer Communication Review, 50(2):3‚Äì10,
2020.
[9] H. Esaki, H. Sunahara, and J. Murai. Broadband Internet Deploy-
ment in Japan, volume 4 of Advanced Information Technology.
IOS Press, 2008.
[10] N. Feamster and J. Livingood.
Internet speed measure-
ment: Current challenges and future recommendations. CoRR,
abs/1905.02334, 2019.
[11] R. Fontugne, E. Aben, C. Pelsser, and R. Bush. Pinpointing delay
and forwarding anomalies using large-scale traceroute measure-
ments. In ACM Internet Measurement Conference (IMC), pages
1‚Äì14. ACM, 2017.
[12] D. Genin and J. Splett. Where in the internet is congestion?,
2013.
[13] T. Holterbach, C. Pelsser, R. Bush, and L. Vanbever. Quantifying
interference between measurements on the ripe atlas platform.
In Proceedings of the 2015 Internet Measurement Conference,
pages 437‚Äì443, 2015.
[14] IDATE for FTTH Council Europe. FTTH/B Global Ranking Sep
2018, Mar. 2019.
[15] Internet Health Report. Network Delays During National Lock-
downs. https://ihr.iijlab.net/ihr/en-us/covid19?country=Italy.
[16] Internet Health Report.
raclette: Human-friendly monitoring
of Internet delays. https://github.com/InternetHealthReport/
raclette.
[17] M. Luckie, A. Dhamdhere, D. Clark, B. Huffaker, and K. Claffy.
Challenges in inferring internet interdomain congestion. In Pro-
ceedings of the 2014 Conference on Internet Measurement Con-
ference, pages 15‚Äì22, 2014.
[18] Ministry of Internal Affairs and Communications. Interface be-
tween ISP and NGN (PPPoE and IPoE) (In Japanese). http://
www.soumu.go.jp/main content/000519543.pdf.
[19] A. Nakagawa. Congestion of PPPoE and Kasumigaseki (In Japan-
ese), ENOG51. http://enog.jp/wp-content/uploads/2018/08/
20180720-ENOG51-Kashiwazaki.pdf.
[20] Neal Cardwell, Yuchung Cheng,Soheil Hassas Yeganeh, Priyaran-
jan Jha, Yousuk Seung, Kevin Yang, Ian Swett, Victor Vasiliev,
Bin Wu, Luke Hsiao, Matt Mathis, Van Jacobson. BBR v2:
A Model-based Congestion ControlPerformance Optimizations,
IETF 106, Singapore, Nov 2019. https://datatracker.ietf.org/
meeting/106/materials/slides-106-iccrg-update-on-bbrv2.
[21] NTT East, NTT West. Correspondence between our user de-
partment service and network function in NGN and interface
conditions of each service (In Japanese). https://www.ntt-east.
co.jp/info-st/mutial/ngn/ngn service.pdf.
[22] RIPE Atlas. Built-in Measurements. https://atlas.ripe.net/docs/
built-in/.
[23] H. Sasaki.
Japanese Internetworking, Peering Asia 1.0.
http://1.peeringasia.com/peeringasia/wp-content/uploads/
2017/11/Hideyuki-Sasaki.pdf, Nov. 2017.
[24] S. Sundaresan, M. Allman, A. Dhamdhere, and K. Claffy. Tcp
congestion signatures. In Proceedings of the 2017 Internet Mea-
surement Conference, pages 64‚Äì77, 2017.
[25] S. Sundaresan, N. Feamster, and R. Teixeira. Home network or
access link? locating last-mile downstream throughput bottlenecks.
In International Conference on Passive and Active Network
Measurement, pages 111‚Äì123. Springer, 2016.
[26] S. Sundaresan, N. Feamster, R. Teixeira, and N. Magharei. Mea-
suring and mitigating web performance bottlenecks in broadband
access networks. In Proceedings of the 2013 conference on In-
ternet measurement conference, pages 213‚Äì226, 2013.
[27] B. Trammell and M. K¬®uhlewind. Revisiting the privacy implica-
tions of two-way internet latency data. In Passive and Active
Measurement, pages 73‚Äì84. Springer International Publishing,
2018.
Appendices
A MOBILE PREFIXES OF JAPANESE
ISPS
Major Japanese Mobile Network Operators (MNOs) publicly
share the IP prefixes used for mobile connectivity. This is
an effort to help web services to provide adapted content to
cellular users. The following links are example of such list of
prefixes:
‚àô https://www.nttdocomo.co.jp/service/developer/smart phone/
‚àô https://www.support.softbankmobile.co.jp/partner/home
‚àô https://www.support.softbankmobile.co.jp/partner st/home
‚àô http://www.au.kddi.com/developer/android/kaihatsu/network/
‚àô http://www.au.com/ezfactory/tec/spec/ezsava ip.html
tech1/ios/index.cfm
spmode/index.html
tech1/index.cfm
B ANCHOR VS. PROBES DELAY
Another way to check the hypothesis of Section 4 is to com-
pare results from Atlas probes with results from anchors
for networks relying on the legacy network. As we expect
anchors to be located in datacenters, anchors are closer to the
backbone network and are not using the legacy network. In
other words the main differences between probes and anchors
hosted in the same AS is the access link. And if the AS relies
on the legacy network, then we expect to see congestion for
probes but not for anchors.
We found only one AS (hereafter referred as ISP D) that
relies on the legacy network for its broadband service and
that hosts both Atlas probes and anchor. Figure 8 shows the
aggregated last-mile queuing delay for ISP D‚Äôs probes (top
plot) and its anchor (bottom plot). Both are close to 0ms
during off-peak hours but the probes‚Äô delay increases signifi-
cantly during peak hours while the anchor‚Äôs delay stays at the
same level. This is another example illustrating congestion
at the legacy network.
C IPV6 THROUGHPUT ANALYSIS
For the legacy network in Japan, an alternative to PPPoE is
IPoE, which is usually used for IPv6 and provides a better
connectivity due to more recent equipment and lower number
of users [19, 21]. Although not all IPv6 is over IPoE, overall we
expect IPv6 to be less affected by PPPoE congestions. Figure
426
IMC ‚Äô20, October 27‚Äì29, 2020, Virtual Event, USA
Romain Fontugne, Anant Shah, and Kenjiro Cho
9 shows the IPv4 and IPv6 throughput for the three major
ISPs of Section 4. Overall we found that IPv6 throughput
is better than IPv4 and this is especially true during peak
hours for ISP A and ISP B. IPv6 is not showing performance
degradation during peak hours which suggests that the IPv6
infrastructure scales better but it could also be due to the
lower volume of traffic observed for this protocol (not shown
here).
Figure 8: Comparison between last-mile queuing de-
lay (ms) of Atlas probes and anchor in ISP D.
Figure 9: IPv4 and IPv6 throughput (Mbps) for the
three major ISPs of Section 4.
427
MondayTuesdayWednesdayThursdayFridaySaturdaySunday01020304050Aggregated queuing delayISP_D (probes)2019-03 (6 probes)2019-06 (6 probes)2019-09 (6 probes)2020-04 (7 probes)MondayTuesdayWednesdayThursdayFridaySaturdaySunday01020304050Aggregated queuing delayISP_D (anchor)2019-03 (1 anchor)2019-06 (1 anchor)2019-09 (1 anchor)2020-04 (1 anchor)2019-09-192019-09-202019-09-212019-09-222019-09-232019-09-242019-09-252019-09-260102030405060ThroughputISP_AIPv4IPv62019-09-192019-09-202019-09-212019-09-222019-09-232019-09-242019-09-252019-09-260102030405060ThroughputISP_BIPv4IPv62019-09-192019-09-202019-09-212019-09-222019-09-232019-09-242019-09-252019-09-260102030405060ThroughputISP_CIPv4IPv6