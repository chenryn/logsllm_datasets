# 挖洞技巧：APP手势密码绕过思路总结
##### 译文声明
本文是翻译文章，文章原作者 剑影，文章来源：07v8论安全
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
> 大家好，我是剑影，这是我的第二篇文章。
>
> 第一篇文章地址：
>
>
> 之前写的文章收到了很多的好评，主要就是帮助到了大家学习到了新的思路。自从发布了第一篇文章，我就开始筹备第二篇文章了，最终打算在07v8首发，这篇文章我可以保证大家能够学习到很多思路。之前想准备例子视频，请求了很多家厂商进行授权，但是涉及漏洞信息方面的，厂商都是很严谨的，所以，整个过程没有相关的实际例子，但是我尽可能的用详细的描述让大家能够看得懂。大家不要睡着呦~
说到APP手势密码绕过的问题，大家可能有些从来没接触过，或者接触过，但是思路也就停留在那几个点上，这里我总结了我这1年来白帽子生涯当中所挖掘的关于这方面的思路，有些是网上已经有的，有些是我自己不断摸索所发现的。
这里说下APP手势密码绕过的危害，手势密码一般应用在支付类，金融类，安全类等相关的APP，比如XX金融，XX支付，XX钱包，XX安全中心等APP，这些基本都会有手势密码，手势密码是一个用户的第一把APP锁，如果这个锁攻破了，那么后面也就很容易对用户造成威胁，虽然这个问题利用起来是需要物理操作，但是本质上我们不看利用起来如何如何的难，我们就看它的安全漏洞问题。本次文章里所有说到的思路包含四种环境：
**需要ROOT权限，不需要ROOT环境，需要越狱环境，不需要越狱环境。**
## 无需ROOT环境手势密码绕过的思路
### 0x01 利用APP广告绕过
本来打算想到网上找例子，但是没有找到。一般APP都会在启动页面时加载广告，此时，如果验证不当，当你点击广告后直接返回一下，就可以绕过手势密码。
### 0x02 利用多重启动绕过
这个多重启动也是我之前很早发现的思路，之前发现以为必须要ROOT环境，后来发现完全不需要，直接打开APP，停留在APP手势密码输入页面，此时我们按Home键返回到桌面，随便打开个应用市场，再搜索这个APP，此时由于你已经下载了这个APP，那么它显示的就是打开，这时你点击打开，它会又重新启动一次APP，如果验证不当，可导致直接绕过手势密码，进入到APP。
### 0x03 利用退出绕过&爆破
这个问题也是我在很久之前测试中发现的，当然，现在这种问题很多APP还是存在的，希望尽快修复这方面的问题。一般手势密码允许输入的错误次数为5次，当错误次数达到了5次了，就会需要重新登录，而这时这个超过次数的信息可能会以弹框来提醒，或者直接显示在TextView，也就是直接显示在手势密码界面上，这都不是问题，不要点击任何界面，比如它弹出了手势密码次数超过限制框框，信息框下方会有个确认的按钮，不要点击，我们直接返回到桌面，然后清理掉后台的APP，有时候会清理不干净，导致还是在后台运行着，这可能会导致失败，所以，为了测试成功起见，到设置里找到相关的应用，然后选择强制停止，然后再次打开APP，这时如果验证没做好，就会直接进到主页面，或请输入新的手势密码页面，或者会再次跳出手势密码验证界面，这时跳出的手势密码验证页面就存在爆破的问题，因为现在你又有5次机会输入手势密码，以此思路循坏，可造成对手势密码的暴力拆解。
这个问题我找到了相关的例子：
### 0x04 利用清理不当绕过
一些APP会这样储存手势密码，把手势密码储存在本地文本信息里，把账户的登录状态信息储存在本地数据库里，当清理掉这个本地数据后，实际上它并没有清理掉登录信息也就是并没有清理掉本地数据库信息，而是清理掉了本地文本信息，这就导致了清理掉了手势密码，而登录状态还是保持的，就导致了绕过问题。另一个思路比如你直接卸载再安装同样是这个原理。
这里我找到了2个例子，第一个例子：
第二个例子：
### 0x05 利用显示不当绕过
一些APP当你启动APP的时候，它会在短时间内进入到或者说可以点击到APP内的某些功能，此时你只要一直点击这个页面，只要够快，就可以绕过手势密码，到达这个功能界面。
关于这个问题，我找到了例子：
### 0x06 利用APP自带提示绕过
一些APP会自带提示，比如在状态栏内时不时推送一些信息，如果验证不当，直接点击推送的信息，就可以直接绕过手势密码，直接进入到主页面。
### 0x07 利用显示不当绕过
这个我从来就没遇到过，APP手势密码验证界面会出现设置按钮，直接设置没有加以验证从而绕过。
这类问题我找到了例子：
### 0x08 利用清理缺陷绕过
跟刚刚那个说的很像，也是手势密码跟账户信息储存在不同处，而最后只清理掉手势密码没清理掉登录信息的问题，在需要手势密码验证的界面点击忘记手势密码，此时会跳转到登录界面，直接返回到桌面，清理掉后台运行的APP，再次打开就直接进入到主界面，并且是登录状态。
### 0x09 利用界面设计缺陷绕过
以前看到过相关问题，问题是出现在IOS下的，所以我就列出来了，当进入到手势密码界面，可以左右滑动，从而滑动到主页面，绕过手势密码，这个问题可能已经很少软件存在了。
总结：
以上思路有些是我自己测试过程中所发现的，有些是网上的，以上思路都是在无需ROOT环境下或越狱下实现的，但是IOS下的软件这里面的思路基本很少可以实现，因为这些思路主要是android
下的APP问题。现在很多大型APP有一半都存在这个问题，希望各大厂商下的SRC尽快去修复或者白帽子发现了尽快提交，避免对用户以及自身产品造成影响。