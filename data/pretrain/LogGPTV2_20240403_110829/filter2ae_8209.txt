# 【技术分享】使用AT调制解调器命令解锁LG Android屏幕

#### 译文声明
本文为翻译文章，原文来源于 [articles.forensicfocus.com](articles.forensicfocus.com)。译文仅供参考，具体内容及含义以原文为准。

- 翻译：胖胖秦（[个人主页](http://bobao.360.cn/member/contribute?uid=353915284)）
- 预估稿费：100 RMB
- 投稿方式：发送邮件至 [linwei@360.cn](mailto:linwei@360.cn)，或登录 [网页版](http://bobao.360.cn/contribute/index) 在线投稿

---

现代智能手机不仅仅是用于语音通话的设备，它们还包含了大量的个人数据，如联系人列表、通信历史、照片、视频和地理位置信息等。大多数智能手机也具备作为调制解调器的功能。几乎所有的调制解调器都兼容Hayes标准，支持自1977年以来开发的AT命令集。每个型号通常支持一组由制造商定义的基本命令，有时这些命令集还可以扩展，包含一些非常有趣的命令。

### LG智能手机的行为分析

当通过USB将LG智能手机连接到计算机时，可以自动访问其内置的调制解调器（图1）。特别的是，即使手机屏幕被锁定，该调制解调器仍然可用。因此，即使手机受到密码保护，我们也可以使用AT命令获取一些有用的信息（图2）。

**图1**

**图2**

### 支持的AT命令

要了解特定型号支持哪些AT命令，我们需要检查其固件。对于Android智能手机，只需研究 `/system/bin/atd` 文件即可。图3-5展示了在LG G3 D855手机上找到的一些AT命令。

**图3**

**图4**

**图5**

显然，这款手机支持大多数基本的AT+命令集，可用于提取公共信息（图5）。但最令人感兴趣的是一些LG专有的AT命令（如AT%IMEIx, AT%SIMID, AT%SIMIMSI, AT%MEID, AT%HWVER, AT%OSCER, AT%GWLANSSID），这些命令能够返回手机的基本信息。其中，AT%KEYLOCK命令（图4）尤其引人注目，因为它允许管理屏幕锁定状态。

### 调试与分析

为了进一步研究AT%KEYLOCK命令的行为，我们可以运行调试器并使用交叉引用找到其处理函数代码（图6）。

**图6**

当调用AT%KEYLOCK命令时，根据参数数量的不同，会从 `/system/lib/libatd_common.so` 库中调用 `lge_set_keylock()` 或 `lge_get_keylock()` 函数。图7显示了 `lge_set_keylock()` 函数的代码。

**图7**

如图8所示，如果传递给 `lge_set_keylock()` 函数的值为“0”（即0x30），它最终会调用一个函数来移除屏幕锁，无论您使用何种方法锁定屏幕（PIN、密码、图案或指纹）。然后返回字符串“[0] KEYLOCK OFF”（图8）。

**图8**

显然，命令 `AT%KEYLOCK=0` 允许删除屏幕锁定，无需进行任何额外操作。

### 命令的工作原理

值得注意的是，此命令仅删除屏幕锁定，并不影响用户设置。具体来说，它将零值（表示解锁）写入存储屏幕锁定状态的特殊RAM区域，而不修改ROM。这意味着该命令不会访问任何用户数据，并且重启后屏幕锁定会恢复。该命令不能帮助调查人员找到屏幕锁定的PIN/模式/密码，只是暂时移除锁定。

### 测试结果

我们在LG G3 D855型号（带有V20g-SEA-XX固件）上进行了测试，发现上述AT命令在其他LG智能手机（如LG G4 H812, LG G5 H860, LG V10 H960等）上也能正常工作。所有这些型号都支持这种方法。

### 结论

通过USB连接到计算机，使用AT命令解锁LG Android手机非常简单。这一功能显然是LG服务软件的一部分，但也可能被用于取证目的。然而，需要注意的是，犯罪分子也可能利用这种方法。

---