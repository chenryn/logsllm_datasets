智慧运维二期场景白皮书
修订历史记录
| 序号 | 修改描述 | 日期 | 作者 |
|---|---|---|---|
| 1 |创建文档 |2019-11-01 |温明媚 || 2 |在一期白皮书原有的质量保障类、效率提升类、成本管理类基础上，增加场景联动类、可视化展示两大场景分类，见2.4、2.5； 质量保障类中依照运维保障工作流程新增事前、事中、事后保障分类，见2.1.1、2.1.1.2、2.1.3，其中事前保障中新增性能预测、容量预测、风险规避三大能力维度，见2.1.1.1、2.1.1.2、2.1.1.3； 成本管理类中新增资源预测和成本优化两大能力维度，见2.3.1、 2.3.5； 质量保障类的事前保障中，原有的能力维度故障预测中新增Timesten故障预测、开源软件故障预测、容器故障预测、调用链故障预测和主机故障预测，见2.1.1.4.1、2.1.1.4.2、2.1.1.4.3、2.1.1.4.4、2.1.1.4.5；事中保障的原有能力维度异常检测中新增主机异常行为检测、终端异常行为检测、用户行为异常行为检测、调用链结构的安全检测、网络智能基线告警、网络入侵检测、开源软件异常检测，见2.1.2.1.4、2.1.2.1.21、2.1.2.1.22、2.1.2.1.25、2.1.2.1.33、2.1.2.1.34、2.1.2.1.36；故障诊断中新增微服务故障诊断、容器故障诊断、开源软件故障诊断，见2.1.2.2.1、2.1.2.2.2、2.1.2.2.3；故障自愈中新增能力开放服务故障自愈、容器云服务故障自愈、数据库故障自愈、数据库关联应用故障自愈、业务故障关联自愈、智能策略匹配自愈，见2.1.2.3.1、2.1.2.3.2、2.1.2.3.3、2.1.2.3.4、2.1.2.3.5、2.1.2.3.6； 效率提升类原有的能力维度智能问答中新增智能掌上工作台，见2.2.1.1；智能决策中新增部件失效影响面分析、微服务智能熔断降级、容器亲和度、智能工单处理、中间件配置优化、智能工单变更、知识图谱，见2.2.2.1、2.2.2.2、2.2.2.3、2.2.2.4、2.2.2.5、2.2.2.6、2.2.2.7；智能变更中新增IT组织智能变更、变更质量评估、全生命周期智能变更，见2.2.3.1、2.2.3.2、2.2.3.3； 成本管理类原有的能力维度资源优化中新增分布式消息中间件优化、虚拟化资源均衡分析，见2.3.2.1、2.3.2.2；性能优化中新增云上应用瓶颈分析、开源软件性能优化、服务调用链性能优化、客户端体验评分，见2.3.3.1、2.3.3.2、2.3.3.3、2.3.3.4；容量规划中新增容器规格评估、网络流量预测、开源软件容量预测，见2.3.4.1、2.3.4.2、2.3.4.3； 算法概述中，在一期白皮书的基础上新增22个算法，同时在原有的算法中，对其中20个算法的应用场景和对应场景进行了扩充。语义分析中新增BERT S-BERT算法、前缀树Drain算法、条件随机场CRF算法，见3.1.7、3.1.8、3.1.9；检测算法中新增OCDT算法，见3.2.5，时序分析中新增EWMA指数加权移动平均算法、MAD平均绝对偏差算法，见3.3.10、3.3.11；关联挖掘中新增编辑距离算法、SBD距离算法、余弦相似度算法、PCA 算法-主成分分析算法、FP-growth算法、Apriori算法，见3.4.9、3.4.10、3.4.11、3.4.12、3.4.13、3.4.14；特征聚类中新增层次聚类算法、重复二分聚类算法，见3.5.3、3.5.4；类别预测中新增贝叶斯网络算法、朴素贝叶斯分类算法、Fasttext文本分类算法，见3.6.9、3.6.10、3.6.11；回归分析中新增多项式回归算法，见3.7.3；统计分析中新增四分位距算法，见3.8.6；优化算法中新增遗传算法、爬山算法、粒子群算法、蚁群算法，见3.9.3、3.9.4、3.9.5、3.9.6。 |2021-05-20 |贾晓冬 || 3 | | | |
| 4 | | | |
| 5 | | | |
| 6 | | | |
| 7 | | | |
| 8 | | | |
一、综述 
当前，云计算、大数据、人工智能等IT技术迅猛发展，国家信息化建设逐渐深入，信息系统已成为企业核心竞争力的重要部分。因此，IT运维作为信息系统稳定、安全、高效运行的保障，获得了越来越多的关注。随着微服务、容器等新型IT技术实践逐渐成熟，以及业务需求的快速变化，IT运维也在不断探索着新模式、新实践。
AIOps经过2020年的建设，目前已储备多类场景，且已形成实例化的应用场景，具体场景的数据、算法、模型也初具雏形。随着技术的不断发展，业务应用上云已经成为企业持续发展的必然选择,从上IaaS到上PaaS，未来将全面形成云服务模式。为不断更新完善AIOps场景，同时实现循环迭代优化，为未来智慧运维提供更丰富的AIOps场景服务支撑，需要持续演进完善AIOps场景能力。通过全网收集450个AIOps需求，结合一期61个场景综合分析梳理后，精炼归类，共形成了17大能力维度138个场景。
本次AIOps新增了两大场景分类，分别是场景联动类和可视化展示类，场景联动类侧重于多AIOps联动分析，可视化展示类侧重于对AIOps的全方位多维度的可视化展示。同时在一期已有的三大场景分类中，新增了5个能力维度，分别为质量保障类的容量预测、性能预测和风险规避、成本管理类的成本优化和资源预测，并根据新的场景需求，丰富了相应算法来支撑智慧运维。综合全网AIOps场景方案设想，梳理各场景的实现思路及目标，结合一期白皮书的算法内容，共梳理出70个可供运维分析使用的算法。
场景描述 
2.1质量保障类
2.1.1 事前保障
2.1.1.1 性能预测（新）
2.1.1.1.1分布式存储性能预测2.1.1.1 性能预测（新）
2.1.1.1.1分布式存储性能预测
随着业务发展，业务系统越来越频繁使用分布式存储，对分布式存储的性能产生越来越大的依赖，经常会因为存储性能或者故障导致业务受阻或瘫痪，对存储性能的把控需求日益提高。对分布式存储进行实时的性能数据采集分析，结合auto_arima、xgboost、holt-winter
LinearRegression等智能算法进行性能综合性预测，提前预警性能不足问题，提前处理避免影响业务系统，同时可灵活检测出低效能的分布式存储，下线低效低能分布式存储，降本增效。
2.1.1.1.2容器性能预测
容器化微服务化趋势发展，从而需要对容器的性能进行评估预测，因此通过采集容器各个维度的相关性能指标进行关联分析，包括CPU，MEM，DISK，NET等不同维度指标，通过prophet时间序列预测算法，实现容器性能的预测，及时了解容器性能短板和相关建议。2.1.1.1.3微服务性能预测
性能能直接体现用户感知，而且容器化微服务化趋势发展，从而需要对微服务的性能进行评估预测，因此通过采集微服务各个维度的相关性能指标进行关联分析，包括调用时长性能指标、调用耗时指标、调用次数指标、调用成功率指标等不同维度，通过prophet时间序列预测算法，实现微服务性能的预测，及时了解容器性能短板和相关建议。
2.1.1.1.4系统性能预测
在性能预测上，只有不同单个对象的性能指标管理监控，缺少针对整体系统统一全方位的性能指标预测，因此可通过采集系统各个维度对象的相关性能指标进行关联分析，如接口调用耗时、应用响应时长、吞吐量、并发量、CPU内存使用率等覆盖业务、应用、进程、主机、数据库等覆盖多个维度对象的指标、通过prophet时间序列预测算法，实现系统性能的预测。
2.1.1.1.5应用性能预测2.1.1.1.5应用性能预测
在运维工作中，后端web服务的应用性能是重点关注的。由于实际的规模业务系统多，具体的应用模块也比较多，实例化的进程数以千计，容器化、微服务化之后更以几何增长，如果能预测应用集群的性能走势，预测在未来至少3天内的性能走势，在运维工作安排中对其进行重点关注，针对其中的性能瓶颈提前做调整，很大程度上能避免突发情况。实时采集web服务性能，形式性能历史数据库，同时读取历史工单报告，引入auto_arima、xgboost、holt-winter、LinearRegression等智能算法，测算未来至少3天的性能走势，给出明确的整改建议。
2.1.1.1.6中间件性能预测
随着业务中各种中间件的使用，中间件对业务性能的影响已经越来越重要，但是对中间件的性能预测部分比较缺乏，无法实现业务中间件的性能预测分析。因此，基于redis性能指标、redis的配置数据、业务拓扑数据，通过LSTM长短期记忆模型算法及Prophet时间序列预测算法，实现未来周期内redis性能指标的预测分析，并实现指标的可视化展示及性能分析报告，保障业务环境稳定运行。2.1.1.1.7数据库性能预测
数据库容量随着业务的发展，用户的增长，写入的数据越来越多。开发商对数据入库没有估算，存储使用和表空间规划不准确，导致存储使用紧张，没有趋势可寻，处理没有计划都是紧急需求，没有长远规划和参考。因此通过数据库实例、表空间、运行SQL通过Prophet算法，分析指标序列的周期、趋势等特征，估算数据库运行效率、存储容量、运行慢SQL进行及时预警，结合预测数据，对数据库进行合理优化。
2.1.1.2容量预测（新）
2.1.1.2.1 es集群容量预测
elasticsearch运行效率与使用的空间资源具有正相关性。接入的日志数据规模与业务相关性大，依赖资源容易变化。基于es接入的历史日志使用情况及响应效果，通过词向量、余弦相似度、Apriori 挖掘算法进行合理预测业务增长，合理分配可用资源，进行集群扩缩容以实现负载均衡，保证集群稳定性。
2.1.1.2.2 WEB中间件容量预测2.1.1.2.2 WEB中间件容量预测
目前各省公司、集团的业务系统大部分采用的是商用中间件，商用中间件一般采用license来控制部署数量，在系统规划初期，如果web中间件需求量评估不准确，会导致两种情况：评估量远超实际用量，造成采购浪费；评估量远小于实际用量，需要重新采购，耽误工期、上线，二次浪费。引入auto_arima、xgboost、holt-winter、LinearRegression等智能算法，对输入的信息数据（bomc告警、第三方告警、性能指标数据、中间件配置数据、paas平台的接口能力、paas平台的告警数据）做评估，结合规模数据、业务量数据、现网web中间件规模综合评估所需的web中间件容量。
2.1.1.2.3存储容量预测2.1.1.2.3存储容量预测
随着业务发展，业务系统日益庞大，对存储的需求日益提高，各种分布式存储、磁盘阵列使用的越来越多，对存储的容量把控需求也日益提高，需要更为综合性的评估存储的综合使用情况及容量使用趋势。对存储设备的存储容量、使用率、使用量、存储类型、承载系统，结合auto_arima、xgboost、holt-winter、LinearRegression等AI算法进行综合性分析，从而对存储的整体使用情况进行智能化评估，提升存储预测能力
2.1.1.2.4大数据PaaS平台容量预测
大数据PaaS平台作为经营分析的基础平台，是经分系统运行的重要载体，随着业务的不断增加，大数据PaaS平台的承载量需要相应的不断扩展，如何快速、实时的针对大数据PaaS平台进行容量评估是目前的痛点问题。因此，基于主机、hadoop、hive、HDFS等组件的性能数据，通过ARIMA及Holt-winter时间序列检测等算法，构建相关性能指标的预测模型，并且输出未来一段时间的性能指标预测数据，支持不同时间周期的容量预测，预测出下一阶段需要的容器配置。2.1.1.2.5数据库容量预测
数据库在日常运行时，会对底层软、硬件造成负荷，显著影响应用系统性能。如果容量过载（如表空间满），会引起应用系统性能下降甚至瘫痪。因此需要关注数据库的容量状态，及时了解当前数据库的资源情况，以便提前预防，确保系统安全稳定运行。基于数据库监控产品获取的容量指标数据，以数据库为统计单元，利用LSTM长短期记忆模型算法进行容量预测。
2.1.1.2.6云平台容量预测系统建设伴随着云计算、集群化、容器化等新技术的落地，容量预测面临着新的挑战。系统容量变化信息同步不及时：客户扩容工程从合同签订到设备到货上网，周期在6个月左右，工程交付窗口期中业务的变化经常导致临时紧急扩容；人工预测容量不精确：系统容量的变化受多种因素影响（节假日等），人工难以快速准确的锁定关键因素，并基于预测算法提供精确预测数据 。同时需要综合考虑云平台指标获取与常规指标获取的区别，以及云平台容易弹性伸缩的特征。容量评估指标通过应用配置管理和主机监控产品获取。数据采集保证实时性及全面性，并对采集的数据进行存储。由于业务故障或硬件故障等原因，监控产品获取的数据可能存在错误或者重复，对于这些脏数据，在数据预处理阶段进行删除。对于缺失的数据则通过插值法进行填充处理。预处理阶段生成的数据入库存储。基于预处理后的数据，以业务系统为统计单元，计算出资源消耗的数学模型。数据模型的确定主要基于动态基线的技术实现。结合auto_arima、xgboost、holt-winter、LinearRegression等智能算法和（CPU总核数、CPU已分配量、CPU剩余可分配量、内存总量、内存已分配量、内存剩余可使用量等容量指标）等指标数据，预测出下一阶段需要的容器配置。2.1.1.3风险规避（新）
2.1.1.3.1服务器硬盘风险监测
虚拟化、云化后，存储普遍出现集中化、分布式、共享化趋势，对于硬盘的性能、质量的要求更高，故障影响更大。通过对硬盘的性能数据（使用率、擦写次数、读写速率、坏道数）进行智能化分析（孤立森林(iForest)、指数加权移动平均(ewma)、岭回归(ridge)、平均绝对差算法(MAD)、基于3倍统计标准差的动态基线），综合分析硬盘的运行情况，提前预警存在故障隐患的硬盘，从而规避硬盘故障导致的业务系统瘫痪风险。
2.1.1.3.2业务上线前风险评估2.1.1.3.2业务上线前风险评估
随着电信业务模中互联网技术的引用，业务部署中采用的第三方开源软件类型及数量均逐步增加，而在电信行业中，信息安全是一个比较重要的部分，在业务开源软件部署前对开源软件进行安全风险评估，保障业务整体运行环境安全是一个必要的过程。因此，基于业务进程配置数据、主机资源、业务拓扑资源、安全数据，通过CNN卷积神经网络算法及Prophet时间序列预测算法, 识别业务应用的部署方式和应用配置信息等，上线前对安全风险问题进行分类、汇聚，智能匹配知识库风险问题处理方案，提供的安全检测风险评估报告，为运维人员提供风险规避意见或建议, 确保业务应用无安全漏洞和其他安全风险，确保业务整体运行环境安全。
2.1.1.3.3运维操作风险检测2.1.1.3.3运维操作风险检测