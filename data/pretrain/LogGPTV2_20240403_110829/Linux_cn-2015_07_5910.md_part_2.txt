# Shell 精要

如果你是一个完全的 Linux 新手，并且是第一次阅读这份杂志，那么你可能会觉得这些教程有些难以理解。因此，在这里我们将介绍一些基本知识，帮助你更好地熟悉 shell。通常在你的菜单中，shell 可以通过 Terminal、XTerm 或 Konsole 来访问。启动后，以下是一些常用的命令：

- `ls`：列出文件名
- `cp one.txt two.txt`：复制文件
- `rm file.txt`：删除文件
- `mv old.txt new.txt`：移动或重命名文件
- `cd /some/directory`：切换目录
- `cd ..`：返回上级目录
- `./program`：在当前目录下运行程序
- `ls > list.txt`：将输出重定向到一个文件

几乎所有命令都有一个手册页来解释其选项（例如 `man ls` - 按 Q 退出）。在这里，你可以了解命令的各种选项。例如，`ls -la` 会显示详细的文件列表，包括隐藏文件。此外，你还可以使用 Tab 键来自动补全文件或目录名。

## Tmux: 针对 Shell 的窗口管理器

在文本模式环境中使用窗口管理器听起来可能有些奇怪，但请回忆一下 Web 浏览器首次实现分页浏览时的情景。这在当时是一个巨大的可用性进步，减少了桌面任务栏中的混乱和多个窗口。对于浏览器来说，只需一个按钮即可在打开的不同网站之间切换，而不是每个网站都有一个单独的任务栏或导航图标。

当你同时运行多个虚拟终端时，也会遇到类似的情况。在这些终端之间切换，或者每次在任务栏或窗口列表中找到所需的终端，都可能非常麻烦。拥有一个文本模式的窗口管理器不仅可以让你在一个终端窗口中运行多个 shell 会话，而且还可以将这些窗口排列在一起。

另外，这种窗口管理器还有一个好处：可以分离和重新连接会话。最好的方式是自己尝试一下。在一个终端窗口中输入 `screen`（大多数发行版默认安装或可以从软件包仓库中找到）。欢迎信息出现后按 Enter 键即可消失。现在运行一个交互式的文本模式程序，例如 `nano`，然后关闭这个终端窗口。

在正常的 shell 会话中，关闭窗口会终止所有在该终端中运行的进程。但对于 `screen` 来说并非如此。打开一个新的终端并输入 `screen -r`，刚才的 Nano 会话就会恢复！

当你运行 `screen` 时，它创建了一个独立的 shell 会话，不与特定的终端窗口绑定，可以在后面被分离并重新连接（即 `-r` 选项）。这对于通过 SSH 连接到另一台机器并在不稳定连接下工作时特别有用。如果连接突然中断，只需重新连接并运行 `screen -r` 即可恢复工作。

我们一直在讨论 GNU 的 `screen`，但本节标题提到的是 `tmux`。实际上，`tmux`（terminal multiplexer）类似于 `screen` 的一个进阶版本，带有许多有用的额外功能。某些发行版默认包含 `tmux`；其他发行版可以通过 `apt-get`、`yum install` 或 `pacman -S` 命令安装。

安装后，键入 `tmux` 启动它。你会注意到终端窗口底部有一条绿色的信息栏，类似于传统窗口管理器的任务栏，显示运行程序的列表、主机名、当前时间和日期。现在运行一个程序，例如 `nano`，按 Ctrl+B 再按 C 创建一个新的 tmux 窗口。你可以在底部的任务栏中看到如下信息：

```
0:nano- 1:bash*
```

每个窗口都有一个数字，当前呈现的程序用星号标记。Ctrl+B 是与 tmux 交互的标准方式。按 Ctrl+B 加上窗口编号可以切换到对应窗口。你也可以使用 Ctrl+B 加 N 或 P 切换到下一个或上一个窗口，或使用 Ctrl+B 加 L 在最近使用的两个窗口之间切换（类似于桌面环境中的 Alt+Tab 组合键）。要查看窗口列表，使用 Ctrl+B 加 W。

现在你可以在一个单独的终端窗口中运行多个程序，避免混乱（尤其是在与同一个远程主机保持多个 SSH 连接时）。如果想同时查看两个程序怎么办？

在这种情况下，可以使用 tmux 中的窗格。按 Ctrl+B 加 % 将当前窗口分为左右两部分。你可以使用 Ctrl+B 加 O 在这两个部分之间切换。这在你想同时查看两个内容时非常实用，例如一个窗格看指导手册，另一个窗格用编辑器查看配置文件。

有时，你可能需要调整单个窗格的大小。首先按 Ctrl+B 加 :，使底部的 tmux 栏变为深橙色。现在进入命令模式，在这里你可以输入命令操作 tmux。输入 `resize-pane -R` 使当前窗格向右移动一个字符，或使用 `-L` 向左移动。虽然这些命令看起来较长，但在 tmux 的命令模式下可以使用 Tab 键补全命令。此外，`tmux` 也有命令历史记录，可以重复执行之前的缩放操作。

最后，让我们看看分离和重新连接——这是我们在介绍 `screen` 时提到的功能。在 tmux 中，按 Ctrl+B 加 D 可以从当前终端窗口分离当前的 tmux 会话。这使得会话在后台运行，使用 `tmux a` 可以重新连接到会话。如果有多个 tmux 会话在运行，可以使用 `tmux ls` 列出它们。这个命令为每个会话分配一个编号；如果你想重新连接到会话 1，可以使用 `tmux a -t 1`。`tmux` 是高度可定制的，可以自定义按键绑定和配色方案，所以一旦你适应了主要功能，请查阅手册了解更多内容。

![tmux](/data/attachment/album/201507/29/000335nb3m5bfx778bmh3s.jpg)
上图中，`tmux` 开启了两个窗格：左边是 Vim 正在编辑一个配置文件，右边展示着指导手册页。

## Zsh: 另一个 Shell

选择是好的，但标准同样重要。几乎每个主流 Linux 发行版都默认使用 Bash shell，尽管还有其他 shell。Bash 提供了几乎所有你需要的功能，包括命令历史记录、文件名补全和强大的脚本编程能力。它成熟、可靠且文档丰富——但它不是唯一的选择。

许多高级用户喜欢使用 Zsh，即 Z shell。它是 Bash 的替代品，提供了 Bash 的几乎所有功能，还有一些额外的功能。例如，在 Zsh 中，输入 `ls` 并按 Tab 键可以得到 `ls` 的各种不同选项的大致描述，而不需要打开手册页。

Zsh 还支持其他强大的自动补全功能。例如，输入 `cd /u/lo/bi` 并按 Tab 键，完整的路径名 `/usr/local/bin` 会出现（假设没有其他路径包含 `u`、`lo` 和 `bi` 字符）。或者只输入 `cd` 再跟 Tab 键，你会看到着色后的路径名列表，比 Bash 给出的简单结果好看得多。

Zsh 在大多数主要发行版上都可以获取。安装后输入 `zsh` 启动它。要将默认 shell 从 Bash 改为 Zsh，可以使用 `chsh` 命令。更多信息请访问 [www.zsh.org](http://www.zsh.org/)。

## “未来”的终端

你可能好奇为什么包含命令行提示符的应用被称为终端。这要追溯到 Unix 的早期，那时人们通常在一个多用户机器上工作，这个巨大的计算机主机占据了一整间房间，人们通过线路使用屏幕和键盘连接到主机。这些终端机通常被称为“哑终端”，因为它们不能独立执行任何重要任务——它们只显示通过线路从主机传来的信息，并将键盘输入传回主机。

今天，我们在自己的机器上执行几乎所有实际操作，因此我们的电脑不再是传统意义上的终端。这就是为什么诸如 XTerm、Gnome Terminal、Konsole 等程序被称为“终端模拟器”——它们提供了与昔日物理终端相同的功能。尽管现在我们有了反锯齿字体、更好的颜色和点击网址的能力，但总的来说，几十年来我们一直以同样的方式工作。

因此，一些程序员正试图改变这种情况。**Terminology**（来自超级时髦的 Enlightenment 窗口管理器背后的团队）旨在让终端步入 21 世纪，例如具有在线媒体显示功能。你可以在一个充满图片的目录中输入 `ls` 命令，可以看到它们的缩略图，甚至可以直接在终端中播放视频。这使得终端有点像文件管理器，意味着你可以快速检查媒体文件的内容而不必使用其他应用程序打开它们。

接下来是 **Xiki**（[www.xiki.org](http://www.xiki.org/)），它自称为“命令的革新”。它介于传统的 shell、GUI 和 wiki 之间；你可以在任何地方输入命令，并将它们的输出存储为笔记以供参考，还可以创建非常强大的自定义命令。几句话很难描述它的全部功能，所以作者们制作了一个视频来展示它的潜力（请参见 **Xiki** 网站的截屏视频部分）。

**Xiki** 不是一个昙花一现的项目，作者们成功地进行了一次 Kickstarter 众筹，在七月底已筹集超过 $84,000。没错——$84K 来支持一个终端模拟器。这可能是最不寻常的集资活动之一，因为一些疯狂的家伙决定创办他们自己的 Linux 杂志......

## 下一代终端

许多命令行和基于文本的程序在功能上与图形界面程序相同，而且通常更快更高效。我们的推荐有：

- **Irssi**：IRC 客户端
- **Mutt**：邮件客户端
- **rTorrent**：BitTorrent 客户端
- **Ranger**：文件管理器
- **htop**：进程监视器

在终端的限制下进行 Web 浏览时，Elinks 表现得非常好，特别是对于以文字为主的网站（如 Wikipedia）。

## 微调配色方案

在《Linux Voice》杂志社中，我们并不迷恋视觉效果，但我们确实认识到美学的重要性。当我们每天花费数小时盯着屏幕时，许多人喜欢调整桌面和窗口管理器，直到达到完美效果（然后出于习惯继续调整）。

然而，我们往往忽视了终端窗口，它也应该得到我们的喜爱。你可以在 [某个网站] 上找到一个极佳的配色方案设计器，适用于所有流行的终端模拟器（如 XTerm、Gnome Terminal、Konsole 和 Xfce4 Terminal 等）。移动滑块直到你看到最佳配色方案，然后点击页面右上角的“获取方案”按钮。

类似地，如果你经常使用文本编辑器（如 Vim 或 Emacs），使用精心设计的调色板也非常值得。**Solarized** 是一个卓越的方案，不仅美观，而且经过大量研究和测试，追求最大的可用性。

---

via: 
作者：[Ben Everard](http://www.linuxvoice.com/author/ben_everard/)  
译者：[FSSlc](https://github.com/FSSlc)  
校对：[wxy](https://github.com/wxy)  
本文由 [LCTT](https://github.com/LCTT/TranslateProject) 原创翻译，[Linux中国](https://linux.cn/) 荣誉推出