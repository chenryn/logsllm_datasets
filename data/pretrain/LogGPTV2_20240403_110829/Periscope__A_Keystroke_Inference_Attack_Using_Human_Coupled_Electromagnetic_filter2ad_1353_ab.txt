assume the existence of any covert channel that reveals victimâ€™s
onboard sensor readings to the attacker either. Also, there is no
ideal environment, static or quiet, to launch attacks. The victim can
make free body movements during the typing process; other people
may walk by or talk in the background. Besides, it is unlikely for
an attacker to collect large amounts of data samples from a specific
victim to train an individual keystroke inference model properly
before the attack. The above settings render most of the existing
keystroke inference attacks infeasible.
What an attacker can do. The attack is able to figure out which
mobile device a victim is using and thus its numeric keyboard layout.
In practice, the attacker can investigate the MAC address of the
victimâ€™s WiFi traffics to obtain the device manufacturer information
by looking up prefixes of MAC addresses [13]. As mentioned in [22,
38, 64], the victimâ€™s DNS responses contain its device name. With
the information above, many mobile devices can be fingerprinted.
Prior work [22, 38] provide technique details on setting up a free
WiFi access point to access the victimâ€™s MAC address and DNS
responses for device fingerprinting unnoticeably.
4 PRELIMINARIES
4.1 How Do Touchscreens Work?
The majority of current mobile devices, such as smartphones and
tablets, are equipped with touchscreens. While there are various
sensing touch technologies, mutual capacitive sensing has been
AttackerprototypeSmartphone(on the table)Session 3A: Side Channel CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea702the most prominent due to its high sensitivity, energy efficiency,
and low manufacturing cost [40]. We thus focus on this type of
touch-sensing devices here.
Figure 2: The composition of a mutual capacitive touch-
screen.
As shown in Figure 2, a capacitive touchscreen consists of a grid
of transmitter (TX) and receiver (RX) electrodes, which are mutually
coupled with a capacitance of ğ¶0. TX electrodes are driven by an
alternating voltage signal ğ‘‰ğ‘‡ ğ‘‹ (ğ‘¡), which creates an alternating
current flow from TX to RX electrodes. When a finger touches
the screen, it extracts some electric charges from the electrode
grid to the human body through a coupling capacitance ğ¶ğ‘“ . The
touchscreen controller monitors the changes in the current that
flows into RX electrodes and reports the change as a touch event
to the system OS. Meanwhile, it locates the current change in the
electrode grid as the touched position on the screen. The input is
then recognized accordingly.
4.2 Touchscreen EM Emanations and
Measurements
The alternating currents between touchscreenâ€™s TX and RX elec-
trodes generate time-variant EM fields that continuously emit EM
radiations to the open space. Periscope intends to map the radiation
to userâ€™s typing inputs.
Figure 3: The circuit for touchscreenâ€™s EM emanation mea-
surement.
Figure 3 depicts an equivalent circuit of using an electric po-
tential sensor (EPS) to measure touchscreenâ€™s EM emanations. An
EPS typically consists of a capacitor ğ¶ğ‘š, a resistance ğ‘…ğ‘š, a voltage
amplifier, and a low-pass filter. By placing the eavesdropper, i.e.,
EPS, within the EM field of victimâ€™s touchscreen, these two will be
remotely coupled via a small capacitance ğ¶ğ‘Ÿ . Denote by ğ‘‰ğ‘ (ğ‘¡) the
time-variant voltage that drives EM emanations from the touch-
screen. The captured EM emanation at EPS, measured in electric
potential changes ğ‘‰ğ‘š(ğ‘¡), is expressed as
ğ‘‰ğ‘š(ğ‘¡) = ğ‘‰ğ‘ (ğ‘¡) Â·
+ ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘š)
1/( 1
ğ‘…ğ‘š
+ 1/( 1
ğ‘…ğ‘š
1
ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘Ÿ
+ ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘š) Â· â„(ğ‘¡).
(1)
Here â„(ğ‘¡) denotes the joint impulse response of the amplifier and
the low-pass filter. ğ‘“ stands for the frequency of the driving volt-
age ğ‘‰ğ‘‡ ğ‘‹ (ğ‘¡). Among the parameters in (1), ğ¶ğ‘š, ğ‘…ğ‘š, and â„(ğ‘¡) are
fixed values. ğ¶ğ‘Ÿ depends on the attacker-victim distance. It can be
treated as a fixed value too under a specific eavesdropping event.
Now ğ‘‰ğ‘š(ğ‘¡) is determined by ğ‘‰ğ‘ (ğ‘¡). As demonstrated next, ğ‘‰ğ‘ (ğ‘¡) is
impacted by finger movement. Hence, we establish a connection
between EM readings and finger movement. To validate this claim,
we show in Figure 4 the spectrogram of EM readings ğ‘‰ğ‘š(ğ‘¡) when a
user enters a 6-digit PIN. There are 6 bars with intense magnitude,
each representing the tap of one key. We also notice that the ma-
jority frequency components are scattered at the lower end of the
spectrum band, below 60 Hz. It indicates that EM emanations can
be easily captured by cheap EPS with a fair sampling rate.
Figure 4: Spectrogram of EM emanation measurement ğ‘‰ğ‘š(ğ‘¡).
4.3 Impact of Finger Coupling
The driving voltage of touchscreen EM emanation ğ‘‰ğ‘ (ğ‘¡) is influ-
enced by finger coupling that is modeled next.
Figure 5(a) is an equivalent circuit for a mutual capacitive touch-
screen when no touching. ğ‘…ğ‘‡ ğ‘‹ (ğ‘…ğ‘…ğ‘‹ ) represents the resistor at the
TX (RX) electrode. Recall that ğ¶0 is the TX-RX coupling capacitance.
The equivalent circuit is transformed to Figure 5(b) when touch-
ing. As a finger moves close to the screen, they become remotely
coupled via capacitance ğ¶ğ‘“ . As shown in Figure 5(c), the finger
extracts some electric charges through coupling to the human body
(characterized in ğ¶ğµ and ğ‘…ğµ). We call the above phenomenon as
finger/human coupling effect. When a finger is coupled to the screen,
ğ‘‰ğ‘ (ğ‘¡) is expressed as
ğ‘…ğ‘‡ ğ‘‹
ğ‘‰ğ‘ (ğ‘¡) = ğ‘‰ğ‘‡ ğ‘‹ (ğ‘¡) Â·
ğ‘…ğ‘‡ ğ‘‹ + 1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)
(2)
where ğ‘(ğ‘¡) denotes the equivalent time-variant impedance of the
right-half circuit of Figure 5(b)
1
ğ‘(ğ‘¡) = 1/(
).
1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘…ğ‘…ğ‘‹
(3)
Let ğ‘§(ğ‘¡) be the instant finger-screen distance. According to [10],
ğ¶ğ‘“ (ğ‘¡) can be expressed as
1/ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘“ (ğ‘¡) + 1/( ğ‘—2ğœ‹ ğ‘“ ğ¶ğµ + 1/ğ‘…ğµ) +
1
ğ¶ğ‘“ (ğ‘¡) =
ğœ–0ğœ–ğ‘Ÿ ğ´
ğ‘§(ğ‘¡) ,
(4)
FingerBody capacitance~100 pFBody resistance~1.5k OhmDevice caseElectrodegridGlass screenCoupling capacitanceFilterEPSTouchscreenImpluse response funciton:0.511.522.5Time (s)0204060Frequency (Hz)406080Magnitude (dB)Session 3A: Side Channel CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea703160Î© [26]). Then, (5) is rewritten as1
|ğ‘‰ğ‘š(ğ‘¡)|âˆ— â‰ƒ |1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)|âˆ—
|ğ‘‰ğ‘š(ğ‘¡)|
|1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)| ,
(6)
Similarly, ğ‘(ğ‘¡) is approximated as
1
ğ‘(ğ‘¡) â‰ƒ 1/(
1
1/ğ‘—4ğœ‹ ğ‘“ ğ¶0
1/ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘“ (ğ‘¡) +
Let the maximum finger coupling capacitance be ğ¶âˆ—
) = 1/( ğ‘—2ğœ‹ ğ‘“ ğ¶ğ‘“ (ğ‘¡) + ğ‘—4ğœ‹ ğ‘“ ğ¶0).
(7)
ğ‘“ . In prac-
tice, manufacturers tend to set the TX-RX coupling capacitance ğ¶0
approximate to ğ¶âˆ—
ğ‘“ â‰ƒ ğ¶0, by which ğ¶âˆ—
ğ‘“ is
achieved under the minimum finger-screen distance ğ‘§min. From (4),
we have ğ¶ğ‘“ (ğ‘¡)
ğ¶âˆ—
ğ‘“ [26]. We thus have ğ¶âˆ—
= ğ‘§min
ğ‘“
ğ‘§(ğ‘¡) which leads to
ğ¶ğ‘“ (ğ‘¡) = ğ¶âˆ—
ğ‘§min
ğ‘§(ğ‘¡) â‰ƒ ğ¶0
Combining (6) - (8), we have
ğ‘“
ğ‘§min
ğ‘§(ğ‘¡) .
(8)
(9)
(10)
|ğ‘‰ğ‘š(ğ‘¡)|âˆ— â‰ƒ|1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)|âˆ—
|ğ‘‰ğ‘š(ğ‘¡)|
|1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)| =
ğ‘§(ğ‘¡) + 2
ğ‘§min
ğ‘§(ğ‘¡) + 4
ğ‘§min
Â· 5
3
.
and thus
ğ‘§(ğ‘¡) = 1/(
2ğ›¾1
1 âˆ’ |ğ‘‰ğ‘š(ğ‘¡) |
|ğ‘‰ğ‘š(ğ‘¡) |âˆ— 3
5
âˆ’ 4 + ğ›¾2) Ã— ğ‘§min.
ğ‘§min is essentially the thickness of touchscreenâ€™s covering glass.
It can be determined once the device manufacture information is
figured out. For example, ğ‘§min equals to 0.6 mm for iPhone SE2 [23,
25, 48]. |ğ‘‰ğ‘š(ğ‘¡)|âˆ— is the maximum measurement the EPS captured.
It can be treated as a known value. ğ›¾1 and ğ›¾2 are coefficients that
compensate the approximation errors of ğ‘§(ğ‘¡) in (2)-(8). They can
be estimated via offline calibration.
So far, we are able to express ğ‘§(ğ‘¡) into a function of ğ‘‰ğ‘š(ğ‘¡). Given
an instant EM emanation measurement, the corresponding finger-
screen distance can be obtained following (10). More importantly,
no training phase is needed. Unlike many wireless signal based
inference attacks, our analytic model is transparent from under-
lying signal propagation channel conditions, as they have been
incorporated into |ğ‘‰ğ‘š(ğ‘¡)| and |ğ‘‰ğ‘š(ğ‘¡)|âˆ—. Their impact is canceled
with each other during the calculation. Still, the attacker cannot
infer victimâ€™s typing inputs from ğ‘§(ğ‘¡) directly, unless it has the full
knowledge of the finger movement trajectory. We present how to
derive the latter from ğ‘§(ğ‘¡) in Section 6.
5 MEASUREMENT STUDY
The objective of this section is to validate the analytic result of Sec-
tion 4 and investigate the feasibility of leveraging human-coupled
EM emanations to launch keystroke inference attacks.
We build our prototype using an Arduino nano board [3] as a
microcontroller unit (MCU) and a conductive wire as an antenna.
These two are connected via Arduinoâ€™s analog input pin shown in
Figure 6. The antenna senses the electric potential changes caused
by touchscreen EM emanations. The system samples received sig-
nals with an analog-to-digital (A/D) converter at a rate of 4000
1Given two complex values ğ‘ + ğ‘—ğ‘ and ğ‘ + ğ‘—ğ‘‘, if ğ‘ >> ğ‘ then |ğ‘ + ğ‘—ğ‘ + ğ‘ + ğ‘—ğ‘‘ | â‰ƒ
| ğ‘—ğ‘ + ğ‘ + ğ‘—ğ‘‘ | since(cid:112)(ğ‘ + ğ‘)2 + (ğ‘ + ğ‘‘)2 â‰ƒ(cid:112)(ğ‘)2 + (ğ‘ + ğ‘‘)2.
(a)
(b)
(c)
Figure 5: Illustration of finger coupling effect. (a) Equivalent
circuit without finger touches. (b) Equivalent circuit with
finger touches. (c) Screen-finger coupling.
where ğœ–0 and ğœ–ğ‘Ÿ are dielectric permeability coefficients. ğ´ is the
overlap area between the fingertip and the screen. As ğœ–0, ğœ–ğ‘Ÿ and
ğ´ are fixed values in one keystroke, ğ¶ğ‘“ (ğ‘¡) is negatively correlated
with ğ‘§(ğ‘¡). Together with (2) and (3), we have the following relation
ğ‘§ â†“, ğ¶ğ‘“ â†‘, ğ‘ â†“, ğ‘‰ğ‘  â†‘. In short, the touchscreen emits stronger EM
emanations when the finger moves closer to it and vice versa. Ac-
cording to (1), ğ‘‰ğ‘š has a positive correlation with ğ‘‰ğ‘ . We thus have
ğ‘§ â†“, ğ¶ğ‘“ â†‘, ğ‘ â†“, ğ‘‰ğ‘  â†‘, ğ‘‰ğ‘š â†‘. This relationship chain indicates that the
finger coupling effect reveals a side channel to monitor finger move-
ments: remote EM emanation measurements ğ‘‰ğ‘š(ğ‘¡) reflect fingerâ€™s
realtime distance to the screen ğ‘§(ğ‘¡) when performing keystrokes.
4.4 How to Calculate ğ‘§(ğ‘¡) from ğ‘‰ğ‘š(ğ‘¡)?
While the above analysis exhibits a negative correlation between
ğ‘§(ğ‘¡) and ğ‘‰ğ‘š(ğ‘¡), we seek to further quantify this relationship, i.e.,
how to calculate ğ‘§(ğ‘¡) from ğ‘‰ğ‘š(ğ‘¡) exactly? Essentially, our goal is
to derive a closed-form expression of ğ‘§(ğ‘¡) as a function of ğ‘‰ğ‘š(ğ‘¡)
via (1)-(4). Nonetheless, this task is nontrivial.
Some parameters in (1)-(4), such as ğ‘…ğ‘š, ğ¶ğ‘š, ğ¶ğ‘Ÿ , and â„(ğ‘¡), are not
readily available. For example, ğ¶ğ‘Ÿ is determined by the placement
of the victim device and EPS. To resolve this issue, our trick here is
to utilize multiple measurements that can cancel out the unknown
parameters during the calculation.
As a note, EPS measures ğ‘‰ğ‘š(ğ‘¡) in its amplitude, denoted as
|ğ‘‰ğ‘š(ğ‘¡)|. Let |ğ‘‰ğ‘š(ğ‘¡)|âˆ— be the maximum value of |ğ‘‰ğ‘š(ğ‘¡)|. It is obtained
the moment that a finger touches the screen. |ğ‘‰ğ‘ (ğ‘¡)| and |ğ‘‰ğ‘ (ğ‘¡)|âˆ—
are defined similarly. We have
2â—‹
=
(5)
where 1â—‹ and 2â—‹ are due to (1) and (2), respectively. As suggested by
[19, 26], ğ¶ğ‘“ and ğ¶0 are generally very small, around 2 pF (2Ã— 10âˆ’12
F). Thus, their equivalent impedance is much larger than the body
resistance ğ‘…ğµ (around 1.5 ğ‘˜ Î© [50]), the body capacitance ğ¶ğµ (around
100 pF), as well as the resistance of electrodes ğ‘…ğ‘‡ ğ‘‹ and ğ‘…ğ‘…ğ‘‹ (around
|ğ‘…ğ‘‡ ğ‘‹ + 1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)|âˆ—
|ğ‘…ğ‘‡ ğ‘‹ + 1/ğ‘—4ğœ‹ ğ‘“ ğ¶0 + ğ‘(ğ‘¡)|
|ğ‘‰ğ‘š(ğ‘¡)|
|ğ‘‰ğ‘š(ğ‘¡)|âˆ—
|ğ‘‰ğ‘ (ğ‘¡)|
|ğ‘‰ğ‘ (ğ‘¡)|âˆ—
1â—‹
=
Impedance:ASession 3A: Side Channel CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea704Figure 6: Prototype of Periscope.
samples/sec. Recall that the frequency of touchscreen EM ema-
nations is bounded within 60 Hz according to the spectrogram
analysis in Section 4.2. Therefore, the prototypeâ€™s sampling rate is
more than enough to capture signal variances in EM emanations.
The entire prototype costs less than $10, which renders the attack
easily accessible and widely deployable.
To validate the analytic model for ğ‘§(ğ‘¡) derived in Section 4.4, Fig-
ure 7 compares it with the ground truth measurement. It is observed
that the former generally complies with the latter. Meanwhile, the
approximation operations involved in the derivation process do
introduce some marginal discrepancies between these two. We plan
to investigate its impact on the attack performance in experimental
evaluations.
Figure 8: EM emanation measurements for entering a 6-digit
PIN.
Figure 9: EM measure-
ments of entering differ-
ent key pairs.
Figure 10: Similarity matrix
for different key pairs using
normalized DTW distance.
Figure 7: Estimation of ğ‘§(ğ‘¡) from |ğ‘‰ğ‘š(ğ‘¡)|
Figure 8 shows EM measurements when entering a 6-digit PIN.
EM emanation variations reflect finger interactions with the screen.
We find that the signal experiences a sharp increase when the finger
moves towards the screen. It then decays quickly the moment a
physical contact takes place. This is because the finger draws some
electric charges from the screen. With reduced electric charges, the
EM radiation from the screen drops accordingly. Later on, as the
finger leaves the screen for the next key, the EM amplitude keeps
decreasing until the finger is de-coupled from the screen. This
observation coincides with the analytic result derived previously.
Figure 9 shows EM measurements by entering three different
key pairs â€œ42â€, â€œ46â€, and â€œ43â€. It is observed that their EM readings
are distinct to each other. For example, â€œ42â€ is associated with the
shortest time duration between two consecutive EM amplitude
peaks, as a finger moves in the shortest path to enter this key
pair among the three. We further evaluate the similarity of EM
emanations among ten key pairs originated from â€œ4â€ in Figure 10.
Normalized DTW distance is employed. A small value represents a
high similarity between two pairs, while a larger one means they
are barely correlated. We find that except for the diagonal, i.e., a
key pair and itself, DTW distances between EM readings from any
two different pairs are relatively large.
Figure 11: 3D finger movement trace and decomposition.