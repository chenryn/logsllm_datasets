###  a）通信延迟攻击
通过通信延迟攻击，可以增加列车的MA更新间隔，但小于最大允许中断时间。将MA更新间隔定义为 **T**
interval。当没有攻击时，该间隔大约等于通信周期T。假设的情况如上图所示，火车与目标点之间的距离为L，刹车指示点与目标点之间的距离为X。如果连续n个通信周期中火车未接收到更新后的MA，两个相邻的不同MA之间的时间间隔
**T** interval为(n +1)·T。当间隔满足：
其中vf是跟随列车的速度，并且跟随列车将应用行车制动以保持与领先列车的安全距离。当下一列火车最终接收到更新的MA时，它将停止行车制动并施加牵引力以加速行驶。
模拟方案配置如下，两列性能相同的火车从Station
0（0m）开始。攻击使通信延迟增加了3s。如上图所示，火车经常应用牵引力和行车制动。发生攻击时火车在接近刹车指示点的位置行驶，从600减速到680m，其速度从27.78下降到25.38m/s。攻击后，火车接收更新的MA，并从680m加速到760m，直到速度回到27.78
m/s。在这种攻击下，Station 0和Station 1（2000m）之间的每米速度差为0.275 m/s。
###  b）通信终端攻击
通过通信中断攻击，列车到路边通信的时间间隔大于最大允许中断时间，列车将触发紧急制动，如上图所示。当速度降至0时，即使恢复了通讯，火车也无法在CBTC模式下重新运行。火车的位置不正确，因为在紧急制动过程中车轮打滑并锁死了。为了在CBTC模式下重新运行，列车必须首先在限制模式（RM）下运行，速度限制为下一个平衡台的25
km/h，以进行位置校准。
在仿真中，出发间隔为90s。攻击始于领先的火车行进至1000m，并在领先的火车停止后90s结束。如上图所示，在Station 0和Station
1之间，有和没有攻击的领先列车的时间分别为106s和232s。在Station 0和Station
4（8000m）之间，有和没有攻击的领先列车的时间分别为455s和581s。尽管后续列车没有受到攻击，但基于CBTC系统的运行原理，其时间也会相应增加。当领先列车未受到攻击时，下一列火车在Station
0和Station 1之间的行驶时间为106和176 s。当领先列车未受到攻击或受到攻击时，在Station 0和Station
4之间下一列列车的时间为455s和530s。
上图展示了有和没有攻击时两列火车的速度/位置曲线。发生攻击后，领先列车会在1000m处触发紧急制动，然后以RM运行，直到在1500m恢复至CBTC模式。因此，下一列火车在Station
0和在Station 1之间频繁应用牵引力和行车制动。领先火车的每米速度差在Station 0和Station 1之间为4.446 m/s。Station
0和Station 1之间的下一列火车每米速度差为7.022
m/s。另外，当领先列车受到攻击时，领先列车和后继列车之间的距离太近。为了保持一定的安全距离，下一列火车要比未攻击前列火车提前3412m进行行车制动。在Station
1和Station 4之间，后续列车每米的速度差为0.772 m/s。
###  c）数据修改攻击
通过数据修改攻击，篡改了VOBC和ZC之间传输的列车控制数据和列车状态数据。这使他们可以获取彼此有关的错误数据。修改ZC生成的MA后，攻击者可能会使火车行驶到错误的位置。修改由火车发送的火车的位置后，由于连续两次接收到的火车位置之间的巨大差异，ZC会下降，这意味着ZC辖区内的所有火车都会触发紧急情况，制动显示为上图。重新启动ZC需要人工确认，并且需要很长时间。
由于修改火车控制数据可能仅影响一列火车，而修改火车状态数据将导致ZC下降并影响多列火车，因此仅考虑修改火车状态数据的情况。假设ZC的恢复时间为120s。上图显示两列火车减速到0的速度并在站点之间停了很长时间，因此与没有受到攻击相比，火车的旅行时间显着增加。在Station
1和Station 2（4000 m）之间，领先列车在没有和有攻击的情况下的行驶时间分别为106s和268s。在Station 0和Station
4之间，领先列车在没有受到攻击的情况下的时间分别为455s和616s。在Station 0和Station
1之间，后续列车在没有攻击和受到攻击的情况下的列车行驶时间分别为106s和286s，后续列车在Station 0和Station
4之间的行驶时间分别为455s和634s。
如上图所示，两列火车都触发紧急制动，然后以RM运行，直到它们恢复到CBTC模式。受到攻击后，Station 1和Station
2之间的领先列车每米速度差异为4.422 m/s，而Station 0和Station 1之间的后续列车每米速度差异为6.701 m/s。
## 0x05 Conclution
CBTC系统中的火车到路边无线通信网络在确保火车安全高效运行中发挥着重要作用。基于WLAN的漏洞，认为攻击者使用多通道MitM攻击列车到路边的无线通信网络。通过这种攻击，攻击者可以获得MitM的位置并执行诸如延迟，丢弃甚至修改之类的操作，这将导致不必要的牵引，行车制动，甚至是火车的紧急制动。将这些攻击分为三类：通信延迟攻击，通信中断攻击和数据修改攻击。根据CBTC系统的工作原理，通过对受攻击的列车轨迹与预设的最优列车运行状况的比较，量化了MitM攻击的影响。结果表明与无攻击相比，攻击增加了火车的行进时间和每米速度差。