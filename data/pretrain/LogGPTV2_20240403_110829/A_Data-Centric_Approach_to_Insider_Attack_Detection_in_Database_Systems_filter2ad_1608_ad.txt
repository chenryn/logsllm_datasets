### Anomaly Detection in Database Queries Using S-Vectors and Attribute Deviation

#### Introduction
The number of anomalous dimensions in an S-Vector can be a valuable parameter for ranking potential query anomalies. Queries with more anomalous S-Vector dimensions are likely candidates for attacks. This approach is used to test the custom-developed anomaly set, where normal Chair and Faculty queries are used to compute the mean values of S-Vector attributes, and three times the standard deviation is used as the anomaly threshold.

#### Performance Results
A typical performance result with two user roles (Chair and Faculty) and corresponding anomalous query sets is shown in Table 4. The cluster-based outlier detection algorithm's performance highlights several key points:

1. **Syntax-Based Schemes**: These schemes perform poorly because they are inherently insensitive to Type 2b anomalies.
2. **S-Vector (All)**: The detection rate is reasonable at 83.87%.
3. **Initial-k Approximation**: The accuracy suffers significantly, possibly due to the extensive use of the SQL ORDER-BY clause, which makes the Initial-k statistics unrepresentative of the overall result set. This is partially mitigated by the Random-k variation, but the performance still declines, indicating that the clustering scheme is sensitive to approximation methods.

#### Attrib-Deviation Performance
Attrib-Deviation schemes show better results:
- **Detection Rates**: Close to 87%, outperforming cluster-based schemes.
- **Resilience to Approximations**: Both Initial-k and Random-k perform well, even with specific ordering of results.

**Explanation**:
- **Single Anomalous Attribute**: A single anomalous attribute in the result corresponds to variations in multiple S-Vector dimensions, each representing a statistical measurement.
- **Selective Ordering**: While selective ordering may skew overall result statistics, Attrib-Deviation operates on a per-attribute basis, making it effective in identifying anomalies.
- **Multiple Anomalous Attributes**: Many queries have more than one anomalous attribute, so selective ordering may mask some but not all anomalies.
- **Statistical Measurements**: Selective ordering may not affect all statistical measurements equally, further enhancing the robustness of Attrib-Deviation.

**Implications**:
- **Fast Online Detection**: Initial-k approximation indicates that a fast online anomaly detector can perform well with just a few initial output tuples.
- **Resilience to Attacks**: The S-Vector representation and Attrib-Deviation are resilient to attacks designed to mislead or bypass detection.

**False Positives**:
- The false positive rates for Attrib-Deviation schemes are still high. Reducing these while maintaining or increasing true positive rates is an important research question.

### Concluding Remarks and Future Work

#### Query Construction
- **S-Vectors**: Constructed by expressing the schema of each query result in terms of the base schema. For SPJ queries on base relations, the base schema is easily determined. For SPJ queries on views, view unfolding is used.
- **Challenges**: For more complex queries (e.g., union queries, computed attributes), determining the base schema is difficult. We plan to investigate data provenance techniques to address this.

#### Dynamic Databases
- **Static Assumption**: The current framework assumes a static database. For dynamic databases, we need to determine when updates shift the boundary between normal and abnormal queries.
- **Re-training**: If the database instance is updated significantly, classifiers become obsolete, requiring re-training and reinforcement learning.

#### Activity Context
- **Current Approach**: The context is a set of past query results generated by the same user or group.
- **Future Work**: Investigate richer activity contexts, including session statistics, temporal and spatial correlations, to detect sophisticated attacks.

#### Performance
- **Large Result Sets**: Computing statistics over entire query results is impractical. Initial-k approximation helps, but training set queries might sort results differently, leading to false positives.
- **Solution**: Designate a default ORDER BY clause for training set queries and use a "shadow query" for detection.
- **Combined Model**: A new statistical model combining syntax-based and data-centric approaches could improve both performance and accuracy.

#### Sampling Techniques
- **Random-k**: Expected to perform consistently for a wider range of datasets and queries.
- **Sampling Without Full Execution**: Leverage prior work on SPJ queries and approximate query answering to sample query results without computing the complete result.

### Conclusion
The techniques presented show significant potential for anomaly detection and insider threat mitigation in database systems. Future work will focus on developing more efficient and practical solutions to address remaining open research issues.

### References
[References listed as provided in the original text]