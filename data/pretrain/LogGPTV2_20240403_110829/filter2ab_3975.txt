title:blackhat:asia-22 Unix Domain Socket: A Hidden Door Leading to Privilege Escalation in the Android Ecosystem
Unix domain socket (UDS) is an important inter-process communication (IPC) mechanism in the Android ecosystem. It can transfer IPC data safely with its access control strategies. In general, third-party applications cannot directly communicate with UDS services because of the restriction of SELinux. Thus, vendors often ignore the security of UDS services. Worse still, they may introduce additional vulnerabilities into UDS from insecure design, implementation, and misconfiguration. As a result, UDS becomes a hidden attack surface that can cause privilege escalation in the Android ecosystem.To demonstrate the severity of this attack surface, we investigated the UDS services in multiple Android devices and summarized the important scenarios of UDS in the Android ecosystem. Based on the risk analysis for each scenario, we found several vulnerabilities in the UDS services of 4 well-known vendors and obtained 8 CVEs. An attacker can exploit these vulnerabilities to obtain root or system privileges.In this presentation, we will first introduce the common scenarios of UDS by real-world examples. Then, we will explain how vendor daemons fit together through UDS in some complex functional modules, such as the GPS. Next, we will demonstrate typical vulnerabilities in these scenarios and use exploits that can bypass all access restrictions to illustrate the security problems. Finally, we will introduce automated analysis methods for UDS services and provide certain security suggestions.