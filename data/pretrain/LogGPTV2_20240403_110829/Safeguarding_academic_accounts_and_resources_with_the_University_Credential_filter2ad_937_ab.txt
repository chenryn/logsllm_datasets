SAMPLE USER PROFILE LEARNED OVER A WEEK OF ACTIVITY
Table I
Indeed, a logistic regression model [7] is inherently suitable
for single dichotomous label classiﬁcation. The model is
L = (cid:80) BiXi. L represents the natural logarithm of the
odds that a compromise happens: L = ln ˆp
1− ˆp, where
ˆp represents the estimated probability that the account is
compromised. The higher L is, the more likely it is that
the account has been compromised. Each feature Xi has a
corresponding coefﬁcient Bi, indicating that L would change
by Bi with one unit change in Xi. The ﬁnal classiﬁcation
uses a threshold to identify accounts as benign or possibly
compromised.
IV. EVALUATION
A. Datasets and Ground Truth
We used two empirical datasets to evaluate UCAAS: a
training set used for feature tuning and model testing, and
a validation set. One critical and difﬁcult step in building
the training set is that of obtaining the ground truth. We
addressed this challenge through a close collaboration with
the security teams, which have acquired extensive experience
in dealing with compromised accounts over the past several
years. The ﬁrst step was to collect known incident tickets
from 2009 to 2011. They represent a subset of the total
compromised accounts, since many compromised accounts
are never identiﬁed. Therefore, we needed further manual
checking of the dataset. However, the large volume of logs
in our dataset (around 6 million) made the manual validation
of each authentication attempt impractical. To address this
problem, we ran the heuristics discussed in Section III-B1
with conservative parameters tuned to minimize false nega-
tives. The set of ﬂagged accounts was sent to the security
team. They examined each account and contacted the owners
of suspicious ones via email and telephone to assess whether
or not the suspicious activity detected was really illegitimate.
Most of the time, this validation step consisted of asking
if the user traveled to the foreign country identiﬁed in the
data, or if the user shared credentials with other people. For
alumni or previous employees at UofM who could not be
reached by email or telephone, the security team provided an
expert judgment. The ﬁnal step was to manually examine the
authentication activities of those compromised accounts, and
label their feature vectors as compromised in the days during
which we had high conﬁdence that
illegitimate activity
had occurred. We kept reﬁning the ground truth with the
latest detection results during the course of the evaluation
process. We believe that through this process, most of the
accounts were correctly labeled. It should be noted that users
who shared their credentials with their families and friends
living abroad were discarded from our dataset. The reason
was that those accounts were not compromised, although
their activity matched that of compromised accounts. The
accuracy of the classiﬁer would be negatively impacted if
those accounts were labeled as benign. In addition, although
detection of shared credential accounts is not a goal of
UCAAS, we did not count them as false positives if they
were ﬂagged by UCAAS, because sharing of credentials is
discouraged by the universities.
At UofM, the training data were collected from June 14 to
June 28, 2011. The dataset includes 108,366 unique users
who had 2,129,275 authentication attempts. After ﬁltering
out users who did not have VPN-related activities and con-
ducting the validation process, we got a ﬁnal training set of
2,441 benign and 87 compromised accounts. The empirical
evaluation was done on a different validation set collected
from September 14 to October 2, 2011 and consisting of
6,562,153 login sessions from 127,316 unique users. At
UIUC, the training data were collected from June 19 to July
2, 2011. There are 104,172 successful logins from 25,530
users in the dataset. After the ﬁltering and validation, we
got a ﬁnal training set of 4,692 benign and 6 compromised
accounts. The evaluation set was collected from July 9 to
July 23, 2011 and consists of 106,477 logins from 24,979
unique users. The limited number of compromised accounts
at UIUC led us to add 10 incidents to the set. Those incidents
were detected by the security team during the ﬁrst half of
2011. We carefully examined the impact of adding those
incidents to make sure that they would help to improve
model accuracy without affecting the false positive rate.
B. Feature Evaluation
In this subsection, we analyze the effectiveness of the
feature set by comparing the proportions of benign and
compromised accounts that were ﬂagged by each feature. We
also list the coefﬁcients for signiﬁcant features, as calculated
by Weka when building the model. As explained previously,
the coefﬁcients represent the contribution of each feature to
the model, so the presence of features with high coefﬁcients
indicate accounts that were likely compromised.
The results for the set of suspicious behavior features are
shown in Table II. We ﬁnd that for both institutions, a higher
proportion of compromised accounts manifest suspicious
behavior. The only exception was that,
interestingly, no
compromised account was reported as having a suspicious
IP address in the training set at UofM. This indicates a
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:48:52 UTC from IEEE Xplore.  Restrictions apply. 
Institution
UofM
UIUC
Suspicious Behavior
Temporal-Spatial Violation
Suspicious IP Addresses
Suspicious Usage Pattern
Temporal-Spatial Violation
Suspicious IP Addresses
Suspicious Usage Pattern
% of benign
1.74%
1.67%
18.03%
0.32%
0.24%
72.97%
% of compromised
42.08%
0
37.60%
11.88%
2.43%
75.10%
PROPORTIONS OF AUTHENTICATION ATTEMPTS FROM BENIGN
Table II
ACCOUNTS AND COMPROMISED ACCOUNTS FLAGGED AS SUSPICIOUS
Institution
UofM
UIUC
Country
United States
Iran
China
Egypt
Japan
United States
China
Iran
Nigeria
France
% of benign
75.67%
0.64%
18.13%
0
0.24%
79.16%
15.66%
0.23%
0
0.36%
% of compromised
19.97%
38.10%
29.97%
2.41%
1.84%
15.14%
68.43%
10.37%
2.87%
1.87%
DISTRIBUTION OF IP ADDRESS GEOLOCATION
Table III
drastic evolution of the threat model, since half of the
incidents reported in 2010 were linked to suspicious IP
addresses. The coefﬁcients for the feature temporal-spatial
violation, suspicious IP addresses, and suspicious usage
pattern at UofM are 6.81, 8.11, and -35.39, respectively. It
was in accordance with our observations that in this model,
suspicious IP addresses was highly negatively correlated
with compromises while the other two suspicious behaviors
were positive indicators of compromises.
We then analyzed the performance of IP-based features.
The top ﬁve country codes, ASNs, and TLDs are shown
in Tables III, IV, and V, respectively. It is interesting to
observe the similarities between the two institutions. For
Institution
UofM
UIUC
ASN
University ASN
Comcast ASN
4134
12880
16322
4134
4812
39501
University ASN
Comcast ASN
% of benign
37.38%
17.06%
3.63%
0
0.02%
25.78%
6.06%
22.96%
2.65%
0.06%
% of compromised
9.79%
3.04%
15.02%
9.20%
6.76%
3.05%
45.08%
0.88%
16.18%
10.21%
Table IV
DISTRIBUTION OF ASN
Institution
UofM
UIUC
TLD
.EDU
.NET
.CN
.IR
.COM
.EDU
.BIZ
.NET
.CN
.FR
% of benign
47.56%
39.89%
2.33%
0.01%
6.19%
31.70%
0.06%
49.48%
3.34%
0.23%
% of compromised
21.79%
54.73%
4.82%
1.21%
6.94%
15.52%
12.03%
38.51%
10.48%
6.79%
Feature
US
IR
CN
EG
JP
Coefﬁcient
-0.94
1.95
0.50
8.52
1.07
Feature
University
Comcast
ASN 1434
ASN 12880
ASN 16322
Coefﬁcient
-1.25
-1.16
0.09
9.26
1.35
Feature
.EDU
.NET
.CN
.IR
.COM
Coefﬁcient
-0.44
0.15
0.21
5.02
0.07
DISCRIMINATING COEFFICIENTS OF IP-BASED FEATURES AT UOFM
Table VI
Institution
UofM
UIUC
Web-based services
Service
VPN
Web-based services
VPN
% of benign
46.26%
53.74%
4.24%
95.76%
% of compromised
28.39%
71.61%
2.50%
97.50%
Table VII
SERVICE USAGE DISTRIBUTION
instance, the large majority of legitimate activity occurs in
the United States and within the borders of the universities,
and the top two countries linked to illegitimate activity are
similar, along with an ASN of China-Telecom (4134). On the
other hand, the rankings of TLDs and ASNs also reveal some
differences. Although the training datasets were collected
around the same time, we observed that illegitimate activity
came from different sets of Internet service providers for the
two universities.
When looking at the coefﬁcients of some of those features
at UofM shown in Table VI, we get the same results. The
features of country being China or Iran, ASN being 4134,
12880, 16322, and TLD being .NET, .CN, or .IR all have
positive coefﬁcients, while the United States, the Univer-
sity’s ASNs, and the TLD .EDU have negative coefﬁcients.
We then reviewed the performance of the resource usage-
based features. As shown in Table VII, compromised ac-
counts were more likely to use the VPN rather than web-
based services for both universities. Again, the coefﬁcients
for the features of web-based service and VPN service at
UofM are -0.37 and 0.38, respectively.
However, the low proportion of web-based service usage
at UIUC prevented us from computing meaningful per-
formance results for the website usage. Thus, Table VIII
presents results only for UofM. Once again,
the result