bogons would be useful in other contexts such as identifying potential trademark
infringements.
We identiﬁed two known malicious campaigns in the subset of bogon data:
“Operation Hangover” and “CopyKittens.” The former is infrastructure of a
cyber espionage threat targeting government, military, and private sector net-
works with some ties to India [17]. Domain names seen in active DNS data for
this threat are shown on the left hand side in Table 3. The latter is infrastruc-
ture for threats targeting “high ranking diplomats at Israel’s Ministry of Foreign
Aﬀairs and some well-known Israeli academic researchers specializing in Middle
East Studies” [33] and its active DNS domains are shown on the right column
in Table 3.
These are useful indicators despite the fact these attacks are known and
likely inactive. Neutered, yet unidentiﬁed, infections are likely still operating in
networks today, which should lead to incidence responses and damage assess-
ments. For example, knowing the speciﬁc internal machine that was infected
with targeted malware is useful even after an attack has taken place. An end-
user machine on a company’s corporate network has diﬀerent implications than
a locked down server in a data center, or the CEO’s personal laptop. Interest-
ingly, some targeted threats do resolve to bogon space, while active, to reduce
204
A. Kountouras et al.
Table 3. Operation Hangover and CopyKittens attack group infrastructure and
domain names.
Operation Hangover
CopyKittens
alertmymailsnotify[dot]com
alhadath[dot]mobi
cloudone-opsource[dot]com
big-windowss[dot]com
download-mgrwin[dot]com
cacheupdate14[dot]com
necessaries-documentation[dot]com
fbstatic-akamaihd[dot]com
newsfairprocessing[dot]com
fbstatic-a[dot]space
onestop-shops[dot]com
fbstatic-a[dot]xyz
servicesloginmail-process[dot]com
gmailtagmanager[dot]com
servicesprocessing[dot]com
haaretz[dot]link
websourceing[dot]com
haaretz-news[dot]com
worldvoicetrip[dot]com
mswordupdate15[dot]com
mswordupdate16[dot]com
mswordupdate17[dot]com
patch7-windows[dot]com
patch8-windows[dot]com
patchthiswindows[dot]com
walla[dot]link
wethearservice[dot]com
wheatherserviceapi[dot]info
windowkernel[dot]com
windows-drive20[dot]com
windowskernel14[dot]com
windows-my50[dot]com
windowsupup[dot]com
their network footprint [27]. This suggests signal for malicious detection in active
DNS’s non-routable IPs.
5 Related Work
The collection of passive DNS data has been proposed by Weimer et al. [35]
over a decade ago as a method that network operators could use to investigate
security events in their environments. Zdrnja et al. [36] was the ﬁrst to dis-
cuss how passive DNS data can be used for spotting security incidents using
domain names. Notos [12] and Exposure [15] used the idea of building passive
DNS reputation by statistically modeling various properties of the successfully
resolved passive DNS traﬃc. Plonka et al. [29] introduced Treetop, a scalable
way to manage a growing collection of passive DNS data and at the same time
Enabling Network Security Through Active DNS Datasets
205
correlate zone and network properties. Since then, several researchers were able
to use proprietary passive DNS data to build systems that can detect abuse
in the Internet [13,14,16,24,26,31]. Clearly, passive DNS is considered to be a
very valuable tool that network operators and security researchers use in the
ﬁght against Internet abuse. As already discussed, our active DNS project can
provide researchers open access to DNS datasets, comparable to the very useful
passive DNS, but without any concerns on personally identiﬁable information
(PII) or other legal barriers to repeatable DNS research.
There have been many commercial and nation eﬀorts to create passive DNS
repositories. The costs for the commercial oﬀerings3 often pose a barrier for
researchers and network operators. Now, some of the national eﬀorts are hin-
dered by DNS policy, and thus have yet to be widely adapted by the commu-
nity. Perhaps the most successful has been passiveDNS.cn, which was quickly
dismissed as an unreliable source of DNS information. The reason behind this
development is very simple. The Chinese operators4 passively collected DNS
records that have been already censored by their egress sensors. In our project,
we do not censor the views of the recursive DNS servers that Thales uses to
resolve the seed domain names on a daily basis.
With the respect of active scanning eﬀorts, most of the eﬀorts have been con-
ducted from the side of the industry. In the last year, however, new work surfaced
from the academic community [20] that provides the ability to researchers to scan
the entire IPv4 space and use the results for open security research. This is the
work that is closest to the proposed system. The key diﬀerence, however, is that
Censys was not designed to scan the domain name space, rather, IPv4. Thus,
while researchers could ﬁnd some DNS logs into this great public project, our
work both complements Censys and also is designed to deal with DNS scanning.
6 Conclusion
DNS is vital to the operation of the Internet. Users, systems, and services rely on
its operation for most network communication—often without even realizing it.
Malware is no diﬀerent. It makes use of DNS to locate C&C servers and provide
network agility. Despite all its uses, it is incredibly diﬃcult to gain access to
large, open, and freely available DNS datasets, and even when possible, such
data is often encumbered with privacy regulations or access restrictions. This
severely limits the pool of security researchers than can leverage DNS in their
work. Furthermore, it limits the repeatability of existing DNS based research.
Clearly, there is a need in the research community for access to large, open, and
freely available DNS data. To that end, this work built a new system, Thales, to
query and collect massive quantities of DNS data starting from publicly available
lists of domains (e.g., zone ﬁles, Alexa, Common Crawl, etc.). We are releasing
the resulting active DNS data from this system to the public, and since this
data is derived from public sources, it can be easily incorporated into new or
3 For example, https://www.farsightsecurity.com/.
4 http://www1.cnnic.cn/ScientiﬁcResearch/LeadingEdge/fymly1/.
206
A. Kountouras et al.
existing research without having to worry about privacy regulations or access
restrictions.
To prove its merit, we provide an in-depth comparison between active DNS
and a passive DNS dataset collected on a large university network. This analysis
showed that active DNS data provides a greater breadth of coverage (i.e., greater
quantity and greater variety of records), but passive DNS data provides a denser,
more tightly connected graph. Due to these diﬀerences, we provided case studies
demonstrating how active DNS can be used to facilitate new research or even re-
implement existing DNS related research. It is our sincere hope that by opening
up active DNS to the security community we can spur more and better research
around DNS.
Acknowledgment. This material is based upon work supported in part by the US
Department of Commerce grant no. 2106DEK, National Science Foundation (NSF)
grant no. 2106DGX and Sandia National Laboratories grant no. 2106DMU. Any opin-
ions, ﬁndings, and conclusions or recommendations expressed in this material are those
of the authors and do not necessarily reﬂect the views of the US Department of Com-
merce, National Science Foundation, nor Sandia National Laboratories.
References
1. I.T. Mate List (2016). http://vurldissect.co.uk/daily.asp/
2. Abuse.ch domain blacklist (2016). http://www.abuse.ch/
3. Actionable analytics (2016). https://www.alexa.com
4. Common Crawl (2016). https://commoncrawl.org/
5. Domain Graveyard (2016). http://domaingraveyard.com/
6. Hphosts feed (2016). http://hosts-ﬁle.net/?s=Download
7. LinuxContainers.org (2016). http://hosts-ﬁle.net/?s=Download
8. Malc0de Database (2016). http://malc0de.com/bl/BOOT
9. Malware Domain List (2016). https://www.malwaredomainlist.com/
10. Sagadc.org list (2016). http://dns-bh.sagadc.org/
11. SANS ISC Feeds (2016). https://isc.sans.edu/feeds/
12. Antonakakis, M., Dagon, D., Luo, X., Perdisci, R., Lee, W., Bellmor, J.: A central-
ized monitoring infrastructure for improving DNS security. In: Jha, S., Sommer, R.,
Kreibich, C. (eds.) RAID 2010. LNCS, vol. 6307, pp. 18–37. Springer, Heidelberg
(2010)
13. Antonakakis, M., Perdisci, R., Lee, W., Vasiloglou, N., Dagon, D.: Detecting mal-
ware domains in the upper DNS hierarchy. In: Proceedings of the 20th USENIX
Conference on Security (USENIX Security), August 2011
14. Antonakakis, M., Perdisci, R., Nadji, Y., Vasiloglou, N., Abu-Nimeh, S., Lee, W.,
Dagon, D.: From throw-away traﬃc to bots: detecting the rise of DGA-based mal-
ware. In: Proceedings of the 21st USENIX Conference on Security Symposium,
Security 2012, Berkeley, CA, USA, pp. 24–24. USENIX Association (2012)
15. Bilge, L., Kirda, E., Kruegel, C., Balduzzi, M.: EXPOSURE: ﬁnding malicious
domains using passive DNS analysis. In: Proceedings of NDSS (2011)
16. Chen, Y., Antonakakis, M., Perdisci, R., Nadji, Y., Dagon, D., Lee, W.: DNS
noise: measuring the pervasiveness of disposable domains in modern DNS traﬃc.
In: 2014 44th Annual IEEE/IFIP International Conference on Dependable Systems
and Networks (DSN), pp. 598–609, June 2014
Enabling Network Security Through Active DNS Datasets
207
17. Coat, B.: Snake
in the
geted attacks
snake-grass-python-based-malware-used-targeted-attacks
tar-
(2014). https://www2.bluecoat.com/security-blog/2014-06-10/
grass: Python-based malware used for
18. Cotton, M., Vegoda, L.: Special Use IPv4 Addresses. RFC 5735 (Best Current
Practice), Obsoleted by RFC 6890, updated by RFC 6598, January 2010
19. Daigle, L.: WHOIS Protocol Speciﬁcation. RFC 3912 (Draft Standard), September
2004
20. Durumeric, Z., Adrian, D., Mirian, A., Bailey, M., Halderman, J.A.: A search
engine backed by Internet-wide scanning. In: Proceedings of the 22nd ACM Con-
ference on Computer and Communications Security, October 2015
21. Felegyhazi, M., Kreibich, C., Paxson, V.: On the potential of proactive domain
blacklisting. In: Proceedings of the 3rd USENIX Conference on Large-Scale
Exploits, Emergent Threats (2011). Observation of strains. Infect Dis Ther. 3(1),
35–43: Botnets, Spyware, Worms, and More (LEET), April 2010
22. Holz, T., Gorecki, C., Rieck, K., Freiling, F.C.: Measuring and detecting fast-ﬂux
service networks. In: NDSS (2008)
23. Ishibashi, K., Toyono, T., Hasegawa, H., Yoshino, H.: Extending black domain
name list by using co-occurrence relation between DNS queries. IEICE Trans.
Commun. 95(3), 794–802 (2012)
24. Krishnan, S., Monrose, F.: An empirical study of the performance, security and
privacy implications of domain name prefetching. In: 2011 IEEE/IFIP 41st Inter-
national Conference on Dependable Systems Networks (DSN), pp. 61–72, June
2011
25. Lever, C., Walls, R., Nadji, Y., Dagon, D., McDaniel, P., Antonakakis, M.: Domain-
Z: 28 registrations later measuring the exploitation of residual trust in domains.
In: 37th IEEE International Symposium on Security and Privacy, May 2016
26. Ma, J., Saul, L.K., Savage, S., Voelker, G.M.: Beyond blacklists: learning to detect
malicious web sites from suspicious URLs. In: Proceedings of the 15th ACM
SIGKDD International Conference on Knowledge Discovery and Data Mining
(KDD), June 2009
27. Mandiant. APT1. Technical report (2013). http://intelreport.mandiant.com/
Mandiant APT1 Report.pdf
28. Nadji, Y., Antonakakis, M., Perdisci, R., Lee, W.: Connected colors: unveiling the
structure of criminal networks. In: Stolfo, S.J., Stavrou, A., Wright, C.V. (eds.)
RAID 2013. LNCS, vol. 8145, pp. 390–410. Springer, Heidelberg (2013)
29. Plonka, D., Barford, P.: Context-aware clustering of DNS query traﬃc. In: Pro-
ceedings of the 8th ACM SIGCOMM Conference on Internet Measurement, IMC
2008, pp. 217–230. ACM, New York (2008)
30. Prakash, P., Kumar, M., Kompella, R.R., Gupta, M.: Phishnet: predictive black-
listing to detect phishing attacks. In: Proceedings of IEEE INFOCOM, 2010, pp.
1–5. IEEE (2010)
31. Rahbarinia, B., Perdisci, R., Antonakakis, M.: Segugio: eﬃcient behavior-based
tracking of malware-control domains in large ISP networks. In: 2015 45th
Annual IEEE/IFIP International Conference on Dependable Systems and Net-
works (DSN), pp. 403–414, June 2015
32. Rekhter, Y., Moskowitz, B., Karrenberg, D., de Groot, G.J., Lear, E.: Address
Allocation for Private Internets. RFC 1918 (Best Current Practice), Updated by
RFC 6761, February 1996
33. Minerva Labs & ClearSky Cyber Security: CopyKittens Attack Group (2015).
https://eforensicsmag.com/copykittens/
208
A. Kountouras et al.
34. Weil, J., Kuarsingh, V., Donley, C., Liljenstolpe, C., Azinger, M.: IANA-Reserved
IPv4 Preﬁx for Shared Address Space. RFC 6598 (Best Current Practice), April
2012
35. Weimer, F.: Passive DNS replication. In: Proceedings of the 17th First Conference
on Computer Security Incident Handling, June 2005
36. Zdrnja, B., Brownlee, N., Wessels, D.: Passive monitoring of DNS anomalies. In:
H¨ammerli, B.M., Sommer, R. (eds.) DIMVA 2007. LNCS, vol. 4579, pp. 129–139.
Springer, Heidelberg (2007)