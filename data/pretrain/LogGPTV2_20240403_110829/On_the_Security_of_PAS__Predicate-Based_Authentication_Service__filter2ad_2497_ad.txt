1, (N − 1)
(cid:18)L
(cid:19)
LX
(cid:17)
i=1(|P∗| − 1)
When ˆt is close to 1, the above lower bound is generally
equal to 0. But as ˆt becomes larger, the lower bound quickly
converges to 1. Taking the default parameters and assuming
= ˆtρˆtN1/2lnr, we calculated the
L = E
above lower bound for ˆt = 1, . . . , 10. For each value of ˆt,
 . (3)
0(1 − q0)L−i
qi
(cid:16)Pˆt
= 1 − min
≥ 1 − min
i=ˆt+1
1,
i=2
i
216
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:10:53 UTC from IEEE Xplore.  Restrictions apply. 
Pr(cid:2)maxN
i=2(#(Oi)) ≤ #(O1) + ˆt(cid:3): THEORETICAL BOUND AND
Table VI
EXPERIMENTAL ESTIMATION.
ˆt
Theoretical lower bound
Experimental estimation
1
0
2
0
0.0504
0.2915
3
4
0.9473
0.9604
0.9997
0.9999
≥ 5
1
1
E(Nmax): THEORETICAL BOUND AND EXPERIMENTAL ESTIMATION.
Table VII
ˆt
Theoretical upper bound
Experimental estimation 3.6846 3.6184 1.7168 1.0086
607.1
6.842 1.012
1
625
2
625
3
4
5 ≥ 6
1
1
1
10000 random experiments were made to see how large the
real probabilities are. Table VI shows the results.
Following a similar argument, we can also get:
Pr(cid:2)∃i ∈ {2, . . . , N}, #(Oi) ≥ #(O1) + ˆt(cid:3) ≤
(cid:18)
1, (N − 1)XL
(cid:18)L
(cid:19)
0(1 − q0)L−i
qi
.
(4)
(cid:19)
min
i=ˆt
i
i
i=ˆt
(cid:16)
i , . . . , P∗
ˆt ,
1, (N − 1)PL
Then, assuming there are Nmax cell-index vectors occurring
most often in P∗
i.e., Nmax is the cardinality
of the set {i|#(Oi) = maxM p
j=1 #(Oj)}, we can get an
upper bound of its mean: E(Nmax) ≤ 1 + (M p − 1) ·
min
. For the default
setting of the PAS scheme and ˆt = 1, . . . , 10, Table VII
shows the theoretical upper bound and the real value of
E(Nmax) estimated from 10000 random experiments.
0(1 − q0)L−i(cid:17)
(cid:0)L
(cid:1)qi
The data in Tables VI and VII imply that one can recover
the secret cell-index vector with high probability with only
3 observed authentication sessions.
C. Complexity Analysis
The computational complexity of the proposed probabilistic
attack is the sum of the complexity of all the three steps.
The complexity of Step 1 is ˆt(M H)p, which is the maximal
number of p-predicate vectors one has to check for all the
ˆt observed authentication sessions to get Pi. After Step 1
is ﬁnished, the average size of each Pi is 1 + N1/2lnr,
so the average complexity of Step 2 is ˆt(cid:0)1 + N1/2lnr(cid:1).
Pˆt
i=1 |P∗
The complexity of Step 3a is very small, so it can be
omitted. The ranking done in Step 3b has a complexity
. The worst-case complexi-
ties of Step 2 and 3b are always less than the complexity of
Step 1. As a whole, we can see the overall complexity of the
attack is determined by Step 1, which has an upper bound
O(ˆt(M H)p). For the default setting of the PAS basic scheme
and ˆt = 4, the complexity is O(ˆt(M H)p) = O(220.7).
Since the size of the password space of the basic PAS
scheme is len · (M H)p, the complexity of the probabilistic
attack is always strictly smaller than that of the brute force
attack since ˆt < len always holds.
1 + ρˆtN1/2lnr
i | = ˆt
(cid:17)
(cid:16)
THE SUCCESS RATE OF BREAKING THE SECRET CELL-INDEX VECTOR
AND THE NUMBER OF CANDIDATES ESTIMATED FROM REAL ATTACKS.
Table VIII
1
ˆt
10
Success rate 0.012 0.035 0.071 0.13 0.24 0.41 0.60 0.76 0.86 0.94
2.02 1.73 1.51 1.36 1.23 1.10 1.03 1.01
Number
3.01
2.51
2
3
4
9
5
6
7
8
D. Experimental Results
Based on the above theoretical analysis and the complexity
estimation, we can see the attack is feasible as long as
(M H)p is not cryptographically large. This condition is
satisﬁed for the default setting of the PAS scheme.
We developed a MATLAB implementation of the basic
PAS scheme with p = 2, and tested the real performance of
the proposed probabilistic attack. On a PC with a 2.4GHz
Intel Core2 Duo CPU and 2GB memory, one successful
attack with ˆt observed authentication sessions consumes
only 5ˆt seconds. The MATLAB code is available at http:
//www.hooklee.com/Papers/Data/PAS.zip.
The statistical results of 1000 real attacks targeting the
default setting of the basic PAS scheme are shown in
Table VIII. It turned out that the real performance is worse
than the theoretical analysis obtained in Section V-B2. We
attribute this to the deviation of real attacks from some
of the theoretical assumptions we made in the theoretical
analysis in Section V-B2. For instance, we calculate the
values in Table VI by assuming E(|P∗
i |) = 1 + ρˆtN1/2lnr
and L = ˆtρˆtN1/2lnr, but in practice their values vary in a
wide range around the means. Despite the mismatch between
Table VIII and Table VI, we can see the success rate of
breaking the secret cell-index pair and the average number of
candidates follow the same pattern as the data in Table VII.
The data in Table VIII show that 7 observed authentication
sessions are enough to break the secret cell-index pair with
probability greater than 50%. Even with only two observed
authentication sessions,
the success rate is high enough
(3.5%) to threaten a considerable percentage of users.
E. Consequences of the Probabilistic Attack
Note that it is impossible and unnecessary to break the
whole password with the probabilistic attack, since some
secret characters will never occur until the last authentication
session. In fact, the main consequence of breaking the secret
cell indices is the following: the password becomes a set
of len words {W ∗
j=1, each of which
is used for exactly one authentication session. After all the
len words {W ∗
j }len
j=1 are used up, a new password have to
be issued to the user. Clearly, this means PAS now works
essentially like a one-time password (OTP) system, where
each word W ∗
is the OTP used for each authentication
session and expires immediately after being used.
j = w1[j]··· wp[j]}len
j
The degradation of the PAS scheme to an OTP-like system
has several consequences. First, this fact disqualiﬁes PAS
217
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:10:53 UTC from IEEE Xplore.  Restrictions apply. 
as a better solution than common OTP systems. Second,
the downgraded PAS scheme is still a challenge-response
protocol, which asks the user to go through the same process
as in the original PAS scheme. In comparison, common OTP
systems are not based on a challenge-response structure and
the user is simply asked to input the dynamic password in
an input box, so the usability is much better. Third, the
downgraded PAS scheme offers a lower security against
random guess attack. We can derive that the success rate
of the downgraded PAS scheme becomes
1
2lnr
+
2lnr − 1
2lnr(cid:0)H+k−1
(cid:1)p
k
(5)
Comparing the above equation with Eq. (1), we can see
the success rate becomes larger. For the default parameters,
Eq. (1) is around 9.7893 × 10−4, but Eq. (5) is around
2.4544 × 10−3, nearly 2.5 times larger. To maintain the
same level of security, the parameters have to be increased
accordingly, which will make usability even worse.
VI. Conclusion
In this paper, we re-evaluate the security of the predicate-
based authentication service (PAS) proposed in [3]. We show
that PAS is insecure against both brute force attack and a
probabilistic attack. The probabilistic attack can break part
of the password even with a small number of observed
authentication sessions. The breaking of part of the password
downgrades PAS to an OTP-like system, thus nullifying its
main advantages over common OTP systems.
It is possible to enhance security of PAS by increasing
the values of some parameters, unfortunately, which will
decrease usability and make the system not useful as a
practical solution. This problem about curse of usability is
the main reason why it is very difﬁcult to design a both se-
cure and usable authentication system secure against passive
adversaries who can observe all authentication sessions.
Acknowledgments
Shujun Li was supported by a fellowship from the Zukun-
ftskolleg of the University of Konstanz, Germany, which is
part of the “Excellence Initiative” Program of the DFG (Ger-
man Research Foundation). Hassan Jameel Asghar was sup-
ported by an MQRES (Macquarie University Research Ex-
cellence Scholarships) International PhD Scholarship. Josef
Pieprzyk was supported by the Australia Research Council
under Grant DP0987734. Ahmad-Reza Sadeghi was sup-
ported by the EU project CACE (Computer Aided Cryptog-
raphy Engineering, http://www.cace-project.eu). Huaxiong
Wang was supported by the National Research Foundation
of Singapore under Research Grant NRF-CRP2-2007-03 and
the Singapore Ministry of Education under Research Grant
T206B2204.
218
References
[1] T. Matsumoto and H. Imai. Human identiﬁcation through
In Advances in Cryptology – EURO-
insecure channel.
CRYPT’91, volume 547 of LNCS, pages 409–421. Springer-
Verlag, 1991.
[2] S. Li and H.-Y. Shum. Secure human-computer identiﬁcation
against peeping attacks (SecHCI): A survey. http://www.
hooklee.com/Papers/SecHCI-Survey.pdf, 2003.
[3] X. Bai et al. PAS: predicate-based authentication services
against powerful passive adversaries. In Proc. ACSAC’2008,
pages 433–442. IEEE Computer Society, 2008.
[4] C.-H. Wang, T. Hwang, and J.-J. Tsai. On the Matsumoto
In Advances in
and Imai’s human identiﬁcation scheme.
Cryptology – EUROCRYPT’95, volume 921 of LNCS, pages
382–392. Springer-Verlag, 1995.
[5] T. Matsumoto. Human-computer cryptography: An attempt.
In Proc. ACM CCS’96, pages 68–75. ACM, 1996.
[6] N. J. Hopper and M. Blum. Secure human identiﬁcation
protocols. In Advances in Cryptology – ASIACRYPT 2001,
volume 2248 of LNCS, pages 52–66. Springer-Verlag, 2001.
[7] X.-Y. Li and S.-H. Teng. Practical human-machine identiﬁca-
tion over insecure channels. J. Combinatorial Optimization,
3(4):347–361, 1999.
[8] S. Li and H.-Y. Shum. Secure human-computer identiﬁcation
(interface) systems against peeping attacks: SecHCI. IACR’s
Cryptology ePrint Archive: Report 2005/268, 2005.
[9] H. Jameel, R. Shaikh, H. Lee, and S. Lee. Human identiﬁ-
cation through image evaluation using secret predicates. In
Topics in Cryptology – CT-RSA 2007, volume 4377 of LNCS,
pages 67–84. Springer-Verlag, 2007.
[10] Hassan Jameel et al.
Image-feature based human identiﬁ-
cation protocols on limited display devices. In Information
Security Applications (WISA’2008), volume 5379 of LNCS,
pages 211–224. Springer-Verlag, 2009.
[11] D. Weinshall. Cognitive authentication schemes safe against
In Proc. IEEE S&P’2006, pages 295–300. IEEE
spyware.
Computer Society, 2006.
[12] P. Golle and D. Wagner. Cryptanalysis of a cognitive
authentication scheme. In Proc. IEEE S&P’2007, pages 66–
70. IEEE Computer Society, 2007.
[13] R. Dhamija and A. Perrig. D´ej`a Vu: A user study using
In Proc. 9th USENIX Security
images for authentication.
Symposium, pages 45–58. USENIX, 2000.
[14] V. Roth, K. Richter, and R. Freidinger. A PIN-entry method
resilient against shoulder surﬁng. In Proc. ACM CCS’2004,
pages 236–245. ACM, 2004.
[15] D. Lin, P. Dunphy, P. Olivier, and J. Yan. Graphical pass-
words & qualitative spatial relations. In Proc. SOUPS’2007,
pages 161–162. ACM, 2007.
[16] H. Zhao and X. Li. S3PAS: A scalable shoulder-surﬁng
resistant textual-graphical password authentication scheme.
In Proc. AINAW’2007, volume 2, pages 467–472, 2007.
[17] E. Hayashi, R. Dhamija, N. Christin, and A. Perrig. Use Your
In Proc.
Illusion: Secure authentication usable anywhere.
SOUPS’2008, pages 35–45. ACM, 2008.
[18] A. De Luca and B. Frauendienst. A privacy-respectful input
method for public terminals. In Proc. NordiCHI’2008, pages
455–458. ACM, 2008.
[19] H. Sasamoto, N. Christin, and E. Hayashi. Undercover:
Authentication usable in front of prying eyes. In Proc. ACM
CHI’2008, pages 183–192. ACM, 2008.
[20] D. Florˆencio and C. Herley. A large-scale study of web
password habits. In Proc. WWW’2007, pages 657–665, 2007.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 13:10:53 UTC from IEEE Xplore.  Restrictions apply.