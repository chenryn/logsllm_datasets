Active Directory的安全始于能确保安全地配置域控制器（DC）。 在今年夏天的BlackHat
USA大会上，我非常专业的提到了AD的安全，并提供了关于如何能够最好程度上保护Active Directory安全的一些提示。
这篇文章主要关注域控制器的安全性和一些跨越Active Directory的安全性。毕竟我的博客被称为“ADSecurity” …
本文将会涵盖一些通过保护域控制器（简称“域控”）来保护Active Directory安全性的最佳方法，包括以下几个部分：
    默认域和域控制器策略
    创建域和域控制器安全基线GPO
    修补域控制器
    保护域控制器
    域控制器推荐的组策略设置
    配置域控制器审查模式（事件日志）
    需要监控的域控制器事件（事件日志）
    关键域控制器安全项
与基础架构的任何重大更改一样，请在部署更改之前进行测试。以免发生意外。
**推荐的域控制器组策略设置**
本节涵盖了推荐的域控制器安全设置，其中有许多安全设置是在SCM中的Microsoft安全基准中进行了描述和设置。
请在应用这些设置前进行完整的测试。
**启用NTLM审查**
限制NTLM：审查收到的NTLM流量：启用对所有帐户的审查
此策略设置允许你审核传入的NTLM流量。
至少在Windows 7或Windows Server 2008 R2以上支持此策略。
注意：审计事件被记录在此计算机上位于应用程序和服务日志/Microsoft/Windows/ NTLM下的“操作”日志中。
**限制NTLM：审查此域中的NTLM身份验证：启用所有**
此策略设置允许你从此域控制器中审核该域中的NTLM身份验证。
此策略至少在Windows Server 2008 R2上受支持。
注意：该审计事件被记录在此计算机上位于应用程序和服务日志/ Microsoft / Windows / NTLM下的“操作”日志中。
**LAN Manager认证级别：仅发送NTLMv2响应。拒绝LM＆NTLM**
默认情况下，此配置设置为“仅发送NTLMv2响应”。
在Microsoft安全合规性管理器中，Microsoft建议将此配置设置为“仅发送NTLMv2响应。拒绝LM＆NTLM。然而，许多网络环境中仍在使用NTLMv1进行身份验证，因此可能需要启用NTLM身份验证审查模式以识别在企业中是如何使用NTLM进行身份验证的。
LAN
Manager（LM）是一个早期的Microsoft客户端/服务器软件系列，它允许用户在单个网络上将个人计算机链接在一起。网络功能包括传输文件和打印共享，用户安全功能和网络管理工具。在Active
Directory域中，Kerberos协议是默认的身份验证协议。但是，如果Kerberos协议由于某种原因未协商，Active
Directory将使用LM，NTLM或NTLMv2。
LAN
Manager身份验证包括LM，NTLM和NTLM版本2（NTLMv2）变体，并且是用于在执行以下操作时对所有的Windows客户端进行身份验证的协议：
    加入域
    在Active Directory林之间进行身份验证
    对下级域进行身份验证
    验证不运行Windows 2000，Windows Server 2003或Windows XP的计算机
    向不在域中的计算机进行身份验证
    对于网络安全性：LAN Manager进行身份验证的级别设置的可能值有如下几个：
    发送LM和NTLM响应
    发送LM＆NTLM - 如果协商则使用NTLMv2会话安全
    仅发送NTLM响应
    仅发送NTLMv2响应
    仅发送NTLMv2响应\拒绝LM
    仅发送NTLMv2响应\拒绝LM和NTLM
    未定义的
网络安全：LAN
Manager认证级别设置用于确定用于网络登录的挑战或响应认证协议。此选项影响客户端使用的身份验证协议级别，计算机协商的会话安全级别以及服务器接受的身份验证级别如下：
\1. 发送LM和NTLM响应。客户端使用LM和NTLM身份验证，并且从不使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2身份认证。
\2. 发送LM＆NTLM –
如果协商使用NTLMv2会话安全。客户端使用LM和NTLM进行身份验证，如果服务器支持的话，则会使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2身份认证。
\3. 仅发送NTLM响应。客户端仅使用NTLM身份验证，如果服务器支持，则使用NTLMv2会话安全性。域控制器接受LM，NTLM和NTLMv2认证。
\4.
仅发送NTLMv2响应。客户端仅使用NTLMv2进行身份验证，如果服务器支持的话，则会使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2身份认证。
\5.
仅发送NTLMv2响应\拒绝LM。客户端仅使用NTLMv2进行身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器拒绝LM（仅接受NTLM和NTLMv2身份验证）。
\6.
仅发送NTLMv2响应\拒绝LM＆NTLM。客户端仅使用NTLMv2进行身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器拒绝LM和NTLM（仅接受NTLMv2身份验证）。
这些设置对应于在其他Microsoft文档中讨论的级别如下：
\1. Level 0 –
发送LM和NTLM响应;从不使用NTLMv2安全会话。客户端使用LM和NTLM进行身份验证，并且从不使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2身份认证。
\2. Level 1 –
如果协商使用NTLMv2安全会话。客户端则使用LM和NTLM进行身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2身份认证。
\3. Level 2 –
仅发送NTLM响应。客户端仅使用NTLM身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2认证。
\4. Level 3 –
仅发送NTLMv2响应。客户端使用NTLMv2进行身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器接受LM，NTLM和NTLMv2认证。
\5. Level 4 –
域控制器拒绝LM响应。客户端使用NTLM进行身份验证，如果服务器支持，则使用NTLMv2安全会话。域控制器拒绝LM身份认证，也就是说，只接受NTLM和NTLMv2。
\6. Level 5 –
域控制器拒绝LM和NTLM响应（仅接受NTLMv2）。如果服务器支持，客户端使用NTLMv2进行身份验证并使用NTLMv2安全会话。域控制器拒绝NTLM和LM身份验证（只接受NTLMv2）。
**Lsass.exe审核模式：启用**
启用“Lsass.exe审核模式”以确定在启用LSA保护时可能阻止的程序。