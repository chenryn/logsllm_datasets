in the BitTorrent trafﬁc curve is strongly correlated with
increased relative cost of that trafﬁc.
95th-percentile costs. Relative costs greater than 1 mean that
BitTorrent is contributing more to setting the 95th-percentile costs
than all the rest of the trafﬁc crossing the link.
Figure 16 shows the results of this analysis for two providers
and two customers of ISP T . Among these results, we ﬁnd
signiﬁcant diversity in terms of the relative cost of BitTorrent,
ranging from 0.95 (relatively less expensive) to over 1.5 (relatively
more expensive). In general, BitTorrent tends to be relatively more
expensive than the rest of trafﬁc on the link. Note that as we
increase the percent of BitTorrent trafﬁc, the relative cost metric
by deﬁnition approaches 1, which explains the downward trends in
the ﬁgures.
To explain the diversity of the relative cost of BitTorrent trafﬁc
over different links, we characterize each of our BitTorrent traces
by its variations over time, as well as how it aligns with the overall
trafﬁc on the link. To represent how much BitTorrent trafﬁc varies
over time for each link, we use the coefﬁcient of variation (i.e.,
the normalized dispersion of values in a distribution). To capture
the temporal alignment between BitTorrent trafﬁc and total trafﬁc,
we conduct a cross-correlation analysis between normalized time-
series of trafﬁc data and report the time offset at which we found the
peak overlap between BitTorrent and total trafﬁc. Negative offsets
occur if the peak in BitTorrent trafﬁc appears later than the total
trafﬁc.
Table 6 shows the results of these analyses for all of ISP T ’s links
that we study, sorted by increasing relative cost (when BitTorrent
is scaled to 10% of total trafﬁc). The relatively small values (e.g.,
≤ 2) in the third column indicate that the peak trafﬁc for BitTorrent
indeed coincides with peak volumes for the rest of trafﬁc for most
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1CDF [X ≤ x]Proportion of TrafficCustomerPeerProvider 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1CDF [X ≤ x]Proportion of TrafficCustomerPeerProvider 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1CDF [X ≤ x]Proportion of TrafficCustomerPeerProvider119(a) Provider A to ISP T
(b) Provider B to ISP T
(c) ISP T to Customer C
(d) ISP T to Customer D
Figure 16: Trends in the relative cost of BitTorrent trafﬁc for links between ISP T and several of its providers and customers, as we
scale BitTorrent trafﬁc to various percentages of the total link trafﬁc.
of these links. Moreover, we ﬁnd that larger variations in BitTorrent
trafﬁc (i.e., burstiness captured by the coefﬁcient of variation
metric) correlate strongly with higher relative cost. Customer E is
the only exception to this trend, which can be explained by the fact
that Customer E’s BitTorrent trafﬁc is more closely aligned with
total trafﬁc (according to the cross correlation metric) than either
Provider B or Customer F.
6.5 Summary
In summary, this section showed that capturing the impact of
BitTorrent on network costs requires a global view of where trafﬁc
ﬂows as well as an understanding of the business relationships and
charging billing models used. We found that large portions of
BitTorrent trafﬁc ﬂow over settlement-free links, and the portion of
interdomain trafﬁc generating charges varies signiﬁcantly among
ISPs. This analysis also shows that the recent trend toward more
diurnal usage patterns leads to trafﬁc that is closely aligned with
peak usage for other Internet trafﬁc, which has a signiﬁcant impact
on the common 95th-percentile charging model. While the relative
cost of BitTorrent trafﬁc is variable, we found it to be generally
more expensive than other trafﬁc for links we evaluated.
These results can inform ISPs’ decisions about the impact and
efﬁcacy of speciﬁc trafﬁc management policies. Our BitTorrent-
focused analysis is an example of how applications can have varied
impacts on ISP costs, based on when the trafﬁc occurs.
7. CONCLUSION
In this paper, we demonstrated the importance of a compre-
hensive view when evaluating the network impact of a globally
distributed system like BitTorrent. By incorporating application
traces gathered from hundreds of thousands of IPs, we answered
key questions regarding trends in BitTorrent’s trafﬁc volumes and
user behavior, where BitTorrent trafﬁc ﬂows, and whether such
trafﬁc incurs net costs or produces revenue for ISPs.
This unique view allowed us to reveal several properties of
the system previously hidden from studies based on limited per-
spectives. First, we used a longitudinal view of user behavior
to show that the BitTorrent system continues to evolve, both in
terms of when and where the application is being used. We then
evaluated the impact of this behavior on where BitTorrent trafﬁc
ﬂows geographically and topologically, an analysis that requires
extensive traceroutes between P2P users. We found that despite its
global reach, BitTorrent is able to remain local for large portions of
its trafﬁc. Further, our results show that most trafﬁc generated by
BitTorrent users stays at or below tier 3. Some of our results call
into question the ability of in-network monitoring approaches to
capture salient features of widely distributed systems, particularly
when deployed in higher Internet tiers.
Last, we evaluated the economic impact of BitTorrent trafﬁc on
ISPs’ variable costs. Using inferred business relationships between
ISPs, we showed that most BitTorrent trafﬁc ﬂows over cost-free
paths and that it generates substantial revenue potential for many
higher tier ISPs. We also highlighted the importance of the tem-
poral pattern behind the generated trafﬁc under the common 95th-
percentile charging model. By combining traces from operational
interdomain links with our corresponding BitTorrent traces, we
determined that the relative cost of BitTorrent is variable and tended
to be higher than other trafﬁc for several ISPs.
In summary, we emphasize that no single aspect of this study
alone – application traces, topology information and in-network
traces – were sufﬁcient to develop a complete picture of a widely
distributed system such as BitTorrent. Only in combination did
these perspectives allow us to view the system as a whole and its
impact on the network.
8. ACKNOWLEDGEMENTS
We would like to thank our shepherd, Augustin Chaintreau, and
the anonymous reviewers for their detailed and helpful feedback.
We are always grateful to Paul Gardner for his assistance with
Vuze and the users of our software for their invaluable data. This
work was supported in part by NSF Awards CNS 0644062, CNS
0917233 and CNS 0855253.
9. REFERENCES
[1] V. Aggarwal, A. Feldmann, and C. Scheideler. Can ISPs and
P2P users cooperate for improved performance? SIGCOMM
Comput. Commun. Rev., 37(3):29–40, 2007.
[2] R. Bindal, P. Cao, W. Chan, J. Medved, G. Suwala, T. Bates,
and A. Zhang. Improving trafﬁc locality in BitTorrent via
biased neighbor selection. In Proc. of ICDCS, 2006.
[3] K. Chen, D. Choffnes, R. Potharaju, Y. Chen, F. Bustamante,
and Y. Zhao. Where the sidewalk ends: Extending the
Internet AS graph using traceroutes from P2P users. In Proc.
of ACM CoNEXT, 2009.
[4] D. Choffnes, F. Bustamante, and Z. Ge. Using the crowd to
monitor the cloud: Network event detection from edge
systems. In Proc. of ACM SIGCOMM, 2010.
[5] D. R. Choffnes and F. E. Bustamante. Taming the torrent: A
practical approach to reducing cross-ISP trafﬁc in
peer-to-peer systems. In Proc. of ACM SIGCOMM, 2008.
125102030BT%ofTotalTrafﬁc0.80.91.01.11.21.31.41.51.6RelativeCost125102030BT%ofTotalTrafﬁc0.80.91.01.11.21.31.41.51.6RelativeCost125102030BT%ofTotalTrafﬁc0.80.91.01.11.21.31.41.51.6RelativeCost125102030BT%ofTotalTrafﬁc0.80.91.01.11.21.31.41.51.6RelativeCost120[6] R. Cuevas, N. Laoutaris, X. Yang, G. Siganos, and
P. Rodriguez. Deep diving into BitTorrent locality. In Proc.
of IEEE INFOCOM, 2011.
[7] A. Dhamdhere and C. Dovrolis. Ten years in the evolution of
the Internet ecosystem. In Proc. of IMC, 2008.
[8] A. Dhamdhere and C. Dovrolis. The Internet is Flat:
Modeling the transition from a transit hierarchy to a peering
mesh. In Proc. of ACM CoNEXT, 2010.
[9] X. Dimitropoulos, P. Hurley, A. Kind, and M. P. Stoecklin.
On the 95-percentile billing method. In Proc. of PAM, 2009.
[10] EdgeScope – sharing the view from a distributed Internet
telescope. http://www.aqualab.cs.
northwestern.edu/projects/EdgeScope.html.
[11] L. Guo, S. Chen, Z. Xiao, E. Tan, X. Ding, and X. Zhang.
Measurements, analysis, and modeling of BitTorrent-like
systems. In Proc. of IMC, 2005.
[12] M. Izal, G. Urvoy-Keller, E. Biersack, P. Felber, A. Hamra,
and L. Garces-Erice. Dissecting BitTorrent: Five months in a
torrent’s lifetime. In Proc. of PAM, 2004.
[13] T. Karagiannis, P. Rodriguez, and K. Papagiannaki. Should
Internet service providers fear peer-assisted content
distribution? In Proc. of IMC, 2005.
[14] H. Kim, k. Claffy, M. Fomenkov, D. Barman, M. Faloutsos,
and K. Lee. Internet trafﬁc classiﬁcation demystiﬁed: myths,
caveats, and the best practices. In Proc. of ACM CoNEXT,
2008.
[15] C. Labovitz, S. Iekel-Johnson, J. Oberheide, and F. Jahanian.
Internet inter-domain trafﬁc. In Proc. of ACM SIGCOMM,
New Delhi, India, August 2010.
[16] S. Le Blond, A. Legout, and W. Dabbous. Pushing BitTorrent
Locality to the Limit. http://hal.inria.fr/inria-
00343822/PDF/bt_locality.pdf.
[17] G. Maier, A. Feldmann, V. Paxson, and M. Allman. On
dominant characteristics of residential broadband Internet
trafﬁc. In Proc. of IMC, 2009.
[18] M. Piatek, H. V. Madhyastha, J. P. John, A. Krishnamurthy,
and T. Anderson. Pitfalls for ISP-friendly P2P design. In
Proc. of HotNets, 2009.
[19] J. A. Pouwelse, P. Garbacki, D. H. J. Epema, and H. J. Sips.
The BitTorrent P2P ﬁle-sharing system: Measurements and
analysis. In Proc. of IPTPS, 2005.
[20] D. Qiu and R. Srikant. Modeling and performance analysis
of BitTorrent-like peer-to-peer networks. In Proc. of ACM
SIGCOMM, 2004.
[21] H. Schulze and K. Mochalski. ipoque: Internet study 2007,
Nov. 2007. http:
//www.ipoque.com/media/internet_studies.
[22] H. Schulze and K. Mochalski. ipoque: Internet study
2008/2009, Nov. 2009. http:
//www.ipoque.com/media/internet_studies.
[23] R. Stanojevic, N. Laoutaris, and P. Rodriguez. On economic
heavy hitters: Shapley value analysis of 95th-percentile
pricing. In Proc. of IMC, 2010.
[24] Team Cymru. The Team Cymru IP to ASN lookup page.
http://www.cymru.com/BGP/asnlookup.html.
[25] R. D. Torres, M. Y. Hajjat, S. G. Rao, M. Mellia, and M. M.
Munafo. Inferring undesirable behavior from P2P trafﬁc
analysis. In Proc. of ACM SIGMETRICS, 2009.
[26] University of Oregon Route Views project.
http://www.routeviews.org/.
[27] uTorrent still on top, BitComet’s market share plummets.
http://torrentfreak.com/utorrent-still-
on-top-bitcomets-market-share-plummets-
090814/.
[28] Vuze, Inc. Vuze. http://www.vuze.com.
[29] J. Xia and L. Gao. On the evaluation of AS relationship
inferences. In In Proc. of IEEE GLOBECOM, 2004.
[30] H. Xie, R. Yang, A. Krishnamurthy, Y. Liu, and
A. Silberschatz. P4P: Provider portal for P2P applications. In
Proc. of ACM SIGCOMM, 2008.
[31] C. Zhang, P. Dhungel, D. Wu, and K. W. Ross. Unraveling
the BitTorrent ecosystem. IEEE Transaction on Parallel and
Distributed Systems, July 2011. To appear.
APPENDIX
A.
95TH-PERCENTILE AND SHAPLEY
95th-percentile billing is one of the most common models used
by providers to charge for trafﬁc over interdomain links [9].
Under this billing model, costs are determined by near-peak usage,
calculated by the 95th-percentile value at ﬁxed intervals (e.g. 5
minute bins) over each billing cycle (usually 1 month). As a result,
the effective cost of each byte of trafﬁc varies depending on the
particular time of day – bytes sent during times of high usage are
more expensive than off-peak bytes.
Following the approach in [23], we use the game-theoretic con-
cept of Shapley value to compute the average marginal cost con-
tribution of individual classes of trafﬁc under the 95th-percentile
billing model.3 This is obtained by averaging the marginal increase
in 95th-percentile cost over all possible “arrival orders” for the
classes of trafﬁc being examined.
In our study of “BT” and “Other” trafﬁc, we have two arrival
orders:
[BT, Other] and [Other, BT]. Given a function v95th
that returns the 95th-percentile value of a series of bandwidth
measurements, we compute the Shapley value of BitTorrent trafﬁc
by averaging the marginal contributions:
m1 = v95th(BT )
m2 = v95th(Other + BT ) − v95th(Other)
SVBT = (m1 + m2)/2
Since the Shapley value is efﬁcient (i.e.
the sum of the average
marginal costs equals the total cost), we can compute the proportion
of the total cost attributable to BitTorrent trafﬁc:
pBT = SVBT /(SVBT + SVOther)
Finally, we compare the proportion of total cost attributable to
BitTorrent trafﬁc relative to the overall fraction of BitTorrent trafﬁc
fBT carried over the network:
Relative CostBT = pBT /fBT
When the relative cost of BitTorrent is > 1, that means that
increases in BitTorrent trafﬁc are temporally aligned with increases
in the total trafﬁc (typically during waking hours) and BitTorrent
trafﬁc is comparatively more expensive than other trafﬁc. Likewise,
a relative cost < 1 means that BitTorrent trafﬁc is comparatively
less expensive than other trafﬁc, and tends to occur during off-peak
(e.g,. overnight) periods.
3This analysis is general to any such cost model.
121