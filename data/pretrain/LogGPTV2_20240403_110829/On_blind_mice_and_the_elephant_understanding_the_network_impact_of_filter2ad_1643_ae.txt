### 95th-Percentile Costs and BitTorrent Traffic

The relative cost of BitTorrent traffic is strongly correlated with the 95th-percentile costs. When the relative cost exceeds 1, it indicates that BitTorrent contributes more to setting the 95th-percentile costs than all other traffic on the link.

### Analysis of Relative Costs

Figure 16 presents the results of this analysis for two providers and two customers of ISP T. The relative cost of BitTorrent varies significantly, ranging from 0.95 (relatively less expensive) to over 1.5 (relatively more expensive). Generally, BitTorrent tends to be more expensive than other traffic on the link. As the percentage of BitTorrent traffic increases, the relative cost metric approaches 1, which explains the downward trends in the figures.

### Factors Affecting Relative Cost

To understand the diversity in the relative cost of BitTorrent traffic across different links, we characterized each BitTorrent trace by its variations over time and how it aligns with the overall traffic on the link. We used the coefficient of variation (normalized dispersion of values in a distribution) to represent the variability of BitTorrent traffic over time. To capture the temporal alignment between BitTorrent and total traffic, we conducted a cross-correlation analysis between normalized time-series of traffic data and reported the time offset at which the peak overlap occurred. Negative offsets indicate that the peak in BitTorrent traffic appears later than the total traffic.

### Results of the Analysis

Table 6 shows the results of these analyses for all of ISP T's links, sorted by increasing relative cost (when BitTorrent is scaled to 10% of total traffic). The relatively small values (e.g., ≤ 2) in the third column indicate that the peak traffic for BitTorrent coincides with the peak volumes for the rest of the traffic for most of these links. Additionally, larger variations in BitTorrent traffic (i.e., burstiness captured by the coefficient of variation metric) correlate strongly with higher relative costs. Customer E is the only exception, as its BitTorrent traffic is more closely aligned with total traffic according to the cross-correlation metric.

### Summary

In summary, this section highlights that understanding the impact of BitTorrent on network costs requires a comprehensive view of traffic flows, business relationships, and billing models. We found that large portions of BitTorrent traffic flow over settlement-free links, and the portion of interdomain traffic generating charges varies significantly among ISPs. The recent trend toward more diurnal usage patterns means that BitTorrent traffic is closely aligned with peak usage for other Internet traffic, which significantly impacts the 95th-percentile charging model. While the relative cost of BitTorrent traffic is variable, it is generally more expensive than other traffic for the links we evaluated.

### Conclusion

This study demonstrates the importance of a comprehensive view when evaluating the network impact of a globally distributed system like BitTorrent. By incorporating application traces from hundreds of thousands of IPs, we answered key questions regarding trends in BitTorrent's traffic volumes and user behavior, where BitTorrent traffic flows, and whether such traffic incurs net costs or produces revenue for ISPs.

Our unique perspective revealed several properties of the system previously hidden from studies based on limited perspectives. We showed that BitTorrent continues to evolve in terms of when and where the application is used. Despite its global reach, BitTorrent remains local for large portions of its traffic, and most traffic generated by BitTorrent users stays at or below tier 3. Our results also call into question the ability of in-network monitoring approaches to capture salient features of widely distributed systems, particularly when deployed in higher Internet tiers.

Finally, we evaluated the economic impact of BitTorrent traffic on ISPs' variable costs. Using inferred business relationships between ISPs, we showed that most BitTorrent traffic flows over cost-free paths and generates substantial revenue potential for many higher-tier ISPs. We highlighted the importance of the temporal pattern behind the generated traffic under the common 95th-percentile charging model. By combining traces from operational interdomain links with our corresponding BitTorrent traces, we determined that the relative cost of BitTorrent is variable and tended to be higher than other traffic for several ISPs.

In conclusion, no single aspect of this study—application traces, topology information, or in-network traces—was sufficient to develop a complete picture of a widely distributed system such as BitTorrent. Only in combination did these perspectives allow us to view the system as a whole and its impact on the network.

### Acknowledgements

We would like to thank our shepherd, Augustin Chaintreau, and the anonymous reviewers for their detailed and helpful feedback. We are grateful to Paul Gardner for his assistance with Vuze and the users of our software for their invaluable data. This work was supported in part by NSF Awards CNS 0644062, CNS 0917233, and CNS 0855253.

### References

[1] V. Aggarwal, A. Feldmann, and C. Scheideler. Can ISPs and P2P users cooperate for improved performance? SIGCOMM Comput. Commun. Rev., 37(3):29–40, 2007.
[2] R. Bindal, P. Cao, W. Chan, J. Medved, G. Suwala, T. Bates, and A. Zhang. Improving traffic locality in BitTorrent via biased neighbor selection. In Proc. of ICDCS, 2006.
[3] K. Chen, D. Choffnes, R. Potharaju, Y. Chen, F. Bustamante, and Y. Zhao. Where the sidewalk ends: Extending the Internet AS graph using traceroutes from P2P users. In Proc. of ACM CoNEXT, 2009.
[4] D. Choffnes, F. Bustamante, and Z. Ge. Using the crowd to monitor the cloud: Network event detection from edge systems. In Proc. of ACM SIGCOMM, 2010.
[5] D. R. Choffnes and F. E. Bustamante. Taming the torrent: A practical approach to reducing cross-ISP traffic in peer-to-peer systems. In Proc. of ACM SIGCOMM, 2008.
[6] R. Cuevas, N. Laoutaris, X. Yang, G. Siganos, and P. Rodriguez. Deep diving into BitTorrent locality. In Proc. of IEEE INFOCOM, 2011.
[7] A. Dhamdhere and C. Dovrolis. Ten years in the evolution of the Internet ecosystem. In Proc. of IMC, 2008.
[8] A. Dhamdhere and C. Dovrolis. The Internet is Flat: Modeling the transition from a transit hierarchy to a peering mesh. In Proc. of ACM CoNEXT, 2010.
[9] X. Dimitropoulos, P. Hurley, A. Kind, and M. P. Stoecklin. On the 95-percentile billing method. In Proc. of PAM, 2009.
[10] EdgeScope – sharing the view from a distributed Internet telescope. http://www.aqualab.cs.northwestern.edu/projects/EdgeScope.html.
[11] L. Guo, S. Chen, Z. Xiao, E. Tan, X. Ding, and X. Zhang. Measurements, analysis, and modeling of BitTorrent-like systems. In Proc. of IMC, 2005.
[12] M. Izal, G. Urvoy-Keller, E. Biersack, P. Felber, A. Hamra, and L. Garces-Erice. Dissecting BitTorrent: Five months in a torrent’s lifetime. In Proc. of PAM, 2004.
[13] T. Karagiannis, P. Rodriguez, and K. Papagiannaki. Should Internet service providers fear peer-assisted content distribution? In Proc. of IMC, 2005.
[14] H. Kim, k. Claffy, M. Fomenkov, D. Barman, M. Faloutsos, and K. Lee. Internet traffic classification demystified: myths, caveats, and the best practices. In Proc. of ACM CoNEXT, 2008.
[15] C. Labovitz, S. Iekel-Johnson, J. Oberheide, and F. Jahanian. Internet inter-domain traffic. In Proc. of ACM SIGCOMM, New Delhi, India, August 2010.
[16] S. Le Blond, A. Legout, and W. Dabbous. Pushing BitTorrent Locality to the Limit. http://hal.inria.fr/inria-00343822/PDF/bt_locality.pdf.
[17] G. Maier, A. Feldmann, V. Paxson, and M. Allman. On dominant characteristics of residential broadband Internet traffic. In Proc. of IMC, 2009.
[18] M. Piatek, H. V. Madhyastha, J. P. John, A. Krishnamurthy, and T. Anderson. Pitfalls for ISP-friendly P2P design. In Proc. of HotNets, 2009.
[19] J. A. Pouwelse, P. Garbacki, D. H. J. Epema, and H. J. Sips. The BitTorrent P2P file-sharing system: Measurements and analysis. In Proc. of IPTPS, 2005.
[20] D. Qiu and R. Srikant. Modeling and performance analysis of BitTorrent-like peer-to-peer networks. In Proc. of ACM SIGCOMM, 2004.
[21] H. Schulze and K. Mochalski. ipoque: Internet study 2007, Nov. 2007. http://www.ipoque.com/media/internet_studies.
[22] H. Schulze and K. Mochalski. ipoque: Internet study 2008/2009, Nov. 2009. http://www.ipoque.com/media/internet_studies.
[23] R. Stanojevic, N. Laoutaris, and P. Rodriguez. On economic heavy hitters: Shapley value analysis of 95th-percentile pricing. In Proc. of IMC, 2010.
[24] Team Cymru. The Team Cymru IP to ASN lookup page. http://www.cymru.com/BGP/asnlookup.html.
[25] R. D. Torres, M. Y. Hajjat, S. G. Rao, M. Mellia, and M. M. Munafo. Inferring undesirable behavior from P2P traffic analysis. In Proc. of ACM SIGMETRICS, 2009.
[26] University of Oregon Route Views project. http://www.routeviews.org/.
[27] uTorrent still on top, BitComet’s market share plummets. http://torrentfreak.com/utorrent-still-on-top-bitcomets-market-share-plummets-090814/.
[28] Vuze, Inc. Vuze. http://www.vuze.com.
[29] J. Xia and L. Gao. On the evaluation of AS relationship inferences. In In Proc. of IEEE GLOBECOM, 2004.
[30] H. Xie, R. Yang, A. Krishnamurthy, Y. Liu, and A. Silberschatz. P4P: Provider portal for P2P applications. In Proc. of ACM SIGCOMM, 2008.
[31] C. Zhang, P. Dhungel, D. Wu, and K. W. Ross. Unraveling the BitTorrent ecosystem. IEEE Transaction on Parallel and Distributed Systems, July 2011. To appear.

### Appendix: 95th-Percentile and Shapley Value

95th-percentile billing is one of the most common models used by providers to charge for traffic over interdomain links [9]. Under this billing model, costs are determined by near-peak usage, calculated by the 95th-percentile value at fixed intervals (e.g., 5-minute bins) over each billing cycle (usually 1 month). As a result, the effective cost of each byte of traffic varies depending on the particular time of day—bytes sent during times of high usage are more expensive than off-peak bytes.

Following the approach in [23], we use the game-theoretic concept of Shapley value to compute the average marginal cost contribution of individual classes of traffic under the 95th-percentile billing model. This is obtained by averaging the marginal increase in 95th-percentile cost over all possible "arrival orders" for the classes of traffic being examined.

In our study of "BT" and "Other" traffic, we have two arrival orders: [BT, Other] and [Other, BT]. Given a function \( v_{95th} \) that returns the 95th-percentile value of a series of bandwidth measurements, we compute the Shapley value of BitTorrent traffic by averaging the marginal contributions:

\[
m_1 = v_{95th}(BT)
\]
\[
m_2 = v_{95th}(Other + BT) - v_{95th}(Other)
\]
\[
SV_{BT} = \frac{m_1 + m_2}{2}
\]

Since the Shapley value is efficient (i.e., the sum of the average marginal costs equals the total cost), we can compute the proportion of the total cost attributable to BitTorrent traffic:

\[
p_{BT} = \frac{SV_{BT}}{SV_{BT} + SV_{Other}}
\]

Finally, we compare the proportion of total cost attributable to BitTorrent traffic relative to the overall fraction of BitTorrent traffic \( f_{BT} \) carried over the network:

\[
\text{Relative Cost}_{BT} = \frac{p_{BT}}{f_{BT}}
\]

When the relative cost of BitTorrent is > 1, it means that increases in BitTorrent traffic are temporally aligned with increases in the total traffic (typically during waking hours) and BitTorrent traffic is comparatively more expensive than other traffic. Conversely, a relative cost < 1 means that BitTorrent traffic is comparatively less expensive than other traffic and tends to occur during off-peak (e.g., overnight) periods.