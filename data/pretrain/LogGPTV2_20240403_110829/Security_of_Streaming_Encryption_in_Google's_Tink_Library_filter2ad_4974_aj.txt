ğ‘–=1
By the Chi-Squared Lemma,
2ğ‘› Â· E[ï¸€(ğ‘Œğ‘–,ğ‘¥ âˆ’ 1/(2ğ‘› âˆ’ 1))2]ï¸€ â‰¤ 100ğ‘–ğ‘›
.
22ğ‘›
2ğ‘› Â· (ğ‘Œğ‘–,ğ‘¥ âˆ’ 1/(2ğ‘› âˆ’ 1))2 .
(5)
.
(6)
ğ‘âˆ‘ï¸
ğ‘–=1
22ğ‘› â‰¤ 50ğ‘›ğ‘2
100ğ‘–ğ‘›
22ğ‘›
.
We now will justify Eq. (6) above. In the real system S1, the first ğ‘– âˆ’ 1 queries lead to 2(ğ‘– âˆ’ 1)
random-permutation calls, and let ğ‘‰ = (ğ‘‰1, . . . , ğ‘‰2ğ‘–âˆ’2) be the list of the outputs of those calls. For
ğ‘£ âˆˆ ({0, 1}ğ‘›)2ğ‘–âˆ’2, we write pS1,ğ´(ğ‘¥ | ğ‘‰ = ğ‘£) to denote the conditional probability that the ğ‘–-th
answer is ğ‘¥, given that ğ‘‰ = ğ‘£. Let ğ‘Š be the random variable that if ğ‘‰ takes value ğ‘£ then ğ‘Š takes
value pS1,ğ´(ğ‘¥ | ğ‘‰ = ğ‘£). Since ğ‘‰ uniquely determines ğ‘‹ ğ‘–âˆ’1,
ğ‘Œğ‘–,ğ‘¥ = E[ğ‘Š | ğ‘‹ ğ‘–âˆ’1] .
From the fact that the function ğœŒ(ğ‘¥) = (ğ‘¥ âˆ’ 1/(2ğ‘› âˆ’ 1))2 is convex, using Jensenâ€™s inequality for
conditional expectation,
(ï¸
ğ‘Œğ‘–,ğ‘¥ âˆ’
1
(2ğ‘› âˆ’ 1
)ï¸2
= ğœŒ(ï¸€E[ğ‘Š | ğ‘‹ ğ‘–âˆ’1])ï¸€
â‰¤ E[ï¸€ğœŒ(ğ‘Š) | ğ‘‹ ğ‘–âˆ’1]ï¸€ = E[ï¸(ï¸
)ï¸2]ï¸ â‰¤ E[ï¸(ï¸
ğ‘Š âˆ’
2ğ‘› âˆ’ 1
)ï¸2 | ğ‘‹ ğ‘–âˆ’1
]ï¸
.
.
1
(2ğ‘› âˆ’ 1
)ï¸2]ï¸
ğ‘Š âˆ’
1
(2ğ‘› âˆ’ 1
E[ï¸(ï¸
Taking expectation of both sides gives us
ğ‘Œğ‘–,ğ‘¥ âˆ’ 1
E[ï¸(ï¸
What remains is to prove that
)ï¸2]ï¸ â‰¤ 100ğ‘–ğ‘›
24ğ‘›
.
ğ‘Š âˆ’ 1
2ğ‘› âˆ’ 1
31
Since (ğ‘Š âˆ’ 1/(2ğ‘› âˆ’ 1))2 â‰¤ 1, it suffices to prove that
Pr[ï¸(ï¸
ğ‘Š âˆ’ 1
)ï¸2 â‰¥ 99ğ‘–ğ‘›
]ï¸ â‰¤ ğ‘–ğ‘›
(7)
The single-user case. It is instructive to first consider the case that the adversary ğ’œ targets
only a single user. In this case, we actually can give a much stronger concentration bound on ğ‘Š.
In particular, we will show that
2ğ‘› âˆ’ 1
24ğ‘› .
24ğ‘›
Pr[ï¸(ï¸
)ï¸2 â‰¥ 99ğ‘–ğ‘›
]ï¸ â‰¤ 2âˆ’5ğ‘› .
24ğ‘›
ğ‘Š âˆ’ 1
2ğ‘› âˆ’ 1
Note that in this single-user setting, ğ‘‰1, . . . , ğ‘‰2ğ‘–âˆ’2 are sampled uniformly without replacement from
{0, 1}ğ‘›. For each ğ‘— â‰¤ 2ğ‘– âˆ’ 2, let ğµğ‘— be the Bernoulli random variable such that ğµğ‘— = 1 if and only
if ğ‘‰ğ‘— âˆˆ {ğ‘‰1 âŠ• ğ‘¥, . . . , ğ‘‰ğ‘—âˆ’1 âŠ• ğ‘¥}. Let ğ· = 2(ğµ1 + Â·Â·Â· + ğµ2ğ‘–âˆ’2). We will use the following result that
is implicit in the work of Dai, Hoang, and Tessaro [10].
Lemma 8.
Moreover,
(ï¸
[10] Define ğµ1, . . . , ğµğ‘–, and ğ‘Š and ğ· as above. Then
ğ‘Š âˆ’ 1
)ï¸2 â‰¤ 3(ï¸€ğ· âˆ’ 4(ğ‘– âˆ’ 1)2/2ğ‘›)ï¸€2 + 12(ğ‘– âˆ’ 1)2/22ğ‘›
E[ğµğ‘– | ğµ1, . . . , ğµğ‘–âˆ’1] = ğ‘– âˆ’ 1 âˆ’ 2(ğµ1 + Â·Â·Â· + ğµğ‘–âˆ’1)
2ğ‘› âˆ’ 1
24ğ‘›
.
2ğ‘› âˆ’ (ğ‘– âˆ’ 1)
.
We now prove that for every ğ‘— â‰¤ 2ğ‘– âˆ’ 2, with probability at least 1 âˆ’ ğ‘—/ğ‘’4.5ğ‘› â‰¥ 1 âˆ’ 2âˆ’5ğ‘›,
âƒ’âƒ’ğµ1 + Â·Â·Â· + ğµğ‘— âˆ’ ğ‘—2/2ğ‘›+1âƒ’âƒ’ â‰¤ 4âˆšï¸€ğ‘—ğ‘› .
Combining this for ğ‘— = 2ğ‘–âˆ’2 and Lemma 8 leads to Eq. (8). We prove this claim by induction on ğ‘—.
The base case ğ‘— = 1 obviously holds, since ğµ1 = 0. Now, suppose that the claim holds for ğ‘— âˆ’ 1, we
shall prove that it holds for ğ‘— as well. Let ğ‘‡0 = 0 and ğ‘‡ğ‘Ÿ = ğ‘‡ğ‘Ÿâˆ’1 + ğµğ‘Ÿ âˆ’ E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] for
every 1 â‰¤ ğ‘Ÿ â‰¤ ğ‘—. Since ğµ1, . . . , ğµğ‘Ÿâˆ’1 completely determine ğ‘‡1, . . . , ğ‘‡ğ‘Ÿâˆ’1,
E[ğ‘‡ğ‘Ÿ | ğ‘‡1, . . . , ğ‘‡ğ‘Ÿâˆ’1] = E[ï¸
ğ‘‡ğ‘Ÿâˆ’1 + ğµğ‘Ÿ âˆ’ E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] | ğ‘‡1, . . . , ğ‘‡ğ‘Ÿâˆ’1
= ğ‘‡ğ‘Ÿâˆ’1 + E[ğµğ‘Ÿ | ğ‘‡1, . . . , ğ‘‡ğ‘Ÿâˆ’1] âˆ’ E[ğµğ‘Ÿ | ğ‘‡1, . . . , ğ‘‡ğ‘Ÿâˆ’1] = ğ‘‡ğ‘Ÿâˆ’1 .
]ï¸
(8)
(9)
Moreover, for every ğ‘Ÿ â‰¤ ğ‘—,
âƒ’âƒ’âƒ’ğµğ‘Ÿ âˆ’ E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1]
âƒ’âƒ’âƒ’ â‰¤ max{ğµğ‘Ÿ, E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1]} â‰¤ 1 ,
|ğ‘‡ğ‘Ÿ âˆ’ ğ‘‡ğ‘Ÿâˆ’1| =
where the first inequality is due to the fact that ğµğ‘Ÿ â‰¥ 0, and the second inequality is due to the
fact that ğµğ‘Ÿ â‰¤ 1. Thus |ğ‘‡ğ‘Ÿ| â‰¤ ğ‘Ÿ, and therefore E[|ğ‘‡ğ‘Ÿ|] < âˆ. Hence (ğ‘‡0, . . . , ğ‘‡ğ‘—) is a martingale.
âˆš
Using Azumaâ€™s inequality with ğ‘ = 1, ğœ† = 3
ğ‘›, and ğ‘š = ğ‘—,
Pr[ï¸|ğ‘‡ğ‘— âˆ’ ğ‘‡0| â‰¥ 3âˆšï¸€ğ‘›ğ‘—
]ï¸ â‰¤ ğ‘’âˆ’4.5ğ‘› .
32
âˆš
Now suppose that |ğ‘‡ğ‘— âˆ’ ğ‘‡0| â‰¤ 3
ğ‘›ğ‘— and for every ğ‘Ÿ â‰¤ ğ‘— âˆ’ 1,
âˆš
|ğµ1 + Â·Â·Â· + ğµğ‘Ÿ âˆ’ ğ‘Ÿ2/2ğ‘›+1| â‰¤ 4
(10)
From Eq. (9) and the induction hypothesis, this happens with probability at least 1 âˆ’ ğ‘—/ğ‘’4.5ğ‘›. We
now show that
|ğµ1 + Â·Â·Â· + ğµğ‘— âˆ’ ğ‘—2/2ğ‘›+1| â‰¤ 4âˆšï¸€ğ‘—ğ‘›
with (conditional) probability 1, justifying the inductive case. From Lemma 8, for every ğ‘Ÿ â‰¤ ğ‘—,
ğ‘Ÿğ‘› .
Thus, from Eq. (11), for every ğ‘Ÿ â‰¤ ğ‘—,
âƒ’âƒ’âƒ’E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] âˆ’ (ğ‘Ÿ âˆ’ 1)/2ğ‘›âƒ’âƒ’âƒ’ =
.
2ğ‘› âˆ’ (ğ‘Ÿ âˆ’ 1)
E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] = ğ‘Ÿ âˆ’ 1 âˆ’ 2(ğµ1 + Â·Â·Â· + ğµğ‘Ÿâˆ’1)
âƒ’âƒ’âƒ’ ğ‘Ÿ âˆ’ 1 âˆ’ 2(ğµ1 + Â·Â·Â· + ğµğ‘Ÿâˆ’1)
âˆ’ (ğ‘Ÿ âˆ’ 1)/2ğ‘›âƒ’âƒ’âƒ’
âƒ’âƒ’âƒ’âˆ’2(ï¸€ğµ1 + Â·Â·Â· + ğµğ‘Ÿâˆ’1 âˆ’ (ğ‘Ÿ âˆ’ 1)2/2ğ‘›+1)ï¸€
âƒ’âƒ’âƒ’
2ğ‘› âˆ’ (ğ‘Ÿ âˆ’ 1) â‰¤ 8âˆšï¸€(ğ‘Ÿ âˆ’ 1)ğ‘›
â‰¤ 8âˆšï¸€(ğ‘Ÿ âˆ’ 1)ğ‘›
2ğ‘› âˆ’ (ğ‘Ÿ âˆ’ 1)
2ğ‘› âˆ’ (ğ‘Ÿ âˆ’ 1)
=
,
2ğ‘› âˆ’ ğ‘—
where the second last inequality is due to the induction hypothesis. Since
(11)
we have
=
On the other hand,
ğ‘Ÿ=1
ğµğ‘Ÿ âˆ’ E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1],
ğ‘‡ğ‘— âˆ’ ğ‘‡0 =
ğ‘—âˆ‘ï¸
âƒ’âƒ’âƒ’ğµ1 + Â·Â·Â· + ğµğ‘— âˆ’ ğ‘—(ğ‘— âˆ’ 1)/2ğ‘›+1âƒ’âƒ’âƒ’ =
âƒ’âƒ’âƒ’ğ‘‡ğ‘— âˆ’ ğ‘‡0 +
âƒ’âƒ’âƒ’ ğ‘—âˆ‘ï¸
ğµğ‘Ÿ âˆ’ (ğ‘Ÿ âˆ’ 1)/2ğ‘›âƒ’âƒ’âƒ’
(ï¸€E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] âˆ’ (ğ‘Ÿ âˆ’ 1)/2ğ‘›)ï¸€âƒ’âƒ’âƒ’
ğ‘—âˆ‘ï¸
âƒ’âƒ’âƒ’E[ğµğ‘Ÿ | ğµ1, . . . , ğµğ‘Ÿâˆ’1] âˆ’ (ğ‘Ÿ âˆ’ 1)/2ğ‘›âƒ’âƒ’âƒ’ â‰¤ 3âˆšï¸€ğ‘—ğ‘› +
ğ‘—âˆ‘ï¸
8âˆšï¸€(ğ‘Ÿ âˆ’ 1)ğ‘›
âˆš
â‰¤ |ğ‘‡ğ‘— âˆ’ ğ‘‡0| +
ğ‘—âˆ‘ï¸
ğ‘Ÿ=1
ğ‘Ÿ=1
ğ‘Ÿ=1
ğ‘—âˆ‘ï¸
Â· 1
âˆ«ï¸ 1
ğ‘Ÿ=1
âˆš
ğ‘—