com/2016/08/modernizing-oauth-interactions-in-na
tive-apps.html.
[4] OAuth 2.0 for Native Apps. https://tools.ietf.org/htm
l/rfc8252.
[5] Public Sufﬁx List. http://publicsuffix.org/.
[6] Stop Words List from Glasgow Information Retrieval Group.
http://ir.dcs.gla.ac.uk/resources/linguistic_ut
ils/stop_words.
[7] The Chromium Projects. http://www.chromium.org/.
[8] UIWebView, Apple Development Documentations. https://de
veloper.apple.com/documentation/uikit/uiwebview.
[9] WebView, Android Developers. https://developer.androi
d.com/reference/android/webkit/WebView.html.
[10] WKWebView,
Apple
Development
Documentations.
https://developer.apple.com/documentation/we
bkit/wkwebview.
[11] ARZT, S., RASTHOFER, S., FRITZ, C., BODDEN, E., BARTEL,
A., KLEIN, J., LE TRAON, Y., OCTEAU, D., AND MCDANIEL,
P. Flowdroid: Precise context, ﬂow, ﬁeld, object-sensitive and
lifecycle-aware taint analysis for android apps. Acm Sigplan
Notices 49, 6 (2014), 259–269.
[12] AU, K. W. Y., ZHOU, Y. F., HUANG, Z., AND LIE, D. Pscout:
analyzing the android permission speciﬁcation. In Proceedings
of the 2012 ACM conference on Computer and communications
security (2012), ACM, pp. 217–228.
Statistical deobfuscation of android applications.
[13] BICHSEL, B., RAYCHEV, V., TSANKOV, P., AND VECHEV,
M.
In
Proceedings of the 2016 ACM SIGSAC Conference on Computer
and Communications Security (New York, NY, USA, 2016), CCS
’16, ACM, pp. 343–355.
[14] BODDEN, E., SEWE, A., SINSCHEK, J., OUESLATI, H., AND
MEZINI, M. Taming reﬂection: Aiding static analysis in the
In 2011 33rd
presence of reﬂection and custom class loaders.
International Conference on Software Engineering (ICSE) (May
2011), pp. 241–250.
[15] BOLLEGALA, D., MATSUO, Y., AND ISHIZUKA, M. Measuring
semantic similarity between words using web search engines.
www 7 (2007), 757–766.
[16] CHEN, E. Y., PEI, Y., CHEN, S., TIAN, Y., KOTCHER, R., AND
TAGUE, P. Oauth demystiﬁed for mobile application developers.
In Proceedings of
the 2014 ACM SIGSAC Conference on
Computer and Communications Security (2014), ACM, pp. 892–
903.
[17] CHIN, E., AND WAGNER, D. Bifocals: Analyzing webview
vulnerabilities in android applications. In International Workshop
on Information Security Applications (2013), Springer, pp. 138–
159.
[18] CHRISTENSEN, A. S., MØLLER, A., AND SCHWARTZBACH,
In International
M. I. Precise analysis of string expressions.
Static Analysis Symposium (2003), Springer, pp. 1–18.
[19] CRUSSELL, J., GIBLER, C., AND CHEN, H. Scalable semantics-
In Proc. of
based detection of similar android applications.
ESORICS (2013), vol. 13, Citeseer.
1196    27th USENIX Security Symposium
USENIX Association
[20] DAVIDSON, D., CHEN, Y., GEORGE, F., LU, L., AND JHA, S.
Secure integration of web content and applications on commodity
In Proceedings of the 2017 ACM
mobile operating systems.
on Asia Conference on Computer and Communications Security
(2017), ACM, pp. 652–665.
[21] FITZPATRICK, L., AND DENT, M. Automatic feedback using
In ACM SIGIR Forum (1997),
past queries: social searching?
vol. 31, ACM, pp. 306–313.
[22] GEORGIEV, M., JANA, S., AND SHMATIKOV, V. Breaking
and ﬁxing origin-based access control in hybrid web/mobile
application frameworks. In NDSS symposium (2014), vol. 2014,
NIH Public Access, p. 1.
[23] HASSANSHAHI, B., JIA, Y., YAP, R. H., SAXENA, P., AND
LIANG, Z. Web-to-application injection attacks on android:
In European Symposium on
Characterization and detection.
Research in Computer Security (2015), Springer, pp. 577–598.
[24] HUANG, J., GU, G., MENDOZA, A., ET AL. Study and mit-
igation of origin stripping vulnerabilities in hybrid-postmessage
enabled mobile applications. In Study and Mitigation of Origin
Stripping Vulnerabilities in Hybrid-postMessage Enabled Mobile
Applications, IEEE, p. 0.
[25] JAGPAL, N., DINGLE, E., GRAVEL, J.-P., MAVROMMATIS,
P., PROVOS, N., RAJAB, M. A., AND THOMAS, K. Trends
and lessons from three years ﬁghting malicious extensions.
In 24th USENIX Security Symposium (USENIX Security 15)
(Washington, D.C., 2015), USENIX Association, pp. 579–593.
[26] JIN, X., HU, X., YING, K., DU, W., YIN, H., AND PERI,
G. N. Code injection attacks on html5-based mobile apps:
In Proceedings
Characterization, detection and mitigation.
of
the 2014 ACM SIGSAC Conference on Computer and
Communications Security (2014), ACM, pp. 66–77.
[27] KAPRAVELOS, A., GRIER, C., CHACHRA, N., KRUEGEL,
C., VIGNA, G., AND PAXSON, V. Hulk: Eliciting malicious
In 23rd USENIX Security
behavior in browser extensions.
Symposium (USENIX Security 14) (San Diego, CA, 2014),
USENIX Association, pp. 641–654.
[28] LAM, P., BODDEN, E., LHOT ´AK, O., AND HENDREN, L.
The soot framework for java program analysis: a retrospective.
In Cetus Users and Compiler Infastructure Workshop (CETUS
2011) (2011), vol. 15, p. 35.
[29] LI, D., LYU, Y., WAN, M., AND HALFOND, W. G. String
analysis for java and android applications. In Proceedings of the
2015 10th Joint Meeting on Foundations of Software Engineering
(2015), ACM, pp. 661–672.
[30] LI, L., BARTEL, A., BISSYAND ´E, T. F., KLEIN, J., LE TRAON,
Y., ARZT, S., RASTHOFER, S., BODDEN, E., OCTEAU, D.,
AND MCDANIEL, P. Iccta: Detecting inter-component privacy
leaks in android apps. In Proceedings of the 37th International
Conference on Software Engineering-Volume 1 (2015), IEEE
Press, pp. 280–291.
[31] LI, L., BISSYAND ´E, T. F., OCTEAU, D., AND KLEIN, J.
Droidra: Taming reﬂection to support whole-program analysis
In Proceedings of the 25th International
of android apps.
Symposium on Software Testing and Analysis (New York, NY,
USA, 2016), ISSTA 2016, ACM, pp. 318–329.
[32] LUO, T., HAO, H., DU, W., WANG, Y., AND YIN, H. Attacks
In Proceedings of the
on webview in the android system.
27th Annual Computer Security Applications Conference (2011),
ACM, pp. 343–352.
[33] LUO, T., JIN, X., ANANTHANARAYANAN, A., AND DU, W.
Touchjacking attacks on web in android, ios, and windows phone.
In International Symposium on Foundations and Practice of
Security (2012), Springer, pp. 227–243.
[34] MA, Z., WANG, H., GUO, Y., AND CHEN, X. Libradar: fast
and accurate detection of third-party libraries in android apps.
In Proceedings of the 38th International Conference on Software
Engineering Companion (2016), ACM, pp. 653–656.
[35] MERKLE, R. C. A digital signature based on a conventional
encryption function. In Advances in Cryptology — CRYPTO ’87
(1987), Springer, pp. 369–378.
[36] MUTCHLER, P., DOUP ´E, A., MITCHELL, J., KRUEGEL, C.,
AND VIGNA, G. A large-scale study of mobile web app security.
Mobile Security Techologies (2015).
[37] PEARCE, P., FELT, A. P., NUNEZ, G., AND WAGNER, D.
Addroid: Privilege separation for applications and advertisers in
android. In Proc. of AsiaCCS ’12.
[38] RAGHAVAN, V. V., AND SEVER, H. On the reuse of past optimal
In Proceedings of the 18th annual international ACM
queries.
SIGIR conference on Research and development in information
retrieval (1995), ACM, pp. 344–350.
[39] RASTHOFER, S., ARZT, S., MILTENBERGER, M., AND
BODDEN, E. Harvesting runtime values in android applications
that feature anti-analysis techniques. In Network and Distributed
System Security Symposium (NDSS) (Feb. 2016).
[40] RASTOGI, V., SHAO, R., CHEN, Y., PAN, X., ZOU, S., AND
RILEY, R. Are these ads safe: Detecting hidden attacks through
the mobile app-web interfaces. In NDSS (2016).
[41] ROESNER, F., AND KOHNO, T.
Securing embedded user
interfaces: Android and beyond. In USENIX Security Symposium
(2013), pp. 97–112.
[42] SAHAMI, M., AND HEILMAN, T. D. A web-based kernel
function for measuring the similarity of short text snippets.
In
Proceedings of the 15th international conference on World Wide
Web (2006), AcM, pp. 377–386.
[43] SHEHAB, M., AND MOHSEN, F. Towards enhancing the security
In Mobile Services
of oauth implementations in smart phones.
(MS), 2014 IEEE International Conference on (2014), IEEE,
pp. 39–46.
[44] SHEKHAR, S., DIETZ, M., AND WALLACH, D. S. Adsplit:
In Proc.
Separating smartphone advertising from applications.
of USENIX Security’12.
[45] SON, S., KIM, D., AND SHMATIKOV, V. What mobile ads know
about mobile users. In NDSS (2016).
[46] TUNCAY, G. S., DEMETRIOU, S., AND GUNTER, C. A. Draco:
A system for uniform and ﬁne-grained access control for web
In Proceedings of the 2016 ACM SIGSAC
code on android.
Conference on Computer and Communications Security (2016),
ACM, pp. 104–115.
[47] WANG, H., GUO, Y., MA, Z., AND CHEN, X. Wukong: A
scalable and accurate two-phase approach to android app clone
detection. In Proceedings of the 2015 International Symposium
on Software Testing and Analysis (2015), ACM, pp. 71–82.
[48] YANG, G., MENDOZA, A., ZHANG, J., AND GU, G. Precisely
and scalably vetting javascript bridge in android hybrid apps. In
International Symposium on Research in Attacks, Intrusions, and
Defenses (2017), Springer, pp. 143–166.
[49] ZHANG, Y., DAI, J., ZHANG, X., HUANG, S., YANG, Z.,
YANG, M., AND CHEN, H. Detecting third-party libraries in
android applications with high precision and recall. In 2018 IEEE
25th International Conference on Software Analysis, Evolution
and Reengineering (SANER) (2018), IEEE, pp. 141–152.
A Real-world Malicious Cases
Table 9 lists the detailed information of the 21 malicious
apps detected by XPMChecker.
USENIX Association
27th USENIX Security Symposium    1197
Table 9: Discovered malicious XPM behaviors with different aims: impersonating relying party in OAuth (A1, 2
apps), stealing user credentials (A2, 6 apps), stealing cookies (A3, 14 apps). One app named InstaView exhibits both
A1 and A2 behaviors.
Package Name
Installations
Malicious
Behavior
Description
APK MD5
com.chatous.chatous
10M-50M
com.chatous.plaza
1M - 5M
com.melonapps.melon
5M - 10M
com.chatous.pointblank
10M - 50M
com.vendiste.app
100K - 500K
com.litefbwrapper.android
100K - 500K
com.instaview.app
1M - 5M
com.kingsoft.email
100K - 500K
co.kr.adkingkong
500K - 1M
com.dmf.wall.
DMFPanoLwpF
100K - 500K
ru.like.vs
100K - 500K
sg.com.singnet
.mystorage.android
100K - 500K
com.hlpth.molome
10K - 50K
com.weirdlysocial.videoview
10K - 50K
com.wierdlysocial.storyview
5K - 10K
com.deltecs.wipro
50K - 100K
com.snapdealhub
500K - 1M
com.ilgan.
GoldenDiskAwards2016
100K - 500K
com.homedev.locationhistory
100K - 500K
com.danielstudio.app.wowtu
10K - 50K
com.aol.mobile.aim
1M - 5M
A3
A3
A3
A3
A3
A3
A1
& A2
A2
A2
A3
A3
A3
A2
A2
A2
A3
A3
A1
A3
A3
A3
to steal user’s
steal Facebook cookies and abuse
cookies to send spam messages
steal Facebook cookies and abuse
cookies to send spam messages
steal Facebook cookies and abuse
cookies to send spam messages
steal Facebook cookies and abuse
cookies to send spam messages
steal Facebook cookies and abuse
cookies to send spam messages
steal Facebook cookies and abuse
cookies to receive account’s notiﬁ-
cation
Impersonating Tinder in Instagram
OAuth & inject JavaScript to steal
user’s Instagram credentials
inject JavaScript to steal user’s QQ
Email credentials
inject JavaScript
google plus credentials
steal ﬂickr cookies to login auto-
matically
steal vk cookies to request user’s
information
use Facebook cookie to reconnect
when user logouts
inject JavaScript
access token
inject JavaScript
Instagram credentials
inject JavaScript
Instagram credentials
use teamgum’s clientId in Google
SSO and steal access token from
cookies
use teamgum’s clientId in Google
SSO and steal access token from
cookies
use
Weibo SSO
steal Google cookies and save them
into sharedpreference
steal Weibo cookies and abuse
cookie to update photos
steal Facebook cookies and save
them into sharedpreference
to steal Google
to steal user’s
to steal user’s
fengchuanke’
clientId
for
d8726437e1f2bbe17257c4eac6707bee
e5c4ec654e6f97a95ec5eed7afdd961d
36513949c9fb8dd2f979354ddd058b60
a43529aa32363c480abb1cf013d29cdf
5a4c48925fd42f6ee2376f088184e925
71e290121dddd0099d766685bf89a479
b354aafb7f86e7ebc629a767d29f886a
c3501cbb6f0caa3c2655de2713afad3a
26fe73ee8a33d2a0112215cf10d97c8b
e85a5e17f96ed57c9eb229234f4abaa2
33c59b3042acc6ffac59bb7e418f7f85
25611dc7d573e43c923f8e51f7835302
a3ec6a2e3e5f387a53cdb06a3e48c917
7ebccfbd85c8f239b122ea31eb0b318a
f4f1f6f644bbca4de637c0b19b94ec1f
45dfd761e11883c0b225f7dc8edb4b14
31139b30a4f92f14a8f9707f74c9b60d
78c32007638f64de697dfb473a2a6d0d
78ca09ff3d1367982c5fb084b8f31734
aa3dd94becf64647fdf74e2b2aa7b325
80931d076bd5be08e7e1077e31b409e2
1198    27th USENIX Security Symposium
USENIX Association