可能原因
虚接口收到错误报文。
处理步骤
步骤1 在诊断视图下执行display ospf error packet命令检查并记录错误报文的源地址。
步骤2 请联系技术支持人员。
----结束
61.48 OSPF/4/TRAP_VIR_HELPER_CHG
日志信息
OSPF/4/TRAP_VIR_HELPER_CHG: The helper status of the virtual neighbor changes.
(VirtNbrAreaId=[VirtNbrAreaId], VirtNbrRtrId=[VirtNbrRtrId], ProcessId=[ProcessId],
文档版本 06 (2017-09-12) 华为专有和保密信息 629
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
RouterId=[RouterId], VirtNbrRestartHelperStatus=[VirtNbrRestartHelperStatus],
VirtNbrRestartHelperAge=[VirtNbrRestartHelperAge],
VirtNbrRestartHelperExitReason=[VirtNbrRestartHelperExitReason],
InstanceName=[InstanceName])
日志含义
邻居状态改变。
日志参数
参数名称 参数含义
Process ID OSPF进程号。
RouterId 路由器ID。
VirtNbrAreaId 虚连接邻居区域ID。
VirtualNbrRtrId 虚连接邻居路由器ID。
VirtualNbrRestartHelperStatus 虚连接邻居GR状态。
VirtualNbrRestartHelperAge 虚连接邻居GR时间。
VirtualNbrRestartHelperExitReason 虚连接邻居退出GR的原因。
InstanceName VPN实例名称。
可能原因
链路状态改变。
处理步骤
步骤1 执行display ospf graceful-restart命令检查虚邻居的状态和GR状态。
步骤2 请联系技术支持人员。
----结束
61.49 OSPF/6/TRAP_VIR_INTF_CHG
日志信息
OSPF/6/TRAP_VIR_INTF_CHG: Virtual interface state has changed.
(VirtIfAreaId=[VirtIfAreaId], VirtIfNeighbor=[VirtIfNeighbor], ProcessId=[ProcessId],
RouterId=[RouterId], VirtIfState=[VirtIfState], InstanceName=[InstanceName])
日志含义
虚接口状态改变。
文档版本 06 (2017-09-12) 华为专有和保密信息 630
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
日志参数
参数名称 参数含义
VirtIfAreaId Transit区域ID。
VirtIfNeighbor 虚连接邻居IP地址。
ProcessId OSPF进程号。
RouterId 路由器ID。
VirtIfState 接口状态。
InstanceName VPN实例名称。
可能原因
虚接口状态改变。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
61.50 OSPF/4/TRAP_VIR_INTF_RETX
日志信息
OSPF/4/TRAP_VIR_INTF_RETX: An OSPF packet is retransmitted on a virtual interface.
(VirtIfAreaId=[VirtIfAreaId], VirtIfNeighbor=[VirtIfNeighbor], LsdbAreaId=[LsdbAreaId],
LsdbType=[LsdbType], LsdbLsid=[LsdbLsid], LsdbRouterId=[LsdbRouterId],
ProcessId=[ProcessId], RouterId=[RouterId], PacketType=[PacketType],
InstanceName=[InstanceName])
日志含义
虚接口重传报文。
日志参数
参数名称 参数含义
VirtIfAreaId Transit区域ID。
VirtIfNeighbor 虚连接邻居IP地址。
LsdbAreaId 在LSDB中的LSA区域ID。
LsdbType 在LSDB中的LSA类型。
LsdbLsId 在LSDB中的LSA ID。
LsdbRouterId 在LSDB中的路由器ID。
文档版本 06 (2017-09-12) 华为专有和保密信息 631
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
参数名称 参数含义
ProcessId OSPF进程号。
RouterId 路由器ID。
PacketType 报文类型。
InstanceName VPN实例名称。
可能原因
虚接口重传报文。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
61.51 OSPF/3/VLINK_NBR_CHG_DOWN
日志信息
OSPF/3/VLINK_NBR_CHG_DOWN: Virtual link peer event: neighbor state changed to
Down. (ProcessId=[ProcessId], NeighborAddress=[NeighborAddress],
NeighborEvent=[NeighborEvent], NeighborPreviousState=[NeighborPreviousState],
NeighborCurrentState=[NeighborCurrentState])
日志含义
邻居状态改变为Down。
日志参数
参数名称 参数含义
ProcessId OSPF进程号。
NeighborAddress 邻居地址。
NeighborEvent 邻居触发的事件。
NeighborPreviousState 邻居变化前的状态。
NeighborCurrentState 邻居变化后的状态。
可能原因
虚连接邻居状态因为收到OSPF的报文或是影响OSPF邻居关系的操作，邻居状态发生迁
移。
文档版本 06 (2017-09-12) 华为专有和保密信息 632
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
处理步骤
步骤1 正常运行信息，无需处理。
----结束
61.52 OSPF/4/VLINK_NBR_CHG_E
日志信息
OSPF/4/VLINK_NBR_CHG_E: Virtual link peer event: neighbor status changed.
(ProcessId=[ProcessId], VirtualLinkNeighborAddress=[VirtualLinkNeighborAddress],
NeighborEvent=[NeighborEvent], NeighborPreviousState=[NeighborPreviousState],
NeighborCurrentState=[NeighborCurrentState])
日志含义
虚连接邻居状态改变。
日志参数
参数名称 参数含义
ProcessId OSPF进程号。
VirtualLinkNeighborAddress 虚连接邻居地址。
NeighborEvent 收到事件。
NeighborPreviousState 邻居变化前的状态。
NeighborCurrentState 邻居变化后的状态。
可能原因
虚连接邻居状态改变。
处理步骤
步骤1 执行display ospf peer命令检查邻居状态。
步骤2 请联系技术支持人员。
----结束
61.53 OSPF/2/ospfNbrStateChange_active
日志信息
OSPF/2/ospfNbrStateChange_active: The status of the non-virtual neighbor has changed.
(RouterId=[RouterId], NbrIpAddress=[NbrIpAddress],
NbrAddressLessIndex=[NbrAddressLessIndex], NbrRtrId=[NbrRtrId], NbrState=[NbrState],
ProcessId=[ProcessId], AreaId=[AreaId], IfnetIndex=[IfnetIndex],
文档版本 06 (2017-09-12) 华为专有和保密信息 633
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
LocalIfIpAddress=[LocalIfIpAddress], IfName=[IfName], VpnName=[VpnName],
SubReason=[SubReason], Reason=[NbrStateChangeReason])
日志含义
OSPF邻居状态发生变化，可能是由于该邻居所在的接口状态发生变化，或者收到的
Hello报文中内容发生改变。
日志参数
参数名称 参数含义
RouterId Router ID。
NbrIpAddress 邻居IP地址。
NbrAddressLessIndex 邻居的Unnumber接口索引号。
NbrRtrId 邻居的Router ID。
NbrState 邻居的状态。
ProcessId 进程号。
AreaId 区域ID。
IfnetIndex 本设备接口索引号。
LocalIfIpAddress 本设备接口的IP地址。
IfName 本设备的接口名称。
VpnName VPN实例名。
文档版本 06 (2017-09-12) 华为专有和保密信息 634
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
参数名称 参数含义
SubReason 邻居不可用的详细原因。
l 1：没有收到Hello报文。
l 2：接口参数不匹配。
l 3：逻辑接口变化。
l 4：物理接口变化。
l 5：进程被复位。
l 6：区域被复位。
l 7：区域能力不匹配。
l 8：虚链路不可达。
l 9：伪链接不可达。
l 10：删除网络。
l 11：删除邻居。
l 12：接口silent。
l 13：使能Opaque。
l 14：去使能Opaque。
l 15：OSPF接口类型变化。
l 16：BFD会话状态变化。
l 17：重传次数超限。
l 18：收到1-way Hello报文。
l 19：本端变为DR Other。
l 20：邻居变为DR Other。
l 21：配置或取消区域类型NSSA。
l 22：配置或取消区域类型Stub。
l 23：DD报文无效。
l 24：没有收到DD报文。
l 25：DD报文标志位设置错误。
l 26：未使能Opaque，收到Type-9 LSA、Type-10 LSA和
Type-11 LSA。
l 27：未配置NSSA，收到Type-7 LSA。
l 28：收到未知的LSR。
l 29：配置了NSSA或Stub区域，收到了Type-5 LSA或Type-11
LSA。
l 30：收到的LSR包中含有不存在的LSA。
l 31：收到的LSR包中含有该邻居发送来的LSA。
l 32：收到的LSR包中含有的LSA比数据库中的老。
l 33：LSDB过载。
l 34：LSA过滤配置改变。
文档版本 06 (2017-09-12) 华为专有和保密信息 635
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
参数名称 参数含义
l 35：过滤LSA的ACL改变。
l 36：邻居复位。
l 37：接口复位。
l 38：删除接口。
l 39：删除区域。
l 40：系统过载。
l 41：接口变为备用状态。
l 42：无路由器标识。
l 43：路由器标识变化。
l 44：组件处于生效阶段。
l 45：序列号不匹配。
l 46：DD报文的I比特位错误。
l 47：DD报文的MS比特位错误。
l 48：DD报文的选项错误。
l 49：DD报文接收的MTU不匹配。
l 51：OSPF进程关闭。
l 52：OSPF处于Adj状态。
l 54：OSPF GR状态
l 55：DD报文重传时间限制
l 56：LSDB超限导致邻居状态为非Full。
l 100：OSPF接口和区域处于去使能状态。
Reason 告警产生的原因。
可能原因
原因1：Adjacency holdTimer expired.（邻居定时器超时。）
原因2：Physical interface change.（物理接口变化。）
原因3：Protocol reason.（协议原因。）
原因4：BFD session state change.（BFD会话断开。）
原因5：Configuration change.（OSPF配置变化。）
原因6：Peer router reason.（邻居路由器原因。）
处理步骤
步骤1 原因1：Adjacency holdTimer expired.
1. 使用命令ping查看到对端设备的链路状态是否良好。
– 如果不能ping通，请检查传输设备、链路情况、接口情况，通过调整硬件设
备恢复业务。
文档版本 06 (2017-09-12) 华为专有和保密信息 636
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
– 如果能够ping通，则请执行步骤2。
2. 请收集日志文件，并联系技术支持人员。
步骤2 原因2：Physical interface change.
1. 使用命令display ospf interface查看建立OSPF邻居的接口物理状态是否良好。
– 如果接口的物理状态为“down”，请检查接口的光功率、传输设备是否正
常，通过恢复物理接口状态来消除告警。
– 如果接口的物理状态为“*down”，则该接口被人为执行shutdown操作了，
请在接口下配置undo shutdown命令来消除告警。
– 如果接口的物理状态为Up，则请执行步骤2。
2. 使用命令display ospf interface查看建立OSPF邻居的接口协议状态。
– 如果当前协议状态为Down，请检查是否配置了IP地址、IP地址配置得是否正
确，通过对IP地址的检查来消除告警。
– 如果当前协议状态为Up，则请执行步骤3。
3. 请收集日志文件，并联系技术支持人员。
步骤3 原因3：Protocol reason.
1. 分别在本地设备和对端设备的接口视图和OSPF视图下，使用命令display this检查
链路两端的设备是否使能了相同的协议。
– 如果相同，则请执行步骤2。
– 如果不同，请在需要建立邻居的链路两端接口上配置相同的协议。
2. 使用命令display ospf peer查看OSPF邻居信息。
– 如果没有任何邻居信息，表示本设备无法接收到对端的Hello报文，或者接收
到的Hello报文被丢弃，则请执行步骤3。
– 如果显示的邻居信息为Init，表示本设备可以收到对端的Hello报文，而对端却
无法收到本设备的Hello报文。使用ping命令查看到对端设备的链路状态是否
良好。出现该问题一般是由于转发层面出了问题，导致报文被丢弃。如果不
能通过解决转发故障来消除告警，则请执行步骤4。
– 如果显示的邻居信息为2-way，表示设备运行OSPF接口上配置ospf dr-priority
0，请通过ospf dr-priority命令，调整接口的DR优先级大于0来消除告警。
– 如果显示的邻居信息为Exstart，表示告警设备由于一直在进行DD协商，而无
法完成DD同步，则请执行步骤3。
– 如果显示的邻居信息为Loading，表示本设备认为收到的LSA为非法LSA，将
其丢弃后不断的请求LSA。可以通过在需要建立OSPF邻居的链路两端执行
reset ospf process来恢复告警。
说明
复位OSPF连接（执行reset ospf process命令）会导致设备之间的OSPF邻接关系中断。
务必仔细确认是否必须执行复位OSPF连接的操作。
3. 在接口视图和OSPF进程下分别使用display this命令，检查链路两端配置的认证是
否相同。
– 如果相同，则请执行步骤4。
– 如果不同，请将链路两端配置的认证方式改为一致。
4. 请收集日志文件，并联系技术支持人员。
步骤4 原因4：BFD session state change.
1. 使用ping命令查看到对端设备的链路状态是否良好。
文档版本 06 (2017-09-12) 华为专有和保密信息 637
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
– 如果不能够ping通对端设备，请检查传输设备、链路情况、接口情况，通过
调整硬件设备恢复业务。
– 如果能够ping通对端设备，则请执行步骤4。
2. 在接口视图下使用命令ping检查链路配置是否正确。