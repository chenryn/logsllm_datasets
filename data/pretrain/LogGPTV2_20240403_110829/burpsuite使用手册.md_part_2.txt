4. 点击【更改代理服务器设置】，windows系统下将会弹出IE浏览器的代理设置，此时，按
照IE浏览器的设置步骤，完成代理服务器的配置即可。
除了上述的三种常用的浏览器外，还有Safari浏览器也有不少的用户在使用，其代理配置请点
击阅读进行查看。
13
第三章 如何使用Burp Suite代理
第三章 如何使用Burp Suite代理
Burp Proxy 是Burp Suite以用户驱动测试流程功能的核心，通过代理模式，可以让我们拦截、
查看、修改所有在客户端和服务端之间传输的数据。
本章主要讲述以下内容：
Burp Proxy基本使用
数据拦截与控制
可选项配置Options
历史记录History
Burp Proxy基本使用
通过上一章的学习，我们对Burp Suite代理模式和浏览器代理设置有了基本的了解。Burp
Proxy的使用是一个循序渐进的过程，刚开始使用时，可能并不能很快就获取你所期望的结
果，慢慢地当你熟悉了它的功能和使用方法，你就可以用它很好地对一个产品系统做安全能
力评估。 一般使用Burp Proxy时，大体涉及环节如下：
1. 首先，确认JRE已经安装好，Burp Suite可以启动并正常运行，且已经完成浏览器的代理
服务器配置。
2. 打开Proxy功能中的Intercept选项卡，确认拦截功能为“Interception is on”状态，如果显示
为“Intercept is off”则点击它，打开拦截功能。
3. 打开浏览器，输入你需要访问的URL（以http://baike.baidu.com/为例）并回车，这时你
将会看到数据流量经过Burp Proxy并暂停，直到你点击【Forward】，才会继续传输下
去。如果你点击了【Drop】，则这次通过的数据将会被丢失，不再继续处理。
4. 当我们点击【Forward】之后，我们将看到这次请求返回的所有数据。
14
第三章 如何使用Burp Suite代理
5. 当Burp Suite拦截的客户端和服务器交互之后，我们可以在Burp Suite的消息分析选项卡
中查看这次请求的实体内容、消息头、请求参数等信息。消息分析选项视图主要包括以
下四项：
6. Raw 这是视图主要显示web请求的raw格式，包含请求地址、http协议版本、主机头、浏
览器信息、Accept可接受的内容类型、字符集、编码方式、cookie等。你可以通过手工
修改这些信息，对服务器端进行渗透测试。
7. params 这个视图主要显示客户端请求的参数信息、包括GET或者POST请求的参数、
Cookie参数。渗透人员可以通过修改这些请求参数来完成对服务器端的渗透测试。
8. headers 这个视图显示的信息和Raw的信息类似，只不过在这个视图中，展示得更直观、
友好。
9. Hex 这个视图显示Raw的二进制内容，你可以通过hex编辑器对请求的内容进行修改。
默认情况下，Burp Proxy只拦截请求的消息，普通文件请求如css、js、图片是不会被拦截
的，你可以修改默认的拦截选项来拦截这些静态文件，当然，你也可以通过修改拦截的作用
域、参数或者服务器端返回的关键字来控制Burp Proxy的消息拦截，这些在后面的章节中我
15
第三章 如何使用Burp Suite代理
们会进一步的学习。 所有流经Burp Proxy的消息，都会在http history记录下来，我们可以通
过历史选项卡，查看传输的数据内容，对交互的数据进行测试和验证。同时，对于拦截到的
消息和历史消息，都可以通过右击弹出菜单，发送到Burp的其他组件，如Spider、Scanner、
Repeater、Intruder、Sequencer、Decoder、Comparer、Extender，进行进一步的测试。如
下图所示：
数据拦截与控制
Burp Proxy的拦截功能主要由Intercept选项卡中的Forward、Drop、Interception is on/off、
Action、Comment 以及Highlight构成，它们的功能分别是： Forward的功能是当你查看过消
息或者重新编辑过消息之后，点击此按钮，将发送消息至服务器端。 Drop的功能是你想丢失
当前拦截的消息，不再forward到服务器端。 Interception is on表示拦截功能打开，拦截所有
通过Burp Proxy的请求数据；Interception is off表示拦截功能关闭，不再拦截通过Burp
Proxy的所有请求数据。 Action的功能是除了将当前请求的消息传递到Spider、Scanner、
Repeater、Intruder、Sequencer、Decoder、Comparer组件外，还可以做一些请求消息的修
改，如改变GET或者POST请求方式、改变请求body的编码，同时也可以改变请求消息的拦
截设置，如不再拦截此主机的消息、不再拦截此IP地址的消息、不再拦截此种文件类型的消
息、不再拦截此目录的消息，也可以指定针对此消息拦截它的服务器端返回消息。
16
第三章 如何使用Burp Suite代理
Comment的功能是指对拦截的消息添加备注，在一次渗透测试中，你通常会遇到一连串的请
求消息，为了便于区分，在某个关键的请求消息上，你可以添加备注信息。
Highlight的功能与Comment功能有点类似，即对当前拦截的消息设置高亮，以便于其他的请
求消息相区分。
除了Intercept中可以对通过Proxy的消息进行控制外，在可选项设置选项卡Options中也有很多
的功能设置也可以对流经的消息进行控制和处理。
17
第三章 如何使用Burp Suite代理
可选项配置Options
当我们打开可选项设置选项卡Options，从界面显示来看，主要包括以下几大板块（涉及https
的功能不包含在本章内容里，后面会一章专门叙述）：
客户端请求消息拦截
服务器端返回消息拦截
服务器返回消息修改
正则表达式配置
其他配置项
客户端请求消息拦截
客户端请求消息拦截是指拦截客户端发送到服务器端消息的相关配置选项，其界面如下：
主要包含拦截规则配置、错误消息自动修复、自动更新Content-Length消息头三个部分。
1. 如果intercept request based on the follow rules的checkbox被选中，则拦截所有符合勾
选按钮下方列表中的请求规则的消息都将被拦截，拦截时，对规则的过滤是自上而下进
行的。当然，我们可以根据自己的需求，通过【Up】和【Down】按钮，调节规则所在位
置和排序。同时，我们可以点击【Add】添加一条规则，也可以选中一条规则，通过点击
【Edit】进行编辑、点击【Remove】进行删除。当我们点击【Add】按钮时，会弹出规
则添加的输入对话框，如下图：
18
第三章 如何使用Burp Suite代理
拦截规则添加时，共包含4
个输入项。Boolean opertor表示当前的规则与其他规则是与的方式（And）还是或的方式
（Or）共存；Match type表示匹配类型，此处匹配类型可以基于域名、IP地址、协议、
请求方法、URL、文件类型、参数, cookies, 头部或者内容, 状态码, MIME类型, HTML页
面的title等。Match relationship表示此条规则是匹配还是不匹配Match condition输入的关
键字。当我们输入这些信息，点击【OK】按钮，则规则即被保存。
2. 如果Automatically fix missing的checkbox被选中，则表示在一次消息传输中，Burp Suite
会自动修复丢失或多余的新行。比如说，一条被修改过的请求消息，如果丢失了头部结
束的空行，Burp Suite会自动添加上；如果一次请求的消息体中，URl编码参数中包含任
何新的换行，Burp Suite将会移除。此项功能在手工修改请求消息时，为了防止错误，有
很好的保护效果。
3. 如果Automatically update Content-Length的checkbox被选中，则当请求的消息被修改
后，Content-Length消息头部也会自动被修改，替换为与之相对应的值。
服务器端返回消息拦截
服务器端返回消息拦截顾名思义是指拦截服务器端返回的消息的相关配置项，其界面如下：
它的功能主要包含intercept response based on the follow rules和Automatically update
19
第三章 如何使用Burp Suite代理
Content-Length header when the response edited两个选项，其功能分别与客户端请求消息
拦截中的intercept request based on the follow rules、Automatically update Content-Length
header when the request edited相对应，就不在赘述，请参上一节的内容。
服务器返回消息修改
服务器返回消息修改是指自动修改服务器端返回消息的相关设置项。其界面如下：
自上而下，每
一个选择项分别对应的功能是
显示form表单中隐藏字段
高亮显示form表单中隐藏字段
使form表单中的disable字段生效，变成可输入域
移除输入域长度限制
移动JavaScript验证
移动所有的JavaScript
移除标签
转换https超链接为http链接
移除所有cookie中的安全标志
通过服务器返回消息修改可选择项的设置，可以方便渗透测试人员在安全评估过程中突破原
有的数据限制，更好、更快地检测服务器端的安全性。
正则表达式配置
20
第三章 如何使用Burp Suite代理
此项配置主要用来自动替换请求消息和服务器端返回消息中的某些值和文本，它与前文的规
则的不同之处还在于支持正则表达式语言。
当点击【Add】按钮时，在弹出的匹配或替换规则输入对话框中我们可以看到，它可以对请求
和返回消息的消息头，消息体、请求参数名、请求参数值、请求的第一行进行匹配和替换。
例如，当我们要替换所有返回消息中的邮箱地址为PI:EMAIL时，可以参考下图
的设置填写输入项并保存验证。
其他配置项
21
第三章 如何使用Burp Suite代理
其他配置项主要是杂项设置。其界面如下：
自上而下依次的功能是
指定使用HTTP/1.0协议与服务器进行通信 这项设置用于强制客户端采用HTTP/1.0协议与
服务器进行通信，一般客户端使用的HTTP协议版本依赖于客户端浏览器，但某些服务器
或者应用，必须使用HTTP/1.0协议，此时可勾选此项
指定使用HTTP/1.0协议反馈消息给客户端 目前所有的浏览器均支持HTTP/1.0协议和
HTTP/1.1协议，强制指定HTTP/1.0协议主要用于显示浏览器的某些方面的特征，比如，
阻止HTTP管道攻击。
设置返回消息头中的“Connection：close” 可用于某些情况下的阻止HTTP管道攻击。
请求消息头中脱掉Proxy-* 浏览器请求消息中，通常会携带代理服务器的相关信息，此选
项主要用于清除消息头中的代理服务器信息。
解压请求消息中的压缩文件 某些应用在与服务器端进行交互时，会压缩消息体，勾选此
选项，则Burp Suite 会自动解压消息体
解压返回消息中的压缩文件 大多数浏览器支持压缩的消息体，勾选此选项，则Burp
Suite 会自动解压被服务器端压缩的消息体
禁用http://burp
允许通过DNS和主机名访问web接口 即允许通过域名或主机名访问Burp Suite
不在浏览器中显示Burp Suite错误 在我们使用Burp Suite时，如果发生了Burp Suite自身
的错误，会在浏览器中显示，如果勾选了此项，则不会在浏览器中显示此类错误。
禁用日志到历史和网站地图中 此选项的作用是阻止记录日志到历史和网站地图，在某些
情况下可能有用，比如说，通过上游服务器进行认证或者做正则表达式替换时，为了降
低内存的消耗，减少日志的储存，你可以勾选此项。
22
第三章 如何使用Burp Suite代理
拦截功能开始设置
这个选项主要用来配置intercept功能的生效方式，分为总是生效、 总是失效 、从上一次
的Burp Suite中恢复设置3种方式。
历史记录History
Burp Proxy的历史记录由HTTP历史和WebSockets历史两个部分组成。
HTTP历史界面由筛选过滤器、历史记录列表、消息详情3个部分组成。
当我们在某一条历史记录上单击，会在下方的消息详解块显示此条消息的文本详细信息。当
我们在某条消息上双击，则会弹出此条消息的详细对话框。
23
第三章 如何使用Burp Suite代理
我们可以点击对话框右上方的【Previous】、【Next】按钮，浏览上一条或下一条消息的内
容，也可以修改Raw的请求参数，然后执行多种【Action】操作。
历史消息列表中主要包含请求序列号、请求协议和主机名、请求的方式、URL路径、请求参
数、Cookie、是否用户编辑过消息、服务器端返回的HTTP状态码等信息。通过这些信息，我
们可以对一次客户端与服务器端交互的HTTP消息详情做出准确的分析，同时，在下方的详情