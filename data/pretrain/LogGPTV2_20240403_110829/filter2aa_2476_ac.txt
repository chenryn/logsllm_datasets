1) Do Not Populate: P1
Item
Quantity Reference
Manufacturer
Manuf. Part #
Distributor
Distrib. Part #
Description
1
1
BT1
MPD
BU2032SM-JJ-GTR
N/A
N/A
Battery Holder, CR2032, SMD
1b
1
N/A
Panasonic
CR2032
Digi-Key
P189-ND
Battery, Coin Cell, Lithium, 3V, 225mAh
2
9
C1, C2, C6, C7, C8, C9, C10, 
C12, C13
Kemet
C0603C104K4RACTU
Digi-Key
399-1096-2-ND
Capacitor, 0.1uF, 16V, Ceramic, 10%, X7R, 0603
3
1
C3
Samsung
CL10B103KB8NCNC
Digi-Key
1276-1921-2-ND
Capacitor, 0.01uF, 50V, Ceramic, 10%, X7R, 0603
4
2
C4, C5
AVX
06035A470JAT2A
Digi-Key
478-1171-2-ND
Capacitor, 47pF, 50V, Ceramic, 5%, C0G/NP0, 0603
5
1
C11
Kemet
T491A106M016AT
Digi-Key
399-3687-2-ND
Capacitor, 10uF, 16V, Tantalum, 20%, Size A
6
2
C14, C15
Taiyo Yuden
TMK212B7225KG-TR
Digi-Key
587-2991-2-ND
Capacitor, 2.2uF, 25V, Ceramic, 10%, X7R, 0805
7
4
D1, D9, D17, D25
Kingbright
AA3528SYCKT09
N/A
N/A
LED, Yellow, 250mcd, 2.0Vf, 590nm, Reverse Mount, PLCC-2
8
4
D2, D10, D18, D26
Kingbright
AA3528SECKT09
N/A
N/A
LED, Orange, 350mcd, 2.1Vf, 605nm, Reverse Mount, PLCC-2
9
8
D3, D4, D11, D12, D19, D20, 
D27, D28
Kingbright
AA3528SURCKT09
N/A
N/A
LED, Red, 350mcd, 1.95Vf, 630nm, Reverse Mount, PLCC-2
10
16
D5, D6, D7, D8, D13, D14, 
D15, D16, D21, D22, D23, 
D24, D29, D30, D31, D32
Kingbright
AA3528CGCKT09
N/A
N/A
LED, Green, 100mcd, 2.1Vf, 570nm, Reverse Mount, PLCC-2
11
1
D33
Kingbright
APT1608LQWF/D
N/A
N/A
LED, White, 35mcd, 2.65Vf, 0603
12
1
L1
TDK
MPZ2012S221AT000
Digi-Key
445-1568-2-ND
Inductor, Ferrite Bead, 220R @ 100MHz, 3A, 0805
13
1
L2
Taiyo Yuden
LBMF1608T100K
Digi-Key
587-1714-2-ND
Inductor, Wirewound, 10uH, 10%, 360mR, 80mA, 0603
14
1
P2
TE Connectivity
2173157-2
Verical
N/A
Connector, Micro-USB Type B, R/A, 5 position, SMD
15
2
Q1, Q3
Infineon
IRLML6402TRPBF
Digi-Key
IRLML6402PBFTR-ND
Transistor, MOSFET, P-Channel, 20V, 65mR @ 3.7A, SOT23
16
1
Q2
Infineon
IRLML2502TRPBF
Digi-Key
IRLML2502TRPBFTR-ND
Transistor, MOSFET, N-Channel, 20V, 45mR @ 4.2A, SOT23
17
8
R1, R3, R5, R6, R8, R9, R10, 
R15
Panasonic
ERJ-3GEYJ103V 
Digi-Key
P10KGTR-ND
Resistor, 10k, 5%, 1/10W, 0603
18
2
R2, R4
Panasonic
ERJ-3GEYJ270V
Digi-Key
P27GTR-ND
Resistor, 27 ohm, 5%, 1/10W, 0603
19
1
R7
Panasonic
ERJ-3GEYJ332V
Digi-Key
P3.3KGTR-ND
Resistor, 3.3k, 5%, 1/10W, 0603
20
4
R11, R12, R13, R14
Panasonic
ERJ-3GEYJ470V
Digi-Key
P47GTR-ND
Resistor, 47 ohm, 5%, 1/10W, 0603
21
1
SW1
Panasonic
EVP-AA202K
Digi-Key
P13348SDKR-ND
Switch, SPST, Tactile Momentary, 160gf, 3.5 x 2.9mm, J-Lead
22
1
U1
FTDI
FT231XS-R
Digi-Key
768-1129-2-ND
IC, USB-to-UART Bridge, SSOP20
23
1
U2
Microchip
ATMEGA328P-AU
N/A
N/A
IC, Microcontroller, 32KB Flash, TQFP32
23b
1
N/A
Microchip
N/A
N/A
N/A
IC, Microcontroller, Programming
24
1
U3
STMicroelectronics
LIS3DHTR
Digi-Key
497-10613-6-ND
IC, Accelerometer, 3-Axis, 2-16g, LGA16
25
1
U4
Nexperia
74HC595PW,118
Digi-Key
1727-3068-2-ND
IC, Shift Register, 8-bit, TSSOP16
26
1
U5
Microchip
MCP1700T-3002E/MB
Digi-Key
MCP1700T-3002E/MBCT-ND
Voltage Regulator, LDO, 3.0V, 250mA, SOT89-3
27
1
Y1
Kyocera
PBRC8.00MR50X000
Mouser
581-PBRC8.00MR50X
Resonator, 8MHz, 0.5%, Internal 15pF Capacitor, SMD
28
1
PCB
Electronic Interconnect
DCN1.0
N/A
N/A
PCB Fabrication, Assembly, Test
• ARDUINO 
• open source platform based on easy-to-use hw/sw/FW 
• worldwide community of users/contributors 
• 90% of FLash (27.6kB), 43% of RAM (887 bytes) 
• loop 
• set power state (battery, usb, usb charger) 
• check for/process interactive mode 
• check for/process fpc communication 
• update leds 
• sleep until accelerometer interrupt
Firmware
• Third-party libraries to add functionality to arduino 
• essential for rapid development 
• some code modifications required during badge integration 
• Low power 
• https://github.com/rocketscream/Low-Power 
• Adafruit_LIS3DH (ACCELEROMETER) 
• https://github.com/adafruit/Adafruit_LIS3DH 
• Adafruit_SENSOR (sensor abstraction layer) 
• https://github.com/adafruit/Adafruit_Sensor
LIBRARIES
• led matrix (individually addressable, dimmable, shift register) 
• https://github.com/marcmerlin/LED-Matrix 
• ADAFRUIT-GFX-LIBRARY (Core graphics primitives) 
• https://github.com/adafruit/Adafruit-GFX-
Library 
• DIO2 (Fast digital i/O) 
• www.codeproject.com/Articles/732646/Fast-
digital-I-O-for-Arduino 
• Timerone (ENHANCED TIMer, PERIODIC INTERRUPTS) 
• https://github.com/PaulStoffregen/TimerOne
LIBRARIES
• led matrix 
• Add #define swap() to .cpp to prevent compiling error 
• Remove #defines for DIO2 pinMode and digitalWrite 
• conflicted with the rest of badge code
code modifications
FABRICATION
FABRICATION
FABRICATION
ASSEMBLY
ASSEMBLY
ASSEMBLY
• raspberry pi 3 model b+ 
• shell script to program  ft231X and ATmega328P via usb 
• power on self test 
• visual inspection of leds 
• detection of accelerometer
programming / testing
• Human (Attendee), black silkscreen: 2,784 
• Goon, red: 156 
• Speaker, blue: 50 
• Village, blue: 90 
• Sponsor, grey: 120 
• Press, green: 100 
• TOTAL: 3,300
numbers
(not production versions)
• mechanical stress 
• reworking flex pcb 
• time frame
CHALLENGES
battery life
• cr2032 3V lithium coin cell 
• 225mah to 2V 
• Power up, idle: 3.3mA 
• all LEDs enabled: 10mA 
• sleep mode: 4-6uA 
• accelerometer to detect motion 
• sleep mode @ 10 seconds of      
inactivity
• access all fpc signals 
• UART, I2C, AVR ICSP 
• sao adapter 
• http://oshpark.com/shared_projects/X4QDh3nj
FPC BREAKOUT BOARD
1
2
3
4
SCL
SDA
FLEX_SOUT
FLEX_SIN
GPIO
AVR ICSP
SAO
UART
1
2
3
4
5
6
7
8
9
10
11
12
P1
HFW12R-2STE1LF
1
2
3
4
P2
PPPC022LFBN-RC
SAO Interface
VCC
SDA
SCL
VCC
FLEX_SENSEa
RSTa
MOSI
MISO
SCK
https://hackaday.io/project/52950-shitty-add-ons
PIP101
PIP102
PIP103
PIP104
PIP105
PIP106
PIP107
PIP108
PIP109
PIP1010
PIP1011
PIP1012
COP1
PIP201
PIP202
PIP203
PIP204
COP2
PITP101
COTP1
PITP201
COTP2
PITP301
COTP3
PITP401
COTP4
PITP501
COTP5
PITP601
COTP6
PITP701
COTP7
PITP801
COTP8
PITP901
COTP9
PITP1001
COTP10
PIP1010
PITP301
NLFLEX0SENSE#
PIP108
PITP501
NLFLEX0SIN
PIP109
PITP401
NLFLEX0SOUT
PIP101
PIP203
PITP1001
PIP1011
PITP201
NLGPIO
PIP103
PITP801
NLMISO
PIP104
PITP701
NLMOSI
PIP105
PITP601
NLRST#
PIP102
PITP901
NLSCK
PIP107
PIP204
NLSCL
PIP106
PIP202
NLSDA
PIP1012
PIP201
PITP101
• serial communication via fpc 
• set/clear individual led 
• read state of badge 
• arduino w/ custom shield 
• txs0104 level translator 
• 5v arduino  3v badge 
• dip switches 
• i2c, avr icsp footprints 
• http://oshpark.com/shared_projects/WGHZCahO
programming shield
programming shield
Status Indicator
IO0
IO1
IO2
IO3
IO4
IO5
IO6
IO7
MISO
SCK
RSTa
MOSI
AD0
1
AD1
2
AD2
3
AD3
4
AD4
5
AD5
6
P1
SSQ-106-03-G-S
IO0
1
IO2
3
IO3
4
IO4
5
IO5
6
IO6
7
IO7
8
IO1
2
P4
SSQ-108-03-G-S
MISO
1
VTG
2
SCK
3
MOSI
4
RESET
5
GND
6
P6
67997-206HLF
FLEX_SCL
FLEX_SDA
FLEX_SOUT
FLEX_SIN
MOSI
MISO
SCK
RSTa
GPIO
AVR ICSP
SAO
UART
1
2
3
4
5
6
7
8
9
10
11
12
P3
HFW12S-2STE1LF
VIO
1
2
3
4
5
6
12
11
10
9
8
7
SW1
218-6LPST
1
2
3
4
P5
DNP
SAO Interface
Mates to FCI 67997-204HLF (Male)
or TE 5-534206-2 (Female)
VIO
FLEX_SDA
FLEX_SCL
AVR ICSP Interface
BADGE_VCC
3
4
D1B
APB3025ESGC-F01
470
R2
470
R3
1
2
D1A
APB3025ESGC-F01
Red
Green
LEDG
LEDR
AD0
AD1
AD2
AD3
AD4
AD5
IO8
IO9
IO10
IO11
IO12
IO13
GND
AREF
SDA
SCL
IO8
1
IO9
2
IO10
3
IO11
4
IO12
5
IO13
6
GND
7
AREF
8
SDA
9
SCL
10
P2
SSQ-110-03-G-S
AVR_SENSE
1M
R4
VCCA
1
A2
3
A3
4
A1
2
A4
5
NC
6
OE
8
GND
7
NC
9
B4
10
B3
11
B2
12
VCCB
14
B1
13
U1
TXS0104EDR
10k
R1
VCCA  ARDUINO -> RASPBERRY PI (OPENFRAMEWORKS) -> PC
THE TREE OF PROMISE
• LED tree fruit 
• graphics displayed on a 3d cube 
• TOUCH SENSITIVE 
• TREE BRANCHES 
• ALGORITHM TO GENERATE UNIQUE BRANCH FOR EACH ATTENDEE
THE TREE OF PROMISE
• design documentation, code, etc. 
• www.grandideastudio.com/portfolio/defcon-
china-2019-badge 
resources
enjoy the conference!
@JOEGRAND | www.grandideastudio.com