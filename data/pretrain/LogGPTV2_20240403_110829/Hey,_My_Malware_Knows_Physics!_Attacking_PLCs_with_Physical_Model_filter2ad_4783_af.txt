water SCADA [4]. The attack drives the underlying physical
plant towards unsafe states by solving the partial differential
equations that model the water plant dynamics. The authors do
not discuss details of how such attacks can be implemented in
practical real-world settings and the involved challenges. Sim-
ilarly, system-theoretic models [39] [5] have been proposed to
identify stealthy cyber-physical attacks against the power grid
either through compromised measurements or dynamic load-
altering attacks. However, the models assume that attacker has
already compromised the required assets. These models could
be utilized by HARVEY to model the spoofed measurements
being sent to the HMI.
VIII. DISCUSSIONS AND MITIGATIONS
We discuss the generality of HARVEY, and describe poten-
tial mitigation mechanisms that could be deployed to protect
critical infrastructures against similar attacks.
A. Unique Challenges in ICS
In this section we elaborate on some of
the unique
challenges in the ICS space by comparing our PLC rootkit
against rootkits known from workstations and servers. We also
elaborate on the relation of industrial control systems and the
Internet of Things (IoT).
Rootkits. The concept of rootkits, or more generally, com-
promising the privileged software of a computing system with
the goal of hiding has been known for decades [29]. However,
most known rootkits target commodity operating systems like
Windows or Linux which have vast amounts of resources that
can be (mis-)used by the rootkit to hide itself and perform its
malicious actions. PLCs, on the contrary, have a signiﬁcantly
different software design (cf. Section II-A) which requires new
techniques for rootkits in the domain of ICS.
HARVEY, in particular, aims at manipulating the input and
output of a PLC, i.e., interaction with the physical world.
“Classical” rootkits operate only within the deterministic cyber
world, which makes hiding and other actions simpler. For
instance, a typical hiding method of Windows rootkits is to
remove themselves from a list structure maintained by the
OS [46]. HARVEY, however, has to compensate for the changes
to its physical world which will eventually feed back as input
readings.
Internet of Things (IoT). In recent years, the term IoT is
used over-extensively even though (or because) there is no
widely accepted and precise deﬁnition of the term. While there
are deﬁnitions that include ICS (e.g., every computing device
with a network connection) we would argue that ICS are not
part of the IoT. Many IoT devices are based on commodity
hardware and software (e.g., ARM Cortex-A processors and
Linux based OS) and thus not much different from systems like
smartphones. Hence, attacks on IoT devices, such as the com-
promise of the Google nest thermostat [30], are not applicable
to ICS. Another signiﬁcant difference between consumer IoT
devices and ICS is the real-time operation of PLCs, reﬂected
by the control loop design of the PLC’s ﬁrmware. IoT devices
rarely have strict real-time requirements. Further differences
include software deployment schemes (IoT device’s software
is controlled by the device manufacturer, PLC control logic
is installed by the programmer/operator), or device lifetime
(ICS might be operated for decades). Lastly, the operation of
IoT devices (and their effects on the environment) are often
unsupervised, hence, an IoT rootkit does not need to provide
a manipulated system state view to an operator.
B. Generality
HARVEY involved reverse engineering of a real-world com-
mercial PLC device and binary software modules. Although
we worked on a speciﬁc model, the techniques we used, such
as JTAG debugging and binary analysis, can be generalized
to PLC and controllers from other vendors, because they
generally follow similar technical approaches such as scan-
cycle-based execution paradigm followed by periodic I/O
interrupts and memory updates. Additionally, the proposed
two-way data manipulation attack can be implemented on other
(not necessarily power grid) control system settings, where
controller devices are used to monitor and control underlying
physical plants.
HARVEY can be protected against using three major mit-
i) remote attestation allows a veriﬁer to
igation solutions:
check the software integrity of a system. A trusted component
provides an authenticated measurement of the memory of the
device to be attested. Different approaches speciﬁcally for
embedded systems have been developed and could be applied
to PLCs [11], [18], [45]; ii) with secure boot, the integrity of
a device’s conﬁguration is not veriﬁed by an external entity
but by the device itself possibly using a trusted platform mod-
ule [6]. Secure boot ensures that only a known and trustworthy
software can be loaded on a device. Secure boot could be used
to ensure the integrity of PLC ﬁrmware; and iii) an external
bump-in-the-wire device between the PLC controller and the
physical plant could be monitoring the two-way sensor-to-PLC
and PLC-to-actuator data streams (unlike TSV [34] that would
sit between the HMI and PLC). The solution could possibly
check whether the control commands issued by the PLC satisfy
the plant’s essential safety requirements that must be deﬁned
by the operators. Additionally, the solution could implement
coarse-grained control consistency checks to validate whether
sensor measurements and actuation commands are consistent
in terms of how the plant should be controlled.
IX. CONCLUSIONS
We presented HARVEY, a PLC rootkit that implements a
physics-aware man-in-the-middle attack against cyber-physical
14
control systems. HARVEY damages the underlying physical
system, while providing the operators with the exact view
of the system that they would expect to see following their
issued control commands. Our experimental results with a
commercial PLC controller on a real-world power system test-
bed demonstrates the feasibility of HARVEY in practice.
REFERENCES
[1]
[2]
“IEEE standard test access port and boundary scan architecture,” IEEE
Std. 1149.1-2001, 2001.
(2010) Federal energy regulatory commission (ferc): Optimal power
ﬂow and formulation papers. http://www.ferc.gov/industries/electric/
indus-act/market-planning/opf-papers.asp.
[3] A. Abbasi and M. Hashemi, “Ghost in the plc: Designing an unde-
tectable programmable logic controller rootkit via pin control attack,”
2016.
[4] S. Amin, X. Litrico, S. S. Sastry, and A. M. Bayen, “Stealthy deception
attacks on water scada systems,” in Proceedings of the 13th ACM
International Conference on Hybrid Systems: Computation and Control,
ser. HSCC, 2010.
[5] S. Amini, H. Mohsenian-Rad, and F. Pasqualetti, “Dynamic load
altering attacks in smart grid,” in Innovative Smart Grid Technologies
Conference (ISGT), 2015 IEEE Power & Energy Society.
IEEE, 2015.
[6] W. Arbaugh, D. Farber, and J. Smith, “A secure and reliable bootstrap
architecture,” in IEEE Symposium on Security and Privacy, 1997.
[7] Z. Basnight, J. Butts, J. Lopez, and T. Dube, “Firmware modiﬁcation
attacks on programmable logic controllers,” International Journal of
Critical Infrastructure Protection, 2013.
[8] D. Beresford, “Exploiting Siemens Simatic S7 PLCs,” in Black Hat
USA 2011, ser. Black Hat USA ’11.
[9] W. Bolton, Programmable logic controllers. Newnes, 2015.
[10] S. Bose, S. H. Low, T. Teeraratkul, and B. Hassibi, “Equivalent relax-
ations of optimal power ﬂow,” Automatic Control, IEEE Transactions
on, 2015.
[11] F. Brasser, B. El Mahjoub, A.-R. Sadeghi, C. Wachsmann, and P. Koe-
berl, “TyTAN: Tiny Trust Anchor for Tiny Devices,” in Proceedings of
the 52nd Annual Design Automation Conference, ser. DAC, 2015.
[12] M. Br¨uggemann and R. Spenneberg, “Plc-blaster der virus im in-
dustrienetz,” https://events.ccc.de/congress/2015/Fahrplan/events/7229.
html, 2015.
[13] S. Cheung, B. Dutertre, M. Fong, U. Lindqvist, K. Skinner, and
A. Valdes, “Using model-based intrusion detection for scada networks,”
in Proceedings of the SCADA Security Scientiﬁc Symposium, Miami
Beach, Florida, jan 2007.
[14] E. Chien, L. OMurchu, and N. Falliere, “W32.Duqu - The precursor to
the next Stuxnet,” Symantic Security Response, Tech. Rep., 2011.
[15] R. Christie, “Power systems test case archive,” Electrical Engineering
dept., University of Washington, 2000.
[16] D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, and W. Polk,
“Internet x.509 public key infrastructure certiﬁcate and certiﬁcate revo-
cation list (crl) proﬁle,” https://tools.ietf.org/html/rfc5280, 2008.
[17] K. R. Davis, C. M. Davis, S. Zonouz, R. B. Bobba, R. Berthier, L. Gar-
cia, P. W. Sauer et al., “A cyber-physical modeling and assessment
framework for power grid infrastructures,” 2015.
[18] K. E. Defrawy, A. Francillon, D. Perito, and G. Tsudik, “SMART:
Secure and Minimal Architecture for (Establishing Dynamic) Root of
Trust,” in NDSS, 2012.
[19] H. Dommel and W. Tinney, “Optimal power ﬂow solutions,” IEEE
Transactions on Power Apparatus and Systems, 1968.
[20] K. T. Erickson, “Programmable logic controllers.” Institute of Electrical
and Electronics Engineers, 1996.
[21] S. Etigowni, D. Tian, G. Hernandez, K. Butler, and S. Zonouz, “Cpac:
Mitigating attacks against critical
infrastructure with cyber-physical
access control,” in Annual Computer Security Applications Conference
(ACSAC), 2016.
[22] European Network and Information Security Agency (ENISA). (2011)
Protecting industrial control systems – recommendations for Europe and
Member States. https://www.enisa.europa.eu/.
[23] F-Secure Labs, “BLACKENERGY and QUEDAGH: The convergence
of crimeware and APT attacks,” 2016.
[24] N. Falliere, L. O. Murchu, and E. Chien, “W32.Stuxnet Dossier,”
Symantic Security Response, Tech. Rep., 2010.
J. FitzPatrick and M. King, “Nsa playset: Jtag implants,” 2015.
[25]
[26] D. Formby, P. Srinivasan, A. Leonard, J. Rogers, and R. Beyah, “Who’s
in control of your control system? device ﬁngerprinting for cyber-
the Network and Distributed
physical systems.” in Proceedings of
System Security (NDSS) Symposium, 2016.
[27] A. Francillon and C. Castelluccia, “Code injection attacks on harvard-
architecture devices,” in Proceedings of the 15th ACM Conference on
Computer and Communications Security, ser. CCS ’08, 2008.
[28] A. G´omez-Exp´osito, A. J. Conejo, and C. Ca˜nizares, Electric energy
systems: analysis and operation. CRC Press, 2016.
15
[29] A. Hay, D. Cid, and R. Bray, OSSEC Host-Based Intrusion Detection
Guide. Syngress, 2008.
[30] G. Hernandez, O. Arias, D. Buentello, and Y. Jin, “Smart nest thermo-
stat: A smart spy in your home,” in BlackHat USA, 2014.
[31] A. Kleinman and A. Wool, “Accurate modeling of the siemens s7 scada
protocol for intrusion detection and digital forensics,” The Journal of
Digital Forensics, Security and Law: JDFSL, 2014.
J. Klick, S. Lau, D. Marzin, J.-O. Malchow, and V. Roth, “Internet-
facing plcs - a new back oriﬁce,” in Black Hat USA, 2015.
[32]
[33] Y. Liu, P. Ning, and M. K. Reiter, “False data injection attacks
against state estimation in electric power grids,” ACM Transactions on
Information and System Security (TISSEC), 2011.
[34] S. E. McLaughlin, S. A. Zonouz, D. J. Pohly, and P. D. McDaniel, “A
trusted safety veriﬁer for process controller code.” in Proceedings of the
Network and Distributed System Security (NDSS) Symposium, 2014.
[35] S. McLaughlin and S. Zonouz, “Controller-aware false data injection
against programmable logic controllers,” in IEEE SmartGridComm,
2014.
J. Mulder, M. Schwartz, M. Berg, J. R. Van Houten, J. Mario, M. A. K.
Urrea, A. A. Clements, and J. Jacob, “Weaselboard: Zero-day exploit
detection for programmable logic controllers,” tech. report SAND2013-
8274, Sandia Nat’l Laboratories, Tech. Rep., 2013.
[36]
[37] N. I. of Standards and Technology, “FIPS 180-4, Secure Hash Standard,
Federal Information Processing Standard (FIPS),” http://csrc.nist.gov/
publications/ﬁps/ﬁps180-4/ﬁps-180-4.pdf, Tech. Rep., 2012.
[38] OPC Foundation. (2015) Open platform communication foundation.
https://opcfoundation.org/.
[39] F. Pasqualetti, F. D¨orﬂer, and F. Bullo, “Cyber-physical attacks in power
networks: Models, fundamental limitations and monitor design,” in
IEEE CDC and ECC.
J. Reeves, “Autoscopy jr.: Intrusion detection for embedded control
systems dartmouth computer science technical report
tr2011-704 a
thesis,” Ph.D. dissertation, DARTMOUTH COLLEGE Hanover, New
Hampshire, 2011.
IEEE, 2011.
[40]
[42] Rockwell Automation.
[41] R. L. Rivest, A. Shamir, and L. Adleman, “A method for obtaining
digital signatures and public-key cryptosystems,” Commun. ACM, 1983.
download
center.
http://compatibility.rockwellautomation.com/Pages/
MultiProductDownload.aspx?famID=4&Keyword=Controller&crumb=
112.
J. Rrushi, H. Farhangi, C. Howey, K. Carmichael, and J. Dabell, “A
quantitative evaluation of the target selection of havex ics malware
plugin.”
(2015) Rockwell
automation
[43]
[44] C. D. Schuett, “Programmable logic controller modiﬁcation attacks for
use in detection analysis,” DTIC Document, Tech. Rep., 2014.
[45] R. Strackx, F. Piessens, and B. Preneel, “Efﬁcient isolation of trusted
subsystems in embedded systems,” in Security and Privacy in Commu-
nication Networks, ser. Lecture Notes of the Institute for Computer
Sciences, Social Informatics and Telecommunications Engineering.
Springer, 2010, vol. 50.
[46] Symantic, “Windows Rootkit Overview,” Symantic Security Response,
Tech. Rep., 2005.
[47] TechNavio.
(2014) Global
Security Market
global-industrial-control-systems-ics-security-market%C2%
A02014-2018.
2014-2018.
Industrial Control Systems
(ICS)
http://www.technavio.com/report/
[48] Texas Instruments . (2011-2013) Stellaris LM4F120H5QR ROM User’s
Guide. www.ti.com/lit/ug/spmu245a/spmu245a.
[49] Texas Instruments. (2007-2014) Stellaris LM3S2793 Microcontroller
Data Sheet. www.ti.com/lit/gpn/lm3s2793.
[50] L. Xie, Y. Mo, and B. Sinopoli, “False data injection attacks in
electricity markets,” in Smart Grid Communications (SmartGridComm),
2010 First IEEE International Conference on.
IEEE, 2010.
[51] D. Yang, A. Usynin, and J. W. Hines, “Anomaly-based intrusion
detection for scada systems,” 2006.
[52] B. Zhu and S. Sastry, “SCADA-speciﬁc intrusion detection/prevention
systems: A survey and taxonomy,” in Proceedings of the First Workshop
on Secure Control Systems, 2010.
[53] S. Zonouz, C. M. Davis, K. R. Davis, R. Berthier, R. B. Bobba, and
W. H. Sanders, “SOCCA: A security-oriented cyber-physical contin-
gency analysis in power infrastructures,” Smart Grid, IEEE Transactions
on, 2014.
[54] S. Zonouz, K. M. Rogers, R. Berthier, R. B. Bobba, W. H. Sanders, and
T. J. Overbye, “Scpse: Security-oriented cyber-physical state estimation
for power grid critical infrastructures,” IEEE Transactions on Smart
Grid, 2012.
[55] S. Zonouz, J. Rrushi, and S. McLaughlin, “Detecting industrial control
malware using automated plc code analytics,” Security & Privacy, IEEE,
2014.