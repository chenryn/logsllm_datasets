### C. Time Complexity of Synthesis Mechanism

**Impact of the Number of Buses:**
The execution time of our proposed security architecture synthesis mechanism, with respect to different test bus systems, is shown in Figure 5(a). In our experiments, we considered two scenarios:
1. 90% of the measurements are recorded for state estimation.
2. All measurements are recorded for state estimation.

From the figure, it is evident that the increase in execution time is quadratic. However, this execution time is significantly longer than that of the UFDI attack verification model (Figure 4(a)). This is because the synthesis process may require multiple executions of the verification model until a suitable security architecture is found.

**Impact of the Number of Taken Measurements:**
We also analyzed the impact of the number of taken measurements (as a percentage of the total potential measurements) on the time required for security architecture synthesis. The results for the 30 and 57-bus test systems are shown in Figure 5(b). We observed that as the number of taken measurements increases, the execution time increases linearly. 

Since the selection of the security architecture is based on the buses, an increase in the number of measurements does not directly increase the selection time. However, the verification time increases with more measurements, leading to an overall increase in the synthesis time.

### D. Memory Complexity

The memory required by the SMT solver [12] for executing our verification model and candidate security architecture selection model was evaluated in different IEEE bus test systems. The memory requirement for an SMT model execution depends mainly on the number of variables defined in the model and the number of intermediate variables generated by the solver. The memory analysis results, presented in Table IV, show that memory usage increases almost linearly with the number of buses.

### VI. Related Work

The concept of undetected false data injection (UFDI) attacks was first introduced in [2] and later extended in [17]. The authors discussed UFDI attacks under various scenarios, such as limited access to meters and limited resources to compromise meters, assuming the adversary has complete information about the grid. The general problem of computing attack vectors is NP-complete, and the authors presented heuristic approaches to find attack vectors.

Bobba et al. [6] showed that protecting a set of basic measurements is necessary and sufficient to detect UFDI attacks, ensuring observability. Kim and Poor [7] proposed a greedy sub-optimal algorithm to select a subset of measurements immune to false data injection. Kosut et al. [18] and others [19] proposed mechanisms based on statistical tests to detect UFDI attacks.

Vukovic et al. [10] proposed security metrics to quantify the importance of individual buses and the cost of attacking individual measurements. Rahman and Mohsenian-Rad [11] discussed UFDI attacks with incomplete or partial information, showing the impact of incomplete knowledge on the potentiality of UFDI attacks.

However, none of the above works provide a comprehensive model of UFDI attacks considering different attack attributes together. In our previous works [21, 22], we presented verification models for UFDI attacks with respect to a list of attack constraints and their impact on optimal power flow (OPF) solutions. In this work, we provide a broader attack scenario, including topology poisoning attacks, and show that novel UFDI attacks are possible by introducing topology errors along with false data injection. Kim and Tong [23] presented algebraic conditions for undetected topology attacks but did not address undetected attacks to state estimation leveraging topology poisoning. Our framework also includes an automated security architecture synthesis mechanism that considers the grid operator's resource constraints with respect to an attack model.

### VII. Conclusion

Securing state estimation against cyber-attacks is crucial for maintaining the integrity of the power grid. We propose an SMT-based formal framework to systematically investigate potential security threats, particularly the feasibility of stealthy cyber-attacks on state estimation. The framework allows operators to synthesize a security architecture that secures a set of buses for immunity against UFDI attacks. The scalability of the model is evaluated through experiments and case studies on different IEEE test systems. Our results show that our model can efficiently solve problems with hundreds of buses. For the IEEE 118-bus test system, the average execution time of our verification model is 7 seconds, while the synthesis mechanism takes around 2 minutes. This method provides a foundation for developing cybersecurity tools for modern power grids.