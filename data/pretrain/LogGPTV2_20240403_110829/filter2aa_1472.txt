Hacking Measured Boot and 
UEFI 
Dan Griffin 
JW Secure, Inc. 
WWJBD? 
Don’t let h@xors keep you from 
getting the girl… 
Introduction 
• What is UEFI? 
• What is a TPM? 
• What is “secure boot”? 
• What is “measured boot”? 
• What is “remote attestation”? 
Hardware Landscape 
• BYOD 
• Capability standards 
– Phones 
– Tablets 
– PCs 
Why the UEFI lock down? 
• OEM & ISV revenue streams 
• Importance of app store based user 
experience 
• Defense against rootkits & bad drivers 
• Screw the Linux community 
State of UEFI 
• Not new 
• Full featured – can even include a network 
stack (yikes!) 
• Software dev kits are available (Intel 
TianoCore) 
• Test hardware is available (Intel; 
BeagleBoard) 
UEFI secure boot 
• Usually can be disabled/modified by user  
o Behavior varies by implementation 
o Complicated, even for power users 
• But not on Windows 8 ARM. Options: 
o Buy a $99 signing certificate from VeriSign 
o Use a different ARM platform 
o Use x86 
Measured Boot + Remote 
Attestation 
What is measured boot? 
TPM 
BIOS 
Boot 
Loader 
Kernel 
Early 
Drivers 
Hash of next item(s) 
Boot Log 
[PCR data] 
[AIK pub] 
[Signature] 
What is remote attestation? 
Client Device 
TPM 
Signed 
Boot 
Log 
Attestation 
Server 
some token… 
Demo 
Measured Boot Tool 
(http://mbt.codeplex.com/)  
Part 1: What’s in the boot log? 
Demo 
Measured Boot Tool 
(http://mbt.codeplex.com/)  
Part 2: How do you do remote 
attestation? 
C: Get AIK creation nonce 
S: Nonce 
C: Get challenge (EK pub, AIK pub) 
S: Challenge 
C: Get attestation nonce 
S: Nonce 
C: Signed boot log 
S: Token 
Client 
Device 
Attestation 
Service 
Demo 
Sample application #1: reduce 
fraud, protect the bank from 
h@xors, get the girl 
Cloud Services Demand ID 
• Enterprise: BYOD 
• Consumer 
– Targeted advertising  
– eCommerce, mobile banking, etc. 
• But most user IDs are static & cached on device 
– That only works for low-value purchases 
– How to improve ID for high-value purchases? 
Low Friction Authentication 
• Each additional screen requiring user input 
– Slows down the process while user reorients 
– Causes more users to abandon the web site 
• In contrast, Progressive Authentication: 
– Let users investigate a site using just cookies 
– Defers questions until information is needed 
– Reduces user drop out from frustration 
Splash Screen 
• The screen a user sees 
when app launched 
• With similar data in the 
launch tile 
User Sign in 
• User name can be 
taken from cookie 
• But account details 
are hidden until the 
user enters a 
password 
Enrollment - 1 
• The first time the app 
is used the user must 
active the app 
• When this button is 
pressed an SMS 
message is sent to the 
phone # on file 
Enrollment - 2 
• After the user gets the 
pin from the SMS 
message, it is entered 
• After this the user 
proceeds as with a 
normal sign-in 
procedure 
After Sign-in 
• The user sees all 
account information 
User tries to move 
money 
• When user goes to 
move $ out of account 
• The health of the device 
is checked 
Remediation Needed 
• If the device is not 
healthy enough to 
allow money transfer 
• The user is directed to 
a site to fix the problem 
Demo 
Sample application #2: reduce 
fraud, protect MI6 from h@xors,  
get the girl 
Pseudo-Demo 
Sample application #3: protect the 
data from h@xors, etc… 
Policy-Enforced File Access 
• BYOD 
• Download sensitive files from document 
repository 
• Leave laptop in back of taxi 
Weaknesses 
• UEFI toolkits evolving rapidly 
• Provisioning; TPM EK database 
• Integrity of the TPM hardware 
• Hibernate file is unprotected  
• Trend of migration from hardware to 
firmware 
• Patching delay & whitelist maintenance 
Conclusion 
• Likelihood of mainstream adoption? 
• What the consumerization trend means for 
hackers 
• Opportunities in this space 
Questions? 
PI:EMAIL 
206-683-6551 
@JWSdan 
JW Secure provides custom security 
software development services.