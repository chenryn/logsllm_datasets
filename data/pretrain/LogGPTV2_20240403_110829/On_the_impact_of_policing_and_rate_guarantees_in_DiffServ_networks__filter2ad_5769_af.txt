the video stream itself.  However, despite those similarities, some 
differences  were  also  observed.  They  reflected  the  impact  of  a 
different  server  technology  as  well  as  differences  in  the  network 
configurations  that  were  used,  and  it  is  worthwhile  to  briefly 
review them as well as their causes. 
The  main  difference  is  that  much  higher  token  rates  were 
required  in  order  to  achieve  nearly  perfect  video  quality.    As  a 
matter of fact, because our maximum token rate was limited by the 
speed of the V.35 link between routers 2 and 3 (about 2 Mbps), we 
could not exceed this value, which prevented us from achieving the 
ideal  quality  score  of  0  when  the  token  bucket  depth  was  3000 
bytes.    This  was  in  spite  of  the  fact  that  the  “maximum”  rate 
specified  when encoding both clips was limited to about 1 Mbps 
(see Table 3). In other words, despite a token rate of about twice 
the maximum encoding rate, we were still not able to achieve the 
best quality level.  Note that increasing the token bucket depth to 
4500  bytes  largely  eliminates  this  difference.  The  main  reason 
behind this behavior is the relatively bursty nature of the server’s 
output.  As a matter of fact, the main reason that the experimental 
results we report are limited to the 1 Mbps clip is that we were not 
able to achieve decent levels of quality at higher rates, at least not 
with  the  network  configurations  we  were  using.    This  was 
observed even after switching over to TCP streaming and relying 
on shaping in the Linux router to which the server was connected.  
UDP  streaming  remained 
to  allow  meaningful 
the  network  configurations  we  were 
experimentation 
considering. 
  TCP  streaming,  because  of  the  intrinsic  rate 
adaptation  capability  of  TCP,  resulted  in  a  smoother  traffic  flow 
that produced better quality results.   
too  bursty 
in 
Quality Index, 
B=3000 
Frame Loss, 
B=3000 
Quality Index, 
B=4500 
Frame Loss, 
B=4500 
s
s
o
l
e
m
a
r
F
/
x
e
d
n
I
y
t
i
l
a
u
Q
1.00 
0.90 
0.80 
0.70 
0.60 
0.50 
0.40 
0.30 
0.20 
0.10 
0.00 
500 
1000 
1500 
Token Rate 
2000 
2500 
Figure 15. Local Testbed Experiments (Lost clip at 1Mbps) – 
Quality and Frame Loss vs Token Rate. 
A related point worth emphasizing in this context is that the 
difference in video quality achieved by increasing the token bucket 
depth from 3000 bytes to 4500 bytes is much more substantial in 
this setting.  In other words, the benefits derived from allowing a 
slight  increase  in  bucket  size  are  much  larger  with  this  type  of 
server  and  encoding,  than  when  using  constant  rate  encoding 
together  with  servers  that  attempt  to  pace  their  transmissions,  as 
was  the  case  for  the  QBone  experiments.    This  seems  to  add 
further support to considering slightly larger bucket sizes than the 
two MTUs limit that was originally mentioned for services built on 
the EF PHB. 
5.  Conclusion 
this  paper,  we  have  carried  out  an  experimental 
investigation of the relation that exists between (user level) video 
quality  and  various  network  configurations  embodying  a  service 
based  on  the  Diff-Serv  EF  PHB.    The  experiments  considered 
different  types  of  video  clips,  different  encoding  rates,  different 
video servers, and evaluated the quality of received video streams 
transmitted  over  both  local  and  wide  area  (QBone)  testbeds  for 
different settings of the token bucket associated with the “service” 
assigned  to  the  stream.    The  assessment  of  the  quality  of  the 
received  video  was  performed  using  an  objective  quality 
measurement tool that provides accurate estimates of video quality, 
as  users  perceive  it.    The  main  focus  was  on  the  impact  of  the 
In 
dropping  actions  performed  by  the  policer  on  non-conformant 
packets. 
One of the  findings of the investigation was to confirm that 
frame  loss  itself  is  not  necessarily  an  accurate  measure  of  video 
quality.    The  evolution  of  the  two  is  often  decoupled,  so  that  in 
some  instances  large  increases  in  allocated  rate  do  not  translate 
into significant quality improvements, while in other cases, a small 
amount of additional bandwidth can yield a drastically better video 
quality.    This  conclusion  does  not  appear  to  significantly  depend 
on  the  type  of  video  used,  but  the  exact  relation  between  video 
quality and frame loss (or token rate) does depend on the type of 
server and encoding used.  In general, a token rate larger than the 
encoding  used  is  needed  in  order  to  achieve  high  quality  for  the 
received  video.    The  required  margin  above  the  encoding  rate  is 
where the dependency on the server and encoding used comes in. 
finding 
Another 
interesting 
that  emerged 
from  our 
investigation is that a small increase of the token bucket depth used 
by  the  policer  can  translate  into  substantial  improvements  in  the 
quality  of  the  received  video.  Allowing  such  an  increase  should 
clearly be weighed against the larger burstiness it will allow and its 
associated  impact  on  frame  losses  and  delays  in  the  network.  
Specifically, a larger token bucket means that larger EF bursts can 
now  enter  the  network.  This  can  in  turn  contribute  to  the 
accumulation  of  larger  bursts  as  the  EF  traffic  traverses  multiple 
hops,  e.g.,  [4].  However,  given  the  magnitude  of  the  observed 
improvements  and  the  relatively  small  increase  in  token  bucket 
depth  that  is  required,  this  may  be  an  option  worth  considering 
when building services that will use the EF PHB.  Especially since 
increasing the potential burst size by one MTU (from two to three) 
is unlikely to contribute a significant increase in burstiness in the 
network, at least not for moderate EF loads. 
Quality Index 
B=3000 
Frame Loss 
B=3000 
Quality Index 
B=4500 
Frame Loss 
B=4500 
s 
s
o
l
e
m
a
r
F
/
x
e
d
n
I
y
t
i
l
a
u
Q
1.00 
0.90 
0.80 
0.70 
0.60 
0.50 
0.40 
0.30 
0.20 
0.10 
0.00 
500.0 
1000.0 
1500.0 
Token Rate 
2000.0 
2500.0 
Figure 16. Local Testbed Experiments (Lost clip at 1Mbps) – 
Quality and Frame Loss vs Token Rate. 
6.  Acknowledgments 
The authors would like to acknowledge the assistance of the many 
individuals  who  made  the  experiments  over  the  Internet2  QBone 
possible.    They  include  Matthew  Davy,  Indiana  University, 
Shumon  Huque,  Dikram  Kassabian,  and  Jon  Looney,  ISC, 
University of Pennsylvania, Ben Teitelbaum, Internet2, Tim Ward, 
Daniel Weaver, and Jeremy Weinberger, NorthWestern University, 
Ira  Winston,  University  of  Pennsylvania,  Rick  Wood, 
NorthWestern  University,  and  Matthew  Zekauskas,  ANS.    In 
addition,  we  would  like  to  thank  iCAIR  and  in  particular  Joel 
Mambretti,  as  well  as  IBM  for  providing  us  with  access  to  the 
Video  Charger™  video  server  that  was  used  for  streaming  video 
over the QBone, and IBM for donating most of the equipment used 
in the local testbed experiments. 
7.  References 
[1]  ANSI  T1.801.03  –  1996,  “American  National  Standard  for 
Telecommunications  -  Digital  Transport  of  One-Way  Video 
Signals – Parameters for Objective Performance Assessment,” 
American National Standards Institute. 
[2]  W.  Ashmawi,  R.  Guerin,  S.  Wolf,  and  M.  Pinson,  “On  the 
impact  of  policing  and  rate  guarantees  in  Diff-Serv 
networks:    A 
application 
perspective.”    Technical  report,  2001,  University  of 
Pennsylvania, http://pender.ee.upenn.edu/~guerin. 
streaming 
video 
[3]  ATM  Forum  –  “Traffic  Management  Specification  Version 
4.1,” (AF-TM-0121.000), John Kenney, Ed., March 1999. 
[4]  J. C. R. Bennett, K. Benson, A. Charny, W. F. Courtney, and 
J.-Y. Le Boudec, “Delay Jitter Bounds and Packet Scale Rate 
Guarantee 
for  Expedited  Forwarding.”  Proceedings  of 
INFOCOM’2001, Anchorage, Alaska, April 2001. 
[5]  D. Black, M. Carlson, E. Davies, Z. Wang, W. Weiss, and S. 
Blake, “An Architecture for Differentiated Services.”  Internet 
Engineering Task Force, Request For Comments, RFC 2475 
(Informational), December 1998.  
[6]  B.  Carpenter,  D.  Kandlur,  and  J.  Mambretti,  “Experiments 
with  Differentiated  Services  at  iCAIR.”    Proceedings  of  the 
First  Joint  Internet2/DOE  QoS  Workshop,  Houston,  TX, 
February 2000.  
[7]  ITU-R  Recommendation  BT.500, 
for 
subjective  assessment  of  the  quality  of  television  pictures,” 
Recommendations of the ITU, Radiocommunication Sector. 
“Methodology 
[8]  ITU-R Recommendation BT.601-2, “Encoding parameters of 
digital television for studios,” Recommendations of the ITU, 
Radiocommunication Sector. 
[9]  ITU-T  Recommendation  P.910,  “Subjective  video  quality 
applications,” 
ITU,  Telecommunications 
for  multimedia 
the 
assessment  methods 
Recommendations 
of 
Standardization Sector. 
[16] V.  Jacobson,  K.  Nichols,  and  K.  Poduri,  “An  Expedited 
Forwarding PHB.” Internet Engineering Task Force, Request 
For Comments, RFC 2598 (Standards Track), June 1999.  
[17] M.  Knee,  “The  Picture  Appraisal  Rating  (PAR)  –  a  single-
ended picture quality measure for MPEG-2.”  Proceedings of 
the  International  Broadcasting  Convention,  Amsterdam,  The 
Netherlands, September 2000. 
[18] The MPEG Home Page, http://www.cselt.it/mpeg/. 
[19] K. Nichols, S. Blake, F. Baker, D. Black, “Definition of the 
Differentiated Services Field (DS Field) in the IPv4 and IPv6 
Headers.”  Request  For  Comments,  RFC  2474  (Standards 
Track), December 1998. 
[20] T.  V.  Lakshman,  A.  Ortega,  and  A.  R.    Reibman,  “VBR 
Video:  Trade-Offs and Potentials.” Proc. IEEE, pp. 952-973, 
May 1998.  
[21] J.-Y. Le Boudec and O. Verscheure, “Optimal Smoothing for 
Guaranteed Service.” IEEE/ACM Trans. Networking, Vol. 8. 
No. 6, pp. 689-696, December 2000. 
[22] V.  Paxson,  G.  Almes,  J.  Mahdavi,  and  M.  Mathis, 
“Framework 
Internet 
Engineering Task Force, Request For Comments, RFC 2330 
(Informational), May 1998.  
IP  Performance  Metrics.” 
for 
[23] R. Rejaie, M. Handley, and D. Estrin, “Quality Adaptation for 
Congestion  Controlled  Video  Playback  Over  the  Internet.”  
Proceedings  of  SIGCOMM’99,  Cambridge,  MA,  August 
1999. 
[24] J. Rexford and D. Towsley, “Smoothing Variable Rate Video 
in and Internetwork.” IEEE/ACM Trans. Networking, Vol. 7, 
No. 2, pp. 202-215, April 1999. 
[25] B.  Teitelbaum,  Editor,  “QBone  Architecture 
Document available at http://qbone.internet2.edu/. 
(v1.0).” 
[26] VQEG Home page, http://www-ext.crc.ca/vqeg/frames.html. 
[27] ITU-T  Recommendation  J.143,  "User  requirements  for 
objective  perceptual  video  quality  measurements  in  digital 
cable 
ITU, 
Telecommunication Standardization Sector. 
television,”  Recommendations 
the 
of 
[10] Cisco Committed Access Rate, 
http://www.cisco.com/warp/public/732/Tech/car/. 
[11] T. Ferrari and P. Chimento “A Measurement-based Analysis 
of Expedited Forwarding PHB Mechanisms.”  Proceedings of 
IWQoS 2000, Pittsburgh, PA, June 2000.  
[12] J.  Heinanen,  F.  Baker,  W.  Weiss,  and  J.  Wroclawski, 
“Assured  Forwarding  PHB  Group.”  Internet  Engineering 
Task  Force,  Request  For  Comments,  RFC  2597  (Standards 
Track), June 1999. 
[13] J.  Heinanen  and  R.  Guerin,  “A  Single  Rate  Three  Color 
Marker.”  Internet  Engineering  Task  Force,  Request  For 
Comments, RFC 2697 (Informational), September 1999. 
[14]  J.  Heinanen  and  R.  Guerin,  “A  Two  Rate  Three  Color 
Marker.”  Internet  Engineering  Task  Force,  Request  For 
Comments, RFC 2698 (Informational), September 1999. 
[15] M.  Hemy,  U.  Hengartner,  P.  Steenkiste,  T.  Gross,  “MPEG 
System Streams in Best-Effort Networks.” Packet Video 99, 
Columbia University, New York, NY, April 1999. 
[28] The Windows Media Home page, 
http://www.microsoft.com/windows/windowsmedia/. 
[29] S.  Wolf  and  M.  H.  Pinson,  “Spatial-Temporal  Distortion 
Metrics  for  In-Service  Quality  Monitoring  of  Any  Digital 
Video  System.”  Proceedings  of  SPIE 
International 
Symposium  on  Voice,  Video,  and  Data  Communications, 
Boston, MA, September 11-22, 1999. 
♣  Certain  commercial  equipment  and  software  products  are 
identified  in  this  paper  to  ensure  completeness  and  accuracy  in 
describing  the  information  presented.    In  no  case  does  such 
identification 
the 
University of Pennsylvania or the National Telecommunications and 
Information Administration, nor does it imply that the equipment or 
software is necessarily the best available for this application. 
imply  recommendation  or  endorsement  by