name, password, browser user-agent, and IP address.
3.3 Keyloggers & Victims
Through an undisclosed source, we obtain a corpus of 15,579 key-
logger binaries and information related to 2,992 victims including
the timestamp they were infected and the passwords stolen. As
many keyloggers are pre-configured to use email as an exfiltration
point (discussed in Section 2), we extend our phishing detection
logic (Figure 2) to include keyloggers. To start, we execute each
binary in a Windows sandbox seeded with a Chrome and Firefox
password store containing a set of honey credentials. During execu-
tion, we monitor outbound SMTP connections to identify message
bodies that contain the credentials. We then extract string invari-
ants that do not contain system information related to the sandbox
environment, time of execution, or honey credentials and convert
these invariants into rules. In total, we require only 315 rules to
cover all of the keyloggers in our corpus, a marked lack of diversity
compared to phishing kits that likely stems from the complexity
of writing desktop software versus PHP. As before, we trial these
rules on a test corpus of 100,000 emails which generates 0 false
positives. Using the same deployment strategy as phishing kits,
we flag a total of 788,606 messages (excluding 1.7% filtered by our
minimum requirement of 20 messages per exfiltration point) sent
to 1,034 exfiltration points. We expect our keylogger coverage to
be less than phishing kits as only 39.0% of samples in our corpus
use Gmail as an exfiltration point (Table 5).
3.4 Limitations
Our heuristic approach to credential leak identification and reliance
on samples of phishing kits and keyloggers leads to incomplete
coverage. As such, our perspective of the volume of the problem
should be treated only as a lower bound. Nevertheless, our dataset
of victims and blackhat tools provides a significant enough sample
to evaluate the hijacking risk to users who have had their password
exposed. Finally, we caution that our corpus of victims is not a ran-
dom sample: victims of credential leaks are biased towards the user
base of major US services (though many other non-US companies
may have suffered breaches), while the victims of phishing kits and
keyloggers are biased towards the unknown blackhat distribution
strategies beyond our visibility.
3.5 Ethics
The ethics of using data exposed by data breaches or other illicit ori-
gins remains a hotly debated topic in the security community [11].
We never purchase or trade credential leaks. We exclusively use
the password information in our dataset to evaluate hijacking risks.
Furthermore, for all Google users in our dataset, we re-secure all
accounts via a forced password reset in the event their real cre-
dentials were exposed. This remains one of Google’s long standing
policies [4]. We do not attempt to check the validity of passwords
for any other site. Finally, when measuring the volume of phishing
and keylogger activity on Gmail, we reiterate that all detection
occurs by our anti-abuse systems in a fully programmatic fashion.
4 VICTIMS WITH STOLEN CREDENTIALS
As a first step towards understanding the landscape of stolen creden-
tials, we examine the frequency that users fall victim to credential
theft, demographic information related to those victims, and other
information beyond passwords that attackers also steal.
4.1 Volume of Victims
In order to offer a perspective of the sheer amount of credential in-
formation accessible to miscreants, we provide a breakdown across
each of our collection sources. We identify 1,484,680,141 unique
username, password combinations that belong to 1,092,567,042
unique usernames. For phishing kits and keyloggers, we provide a
weekly breakdown in Figure 4 of the number of messages flagged by
our rules as containing stolen credentials. On average, miscreants
Table 6. This list reflects the mail providers who might be most im-
pacted by stolen credentials, though this approach does not capture
social media accounts or commercial and banking accounts that
rely on service-specific usernames rather than an email address.
We find that Gmail, Yahoo, and Hotmail make up 50% of victims
regardless of the origin of the credentials. In total, however, there
are over 25 million email domains captured by our dataset, reflect-
ing the challenge of re-securing exposed password material across
tens of millions of services.
As an approximation of the geographic distribution of victims,
we examine the sign-up locations of Google users appearing in our
dataset. Table 7 provides a breakdown of the top 10 geolocations.
For credential leaks, we find the geographic distribution of victims
reflects the aggregate user bases of major US online services at the
time of their breach in 2012–2014, with the United States, India,
and Brazil accounting for 49.3% of victims. In contrast, phishing
attacks heavily favor the United States, followed in popularity by
South Africa and Canada—all countries with large English-speaking
populations. This may result from bias in our phishing kit corpus,
or from the selection criteria of attackers. Keylogging victims are
the most distinct, where Turkey, the Philippines, Malaysia, Thai-
land, Iran, and Nigeria appear in the top 10 geolocations, unlike for
phishing victims or credential leak victims. While we lack visibility
into the keylogger distribution campaigns, it is possible these infec-
tions stem from governments or authorities as previously examined
by Marczak et al. [27]. Taken as a whole, our demographic break-
down suggests that miscreants tailor their distribution campaigns
to specific regions or even targets.
4.3 Additional Information Exposed
While our study focuses on stolen credentials, additional sensitive
user information may be exposed by credential leaks, phishing kits,
and keyloggers. Based on the output of our leak classifier, only
3.8% of victims of credential leaks have their geolocation exposed
in the form of a postal address or IP address, and approximately
0.000009% of leaks included User-Agent information. To evaluate
the same metrics for phishing kits and keyloggers, we manually
compile a list of keywords in multiple languages related to real
names, credit cards, addresses, phones, device information, and
secret questions, and then search the message templates of phishing
kits and keyloggers for these keywords.
Our results, shown in Table 8, indicate that phishing kits fre-
quently collect additional authentication factors such as secret ques-
tions, geolocation details, and device-related information, likely to
bypass login challenges for services that attempt to detect suspi-
cious sign-ins (discussed further in Section 5). This behavior is less
common for keyloggers, where fewer than 0.1% of keylogger vari-
ants explicitly gather phone details or secret questions that might
be used as login challenges (though it nevertheless may appear in
keystroke logs). Among our phishing kit corpora, we also observe
that 39.9% of variants collect credit card information and 8.8% of
variants collect social security numbers (US-specific). Our findings
indicate that while credential leaks may expose the largest number
of passwords, phishing kits and keyloggers provide more flexibility
to adapt to new account protections.
(a) Phishing
(b) Keylogger
Figure 4: Weekly breakdown of the number of messages our
rules flag as containing stolen credential information.
using the phishing kits in our corpus collect 234,887 potentially
valid credentials every week, and for keyloggers, 14,879 per week.
There is a noticeable dip in phishing kit activity around the hol-
iday season in 2016, potentially due to limited campaign activity
by miscreants or limited online activity by victims. Our results
illustrate that credential theft is a multi-pronged problem. Even
absent relatively rare data breaches that expose hundreds of mil-
lions of credentials in a single incident, there are still hundreds
of thousands of users that fall victim to phishing and keyloggers
every week—and that covers only what we detect. As such, we ar-
gue there remains a significant gap between the threats that users
are exposed to and protections in place, such as education efforts,
warnings, or automated defenses.
4.2 Demographics
In terms of unique users, our dataset includes 1,092,567,042 creden-
tial leak victims, 3,779,664 phishing victims, and 2,992 keylogger
victims. We provide a breakdown of the top 10 mail providers used
by each victim (in the event their username is an email address) in
lllllllllllllllllllllllllllllllllllllllllllllllllllll100K200K300K400KApr 2016Jul 2016Oct 2016Jan 2017Apr 2017Potential victims10K15K20K25KApr 2016Jul 2016Oct 2016Jan 2017Apr 2017Potential victimsTable 6: Distribution of emails providers used by victims of credential leaks, phishing kits, and keyloggers. For credential leaks,
we note that none of the exposed credentials in our study originate from a breach at an email provider (to our knowledge). All
email addresses were exposed due to a third-party breach where the company used email addresses as identifiers.
Credential Leak Victims
Phishing Victims
Keylogger Victims
Email provider
yahoo.com
hotmail.com
gmail.com
mail.ru
aol.com
yandex.ru
hotmail.fr
hotmail.co.uk
live.com
rambler.ru
Other
Popularity
19.5%
19.0%
12.2%
4.7%
3.6%
1.4%
1.3%
1.0%
1.0%
0.8%
35.4%
Email provider
gmail.com
yahoo.com
hotmail.com
outlook.com
mail.ru
live.com
yahoo.co.in
orange.fr
ymail.com
hotmail.fr
Other
Popularity
27.8%
12.0%
11.3%
1.0%
0.8%
0.6%
0.5%
0.5%
0.4%
0.4%
44.7%
Email provider
gmail.com
yahoo.com
hotmail.com
aol.com
hotmail.fr
msn.com
hotmail.co.uk
comcast.net
sbcglobal.net
163.com
Other
Popularity
29.8%
11.5%
9.4%
3.3%
1.6%
1.1%
0.9%
0.8%
0.8%
0.7%
44.7%
Table 7: Distribution of geolocations for victims of credential leaks, phishing kits, and keyloggers with Google accounts.
Credential Leak Victims
Phishing Victims
Keylogger Victims
Signup location
United States
India
Brazil
Spain
France
Italy
United Kingdom
Canada
Japan
Indonesia
Other
Popularity
38.8%
7.9%
2.6%
2.5%
2.1%
1.9%
1.8%
1.7%
1.5%
1.4%
37.8%
Signup location
United States
South Africa
Canada
India
United Kingdom
France
Spain
Australia
Malaysia
Italy
Other
Popularity
49.9%
3.6%
3.3%
2.8%
2.5%
1.9%
1.9%
1.8%
1.1%
1.0%
30.2%
Signup location
Brazil
India
United States
Turkey
Philippines
Malaysia
Thailand
Iran
Nigeria
Indonesia
Other
Popularity
18.3%
9.8%
8.0%
5.8%
3.8%
3.3%
3.1%
3.1%
2.8%
2.7%
39.5%
Table 8: Additional information stolen by phishing kits and keyloggers. We note that some phishing kits exclusively collect
credit card details rather than usernames and passwords.
Data type
Email
Password
Geolocation
Phone number
Device information
Secret questions
Full name
Credit card
SSN
Phishing kits Keyloggers
97.8%
100%
73.6%
0.1%
67.9%
0.1%
85.3%
2.1%
0.1%
81.4%
83.0%
82.9%
18.1%
16.2%
7.4%
45.8%
39.9%
8.8%
5 RISK OF STOLEN CREDENTIALS
With billions of potentially valid passwords available to miscre-
ants, we evaluate the risk of an attacker accessing a victim’s email
account—and through transitive trust, the victims entire online
identity. We quantify this risk along multiple dimensions: current
password match rates; historical password match rates; successful