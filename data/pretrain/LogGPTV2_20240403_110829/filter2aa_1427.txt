1
The Tor Project
Our mission is to be the global resource for 
technology, advocacy, research and 
education in the ongoing pursuit of freedom 
of speech, privacy rights online, and 
censorship circumvention. 
2
● Online Anonymity
– Open Source
– Open Network
● Community of 
researchers, 
developers, users and 
relay operators.
● U.S. 501(c)(3) non-
pro%t organization
3
Estimated 2,000,000 to 8,000,000
 daily Tor users
4
Threat model:
what can the attacker do?
Alice
Anonymity network
Bob
watch (or be!) Bob!
watch Alice!
Control part of the network!
5
Anonymity isn't encryption: 
Encryption just protects contents.
Alice
Bob
“Hi, Bob!”
“Hi, Bob!”
attacker
6
7
Anonymity serves different 
interests for different user groups.
Anonymity
“It's privacy!” Private citizens
8
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Businesses
“It's network security!”
“It's privacy!”
9
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Governments
Businesses
“It's traffic-analysis
resistance!”
“It's network security!”
“It's privacy!”
10
Anonymity serves different 
interests for different user groups.
Anonymity
Private citizens
Governments
Businesses
“It's traffic-analysis
resistance!”
“It's network security!”
“It's privacy!”
Human rights
activists
“It's reachability!”
11
12
13
14
15
16
Tor's safety comes from diversity
● #1: Diversity of relays. The more relays 
we have and the more diverse they are, 
the fewer attackers are in a position to do 
traffic confirmation. (Research problem: 
measuring diversity over time)
● #2: Diversity of users and reasons to use 
it. 50000 users in Iran means almost all of 
them are normal citizens.
17
Transparency for Tor is key
● Open source / free software
● Public design documents and 
specifications
● Publicly identified developers
● Not a contradiction:                    
privacy is about choice!
18
Tor censorship epochs
● Background / Phase 1 (2006-2011):
Bridges, pluggable transports
● Phase 2 (2011-2019):
Active probing, obfsproxy, domain 
fronting, many more countries
● Phase 3 (2019-?):
Snowflake, obfs4, decoy routing, ...
19
Relay versus Discovery
There are two pieces to all these 
“proxying” schemes:
a relay component: building circuits, 
sending traffic over them, getting the 
crypto right
a discovery component: learning what 
relays are available
20
The basic Tor design uses a simple 
centralized directory protocol.
R2
R1
Alice
Trusted directory
Trusted directory
R3
cache
cache
Relays publish
self-signed
descriptors.
Authorities
publish a consensus
list of all descriptors
Alice downloads
consensus and
descriptors from
anywhere
21
Early blocking
● 2006: Thailand blocks our website 
by DNS
● 2007: Iran/Saudi Arabia/others use 
websense/smartfilter to block Tor’s 
http directory fetches.
The fix: put everything inside TLS.
22
23
24
Iran throttles SSL (June 2009)
● We made Tor's TLS handshake look 
like Firefox+Apache.
● So when Iran freaked out and 
throttled SSL bandwidth by DPI in 
summer 2009, they got Tor for free
25
Attackers can block users from 
connecting to the Tor network
1) By blocking the directory authorities
2) By blocking all the relay IP addresses in 
the directory, or the addresses of other Tor 
services
3) By filtering based on Tor's network 
fingerprint
4) By preventing users from finding the 
Tor software (usually by blocking website)
26
R4
R2
R1
R3
Bob
Alice
Alice
Alice
Alice
Alice
Blocked
User
Blocked
User
Blocked
User
Blocked
User
Blocked
User
Alice
Alice
Alice
Alice
Alice
Alice
Alice
Alice
Alice
Alice
27
How do you find a bridge?
1) https://bridges.torproject.org/ will tell 
you a few based on time and your IP address
2) Mail PI:EMAIL from a gmail 
address and we'll send you a few
3) I mail some to a friend in Shanghai who 
distributes them via his social network
4) You can set up your own private bridge and 
tell your target users directly
28
China (September 2009)
● China grabbed the list of public 
relays and blocked them
● They also enumerated+blocked one 
of the three bridge buckets 
(https://bridges.torproject.org/)
● But they missed the other bridge 
buckets. 
29
30
31
China (March 2010)
● China enumerated the second of our 
three bridge buckets (the ones 
available at PI:EMAIL 
via Gmail)
● We were down to the social 
network distribution strategy, and 
the private bridges
32
Iran (January 2011)
● Iran blocked Tor by DPI for SSL and 
filtering our Diffie-Hellman parameter.
● Socks proxy worked fine the whole time  
(the DPI didn't pick it up)
● DH p is a server-side parameter, so the 
relays and bridges had to upgrade, but not 
the clients
34
35
Iran (September 2011)
● This time, DPI for SSL and look at our TLS 
certificate lifetime.
● (Tor rotated its TLS certificates every 2 
hours, because key rotation is good, right?)
● Now our certificates last for a year
● These are all low-hanging fruit. Kind of a 
weird arms race.
36
37
38
39
Tunisia (October 2011)
● First country to announce officially that they 
censor
● Using Smartfilter
● Outsourced to a foreign corporation
● And Tunisia got a discount!
40
Pluggable transports
41
The two currently successful PTs
● obfsproxy (2012): add a layer of 
encryption on top so there are no 
recognizable headers.
● meek (2014): “domain fronting” via 
Google, Azure, Amazon
42
Tor censorship epochs
● Background / Phase 1 (2006-2011):
Bridges, pluggable transports
● Phase 2 (2011-2019):
Active probing, obfsproxy, domain 
fronting, many more countries
● Phase 3 (2019-?):
Snowflake, obfs4, decoy routing, ...
43
China (October 2011)
● Started its active probing campaign by 
DPIing on Tor’s TLS handshake, and 
later on obfs2 and obfs3
● Spoofed IP addresses from inside China
● The fix: obfs4 requires the client to 
prove knowledge of a secret, else it 
won’t admit to being an obfs4 bridge. 
44
45
China (March 2015)
● “Great Cannon” targets github
● Greatfire declaring war, “you can’t block 
us”
● Huge difference from previous “let them 
save face” approach
47
48
China (pre 2018)
● China also shifted to blackholing 
the entire IP address (not just the 
offending port).
● Any old probers are enough to get 
bridges blocked (0.2.9, ORPort, etc) 
49
China (mid 2018)
● Lantern uses obfs4 proxies for its 
own circumvention tool
● They tell us that China is throttling, 
not blocking, the obfs4 bridges that 
they identify as Lantern
50
China (mid 2019)
● 0.3.2 Tor clients, talking to 0.3.5 
Tor bridges, don’t trigger active 
probing anymore.
● We guess it has to do with changes 
in advertised ciphersuites on the 
client side.
51
52
53
54
55
Tor censorship epochs
● Background / Phase 1 (2006-2011):
Bridges, pluggable transports
● Phase 2 (2011-2019):
Active probing, obfsproxy, domain 
fronting, many more countries
● Phase 3 (2019-?):
Snowflake, obfs4, decoy routing, ...
56
New pluggable transport: Snow✓ake
57
58
59
Streamlined obfs4 deployment
● apt install obfs4proxy
● In the future: apt install tor-bridge?
● For many more details see: 
https://trac.torproject.org/projects/tor/
wiki/doc/PluggableTransports/
obfs4proxy
60
BridgeDB needs a feedback cycle
● Measure how much use each bridge 
sees
● Measure bridge blocking
● Then adapt bridge distribution to 
favor efficient distribution channels
● Need to invent new distribution 
channels, eg Salmon from PETS 2015
61
Measuring bridge reachability
● Passive: bridges track incoming 
connections by country; clients self-report 
blockage (via some other bridge)
● Active: scan bridges from within the 
country; or measure remotely via indirect 
scanning
● Bridges test for duplex blocking
62
ooni.torproject.org
63
explorer.ooni.torproject.org
● I
64
Other upcoming designs
● FTE/Marionette: transform traffic 
payloads according to a regexp or 
a state machine
● Decoy routing: run a tap at an 
ISP, look for steganographic tags, 
inject responses from the middle
65
Arms races
● Censorship arms race is bad
● Surveillance arms race is worse
– And centralization of the Internet 
makes it worse still
66
How can you help?
● Run an obfs4 bridge, and a Snowflake
● Teach your friends about Tor, and privacy 
in general
● Help find -- and fix – bugs
● Work on open research problems 
(petsymposium.org)
● donate.torproject.org
67
68
69