Figure 22: Analog front-end and ADC
accuracy rate for typing speeds from 150 KPM (Key-
press Per Minute) to 210 KPM. Notice that average adult
typing speed is between 36 and 45 words per minutes,
equivalent to 200 KPM.5
Figure 23 is a complete demonstration of our attack.
We typed “USB CROSSTALK” on the keyboard while
the spy probe was monitoring the data line crosstalk leak-
age, exﬁltrating the key presses via bluetooth to the at-
tacker’s computer.
7 Conclusions
In this paper we present two attacks on the USB bus,
which expose upstream trafﬁc hitherto considered safe
against off-path adversaries. The attacks exploit the elec-
trical properties of USB hubs and affect both internal
hubs and external hubs. Traditional countermeasures,
such as blocking the power or the data lines, do not pro-
tect against our attack. We now describe potential coun-
termeasures against the attacks.
Hardware Countermeasures. One possible solution
to completely remove any crosstalk leakage is optically
decoupling the USB data lines and constructing a ded-
icated 5V supply for each downstream port. However
such solutions are expensive and require careful design.
A cheap countermeasure which signiﬁcantly reduces the
power line crosstalk leakage uses an LC low pass ﬁlter
and LDO (low dropout regulator) to decouple the USB
power lines from the data lines. Figure 25 presents an im-
proved USB condom which, in addition to disconnecting
the USB data lines, also attempts to suppress any signal
5http://typefastnow.com/average-typing-speed
above 300Hz. As can be seen in Figure 26, our improved
USB condom is able to signiﬁcantly reduce the data line
crosstalk leakage, thus requiring far more sensitive mea-
surement equipment to exploit the small remaining leak-
age.
Frequency ﬁltering cannot be used to protect the data
lines against crosstalk leakage. The leaked signal carries
the same basic frequencies as the original signal. Hence
any frequency-based ﬁltering that removes the leakage
frequencies will also remove the signal frequencies. We
leave the problem of designing hardware countermea-
sures to data line leakage to future work.
Software Countermeasures. The lack of encryption in
the USB protocol is a major design limitation of the bus.
Without encryption, the design is unable to guarantee the
conﬁdentiality and the integrity of messages. Adding
end-to-end encryption, for example using the methodol-
ogy of [7] would protect messages from eavesdropping
attacks such as those we describe in this work. Sim-
pler approaches, such as encryption with a session key
generated, for example, using the Difﬁe-Hellman key
exchange protocol [20], could also mitigate our attack.
Both approaches require devices to have sufﬁcient com-
putational power to perform public key operations.
Future Work. Our spy probe implementation uses
commercial off-the-shelf components. Because these are
not optimized for the task of capturing USB trafﬁc, they
require relatively large space and consume a lot of power.
Designing dedicated hardware carries the promise of a
small-sized implementation that can be embedded in in-
conspicuous looking devices and even within the USB
plug [40].
While our attack does apply to non-USB 3.0 devices
connected to USB 3.0 hubs (see Figure 4(d)), one limi-
tation of our work is that it does not apply to USB 3.0
devices connected to USB 3.0 hubs. This is because
USB 3.0 devices connected to USB 3.0 hubs simulta-
1158    26th USENIX Security Symposium
USENIX Association
Figure 23: Demonstration of our attack. (left) Phrase being typed on the Surface Pro via a USB keyboard. (right)
extracted key presses corresponding to the string “USB CROSSTALK”.
Figure 24: Recognition rate over typing rate range from
150 KPM to 210 KPM.
neously use three differential wire pairs and employ a
much higher transmission rate. This conﬁguration sig-
niﬁcantly exceeds the speciﬁcations of our measurement
equipment (both in measurement speed and number of
channels). While more difﬁcult to attack, USB 3.0 de-
vices connected to USB 3.0 hubs present a lucrative tar-
get, in particular because in this conﬁguration the down-
stream communication, like upstream communication,
is unicasted from the host to the device. Exploiting
crosstalk effects on such conﬁgurations would therefore
expose downstream trafﬁc (in addition to upstream traf-
ﬁc) to off-path attackers. As we mentioned earlier, in-
put devices, which often send sensitive information to
the host, mostly use USB 1.x Hence, even though our at-
tack does not apply to the newest version of the protocol
(USB 3.0), it remains relevant.
The current research applies to USB devices. Further
research is required to check if other buses and commu-
nication networks are vulnerable to crosstalk attacks.
Acknowledgements
Yuval Yarom performed part of this work as a visiting
scholar at the University of Pennsylvania.
Figure 25: A USB condom which attempts to suppress
power line crosstalk leakage.
Figure 26: Evaluation of our USB condom showing the
actual USB communication (blue), the corresponding
unmitigated power line crosstalk leakage (black) and the
power line crosstalk leakage measured on the USB port
of our USB condom (orange). Notice that the power line
crosstalk leakage is signiﬁcantly attenuated.
USENIX Association
26th USENIX Security Symposium    1159
50.00%55.00%60.00%65.00%70.00%75.00%80.00%85.00%90.00%95.00%100.00%050100150200250150160170180190200210Recognition rate Key pressedKey press per minuteRecognition Rate VSTyping SpeedKey pressedKey reportedRecognition rate4.9855.025.045.065.085.15.125.145.16-16-14-12-10-8-6-4-2024Leakage (V)Traffic (V)TrafficBeforeAfterThis research was supported by an Endeavour Re-
search Fellowship from the Australian Department of
Education and Training; the Australian Research Coun-
cil under project DP140103448; the 2017-2018 Roth-
schild Postdoctoral Fellowship; the Blavatnik Interdis-
ciplinary Cyber Research Center (ICRC); by the Check
Point Institute for Information Security; by the Israeli
Centers of Research Excellence I-CORE program (cen-
ter 4/11); by the Leona M. & Harry B. Helmsley Chari-
table Trust; the Defence Science and Technology Group,
Maritime Division, Australia; the Warren Center for Net-
work and Data Sciences; the ﬁnancial assistance award
70NANB15H328 from the U.S. Department of Com-
merce, National Institute of Standards and Technology;
and by the Defense Advanced Research Project Agency
(DARPA) under Contract #FA8650-16-C-7622.
References
[1] “KeyGhost USB keylogger,” http://www.keyghost.
com/usb-keylogger.htm.
[2] “KeyGrabber USB,” http://www.keelog.com/.
[3] “The original USB Condom,”
products/usbcondoms.
http://int3.cc/
[4] “PortaPow
smart
portablepowersupplies.co.uk/portapow-fast-
charge-data-block-usb-adaptor/.
charge,”
http://www.
[5] “USB Rubber Ducky,”
com/.
http://usbrubberducky.
[6] R. J. Anderson, Security Engineering: A Guide to
Building Depandable Distributed Systems, 2nd ed.
Wiley, 2008.
[7] S. Angel, R. S. Wahby, M. Howald, J. B. Leners,
M. Spilo, Z. Sun, A. J. Blumberg, and M. Wal-
ﬁsh, “Defending against malicious peripherals with
Cinch,” in USENIX Security 2016, Aug. 2016, pp.
397–414.
[8] D. Asonov and R. Agrawal, “Keyboard acoustic
emanations,” in IEEE S&P, May 2004, pp. 3–14.
[9] M. Backes, M. D¨urmuth, S. Gerling, M. Pinkal,
and C. Sporleder, “Acoustic side-channel attacks on
printers,” in USENIX Security, Aug. 2010, pp. 307–
322.
[10] D. Barrall and D. Dewey, ““Plug and root,” the
USB key to the kingdom,” in BlackHat 2005, Jul.
2005.
[11] D. Bertsekas and R. Gallager, Data Networks.
Prentice-Hall, 1987.
[12] S. Bratus, T. Goodspeed, P. C. Johnson, S. W.
Smith, and R. Speers, “Perimeter-crossing buses:
a new attack surface for embedded systems,” in
Workshop on Embedded Systems Security (WESS),
2012.
[13] Universal Serial Bus Speciﬁcation, Rev. 1.0, Com-
paq, Data Equipment Corporation, IBM PC Com-
pany, Intel, Microsoft, NEC and Northern Telecom,
Jan. 1996.
[14] Universal Serial Bus Speciﬁcation, Rev. 2.0, Com-
paq, Hewlett-Packard, Intel, Lucent, Microsoft,
NEC and Philips, Apr. 2000.
[15] A. Crenshaw, “Programmable HID USB keystroke
dongle: Using the Teensy as a pen testing device,”
in DEFCON-18, Aug. 2010.
[16] ——, “Plug and prey: Malicious USB devices,” in
ShmooCon 2011, Jan. 2011.
[17] Application Note 83: Fundamentals of RS-232 Se-
rial Communications, Dallas Semiconductor, 1998.
[18] Dark Purple, “USB Killer,” http://kukuruku.co/
hub/diy/usb-killer, Mar. 2015.
[19] S. L. Diamond, “A new PC parallel interface stan-
dard,” IEEE Micro, vol. 14, no. 4, Aug. 1994.
[20] W. Difﬁe and M. E. Hellman, “New directions in
cryptography,” IEEE Transactions on Information
Theory, vol. IT-22, no. 6, pp. 644–654, Nov. 1976.
[21] “Thunder missile launcher,” http://dreamcheeky.
com/thunder-missile-launcher, Dream Cheeky.
[22] R. Frankland, “Side channels, compromising ema-
nations and surveillance: Current and future tech-
nologies,” Royal Halloway University of London,
Tech. Rep. RHUL-MA-2011-07, Mar. 2011.
[23] D. Genkin, L. Pachmanov, I. Pipman, A. Shamir,
and E. Tromer, “Physical key extraction attacks on
PCs,” CACM, vol. 59, pp. 70–79, Jun. 2016.
[24] D. Genkin, L. Pachmanov, I. Pipman, E. Tromer,
and Y. Yarom, “ECDSA key extraction from mobile
devices via nonintrusive physical side channels,” in
ACM CCS 2016. ACM, 2016, pp. 1626–1638.
[25] D. Genkin,
I. Pipman, and E. Tromer, “Get
your hands off my laptop: Physical side-channel
key-extraction attacks on PCs,” in CHES 2014.
Springer, 2014, pp. 242–260.
1160    26th USENIX Security Symposium
USENIX Association
[26] T. Halevi and N. Saxena, “Keyboard acoustic side
channel attacks: exploring realistic and security-
sensitive scenarios,” Int. J. Inf. Secur., vol. 14, no. 5,
pp. 443–456, Oct. 2015.
[27] Universal Serial Bus 3.0 Speciﬁcation, Hewlett-
Packard, Intel, Microsoft, NEC, ST-NXP Wireless,
Texas Instruments, Nov. 2008.
[28] High-Deﬁnition Multimedia Interface Speciﬁcation
Version 1.3a, Hitachi, Matsushita, Philips, Silicon
Image, Sony, Thomson and Toshiba, Nov. 2006.
[29] IEC 60130-9: Connectors for frequencies below 3
MHz Part 9: Circular connectors for radio and
associated sound equipment, 4th edition, Interna-
tional Electrotechnical Comission, 2011.
[30] P. C. Kocher, J. Jaffe, B. Jun, and P. Rohatgi, “In-
troduction to differential power analysis,” JCEN,
vol. 1, no. 1, pp. 5–27, 2011.
[31] M. G. Kuhn, “Electromagnetic eavesdropping risks
of ﬂat-panel displays,” in PET 2004, May 2004, pp.
88–107.
[32] B. Lau, Y. Jang, C. Song, T. Wang, P. H. Chung, and
P. Royal, “Mactans: Injecting malware into IOS de-
vices via malicious chargers,” in BlackHat 2013,
Jul. 2013.
[33] J. Maskiewicz, B. Ellis, J. Mouradian,
, and
H. Shacham, “Mouse trap: Exploiting ﬁrmware
updates in USB peripherals,” in WOOT’14, Aug.
2014.
[34] M. Neugschwandtner, A. Beitler, and A. Kurmus,
“A transparent defense against USB eavesdropping
attacks,” in EuroSec’16, 2016, pp. 6:1–6:6.
[35] K. Nohl, S. Krißler, and J. Lell, “BadUSB — on
accessories that turn evil,” in BlackHat 2014, Aug.
2014.
[36] J. Oberg, W. Hu, A. Irturk, M. Tiwari, T. Sherwood,
and R. Kastner, “Information ﬂow isolation in I2C
and USB,” in 48th DAC, Jun. 2011, pp. 254–259.
[37] Y. Oren and A. Shamir, “How not to protect PCs
from power analysis,” Rump Session, Crypto 2006,
2006.
[38] C. R. Paul, Introduction to Electromagnetic Com-
John Wiley & Sons, Inc., 2006.
patibility, 2nd ed.
[39] J. Rutkowska,
“Evil Maid goes after True-
Crypt!” http://theinvisiblethings.blogspot.com.au/
2009/10/evil-maid-goes-after-truecrypt.html, Oct.
2009.
[40] B. Schneier, “COTTONMOUTH-I: NSA exploit of
the day,” https://www.schneier.com/blog/archives/
2014/03/cottonmouth-i n.html, 2014.
[41] M. Schulz, P. Klapper, M. Hollick, and E. Tews,
“Trust the wire, they always told me!: On practical
non-destructive wire-tap attacks against Ethernet,”
in WiSec’16, Jul. 2016, pp. 43–48.
[42] R. Sevinsky, “Funderbolt: Adventures in Thunder-
bolt DMA attacks,” in BlackHat 2013, Jul. 2013.
[43] External Serial ATA, Silicon Image, Sep. 2004.
[44] F. Steinmetz, “USB — an attack surface of emerg-
ing importance,” Bachelor Thesis, Hamburg Uni-
versity of Technology, Mar. 2015.
[45] D. Tian, N. Scaife, A. Bates, K. R. B. Butler, and
P. Traynor, “Making USB great again with USB-
FILTER,” in USENIX Security 2016, Aug. 2016, pp.
415–430.
[46] J. D. Tian, A. M. Bates, and K. R. B. Butler,
“Defending against malicious USB ﬁrmware with
GoodUSB,” in Proceedings of the 31st Annual
Computer Security Applications Conference, Los
Angeles, CA, USA, December 7-11, 2015. ACM,
2015, pp. 261–270.
[47] VESA DisplayPort Standard Version 1, Revision
1a, Video Electronics Standards Association, Jan.
2008.
[48] M. Vuagnoux and S. Pasini, “Compromising elec-
tromagnetic emanations of wired and wireless key-
boards.” in USENIX security 2009, 2009, pp. 1–16.
[49] L. Wang and B. Yu, “Analysis and measurement
on the electromagnetic compromising emanations
of computer keyboards,” in CIS 2011, Dec. 2011,
pp. 640–643.
[50] C. Wisniewski,
“Windows
zero-day vulner-
ability uses
shortcut ﬁles on USB,” https:
//nakedsecurity.sophos.com/2010/07/15/windows-
day-vulnerability-shortcut-ﬁles-usb/, Jul. 2010.
[51] Q. Yang, P. Gasti, G. Zhou, A. Farajidavar,
and K. Balagani, “On inferring browsing ac-
tivity on smartphones via USB power analysis
side-channel,” IEEE Transactions on Information
Forensics and Security, no. 99, pp. 1–1, 2016.
[52] J. Zaddach, A. Kurmus, D. Balzarotti, E.-O. Blass,
A. Francillon, T. Goodspeed, M. Gupta, and
I. Koltsidas, “Implementation and implications of a
stealth hard-drive backdoor,” in 29th ACSAC, Dec.
2013, pp. 279–288.
USENIX Association
26th USENIX Security Symposium    1161