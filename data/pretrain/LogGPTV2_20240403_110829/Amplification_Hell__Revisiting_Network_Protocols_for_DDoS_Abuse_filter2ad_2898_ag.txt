on trafﬁc volume asymmetries and can thus also detect protocol
abuses in which only the bandwidth (but not the number of
packets) is ampliﬁed. We have shown in Table III that – in the
context of detecting DRDoS attacks – bandwidth asymmetries
can be used to detect more protocols (such as CharGen, QOTD,
SNMP or NetBios) than monitoring packet asymmetries.
Prior research also addressed the problem of identifying IP
spooﬁng. For example, Eto et al. propose a statistical method to
identify IP address spooﬁng by correlating the TTL ﬁeld in the
IP header with the actual hop count that a packet originating
from this source should have taken [9]. Yaar et al. propose
to detect DDoS trafﬁc by tracing back the routes IP packets
have taken [41]. Extending this work, Perrig et al. propose
StackPi, a system to deterministically mark packets at routers
to allow ﬁltering of packets with untrustworthy routes at the
recipient [25]. These approaches are complementary to our
research and may help to detect the abuse of ampliﬁers —
they cannot help to defend against DRDoS attacks from the
victim’s perspective, though.
Another line of research aims to detect scanning activ-
ities. Jung et al. propose Threshold Random Walk, an on-
line detection algorithm to detect malicious port scans [11].
Sridharan proposes TAPS, which uses sequential hypothesis
testing to detect hosts that exhibit abnormal access patterns
in terms of destination hosts and ports [31]. Paredes-Oliva
et al. compare these two portscan detection techniques and
evaluate their performance in ﬂow- and packet-based Netﬂow
sampling settings [23]. We seek for horizontal scans in a four-
week-long dataset for a post-mortem analysis and thus use a
counting-based approach to detect scans for ampliﬁers.
C. DDoS Attack Analysis
Lastly, related work covers the analysis of DDoS attacks.
Bailey et al. describe how darknets can help to identify
scanning activities or backscatter of DoS attacks [3]. Whyte
et al. propose to extend darknets by darkports, i.e., monitoring
unused ports at a system to detect scanning activities [40].
Moore et al. use backscatter data to analyze tens of thousands
of DoS attacks against a /8 network [19]. While showing the
signiﬁcance of the threat of DoS in general, they do not analyze
DRDoS attacks in speciﬁc.
Mao et al. correlate real-world DDoS attacks found in
Netﬂow data from a tier-1 ISP with attacks found via backscat-
ter analysis in darknets [17]. They highlight that backscatter
analysis reveals only limited insights into DDoS attacks. This
supports our hypothesis that attacks where an attacker uses IP
spooﬁng to directly attack a victim are practically irrelevant.
Instead, only the ampliﬁers receive spoofed IP packets, while
the victims receive non-spoofed responses from the ampliﬁers.
VII. DISCUSSION AND FUTURE WORK
By disclosing 14 vulnerable protocols we may motivate
adversaries to mimic our attacks. Until now, we have not yet
experienced DRDoS attacks with ampliﬁcation rates as in NTP,
where an attacker can use, e.g., a 1 Gb/s uplink to several-
Tbit/s-large attacks. Publicly discussing these vulnerabilities
may change this picture in the feature. We therefore follow
the principles of responsible disclosure and alerted both, the
security community (e.g., CERTs) as well as software devel-
opers of the most severely affected deployments (whenever
possible). We are in the process of delivering lists of ampliﬁers
to data clearing houses like shadowserver.org to foster alerts.
Furthermore, we currently implement a live-trafﬁc detection
tool of the methods mentioned in Section IV and plan to
release it to the community soon. It is unlikely that all of
the vulnerable services will be hardened at some point, but we
can work towards gradual improvements with these steps.
The reasons for the ampliﬁcation vectors are manifold.
Some of the protocols (e.g., CharGen and QOTD) have been
designed in the 1980’s without security in mind. Today, the
legacy protocols have no real use anymore. In other cases,
speciﬁc implementations of a protocol introduce angles for
ampliﬁcation. For example, public debugging functionality
(like the monlist feature in NTP) is not ofﬁcially in the
protocol descriptions but added for convenience. Developers of
gaming protocols or P2P protocols try to reduce the upstream
trafﬁc, as many end-users have accounts with asynchronous
line speeds (i.e., higher download than upload bandwidth) [14]
– resulting in possible ampliﬁcation. Lastly, due to the hidden
nature of P2P botnets, botmaster did not need to harden their
protocols against DRDoS abuse so far and are rather concerned
about protecting against takedown efforts [26].
It remains a tedious effort to design protocols that are
hardened against ampliﬁcation or even simple reﬂection. Un-
fortunately, we cannot claim that our list of 14 vulnerable
protocols is exhaustive. In future work, we plan to automate
the identiﬁcation of vulnerable protocols. For example, as a
starting point, one could use our methods proposed in Sec-
tion IV to analyze suspicious client/server sessions with more
13
relaxed ﬁltering rules. This would help to leapfrog attackers
in identifying further ampliﬁcation vectors.
Lastly, we left the inspection of TCP- or IP-based (instead
of UDP-based) protocols for future work. Likewise, we plan to
expand our experiments to IPv6, as we have found quite a few
ampliﬁers in the IPv6 address space. IPv6 may soon become
attractive to attackers, for example, because (older) ﬁltering
techniques cannot yet cope with IPv6 trafﬁc. In addition,
the IPv6 packet header is signiﬁcantly larger than in IPv4,
offering potential for further ampliﬁcation. We plan to model
these attacks in real-time DDoS attack evaluations systems like
Reval [37] in the future.
VIII. CONCLUSION
We have conceptually and practically demonstrated that at
least 14 UDP-based network protocols or service implemen-
tations are susceptible to ampliﬁcation abuse. This shows that
there is an urgent need to harden the protocols/implementations
at least of the most severely affected services, such as DNS,
NTP, SSDP or Kad. Network administrators should be pre-
pared for DRDoS attacks that are at least a magnitude worse
from what we have observed so far. We have shown, though,
how ampliﬁcation vulnerabilities can be effectively avoided.
With our ﬁndings, we hope to start a gradual – but years-long
– process of ﬁxing the discovered protocol weaknesses. Our
attack analysis and the proposed detection methods/tools sup-
port by detecting hosts under attack and identifying ampliﬁers
that are abused.
IX. ACKNOWLEDGEMENTS
We would like to thank the anonymous reviewers, Chris-
tian J. Dietrich and John Kristoff for their constructive and
valuable comments. We also thank the anonymous ISP and
especially its CERT for the cooperation during this research
project. We are also grateful to the CERTs that help us to
alert administrators of ampliﬁers. Finally, we thank Jochen
Schoenfelder and Christian Keil from DFN-CERT and the
CarmentiS project, who provided us with one of the darknet
datasets that we used in our experiments. This paper has been
supported by the Federal Ministry of Education and Research
(grant 16BY1201D, iAID).
REFERENCES
[1] The Spoofer Project. http://spoofer.cmand.org.
[2] D. Andriesse, C. Rossow, B. Stone-Gross, D. Plohmann,
and H. Bos. Highly Resilient Peer-to-Peer Botnets Are
Here: An Analysis of Gameover Zeus.
In Proceedings
of the 8th IEEE International Conference on Malicious
and Unwanted Software (MALWARE’13), Fajardo, Puerto
Rico, USA, October 2013.
[3] M. Bailey, E. Cooke, F. Jahanian, A. Myrick, and
S. Sinha.
In Pro-
ceedings of the Conference on Information Sciences and
Systems(CISS), Princeton, NJ, March 2006.
Practical Darknet Measurement.
[4] A. B¨uscher and T. Holz. Tracking DDoS Attacks: Insights
into the Business of Disrupting the Web. In Proceedings
of the 5th USENIX Workshop on Large-Scale Exploits
and Emergent Threats (LEET), San Jose, CA, USA, April
2012.
14
[5] A. Cowperthwaite and A. Somayaji. The Futility of
DNSSec. In Proceedings of the 5th Annual Symposium
on Information Assurance, Albany, NY, USA, June 2010.
[6] A. Dainotti, A. King, K. Claffy, F. Papale, and A. Pescap.
In
the Internet Measurement Conference
Analysis of a ”/0” Stealth Scan from a Botnet.
Proceedings of
(IMC), Boston, MA, USA, November 2012.
[7] K. E. Defrawy, M. Gjoka, and A. Markopoulou. Bot-
Torrent: Misusing BitTorrent to launch DDoS attacks.
In Proceedings of the USENIX Workshop on Steps to
Reducing Unwanted Trafﬁc on the Internet (SRUTI),
Santa Clara, CA, June 2007.
[8] Z. Durumeric, E. Wustrow, and J. A. Halderman. ZMap:
Fast Internet-wide Scanning and Its Security Applica-
tions.
In Proceedings of the 22nd USENIX Security
Symposium, Washington, D.C., USA, August 2013.
[10] J. Ioannidis and S. M. Bellovin.
[9] M. Eto, D. Inoue, M. Suzuki, and K. Nakao. A Statistical
Packet Inspection for Extraction of Spoofed IP Packets
on Darknet.
In Proceedings of the Joint Workshop on
Information Security, Kaohsiung, Taiwan, August 2009.
Implementing Push-
back: Router-Based Defense Against DDoS Attacks . In
Proceedings of Network and Distributed System Security
Symposium (NDSS), San Diego, CA, USA, February
2002.
[11] J. Jung, V. Paxson, A. W. Berger, and H. Balakrishnan.
Fast Portscan Detection Using Sequential Hypothesis
Testing. In Proceedings of IEEE Symposium on Security
and Privacy (S&P), Oakland, CA, USA, 2004.
[12] M. S. Kang, S. B. Lee, and V. D. Gligor. The Crossﬁre
In Proceedings of IEEE Security and Privacy
Attack.
(S&P), San Francisco, CA, USA, 2013.
[13] C. Kreibich, A. Warﬁeld, J. Crowcroft, S. Hand, and
I. Pratt. Using Packet Symmetry to Curtail Malicious
Trafﬁc. In Proceedings of the 4th Workshop on Hot Topics
in Networks (Hotnets-VI), College Park, MD, USA, 2005.
[14] C. Kreibich, N. Weaver, B. Nechaev, and V. Paxson. Net-
alyzr: Illuminating The Edge Network . In Proceedings of
the ACM Internet Measurement Conference, Melbourne,
Australia, November 2010.
[16] M. Prince; CloudFlare, Inc. http://blog.cloudﬂare.com/
the-ddos-that-almost-broke-the-internet, March 2013.
[17] Z. M. Mao, V. Sekar, O. Spatscheck, J. Van Der Merwe,
and R. Vasudevan. Analyzing Large DDoS Attacks Using
Multiple Data Sources. In Proceedings of the SIGCOMM
Workshop on Large-Scale Attack Defense (LSAD), Pisa,
Italy, September 2006.
[18] J. Mirkovic and P. Reiher. A Taxonomy of DDoS Attack
and DDoS Defense Mechanisms.
In ACM SIGCOMM
Computer Communication Review, volume 34, pages 39–
53, April 2004.
[19] D. Moore, C. Shannon, D. J. Brown, G. M. Voelker, and
S. Savage.
Inferring Internet Denial-of-Service Activ-
ity. ACM Transactions on Computer Systems (TOCS),
24(2):115–139, May 2006.
[20] N. Naoumov and K. Ross. Exploiting P2P Systems
for DDoS Attacks.
In Proceedings of the 1st Inter-
national Conference on Scalable Information Systems,
Hong Kong, May 2006.
[21] P. Ferguson, D. Senie. BCP 38 on Network Ingress
[15] M. E. Donner;
Prolexic.
prolexic-167gbit, May 2013.
https://tinyurl.com/
Filtering: Defeating Denial of Service Attacks which
employ IP Source Address Spooﬁng. http://tools.ietf.org/
html/bcp38, May 2000.
[22] P.A. Porras, H. Saidi, and V. Yegneswaran. An Analysis
of Conﬁcker’s Logic and Rendezvous Points. Technical
report, February 2009.
[23] I. Paredes-Oliva, P. Barlet-Ros, and J. Sol´e-Pareta.
Portscan Detection with Sampled NetFlow. In Proceed-
ings of
the 1st Workshop on Trafﬁc Monitoring and
Analysis (TMA), Aachen, Germany, May 2009.
[24] V. Paxson. An Analysis of Using Reﬂectors for Dis-
In Computer Com-
tributed Denial-of-Service Attacks.
munication Review 31(3), July 2001.
[25] A. Perrig, D. Song, and A. Yaar. StackPi: A New De-
fense Mechanism against IP Spooﬁng and DDoS Attacks.
Technical report, January 2003.
[26] C. Rossow, D. Andriesse, T. Werner, B. Stone-Gross,
D. Plohmann, C. J. Dietrich, and H. Bos.
SoK:
P2PWNED — Modeling and Evaluating the Resilience
of Peer-to-Peer Botnets.
the 34th
IEEE Symposium on Security and Privacy (S&P), San
Francisco, CA, May 2013.
In Proceedings of
[27] C. Schuba. Addressing Weaknesses in the Domain Name
System Protocol. Master’s thesis, Purdue University,
West Lafayette, IN, USA, August 1993.
[28] V. Sekar, N. G. Dufﬁeld, O. Spatscheck, J. E. van der
Merwe, and H. Zhang. LADS: Large-scale Automated
DDoS Detection System. In Proceedings of the USENIX
Annual Technical Conference (ATC), Boston, MA, USA,
May 2006.
[29] K. C. Sia. DDoS Vulnerability Analysis of BitTorrent
Protocol. Technical report, Spring 2006.
[30] S. M. Specht and R. B. Lee. Distributed Denial of
Service: Taxonomies of Attacks, Tools, and Countermea-
sures.
In Proceedings of the International Conference
on Parallel and Distributed Computing (and Commu-
nications) Systems (ISCA PDCS), San Francisco, CA,
September 2004.
[31] A. Sridharan. Connectionless Port Scan Detection on
the Backbone. In Proceedings of the Malware Workshop
(held in conjunction with IPCCC), Pheonix, AZ, USA,
April 2006.
[32] A. Studer and A. Perrig. The Coremelt Attack.
In
Proceedings of the European Symposium on Research
in Computer Security (ESORICS), Saint Malo, France,
September 2009.
[33] X. Sun, R. Torres, and S. Rao. DDoS Attacks by
Subverting Membership Management in P2P systems. In
Proceedings of the 3rd IEEE Workshop on Secure Net-
work Protocols (NPSec), G¨ottingen, Germany, October
2007.
[34] X. Sun, R. Torres, and S. Rao. On the Feasibility of
Exploiting P2P Systems to Launch DDoS Attacks.
In
Journal of Peer-to-Peer Networking and Applications,
volume 3, pages 36–51, March 2010.
[35] X. Sun, R. Torres, and S. Rao. Preventing DDoS Attacks
on Internet Servers Exploiting P2P Systems. In Elsevier
Journal on Computer Networks (COMNET), volume 54,
October 2010.
[36] T. Brewster (TechWeek). http://www.techweekeurope.co.
uk/news/zimbabwe-election-cyber-attacks-123938, Au-
gust 2013.
[37] R. Vasudevan, Z. M. Mao, O. Spatscheck, and J. van der
Merwe. Reval: A Tool for Real-time Evaluation of DDoS
Mitigation Strategies. In Proceedings of USENIX Annual
Technical Conference (ATC), Boston, MA, USA, May
2006.
[38] P. Vixie and V. Schryver. DNS Response Rate Limiting
(DNS RRL). http://ss.vix.su/⇠vixie/isc-tn-2012-1.txt.
[39] X. Wang and M. K. Reiter. Mitigating Bandwidth-
Exhaustion Attacks Using Congestion Puzzles. In Pro-
ceedings of the 11th ACM Conference on Computer and
Communications Security (CCS), New York, NY, USA,
October 2004.
[40] D. Whyte, P. C. v. Oorschot, and E. Kranakis. Tracking
Darkports for Network Defense.
In Proceedings of
the Annual Computer Security Applications Conference
(ACSAC), Miami Beach, FL, USA, December 2007.
[41] A. Yaar, A. Perrig, and D. Song. Pi: A Path Identiﬁcation
Mechanism to Defend against DDoS Attacks.
In Pro-
ceedings of the IEEE Symposium on Security and Privacy
(S&P), Oakland, CA, USA, May 2003.
15