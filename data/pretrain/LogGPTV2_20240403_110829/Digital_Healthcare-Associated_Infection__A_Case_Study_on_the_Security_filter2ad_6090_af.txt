Society relies on the constant availability of hospitals for
emergency needs. In recent years, the stance of the research
community has been more directed towards embedded de-
vices [25], [28], [29], [20] and body area networks (BAN) [37],
[42]. Rubin et al. give a comprehensive discussion on the
current state of BAN and embeddable medical devices. In
their, work Rubin et al. address the emerging threats and
challenges that exist with these types of devices, such as
remote attackers. Additionally, companies have also spent time
in reverse engineering currently infected medical devices but
much of the approach focuses on speciﬁc cases and is not a
scalable solution [45]. While this research is extremely useful
in security, medical devices are only part of a hospital’s whole
ecosystem. A full hospital network analysis has yet to be done.
Prior researchers have collected passive DNS data [47],
[36], [15], [11] similar to what we have done here. In
these prior works, the researchers have used their data to
reverse engineer and predict network communications made
by malware-infected devices. Passive DNS analysis has shown
to be useful for detecting various C&C of botnets [48] as well
as prediction of malicious domain names created by domain
generated algorithms (DGAs) [12]. By having a global view of
the network, passive DNS analysis is able to identify individual
infected devices and prevent malware from propagating to
other devices in the network. While active DNS probing has
been useful in detecting bad-natured trafﬁc [31], we focus on
passive DNS data so that we do not disturb trafﬁc from critical
devices in the hospital network.
Another analysis method used by researchers involves the
collection of SSL certiﬁcates [23], [18], [9] (i.e., X.509). While
passive DNS analysis tells us about infected devices based
on network calls, SSL certiﬁcates can give insight into the
conﬁguration of the devices. More speciﬁcally, previous work
has shown that many devices do not adequately validate a
certiﬁcate [26], accept deprecated (and insecure) cryptographic
standards, or suffer from MitM vulnerabilities [43]. As a way
to battle mis-issuance of such certiﬁcates, publicly veriﬁable
logs [35] have been created in order to make certiﬁcate
issuance more transparent.
In our paper, we combine many of the network analysis
methods mentioned above while focusing on medical support-
ing devices and the network context in which they reside.
IX. CONCLUSION
Understanding the threat surface of the modern healthcare
system requires a characterization of not only the individual
devices within the environment, but a holistic analysis of the
entire ecosystem, and must be done in a manner that does not
endanger operational networks. We performed the ﬁrst Digital
Healthcare-Associated Infection (D-HAI) analysis of a major,
multi-campus healthcare system. Our longitudinal case study
examined all Internet-facing trafﬁc over a six-month period
from January to June 2018. We ﬁnd that while the majority of
medical devices have minimal exposure to the Internet, medical
supporting devices that support the hospital environment make
millions of connections. We examined over 775 million DNS
queries across 17 million domains and discovered low amounts
of malicious trafﬁc (0.01%) and small but signiﬁcant traces
of botnet activity. We also observed 325 million SSL and
TLS handshakes over the analysis period, discovering that
almost 46% of these connections are made with weak or
insecure ciphers, largely because of a reliance on SHA1 but
also because of outdated cipher suites. More importantly, we
found that 47% of the servers negotiated an obsolete version
of TLS (1.1 or below) at least once. Our D-HAI analysis of the
hospital ecosystem is repeatable, non-invasive, and is designed
in accordance to ethical considerations. We ﬁnd that while
much has been done to secure medical devices, more must
be done to ensure the protection of this critical environment.
Aside from the analytical results presented, our hope is for
this paper to aid future researchers in doing ethical research
by outlining the possible limitations they might have when
working in sensitive environments.
ACKNOWLEDGMENTS
The authors would like to thank our shepherds, David
Evans and Michelle Mazurek, and our anonymous reviewers
for their helpful comments and guidance. We would also
like to thank all of the hospital staff that gave us access
to the data and made themselves available to answer any
questions we had throughout the whole process. The icons
found in Figure 1 were created by Joni, Arafat Uddin, Vectors
Market, Gan Khoon Lay, Creative Stall, Stonehub, Diego from
the Noun Project under the Creative Commons 3.0 License.
Finally,
this work was supported by the National Science
Foundation grant numbers CNS-1562485 and CNS-1540217.
Any ﬁndings, comments, conclusion found in this work are
from the authors and do not necessarily reﬂect the views of
the National Science Foundation.
REFERENCES
[1]
[2]
[3]
[4]
[5]
[6]
[7]
“Certiﬁcate transparency known logs,” 2018, http://www.certiﬁcate-
transparency.org/known-logs.
“Dshield,” https://www.dshield.org/suspicious domains.html, 2018.
“Hipaa journal,” https://www.hipaajournal.com/, 2018.
“Malwaredomains,” http://www.malwaredomains.com/, 2018.
“Openphish,” https://openphish.com/, 2018.
“Phishtank,” https://www.phishtank.com/, 2018.
“Zeus tracker,” https://zeustracker.abuse.ch/blocklist.php, 2018.
14
IEEE, 2013, pp. 526–540.
[8] N. J. AlFardan and K. G. Paterson, “Lucky thirteen: Breaking the TLS
and DTLS record protocols,” in 2013 IEEE Symposium on Security and
Privacy.
J. Amann, O. Gasser, Q. Scheitle, L. Brent, G. Carle, and R. Holz,
“Mission accomplished?: Https security after diginotar,” in Proceedings
of the 2017 Internet Measurement Conference. ACM, 2017, pp. 325–
340.
[9]
[10] Amazon Company, “Alexa Company,” 2018.
https://www.alexa.com/
[Online]. Available:
[11] M. Antonakakis, R. Perdisci, W. Lee, N. Vasiloglou, and D. Dagon,
“Detecting malware domains at the upper dns hierarchy.” in USENIX
security symposium, vol. 11, 2011, pp. 1–16.
[12] M. Antonakakis, R. Perdisci, Y. Nadji, N. Vasiloglou, S. Abu-Nimeh,
W. Lee, and D. Dagon, “From throw-away trafﬁc to bots: Detecting the
rise of dga-based malware.” in USENIX security symposium, vol. 12,
2012.
[13] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche, “Keccak sponge
function family main document,” Submission to NIST (Round 2), vol. 3,
no. 30, 2009.
[14] K. Bhargavan and G. Leurent, “On the Practical (In-)Security of
64-bit Block Ciphers: Collision Attacks on HTTP over TLS and
OpenVPN,” in Proceedings of
the 2016 ACM SIGSAC Conference
on Computer and Communications Security, ser. CCS ’16. New
York, NY, USA: ACM, 2016, pp. 456–467.
[Online]. Available:
http://doi.acm.org/10.1145/2976749.2978423
[15] L. Bilge, E. Kirda, C. Kruegel, and M. Balduzzi, “EXPOSURE: Finding
Malicious Domains Using Passive DNS Analysis.”
[16] D. Bleichenbacher, “Chosen ciphertext attacks against protocols based
on the rsa encryption standard pkcs #1,” in Proceedings of
the
18th Annual International Cryptology Conference on Advances in
Cryptology, ser. CRYPTO ’98. London, UK, UK: Springer-Verlag,
1998, pp. 1–12. [Online]. Available: http://dl.acm.org/citation.cfm?id=
646763.706320
[17] H. B¨ock, J. Somorovsky, and C. Young, “Return of bleichenbacher’s
oracle threat (robot),” Cryptology ePrint Archive, Report 2017/1189,
2017, https://eprint.iacr.org/2017/1189.
[18] C. Brubaker, S. Jana, B. Ray, S. Khurshid, and V. Shmatikov, “Using
frankencerts for automated adversarial testing of certiﬁcate validation
in ssl/tls implementations,” in Security and Privacy (SP), 2014 IEEE
Symposium on.
IEEE, 2014, pp. 114–129.
[19] Dan Hubbard, “Cisco Umbrella 1 Million,” 2016. [Online]. Available:
https://umbrella.cisco.com/blog/2016/12/14/cisco-umbrella-1-million/
[20] T. Denning, A. Borning, B. Friedman, B. T. Gill, T. Kohno, and W. H.
Maisel, “Patients, pacemakers, and implantable deﬁbrillators: Human
values and security for wireless implantable medical devices,” in Pro-
ceedings of the SIGCHI Conference on Human Factors in Computing
Systems. ACM, 2010, pp. 917–926.
[21] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman,
“A search engine backed by Internet-wide scanning,” in 22nd ACM
Conference on Computer and Communications Security, Oct. 2015.
[22] Z. Durumeric, F. Li, J. Kasten, J. Amann, J. Beekman, M. Payer,
N. Weaver, D. Adrian, V. Paxson, M. Bailey, and J. A. Halderman,
“The matter of heartbleed,” in Proceedings of the 2014 Conference
on Internet Measurement Conference, ser. IMC ’14. New York,
NY, USA: ACM, 2014, pp. 475–488.
[Online]. Available: http:
//doi.acm.org/10.1145/2663716.2663755
[23] S. Fahl, M. Harbach, T. Muders, L. Baumg¨artner, B. Freisleben, and
M. Smith, “Why eve and mallory love android: An analysis of android
ssl (in) security,” in Proceedings of
the 2012 ACM conference on
Computer and communications security. ACM, 2012, pp. 50–61.
[24] Food and Drug Administration, “Quality and Compliance (Medical
Devices),” 2018, https://www.fda.gov/MedicalDevices/DeviceRegula-
tionandGuidance/MedicalDeviceQualityandCompliance/default.htm.
[25] K. Fu and J. Blum, “Controlling for cybersecurity risks of medical
device software,” Communications of the ACM, vol. 56, no. 10, pp.
35–37, 2013.
[26] M. Georgiev, S.
Iyengar, S. Jana, R. Anubhai, D. Boneh, and
V. Shmatikov, “The most dangerous code in the world: validating ssl
certiﬁcates in non-browser software,” in Proceedings of the 2012 ACM
conference on Computer and communications security. ACM, 2012,
pp. 38–49.
15
[27] Google Chrome, “Chrome Platform Status TLS 1.3,” 2018. [Online].
Available: https://www.chromestatus.com/feature/5712755738804224
[28] D. Halperin, T. S. Heydt-Benjamin, K. Fu, T. Kohno, and W. H. Maisel,
“Security and privacy for implantable medical devices,” IEEE pervasive
computing, vol. 7, no. 1, 2008.
[29] D. Halperin, T. S. Heydt-Benjamin, B. Ransford, S. S. Clark, B. Defend,
W. Morgan, K. Fu, T. Kohno, and W. H. Maisel, “Pacemakers and im-
plantable cardiac deﬁbrillators: Software radio attacks and zero-power
defenses,” in Security and Privacy, 2008. SP 2008. IEEE Symposium
on.
IEEE, 2008, pp. 129–142.
[30] Health Insurance Portability and Accountability Act, “Summary of the
HIPAA Security Rule),” 2018. [Online]. Available: https://www.hhs.
gov/hipaa/for-professionals/security/laws-regulations/index.html
[31] T. Holz, C. Gorecki, K. Rieck, and F. C. Freiling, “Measuring and
detecting fast-ﬂux service networks.” in NDSS, 2008.
[32] A. Kharraz, W. Robertson, D. Balzarotti, L. Bilge, and E. Kirda,
“Cutting the gordian knot: A look under the hood of ransomware
attacks,” in International Conference on Detection of Intrusions and
Malware, and Vulnerability Assessment. Springer, 2015, pp. 3–24.
[33] C. Kreibich, C. Kanich, K. Levchenko, B. Enright, G. M. Voelker,
V. Paxson, and S. Savage, “On the spam campaign trail.” LEET, vol. 8,
no. 2008, pp. 1–9, 2008.
J. Kwon and M. E. Johnson, “Security practices and regulatory com-
pliance in the healthcare industry,” Journal of the American Medical
Informatics Association, vol. 20, no. 1, pp. 44–51, 2012.
[34]
[35] B. Laurie, A. Langley, and E. Kasper, “Certiﬁcate transparency,” Tech.
Rep., 2013.
[36] C. Lever, M. Antonakakis, B. Reaves, P. Traynor, and W. Lee, “The
Core of the Matter: Analyzing Malicious Trafﬁc in Cellular Carriers.”
in NDSS, 2013.
[37] M. Li, W. Lou, and K. Ren, “Data security and privacy in wireless body
area networks,” IEEE Wireless communications, vol. 17, no. 1, 2010.
I. Mantin and A. Shamir, “A practical attack on broadcast rc4,” in Fast
Software Encryption, M. Matsui, Ed.
Berlin, Heidelberg: Springer
Berlin Heidelberg, 2002, pp. 152–164.
[38]
[39] P. Mockapetris and K. J. Dunlap, Development of the domain name
system. ACM, 1988, vol. 18, no. 4.
[40] B. M¨oller, T. Duong, and K. Kotowicz, “This poodle bites: exploiting
the ssl 3.0 fallback,” Security Advisory, 2014.
[41] V. Paxson, “Bro: a system for detecting network intruders in real-time,”
Computer networks, vol. 31, no. 23-24, pp. 2435–2463, 1999.
[42] M. Rushanan, A. D. Rubin, D. F. Kune, and C. M. Swanson, “Sok:
Security and privacy in implantable medical devices and body area
networks,” in Security and Privacy (SP), 2014 IEEE Symposium on.
IEEE, 2014, pp. 524–539.
[43] D. Sounthiraraj, J. Sahs, G. Greenwood, Z. Lin, and L. Khan, “Smv-
hunter: Large scale, automated detection of ssl/tls man-in-the-middle
vulnerabilities in android apps,” in In Proceedings of the 21st Annual
Network and Distributed System Security Symposium (NDSS’14. Cite-
seer, 2014.
[44] M. Stevens, E. Bursztein, P. Karpmann, A. Albertini, and Y. Markov,
“The ﬁrst SHA-1 collision,” Technical Report, 2017, https://shattered.
io/static/shattered.pdf.
[45] TrapX Research Labs,
“MEDJACK.2 Hospitals Under Siege,”
2018. [Online]. Available: https://trapx.com/wp-content/uploads/2017/
08/AOA Report TrapX MEDJACK.2.pdf
[46] S. Vaudenay, “Security ﬂaws induced by CBC padding — Applications
to SSL, IPSEC, WTLS...” in Advances in Cryptology — EUROCRYPT
2002. Springer Berlin Heidelberg, 2002, pp. 534–545.
[47] F. Weimer, “Passive dns replication,” in FIRST conference on computer
security incident, 2005, p. 98.
[48] S. Yadav, A. K. K. Reddy, A. Reddy, and S. Ranjan, “Detecting
algorithmically generated malicious domain names,” in Proceedings of
the 10th ACM SIGCOMM conference on Internet measurement. ACM,
2010, pp. 48–61.
[49] T.-F. Yen, V. Heorhiadi, A. Oprea, M. K. Reiter, and A. Juels, “An
epidemiological study of malware encounters in a large enterprise,” in
Proceedings of the ACM Conference on Computer and Communications
Security (CCS), 2014.