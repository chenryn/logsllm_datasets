### 0day漏洞和恶意代码的防御挑战

在网络安全领域，仅关注0day漏洞、恶意代码等单点环节无法全面分析攻击过程，也无法有效指导防御工作。为了应对高能力网络威胁行为体的攻击，安全人员需要一个体系化、框架化的威胁分析模型，以便更深入、系统地理解威胁并实现有效防御。当前类似的分析模型包括洛克希德·马丁公司的Kill Chain（杀伤链）和MITRE公司的ATT&CK模型。

#### Kill Chain模型

Kill Chain由洛克希德·马丁公司在2011年提出，定义了攻击者为达到目标必须完成的七个阶段，并认为防御者在任意一个阶段打破链条即可阻止攻击。虽然Kill Chain有助于识别和防御网络攻击，但其粒度较粗，缺乏细节支撑，不足以应对复杂的攻击场景。

#### ATT&CK模型

为解决Kill Chain的不足，MITRE公司在其基础上提出了ATT&CK模型，即对抗战术、技术和通用知识库。该模型将入侵全生命周期划分为12个阶段，每个阶段细分具体的攻击技术，并提供详细的描述、监测方法及缓解措施。这有助于安全人员更好地了解风险并开展防御工作。然而，ATT&CK侧重于具体的技术，在层次性和分类方面仍显不足。

#### NSA/CSS 技术网空威胁框架

NSA和CSS参考现有框架，于2018年3月发布了《NSA/CSS技术网空威胁框架》V1版本。该框架基于国家情报总监（DNI）的网空威胁框架开发，旨在促进情报共享、产品研发和作战规划。同年11月，NSA和CSS发布了改进后的V2版本，包含六个阶段、21个目标、188种行为和若干关键词，提供了标准定义，能够全面呈现攻击事件全貌，协助制定针对性防御措施。

“威胁框架”涵盖了各种可能的目标和行为，包括高级攻击能力如方程式组织的硬盘固件持久化能力、“量子”系统的通信路径修改能力等。因此，“威胁框架”对于梳理来自超高能力网络威胁行为体的攻击活动非常有效。

### 安天的分析与应用

安天以“威胁框架”V2为参考，对超高能力网络威胁行为体的攻击行动进行标准化描述和分类，帮助分析其意图和行为，为防御工作提供借鉴。通过复盘分析，可以将特定事件中的威胁行为映射到“威胁框架”中。

例如，攻击者利用长期环境准备，在多个国家或地区建立跳板机资源，发起攻击并控制防火墙。随后，利用“永恒”系列漏洞获取服务器控制权，执行SQL脚本查询数据库信息，获取凭证并横向移动到其他主机。最后，采用数据加密等手段防止被发现。这些行动均能在“威胁框架”中找到对应的行为和技术。

### 事件总结

通过对被攻击资产、攻击装备和攻击过程的复盘，报告呈现了整体攻击全貌。从2012-2013年的背景来看，当时的布防特点包括VPN、防火墙、主机杀毒等基础安全措施，但这些措施对于抵御超高能力威胁行为体远远不够。

此外，系统管理者存在明显的配置和安全策略失误，如多台服务器使用相同的超级用户口令，导致一旦一台被突破，整个系统都面临风险。防火墙也未对管理接口访问IP地址作出明确限定。

要建立有效的防御体系，需采取以下措施：

1. **全面提升网络安全规划能力**：面对开放式场景和信息系统规模增长带来的挑战，需在全生命周期内提升网络安全能力。
2. **设定合理的敌情想定**：重要信息资产应假设“敌已在内，敌将在内”，采取相应的防御措施。
3. **参考“威胁框架”更新认知**：从威胁框架出发，针对每个阶段和行为进行推演，评估现有防御体系的有效性，并形成体系化的防御规划。

通过这些措施，可以更好地应对复杂且高度组织化的网络威胁。