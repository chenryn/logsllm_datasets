title:Comments on DNS Robustness
author:Mark Allman
Comments on DNS Robustness
International Computer Science Institute
Mark Allman
PI:EMAIL
ABSTRACT
The Domain Name System (DNS) maps human-friendly names
into the network addresses necessary for network communication.
Therefore, the robustness of the DNS is crucial to the general oper-
ation of the Internet. As such, the DNS protocol and architecture
were designed to facilitate structural robustness within system. For
instance, a domain can depend on authoritative nameservers in sev-
eral topologically disparate datacenters to aid robustness. However,
the actual operation of the system need not utilize these robustness
tools. In this paper we provide an initial analysis of the structural
robustness of the DNS ecosystem over the last nine years.
CCS CONCEPTS
• Networks → Network security; Network structure; Network
reliability;
KEYWORDS
DNS; nameserver; robustness; structure
ACM Reference Format:
Mark Allman. 2018. Comments on DNS Robustness. In 2018 Internet Measure-
ment Conference (IMC ’18), October 31-November 2, 2018, Boston, MA, USA.
ACM, New York, NY, USA, 7 pages. https://doi.org/10.1145/3278532.3278541
1 INTRODUCTION
The Domain Name System’s (DNS) basic job is to map human-
friendly hostnames into network layer addresses [8]. As such, DNS
transactions represent a prerequisite for a large amount of Internet
transactions. It is hard to over-state the reliance we have on the
DNS infrastructure for the operation of the Internet. Therefore, the
robustness of the DNS ecosystem is of crucial importance. This pa-
per provides an initial assessment of various robustness properties
of the modern DNS ecosystem.
The DNS provides a hierarchical namespace and is structured as
a distributed system. One of the key building blocks within the DNS
is the ability to delegate portions of the namespace to particular
authoritative nameservers. Delegation facilitates both flexibility
and robustness, as follows:
Flexibility: Delegating to name owners allows the owners to con-
figure the name resolution process according to their own
specific needs. This flexibility manifests in myriad ways, in-
cluding allowing for highly dynamic bindings that facilitate
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
© 2018 Association for Computing Machinery.
ACM ISBN 978-1-4503-5619-0/18/10...$15.00
https://doi.org/10.1145/3278532.3278541
84
traffic management in content distribution networks, out-
sourcing DNS services to third party providers, controlling
the caching of resolutions via varying time-to-live setting,
etc.
Robustness: Delegating various portions of the namespace to a
variety of nameservers allows for independent operation of
different parts of the system. In other words, the overall DNS
system gains robustness because any specific issue will only
impact a relatively small amount of the namespace. Further,
delegations can be made to multiple replica nameservers
that all provide the same bindings. This allows the system to
function even when a specific replica becomes unavailable,
as clients can consult one of the other nameservers to obtain
the required information.
DNS was designed to facilitate robustness. For instance, RFC 1034
requires each DNS zone to maintain two nameservers [8] and
RFC 2182 further requires a zone’s nameservers to have geographic
and topological diversity [4]. However, this is insufficient to achieve
robust operation. Rather, robustness requires careful configuration
and operation. For instance, while DNS allows for nameserver repli-
cas to avoid single points of failure, a DNS operator can configure
only a single nameserver for their portion of the namespace, hence,
negating the robustness potential in DNS’s design.
One approach to gain robustness that has been gaining popu-
larity is to out-source DNS operation to a DNS provider. These
providers have expertise and resources—e.g., geographically dis-
parate datacenters for hosting nameservers—that typical organiza-
tions either do not have or do not wish to build. While leveraging
a DNS provider can improve robustness, this choice can also hurt
robustness by concentrating the DNS ecosystem. For instance, con-
sider the DDoS attack on the nameserver provider Dyn in October
2016 [2]. In this case, Dyn’s nameservers were flooded by attack
traffic from the Mirai botnet. This flood interfered with legitimate
DNS requests. Given that Dyn runs nameservers on behalf of many
organizations, this attack had indirect impact on these organiza-
tions, as well, since clients were not able to retrieve name-to-address
mappings from Dyn. The organizations served by Dyn effectively
all shared fate via their reliance on Dyn’s DNS infrastructure.
Some of DNS’s concentration is systemic and obvious. For in-
stance, given the hierarchical namespace, all names depend on the
root nameservers. To make the system robust we use 13 named and
well known root replicas. Since the nameservers are well known,
requesters have recourse when a particular server is unreachable.
Further robustness at the root comes as most of the named replicas
are in fact multiple nameservers that are reachable via anycast
addresses. A similar situation manifests at the top-level domain
(TLD) level—at least for popular TLDs such as .com and .net.
In this paper we focus on the robustness of second-level domains,
or SLDs (e.g., icir.org). At this point in the name hierarchy, well
known, broadly shared and community-driven infrastructure gives
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Mark Allman
way to the individual decisions of millions of organizations. Further,
at this level, the number of named replicas is generally smaller than
at the root and TLD levels. In a snapshot of the .com, .net and .org
zone files from April, 2018 we find that 80.6% of the SLDs have at
most two named authoritative nameservers and 97.5% of the SLDs
have at most four named authoritative servers. This provides less
robustness and gives requesters less recourse when problems arise
compared to the 13 named root nameservers. In this paper we study
SLD robustness from a variety of angles.
This paper represents a modest initial effort. The DNS gener-
ally works well at providing users with the hostname-to-address
mappings they need to accomplish their work. However, this pa-
per describes a number of unhealthy habits that impinge on the
envisioned robustness of the system.
2 RELATED WORK
Previous studies investigated the connectedness of the DNS name-
server ecosystem—which is one aspect of robustness. [9] uses data
gathered in July, 2004 to study the “trusted computing base” (TCB)
for nearly 600K names. In this context, the TCB is the set of name-
servers on which a fully-qualified domain name (partially) depends.
This investigation highlights the breadth of dependency in the sys-
tem as the median TCB size was found to be 26 nameservers. The
TCB notion was refined and an analytic model of the connections
in the system is developed in [3].
A second study primarily aims to investigate the degree to which
web server infrastructure is shared using data from June, 2007 [12].
This work also contains a preliminary investigation of shared DNS
infrastructure. As with [9] and [3], this work starts with hostnames
at the bottom of the hierarchy. This work shows sharing DNS
nameservers is not rare. Further, this work moves beyond studying
just the concentration of nameservers on shared infrastructure
and into how many nameservers DNS zones utilize. We conduct a
similar, but more in-depth characterization in § 4.1.
Our work is complimentary to the three previous studies we
sketch above. First, we use a longitudinal and up-to-date dataset
that spans from 2009–2018 to not only update our understanding,
but also study how DNS robustness has evolved over time. Sec-
ond, rather than starting at the bottom of the DNS hierarchy and
trying to understand the breadth of influence on individual host-
names, we start closer to the top of the hierarchy and strive to
understand the robustness of popular second-level domains (SLDs).
Both approaches have their merits and together form a stronger
understanding than either on its own.
Finally, there are many studies on specific DNS vulnerabilities
(e.g., the Kaminsky attack [7], the fragmentation attack [6], the
Preplay attack [11]). These investigate issues in the DNS protocol
and/or implementations. While these issues are important, they are
orthogonal to our work. In this paper we concentrate on structural
robustness—or lack thereof—that stems from the way the DNS
ecosystem has been intentionally configured and operated.
3 DATA AND METHODOLOGY
We leverage the following datasets and methodology in this study.
85
Figure 1: Overview of Alexa top 1M list.
3.1 Data
Dataset A: Alexa Popularity Lists: Not all SLDs are equal, and
therefore in this study we focus only on popular SLDs. The ro-
bustness of unpopular domains is certainly of crucial import to
those leveraging these domains. However, in this study our goal is
to understand robustness as it applies to domains on which large
numbers of people depend. As such, we concentrate on the SLDs
for the sites on Alexa’s list of 1M most popular sites [1].1 We have
gathered Alexa’s list regularly since 2009. We are missing Alexa
lists for three months during our collection and therefore we do
not consider these months in the analysis in this paper.
In this study we focus on the .com, .net and .org DNS zones (due
to our zone file dataset, which we describe below). Not all entries
in Alexa’s list of popular sites are found in the three zone files we
analyze. The blue line on Figure 1 shows the percentage of the
Alexa list we analyze for each month of our dataset. While .com,
.net and .org together constitute at least 56% of the Alexa list in
each month we analyze, their contribution is decreasing over time.
While we use roughly 63% or more of the Alexa list in the first
half of the dataset, the percentage drops off in the second half. The
red line on the plot shows the number of TLDs in the Alexa list
for each month in the dataset. For the first half of our dataset, the
original set of global TLDs (gTLDS; .com, .net, .edu, etc.) and the
country-code TLDs (ccTLDs) make up the entire list. However, in
2014 new gTLDs started to be introduced and the number of TLDs
in Alexa’s list has therefore grown. With the exception of the .de
and .ru TLDs, the TLDs we do not consider each make up less than
2% of the Alexa list. While our study encompasses the majority of
the popular sites, we note that popular SLDs in unpopular TLDs
may well have different robustness characteristics than we present
here. We do not currently have the zone files to investigate these
SLDs and therefore leave this to future work.
Dataset Z: TLD Zone Files: Our second dataset is the zone files
for the .com, .net and .org TLDs. We have daily snapshots of these
zone files since April 2009. In this study we use the first snapshot
from each month that correctly incorporates all three zones.2 We
1We do not consider Alexa’s list of popular sites to be definitive (see [10]). However,
we consider the list to be a reasonable set of popular SLDs and use it as such.
2Generally, we use the snapshot from the first day of each month, but due to data
gathering glitches at various times we may use an alternate snapshot. Since these
glitches—e.g., full disks—have nothing to do with the contents of the zones, we do not
believe these minor deviations bias our analysis.
 56 57 58 59 60 61 62 63 64 65 66 6720092010201120122013201420152016201720182019 200 300 400 500 600 700 800% of Alexa List in com / net / orgTotal Num. TLDs in Alexa List% Pop Sites InclTotal Num TLDsComments on DNS Robustness
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
terms of (i) fully resolved SLDs, where we have A records for all NS
records in each SLD; (ii) partially resolved SLDs, where we have A
records for some, but not all, of the NS records in each SLD; and (iii)
unresolved SLDs, where we have no A records for the NS records
in each SLD. We pair the NS records found in step 1 with the A
records found in this step to form Winnowed Zone Files (WZFs),
which are the foundation of our analyses in this paper.
Step 3: Topological Determination: A final step in many of the
analyses we describe in § 4 and § 5 is determining the topological
location of authoritative servers. There are a number of possible
approaches to determine the topological location of an IP address—
e.g., via historical BGP or traceroute routing data. In this initial study,
we generally delineate networks using /24 address blocks. While
crude, this approach is conservative since we know that smaller
address blocks cannot be confidently advertised in the Internet.
Therefore, if two hosts share a /24 we can confidently assume they
are routed to the same location. However, the opposite is not true:
we cannot say that just because two hosts do not share a /24 that
they will be routed to different locations in the network. We use
the traceroute measurements from T to refine this crude notion for
the last month of our analysis. Future work will include bringing
better historical routing information to bear to refine the analyses
we present in this paper.
A complication in understanding the modern DNS structure is
the prevalent use of anycast. Large DNS providers often rely on
anycast routing to direct requests to a nearby replica of a named
authoritative nameserver (e.g., most of the 13 root nameservers