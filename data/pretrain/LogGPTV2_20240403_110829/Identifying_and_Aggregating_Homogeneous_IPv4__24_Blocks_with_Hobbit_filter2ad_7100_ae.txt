i
s
e
g
n
a
h
C
29
25
21
-21
-28
-215
20
22
26
24
The Cluster Size
28
210
Figure 10: Changes in the size distribution of homoge-
neous blocks made by clustering
i
o
i
t
a
R
s
k
n
L
d
e
r
e
v
o
c
s
D
i
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
Hobbit
/24
 20
 0
 100
Avg. # of Selected Addresses per /24
 40
 60
 80
Figure 11: The ratio of the links discovered by two
diﬀerent approaches: To select addresses from 1) each
Hobbit block and 2) each /24.
by aggregating 33,023 existing clusters, and thus the to-
tal number of clusters has been reduced from 532,850
to 508,758.
7 IMPLICATIONS
7.1 Implication for topology discovery
The homogeneous blocks identiﬁed by Hobbit can be
used in selecting destinations for topology discovery.
We demonstrate that measurement loads for topology
discovery can be reduced if the destinations are cho-
sen from each of the Hobbit blocks rather than each
/24. We utilize the dataset collected for the compari-
son of the cardinality in diﬀerent metrics (Section 3.1).
The dataset contains the traceroutes of all active ad-
dresses within homogeneous /24s. We choose destina-
tions (and extract the corresponding traceroutes) from
the dataset in two diﬀerent approaches, that is, to select
a destination from 1) each /24, and 2) each of the Hob-
bit blocks. We then compute a discovered links ratio,
that is, the number of distinct links within the chosen
traceroutes divided by the total number of distinct links
in the dataset. Due to the prevalence of per-destination
load-balancing, selecting a single destination from each
block is not enough to achieve the ratio of 1. We re-
peat to select more destinations from each block and
recompute the ratio until the ratio nearly becomes 1.
Figure 11 shows the ratios achieved by the diﬀerent ap-
proaches as a function of the average number of selected
destinations per /24 (that is, the number of selected
destinations divided by the total number of /24 blocks
162S
N
D
r
f
o
#
d
e
z
i
l
a
m
r
o
N
 1
 0.8
 0.6
 0.4
 0.2
 0
Stratified                 Random, 1-4x             
Figure 12: The normalized number of distinct rDNS
patterns within samples generated by stratiﬁed and sim-
ple random sampling
in the dataset)12. Selecting destinations from the Hob-
bit blocks always results in the discovery of more links
compared to selecting destinations from each /24. This
demonstrates that the use of the Hobbit homogeneous
blocks can improve the eﬃciency of topology discovery.
7.2
Implication for identifying cellular de-
vices
Hobbit identiﬁes some clusters consisting of cellular
devices (as discussed in Section 5.2). Last-hop routers
to those clusters are likely gateways that connect cel-
lular networks to public Internet. Therefore, all the
IP addresses within the clusters are very likely cellu-
lar IP addresses (i.e., IP addresses assigned to cellular
devices). By generalizing the characteristics of these ad-
dresses, we can ﬁnd some rules for identifying cellular
devices. For example, if the addresses have a common
reverse DNS (rDNS) pattern, then the pattern can be
used for identifying cellular IP addresses in general.
We actually tried to ﬁnd rDNS patterns for cellular
IP addresses using the OCN and Tele2 blocks (that we
described in Section 5.2). All the IP addresses within
the Tele2 blocks had a common rDNS pattern, that is,
m[0-9].+\.cust\.tele2” (in regular expression). The
∧
“
OCN blocks also had a dominant pattern. About 95%
of the rDNS names had a common keyword “omed”.
To ensure that these patterns are only used for cellular
IP addresses, we checked whether the patterns do not
match the rDNS names of routers (that we identiﬁed
using traceroute), and other types of end-hosts (that
we identiﬁed from a list of Bitcoin nodes [22], which are
not likely cellular devices). None of the rDNS names
matched any of the patterns. This result demonstrates
that Hobbit blocks can be used for identifying cellular
devices.
7.3
Implication for sampling
The Hobbit blocks can also be used for sampling. We
demonstrate that a more representative sample can be
generated by selecting elements from each Hobbit block.
Internet hosts are very diverse even within an ISP. We
12We do not contain the overhead of constructing Hobbit
blocks in this graph, because we intend to use Hobbit
blocks not only for topology discovery but also for var-
ious other purposes, as we will discuss in this section.
consider a sample to be more representative if it con-
tains the elements for more types of hosts. Since it is
very challenging to identify the types of the entire Inter-
net hosts, we focus on a speciﬁc ISP, Time Warner ca-
ble. The reverse DNS (rDNS) naming schemes of Time
Warner cable are open [29]. Diﬀerent rDNS patterns
represent diﬀerent types of hosts, and thus the represen-
tativeness of a sample can be estimated by the number
of distinct rDNS patterns in the sample13. We compare
two sampling methods, a stratiﬁed sampling that draws
a sample point from each Hobbit block and a simple
random sampling (that is, to draw sample points from
a whole population)14. We generate samples 25 times
using each method, and compute the mean of the num-
ber of distinct rDNS patterns in each sample. Figure
12 shows the mean values which are normalized by the
mean of the stratiﬁed sampling.
(We do not include
error bars because the standard error of the mean was
negligible.) When the sample sizes are equal, a strati-
ﬁed sample contains 2.5 times more rDNS patterns than
a random sample. Even when the sample size is dou-
bled for random sampling, the number of rDNS pat-
terns in the sample is only 60% of the number in a
stratiﬁed sample. When 4 times as many sample points
as stratiﬁed sampling are chosen for random sampling,
the numbers of rDNS patterns becomes similar but the
stratiﬁed sample still has slightly more of the patterns.
This result shows that the stratiﬁed sampling that uses
the Hobbit blocks generates a more representative sam-
ple than a simple random sampling.
We note that the stratiﬁed sample generated by draw-
ing a single sample point from each Hobbit block only
contains 73% of the entire rDNS patterns. This im-
plies that some Hobbit blocks contain multiple rDNS
patterns (in other words, rDNS patterns are not com-
pletely correlated within some Hobbit blocks). Never-
theless, stratiﬁed sampling from Hobbit blocks provides
a much better trade-oﬀ between representativeness and
sample sizes than random sampling (and stratiﬁed sam-
pling from /24s).
8 RELATED WORK
There have been studies that measure the homogeneity
of IPv4 address blocks. Cai et al. [25] identiﬁed homo-
geneous blocks using their clustering method in terms
of address usage, and Quan et al. [2] have reported that
most of /24 blocks are homogeneous in terms of geo-
graphical locations. Freedman et al. [30] also have quan-
tiﬁed the geographic locality of IPv4 address blocks.
13This approach has a limitation that the information in
rDNS names may be stale.
14Random sampling can be nearly equivalent to strati-
ﬁed sampling from /24 blocks, if the addresses within
/24 blocks have common rDNS patterns (because /24s
are equal-sized blocks). We conﬁrmed that, for Time
Warner Cable, the number of rDNS patterns within the
stratiﬁed samples from /24s are almost identical to that
within the random samples.
163More recently, Gharaibeh et al. [31] evaluated the ge-
ographic co-locality of /24 blocks based on delay mea-
surements. Chen et al. [32] clustered the IP addresses of
web clients that use the same local domain name server
(LDNS), and measured the geographical locality of the
clusters. Our work also measures the homogeneity of
IPv4 address blocks, but instead we focus on topologi-
cal proximity. Topologically distant hosts may however
be indicative of these other metrics by having similar
availability (e.g., web servers within diﬀerent ASes) and
similar geographical locations (e.g., residential hosts of
diﬀerent broadband ISPs that are in the same region).
Paris-traceroute MDA [14] enumerates all load-balanced
paths between source-destination pairs. It can be also
used for enumerating per-destination load-balanced paths.
Hobbit also ﬁnds diverse paths towards /24 blocks. How-
ever, Hobbit concludes that the paths are load-balanced
paths only when their relationships are non-hierarchical.
This diﬀerentiates Hobbit from Paris-traceroute MDA.
Several studies have observed path diversity due to
load balancing. Our work is relevant to these studies
in that we also have observed and dealt with the path
diversity. Augustin et al. [6] have observed that 39% of
source destination pairs traversed per-ﬂow or per-packet
load balancers, and 70% traversed per-destination load-
balancers. Flach et al. [33] have quantiﬁed violations
of destination-based forwarding due to load-balancing.
Pelsser et al. [34] observed a signiﬁcant diﬀerence in
latency between ﬂows for the same source destination
pair, which implies the existence of per-ﬂow load-balancers.
9 CONCLUSION
In this paper, we presented the design and implemen-
tation of a methodology called Hobbit that measures
the homogeneity of /24 blocks in terms of topologi-
cal proximity. Hobbit deals with path diversity due
to per-destination load-balancing by distinguishing be-
tween route diﬀerences due to load-balancing and dif-
ferent route entries. We have identiﬁed 1.77M homoge-
neous /24 blocks using Hobbit and aggregated them into
0.51M homogeneous aggregate blocks. We have charac-
terized the top 15 biggest blocks, and found that most of
them have been allocated to datacenters or cellular net-
works. We also have discovered that most of the blocks
consist of numerically discontiguous addresses. Finally,
we have shown that the use of the blocks for topology
discovery and sampling reduces measurement loads of
topology discovery and enhances the representativeness
of a sample. We make the Hobbit blocks publicly avail-
able at: http://www.cs.umd.edu/˜ydlee/hobbit/
As future work, we intend to apply Hobbit to IPv6
networks. We also plan to perform a longitudinal anal-
ysis of the homogeneity of /24 blocks to observe how
IPv4 address exhaustion aﬀects the address allocations.
Finding other applications of Hobbit than topology dis-
covery and sampling is also our goal.
Acknowledgments
We thank our shepherd, Ethan Katz-Bassett, and the
anonymous reviewers for their helpful comments. This
research was supported in part by NSF grant CNS-
1526635.
10 References
[1] L. Quan, J. Heidemann, and Y. Pradkin,
“Trinocular: Understanding Internet reliability
through adaptive probing,” in SIGCOMM, 2013.
[2] L. Quan, J. Heidemann, and Y. Pradkin, “When
the internet sleeps: correlating diurnal networks
with external factors,” in IMC, 2014.
[3] CAIDA, “The CAIDA UCSD IPv4 Routed /24
Topology Dataset.” http://www.caida.org/data/
active/ipv4 routed 24 topology dataset.xml.
[4] C. Contavalli, W. van der Gaast, D. Lawrence,
and W. Kumari, “IETF Draft: Client subnet in
DNS requests,” Nov. 2014.
[5] S. v. Dongen, Graph clustering by ﬂow simulation.
University of Utrecht, 2000.
[6] B. Augustin, T. Friedman, and R. Teixeira,
“Measuring load-balanced paths in the internet,”
in IMC, 2007.
[7] ZMap, “FULL IPv4 ICMP Echo Request.” https:
//scans.io/series/0-icmp-echo request-full ipv4.
[8] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey,
and J. A. Halderman, “A search engine backed by
Internet-wide scanning,” in CCS, 2015.
[9] “Cisco Load-Balancing.”
http://www.cisco.com/c/en/us/support/docs/ip/
border-gateway-protocol-bgp/5212-46.html\
#perper.
[10] S. K. Thompson, Sampling. John Wiley & Sons,
2012.
[11] Y.-C. Chen, Y. Liao, M. Baldi, S.-J. Lee, and
L. Qiu, “OS ﬁngerprinting and tethering detection
in mobile networks,” in IMC, 2014.
[12] B. Augustin, X. Cuvellier, B. Orgogozo, F. Viger,
T. Friedman, M. Latapy, C. Magnien, and
R. Teixeira, “Avoiding traceroute anomalies with
paris traceroute,” in IMC, 2006.
[13] Cisco, “TTL Expiry Attack Identiﬁcation.”
http://www.cisco.com/c/en/us/about/
security-center/ttl-expiry-attack.html.
[14] B. Augustin, T. Friedman, and R. Teixeira,
“Multipath tracing with paris traceroute,” in
E2EMON, 2007.
[15] MaxMind, Inc., “Geolite databases.”
http://dev.maxmind.com/geoip/legacy/geolite/.
[16] KRNIC, “WHOIS services.”
http://whois.kisa.or.kr/eng/.
[17] KRNIC, “IPv4 address holdings.” http:
//krnic.or.kr/jsp/eng/ipas/statistics/ipV4.jsp.
[18] Amazon, “AWS regions and endpoints.”
164http://docs.aws.amazon.com/general/latest/gr/
rande.html.
[26] D. Dueck, Aﬃnity propagation: clustering data by
passing messages. University of Toronto, 2009.
[19] R. Padmanabhan, P. Owen, A. Schulman, and
N. Spring, “Timeouts: Beware surprisingly high
delay,” in IMC, 2015.
[20] Q. Xu, J. Huang, Z. Wang, F. Qian, A. Gerber,
and Z. M. Mao, “Cellular data network
infrastructure characterization and implication on
mobile content placement,” in SIGMETRICS,
2011.
[21] K. Zariﬁs, T. Flach, S. Nori, D. Choﬀnes,
R. Govindan, E. Katz-Bassett, Z. M. Mao, and
M. Welsh, “Diagnosing path inﬂation of mobile
client traﬃc,” in PAM, 2014.
[22] “BITNODES.” https://bitnodes.21.co/nodes/.
[23] Cox, “PHOENIX NAP.”
http://www.coxbusinessaz.com/assets/docs/
BusinessContinuitySheet.pdf.
[24] Cisco, “Load Balancing with CEF.” http://www.
cisco.com/en/US/products/hw/modules/ps2033/
prod technical reference09186a00800afeb7.html.
[25] X. Cai and J. Heidemann, “Understanding
block-level address usage in the visible internet,”
in SIGCOMM, 2010.
[27] “MCL.” http://micans.org/mcl/.
[28] S. Brohee and J. Van Helden, “Evaluation of
clustering algorithms for protein-protein
interaction networks,” BMC bioinformatics, vol. 7,
no. 1, p. 1, 2006.
[29] Time Warner Cable, “RDNS naming schemes.”
http://postmaster.rr.com/reverse dns.
[30] M. J. Freedman, M. Vutukuru, N. Feamster, and
H. Balakrishnan, “Geographic locality of ip
preﬁxes,” in IMC, 2005.
[31] M. Gharaibeh, H. Zhang, C. Papadopoulos, and
J. Heidemann, “Assessing co-locality of ip blocks,”
in IEEE Global Internet Symposium, 2016.
[32] F. Chen, R. K. Sitaraman, and M. Torres,
“End-user mapping: Next generation request
routing for content delivery,” in SIGCOMM, 2015.
[33] T. Flach, E. Katz-Bassett, and R. Govindan,
“Quantifying violations of destination-based
forwarding on the internet,” in IMC, 2012.
[34] C. Pelsser, L. Cittadini, S. Vissicchio, and
R. Bush, “From paris to tokyo: On the suitability
of ping to measure latency,” in IMC, 2013.
165