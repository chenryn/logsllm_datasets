现在， 槽的总数是N。因此， 
   n1+ n2+ n3+ n4 = N 
   i.e. n1+ 2 n1 + 4 n1 + 10 n1 = N 
   i.e. n1 = N/17 
因此， 
   n2 = 2N/17 
   n3 = 4N/17 
   n4 = 10N/17 
平均传输速率为： 
   (10t n1+5t n2+ 2.5t n3+t n4)/tN 
   = (10N/17 + 5 * 2N/17 + 2.5 * 4N/17 + 1 * 10N/17)/N 
   = 40/17 = 2.35 Mbps 
c)在子帧中，节点A接收的数据是节点B、C和D的两倍。因此，
 10tn1 = 2 * 5tn2 = 2 * 2.5tn3 = 2 * tn4 
 i.e. n2 = n1 
 n3 = 2n1 
 n4 = 5n1 
同样的， 
 n1 + n2 + n3 + n4 = N 
 i.e. n 1+ n1 + 2n1 + 5n1 = N 
 i.e. n1 = N/9 
平均传输速率是： 
 (10t n1+5t n2+ 2.5t n3+t n4)/tN 
 = 25/9 = 2.78 Mbps 
同样，考虑节点B、C或D接收的数据是任何其他节点的两倍，可以计算平均传输速率的不同值。
P11、
a)否。所有路由器可能无法立即路由数据报。这是因为距离向量算法（以及AS之间的路由协议，如是分散的，需要一些时间来终止。所以，在这段时间算法仍在运行，因为广告来自新的外国网络，一些路由器可能无法将数据报路由到移动节点。
b)是。当其中一个节点刚刚离开一个外国网络时可能会发生这种情况加入了一个新的外国网络。在这种情况下，从旧的路由条目外国网络可能没有完全撤回时，从新的网络正在被传播。
c)路由器学习移动节点路径所需的时间取决于的路由器和边缘路由器之间的跳数节点。
P12、
![avater](./img/1.png)
如果通讯员是可移动的，那么发送给记者的任何数据报都必须通过通讯员的家庭代理。访问的网络中的外国代理也需要参与，因为正是该外国代理将通讯员的位置通知通讯员的本国代理。记者的本地代理接收到的数据报需要在通讯员的本地代理和外部代理之间封装/隧道化(如图6.23顶部的封装图所示)。
P13、因为数据报必须首先转发给归属代理，并且从那里转发到移动设备，所以延迟通常将比通过直接路由更长。但是，可能的是，从通信方到移动设备的直接延迟(即，如果数据报没有通过归属代理路由)实际上可以小于从通信方到归属代理和从那里到移动设备的延迟的总和。这取决于这些不同路径段的延迟。注意，间接路由还增加了归属代理处理(例如，封装)延迟。
P14、首先，我们注意到在第6.5节末尾讨论了链接。在使用通过归属代理的间接路由进行链接的情况下，将发生以下事件：
- 移动节点到达A，A通知归属代理移动正在访问A，移动到移动端的数据报现在应该被转发到A中指定的注意地址(COA)。
- 移动节点移动到B。B处的外国代理必须通知A处的外国代理，该移动设备已不在A中，但实际上是在B中，并且在B中有指定的COA。从那时起，A中的外国代理将接收到的数据报发送到A中的移动COA到B中的移动COA。
- 移动节点移动到C。C处的外国代理必须通知B处的外国代理，该移动设备已不在B中，但实际上是C中的C，并且在C中具有指定的COA。从那时起，B中的外国代理将它收到的(从A中的外国代理接收的)发送到移动台B中的COA的数据报转发到移动的C中的COA。
请注意，当移动设备离线(即，没有地址)或返回到其家乡网络时，必须删除由A、B和C中的外国代理维护的数据报转发状态。这种拆卸也必须通过信令消息来完成。请注意，本地代理不知道移动设备的移动性超过A，并且通讯员根本不知道移动设备的移动性。
在不使用链接的情况下，将发生以下事件：
- 移动节点到达A，A通知归属代理移动正在访问A，移动到移动端的数据报现在应该被转发到A中指定的注意地址(COA)。
- 移动节点移动到B。B处的外国代理必须通知A处的外国代理和本地代理，移动台已不再是A中的居民，但实际上是在B中，并且在B中有指定的COA。A中的外国代理可以移除其关于移动的状态，因为它不再在A中，因此本地代理将转发它在B中收到的发送到移动的COA的数据报。
- 移动节点移动到C。C处的外国代理必须通知B处的外国代理和本地代理，移动台已不再是B中的居民，但实际上是C中的C，并且在C中有指定的COA。B中的外国代理可以移除其关于移动的状态，因为它不再在B中。从那时起，本地代理将转发它在C中收到的发送到移动的COA的数据报。
当移动设备离线或返回其家庭网络时，必须移除外国代理在C中维护的数据报转发状态。这种拆卸也必须通过信令消息来完成。请注意，本地代理总是知道移动当前的外部网络。然而，记者仍然幸灾乐祸地不知道手机的移动性。
P15、在同一个访问网络中，两个移动电话的地址肯定是相同的。事实上，如果地址是外国代理人的地址，那么这个地址也是一样的.一旦外国代理解封装隧道数据报并确定移动地址，则需要使用单独的地址将数据报分别发送到访问网络中的不同目的地(手机)。
P16、如果向HLR提供了MSRN，则当MSRN发生变化时(例如，当切换要求MSRN改变时)，必须在HLR中更新MSRN的值。在HLR中拥有MSRN的优点是可以快速提供值，而无需查询VLR。通过提供VLR而不是MSRN的地址，无需刷新HLR中的MSRN。
[Back to Index](#目录)
# 第八章
## 复习题8
R1、机密性是原始明文消息不能由拦截原始明文消息的密文加密的攻击者确定的属性。消息完整性是接收器可以检测发送的消息(无论是否加密)在传输中改变的属性。这两个概念是不同的概念，一个可以没有另一个概念。在传输中被更改的加密消息仍然是机密的(攻击者不能确定原始明文)，但如果未检测到错误，则不会具有消息完整性。类似地，在传输(和检测到)中被改变的消息可能已经以明文发送，因此不会是机密的。
R2、用户的笔记本电脑和一个web服务器；（ii）两个路由器；（iii）两个DNS名称服务器
R3、对称密钥系统和公钥系统的一个重要区别是
对称密钥系统发送者和接收者必须知道相同的（秘密）密钥。
在公钥系统中，R。这个加密密钥是全世界都知道的（包括发送方），但是解密钥匙只有接收者知道。
R4、在这种情况下，将执行已知的明文攻击。如果发送者加密的消息是由攻击者选择的，那么这将是被选择的明文攻击。
R5、一个8块密码有$2^8$个可能的输入块.每个映射都是两个输入块的排列，所以有$2^8!$可能的映射；所以有$2^8!$可能的钥匙。
R6、如果每个用户想要与N个其他用户通信，则每对用户必须必须具有共享对称密钥。存在n*(n-1)/2这样的对,因此,n*(n-1)/2键。利用公共密钥系统,每个用户具有公共密钥,众所周知，私有密钥(它是秘密的并且仅由用户知道)。在那里因此是公共密钥系统中的2n个密钥。
R7、a mod n=23，b mod n=4
所以(a*b) mod n=23*4=92
R8、175
R9、消息摘要的一个要求是，给定消息M，很难找到具有相同消息摘要的另一个消息M‘，作为推论，给定消息摘要值很难找到具有该消息摘要值的消息M’‘。我们有“消息完整性”，在某种意义上，我们有合理的信心，即给定消息M及其签名消息摘要，消息没有被更改，因为消息摘要是计算和签名的。Internet校验和不是这样的，我们在图7.18中看到，很容易找到两条具有相同Internet校验和的消息。
R10、没有。这是因为散列函数是单向函数。也就是说，给定任何哈希值，原始消息都无法恢复(给定h，使得h=H(M)，则不能从h恢复m)。
R11、这显然是有缺陷的。Truddy，攻击者，可以先嗅探通信并且通过从H(M)S中提取最后一部分数字来获得共享秘密S。然后,Truddy可以通过创建自己的消息T并发送(T,h(t)s)。
R12、假设Bob向Alice发送加密文档。要验证，Alice必须是能够说服自己Bob发送了加密的文档。为了不可伪造，Alice必须能够使自己确信只有Bob可以发送加密的加密文档(例如，没有其他人可以猜出密钥并加密/发送)(文件)为非声誉的，Alice必须能够说服其他人只有鲍勃发了这份文件。为了说明后一种区分,假设Bob和Alice共享密钥，他们是世界上唯一知道的人钥匙。如果Alice接收用密钥加密的文档，并且知道如果她自己没有对文档进行加密，则该文档是已知的可验证和不可伪造（假设适当强的加密系统）使用)。然而，Alice不能说服其他人Bob必须已经发送了文档，因为实际上爱丽丝知道自己的钥匙，并且可能已经加密/发送了文件。
R13、公钥签名的消息摘要是“较好”，其中一个只需要加密(使用私钥)短消息摘要，而不是整个消息。因为公开了使用像RSA这样的技术的密钥加密是昂贵的，需要签名(加密)比大量数据少的数据量。
R14、这是假的。要创建证书，certifier.com将包括数字签名，这是foo.com信息（包括其公共密钥）的散列，并与certifier.com的私钥。
R15、对于基于MAC的方案，Alice必须与每个潜在的接收者建立共享密钥。对于数字签名，她对每个接收者使用相同的数字签名；数字签名是通过用她的私钥签名消息的散列来创建的。数字签名显然是更好的选择。
R16、现时的目的是防范重放攻击。
R17、生命周期中的一次意味着发送nonce的实体将不再使用该值来检查另一个实体是否“活动”。
R18、在中间人攻击中，攻击者将自己置于Alice和Bob之间，改变它们之间发送的数据。如果Bob和Alice共享秘密认证键，然后将检测到任何更改。
R19、Alice提供数字签名，Bob可以从中验证该消息来自艾丽丝。PGP使用数字签名，而不是MAC，用于消息完整性。
R20、是假的。SSL使用隐式序列号。
R21、握手中的随机不连续的目的是为了抵御连接重播攻击。
R22、真的。IV通常是在清除中发送的。在SSL中，它在SSL握手期间发送。
R23、客户端将生成预主密钥(PMS)后，它将用Alice对其进行加密公钥，然后将加密的PMS发送到Truddy。特鲁迪将无法解密PMS，因为她没有Alice的私钥。因此,Truddy将不能够确定共享的认证密钥。她可以猜猜看一个人选择随机密钥。在握手的最后一个步骤中，她向BobA发送所有握手消息的MAC，使用所猜测的验证密钥。当Bob接收MAC，MAC测试将失败，Bob将结束TCP连接。
R24、是假的。通常，在主机A和主机B之间首先建立IPsecSA。然后，流中的分组使用SA。
R25、是假的。IPsec将为其发送的每个数据包增加序列号。
R26、假的。IKE SA用于建立一个或多个IPSec SAS。
R27、01011100
R28、正确
R29、过滤表和连接表。连接表跟踪连接，允许更好地过滤数据包。
R30、正确
R31、正确
R32、如果没有数据包过滤器，则该机构的网络中的用户仍将能够直接连接到机构的网络之外的主机。所述过滤器强制用户首先连接到应用程序网关。
R33、正确
[Back to Index](#目录)
## 问题8
P1、“这是一个简单的问题”的编码是“UASI我的cmiw lokngch”。“rmij‘u uamu xyj”的解码是“没有那么有趣”。
P2、如果特鲁迪知道“bob”和“Alice”这两个词出现在文本中，那么她就会知道b，o，a，l，i，c，e的密文(因为“bob”是消息中唯一的回文，而“Alice”是唯一的5个字母。)如果Trudy知道7个字母的密文，那么她只需要尝试19！，而不是26！明文-密文对。19！还有26！差别是26*25*24.*20，等于3315312000，或大约10^9
P3、字母表中的每一个字母出现在短语“快速狐狸跳过懒惰”的短语中。BrownDog."在选定的明文攻击中(攻击者拥有此短语)明文和密文,凯撒密码将被破坏-入侵者将了解每个明文字符的密文字符。然而，Vigenere密码不总是将给定明文字符转换为相同的密文每次字符，因此Vigenere密码将不会立即被打破。此选定的明文攻击。
P4、
A)输出等于00000101次重复八次。
B)输出等于00000101次重复，7次乘以10000101次。
c)我们有(ARBRCR)R=CBA，其中A，B，C是字符串，R是逆运算。因此：
1.对于(A)，输出为10100000次，重复8次；
2.对于(B)，输出为10100001 10100000次，重复7次。
P5、
a)有8个表格。每个表格都有28个条目。每个条目具有8位。每个表*大小的表*大小*每个条目大小=8*28*8=214位
b)有264条目的。每个条目具有64位。271位
P6、
a)100100100=>011011011 特鲁迪将知道三个街区的明文是相同的。 c（i）=KS（m（i）异或c（i-1）） c（1）=KS（100XOR111）=KS（011）=100 c（2）=KS（100XOR100）=KS（000）=110 c（1）=KS（100XOR110）=KS（010）=101。
P7、
a)我们被给予了P-3和Q为11。因此，我们有N-33和Q-11。选择E或9（它也许是个好主意给学生一个提示：9是一个很好的选择，因为所得到的计算不太可能遇到比数值稳定性问题更小的数值稳定性问题。E.)自3和(p.1)*(q/1)*(20)中的其他选择没有共同的因素。选择D或9也使得E*D/81和因此E*D或80完全可被整除。20.现在，我们可以使用N/33、E或9执行RSA加密和解密，并且D/9。
letter m m**e ciphertext = m**e mod 33 
d 4 262144 25 
o 15 38443359375 3 
g 7 40353607 19 