分布式架构下的应用交易链路可观测性监控项目
一．内容概要600-800字
随着银行信息化建设，后台核心信息系统业务复杂度加大，在服务能力提升的同时，复杂的业务架构也使故障定位愈加困难。银行信息系统要求计算结果精准、处理业务高效，且全年不间断运行，对系统稳定性有很高的要求。为顺应国家数字化转型及信息技术创新要求，有效防范系统性金融风险，我行建立了分布式架构下的应用交易链路可观测性监控系统，以实现对日志、指标与链路跟踪三类数据的集中采集和分析，利用内置数据模型构建应用交易全链路拓扑图，实时监控各系统的业务状况并提供智能告警，帮助运维人员准确定位故障，保障系统稳定运行。
应用交易链路可观测性监控由日志、指标与链路跟踪三类数据共同构建。日志是带时间戳的文本信息，可详细解释系统的运行状态；指标（Metrics）是聚合数据，可观察系统的状态和趋势，但缺乏问题定位的细节信息；链路追踪（Tracing）信息可分析出请求中的异常点。交易全链路监控系统将三类数据信息有效融合，实现链路监控和链路日志检索，并构建可交互的系统关联性结构拓扑视图，在拓扑节点展示相关指标信息，运维人员点击异常节点即可跳转查看具体故障日志，从而进一步追踪和分析异常原因并解决问题。
项目目前已实现跨应用的全链路性能信息集中采集，从整体维度到局部维度进行各项指标的功能展示，可同时度量整体和局部性能，包括应用黄金指标实时监控、应用拓扑自动串联、单笔交易自动串联等。在交易链路拓扑展示方面，增加"链路折叠"效果，实现应用-接口-链路层级分明的展现效果，并通过关系线指标展示增强可读性，通过逻辑通畅的页面交互方式，实现纵向向导式多维排障闭环流程。通过引入流式告警实现精细化监控告警，可直接获取海量流式数据进行关键字告警，通过智能告警归并功能帮助运维人员避免告警风暴，并新创错误码动态阈值监控提高监控分析能力，提升告警效率的同时减少搜索引擎压力，缩短系统故障恢复时间，保障业务高质量发展。
项目采用国产自主知识产权的搜索引擎，也为中国银行业金融科技关键技术实现自主可控提供了可借鉴、可复制的实践范本。
二．当前国（省）内外同类先进技术概况
国际业界：
如今的分布式系统中设计并使用了许多链路追踪工具，其中如gperf、Perf、SystemTap、DTrace、Xentrace和Xenalyze等只能在特定范围内追踪链路。为了解决这样的局限性并实现分布式系统中的监控，业界提出跨硬件和软件边界来进行关联事件研究，如Whodunit使用名为概要的事务上下文的表示来描述跨分布式机器的事务。其他一些研究建议将链路信息与请求或数据包一起打包以打破不相关性，例如Pivo追踪使用baggage将日志记录信息与特定请求上下文相关联，Appinsight和Timecard试图找到移动网络的延迟瓶颈，在传输过程中将时间信息添加到数据包中，许多系统工具也支持动态实时监控，但很多工具如SystemTap都引入了大量的高频跟踪开销，这不适用于虚拟化的网络工具。而像Dtrace是Solaris、FreeBSD等操作系统中的故障排查工具，不支持Linux中的系统追踪。
基于指标来构建监控系统，如CNCF下的Prometheus、datadog、Sysdig等，基于指标的监控系统方便根据不同目的选择性地检查或追踪系统问题，如Pip提供了应用程序级监控，但许多工具如Pinpoint和XTrace在库和中间件软件中添加了侵入式的代码，不仅在实动态监控中缺乏灵活性，而且还面临在监控效率与其开销之间权衡的挑战。
国内情况：
+----+-------+------------+-------------------------------------------+
|    | **名  | **全       | **各类工具使用情况**                      |
|    | 称**  | 链路现状** |                                           |
+----+-------+------------+-------------------------------------------+
| 同 | 广发  | 基于zip    | 日志量：约1TB                             |
| 业 |       | kin改造+** |                                           |
|    |       | 日志易**后 | 应用系统：200多个                         |
|    |       | 端监控分析 |                                           |
|    |       |            | 全链                                      |
|    |       |            | 路日志数据采集、清洗、分析、展示、告警；  |
+----+-------+------------+-------------------------------------------+
|    | 招行  | 北斗       | 招行全链路2                               |
|    |       | 系统，自研 | 018年框架改造，2019年上线，架构办全行发文 |
|    |       |            | ，规范链路追踪接入，自研系统，输出丰富字  |
|    |       |            | 段，主要功能有业务列表、应用墙、链路架构  |
|    |       |            | 图、集群列表、单笔追踪、监控告警等，总体  |
|    |       |            | 监控展示较完善，主要监控分析对象为APP端； |
+----+-------+------------+-------------------------------------------+
|    | 北京  | 自研+**    | 日志量：约2T                              |
|    | 银行  | 日志易**后 |                                           |
|    |       | 端监控分析 | 接入几                                    |
|    |       |            | 十个应用系统，研发部门推动；自定义日志规  |
|    |       |            | 范，能识别业务类型、能识别自身与非自身错  |
|    |       |            | 误，日志易接入、清洗、链路展示、告警等；  |
+----+-------+------------+-------------------------------------------+
|    | 光大  | 自研       | 2021年进行全链                            |
|    | 银行  | +某厂家后  | 路调研、招标阶段，目前处于初步开发阶段；  |
|    |       | 端监控分析 |                                           |
+----+-------+------------+-------------------------------------------+
|    | 浦发  | 基于Skyw   | 目前主要是以银联数据的业务系统改造；      |
|    | 银行  | alking改造 |                                           |
+----+-------+------------+-------------------------------------------+
| 互 | 阿里  | EagleE     | 阿里巴巴分布式调用跟踪是采用鹰眼（Eagle   |
| 联 | 巴巴  | ye（鹰眼） | Eye）系统来实现，鹰眼是基于日志的分布式调 |
| 网 |       |            | 用跟踪系统，其关键核心在于调用链，帮助用  |
|    |       |            | 户在应用运行时出现问题时，进行快速的问题  |
|    |       |            | 排查；鹰眼于2013年在阿里巴巴内部上线，目  |
|    |       |            | 前支撑阿里集团泛电商、高德、优酷等业务；  |
|    |       |            | 提供了完整的调用链路还原、调用请求量统计  |
|    |       |            | 、链路拓扑、应用依赖分析等能力，细节功能  |
|    |       |            | 包括功能包括多维条件过滤、上下游请求回溯  |
|    |       |            | 、关联业务日志、方法栈、综合诊断定位等；  |
+----+-------+------------+-------------------------------------------+
|    | 字节  | 字节链     | 服务于字节                                |
|    | 跳动  | 路追踪系统 | 全公司范围内的所有微服务架构，基于 Metri  |
|    |       | ，基于ope  | cs / Trace / Log 可靠关联关系，实时观测各 |
|    |       | ntracing和 | 节点的流量/延迟/错误率/资源使用率/告警/变 |
|    |       | CAT改造；  | 更等，快速从全链路视角获取整体状态信息，  |
|    |       |            | 用于日常巡检、故障排查或压测观测等场景。  |
+----+-------+------------+-------------------------------------------+
| 其 | 中    | 基于       | 百花齐放，各显所长；                      |
| 它 | 移信  | opentraci  |                                           |
|    | 息、  | ng进行改造 |                                           |
|    | 广东  | 进行自研、 |                                           |
|    | 移动  | 基于Skywal |                                           |
|    | 、广  | king改造、 |                                           |
|    | 东电  | 基于zipkin |                                           |
|    | 信、  | 改造、基于 |                                           |
|    | 中国  | CAT改造等; |                                           |
|    | 联通  |            |                                           |
|    | 、中  |            |                                           |
|    | 国银  |            |                                           |
|    | 联、  |            |                                           |
|    | 易方  |            |                                           |
|    | 达等; |            |                                           |
+----+-------+------------+-------------------------------------------+
3.  申报项目的详细情况及申报理由