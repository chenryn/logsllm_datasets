0.1
-
0.1
-
-
-
-
-
-
-
-
-
-
PUP Ben Mal
0.2
-
0.3
-
-
0.3
-
-
-
-
-
0.1
-
0.3
-
0.5
-
-
-
-
-
-
-
-
0.1
-
-
-
0.1
-
-
-
-
-
-
-
-
-
-
Median
PUP
0.5
0.3
0.7
0.5
0.3
1.0
0.3
0.3
-
0.6
-
0.4
-
Ben Mal
0.7
0.9
0.8
0.5
1.0
1.0
1.0
0.9
0.5
1.0
1.0
1.0
0.75
1.0
1.0
0.81
0.33
0.5
0.8
0.9
-
-
0.8
0.7
0.1
0.5
PUP Ben
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
1.0
0.8
1.0
1.0
1.0
0.7
1.0
1.0
1.0
1.0
Table 5: Parameter variability for malware, PUP and benign.
Jaccard index distribution for the top 7 most common actions in our dataset, from week 0 to week 1.
All actions
File Create
Mutex Create
Registry Set
Directory Create
Reg. Key Create
PE Create
Process Load
Median
ratio >0
ratio >2
ratio >5
Mal PUP Ben Mal PUP Ben Mal PUP Ben Mal PUP Ben
39
57%
35%
33
20%
6
7.5
22%
8%
4
10%
1.8
12%
1.3
4
1%
19
2.8
3
3
1
1
0.3
1
77%
36%
33%
42%
12%
16%
13%
6%
8
1.8
1.3
1
0
0
0
0
95%
74%
78%
74%
55%
52%
50%
54%
83%
64%
65%
54%
41%
36%
35%
29%
96%
84%
80%
77%
56%
39%
28%
60%
91%
58%
68%
60%
36%
34%
29%
20%
68%
45%
37%
34%
16%
18%
18%
3%
92%
71%
57%
58%
42%
7%
6%
34%
99%
92%
93%
92%
82%
71%
76%
83%
Table 6: IQR variability across machines for malware, PUP and benign samples across different machines. In the last 3
columns we measure the ratio of samples that show a variability greater than 0, 2 and 5 events across machines. The larger the
percentage value in those columns, the more samples have IQR greater than the threshold.
Action type
FileCreated
IESecurity
RegistryValueSet
DirectoryCreated
ProcessLoad
RegistryKeyCreated
PECreation
ProcessInjection
DesktopShortcut
ProcessManipulationInjection
IEHomePage
InternetProxyServer
Others (mean)
PUP Ben
60
12
10
9
5
4
3.8
1.7
1.6
1.4
1.1
1.0
Mal
25
27
17
12
17
16
6.7
6.3
2.7
1.9
7.8
9.9
7.9
15
2.9
2.6
1.4
1.5
1.2
1.2
1.0
1.6
1.2
1.4
≈1.5 ≈0.3 ≈1.4
Action type
FileCreated
DirectoryCreated
RegistryValueSet
ProcessLoad
PECreation
RegistryKeyCreated
OpenService
DesktopShortcut
CreateService
KeyloggerShield
ProcessInjection
IESecurity
Others (mean)
Mal
0.74
0.47
0.56
0.65
0.42
0.31
0.24
0.04
0.01
0.03
0.04
0
≈0
PUP Ben
0.88
0.75
0.35
0.73
0.47
0.67
0.79
0.65
0.57
0.29
0.25
0.41
0.15
0.29
0.02
0.14
0
0.01
0.11
0
0.02
0
0
0
0
0
Table 7: Average number of actions per execution for executions
with at least 1.
Table 8: Average appearance of an action type across machines.
3504    30th USENIX Security Symposium
USENIX Association