# OCR Output
## Page 1
云计算与虚拟化技术
第4讲: VMware vSphere Hypervisor (ESXi)
阮晓龙
13938213680/ PI:EMAIL
http://cloud.xg.hactcm.edu.cn
http://www.51xueweb.cn
河南中医药大学信息管理与信息系统教研室
信息技术学院网络与信息系统科研工作室
2021.9
---
## Page 2
2
讨论提纲
理解VMware ESXi
■vSphere Hypervisor (ESXi)
■工作原理
VMwareESXi部署方案
■选择服务器平台
■确定存储和网络
■ESXi部署方式与部署前准备
部署VMware ESXi
■基于VMwareWorkStationPro：以交互式方式部署ESXi
■基于Sugon服务器+IPMI方式：以交互式方式部署ESXi
管理VMwareESXi
■使用控制台进行配置
■使用vSphereHostClient进行管理
河南中医药大学 ／阮晓龙 / 13938213680 / http://cloud.xg.hactcm.edu.cn /http://www.51xueweb.cn
---
## Page 3
Home / VMware vSphere
Download VMwarevSphere
?
Select Version:
Product Resources
VMware Software Manager makes it easy to find, select, and download the content needed to install or upgrade a VMware product or
View My Download History
6.7V
suite with the push of a button.
 Product Information
Documentation
Customers who have purchased VMware vSphere 6.7 can download their relevant installation package from the product download tab
below. Looking to upgrade from vSphere 5.x or vSphere 6.0? Visit the VMware vSphere Upgrade Center.
vSphere Community
Support Resources
 Download Free Trial
Read More
Product Downloads
Drivers &Tools
Open Source
Custom ISOs
OEM Addons
Product
Release Date
Essentials
Essentials Plus
Standard
VMware vSphere Hypervisor (Esxi) 6.7U3b
2019-12-05
GOTODOWNLOADS
VMwarevCenterServer6.7U3o
2021-09-21
GO TO DOWNLOADS
VMware NsX for vSphere 6.4.11
2021-08-26
GO TO DOWNLOADS
VMware vSphere Replication 8.4.0.3
2021-08-10
GO TO DOWNLOADS
VMware vRealize Orchestrator Appliance 8.5.1
2021-09-16
GO TO DOWNLOADS
VMware Tools 11.3.5
2021-09-23
GO TO DOWNLOADS
Enterprise
Enterprise Plus
什么是vSphere Hypervisor?
Platinum
Link: https://www.vmware.com/cn/products/vsphere-hypervisor.html
Desktop
vSphere Scale-Out
---
## Page 4
vSphere Hypervisor 简介
公
HANDS-ONLABS
VMwarevSphereHypervisor概述
免费试用完整的vSphere
立即了解可帮您节省IT成本的易于使用的生产就绪型Hypervisor。
vSphere将虚拟化提升到了更高水平。发现更好的见解并提高性能和可用性。
观看视频
开始体验
VMwarevSphereHypervisor概述
https://www.vmware.com/cn/products/vsphere-hypervisor.html
---
## Page 5
5
Wmware
应用和云
网络连接
工作空间
安全性
按行业
资源
产品》ESXi
ESXi
下载 Hypervisor 
开始试用vSphere6.7
>
概述聚焦功能特性客户采购相关产品
试用VSPHERE云中动手实验
VMware ESXi：专门构建的裸机 Hypervisor
了解可直接安装到您的物理服务器的、可靠的裸机 Hypervisor。通过直接访问并控制底层资源，VMware ESX；可有效地对硬件进行分区，以便整合应用并降低成本。它是业界领先的
高效体系架构，在可靠性、性能和支持方面树立了行业标杆。
ESXi的优势
IT 团队肩负着适应不断波动的市场趋势并满足更高客户需求的持续压力。与此同时，他们还必须延伸IT 资源以适应日益复杂的项目。幸运的是，原名为 ESX 的 ESX；可帮助均衡以
下两种需求：提高业务成效和实现IT成本节约。VMwareESXi使您能够：
·整合硬件，以实现更高的容量利用率。
·提升性能，以获得竞争优势。
·通过集中管理功能精简IT管理。
·降低 CAPEX 和 OPEX。
·最大限度地减少运行 Hypervisor 所需的硬件资源，这意味着可以提高效率。
---
## Page 6
6
1.理解VMware ESXi
1.1 ESXi
ESXi是一个软件。
■表面上看ESXi功能比较简单：实现了虚拟化。
■实质上ESXi是一个复杂的系统，经过多年发展，已成为vSphere核心。
■将ESXi（ESX）作为付费vSphere版本的一部分使用，或与免费vSphere
Hypervisor版本配合使用。通过授权可以平滑升级。
功能特性
ESXｉ可将多台服务器整合到较少物理设备中，从而减少对空间、电力和IT 管理的要求，同时提升性能。
占用空间小
尽管 ESXi占用空间仅为 150 MB，却可实现更多功能，同时还能最大限度地降低 Hypervisor 的安全风险。
可靠的性能
适应任何规模的应用。虚拟机配置最高可达128 个虚拟 CPU、6 TB 的 RAM和120台设备，以满足您的所有应用需求。咨询各项解决方案限制以确保您不会超过您环境的受支持配
置。了解有关配置上限的更多信息。
增强的安全性
利用强大的加密功能保护敏感的虚拟机数据。基于角色的访问可简化管理，而广泛的日志记录和审核可以更好地落实责任，还可更加轻松地进行取证分析。
卓越的生态系统
获取对由硬件 OEM供应商、技术服务合作伙伴、应用和客户机操作系统组成的广泛生态系统的支持。
方便用户使用的体验
利用基于 HTML5 标准的内置现代 UI管理日常行政操作。对于需要实现运维自动化的客户，VMware 提供vSphere 命令行界面和便于开发人员使用、基于 REST 的 API。
河南中医药大学/阮晓龙／13938213680/http://cloud.xg.hactcm.edu.cn/http://www.51xueweb.cn
---
## Page 7
1.理角解VMwareESXi
1.2 ESXi Components
FIGURE 2.1
ESXi Architecture
The VMware ESXi
architecture.
VMkernel
User Worlds
Virtual
Virtual
Machine
 Machine
Monitor
(VMM)
(VMX)
Scheduler
vpxa
hostd
FDM
Storage
Network
 Stack
 Stack
Clients
Host Device Drivers
UI, CLI, API
河南中医药大学 ／阮晓龙/ 13938213680 /http://cloud.xg.hactcm.edu.cn ／http://www.51xueweb.cn
---
## Page 8
ESXi Architecture
VMkernel
User Worlds
1.理解VMware ESXi
(MX)
vpxa
hostd
FDM
ESXi有多个组件组成：
storage
letworl
Stac
Clients
■内核空间：VMKernel
Host Device Drivers
UI, CLI, API
是ESXi操作系统的核心，控制和管理其他组件。
·负责资源管理、调度、运行虚拟机、启动主机所需要的其他进程
VMM：虚拟机监视器
·在VM内核中运行的进程。
·每个虚拟机的每个虚拟CPU都有一个VMM进程。
·负责虚拟化客户操作系统并管理客户操作系统内存。
·将存储和网络请求转发给VMKernel。
·将所有其他请求转发给VMX进程。
Scheduler：资源调度器
·从VMM和VMX进程中获取硬件资源请求，并调度底层物理硬件执行。
·可以通过存储和网络堆栈访问到主机设备驱动程序，直接访问底层物理硬件
河南中医药大学 ／阮晓龙 /13938213680 /http://cloud.xg.hactcm.edu.cn /http://www.51xueweb.cn
---
## Page 9
ESXi Architecture
VMkernel
User Worlds
1.理解VMwareESXi
(VMX)
vpxa
hostd
FDM
ESXi有多个组件组成：
storage
letwork
Stack
Stack
Clients
■用户空间：User Worlds
Host Device Drivers
UI, CLI, API
口可以执行非内核进程，以确保操作系统的完整性。
 VMX:
·在内核中的每一个VM都有一个VMX执行辅助进程。
·VMX进程负责管理：键盘、鼠标、显示器（KMS）、远程控制台、非关键I/O操作
·与VMM进程系统工作，实现VM的功能。
 hostd:
·每个ESXi主机有一个hostd单一运行进程。
·hostd是VM内核的代理服务。
·所有的GUI、CLI、APl调用都是通过hostd路由到VMX或VMKernel。
河南中医药大学 ／阮晓龙 /13938213680 / http://cloud.xg.hactcm.edu.cn /http://www.51xueweb.cn
---
## Page 10
10
2.VMwareESXi部著方案
部署VMwarevSphere不仅要考虑虚拟化服务器，也要充分论证存储、
网络、安全性等。
■规划部署方案并进行论证，三
非常重要
■规划vSphere部署方案，必须明确许多问题，例如：
将使用什么类型的服务器来部署ESXi，以实现虚拟化?
口将使用什么类型的存储？如何将存储连接到虚拟化服务器？
口将如何配置网络？虚拟网络和物理网络如何实现接入？
部署方案要充分考虑各方面问题。
口技术方案
口经济成本
口政治法律法规等因素
河南中医药大学／阮晓龙/13938213680 /http://cloud.xg.hactcm.edu.cn / http://www.51xueweb.cn
---
## Page 11
11
Diagram:VMWareVSAN
CreatedBy:http://vcloud-lab.com
VM
VM
VM
VM
vSphere+vSAN
vsanDatastore
60GB
VMStoragepolicies
10GBSSD
FlashDisks
VMWare vSphere Cluster (HA+DRS)
CacheTier
10GBHDD
VMKe
VMK
VMK
VSANEnabled
VSAN Enabled
VSAN Enabled
MagneticDisks
CapacityTier
HostName Mgmt Ip
VSAN_IP
Esxi001
192.168.34.21172.20.1.21
Esxi002
192.168.34.25172.20.1.25
Esxi001
Esxi003
Esxi002
Esxi003
192.168.34.29172.20.1.29
Disk GroupO
DiskGroup1
vsanDatastore
60GB
---
## Page 12
12
2.VMwareESXi部著方案
2.1选择服务器平台
部署ESXi首先要确定服务器平台，即计算平台。
1与Windows或Linux等传统操作系统相比，ESXi有更严格的硬件限制。
■ESXi不会支持市场上所有的存储控制器或网络适配器芯片组。
■受支持的服务器并不一定是最合适的服务器，要根据需求和用途选型
VMwareCompatibilityGuide
河南中医药大学 ／阮晓龙 /13938213680/http://cloud.xg.hactcm.edu.cn /http://www.51xueweb.cn
---
## Page 13
口
十
13
VMwareCompatibilityGuide
系统类型：
其他条件：（全部折叠）
日最小验证内存：
最大验证内存：
ESXI7U3
RackorTower
AII
ESXI6.7U2
Tower
插槽数：
AII
合作伙伴名称：
功能
AMDOpter
每个插槽最大内核数
AMDOpteronGene
AMDOpter
CPU系列：
Intel Optane
tentMemory(PMem）
KagaElec
日兼容性指令集：
KNSGr
AMDBulld
ugReady
AMDOpteron4300Serles
发布日期范围
单击此处查看重要支持信息。
服务器设备和型号信息
理测试或与经VM
re合作伙伴测试的设备相似。VM
仅为本文档中列出的设备提供支持。
单击“型号"查看详细信息并订阅RSS源。
返回4条结里
合作伙伴名称
型号
支持的版本
LenovoSystemx3650M4
IntelXeonE5-2600-v2
ESXI
6.7U36.7U2
6.7U1
LenovoSystemx3650M5
ESXI
田6.7U3
6.7U26.7U1
6.7
Intel XeonE5-200-4
ESXi
田6.7U3
6.7U2
6.7U1
6.7
ESXI
6.0U3
6.0U2
6.0U1
09
本内容按“原样提供，在适用法律允许的最大范围内，VMware不提供与此内容有关的任何其他明示或暗示的声明和担保，包括特定用途适用性、适销性或不侵权，VMWARE对因使用此内
睿而引起的或与之相关的任何损害均不承担责任，包括置接的、间接的、后果性的损害、商业利润损失或特殊的损害等，即使VMware事先已被告知该类损害发生的可能性。
《VMware兼容性指南》会随时更新，恕不另行通知，如需获取最新《VMware兼容性指南》，请访问以下链接：htp/ww
rces/compatiblity
按版本查找VMware产品兼容性信息：请参见产品互操作性列表
查找VMware产品生命周期策略：生命周期策略
n?vSANVCGNotificationServiceFAQ
获取合作伙伴认证和支持的产品：合作伙伴认证和支持的产品
Cookie设置
---
## Page 14
14
2.VMwareESxi部署方案
2.2 确定存储和网络
部署ESXi的第二个关键选择是：选择正确的存储解决方案
■vSphere的DRS、HA、FT等功能对存储有较强依赖和要求。
vSphere支持的存储结构非常广泛：
 FCoE、iSCSI、NFS
口支持在单一解决方案中使用多个存储协议
VMware的兼容性指南除了能够验证服务器，还提供了存储阵列和其他存储
组件的兼容性信息。
VMware Product Interoperability Matrix
河南中医药大学／阮晓龙/13938213680 /http://cloud.xg.hactcm.edu.cn / http://www.51xueweb.cn
---
## Page 15
口Pro
×+
C
 VmWare Product Interoperabilty Matrix
Interoperabity 
3rd Party Solution Inte
PRINT | CSV| COPY
Compare
Select VMware Products
日
Solution 1
(ESXI)
Select a Solution
7.0U2
7.0U1
6.7 U3
6.7 U2
6.7 U1
6.7.0
6.5 U3
6.0 U3
6.0.0 U2
6.0.0 U1
VMware vSphere Hyper
Select a Version
7.0 U2
?
?
?
?
7.0U1
?
?
7.0
?
?