services over catv networks. IEEE Network, 11(1):36–43, 1997.
[67] P. Kalaivani and M. Vijaya. Mining based detection of botnet trafﬁc in
network ﬂow.
[68] A. Kountouras, P. Kintis, C. Lever, Y. Chen, Y. Nadji, D. Dagon,
M. Antonakakis, and R. Joffe. Enabling network security through
active dns datasets. In International Symposium on Research in Attacks,
Intrusions, and Defenses, pages 188–208. Springer, 2016.
[69] Z. Li, S. Alrwais, X. Wang, and E. Alowaisheq. Hunting the red fox
online: Understanding and detection of mass redirect-script injections.
In Security and Privacy (SP), 2014 IEEE Symposium on, pages 3–18.
IEEE, 2014.
[70] X. Liao, K. Yuan, X. Wang, Z. Pei, H. Yang, J. Chen, H. Duan, K. Du,
E. Alowaisheq, S. Alrwais, et al. Seeking nonsense, looking for trouble:
Efﬁcient promotional-infection detection through semantic inconsistency
(cid:18)(cid:18)(cid:26)(cid:25)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply. 
search. In Security and Privacy (SP), 2016 IEEE Symposium on, pages
707–723. IEEE, 2016.
[71] A. Nappa, Z. Xu, M. Z. Raﬁque, J. Caballero, and G. Gu. Cyberprobe:
Towards internet-scale active detection of malicious servers.
In In
Proceedings of the 2014 Network and Distributed System Security
Symposium (NDSS 2014), pages 1–15, 2014.
[72] M. O’Neill, S. Ruoti, K. Seamons, and D. Zappala. Tls proxies: Friend
or foe? In Proceedings of the 2016 ACM on Internet Measurement
Conference, pages 551–557. ACM, 2016.
[73] D. Perino, M. Varvello, and C. Soriente. Proxytorrent: Untangling the
free http (s) proxy ecosystem. 2018.
[74] D. Plohmann, E. Gerhards-Padilla, and F. Leder. Botnets: Detection,
measurement, disinfection & defence. European Network and Information
Security Agency (ENISA), 1(1):1–153, 2011.
[75] M. Sebasti´an, R. Rivera, P. Kotzias, and J. Caballero. Avclass: A tool
for massive malware labeling. In International Symposium on Research
in Attacks, Intrusions, and Defenses, pages 230–253. Springer, 2016.
[76] S. Soltani, S. A. H. Seno, M. Nezhadkamali, and R. Budiarto. A survey
on real world botnets and detection mechanisms. International Journal
of Information and Network Security, 3(2):116, 2014.
[77] D. Springall, Z. Durumeric, and J. A. Halderman. Ftp: The forgotten
cloud. In Dependable Systems and Networks (DSN), 2016 46th Annual
IEEE/IFIP International Conference on, pages 503–513. IEEE, 2016.
[78] B. Stone-Gross, M. Cova, L. Cavallaro, B. Gilbert, M. Szydlowski,
R. Kemmerer, C. Kruegel, and G. Vigna. Your botnet is my botnet:
analysis of a botnet takeover. In Proceedings of the 16th ACM conference
on Computer and communications security, pages 635–647. ACM, 2009.
[79] G. Stringhini, C. Kruegel, and G. Vigna. Shady paths: Leveraging surﬁng
crowds to detect malicious web pages. In Proceedings of the 2013 ACM
SIGSAC conference on Computer & communications security, pages
133–144. ACM, 2013.
[80] G. Tsirantonakis, P. Ilia, S. Ioannidis, E. Athanasopoulos, and M. Poly-
chronakis. A large-scale analysis of content modiﬁcation by open http
proxies. 2018.
[81] N. Weaver, C. Kreibich, M. Dam, and V. Paxson. Here be web proxies.
In International Conference on Passive and Active Network Measurement,
pages 183–192. Springer, 2014.
[82] U. Wijesinghe, U. Tupakula, and V. Varadharajan. An enhanced model
for network ﬂow based botnet detection. In Proceedings of the 38th
Australasian Computer Science Conference (ACSC 2015), volume 27,
page 30, 2015.
[83] Z. Xu, L. Chen, G. Gu, and C. Kruegel. Peerpress: utilizing enemies’
p2p strength against them. In Proceedings of the 2012 ACM conference
on Computer and communications security, pages 581–592. ACM, 2012.
[84] H. R. Zeidanloo, A. B. A. Manaf, R. B. Ahmad, M. Zamani, and S. S.
Chaeikar. A proposed framework for p2p botnet detection. International
Journal of Engineering and Technology, 2(2):161, 2010.
IX. APPENDIX
A. Residential Classiﬁer
Crafted residential device names and types. The crafted
residential device names and types are listed in Table XI. They
are either consumer devices exclusively used in home network
environment or network function devices usually working as
components of residential network facilities.
Phillips Hue Light
Device Names
Device Types Broadband Residential Gateway
Amazon Echo
Wemo Switch
Nest Thermostat
Amazon Fire TV
Residential ADSL Gateway
VoIP Phone Adapter
Media Device
DVR
of IP CIDRs published by popular cloud providers including
Amazon AWS [26], Google Cloud [34], Microsoft Azure [39],
IBM Cloud [37], Aliyun [25], CloudFlare [32], and Salesforce
[47]. All those together contribute 53-million IPs distributed
in 210K /24 and 968 /16 network blocks. We further looked
up the Active DNS database for Alexa top 1 million websites
and gathered 442K IPs. Another 519 IPs are collected from
PureVPN[42], a popular commercial VPN service.
Features Before going through all 35 features, let’s ﬁrstly
refresh you the following deﬁnitions (introduced in §II) used
in our features. For each IP address, we deﬁne Direct Inetnum
as the leaf inetnum node where this IP resides in, Inetnum Tree
Path as the inetnum path from the root inetnum node(0.0.0.0/0)
to its Direct Inetnum. We also deﬁne two kinds of owners,
one is Direct Owner represented by the organization ID or
person ID referred in its direct inetnum, the other is Loose
Owner represented by all org and person objects sharing with
the direct owner the same contact information including either
phone numbers or email addresses. As introduced in §III-B,
35 features are introduced in our residential classiﬁer and they
can be grouped into two categories by the datasets used to
generate them: IP Whois and Active DNS.
Features from Active DNS. We retrieve DNS records from
the latest ActiveDNS database for the following targets: the
given IP, its current direct inetnum, its /24 IP preﬁx. Then,
we proﬁle each target using TLD+2/TLD+3 domains resolved
to the IP range of the target. Speciﬁcally, we designed the
following 12 features.
• F-1: # of TLD+2 domains resolved to the given IP.
• F-2: # of TLD+3 domains resolved to the given IP.
• F-3: Percentage of IPs in current direct inetnum with DNS
records.
• F-4/F-5: Mean/Maximum number of TLD+3 domains
resolved to IPs in current direct inetnum.
• F-6/F-7: Mean/Maximum number of TLD+2 domains
resolved to IPs in current direct inetnum.
• F-8: Percentage of IPs in /24 IP preﬁx with DNS records.
• F-9/F-10: Mean/Maximum number of TLD+3 domains
resolved to IPs in /24 IP preﬁx.
• F-11/F-12: Mean/Maximum number of TLD+2 domains
resolved to IPs in /24 IP preﬁx.
Features from IP Whois. The rest 23 features are retrieved
from IP Whois, in other words, the 24 historical snapshots of
IP Whois captured in the last 24 months. Here, historical direct
inetnums means the 24 direct inetnums in corresponding 24
historical snapshots while historical direct owners and historical
loose owners share similar meanings.
• F-13: # of unique historical direct inetnums
• F-14 to F-18: Current/Maximum/Mean/Minimum/Stan-
dard deviation of the sizes of historical direct inetnums.
• F-19 to F-23: Current/Maximum/Mean/Minimum/Stan-
dard deviation of the depths of historical direct inetnums.
• F-24: # of unique assignment types of historical direct
inetnums
• F-25: Assignment type of the current direct inetnum
TABLE XI: Crafted residential device names and types
Sources of non-residential ground truth Here we provide
more details about our non-residential datasets as introduced
in §III-B. To collect IPs from cloud services, we gathered lists
(cid:18)(cid:18)(cid:26)(cid:26)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply. 
Dataset
Device Search Engines
Trace My IP
Filtered IP Whois
IoT Botnets
Public Clouds
Alexa Top 1M
Public Proxies
RESIP IPs
Label
resi-clean
resi-noisy
resi-noisy
resi-noisy
% resi % non-resi
98.47% 1.53%
94.36% 5.64%
99.10% 0.90%
98.82% 1.18%
non-resi-clean 0.39% 99.61%
non-resi-clean 2.45% 97.55%
non-resi noisy 63.54% 36.46%
95.22% 4.78%
Unknown
TABLE XII: Evaluation results of our residential classiﬁer on various
datasets. Last two columns show the percentage of IPs in the given
dataset being predicted as residential or non-residential.
MD5
Name
Providers
LU, IAPS
GS, PO
csrss.exe
hola svc.exe
74ac25ba1fa653041b3e2a3d60ceb1d0
707ffb5567bf730136614d3356a7d3c5
7971ebdb5da5c60d0b3f3d8523d94ec7 svchostwork.exe GS, PO
6925e54c4aecd522230f5765aa6e5a29
2639cd8da42d90a2e112c3d7d3e35540
7b024bb2efa5428bbd04f513849cc185
e7dca36767fadfded989ed67e23c2eda
b4b595be616779d4a557cdb49b1350d0 hola plugin.exe
d85dab7b7112af3feda144bbbffa9b49
c0a3b6dbbb454a7f3f345d7a87f8e487
PO
PR
LU
PR
PO
TABLE XIII: List of the top 10 PUPs with their MD5.
swufeb17.exe
netmedia.exe
cloudnet.exe
produpd.exe
PR
PO
pprx.exe
start.vbs
automated queries. Our validation shows that the classiﬁer
achieved a high precision, 95.80%.
B. Botnet Connections
We studied whether IoT botnets are involved in RESIP
services. Through cross-matching our RESIP IP database with
two botnet IP blacklists (Hajime [12] and IoT Reaper [13],
see §III-D), we found 1,248 IPs reported by at least one
blacklist on the same way when serving as RESIPs. We further
discovered 28,097 RESIP IPs blacklisted between July 2017
and Nov 2017. These ﬁndings indicate that at least some
resources are shared between RESIP services and botnets, due
to either co-hosting of both bots and RESIP software on the
same residential system or co-existence of the RESIP system
and the bot-infected system behind the same NAT.
C. Others
Datasets and Code release. We will continue collecting
and proﬁling more RESIP services and their RESIPs. Using
the techniques developed in this paper, we are working on
publishing a service at http://rpaas.site where users can query
using a network preﬁx and obtain a comprehensive report on
how the preﬁx has been used as RESIPs. We will also release
weekly snapshots of our RESIP dataset, groundtruth datasets
for our residential IP classiﬁer, and all source code of this
work once this paper is published.
• F-26: # of current direct owners
• F-27: # of historical direct owners
• F-28: the percent of current direct owners over historical
direct owners
• F-29: # of direct inetnums of the current direct owners
• F-30: # of IPs of the current direct owners
• F-31: # of current loose owners
• F-32: # of historical loose owners
• F-33: the percent of current loose owners over historical
loose owners
• F-34: # of direct inetnums of the current loose owners
• F-35: # of IPs of the current loose owners
Figure 9 shows the CDFs for some example features on
our labeled training set including 10K residential and 10K
non-residential IPs.
Evaluation and results. Using the training data of 10K
residential IPs and 10K non-residential IPs, we train classiﬁers
of three types: Support Vector Machine (SVM), Random
Forest (RF) and Decision Tree (DT). We further evaluate the
effectiveness of the models by 5-fold cross validation, testing
them on the rest of the four labeled datasets as well as the
unlabeled dataset (the RESIP IP dataset) with sampled manual
validation.
• 5-Fold cross validation. We explored the three classiﬁers
with various parameters. 5-fold cross validation reveals random
forest with 50 trees outperforms others, achieving the precision
of 95.61% and the recall of 97.12%.
• Testing on the labeled set. We test the random forest model on
all ground truth sets shown in Table II (only those not selected
for training). As shown in Table XII, overall the classiﬁer
works well. However, surprisingly, it detects 2.45% of IPs in
Alexa top 1M set as residential IPs. We ﬁnd that the domains of
those IPs often belong to small local organizations (e.g., local
governments or small education institutions) who access the
network through residential ISP networks. Another interesting
ﬁnding is that 65.81% of public proxies (most are either Tor
relays or proxy IPs from KuaiDaili service) are predicted as
residential, indicating Tor network’s effective recruitment of
relay volunteers, and also the suspicious proxy sources of
KuaiDaili service.
• Manually validating on the unlabeled set. We also apply
the random forest model on 6.2M RESIP IPs we collected
(see §III-A). We detect 5.9M (95.22%) residential IPs and
0.3M (4.78%) non-residential IPs. To evaluate the results, we
randomly sampled and manually validated 1K RESIP IPs.
Our validation was based upon a set of indicators identiﬁed
manually. In particular, we searched the Internet to ﬁnd out
whether the owner of a given IP, as indicated in its Whois
record, is an ISP or an organization; further we searched the
IP itself, which if utilized for a hosting service, most likely
was analyzed and reported by the IP information websites
such as http://whatismyipaddress.com/ip. The reason we used
those as indicators instead of classiﬁcation features for manual
validation is the former are easier for human to tell. Also
some of the services have rate limits, prohibiting large-scale
(cid:18)(cid:19)(cid:17)(cid:17)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply. 
(a) F-2: # of TLD+3 domains
resolved to the given IP.
(b) F-3: Percentage of IPs in
current direct
inetnum with
DNS records.
(c) F-4: Mean number of
TLD+3 domains resolved to
IPs in current direct inetnum.
(d) F-6: Mean number of
TLD+3 domains resolved to
IPs in current direct inetnum.
(e) F-8: Percentage of IPs in
/24 IP preﬁx with DNS records.
(f) F-9: Mean number of
TLD+3 domains resolved to
IPs in /24 IP preﬁx.
(g) F-11: Mean number of
TLD+3 domains resolved to
IPs in current direct inetnum.
(h) F-17: log10 Mean value of
the sizes of historical direct
inetnums
(i) F-21: Mean value of the
depths of historical direct inet-
nums
(j) F-25: Assignment type of
the current direct inetnum
(k) F-29: # of direct inetnums
of the current direct owners
(l) F-30: log10 # of IPs of the
current direct owners
(m) F-33: the percent of cur-
rent loose owners over histori-
cal loose owners
(n) F-34: # of direct inetnums
of the current loose owners
(o) F-35: log10 # of IPs of the
current loose owners
Fig. 9: Cumulative distribution functions of example features on our labeled training dataset.
(cid:18)(cid:19)(cid:17)(cid:18)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply.