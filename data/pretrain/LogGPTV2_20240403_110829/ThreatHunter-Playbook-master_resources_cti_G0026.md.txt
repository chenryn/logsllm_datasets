# G0026: APT18
## Description
APT18, also known as [G0026](https://attack.mitre.org/groups/G0026), is a threat group that has been active since at least 2009. This group has targeted a wide range of industries, including technology, manufacturing, human rights organizations, government agencies, and medical institutions. (Citation: Dell Lateral Movement)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Windows | Persistence | [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060/) | APT18 establishes persistence by adding entries to the `HKCU\Software\Microsoft\Windows\CurrentVersion\Run` registry key. | Windows Registry, File monitoring |
| Linux, macOS, Windows | Defense Evasion | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | APT18 obfuscates strings within the payload. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows | Execution | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | APT18 uses `cmd.exe` to execute commands on the victim’s machine. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control, Lateral Movement | [Remote File Copy](https://attack.mitre.org/techniques/T1105/) | APT18 can upload files to the victim’s machine. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |
| Linux, macOS, Windows | Discovery | [File and Directory Discovery](https://attack.mitre.org/techniques/T1083/) | APT18 lists files and directories on the victim’s machine. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | [Standard Application Layer Protocol](https://attack.mitre.org/techniques/T1071/) | APT18 uses HTTP and DNS for command and control (C2) communications. | Packet capture, Netflow/Enclave netflow, Process use of network, Malware reverse engineering, Process monitoring |
| Linux, macOS, Windows, AWS, GCP, Azure | Discovery | [System Information Discovery](https://attack.mitre.org/techniques/T1082/) | APT18 collects system information from the victim’s machine. | Azure activity logs, Stackdriver logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | [Commonly Used Port](https://attack.mitre.org/techniques/T1043/) | APT18 uses port 80 for C2 communications. | Packet capture, Netflow/Enclave netflow, Process use of network, Process monitoring |
| Windows | Persistence, Initial Access | [External Remote Services](https://attack.mitre.org/techniques/T1133/) | APT18 actors leverage legitimate credentials to log into external remote services. | Authentication logs |
| Windows | Execution, Persistence, Privilege Escalation | [Scheduled Task](https://attack.mitre.org/techniques/T1053/) | APT18 actors use the native `at` Windows task scheduler tool to create scheduled tasks for execution on the victim’s network. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | Defense Evasion, Persistence, Privilege Escalation, Initial Access | [Valid Accounts](https://attack.mitre.org/techniques/T1078/) | APT18 actors leverage legitimate credentials to log into external remote services. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Linux, macOS, Windows | Defense Evasion | [File Deletion](https://attack.mitre.org/techniques/T1107/) | APT18 actors delete tools and batch files from victim systems. | File monitoring, Process command-line parameters, Binary file metadata |

This table provides a comprehensive overview of the tactics, techniques, and procedures (TTPs) used by APT18, along with the corresponding data sources for detection and investigation.