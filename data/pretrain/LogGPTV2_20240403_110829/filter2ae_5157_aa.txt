译文仅供参考，具体内容表达以及含义原文为准  
Paper: 《Location leaks on the GSM air interface》  
Author: Denis Foo Kune, John Koelndorfer, Nicholas Hopper, Y ongdae Kim  
Advisor: Lenny Zeltser  
Accepted: January 15th, 2020
## 摘要
由于手机使用无线媒体和它们的移动特性，它们会收听广播通信，这些通信可能会向监听的攻击者透露它们的物理位置。本文研究了通过简单地收听广播 GSM
频道来测试用户是否存在于小区域内或不在大区域内的技术。结合现成的硬件和开源软件，我们展示了实际的位置测试攻击，包括绕过旨在保护终端用户身份的临时标识符。最后，我们提出了可以在对系统影响较小的情况下改善用户位置隐私的解决方案。
## 0x01 Introduction
有三个主要实体会以不同的方式访问用户的位置信息：服务提供商可以访问其用户的所有位置数据; 执法机构有权力索要这些信息;
以及外部实体，包括没有明确访问位置信息的其他用户。位置泄漏的通信协议将意味着，即使实体没有访问的位置数据库也够从目标用户推断出一些位置信息。  
我们集中在2层和3层的常见的较低的 GSM 堆栈层，同时关注广播频道对用户位置隐私的影响。我们展示了尽管 GSM
被设计成用临时ID隐藏终端设备的身份，但是仍可以将电话号码映射到临时ID。我们还证明，通过多个发射塔简单地查看网络发送的广播消息，就可以确定一个用户的设备是否在100km2的区域内。我们还展示了在一个发射塔上为一个用户进行测试的可能性，这个塔可以映射到一个相对较小的地理区域，大约1平方公里或更小。在这项工作中，我们还没有把范围缩小到确切的建筑，但是我们可以确定使用者是否在十几个街区之内。
## 0x02 Background
### A. GSM 基础设施概述
一个 GSM 蜂窝网络由15个主要的逻辑实体组成。与本项工作相关的实体如下:
  * 访问者位置寄存器(VLR)负责一个或多个移动站可能漫游进出的区域。此实体处理移动站的临时ID(TMSIs)。
  * 基站系统(BSS)是一个由基站收发器(BTS)和控制器(BSC)组成的网络，负责直接与移动站通信。
  * 移动站(MS)是使用者携带的移动设备。它是由实际的设备和一个 SIM卡组成的。
下图展示了体系结构和实体之间的连接的总体情况。移动站和 BTS 通过无线 GSM 协议进行通信，也就是所谓的空中接口。在 GSM
空中接口规范中定义了多个信道用于 MS 和 BTS 之间的下行和上行通信。与这项工作相关的频道如下:
  * PCCH: 所有手机都会收听的广播下行频道。有多个频率可以用绝对射频信道号(ARFCN)来识别，这些频率可以用于该信道。
  * RACH: 任何在网络上注册的移动站都可以使用的随机接入上行链路信道。
  * SDCCH: 一个特定的上行通道，由 BTS 分配。
为了限制无线电资源的消耗，蜂窝网络将设法通过它的发射塔来限制通信量，只传送在该特定地区服务的手机所需的信息。因此，所述传呼请求广播消息通过位于特定位置区号(LAC)内的发射塔发送，该发射塔为所关注的移动站服务。这些消息是通过广播
PCCH 下行链路发送的，并用于通知移动站它需要联系 BTS 。移动站按照他们所选择的 BTS 的特定频率调谐(或驻留)
，并能够收到所有正在发送的寻呼。每个传呼请求消息包含预期目的地的唯一标识符，或者是全球唯一的国际移动台标识(IMSI)
，或者是临时移动用户标识(TMSI)。
### B. 来电协议
GSM 网络中的无线接口在来电期间的逻辑流程如下 :
  1. BSS 试图找到移动站。BTSs 在最近的已知 LAC 看到设备，通过 PCCH 下行链路发送一个带有移动站 IMSI 或 TMSI 的寻呼请求(paging request)。
  2. 在接收到传呼请求后，移动站将确定 IMSI 或 TMSI 是否与自己的匹配。如果是，移动台将通过 RACH 上行链路发送信道请求消息，从 BTS 请求无线资源。
  3. BTS 会在同一个 PCCH 下行链路发送的即时分配消息中显示即将用于移动站的 SDCCH 的详细信息。
  4. 移动台在分配的 SDCCH 上行链路上回复一个寻呼应答。协议的其余部分允许移动台和 BTS 在传输数据(文本或语音)之前协商安全级别和其他设置参数。协议描述如下图所示。
**寻呼请求信息:** 寻呼请求信息可以是类型1、2和3，同时分别携带最多2、3和4个标识。传呼请求是针对每个发送到 LAC
内的移动站的呼叫或文本消息而发出的。对寻呼请求的响应是从移动台 通过SDCCH 上行链路发送到它选择的 BTS 。通常移动站会选择信号最强的 BTS。  
**即时分配消息:**
即时分配是对来自移动站的信道请求消息的响应。它包含与通道请求消息匹配的标识符。由于立即分配消息是通过广播信道发送的，所述标识符允许移动站区分用于它的消息和用于其他移动站的消息。如果收到了上行信道请求消息，很容易与请求设备匹配，但通过观察
PCCH
下行链路来确定即时分配消息是否是来自寻呼请求消息的触发的结果则更为棘手。如果能够确定观察到的即时分配消息确实即将用于目标移动站，则表明该设备驻留在带有该消息的
PCCH 的 ARFCN 上。因此，这说明这个装置，和我们监听的那个在同一个信号塔上。
## 0x03 Preliminary Measurements
我们在一个主要城市群对 T-Mobile 和 AT&T 网络进行了初步测量，以描述实际部署的特征。
### A. 测量平台
我们的测量系统(如下图所示)是基于Osmocom基带平台
，再加上能够打出电话的地线电话。右下角是摩托罗拉C118连接到一台笔记本电脑上。我们用Osmocom的 GSM 第一层固件替换了
c118固件。新的固件从笔记本电脑调谐到请求的
ARFCN，并通过其串行端口将所有第一层消息中继到笔记本电脑。在笔记本电脑上运行是Osmocom，它将替换固件刷新到
c118，然后变成一个中继器，将数据包从串行端口转发到socket，供Osmocom的其他应用程序使用。在同一台笔记本电脑上运行的移动应用程序连接到socket，并实现
GSM 第2层和第3层。
图中左侧的T-Mobile G1(US)被用作我们的映射工具。它关注的是 AT+GSM 命令，查询基带当前关于 TMSI、 LAC、 ARFCN 以及相邻
ARFCNs 列表的信息。我们的补丁程序记录了这些信息，当现场测试应用程序查询时是1赫兹，这样我们就可以将这些信息与另一个设备上的 GPS
坐标进行匹配。那部手机后来被用作受害者的手机，因为它允许我们用设备的 TMSI 检查我们的答案。
### B. 一般性观察
为了了解 PCCH 流量的总体趋势，我们在 T-Mobile 网络和 AT&T 网络上进行了一系列的捕获。24小时内的结果总结如下表所示。
接下来，我们测量了 PSTN 上的呼叫启动和 PCCH
上发出的寻呼信道请求之间的时间延迟。对于我们的40个电话样本，我们观察到平均延迟2.96秒，标准差为0.152。PSTN
呼叫启动和移动站上的实际环路之间的平均时延为8.8秒，标准差为4.5秒，中位数是7.0秒。我们还观察到，在 PSTN
呼叫启动后5.0秒之前中止呼叫，将导致设备上没有响铃或未接呼叫，但到那时，paging请求已发送。
### C. 在 PCCH 上观察到的信息
最常见的Paging请求是类型1，允许为每条消息寻呼一个或两个移动身份。我们观察到超过90% 的Paging请求没有标识;
这些在下图中没有绘出，因为他们不会到达设备。在 AT&T
网络上捕获超过48小时的传呼请求摘要见下图。我们观察到本地人活动的一般趋势是，白天时间流量高达每分钟150次寻呼，凌晨零时至上午六时流量低至每分钟10次寻呼。
通过 T-Mobile 的21小时截图，我们观察了同一 TMSI
的两次呼叫的时差模式。如下图所示，在大约200秒的时差之前，分布会急剧下降，在600秒的时差之后，分布会趋于平稳，超过这个时差，同一 TMSI
的两次呼叫就不可能出现。在51小时的 AT&T
实验中，传呼请求信息的流量速率(2.32/秒)远远超过即时分配信息的流量速率(0.554/秒)。很明显即时分配消息仅限于移动站向 ARFCN
(因此也限于移动电话发射塔)请求无线电资源。
## 0x04 Attack Description
### A. 威胁模型
攻击者首先需要能够主动地为受害者引入 PCCH
寻呼请求，这可以通过短信或使用任何电话线的呼叫启动来实现。为了提高定时准确性和更好地控制中止呼叫协议的时间，避免在受害者手机的应用层发出通知，普通固定电话线是首选。攻击者还要求能够被动地听广播
GSM PCCH 寻呼信道。我们对攻击者的能力描述如下:
  * PSTN active: 攻击者通过拨打受害者的电话号码或给受害者发送短信，使寻呼请求信息出现在 GSM PCCH 上。
  * GSM 被动: 攻击者是 PCCH 广播纯文本上的被动监听者。不需要破解加密算法，因为在 GSM 协议的无线资源(RR)设置阶段，我们只需要4条消息的开始序列。
### B. 当地的临时ID
蜂窝网络提供商必须跟踪移动用户的位置，至少是粗粒度的位置，以便有效地利用有限的无线资源。把一个大区域分隔成 n 个较小的地理区域，例如位置区号(LAC)
，并把广播讯息(包括传呼请求)平均定位于这些较小的区域，可把传呼流量减少至原来讯息数目的$\frac
{1}{n}$倍。如果我们知道他们唯一的ID，通过观察呼叫请求，我们可以知道受害者是否在那个区域。然而，这个ID(IMSI 或 TMSI)是 GSM
PCCH 上唯一可见的标识符，并且电话号码到 IMSI 或 TMSI 的内部系统映射事先不知道。
### C. 暴露身份
TMSI 只有在设备所在的 LAC 内才有意义。为了进行定位测试，我们需要显示 PSTN 电话号码和 GSM PCCH 上可见的 TMSI 之间的映射关系。  
首先定义呼叫启动后候选 TMSIs 的可能集合，在 tmin ≤ t ≤ tmax
定义的时间窗内限制标识符。根据第三部分的初步测量，假设公用电话交换机呼叫完成与传呼请求讯息之间的延迟时间相等，我们根据经验确定总时间为2.50秒，总时间最长为3.42秒，以涵盖与平均值最多3个标准偏差的情况，即总时间正态分布为2.50秒。具体来说，我们将给定时间窗口中可能的
TMSIs 集合定义如下。