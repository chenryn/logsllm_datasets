23
25
27
29
15
13
17
Time (minutes)
(b)
Figure 6. Limited DoS Experiment using Linear Recovery (ouri = 2 and Turi = 5) (a) Attack 1 with 4
attack calls per minute (b) Attack 2 with 10 attack calls per minute.
200 URIs with 1 call per minute
8
7
6
5
4
3
2
1
0
1
3
5
7
9
11
13
15
17
19
21
23
25
27
29
Time (minutes)
Figure 10. Aggregate level detection of Stealth
DoS attack (oagg = 1 and Tagg = 2).
ulations. Lowering the values would allow for stealthier
attacks to be detected, but would have also increased the
false alarm rate.
The attack detection times for the four DoS attacks
types are shown in Table 2. The results in Figures 6, 9
and 10 show that the larger the volume of attack calls,
the shorter the detection time. The one result that might
seem surprising is the stealth attack was detected in less
time than the aggressive attack. This is because the overall
call volume was greater for the particular stealth and ag-
gressive attacks used in this study. The aggressive attack
generated 150 attack calls per minute (three to 50 differ-
ent URIs) while the stealth generated 200 attack calls per
minute (one to 200 different URIs).
Table 2. Detection time for various DoS attacks
Detection Time
Attack Type
4 calls/min Limited DoS
10 calls/min Limited DoS
50 URI Aggressive DoS
4 minutes (URI level)
2 minutes (URI level)
6 minutes (URI level)
200 URI Stealth DoS
8 minutes (aggregate level)
4 minutes (aggregate level)
To evaluate the performance and impact of the differ-
ent recovery algorithms, a limited DoS attack targeting a
low volume URI was used. Table 3 shows the amount of
time required from the end of the attack until the levels
in the sensor dropped below the threshold. Figures 6b, 7,
8 provide a graphical representation of the recovery algo-
rithms operation. As expected, the linear recovery algo-
rithm performance was substantially lower than the other
two. For real world deployments, the increase in sensor
n
Y
l
f
o
e
u
a
V
d
e
t
a
l
u
c
l
a
C
complexity to use the exponential or reset after timeout al-
gorithms is acceptable because of the signiﬁcant increase
in performance. The cost of a poor recovery algorithm is
substantial if the response mechanisms remain activated
much beyond the end of the attack.
Table 3. Recovery time for Limited DoS attack
on a small number of URIs
Attack Volume - Recovery Alg.
4 calls/min - Linear Recovery
10 calls/min - Linear Recovery
10 calls/min - Exponential Recovery
10 calls/min - Reset after Timeout
Recovery Time
3 minutes
17 minutes
6 minutes
3 minutes
To ensure that the detection algorithm works indepen-
dent of the volume of legitimate trafﬁc a received by any
URI, we considered limited attacks targeting two URIs
from different user categories in Table 1. For users with a
high volume of legitimate trafﬁc, the value (cid:22)C(n) in Equa-
tion 1 is large. This impacts the normalization of the dif-
ference between connection attempts and establishments.
The larger the value of (cid:22)C(n), the greater in reduction of
Xn because Xn = (cid:1)n= (cid:22)C(n). Figure 6b shows the im-
pact of this normalization. The peak value of the attack
on the high volume URI is 25% less than the low volume
URI target.
7. Other Deployment Issues
The sensor placement in Figure 1 is only one of several
possibilities. This section examines to impact of deploy-
ing ALAS at other locations in the network.
7.1. ALAS behind the SIP Proxy
Instead of placing the ALAS in front the SIP Proxy, it
is possible to place it in behind the SIP Proxy as shown in
Figure 11. However, by doing so several characteristics of
the trafﬁc seen by the sensor changes. During an attack,
the sensor will not continue to see all incoming calls. The
various response mechanisms activated in the proxy will
inﬂuence the trafﬁc pattern seen by the sensor. It will not
receive notiﬁcation nor be able to detect which calls are
blocked at the proxy without signiﬁcantly modifying the
interaction between the proxy and sensors. The detection
and the recovery algorithms need to be modiﬁed for this
architecture. This is the scope of future work.
7.2. Protection for PSTN Originated Attacks
In a converged network, the Internet is not the only
source of attacks. While more difﬁcult, it is possible to
launch an attack from the PSTN. It becomes more difﬁ-
cult because a large number of individual phones must be
DNS(cid:13)
Server(cid:13)
Web(cid:13)
Server(cid:13)
Application(cid:13)
Layer(cid:13)
Attack(cid:13)
Sensor(cid:13)
Internal(cid:13)
Firewall(cid:13)
Transport(cid:13)
Layer(cid:13)
Attack(cid:13)
Sensor(cid:13)
External(cid:13)
Firewall(cid:13)
SIP(cid:13)
Registrar /(cid:13)
Location(cid:13)
Server(cid:13)
SIP(cid:13)
Redirect(cid:13)
Proxy(cid:13)
Enterprise DMZ(cid:13)
Figure 11. ALAS placed behind the SIP Proxy.
Softphone(cid:13)
IP Phone(cid:13)
PSTN(cid:13)
Media /(cid:13)
Signal(cid:13)
Gateway(cid:13)
Application(cid:13)
Layer(cid:13)
Attack(cid:13)
Sensor(cid:13)
Enterprise(cid:13)
LAN(cid:13)
Authentication(cid:13)
Server(cid:13)
Figure 12. Detecting PSTN Based DoS Attacks
marshaled and the attack must be coordinated between a
large number of individuals. In any case to detect and con-
trol such attacks, another possible deployment location for
an ALAS is in series with the MSG (Figure 12). A sen-
sor placed here would operate almost identically to one
placed behind the SIP Proxy. The trafﬁc patterns would be
consistent because the enforcement mechanism is placed
before the sensor on the network path. The difference be-
tween the two deployment locations is the response mech-
anisms that are utilized. For PSTN based attacks, the
MSG must generate Transfer Controlled (TFC) messages
or Release Busy messages for the targeted E.164 numbers
depending on the severity of the attack [24].
8. Related Work
Detection and protection of DoS attacks has been a pop-
ular topic in recent years. The trend has been to focus on
either protection and/or reduction of the impact of an at-
tack or detection of an attack.
Yau et al [31] developed a scheme to include throttles
in the network routers that use a leaky-bucket approach
to reduce the incoming rate of trafﬁc to targeted servers.
Another approach to countering DoS attacks at the net-
work infrastructure is the use of Pushback and Aggregate
Congestion Control [18, 10, 13].
The work on DoS attacks is also not limited to only IP
based networks. In [4], Burns and Ghosal examine media
stimulated focused overloads in the PSTN. As in an IP
DoS attack, the target of a focused overload is unable to
operate normally.
Other work has been done on reducing the impact of an
attack on the targeted terminals. Both SYN cookies [3]
and SYN cache [17] are extensions to the network proto-
col stack in an attempt to reduce the resource consumption
of each incoming SYN packet.
A third approach to reducing the impact of an attack is
from a quality of service (QoS) point of view. By limiting
the amount of resources each type of trafﬁc can consume,
the extent of a DoS attack can be severely limited. In [11],
Garg and Reddy present a prototype system capable of
enforcing QoS restrictions on various resources including
network bandwidth, protocol state memory buffers and
CPU cycles.
The other category of research has been on quickly and
effectively detecting the presence of an attack. Wang et al
[30] introduced a simplistic, yet powerful, algorithm that
exploits the normal behavior of TCP trafﬁc to detect the
presence of a SYN ﬂood attack. Their algorithm was used
as a basis for the algorithms presented in this paper.
9. Conclusion
This study provided a detailed examination of DoS at-
tacks against IP telephony enabled enterprise networks. It
was shown that a large class of attacks can only be handled
by implementing dedicated sensors in an enterprise net-
work. The operation and implementation of sensors at the
transport and application layers were described in detail.
Each of these sensors exploited a non-parametric cumu-
lative sum algorithm to detect the presence of an attack.
In addition to attack detection, we examined the impact
and performance of three different recovery algorithms. A
quantitative analysis using a simulated enterprise environ-
ment showed that the detection algorithm correctly identi-
ﬁed three different types of DoS attacks and we quantiﬁed
the difference between the different recovery algorithms.
Further work needs to be carried out to understand the im-
pact of the various sensor parameters and the placement
of the sensors. Work is also required to integrate the tech-
niques developed in this paper with sensors to detect DoS
attacks using malicious media ﬂows.
Acknowledgment
We would like to thank the anonymous reviewers and
Radha Poovendran for their comments that helped us in
preparing the ﬁnal version of the paper.
References
[1] M. Basseville and I. V. Nikiforov. Detection of Abrupt
Changes: Theory and Application. Prentice Hall, 1993.
[2] B. E. Brodsky and B. S. Darkhovsky. Nonparametric
Methods in Changepoint Problems. Kluwer Academic
Publishers, 1993.
[3] Bronzesoft.org. SYN cookies ﬁrewall. World Wide Web,
http://www.bronzesoft.org/projects/
scfw, 2002.
[4] J. Burns and D. Ghosal. Design and analysis of a new al-
gorithm for automatic detection and control of media stim-
ulated focused overloads. In Proceedings of International
Teletrafﬁc Congress, Edinburgh, June 1997.
[5] C. C. Center. Trends in denial of service attack tech-
nology. World Wide Web, http://www.cert.org/
archive/pdf/DoS_trends.pdf, Oct. 2001.
[6] W. Cheswick and S. Bellovin. Firewalls and Internet Se-
curity. Addison Wesley Longman, Inc., New York, NY,
1st edition, 1994.
[7] K. Claffy, G. Polyzos, and H. Braun. Application of sam-
pling methodologies to network trafﬁc characterization.
In Proceedings of ACM SIGCOMM, San Francisco, Sept.
1993.
[8] R. Daniel and M. Mealling. RFC 2168: Resolution of Uni-
form Resource Identiﬁers using the Domain Name Sys-
tem, June 1997.
[9] C. Estan and G. Varghese. New directions in trafﬁc mea-
In Proceedings of ACM SIG-
surement and accounting.
COMM, Pittsburg, Aug. 2002.
[10] S. Floyd and V. Jacobson. Random Early Detection Gate-
ways for Congestion Avoidance. IEEE/ACM Transactions
on Networking, 1(4):397–413, Aug. 1993.
[11] A. Garg and A. Reddy. Mitigation of dos attacks through
qos regulation.
In Proceedings of IEEE International
Workshop on Quality of Service (IWQoS), Miami Beach,
May 2002.
[12] I.-T. R. H.323. Visual telephone systems and equipment
for local area networks which provide a non-guaranteed
quality of service, May 1996.
[13] J. Ioannidis and S. Bellovin.
Implementing pushback:
Router-based defense against DDoS attacks. In Proceed-
ings of Network and Distributed System Security Sympo-
sium, San Diego, Feb. 2002.
[14] J. Jedwab, P. Phall, and B. Pinna. Trafﬁc estimation for the
largest sources on a network, using packet sampling with
limited storage. Technical Report 35, Hewlett Packard
Labs, Mar. 1992.
[15] A. Johnston, S. Donovan, R. Sparks, C. Cunningham,
D. Willis, J. Rosenberg, K. Summers, and H. Schulzrinne.
Internet draft: SIP call ﬂow examples, Apr. 2002. Work in
Progress.
[16] J. Kohl and C. Neuman. RFC 1510: The Kerberos Net-
work Authentication Service (V5), Sept. 1993.
[17] J. Lemon. Resisting SYN ﬂood DoS attacks with a SYN
In Proceedings of USENIX BSDCon 2002, San
cache.
Francisco, Feb. 2002.
[18] R. Mahajan, S. Bellovin, S. Floyd, J. Vern, and P. Scott.
Controlling high bandwidth aggregates in the network.
Technical Report 1, University of California, Berkeley -
International Computer Science Institute, Feb. 2001.
[19] J. Mirkovic, J. Martin, and P. Reiher. A taxonomy of
DDoS attacks and DDoS defense mechanisms. Technical
Report 18, University of California, Los Angeles - Com-
puter Science Department, 2002.
[20] B. Reynolds and D. Ghosal. STEM: Secure Telphony
IEEE Communications Magazine,
Enabled Middlebox.
40(10), Oct. 2002.
[21] C. Rigney, S. Willens, A. Rubens, and W. Simpson. RFC
2865: Remote Authentication Dial in User Service (RA-
DIUS), June 2000.
[22] J. Rosenberg and H. Schulzrinne. RFC 2871: A Frame-
work for Telephony Routing over IP, June 2000. Status:
Informational.
[23] J. Rosenberg, H. Schulzrinne, G. Camarillo, A. Johnston,
J. Peterson, R. Sparks, M. Handley, and E. Schooler. In-
ternet draft: SIP: Session initiation protocol, Feb. 2002.
Work in Progress.
[24] T. Russell. Signaling System 7. McGraw-Hill, New York,
NY, 3rd edition, 2000.
[25] C. Schuba, I. Krsul, M. Kuhn, E. Spafford, A. Sundaram,
and D. Zamboni. Analysis of a denial of service attack
on TCP.
In Proceedings of the 1997 IEEE Symposium
on Security and Privacy, pages 208–223. IEEE Computer
Society, IEEE Computer Society Press, May 1997.
[26] H. Schulzrinne and J. Rosenberg. Internet Telephony: Ar-
chitecture and Protocols - an IETF Perspective. Computer
Networks, 31(3):237–255, 1999.
[27] R. Stevens. TCP/IP Illustrated Volume 1: The Protocols,
volume 1. Addison Wesley Longman, Inc., Reading, MS,
1st edition, 1994.
[28] Telecost.
Enterprise
call durations distributions.
World Wide Web, http://www.telecost.co.uk/
pages/OnCallDurations.htm, 2002.
[29] K. Thompson, G. J. Miller, and R. Wilder. Wide-area in-
ternet trafﬁc patterns and characteristics. IEEE Network,
11(6), Dec. 1997.
[30] H. Wang, D. Zhang, and K. Shin. Detecting SYN ﬂooding
In Proceedings of IEEE INFOCOM 2002, New
attacks.
York, June 2002.
[31] D. Yau, J. Lui, and F. Liang. Defending against distributed
denial-of-service attacks with max-min fair server-centric
router throttles.
In Proceedings of IEEE International
Workshop on Quality of Service (IWQoS), Miami Beach,
May 2002.