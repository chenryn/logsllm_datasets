User: How to use powerful awk and sed commands for log parsing and analysis?
Assistant: awk and sed are common text processing commands on Unix and Linux systems. They can be used for log parsing and analysis. The following are some examples of using them for log parsing and analysis: 1. Awk calculates PV and UV: Using the awk command, PV (number of page views) and UV (number of unique visitors) can be calculated. For example, if we have the following log files: ``` 192.168.0.1 - - [01/Apr/2021:11:23:45 +0800] "GET /index.html HTTP/1.1" 200 1234 192.168.0.2 - - [ 01/Apr/2021:11:23:50 +0800] "GET /about.html HTTP/1.1" 200 5678 192.168.0.1 - - [01/Apr/2021:11:24:00 +0800] "GET /index .html HTTP/1.1" 200 1234 192.168.0.3 - - [01/Apr/2021:11:24:30 +0800] "GET /contact.html HTTP/1.1" 200 91011 ``` We can use the following awk command to calculate PV and UV: ``` awk '{ pv[$7]++; uv[$1]++; } END { print "PV:", length(pv), "UV:", length(uv); }' logfile ``` The output will show: ``` PV: 3 UV: 3 ``` 2. sed intercept log content: Use sed command to intercept some fields in the log file. For example, if we have the following log files: ``` 192.168.0.1 - - [01/Apr/2021:11:23:45 +0800] "GET /index.html HTTP/1.1" 200 1234 192.168.0.2 - - [ 01/Apr/2021:11:23:50 +0800] "GET /about.html HTTP/1.1" 200 5678 192.168.0.1 - - [01/Apr/2021:11:24:00 +0800] "GET /index .html HTTP/1.1" 200 1234 192.168.0.3 - - [01/Apr/2021:11:24:30 +0800] "GET /contact.html HTTP/1.1" 200 91011 ``` We can use the following sed command to intercept IP address: ``` sed -E 's/^([0-9\.]+).*/\1/' logfile ``` The output will be: ``` 192.168.0.1 192.168.0.2 192.168. 0.1 192.168.0.3 ``` 3. Awk calculates the log response time: You can use awk to calculate the log response time. For example, if we have the following log files: ``` 192.168.0.1 - - [01/Apr/2021:11:23:45 +0800] "GET /index.html HTTP/1.1" 200 1234 192.168.0.2 - - [ 01/Apr/2021:11:23:50 +0800] "GET /about.html HTTP/1.1" 200 5678 192.168.0.1 - - [01/Apr/2021:11:24:00 +0800] "GET /index .html HTTP/1.1" 200 1234 192.168.0.3 - - [01/Apr/2021:11:24:30 +0800] "GET /contact.html HTTP/1.1" 200 91011 ``` We can use the following awk command to calculate Average response time: ``` awk '{ sum += $NF; } END { print "Average response time:", sum/NR "ms"; }' logfile ``` The output will be: ``` Average response time: 24831.2ms ``` These examples just demonstrate the usage of awk and sed commands, we can also use them for more log parsing and analysis as needed.