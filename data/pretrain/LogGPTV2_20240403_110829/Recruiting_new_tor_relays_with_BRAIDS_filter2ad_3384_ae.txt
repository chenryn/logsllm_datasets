on collecting payments for service. While the latter failed,
the former is still in operation and provides a one-hop anony-
mous proxy based system for paying clients.
Franz et al. [22] introduce an incentive technique for mix-
networks that divides electronic payments for each mix, but
it is ineﬃcient since each hop requires communication be-
tween the mix and mix provider. Figueiredo et al.
[21] also
introduce an electronic mix-net anonymity system, but it
lacks accountability and robustness. Reiter et al.
[41] build
upon coin ripping [29] to develop a strict fair exchange pro-
tocol for mix-nets. However, they require each message re-
cipient to participate in the protocol which does not align
with Tor’s desire to support arbitrary destinations.
Golle et al.
[25] discuss incentives for sharing in peer-to-
peer networks using a game theoretic model. They propose
a micro-payment or “points” system, where uploads are re-
warded and downloads are penalized, and show that equilib-
rium is reached by balancing uploads and downloads. Bit-
Torrent [11] uses “tit-for-tat” mechanisms to trade pieces of
large ﬁles among peers. Peers upload and download pieces
cooperatively and preferentially from other peers in an at-
tempt to maximize local download eﬃciency. The Scrivener
system [36] uses a credit/debit approach to maintain local
histories of other nodes’ cooperative behavior which is used
to enforce fair bandwidth sharing. Similarly, reputation sys-
tems [12, 30, 57, 58] use interaction histories to develop trust
levels for other peers which aids in future decisions to coop-
erate while incentivizing trustworthy behavior. Reputation
systems are incompatible with Tor since not all relays are
able to bind an interaction to a client.
Acquisti et al.
[2] discuss incentives to participate in
anonymous systems while developing an economic model
and arguing a usage fee as an economic incentive mecha-
nism. Cost then is a security objective since it aﬀects the
number of users and therefore the anonymity provided [5].
7. CONCLUSION
In this paper we introduced BRAIDS as a set of prac-
tical mechanisms that encourages users to run Tor relays.
We employ completely client-anonymous relay-speciﬁc tick-
ets that allow Tor clients and relays to achieve increased
performance while preventing the double-spending problem.
Relays diﬀerentiate service into three classes, allowing them
to prioritize traﬃc and mitigate the negative eﬀect ﬁle shar-
ing users have on Tor, without signiﬁcantly reducing band-
width utilization for ﬁle sharing clients.
There are several issues that need further investigation.
Our uniform ticket validity intervals introduce a trade-oﬀ
between fast ticket turn-around times and oﬄine relays los-
ing their tickets. The trade-oﬀ is due to our imposed ticket
tax which is required to bound the bandwidth load on the
bank. Tickets you earn will not be usable for 2 days in our
current design, and you will lose half of your tickets if you
are oﬄine for a day and unable to exchange them.
BRAIDS would beneﬁt from a more robust ticket distribu-
tion scheme, since an adversary controlling a fraction of IP
addresses in Tor can steal a similar fraction of tickets in each
spending interval, and malicious agents receive a greater re-
ward for stealing tickets than behaving honestly. Further,
auditing ticket agents would allow us to detect cheaters.
Future work may also consider an exploration of client
strategies to enhance our model of client spending habits
and improve our anonymity analysis. Users must be aware
of their prioritized spending habits since spending a large
number of tickets (more than a few hundred MB) will re-
duce their anonymity and lead to the risk of intersection
attacks as in the gold star scheme. Finally, distributing the
bank’s functionality among users, or a small set of trusted
nodes, will reduce bandwidth and CPU limitations, drasti-
cally improving anonymity.
Acknowledgments We thank our shepherd, Roger Dingle-
dine, and our anonymous reviewers for many helpful com-
ments. We thank Eugene Vasserman, Eric Chan-Tin, Max
Schuchard, Abedelaziz Mohaisen, Paul Syverson, and Pra-
teek Mittal for their helpful discussions, and Zi Lin for his
assistance with the PBS implementation. This research was
supported by NSF grants CNS-0546162 and CNS-0917154.
8. REFERENCES
[1] M. Abe and T. Okamoto. Provably secure partially blind
signatures. In CRYPTO ’00: Proceedings of the 20th
International Cryptology Conference on Advances in
Cryptology, pages 271–286, 2000.
[2] A. Acquisti, R. Dingledine, and P. Syverson. On the economics
of anonymity. In Proceedings of the 7th International
Conference on Financial Cryptography, 2003.
[3] E. Androulaki, M. Raykova, S. Srivatsan, A. Stavrou, and S. M.
Bellovin. PAR: Payment for anonymous routing. In PETS ’08:
Proceedings of the 8th International Symposium on Privacy
Enhancing Technologies, pages 219–236, 2008.
[4] The anonymizer. http://anonymizer.com/.
[5] A. Back, U. M¨oller, and A. Stiglic. Traﬃc analysis attacks and
trade-oﬀs in anonymity providing systems. In IHW ’01:
Proceedings of the 4th International Workshop on
Information Hiding, pages 245–257, 2001.
[6] The BitTorrent Protocol Speciﬁcation.
http://www.bittorrent.org/beps/bep_0003.html. January 2010.
[7] P. Boucher, A. Shostack, and I. Goldberg. Freedom system 2.0
architecture. White paper, Zero-Knowledge Systems Inc., 2000.
[8] D. Chaum. Blind signatures for untraceable payments. In
CRYPTO ’82: Proceedings of Advances in Cryptology,
volume 82, pages 199–203, 1983.
[9] D. Chaum, A. Fiat, and M. Naor. Untraceable electronic cash.
In CRYPTO ’88: Proceedings of Advances in Cryptology,
pages 319–327, 1990.
[10] Y. Chen, R. Sion, and B. Carbunar. XPay: practical anonymous
payments for Tor routing and other networked services. In
WPES ’09: Proceedings of the 8th ACM Workshop on
Privacy in the Electronic Society, pages 41–50, 2009.
327[11] B. Cohen. Incentives build robustness in BitTorrent. In
Workshop on Economics of P2P Systems, volume 6, 2003.
[12] E. Damiani, D. C. di Vimercati, S. Paraboschi, P. Samarati,
and F. Violante. A reputation-based approach for choosing
reliable resources in peer-to-peer networks. In CCS ’02:
Proceedings of the 9th ACM Conference on Computer and
Communications Security, pages 207–216, 2002.
[13] C. Diaz, S. Seys, J. Claessens, and B. Preneel. Towards
measuring anonymity. In Privacy Enhancing Technologies,
2002.
Conference on Computer and Communications Security,
pages 590–599, 2009.
[35] S. J. Murdoch and G. Danezis. Low-cost traﬃc analysis of Tor.
In SP ’05: Proceedings of the 2005 IEEE Symposium on
Security and Privacy, pages 183–195, 2005.
[36] A. Nandi, T.-W. J. Ngan, A. Singh, P. Druschel, and D. S.
Wallach. Scrivener: providing incentives in cooperative content
distribution systems. In Middleware’05: Proceedings of the
ACM/IFIP/USENIX 2005 International Conference on
Middleware, pages 270–291, 2005.
[14] R. Dingledine, N. Mathewson, and P. Syverson. Tor: the
[37] T. Narten and R. Draves. Privacy extensions for stateless
second-generation onion router. In SSYM’04: Proceedings of
the 13th conference on USENIX Security Symposium, pages
21–21, 2004.
[15] J. R. Douceur. The sybil attack. In IPTPS ’01: Revised
Papers from the First International Workshop on
Peer-to-Peer Systems, pages 251–260, 2002.
[16] C. Dovrolis and P. Ramanathan. A case for relative
diﬀerentiated services and the proportional diﬀerentiation
model. IEEE network, 13(5):26–34, 1999.
[17] C. Dovrolis and P. Ramanathann. Proportional diﬀerentiated
services, part II: loss rate diﬀerentiation and packet dropping.
In IWQOS’00: Eighth International Workshop on Quality of
Service, pages 53–61, 2000.
[18] C. Dovrolis, D. Stiliadis, and P. Ramanathan. Proportional
diﬀerentiated services: delay diﬀerentiation and packet
scheduling. In SIGCOMM ’99: Proceedings of the Conference
on Applications, Technologies, Architectures, and Protocols
for Computer Communication, pages 109–120, 1999.
[19] C. Dovrolis, D. Stiliadis, and P. Ramanathan. Proportional
diﬀerentiated services: delay diﬀerentiation and packet
scheduling. IEEE/ACM Transactions on Networking,
10(1):12–26, 2002.
[20] N. Evans, R. Dingledine, and C. Grothoﬀ. A practical
congestion attack on Tor using long paths. In 18th USENIX
Security Symposium, pages 33–50, 2009.
[21] D. R. Figueiredo, J. K. Shapiro, and D. Towsley. Using
payments to promote cooperation in anonymity protocols.
Technical Report 03-31, University of Massachusetts, 2003.
[22] E. Franz, A. Jerichow, and G. Wicke. A payment scheme for
mixes providing anonymity. In TREC ’98: Proceedings of the
International IFIP/GI Conference on Trends in Distributed
Systems for Electronic Commerce, pages 94–108, 1998.
[23] The GMP Library. http://gmplib.org/.
[24] D. Goldschlag, M. Reed, and P. Syverson. Onion routing.
Communications of the ACM, 42(2):39–41, 1999.
[25] P. Golle, K. Leyton-Brown, I. Mironov, and M. Lillibridge.
Incentives for sharing in peer-to-peer networks. In
WELCOM’01: Proceedings of the Second International
Workshop on Electronic Commerce, pages 75–87, 2001.
address autoconﬁguration in ipv6.
http://tools.ietf.org/html//rfc3041, 2001.
[38] T.-W. J. Ngan, R. Dingledine, and D. S. Wallach. Building
incentives into Tor. In FC’10: The Proceedings of Financial
Cryptography, 2010.
[39] I. Osipkov, E. Y. Vasserman, N. Hopper, and Y. Kim.
Combating double-spending using cooperative P2P systems. In
ICDCS ’07: Proceedings of the 27th International Conference
on Distributed Computing Systems, page 41, 2007.
[40] J. Reardon and I. Goldberg. Improving Tor using a
TCP-over-DTLS tunnel. In Proceedings of the 18th USENIX
Security Symposium, 2009.
[41] M. Reiter, X. Wang, and M. Wright. Building reliable mix
networks with fair exchange. In ACNS’05: The Proceedings of
the Third International Conference on Applied Cryptography
and Network Security, pages 378–392, 2005.
[42] M. K. Reiter and A. D. Rubin. Crowds: Anonymity for web
transactions. ACM Transactions on Information and System
Security, 1(1):66–92, 1998.
[43] R. L. Rivest and A. Shamir. PayWord and MicroMint: Two
simple micropayment schemes. In Proceedings of the
International Workshop on Security Protocols, pages 69–87,
1997.
[44] A. Serjantov and G. Danezis. Towards an information theoretic
metric for anonymity. In Privacy Enhancing Technologies,
pages 41–53, 2002.
[45] C. E. Shannon. A mathematical theory of communication.
SIGMOBILE Mobile Computing and Communications
Review, 5(1):3–55, 2001.
[46] R. Snader and N. Borisov. A tune-up for Tor: Improving
security and performance in the Tor network. In NDSS’08:
Proceedings of the Network and Distributed Security
Symposium, 2008.
[47] C. Tang and I. Goldberg. An improved algorithm for Tor
circuit scheduling. Technical Report CACR 2010-06, University
of Waterloo, 2010.
[48] Tor partially blocked in China. Tor Project. https:
//blog.torproject.org/blog/tor-partially-blocked-china.
October 2009.
[26] G. Hardin. The tragedy of the commons. Science,
[49] Tor Directory Protocol, Version 3. Tor Project.
162(3859):1243–1248, December 1968.
[27] F. Hernandez-Campos, K. Jeﬀay, and F. Smith. Tracking the
evolution of web traﬃc: 1995-2003. In MASCOTS 2003: The
11th IEEE/ACM International Symposium on Modeling,
Analysis, and Simulation of Computer Telecommunications
Systems, pages 16–25, 2003.
[28] N. Hopper, E. Y. Vasserman, and E. Chan-Tin. How much
anonymity does network latency leak? In CCS ’07:
Proceedings of the 14th ACM Conference on Computer and
Communications Security, pages 82–91, 2007.
[29] M. Jakobsson. Ripping coins for a fair exchange. In
EUROCRYPT, pages 220–230, 1995.
[30] S. D. Kamvar, M. T. Schlosser, and H. Garcia-Molina. The
Eigentrust algorithm for reputation management in P2P
networks. In WWW’03: Proceedings of the 12th International
Conference on World Wide Web, pages 640–651, 2003.
[31] K. Loesing. Measuring the Tor network: Evaluation of client
requests to directories. Technical report, Tor Project, 2009.
[32] D. Mccoy, K. Bauer, D. Grunwald, T. Kohno, and D. Sicker.
Shining light in dark places: Understanding the Tor network. In
PETS ’08: Proceedings of the 8th International Symposium
on Privacy Enhancing Technologies, pages 63–76, 2008.
[33] J. McLachlan and N. Hopper. Don’t clog the queue! Circuit
clogging and mitigation in P2P anonymity schemes. In FC’08:
The Proceedings of the 12th International Conference on
Financial Cryptography and Data Security, pages 31–46, 2008.
[34] J. McLachlan, A. Tran, N. Hopper, and Y. Kim. Scalable onion
routing with Torsk. In CCS ’09: Proceedings of the 16th ACM
http://gitweb.torproject.org/tor.git?a=blob_plain;hb=HEAD;
f=doc/spec/dir-spec.txt. January 2010.
[50] Relay Flags. Tor Project. http://git.torproject.org/checkout/
metrics/master/out/dirarch/relayflags.csv. November 2009.
[51] Computing Bandwidth Adjustments. Tor Project. http:
//gitweb.torproject.org/tor.git?a=blob_plain;hb=HEAD;f=doc/
spec/proposals/161-computing-bandwidth-adjustments.txt.
November 2009.
[52] Tor Path Speciﬁcation. Tor Project. http://gitweb.torproject.
org/tor.git?a=blob_plain;hb=HEAD;f=doc/spec/path-spec.txt.
January 2010.
[53] The Tor Project. https://www.torproject.org/.
[54] Y. Tsiounis. Eﬃcient electronic cash: new notions and
techniques. College of Computer Science, 1997.
[55] E. Vasserman, R. Jansen, J. Tyra, N. Hopper, and Y. Kim.
Membership-concealing overlay networks. In CCS’09:
Proceedings of the 16th ACM Conference on Computer and
Communications Security, pages 390–399, 2009.
[56] C. Viecco. UDP-OR: A fair onion transport design. In
HOTPETS’08: Proceedings of Hot Topics in Privacy
Enhancing Technologies, 2008.
[57] L. Xiong and L. Liu. PeerTrust: Supporting reputation-based
trust for peer-to-peer electronic communities. IEEE
Transactions on Knowledge and Data Engineering,
16:843–857, 2004.
[58] R. Zhou and K. Hwang. PowerTrust: A robust and scalable
reputation system for trusted peer-to-peer computing. IEEE
Transactions on Parallel and Distributed Systems,
18(4):460–473, 2007.
328