title:StegoNet: Turn Deep Neural Network into a Stegomalware
author:Tao Liu and
Zihao Liu and
Qi Liu and
Wujie Wen and
Wenyao Xu and
Ming Li
STEGONET: TURN DEEP NEURAL NETWORK
INTO A STEGOMALWARE
Tao Liu1, Zihao Liu2, Qi Liu3, Wujie Wen3, Wenyao Xu4, Ming Li5
1Lawrence Technological University, 2Florida International University, 3Lehigh University
4University at Buffalo, 5University of Arizona
Annual Computer Security Applications Conference 2020, 12/11/2020 
Agenda
Motivation
• Neural Network and Emerging Security Concerns
Threat Model
• Definition and Attack Routine
Design Spotlights
• Payload Injection in DNN Parameters
• DNN Logits Trigger
Security Analysis
Summary
A Great Success of Neural Nets
Computer Vision
Language Processing
Neural Networks
Knowledge 
Reasoning
Robotics
Neural Nets Based ML System
D1
A1
D
A
DNN Model
D1
A
1
D
C1
B1
C
B
Convolution
A
Data
C1
B
1
C
D
A
1
1
A
D
C
1
C
B
1
B
B
Pooling Softmax
Convolution
Computing Framework
Pooling Activation
Driver
SDK
Software
Softmax
API
CPU
Computing Substrate
GPU
FPGA
Hardware
ASIC
Scalable NN based ML System
NASA 2012
Google
Security Concerns on Neural Network
Neural Nets Based ML System
[Mirjalili et al., 2017] 
Female face -> Male face
[Evtimov et al., 2017] 
Stop sign -> Speed Limit
Hardware
[Xiao et al., 2017] 
Security Concerns
• Adversarial Attack
• Privacy Leakage
• Neural Trojan
New Attack Vector: Plug-n-play DNN Models
Machine Learning Model as a Service (MLMaaS)
DNN Model
DNN Vendors
App Developers
Intelligent 
Apps
End users
• Users prefer to consume the Pre-trained Model;
• Model Zoo
• Caffe Model Zoo
• TensorFlow
......
• CNTK
• Keras
• MXNet
Add Malicious Module
New Attack Vector: Complexity of DNN Models
Deeper and Larger
Natural-Obfuscation
152-layer
An unprecedented opportunity to mix 
the data and code in DNN models!
19-layer
552 MB
“Stego-Net”
8-layer
240 MB
Threat Model
Untrusted DNN service provider
• Create the malicious DNN model (StegoNet)
• Disguised as normal DNN service
Non-ML expert
• Consume DNN services from the third-party 
• Don’t understand the end-to-end DNN process
Stego-Net vs Stego-Malware
Stego-Malware
Stego-Net
Malware Image
S
t
e
g
o
-
M
a
w
a
r
e
l
Internet
Malicious 
Code Pixels
Wrapper App
(e.g., Image Analyzer)
Extract & Execute
• Small Cover Image
• Visual Quality
• Certain Event (E.g., Port listening)
• Scalable, Complex DNN Model
• DNN Accuracy
• Uncertain Event (Cyber-Physical Space, Camera, Mic, …)
Attack Design Constraint
1. Accuracy and Scalability
• Modify DNN parameter -> Accuracy degradation
• DNN structure/model size varies 
• Limited embedding space on compressed DNN models
2. Trigger Control and Input Variation
• Can’t use direct input as trigger
• Variations: Angle, Brightness, Noise, …
• Can’t use direct output as trigger
• High false-positive rate on normal inputs 
(trigger rate = 1/N-class)
Payload Injection in DNN Parameters
LSB doesn’t work on small-scaled DNNs
Payload
0000
Index Permutation
{B1, A2, ……}
A1
0100
Fix in 
Training
A2
Payload
B1
B2
B3
e
u
l
a
v
h
c
t
a
m
010000
w11
w12
Fixed
w21 w22 w23
001011
010000 ≈ w12(10.010000)
001011 ≈ w21(00.001010)
1. Perfect-match
2. Close-match & Modify
(a) Resilience training.
(b) Value-mapping.
+/0
-/1
Payload
n
g
i
s
h
c
t
a
m
-/1
+/0 +/0
+ - + +
Fix Sign + 
Random Value
(c) Sign-mapping.
DNN Logits Trigger
Triggering event
x2
xn
w2
……
wn
x1
w1
weighting – ∑wx
logits
Payloads
{logitsk} = {reck}
{reck}
Logits Record
p1
0.5
0.2
p2
0.3
p3
Rank trigger – input variation
Record
Present
p1
p1
p3
p3
p2
p2
Logits Rank
(matched)
Present
0.55
0.13
0.32
Logits
(unmatched)
Rank trigger.
Deployment lifecycle of Mal-DNN
Inactive
Malicious 
Payloads
Inactive
Linkage 
Trigger
Inactive
Malicious 
Payloads
Active
Linkage 
Trigger
Active
Malicious 
Payloads
Active
Linkage 
Trigger
t
n
e
v
E
g
n
i
r
e
g
g
i
r
T
Creation
Deserialization
Execution
Code Execution
Dynamic Exec + Shell Script (Payload)
Attack Exploration 
0. Triggered
1. Data Destruction
2. Downloader
3. DoS
Nvidia Jetson TX2
Laboratory configuration
Camera
(a) Mal-DNN captures benign input and trigger event from physical-world.
k
n
a
R
/
s
t
i
g
o
L
(b) Input variations (example on angle) and augmented strong variations.
Physical-world configuration
Attack Evaluation - Evasiveness
LSB
Resilience Training
Boundary: fix 10~12% of total parameters
Attack Evaluation - Evasiveness
Value Mapping
Sign Mapping
Attack Evaluation - Evasiveness
DETECTION RATE REPORTED ON METADEFENDER
Attack Evaluation – Reliability 
Injection Reliability - Payload bit-flipping rate after fine-tuning
• Output Only, Weak, Common
• Fully-connects, Moderate, Less
• Full-net, Strongest, Rare
AlexNet
Sign Mapping
Value Mapping
Resilience Training
LSB
Attack Evaluation – Reliability 
Trigger Reliability
• Angle, Brightness, Rotation, Noise
Summary
• Our works reveals a new type of DNN based malware, namely Stego-Net, by employing DNN 
model as a novel payload injection channel
• New Attack surfaces: Plug-n-play DNN model and Model complexity
• Compare to the traditional Stegomalware, Stego-Net shows unique considerations on the DNN 
model scalability, complexity and cyber-physical scenario
• DNN-oriented attack approaches: Resilience Training, Value-mapping, Sign- mapping, and 
DNN logits rank based trigger 
• Existing Antimalware and Steganalysis tools are less efficient to defend the Stego-Net
• Mitigation techniques shall be revisited by synthetically considering the Data, Algorithm, 
Software and Hardware in DNNs
Q&A
BK1: Mitigation Directions
Adversary targets different 
vulnerabilities on multiple components
C
1
C
B
1
B
Model Sanitization
D
A
1
1
A
D
D1
C1
Model Parameters (Storage)
D1
B1
C1
DNN Model
A
1
B
1
D
C
D
C
B
Convolution
A
B
Pooling Softmax
A1
A
Convolution
Computing Framework
ML Algorithms
Pooling Activation
Driver
SDK
Softmax
API
CPU
Computing Substrate
Software/Hardware
GPU
FPGA
ASIC
Static
Dynamic