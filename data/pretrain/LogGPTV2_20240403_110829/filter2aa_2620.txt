d
f h
Lord of the Bing
Taking Back Search Engine Hacking From Google and Bing
Taking Back Search Engine Hacking From Google and Bing 
30 July 2010
Presented by: 
Presented by: 
Francis Brown and Rob Ragan
Stach & Liu, LLC
www.stachliu.com
A
d
Agenda
O V E R V I E W
• Introduction
• Advanced Attacks
• Google/Bing Hacking
Google/Bing Hacking
• Other OSINT Attack Techniques
• Advanced Defenses
• Advanced Defenses
• Future Directions
2
G
l
Goals
D E S I R E D  O U T C O M E
• To understand Google Hacking
• Attacks and defenses
• Advanced tools and techniques
• To think differently about exposures 
caused by publicly available sources 
• To blow your mind!
3
Introduction/
B
k
d
Background
G E T T I N G  U P  T O  S P E E D
4
O
 S
 I t lli
Open Source Intelligence
S E A R C H I N G  P U B L I C  S O U R C E S
OSINT – is a form of intelligence 
OSINT
is a form of intelligence 
collection management that involves 
finding, selecting, and acquiring 
i f
ti
 f
bli l  
il bl
information from publicly available
sources and analyzing it to produce 
actionable intelligence. 
5
Q i k Hi t
Quick History
G O O G L E  H A C K I N G  R E C A P
Dates
Event
2004
Google Hacking Database  (GHDB) begins
g
g
(
)
g
May 2004
Foundstone SiteDigger v1 released
2005
Google Hacking v1 released by Johnny Long
J
2005
F
d t
Sit Di
2
l
d
Jan. 2005
Foundstone SiteDigger v2 released
Feb. 13, 2005
Google Hack Honeypot first release
Jan. 10, 2005
MSNPawn v1.0 released
Dec. 5, 2006
Google stops issuing Google SOAP API keys
…
…
6
Q i k Hi t
Quick History
G O O G L E  H A C K I N G  R E C A P
Dates
Event
Mar. 2007
Bing disables inurl: link: and linkdomain:
g
Nov. 2, 2007
Google Hacking v2 released
Mar. 2008
cDc Goolag ‐ gui tool released
J
3 2009
Bi
li
June 3, 2009
Bing goes online
Sept. 7, 2009
Google shuts down SOAP Search API
Nov. 2009
Binging tool released
Dec. 1, 2009
FoundStone SiteDigger v 3.0 released
2010
Googlag.org disappears
7
Th
 A
Threat Areas
W H A T   Y O U   S H O U L D   K N O W
8
G
l /Bi
 H
ki
Google/Bing Hacking
S E A R C H  E N G I N E  A T T A C K S
• Our favorites are Google and Bing
• Crawl and Index
• Crawl and Index
• Cache and RSS are forever
• Query modifiers
• site:target.com
• related:target.com
• filetype:xls
yp
• ip:69.63.184.142
9
Att
k T
t
Attack Targets
G O O G L E  H A C K I N G  D A T A B A S E
• Advisories and Vulnerabilities (215)
• Error Messages (58)
• Pages containing network or 
vulnerability data (59)
Error Messages (58)
• Files containing juicy info (230)
• Files containing passwords (135)
• Files containing usernames (15)
y
• Sensitive Directories (61)
• Sensitive Online Shopping Info (9)
• Various Online Devices (201)
• Files containing usernames (15)
• Footholds (21)
• Pages containing login portals (232)
Various Online Devices (201)
• Vulnerable Files (57)
• Vulnerable Servers (48)
• Web Server Detection (72)
• Web Server Detection (72)
10
Att
k T
t
Attack Targets
G O O G L E  H A C K I N G  D A T A B A S E
Examples
E
 M
Error Messages
• filetype:asp + "[ODBC SQL“
• "Warning: mysql_query()" "invalid query“
Files containing passwords
• inurl:passlist.txt
11
G
l  H
ki
 T
lkit
Google Hacking Toolkit
S T A T E   O F   T H E   A R T
• SiteDigger v3.0
• Uses Google AJAX API
Uses Google AJAX API
• Not blocked by Google
• But restricted to 64 results/query
Bi
i
• Binging
• Uses Microsoft Bing search engine
• Limited domain/ip profiling utils
• Gooscan, Goolag
• Work still, but get blocked by Google bot detection
• Download sites no longer around 
12
Download sites no longer around 
G
l  H
ki
 T
lkit
Google Hacking Toolkit
F O U N D S T O N E  S I T E D I G G E R
13
G
l  H
ki
 T
lkit
Google Hacking Toolkit
B I N G I N G
14
DEMO
N E W  G O O G L E  H A C K I N G  T O O L S
DEMO
15
N
 T
lkit
New Toolkit
S T A C H  &  L I U  T O O L S
GoogleDiggity
• Uses Google AJAX API
Uses Google AJAX API
• Not blocked by Google bot detection
• Can Leverage 
BingDiggity
• Company/Webapp Profiling
E
 URL  IP
l h
• Enumerate: URLs, IP-to-virtual hosts, etc.
• Bing Hacking Database (BHDB)
• Regexs in Bing format
16
N
 T
lkit
New Toolkit
G O O G L E D I G G I T Y
17
N
 T
lkit
New Toolkit
B I N G D I G G I T Y
18
D f
Defenses
G O O G L E / B I N G H A C K I N G  D E F E N S E S
/
• “Google Hack yourself” organization
• Employ tools and techniques used by hackers
p y
q
y
• Policy and Legal Restrictions
• Regularly update your robots txt
• Regularly update your robots.txt
• Data Loss Prevention/Extrusion Prevention Systems
• Free Tools: OpenDLP, Senf
• Social Sentry
• Service to monitor employee FaceBook and Twitter for $2-$8 per employee 
(MySpace, YouTube, and LinkedIn support by summer)
19
y p
pp
y
G
l  A
 E
l
i
Google Apps Explosion
S O  M A N Y A P P L I C A T I O N S T O  A B U S E
20
G
l  Ph
B
k
Google PhoneBook
S P E A R  P H I S H I N G
21
G
l  C d  S
h
Google Code Search
V U L N S  I N  O P E N  S O U R C E  C O D E
• Regex search for vulnerabilities in public code
• Example: SQL Injection in ASP querystring
Example: SQL Injection in ASP querystring
• select.*from.*request\.QUERYSTRING
22
DEMO
G O O G L E  C O D E  S E A R C H  H A C K I N G
DEMO
23
SHODAN
SHODAN
H A C K E R  S E A R C H  E N G I N E 
SHODAN Computer Search Engine 
S
d 
b
 h  I
 f
 HTTP 
• Scans and probes the Internet for open HTTP ports 
and indexes the headers returned in the response
• Profile a target without directly probing their systems
Profile a target without directly probing their systems
• Discover specific network appliances
• Easily find vulnerable systems!
y
y
24
Target NAS Appliances
Target NAS Appliances
25
Target SCADA
Target SCADA
C R I T I C A L  I N F R A S T R U C T U R E  S E C U R I T Y
S
i
l 
d d
i i i
• Supervisory control and data acquisition
26
Target SCADA
Target SCADA
C R I T I C A L  I N F R A S T R U C T U R E  S E C U R I T Y
SHODAN  T
 A
i d!
• SHODAN: Target Aquired!
27
Black Hat SEO
Black Hat SEO
Wh
l
?
S E A R C H  E N G I N E   O P T I M I Z A T I O N
• Why use real news events?
• Black hats make their own fake news
• Faux celebrity sex tape anyone?
• Send to college students
Send to college students
• It works!
O h  
 h  
k
• Other scammers imitate what works
28
Google Trends
Google Trends
B L A C K  H A T  S E O  R E C O N
29
D f
Defenses
B L A C K H A T S E O  D E F E N S E S
• Google SafeBrowsing plugin
• Microsoft SmartScreen Filter
• No-script and Ad-block browser plugins
No script and Ad block browser plugins
• Install software security updates
• Stick to reputable sites! 
• Google results aren’t safe.
30
M t d t  Att
k
Metadata Attacks
D A T A   A B O U T   D A T A
• It’s everywhere!
• In documents (doc  xls  pdf)
• In documents (doc, xls, pdf)
• In images
• What can be data mined?
• What can be data mined?
• Usernames, emails
• File paths
• Operating systems  software versions
• Operating systems, software versions
• Printers
• Network information
• Device information
31
v
FOCA
FOCA
A U T O  M E T A D A T A M I N I N G
• Automated doc search via Google/Bing
• Specify domains to target
• Automated download and analysis of docs
• Automated download and analysis of docs
32
D f
Defenses
M E T A D A T A  M I N I N G D E F E N S E S
• Implement a policy to review files for sensitive 
metadata before they’re released
metadata before they re released
• Run metadata extraction tools on your resources
• Utilize metadata cleaning tools
• Digital Rights Management (DRM) tools
33
Advanced
D f
Defenses
P R O T E C T  Y O  N E C K
34
E i ti
 D f
Existing Defenses
“H A C K  Y O U R S E L F”
Tools exist
Real-time updates
Convenient
Multi-engine results
Real time updates
 Historical archived data
 Multi-domain searching
35
g
Ad
d D f
Advanced Defenses
N E W  H O T  S I Z Z L E
Stach & Liu now proudly presents:
p
y p
• Google Hacking Alerts
• Bing Hacking Alerts
36
DEMO
A D V A N C E D  D E F E N S E  T O O L S
DEMO
37
Ad
d D f
Advanced Defenses
G O O G L E  H A C K I N G  A L E R T S
Google Hacking Alerts
• All GHDB/FSDB regexs using 
g
g
• Real-time vuln updates to 1623 hack queries via RSS
• Organized and available via                   importable file
38
Ad
d D f
Advanced Defenses
G O O G L E  H A C K I N G  A L E R T S
39
Ad
d D f
Advanced Defenses
B I N G  H A C K I N G  A L E R T S
Bing Hacking Alerts
• Bing searches with regexs from BHDB
L
‘&f
’ d
d
f
d
• Leverage ‘&format=rss’ directive to turn into update feeds
40
F
 Di
i
Future Direction
P R E D I C T I O N S
41
F t
 Di
ti
Future Directions
P R E D I C T I O N S
Data Explosion
Renewed Tool Dev
• More data indexed, 
searchable
• Real-time, streaming updates
• Faster  more robust search 
• Google Ajax API based
• Bing/Yahoo/other engines 
•
Search engine aggregators
G
l  C d  
d Oth  O
• Faster, more robust search 
interfaces
Google Involvement
• Google Code and Other Open 
Source Repositories
•
MS CodePlex, SourceForge, …
• More automation in tools
g
• Filtering of search results
• Better GH detection and 
tool blocking
Mo e au o a o
oo s
•
Real-time detection and 
exploitation
•
Google worms
42
F t
 Di
ti
Future Directions
R E A L – T I M E  U P D A T E S
43
Questions?
Questions?
Ask us something
Ask us something
We’ll try to answer it.
W
y
w
For more info: 
Email: PI:EMAIL
St
h & Li  LLC
Stach & Liu, LLC
www.stachliu.com
Thank Yo
Thank You
45