plying a regular hash function on these features extracted for each
method [24, 25] by dividing them into pieces (or segments). These
segments contain fragments of traditional hashes joined together
for comparative purposes and are obtained using a rolling hash. A
rolling hash makes use of a trigger value to determine the number
of segments in each feature [29].
In what follows, we use the short form of hj when we refer to
the fuzzy hash value calculated for method j. A fuzzy hash value
can be shared by two or more methods if they are exactly the same
(exact match) or are slightly different (approximate match).
2.3 Building an Aggregated Hash Graph (Steps
#2 & #3)
In the second step, we aim at creating a specific form of call graph,
which we call aggregated hash graph (AHG), per family. Here, nodes
are hashes obtained from step #1, and edges show whether or not
there are connections between pairs of hashes (i.e., between differ-
ent methods). An aggregated hash graph merges similar methods
of different apps of a particular family into one node. This will thus
speed up the extraction of common behaviors from the resulting
graph.
To build this comprehensive graph, we first build a hash graph
(HG) for each application separately. Thus, methods extracted from
each app are assigned a hash value as described in Section 2.2. Then,
hashes are connected to each other based on methods connections
in the call graph (see #2 in Fig. 1). For instance, there is an edge
between hi and hj (hi → hj) if and only if there is a call in method
i to method j (i → j).
When such graph is generated for all apps in one family, an
aggregated graph is obtained by simply merging common nodes
(or hashes) and adding all edges that exist between each pair of
nodes (see #3 in Fig. 1). Also, a unique weight (w1, w2, . . . , wn) is
assigned to each edge by summing up common ones in apps. The
weight of an edge is 1 in the aggregated graph if it is present in
only one application.
Therefore, an AHG is a weighted bi-directional graph for each
family where each weight shows how many apps in the family share
the same connection between two hashes and in the same direc-
tion. Thus, one can obtain meaningful insights about the common
Figure 1: Overall architecture of the proposed system.
2.4 Extracting Ensembles of API Calls (Step #4)
Building an aggregated hash graph per family using method hashes
reveals two important pieces of information: i) the frequency of
similar methods in all apps, ii) and the frequency of methods calls
in all similar methods in a family. However, inspecting popular
methods or calls gives a limited understanding of the behavioral
capabilities of a malware family. Thus, in the last step, we extract
ensembles of sensitive API calls observed either in methods or
consecutive method calls of the aggregated graph (see #4 in Fig. 1).
API calls are appropriate representatives of an app’s behavior.
Sensitive API calls are those which can threaten user’s security and
privacy and can be used to perform various operations, ranging
from OS-related to generic ones such as file system operations. We
have considered 40 sensitive API calls which cover a wide range of
activities as shown in [24]. These methods can be used for a variety
of purposes. On the one hand, some API methods can be used to
record device specific information (e.g., DeviceId or SubscriberId),
location information, installed packages, and running processes or
services. On the other hand, some of the API calls can be used to
leak sensitive information to remote servers either by sending text
messages or by establishing remote connections. Furthermore, we
have considered methods by which malware specimens can manip-
ulate critical information such as files (e.g., by creating, deleting
or encrypting), processes and apps’ contents that are handled by
content providers. Finally, we have considered methods that are
used by some apps to dynamically load classes and to deliver their
malicious functionality at runtime.
It is worth noting that although some of these methods have
been recently deprecated, only 20% of Android devices are running
the newest major version of this OS [18]. This suggests that old
Android malware with outdated API calls can still affect a large
number of users, and, for this reason, we have not excluded these
methods from our list. In addition, some of the methods considered
here may not look sensitive alone but they could potentially be
malicious when they appear with other API calls in an ensemble.
To extract ensembles of API calls from each family, we first
identify all source methods in the AHG, i.e., those methods which
are either isolated (indeдree = 0 and outdeдree = 0), or they have
not been called from any other methods (indeдree = 0). Afterwards,
we extract all paths originating from source methods using a greedy
path mining algorithm with respect to the weights of the edges.
Figure 2: A subgraph of the AHG extracted for the oldboot
family with nodes and edges which are common in more
than 70% of apps (Thickness of edges is a representative of
their prevalence in the whole family).
behavior in a particular family by inspecting these connections and
their corresponding weights. Fig. 2 shows a subgraph of the AHG
extracted for the oldboot family with 11 apps. Here, each weight
(represented by the thickness of an edge) shows how many apps
share a particular method or an edge across the family.
The main difference between building an AHG and simply merg-
ing all call graphs of applications in a family is that, in the former
case, similar methods are assigned with equal hashes and, thus,
are considered as a single node. Instead, in the latter case, an in-
distinguishable change between methods renders different nodes.
Therefore, our system is more resilient to automatic transformation
attacks where we intend to extract common malicious behavior
from a collection of apps belonging to a specific Android malware
family.
FeatureExtraction...a1a2anAppsMethods  Hashing...f1f2fn...h1h2hnCall GraphExtraction...a1a2 an ...gn g1Hash GraphExtractionm3m2m1m2m4m5m1m3h2h1h3h4h6h5AHGPath Extraction  (Graph Mining)e2e1...CreatingFeature Vectors en123Hash GraphsAggregationh3h2h1h2h4h5h1h3...w1w2w3w4w5w6w7Ensembles ofSensitive APIMethods4......5v2v1...vn-6074010104152933699-7589235862953779195-8321382001720240121-6014947107783122934-239110900741841918940556054346133975167811627667129016472569016463448686608-2372489041729654765-3590626980666683366-23890758131580210906437422521504374815-81827930264996208283262424287851980837-6335599766298642392-6658154154862452695-5443890664056422356-45379283314693283374306417586136623153-3973651639743985614-5265754014110635981557051402573683922160827808487659704863231065394794872887-4401825011537522631-39221283873509088691431905014638266428-3409980142110908353837867815331676224-77021048035117178236257471902440122775068354748713129972-43256152575767489843489999496598586380-182406596594081717476515252000702540-16060174594880818437391948314890076959041987647263878650-72779725882212986036690150646356596824-3330305929708844967-82103276128969460864911202594085877851537159160359140770984146597533211587507498152347458162784-6357318097241327519-1081807011337764765-394155160765466204480812560817224930294025441264062447719-1414046220774358936-2800607309468258199-2594392470278786979705145184851801362937531375086863998485216667805235576946-4035252150488745866-3823974397490179977254838747601363064-6665298368902230727793045509729813311450174449954359722872345989103554793596-7833800423515735939-40918245531310795521635061216367364227-1047172860748408700-49473045956259060436166787219416510598-8153629807374805698932653825862867082-1858639343472550216-9128750125067560595614762703252351120-81697400382339671872012334744402556368840561971306049686-79229113845083401989001024182607913121-6530785264471879517-2185605731321071452-19721600437953104265283371498883405994-41790251500035275092426595272687216812644344705913221137636442102409145530098372083893089863859743243600121372895248085648935970121551974165494080610779-16973555044030190613003953371557102597-7181775407689992238096861070590746827-7246079665837625361-47737906527919902575427134481125460008741390616476221653-5022223051283425065-8983145198988027868-1679425557257619237-8466899526680919844-2155098581399406370-7043943710538347483-2928913161830086431-148871448997790082913046196714506672366583240168467906724408071931408236776-3508862332007511831-23271968998965327554150708806868261105903407733765860581012397494608679385478017526531899097333-4184987795690647306-4450286463835807703-8114655490880108296125597704319174911-4041911684114011775514840500741523721-5917514712734260982-328813338681655029-43080022459098561962684906692499560562-9006827107773914856-5140248579149129447-1781152090679035621-894480297832828644-76088584871268881638398895364835340576-54163193996346549424097112798763444274195923877046336541232955884011910906315672666949668397352-34206549590314349666174668331081619278294544699005341996-4993672819795552206-110224826090958546-883956574118517320041381476108661558312337159640447972229-4001219131714397895622710933585063078323783387727302710-3726687494948064953-38895156484013023268405726135394688397981010872945722082-78837330917450102913844373110202769744906225208226689467432799266193459633497084656299938380122-488297477262271453131185258799675631887024523994584948206326998214761083622-6605677645673823898133647264167221608380884262087510076-9415728307258364373175162559507718508-194120198122905563533173440973377580635340027137163438448-2822078799721000588-6322528593902347911-19089726958882197822765702822594152828-263144832157110643591467591895629111029221597442177825153-3536706582026434169385390190957496190090878204808651779953283225905655863692-4716051041466715070-39352477185451782214454993144979220884-2443273122786557547-302454703305846754468119994177855905457122120670073250-47765059340679634855836246562593350054-24603895569477955459039392158529212842-75351826083054649156194899430783596977-9001091817332962894-674816182057311821-6278276512770500169-531619917163715169-662346639566213280281388820116971609493790495396008974784813310561920573204510051822982848376222536727768424196551-6125204970239782456-74340398201099669034925241190390596043-66390041959957069328326572890175699362-995260417526221243870429060738883835417768931053565589143803663319126976343342473897480406593-50465561283023109498766018959749096907332212345114368478-34673258827770567983643091245097114084649828140778354942025786989886734136155409893105501860338-5563808776168244748-29623065961332526195986476241769935353-2847435104485355014-4272664121090952706-4152761926190021547194414881352628737-4059104365651140094-7397014746096494071-4995900416492321363-242252912050315211040921675825250854431760137792055247369820524991112162971990016979543831127283934338188847958554-48203675562591840992632425446779240990-1143893002222536160162171711066523554748245362119175071082215463164783454760-89994050890569927253179333092846927072-6097626745642999250-5906684628749123025-9213043368603514319529923991456284113984671893068460160524059972800494930485-3677801794643013066380883261957509689571982370256696787280673697352420951698502690276911319621-7357094064588772794139903299526252641-3756768690558070200-75563874433398511908907706205454027341717713517539760801479625852139932206887287959306006966867-7133019078233320875-75925257282750273685004157713130367577-4062979989468964262-3918818215987416485-5983571273081838002-7848160620102217627-4643394495544429983-11824109914829551646573976626888991333697796571274273853574131044352370346008137167497867850346-22802622229097982971901365758296431215-46244333432447998963987140669064308019-818957160472690215785170920898655668383827763422123885175-817807089318293440887838644188571060423682069322797961852-50976389527756665813779261019131198090369009825308942024004359470459726228337997253204628111-3197427636269757609-12994490746081764934294309996199611029-74608541457353741869022063675629927064-1533748389628691815-5265320721602413924-78622577241904919983992598709457318564-3348656924909028699-7198915883809807705-6498918393905972567-8642685246342186325-3945751331593028948-2642774524080209235-3606398723279189329-76768529379452839186870799024260207284-125530981448673609827622048515714177844085477263013612217-3963938510452661571-4569330935155316030-8132161894145248568-6726092578762145079-9042601349698196790-48840790343461778454690277067147473612-82109364898834281475734013876709628365-4413402195463472431-94628772729808618973885783072134663253137194126026857175-4519715364373802280-86794299023085570206178411441079698139-5999650811469368332-47943934031768240974068104343371811552-1715082471210550559-57801455764140925746112699366062897892-33177932294922416908034147912634899921-25245303653566599924018715492321253500412253267241433885532962135135734238522136452913615126994-339801349143206427442380250461727833444560277533085519769354409577337085331696264790107449705-773928578299976423381307614800193338868318790151307672319-53613086863266460167549037363806993153-14614712200349667821929990111665580025-20185647923385593-84642332518909288877279140449608145675-7337756297521640677-511295662747696048310829650890559987508357591687022355233485597083461673762815653934663334363-56196291587821949085398130825756756773-60504093670178295935619763571615722280274149813777210157-1301107201417778385-82682449385401684006606571199029087025268462906294293299-7023780682991013882527524666088540981656492028845424108181894575789283868757270841299802217277-871170370630991788941121220536049979538321269641875811138-46973232308745864175970566151606047556-2482242691290434744-1787456792908455093-59146355523015958272241513267027561294-8209974094323059888-35687731892519851121903026927043060035169288111544972116748979004263551829-386628066025724845512001298987472125844928300178215781212-6030312819295780002298484487399935881622047929586553598426005835868915030782447886534936634215427858473880247383356480753292974956-6973228113785505646-4946550654184346770-8053187375638154385-8947787009435090063-1718566143354485900-4323698316717014155430690245135098559166437237982481897475121792763400397690-1171088147450172546-644593621153286873431127108869098784228769920135182771078-18635010718643518656782706146203769737-2152084305111700597-44132242499804621966092412326171186063-62981305954833194087039090144184933267-4196421239311295596624832003794575861480923832553118219777168031732678730648-619639733455754343242491884442123163-8113784802768431847420877090862330782-6685207552175905887-4898009216512412766-4998684422214769757-45007225222703545173057845338765378478-7289987811196200803-47721301380658780962328629189388243890-5858006260261562893-7140206314547059554-28661361237203466974836792262729497076-8073364195137991749-6076183914752896064753387728894229441883214347865383094235609739732903405949987354049473141661027039351525237703-69996394342709340726078185887028259787-307519439512626714519826773899030230538728400619563570126-51679634727083634432489904598018802640121528044928272686633292735809103287895848609268963673665-34950575946336573803715898723489828346-181813756715824337-142493997683145841757688347200537835253879492260642638822-50338322736147466495244392720381209576-3718034004954264597-6703134028508193811-5409709888194918576146258685322220712-602809320729094980558698555368864225164282839311603215870-8559490242085170186-73122954673254680807012885765627923284-433303743950764544589726860026902456283407300067575901013-8613590030233101311-60130577031120036313532088051993904133-6365414490938300927-89192371817363824007805946087674646700-2364826550288743414-9153725632381598709-22817210024490137485355360929876775950-4665760636021889614-7707166328786314222-1582404190089077767-7680449781887701996-24314464733347542817846291920500196377-8240112541257917242-80786337789363988154816181043762288985104558984338086947-891974767371223343639346297532323809654803446243881412335092561791841133609-5652294200784167894-8622090480965818873-7131472084428579796-360152324416217185849875912485838689803900653049155394609292340798281311241-8293078765123143157444741537198582839-73234475704465192405757036114292676467-47149666116134822566018173671823443007-70955746505044696648479477932653620290-3260170993631945661-7059635399251492751395151898684541242630611915867289651968834389016947770445-61044128060905379067366277347805754449-90867371771899913407223979633792281685-675960579814335093648282762522761616274460397576661650529688976017655983737136782821950754909174078171039017086055-45275042254243514068828294527701514743004839829305134263935726158993056878-62807836825633821593317345097211757682413464374663049803784491042220821658769013266390834809974-8813982898699854728775680011498135052340791346828351233263209670548243502211-7684329028403160340-796365481248004593941981547000034971029064056906135712621-8571039906087650158-3593776525702540141-66995636588423279141069088096059925657246528934962333404576752485068800728627285438335167190175-7913333139955319648-2194449423559488213-69337293924049887645232267962722774181-353091970140461914-1980287500968112271-441444980530778968-59666046433145045313073963047516294318-9114658473902766927-526336275546607086180763149240124632846219147234507746487-267802539041958586063922687834614263781546277804210429118-399276945796777247929197404334851432344168506898349667523-335142748918100796-4445141915117466427-679095815141350073079257430096876146655571815462144853194-5861213602046559028-11330615354358007917707404372140145871916084382849166549-4576222417929077545-3191406887291818791-5955488742155692015290313521989835997-8694437393004931874-4819216620527379232-3543979845451474736165129178052699371700985677773433777375676497045714162304678440767746053360-750579177056756476023727792821556789636285221101628032244-55459223520154263156001844188578415866-621728598770734771543727165747923468781114822732536570964-887992993939457715150456515146082542101495787409383711959-4084405286017690356765260657760468238-2000695804296068020-1266193980980206319-6677787787415403246-46885262403714116932112173281442989337-3329396373186326847-4937945013867573436-1821120053129161955971566221125520261-50200074170475936942412645508261419227839280771480292279028845925423482524562861371933686850439-207675839286087957132088829253749698066273339504943934768-4368986326693853903-8289216140902786509-1018752163095513802-75465250328576785377050588143515798840-2388285948934440396-81112746420373756861394337638981782846-5275970135107865279-1461632496842664637-1459634578328166858-5745693010102452927-65128978677353663294015340989374571851741981658623453524462733385050619349891251473320632585555-32954009699550440104086239893587385687-824355838294491815-6625693497350013606-9052612553518412913-5663704521276078755-2356413742638025378-9120660262124190365-81130146278409611763272691308829498730-51137989542498310626668637836459769198-1180387453614217385-15084304907245861246171678621777239413-6388999176274766125-2232180750943138441-52505102996431258682742083218290640588535972049707775363-3547009961848515690-57728775262788970875283624768090498967-58858996286621902448888783151362717575677812035397350798-6945148922053864047-2782134141992745988688365737320975763400985649787107061264263906202361829348784716845119026585-2386249467794641386-50902069912599414756266518326043018935319779268214535067-4184762821283158616-180367200900305495-5188690268054080086-63350155488045930812402952346827171245-4648225610626175284502721716086409468893526314038113523-7526094904607808610-249956245750398058-4984460495582681672-898879212432188066-2499969492356164164-6948361673023283778-68353280189644129938962805711769611716-8465223718785759799-1300535491464849161524553006195708052476026880875044299869111259637772809680-1388995240989872687-71126968677456000435475830517660352420-27419977737575347586586874356152491484-4820715020631896838-6028993086983109154-175722915462085481645847931916959463203541845514480379366-546971934558428418253554323210490403631028120435281996038515287593997561326-84424084994564961452525218394791947763-42104147905848734834267743214745395442-3853827782270947357-59442899431476275985488784492609940425013664495174116860-62761691502204032024562357672077836885-1595894762089818624-103364539649196083137682059428224664751812379908905567748-2235378442613990355236960866109533702-27540457595573235195634004335383957001-4787381186160992754-471911292849304048-2585697116815428078-7250403283742151482657577045546296853-52757361462080332582818520692319690329-2811203362819564007-6576084979543937509-5526315675895637414-1871024493009842658-5629144353494831583-7934644469088401885-67517842574368322184300482982792513063-230616268965915440174528716630204964255301053644360050220-7084463393550440545710892015275019825-25855163065246663161971049736831371451-20367695520895431424366760414759849527966290966496281379-2139147043779877316-60904805594405421475826073496849190837-261519961256849657564466348235240054431476236568937143877-521465957839772815948412259071527993043080271369026540812-4977873604600940978-31810242312908415213336306249639388153-77055999531557912748961811448534174873584515169737887141692217361893000105873630521027644140366254999614975906160038087344372666568677439909923381714533-448427283174396312-748122021287172546216850896395367378992498299560167165548220182457027653231-1793755251323103630100777343014068666126880953403831128206648080818533588599-5537021200046287240598674637495233496943069034512249852104490986671373031036-44913629405120219109064057906009712256-57201396144645471985517601737682436715-3038869896263521343-7978956615424782004191203789046128269-6625206284892336247-6390194936190490991-2910195648147204460-45708212414650535464510574672972533399-315110160424874342-90218131204164089774516274219108371557-2425866965178480989-913001984388252297214118297037869994613958213926214330022-3558105836895606159744782010456981799557143269054642950852211420507038033582-52217455881600003366972399339716728498-8599161407951278087-10189838602037641034256585679982497172-1229282411371829576-41980857593628286842462980755598470845188239514346948166249560198664302629754943629098871892256-9121818234344782911-3420340866718101821-2273951142763616572-3193105249957286203-5371857047922514234-5506791055637904225-66466089832227269631987212508615855824-84304443992362068939203805339648116437-69105948678915407245549716456446723799-514459631260608073269621720077361231002427970318415173343-398840360911398200025314606479798330597055078-7500350524742080559-7036957000286518008355448075658839787-8619619744426410260811931145748384558637722319090668684623860224377547433597-28686165393686674088446233261277388072-56470707788293511823508800434467533217-3809947198095429899-4603513662555756807-1515479012796928262161957083916956236358831609156652315417337143622764134142-6692742346083723521-58238321232916011504446974283740737283-2991230575794196732-8898858974330611796-1904312933836413374830946466574082348-77540231798030113158900535494568281757586872428364930833-1175554141788334316-4335684251934251291254138890357810329-969903837851236581902609826664103502-63398896651335354588806231677752135455-505291400817420510-6744209430862680284227089631051348355846219068052121224174802393656284430121-4822600501137457366166426412799419575740323969155230533588154453527711778608-89225720184333827761514957960401084247-4709479814637740237726162706390129457879398146790564657212395897619509440317-92149609078564473774351561807948368047908386727724045281-84581806648828008211558324183777048546392190170463354704725231984035786210158377604330495037151909399883058393401-19416078751308883585408357521485725531-45838905252666062491936382284431619933863808487765485974937772536603496507841365415928280377186-3686589237284030621-40768340711058105889013811432158562151-5869830003998359704-17336100282722141672663558538901290858-8938599953994164372-7367682898103693459-3524760658711881112238866015513970546-4291699357484351629-14689941600864994653734920605996562296-4905513838502463621-5367789153305221250-6026128466748432511-2185947683327676723-4785038016942381178-838606601217023865528100866327965182812955179364194696888-8277299537764556915-731180118961464673218590912074527661894821866037725694896606757081641379730-7981764681533016173-1791551110071958051-248350778869422098123306969346385167351773635969917683234003231730783182831-409296553139028182773101561389712505918423374774262007712-3832815722820892766-7182611671320016989404355179046538435612510716457425939615730201174090475847-6028738774044345380-5225274034542595157-8324950333613199442-3479019555111352401-1360314853068773454-60854628784049068366466891951003944884-1800283931431282672-44780960315950244588621879123337699255-5701892793556725832-3243464868830300231-7178803028431511622-8847026419719053379-7957417964827256897-4924575153691308095606492248357051386045453264001746554306349773611853065677880678067421992268-6593693884889485366-30891012023539384823580458507997503439-6669232024488693807-746909049168758802511597879154675610503430492282282772473-2388443798712983589-7531141467353992539486659325517475808-750740161412726136056180537354032349077190500365277258747358010436644602640612448190618610167537595537805916353191-6149295902189118029-6480360394891897129-3680682385005303825-6686226396795187215-962476947628347406-6671422095062140940-531158813166879539982298683783019642828995311058693718011-2163663511354400771-6597068113484250795This implies that all edges in a particular path do have a common
frequency among apps which belong to the same family. Once these
paths are extracted, we collect sensitive API calls appearing in each
path. In particular, the union of sensitive calls along one path results
in a unique ensemble of sensitive API calls for that specific path.
So, we are finally left with several ensembles of API calls per family
which have different percentages of prevalence among apps.
2.5 Creating Feature Vectors (Step #5)
Once ensembles of sensitive API calls are extracted, each application
is assigned a binary feature vector. Each feature (named fj in figures)
is a unique ensemble of API calls in a family. The length of this
vector for each app is thus equal to the total number of extracted
ensembles from the entire dataset, and the presence or absence of
an ensemble is shown with 1 or 0.
To measure similarities and differences between vectors, we use
the cosine similarity metric as defined in Eq. 1. Specifically, given
two vectors, A1 and A2, their cosine similarity is computed by
scaling the dot product of these vectors to their magnitudes. Thus,
the output is in the [0, 1] interval.
Simcos(A1, A2) = A1 · A2
∥A1∥∥A2∥
(1)
Contrarily to the cosine similarity, the cosine distance expresses
vectors dissimilarity in positive space (i.e., [0, 1]). This is done by
subtracting the cosine similarity from 1 as follows: Distcos(A1, A2) =
1− Simcos(A1, A2). Thus, the cosine distance of two vectors is close
to 0 when they are highly similar, and it is almost 1 when two
vectors are completely different.
3 EVALUATION
In this section we evaluate our approach. We first present our exper-
imental setting and describe our dataset. We then apply our system
to about 700 families and 16K apps, and we present our results by
grouping these families by type of family (i.e., ransomware, and
two types of Trojans). We also describe how our approach can help
in extracting the common malicious behavior of these families and
how it finally leads to a fine-grained understanding of security
sensitive operations which are exercised by each family.
3.1 Experimental Setting and Dataset
The proposed system has been implemented in Python. Our imple-
mentation extracts all method’s features as well as call graphs using
Androguard [30], a full Python reverse engineering tool developed
for Android apps. We have evaluated our system on the biggest aca-
demic dataset of Android apps, known as AndroZoo [31]. Families
have been all extracted using Euphony [11].
Experiments are all conducted on a 2.4 GHz Intel Xeon Ubuntu
server with 40 CPUs and 128 GB of RAM. As we are interested in
extracting common behavior from all apps in a medium and big size
families, we discard those which contain less than 7 apps. Also, to
alleviate the expensive process of path mining in large call graphs,
we only extract paths with a maximum length of 2. Finally, we
have excluded paths that include edges shared by less than 70% of
apps. Therefore, if a family does not contain ensembles of sensitive
API calls shared by more than 70% of apps, it is removed from the
dataset as well.
AndroZoo contains around 8M Android apps from more than
3,000 families. The apps are gathered from 15 known markets and
1 unknown repository. However, the majority of them (≈ 97%) are
collected from 3 main app markets, including Google Play, Anzhi
and AppChina. Each app in this dataset is regularly scanned by
various Anti-Virus (AV) vendors to separate malicious apps from
benign ones. Around 1%, 33% and 17% of apps in the three markets
in AndroZoo are malware according to at least 10 different AV
vendors. Thus, our dataset of malicious apps is a subset of this huge
market with 117 families and 3,050 malware specimens (see Table
1).
Table 1: Statistics of the dataset considered for case study,
including the number of apps, number of families and the
average size of applications (MB).
Malware Type
Ransomware
SMS Trojan
Banking Trojan
Total
#Apps
#Families Avg. Size
824