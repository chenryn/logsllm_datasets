└─────────────┬─────────────┘              │                                                                                                                                                                                                                           
┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                                                
│         SEQ_SCAN          ││           FILTER          │                                                                                                                                                                                
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
│             a             ││      (id IS NOT NULL)     │                                                                                                                                                                                
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
│             id            ││        EC: 1000000        │                                                                                                                                                                                
│            info           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
│             ts            ││             11            │                                                                                                                                                                                
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          (0.00s)          │                                                                                                                                                                                
│        EC: 1000000        ││                           │                                                                                                                                                                                
│   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                                                                                                                                                
│          1000000          ││                           │                                                                                                                                                                                
│          (0.01s)          ││                           │                                                                                                                                                                                
└───────────────────────────┘└─────────────┬─────────────┘                                                                                                                                                                                                             
                             ┌─────────────┴─────────────┐                                                                                                                                                                                
                             │           FILTER          │                                                                                                                                                                                
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
                             │      (id IS NOT NULL)     │                                                                                                                                                                                
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
                             │        EC: 1000000        │                                                                                                                                                                                
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
                             │             11            │                                                                                                                                                                                
                             │          (0.00s)          │                                                                                                                                                                                
                             └─────────────┬─────────────┘                                                                                                                                                                                                             
                             ┌─────────────┴─────────────┐                                                                                                                                                                                
                             │          REC_CTE          │                                                                                                                                                                                
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
                             │            tmp            │                                                                                                                                                                                
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                                                
                             │           idx: 7          ├──────────────┐                                                                                                                                                                 
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                                                                 
                             │             12            │              │                                                                                                                                                                 
                             │          (0.06s)          │              │                                                                                                                                                                 
                             └─────────────┬─────────────┘              │                                                                                                                                                                                              
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                   
                             │    UNGROUPED_AGGREGATE    ││         PROJECTION        │                                                                                                                                                   
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                   
                             │          min(#0)          ││          SUBQUERY         │                                                                                                                                                   
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                   
                             │             1             ││             11            │                                                                                                                                                   
                             │          (0.00s)          ││          (0.00s)          │                                                                                                                                                   
                             └─────────────┬─────────────┘└─────────────┬─────────────┘                                                                                                                                                                                
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                                                                                   
                             │         PROJECTION        ││         DELIM_JOIN        │                                                                                                                                                   
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                                                                                   
                             │             id            ││           SINGLE          │                                                                                                                                                   
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ id IS NOT DISTINCT FROM id│                                                                                                                                                   
                             │          1000000          ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐───────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                
                             │          (0.00s)          ││        EC: 1000000        │              │                                                                                                                   │                
                             │                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                                                                   │                
                             │                           ││             0             │              │                                                                                                                   │                
                             │                           ││          (0.00s)          │              │                                                                                                                   │                
                             └─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                                                                   │                                             
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐  
                             │         SEQ_SCAN          ││           FILTER          ││         HASH_JOIN         │                                                                                       │       HASH_GROUP_BY       │  
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │  
                             │             b             ││      (id IS NOT NULL)     ││           SINGLE          │                                                                                       │             #0            │  
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││ id IS NOT DISTINCT FROM id│                                                                                       │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │  
                             │             id            ││           EC: 0           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                       │             22            │  
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││        EC: 1000000        ├──────────────┐                                                                        │          (0.00s)          │  
                             │        EC: 1000000        ││             11            ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                        │                           │  
                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          (0.00s)          ││             11            │              │                                                                        │                           │  
                             │          1000000          ││                           ││          (0.00s)          │              │                                                                        │                           │  
                             │          (0.00s)          ││                           ││                           │              │                                                                        │                           │  
                             └───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘              │                                                                        └───────────────────────────┘                               
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                                                         
                                                          │        REC_CTE_SCAN       ││      COLUMN_DATA_SCAN     ││         PROJECTION        │                                                                                         
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                          │           idx: 7          ││             11            ││          min(id)          │                                                                                         
                                                          │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          (0.00s)          ││             id            │                                                                                         
                                                          │             12            ││                           ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                          │          (0.00s)          ││                           ││             10            │                                                                                         
                                                          │                           ││                           ││          (0.00s)          │                                                                                         
                                                          └───────────────────────────┘└───────────────────────────┘└─────────────┬─────────────┘                                                                                                                      
                                                                                                                    ┌─────────────┴─────────────┐                                                                                         
                                                                                                                    │         HASH_JOIN         │                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                                                                                    │           INNER           │                                                                                         
                                                                                                                    │ #0 IS NOT DISTINCT FROM id│                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├───────────────────────────────────────────┐                                             
                                                                                                                    │        EC: 1000000        │                                           │                                             
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                           │                                             
                                                                                                                    │             10            │                                           │                                             
                                                                                                                    │          (0.00s)          │                                           │                                             
                                                                                                                    └─────────────┬─────────────┘                                           │                                                                          
                                                                                                                    ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐                               
                                                                                                                    │       HASH_GROUP_BY       │                             │         DELIM_SCAN        │                               
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                               
                                                                                                                    │             #0            │                             │             0             │                               
                                                                                                                    │          min(#1)          │                             │          (0.00s)          │                               
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                             │                           │                               
                                                                                                                    │             10            │                             │                           │                               
                                                                                                                    │          (0.09s)          │                             │                           │                               
                                                                                                                    └─────────────┬─────────────┘                             └───────────────────────────┘                                                            
                                                                                                                    ┌─────────────┴─────────────┐                                                                                         
                                                                                                                    │         PROJECTION        │                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                                                                                    │             id            │                                                                                         
                                                                                                                    │             id            │                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                                                                                    │          4997665          │                                                                                         
                                                                                                                    │          (0.00s)          │                                                                                         
                                                                                                                    └─────────────┬─────────────┘                                                                                                                      
                                                                                                                    ┌─────────────┴─────────────┐                                                                                         
                                                                                                                    │      NESTED_LOOP_JOIN     │                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                                                         
                                                                                                                    │           INNER           │                                                                                         
                                                                                                                    │          id > id          │                                                                                         
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ├──────────────┐                                                                          
                                                                                                                    │        EC: 1000000        │              │                                                                          
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │              │                                                                          
                                                                                                                    │          4997665          │              │                                                                          
                                                                                                                    │          (0.06s)          │              │                                                                          
                                                                                                                    └─────────────┬─────────────┘              │                                                                                                       
                                                                                                                    ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                                                            
                                                                                                                    │         SEQ_SCAN          ││         DELIM_SCAN        │                                                            
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   │                                                            
                                                                                                                    │             b             ││             0             │                                                            
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││          (0.00s)          │                                                            
                                                                                                                    │             id            ││                           │                                                            
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                            
                                                                                                                    │        EC: 1000000        ││                           │                                                            
                                                                                                                    │   ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─   ││                           │                                                            
                                                                                                                    │          11012288         ││                           │                                                            
                                                                                                                    │          (0.01s)          ││                           │                                                            
                                                                                                                    └───────────────────────────┘└───────────────────────────┘                                                                                         
Run Time (s): real 0.076 user 0.275786 sys 0.034828  
```  
PS: 如果数据库优化器内置此类逻辑优化就最好了, 不用改写SQL.   
## 参考  
[《PostgreSQL 14 preview - 大表search IN ( consts ) - linear search TO hash table probe (consts 个数>= MIN_ARRAY_SIZE_FOR_HASHED_SAOP)》](../202105/20210519_02.md)    
[《PostgreSQL 16 preview - 支持 Right Anti Join , 对hash right join (non-nullable input)可选择small table作为hash table.》](../202304/20230406_05.md)    
[《PostgreSQL 与关系代数 (Equi-Join , Semi-Join , Anti-Join , Division)》](../201802/20180205_01.md)    
Oracle中的半连接 hint: https://cloud.tencent.com/developer/article/1515841  
[《用PostgreSQL找回618秒逝去的青春 - 递归收敛优化》](../201612/20161201_01.md)    
[《PostgreSQL DISTINCT 和 DISTINCT ON 语法的使用》](../201710/20171017_02.md)    
[《DB吐槽大会,第62期 - PG 不支持index skip scan》](../202109/20210929_07.md)    
[《SQLite3 的index skip scan优化器功能》](../202209/20220910_02.md)    
#### [期望 PostgreSQL|开源PolarDB 增加什么功能?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
#### [PolarDB 开源数据库](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
#### [PolarDB 学习图谱](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
#### [购买PolarDB云服务折扣活动进行中, 55元起](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
#### [PostgreSQL 解决方案集合](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
#### [德哥 / digoal's Github - 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
#### [About 德哥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")