infrastructure to more easily spin up complete replicas of environments for testing these
changes. Rather than continuously running a full patch test environment, we can create one with
k
relative ease using our cloud provider, run the relevant tests, then delete it. The primary risk of this
approach is supply chain compromise.
s
Continuous supply chain validation occurs when people and systems validate that the software
and hardware received from vendors is the expeocted material and that it hasn’t been tampered
with, as well as ensuring output software and materials are verifiable by customers and business
partners. Continuous supply chain validation is difficult, and sometimes requires more than
n
software checks, such as physical inspections of equipment ordered. On the software side of
supply chain security, we can use deeper testing and inspection techniques to evaluate upstream
data more closely. We might opt to increase the security testing duration to attempt to detect
i
sleeper malware implanted in upstream sources. Sleeper malware is software that is inactive
z
while on a a system for a period of time, potentially weeks, before it starts taking action.
Utilizing a software bill of mDaterials (SBOM)81 as a way to track dependencies automatically in the
application build process greatly helps us evaluate supply chain tampering. If we identify the
software dependencies, create an SBOM with them, and package the container and SBOM
together in a cryptographically-verifiable way, then we can verify the container’s SBOM signature
before loading it into to production. This kind of process presents additional challenges for
adversaries.
3.4.8 Encryption
Beyond tracking software, many organizations likely want to leverage encryption. Encryption often
protects us from adversaries more than any other type of control. While using encryption doesn’t
solve all problems, well-integrated encryption at multiple layers of controls creates a stronger
security posture.
Keeping this in mind, there are some caveats to consider when it comes to encryption. Encrypting
all our data won’t be useful if we can’t decrypt it and restore it when required. We must also
consider some types of data that we won’t want to decrypt as the information is to be used only
80 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Business_continuity_planning
81 (CISA, 2022), https://www.cisa.gov/sbom
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 48
Made in Morocco
Penetration Testing with Kali Linux
ephemerally. One example of ephemeral encryption is TLS,82 in which nobody but the server and
the client of that specific interaction can decrypt the information (not even the administrators),
and the decryption keys only exist in memory for a brief time before being discarded.
Decryption keys in such a scenario are never on disk and never sent across the network. This type
of privacy is commonly used when sending secrets or Personal Identifiable Information (PII)
across the wire. Any required tracing and auditing data can be output from the applications rather
than intercepted, and the secrets and PII can be excluded, encrypted, or scrubbed. PII can include
names, addresses, phone numbers, email addresses, SSNs, and other information that can be
used to track down or spy on an individual person.
Along with ensuring we can encrypt data, we should ensure that only the minimum required
persons or systems can decrypt said data. We also probably want backups that are encrypted
with different keys. In general, we don’t want to re-use encryption keys for different uses, as each
key should only have one purpose. A file encryption key might encryypt millions of files, but that
key should be used for only that purpose, and not, for example, signing or TLS.
k
Although using encryption and backups are great practices, we also should implement protocols
for routinely restoring from backups to ensure that we know how, and that the process works for
every component. In some cases, we don’t need to basck up detailed log data; however, most
compliance and auditing standards require historic logs. Some specifications may even require
that systems are in place to query for and delete sopecific historic log records.
3.4.9 Logging and Chaos Testing
n
Being able to access granular data quickly is of great benefit to an organization. Well-engineered
logging is one of the most important security aspects of application design. With consistent, easy
i
to process, and sufficiently-detailed logging, an operations team can more quickly respond to
z
problems, meaning incidents can be detected and resolved faster. Along with well-engineered
security and application logging, it’s also important to be able to quickly access inventory.
D
The last control we’ll explore is Chaos Testing.83 Chaos testing is a type of BCP or disaster
recovery (DR)84 practice that is often handled via automation. For example, we might leverage a
virtual machine that has valid administrative credentials in the production network to cause
intentional disasters from within. Chaos engineering includes a variety of different approaches,
such as having red teams create chaos in the organization to test how well the organization is
able to handle it, scheduling programmed machine shutdowns at various intervals, or having
authenticated malicious platform API commands sent in. The goal is to truly test our controls
during messy and unpredictable situations. If a production system and organization can handle
chaos with relative grace, then it is an indication that it will be robust and resilient to security
threats.
3.5 Cybersecurity Laws, Regulations, Standards, and Frameworks
This Learning Unit covers the following Learning Objectives:
82 (TLS, 2022), https://en.wikipedia.org/wiki/Transport_Layer_Security
83 (IBM, 2022), https://www.ibm.com/garage/method/practices/manage/practice_chaotic_testing/
84 (VMware, 2022), https://www.vmware.com/Modules/glossary/content/disaster-recovery.html
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 49
Made in Morocco
Penetration Testing with Kali Linux
• Gain a broad understanding of various legal and regulatory issues surrounding cybersecurity
• Understand different frameworks and standards that help organizations orient their
cybersecurity activities
3.5.1 Laws and Regulations
Much can be written about cybersecurity laws and regulations, especially since different
countries and jurisdictions all have their own. Most of the items we’ll discuss here are centered on
the United States; however, some are applicable globally as well. As a security professional, it’s
always important to understand exactly which laws and regulations one might be subject to.
HIPAA: The Health Insurance Portability and Accountability Act of 1996 (HIPAA)85 is a United
States federal law regulating health care coverage and the privacy of patient health information.
Included in this law was a requirement to create of a set of standards for protecting patient health
y
information, known as Protected Health Information (PHI). The standards that regulate how PHI
can be used and disclosed are established by the Privacy Rule.86 This rule sets limits on what
information can be shared without a patient’s consent and graknts patients a number of additional
rights over their information, such as the right to obtain a copy of their health records.
s
Another rule known as the Security Rule87 outlines how electronic PHI (e-PHI) must be protected.
It describes three classes of safeguards that must be in place: administrative (having a
o
designated security official, a security management process, periodic assessments, etc.),
physical (facility access control, device security), and technical (access control, transmission
security, audit abilities, etc.). These rules anlso include provisions for enforcement and monetary
penalties for non-compliance. Importantly, HIPAA also requires that covered entities (healthcare
providers, health plans, business associates, etc.) provide notification88 in the event that a PHI
breach occurs. i
z
FERPA: The Family Educational Rights and Privacy Act of 1974 (FERPA)89 is a United States
federal law regulating the privacy of learners’ education records. This law90 sets limits upon the
D
disclosure and use of these records without parents’ or learners’ consent. Some instances where
schools are permitted to disclose these records are school transfers, cases of health or safety
emergency, and compliance with a judicial order.
FERPA also grants parents and learners over the age of 18 a number of rights over this
information. These rights include the right to inspect these records, the right to request
modification to inaccurate or misleading records, and more. Schools that fail to comply with
these laws risk losing access to federal funding.
GLBA: The Gramm-Leach-Bliley Act (GLBA),91 enacted by the United States Congress in 1999,
establishes a number of requirements that financial institutions must follow to protect
85 (CDC, 2022), https://www.cdc.gov/phlp/publications/Module/hipaa.html
86 (HHS, 2013), https://www.hhs.gov/hipaa/for-professionals/privacy/laws-regulations/index.html
87 (HHS, 2013), https://www.hhs.gov/hipaa/for-professionals/security/laws-regulations/index.html
88 (HHS, 2013), https://www.hhs.gov/hipaa/for-professionals/breach-notification/index.html
89 (ED, 2022), https://learnerprivacy.ed.gov/faq/what-ferpa
90 (CDC, 2022), https://www.cdc.gov/phlp/publications/Module/ferpa.html
91 (FDIC, 2022), https://www.fdic.gov/consumers/consumer/alerts/glba.html
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 50
Made in Morocco
Penetration Testing with Kali Linux
consumers’ financial information. This law requires that institutions describe how they use and
share information and allow individuals to opt out in certain cases.
Like other cybersecurity laws, GLBA requires that financial institutions ensure the confidentiality
and integrity of customer financial information by anticipating threats to security and taking steps
to protect against unauthorized access. In addition, financial institutions must also describe the
steps that they are taking to achieve this.
GDPR: The General Data Protection Regulation (GDPR)92 is a law adopted by the European Union93
in 2016 that regulates data privacy and security. It applies to the private sector and most public
sector entities that collect and process personal data. It provides individuals with a wide set of
rights over their data including the well-known “right to be forgotten” and other rights related to
notifications of data breaches and portability of data between providers.
GDPR outlines a strict legal baseline for processing personal data. For example, personal data
y
may be processed only if the data subject has given consent, to comply with legal obligations, to
perform certain tasks in the public interest, or for other “legitimate interests”. For businesses that
k
process data on a large scale or for whom data processing is a core operation, a data protection
officer - who is responsible for overseeing data protection - must be appointed.
s
GDPR also establishes an independent supervisory authority to audit and enforce compliance
with these regulations and administer punishment for non-compliance. The fines for violating
o
these regulations are very high: a maximum of 20 million Euros or 4% of revenue (whichever is
higher), plus any additional damages that individuals may seek.
n
One unique aspect of GDPR is that it applies to any entity collecting or processing data related to
people in the European Union, regardless of that entity’s location. At the time of its adoption, it was
considered the most strict data priivacy law in the world and has since become a model for a
number of laws and regulations eznacted around the globe.
Key disclosure laws94 are laws that compel the disclosure of cryptographic keys or passwords
D
under specific conditions. This is typically done as part of a criminal investigation when seeking
evidence of a suspected crime. A number of countries have adopted key disclosure laws requiring
disclosure under varying conditions. For instance, Part III of the United Kingdom’s Regulation of
Investigatory Powers Act 2000 (RIPA)95 grants authorities the power to force suspects to disclose
decryption keys or decrypt data. Failure to comply is punishable by a maximum of two years in
prison or five years if a matter of national security or child indecency is involved.
CCPA: The California Consumer Privacy Act of 2018 (CCPA)96 is a Californian law granting
residents of the state certain privacy rights concerning personal information held by for-profit
businesses. One of these rights is the “right to know”, which requires business to to disclose to
consumers, upon request, what personal information has been collected, used, and sold about
them, and why. The “right to opt-out” also allows consumers to request that their personal
information not be sold, something that must, with few exceptions, be approved. Another right is
the “right to delete”, which allows consumers to request that businesses delete collected personal
92 (Proton AG, 2022), https://gdpr.eu/what-is-gdpr/
93 (EU, 2022), https://eur-lex.europa.eu/legal-content/EN/LSU/?uri=uriserv:OJ.L_.2016.119.01.0001.01.ENG
94 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Key_disclosure_law
95 (Open Rights, 2021), https://wiki.openrightsgroup.org/wiki/Regulation_of_Investigatory_Powers_Act_2000/Part_III
96 (SoC DoJ, 2022), https://oag.ca.gov/privacy/ccpa
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 51
Made in Morocco
Penetration Testing with Kali Linux
information. In this case, however, there are a number of exceptions that allow business to
decline these requests.
3.5.2 Standards and Frameworks
PCI DSS: The Payment Card Industry Data Security Standard (PCI DSS)97 is an information security
standard, first published in 2004, for organizations handling customer payment data for a number
of major credit card companies. It is managed by the Payment Card Industry Standards Council.
It’s purpose is to ensure that payment data is properly secured in order to reduce the risk of credit
card fraud. As with other frameworks, PCI DSS consists of a number of requirements, compliance
with which must be assessed annually. Most of these requirements resemble other industry best
practices regarding network and system security, access control, vulnerability management,
monitoring, etc. For example, Requirement 2 prohibits the use of vendor-supplied defaults for
system passwords and other security-related parameters. Other requirements are credit-card
y
specific formulations of other familiar best practices. For example, Requirement 3 outlines what
types of credit card data can be stored and how it must be protected.
k
CIS Top 18: The Center for Internet Security (CIS) Critical Security Controls, also known as CIS
Controls,98 are a set of 18 (previously 20) recommended controls intended to increase an
s
organization’s security posture. While not themselves laws or regulations, these controls pertain
to a number of areas that regulations are concerned with, including data protection, access
control management, continuous vulnerability manoagement, malware detection, and more.
These controls are divided into a number of safeguards (previously known as sub-controls),
n
which, in turn, are grouped into three implementation groups99 intended to help prioritize
safeguard implementation. IG1 consists of controls that are considered the minimum standard
for information security meant to protect against the most common attacks and should be
i
implemented by every organization. They are typically implemented by small businesses with
z
limited IT expertise that manage data of low sensitivity. IG2 is composed of additional safeguards
that are meant to apply to more complex organizations, typically those with multiple departments
D
and staff dedicated to managing IT infrastructure with more sensitive customer and proprietary
data. IG3, which consists of all safeguards, is typically implemented by organizations with
dedicated cybersecurity experts managing sensitive data that may be subject to oversight.
NIST Cybersecurity Framework: The National Institute for Standards and Technology (NIST)
Cybersecurity Framework100 is a collection of standards and practices designed to help
organizations understand and reduce cybersecurity risk. It was originally developed to help
protect critical infrastructure; however, it has been subsequently adopted by a wide array of
organizations.101
The NIST framework consists of three components:102 Core, Implementation Tiers, and Profiles.
The Framework Core is a set of cybersecurity activities and outcomes. It is divided into five high-
level functions that encompass a number of categories (for example, Asset Management and
97 (PCISSC, 2022), https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Supporting%20Document/PCI_DSS-QRG-v3_2_1.pdf
98 (CIS, 2022), https://www.cisecurity.org/controls/cis-controls-list
99 (CIS, 2022), https://www.cisecurity.org/controls/implementation-groups
100 (NIST, 2022), https://www.nist.gov/industry-impacts/cybersecurity-framework
101 (NIST, 2022), https://www.nist.gov/cyberframework/getting-started
102 (NIST, 2022), https://www.nist.gov/cyberframework/online-learning/components-framework
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 52
Made in Morocco
Penetration Testing with Kali Linux
Risk Assessment). These categories, in turn, include subcategories that consist of statements
describing the outcome of improved security and which are aligned with Information References.
These references go into deeper detail about possible technical implementations. For example,
Subcategory ID.BE-1 (Function: Identify, Category: Business Environment) states “The
organization’s role in the supply chain is identified and communicated.”
The Framework Implementation Tiers specify the degree to which an organization’s
Cybersecurity practices satisfy the outcome described by the subcategories of the Framework
Core. There are four such Tiers: partial (the least degree), risk informed, repeatable, and adaptive.
Framework Profiles refer to the relationship between the present implementation of an
organization’s cybersecurity activities (Current Profile) and their desired outcome (Target Profile),
which is determined by the organization’s business objectives, requirements, controls and risk
appetite. The comparison of these profiles can help the organization perform a gap analysis, as
well as understand and prioritize the work required to fill it.
y
ATT3CK and D3FEND: The MITRE103 organization has tabulated and organized a framework for
cataloging how groups of attackers work together to infiltrate systems and achieve their goals.
k
This framework, called the MITRE ATT3CK104 framework, is constantly updated to reflect the
latest TTPs used by malicious groups across the globe. More details about the ATT3CK
s
framework and how adversaries can be classified is available in OffSec’s SOC-200 course.
More recently, MITRE released a mirrored framoework from the defensive perspective. While
ATT3CK is meant to catalog and categorize the various ways that threat actors operate in the real
world, D3FEND105 portrays a set of best practices, actions, and methodologies employed by
n
defenders to prevent, detect, mitigate, and react to attacks.
Cyber Kill Chain: The Cyber Kill Chain106 is a methodology developed by Lockheed Martin to help
i
defenders identify and defend against cyber attacks. It outlines seven stages of the attack
z
lifecycle: reconnaissance, weaponization, delivery, exploitation, installation, command and control,
and actions on objectives.107
D
In the reconnaissance phase, an attacker identifies a target and enumerates potential
weaknesses through which it may be exploited. Weaponization is the process by which an attack
method to exploit this weakness is identified. This attack is launched in the delivery phase and, in
the exploitation phase, the payload is executed on the target system. This leads to the installation
stage in which malware is installed on the system. This malware is used to execute further
commands in the command and control phase. In the actions on objectives phase, the attacker
performs the actions required to achieve their ultimate goals, which may be data theft,
modification, destruction, etc.
FedRAMP: The Federal Risk and Authorization Management Program (FedRAMP)108 is a United
States program109 that provides a standardized security framework for cloud services used by the
103 (MITRE, 2022), https://www.mitre.org/
104 (MITRE, 2022), https://attack.mitre.org/
105 (MITRE, 2022), https://d3fend.mitre.org/
106 (Lockeheed Martin, 2022), https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html
107 (Crowdstrike, 2022), https://www.crowdstrike.com/cybersecurity-101/cyber-kill-chain/
108 (GSA, 2022), https://www.fedramp.gov/program-basics/
109 (GSA, 2022), https://www.gsa.gov/technology/government-it-initiatives/fedramp
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 53
Made in Morocco
Penetration Testing with Kali Linux
federal government. Whereas previously, a cloud service may have been required to obtain
different authorizations for different federal agencies, FedRAMP allows a cloud service to obtain a
single authorization for all government agencies. Its goal is to accelerate the government’s
adoption of cloud services while also ensuring that these services are secure. The controls are
based off of NIST SP 800-53 Revision 4 and enhanced by a number of additional controls that
pertain specifically to cloud computing. More details pertaining to cloud technology are explored
in OffSec’s CLD-100.
3.6 Career Opportunities in Cybersecurity