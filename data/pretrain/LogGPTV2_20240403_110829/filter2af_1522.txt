# 【技术分享】Gmail账户劫持漏洞（附演示视频）

## 译文声明
本文为翻译文章，原文来源于[SecurityFuse](http://blog.securityfuse.com/2016/11/gmail-account-hijacking-vulnerability.html)。译文仅供参考，具体表达和含义请以原文为准。

**翻译者：** [Twittered](http://bobao.360.cn/member/contribute?uid=245645961)

**稿费：** 90RMB（欢迎投稿！）

**投稿方式：**
- 发送邮件至 linwei#360.cn
- 或访问 [在线投稿页面](http://bobao.360.cn/contribute/index)

---

### 介绍
Gmail 允许用户通过多个邮箱关联其 Gmail 账户，并且允许一个邮箱使用多个地址。发往这些邮箱的邮件将被集中到同一个 Gmail 账户中。然而，这种模式在身份验证上存在风险，可能被攻击者利用来绕过认证过程。攻击者可以利用邮箱所有权验证中的漏洞，劫持电子邮件地址并用其发送邮件。

### 技术细节
在点击 Gmail 的设置按钮后，您会看到两个模块之一是“账户和导入”>“用这个地址发送邮件”。这里存在一个逻辑漏洞，使得攻击者能够劫持 Gmail 邮件地址。所有与 Gmail SMTP 相关的邮箱都受到影响，包括但不限于 @gmail.com、@googlemail.com 和 @googleemail.com 等。

当邮件无法成功投递时，Gmail 会返回一个包含状态的通知信息，解释为什么邮件未被送达。为了劫持一个邮箱，以下条件之一必须成立：
1. 收件人的 SMTP 服务器离线。
2. 收件人已停用其电子邮件账户。
3. 收件人不存在。
4. 收件人存在但阻止了邮件投递。
5. 其他可能导致邮件无法送达的情况。

在上述情况下，收件人无法收到任何邮件，而攻击者只需要一封包含退回通知的邮件。这封退回的邮件将包含一个验证代码和激活链接，用于关联无法访问的邮箱。此时，攻击者可以利用该验证码来验证并确认电子邮件地址的所有权，从而破坏验证流程。同样的漏洞也适用于邮件转发功能。

### 演示视频
（此处插入演示视频链接或嵌入视频）

### 时间轴
- 10月20日 - 向 Google 报告漏洞
- 10月20日 - 收到确认
- 11月1日 - 发布报告

### 结语
尽管我们没有因发现此漏洞获得报酬，但 Google 承认了我们的研究，并同意将其列入漏洞名人堂。