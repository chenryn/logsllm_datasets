y, (cid:27)(cid:14) ̸= (cid:27)
(cid:3)
(cid:3)
y; (cid:27)(cid:14);
(cid:3)
2 ; T
(cid:3)
1 ; T
(cid:3)
3 ; T
(cid:3)
x; (cid:27)
; (T
; (cid:27)
(cid:3)
1
(cid:12)(cid:12) holds. Moreover, the following lemmas hold.
For the advantage Advw-anon
(cid:5)FI;A ((cid:21)), Advw-anon
(cid:5)FI;A ((cid:21)) =
1=2
(cid:12)(cid:12)Pr[S0](cid:0)1=2
(cid:12)(cid:12) (cid:20)∑
13
ℓ=0
(cid:12)(cid:12)Pr[Sℓ](cid:0)Pr[Sℓ+1]
(cid:12)(cid:12)+
(cid:12)(cid:12)Pr[S14](cid:0)
(cid:12)(cid:12)Pr[S0](cid:0) Pr[S1]
(cid:12)(cid:12) (cid:20)
Lemma 4.8. Let qH be the number of A’s random oracle queries. Then, it holds that
qH =p for any PPT A.
Lemma 4.9. It holds that Pr[S1] = Pr[S2] for any PPT A.
Lemma 4.10. Let qH and qopen be the number of A’s random oracle queries and opening queries,
Lemma 4.11. It holds that Pr[S3] = Pr[S4] for any PPT A.
Lemma 4.12. There exists a PPT algorithm B1 such that
(cid:12)(cid:12) (cid:20) qH (cid:1) qopen=p for any PPT A.
(cid:12)(cid:12)Pr[S4] (cid:0) Pr[S5]
(cid:12)(cid:12)Pr[S2] (cid:0) Pr[S3]
(cid:12)(cid:12) = AdvDDHB1
respectively. Then, it holds that
((cid:21))
Lemma 4.8 to 4.12 can be proved as in the case of the anonymity (given in Section 4.1) since the
modi(cid:12)cation of each game is the same as that of the game in Theorem 4.1. Therefore, we omit these
proofs.
Lemma 4.13. It holds that Pr[S5] = Pr[S6] for any PPT A.
Proof. The diﬀerence between Game 5 and Game 6 is the way to generate the values H; K 2 G1. More
precisely, H; K are chosen from G1 uniform randomly in Game 5. On the other hand in Game 6, the
challenger chooses h; k 2 Zp uniform randomly and sets H   G1
k. However, since the
distribution of H; K is uniform in G1 in each game, Game 5 and Game 6 are identical. Therefore, it
holds that Pr[S5] = Pr[S6].
Lemma 4.14. There exists a PPT algorithm B2 such that
(cid:12)(cid:12)Pr[S6](cid:0)Pr[S7]
((cid:21)) for any PPT A.
(cid:12)(cid:12) (cid:20) AdvDLB2
h; K   G1
(a)
Proof. We de(cid:12)ne the event Bad
ℓ
as follows.
(a)
Bad
ℓ
: The event that the adversary A generates the related query in Type (a) to the Open oracle in
Game ℓ.
18
(cid:12)(cid:12) (cid:20) Pr[Bad
(cid:12)(cid:12)Pr[S6] (cid:0)
(a)
6 and Bad
(a)
7 occur. Therefore, we get
Game 6 and Game 7 are identical unless the events Bad
Pr[S7]
(a)
7 ] same as in Lemma 4.1.
(a)
In the following, we construct the algorithm B2 who tries to solve the DL problem in G1 by using A
7 ]. First, B2 receives the DL tuple G1; H 2 G1 and G2 2 G2. Now,
and estimate the probability Pr[Bad
B2’s goal is to compute the value logG1 H. Next, B2 generates the instance of the weak anonymity game.
Here for G1 2 G1; G2 2 G2 and H 2 G1, he uses the ones in the instance of the DL problem. Also, B2
samples k 2 Zp uniform randomly and sets K = G1
k 2 G1. Other elements are generated by following
the GKg algorithm. Let gpk = (G1; G2; G; H; H; K; Y; U; V ), ik = w, and ok = (u; v), B2 sends gpk to
the adversary A. Since possessing all keys which are needed to reply oracle queries, B2 can simulate the
replies of all queries. Especially, B2 generates the challenge signature as follows:
(cid:3)
2
2 Zp uniform randomly and compute (T
(cid:3)
1 ; T
(cid:3)
2 ; T
(cid:3)
3 ; T
(cid:3)
4 ) = (Aib
(cid:3)
(cid:1) K q
; Qib
(cid:3)
(cid:1) Gr
(cid:3)
; U r
;
1. Choose q
; r
; r
(cid:3)
(cid:3)
(cid:3)
2 ).
Gr
2. Choose (cid:27)
(cid:3)
(cid:3)
q ; (cid:27)
(cid:3)
x; (cid:27)
(cid:3)
(cid:3)
(cid:3)
(cid:14) ; (cid:27)
y; (cid:27)
r
x(cid:1)e(K; G2)(cid:27)
(cid:14) (cid:1)e(K; Y )
(cid:3)
r (cid:1) T
(cid:0)c
(cid:3)
(cid:3)
4 = V (cid:27)
4
(cid:3)
(cid:3)
.
G2)(cid:27)
and R
2 Zp and c
(cid:0)(cid:27)
(cid:3)
1 ; G2)(cid:27)
(cid:3) 2 Zp uniform randomly, and computes values R
(cid:3)
3 = U (cid:27)
(cid:3)
2 = G(cid:27)
q (cid:1)e(T
r (cid:1)T
(cid:3)
x+(cid:27)
y (cid:1)
(cid:0)c
, R
, R
(cid:3)
2
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
1 = e(H;
r (cid:1)T
(cid:0)c
(cid:3)
(cid:3)
(cid:3)
3
,
e(G1;G2)
(cid:3)
1 ;Y )
e(T
(
)(cid:0)c
);(cid:1)) is not de(cid:12)ned in the list L, the value ((gpk;
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
3. If the value ((gpk; T
4 ; R
3 ; T
2 ; T
1; R
1 ; T
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
4; m
); c
2; R
1; R
is set to be
3; R
T
1 ; T
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
(T
1 ; T
y; (cid:27)
r ). On the other hand, if such a value is already de(cid:12)ned, the
; (cid:27)
x; (cid:27)
(cid:14) ; (cid:27)
q ; (cid:27)
challenge signature is set to be ?.
(cid:3)
2; R
) is added to L and the challenge signature (cid:6)
(cid:3)
3 ; T
(cid:3)
3 ; T
(cid:3)
2 ; T
(cid:3)
2 ; T
(cid:3)
4 ; R
(cid:3)
4 ; c
(cid:3)
4; m
(cid:3)
3; R
(cid:3)
(cid:3)
(cid:3)
(cid:3)
Finally, A terminates witheb 2 f0; 1g.
(
r )) such that (cid:27)y ̸= (cid:27)
(cid:3)
1 (cid:0) kzib + (w + yib )(kq
(cid:3)
q , and ∆(cid:27)y = (cid:27)y (cid:0) (cid:27)
(cid:14) , ∆(cid:27)q = (cid:27)q (cid:0) (cid:27)
(cid:3)
(cid:3)
(cid:3)
(T
2 ; T
computes
(cid:3)
3 ; T
1
xib
h =
(cid:3)
When A generated the related query in Type (a) to the Open oracle, there is the Open query (m
(cid:3)
(cid:3)
1 ; T
(cid:3)
x; (cid:27)y; (cid:27)(cid:14); (cid:27)q; (cid:27)
(cid:3)
4 ; c
; (cid:27)
(cid:3)
(cid:3)
y and GVf(gpk; m
∆(cid:27)(cid:14) (cid:0) w∆(cid:27)q
)
; (cid:6)) = 1. For this query, B2
; (cid:6) =
+ k
where ∆(cid:27)(cid:14) = (cid:27)(cid:14) (cid:0) (cid:27)
(cid:3)
y. Then, he outputs h as the solution of the
DL problem. Since ib is an honest user, that is, ib 2 HU holds by the condition of the challenge query,
B2 knows the ib’s signing key gskib
= (Aib ; yib ; zib ; xib ; Qib ) and can compute the above h.
∆(cid:27)y
)
Now, we show the value h is the discrete logarithm of H in the following. Let T
(cid:3)
1 = G1
t. Since a
related query satis(cid:12)es Equation (2), it holds that
(cid:3)
(cid:14) (cid:1) e(K; Y )
(cid:0)(cid:27)
k; G2)(cid:27)
(cid:3)
q (cid:1) e(T
(cid:3)
1 ; G2)(cid:27)
(cid:14) (cid:1) e(G1
k; G2
(cid:3)
(cid:3)
y
(cid:0)(cid:27)
(cid:3)
q (cid:1) e(G1
(cid:3)
y
t; G2)(cid:27)
w)
Therefore, we get
G1
h = G1
k; G2)(cid:27)(cid:14) (cid:1) e(G1
(cid:0)(cid:27)q (cid:1) e(T
e(K; G2)(cid:27)(cid:14) (cid:1) e(K; Y )
(cid:3)
1 ; G2)(cid:27)y = e(K; G2)(cid:27)
, e(G1
(cid:0)(cid:27)q (cid:1) e(G1
k; G2
w)
t; G2)(cid:27)y = e(G1
, e(G1; G2)k(cid:27)(cid:14)(cid:0)kw(cid:27)q+t(cid:27)y = e(G1; G2)k(cid:27)
(cid:0)kw(cid:27)
(cid:3)
(cid:14)
, k(cid:27)(cid:14) (cid:0) kw(cid:27)q + t(cid:27)y = k(cid:27)
(cid:0) kw(cid:27)
(cid:3)
(cid:3)
q + t(cid:27)
y
, t = k
(cid:3)
(cid:3)
q +t(cid:27)
y
(cid:3)
(cid:14)
:
(cid:3)
1
xib
∆(cid:27)y
w∆(cid:27)q (cid:0) ∆(cid:27)(cid:14)
(
(
1(cid:0)kzib +(w+yib )(kq
(
1(cid:0)kzib +(w+yib )(kq
(
(cid:3) (cid:1) (T
(cid:0)zib (cid:1) (K q
G1 (cid:1) K
(cid:3)
1 )
G1 (cid:1) K q
(cid:3) (w+yib )
(
K zib (cid:1) (Aib
(cid:1) K q(cid:3)
G1