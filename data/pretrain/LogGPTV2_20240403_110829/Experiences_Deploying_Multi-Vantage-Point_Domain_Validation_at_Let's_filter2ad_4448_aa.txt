title:Experiences Deploying Multi-Vantage-Point Domain Validation at Let's
Encrypt
author:Henry Birge-Lee and
Liang Wang and
Daniel McCarney and
Roland Shoemaker and
Jennifer Rexford and
Prateek Mittal
Experiences Deploying Multi-Vantage-Point 
Domain Validation at Let’s Encrypt
Henry Birge-Lee and Liang Wang, Princeton University; Daniel McCarney, 
Square Inc.; Roland Shoemaker, unaffiliated; Jennifer Rexford and 
Prateek Mittal, Princeton University
https://www.usenix.org/conference/usenixsecurity21/presentation/birge-lee
This paper is included in the Proceedings of the 30th USENIX Security Symposium.August 11–13, 2021978-1-939133-24-3Open access to the Proceedings of the 30th USENIX Security Symposium is sponsored by USENIX.Experiences Deploying Multi-Vantage-Point Domain Validation at Let’s Encrypt
Henry Birge-Lee
Princeton University
Liang Wang
Princeton University
Daniel McCarney
Square Inc., Prev. Let’s Encrypt
Roland Shoemaker
Unafﬁliated, Prev. Let’s Encrypt
Jennifer Rexford
Princeton University
Prateek Mittal
Princeton Unversity
Abstract
An attacker can obtain a valid TLS certiﬁcate for a domain
by hijacking communication between a certiﬁcate authority
(CA) and a victim domain. Performing domain validation
from multiple vantage points can defend against these
attacks. We explore the design space of multi-vantage-point
domain validation to achieve (1) security via sufﬁciently
diverse vantage points, (2) performance by ensuring low
latency and overhead in certiﬁcate issuance, (3) manageability
by complying with CA/Browser forum requirements, and
requiring minimal changes to CA operations, and (4) a
low benign failure rate for legitimate requests. Our open-
source implementation was deployed by the Let’s Encrypt
CA in February 2020, and has since secured the issuance
of more than half a billion certiﬁcates during the ﬁrst year
of its deployment. Using real-world operational data from
Let’s Encrypt, we show that our approach has negligible
latency and communication overhead, and a benign failure
rate comparable to conventional designs with one vantage
point. Finally, we evaluate the security improvements using a
combination of ethically conducted real-world BGP hijacks,
Internet-scale traceroute experiments, and a novel BGP
simulation framework. We show that multi-vantage-point
domain validation can thwart the vast majority of BGP attacks.
Our work motivates the deployment of multi-vantage-point
domain validation across the CA ecosystem to strengthen
TLS certiﬁcate issuance and user privacy.
1 Introduction
Certiﬁcate Authorities (CAs) establish trust on the Internet
by associating domains with the correct public keys through
digitally signed certiﬁcates. A certiﬁcate contains domain
name(s) and the associated public key. The CAs must
ensure that a certiﬁcate is only given to the legitimate
owner of a domain. Otherwise, an adversary with a bogus
certiﬁcate could circumvent the assurances of conﬁdentiality
and integrity offered by HTTPS, and then decrypt or
modify sensitive user data (e.g., logins, ﬁnancial information,
cryptocurrency credentials [22]). To prevent these attacks,
CAs perform domain control validation that requires the
Figure 1: Domain control validation by Certiﬁcate Authority.
domain owner to demonstrate control of a core resource
associated with the domain (e.g., a web server, email address,
or DNS record).
1.1 Domain Validation Attacks and Defenses
Domain control validation is vulnerable to localized and
targeted Border Gateway Protocol (BGP) attacks that allow
adversaries to obtain bogus certiﬁcates [21,29]. These attacks
are possible because validation is often performed over
insecure HTTP connections (since domain validation is a
necessary step that must occur before establishing an HTTPS
connection). The BGP attack puts the adversary on the path
between the CA and the victim domain or the victim domain
and the CA. Then, the adversary asks the CA for a certiﬁcate
for the victim domain. The validation request (e.g., an HTTP
GET to the victim domain) is directed to the adversary where
it is maliciously answered (Figure 1). With its validation
request successful, the adversary can obtain a certiﬁcate for
the domain. These attacks are particularly effective because
the BGP attack can be localized (affecting the target CA)
and short-lived (during domain validation) but lead to the
adversary obtaining a universally-valid multi-year certiﬁcate
for the victim’s domain. These attacks are well within the
capability of repressive regimes which have been accused
of launching BGP attacks [26] and have motive to intercept
encrypted communications [1].
USENIX Association
30th USENIX Security Symposium    4311
CADomain’s web serverDomain owner1. Certiﬁcate request2. Challenge6. Certiﬁcate3. Server modiﬁcations4. HTTP GET (vulnerable to BGP hijacking)5. HTTP responseMultiVA design. Validating from multiple vantage points
seems like a simple idea. Yet, creating a production-grade
system is challenging, due to competing trade-offs:
• Security. The multiple vantage points must offer
sufﬁciently diverse perspectives on routing to ensure that
some vantage points can reach the legitimate domain.
Also, the quorum policy (i.e., the “vote” among the
vantage points before signing a certiﬁcate) must be
strong enough to thwart attacks, without sacriﬁcing
performance and robustness.
• Manageability. Validating from multiple vantage points
requires more server and network resources, spread
across more locations. This may require billing
arrangements with multiple cloud providers. In addition,
the CA/Browser forum, which decides the rules for the
operation of publicly trusted CAs, places security and
auditing requirements on the data centers CAs use [25].
Thus, a system with multiple vantage points may require
the maintenance and auditing of multiple data centers.
• Performance. The latency introduced by additional
vantage points should not signiﬁcantly slow down the
overall domain control validation process. Similarly, the
approach should have low communication overhead.
The implementation of multi-vantage-point domain
validation should also be incrementally deployable.
Performance constraints are particularly sensitive when
deploying on a live production system, requiring careful
system monitoring and a phased deployment.
• Benign failure. A benign (validation) failure is a non-
malicious validation request that should have been
successful but was blocked because of validation failures
caused by external factors in some vantage points. The
failures are mostly caused by DNS propagation delay
and conﬁguration errors; see §4.2. A multi-vantage-point
validation system should not throw a signiﬁcant number
of benign failures.
We explore the complex design space of multi-vantage-
point domain validation to balance the trade-offs among
these challenges. We propose to use a deployment of
multiple vantage points within a single cloud provider to
achieve good performance and manageability, as the site
reliability engineering (SRE) and billing departments only
need to interface with a single cloud provider. We satisfy
the compliance requirements imposed by the CA/Browser
forum by carefully tracking validation results from the
original CA and the cloud vantage points, respectively.
We carefully select cloud vantage points across diverse
geographic locations to ensure sufﬁcient diversity and system
security, and connect them to existing CA components using
mutually-authenticated TLS. Our design balances the number
and location of vantage points to control the trade-off between
security, manageability, performance, and benign failures.
More vantage points would improve security, but may increase
Figure 2: A localized BGP attack affects a portion of the
Internet. If the CA has only one vantage point (A), the
adversary successfully gets the certiﬁcate. With multiple
vantage points (B), the CA detects the attack as two vantage
points reach the legitimate server and fail the validations.
To mitigate these attacks, CAs need to defend themselves
from routing attacks on domain control validation. A
promising approach is to perform validation from multiple
diverse vantage points, to make it hard for the adversary’s
attack to “fool” all (or many) of the vantage points [21].
Vantage points unaffected by the BGP attack reach the
legitimate victim domain and observe that domain control
validation has not been completed (see Figure 2). This would
stop the CA from issuing a certiﬁcate to the adversary. With
effective multi-vantage-point validation in place, an adversary
only capable of launching localized BGP attacks will have
signiﬁcant difﬁculty obtaining a bogus certiﬁcate as the
adversary cannot have topological proximity to all of the
CA’s diverse vantage points. Thus, successful attacks would
require announcing BGP routes with broad scope (readily
visible in public BGP monitoring platforms [11, 13]), such as
advertising smaller sub-preﬁxes (which is infeasible for /24
IP preﬁxes).
1.2 MultiVA Design, Deployment, & Analysis
This paper presents the design and evaluation of multiVA,
the ﬁrst real-world deployment of the multi-vantage-point
countermeasure to secure domain control validation.
4312    30th USENIX Security Symposium
USENIX Association
Victim domain ACert request:I own domain ADecision:Two validation failuresCan’t issue the certChallengeResponseValidation OKCert request:I own domain A1ChallengeResponseValidation OKValidation failValidation failChallengeChallenge??12Validation2Validation33Decision:Validation OKIssue the certVictim domain AAdversaryAdversaryCACA(A)(B)VP1VP1VP2VP3Internet NOT aﬀected by the adversary’s BGP attacksInternet aﬀected by the adversary’s BGP attacksvalidation overhead and manageability difﬁculty. Finally, we
incorporate a conﬁgurable domain validation quorum policy
to strike a balance between security and benign failures.
MultiVA deployment. We develop a fully open-source
implementation of our multiVA design. Notably, our imple-
mentation does not require any changes to the Automated
Certiﬁcate Management Environment (ACME) [19]. We
build upon the Boulder ACME implementation [3] and only
modiﬁed software components relevant to domain validation.
Our open-source implementation was deployed by the Let’s
Encrypt CA [15] in its live production environment in
February 2020. Since then, our multiVA deployment has
secured the issuance of over half a billion TLS certiﬁcates
during the ﬁrst year of its deployment, and validates domain
control for approximately 1.5 million certiﬁcates a day [8].
Our work thus demonstrates the feasibility of the multiVA
approach at Internet scale and represents a major step in
strengthening the Internet PKI against BGP attacks.
Evaluating system performance and benign failures. We
obtained operational data for the multiVA deployment from
Let’s Encrypt and use it to analyze system performance and
benign failures. We ﬁnd that the system incurs negligible
latency overhead since (1) validations from multiple vantage
points occur in parallel and (2) validation time from well
connected cloud-based vantage points is much faster than
the validation time from the existing CA vantage point. We
measured the communication overhead of the deployment
for typical certiﬁcate issuance rates as 0.5 Mbps per remote
vantage point (far below the saturation point of 100 Mbps
upstream links). Finally, we show that the rate of benign
failures incurred by the multiVA deployment is around 1%.
These benign failures are typically caused due to DNS
propagation delays and conﬁguration issues, and typically
can be overcome by retrying the certiﬁcate issuance request.
Evaluating system security. Unlike performance metrics
like latency and benign failure rate which can only be
measured with real data from an active deployment, the
security offered by multi-vantage-point domain validation
cannot be understood from deployment data alone. Many
important security questions, like the fraction of attacks that
can be mitigated, quorum policies to use, and placement
of additional vantage points, cannot be answered solely by
relying on deployment data, and instead require combining
multiple analytic perspectives.
Our approach is to analyze multi-vantage-point validation
holistically across many different analytical frameworks
including ethically conducted real-world attacks, deployment
metrics, Internet-scale traceroute measurements, and novel
BGP attack simulations. By comparing the data produced
in these different settings, we can reason holistically about
how to optimally evaluate and deploy multi-vantage-point
validation. We show that our multiVA deployment that uses
a single cloud provider can successfully mitigate a vast
majority of BGP attacks (additionally see Table 3 for a
summary of lessons learned through design, deployment,
and evaluation aspects of this project). Finally, we also
make recommendations for further enhancing the multiVA
deployment via additional diverse vantage points.
We hope our work motivates industry-wide adoption of
multiVA in the CA ecosystem to strengthen the PKI and
protect user privacy, and this work is a key ﬁrst step. We
have released our multi-vantage-point domain validation
implementation as open-source software [6], and are working
on standardizing it.
2 Let’s Encrypt Certiﬁcate Management
Let’s Encrypt is an automated CA that requires no human
interaction to request or renew a certiﬁcate [15]. According
to CloudFlare [10], Let’s Encrypt accounts for over 70% of
daily certiﬁcate transparency log entries. Thus, Let’s Encrypt
has a major inﬂuence on the CA market. 1
Let’s Encrypt simply exposes a standardized API—the Au-
tomated Certiﬁcate Management Environment (ACME) [19]—
for third-party clients (e.g., EFF’s Certbot [5]) to access.
The Boulder ACME implementation. Let’s Encrypt is
powered by an open-source ACME implementation called
Boulder [3], designed for security, reliability, and performance.
To date Boulder has issued over a billion trusted certiﬁcates.
Boulder is subdivided into components based on their role
in the certiﬁcate issuance process and to minimize the attack
surface between components and the global Internet. Each
component is designed to be deployed in isolated network
segments with strict ﬁrewall rules limiting ingress/egress
trafﬁc based on the API exposed by the components.
As in Figure 4 (A), the primary system components
of Boulder include Web Front End (WFE), Registration
Authority (RA), Validation Authority (VA), and Certiﬁcate
Authority (CA). We omit additional components not speciﬁc
to validation/issuance (e.g., storage). Of all the components
in Boulder, only the web front end requires inbound trafﬁc
from the wider Internet allowed for the ACME API interface.
Similarly only the VA requires outbound trafﬁc to arbitrary
hosts on the wider Internet to perform domain validation.
During certiﬁcate issuance ACME clients interact with
the web front end to submit a to-be-signed certiﬁcate,
following the process described in the ACME RFC [19].
The web front end interacts with the resource authority to
associate accounts with authorizations and other resources.
The resource authority in turn interacts with the VA to request
domain validation. The VA performs the validation and sends
the validation result to the resource authority. The resource
1Some websites like w3techs.com inaccurately show low market share
for Let’s Encrypt (e.g., 0.2%) because they only count certiﬁcates that chain
directly to Let’s Encrypt’s ISRG root. In fact, the vast majority of certiﬁcates
Let’s Encrypt issues are chained through IdenTrust’s DST X3 root certiﬁcate.
USENIX Association
30th USENIX Security Symposium    4313
Lesson Learned
Design and Deployment
- Requiring successful domain validation from the primary VA satisﬁes CA/Browser Forum requirements
- A phased deployment helps understand and address failure scenarios before starting enforcement
Performance Evaluation
- Benign failures are uncommon and are usually mitigated by the quorum policy
- DNS synchronization delays are responsible for a large fraction of the benign failures
- Packet ﬁlters that block domain validation requests lead to some benign failures