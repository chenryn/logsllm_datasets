利用和攻击（在后面的内容中将深入讨论这个话题）之外，许多攻
击常常涉及到肉鸡的使用。
攻击者通过引诱未引起警觉的用户下载恶意代码来创建肉鸡，通过
肉鸡服务器的命令把用户的计算机变成肉鸡。在安装了肉鸡之后，
2274
---
## Page 2276
被感染的肉鸡计算机与肉鸡服务器进行联系，并下载其他组件或者
获取最新的命令，例如发动拒绝服务攻击或者发送垃圾邮件。有了
这种动态的控制和命令基础设施之后，肉鸡的主人可以用几分钟的
时间把大量的计算资源从Intermet的一个角落移动到另一个角落。应
该注意到，控制服务器本身可能并不是静态的。肉鸡已经从一种静
态的控制基础设施演变为一种对等的结构，以实现容错和逃避检
测。当一台服务器被检测并被阻塞之后，另一台服务器可以介入并
接管前者的任务。控制服务器在被盗用的计算机上运行或者通过代
理运行也是常见的做法，这样肉鸡主人的身份就很滩被发现。
肉鸡常常通过与它们的创建者的公共IRC服务器使用相同的方法进行
通信。但是，最近我们看到了一些肉鸡的触角伸到了P2P、HTTPS、
SMTP和其他协议。通过这些实时的通信基础设施，肉鸡服务器向肉
鸡发送指令、漏洞和代码修改。因此，肉鸡可以接受指令启动垃圾
邮件发送、DDoS、数据偷窃、钓鱼或点击式欺诈攻击。肉鸡已经成
为计算机犯罪领域中功能最丰富的攻击载体之一。
4.2回报
根据AegenisGroup（http://www.aegenis.com/）的报告，2007-2008期
间一张支付卡的黑市价值的估计售价大约在$4和S6之间。具有价格
标签的支付卡磁条数据的售价在$25和$35之间，取决于信用限制以
及支付卡的类型。足够开通银行账户的完整信息（包括生日、住址
和社会保障号码）的售价大约是$200到S300。
黑市上还常常出售像驾驶证号码、社会保障卡以及PayPal或eBay账
户这样的私人数据。驾驶证或出生证明的售价可达S100，PayPal和
eBay账户也可以卖到S5到$10。
因此，一个能够利用一个未打补丁的漏洞从任何地方窃取信息的恶
意软件根据效果可以卖到$20000到$40000。肉鸡装备软件（例如漏
洞利用和肉鸡代理代码）在黑市上的售价大约是S5000到$10000
私人数据和数据盗窃恶意软件日益上升的黑市价值创造了专注于交
易金融信息的犯罪行业（即前面所提到的信息商）。TX和
HannafordBrothers的事件仅仅是冰山的一角，问题的主体还没有被
公众所理解。在接下来的几节中，我们将探索地下网络的数据搜集
游戏，并探讨他们怎样把这些数据变成利润丰厚的生意。
2275
---
## Page 2277
4.2.1数据交换
下面是一段被捕捉的IRC谈话的片断，对话发生在一位信息商和一位
消费者之间：
出售拥有几百个cvv2、银行账号和金融机构识别码的在线商店
的管理员密码。我接收第一方支付（WU/E-Gold）。另外，希望用
cvv2交易（WEBSITE）账户。
这位信息商可能通过黑客的手段获取了一家在线商店的信用卡和支
票账户信息，更有可能是从一位实际侵入该商店的黑客手中购买了
这些信息。购买和出售金融信息仍然是这个地下市场排名第一的活
动。被盗用的信息在被使用之前常常会被转手数次。
值得引起警惕的是，为什么会有如此众多的"完整”私人信息挂牌出
售呢？这类信息几乎包括了个人身份的所有方面，也就是申请账
户、通过简单的网络认证以及在线购买商品所需要的所有信息。下
面是地下交易渠道的一个被捕捉到的广告（实际细节被隐藏）：
完整信息出售
姓名：JohnSmith
地址1：XXXSMiddlefieldRoad
城市：XXX
州：CA
邮政编码：XXXXX
国籍：美国
生日：04/07/19XX
社会保障号码：XXX-XX-5398
母亲的姓：Jones
驾驶证的号码：XXXX24766
2276
---
## Page 2278
驾驶证所在的州：CA
信用卡号码：XXXXXXXXXXXX2134
信用卡品牌：Visa
过期日期：10/2010
CVV号码：178
信用卡银行名称：Citibank
私密问题1：你的第一辆汽车的型号和品牌是什么？
私密问题1的答案：Geo,Prism
私密问题2：你的第一个宠物的名字叫什么？
私密问题2的答案：Sabrina
可以看到，处理这些信息的人可以轻松地认定信息所有人的身份。
像基于知识的认证（KBA）这样使用私密问题的机制对于保护被窃
信息是没有用处的。
4.2.2信息来源
信息商是从什么地方获取这些数据的呢？它的一些来源包括：
金融机构
金融机构是非常有吸引力的目标，因此它们保存了诈骗者进行金融
犯罪时所需要的所有信息。由于这个原因，在线银行网站经常受到
攻击。犯罪分子伺机寻找“漏洞”，窃取Web服务器后端的顾客数据。
商店
许多零售商（不论是网店还是实体店）在保护安全和数据隐私方面
措施不力，因此是私人金融数据窥视者所关注的重要目标。TJX和
HannafordBrothers所发生的数据泄漏就是因为安全措施不得力所
致。
2277
---
## Page 2279
个人持卡人
用户桌面上的间谍软件、键盘记录器和跟踪软件（pharmware）是泄
漏私人数据的另一通道。
钓鱼
钓鱼网站伪装成合法的商业网站，引诱用户泄漏像登录ID和密码这
样的私密信息。钓鱼仍然是一个广泛存在的安全威胁，尤其那些对
计算机不太熟悉的用户。
4.2.3攻击向量
当前的地下网络玩家使用许多攻击方法搜集数据。我将列出其中一
些较为著名的方法。但是还有许多已经被观察到的神秘手法超出了
本书的范围。
利用网站的漏洞
易受攻击的网站（特别是金融机构的网站和在线电子商务的网站）
常常是通向有价值数据的直接通道。由于运行软件的Web服务器发
布SQL命令提取和修改内部数据库（例如敏感的顾客信息），因此
数据库，提取它所选择的数据。
最近，一家著名的女性服装商店受到他们的Web应用程序防火墙生
产商的通知，他们的Web应用程序中的SQL注入错误可能导致他们的
整个顾客数据库被盗用，包括信用卡号码、PIN码和地址。
当前，致力于Wweb应用程序安全的厂商通过扫描发现许多（而不是
一例两例）针对现有Web应用程序的漏洞所进行的SQL注入攻击，这
是司空见惯的事情。随着Web2.0的问世以及它仍然显得神秘的安全
代码开发方式，我们对于许多Web应用程序很容易受到数据窃贼的
攻击不应该感到奇怪。
一个巨大的金矿。我们知道有些组织提供了自动化方法和手工方法
对Internet进行持续扫描，寻找易受攻击的网站。
恶意软件
2278
---
## Page 2280
当今的许多Intermet犯罪可以追溯到某种形式的恶意软件。例如，安
装在用户计算机上的间谋软件可以窃取硬盘上的私密信息，例如社
会保障号码、信用卡信息和银行账户信息。注入式IFrame是恶意软
件的一种形式，它一般寄生于服务器上，可以捕捉用户的登录信息
以及浏览器和服务器之间的其他用户通信信息。创建肉鸡的恶意软
件安装在用户的计算机上之后经常会被唤醒，参与用户所不知情的
肉鸡活动。
当前散布恶意软件最流行的方法是通过Web。当浏览Web的用户接触
到被散布的恶意软件或者恶意站点时，可能会导致他们的计算机遭
到恶意软件的注入。这类注入在很多情况下并没有任何视觉线索，
如果没有特殊的检测工具，很难发现它们。
一个令人忧心的趋势是，我们发现越来越多合法的网站无意识地参
与到恶意软件的传播中。注入网站的恶意软件（例如前面所提到的
的第三方站点。根据著名搜索引擎的报告，排名前一百万名的网站
（根据该搜索引擎的页面排名算法）中，有超过6000个网站在某个
方面被列为是“恶意"的。它们有许多都是合法的网站，只是在某个
时刻被盗用。社交网络站点和高容量的电子商务站点已经成为恶意
软件散布的热点。
根据Symantec在2007年的报告，每天发现的新的恶意软件实例高达
1950个！图4-1显示了2005年到2007年新的恶意软件的校正增长率，
来源于Sophos、Symantec和PandaLabs所报告的数字。在这张图中，
三家厂商中最保守的Sophos报告最近两年新的恶意软件的年增长率
超过100%。PandaLabs报告恶意软件从2006年到2007年的增长率达
到了令人震惊的800%。
2279
---
## Page 2281
图4-1恶意软件程序的估计（校正）增长率
大量的增长来自于同种恶意软件的变型数量的增加。也就是说，一
次写成的恶意软件可以呈现为多种形式，以逃避签名检测。事实
进行变形的方法导致基于签名的检测方式儿乎毫无意义。
由社会垃圾邮件所推动的钓鱼威胁
垃圾邮件在Web上产生了更大的钓鱼威胁。今天的许多垃圾邮件本
身并不携带实际的恶意软件，而是诱使用户访问钓鱼网站或者布满
恶意软件的网站。
另一种可见的趋势是定向垃圾邮件攻击的增加，也就是向一组对某
个特殊领域怀有兴趣的接收者发送经过特别筛选的垃圾信息。例
如，向老年市民发送节省处方药的信息以及向股民发送热点股市信
2280
---
## Page 2282
息是常见的做法。这种针对性的垃圾邮件的成功率要高得多，它使
钓鱼成为一种充满生机的攻击方法。
在过去的几年里，反垃圾邮件技术取得了显著的进展。但是，
Intermnet上的垃圾邮件的绝对数量自2005年以来还是增加了一倍。这
个事实凸显了许多反垃圾邮件系统所存在的限制。
4.2.4洗钱游戏
使地下网络经济切实可行的一个重要步骤是把金融欺诈的成果变成
实际可用的现金。这并不是一个无足轻重的步骤，它涉及从合法的
金融机构提取现金。
地下网络最有价值的财富之一就是所谓的“掩护"账户，可以安全地
通过它进行转账和取款。这种账户往往是前面所讨论的出纳员的，
它是可以分得一杯囊的参与者所拥有的合法账户。
假设黑客Johnny具有20位美国银行顾客的完整账户信息。Johnny可以
创建一个银行转账，从这些（他可以访问的）被盗用的账户转账到