masSEXploitation
The Rook
http://ppdhuluperak.gov.my
Defaced!
… and the next day....
PHPNuke.org too!?
Eleonore Exploit Pack.
 “What I cannot create, I do not 
understand.”
  – Richard Feynman
Why?
Overview
“Layers of 
security.”
--Unkown
“Complexity is the 
worst enemy of 
security.”
--Bruce Schneier
ManageEngine Firewall Analyzer 5
 CSRF
 Execute SQL quires (Not injection)
 Create a new administrative account
 XSS
 The results from a sql query
 SELECT “”
Profense Web Application Firewall
 "Defenses against all OWASP Top Ten 
vulnerabilities"
 CSRF - CVE-2009-0468
 Proxy for MITM
 Configuration changes
 Shutdown the machine (DoS)
 Reflective XSS - CVE-2009-0467
The PHP-Nuke Exploit
(Aug 2009)
● PHP-Nuke 8.1.35
● (User account Required!)
●
SQL Injection 
●
Get admin
●
Broken admin
●
Path disclosure
●
Filter Bypass
●
Another sql injection
●
Local File Include
(Nov 2004)
● PHP-Nuke 7.0
●
SQL Injection
●
Get admin
●
Broken admin
●
Enable phpBB
●
Filter Bypass
●
Eval()
The PHP-Nuke Exploit
The PHP-Nuke Exploit
The PHP-Nuke Exploit
● (OWASP A1)  SQL Injection 
● (OWASP A3)  Broken Authentication 
● (CWE-200)    Information Exposure
● (CWE-436)    Filter Bypass
● (OWASP A1)  SQL Injection (Again!)
● (CWE-98)      Local File Include (LFI)
The PHP-Nuke Exploit
The PHP-Nuke Exploit
● (OWASP A1)  SQL Injection 
● (OWASP A3)  Broken Authentication 
● (CWE-200)    Information Exposure
● (CWE-436)    Filter Bypass
● (OWASP A1)  SQL Injection (Again!)
● (CWE-98)      Local File Include (LFI)
DEMO!
Fruit Analogy
PHP-Nuke Exploit
 OWASP A1: Injection
● SQL Injection in the Journal module to 
get administrative credentials
PHP-Nuke Exploit
 OWASP A3:
Broken Authentication and Session 
Management
●
●
●
●
● Shortcut to admin privileges
PHP-Nuke Exploit
 PHP-Nuke Login:
 Secure Login:
Overview
● PoC Exploit:
PHPSecInfo Rocks!
Demo!
 Why 2 sql injection exploits?
●(CWE-436)Filter Bypass
 '%20union%20'
 '*/union/*'
 ' union '
●(CWE-436)Filter Bypass
 '%20union%20'
 '*/union/*'
 ' union '
  PHPMyAdmin CSRF+SQLi=RCE (CVE-2008-5621)
PHP-Nuke Exploit
 PHP Local File Include->Remote Code 
Execution.
 AppArmor will not allow MySQL write 
to /var/www/  (Even if its chomd 777!)
PHP-Nuke Exploit
 SQL Injection To create a file in /tmp/
 AppArmor allows this.
 Local File Include to execute the file in 
/tmp/
SELinux doesn't allow this!
PHP-Nuke Exploit
● Eval() and preg_replace /e
● SELinux does not stop this.
Study in Scarlet 
(http://www.securereality.com.au/studyinscarlet.txt)
PHP-Nuke Exploit
END