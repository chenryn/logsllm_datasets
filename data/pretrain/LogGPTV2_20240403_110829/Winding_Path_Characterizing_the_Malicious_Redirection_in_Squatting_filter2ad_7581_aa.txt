title:Winding Path: Characterizing the Malicious Redirection in Squatting
Domain Names
author:Yuwei Zeng and
Xunxun Chen and
Tianning Zang and
Haiwei Tsang
Winding Path: Characterizing
the Malicious Redirection in Squatting
Domain Names
Yuwei Zeng1,2, Xunxun Chen1,3, Tianning Zang1,2(B), and Haiwei Tsang4
1 Institute of Information Engineering, Chinese Academy of Sciences, Beijing, China
{zengyuwei,zangtianning}@iie.ac.cn
2 School of Cyber Security, University of Chinese Academy of Sciences,
3 National Computer Network Emergency Response Technical Team/Coordination
Beijing, China
Center of China, Beijing, China
4 Jilin University, Changchun, China
Abstract. An increasing number of adversaries tend to cover up their
malicious sites by leveraging the elaborate redirection chains. Prior works
mostly focused on the speciﬁc attacks that users suﬀered, and seldom
considered how users were exposed to such attacks. In this paper, we con-
duct a comprehensive measurement study on the malicious redirections
that leverage squatting domain names as the start point. To this end, we
collected 101,186 resolved squatting domain names that targeted 2,302
top brands from the ISP-level DNS traﬃc. After dynamically crawling
these squatting domain names, we pioneered the application of perfor-
mance log to mine the redirection chains they involved. Afterward, we
analyzed the nodes that acted as intermediaries in malicious redirec-
tions and found that adversaries preferred to conduct URL redirection
via imported JavaScript codes and iframes. Our further investigation
indicates that such intermediaries have obvious aggregation, both in the
domain name and the Internet infrastructure supporting them.
Keywords: Domain squatting · URL redirection
1 Introduction
URL redirection has been widely used since its inception. With this technique,
website administrators are able to provide more customized navigation services
for visitors by specifying certain parameters in the URL (e.g., language). Instead
of directly typing the lengthy URL into the browser’s address bar, users can
walk through diverse web resources easily with the help of URL redirection.
However, this technique is now being abused by adversaries to circumvent static
web security checks [18]. Compared with directly delivering malicious content
to any visitor, this method is able to ensure the targeted delivery of malicious
content by conducting multi-layer veriﬁcation during the process of visitors being
c(cid:2) Springer Nature Switzerland AG 2021
O. Hohlfeld et al. (Eds.): PAM 2021, LNCS 12671, pp. 93–107, 2021.
https://doi.org/10.1007/978-3-030-72582-2_6
94
Y. Zeng et al.
Fig. 1. An example of malicious redirection. The domain name of the start URL is a
combo squatting of ‘nike.com’.
redirected [13,25]. For instance, the adversary checks whether the current visitor
is a static crawler by inspecting the ‘User-Agent’ ﬁeld of HTTP request header.
Although an elaborate redirection chain can boost the stealth of the malicious
site to some extent, it lowers the accessibility of that site as well. Therefore, in
order to get more traﬃc, some adversaries have targeted the squatting domain
names [23]. Domain squatting refers to the impersonation of particular brands at
the domain level, so as to confuse visitors. For instance, ‘bauidu.com’ is a typo
squatting of ‘baidu.com’, which targets the user who extra types a character ‘u’
while entering ‘baidu.com’. By exploiting these squatting domain names as the
start node of redirection chains, adversaries can arbitrarily control the direction
of careless visitors, and even determine the malicious behavior to be performed
based on the proﬁle of visitors.
To facilitate the understanding of such malicious redirections, we present a
real-world example in Fig. 1, which abuses a combo squatting domain name of
‘nike.com’ as the start node. To prevent the relevant malicious domain names from
being further spread, we have hidden some characters in Fig. 1. This example con-
tains 7 URLs and 6 hops, of which the ﬁrst hop uses the HTTP-based redirection
with 302 status code, while the remaining ﬁve hops are all performed via certain
JavaScript codes. Before reaching the ﬁfth URL, there is nothing displayed on the
page. After rendering the HTML content returned by the ﬁfth URL, a loading bar
and a button appear on the page (Page A). If the user does not click the button
within a given time, this page will auto-redirect the user to the next page (Page
B), which lists several links to illegal gambling sites. Similarly, if the user does not
interact with this page within a given time, he will be redirected to the ﬁnal URL,
which serves an illegal pornographic site (Page C).
Prior works have analyzed various types of squatting domain names. How-
ever, all of these works focus on the speciﬁc malicious behaviors involved in
such domain names (e.g., phishing) [14,23]. So far, nobody has paid attention
to how visitors are transferred from the squatting domain names to the sites
Winding Path
95
that actually conduct malicious activities. In this paper, we ﬁrst lift the veil of
such malicious intermediaries in malicious activities, namely the relay nodes in
malicious redirections. To this end, we make the following contributions: First,
we measure the typical squatting domain names in Chinese DNS traﬃc; Second,
we pioneered the application of performance log to mine malicious redirection
chains; Third, we accurately analyze the redirection method abused by malicious
intermediaries; Fourth, we proﬁle the sharing of such intermediaries in malicious
redirections.
2 Background
2.1 Domain Squatting Abuse
Domain squatting abuse refers to the malicious preemptive registration of
domain names that are similar to well-known brands. According to prior works,
there are six types of commonly-seen domain squatting abuse in the Internet
today, comprising typo [7,22], bit [20], homograph [11], combo [15], level [10],
and wrong-TLD [23]. Here, we use the real-world examples listed in Table 1 to
explain the deﬁnition of each squatting type.
Table 1. Examples of diﬀerent squatting types.
# Domain
1 bauidu.com
2
taocao.com
3 xvide0s.com
4 nikeav.com
Target
Type
baidu.com typo
taobao.com bit
xvideos.com homograph
nike.com
combo
5 weixin.qq.com.powlau.kunxiangrunhe.com.cn qq.com
level
6
cnki.xyz
cnki.net
wrong-TLD
– Typo: Users may request incorrect domain names due to the careless typing.
Typo squatting leverages this “fat ﬁnger” phenomenon of users when they are
typing the domain names, which involves the following four typo scenarios:
insertion, omission, permutation, and replacement. The ﬁrst sample in Table 1
is a typo squatting of ‘baidu.com’, which additionally inserts a character ‘u’
between ‘a’ and ‘i’ (‘u’ is adjacent to ‘i’ on the keyboard).
– Bit: The bit may be ﬂipped during the transmission due to some external
reasons. Bit squatting leverages such bit-ﬂip phenomenon occurring in domain
names. As the second sample in Table 1, which ﬂips the lowest bit of ‘b’
(01100010) from 0 to 1 to get the character ‘c’ (01100011).
– Homograph: Homograph squatting refers to the replacement of characters
in target brands with other visually indistinguishable ones. Take the third
sample in Table 1, the squatter uses the digit ‘0’ to imitate the character ‘o’.
96
Y. Zeng et al.
– Combo: Combo squatting is to combine the target brand with other words to
form a new domain name. Compared with the other ﬁve types, combo squat-
ting is capable of maintaining the integrity of target brands to the greatest
extent, so as to resort to their reputations to attract users. For example, the
fourth sample attaches the word ‘av’ to the tail of ‘nike’ to form an easy-to-
remember domain name of an adult site.
– Level: As opposed to the above four squatting types that tampering with the
2LD, level squatting focuses on its own subdomain. That is, adversary uses the
intact target domain name as its subdomain. For example, the ﬁfth sample in
Table 1 directly uses ‘weixin.qq.com’ as its subdomain. In certain cases where
the complete domain name cannot be displayed because of space limitation,
users can only see the preﬁx part of the domain name, thus mistaking it for
Tencent’s authoritative domain name.
– Wrong-TLD: Wrong-TLD squatting refers to replacing the TLD of tar-
get domain name while maintaining the remainder of this domain name
unchanged. As the last sample shown in Table 1, it impersonates the tar-
get domain name by replacing the TLD ‘.net’ with ‘.xyz’. Compared with the
above ﬁve squatting types, this type is the most confusing to users.
2.2 URL Redirection
URL redirection technique has been widely used in a variety of web activities,
making the Internet users navigate between various web resources without man-
ually typing the lengthy target URL into the address bar. There are three main
types of redirection approaches at present, namely HTTP-based, JavaScript-
based, and HTML-based. Table 2 lists some examples to illustrate these redirec-
tion approaches.
Table 2. Illustration of the URL redirection approaches.
Redirection Example
HTTP
JavaScript
HTML
Status Code: 30X Location: http://domain.com/
Refresh: 2; url = http://domain.com/
document.location = ‘http://domain.com/’
window.location = ‘http://domain.com’
– HTTP-based: HTTP-based redirection has two forms: 1). When the requested
resource is migrated to a brand new URL, to ensure the old URL is still
available, the server will write the current URL of the requested resource in
the ‘Location’ ﬁeld of corresponding HTTP response message, and set the
status code to 30X; 2). The server ﬁlls in the ‘Refresh’ ﬁeld of the HTTP
Winding Path
97
Response Header to command the client to request the given URL after a
given time. For example, the second sample in Table 2 indicates that the
current page will be navigated to “http://domain.com” right after 2 s.
– JavaScript-based: This approach refers to rewriting the ‘location’ attribute
of current document (or window) object to target URL through JavaScript
scripts, and then redirecting the current page to the target URL. Compared
with HTTP-based redirection, this approach gives developers more autonomy,
enabling the redirection to be triggered only when certain conditions are met.
– HTML-based: HTML-based redirection mainly refers to the user’s active click
on the  tag on current page to perform the page jump. The ‘href’ ﬁeld of
 tag indicates the destination of the page jump. Besides, there is another
case of HTML-based redirection, that is, by adding a -refresh tag
below the  tag. In speciﬁc, by setting the ‘http-equiv’ attribute of
 to ‘refresh’, and specifying the waiting time and target URL in its
‘content’ attribute. The browser will automatically jump to the speciﬁed URL
after parsing the  tag.
3 Measurement Methodology
This section ﬁrst introduces the approach we employ to collect resolved squatting
domains from real DNS traﬃc. Then, we describe the dynamic crawling strategy
we use to get the redirection chain behind these domains.
3.1 Measuring Squatting Domains
Intuitively speaking, the higher the popularity of target domain names, the
greater the probability of relevant squatting domains being visited. Therefore,
we ﬁrst collected the domain name of target brands from three authoritative
data sources:
– Alexa Category List: Alexa provides 17 category lists, such as arts, business,
and computers. Each of them lists the 50 most visited domain names in the
category [3]. We crawled this site and ﬁnally obtained a total of 850 candidate
brand domain names.
– Alexa Top List: Alexa maintains a domain popularity ranking based on the
daily traﬃc of each domain name [1]. We extracted the Top-1000 from this
list as candidates.
– CN Top List: Since our experiment was conducted on a Chinese network envi-
ronment, it is clear that we can observe more squatting domains speciﬁcally
targeting Chinese brands. Therefore, we got domain names of the Top-1000
Chinese sites from an authoritative organization [4].
Due to the day-to-day ﬂuctuation of the domain top List [21], here we
obtained the Alexa Lists for 8 consecutive days from [2] (the dates of these
lists are consistent with the dates of DNS traﬃc we use), and extracted the
98
Y. Zeng et al.
Fig. 2. Breakdown of diﬀerent squatting
types.
Fig. 3. Breakdown of the labeling results.
1000 domains with the highest overall ranking. We aggregated the above list
and merged the domain names that had the same 2LD (e.g., ‘tmall.com’ and