that can contain 264 unique hosts) suggests that within-network
spoofing maybe easier. To infer filtering granularity, the client
sends a series of spoofed-source packets that flip bits of the client’s
true address at byte boundaries. This allows us to test the nearest
adjacent address outside of a particular prefix mask.
A single Spoofer client may use many different IPv6 addresses in
the same /64 prefix over time, due to the common operating system
practice of using privacy extensions to assign an ephemeral lower
64bits to an IPv6 address [41]. While we may receive multiple test
results from a single client with different ephemeral addresses, each
result is representative of the policy of the same /64. We therefore
aggregate clients into /64s in order to not bias our results.
Figure 10 shows the cumulative fraction of 15,202 unique IPv6
client /64s that could not spoof arbitrary source addresses, but
could spoof within some limited range of addresses (as imposed
by the filtering granularity). 70% of IPv6 clients were able to spoof
sources within their /64, but not outside it. However, 21% of clients
could spoof outside their /64, most commonly for /56 and /48. This
matches common operator policy; some providers assign customers
allocations of these common sizes [42]. In this sense, filtering in
IPv6 is tighter and constrains an attacker to use addresses within
Figure 10: Inferred granularity of IPv6 filtering, restricted
to clients that could not spoof arbitrarily, collected between
March 2017 and August 2019. While 70% of clients could only
spoof sources within their own /64, 21% could spoof outside
it; ≈9% were unable to spoof any address.
their own /64 prefix, which, since it is tied to the customer, does not
afford anonymity or the ability to perform random source spoofing.
Interestingly, ≈9% of clients cannot spoof at all, and are tied to
their /128. All tests from the most frequent prefixes from which
these clients tested were similarly constrained to use only their
assigned /128 address. Note that whereas we frequently observe
IPv4 clients being tied to a single address (their /32), primarily
because of facilities built into DOCSIS [8], individual IPv6 client
networks are frequently allocated /64 prefixes and can use any
source address within that prefix.
Via personal contact, we learned that one instance of this strict
IPv6 filtering is due to an OpenVPN setup. In other cases, we hy-
pothesize that equipment strictly enforces the binding between
assigned address (either via neighbor discovery or DHCP6) and
source address. Indeed, we confirmed the use of “IPv6 source and
prefix guard” – a mechanism to enforce exactly these bindings and
prevent spoofed IPv6 traffic [11] – with one network operator.
Filtering Location. We examined 16,998 unique client tests
6.2.2
and 5,687 distinct /64 IPv6 client prefixes to understand the location
of SAV filtering in IPv6. These 16,998 tests come from implementing
tracefilter [6] on the Spoofer platform and deploying it during the
period October 2017 to August 2019. Tracefilter works in a fashion
similar to traceroute, but reveals the location of SAV filtering.
Figure 11 shows the SAV filtering hop – relative to the source –
for IPv4 with and without NAT, and for IPv6 client prefixes inferred
by tracefilter. While clients in 35% of IPv6 prefixes hit a filter at
the first hop, most (≈52%) were filtered at the second hop. We
hypothesize that this is due to the common residential deployment
scenario where the CPE is the first hop and the second hop is the
provider’s router, where SAV is deployed.
While more than 50% of filtering occurs at the second hop in IPv6,
70% of IPv4 SAV is deployed at the first hop. To better understand
how IPv6 and IPv4 SAV differ, we examined the difference in filter
location. We found nearly 80% of the clients with IPv6 have spoofed
packets filtered one hop further into the network as compared to
IPv4 – likely the result of the fact that residential CPE acts as a
router for IPv6, rather than a NAT. Thus, the provider’s router,
which is two hops from the client, performed the filtering.
to spoofout of their /64~21% could spoofin their /64spoof addresses~70% could~9% unableany addressUnique /64s/56/64/72/80/96/112/128IPv6 SAV GranularityCumulative FractionClients/40/32 1 0.8 0.6 0.4 0.2 0/48Figure 11: Inferred location of SAV filtering for clients that
performed both IPv4 and IPv6 tracefilter tests from October
2017 to August 2019.
Inter-Protocol Dependence. Finally, we explore the extent to
6.2.3
which IPv6 SAV depends on having IPv4 SAV configured properly,
and vice versa. To compute the conditional probabilities, we first
find the class priors and joint probability based on frequency. We
then simply divide the joint probability by the prior probability per
basic probability axioms. For example the probability that IPv6 is
blocked, but IPv4 is unblocked is:
P(v4 = received|v6 = blocked) = P(v4 = received ∧ v6 = blocked)
We excluded tests where a NAT rewrote addresses, and only
considered tests where a client tested both IPv4 and IPv6. We ag-
gregated the client’s IPv4 and IPv6 addresses to their /24 and /40
prefixes, and only count each pair of IPv4, IPv6 prefix once using
the most recent results for the pair. Because not only addresses,
but also prefixes, are frequently dynamic in IPv6, we excluded tests
where the IPv4 to IPv6 prefix mapping was not one-to-one.
P(v6 = blocked)
Figure 12 shows the matrix of conditional probabilities for IPv4
and IPv6 filtering for the year ending August 2019. The probability
that IPv6 was not filtered given that IPv4 SAV was in place is small,
only 5%. However, the converse is not true; the probability that
IPv4 was filtered given that IPv6 was not filtered is still 46%. And,
if IPv6 was filtered, there is a high (90%) chance that IPv4 is also
filtered. Interestingly, we saw a fair amount of inconsistency in IPv6
filtering when IPv4 is unfiltered; frequently IPv6 was filtered when
IPv4 was not. These results suggest that operators conscientious
enough to deploy SAV for IPv4 are savvy enough to also do so for
IPv6, and some operators are protecting IPv6 before ensuring IPv4
is filtered. In contrast, prior work found that many IPv6 networks
were relatively open relative to their IPv4 counterparts [13].
7 ANALYSIS OF REMEDIATION EFFORTS
If we receive packets with spoofed source addresses from a client at
a given attachment point, but do not in subsequent tests from the
same attachment point, then we infer an operator has performed
remediation. Ideally, one could undertake A/B testing to measure
the effect of various interventions on remediation. However, we
cannot do follow-up tests ourselves; we must rely on our crowd-
sourced volunteers to re-test the same network.
We have had three distinct remediation phases in the project. In
May 2016, we began contacting networks where we had at least one
Figure 12: Conditional probability between IPv4 and IPv6
SAV outcomes for clients with both address types for the
year ending August 2019.
Apr 2018 NANOG (US, Canada), NLNOG (Netherlands)
May 2018 NZNOG (New Zealand), AusNOG (Australia),
Jun 2018
Jul 2018
Sep 2018
Oct 2018
UKNOF (United Kingdom)
GTER (Brazil)
DENOG (Germany)
SGOPS (Singapore)
SANOG (South Asia), PacNOG (Pacific Islands),
NOG.cl (Chile)
JANOG (Japan), Gore (Spain)
FRnOG (France)
LUNOG (Luxemborg)
Nov 2018
Dec 2018
Jan 2019
Feb 2019 MENOG (Middle East), ITNOG (Italy),
Mar 2019
Jul 2019
Bolivia-NOG, ArNOG (Argentina)
IDNOG (Indonesia)
INNOG (India, from SANOG)
Table 3: The 20 Network Operator Groups covering 62 coun-
tries to whom we sent automatic geographically-scoped
emails every month, as of August 2019.
test showing that the network did not filter packets with spoofed
source addresses. We contacted the network abuse contact address
registered in WHOIS, falling back to the technical contact if there
was no abuse contact, or the technical contact registered in Peer-
ingDB. We provide an example private notification email in ap-
pendix A. Then in April 2018, we began publishing geographically
scoped reports of remediated and still-spoofing-capable networks
to regional network operator group (NOG) email lists on a monthly
basis, while continuing to privately notify networks. We provide
an example public notification email in appendix B. Table 3 lists the
full set we cover as of August 2019; we sent our NOG notifications
using an appropriate translation for the country. Finally, we ceased
sending private notifications in December 2018.
In total, we inferred 587 instances where a network hosting a
Spoofer client transitioned from forwarding spoofed packets to
our system, to not doing so. Figure 13 shows that 24.0% of the re-
mediations blocking outbound spoofing occurred within a day of
the first test and 35.4% within a week, indicating that an operator
used our system to check for and deploy SAV. 48.2% of the remedi-
ation events we inferred took at least 1 month from the time we
received the spoofed packet to when we inferred an operator had
deployed SAV. Prior work observed remediation to vulnerabilities
such as Heartbleed [16] occurring within a shorter period of time,
IPv4 w/o NAT 0.2 0.4 0.6 0.8 1 1 2 3 4 5 6Inferred Filter Hop (from client)Cumulative FractionIPv6 /64IPv4 w/ NAT 0Filtv6Unfilt100.90.46010.10.540.950.66100.050.3401givenProbabiltiy ofv4 Filtv4 Unfiltv6 Filtv6 Unfiltv4Filtv4Unfiltv6Figure 13: Delay between receiving a packet with a spoofed
source address and remediation. Of the 587 remediations
blocking outbound spoofing between May 2016 and August
2019, 35.4% occurred within a week, implying operators used
the Spoofer client to check for and deploy SAV.
Figure 14: Cumulative private notifications and remediation
inferences between May 2016 and August 2019. The num-
ber of outbound remediations we infer per month doubled
when we began sending monthly NOG emails in April 2018.
consistent with the self-defense, i.e., incentive-aligned, motive for
such remediation. It is difficult to separate the effect of a private
notification from other forces we do not observe in the 50% of cases
that took more than a month to remedy; in line with prior work,
we rarely received any response to our notifications.
Figure 14a shows the cumulative private notifications we sent
over time; we sent bursts of private notifications at different times
(November 2016, October 2017, January 2018, and September 2018).
Figure 14b shows the cumulative deployment of SAV for outbound
spoofed packets over time; there were no corresponding bursts
of remediation observed in figure 14b, leading us to believe the
private notifications had limited impact. Further, the number of
remediations we infer per month doubles from 10.6 remediations
Figure 15: Cumulative distribution of outbound remediation
events per country between May 2016 and August 2019.≈90%
of the remediation events in Brazil occurred after we began
publicly sending monthly emails to GTER.
per month to 21.5 beginning April 2018 when we started publish-
ing reports to NOG email lists, implying that public notification is
more effective in promoting deployment of SAV. Figure 14c shows
the cumulative deployment of SAV on inbound spoofed packets
over time. We do not publicly reveal the SAV policy of individual
networks on inbound packets for ethics reasons, as these represent
a vulnerability to the network itself. Private notifications appar-
ently had an impact on deploying SAV on inbound packets: when
we stopped them in December 2018, the number of remediations
reduced to one per month until April 2019. However, the burst of
inbound remediation beginning April 2019 is not connected to any
activity by the project.
Of the 587 remediation events we inferred between May 2016
and August 2019, 25.2% occurred in the U.S., and 23.5% occurred in
Brazil. Figure 15 shows that nearly 90% of the remediation events
in Brazil occurred after we began sending monthly emails to GTER.
We calculate the remediation rate by dividing the number of ASes
for which we inferred a remediation event by the total number of
ASes that sent a spoofed packet during the same interval. For the
year prior to commencing the GTER emails to Brazilian network
operators, 14 of 67 ASes (21%) remediated; in the year after, 52 of 168
ASes (31%) remediated. This improvement is supported by NIC.br’s
“Program for a Safer Internet” [45], which offers training courses
and lectures to support network operators to deploy security best
practices in Brazil. The rate of remediation in the U.S. is lower; prior
to sending the NANOG emails to U.S. network operators, 21 of 132
(16%) of ASes remediated; in the year after, 35 of 147 (24%) of ASes
remediated. While the rate of remediation is lower in the U.S. than
Brazil, the relative improvement in both is equivalent – ≈50%.
Figure 16 shows two metrics that reflect the effectiveness of our
system at reducing the spoofed address attack surface in the Inter-
net. The purple line is the cumulative distribution of the widest IPv4
prefix a client can spoof after remediation. Half of the remediations
resulted in the client being unable to use any address apart from
their single assigned address; the remainder are covered by filters
that defined a range of valid addresses at the attachment point. This
class of remediation represents a total of 0.13% of the total routed
IPv4 address space. Because this statistic is dominated by clients
only able to use their assigned address, and it is unlikely that an
operator deployed SAV on a single network port, we also plot the
distribution of the longest matching prefix in BGP corresponding
Delay between first receiving and remediation 0.2 0.4 0.6 0.8 11hour1day1wk1mo6mo2yrCumulative FractionInbound to Client, N=87Outbound from Client, N=587 0Cumulative FrequencyemailsNOGNANOGRemediationRemediationNotifications(a) Cumulative Private(c) Cumulative Inbound(b) Cumulative Outbound010020030040050001020304050607080Jul’16Jan’17Jul’17Jan’18Jul’18Jan’19Jul’191.8K1.6K1.4K1.2K1.0K0.8K0.6K0.4K0.2K0GTERNANOGU.S, N=14800.20.40.60.81Jul’16Jan’17Jul’17Jan’18Jul’18Jan’19Jul’19Brazil, N=138Cumulative FractionOther, N=301Figure 16: Distribution of remediation prefix length for IPv4
outbound remediations between May 2016 and August 2019.
We plot the widest prefix from which the client can spoof af-
ter remediation (cumulatively representing 0.13% of the to-
tal routed address space), and the size of the longest match-
ing prefix corresponding to the client (cumulatively, 3.01%).
Figure 17: For 4,480 unremediated IPv4/24 between May
2016 and August 2019, the distribution of unremediated net-
work size (prefix length). We plot the size of the longest
matching prefix corresponding to the client (cumulatively,
8.14% of the routed address space).
to the client’s IPv4 address, which sums to 3.01% of the total routed
IPv4 address space.
While we inferred remediation in 352 IPv4/24, we found 4,480
IPv4/24 with no evidence of remediation – 12.7 times as many
IPv4/24. Figure 17 shows the corresponding network sizes for the
unremediated networks. Relative to figure 16, the sizes of the longest
matching prefixes are similar, suggesting that the size of a prefix is
not a limiting factor in the operators’ ability to deploy SAV. This
space sums to 8.14% of the total routed IPv4 address space. Finally,
figure 18 shows that of the /24 prefixes where we had multiple tests
showing SAV had not been deployed, 21.0% had been unremediated
for at least six months.
8 MOVING THE NEEDLE
Persistent lack of source address validation represents one of many
failures of market forces to incentivize best security practices in the
Internet ecosystem. Although the Internet engineering standards
community has developed technical solutions to the spoofing vul-
nerability inherent in the IP architecture, gaps in SAV compliance
still allow spoofed DoS attacks to grab headlines on a regular basis.
Figure 18: For 2,030 unremediated IPv4/24 with multiple pos-
itive spoofing tests between May 2016 and August 2019, the
distribution of unremediated duration. 21.0% have been un-