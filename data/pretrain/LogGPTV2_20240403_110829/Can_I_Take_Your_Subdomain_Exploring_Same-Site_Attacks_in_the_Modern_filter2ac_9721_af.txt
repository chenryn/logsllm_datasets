1998.
[11] Bugcrowd. Public Bug Bounty List. https://www.
bugcrowd.com/bug-bounty-list/, 2020.
[12] M. Bugliesi, S. Calzavara, R. Focardi, and W. Khan.
CookiExt: Patching the Browser Against Session Hijack-
ing Attacks. Journal of Computer Security, 23(4):509–
537, 2015.
[13] S. Calzavara, R. Focardi, N. Grimm, M. Maffei, and
M. Tempesta. Language-Based Web Session Integrity.
In CSF, 2020.
[14] S. Calzavara, R. Focardi, M. Squarcina, and M. Tem-
pesta. Surviving the Web: A Journey into Web Session
Security. ACM Computing Surveys (CSUR), 50(1):13:1–
13:34, 2017.
[15] S. Calzavara, A. Rabitti, and M. Bugliesi. Semantics-
Based Analysis of Content Security Policy Deployment.
ACM Transactions on the Web, 2018.
[16] S. Calzavara, A. Rabitti, A. Ragazzo, and M. Bugliesi.
In ES-
Testing for Integrity Flaws in Web Sessions.
ORICS, 2019.
[17] Censys. https://censys.io/, 2020.
[18] J. Chen, J. Jiang, H. Duan, T. Wan, S. Chen, V. Pax-
son, and M. Yang. We Still Don’t Have Secure Cross-
Domain Requests: an Empirical Study of CORS. In
USENIX Security, 2018.
[19] Common Crawl.
Host-
Web Graphs Feb/Mar/May
//commoncrawl.org/2020/06/host-and-domain-
level-web-graphs-febmarmay-2020/, 2020.
and Domain-Level
2020.
https:
[20] M. Conca.
Changes to SameSite Cookie Be-
to Action for Web Developers.
havior – A Call
https://hacks.mozilla.org/2020/08/changes-
to-samesite-cookie-behavior/, 2020.
[21] L. Daigle. RFC3912: WHOIS Protocol Speciﬁcation,
2004.
[22] EdOverﬂow. can-i-take-over-xyz. https://github.
com/EdOverflow/can-i-take-over-xyz.
[23] E. Foudil and Y. Shafranovich. A File Format to Aid in
Security Vulnerability Disclosure, 2020.
[24] FreeDNS. Free DNS Hosting, Dynamic DNS Hosting,
Static DNS Hosting, subdomain and domain hosting.
https://freedns.afraid.org/, 2020.
USENIX Association
30th USENIX Security Symposium    2931
[25] P. Hallam-Baker, R. Stradling, and J. Hoffman-Andrews.
RFC8659: DNS Certiﬁcation Authority Authorization
(CAA) Resource Record, 2019.
[26] S. Helme. Cross-Site Request Forgery is dead! https:
//scotthelme.co.uk/csrf-is-dead/, 2017.
[27] IANA. Root Zone Database. https://www.iana.org/
domains/root/db.
[28] P. Kintis, N. Miramirkhani, C. Lever, Y. Chen, R. R.
Gómez, N. Pitropakis, N. Nikiforakis, and M. Anton-
akakis. Hiding in Plain Sight: A Longitudinal Study of
Combosquatting Abuse. In CCS, 2017.
[29] P. Kocher, J. Horn, A. Fogh, D. Genkin, D. Gruss,
W. Haas, M. Hamburg, M. Lipp, S. Mangard, T. Prescher,
M. Schwarz, and Y. Yarom. Spectre Attacks: Exploiting
Speculative Execution. In S&P, 2019.
[30] C. Lever, R. J. Walls, Y. Nadji, D. Dagon, P. D. Mc-
Daniel, and M. Antonakakis. Domain-Z: 28 Registra-
tions Later Measuring the Exploitation of Residual Trust
in Domains. In S&P, 2016.
[31] E. P. Lewis. RFC4592: The Role of Wildcards in the
Domain Name System, 2006.
[32] F. Li, Z. Durumeric, J. Czyz, M. Karami, M. Bailey,
D. McCoy, S. Savage, and V. Paxson. You’ve Got Vul-
nerability: Exploring Effective Vulnerability Notiﬁca-
tions. In USENIX Security, 2016.
[33] D. Liu, S. Hao, and H. Wang. All Your DNS Records
Point to Us: Understanding the Security Threats of Dan-
gling DNS Records. In CCS, 2016.
[34] D. Liu, Z. Li, K. Du, H. Wang, B. Liu, and H. Duan.
Don’t Let One Rotten Apple Spoil the Whole Barrel:
Towards Automated Detection of Shadowed Domains.
In CCS, 2017.
[40] C. Osborne.
to Subdomain Takeover.
Uber Patches Security Flaw
Leading
ZDNet,
https://www.zdnet.com/article/uber-patches-
security-flaw-leading-to-subdomain-
takeover/, 2017.
[41] OWASP.
Amass.
project-amass/, 2020.
https://owasp.org/www-
[42] V. L. Pochat, T. V. Goethem, S. Tajalizadehkhoob,
M. Korczy´nski, and W. Joosen. Tranco: A Research-
Oriented Top Sites Ranking Hardened Against Manipu-
lation. In NDSS, 2019.
[43] Rapid7 Labs. Open Data, TCP and UDP scans. https:
//opendata.rapid7.com/, 2020.
[44] C. Reis, A. Moshchuk, and N. Oskov. Site Isolation:
Process Separation for Web Sites within the Browser.
In USENIX Security, 2019.
[45] R. Roberts, Y. Goldschlag, R. Walter, T. Chung, A. Mis-
love, and D. Levin. You Are Who You Appear to Be: A
Longitudinal Study of Domain Impersonation in TLS
Certiﬁcates. In CCS, 2019.
[46] S. Roth, T. Barron, S. Calzavara, N. Nikiforakis, and
B. Stock. Complex Security Policy? A Longitudinal
Analysis of Deployed Content Security Policies.
In
NDSS, 2020.
[47] S. Röttger and A.
Janc.
A Spectre proof-
https:
for a Spectre-proof web.
of-concept
//security.googleblog.com/2021/03/a-
spectre-proof-of-concept-for-spectre.html,
2021.
[48] L. Schwittmann, M. Wander, and T. Weis. Domain
Impersonation is Feasible: A Study of CA Domain Vali-
dation Vulnerabilities. In EuroS&P, 2019.
[49] Sectigo. Crt.sh: Certiﬁcate search. https://crt.sh/, 2020.
[35] G. Meiser, P. Laperdix, and B. Stock. Careful Who You
Trust: Studying the Pitfalls of Cross-Origin Communi-
cation. In ASIA CCS, 2021.
[50] S. Son and V. Shmatikov.
The Postman Always
Rings Twice: Attacking and Defending postMessage
in HTML5 Websites. In NDSS, 2013.
[36] P. Mockapetris. RFC1035: Domain Names - Implemen-
tation and Speciﬁcation, 1987.
[37] Mozilla. Mixed content.
https://developer.
mozilla.org/en-US/docs/Web/Security/Mixed_
content.
[38] Mozilla. Public Sufﬁx List. https://publicsuffix.
org/.
[39] M. Nottingham. RFC8615: Well-Known Uniform Re-
source Identiﬁers (URIs), 2019.
[51] M. Steffens and B. Stock. PMForce: Systematically
In CCS,
Analyzing postMessage Handlers at Scale.
2020.
[52] B. Stock, G. Pellegrino, F. Li, M. Backes, and C. Rossow.
Didn’t You Hear Me? - Towards More Successful Web
Vulnerability Notiﬁcations. In NDSS, 2018.
[53] B. Stock, G. Pellegrino, C. Rossow, M. Johns, and
M. Backes. Hey, You Have a Problem: On the Fea-
sibility of Large-Scale Web Vulnerability Notiﬁcation.
In USENIX Security, 2016.
2932    30th USENIX Security Symposium
USENIX Association
[54] The Chromium Projects. SameSite Updates. https:
//www.chromium.org/updates/same-site, 2020.
[55] W3C. Content Security Policy Level 3. https://www.
w3.org/TR/CSP3/, 2018.
[56] J. Walker. Subdomain Autoﬁll Feature Raises Ques-
tions over LastPass Security. https://portswigger.
net/daily-swig/subdomain-autofill-feature-
raises-questions-over-lastpass-security.
[57] L. Weichselbaum, M. Spagnuolo, S. Lekies, and A. Janc.
CSP Is Dead, Long Live CSP! On the Insecurity of
Whitelists and the Future of Content Security Policy. In
CCS, 2016.
[58] M. Weissbacher, T. Lauinger, and W. K. Robertson. Why
Is CSP Failing? Trends and Challenges in CSP Adoption.
In RAID, 2014.
[59] M. West and J. Wilander. RFC6265: Cookies: HTTP
State Management Mechanism, 2020.
[60] Wired. Researchers’ Typosquatting Stole 20 GB of E-
Mail From Fortune 500. https://www.wired.com/
2011/09/doppelganger-domains/, 2011.
[61] M. Zhang, X. Zheng, K. Shen, Z. Kong, C. Lu, Y. Wang,
H. Duan, S. Hao, B. Liu, and M. Yang. Talking with
Familiar Strangers: An Empirical Study on HTTPS Con-
text Confusion Attacks. In CCS, 2020.
[62] X. Zheng, J. Jiang, J. Liang, H. Duan, S. Chen, T. Wan,
and N. Weaver. Cookies Lack Integrity: Real-World
Implications. In USENIX Security, 2015.
A Disclosure and Ethical Considerations
RDScan identiﬁed 1,520 vulnerable subdomains on 887 dis-
tinct domains, of which 260 are subdomains pointing to an
expired domain and 1,260 are those mapped to a discontin-
ued service (see §4.2). Besides disclosing the vulnerabili-
ties found on service providers (§5.1.2), we also attempted
to notify all the websites affected by the issues we discov-
ered. Prior work [32, 52, 53] showed that the identiﬁcation
and selection of correct security contact points is the main
issue behind an overall unsatisfactory remediation rate. To
maximize the chances of a successful notiﬁcation campaign,
we examined the following sources until a valid point of
contact was found: (i) the list of bug bounty and security
disclosure programs maintained by Bugcrowd [11]; (ii) the
security.txt ﬁle [23] in the root directory of the vulnerable
domains and under the /.well-known/ folder [39]; (iii) the
Abusix [3] database, queried with the ip addresses of the
vulnerable domains to collect the associated email contacts;
(iv) a WHOIS lookups [21]. We validated the obtained email
addresses to avoid reporting vulnerabilities to unrelated par-
ties, e.g., by checking whether the domain part of the email
address matches any of the input domains. Unfortunately,
using this procedure we could not ﬁnd any security contact
for the majority of the considered domains (62%). To inform
them about their security vulnerabilities, we contacted our
national CERT that willingly agreed to disclose the issues to
the affected parties on our behalf. Among the few contacted
websites with a bug bounty program, F-Secure awarded us
with e250 for the reported subdomain takeover vulnerability.
Aside from vulnerability disclosure programs, our notiﬁ-
cation campaign is fully automatic: we sent an email to all
the identiﬁed contacts containing a high-level description of
the vulnerabilities and a link to the security advisory on our
web application which contains a detailed description of the
problems found for a given domain, the required actions to ﬁx
the reported vulnerabilities, and instructions to opt out from
future scans.
A.1 Outcome of the Notiﬁcation Campaign
We performed a second run of RDScan on January 2021, 6
months after the ﬁrst analysis, to picture the state of vulnera-
ble instances left in the wild after our disclosure. We repeated
the test for the whole set of expired domains instances. Con-
cerning discontinued services, we focused on the 3 largest
providers (WordPress, Shopify and Tumblr), representing 87%
of the vulnerable subdomains found in the ﬁrst round. Overall,
we covered 1362 out of the original 1520 vulnerable subdo-
mains (90%), which translates to 781 out of 887 sites (88%).
To account for possible changes in services occurred in the
meanwhile, we veriﬁed the takeover preconditions included
in RDScan. After the conclusion of the analysis, we manually
assessed a random sample of 10% of the results to ensure the
correctness of the procedure without ﬁnding any discrepancy.
We discovered that only 200 out of 1362 subdomains (15%)
have been ﬁxed during this time frame, for a total of 125 sites
over 781 (16%). We noticed that the sites which we contacted
directly exhibit a noticeably higher ﬁx rate (31% subdomain,
22% sites) than those alerted by our national CERT (10%
subdomains, 14% sites). Unfortunately, we also observed
that a considerable amount of sites ﬁxed only a subset of
their vulnerable subdomains, resulting still affected by threats
posed by related-domain attackers.
The overall remediation rate of our notiﬁcation campaign is
in line with previous studies [53]. Nonetheless, we report that
our procedure to identify appropriate contact points turned out
to be successful considering that 34% of the contacted parties
accessed the full vulnerability report on our web application.
A.2 Ethical Considerations
We consciously designed our vulnerability scanning frame-
work to avoid raising network alerts or causing harm to the
USENIX Association
30th USENIX Security Symposium    2933
analyzed targets. Speciﬁcally, the subdomain takeover assess-
ment phase has been carried out mostly by DNS queries and
simple HTTP requests. Active websites have never been af-
fected by our tests since we restricted the analysis to aban-
doned DNS records. We did not perform any large-scale
portscan, but we opted, instead, for using a public dataset
consisting of a scan of the full IPv4 range on 148 ports.
We also avoided checking the availability of IP addresses
on cloud providers by iterating over the creation of multiple
virtual machines, since this practice could interfere with the
normal operations of the cloud platforms. Similarly, the web
analysis module did not execute attacks against the targets, but
limited its operations to the passive collection of data (cookies
and security policies), simple HTTP requests, and client-side
testing. Overall, our approach proved to be lightweight and
unobtrusive: we did not receive requests from the analyzed
websites to opt out from future scans, and no complaints
concerning our activity were sent to the abuse contact of the
IPs used to perform the analysis.
B Case Studies
We report on manually vetted case studies of conﬁrmed at-
tacks. All vulnerable parties have been promptly informed of
the discovered issues, see Appendix A for details.
B.1 Site Impersonation
We provide a concrete example of how the Shopify vulnera-
bility described in §5.1.2 could have been abused to imper-
sonate a major website. As of September 2020, the e-shop
of fox.com was hosted on Shopify and made available at
shop.fox.com using a custom domain mapping. Our scan
veriﬁed the two preconditions to connect www.shop.fox.com
to a Shopify store under our control, i.e., the existence of a
DNS A record pointing the domain www.shop.fox.com to
23.227.38.65 (the IP address owned by Shopify to map cus-
tom domains) and that www.shop.fox.com was not associ-
ated with any registered store on Shopify.
We manually investigated the e-shop of fox.com and
found that the redirection performed by Shopify from
www.shop.fox.com to shop.fox.com caused the www-
preﬁxed subdomain to be referenced in the store as a le-
gitimate URL.3 By taking over www.shop.fox.com, crim-
inals could have abused this implicit trust to mount severe
attacks against the legitimate store, such as phishing, reputa-
tion damage, and credential stealing. We notiﬁed the vulnera-
bility to Shopify on August 27, 2020 and received a bounty
for our disclosure. Around one month after the report, we
noticed that FOX moved its e-shop to a different domain
3See
https://web.archive.org/web/20200113052608/https:
//shop.fox.com/pages/faq for a page mentioning www.shop.fox.com.
(maskedsingershop.com). We have no evidence to assert
whether this change is connected to our disclosure.
B.2 Session Hijacking
We describe an example of a subdomain takeover vulnera-
bility that could have been exploited to hijack authenticated
user sessions at the FedEx website. RDScan discovered a
dangling DNS affecting the cn.grantcontest.fedex.com
subdomain due to a CNAME record pointing to the purchasable
domain cngrantcontest.com.
After taking control of the subdomain, attackers could es-
calate their privileges by exploiting the insecure conﬁguration
of session cookies on the main website. We manually veriﬁed
that authenticated sessions with www.fedex.com were built
upon domain cookies, which are sent by default to all subdo-
mains (see §3.3.2). Thus, authenticated users would disclose
their session cookies to the attackers just by visiting the com-
promised subdomain. After acquiring the victim’s cookies, an
attacker could automatically break into the victim’s session
and access conﬁdential data stored on the web portal. We no-
tiﬁed FedEx about the takeover vulnerability in August 2020.
The company acknowledged our ﬁndings and, as of January
2021, we conﬁrmed that the vulnerability was ﬁxed.
B.3 Leakage of PII data
Now we show how a related-domain attacker can abuse mis-
conﬁgurations in the CORS policy to access personally iden-
tiﬁable information (PII) of a user on the F-Secure website.
Our vulnerability scanning pipeline detected a CNAME record
uk.safeandsavvy.f-secure.com pointing to the deleted
WordPress blog at safeandsavvyuk.wordpress.com. No-
tice that subdomains of deleted blogs still resolve to a Word-
Press IP thanks to a CNAME wildcard for *.wordpress.com.
To take over the F-Secure subdomain, an attacker could
simply create an account on wordpress.com and set
uk.safeandsavvy.f-secure.com as a custom domain.
We observed that WordPress allows paid accounts to install
plugins which enable the inclusion of arbitrary scripts as part
of the blog’s theme. The ability to execute JavaScript from
a subdomain of f-secure.com would allow attackers to ex-
ploit a CORS vulnerability identiﬁed by our web analyzer
on api.my.f-secure.com. Such domain was conﬁgured to
relax the SOP on requests originating from any subdomain
of f-secure.com, even when cookies are attached. An at-
tacker could trick a victim into visiting a page on the compro-
mised subdomain which performs a fetch request to, e.g., the
https://api.my.f-secure.com/get_userinfo endpoint
to read private information such as past billing details, tokens,
etc. We notiﬁed F-Secure through their bug bounty program
in August 2020 and received e250 for the report.
2934    30th USENIX Security Symposium
USENIX Association