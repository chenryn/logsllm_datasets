Phone number
14
Call logs
SMS logs
5
1
non-mobile or mobile). To better analyze the nature of these prominent threats,
we further classify the top 15 threats (either mobile-only or cross-device threats)
aﬀecting the most number of mobile devices in the network into four diﬀerent
classes based on unique characteristics exhibited by each threat as shown in
Table 2. We now describe the characteristics of each of these malware categories
and how they aﬀect end users:
Trojan Threats: These programs deliberately cause harm to a user device while
posing to be a benign application such as a free anti-virus solution. The harm
can be either in terms of allowing unauthorized remote access to the device,
hijacking device resources, turning the device into a bot/proxy, stealing user
information etc. This class of malware is observed to be the most eﬀective form
of threat currently aﬀecting mobile devices. Interestingly, through the course of
our analysis, we detected instances of the Zeus trojan aﬀecting 82 distinct iOS
based mobile devices in the network. Although mobile variants of this threat
aﬀecting other platforms such as Windows Mobile and Android have been seen
in the wild, to the best of our knowledge, this is the ﬁrst time a variant of this
threat was identiﬁed aﬀecting iOS devices [10]. Unfortunately, we were not able
to explore characteristics of this malware variant further due to limitations in
the dataset.
Privacy Leakage Threats: Threats which maliciously leak IMEI (Interna-
tional Mobile Equipment Identity) number or device location information in the
HTTP headers or URI aﬀect over 1200 unique mobile devices, making this one
of the most prevailing attacks targeting mobile devices in our dataset. Although
traditional desktop malware which leak sensitive user data exist, this problem
is more pronounced in the mobile ecosystem. This may be due to the sensitive
nature of data stored on mobile devices which attackers deem valuable, issues of
application over-privilege in some mobile platforms, and the availability of third
party app stores which facilitates deploying such malicious applications. Table 3
categorizes the types of privacy leakage issues revealed in our ground truth data.
Clearly, information such as those presented above would potentially allow an
attacker to uniquely observe a targeted user and his activities, making this a
serious violation user privacy.
Adware and Potentially Unwanted Applications (PUA): This class of
applications sneak into a device deceptively and get installed in such a way that
Uncovering the Footprints of Malicious Traﬃc in Cellular Data Networks
77
Table 4. Aﬀected mobile platforms
Device platform
% Total devices % Infection rate % Mobile alerts
iOS
Android
Windows
RIM OS
40.57 %
20.09 %
0.2 %
0.08 %
0.22 %
0.39 %
0.12 %
0.32 %
Custom Feature Phone OS
39.06 %
0.0009 %
and Others
53.12 %
45.74 %
0.76 %
0.15 %
0.21 %
it can be diﬃcult to detect and remove. The primary motive of these programs
is to display unwanted advertisements to users, often in the form of pop-up ads.
While some of these apps may just be a minor irritant to the user, they may,
in some cases, also act as dangerous spyware that monitor user behavior and
collect data without consent.
SIP Threats: Session Initiation Protocol (SIP) is widely used for controlling
multimedia communication sessions such as VoIP calls over the internet. Our
results indicate that vulnerabilities in this protocol is seen to be a popular tar-
get for attackers seeking to exploit mobile devices. These are alarming trends
since such vulnerabilities can potentially give attackers the ability to listen-in on
conﬁdential voice communications or launch denial of service attacks as reported
in previous studies [11,12].
3.3 Infection Rates of Popular Mobile Platforms
The question of which mobile platforms are most vulnerable to security threats
has been a hot topic of debate for several years. We attempt to answer this
question by utilizing ground truth data obtained from the operational cellu-
lar network. Table 4 presents the following data points: (a) The proportion of
devices belonging to each identiﬁable mobile platform in our dataset; (b) The
proportion of devices of a given platform that are infected, or the infection rate;
and, (c) The proportion of alerts observed in the ground truth originating from
a given platform.
We observe from the second column of the table that Android is the most
vulnerable platform with a 0.39 % infection rate. This infection rate is slightly
higher than those claimed by the most recent independent study of malware
infection rates in Android by Truong et al. [3] who measure it to be in the
range of 0.26–0.28 % and three times the rate reported by Google [13]. Android
is followed closely by Blackberry with an infection rate of 0.32 % and iOS with
0.22 %. These ﬁgures show that the walled garden approach/security through
obscurity as employed by these platforms are failing to ensure against mal-
ware spread. Blackberry devices are often used for business purposes due to
their security capabilities. However, the nature of data stored on these devices
may induce attackers speciﬁcally target this platform which can explain its high
78
A. Raghuramu et al.
infection rate. Attackers are however failing to aﬀect a large proportion of users
with devices running Windows based mobile platforms as noted by recent indus-
try reports [14].
4 Network Footprints of Cellular Threats
In this section, we investigate if network access patterns associated with mali-
cious domains/hosts contacted by infected user devices exhibit distinct statistical
features when compared to accesses to their benign counterparts. There are many
existing studies that target accurate detection of malicious domains/URL’s by
using diﬀerent methodologies. Some of these studies utilize a combination of
DNS and WHOIS features, host based features, content of the webpage, etc.
in order to achieve their goals [4,5] while some other studies such as [6] and
[7] exclusively use lexical features. The motivation of our study however is to
investigate if any of the statistical network features can complement the exist-
ing detection rules. This can be helpful in situations where other data such as
DNS, WHOIS, etc. which are useful for the malicious domain classiﬁcation task
is infeasible to obtain or is otherwise unavailable.
(a)
(b)
(c)
(d)
(e)
(f)
Fig. 3. Network Footprint of Malicious Domains
4.1 Feature Extraction and Selection
In order to perform our classiﬁcation experiment, we ﬁrst build a set of known
malicious domains using information from the ground truth alert database.
Uncovering the Footprints of Malicious Traﬃc in Cellular Data Networks
79
Table 5. Comparing ROC Areas
Data set
ROC area-α ROC area-β ROC area-γ
600 malicious 600 benign 0.843
540 malicious 600 benign 0.83
480 malicious 600 benign 0.838
420 malicious 600 benign 0.84
360 malicious 600 benign 0.852
300 malicious 300 benign 0.84
240 malicious 600 benign 0.813
180 malicious 600 benign 0.796
120 malicious 600 benign 0.824
60 malicious 600 benign
0.763
0.744
0.737
0.732
0.73
0.746
0.703
0.703
0.771
0.76
0.728
0.9
0.897
0.895
0.891
0.897
0.885
0.885
0.857
0.869
0.876
We then create a set of benign domains by randomly choosing domains visited by
subscriber devices which are otherwise not listed in the ground truth database.
We further verify they are benign by running the domains through commercial
URL scanners. For these set of known malicious and benign domains, we extract
lexical and statistical network features as follows:
(a) Lexical features: Each target domain/host name is broken into multiple ‘tags’
or ‘tokens’ based on the ‘.’ delimiter. We identify 6,729 such unique lexical
tags through this process over a set of 1200 benign and malicious domains.
We then utilize the frequency of occurrence of each tag in a given domain
name as the lexical features of the target. This approach to represent lexical
information is commonly referred to as the bag-of-words model. Variants of
this model have been used to generate lexical features for use in detecting
malicious URL’s in previous studies such as [4,7].
(b) Statistical Network Features: Using the DPI records from the cellular carrier
we extract the following 12 heuristic features for each target domain: Uplink
data transfer volume (or uplink tonnage), downlink data transfer volume (or
downlink tonnage), ratio of uplink/downlink tonnage, total tonnage, pro-
portion of failed connections, average URL length, number of connections,
number of unique source IP’s connecting to the domain, number of failed
connections, entropy of destination IP addresses, downlink tonnage entropy
and the number of unique tonnage values.
We start our analysis by identifying speciﬁc network and lexical features that
contribute towards distinguishing between malicious and benign hosts. In order
to select such features, we utilize the raw set of attributes described above and
apply the Chi-squared statistic evaluation [15]. The Chi-squared score essentially
measures the diﬀerence between the conditional distributions of a network fea-
ture associated with the two classes: malicious vs. benign domains/hosts. On
the basis of the results of this exercise, we narrow down our feature set to 53
80
A. Raghuramu et al.
distinct attributes associated with each malicious/benign domain after remov-
ing attributes which have a score of zero. This reduced feature set includes 10
statistical network features and 43 distinct lexical features. Figure 3 shows the
cumulative distribution function (CDF) of six selected network features associ-
ated with malicious and the benign hosts that exhibited the highest chi-squared
scores. It is visually apparent that there is signiﬁcant diﬀerence between the con-
ditional distribution for malicious vs. benign domains/hosts for these network
features. Other network features which were selected but not shown include the
connection entropy, the destination IP entropy, the downlink tonnage and the
number of unique tonnage values.
4.2 Classiﬁcation of Malicious/Benign Domains
Many of the statistical network features have complex non-linear relationships.
This makes the task of classiﬁcation of domains/hosts into malicious and benign
categories non-trivial. To tackle this problem, we use a machine learning app-
roach which can handle such dependent features eﬃciently. In particular we use
the “Random Forest” ensemble learner [16] to create a model with the individual
features. This classiﬁcation method operates by constructing multiple decision
trees at a time (15 in our case) and predicts a class by aggregating the predic-
tions of the ensemble. In addition, we use the n-fold cross validation technique
to evaluate the accuracy of our model (n=10).
We run our classiﬁcation experiments on varying proportions of malicious
and non-malicious hosts employing (a) Statistical network features alone (α),
(b) Lexical Features alone (β) and (c) Statistical network features in addition
to lexical features (γ). Figure 4a and b present the receiver operating character-
istic(ROC) for two of our cross-validation experiments. The ideal ROC would
lie close to the upper-left corner with false positive rate close to 0 % and true
positive rate close to 100 %. Note that with the addition of statistical network
features to simple lexical features, we obtain a better true positive rate at lower
false positive rates for most combinations of malicious and benign hosts.
(a) Only Lexical features
(b) Lexical & Network Features
Fig. 4. Cross-Validation Results
Uncovering the Footprints of Malicious Traﬃc in Cellular Data Networks
81
We observe from Table 5 that the ROC area is higher in the case where we
utilize statistical network features along with lexical features (column 3) to per-
form classiﬁcation as compared to using the lexical features alone (column 2) or
statistical network features alone (column 1) for all proportions of malicious and
benign domains. These preliminary results show that statistical network features
are complementary to lexical features and hold promise to add to capabilities of
existing detection rules to help solve the malicious domain detection problem.
A deeper analysis of this result is warranted and we leave it as an important
area of exploration for our future work.
5 Conclusions
In this paper, we present a study of malicious mobile traﬃc by using data
obtained from a major US based cellular carrier spanning a one week period
that contains over two million subscribers. Our investigation reveals that 0.17 %
of mobile devices are aﬀected by security threats. This infection rate while still
small, is orders of magnitude higher than the last reported infection rate of
0.0009 % making this a worrisome problem. We combine multiple disparate data
sets to uncover details about the threats aﬀecting mobile devices in the cellular
network and their unique characteristics. We also perform a detailed analysis
of infection rates in various popular mobile platforms. Our results show that
platforms deemed to be more secure by common opinion as iOS and BlackBerry
are not as secure as we think. However, Android still remains the most aﬀected
platform with an infection rate of 0.39 %. Lastly, we characterized the aggregate
network footprint of malicious and benign domains associated with the threats
observed in our dataset and showed how statistical network features can be used
to potentially aid detection of malicious domains/hosts when used in conjunc-
tion with other lexical feature sets. Our preliminary results in this direction are
promising and we leave more detailed analysis to future work.
Acknowledgement. We would like to thank Parth H. Pathak for his insightful com-
ments on this work. We are grateful to Theo Pan and Josh Vaughen for their help with
obtaining VirusTotal data. This work was supported in part by the the Intel Science
and Technology Center for Secure Computing.
References
1. Wei, X., Gomez, L., Neamtiu, I., Faloutsos, M.: Malicious android applications in
the enterprise: What do they do and how do we ﬁx it? In: Proceedings of 28th
IEEE International Conference on Data Engineering Workshops (ICDEW) (2012)
2. Lever, C., Antonakakis, M., Reaves, B., Traynor, P., Lee, W.: The core of the
matter: analyzing malicious traﬃc in cellular carriers. In: Proceedings of NDSS
2013 (2013)
3. Truong, H.T.T., Lagerspetz, E., et al.: The company you keep: mobile malware
infection rates and inexpensive risk indicators. In: Proceedings of 23rd International
Conference on World Wide Web, pp. 39–50 (2014)
82
A. Raghuramu et al.
4. Ma, J., Saul, L.K., Savage, S., Voelker, G.M.: Identifying suspicious URLs: an
application of large-scale online learning. In: Proceedings of 26th ACM Annual
International Conference on Machine Learning, pp. 681–688 (2009)
5. Choi, H., Zhu, B.B., Lee, H.: Detecting malicious web links and identifying their
attack types. In: Proceedings of 2nd USENIX Conference on Web Application
Development (2011)
6. Blum, A., Wardman, B., Solorio, T., Warner, G.: Lexical feature based phishing
URL detection using online learning. In: Proceedings of 3rd ACM Workshop on
Artiﬁcial Intelligence and Security, pp. 54–60 (2010)
7. Le, A., Markopoulou, A., Faloutsos, M.: Phishdef: URL names say it all. In: Pro-
ceedings of IEEE INFOCOM, pp. 191–195 (2011)
8. Invernizzi, L., Miskovic, S., et al.: Nazca: detecting malware distribution in large-
scale networks. In: Proceedings of NDSS 2014 (2014)
9. The virustotal online scanner. http://www.virustotal.com/en/about
10. Maslennikov, D.: Zeus in the mobile - facts and theories (2011). http://www.
securelist.com/en/analysis/204792194
11. El Sawda, S., Urien, P.: SIP security attacks and solutions: a state-of-the-art
review. In: IEEE Information and Communication Technologies, ICTTA 2006,
vol. 2, pp. 3187–3191 (2006)
12. Geneiatakis, D., Dagiuklas, T., et al.: Survey of security vulnerabilities in session
initiation protocol. IEEE Commun. Surv. Tutor. 8(1–4), 68–81 (2006)
13. Patterson, S.M.: Contrary to what you’ve heard, Android is almost impene-
trable to malware (2013). http://qz.com/131436/contrary-to-what-youve-heard-
android-is-almost-impenetrable-to-malware
14. Cisco 2014 annual security report. http://www.cisco.com/web/oﬀers/lp/2014-
annual-security-report/index.html
15. Liu, H., Setiono, R.: Chi2: feature selection and discretization of numeric attributes.
In: IEEE 7th International Conference on Tools with Artiﬁcial Intelligence, pp.
388–391 (1995)
16. Breiman, L.: Random forests. Mach. Learn. 45(1), 5–32 (2001)