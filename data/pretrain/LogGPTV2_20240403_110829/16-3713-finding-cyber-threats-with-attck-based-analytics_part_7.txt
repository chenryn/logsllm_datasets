Analytic 1 ATT&CK Coverage:
Tactic Technique
Discovery Process Discovery
Defense Evasion Disabling Security Tools
Execution Command Line Interface
More on CAR site …
Analytic 2: Remotely Launched Executables via Services
CAR URL: https://car.mitre.org/wiki/CAR-2014-03-005
Type: Behavioral
Data: Process Creation Events, Process Network Connection Events with Remote Procedure Call
(RPC) Metadata
A-1
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
This analytic correlates data from multiple sensors to identify instances where an adversary uses
the RPC functionality of Windows to remotely start the execution of an executable on a host.
Such activity is identified by correlating an RPC connection to services.exe with a near
immediate process start event of services.exe.
Analytic 2 ATT&CK Coverage:
Tactic Technique
Execution New Service
Execution Modifying Existing Service
Execution Service Execution
Analytic 3: User Login Activity Monitoring
CAR URL: https://car.mitre.org/wiki/CAR-2013-10-001
Type: Informational
Data: Login, Logout and Remote Login Events (from Windows Event Logs)
Situational awareness analytics provide valuable information to analysts about when an incident
occurs. This analytic uses Windows security logs to track user logon sessions, including both
local and remote logon sessions. This is useful to help establish which user account(s) was
responsible for, or impacted by, the compromise of a host. It also provides general user account
logon patterns which can be useful for advanced anomaly and behavioral analysis.
Analytic 3 ATT&CK Coverage:
Tactic Technique
Defense Evasion Legitimate Credentials
Lateral Movement Remote Desktop Protocol
Analytic 4: Server Message Block (SMB) Copy and Execution
CAR URL: https://car.mitre.org/wiki/CAR-2013-05-005
Type: Behavioral
Data: Process Creation Events, Network Flow Events with SMB Metadata
Adversaries commonly use the SMB Protocol to write malicious executables or scripts to a
remote host that are then executed at a later time. This analytic looks for an SMB file write event
(via file or network monitoring) and the process execution event corresponding to that
executable or script.
Analytic 4 ATT&CK Coverage:
Tactic Technique
Lateral Movement Windows Admin Shares
Defense Evasion, Lateral Legitimate Credentials
Movement
Lateral Movement Remote File Copy
A-2
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
Analytic 5: Outlier Parents of cmd.exe
CAR URL: https://car.mitre.org/wiki/CAR-2014-11-002
Type: Anomaly/Outlier
Data: Process Creation Events
Some programs execute the Windows command shell frequently as part of their normal
operation. Malicious actors commonly spawn command prompts from processes that do not
normally spawn command prompts, either by using custom malware or by hijacking other
processes. By identifying instances where a command prompt is started by a process that does
not normally start command prompts, this kind of behavior can be observed.
Analytic 5 ATT&CK Coverage:
Tactic Technique
Execution Command Line Interface
A.2 Sensors
During the course of our research, a wide variety of different sensors were used to collect data in
the living lab. Because most of the data that was necessary to build the ATT&CK-based
analytics had to be collected from endpoint hosts, MITRE’s sensing efforts gravitated towards
sensors that could be installed on endpoint systems. At the time of this writing, the endpoint tools
or data sources that are currently in use are:
• Windows Event Logs
Standard Windows logs from hosts. These are used for tracking user session information,
including login attempts.
• Sysmon [27]
A Microsoft Sysinternals tool that captures a variety of endpoint data. It is used for capturing
process creation events and their associated command lines, but it can also capture network
connection creation, driver loads, and dynamic linking library (DLL) module loads. It can also
detect when a file has its creation time altered (also known as timestomping).
• Autoruns [28]
A Microsoft Sysinternals tool that provides data relating to all programs that are scheduled to
start automatically on a host. Configuring a program to automatically start is a common
technique used by adversaries to achieve persistence. Note: Although this tool is scanning-based
and not event-driven, as the other sensors are, MITRE is not aware of any fully-featured, freely-
available, and event-driven alternative at the time of writing.
• Custom Endpoint Netflow Sensor
A MITRE built endpoint network flow program. Similar to a NetFlow sensor, it captures
network connection flows, but augments them with data from the end host, such as process ID.
(This is included in Sysmon as well.) This sensor also decodes portions of a session and enriches
flow records with that metadata. The two primary advantages of this are the ability to associate a
A-3
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
process with network connections and the ability to perform protocol decoding of the Windows
SMB Protocol that underlies much of the native functionality of Windows Enterprise Domains.
• Custom Event Tracing for Windows [29] Sensor
A MITRE-built sensor that fills several gaps in sensing. This sensor is primarily used to detect
process injection (which can also be detected by the later versions of Sysmon), which is a
common tactic used by credential dumpers to obtain user logon information. This sensor also
captures process creation and termination, file creation, and file deletion events for certain files
and paths.
• Computer Properties and Sensor Checks
Several times each day, every computer collects an informational snapshot of its current status.
This status includes information related to network devices and configuration, hardware profile,
disk utilization, memory utilization, last boot time, operating system information, and a list of all
users who have logged on since the last boot. This data is primarily used in situational awareness
analytics, but it can also enrich queries related to credential access to help determine which
credentials may have been compromised. Additionally, there are periodic checks performed to
return the status of all of our sensor services and executables in order to determine if they are
running, stopped, or not present on each system.
A-4
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
Appendix B Scenario Details
The sections below expand and give more details to the scenarios outlined in Section 4.4.1, as
well as detailing which ATT&CK techniques a Red Team should use for adversarial emulation.
B.1 Scenario 1
Example of a high-level tactic sequence and selection of ATT&CK techniques:
1. The emulated adversary gains execution through an initial foothold that was provided by
some means provided by the White Team. The following could represent an embedded
protocol within HTTP over TCP port 80 which could also be used to move additional
tools into the network:
ATT&CK Tactic Technique ID
Command and Standard Application T1071
Control Layer Protocol
Command and Commonly Used Port T1043
Control
Command and Remote File Copy T1105
Control
2. Once established, initiate a reverse shell command interface through the remote access
tool:
ATT&CK Tactic Technique ID Tool/Command
Execution Command-Line T1059 cmd.exe
Interface
3. Perform Discovery techniques through the command interface:
ATT&CK Tactic Technique ID Tool/Command
Discovery Account Discovery T1087 net localgroup administrators
net group  /domain
net user /domain
Discovery File and Directory T1083 dir
Discovery
cd
Discovery Local Network T1016 ipconfig /all
Configuration
Discovery
B-1
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
Discovery Local Network T1049 netstat -ano
Connections
Discovery
Discovery Permission Groups T1069 net localgroup
Discovery
net group /domain
Discovery Process Discovery T1057 tasklist /v
Discovery Remote System T1018 net view
Discovery
Discovery System Information T1082 systeminfo
Discovery
Discovery System Service T1007 net start
Discovery
4. After sufficient information is learned perform open-ended tactics and techniques as
needed. The following techniques are based on suggested actions from ATT&CK to
establish persistence or to escalate privileges and establish persistence. After sufficient
privileges are obtained, then dump credentials using Mimikatz or attempt to acquire
credentials with a keylogger to capture user input.
ATT&CK Tactic Technique ID
Persistence New Service T1050
Persistence Registry Run Keys / T1060
Start Folder
Privilege Escalation, Bypass User Account T1088
Defense Evasion Control
Credential Access Dump Credentials T1003
Credential Access Input Capture T1056
5. If credentials are obtained and knowledge of systems is sufficient from the Discovery
techniques, then attempt to move laterally to exercise the main objective of this scenario.
ATT&CK Tactic Technique ID Tool/Command
Lateral Movement Windows Admin T1077 net use * \\\ADMIN$
/user:\
B-2
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
Lateral Movement Remote File Copy T1105 copy 
Execution Service Execution T1035 psexec
6. Continue spreading laterally using the previous techniques as needed to obtain the target
sensitive information and exfiltrate it. Files may be collected and exfiltrated using the
following suggested ATT&CK techniques:
ATT&CK Tactic Technique ID
Collection Data from Local T1005
System
Collection Data from Network T1039
Shared Drive
Exfiltration Data Compressed T1002
Exfiltration Data Encrypted T1022
Exfiltration Exfiltration Over T1041
Command and
Control Channel
B.2 Scenario 2
Example high level tactic sequence and selection of ATT&CK techniques:
1. The emulated adversary gains execution through initial foothold that was provided. The
command and control channel for this scenario was left open-ended. The following was
suggested and could represent an embedded protocol within HTTPS using SSL/TLS over
TCP port 443 which could also be used to move additional tools into the network:
ATT&CK Tactic Technique ID
Command and Standard Application T1071
Control Layer Protocol
Command and Standard T1032
Control Cryptographic
Protocol
Command and Commonly Used Port T1043
Control
Command and Remote File Copy T1105
Control
2. Depending on the RAT used, a reverse shell command interface may be invoked to issue
PowerShell commands:
ATT&CK Tactic Technique ID Tool/Command
Execution Command-Line T1059 cmd.exe
Interface
B-3
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
3. Perform Discovery techniques through the command interface using equivalent
PowerShell scripts or offensive framework. This example uses the Empire framework.
[26] The first two rows act as modifiers to the remaining techniques in the table:
ATT&CK Technique ID Tool/Module/Command
Tactic
Execution PowerShell T1086 powershell.exe
Defense Scripting T1064 powershell.exe
Evasion
Discovery Account Discovery T1087 situational_awareness/network/netview
Discovery File and Directory T1083 dir/ls
Discovery
cd
Discovery Local Network T1016 ipconfig
Configuration
Discovery
Discovery Local Network T1049 situational_awareness/network/netview
Connections
Discovery
Discovery Permission Groups T1069 situational_awareness/network/netview
Discovery
Discovery Process Discovery T1057 tasklist/ps
Discovery Remote System T1018 situational_awareness/network/netview
Discovery
Discovery System Information T1082 sysinfo
Discovery
Discovery System Service T1007 situational_awareness/network/netview
Discovery
4. After sufficient information is learned perform open-ended tactics and techniques as
needed. The following techniques are based on suggested actions from ATT&CK.
B-4
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.
Establish persistence or escalate privileges and establish persistence. After sufficient
privileges are obtained, then dump credentials using the Invoke-Mimikatz module.
ATT&CK Tactic Technique ID
Persistence New Service T1050
Privilege Escalation, Bypass User Account T1088
Defense Evasion Control
Credential Access Dump Credentials T1003
5. If credentials are obtained and knowledge of systems is sufficient from the Discovery
techniques, then attempt to move laterally to exercise the main objective of this scenario.
ATT&CK Tactic Technique ID Tool/Module
Lateral Movement Windows Admin T1077 lateral_movement/invoke_psexec
Shares
Lateral Movement Remote File Copy T1105 lateral_movement/invoke_psexec
Execution Service Execution T1035 lateral_movement/invoke_psexec
6. As with Scenario 1, continue spreading laterally using the previous techniques as needed
to reach the objective. For data exfiltration, the following ATT&CK techniques are
suggested and should be perform through PowerShell when possible:
ATT&CK Tactic Technique ID
Collection Data from Local T1005
System
Collection Data from Network T1039
Shared Drive
Exfiltration Data Compressed T1002
Exfiltration Data Encrypted T1022
Exfiltration Exfiltration Over T1041
Command and
Control Channel
B-5
©2017 The MITRE Corporation. All rights reserved.
Approved for Public Release; Distribution Unlimited. Case Number 16-3713.