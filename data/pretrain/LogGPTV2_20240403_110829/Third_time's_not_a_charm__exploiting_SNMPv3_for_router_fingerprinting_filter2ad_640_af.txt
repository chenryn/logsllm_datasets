Jonker and the anonymous reviewers for their valuable feedback.
This work was funded in part by the European Research Coun-
cil Starting Grant ResolutioNet (ERC-StG-679158), BMBF BIFOLD
01IS18025A and 01IS18037A, and the U.S. National Science Founda-
tion (CNS-1855614). Views and conclusions are those of the authors
and should not be interpreted as representing the official policies
or position of the ERC, BMBF, U.S. government or the NSF.
REFERENCES
[1] Internet Assigned Numbers Authority. 2021. PRIVATE ENTERPRISE NUMBERS.
https://www.iana.org/assignments/enterprise-numbers/enterprise-numbers.
[2] A. Berger, N. Weaver, R. Beverly, and L. Campbell. 2013. Internet nameserver
[4] R. Beverly, A. Berger, Y. Hyun, and k. claffy. 2009. Understanding the Efficacy of
[3] R. Beverly. 2002. RTG: A Scalable SNMP Statistics Architecture for Service
IPv4 and IPv6 address relationships. In ACM IMC.
Providers. In USENIX LISA.
Deployed Internet Source Address Validation Filtering. In ACM IMC.
3 of the Simple Network Management Protocol (SNMPv3). IETF RFC 3414.
[5] U. Blumenthal and B. Wijnen. 2002. User-based Security Model (USM) for version
[6] CAIDA. 2021. Macroscopic Internet Topology Data Kit (ITDK). https://www.
caida.org/catalog/datasets/internet-topology-data-kit/.
[7] CAIDA. 2021. The CAIDA AS Ranking. https://asrank.caida.org/.
[8] J. Case, M. Fedor, M. Schoffstall, and J. Davin. 1988. A Simple Network Manage-
ment Protocol. IETF RFC 1067.
[9] J. Case, M. Fedor, M. Schoffstall, and J. Davin. 1990. A Simple Network Manage-
ment Protocol (SNMP). IETF RFC 1157.
[10] J. Case, K. McCloghrie, M. Rose, and S. Waldbusser. 1993. Coexistence between
version 1 and version 2 of the Internet-standard Network Management Frame-
work. IETF RFC 1452.
[11] J. Case, K. McCloghrie, M. Rose, and S. Waldbusser. 1993. Introduction to version
2 of the Internet-standard Network Management Framework. IETF RFC 1441.
[12] J. Case, K. McCloghrie, M. Rose, and S. Waldbusser. 1996. Coexistence between
Version 1 and Version 2 of the Internet-standard Network Management Frame-
work. IETF RFC 1908.
[13] J. Case, K. McCloghrie, M. Rose, and S. Waldbusser. 1996.
Introduction to
Community-based SNMPv2. IETF RFC 1901.
[14] Censys. 2021. Censys Scanning and Data Collection. https://censys.io/.
[15] Cisco. 2021.
Catalyst 2960 and 2960-S Software Configuration Guide,
12.2(55)SE. https://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960/
software/release/12-2_55_se/configuration/guide/scg_2960/swsnmp.html.
[16] Cisco. 2021. Cisco Bug: CSCts87275 - Cat4k with sup7e : same snmp engineID
on different cat4k switches. https://quickview.cloudapps.cisco.com/quickview/
bug/CSCts87275.
[17] Cisco PSIRT. 2021. SNMP v3 information leaking vulnerability.
https://bst.
cloudapps.cisco.com/bugsearch/bug/CSCuz00727.
[18] Cisco PSIRT. 2021. SNMP v3 information leaking vulnerability.
https://bst.
cloudapps.cisco.com/bugsearch/bug/CSCtw74132.
[19] J. Czyz, M. Luckie, M. Allman, and M. Bailey. 2016. Don’t Forget to Lock the
[22] Z. Durumeric, E. Wustrow, and J. A. Halderman. 2013. ZMap: Fast Internet-Wide
Back Door! A Characterization of IPv6 Network Security Policy. In NDSS.
[20] D. Dittrich, E. Kenneally, et al. 2012. The Menlo Report: Ethical Principles
Guiding Information and Communication Technology Research. U.S. Department
of Homeland Security (2012).
[21] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman. 2015. A
Search Engine Backed by Internet-Wide Scanning. In ACM CCS.
Scanning and its Security Applications. In USENIX Security Symposium.
[23] O. Gasser, Q. Scheitle, P. Foremski, Q. Lone, M. Korczynski, S. D. Strowes, L.
Hendriks, and G. Carle. 2018. Clusters in the Expanse: Understanding and
Unbiasing IPv6 Hitlists. In ACM IMC.
[24] O. Gasser, Q. Scheitle, P. Foremski, Q. Lone, M. Korczynski, S. D. Strowes, L.
Hendriks, and G. Carle. 2021. IPv6 Hitlist Service. https://ipv6hitlist.github.io/.
[25] O. Gasser, Q. Scheitle, B. Rudolph, C. Denis, N. Schricker, and G. Carle. 2017. The
Amplification Threat Posed by Publicly Reachable BACnet Devices. Journal of
Cyber Security and Mobility 6 (2017). Issue 1.
[26] R. Govindan and H. Tangmunarunkit. 2000. Heuristics for Internet Map Discovery.
In IEEE INFOCOM.
[27] M. H. Gunes and K. Sarac. 2006. Analytical IP alias resolution. In 2006 IEEE ICC.
[28] W. Hardaker. 2011. Transport Layer Security (TLS) Transport Model for the
Simple Network Management Protocol (SNMP). RFC 6353 (Internet Standard).
https://doi.org/10.17487/RFC6353
[29] D. Harrington, R. Presuhn, and B. Wijnen. 2002. An Architecture for Describing
Simple Network Management Protocol (SNMP) Management Frameworks. IETF
RFC 3411.
[30] J. Holland, R. Teixeira, P. Schmitt, K. Borgolte, J. Rexford, N. Feamster, and
J. Mayer. 2020. Classifying Network Vendors at Internet Scale. arXiv, https:
//arxiv.org/abs/2006.13086.
[31] Huawei. 2021. S2750, S5700, S6700 V200R003(C00, C02, and C10) Configuration
Guide - Network Management and Monitoring. https://support.huawei.com/
enterprise/en/doc/EDOC1000027472?section=j005.
[32] IEEE. 2021. List of MAC OUIs. http://standards-oui.ieee.org/oui/oui.txt.
[33] L. Izhikevich, R. Teixeira, and Z. Durumeric. 2021. LZR: Identifying Unexpected
[34] K. Keys, Y. Hyun, M. Luckie, and k claffy. 2013. Internet-Scale IPv4 Alias Resolu-
[35] T. Kohno, A. Broido, and KC Claffy. 2005. Remote Physical Device Fingerprinting.
[36] M. Kührer, T. Hupperich, C. Rossow, and T. Holz. 2014. Hell of a Handshake:
Internet Services. In USENIX Security Symposium.
tion with MIDAR. IEEE/ACM Trans. Networking 21, 2 (2013).
IEEE Transactions on Dependable and Secure Computing 2, 2 (2005).
Abusing TCP for Reflective Amplification DDoS Attacks. In USENIX WOOT.
Internet. In ACM SIGCOMM.
Alias Resolution. In ACM IMC.
Names from Hostnames. In ACM IMC.
[38] M. Luckie, R. Beverly, and W. Brinkmeyer. 2013. Speedtrap: Internet-Scale IPv6
[37] M. Luckie and R. Beverly. 2017. The Impact of Router Outages on the AS-level
[39] M. Luckie, B. Huffaker, and k. claffy. 2019. Learning Regexes to Extract Router
[40] A. Marder. 2020. APPLE: Alias Pruning by Path Length Estimation. In PAM.
[41] MITRE. 2021. Common Vulnerabilities and Exposures, SNMP. https://cve.mitre.
[42] HD Moore. 2020. Security Surprises with SNMP v3. https://www.rumble.run/
org/cgi-bin/cvekey.cgi?keyword=SNMP.
blog/security-surprises-with-snmp-v3/.
[43] S. J. Murdoch. 2006. Hot or not: Revealing hidden services by their clock skew.
In ACM CCS.
org/.
[44] RIPE NCC. 2021. RIPE Atlas. https://atlas.ripe.net/.
[45] Net-SNMP Project. 2021. Net-SNMP. http://www.net-snmp.org/.
[46] Nmap. 2021. Nmap: the Network Mapper - Free Security Scanner. https://nmap.
[47] C. Partridge and M. Allman. 2016. Ethical Considerations in Network Measure-
[48] C. Rossow. 2014. Amplification Hell: Revisiting Network Protocols for DDoS
ment Papers. Commun. ACM (2016).
Abuse. In NDSS.
[49] E. C. Rye and R. Beverly. 2020. Discovering the IPv6 Network Periphery. In PAM.
[50] E. C. Rye, R. Beverly, and kc claffy. 2021. Follow the Scent: Defeating IPv6 Prefix
[51] M. Sargent, J. Kristoff, V. Paxson, and M. Allman. 2017. On the Potential Abuse
[52] Q. Scheitle, O. Gasser, M. Rouhi, and G. Carle. 2017. Large-Scale Classification of
Rotation Privacy. In ACM IMC.
of IGMP. ACM CCR (2017).
IPv6-IPv4 Siblings with Variable Clock Skew. In TMA.
org/snmp/.
[53] Shadowserver. 2021. Open SNMP Scanning Project. https://scan.shadowserver.
[54] J. Sherry, E. Katz-Bassett, M. Pimenova, H. Madhyastha, T. Anderson, and A.
Krishnamurthy. 2010. Resolving IP aliases with prespecified timestamps. In ACM
IMC.
[55] N. Spring, R. Mahajan, and D. Wetherall. 2002. Measuring ISP topologies with
Rocketfuel. In ACM SIGCOMM.
cations Surveys 1, 1 (1998), 2–17.
cvename.cgi?name=2012-5719.
[56] W. Stallings. 1998. SNMPv3: A security enhancement for SNMP. IEEE Communi-
[57] The Mitre Corporation. 2012. CVE-2012-5719. https://cve.mitre.org/cgi-bin/
[58] S. Thomas. 2021. Brute forcing SNMPv3 authentication. https://applied-risk.
com/resources/brute-forcing-snmpv3-authentication.
[59] Y. Vanaubel, J.-J. Pansiot, P. Merindol, and B. Donnet. 2013. Network Fingerprint-
[60] K. Vermeulen, B. Ljuma, V. Addanki, M. Gouel, O. Fourmaux, T. Friedman, and R.
ing: TTL-Based Router Signatures. In ACM IMC.
Rejaie. 2020. Alias Resolution Based on ICMP Rate Limiting. In PAM.
Technique for Revealing Hidden Services. In USENIX Security Symposium.
[61] S. Zander and S. J. Murdoch. 2008. An Improved Clock-skew Measurement
A COMPARISON OF DIFFERENT ALIAS
RESOLUTION APPROACHES
Table 3 shows the results for different alias resolution variations.
“First” and “both” revers to using fields from the first scan only
vs. using fields from both scans for the matching process. The
techniques differ only on the matching threshold for the last reboot
time. All other fields are matched exactly. “Exact” denotes an exact
matching of last reboot time, “Round” means that the last digit is
163
Third Time’s Not a Charm: Exploiting SNMPv3 for Router Fingerprinting
IMC ’21, November 2–4, 2021, Virtual Event, USA
Exact first
Exact both
Round first
Round both
Divide by 20 first
Divide by 20 both
Divide by 20+round first
Divide by 20+round both
Alias sets Non-singleton alias sets
903k
892k
826k
835k
820k
824k
820k
824k
5.3M
5.9M
4.6M
4.7M
4.6M
4.6M
4.6M
4.6M
Table 3: Comparison of different alias resolution approaches.
IPs in non-singleton alias sets
8.2M
7.5M
8.7M
8.7M
8.8M
8.7M
8.8M
8.7M
IPs per non-singleton alias set
9.1
8.4
10.6
10.4
10.7
10.6
10.7
10.6
Figure 20: Distribution of number of routers per AS for dif-
ferent regions.
C DISTRIBUTION OF ROUTERS PER AS AND
REGION
In Figure 20 we plot the distribution of routers that our technique
identified per network (AS) and per region. To map ASes to coun-
tries, we utilized CAIDA’s AS Ranking [7]. This results in an AS-
to-country reaches 99,9% for the ASes with routers our study, i.e.,
22,769 out of 22,789. We are aware that a network may span multiple
countries within a continent, i.e., we decided to map a network to
a continent (region). Again, there are networks that span multiple
regions, but in this case, typically, they register different ASes and
address space in different regions. If this is not the case then, we
assign the region of the headquarter of the network operator to the
AS it owns. Our analysis does not show significant distributional
differences across continents. However, most of the networks with
largest number of routers are in North America (NA) and Europe
(EU).
Figure 19: Uniqueness of (last reboot time, engine boots)
tuples across IPv4 and IPv6 addresses: For the vast majority
of tuples we see a single engine ID. Note that the x axis is
log-scaled.
rounded, “Divide by 20” means that the last digit is divided by 20
and cut off (i.e., put into bins of 20 seconds), “Divide by 20+round”
denotes division by 20 and rounding of the resulting floating point
number.
B UNIQUENESS OF LAST REBOOT TIME AND
ENGINE TIME
In addition to the engine ID SNMP send engine time and engine
boots values in their response. Our alias resolution technique lever-
ages these information as well. By subtracting the engine time from
the current time of the scan we calculate a last reboot time. In order
to learn more about the uniqueness of last reboot time and engine
time tuples, we look for cases where the same last reboot time
and engine time values are seen at different devices, i.e., devices
with different engine IDs. Figure 19 shows the distribution of the
same last reboot time and engine time tuples for different number
of engine IDs. We find that for 97.2% and 99.8% of IPv4 and IPv6
addresses have last reboot time and engine time tuples with a single
unique engine ID. This shows that this tuple is indeed a valuable
addition for our alias resolution technique.
164
100101102103Different engine IDs per tuple0.00.20.40.60.81.0ECDF: Fraction of IPsIPv4IPv6100101102103104Number of SNMPv3 Routers per AS per Region0.00.20.40.60.81.0ECDF: Fraction of ASesAFASEUNAOCSAALL