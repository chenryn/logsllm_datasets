sibility for a distributed service to provide (i) consistency:
returning the right response to a request; (ii) availability:
returning a response to each request; and (iii) partition-
tolerance: supporting message delays and losses. Intuitively,
it appears natural for a distributed system to stop working
as soon as communication is no longer ensured between the
distributed participants. What is less clear is the consequence
of communication being delayed. As we presented here, the
consequence for forkable blockchains can be asset losses.
There exist a large body of solutions in the distributed
computing literature favoring consistency over availability.
As consortium and private blockchains involve a typically
known number n of participants, Byzantine consensus algo-
rithms could be used to cope with the Balance attack pro-
vided that strictly less than n
3 processes are under the control
of the adversary. Several blockchains tried to build upon the
classic Byzantine consensus implementation PBFT [8]. This
is the case of Hyperledger7, Tendermint [23] and Corda [5].
Unfortunately, PBFT does not perform well with a growing
set of participants [10]. Hierarchical approaches were pro-
posed to improve the performance of PBFT [26], but assume
synchrony. Another tentative [29] improved performance by
building upon a more recent Byzantine consensus algo-
rithm [30], however, this algorithm is probabilistic [31]. A
new deterministic Byzantine algorithm designed especially
for blockchains has just been proposed [9]. Although it
appears efﬁcient and is guaranteed to terminate,
to our
knowledge it has not been evaluated empirically.
VIII. RELATED WORK
Traditional attacks against Bitcoin consist of waiting for
some external action, like shipping goods, in response to a
7http://www.hyperledger.org/.
Without a quarter of the mining power, discarding a
committed transaction in Bitcoin requires additional power,
like the control over the network. It is well known that
delaying network messages can impact Bitcoin [11], [37],
[39], [20], [36]. Decker and Wattenhoffer already observed
that Bitcoin suffered from block propagation delays [11].
Godel et al. [20] analyzed the effect of propagation delays
on Bitcoin using a Markov process. Garay et al. [17] inves-
tigated Bitcoin in the synchronous communication setting,
however, this setting is often considered too restrictive [7].
Pass et al. extended the analysis for when the bound on
message delivery is unknown and showed in their model that
the difﬁculty of Bitcoin’s crypto-difﬁculty has to be adapted
depending on the bound on the communication delays [37].
This series of work reveal an important limitation of Bitcoin:
delaying propagation of blocks can waste the computational
588
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:03:34 UTC from IEEE Xplore.  Restrictions apply. 
effort of correct nodes by letting them mine blocks unneces-
sarily at the same index of the chain. In this case, the attacker
does not need more mining power than the correct miners,
but simply needs to expand its local blockchain faster than
the growth of the longest branch of the correct blockchain.
Ethereum proposed the GHOST protocol to cope with this
issue [39]. The idea is simply to account for the blocks
proposed by correct miners in the multiple branches of the
correct blockchain to select the main branch. As a result,
Growing a branch the fastest is not sufﬁcient for an attacker
of Ethereum to be able to double spend. Even though
the propagation strategy of Ethereum differs from the pull
strategy of Bitcoin, some network attacks against Bitcoin
could affect Ethereum. In the Eclipse attack [22] against
Bitcoin, the attacker forces the victim to connect to 8 of its
malicious identities. The Ethereum adaptation would require
to forge 3× more identities and force as many connections
as the default number of clients is 25. Apostolaki et al. [1]
proposed a BGP hijacking attack and showed that
the
number of Internet preﬁxes that need to be hijacked for
the attack to succeed depends on the distribution of the
mining power. BGP-hijacking typically requires the control
of network operators but is independent from Bitcoin and
could potentially be exploited to delay network messages
and execute a Balance attack in Ethereum.
Some work already evoked the danger of using proof-of-
work techniques in a consortium context [21]. In particular,
experiments demonstrated the impossibility of ordering even
committed transactions in an Ethereum private chain without
exploring the impact of the network delay [35]. We go
further by showing that forkable blockchains may suffer
from corruptibility.
IX. CONCLUSION
In this paper, we propose the Balance attack a new
attack that combines mining power with communication
delay to affect prominent forkable blockchain protocols
like Ethereum and Bitcoin. This attack simply consists of
convincing correct nodes to disregard particular proposed
series of blocks to lead to a double spending. We analyzed
the tradeoff inherent to Ethereum between communication
delay and mining power, hence conﬁrming that forkable
designs are ill-suited for consortium and private blockchains.
There are several ways to extend this work. First, the
context is highly dependent on medium-scale settings where
statistics about all participants can be easily collected. It
would be interesting to extend these results when the mining
power of participants is unknown. Second, the success of
the Balance attack despite a low mining power requires
communication delay between communication subgraphs.
The next step is to compare denial-of-service and man-
in-the-middle attacks and evaluate their effectiveness in
introducing this delay.
ACKNOWLEDGEMENTS
We are grateful to the R3 consortium for sharing infor-
mation regarding their Ethereum testnet and to Seth Gilbert
and Tim Swanson for comments on an earlier version of this
paper.
REFERENCES
[1] M. Apostolaki, A. Zohar, and L. Vanbever, “Hijacking bit-
coin: Large-scale network attacks on cryptocurrencies,” arXiv,
Tech. Rep. 1605.07524, 2016.
[2] T. Bamert, C. Decker, L. Elsen, R. Wattenhofer, and S. Wel-
ten, “Have a snack, pay with bitcoins,” in 13th IEEE Inter-
national Conference on Peer-to-Peer Computing, IEEE P2P
2013, Trento, Italy, September 9-11, 2013, Proceedings, 2013,
pp. 1–5.
[3] A. Black, “Hashcash - a denial of service counter-measure,”
Cypherspace, Tech. Rep., 2002. [Online]. Available: http:
//www.hashcash.org/papers/hashcash.pdf
[4] E. Brewer, “Towards robust distributed systems,” in Proc.
19th ACM Symposium on Principles of Distributed Comput-
ing (PODC), July 2000.
[5] R. G. Brown, J. Carlyle, I. Grigg, and M. Hearn, “Corda: An
introduction,” 2016.
[6] V. Buterin, “Ethereum 2.0 mauve paper,” in Ethereum Devel-
oper Conference 2, September 2016.
[7] C. Cachin, “Distributing trust on the internet,” in Proceedings
of the International Conference on Dependable Systems and
Networks (DSN), 2001, pp. 183–192.
[8] M. Castro and B. Liskov, “Practical byzantine fault tolerance
and proactive recovery,” ACM Trans. Comput. Syst., vol. 20,
no. 4, pp. 398–461, 2002.
[9] T. Crain, V. Gramoli, M. Larrea,
and M. Raynal,
“(leader/randomization/signature)-free byzantine consensus
for consortium blockchains,” arXiv, Tech. Rep. 1702.03068,
2017.
[10] K. Croman, C. Decker, I. Eyal, A. E. Gencer, A. Juels,
A. Kosba, A. Miller, P. Saxena, E. Shi, E. G. Sirer, D. Song,
and R. Wattenhofer, “On scaling decentralized blockchains,”
in 3rd Workshop on Bitcoin Research (BITCOIN), Barbados,
February 2016.
[11] C. Decker and R. Wattenhofer, “Information propagation in
the IEEE International
the bitcoin network,” in Proc. of
Conference on Peer-to-Peer Computing, 2013.
[12] C. Dwork, N. Lynch, and L. Stockmeyer, “Consensus in the
presence of partial synchrony,” J. ACM, vol. 35, no. 2, Apr.
1988.
[13] I. Eyal, A. E. Gencer, E. G. Sirer, and R. van Re-
nesse, “Bitcoin-NG: A scalable blockchain protocol,” in 13th
USENIX Symposium on Networked Systems Design and Im-
plementation (NSDI), 2016.
589
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:03:34 UTC from IEEE Xplore.  Restrictions apply. 
[14] I. Eyal and E. G. Sirer, “Majority is not enough: Bitcoin min-
ing is vulnerable,” in Proceedings of the 18th Int’l Conference
Financial Cryptography and Data Security (FC), 2014, pp.
436–454.
[29] A. Miller, Y. Xia, K. Croman, E. Shi, and D. Song, “The
honey badger of bft protocols,” in Proceedings of the 2016
ACM SIGSAC Conference on Computer and Communications
Security (CCS), 2016, pp. 31–42.
[15] H. Finney,
“Finney’s
[On-
line]. Available: https://bitcointalk.org/index.php?topic=3441.
msg48384#msg48384
attack,” February
2011.
[16] M. J. Fischer, N. A. Lynch, and M. S. Paterson, “Impossibility
of distributed consensus with one faulty process,” J. ACM,
vol. 32, no. 2, pp. 374–382, Apr. 1985.
[17] J. A. Garay, A. Kiayias, and N. Leonardos, “The bitcoin
backbone protocol: Analysis and applications,” in 34th An-
nual Int’l Conf. on the Theory and Applications of Crypto.
Techniques, 2015, pp. 281–310.
[18] A. Gervais, G. O. Karame, K. W¨ust, V. Glykantzis, H. Ritz-
dorf, and S. Capkun, “On the security and performance of
proof of work blockchains,” in Proceedings of
the 2016
ACM SIGSAC Conference on Computer and Communications
Security (CCS), 2016, pp. 3–16.
[19] S. Gilbert and N. Lynch, “Brewer’s conjecture and the feasi-
bility of consistent, available, partition-tolerant web services,”
ACM SIGACT News, vol. 33, pp. 51–59, 2002.
[20] J. G¨obel, H. Keeler, A. Krzesinski, and P. Taylor, “Bit-
coin blockchain dynamics: The selﬁsh-mine strategy in the
presence of propagation delay,” Performance Evaluation, Juy
2016.
[21] V. Gramoli, “On the danger of private blockchains,” in
Workshop on Distributed Cryptocurrencies and Consensus
Ledgers (DCCL’16), 2016.
[30] A. Most´efaoui, H. Moumen, and M. Raynal, “Signature-
free asynchronous byzantine consensus with T < N/3 and
O(N 2) messages,” in Proceedings of
the 2014 ACM
Symposium on Principles of Distributed Computing, ser.
PODC ’14. New York, NY, USA: ACM, 2014, pp. 2–
9. [Online]. Available: http://doi.acm.org/10.1145/2611462.
2611468
[31] ——, “Signature-free asynchronous binary byzantine consen-
sus with T < N/3, O(N 2) messages, and O(1) expected
time,” J. ACM, vol. 62, no. 4, pp. 31:1–31:21, Sep. 2015.
[32] R. Motwani and P. Raghavan, Randomized Algorithms. Cam-
bridge University Press, 1995.
[33] S. Nakamoto, “Bitcoin: a peer-to-peer electronic cash sys-
tem,” 2008, http://www.bitcoin.org.
[34] C. Natoli and V. Gramoli, “The balance attack against proof-
of-work blockchains: The r3 testbed as an example,” arXiv,
Tech. Rep. 1612.09426, 2016.
[35] ——, “The blockchain anomaly,” in Proceedings of the 15th
IEEE International Symposium on Network Computing and
Applications (NCA’16), Oct 2016.
[36] K. Nayak, S. Kumar, A. Miller, and E. Shi, “Stubborn
mining: Generalizing selﬁsh mining and combining with an
eclipse attack,” in IEEE European Symposium on Security
and Privacy, EuroS&P 2016, Saarbr¨ucken, Germany, March
21-24, 2016, 2016, pp. 305–320.
[22] E. Heilman, A. Kendler, A. Zohar, and S. Goldberg, “Eclipse
attacks on bitcoin’s peer-to-peer network,” in 24th USENIX
Security Symposium, 2015, pp. 129–144.
[37] R. Pass, L. Seeman, and A. Shelat, “Analysis of
the
blockchain protocol in asynchronous networks,” Crytology
ePrint Archive, Tech. Rep. 454, 2016.
[23] K. J., “Tendermint: Consensus without mining v.0.7,” 2016.
[24] G. Karame, E. Androulaki, and S. Capkun, “Two bitcoins at
the price of one? double-spending attacks on fast payments in
bitcoin,” IACR Cryptology ePrint Archive, vol. 2012, p. 248,
2012.
[25] P.
J.
and
Litke
“BGP
for
cryptocurrency proﬁt,” August 2014.
[Online]. Avail-
able: https://www.secureworks.com/research/bgp-hijacking-
for-cryptocurrency-proﬁt
hijacking
Stewart,
[26] L. Luu, V. Narayanan, C. Zheng, K. Baweja, S. Gilbert, and
P. Saxena, “A secure sharding protocol for open blockchains,”
in Proceedings of the 2016 ACM SIGSAC Conference on
Computer and Communications Security, 2016, pp. 17–30.
[27] S. Micali, “Algorand: The efﬁcient and democratic ledger.
corr abs/1607.01341,” arXiv, Tech. Rep. 1607.01341, 2016.
[28] A. Miller, J. Litton, A. Pachulski, N. Gupta, D. Levin,
N. Spring, and B. Bhattacharjee, “Discovering Bitcoin’s net-
work topology and inﬂuential nodes,” University of Maryland,
Tech. Rep., 2015.
[38] M. Rosenfeld, “Analysis of hashrate-based double-spending,”
2012.
[39] Y. Sompolinsky and A. Zohar, “Secure high-rate transaction
processing in bitcoin,” in Financial Cryptography and Data
Security - 19th International Conference, FC 2015, San Juan,
Puerto Rico, January 26-30, 2015, Revised Selected Papers,
2015, pp. 507–527.
[40] vector76,
“The
2011.
[Online]. Available: https://bitcointalk.org/index.php?topic=
36788.msg463391#msg463391
vector76
attack,”
August
[41] G. Wood, “Ethereum: A secure decentralised generalised
transaction ledger,” 2015, yellow paper.
590
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:03:34 UTC from IEEE Xplore.  Restrictions apply.