Web ecosystem once again.
6. BACK-OFFICE TRAFFIC: ESTIMATION
The raw numbers of IPs involved in back-ofﬁce activity do not
tell us much about how much back-ofﬁce trafﬁc we observe from
our vantage points — estimating the volume of this trafﬁc is the
topic of this section.
6.1 Across vantage points
The methodology presented in Section 4 allows us to classify IPs
as Web crawlers, auctioneers, bidders, and intermediaries such as
CDPs. Thus, we can now quantify the amount of back- and front-
ofﬁce Web trafﬁc. For a packet to be classiﬁed as back-ofﬁce traf-
ﬁc, we require that both the source as well as the destination were
previously identiﬁed as part of the back-ofﬁce ecosystem. More
speciﬁcally, we require that the source IP address was previously
identiﬁed as belonging to an intermediary, crawler, or auctioneer,
and the destination IP:port pair matches one of our identiﬁed Web
server endpoints. We then tag this packet as back-ofﬁce trafﬁc, is-
sued by the source, namely a crawler, auctioneer, CDP, or other
intermediary.
Recall from Section 4 that we rely on passive and active mea-
surements to uncover intermediaries, as well as on manual identi-
ﬁcation of crawlers and auctioneers, and lastly on a list of CDN
servers. To account for the varying degrees of certainty when using
these data sets, we distinguish between three different classes when
quantifying back-ofﬁce trafﬁc.
In particular, we consider back-
ofﬁce trafﬁc caused by servers in our CDN data set (IPs-CDN),
caused by servers we identiﬁed using DPI and manual inspection
(IPs-DPI+Manual) and the back-ofﬁce trafﬁc caused by servers
identiﬁed using the ZMap data set (IPs-ZMap).
Figure 4(a) shows the percentage of back-ofﬁce trafﬁc of the to-
tal Web trafﬁc for each vantage point as a stacked bar plot. Thus,
we depict the volume of back-ofﬁce trafﬁc found with the different
methods: (a) information from the CDN only (the bottom bar), (b)
information from the IPs-CDN and IPs-DPI+Manual (the sum of
the bottom and the middle bar), (c) all information including ZMap
(the sum of all bars). Across all vantage points we see at least 5%
back-ofﬁce Web trafﬁc using the IPs-CDN and IPs-DPI+Manual
set of IPs, conﬁrming that back-ofﬁce Web trafﬁc is a signiﬁcant
contributor to today’s Internet Web trafﬁc. Even when only us-
ing the IPs-CDN data set, we see at least 4% back-ofﬁce trafﬁc at
all vantage points except for L-IXP. This does not mean that the
263c
i
f
f
a
r
t
b
e
w
e
c
i
f
f
o
-
k
c
a
b
%
 100
 80
 60
 40
 20
 0
IPs-ZMap - IPs-DPI+Manual - IPs-CDN
IPs-DPI+Manual - IPs-CDN
IPs-CDN
Name
L-IXP
M-IXP
BBone-1
BBone-2
% of
Bytes
Requests
Bytes
Requests
Bytes
Requests
Bytes
Requests
CDPs
12.1%
11.8%
73.3%
65.7%
50.7%
95.3%
93.6%
73.7%
1.1%
22.5%
Auctioneers Crawlers Other
76.5%
50.6%
25.2%
31.1%
49.2%
4.6%
6.3%
22%
10.3%
15.1%
1.5%
3.2%
<0.1%
<0.1%
<0.1%
4.3%
-
-
-
-
-
-
Table 5: Classiﬁcation of back-ofﬁce Web trafﬁc.
crease may be due to (a) a routing change or (b) a change in the
operation of the application infrastructure or (c) a change in the
popularity of a Web application. In addition, we see more variabil-
ity for the individual backbone links than for the IXPs. A likely
explanation for this is that the IXPs aggregate the information from
thousands of different peering links. Similar observations hold for
the percentages of back-/front-ofﬁce requests and responses (not
shown).
6.2 Across peering links
The two backbone traces illustrate that there can be notable dif-
ferences in terms of percentages of back-ofﬁce bytes and requests
on different links, suggesting that links should be examined indi-
vidually. Hence, we now take advantage of our ability to dissect
the trafﬁc seen on hundreds of individual AS-AS links at L-IXP.
Figure 5(a) shows the fractions of back-ofﬁce trafﬁc per AS-AS
link (of the total trafﬁc carried over it), where we sort them by the
fraction of back-ofﬁce Web trafﬁc. We see that the fractions vary
drastically from 100% to 0%. Indeed, 18.2% (10.9%) of the peer-
ing links carry more than 15% (7%) back-ofﬁce bytes when relying
on the IPs-ZMap + IPs-DPI+Manual (IPs-DPI+Manual) data set.
On the other hand, 25.5% (40.8%) of the peering links carry no
back-ofﬁce trafﬁc at all. In order to get a better understanding of
the most important AS-AS links, we inspect more closely the top-
10 trafﬁc-carrying links that have a fraction of back-ofﬁce trafﬁc
larger than 95%. We ﬁnd four links between cloud providers and
content providers, three links between search engines and hosting
providers, two links between CDNs and content providers, and one
link between a content provider and an online advertisement com-
pany. This analysis illustrates the diversity of the players contribut-
ing to the back-ofﬁce Web trafﬁc.
If we aggregate the information to the level of IXP member-
ASes, the overall observation does change a bit, as shown in Fig-
ure 5(b). We do not see member ASes that exchange only back-
ofﬁce Web trafﬁc. They all have at least 20% front-ofﬁce Web
trafﬁc. Nevertheless, most have some fraction of back-ofﬁce traf-
ﬁc. There are 19.2% (18.0%) of the members with more than
15% (7%) back-ofﬁce bytes for the IPs-ZMap + IPs-DPI+Manual
(IPs-DPI+Manual) data set. Among the networks with the highest
share of back-ofﬁce trafﬁc are cloud providers, hosting providers,
a search engine, and an advertisement company.
Summary
We ﬁnd a signiﬁcant percentage of back-ofﬁce Web trafﬁc in our
traces, yet this percentage varies from vantage point to vantage
point.
Indeed, the back-ofﬁce trafﬁc carried over the backbone
links is mostly dominated by CDPs. The picture differs when look-
ing at IXPs, where we can monitor multiple links at once. While
most of the back-ofﬁce trafﬁc there is also due to CDPs and other
intermediaries, real-time-bidding and crawling also contribute a
signiﬁcant share of bytes and Web requests. Our analysis illus-
R
e
q
u
B
ytes
L-IXP
R
e
q
u
B
ytes
M-IXP
R
e
q
u
B
ytes
BBone-1
R
e
q
u
B
ytes
BBone-2
ests
(a) % of Web trafﬁc which is back-ofﬁce across vantage points.
ests
ests
ests
c
i
f
f
a
r
t
b
e
w
e
c
i
f
f
o
-
k
c
a
b
%
BBone-2
M-IXP
L-IXP
BBone-1
 50
 40
 30
 20
 10
 0
 0
 24
 48
 72
 96
 120
 144
 168
Elapsed hours since 00:00 CET
(b) % of Web trafﬁc which is back-ofﬁce over time (IPs-ZMap).
Figure 4: Fraction of back-/front-ofﬁce Web trafﬁc across van-
tage points.
CDN is not active here but most of its trafﬁc is front-ofﬁce traf-
ﬁc. In terms of requests, the fraction of requests associated with
back-ofﬁce trafﬁc is even larger with a minimum of 9% when us-
ing the IPs-CDN and IPs-DPI+Manual sets. This points out that
some components of back-ofﬁce trafﬁc are associated with smaller
transactions. But asymmetric routing—meaning the forward and
return path do not use the same link— are likely the explanation
for the extreme difference at BBone-1, where we see a huge num-
ber of back-ofﬁce requests but only a relatively small percentage of
back-ofﬁce bytes. When we include the ZMap server IPs, the per-
centages of back-ofﬁce trafﬁc increases to more than 10% across
all vantage points.
We next dissect the back-ofﬁce trafﬁc by type of activity using
the IPs-DPI+Manual and the IPs-ZMap information. We illustrate
our ﬁndings in Table 5, where we attribute back-ofﬁce trafﬁc to
the entity that acts as client. We ﬁnd that CDPs contribute 11%
and 12% to the back-ofﬁce requests and bytes in the L-IXP trace.
The crawlers contribute 15% and 10% to the back-ofﬁce requests
and bytes, respectively. Surprisingly, the auctioneers are the big
contributors to the number of requests with a share of 22% but only
1% of the bytes. The rest of intermediaries contribute more than
76% and 50% of the back-ofﬁce bytes and requests. The situation
differs for the other vantage points, where CDPs clearly dominate
the share of bytes and requests with at least 50% of the bytes and
65% of the requests.
Figure 4(b) shows how the percentages of back- and front-ofﬁce
bytes change over time using time bins of one hour. The percent-
ages never decrease below 5% but can even exceed 40%. While
some trafﬁc is triggered by end-user action, activities such as crawl-
ing and cache synchronization are not. We see that, particularly for
the two IXPs, the percentage of back-ofﬁce trafﬁc increases during
the off-hours. The percentage of back-ofﬁce trafﬁc for BBone-2
increases on the third day of the trace by more than 10%. This in-
264s
k
n
i
l
f
o
n
o
i
t
c
a
r
f
1.0
0.9
0.8
0.7
0.6
0.5
0.4
IPs−CDN + IPs−DPI+Manual + IPs−ZMap
IPs−CDN + IPs−DPI+Manual
c
i
f
f
a
r
t
e
c
i
f
f
o
−
k
c
a
b
f
o
n