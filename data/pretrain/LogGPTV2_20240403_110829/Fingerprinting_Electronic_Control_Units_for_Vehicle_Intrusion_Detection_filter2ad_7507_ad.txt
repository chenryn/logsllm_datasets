O
(
t
e
s
f
f
200
400
600
800
Time [Sec]
8
6
4
2
0
3
2
1
0
O
k
c
o
C
l
.
m
u
c
c
A
)
e
(
r
o
r
r
E
n
o
i
t
a
c
i
f
i
t
n
e
d
I
(cid:1)106
w/o attack
w/ attack
0
200
400
600
800
Time [Sec]
(cid:1)106
)
c
c
a
O
150
(
t
e
s
f
f
O
k
c
o
C
l
.
m
u
c
c
A
100
50
0
0
w/o attack
w/ attack
500
1000
1500
Time [Sec]
-1
0
200
400
600
800
Time [Sec]
0
500
1000
1500
Time [Sec]
a
c
i
f
i
t
n
e
d
I
)
c
c
a
O
(
t
e
s
f
f
O
k
c
o
C
l
.
m
u
c
c
A
)
e
(
r
o
r
r
E
n
o
i
t
(cid:1)107
w/o attack
w/ attack
0
(cid:1)106
500
1000
1500
Time [Sec]
3
2
1
0
3
2
1
0
-1
0
500
1000
1500
Time [Sec]
) (cid:1)107
6
+
L
(
t
i
m
L
i
l
o
r
t
n
o
C
r
e
p
p
U
4
2
0
0
500
1000
1500
Time [Sec]
10
0
-10
600
400
200
)
e
(
r
o
r
r
E
n
o
i
t
a
c
i
f
i
t
n
e
d
I
)
+
L
(
t
i
m
L
i
l
o
r
t
n
o
C
r
e
p
p
U
-10
0
200
400
600
800
Time [Sec]
)
+
L
(
t
i
m
L
i
l
o
r
t
n
o
C
r
e
p
p
U
8000
6000
4000
2000
0
0
200
400
600
800
Time [Sec]
) (cid:1)109
2
+
L
(
t
i
i
m
L
l
o
r
t
n
o
C
r
e
p
p
U
1.5
1
0.5
0
0
200
400
600
800
Time [Sec]
0
0
500
1000
1500
Time [Sec]
(a) Fabrication attack.
(b) Suspension attack.
(a) Fabrication attack.
(b) Suspension attack.
Figure 6: CIDS defending fabrication attack (left) and
suspension attack (right) in a CAN bus prototype.
Figure 7: CIDS defending fabrication attack (left) and
suspension attack (right) in a Honda Accord 2013.
show that CIDS’s ﬁngerprinting is not limited to a spe-
ciﬁc vehicle model, and can thus be applied to other ve-
hicle models.
5.2 Defending Against Fabrication and
Suspension Attacks
On both the CAN bus prototype and the real vehicle set-
ting (Honda Accord 2013), we launch the fabrication and
suspension attacks, and evaluate CIDS’s effectiveness in
detecting them.2 To this end, we consider CIDS to only
perform per-message detection, and will later evaluate
CIDS with message-pairwise detection.
CAN bus prototype. For evaluation of CIDS defend-
ing against fabrication attack on the CAN bus proto-
type, B was programmed to inject a fabricated message at
t = 400 secs with ID=0x11, which is a periodic message
usually sent by A, i.e., B launches a fabrication attack on
A. ECU R was running CIDS on message 0x11 and de-
rived accumulated clock offset (Oacc), identiﬁcation er-
ror (e), and control limits (L+, L−). For the suspension
attack, A was instead programmed to stop transmitting
0x11 at t = 400 secs.
Fig. 6(a) shows how such values changed for mes-
sage 0x11 in the presence and absence of a fabrication
attack. As soon as B mounted a fabrication attack, as dis-
cussed in Section 4.2, there was a sudden positive shift in
the accumulated clock offset, thus yielding a high iden-
2As the attacks cannot be emulated using the CAN log data, we do
not consider their use for evaluating CIDS against the attacks.
tiﬁcation error. Due to such a shift, the upper control
limit, L+, of CUSUM suddenly increased and exceeded
its threshold ΓL =5, i.e., detecting an intrusion. Sim-
ilarly, Fig. 6(b) shows that since the suspension attack
also shifted the accumulated clock offset signiﬁcantly,
CIDS was able to detect the attack.
Real vehicle. To evaluate CIDS against the fabrication
attack under the real vehicle setting, one CAN prototype
node R was programmed to run CIDS, and another node
A as an adversary mounting the attack on a real ECU.
The attack was mounted by injecting a fabricated attack
message with ID=0x1B0, which was sent every 20ms by
some real in-vehicle ECU, i.e., A mounted the fabrica-
tion attack on a Honda Accord ECU sending 0x1B0. For
the suspension attack, the message ﬁlter of R was reset
at t = 420 secs so as to no longer receive 0x1B0, thus
emulating the suspension attack.
Fig. 7(a) shows how accumulated clock offsets (Oacc),
identiﬁcation errors (e), and upper control limits (L+)
changed for both cases of with and without a fabrica-
tion attack. Again, the attack message injected at around
t = 420 secs caused a sudden increase in Oacc and e, thus
increasing L+ to exceed ΓL =5. As a result, CIDS de-
clares the detection of an attack. After the attack, since
0x1B0 was still periodically sent by the real in-vehicle
ECU, the clock skew — i.e., the slope of Oacc graph —
remains unchanged. Similarly, as shown in Fig. 7(b), the
suspension attack increases the offset values, thus caus-
ing L+ to exceed the threshold, i.e., the suspension attack
was detected by CIDS.
USENIX Association  
25th USENIX Security Symposium  921
0x55 (before attack)
0x55 (after attack)
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
)
F
M
P
(
n
o
i
t
c
n
u
F
s
s
a
M
y
t
i
l
i
b
a
b
o
r
P
50.5~51.5ms
0
48.5
49
49.5
50
50.5
51
51.5
Message Interval [ms]
0x1B0 (before attack)
0x1B0 (after attack)
1
0.8
0.6
0.4
0.2
)
F
M
P
(
n
o