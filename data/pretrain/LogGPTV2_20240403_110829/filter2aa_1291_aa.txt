Co
v
ert
Messaging
Through
TCP
Timestamps
John
Gin

Rac
hel
Greenstadt

P
eter
Lit
w
ac
k

Ric
hard
Tibb
etts

fgifgreeniep
li
twa
ck
ti
bb
et
tsg
m
it
ed
u
Massac
h
usetts
Institute
of
T
ec
hnology
Abstract
W
e
presen
t
a
proto
col
for
sending
data
o
v
er
a
common
class
of
lo
wbandwidth
co
v
ert
c
hannels
Co
v
ert
c
hannels
exist
in
most
com
m
unications
systems
and
allo
w
individuals
to
comm
unicate
truly
unde
tectably
Ho
w
ev
er
co
v
ert
c
hannels
are
seldom
used
due
to
their
complex
it
y
Our
proto
col
is
b
oth
practical
and
secure
against
attac
k
b
y
p
o
w
erful
adv
ersaries
W
e
implemen
t
our
proto
col
on
a
standard
platform
Lin
ux
exploiting
a
c
hannel
in
a
common
comm
unications
system
TCP
times
tamps

In
tro
duction
A
co
v
ert
c
hannel
is
a
comm
unications
c
hannel
whic
h
allo
ws
information
to
b
e
transferred
in
a
w
a
y
that
violates
a
securit
y
p
olicy
As
a
result
co
v
ert
c
hannels
are
imp
ortan
t
metho
ds
of
censorship
resistance
An
eectiv
e
co
v
ert
c
hannel
is
undetectable
b
y
the
adv
ersary
and
can
pro
vide
a
strong
degree
of
priv
acy
Often
the
fact
that
secret
comm
unication
is
taking
place
b
et
w
een
parties
is
extremely
rev
ealing
Consider
the
prisoners
problem
rst
form
ulated
b
y
Simmons
Alice
and
Bob
are
in
prison
attempting
to
plan
an
escap
e
They
are
allo
w
ed
to
comm
uni
cate
but
a
W
arden
w
atc
hes
all
of
their
comm
unications
If
the
W
arden
notices
that
they
are
planning
to
escap
e
or
ev
en
susp
ects
them
of
trying
to
comm
unicate
secretly
they
will
b
e
placed
in
solitary
connemen
t
The
prisoners
problem
is
theoretically
in
teresting
and
pro
vides
a
go
o
d
ex
planation
of
the
problem
that
co
v
ert
c
hannels
solv
e
this
problem
is
increasingly
relev
an
t
in
real
w
orld
situations
Man
y
go
v
ernmen
ts
pro
vide
restrictions
on
the
use
of
cryptograph
y
on
their
systems
The
situation
is
particularly
extreme
in
China
where
all
ISPs
are
sub
ject
to
go
v
ernmen
t
con
trol
although
electronic
systems
are
increasingly
sub
ject
to
surv
eillance
in
all
parts
of
the
w
orld
as
at
tempts
to
in
tegrate
Carniv
ore
monitoring
systems
in
US
ISPs
has
sho
wn
Priv
ate
companies
increasingly
monitor
and
censor
comm
unications
with
re
w
alls
An
eectiv
e
co
v
ert
c
hannel
requires
sev
eral
apparen
tly
con
tradictory
prop
er
ties
Plausibilit
y
the
adv
ersary
m
ust
b
eliev
e
that
it
is
not
only
p
ossible
but
lik
ely
that
the
user
of
the
co
v
ert
c
hannel
is
using
the
medium
in
whic
h
the
co
v
ert
c
hannel
is
found
without
sending
co
v
ert
data
Randomness
In
order
for
the
c
hannel
to
b
e
undetectable
the
bits
in
whic
h
data
is
sen
t
m
ust
b
e
random
otherwise
the
high
en
trop
y
signature
of
en
crypted
data
will
b
e
noticed
Indisp
ensabilit
y
The
c
hannel
m
ust
b
e
something
whic
h
an
adv
ersary
cannot
or
will
not
close
o
usually
due
to
the
fact
that
it
serv
es
some
useful
function
to
the
users
whic
h
are
not
sending
co
v
ert
data
TCP
timestamps
are
useful
for
this
purp
ose
b
ecause
they
satisfy
these
prop
erties
to
a
high
degree
TCP
is
ubiquitous
proto
col
used
all
o
v
er
the
w
orld
for
the
ma
jorit
y
of
all
In
ternet
trac
It
is
almost
alw
a
ys
emplo
y
ed
using
the
timestamp
option
As
a
result
it
is
extremely
plausible
that
the
ma
jorit
y
of
users
using
TCP
will
not
b
e
sending
co
v
ert
data
and
ha
v
e
a
go
o
d
reason
for
using
it
On
a
slo
w
connection
the
lo
w
order
bits
of
timestamps
app
ear
random
As
a
result
statistical
analysis
of
the
headers
of
the
pac
k
et
will
b
e
ineectiv
e
in
detecting
the
c
hannel
Since
TCP
is
so
widely
emplo
y
ed
it
is
lik
ely
that
users
who
are
not
sending
co
v
ert
data
w
ould
react
unfa
v
orably
to
attempts
to
mo
dify
their
TCP
pac
k
ets
on
a
large
scale
or
to
limit
the
timestamp
option
whic
h
is
used
to
ensure
high
p
erformance
The
c
hannel
is
brok
en
if
it
is
detected
b
y
the
adv
ersary
This
situation
can
b
e
mo
deled
as
follo
ws
F
or
an
y
t
w
o
TCP
connections
t

and
t

on
the
same
net
w
ork
an
adv
ersary
cannot
distinguish
whic
h
of
the
connections
is
using
with
probabilit
y
greater
than


The
c
hannel
is
also
brok
en
if
the
adv
ersary
can
den
y
service
to
the
users
of
the
co
v
ert
c
hannel
while
still
allo
wing
service
to
the
users
of
unmo
died
TCP
connections
The
adv
ersary
has
the
p
o
w
er
to
monitor
all
the
trac
on
the
net
w
ork
and
to
mo
dify
some
trac
The
adv
ersary
only
views
net
w
ork
trac
and
cannot
see
the
pro
cessing
of
pac
k
ets
on
sender
and
receiv
er
mac
hines
W
e
consider
an
ea
v
esdropp
er
who
has
the
p
o
w
er
to
mo
dify
an
y
n
um
b
er
of
pac
k
ets
but
cannot
constan
tly
mo
dify
pac
k
ets
sen
t
b
y
a
single
host
In
the
prisoners
analogy
the
w
arden
w
ould
not
b
e
constan
tly
c
hanging
ev
ery
message
whic
h
passes
b
et
w
een
prisoners
but
migh
t
o
ccasionally
mo
dify
some
messages
in
the
hop
es
of
detecting
co
v
ert
comm
unication
The
w
arden
lac
ks
the
resources
to
mo
dify
ev
ery
message
sen
t
b
et
w
een
ev
ery
prisoner
all
of
the
time
If
the
w
arden
w
as
sucien
tly
suspicious
of
one
prisoner
to
mo
dify
all
of
their
messages
he
w
ould
just
put
that
prisoner
in
solitary
and
b
e
done
with
it
It
is
notable
to
realize
that
if
a
more
p
o
w
erful
adv
ersary
than
this
is
willing
and
capable
of
either
prev
en
ting
users
from
using
the
timestamp
option
with
TCP
or
o
v
erwriting
the
lo
w
order
bits
of
TCP
timestamps
of
ev
ery
pac
k
et
then
the
adv
ersary
will
ha
v
e
closed
the
c
hannel
W
e
assume
that
the
adv
ersary
is
either
un
willing
to
do
this
unable
to
do
this
or
will
b
e
anno
y
ed
b
y
b
eing
forced
to
do
this
In
addition
w
e
b
eliev
e
that
ev
en
if
this
c
hannel
is
closed
the
tec
hniques
presen
ted
in
this
pap
er
will
b
e
useful
in
pro
viding
reliable
comm
unication
o
v
er
other
lo
w
bandwidth
co
v
ert
c
hannels
It
is
also
useful
to
realize
that
ev
en
if
the
adv
ersary
denies
service
to
the
c
hannel
he
still
cannot
detect
whether
co
v
ert
data
w
as
b
eing
sen
t
regardless
of
ho
w
m
uc
h
data
he
mo
dies
or
snip
es
Most
of
the
in
teresting
w
ork
whic
h
w
e
ha
v
e
done
deals
with
the
problem
of
sending
a
message
at
a
rate
of
one
bit
p
er
pac
k
et
o
v
er
an
unreliable
c
hannel
and
w
e
b
eliev
e
that
ev
en
if
this
particular
c
hannel
is
closed
the
w
ork
w
e
ha
v
e
done
will
b
e
relev
an
t
to
other
similar
c
hannels
that
ma
y
b
e
iden
tied

Related
W
ork
Man
y
other
c
hannels
ha
v
e
b
een
iden
tied
in
TCP
These
include
initial
sequence
n
um
b
ers
ac
kno
wledged
sequence
n
um
b
ers
windo
wing
bits
and
proto
col
iden
ti
cation	
These
pap
ers
fo
cus
on
nding
places
where
co
v
ert
data
could
p
oten
tially
b
e
sen
t
but
do
not
w
ork
out
the
details
of
ho
w
to
send
it
Those
implemen
tations
whic
h
exist
generally
place
in
to
header
elds
v
alues
that
are
incorrect
unreasonable
or
ev
en
outside
the
sp
ecication
As
long
as
the
ad
v
ersary
is
not
lo
oking
this
ma
y
b
e
eectiv
e
but
it
will
stand
up
to
concerted
attac
k
b
eing
eectiv
ely
securit
y
through
obscurit
y
These
systems
do
cannot
withstand
statistical
analysis
The
TCP
proto
col
is
describ
ed
in
RF
C
	
A
securit
y
analysis
TCPIP
can
b
e
found
in

W
e
are
certainly
not
the
rst
group
of
p
eople
to
iden
tify
the
p
ossibilit
y
of
using
the
TCPIP
Proto
col
Suite
for
the
purp
oses
of
transmitting
co
v
ert
data
In
Co
v
ert
Channels
in
the
TCPIP
Proto
col
Suite
Craig
Ro
wland
describ
es
the
p
ossibilit
y
of
passing
co
v
ert
data
in
the
IP
iden
tication
eld
the
initial
sequence
n
um
b
er
eld
and
the
TCP
ac
kno
wledge
Sequence
Num
b
er
Field
He
wrote
a
simple
pro
ofofconcept
ra
wso
c
k
et
implemen
tation
covert