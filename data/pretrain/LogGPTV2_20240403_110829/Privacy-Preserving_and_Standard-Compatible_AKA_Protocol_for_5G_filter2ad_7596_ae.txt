ployed based on current implementations.
The results are shown by Table 3, where the costs for each
endpoint in all execution cases are presented in microseconds
and are taken the average of 1000 runs with the chrono library
provided by C++11. The content of Table 3 demonstrates
that 5G-AKA(cid:48) only brings limited additional time costs than
5G-AKA. For the UE side, the migration from 5G-AKA to
5G-AKA(cid:48) will only involves an extra time cost of 0.03%. For
the HN side, 5G-AKA(cid:48) only brings 0.02% ~ 0.03% additional
time cost.
6 Formal Veriﬁcation
In this section, we evaluate the security of 5G-AKA(cid:48) with
state-of-the-art symbolic veriﬁcation tool Tamarin Prover [47].
Tamarin Prover is a powerful and efﬁcient symbolic veriﬁca-
tion tool, and has been employed in the analyses of complex
security protocols [24, 31, 32, 56]. To the best of our knowl-
edge, it is also the only tool that can model the properties
which are necessary for 5G-AKA [25, 33].
Our formal veriﬁcation consists of two parts. For the ﬁrst
part, we prove that 5G-AKA(cid:48) satisﬁes the goals of authentica-
tion and secrecy, with a modiﬁed Tamarin Prover’s script for
2https://www.cryptopp.com
Left Hand System (LHS)
Right Hand System (RHS)
(k1,SUPI1,SQNUE1)
(k1,SUPI1,SQNUE1)
UE(cid:48)†
1
UE(cid:48)†
1
UE1
UE2
(k1,SUPI1,SQNUE1+1)
(k2,SUPI2,SQNUE2)
Figure 8: The conﬁgurations of RHS and LHS, where † de-
notes that this session can either be a 4G-AKA session or a
5G-AKA(cid:48) one.
5G-AKA by Basin et al. [24]. In the second part, we develop
a new script to verify that 5G-AKA(cid:48) is able to protect the
privacy of users even in the presence of active attackers and
achieves the desired goal for privacy. It borrows the idea of
simplifying the components from the modeling presented by
Basin et al. [24] so as to decrease the scale of search space,
and is designed following a new idea of dividing the proto-
col execution with two AKA sessions in order to obtain a
reasonable modeling for the goal of privacy.
for 5G-AKA(cid:48) and then the results of formal veriﬁcation.
In this section, we ﬁrst present the major modeling choices
6.1 The Modeling Choices of 5G-AKA(cid:48)
The formal veriﬁcation requires the modeling of ECIES in the
KEM/DEM paradigm and a comprehensive script for privacy
goals, where the major choices are described as follows:
• Modeling ECIES following the KEM/DEM Paradigm. In
the modeling script, we model a generic asymmetric encryp-
tion scheme which is designed following the KEM/DEM
paradigm, rather than just model ECIES with the Tamarin’s
built-in theory which describes operations over a difﬁe-
hellman group. This allows our formal analysis to satisfy a
wide range of variants of 5G-AKA(cid:48) which are constructed
by other asymmetric encryption schemes designed follow-
ing the KEM/DEM paradigm.
USENIX Association
30th USENIX Security Symposium    3607
To be more speciﬁc, we deﬁne four functions and an equa-
tion over these functions following Tamarin Prover’s gram-
mars for customized primitives, including encap, getkey,
getcipher and decap, where encap and decap model the key
encapsulation algorithm and key decapsulation algorithm
respectively. However, encap cannot model the key encap-
sulation operation alone, since the real-world algorithm
outputs a tuple consisting of two elements, but a function
in Tamarin Prover only outputs one. To solve this problem,
we use getkey to extract the temporary key from the output
of encap, and use getcipher for the ciphertext which encap-
sulates the key. We refer the reader to Appendix A.2 for the
details of these functions and equation.
• Modeling Privacy Goals. Tamarin Prover provides a diﬀ
operator to model and check privacy-type (or cryptographic
indistinguishable) properties. It takes two parameters as
input. With this operator, Tamarin automatically generates
two systems for one script, namely the Right Hand System
(RHS) and the Left Hand System (LHS), where RHS ap-
plies the ﬁrst parameter of diﬀ, and LHS uses the second
one. Besides RHS and LHS, Tamarin Prover also automati-
cally generates a lemma called observational equivalence,
which claims that the attacker can not distinguish LHS from
RHS (resp., RHS from LHS) in its view. A violation of this
lemma implies that Tamarin Prover ﬁnds a path (i.e., a se-
ries of activities that a real-world attacker can follow) that
makes the attacker to distinguish LHS from RHS (resp.,
RHS from LHS), which means an attack vector on privacy
has been found.
To verify the goal of privacy, we want to check that whether
an attacker can distinguish between UE1 and UE2 even if
it has interacted with one of them (say, UE1) and recorded
the messages. Thus, we use RHS to model the case of
two successive sessions of UE1, and LHS for the case that
the second session is attended by UE2. If an attacker can
distinguish between LHS and RHS, then it can leverage the
detected path to mount linkability attacks in practice. The
attacker is allowed to either record a 4G-AKA session or a
5G-AKA(cid:48) one in its ﬁrst interaction with UE1. The details
are shown in Figure 8, and explained as follows:
– For the LHS, we denote the UE instances by UE(cid:48)
1 and
UE1, which corresponds to two successive sessions at-
tended by the same UE. They share the same k and SUPI,
and only differ in SQNUE, where SQNUE1 = SQNUE(cid:48)
+1.
1
Here, we consider the extreme case that the attacker
knows that the SQNUE1 has increased by 1.
– For the RHS, the two UEs are different and differ in k,
SUPI and SQNUE.
Thus, the observational equivalence lemma claims that, the
attacker can not distinguish whether it is interacting with
UE1 or UE2, even if it can capture and replay the messages
from an old session attended by UE1. This implies that the
Point of View
Partner
Weak agreement
Agreement on Kseaf
Agreement on IDSN
Agreement on SUPI
Secrecy on Kseaf
UE
SN
HN
SN HN UE HN UE
SN
I
wa
wa
I
NI
wa
I
wa
wa
I
wa
NI
I
NI
wa
I
wa
-
Table 4: The authentication and secrecy goals achieved by 5G-
AKA(cid:48). We use I to denote injective agreement and NI for non-
injective agreement. “wa” means the property of non-injective
agreement has been implied by the lemma of weak agreement.
“-” denotes that this property is violated by deﬁnition and is
not desired by TS 33.501 [20].
attacker cannot link the AKA sessions participated by the
target UE (i.e., UE1), which eliminates the possibility of UE
tracing. Moreover, our modeling adopts Tamarin Prover’s
default communication model for the trafﬁc between the
UE and SN, which allow the existence of active attacker,
and uses the modeling of secure channels for the commu-
nication between the SN and HN following the script by
Basin et al. [24].
• Modeling MAC Failure. Our model also covers the case of
MAC failure, which is necessary for the proof of privacy, as
all attacks rely on this message. We also note that this cap-
tures the case that a UE decrypts the challenge sent by the
HN with a wrong key, and refer the reader to Appendix A.3
for the detail.
6.2 Veriﬁcation Results
Next, we report the results of the formal analysis w.r.t., the
goals for privacy, authentication and secrecy as follows:
Privacy. Before the proof for 5G-AKA(cid:48), we ﬁrst ﬁnd the
paths of existing linkability attacks in 5G-AKA with our script.
This step helps us to establish the conﬁdence on the newly
developed model for privacy. For the 5G-AKA(cid:48) protocol, we
conﬁrm that there is no attack in all paths for the LHS and
RHS in both settings (i.e., UE(cid:48)
1 can be a 4G-AKA session or
a 5G-AKA(cid:48) session) on the basis of executability. Our result
for the privacy goal conﬁrms that 5G-AKA(cid:48) is able to protect
the privacy of users against an active attacker, which means
that an active attacker cannot perform linkability attacks that
invade the privacy of mobile users, and avoids the leakage
of user identiﬁers though linking a 5G-AKA(cid:48) session with a
4G-AKA one.
Authentication and Secrecy. To prove the goals for secrecy
and authentication, we mainly apply the lemmas provided by
Basin et al. [24], and show the achieved properties in Table 4.
In particular, the formal veriﬁcation proves that 5G-AKA(cid:48)
achieves Goals 2, 3, 4 and 5 as described in Section 4.2 . We
use six lemmas to prove that each pair of partners obtains the
3608    30th USENIX Security Symposium
USENIX Association
property of weak agreement, which also implies that the corre-
sponding properties of non-injective agreement on their identi-
ties hold. We also prove that each pair of partners also obtains
injective agreement on Kseaf , and the conﬁdentiality lemmas
hold on the views of every roles. We furthermore prove that
the UE and HN both obtain non-injective agreements on IDSN
with each other, and the SN obtains non-injective agreement
on SUPI with HN.
7 Conclusion
In this paper, we present 5G-AKA(cid:48) as a privacy-preserving
proposal for the AKA protocol of 5G. It is able to protect the
users’ privacy even in the presence of active attackers, which
provides stronger privacy guarantee than 5G-AKA [20].
Our approach is compatible with 3GPP’s speciﬁcations for
5G network and legacy SIM cards, which makes it suitable
to be standardized and deployed in practice. The migration
from 5G-AKA to 5G-AKA(cid:48) does not raise extra bandwidth
cost, only involves limited additional time costs, and may only
require software modiﬁcations on both endpoints (i.e., UE
and HN). The compatibility with legacy SIM cards enables
it to be deployed in a way of reusing 3G and 4G SIM cards,
which may adjust to mobile communication providers’ inter-
est. The standardization of 5G-AKA(cid:48) may include minimal
modiﬁcations on TS 33.501. This brings another advantage
that the already deployed SNs’ implementations do not need
to be changed due to the mitigation to 5G-AKA(cid:48).
Acknowledgments
The authors would like to thank the anonymous review-
ers of USENIX Security 2020 and 2021 for their help-
ful comments and suggestions. This work is supported by
the National Key Research and Development Program of
China (No.2017YFB0802000, 2017YFB0802500) and the
National Natural Science Foundation of China (No.61802376,
U1536205).
References
[1] TS 33.902: Formal Analysis of the 3G Authentication
Protocol (Release 4). Technical sepciﬁcation, 3rd Gener-
ation Partnership Project; Technical Speciﬁcation Group
Services and System Aspects;, September 2001.
[2] ISO/IEC 18033-2: Information technology – Security
techniques – Encryption algorithms – Part 2: Asym-
metric ciphers. ISO/IEC International Standards, May
2006.
[3] SEC 1: Elliptic Curve Cryptography version 2.0. Stan-
dards for efﬁcient cryptography, Certicom Research,
May 2009.
[4] SEC 2: Recommended Elliptic Curve Domain Param-
eters version 2.0. Standards for efﬁcient cryptography,
Certicom Research, July 2010.
[5] TR 33.899: Study on the security aspects of the next
generation system (Release 14). Technical report, 3rd
Generation Partnership Project (3GPP); Technical Spec-
iﬁcation Group Services and System Aspects (SA3),
August 2017.
[6] China mobile says 5g networks do not require new sim
cards, increased data usage. https://technode.com
/2018/05/04/5g-china-mobile/, May 2018.
[7] Free 5GC - Link the World. https://www.free5gc.
org/, July 2019.
[8] Open5gcore - the next mobile core network testbed plat-
form. https://www.open5gcore.org/, July 2019.
[9] Openairinterface - 5g software alliance for democratis-
ing wireless innovation. https://www.openairinter
face.org/, November 2019.
[10] Sim only deals - all our sims are 5g ready, at no ex-
tra cost. http://www.three.co.uk/Store/SIM-hub,
November 2019.
[11] Tamarin-prover manual: Security protocol analysis in
the symbolic model. https://tamarin-prover.git
hub.io/manual/index.html, 2019.
[12] TS 31.102: Characteristics of the Universal Subscriber
Identity Module (USIM) application (Release 16). Tech-
nical speciﬁcation, 3rd Generation Partnership Project;
Technical Speciﬁcation Group Core Network and Ter-
minals, June 2019.
[13] TS 31.102: Characteristics of the Universal Subscriber
Identity Module (USIM) application version 14.8.0 (Re-
lease 14). Technical speciﬁcation, 3rd Generation Part-
nership Project; Technical Speciﬁcation Group Core
Network and Terminals, June 2019.
[14] Vodafone 5g is here. https://www.vodafone.co.uk
/network/5g, October 2019.
[15] TS 23.502: 5G; Procedures for the 5G System (5GS)
(Release 16). Technical speciﬁcation, 3rd Generation
Partnership Project (3GPP), July 2020.
[16] TS 24.008: Digital cellular telecommunications system
(Phase 2+) (GSM); Universal Mobile Telecommunica-
tions System (UMTS); LTE; Mobile radio interface
Layer 3 speciﬁcation; Core network protocols; Stage
3 (Release-16). Technical speciﬁcation, 3rd Generation
Partnership Project (3GPP), July 2020.
USENIX Association
30th USENIX Security Symposium    3609
[17] TS 24.301: Non-Access-Stratum (NAS) protocol for
Evolved Packet System (EPS) (Release 16). Techni-
cal speciﬁcation, 3rd Generation Partnership Project
(3GPP); Technical Speciﬁcation Group Core Network
and Terminals, July 2020.
[18] TS 24.501: Non-Access-Stratum (NAS) protocol for 5G