| 16    | 预置多寄存器                       | 把具体的二进制值装入一串连续的保持寄存器 |
| 17    | 报告从机标识                       | 可使主机判断编址从机的类型及该从机运行指示灯的状态 |
| 18    | （ （884 和 MICRO 84） ）           | 可使主机模拟编程功能，修改 可使主机模拟编程功能，修改 PC 状态逻辑 状态逻辑 |
| 19    | 重置通信链路                       | 发生非可修改错误后，是从机复位于已知状态，可重置顺序字节 |
| 20    | 读取通用参数（ 读取通用参数（584L） ） | 显示扩展存储器文件中的数据信息 |
| 21    | 写入通用参数（ 写入通用参数（584L） ） | 把通用参数写入扩展存储文件，或修改之 |
**Modebus 异常码**
| 代码 | 名称 | 功能 |
| - | - | - |
| 01   | Illegal Function | 服务器不允许请求的操作 |
| 02   | Illegal Data Address | 服务器不允许的地址，准确地说，是起始地址与寄存器个数的组合是无效的，比如超出地址范围 |
| 03   | Illegal Data Value | 请求报文中数据域的值是服务器所不允许的，比如隐含的长度是不正确的 |
| 04   | Server Device Failure | 服务器试图响应时出现不可重新获得的错误 |
| 05   | Acknowledge | 与编程命令一起使用。返回这个响应以防止客户机中发生超时错误 |
| 06   | Server Device Busy | 与编程命令一起使用 |
| 08   | Memory Parity Error | 与功能码20和21以及参考类型6一起使用，指示扩展文件区不能通过一致性校验 |
| 0A   | Gateway Path Unavailable | 与网关一起使用，指示网关不能为处理请求分配输入端口至输出端口的内部通信路径 |
| 0B   | Gateway Target Device Failed to Respond | 与网关一起使用，指示没有从目标设备中获得响应 |
---
## Profinet
**简介**
PROFINET 由 IP 国际组织推出，是新一代基于工业以太网技术自动化总线标准，PROFINET-DCP 是发现和基本配置协议，用于标识与查询有无指定 IP 地址节点，然后配置 IP 地址、默认网关、子网掩码。DCP 是标准的 PROFINET 功能，可以读写设备与网络地址相关参数。由于只能在一个局域网中使用，通过实时通道传输，使用 DCP 协议可以实现不需要额外组态工程操作就能替换设备。
**相关文章**
- [一款针对Profinet协议漏洞渗透的工具](https://www.freebuf.com/sectool/203104.html)
**PROFINET-DCP set ip 流程**
![](../../../assets/img/Security/ICS/工控协议/1.png)
1. 控制器在网内以设备名为参数广播 DCP_Identify.req 请求，确认设备是否存在,设备接收到请求，检查其中的设备名是否与设备自身名字匹配
2. 如果匹配则发送 DCP_Identify.rsp 响应控制器请求，否则不做处理
3. 控制器收到设备回复后，将设备 MAC 地址作为以太网报文的目标地址,控制器将IP地址、子网掩码与网关作为参数发送报文 DCP_Set.req 给设备
4. 设备设置 IP 地址等参数完毕后，发送 DCP_Set.rsp 给控制器
---
## PROFIBUS
**简介**
一种用于工厂自动化车间级监控和现场设备层数据通信与控制的现场总线技术，可实现现场设备层到车间级监控的分散式数字控制和现场通信网络
---
## DNP3
> shodan : "port:20000 source address"
**简介**
DNP(Distributed Network Protocol，分布式网络规约)是一种应用于自动化组件之间的通讯协议，常见于电力、水处理等行业。SCADA 可以使用 DNP 协议与主站、RTU、及 IED 进行通讯。
---
## ICCP
**简介**
电力控制中心通讯协议。
---
## OPC
**简介**
过程控制的 OLE （OLE for Process Control）。
OPC 包括一整套接口、属性和方法的标准集，用于过程控制和制造业自动化系统。
---
## Niagara-Fox
> shodan : "port:1911,4911 product:Niagara"
**简介**
Fox 协议是 Tridium 公司开发的 Niagara 框架的一部分，广泛应用于楼宇自动化控制系统。
---
## BACnet
> shodan : "port:47808"
**简介**
楼宇自动控制网络数据通讯协议(BACnet)是针对采暖、通风、空调、制冷控制设备所设计，同时也为其他楼宇控制系统（例如照明、安保、消防等系统）的集成提供一个基本原则。
---
## GE-SRTP
> shodan : "port:18245,18246 product:"general electric""
**简介**
GE-SRTP 协议由美国通用电气公司开发，GE PLC 可以通过 GE-SRTP 进行数据通信和数据传输。
---
## HART-IP
> shodan : "port:5094 hart-ip"
**简介**
HART 协议是美国 Rosement 公司于1985年推出的一种用于现场智能仪表和控制室设备之间的通信协议。现已成为全球智能仪表的工业标准。
---
## PCWorx
> shodan : "port:1962 PLC"
**简介**
PCWorx 协议由菲尼克斯电气公司开发，目前广泛使用于工控系统。PCWORX3.11 是菲尼克斯电气公司的专用协议。
---
## MELSEC-Q
> shodan : "port:5006,5007 product:mitsubishi"
**简介**
MELSEC-Q 系列设备使用专用的网络协议进行通讯，该系列设备可以提供高速、大容量的数据处理和机器控制。
---
## OMRON-FINS
> shodan : "port:9600 response code"
**简介**
欧姆龙 PLC 使用网络协议 FINS 进行通信，可通过多种不同的物理网络，如以太网、控制器连接等。
---
## Crimson-v3
> shodan : "port:789 product:"Red Lion Controls"
**简介**
协议被 Crimson 桌面软件用于与 Red Lion G306 工控系统的 HMI 人机接口。
---
## Codesys
> shodan : "port:2455 operating system"
**简介**
CoDeSys 编程接口在全球范围内使用广泛，全球上百个设备制造商的自动化设备中都是用了该编程接口。
---
## ProConOS
> shodan : "port:20547 PLC"
**简介**
ProConOS 是德国科维公司(KW-Software GmbH)开发的用于 PLC 的实时操作系统，它是一个高性能的 PLC 运行时引擎，目前广泛使用于基于嵌入式和 PC 的工控系统。
---
## moxa-nport
**简介**
Moxa 串口服务器专为工业应用而设计。不通配置组合的串口服务器更能符合不同工业现场的需求。NPort 系列串口服务器让传统 RS-232/422/485 设备立即联网，提供基于 IP 的串口联网解决方案。
---
## IEC104
**相关工具**
- 电力规约报文解析器(IEC8705) - 电力规约报文解析器是 101 报文解析工具，以电力行业标准为依据，对国际电工委员会标准 IEC8705—101,103,104 等电力远动规约实现进行报文翻译的工具，电力调度专用规约 101、103、104 规约解析工具，支持解析 IEC101/IEC103/104 规约报文。