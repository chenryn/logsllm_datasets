# G0094: Kimsuky

## Description
[Kimsuky](https://attack.mitre.org/groups/G0094) is a North Korean-based threat group that has been active since at least September 2013. The group primarily targets Korean think tanks and entities related to the Democratic People's Republic of Korea (DPRK) and nuclear activities. Kimsuky was identified as the actor behind the compromise of Korea Hydro & Nuclear Power Co. (Citation: EST Kimsuky April 2019)(Citation: BRI Kimsuky April 2019).

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Windows, macOS, Linux, Office 365, SaaS | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | Kimsuky uses emails containing links to documents with malicious macros. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Linux, macOS, Windows | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Exfiltration Over Command and Control Channel](https://attack.mitre.org/techniques/T1041/) | Kimsuky exfiltrates data over its email C2 channel. | User interface, Process monitoring |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [New Service](https://attack.mitre.org/techniques/T1050/) | Kimsuky creates new services for persistence. | Windows Registry, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows, AWS, GCP, Azure | [Discovery](https://attack.mitre.org/tactics/discovery/) | [System Information Discovery](https://attack.mitre.org/techniques/T1082/) | Kimsuky gathers information about the infected computer. | Azure activity logs, Stackdriver logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Disabling Security Tools](https://attack.mitre.org/techniques/T1089/) | Kimsuky disables the system firewall and turns off Windows Security Center. | API monitoring, File monitoring, Services, Windows Registry, Process command-line parameters, Anti-virus |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [Process Injection](https://attack.mitre.org/techniques/T1055/) | Kimsuky uses Win7Elevate to inject malicious code into explorer.exe. | API monitoring, Windows Registry, File monitoring, DLL monitoring, Process monitoring, Named Pipes |
| Linux, macOS, Windows | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Data Encrypted](https://attack.mitre.org/techniques/T1022/) | Kimsuky encrypts data using RC4 before exfiltration. | File monitoring, Process monitoring, Process command-line parameters, Binary file metadata |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060/) | Kimsuky places scripts in the startup folder for persistence. | Windows Registry, File monitoring |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [File Deletion](https://attack.mitre.org/techniques/T1107/) | Kimsuky deletes exfiltrated data on disk after transmission. | File monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | [Discovery](https://attack.mitre.org/tactics/discovery/) | [File and Directory Discovery](https://attack.mitre.org/techniques/T1083/) | Kimsuky can enumerate all drives on an infected system. | File monitoring, Process monitoring, Process command-line parameters |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [PowerShell](https://attack.mitre.org/techniques/T1086/) | Kimsuky executes various PowerShell scripts. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credentials in Files](https://attack.mitre.org/techniques/T1081/) | Kimsuky uses a Google Chrome extension to steal passwords and cookies from browsers. | File monitoring, Process command-line parameters |
| Linux, macOS, Windows, GCP, AWS, Azure | [Collection](https://attack.mitre.org/tactics/collection/) | [Data from Local System](https://attack.mitre.org/techniques/T1005/) | Kimsuky collects Office, PDF, and HWP documents from victims. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Browser Extensions](https://attack.mitre.org/techniques/T1176/) | Kimsuky uses a Google Chrome extension to infect victims and steal passwords and cookies. | Network protocol analysis, Packet capture, System calls, Process use of network, Process monitoring, Browser extensions |
| Linux, Windows, macOS | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Remote Access Tools](https://attack.mitre.org/techniques/T1219/) | Kimsuky uses a modified TeamViewer client as a command and control channel. | Network intrusion detection system, Network protocol analysis, Process use of network, Process monitoring |
| Linux, macOS, Windows | [Collection](https://attack.mitre.org/tactics/collection/), [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Input Capture](https://attack.mitre.org/techniques/T1056/) | Kimsuky uses a PowerShell-based keylogger. | Windows Registry, Kernel drivers, Process monitoring, API monitoring |
| Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Mshta](https://attack.mitre.org/techniques/T1170/) | Kimsuky uses mshta to run malicious scripts on the system. | Process monitoring, Process command-line parameters |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/) | [Change Default File Association](https://attack.mitre.org/techniques/T1042/) | Kimsuky changes the default program association in the registry to open HWP documents. | Windows Registry, Process monitoring, Process command-line parameters |
| Windows, macOS, Linux | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193/) | Kimsuky uses emails containing Word, Excel, and/or HWP (Hangul Word Processor) documents in their spearphishing campaigns. | File monitoring, Packet capture, Network intrusion detection system, Detonation chamber, Email gateway, Mail server |