Let’s consider 16.000 interesting DNSSEC hashed records
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 20% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 40% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 55% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 66% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 72% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 80% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 85% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 88% of them
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 88% of them
Results breakdown
■ 75%: reversed the hash, found an interesting email redirection
■ 13%: reversed the hash, found something else
■ 12%: unhash failed (sad face)
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
Results
Let’s consider 16.000 interesting DNSSEC hashed records
Un-hashed 88% of them
Results breakdown
■ 75%: reversed the hash, found an interesting email redirection
■ 13%: reversed the hash, found something else
■ 12%: unhash failed (sad face)
Let’s look into the data !
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
29 / 40
3. All your data are belong to us
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
30 / 40
Disclaimer
■ We are not here to doxx people
■ All people names and domain names in the following examples have been
modiﬁed
With that in mind, let’s dig into the data and tell you what we found :)
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
31 / 40
Some statistics
■ Most webmasters’ real addresses...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
■ Email wouldn’t otherwise appear in a Google search...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
■ Email wouldn’t otherwise appear in a Google search...
about 45%
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
■ Email wouldn’t otherwise appear in a Google search...
about 45%
■ Identify business connections/conﬂict of interest/fake competitors...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
■ Email wouldn’t otherwise appear in a Google search...
about 45%
■ Identify business connections/conﬂict of interest/fake competitors... about 23%
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Some statistics
■ Most webmasters’ real addresses...
@gmail.com
■ Guessing name from email...
about 50%
■ Name couldn’t be found on the website...
about 66%
■ Email wouldn’t otherwise appear in a Google search...
about 45%
■ Identify business connections/conﬂict of interest/fake competitors... about 23%
Homework: how many of these email addresses have an entry in haveibeenpwned.com?
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
32 / 40
Can we use this power for "good"?
Try doxxing scam (and adult) websites!
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
33 / 40
Can we use this power for "good"?
Try doxxing scam (and adult) websites!
■ Don’t tell my wife
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
33 / 40
Can we use this power for "good"?
Try doxxing scam (and adult) websites!
■ Don’t tell my wife
■ Fail: their email doesn’t disclose their names
■ (but we still have the emails, who’s the scammer and who’s the scammee now!)
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
33 / 40
Anything... serious?
■ Some famous peoples’ emails (mentioned on Wikipedia)
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
34 / 40
Anything... serious?
■ Some famous peoples’ emails (mentioned on Wikipedia)
■ A few personal emails of activists
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
34 / 40
Anything... serious?
■ Some famous peoples’ emails (mentioned on Wikipedia)
■ A few personal emails of activists
■ On a lighter note, a lawyer website with a redirect to...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
34 / 40
Anything... serious?
■ Some famous peoples’ emails (mentioned on Wikipedia)
■ A few personal emails of activists
■ On a lighter note, a lawyer website with a redirect to...
PI:EMAIL
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
34 / 40
Anything... serious?
■ Some famous peoples’ emails (mentioned on Wikipedia)
■ A few personal emails of activists
■ On a lighter note, a lawyer website with a redirect to...
PI:EMAIL
■ ~50 redirects for noreply@. Really?
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
34 / 40
Caveat! Manual analysis
■ We manually went through hundreds of websites, ﬁshing for names and emails
▶ Contact pages
▶ Googling names and email addresses
▶ Deal with obscene stuff such as Adobe Flash websites
▶ ...
■ This is all ‘best-effort’: aka we might have missed public data
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
35 / 40
Disclosure with OVHcloud
■ We called the hotline
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
■ Call the hotline again to conﬁrm the process, which they do
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
■ Call the hotline again to conﬁrm the process, which they do
■ Second email...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
■ Call the hotline again to conﬁrm the process, which they do
■ Second email... no reply
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
■ Call the hotline again to conﬁrm the process, which they do
■ Second email... no reply
■ Get someone working there to ping the right person and forward...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Disclosure with OVHcloud
■ We called the hotline they said "send a mail to abuse@"
■ First email, including technical details... no reply
■ Call the hotline again to conﬁrm the process, which they do
■ Second email... no reply
■ Get someone working there to ping the right person and forward...
We’re still waiting for a response :)
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
36 / 40
Fixing DNSSEC
■ Use public-key cryptography (“DNSSEC white lies”, RFC 4470, 4471)
■ Either NSEC5? (2014)
▶ Initial draft had issues, met with skepticism, not ﬁnal, not standardised...
▶ Latency...
▶ Bad track record for the NSEC family
■ Or NSEC3 with digital signatures?
▶ Today most DNS servers would use Algorithm13 i.e. ECDSA because of fast signing and
wide support
▶ Veriﬁcation is slow... so there’s a burden on resolvers
▶ Also requires proper management of keys and algorithms...
... experience shows that DNS servers are bad at it
→ https://eprint.iacr.org/2015/1000.pdf
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
37 / 40
Fixing my redirections
If you are an OVHCloud customer and use their redirections...
How do you protect yourself?
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
37 / 40
Fixing my redirections
If you are an OVHCloud customer and use their redirections...
How do you protect yourself?
■ Protecting the target email is quite easy
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
37 / 40
Fixing my redirections
If you are an OVHCloud customer and use their redirections...
How do you protect yourself?
■ Protecting the target email is quite easy
■ Protecting the domain email list is more difﬁcult...
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
37 / 40
666. Conclusion
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
38 / 40
Conclusion
■ Do not store private info in your DNS Zone
■ DNSSEC NSEC3 attacks are practical
■ Push for NSEC5 or ECDSA-alg13 adoption!
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
39 / 40
That’s all folks
Proof of concept on:
https://dnssection.ovh
Your friendly neighbourhood hackers
PI:EMAIL
DNSSECTION @ DEF CON 28 SAFE MODE
6 Aug 2020
40 / 40