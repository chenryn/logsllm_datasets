title:Juice: A Longitudinal Study of an SEO Botnet
author:David Y. Wang and
Stefan Savage and
Geoffrey M. Voelker
Juice: A Longitudinal Study of an SEO Botnet
David Y. Wang, Stefan Savage, and Geoffrey M. Voelker
University of California, San Diego
Abstract
Black hat search engine optimization (SEO) campaigns
attract and monetize trafﬁc using abusive schemes. Using
a combination of Web site compromise, keyword stufﬁng
and cloaking, a SEO botnet operator can manipulate search
engine rankings for key search terms, ultimately directing
users to sites promoting some kind of scam (e.g., fake anti-
virus). In this paper, we inﬁltrate an inﬂuential SEO botnet,
GR, characterize its dynamics and effectiveness and identify
the key scams driving its innovation. Surprisingly, we ﬁnd
that, unlike e-mail spam botnets, this botnet is both mod-
est in size and has low churn—suggesting little adversarial
pressure from defenders. Belying its small size, however,
the GR botnet is able to successfully “juice” the rankings
of trending search terms and, during its peak, appears to
have been the dominant source of trending search term poi-
soning for Google. Finally, we document the range of scams
it promoted and the role played by fake anti-virus programs
in driving innovation.
1
Introduction
Trafﬁc is the lifeblood of online commerce: eyeballs
equal money in the crass parlance of today’s marketers.
While there is a broad array of vectors for attracting user
visits, Web search is perhaps the most popular of these and
is responsible for between 10 and 15 billion dollars in an-
nual advertising revenue [1, 2].
However, in addition to the trafﬁc garnered by such spon-
sored search advertising, even more is driven by so-called
“organic” search results. Moreover, it is widely held that
the more highly ranked pages—those appearing at the be-
ginning of search results—attract disproportionately greater
volumes of visitors (and hence potential revenue). Thus, a
large ecosystem has emerged to support search engine opti-
mization or SEO—the practice of inﬂuencing a site’s rank-
ing when searching under speciﬁc query terms. Many of
these practices are explicitly encouraged by search engines
with the goal of improving the overall search experience
(e.g., shorter load times, descriptive titles and metadata, ef-
fective use of CSS to separate content from presentation,
etc.) and such approaches are commonly called “white hat”
SEO techniques. However, on the other side of the spectrum
are “black hat” techniques that explicitly seek to manipulate
the search engine’s algorithms with little interest in improv-
ing some objective notion of search quality (e.g., link farms,
keyword stufﬁng, cloaking and so on).
Unsurprisingly, such black hat techniques have quickly
been pressed into the service of abusive advertising—
advertising focused on attracting trafﬁc for compromise
(e.g., drive-by downloads [4]), for fraud (e.g., fake anti-
virus [17]), or for selling counterfeit goods (e.g., pharma-
ceuticals or software).1 While a few such incidents would
not generate alarm, there is increasingly clear evidence of
large-scale SEO campaigns being carried out: large num-
bers of compromised Web sites harnessed in unison to poi-
son search results for attractive search queries (e.g., trend-
ing search terms). Indeed, one recent industry report claims
that 40% of all malware infestations originate in poisoned
search results [9]. However, the details of how such search
poisoning attacks are mounted, their efﬁcacy, their dynam-
ics over time and their ability to manage search engine
countermeasures are still somewhat opaque.
In service to these questions, this paper examines in
depth the behavior of one inﬂuential search poisoning bot-
net, “GR”.2 In particular, we believe our work offers three
primary contributions in this vein.
Botnet characterization. By obtaining and reverse engi-
neering a copy of the “SEO kit” malware installed on com-
promised Web sites, we were able to identify other botnet
members and inﬁltrate the command and control channel.
Using this approach we characterize the activities of this
botnet and its compromised hosts for nine months. We show
that unlike email spamming botnets, this search poisoning
botnet is modest in size (under a thousand compromised
1Indeed, in one recent study of counterfeit online pharmaceuticals the
most successful advertiser was not an email spammer, but rather was an
SEO specialist [14].
2Each of the functions and global variables in this botnet are preﬁxes
with a capital GR. We believe it is an acronym, but at the time of this
writing we do not know what the authors intended it to stand for.
Web sites) and has a low rate of churn (with individual sites
remaining in the botnet for months). Moreover, we docu-
ment how the botnet code is updated over time to reﬂect
new market opportunities.
Poisoning dynamics. By correlating captured informa-
tion about the keywords being promoted with contempora-
neous Internet searches, we are able to establish the effec-
tiveness of such search poisoning campaigns. Surprisingly,
we ﬁnd that even this modest sized botnet is able to effec-
tively “juice” the ranking of thousands of speciﬁc search
terms within 24 hours and, in fact, it appears to have been
the dominant contributor to poisoned trending search results
at Google during its peak between April and June 2011.
Targeting. By systematically following and visiting the
“doorway” pages being promoted, both through redirec-
tions and under a variety of advertised browser environ-
ments, we are able to determine the ultimate scams being
used to monetize the poisoning activity. We ﬁnd evidence
of a “killer scam” for search poisoning and document high
levels of activity while the fake antivirus ecosystem is sta-
ble (presumably due to the unusually high revenue genera-
tion of such scams [17]). However, after this market experi-
enced a large setback, the botnet operator explores a range
of lower-revenue alternatives (e.g., pay-per-click, drive-by
downloads) but never with the same level of activity.
Finally, in addition to these empirical contributions, our
paper also documents a methodology and measurement ap-
proach for performing such studies in the future. Unlike
email spam which delivers its content on a broad basis,
search poisoning involves many more moving parts includ-
ing the choice of search terms and the behavior of the search
engine itself. Indeed, our analyses required data from three
different crawlers to gather the necessary information: (1)
a host crawler for identifying and monitoring compromised
Web sites, (2) a search crawler to identify poisoned search
results and hence measure the effectiveness of the poison-
ing, and (3) a redirection crawler that follows redirection
chains from doorway pages linked from poisoned search re-
sults to identify the ﬁnal landing pages being advertised.
The remainder of this paper is structured as follows. In
Section 2, we walk through an example of a search poison-
ing attack and explain how our study builds on prior work.
In Section 3 we describe the GR SEO botnet in detail, fol-
lowed by a description of Odwalla, the system we built to
monitor and probe its activities in Section 4. Finally, we de-
scribe our analyses and ﬁndings in Section 5, summarizing
the most cogent of these in our conclusion.
2 Background
As background, we start with an example of a search
poisoning attack and then discuss previous work that has
explored the effects of search engine poisoning.
Figure 1: A typical search poisoning attack.
2.1 An Example
Figure 1 shows the steps of a typical search poisoning
attack, which baits users into clicking through a search re-
sult to be redirected to a scam. In this example, we pre-
suppose that due to exogenous factors there is sudden in-
terest in terms related to volcanoes (e.g., an eruption some-
where). The scam proceeds as follows: (1) The attacker
exploits a vulnerability on a Web site and installs an SEO
kit (Section 3), malware that runs on the compromised site
and changes it from a legitimate site into a doorway un-
der the attacker’s control.
(2) Next, when a search en-
gine Web crawler requests the page http://doorway/
index.html, the SEO kit detects the visitor as a crawler
and returns a page related to volcanoes (the area of trend-
ing interest) together with cross links to other compromised
sites under the attacker’s control.
(3) The search engine
indexes this page, and captures its heavy concentration of
volcano terms and its linkage with other volcano-related
sites.
(4) Later a user searches for “volcano” and clicks
through a now highly ranked search result that links to
http://doorway/index.html. (5) Upon receiving
this request, the SEO kit detects that it is from a user arriv-
ing via a search engine, and attempts to monetize the click
by redirecting the user to a scam such as fake AV.
2.2 Previous Work
Previous work, dating back well over a decade, has stud-
ied cloaking mechanisms and Web spam in detail [12, 19,
20, 21]. Recently, interest has focused on measuring the
phenomenon of search result poisoning and the resulting
negative user experience, together with various methods for
detecting poisoned search results as a step towards under-
mining the attack. In this paper we extend this line of work
by characterizing the coordinated infrastructure and organi-
zation behind these attacks from the attacker’s point of view,
Doorway!(1)!(2)!(3)!GET !/index.html!GET !/index.html!(4)!(5)!User!Search Engine!Web Crawler!Attacker!Scams!“volcano”!and the strategies an attacker takes both in monetizing user
trafﬁc as well as responding to intervention.
For example, Wang et al. recently measured the preva-
lence of cloaking as seen organically by users in Web
search results over time for trending and pharmaceutical
queries [19]. Cloaking is a “bait and switch” technique
where malware delivers different semantic content to dif-
ferent user segments, such as SEO content to search engines
and scams to users, and is one of the essential ingredients
for operating a modern black hat SEO campaign. Similarly,
Lu et al. developed a machine learning approach for identi-
fying poisoned search results, proposing important features
for statistical modeling and showing their effectiveness on
search results to trending terms [12]. During the same time
period, Leontiadis et al. [10] and Moore et al. [15] also mea-
sured the exposure of poisoned search results to users, and
used their measurements to construct an economic model
for the ﬁnancial proﬁtability of this kind of attack. Despite
the common interest in search result poisoning, these stud-
ies focus on how cloaking was utilized to manipulate search
results and its impact on users, whereas our work focuses
more on the mechanisms used by and the impact of an en-
tire SEO campaign coordinated by an attacker via a botnet.
The work of John et al. is the most similar to the study we
have undertaken [5]. Also using an SEO malware kit, they
extrapolated key design heuristics for a system, deSEO, to
identify SEO campaigns using a search engine provider’s
Web graph. They found that analyzing the historical links
between Web sites is important to detecting, and ultimately
preventing, SEO campaigns. Our work differs in that, while
we study a similar SEO kit, we focus on the longitudinal
operation of SEO campaigns as organized by an SEO bot-
net operator: what bottlenecks, or lack thereof, an opera-
tor faces, and what factors, such as interventions, appear to
have inﬂuenced the operator’s behavior over time.
3 The GR Botnet
In this section we present the architecture of the GR bot-
net responsible for poisoning search results and funneling
users, as trafﬁc, to various scams. We start by introducing
its SEO malware kit, and then present a high-level overview
of its architecture, highlighting speciﬁc functionality found
in the SEO kit and the evolution of the source code.
3.1 SEO Kit
An SEO kit is software that runs on each compromised
Web site that gives the botmaster backdoor access to the site
and implements the mechanisms for black hat search engine
optimization. We obtained an SEO kit after contacting nu-
merous owners of compromised sites. After roughly 40 sep-
arate attempts, one site owner was willing and able to send
Figure 2: A user and a search engine Web crawler
issue a request to a compromised Web site in
the botnet. The site will (1) contact the directory
server for the address of the C&C, and then (2)
contact the C&C for either the URL for redirecting
the user, or the SEO content for the Web crawler.
us the injected code found on their site. Although we can-
not pinpoint the original exploit vector on the compromised
Web site, there have been many recent reports of attackers
compromising Web sites by exploiting Wordpress and other
similar open source content management systems [13].
The SEO kit is implemented in PHP and consists of two
components, the loader and the driver. The loader is ini-
tially installed by prepending PHP ﬁles with an eval state-
ment that decrypts base64 encoded code. When the ﬁrst
visitor requests the modiﬁed page, causing execution of the
PHP ﬁle, the loader sets up a cache on the site’s local disk.
This cache reduces network requests, which could lead to
detection or exceeding the Web site host’s bandwidth lim-
its. Then the loader will contact a directory server using an
HTTP GET request to ﬁnd the location of a command-and-
control server (C&C) as either a domain name or IP address.
Upon contacting the C&C server, the loader downloads the
driver code which provides the main mechanisms used for
performing black hat SEO.
3.2 Botnet Architecture
Figure 2 shows the high-level architecture of the botnet.
The botnet has a command and control architecture built
from pull mechanisms and three kinds of hosts: compro-
mised Web sites, a directory server, and a command and
control server (C&C).
3.2.1 Compromised Web Sites
Compromised Web sites act as doorways for visitors and are
controlled via the SEO kit installed on the site. The SEO
Compromised Web Sites!Directory Server!Command Server!User!Search Engine!Web Crawler!HTTP GET!HTTP GET!(1)!(2)!kit uses cloaking to mislead search engines, users, and site
owners, as well as to provide a control mechanism for the
botmaster. Cloaking is a mechanism that returns different
content to different types of users based upon information
gleaned from the HTTP request (Figure 2).
The SEO kit ﬁrst checks to see if the user is a search
engine crawler.
If it is, the SEO kit returns content to
the crawler to perform black hat search engine optimiza-
tion. When the SEO kit is invoked via an HTTP GET re-
quest, the driver looks up the hostname of the visitor’s IP
address using gethostbyaddr. It then searches for the
substring googlebot.com within the hostname to deter-
mine if Google’s search crawler is accessing the page.3 If
the match is successful, the driver pulls SEO content from
the C&C server and returns it to the crawler with the speciﬁc
goal of improving the ranking of the page in search results
independent of the original content of the page. Speciﬁ-
cally, the driver builds a page with text and images related
to the trending search results that link to the site. The
SEO kit retrieves this content on demand by issuing aux-
iliary requests to search engines and spinning content con-
structed from the resulting search results snippets and im-
ages.4Additionally, the SEO kit inserts links to other nodes
of the botnet, as directed by the C&C, into the spun content
to manipulate the search engine’s ranking algorithms. As
search engines typically use the number of backlinks to a
page as one signal of high desirability [18], the botmaster
aims to develop a linking strategy to improve the ranking of
compromised sites in the SEO botnet.
If the SEO kit does not identify the visitor as a crawler,
the driver next checks if the visit reﬂects user search traf-
ﬁc. The SEO kit identiﬁes users by reading the Referrer
ﬁeld in the HTTP request headers, and verifying that the
user clicked through a Google search results page before
making the request to the compromised site. For these
users, the SEO kit contacts the C&C server on demand for
a target URL that will lead users to various scams, such as