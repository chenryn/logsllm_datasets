22.  排除 IP 地址:删除进出 IP 地址的流量
23.  ！ip.addr ==192.168.0.1
24.  显示两个特定子网之间流量
    *   ip.addr == 192.168.0.1/24，ip.addr == 192.168.1.1/24
25.  显示两个特定工作站之间的流量
    *   ip.addr == 192.168.0.1，ip.addr == 192.168.0.2
26.  按 MAC 过滤
    *   eth.addr = 00:50:7f:c5:b6:78
27.  过滤 TCP 端口
    *   tcp.port == 80
28.  过滤 TCP 端口源
    *   tcp.srcport == 80
29.  过滤 TCP 端口目标
    *   tcp.dstport == 80
30.  查找用户代理
    *   http.user_agent 包含 Firefox
    *   ！http.user_agent 包含||！http.user_agent 包含 Chrome
31.  过滤广播流量
    *   ！(arp 或 icmp 或 dns)
32.  过滤 IP 地址和端口
    *   TCP . port = = 80 & & IP . addr = = 192 . 168 . 0 . 1
33.  过滤所有 http get 请求
    *   请求
34.  过滤所有 http get 请求和响应
    *   http.request 或 http.response
35.  过滤三次握手
    *   tcp.flags.syn==1 或(tcp.seq==1 且 tcp.ack==1 且 tcp.len==0 且 tcp.analysis.initial_rtt)
36.  按类型查找文件
    *   框架包含“(附件|tar|exe|zip|pdf)”
37.  基于关键字查找流量
    *   tcp 包含 facebook
    *   框架包含 facebook
38.  检测 SYN 泛洪
    *   tcp.flags.syn == 1，tcp.flags.ack == 0
**Wireshark 混杂模式** -默认情况下，Wireshark 只捕获进出其运行的计算机的数据包。通过在捕获设置中选中在混杂模式下运行 Wireshark 的复选框，您可以捕获 LAN 上的大部分流量。
### 倾倒帽
*   Dumpcap 是一个网络流量转储工具。它从实时网络中捕获数据包数据，并将数据包写入文件。Dumpcap 的原生捕获文件格式是 pcapng，这也是 Wireshark 使用的格式。
*   默认情况下，Dumpcap 使用 pcap 库从第一个可用的网络接口捕获流量，并将收到的原始数据包数据以及数据包的时间戳写入 pcapng 文件。捕获过滤器语法遵循 pcap 库的规则。
*   Wireshark 命令行实用程序“dumpcap.exe”可用于捕获一段时间内的 LAN 流量。
*   也可以使用 Wireshark 本身，但是 dumpcap 在长时间捕获时不会大量使用计算机的内存。
### DaemonLogger
*   Daemonlogger 是一个专门设计用于网络和系统管理(NSM)环境的数据包记录应用。
*   Daemonlogger 提供的最大好处是，像 Dumpcap 一样，它很容易用于捕获数据包。为了开始捕获，您只需要调用命令并指定一个接口。
*   daemonlogger–I et h1
*   默认情况下，该选项将开始捕获数据包并将它们记录到当前工作目录中。
*   将收集数据包，直到捕获文件大小达到 2 GB，然后将创建一个新文件。这将无限期地继续下去，直到进程停止。
### 网络嗅探
*   Netsniff-NG 是一个高性能的数据包捕获工具
*   到目前为止，我们讨论的实用程序依赖 Libpcap 进行捕获，而 Netsniff-NG 利用零拷贝机制来捕获数据包。这样做是为了支持在高吞吐量链路上捕获完整的数据包。
*   要开始用 Netsniff-NG 捕获包，我们必须指定一个输入和输出。在大多数情况下，输入将是网络接口，输出将是磁盘上的文件或文件夹。
`netsniff-ng –i eth1 –o data.pcap`
### 网络流
*   NetFlow 是 Cisco 路由器在 1996 年左右推出的一项功能，能够在 IP 网络流量进出接口时收集流量。通过分析 NetFlow 提供的数据，网络管理员可以确定流量的来源和目的地、服务等级以及拥塞原因等。典型的流监控设置(使用 NetFlow)由三个主要组件组成:[1]
*   流导出器:将数据包聚合成流，并向一个或多个流收集器导出流记录。
*   流收集器:负责接收、存储和预处理从流导出器接收的流数据。
*   分析应用:例如，在入侵检测或流量分析环境中分析接收到的流数据。
    *   支持 NetFlow 的路由器和交换机可以收集启用了 NetFlow 的所有接口上的 IP 流量统计信息，然后将这些统计信息作为 NetFlow 记录导出到至少一个 NetFlow 收集器，通常是进行实际流量分析的服务器。
### 标识部分(Identification Section)
一种安全解决方案，可检测环境中与安全相关的事件，但不会阻止它们。IDS 传感器可以基于软件和硬件来收集和分析网络流量。这些传感器有两种类型，网络 id 和主机 id。
*   主机 IDS 是一个特定于服务器的代理，它运行在服务器上，监控操作系统的开销最小。
*   网络 IDS 可以嵌入网络设备、独立设备或监控网络流量的模块中。
基于签名的 IDS
*   基于签名的 IDS 监控网络流量或观察系统，并在已知的恶意事件发生时发出警报。
*   它通过将数据流与已知攻击模式的数据库进行比较来做到这一点
*   这些签名明确定义了哪些流量或活动应被视为恶意的。
*   十多年来，基于签名的检测一直是基于网络的防御安全的基础，部分原因是它非常类似于使用防病毒实用程序在主机级别检测恶意活动的方式
*   公式相当简单:分析师观察恶意活动，从活动中得出指标，并将其发展为签名，然后这些签名将在活动再次发生时发出警报。
*   例如:SNORT & SURICATA
基于策略的 IDS
*   基于策略的 IDSs(主要是主机 IDSs)在违反配置的策略时触发警报。
*   这个配置的策略是或者应该是安全策略的表示。
*   这种类型的 IDS 非常灵活，可以根据公司的网络需求进行定制，因为它确切地知道什么是允许的，什么是不允许的。
*   另一方面，基于签名的系统依赖于供应商的细节和默认设置。
基于异常的入侵检测
*   基于异常的 IDS 寻找偏离正常的流量，但是什么是正常网络流量模式的定义是棘手的部分
*   基于异常的入侵检测系统有两种类型:统计异常检测和非统计异常检测
*   统计异常检测以交互方式学习一段时间内的流量模式。
*   在非统计方法中，IDS 有一个预定义的假定可接受和有效的流量模式配置。
基于主机的 IDS 和基于网络的 IDS
*   主机 IDS 可以被描述为驻留在需要保护的网络的每个服务器上的分布式代理。这些分布式代理与底层操作系统紧密相关。
*   另一方面，网络 IDSs 可以被描述为智能嗅探设备。网络 IDS 从网络中捕获数据(原始数据包),而主机 IDS 从安装它们的主机上捕获数据。
蜜罐
*   使用诱饵机器将入侵者的注意力从受保护的机器上引开是防止入侵攻击的主要技术。任何用作诱饵来引诱攻击者远离重要资产并收集入侵或滥用行为的设备、系统、目录或文件都被称为蜜罐。
*   蜜罐可以实现为物理设备或仿真系统。其思想是在局域网中设置诱饵机器，或在文件系统中设置诱饵目录/文件，使它们看起来很重要，但有几个可利用的漏洞，引诱攻击者攻击这些机器或目录/文件，以便其他机器、目录和文件可以避开入侵者的注意。诱饵机器可以是主机计算机或服务器计算机。同样，我们也可以建立假路由器，甚至假局域网。
* * *
## 盔甲上的漏洞(TCP/IP 安全问题)
![image18](img/30d842e0082e2f3e49be438bac476ab4.png)