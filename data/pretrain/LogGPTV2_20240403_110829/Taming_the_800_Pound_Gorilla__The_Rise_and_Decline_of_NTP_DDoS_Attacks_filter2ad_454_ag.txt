CSU-J
Figure 14: Time series of all trafﬁc at Merit.
some of the NTP ampliﬁers in these networks participated in this
global phenomenon. Notice, for example, that the ﬁve ampliﬁers
alone identiﬁed in Merit were abused to target thousands of victims
generating terabytes of data over a short time span.
Overall, we identiﬁed 13,386 unique victims at Merit and 5,659
at FRGP and CSU. There were 291 victims common between the
two sites. We identiﬁed target networks and countries to which
these systems belong. Table 6 shows a characterization of the top 5
victims at Merit and at CSU. Our data also clearly shows signs of
coordination in these attacks as we frequently see several ampliﬁers
being used to target the same victim at each site (Figure 15). All
of the 9 CSU ampliﬁers were observed to attack many victims in a
coordinated fashion. Further, in several cases at Merit, more than
35 of the identiﬁed ampliﬁers were used in a coordinated manner in
attacks that lasted multiple days. Figure 13 provides a stacked-graph
visualization of these victims. Interestingly, we observe a diurnal
pattern of trafﬁc destined to the victims perhaps suggesting a manual
element in the attacks. Note that the larger attacks that used the
most ampliﬁers also lasted longer (e.g., see top half of Table 6).
Since the attack volume constitutes a signiﬁcant amount of ISP
trafﬁc, we investigate whether these attacks had monetary impact.
Figure 14 shows the aggregate NTP trafﬁc volume at Merit, along
with other trafﬁc, illustrating NTP’s steep rise. We estimate that
attacks resulted in over 2% additional trafﬁc at Merit, overall, which
would incur extra transit costs. Whether it did or would at another
ISP depends on the billing model used (e.g., a 95th percentile model,
which Merit uses with its upstream), the aggregation window size,
and when the extra trafﬁc was transited [16]. For example, if the
an ampliﬁer with a ratio of ampliﬁer’s bytes received to bytes sent
of at least 100. An ampliﬁer sent at least 10MB and had a ratio of
sent/received trafﬁc greater than 5. BAF is UDP payload ratio.
01-2501-2701-2901-3102-0202-04UTC Time020406080100120NTP aggregate volume (MBps)Merit-AMerit-BMerit-CMerit-DMerit-E01-2501-2701-2901-3102-0202-04UTC Time100K1M10M100M1G10GTraffic volume (Bps)NTPDNSHTTPHTTPSOTHER01-2501-2701-2901-3102-0202-0402-06UTC Time0.00.20.40.60.81.0NTP aggregate volume (MBps)Merit's vantage pointFRGP's vantage point446volumes were fairly low. We also ﬁnd that the overlap in target ports
between attack trafﬁc at Merit and the global data shown in Table 4
is remarkable. The ports shown in that table constitute 98.91% of
the total trafﬁc destined to victims identiﬁed with Merit’s ﬂow data.
The information we obtained from the local views conﬁrms some
of our observations from the global ONP data in terms of attack
magnitude and attack occurrences. For example, the BAFs reported
via trafﬁc analysis of the local datasets Tables 5 and 6 conﬁrms those
depicted in Figure 4b after allowing for differences due to packet
headers. Additionally we also note that FRGP data shows servers
in that network actively participated in the attacks on OVH servers
described in section 4.4. Furthermore, the remediation efforts at
each site were clearly visible in the ONP datasets giving us increased
conﬁdence in the completeness of the ONP data.
Figure 16: Common scanners Merit/CSU.
We also attempted to identify common scanning activity that
might have been visible from both sites. However, we ﬁnd little evi-
dence of this in our datasets from Merit and CSU. Figure 16 shows
a timeline of the trickle of activity from these common scanners.
Though we identify 42 IP addresses in common, most of these were
determined to be a result of research scanning. We speculate that
true malicious scanning activity may be well distributed in time,
and, therefore, the likelihood of two distinct sites observing synchro-
nized scans is relatively low—whereas research scanning is being
conducted in the open and at much more aggressive rates.
Another attacker behavior of interest is whether it is possible to
estimate if scanning activity (to ﬁnd ampliﬁers) and attack trafﬁc
(for ampliﬁers to reﬂect) is sourced from the same systems. To study
this, we analyzed TTL values from the CSU dataset corresponding
to both scanning activity as well as spoofed attacks. Surprisingly,
we ﬁnd that while the scanning activity appears to be largely sourced
from Linux-based systems (mode TTL:54), the attack trafﬁc appears
to be originating from Windows-based systems (mode TTL: 109),
perhaps botnet nodes.
8. RELATED WORK
The threat of DDoS attacks leveraging reﬂection has been well-
known for many years (e.g., [27]), and the 2014 study by Rossow
[32] is the latest and most comprehensive example of work examin-
ing the potential vectors for ampliﬁcation in these reﬂected attacks.
The Rossow paper characterized how 14 UDP protocols, including
SNMP, chargen, and NTP with the monlist command, may be used
for reﬂection/ampliﬁcation DDoS attacks. For each of these proto-
cols, broad and multifaceted passive and active measurements of a
limited scale (e.g., scanning a random sample of 1M IPv4 addresses,
partial crawling of P2P networks, and measurements of scanning in
a medium-sized (/17) and small (/27) darknet over four weeks) were
conducted. In contrast to that comprehensive examination of ampliﬁ-
cation in general, we instead focus just on the threat and actual harm
caused by attacks leveraging NTP. Further, our measurements of
this particular ampliﬁcation vector are much broader, over a longer
timespan, and include a deep analysis of the actual attack and victim
characteristics seen in the wild, and at Internet-scale. At the time
Rossow’s paper was written, no major attacks using NTP had been
reported. Since then, NTP had became the dominant attack vector
for large DDoS attacks, and our work aims to chronicle that rise,
explore who was attacked and how, and show how the mitigation of
the vector has impacted the threat.
As our manuscript was undergoing ﬁnal preparation for publi-
cation, new work by Kührer et al. [20] was published exploring
several DDoS attack vectors and aspects. Pertinent to our work
here, the study examined the size of the NTP ampliﬁer populations
via global scanning, conducted a notiﬁcation campaign that may
have (though causality can not be shown) speeded remediation of
monlist ampliﬁers, and reported on several aspects of the ampliﬁer
population over 13 weeks, starting in November 2013. The numbers
reported in Internet scans for NTP ampliﬁers match our numbers
closely, as expected. In addition, characterizations of the ampliﬁer
pool (e.g., that nearly half of the version command ampliﬁers are
Cisco), likewise match our analysis. The study also examined two
interesting but unrelated to our work facets of DDoS in general, one
being a TCP attack vector and the other a technique for remotely
identifying networks that allow IP spooﬁng. Unlike the Kührer et al.
study, our work digs deeper into who NTP attacks target and with
what force, as well as explores other features of the attacks (e.g.,
attacked ports). We also bring to bear a dataset on NTP scanning
from a large (≈ /8) darknet, large global trafﬁc and attack data, and
data from local ISPs impacted by these attacks.
While DDoS attacks in general and mitigation strategies in par-
ticular have seen much work, reports on large-scale measurements
of DDoS attacks are few. We are not aware of any studies charac-
terizing DDoS attacks at-scale since 2006, aside from proprietary
industry reports based on commercial deployments (e.g., [31], [30]),
whereas the DDoS threat landscape has evolved signiﬁcantly in the
ensuing years. The 2006 measurement studies examining DDoS
attack activity focused on backscatter (e.g., [25]) and ﬂow analysis
(e.g., [21]). Backscatter is evident in random spoofed-source ﬂood
attacks (esp. SYN-ﬂood), which makes it inapplicable to the spe-
ciﬁc type of attack we focus on, NTP-based reﬂection/ampliﬁcation
attacks. The relative fraction of attacks based on NTP is similar to
that using SYN ﬂoods [31], though it is unclear what fraction of
modern SYN ﬂoods utilize random spoofed source addresses, which
are required for detection in darknets, as done by [25], and [21].
To address some of the limitations of backscatter, Mao et al. [21],
argued for direct measurement of DDoS attacks (e.g., ﬂow data),
which is one of the approaches we take here.
To our knowledge, ours is also the ﬁrst study to measure ampliﬁcation-
type DDoS attack activity via a direct global survey of records on
the ampliﬁcation hosts themselves. In addition, we bring to bear
passive datasets with both global and local perspective.
9. CONCLUSION
Using data from a variety of vantage points, we chronicle the
rapid rise and steady decline of the NTP DDoS attack phenomenon.
Our analyses serve to characterize the global scale of attacks, both
in terms of ampliﬁers as well as victims. We conﬁrm the value of
actively monitoring darknet address space, as it can help detect at-
tack precursors, such as large-scale scanning and probing, observed
prior to the onset of the ﬁrst large-scale attacks. We demonstrate
that, in addition to countless hours spent by engineers worldwide
2013-12-012013-12-152014-01-012014-01-152014-02-01UTC time012345678Number of unique scannersCommon Merit/CSU scanners447to install patches and ﬁlters, these events had direct measurable
costs in terms of increased bandwidth loads as measured at example
edge networks. Though this paper documents the lethal power of
the largest DDoS attacks observed to date, our conclusions include
a positive one. The network research and operations community
worked to actively mitigate the effects of these attacks and these
efforts have had a visible impact in diminishing the vulnerable am-
pliﬁer population and reducing attack trafﬁc. There are, however,
limits to the effectiveness of such remediation efforts, as the tapering
of mitigation shows. Since rapid remediation is how such attack
vectors are thwarted, we are interested in future work examining
why some networks remediate faster than others.
Acknowledgments
This work was supported in part by the Department of Homeland
Security Science and Technology Directorate under contract num-
bers D08PC75388, FA8750-12-2-0314, FA8750-12-2-0235, and
N66001-13-C-3001; the National Science Foundation under con-
tract numbers CNS 1111699, CNS 091639, CNS 08311174, CNS
0751116, CNS 1330142, and CNS 1255153; and the Department
of the Navy under contract N000.14-09-1-1042. We would like to
thank Jared Mauch for sharing the OpenNTPProject.org dataset as
well as Kirk Soluk and team at Arbor Networks for sharing trafﬁc
and attack statistics. Finally, we are grateful to Roland Dobbins,
Christian Rossow, Denis Foo Kune, anonymous reviewers, and our
shepherd, Sharon Goldberg, for valuable feedback on earlier drafts.
10. REFERENCES
[1] Front Range GigaPop.
http://www.frgp.net/frgp-overview-2014-03-27.pdf.
[2] Open NTP Project. http://openntpproject.org/.
[3] Open Resolver Project. http://openresolverproject.org/.
[4] Arbor Networks Solution Brief: DDoS Attacks in the Gaming
Industry, 2013.
www.arbornetworks.com/docman-component/doc_download/
687-gaming-company-defends-against-ddos-attacks.
[5] Hack Forums “Server Stress Testing” marketplace forum, Aug. 2014.
http://www.hackforums.net/forumdisplay.php?fid=232.
[6] The OVH offering expands with new lines of dedicated serers., Feb
2014. https://www.ovh.com/us/newsroom/cp1355.the_ovh_
offering_expands_with_new_lines_of_dedicated_servers.
[7] M. Allman. Comments on Bufferbloat. ACM Computer
Communication Review, 43(1), Jan. 2013.
[8] D. Anstee, A. Cockburn, G. Sockrider, and C. Morales. Arbor
Networks Worldwide Infrastructure Security Report, 2014. http:
//pages.arbornetworks.com/rs/arbor/images/WISR2014.pdf.
[9] Arbor Networks. www.arbornetworks.com.
[10] M. Bailey, E. Cooke, F. Jahanian, J. Nazario, and D. Watson. The
internet motion sensor: A distributed blackhole monitoring system. In
Proceedings of Network and Distributed System Security Symposium
(NDSS ’05), pages 167–179, 2005.
[11] K. Benson, A. Dainotti, k. Claffy, and E. Aben. Gaining Insight into
AS-level Outages Through Analysis of Internet Background Radiation.
In Proceedings of the 2012 ACM Conference on CoNEXT Student
Workshop, CoNEXT Student ’12, 2012.
[12] S. O. Blog. Hackers Spend Christmas Break Launching Large Scale
NTP-Reﬂection Attacks, Dec 2013.
http://www.symantec.com/connect/blogs/hackers-spend-
christmas-break-launching-large-scale-ntp-reflection-
attacks.
[13] L. Constantin. OVH’s Own NTP Servers Used in Attack, Feb 2014.
http://news.techworld.com/security/3501549/attackers-
use-ntp-reflection-in-huge-ddos-attack/.
[14] J. Czyz, K. Lady, S. G. Miller, M. Bailey, M. Kallitsis, and M. Karir.
Understanding IPv6 Internet Background Radiation. In Proceedings of
the ACM SIGCOMM Internet Measurement Conference (IMC’13),
Barcelona, Spain, 2013.
[15] A. Dainotti, C. Squarcella, E. Aben, K. C. Claffy, M. Chiesa,
M. Russo, and A. Pescapé. Analysis of Country-wide Internet Outages
Caused by Censorship. In Proceedings of the 2011 ACM SIGCOMM
Internet Measurement Conference (IMC’11), pages 1–18. ACM, 2011.
[16] X. Dimitropoulos, P. Hurley, A. Kind, and M. P. Stoecklin. On the
95-percentile billing method. In Proceedings of the Passive and Active
Network Measurement Conference (PAM’09), 2009.
[17] J. Fleury. Good News: Vulnerable NTP Servers Closing Down, Feb
2014. http://blog.cloudflare.com/good-news-vulnerable-
ntp-servers-closing-down.
[18] D. Goodin. New DoS attacks taking down game sites deliver crippling
100Gbps ﬂoods, Jan 2014.
http://arstechnica.com/security/2014/01/new-dos-
attacks-taking-down-game-sites-deliver-crippling-100-
gbps-floods/.
[19] M. Karami and D. McCoy. Understanding the Emerging Threat of
DDoS-as-a-Service. In Presented as part of the 6th USENIX Workshop
on Large-Scale Exploits and Emergent Threats. USENIX, 2013.
[20] M. Kührer, T. Hupperich, C. Rossow, and T. Holz. Exit from Hell?
Reducing the Impact of Ampliﬁcation DDoS Attacks. In Proceedings
of the 23rd USENIX Security Symposium, August 2014.
[21] Z. M. Mao, V. Sekar, O. Spatscheck, J. Van Der Merwe, and
R. Vasudevan. Analyzing Large DDoS Attacks Using Multiple Data
Sources. In Proceedings of the 2006 SIGCOMM workshop on
Large-scale attack defense, pages 161–168. ACM, 2006.
[22] Merit Network, Inc. www.merit.edu.
[23] D. Mills, J. Martin, J. Burbank, and W. Kasch. Network Time Protocol
Version 4: Protocol and Algorithms Speciﬁcation. RFC 5905, 2010.
[24] M. Mimoso. Volume of NTP Ampliﬁcation Attacks Getting Louder,
Apr 2014. http://threatpost.com/volume-of-ntp-
amplification-attacks-getting-louder/105763.
[25] D. Moore, C. Shannon, D. J. Brown, G. M. Voelker, and S. Savage.
Inferring internet denial-of-service activity. ACM Transactions on
Computer Systems (TOCS), 24(2):115–139, 2006.
[26] K. Orland. Multiple gaming platforms hit with apparent DDoS attacks,
Jan 2014. http://arstechnica.com/gaming/2014/01/multiple-
gaming-platforms-hit-with-apparent-ddos-attacks/.
[27] V. Paxson. An analysis of using reﬂectors for distributed
denial-of-service attacks. ACM SIGCOMM Computer Communication
Review, 31(3):38–47, 2001.
[28] N. Perlroth. Tally of Cyber Extortion Attacks on Tech Companies
Grows, Jun 2014.
http://bits.blogs.nytimes.com/2014/06/19/tally-of-
cyber-extortion-attacks-on-tech-companies-grows/.
[29] K. Poulsen. FBI busts alleged DDoS Maﬁa, Aug. 2004.
http://www.securityfocus.com/news/9411.
[30] M. Prince. Technical Details Behind a 400Gbps NTP Ampliﬁcation
DDoS Attack, Feb 2014.
http://blog.cloudflare.com/technical-details-behind-a-
400gbps-ntp-amplification-ddos-attack.
[31] Prolexic. Prolexic Quarterly Global DDoS Attack Report: Q1 2014,
Apr. 2014. http://www.prolexic.com/knowledge-center-ddos-
attack-report-2014-q1.html.
[32] C. Rossow. Ampliﬁcation Hell: Revisiting Network Protocols for
DDoS Abuse. In Proceedings of the 2014 Network and Distributed
System Security Symposium, NDSS, San Diego, CA, 2014.
[33] C. Systems. Cisco Event Response: Network Time Protocol
Ampliﬁcation Distributed Denial of Service Attacks, Feb. 2014.
http://www.cisco.com/web/about/security/intelligence/
ERP-NTP-DDoS.html.
[34] The Spamhaus Project - PBL. http://www.spamhaus.org/pbl/.
[35] E. Wustrow, M. Karir, M. Bailey, F. Jahanian, and G. Houston.
Internet Background Radiation Revisited. In Proceedings of the 10th
ACM SIGCOMM Conference on Internet Measurement (IMC ’10),
Melbourne, Australia, November 2010.
[36] J. Zhang, Z. Durumeric, M. Bailey, M. Karir, and M. Liu. On the
Mismanagement and Maliciousness of Networks. In Proceedings of
the Network and Distributed System Security Symposium (NDSS ’14),
San Diego, CA, February 2014.
448