# OCR Output
## Page 1
高性能Linux服务器构建实战
集群高
W
运维监控、性能调优与集群应用
BuiloHiahPerfo
C
高俊峰著
实
---
## Page 2
网上购书：www.china-pub.com
华章网站http://www.hzbook.com
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
你拿起了这本书，就建议你不要再犹豫了，按照书中的内容去实践吧，相信你一定会大有收获。
性能Linux服务器的方法与最佳实践。此外，本书的叙述通俗易懂、语言幽默风趣，可读性也很好。如果
Web应用、数据备份与恢复、网络存储应用、性能优化与运维监控、集群高级应用等方面讲解了构建高
累了丰富的经验。他能将自己的这些经验梳理、总结并以书的方式分享出来，实在是难能可贵。本书从
它能帮助大家提高技能、收获经验，最终实现升职加薪的愿望。
工作中会遇到的问题，实践指导意义很强。我将这本书推荐本给所有从事Linux服务器运维的同行，希望
的书籍不同的是，本书注重于实践，包含大量来自于实际生产环境中的案例，能帮助我们解决很多实际
维监控、集群高级应用等方面的知识，能给Linux运维人员和系统管理人员非常实用的指导。
理和维护：然后结合实际生产环境讲解了Web应用、数据备份与恢复、网络存储应用、性能优化与运
这个话题，先从实用的角度详细讲解了各种与构建高性能Linux服务器相关的开源软件的配置、使用、管
运维人员来说，真可谓“一书在手，运维不愁”。
为重要的是，本书的内容不受硬件环境的限制，同时包含大量实用性极强的案例。对于广大Linux服务器
等多方面对如何构建高性能的Linux服务器进行了细致的讲解和全面的解析，蕴含了丰富的运维经验。更
“南非蚂蚁”是我多年的好友，也是我的同行，我深知他的系统运维功底相当深厚，在这个领域积
从内容上讲，本书基本涵盖了当前Linux服务器系统运维所需要的主流技术。与大部分运维手册性质
开源赋予了Linux强大的生命力，Linux因为开源而聚集了全球技术精英的智慧。本书围绕“高性能”
本书很有可能成为Linux服务器构建与运维领域的经典著作之一，从运维监控、性能优化和集群应用
Www.Linuxidc
田逸资深系统架构师/《互联网运营智慧：高可用可扩展网站技术实战》作者
技术成就梦想
ITPUB技术论坛（http://www.itpub.net/）
—杨向勇51JOB系统运维经理兼首席DBA
51CT0（www.51cto.com）
www.itpub.net
定价：79.00元
ISBN978-7-1
荣指
136695
联合策划
1-36695
---
## Page 3
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
www.Linuxidc.com
高性能Linux服务器构建实战
运维监控、性能调优与集群应用
BuildHighPeaformance
机械工业曲版社
高俊峰著
---
## Page 4
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
版社，2011.12
群系统的实战案例结束全书，巧妙地将本书的所有核心内容都融合到了一起。
解决方案，即OracleRAC数据库的构建、使用和维护。最后以构建一个MySQL+heartbeat+DRBD+LVS集
用的负载均衡集群，其次讲解了红帽集群套件RHCS的配置、管理、维护和监控，然后讲解了Oracle集群
了如何利用Nagios进行性能监控，以及Linux服务器的性能分析原则和优化方法。集群高级应用篇是前面
后讲解了分布式存储系统MFS的使用和维护。运维监控与性能优化篇通过理论与实践相结合的方法讲解
件和MySQL数据库的方法。网络存储应用篇首先系统地讲解了网络存储技术iSCSI的配置和使用，然
演示了这两个工具在生产环境中的使用过程：最后讲解了如何利用ext3grep工具来恢复误删除的数据文
复操作的具体方法；其次讲解了开源数据镜像备份工具rsync和unison的使用，并通过两个企业级案
篇首先讲述了开源备份软件bacula的使用与管理技巧，并通过实例讲解了在bacula上进行各种备份与恢
极为常用的Web应用软件的安装、配置、管理、使用方法、工作原理和性能调优技巧。数据备份与恢
的有代表性的疑难问题，并给出了优秀的解决方案，实践指导意义极强。
性为导向，所有内容都来自于作者多年实践经验的总结，同时从社区中收集了大量Linux运维人员遇到
维监控与性能优化、集群高级应用等多个方面深入讲解了如何构建高性能的Linux服务器。全书以实战
读者信箱：PI:EMAIL
投稿热线：（010）88379604
购书热线：（010） 68326294：88379649：68995259
客服热线：（010）88378991：88361066
凡购本书，如有缺页、倒页、脱页，由本社发行部调换
定价：79.00元
标准书号：ISBN978-7-111-36695-9
186mm×240mm·29.5印张
2012年3月第1版第2次印刷
北京京北印刷有限公司印刷
责任编辑：姜影
机械工业出版社（北京市西城区百万庄大街22号邮政编码100037）
中国版本图书馆CIP数据核字（2011）第251700号
I.高II.高.IIL.Linux操作系统IV.TP316.89
ISBN 978-7-111-36695-9
高性能Linux服务器构建实战：运维监控、性能调优与集群应用/高俊峰著.一北京：机械工业出
图书在版编目（CIP）数据
本书法律顾问北京市展达律师事务所
版权所有，侵权必究
封底无防伪标均为盗版
全书分为5个部分。Web应用篇详细介绍了Nginx、Varmnish和Memcached这三款Linux服务器
本书以构建高性能Linux服务器为核心内容，从Web应用、数据备份与恢复、网络存储应用、运
www.Linuxidc.com
PDG
---
## Page 5
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
到面、由浅入深的讲述，将Linux应用的各个方面系统、深人、全面地展现给读者。理论介绍
Linux/UbuntuLinux等），要么缺少实践应用，很少对Linux进行全面、深人、灵活的讲解。
象，要么只讲基础理论和系统命令，要么侧重代码示例，要么针对具体的系统版本（Redhat
解决的首要问题，这也正是写作本书的目的。
件和集群方案呢？借助开源软件丰富的技术资源，构建一个优秀的集群系统，是技术人员要
选择的集群解决方案，这些方案有基于硬件的，也有纯软件的，那么，如何选择这些集群软
品竞争中。
更是把Linux集群这一高端应用领域作为自己的战略发展方向，不遗余力地加人激烈的市场产
基于Linux平台发展，Linux由此进人了企业应用的高端市场，同时，一些老牌的Linux厂商
并有计划地推出基于Linux开放源码的集群产品，集群软件也逐渐从UNIX平台的高端应用向
业应用进入了集群和高性能时代。与几个主要硬件厂商（例如IBM、HP、SGI等）开始研制
势下，分布式应用系统构架应运而生，高性能多节点的集群系统日益被广泛接受和使用，企
统的性能需求越来越高，高稳定性、高可靠性成为评价业务系统性能的主要指标。在这种趋
为什么要写这本书
本书针对这种现象，从基础人手，再进行深人研究，同时结合实际的应用案例进行由点
目前市场上关于Linux系统管理、维护和优化的书籍很多，但是普遍存在模式单一的现
开放源码的迅猛发展为集群的出现提供了良好的技术平台，目前，已经有多种多样可供
随着企业信息系统的广泛应用和深入发展，用户核心应用数量越来越多，企业对业务系
www.Linuxidc.com
---
## Page 6
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
Varmish常用的指令及Vamish的调优技巧和经验，最后通过两个实例介绍了Varmish的应用。
与Java、Perl整合的过程。
了Nginx在性能优化方面的一些经验和技巧，最后通过实例演示了Nginx与PHP以及Nginx
Web应用篇（第1章至第3章）
也可以从第1章依次阅读。
实例对知识点进行补充，并且每个章节都是一个独立的知识块，读者可以选择从中间阅读，
如何阅读本书
读者对象
层次的读者都能从本书受益。
可以供初学者参考学习，也可以帮助有一定基础的中高级Linux系统管理员进阶学习，使不同
感觉，而这正是我们所期待的。
前面内容的综合和深人，更是本书介绍的重点。读完本书相信读者一定会有一种豁然开朗的
级应用方面，其中，前四个方面是Linux运维的核心内容，是本书的基础，而最后一个方面是
Web应用方面、数据备份恢复方面、网络存储应用方面、运维监控与性能优化方面、集群高
真正提高实践能力。
结合实际应用贯穿全书，通过真实案例使读者可以更深入地了解Linux应用的现实环境，从而
第3章介绍了Memcached的特征和安装过程，同时详细介绍了Memcached的工作原理和
第2章介绍了高性能HTTP加速器Vamish的安装、配置、管理和使用技巧，同时还介绍了
本书分为5篇，共14章，基本结构如下。
本书最大的特点是注重实践、理论与实际相结合，在讲述完一个知识点后，一般都附有
本书是作者多年实践工作的经验总结，全书贯穿了由点及线、由线及面的学习方法，既
本书分为5篇，以Linux平台下的应用软件为中心，涉及Linux运维的各个方面，包括
Web应用篇介绍了3个Web应用软件的使用：Nginx、Varnish和Memcached。
·所有从事开源的爱好者
IV
第1章讲述了轻量级HTTP服务器Nginx的安装、配置、管理和使用技巧，同时也介绍
解决方案构架师
系统集成商
系统运维工程师
·中/高级Linux系统管理员
本书适合的阅读对象有：
www.Linuxidc.com
---
## Page 7
博客中不定期更新书中的遗漏，当然，也欢迎读者将遇到的疑惑或书中的错误在博客留言中
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
不妥之处悬请读者批评指正。
勘误和支持
综合体，从实战出发，
Oracle集群解决方案，即OracleRAC数据库的搭建、使用和维护过程。第14章是本书内容的
法。第12章介绍了红帽集群套件RHCS的安装、配置、管理、维护和监控。第13章讲解了
11章讲述了通过LVS+heartbeat、piranha、LVS+Keepalived构建高可用的负载均衡集群的方
集群高级应用篇（第11章至第14章）
时，还通过两个具体的案例一步步演示Web应用系统的优化过程。
章通过理论与实践相结合的方法系统地讲述了Linux服务器的性能分析原则和优化方法，
主要讲述Nagios的安装、配置和使用，以及如何利用外部插件扩展Nagios的监控功能。第10
运维监控与性能优化篇（第9章和第10章）
本书的修订信息会发布在笔者的博客上，地址为http:/ixdba.blog.51cto.com。笔者会在该
绍了分布式文件存储系统MFS的结构、安装配置和基本的管理维护。
iSCSI的概念、组成、安装、配置和使用，还介绍了iSCSI在安全方面的设置方法。第8章介
网络存储应用篇（第7章和第8章）
配置，接着通过两个实际的企业案例演示了这两个工具在生产环境中的使用过程。
在bacula上进行完全备份、增量备份、差异备份、完全恢复、不完全恢复的具体操作步骤。
数据备份恢复篇（第4章至第6章）
性能监控方法，最后介绍了Memcached的几种升级产品和Memcached的使用经验。
由于作者的水平有限，加之编写的时间仓促，书中难免会出现一些错误或不准确的地方，
本书主要由高俊峰编写，其中，第3章、第14章杨海潮参与撰写，第8章陶利军参与撰写。
集群高级应用篇是本书的重点，主要介绍了高可用集群和负载均衡集群的应用案例。第
运维监控与性能优化篇介绍了Nagios监控软件及Linux服务器的性能优化方法。第9章
网络存储应用篇介绍了网络存储技术iSCSI和分布式存储系统MFS。第7章主要讲述
第5章讲述了开源数据镜像备份工具rsync和unison的使用，主要介绍两个软件的安装和
第6章讲述了如何利用ext3grep工具恢复误删除的数据文件和MySQL数据库的方法。
第4章讲述了开源备份软件bacula的安装、使用与管理技巧，然后通过实例方式介绍了
数据备份恢复篇介绍了几个常用的备份恢复软件：bacula、rsync、unison和ext3grep。
www.Linuxidc.com
，系统讲述了MySQL+heartbeat+DRBD+LVS集群解决方案的搭建过程。
同
G
---
## Page 8
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
感谢华章培训网妙妙老师的引荐，您的努力才促成了这本书的出版。
CU网友昌德胜（molecar），以及社区中遇到的其他朋友，感谢你们长期对社区的支持和贡献。
资深系统管理员田逸（sery）、IXPUB版主郭瑞佳（grjboy30）、IXPUB版主李康（winsky）、
辛苦付出。
持写完了这本书。
并提出了很多意见和建议。
致谢
人本书的微群（q.weibo.com/943166），期待能够收到你们的真挚反馈。
提出。如果您有更多的宝贵意见，也欢迎发送邮件至笔者的邮箱（PI:EMAIL），或加
感谢IXPUB社区每一位充满创意和活力的朋友—IXPUB管理员齐宝玮（网络忏悔）
感谢机械工业出版社华章公司的编辑杨福川老师和姜影老师，此书的出版离不开他们的
感谢我所在公司的杨武先生，感谢我的挚友王超、兰海文，是他们的鼓励和支持让我坚
VI
谨以此书献给我最亲爱的家人以及众多热爱Linux的朋友们。
感谢好友杨海潮、陶利军、郑辉，他们从技术角度对本书某些章节进行了修改和补充
首先要感谢我的爸爸妈妈，
www.Linuxidc.com
感谢你们将我培养成人，并时时刻刻向我传递信心和力量！
高俊峰（南非妈蚁）
君
PDG
---
## Page 9
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
第1章轻量级HTTP服务器Nginx/2
第1篇
前言
1.5Nginx常用配置实例/14
1.1什么是Nginx/2
1.5.4
1.5.3
1.5.2
1.5.1虚拟主机配置实例/14
1.4.4Nginx的启动、关闭和平滑重启/13
1.4.3配置与调试Nginx/6
1.4.2Nginx配置文件的结构/5
1.4.1下载与安装Nginx/4
Nginx的安装与配置/4
Nginx的模块与工作原理/3
1.2.2选择Nginx的优势所在/2
1.2.1Nginx与Apache的异同/2
为什么要选择Nginx/2
Web应用篇
www.Linuxidc.com
日志分割配置实例/17
防盗链配置实例/17
负载均衡配置实例/15
录
PDG
---
## Page 10
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
第2章高性能HTTP加速器Varnish/35
2.4
2
2.2
2.1初识Varnish/35
1.9
1.8
1.7
1.6Nginx性能优化技巧/18
VIII
2.4.2
2.4.1varnishd指令/48
运行Varnish/48
2.3.3Varnish对应多台Web服务器的配置实例/44
2.3.2
2.3.1VCL使用说明/38
配置Varnish/38
2.2.4安装Varnish/37
2.2.3
2.2.2
2.2.1安装前的准备/36
开始安装Varnish/36
2.1.3Varnish与Squid的对比/36
2.1.2
2.1.1Varnish概述/35
本章小结/34
1.8.4搭建Nginx+Java环境/32
1.8.3测试Nginx +Perl(FastCGI)/31
1.8.2
1.8.1Perl（FastCGI）的安装/29
实战Nginx与Perl、Java的安装与配置/28
1.7.7优化Nginx中FastCGI参数的实例/27
1.7.6
1.7.5
1.7.4
1.7.3
1.7.2
1.7.1
实战Nginx与PHP（FastCGI）的安装、配置与优化/22
1.6.3Nginx内核参数优化/20
1.6.2利用TCMalloc优化Nginx的性能/19
1.6.1编译安装过程优化/18
www.Linuxidc.com
配置Varnish运行脚本/48
配置一个简单的Varnish实例/42
安装pcre/37
获取Varnish软件/37
Varnish的结构与特点/35
为Nginx添加FCGI支持/30
测试Nginx对PHP的解析功能/27
配置Nginx来支持PHP/26
PHP与PHP-FPM的安装及优化/23
spawn-fcgi与 PHP-FPM/22
Nginx+FastCGI运行原理/22
什么是FastCGI/22
PDG
---
## Page 11
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
第3章Memcached应用实战/65
3.5本章小结/89
3.4
3.3
3.2
3.1Memcached基础/65
2.8
2.7
2.6Varnish优化/58
2.5管理Varmish/51
3.4.4使用memcached_functions_mysql的经验与技巧/88
3.4.3
3.4.2
3.4.1
通过UDFs实现Memcached与MySQL的自动更新/82
3.3.3Memcached变种产品介绍/81
3.3.2
3.3.1如何管理Memcached/75
Memcached的管理与性能监控/75
3.2.4Memcached的分布式算法/73