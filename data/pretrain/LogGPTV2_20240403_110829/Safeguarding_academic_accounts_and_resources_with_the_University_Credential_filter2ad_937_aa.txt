title:Safeguarding academic accounts and resources with the University Credential
Abuse Auditing System
author:Jing Zhang and
Robin Berthier and
Will Rhee and
Michael Bailey and
Partha P. Pal and
Farnam Jahanian and
William H. Sanders
Safeguarding Academic Accounts and Resources with the University Credential
Abuse Auditing System
Jing Zhang1, Robin Berthier2, Will Rhee3, Michael Bailey1, Partha Pal4, Farnam Jahanian1, and William H. Sanders2
1Dept. of Electrical Engineering and Computer Science, University of Michigan
{jingzj, mibailey, farnam}@umich.edu
2Information Trust Institute and Dept. of Electrical and Computer Engineering, University of Illinois at Urbana-Champaign
3Ofﬁce of Information and Infrastructure Assurance, University of Michigan
{rgb,whs}@illinois.edu
PI:EMAIL
4BBN Technologies, Cambridge, MA
PI:EMAIL
Abstract—Whether it happens through malware or through
phishing, loss of one’s online identity is a real and present
danger. While many attackers seek credentials to realize
ﬁnancial gain, an analysis of the compromised accounts at our
own institutions reveals that perpetrators often steal university
credentials to gain free and unfettered access to information.
This nontraditional motivation for credential theft puts a
special burden on the academic institutions that provide these
accounts. In this paper, we describe the design, implementation,
and evaluation of a system for safeguarding academic accounts
and resources called the University Credential Abuse Auditing
System (UCAAS). We evaluate UCAAS at two major research
universities with tens of
thousands of user accounts and
millions of login events during a two-week period. We show the
UCAAS to be useful in reducing this burden, having helped the
university security teams identify a total of 125 compromised
accounts with zero false positives during the trail.
Keywords-compromised account, university, authentication,
Virtual Private Network (VPN)
I. INTRODUCTION
Data theft on the Internet is a booming business [1].
Analysis of phishing [2] and malware [3] incidents shows
that attackers are very interested in ﬁnancial data, with
banking sites routinely topping the list of targets for data
theft. As a result, institutions and researchers have dedicated
considerable attention to addressing the issue of stolen and
compromised ﬁnancial credentials. While it is not surprising
that university environments have their own share of creden-
tial theft, an analysis performed at our own academic institu-
tions reveals that credentials stolen in university settings are
typically used not to acquire ﬁnancial data, but rather to gain
free and unrestricted access to information. Compromised
accounts actively utilize Virtual Private Network (VPN) and
library publication resources. The VPN enables attackers to
bypass censorship mechanisms deployed in their countries.
Recently, the exploitation of scholarly databases has also
become a lucrative business, as attackers download a large
978-1-4673-1625-5/12/$31.00 ©2012 IEEE
number of articles and then resell them on underground
markets [4].
To address the problem, we present in this article the
design,
implementation, and evaluation of a VPN abuse
detection system that focuses on supplementing existing
security measures to rapidly identify account compromises.
Our system analyzes authentication logs on a daily basis and
reports accounts for which suspicious activity is detected.
The detection technology is based on a machine-learning
approach that automatically generates a set of features before
classifying user activity. Our work makes three important
contributions. First, we report on the motivation of attackers
who compromise academic accounts based on several years
of incident analysis at two large universities. Second, we
present the design of an authentication log analysis solution
that can process the daily activity of thousands of accounts
with high accuracy and a low false-positive rate. Third, we
evaluate this system on several weeks of logs at each uni-
versity in close collaboration with the institutions’ security
teams. This large-scale experiment has led to interesting
insights about the speciﬁc challenges of analyzing malicious
activity from campus data.
II. BACKGROUND
University accounts have become an attractive target for
attackers seeking access to online campus resources. In fact,
during 2010 and the ﬁrst six months of 2011, the security
team at the University of Michigan (UofM) recorded 613
incident tickets related to unauthorized use of university
accounts. The incidents represented a signiﬁcant fraction
of the workload of security ofﬁcers. The issue was not
limited to UofM; the security team at the University of
Illinois at Urbana-Champaign (UIUC) recorded tickets for
26 compromised accounts in the ﬁrst half of 2011. This
burden led security teams at both universities to engage
researchers in an effort to better understand the threat and
help determine how to mitigate it.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:48:52 UTC from IEEE Xplore.  Restrictions apply. 
A. University Account Compromises
A study of the account compromises revealed a variety of
attack motivations. Traditional malicious activity included
spamming via university email accounts or installation of
malware on public machines. Adversaries also attempted
to access conﬁdential user information or even access con-
ﬁdential databases (e.g., hospital records, human resource
databases) via authorized accounts. Surprisingly, some com-
promise incidents involved users who simply wanted to
access seemingly mundane resources in an effort to have
free and unfettered access to information. For example, some
accounts were used to gain access to scholarly publications
available for free from university IP addresses, or to circum-
vent Internet ﬁltering in the attacker’s country of origin.
To understand the activity in more detail, the security
team at UofM collected 24 hours of Netﬂow data for the
VPN sessions of 8 compromised accounts. The accounts
were veriﬁed as compromised by the UofM security team,
and the 8 selected accounts were conﬁrmed by the security
personnel
to have no legitimate activity. All 8 accounts
were accessed from China. Our ﬁrst observation was that
the illegitimate users visited ten websites (e.g., Facebook,
YouTube) blocked by the network censorship deployed in
China. We conﬁrmed these ﬁlters via Chinese end hosts.
Those activities accounted for 8.2% of the total HTTP
Netﬂow we observed. Second, the library website was re-
peatedly visited during these sessions. A third interesting
observation was that hundreds of Netﬂow records (5.6% of
the total HTTP records) showed the adversaries logging in
to 7 accounts at other universities, which we conjecture was
a strategy to evade detection.
Figure 1. Chinese online market where account pirates sell stolen creden-
tials for publication download services. Here, year’s access to journals at
multiple scholarly databases is sold for 500RMB (less than $100).
Interestingly, we found that such illegitimate VPN and
library access was the most common kind of compromised
account activity (18.9% of the total incidents at UofM). Of
course, this type of access is not merely used by the attackers
themselves, but often resold. In June 2011, it was revealed
that stolen accounts from college students and professors
were sold on Taobao, one of the largest Chinese online
Figure 2. Authentication infrastructure.
marketplaces, giving access to the SciFinder database of
scientiﬁc articles [4]. Stolen credentials were provided for
less than ten dollars per month, complete with instructions
on how to use the university VPN and access scholarly
resources. Other sellers advertised that for a few pennies they
would provide scientiﬁc publications on-demand within 24
hours. Fig. 1 shows a screenshot of such an advertisement
from Taobao, an online market in China.
B. University Authentication Infrastructure
Universities usually provide an abundance of resources
and online services to vast and diversiﬁed user groups at
both the campus and college levels. For example, users have
access to webmail, VPN, course registration, online storage,
payroll and employment information management, and li-
brary resources. According to data collected in November
2010, there are 41,924 students and 34,947 faculty and staff
members (including university hospital personnel) at UofM,
but the total number of unique accounts reaches 556,281
because alumni and former employees can continue to use
their accounts after they leave the campus. Among those
accounts, 206,529 had recent activity. At UIUC, the pop-
ulation includes 54,612 people, including 43,862 students
and 10,750 faculty and staff members. Unlike UofM, UIUC
locks accounts a few months after students graduate or
employees leave the university.
As shown in Fig. 2, UofM and UIUC share a similar
authentication infrastructure built around the Kerberos au-
thentication protocol and different authentication portals for
various services. One is the single-sign-on protocol for Web
services (Cosign at UofM and Bluestem at UIUC). Both
Cosign and Bluestem are browser-based Web authentication
solutions that enable users to access restricted online re-
sources or Web applications at the universities. The other
important authentication channel is the VPN service. Users
can gain remote access to the university network through
different VPN clients. Logs from all the VPN gateways are
recorded. Those two types of service are our main focus
because they represent the majority of campus usage and
account compromises are likely to manifest in their logs.
III. DETECTION SYSTEM
A. Overview
1) Goals: The main design goal of the University Cre-
dential Abuse Auditing System (UCAAS) is to assist secu-
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:48:52 UTC from IEEE Xplore.  Restrictions apply. 
!"#$%&'($)&"#*)+','-&).&)*/0&.'!1#2&3#$"4#$*3'5*)#467580*)9/#4#$*3/0&.':&)%$"&/0$)&6&//;6$&3#:&)%$"&/?!1#2&3#$"4#$*3'@)*A+?B/&)'C$)&"#*)+?rity teams by automatically ﬂagging compromised accounts.
The ﬁrst requirement is that the system must be effective in
detecting compromised accounts, even if the illegitimate ac-
tivity is stealthy. The effectiveness of UCAAS relies heavily
on the account activity features chosen for classiﬁcation. We
engaged in discussions with the security teams at both uni-
versities, and we examined authentication logs from the past
two and a half years in order to gain a detailed understanding
of legitimate and malicious activity. As a result, we carefully
selected a combination of features in which illegitimate
activity would be most likely to manifest. We describe our
selection in Section III-B and evaluate it in Section IV-B.
Second, given the relative scarcity of compromised accounts
compared to the total population, the distribution of false
positives over true positives is likely skewed [5]. The cost of
false positives impacts both the operational team, which has
to spend time investigating ﬂagged accounts, and legitimate
users, because their accounts could be blocked. Discussion
with the security teams helped us to deﬁne the requirement
of a maximum average number of two false alarms per day.
2) Overall Design: UCAAS detects suspicious accounts
based on authentication logs collected from university sys-
tems. Since VPN is used as an entry point by attackers,
we ﬁrst ﬁlter authentication activity to keep only logs
generated by users who accessed the VPN at least once.
The second step consists of extracting and analyzing the set
of features for the daily activity of each account. The activity
captured by the different features describes the behavioral,
geographical, and topological pattern information, as well
as possible deviations from historical proﬁle data. Finally, a
classiﬁer runs on the feature vectors to determine whether
an account is compromised or not. The model used by the
classiﬁer is trained and built automatically from the past n
days of authentication logs. This training dataset is made of
both known compromised and legitimate accounts, and is
updated dynamically over time.
B. Features
1) Suspicious Behavior Features: First, we created three
heuristics based on our analysis of compromised account
behavior patterns. The thresholds in the heuristics are trans-
parent, as they were derived from operator experience.
Temporal-Spatial Violation: This feature captures
accounts that had activities from geographically different
locations in a short period of time. The key insight here is
that the activities of legitimate account owners and attackers
are independent. Thus,
if attackers and account owners
are located in different places, they will likely generate
inconsistencies in location and time of activities. Since
attackers can neither predict nor control the legitimate users,
this detection can hardly be evaded.
Suspicious IP Addresses: UCAAS labels an IP ad-
dress as suspicious if it was used by more than one account
to log in during one day. An analysis of historical compro-
mised account authentication logs revealed that a handful of
IP addresses scanned multiple compromised accounts within
a short period of time. In fact, at UofM, more than half of
the compromised accounts reported in 2009 and 2010 were
accessed by those malicious IP addresses.
Suspicious Usage Pattern: Account activity is labeled
as suspicious if it consists exclusively of a combination of
VPN and library accesses. Unlike the ﬁrst feature, which
relied on overlapping legitimate and malicious activities,
this feature aims to detect
idle accounts that are used
only by the compromising entity. For example, alumni and
student accounts are mostly inactive during vacation periods;
once those accounts have been compromised, their usage
patterns no longer reﬂect traditional academic activities (e.g.,
registering for classes, connecting to the wireless network).
Note that we use a threshold to characterize how exclusive
the usage pattern should be before an alert is raised. This is
to prevent attackers from evading the heuristic by randomly
logging in to resources other than the VPN and the library.
While this ﬁrst group of features focuses on deﬁning
speciﬁc signatures for illegitimate activity, the remaining
three groups of features take a complementary approach by
learning anomaly-based characteristics over time.
2) IP Address-based Features: We observed that
the
geographical and topological distributions of attackers were
not uniform. As a result, UCAAS generates three IP address-
based features to capture client origins that are likely linked
to illegitimate activity: geographic location, Autonomous
System Number (ASN), and Top-Level Domain (TLD).
3) Resource Usage-based Features: To expand on the
suspicious usage pattern heuristic, the system learns the
ratios of resource usage for the account. These ratios are
computed for each account based on the numbers of VPN
connections and university website accesses. This set of fea-
tures is based on the intuition that legitimate users usually go
to a variety of online services provided by their universities,
while attackers only exploit a few services heavily.
4) Proﬁle-based Features: Finally,
for each account,
UCAAS computes the probability that the latest activity
recorded matches the historic proﬁle of user activity col-
lected over the past week. An example proﬁle is presented
in Table I. If we observe a new authentication attempt from
the United States for this sample account, the probability
that this attempt ﬁts in the historical usage pattern is 91.2%.
The idea behind these features is that illegitimate activity
will not match the authentication habits of account owners.
C. Classiﬁcation
The next step after computing values for the different
features is to classify accounts into two classes: benign
or suspicious. For this task, UCAAS uses a logistic re-
gression classiﬁer implemented in Weka [6]. We initially
ran experiments with a variety of machine-learning algo-
rithms, including support vector machine, naive Bayes, and
K-nearest neighbors algorithms. Overall, we found that a
logistic regression classiﬁer provided the best accuracy.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:48:52 UTC from IEEE Xplore.  Restrictions apply. 
Feature
Value
Feature
Value
Feature
Value
Time of the Day
00:00–04:00: 3%
04:00–08:00: 7%
08:00–12:00: 30%
12:00–16:00: 40%
16:00–20:00: 15%
20:00–00:00: 5%
Timing-related
Day of the Week
Monday: 17.2%
Tuesday: 12.2%
Wednesday: 21.0%
Thursday: 19.0%
Friday: 20.0%
Saturday: 7.8%
Sunday: 2.8%
Location-related
Domain Names
example.COM: 86.9%
example.NET: 9.1%
example.ORG: 4.0%
ASN
27432: 79.6%
123: 20.4%
Country Code
US: 91.2%
CN: 8.8%
Resource-related
Usage Frequency
VPN: 22.3%
Wireless: 77.7%