# 区块链自私挖矿攻击剖析
|
##### 译文声明
本文是翻译文章，文章原作者 arxiv，文章来源：arxiv.xilesou.top
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
## 0x01 Introduction
区块链的安全性是由一连串的密码散列难题建立的，该难题由被称为矿工的匿名参与者大规模网络解决。PoW的安全性受到算力集中化趋势的挑战。开采比特币区块是随机的，使用最新一代的ASIC芯片平均需要10年以上的时间。因此，区块链矿工在战略上形成了矿池，每轮都有更大的机会解决难题。通过适当地分配挖矿奖励，他们可以获得稳定的收入率。带来的问题是少数矿池占据了全球算力的绝大部分，使区块链系统处于被巨型矿池或联合矿池推翻的风险中。传统观点认为，只要没有矿工控制总算力的51％，PoW是安全的。但是，矿工可以自由选择自私挖矿方案，而不是遵循标准的比特币协议。
本文研究了有关区块链安全性的一个基本问题，即存在多个行为异常的矿池如何影响自私挖矿的获利能力。每个自私的矿工都有一个私人链并寻找机会将其公开，以获取与其算力（哈希率，
_Hashrate_ ）不相称的更多奖励。
当存在多个自私矿工时，自私挖矿会变得更容易获利吗？自私矿工应等待几轮才能获利？前一个子问题的目的是弄清楚每个自私的矿工是否需要较小的哈希率阈值来获得比诚实矿工更多的回报。后者重视自私挖矿过程中的瞬态行为，并考虑了挖矿难度调整。
## 0x02 System Model
考虑一个具有两个行为异常的矿池Alice和Bob以及一个诚实的矿池Henry的区块链挖矿系统。他们竞争解决密码难题以挖掘有效区块,从而获取类似比特币的奖励。采用工作量证明共识，并且区块的挖掘是无状态的：矿工发现区块的概率与他当前的哈希率成正比，但与整个区块链网络的当前哈希率成反比。区块链系统可动态调整密码难题的难度，以便以固定的平均速率（例如，比特币中平均每10分钟一个区块）生成新区块。我们将“回合”定义为处理一次攻击的时间，矿工的收入是指他在最长链中所开采的区块的预期比例。
用α1，α2和αh分别表示Alice，Bob和Henry的哈希率，即α1+α2+αh=1。用γ1（或γ2）表示在Alice（或Bob）与Henry之间的分叉中，诚实的矿工在Alice（或Bob）发布的链之后进行挖矿的可能性。用θ1和θ2分别表示诚实的矿工在三方分叉平局中选择在Alice和Bob各自链之后挖掘的概率。当区块链系统创建一个新块时，由于指数分布掘区间的无记忆性，它以概率为αi被矿池i开采,
∀i ∈ {1, 2, h}。
Alice（Bob）可能会强迫Henry浪费自己的计算策略，从而有策略地发布自己的区块。当Alice和Bob都是自私的矿工时，两个私人链之间的互动变得更加复杂，因为他们都不知道对方的行为。接下来将展示每个矿工可能遇到的所有不同状态。
## 0x03 Selfifish Mining Mode
Alice维护私有链，Bob维护私有链，Henry维护公共链。Alice和Bob都不知道对方的角色。我们假设所有矿工在起点被表示为“
0”，开始就在同一条公共链上工作。Alice和Bob将私有链的长度保留为私人信息，所有人都能观察到公共链的长度。
挖掘过程包括以下两种情况：
**•公共链挖矿示例：** Henry总是在公链之后开采。如果公共链比Alice或Bob的私人链长，那么也会在公共链上进行挖掘。  
 **•私人链挖矿示例：** 如果Alice（Bob）发现了新区块并且私人链现在比公共链更长，那么他将继续在他上开采自己的私链。
发布过程比挖掘过程更为复杂。Henry一挖到区块就会广播，而Alice或Bob将根据公链的长度决定是否发布他们的区块：
**•放弃示例：**
Alice（Bob）放弃了私人链，并且如果公共链较长，则在公共链之后的挖矿。如果Alice或Bob发布更长的链，Henry也会放弃其公共链。  
 **•规避风险发布示例：**
Alice（Bob）将他私下开采的区块向公众发布，这是因为担心新区块被其他人开采所带来的损失，并担心其私有链的主要优势不超过两个块。  
 **•连锁反应示例：** 当Alice（Bob）向公共发布自己的链并更新其长度时，将立即触发其他私人链的发布。
连锁反应示例是放弃示例和避免风险发布示例的结合，连锁反应的存在使公链的演变复杂化。假设Alice发布了自己的私人区块以淘汰当前的公共链，在建立了新的公共链之后，Bob可能会发布其私人链以立即使Alice的失效。
## 0x04 Tie-breaking Logic
共识要求公共链是最长链，一个关键问题是，当公共链的长度与Alice（Bob）相同时，公共链将如何发展。总的来说，每个矿工都在自己的链上工作，当Henry挖掘一个新的区块时，就会触发Alice或Bob的发布行为。我们在此说明私有链和公共链的演变，其中Ak，Bk和Hk表示第k个区块分别属于Alice，Bob和Henry。私人链块为灰色，公共链块为白色
**规避风险发布：**
下图中显示了Alice的私有链的规避风险发布。在Henry为公共链挖掘新区块之后，Alice仅比Henry领先一个块。由于Alice担心会输掉竞争，因此她公开发布自己的私人块，从而使Henry的公共链失效，因此Alice和Henry都成为了新的最长链上的矿工。
**平局打破方案：**
如果Alice的私人链仅比Henry领先一个块，Henry可能会赶上她，Alice立即发布她的私人块以与Henry竞争。因此，下图中存在两个相同长度的公共链。由于只有一条公共链能胜出，因此需要考虑打破平局规则。
第一种情况是Alice和Henry的公共链长度相同，而Bob的私人链长度为0或很长。因此，我们只需要解决Alice和Henry之间的关系。所有矿工都可以在A1区块后开采，而Bob和Henry可以在H1区块后开采。延长最长的公共链有五种可能性，而较短的将被淘汰。我们忽略了Bob和Henry之间的平局，因为可以用相同的方式来分析。
对于Alice和Bob各自隐藏一个私人区块的情况，他们将在Henry找到新区块之后立即发布其私人链。如下图中存在三个竞争的公共链，Alice一定会在A1之后挖矿，而Bob肯定会在B1之后挖矿。Henry不知道哪个链是恶意分叉的，因此他可以在每个公共链上挖矿，还有五种可能的情况。规避风险的发布以及两个平局打破的方案构成了私有和公共链的所有动态。
**连锁反应发布：**
接下来将介绍使私人和公共链的演变复杂化的连锁反应版本。连锁反应发布由一系列规避风险发布和打破平局方案组成。下图说明了触发连锁反应现象的示例。在阶段1，Alice的私人链包含四个区块，而Bob的私人链和Henry的公共链的长度为0。在阶段2的平局解决之后，较长的公共链包含两个区块B1和H2，而较短的是孤立的。Bob挖掘了一条从B3到B8的新私人链，而Henry在第4阶段H2之后继续挖掘了一个区块。Alice发布了自己的私人区块，以避免失去与Henry竞争的风险。现在，新的公共链从A4块开始。接下来，阶段5和6构成了Alice和Henry之间的新一轮平局打破方案，将公共链扩展到了A7块。但是，发布A7会触发Bob发布从B3到B8的所有私有块。回顾所有挖矿阶段时，我们发现获胜分支会来回切换，从而使自私挖矿的分析变得极为复杂。