clurgmgrd[3252]:
clurgmgrd[3252]:
自动将服务切换回来。
使系统内核崩溃：
[2689]
[2689]
后，再次被加人到集群系统中，同时停止自身的服
[CPG
ICPG
ICPG
CLM
ICLM
[TOTEM]
[SYNC
CLN
CLM
 stop onscript
 Starting stopped service
This node is within the primary component
Members Joined:
Members Left:
joinlist
joinlist
joinlist
nodejoin
nodejoin
nodejoin
nodejoin
r(0)
r(0)
r(0)
Configuration:
Relocating service:webserver to
Joined:
Left:
ip(192.168.12.240)
ip(192.168.12.230)
message
(192
message
message
message
message
message
message
T2
.com
2.168.12.232)
真
from node
from node3
192.168.12.232
192.168.12.230
192.168.12.240
192.168.12.231
"mysqlscript"
N
·3
347
G
---
## Page 363
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
348
Mus
然后在节点web2上查看/var/log/messages日志。信息如下：
root@web2
2403:00:17 web2
240
24
delay
and
记
忆
记
03:00:17 
03:00:17 web2
:000
03:00:17
03:00:17
03:00:17
will provi
03:00:17
03:00:17
03:00:17
:00:0
00:0
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17w
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:17
03:00:10
02:59:57 web2
WWW.
~]#echo c>/proc/syarq-trigger
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
web2
openais[2689]:[CpG ]got
fenced[2728]:fencing
openais[2689]:
openais[2689]
2
fenced[2728]:
openais
openais
openais
openais [2689]
openais[2689]
openais
openais
openais
openais[2689]
openais
kernel:
openais[2689]
openais[2689]:
openais [2689] :
openais
openais[2689]
openais[2689] :
openais
openais [2689]
openais [2689]
openais[2689]
openais [2689] :
openais [2689] :
openais[2689]:
openais[2689]
openais [2689]
gdiskd[2712]:
openais[2689] :[TOTEM]
enais
benais
.Linuxidc.com
[2689]
[2689]
[2689]
[2689]
[2689]
[89]
[2689]
[2689]
[2689]
[2689]：
CLM
TO
SYNC
[CLM
[CLM
[CLM
厦
[CLM
[TOTEM]Did
[TOTEM]
TOTEM]
[TOTEM
[TOTEM
[TOTEM]
[TOTEM
TOT
[TOTEM]
TOTE
[TOTEM]
[TOTEM]
not
TEM
This
connecti
entering
Membe
Members
New
Members Joined:
Members
New
CLM
aru
DI
aru
position
aru
entering
St
Saving
Node 4evicted
entering GATHER
joinlist
joinlist message from node3
evl
ositi
toring new
ntering GATHER
"webI"
joinlist
nodejoin
nodejoin
nodejoin
ers
H
H
H
CONFIGURATION CHANGE
H
H
Configuration:
CONFIGURATION
92
92
ious ring seq 3036 rep 192.168.12.230
92
（0)
high
high
high delivered
OL
OPERATIONAL
Joined:
Left:
Left:
ip(192.168.12.240)
品
need
[1] member 192.168.12.232:
[0]member 192.168.12.231:
RECOVERY state.
COMMIT state.
(192.168.12.240)
(192.168.12.232)
(192.168.12,231)
(192.168.12.232)
message from node1
(192.168.12.231)
delivere
delivered 92 received flag
messa
message
message
message
to originate any messages
state
state from 12
age fromI
CHANGE
192.168.12.240
192.168.12.232
192.168.12.231
state.
192 received flag 1
92 received flag 1
from 11.
for.ring beo
node2
H
---
## Page 364
进行切换动作的。
情况一模一样，这里不再重复介绍。
件系统可以正常读写。
收到成功隔离的信息后
进程根据事先设置好的Fence agent调用Fence设备将web1成功隔离。在clurgmgrd进程接
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
Aug
Aug
首先停止web1节点，
这里将webl、Mysql2、Mysql1依次异常岩机，然后在web2节点上查看RHCS是如何
5.4个节点中的任意3个宕机
节点Mysqll在正常关机和异常岩机时，RHCS的切换状态与上面讲述的web1节点岩机
4.节点Mysql1岩机时
然后qdiskd进程将结果返回给cman进程。cman进程接着调用Fence进程，最后Fence
从输出日志可以看出，web1在异常岩机后，首先由qdiskd进程将失败节点从集群中隔
Aug 24 03:00:55 web2 clurgmgrd[3239]: Service gervice:webserver started
Aug
Aug
in recovery.
192.168.12.233 on etho.
from
journal..
24 03:00:55 web2 kernel:GFS2:fsid=mycluster:my-gfs2.3:jid=0:Looking at
acquire journal lock..
24 18:58:15
24 18:58:15
N
24
N
N
241
24 03:00:55 web2 kernel:GFs2:faid=mycluster:my-gfs2.3:jid=0:Trying to
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15
18:58:15