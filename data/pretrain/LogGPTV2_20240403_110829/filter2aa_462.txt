A"Hacker’s"Guide"to"Risk
Bruce"Potter
DefCon
PI:EMAIL ||"PI:EMAIL
Don’t"believe"anything"I"Say
• Also,"hold"those"around"you"accountable
Failures"in"Understanding"Risk
• Fukushima
• BP"Oil"Spill
The"other"side"of"the"coin…
• Takata airbag"recall
– Airbag"inflator"may"rupture"shoot"shrapnel"onto"
passengers"during"deployment
– Takata knew"about"the"defects"in"2004"and"
attempted"to"test"bags"in"offOhours"to"avoid"
disclosure
– NHTSA"has"been"criticized"for"their"“slow"roll”"on"
the"problem
– 34"million"cars"effected"in"North"America."Largest"
single"recall"in"the"history"of"automobiles
MATH!
The"Math"Behind"the"Takata Recall
•
Number"of"cars"on"the"roads"per"year"in"the"US:"250,000,000
•
Number"of"accidents"in"US"per"year:"5,500,000"(2009)
•
Number"of"accidents"involving"airbag"deployment:"Let’s"say"30%..."
Hard"to"find"but"70%"of"reported"crashes"are"property"damage"
only)"
– (let’s"assume"100%"of"these"involve"a"Takata airbag.."And"it"deploys."In"
reality"94%"of"effected"cars"have"1"Takata airbag…"6%"have"2."None"
have"more)
– (also"in"reality,"airbags"only"deploy"about"80%"of"the"time"in"serious"
crashes)
•
So"the"number"of"Takata airbags"deployed"is"on"the"order"of
– (#"affected[[]]"cars"/"#"cars"on"road)"*"#"of"airbag"deployments/year"="
224,400"crashes"/"year"where"a"Takata airbag"deploys
• “Airbag"inflator"may rupture"shoot"shrapnel"onto"
passengers"during"deployment”
• Ballistic"testing"indicates"failure"rates"up"to".084%
• Some"samples"were"~.04%
• That’s"brings"us"to"~188"people/year"potentially"
injured"by"Takata airbags
• Some"of"those"people"would"died"regardless
• My"assumptions"to"this"point"have"been"worse"case
• Let’s"say"in"reality"we’re"talking"about"100"people/year
LARGEST"RECALL"IN"US"AUTOMOTIVE"
HISTORY
• Takata O $500"million
• Honda"O $340"million
• Others"haven’t"reported
• Easily"over"$1"billion
Is"preventing"100"injuries"a"year"
worth"$1"billion?
Death"Statistics
• ~500"people/year"die"from"TB
• ~500"people/year"die"from"accidental"gunshot"
wounds
– What"would"a"billion"do"for"them?
• 40,000"people/year"die"from"suicide
– What"would"a"billion"do"for"them?
What"is"Risk?
• Like"really.."What"the"hell"is"“risk”?
What"is"Risk?
• Risk"to"a"bank"– Situations"that"can"lead"to"
loss"of"funds"or"profit
• Risk"to"a"manufacturing" org"– situations"that"
lead"to"loss"of"IP"and"pricing"data
• Risk"to"an"ISP"– Situations"that"can"lead"to"
service"disruption"or"lost"of"customer"data
• In"general,"risk"is"a"situation"where"something"
you"value"can"be"put"in"harms"way
Risk"vs."Threat"vs."Vulnerability
• Risk"Syntax
– $LIKELIHOOD"that"$CAUSE"results"in"$IMPACT
• Threat"Syntax
– $ACTOR"does"$ACTION"to"$ASSET"for"$OUTCOME"because"
$MOTIVATION
• Vulnerability
– A"weakness"in"a"system"that"can"be"exploited
• Risk"tends"to"be"bigger/more"general"than"threat."
Multiple"threats"can"role"up"in"to"a"single"risk
• Threats"rely"on"vulnerabilities"to"be"realized
An"example
• Risk
– It"is"highly"likely"that"an"attacker"will"gain"access"to"
our"database"server"leading"to"loss"of"all"personal"
information"in"database"and"heavily"damaging"our"
brand
An"example
Likelihood
highly"likely"
• Risk"– Likelihood
– It"is"highly"likely"that"an"attacker"will"gain"access"to"
our"database"server"leading"to"loss"of"all"personal"
information"in"database"and"heavily"damaging"our"
brand
An"example
Likelihood,"Cause
highly"likely"
an"attacker"will"gain"access"to"
our"database"server
• Risk"– Likelihood,"Cause
– It"is"highly"likely"that"an"attacker"will"gain"access"to"
our"database"server leading"to"loss"of"all"personal"
information"in"database"and"heavily"damaging"our"
brand
An"example
Likelihood,"Cause,"Impact
highly"likely"
an"attacker"will"gain"access"to"
our"database"server
loss"of"all"personal"
information"in"database"and"heavily"damaging"our"
brand
• Risk"– Likelihood,"Cause,"Impact
– It"is"highly"likely"that"an"attacker"will"gain"access"to"
our"database"server leading"to loss"of"all"personal"
information"in"database"and"heavily"damaging"our"
brand
An"example
• Risk
– It"is"highly"likely"that"an"attacker"will"gain"access"to"our"database"
server"leading"to"loss"of"all"personal"information"in"database"
and"heavily"damaging"our"brand
• Threats
– External"attackers"can"execute"SQL"injection"attack"against"our"
webservers
– Insiders"will"inappropriately"log"in"to"the"database"server"via"
shared"credentials
– Nation"states"will"backdoor"our"database"server"hardware
• Vulnerabilities
– Our"website"has"SQLi weaknesses
– We"use"shared"creds for"database"access
– We"buy"our"servers"from"an"Iranian"on"eBay
How"Do"We"Measure"Risk?
• NIST"800O30"(2002"publication)
– Vulnerability"X"Likelihood"X"Impact
How"Do"We"Measure"Risk?
• NIST"800O30"(2012"publication)
Likelihood
• Choose"a"scale"
and"stick"with"it
– NIST"800O30r1"is"
a"good"starting"
point
• Another"
model"that"
has"served"me"
well
Likelihood
Description
Very"High
Almost"Certain
High
Highly"Likely
Medium
Somewhat"Likely
Low
Unlikely
Very Low
Highly"Unlikely
Likelihood
Description
High
Is happening" to"
us"or"to"others"in"
our"vertical
Medium
Happening" to"
orgs"not"in"our"
vertical
Low
Not"happening
Impact
• Again,"NIST"
800O30r1"is"
probably"the"
easiest"place"to"
start
Impact
Description
Very"High
Multiple" Severe"
or"Catastrophic
High
Severe"or"
Catastrophic
Medium
Serious
Low
Limited
Very Low
Negligible
Types"of"Risk
• Technical"Risk"vs."Business"Risk
– Technical"– Risk"that"impacts"IT,"engineering,"
development,"or"other"“technical”"operations"
– Business"– Risk"that"impacts"business"operations
– In"my"experience,"the"security"industry"is"good"at"
identifying"technical"risks"and"lousy"at"identifying"
business"risks
• Inherent"Risk"vs."Residual"Risk
– Inherent"– Risk"in"the"“as"is”"system"or"system"without"
compensating"controls
– Residual"– Risk"that’s"left"over"after"you’ve"
implemented"controls/remediation"activities
Understanding"Threats?
• Google"“Bruce"Potter"Derbycon Threat”."
Risk"Frameworks
•
NIST"800O30r1"– Guide"for"Conducting"Risk"Assessments
– A"process"you"can"work"through."Attempting"to"make"Risk"
Assessments"uniform"throughout"USG
•
NIST"Cyber"Security"Framework
– Not"something"you"“do”."It’s"a"common"taxonomy"of"security"controls"
and"how"you"can"measure"“as"is”,"“to"be”"and"maturity
•
Cyber"VAR"– Cyber"Value"At"Risk
– A"structured"way"to"put"a"concrete"dollar"amount"around"the"impact"
of"risk"and"a"rollOup"risk"number"to"represent"cyber"risk
•
HITRUST"Risk"Management"Framework
– Healthcare"specific"RMF
•
If"you"squint,"you"can"turn"NIST"800O53,"COBIT,"ISO"27k,"etc in"to"risk"
frameworks."This"is"the"“control”"view"of"the"world"and"is"quite"
common.
Why"is"Risk"Important"to"Hackers?
• That"was"a"lot"of"acronyms…" and"seems"far"
removed"from"what"most"hackers"care"about
• Turns"out,"when"we"measure"risk"incorrectly,"
we"lose"credibility"and"traction
– May"even"cause"harm."Certainly"cause"wasted"
time
• Examples…
Imagine"a"vulnerability"that…
• Requires"you"to"be"actively"manOinOtheOmiddle"
the"victim"(so"you’re"a"nation"state"or"on"the"
same"LAN)
• The"attack"requires"you"to"MiTM each"individual"
TCP"connection
• The"attack"requires"$100"post"processing"to"look"
inside"the"data"just"to"see"if"there’s"anything"of"
interest
• How"would"you"rate"this?
Imagine"a"vulnerability"that…
Likelihood
Description
Very"High
Almost"Certain
High
Highly"Likely
Medium
Somewhat"Likely
Low
Unlikely
Very Low
Highly"Unlikely
Impact
Description
Very"High
Multiple" Severe"
or"Catastrophic
High
Severe"or"
Catastrophic
Medium
Serious
Low
Limited
Very Low
Negligible
…Must"actively"MiTM…
…Must"MiTM each"TCP"session…
…Have"nonOtrivial" amount"of"
post"processing…
Know"what"it"is?
Up"next…"PCI
*groans*
Seriously,"how"specifically"does"PCI"
incorrectly"deal"with"risk
• HUGE"number"of"requirements"levied"on"
individual"webservers…"in"particular"on"cipher"
types,"key"size,"etc
– At"the"time"of"PCI"standard’s"creation,"VERY"little"
evidence"that"weak"crypto"configurations"were"being"
attacked
– Fast"forward"to"today,"that’s"still"the"case
• The"real"issue"are"the"backend"systems"and"the"
integrity"frontOline"systems"like"POS"machines
– These"were"being"attacked"before,"and"they’re"being"
attacked"now
Has"PCI"incorrectly"managed"risk?
• Heartland"was"PCI"compliant"at"the"time"they"
were"breached
• Target"was"PCI"compliant"at"the"time"they"
were"breached
• Home"Depot"was"PCI"compliant"at"the"time"
they"were"breached
• YES!
Does"that"stop"people"from"bitching"
about"SSL"“misconfiguations”?
• Nope
• If"you"run"VA"tools"against"your"network,"you"
live"this"dream"every"day
Other"Examples…
• DNSSec (/me"looks"around"room"for"DT)
• EMET
• Shift"to"the"Cloud
Operationalizing"Risk"(aka:"So"What?)
• Pick"a"framework"and"run"with"it
• Me?"I"like"NIST"800O30"and"the"CSF
– 800Oprovides"the"process,"the"CSF"provides"the"
structure
Threat5Modeling
O
MS5Style
O
Mine
O
Others?
Architectural5assessment
Code5Review
Pen5testing5/5VA
Etc…
“using5common5sense”
…seriously,5risk5isn’t
hard,5it’s5just5structured…
The"Core…"aka:"All"Things"Security
And"in"general
• Banks"are"big"risk"management"machines
• So"are"cyber"security"orgs
• Apply"risk"concepts"for
– Vulnerability"release"and"analysis
– New"defenses
– New"attack"methods
– New"threat"actors,"campaigns,"etc..
– You"know.."All"the"time,"every"day
Questions