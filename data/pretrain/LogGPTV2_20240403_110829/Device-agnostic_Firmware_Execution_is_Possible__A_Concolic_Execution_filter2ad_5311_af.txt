RTOS
NXP_FRDM-K66F
Bare-metal
NXP_FRDM-KW41Z
STM32100E_EVAL
FreeRTOS
Bare-metal
FreeRTOS
Bare-metal
FreeRTOS
ChibiOS
Mbed OS
STM32 Nucleo-L152RE
1. Real Time Clock
4. System Mode Controller
7. Low Power Universal Asynchronous Receiver/Transmitter
10. External Watchdog Monitor
13. FlexTimer Module
16. Random Number Generator Accelerator
19. Cyclic Redundancy Check
22. Universal Asynchronous Receiver/Transmitter
24. Universal Synchronous/Asynchronous Receiver/Transmitter
Peripheral
LPUART 7
RTC 1
ADC 2
GPIO 3
SMC 4
DAC 5
PIT 6
#
1
2
3
4
5
6
7
TPM 8
8
CMP 9
9
EWM 10
10
11 WDOG 11
CMT 12
12
FTM 13
13
LPTMR 14
14
FLEXCAN 15
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
RNGA 16
EDMA 17
SAI 18
CRC 19
MPU 20
ENET 21
UART 22
UART
RTC
I2C 23
UART
USART 24
USART
USART
UART
Success Need Human
Image
Intervention Context_Depth Forward_Depth Size (KB)
Minimal
Minimal
2
1
2
4
3
1
1
1
2
2
3
2
2
2
–
–
–
–
–
–
2
1
1
1
–
1
1
1
4
5
N
N
N
N
N
N
N
N
N
Y
N
N
N
N
–
–
–
–
–
–
Y
N
N
N
–
N
N
N
N
N
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
Y
N
N
N
N
N
N
Y
Y
Y
Y
N
Y
Y
Y
Y
Y
2. Analog-to-Digital Converter
5. Digital-to-Analog Converter
8. Timer/PWM Module
11. Watchdog Timer
14. Low-Power Timer
17. Enhanced Direct Memory Access
20. Memory Protection Unit
23. Inter-Integrated Circuit
5
4
3
5
4
3
2
3
3
3
5
3
3
3
–
–
–
–
–
–
3
3
2
3
–
3
2
2
4
6
20.0
17.0
5.1
26.0
17.0
18.0
12.0
20.0
17.0
17.0
17.0
18.0
19.0
18.0
22.0
16.0
24.0
38.0
17.0
19.0
65.0
29.0
8.7
22.0
22.0
22.0
4.5
13.0
5.5
92.0
3. General-Purpose Input/Output
6. Periodic Interrupt Timer
9. Comparator
12. Carrier Modulator Transmitter
15. 10/100-Mbps Ethernet MAC
18. Synchronous Audio Interface
21. Flexible Controller Area Network
[30] Chi-Keung Luk, Robert Cohn, Robert Muth, Harish Patil, Artur Klauser,
Geoff Lowney, Steven Wallace, Vijay Janapa Reddi, and Kim Hazel-
wood. 2005. Pin: Building Customized Program Analysis Tools with
Dynamic Instrumentation. In Proceedings of the 2005 ACM SIGPLAN
Conference on Programming Language Design and Implementation
(PLDI’05).
[31] Leonardo De Moura and Nikolaj Bjørner. 2008. Z3: An Efficient SMT
Solver. In Proceedings of the 14th International Conference on Tools and
Algorithms for the Construction and Analysis of Systems (TACAS’08).
[32] Marius Muench, Aurélien Francillon, and Davide Balzarotti. 2018.
Avatar2: A Multi-target Orchestration Platform. In Workshop on Binary
Analysis Research.
16
[33] Marius Muench, Jan Stijohann, Frank Kargl, Aurélien Francillon, and
Davide Balzarotti. 2018. What You Corrupt Is Not What You Crash:
Challenges in Fuzzing Embedded Devices. In Proceedings of the 2018
Network and Distributed System Security Symposium (NDSS’18).
[34] Nicholas Nethercote and Julian Seward. 2007. Valgrind: A Framework
for Heavyweight Dynamic Binary Instrumentation. In Proceedings of
the 28th ACM SIGPLAN Conference on Programming Language Design
and Implementation (PLDI’07).
[35] Joshua Pereyda. 2016. boofuzz: Network Protocol Fuzzing for Humans.
https://github.com/jtpereyda/boofuzz.
[36] NGUYEN Anh Quynh and DANG Hoang Vu. 2015. Unicorn: Next
Generation CPU Emulator Framework. Black Hat USA.
[42] Seyed Mohammadjavad Seyed Talebi, Hamid Tavakoli, Hang Zhang,
Zheng Zhang, Ardalan Amiri Sani, and Zhiyun Qian. 2018. Charm:
Facilitating Dynamic Analysis of Device Drivers of Mobile Systems.
In Proceedings of the 27th USENIX Security Symposium (USENIX Secu-
rity’18).
[43] Qiuping Yi, Zijiang Yang, Shengjian Guo, Chao Wang, Jian Liu, and
Chen Zhao. 2018. Eliminating Path Redundancy via Postconditioned
Symbolic Execution. IEEE Transactions on Software Engineering 44, 1
(January 2018).
[44] Jonas Zaddach, Luca Bruno, Aurelien Francillon, and Davide Balzarotti.
2014. Avatar: A Framework to Support Dynamic Security Analysis
of Embedded Systems’ Firmwares. In Proceedings of the 2014 Network
and Distributed System Security Symposium (NDSS’14).
[45] Yufeng Zhang, Zhenbang Chen, and Ji Wang. 2012. S2PF: Speculative
Symbolic PathFinder. ACM SIGSOFT Software Engineering Notes 37, 6
(Nov. 2012).
[46] Yaowen Zheng, Ali Davanian, Heng Yin, Chengyu Song, Hongsong
Zhu, and Limin Sun. 2019. FIRM-AFL: High-Throughput Greybox
Fuzzing of IoT Firmware via Augmented Process Emulation. In Pro-
ceedings of the 28th USENIX Security Symposium (USENIX Security’19).
Device-agnostic Firmware Execution
Anonymous Submission to MobiCom, 2020
CA, USA.
[37] Matthew J. Renzelmann, Asim Kadav, and Michael M. Swift. 2012.
SymDrive: Testing Drivers Without Devices. In Proceedings of the 10th
USENIX Conference on Operating Systems Design and Implementation
(OSDI’12).
[38] Koushik Sen, Darko Marinov, and Gul Agha. 2005. CUTE: A Concolic
Unit Testing Engine for C. In Proceedings of the 10th European Software
Engineering Conference Held Jointly with 13th ACM SIGSOFT Interna-
tional Symposium on Foundations of Software Engineering (ESEC/FSE-13)
(ESEC/FSE-13).
[39] Hyunmin Seo and Sunghun Kim. 2014. How We Get There: A Context-
guided Search Strategy in Concolic Testing. In Proceedings of the 22nd
ACM SIGSOFT International Symposium on Foundations of Software
Engineering (FSE’14).
[40] Yan Shoshitaishvili, Ruoyu Wang, Christopher Salls, Nick Stephens,
Mario Polino, Andrew Dutcher, John Grosen, Siji Feng, Christophe
Hauser, Christopher Kruegel, and Giovanni Vigna. 2016. SoK: (State
of) The Art of War: Offensive Techniques in Binary Analysis. In Pro-
ceedings of the 37th IEEE Symposium on Security and Privacy (S&P’16).
[41] Jim Smith and Ravi Nair. 2005. Virtual Machines: Versatile Platforms for
Systems and Processes (The Morgan Kaufmann Series in Computer Archi-
tecture and Design). Morgan Kaufmann Publishers Inc., San Francisco,
17