s
a
C
d
e
t
n
a
W
i
r
e
h
s
a
C
l
e
b
a
l
i
a
v
A
r
e
m
r
i
f
n
o
C
l
e
b
a
l
i
a
v
A
S
o
D
t
d
e
n
a
W
r
e
h
s
h
P
i
t
d
e
n
a
W
r
e
d
r
a
C
t
d
e
n
a
W
r
e
m
r
i
f
n
o
C
Ad Type (Services)
l
e
b
a
l
i
a
v
A
r
e
h
s
h
P
i
t
d
e
n
a
W
S
o
D
l
e
b
a
l
i
a
v
A
r
e
d
r
a
C
Figure 14: Distribution of ads for services in labeled data.
4.2 Services
Ads for Services: Measurement Methodology.
In addition to en-
abling access to various digital goods, the market includes a rudi-
mentary offering of services primarily tailored to miscreants per-
forming ﬁnancial fraud. The most common service ad are offers
for the services of a cashier, a miscreant who converts ﬁnancial
accounts to cash. Conﬁrmers are used to assist in the veriﬁca-
tion step of Western Union money transfers. Money transfers from
credit cards require a conﬁrmation step where the individual trans-
ferring funds from the credit card answers questions to prove they
are the card’s rightful owner. This service is commonly offered
on a gender-speciﬁc basis. In addition to ﬁnancial fraud, a small
percentage of service ads offer services such as DoS attacks, send-
ing phishing emails, and purchasing goods with other’s credit cards
(a.k.a., carding).
Ads for Services: Measurement Result.
distribution of service ads over the labeled dataset.
Figure 14 shows the
4.3 Prices
Before public underground markets were established, quantify-
ing the cost or difﬁculty of obtaining a compromised host, a spam
relay, or an identity was highly subjective. One might estimate the
cost by performing calculations which depend on opaque quantities
such as an attacker’s prowess or level of qualitative skill level such
as “script kiddie” or “elite hacker.” Such qualitative techniques
rarely meet the requirements of organizations seeking to assess
their exposure to security-related risks or researchers interested in
measuring the security of a system. Given that active underground
markets exist with individuals buying and selling goods and ser-
vices of all types, we can monitor these markets to quantify the
difﬁculty of acquiring a resource. In particular, underground mar-
kets establish the monetary cost to acquire an illegal good such as
a compromised host.
To demonstrate why quantifying the difﬁculty of acquiring a re-
source in monetary terms is useful, consider the case of a DDoS
defense scheme. A useful technique to evaluate such schemes is
the number of machines (or the level of resources) required to over-
whelm the defense. DDoS defense papers are rife with claims of
security against various resource levels; however, they often fail to
quantify the cost of acquiring such resources. The machine learning
techniques and analysis in this paper can ﬁll this void by establish-
ing prices for relevant goods and services.
Price of Compromised Hosts: Measurement Methodology. We
ﬁrst extract all messages which contain explicit prices (a dollar sign
and at least one non-zero digit) and remove repeated messages.
Next, we use the SVM classiﬁer trained to identify sale ads for
compromised hosts to ﬁlter the remaining lines for just those lines
containing asking prices for compromised hosts. Finally, we ran-
domly sample the asking prices and manually extract prices.
)
s
r
a
l
l
o
D
S
U
(
e
c
i
r
P
g
n
k
s
A
i
35
30
25
20
15
10
5
0
JAN
FEB
MAR
APR
MAY
JUN
JUL
AUG
Month in 2006
Figure 15: Asking prices for compromised hosts.
Price of Compromised Hosts: Measurement Results. The re-
sults of our measurements are presented in Figure 15. These prices
enable defenders to quantify the cost to buy sufﬁcient resources to
overcome a defense system. For example, a DDoS defense that
is effective up to 1,000 hosts can be overwhelmed by $10,000 in
January or as little as $2,000 in February. The cost to buy can be
used to assess the strength of an adversary with resources r at time
t. For example, a $10,000 adversary can purchase 1,000 compro-
mised hosts in January. For simplicity, we assume that sufﬁcient
quantity is available to satisfy the quantity demanded, that each
host is sold at the asking price, and that there is no volume dis-
count.
In addition to measuring the cost to buy compromised hosts, the
measurement techniques used in this paper can assist in measur-
ing costs for resources used by spammers, phishers, and identity
thieves. These prices can be used to establish the cost to send tar-
geted spam emails, to purchase a bank or PayPal account, or to
steal an identity. Further evaluation is necessary to validate that the
cost to buy a resource provides an accurate and reliable metric to
measure the risk associated with a resource when an adversary’s
resources are expressed in monetary terms.
5. DISCUSSION
We begin with a discussion of how the market data gathered in
this paper could potentially provide a new approach for quantifying
Internet security. Next, we discuss potential low-cost approaches to
disrupt the underground markets which deviate signiﬁcantly from
one approach currently used by law enforcement [17]. Although
the approaches we describe in this section rely on oversimpliﬁca-
tions, we believe that our preliminary explorations will help moti-
vate the challenges that lie ahead and encourage further research.
5.1 Inferring Global Statistics and Trends
Measuring global statistics and trends such as the number of
compromised Internet hosts or the number of stolen identities is
a difﬁcult task. Not only do these phenomena exhibit a signiﬁcant
variance over time, but they are difﬁcult to directly measure due to
insufﬁcient coverage.
We consider the task of measuring trends in the total number
of compromised hosts on the Internet. We take an economic ap-
proach to measurement which deviates signiﬁcantly from previous,
primarily statistical approaches. Rather than measuring the number
of packets received at a network telescope and extrapolating the ag-
gregate number of compromised hosts based on a random-scanning
assumption, we can use the laws of supply and demand and market
measurements to infer global trends.
The law of supply states that, all other factors remaining con-
stant, the supply of a good or service is proportionate to its price.
The law of demand states that, all other factors remaining con-
stant, the demand for a good or service is inversely proportionate
to its price. These laws establish the well-known supply and de-
mand curves shown in Figure 16(a). When we observe the equi-
librium price for a good or service in a market, the price provides
the y-coordinate of the intersection point of the supply and demand
curves. As the supply and demand curves shift in response to mar-
ket forces, we observe changes in the market equilibrium price.
Given that we are unable to directly measure the quantity of goods
or services available, we need a method to infer quantities or the
change in quantity supplied or demanded at a point in time.
If
we assume that demand remains constant over short time periods
– or we establish that demand has remained constant by directly
measuring the forces which cause shifts in demand (population,
income, price of a substitute or complement, and expected future
value) – then changes in the price of a good or service are the result
of supply-side factors. An example of an increase in supply and the
corresponding effects is illustrated in Figure 16(b).
e
c
i
r
P
P0
Supply
Demand
e
c
i
r
P
P0
P1
Supply
Demand
Q0
Quantity
Q0
Q1
Quantity
(a) Supply and demand
curves
(b) Shift of supply curve.
Figure 16: Inferring underlying market trends.
Consider the price of a compromised host in an underground
market. Under the assumption of constant demand, if the equilib-
rium price for a compromised host at time t is P0 and the price is P1
at time t+1, then we can infer that the total quantity of compromised
hosts available has increased. Even if we aren’t able to directly
measure the quantities Q0 or Q1, the laws of supply and demand
provide us with the ability to measure trends. A similar analysis
is possible when supply remains constant and demand-side factors
cause a shift in the demand curve. In addition, more sophisticated
econometric techniques such as simultaneous equation models can
be used to solve for supply and demand curves.
5.2 Efﬁcient Countermeasures
Underground markets represent a substantial security threat. Pre-
vious approaches for disrupting underground markets have focused
on standard law enforcement activities such as locating and dis-
abling hosting infrastructure or identifying and arresting market
participants [17]. These techniques face numerous social and tech-
nological hurdles which limit their success and result in substantial
associated costs. For example, disabling the hosting infrastructure
for a market may require multi-national cooperation, which can be
time and resource consuming. Furthermore, nations may refuse
to cooperate with foreign law enforcement agencies or may lack
appropriate laws for prosecution. Even in the case where law en-
forcement techniques have succeeded in disrupting an underground
market, the markets often re-emerge under new administration with
a new “bulletproof” hosting infrastructure. Identifying and arrest-
ing key players also includes a host of associated complexities and
costs, such as tracing individuals through chains of compromised
hosts and the cost of subsequent legal proceedings.
The substantial costs and limited success of standard law en-
forcement techniques motivate our search for low-cost approaches
to countering the threat posed by underground markets.
In this section, we sketch two low-cost countermeasures based
on principles in economics and natural limitations in the client
identiﬁcation capabilities of open underground markets. The ﬁrst
is a Sybil attack and the second is a slander attack. The goal of this
preliminary exploration is to highlight open challenges and present
initial approaches on how to tackle them.
5.2.1 Sybil Attack
In a Sybil attack on a voting system, an attacker creates numer-
ous identities (Sybils) in order to control a disproportionally high
percentage of votes [7]. Using a similar idea, we can exploit the
open nature of the underground market to establish Sybil identities
which in turn disrupt the market by undercutting its participant ver-
iﬁcation system. To demonstrate our attack concretely, we describe
it in the context of the market studied in this paper. Our attack
proceeds in three stages: 1) Sybil generation, 2) achieving veriﬁed
status, and ﬁnally 3) deceptive sales.
Sybil Generation.
In stage one, an attacker establishes multi-
ple Sybil identities by connecting to the market’s IRC servers and
registering nicknames. The required number of Sybil identities de-
pends on the number of veriﬁed-status sellers in the market. A
higher ratio of Sybils to veriﬁed-status sellers will improve the
overall effectiveness of the attack.
Achieving Veriﬁed Status.
In stage two, an attacker builds the
status of each Sybil identity. This can be accomplished through
positive feedback from other Sybils or out-of-band activities. The
veriﬁcation system of the underground market studied in this pa-
per provides veriﬁed status to participants who freely provide high-
quality credit card data. The success of a Sybil attack depends on
the cost associated with generating a Sybil identity and the cost
of achieving veriﬁed status. For a Sybil attack to be successful,
these costs must be minimized. For the studied market, a low-cost
technique to achieve veriﬁed status is to enter several separate IRC
channels and replay credit card data seen in one channel to a differ-
ent channel. This allows veriﬁed-status Sybils to be produced at a
minimal cost.
Deceptive Sales.
In stage three, an attacker utilizes their veriﬁed-
status Sybils to advertise goods and services for sale. Rather than
undergoing an honest transaction, the attacker ﬁrst requests pay-
ment and subsequently fails to provide the good or service promised.
Such behavior is known as “ripping” and it is the goal of the ver-
iﬁcation system to minimize such behavior. However, poor con-
trols on how one achieves veriﬁed status and establishes identities
make it possible to undermine the market’s veriﬁcation system. If
an attacker’s Sybils are indistinguishable from other veriﬁed-status
sellers, a buyer will be unable to identify honest veriﬁed-status sell-
ers from dishonest veriﬁed-status Sybils. In the long term, buyers
will become unwilling to pay the high asking price requested by
veriﬁed-status sellers because of the buyer’s inability to assess the
true quality of sellers.
Markets that exhibit this form of asymmetric information, where
buyers are unable to distinguish the quality of goods, are known
as lemon markets [2]. Lemon markets see a reduction in success-
ful transactions until the information asymmetry is corrected. In
our case, the market would need to establish a veriﬁcation system
which is robust against Sybil attacks. One approach would be to
detect anomalous recommendation topologies [21], but this would
require a sophisticated system for tracking interactions over time.
Another approach would be to increase the cost of establishing an
identity, in turn pushing the market towards a closed market, which
discourages new individuals from joining – subsequently raising
the barrier to entry for cybercrime.
5.2.2 Slander Attack
In a slander attack, an attacker eliminates the veriﬁed status of
buyers and sellers through false defamation. By eliminating the
status of honest individuals, an attacker again establishes a lemon
market. To understand why, consider a market with one veriﬁed-
status seller, Honest Harry, one unveriﬁed seller, Dishonest Dale,
and an unlimited number of buyers. If the veriﬁcation system ac-
curately classiﬁes individuals into honest and dishonest classes, in
turn minimizing the variance in expected payoff of an entity, Hon-
est Harry will charge a premium for his goods since a buyer’s ex-
pected payoff when undertaking a transaction with Harry will be
higher than their expected payoff with Dishonest Dale. Assume a
number of buyers slander Harry, subsequently eliminating his ver-
iﬁed status. As a result, buyers will lower their expected payoff
for transactions with Harry under the assumption that Harry is less
honest than before (exhibits a higher variance in payoffs). How-
ever, having remained honest, Harry will be unwilling to accept a
lower price (since in an efﬁcient market Harry is already selling at
equilibrium). Buyers will, in turn, leave the market or undertake
transactions with Dishonest Dale, who may fail to uphold his end
of a transaction. Regardless, the result is a marked decrease in the
number of successful transactions – a desired outcome.
6. RELATED WORK
Related work falls into two categories: underground markets and
the economics of information security.
Previous studies have framed the existence of underground cyber
markets, but have not systematically analyzed the markets [18, 19].
We employ machine learning techniques and random sampling to
classify logs into a number of categories; allowing us to assess the
extent of miscreant behavior rather than only observing snapshots
in phenomenological terms.
Anderson discusses why security failures may be attributable to
“perverse economic incentives” in which victims bear the costs of
security failures rather than those who are responsible for the sys-
tem’s security in the ﬁrst place [3]. Schechter develops an argument
that the cost to break into a system is an effective metric to quanti-
tatively assess the security of the system [15]. Schechter also sug-
gests that vulnerability markets could be set up to entice hackers to
ﬁnd exploits. The lowest expected cost for anyone to discover and
exploit a vulnerability is the Cost to Break metric. Schechter also
advances an econometric model of the security risk from remote at-
tack [16]. In comparison, this paper proposes a security metric not
for a particular system with unknown vulnerabilities, but for the In-
ternet as a whole. Similar to the cost to break metric, our proposed
metric uses market pricing. Ozment reformulated Schechter’s vul-
nerability markets as “bug auctions” and applied auction theory to
tune market structure [14]. In a position paper, Aspnes et al. state as
a key challenge that of obtaining quantitative answers to the scope
of Internet insecurity [4]. Aspnes et al. also state that “economics
provides a natural framework within which to deﬁne metrics for
systemic security.” The approach proposed in this paper hopes to
partially fulﬁll this goal.
7. CONCLUSION AND FUTURE WORK
Internet miscreants of all sorts have banded together and estab-
lished a bustling underground economy. This economy operates on
public IRC servers and actively ﬂaunts the laws of nations and the
rights of individuals. To elucidate the threat posed by this market,
we performed the ﬁrst systematic study including extensive mea-
surements of 7 months of data and the use of machine learning
techniques to label messages with their associated meanings.
To stimulate further research, we discussed how our measure-
ments might be applied to quantify the security of systems and to
estimate global trends that are difﬁcult to measure, such as changes
in the total number of compromised hosts on the Internet. Further,
we sketched efﬁcient, low-cost countermeasures which use prin-
ciples from economics to disrupt the market from within. These
countermeasures deviate signiﬁcantly from today’s use of law en-
forcement or technical approaches, which meet with substantial
costs.
The ready availability of market data for illegal activities begs a
number of interesting questions. For example, how does the mar-
ket respond to security-related incidents such as the discovery of an
exploit or the release of a patch? The use of economic event stud-
ies may enable us to better understand the true costs and beneﬁts
of deployed security technologies, data breeches, and new security
protocols.
In addition to studying effects, tracking underground
market indices may allow for accurate forecasting and predictions
of the future state of Internet security. We consider this study an
initial step towards the use of economic measurements of under-
ground markets to provide new directions and insights into the state
of information and Internet security.
8. ACKNOWLEDGEMENTS
This work would not have been possible without help from Team
Cymru, Alessando Acquisti, Paul Bennett, John Bethencourt, Gau-
rav Kataria, Chris Kanich, Leonid Kontorovich, Pratyusa K. Man-
adhata, Alan Montgomery, Amar Phanishayee, Srini Seshan, Jeff
Terrell, and Rob Thomas. We also wish to thank the anonymous
reviewers and numerous anonymous miscreants.
9. REFERENCES
[1] Email injection.
http://www.securephpwiki.com/index.php/Email Injection,
August 2007.
[2] George A. Akerlof. The Market for ’Lemons’: Quality
Uncertainty and the Market Mechanism. Quarterly Journal
of Economics, 84(3):488–500, 1970.
[3] Ross Anderson. Why Information Security is Hard - An
Economic Perspective. In 17th Annual Computer Security
Applications Conference, 2001.
[4] J. Aspnes, J. Feigenbaum, M. Mitzenmacher, and D. Parkes.
Towards better deﬁnitions and measures of internet security.
In Workshop on Large-Scale Network Security and
Deployment Obstacles, 2003.
[5] Paul N. Bennett and Jaime Carbonell. Feature Representation
for Effective Action-Item Detection. In ACM SIGIR Special
Interest Group on Information Retrival, 2005.
[6] Internet Crime Complaint Center. Internet crime report.
http://www.ic3.gov/media/annualreport/2006 IC3Report.pdf,
Jan. - Dec. 2006.
[7] John R. Douceur. The sybil attack. In Proceedings of the
IPTPS Workshop, 2002.
[8] Serge Egelman and Lorrie Faith Cranor. The Real ID Act:
Fixing Identity Documents with Duct Tape. I/S: A Journal of
Law and Policy for the Information Society, 2(1):149–183,
2006.
[9] Thorsten Joachims. Advances in Kernel Methods - Support
Vector Learning, Making Large-Scale SVM Learning
Practical. MIT-Press, 1999.
[10] Michael C. St. Johns. Identiﬁcation protocol. RFC 1413,
February 1993. http://tools.ietf.org/html/rfc1413.
[11] Hans P. Luhn. Computer for verifying numbers. U.S. Patent
2,950,048, August 1960.
[12] Charlie Miller. The legitimate vulnerability market: Inside
the secretive world of 0-day exploit sales. In Sixth Workshop
on the Economics of Information Security, May 2007.
[13] Jarkko Oikarinen and Darren Reed. Internet relay chat
protocol. RFC 1459, March 1993.
[14] Andy Ozment. Bug Auctions: Vulnerability Markets
Reconsidered. In Third Workshop on Economics and
Information Security, 2004.
[15] Stuart E. Schechter. Quantitatively Differentiating System
Security. In First Workshop on Economics and Information
Security, 2002.
[16] Stuart E. Schechter. Toward econometric models of the
security risk from remote attack. IEEE Security and Privacy,
03(1):40–44, 2005.
[17] United States Secret Service. United states secret service’s
operation rolling stone nets multiple arrests: Ongoing
undercover operation targets cyber fraudsters. Press Release,
March 2006.
[18] DeepSight Analyst Team. Online Fraud Communities and
Tools. Technical report, Symantec, January 2006.
[19] Rob Thomas and Jerry Martin. the underground economy:
priceless. USENIX ;login:, 31(6), December 2006.
[20] Yiming Yang and Xin Liu. A Re-examination of Text
Categorization Methods. In ACM SIGIR Special Interest
Group on Information Retrival, 1999.
[21] H. Yu, M. Kaminsky, P. B. Gibbons, and A. Flaxman.
Sybilguard: Defending against sybil attacks via social
networks. In Proceedings of ACM SIGCOMM, August 2006.