title:History-based access control for XML documents
author:Patrick R&quot;oder and
Omid Tafreschi and
Claudia Eckert
History-Based Access Control
for XML Documents
Dissertationsschrift
in englischer Sprache
vorgelegt
am Fachbereich Informatik
der Technischen Universit¨at Darmstadt von
Dipl.-Inform. Patrick R¨oder
geboren am 6.6.1978 in Singapur
zur Erlangung des akademischen Grades
Doktor-Ingenieur
– Dr.-Ing. –
Gutachter: Prof. Dr. Claudia Eckert
Prof. Dr. R¨udiger Grimm
Tag der Einreichung:
Tag der Disputation:
1. Oktober 2007
7. April 2008
Darmstadt 2008
Hochschulkennziﬀer D 17
ii
Kurzfassung (Deutsch)
In den letzten Jahren erfolgte ein Wandel von Dokumenten auf Papier zu elek-
tronischen Dokumenten, welche auf Computern verarbeitet werden. Neben
Vorteilen bringen elektronische Dokumente aber auch neue Risiken mit sich.
Sie lassen sich zum Beispiel einfacher stehlen und die Gefahr von absichtlicher
oder versehentlicher L¨oschung ist gr¨oßer als bei Dokumenten auf Papier. Um
diese Gefahren zu reduzieren wurde eine Reihe von technischen Maßnah-
men entwickelt. Zu diesen Maßnahmen geh¨ort auch die Zugriﬀskontrolle.
Bei der Zugriﬀskontrolle wird deﬁniert, wer unter welchen Umst¨anden auf
welche Daten zugreifen darf. Durch Zugriﬀskontrolle kann man die zuvor
beschriebenen Risiken reduzieren, indem man die erlaubten Zugriﬀe auf die
notwendigen beschr¨ankt.
Es gibt viele verschieden M¨oglichkeiten ein Zugriﬀskontrollsystem zu ge-
stalten. Die einzelnen M¨oglichkeiten unterscheiden sich unter anderem in der
Art der Daten, auf die der Zugriﬀ kontrolliert wird. Diese Arbeit behandelt
ein Verfahren f¨ur die Zugriﬀskontrolle auf XML-Dokumente, da XML ein
weit verbreiteter Standard f¨ur den Austausch von Daten geworden ist und
eine Reihe von technischen Vorteilen gegen¨uber anderen Formaten bietet.
Ein weiteres Unterscheidungskriterium ist, wie erlaubte oder verbotene
Zugriﬀe deﬁniert werden. Bei einfachen Verfahren muss dies f¨ur jedes Objekt
manuell deﬁniert werden. Aufw¨andigere Verfahren k¨onnen die Zugriﬀsrechte
aus den Eigenschaften der Objekte ableiten. Hierf¨ur wird in der Regel ihr
Dateninhalt herangezogen, aber nicht ihre Herkunft oder Entstehungsweise.
Diese Informationen werden in dieser Arbeit als “History” bezeichnet und
bei der Bearbeitung eines Dokumentes aufgezeichnet.
Mit Hilfe der History l¨asst sich der Schutzbedarf von Objekten pr¨aziser
deﬁnieren, da neben dem Dateninhalt auch die Art und Weise der Erstellung
herangezogen werden kann. Sind Objekte beispielsweise durch Kopieren ent-
standen, l¨asst sich der Ursprung der Kopie bei Deﬁnition der Zugriﬀsrechte
mit ber¨ucksichtigen. Ebenso kann in Betracht gezogen werden, wer ein Ob-
jekt erstellt hat, wann es erstellt wurde und welchen Inhalt es fr¨uher einmal
hatte. All diese zus¨atzlichen Eigenschaften erlauben es, die Zugriﬀsrechte
iii
iv
KURZFASSUNG (DEUTSCH)
f¨ur Objekte pr¨aziser zu speziﬁzieren, da diese Eigenschaften eine weitere Dif-
ferenzierung erm¨oglichen.
F¨ur diese Art von Zugriﬀskontrolle entwickelt die vorliegende Arbeit ein
Modell, eine Systemarchitektur sowie die ben¨otigten Sicherheitsmechanis-
men.
Abstract (English)
In the recent years, there was a development in which paper documents were
more and more replaced by electronic documents. As electronic documents
introduce several advantages, they also bring new risks. Electronic docu-
ments can be stolen more easily and its also happens easier that they are
deleted accidently.
Access control mechanisms were introduced, to reduce this risks, which
is achieved by restricting all accesses to the required ones. Many diﬀerent
solutions were developed to provide access control for diﬀerent types of stor-
ing data. Since XML is widely used and oﬀers many technical advantages,
we focus on access control for XML documents in this thesis.
Previous methods for access control deﬁned access for each object indi-
vidually and manually, which is error-prone and time-consuming. Advanced
approaches derive the access rights from the properties of an object. They
use the content of an object to derive the required level of protection and
ﬁnally its access rights. An essential property, which has not been regarded,
is how objects have been created. We refer to this as the “History” and
record it while a document is edited. This history allows us to derive the
access rights more precisely, since it adds a further way of diﬀerentiating
between objects. For example, it can be regarded from where an object was
copied, when it was created or by whom it was created. Furthermore, is the
previous content of a document can be regarded to deﬁne the access rights
of a documents.
In addition to our history-based access control model, we present a system
architecture for it and describe the security mechanisms for the architecture.
v
vi
ABSTRACT (ENGLISH)
Acknowledgements
First of all, I greatly thank my supervisor Prof. Dr. Claudia Eckert for giving
me the opportunity to do my research and for giving me all the freedom that
I need to do this. I acknowledge her for always being available when I needed
her advice. Moreover, she has created a relaxed atmosphere in our research
group, which makes researching very comfortable.
My colleagues at our research group “IT Security” provided both a pleas-
ant and stimulating working environment. We had a lot of fruitful discussions
and my colleagues were always available when I needed any kind of advice.
In particular, Omid Tafreschi helped me a lot and it was a great pleasure for
me to work in several projects together with him. Moreover, I would like to
thank Fredric Stumpf for a great time during our common research. I also
want to thank Sascha M¨uller and Christoph Kraus for being very pleasant
oﬃce mates.
I thank my parents Fridolin and Monika R¨oder and the rest of my family
for their great support during all the years of my academic and non-academic
life.
In addition to my family, my best friend Christoph M¨uller and my
girlfriend Heike Schmidt provided me with mental support that was very
helpful for me.
Last but not least, I thank the DFG (“Deutsche Forschungsgemeinschaft”)
who ﬁnanced my work within the PhD program Enabling Technologies for
Electronic Commerce. Due to their support, I was able to concentrate very
focussed on my research.
vii
viii
ABSTRACT (ENGLISH)
Wissenschaftlicher Werdegang
6.6.1978 Geburt in Singapur
1985 - 1989 Besuch der Grundschule “Deutsche Botschaftsschule” in Kuwait
1989 - 1998 Abitur am Gymnasium “Lichtenbergschule” in Darmstadt
1999 - 2004 Informatikstudium an der Technischen Universit¨at Darmstadt
2004 - 2008 Promotion in Informatik an der Technischen Universit¨at Darmstadt
ix
x
ABSTRACT (ENGLISH)
Declaration
These doctoral studies were conducted under the supervision of Prof. Dr.
Claudia Eckert. The work presented in this thesis is the result of original
research carried out by myself, in collaboration with others, whilst enrolled in
the Department of Computer Science as a candidate for the degree of Doctor
of Philosophy. This work has not been submitted for any other degree or
award in any other university or educational establishment.
Darmstadt, April 12, 2008
xii
ABSTRACT (ENGLISH)
Contents
Kurzfassung (Deutsch)
Abstract (English)
List of Figures
List of Tables
List of Algorithms
1 Introduction
1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Structure of this Thesis . . . . . . . . . . . . . . . . . . . . . .
iii
v
xvii
xix
xx
1
1
8
2 Background
2.1 Access Control
11
. . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.1.1 Access Matrix Model . . . . . . . . . . . . . . . . . . . 14
2.1.2 Role-Based Access Control (RBAC) . . . . . . . . . . . 15
2.1.3 Chinese Wall model . . . . . . . . . . . . . . . . . . . . 18
2.2 The Extensible Markup Language . . . . . . . . . . . . . . . . 21
2.2.1
Introduction to XML . . . . . . . . . . . . . . . . . . . 21
2.2.2 XML Documents . . . . . . . . . . . . . . . . . . . . . 22
2.2.3 XML Namespaces . . . . . . . . . . . . . . . . . . . . . 23
2.2.4 XML Schema . . . . . . . . . . . . . . . . . . . . . . . 24
2.2.5 XML Path Language (XPath) . . . . . . . . . . . . . . 25
2.3 Trusted Computing Group Mechanisms . . . . . . . . . . . . . 26
2.3.1 Remote Attestation . . . . . . . . . . . . . . . . . . . . 28
2.3.2
. . . . . . . . . . . . . . 28
Integrity Reporting Protocols
3 Scenario and Requirements
31
3.1 Scenario . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
3.2 Requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
xiii
xiv
CONTENTS
4 Model
41
4.1 Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.2 Subjects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
4.3 Objects
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
4.3.1 XML elements . . . . . . . . . . . . . . . . . . . . . . . 42
4.3.2 Attributes . . . . . . . . . . . . . . . . . . . . . . . . . 43
4.3.3 Text blocks
. . . . . . . . . . . . . . . . . . . . . . . . 43
4.4 Operations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
4.4.1 Create . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
4.4.2 Delete . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
4.4.3 Copy . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
4.4.4 Change Attribute . . . . . . . . . . . . . . . . . . . . . 47
4.4.5 View . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
4.5 History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
4.6 Access Control Rules . . . . . . . . . . . . . . . . . . . . . . . 50
4.6.1 Role ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . 50
4.6.2 Operation ﬁeld . . . . . . . . . . . . . . . . . . . . . . 51
4.6.3 Object ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . 51
4.6.4 Destination ﬁeld . . . . . . . . . . . . . . . . . . . . . 51
4.6.5 Mode ﬁeld . . . . . . . . . . . . . . . . . . . . . . . . . 52
4.6.6 Conﬂict resolution strategy . . . . . . . . . . . . . . . 52
4.6.7 Default semantics . . . . . . . . . . . . . . . . . . . . . 52
4.7 Accessing the History with XPath . . . . . . . . . . . . . . . . 53
4.7.1 Getting Copies of an Object . . . . . . . . . . . . . . . 53
4.7.2 Getting Related Nodes Depending on Time
. . . . . . 55
4.7.3 Getting the Context of a History Entry . . . . . . . . . 56
4.7.4 Getting Accessed Nodes
. . . . . . . . . . . . . . . . . 57
4.7.5 Getting Speciﬁc Nodes of Current Rule . . . . . . . . . 57
4.7.6 Additional Extension Functions . . . . . . . . . . . . . 58
4.8 Modeling Chinese Wall policies
. . . . . . . . . . . . . . . . . 58
4.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
5 System Architecture
65
5.1 Architecture Overview . . . . . . . . . . . . . . . . . . . . . . 66
5.2 Workﬂow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
5.2.1 Check-out . . . . . . . . . . . . . . . . . . . . . . . . . 68
5.2.2 Editing . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
5.2.3 Check-in . . . . . . . . . . . . . . . . . . . . . . . . . . 74
5.3 Distributed System Architecture . . . . . . . . . . . . . . . . . 75
5.3.1 Overall Approach . . . . . . . . . . . . . . . . . . . . . 76
5.3.2 Client-Server Approach . . . . . . . . . . . . . . . . . . 78
CONTENTS
xv
5.3.3 The scalability of the distributed system architecture . 85
6 Security Architecture
87
6.1 Risk Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
6.1.1 Attacks on the Client Machine . . . . . . . . . . . . . . 89
6.1.2 Attacks on the Server . . . . . . . . . . . . . . . . . . . 92
6.1.3 Requirements for the Security Architecture . . . . . . . 94
6.2 Security Mechanisms . . . . . . . . . . . . . . . . . . . . . . . 95
6.2.1 Protection Layer 4: TPM and Hardware . . . . . . . . 97
6.2.2 Protection Layer 3: Hypervisor and Management VM . 97
6.2.3 Protection Layer 2: Open VM and Trusted VM . . . . 98
6.2.4 Protection Layer 1: User interface . . . . . . . . . . . . 99
6.2.5 Attestation Protocol
. . . . . . . . . . . . . . . . . . . 99
6.3 Evaluation of the Security Mechanisms . . . . . . . . . . . . . 101
7 Implementation
103
7.1 History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
7.2 Components . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
7.2.1 User Interface . . . . . . . . . . . . . . . . . . . . . . . 106
7.2.2 Copy DB . . . . . . . . . . . . . . . . . . . . . . . . . 108
7.2.3 Rule DB . . . . . . . . . . . . . . . . . . . . . . . . . . 109
7.2.4 Policy Enforcement Point
. . . . . . . . . . . . . . . . 109
7.2.5 Policy Decision Point . . . . . . . . . . . . . . . . . . . 110
7.3 Conﬁguration . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
7.4 Performance Evaluation . . . . . . . . . . . . . . . . . . . . . 110
7.4.1 Performance of Individual Functions
. . . . . . . . . . 112
7.4.2 Performance of the Creation of Views . . . . . . . . . . 114
8 Related Work
8.1 Server-side Access Control
115
. . . . . . . . . . . . . . . . . . . . 116
8.2 Client-side Access Control
“Secure and Selective Dissemination of XML Docu-
ments” . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
“X-GTRBAC: An XML-Based Policy Speciﬁcation Frame-
work and Architecture for Enterprise-Wide Access Con-
trol” . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
. . . . . . . . . . . . . . . . . . . . 118
. . . . . . . . . . . . . . . 118
. . . . . . . . 119
Integrity Reporting . . . . . . . . . . . . . . . . . . . . 119
8.3 Usage Control . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
“Relevancy-based Access Control” . . . . . . . . . . . . 121
8.2.1 Digital Rights Management
8.2.2 Detecting a Compromised System State
8.2.3
8.1.1
8.1.2
8.3.1
xvi
CONTENTS
8.3.2
“Controlling Access to Documents: A Formal Access