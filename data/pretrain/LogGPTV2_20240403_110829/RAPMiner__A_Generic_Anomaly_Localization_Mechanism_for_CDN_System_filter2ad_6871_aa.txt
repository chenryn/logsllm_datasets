title:RAPMiner: A Generic Anomaly Localization Mechanism for CDN System
with Multi-dimensional KPIs
author:Chang Liu and
Yanwei Liu and
Zhen Xu and
Liang Dai
1
4
0
0
0
.
2
2
0
2
.
5
0
4
3
5
N
S
D
/
9
0
1
1
.
0
1
:
I
O
D
|
E
E
E
I
2
2
0
2
©
0
0
.
1
3
$
/
2
2
/
1
-
3
9
6
1
-
4
5
6
6
-
1
-
8
7
9
|
)
N
S
D
(
s
k
r
o
w
t
e
N
d
n
a
s
m
e
t
s
y
S
e
l
b
a
d
n
e
p
e
D
n
o
e
c
n
e
r
e
f
n
o
C
l
a
n
o
i
t
a
n
r
e
t
n
I
P
I
F
I
/
E
E
E
I
l
a
u
n
n
A
d
n
2
5
2
2
0
2
2022 52nd Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN)
RAPMiner: A Generic Anomaly Localization
Mechanism for CDN System with
Multi-dimensional KPIs
Chang Liu†(cid:2), Yanwei Liu†∗, Zhen Xu†, Liang Dai†(cid:2)
†Institute of Information Engineering, Chinese Academy of Sciences, Beijing, China
(cid:2)School of Cyber Security, University of Chinese Academy of Sciences, Beijing, China
Abstract—As essential work in IT operations, anomaly lo-
calization, aiming to identify the affected scope of Internet
infrastructure once an anomaly alarm occurs,
is challenging
due to the huge search space. The existing solutions usually
show limited performances in the CDN scenario since they take
the desirable assumptions that do not match with the practical
anomaly pattern features. To address this issue, in this paper, we
propose RAPMiner, which ﬁrst uses a classiﬁcation power-based
redundant attribute deletion to prune the non-root cause attribute
combinations, and then adopts an anomaly conﬁdence-guided
layer-by-layer top-down search to avoid searching for anomaly
but non-root patterns. Both of them are effective in narrowing
the search space. Experimental results show that RAPMiner can
achieve comparable performance with the SOTA approach on the
published Squeeze dataset according to F1-score and efﬁciency,
as well as the best RC@k with stable parameter sensitivity on
the RAPMD.
Index Terms—Anomaly localization, root anomaly pattern
(RAP), cuboid, attribute combination
I. INTRODUCTION
Due to the increasing complexity and growing scale of
today’s Internet infrastructures, failure on devices and service
degradation are inevitable. To detect these failures and con-
duct service quality management, human operators measure
and monitor various Key Performance Indicators (KPIs) [1]–
[7]. Once an anomaly alarm occurs, it usually indicates the
potential failure or service degradation for the system or Inter-
net infrastructure, e.g., conﬁguration errors, software defects,
network and server machine overload or failures, etc., [1], [8]–
[17]. To rapidly respond to these issues before they cause more
critical performance degradation and guarantee the quality of
experience (QoE) for users, anomaly localization is further
needed in IT operations, i.e., to identify the affected scope of
the speciﬁc system or infrastructure when it is triggered by
an anomaly alarm and then switch the impacted users to the
backup system timely.
As one of the most critical Internet infrastructures, Content
Delivery Networks (CDNs) play a crucial role in delivering
Internet content and guaranteeing high QoE [18]–[20]. With
the growing scale, edge nodes of today’s commercial CDN
usually sink to districts or counties, providing services for
hundreds or even thousands of websites in delivering content
∗Yanwei Liu is the corresponding author
Back-haul 
Link
Content 
Depository
L1
Wireless
Site1
Failure/
Success
Front-haul Link
Traffic 
Switching
(cid:1)
L2
Fixed
Site1/
Site2
Failure/
Success
Edge Sites
Location Access 
type
OS Website Service
status
Fig. 1.
IT operations in CDN Infrastructure
for various users. It
is a great challenge to conduct IT
operations for such a large distributed Internet infrastructure.
The pioneering study [1] only focuses on anomaly detection
for CDN to give an alarm, however, lacks anomaly localization
to help identify the affected scope of the failure and provide
human operators some clues for further trouble-shooting or
root cause analysis. Via discussing with human operators,
we are aware that the anomaly localization for the current
CDN system mainly relies on manual work, i.e., mining the
clues from massive data manually which is a very complex
and time-consuming process. In this context, the need for an
automatic method that conducts anomaly localization for CDN
effectively and efﬁciently is urgent.
To this end, we start our work with a careful analysis of a
real-world ISP-operated CDN in China. As shown in Fig. 1
right, users that are served by CDN can be characterized by a
four-tuple or called attribute combination, i.e., the location of
edge node, access type, operating system (OS) of the device,
and the website that
the user surfs. In practice, anomaly
localization usually depends on KPIs with varying-grained
attribute combinations. KPI for a ﬁne-grained attribute com-
bination usually indicates the performance or service status
of the more speciﬁc scope generally, e.g., KPI for a four-
tuple (L1, wireless, Android, Site1) represents the performance
of “Android” users that
the contents from
“Site1” and are served by the edge nodes at location “L1” via
“wireless” network. While KPI for a coarse-grained attribute
combination, e.g., (L1, *, *, Site1) indicates the service status
of the users that request content from “Site1” and are served
by the edge nodes at location “L1”, regardless of the OS for
try to request
2158-3927/22/$31.00 ©2022 IEEE
DOI 10.1109/DSN53405.2022.00041
319
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:17:38 UTC from IEEE Xplore.  Restrictions apply. 
TABLE I
ATTRIBUTES OF CDN SYSTEM
Location (33)
L1
L2
...
Access Type (4)
Wireless
Fixed
...
OS (4) Website (20)
Android
IOS
...
Site1
Site2
...
device and access type. The goal of anomaly localization is
to ﬁnd the attribute combination with the coarsest granularity
among all of the attribute combinations whose KPIs present
anomalous. Some studies call such attribute combination the
root cause of the anomaly [21], [22] with its being the parent
of all other attribute combinations with anomalous KPIs, or
an effective combination of the emerging issue [14]. In this
paper, we call it Root Anomaly Pattern (RAP). In the above
example, comparing with (L1, wireless, Android, Site1), (L1,
*, *, Site1) is more likely the RAP, since it describes more
general characteristics among the affected scope.
Even though the existing studies have focused on mining
root anomaly patterns for various Internet infrastructures or
applications, however, the careful analysis still underscores
the following two main challenges of mining root anomaly
patterns for the real-world CDN.
Challenge 1: Huge Search Space. Table I shows some
elements in each attribute for the real-world CDN that we
studied, e.g., there are 33 speciﬁc elements in the attribute
named “Location”. Since the search space usually increases
exponentially with the number of attributes and attribute
elements as illustrated in [21], the search space in the CDN
scenario will be up to 220×33×4×4. Consequently, such a
huge space is a big challenge in designing an automatic
algorithm to solve the infeasibility of manual localization of
root anomaly patterns. The existing studies usually narrow
the search space through some highly strict assumptions.
For example, Adtributor [13] assumes that the root anomaly
pattern is only a 1-dimensional attribute combination, and
HotSpot [21] assumes that all of the root anomaly patterns
are only located in a single cuboid. Both Squeeze [22] and
HotSpot [21] assume the same anomaly magnitude for all
attribute combinations under the same failure, i.e., the same
relative deviation between the predicted value and the actual
value of KPI. Besides, Squeeze also assumes varying anomaly
magnitude for attribute combinations under different failures
to combine clustering with searching. However, the careful
analysis of the real-world ISP-operated CDN suggests that
assumptions in existing methods are more desirable which
limit their usefulness in the real-world CDN.
Challenge 2: Determination Rule for RAP. Obviously, the
root anomaly patterns should exhibit the speciﬁc features that
are apart from the non-root anomaly patterns. The challenge
lies in how to characterize or describe such differences be-
tween the root and non-root anomaly patterns, i.e., how to
determine the root anomaly patterns via a determination rule.
Existing studies usually try to solve this issue by introducing
the corresponding quantitative metrics for the speciﬁc scenar-
ios. For example, HotSpot [21] introduces the ripple effect to
characterize the magnitude relationship between the root cause
attribute combinations and its “descendant” attribute combina-
tions. Squeeze [22] further proposes a generic one, i.e., the
generalized ripple effect for both fundamental and derived
KPIs. Besides, iDice [14] identiﬁes the effective combination
via a metric called “Isolation Power”, etc. Even though these
quantitative metrics show effectiveness, however, some of
them depend on the speciﬁc scenarios with corresponding
assumptions. Hence, a proper determination rule is necessary
for root anomaly patterns of the real-world CDN.
To cope with the limitations of previous work in tackling
the two challenges above, in this paper, we propose a Root
Anomaly Pattern Miner (RAPMiner), which considers the
practical distribution features of root anomaly patterns to avoid
the ideal assumptions, so as to be more practical without loss
of effectiveness and efﬁciency. Speciﬁcally, RAPMiner ﬁrst
proposes a metric called Classiﬁcation Power (CP) to deter-
mine whether an attribute is independent of a root anomaly
pattern, and then combines it with the other metric called
Anomaly Conﬁdence (AC), which judges whether an attribute
combination is anomalous or not, thus to address the second
challenge above. Accordingly, RAPMiner solves the problem