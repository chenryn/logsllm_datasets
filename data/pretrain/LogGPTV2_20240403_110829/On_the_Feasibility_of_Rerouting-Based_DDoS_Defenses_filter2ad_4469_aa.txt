title:On the Feasibility of Rerouting-Based DDoS Defenses
author:Muoi Tran and
Min Suk Kang and
Hsu-Chun Hsiao and
Wei-Hsuan Chiang and
Shu-Po Tung and
Yu-Su Wang
(cid:19)(cid:17)(cid:18)(cid:26)(cid:1)(cid:42)(cid:38)(cid:38)(cid:38)(cid:1)(cid:52)(cid:90)(cid:78)(cid:81)(cid:80)(cid:84)(cid:74)(cid:86)(cid:78)(cid:1)(cid:80)(cid:79)(cid:1)(cid:52)(cid:70)(cid:68)(cid:86)(cid:83)(cid:74)(cid:85)(cid:90)(cid:1)(cid:66)(cid:79)(cid:69)(cid:1)(cid:49)(cid:83)(cid:74)(cid:87)(cid:66)(cid:68)(cid:90)
On the Feasibility of Rerouting-based DDoS Defenses
Muoi Tran
‚àó
‚Ä†
, Yu-Su Wang
‚Ä†
, Min Suk Kang
, Shu-Po Tung
National University of Singapore, {muoitran, kangms}@comp.nus.edu.sg
‚àó
‚àó
‚Ä†
, Hsu-Chun Hsiao
‚Ä†
, Wei-Hsuan Chiang
‚Ä†
National Taiwan University, {hchsiao, b04902077, b04902003, b04902014}@csie.ntu.edu.tw
Abstract‚ÄîLarge botnet-based Ô¨Çooding attacks have recently
demonstrated unprecedented damage. However, the best-known
end-to-end availability guarantees against Ô¨Çooding attacks re-
quire costly global-scale coordination among autonomous systems
(ASes). A recent proposal called routing around congestion (or
RAC) attempts to offer strong end-to-end availability to a selected
critical Ô¨Çow by dynamically rerouting it to an uncongested detour
path without requiring any inter-AS coordination.
This paper presents an in-depth analysis of the (in)feasibility
of the RAC defense and points out that its rerouting approach,
though intriguing, cannot possibly solve the challenging Ô¨Çooding
problem. An effective RAC solution should Ô¨Ånd an inter-domain
detour path for its critical Ô¨Çow with the two following desired
properties: (1) it guarantees the establishment of an arbitrary
detour path of its choice, and (2) it isolates the established detour
path from non-critical Ô¨Çows so that the path is used exclusively
for its critical Ô¨Çow. However, we show a fundamental trade-off
between the two desired properties, and as a result, only one of
them can be achieved but not both. Worse yet, we show that
failing to achieve either of the two properties makes the RAC
defense not just ineffective but nearly unusable. When the newly
established detour path is not isolated, a new adaptive adversary
can detect it in real time and immediately congest the path,
defeating the goals of the RAC defense. Conversely, when the
establishment of an arbitrary detour path is not guaranteed, more
than 80% of critical Ô¨Çows we test have only a small number (e.g.,
three or less) of detour paths that can actually be established and
disjoint from each other, which signiÔ¨Åcantly restricts the available
options for the reliable RAC operation.
The Ô¨Årst lesson of this study is that BGP-based rerouting
solutions in the current inter-domain infrastructure seem to be
impractical due to implicit assumptions (e.g., the invisibility of
poisoning messages) that are unattainable in BGP‚Äôs current prac-
tice. Second, we learn that the analysis of protocol speciÔ¨Åcations
alone is insufÔ¨Åcient for the feasibility study of any new defense
proposal and, thus, additional rigorous security analysis and
various network evaluations,
including real-world testing, are
required. Finally, our Ô¨Åndings in this paper agree well with the
conclusion of the major literature about end-to-end guarantees;
that is, strong end-to-end availability should be a security feature
of the Internet routing by design, not an ad hoc feature obtained
via exploiting current routing protocols.
I.
INTRODUCTION
Botnet-driven Distributed Denial-of-Service (DDoS) at-
tacks have been plaguing critical Internet services, Ô¨Çooding
end hosts and services with volumetric attack trafÔ¨Åc. A more
sophisticated type of DDoS attack, called transit-link Ô¨Çooding,
which targets the Internet‚Äôs core connectivity infrastructure,
has been recently discussed in academia [53], [32] and quickly
moved to real-world incidents [18], [27]. Transit-link Ô¨Çooding
attacks utilize botnet to generate low-rate Ô¨Çows between pairs
of bots [53] or toward public services [32] such that all of
these Ô¨Çows cross a given set of network links, degrading the
connectivity for all services using these network links.
The best-known solution that offers strong service guaran-
tees to a selected critical Ô¨Çow (e.g., a connection for mission-
critical infrastructure or premium users) under Ô¨Çooding attacks
is bandwidth isolation mechanisms [30], [17]. They guar-
antee high bandwidth availability regardless of attack sizes
(e.g., botnet trafÔ¨Åc volume) by allocating dedicated end-to-
end bandwidth for critical Ô¨Çows. However, all bandwidth
isolation proposals require global coordination between all the
autonomous systems (ASes) on the end-to-end path for band-
width reservation and Ô¨Åltering. Considering the current highly
competitive inter-domain transit market, where no global-scale
ISP collaboration exists, deploying such bandwidth isolation
solutions seems challenging.
Recently, the ‚Äúrouting around congestion‚Äù (or RAC) de-
fense [51] has been proposed as an alternative solution against
server and transit-link Ô¨Çooding attacks. The RAC defense
offers path isolation for any critical inbound Ô¨Çow of a victim
network by dynamically creating a detour path exclusively for
the critical Ô¨Çow. The beauty of the RAC defense is in its
immediate deployability in the current Internet without any
modiÔ¨Åcation of the Internet infrastructure because it only relies
on a well-known BGP inbound route-control mechanism [33]
that requires no coordination between ASes.
In this paper, we perform an in-depth analysis of the
(in)feasibility of the RAC defense based on actual Inter-
net topology, business relationship, and public routing data.
Through our analysis, we point out that the rerouting approach,
though intriguing, cannot possibly solve the challenging Ô¨Çood-
ing problem. We show a fundamental trade-off between two
highly desirable properties of the RAC defense. An effective
RAC defense should (1) guarantee the establishment of a
detour path of its choice so that it can reroute the selected
critical Ô¨Çow when experiencing congestion, and (2) isolate
the obtained detour path from non-critical Ô¨Çows so that it is
used only for the selected critical Ô¨Çow. The discovered trade-
off between the two properties, unfortunately, shows that in
the current Internet, the RAC defense can achieve either the
isolated detour paths or the guaranteed establishment of detour
paths but not both. Achieving the instant, highly available
detour paths via the RAC defense, therefore, appears to be
infeasible.
Worse yet, we show that failing to achieve either of the
two properties makes the RAC defense not only less effective
but nearly unusable in practice. On one hand, we show that
the lack of complete path isolation signiÔ¨Åcantly limits the
bandwidth availability of the detour path because many non-
critical Ô¨Çows end up sharing it with the critical Ô¨Çow. Perhaps
more importantly,
the lack of path isolation also enables
a new adaptive attack, called a detour-learning attack, that
accurately identiÔ¨Åes every detour path establishment in real
time. After learning the newly established detour path, the
(cid:165)(cid:1)(cid:19)(cid:17)(cid:18)(cid:26)(cid:13)(cid:1)(cid:46)(cid:86)(cid:80)(cid:74)(cid:1)(cid:53)(cid:83)(cid:66)(cid:79)(cid:15)(cid:1)(cid:54)(cid:79)(cid:69)(cid:70)(cid:83)(cid:1)(cid:77)(cid:74)(cid:68)(cid:70)(cid:79)(cid:84)(cid:70)(cid:1)(cid:85)(cid:80)(cid:1)(cid:42)(cid:38)(cid:38)(cid:38)(cid:15)
(cid:37)(cid:48)(cid:42)(cid:1)(cid:18)(cid:17)(cid:15)(cid:18)(cid:18)(cid:17)(cid:26)(cid:16)(cid:52)(cid:49)(cid:15)(cid:19)(cid:17)(cid:18)(cid:26)(cid:15)(cid:17)(cid:17)(cid:17)(cid:22)(cid:22)
(cid:18)(cid:18)(cid:23)(cid:26)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:53:09 UTC from IEEE Xplore.  Restrictions apply. 
adaptive adversary can immediately congest the new detour
path by Ô¨Çooding one of its transit links. Unfortunately, the
RAC defense cannot react to such adaptive Ô¨Çooding attacks
quickly enough due to the undesirable long delays (e.g., 85
seconds even with a small size network of 1,000 ASes) in
switching to another detour path.
On the other hand, we show that when the establishment
of an arbitrary detour path is not guaranteed, it is extremely
challenging to operate the RAC defense reliably because the
majority (e.g., 80%) of critical Ô¨Çows we test have only small
numbers (e.g.,
three or less) of disjoint detour paths that
can actually be established. Note that the fact that a detour
path can be established does not mean that it would have
enough bandwidth to serve the critical Ô¨Çow; thus, the more
the establishable disjoint detour paths are available, the more
reliable RAC operation can be achieved.
The main goal of our paper is to draw some practical
conclusions about the very challenging server/link Ô¨Çooding
problem. The analysis of the RAC proposal has led us to
learn some useful lessons. A crucial methodological lesson is
that, when analyzing the feasibility of a rerouting-based DDoS
defense proposal, it is not enough to evaluate the functional
feasibility of the proposal based on the protocol speciÔ¨Åcations.
Even if the speciÔ¨Åcation [49] allows BGP messages with exces-
sively long AS path within the theoretical limit (i.e., 2,034), the
actual network operation communities (e.g., NANOG) publicly
condemn the practice of broadcasting unnecessarily long (e.g.,
AS path longer than 75) BGP messages and strongly suggest
Ô¨Åltering them [29], [38]. It is also well-known that certain
Cisco routers, by default, Ô¨Ålter BGP messages with AS path
longer than 254 [46]. Therefore, the analysis of BGP-routing-
based DDoS proposals must be founded on thorough feasibility
checks with real-world feasibility tests, acceptance by network
operation communities, and various large-scale simulations.
Our work reconÔ¨Årms the previous conclusion of multiple
independent projects [17], [31], [30], [26]; that is, defending
against transit-link Ô¨Çooding attacks requires path or bandwidth
isolation that is achievable only through large-scale coordina-
tion among many ASes. We hope that our study will renew the
discussion of new, clean-slate Internet architectures that enable
such inter-domain coordination for highly available Internet
services.
Organization. We review the routing around congestion
(RAC) defense along with the summary of transit-link Ô¨Çooding
attacks in Section II. We present two desired goals of the
RAC defense, namely, path isolation and guaranteed detour
establishment in Section III, and subsequently highlight the
fundamental trade-off between these two in Section IV. In
the consequence of lack of path
Section V, we highlight
isolation with a new metric called path leakage, and,
in
Section VI, we demonstrate a new adaptive attack that can
exploit even a small amount of path leakage to defeat the RAC
defense. In Section VII, we demonstrate how hard it is to Ô¨Ånd
a detour path for the majority of critical Ô¨Çows when the detour-
path establishment is not guaranteed. We also investigate the
required effort to make the RAC defense possible in the current
Internet in Section VIII. Finally, we conclude our paper in
Section IX.













	

Figure 1: A RAC defense example against a botnet-based
transit-link Ô¨Çooding attack.
II. BACKGROUND AND RELATED WORK
DDoS defenses have been extensively studied over the past
two decades [40], [58], [59], [45], [23], [35], [39]; refer to the
following articles [44], [60] for more comprehensive surveys.
A. Transit-Link Flooding Attacks
In last few years, transit-link Ô¨Çooding DDoS attacks have
been proposed and demonstrated substantial damage to the
core of the Internet (e.g., backbone links in large ISPs or
inter-ISP links) [53], [32]. Transit-link Ô¨Çooding attacks have
been further studied to achieve more efÔ¨Åcient botnet resource
usage [48] or distributed botnet coordination [34].
Figure 1 shows how a transit-link Ô¨Çooding attack creates
a large number of attack Ô¨Çows and congests a targeted transit
link. The adversary controls her bots to send trafÔ¨Åc through the
link (W ‚ÄìZ), making all other Ô¨Çows crossing the targeted link
experience congestion. The critical Ô¨Çow (see the blue dashed
lines in Figure 1) from the critical AS C (i.e., the source
of the critical trafÔ¨Åc) to the destination AS D also traverses
the congested link. This is in sharp contrast to traditional
server-Ô¨Çooding attacks that aim to choke the resources (e.g.,
computation, memory, or access link bandwidth) of the end
target (e.g., the destination AS D in Figure 1).
Transit-link Ô¨Çooding attacks have two speciÔ¨Åc character-
istics that make them exceedingly effective at scale while
rendering traditional defense mechanisms irrelevant. First, they
attack targets indirectly. As the locus of attack is different from
the targeted end servers, they cannot be easily detected by
intrusion-detection systems and Ô¨Årewalls at the end servers.
Second, these attacks use protocol-conforming trafÔ¨Åc Ô¨Çows
that are indistinguishable from legitimate Ô¨Çows, thereby caus-
ing high collateral damage when Ô¨Çows are simply dropped to
relieve congestion.
End-to-end bandwidth guarantee. A line of research that
aims to achieve strong availability guarantees against transit-
link Ô¨Çooding attacks have offered the bandwidth isolation
mechanism. These proposals isolate attack trafÔ¨Åc by the end-
to-end bandwidth reservation and enforcement, thereby provid-
ing guaranteed bandwidth for critical Ô¨Çows; e.g., STRIDE [30],
SIBRA [17]. A critical Ô¨Çow can be protected by SIBRA and its
share of guaranteed bandwidth does not diminish even when
the number of bots outside the critical and destination ASes
increases.
Other partial solutions. Several defense mechanisms have
been proposed to partially mitigate the link-Ô¨Çooding prob-
lem. SPIFFY [31] is a single-domain Ô¨Çow-testing solution
(cid:18)(cid:18)(cid:24)(cid:17)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:53:09 UTC from IEEE Xplore.  Restrictions apply. 















	

	

)
r
u
o
h
r
e
p
(
s
n
r
e
t
t
a
p
i
g
n
n
o
s
o
p
i
e
u
q
n
u
i
f
o
r
e
b
m
u
N
1000
800
600
400
200
0
Jun 01
Jun 02
Jun 03
Jun 04
Jun 05
Jun 06
Jun 07
Jun 08
Jun 09
Jun 10
Jun 11
Jun 12
Jun 13
Jun 14
Jun 15
Jun 16
Jun 17
Jun 18
Jun 19
Jun 20
Jun 21
Jun 22
Jun 23
Jun 24
Jun 25
Jun 26
Jun 27
Jun 28
Jun 29
Jun 30
Figure 3: Number of unique BGP poisoning messages per hour
from June 1, 2018 to June 30, 2018.
Figure 2: An example of how AS D uses BGP poisoning to
poison AS W and establishes a detour path {C, X, Y, Z, D}.
Table I: List of Top-10 ASes that had generated most poisoning
patterns in June 2018.
that deters rational
link-Ô¨Çooding adversaries. NetHide [43]
can be applied to some ASes that wish to hide its internal
network topology to arbitrary adversaries, thus rendering attack
reconnaissance difÔ¨Åcult. CoDef [36] suggests an inter-domain
collaboration protocol
link-Ô¨Çooding Ô¨Çows.
LinkScope [57] attempts to detect link-Ô¨Çooding attacks quickly
with its new inter-domain protocols. RADAR [61] shows that
software-deÔ¨Åned networking (SDN) can be used to rate limit