(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35) (cid:35) (cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(HMO)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(HHO)
(cid:35)
(cid:35)
(cid:35)
HHO, HMC
HHO
HHO, HMC
HHO
HHO, HMC
HHO
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
Table 5: CPDoS vulnerability overview
HHO, HMC
HMC
HHO
(HHO), (HMC)
HMC
(HHO), (HMC)
HMC
HMO, (HHO), (HMC)
HMC
(HHO), (HMC)
HMC
HHO, HMO
HHO, HMC
(HHO), (HMC)
HHO
(HHO), (HMC)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(HHO)
HMO
Apache HTTPD + (ModSecurity)
Apache TS
Nginx + (ModSecurity)
IIS
Tomcat
Squid
Varnish
Amazon S3
Google Cloud Storage
Github Pages
Gitlab Pages
Heroku
ASP.NET
BeeGo
Django
Express.js
Flask
Gin
Laravel
Meteor.js
Play 1
Play 2
Rails
Spring Boot
Symfony
(HHO)
(HHO)
(HHO)
(HHO)
(HHO)
(HHO)
(HHO)
(HHO)
HMO
HMO
HMO
HMO
Top 500 websites. In addition to this, we used the Google Big Query
service to investigate over 365 million URLs stored in the HTTP
Archive data set httparchive.summary_requests.2018_12_15_-
desktop. Table 6 shows the number of websites and URLs of the
DoD, the Alexa Top 500 and the HTTP Archive where the response
header indicates that the content is processed by a vulnerable HTTP
implementation.
Total number of web sites/URLs
Varnish
Akamai
CDN77
Cloudflare
CloudFront
Fastly
IIS
Flask
Play 1
DoD
414
2
2
0
7
8
0
27
0
0
Alexa Top 500
500
40
38
0
34
23
9
9
0
0
HTTP Archive
365.112.768
4.658.950
1.031.535
321.456
18.236.800
12.140.461
4.013.578
17.792.692
5.765
10.491
Table 6: Number of websites/URLs using Varnish, Akamai,
CDN77, Cloudflare, CloudFront, Fastly, IIS, Flask and Play 1
The results highlight that eight websites of the DoD, 23 of the
Alexa Top 500 and over twelve million URLs stored in the men-
tioned data set of the HTTP Archive are served via CloudFront.
Moreover, all eight websites of the DoD, 16 websites of the Alexa
Top 500 and over nine million URLs of the HTTP Archive point out
that CloudFront in combination with Apache HTTPD, Nginx, Ama-
zon S3, Microsoft IIS and Varnish is used. Our experiments revealed
that these constellations are vulnerable to CPDoS attacks (see Ta-
ble 5). However, it is very difficult to estimate the exact number
of vulnerable websites without inspecting each of them individu-
ally. Moreover, the experiments have been done with the default
configuration and without taking any other intermediate system
into account. It is, however, very common that content providers
10
change the default configuration of a cache in order to adapt the
caching policy to the respective needs. Moreover, real world web
applications also utilize other intermediate systems such as load
balancers or WAFs. All these settings influence the practicability of
CPDoS attacks in any direction. To get a clearer picture on the real
life impact of CPDoS attacks, we took some samples based on the
URLs from the Alexa Top 500, DoD, and HTTP Archive data sets.
Overall, we found twelve vulnerable resources within a few days.
These also include mission-critical websites such as ethereum.org,
marines.com, and nasa.gov which use CloudFront as CDN. At all
these websites, we were able to block multiple resources including
scripts, style sheets, images, and even dynamic content such as the
start page. The visual damage of a CPDoS attack is shown by the
Figures 6 and 7 in the Appendix A. In Figure 6, the CPDoS attack is
first applied to an image referenced in the start page of the victim
website ethereum.org. Then the style sheet file is denied and finally,
an error page replaces the whole start page. Figure 7 illustrates the
affected start page of marines.com which displays an error page to
the user instead of the genuine content. Moreover, we were also
able to conduct a successful CPDoS attack on the update files of
IKEAâ€™s Smart Home devices. IKEA uses CloudFront in conjunction
with S3 to distribute remote control firmware and driver updates
for their wireless bulbs. As CloudFront in combination with S3 is
vulnerable to HHO CPDoS attacks, an attacker can block the re-
mote control devices of IKEA from fetching security patches. These
evidences show that CPDoS attacks can affect static as well as dy-
namic resources. Most of the vulnerable websites use CloudFront
as CDN. However, the real world impact of CPDoS attacks is not
only bound to CloudFront. We also found vulnerable websites in
our sample which utilize other CDNs such as Akamai or Cloudflare
in conjunction with Play 1. We have uncovered these examples in
a few days only. An advanced attacker with political and financial
motivation is easily able to gather much more vulnerable resources
as they only need to investigate the response headers in order to
estimate whether a target website or resource is potentially vulnera-
ble to CPDoS attacks. Moreover, the freely available HTTP Archive
data sets via Google Big Query include millions of URLs which
can be investigated by an attacker. For instance, HTTP Archive
data set httparchive.summary_requests.2018_12_15_desktop
contains over 9 millions URLs which we considered as highly vul-
nerable since the response headers of these resources indicate that
CloudFront in conjunction with Apache HTTPD, Nginx, Amazon
S3, Microsoft IIS, and Varnish is used. Among them are also many
critical websites and resources including Amazon itself, the website
dowjones.com, as well as Logitech which distributes firmware via
CloudFront.
5.7 Practical Considerations