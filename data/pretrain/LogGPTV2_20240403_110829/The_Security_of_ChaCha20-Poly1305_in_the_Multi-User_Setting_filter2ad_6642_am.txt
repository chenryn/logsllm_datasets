ğ´ğ· = ğ´ğ·1âˆ¥ Â· Â· Â· âˆ¥ğ´ğ·â„“ğ‘šâˆ’1, where |ğ´ğ·ğ‘–| = ğ‘¡ and ğ´ğ·ğ‘– = 2ğ‘¡âˆ’1. It
receives a tag ğ‘‡ as answer. We denote by ğ‘Ÿğ‘ and ğ‘ ğ‘ the hash key
(after clamping) and the blinding value, associated to the nonce
ğ‘ , i.e., ğ‘Ÿğ‘ âˆ¥ğ‘ ğ‘ = CC_block(ğ¾ğ‘–, ğ‘ , 0)[1:2ğ‘¡]. Let R denote the set
of all possible hash keys for Poly1305_Mac (after clamping). Let
R1, . . . , Rğ‘ğ‘£ âŠ‚ R be ğ‘ğ‘£ disjoint sets, each of 3(cid:106) â„“ğ‘šâˆ’1
(cid:107) hash keys. For
each R ğ‘—, we will construct a forgery polynomial and the associated
pair ğ´ğ·â€²,ğ‘‡ , that will be a valid forgery with nonce ğ‘ , if ğ‘Ÿğ‘ is in
R ğ‘—. Let
4
ğ‘…(ğ‘¥, R ğ‘—) = ğ‘¥2 Â· ğ‘”(ğ‘¥) Â· 
zero polynomial of degree at most(cid:106) â„“ğ‘šâˆ’1
when we rewrite ğ‘…(ğ‘¥, R ğ‘—) asâ„“ğ‘š
lently asâ„“ğ‘š
ğ‘Ÿ âˆˆR ğ‘—
4
ğ‘–=2 ğ‘â€²
ğ‘–=2 ğ‘â„“ğ‘šâˆ’ğ‘–+1 Â· ğ‘¥ğ‘– mod ğ‘ (or equiva-
ğ‘–âˆ’2 Â· ğ‘¥ğ‘– mod ğ‘ later in the proof), the coefficients
ğ‘ğ‘– satisfies (2ğ‘¡âˆ’1 + ğ‘ğ‘– mod ğ‘)  4ğ‘‘ âˆ’ 2. We are left to show that
(2ğ‘¡âˆ’1 + ğ‘â€²
ğ‘– mod ğ‘) < 2ğ‘¡ for all ğ‘– â‰¤ 4ğ‘‘ âˆ’ 2. We can compute a basis
(and determinant) of the lattice L, by looking at the row echelon
we donâ€™t need to know). More importantly, ğ‘…(ğ‘¥, R ğ‘—) =â„“ğ‘š
form of the previous matrix:(cid:20)ğ¼ğ‘‘
(cid:12)(cid:12) â‰¤ ğ‘
(cid:12)(cid:12)ğ‘â€²
the smallest vector of L and construct ğ‘…(ğ‘¥, R ğ‘—) =â„“ğ‘š
where ğ´ is a ğ‘‘Ã—3ğ‘‘ matrix. From this matrix, we can observe that the
rank of L is 4ğ‘‘, and its determinant is ğ‘3ğ‘‘. Minkowskiâ€™s theorem
with the infinity norm yields that, for the shortest vector in L,
4 < 2ğ‘¡âˆ’1 for all ğ‘– â‰¤ 4ğ‘‘ âˆ’2.
ğ‘– mod ğ‘) < 2ğ‘¡ for all
Therefore, as the adversary A is unbounded, it can compute
ğ‘–âˆ’2 Â· ğ‘¥ğ‘–
ğ‘– mod ğ‘) < 2ğ‘¡ for all ğ‘– < â„“ğ‘š âˆ’ 1. It then
4ğ‘‘ for all ğ‘– â‰¤ 4ğ‘‘ âˆ’2. Thus(cid:12)(cid:12)ğ‘â€²
Hence âˆ’2ğ‘¡âˆ’1 < ğ‘â€²
ğ‘– â‰¤ 4ğ‘‘ âˆ’ 2.
ğ‘– < 2ğ‘¡âˆ’1 and (2ğ‘¡âˆ’1 + ğ‘â€²
mod ğ‘ such that (2ğ‘¡âˆ’1 + ğ‘â€²
(cid:12)(cid:12) â‰¤ ğ‘
ğ´
ğ‘ Â· ğ¼3ğ‘‘
ğ‘–=2 ğ‘â€²
ğ‘–=2 ğ‘â€²
(cid:21)
0
3ğ‘‘
3
ğ‘–
ğ‘–
proceeds to the above-described attack. Note that [2] provides an
algorithm for solving SVP with the infinity norm used in the proof.
C.2 Proof of Proposition 7.6
The following proof is an adaptation of the lower bound of [13] to
a distinguishing attack for ChaCha20-Poly1305. Fix a nonce ğ‘ . Let
A be an adversary that query the encryption of a total number of
ğœğ‘’ blocks across different users. For each of the ğœğ‘’ block queried,
we denote by ğ‘Šğ‘— the ğ‘›âˆ’ğ‘˜ bit string [ğ¶ğ‘– âŠ• ğ‘€ğ‘–]ğ¾- (32)âˆ’ (ğ‘âˆ¥ğ‘–âˆ¥ğ‘), where
ğ¶ğ‘– is the encryption of ğ‘€ğ‘– (the ğ‘–-th block of a message) with nonce
ğ‘ . The adversary outputs 1, if ğ‘Šğ‘— â‰  ğ‘Šğ‘—â€² for all ğ‘— â‰  ğ‘—â€².
In the ideal world, the strings ğ‘Šğ‘— are independent and uniformly
distributed. Thus, the adversary outputs 1 only if a string doesnâ€™t
repeat, i.e.,
Pr
AğºIdeal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
=
1 âˆ’ ğ‘–
2ğ‘›âˆ’ğ‘˜
.
(cid:21)
(cid:18)
ğœğ‘’âˆ’1
ğ‘–=0
(cid:19)
Using Weierstrass product inequality,
1 âˆ’ ğ‘–
2ğ‘›âˆ’ğ‘˜
â‰¥ 1 âˆ’