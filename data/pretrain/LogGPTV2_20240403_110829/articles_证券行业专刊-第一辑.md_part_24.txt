业 自主可控环境下的系统异构与持续免疫防护实践
专
刊
程序拒绝运行、已知应用程序篡改拒绝运行的基础保护效果。 率、节点安全等问题得到了有效提升，从而保证了链上数据的安全
性、上链存储效率。
五、基于可信区块链实现防篡改
六、结合人工智能技术实现用户行为分析
传统区块链技术用作存储的时候，存在着共识速度慢、读写性能差
的问题，出现这个问题的根本原因是区块链没有对运行区块链的节 持续免疫防护系统采用深度学习加组合学习的方式，对被保护的主
点有任何限制——任何节点包括恶意节点都能够加入到区块链共 机运行的程序行为进行人工智能分析。默认对系统一段时间的操作
识过程中，这就要求共识的算法（POW工作量证明等）必须能够 行为进行数据建模，一旦有机器违反了正常行为数据的建模将立刻
有较强的抗恶意节点的能力，且如果存在恶意节点的话共识的时间 告警。同时也支持管理员通过编写规则红线，定义机器管理规范。
和成本明显上升。 比如限制对于被保护系统的数据库文件，日志等的拷贝行为。
基于区块链存在的这个问题，持续免疫防护系统结合了可信计算的 用户行为分析过程分为数据采集与接入、数据处理、数据可视化等
技术，通过可信计算筛选出可信的节点，从而降低恶意节点对共识 几个部分，基本流程为：数据采集层采集系统所需数据并将数据存
过程的干扰；同时为了解决POW算法资源消耗大、共识效率低的 入数据源，数据源将数据导出到大数据处理层以供其分析和处理数
问题，引入了PBFT实用拜占庭容错算法，明显提高了共识速度。 据，服务层获取到处理完成的结果并发送到数据可视化层将数据呈
在此基础上引入国密算法，避免基于传统加密算法漏洞导致的攻 现到页面。
击，有效的保护系统的安全运行。
… …
图8…可信区块链框架
可信区块链作为底层基础设施，在原有区块链基础之上，其共识效 图9…用户行为分析功能架构
178 179
行
业 自主可控环境下的系统异构与持续免疫防护实践
专
刊
用户行为分析功能建立了大量模型来对采集到的数据进行分析，根 用户行为分析是整个持续免疫防护系统的大数据处理与学习黑白
据数据时效性分为离线计算模型和实时计算模型。 事务的大脑，通过对数据的处理与采集，将被探测主机的内部、外
部行为进行分析，从而让系统具备识别黑白事务的能力。
实时计算模型使用Spark作为流处理引擎，实时消费处理用户数据。
对从数据接入平台接收到的数据首先进行数据清洗，过滤掉与主机 七、总结
或用户特征无关的冗余数据和异常信息；然后把清洗过后的用户数
据加工成能够被用户建模使用的数据；发送给Kafka。实时数据分 等保2.0新标准对新型安全攻击检测能力、网络安全分析能力、用
析组件和数据消费者可以通过Kafka得到实时数据，进行实时分 户行为分析能力等提出了更高的要求，也正呼应了证券行业信息安
析和计算，挖掘用户的行为偏好等信息。 全对抗高级威胁、内部威胁，升级安全体系从被动防护到主动防御、
… 动态防御的实际需求。
持续免疫防护系统在传统安全理念基础上引入可信技术、区块链、
用户行为分析等技术，结合人工智能，建立新的安全防护体系。同
时已与海光、麒麟等自主可控产品完成适配，完成自主可控改造。
图10…实时计算模型
传统安全体系升级的建设方案很多，本文仅对自身实践过的持续免
离线计算模型通过对离线的历史数据的去重和解析，利用数据完成 疫防护体系建设进行介绍。希望可以与行业内同仁产生共鸣，起到
各模型的训练，并将训练得到的模型参数进行存储，供异常检测部 抛砖引玉的作用。
分读取使用。训练过程首先加载知识库并对其进行处理，然后对训
练数据进行预处理，最后完成基于服务类型、基于命令类型、核心 参考文献：
算法以及深度学习算法的四类模型的训练。 李佳琪、秦志豪，2021中国自主可控产业应用落地研究报告及供应商60强，亿欧智
库，2021.11.19
…
作者介绍 SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN
沈嗣贤，东吴证券股份有限公司信息安全管理团队负责人，硕士研究生学历，拥有高
级工程师职称、CISP等多项网络安全专业证书。2008年入行，在东吴证券先后从
事过系统运行、网络通信和信息安全的工作。曾荣获 2020 年度国家金融科技发展奖
图11…离线计算模型 三等奖，第七届证券期货科学技术奖优秀奖，东吴证券优秀员工、优秀党员。
SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN
180 181
金融企业网络安全边界纵深防御体系
及其演进
南京证券 宋士明
行
业
专
刊
一、背景
近年来，随着整个社会数字化转型进程加速，支撑金融企业数字化
转型的网上信息系统越来越复杂，信息系统的边界也愈加模糊。当
前，尤其是新冠肺炎疫情爆发以来，网络安全形势日益复杂，来自
互联网的网络攻击破坏活动不断增多，影响力和破坏力显著增强，
网络违法犯罪呈现快速增长态势。网络安全已进入了攻击复杂化、
漏洞产业化、网络军火民用化、安全法制化、重保工作常态化、安
全事件应急小时化的新常态。当前金融企业面临的网络和数据安全
风险越来越高，国内外各类安全事件频发。金融企业一直是网络攻
击的重灾区，尤其勒索软件、挖矿蠕虫、敏感数据泄漏、软件供应
链攻击、APT攻击、钓鱼邮件呈逐年攀升态势，来自互联网的攻
击频度与强度日益加大，对金融企业的网上信息系统的安全运行构
成了严重威胁。在监管层面，随着国家《网络安全法》、《数据安
全法》、《个人信息保护法》等法律法规以及等级保护2.0制度的
183
行
业 金融企业网络安全边界纵深防御体系及其演进
专
刊
正式施行，标志着网络和数据安全已上升到国家法律层面，金融企
业同样面临巨大的网络安全监管压力。如何构建网络安全边界纵深
防御体系架构、有效抵御内外部网络安全威胁，成为金融企业亟需
解决的问题。
二、网络安全边界纵深防御体系架构
金融企业的网上信息系统对业务连续性和安全性均有极高的要求，
一个较为完善的金融企业网络安全纵深防御体系架构需要同时兼
顾多方面的要求，右图1为一种典型的数据中心网络安全边界纵
深防御体系的总体架构。
…
2.1 设备与链路
为确保业务连续性，金融企业数据中心的网络安全边界防御体系架
构中所使用的设备与链路均考虑了冗余备份，比如设备高可用、多
线路接入等。对于设备可以采用HA或集群方式部署，在互联网
接入部分，可以采用多运营商线路或BGP线路接入，不同运营商
线路接入到交换机不同VLAN,以满足不同运营商的用户接入需求。
若采用多运营商互联网线路接入，通常需要配合使用智能DNS解
析实现用户客户端优先访问同运营商的线路，为用户提供优质的互
图1…网络安全纵深防御体系总体架构
联网访问体验。对来自互联网的大流量DDoS攻击，受限于金融
企业互联网源站的DDoS防护成本和防护效果，优先推荐采用对
应线路所属运营商的流量清洗服务，实现大流量DDoS攻击的防护。 文的改写、SSL证书卸载等。同时，为确保DMZ区服务器在主动
出站访问互联网资源时，节省负载均衡成本，可利用互联网负载
2.2 负载均衡 均衡同时实现出站的三运营商互联网链路的负载均衡和多运营商
如右图1所示,互联网负载均衡为数据中心DMZ区各业务服务器 Local…DNS均衡代理转发功能，为DMZ区服务器出站访问流量实
的网络接入提供高可用和网络资源负载均衡，实现DMZ业务负载 现在三运营商线路上负载分担、链路高可用及多运营商Local…DNS
的L4-L7层应用交付能力，如L4-L7应用代理、L7层HTTP报 解析。
184 185
行
业 金融企业网络安全边界纵深防御体系及其演进
专
刊
内网负载均衡也称为横向负载均衡/NAT64网关，顾名思义，该 BOT防护、CC攻击、慢攻击防护和动态混淆防护，以及基本的
负载均衡为DMZ区服务器提供该区服务器东西向流量的负载均衡， 网页防篡改功能，还能够对端到端TLS/SSL加密流量提供TLS/
以及在该区服务器无法向互联网直接提供IPv6服务时，通过内网 SSL加解密和Web攻击防护。
负载均衡在南北向为互联网客户端及时提供IPv6地址转IPv4地
址的NAT64服务，确保平滑提供互联网IPv6服务，满足监管要求。 2.5 故障隔离交换机