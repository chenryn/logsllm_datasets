启动KaliLinux自带的MySQL服务的操作步骤如下。
1.如果要从桌面菜单启动 MySQL服务，可在桌面菜单中依次选中Kali Linux|System
Service|MySQL|mysql start.如果要通过命令行启动它，可在终端窗口里输入下
述指令：
service mysql start
2.系统会返回下述响应信息。
[ ok ] Starting MySQL database server: mysqld ....
[info] Checking for tables which need an upgrade, are corrupt or were not closed
cleanly-.
3.如需测试MySQL的工作状态是否正常，可使用MySQL客户端登录到服务器。我
们使用用户名（root）和密码登录MySQL服务器。
mysql -u root -p
4.系统会返回下述响应信息。
---
## Page 48
30Kali Linux渗透测试的艺术
Enter password:
Welcome to the MySQL monitor. Commands end with ; or \g.
Your MySQL connection id is 42
Server version: 5.5.30-1 (Debian)
Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights
reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other nanes may be trademarks of their respective
owners.
current input statement.
mysq1>
5.您可以在MySQL的提示符下直接使用SQL命令。如需退出MySQL客户端程序，请
使用quit命令。
出于安全性的考虑，默认情况下，只能从本机访问KaliLinux系统
里的MySQL服务，如需调整这个设置，请修改配置文件/etc/mysql/
my.cnf里的bind-address语句.除非需要从其他主机访问 MySQL
服务，否则我们建议您不要修改它。
停止MySQL服务的操作步骤如下。
1.如果要通过桌面菜单停止MySQL服务，可在桌面菜单中依次选中KaliLinux|System
Service|MySQL|mysql stop。如果要通过命令行停止它，可在终端窗口里输入下述
指令。
service mysql stop
2.系统会返回下述响应信息。
[ ok ] Stopping MySQL database server: mysqld.
下述指令可使KaliLinux系统在启动过程中自动启动MySQL服务。
update-rc.d mysql defaults
---
## Page 49
第1章Kali Linux入门31
这条指令将把MySQL服务添加到自动启动的程序组里。
1.7.3SSH
SSH的全称是SecureShell.它是目前较为可靠的专为远程登录会话和其他网络服务提
供安全性的协议。除了远程登录的服务功能以外，它还有很多功能：它支持在主机间安全
地传递文件、在远程主机上执行命令，以及X11（Linux的桌面）会话转发等。
管理SSH服务的操作步骤如下。
1.如果要从桌面菜单启动 SSH服务，可在桌面菜单中依次选中KaliLinux|System
Service|SSH|sshd start。如果要通过命令行启动它，可在终端窗口里输入下述
指令。
service ssh start
2.系统会返回下述响应信息。
[ ok ] Starting OpenBSD Secure Shell server: sshd.
3.如需测试SSHD 的工作状态是否正常，可以在其他主机上使用 SSH客户端登录到
服务器。如果您使用的是MicrosoftWindows 系统，可以使用putty进行测试。下
载 putty 的官方网站是 http://www.chiark.greenend.org.uk/~sgtatham/
putty/e
4.如果要通过桌面菜单停止SSHD服务，可在泉面菜单中依次选中KaliLinux|System
Service|SSH|sshd stop。如果要通过命令行停止它，可在终端窗口里输入下述
指令。
service ssh stop
5.系统会返回下述响应信息。
[ ok ] Stopping OpenBSD Secure Shell server: sshd.
6.下述指令可使KaliLinux系统在启动过程中自动启动SSH服务。
update-rc.d ssh defaults
---
## Page 50
32Kali Linux渗透测试的艺术
这条指令将把SSH服务添加到自动启动的程序组里。
1.8安装脆弱系统
我们在本节安装渗透和测试的目标一一台存在很多漏洞的虚拟主机，本书很多章
节里的特定主题都涉及这台脆弱系统（vulnerable server）。在法律许可的范围之内，我
们不可以攻击任何在Intemet上的存在漏洞的真实主机，所以我们必须使用自已安装的
脆弱系统。我们在此强调，除非有对方的书面许可，否则决不可以渗透或测试他人的主
机。此外，我们希望您能够在自已搭建的环境中提高渗透技能。当攻击没有达到预期成
效时，只要渗透环境完全可控，您就可以轻易地检查目标主机的情况，从而找到失败的
原因。
在很多国家，只要目标主机不是您自己的，哪怕您对其进行端口扫描都会被认为
是犯罪。而且，只要使用虚拟机作为目标主机，即使它发生了故障，我们也能很快将
其修复。
我们将在虚拟机里安装Metasploitable2，用它作为我们的脆弱系统。Metasploitable的
研发团队是Rapid7旗下著名的 HDMoore。
除了Metasploitable2之外，还有很多可用于搭建渗透测试环境的舱弱系统。
详情请参见：http://www.felipemartins.info/2011/05/pentesting-
vulnerable=study=frameworks=complete=l1st/,
无论是操作系统、网络，还是Web应用服务方面，Metasploitable2都有非常多的漏洞
和问题。
有关这些漏润的详细情况，请参见Rapid7的官方网站：https：
//community.rapid7.com/docs/DOC-1875.
在VirtualBox里安装Metasploitable2的操作步骤如下。
1.从网络上下载Metasploitable2的虚拟机镜像文件。该网站网址是http：//sourceforge，
net/projects/metasploitable/files/Metasploitable2/。
2.解压缩下载的ZIP文件。待解压缩Metasploitable2的ZIP文件之后，您将看到5个
文件。
OMetasploitable.nvram
---
## Page 51
第1章Kai Linux入门33
OMetasploitable.vmdk
OMetasploitable.vmsd
OMetasploitable,vmx
OMetasploitable.vmxf
3.在VirtualBox里创建一个虚拟机。本例设置这个虚拟主机的名称（Name）为
Metasploitable2，并设置操作系统为Linux-Ubuntu。
4.给这个虚拟主机分配1024MB内存。
5.在Virtual Hard Disk设置里，选择Use existing hard disk，然后选中我们先前解压缩
出来的Metasploitable文件（见图1.33）。
Crete Nn Virual Machine
Virtual Hard Disk
using the foifer icot
d
anges to
ceated.
xeu pue as 
The recormended size f the tartp dsk is 8,00 GB
 Start-up Dik
xpp pey mu peh(5 @
鲁 Lse eiting hard dsk
Metaspiotable.mdk (Nomal 8,00 GB)
Met Gancel
图 1.33
6.修改联网类型为Host-onlyadapter，以保证这台虚拟主机服务器同时可被物理主机
和KaliLinux主机访间。我们还要修改KaliLinux的虚拟主机，把它的联网类型也
改为 Host-only adapter.
7.启动虚拟主机Metasploitable2。待完成启动过程之后，您可使用下述信息登录
Metasploitable 2的终端。
o用户名：msfadmin
O密码：msfadmin
8.登录成功之后，Metasploitable2的终端窗口如图1.34所示。
---
## Page 52
34Kali Linux渗透测试的艺术
Marning: Mever expose this Un to an untrusted netuorkt
ontact: msf dev[at Jnetesploit .con
ogin uith nsfadnin/nsfa.nin to get started
petasploitable login: nsfadn1n
mmx
 susten are reecsoftuain the
Inlierdcsl fites ut /usr/share/foe/chcopuright :
sfadmlng
Pnetasploitable:"$
图 1.34
1.9安装额外工具包
虽然最新版本的KaliLinux带有大量的安全工具，但是由于以下原因，您可能还会需要
从软件仓库之外安装程序：
·KaliLinux所采纳的版本，可能不是该软件的最新版；
·KaliLinux的软件仓库（repository）可能没有收录您所需要的软件。
我们的建议是首先在软件仓库里搜索软件，如果软件仓库里有您所需要的软件，就通
过软件仓库安装该软件。如果在软件仓库里找不到该软件，您可能就不得不从软件作者的
网站下载并安装它。
我们的经验表明，您应当尽量通过软件仓库安装软件。这样一来，您就不必关注软件
管理（主要是更新）的那些繁琐事项。
Debian系统有很多可助您管理软件包的程序，例如 dpkg、apt和aptitude程序。
按照默认方式安装的KaliLinux会带有dpkg和apt程序。
如需了解apt和 dpkg命令的详细信息，请参见：https：//help，ubuntu
com/community/AptGet/Howto/f= http: /wnr. debian.ozg/doc/manua1s/
debian=xeference/ch02,en.html.
---
## Page 53
第1章Kali Linux入门35
本节将通过儿个与安装软件包有关的实例来介绍apt命令，
如需在软件仓库中查找某个软件包的名称，可使用指令：
apt-cache search
索一个叫做nessus的软件包。
apt-cache search nessus
如需查看软件包的详细信息（描述信息、软件包大小和版本等信息），可使用命令：
apt-cache show
如果决定安装或更新某个软件，那么就可用apt-get命令安装该软件包，apt-get
指令的基本用法是：
apt=getinstal1
如果您未能在KaliLinux的软件仓库里找到您所需要的软件，并且您能够确定它日后不
会对系统造成不良影响，那么您可以手动安装软件包。
务必从可信的软件源下载软件，尽量从软件研发团队的网站下载。如果研发团队
提供.deb安装包（后缀名为.deb的文件是Debian的安装包文件），您可以使用dpkg
命令安装该软件包。如果他们没有提供.deb安装包，您可以通过源代码安装该软件。
虽然实际情况各有不同，但是通过源代码安装软件的方法大体都可归纳为下述几个
1.使用压缩包管理软件（例如Tar和7-Zip）解压缩软件包。
2.进入到解压缩文件所在的目录。
3.执行指令：
./configure
make
make instal1
本节后续的篇幅将介绍如何安装没有被Kali软件仓库收录的软件工具。我们将演示以
下两种软件安装软件机制：
---
## Page 54
36Kali Linux渗透测试的艺术
·通过Debian安装包安装应用程序：
·通过源代码安装应用程序。
1.9.1安装Nessus漏洞扫描程序
本小节将通过第一种安装机制安装最新的Nessus漏洞扫描程序（第5版），我们在Kali
Linux的软件仓库进行过相关搜索，并没有找到这个程序。
与上一版本的程序相比，第5版的Nessus的程序具有更多功能。新版程序能够通过更
为详细的过滤规则整理扫描结果，创建创建更为灵活的扫描报告，面且简化了扫描策略的
设置过程。因此我们不再使用第4版的Nessus。
如需了解新版Nessus 的改进之处，请参见：http：//wwu.tenable，
com/products/ nessus/ nessus=product- overview/vhy-upgzade-
to=nessus=5 。
我们可以访问 Nessus的官方网站（http：//www,nessus，org/products/nessus/