title:Passive online rogue access point detection using sequential hypothesis
testing with TCP ACK-pairs
author:Wei Wei and
Kyoungwon Suh and
Bing Wang and
Yu Gu and
Jim Kurose and
Donald F. Towsley
Passive Online Rogue Access Point Detection Using
Sequential Hypothesis Testing with TCP ACK-Pairs∗
United Technologies Research
Kyoungwon Suh
Illinois State University
Bing Wang
University of Connecticut
Wei Wei
Center
Yu Gu
Amherst
University of Massachusetts,
University of Massachusetts,
Jim Kurose
Amherst
Don Towsley
University of Massachusetts,
Amherst
ABSTRACT
Rogue (unauthorized) wireless access points pose serious se-
curity threats to local networks. In this paper, we propose
two online algorithms to detect rogue access points using
sequential hypothesis tests applied to packet-header data
collected passively at a monitoring point. One algorithm
requires training sets, while the other does not. Both algo-
rithms extend our earlier TCP ACK-pair technique to diﬀer-
entiate wired and wireless LAN TCP traﬃc, and exploit the
fundamental properties of the 802.11 CSMA/CA MAC pro-
tocol and the half duplex nature of wireless channels. Our
algorithms make prompt decisions as TCP ACK-pairs are
observed, and only incur minimum computation and storage
overhead. We have built a system for online rogue-access-
point detection using these algorithms and deployed it at a
university gateway router. Extensive experiments in various
scenarios have demonstrated the excellent performance of
our approach: the algorithm that requires training provides
rapid detection and is extremely accurate (the detection is
mostly within 10 seconds, with very low false positive and
false negative ratios); the algorithm that does not require
training detects 60%-76% of the wireless hosts without any
false positives; both algorithms are light-weight (with com-
putation and storage overhead well within the capability of
commodity equipment).
Categories and Subject Descriptors: C.2.3 [Network
Operations]: Network management
General Terms: Algorithms, Management, Measurement,
Performance.
Keywords: Rogue access point detection, Sequential hy-
pothesis testing, TCP ACK-pairs.
∗Most of the work by the ﬁrst two authors was done when
they were at UMass, Amherst.
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’07, October 24-26, 2007, San Diego, California, USA.
Copyright 2007 ACM 978-1-59593-908-1/07/0010 ...$5.00.
1.
INTRODUCTION
The deployment of IEEE 802.11 wireless networks (WLANs)
has been growing at a remarkable rate during the past sev-
eral years. The presence of a wireless infrastructure within a
network, however, raises various network management and
security issues. One of the most challenging issues is rogue
access points (APs), i.e., wireless access points that are in-
stalled without explicit authorization from a local network
management [9, 1, 3, 4]. Although usually installed by inno-
cent users for convenience or higher productivity, rogue APs
pose serious security threats to a secured network. They po-
tentially open up the network to unauthorized parties, who
may utilize the resources of the network, steal sensitive infor-
mation or even launch attacks to the network. Furthermore,
rogue APs may interfere with nearby well-planned APs and
lead to performance problems inside the network.
Due to the above security and performance threats, de-
tecting rouge APs is one of the most important tasks for a
network manager. Broadly speaking, two approaches can be
used to detect rogue APs. The ﬁrst approach detects rogue
APs by monitoring the RF airwaves, possibly exploiting ad-
ditional information gathered at routers and switches [2, 8,
9, 1, 3, 4, 10, 11, 27]. The second approach monitors in-
coming traﬃc at a traﬃc aggregation point (e.g., a gateway
router) and determines whether a host uses wired or wire-
less connection1. If a host is determined as using wireless
connection while it is not authorized to do so (e.g., it is
not contained in the authorization list), the AP attached by
this host is detected as a rogue AP. The ﬁrst approach can
suﬀer from various drawbacks including scalability, deploy-
ment cost, eﬀectiveness and accuracy (see Section 1.1). The
second approach does not have the above drawbacks: (1)
since it is based on passive measurements at a single mon-
itoring point, it is scalable, requiring little deployment cost
and eﬀort, and is easy to manage and maintain; (2) since the
detection is by detecting wireless connections, it is equally
applicable to detect layer-2 or layer-3 rogue devices while
the ﬁrst approach may need diﬀerent schemes for rogues at
diﬀerent layers [10, 11]. The challenge in applying the sec-
ond approach is: how to eﬀectively detect wireless traﬃc
from passively collected data in an online manner?
In this paper, we take the second approach and develop
1A local network typically supports both Ethernet and
WLAN technologies, and therefore the aggregation point ob-
serves a mixture of wired and wireless traﬃc. The scenario
of purely wireless network is discussed in Section 8.2.
two online algorithms to meet the above challenges. Our
main contributions are as follows:
• We extend the analysis in [25] and demonstrate that
using TCP ACK-pairs can eﬀectively diﬀerentiate Eth-
ernet and wireless connections (including both 802.11b
and 802.11g).
• We develop two online algorithms to detect rogue APs.
Both algorithms use sequential hypothesis tests and
make prompt decisions as TCP ACK-pairs are ob-
served. One algorithm requires training data, while
the other does not. To the best of our knowledge, ours
are the ﬁrst set of passive online techniques that detect
rogue APs by diﬀerentiating connection types.
• We have built a system for online rogue-AP detec-
tion using the above algorithms and deployed it at
the gateway router of the University of Massachusetts,
Amherst (UMass). Extensive experiments in various
scenarios have demonstrated the excellent performance
of our algorithms:
(1) The algorithm that requires
training provides rapid detections and is extremely ac-
curate (the detection is mostly within 10 seconds, with
very low false positive and false negative ratios); (2)
The algorithm that does not require training detects
60%-76% of the wireless hosts without any false posi-
tives; (3) Both algorithms are light-weight, with com-
putation and storage overhead well within the capa-
bility of commodity equipment. We further conduct
experiments to demonstrate that our scheme can de-
tect connection-type switching and wireless networks
behind a NAT box, and it is eﬀective even when the
hosts have high CPU, disk or network utilizations.
The rest of the paper is organized as follows. Section 1.1
describes related work. Section 2 presents the problem set-
ting and a high-level description of our approach. Section 3
analyzes TCP ACK-pairs in Ethernet and WLAN. Sections 4
and 5 present our online algorithms and online rogue-AP
detection system, respectively. Sections 6 and 7 present ex-
perimental evaluation methodology and results, respectively.
Section 8 discusses several practical issues related to rogue
AP detection. Finally, Section 9 concludes the paper.
1.1 Related work
As mentioned earlier, monitoring RF waves and IP traﬃc
are two broad classes of approaches to detecting rogue APs.
Most existing commercial products take the ﬁrst approach
— they either manually scan the RF waves using sniﬀers
(e.g., AirMagnet [2], NetStumbler [8]) or automate the pro-
cess using sensors (e.g.,[1, 9, 4]. Automatic scanning using
sensors is less time consuming than manual scanning and
provides a continuous vigilance to rogue APs. However, it
may require a large number of sensors for good coverage,
which leads to a high deployment cost. Furthermore, since
it depends on signatures of APs (e.g., MAC address, SSID,
etc.), it becomes ineﬀective when a rogue AP spoofs signa-
tures. Three recent research eﬀorts [10, 11, 27] also use RF
sensing to detect rogue APs.
In [10], wireless clients are
instrumented to collect information about nearby APs and
send the information to a centralized server for rogue AP de-
tection. This approach is not resilient to spooﬁng. Secondly,
it assumes that rogue APs use standard beacon messages in
IEEE 802.11 and respond to probes from the clients, which
may not hold in practice. Last, all unknown APs (includ-
ing those in the vicinity networks) are ﬂagged as rogue APs,
which may lead to a large number of false positives. The
main idea of [11] is to enable dense RF monitoring through
wireless devices attached to desktop machines. This study
improves upon [10] by providing more accurate and compre-
hensive rogue AP detection. However, it relies on proper
operation of a large number of wireless devices, which can
be diﬃcult to manage. In contrast, our approach only re-
quires a single monitoring point, and is easy to manage and
maintain. The focus of [27] is on detecting protected layer-
3 rogue APs. Our approach is equally applicable to detect
layer-2 or layer-3 rogue devices.
The studies of [13, 19] detect rogue APs by monitoring IP
traﬃc. The authors of [13] demonstrated from experiments
in a local testbed that wired and wireless connections can
be separated by visually inspecting the timing in the packet
traces of traﬃc generated by the clients. The settings of
their experiments are very restrictive. Furthermore, the vi-
sual inspection method cannot be carried out automatically.
Our schemes are based on a rigorous analysis of Ethernet
and wireless traﬃc characteristics in realistic settings. Fur-
thermore, we provide two sequential hypothesis tests to au-
tomatically detect rogue APs in real time. The technique
in [19] requires segmenting large packets into smaller ones,
and hence is not a passive approach.
There are several prior studies on determining connection
types. However, none of them provides a passive online tech-
nique, required for our scenario. Our previous work [25] pro-
poses an iterative Bayesian inference technique to identify
wireless traﬃc based on passive measurements. This iter-
ative approach is not suitable for online deployment. The
work of [12] uses entropies to detect wireless connection in
an oﬄine manner. In other studies, diﬀerentiating connec-
tion types is based on active measurements [26] or certain
assumptions about wireless links (such as very low band-
width and high loss rates) [15], which do not apply to our
scenario.
Last, sequential hypothesis testing [24] provides an op-
portunity to make decisions as data come in, and thus is a
suitable technique for our purpose. It is also used for prompt
portscan detection in [18].
2. PROBLEM SETTING AND APPROACH
Consider a local network (e.g., a university campus or an
enterprise network), as illustrated in Fig. 1. A monitoring
point is placed at an aggregation point (e.g., the gateway
router) of this local network, capturing traﬃc coming in
and going out of the network. End hosts within this net-
work use either wired Ethernet or 802.11 WLAN to access
the Internet. An end host not authorized to use WLAN
may install a rogue AP to connect to the network. Our goal
is to detect those rogue APs in real time based on passive
measurements at the monitoring point. For this purpose, we
must answer the following two questions: (1) what statistics
can be used to eﬀectively detect wireless hosts? (2) how to
detect wireless hosts in an online manner? We next provide
a high-level description on how we address these two ques-
tions; a detailed description is deferred to Sections 3 and 4.
We have shown that inter-ACK time is a statistic that can
be used to eﬀectively detect wireless hosts in [25]. An inter-
ACK time is the inter-arrival time of a TCP ACK-pair, i.e., a
pair of ACKs corresponding to two data packets that arrive
L1
P1 P2 P3
Receiver
100Mbps
Router
100Mbps
Sender
(a)Ethernet
L2
A3
A1
A
Receiver
802.11 
Access
Point
100Mbps
Router
100Mbps
Sender
P1P2 P3P4
L1
(b)WLAN
L2
A
A1
A3
Figure 1: Problem setting: a monitoring point at
an aggregation point (e.g., the gateway router) cap-
tures incoming traﬃc and outgoing traﬃc to detect
rogue APs.
Figure 2: Settings for the analysis: (a) Ethernet, (b)
WLAN (802.11b or 802.11g). The dashed rectangle
between the sender and the router represents the
monitoring point. The pair of ACKs, A1 and A3,
forms an ACK-pair.
at the monitoring point close in time. In [25], we analyze the
inter-ACK time in Ethernet and WLAN and demonstrate
that it can be used to diﬀerentiate these two connection
types. However, the analysis does not include 802.11g, since
it was not widely deployed at that time. In Section 3, we
extend the analysis in [25] to 802.11g, and derive a new set of
results for Ethernet and 802.11b. Our results demonstrate
that inter-ACK times can eﬀectively diﬀerentiate Ethernet
and WLAN (including both 802.11b and 802.11g hosts).
For online detection of wireless hosts, we develop two
light-weight algorithms (see Section 4), both using sequen-
tial hypothesis tests and taking the inter-ACK times as in-
put. These two algorithms roughly work as follows. They
calculate the likelihoods that a host uses WLAN and Ether-
net as TCP ACK-pairs are observed. When the ratio of the
WLAN likelihood against the Ethernet likelihood exceeds a
certain threshold, they make a decision that the host uses
WLAN.
3. ANALYSIS OF TCP ACK-PAIRS
In this section, we extend the analysis in [25] and demon-
strate analytically that inter-ACK time can be used to ef-
fectively diﬀerentiate Ethernet and WLAN (including both
802.11b and 802.11g). In the following, we start from the
assumptions and settings, and then present the analytical
results. At the end, we brieﬂy summarize the insights ob-
tained from the analysis.
3.1 Assumptions and settings
The settings for our analysis are shown in Fig. 2, where an
outside sender sends data to a receiver in the local network.
In Fig. 2(a), the receiver uses Ethernet; in Fig. 2(b), the re-
ceiver uses 802.11b or 802.11g WLAN. We refer to the above
settings as Ethernet setting and WLAN setting, respectively.
In both settings, a router resides between the sender and
the receiver, and is connected to the sender by link L2 with
100 Mbps bandwidth. The monitoring point is between the
sender and the router, tapping into link L2. In the Ethernet
setting, the router and the receiver are connected by link L1
with 100 Mbps bandwidth. In the WLAN setting, an access
point resides between the router and the receiver. The ac-
cess point and the router are connected by link L1 with 100
Mbps bandwidth; and the receiver is connected to the access
point using 11 Mbps 802.11b or 54 Mbps 802.11g. In both
the Ethernet and WLAN settings, the router’s queues for