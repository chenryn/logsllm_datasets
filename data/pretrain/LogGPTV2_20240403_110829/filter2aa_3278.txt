GPS SPOOFING
Low-cost GPS simulator
HUANG  Lin, YANG Qing 
Unicorn Team – Radio and Hardware Security Research 
Qihoo 360 Technology Co. Ltd. 
Who we are? Unicorn Team
•  Qihoo360’s UnicornTeam consists of a group of 
brilliant security researchers. We focus on the security 
of anything that uses radio technologies, from small 
things like RFID, NFC and WSN to big things like GPS, 
UAV, Smart Cars, Telecom and SATCOM.  
•  Our primary mission is to guarantee that Qihoo360 is 
not vulnerable to any wireless attack. In other words, 
Qihoo360 protects its users and we protect Qihoo360. 
•   During our research, we create and produce various 
devices and systems, for both attack and defense 
purposes.  
•  We are one of the DEF CON 23 vendors. 
https://defcon.org/html/defcon-23/dc-23-vendors.html 
YANG Qing
•  YANG Qing is the team leader of Unicorn Team.  
•  He has rich experiences in wireless and hardware 
security area, including WiFi penetration testing, 
cellular network interception, IC card cracking etc. 
His interests also cover embedded system 
hacking, firmware reversing, automotive security, 
and software radio. 
•  He is the first one who reported the vulnerabilities 
of WiFi system and RF IC card system used in 
Beijing subway.
HUANG Lin
•  One of the early USRP users in China. Got the 
first USRP board in 2005 in Orange Labs 
•  Authored some tutorials about GNU Radio 
which were popular in China 
•  Made great effort on promoting Cloud-RAN 
technology in China from 2010 to 2013 
•  Join Qihoo 360 as a wireless security 
researcher in 2014
Beginning of the story …
Civilian-use GPS C/A Signal
GPS C/A signal is for civilian usage, and unencrypted. 
Replay attack is a typical GPS spoofing method.
Record
Replay
Firstly try replay attack
•  Hardware 
•  USRP B210 
•  Active GPS antenna  
•  Bias-tee circuit (Mini-Circuit 
ZX85-12G-S+) 
•  LNA (Mini-Circuit ZX60-V82-S+) 
Record GPS signal by a USRP B210
Replay the signal by a bladeRF
Success!
Record then replay the 
GPS signal. You can see 
the cellphone gets the 
position and timing 
information from the 
replayed GPS signal.
Nexus 5
If Create any GPS signal  
rather than Record & Replay…
This is not a replay
•  Demo video
Search existing solutions on Internet
•  Expensive or at least not free
•  NAVSYS ~$5000
•  NI LabVIEW ~$6000
Some famous cases of GPS spoofing
•  Leading lab: RadioNavigation 
Lab from Univ. of Texas at 
Austin (https://
radionavlab.ae.utexas.edu/ ) 
•  Prof. Todd E. Humphrey and 
his team 
•  2012 TED talk: how to fool GPS 
•  2013: spoof an US$80M yacht 
at sea 
•  2014: unmanned aircraft 
capture via GPS spoofing
We are not navigation experts. 
How can we do GPS spoofing?
As SDR guys, we have
USRP
bladeRF
HackRF
And we found some source codes on Internet
•  This website collects many open source projects about 
GPS 
•  http://www.ngs.noaa.gov/gps-toolbox/index.html 
•  This is a very good GPS receiver software based on GNU 
Radio 
•  http://gnss-sdr.org/ 
•  Most of projects are GPS receivers and few are 
transmitters. This is a transmitter example: 
https://code.csdn.net/sywcxx/gps-sim-hackrf 
•  It’s not finalized ! 
DIY a GPS Simulator!
Basic principle of GPS system
GPS principle
Mathematics time
Key information in Pseudo-range equations
Calculate the 
delays at 
receiver
WHEN
WHERE
Structure of message
1 bit (20 ms)
1 word (600 ms)
1 subframe (6 s)
1 page (30 s)
25 pages – the whole message (12.5 min) 
x30
x10
x5
x25
Info of WHEN & WHERE
Subframe 1
Subframe 2
Subframe 3
Subframe 4
Subframe 5
Time information
WHEN
Ephemeris
WHERE
Start building the signal
Get Ephemeris data
•  Method 1 
•  Download ephemeris data file from CDDIS website 
•  ftp://cddis.gsfc.nasa.gov/gnss/data/daily/ 
•  Here we can only get yesterday’s ephemeris data 
•  Method 2 
•  Use ‘gnss-sdr’ program to receive the real-time GPS signal and get 
the fresh ephemeris data 
•   The ‘GSDR*’ files are the decoded ephemeris data, in standard 
RINAX format.  
Decode the fresh ephemeris data
•  Software 
•  Run ‘gnss-sdr’ 
•  Get the GSDR* file
Matlab code of GPS simulator
Example: structure of Subframe 2
Generate navigation message
Bits "Waveform
GPS principle again
Calculate the 
transmission 
time 
How to calculate transmission time
Satellite is moving 
Earth is rotating
Calculate the 
coordinate according 
to ephemeris data 
Calculate the length 
of signal path
NOT 
EASY
Matlab code of generating waveform
Firstly offline verify the signal by ‘gnss-sdr’
OK
Secondly verify it by transmitting GPS signal file 
over air by bladeRF
Soft-receiver ‘gnss-sdr’ demod the signal
OK
Try to spoof cellphone’s GPS …
Failure
Which part is not perfect?
Doppler effect
Another challenge: Doppler effect
Moving 
towards 
receiver
Moving 
far from 
receiver
GPS principle again
Delay will be longer and longer, if 
moving far from receiver
Delay will be shorter and shorter, if 
moving towards receiver
NOT EASY
Try cellphone again
•  Nexus 5 GPS chipset 
•  Satellites are detected as pre-setting.  
•  Satellite signal strengths are same as 
we defined. 
•  3D fixed by simulated signal 
Bingo!
Bingo! Samsung Note 3
•  Located at Namco Lake in Tibet but 
the cellphone is actually in Beijing. 
Bingo! iPhone 6
•  Namco Lake in Tibet 
•  iPhone positioning is much 
slower. 
•  The cellphone clock was also 
reset to wrong time if auto-
calibration is enabled.  
Set any time
•  You may find the date we set is always Feb. 14 2015. This 
is because the ephemeris data file we use is at that day.  
•  Actually not only spacebut also time, can be spoofed.
A cellphone in future time
We set the time as Aug. 6, 2015 (today is Jul. 14) 
and position as Las Vegas. 
Try to spoof cars
•  Demo video: The car, BYD Qinwas located in a lake center. 
DJI drone - forbidden area policy
•  To avoid the risk from 
droneto people and to critical 
facilities, drone flying are 
forbidden in many cities.  
•  For example, DJI drone’s 
engine will keep off when it 
finds the position is in 
forbidden area. 
A drone that crashed on the 
grounds of the White House had 
evaded radar detection.
Try to spoof DJI drone
•  Demo video Disable forbidden area 
•  The drone is actually at a forbidden location in Beijing. We 
gave it a fake position in Hawaii, then it was unlocked and 
can fly up.  
Try to spoof DJ drone
•  Demo video: Hijack flying drone 
•  We gave a forbidden position to a flying drone, then it 
would automatically land.  
Lessons – how to anti-spoof
•  Application layer 
•  Now usually GPS has highest priority. Cellphone is spoofed even if 
it has cellular network connection. 
•  Use multi-mode positioning, GLONASS, Beidou 
•  Jointly consider cellular network and wifi positioning 
•  Civil GPS receiver chipset 
•  Use some algorithms to detect spoofing  
•  Civil GPS transmitter 
•  Add digital signatures into the extensible GPS civil navigation 
message 
GPS is still a great system 
•  First global positioning system 
•  Usable for all of the world 
•  Very low cost, small size… 
•  It keeps updatingso we believe the security issue will be 
improved in future.
Acknowledgment
•  JIA Liwei 
•  Graduate student of BUAAmajoring radio navigation  
•  https://code.csdn.net/sywcxx/gps-sim-hackrf 
•  JIAO Xianjun 
•  Senior iOS RFSW engineer at Apple, SDR amateur  
•  http://sdr-x.github.io/ 
Thank you!