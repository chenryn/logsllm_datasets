以下是优化后的文本，使其更加清晰、连贯和专业：

| 平台 | 战术 | 技术 | OilRig 的活动 | 检测方法 |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | [发现](https://attack.mitre.org/tactics/discovery/) | [进程发现](https://attack.mitre.org/techniques/T1057/) | OilRig 在受害者机器上运行了 `tasklist` 命令。 | 进程监控, 进程命令行参数 |
| Windows | [执行](https://attack.mitre.org/tactics/execution/) | [PowerShell](https://attack.mitre.org/techniques/T1086/) | OilRig 使用 PowerShell 脚本进行执行，包括使用宏来运行 PowerShell 命令以解码文件内容。 | PowerShell 日志, 加载的 DLL, DLL 监控, Windows 注册表, 文件监控, 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [命令与控制](https://attack.mitre.org/tactics/command-and-control/) | [自定义命令与控制协议](https://attack.mitre.org/techniques/T1094/) | OilRig 使用自定义 DNS 隧道协议进行 C2 通信。 | 数据包捕获, Netflow/Enclave netflow, 进程网络使用, 进程监控, 主机网络接口, 网络入侵检测系统, 网络协议分析 |
| Windows | [防御规避](https://attack.mitre.org/tactics/defense-evasion/) | [解混淆/解码文件或信息](https://attack.mitre.org/techniques/T1140/) | OilRig 宏运行了一个 PowerShell 命令来解码文件内容。OilRig 还使用了 `certutil` 来解码受害者机器上的 base64 编码文件。 | 文件监控, 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [横向移动](https://attack.mitre.org/tactics/lateral-movement/) | [远程服务](https://attack.mitre.org/techniques/T1021/) | OilRig 使用 Putty 访问被攻陷的系统。 | 认证日志 |
| Linux, Windows, macOS | [命令与控制](https://attack.mitre.org/tactics/command-and-control/) | [备用通道](https://attack.mitre.org/techniques/T1008/) | 如果 OilRig 恶意软件 ISMAgent 无法通过 HTTP 达到 C2 服务器，则会回退到其 DNS 隧道机制。 | 恶意软件逆向工程, Netflow/Enclave netflow, 数据包捕获, 进程监控, 进程网络使用 |
| Linux, macOS, Windows, AWS, GCP, Azure, Office 365, SaaS, Azure AD | [防御规避](https://attack.mitre.org/tactics/defense-evasion/), [持久化](https://attack.mitre.org/tactics/persistence/) | [冗余访问](https://attack.mitre.org/techniques/T1108/) | OilRig 使用 RGDoor 通过 Web Shell 建立冗余访问。该组织还使用收集到的凭据访问互联网可访问的资源，如 Outlook Web Access，用于冗余访问。 | Office 365 账户日志, Azure 活动日志, AWS CloudTrail 日志, Stackdriver 日志, 进程监控, 进程网络使用, 数据包捕获, 网络协议分析, 文件监控, 认证日志, 二进制文件元数据 |
| Linux, macOS, Windows, Office 365, Azure AD | [发现](https://attack.mitre.org/tactics/discovery/) | [权限组发现](https://attack.mitre.org/techniques/T1069/) | OilRig 使用 `net group /domain`, `net localgroup administrators`, `net group “domain admins” /domain`, 和 `net group “Exchange Trusted Subsystem” /domain` 来查找受害者的权限组设置。 | Azure 活动日志, Office 365 账户日志, API 监控, 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [防御规避](https://attack.mitre.org/tactics/defense-evasion/), [执行](https://attack.mitre.org/tactics/execution/) | [脚本](https://attack.mitre.org/techniques/T1064/) | OilRig 使用各种类型的脚本进行执行，包括 .bat 和 .vbs 脚本。该组织还使用宏来传递恶意软件，如 QUADAGENT 和 OopsIE。 | 进程监控, 文件监控, 进程命令行参数 |
| Linux, macOS, Windows, AWS, GCP, Azure | [发现](https://attack.mitre.org/tactics/discovery/) | [系统信息发现](https://attack.mitre.org/techniques/T1082/) | OilRig 在受害者机器上运行了 `hostname` 和 `systeminfo` 命令。 | Azure 活动日志, Stackdriver 日志, AWS CloudTrail 日志, 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [收集](https://attack.mitre.org/tactics/collection/) | [自动化收集](https://attack.mitre.org/techniques/T1119/) | OilRig 使用自动化收集技术。 | 文件监控, 数据丢失防护, 进程命令行参数 |
| Linux, macOS, Windows | [防御规避](https://attack.mitre.org/tactics/defense-evasion/) | [文件删除](https://attack.mitre.org/techniques/T1107/) | OilRig 在执行后删除与其有效载荷相关的文件。 | 文件监控, 进程命令行参数, 二进制文件元数据 |
| Linux, macOS, Windows | [发现](https://attack.mitre.org/tactics/discovery/) | [系统网络配置发现](https://attack.mitre.org/techniques/T1016/) | OilRig 在受害者机器上运行了 `ipconfig /all` 命令。 | 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [命令与控制](https://attack.mitre.org/tactics/command-and-control/) | [标准应用层协议](https://attack.mitre.org/techniques/T1071/) | OilRig 使用 HTTP 和 DNS 进行 C2 通信。该组织还使用 Plink 工具和其他工具创建到 C2 服务器的隧道。 | 数据包捕获, Netflow/Enclave netflow, 进程网络使用, 恶意软件逆向工程, 进程监控 |
| Linux, macOS, Windows | [发现](https://attack.mitre.org/tactics/discovery/) | [系统所有者/用户发现](https://attack.mitre.org/techniques/T1033/) | OilRig 在受害者机器上运行了 `whoami` 命令。 | 文件监控, 进程监控, 进程命令行参数 |
| Windows | [发现](https://attack.mitre.org/tactics/discovery/) | [查询注册表](https://attack.mitre.org/techniques/T1012/) | OilRig 在受害者机器上使用 `reg query "HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default"` 查询注册表。 | Windows 注册表, 进程监控, 进程命令行参数 |
| Windows | [横向移动](https://attack.mitre.org/tactics/lateral-movement/) | [远程桌面协议](https://attack.mitre.org/techniques/T1076/) | OilRig 使用远程桌面协议进行横向移动。该组织还使用隧道工具将 RDP 隧道引入环境。 | 认证日志, Netflow/Enclave netflow, 进程监控 |
| Linux, macOS, Windows, AWS, GCP, Azure | [发现](https://attack.mitre.org/tactics/discovery/) | [系统网络连接发现](https://attack.mitre.org/techniques/T1049/) | OilRig 在受害者机器上使用 `netstat -an` 获取网络连接列表。 | 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [执行](https://attack.mitre.org/tactics/execution/) | [命令行界面](https://attack.mitre.org/techniques/T1059/) | OilRig 使用命令行界面进行执行。 | 进程监控, 进程命令行参数 |
| Windows | [发现](https://attack.mitre.org/tactics/discovery/) | [系统服务发现](https://attack.mitre.org/techniques/T1007/) | OilRig 在受害者机器上使用 `sc query` 收集有关服务的信息。 | 进程监控, 进程命令行参数 |
| Windows, Linux, macOS | [凭证访问](https://attack.mitre.org/tactics/credential-access/) | [凭证转储](https://attack.mitre.org/techniques/T1003/) | OilRig 使用凭证转储工具，如 Mimikatz 和 LaZagne，窃取登录到受感染系统的账户凭证以及 Outlook Web Access 的凭证。 | API 监控, 进程监控, PowerShell 日志, 进程命令行参数 |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | [防御规避](https://attack.mitre.org/tactics/defense-evasion/), [持久化](https://attack.mitre.org/tactics/persistence/), [特权提升](https://attack.mitre.org/tactics/privilege-escalation/), [初始访问](https://attack.mitre.org/tactics/initial-access/) | [有效账户](https://attack.mitre.org/techniques/T1078/) | OilRig 使用被攻陷的凭证访问受害者网络中的其他系统。 | AWS CloudTrail 日志, Stackdriver 日志, 认证日志, 进程监控 |
| Linux, macOS, Windows, Office 365, Azure AD | [发现](https://attack.mitre.org/tactics/discovery/) | [账户发现](https://attack.mitre.org/techniques/T1087/) | OilRig 在受害者机器上运行 `net user`, `net user /domain`, `net group “domain admins” /domain`, 和 `net group “Exchange Trusted Subsystem” /domain` 获取账户列表。 | Azure 活动日志, Office 365 账户日志, API 监控, 进程监控, 进程命令行参数 |
| Linux, macOS, Windows | [渗出](https://attack.mitre.org/tactics/exfiltration/) | [通过替代协议渗出](https://attack.mitre.org/techniques/T1048/) | OilRig 通过 FTP 单独从其主要的 DNS C2 通道渗出数据。 | 用户界面, 进程监控, 进程网络使用, 数据包捕获, Netflow/Enclave netflow, 网络协议分析 |
| Linux, macOS, Windows | [防御规避](https://attack.mitre.org/tactics/defense-evasion/) | [混淆文件或信息](https://attack.mitre.org/techniques/T1027/) | OilRig 在其恶意软件中对数据进行了加密和编码，包括使用 base64。 | 网络协议分析, 进程网络使用, 文件监控, 恶意软件逆向工程, 二进制文件元数据, 进程命令行参数, 环境变量, 进程监控, Windows 事件日志, 网络入侵检测系统, 电子邮件网关, SSL/TLS 检查 |
| Linux, Windows, macOS | [持久化](https://attack.mitre.org/tactics/persistence/), [特权提升](https://attack.mitre.org/tactics/privilege-escalation/) | [Web Shell](https://attack.mitre.org/techniques/T1100/) | OilRig 使用 Web Shell 维持对受害者网络的访问。 | 反病毒, 认证日志, 文件监控, Netflow/Enclave netflow, 进程监控 |
| Linux, macOS, Windows | [防御规避](https://attack.mitre.org/tactics/defense-evasion/) | [从工具中移除指示器](https://attack.mitre.org/techniques/T1066/) | OilRig 测试恶意软件样本以确定防病毒检测，并随后修改样本以确保防病毒规避。 | 进程网络使用, 进程监控, 进程命令行参数, 反病毒, 二进制文件元数据 |

希望这些优化能帮助你更好地理解和传达信息。如果有任何进一步的需求，请告诉我！