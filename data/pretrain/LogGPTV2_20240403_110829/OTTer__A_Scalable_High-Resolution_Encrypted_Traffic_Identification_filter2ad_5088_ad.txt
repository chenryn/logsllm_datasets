vector and are updated iteratively at the packet level. For their experiments,
they analysed data extracted from WeChat, WhatsApp, and Facebook. Conti
et al. [11,12] proposed a system to analyse encrypted network traﬃc to identify
user actions on Android devices, such as email exchange, interactions over social
network, etc. Their framework leverages information that is available in TCP/IP
packets, like IP addresses and ports, among with other features, like packet size,
direction and timing. They analyse diverse Android applications, such as Gmail,
Facebook, Twitter, Tumblr and Dropbox. Using machine learning techniques,
they conduct their experiments that show that the system can achieve accuracy
and precision higher than 95% for a number of user actions. While our work is
based on the same grounds (i.e., the feasibility of user activity identiﬁcation over
encrypted network traﬃc based on packet trains), we advance the state-of-the-art
by (i) proposing a novel expressive pattern language speciﬁcation, (ii) building a
scalable and optimized implementation, which was integrated to our proprietary
DPI engine and tested and evaluated on real-world traﬃc volumes, (iii) showing
that the rule extraction is amenable to data mining techniques.
Application Identiﬁcation and Classiﬁcation. In this work, we focus on
ﬁne-grained event identiﬁcation within the traﬃc of an application, and there-
fore rely on application identiﬁcation, such as by means of server IP address
ranges, or metadata available as plaintext, such as the Server Name Identiﬁcation
(SNI) header in TLS traﬃc, or plaintext information in certiﬁcates exchanged.
Nevertheless, there is a large body of work on automating application identi-
ﬁcation or classiﬁcation of the traﬃc’s nature (e.g. video streaming), mostly
relying on machine learning approaches, and often applicable to encrypted traf-
ﬁc [4,6,9,17,20,23,27,30,31,36,40,41].
Endpoint Device Tools. We used tools running on endpoint devices to col-
lect ground truth samples. Here we survey a few related tools. Haystack [28] is a
mobile application distributed via popular app stores that can correlate contex-
tual information such as app identiﬁers and radio state with speciﬁc traﬃc ﬂows
(encrypted or not) destined to remote services, illuminating mobile application
performance, privacy and security. ProﬁleDroid [37] is another monitoring and
proﬁling system that can characterise the behaviour of Android applications
at the static, user, OS and network layers. Finally, TaintDroid [16] performs
dynamic information-ﬂow tracking in order to identify privacy leaks.
Traﬃc Analysis Resistance. There have been eﬀorts to create protocols,
networks and applications that provide anonymity and privacy guarantees in the
face of traﬃc analysis. Dissent [38] and Riposte [13] are systems that provide
strong guarantees by using message broadcasting. They protect packet metadata,
but may be unattractive due to scalability issues. Herd [22] is another system
that tackles the case of anonymity for VoIP calls, by addressing, like the former
proposals, some of the limitations of the more general-purpose Tor anonymity
OTTer: A Scalable High-Resolution Encrypted Traﬃc Identiﬁcation Engine
331
network [15]. Vuvuzela [32] and Atom [21] are more scalable systems (thousands
of messages for millions of users) that employ diﬀerential privacy to inject noise
into observable metadata. AnonRep [43] builds on top of these guarantees for
the case of reputation/voting systems, TARN [42] randomises the IP addresses,
while TARANET [10] employs packet mixing and splitting to achieve constant-
rate transmission.
7 Ethical Considerations
Since the nature of our study may rise some ethical considerations, we dedicate
this section to discuss how we avoid abusing personal and private information
of “human subjects” [26]. During the oﬄine testing of our methodology, we
processed samples that were collected using non-personal mobile devices and
non-private accounts for each application, explicitly for the purposes of this
experiment. Thus, there should be no privacy concerns regarding the data that
was processed during this phase.
During the online testing, we minimized the information collected by the
system to include only the number of matches per rule, without personally iden-
tiﬁable information of any kind. Neither this, nor other information was retrieved
from the system besides the performance measurements. All troubleshooting was
conducted based on our own collected oﬄine traces.
This study is motivated by benign uses such as customer experience/QoS
assessment, data leakage detection and policy enforcement (e.g. embargo on
voice), but could be abused as discussed extensively in the literature. Thus,
we strongly recommend that privacy sensitive applications take precautions.
We intentionally limited the scope of this work to a single direction of
communication—only message sending—to avoid the possibility of correlating
the user pairs that send and receive messages at the same time, and thus recov-
ering communication graphs.
8 Conclusion
In this work, we discussed ﬁne-grained identiﬁcation of application events over
encrypted network traﬃc with a focus on scalability and maintainability. We
demonstrated that (i) a simple regex-inspired language is expressive enough to
achieve a minimum hit rate of 84%, (ii) our DPI engine can scale to 130 Gbps
per node, with no more than 10% of extra CPU utilization, and (iii) the rule
extraction is amenable to data mining techniques. Prior work demonstrated the
feasibility of such techniques. Our work focuses on a real-world implementation
because we believe that just like substring pattern matching is a requirement in
a state-of-the-art network monitoring system, so is packet train matching, even
if techniques such as encryption and traﬃc analysis resistance (Sect. 6) exist to
evade them.
Acknowledgements. The authors would like to thank their shepherd Roya Ensaﬁ.
332
E. Papadogiannaki et al.
References
1. Android tcpdump. https://www.androidtcpdump.com. Accessed 09 Mar 2018-
2. Busybox
https://play.google.com/store/apps/details?
(android
application).
id=stericson.busybox&hl=en. Accessed 09 Mar 2018
3. netstat(8) - Linux man page. https://linux.die.net/man/8/netstat. Accessed 09
Mar 2018
4. Aceto, G., Ciuonzo, D., Montieri, A., Pescap´e, A.: Multi-classiﬁcation approaches
for classifying mobile app traﬃc. J. Netw. Comput. Appl. 103, 131–145 (2018)
5. Aho, A.V., Corasick, M.J.: Eﬃcient string matching: an aid to bibliographic search.
Commun. ACM 18(6), 333–340 (1975)
6. Alan, H.F., Kaur, J.: Can android applications be identiﬁed using only TCP/IP
headers of their launch time traﬃc? In: Proceedings of the 9th ACM Conference
on Security and Privacy in Wireless and Mobile Networks, pp. 61–66. ACM (2016)
7. Anonymized for submission: DPI engine anonymized for submission
8. Ateniese, G., Hitaj, B., Mancini, L.V., Verde, N.V., Villani, A.: No place to hide
that bytes won’t reveal: sniﬃng location-based encrypted traﬃc to track a user’s
position. Network and System Security. LNCS, vol. 9408, pp. 46–59. Springer,
Cham (2015). https://doi.org/10.1007/978-3-319-25645-0 4
9. Bernaille, L., Teixeira, R.: Early recognition of encrypted applications. In: Uhlig,
S., Papagiannaki, K., Bonaventure, O. (eds.) PAM 2007. LNCS, vol. 4427, pp.
165–175. Springer, Heidelberg (2007). https://doi.org/10.1007/978-3-540-71617-
4 17
10. Chen, C., Asoni, D.E., Perrig, A., Barrera, D., Danezis, G., Troncoso, C.:
Taranet: traﬃc-analysis resistant anonymity at the network layer. arXiv preprint
arXiv:1802.08415 (2018)
11. Conti, M., Mancini, L.V., Spolaor, R., Verde, N.V.: Can’t you hear me knocking:
identiﬁcation of user actions on android apps via traﬃc analysis. In: Proceedings
of the 5th ACM Conference on Data and Application Security and Privacy, pp.
297–304. ACM (2015)
12. Conti, M., Mancini, L.V., Spolaor, R., Verde, N.V.: Analyzing android encrypted
network traﬃc to identify user actions. IEEE Trans. Inf. Forensics Secur. 11(1),
114–125 (2016)
13. Corrigan-Gibbs, H., Boneh, D., Mazi`eres, D.: Riposte: an anonymous messaging
system handling millions of users. In: 2015 IEEE Symposium on Security and
Privacy (SP), pp. 321–338. IEEE (2015)
14. Coull, S.E., Dyer, K.P.: Traﬃc analysis of encrypted messaging services: apple imes-
sage and beyond. ACM SIGCOMM Comput. Commun. Rev. 44(5), 5–11 (2014)
15. Dingledine, R., Mathewson, N., Syverson, P.: Tor: the second-generation onion
router. Technical report, Naval Research Lab Washington DC (2004)
16. Enck, W., et al.: Taintdroid: an information-ﬂow tracking system for realtime pri-
vacy monitoring on smartphones. ACM Trans. Comput. Syst. (TOCS) 32(2), 5
(2014)
17. Fu, Y., Xiong, H., Lu, X., Yang, J., Chen, C.: Service usage classiﬁcation with
encrypted internet traﬃc in mobile messaging apps. IEEE Trans. Mobile Comput.
15(11), 2851–2864 (2016)
18. Gomariz, A., Campos, M., Marin, R., Goethals, B.: ClaSP: an eﬃcient algorithm
for mining frequent closed sequences. In: Pei, J., Tseng, V.S., Cao, L., Motoda,
H., Xu, G. (eds.) PAKDD 2013. LNCS (LNAI), vol. 7818, pp. 50–61. Springer,
Heidelberg (2013). https://doi.org/10.1007/978-3-642-37453-1 5
OTTer: A Scalable High-Resolution Encrypted Traﬃc Identiﬁcation Engine
333
19. Herrmann, D., Wendolsky, R., Federrath, H.: Website ﬁngerprinting: attacking
popular privacy enhancing technologies with the multinomial Na¨ıve-Bayes classi-
ﬁer. In: Proceedings of the 2009 ACM Workshop on Cloud Computing Security,
CCSW 2009, pp. 31–42. ACM, New York (2009)
20. Karagiannis, T., Papagiannaki, K., Faloutsos, M.: BLINC: multilevel traﬃc classi-
ﬁcation in the dark. ACM SIGCOMM Comput. Commun. Rev. 35, 229–240 (2005)
21. Kwon, A., Corrigan-Gibbs, H., Devadas, S., Ford, B.: Atom: horizontally scaling
strong anonymity. In: Proceedings of the 26th Symposium on Operating Systems
Principles, pp. 406–422. ACM (2017)
22. Le Blond, S., Choﬀnes, D., Caldwell, W., Druschel, P., Merritt, N.: Herd: a scalable,
traﬃc analysis resistant anonymity network for VoIP systems. ACM SIGCOMM
Comput. Commun. Rev. 45, 639–652 (2015)
23. Li, W., Moore, A.W.: A machine learning approach for eﬃcient traﬃc classiﬁca-
tion. In: 15th International Symposium on Modeling, Analysis, and Simulation of
Computer and Telecommunication Systems, MASCOTS 2007, pp. 310–317. IEEE
(2007)
24. Liu, J., Fu, Y., Ming, J., Ren, Y., Sun, L., Xiong, H.: Eﬀective and real-time in-
app activity analysis in encrypted internet traﬃc streams. In: Proceedings of the
23rd ACM SIGKDD International Conference on Knowledge Discovery and Data
Mining, pp. 335–344. ACM (2017)
25. Papadopoulos, E.P., Diamantaris, M., Papadopoulos, P., Petsas, T., Ioannidis, S.,
Markatos, E.P.: The long-standing privacy debate: mobile websites vs mobile apps.
In: Proceedings of the 26th International Conference on World Wide Web, pp. 153–
162. International World Wide Web Conferences Steering Committee (2017)
26. Partridge, C., Allman, M.: Ethical considerations in network measurement papers.
Commun. ACM 59(10), 58–64 (2016)
27. Rapoport, M., Suter, P., Wittern, E., Lh´otak, O., Dolby, J.: Who you gonna call?
Analyzing web requests in android applications. In: 2017 IEEE/ACM 14th Inter-
national Conference on Mining Software Repositories (MSR), pp. 80–90. IEEE
(2017)
28. Razaghpanah, A., et al.: Haystack: In situ mobile traﬃc analysis in user space.
ArXiv e-prints (2015)
29. Saltaformaggio, B., et al.: Eavesdropping on ﬁne-grained user activities within
smartphone apps over encrypted network traﬃc. In: WOOT (2016)
30. Taylor, V.F., Spolaor, R., Conti, M., Martinovic, I.: AppScanner: automatic ﬁn-
gerprinting of smartphone apps from encrypted network traﬃc. In: 2016 IEEE
European Symposium on Security and Privacy (EuroS&P), pp. 439–454. IEEE
(2016)
31. Taylor, V.F., Spolaor, R., Conti, M., Martinovic, I.: Robust smartphone app iden-
tiﬁcation via encrypted network traﬃc analysis. IEEE Trans. Inf. Forensics Secur.
13(1), 63–78 (2018)
32. Van Den Hooﬀ, J., Lazar, D., Zaharia, M., Zeldovich, N.: Vuvuzela: scalable private
messaging resistant to traﬃc analysis. In: Proceedings of the 25th Symposium on
Operating Systems Principles, pp. 137–152. ACM (2015)
33. Vasiliadis, G., Ioannidis, S.: GrAVity: a massively parallel antivirus engine. In:
Jha, S., Sommer, R., Kreibich, C. (eds.) RAID 2010. LNCS, vol. 6307, pp. 79–96.
Springer, Heidelberg (2010). https://doi.org/10.1007/978-3-642-15512-3 5
34. Vasiliadis, G., Koromilas, L., Polychronakis, M., Ioannidis, S.: GASPP: a GPU-
accelerated stateful packet processing framework. In: USENIX Annual Technical
Conference, pp. 321–332 (2014)
334
E. Papadogiannaki et al.
35. Vasiliadis, G., Polychronakis, M., Ioannidis, S.: MiDeA: a multi-parallel intrusion
detection architecture. In: Proceedings of the 18th ACM Conference on Computer
and Communications Security, pp. 297–308. ACM (2011)
36. Wang, Q., Yahyavi, A., Kemme, B., He, W.: I know what you did on your smart-
phone: inferring app usage over encrypted data traﬃc. In: 2015 IEEE Conference
on Communications and Network Security (CNS), pp. 433–441. IEEE (2015)
37. Wei, X., Gomez, L., Neamtiu, I., Faloutsos, M.: ProﬁleDroid: multi-layer proﬁling of
android applications. In: Proceedings of the 18th Annual International Conference
on Mobile Computing and Networking, pp. 137–148. ACM (2012)
38. Wolinsky, D.I., Corrigan-Gibbs, H., Ford, B., Johnson, A.: Dissent in numbers:
making strong anonymity scale. In: OSDI, pp. 179–182 (2012)
39. Wright, C.V., Ballard, L., Coull, S.E., Monrose, F., Masson, G.M.: Spot me if
you can: uncovering spoken phrases in encrypted VoIP conversations. In: IEEE
Symposium on Security and Privacy, SP 2008, pp. 35–49. IEEE (2008)
40. Xu, Q., et al.: Automatic generation of mobile app signatures from traﬃc obser-
vations. In: IEEE Conference on Computer Communications (INFOCOM), pp.
1481–1489. IEEE (2015)
41. Yao, H., Ranjan, G., Tongaonkar, A., Liao, Y., Mao, Z.M.: SAMPLES: self adaptive
mining of persistent lexical snippets for classifying mobile application traﬃc. In:
Proceedings of the 21st Annual International Conference on Mobile Computing
and Networking, pp. 439–451. ACM (2015)
42. Yu, L., Wang, Q., Barrineau, G., Oakley, J., Brooks, R.R., Wang, K.C.: TARN:
a SDN-based traﬃc analysis resistant network architecture. arXiv preprint
arXiv:1709.00782 (2017)
43. Zhai, E., Wolinsky, D.I., Chen, R., Syta, E., Teng, C., Ford, B.: AnonRep: towards
tracking-resistant anonymous reputation. In: NSDI, pp. 583–596 (2016)