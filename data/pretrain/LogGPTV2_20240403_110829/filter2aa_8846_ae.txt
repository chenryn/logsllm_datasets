of	Commerce	）据此执行安全港程序。GDPR于2018年5月25日生效。
46、7条安全港原则：任何组织都要告知个人收集和使用数据的目的
（Notice）；要给个人ᨀ供选择的机会（Choice）；在通知和选择的基础
上才能向其他组织传输数据（Onward	transfer）；组织要采取安全措施
保护数据（Security）；完整性：组织不能把数据用作Notice和Choice之外
的他用，应采取措施确保数据reliable。（Data	integrity）；个人可以使用
组织持有的信息，信息不对的话，个人能够更新和删除（Access）；组
织必须执行这些原则（Emforcement）。
47、7条原则：通知、选择、向前转移、安全、完整、访问、执行。
48、数据管理员（administrators），主要是分配权限的，不一定拥有全
部特权，通常采用基于角色的访问控制模型来非配权限，也即将用户账
户添加至群组，然后授予群组权限。OSG	test：有时也干数据保管员的事。
49、数据保管者（Custodians）：数据所有者将每天的任务委托给保管者。
保管者协助保护数据的安全性和完整性，定期备份。这通常是信息技术
部门的人（这人也有可能是分配权限的数据管理员）。
50、基线ᨀ供了一个起点，确保最低安全标准。基线的一个例子就是操
作系统镜像（Image）。基线要周期性的检查，确保维持在安全状态。举
例：微软组策略可以周期性地检查系统，调整设定以和基准线相匹配。
51、基线可以审视和裁剪（scoping	and	tailoring），
审视（范围）是指只选择那些适用的控制。例如，如果一个系统不允
许任何两人在同一时间登录，就不需要应用并发会话控制。
裁剪（定制、修订）则会修改某个具体的基线控制，使其与组织使命
（mission	of	the	organization	）相适应。例如，组织可能在本地办公使用
一组基线，但可能并不适用于远程办公点电脑。在这种情况下，组织可
以调整基线，并对远程电脑采取补偿安全控制。
52、在选择基线时，要考虑外部标准和要求。不处理信用卡交易的组织
不需要遵守 PCI	DSS。
53、NIST SP	800-53把安全控制做了个基线，
P-1：优先级最高：是基本的安全实践。
领域3-安全工程
第6章 密码学与对称密码算法
1、凯撒密码无非就是A换成D，称为ROT3密码或C3密码（cipher），⫿母
替代（是一种shift	cipher，也是substitution，这个属于混淆confuse）。
2、只有公钥体系才提供不可否认性。
3、data	at	rest怕偷窃，data	in	motion（on	the	wire）怕窃听。
3、Kerchoff原则就是算法应当公开，所有密钥应当保密。可以归纳为
“敌人知道了这个体系”（the	enemy	konws	the	system），公开后可以
暴露更多算法上的弱点。这个原则反对security	through	obscurity	（这是
早期的思想：试图通过隐匿实现安全）。
4、cryptography	（密码术）and	cryptanalysis（密码分析学）	are	
commonly	referred	to	as	cryptology.（密码学）		
5、分割知识（split	knowledge）：将信息或权限在多个用户间分配，任
何一个人没有足够权限危害安全性。最佳示例：密钥托管（escrow），
在密钥丢失和损坏时取出备份，M	of	N控制，就是至少M个代理一起工
作才能取出密钥，比如3	of	8	control。
6、工作函数（work	function）：密码系统的强度／安全性和工作函数成
正比，攻破密码系统的工作量就是工作函数，工作函数应该和受保护资
产的值匹配，大于受保护资产的时间价值即可。
7、code和cipher不一样，编码是表示词汇和短语的符号，保密或者不保
密，比如执法机构的通信“10系统”，间谍说“鹰着陆了”。密码则是
针对单个的字符和比特。
8、换位密码（transposition）（就是位置打乱，还是那些字符。这个属
于扩散。属于Diffusion。）：比如apple换成elppa，再比如柱状换位
（columnar	transposition）（非常有名，但有几个固有的弱点，容易受到
密码分析人员的攻击，现代不采用），用密钥attacker(按顺序对应
17823546)对信息“thr	fighters	will	strike	the	enemy	bases	at	noon”，加密
后TETEE FWKMT IIEYN HLHAO GLTBO TSESN HRRNS ESIEA。
9、替代密码（substitution），凯撒密码就是替代密码：加密：C=（P+3）
mod	26			解密：P=（C-3）mod	26；
很多替代密码更复杂，比如Vigenere密码。明文M=m1m2…，密钥
K=k1k2..kd, 密文C=c1c2....，则加密Ci=(mi+ki)mod 26，解密
Mi=(Ci-ki+n) mod 26
虽然能够防范直接的频率分析，但容易遭受二阶形式的频率分析。
10、一次一密（one	time	pads，一次性填充），C=（P+K)mod	26,也被称
为vernam密码（贝尔实验室发明者名字），如果运用得当，它是一个不
可破解的加密方案。关键在于随机（而不要像Soviet密钥那样，其生成方
式被美国人发现了）。而且要做好物理保护。
11、本质上，凯撒密码、vigenere、vernam，区别只在于密钥的长度，分
别是1个字符、1个词、和消息一样长。
12、滚动密钥密码（Running	key	ciphers），也被称为书籍密码，加密密
钥与消息本身一样长，一般从书籍中选取。
13、密码学算法，依靠两种基本的操作：混淆和扩散。混淆（confuse）：
明文和密钥的关系很复杂，难以通过更改明文和查看密文来判断key，换
位（Diffusion）：明文的改变会引起多处变化，
“替代”引入了混
淆，“换位”引入了扩散。substitution	introduces	confusion	and	the	
transposition	introduces	diffusion，所以，有的算法，先替换，然后再换
位。
14、对称密钥算法依赖于共享的秘密，称为secret	key	cryptography或者
private	key	cryptography。注意这里private	key这个术语，指的是shared	
private	key，不要和公钥体制中的私钥搞混了。
15、对称密钥的弱点：密钥分发需要预建立好的安全通道（经常是离
线）、未实现不可否认性，可扩展性（scalable）不好，大用户组的密钥
对太多，每当成员离开用户组时，所有涉及这个成员的密钥都要抛弃。
加密速度快，比非对称的速度高1000倍到10000倍。公钥算法和对称密钥
算法的优缺点互补。
16、对称密钥通常情况下，只ᨀ供机密性。而公钥算法还可以ᨀ供完整
性（主要通过签名实现）、身份认证和不可否认性。公钥算法不需要预
先的安全链接，一开始就可以安全通信。
17、DES是1977年发布的。在2001年被AES取代。DES有5种操作模式：
ECB，CBC，CFB，OFB，CTR
电子密码本（electronic	codebook，ECB，安全性最差）
密码分组链接（cipher	block	chaining，CBC，传播错误）
密码反馈（Cipher	Feedback，CFB，流密码，传播错误，加密不能并
行，解密可以并行）
输出反馈（Output	FeedBack，OFB，流密码，不传播错误，加解密都不
能并行）
计数模式（Counter，CTR，不传播错误，适合并行计算）
18、DES每次处理64位的明文，使用密钥的长度是56位（另外8位是奇偶
信息）。使用16轮加密，都是通过XOR完成的。
19、ECB的安全性最差，因为相同的明文分组会加密产生相同的密文。这
样时间长了，就会把所有的可能记录下来查字典破译。ECB模式仅仅适用
于很少量的数据加密。
20、CBC模式，每个分组在加密前，先和前一个密文分组异或。解密后也
和前一密文再异或。CBC还有一个IV，它是和第一个分组异或的。
21、IV要发给接收方，可以明文放在密文最前面，也可以用ECB保护。
CBC模式要考虑错误传播，一个分组在传输中被破坏，会影响下一个分组。
加密不可并行，解密可以并行。
22、CFB模式，是流密码形式的CBC，对IV或前一块密文加密后产生密钥，
直接和本块明文异或产生本块密文。（每次加密可以是8位（取前8位即
可），也可以是64位）。 之所以称为流密码，关键在于它的加密方式
为“异或”。
23、OFB模式，也是流密码，但并不是像CFB那样将密文加密产生密钥，
而是将前一块的流密钥加密后产生本块的流密钥。这种方式不传播错误，
OFB的加密和解密都不能并行。
24、计数模式，使用简单计数器，加密后作为密钥。和OFB一样，不传播
错误。很适合并行计算。
25、3DES，有4种版本： 可以是EEE或EDE，密钥可以是2个或3个。
EEE3：E（K1，E（K2，E（K3，P）））
EDE3：E（K1，D（K2，E（K3，P）））
EEE2：E（K1，E（K2，E（K1，P）））
EDE2：E（K1，D（K2，E（K1，P）））
 后两种的密钥的有效长度为112位。 还有一种EDE1，事实上只
是向后兼容而已。这4种模式的安全性是一样的。
26、人们试过2DES，发现这种不安全。
27、IDEA（国际数据加密算法），来学嘉和瑞士学者联合推出的，主要
是针对DES密钥长度不够而开发的，对64位分组操作，IDEA密钥为128位。
PGP中使用了IDEA。
28、Blowfish（豚鱼），是Bruce	Schneier发明的，仍然是对64位分组操作，
密钥是变长的，从32位到448位。速度比DES和IDEA都快。没有许可限制，
自由使用。
29、Skipjack由FIPS185（联邦信息处理标准）即EES（托管加密标准）批
准使用，对64位分组操作，密钥80位。也有4种操作模式。美国政府很快
接受了 Skipjack，并且ᨀ供支持 Clipper	和 Capstone	高速加密芯片的密
码学程序，这些芯片是为重要商业应用而设计的。NIST（国家标准和技
术协会）和财政部（Treasury）持有重建密钥的一部分信息。执法部门可
以找他们获得密钥。Skipjack	和 Clipper	芯片还没有被密码学团体普通接
受，这是因为它的托管程序由美国政府控制。
30、2000年10月，NIST宣布Rijndael成为DES的替代标准，12月，美国商
务部批准了FIPS197，要求使用AES对所有未分类的但敏感的数据进行加
密。
31、AES算法分组128位，使用128、192、256三种密钥强度（分别10轮、
12轮、14轮），最初的Rijndeal分组大小可以和密钥长度相等。
32、Twofish由Bruce	Schneier发明，也是分组密码，处理128位数据，密
钥变长：1～256位，最大256位（16轮）。有两种独特的技术，
prewhitening，postwhitening，加密前和加密后进行单独的与子密钥的异
或。
33、1976年，Diffie-Hellman算法发布，是密码学的一次大的进步。
Richard和Sue约定两个大数p（质数）和g（整数），1<g<p，这两个数
可以公开
Richard选择r，计算R=g^r	mod	p,
See选择s，计算S=	g^s	mod	p,
然后互相发R，S，但r,s要保密
Richard计算出K=S^r	mod	p和Sue计算出来的K=R^s	mod	p是一样的，也
就是共享的私有密钥了。
34、对于对称密钥而言，永远不要将加密密钥和加密数据存放在一个系
统中，对于敏感的密钥，可以考虑两个不同的人分别持有密钥的一半
（split	knowledge）。
35、两种主要的密钥托管的途径：一是公平密码系统（Fair	
cryptosystems），密钥被分成两个或多个部分，每个部分都被交给相互
独立的第三方，法院需要时，向所有第三方要密钥。二是使用托管加密
标准EES，这种方法向政府ᨀ供解密密文的技术手段，是Skipjack的基础。
36、由于摩尔定律的存在，处理器最终能达到猜测密钥的计算能力。所
以密码是有生命周期的，安全专家需要选择安全协议（TLS、SSL）、安
全算法（AES、3DES）以及密钥的长度。如果设计的密码系统用来保护计
划将在下周执行的商业计划，就无须担心10	年内可以破解的风险。如果
要保护那种可能用于建造核弹的机密信息，那就需要在今后 10	年里一
直维护这个机密。
第7章 PKI和密码学应用
1、1977年，Ronald	Rivest、Adi	Shamir和Leonard	Adleman提出了RAS算法，
算法申请了专利并成立了RSA公司。
选两个大质数p和q，n	=	p	*	q，
选择一个e，e<n, e和(p-1)(q-1)互质，
找到一个数d，使得(ed-1)mod(p-1)(q-1)=0,
公钥就是e和n，私钥就是d。
	C=P^e	mod	n,		P=C^d	mod	n	