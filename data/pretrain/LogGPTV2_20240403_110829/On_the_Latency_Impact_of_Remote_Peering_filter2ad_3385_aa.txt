# On the Latency Impact of Remote Peering

## Authors
- Fabrício M. Mazzola<sup>1</sup>
- Pedro de B. Marcos<sup>2</sup>
- Ignacio Castro<sup>3</sup>
- Matthew Luckie<sup>4</sup>
- Marinho P. Barcellos<sup>4</sup>

### Affiliations
1. UFRGS, Porto Alegre, Brazil
   - PI: EMAIL
2. FURG, Rio Grande, Brazil
   - PI: EMAIL
3. QMUL, London, UK
   - PI: EMAIL
4. University of Waikato, Hamilton, New Zealand
   - PI: EMAIL, PI: EMAIL

## Abstract
Internet Exchange Points (IXPs) play a crucial role in the Internet by providing a platform for thousands of Autonomous Systems (ASes) to interconnect. Initially designed to keep local traffic local, IXPs now interconnect ASes globally. The assumption that IXP routes are shorter and faster than those through transit providers may no longer hold. Using BGP views from eight IXPs (three in Brazil, two in the U.S., and one each in London, Amsterdam, and Johannesburg), along with latency measurements collected in May 2021, we compare the latency to reach the same addresses using routes from remote peers, local peers, and transit providers. For four of these IXPs, at least 71.4% of prefixes advertised by remote peers also had a local peering route. BGP generally preferred the remote route due to its shorter AS path, but the local route had lower latency in the majority of cases. When a remote route was the only peering route available at an IXP, it had slightly lower latency than a corresponding transit route outside the IXP for >57.6% of the prefixes for seven of the eight IXPs.

## 1. Introduction
The delivery of traffic on the Internet has become increasingly complex, as many applications generate large volumes of traffic and have strict service requirements. Consequently, ASes are constantly increasing their interconnection capacities and expanding their footprint. IXPs are key elements in this process, as they can shorten Internet paths and reduce interconnection costs [4, 10, 17, 31]. As of May 2021, there were more than 800 IXPs deployed worldwide [22, 29, 46]. The largest IXPs have surpassed 1,000 members [32, 35, 36] and 10 Tbps of peak traffic [7, 16, 19, 36].

Initially, IXPs were designed to keep local traffic local by having ASes physically present at an IXP facility. However, IXPs now interconnect members not only physically present at IXP facilities but also remotely. Remote peering, where an AS is not physically present at an IXP facility and reaches the IXP through a layer-2 provider, allows ASes to expand their peering footprint with quicker setup, no additional hardware, and lower installation costs compared to local peering [9, 15, 20]. For example, ASes from 85 different countries connect to LINX remotely [36] as of May 2021. To meet the demand for peering, IXPs and remote peering resellers have expanded their offerings [12, 25, 48], with some IXPs having up to 55 official partners selling remote peering services [8, 32, 37]. Network operators prefer to steer traffic through IXPs instead of transit providers due to reduced transit and operational costs [18, 21]. However, the ability to interconnect with remote members at IXPs adds complexity to traffic engineering choices.

Given the public debate about remote peering performance [1, 2, 5, 6, 34, 41, 43], which is currently data-poor, and to understand the latency properties of BGP routes at IXPs, we analyze latency and latency variability when using different interconnection methods (remote peering, local peering, and transit) to reach addresses in prefixes announced by remotely connected members in eight IXPs identified in Table 1. These eight IXPs include six of the world’s ten largest IXPs by membership and are deployed in five countries (three in Brazil, two in the U.S., and one each in London, Amsterdam, and Johannesburg). Our contributions are as follows:

1. We find that inferring remote ASes using the state-of-the-art methodology [42] based on latency and colocation data is insufficient for some IXPs (Sect. 3). Incomplete and/or inaccurate colocation data in regions such as Latin America yields a high number of unknown inferences (more than 68.6% for three IXPs). Because we need to infer which ASes are remotely connected to a given IXP to identify prefixes announced by remote ASes, we infer geographically distant remote ASes [15] and complement these inferences with ground-truth data (Sect. 4). We found that at least 26.2% of all ASes connected to major IXPs, such as PTT-SP and AMS-IX, were remotely connected members in May 2021. These remotely connected members announced fewer than ≈15% of the prefixes visible at the IXP, for most IXPs.

2. We classify prefixes announced by remote ASes in BGP data collected from PCH and IXP looking glass servers. We focus our analysis on prefixes that had routes available through both remote and local ASes (Sect. 5). We found that for 82.5% of these prefixes, on average, the AS path for the route from the remote peer was shorter or had the same length as the route from the local peer in the four IXPs with the most of these prefixes (LINX, AMS-IX, Eq-Ash, and Eq-Chi). Using BGP views from RouteViews peers, we confirmed that remote routes tended to be preferred by BGP. However, our latency measurements indicate that the local route had lower latency in most cases.

3. Finally, we examine the prefixes announced exclusively by remote members at IXPs (Sect. 6). Our findings suggest that remote routes can have lower latency to reach addresses in prefixes announced by remote ASes when compared with a transit route, though not by a considerable margin for six out of eight IXPs: using the remote route or the transit had a latency difference no higher than 5 ms for 78.1% of the measured prefixes. However, for NAPAfrica in South Africa, remote peering routes had a lower latency than transit routes, with a latency benefit of more than 40 ms for 81.4% of the measured prefixes.

## 2. Measurement Architecture

### 2.1 Peering Infrastructure Selection
To identify networks connected via remote peering and prefixes and routes announced via remote peering, we need peering infrastructures that have (1) publicly available BGP routing data, and (2) an active measurement VP attached to the IXP switching fabric. Table 1 presents the eight selected IXPs where we had both BGP routing data and active measurement capability. These IXPs include six of the world’s ten largest IXPs by membership [22, 29] and are deployed in five different countries. The three Brazilian IXPs (i.e., PTT sites) are part of the largest ecosystem of public IXPs in the world (IX.br) and are the leading Latin American IXPs in terms of average traffic volumes (≈12.9, 9.2, and 1.4 Tbps, respectively) [3, 13, 14]. The eight IXPs together comprise 3,466 unique ASes.

### 2.2 Datasets
**Remote Peering Reseller Ground Truth Data.** We obtained ground truth information for the ASes remotely connected via resellers for four of the analyzed IXPs: LINX, PTT-SP, PTT-RJ, and PTT-CE. The dataset contains information about the ASN and IP interface of remote ASes reaching the IXPs through shared ports or VLANs associated with resellers. For the PTT IXPs, we obtained the ground truth data from their operators on April 20, 2021. The set of ASes reaching LINX through resellers or locally connected to the IXP is publicly available at their member portal [37] (collected on May 5, 2021). LINX representatives confirmed that ASes with Port Type labeled as ConneXions correspond to ASes using resellers. The ground truth for the four IXPs comprises a list of 1,634 unique ASes using remote peering through resellers.

**Membership and Interface Addresses.** To identify the peering router's IP and ASN of all members at each IXP, we combine multiple public data sources for all IXPs except for LINX, which publishes this information through their member portal [37]. We collected membership data and subnet information from Euro-IX [22], Hurricane Electric (HE) [29], PeeringDB (PDB) [46], and Packet Clearing House (PCH) IXP Directory [44]. In cases of conflicts, we followed the preference ordering described in [42]: Euro-IX > HE > PDB > PCH.

**BGP Datasets and Sanitization.** We used two sources of routing data: (i) Looking Glass (LG) of the IXP, which observes routes from the IXP’s Route Server, and (ii) routes from the archive collected by PCH [45]. For IXPs with both PCH and LG views, we used data archived by PCH because it has greater visibility of routes advertised by IXP members. For example, when comparing both datasets for AMS-IX and LINX, we observed 3.4–3.9x more routes and 1.9–2.0x more prefixes from PCH than from LG views. As our goal is to understand the latency difference between routes announced at IXPs by different peering types (i.e., remote and local peering), we prefer the dataset from PCH whenever it is available, as it provides us with better visibility of the IXP routes (PCH > LG). On IXPs with only LG views (PTT sites), we have observed that LGs are configured to output only the best routes at the time of our BGP routing data collection, lowering the number of cases with multiple routes for the same prefix. Additionally, we collected BGP data from RouteViews collectors at each IXP to understand the types of routes that RouteViews peers actually chose. For each IXP, we obtained a BGP snapshot corresponding to the same period our measurements were performed (May 5–6, 2021). We discarded: (i) routes with artifacts, such as reserved/unassigned ASes [30] and loops; (ii) prefixes shorter than /8 or longer than /24.

### 2.3 Data Plane Measurements
**Vantage Points.** At each IXP listed in Table 1, we used RouteViews collectors directly connected to the IXP LAN to conduct active measurements using scamper [38]. Figure 1 illustrates the measurement architecture of each RouteViews collector and how we used them to conduct active measurements.

**Measurement Types.** We conducted two types of measurements. In the first, we measured the latency to each IXP member’s peering router. These measurements use the IP address that the collector has in the IXP LAN (X.2), so that probes and responses cross the IXP LAN, as in when we probe X.3 in Fig. 1. In the second, we measured the path and latency to IP addresses within prefixes announced by each IXP member. Note that these prefixes are peering routes, and not transit routes. These measurements go out via a selected IXP member (e.g., AS B, using the layer-2 address of X.4 in Fig. 1) but used the collector’s Transit IP address T.1 as the source address, so that we could receive a response. This strategy allowed us to maintain the same return path from the destination to the collector, ensuring consistent and reliable measurements.