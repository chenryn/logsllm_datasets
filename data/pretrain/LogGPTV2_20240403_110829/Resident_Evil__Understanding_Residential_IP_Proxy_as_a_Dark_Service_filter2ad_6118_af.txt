Collusion. The study of RESIP trafﬁc in §IV-C reveals that
RESIP service providers Proxies Online and Geosurf shared 9
PUPs. Here we further explore the relations among different
RESIP service providers in terms of their shared RESIPs. We
calculate the intersection rate (
) between the RESIPs
captured from different service providers, and further deﬁne
a very strict criterion to decide whether a RESIP can be
considered as shared by two providers. Speciﬁcally, we consider
a RESIP as shared only if it has ever been captured in the same
hour by independent inﬁltrations on both providers’ services.
As shown in Figure 8(c), we found a number of RESIPs
spanning different RESIP service providers. The most popular
one, Luminati, share 813 RESIPs with Proxies Online, 983 with
Geosurf, 2,783 with IAPS Security, and 1,718 with ProxyRack.
Besides, given that Proxies Online and Geosuf share a large
portion of their RESIPs, they are likely two brands of the same
company, while IAPS is probably a reseller of Luminati as
most of its RESIP IPs come from Luminati.
Infrastructure Proﬁling. After identifying the infrastructure
of RESIP services including the frontend websites/gateways
and the backend gateways, we conducted further proﬁling to
ﬁnd the potential features for detecting those infrastructures.
For this purpose, we ﬁrst collected the IPs associated with those
infrastructures by sending DNS queries from multiple locations
|A∩B|
|A|
to 48 identiﬁed domains and got 915 IPs. Then we ran periodic
port scanning on those IPs and found that those frontend
and backend gateways tend to open lots of consecutive ports.
Speciﬁcally, Luminati has 23000-23999, 52225 and 52951
ports opened for frontend gateways and 6861-7009 for backend
gateways. Geosurf/Proxies Online have 8010-8237 for frontend
gateways and 11211 for backend gateways. Also, ProxyRack
opens 1200-1250 and 1500-1750 for frontend gateways. We
also randomly scanned the IPs of popular web services and
found that none of them open such unusual ports. These ports
are related to different proxy services provided by PrxoxyRack
and Geosurf/Proxies Online. However, we do not know how
Luminati uses those consecutive ports.
C. Case Study: Luminati
Luminati claimed to be a network where users join willingly
by installing client software such as browser extensions or
Hola VPN, in order to contribute their network resources while
enjoying trafﬁc relaying through other participants. Actually,
when we purchased their service, Luminati indeed performed
a background check that asked for photo ID and explained
to us their trafﬁc policy through a video chat (although only
crawling Google is stated to be forbidden). Surprisingly, we
found that Luminati (1) proxies through IoT devices that do not
support Hola client software, (2) likely resells services to other
providers such as IAPS that conduct no background check,
and (3) involves RESIPs that host malicious content or are
associated with suspicious domains. Speciﬁcally, leveraging our
IP proﬁling infrastructure as described in §III-A, we performed
a real-time device ﬁngerprinting for newly captured RESIPs
from Luminati, and identiﬁed lots of IoT devices associated
with Luminati’s RESIPs like webcam (4.31%), DVR (1.93%),
printer (0.13%), VoIP (0.09%) and NAS (1.24%). As Luminati
did not provide any Hola clients for these types of devices,
our ﬁndings undermine its claim to be a network consisting of
only willing participants. Instead, IoT devices appear to be an
important RESIP source of Luminati.
Our ﬁndings in §IV-C and §V-B indicate that IAPS likely
resells Luminati’s RESIP service: the PUP trafﬁc logs show
that our inﬁltration trafﬁc from the IAPS proxies was actually
relayed by the Hola clients believed to be controlled by
Luminati; further, 66% of the RESIPs captured from IAPS were
also discovered by our inﬁltration targeting Luminati during
the same hour. We found that IAPS conducts no background
(cid:18)(cid:18)(cid:26)(cid:23)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply. 
check, accepts various payment methods such as bitcoin, and
applies no trafﬁc restrictions. Therefore, IAPS users might
be able to abuse Luminati’s network, or even to deny the
services for legitimate Luminati customers. We also found that
2.32% of Luminati’s RESIPs were hosting malicious content
or having suspicious domains resolved to them while acting
as proxies. Examples of such domains include the scam site
tummytickle.com and the drive-by-download site www.iwys.cc,
and malicious samples downloaded from those RESIPs include
PUP, Trojan and exploit code.
VI. DISCUSSION
Mitigation. Our measurements have identiﬁed numerous se-
curity issues including compromised devices and abusing
RESIP services for malicious activities. A key prerequisite
for mitigating such security issues is effective detection of
RESIP services and RESIPs, which we plan to pursue as future
work. We discuss potential features that are useful for detection.
We ﬁrst consider detecting RESIP services. We propose to
detect three components: their websites, frontend gateways, and
backend gateways. (1) Based on our experiences, RESIP web-
sites typically contain noticeable keywords such as “residential
IP”, “never blocked” and “HTTP/HTTPS/SOCKS”, which can
be used by a search engine or forum crawler for automated
content analysis. (2) Frontend gateways are oftentimes co-
located with RESIP websites with the same domain names or
even IP addresses. Furthermore, as described in §V, frontend
gateways tend to open a large number of TCP ports to serve
trafﬁc with various proxy requirements. This feature can also
be leveraged as well for detection. (3) Several features can be
possibly leveraged to detect backend gateways: opening a large
number of TCP ports, having globally distributed sources of
DNS queries for a low-reputation domain, and being co-located
directly or indirectly with the frontend gateways.
Detecting RESIPs seems challenging. Their discovery can
be facilitated using the detected backend gateways as “step
stones”, since RESIPs have to communicate with the backend
gateways. Besides, the visiting patterns and targeted domains
of trafﬁc relayed by RESIPs may deviate from those of normal
trafﬁc, and can possibly be considered by a detection scheme.
Datasets and Code release. We will release related datasets
and source code, as detailed in Appendix IX-C.
VII. RELATED WORK
Dark Web Proxy. The security issue on web proxy services
is attracting increasing attention from researchers. In par-
ticular, Weaver et al. [81] conducted a measurement study
to understand the purpose of free proxy services based on
how they modify trafﬁc. Chung et al. [58] studied a paid
proxy service to uncover content manipulation in end-to-end
connection. O’Neill et al. [72] measured the prevalence of
TLS proxies and identiﬁed thousands of malware intercepting
TLS communications. Carnavalet et al. [62] released security
vulnerabilities in TLS proxies, allowing attackers to mount
man-in-the-middle attacks. Recently, [80] and [73] showed the
content modiﬁcation behavior of Open HTTP proxy services
and free HTTP/HTTPS proxy services.
In contrast to the
above studies on web proxies and content manipulation, our
research study an emerging online gray business RESIP service,
and focus on the abused RESIPs as attack intermediaries and
collusive RESIP service providers.
Compromised Host Detection. How to detect compromised
host has been studied for long. Techniques have been developed
to analyze web content, redirection chains, and trafﬁc pattern.
Examples of the content-based detection include a system [56]
monitoring the evolution of web content to identify an infection
using signatures generated from such modiﬁcations, and a
framework [70] conducting semantic differential analysis to
identify the infection of the website. Other studies focus on ma-
licious redirectors and attack infrastructures. Examples include
JsRED [69] that used a differential analysis to automatically
detect malicious redirect scripts hosts, and Shady Path [79]
that captured a compromised host by looking at its redirection
graph. Also, a large number of studies detected compromised
hosts using trafﬁc analysis via active or passive probing. [71]
detected P2P bots by remotely probing the hosts and analyzing
the response trafﬁc. [83] combined binary analysis and trafﬁc
analysis for P2P bot detection. In our study, we perform
best-effort identiﬁcation and characterization of RESIPs using
novel methods. We also compare RESIPs to other types of
compromised hosts such as bots, and reveal several challenges
for accurately detecting the RESIPs on today’s Internet.
Empirical study of botnet. Botnets have long been studied.
For example, [53] revealed structural and behavioral features of
botnets such as the high churn rate within a botnet. [60] studied
the relationship between botnet and spamming activities. [78]
characterized the personal data theft behavior of the Torpig
botnet. In contrast, our study focuses on RESIP services that
show different characteristics from botnets in their hosts, users
and network behaviors, as detailed in §IV-D.
VIII. CONCLUSION
RESIP service is an emerging online gray business, whose
security implications have never been studied before. In the
paper, we report the ﬁrst systematic research on this new
service, based upon a suite of techniques that address the
challenges in collecting RESIP host information and ﬁnding
illicit activities these proxies are involved in. Speciﬁcally,
through inﬁltrating 5 representative services, we gathered over
6.2 million RESIP IPs and further successfully proﬁled more
than 500K hosts, identifying more than 200K IoT devices likely
to be compromised to serve as proxies. Further by linking the
IPs to the PUP trafﬁc data provided by our industry partner,
we gained a rare look inside the operations of these residential
proxies. Our study shows that RESIPs tend to be part of
such illicit activities as blackhat SEO, Fast ﬂuxing, phishing,
malware hosting, etc. Our inﬁltration analysis also discovered
the hidden layer of their infrastructure and the collusions across
different services. Moving forward, we believe that unregulated
RESIP services indeed pose new threats to the Internet users
and further research is needed to get a more comprehensive
view of the services and develop effective solutions to mitigate
their security risks.
(cid:18)(cid:18)(cid:26)(cid:24)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:44:47 UTC from IEEE Xplore.  Restrictions apply. 
ACKNOWLEDGMENT
We are grateful to our shepherd Professor Matthew Smith and
the anonymous reviewers for their insightful and helpful com-
ments. The IU authors are supported in part by NSF 1408874,
1527141, 1618493, 1618898 and ARO W911NF1610127. Also,
authors from Tsinghua University are supported in part by the
National Natural Science Foundation of China (grant 61772307)
and CERNET Innovation Project NGII20160403.
REFERENCES
[1] Geosurf: Residential and data center proxy network. https://www.geosurf.
[2] Iaps security. https://www.intl-alliance.com/.
[3] Luminati: largest business proxy service. http://luminati.io/.
[4] The netﬂix vpn ban can be bypassed – here’s how it can be done
com/.
responsibly.
[5] Proxies online. http://proxies.online.
[6] Proxyrack. https://www.proxyrack.com/.
[7] Public proxy service. www.kuaidaili.com/.
[8] On the trail of malicious dynamic dns domains. https://umbrella.cisco.
com/blog/2013/04/15/on-the-trail-of-malicious-dynamic-dns-domains/,
2013.
[9] Alienvalut otx. https://otx.alienvault.com, 2017.
[10] Cymon otx. https://cymon.io/, 2017.
[11] Free proxy list. http://www.freeproxylists.com, 2017.
[12] Hajime - netlab opendata project. http://data.netlab.360.com/hajime/,
2017.
[13] Iot reaper: A rappid spreading new iot botnet. http://blog.netlab.360.com/
iot reaper-a-rappid-spreading-new-iot-botnet-en/, 2017.
[14] Ip2location
db8.
https://www.ip2location.com/databases/
db8-ip-country-region-city-latitude-longitude-isp-domain, 2017.
[15] Ip2proxy lite. https://lite.ip2location.com/database/px1-ip-country, 2017.
[16] Nmap service detection probe list.
https://svn.nmap.org/nmap/
nmap-service-probes, 2017.
[17] Passive dns from 360 netlab. https://passivedns.cn, 2017.
[18] Spamhaus edrop. https://www.spamhaus.org/drop/, 2017.
[19] Tor exit nodes. https://check.torproject.org/exit-addresses, 2017.
[20] Tor node list from dan. https://www.dan.me.uk/tornodes, 2017.
[21] Virustotal. https://www.virustotal.com, 2017.
[22] Webanet free proxy list. https://webanetlabs.net/publ/24, 2017.
[23] Acess to apnic whois data. https://www.apnic.net/manage-ip/using-whois/
bulk-access/, 2018.
[24] Afrinic
bulk whois
data.
https://www.afrinic.net/library/
membership-documents/207-bulk-whois-access-form-, 2018.
[25] Aliyun ip ranges. https://ipinfo.io/AS37963, 2018.
[26] Amazon aws ip address ranges. https://docs.aws.amazon.com/general/
latest/gr/aws-ip-ranges.html, 2018.
[27] Amazon echo. https://en.wikipedia.org/wiki/Amazon Echo, 2018.
[28] At&t mobility llc. https://whois.arin.net/rest/org/ATTMO-3, 2018.
[29] At&t mobility llc. https://en.wikipedia.org/wiki/AT%26T Mobility, 2018.
[30] Available hola clients. https://hola.org/download, 2018.
[31] Blackhat seo forum: Proxies for sal. https://www.blackhatworld.com/
forums/proxies-for-sale.112/, 2018.
[32] Cloudﬂare ip ranges. https://www.cloudﬂare.com/ips/, 2018.
[33] Geoip2 precision insights service.
https://www.maxmind.com/en/
geoip2-precision-insights, 2018.
[34] Google compute engine ip ranges. https://cloud.google.com/compute/
docs/faq#where can i ﬁnd product name short ip ranges, 2018.
[35] Google home. https://en.wikipedia.org/wiki/Google Home, 2018.
[36] Hola faq. https://hola.org/faq#intro-cost, 2018.
[37] Ibm cloud ip ranges. https://console.bluemix.net/docs/infrastructure/
hardware-ﬁrewall-dedicated/ips.html#ibm-cloud-ip-ranges, 2018.
[38] Microleaves. https://microleaves.com/, 2018.
[39] Microsoft azure datacenter ip ranges. https://www.microsoft.com/en-us/
download/details.aspx?id=41653, 2018.
[40] Obtaining bulk whois data from arin. https://www.arin.net/resources/
request/bulkwhois.html, 2018.
[41] Philips hue lights. https://en.wikipedia.org/wiki/Philips Hue, 2018.
[42] Pure vpn. https://www.purevpn.com/, 2018.
[43] Raw scan data of censys. https://censys.io/data, 2018.
[44] Rdap protocol. https://about.rdap.org/, 2018.
[45] Request for bulk whois of lacnic. http://www.lacnic.net/en/web/lacnic/
manual-8, 2018.
[46] Ripe whois apis.
https://www.ripe.net/analyse/archived-projects/
ris-tools-web-interfaces/riswhois, 2018.
[47] Salesforce ip ranges.
https://help.salesforce.com/articleView?id=
000003652&type=1, 2018.
[48] Shodan. https://www.shodan.io/, 2018.
[49] Storm proxies. http://stormproxies.com/, 2018.
[50] Tor volunteer. https://www.torproject.org/getinvolved/volunteer.html.en,
2018.
[51] Trace my ip. http://www.tracemyip.org/, 2018.
[52] Zoomeye. https://www.zoomeye.org/, 2018.
[53] M. Abu Rajab, J. Zarfoss, F. Monrose, and A. Terzis. A multifaceted
approach to understanding the botnet phenomenon. In Proceedings of
the 6th ACM SIGCOMM conference on Internet measurement, pages
41–52. ACM, 2006.
[54] S. Alrwais, X. Liao, X. Mi, P. Wang, X. Wang, F. Qian, R. Beyah, and
D. McCoy. Under the shadow of sunshine: Understanding and detecting
bulletproof hosting on legitimate service provider networks. In Security
and Privacy (SP), 2017 IEEE Symposium on, pages 805–823. IEEE,
2017.
[55] M. Antonakakis, T. April, M. Bailey, E. Bursztein, J. Cochran, Z. Du-
rumeric, J. A. Halderman, D. Menscher, C. Seaman, N. Sullivan, et al.
Understanding the mirai botnet. 2017.
[56] K. Borgolte, C. Kruegel, and G. Vigna. Delta: automatic identiﬁcation
of unknown web-based infection campaigns.
In Proceedings of the
2013 ACM SIGSAC conference on Computer & communications security,
pages 109–120. ACM, 2013.
[57] L. Carl et al. Using machine learning technliques to identify botnet trafﬁc.
In Local Computer Networks, Proceedings 2006 31st IEEE Conference
on. IEEE, 2006.
[58] T. Chung, D. Choffnes, and A. Mislove. Tunneling for transparency:
A large-scale analysis of end-to-end violations in the internet.
In
Proceedings of the 2016 ACM on Internet Measurement Conference,
pages 199–213. ACM, 2016.
[59] T. Chung, R. van Rijswijk-Deij, B. Chandrasekaran, D. Choffnes,
D. Levin, B. M. Maggs, A. Mislove, and C. Wilson. A longitudinal,
end-to-end view of the dnssec ecosystem. 2017.
[60] M. P. Collins, T. J. Shimeall, S. Faber, J. Janies, R. Weaver, M. De Shon,
and J. Kadane. Using uncleanliness to predict future botnet addresses.
In Proceedings of the 7th ACM SIGCOMM conference on Internet
measurement, pages 93–104. ACM, 2007.
[61] A. Cui and S. J. Stolfo. A quantitative analysis of the insecurity of
embedded network devices: results of a wide-area scan. In Proceedings
of the 26th Annual Computer Security Applications Conference, pages
97–106. ACM, 2010.
[62] X. d. C. de Carnavalet and M. Mannan. Killed by proxy: Analyzing
client-end tls interception software. In Network and Distributed System
Security Symposium, 2016.
[63] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman.
A search engine backed by internet-wide scanning. In Proceedings of
the 22nd ACM SIGSAC Conference on Computer and Communications
Security, pages 542–553. ACM, 2015.
[64] Z. Durumeric, E. Wustrow, and J. A. Halderman. Zmap: Fast internet-
In USENIX Security
wide scanning and its security applications.
Symposium, volume 8, pages 47–53, 2013.
[65] S. Garcia, M. Grill, J. Stiborek, and A. Zunino. An empirical comparison
of botnet detection methods. computers & security, 45:100–123, 2014.
[66] E. J. Hernandez-Valencia. Architectures for broadband residential ip