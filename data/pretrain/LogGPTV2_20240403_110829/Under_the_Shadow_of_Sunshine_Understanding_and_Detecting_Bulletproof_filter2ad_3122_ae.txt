network blocks and more speciﬁcally sub-allocations brings
in the challenge of result validation that is hampered by the
difﬁculty in obtaining ground truth. Validation cannot be done
by only correlating detected domains and IP addresses against
blacklists or using malware detectors (e.g., Virus Total [34]),
as most research studies have done. Validating a detected sub-
allocation as a true positive entails ﬁnding either overwhelming
evidence that the sub-allocation is or has hosted malicious/abu-
sive content or has some compromised resources if not all.
Such an in-depth investigation can only be performed on a case
815
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
by case basis and is not quantiﬁable. In an effort to quantify
the accuracy of our classiﬁer, we compute a set of indicators
of badness reﬂecting suspicious if not outright malicious sub-
allocations. For the purposes of consistency and comparison,
for each measured indicator on the detected sub-allocations, we
apply the same indicator on the labeled clean and malicious
sets. Following are those indicators:
• Non-operational TLD+3: All detected sub-allocations and
those of the labeled sets were hosting in total over 570M
TLD+3. We perform real time DNS lookup on all 570M of
these domains to ﬁnd the ones that have ceased to operate.
More speciﬁcally, we measure the percentage of TLD+3 for
which we received either an NXDomain, non-existent domain,
or was parked with a domain parking service. This indicator
proved to be quite powerful as one expects legitimate services
to last a long time while malicious ones survive for a shorter
duration. Figure 9(a) clearly shows that the sub-allocations
detected by both trained models of Set-A, Set-B and the
labeled malicious set all have a much higher rate of non-
operational TLD+3 compared to the labeled clean set.
• Presence in blacklists: We show ties to malicious activities
by cross-matching the TLD+3 and IP addresses of the sub-
allocations against the 3 blacklists we collect, shown in Ta-
ble III. Figures 9(b)&9(c) reveal a larger presence of detected
sub-allocations in blacklists compared to the clean set, even
though many do not have any footprints in blacklists making
this indicator a slighter weaker one.
• Distribution of FQDNs over TLD+3: By manually sampling
the detected sub-allocations, we noticed the behavior of them
hosting many TLD+3 on one FQDN, which we quantify as
#FQDNs/#TLD+3, as shown in Figure 9(d). Even though
the labeled clean and malicious sub-allocations have fewer
footprints of this pattern, we ﬁnd through manual samples that
the conﬁrmed ones are clearly showing a larger rate of TLD+3
per FQDN. This is due to our selected features that implicitly
capture such behavior.
• Future Whois de-listing: Lastly, we check the most recent
snapshot of Whois to discover whether any of the detected
sub-allocations’ records were removed from Whois, essentially
de-listing them. We ﬁnd that 3.3% of the clean, 78% of the
malicious, and 5.5% of the detected sets had been de-listed.
Further analysis showed that one hosting provider (xlhost.com)
in the clean set owned 77% of the de-listed sub-allocations
with an average size of 8 IP addresses per sub-allocation. If
we remove this one outlier from the clean set, the de-listing
percentage for the clean set drops to 0.76%.
Manual sampling. Finally, we sample sub-allocations and
manually investigate them case by case looking for evidence
of FP. Sampling is performed in two ways: First, we randomly
sample 20 sub-allocations; if we cannot tell one way or another
whether a sub-allocation is a False Positive (FP), then we
sample another. Out of 20 samples, 1 turned out to be a
false positive. Second, we sample with biases towards false
positives: speciﬁcally, we count sub-allocations that are owned
by Akamai or educational
institutions, old sub-allocations
registered before the year 2000 and sub-allocations with one
FQDN, which are 2,612 in total. If we consider all as false
positives, even though some of them actually turned out to be
compromised, the FDR would be 4%.
Duration
Processed Whois
# Sub-allocations
#ASes
#Owners
Dec 25th 2015 - Aug 21st 2016
25 Snapshots
Total: 39K
Have Owners : 28K(71.5%)
3,200
19K
TABLE X: Breakdown of the detected set of sub-allocations and their
meta data. “Have owners” refers to the number of sub-allocations who
have an owner object.
Fig. 10: CDF Comparing the performance of our classiﬁer to Whois
de-listing. We cut off the X-Axis at 1K due to the large maximum
Whois de-listing age of 17K.
At this point, we performed an extensive evaluation of both
trained classiﬁers but a model trained with Set-B has less false
positives and as such we use it for the remainder of the paper.
V. EXPLORING THE BPH ECOSYSTEM
Landscape. As described in Table VI, the average number
of selected sub-allocations for all 5 RIR is 192K per day,
which we use to scan for malicious sub-allocations for each
of the 25 processed Whois snapshots from December 2015 to
August 2016, one snapshot processed every 10 days. In order
to perform an in-depth study of the ecosystem of BPH, we
choose to forgo coverage in an effort to reduce false positives.
As such, we ran the detector trained on Set-B on the full set
and detect 39K sub-allocations in total, averaging 20K (10%)
per processed snapshot as detailed in Table X. Out of them,
17K (44%) sub-allocations were detected on the ﬁrst day,
out of which 738 were de-listed in Whois with an average
de-listing time of 1,500 days. The remaining sub-allocations
detected after the ﬁrst snapshot were detected with a delay of
130 days on average. Figure 10 compares the performance of
our detector to Whois de-listing. This high percentage of sub-
allocations that we detected as malicious sheds light on the
potential magnitude of BPH services currently operating and
using this method to evade detection.
In the proceeding section, we perform a large-scale analysis
of the BPH ecosystem through the lens of the 39K detected
sub-allocations in an effort to better understand the extent
of it8. Firstly, we look at
the role service providers play
in the ecosystem and their degree of potential complicitness
by measuring a “Recycling” rate gauging the magnitude of
network block turnover in an effort to clean up their IP address
8We point out that this analysis is likely incomplete and possibly biased, due
to the inherent limitation of our detection method. Even though our starting
point might not be fully representative of all BPH services, we argue that our
study still captures a large number of malicious sub-allocations and amount
of illicit activity.
816
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
space and avoid AS based detection methods. Next, we look
into the owners of the detected sub-allocations and trace their
hosting movements over multiple networks and highlight the
methods they employ to evade detection by spanning their
infrastructure across registries and ASes. Lastly, we explore
what illicit activities the clientele of these BPH services are
engaged in by analyzing the domains hosted on the detected
sub-allocations. We ﬁnd hosting of a variety of malicious
activities and the long time they survive due to network and/or
BPH service movements.
A. Service Providers
Overview. In total, we detected sub-allocations hosted on
3,200 ASes which we use to determine the actual service
provider who delegated the sub-allocations to clients or re-
sellers. Looking at the service providers, we ﬁnd the majority
of them fall into one of three categories; ISP, Cloud platforms
and large hosting providers with an overall majority of cloud
hosting services. Overall, we ﬁnd that 50 service providers
(ASes) account for more than half of the detected sub-
allocations. The AS with the most detected sub-allocations
was “PEG TECH INC” hosting 7% of the detected sub-
allocations. Incidentally, we detected 50% of all of this AS’s
sub-allocations and found many online reports indicating a
pattern of ignoring abuse complaints and hosting malicious
clients, speciﬁcally spammers. Another highly ranked AS in
our detected set is “VPSQuan LLC” which we detect 37% of
its sub-allocations hosting many abusive short-lived TLD+3
running brute force tools, vulnerability scanning, scams and a
long list of other abusive activities, a sample of them is shown
in Table XIX in Appendix. Interestingly, we detected 717 sub-
allocations delegated by “Psychz Networks” accounting for
20% of all their owners and sub-allocations and again found
excessive amounts of ignored abuse complaints. Additionally,
we detect sub-allocations from ASes reported in prior work
from OpenDNS [35] such as “King Servers”. A detailed list
of the top 15 ASes in our detected set is provided in Table XI.
Recycling. By manually investigating a few service providers
we found a pattern of some likely more complicit service
providers actively rotating sub-allocated network blocks. This
was possibly done to avoid blacklisting and to clean up the
IP addresses’ reputation by delegating the network blocks to
legitimate services. In an effort to quantify this behavior, we
deﬁne a “Recycling” rate to capture the frequency of network
block delegation while accounting for the cases of legitimate
business expansion. To this end, we track and count the number
of network blocks added and dropped for each processed
snapshot starting from December 2015 to August 2016 and
compute a recycling rate per snapshot for each AS as follows,
# of N etwork Blocks Added + # of N etwork Blocks Dropped
T otal N umber of Blocks
An overall average (for all 25 snapshots) is then computed
per AS. Table XII details ASes with the highest recycling
rate in our data. Additionally, we compute an average life
of dropped networks blocks per AS and ﬁnd that over all
ASes, dropped network blocks survived for an average of
120 days. Interestingly, the ASes described above such as
“VPSQuan LLC” and “Psychz Networks” had a recycling
Fig. 11: Partial view of our collected organizational chart of
“ColoCrossing”. Dashed boxed represent conﬁrmed “ColoCrossing”
subsidiaries.
Fig. 12: Bitcoin Invoice for a purchase through “Hudson Valley Host”
showing vendor information.
rate of Zero where they did not make any efforts in hid-
ing or cleaning up the IP addresses reputation explaining
the large number of abuse complaints. On the other hand,
ASes with a high recycling rate, mostly data centers (cloud
and hosting providers), were actively moving around network
block delegations between a few owners. Furthermore, sub-
allocations delegated and recycled by data centers had a much
shorter life than those of ISPs, 121 days versus 630 days
respectively.Unfortunately, this type of behavior can reduce our
ability to detect malicious sub-allocations, since on average it
takes our classiﬁer 130 days before there is enough activity to
reach the threshold for detection.
Re-branding. Taking it a step further, we manually investigate
one AS, “ColoCrossing”, that had a reputation of chronic
abuse 9. “ColoCrossing” ranked number 15 in our list of ASes
with the highest recycling rates. On average, “ColoCrossing”
has a 3.5% recycling rate and a network block lifespan of 200
days. From our manual investigation and active interactions
that
include purchases from “ColoCrossing”, we found a
network of hosting providers and resellers that are owned by
the same parent company. In addition to recycling network
block delegations, we uncovered a pattern of re-branding and
creation of many subsidiaries with different ASes. This organi-
zation would then move around network blocks between ASes
that were originally assigned by IANA[36] to “ColoCrossing”
and its parent company “Velocity Servers”. More speciﬁcally,
Figure 11 shows “ColoCrossing” and some of the organizations
with network block delegations. We found network blocks
often delegated to subsidiaries and resellers (either directly
or through subsidiaries). Some of these companies turned
out to be subsidiaries and resellers owned and operated by
“ColoCrossing” which we conﬁrmed either through a payment
chain or contact information. More speciﬁcally, we contacted
“Hudson Valley Host” to purchase a reseller package and chose
to pay by Bitcoin. The invoice generated through the CoinBase
processing center showed the vendor to be “Velocity Servers”
with the address of “ColoCrossing” as shown in Figure 12.
Additionally, “ServerMania” and “Chicago VPS” had corre-
sponding Whois records with shared contact information, an
email that was the same as that used by “Hudson Valley Host”.
9https://twitter.com/spamhaus/status/480312720697606144
817
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
#
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
ASN
AS Rank
AS Name
Type
Coverage
54600
11282
15003
18779
7018
40676
9737
6830
38197
5089
62468
53755
16637
33387
16276
1.0001986502155999
1.00006433491671
1.0003085292176701
1.0000193998423199
1.0000025631946801
1.00020731537693
1.0000083869796701
1.00000183689402
1.00009391599797
1.00000341462089
1.00056983197815
1.00008892325846
1.00000709622196
1.00132969982845
1.0008670717274699
Peg Tech Inc.
YUNM
Ubiquity
Energy Group
AT&T
Psychz
TOT
Liberty Global
Sun Network HK
Virgin Media
VPS Quan
IOFlood
MNT Network
NOCIX
OVH
DC
DC
HP
HP
ISP
HP
ISP
ISP
ISP
ISP
HP
HP
ISP
HP
DC
7.69%
4.81%
2.62%
2.42%
2.13%
1.95%
1.86%
1.58%
1.54%
1.42%
1.12%
1.03%
0.98%
0.85%
0.78%
Recycling
Rate
0.00%
0.00%
0.38%
0.03%
0.24%
0.36%
2.57%
0.11%
0.20%
2.36%
0.00%
0.14%
0.01%
0.02%
1.83%
#Detected
Sub-allocations(%)
2835(51.46%)
1771(49.80%)
967(31.66%))
892(8.40%)
785(0.06%)
717(21.69%)
687(71.04%)
581(1.03%)
569(32.74%)
525(1.06%)