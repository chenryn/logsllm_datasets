Md Sohail Ahmad
Md Sohail Ahmad
Prabhash
Prabhash Dhyani
Dhyani
AirTight Networks
AirTight Networks
www.airtightnetworks.com
www.airtightnetworks.com
Wi-Fish Finder:
Who will bite 
the bait?
There is >50 % chance that 
your laptop will!
© AirTight Networks 2009
Submitted to DEFCON 17
About the Speaker
 Last year brought to you 
Autoimmunity Disorder in Wireless 
LANs at Defcon 16
http://www.defcon.org/html/defcon-16/dc-16-
speakers.html#Ahmad
 The year before served you Caffe
Latte at Toorcon 9
http://www.toorcon.org/2007/event.php?id=25
© AirTight Networks 2009
Submitted to DEFCON 17
What Motivated This Presentation
 A lot has been written and said about dangers of using OPEN 
and WEP based WiFi networks
 Yet, level of awareness about WiFi vulnerabilities is still very
low. A recent study by AirTight Networks in April 2009
http://www.airtightnetworks.com/home/resources/knowledge-center/financial-
districts-scanning-report.html
 56 % Clients were found to be probing for one or more 
SSIDs
 13 % Clients were found probing for OPEN ad hoc 
networks
Most users are vulnerable, yet they are 
unaware
© AirTight Networks 2009
Submitted to DEFCON 17
Perhaps Showing Them a Mirror Will Help…
Wi-Fish Finder is a tool for 
1.
Discovering active WiFi clients
2.
Finding networks they are 
probing for
3.
Finding security settings of the 
probed network
1,2 has been done before
What’s cool? --- Step 3
What needs attention? – clients which 
only connect to WPA, WPA2 
networks can also be vulnerable!
© AirTight Networks 2009
Submitted to DEFCON 17
Network Name Leakage from WiFi Cards
WiFi enabled roaming clients normally leak the name of the networks they have 
been connecting to in the past
−Some of these networks could be Open or WEP and leaves client vulnerable 
to Honeypot style attacks
© AirTight Networks 2009
Submitted to DEFCON 17
Can Security Mode of Each Probed Network 
(OPEN, WEP, WPA or WPA2) be Determined?    
WiFi enabled laptop keeps memory of various WiFi networks it has
connected to in the past
If correct security setting of each probed SSID 
can be determined then a matching honeypot
can be instantly created!
© AirTight Networks 2009
Submitted to DEFCON 17
Yes, it is possible! 
Security of a 
Probed SSID
Security 
posture
Probed SSID
© AirTight Networks 2009
Submitted to DEFCON 17
How?
We will discuss details of Wi-Fish Finder 
during presentation
We will also do a Live Demo of Wi-Fish 
Finder
© AirTight Networks 2009
Submitted to DEFCON 17
Important Points
 If the probed SSID list contains at least one OPEN network
 A simple OPEN honeypot will do the trick
 Else, if the probed SSID list containst at least one WEP 
network
 Caffe Latte will do the trick
 Else, if the probed SSID list contains only WPA-PSK networks
 Honeypot attack still possible! (see the next slide)
 Else, if the probed SSID list contains only WPA2 network
 Honeypot attack still possible in some cases (see the next 
slide)
© AirTight Networks 2009
Submitted to DEFCON 17
The Latest Advancement In Dictionary Attack Tool
 To run dictionary attack all we 
need is 4 way EAPOL handshake 
packets
 Thanks to Thomas 
D’Otreppe latest aircrak-ng
doesn’t require all 4 
handshake frames
 Disclosure in UNAM, Mexico 
City November 27-28, 2008
Default
Default
 Windows caches the Passphrase or 
Pre-Shared Key of networks in its 
PNL
4-Way Handshake
A Nonce
SNonce +MIC
GTK+MIC
Ack
AP
STA
© AirTight Networks 2009
Submitted to DEFCON 17
WPA/WPA2-PSK Clients can be targeted: Attack 
Choreography
A Nonce
SNonce +MIC
Attacker
Genuine STA
Client and AP 
establish connection
Attacker runs dictionary attack and 
retrieves “Passphrase”
Client and AP 
establish connection
SNonce +MIC
GTK+MIC
Ack
A Nonce
Data Transfer
 Attacker collects first two frames of 
4-way handshake by setting-up a 
fake access point and luring client 
to connect to it
 Passphrase is retrieved by 
launching dictionary attack using 
latest aircrack-ng tool
 AP is again configured with correct 
Passphrashe (PSK)
 This time client is successfully able 
to complete the 4-way handshake
 Client machine now gets connected 
to attacker’s machine
© AirTight Networks 2009
Submitted to DEFCON 17
Conclusion
 While lot of measures have been taken to secure WiFi 
infrastructure (both APs and Client in the vicinity) by following 
best practices and deploying various forms of WIPS solution, 
WiFi enabled devices are still need adequate security cover
 An infected laptop can be serious security threat to an 
organization as it can lead to an attack, recently, uncovered 
by SANS
Newest WLAN Hacks Come From Afar
http://darkreading.com/security/vulnerabilities/showArticle.jhtml;jsessionid=2Y42ER3MPBL2
OQSNDLOSKHSCJUNN2JVN?articleID=217100332
 WiFish Finder is a perfect tool to reflect the security posture of 
a WiFi enabled client devices and could be used to assess 
their security risk level
© AirTight Networks 2009
Submitted to DEFCON 17
…Food For Thought
Hidden SSID of an Access Point can be discovered in a 
matter of seconds
If a client is not broadcasting SSID in probes        
Can it’s PNL be guessed !
Hint: Dictionary Attack ! 
Questions?
Md Sohail Ahmad
PI:EMAIL
PI:EMAIL
Prabhash Dhyani
PI:EMAIL
AirTight Networks 
www.airtightnetworks.com