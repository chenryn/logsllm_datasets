analf.net
pro-buh.ru
ammdamm.cn
briannazfunz.com
mybank-of.com
oc00co.com
avangadershem.com
securebizccenter.cn
adobe-updating-service.cn
0md.ru
avrev.info
g00glee.cn
IP
213.182.197.229
222.186.31.169
89.108.67.83
92.241.162.55
95.205.116.55
59.125.229.73
212.117.165.128
195.88.190.29
122.70.145.140
59.125.231.252
219.152.120.118
98.126.15.186
218.93.202.100
Date
08-15
08-15
08-15
08-15
08-15
08-15
08-15
08-19
08-19
09-02
09-19
09-27
09-02
IP
Domain Name
lzwn.in
3b9.ru
antivirprotect.com 64.40.103.249
1speed.info
212.117.163.165
spy-destroyer.com 67.211.161.44
free-spybot.com
63.243.188.110
a3l.at
89.171.115.10
gidromash.cn
211.95.79.170
iantivirus-pro.com 188.40.52.180
ericwanhouse.cn
220.196.59.19
1165651291.com
212.117.165.126
Type
MAL
94.23.198.97
213.251.176.169 MAL
RAV
CWS
CWS
RAV
MAL
BOT
KBF
EXP
RAV
Src
[1]
[2]
[3]
[2]
[4]
[2]
[2]
[2]
[5]
[6]
[2]
Date
08-26
08-30
09-05
09-05
09-05
09-05
09-09
09-13
09-19
09-22
10-06
Table 1. Sample cases form Zeus domains de-
tected by Notos and the corresponding days
that appeared in the public BLs. All evidence
information in this table were harvested from
zeustracker.abuse.ch.
Table 2. Anecdotal cases of malicious domain
names detected by Notos and the correspond-
ing days that appeared in the public BLs .[1]:
hosts-ﬁle.net, [2]: malwareurl.com, [3] siteadvisor.com, [4]
virustotal.com, [5] ddanchev.blogspot.com, [6] malwaredo-
mainlist.com
6 Conclusion
In this paper, we presented Notos, a dynamic reputation
system for DNS. To the best of our knowledge, Notos is the
ﬁrst system that can assign a dynamic reputation score to any
domain name in a DNS query that traverses the edge of a
monitored network. Notos harvests information from multiple
sources such as the DNS zone domain names belongs to, the
related IP addresses, BGP preﬁxes, AS information and hon-
eypot analysis to maintain up-to-date DNS information about
legitimate and malicious domain names. Based on this infor-
mation, Notos uses automated classiﬁcation and clustering al-
gorithms to model network and zone behaviors of legitimate
and malicious domains, and then applies these models to com-
pute a reputation score for a (new) domain name.
Our evaluation using real-world data, which includes traf-
ﬁc from large ISP networks, demonstrates that Notos is highly
accurate in identifying new malicious domains in the moni-
tored DNS query trafﬁc, with a true positive rate of 96.8% and
false positive rate of 0.38%. In addition, Notos is capable of
identifying these malicious domain weeks or even months be-
fore they appear in public blacklists, thus enabling proactive
security countermeasures against cyber attacks.
7 Acknowledgments
We thank Steven Gribble, our shepherd, for helping us to
improve the quality of the ﬁnal version of this paper, and
the anonymous reviewers for their constructive comments.
We also thank Gunter Ollmann and Robert Edmonds for
their valuable comments. Additionally, we thank the Internet
Security Consortium Security Information Exchange project
(ISC@SIE) for providing portion of the DNS data used in our
experiments.
This material is based upon work supported in part by
the National Science Foundation under grant no. 0831300,
the Department of Homeland Security under contract no.
FA8750-08-2-0141, the Ofﬁce of Naval Research under grants
no. N000140710907 and no. N000140911042. Any opinions,
ﬁndings, and conclusions or recommendations expressed in
this material are those of the authors and do not necessarily
reﬂect the views of the National Science Foundation, the De-
partment of Homeland Security, or the Ofﬁce of Naval Re-
search.
References
[1] D. Anderson, C. Fleizach, S. Savage, and G. Voelker.
Spamscatter: Characterizing internet scam hosting in-
frastructure.
In Proceedings of the USENIX Security
Symposium, 2007.
[2] L. Breiman. Bagging predictors. Machine learning,
24(2):123–140, 1996.
[3] Internet Systems Consortium. SIE@ISC : Security Infor-
mation Exchange. https://sie.isc.org/, 2004.
[4] A. Dinaburg, R. Royal, M. Sharif, and W. Lee. Ether:
malware analysis via hardware virtualization extensions.
In ACM CCS, 2008.
[5] SORBS DNSBL. Fighting spam by ﬁnding and list-
ing Exploitable Servers. http://www.us.sorbs.
net/, 2007.
[6] R. Duda, P. Hart, and D. Stork. Pattern Classiﬁcation.
Wiley-Interscience, 2nd edition, 2000.
[7] M. Felegyhazi, C. Keibich, and V. Paxson. On the poten-
tial of proactive domain blacklisting. In Third USENIX
LEET Workshop, 2010.
[22] S. Shevchenko. Srizbi Domain Generator Calculator.
http://blog.threatexpert.com/2008/11/
srizbis-domain-calculator.html, 2008.
[23] K. Sato, K. Ishibashi, T. Toyono, and N. Miyake. Ex-
tending black domain name list by using co-occurrence
relation between dns queries.
In Third USENIX LEET
Workshop, 2010.
[24] S. Sinha, M. Bailey, and F. Jahanian. Shades of grey: On
In 3rd
the effectiveness of reputation-based blacklists.
International Conference on MALWARE, 2008.
[25] The Honeynet Project & Research Alliance. Know Your
Enemy: Fast-Flux Service Networks. http://old.
honeynet.org/papers/ff/fast-flux.html,
2007.
[26] URIBL. Real time URI blacklist. http://uribl.
com.
[27] F. Weimer. Passive DNS replication. In Proceedings of
FIRST Conference on Computer Security Incident, Hand
ling, Singapore, 2005.
[28] Z. Qian, Z. Mao, Y. Xie and F. Yu. On network-
level clusters for spam detection. In Proceedings of the
USENIX NDSS Symposium, 2010.
[29] B. Zdrnja, N. Brownlee, and D. Wessels. Passive mon-
In Proceedings of DIMVA
itoring of DNS anomalies.
Conference, 2007.
[30] Zeus Tracker. Zeus IP & domain name block list.
https://zeustracker.abuse.ch, 2009.
[31] J. Zhang, P. Porra, and J. Ullrich. Highly predictive
In Proceedings of the USENIX Security
blacklisting.
Symposium, 2008.
[8] S. Garera, N. Provos, M. Chew, and A. Rubin. A frame-
work for detection and measurement of phishing attacks.
In Proceedings of the ACM WORM. ACM, 2007.
[9] B. Gross, M. Cova, L. Cavallaro, B. Gilbert, M. Szyd-
lowski, R. Kemmerer, C. Kruegel, and G. Vigna. Your
botnet is my botnet: analysis of a botnet takeover.
In
ACM CCS 09, New York, NY, USA, 2009. ACM.
[10] T. Holz, C. Gorecki, K. Rieck, and F. Freiling. Measur-
ing and detecting fast-ﬂux service networks. In Proceed-
ings of NDSS, 2008.
[11] T. Hothorn and B. Lausen. Double-bagging: Combining
classiﬁers by bootstrap aggregation. Pattern Recogni-
tion, 36(6):1303–1309, 2003.
[12] P. Mockapetris. Domain names - concepts and fa-
cilities. http://www.ietf.org/rfc/rfc1034.
txt, 1987.
[13] P. Mockapetris.
Domain names - implementation
and speciﬁcation. http://www.ietf.org/rfc/
rfc1035.txt, 1987.
[14] OPENDNS. OpenDNS — Internet Navigation And Se-
curity. http://www.opendns.com/, 2010.
[15] P. Porras, H. Saidi, and V. Yegneswaran. An Analysis
of Conﬁcker’s Logic and Rendezvous Points. http:
//mtc.sri.com/Conficker/, 2009.
[16] R. Perdisci, W. Lee, and N. Feamster. Behavioral cluster-
ing of http-based malware and signature generation using
malicious network traces. In USENIX NSDI, 2010.
[17] D. Plonka and P. Barford. Context-aware clustering of
DNS query trafﬁc. In Proceedings of the 8th IMC, Vou-
liagmeni, Greece, 2008. ACM.
[18] The Spamhaus Project. ZEN - Spamhaus DNSBLs.
http://www.spamhaus.org/zen/, 2004.
[19] R. Perdisci, I. Corona, D. Dagon, and W. Lee. Detecting
malicious ﬂux service networks through passive analy-
sis of recursive DNS traces. In Proceedings of ACSAC,
Honolulu, Hawaii, USA, 2009.
[20] P. Royal.
Analysis
of
the
kraken
botnet.
http://www.damballa.com/downloads/
r_pubs/KrakenWhitepaper.pdf, 2008.
[21] S. Hao, N. Syed, N. Feamster, A. Gray and S.
Krasser. Detecting spammers with SNARE: Spatio-
temporal network-level automatic reputation engine. In
Proceedings of the USENIX Security Symposium, 2009.