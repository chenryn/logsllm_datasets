the single-label, unqualified domain name based on the state of the Append primary and connection 
specific DNS suffixes or Append these suffixes check boxes on the DNS tab in the Advanced 
TCP/IP Settings dialog box of the Internet Protocol Version 4 (TCP/IPv4) or Internet Protocol (TCP/IP) 
component. 
If the Append primary and connection specific DNS suffixes check box is selected, the resolver 
appends the following names and sends separate queries: 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 249 
The primary DNS suffix, as specified on the Computer Name tab of the System item of Control Panel.  
Each connection-specific DNS suffix, assigned either through DHCP or specified in the DNS suffix for 
this connection box on the DNS tab in the Advanced TCP/IP Settings dialog box for each 
connection.  
If resolution is still not successful and the Append parent suffixes of the primary DNS suffix check 
box is selected, the resolver creates new FQDNs by appending the single-label, unqualified domain 
name with the parent suffix of the primary DNS suffix name, and the parent of that suffix, and so on, 
stopping at the second-level domain name. This process is known as name devolution. For example, if 
the application specified the name emailsrv7 and the primary DNS suffix is central.example.com., the 
resolver tries to resolve the FQDNs of emailsrv7.central.example.com. and emailsrv7.example.com. 
If resolution is still not successful and the Append these suffixes check box is selected, the resolver 
appends each suffix from the search list in order and submits the FQDN to the DNS server until the 
resolver finds a match or reaches the end of the list. For example, if the application specified the name 
filesrv11 and the DNS suffix list consists of admin.wcoast.example.com., admin.ecoast.example.com., 
and admin.central.example.com., the resolver tries the FQDNs of 
filesrv11.admin.wcoast.example.com., filesrv11.admin.ecoast.example.com., and 
filesrv11.admin.central.example.com. 
Name Resolution for Multiple-Label, Unqualified Domain Names 
When an application specifies a multiple-label, unqualified domain name, the DNS resolver uses the 
same process as that for a single-label, unqualified domain name to resolve the name. 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 250 
The DNS Server Service 
The DNS Server service in Windows Server 2008 and Windows Server 2003 supports the following 
features: 
An Internet standards-compliant DNS server  
DNS is an open protocol and is standardized by a set of Internet Engineering Task Force (IETF) 
RFCs. The DNS Server service in Windows Server 2003 supports and complies with these 
standard specifications. 
Interoperability with other DNS server implementations  
Because the DNS Server service is RFC-compliant and uses standard DNS data file and resource 
record formats, it can successfully work with most other DNS server implementations, such as 
those that use the Berkeley Internet Name Domain (BIND) software. 
Support for Active Directory  
DNS is required to support Active Directory. If you make a server an Active Directory domain 
controller, you can automatically install and configure the DNS Server service on that server. 
Enhancements to DNS zone storage in Active Directory  
DNS zones can be stored in the domain or application directory partitions of Active Directory. A 
partition is a data structure stored in Active Directory that is used for different replication purposes. 
You can specify in which Active Directory partition to store the zone and, consequently, the set of 
domain controllers among which the zone's data is replicated. 
Conditional forwarding  
The DNS Server service extends standard forwarder support with additional capability as a 
conditional forwarder. A conditional forwarder is a DNS server that forwards DNS queries according 
to the DNS domain name in the query. For example, you can configure a DNS server to forward all 
the queries it receives for names ending with wcoast.example.com to one or multiple DNS servers. 
Stub zones  
DNS supports a new zone type called a stub zone, which is a copy of a zone that contains only the 
resource records required to identify the authoritative DNS servers for that zone. A DNS server that 
hosts a parent zone and a stub zone for one of the parent zone's delegated child zones can receive 
updates from the authoritative DNS servers for the child zone. 
Integration with other Microsoft networking services  
The DNS Server service offers integration with other services and contains features beyond those 
specified in the DNS RFCs. These include integration with Active Directory, WINS, and DHCP. 
Improved ease of administration  
The DNS snap-in offers a graphical user interface for managing the DNS Server service. Also, you 
can use several configuration wizards to perform common tasks for administering servers. 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 251 
You can also use the Dnscmd command-line tool to perform most of the tasks that you can perform 
from the DNS snap-in. You can also use Dnscmd to write scripts and administer remote DNS 
servers. 
RFC-compliant support for the DNS dynamic update protocol  
The DNS Server service allows clients to dynamically update address and pointer resource records, 
based on the DNS dynamic update protocol that RFC 2136 defines. DNS dynamic update 
eliminates the administration associated with manually managing DNS address and pointer 
records. Computers running Windows can dynamically register their DNS names and IP addresses. 
Support for secure dynamic updates in zones that are integrated with Active Directory 
You can configure zones that are integrated with Active Directory for secure dynamic update. With 
secure dynamic update, only authorized computers can make changes to a resource record. 
Support for incremental zone transfer between servers  
DNS servers use zone transfers to replicate information about a portion of the DNS namespace. 
The DNS Server service uses incremental zone transfers to replicate only the changed portions of a 
zone, conserving network bandwidth. 
Support for new resource record types  
The DNS Server service includes support for several new resource record (RR) types, such as 
service location (SRV) and Asynchronous Transfer Mode address (ATMA) resource records. These 
types expand the use of DNS as a name database service. 
Support for aging and scavenging of records 
The DNS service is capable of aging and scavenging records. When enabled, this feature can 
remove stale records from DNS. 
The DNS Server service in Windows Server 2008 supports the following additional features: 
Background zone loading 
Enhancements to support IPv6 
Support for read-only domain controllers (RODCs) 
The ability to host global single-label names 
For more information, see DNS Enhancements in Windows Server 2008. 
Installing the DNS Server Service 
You can install the DNS Server service in Windows Server 2003 in the following ways: 
As a Windows component using the Add or Remove Programs item of Control Panel (Windows Server 
2003). 
Using the Active Directory Installation Wizard (Dcpromo.exe). 
Using the Manage Your Server Wizard (Windows Server 2003). 
Using the Server Manager snap-in (Windows Server 2008) 
To install the DNS Server service with Server Manager in Windows Server 2008, do the following: 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 252 
1. Click Start, point to Programs, point to Administrative Tools, and then click Server Manager. 
2. In the console tree, right-click Roles, click Add Roles, and then click Next. 
3. On the Select Server Roles page, select the DNS Server check box, and then click Next. 
4. Follow the pages of the Add Roles wizard to perform an initial configuration of the DNS Server 
service. 
To install the DNS Server service with Add or Remove Programs in Windows Server 2003, do the 
following: 
1. Click Start, click Control Panel, double-click Add or Remove Programs, and then click 
Add/Remove Windows Components. 
2. In Components, select the Networking Services check box, and then click Details.  
3. In Subcomponents of Networking Services, select the Domain Name System (DNS) check box, 
click OK, and then click Next.  
4. If prompted, in Copy files from, type the full path to the distribution files for Windows Server 2003, 
and then click OK.  
To install the DNS Server service, you must be logged on as a member of the Administrators group on 
the local computer, or you must have been delegated the appropriate authority. If the computer is joined 
to a domain, members of the Domain Admins group might be able to perform this procedure. 
After you install the DNS Server service, you can decide how to configure it and its zones. Local text 
files contain information about zones and the boot process for the DNS Server service, and you can 
use a text editor to update that information. However, this method is not described in this chapter. The 
DNS snap-in and the Dnscmd command-line tool simplify maintenance of the DNS Server service, and 
you should use them whenever possible. After you begin to use snap-in-based or command-line 
management of the DNS Server service, manually editing the text files is not recommended.  
DNS and Active Directory 
DNS and Active Directory are integrated to provide a location service for Active Directory operations 
and to store DNS zones in Active Directory, taking advantage of Active Directory security and 
replication.  
A directory is a hierarchical structure that stores information about objects on the network. A directory 
service, such as Active Directory, provides the methods for storing directory data and making this data 
available to network users and administrators. For example, Active Directory stores information about 
user accounts such as names, locations, phone numbers, and so on, and Active Directory enables 
authorized users on the same network to access this information.  
Active Directory Location Service 
Active Directory requires the use of DNS to store various types of DNS resource records so that Active 
Directory clients and domain controllers can locate one another and perform various types of domain 
operations.  
For example, an Active Directory client that starts up uses DNS queries to locate the nearest Active 
Directory domain controller in its site to perform logon and authentication functions. To facilitate this 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 253 
location service for Active Directory clients, the following records must exist in the DNS servers that the 
Active Directory clients use: 
the _ldap._tcp.dc._msdcs.DNSDomainName service (SRV) resource record 
the address (A) resource records for the DNS names of the domain controllers specified in the data 
field of the _ldap._tcp.dc._msdcs.DNSDomainName SRV resource records 
These records are automatically added when you install a DNS server using the Active Directory 
Installation Wizard. 
Storage of Zones Integrated with Active Directory 
After you have installed Active Directory, you have two options for storing and replicating your zones 
when the DNS Server service is running on a domain controller: 
Standard zone storage, using a text-based file.  
Zones are located in .Dns files that are stored in the systemroot\System32\Dns folder. Zone file 
names correspond to the zone root name. For example, the wcoast.example.com. domain uses the 
wcoast.example.com.dns file.  
Directory-integrated zone storage, using the Active Directory database.  
Zones are located in the Active Directory tree under the domain or application directory partition. 
Each directory-integrated zone is stored in a dnsZone container object that corresponds to the zone 
root name. 
For networks deploying DNS to support Active Directory, directory-integrated primary zones are 
strongly recommended and provide the following benefits: 
Zones have multimaster update and enhanced security based on the capabilities of Active Directory.  
In a standard zone storage model, DNS updates are conducted based on a single-master update 
model. In this model, a single authoritative DNS server for a zone is designated as the primary 
server for the zone, and that server maintains the master copy of the zone in a local file. With this 
model, the primary server for the zone represents a single fixed point of failure. If this server is not 
available, update requests from DNS clients are not processed for the zone. 
With directory-integrated storage, updates to DNS are conducted based on a multimaster update 
model. In this model, any authoritative DNS server, such as a domain controller running a DNS 
server, is designated as a primary source for the zone. Because the master copy of the zone is 
maintained in the Active Directory database, which is fully replicated to all domain controllers, the 
DNS servers operating on any domain controller for the domain can update the zone. 
Zones are replicated and synchronized to new domain controllers automatically whenever a zone is 
added to an Active Directory domain.  
Although you can selectively remove the DNS Server service from a domain controller, directory-
integrated zones are already stored at each domain controller, so zone storage and management is 
not an additional resource. Also, the methods used to synchronize directory-stored information offer 
performance improvement over standard zone update methods, which can potentially require 
transfer of the entire zone. 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 254 
By integrating storage of your DNS zone databases in Active Directory, you can streamline database 
replication planning for your network.  
When your DNS namespace and Active Directory domains are stored and replicated separately, 
you need to plan and potentially administer each separately. For example, when using standard 
DNS zone storage and Active Directory together, you would need to design, implement, test, and 
maintain two different database replication topologies. You need one replication topology for 
replicating directory data between domain controllers, and you need another topology for replicating 
zone databases between DNS servers. With integrated DNS zone storage in Active Directory, you 
must design and maintain only an Active Directory replication. 
Directory replication is faster and more efficient than standard DNS replication.  
Because Active Directory replication processing is performed on a per-property basis, only relevant 
changes are propagated. Therefore, directory-stored zones require less traffic to synchronize 
changes across the replication topology. 
Only primary zones can be stored in the directory. A DNS server cannot store secondary zones in 
Active Directory. It must store them in standard text files. The multimaster replication model of 
Active Directory removes the need for secondary zones when all the zones are stored in Active 
Directory. When all of the DNS servers in your organization are also domain controllers, all of your 
DNS servers are primary servers for all of your zones. 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 255 
DNS Server Service Configuration 
The configuration of the DNS Server service consists of a set of properties for the DNS server and 
forward and reverse lookup zone files. 
Properties of the DNS Server 
To modify the properties of a DNS server, open the DNS snap-in, right-click the name of the server in 
the tree, and then click Properties. Figure 9-5 shows an example of the resulting ServerName 
Properties dialog box. 
Figure 9-5  The properties dialog box for a DNS server 
From this dialog box, you can configure properties on the following tabs: 
Interfaces  You can specify the IPv4 or IPv6 addresses on which the DNS Server service is listening 
for incoming DNS messages. You can specify all the IPv4 or IPv6 addresses assigned to the DNS 
server, or you can specify individual addresses (and, therefore interfaces) on which you want to receive 
DNS traffic as a DNS server. 
Forwarders  You can specify the forwarding behavior of this DNS server including the ability to forward 
based on a specific domain name (conditional forwarding), the list of IP addresses to which the server 
should forward DNS traffic, timeout behavior, and whether to use recursive queries for each domain. 
Advanced  You can enable various options (such as round robin and subnet prioritization), the data 
format for checking names, the location of zone data (Active Directory or local files), and scavenging 
settings. 
Root Hints  You can configure the set of root domain servers that this DNS server uses during iterative 
queries. Changes that you make on the Root Hints tab are updated in the Cache.dns file, which is 
stored in the systemroot\System32\Dns folder. Using the Root Hints tab is the recommended method 
of maintaining the list of root domain servers, rather than using a text editor to modify the Cache.dns 
file. 
Chapter 9 – Windows Support for DNS 
TCP/IP Fundamentals for Microsoft Windows  
Page: 256 
Debug Logging  You can enable and configure various options for the DNS debug log file, which you 
can use when troubleshooting DNS issues. The DNS debug log file is stored in 
systemroot\System32\Dns\Dns.log. By default, debug logging is disabled. 
Event Logging  You can specify the level of logging for information stored in the DNS event log, which 
you can view with the Event Viewer snap-in. By default, logging is enabled for all events. 
Monitoring  You can perform simple diagnostic functions to ensure the correct configuration and 
operation of the DNS server, such as performing recursive and iterative queries and electing to run 
them as needed or at a specified interval.  
Security  You can specify access control lists (ACLs) for DNS server administration. For more 
information about ACLs, see Help and Support for Windows Server 2008 or Windows Server 2003. 
Maintaining Zones 
You can use the DNS snap-in to administer two main types of zones: 
Forward lookup zones 