制重命名）、内容、格式进行合规检测，同时关闭上传文件夹执行权
限。
5. 管理后台排查
攻击者最习惯的渗透方式就是直接找网站的管理后台，通过暴力
破解、撞库、默认用户名及密码或者后台指纹漏洞收集等方式进行攻
击。一旦攻击成功，即可直接取得网站所有权限。原则上管理后台不
得联网，但有些运维人员为了方便还是会把管理后台发布在互联网
上。
处置建议如下。
1）进行安全制度约束，禁止将任何互联网系统后台发布在互联网
上。
2）定期通过人工或脚本扫描本单位互联网发布系统后台的管理路
径，一旦发现，通报关闭。
8.5.2 网络侧防御
从实战来看，安全的网络架构、部署得当的防护和监控设备、合
理的安全域划分、域之间的访问控制被证明是有效安全防护的基础。
网络侧的安全防护应注意以下几点。
1. 网络路径梳理
网络环境复杂的单位应定期梳理所有外部系统接入本单位内部网
络的网络路径，并给出网络路径图。通过网络路径梳理判断攻击者可
能的攻击路径，并尽可能在所有攻击路径上部署安全防护设备和安全
检测设备，避免攻击路径梳理不全面造成监控缺失，进而导致核心或
目标系统被攻陷或对于攻击发现不及时。
处置建议如下。
1）外部系统网络连接必须将外联区域作为唯一路径，其他路径一
律禁止。
2）本单位广域专网和互联网区域互联最好通过网闸连接，广域专
网不得上互联网。
3）与下属单位广域专网连接路径一定要部署防护设备和安全监控
设备。
2. 安全的网络架构
合理的网络架构是安全防护、限制攻击路径、防止攻击范围蔓延
的天然屏障。一个好的网络架构应包含如下几方面。
1）可控的、规划合理的互联网发布出口。互联网终端区最好与服
务器区物理隔离，不共用互联网出口。
2）合理的安全域划分，必须建立外连区，所有外部接入网络必须
经由外连区唯一路径接入，形成清晰可控的与其他网络互联的网络路
径。外连区应具有和服务器区同等的防护水平。单独划分业务系统测
试区，并严格控制测试区和生产服务器区的数据互通情况，最好进行
物理隔离。
3）完善的各个网络接入路径与安全域间竖向和横向的安全防护措
施。
4）合理安全的域间访问控制策略。在原有安全域的基础上，应明
确互联网接入区、外连区、安全管理区、终端区、服务器区和测试区
之间的互联关系。
5）内网终端不可上互联网，访问内网服务应通过代理。
6）安全管理区最好采用带外管理，和业务数据分开。
3. 访问控制
合理、有效的域间访问控制被证明是最好的防护和防内网蔓延手
段，各个安全域间须根据业务需要对访问的地址、服务严格按照最小
原则配置防火墙安全策略。一般的访问控制根据安全级别、数据传输
业务的不同分为如下几种。
1）逻辑物理隔离系统间访问控制：一般建议生产专网和可上互联
网网络间采取这种控制方式；通过代理数据摆渡的方式进行数据传
输，隐藏专网内部结构，数据传输路径可控。
2）单项数据传输访问控制：一般是数据上传和数据拉取时采用的
访问控制模式，防火墙只需要配置单项传输的目标IP、源IP、端口或
协议通过即可。
3）双向数据访问访问控制：一般只有对内或对外提供的业务服务
才会产生双向数据访问，此时只需要按照最小原则开通对外开放的
IP、端口或协议即可。如需更严格，则可根据业务提供的时间进行基
于时间的访问控制策略。
8.5.3 主机侧防御
做好主机侧的安全防御是防止攻击者提权、横向渗透、后渗透持
续控制的最有效安全手段。主机侧防御的技术关键点主要有以下几
个。
1. 及时安装漏洞补丁
操作系统及安装软件的漏洞是攻击者用来控制主机、提权、上传
后门软件、抓取密码的基础，目标单位须建立定期和紧急针对系统或
相关软件打安全补丁的机制。可通过和相关安全组织或安全厂商建立
威胁情报共享机制，监控本单位涉及的操作系统和软件的漏洞通报情
况。若出现紧急漏洞，则需要立即打上相关安全补丁；对于严重漏
洞，如MS17-010、MS08-067、MS06-040等可直接远程控制系统的漏
洞，需要及时安装相关补丁以防止攻击者利用；对于其他高危补丁，
可定期安装。具体建议如下：
1）本单位根据IT资产建立高危漏洞通报机制；
2）定期进行漏洞扫描，定期对产生的高危漏洞打补丁；
3）在新系统或软件上线前打全安全补丁；
4）为主机安装加固防护软件，并定期更新相关规则库；
5）安装杀毒软件，及时更新病毒库。
2. 安全加固
系统或软件不当的配置也会被攻击者利用，造成系统被入侵。单
位应建立系统和各个软件的安全配置基线，并定期更新安全配置基线
配置策略，同时对之前的安全配置进行检查和更新。安全加固建议如
下：
1）最小原则安装系统，仅安装用得到的服务或功能，其他服务或
功能不安装或关闭；
2）最小权限安装软件，禁止使用管理员权限安装软件，给安装软
件单独分配用户权限；
3）禁止使用默认配置，仅开放需要的功能，修改默认用户名和密
码；
4）系统远程登录或软件管理后台配置白名单访问；
5）关闭不安全的登录或传输协议，如Telnet登录；
6）开启安全日志记录功能。
3. 其他根据实际业务情况需要加固的加固项
（1）弱密码
弱密码口令是攻击者最喜欢的漏洞，可被直接利用，形成更深层
的数据泄露和安全漏洞。弱口令包括以下几类。
1）常见密码：如123456、1qaz2wsx、12345qwert等密码字典里肯
定会有的常见弱密码。
2）默认密码：系统或软件默认口令，如MySQL默认口令sa、ldap
默认空密码等。
3）相同口令或规则口令：管理员为了方便，一般会对一批服务器
都用一个口令或者规则口令，这为入侵者横向扩展提供了巨大的便
利。建议采用密码加动态口令的登录方式。
（2）中间件防御
1）中间件版本及漏洞。Web中间件作为Web服务发布软件直接暴露
在互联网或专网。近几年陆续爆出中间件远程代码执行高危漏洞，中
间件成为攻击者越来越喜欢利用并挖掘的攻击点，这也为中间件的安
全敲响了警钟。目前比较主流的Web中间件有WebLogic、WebSphere、
JBoss、Tomcat、Nginx等。防范该类漏洞的方式有以下几种：
① 定期打安全补丁；
② 将中间件升级到安全的版本；
③ 禁用不用的有安全问题的组件；
④ 不对外开放后台管理端口或敏感目录；
2）中间件后台。中间件后台暴露在互联网上也会引起极大风险。
一旦攻破中间件后台，攻击者可直接部署Webshell控制Web网站。中间
件后台防护手段如下：
① 禁止采用默认路径和默认端口；
② 禁止中间件后台暴露在互联网上；
③ 中间件后台在内网限制地址进行访问；
④ 禁止使用中间件默认用户名和密码；
⑤ 禁止在生产环境发布测试系统。
3）中间件配置加固。中间件的配置不当也会造成安全问题，例
如，未限制HTTP传输方式、网站目录文件任意下载、测试页面和默认
口令等都可以被攻击者利用。Web中间件安全加固建议如下：
① 修改默认的用户名和密码；
② 禁止列网站目录功能；
③ 删除测试页面；
④ 正式环境下禁止将报错文件直接返给用户；
⑤ 如无特殊需求，HTTP传输方式固定为只允许POST和GET方式；
⑥ 开启日志功能；
⑦ 上传文件夹关闭运行权限；
⑧ 中间件管理员用户名配置强口令；
⑨ 根据不同中间件特性制定加固基线。
8.5.4 Web侧防御
作为开放在外的应用系统，Web应用常常会被攻击者作为首要的攻
击目标。他们攻击的主要步骤为：第一步，获取Web权限；第二步，提
权获取系统权限；第三步，建立隐蔽通信隧道；第四步，寻找其他跳
板机；第五步，在同网段横向渗透。Web应用作为常规第一突破口，是
安全防护的重中之重。除了常规的Web防护设备和监控设备外，为了防
止黑客绕过Web检测设备，Web侧防御应参考如下几类。
1. Web安全漏洞
除了常见的Web漏洞（OWASP TOP 10）和常规渗透测试，还应注意
以下可能产生漏洞的点。
1）开发框架漏洞。出于某种原因，开发者一般都会在成熟的开发
框架上开发应用系统，不会改动开发框架的代码。这样一来，开发者
在引入开发框架的同时可能也把该开发框架的漏洞一同引入了开发的
系统。目前主流的开发框架有Struts2、Spring、ThinkPHP等。解决建