Yang Zhang and his research group (CISPA Helmholtz Center for Information Security)  
Yun Shen (Spot by NetApp) 
Azzedine Benameur (Spot by NetApp)
All Your GNN Models And Data 
Belong To Me
*All attacks discussed in this talk are simulated in the lab environment.
*
The Age of Machine Learning
Image source (from left to right): https://github.com/deepmind/alphafold https://emergetech.org/openai-gpt3-good-at-almost-everything/  https://github.com/features/copilot/signup https://imagen.research.google/
Image/Text/Video/Audio
Graph
Graphs Are Everywhere
Social Networks
Knowledge Graphs
Image source: (from left to right): https://towardsdatascience.com/ab-testing-challenges-in-social-networks-e67611c92916, https://biologydictionary.net/molecule/, https://yashuseth.blog/2019/10/08/introduction-question-answering-knowledge-graphs-kgqa/
Molecules
Graphs are combinatorial structures, have arbitrary sizes, 
and contain multi-modal information
User-Item Graphs
Graph Applications Are Everywhere
Social Networks
Knowledge Graphs
Image source: (from left to right): https://towardsdatascience.com/ab-testing-challenges-in-social-networks-e67611c92916, https://biologydictionary.net/molecule/, https://yashuseth.blog/2019/10/08/introduction-question-answering-knowledge-graphs-kgqa/
Molecules
User-Item Graphs
Link Prediction
Toxicity Prediction
Knowledge Mining
Recommendation
Alice
Bob
Do you (Alice) know Bob?
We found an item you may be interested! 
Graph-based applications pervasively exist in our everyday life 
Demographic Inference
Age group of Bob
Graph Neural Netwok (GNN)
‚Ä¢ Traditional neural networks are designed for grids (e.g., images) or sequences (e.g., text)
‚Ä¢ CNNs for images
‚Ä¢ RNNs for sequences
Graph Neural Netwok (GNN)
Graph Convolution Network (GCN)
Graph Sample and Aggregate (GraphSAGE)
Graph Isomorphism Network (GIN)
Graph Attention Network (GAT)
Link Prediction
Do you (Alice) know Bob?
Demographic Inference
Age group of Bob
Euclidean Space
Graph Neural Netwok (GNN)
Toxicity Prediction
Graph Neural Netwok (GNN)
Graph
The Age of Machine Learning
The Age of Adversarial Machine Learning
Overview
Security
Privacy
Graph
GNN
Model extraction attack
Property inference attack
Link re-identiÔ¨Åcation attack
*All attacks discussed in this talk are simulated in the lab environment.
*
Subgraph inference attack
Link Re-Identification Attack
Security
Privacy
Graph
GNN
Link re-identiÔ¨Åcation attack
Identify if two nodes are connected in the training data
Link Re-Identification Attack
Scenario
Attacker‚Äôs capability:
1. posteriors of nodes (from training data) obtained from the target model
GNN model:
Node classiÔ¨Åcation 
GNN
Security Boundary
Link Re-Identification Attack (Scenario 1)
Posterior Scores
GNN
GPU intensive
0
35
70
panda dog
cat
0
35
70
panda dog
cat
Posterior Scores
?
Private Information
Link Re-Identification Attack
Scenario
Attacker‚Äôs capability:
1. posteriors of nodes (from training data) obtained from the target model
GNN model:
Node classiÔ¨Åcation 
Posterior  
Similarity
>= Threshold
link exists
‚Ä¶
Private Graph
Property Inference Attack
Scenario
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph Embeddings
This is a graph with ~4 nodes
infer
‚Ä¶
Property Inference Attack
Scenario
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph Embeddings
Attack Model
0
40
[1-2][3-4][5-6] [7+]
0
60
[1-2]
[5-6]
Estimated
0
100
[1-2] [3-4] [5-6] [7+]
Ground Truth
0
100
[1-2] [3-4] [5-6] [7+]
Cross-entropy loss
GNN
Remote access
Graph Embeddings
Local environment
Auxiliary graphs
Property Inference Attack
Scenario
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph Embeddings
0
60
[1-2][3-4][5-6] [7+]
Estimated
Graph Embeddings
Attack Model
This is a graph with ~4 nodes
Property Inference Attack
Scenario
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph embeddings
Subgraph Inference Attack
Scenario
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph Embeddings
infer
This graph contains at least one
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
Subgraph Inference Attack
Scenario
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph embeddings
Attack model
negative pair
positive pair
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
GNN
Subgraph embeddings
Graph Embeddings
Auxiliary Graphs
GNN
Remote access
Subgraph Inference Attack
Scenario
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph embeddings
Attack Model
GNN
0
80
Positive
Negative
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
Graph Embeddings
Subgraph Inference Attack
Scenario
GNN model:
Graph classiÔ¨Åcation 
GNN
Security Boundary
Graph embeddings
Attacker‚Äôs capability:
1. Embeddings of graphs (from training data) obtained from the target model
2. Can query the GNN model
Graph embeddings
Subgraph embeddings
AUC
Analysis 
GNN
Training Graph
Prediction
Embedding
 t-SNE Projection
Link re-identiÔ¨Åcation attack 
Property inference attack
Training graph‚Äôs node posterior scores
Training graph‚Äôs graph embeddings 
Analysis
GNN
Training Graph
Prediction
Embedding
 t-SNE Projection
Link re-identiÔ¨Åcation attack 
Property inference attack
Training graph‚Äôs node posterior scores
Training graph‚Äôs graph embeddings 
Takeaways (1)
‚Ä¢ Secure your infrastructure 
‚Ä¢ Audit your GNN-based machine learning pipeline
What Is Next?
GNN
Training Graph
Prediction
Embedding
 t-SNE Projection
Overview
Security
Privacy
Graph
GNN
Model extraction attack
*All attacks discussed in this talk are simulated in the lab environment.
*
Faithfully replicate the GNN functionality
Model Stealing Attack
GNN
Training Graph
Prediction
Embedding
 t-SNE Projection
Query Graph
Downstream 
Applications
Customer
Security Boundary
Model Stealing Attack
GNN
Training Graph
Prediction
Embedding
 t-SNE Projection
Query Graph
Security Boundary
Attacker
Replicate  
the functionality
Model Stealing Attack
Scenario
Attacker‚Äôs capability:
1. Can query the GNN model via publicly accessible API
GNN model:
Node classiÔ¨Åcation 
GNN
Security Boundary
Model Stealing Attack
Node-level 
Query
‚Ä¶
GO
Target Model
Build 
Learn Discrete Graph Structure
GQ
XQ
1
ùí™( ÃÇHQ)
+ 
ÃÇHQ = ‚Ñ±(XQ, AQ)
MS
Learn Surrogate Model
2
Security Boundary
Model Stealing Attack
Node-level 
Query
‚Ä¶
GO
Target Model
Build 
Learn Discrete Graph Structure
GQ
XQ
1
ùí™( ÃÇHQ)
+ 
ÃÇHQ = ‚Ñ±(XQ, AQ)
MS
Learn Surrogate Model
2
Security Boundary
Model Stealing Attack
Node-level 
Query
‚Ä¶
GO
Target Model
Build 
GQ
Security Boundary
Model Stealing Attack
Node-level 
Query
‚Ä¶
GO
Target Model
Build 
Learn Discrete Graph Structure
GQ
XQ
Security Boundary
IDGL framework [1] / kNN
[1] Chen, Yu, Lingfei Wu, and Mohammed Zaki. "Iterative deep graph learning for graph neural networks: Better and robust node embeddings." Advances in neural information processing systems 33 (2020)
Model Stealing Attack
Node-level 
Query
‚Ä¶
GO
Target Model
Build 
Learn Discrete Graph Structure
GQ
XQ
1
ùí™( ÃÇHQ)
+ 
ÃÇHQ = ‚Ñ±(XQ, AQ)
MS
Learn Surrogate Model
2
Security Boundary
IDGL framework [1] / kNN
[1] Chen, Yu, Lingfei Wu, and Mohammed Zaki. "Iterative deep graph learning for graph neural networks: Better and robust node embeddings." Advances in neural information processing systems 33 (2020)
Model Stealing Attack
ùí™( ÃÇHQ)
+ 
ÃÇHQ = ‚Ñ±(XQ, AQ)
MS
Learn Surrogate Model
2
[1] Chen, Yu, Lingfei Wu, and Mohammed Zaki. "Iterative deep graph learning for graph neural networks: Better and robust node embeddings." Advances in neural information processing systems 33 (2020)
GQ
MT
Euclidean 
Space
GQ
MS
Prediction
Embedding
 t-SNE Projection
Model Stealing Attack
ùí™( ÃÇHQ)
+ 
ÃÇHQ = ‚Ñ±(XQ, AQ)
MS
Learn Surrogate Model
2
[1] Chen, Yu, Lingfei Wu, and Mohammed Zaki. "Iterative deep graph learning for graph neural networks: Better and robust node embeddings." Advances in neural information processing systems 33 (2020)
GQ
MT
Euclidean 
Space
MS
GQ
Prediction
Embedding
 t-SNE Projection
2
1
2
1
decision 
boundary
Model Stealing Attack
GQ
MT
Euclidean 
Space
MS
GQ
Prediction
Embedding
 t-SNE Projection
conduct the attack without knowing the target model‚Äôs architecture
Model Stealing Attack
GQ
MT
Euclidean 
Space
MS
GQ
Prediction
Embedding
 t-SNE Projection
conduct the attack without knowing the target model‚Äôs architecture
t-SNE
prediction posterior
embedding
Model Stealing Attack
GQ
MT
Euclidean 
Space
MS
GQ
Prediction
Embedding
 t-SNE Projection
2 dimensional t-SNE projection can be the new attack surface
Model Stealing Attack
GQ
MT
Euclidean 
Space
MS
GQ
Prediction
Embedding
 t-SNE Projection
2 dimensional t-SNE projection as the query response can be the new attack surface
conduct the attack without knowing the target model‚Äôs architecture
t-SNE
prediction posterior
embedding
Takeaways (2)
‚Ä¢ Secure your infrastructure 
‚Ä¢ Audit your GNN-based machine learning pipeline
‚Ä¢ Monitor your model logs for anomalies 
‚Ä¢ Evaluate the security and privacy posture of your Graph Neural Network 
(GNN) models
Code
‚Ä¢ Link re-identiÔ¨Åcation attack  
https://github.com/xinleihe/link_stealing_attack
‚Ä¢ Property/Subgraph inference attack 
     https://github.com/Zhangzhk0819/GNN-Embedding-Leaks
‚Ä¢ Model stealing attack 
     https://github.com/xinleihe/GNNStealing
Thank You
Yang Zhang and his research group 
CISPA Helmholtz Center for Information Security
PI:EMAIL
Azzedine Benameur and Yun Shen 
Spot by NetApp
{Azzedine.Benameur, Yun.Shen}@netapp.com