a second-order 
AMMAP[2] with negative 
•  If 1'2 = 1, we fit a marked Poisson  process. 
•  If 1'2 = 0 and 1'1 = 1 two degrees 
lost and the process 
degree of freedom. 
AMPH[2] discussed 
•  If 1'2 = 0 and 1'1 i= lone degree of freedom 
becomes 
This is the degenerate 
in Section 
a AMPH[2] with a single 
of freedom 
are 
case for the 
is 
case of 
auxiliary 
We define the following 
becomes a degenerate 
IV-A. 
for the sake of compactness, 
lost and the process 
the AMMAP[2]. 
variables, 
-1 
Zl = h21'11'2 
Z2 = hI - h2 + h21'l -hlh21'2 
Z3 = 1'1 - h21'2 + h21'l1'2 -2 
Z4 = h21'2 + h1' 
-h1'l 
1' - h21'l1'2 + 1 
and obtain 
•  If 1'1 = 1, the AMMAP[2] loses one degree 
This case in common with the degenerate 
first canonical 
the Dl matrix 
form described 
has the same structure. 
in Section 
IV-B4 because 
of freedom. 
case of the 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:41:16 UTC from IEEE Xplore.  Restrictions apply. 
Table I 
FITTING RESULTS FOR EXAMPLE I 
PI  P1,1  P2,2  P1,2 
Table III 
FITTING RESULTS FOR EXAMPLE 3 
PI  Pl,l  P2,2  P1,2 
Model S.OOe-OI O.OOe+OO  O.OOe+OO 
S.OOe-OI 
Trace S.OOe-OI O.OOe+OO  O.OOe+OO 
S.OOe-OI 
4.Sge-OI 
Fitted  S.OOe-OI  l.lSe-02  l.lSe-02 
2.l6e-Ol 2.S2e-Ol 
Model S.32e-Ol 2.Sle-Ol 
2.Sle-Ol 
Trace S.32e-Ol 2.S0e-Ol  2.l7e-Ol 
2.lSe-Ol 2.Sle-Ol 
Fitted S.32e-OI 2.Sle-Ol 
F1,1  F1,2  F2,1  F2,2 
Model I.OOe+OO S.OOe-OI 2.00e+OO S.OOe-OI 
Trace I.OOe+OO 4.9ge-OI 2.02e+OO 4.97e-OI 
Fitted I.OOe+OO 4.9ge-Ol 2.0le+OO S.04e-Ol 
B1,1  B1,2  B2,1  B2,2 
Model S.OOe-Ol I.OOe+OO  S.OOe-Ol 
2.00e+OO 
Trace 4.9ge-OI I.OOe+OO 4.97e-Ol 2.02e+OO 
Fitted 4.9ge-OI I.OOe+OO S.04e-Ol 2.0Ie+OO 
F1,1  F1,2  F2,1  F2,2 
Model S.S7e-OI 
Trace S.S7e-OI 
Fitted S.S7e-Ol 
1.6Se+OO 1.43e+OO 
S.OOe-OI 
7.97e-Ol  1.66e+OO  1.42e+OO 
7.97e-Ol 
1.63e+OO  1.4Se+OO 
B1,1 B1,2  B2,1  B2,2 
Model S.LOe-Ol 
S.S4e-Ol 
S.Sle-OI 
Trace S.0ge-OI 
S.Sle-Ol 
Fitted  S.0ge-OI 
1.4ge+OO 1.62e+OO 
1.4Se+OO I. 62e+OO 
1.4ge+OO 1.62e+OO 
Table II 
FITTING RESULTS FOR EXAMPLE 2 
PI  P1,1  P2,2  P1,2 
Model 4.3Se-OI I.S4e-OI 3.14e-OI 2.Sle-OI 
Trace 4.36e-OI I.SSe-OI  3.12e-OI 
2.Sle-OI 
Fitted 4.36e-OI I.S7e-Ol 3.14e-Ol 2.S0e-Ol 
H,l  F1,2  F2,1  F2,2 
Model I.LOe+OO 9.2le-Ol 2.4le+OO I.S4e+OO 
Trace l.lle+OO 9.lSe-Ol 2.44e+OO I.S4e+OO 
Fitted l.lle+OO 9.ISe-Ol 2.43e+OO I.S4e+OO 
B1,1  B1,2  B2,1  B2,2 
Model 9.SSe-OI I.Ole+OO 2.0Se+OO 2.12e+OO 
Trace 9.9le-Ol I.Ole+OO 2.0Se+OO 2.l2e+OO 
I.Ole+OO 2.07e+OO 2.l2e+OO 
Fitted  9.9le-Ol 
Table IV 
Model 1.12e-O 
l 3.26e-Ol 
Trace 1.12e-OI 3.27e-OI 
Fitted 1.12e-OI 3.27e-OI 
FITTING RESULTS FOR EXAMPLE 4 
PI  P2  P3  P4 
4.62e-Ol 
4.62e-Ol 
4.62e-OI 
Pl,l  Pl,2  Pl,3  P1,4 
1.2Se-02 
S.47e-02 
S.S2e-02 1.27e-02 
S.43e-02  1.26e-02 
9.97e-02 
9.94e-02 
9.94e-02 
Model 1.3ge-02 3.0ge-02 
Trace 1.33e-02 3.0Se-02 
Fitted I.3Se-02 3.lle-02 
Model 2.S0e-02 
Trace 2.77e-02 
Fitted 2.77e-02 
F1,1  F1,2  F1,3  F1,4 
1.6ge-02 
2.47e-02 
1.67e-02 2.Sle-02 
1.67e-02 2.Sle-02 
2.24e-02 
2.2Ie-02 
2.2le-02 
Bl,l B1,2  Bl,3 B1,4 
Model 2.3Se-02 l.64e-02 
Trace 2.34e-02 1.6Se-02 
Fitted 2.34e-02 1.6Se-02 
2.22e-02 
2.20e-02 
2.20e-02 
2.4Se-02 
2.43e-02 
2.43e-02 
that the class probabilities 
assures 
all the classes 
and the forward 
exactly for 
Fl,j and B1,j are optimally 
Pj are 
and back­
for 
for the remaining 
but it turns out to be good in practice 
This procedure 
matched 
ward moments 
j =  1, ... , c  -1. The adjustment 
is not optimal, 
take special care 
classes 
Ml so that the class is more likely 
the classes, 
i.e., 
whose forward 
and backward 
in ordering 
we fit first the 
moments 
are closer 
to be fitted exactly. 
approximated 
classes 
if we 
to 
Cross-moments. 
MMAP[m] process, 
The reasoning 
extended 
behind the sequential 
when applied 
where aggregation 
fit­
to cross-moments 
may 
For such 
explicit. 
thus 
of classes 
their cross moments would be unaffected, 
the complexity 
problem 
is defined. 
scheme for cross-moments 
We leave this 
provided 
that a 
fitting 
ting can be easily 
to the n-order 
be defined to leave a subset 
classes, 
reducing 
fitting 
interesting 
research 
direction 
for future 
work. 
V I. VALIDATION 
In this section, 
we show the accuracy 
of the proposed 
by MMAP[m] of different 
generated 
method on traces 
Our validation 
We also illustrate 
fitting 
orders. 
fitting. 
data obtained 
for the Microsoft 
Live Maps Back End (http://iotta.snia.org). 
considers 
queueing 
from the SNIA repository 
both exact and approximate 
performance 
for 
results 
stated, 
If not otherwise 
the number of samples 
a trace is 105. Also, unless specified, 
are 
AMMAP[2] for fitting 
always the one for second-order 
Pi, 
Bl,l and Fl,l. 
used to fit 
the fitting formulas 
A. Representative 
Examples 
MMAP[2] of order 2. Consider 
in [4], which generates 
a 
where the class markings 
alternate 
Example 1: Degenerate 
MMAP, discussed 
sequence 
the following 
marked arrival 
deterministically: 
Do = 
[-2 
0 
(42) 
algorithms 
of 
the backward 
test for our fitting 
case: due to the alternating 
nature 
of the two classes, 
This model is an interesting 
since it is a degenerate 
the arrivals 
first class coincides 
class. 
Fitting 
the original 
is not null, but quite small. 
difficulty 
of estimating 
underlying 
thus it is difficult 
with the forward 
are shown in Table I. Differently 
the probability 
results 
model, in the fitted process 
moment of the second 
from 
Pc,k 
The error is mainly due to the 
decay rate for the 
the autocorrelation 
value -1 and 
trace. 
MAP, which has the degenerate 
to estimate 
moment of the 
from the empirical 
MMAP[2] of order 2. In this 
Example 2: Non-Acyclic 
we show that a second-order 
AMMAP[2] can 
example 
successfully 
capture 
acyclic MMAP[2]. 
the behavior 
non­
The MMAP[2] is as follows: 
of a second-order 
Do =  [0  
], D1,1 =  [j  iji], 
D1,2 =  [ij 
1/4] 2/5 
results 
Fitting 
only fitting 
are shown in Table II. Even though we are 
moments, 
this 
and backward 
forward 
first-order 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:41:16 UTC from IEEE Xplore.  Restrictions apply. 
by a second-order  AMMAP[2]. 
non-acyclic 
example 
are fitted with a relative 
shows that the second-order 
Example 3: Non-Acyclic 
example 
be well approximated 
consider 
the following 
moments 
we show that even higher order processes 
Do = 
error smaJler 
multi-class 
than 1 %. 
MMAP[2] of order 4. In this 
can 
We 
MMAP[2] of order 4: 
1/8] 2/5 1 ' 
1/8 
1/8 
-2 1/5 
2/5 -3 3/4 
[3: 
1/56 1/10] 
-4 
1/2 1/4 
[ 1/8 1/40 
1/10 1/5 
3/10  2/25 
1/25 4/25 
9/25 8/25 
6/56 1/'"] 1/10 1/5 
9/20 1/14 
2/3 1/4 
[ 1/8 1/10 
1/10 3/25 
6/25 2/25 
Dl•2 = 4/25 6/25 
1/12  1/2 
6/20 5/28 
Dl•l = 
Table V 
FITTING RESULTS FOR EXAMPLE 5 
PI  P2  P3  P4 
Model 1.4Se·OI 2.ISe·OI 3.S7e-OI 
2.1ge·OI 3.S6e-OI 
Trace 1.47e·OI 
2.1ge-Ol 3.S6e-OI 
Fitted 1.47e-Ol 
Pl.l  Pl.2 Pl,3  Pl,4 
Model 2.1Se-02 3.20e-02 
S.0ge-02 
Trace 2.20e-02 3.33e-02 S.13e-02 
Fitted 2.17e-02 3.2Se-02 
S.lge-02 
Fl,l  Fl,2  Fl,3  Fl,4 
6.43e-02 
6.43e-02 
6.93e-02 
6.S7e-02 
2.7ge-OI 
2.7Se-OI 
2.7Se-OI 
4.lOe-02 
4.04e-02 
4.0ge-02 
Model 6.S0e-02 
Trace 6.90e-02 
Fitted 6.90e-02  6.S7e-02  6.43e-02 
6.Sle-02 
6.63e-02 
6.63e-02 
Model 6.S2e-02 
Trace 6.S2e-02 
Fitted 6.S2e-02 
Bl,1 Bl,2  Bl,3 Bl,4 
6.3le-02 
6.3Se-02 6.73e-02 
6.3Se-02 6.73e-02 
6.90e-02 
6.92e-02 
6.92e-02 
6.6Se-02 
RANDOM AMM AP[2] MODELS  RESULTS. 
Table VI 
Samples States Forward 
Error Backward Error 
10  2  9.262e-02 7.S3le-02 
104  2  I.07le-02 3.ll7e-02 
105  2  2.61Se-02 
10  4  6.422e-02 7.20ge-02 
104  4  2.27Se-02 2.S13e-02 
105  4  4.923e-02 2.S9Se-02 
10  8  l.lOle-Ol 6.lS7e-02 
104  8  I.S33e-02 1.4Sge-02 
105  8  1.126e-02 S.S92e-03 
4.137e-02 
canonical 
the autocorrelation 
This is a case  where 
underlying 
are shown in Table III. Both the first-order 
backward 
multi-class 
moments are matched 
moments 
decay in the 
Fitting 
forward 
and 
AMAP(2) is positive. 
are fitted accurately 
Also second-order 
with a 2% error. 
exactly. 
results 
a trace generated 
by a second-order 
decay in the underlying canon­
AMMAP[4] 
Example 4: Acyclic  MMAP[4] 
of order 2. We now apply 
approach  discussed 
in Section  V. 
We 
the sequential 
fitting 
consider 
with negative 
ical AMAP(2). 
autocorrelation 
This AMMAP[4] is defined as follows: 
D =  [-2 1/2] D =  [0  3/2] 
o  0  -5' 
Let di,j be the element 
The matrices 
whose elements 
1  4  (43) 
D1. 
in column j and row i of matrix 
D,e =  [di,j,e] 
from matrices 
D1,e are obtained 
are defined as follows 
1 
di,j,e =  di,j {[(n ·  i + m· j)" mod 2c + 1] + I} /G 
(44) 
in Table IV shows that the forward 
ensuring 
where n is the number of states, 
and G is a constant 
results 
moments of the first order are matched 
probabilities 
of just 4%. 
Pe,k are well approximated 
m is the number of classes, 
that L.e di,j,e =  di,j' Fitting 
and backward 
for all classes. 
with a relative error 
The 
Example 5: Non-Acyclic 
apply sequential 
fitting 
MMAP[4] , with Do defined as in Example 
by a fourth-order 
to a trace generated 
MMAP[4] of order 4. We now 
3 and [2/8  1/8  1/8  1/81 
2/5 1/5 1/5 2/5 
1/5 2/5 3/5 2/5 
3/4  3/4  3/4  1/14 
(45) 
Dl = 
B. Random Campaign 
generated 
the 95% confidence 
MMAPs, from 
in­
moments 
of 
For 
,5.8292]. 
and backward 
approach 
the fitting 
from 
MMAPs. The number of samples 
103 and 105, while the number 
between 
on traces 
in 
MMAP varies 
is kept fixed at m  =  4. 
2 
We now evaJuate 
generated 
between 
forward 
randomly 
were sampled, 
one of the randomly 
of the first-order 
n  of the generating 
randomly 
each trace varies 