title:blackhat:asia-21 Give Me a SQL Injection, I Shall PWN IIS and SQL Server
IIS and SQL Servers play very important roles in the Microsoft Ecosystem. They have been considered unbreakable for many years, and over one decade has passed since the last severe IIS memory corruption vulnerability was disclosed. Are they unbreakable? What about having a SQL injection? Can a SQL injection in the ACCESS database only be used to view unexpected data in the database? What is the relationship between IIS/SQL Server and the ancient (~30 years old) Microsoft JET database engine from the attacker's perspective?This presentation will answer all of those questions. It discloses a novel attack surface to attack IIS and SQL Servers based on a SQL injection. This attack surface opens a new world for attackers to have a chance to get RCE (Remote Code Execution) with "NT AUTHORITY\SYSTEM" privilege from a mere SQL injection on the latest Windows system. It discusses attack surface details and corresponding impacts in 3 classical attack scenarios in the real world: IIS+Access, IIS+SQL Server, and IIS+Webshell. It also shows 20-year old examples from dozens of vulnerabilities we found across all Windows versions released in the last two decades under this attack surface. In addition, it also includes how to defend and mitigate this attack surface especially for those systems which are no longer supported by Microsoft.