CCR, 2002.
[42] D. Massameno, “Secret CEF Attributes Part 6, The BGP Connection,”
2014. [Online]. Available: https://packetpushers.net/secretcef6-bgp/
[43] R. Meier, P. Tsankov, V. Lenders, L. Vanbever, and M. Vechev,
“NetHide: Secure and Practical Network Topology Obfuscation,” in
Proc. USENIX Security, 2018.
[44]
J. Mirkovic and P. Reiher, “A taxonomy of DDoS attack and DDoS
defense mechanisms,” ACM SIGCOMM CCR, 2004.
[45] B. Parno, D. Wendlandt, E. Shi, A. Perrig, B. Maggs, and Y.-C.
Hu, “Portcullis: protecting connection setup from Denial-of-Capability
attacks,” Proc. ACM SIGCOMM, 2007.
[46]
I. Pepelnjak, “Limit
[Online]. Available:
AS-path length
the maximum BGP AS-path length,” 2009.
http://wiki.nil.com/Limit the maximum BGP
[47] Pepelnjak,
Ivan,
“Oversized AS
bug
[Online]. Available: https://blog.ipspace.net/2009/02/
paths: Cisco
IOS
details,” 2009.
oversized-as-paths-cisco-ios-bug.html
[48] R. Rasti, M. Murthy, N. Weaver, and V. Paxson, “Temporal lensing and
its application in pulsing denial-of-service attacks,” in Proc. IEEE S&P,
2015.
[49] Y. Rekhter, T. Li, and S. Hares, “A border gateway protocol 4 (BGP-4),”
in IETF RFC 4271, 2005.
[50] F. Sanchez and Z. Duan, “Region-based bgp announcement ﬁltering for
improved bgp security,” in Proc. ACM Asia CCS, 2010.
[51]
J. M. Smith and M. Schuchard, “Routing Around Congestion: Defeating
DDoS Attacks and Adverse Network Conditions via Reactive BGP
Routing,” in Proc. IEEE S&P, 2018.
[52] P. Smith, “BGP Best Practices,” in RIPE NCC Regional Meeting, 2006.
[53] A. Studer and A. Perrig, “The coremelt attack,” in ESORICS, 2009.
[54] C. Villamizar, R. Chandra, and R. Govindan, “BGP route ﬂap damping,”
Tech. Rep., 1998.
[55] E. Vyncke and S. Hogg, “IPv6 Internet Security for Your Network,”
2009. [Online]. Available: http://www.ciscopress.com/articles/article.
asp?p=1312796&seqNum=3
[56] M. Winther, “Tier 1 ISPs: What they are and why they are important,”
IDC White Paper, 2006.
[57] L. Xue, X. Luo, E. W. Chan, and X. Zhan, “Towards Detecting Target
Link Flooding Attack,” in Proc. USENIX LISA, 2014.
[58] A. Yaar, A. Perrig, and D. Song, “SIFF: A stateless Internet ﬂow ﬁlter
to mitigate DDoS ﬂooding attacks,” in Proc. IEEE S&P, 2004.
[32] M. S. Kang, S. B. Lee, and V. D. Gligor, “The Crossﬁre Attack,” in
[59] X. Yang, D. Wetherall, and T. Anderson, “A DoS-limiting network
Proc. IEEE S&P, 2013.
architecture,” in Proc. ACM SIGCOMM CCR, 2005.
[33] E. Katz-Bassett, C. Scott, D. R. Choffnes, ´I. Cunha, V. Valancius,
N. Feamster, H. V. Madhyastha, T. Anderson, and A. Krishnamurthy,
“LIFEGUARD: Practical Repair of Persistent Route Failures,” in Proc.
ACM SIGCOMM, 2012.
[34] Y.-M. Ke, C.-W. Chen, H.-C. Hsiao, A. Perrig, and V. Sekar, “CI-
CADAS: congesting the internet with coordinated and decentralized
pulsating attacks,” in Proc. ACM Asia CCS, 2016.
[60] S. T. Zargar, J. Joshi, and D. Tipper, “A survey of defense mechanisms
against distributed denial of service (DDoS) ﬂooding attacks,” IEEE
Communications Surveys and Tutorials, 2013.
[61]
J. Zheng, Q. Li, G. Gu, J. Cao, D. K. Yau, and J. Wu, “Realtime
DDoS Defense Using COTS SDN Switches via Adaptive Correlation
Analysis,” IEEE Transactions on Information Forensics and Security,
2018.
(cid:18)(cid:18)(cid:25)(cid:19)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:53:09 UTC from IEEE Xplore.  Restrictions apply. 
TIER-1 AS ON ALL POSSIBLE DETOUR PATHS
APPENDIX A
remove the edges between Ain and Aout nodes. In other words,
only the ASes not on the detour path can be poisoned.
s
h
t
a
P
r
u
o
t
e
D
f
o
n
o
i
t
o
p
o
r
P
)
%
(
)
s
e
(
S
A
1
-
r
e
T
e
d
u
c
n
l
i
I
100
95
90
85
80
75
70
65
0
100
200
300
400
500
600
700
800
900
1000
Indices of Tested Critical and Source AS Pair
Figure 18: Number of detour paths include one or more tier-1
ASes.
We have counted the number of tier-1 ASes on the 1,000
detour paths with the least number of neighbors. We also wish
to evaluate other possible detour paths between 1,000 C–D
pairs as well.
Figure 18 shows the ratio of the detour paths that include
at least one tier-1 AS in 1,000 cases. About 25% of the tested
C–D pairs show that all their detour paths incur the large
number of ASes to be poisoned as they include one or more
tier-1 ASes. In nearly the rest of 75% of the cases, at least 95%
of the all possible routes between C and D include at least
one high-degree AS. To this end, we can see that the critical
trafﬁc will usually be transited at some major ASes regardless
of which detour path is chosen. Hence, to achieve an isolated
path for its critical ﬂows, the RAC deployer usually has to
poison hundreds to thousands of ASes.
MODELING PROBLEM [P1] TO PROBLEM MINSBCC
APPENDIX B
We ﬁrst brieﬂy review the general version of the MinSBCC
problem [28] and then present the modeling from problem [P1]
to MinSBCC. Interested readers may refer to the original paper
of the MinSBCC problem [28] to see its full description and
proofs of NP-Completeness.
We describe the generalization of the MinSBCC problem
as follows:
The generalized MinSBCC problem. Given a graph G =
(V, E) where each edge e ∈ E has a capacity ce and each
node v ∈ V is assigned a weight wv, a source node s, a sink
node t and a capacity bound B. The objective is to ﬁnd an
s–t cut (S, S), s ∈ S within the budget B such that the total
node weight
wv is minimal.
(cid:2)
v∈S
We now model the problem [P1] following the MinSBCC
problem. In particular, we consider the destination AS D as
the source node s and the propagation of a BGP message sent
from D to all other ASes forms a directed graph G. While we
keep ASes on the detour path R = {C, R1, R2, · · · , Rn, D} as
single nodes, we model each AS A that is not on the detour
path with two nodes, Ain and Aout. All messages received
by AS A are modeled as the edges going into Ain and all
messages sent out by A are modeled as the edges going out
from Aout. Ain and Aout have an edge with the capacity of
1 between them. All other edges are assigned to have the
capacity of the inﬁnity value so that the s–t cut will only
(cid:2)
v∈S
We assign the weight for Ain and Aout nodes as 0 and
1, respectively. This means if AS A has path leakage, both
nodes Ain and Aout will be included in set S and the total
wv increases by 1. If AS A does not have
node weight
path leakage (e.g., because it is poisoned), only node Ain or no
node is included in set S and the total node weight
wv
is unchanged. Also, all the nodes corresponding to the ASes
on the detour path have the weight of 0 so that they will be
included in S. Since the MinSBCC problem aims to minimize
(cid:2)
wv, it is equivalent to the goal of minimizing number
v∈S
(cid:2)
v∈S
of path leakage in problem [P1].
A GREEDY ALGORITHM TO MINIMIZE PATH LEAKAGE
APPENDIX C
Our greedy algorithm contains two phases as follows.
1. Calculate isolating sets of all ASes. We ﬁrst enumerate all
paths between each AS in the network and the destination
AS and then calculate its isolating set by taking note of
all ASes in Q that appear in the paths. We implement
this process efﬁciently using recursion with memorization.
Assuming we have k ASes in total that can have path
leakage, we now have k isolating sets: S1, S2, · · · , Sk.
2. Choose AS to be poisoned. We present the multi-round
process of picking neighboring ASes to poison in Algo-
rithm 1. In general, in each round, the algorithm selects the
smallest isolating set, say Si, and includes it in the ﬁnal
poisoning set P (see Line 3-10). By doing so, we have
completely prevented the path leakage at ASi. Because the
chosen isolating set Si may overlap with other isolating
sets, we have to remove the ASes that are already chosen
to be poisoned in those sets (see Line 15-17). Finally,
the algorithm stops when we have selected the sufﬁcient
number of ASes to be poisoned (see Line 11-13).
THE COVERAGE OF PUBLIC BGP DATASETS
APPENDIX D
When the destination AS D performs the RAC defense
(i.e., establishes a detour path in response to link-ﬂooding
attacks), it broadcasts one or more BGP poisoning messages.
These poisoning messages are in fact recorded in the public
BGP datasets(e.g., RIPE [12], RouteView [14]) approximately
10-20 minutes after they are exchanged. There currently exist
528 ASes that send the received BGP messages to the RIPE
and RouteView data collection points. Our analysis shows
that more than 99.95% of all possible detour paths for the
selected 1,000 C–D pairs are monitored by the 528 ASes.
As a consequence, any poisoning message becomes public
knowledge that can be easily accessed from the two BGP
datasets. From the BGP poisoning pattern (i.e., the set of ASes
the RAC deployer wants to avoid), one can easily infer the
intended detour path. For example, in Figure 10, the BGP
UPDATE message poisons ASes E and H, and many other
direct neighbor ASes of X, Y , and Z, but does not poison
ASes C, X, Y , and Z. This provides a strong indication that
the BGP message is designed to establish a detour path: {C,
X, Y , Z, D}.
(cid:18)(cid:18)(cid:25)(cid:20)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:53:09 UTC from IEEE Xplore.  Restrictions apply. 
Algorithm 1 Choosing poisoning ASes
Require: S = {S1, S2, · · · , Sk}: the set of all k isolating sets.
B: the maximum number of ASes that can be poisoned.
Ensure: P: set of ASes we choose to poison.
1: procedure CHOOSEPOISONINGASES
2:
P ← []
while True do
3:
4:
5:
6:
7:
8:
9:
10:
11:
12:
13:
14:
15:
16:
17:
18:
19:
end while
return P
20:
21: end procedure
M inSet ← S[0]
for all Si ∈ S do
if |Si| ≤ |M inSet| then
M inSet ← Si
(cid:2) Choose the lowest-cost set.
end if
end for
P (cid:4) ← P ∪ M inSet
if |P (cid:4)| ≥ B then
break
(cid:2) Terminate when exceeding bound.
end if
S ← S \ [M inSet]
for all Si ∈ S do
Si ← Si \ M inSet
(cid:2) Remove the chosen set.
(cid:2) Update the remaining sets.
end for
P ← P (cid:4)
INFERRED FILTERING PRACTICE AT TOP ASES
APPENDIX E
We present the list of top 20 rank ASes and whether they
belong to set A≥255 or set (A[30,255) \ A≥255) in Table III.
Table III: Whether the CAIDA top 20 rank ASes ﬁlter BGP
UPDATE messages with AS path ≥ 255. The ASes are ordered
according to their ranking.
ASN
AS name
∈ A≥255
∈ (A[30,255) \ A≥255)
3356
1299
174
2914
3257
6762
6453
6939
3491
3549
1273
6461
9002
209
12956
3320
7473
12389
7018
20485
Level 3
Telia Company AB
Cogent Comm.
NTT America, Inc.
GTT Comm.
Telecom Italia
TATA Comm.
Hurricane Electric
PCCW Global
Level 3
Vodafone Group
Zayo Bandwidth
RETN Limited
Qwest Comm.
Telefonica Int
Deutsche Tel.
Singapore Tel.
PJSC Rostelecom
AT&T
TransTeleCom




















(cid:18)(cid:18)(cid:25)(cid:21)
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:53:09 UTC from IEEE Xplore.  Restrictions apply.