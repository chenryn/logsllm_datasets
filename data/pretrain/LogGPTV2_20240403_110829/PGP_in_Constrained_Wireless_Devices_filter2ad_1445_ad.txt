# 优化后的文本

## 表7: 不同平台上的1024位和2048位RSA操作时间（毫秒）

| 模数大小 | 512位 | 768位 | 1024位 |
| --- | --- | --- | --- |
| ElGamal密钥生成 | - | - | - |
| ElGamal加密 | 2,392 | 3,510 | 7,973 |
| ElGamal解密 | 288,236 | - | - |
| DSA密钥生成 | - | - | - |
| DSA签名 | 2,955 | 6,031 | 9,529 |
| DSA验证 | 5,531 | 11,594 | 18,566 |

### 表8: 不同平台上的离散对数操作时间（毫秒）

| 设备 | 512位模数 | 768位模数 | 1024位模数 |
| --- | --- | --- | --- |
| Pager | - | 7,341 | 16,078 |
| Pilot PII | - | 51,704 | 219,820 |
| Pager | - | 8,704 | 26,958 |
| Pilot PII | - | 19.13 | 35.91 |
| Pager | - | 2,955 | 6,031 |
| Pilot PII | - | 3,431 | 14,735 |
| Pager | - | 5,531 | 11,594 |
| Pilot PII | - | 7.53 | 15.55 |
| Pager | - | 17,338 | 34,904 |
| Pilot PII | - | 14.31 | 26.13 |
| Pager | - | 19,060 | 56,708 |
| Pilot PII | - | 12,389 | 24,277 |
| Pager | - | 6,329 | 11,875 |
| Pilot PII | - | 26,588 | 24,28 |
| Pager | - | 57,248 | 47.23 |
| Pilot PII | - | 1,200,157 | 73,978 |
| Pager | - | 24,28 | 148,059 |
| Pilot PII | - | 67.78 | - |
| Pager | - | 144.73 | 25,525 |
| Pilot PII | - | 54,674 | 52,286 |

### 图2: PGP密钥列表
### 图3: 主菜单

## 7.2 密钥生成与存储

PGP主菜单（图3）中有一个“新建密钥”选项，用于创建密钥对。用户可以输入他们的姓名、电子邮件地址、寻呼机PIN码，并选择密钥类型和密钥长度（见图4）。目前可用的密钥类型和密钥大小包括ECC（随机曲线或Koblitz曲线；在F2^163、F2^233或F2^283上）、DH/DSS（512/512、768/768、1024/1024、1536/1024或2048/1024位）和RSA（512、768、1024、1536或2048位）。DH/DSS和RSA密钥大小是许多现有PGP实现中常见的。对于DSA，素数p的最大位数为1024位，符合DSS [34]标准。对于ECC，分别生成用于公钥加密和数字签名的密钥对。

公钥和私钥分别存储在不同的密钥环中。公钥属性（见图5）可以通过主菜单中的“查看密钥”功能进行查看。根据OpenPGP的要求，私钥使用用户选择的密码短语进行加密并存储。每当需要使用私钥进行签名或解密消息时，都需要输入该密码短语。

## 7.3 加密服务

PGP提供了三种基本服务：仅签名、仅加密或签名并加密。用户可以在编写邮件后决定是否对其进行签名或加密。系统会提示用户输入解锁私钥所需的密码短语，并选择预期接收者的公钥。除了表3-8中列出的主要操作时间外，还有一些额外的开销可能会被用户感知到。

## 代码大小

没有特别努力去最小化加载到寻呼机上的程序大小。有一些从OpenSSL加密库链接的代码可以很容易地移除（事实上，我们对添加了椭圆曲线例程的库能够相对较少修改就能用于寻呼机感到有些惊讶）。来自OpenSSL和OpenPGP的库例程以及适应寻呼机所需的各种粘合代码约占加载到设备上的370 KB的3/4（其余部分归因于涉及屏幕和用户界面的代码）。

如果可以牺牲一些互操作性，那么可以通过移除CAST或其他一些哈希算法来减少代码大小。

## 提高OpenPGP代码的健壮性

OpenPGP参考实现提供的诊断信息非常有限，并且容易在遇到错误数据时崩溃。当应用程序在工作站上运行时，偶尔由错误用户数据触发的段错误可能只是令人不快；但在寻呼机上，这种错误是完全不可接受的。我们的应用程序纠正了一些最麻烦的缺陷，但仍需改进错误处理。

## 密钥管理

我们希望实现基于X.509的PKI或信任网模型。无论哪种情况，我们都会实现一个密钥服务器，用于从密钥存储库中检索和存储密钥。这将涉及设置一个无线代理服务器，寻呼机将直接与之通信。代理服务器随后将与现有的Internet密钥服务器进行通信。

## 9 结论

### 在RIM寻呼机上实现PGP

32位架构、相对复杂的操作系统和开发环境，以及相对较大的内存容量意味着为寻呼机开发类似于传统系统的开发。用户界面必须针对设备进行定制，但不涉及文件I/O的“通用代码”可以相对容易地迁移到寻呼机上。

另一方面，这类设备的处理器运行速度很可能会继续比台式机慢得多。处理加密消息或签名时的长时间延迟会对用户造成很大的困扰。尽管我们在寻呼机上使用了大量的可用内存，但在生产版本的PGP中减少资源消耗是可取的。电池寿命将继续是一个主要问题，而认证和保密的开销与最小化设备传输的需求相竞争。

### 图4: 创建新密钥对的屏幕
### 图5: 查看公钥属性的屏幕

例如，验证密码短语在默认迭代次数下可能需要20秒。我们的实现使用了较小的默认迭代次数。与数据库文件系统进行大内存传输也会增加少量时间。

## 7.4 密钥管理

我们实现的密钥管理系统是最简单的一种——直接信任模型（见§2.2）。主菜单中有一个选项（见图3），用于通过电子邮件将自己的公钥发送给其他用户。还有一个功能可以从收到的电子邮件中提取并存储公钥。如果需要，可以通过某些直接手段（例如通过电话进行沟通——真实性通过语音识别提供）来验证公钥的指纹。

## 8 未来工作

以下是一些未来工作的方向：

### 随机数生成

许多系统实现了一个“随机收集设备”，试图利用环境噪声（键盘数据、系统计时器、磁盘特性等）来构建一个加密安全的随机比特源[21]。我们的寻呼机应用程序仅使用了一个相当简单（并且很可能不够安全）的种子过程，涉及时钟和其他一些来源。更复杂的解决方案是必不可少的，也许可以利用无线电装置作为来源。

### 互操作性

实现了互操作性的目标。所有RFC 2440要求的算法都已包含在内，还包括几个推荐的算法和椭圆曲线例程。我们的PGP实现与现有的PalmPilot和工作站实现进行了互操作。

### 椭圆曲线密码学

椭圆曲线解决方案特别适合受限环境。1024位和2048位RSA私钥操作对于PGP应用来说太慢，而163位、233位和283位ECC操作的性能是可以接受的。如果PGP（或其他电子邮件安全解决方案）要用于保护受限无线设备与桌面计算机之间的电子邮件通信，那么我们的测试结果表明ECC优于RSA，因为后者在某些无线设备上的性能太慢，而在工作站上两者都能很好地运行。

### 总结

本文集中讨论了PGP，但结果具有更广泛的应用价值。许多面向不断增长的无线市场的服务将需要涉及PGP使用的加密机制。小型无线设备的限制可能会持续一段时间，需要在可用性、计算需求、安全性和电池寿命之间找到平衡。

## 致谢

作者感谢Jonathan Callas就PGP的一些启发性讨论，以及Herb Little回答了我们关于RIM寻呼机的众多问题。

## 参考文献

[略]

---

希望这些优化能使您的文档更加清晰、连贯和专业。如果有任何进一步的修改需求，请随时告知！