Certainly! Here is a more polished and coherent version of the text:

---

### 4. Results

#### 4.1. The Big Picture
The EPM (Exploit, Payload, Malware) classification technique, as described in Section 3.2, provides a fast and simple tool to explore the relationships between exploits, payloads, and malware. By applying this technique, we can group attack events into clusters. For clarity, we will refer to these clusters as E-clusters (exploit), P-clusters (payload), and M-clusters (malware). Additionally, we introduce B-clusters, which are based on behavioral features.

By analyzing the SGNET dataset collected from January 2008 to May 2009, we discovered 39 E-clusters, 27 P-clusters, and 260 M-clusters. The analysis of the behavioral characteristics of the 5,165 samples led to the generation of 972 B-clusters. Figure 3 graphically represents the relationships between E-, P-, M-, and B-clusters.

**Figure 3. EPM Relationships in the SGNET Dataset and Their Comparison to B-Clusters**

Starting from the top, the first layer of groups corresponds to the payloads, the second to the exploits, the third to the malware grouped according to their static features, and the last one to malware grouped according to their behavior. This visualization provides a simplified yet representative view of the reality.

Due to space limitations, we only show E-, P-, M-, and B-clusters that include at least 30 attack events. This combination of clustering approaches, based on both static and dynamic information, is helpful in systematically identifying and filtering out anomalies. Some key observations include:

- **Low Number of Exploit/Payload Combinations:** Most malware variants seem to share a few distinct exploitation routines for their propagation.
- **Multiple Exploits per Payload:** The same payload (P-cluster) can be associated with multiple exploits (E-clusters).
- **Behavioral Clusters vs. Static Clusters:** The number of B-clusters is lower than the number of M-clusters, suggesting that some M-clusters correspond to variations of the same codebase, maintaining very similar behavior.

In the SGNET dataset, we discovered a large number of B-clusters (860 out of 972) composed of a single malware sample, each associated with a single attack instance. These size-1 B-clusters have a 1-1 association with static M-clusters and are likely to be associated with infrequent malware samples whose infection was observed a limited number of times during the deployment.

#### 4.2. Clustering Anomalies
In most other cases, the size-1 B-clusters are associated with larger M-clusters and B-clusters. By manually examining the samples affected by this anomaly, we found that they are mostly associated with at least another, larger B-cluster. We believe that these misclassifications are likely due to the employment of supervised clustering techniques, such as hierarchical clustering, in Anubis.

Clustering techniques relying on behavioral features are known to be subject to misclassification due to anomalies in the extraction of these features. On one hand, the variability in the behavior of some samples and their interaction with external conditions (e.g., availability of C&C servers) can lead to clustering artifacts. On the other hand, the sample's execution context may affect its profile and lead to misclassifications.

**Figure 4. Characteristics of the Size-1 Clusters**
- **Top:** AV names associated with the malware samples by a popular AV vendor.
- **Bottom:** Propagation strategy used by the samples in terms of combinations of E and P clusters.

Among the different variants of the Rahack worm (also known as Allaple), all have been pushed with a very specific P-pattern. This P-pattern forces the victim to receive a download on a specific port, TCP port 9988. For these reasons, the samples seem to be highly related.

We have also detected more subtle clustering anomalies caused by changes in the context of the malware execution. For instance, M-cluster 13, characterized by a very specific pattern, is associated with several different B-clusters. This cluster is peculiar for the amount of similarities and differences in the M dimension, such as size, number of sections, and linker version. In both cases, the samples are polymorphic, but the behaviors normally associated with the Allaple worm differ.

**Figure 5. Distribution of Allaple Over the IP Space**

The analysis of several variants of the Allaple worm, which exploits the MS04-007 vulnerability to propagate and carry out simple DoS attacks, revealed the existence of modifications to the original code. While all these different versions coexist in the SGNET dataset, they generate different B-clusters. The size, linker version, and other static features suggest recompilations with different compilers or versions.

One of the main differentiation factors among the different versions is the size, which can be detected in the M-clusters. The different hosts infected by these variants also have different sizes, suggesting recompilations with different versions of the compiler.

---

This version should be clearer, more coherent, and professionally presented.