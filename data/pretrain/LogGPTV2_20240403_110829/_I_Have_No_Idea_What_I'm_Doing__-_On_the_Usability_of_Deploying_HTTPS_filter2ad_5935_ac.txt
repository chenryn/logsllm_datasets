95
95
50
95
95
95
95
95
100
95
95
95
95
95
95
95
97
95
95
95
web.local
web.local
web.local
web.local
web.local
web.local
web.local
web.local
web.local
web.local
web.local
web.local
raspberrypi
-
web.local
web.local
web.local
web.local
Test
web.local
web.local
SME
web.local
web.local
4096
2048
2048
2048
4096
2048
2048
4096
4096
2048
4096
2048
2048
2048
2048
3096
2048
2048
2048
2048
2048
4096
4096
4096
RC4Support
TLS1.2
TLS1.0
TLS1.1
SSL2
HPKP
HSTS
3 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
3 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32)
1 (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:35) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:32) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
3 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
3 (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
1 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35)
3 (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:35) (cid:32) (cid:32) (cid:35)
Table 2: Security evaluation of the ﬁnal TLS conﬁguration per participant.
1344    26th USENIX Security Symposium
USENIX Association
1 Highlight HTTP Public Key Pinning (HPKP) deployed on this server. Yay!
2 Highlight HTTP Strict Transport Security (HSTS) with long duration deployed on this server.
3 Warning
4 Warning
5 Warning
6 Warning
7 Warning
8 Error
This server’s certiﬁcate chain is incomplete. Grade capped to B.
The server does not support Forward Secrecy with the reference browsers.
This server accepts RC4 cipher, but only with older protocol versions. Grade capped to B.
The server supports only older protocols, but not the current best TLS 1.2. Grade capped to C.
This server uses RC4 with modern protocols. Grade capped to C.
This server is vulnerable to the POODLE attack. If possible, disable SSL 3 to mitigate. Grade capped to C.
Table 3: Errors / Highlights / Warnings as referred to in Table 2.
number of visited websites over all participants was 60
(median=49.5, sd=27). We consider this a relatively
high number given the low amount of time. Table 5
lists the most visited websites. The top-most visited site
points to a German Ubuntu and Linux wiki that is fre-
quently updated. The documentation for SSL on Apache
(second-most visited site) contains detailed information
on certiﬁcate creation and retrieval but only basic
information on hardening. In contrast, sslabs.com and
bettercrypto.org contain comprehensive tutorials on
hardening but require a detailed understanding of the un-
derlying fundamentals. The tutorial from raymii.org
provides step by step instructions but is not regularly
updated. Most participants expressed annoyance and
vexation about the incompatibility of the different infor-
mation sources. We also found that the number of visited
websites (high, medium, low) does not impact the qual-
ity of the resulting conﬁguration, but this result is not
signiﬁcant in our sample with χ2(0.23327892,6) > 0.05.
“I have absolutely no idea what I’m doing. Neither
am I aware of whether my online source is trustworthy.
(P23)”
Creating a Certiﬁcate Signing Request (CSR). A
CSR is a block of PEM-encoded text which is sent to
a CA to request a TLS certiﬁcate. It therefore contains
information that will be included in the certiﬁcate such
as organization name and common name (FQDN) and
enables users to send their public key along with some
information that identiﬁes the domain name in a stan-
dardized way. When creating a CSR, the user is asked
to ﬁll out the respective information. In order to create a
CSR, the user has to create a key pair. Our results sug-
gest that many users do not understand the purpose and
concept of a CSR, i.e., who it is authenticating towards
whom. 19 out of 30 participants from the lab study had to
create two or more requests due to errors in the CSR cre-
ation. The most common error was that they did not ﬁll
out the requested common name ﬁeld correctly (14 par-
ticipants) and thus did not receive a valid certiﬁcate for
their domain. In the end, 20 participants created a CSR
Participant ID
Most visited sites
P4
P19
P8
P2
P7
Least visited sites
P21
P12
P5
P10
P18
Visited websites Grade
147
116
111
109
116
20
36
49
49
50
A
B
C
B
-
B
B
B
B
-
Table 4: Participants and their cumulative number of vis-
ited sites and overall rating.
with the correct common name as shown in Table 2. As
this is a common error in practice, some CAs even high-
light that the common name(s) can be altered later on.
This is especially useful when adding TLS support for
subdomains. Second, two participants (P14 and P15) did
not fully understand the difference between a CSR and a
(self-signed) certiﬁcate. Six participants initially created
a self-signed certiﬁcate instead of a CSR and tried to up-
load it to the CA. According to the self-reported work ex-
perience, this happened to participants regardless of their
experience. E.g., P15 reported to have recently deployed
TLS on Apache and still tried to upload a self-signed cer-
tiﬁcate to the CA. Four participants recognized the error
after receiving an error message from the CA and then
created a correct CSR including a correct common name.
Choosing the appropriate cipher suites.
In TLS, ci-
pher suites are used to determine how secure commu-
nication takes place. Cipher suites are composed from
building blocks in order to achieve security through di-
versity. A person in charge of conﬁguring TLS has to
select cipher suites that provide authentication and en-
USENIX Association
26th USENIX Security Symposium    1345
URL
wiki.ubuntuusers.de/Apache/SSL
httpd.apache.org/docs/2.4/ssl/
www.ssllabs.com/
bettercrypto.org
raymii.org/s/tutorials/Strong_SSL_Security_..
httpd.apache.org/docs/2.2/mod/mod_ssl
Table 5: Top most visited websites.
Visitors
25
20
16
15
14
11
cryption that is considered strong. However, this is a task
that requires a deep and up-to-date understanding on the
underlying algorithms in order to make informed deci-
sions about which cipher suites to support. In the course
of our lab experiments, all participants who came to this
point during the conﬁguration assignment were aware of
the fact that they had to manually select cipher suites to
secure the communication. The decision making process
was exclusively based on search results and suggestions
from online resources without questioning. Some par-
ticipants also referred to recently published blog posts
where they read about the disadvantages of a certain al-
gorithm. This implies that the quality of the used infor-
mation source is crucial for the overall security of the
conﬁguration as our participants lacked profound knowl-
edge and thus had to trust their source of information.
Table 2 shows how the selected cipher suites impact the
quality of the conﬁguration.
Strict HTTPS. After ﬁnishing an initial valid conﬁg-
uration, most participants enforced strict HTTPS as a
ﬁrst step of the hardening phase. Some were annoyed by
the fact that HTTPS does not immediately replace HTTP
as soon as it is available. Most participants were ini-
tially confused when they tested their conﬁguration via
the browser and were redirected via http when they en-
tered the URL without the http(s):// preﬁx. They then
spent a signiﬁcant amount of time to conﬁgure the vir-
tual host and the respective ports correctly, mostly also
due to misleading or incomplete information from online
sources.
Multiple conﬁguration ﬁles. All but six participants
said that they found the conﬁguration ﬁle structure con-
fusing, regardless of their prior experience with Apache.
P14 found it particularly challenging to ﬁnd the right
conﬁguration ﬁles. According to the think-aloud proto-
col, this was the main challenge that in the end resulted
in an invalid conﬁguration. Several participants copied
and pasted entries between different conﬁguration ﬁles
or had double entries, e.g., for SSLEngineOn. Nine par-
ticipants also struggled with loading the modules, e.g.,
P18 did not understand where to load the modules in the
conﬁguration. Many participants were also not aware of
where and how to create a new virtual host which listens
on 443. P23, for example, did not understand the differ-
ences between the http.conf and apache.conf which dis-
tracted him/her from the TLS-speciﬁc tasks and security-
critical decisions.
Finding the right balance between security and com-
patibility. We observed that the majority of our par-
ticipants struggled with the deﬁnition of a secure con-
ﬁguration.
In our assignment we just stated that the
conﬁguration should be as secure as possible to with-
stand an audit, without specifying any key properties.
Hence, the participants themselves had to make the deci-
sions. About 15 participants expressed concerns regard-
ing compatibility when conﬁguring SSL/TLS versions
and cipher suites. A majority of them, however, decided
in favor of a securer option, e.g., disabling all TLS ver-
sions < TLS v1.1 and thus refraining from supporting
older versions of IE.
Impact of Prior Experience with TLS
4.4
As shown in Table 1 a signiﬁcant proportion of the par-
ticipant pool has already administered or is currently ad-
ministering a server and 17 participants have conﬁgured
TLS before. Regardless of our relatively small sample
which is due to the qualitative nature of our study, we
provide statistical signiﬁcance of the interplay between
prior experience and the resulting security grade from
our study. Table 6 shows the cumulative amount of par-
ticipants that achieved a certain security grade during
the study with respect to their prior experience. None
of the participants who did not manage to provide a
valid conﬁguration in the given time had prior experi-
ence with server administration in a corporate environ-
ment. However, Table 6 shows that the majority of expe-
rienced users was not able to provide an A grade conﬁg-
uration. A signiﬁcance test with χ2(7.9982,3) = 0.046
provides evidence to suggest that there is an association
between prior experience with conﬁguring TLS and the
1346    26th USENIX Security Symposium
USENIX Association
grade of a participant’s TLS conﬁguration from the lab
study. We could not identify dependence between prior
employment as system administrator and the SSL Test
grade based on the conﬁguration from the lab study with
χ2(6.7667,3) = 0.07.
stated that they would prefer if web servers had TLS
conﬁgured by default.
“It seems that there is already a certiﬁcate called
snakeoil, why can’t I use this one?” (P7)
4.5 Perceptions of Usability
After the lab experiments, the study participants ﬁlled
out a short online questionnaire and reported reﬂections