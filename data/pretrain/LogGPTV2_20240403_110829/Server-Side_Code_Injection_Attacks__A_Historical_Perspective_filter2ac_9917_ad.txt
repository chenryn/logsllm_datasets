being spread across the IP space (large X coordinates).
17
Fig. 8. Inﬂuence of the activity size on its detectability.
In general, searching for intrinsic properties of a threat instead of attempt-
ing to fully model its characteristics is a much more promising direction. Indeed,
the previously mentioned activities targeting port 2967 have been detected by
the shellcode heuristics for both of the rulesets under examination. However,
these detectors have underlined the limitation of signatures: only a few activ-
ity types have been successfully detected, and due to the very small amount of
invariants present in packed shellcode (most of the associated signatures search
for very short byte patterns in the entire payload) they are prone to false pos-
itives or even squealing attacks [57]. Only sophisticated—and costly—dynamic
approaches such as nemu and libemu have proven to be robust against the chal-
lenges posed by the threat landscape.
5 Conclusion
This paper has provided a comprehensive overview of the threat landscape on
server-side code injection attacks. We have leveraged a privileged observation
point, that of a distributed honeypot deployment that for ﬁve years has mon-
itored a variety of networks across the IP space. The collected data, available
to any institution interested in participating, has allowed us to provide a his-
torical perspective on the characteristics of the attacks over the years, and on
the performance of common state-of-the-art tools at detecting them. We have
been able to substantiate with experimental data a number of key observations
that should drive future work on threat monitoring and research in intrusion
detection, the most important of which are the following:
Full visibility on Internet threats is diﬃcult to achieve. Malicious activities
are diverse over time and across the IP space. Diﬀerent networks observe attacks
of diﬀerent complexity, and several threats appear as highly targeted, short-lived
activities that are particularly challenging and costly to identify.
Threat persistence. In parallel to targeted, short-lived activities we can clearly
identify in the dataset long-lived activities associated to well known worms and
50100150Number of attacking /8 networks5051015202530Number of victim /8 networksLow detectionsHigh detections18
botnets. Despite these threats being very old and well understood, we do not
identify any signiﬁcant decrease in their attack volume over a period of ﬁve
years. This underlines an important divergence between state of the art prac-
tices and the scarce security hygiene that seems to be associated to certain user
populations. Simple, known threats persist undisturbed across the years.
Limitations of knowledge. Knowledge-based intrusion detection approaches
have shown clear limitations. The achievement of an acceptable visibility on the
threat landscape is possible but is likely to require the investment of a non-
negligible amount of resources for the creation of a comprehensive perspective
on current threats. And even in such case, the generation of robust signatures for
the detection of threats is hard. Server-side exploits are likely to be used more
and more in the context of targeted, long-term intrusions to propagate within
the target environments. The challenges observed in this work are likely to be
amply ampliﬁed in these contexts. More generic—but costly—approaches seem
to be the only promising research direction for the detection of these threats.
Acknowledgements
This work has been partially supported by the European Commission through project
FP7-SEC-285477-CRISALIS and FP7-PEOPLE-254116-MALCODE funded by the 7th
Framework Program. Michalis Polychronakis is also with FORTH-ICS. We also thank
EmergingThreats for having granted us free access to the ETPro ruleset.
References
1. Symantec: W32.Stuxnet Dossier version 1.4. http://www.symantec.com/content/en/us/
enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf (Febru-
ary 2011) [last downloaded October 2012].
2. Symantec: W32.Duqu The precursor to the next Stuxnet.
http://www.symantec.
com/content/en/us/enterprise/media/security_response/whitepapers/w32_duqu_
the_precursor_to_the_next_stuxnet_research.pdf (November 2011) [last downloaded
October 2012].
3. Dacier, M., Pouget, F., Debar, H.: Honeypots: Practical means to validate malicious
fault assumptions. In: Dependable Computing, 2004. Proceedings. 10th IEEE Paciﬁc Rim
International Symposium on, IEEE (2004) 383–388
4. Cooke, E., Bailey, M., Mao, Z., Watson, D., Jahanian, F., McPherson, D.: Toward under-
standing distributed blackhole placement. In: Proceedings of the 2004 ACM workshop on
Rapid malcode, ACM (2004) 54–64
5. Leita, C., Dacier, M.: SGNET: a worldwide deployable framework to support the analysis
of malware threat models. In: 7th European Dependable Computing Conference (EDCC
2008). (May 2008)
6. Song, Y., Locasto, M.E., Stavrou, A., Keromytis, A.D., Stolfo, S.J.: On the infeasibility
In: Proceedings of the 14th ACM conference on
of modeling polymorphic shellcode.
Computer and communications security (CCS). (2007) 541–551
7. Shacham, H.: The geometry of innocent ﬂesh on the bone: return-into-libc without func-
tion calls (on the x86). In: Proceedings of the 14th ACM conference on Computer and
Communications Security (CCS). (2007)
8. Bennett, J., Lin, Y., Haq, T.: The Number of the Beast (2013) http://blog.fireeye.
com/research/2013/02/the-number-of-the-beast.html.
9. Roesch, M.: Snort: Lightweight intrusion detection for networks.
In: Proceedings of
USENIX LISA ’99. (November 1999) (software available from http://www.snort.org/).
19
10. Paxson, V.: Bro: A system for detecting network intruders in real-time. In: Proceedings
of the 7th USENIX Security Symposium. (January 1998)
11. honeynet.org: Sebek (2012) https://projects.honeynet.org/sebek/.
12. Tang, Y., Chen, S.: Defending against internet worms: A signature-based approach. In:
INFOCOM 2005. 24th Annual Joint Conference of the IEEE Computer and Communica-
tions Societies. Proceedings IEEE. Volume 2., IEEE (2005) 1384–1394
13. Zhuge, J., Holz, T., Han, X., Song, C., Zou, W.: Collecting autonomous spreading malware
using high-interaction honeypots. Information and Communications Security (2007) 438–
451
14. Vrable, M., Ma, J., Chen, J., Moore, D., Vandekieft, E., Snoeren, A.C., Voelker, G.M.,
Savage, S.: Scalability, ﬁdelity, and containment in the potemkin virtual honeyfarm. In:
Proceedings of the twentieth ACM symposium on Operating systems principles (SOSP).
(2005) 148–162
15. Jiang, X., Xu, D.: Collapsar: A vm-based architecture for network attack detention center.
In: Proceedings of the 13th USENIX Security Symposium. (2004)
16. Dagon, D., Qin, X., Gu, G., Lee, W., Grizzard, J., Levine, J., Owen, H.: Honeystat: Local
worm detection using honeypots. In: Recent Advances in Intrusion Detection, Springer
(2004) 39–58
17. Portokalidis, G., Slowinska, A., Bos, H.: Argos: an emulator for ﬁngerprinting zero-day
attacks for advertised honeypots with automatic signature generation. SIGOPS Oper.
Syst. Rev. 40(4) (2006) 15–27
18. Anagnostakis, K.G., Sidiroglou, S., Akritidis, P., Xinidis, K., Markatos, E.P., Keromytis,
A.D.: Detecting Targeted Attacks Using Shadow Honeypots. In: Proceedings of the 14th
USENIX Security Symposium. (August 2005) 129–144
19. Provos, N.: Honeyd: a virtual honeypot daemon. In: 10th DFN-CERT Workshop, Ham-
burg, Germany. Volume 2. (2003)
20. Baecher, P., Koetter, M., Holz, T., Dornseif, M., Freiling, F.C.: The nepenthes plat-
form: An eﬃcient approach to collect malware. In: Proceedings of the 9th International
Symposium on Recent Advanced in Intrusion Detection (RAID). (2006)
: Amun: Python honeypot (2009) http://amunhoney.sourceforge.net/.
: Dionaea: catches bugs (2012) http://dionaea.carnivore.it/.
21.
22.
23. Baecher, P., Koetter, M.: libemu (2009) http://libemu.carnivore.it/.
24. Kreibich, C., Weaver, N., Kanich, C., Cui, W., Paxson, V.: [gq]: Practical containment for
measuring modern malware systems. In: Proceedings of the ACM Internet Measurement
Conference (IMC), Berlin, Germany (November 2011)
25. Leita, C.: SGNET: automated protocol learning for the observation of malicious threats.
PhD thesis, University of Nice-Sophia Antipolis (December 2008)
26. K2: ADMmutate (2001) http://www.ktwo.ca/ADMmutate-0.8.4.tar.gz.
27. Detristan, T., Ulenspiegel, T., Malcom, Y., Underduk, M.: Polymorphic shellcode engine
using spectrum analysis. Phrack 11(61) (August 2003)
28. Obscou: Building ia32 ’unicode-proof’ shellcodes. Phrack 11(61) (August 2003)
29. Rix: Writing IA32 alphanumeric shellcodes. Phrack 11(57) (August 2001)
30. Mason, J., Small, S., Monrose, F., MacManus, G.: English shellcode. In: Proceedings of
the 16th ACM conference on Computer and communications security (CCS). (2009)
31. Kreibich, C., Crowcroft, J.: Honeycomb – creating intrusion detection signatures using
honeypots. In: Proceedings of the Second Workshop on Hot Topics in Networks (HotNets-
II). (November 2003)
32. Kim, H.A., Karp, B.: Autograph: Toward automated, distributed worm signature detec-
tion. In: Proceedings of the 13th USENIX Security Symposium. (2004) 271–286
33. Singh, S., Estan, C., Varghese, G., Savage, S.: Automated worm ﬁngerprinting. In: Pro-
ceedings of the 6th Symposium on Operating Systems Design & Implementation (OSDI).
(December 2004)
34. Kolesnikov, O., Dagon, D., Lee, W.: Advanced polymorphic worms: Evading IDS by
blending in with normal traﬃc (2004) http://www.cc.gatech.edu/~ok/w/ok_pw.pdf.
35. Newsome, J., Karp, B., Song, D.: Polygraph: Automatically Generating Signatures for
In: Proceedings of the IEEE Symposium on Security & Privacy.
Polymorphic Worms.
(May 2005) 226–241
36. Wang, K., Stolfo, S.J.: Anomalous payload-based network intrusion detection. In: Pro-
ceedings of the 7th International Symposium on Recent Advanced in Intrusion Detection
20
(RAID). (September 2004) 201–222
37. Li, Z., Sanghi, M., Chen, Y., Kao, M.Y., Chavez, B.: Hamsa: Fast signature generation
for zero-day polymorphic worms with provable attack resilience. In: Proceedings of the
IEEE Symposium on Security & Privacy. (2006) 32–47
38. Newsome, J., Karp, B., Song, D.: Paragraph: Thwarting signature learning by training
maliciously. In: Proceedings of the 9th International Symposium on Recent Advances in
Intrusion Detection (RAID). (September 2006)
39. Fogla, P., Sharif, M., Perdisci, R., Kolesnikov, O., Lee, W.: Polymorphic blending attacks.
In: Proceedings of the 15th USENIX Security Symposium. (2006)
40. Wang, H.J., Guo, C., Simon, D.R., Zugenmaier, A.: Shield: Vulnerability-driven network
ﬁlters for preventing known vulnerability exploits. In: Proceedings of the ACM SIGCOMM
Conference. (August 2004) 193–204
41. Brumley, D., Newsome, J., Song, D., Wang, H., Jha, S.: Towards automatic generation of
vulnerability-based signatures. In: Proceedings of the IEEE Symposium on Security and
Privacy. (2006)
42. Toth, T., Kruegel, C.: Accurate Buﬀer Overﬂow Detection via Abstract Payload Execu-
tion. In: Proceedings of the 5th Symposium on Recent Advances in Intrusion Detection
(RAID). (October 2002)
43. Akritidis, P., Markatos, E.P., Polychronakis, M., Anagnostakis, K.: STRIDE: Polymorphic
In: Proceedings of the 20th IFIP
sled detection through instruction sequence analysis.
International Information Security Conference (IFIP/SEC). (June 2005)
44. Andersson, S., Clark, A., Mohay, G.: Network-based buﬀer overﬂow detection by ex-
ploit code analysis. In: Proceedings of the Asia Paciﬁc Information Technology Security
Conference (AusCERT). (2004)
45. Kruegel, C., Kirda, E., Mutz, D., Robertson, W., Vigna, G.: Polymorphic worm detection
using structural information of executables. In: Proceedings of the International Sympo-
sium on Recent Advances in Intrusion Detection (RAID). (September 2005)
46. Payer, U., Teuﬂ, P., Lamberger, M.: Hybrid engine for polymorphic shellcode detection.
In: Proceedings of the Conference on Detection of Intrusions and Malware & Vulnerability
Assessment (DIMVA). (July 2005) 19–31
47. Chinchani, R., Berg, E.V.D.: A fast static analysis approach to detect exploit code inside
network ﬂows. In: Proceedings of the International Symposium on Recent Advances in
Intrusion Detection (RAID). (September 2005)
48. Wang, X., Pan, C.C., Liu, P., Zhu, S.: Sigfree: A signature-free buﬀer overﬂow attack
blocker. In: Proceedings of the USENIX Security Symposium. (August 2006)
49. Polychronakis, M., Markatos, E.P., Anagnostakis, K.G.: Network-level polymorphic shell-
code detection using emulation. In: Proceedings of the Third Conference on Detection of
Intrusions and Malware & Vulnerability Assessment (DIMVA). (July 2006) 54–73
50. Polychronakis, M., Markatos, E.P., Anagnostakis, K.G.: Emulation-based detection of
non-self-contained polymorphic shellcode. In: Proceedings of the 10th International Sym-
posium on Recent Advances in Intrusion Detection (RAID). (September 2007)
51. Polychronakis, M., Anagnostakis, K.G., Markatos, E.P.: Comprehensive shellcode detec-
In: Proceedings of the 26th Annual Computer Security
tion using runtime heuristics.
Applications Conference (ACSAC). (December 2010)
52. Snow, K.Z., Krishnan, S., Monrose, F., Provos, N.: ShellOS: Enabling fast detection and
forensic analysis of code injection attacks. In: Proceedings of the 20th USENIX Security
Symposium. (2011)
53. Leita, C., Mermoud, K., Dacier, M.: Scriptgen: an automated script generation tool for
honeyd. In: 21st Annual Computer Security Applications Conference. (December 2005)
54. Leita, C., Dacier, M., Massicotte, F.: Automatic handling of protocol dependencies and re-
action to 0-day attacks with ScriptGen based honeypots. In: 9th International Symposium
on Recent Advances in Intrusion Detection (RAID). (September 2006)
55. Polychronakis, M., Anagnostakis, K.G., Markatos, E.P.: An empirical study of real-world
polymorphic code injection attacks. In: Proceedings of the 2nd USENIX Workshop on
Large-scale Exploits and Emergent Threats (LEET). (April 2009)
56. Polychronakis, M., Keromytis, A.D.: ROP payload detection using speculative code exe-
cution. In: Proceedings of the 6th International Conference on Malicious and Unwanted
Software (MALWARE). (October 2011) 58–65
57. Patton, S., Yurcik, W., Doss, D.: An achilles heel in signature-based ids: Squealing false
positives in snort. Proceedings of RAID 2001 (2001)