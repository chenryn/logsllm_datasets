title:POSTER: Weighing in eHealth Security
author:Martin Kr&quot;amer and
David Aspinall and
Maria Wolters
POSTER: Weighing in eHealth Security
A Security and Privacy Study of Smart Scales
Martin Krämer
University of Edinburgh, UK
PI:EMAIL
David Aspinall
University of Edinburgh, UK
PI:EMAIL
Maria Wolters
University of Edinburgh, UK
PI:EMAIL
2. SMART SCALES IN EHEALTH
Here, we use eHealth loosely to describe practices designed
to promote a person’s health and well-being through technol-
ogy. The kind of eHealth solutions we are interested in typically
involve a sensor device (scale, activity tracker, blood oximeter
etc.), a mobile application that is installed as a companion on
the user’s phone and a vendor-supplied web offering (c.f. Fig-
ure 1). Commonly other third party services (data analysis, ad-
vertising, social media) can be connected. The protocols em-
ployed are mostly standard, such as Bluetooth LE or Wiﬁ for the
device radios, and use HTTP(S) for data transfer. Since most solu-
tions only support Android and iOS as mobile operating systems,
we focus on those ecosystems here, and the static analysis part of
the framework will be limited to Android only.
The study at hand focusses on Smart Scales as sensor devices.
With Withings launching its ﬁrst scale in 2012 the market by now
has become very diverse. In a range from simple to advanced
solutions these scales collect information on weight, Body Mass
Index and body fat to water percentage, muscle mass and bone
mass. The common idea is to track one’s weight and further data
on a daily basis to provide insights into health and well-being.
ABSTRACT
eHealth devices such as smart scales and wearable ﬁtness track-
ers are a key part of many health technology solutions. How-
ever, these eHealth devices can be vulnerable to privacy and se-
curity related attacks. In this poster, we propose a security anal-
ysis framework for eHealth devices, called mH-PriSe, that will
yield useful information for security analysts, vendors, health care
providers, and consumers. We demonstrate our framework by
analysing scales from 6 vendors. Our results show that while ven-
dors strive to address security and privacy issues correctly, chal-
lenges remain in many cases. Only 5 out of 8 solutions can be
recommended with some caveats whereas the remaining 3 solu-
tions expose severe vulnerabilities.
Keywords
Wireless & mobile security, Internet-of-Things, eHealth
1.
INTRODUCTION
Guaranteed security standards and unrestricted privacy pro-
tection are indispensable for data that are provided by ﬁtness
and health devices, such as smart scales and wearable trackers.
While most consumer devices are mainly used by individuals for
tracking their own health, data can be used in consultations with
health care professionals or as evidence in courtrooms [19]. Con-
sumer devices typically do not adhere to strict medical device
standards [2] and may exhibit vulnerabilities not found in sys-
tems that are subject to privacy standards such as HIPAA [12, 10].
With mH-PriSe we propose a framework for the analysis of pri-
vacy and security aspects of eHealth solutions. We include static
analysis, dynamic analysis and penetration testing functionality.
With the various potential applications in mind we design this
framework to be scalable and adjustable to the needs of security
analysts. We validate this framework by investigating 8 different
smart scales from 6 vendors. To the best of our knowledge, we are
the ﬁrst to provide a comparative analysis of privacy and security
vulnerabilities of smart scales.
Figure 1: eHealth logical architecture
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
CCS’16 October 24-28, 2016, Vienna, Austria
© 2016 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-4139-4/16/10.
DOI: http://dx.doi.org/10.1145/2976749.2989044
3. mH-PriSe ANALYSIS FRAMEWORK
Our analysis framework, mH-PriSe, and experiment setup al-
lows for sound and methodological scientiﬁc research (c.f. Fig-
ure 2). We ran our experiments on a Lenovo X230 laptop with
Kali Linux 2.0 and used an Atheros external WiFi card to create a
hotspot. The test device was a rooted LG Nexus 5 with Android
WiFi enabled sensor deviceBluetooth enabled sensor device18326.0 installed. Test results were stored in a MySQL database and
viewed through phpMyAdmin.
We have deﬁned a threat model which includes assets, agents,
Figure 2: mHealth security and privacy analysis framework
weaknesses and attack vectors (full details in [16]). The mH-PriSe
framework builds on this threat model and is deﬁned by test cases
(following attack vectors) and test steps (weaknesses) assigned to
them. The view is complemented through the recording of in-
formational steps. We investigated the actual behaviour of each
solution in four steps. Preparatory functionality, which is sum-
marized under the ﬁrst step, is omitted here:
static analysis In 7 steps, we apply static analysis to develop-
ment artefacts. Among others research tools used include
Androguard with Mallordoid,Drozer, and Android SDK tools.
dynamic analysis Running 5 test cases and 44 test steps in total,
we check for known weaknesses and search for issues. For
this purpose MITMproxy is used to forge certiﬁcates and
intercept any trafﬁc on our hotspot.
post analysis Data collected through experimentation undergoes
a rigorous, manual analysis. SSLLabs was used to analyze
web server security. We also visualize the communication
on a world map.
Subsequently the actual behaviour was compared to information
retrieved from documented sources such as privacy policies and
websites. Privacy policies are analysed according to their com-
pliance with OECD guidelines [9] and EU regulations [7, 6].
4. RESULTS AND EVALUATION
We report our results under 8 main properties (rows) with a
fail caused by major issues, warnings due to some issues and a
pass based on some caveats (see Table 1). The ﬁrst two rows of
the table include ﬁndings related to data transmission between
app and server or sensor and server. Weaknesses that have been
identiﬁed in this context are highly severe. For example solu-
tions Activ8rlives, HAPI, Thomson and iChoice failed to correctly
use cryptography in their apps, including cases of missing traf-
ﬁc encryption, badly implemented SSL, un-salted passwords and
re-constructable message authentication codes. The scales WS-
30 and WS-50 by Withings as well as Aria by Fitbit connect di-
rectly to the internet and fail to make use of SSL encryption. The
newer Body Cardio by Withings is the only scale in our test set
that employs trafﬁc encryption. These weaknesses allow for ses-
sions stealing, trafﬁc injection and tampering with measurements
as indicated in Table 1.
The Fitbit Aria protocol, for example, is in version 39. After pre-
vious research had revealed issues, ﬁxes have been applied [8,
18]. Our ﬁndings show that the protocol is still vulnerable to re-
computing the MAC. What is even worse – if no precautions are
taken – is that the scale reveals WiFi credentials during the pair-
ing with a users home WiFi network.
The Thomson TBS705 scale and their mobile application show
serious privacy weaknesses. Sending device tracking data to a
Chinese advertising server and transferring unencrypted mea-
surement data to a Europe server while offering no control over
the data or providing a privacy policy, the solution violates many
privacy principles found in the OECD guidelines.
While no solution looked intentionally malicious, many require
updates to their mobile applications or sensor ﬁrmwares. Though
solutions Withings Body Cardio and iChoice with SwissMed app
are of commendable security standard, the latter performs slightly
better with respect to privacy aspects. For the privacy we refer to
the amount of data synchronised to different destinations and
also aspects mentioned in privacy policies as compared to their
actual behaviour.
Through our rigorous analysis we have identiﬁed the following
main issues with smart scale solutions.
ISS 1
ISS 2
ISS 3
ISS 4
ISS 5
ISS 6
ISS 7
ISS 8
missing or broken encryption – over the (wireless)
network including app-to-server and sensor-to-
server communication
improper certiﬁcate validation – trust manager
issues or invalid certiﬁcate
missing tampering protection – trafﬁc and mes-
sages are not protected against tampering
personal data leaked – unnoticed data leakage;
requires patches by vendors, mainly, to adhere to
common practices in implementation
improper cryptography usage – inadequate usage
of cryptographic functions such as missing salts
for hashes or MAC failures
weak password policies – missing or weak pass-
word policies
account deletion – ﬂawed account deactivation
or deletion processes
overprivileged application – overprivileged appli-
cations installed on device
5. RELATED WORK
This study extends the previous work of Knorr et. al. [14, 15] to
include sensor devices. Mense et al. provide more detail on the
behaviour of mHealth applications with respect to privacy and
the data being transmitted [17]. Baig et al. recently explored the
research area of mHealth applications by reviewing their system
design and the identiﬁed challenges and issues. Among those the
biggest are security, privacy and safety [1].
Other researchers investigated single solutions more comprehen-
sively to ﬁnd similar security and privacy issues in many [5, 11].
Privacy and security issues in update mechanisms of sensor soft-
ware and with mobile apps are detected in the work of Cyr et al.
Various kinds of attacks on ﬁtness devices have become popular
in research (representative list): Over-the-air-attacks on ﬁtness
and health devices showing similar issues [11, 3] or reverse en-
gineering of ﬁrmware and protocols [20, 4]. The closest work is
Clausing et al. and Hilts et al. on a set of different activity track-
ers [13, 3].
(3)dynamicanalysis(2)staticanalysis(1)preparation(4)postanalysisweb servermobile devicesensor devicenotebookﬁle systemdatabasePlay StorehotspotMITMproxytSharktransparentmH-PriSePrivacy & SecurityAnalysistest casestest casestest steps1833Activ8rLives
app to server
 trust issues; trafﬁc
tampering
sensor to server