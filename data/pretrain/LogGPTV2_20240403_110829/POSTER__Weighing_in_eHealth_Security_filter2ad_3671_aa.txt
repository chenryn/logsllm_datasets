# POSTER: Weighing in eHealth Security

## Authors
- Martin Krämer, University of Edinburgh, UK
- David Aspinall, University of Edinburgh, UK
- Maria Wolters, University of Edinburgh, UK

## Abstract
eHealth devices, such as smart scales and wearable fitness trackers, are integral to many health technology solutions. However, these devices can be vulnerable to privacy and security attacks. In this poster, we present mH-PriSe, a security analysis framework for eHealth devices. This framework provides valuable information for security analysts, vendors, healthcare providers, and consumers. We demonstrate the effectiveness of mH-PriSe by analyzing smart scales from six different vendors. Our results show that while vendors generally aim to address security and privacy issues, significant challenges remain. Only five out of eight solutions can be recommended with some caveats, while the remaining three solutions exhibit severe vulnerabilities.

## 1. Introduction
Ensuring robust security standards and comprehensive privacy protection is essential for data generated by fitness and health devices, such as smart scales and wearable trackers. While most consumer devices are primarily used for personal health tracking, the data can also be utilized in medical consultations or legal proceedings. Consumer devices often do not meet strict medical device standards and may have vulnerabilities not found in systems subject to privacy regulations like HIPAA.

mH-PriSe is a framework designed to analyze the privacy and security aspects of eHealth solutions. It incorporates static analysis, dynamic analysis, and penetration testing. The framework is scalable and adaptable to the needs of security analysts. We validate mH-PriSe by examining eight different smart scales from six vendors. To our knowledge, this is the first comparative analysis of privacy and security vulnerabilities in smart scales.

## 2. Smart Scales in eHealth
In this context, eHealth refers to practices aimed at promoting health and well-being through technology. Typical eHealth solutions involve a sensor device (such as a scale, activity tracker, or blood oximeter), a mobile application, and a vendor-provided web platform. These solutions often integrate third-party services for data analysis, advertising, and social media. Common communication protocols include Bluetooth LE and Wi-Fi, with HTTP(S) for data transfer. Since most solutions support only Android and iOS, our study focuses on these ecosystems, and the static analysis is limited to Android.

This study specifically examines smart scales. With Withings launching its first scale in 2012, the market has become diverse, offering solutions that range from basic to advanced. These scales collect various metrics, including weight, Body Mass Index (BMI), body fat percentage, muscle mass, and bone mass, to provide daily insights into health and well-being.

## 3. mH-PriSe Analysis Framework
Our mH-PriSe framework and experimental setup enable rigorous and methodical scientific research. Experiments were conducted on a Lenovo X230 laptop running Kali Linux 2.0, with an Atheros external Wi-Fi card creating a hotspot. The test device was a rooted LG Nexus 5 with Android 6.0. Test results were stored in a MySQL database and viewed via phpMyAdmin.

We defined a threat model encompassing assets, agents, weaknesses, and attack vectors. The mH-PriSe framework builds on this model, with test cases following attack vectors and test steps addressing weaknesses. Informational steps complement the analysis. We evaluated each solution in four steps, omitting preparatory functionality:

- **Static Analysis:** We applied static analysis to development artifacts using tools like Androguard, Mallordroid, Drozer, and Android SDK tools.
- **Dynamic Analysis:** We ran 5 test cases and 44 test steps to check for known weaknesses and identify issues. MITMproxy was used to forge certificates and intercept traffic.
- **Post Analysis:** Data collected during experimentation underwent rigorous manual analysis. SSLLabs was used to assess web server security, and communication was visualized on a world map.

The actual behavior was compared with documented sources, such as privacy policies and websites. Privacy policies were analyzed for compliance with OECD guidelines and EU regulations.

## 4. Results and Evaluation
We report our findings under eight main properties, with results categorized as fail, warning, or pass (Table 1). The first two rows cover data transmission between the app and server, and sensor and server. Identified weaknesses include missing or broken encryption, improper certificate validation, and lack of tampering protection. For example, Activ8rlives, HAPI, Thomson, and iChoice failed to use cryptography correctly, with issues such as missing traffic encryption, poorly implemented SSL, unsalted passwords, and reconstructable message authentication codes. The WS-30 and WS-50 scales by Withings, as well as the Aria by Fitbit, connect directly to the internet without SSL encryption. The newer Withings Body Cardio is the only scale in our test set that uses traffic encryption.

The Fitbit Aria protocol, for instance, is in version 39. Despite previous research revealing issues, fixes have been applied, but our findings show that the protocol remains vulnerable to MAC recomputation. Additionally, the scale can reveal Wi-Fi credentials during pairing with a user's home network.

The Thomson TBS705 scale and its mobile application exhibit serious privacy weaknesses, sending device tracking data to a Chinese advertising server and transferring unencrypted measurement data to a European server, with no control over the data or privacy policy provided.

While no solution appeared intentionally malicious, many require updates to their mobile applications or sensor firmware. The Withings Body Cardio and iChoice with SwissMed app are commendable, with the latter performing slightly better in terms of privacy.

Through our analysis, we identified the following main issues with smart scale solutions:
- Missing or broken encryption
- Improper certificate validation
- Missing tampering protection
- Personal data leakage
- Improper cryptography usage
- Weak password policies
- Flawed account deactivation or deletion processes
- Overprivileged applications

## 5. Related Work
This study extends the work of Knorr et al. to include sensor devices. Mense et al. provide detailed insights into the behavior of mHealth applications regarding privacy and data transmission. Baig et al. explored the system design and challenges of mHealth applications, highlighting security, privacy, and safety as major concerns. Other researchers have investigated single solutions more comprehensively, identifying similar security and privacy issues. Cyr et al. detected privacy and security issues in update mechanisms for sensor software and mobile apps. Various studies have focused on over-the-air attacks and reverse engineering of firmware and protocols. The closest related work includes studies by Clausing et al. and Hilts et al. on different activity trackers.

## Keywords
Wireless & mobile security, Internet-of-Things, eHealth

---

**Figure 1: eHealth Logical Architecture**

**Figure 2: mHealth Security and Privacy Analysis Framework**

**Table 1: Summary of Findings**

**Permission to make digital or hard copies of part or all of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for third-party components of this work must be honored. For all other uses, contact the owner/author(s).**

**CCS'16 October 24-28, 2016, Vienna, Austria**
**© 2016 Copyright held by the owner/author(s).**
**ACM ISBN 978-1-4503-4139-4/16/10.**
**DOI: http://dx.doi.org/10.1145/2976749.2989044**