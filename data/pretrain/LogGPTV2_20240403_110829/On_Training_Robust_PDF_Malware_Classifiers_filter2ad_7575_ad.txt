one), but it has also gained VRA in property C (distance two),
that is higher than the baseline NN model.
If we only train one type of property at a time, the other
properties may be lost. For example, Robust B and Robust
D models both have decreased VRA in the deletion property,
compared to the baseline NN model. This indicates the
conﬂicts between training for different tasks in general.
The strongest models according to the VRA evaluation are
Ensemble A+B, monotonic classiﬁers, Robust A+B, and Ro-
bust A+B+E. While Adv Retrain A+B has slightly lower VRA
than Adv Retrain C, it is more robust against unrestricted gra-
dient attack (Appendix A.3) since it is trained with more prop-
erties. Robust A+B has slightly lower VRA in property B than
the monotonic and ensemble baselines, but it has 85.28% VRA
for property C. Robust A+B+E has gained VRA in all prop-
USENIX Association
29th USENIX Security Symposium    2351
Property A
Distance: 1
Subtree Del.
90.25
99.24
85.50
99.21
93.47
98.51
97.22
0
5.74⇤
7.67⇤
8.78⇤
8.78⇤
99.77
46.43
99.94
18.00
62.68
99.68
99.03
FPR Train Trained
Prop.
(%)
0.07
None
A
0.07
B
0.07
C
0.11
0.11
D
A,B
0.15
A,B
0.26
D
0.07
E
1.89
1.78
E
E
1.78
E
1.78
A
0.33
B
0.59
1.04
C
D
2.30
1.93
E
A,B
0.56
1.89
A,B,E
(m)
<1
1
8
2
14
7
2
2
<1
1
4
8
11
102
25
104
6
84
84
Property C
Distance: 2
Subtree Del.
49.82
84.20
38.20
88.91
50.00
87.47
7.43
0
0⇤
0⇤
0⇤
0⇤
89.43
1.26
99.77
9.84
6.12
85.28
58.58
Gained Veriﬁed Robust Accuracy (VRA, %)
Property D
Distance: 41
Subtree Ins.
0
0
0
0
0
0
0
0
98.91⇤
99.04⇤
99.06⇤
99.06⇤
0
0
0
99.91
99.21
0
88.96
Property B
Acc
Distance: 1
(%)
Model
Subtree Ins.
99.95
Baseline NN
0
99.95
Adv Retrain A
0
99.95
Adv Retrain B
0
99.93
Adv Retrain C
0
Adv Retrain D
99.93
0
Adv Retrain A+B 99.92
0
99.97⇤
99.87
Ensemble A+B
99.95
Ensemble D
0
98.91⇤
98.91
Monotonic 10
99.04⇤
Monotonic 100
99.04
99.06⇤
99.06
Monotonic 1K
99.06⇤
99.06
Monotonic 2K
99.84
Robust A
0
99.72
Robust B
99.77
Robust C
99.54
0
98.96
Robust D
92.21
99.14
Robust E
91.86
99.74
Robust A+B
91.86
Robust A+B+E
99.15
99.00
⇤ VRA numbers are computed through the model property, not symbolic interval analysis.
Table 4: The veriﬁed robust accuracy (VRA) computed from 3,461 test PDF malware. The name of the monotonic classiﬁer repre-
sents the number of trees in the model. For the other models, the name for the model corresponds to the property it is trained with. Al-
though monotonic classiﬁers have higher VRA for insertion properties (B, D, E), Robust A+B and Robust A+B+E have strong VRA
in both insertion and deletion properties, and therefore they are more robust against unrestricted attacks (Section 4.3 to Section 4.7).
erties. Although the monotonic classiﬁers have higher VRA
in insertion properties, since Robust A+B and Robust A+B+E
have strong VRA in both insertion and deletion properties, they
are more robust against unrestricted attacks than the monotonic
classiﬁers, as shown by the results in the following sections.
4.3 Gradient Attackers
Property E
Distance: 42
Subtree Ins.
0
0
0
0
0
0
0
0
98.91⇤
99.04⇤
99.06⇤
99.06⇤
0
0
0
99.91
99.21
0
88.99
Model
Baseline NN
Adv Retrain A+B
Robust E
Robust A+B
Robust A+B+E
Robustness Property (ERA, %)
A
98.51
99.8
67.1
99.77
99.56
D
0
87.3
99.27
0
99.21
B
0
84.6
99.27
99.97
99.91
C
88.44
91.42
19.15
91.04
90.66
E
0
94.7
99.27
0
99.21
The gradient attacker has perfect knowledge, but the evasive
feature vector found by the attack may not correspond to a real
evasive PDF. We implement bounded and unbounded gradient
attackers to evaluate the ERA for all neural network models.
4.3.1 Implementation
State-of-the-art Bounded Attacker. We implement the
bounded gradient attacker for each robustness property. For
example, for property B, we ﬁrst choose an arbitrary subtree
from the PDF malware seed. Then, we take the gradient of
the benign label with regard to the input feature, and increase
the feature for the input index with the highest gradient value.
We repeat this until either an evasion instance is found or
the whole bounded region is inserted to be ones. If any of
the subtree choices succeeds, the attack can succeed for the
malware seed within the property. Similarly, we perform the
bounded gradient attacks for the other properties.
State-of-the-art Unbounded Attacker. We implement the
unbounded gradient attacker that performs arbitrary insertion
and deletion guided by gradients, unrestricted by all robustness
Table 5: ERA under bounded gradient attack. The correspond-
ing VRAs in Table 4 are the lower bound of ERA values.
properties. The attack stops when all evasive instances are
found, or until 200,000 iterations.
4.3.2 Results
Bounded Gradient Attack. We evaluate the ERA
restricted by each robustness property. Since VRA over-
approximates possible attacks, VRA is the lower bound
for the ERA against any speciﬁc attack. We show the ERA
for the most representative models in Table 5, with further
details in Appendix A.2. All the ERA numbers are higher
than the corresponding VRA in Table 4. For the Adv Retrain
A+B model, the gap between VRA and ERA is quite large.
While it has 0 VRA for property B and D (Table 4), the ERA
values under bounded gradient attack are 84.6% and 87.3%
respectively. One interesting observation is that the ERA of
property E is higher than property D, which is also higher
than property B. It shows that the greedy algorithm (gradient
2352    29th USENIX Security Symposium
USENIX Association
ERA (%)
Model
0
Baseline NN
0
Adv Retrain A+B
0
Ensemble A+B
48.8
Monotonic 100
0
Robust A+B
Robust A+B+E
50.8
Table 6: ERA under reverse
mimicry attack. Robust A+B+E
is the most robust one.
A
R
E
1.00
0.75
0.50
0.25
0.00
●
0
●
●
●
Monotonic 10
Monotonic 100
Monotonic 1K
Monotonic 2K
●
5
●
● ●
L0
● ●
10
15
A
R
E
1.00
0.75
0.50