elliptic curves, and signature methods). When we detect that a
handshake is inconsistent with the indicated browser, we check
for an exact match with any of the ﬁngerprints we collected.
3
This strategy has several potential weaknesses. First, multiple
products could share a single ﬁngerprint. This seems particularly
likely given that developers are likely to use one of a small
number of popular TLS libraries (e.g., OpenSSL). Second, if
products allow customization, then ﬁngerprints of the default
conﬁguration will not match these customized versions.
Surprisingly, we ﬁnd that none of the browsers nor the
104 products we manually investigated shared ﬁngerprints,
except for eight pieces of unwanted software that all use
the Komodia Redirector SDK [32]. In other words, these
ﬁngerprints uniquely identify a single product. None of the
client-side security products we tested allow users to customize
TLS settings. However, many of the corporate middleboxes
allow administrators to specify custom cipher suites. In this
situation, we would be able to detect that interception is
occurring, but not identify the responsible product.
Middleboxes and Corporate Proxies
Nearly every major
networking hardware manufacturer— including Barracuda, Blue
Coat, Cisco, and Juniper—produces middleboxes that support
“SSL Inspection”. These devices allow organizations to intercept
TLS trafﬁc at their network border for analysis, content ﬁltering,
and malware detection. In March 2015, Dormann documented
products from nearly 60 manufacturers that advertise this
functionality [15]. We conﬁgured and ﬁngerprinted twelve
appliance demos from well-known manufacturers (e.g., Cisco
and Juniper) and anecdotally popular companies (e.g., A10 and
Forcepoint), per Figure 3. We note one conspicuous absence:
ZScaler SSL Inspection. ZScaler provides a cloud-based SSL
inspection service, but did not provide us with a trial or demo.
Antivirus Software We installed, tested, and ﬁngerprinted
popular antivirus products based on the software documented by
de Carné de Carnavalet and Mannan [12], products previously
found to be intercepting connections [27], [46], and a report
of popular antivirus products [47]. Products from twelve
vendors inject a new root certiﬁcate and actively intercept TLS
connections.4 We list the products that intercept connections
in Figure 4.5
Unwanted Software and Malware Motivated by recent
reports of unwanted software intercepting TLS connections,
we ﬁngerprinted the Komodia SDK [32], which is used by
Superﬁsh, Qustodio, and several pieces of malware [8], [56],
and the NetFilter SDK [1], which is used by PrivDog.
We tested products in January–March, 2016. We are
publishing our browser heuristics and product ﬁngerprints at
https://github.com/zakird/tlsﬁngerprints.
I V. M E A S U R I N G T L S I N T E R C E P T I O N
We measured global interception rates by deploying our
heuristics at three network vantage points: Mozilla Firefox
update servers, a set of popular e-commerce websites, and the
4We found that the following products did not intercept HTTPS: 360 Total,
Ahnlabs V3 Internet Security, Avira AV 2016, Comodo Internet Security, F-
Secure Safe, G DATA products, K7 Total Security, Malwarebytes, McAfee
Internet Security, Microsoft Windows Defender, Norton Security, Panda Internet
Security 2016, Security Symantec Endpoint Protection, Tencent PC Manager,
Trend Micro Maximum Security 10, and Webroot SecureAnywhere.
5A preprint of this paper incorrectly listed G DATA products in Figure 4.
Vantage Point
Cloudﬂare
Firefox
E-commerce
% HTTPS Connections Intercepted
No Interception
88.6%
96.0%
92.9%
Likely
0.5%
0.0%
0.9%
Conﬁrmed
10.9%
4.0%
6.2%
Fig. 2: Detecting Interception—We quantify HTTPS intercep-
tion at three major Internet services. We estimate that 5–10%
of connections are intercepted.
Cloudﬂare content distribution network. We observed 7.75 bil-
lion TLS handshakes across the three networks. By deploying
the heuristics on different networks, we avoid the bias inherent
of any single vantage point. However, as we will discuss in the
next section, we ﬁnd varying amounts of interception and abuse
on each network. Below, we describe each perspective in detail:
Firefox Update Servers
Firefox browsers routinely check for
software updates by retrieving an XML document from a central
Mozilla server over HTTPS. This check uses Firefox’s standard
TLS library (Mozilla NSS) and occurs every 24 hours while
the browser is running and on browser launch if the last update
occurred more than 24 hours prior. We used Bro [49] to monitor
connections to aus5.mozilla.org—the update server used
by Firefox versions 43–48—between February 14–26, 2016.
During this period, we observed 4.36 billion connections from
45K ASes and 243 of the 249 ISO-deﬁned countries. Because
we collected trafﬁc using an on-path monitor instead of on
the web server, we do not have access to the HTTP User-
Agent header. However, only speciﬁc versions of Firefox are
conﬁgured to connect to the server. Instead of looking for a
mismatch with the HTTP User-Agent, we look for a mismatch
between TLS handshake and any of the Firefox versions
conﬁgured to connect to the server. There is no user-accessible
content available on the site and there should be negligible
other trafﬁc. This vantage point provides one of the cleanest
perspectives on clients affected by TLS interception. However,
it only provides data for Firefox, one of the browsers believed
to be least affected by client-side interception software [12].
Popular E-commerce Sites During two weeks in August and
September 2015, a set of popular e-commerce sites hosted
JavaScript that loaded an invisible pixel from an external
server that recorded the raw TLS Client Hello, HTTP User-
Agent string, and client HTTP headers. This perspective sees
trafﬁc from all browsers, but may suffer from falsiﬁed User-
Agent headers. However, because the measurement required
JavaScript execution, the dataset excludes simple page fetches.
The sites have an international presence, but the connections
we observe are likely skewed towards desktop users because
the e-commerce provider has popular mobile applications.
The dataset has the added beneﬁt that it contains HTTP
headers beyond User-Agent, which allow another avenue for
detecting interception: looking for proxy related headers (e.g.,
X-Forwarded-For and X-BlueCoat-Via) and the modiﬁca-
tions documented by Weaver et al. [60].
Cloudﬂare Cloudﬂare is a popular CDN and DDoS protection
company that serves approximately 5% of all web trafﬁc [25].
Cloudﬂare provides these services by acting as a reverse
proxy. Clients connect to one of Cloudﬂare’s servers when
accessing a website, which serve cached content or proxy
4
Product
A10 vThunder SSL Insight
Blue Coat ProxySG 6642
Barracuda 610Vx Web Filter
Checkpoint Threat Prevention
Cisco IronPort Web Security
Forcepoint TRITON AP-WEB Cloud
Fortinet FortiGate 5.4.0
Juniper SRX Forward SSL Proxy
Microsoft Threat Mgmt. Gateway
Sophos SSL Inspection
Untangle NG Firewall
WebTitan Gateway
Grade
Validates
Certiﬁcates
Modern
Ciphers
F
A*
C
F
F
C
C
C
F
C
C
F
























Advertises
RC4
Yes
No
Yes
Yes
Yes
No
No
Yes
Yes
Yes
Yes
Yes
TLS
Version Grading Notes
1.2
1.2
1.0
1.0
1.2
1.2
1.2
1.2
1.2
1.2
1.2
SSLv2
Advertises export ciphers
Mirrors client ciphers
Vulnerable to Logjam attack
Allows expired certiﬁcates
Advertises export ciphers
Accepts RC4 ciphers
Vulnerable to Logjam attack
Advertises RC4 ciphers
No certiﬁcate validation
Advertises RC4 ciphers
Advertises RC4 ciphers
Broken certiﬁcate validation
Fig. 3: Security of TLS Interception Middleboxes—We evaluate popular network middleboxes that act as TLS interception
proxies. We ﬁnd that nearly all reduce connection security and ﬁve introduce severe vulnerabilities. *Mirrors browser ciphers.
Product
OS
Browser MITM
IE Chrome Firefox Safari
Grade
Validates
Certiﬁcates
Modern
Ciphers
TLS
Version Grading Notes
Mac
Mac
Bullguard . . .
Dr. Web . . .
Avast . . .
AV 11
AV 11.7
AVG . . .
Bitdefender . . .
CYBERsitter . . .
CYBERsitter 11
AV Plus 2015–16
Internet Security 16
Internet Security 15
Security Space 11
Dr. Web 11 for OS X
Win (cid:32)
Internet Security 2015–6 Win (cid:32)
Internet Security 2016 Win (cid:32)
Total Security Plus 2016 Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Win (cid:32)
Internet Security 16
Total Security 16
Internet Security 16
Parental Control 3
NOD32 AV 9
Net Nanny . . .
Net Nanny 7
Net Nanny 7
PC Pandora . . .
PC Pandora 7
KinderGate . . .
Mac
Mac
ESET . . .
Kaspersky . . .
Qustodio . . .
Parental Control 2015
Mac
(cid:35)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:71)(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:71)(cid:35)
(cid:32)
F
(cid:32)
Certiﬁcate Validation:

Interception:
(cid:35) No Interception (conn. allowed)  No Validation
(cid:71)(cid:35) Connections Blocked
(cid:32) Connections Intercepted
(cid:35) Broken Validation