attacks to obtain fraudulent certificates with them.
Our work demonstrates that domain validation, although seem-
ingly simple, is not a resolved problem. An interesting and an
important question that we leave for future research is under what
conditions and assumptions (on topology, adversary capabilities,
etc.) can domain validation be made secure.
ACKNOWLEDGEMENTS
We are grateful to Jennifer Rexford for her helpful comments on
our work. This work has been co-funded by the German Federal
Ministry of Education and Research and the Hessen State Min-
istry for Higher Education, Research and Arts within their joint
support of the National Research Center for Applied Cybersecu-
rity ATHENE and by the Deutsche Forschungsgemeinschaft (DFG,
German Research Foundation) SFB 1119.
Session 5B: PKI and Access Control CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea1433REFERENCES
[1] 2015. Hacked or Spoofed: Digging into the Malaysia Airlines Website Incident.
https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/hacked-
or-spoofed-digging-into-the-malaysia-airlines-website-compromise. Accessed:
2021-1-19.
[2] 2015.
mains.
hijack-of-lenovo-google-domains/. Accessed: 2021-1-19.
Webnic Registrar Blamed for Hijack of Lenovo, Google Do-
https://krebsonsecurity.com/2015/02/webnic-registrar-blamed-for-
[3] 2018.
DNSpionage Campaign Targets Middle East.
https:
//blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-
east.html. Accessed: 2021-01-19.
Global DNS Hijacking Campaign: DNS Record Manipulation at
[4] 2019.
Scale.
https://www.fireeye.com/blog/threat-research/2019/01/global-dns-
hijacking-campaign-dns-record-manipulation-at-scale.html. Accessed: 2021-1-
19.
[5] 2019.
Sea Turtle keeps on swimming, finds new victims, DNS hijacking
https://blog.talosintelligence.com/2019/07/sea-turtle-keeps-on-
techniques.
swimming.html. Accessed: 2021-01-19.
[6] 2019.
‘Unprecedented’ DNS Hijacking Attacks Linked to Iran.
https:
//threatpost.com/unprecedented-dns-hijacking-attacks-linked-to-iran/140737/
[7] 2020. Security Incident on November 13, 2020. https://blog.liquid.com/security-
incident-november-13-2020. Accessed: 2021-01-19.
[8] Louis Poinsignon. 2018.
BGP leaks and cryptocurrencies.
blog.cloudflare.com/bgp-leaks-and-crypto-currencies/
[9] Josh Aas, Richard Barnes, Benton Case, Zakir Durumeric, Peter Eckersley, Alan
Flores-López, J Alex Halderman, Jacob Hoffman-Andrews, James Kasten, Eric
Rescorla, et al. 2019. Let’s Encrypt: An Automated Certificate Authority to
Encrypt the Entire Web. In Proceedings of the 2019 ACM SIGSAC Conference on
Computer and Communications Security. 2473–2487.
[10] Mansoor Alicherry and Angelos D Keromytis. 2009. Doublecheck: Multi-path
verification against man-in-the-middle attacks. In 2009 IEEE Symposium on Com-
puters and Communications. IEEE, 557–563.
[11] Guido Appenzeller, Isaac Keslassy, and Nick McKeown. 2004. Sizing router
buffers. ACM SIGCOMM Computer Communication Review 34, 4 (2004), 281–292.
[12] Rob Austein, Steven Bellovin, Russ Housley, Stephen Kent, Warren Kumari, Doug
Montgomery, Chris Morrow, Sandy Murphy, Keyur Patel, John Scudder, et al.
2017. RFC 8205-BGPsec Protocol Specification. (2017).
[13] R Barnes, J Hoffman-Andrews, D McCarney, and J Kasten. [n.d.]. RFC 8555:
Automatic Certificate Management Environment (ACME), Mar. 2019. Proposed
Standard ([n. d.]).
[14] Henry Birge-Lee, Yixin Sun, Anne Edmundson, Jennifer Rexford, and Prateek
Mittal. 2018. Bamboozling certificate authorities with {BGP}. In 27th {USENIX}
Security Symposium ({USENIX} Security 18). 833–849.
[15] Henry Birge-Lee, Liang Wang, Daniel McCarney, Roland Shoemaker, Jennifer
Rexford, and Prateek Mittal. 2021. Experiences Deploying Multi-Vantage-Point
Domain Validation at Let’s Encrypt. USENIX Security (December 2021).
[16] Henry Birge-Lee, Liang Wang, Jennifer Rexford, and Prateek Mittal. 2019. Sico:
Surgical interception attacks by manipulating bgp communities. In Proceedings
of the 2019 ACM SIGSAC Conference on Computer and Communications Security.
431–448.
[17] Peter Boothe, James Hiebert, and Randy Bush. 2006. Short-lived prefix hijacking
https://
on the Internet. NANOG.
[18] Markus Brandt, Tianxiang Dai, Amit Klein, Haya Shulman, and Michael Waidner.
2018. Domain Validation++ For MitM-Resilient PKI. In Proceedings of the 2018
ACM SIGSAC Conference on Computer and Communications Security. ACM, 2060–
2076.
[19] Randy Bush and Rob Austein. 2013. The resource public key infrastructure (RPKI)
to router protocol.
[20] CAIDA. 2021. BGP Stream. https://bgpstream.caida.org/
[21] Taejoong Chung, Roland van Rijswijk-Deij, Balakrishnan Chandrasekaran, David
Choffnes, Dave Levin, Bruce M Maggs, Alan Mislove, and Christo Wilson. 2017. A
Longitudinal, End-to-End View of the {DNSSEC} Ecosystem. In 26th {USENIX}
Security Symposium ({USENIX} Security 17). 1307–1322.
Recent Routing Incidents: Using BGP to Hijack
[22] D. Madory. 2018.
DNS and more.
https://www.lacnic.net/innovaportal/file/3207/1/
dougmadory_lacnic_30_rosario.pdf
[23] Tianxiang Dai, Philipp Jeitner, Haya Shulman, and Michael Waidner. 2021. From
IP to transport and beyond: cross-layer attacks against applications. In Proceedings
of the 2021 ACM SIGCOMM 2021 Conference. 836–849.
[24] Tianxiang Dai, Philipp Jeitner, Haya Shulman, and Michael Waidner. 2021. The
Hijackers Guide To The Galaxy: Off-Path Taking Over Internet Resources. In
30th {USENIX} Security Symposium ({USENIX} Security 21). 3147–3164.
(EDNS (0)). IETF RFC6891, April (2013).
[26] Supratim Deb, Anand Srinivasan, and Sreenivasa Kuppili Pavan. 2008. An im-
proved DNS server selection algorithm for faster lookups. In 2008 3rd International
Conference on Communication Systems Software and Middleware and Workshops
[25] Joao Damas, Michael Graff, and Paul Vixie. 2013. Extension mechanisms for DNS
[28] Frank Denis. 2013. The GOOGLE.RW Hijack.
(COMSWARE’08). IEEE, 288–295.
[27] Chris C Demchak and Yuval Shavitt. 2018. China’s Maxim–Leave No Access
Point Unexploited: The Hidden Story of China Telecom’s BGP Hijacking. Military
Cyber Affairs 3, 1 (2018), 7.
http://labs.umbrella.com/2013/10/25/google-rw-hijack-nobody-else-noticed/.
[29] EFF, the Electronic Frontier Foundation. [n.d.]. Certbot. https://certbot.eff.org/
[30] Xuewei Feng, Chuanpu Fu, Qi Li, Kun Sun, and Ke Xu. 2020. Off-Path TCP
Exploits of the Mixed IPID Assignment. In Proceedings of the 2020 ACM SIGSAC
Conference on Computer and Communications Security. 1323–1335.
[31] Daniel Gruss, Clémentine Maurice, and Stefan Mangard. 2016. Rowhammer. js:
A remote software-induced fault attack in javascript. In International conference
on detection of intrusions and malware, and vulnerability assessment. Springer,
300–321.
[32] Amir Herzberg and Haya Shulman. 2013. Fragmentation Considered Poisonous:
or one-domain-to-rule-them-all.org. In IEEE CNS 2013. The Conference on Com-
munications and Network Security, Washington, D.C., U.S. IEEE.
[33] Tomas Hlavacek, Amir Herzberg, Haya Shulman, and Michael Waidner. 2018.
Practical experience: Methodologies for measuring route origin validation. In
2018 48th Annual IEEE/IFIP International Conference on Dependable Systems and
Networks (DSN). IEEE, 634–641.
[34] A Hubert and R Van Mook. 2009. Measures for making DNS more resilient
against forged answers. In RFC 5452. RFC.
[35] Philipp Jeitner and Haya Shulman. 2021. Injection Attacks Reloaded: Tunnelling
Malicious Payloads over DNS. In 30th {USENIX} Security Symposium ({USENIX}
Security 21). 3165–3182.
[36] Josh Aas and Daniel McCarney and and Roland Shoemaker. 2020. Multi-
Perspective Validation Improves Domain Validation Security.
https://
letsencrypt.org/2020/02/19/multi-perspective-validation.html
[37] Josh Karlin, Stephanie Forrest, and Jennifer Rexford. 2008. Autonomous security
for autonomous systems. Computer Networks 52, 15 (2008), 2908–2923.
[38] Varun Khare, Qing Ju, and Beichuan Zhang. 2012. Concurrent prefix hijacks: Oc-
currence and impacts. In Proceedings of the 2012 Internet Measurement Conference.
29–36.
[39] Amit Klein and Benny Pinkas. 2019. From {IP}{ID} to Device {ID} and
{KASLR} Bypass. In 28th {USENIX} Security Symposium ({USENIX} Security
19). 1063–1080.
[40] John Kristoff, Randy Bush, Chris Kanich, George Michaelson, Amreesh Phokeer,
Thomas C Schmidt, and Matthias Wählisch. 2020. On Measuring RPKI Relying
Parties. In Proceedings of the ACM Internet Measurement Conference. 484–491.
[41] Mohit Lad, Daniel Massey, Dan Pei, Yiguo Wu, Beichuan Zhang, and Lixia Zhang.
2006. PHAS: A Prefix Hijack Alert System.. In USENIX Security symposium, Vol. 1.
3.
[42] Ben Laurie. 2014. Certificate transparency. Commun. ACM 57, 10 (2014), 40–46.
[43] Francois Le Faucheur, A Vedrenne, P Merckx, and T Telkamp. 2004. Use of Interior
Gateway Protocol (IGP) metric as a second MPLS traffic engineering metric. IETF
Request for Comments RFC3785 (2004).
[44] Matt Lepinski and Kotikalapudi Sriram. 2017. BGPSEC protocol specification.
Internet Engineering Task Force (IETF) (2017).
[45] Bingyu Li, Jingqiang Lin, Fengjun Li, Qiongxiao Wang, Qi Li, Jiwu Jing, and
Congli Wang. 2019. Certificate Transparency in the wild: Exploring the reliability
of monitors. In Proceedings of the 2019 ACM SIGSAC Conference on Computer and
Communications Security. 2505–2520.
[46] Keyu Man, Zhiyun Qian, Zhongjie Wang, Xiaofeng Zheng, Youjun Huang, and
Haixin Duan. 2020. DNS Cache Poisoning Attack Reloaded: Revolutions with
Side Channels. In Proceedings of the 2020 ACM SIGSAC Conference on Computer
and Communications Security (Virtual Event, USA) (CCS ’20). Association for
Computing Machinery, New York, NY, USA, 1337–1350. https://doi.org/10.1145/
3372297.3417280
[47] D McPherson, V Gill, D Walton, and A Retana. 2002. RFC3345: Border Gateway
Protocol (BGP) Persistent Route Oscillation Condition.
[48] Lucas Noack and Tobias Reichert. 2018. Exploiting Speculative Execution (Spec-
tre) via JavaScript. Advanced Microkernel Operating Systems (2018), 11.
[49] Yossef Oren, Vasileios P Kemerlis, Simha Sethumadhavan, and Angelos D
Keromytis. 2015. The spy in the sandbox: Practical cache attacks in javascript
and their implications. In Proceedings of the 22nd ACM SIGSAC Conference on
Computer and Communications Security. 1406–1418.
[50] KyoungSoo Park, Vivek S Pai, Larry L Peterson, and Zhe Wang. 2004. CoDNS:
Improving DNS Performance and Reliability via Cooperative Lookups.. In OSDI,
Vol. 4. 14–14.
[51] Tashi Phuntsho. 2019. How to Install an RPKI Validator. https://labs.ripe.net/
Members/tashi_phuntsho_3/how-to-install-an-rpki-validator
[52] Lindsey Poole and Vivek S Pai. 2006. ConfiDNS: Leveraging Scale and History to
Improve DNS Security.. In WORLDS.
[53] RIPE NCC. 2021. RIS Raw Data.
measurements/routing-information-service-ris/ris-raw-data
https://www.ripe.net/analyse/internet-
[54] S. Goldberg. 2018. The myetherwallet.com hijack and why it’s risky to hold cryp-
tocurrency in a webapp. https://medium.com/@goldbe/the-myetherwallet-com-
Session 5B: PKI and Access Control CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea1434hijack-and-why-its-risky-to-hold-cryptocurrency-in-a-webapp-261131fad278
[55] Haya Shulman and Michael Waidner. 2014. Fragmentation considered leak-
ing: port inference for dns poisoning. In International Conference on Applied
Cryptography and Network Security. Springer, 531–548.
[56] Haya Shulman and Michael Waidner. 2017. One key to sign them all considered
vulnerable: Evaluation of DNSSEC in the internet. In 14th {USENIX} Symposium
on Networked Systems Design and Implementation ({NSDI} 17). 131–144.
[57] Yixin Sun, Maria Apostolaki, Henry Birge-Lee, Laurent Vanbever, Jennifer Rex-
ford, Mung Chiang, and Prateek Mittal. 2020. Securing Internet Applications
from Routing Attacks. arXiv preprint arXiv:2004.09063 (2020).
//www.routeviews.org/routeviews/
[58] University of Oregon Route Views Project. 2021. Route Views Project. http:
[59] Zheng Wang, Xin Wang, and Xiaodong Lee. 2010. Analyzing BIND DNS server
selection algorithm. International Journal of Innovative Computing, Information
and Control 6, 11 (2010), 5131–5142.
[60] D Wendlandt, D Andersen, and A Perrigo Perspectives. 2008. Improving SSH-
style Host Authentication with Multi-path Network Probing. In USENIX Annual
Technical Conference.
[61] Yingdi Yu, Duane Wessels, Matt Larson, and Lixia Zhang. 2012. Authority server
selection in DNS caching resolvers. ACM SIGCOMM Computer Communication
Review 42, 2 (2012), 80–86.
[62] Xin Zhang, Hsu-Chun Hsiao, Geoffrey Hasker, Haowen Chan, Adrian Perrig,
and David G Andersen. 2011. SCION: Scalability, control, and isolation on next-
generation networks. In 2011 IEEE Symposium on Security and Privacy. IEEE,
212–227.
A HIJACKING DOMAIN VALIDATION
In this section we show BGP prefix hijack attacks against a single
VA of Let’s Encrypt that was used until 2020. We start by explaining
and evaluating same-prefix hijacks and sub-prefix hijacks using a
victim domain that we setup for this purpose. We evaluate attacks
and their effectiveness and efficiency on popular router boxes. We
explain why the attacks become challenging against the multiVA
DV (domain validation) of Let’s Encrypt.
A.1 Setup and Attacker Model
A.1.1 Attacker Model. Most attackers are not located on the path
between the nameservers of a victim domain and the VAs of Let’s
Encrypt but are off-path to the victims that they wish to attack.
BGP prefix hijacks enable off-path attackers to become on-path
for the communication exchanged with the hijacked prefix. In this
section we show how to apply BGP prefix hijacks for intercepting
the communication between the nameservers and the VAs when the
attacker is off-path and is not located on the communication path.
Our BGP prefix hijacks are short-lived and are aimed at hijacking
the DNS packets exchanged between the DNS resolver software at
the VAs and the nameservers of victim domains. Short-lived BGP
hijacks are common attack in the Internet [8, 22, 27].
Our attacker model is the same as the one against which Let’s
Encrypt guarantees security [15]. This is also the attacker that was
used in [14] to demonstrate insecurity of a single node DV. The
attacker controls a BGP router and issues BGP announcements
hijacking the same-prefix or a sub-prefix of a victim AS in the
Internet. We show how the attacker can perform same-prefix and
sub-prefix BGP hijacks of the VAs and the nameservers, explain the
differences, and the implications of both these hijacks on the traffic
that is intercepted during the interaction with Let’s Encrypt.
The attacker sets up a malicious DNS nameserver with a zonefile,
that corresponds to the resources in the victim domain all mapped
to the IP addresses of the attacker.
The victim AS is either a network hosting one or more of the
nameservers of the target domain or the network hosting the VA.
The target domain is the domain for which the attacker wishes to
issue a fraudulent certificate. The target domain has nameservers
which serve records from the DNS zone of that domain. The goal
is to hijack the same-prefix or a sub-prefix either of one or more
nameservers of the target domain or to hijack the VAs. If the hijack
succeeds, the attacker will receive all the traffic destined to the
victim AS. To avoid blackholing the attacker should relay the traffic
to the destination. In our attack against Let’s Encrypt the goal of the
attacker is to intercept the DNS queries sent by the VAs, or the DNS
responses sent by the nameservers. The attacker configures a filter
for matching the IP addresses of the hijacked AS, in order to catch
the target DNS packet. The attacker forwards all the remaining
traffic to the legitimate destination.
We next explain how our attacker launches sub-prefix hijacks in
Figure 12 and same-prefix hijacks in Figure 11 and how it impacts
the traffic flow.
A.2 Same-Prefix vs. Sub-Prefix BGP Hijack
Same-prefix BGP hijack. The attacker advertises the same
A.2.1
prefix as the victim AS and as a result can intercept traffic from
all the ASes that have less hops (shorter AS-PATH) to the attacker
than to the victim AS. Example same-prefix hijack attacks, for
intercepting a DNS request or a DNS response is illustrated in
Figure 11.
How effective are same-prefix attacks? The limitation of the same-
prefix hijack is that it only affects the traffic of the ASes that prefer
the attacker’s announcement, and does not propagate to all parts
of the Internet. Hence, the effectiveness of the same-prefix hijack
attacks depends on the local preferences of the ASes and the loca-
tion of the attacker’s AS. In particular, the same-prefix attack only
attracts traffic from ASes that have shorter path (i.e., less hops) to
the attacker. Namely, the closer the attacker is to the victim (i.e.,
the shorter the AS-PATH is), the more effective the attack is. Hence
the success of our hijack attack against the multiVA based DV of
Let’s Encrypt depends on the topological relationship between the