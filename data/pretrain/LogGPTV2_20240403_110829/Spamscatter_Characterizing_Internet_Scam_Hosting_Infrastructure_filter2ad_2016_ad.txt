resulting in 2,334 scams; on average, then, each scam
was advertised by 137 spam emails. We use these re-
peated spam emails to determine the lifetime of spam
campaigns for a scam by measuring the time between
the ﬁrst and last spam email messages advertising that
scam. Figure 11 shows the distribution of the spam cam-
paign lifetimes. Compared to the lifetime of scam sites,
most spam campaigns are relatively short. Over 50%
of the campaigns last less than 12 hours, over 90% last
less than 48 hours, and 99% last less than three days.
Roughly speaking, the lifecycle of a typical scam starts
with a short spam campaign lasting half of a day while
the scam site remains up for at least a week.
The relative lifetimes of spam campaigns and scam
hosts again reﬂect the different needs of the two ser-
vices. Compared with scam hosts, spam relays need to
be active for much shorter periods of time to accomplish
their goals. Spammers need only a window of time to
distribute spam globally; once sent, spam relays are no
longer needed for that particular scam. Scam hosts, in
contrast, need to be responsive and available for longer
periods of time to net potential clients. Put another way,
spam is blanket advertising that requires no interaction
with users to deliver, whereas scam hosting is a service
that fundamentally depends upon user interaction to be
successful.
In contrast, scam hosts beneﬁt more from
stable infrastructure that remains useful and available for
much longer periods of time.
5.5 Stability
A proﬁtable scam requires stable infrastructure to serve
potential customers at any time, and for as long as the
scam is active. To gauge the stability of scam hosting
infrastructure, we probed each scam host periodically for
a week to measure its availability. When downloading
pages from the hosts, we also used p0f to ﬁngerprint host
operating systems and link connectivity.
We computed scam availability as the number of suc-
cessful Web page downloads divided by the total number
USENIX Association
16th USENIX Security Symposium
145
n
o
i
t
c
a
r
F
1
0.8
0.6
0.4
0.2
0
3
2.0.0.0
6
4.0.0.0
9
6.0.0.0
Webserver IPs
Sender IPs
1
2
8.0.0.0
1
6
0.0.0.0
1
9
2.0.0.0
/24 prefix
Figure 12: IP addresses, binned by /24 preﬁx, for spam
sending relays and scam host servers.
of download attempts within the overall lifetime of the
scam; if a scam lasted for only three days, we computed
availability only during those days. Scams had excellent
availability: over 90% of scams had an availability of
99% or higher. Of the remaining, most had availabilities
of 98% or higher. As ﬁngerprinted by p0f, more scams
ran on Unix or server appliances (43%) than Windows
systems (30%), and all of them had reported good link
connectivity. These results indicate that scam hosting is
quite reliable within the lifetime of a scam.
5.6 Scam location
We next examine both the network and geographic loca-
tions of scam hosts. For comparison, we also examine
the locations of the spam relays that sent the spam in our
trace. Comparing them highlights the extent to which the
different requirements of the two services reﬂect where
around the world and in the network they are found.
5.6.1 Network location
The network locations of spam relays and scam hosts are
more consistent. Figure 12 shows the cumulative distri-
bution of IP addresses for spam relays and scam hosts
in our trace. Consistent with a similar analysis of spam
relays in [27], the distributions are highly non-uniform.
The IP addresses of most spam relays and scam hosts fall
into the two same ranges, 58.* to 91.* and 200.* to 222.*.
However, within those two address ranges hosts for the
two services have different concentrations. The majority
of spam relays (over 60%) fall into the ﬁrst address range
and are distributed somewhat evenly except for a gap be-
tween 70.* and 80.*. Roughly half of the scam hosts
also fall into the ﬁrst address range, but most of those
Scam host country % of all servers
United States
China
Canada
Great Britain
France
Germany
Russia
South Korea
Japan
Taiwan
Other
57.40%
7.23%
3.70%
3.07%
3.06%
2.52%
1.80%
1.77%
1.60%
1.53%
16.32%
Table 4: Countries of scam hosts.
Spam relay country % of all relays
United States
France
Spain
China
Poland
India
Germany
South Korea
Italy
Brazil
Other
14.50%
7.06%
6.75%
6.65%
5.68%
5.42%
5.00%
4.67%
4.44%
3.86%
30.97%
Table 5: Countries of spam relays.
fall into the 64.* to 72.* subrange and relatively few in
the second half of the range. Similarly, scams are more
uniformly distributed within the second address range as
well.
5.6.2 Geographic location
How do these variations in network address concentra-
tions map into geographic locations? The effectiveness
of scams could relate to (at least perceived) geographic
location. As one anecdote, online pharmaceutical ven-
dors utilized hosting servers inside the United States to
imply to their customers that they were providing a law-
ful service [24].
Using Digital Element’s NetAcuity tool [10], we
mapped the IP addresses of scam hosts to latitude and
longitude coordinates. Using these coordinates, we then
identiﬁed the country in which the host was geographi-
cally located. Table 4 shows the top ten countries con-
taining scam hosts in our trace.
Interestingly, the Ne-
tAcuity service reported that nearly 60% of the scam
hosts are located in the United States. Overall, 14% were
located in Western Europe and 13% in Asia. For compar-
146
16th USENIX Security Symposium
USENIX Association
ison, Table 5 shows the top ten countries containing spam
relays. The geographic distributions for spam relays are
quite different than scam hosts. Only 14% of spam relays
are located in the United States, whereas 28% are located
in Western Europe and 16% in Asia. We also found the
top ASes for scam hosts and senders, but found no dis-
cernible pattern and omit the results for brevity.
The strong bias of locating scam hosts in the United
States suggests that geographic location is more impor-
tant to scammers than spammers. There are a number
of possible reasons for this bias. One is the issue of
perceived enhanced credibility by scammers mentioned
above. Another relates to the difference in requirements
for the two types of services. As discussed in Sec-
tion 5.4.2, spam relays can take advantage of hosts with
much shorter lifetimes than scam hosts. As a result, spam
relays are perhaps more naturally suited to being hosted
on compromised machines such as botnets; the compro-
mised machine need only be under control of the spam-
mer long enough to launch the spam campaign. Scam
hosts beneﬁt more from stability, and hosts and networks
within the United States can provide this stability.
6 Conclusion
This paper does not study spam itself, nor the infrastruc-
ture used to deliver spam, but rather focuses on the scam
infrastructure that is nourished by spam. We demonstrate
the spamscatter technique for identifying scam infras-
tructure and how to use approximate image comparison
to cluster servers according to individual scams — side-
stepping the extensive content and networking camou-
ﬂaging used by spammers.
From a week-long trace of a large real-time spam feed
(roughly 150,000 per day), we used the spamscatter tech-
nique to identify and analyze over 2,000 distinct scams
hosted across more than 7,000 distinct servers. We found
that, although large numbers of hosts are used to ad-
vertise Internet scams using spam campaigns, individual
scams themselves are typically hosted on only one ma-
chine. Further, individual machines are commonly used
to host multiple scams, and occasionally serve as spam
relays as well. This practice provides a potentially con-
venient single point for network-based interdiction either
via IP blacklisting or network ﬁltering.
The lifecycle of a typical scam starts with a short spam
campaign lasting half of a day while the scam site re-
mains up for at least a week. The relative lifetimes of
spam campaigns and scam hosts reﬂect the different re-
quirements of the two underground services. Spam is
blanket advertising that requires no interaction with users
to deliver, whereas scam hosting is a service that funda-
mentally depends upon user interaction to be successful.
Finally, mapping the geographic locations of scam hosts,
we found that they have a strong bias to being located
in the United States. The strong bias suggests that ge-
ographic location is more important to scammers than
spammers, perhaps due to the stability of hosts and net-
works within the U.S.
Acknowledgments
We would like to thank a number of people who made
contributions to this project. We are particularly grateful
to Weidong Cui and Christian Kreibich, who maintained
the spam feed we used for our analyses, the anonymous
party who gave us access to the spam feed itself, and Vern
Paxson for discussions and feedback. Kirill Levchenko
suggested image-based comparison of Web pages as an
equivalence test, and Colleen Shannon assisted us with
Digital Element’s NetAcuity tool. Finally, we would
like to also thank the the anonymous reviewers for their
comments, the CCIED group for useful feedback on the
project, and Chris X. Edwards for system support. Sup-
port for this work was provided in part by NSF under
CyberTrust Grant No. CNS-0433668 and AFOSR MURI
Contract F49620-02-1-0233.
References
[1] ANTI-PHISHING WORKING GROUP. Report Phishing. http:
//www.antiphishing.org/.
[2] BARFORD, P., BESTAVROS, A., BYERS, J., AND CROVELLA,
M. On the marginal utility of network topology measurements. In
In Proceedings of ACM SIGCOMM Internet Measurement Work-
shop (Oct. 2001).
[3] B ¨OHME, R., AND HOLZ, T. The effect of stock spam on ﬁnancial
markets. In Proceeedings of the Fifth Workshop on the Economics
of Information Security (WEIS 2006) (June 2006).
[4] BRODER, A. Z. On the resemblance and containment of doc-
uments. In Proceedings of the Compression and Complexity of
Sequences (SEQUENCES’97) (June 1997), pp. 21–29.
[5] CASADO, M., GARFINKEL, T., CUI, W., PAXSON, V., AND
SAVAGE, S. Opportunistic measurement: Extracting insight from
spurious trafﬁc. In Proceedings of the 4th ACM Workshop on Hot
Topics in Networks (HotNets-IV) (College Park, MD, Nov. 2005).
Fried Phish: Phishing Incident Reporting
and Termination (PIRT). http://www.castlecops.com/
pirt.
[6] CASTLECOPS.
[7] CHOU, N., LEDESMA, R., TERAGUCHI, Y., BONEH, D., AND
MITCHELL, J. C. Client-side defense against Web-based identity
theft. In Proceedings of the 11th Annual Network and Distributed
System Security Symposium (NDSS ’04) (Feb. 2004).
[8] COOKE, E., BAILEY, M., MAO, Z. M., WATSON, D., JAHA-
NIAN, F., AND MCPHERSON, D. Toward understanding dis-
In Workshop on Rapid Malcode
tributed blackhole placement.
(WORM’04) (Oct. 2004).
[9] COOKE, E., JAHANIAN, F., AND MCPHERSON, D. The zom-
bie roundup: Understanding, detecting, and disrupting botnets.
In Proceedings of the First Workshop on Steps to Reducing Un-
wanted Trafﬁc on the Internet (SRUTI’05) (July 2005).
USENIX Association
16th USENIX Security Symposium
147
[10] DIGITAL ELEMENT.
NetAcuity IP Intelligence.
//www.digital-element.net/ip_intelligence/
ip_intelligence.html/.
http:
[11] FETTERLY, D., MANASSE, M., AND NAJORK, M. On the evo-
lution of clusters of near-duplicate Web pages. In Proceedings of
the First Latin American Web Congress (Nov. 2003), pp. 37–45.
[12] GILLIS, T. Internet Security Trends for 2007. Ironport Whitepa-
per, 2007.
[13] IRONPORT INC.
Spammers continue innovation.
IronPort
press release, June 28, 2006. http://www.ironport.com/
company/ironport_pr_2006-06-28.html.
[14] KDE. Khtml layout engine. http://www.kde.org/.
[15] KEIZER, G.
Spam volume jumps 35% in November,
http://informationweek.com/news/
Dec. 2006.
showArticle.jhtml;?articleID=196701527.
[29] SHIVAKUMAR, N., AND GARCIA-MOLINA, H. Finding near-
replicas of documents and servers on the Web. In Proceedings
of the First International Workshop on the Web and Databases
(WebDB’98) (Mar. 1998).
[30] VENKATESAN, R., KOON, S. M., JAKUBOWSKI, M. H., AND
MOULIN, P. Robust image hashing. In Proceedings of the IEEE
International Conference on Image Processing (ICIP’00) (Sept.
2000).
[31] WEBB, S., CAVERLEE, J., AND PU, C. Introducing the Webb
spam corpus: Using email spam to identify Web spam automati-
cally. In Proceedings of the 3rd Conference on Email and Anti-
Spam (CEAS) (Mountain View, 2006).
[32] YEGNESWARAN, V., BARFORD, P., AND PLONKA, D. On the
design and use of Internet sinks for network abuse monitoring.
In Proceedings of Recent Advances on Intrusion Detection (Sept.
2004).
[16] MATHER,
T.
Perl mod-
http://search.cpan.org/˜tjmather/
Net::DNSBLLookup
ule.
Net-DNSBLLookup-0.03/.
[17] MESSAGELABS.
2006:
The year
spam raised its
http:
game and threats got personal, Dec. 2006.
//www.messagelabs.com/publishedcontent/
publish/about_us_dotcom_en/%news___events/
press_releases/DA_174397.html.
[18] MONGA, V., AND EVANS, B. L. Robust perceptual image hash-
ing using feature points. In Procedings of the IEEE International
Conference on Image Processing (ICIP’04) (Oct. 2004), pp. 677–
680.
[19] MOORE, D., PAXSON, V., SAVAGE, S., SHANNON, C., STAN-
IFORD, S., AND WEAVER, N. Inside the Slammer worm. IEEE
Security and Privacy 1, 4 (July 2003), 33–39.
[20] MOORE, D., SHANNON, C., BROWN, D., VOELKER, G. M.,
AND SAVAGE, S.
Inferring Internet denial-of-service activity.
ACM Transactions on Computer Systems 24, 2 (May 2006), 115–
139.
[21] MOORE, D., SHANNON, C., AND BROWN, J. Code-Red: a case
In Pro-
study on the spread and victims of an Internet worm.
ceedings of the ACM/USENIX Internet Measurement Workshop
(IMW) (Marseille, France, Nov. 2002).
[22] NEWS.ADMIN.NET-ABUSE.SIGHTINGS. USENET newsgroup
for discussion of spam. http://www.nanae.org/.
[23] PAUL B ¨AHER, THORSTEN HOLZ, MARKUS K ¨OTTER AND
GEORG WICHERSKI. Know your enemy: Tracking botnets. In
The Honeynet Project & Research Alliance (Mar. 2005).
[24] PHILADELPHIA INQUIRER.
Special
reports:
Drugnet.
http://www.philly.com/mld/inquirer/news/
special_packages/pill/.
[25] PHISHTANK. Join the ﬁght against phishing. http://www.
phishtank.com/.
[26] RAJAB, M. A., ZARFOSS, J., MONROSE, F., AND TERZIS,
A. A multifaceted approach to understanding the botnet phe-
In Proceedings of the ACM Internet Measurement
nomenon.
Conference (Rio de Janeiro, Brazil, Oct. 2006).
[27] RAMACHANDRAN, A., AND FEAMSTER, N. Understanding the
network-level behavior of spammers. In Proceedings of the ACM
SIGCOMM Conference (Pisa, Italy, Sept. 2006).
[28] ROOVER, C. D., VLEESCHOUWER, C. D., LEFEBVRE, F., AND
MACQ, B. Robust image hashing based on radial variance of
pixels. In Proceedings of the IEEE International Conference on
Image Processing (ICIP’05) (Sept. 2005), pp. 77–80.
148
16th USENIX Security Symposium
USENIX Association