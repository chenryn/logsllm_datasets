title:An Experimental Study on Instance Selection Schemes for Efficient
Network Anomaly Detection
author:Yang Li and
Li Guo and
Binxing Fang and
Xiangtao Liu and
Lin Qi
An Experimental Study on Instance Selection Schemes 
for Efficient Network Anomaly Detection 
Yang Li1,2, Li Guo2, Bin-Xing Fang2, Xiang-Tao Liu2, and Lin-Qi3 
1 China Mobile Research Institute, Beijing, China 100053 
2 Institute of Computing Technology, Chinese Academy of Sciences, Beijing, China 100190 
3 University of Maryland, America 21226 
PI:EMAIL 
Abstract.  Traditional  researches  on  network  anomaly  detection  have  been 
solely focused on the detection algorithms, whereas an important issue that has 
not been well studied so far is the selection of normal training data for network 
anomaly detection algorithm, which is highly related to the detection perform-
ance and computational complexities. In this poster, we present two instance se-
lection mechanism – EFCM (Enhanced Fuzzy C-Means) as well as GA (Genetic 
Algorithm) for network anomaly detection algorithm, aiming at limiting the size 
of  training  dataset,  thus  reducing  the  computational  cost  of  them,  as  well  as 
boosting  their  detection  performance.  We  report  our  experimental  results  on 
several classic network anomaly detection algorithms by using the network traf-
fic trace collected from a real network environment.  
To  our  best  knowledge,  this  topic  about  instance  selection  for  efficient  network 
anomaly detection is still hardly well addressed in any published literatures.  Most of 
current network anomaly detection algorithms are highly dependent on the training dataset [1, 
2], if the dataset is of poor quality or its size is too big, the detection performance would de-
grade greatly. The large size dataset would also cause additional expensive computational costs. 
In this poster, we therefore propose two instance selection schemes for anomaly de-
tection  algorithms:  FCM-based  instance  selection  mechanism  –  EFCM  (Enhanced 
Fuzzy C-Means) and Genetic Algorithm (GA), and provide the preliminary results. 
As for EFCM algorithm, we first utilize it to cluster the original training dataset into 
three classes: notable data, obscure data and redundant data. We refer to the notable 
data as what belong to and represent a series of clusters; the obscure data denotes those 
that belong to any cluster with very small (or under a very small constant) membership 
grades  calculated  by  FCM;  the  redundant  data  then  includes  the  remaining  data  that 
don’t belong to any of the above two classes. We then select some high quality “repre-
sentatives” as our training subset, which contains the most useful data that contribute the 
currently existing anomaly detection techniques to distinguish the normal from the ab-
normal  traffic.  Genetic  Algorithm  (GA)  is  optimization  algorithm  based  on  natural 
genetics  and  selection  mechanisms.  We  utilize  it  to  fulfill  the  instance  selection  task. 
Training dataset is denoted as TR with instances, and the search space associated with 
the instance selection of TR is constituted by all the subsets of TR. Then, the chromo-
somes should represent subsets of TR. This is accomplished by using a binary represen-
tation. A chromosome consists of genes (one for each instance in TR) with two possible 
states: 0 and 1. If the gene is 1, then its associated instance is included in the subset of 
E. Kirda, S. Jha, and D. Balzarotti (Eds.): RAID 2009, LNCS 5758, pp. 346–347, 2009. 
© Springer-Verlag Berlin Heidelberg 2009 
An Experimental Study on Instance Selection Schemes 
347 
TR represented by the chromosome. If it is 0, then this instance does not occur. After 
running GA algorithm, the selected chromosomes would be the reduced training dataset 
for network anomaly detection algorithms. 
From  our  preliminary  experimental  studies  on  EFCM  and  GA  (see  Table  1  and  
Table 2) over real network traffic trace, we found many useful results: Firstly, after 
employing  instance  selection  mechanisms,  we  found  their  computational  costs  re-
duced  greatly,  whereas  their  detection  performances  still  held  high  or  became  even 
better, which is an very important finding. For example, as for TCM-KNN algorithm 
[2], the size of training dataset is reduced almost 90%, and the training and detection 
time is reduced about 77%. Secondly, the detection rate (TP) appears a little decrease, 
while the false positive rate (FP) demonstrates an inspiring trend of decrease. Thirdly, 
the  effectiveness  of  EFCM  and  GA  methods  in  network  anomaly  detection  domain 
are comparable. Therefore, from these results we are apt to select EFCM as instance 
selection  methods  for  network  anomaly  detection  algorithms  in  real  network  envi-
ronment,  while  under  the  circumstances  of  having  no  restrict  requirements  on  the 
training speed, GA may be more suitable for leading to better detection performance.  
Table 1. Comparison Results after Using Instance Selection for Various Algorithms 
Algorithm 
Without instance  
selection 
One-classSVM[1] 
95.85% 
TP 
FP 
8.67% 
Fixed-width 
Clustering[1] 
KNN score[1] 
TCM-KNN[2] 
72.57% 
15.37% 
92.72% 
100% 
10.63% 
1.29% 
EFCM 
GA 
TP 
94.98% 
72.77% 
88.78% 
99.38% 
FP 
9.87% 
13.48% 
9.03% 
1.07% 
TP 
95.72% 
72.55% 
92.08% 
99.46% 
FP 
7.03% 
10.26% 
8.78% 
0.98% 
Table 2. Computational Costs after Instance Selection for Various Algorithms 
Without instance selection 
Detection 
Training 
EFCM 
GA 
Training 
Detection 
Training 
Detection 
time 
8680s 
213s 
1398s 
0.1007s 
time 
/ 
/ 
/ 
983s 
time 
7287s 
210s 
1293s 
0.0987s 
Algorithm 
One-class 
SVM 
Fixed-width 
Clustering 
KNN score 
time 
/ 
/ 
/ 
time 
26200s 
1098s 
29898s 
time 
/ 
/ 
/ 
TCM-KNN 
40418s 
0.4558s 
992s 
References 
1.  Eskin, E., Arnold, A., Prerau, M., Portnoy, L., Stolfo, S.: A geometric framework for unsu-
pervised anomaly detection: detecting intrusions in unlabeled data. In: Proc. ADMCS 2002, 
pp. 78–99 (2002) 
2.  Li, Y., Fang, B.X., Guo, L., Chen, Y.: Network Anomaly Detection Based on TCM-KNN 
Algorithm. In: Proc. ACM ASIACCS 2007, pp. 13–19 (2007)