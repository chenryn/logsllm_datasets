443
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
4.3.AutomaticConversion:ART-to-MDPUsingtheARTs,RRE’slocalenginesautomaticallycon-structresponsedecisionprocessmodels,wheresecuritystatesaredeﬁnedasabinaryvectorwhosevariablesareac-tuallythesetofsatisﬁed/unsatisﬁed(1/0)leafconsequencenodesintheARTunderconsideration.Inotherwords,asabinarystring,eachsecuritystatevectorrepresentstheleafnodeconsequencesthathavealreadybeensetto1accord-ingtothereceivedalertsfromIDSsystems.Forinstance,thesecuritystatespaceforanARTwithnleafnodescon-sistsof2nn-bitstatevectors.ForARTswithalargenum-berofleafnodes,thisexponentialgrowthofthesecuritystatespaceusuallyresultsinthestatespaceexplosionprob-lem,whichRREdealswithbymakinguseofapproximationtechniques,asdiscussedin§7.Oncelocalengineshavegeneratedthesecuritystatespace,thenextstepinthedecisionprocessmodelgener-ationistoconstructstatetransitionsforeachstates,i.e.,A(s).Asmentionedabove,inacurrentsecuritystates,therecanbeeitheroftwotypesofactions,responsiveAr(s)andadversarialAa(s),dependingontheplayermakingthedecision.First,instates,aresponseactionm∈Myieldsatransitiontostates(cid:3),inwhichbitsareallsimilartothoseofsexceptforthosebitsthatreﬂectleafnodesoftheARTsubtree,whoserootism(explainedin§4.1),whichare0ins(cid:3).Asaclarifyingexample,assumethatthesystemisinstates∈S,andRREdecidestoenforceresponseactionmr,whichisconnectedtotherootnodeintheART.Thesystem’snextstatewillbes(cid:3),inwhichallbitsare0,i.e.,themostsecurestate.Althoughitistemptingtoalwaystakemrwheneveranyleafnodestake1,acost-beneﬁtevalua-tion(discussedlater)usuallyresultsinthechoiceofanother,cheaperresponseaction,orintakingnoactionatall.Thesecondtypeofstate-action-statetransitionsinCMDPisthoseduetoadversarialactions.DuringautomaticART-to-CMDPconversioninRRE,eachleafconsequencenodelintheARTismappedtoanadversarialactionthatcausesthatltobesetto1.Inotherwords,supposethatthesystemisinasecuritystatesofCMDPs.Foreveryleafnodelwhosebitinsis0,atransitionisbuilttostates(cid:3),whereallbitsarethesameasins,exceptthatthebitrelatedtolis1.Itisobservedthatthereisnoadversaryactiontran-sitionfromthesinwhichallbitsarealreadyset,i.e.,themostinsecurestate.Theprobabilitiesofstatetransitionarcsk∈KinCMDPareassignedbasedonpreviousactions’successratescom-putedusingreportsfromlocalagents(see§4.5);moreover,rewardfunctionsr:K→(cid:6)mustalsobecalculated.In-deed,r(s,a,s(cid:3))ispayoffgainedbytheplayer,whoissuc-cessfullytakingactionainstatesandcausingatransitiontos(cid:3):r(s,a,s(cid:3))=(δg(s)−δg(s(cid:3)))τ1C(a)τ2,(4)where0≤τ1≤1andτ2≤0aretwoﬁxedparameters.δg(s)denotestherootnodecompromisationprobabilityoftheARTgraphgwhoseleafnodes’Booleanvariablesaresetaccordingtobitsins.Thisprobabilityissimplycom-putedusing(1)and(3).Obviously,δg(s(cid:3))≤δg(s),sinceaisaresponseaction.Furthermore,C(a)isthepositivecostfunctionforactionaregardlessofthesourceanddes-tinationstates.Thiscostfunctionshouldbedeﬁnedspecif-icallydependingontheapplicationforwhichitisused;forinstance,onereasonableoptionwouldbethemean-time-to-accomplishmeasure.Consequently,(4)assignshigherrewardstolesscostlyactionsthatcontributemoretotheoverallsecuritystate.HavingautomaticallygeneratedCMDPusingtheART,RREcannowsolvethedecisionprocesstoﬁndtheopti-malresponseaction.Asdiscussedearlier,duetoalackofknowledgeabouttheattacker’scostfunction,givenasys-tem’scurrentstate,RREusesthemaximinapproachtoﬁndthesecuritystrategyforthegame.Todoso,itmustknowtheexactcurrentstateofthesystem.Ateverytimeinstant,areasonablechoice(accordingtoleafnodes)isstates,wherebitsare1iftheircorrespondingleafnodesareset,andzerootherwise.Thus,inlocalengines,whereleafnodesofARTsaremappedtosubsetsofIDSalerts,thesystem’scurrentstatesconsistsof1sforbitsthatrepresentsatisﬁedleafnodesaccordingtoreceivedalerts,and0sforotherbitsins.Asmentionedearlier,thefactthatleafnodeshavebeensetdoesnotnecessarilymeanthattheyaretrulypositive,asin(1);hence,uncertaintyinreceivedinformationpreventsRREfrompreciselyﬁguringoutthecurrentsecuritystateofthesystem.However,theprobabilityofbeingineachstateiscalculatedasfollows:b(s)=(cid:3)l∈L(1[sl=1].δ(l)+1[sl=0].(1−δ(l)))(5)whereListhesetofleafnodesintheART;δ(l)iscomputedasin(1);slisthebitinstatesthatcorrespondstoleafnodel;and1[expr]istheindicatorfunction,andis1ifexpristrue,and0otherwise.Itisworthnotingthat(5)isbasedontheimplicitassumptionofindependenceamongleafnodes.Therefore,toconsideruncertainty,insteadofdetermin-ingtheexactcurrentstateofthesystem,weobtainaprob-abilitydistributionb(.)onstatespaces∈S(calledthebe-liefstate)using(5).Theaxiomsofprobabilityrequirethat0≤b(s)≤1foralls∈Sandthat(cid:4)s∈Sb(s)=1.Uncertaintyinupdatinginputs,i.e.,IDSalerts,convertsourMarkoviandecisionprocessintoahigher-levelmodel,calledapartiallyobservablecompetitiveMarkovdecisionprocess(POCMDP),whichissimilartothemodelde-scribedin[11]withthesubtledifferencethat[11]studiessimultaneousgames,whereasthegamehereissequential.Indeed,statesb∈B,inthishigher-levelmodel,areprob-abilitydistributionsoverasetofstatesSintheunderlyingMarkoviandecisionprocessmodel.4.4.OptimalResponseStrategyAsthelaststepinthedecision-makingprocessinlocalengines,RREsolvesthePOCMDPtoﬁndanoptimalre-sponseactionfromitsactionspace,andsendsanactioncommandtoitsagentsthatareinchargeofenforcingre-ceivedcommands.ActionoptimizationinRREisaccom-plishedbytryingtomaximizetheaccumulativelong-runrewardmeasurereceivedwhiletakingsequentialresponseactions.Toaccumulatesequentialachievedrewards,here,weusetheinﬁnite-horizondiscountedcosttechnique[12],whichgivesmoreweighttonearerfuturerewards.Inotherwords,ineachstep,thegamevalueiscomputedbyrecur-sivelyaddinguptheimmediaterewardafterbothplayers978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
444
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
taketheirnextactionsandthediscountedexpectedgamevaluefromthenon.Toformalizetheexplanationjustgiven,thesolutionofaPOCMDPconsistsincomputinganoptimalpolicy,whichisafunctionπ∗thatassociateswithanybeliefstateb∈Banoptimalactionπ∗(b),whichisanactionthatmaximizestheexpectedaccumulativerewardontheremainingtemporalhorizonofthegame.Asdiscussedabove,thisaccumulativerewardisdeﬁnedasthediscountedsumofthelocalrewardsrthatareassociatedwiththeactualactiontransitions.TheMarkoviandecisionprocesstheoryassignstoeverypolicyπavaluefunctionVπ,whichassociateseverybeliefstateb∈BwithanexpectedglobalrewardVπ(b)obtainedbyapplyingπinb.Forﬁnite-horizonPOMDPs,theoptimalvaluefunctionispiecewise-linearandconvex[25],anditcanberepresentedasaﬁnitesetofvectors.Intheinﬁnite-horizonformulation,aﬁnitevectorsetcancloselyapprox-imatetheoptimalvaluefunctionV∗,whoseshaperemainsconvex.Bellman’soptimalityequations(6)characterizeinacompactwaytheuniqueoptimalvaluefunctionV∗,fromwhichanoptimalpolicyπ∗,whichisdiscussedlater,canbeeasilyderived:V∗(b)=maxar∈Ar(b)Ψ(V∗,b,ar)(6)whereA(b)=∪s∈S:b(s)(cid:5)=0A(s).A(.)ispartitionedintoAr(.)andAa(.)forresponseandadversaryactions,respec-tively.Ψisdeﬁnedin(7),inwhichρisthePOCMDPre-wardfunction.ρiscomputedusingrewardfunctionrintheinherentCMDP:ρ(b,a,b(cid:3))=(cid:5)s,s(cid:2)∈Sb(s)b(cid:3)(s(cid:3))r(s,a,s(cid:3)).(8)Here,b(cid:3)b,a,oistheupdatednextbeliefstateifthecurrentstateisb,actionaistaken,andobservationoisreceivedfromsensors:b(cid:3)b,a,o(s(cid:3))=P(s(cid:3)|b,a,o)=P(o|s(cid:3))(cid:4)s∈SP(s(cid:3)|s,a)b(s)(cid:4)s(cid:2)(cid:2)∈SP(o|s(cid:3)(cid:3))(cid:4)s∈SP(s(cid:3)(cid:3)|s,a)b(s),(9)where,duetotheindependenceassumptionamongtheART’sleafnodes,wehaveP(o|s)=(cid:3)l∈L(1[sl=1].P(o|l)+1[sl=0].P(¯o|l)),(10)whereP(¯o|l)=1−P(o|l),andP(o|l)issimplyobtainedusing(2).Oncethepartiallyobservabledecisionprocessisformu-lated,theoptimalresponseactionischosenbasedontheoptimalvaluefunction.Therearedifferenttechniquesforgettingtheoptimalvaluefunction.Thedecision-makingunitinRREusesavalueiterationtechnique[3]:Vt(b)=maxar∈Ar(b)Ψ(Vt−1,b,ar),(11)whichappliesdynamicprogrammingupdatestograduallyimproveonthevalueuntilitconvergestothe-optimalvaluefunction,i.e.|Vt(b)−Vt−1(b)|<.Throughim-provementofthevalue,thepolicyisimplicitlyimprovedaswell.Finally,optimalpolicyπ∗mapsthesystem’scurrentbeliefstatebtoaresponseaction:π∗(b)=argmaxar∈Ar(b)Ψ(V∗,b,ar),(12)which,inlocalengines,issenttoRREagentsthatareinchargeofcarryingoutthereceivedresponseactioncom-mands.Agentsthensendstatusmessagestothedecision-makingunit,indicatingwhetherthereceivedactioncom-mandhasbeenaccomplishedsuccessfully.Ifithas,thedecision-makingunitupdatestheleafnodesandvariablesinthecorrespondingART.Sofar,wehavediscussedhowRRE’slocalenginees-timateslocalsecuritystateanddecidesuponandtakeslo-calresponseactionsfollowingalertsreceivedfromtheIDS.Next,wewilladdresshowRRE’sservermakesuseoflo-calinformationreceivedfromlocalenginestoestimatethesecuritystatusofthewholenetwork,andthendecidewhatglobalresponseactionstotake.TheinformationthatissentbylocalenginestoRRE’sserverconsistsofrootproba-bilitiesδg,ascomputedin(3),oflocalARTs.Inthecur-rentimplementationofRRE,theseincludethreerootnodeprobabilitiesofthreeARTtreesreﬂectingconﬁdentiality,integrity,andavailabilityoflocalhostsystems.4.5.AgentsIntheabovementionedsecuritybattlebetweenRREandtheadversary,agentsplayakeyroleinaccomplishingeachstepofthegame.TheyareinchargeoftakingresponseactionsdecidedonbyRREengines.Actually,havingre-ceivedcommandsfromengines,agentstrytocarrythemoutsuccessfullyandreporttheresult,whethertheyweresuccessfulornot,backtotheengine.Iftheagent’sreportindicatesthatsomeresponseactionhasbeentakensuccess-fully,theenginesupdatetheirARTtrees’correspondingvariables,whichareleafnodevaluesinthesubtreeforthesuccessfullytakenresponseactionnode.Consequently,asexplainedabove,leafnodevariablesinARTtreesareup-datedbytwotypesofmessages:IDSalertsandagents’re-ports.Otherwise,iftheagentcannotrespondsuccessfully(e.g.,withinaspeciﬁcamountoftime),thesecond-bestac-tionissentbytheenginetocarryout.5.GlobalResponseandRecoveryAlthoughhost-basedintrusionresponseistakenintoac-countbyRRE’slocalenginesusinglocalARTsandtheIDSrule-setforcomputingassets,e.g.,theSQLserver,mainte-nanceofglobalnetwork-levelsecurityrequiresinformationaboutunderlyingnetworktopologyandprofoundunder-standingaboutwhatdifferentcombinationsofsecureassetsarenecessarytoguaranteenetworksecuritymaintenance.InRRE,globalnetworkintrusionresponseisresolvedintheglobalserver,where,justasinlocalengines,ARTsareusedforcorrelatingreceivedinformation,andthenmaximinthe-oryisappliedtochoosetheoptimalglobalresponseaction.SuchachoiceisnotpossibleinlocalenginesduetoeithertheirlimitedlocalinformationortheirinabilitytomanagecooperationamongdistributedRREagents.IncontrasttoARTsinlocalenginesforcomputingas-setsthatdemandone-timedesigneffortforeachasset(asinIDSrule-sets),globalARTsinRRE’sserverfornetworksecurityshouldbedesignedspeciﬁcallyforeachindividualnetworkinwhichRREisdeployed,sincethesehigher-level978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
445
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
Ψ(V,b,a)=(cid:5)o∈OP(o|b,a).{ρ(b,a,b(cid:3)b,a,o)+√γ.[minaa∈Aa(b(cid:2)b,a,o)(cid:5)o(cid:2)∈OP(o(cid:3)|b(cid:3)b,a,o,aa).(cid:6)ρ(b(cid:3)b,a,o,aa,b(cid:3)(cid:3)b(cid:2),aa,o(cid:2))+√γ.V(b(cid:3)(cid:3)b(cid:2),aa,o(cid:2))(cid:7)]}(7)ARTsdependonnetworktopology,whichimplicitlyaffectsanetwork’sglobalsecuritystate.Inourcurrentimplemen-tation,thereisonlyoneglobal,i.e.,network-level,ARTinRREthatmustbedesignedbyanexpert.Generally,globalARTsinRRE’sserverhavethesamestructurediscussedin§4.1,thoughsomeclarifyingexpla-nationsareneededregardingtheirrootandleafnodes.Asdiscussedin§4.4,localenginessendtheirlocalsecurityestimates,i.e.,rootnodeprobabilitiesδgoftheirARTs,toRRE’sserver.Indeed,localsecurityestimatescontributetoleafnodesintheglobalARTinRRE’sserver.Furthermore,thetop-eventnodeoftheARTintheglobalengineislabeled“networksecurityviolation,”andisdeﬁnedandformulatedaccordingtotheunderlyingnodes.Inotherwords,networksecurityisdeﬁnedbytheglobalARTinRRE’sserverus-ingitsleafnodes,whicharethemselvesrootnodesoflocalARTsinRRE’slocalengines.GlobalARTisemployedforquantitativeevaluationofanetwork’ssecuritystate.Thecorrelationandresponsese-lectioncalculationsarethesameasinlocalARTs(§4),exceptthatforglobalART,thebasicleafnodelprobabilitymeasuresarecomputedasδ(l)=δg(l),whereg(l)denotesthelocalARTcorrespondingtoleafnodeloftheglobalARTinRRE’sserver.6.CaseStudy:SCADANetworksInthissection,wedescribetheresponseselectionpro-cessforacasestudyprocesscontrolnetworkforapowergrid.Wehavechosensupervisorycontrolanddataacquisi-tion(SCADA)networksasourcasestudyfortworeasons.First,sincetheycontrolphysicalassets,theyneedtimelyresponseinthepresenceofattacks.Second,incontrasttogeneralITcomputernetworks,theyconsistofcomputingassetswithpredeﬁnedspeciﬁcresponsibilitiesandcommu-nicationpatterns;thissimpliﬁesthedesignprocessforcom-prehensiveARTsandIDSeswiththoroughalertsets.Fig.3showsasample3-buspowergridanditsSCADAnetwork,whichisresponsibleformonitoringandcontrol-lingtheunderlyingpowersystem.Thereareatotalofthreegenerators,anyoneofwhichisabletoprovidethepowerrequiredbycustomers,i.e.,load.Tomonitorthepowersys-tem,eachbusisattachedtoasensor,i.e.,aphasormeasure-mentunit(PMU).Thesensorsendsvoltagephasors(i.e.,magnitudesandphaseangles)ofthebusandcurrentpha-sorsoftransmissionlinesconnectedtothatparticularbustoSCADA.Moreover,tocontrolpowergeneration,havingreceivedsensorydata,SCADAcomputesoptimalgenera-tionsetpointsforindividualgenerators.AsshowninFig.3,SCADAconsistsofdifferentcomponents,amongwhichthereareconstrainedcommunications.Firstofall,givennoisysensorydata,thestateestimationserverisresponsi-bleforestimatingthestateofthewholepowersystem.Adatabasestoresthesestatesandotherinformationthatmightbeusedlaterbyadministratorsorcustomersthroughthewebserver.Thehumanmachineinterface(HMI)andse-curityconstrainedoptimalpowerﬂow(SCOPF)computeFigure3.Casestudy:SCADAnetworksFigure4.Attack-responsetreecontrolcommandsusingthoseestimatedstates.Asdemon-strated,ahotspareHMIisalsoactiveandconnectedaspartofthenetwork.Fig.4illustratesasamplebriefnetwork-levelARTfortheprocesscontrolnetworkdescribedabove.Thetopeventischosentobe“SCADAiscompromised,”anditschildrendenotedeﬁcienciesinprovidingloadsandreportgenera-tion,whicharetwomaingoalsofthesupervisorynetwork.Forsimplicity,leafnodesheredenotecompromiseofindi-vidualhostsystems,andareupdatedbylocalengines.Asacaseinpoint,G1,ifsetto1,indicatesthatthecontrollerde-viceforthegeneratoronbus3iscompromised,andtheup-perresponsenode“restart”showsthatacountermeasureforthecompromisedcontrolleristoreinstallthecontrolsoft-wareandrestartthedevice.Detailssuchasactioncosts,rates,andprobabilitiesarenotshown.Thecyber-securitystatespacedeﬁnitionfortheaboveattack-responsetreeisshowninFig.5asabinaryvector,whereeachindividualbitissetbasedonreportsfromlocalengines.Forinstance,thesamplestatevectorintheﬁgureindicatesthatHMIandG1arecompromised,accordingtoreportsfromtheircorrespondinglocalengines,whileotherhostsareintheirnormaloperationalmode.Giventheattack-responsetreeandreportsfromlocalen-gines,RREstartsonlineconstructionofitsaccompanyingpartiallyobservablecompetitiveMarkovdecisionprocess.Startingfromthecurrentstate,i.e.,s=(000100000010)978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE