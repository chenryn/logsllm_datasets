on background tasks. We did not ﬁnd any ofﬁcial documentation
on how much time an application is allowed to run in the
background on iOS, yet an Apple staff member has stated on
the ofﬁcial Apple Developer Forums that this is around three
minutes after losing focus [10]. Similarly for Android, this
exact time limit is undocumented, but is said to be around ten
minutes before the application is forced into idle mode [7].
Likewise, EPUB reading systems can invoke this function-
ality to remain running when switched to the background,
increasing the time window of a potential attack. By embedding
a counter inside the EPUB, we can detect whether a switch to
the background paused the embedded JavaScript execution.
B. Evaluated EPUB reading systems
This testbed was used to evaluate a set of 92 free EPUB
reading systems, available for desktop platforms (Windows 10,
macOS 10.14.6 and Linux Ubuntu 18.04), mobile platforms
(iOS 12 and Android 9) or as browser extensions (Chrome
78 and Firefox 70). We used the iOS App Store, Google
Play Store, Chrome Web Store and Firefox Add-on Store
for selecting and installing reading systems on iOS, Android,
Chrome and Firefox. The selection was based on the store’s
search functionality, using the terms “epub reader” and “ebook
reader”, scanning the ﬁrst 100 results each time. For Android,
we limited our selection to applications that were downloaded
by at least 5.000 users. For the desktop platforms, we used a
web search engine to make up the selection of EPUB reading
systems, also leveraging curated lists. Here, we installed all
encountered applications by downloading them from a website
or installing them using the respective application store of
the platform. By converting the evaluation EPUBs to AZW
e-books, we also evaluated Kindle applications if available on
the platform. For a complete overview of all evaluated EPUB
reading systems, we refer to Appendix A.
Additionally, we evaluated the ﬁve most popular physical
e-reader devices (Kindle Paperwhite 4, PocketBook Touch HD
3, Kobo Clara HD, Onyx Nova Pro, Tolino Shine 3). Their
pre-installed EPUB rendering applications were tested out-of-
the-box.
V. RESULTS
This section will cover the results obtained by performing the
semi-automated evaluation described in the previous section.
Some reading systems were not able to render a perfectly
compliant EPUB 3.2 e-book and were therefore excluded from
our evaluation (see Appendix A).
A. Desktop
For desktop-based reading systems, experiments were run
on Windows 10 (17763), macOS (10.14.6) and Ubuntu (18.04).
1) Windows: Table I shows the results of our evaluation on
the Windows platform, which consisted of 15 reading systems.
Of these reading systems, ﬁve execute embedded JavaScript,
which can be escalated to leak at least the existence of certain
ﬁles, and two of them can even be abused to leak ﬁle contents.
Calibre 3 and MS Edge grant EPUBs the ability to open third-
party applications installed on the user’s operating system.
Interestingly, only the latter asks for the user’s consent.
Interestingly, Adobe Digital Editions’s rendering behavior
differs between ﬁles residing on the local ﬁle system and ﬁles
residing on a network share. Although the means of access
are identical; through an absolute ﬁle path, it only allows
an EPUB to render images located on the former, whereas
textual ﬁles (.html and .txt), images, audio and video can
be rendered if located on the latter. This can be exploited
to enumerate both local ﬁles and ﬁles residing on a network
share. This vulnerability was assigned CVE-2020-3798, and
has been resolved since Adobe’s 4.5.11.187303 release of the
application [3].
Our tests identiﬁed WebKit 538.1 as the underlying browser
for both Calibre 3 and Icecream Ebook Reader, which was
released in 2014. This engine is considered insecure, since
several vulnerabilities are publicly disclosed. For instance, by
leveraging such a vulnerability [38], we were able to leak
arbitrary ﬁle contents in Calibre 3. Fortunately, Calibre started
using an updated engine since its major update to version 4,
effectively mitigating this vulnerability.
2) macOS: As shown in Table II, except for FBReader and
Amazon’s Kindle application, all reading systems evaluated
on macOS support JavaScript execution. All reading systems
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:14:25 UTC from IEEE Xplore.  Restrictions apply. 
1736
EVALUATION RESULTS FOR EPUB READING SYSTEMS ON MACOS.
TABLE II
Application
JavaScript
Local
Remote
Existence
Local Resources
Render
ƭ Ʃ o q n ƫ Ƭ Ƨ
ƭ Ʃ o q ƫ Ƭ Ƨ
ƭ Ʃ o q n ƫ Ƭ Ƨ
Adobe Digital Editions (4.5.10)
Apple Books (1.17)
Azardi (43.1)
BookReader (5.14)
Calibre (3.40.1)
(4.3.0)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
Ʃ: .png/.jpg ﬁle
∗ Allows EPUB to open URL in default browser.
† Allows access to LocalStorage of other EPUBs.
‡ Attempts to load all resources in the default application without consent (except fonts).
FBReader (0.9.0)
Kindle (1.25.2)
Kitabu (1.2)
Murasaki (1.0.2)
ƭ Ʃ o q n ƫ Ƭ Ƨ
ƭ Ʃ o q ƫ Ƭ Ƨ
ƭ Ʃ o q ƫ Ƭ Ƨ
Ƨ‡
ƭ Ʃ o q ƫ Ƭ Ƨ
Ƨ
ƭ Ʃ o q n ƫ Ƭ Ƨ
ƭ: .html ﬁle
o: .txt ﬁle
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
q: .log ﬁle
-
-
-
-
-
-
-
-
-
-
Leak
-
-
ƭ Ʃ o q n
ƭ Ʃ o q n
-
-
-
-
-
ƭ Ʃ o q n
n: .bogus ﬁle
Remote
communication
Persistent storage
Cookies
LocalStorage
Features
URI handles
Insecure
engine
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
ƫ: .mp3 ﬁle
(cid:35)
(cid:32)
(cid:32)
(cid:32)†
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
-
-
-
-
-
-
-
-
-
-
Ƭ: .mp4 ﬁle
(cid:32)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
(cid:35)∗
(cid:35)
(cid:35)∗
(cid:32)
(cid:35)
Ƨ: .ttf
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
-
-
EVALUATION RESULTS FOR EPUB READING SYSTEMS ON LINUX UBUNTU.
TABLE III
Application
JavaScript
Local
Remote
Existence
Local Resources
Render
ƭ Ʃ o q n ƫ Ƭ Ƨ ƭ Ʃ o q
Calibre (3.46)
(4.3.0)
FBReader (0.12.10)
Okular (1.7.2)
(cid:32)
-
(cid:35)
-
(cid:35)
-
(cid:35)
Ʃ: .png/.jpg ﬁle
∗ Allows EPUB to open URL in default browser.
(cid:32)
(cid:32)
(cid:35)
(cid:35)
ƭ: .html ﬁle
Ƨ
-
-
-
o: .txt ﬁle
q: .log ﬁle
Leak
-
-
-
-
Remote
communication
Persistent storage
Cookies
LocalStorage
Features
URI handles
Insecure
engine
(cid:32)
(cid:32)
(cid:35)
(cid:35)
n: .bogus ﬁle
(cid:35)
(cid:35)
(cid:35)
(cid:35)
ƫ: .mp3 ﬁle
(cid:35)
(cid:35)
(cid:35)
(cid:35)
-
-
-
-
Ƭ: .mp4 ﬁle
(cid:32)
(cid:35)
-
-
(cid:32)
(cid:35)∗
(cid:35)
(cid:35)
Ƨ: .ttf
EVALUATION RESULTS FOR EPUB READING SYSTEMS ON IOS.
TABLE IV
Application
JavaScript
Local
Remote
Existence
Local Resources
Render
Leak
Remote
communication
Persistent storage
Cookies
LocalStorage
Features
URI handles
Runs in background
Aldiko Book Reader (1.1.6)
Apple Books (4.2.3)
Blueﬁre Reader (2.9)
CHMate (6.9.1)
Ebook Reader (4.0.8)
Eboox (1.60.1)
Epub Reader (1.1)
EPUB Reader (5.1.55)
FBReader (1.0.10)
Gerty (1.1.5)
Kobo Books (9.14)
Kybook 3 (0.7.8)
Marvin (3.1.2)
Play Books (5.3.0)
PocketBook (3.2)
Power Reader (6.10)
R2 Reader (2.0.1)
TotalReader (5.1.61)
YiBook (1.8.6)
Yomu (2.3.0)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
∗ Requires user interaction, only the ﬁrst time.
† Requires user consent.
‡ Requires user constent, except for Mail app.
§ Allows access to LocalStorage of other EPUBs.
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
(cid:35)
(cid:32)∗
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:32)
(cid:32)
(cid:32)
(cid:32)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:35)
(cid:32)
(cid:35)
(cid:35)
(cid:35)
(cid:35)