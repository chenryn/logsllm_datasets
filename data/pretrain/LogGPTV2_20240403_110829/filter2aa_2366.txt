qingxp9
whoami
 杨芸菲  @qingxp9
 360 PegasusTeam 无线安全研究员
 WLAN安全研究、WIPS等无线安全产品研发
 C-SEC 《如今我们面临的无线威胁》
 CCF YOCSEF沈阳《公共无线安全的现状与未来》
 “绵羊墙”公共WiFi风险演示系统
东北大学无线安全课程客座讲师
Outline
① 无人机安全威胁背景
② 基于802.11的反无人机方案
③ 低成本反无人机系统的设计与实现
④ 承载在802.11上的无人机管控方案
无人机安全威胁
 近年来，无人机应用范围越来越广泛（航拍、快递、灾后搜救、数据采集），无人
机数量迅速增加，随之也产生了一系列安全管控问题。
未经许可闯入敏感区域、意外坠落、
影响客机正常起降、碰撞高层建筑等
事件不断发生。
向各国政府提出了新的监管命题。
无人机安全威胁
个人隐私
无人机安全威胁
军事安全
 ISIS改装无人机用于投放炸弹
无人机安全威胁
民航安全
成都双流机场无人机事件:
从4月14日至4月27日，双流机场接连发生8
件无人机扰航事件，总计造成114个航班备
降、超过40个航班延误、4架飞机返航、超1
万旅客出行受阻被滞留机场，严重威胁民航
飞行安全。
英国反无人飞行器防御系统(AUDS)
核心技术：
1.Ku波段（12GHz到18GHz）电子扫描防空雷达技术
a.
支持检测距离：10KM
b.
支持检测0.01平方米大小设备
c.
结合多普勒检测
2.高精度水平和倾斜方位指示器
a.
动态方位定位器、热感摄像机进行目标识别
b.
视频追踪
3.智能定向射频抑制干扰系统
a.
高增益四频五天线
b.
自定义抑制波形、支持GNSS频率
c.
软件定义智能射频抑制
可实现15秒内探测、跟踪和干扰无人机
AUDS system combines 
electronic-scanning radar 
target detection, electro-
optical (EO) 
tracking/classification and 
directional RF inhibition 
capability.
三家公司各自的系统分别在雷达探测、
影像/视频跟踪和射频干扰/数据通信方
面达到了行业最佳水平。
◦ 红外线
◦ 视图
◦ 音频
◦ 雷达
◦ Wi-Fi
◦ RF
◦ …
DroneTracker：
identification and counter-measures platform to defeat drone
http://www.dedrone.com/en/dronetracker/drone-protection-software
DroneTracker
捕获方案
检测与干扰 总结
无线电干扰攻击面
不建议使用GPS欺骗技术打击无人机
无线电干扰缺点
 会影响其他无线电信号的正常通信
无人机普遍采用跳频、扩频技术，具有一定的抗干扰能力。容易出现
干死一大片，无人机照样飞的窘境
 无线电信号干扰设备存在法律风险
《中华人民共和国刑法修正案（九）》第288条
“违反国家规定，擅自设置、使用无线电台（站），或者擅自使用无线电频率，
干扰无线电通讯秩序，情节严重的，处三年以下有期徒刑、拘役或者管制，并
处或者单处罚金；情节特别严重的，处三年以上七年以下有期徒刑，并处罚
金。”
基于802.11的反无人机方案 
拓扑
消费级无人机设备基本都使用了
Wi-Fi在飞行器和手机间传输遥控、
图传等信号。
Wi-Fi 特征
802.11 Beacon Frame
Wi-Fi 特征
802.11 Probe Response Frame
无人机型号
OUI
SSID
Drone Model
60:60:1f
PHANTOM3_xxxxx
x
PHANTOM3
60:60:1f
Mavic-xxxxxx
MAVIC
e4:12:18
XPLORER_xxxxxx
XPLORER
KONGYING-xxxxxx
KONGYING
MiRC-xxxxxx
XiaoMi
OUI、SSID及型号对应关系
操控者识别
用于图像显示的操控者手机终端
干扰无人机
 Deauthentication Attack
类型
热点位置
中断图像？
Dji PHANTOM3
遥控器
Yes
Dji MAVIC(Wi-Fi)
飞行器
Yes
XPLORER
遥控器
Yes
定位与追踪
 通过多个WiFi senior进行三角定位，判断目标的大致
方位。
功能总结
• 无人机发现与识别
• 控制/图传干扰
• 飞行器、操控者定位跟踪
• 黑白名单管理
• 电子证据
反无人机系统的设计与实现
系统架构
Requiremnts
 Hardware：
◦ Linux host
◦ 5G&2.4G Dual Band WiFi module
◦ GPS module
 Software:
◦ Kismet
◦ Analysis scripts
 Test UAV:
◦ DJI Phantom 3
Kismet Drone
 #kismet_drone.conf
 servername=Kismet-Drone
 dronelisten=tcp://:2502
 droneallowedhosts=
 ncsource=:channellist:IEEE80211b
Kismet Server
 #kismet.conf
 ncsource=drone:host=,port=2502
 #(无人机过滤规则)
 filter_tracker=BSSID(60:60:1F:00:00:00/FF:FF:FF:00:00:00)
 ...
 filter_tracker=BSSID(e4:12:18:00:00:00/FF:FF:FF:00:00:00)
 logtypes=netxml,pcapdump
Monitoring
Log Analysis
 无人机热点信息：
◦ESSID
◦BSSID
◦频道
◦厂商
◦发现时间
Log Analysis
 客户端信息：
◦MAC
◦OUI
告警 
告警
干扰
DEAUTH ATTACKING
DISCONNECTING   
Demo
优势
• 可进行黑白名单管理
• 适应城市等复杂环境，不影响其它无线电通信
• 可定位追踪到操控者的手机设备
• 已部署有WIPS产品的场所，利用现有Wi-Fi传感器网
络便可快速升级支持
缺点
• 检测及类型识别依赖于指纹库
• 无法覆盖所有类型的无人机设备，部分无人机不使用Wi-Fi
不同型号无人机具有不同的通信频段、不同的私有协议，加上现实世
界比较复杂的无线电环境，只靠无线电的角度去做无人机检测是比较
困难的
承载在802.11上的无人机管控方案
无人机管控方案
鉴于无人机厂家相互独立，行业缺乏统一管控标准的现状，提出一
套承载在802.11上的无人机管控方案。
优点：便于现有大部分无人机通过固件升级的方式予以支持，不需额外添
加硬件模块
◦ 无人机身份识别机制
无人机不断发送广播信号，报告自身身份及位置
◦ 无人机围栏
围栏发送信息广播，以示无人机避让
身份识别机制
 802.11管理帧信息元素由三部分组成：Type-Length-Value
 Type值从0~255，不同标号代表管理帧的不同作用，
tag= 0 表示SSID；
tag= 1表示所支持的速率；
身份识别机制
 通过未定义的tag值携带签名信息
数字签名部分可采用椭圆曲线加密（ECC :Elliptic Curve Cipher）算
法，也可采用其他签名算法。ECC算法是一种成熟的公钥密码系统，
密钥的长度要远小于RSA加密技术。
 整个Framebody最长为2312，信息拼接起来。若采用ECC
算法384*3bit加密技术，一帧就可以发送完整签名信息帧。
拼接的管理帧
身份识别机制
证书签发
 根证书由政府管理部门或国际机构管理，根证书之下可以签
发二级证书、三级证书……
◦ 例如民航管理部门持有根证书，分别给不同无人机厂商签发二级
证书。无人机厂商为每一台出售的无人机配置证书。
◦ 民航管理部门也可以给例如电网、遥测遥感、公安武警等单位签
发二级证书。这些单位负责给自己的专用无人机配置证书。
 每个证书对应的私钥存储在无人机上，公钥存放在网络服务
器上。无人机监控设备可通过公钥服务器获取对应的公钥，
检验签名合法性。
无人机围栏
Thank you!
Thank you!