R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
8
9
Np=  50,000
Np=  75,000
Np=100,000
11
10
14
number of hash functions k
12
13
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
8
9
15
16
Np=  50,000
Np=  75,000
Np=100,000
11
10
14
number of hash functions k
12
13
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
8
9
15
16
Np=  50,000
Np=  75,000
Np=100,000
11
10
14
number of hash functions k
12
13
15
16
Figure 4: Simulation results supporting the theoretical analysis (error level by varying k)
Performance
Metrics
Control
Parameters
FNR(False Negative Ratio): the ratio of the
number of missed routers in the constructed
attack tree to the number of infected routers
FPR(False Positive Ratio): the ratio of the
number of incorrectly convicted routers to the
number of convicted routers in the constructed
attack tree
Na: the number of attackers
Np: the number of attack packets used for
traceback
p: the sampling rate at an intermediate router
k: the number of hash functions in a Bloom (cid:12)lter
s: resource constraint (=k (cid:2) p)
Table 1: Performance Metrics and Control Parameters
formance of our traceback scheme. We show that our
scheme can achieve high traceback accuracy even when
there are a large number of attackers, and only requires
the victim to collect and use a moderate number of at-
tack packets.
5.1. Simulation set-up: topologies and met-
rics
The following three real-world network topologies
are used in our simulation study.
(cid:15) Skitter data I { collected from a CAIDA-owned host
(a-root.skitter.caida.org) on 11/28/2001 as a part of
the Skitter project [1]. This data contains the tracer-
oute data from this server to 192,900 destinations.
(cid:15) Skitter data II { collected from another CAIDA
host (e-root.skitter.caida.org) on 11/27/2001, contain-
ing routes to 158,181 destinations.
(cid:15) Bell-lab’s dataset { collected from a Bell-labs
host [5], containing routes to 86,813 destinations. We
merged six route sets originated from the same host
into one and trimmed incomplete paths.
All three topologies are routes from a single origin
to many destinations in the Internet. In our simula-
tion, we assume that this origin is the victim and the
attackers are randomly distributed among the destina-
tion hosts 9.
Table 1 shows the performance metrics and control
parameters used in our simulation. Due to sampling,
some routers that are on the attack path may not be
detected. We call these routers false negatives. The false
negative ratio (FNR) of an attack tree constructed by
the traceback scheme is de(cid:12)ned as the ratio of the num-
ber of false negatives to the number of actual infected
routers during the attack10. Because Bloom (cid:12)lters are
used to store packet digests, the traceback system may
identify routers that are not actually on attack paths.
We call these routers false positives. The false positive
ratio (FPR) of an attack tree constructed by the trace-
back scheme is de(cid:12)ned as the ratio of the number of
false positives to the total number of routers in the at-
tack tree. It is ideal for the traceback scheme to be able
to trace most of the attackers (i.e., low FNR), using a
moderate number of attack packets. It is in general
not necessary for FNR to be zero (i.e., (cid:12)nd all attack-
ers) since identifying and removing most of the attack-
ers are e(cid:11)ective enough for restoring the services being
attacked. Incomplete or approximate attack path infor-
mation is valuable because the e(cid:14)cacy of complemen-
tary measures such as packet (cid:12)ltering improves as they
are applied further from the victim and closer to the at-
tack sources [28]. This is why we count routers instead
of routes in these performance metrics.
Among the control parameters, Na denotes the num-
ber of attackers, and Np represents the number of at-
tack packets that are used for traceback. The larger Np
is, the higher the traceback overhead is. Recall that p
denotes the sampling rate, k denotes the number of
9
In real situation, this assumption of random distribution can be
wrong because many hosts in same vulnerable network can be
compromised simultaneously. However, clustering of attackers
only helps our scheme because it increases the correlation be-
tween routers in attack path.
10 Recall that a router on the attack path of an attacker is called
\infected".
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.8
0.6
0.4
0.2
0
0
(a) Skitter I topology
(b) Skitter II topology
(c) Bell-lab’s topology
k=8
k=9
k=10
k=11
k=12
k=13
k=14
k=15
k=16
0.2
0.4
0.6
0.8
1
1.2
resource constraint s (=k*p)
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.8
0.6
0.4
0.2
0
0
k=8
k=9
k=10
k=11
k=12
k=13
k=14
k=15
k=16
0.2
0.4
0.6
0.8
1
1.2
resource constraint s (=k*p)
)
R
P
F
+
R
N
F
(
l
e
v
e
l
r
o
r
r
E
1
0.8
0.6
0.4
0.2
0
0
k=8
k=9
k=10
k=11
k=12
k=13
k=14
k=15
k=16
0.2
0.4
0.6
0.8
1
1.2
resource constraint s (=k*p)
Figure 5: Simulation results supporting the theoretical analysis (error level by varying s)
(a) Skitter I topology
(b) Skitter II topology
(c) Bell-lab’s topology
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
1000 attackers
2000 attackers
5000 attackers
0
100
200
300
400
500