Java4是通过java.util.regex包来提供内置的正则表达式支持的第一个Java版本。
java.util.regex包使用的是“Java”正则表达式和替代文本流派。本书会涉及Java
版本4、5和6。
JavaScript
这是通常被称作JavaScript的编程语言中所使用的正则流派。所有现代的网页浏览
器中都实现了这种流派，包括InternetExplorer（从5.5版开始）、Firefox、Opera、
Safari和Chrome。许多其他应用程序也使用JavaScript来作为一种脚本语言。
严格来讲，在本书中我们使用JavaScript这个术语所指代的是在ECMA-262标准的
第3版中所定义的编程语言。这个标准定义了ECMAScript编程语言，而该语言更
广为人知的版本则是在不同网页浏览器中所实现的JavaScript和JScript语言。
ECMA-262v3同样还定义了JavaScript所使用的正则表达式和替代文本的流派。这
些流派在本书中都被称作“JavaScript”流派。
PHP
PHP拥有3种不同的正则表达式函数集合。我们强烈推荐读者使用preg类的函数。
因此，本书只会涉及preg类的函数，这些函数从版本4.2.0开始就被内置在PHP
中。本书会涉及PHP版本4和5。preg类的函数是在PCRE函数库之上生成的PHP
包装函数。PCRE正则流派在本书中被称作“PCRE”。因为PCRE并没有包含查找
90第3章
www.TopSage.com
---
## Page 107
和替换功能，所以PHP开发者为preg_replace设计了它们自已的替代文本语法。
mb_ereg类的函数属于PHP的“多字节”函数，后者被设计来能够更好地用于传
统上使用多字节编码的字符集（比如汉语和日语）之上。在PHP5中，mb_ereg
类的函数使用的是最初为Ruby所开发的Oniguruma正则函数库。在本书中，
Oniguruma正则流派被称作“Ruby1.9”。只有当你被明确要求需要处理多字节代
码页，而且对于PHP的mb_类的函数已经比较熟悉的前提下，我们才推荐你使用
mb_ereg类的函数。
ereg类的函数是PHP中使用的最古老的一组正则表达式函数，它们从PHP5.3.0
开始被正式标记为过时。它们并不依赖于外部的函数库，而且它们实现的是POSIX
ERE流派。该流派提供了一个有限的特性集合，因而在本书中并没有进行讨论。
POSIXERE是Ruby1.9和PCRE流派的一个严格子集。你可以把任意的ereg函数
中调用的正则表达式拿来，用在mb_ereg或ereg类的函数中。对于ereg类的函数，
你还需要添加Perl风格的分隔符（参考实例3.1）。
Perl
在Perl语言中内置的正则表达式支持是正则表达式得以流行的主要原因。PerI语
言中的m//和s//操作符所使用的正则表达式和替代文本流派在本书中被称作
“Perl”流派。本书涉及的Perl版本包括5.6、5.8和5.10。
Python
Python通过它的re模块来支持正则表达式。该模块所使用的正则表达式和替代文
Ruby
Ruby拥有对于正则表达式的内置支持。本书会讲到Ruby1.8和1.9版。Ruby的这
两个版本拥有不同的默认正则表达式引擎。Ruby1.9使用的是Oniguruma引擎，
它同在Ruby1.8中使用的经典引擎相比拥有更多的正则表达式特性。第1章中的
在本章中，我们不会过多谈到在Ruby1.8和1.9之间的区别。本章中讲到的正则表
达式都是非常基本的，因此它们并不会使用在Ruby1.9中引人的新特性。因为正
则表达式支持是直接编译到Ruby语言中的，所以不管是用经典的正则引擎还是
Oniguruma引擎来编译Ruby，你用来实现正则表达式的Ruby代码都是一样的。如
果需要Oniguruma引擎中的特性的话，那么你也可以使用它来重新编译Ruby1.8。
其他编程语言
虽然本书并不会讲到在下面列出的这些编程语言，但是它们也会使用本书中的某一种
正则表达式流派。如果你使用如下的一种语言，那么可以略去本章不读，但是其他所
使用正则表达式编程91
www.TopSage.com
---
## Page 108
有章节还会是有用的。
ActionScript
ActionScript是Adobe所实现的ECMA-262标准。从3.0版开始，ActionScript完全
支持ECMA-262v3所描述的正则表达式。这个正则流派在本书中被称作
"JavaScript”。ActionScript语言也与JavaScript非常接近。你应当能够把本章中给
出的JavaScript示例修改之后用于ActionScript。
C
C可以使用多种不同的正则表达式函数库。在本书中讲解的所有流派中，开源的
PCRE函数库可能会是最好的选择。可以从http://www.pcre.org下载该函数库全部
的C源代码。它的代码支持多种不同平台之上的各种编译器。
C++
C++也可以使用多种不同的正则表达式函数库。在本书中讲解的所有流派中，开源
的PCRE函数库可能会是最好的选择。你可以选择使用C的API，或者使用在
PCRE下载中包含的C++类包装（参见http://www.pcre.org）。
在Windows上，也可以导人VBScript5.5RegExpCOM对象，这会在后面的Visual
Basic6中加以解释。这样做可能会有助于保持在C++后端和JavaScript前端之间
的一致性。
DelphiforWin32
在本书写作的时候，Delphi的Win32版本还不包含对于正则表达式的内置支持。
但是有许多VCL构件可以用来提供正则表达式支持。我们推荐你选择一种基于
PCRE的构件。Delphi拥有把C的object文件链接到应用程序中的能力，而且许多
PCRE的VCL包装都使用的是这样的object文件。这就允许你可以使应用依然保
持为单个的.exe文件。
可以从http://www.regexp.info/delphi.html下载作者的TPerlRegEx构件。这个VCL
构件会把自已安装到构件面板上，从而可以很容易地把它拖到一个窗体中。另外
一个比较流行的Delphi的PCRE包装库是JCL函数库中的TJcIRegEx类
(http://www.delphi-jedi.org）。TJclRegEx是从TObject实现来的，所以不能把它拖
放到一个窗体中。
上述两个函数库都是开源的（采用的是MozillaPublicLicense）。
DelphiPrism
在DelphiPrism中，你可以使用由.NET框架所提供的正则表达式支持。只需要在
你想要使用正则表达式的任意DelphiPrism单元中的uses从句中添加System
92第3章
www.TopSage.com
---
## Page 109
Text.RegularExpressions即即。
完成上述动作之后，你就可以使用本章中给出的在C#和VB.NET代码片段中所使
用的完全一样的技术。
Groovy
可以通过java.util.regex包来在Groovy中使用正则表达式，用法与在Java中完全
一样。事实上，在本章中所给的所有Java解答都能够在Groovy中使用。Groovy
自己的正则表达式语法只是简单地提供了一些简写记号。可以自由地混合使用
PowerShell
PowerShell是Microsoft提供的shell脚本语言，它基于的是.NET框架。PowerShell
内置的-match和-replace操作符使用的是本书中讲解的.NET正则流派和替代文本
流派。
R
R语言通过在base包中的grep、sub和regexpr函数提供对正则表达式的支持。所
有这些函数都会接受一个标记为perI的参数，它的默认值是FALSE。如果要使用
本书中介绍的PCRE正则流派，那么就需要把它设置为TRUE。本书中为PCRE7
给出的正则表达式可以用于R2.5.0以及之后的版本。至于更早版本的R，需要使
用在本书中标记为“PCRE4和更早版本”的正则表达式。R所支持的“basic”和
“extended”流派是本书中没有讨论的较早的、使用范围较小的正则流派。
REALbasic
REALbasic拥有一个内置的RegEx类。这个类的内部使用的是UTF-8版本的PCRE
函数库。这就意味着你可以使用PCRE的Unicode支持，但是在把它传送给RegEx
类之前，还必须使用REALbasic的TextConverter类来把非ASCII文本转换为
UTF-8。
本书给出的PCRE6的所有正则表达式都能够用于REALbasic。需要注意的一点是，
在REALbasic中，“不区分大小写”和“脱字符和美元符号匹配换行处”（也就是
“多行”）选项是默认打开的。如果你想要使用本书中的一个正则表达式，而它并
没有告诉你需要打开这些匹配模式的话，你就必须记住要在REALbasic中把相应
选项关闭。
Scala
Scala通过scala.util.matching包来提供内置的正则表达式支持。这个支持包是基于
java.util.regex包的正则表达式引擎所开发的。在本书中，Java和Scala所使用的正
则表达式和替代文本流派都被称作“Java”。
使用正则表达式编程93
www.TopSage.com
---
## Page 110
VisualBasic 6
VisualBasic6是不需要使用.NET框架的最后一个VisualBasic版本。这也就意味
着VisualBasic6不能使用在.NET框架中所提供的优秀的正则表达式支持。在本
书中给出的VB.NET代码示例完全不可能在VisualBasic6中使用。
VisualBasic6让用户可以很容易使用ActiveX和Com函数库所提供的功能。其中
一个这样的库是Microsoft的VBScript脚本库，其中从5.5版之后就包含了较好的
正则表达式能力。这个脚本库实现了与JavaScript中相同的正则表达式流派，也就
是在ECMA-262v3所规定的标准。这个库包含在IntermetExplorer5.5以及之后的
版本中。它可以在所有运行WindowsXP或者Vista的机器上找到，对于较早版本
的Windows，如果用户升级到了IE5.5或者更新版本也可以找到。这几乎就包括
了所有目前连接到Intermet上的Windows个人计算机。
如果想要在你的VisualBasic程序中使用这个库，在VBIDE的菜单中选择
Project|References。向下翻页找到MicrosoftVBScriptRegularExpressions5.5，该选
项位于MicrosoftVBScriptRegularExpressions1.0之下。这里提供1.0版本只是为
了向后兼容的目的，因为它的功能已经很弱了。
在做了如上选择之后，你就可以看到该脚本库所提供的类和类成员。在菜单中选
择ViewlObjectBrowser。在对象浏览器（ObjectBrowser）中，就可以从左上角的
下拉菜单中选择VBScript_RegExp_55库。
3.1在源代码中使用字面正则表达式
问题描述
给定一个正则表达式[S"n\d/\])，它是某个题目的解答。该正则表达式包含单个的字
符类，它会匹配一个美元符号、一个双引号、一个单引号、一个换行符、0～9的任意
数字、一个正斜杠或者一个反斜杠。尝试把该正则表达式硬编码到你的源代码中，使
之成为一个字符串常量，或者是正则表达式的操作符。
解决方案
#
作为一个正常字符串：
"[$\"\n\d/\1]"
作为一个逐字字符串：
@"[S""'\n\d/\\] "
94第3章
www.TopSage.com
---
## Page 111
VB.NET
"[S"·\n\d/\\]"
Java
"[$\""\n\\d/\\\]"
JavaScript
/[s"\\\/\\]/
PHP
$[$"\'\n\d/\\]8'
Perl
模式匹配操作符：
/[\"\\d\/\]/
m![\$""\n\d/\\]!
替代操作符：
s![\。在使用