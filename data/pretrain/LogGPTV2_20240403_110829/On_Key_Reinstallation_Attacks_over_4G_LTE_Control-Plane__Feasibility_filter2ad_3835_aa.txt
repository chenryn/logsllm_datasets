title:On Key Reinstallation Attacks over 4G LTE Control-Plane: Feasibility
and Negative Impact
author:Muhammad Taqi Raza and
Yunqi Guo and
Songwu Lu and
Fatima Muhammad Anwar
On Key Reinstallation Attacks over 4G LTE Control-Plane:
Feasibility and Negative Impact
Muhammad Taqi Raza, Yunqi Guo, Songwu Lu, and Fatima Muhammad Anwar
ACM Reference Format:
Muhammad Taqi Raza, Yunqi Guo, Songwu Lu, and Fatima Muhammad
Anwar . 2021. On Key Reinstallation Attacks over 4G LTE Control-Plane:
Feasibility and Negative Impact. In Annual Computer Security Applications
Conference (ACSAC ’21), December 6–10, 2021, Virtual Event, USA. ACM, New
York, NY, USA, 10 pages. https://doi.org/10.1145/3485832.3485833
ABSTRACT
This paper studies the feasibility of key reinstallation attacks in the
4G LTE network. It is well known that LTE uses session keys for
confidentiality and integrity protection of its control-plane signal-
ing packets. However, if the keys are not updated and counters are
reset, key reinstallation attacks may arise. In this paper, we show
that several design choices in the current LTE security setup are
vulnerable to key reinstallation attacks. Specifically, on the control
plane, the LTE security association setup procedures, which estab-
lish security between the device and the network, are disconnected.
The keys are installed through one procedure, whereas their as-
sociated parameters (such as uplink and downlink counters) are
reset through another different procedure. The adversary can thus
exploit the disjoint security setup procedures, and launch the key
stream reuse attacks. He consequently breaks message encryption,
when he tricks the victim to use the same pair of keys and counter
value to encrypt multiple messages. This control-plane attack hi-
jacks the location update procedure, thus rendering the device to
be unreachable from the Internet. Moreover, it may also deregister
the victim from the LTE network. We have confirmed our findings
with two major US operators, and found that such attacks can be
launched with software-defined radio devices that cost about $299.
We further propose remedies to defend against such threats.
1 INTRODUCTION
The current fourth-generation (4G) Long Term Evolution (LTE)
technology provides billions of users their daily mobile Internet
access. Different from the wired Internet, LTE has made security
a top design goal, thus deploying several built-in security mecha-
nisms. Together, such procedures provide all key security functions
of authentication, encryption, integrity and access control.
In this paper, we examine the LTE security from a new perspec-
tive. It is well known that, the encryption and integrity protection
components in LTE use mature and well-tested crypto algorithms
that have been used for decades. Therefore, it seems that neither
exhibits vulnerabilities. Motivated by the recent efforts on key rein-
stallation threats over wireless [11, 16, 35, 40], we hypothesize that
This work is licensed under a Creative Commons Attribution International
4.0 License.
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
© 2021 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-8579-4/21/12.
https://doi.org/10.1145/3485832.3485833
LTE may suffer from similar vulnerabilities. Indeed, our findings
confirm the hypothesis. However, the threats are exposed via com-
pletely different procedures. The impacts are also more damaging.
Specifically, we study LTE security key installation method and
counters handling process for a number of LTE procedures (such as
device registration, deregistration, location update and others). 4G
(like 3G) employs Authentication and Key Agreement (AKA) proto-
col to install the security keys and enables the integrity protection
of its signaling messages. After that it runs Security Mode Com-
mand procedure to activate ciphering of messages at LTE subscriber.
LTE employs stream ciphers which have been a popular method of
encryption for the confidentiality of its signaling and data packets.
The ciphering algorithm takes key (installed through AKA proce-
dure), counter value and a couple others as an input and generates
keystream block. The keystream block, k is exclusive-ored (xored)
with the plaintext message, m, to produce the encrypted message,
k ⊕ m = e. In practice, the keystream is pseudo random that gener-
ates the cipher text known as a one-time pad, proved unbreakable
by Shannon[31]. It is an established fact that the security of stream
ciphers rests on never reusing the keystream block k [15]. In case k
is reused to cipher two different plaintext messages, m and n, then
the encrypted texts k ⊕m and k ⊕n can be xored together to recover
m ⊕ n. By using chosen-text attack, one can further break m ⊕ n,
and gets the messages m and n.
The scenario in which LTE ciphering algorithm gives same
keystream block over multiple rounds is the one in which the ci-
phering key remains constant and the counter value (responsible of
generating random keystream block) is reset. We call this “key rein-
stallation" vulnerability. In this paper, we look LTE control-plane
procedures that lead to key reinstallation attacks.
The idea behind our control-plane attacks can be summarized
as follows. In the security establishment procedure, the device first
installs new key through authentication procedure. Once the key
is installed, the network runs security mode command procedure
to reset the counter values for encryption. In reality, the signaling
message may be lost or dropped. In case, the device response to
security mode command request is dropped, the network reinitiates
the security mode command procedure. On receiving the replayed
security mode command request from the network, the device
resets the counter values again before generating the response
message. This means two signaling messages sent after two security
mode command responses are encrypted with same keystream
block at device. We show that an attacker can force count resets
by blocking the response to security mode command request. By
intentionally forcing count resets, the confidentiality protocol can
be attacked, e.g., packets can be replayed, decrypted, and/or forged.
The attacker can launch attacks on device location update and de-
registration procedures. These attacks render the victim device to
be unreachable from the outside world (e.g. it cannot receive voice
877ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Muhammad Taqi Raza, Yunqi Guo, Songwu Lu, and Fatima Muhammad Anwar
calls), or even leaves the device without LTE service (i.e. no service
scenario).
It is worth noting that our attacks do not violate the security
properties proven in formal LTE analysis work, such as LTEInspec-
tor [14]. The formal method proofs state that LTE key should not
be shared over the air, and all protocols behave as desired by the
3GPP standard. Our attacks do not leak ciphering or integrity keys
and strictly follow LTE standards. Further, although the attacker
can launch the attacks by reseting the counts, in control-plane he
cannot repeatedly do so for more than one signaling message as
the integrity protection becomes mandatory thereafter. However,
this is sufficient for an attacker to launch as serious an attack as
deregistering the victim subscriber from the LTE network.
In our experiments, we have verified all attack steps through
two major US LTE operators. We use Software Defined Radio (SDR)
to conduct our proof-of-concept studies. The experimental results
show that LTE key reinstallation attacks are practical and pose a
realistic threat to the LTE users. Last, we propose 3GPP standard-
compliant remedies to address the discussed vulnerabilities. We
prototype our solution and provide its security analysis.
Ethical Consideration: This work does not raise any ethical
and legal concerns. The attacker and victim devices are part of a
testbed setup established in our lab. We have especially purchased
sim cards from two US operators to conduct our experiments. We
did not use any other commercial sim card to launch the attack
towards any other LTE subscriber. The purpose of this study is to
strengthen LTE security, especially when LTE security mechanisms
are considered to be the building blocks for 5G security (e.g. Cellular
IoT security).
2 BACKGROUND ON LTE AND KEY
REINSTALLATION
We provide background on LTE infrastructure, integrity and cipher-
ing procedures in LTE, as well as on key reinstallation vulnerabili-
ties.
2.1 LTE network and its elements
LTE device It provides LTE service to end user. The network op-
erators assign the subscriber device a permanent identity called
International Mobile Subscriber Identity (IMSI), and a number of
temporary identities. One of these temporary identities is called
Temporary Mobile Subscriber Identity (TMSI), a temporary identifi-
cation number that is used instead of the IMSI to ensure the privacy
of the mobile subscriber. The other temporary identity is known as
RNTI (Radio Network Temporary Identifier) that uniquely identi-
fies an LTE subscriber over the radio interface. LTE device applies
ciphering to its both control and data planes, whereas the integrity
is applied to control-plane only.
LTE base station It acts as a radio interface between LTE
subscriber and the core network. It provides radio resource man-
agement to its subscribers and encrypts user traffic over the air.
Through RNTI, it discerns a particular user traffic from other sub-
scribers over the air. The control-plane radio signaling messages
between device and LTE base station are exchanged through Radio
Resource Control (RRC) protocol. RRC is responsible of activating
radio-plane security (through Security Mode Command procedure)
and managing the radio resources (such as establishment, release,
and radio configurations).
LTE core network It is also called Evolved Packet Core (EPC)
which acts as a central entity and provides authentication, mobility
management, and Internet connectivity to LTE subscribers. The
control-plane signaling messages between device and LTE core
network are exchanged through Non-Access Stratum (NAS) proce-
dures. NAS procedures include device Authentication (that installs
security key), Security Mode Command (that enables ciphering),
Attach (registration), Detach (de-registration), Tracking Area Up-
date (location update), and few others procedures. In this paper, we
first exploit vulnerabilities in Authentication and Security Mode
Command procedures, and then launch attacks towards Tracking
Area Update (TAU) and Detach control-plane procedures.
Figure 1: LTE background: an overview.
2.2 Integrity and confidentiality procedures in
LTE
LTE employs integrity and confidentiality procedures which are
applied at both device and network side. Figures 2(a) and 2(b) show
integrity and ciphering procedures, respectively. LTE uses two
separate algorithms for integrity and ciphering of messages. Both
algorithms take a number of input parameters and output the Mes-
sage Authentication Code (MAC), if integrity algorithm is used,
or keystream block, if ciphering algorithm is used. As shown in
Figure 2, the input parameters are 128-bit integrity/ciphering key
named KEY, a 32-bit count named Count, a 5-bit bearer identity,
i.e. Bearer, the 1-bit direction of the transmission i.e. Direction
(0 for uplink, and 1 for downlink transmission). The integrity al-
gorithm takes the message itself, i.e. Message, as input as well,
and outputs MAC; whereas, the ciphering algorithm inputs the
length of the keystream required i.e. Length, to generate the output
keystream block. This Length parameter affects only the length of
the keystream block, not the actual bits in it[7]. The keystream
Figure 2: Integrity and ciphering procedures.
LTE Core NetworkInternetNAS signaling interface: integrity and ciphering appliesRRC control plane interface: integrity and ciphering appliesRRC data plane interface: Only ciphering appliesLTE base stationDeviceEPS Encryption Algorithm (EEA)LengthBearerDirectionCountKEYKEYSTREAM BLOCKPlain text /
Ciphered textCiphered text /
Plain textEPS Integrity Algorithm (EIA)BearerMessageDirectionCountKEYMAC-I(a) Integrity protection (b) Ciphering / unciphering878On Key Reinstallation Attacks over 4G LTE Control-Plane: Feasibility and Negative Impact
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
block is xored with characters in the plaintext to produce the ci-
phertext at sender side. Xoring the ciphertext with same keystream
block produces the plaintext at receiver.
2.3 Key reinstallation attack in retrospect
Stream ciphers, as discovered by Gilbert Vernam in 1917 [37], have
been a popular method of encryption even today. In a stream ci-
pher, the plaintext and the key are xored to produce the ciphertext.
This cipher is never used again and known as one-time pad for
encrypting plaintext message. To ensure that all ciphers do not
occur more than once, the ciphering algorithm takes the nonce (we
call count in this paper) as an input along with the key. Counts
have the property that each value only occurs once within a given
context. As long as the key is unchanged, the count must not repeat.
Otherwise, it introduces the two-time pad problem [21] in which
the adversary can get the encrypted plaintext without knowing
the key and count values. The key reinstallation attacks can be
defined as the attacks in which the adversary can willfully trick the
victim to reuse the count values while keeping the key unchanged
for encryption of the plaintext messages. It means stream cipher is
reused for encryption, hence gives birth to two-time pads[21].
In wireless networks, David Wagner and his team have first shown
stream cipher reuse attacks in WiFi[11], and WSN[16]. Following a
number of papers [8, 10, 40] afterwards, last year, Mathy Vanhoef
and et al.[35] show that the key reuse attacks are still possible in
modern WiFi systems. They attribute this problem to design or
implementation flaws. In contrast, in this paper, we are first to
show that LTE security is vulnerable to key reinstallation attacks.
It was challenging because unlike WiFi and WSN, LTE has sep-
arate security keys and counts for control-plane and data-plane
operations. Even within the control-plane, RRC and NAS messages
use separate security keys and counts for their messages integrity
and ciphering. Furthermore, LTE security also splits its counts
into Uplink (UL) count and Downlink (DL) count values that make
count reuse harder. Despite all these efforts by LTE standard to
avoid key reuse, we have shown the key reinstallation attacks in
LTE control plane.
3 SYSTEM SETTINGS AND THREAT MODEL
System settings The attacker controls LTE device (i.e. attacker
device) that is associated with the same LTE network operator as
that of victim subscriber. Both attacker and victim are located in
an area where the network operator supports both 3G and 4G LTE
services. The attacker knows the phone number of victim device,
and can dial Circuit Switched Fall Back (CSFB) call towards victim
device1. The victim device can receive the call either through CSFB
or Voice over LTE (VoLTE). Lastly, we consider both the attacker
and victim devices are static during the attack period. That is, we
do not evaluate the mobility scenarios.
Threat Model Similar to threat models as discussed in [14, 29,
35], our attacker has capability to act as a passive and an active
attacker. Being a passive attacker, he can sniff radio channel with
which the victim has associated. He can do so by sniffing Physical
Downlink Shared Channel (PDSCH). PDSCH is used to transport
1The attacker selects CSFB option (which is voice call option over 3G) in android/iOS
phone call settings.
both broadcast system information for all devices and signaling
payload for particular mobile devices. The attacker identifies differ-
ent subscribers through their unique radio identity, C-RNTI.
Being an active attacker, he has capability to modify the contents
of the messages (after decryption) that he has sniffed over the air.
There exists a number of commercial LTE signal messages sniffers,
such as WaveJudge[1], ThinkRF[5], and others that the attacker can
use to sniff both broadcast and device specific signaling messages.
Contrary to attack models discussed in [29, 35], our attack model is
more practical in which the attacker does not need to act as Man-
in-the-Middle (MitM) to forward modified messages towards the
network. To impersonate the victim device, if required, the attacker
spoofs victim’s C-RNTI and TMSI values when he creates his own
RRC and NAS messages, and sends his signaling messages to LTE
base station. The spoofing is essential to trick LTE base station to
use victim context (not the attacker’s context) while forwarding
message to core network.
In order to ensure that failure of certain signaling messages result
in reseting the count values, the attacker has capability to block UL
(from device to network) signaling messages. He achieves this by
jamming UL signaling. There are a number of techniques[19, 20, 23]
to jam the signaling messages. We consider Asynchronous Off-Tone
Jamming (AOTJ) approach to jam only UL signaling messages be-
tween victim device and the network. The core idea of jamming is
to introduce the inter-channel interference (ICI) among orthogonal