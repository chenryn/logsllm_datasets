0.0005
0.001
traffic, putting them in an ideal position to perform flow correlation
attacks. To counter, several proposals suggest new relay selection
mechanisms for Tor that reduce the interception chances of mali-
cious ASes [2, 5, 39, 51, 68, 70]. None of such alternatives have been
deployed by Tor due to their negative impacts on performance,
costs, and privacy. We argue that designing practical AS-aware
relay selection mechanisms for Tor is a promising avenue to defend
against flow correlation attacks on Tor.
7 CONCLUSIONS
We design a flow correlation system, called DeepCorr, that drasti-
cally outperforms the state-of-the-art systems in correlating Tor
connections. DeepCorr leverages an advanced deep learning archi-
tecture to learn a flow correlation function tailored to Tor’s complex
network (as opposed to previous works’ use of general-purpose
statistical correlation metrics). We show that with adequate learn-
ing, DeepCorr can correlate Tor connections (and therefore break
its anonymity) with accuracies significantly stronger than existing
algorithms, and using substantially shorter lengths of flow obser-
vations. We hope that our work demonstrates the escalating threat
of flow correlation attacks on Tor in rise of advanced learning algo-
rithms, and calls for the deployment of effective countermeasures
by the Tor community.
ACKNOWLEDGMENTS
This work was supported by the NSF grants CNS-1525642, CNS-
1553301, and CNS-1564067.
REFERENCES
[1] Abadi, M., Barham, P., Chen, J., Chen, Z., Davis, A., Dean, J., Devin, M.,
Ghemawat, S., Irving, G., Isard, M., et al. TensorFlow: A System for Large-
Scale Machine Learning. In OSDI (2016), vol. 16, pp. 265–283.
[2] Akhoondi, M., Yu, C., and Madhyastha, H. V. Lastor: A low-latency as-aware
tor client. In Security and Privacy (SP), 2012 IEEE Symposium on (2012), IEEE,
pp. 476–490.
[3] Arnbak, A., and Goldberg, S. Loopholes for Circumventing the Constitution:
Unrestricted Bulk Surveillance on Americans by Collecting Network Traffic
Abroad. Mich. Telecomm. & Tech. L. Rev. 21 (2014), 317.
[4] Back, A., Möller, U., and Stiglic, A. Traffic Analysis Attacks and Trade-Offs in
Anonymity Providing Systems. In Information Hiding (2001), vol. 2137, Springer,
pp. 245–247.
[5] Barton, A., and Wright, M. DeNASA: Destination-naive as-awareness in
anonymous communications. Proceedings on Privacy Enhancing Technologies
2016, 4 (2016), 356–372.
[6] Blum, A., Song, D., and Venkataraman, S. Detection of interactive stepping
stones: Algorithms and confidence bounds. In International Workshop on Recent
Advances in Intrusion Detection (2004), Springer, pp. 258–277.
[7] Blum, A., Song, D., and Venkataraman, S. Detection of Interactive Stepping
Stones: Algorithms and Confidence Bounds. In RAID (2004).
[8] Borisov, N., Danezis, G., Mittal, P., and Tabriz, P. Denial of service or
denial of security? In Proceedings of the 14th ACM conference on Computer and
communications security (2007), ACM, pp. 92–102.
13
[9] Cai, X., Zhang, X. C., Joshi, B., and Johnson, R. Touching from a distance:
Website fingerprinting attacks and defenses. In Proceedings of the 2012 ACM
conference on Computer and communications security (2012), ACM, pp. 605–616.
[10] The CAIDA UCSD Anonymized Internet Traces 2016 - [2016]. http://www.caida.
org/data/passive/passive_2016_dataset.xml.
[11] Chakravarty, S., Barbera, M. V., Portokalidis, G., Polychronakis, M., and
Keromytis, A. D. On the effectiveness of traffic analysis against anonymity
networks using flow records. In International conference on passive and active
network measurement (2014), Springer, pp. 247–257.
[12] Chothia, T., and Guha, A. A statistical test for information leaks using contin-
uous mutual information. In Computer Security Foundations Symposium (CSF),
2011 IEEE 24th (2011), IEEE, pp. 177–190.
In International
Workshop on Privacy Enhancing Technologies (2004), Springer, pp. 35–50.
[14] Danezis, G., Dingledine, R., and Mathewson, N. Mixminion: Design of a type
III anonymous remailer protocol. In Security and Privacy, 2003. Proceedings. 2003
Symposium on (2003), IEEE, pp. 2–15.
[15] Dingledine, R., Mathewson, N., and Syverson, P. Tor: The Second-Generation
Onion Router.
[13] Danezis, G. The traffic analysis of continuous-time mixes.
[16] Donoho, D., Flesia, A., Shankar, U., Paxson, V., Coit, J., and Staniford,
S. Multiscale Stepping-Stone Detection: Detecting Pairs of Jittered Interactive
Streams by Exploiting Maximum Tolerable Delay. In RAID (2002).
[17] Donoho, D. L., Flesia, A. G., Shankar, U., Paxson, V., Coit, J., and Staniford,
S. Multiscale stepping-stone detection: Detecting pairs of jittered interactive
streams by exploiting maximum tolerable delay. In International Workshop on
Recent Advances in Intrusion Detection (2002), Springer, pp. 17–35.
[18] Edman, M., and Syverson, P. AS-awareness in Tor path selection. In CCS (2009).
[19] Elahi, T., Bauer, K., AlSabah, M., Dingledine, R., and Goldberg, I. Chang-
ing of the Guards: Framework for Understanding and Improving Entry Guard
Selection in Tor. In WPES (2012).
[20] Feamster, N., and Dingledine, R. Location Diversity in Anonymity Networks.
In Workshop on Privacy in the Electronic Society (Washington, DC, USA, October
2004).
[21] Goodfellow, I., Bengio, Y., Courville, A., and Bengio, Y. Deep learning, vol. 1.
[22] Hayes, J., and Danezis, G. k-fingerprinting: A Robust Scalable Website Finger-
MIT press Cambridge, 2016.
[28] Houmansadr, A., and Borisov, N. Towards Improving Network Flow Water-
printing Technique. In USENIX Security Symposium (2016), pp. 1187–1203.
[23] He, G., Yang, M., Gu, X., Luo, J., and Ma, Y. A novel active website fingerprinting
attack against Tor anonymous system. In Computer Supported Cooperative Work
in Design (CSCWD), Proceedings of the 2014 IEEE 18th International Conference on
(2014), IEEE, pp. 112–117.
[24] He, T., and Tong, L. Detecting encrypted stepping-stone connections. IEEE
Transactions on Signal Processing 55, 5 (2007), 1612–1623.
[25] Herrmann, D., Wendolsky, R., and Federrath, H. Website fingerprinting:
attacking popular privacy enhancing technologies with the multinomial naïve-
bayes classifier. In Proceedings of the 2009 ACM workshop on Cloud computing
security (2009), ACM, pp. 31–42.
[26] Hopper, N., Vasserman, E. Y., and Chan-Tin, E. How much anonymity does
network latency leak? ACM Transactions on Information and System Security
(TISSEC) 13, 2 (2010), 13.
[27] Houmansadr, A., and Borisov, N. SWIRL: A Scalable Watermark to Detect
Correlated Network Flows. In NDSS (2011).
marks using the Repeat-accumulate Codes. In ICASSP (2011).
[29] Houmansadr, A., and Borisov, N. The need for flow fingerprints to link
correlated network flows. In International Symposium on Privacy Enhancing
Technologies Symposium (2013), Springer, pp. 205–224.
[30] Houmansadr, A., Kiyavash, N., and Borisov, N. Multi-Flow Attack Resistant
Watermarks for Network Flows. In ICASSP (2009).
[31] Houmansadr, A., Kiyavash, N., and Borisov, N. RAINBOW: A Robust And
Invisible Non-Blind Watermark for Network Flows. In Network and Distributed
System Security Symposium (NDSS) (2009).
[32] Houmansadr, A., Kiyavash, N., and Borisov, N. Non-blind watermarking
of network flows.
IEEE/ACM Transactions on Networking (TON) 22, 4 (2014),
1232–1244.
[33] Houmansadr, A., Riedl, T., Borisov, N., and Singer, A. I Want My Voice to Be
Heard: IP over Voice-over-IP for Unobservable Censorship Circumvention. In
NDSS (2013).
Jansen, R., Juarez, M., Gálvez, R., Elahi, T., and Diaz, C. Inside Job: Applying
Traffic Analysis to Measure Tor from Within. In NDSS (2018).
Jelic, F. Tor’s Biggest Threat – Correlation Attack. https://www.deepdotweb.
com/2016/10/25/tors-biggest-threat-correlation-attack/, October 2016.
Johnson, A., Wacek, C., Jansen, R., Sherr, M., and Syverson, P. Users Get
Routed: Traffic Correlation on Tor by Realistic Adversaries. In CCS (2013).
Johnson, A., Wacek, C., Jansen, R., Sherr, M., and Syverson, P. Users get
routed: Traffic correlation on Tor by realistic adversaries. In Proceedings of the
2013 ACM SIGSAC conference on Computer & communications security (2013),
[34]
[35]
[36]
[37]
[39]
[38]
ACM, pp. 337–348.
Juarez, M., Afroz, S., Acar, G., Diaz, C., and Greenstadt, R. A critical evalua-
tion of website fingerprinting attacks. In Proceedings of the 2014 ACM SIGSAC
Conference on Computer and Communications Security (2014), ACM, pp. 263–274.
Juen, J., Johnson, A., Das, A., Borisov, N., and Caesar, M. Defending tor from
network adversaries: A case study of network path prediction. Proceedings on
Privacy Enhancing Technologies 2015, 2 (2015), 171–187.
[40] Kingma, D. P., and Ba, J. Adam: A method for stochastic optimization. arXiv
preprint arXiv:1412.6980 (2014).
[41] Kiyavash, N., Houmansadr, A., and Borisov, N. Multi-Flow Attacks Against
Network Flow Watermarking Schemes.
[42] Levine, B. N., Reiter, M. K., Wang, C., and Wright, M. Timing attacks in
low-latency mix systems. In International Conference on Financial Cryptography
(2004), Springer Berlin Heidelberg, pp. 251–265.
[43] Ling, Z., Luo, J., Yu, W., Fu, X., Xuan, D., and Jia, W. A new cell counter based
attack against tor. In Proceedings of the 16th ACM conference on Computer and
communications security (2009), ACM, pp. 578–589.
[44] Lu, L., Chang, E.-C., and Chan, M. C. Website fingerprinting and identification
using ordered feature sequences. In European Symposium on Research in Computer
Security (2010), Springer, pp. 199–214.
[45] meek Pluggable Transport. https://trac.torproject.org/projects/tor/wiki/doc/
meek.
[46] Mittal, P., Khurshid, A., Juen, J., Caesar, M., and Borisov, N. Stealthy
traffic analysis of low-latency anonymous communication using throughput
fingerprinting.
In Proceedings of the 18th ACM conference on Computer and
communications security (2011), ACM, pp. 215–226.
[47] Moghaddam, H., Li, B., Derakhshani, M., and Goldberg, I. SkypeMorph:
Protocol Obfuscation for Tor Bridges. In CCS (2012).
[48] Murdoch, S. J., and Danezis, G. Low-cost traffic analysis of Tor. In 2005 IEEE
Symposium on Security and Privacy (2005), IEEE, pp. 183–195.
[49] Murdoch, S. J., and Zieliński, P. Sampled traffic analysis by Internet-exchange-
level adversaries. In Privacy Enhancing Technologies Symposium (Ottawa, Canada,
June 2007), N. Borisov and P. Golle, Eds., vol. 4776, Springer.
[50] Nasr, M., Houmansadr, A., and Mazumdar, A. Compressive Traffic Analysis:
A New Paradigm for Scalable Traffic Analysis. In Proceedings of the 2017 ACM
SIGSAC Conference on Computer and Communications Security (2017), ACM,
pp. 2053–2069.
[51] Nithyanand, R., Starov, O., Zair, A., Gill, P., and Schapira, M. Measuring
and mitigating AS-level adversaries against Tor. In NDSS (2016).
[52] Turning on timing obfuscation (iat-mode=1) for some default bridges. https:
//lists.torproject.org/pipermail/tor-project/2016-November/000776.html, 2016.
[53] A Simple Obfuscating Proxy. https://www.torproject.org/projects/obfsproxy.
html.en.
[59] Pyun, Y. J., Park, Y. H., Wang, X., Reeves, D. S., and Ning, P. Tracing traffic
through intermediate hosts that repacketize flows.
In INFOCOM 2007. 26th
IEEE International Conference on Computer Communications. IEEE (2007), IEEE,
pp. 634–642.
[60] Ramsbrock, D., Wang, X., and Jiang, X. A first step towards live botmaster
traceback. In Recent Advances in Intrusion Detection (2008), Springer, pp. 59–77.
[61] Reiter, M. K., and Rubin, A. D. Crowds: Anonymity for web transactions. ACM
Transactions on Information and System Security (TISSEC) 1, 1 (1998), 66–92.
[62] Rennhard, M., and Plattner, B. Introducing MorphMix: peer-to-peer based
anonymous Internet usage with collusion detection. In Proceedings of the 2002
ACM workshop on Privacy in the Electronic Society (2002), ACM, pp. 91–102.
[63] Rezaei, F., and Houmansadr, A. Tagit: Tagging network flows using blind
fingerprints. In Privacy Enhancing Technologies (PETS) (2017).
Automated Website Fingerprinting through Deep Learning. In NDSS (2018).
[65] Shmatikov, V., and Wang, M.-H. Timing analysis in low-latency mix networks:
Attacks and defenses. In European Symposium on Research in Computer Security
(ESORICS) (2006), Springer, pp. 18–33.
[66] Staniford-Chen, S., and Heberlein, L. T. Holding intruders accountable on
the Internet. In Security and Privacy, 1995. Proceedings., 1995 IEEE Symposium on
(1995), IEEE, pp. 39–49.
[64] Rimmer, V., Preuveneers, D., Juarez, M., Goethem, T. V., and Joosen, W.
[54] Panchenko, A., Lanze, F., Zinnen, A., Henze, M., Pennekamp, J., Wehrle, K.,
and Engel, T. Website Fingerprinting at Internet Scale. In Proceedings of the
23rd Internet Society (ISOC) Network and Distributed System Security Symposium
(NDSS 2016) (2016).
[55] Panchenko, A., Niessen, L., Zinnen, A., and Engel, T. Website fingerprinting in
onion routing based anonymization networks. In Proceedings of the 10th annual
ACM workshop on Privacy in the electronic society (2011), ACM, pp. 103–114.
[56] Paxson, V., and Floyd, S. Wide-area traffic: The failure of Poisson modeling.
IEEE/ACM Transactions on Networking 3, 3 (June 1995), 226–244.
torproject.org/critique-website-traffic-fingerprinting-attacks, Feb. 2017.
[57] Perry, M. A Critique of Website Traffic Fingerprinting Attacks. https://blog.
https://www.torproject.org/docs/
[58] Tor:
Pluggable
Transports.
pluggable-transports.html.en.
[67] Starov, O., Nithyanand, R., Zair, A., Gill, P., and Schapira, M. Measuring
and mitigating AS-level adversaries against Tor. In NDSS (2016).
[68] Sun, Y., Edmundson, A., Feamster, N., Chiang, M., and Mittal, P. Counter-
RAPTOR: Safeguarding Tor Against Active Routing Attacks. In Security and
Privacy (SP), 2017 IEEE Symposium on (2017), IEEE, pp. 977–992.
[69] Sun, Y., Edmundson, A., Vanbever, L., Li, O., Rexford, J., Chiang, M., and
Mittal, P. RAPTOR: routing attacks on privacy in tor. In 24th USENIX Security
Symposium (USENIX Security 15) (2015), pp. 271–286.
[70] Tan, H., Sherr, M., and Zhou, W. Data-plane defenses against routing attacks
on Tor. Proceedings on Privacy Enhancing Technologies 2016, 4 (2016), 276–293.
[71] Tor Metrics. https://metrics.torproject.org.
[72] Wang, T., Cai, X., Nithyanand, R., Johnson, R., and Goldberg, I. Effective
attacks and provable defenses for website fingerprinting. In 23rd USENIX Security
Symposium (USENIX Security 14) (2014), pp. 143–157.
[73] Wang, T., and Goldberg, I. Improved website fingerprinting on tor. In Proceed-
ings of the 12th ACM workshop on Workshop on privacy in the electronic society
(2013), ACM, pp. 201–212.
[74] Wang, T., and Goldberg, I. On realistically attacking Tor with website finger-
printing. Proceedings on Privacy Enhancing Technologies 2016, 4 (2016), 21–36.
[75] Wang, X., Chen, S., and Jajodia, S. Tracking Anonymous Peer-to-peer VoIP
Calls on the Internet. In CCS (2005).
[76] Wang, X., Chen, S., and Jajodia, S. Network flow watermarking attack on
low-latency anonymous communication systems. In Security and Privacy, 2007.
SP’07. IEEE Symposium on (2007), IEEE, pp. 116–130.
[77] Wang, X., and Reeves, D. S. Robust correlation of encrypted attack traffic
through stepping stones by manipulation of interpacket delays. In Proceedings of
the 10th ACM conference on Computer and communications security (2003), ACM,
pp. 20–29.
[78] Wang, X., Reeves, D. S., and Wu, S. F. Inter-packet delay based correlation for
tracing encrypted connections through stepping stones. In Computer Securi-
tyâĂŤESORICS 2002. Springer, 2002, pp. 244–263.
[79] Wright, M. K., Adler, M., Levine, B. N., and Shields, C. An Analysis of the
Degradation of Anonymous Protocols. In NDSS (2002), vol. 2, pp. 39–50.
Computer Security-ESORICS 2000. Springer, 2000, pp. 191–205.
[81] Yu, W., Fu, X., Graham, S., Xuan, D., and Zhao, W. DSSS-based flow marking
In Security and Privacy, 2007. SP’07. IEEE
technique for invisible traceback.
Symposium on (2007), IEEE, pp. 18–32.
In USENIX Security
Symposium (2000), vol. 171, p. 184.
[83] Zhu, Y., and Bettati, R. Unmixing Mix Traffic. In Privacy Enhancing Technologies
Workshop (May 2005), D. Martin and G. Danezis, Eds., pp. 110–127.
[84] Zhu, Y., Fu, X., Graham, B., Bettati, R., and Zhao, W. On flow correlation
attacks and countermeasures in mix networks. In International Workshop on
Privacy Enhancing Technologies (2004), Springer, pp. 207–225.
[80] Yoda, K., and Etoh, H. Finding a connection chain for tracing intruders. In
[82] Zhang, Y., and Paxson, V. Detecting Stepping Stones.
14