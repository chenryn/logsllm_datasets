gorithm, we require a large corpus of naturalistic usage
data for a ﬁtness tracking app. Strava is one of the most
popular ﬁtness tracking apps, with over a million ac-
tive monthly users [2] and over a billion total activities
recorded so far. We thus select it as an exemplar ﬁtness
tracking app.4 In this section, we describe our methodol-
ogy for collecting usage information from public Strava
posts.
In characterizing the resulting dataset, we also
3This section describes a methodology that is no longer feasible
on Strava following changes made in response to our disclosure.
4Although our approach is primarily evaluated on Strava, note that
in § 7 we demonstrate the generality of the attack using other services.
provide useful insights as to the privacy habits of the ath-
letes on ﬁtness tracking apps.
4.1 Methodology
We begin by collecting a large sample of public posts to
the Strava using a cURL-based URL scraping script. Be-
cause Strava assigns sequential identiﬁers to activities as
they are posted, our scraper was able to traverse posts
to the network in (roughly) chronological order. It was
also able to obtain data resources for each post in JSON-
encoded format using an HTTP REST API. Our scraper
did not collect data from private activities, only the infor-
mation available in public posts. In fact, it was not neces-
sary to be logged into Strava in order to access the sites
visited by our scraper. These features have previously
been used by other members of the Strava community in
order to measure various aspects of the service [8, 9, 10].
The scraper takes as input a start and an end activ-
ity ID, then iterates across the continuous sequence of
activity IDs. For each ID, the crawler ﬁrst visits the
strava.com/activities/ID page to extract the activity’s
start date and time, Athlete ID, total distance, total dura-
tion, reported athlete gender, and the type of the activity.
It then uses the strava.com/stream/ID API to extract
GPS samples for the activity route, as well as the total
distance traveled at each GPS sample. The scraper uses
the ﬁrst GPS coordinate in the route to obtain the country
of the activity. Using an additional API that facilitates in-
teroperability between Strava and other social networks,
the scraper recovers the time the activity was posted, then
subtracts the length of the activity to approximate the
start time. Through experimentation, we discovered that
when an activity is associated with an EPZ, there is a
discrepancy between the advertised distance on the ac-
tivity page and the ﬁnal distance traveled according to
the GPS samples; the crawler check-marks the activity
as EPZ-enabled if this discrepancy is found.
4.2 Data Corpus
Using the above methodology, we collected a month
worth of Strava activities beginning on May 1, 2016. The
activity IDs associated with May 1 and May 31 were
identiﬁed by conducting a binary search of the activ-
ity space and veriﬁed through manual inspection. How-
ever, we note that activity IDs are assigned in roughly
chronological order; we observed activities that appeared
months to years out of sequence. We attribute this behav-
ior to devices that had intermittent network connectivity
and to users that deliberately set their device to the in-
correct date. It is therefore likely that our dataset omits a
small percentage of activities that occurred in May 2016.
Scraped activities that fell outside of May 2016 were dis-
502    27th USENIX Security Symposium
USENIX Association
Figure 3: Distribution of Activities by time of the day.
Figure 5: Most popular countries in our dataset.
in Figure 4, the dataset reﬂects a healthy variety of us-
age levels, with many athletes logging over 100 activities
during the month. We also note the the diverse demo-
graphic makeup of our dataset. Figure 5 shows the in-
ternational popularity of Strava. While the United States
(US) and Great Britain (GB) are the most active coun-
tries by a signiﬁcant margin, 21 other countries contain
at least 150,000 activities, with 241 countries appearing
in the dataset overall.5
5 Evaluation6
We now leverage our activity dataset comprised of Strava
public posts to perform a large-scale privacy analysis of
EPZ mechanism. To establish ground truth with which
to measure the accuracy of our EPZ identiﬁcation algo-
rithm, we ﬁrst create a synthetic set of EPZ-enabled ac-
tivities using unprotected routes for which the true end-
points are known. After validating our approach, we then
quantify the real-world severity of this danger by running
our algorithm against legitimate EPZ-enabled activities.
We discover that the EPZ mechanism in fact leaks signif-
icant information about users’ sensitive locations to the
point that they can be reliably inferred using only a hand-
ful of observations (i.e., activities).
5.1 Validation
In order to verify that our algorithm works as intended,
we require a ground truth that will enable us to issue pre-
dictions over EPZs with known centers. To do so, we
make use of the 18,532,140 unprotected activities gen-
erated by 2,528,519 athletes in our Strava dataset. For
each athlete, we search across their activities for end-
points that fall within 50 meters of one another; this dis-
tance approximates size of a suburban house plot. We
then designate the centroid of these points as a protected
5While we took every effort to remove virtual activities from our
dataset, we do not rule out the possibility that some activities were
generated by exercise equipment training routines.
6This section describes the results based on Strava’s previous EPZ
mechanism, which was replaced following our vulnerability disclosure.
Figure 4: Distribution of Athletes by activities recorded.
carded from the dataset. Running our scraper across 15
CPU threads, the dataset took 14 days to collect.
Initially, the dataset contained over 23,925,305 activ-
ities. Three types of activities were discarded: 1) Pri-
vate activities for which we did not retrieve any usage
information, 2) Activities with 0.0 distance that did not
have any route information, and 3) Activities with type
other than Walk, Ride, and Run . We observed 8 differ-
ent activity types (Ride, Run, Walk, Hike, Virtualride,
Swim, Workout, and others) in our dataset, with Ride,
Run, and Walk comprised the 94% of total activities.
Other activity types (e.g., workouts) were excluded be-
cause they were unlikely to be actual GPS routes or pro-
tected locations, while others (e.g., Virtual-ride) likely
reported false GPS routes. The remaining dataset con-
tained 20,892,606 activities from 2,960,541 athletes.
We observed a total of 2,360,466 public activities that
were associated with an EPZ; as a point of comparison,
this is more than twice the number of (excluded) private
activities (1,080,484), underscoring the popularity of the
EPZ feature. The use of EPZs is spread out across a large
number of users, with 432,022 athletes being associated
with at least one EPZ activity and 346,433 being asso-
ciated with more than one EPZ activity. Total activities
by male-identifying athletes are 16,703,160 and female-
identifying are 3,227,255, while 962,191 activities report
no gender identity. A diurnal pattern is observable in
the distribution of activities by time of day, as shown in
Figure 3. 545,997 users are not regularly active in our
dataset, logging only one activity; however, as shown
USENIX Association
27th USENIX Security Symposium    503
 200 400 600 800 1000 1200 1400 1600 0 5 10 15 20Activity Count (in thousands)Hours (24-format) 10 100 1000 10000 100000>100 10 20 30 40 50 60 70 80 90Number of Athletes (log scaled)Number of Activities 0 500 1000 1500 2000 2500 3000 3500 4000 4500USGBBRESAUNLFRITCADEBENOJPSEKRPLZARUPTCHDKIETHActivity Count (in thousands)CountryFigure 6: Distribution of identiﬁed EPZs by radius. This ﬁnd-
ing suggests that the smallest privacy zone is signiﬁcantly more
popular than larger privacy zones.
location, synthesize an EPZ with a radius of 0.25 miles
over the centroid, and update the GPS data by removing
all points that fall within the synthetic EPZ. Finally, our
identiﬁcation algorithm attempts to independently pre-
dict the (known) center of each (synthesized) EPZ.
As discussed in Section 3, our algorithm is parameter-
ized by three thresholds: td, tc, and ti. To determine ef-
fective values for these parameters, we withheld from the
above synthetic data a set of 10,000 athletes. We deter-
mined that an appropriate value for the distance thresh-
old td was 0.05 meters and ti was 0.1 meters. We set
our conﬁdence threshold tc to 3, because our predictions
were never conclusive using just two activities, as dis-
cussed below. We note that these values need to be ad-
justed for different services, or as Strava modiﬁes the
sampling/precision of its GPS coordinates7. Using these
parameters, we were able to identify 96.6% athletes out
of 2,518,519. As noted previously, our identiﬁcation al-
gorithm is not deterministic; however, by selecting the
highest conﬁdent candidate EPZ, we were able to cor-
rectly predict 96.6% of EPZs in the synthesized set.
Failure Conditions.
For 3.4% of athletes, we were un-
able to identify an EPZ. The reason for this is almost
entirely due to a lack of available observations. If only
two activities were available for a given athlete, it was
common that only two points would intersect the EPZ.
With only two intersection points, ﬁve candidate EPZ of
equal likelihood are discovered, one for each of the pos-
sible radii. This motivates our decision to set tc to 3, as
it removes a failure condition that would lead to a high
false positive rate in the subsequent tests. Only in rare in-
stances were more than two intersections obtained from
just two activities.
7Between our preliminary experiments and data collection, Strava
increased the granularity of their sampling rate by a factor of 5.
(a) Identiﬁcation rate by Activity Count.
(b) Identiﬁcation rate by Total Distance.
(c) Identiﬁcation rate by Total Duration.
Figure 7: CDFs for identiﬁed versus unidentiﬁed locations
across various metrics. Activity count is the greatest predic-
tor of successful identiﬁcation, suggesting that our technique
would be more successful over a longer period of observation.
5.2 Results for EPZ Identiﬁcation
Having validated the effectiveness of our technique
against a synthesized dataset, we now turn our attention
to identifying actual protected locations of actual Strava
athletes. We ran our algorithm, as parameterized above,
against our dataset of 2,360,466 EPZ-enabled activities
generated by 432,022 athletes. Using our technique, we
were able to identify 84% of all users protected locations
with more than one EPZ-enabled activity. Under favor-
able conditions in which a user records at least 3 EPZ-
enabled activities, our accuracy increases to 95.1%.
Figure 6 summarizes the protected locations identiﬁed
by EPZ radius size. As we will demonstrate in Section 6,
the effectiveness of our algorithm degrades against large
EPZ radii, due solely to their propensity to obscure en-
tire activities; in fact, for EPZ radii of 0.625 miles, we
see the accuracy of our approach falls to 44% against
504    27th USENIX Security Symposium
USENIX Association
 20 40 60 80 100 120 140 160 180 2000.1250.2500.3750.5000.625No. of Athletes (thousands)Radii of EPZs (Miles) 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 5 10 15 20 25 30 35Cumulative DensityActivities Countidentifiednot identified 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 200 400 600 800 1000 1200 1400 1600 1800Cumulative DensityDistance (miles)identifiednot identified 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 50 100 150 200Cumulative DensityTime (hours)identifiednot identified(a) Modify Radius
(b) Fuzz EPZ Intersection Points
(c) Spatial Cloaking
Figure 8: Obfuscation techniques for EPZs. The original EPZ circle is shown in white, while the enhanced EPZ circle is shown in
green. In Figure 8b, the circle is unmodiﬁed but each activity route truncated by a random number of coordinates.
synthetic data. However, this decrease in efﬁcacy alone
does not account for the large difference in frequency
of EPZ size. For example, if each radius were equally
popular, we would have expected to identify 80,000 ath-
letes with the 0.625 mile radius. As a result, this ﬁgure
most likely reﬂects the distribution of EPZ radii popular-
ity. We therefore infer that the smallest EPZ is several
times more popular than any other EPZ size, and that the
popularity of EPZs are inversely correlated to their radii.
We also wished to characterize the circumstances un-
der which our technique succeeded and failed. Fig-
ure 7 shows the cumulative density functions (CDFs) of
identiﬁed locations and unidentiﬁed locations across sev-
eral different potentially inﬂuential metrics: the activities
count for the athlete (Fig. 7a), the total distance traveled
by the athlete (Fig. 7b), and the total duration of ath-
lete activity (Fig. 7c). The greatest predictor of whether
or not a protected location is leaked is the total number
of activities observed. Locations that were not identiﬁed
had an average of 4.6 activities, whereas locations that
were identiﬁed had an average of 6.2 activities. Recall
our dataset is comprised of a single month of Strava ac-
tivity; this ﬁnding indicates that, over a prolonged win-
dow, the number of leaked locations is likely to be much
larger than 95.1% amongst regular users of Strava.
Failure Condition.
For 16% of the 432,022 total ath-
letes that logged an EPZ-enabled activity, we were un-
able to detect the protected location. The reason for this
is, like in our validation study, there were a number of
athletes with too few activities to exceed the tc conﬁ-
dence threshold. Out of the total number of athletes, we
found that 11% had recorded 1 activity and out of this set,
zero protected locations were identiﬁed. To demonstrate,
we ﬁltered low-activity athlete accounts and considered
only the remaining 283,920 athletes. Our algorithm iden-
tiﬁed 95.1% of the protected locations for these moder-
ately active users (3+ EPZ-enabled activities). The re-
maining 4.9% are accounted for by athletes that logged
a single activity for multiple distinct EPZs that did not
intersect. For example, one athlete recorded an EPZ-
enabled activity in two different cities. These ﬁndings
indicate that the EPZ mechanism is ineffective even for
moderately active users of ﬁtness tracking services.
6 Countermeasures
While the EPZ mechanism is widely used by ﬁtness
tracking services, it lags behind the state-of-the-art in
location privacy research.
In this section, we address
this gap in the literature by testing state-of-the-art pri-
vacy mechanisms against our Strava dataset, as well as
proposing our own defense that fuzzes the boundaries of
EPZs in order to frustrate our attack.
6.1 Obfuscation techniques
Location obfuscation techniques are complementary to
anonymity; rather than hiding user identities, location
obfuscation techniques assume that user identities exist
but add uncertainty and randomness in collected loca-
tions to decrease accuracy. Figure 8 shows the intuition
of the three approaches that we consider.
1. Modify Radius Size. Ardagna et al. propose location
privacy for ﬁtness tracking domains [27] by applying
a modiﬁcation to the EPZ radius to enlarge the pri-
vacy zone, as shown in the Figure 8a. Here, r is the
original radius of privacy zone and r (cid:48) is the enlarged
radius. This technique predicts that the protected lo-
cation will be harder to guess if the last visible point
in the activity is further away from location.
2. Fuzz EPZ Intersection Points: The surveyed EPZ
implementations provide a GPS coordinate in the ac-
tivity route that falls very close to the boundary of the
privacy zone. We reason that perturbing the boundary
of the EPZ will signiﬁcantly increase the difﬁculty of
attack. We therefore present a fuzzing method that,
for each posted activity, randomly removes a small
number of GPS coordinates beyond the true bound-
ary of the EPZ. We predict that a small amount of
USENIX Association
27th USENIX Security Symposium    505
rr’r1r2r3d✓noise (e.g., a few meters) injected in this fashion will
dramatically change the location of the attacker’s pre-
diction (e.g., a few blocks).
3. Spatial Cloaking Another technique of location ob-
fuscation is spatial cloaking [41]. We adapt spatial
cloaking the in context of ﬁtness tracking services.
We shift the center of EPZ, concealing the protected
location at an unknown point within the privacy zone.
This obfuscation is shown in Figure 8c, where d is the
size of the shift and θ is the direction (angle) in which
center moves. Note that while shifting center, the d
needs to be always less than the radius of previous
privacy zone circle otherwise user sensitive location
information will not be obfuscated. We pick d using
random value generated from Laplacian distribution
to achieve ε-geo-indistinguishability where ε is level
of privacy [26].8
6.2 Data Synthesis
To test the above privacy extensions, we generated obfus-
cated privacy zone records using our Strava dataset us-
ing 18,532,140 unprotected (not-EPZ enabled) activities.
The reason for using unprotected activities is that they
provided known locations to use as ground truths, and
also because some countermeasures may actually reveal
parts of the true route that were concealed by Strava’s
EPZ implementation. We generated a synthetic dataset
using the same technique described in Section 5.1. For
each user, we searched their activities for route endpoints
that fell within 50 meters of one another. We took the
centroid of these points and designated it as a synthetic
protected location. By considering only those activities
associated with one of these protected locations, our sub-
sequent analysis was based off 1,593,364 users and asso-
ciated activities. Finally, we applied a privacy-enhanced
EPZ to each protected location as described below.
6.3 Countermeasure Implementations
Modify Radius.
For each user, we apply each of the 5