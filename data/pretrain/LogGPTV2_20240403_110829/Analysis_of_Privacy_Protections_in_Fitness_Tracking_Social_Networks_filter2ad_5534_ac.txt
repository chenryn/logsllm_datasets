### 4.1 Methodology

To collect usage data from the popular fitness tracking app, Strava, we developed a cURL-based URL scraping script. Strava assigns sequential identifiers to activities as they are posted, allowing our scraper to traverse posts in (roughly) chronological order. The script also retrieves JSON-encoded data resources for each post using an HTTP REST API. Importantly, the scraper only collects data from public posts, not private activities, and does not require logging into Strava to access the information. These features have been used by other members of the Strava community to measure various aspects of the service [8, 9, 10].

The scraper takes a start and end activity ID as input, then iterates through the continuous sequence of activity IDs. For each ID, it visits the `strava.com/activities/ID` page to extract the activity's start date and time, Athlete ID, total distance, total duration, reported athlete gender, and the type of activity. It then uses the `strava.com/stream/ID` API to extract GPS samples for the activity route and the total distance traveled at each GPS sample. The first GPS coordinate is used to determine the country of the activity. An additional API that facilitates interoperability between Strava and other social networks is used to recover the time the activity was posted, and the length of the activity is subtracted to approximate the start time.

Through experimentation, we found that when an activity is associated with an EPZ (Enhanced Privacy Zone), there is often a discrepancy between the advertised distance on the activity page and the final distance traveled according to the GPS samples. If this discrepancy is detected, the activity is flagged as EPZ-enabled.

### 4.2 Data Corpus

Using the methodology described above, we collected a month's worth of Strava activities starting from May 1, 2016. The activity IDs for May 1 and May 31 were identified through a binary search of the activity space and verified manually. However, we observed that some activity IDs were assigned out of sequence, likely due to devices with intermittent network connectivity or users setting incorrect dates. This suggests that our dataset may omit a small percentage of activities from May 2016. Activities outside of May 2016 were discarded from the dataset.

Running the scraper across 15 CPU threads, the dataset took 14 days to collect. Initially, the dataset contained over 23,925,305 activities. We discarded three types of activities: 1) Private activities, 2) Activities with 0.0 distance and no route information, and 3) Activities with types other than Walk, Ride, and Run. The remaining dataset included 20,892,606 activities from 2,960,541 athletes.

We observed 2,360,466 public activities associated with an EPZ, more than twice the number of private activities (1,080,484). The use of EPZs is widespread, with 432,022 athletes associated with at least one EPZ activity and 346,433 with more than one. Male-identifying athletes logged 16,703,160 activities, female-identifying athletes logged 3,227,255, and 962,191 activities did not report a gender identity. A diurnal pattern is evident in the distribution of activities by time of day, as shown in Figure 3.

### 5. Evaluation

We used the dataset of Strava public posts to perform a large-scale privacy analysis of the EPZ mechanism. To establish a ground truth for measuring the accuracy of our EPZ identification algorithm, we created a synthetic set of EPZ-enabled activities using unprotected routes with known endpoints.

#### 5.1 Validation

To validate our algorithm, we used 18,532,140 unprotected activities generated by 2,528,519 athletes. For each athlete, we searched their activities for endpoints within 50 meters of each other, approximating the size of a suburban house plot. We designated the centroid of these points as a protected location, synthesized an EPZ with a radius of 0.25 miles, and updated the GPS data by removing points within the synthetic EPZ. Our identification algorithm then attempted to predict the (known) center of each (synthesized) EPZ.

Our algorithm is parameterized by three thresholds: \( t_d \), \( t_c \), and \( t_i \). We determined effective values for these parameters by withholding a set of 10,000 athletes from the synthetic data. The distance threshold \( t_d \) was set to 0.05 meters, and \( t_i \) to 0.1 meters. The confidence threshold \( t_c \) was set to 3, as predictions were inconclusive with just two activities. Using these parameters, we correctly identified 96.6% of EPZs in the synthesized set.

**Failure Conditions:**
For 3.4% of athletes, we were unable to identify an EPZ, primarily due to a lack of available observations. If only two activities were available, it was common to have only two intersection points, leading to five equally likely candidate EPZs. Setting \( t_c \) to 3 removes this failure condition, reducing false positives.

#### 5.2 Results for EPZ Identification

Having validated our technique against a synthesized dataset, we applied it to actual Strava athletes' EPZ-enabled activities. We ran our algorithm against 2,360,466 EPZ-enabled activities generated by 432,022 athletes. We identified 84% of all users' protected locations with more than one EPZ-enabled activity. Under favorable conditions, where a user records at least 3 EPZ-enabled activities, our accuracy increased to 95.1%.

Figure 6 shows the distribution of protected locations by EPZ radius size. Our algorithm's effectiveness degrades with larger EPZ radii, as they obscure entire activities. For EPZ radii of 0.625 miles, our accuracy falls to 44%. This decrease in efficacy, combined with the distribution of EPZ sizes, suggests that smaller EPZs are several times more popular than larger ones.

**Failure Condition:**
For 16% of the 432,022 athletes who logged an EPZ-enabled activity, we were unable to detect the protected location. This was due to a lack of activities exceeding the \( t_c \) confidence threshold. Out of the total, 11% had recorded only one activity, and none of these protected locations were identified. Filtering low-activity accounts, we considered 283,920 moderately active users (3+ EPZ-enabled activities) and identified 95.1% of their protected locations. The remaining 4.9% were accounted for by athletes who logged a single activity for multiple distinct EPZs that did not intersect.

### 6. Countermeasures

While the EPZ mechanism is widely used, it lags behind state-of-the-art location privacy research. We tested state-of-the-art privacy mechanisms against our Strava dataset and proposed a defense that fuzzes the boundaries of EPZs to frustrate our attack.

#### 6.1 Obfuscation Techniques

1. **Modify Radius Size:**
   Ardagna et al. propose enlarging the EPZ radius to increase privacy. By increasing the radius, the last visible point in the activity is further from the protected location, making it harder to guess.

2. **Fuzz EPZ Intersection Points:**
   Perturbing the boundary of the EPZ by randomly removing a small number of GPS coordinates beyond the true boundary can significantly increase the difficulty of the attack. A small amount of noise (e.g., a few meters) can dramatically change the attacker's prediction (e.g., a few blocks).

3. **Spatial Cloaking:**
   Shifting the center of the EPZ conceals the protected location at an unknown point within the privacy zone. The shift distance \( d \) is less than the radius of the previous privacy zone, and \( d \) is picked using a random value from a Laplacian distribution to achieve Îµ-geo-indistinguishability.

#### 6.2 Data Synthesis

To test these privacy extensions, we generated obfuscated privacy zone records using 18,532,140 unprotected (not-EPZ enabled) activities from our Strava dataset. These provided known locations for ground truths. We generated a synthetic dataset using the same technique described in Section 5.1, considering only activities associated with one of the protected locations, resulting in 1,593,364 users and associated activities.

#### 6.3 Countermeasure Implementations

**Modify Radius:**
For each user, we applied different modifications to the EPZ radius to evaluate the impact on privacy.