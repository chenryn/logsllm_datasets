forms of activity that indicate abusive or intrusive activity
on Unix hosts.
eXpert-BSM excels at detecting when an adversary at-
tempts to violate security on the host, regardless of whether
it is an external agent or an insider operating from the con-
sole. While attack space coverage is not claimed to be com-
plete, signiﬁcant effort and experience has been invested in
this knowledge base over several years. The majority of
the intrusion models attempt to recognize the most general
form of misuse by detecting state transitions that represent
the underlying compromise of intrusions and other known
misuse activity. With respect to attack coverage, these in-
trusion models are categorized under the following broad
areas of host misuse:
Data Theft — involves attempts by non-administrative
users to perform read operations on ﬁles or devices
in a manner considered inconsistent with the system
security policy. This includes attempts to access ﬁles
stored in nonpublic directories that are owned by other
users, or to reference ﬁles in violation of eXpert-BSM’s
surveillance policy (Section 3.2). The category in-
cludes attempts to access root core ﬁle contents, a
well-known method to gain access to encrypted or
even cleartext password content. The category also in-
cludes opening network interface devices in promiscu-
ous mode, indicating attempts by non-administrative
users to sniff trafﬁc from the network.
System/User Data Manipulation — attempts by non-
administrative users to modify system or user data,
where modify broadly means attempts to alter, create,
overwrite, append, remove, or change content or the
attributes of ﬁle system objects. Coverage in this cate-
gory includes attempts to modify system ﬁles within
which security-relevant conﬁguration parameters are
stored. This conﬁgurable list of ﬁles typically includes
ﬁles in /etc. The category also includes attempts by
anonymous FTP users to modify ﬁle system content
outside a predeﬁned upload directory, should one ex-
ist.
Intrusion models that detect attempts to modify
user environment ﬁles (e.g., .csrhc, .login, or .rhosts)
or modify ﬁles in violation of eXpert-BSM’s surveil-
lance policy (Section 3.2) are also included in this cat-
egory. Lastly, the category provides comprehensive
coverage over attempts to modify system executable
binaries and scripts stored in publicly shared binary di-
rectories.
Privilege Subversion — provides broad and effective cov-
erage of illegal attempts to subvert root or other admin-
istrator authority, either through the illegal changing
of one’s operating authority, subverting the function of
a privileged (setuid) application, or by causing a set-
uid process to execute an application that is not owned
by the setuid program owner or the system. Intrusion
models in this category are capable of detecting the
three variations of buffer overﬂow attacks [14, 2] that
continue to plague Unix setuid applications and inetd
services: exec argument buffer overﬂows, environment
variable overﬂows, and data-segment overﬂows. The
generality of eXpert-BSM’s buffer overﬂow model was
demonstrated when a new such exploit was published
for Solaris 8 [5]. Without being updated with speciﬁc
knowledge about the new attack, eXpert-BSM detected
and correctly identiﬁed this event as privilege subver-
sion through a buffer overﬂow. Overall, the BSM au-
dit trail provides far superior event content than net-
work trafﬁc from which to identify process subversion
on hosts. Inetd service subversion (such as the well-
known sadmind(1) attack on Solaris [3]) is an exam-
ple of a data segment buffer overﬂow, while exec ar-
gument and environment variable overﬂows have been
exploited in perhaps more than a dozen setuid applica-
tions on Solaris alone (e.g., eject, fdformat, ffbconﬁg,
passwd, ping, rdist, rlogin, ufsrestore, and xlock).
Account Probing and Guessing — identiﬁes repeated at-
tempts to enter a system via authentication services
such as rlogin or FTP, or attempts to gain root authority
by non-administrative users or from external clients.
Suspicious Network Activity — recognizes various at-
tempts to probe or scan the host, or misuse the host’s
FTP services to distribute content to other external
sites (i.e., FTP warez hosting). While BSM audit trails
provide minimal insight into raw network trafﬁc activ-
ity, they do allow the monitor to recognize successful
connections to TCP-based services, and more impor-
tantly provide detailed insight into the internal opera-
tions of the network server process as it is being used
(or potentially misused). eXpert-BSM also provides a
TCP port scan detection capability on TCP ports that
have enabled services on the host.
Asset Distress — identiﬁes operational activity that in-
dicates a current or impending failure or signiﬁcant
degradation of a system asset. The majority of these
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:09:26 UTC from IEEE Xplore.  Restrictions apply. 
problems are very difﬁcult, if not impossible, to di-
agnose via network trafﬁc analysis. This category in-
cludes ﬁlesystem or process table exhaustion, and also
core-dump events by root-owned services.
In addi-
tion, this category includes detection of malicious ser-
vice denials, both through remote agents attempting
to exhaust process tables via inetd services, and by a
Solaris-speciﬁc self echo ﬂooding attack by local host
processes.
User-speciﬁable Surveillance — allows the eXpert-BSM
operator to create site-speciﬁc policies on activity that
should trigger an immediate alarm. This category in-
cludes the ability to recognize operator-deﬁned com-
mand arguments considered suspicious for that site and
worthy of administrative review. In addition, the op-
erator can specify network ports that should not be
accessed by external clients. Examples may include
TCP ports 53 (DNS zone transfer), 143 (imapd), or
514 (syslogd). This category also includes the addition
of a powerful feature for specifying a site surveillance
policy to monitor user accesses to data and executable
ﬁles (discussed in Section 3.2).
Other Security-relevant Events — provides other gen-
eral security-relevant activity reports worthy of review
by security administrators. This includes signiﬁcant
backward movement of the system clock beyond what
is normally performed by clock synchronization pro-
tocols. This backward time movement is a possible
indicator of an attacker attempting to manipulate ﬁle
or log state to reduce the risk of detection. This cate-
gory recognizes setuid enabling by non-administrative
users, and suspicious symbolic link creation in pub-
licly writable directories. Process execution by re-
served accounts that are not intended to run applica-
tions (e.g., bin, sys) are also recognized. Finally, this
category recognizes attempts to alter the underlying
audit conﬁguration, potentially in an effort to ﬂood or
starve eXpert-BSM.
3.2. File surveillance policy speciﬁcation
eXpert-BSM provides a facility for specifying a surveil-
lance policy over ﬁle reads, writes, and executions. Under
this policy, the eXpert-BSM operator may specify groups of
users, ﬁles, and directories, and then use these groups to
specify surveillance policies regarding ﬁle accesses. This
allows the operator to easily establish rules for generating
immediate notiﬁcation when users step outside their desig-
nated roles on the system.
For example, consider a consultant who is granted access
to parts of a ﬁle server that also contains company sensitive
data to which the consultant should not have access. The
operator would, as a ﬁrst line of defense, set access controls
on ﬁles and directories to prevent the consultant’s access to
these sensitive ﬁle system areas. However, over time users
who work in these areas may fail to continually manage the
proper settings on these ﬁles and directories, or may create
new sensitive ﬁles that by default allow the consultant ac-
cess. The surveillance policy allows the operator to easily
detect whenever the consultant accesses, or even attempts
to access, ﬁles or directories in the sensitive areas of the ﬁle
system.
There are three distinct components to be speciﬁed
within an eXpert-BSM access policy speciﬁcation. The ﬁrst
component, the UserGroups section, allows the operator to
specify groups of users, which are then referenced in the
access policy. The names speciﬁed under the user groups
should be present as valid login names deﬁned within the
password ﬁle, and user names can appear in multiple lists.
The second section, FileGroups, allows the operator to
specify a set of ﬁles and directories that may be referenced
together as a group while enumerating the access policy.
Files speciﬁed in the ﬁle groups should be fully qualiﬁed
pathnames. The operator can also specify directories, as
shown in the example surveillance policy speciﬁcation in
Figure 1. Files and directories can appear in multiple lists.
The third section is Policy, within which the operator can
specify illegal read, write, and execute accesses between
users and ﬁles. The policy section essentially deﬁnes ac-
cess mode relations among user groups and ﬁle groups. For
each user group entered in the policy, three possible rela-
tions can be speciﬁed: nread, nwrite, and nexec. The nread
mode indicates that users in the associated list are not al-
lowed to read ﬁles matching the ﬁle lists speciﬁed in the
bracket clause. Illegal ﬁle writes and executions are speci-
ﬁed similarly. Figure 1 presents an example of an eXpert-
BSM access policy speciﬁcation.
In Figure 1, there exists a small group of regular staff de-
ﬁned as user1 and user2. There is a management staff, with
one manager admin and an accounting group consisting of
user acct. Four ﬁle groups are deﬁned. The ﬁrst ﬁle group
is the programs group, where programs are deﬁned as be-
ing located in /bin, /usr/bin, /usr/local/bin, and /usr/local/
ftp/bin. An administrative tools group consists of ﬁles in
/etc/bin, /etc/sbin, /usr/sbin, and /sbin. A directory contain-
ing company secrets is named /secret. A payroll ﬁle group
consists of a ﬁle called /accounting/DBMS/payroll.db.
In Figure 1, regular staff are not allowed to read company
secrets or payroll data, as speciﬁed by the associated nread
function. Regular staff may not write to ﬁles in the com-
pany secrets, programs, payroll, or admin tools, and regular
staff may not execute admin tools. If eXpert-BSM observes
user activity that contradicts this policy, an alert is raised.
Members of the management staff are not allowed to mod-
ify ﬁles in the program or admin tools ﬁle groups, but have
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:09:26 UTC from IEEE Xplore.  Restrictions apply. 
UserGroups { RegStaff
(user1 user2)
Management (admin)
Accounting (acct)
}
FileGroups { Programs ( /bin /usr/bin /usr/local/bin /usr/local/ftp/bin )
Admtools ( /etc/bin /etc/sbin /usr/sbin /sbin )
CompanySecrets ( /secret )
Payroll ( /accounting/DBMS/payroll.db )
}
Policy {
RegStaff (
nread[CompanySecrets Payroll]
nwrite[CompanySecrets Programs Payroll Admtools]
nexec[Admtools] )
Management(
nread[]
nwrite[Programs Admtools]
nexec[] )
Accounting (
nwrite[Programs Admtools]
nread[CompanySecrets]
nexec[Admtools] )
}
Figure 1. Example surveillance policy.
unrestricted read and execute access over the entire system.
Members of the accounting staff are not allowed to mod-
ify ﬁles in the program or admin ﬁle groups, read company
secret ﬁles, or execute admin tools.
4. eXpert-BSM architecture and features
The preceding section discusses the threat coverage pro-
vided by the eXpert-BSM knowledge base. This section
provides an overview of the features and capabilities of
the eXpert-BSM distribution package, and its management
when deployed on multiple hosts in a network.
4.1. Preprocessing the Solaris BSM event stream
eXpert-BSM runs on Solaris 2.6, 7, and 8, in 32-bit and
64-bit operating modes. These versions of Solaris have an
auditing mechanism known as SunSHIELD Basic Security
Module [21], or BSM for short. BSM has its roots in the C2
compatibility package for SunOS 4.x, developed to comply
with the TCSEC [22] (Orange Book) requirements.
Before analyzing audit records, eXpert-BSM’s event pre-
processing service, ebsmgen, ﬁrst transforms the content of
each audit record into an internal message structure. These
messages include two important synthetic ﬁelds, called syn-
thetic parentCmd and synthetic parentIP. Although audit
records provide detailed information regarding each sys-
tem call, they do not identify the command (process im-
age name) under which the system call was invoked. The
synthetic parentCmd ﬁeld tracks this important attribute by
observing exec calls. Second, although Solaris audit records
are structured to include information regarding source IP in-
formation for transactions not performed from the console,
this information is unreliable across audit event types and
OS versions. By tracking the source IP information and al-
ways reporting it in synthetic parentIP, ebsmgen provides
consistently correct IP information for all audit records.
Each message is passed on from the preprocessor to the
event handling interface of the expert system, where it is as-
serted as a fact according to a fact type deﬁnition known as
a ptype in P-BEST [10]. Figure 2 shows the ptype deﬁnition
for audit records, as used in eXpert-BSM. Each ﬁeld in the
ptype corresponds to audit token data ﬁelds, except for the
two synthetic tokens explained above.
Developing tools for analysis of BSM data is not without
difﬁculty. The only tool provided with Solaris for audit data
interpretation is praudit, which prints audit data in a sim-
ple text form. Although Solaris has some library routines
for producing binary audit records, there are no routines
available for consumers of BSM data. There is no formal
grammar speciﬁed for BSM to help developers of consumer
tools, and an effort to specify such a grammar for the BSM
of Solaris 2.6 encountered some difﬁculties [6]. In Solaris 7
and 8, several new and initially undocumented audit token
types were introduced. These are related to the support of
64-bit mode and other new features such as IPv6.
The syntax of audit records and audit tokens is relatively
well speciﬁed in the documentation, but the semantics of
the content is not. This is especially true for audit records
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:09:26 UTC from IEEE Xplore.  Restrictions apply. 
string,
int,
int,
string,
int,
int,
string,
int,
int,
int,
int,
int,
ptype[bsm_event
human_time:
header_event_type: