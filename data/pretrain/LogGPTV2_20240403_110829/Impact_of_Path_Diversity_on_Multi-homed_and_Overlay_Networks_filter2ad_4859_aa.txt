# Impact of Path Diversity on Multi-homed and Overlay Networks

**Authors:**
Junghee Han and Farnam Jahanian  
University of Michigan - Dept. EECS  
1301 Beal Avenue, Ann Arbor, Michigan, 48109-2122, USA  
Email: {jungheeh, farnam}@eecs.umich.edu

## Abstract
Multi-homed and overlay networks are two widely studied approaches that leverage the inherent redundancy of the Internet's underlying routing infrastructure to enhance end-to-end application performance and availability. However, the effectiveness of these approaches depends on the natural diversity of redundant paths between two end hosts in terms of physical links, routing infrastructure, administrative control, and geographical distribution. This paper quantitatively analyzes the impact of path diversity on multi-homed and overlay networks and highlights several inherent limitations of these architectures in exploiting the full potential redundancy of the Internet. Our analysis is based on traceroute and routing table data collected from various vantage points, including looking glasses at ten major ISPs, RouteViews servers from twenty ISPs, and more than fifty PlanetLab nodes globally distributed across the Internet. Our study motivates new research directions for constructing topology-aware multi-homing and overlay networks to achieve better availability.

## 1. Introduction
The Internet has become a critical resource for businesses, making connectivity and network availability essential. In recent years, numerous studies have examined Internet routing protocols in terms of end-to-end behavior, convergence, and stability [17, 13, 12, 8]. These studies have found that, although the Internet's routing infrastructure is highly redundant, current routing protocols do not fully utilize this redundancy to achieve higher performance and availability. When an underlying routing protocol is slow to react and recover from a link or router failure, path failures are not transparently masked and are visible to end hosts. For example, several studies, including [17], observed that more than 20% of path failures are not recovered within 10 minutes. Such failures may be due to delayed BGP convergence and/or fundamental forwarding problems (e.g., forwarding loops). BGP's fault recovery mechanisms can take many minutes before routes converge to a consistent state [13, 12]. Additionally, current routing protocols lack the flexibility to detour around congested links. For instance, BGP cannot detect performance issues such as persistent congestion, which affects end-to-end performance. As long as a link is live, BGP will continue to forward packets over the congested path.

Multi-homed and overlay networks are two widely discussed approaches [18, 16, 19, 7, 9] that aim to leverage Internet redundancy to offer better performance and availability. Both approaches provide alternate paths by exploiting path redundancy between end hosts. Multi-homing refers to a single network having multiple connections to the Internet. A stub network with connections to multiple providers may exhibit better performance and reliability than one with a single connection. For example, if a customer is connected to both ISP1 and ISP2, and the ISP1-Customer link experiences congestion or failure, traffic can be routed through the ISP2-Customer link. Several commercial systems, including Radware [18], netVmg [16], and RouteScience [19], attempt to provide enhanced availability or performance by leveraging the concept of multi-homing. These solutions are deployed in front of a multi-homed site and manage the site's redundant connections to its upstream service providers.

Other research projects, such as RON [7] and Detour [9], leverage the topological redundancy of the Internet by constructing overlay networks to deliver better reliability and/or performance. An overlay network instantiates a virtual network on top of a physical network by deploying a set of overlay nodes above the existing IP routing infrastructure. These nodes cooperate to route packets on behalf of any pair of communicating nodes, forming an overlay network. If the underlying topology has physical path redundancy, it is possible to find alternative paths between overlay nodes when congestion or failure makes a primary path unavailable [20].

At first glance, systems based on multi-homed and overlay networks seem effective. It is widely believed that multi-homing and overlay networks can provide significant availability gains. However, their effectiveness depends on the assumption that paths available to packets traversing different ISPs (or overlay nodes) would enjoy a high degree of diversity and that the failure of each path should be independent of the failure of alternate paths.

In reality, Internet path failures are often correlated. Many factors contribute to the dependency of path failure. For example, the failure of paths that travel across the same administrative domain can be related. Geographical adjacency can also be a factor. A failure at a Network Access Point (NAP) can affect all paths going through the NAP. Most importantly, paths that share the same physical links and/or routers are very likely to experience failure simultaneously.

This paper quantitatively analyzes the impact of path diversity on multi-homed and overlay networks from several perspectives. It also highlights several inherent limitations of these architectures in fully exploiting the potential redundancy of the Internet [2, 21, 22]. Our analysis is based on traceroute and routing table data collected from various vantage points, including looking glasses at ten major ISPs, RouteViews servers [12, 5, 1] collecting routing data from twenty ISPs, and more than fifty PlanetLab nodes [4] distributed broadly across the Internet. The topological distribution of these collection points ensures that a broad range of upstream ISPs are represented in our study. The primary contributions of this study are as follows:

- **Significant Limitations of Multi-homing Architecture:**
  - We quantify the extent of path diversity in multi-homed networks. Our measurements reveal that a significant percentage of paths from a multi-homed site overlap. For example, when packets are injected from different ISPs to the same destination, the paths taken overlap at least once for 80% of 80,000 destination networks in our study.
  - We identify the sources of overlapping in multi-homed networks. First, a significant percentage of paths from multi-homed sites merge in the core of the Internet, consistent with prior research suggesting that the Internet core is formed by a mesh of tier-1 ISPs [2, 21]. Second, although a multi-homed stub network may choose its upstream providers, it cannot necessarily detour around shared infrastructures because it has little control beyond the next hop. These findings motivate the need to incorporate topology considerations in designing multi-homed architectures.
  - Carefully choosing a set of upstream ISPs cannot overcome the inherent limitations of multi-homing. Although increasing the number of ISPs from 2 to 3 improves availability, having more than 3 upstream ISPs provides marginal gains. Even subscribing to as many as 10 upstream ISPs still results in at least one bottleneck router among multiple paths for 50% of destinations.

- **Potential Limitations of Current Overlay Architectures:**
  - We quantify the extent of correlation between overlay links. Our study reveals that logically disjoint virtual links between overlay nodes, placed in different Autonomous Systems (ASes) with distinct administrative control, are very likely to share links and routers at the IP layer.
  - Most paths between overlay nodes and destinations also experience overlapping routers and links at the IP layer. In examining paths from overlay nodes placed inside various major ISPs to a set of over 80,000 destinations, we observe that even if overlay nodes are topologically diverse, paths from different overlay nodes to the same destination typically share one or more intermediate ASes in addition to sharing the destination AS.
  - Our results contradict the conventional wisdom that placing overlay nodes on different service provider networks would provide a high degree of diversity. We observe that even if overlay nodes are deployed in various ISPs, overlay routes constructed without considering the underlying topology may result in significant overlap, providing only limited availability gains.

The remainder of the paper is organized as follows. In the following section, we relate our study to prior works. Section 3 describes our measurement methodology and experimental results on path diversity in multi-homed sites. In Section 4, we show the impact of path diversity on overlay networks. Section 5 discusses how availability requirements conflict with performance goals. Finally, Section 6 presents concluding remarks.

## 2. Related Works
The redundancy of the Internet has been well-studied in several works, including [2, 21, 22, 11]. Many prior studies have examined AS-level connectivity and shown the prevalence of redundant connections at the AS level [2]. [21] discovered the hierarchical nature of AS-level connectivity and showed the presence of a small set of large ISPs in the core of the Internet. For more fine-grained analysis, [22] quantified the topological redundancy of the Internet by analyzing the number of disjoint paths at the router level inside an ISP and in the core of the Internet topology. The authors concluded that there is "potential for high-level redundancy" inside an ISP and across multiple ASes. Similar work for a regional ISP, MichNet, showed that there exist several redundant paths between pairs of hosts inside the ISP [11]. Both studies examined the topology to measure potential path diversity and suggested that the utilization of redundant static paths can be limited by the underlying routing protocols. Exploiting the high level of path diversity requires a special framework such as multi-homing and overlay architectures.

[15] presented preliminary results addressing path diversity in multi-homing but relied on simple metrics and a small dataset. More recently, [6] analyzed the performance and availability benefits of multi-homing and suggested that the choice of ISPs is a key factor. This work provided a better understanding of the benefits of multi-homing but focused more on performance than availability.

Our study of multi-homed networks extends these previous works by focusing on the availability of multi-homed networks and providing a more detailed analysis of the impact of path diversity from several perspectives. We base our analysis on a broader range of datasets, including BGP routing data and traceroute, to measure path diversity at various levels: path- and AS-levels. Furthermore, we reveal the inherent limitations of multi-homing and observe that even carefully choosing a set of upstream ISPs cannot overcome these limitations.

Additionally, we extend our study to examine the impact of path diversity on overlay networks. To the best of our knowledge, with the exception of [10], no other work has looked at the issue of dependency between overlay links. [10] shows that two overlay links are correlated if they show similar patterns of failure or congestion. However, this work does not study the topological relationship of the Internet to quantify the extent to which overlay links may share the underlying network infrastructure. In contrast, our study analyzes the underlying IP paths of overlay links in the Internet and provides a foundation for the topological evaluation of overlay networks such as RON [7] and Detour [9].

## 3. Multi-homed Networks
A multi-homed stub network with connections to more than one provider may exhibit better performance and reliability than one with a single connection. However, the effectiveness of this approach depends on the extent to which it provisions disjoint paths over the existing Internet topology. If traffic between two hosts is not routed along completely disjoint paths, congestion or failure of a single shared link or router can adversely affect the end-to-end performance or availability of all paths. In this section, we examine the effectiveness of multi-homing by measuring the diversity between traceroute paths through different upstream ISPs of multi-homed sites.

### 3.1 Measurement Methodology
An ideal experiment would involve choosing a multi-homed site connected to two or more ISPs and routing packets through different upstream ISPs. One challenge in implementing such a setup is that it requires a change to the current routing configuration, which is not always possible. An alternative is to emulate a multi-homed site. We rely on two distinct datasets, (D1) and (D2), to emulate multi-homed sites in our analysis.

**Dataset (D1):** To measure the path diversity of connections from multi-homed sites to a broad spectrum of destinations across the Internet, we create virtual multi-homed sites and send traceroutes from these sites to 80,000 destination networks. To emulate a multi-homed site, we select two stub networks that are geographically close to each other but connected to different upstream ISPs. We then merge these two stub networks into one virtual site. Consider the example in Figure 1(a). The virtual site, ANN ARBOR, consists of the University of Michigan and Arbor Networks. The University of Michigan is an educational institution connected to the Internet via MichNet, and Arbor Networks is a corporate network with connections to the Internet via Sprint. MichNet is a mid-sized regional ISP in Michigan and has transit/peering relationships with several other ISPs but does not directly peer with Sprint. Additionally, we emulate another multi-homed site, BERKELEY, consisting of Intel-Research at Berkeley and the University of California at Berkeley. Intel-Research at Berkeley and UC Berkeley are connected to AT&T and CalRen, respectively. CalRen and AT&T do not have a direct connection to each other. We run traceroutes to selected destination addresses from each of the two virtual multi-homed sites.

As a representative set of IP addresses on the Internet, we select a set of more than 80,000 destination addresses using BGP tables. To provide a richer view of different subnets that may be aggregated at various locations, we gather BGP routing tables from more than 20 topologically and geographically diverse points using IPMA RouteViews [12], the University of Oregon’s Route Views project [5], and the RIPE-NCC Routing Information Service project [1]. Border Gateway Protocol (BGP) is an inter-domain routing protocol used by peer routers in different ASes to exchange routing information to destination IP address blocks (or prefixes). From the collected BGP tables, we extract more than 162,000 destination prefixes. For each prefix, we randomly choose one IP address (e.g., 12.10.0.1 for 12.10.0.0/16 prefix) and send traceroutes from the source sites. In our analysis, we include all reachable destinations. We define a destination as "reachable" as long as the traceroute path ends with an address that belongs to the same AS as the destination IP address.

**Dataset (D2):** To evaluate the impact of the choice of upstream ISPs on path diversity, we collect another set of traceroute data from various ISPs. We take advantage of looking glasses offered by 10 ISPs: 6 major tier-1 ISPs and 4 smaller ISPs. Looking glasses are publicly accessible web sites provided by ISPs where customers can see performance and availability statistics using several utilities such as traceroute, ping, and BGP data. For example, each looking glass provides a tool for triggering traceroute from several different routers inside the ISP to arbitrary destinations. To emulate a multi-homed site, we select routers from different ISPs co-located in the same city (either at a NAP or a PoP). We then send traceroutes from each router to the top 100 Web sites. For example, we use 10 routers, each belonging to a different ISP in Chicago, and send traceroutes to the Web sites on the Internet, as shown in Figure 1(b). Since public traceroute servers provided by major ISPs typically impose a rate limit on requests issued from a host, it is difficult to probe a large number of destination addresses in a reasonable time period.

### 3.2 Analysis of Path Diversity from Multi-homed Sites
The experimental results shown in this section are based on the first dataset, (D1), collected from two emulated multi-homed sites, ANN ARBOR and BERKELEY, to over 80,000 destinations.

With dataset (D1), we measure path diversity using two distinct metrics: path-level and AS-level. Each metric reveals a different aspect of the Internet's path diversity. First, path-level measurement identifies the number of overlapping routers between paths through two different upstream ISPs. Second, AS-level measurement identifies the number of overlapping ASes between paths. Our results show that a significant percentage of paths from multi-homed sites overlap, indicating that the assumption of path diversity in multi-homed networks is often not met.

---

**Note:** The remaining sections (4, 5, and 6) of the paper would follow a similar structure, providing detailed analysis, discussion, and conclusions. The figures and references mentioned in the text should be included in the final document.