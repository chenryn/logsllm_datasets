Copyright©2019 nao_sec All Rights Reserved.
1
Copyright©2019 nao_sec All Rights Reserved.
Who are we
• Shota Nakajima
• Malware Analyst
• Engage in incident response
• Work at Cyber Defense Institute, Inc. in Japan
• Rintaro Koike
• Chief researcher / founder of nao_sec
• Threat Hunter
• Malicious traffic / script / document analyst
• Especially Drive-by Download attack
2
Copyright©2019 nao_sec All Rights Reserved.
Public Service for Hunting
• VirusTotal
• Private API
• Yara (Live & Retro Hunt)
• Hybrid Analysis
• Yara (Retro Hunt)
• ATT&CK Tactic & Technique
• ANY.RUN
• ATT&CK Technique
• Suricata SID
3
Copyright©2019 nao_sec All Rights Reserved.
VirusTotal Private API 
• Our queries
• maldoc(0  4D 5A (MZ)
47
Copyright©2019 nao_sec All Rights Reserved.
Macro
48
Copyright©2019 nao_sec All Rights Reserved.
Decoder DLL
• This Dll Only 1byte xor decode WMF
• WMF is shellcode
49
Copyright©2019 nao_sec All Rights Reserved.
Shellcode (Backdoor Launcher)
• DOS header in shellcode
• other part(header and code)
is encrypted
• OceanLotus often use this pattern
• Head is the call instruction
50
Copyright©2019 nao_sec All Rights Reserved.
Backdoor DLLs
• Backdoor DLL have encoded data 
in Resource
• Connect C2s
http[:]//ps.andreagahuvrauvin.com
http[:]//paste.christienollmache.xyz
http[:]//att.illagedrivestralia.xyz
51
Copyright©2019 nao_sec All Rights Reserved.
Backdoor DLLs
• Create key
• SOFTWARE¥Classes¥CLSID¥
{E3517E26-8E93-458D-A6DF
-8030BC80528B}
• Export
• CreateInstance function
52
Copyright©2019 nao_sec All Rights Reserved.
Relevance
• This DLL related Cylance report
• OceanLotus Steganography Malware Analysis White paper
• Same Registry and CLID
• Same Export function 
https://www.cylance.com/en-us/lp/threat-research-and-intelligence/oceanlotus-steganography-
malware-analysis-white-paper-2019.html
53
Copyright©2019 nao_sec All Rights Reserved.
Pattern 2
https://app.any.run/tasks/16a7605e-6e75-4b35-82d8-aa30cefd342d/
VBA
Shellcode
backdoor
54
Copyright©2019 nao_sec All Rights Reserved.
Macro
55
Copyright©2019 nao_sec All Rights Reserved.
Macro
56
Copyright©2019 nao_sec All Rights Reserved.
Relevance
• some points that match the code of cobalt strike.
57
Copyright©2019 nao_sec All Rights Reserved.
Shellcode
• DOS header in shellcode
• other part(header and code)
is encrypted
• same as pattern1
58
Copyright©2019 nao_sec All Rights Reserved.
Backdoor DLLs 