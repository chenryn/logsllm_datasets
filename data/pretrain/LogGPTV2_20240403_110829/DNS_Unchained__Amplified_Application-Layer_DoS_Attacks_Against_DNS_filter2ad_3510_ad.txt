Finally, also resolvers can more strictly limit the length of CNAME chains.
Section 4.2 has shown that the resolvers do not agree on the maximum chain
length. Limiting the length too strictly is harmful, as chains also exist for legiti-
mate reasons—such as Content Delivery Networks (CDNs) and DDoS protection
services. The domain owner can often conﬁgure their DNS to point to a subdo-
main of the CDN and the CDN uses itself one or multiple CNAME RRs.
Legitimate use-cases for CNAME chains must ensure the length is supported
by all DNS resolvers,
if they want to support all users. We inspected the
Active DNS [21] data set to identify benign chains. We extracted the CNAME
entries from 2017-10-05 to reconstruct the longest benign chains, which consists
of eight elements (seven CNAMEs and one ﬁnal RR). This ﬁts to the shortest
recursion limit of nine elements, which we observed for Unbound. Others [38]
report nine elements as the longest legitimate chain they found and certiﬁcate
authorities are also only required to support chains with nine elements while
fetching CAA RRs [13]. Based on those observations, a smaller recursion limit
can be advised. We recommend supporting nine elements in a chain, which is
the shortest value of all tested resolvers and covers benign chains. Such a recur-
sion depth limit would limit the ampliﬁcation of chaining attacks to factor ﬁve.
156
J. Bushart and C. Rossow
6 Related Work
Application-Layer DDoS in DNS: Several application-layer DDoS defenses
have been proposed in the past [12,30,39,52]. Many defenses are not immedi-
ately applicable to DNS. Protocol changes, such as client puzzles, would need
widespread support, which is unrealistic to achieve in a short to medium time
frame. Countermeasures which introduce more latency are especially problem-
atic, as DNS is tuned for high eﬃciency. Filtering techniques, such as egress or
ingress ﬁltering, do not apply to DNS Unchained, because it works without IP
address spooﬁng. Blocking DNS traﬃc can even lead to more inbound traﬃc [51]
and always risks blocking legitimate users.
The closest work to us is research on DNS water torture attacks. They were
ﬁrst presented in Feb 2014 [1] and are a known phenomenon for DNS operators
[17,48,50,51]. The DNS operator community focused on implementing mitiga-
tions, mainly to stabilize recursive resolver. Takeuchi et al. [47] propose a system
to detect DNS water torture attacks based on lexical and structural features of
domain names. They train a naive Bayes-classiﬁer and test it on captured traﬃc
of their universities network. Our attack is related to DNS water torture as both
are ﬂooding attacks using resolvers, but water torture faces several limitations—
including the fact that they can be easily detected.
Reﬂection and Ampliﬁcation Attacks: DNS also played a role in recent
ampliﬁcation attacks. The general risk of reﬂection attacks was identiﬁed by
Paxson [37] and its full ampliﬁcation potential presented by Rossow [44]. Dif-
ferent proposals to detect and defend ampliﬁcation attacks [23,36,44,49] were
made. They cover approaches to combat the bandwidth exhaustion, like client
puzzles, or prevent source address spooﬁng. In the context of DNS, K¨uhrer et
al. [24,25] analyzed the ampliﬁcation potential of DNS resolvers. They found
millions of open DNS resolver on embedded devices or routers, meaning the
openness of the resolver is likely a conﬁguration issue. DNSSEC’s potential to
increase the ampliﬁcation of DNS resolvers has also been documented [40]. While
some attacks in fact abuse DNS, still, in contrast to our work, they do not rep-
resent application-layer attacks and are easy to ﬁlter.
CNAME Chaining: The possibility to chain CNAME RRs is well-known and docu-
mented. For example, Shue and Kalafut [46] use diﬀerences in recursion strate-
gies to ﬁngerprint resolver implementations. Dagon et al. [8] use CNAME chains to
amplify the number of queries from each resolver. They need multiple queries by
the same resolver to analyze them for source port randomization of the resolver.
Pfeifer et al. [38] measures the overhead for resolvers while looking up CNAME
chains and recommend that ANSs should refuse CNAME chains before loading the
zone ﬁles. Furthermore, they recommend that ANSs should also query destina-
tions of CNAME RRs, similar to our recommendation in Sect. 5.1. In contrast to
prior work our attack focuses on the authoritative name servers instead of the
resolvers.
DNS Unchained: Ampliﬁed Application-Layer DoS Attacks
157
7 Conclusion
We have presented a new DDoS attack against DNS authoritatives that leverages
ampliﬁcation on the application layer. DNS Unchained achieves an ampliﬁca-
tion of 8.51 using standard DNS protocol features, by chaining alias records
(e.g., CNAME) and forcing resolvers to repeatedly query the same authoritative
name server. We performed full Internet scans and found 10 054 077 open DNS
resolvers and 178 508 recursive resolvers. We determined that 74.3% of those
resolvers support uncachable DNS responses, creating a large pool of ampliﬁers
that can be abused for chaining attacks.
We also discussed countermeasures to the new threat of DNS chaining
attacks. This includes measures applicable to DNS operators to ﬁnd and limit
problematic DNS zones as well as enforcing minimal Time-to-Live values allow-
ing caching. DNS resolvers can also be changed to have less aggressive re-
transmission on unavailable name servers and limit chains to nine elements.
A wide deployment of any of these techniques would severely degrade the per-
formance of the proposed attacks, and we hope that our work raises awareness
for the importance of these measures.
Acknowledgement. We thank our anonymous reviewers whose useful comments
helped us improving the quality of our paper. This work was supported by the German
Federal Ministry of Education and Research (BMBF) through funding for the BMBF
project 16KIS0656 (CAMRICS).
References
1. Andrew: Water torture: a slow drip DNS DDoS attack, February 2014. https://
secure64.com/water-torture-slow-drip-dns-ddos-attack/
2. Antonakakis, M., et al.: Understanding the Mirai Botnet. In: 26th USENIX Secu-
rity Symposium (2017)
3. Bellis, R.: Benchmarking DNS reliably on multi-core systems, July 2015. https://
www.isc.org/blogs/benchmarking-dns/
4. Censys DNS lookup full IPv4 (2017). https://censys.io/data/53-dns-lookup-full
ipv4
5. Crawford, M.: Non-terminal DNS name redirection. Technical report, RFC Editor
(1999). https://doi.org/10.17487/RFC2672
6. Crocker, D., Hansen, T., Kucherawy, M.S.: Domainkeys identiﬁed mail (DKIM) sig-
natures. Technical report, RFC Editor (2011). https://doi.org/10.17487/RFC6376
7. CVE-2008-1447. Available from MITRE, CVE-ID CVE-2008-1447, July 2008.
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1447
8. Dagon, D., Antonakakis, M., Day, K., Luo, X., Lee, C.P., Lee, W.: Recursive DNS
architectures and vulnerability implications. In: Proceedings of the Network and
Distributed System Security Symposium (2009)
9. DNSBL information - spam database and blacklist check. https://www.dnsbl.info/
10. Dukhovni, V., Hardaker, W.: The DNS-based authentication of named entities
(DANE) protocol: updates and operational guidance. Technical report, RFC Editor
(2015). https://doi.org/10.17487/RFC7671
158
J. Bushart and C. Rossow
11. Durumeric, Z., Wustrow, E., Halderman, J.A.: ZMap: fast internet-wide scanning
and its security applications. In: Proceedings of the 22th USENIX Security Sym-
posium (2013)
12. Gilad, Y., Herzberg, A., Sudkovitch, M., Goberman, M.: CDN-on-demand: an
aﬀordable DDoS defense via untrusted clouds. In: 23rd Annual Network and Dis-
tributed System Security Symposium (2016)
13. Hallam-Baker, P.: RFC Errata for RFC 6844 “DNS Certiﬁcation Authority Autho-
rization (CAA) Resource Record”. Errata 5065, RFC Editor (2017). https://www.
rfc-editor.org/errata/eid5065
14. Hilton, S.: Dyn analysis summary of friday october 21 attack. https://dyn.com/
blog/dyn-analysis-summary-of-friday-october-21-attack/
15. Hoﬀman, P.E., Schlyter, J.: The DNS-based authentication of named entities
(DANE) transport layer security (TLS) protocol: TLSA. Technical report, RFC
Editor (2012) https://doi.org/10.17487/RFC6698
16. Holz, T., Gorecki, C., Rieck, K., Freiling, F.C.: Measuring and detecting fast-ﬂux
service networks. In: Proceedings of the Network and Distributed System Security
Symposium, NDSS 2008 (2008)
17. Internet Systems Consortium: Pseudo Random DNS Query Attacks &
Resolver Mitigation Approaches (2015). https://www.nanog.org/sites/default/
ﬁles/nanog63-dnstrack-winstead-attacks.pdf
18. Kaminsky, D.: It’s the end of the cache as we know it. Presented at Black Ops
(2008)
19. Kitterman, S.: Sender policy framework (SPF) for authorizing use of domains in
email, version 1. Technical report, RFC Editor (2014). https://doi.org/10.17487/
RFC7208
20. Knot DNS benchmark (2017). https://www.knot-dns.cz/benchmark/
21. Kountouras, A., et al.: Enabling network security through active DNS datasets.
In: Monrose, F., Dacier, M., Blanc, G., Garcia-Alfaro, J. (eds.) RAID 2016. LNCS,
vol. 9854, pp. 188–208. Springer, Cham (2016). https://doi.org/10.1007/978-3-319-
45719-2 9
22. Kr¨amer, L., et al.: AmpPot: monitoring and defending against ampliﬁcation DDoS
attacks. In: Bos, H., Monrose, F., Blanc, G. (eds.) RAID 2015. LNCS, vol. 9404, pp.
615–636. Springer, Cham (2015). https://doi.org/10.1007/978-3-319-26362-5 28
23. Kreibich, C., Warﬁeld, A., Crowcroft, J., Hand, S., Pratt, I.: Using packet symme-
try to curtail malicious traﬃc. In: Proceedings of the 4th Workshop on Hot Topics
in Networks (Hotnets-VI), College Park, MD, USA (2005)
24. K¨uhrer, M., Hupperich, T., Bushart, J., Rossow, C., Holz, T.: Going wild: large-
scale classiﬁcation of open DNS resolvers. In: Proceedings of the 2015 ACM Internet
Measurement Conference (2015). https://doi.org/10.1145/2815675.2815683
25. K¨uhrer, M., Hupperich, T., Rossow, C., Holz, T.: Exit from hell? Reducing the
impact of ampliﬁcation DDoS attacks. In: Proceedings of the 23rd USENIX Secu-
rity Symposium (2014)
26. Lawrence, D., Kumari, W.: Serving stale data to improve DNS resiliency. Internet-
Draft draft-ietf-dnsop-serve-stale-00, IETF Secretariat (2017). http://www.ietf.
org/internet-drafts/draft-ietf-dnsop-serve-stale-00.txt
27. Lawrence, T.: Akamai’s DNS contribution to internet resilience. https://blogs.
akamai.com/2017/09/akamais-dns-contribution-to-internet-resiliency.html
28. Liu, Y., Wang, H.: The Elknot DDoS botnets we watched. Presented
at VB2016 Denver. https://www.virusbulletin.com/conference/vb2016/abstracts/
elknot-ddos-botnets-we-watched
DNS Unchained: Ampliﬁed Application-Layer DoS Attacks
159
29. McNally, M.: BIND 9.12.0 release notes. https://kb.isc.org/article/AA-01554/0/
BIND-9.12.0-Release-Notes.html
30. Mirkovic, J., Reiher, P.L.: A taxonomy of DDoS attack and DDoS defense mecha-
nisms. Comput. Commun. Rev. 34, 39–53 (2004). https://doi.org/10.1145/997150.
997156
31. Mockapetris, P.V.: Domain names - concepts and facilities. Technical report, RFC
Editor (1987). https://doi.org/10.17487/RFC1034
32. Mockapetris, P.V.: Domain names - implementation and speciﬁcation. Technical
report, RFC Editor (1987). https://doi.org/10.17487/RFC1035
33. M¨uller, M., Moura, G.C.M., de Oliveira Schmidt, R., Heidemann, J.S.: Recur-
sives in the wild: engineering authoritative DNS servers. In: Proceedings of the
2017 Internet Measurement Conference (2017). https://doi.org/10.1145/3131365.
3131366
34. Nominum: Vantio cacheserve 7, June 2015. https://nominum.com/wp-content/
uploads/2015/06/Vantio-CacheServe7-DataSheet.pdf
35. OpenDNS SmartCache. https://www.opendns.com/opendns-smartcache/
36. Ferguson, P., Senie, D.: BCP 38 on network ingress ﬁltering: defeating denial of
service attacks which employ IP source address spooﬁng, May 2000. http://tools.
ietf.org/html/bcp38
37. Paxson, V.: An analysis of using reﬂectors for distributed denial-of-service attacks.
Comput. Commun. Rev. 31, 38–47 (2001). https://doi.org/10.1145/505659.505664
38. Pfeifer, G., Martin, A., Fetzer, C.: Reducible complexity in DNS. In: IADIS Inter-
national Conference WWW/Internet 2008 (ICWI 2008) (2008)
39. Ranjan, S., Swaminathan, R., Uysal, M., Nucci, A., Knightly, E.W.: DDoS-shield:
DDoS-resilient scheduling to counter application layer attacks. IEEE/ACM Trans.
Netw. 17, 26–39 (2009). https://doi.org/10.1145/1514070.1514073
40. van Rijswijk-Deij, R., Sperotto, A., Pras, A.: DNSSEC and its potential for DDoS
attacks: a comprehensive measurement study. In: Proceedings of the 2014 Internet
Measurement Conference (2014). https://doi.org/10.1145/2663716.2663731
41. Risk, V.: Resolver DDoS mitigation. https://www.isc.org/blogs/tldr-resolver-
ddos-mitigation/
42. Risk, V.: BIND9 performance history, August 2017. https://www.isc.org/blogs/
bind9-performance-history/
43. Rose, S., Wijngaards, W.C.A.: DNAME redirection in the DNS. Technical report,
RFC Editor (2012). https://doi.org/10.17487/RFC6672
44. Rossow, C.: Ampliﬁcation hell: revisiting network protocols for DDoS abuse. In:
21st Annual Network and Distributed System Security Symposium (2014)
45. Shadowserver Foundation: DNSScan Shadowserver Foundation, January 2018.
https://dnsscan.shadowserver.org/stats/
46. Shue, C.A., Kalafut, A.J.: Resolvers revealed: characterizing DNS resolvers and
their clients. ACM Trans. Internet Technol. 12, 14 (2013). https://doi.org/10.1145/
2499926.2499928
47. Takeuchi, Y., Yoshida, T., Kobayashi, R., Kato, M., Kishimoto, H.: Detection of
the DNS water torture attack by analyzing features of the subdomain name. JIP
24, 793–801 (2016). https://doi.org/10.2197/ipsjjip.24.793
48. Van Nice, B.: Drilling down into DNS DDoS (2015). https://www.nanog.org/sites/
default/ﬁles/nanog63-dnstrack-vannice-ddos.pdf
49. Wang, X., Reiter, M.K.: Mitigating bandwidth-exhaustion attacks using congestion
puzzles. In: Proceedings of the 11th ACM Conference on Computer and Commu-
nications Security (2004). https://doi.org/10.1145/1030083.1030118
160
J. Bushart and C. Rossow
50. Weber, R.: Drilling down into DNS DDoS data (2015). https://indico.dns-oarc.
net/event/21/contribution/29/material/slides/0.pdf
51. Weinberg, M., Barber, P.: Everyday attacks against Verisign-operated DNS infras-
tructure (2015). https://indico.dns-oarc.net/event/21/contribution/24
52. Xie, Y., Yu, S.: A novel model for detecting application layer DDoS attacks.
In: Interdisciplinary and Multidisciplinary Research in Computer Science (2006).
https://doi.org/10.1109/IMSCCS.2006.159
53. Yu, Y., Wessels, D., Larson, M., Zhang, L.: Authority server selection in DNS
caching resolvers. Comput. Commun. Rev. 42, 80–86 (2012). https://doi.org/10.
1145/2185376.2185387
Open Access This chapter is licensed under the terms of the Creative Commons
Attribution 4.0 International License (http://creativecommons.org/licenses/by/4.0/),
which permits use, sharing, adaptation, distribution and reproduction in any medium
or format, as long as you give appropriate credit to the original author(s) and the
source, provide a link to the Creative Commons license and indicate if changes were
made.
The images or other third party material in this chapter are included in the chapter’s
Creative Commons license, unless indicated otherwise in a credit line to the material. If
material is not included in the chapter’s Creative Commons license and your intended
use is not permitted by statutory regulation or exceeds the permitted use, you will
need to obtain permission directly from the copyright holder.