© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Real-time Steganography
Real-time Steganography
with RTP
with RTP
I)ruid
I)ruid
http://druid.caughq.org
http://druid.caughq.org
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Who am I?
Who am I?
Founder, Computer Academic Underground (CAU)
Founder, Computer Academic Underground (CAU)
Co-Founder, Austin Hackers Association (AHA!)
Co-Founder, Austin Hackers Association (AHA!)
Employed by TippingPoint DVLabs performing VoIP security 
Employed by TippingPoint DVLabs performing VoIP security 
research
research
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Overview
Overview
VoIP, RTP, and Audio Steganography
VoIP, RTP, and Audio Steganography
Previous Research
Previous Research
Real-Time Steganography
Real-Time Steganography
Using steganography with RTP
Using steganography with RTP
Problems and Challenges
Problems and Challenges
SteganRTP
SteganRTP
About, Goals, Etc.
About, Goals, Etc.
Architecture, Operational Flow
Architecture, Operational Flow
Message Structures
Message Structures
Functional Subsystems
Functional Subsystems
Challenges Met
Challenges Met
Live Demo
Live Demo
Conclusions, Future Work
Conclusions, Future Work
Q&A
Q&A
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
VoIP? RTP?
VoIP? RTP?
Voice over IP
Voice over IP
Internet Telephony
Internet Telephony
Real-time Transport Protocol
Real-time Transport Protocol
Used by most VoIP systems to transmit call audio data
Used by most VoIP systems to transmit call audio data
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Audio Steganography
Audio Steganography
In 6 slides or less...
In 6 slides or less...
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Steganography?
Steganography?
Steganos (covered) graphein  (writing)
Steganos (covered) graphein  (writing)
Hiding a secret message within a cover-
Hiding a secret message within a cover-
medium in such a way that others can not 
medium in such a way that others can not 
discern the presence of the hidden 
discern the presence of the hidden 
message
message
Hiding one piece of data within another
Hiding one piece of data within another
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Steganography Terms
Steganography Terms
Message
Message – The data to be hidden or extracted
 – The data to be hidden or extracted
Cover-Medium
Cover-Medium – The medium in which information 
 – The medium in which information 
is to be
is to be hidden.  Also sometimes called “cover-
 hidden.  Also sometimes called “cover-
image/data/etc.”
image/data/etc.”
Stego-Medium
Stego-Medium – A medium within which 
 – A medium within which 
information 
information isis hidden
 hidden
Redundant Bits
Redundant Bits – Bits of data in a cover-medium 
 – Bits of data in a cover-medium 
that can be modified without compromising that 
that can be modified without compromising that 
medium’s perceptible integrity
medium’s perceptible integrity
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Types of Covert Channels
Types of Covert Channels
Storage-based
Storage-based
Persistent
Persistent
Embedding message data into a static cover-medium
Embedding message data into a static cover-medium
Extracting message data from a static stego-medium
Extracting message data from a static stego-medium
Timing-based
Timing-based
Transient
Transient
Signals message data by modulating behavior
Signals message data by modulating behavior
Extracts message data by observing effects of 
Extracts message data by observing effects of 
modulation
modulation
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Digitally Embedding
Digitally Embedding
Digitally embedding a message in a cover-
Digitally embedding a message in a cover-
medium usually involves two steps:
medium usually involves two steps:
Identify the redundant bits of a cover-medium
Identify the redundant bits of a cover-medium
Deciding which redundant bits to use and then 
Deciding which redundant bits to use and then 
modifying them
modifying them
Generally, redundant bits are likely to be 
Generally, redundant bits are likely to be 
the least-significant bit(s) of each data 
the least-significant bit(s) of each data 
word value of the cover-medium
word value of the cover-medium
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Digitally Embedding in Audio
Digitally Embedding in Audio
Audio is a very inaccurate type of data
Audio is a very inaccurate type of data
Slight changes will be indistinguishable 
Slight changes will be indistinguishable 
from the original to the human ear
from the original to the human ear
In Audio, you can use the least-significant 
In Audio, you can use the least-significant 
bits of each word value as redundant bits
bits of each word value as redundant bits
Use the redundant bits to minimize the 
Use the redundant bits to minimize the 
impact of changes
impact of changes
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Example: 8-bit Audio Embedding
Example: 8-bit Audio Embedding
Let’s assume an 8-bit cover-audio file has the 
Let’s assume an 8-bit cover-audio file has the 
following 8 bytes of data in it:
following 8 bytes of data in it:
0xb4, 0xe5, 0x8b, 0xac, 0xd1, 0x97, 0x15, 0x68
0xb4, 0xe5, 0x8b, 0xac, 0xd1, 0x97, 0x15, 0x68
In binary:
In binary:
1011010
101101000-1110010
-111001011-1000101
-100010111-1010110
-101011000
1101000
110100011-1001011
-100101111-0001010
-000101011-0110100
-011010000
We wanted to hide the byte value ‘214’ (11010110), 
We wanted to hide the byte value ‘214’ (11010110), 
we replace the least significant bit from each byte 
we replace the least significant bit from each byte 
to hide our message byte:
to hide our message byte:
1011010
101101011-1110010
-111001011-1000101
-10001010-
0-1010110
101011011
1101000
110100000-1001011
-100101111-0001010
-000101011-0110100
-011010000
The modifications result in the following:
The modifications result in the following:
Original:
Original:
0xb4, 0xe5, 0x8b, 0xac, 0xd1, 0x97, 0x15, 0x68
0xb4, 0xe5, 0x8b, 0xac, 0xd1, 0x97, 0x15, 0x68
Modified:
Modified:
0xb5, 0xe5, 0x8a, 0xad, 0xd0, 0x97, 0x15, 0x68
0xb5, 0xe5, 0x8a, 0xad, 0xd0, 0x97, 0x15, 0x68
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Previous Research
Previous Research
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Audio Steganography
Audio Steganography
Data Stash: MP3 files
Data Stash: MP3 files
http://www.skyjuicesoftware.com/software/ds_info.html
http://www.skyjuicesoftware.com/software/ds_info.html
Hide4PGP: WAV and VOC files
Hide4PGP: WAV and VOC files
http://www.heinz-repp.onlinehome.de/Hide4PGP.htm
http://www.heinz-repp.onlinehome.de/Hide4PGP.htm
InvisibleSecrets: WAV files
InvisibleSecrets: WAV files
http://www.invisiblesecrets.com/
http://www.invisiblesecrets.com/
MP3Stego: MP3 files
MP3Stego: MP3 files
http://www.petitcolas.net/fabien/steganography/mp3stego/
http://www.petitcolas.net/fabien/steganography/mp3stego/
ScramDisk: WAV files
ScramDisk: WAV files
http://www.scramdisk.clara.net/
http://www.scramdisk.clara.net/
S-Tools 4: Embedding into a WAV file
S-Tools 4: Embedding into a WAV file
ftp://ftp.funet.fi/pub/crypt/mirrors/idea.sec.dsi.unimi.it/code/s-tools4.zip 
ftp://ftp.funet.fi/pub/crypt/mirrors/idea.sec.dsi.unimi.it/code/s-tools4.zip 
Steganos: WAV and VOC files
Steganos: WAV and VOC files
ftp://ftp.hacktic.nl/pub/crypto/steganographic/steganos3r5.zip
ftp://ftp.hacktic.nl/pub/crypto/steganographic/steganos3r5.zip
StegHide: WAV and AU files
StegHide: WAV and AU files
http://steghide.sourceforge.net/
http://steghide.sourceforge.net/
StegMark: MIDI, WAV, AVI, MPEG
StegMark: MIDI, WAV, AVI, MPEG
http://www.datamark.com.sg/onlinedemo/stegmark/
http://www.datamark.com.sg/onlinedemo/stegmark/
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
VoIP Steganography
VoIP Steganography
A few previous research efforts
A few previous research efforts
Uses of “steganography”:
Uses of “steganography”:
Using redundant bits to widen RTP audio band
Using redundant bits to widen RTP audio band
Using redundant bits for error correction
Using redundant bits for error correction
Replacing RTCP
Replacing RTCP
Watermarking audio for integrity checking
Watermarking audio for integrity checking
Deficiencies:
Deficiencies:
Some are just “theory” papers, don’t explain how they intend to 
Some are just “theory” papers, don’t explain how they intend to 
accomplish certain tasks
accomplish certain tasks
Don’t achieve the primary goal of steganography:
Don’t achieve the primary goal of steganography:
Use of steganographic techniques easily identifiable by an observer
Use of steganographic techniques easily identifiable by an observer
Message data is trivially recognized and extracted from stego-medium
Message data is trivially recognized and extracted from stego-medium
Only one public PoC; no full implementations
Only one public PoC; no full implementations
Analysis paper forthcoming
Analysis paper forthcoming
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Real-time Steganography
Real-time Steganography
Or, utilizing steganographic
Or, utilizing steganographic
techniques with an active network
techniques with an active network
communications channel
communications channel
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Context Terminology
Context Terminology
Packet
Packet - A network data packet
 - A network data packet
Message
Message - Data being embedded or 
 - Data being embedded or 
extracted via steganographic techniques
extracted via steganographic techniques
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
““Real-time” Steganography?
Real-time” Steganography?
Separate “hide” and “retrieve” modes are 
Separate “hide” and “retrieve” modes are 
common in storage-based steganography 
common in storage-based steganography 
implementations
implementations
Common cover-mediums are static or 
Common cover-mediums are static or 
unidirectional
unidirectional
What about Vo
What about Vo22IP?
IP?
Utilizing steganography with RTP provides 
Utilizing steganography with RTP provides 
the opportunity to establish an active, or 
the opportunity to establish an active, or 
“real-time” covert communications channel
“real-time” covert communications channel
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
RTP’s Redundant Bits
RTP’s Redundant Bits
RTP packet payloads are encoded multimedia
RTP packet payloads are encoded multimedia
I’ll be focusing on RTP audio
I’ll be focusing on RTP audio
RTP supports many different audio Codecs
RTP supports many different audio Codecs
RTP’s redundant bits are determined by the codec 
RTP’s redundant bits are determined by the codec 
used
used
8-bit sample size Codecs are generally resilient to 
8-bit sample size Codecs are generally resilient to 
changes of the LSB for each sample
changes of the LSB for each sample
Larger sample size Codecs may provide for one or 
Larger sample size Codecs may provide for one or 
more LSBs to be modified per sample
more LSBs to be modified per sample
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Audio Codec Word Sizes
Audio Codec Word Sizes
G.711 alaw: 8-bit word size
G.711 alaw: 8-bit word size
G.711 ulaw: 8-bit word size
G.711 ulaw: 8-bit word size
Speex: dynamic, variable word size
Speex: dynamic, variable word size
iLBC: class-based bit distribution
iLBC: class-based bit distribution
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Throughput
Throughput
G.711 (ulaw/alaw):
G.711 (ulaw/alaw):
160 byte RTP payload
160 byte RTP payload
8-bit sample word size
8-bit sample word size
Utilizing 1 bit per sample word
Utilizing 1 bit per sample word
8 words needed per byte of message data
8 words needed per byte of message data
~50 packets/sec unidirectional
~50 packets/sec unidirectional
(160/8)*50 == 1,000 bytes/sec
(160/8)*50 == 1,000 bytes/sec
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Problems and Challenges
Problems and Challenges
Trying to use steganography
Trying to use steganography
with RTP
with RTP
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Unreliable Transport
Unreliable Transport
Problems:
Problems:
RTP uses UDP as it’s transport protocol
RTP uses UDP as it’s transport protocol
UDP is connectionless and unreliable
UDP is connectionless and unreliable
Challenges:
Challenges:
Data split across multiple packets may arrive out of 
Data split across multiple packets may arrive out of 
order
order
One or more parts of data split across multiple packets 
One or more parts of data split across multiple packets 
may not arrive at all
may not arrive at all
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Cover-Medium Size Limitations
Cover-Medium Size Limitations
Problems:
Problems:
Individual RTP packets don’t provide much space for 
Individual RTP packets don’t provide much space for 
embedding message data
embedding message data
Different audio Codecs use different audio word sizes
Different audio Codecs use different audio word sizes
Challenges:
Challenges:
Large message data will likely be split across multiple 
Large message data will likely be split across multiple 
packets and will need to be reassembled
packets and will need to be reassembled
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
Latency
Latency
Problems:
Problems:
RTP is extremely sensitive to network latency and other 
RTP is extremely sensitive to network latency and other 
QoS issues
QoS issues
Challenges:
Challenges:
Overall system must not interfere too much with RTP 
Overall system must not interfere too much with RTP 
packet routing
packet routing
Use of steganography cannot delay any individual RTP 
Use of steganography cannot delay any individual RTP 
packet for too long
packet for too long
© 2007 Computer Academic Underground
© 2007 Computer Academic Underground
RTP Streams
RTP Streams
Problems:
Problems:
RTP employs two separate half-duplex packet streams 
RTP employs two separate half-duplex packet streams 
to achieve full-duplex communication
to achieve full-duplex communication