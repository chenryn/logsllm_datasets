When we look at the life cycle of a malware infection as for example
a botnet, after the initial exploitation the compromised device re-
mains in contact with the perpetrator or a C&C server to download
additional components or receive a new configuration. While we
would expect a similar behavior for malware targeting routers, we
saw little evidence for post-compromise maintenance operations.
Figure 14: Additions/deletions over time per siteKey.
Figure 15: CDF of the infection duration per IP address.
Figure 16: New and total of IP addresses infected per day.
This is best observed when we look at the siteKeys in Figure 13
that remain relatively constant over time. Four of these siteKeys are
depicted in Figure 14 with respect to daily additions and removals
from the pool, indicated in blue and red respectively, starting from
the day the siteKey first became active. This behavior, as well as
the sets of siteKeys that appear together, might indicate a strategy
to offset risk. If a particular siteKey gets blocked by a mining ser-
vice, others will still generate profits. The same might hold for the
deployment size in general, where an all-out operation from becom-
ing too greedy could lead to increased press coverage and faster
cleanup of the vulnerability than maintaining a smaller infection
size and thus lower profile. This diversification however stops from
December 2018 onwards, where we see that most actors no longer
replenish routers lost. This might be explained by Monero’s signifi-
cant drop in value, which decreased by 60% from early November
until a month later.
A sudden drop in mining activity. Indeed, we observe a steady decline
of new devices that are added to the pool from November 2018
onwards, as shown in the bottom of Figure 16, which leads to a
010203040506007008009001000a2007e0204060805205405605800oLauz020406080100225250275300yBIGn50204060801001201026×101102tcS100101102Days infected0.000.250.500.751.00Fraction of routers2018-07-012018-09-012018-11-032019-01-052019-03-09Date050000100000150000New IPs infected0200000400000Total IPs infected6 DISCUSSION
The analysis of the tactics, technique and procedures of the ac-
tors demonstrated different levels of sophistication. This section
translates flow volume into a revenue estimation per campaign and
finally we review the previous findings, and use them to describe the
ecosystem of cryptojackers and their differences of sophistication.
6.1 Quantification of Revenue
The results from the previous sections already suggested that MITM-
based cryptomining operates at an entirely different scale than
previously reported attack vectors. This is due to three reasons:
(1) The volume of compromised entities is much higher. Instead
of a few thousand websites [5, 15, 30, 31], here a total of 1.4M
infected routers is involved. Instead of mining on the web
browsers of the users who visit one of the select infected web-
sites, the MITM attack vector through routers would greatly
amplify earnings, as cryptomining is introduced into any
web page visited by any user connected behind an infected
router.
(2) MikroTik uses the vulnerable RouterOS on consumer grade
and carrier-grade devices. A carrier-grade router will likely
serve significant user populations, and thus within a short
time amass large volumes of revenue.
(3) While 30% of all website-based cryptomining is removed
within 15 days [15], we find that 30% of the MITM-based
mining remains active for more than 50 days. Although also
routers are often patched quickly, the pool of vulnerable
devices is so large that it barely affects the installation base.
In this section we will extend the previous results towards a quantifi-
cation of adversarial revenue per key using this new attack vector.
Unfortunately, as we have shown in Section 5.4.3, most mining
is deployed through a cryptojacking service, such as Coinhive or
Omine. This prevents us from performing a similar analysis as
Huang et al. [16] did, who queried the (Bitcoin) mining pools di-
rectly to estimate the profits of a campaign. In our analysis, only 3
of the 140 discovered siteKeys were mining directly in a mining pool.
However, we can leverage our datasets and using to the method
established by Konoth et al. [18] we will conduct a quantification
for a direct comparison with website-based mining, but make some
adjustments for the shifted attack vector. For their analysis, Konoth
et al. built a three-step estimation model:
• Estimation of monthly visitors and visit duration: They esti-
mate visitor count and the average time spent for the 1,705
sites they detected to be cryptojacking based on visitor sta-
tistics from SimilarWeb [36].
• Average computing power of visitors in hash rate per second:
Cryptocurrency is mined during the visit on the website.
They measure the hash rate of two desktop CPUs and 16
mobile devices, and determined an average rate of 40.5 and
14.56 per second, respectively. Afterwards, information on
MineCryptoNight [21] is used to convert that to X MR/s.
• Current value of cryptocurrency: The overall mining power
of the visitors is then mapped to and monetized in Monero
cryptocurrency, which was valued at $253/X MR at that time.
Based on this value, the top 10 grossing actors generated an
overall revenue of some $41,000 per month.
Figure 17: Relation between the number of flows to port 80
and the number of keys per router.
5.5.1 Configuration Access and Periodic Updates. As a siteKey is di-
rectly linked to a particular actor, we analyzed whether any connec-
tions were made between an end point and the group of routers that
were at a certain moment compromised by the same key. Using the
association rules methodology described by Agrawal & Srikant [1],
we have searched for maintenance patterns where specific keys
have a large probability to coincide with a specific anonymized IP
address or port number, as maintenance would likely be performed
from a set of C&C servers or the attacker’s PC. As connections
to port 22 (SSH) and 23 (Telnet) in NetFlows are also caused by
prevalent port scanning, we differentiate between port scanning
and active SSH sessions in NetFlows based on the packet size and
only include connections with a confidence c and support s of at
least 40% among our router/key set, in other words we require that
at least 40% of infected routers had been contacted by a common
origin, while being significantly present in the data.
We have observed maintenance connections on port 22 (SSH),
which was only pursued by the actor(s) responsible for routers
infected with one of three keys oDcuak, SK_LCx and hsFAjj, while
other strains and actors do not seem to deploy such coordinated
access. Surprisingly, routers with any of these keys were in contact
with the same remote host at a given moment in time, strongly
suggesting that the keys were actually related to the same persona.
In addition, when a new IP address appeared to make contact with
the compromised devices, routers with all three keys were always
contacted by the same source. For example, routers with these keys
made SSH connections to 236.197.108.8 between 3 and 20 August
2018, while between 11 and 14 August 2018 these routers were
contacted by 236.247.130.64. Each of these IPs seemed to employ
automation, contacting routers either at midnight or during the
timeframe 16–19h. Besides these IPs, almost no evidence of scripted
interactions between a controlling source and the infected routers
has been found, which would be evident from a large number of
connections being made at the same time, or sequentially within a
short time period. In total we observed 5 IPs making such common
connections over time, matching our earlier observation about
the link between the aforementioned three keys as discussed in
Section 5.4.2.
1234567891011121314151617Number of different keys100101102103104105106Number of flows on port 80IraqHungaryOtherIndonesiaBrazilTurkeyTable 5: Revenue estimation parameters
Parameter
Number of visitors
Average hashing rate
Monero market value
Time on website
Methodology in [18]
SimilarWeb estimations
SimilarWeb estimations
$ 253 as of May ‘18
SimilarWeb estimations
This study
# of NetFlows on port 80
desktop / mobile: 25 H /s
$253 for equal comparison
Average, 1st / 3rd quartile
In the following analysis, we are following the same equation:
traffic [# flows] × avg. time [s] × mining rate [XMR/s]
× value [$/XMR] = profit [$]
but adjust them for the specific attack vector observed. First, our
NetFlow traces allow for an extrapolation of the actual number of
HTTP connections on port 80, and we attribute the count of flows
to the revenues of a siteKey installed on the proxy page at that
time. While the embedded miners also work for iframed-HTTPS
connections, we did not find evidence that this attack was pursued
in the wild. This will thus be a lower bound on the amount of traffic.
Second, Konoth et al. estimated average visiting times for each
of their 1,705 detected websites using SimilarWeb data, but the
MITM attack works across all pages of the Internet. As the actual
end point of the outgoing connection has been anonymized for
privacy, we can approximate the average visiting time as we query
the average visiting duration of websites listed in the Alexa Top 10k
– the 10,000 most popular websites – on SimilarWeb. The average
visiting time for these websites is 293 seconds. We will for our
calculation work with three values for visit duration to provide
a range of the revenues made by the attackers. We will use the
average visiting time, as well as the first and third quartile of visit
durations. Yet, already the highly conservative estimation based on
the first quartile highlights the magnitude of this new attack vector.
Table 5 compares the parameters used in [18] to our study.
Third, Konoth et al. also used SimilarWeb data to estimate the
hashing rate for both mobile and desktop visitors, being 14.56
and 40.5 respectively. We estimated the hashing rate based on the
desktop/mobile device ratio found across the Internet as a whole,
which is listed in [11] as 0.58, resulting in a weighted hash rate
of 25 H /s. Since we want to compare the profitability of MITM-
based to website-based cryptojacking, we could either compare the
amount of Monero mined, or translate the Monero amount into
more intuitive currency such as USD. Currency exchange rates are
however volatile and in between Konoth’s May 2018 study and
our study, the average Monero price had dropped during August
and December 2018 to $92.2/XMR. To compare both attack vectors
side by side, we thus use the same exchange rate as in [18], which
still makes a fair comparison, as the decline woud have equally
scaled down the revenues attackers could have generated using
website-based mining during our observation period. Even if we
scale the revenue down with the declined value of Monero, the
MITM-based revenues would still be a factor of 10 higher than the
website-based earnings made half a year earlier.
Based on the parameters chosen above, Table 6 shows the es-
timated monthly revenues for the top 10 grossing actors for the
average visit duration on the Alexa 10K, as well as the first and
third quartile. As we can see, in the average case the top 10 cam-
paigns total a profit exceeding $1,200,000 per month, in which the
Table 6: Estimated monthly revenue of top 10 grossing actors
based on the average visit duration on the Alexa Top 10K, as
well as the first and third quartile according to SimilarWeb.
SiteKey
48zUYB
6a9929
8C7UoT
BOvlp3
4983e3
FgWWtJ
J3rjnv
hsFAjj
BT9k5D
wjORhf
Total top 10
Total #
routers
52,181
30,135
47,981
49,640
117,502
39,384
45,934
223,844
8,459
42,342
First quartile
2’27" stay
$111,447.18
$97,626.82
$90,532.54
$82,573.82
$70,017.28
$50,719.01
$40,551.39
$35,396.11
$31,494.11
$27,671.96
$638,030.22
Median stay
4’53” stay
$222,136.22
$194,589.52
$180,449.21
$164,585.92
$139,558.26
$101,092.99
$80,826.92
$70,551.44
$62,773.97
$55,155.67
$1,271,720.11
Third quartile
6’19" stay
$287,336.61
$251,704.53
$233,413.82
$212,894.42
$180,520.75
$130,765.33
$104,550.86
$91,259.37
$81,199.10
$71,344.70
$1,644,989.49
highest grossing siteKey earns $222K. To put this into perspective,
the 10 most successful campaigns that are deploying cryptojacking
by installing miners on the websites themselves (for example by
hacking the site) were reported by [18] to yield monthly revenues
of some $41,000. Cryptojacking through a MITM attack on routers
is thus a factor of 30 more lucrative than previously observed attack
vectors, and the most successful MITM actor earns 5x more revenue
than the top 10 website-based cryptojackers combined.
In our analysis above, we have seen the different roles the actors
have played in the development and rollout of this attack vector