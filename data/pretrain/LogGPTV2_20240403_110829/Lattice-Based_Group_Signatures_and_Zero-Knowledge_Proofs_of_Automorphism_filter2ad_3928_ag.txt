(cid:20)y1
1 := ρ( q1
q2
× Rn+l
(cid:16) q1
and y(cid:48)
and sets:
1 := ρ
(cid:17)
(cid:21)
B1
q2
(cid:21)
and
B2
y2
q2
q2
q1
(cid:113) q2
q1
Zq2)
(cid:17)
(cid:16)U( q1
(cid:20) In R
(cid:21)
q2
0l×n Il
A :=
= U(Zq1). Let B(cid:48)
(cid:21)
(cid:20) In 0n×l B(cid:48)
0l×n Il B2
·
1
where the products are done over the integers and then taken modulo q1 for the top part and modulo
q2 for the bottom part. A(cid:48) sends A to the adversary A and receives messages m0, m1 ∈ Rl
q2 such
that m0 (cid:54)= m1. A(cid:48) samples b $← {0, 1}, computes:
(cid:20) In R
(cid:21)(cid:20)y(cid:48)
(cid:21)
t =
0l×n Il
1
y2
+
(cid:20) 0
(cid:21)
mb
where the products are done over the integers and then taken modulo q1 for the top part and
modulo q2 for the bottom part, and sends t to A. When A returns b(cid:48), A(cid:48) returns 1 if b(cid:48) = b and 0
otherwise.
We ﬁrst show that the public commitment matrix A is taken according to the correct distribution.
We have:
(cid:20) In R B(cid:48)
0l×n Il
A =
1 + RB2
B2
(cid:21)
1 is uniform modulo q1 and independent from R and B2, B(cid:48)
Since B(cid:48)
1 + RB2 mod q1 is uniform
modulo q1. Since R and B2 are also uniform, the distribution of A is identical to the one output
by CSetup.
If y is uniform in Rn+l
and b(cid:48) = b with
q1 and t is uniform in Rn+l
1 is uniform in Rn
then y(cid:48)
q1
q2
26
probability exactly 1/2. However if y =(cid:2)In+l B(cid:3) r, write r as
r3 ∈ Rm−n−l. Applying ρ component-wise to q1
(B1, B1r3 + r1) we get:
(cid:18) q1
q2
B1 + ∆,
q1
q2
B1r3 +
q1
q2
r1 + δ
, with r1 ∈ Rn, r2 ∈ Rl, and
r1
(cid:18) q1
(cid:19)
r2
r3
q2
(cid:19)
=
q2
(cid:18) q1
(cid:18)
=(cid:0)B(cid:48)
+
=
q1
q2
B(cid:48)
1, B(cid:48)
1, B(cid:48)
B1 + ∆,
B1 + ∆
r3
(cid:19)
q2
r1 + δ − ∆r3
r1 + δ − ∆r3
q1
1r3 +
q2
1r3 + r(cid:48)
1
(cid:1)
α + 1 + (cid:107)r3(cid:107)2 ≤ ξ(cid:48). Setting r(cid:48) =
(cid:19)
 we have that
r(cid:48)
1
r2
r3
(cid:20) 0
(cid:21)
mb
t = Ar(cid:48) +
where r(cid:48)
1 is subgaussian with parameter
(cid:113) q1
q2
is distributed according to Com(mb), and A will output b(cid:48) = b with probability 1/2+ε. A(cid:48) therefore
has advantage ε/2 in the M-LWEq2,m−n−l,ξ problem.
6.2 Security of the Scheme
Lemma 6.3 (Anonymity). Let A be a PPT adversary. Let AdvHidA (λ) be the advantage of A over
the Hiding property of the commitment scheme. Let Advind−cpa
(λ) be the advantage of A over the
IND-CPA property of the encryption scheme. The advantage of A against the CPA-anonymity of
our group signature is at most:
A
AdvanonA (λ) ≤ 2AdvHidA (λ) + Advind−cpa
A
(λ) + 2−λ
Proof. We use a succession of games.
Game G0 : In this game the challenger runs GSetup honestly and gives (gpk, sk1, . . . , skN ) to A.
A outputs a message M∗ and two identities i0, i1 ∈ [N ]. The challenger chooses a bit b $← {0, 1}
and computes z∗ := (t, t(cid:48), e, π) ← Sign(M∗, skib)
Game G1 : In this the challenger uses the simulator of the proof ΠSign when queried for Sign(M∗, skib).
This game is statistically indistinguishable from the previous by the zero-knowledge of ΠSign.
Game G2 : In this the challenger replaces the commitment t by a commitment of 0 when answering
the query Sign(M∗, skib). The proof ΠSign can still be used since it uses the simulator, and this
game is indistinguishable from the previous one by the hiding property of the commitment.
(cid:12)(cid:12)(cid:12)AdvG1A − AdvG0A
(cid:12)(cid:12)(cid:12)AdvG2A − AdvG1A
(cid:12)(cid:12)(cid:12) ≤ 2−λ
(cid:12)(cid:12)(cid:12) ≤ AdvHidA (λ)
27
Game G3 : In this the challenger replaces the commitment t(cid:48) by a commitment of 0 when answering
the query Sign(M∗, skib). This game is indistinguishable from the previous one by the hiding
property of the commitment.
Game G4 : In this the challenger replaces the commitment ciphertext e with an encryption of 0.
Since the proof ΠSign uses the simulator it is independent of the decryption of e. This game is
indistinguishable from the previous one by the IND-CPA property of the encryption scheme.
(cid:12)(cid:12)(cid:12)AdvG3A − AdvG2A
(cid:12)(cid:12)(cid:12)AdvG4A − AdvG3A
(cid:12)(cid:12)(cid:12) ≤ AdvHidA (λ)
(cid:12)(cid:12)(cid:12) ≤ Advind−cpa
A
(λ)
The signature (t, t(cid:48), e, π) output in Game G3 is independent of ib and the adversary has thus
probability 1/2 of outputting b(cid:48) = b. We obtain the desired result by summing the advantages.
We will prove traceability in two steps. We will ﬁrst prove that an adversary A cannot distinguish
between the regular traceability game and the traceability game in which the setup algorithm
has been replaced by GSetup∗ which we deﬁne below. We will then prove that a challenger B can
extract an M-SIS solution from an adversary who succeeds in producing a forgery in the traceability
game with GSetup∗.
GSetup∗(1λ):
– Sample i∗ $← Zq2
1
– Sample A :=
aT
2
– Sample a $← R2
q2.
– Sample R $← S2×2
1
– Sample (si∗
, si∗
, si∗
and set bT = aT R ∈ R1×2
) ← Ds × Ds × Dr
← CSetup(1λ), with a1 ∈ R3
q1, and a2 ∈ R3
q2.
(cid:20)aT
(cid:21)
q2
.
3
2
1
(cid:3)si∗
– Set u :=(cid:2)aT | bT | aT
– Set gpk :=(cid:0)A, a, b − i∗gT , u(cid:1)
(cid:2)aT | bT + (i − i∗)gT(cid:3)(cid:20)si1
(cid:21)
si∗
si∗
2
1
2
3
– For i ∈ Zq2 \ {i∗}, sample si3 ← D3
– For i ∈ Zq2 \ {i∗}, sample (si1, si2) ∈ R4 s.t
r
= u − aT
2 si3, and (si1, si2) ← D4
s
si2
A
– For i ∈ Zq2, set ski := si := (si1, si2, si3)
We consider the following advantages for an adversary A
– AdvtraceA (λ) the advantage of A in the traceability game.
– Advtrace∗
GSetup∗.
– AdvN T RUA
– AdvM LW E
Lemma 6.4. The advantage of any PPT adversary A against the traceability game of the group
signature is at most:
(λ) the advantage of A in the traceability game where GSetup is replaced with
(λ) the advantage of A in solving the NTRUq,r problem.
(λ) the advantage of A in solving the M-LWEq,1,s problem.
A
AdvtraceA (λ) ≤ 2(AdvN T RUA
(λ) + AdvM LW E
A
(λ)) + Advtrace∗
A
(λ)
28
Proof. We use a succession of games.
Game G0: The challenger B runs the Group signature protocol honestly. He gives (ski)i∈S as well
as gmsk to A who has advantage ε in the traceability game.
AdvG0A = AdvtraceA
Game G1: B samples aT
indistinguishable from G1 under the NTRUq,r assumption.
2 as [0 | 1 | f /g] where f, g ∈← Dr are taken as in Section 2.6. G2 is
of (cid:2)aT | bT + igT(cid:3) to sample secret keys for user i. To generate keys for i he will instead sample
Game G2: B sets bT $← R1×2
si1, si2 ← D2
from the previous one by the hardness of M-LWEq,1,s (since aT R is two M-LWEq,1,s samples).
. Note that if bT (cid:54)= aT R, B can no longer use the GPV trapdoor
s and use his NTRU trapdoor on a2 to sample si3. This game will be indistinguishable
q2
(cid:12)(cid:12)(cid:12)AdvG1A − AdvG0A
(cid:12)(cid:12)(cid:12) ≤ AdvN T RUA
(cid:12)(cid:12)(cid:12)AdvG2A − AdvG1A
(cid:12)(cid:12)(cid:12) ≤ AdvM LW E
A
Game G3: B replaces bT with b∗T := bT − i∗gT . Since bT is uniform this game is identical to the
previous one.
AdvG3A = AdvG2A
Game G4: B sets b∗T := aT R− i∗gT . This game is indistinguishable from the previous one under
M-LWEq,1,s.
Game G5: B sets aT
to sample secret keys for user i. This game is indistinguishable from the previous one under the
NTRUq,r assumption.
2 as [0 | 1 | a2], with a2
$← Rq2 and uses the GPV trapdoor of(cid:2)aT | bT + (i − i∗)gT(cid:3)
A
(cid:12)(cid:12)(cid:12)AdvG4A − AdvG3A
(cid:12)(cid:12)(cid:12)AdvG5A − AdvG4A
(cid:12)(cid:12)(cid:12) ≤ AdvM LW E
(cid:12)(cid:12)(cid:12) ≤ AdvN T RUA
√
Note that Game G5 is the traceability game that uses GSetup∗ (simply by renaming s0 to si∗),