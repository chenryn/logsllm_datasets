title:Bots Behaviors vs. Human Behaviors on Large-Scale Communication Networks
(Extended Abstract)
author:Wei Lu and
Ali A. Ghorbani
Bots Behaviors vs. Human Behaviors on
Large-Scale Communication Networks
(Extended Abstract)
Wei Lu1,2 and Ali A. Ghorbani1
1 Faculty of Computer Science, University of New Brunswick, Fredericton,
2 Department of Electrical and Computer Engineering, University of Victoria,
NB Canada
BC Canada
{wlu,ghorbani}@unb.ca
Abstract. In this paper we propose a hierarchical framework for de-
tecting and characterizing any types of botnets on a large-scale WiFi
ISP network. In particular, we ﬁrst analyze and classify the network
traﬃc into diﬀerent applications by using payload signatures and the
cross-associations for IP addresses and ports. Then based on speciﬁc ap-
plication community (e.g. IRC, HTTP, or Peer-to-Peer), we present a
novel temporal-frequent characteristic of ﬂows that leads the diﬀerentia-
tion of malicious behaviors created by bots from normal network traﬃc
generated by human beings. We evaluate our approach with over 160 mil-
lion ﬂows collected over ﬁve consecutive days on a large-scale network
and preliminary results show the proposed approach successfully detects
the IRC botnet ﬂows from over 160 million ﬂows with a high detection
rate and an acceptable low false alarm rate.
1 Problem Statement, State of the Art and Contributions
Detecting botnets behaviors on large-scale networks is a very challenging prob-
lem. This is because: (1) botnets are often hidden in existing applications, and
thus their traﬃc volume is not that big and is very similar with normal traf-
ﬁc behaviors; (2) identifying network traﬃc into diﬀerent applications becomes
more challenging and is still an issue yet to be solved due to traﬃc content en-
cryption and the unreliable destination port labeling method. The observation
on a large-scale WiFi ISP network over a half year period showed that even
exploring the ﬂow content examination method, there are still about 40% net-
work ﬂows that cannot be classiﬁed into speciﬁc applications. Investigating such
a huge number of unknown traﬃc is very important since they might stand for
the abnormalities in the traﬃc, malicious behaviors or simply the identiﬁcation
of novel applications.
Current attempts on detecting botnets are mainly based on honeypots, pas-
sive anomaly analysis and traﬃc application classiﬁcation. The anomaly analysis
for detecting botnets on network traﬃc is usually independent of the traﬃc con-
tent and has the potential to ﬁnd diﬀerent types of botnets. However, anomaly
R. Lippmann, E. Kirda, and A. Trachtenberg (Eds.): RAID 2008, LNCS 5230, pp. 415–416, 2008.
c(cid:2) Springer-Verlag Berlin Heidelberg 2008
416
W. Lu et al.
input network flows 
network application communities 
Step 1. Payload Signatures based 
Application Classifier
unknown flows 
Step 2. Cross-Association based 
Application Classifier
Step 3
P2P 
IRC 
WEB
Humans IRC Flows
Bots IRC Flows
Fig. 1. The proposed hierarchical framework for botnets detection
detection tends to generate a large volume of false alarms traditionally when
deployed on a large-scale communication network. The traﬃc application clas-
siﬁcation based botnets detection focuses on classifying traﬃc into IRC traﬃc
and non-IRC traﬃc, oﬀering a potential to reduce number of false alarms, but
can detect IRC based botnets only.
In this paper, we focus on traﬃc classiﬁcation based botnets detection. Instead
of labeling and ﬁltering traﬃc into non-IRC and IRC, we propose a hierarchical
framework illustrated in Fig. 1 for discriminating malicious behaviors generated
by any types of bots from normal behaviors generated by human beings. The
major contributions of this work include: (1) a novel application discovery ap-
proach for classifying traﬃc into diﬀerent network application communities (e.g.
P2P, Chat, Web, etc.) on a large-scale WiFi ISP network, in which the input
ﬂows are ﬁrst labeled through payload signatures (i.e. Step 1 of Fig.1) and un-
known ﬂows are then labeled through the cross-associations of IP addresses and
port numbers (i.e. Step 2 of Fig.1); (2) a novel temporal-frequent metric based
on N-gram (frequent characteristic) of ﬂow payload over a time period (tempo-
ral characteristic) for discriminating bots behaviors from humans behaviors on
a large-scale network (i.e. Step 3 of Fig.1).
2 Preliminary Evaluation Results and Conclusions
We implement a prototype system for the proposed hierarchical framework and
then evaluate it on a large-scale WiFi ISP network over ﬁve consecutive busi-
ness days. Our traﬃc classiﬁcation approach can classify the unknown IRC ﬂows
into the IRC application community with a 100% classiﬁcation rate on the ﬁve
days evaluation. The detection rate for diﬀerentiating bots IRC traﬃc from nor-
mal human beings IRC traﬃc is 100% on four days testing, while an exception
happens on the third day’s testing on which our prototype obtained a 77.8%
detection rate with a 3.1% false alarm rate. The best evaluation over the ﬁve
days testing is a 100% detection rate with only 1.6% false alarm rate. Moreover,
the preliminary evaluation results show that the average standard deviation of
bytes frequency over the 256 ASCIIs on the ﬂow payload is an important metric
to indicate normal human IRC traﬃc and malicious IRC traﬃc generated by
machine bots. In the near future, we will conduct an experimental evaluation
with the web based botnets and new appeared P2P botnets.