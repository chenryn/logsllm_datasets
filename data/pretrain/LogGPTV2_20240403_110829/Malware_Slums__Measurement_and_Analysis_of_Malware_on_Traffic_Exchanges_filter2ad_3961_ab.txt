URLs
61,015
21,527
18,853
109,111
2,571
418
336
212
484
STATISTICS OF DOMAINS ON TRAFFIC EXCHANGES
TABLE II
Exchange
10KHits
ManyHits
Smiley TrafÔ¨Åc
SendSurf
Otohits
Cash N Hits
Easyhits4u
Hit2Hit
TrafÔ¨Åc Monsoon
# Domains
4,823
3,705
3,367
1,460
2,106
614
489
418
466
# Malware % Malware
15.0%
14.1%
9.5%
4.3%
13.9%
17.1%
14.3%
16.3%
18.4%
724
522
320
63
292
105
70
68
86
JavaScript exploits, and malformed PDFs that are com-
monly used by attackers. It also effectively detects mali-
cious JavaScript code that has been obfuscated to hamper
static code analysis. To get detailed information about
malware, we rely on the analysis reports obtained through
Quttera.
In addition to these two malware detection tools, we used
some third-party malware and phishing blacklists. Blacklists
are databases of suspicious URLs and domains that are known
to host malicious content. They are employed by some web
browsers to protect users from malicious content. We use
URLBlacklist [26], Shallalist [21], Google Safe Browsing API
[10], SquidGuard MESD [24], Malware Domain List [12], and
Zeus Tracker [31] blacklists in our analysis. Since blacklists
are updated infrequently, they may contain false positives. To
minimize false positives, we label a domain as malicious only
if it is present in multiple blacklists [41].
As shown in Table I, out of the 802,434 URLs obtained
from the trafÔ¨Åc exchanges, the malware detection tools identify
214,527 as malicious.1 Table II lists the distribution of web
domains encountered on different
trafÔ¨Åc exchanges. Some
benign domains such as ajax.googleapis.com appear
across most trafÔ¨Åc exchanges. The fraction of domains with
at least one malicious URL ranges between 4.3% and 18.4%.
1Note that some malicious websites use cloaking strategies for forging
their URLs to evade detection by URL-based malware detection tools. We
conÔ¨Årm the presence of these websites in our pilot analysis. To mitigate this
issue, we download completed pages to our local storage and upload the
Ô¨Åles to malware detection tools for analysis. We Ô¨Ånd that this strategy can
successfully overcome the cloaking strategies used by malicious websites. We
further discuss this issue later in Section V.
Some malicious domains such as visadd.com appear across
most trafÔ¨Åc exchanges.
We conduct an in-depth analysis of malicious pages in the
next section.
IV. ANALYZING MALWARE ON TRAFFIC EXCHANGES
Below, we conduct an in-depth analysis of malware on
trafÔ¨Åc exchanges. We start by analyzing the differences in
malware across auto-surf and manual-surf trafÔ¨Åc exchanges. In
auto-surf trafÔ¨Åc exchanges, as shown in Figure 2(a), SendSurf
has the highest fraction of malicious URLs at 51.9%. 10KHits,
ManyHits, Smiley TrafÔ¨Åc, and Otohits trail with 33.8%, 14.6%,
8.7%, and 7.4% malicious URLs, respectively. For manual-surf
trafÔ¨Åc exchanges, as shown in Figure 2(b), TrafÔ¨Åc Monsoon
has the highest fraction of malicious URLs at 12.2%, followed
closely by Easyhits4u, Cash N Hits, and Hit2Hit with 10.4%,
10.2%, and 8.5% malicious URLs, respectively. Out of the
802,434 URLs, the malware detection tools identiÔ¨Åed 214,527
URLs as malicious (i.e. infected with malware), making up
approximately 26% of the URLs.
Figure 3 illustrates the temporal evolution of malicious
content as observed on auto-surf and manual-surf trafÔ¨Åc ex-
changes. The more interesting behavior is shown by manual-
surf exchanges. There, we note that several timeseries exhibit
temporal bursts of malicious URLs. For example, TrafÔ¨Åc Mon-
soon has several bursts of malware. During these bursts, a vast
majority of URLs surfed by TrafÔ¨Åc Monsoon were detected
as malicious. We note bursts for several other manual-surf
trafÔ¨Åc exchanges as well. The bursts of malicious URLs can
be explained by paid campaigns of Ô¨Åx durations on the trafÔ¨Åc
exchanges. To validate this assertion, we paid a manual-surf
trafÔ¨Åc exchange to get impressions on a dummy website. We
purchased 2500 visits for $5 and our website received a total
of 4,621 visits from 2,685 unique IP addresses in less than an
hour. We veriÔ¨Åed that the trafÔ¨Åc exchanges provided a burst of
visits to the dummy website in a short time interval. For auto-
surf exchanges, the behavior is quite gradual and predictable
due to the automated nature of trafÔ¨Åc, as demonstrated by the
smooth, near-linear curves in Figure 3.
A. Malware Categorization
Next, we categorize malicious URLs based on the func-
tionality of detected malware. Similar to Zarras et al. [41],
575
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:18:37 UTC from IEEE Xplore.  Restrictions apply. 
œ≠œ¨œ¨–π
œ¥œ¨–π
œ≤œ¨–π
œ∞œ¨–π
œÆœ¨–π
œ¨–π
œ≠œ¨œ¨–π
œ¥œ¨–π
œ≤œ¨–π
œ∞œ¨–π
œÆœ¨–π
œ¨–π
œÆœ≠œ±œÆœ≥
œ≠œ¥œ¥œ±œØ
œ≠œÆœ±œ≤œ≤œÆ
œ≠œµœ≥œ≠œ¥œ¥
œ≤œ≠œ¨œ≠œ±
œ≠œ≠œµœØœ∞œ≥
œÆœ±œ≥œ≠
œØœÆœÆœ∞œÆ
œ≠œ¨œµœ≠œ≠œ≠
œ≠œ¨œ≠œ≠œ∞œ±
œ≠œ¨<,≈ù∆ö∆ê
DƒÇ≈∂«á,≈ù∆ö∆ê
^≈µ≈ù≈Øƒû«ád∆åƒÇƒ®ƒ®≈ùƒê
^ƒû≈∂ƒö^∆µ∆åƒ®
K∆ö≈Ω≈ö≈ù∆ö∆ê
ƒû≈∂≈ù≈ê≈∂ DƒÇ≈Ø«ÅƒÇ∆åƒû
(a) auto-surf trafÔ¨Åc exchanges
œ∞œ≠œ¥
œØœØœ≤
œÆœ≠œÆ
œØœ≤œ≤œØ
œÆœµœ¨œ±
œÆœÆœ¥œ≠
œ∞œ¥œ∞
œØœ∞œ≥œ∞
ƒÇ∆ê≈öE,≈ù∆ö∆ê
ƒÇ∆ê«á≈ö≈ù∆ö∆êœ∞∆µ
,≈ù∆öœÆ,≈ù∆ö
d∆åƒÇƒ®ƒ®≈ùƒêD≈Ω≈∂∆ê≈Ω≈Ω≈∂
ƒû≈∂≈ù≈ê≈∂ DƒÇ≈Ø«ÅƒÇ∆åƒû
(b) manual-surf trafÔ¨Åc exchanges
Fig. 2. Malware ratio in auto-surf and manual-surf trafÔ¨Åc exchanges
we rely on detailed reports from third-party malware analysis
services such as VirusTotal, Quttera, and blacklists for mal-
ware categorization. Based on malware analysis reports, we
divide malware detected on trafÔ¨Åc exchanges into Ô¨Åve cate-
gories: blacklisted sites, malicious Flash, malicious JavaScript,
suspicious redirections, and malicious shortened URL. To
categorize malicious URLs, we start with suspicious redirects
and classiÔ¨Åed the malicious URLs as suspicious if their initial
and Ô¨Ånal URL did not match. For the JavaScript and Flash,
we rely on Ô¨Åle extension information to assign categories. We
then identify malicious URLs from URL shortening services.
For blacklists, we scan URLs in our blacklists and label the
ones that matched more than one blacklist. Note that some
malicious URLs could not be neatly separated into these
categories due to lack of detailed information. We label these
malicious URLs as miscellaneous, which account for a total
of 142,405 URLs in our data.
Table III provides the breakdown for different malware
categories. Excluding the miscellaneous category, blacklisted
URLs constitute the largest category of malicious URLs at
74.8%. Malicious JavaScript, suspicious redirections, mali-
cious shortened URLs, and malicious Flash categories account
for the rest of malware. Below, we provide an overview of each
of these categories.
1) Malicious JavaScript: A signiÔ¨Åcant number of mali-
cious URLs contain JavaScript code that dynamically cre-
ate iframe elements. These iframe elements typically
.+LWV
0DQ\+LWV
6PLOH\7UDIILF
6HQG6XUI
2WRKLWV



&RXQWRI&UDZOHG85/V
(a) auto-surf trafÔ¨Åc exchanges
&DVK1+LWV
(DV\KLWVX
+LW+LW
7UDIILF0RQVRRQ
[




















V
/
5
8

V
X
R
F
L
L
O
D
0

I
R

W
Q
X
R
&
H
Y
L
W

O
D
X
P
X
&
V
/
5
8

V
X
R
F
L
L
O
D
0

I
R

W
Q
X
R
&
H
Y
L
W

O
D
X
P
X
&





&RXQWRI&UDZOHG85/V

[


(b) manual-surf trafÔ¨Åc exchanges
Fig. 3. Time series of malicious URLs detected on trafÔ¨Åc exchanges
TABLE III
MALWARE CATEGORIZATION
Category
Blacklisted
Malicious JavaScript
Suspicious Redirection
Malicious Shortened URLs
Malicious Flash
Percentage
74.8%
18.8%
5.8%
0.5%
0.1%
load content from blacklisted and other malicious domains.
Our scanning engines reported malicious JavaScript through
the aliases Script.virus, Virus.ScrInject.JS, and
Trojan:Script.Heuristic.js.iacgm [6]. Malicious
JavaScript code also displays other types of malicious behav-
ior. For example, some JavaScript code snippets perform user
behavior Ô¨Ångerprinting by recording a user‚Äôs interaction with
576
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:18:37 UTC from IEEE Xplore.  Restrictions apply. 
browser (e.g., recording a user‚Äôs mouse movements). Finally,
some JavaScript code snippets are responsible for deceptive
downloads of executables such as flashplayer.exe. It is
noteworthy that some JavaScript code snippets were obfus-
cated, which required execution analysis in a virtual machine
environment for behavioral analysis.
2) Malicious Flash: We also Ô¨Ånd several Flash Ô¨Åles
that were detected as malware by the detection tools.
The detected malicious Flash Ô¨Åles are mostly labeled as
BehavesLike.JS.ExploitBlacole [14]. For further
analysis of obfuscated Flash code, we executed them in a
virtual machine environment. The malicious Flash Ô¨Åles made
external
to launch
advertisement scams by loading pop ups and opening new
tabs. It is noteworthy that malicious Flash accounts for 0.1%
of malware in our data set. We surmise that the low numbers
of malicious Flash URLs are because most of the modern
browsers have depreciated Flash [9].
interface calls to obfuscated JavaScript
3) Blacklisted URLs: As discussed earlier, some URLs
are blacklisted by malware detection engines. Our analysis
found that these websites either host malicious content or
they engage with blacklisted advertisement networks. Some of
blacklisted domains encountered on trafÔ¨Åc exchanges include
luckyleap.net, esy.es, atw.hu, 380tl.com, and yadro.ru.
4) Suspicious Redirection: Some websites contained server
side code that redirected users to an undesirable website with-
out user consent. These redirections typically launch download
of executable Ô¨Åles. The malware detection engines labeled
such behavior as Trojan.Script.Generic. It was dif-
Ô¨Åcult for these malware detection engines to identify some of
these suspicious redirections because the initial URL is benign
but
the redirected URL contains malware. URLs involved
in redirections sometimes make long chains by redirecting
multiple times before reaching their destination URLs. Figure
4 shows an example URL redirection chain. Figure 5 plots
the distribution of redirection count for different URLs. We
note that several malicious URLs redirect users up to 7 times
before reaching the destination URL.
5) Malicious Shortened URL: URL shortening services are
widely used to compress long URLs. Shortened URLs can
allow malicious URLs to go undetected because the base
URL gets replaced by an alias. We also found evidence of
nested shortened URLs (a shortened URL pointed to another
shortened URL), thereby making its detection quite difÔ¨Åcult.
On malicious URLs found in trafÔ¨Åc exchanges, we encoun-
tered URL shortening services such as goo.gl, bit.ly,
mbcurl.me, tiny.cc, and tr.im. Our results corroborate
the Ô¨Åndings in prior work (e.g., [39]) that reported substantial
malware presence on URL shortening services. Some URL
shortening services publicly provide hit statistics of the short-
ened URLs. Table IV lists these statistics for shortened URLs