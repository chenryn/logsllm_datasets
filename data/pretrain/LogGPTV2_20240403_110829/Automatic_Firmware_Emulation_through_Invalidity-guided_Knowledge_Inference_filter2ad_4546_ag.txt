43
62
61
835
3
0
1
1
1
0
0
1
1
0
1
1
1
1
0
1
0
0
1
0
1
15
T1
8
11
5
15
14
4
8
4
14
16
29
29
11
18
10
14
8
11
16
11
17
273
T2 T3
3
0
0
0
1
0
1
0
0
1
0
0
0
0
1
1
1
1
0
0
1
0
0
1
1
2
1
2
0
0
1
0
0
2
0
0
0
1
0
1
1
0
9
15
Total
14
13
8
22
15
5
12
8
27
16
33
33
19
26
13
16
12
12
18
17
23
362
A Summary of Cache Types in the KB
In Table 3, for each sample, we summarize the number of
entries for each cache type.
B Details of Real Firmware Samples
GPS/GLONASS Vehicle Tracker. This is an open-source
ﬁrmware for GPS/GLONASS vehicle tracker provided by
Geolink [23]. It includes many advanced features such as
real-time tracking, analog sensors, CAN bus, battery monitor,
external commands, and many others.
Marlin 3D printer. Marlin [44] is an open source ﬁrmware
for the RepRap family of replicating rapid prototypers – pop-
ularly known as “3D printers”.
Lite OS IoT Demo. LightOS [26] is the IoT OS released by
the Huawei. This is the IoT demo ﬁrmware for commercial
testing multiple functions, including serial, sensor and NB-IoT
communication module running on the IoTClub board [6].
Socket CAN Test on Zephyr. Zephyr [14] is an RTOS built
for IoT applications supported by Linux Foundation. This
socket CAN sample [12] is a server/client application that
sends and receives raw CAN frames using BSD socket API.
µµµTasker MODBUS and µµµTasker USB. µTasker [7] is an
embedded OS with manyµready-made projects targeting a
board class of embedded processors. The MODBUS demo [8]
demonstrates the use of the MODBUS extension with µTasker
over Ethernet (MOSBUS TCP). The MODBUS protocol is
widely used in PLC devices. The USB demo [9] provides
a menu-driven terminal interface via USB. It can be com-
manded to operate as an RS232 device.
C Detailed Conﬁguration of Each Tested
Firmware Sample
In Table 5, we list the detailed conﬁguration of each sample.
USENIX Association
30th USENIX Security Symposium    2023
Table 4: Details of real-world ﬁrmware samples
OS/Sys lib. On-chip Peripherals Used by Firmware
Bare metal
Firmware
CNC
Console
Drone
Gateway
Heat_Press
PLC
Reﬂow_Oven
Robot
Soldering_Iron
Steering_Control
6LoWPAN_Sender
6LoWPAN_Receiver
RF_Door_Lock
Thermostat
XML_Parser
GPS tracker
LiteOS_IoT
Zepyhr_SocketCan
3Dprinter
µµµtasker_MODBUS
µµµtasker_USB
MCU
STM32F429ZI
MK64FN1M0VLL12 RIOT
STM32F103RB
STM32F103RB
SAM3X8E
STM32F429ZI
STM32F103RB
STM32F103RB
STM32F103RB
SAM3X8E
SAM R21
SAM R21
MAX32600
MAX32600
STM32L152XE
SAM3X/A
STM32L431
STM32L432KC
STM32F103RE
STM32F429ZIT6U
STM32F429ZIT6U
Bare metal
Arduino
Arduino
Arduino
Arduino
Bare metal
FreeRTOS
Arduino
Contiki
Contiki
Mbed
Mbed
Mbed
Arduino
LiteOS
Zephyr
Arduino
µtasker
µtasker
TIM2,TIM4,USART2,PWR,SYSCFG,EXTI,GPIOA,GPIOB,GPIOD,GPIOE,RCC,FLASH
RTC,SIM,PORTA,PORTB,PORTE,WDOG,MCG,UART,SMC,GPIOB,GPIOE
TIM2,TIM3,TIM4,I2C1,GPIOA,GPIOB,GPIOC,TIM1,USART1,RCC,FLASH
TIM1,TIM2,TIM3,TIM4,I2C1,AFIO,GPIOA,GPIOB,GPIOD,ADC1,GPIOC,RCC,FLASH,UART
ADC,PMC,UART,CHIPID,EFC1,PIOA,PIOB,PIOC,PIOD,WDT
USART3,PWR,GPIOD,RCC,FLASH
USART2,AFIO,GPIOA,GPIOB,GPIOC,ADC1,RCC,FLASH
TIM2,I2C1,GPIOA,TIM1,USART1,RCC,FLASH
TIM2,TIM3,IWDG,I2C1,AFIO,GPIOA,GPIOB,GPIOD,ADC1,TIM1,DMA1,RCC,FLASH
TC,ADC,PMC,UART,CHIPID,EFC1,PIOA,PIOB,PIOC,PIOD,WDT
PORT,RTC,UART,I2C,TC3,TC4, SPI,SYSCTRL,GCLK,PM,EIC,NVMCTRL,USB,MTB,RF233CTRL
PORT,RTC,UART,I2C,TC3,TC4,SPI,SYSCTRL,GCLK,PM,EIC,NVMCTRL,USB,MTB,RF233CTRL
GPIO,TIMER,UART,DAC0,DAC1,DAC2,DAC3,AFE,ICC,CLKMAN,PM,IOMAN
GPIO,TIMER,UART,I2C,DAC0,DAC1,DAC2,DAC3,AFE,ICC,CLKMAN,PM,IOMAN
TIM5,RTC,UART,PWR,PORTA,PORTC,RCC,FLASH
UART0,UART1,ADC,EEFC0,WDT,PIO,CHIPID,SMC,USB,PM
UART2,I2C,PWR,SYSCFG,EXTI,UART1,RCC,FLASH,GPIOA,GPIOB,GPIOC
TIM2,UART2,PWR,RCC,FLASH,GPIO,CAN
TIM2,TIM3,TIM4,TIM5,TIM6,TIM7,PORTB,PORTA,PORTC,ADC1,ADC2,ADC3,UART,DMA
TIM2,TIM4,IWDG,UART2,UART3,PWR,UART1,SYSCFG,GPIOA,GPIOB,GPIOC,GPIOD,GPIOG,FLASH,ETHERNET
TIM2,TIM4,IWDG,UART2,UART3,PWR,UART1,GPIOA,GPIOB,GPIOC,RCC,FLASH,USB
Table 5: Conﬁguration used in the experiment in Section 5.2
Firmware
CNC
Console
Drone
Gateway
Heat_Press
PLC
Reﬂow_Oven
Robot
Soldering_Iron
Steering_Control
6LoWPAN_Sender∗
6LoWPAN_Receiver∗
RF_Door_Lock∗
Thermostat∗
XML_Parser
GPS_tracker
LiteOS_IoT
Zepyhr_SocketCan
3Dprinter∗
µµµtasker_MODBUS∗
µµµtasker_USB
BB#_INV1 BB#_INV2 BB#_Term User-deﬁned Program Points
30
30
30
30
30
30
30
30
30
30
80
80
30
30
30
30
30
30
30
30
30
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
2,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
20,000
20,000
30,000
30,000
30,000
30,000
30,000
30,000
30,000
none
none
none
none
none
none
none
none
none
none
i2c_master_wait_for_bus
i2c_master_wait_for_bus
Mbed_Die
Mbed_Die
none
none
none
none
Fail_Conﬁg
Error_ConﬁgEthernet
none
*: We customized parameters for these six samples for correct emulation.
Automatically Identiﬁed DRs
(Manually Assigned DRs That are Missed in KB Extraction)
0x40004404, 0x40020010, 0x40020C10
0x4006A007
0x40005410, 0x40013804
0x40004404, 0x40005410
0x400E0818
0x40004804
0x40004404, 0x40010C08, 0x4001244C
0x40005410
0x40005410, 0x40010808
0x400E0818
0x42001828, 0x42000828, (0x42000C28)
0x42001828, 0x42000828, (0x42000C28)
0x40039020
0x40039020, 0x4010D800
0x40004C04
0x40098018, 0x4009C018
0x40004424, (0x48000010)
0x40004424, 0x400065B0-0x400065BC
0x40013804
0x40004804, 0x40004404, 0x40011004
0x40004804, 0x40004404, 0x40011004, 0x50001000
2024    30th USENIX Security Symposium
USENIX Association