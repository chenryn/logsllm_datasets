FORENSIC FAILS
SHIFT + DELETE WON’T HELP YOU HERE
ERIC ROBI + MICHAEL PERKLIN 
DEFCON 21 
AUGUST 4, 2013
ABOUT THIS GUY 
 ERIC ROBI
Founder of Elluma Discovery - 11 years
Forensic Examiner
Thousands of exams
Expert Witness 
Likes Cats
ABOUT THIS OTHER GUY 
MICHAEL PERKLIN
Senior Investigator / Forensic Examiner
Security Professional
Thousands of exams
Likes to break things
... A Lot
AGENDA
7 Stories full of FAIL
Learn something about Forensic Techniques
Fails brought to you by both THE SUSPECT and THE EXAMINER
*Names have been changed to protect the idiots on both sides
*Many of the case facts have been changed too.
I don’t know why. We don’t need to. It just seemed like a nice 
thing to do. 
This presentation required the creation of Teh Fail Matrix
10
5
5
15
35
Fail Matrix
Lost the case
$$$$ 
GF left him
Personal Fial 
FAIL #1 - The “Wasn’t 
Me” Defense
Employee Bob worked in sales at Acme
He resigned his position and left to work for a 
competitor
Allegation was made that he took Acme’s company list 
with him
FAIL #1 - The “Wasn’t 
Me” Defense
Bob said “I’ve got nothing to hide”. “Come at me bros!”.
We began imaging the drive and started planning the examination
Look for deleted files in unallocated space
Look for ‘recent files’ used by common programs (Word, Excel)
Look for USB device insertion
Finally the drive finished imaging...
DEFCON EXCLUSIVE... New finding!
FAIL #1 - The “Wasn’t 
Me” Defense
Bob had used a data destruction program to overwrite 
every byte of unallocated space on his drive
He used a pattern that was not likely to appear through 
normal use of a Windows operating system
The existence of this pattern MIGHT suggest 
POSSIBLE willful destruction of evidence
...maybe
What have we learned... 
#1
Data destruction software can almost ALWAYS be 
detected
Even if you don’t use a repeating pattern, it’s still 
detectable
We may not know what you destroyed
But we definitely know you destroyed SOMETHING
Also, mean phrases make people dislike you.
12
12
3
0
27
Fail Matrix
Lost the case
Under $100K 
FAIL #2 - The Nickelback 
Guy
Standard case: Allegation of stolen confidential 
documents
Suspect John left NOCFED industries after 3 years to 
work for a competitor
John worked on confidential projects
NOCFED was worried John took data to competitor
FAIL #2 - The Nickelback 
Guy
Opened HDD to begin analysis
Lots of MP3s identified
Found the confidential documents (as expected)
Almost immediately, something jumped out at me as an 
examiner
(We’ll get into why in a bit...)
FAIL #2 - The Nickelback 
Guy
It seems that John 
assumed that nobody would 
play his Nickelback MP3s!! 
(a sound assumption)
They are all .avi files with 
a renamed filename. 
Clever, kinda
What was he hiding???
FAIL #2 - The Nickelback 
Guy
PREGGER PORN!!!!
It seemed John did more at
work than just work on
his confidential project!!
What have we learned... 
#2
Examiners see files in a long list; not a folder/tree structure
A “File Signature Analysis” is run that analyzes every file on 
the HDD
It compares the contents of files with the extensions of 
the filenames
Any file with a discrepancy is identified for closer analysis
John’s attempt at hiding something put it at the top of the 
list for analysis
12
13
0
5
Fail Matrix
30
Fail Matrix
Lost his job
For owning Nickelback
FAIL #3 - JUST BILL ME 
LATER
ABC Firm outsourced key part of their business for 
many years
Received bills on an hourly basis. Amounted to several 
million $ per year on average.
Client started bill review project. Suspected some 
tasks were taking a weeeeee bit too long. 
Asked us to help
FAIL #3 - JUST BILL ME 
LATER
Thousands PDF format invoices not much help. 
Where to start? Not a lot of clues
Ah ha! Located billing database on vendor’s network
Forensic copy of database, migrated DB to MSSQL
No easy way to compare DB to PDFs.
FAIL #3 - JUST BILL ME 
LATER
Reverse engineered tables in DB 
Noticed audit logs were turned on!
Ran many queries of time billed vs. audit logs
Noticed that audit logs showed changes to DB
Time inflation! Rate inflation!
What have we learned #3
Audit logs off by default. Turned ON by IT peeps!
Audit logs are the BEST evidence of theft in a DB 
case.
LESSON: Don’t turn on audit logs if you plan to cheat 
your client!
8
18
15
4
45
Fail Matrix
Had to refund the $
Systematic culture of overbilling
$12M + refunded
FAIL #4 - Smoking Gun.txt
Smoking Gun.txt is the gag name of “the file that 
proves the case”
Comes from cheesy western movies where the murderer’s 
gun is still smoking, proving he fired the shot
This case is another intellectual property case
Again, an employee left his company to go work for a 
competitor
FAIL #4 - Smoking 
Gun.txt 
Imaged the drive
Kicked-off standard analysis scripts
Opened up his Desktop folder
You can tell a lot about a person by the way they 
organize their Desktop!
Immediately solved the case
FAIL #4 - Smoking Gun.txt 
FAIL #4 - Smoking Gun.txt
The guy had created a folder filled with data from his previous 
employer
Bonus PowerPoint presentation to bring his new colleagues up-to-speed
What have we learned... 
#4
Sometimes people 
don’t even try.
18
10
6
12
Fail Matrix
46
Had to settle for $
$1.5M in damages
Zero effort!
Fail Matrix
FAIL #5 - HIDING IN THE 
CLOUD
Top sales guy leaves company. Sales plummet.
They suspect he took customer list, but can’t prove 
it.
We image his computer and start looking for the usual 
clues:
FAIL #5 - HIDING IN THE 
CLOUD
Link files: Shows opened files
BagMRU - Registry key shows user folder activity
Jump lists - Shows opened files (Win 7+)
IE history - Shows accessed files
NO LOVE. SHOW ME THE LOVE.
FAIL #5 - HIDING IN THE 
CLOUD
Searched IE history
Found a .htm file containing some javascript 
pointing to“filesanywhere.com”
BINGO! 
Showed acct ID, upload times, file names
FOUND SOME SWEET LOVIN’! (stolen files)
FAIL #5 - HIDING IN THE 
CLOUD
//Fill nodes data
oNodes[0] = new node(''Stolen_File.txt”, 'ﬁle', 'USER\\Eric\
\Test\\','F','','false','74','10/19/2011 3:15:05 PM');
oNodes[1] = new node(''Recipe_for_Coke.txt”, 'ﬁle', USER\
\Eric\\Test\\','F','','false','23','10/19/2011 3:15:05 PM');
 - Recovered FilesAnywhere Information
Timestamp (EDT)
Filename
Type
Destination Folder
Size
6/17/10 12:39:26 PM
Agents.xls
 file
\\
2,691,584
6/17/10 12:41:30 PM
0 - Generic flyer.doc
 file
\\New Reps\\
1,503,744
6/17/10 12:41:30 PM
ACCESSSORIAL CHARGE CHANGES.doc
 file
\\New Reps\\
58,880
6/17/10 12:41:30 PM
account review worksheet.xls
 file
\\New Reps\\
19,968
6/17/10 12:41:30 PM
ACI Codes Guide Training.doc
 file
\\New Reps\\
19,968
6/17/10 12:41:30 PM
ACI Codes.xls
 file
\\New Reps\\
15,872
6/17/10 12:41:30 PM
Adding venues.doc
 file
\\New Reps\\
78,848
6/17/10 12:41:30 PM
Adding venues.pdf
 file
\\New Reps\\
30,741
6/17/10 12:41:31 PM
Apples to apples.doc
 file
\\New Reps\\
25,600
6/17/10 12:41:36 PM
Carpet brochure.doc
 file
\\New Reps\\
2,338,816
6/17/10 12:41:36 PM
Carpet brochure.pdf
 file
\\New Reps\\
215,976
6/17/10 12:41:43 PM
Cases and Crates.doc
 file
\\New Reps\\
3,163,136
6/17/10 12:41:43 PM
Cases and Crates.pdf
 file
\\New Reps\\
241,206
6/17/10 12:41:44 PM
CC REQUEST FORM FORM 2010.doc
 file
\\New Reps\\
353,280
6/17/10 12:41:45 PM
CC REQUEST FORM FORM REVISED.doc
 file
\\New Reps\\
353,792
6/17/10 12:41:46 PM
Charges & Specials.doc
 file
\\New Reps\\
66,048
6/17/10 12:41:46 PM
Cold Call Tracker.pdf
 file
\\New Reps\\
5,219
6/17/10 12:41:46 PM
Cold Call Tracker.xls
 file
\\New Reps\\
15,872
6/17/10 12:41:46 PM
Cold calling inquisition.doc
 file
\\New Reps\\