| 网络和安全产品类日志 |防火墙 |Syslog方式被动收集 |实时收集 |
| 网络和安全产品类日志 |入侵防御系统IPS |Syslog方式被动收集 |实时收集 |
| 网络和安全产品类日志 |Web应用防护系统WAF |Syslog方式被动收集 |实时收集 |
| 数据库和中间件类日志 |数据库 |旁路监控技术（数据库日志） |实时收集分析，可配置 |
| 数据库和中间件类日志 |中间件 |Agent主动采集 |实时收集，可配置  |
| 应用系统类日志 |应用系统日志 |Agent主动采集 |实时收集，可配置 || 应用系统类日志 |其他设备 |Agent主动采集 |实时收集，可配置 |
| 应用系统类日志 |其他设备 |Syslog/rsyslog被动收集 |实时收集 |
| 应用系统类日志 |其他设备 |Snmp协议主动采集 |默认5分钟，可配置 |
| 应用系统类日志 |文件 |专用文件采集Agent主动采集 |实时收集，可配置 |
| 终端类日志 |终端 |Agent主动采集 |实时收集，可配置 |
日志存储规范
存储原则
| 存储原则 | 解释 | 备注 |
|---|---|---|
| 法律法规依从性  |日志存留时间需满足相关法律法规中要求的保存的特定日志的类型和存储时间。  | |
| 评估组织的风险态势  |每个风险领域的时间长度和日志的重要性是不同的，因此存储策略时需依据日志的风险态势。  | || 关注各种日志来源和生成日志的大小  |针对防火墙、服务器、数据库、web代理服务器，不仅基于需求，也基于日志的体积及每条日志记录的大小和类型，例如主防火墙会生成大量的内容，因此为了满足此数据长期存留的需求，通常只存留30天的日志，然而，应该仔细评估某些组织的依从性需要以及主防火墙的关键程度决定是否采取更长的存留周期。 | |
| 评估可用的存储选项  |日志的存储选项包括硬盘、DVD、RDBMS、日志特定存储，以及基于云的存储。这方面的决策主要取决于价格、容量、访问速度，最重要的是以合理的周期得到日志记录的能力。 日志系统，主要采用基于云的存储方式。  | |
存储时间
对信息系统的日志存储时间有法律法规要求的，按法律法规要求。无特殊要求的，所有日志存储时间不少于6个月，主要系统的日志存储时间策略规则如下： 
| 日志类型 | 设备 | 日志内容类型 | 参考在线查询时间 | 参考存档时间 ||---|---|---|---|---|
| 服务器类日志 |服务器 |错误日志 |7天 |1年 |
| 服务器类日志 |服务器 |安全类日志 |7天 |1年 |
| 服务器类日志 |服务器 |运行状态类 |7天 |1年 |
| 服务器类日志 |服务器 |其他 |7天 |1年 |
| 网络和安全产品类日志 |交换机、路由器 |运行日志 |7天 |6个月 |
| 网络和安全产品类日志 |防火墙 |攻击类 |7天 |6个月 |
| 网络和安全产品类日志 |防火墙 |运行状态类 |7天 |6个月 |
| 网络和安全产品类日志 |防火墙 |其他 |7天 |6个月 |
| 网络和安全产品类日志 |入侵防御系统IPS |入侵保护 |7天 |6个月 |
| 网络和安全产品类日志 |入侵防御系统IPS |系统事件 |7天 |6个月 |
| 网络和安全产品类日志 |入侵防御系统IPS |防病毒事件 |7天 |6个月 || 网络和安全产品类日志 |入侵防御系统IPS |Web安全事件 |7天 |6个月 |
| 网络和安全产品类日志 |入侵防御系统IPS |其他 |7天 |6个月 |
| 网络和安全产品类日志 |Web应用防护系统WAF |系统日志 |7天 |6个月 |
| 网络和安全产品类日志 |Web应用防护系统WAF |Web访问日志 |7天 |6个月 |
| 网络和安全产品类日志 |Web应用防护系统WAF |ARP防护日志 |7天 |6个月 |
| 网络和安全产品类日志 |Web应用防护系统WAF |Web安全日志 |7天 |6个月 |
| 网络和安全产品类日志 |Web应用防护系统WAF |其他 |7天 |6个月 |
| 数据库和中间件类日志 |数据库 |数据库服务日志 |30天 |3年+满足行业规范 |
| 数据库和中间件类日志 |数据库 |数据库审计日志 |30天 |3年+满足行业规范 || 数据库和中间件类日志 |数据库 |其他 |30天 |3年+满足行业规范 |
| 数据库和中间件类日志 |中间件 |访问日志 |30天 |3年+满足行业规范 |
| 数据库和中间件类日志 |中间件 |Web服务器日志 |30天 |3年+满足行业规范 |
| 数据库和中间件类日志 |中间件 |其他 |30天 |3年+满足行业规范 |
| 应用系统类日志 |应用系统日志 |系统运行日志 |30天 |3年+满足行业规范 |
| 应用系统类日志 |应用系统日志 |错误日志 |30天 |3年+满足行业规范 |
| 应用系统类日志 |应用系统日志 |审计操作日志 |30天 |3年+满足行业规范 |
| 应用系统类日志 |应用系统日志 |其他 |30天 |3年+满足行业规范 |
| 应用系统类日志 |文件类 |操作和错误日志 |30天 |3年+满足行业规范 |
| 终端类日志 |终端类 |终端信息 |7天 |3年+满足行业规范 || 终端类日志 |终端类 |终端信息 |7天 |3年+满足行业规范 |
存储格式
原始日志在多数情况下采用基于文本的日志文件、二进制文件、数据库存储方式来实现原始日志的存储。通过对原始文本日志的收集和处理，统一将所有日志格式规范为文本形式，保存在日志系统中。
日志系统的存储采用大数据分布式存储架构，结合可用性、数据存储量大小、搜索分析效率、成本投入等综合因素。
日志使用规范
日志检索
日志检索的四种方式包括范围查询、正则表达式、NOT/AND/OR布尔值和字段过滤。
范围查询：可快速发现满足一定条件参数的事件，例如检索Apache Web服务器响应时间大于200ms的事件。
正则表达式：可以定义查询模版来简化你的搜索输入。
AND/OR/NOT布尔值：利用AND、OR、NOT和( )的组合，用户可以自由构造各种复杂的组合查询语句。字段过滤：字段过滤快速显示用户所有结构化和半结构化字段，点击其中的字段值进行过滤操作，可快速缩小事件的查询范围。
可以根据用户角色信息设定其能检索的日志类范围，不同用户可检索不同的日志主题类型，检索内容包含日志记录规范中记录的日志内容，同时包含原始日志信息。
日志数据可视化
用户自定义数据可视化图表分析，可完成如下类数据可视化分析。
事件计数：展示日志中某个字段在一个特定的查询范围内的数量，可以进行独立统计和对比分析，可根据展示效果选择合适的图表。
时间分段：统计某段时间范围内日志内容中指定的字段的最大值，最小值、平均值等，可选择用于展示的图表类型。
数值分段：分析展示日志中的数值字段的事件统计情况，可添加多个数值分段值，例如appache日志中的status字段，可针对该字段进行制定范围的数值分段统计。
时间直方图：以秒、分、小时、天、周为维度，展示特定日志的时间直方图统计，以柱形图作为呈现的效果。数值直方图：统计展示日志中的数值字段，以某个数值为时间间隔为单位的变化情况。
字段分类：展示日志中的描述类别的字段的TOP排名情况。
字段数值统计：统计分析日志的数值字段的最大值、最小值、平均值及总数情况。
累计百分比：统计日志中置顶字段数值在特定时间范围和指定的百分比分段中所的分布情况， 
多级统计：实现分析的逐步钻取。
地理分布：展示日志数据反映的地理分布情况（例如：攻击行为）。
日志导出
提供对原始日志和规范后的日志的导出功能，系统在线最大可导出约2000条日志，存储格式为csv格式文件。通过对API的调用可导出日志数据。
日志导出有日志和审计功能。
对外接口
对外告警事件发送接口。
事件频率告警 
支持事件频率告警，在一个设定的时间范围内触发告警的阈值数。例如，可以设置告警条件为 10 分钟内某个事件结果计数超过 20 次。
基于顺序发生的关联告警基于顺序发生的关联告警 
支持基于顺序发生的多日志源关联告警规则，可统计告警设定的时间范围内，多数据源某种事件按顺序发生的情况。例如，可以设置告警条件为 10 分钟内入侵检测某个 IP 下载二进制文件事件，然后在此主机上出现用户权限变更操作事件。
基于同时发生的关联告警 
支持基于同时发生的多日志源关联告警规则，可统计告警设定的时间范围内，多数据源某种事件同时发生的情况。
基于未同时发生的关联告警 
支持基于未同时发生的多日志源关联告警规则，可统计告警设定的时间范围内，多数据源某种事件未同时发生的情况。
通过与第三方程序对接的方式发送告警，可支持syslog、SNMP、TCP等多种协议的发送方式，告警信息包含如下关键信息：告警名称、告警描述、日志主题、告警类型、告警方式、告警字段、检测频率，备注说明等。
日志提供接口日志提供接口
采用稳定的TCP方式持续提供日志分析结果以及原始日志数据。日志提供接口包含如下关键信息：日志提供方信息、发送时间、发送目标信息、发送方式、日志信息内容等。
日志安全
日志记录和存储应考虑的安全敏感信息有特殊的处理。不能在日志信息里包含安全敏感信息，应该进行脱敏处理输出。例如密码不输出或者使用******代替，身份证或者账号中间8位使用**** ****替代。不能用*号替代的，应该做加密处理。
包括但不限于如下信息，在记录日志时应进行特殊处理，特殊处理时为排查异常和错误方便可以保存相应的关联线索数据。
| 特殊处理的日志内容 | 解释 | 备注 |
|---|---|---|
| 密钥密码信息 |是指用于确保数据机密性、完整性或用于身份验证的密码、密钥信息。 | |
| 客户敏感信息 |是指各信息系统涉及的自然人客户信息和法人及非法人组织息。包括客银行账户、金融余额、个人隐私信息等。 | || 敏感技术信息 |例如防火墙等需保密的安全配置等 | |
| 其他敏感和安全信息 |其他敏感和不应在日志暴露的信息，这类信息一般可以通过数据库、特殊安全措施等实现相应的功能需求 | |
定义、术语与缩写，标准与规范
| 名词术语 | 解释 |
|---|---|
| 时间服务器 |企业内认可的记录时间的服务器。一般此服务器和权威的国家服务器时钟保持同步。 |
| 日志分类 |根据日志的应用要求的日志分类方法。比如日志文件分为错误信息err日志和一般信息out日志。 |
| 日志分级 |是指信息系统的日志记录级别。本规范按DEBUG、INFO、WARN、ERROR、FATAL五级分类。应用系统日志输出可以按照日志级别配置参数进行动态调整，原则上无需重启应用。 |
| 日志记录、采集、存储原则 |法律合规性、必要性、实用性。 |