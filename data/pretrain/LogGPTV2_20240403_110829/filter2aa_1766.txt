For	
  little	
  or	
  no	
  money…	
What	
  is	
  a	
  Security	
  Opera0ons	
Center	
  (SOC)	
Events	
IDS	
Management	
System	
Analyst	
Systems	
Analysts	
Contextual	
Info	
Reporting	
Incident	
Response	
Why	
  do	
  you	
  need	
  a	
  SOC?	
Central	
  location	
  to	
  collect	
information	
  on	
  threats	
• External	
  Threats	
• Internal	
  Threats	
• User	
  activity	
• Loss	
  of	
  systems	
  and	
  personal	
  or	
sensitive	
  data	
• Provide	
  evidence	
  in	
  investigations	
Keep	
  your	
  organization	
  running	
• Health	
  of	
  your	
  network	
  and	
  systems	
Isn’t	
  a	
  Firewall,	
  IDS	
  or	
  AV	
  enough?	
  Firewall	
  is	
  active	
  and	
  known	
  by	
  attackers	
  Protects	
  your	
  systems,	
  not	
  your	
  users	
  Anti-­‐Virus	
  Lag-­‐time	
  to	
  catch	
  new	
  threats	
  Matches	
  ﬁles,	
  but	
  not	
  traﬃc	
  patterns.	
  IDS	
  alerts	
  on	
  events,	
  but	
  doesn’t	
  provide	
  context	
  System	
  logs	
  Proxy	
  logs	
  DNS	
  logs	
  Information	
  from	
  other	
  people	
Private	
Network	
People	
Management	
Users	
Other	
  Experts	
Analysts	
Lab	
Analyst	
  Systems	
Management	
Systems	
IDS	
Structure	
  of	
  a	
  SOC	
vs	
Techie	
  using	
  real-­‐time	
  tech	
  24/7	
Private	
  network	
  Secure	
  communication	
  between	
  IDS	
  Management	
  System	
  Analyst	
  Systems	
  Management	
  and	
  update	
  of	
  IDS	
  and	
  rules	
IDS	
  system	
Secured	
  OS	
IDS	
  Software	
• Snort	
• Barnyard2	
• Pulled	
  Pork	
• stunnel	
Packet	
  capture	
• TCPDump	
• Daemonlogger	
Management	
  system	
Secured	
  OS	
LAMP	
Management	
Software	
•  BASE,	
  Snorby,	
  OCCIM,	
Splunk,	
  Nagios,	
  etc.	
Analyst	
  Systems	
Secured	
  OS	
Management	
System	
  Interface	
Analysis	
  tools	
• Wireshark	
• Tcpdump	
• Netwitness	
But	
  I	
  thought	
you	
  wanted	
  a	
  secure	
system!	
Lab	
  Test	
  system	
  Test	
  rules	
  on	
  the	
  IDS	
  Test	
  Conﬁguration	
  changes	
  Can	
  be	
  used	
  as	
  a	
  backup	
  A	
  safe	
  environment	
  to:	
  Play	
  with	
  malware	
  Try	
  hacks	
These	
  activities	
  can	
  help	
  you	
  to	
  discover	
  the	
  criteria	
  to	
  build	
custom	
  rules	
  for	
  the	
  IDS.	
It’s	
  probably	
  a	
  good	
  idea	
  to	
  use	
  VM’s	
  for	
  your	
  lab.	
Analysts	
  (the	
  meat	
  of	
  the	
  opera0on)	
  You	
  need	
  highly	
  skilled	
  people	
  who:	
Know	
  networking	
Understand	
  attacks	
Understand	
  Malware	
Are	
  comfortable	
  with	
things	
  like	
  source	
code,	
  hex,	
  etc…	
Are	
  open	
  to	
  new	
  ideas	
Are	
  creative	
  thinkers	
Are	
  good	
  at	
  deductive	
reasoning	
  and	
  critical	
thinking	
Have	
  a	
  passion	
  for	
  this	
Don’t	
  blink	
Don’t	
  ever	
  call	
  in	
  sick	
Don’t	
  need	
  sleep	
Love	
  to	
  keep	
  learning	
Other	
  experts	
  System/Network	
  Administrators	
  Keep	
  the	
  whole	
  thing	
  working	
  Tune	
  IDS	
  rules	
  Forensics	
  Experts	
  For	
  more	
  in-­‐depth	
  analysis	
  Incident	
  Response	
  To	
  mitigate	
  incidents	
  after	
  they	
  happen	
  External	
  entities	
  Government,	
  law	
  enforcement,	
  etc…	
Users	
  (the	
  other	
  white	
  meat)	
  Report	
  things	
  Phishing	
  emails	
  Stolen	
  property	
  Loss	
  of	
  data	
  Do	
  things	
  Download	
  malware	
  Engage	
  in	
  inappropriate	
  activities	
  The	
  most	
  widely	
  deployed	
  IDS	
  you	
  have	
  If	
  “tuned”	
  properly…	
Management	
  To	
  interface	
  with	
  other	
  entities	
  Keep	
  all	
  the	
  pieces	
  from	
  falling	
  apart	
  Make	
  it	
  rain	
  (decide	
  who	
  gets	
  the	
  money)	
  I	
  guess	
  someone	
  has	
  to	
  make	
  decisions...	
Network	
  Events	
Log	
  ﬁles	
•  Firewalls	
•  Hosts	
•  Proxy	
  Servers	
•  DNS	
  Servers	
Phone	
  calls/
emails/
other	
sources	
The	
  data	
Handling	
  all	
  that	
  data	
All	
  that	
  data!	
Filtering	
False	
  Positives	
Thresholding	
Categorization	
Categoriza0on	
Category	
Name	
CAT	
  0	
Exercise/Network	
  Defense	
  Testing	
CAT	
  1	
Successful	
  unauthorized	
  Access	
CAT	
  2	
Denial	
  of	
  service	
CAT	
  3	
Successful	
  installation	
  or	
  post-­‐install	
  beaconing	
  of	
  malicious	
  code	
CAT	
  4	
Improper	
  Usage	
CAT	
  5	
Scans/probes/Attempted	
  Access	
CAT	
  6	
Investigation	
US-­‐CERT	
  Recommends	
  the	
  following	
  categories	
  for	
  events	
Analyzing	
  something	
  like	
  malware	
Mi0ga0on/Incident	
  Response	
  User	
  education	
  User	
  access	
  controls	
  Stop	
  giving	
  users	
  administrative	
  access	
  Proxy	
  servers	
  and	
  ﬁrewalls	
  Deny	
  access	
  to	
  known	
  bad	
  sites	
  Deny	
  certain	
  kinds	
  of	
  downloads	
  Block	
  posting	
  to	
  known	
  bad	
  IP’s