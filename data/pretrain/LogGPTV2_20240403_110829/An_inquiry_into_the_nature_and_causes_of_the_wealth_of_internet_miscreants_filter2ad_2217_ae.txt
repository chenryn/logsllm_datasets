o
H
d
e
k
c
a
H
l
i
e
a
S
n
m
d
A
p
o
h
S
t
n
a
W
2
V
V
C
t
n
a
W
l
a
P
y
a
P
l
e
a
S
l
t
i
o
p
x
E
t
n
a
W
C
C
h
s
e
r
F
t
n
a
W
t
o
o
R
t
n
a
W
o
f
n
I
l
l
u
F
t
n
a
W
t
c
c
A
r
e
h
t
O
i
t
n
a
W
n
m
d
A
p
o
h
S
Ad Type (Goods)
t
n
a
W
t
s
i
l
l
i
a
m
E
t
n
a
W
m
a
c
S
t
n
a
W
y
t
i
t
n
e
d
I
l
e
a
S
p
m
u
D
t
n
a
W
l
t
i
o
p
x
E
t
n
a
W
t
c
c
a
_
d
o
g
−
E
l
l
e
a
S
d
o
o
G
.
y
h
P
t
n
a
W
t
n
u
o
c
c
A
k
n
a
B
t
n
a
W
e
t
i
l
S
e
b
a
d
r
a
C
l
e
a
S
t
e
n
t
o
B
t
n
a
W
t
e
n
t
o
B
l
e
a
S
r
e
h
t
O
t
n
a
W
p
o
r
D
t
n
a
W
p
m
u
D
l
e
a
S
y
t
i
t
n
e
d
I
t
n
a
W
r
e
h
t
O
t
n
a
W
d
o
o
G
.
y
h
P
l
e
a
S
e
t
i
l
S
e
b
a
d
r
a
C
l
e
a
S
t
c
c
A
c
r
e
M
t
n
a
W
t
c
c
A
c
r
e
M
Figure 12: Distribution of ads for goods in labeled data.
4.1 Goods
Ads for Goods: Measurement Methodology. Amongst the most
common goods sold in the market are online credentials such as
bank logins and PayPal accounts, sensitive data such as credit cards
and SSNs, compromised machines, spamming tools including mail-
ing lists and open mail relays, and scam webpages used for phish-
ing.
Ads for Goods: Measurement Results. Figure 12 shows the dis-
tribution of ads for goods from the labeled dataset. Sales ads out-
number want ads more than 2 to 1.
Having already established the extent to which sensitive data
such as credit cards and SSNs constitute a large percentage of chan-
nel activity, we turn our attention to digital goods related to hack-
ing, spamming and phishing. Ads for hacking-related goods in-
clude hacked hosts, root accounts, compromised e-merchant ac-
counts, and software exploits. Ads for spam-related goods include
web page email forms which can be used for spamming and bulk
email lists. Ads for phishing-related goods primarily include scam
webpages.
4.1.1 Hacking Related
Hacking-Related Ads: Measurement Methodology. The most
common hacking-related ads are those for compromised hosts. Sales
ads for hacked hosts and root accounts constitute 5.39% of the
labeled data while want ads for hacked hosts and root accounts
constitute 1.85% of the labeled data. To determine the accuracy
of these percentages as estimators for the percentage of compro-
mised host want and sales ads for the entire corpus, we train two
binary text classiﬁers to identify want and sales ads for compro-
mised hosts. We train the classiﬁers using positive and negative
examples of hacked host and root sales (want) ads from the train-
ing set, respectively.
We evaluate the performance of both classiﬁers with the remain-
ing 30% of labeled data in the test set. We report both preci-
PredictedPositives and Recall =
sion and recall where Precision = CorrectPositives
CorrectPositives
ActualPositives . We set the positive error penalization (-j option) to
3 and 8, respectively, to cause training errors on positive examples
to outweigh errors on negative examples. This penalization was
necessary to prevent the text classiﬁer from achieving a high ac-
curacy by always labeling messages as negative examples, erring
only on the relatively infrequent positives examples. The compro-
mised host sales ad classiﬁer achieve a precision of 68.4% and a
recall of 42.6%. The compromised host want ad classiﬁer achieve
a precision of 57.1% and a recall of 38.1%. In both cases, we chose
classiﬁers with a higher precision and lower recall to limit the num-
ber of false positives. Higher recall percentages are possible if we
allow for a lower precision, however this causes an inﬂation in the
number of predicted positives. Even with their less than perfect
classiﬁcation accuracy, these classiﬁers efﬁciently ﬁlter the corpus
and reduce the work required in subsequent analysis.
Hacking-Related Ads: Measurement Results. We use the re-
sulting text classiﬁers to label the 13 million unlabeled messages
as either want ads for compromised hosts, sales ads for compro-
mised hosts, or neither. We scale the measurements derived from
the labeled output by the precision/recall ratio to roughly estimate
the true positives in the corpus. When estimating values, we assume
that errors are uniformly distributed over the dataset and that the er-
ror rates on the test set carry over to the entire corpus. Figure 13(a)
shows the results of the want ad classiﬁer and Figure 13(b) shows
the results of the sales ad classiﬁer.
The sales ad classiﬁer identiﬁed an extrapolated 4.8% of the total
corpus as sales ads for compromised hosts, with an absolute error
of 0.59% from the previous estimate. The want ad classiﬁer identi-
ﬁed an extrapolated 2.6% of the total corpus as want ads for com-
promised hosts, with an absolute error of 0.75% from the previous
estimate.
4.1.2 Spam and Phishing Related
As seen in Figure 12, the majority of spam and phishing-related
ads in the labeled dataset are sales ads offering bulk email lists
and sales offers for URLs of web email forms vulnerable to “email
injection attacks.” An email injection attack exploits the input val-
idation of web email forms such as the ubiquitous contact us form
to include additional recipient email addresses. Rather than simply
being sent to the individual responsible for the contact form, the
web server sends the message to a list of injected addresses. The
ease with which vulnerable email forms can be found has produced
a bustling trade of such mailers. Mailer sales ads are the fourth
s
d
A
t
n
a
W
i
t
s
o
H
d
e
s
m
o
r
p
m
o
C
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 0
Unique
Total
s
d
A
s
e
a
S
l
i
t
s
o
H
d
e
s
m
o
r
p
m
o
C
Unique
Total
 16000
 14000
 12000
 10000
 8000
 6000
 4000
 2000
 150
 200
 0
 0
 50
 100
Days
(a) Want Ads
 50
 100
Days
(b) Sales Ads
 150
 200
Figure 13: Extrapolated number of ads for compromised hosts.
most common type of ad for all goods, with bulk email list sales
ads as the seventh most common. Vulnerable mailers ease the job
of spammers who might otherwise have to locate open mail relays
or employ bots to send spam. Email lists created by crawling web-
pages with email spiders or extracted from customer databases of
compromised e-merchants further ease the job of spammers by en-
abling targeted spam campaigns.
4.1.3 Online Credentials and Sensitive Data
An extensive number of ads for online credentials from bank ac-
count logins to PayPal accounts were identiﬁed in the labeled data
(See Figure 12.). In addition, want and sale ads for credit cards with
associated information (cvv2, name, address, and answers to chal-
lenge questions) were common. Value-added features associated
with credit card data include the freshness of the data and com-
pleteness of the associated information. Credit cards with cvv2
validation codes and full owner information which were recently
acquired (fresh) garner a premium. Such cards are more ﬂexible
than cards with limited owner information or cards without their
associated validation codes.
t
a
a
D
d
e
e
b
a
L
l
f
t
o
e
g
a
n
e
c
r
e
P
3
2.5
2
1.5
1
0.5
0
l
e
b
a
l
i
a
v
A
i
r
e
h