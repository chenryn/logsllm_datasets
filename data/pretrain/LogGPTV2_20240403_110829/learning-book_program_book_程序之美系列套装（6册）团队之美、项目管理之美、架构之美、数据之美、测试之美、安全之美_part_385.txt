## Page 2222
1.3.3降低成本与未来收益：能源实例
我的工作有一部分涉及详细检查各家电力公司的后端控制系统，有
时候还包括石油公司的后端系统。我评估了它们与其他系统和网络
的相互联系是如何被保护和跟踪的。令人吃惊的是，石油和电力行
业虽然使用了相似的系统和协议，但它们在配置和安全方面的操作
和运行存在极大的差别。
换种礼貌的说法，电力公司的网络是一团糟。电力控制系统和网络
可以通过公共的Internet访问。用于通用的系统由许多任务所共享，
文字处理和其他日常工作与那些关键的功能混杂在一起，后者应该
局限于专用的系统内部，以防止操作的潜在干扰和破坏。在好几个
地方，系统和网络的布局随心所欲，根本没有考虑过优化的甚至是
准确的操作。实现者在完成一项任务之后就转移到另一项工作。许
多电力控制网络、电力信息网络和公司LAN没有配备防火墙或阻塞
点。从安全的角度出发，所有这些因素结合在一起，可能导致恶意
入侵者潜入后大搞破坏，包括操纵或破坏电力的生产和传输过程所
使用的物理组件。
相反，我所观察的几个近海石油系统虽然也利用了类似的SCADA系
统，却采取了不同的配置和操作方式。电力控制和信息网络严格与
公司的LAN分享。大多数关键系统进行了正确的设置，使它们的结
果和状态由一个管理系统进行处理，然后用一种类似二极管的风格
把信息推向更高的分析系统。简洁和高效的网络图导致物理世界中
的SCADA和DCS系统可以被清晰、整洁地实现，包括对访问的限
制，有效地提高了安全性。在许多场合，组件是自定义的系统，被
设计和配置用来执行特定的功能山。
电力和石油公司之间的反差令我感到好奇和困惑。仿佛是命运的安
排，我的职位使我能够与电力公司、石油公司和政府部门的高级技
术人员一起开会讨论这个主题。
在会议中，首先令我感到惊奇的是来自电力系统以及电力系统监管
和结算组织的人们，他们并没有反驳我对他们的网络和系统的不良
（或者说完全不存在的）安全所作出的论断。这令我感到吃惊，因
为电力公司在公开场合总是否认它们存在任何网络系统风险。在会
议中，他们指出了一些已经正确地实现了安全的例子，但他们承认
这些例子只是例外，并不是普遍现象。
2221
---
## Page 2223
我的第二个惊奇来自石油公司，他们表示根本没有站在安全的角度
设计他们的系统。尽管安全非常重要，但它并不是正确配置系统的
商业推动力。主要的推动力来自它们的直接竞争对手的压力。
如果A公司在关键组件操作的效率能够比B公司高出5%，经过一段时
间之后，增加的操作能力或减少的开销可以使A公司赚得大笔的钱。
提高这种效率的例子包括：
系统的强制分离，防止关键系统由于管理和报告请求所执行的查询
而增加额外的延迟。
利用特殊用途的专门完成特定任务的系统替换通用目的的非优化系
统。
这些效率改进措施同时也改善了安全。第一个措施在网络和系统中
创建了强大、干净和可实施的边界。第二个措施使系统的表面区域
变小，从而增加了攻击的难度。
可实施的网络和系统边界的效果显而易见，但更小的表面区域这个
情况则值得稍加解释。想象一个具有默认配置的通用目的的系统。
默认配置可能已经有儿个配置并正在运行的服务，以及许多正在执
行的协助用户处理的后台进程。这就允许用最大数量的设置对系统
进行部署，并最大限度地减少重新配置的数量。系统的生产商希望
这样的系统具有更厂的功能，因为这样可以使安装更为方便。
但是，这并不意味着默认设置对于消费者主体都是优化的，只不过
是可以接受而已。在默认设置中，每个正在运行的服务都是一个攻
击表面，可能会遭到攻击。与此类似的是客户应用程序可能由于来
自被盗用或虚假的服务器的恶意输入而被盗用。系统所运行的服务
和客户应用程序越多，系统的攻击表面就越大，被远程或本地盗用
的可能性也就越大。
虽然具有较大的攻击表面不是件好事情，但是石油公司所关心的基
本缺点实际上是系统的性能不够理想。对于每个正在运行的程序，
包括服务器所提供的服务以及本地应用程序，处理时间是由内核和
CPU贡献的。如果有许多正在运行的应用程序，系统就不得不为它
们划分时间片，这是一种本身就会消耗资源的内核活动。
但是，如果正在运行的应用程序数量很少，那么每个应用程序可以
拥有更多数量的CPU时间片，实现更佳的性能。对系统进行瘦身的
2222
---
## Page 2224
一种简单方法是删除多余的服务和应用程序，对系统进行优化，使
它尽可能以最专一的方式运行。另一种方法是系统部署为专门实现
特定的功能，不提供运行不相关任务的功能。这些策略在我已经检
查过的近海石油公司中使用，以便最大限度地提高性能，并因此增
加了利润。
为什么电力企业不采取与石油公司相同的做法呢？首先，电力公司
是受控制的垄断企业。这个行业并不存在什么竞争，因此它们就没
有动力设计优化和严格结构化的环境。
人们可能忍不住假设如果取消对电力行业的控制，把电力公司放在
竞争环境中会不会提高它们的效率并因此提高它们的安全性（按照
与石油公司相同的路径）。但是，事态的发展恰好相反。当电力公
司放松管制时，它们意识到需要采取削减成本的措施以保持竞争
力。结果，它们的第一个步骤就是削减劳动力。它们让更少的人维
护和操作相同数量的本地和远程系统（常常通过远程访问技术），
把注意力集中在每天都要进行的操作，而不是高瞻远瞩地看到长期
的需要。这通常是提高效率或安全的不佳方案。
石油公司的故事证实了我在1.3.2一节中对ISP所作的评论。大多数组
织把安全看成是一种令人不快的成本，至少到目前为止它们大都是
这样想的。按照这种方式实现的安全很可能是不充分或糟糕的。但
是，如果有的公司将网络和系统的功能进行优化和流水化，以实现
特定的商业自的，那么它们常常可以以副产品的形式实现优质的安
全。同样，安全专业人员可以把克服他们对安全的功能锁定作为一
个崇高的目标，直到觉得安全本身值得花费大量的资金，而不是把
安全看成是一种偶然的副产品。
山1值得注意的是，我只分析了那里的一小部分石油和电子系统。这
里所归纳的区别是出于比较的目的，以说明功能锁定以及它是如何
影响公司对安全的看法的。石油行业也有部分企业存在配置不正确
的系统和环境，这和所有大型行业一样。类似，可能有些地方的电
子企业具有良好配置的电力信息和控制网络。
1.4小结
在本章中，我提供了一些经典的安全失败的例子，并在脱离工具、
实践和个人决策的情况下对它们进行跟踪，以探索如何进行思考的
2223
---
## Page 2225
基本原则。我们可以采用与自然倾向相反的更明智方式应用我们的
资源，以提高安全性。
我们可以保证最初的决定并不会影响创造性的思维，以克服习得性
无助和无从选择。
我们可以寻找不同人群的输入并强制自己试图推翻自己的假设，以
克服确认陷阱。
我们可以通过寻求工具的替代用法并通过其他路径来实现目标，以
克服功能锁定。
所有这些都需要实践。但是对它们进行实践的机会每天都会出现。
如果更多的人致力于此，这种常常称为非比寻常的方法将越来越不
稀奇。
第2章无线网络：社会工程的沃
土
如今，许多人都已经听说过关于无线设备安全的问题。从2000年最
初发布Wi-Fi时，无线设备安全就已经是许多安全专家所关注的领域
了。早在2001年，有线等效保密（WiredEquivalentPrivacy,WEP）访
问协议就被发现存在严重的缺陷。虽然设计这个协议的目的就是为
了阻止非法用户访问无线设备，但是攻击者在几分钟之内就可以绕
过它的安全保护机制。随着2003年Wi-Fi网络安全存取（Wi-Fi
ProtectedAccess,WPA）协议的公布，无线设备的安全性已经得到了
极大的提高。尽管如此，大多数偏执的系统管理员仍然对它的安全
性表示怀疑。尤其是在发现了WPA的几个新的漏洞之后，他们就更
加确信这一点了。虽然它的危险程度不及WEP，但这足以让许多管
理员认为他们的看法是正确的。
虽然仍然有人对无线网络的安全性持怀疑态度，但大多数人在看到
无线技术给生活所带来的便利之后，都接受和认可了这项技术。比
如，给百货公司的员工人手配备一台手持设备，那么他们就能够直
接与机构的服务器联系，快速高效地完成一些与库存有关的工作。
这可以节省大量的时间并提高客户的服务满意度。Wi-Fi也给市政公
共事业注入了新的活力，从咖啡馆到公园都有它的身影。遗憾的
2224
---
## Page 2226
是，人们对一些针对Wi-Fi的攻击场景仍然不是十分清楚，这种攻击
将会引发企业和个人信息被盗的风潮。
本章首先介绍我作为一个专业的安全研究人员是如何探索无线安全
缺陷的，并简单地描述它们所造成的威胁。接看，我继续讨论Wi-Fi
的现状以及它是如何破坏安全的。
2.1轻松赚钱
这是一个日常攻击场景。假设你在美国的一个主要机场稍作停留之
后准备启程时，把目光转向登机监视器寻找自己的入口时，发现每
位旅客都在哀叹：“飞机又延误了。”这时，你已经成为众多“难民”
的一员，将在机场的舒适安静环境中度过接下来的6个小时。这时你
的视线离开监视器，四处搜寻可用的电源插座，以挽救快要没电的
笔记本电池。我经历过很多次这样的搜寻，每次都是慢慢地在整个
区域到处查找，比如每排座位的后面或者是某根杆子的背面。你可
能会注意到，寻找这种隐秘插座的人在路过时，似乎是在盯着你的
脚下，却又做的不是太明显。我觉得这类似于穴居人在寻找火种。
每个人都想拥有它，但只有少数人能够找到，而一旦你找到了，那
么你会极具占有意识。事实上，在不止一个场合，当有人走近时，
我都会哼一声，然后锤打胸口以示强势。
现在，假设你是找到插座的成功人土，然后打开笔记本，将电源插
到插座上，并立即开始搜索无线接入点。现在，大多数机场、宾
馆、咖啡馆甚至是公园都提供了无线接入设备。你只需打开笔记本
电脑，点击无线接入图标，就会弹出一个或多个可供选择的接入
点。当你浏览接入点列表时，看到了一个标题为"T-Mobile"的接入
点。原来，这个机场使用的是这个接入设备，因此你毫不犹豫地选
择了它。几秒钟之后，你打并了一个网页浏览器。此时显示的不是
你的主页，而是T-Mobile的页面，它让你选择是使用已有的T-Mobile
账号登录还是创建一个新的账号。
由于你并没有账号，所以点击创建了一个新的账号，这时会发现所
需价格是9.99美元一天。虽然这个价格不是太恐怖，但你刚才注意
到还有其他的无线接入点，所以你决定看看其中是否碰巧有免费
的。你再次点击无线图标，然后看到列表中还有其他三个接入点。
其中有两个是加了锁并且需要正确的密钥才能连接，但有一个标题
为WiFly的是开放的。然后你选择了WiFly，这一次重定向到的是
WFly的登录页面，上面给出的价格仅为1.99美元。让你感到高兴的
2225
---
## Page 2227
是，你刚刚节省了8美元，这时你拿出信用卡，填写在线表单，然后
点击提交，瞧，你现在正在浏览互联网。
别的也没有什么事可做，所以你决定通过在线网页接口来检查你的
电子邮件。输入网站的网址后敲回车。突然一个错误消息弹出，告
诉你网站的安全证书有问题。只有在浏览需要加密访问的网站时才
会用到安全证书。这时你才会意识到这个网站是使用加密会话的，
因为网站链接是以https://开头的，而不是http://。
此外，你还会注意到浏览器的状态栏上有一个闭合的锁，这表示该
页面也是加密的。但是，错误消息表明这个网站的安全证书不是由