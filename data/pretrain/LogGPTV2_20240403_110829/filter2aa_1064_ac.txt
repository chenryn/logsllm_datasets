–  Improper,Privilege,Management,
–  Improper,Authen:ca:on,
•  Zero,Day,Ini:a:ve,case,study,
–  Advantech,WebAccess,Case,Study,
Copyright,2016,Trend,Micro,Inc.,
40,
0'day,Vulnerability,Case,Study,
•  Vulnerability,details,will,be,disclosed,during,the,talk,at,the,
DEF,CON,conference,
•  Expected,to,patch,before,the,conference,
•  If,it,is,not,patched,,we,will,release,the,details,publically,in,
accordance,with,the,Zero,Day,Ini:a:ve,Vulnerability,
Disclosure,Policy,
Copyright,2016,Trend,Micro,Inc.,
41,
Injec:ons,
•  9%,of,iden:ﬁed,vulnerabili:es,
•  Common,vulnerability,types,
–  SQL,Injec:on,
–  Code,Injec:on,,
–  OS,Command,Injec:on,
–  Command,Injec:on,
•  Zero,Day,Ini:a:ve,case,study,
–  Cogent,DataHub,Gamma,
Command,Injec:on,
Remote,Code,Execu:on,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
42,
,
Cogent,DataHub,Case,Study,
•  ICS'CERT,states:,
–  “allow,an,ahacker,to,turn,on,an,insecure,processing,mode,in,the,
web,server,,which,subsequently,allows,the,ahacker,to,send,
arbitrary,script,commands,to,the,server”,
•  Iden:ﬁers,
–  CVE'2015'3789,
–  ZDI'15'438,
–  ICSA–15–246–01,
•  CVSS,
–  7.5,
•  Disclosure,Timeline,,
–  2015–06–02,',Reported,to,vendor,,
2015–09–08,–,Coordinated,release,
•  Credit,
–  Discovered,by:,Anonymous,
–  Disclosed,by:,Zero,Day,Ini:a:ve,
Copyright,2016,Trend,Micro,Inc.,
43,
,
Cogent,DataHub,Overview,
Copyright,2016,Trend,Micro,Inc.,
44,
Gamma,Script,Overview,
•  Gamma,is,DataHub’s,scrip:ng,language,
•  Dynamically'typed,interpreted,programming,language,
speciﬁcally,designed,to,allow,rapid,development,of,control,
and,user,interface,applica:ons,
•  Gamma,has,a,syntax,similar,to,C,and,C++,,but,has,a,range,of,
built'in,features,that,make,it,a,far,beher,language,for,
developing,sophis:cated,real':me,systems,
Copyright,2016,Trend,Micro,Inc.,
45,
Ahacker'Supplied,Script,Evalua:on,
•  Flaw,exists,within,the,EvalExpresssion,method,
–  Allows,for,execu:on,of,ahacker,controlled,code,
•  Remotely,accessible,through,the,AJAX,facility,
–  Listening,on,TCP,port,80,,
•  Supplying,a,specially,formahed,Gamma,script,allows,for,the,
execu:on,of,arbitrary,OS,commands,
Copyright,2016,Trend,Micro,Inc.,
46,
Vulnerable,Code,
Copyright,2016,Trend,Micro,Inc.,
47,
Exploita:on,Steps,
1.  Send,a,request,to,any,Gamma,script,to,load,necessary,
libraries,
2.  Call,AJAXSupport.AllowExpressions,and,set,
allow_any_expression,to,True,,
3.  Call,AJAXSupport.EvalExpression,method,and,pass,in,the,
script,that,you,want,executed,
Copyright,2016,Trend,Micro,Inc.,
48,
Exploita:on,Demo,
Copyright,2016,Trend,Micro,Inc.,
49,
Patch,Analysis,
Copyright,2016,Trend,Micro,Inc.,
50,
Researcher,Guidance,,
Copyright,2016,Trend,Micro,Inc.,
51,
Basic,Fuzzing,
•  Simple,bit'ﬂipping,fuzzing,is,highly,eﬀec:ve,against,HMI,
–  Look,for,new,ﬁle,associa:ons,during,installa:ons,
•  Don’t,forget,to,enable,page,heap,to,ﬁnd,heap,corrup:on,
–  gﬂags.exe,/i,hmi.exe,+hpa,+ust,
•  Leverage,exis:ng,tools,and,frameworks,
–  radamsa,
–  sqlmap,
Copyright,2016,Trend,Micro,Inc.,
52,
MicrosoT’s,Ahack,Surface,Analyzer,
•  Released,in,2012,
•  Creates,snapshots,before,and,aTer,installa:on,
•  Highlights,security,misconﬁgura:ons,
–  Registry,sejngs,and,ﬁle,permissions,
•  Provides,a,list,of,auditable,system,modiﬁca:ons,
–  COM,objects,
–  Ac:veX,controls,
–  File,associa:ons,
–  RPC,endpoints,
Copyright,2016,Trend,Micro,Inc.,
53,
Ahack,Surface,Analyzer,Report,
Copyright,2016,Trend,Micro,Inc.,
54,
Ahack,Surface,Analyzer,Report,
Copyright,2016,Trend,Micro,Inc.,
55,
Audit,for,Banned,APIs,
•  C,run:me,has,many,APIs,with,serious,security,programs,
•  MicrosoT,banned,use,of,problema:c,C,library,func:ons,
–  “The,Security,Development,Lifecycle”,(MicrosoT,,2006),
–  Security,Development,Lifecycle,Banned,Func:on,Calls,,
hhps://msdn.microsoT.com/en'us/library/bb288454.aspx,
•  Depressingly,common,in,HMI,code,,with,predictable,
nega:ve,impacts,
•  IDA,is,extremely,valuable,tool,for,audi:ng,for,inappropriate,
uses,,
Copyright,2016,Trend,Micro,Inc.,
56,
Disclosure,Sta:s:cs,
Copyright,2016,Trend,Micro,Inc.,
57,
Vulnerability,Exposure,Windows,
0,
20,
40,
60,
80,
100,
120,
140,
160,
180,
2013,
2014,
2015,
2016,
Copyright,2016,Trend,Micro,Inc.,
58,
Vendor,Response,Times,
0,
50,
100,
150,
200,
250,
ABB,
Advantech,
Codesys,
Cogent,
Real'Time,
Systems,
Ecava,
GE,
Honeywell,
IndusoT,
MICROSYS,
PTC,
Rockwell,
Automa:on,
Schneider,
Electric,
Tibbo,
Trihedral,
Engineering,
Ltd,
Unitronics, WellinTech,
Copyright,2016,Trend,Micro,Inc.,
59,
Industry,by,Industry,Comparison,
0,
20,
40,
60,
80,
100,
120,
140,
160,
180,
200,
Business,
Highly'Deployed,
SCADA,
Security,
Copyright,2016,Trend,Micro,Inc.,
60,
Conclusions,
Copyright,2016,Trend,Micro,Inc.,
61,
Go,ﬁnd,bugs!,
•  ICS'focused,malware,ac:vely,exploi:ng,HMI,vulnerabili:es,
•  HMI,codebases,plagued,with,cri:cal,vulnerabili:es,
•  Simple,techniques,can,be,used,to,ﬁnd,vulnerabili:es,
•  Exposure,windows,is,~150,days,leaving,cri:cal,
infrastructure,vulnerable,
Copyright,2016,Trend,Micro,Inc.,
62,
Ques:ons?,
,
,
,
,
,
www.zerodayini:a:ve.com,
@thezdi,