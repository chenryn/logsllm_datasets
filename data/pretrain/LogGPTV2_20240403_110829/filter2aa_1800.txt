Web
Web安全威胁侦测与防护
安全威胁侦测与防护
Roger Chiu
Roger Chiu
邱春树
邱春树
Malware
Malware--Test Lab
Test Lab
http://www.malware
http://www.malware--test.com
test.com
PDF created with pdfFactory Pro trial version www.pdffactory.com
训练大纲
训练大纲
u
u 相关新闻报导
相关新闻报导
u
u 网站被植入恶意程式之展示
网站被植入恶意程式之展示
u
u 2007
2007年
年OWASP
OWASP十大
十大Web
Web资安漏洞
资安漏洞
u
u 网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u 网站被植入恶意程式之侦测
网站被植入恶意程式之侦测
u
u 网站被植入恶意程式之防护
网站被植入恶意程式之防护
u
u 总结
总结
PDF created with pdfFactory Pro trial version www.pdffactory.com
相关新闻报导
相关新闻报导
u
u 2007
2007年
年55月
月21
21日：
日：Google
Google研究报告指出
研究报告指出全
全
球十分之一网站潜藏恶意连结或程式码
球十分之一网站潜藏恶意连结或程式码。
。
这些网站含有“偷渡式下载
这些网站含有“偷渡式下载(Drive
(Drive--by 
by 
Downloads
Downloads”之恶意程式。
”之恶意程式。
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之展示
网站被植入恶意程式之展示
u
u Web
Web资安威胁实例展示
资安威胁实例展示(DEMO)
(DEMO)
PDF created with pdfFactory Pro trial version www.pdffactory.com
2007
2007年
年OWASP
OWASP十大
十大Web
Web资安漏洞
资安漏洞
u
u Cross
Cross--Site Scripting (XSS)
Site Scripting (XSS)
u
u Injection Flaw
Injection Flaw
u
u Malicious File Execution
Malicious File Execution
u
u Insecure Direct Object Reference
Insecure Direct Object Reference
u
u Cross
Cross--Site Request Forgery (CSRF)
Site Request Forgery (CSRF)
u
u Information Leakage and Improper Error 
Information Leakage and Improper Error 
Handling
Handling
u
u Broken Authentication and Session Management
Broken Authentication and Session Management
u
u Insecure Cryptographic Storage
Insecure Cryptographic Storage
u
u Insecure Communication
Insecure Communication
u
u Failure to Restrict URL Access
Failure to Restrict URL Access
PDF created with pdfFactory Pro trial version www.pdffactory.com
与程式码安全品质有关的
与程式码安全品质有关的OWASP 
OWASP 
Web
Web资安漏洞
资安漏洞
u
u Cross Site Scripting (XSS) 
Cross Site Scripting (XSS) –– 跨站脚本
跨站脚本
攻击
攻击
u
u Injection Flaws 
Injection Flaws –– 注入弱点
注入弱点
u
u Malicious File Execution
Malicious File Execution––恶意档案执行
恶意档案执行
u
u Insecure Direct Object Reference 
Insecure Direct Object Reference ––不
不
安全的物件参考
安全的物件参考
u
u Cross Site Request Forgery (CSRF) 
Cross Site Request Forgery (CSRF) ––
跨站冒名请求
跨站冒名请求
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
uiframe
iframe语法
语法
>
u
uExample
Example
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
uJava Script
Java Script语法
语法
document.write
document.write("");
>");
u
uExample(
Example(内容编码
内容编码//加密
加密))
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u VB Script
VB Script语法
语法
u
u Example
Example((内容编码
内容编码//加密
加密))
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u Java Script 
Java Script 变型加密语法
变型加密语法
script>
* 
* malware.txt
malware.txt 可改成任何附档名
可改成任何附档名
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u 影音档
影音档((如
如RM, SWF, WMV
RM, SWF, WMV等
等))语法
语法
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u Malformed ASCII Bypassing
Malformed ASCII Bypassing技术
技术
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之手法
网站被植入恶意程式之手法
u
u Microsoft Security Bulletin MS07
Microsoft Security Bulletin MS07--017: 
017: 
Vulnerabilities in GDI Could Allow 
Vulnerabilities in GDI Could Allow 
Remote Code Execution (925902)
Remote Code Execution (925902)  
u
u Microsoft Security Advisory (935423): 
Microsoft Security Advisory (935423): 
Vulnerability in Windows Animated 
Vulnerability in Windows Animated 
Cursor Handling
Cursor Handling
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之侦测
网站被植入恶意程式之侦测
u
u 在下图中，侦测点是防毒
在下图中，侦测点是防毒//资安软体可以侦
资安软体可以侦
测到这些威胁的时间点
测到这些威胁的时间点
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之侦测
网站被植入恶意程式之侦测
u
u 几乎所有的资安软硬软体皆无法在第一时
几乎所有的资安软硬软体皆无法在第一时
间有效地侦测
间有效地侦测
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之侦测
网站被植入恶意程式之侦测
u
u 使用防毒软体
使用防毒软体
u
u 使用防火墙
使用防火墙
u
u 使用入侵侦测系统
使用入侵侦测系统(IDS)
(IDS)  
u
u 使用入侵预防系统
使用入侵预防系统(IPS)
(IPS)  
u
u 使用
使用MD5
MD5比对使用中与原来档案之完整性
比对使用中与原来档案之完整性
u
u 行为侦测技术已成防毒软体防护技术主流
行为侦测技术已成防毒软体防护技术主流
((与
与Windows Vista
Windows Vista的
的UAC
UAC功能相似
功能相似))
•• http://rogerspeaking.blogspot.com/200
http://rogerspeaking.blogspot.com/200
7/09/blog
7/09/blog--post_3909.html
post_3909.html
PDF created with pdfFactory Pro trial version www.pdffactory.com
网站被植入恶意程式之防护
网站被植入恶意程式之防护
u
u 安装修补程式
安装修补程式((作业系统、应用程式
作业系统、应用程式...)
...)  
u
u 使用防毒软体
使用防毒软体
u
u 使用行为侦测软体
使用行为侦测软体((较不适用于闸道端或伺
较不适用于闸道端或伺
服器端的防毒
服器端的防毒//资安软体
资安软体))
u
u 不随意浏览网站
不随意浏览网站
u
u 建立网站黑名单
建立网站黑名单((最准确的侦测方式
最准确的侦测方式))
PDF created with pdfFactory Pro trial version www.pdffactory.com
总结
总结
u
u 网路如虎口，处处充满危机
网路如虎口，处处充满危机
u
u 知名网站也可能带来危害
知名网站也可能带来危害((最近有很多相关
最近有很多相关
报导，如
报导，如PTT
PTT、
、Hinet
Hinet等等
等等))
u
u 使用者必须提高危机意识
使用者必须提高危机意识
u
u 使用者必须要有正确的资安观念，否则，
使用者必须要有正确的资安观念，否则，
就下一个受害者可能就是你
就下一个受害者可能就是你//你
你
u
u 企业培养资安专业人员之重要性
企业培养资安专业人员之重要性
u
u 一般使用者资安认知教育训练之重要性
一般使用者资安认知教育训练之重要性
PDF created with pdfFactory Pro trial version www.pdffactory.com
联络方式
联络方式
u
u Email
Email
•• roger@malware
PI:EMAIL
test.com
u
u Malware
Malware--Test Lab
Test Lab
•• http://www.malware
http://www.malware--test.com
test.com
u
u 大炮开讲部落格
大炮开讲部落格
•• http://
http://rogerspeaking.com
rogerspeaking.com
PDF created with pdfFactory Pro trial version www.pdffactory.com