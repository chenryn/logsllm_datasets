a day of March 2012. Each bar represents the count of .com
domains registered per 5-minute epoch.
Five-minute epoch
(EDT)
10:15–10:20AM
10:20–10:25AM
10:25–10:30AM
12:35–12:40PM
1:10–1:15PM
Spammer domains
Brand-new Retread
348
366
348
7
7
0
0
0
52
118
All domains
409
420
422
63
126
Table 1: 5-minute epochs with spammer domain registrations
from Moniker. The epochs correspond to the ﬁve registration
spikes in Figure 1.
on thin margins and rely on volume for proﬁtable operation, these
discounts are signiﬁcant.
(2) Domains registered together are often at similar stages in the
domain life-cycle: Spammer domains in the same spike tend to exhibit
the same life-cycle type, brand-new (i.e., ﬁrst-time registration) or
retread (i.e., re-registration with some time after previous expiration),
as shown in Table 1. The registration spikes during 10:15–10:30AM
(retread), and those during 12:35–1:15PM (brand-new) are likely
from different attackers. This phenomenon indicates that in addition
to making up names themselves, miscreants track domain names that
are due for expiration in the WHOIS database (available from publicly
released sources [42, 59]) and collect recently expired names in bulk.
(3) Domains registered together may be similar to one another:
When we take a closer look at the spammer brand-new domains
registered in the same epoch of 1:10–1:15PM, we observed that many
names appeared similar to each other. Table 2 displays examples of
names sharing the same substrings. We highlight the common sub-
strings in bold. The names algorithmically generated by miscreants
manifest characteristic lexical patterns.
Table 2 shows how many days pass until various spammer domains
are blacklisted; in some cases, these delays may be several weeks, or
even several months. Yet, the characteristic registration behaviors that
we have outlined provide opportunities to detect and blacklist these
domains earlier than existing techniques (i.e., at registration time)
because their registration behaviors are so distinctive. The following
sections outline our general approach, as well as how we extract and
encode the relevant features for establishing domain reputation.
4. PREDATOR ARCHITECTURE
We design PREDATOR to infer each domain’s reputation immedi-
ately after registration. The decision process does not need to examine
the Web content on the domains or wait until users are exposed to
attacks. Our goal is for PREDATOR to act as a ﬁrst layer of defense
Hour of the Day (EDT)9 101112131415161718Counts of registered .com domains050100150200250300350400450Blacklisted domainsNon-blacklisted domainsFigure 2: A high-level overview of PREDATOR.
early warning to limit the time that miscreants might proﬁtably use a
domain for malicious activities (in some cases, they may prevent the
attacks from occurring in the ﬁrst place).
5.
IDENTIFYING CHARACTERISTIC
FEATURES
We now expand on our earlier observations, exploring other char-
acteristic domain registration behavior of miscreants and encoding
these behaviors into features. We categorize the features into three
groups: domain proﬁle features, registration history features, and
batch correlation features. Each feature is categorical, continuous,
or ordinal. Categorical features typically arise when representing
features that are nominal in nature. Such features do not present a
meaningful notion of order, as values represent logically separate con-
cepts. Continuous values naturally correspond to continuous-range
type of features, and ordinal features denote the countable ordered
ones (like integers). Most non-boolean features are of these two types.
Table 3 summarizes the features that PREDATOR uses. The ﬁrst
column shows the feature categories, the second describes the detailed
features, the third indicates whether the features are categorical,
continuous, or ordinal, and the last column lists previous work that
has analyzed the feature. Out of 22 features, 16 have not been
previously considered for registration-based detection; none have ever
been incorporated into a classiﬁer for time-of-registration reputation.
We now describe each of these features in detail, discussing both the
domain knowledge and intuition we used to identify the feature as
well as how we ultimately encoded it. We observe similar patterns
from .com and .net zones across different time periods (2012 and
2015, respectively).
5.1 Domain Proﬁle Features
Domain proﬁle features are those that we extract from the domain
name or from the public WHOIS information regarding the current
registration.
Registrar (categorical). End users need to select the delegated regis-
trars to register domains. Miscreants presumably choose particular
registrars due to the prices or policies from different ones. We ﬁnd
79% of .com spammer domains were registered through only ten
registrars. Similarly, 84% of .net spammer domains were attributed to
ten registrars (ﬁve of the registrars overlapped). We map registrars to
a group of binary features. A given dimension is set to 1 if and only
if the corresponding registrar hosts the domain. There are 906 such
categorical registrar features. Since a domain has a single designated
registrar; only one such feature is set to 1 and the others are 0.
Authoritative nameservers (categorical). Without authoritative
nameservers, people could not resolve the domains in the zone. The
nameservers indicate how miscreants manage their domains (after
choosing registrars). Miscreants may use self-resolving nameservers,
where the nameserver is responsible for resolving its own domain
(e.g., the nameserver for example.com is ns.example.com,
as opposed to ns.third-party.com) [13]. Although some
other nameservers belong to major hosting companies that often host
legitimate domains, they provide a ﬁner-granularity indication of
spammer domain registrations. The nameserver assignment usually
happens close to domain registrations and might change with time.
We collect authoritative nameservers for the domains within ﬁve
minutes of domain registrations (i.e., the epoch that we have deﬁned)
from the zone update ﬁles and map them to a set of binary features,
where 1 means the nameserver resolves the domain. Because a
domain could have multiple nameservers or nameserver changes,
more than one attribute could have value 1.
Nameserver IP addresses and ASes (categorical). Multiple name-
servers can resolve to the same IP address, and different IP addresses
can originate from the same Autonomous Systems (ASes). Both IP
addresses and ASes indicate underlying hosting infrastructure, which
provides a means for identifying portions of the Internet with a higher
prevalence of hosting spammer domains. We convert them to a group
of binary attributes. Similar to the nameserver feature, more than one
attribute could have a value of 1. In our experiment, we derive the IP
addresses of the nameservers from the zone update ﬁles. For a newly
registered domain, we obtain the nameservers within ﬁve minutes of
the domain registration, and retrieve all IP addresses ever associated
with the nameservers within one year before the domain registration.
We use the mapping dataset from iPlane to map the IP addresses to
Autonomous System numbers [29]. We focus on the IP addresses of
the authoritative nameservers, available at registration time, while
previous work mainly investigated IP addresses directly resolved for
the domains [3, 5], usually conﬁgured later close to attack launch
time (e.g., using fast ﬂux [24]).
Registration time (categorical). Miscreants need to repeatedly regis-
ter domains for turnover in spam activities; this behavior may reveal
certain temporal patterns. In WHOIS information, “Creation Date”
indicates when a domain was registered. We have equivalent regis-
tration times from the zone update data, and extract hour-of-the-day
and day-of-the-week. The hour of the day can reﬂect the time zones
of registrants’ locations, and the day of the week can capture the
registrants’ workﬂows. We extract the information according to
Eastern Standard Time (i.e., UTC -0500), although this choice is
not signiﬁcant because the purpose is to capture repeated temporal
patterns of domain registrations. The hour of the day corresponds
to 24 categorical features, and the day of the week maps to seven
features.
Registration period (ordinal). A user can register a domain for one
to ten years. “Expiration Date” in WHOIS shows when the domain
Operation modeDetectionReportTraining modeZone UpdatePrior KnowledgeFeature Extraction1) Domain proﬁle2) Registration history3) Batch correlationStatistical ClassiﬁerLearning ModuleCategory
Domain
proﬁle
Registration
history
Batch
correlation
Feature Type
New?
Registrar Categ. [13, 20]
Authoritative nameservers Categ. [13, 20]
IP addresses of nameservers Categ.
ASes of nameserver IP addresses Categ.
Daily hour of registration Categ.
Week day of registration Categ.
Length of registration period Ord.
Trigrams in domain name Categ.
Ratio of the longest English word Cont.
Containing digits Categ.
Containing “–” Categ.
Name length Ord.
Edit distances to known-bad domains Cont.
Life cycle Categ.
Dormancy period for re-registration Ord.
Previous registrar Categ.
Re-registration from same registrar Categ.
Probability of batch size Cont.
Brand-new proportion Cont.
Drop-catch proportion Cont.
Retread proportion Cont.
Name cohesiveness Cont.






[20]




[20]
[20]


[20]




feature, we compute the ratio of the length of the longest English
word to the whole length of the name.
3) Containing digits (categorical). We observe that spammer domains
(18% for .com and 42% for .net) are more likely to use numerical
characters than non-spammer ones (10% for .com and 12% for
.net). Possible reasons might be that miscreants add digits to
derive numerous names from the same word afﬁx or generate
random names from a character set containing digits. We include
a binary feature to indicate whether the domain name contains
any digits.
4) Containing “–” (categorical). Similarly, miscreants can insert “–”
to break individual words or concatenate multiple words, though
our data did not show large differences regarding this attribute
between spammer and non-spammer domain names. We include a
binary feature to indicate whether the domain name contains any
hyphens.
5) Name length (ordinal). Miscreants may create domains based on a
speciﬁc template, such as random strings of a given length. We
use the length (number of characters) of the domain name as a
feature.
6) Edit distances to known-bad domains (continuous). We examine
the similarity of a domain to a set of known-bad domains. We
derive a set of previously known spammer domains based on
the prior knowledge, compute the Levenshtein edit distances to
the currently considered domain, and divide these edit distances
by the length of the domain name for normalization.
In our
experiment (Section 7), we use the data from a separate month
to extract known-bad domains, which do not overlap with any
training or testing data. We take the ﬁve smallest normalized edit
distances as features, which have values between 0 and 1 (we
have experimented with various numbers of edit distances, and the
detection performance remains similar). Although calculating edit
distances is computationally expensive, it remains tractable given
the pace of domain registrations. In our experiment, the size of the
known-bad .com domain set is 66,598. On average, the calculation
of edit distances for one domain to the set of known-bad domains
requires 0.13 seconds on a 2.40GHz CPU machine; calculating
these values for one month of new .com domains takes four days.
5.2 Registration History Features
Registration history features are based on previous registration
history of a domain. If a domain has appeared in the zone before, we
possess registration history, such as previous registrar and deletion
time. Most of such features can be obtained from third-party services
such as DomainTools [10] and Who.is [63], or they are available at
registrars and registries. Due to the limitations of our data, we only
consider the features regarding the most recent previous registration.
Life cycle (categorical). As mentioned in Section 2, we categorize
domains as brand-new, drop-catch, and retread, depending on the
registration history. Although the life-cycle type itself may not be a
strong indicator whether the domain is registered for spam-related
activity, it often provides discriminative information when combining
with other features, such as the life-cycle types of the other domains
registered from the same registrar and around the same time. In total,
the life-cycle categories map to three binary features and only one of
them is set to 1.
Dormancy period for re-registration (ordinal). The usual re-
registration domains tend to include some that expired a long time
ago. On the other hand, spammers intentionally collect expired do-
mains from publicly released sources [42, 59], which concentrate
on recently expired domains. We observe that 30% of non-spammer
retread domains were re-registered within 90 days, while 65% of
Table 3: Summary of PREDATOR features. We include refer-
ences to previous work that has proposed similar features in the
context of proactive registration-based detection. The “New?”
column highlights features that this work explores for the ﬁrst
time; where a feature was previously studied or identiﬁed, we
provide a reference.
is about to expire. The user owns the domain and can renew it any
time before its expiration. Longer registration terms mean higher
up-front fees. We ﬁnd that almost all spammer domains have one-year
initial registration terms, presumably since spammers tend to abandon
their domains due to blacklisting. We use the years between domain
registration and its potential expiration as one feature.
Lexical patterns (containing multiple features). Registrants of be-
nign domains tend to choose easy-to-remember names. On the other
hand, to acquire large numbers of domains for attack campaigns,
miscreants generate random-looking names or produce similar names
by following certain rules. We compute the features to capture facets
of the linguistic structure of domain names. Though some of these
features are not strictly new, previous work has not investigated the
lexical patterns of new domains across entire zones. When analyzing
the naming patterns, we only use the name in the second-level domain
and ignore the trailing TLD (like “.com”).
1) Trigram (categorical). We use the standard trigram approach to
represent a domain name and to examine the character sequence.
A domain name can only consist of the characters of letters, digits,
and hyphens [6, 40]. (Internationalized domain names use the
same character set to encode Unicode characters [32].) Since
DNS systems treat domain names in a case-insensitive manner,
we convert the names into lower case to process. We have a group
of 373 = 50, 653 binary features that represent all the possible
trigrams on the allowed alphabet of 26 letters, 10 digits and the
hyphen character. We set a given feature to 1 if and only if the
corresponding trigram appears in the domain name; otherwise, we
set it to 0.
2) Ratio of the longest English word (continuous). Miscreants may
either generate pseudo-random names to avoid conﬂict with exist-
ing domains, or deliberately include readable words in the domain
names to attract victim users to click and visit. We match the
English words in a dictionary with a domain name to ﬁnd the
longest English word that the name contains. To normalize the
Figure 3: Sliding windows to train detection models.
spammer retread domains in .com and 37% of spammer retread do-
mains in .net were re-registered within 90 days. We take the seconds
between its last expiry and current registration as a feature. Regarding
brand-new domains, the feature of dormancy period is not applicable,