**作者：启明星辰 ADLab  
公众号：**
## **一、概述**
启明星辰ADLab实验室在近几个月内，通过威胁情报检测系统接连捕获到多起针对哥伦比亚国家的政府部门，金融、银行、保险等行业及卫生和制药机构发起的钓鱼邮件定向攻击。攻击者以“冠状病毒检测紧急告知单”或“刑事诉讼通知单”等命名的诱饵文档作为邮件附件，并配合鱼叉邮件向攻击目标电脑植入远控木马。从邮件分析结果来看，攻击者会将邮件的来源伪装成哥伦比亚国家卫生部、国家税务和海关总署、民事身份登记处、检察院以及移民局等政府部门，以加强其邮件的真实性。我们通过对攻击者伪装的来源信息、域名使用偏好、IP地址关联及地理位置等特性进行对比分析，发现该系列攻击来源于盲眼鹰组织，但采用的攻击武器较以往完全不同。盲眼鹰首次被披露于2019年初，是一个疑似来自南美洲的APT组织，其最早活跃时间可追溯到2018年，主要针对哥伦比亚政府和大型公司进行攻击。
在对攻击活动深入分析后，我们发现该组织在我们发现的这批攻击中采用了更为先进攻击技术和反追踪技术。在以往的攻击中，该组织多使用MHTML格式的恶意文档作为攻击附件，而在本次攻击过程中，该黑客组织使用一个无恶意的文档作为媒介，诱使目标下载文档中提供恶意短链接（该短链接指向一个加密过MHTML的恶意文档），这大大提高攻击的有效性，其不仅能够绕过邮件安全防护系统和入侵检测系统，而且大大的降低了被杀毒软件查杀的概率（我们捕获的许多样本在VT上的查杀率均0，部分样本也长期保持着低于5%的极低查杀率）；我们发现的这批攻击中，该黑客组织放弃了以往常用的Imminent
Monitor RAT，采用了一款隐蔽能力和免杀能力更强的RAT--AsyncRAT，同时结合复杂多层加密与代码嵌套手段来提供反分析能力和反检测能力。
AsyncRAT是来源于国外的一款远控木马，其除了能够对目标进行最基本的远程间谍活动外，还可使用USB设备突破物理隔离、使用bot
killer清除目标上的竞争对手等。该木马最具特点的是采用不落地的无害模块作为目标的僵尸进程， 并采用 **“propelling in
use，destroy after use”**
的工作模式，即分解攻击任务为子任务，每个子任务以一个单独的DLL模块来实现，黑客执行任务时由多个子任务DLL模块按照一定的执行序列来实现，同时对完成任务的模块进行及时销毁。这种工作模式将一个完整恶意任务分解成多个无害的子任务，能够有效地躲避一些复杂安全防护策略，同时也能有效地防止取证分析人员获取其核心攻击模块。
此外，该黑客组织还采用了 **“Double Flux+Fast VPN”**
技术来达到反追踪和反侦测的目的。我们通过对攻击者使用的C&C基础设施进行分析发现，这批攻击的C&C域名是通过DNSExit.com来动态分派IP地址(IP地址是动态变化的，几乎都归属于哥伦比亚的ISP)。实际上，DNSExit不仅是一个“1(dns)对n(IP)”的服务，更是一个“m(dns)对n(IP)”，因此其应该采用了“double
flux”技术来规避溯源与追踪。不仅如此，黑客组织使用这种服务的背后还加了一层VPN，也就是说通过“Double
Flux”得到的IP地址并不是黑客真正的IP地址， 其只是一系列的VPN节点(节点的IP地址由Unus.Ins服务商提供)，因此借用”fast
flux”命名法我们将这种反追踪技术称为Fast VPN。攻击者利用“Double Flux+Fast
VPN”技术来作为攻击载荷和木马回连的通道，使得黑客的攻击变得非常难以追踪和溯源。
## **二、 攻击活动分析**
本章总结了黑客组织近期的攻击活动事件以及本次活动中使用的攻击手法。
### **2.1 近期攻击活动**
启明星辰ADLab实验室基于原始线索对黑客组织本次的攻击活动进行了全面追踪、关联和分析，发现此次活动最早可追溯到2019年9月，且近期活动主要以COVID-19相关内容作为钓鱼诱饵。我们综合所有的威胁情报数据，梳理了本次该组织发起的所有攻击事件，并绘制出以下攻击事件时间线。
图2-1 APT组织近期攻击事件时间线
### **2.2 攻击手法**
在本次攻击活动中，我们发现盲眼鹰APT组织主要采用鱼叉邮件作为初期攻击方式。攻击者伪装成来自哥伦比亚卫生部、哥伦比亚国家总检察院、哥伦比亚移民局、哥伦比亚国家税务和海关总署以及哥伦比亚民事身份登记处等部门，向使用西班牙语言的南美地区（特别是哥伦比亚国家）的政府部门，金融、银行、保险等公司，以及卫生和制药机构的相关人员投递恶意攻击邮件。邮件主题均与攻击者所仿冒的政府部门文件题材相关，并在邮件正文添加针对附件文件的诱导性描述和附件查看密码等信息，更有利于加强邮件的真实性，诱使受害者启用恶意宏代码，进而向攻击目标机器上植入木马程序，以实施对入侵设备的远程控制、窃取机密数据、系统破坏等恶意行为。
启明星辰ADLab实验室通过对该组织近期攻击的监测和关联分析，发现了多个与其相关的邮件，下面我们列举出部分邮件内容以及针对性的诱饵文档。
#### **2.2.1 钓鱼邮件详情**
**伪装成哥伦比亚卫生部：**
1） 图2-2是攻击者伪装成哥伦比亚卫生部的攻击邮件之一。邮件主题为“Usted ha sido citado para una prueba
obligatoria de (COVID-19)”（翻译后为：“您被要求参加强制性检测（COVID-19）”）。
图2-2 伪装成哥伦比亚卫生部邮件之一
2） 图2-3是攻击者伪装成哥伦比亚卫生部的攻击邮件之二。邮件主题为“Le hemos llamado en repetidas ocaciones y
no ha sido posible contactarle por favor leer comunicado
urgente”（翻译后为：“我们已经多次致电给您，无法联系到您，请阅读紧急通知”）。
图2-3 伪装成哥伦比亚卫生部邮件之二
3） 图2-4是攻击者伪装成哥伦比亚卫生部的攻击邮件之三。邮件主题为“Detectamos en su sector la presencia de
COVID-19 ( Corona virus ) intentamos comunicarnos via telefonica con
usted”（翻译后为：“我们在您的部门发现了COVID-19( Corona virus )，并尝试通过电话与您联系”）。
图2-4伪装成哥伦比亚卫生部邮件之三内容
**伪装成哥伦比亚国家税务和海关总署：**
图2-5是攻击者伪装成哥伦比亚国家税务和海关总署的攻击邮件。邮件主题为
“Procederemos con una orden de embargo a las cuentas bancarias encontradas a
su nombre”（翻译后为：“我们将对以您名义发现的银行账户发出冻结令”）。
图2-5 伪装成哥伦比亚国家税务和海关总署的邮件
**伪装成哥伦比亚民事身份登记处：**
图2-6是攻击者伪装成哥伦比亚民事身份登记处的攻击邮件。邮件主题为“Su cedula de ciudadania ha sido reportada
como robada en nuestro sistema”（翻译后为：“您的公民证已在我们的系统报失”）。
图2-6 伪装成哥伦比亚民事身份登记处的邮件
**伪装成哥伦比亚检察院：**
图2-7是攻击者伪装成哥伦比亚检察院的攻击邮件。邮件主题为“El presente es el requerimiento enviado a
declarar por el proceso iniciado en su contra (ultimo
aviso)”（翻译后为：“这是针对您发起的处理流程声明（最后通知）”）。
图2-7 伪装成哥伦比亚检察院的邮件
**伪装成哥伦比亚移民局：**
图2-8是攻击者伪装成哥伦比亚移民局的攻击邮件。邮件主题为“Comunicado 710297647: Proceso Penal
Pendiente”（翻译后为：“声明710297647：待定刑事诉讼法”）。
图2-8 伪装成哥伦比亚移民局的邮件内容
#### **2.2.2 诱饵文档**
根据现有的情报分析表明，该组织以往最常用的邮件附件是带有恶意宏的MHTML格式的DOC文档。我们对近期捕获到的相关攻击样本进行分析后，发现在大多数情况下，攻击者开始使用带有短链接的RTF或PDF文档来作为恶意附件，以绕过邮箱网关的检测。表2-1列出了黑客组织在此次攻击活动中使用的恶意文档信息。
**文件名** | **时间戳**  
---|---  
citacion prueba covid.pdf | 2020-07-09 11:06:40  
citacion prueba covid.pdf | 2020-06-19 14:11:05  
Comunicado.pdf | 2020-04-25 13:11:38  
minsaludcomunicado.pdf | 2020-03-04 22:17:40  
estado de cuenta.pdf | 2020-02-25 21:58:29  
reactivar mi cedula.pdf | 2020-02-03 23:18:38  
DIAN estado de cuenta.rtf | 2019-11-04 15:01:00  
pdfproceso.rtf | 2019-10-25 14:09:00  
Proceso.rtf | 2019-08-26 21:00:00  
表2-1 相关恶意文档信息
**1）案例1**
    附件RTF文档中内嵌一个名为“VER PROCESO”的跳转链接，其指向的恶意链接使用的是IP Logger短链接服务。
图2-9 RTF文档内容
图2-10 IP Logger短链接平台
**2）案例2**
附件PDF文档中内嵌一个名为“Ver
comunicado”的跳转链接和一行文本信息（仅用于提升文档的可信度）。其指向的恶意链接使用的是Acortarurl短链接服务。
图2-11 PDF文档内容
## **三、溯源与关联分析**
在对本次攻击样本的IOC进行深入追踪溯源后，我们挖掘出黑客组织更多的C2服务器信息。后文，我们将结合目前掌握的情报数据和公开的研究报告资料信息，来对此次攻击事件进行详细的组织关联分析。
#### **3.1 C &C基础设施分析**
通过提取和关联所有样本中的C&C服务器相关信息，我们发现黑客组织所使用的基础设施都位于哥伦比亚、哥斯达黎加和巴拿马，所有IP都归属于哥伦比亚的ISP。查看这些IP的具体信息（如图3-1）可以看到，此IP段的网络服务提供商是Unus.Ins公司，该公司操控着26209个IP地址，且几乎所有这些IP地址都是提供给匿名VPN服务使用，例如Powerhouse
Management.Inc（phmgmt.com）。由于该ISP在网络中的流量大多数具有欺诈性，因此美国反欺诈安全公司Scamalytics将其标注为高欺诈风险ISP（如图3-2）。
图3-1 相关IP具体信息
图3-2 Scamalytics公司标注信息
图3-3为该组织在此次攻击活动中使用的部分域名、IP、PE文件和Office文件的对应关系：
图3-3 对应关系图
该组织使用的域名是在国外DNSExit.com平台上免费注册的三级子域（该平台提供的免费域实际上是二级域，如图3-4），且这些子域所指向的IP地址被频繁的更换（如图3-5）。如果一个C2服务器被关闭，攻击者则可以快速地更新DNS记录指向新服务器，恢复连接。攻击者利用域名注册商提供的DNS服务（double
flux），再配合使用VPN服务（fast VPN）作为攻击载荷和木马回连的通道，以达到反追踪和反侦测的目的。
图3-4 DNSExit.com平台
图3-5 域名指向的IP
#### **3.2关联和技术演进分析**
我们从本次事件中黑客组织所使用的样本、C&C服务器等层面进行了关联分析，并结合该组织早期攻击活动中的相关特性，得出以下几处重要的关联点。
##### **3.2.1 伪装成来源信息**
在早期的攻击活动中，盲眼鹰组织惯于将自身伪装成哥伦比亚国家民事登记处、哥伦比亚国家税务和海关总署等部门来对哥伦比亚的政府和金融机构进行攻击。而在本次攻击事件中，攻击者所使用邮件的伪装来源信息除了同该组织具有一定的重叠以外，还新增了一些哥伦比亚其他政府部门信息。具体详见表3-1。
**诱饵伪装来源（2018年4月-2019年2月）** | **诱饵伪装来源（2019年9月-2020年7月）**  