### 优化后的文本

**引理和条件**

当 \( \lambda \leq \log\left(\frac{1}{6}\right) \)，有：
\[ d_{\text{stat}}\left(2 \cdot s \cdot 2^{\lambda + 2} \cdot n^{2\kappa} - ((\ell+1) \cdot s_f, F(X_{\ell+1} | \text{view}_{\ell}(P_0, P_1, K_0)) \leq (24\ell + 10) \cdot \epsilon^{1/12} \]

需要注意的是，上述输出大致（仅保留主要因素）是 \(\ell \cdot \epsilon^{1/12}\) 安全的，对抗复杂度为 \(2 \cdot s - \ell \cdot s_f\) 的对手。这是由于涉及了大量的计算约简。我们将在第4.3节中讨论如何获得更紧致的结果。

**证明概述**

我们的证明主要利用了前人工作 [9] 和 [29] 中引入的工具。首先，根据 [29] 中的引理1，一个弱伪随机函数（wPRF）可以看作是一个强2源伪随机性提取器和一个伪随机生成器（PRG）的组合。其中，两源伪随机性提取器是一种即使输入只有弱随机性，只要它们独立且具有高最小熵，其输出仍然是伪随机的函数。“强”指的是其中一个输入可以公开（例如，在我们的情况下是 \(p_0\) 或 \(p_1\)）。

此外，尽管任意泄露（如 \(L_i(k_{i-1}, p_0)\)）会破坏 wPRF 输出 \((k_i, x_i) := F(k_{i-1}, p_0)\) 的伪随机性，但给定有限泄露时，\(k_i\) 仍能保持较高的HILL伪熵（参见 [9] 中的引理2）。

因此，当我们交替使用独立的随机性 \(p_0\) 和 \(p_1\) 时，可以通过在 \(k_i\) 和 \(p_1\) 之间进行两源提取来生成伪随机的 \(k_{i+1}\)，前提是它们在泄露条件下是独立的，这可以通过强制非自适应泄露来实现。即 \(L_i\) 只取 \((k_{i-1}, p_0)\) 作为输入，从而在该条件下 \(k_i\) 和 \(p_1\) 是独立的。需要注意的是，\(k_{i+1}\) 在考虑下一轮泄露时将再次失去其伪随机性，但我们可以通过重复上述证明过程来解决这一问题。

最终，重要的是安全性只随轮数线性退化，这一点由引理3确认。它表明，对于每一个 \(\ell\)，第 \(\ell\) 轮的输出 \(K_\ell\) 在给定前 \(\ell\) 轮的输出和泄露条件下具有较高的HILL伪熵，并且计算 \(F(K_\ell, P_{\rho(\ell)})\) 可以看作是一个2源伪随机性提取，从而完成了定理2的证明。

**引理**

**引理1** ([29])：设 \(F : \{0, 1\}^\kappa \times \{0, 1\}^n \to \{0, 1\}^m\) 是一个对均匀分布的 \(K\) 和 \(X\) 安全的 \((\epsilon, s, n/\epsilon)\) 弱伪随机函数，则对于独立的随机变量 \(K'\) 和 \(X'\) 满足 \(H_\infty(K') \geq \kappa - \Delta\) 和 \(H_\infty(X') \geq n - \Delta\)，有 \(d_{\text{stat}}(F(K', X') | X') \leq \epsilon_a\)，其中 \(\epsilon_a = \epsilon \cdot 2^{2\Delta + 4}\) 且 \(s_a = s \cdot \epsilon^2 / 2n^2\)。

**引理2** ([9])：对于联合随机变量 \((X, L)\) 满足 \(d_{\text{stat}}(X) \leq \epsilon_a\) 且 \(L\) 的范围为 \(\{0, 1\}^\lambda\)，对于任何满足 \(\epsilon_a + 2^{-\Delta} \leq \epsilon_b^2 \cdot 2^{-\lambda}\) 的 \(\epsilon_b\) 和 \(\Delta > 0\)，存在联合随机变量 \((X', L)\) 使得：
1. \(b \cdot s_a / 8\kappa((X, L); (X', L)) \leq \epsilon_b\)
2. \(\Pr[H_\infty(X' | L) \geq |X| - \Delta] \geq 1 - \epsilon_b\)

**引理3**：对于定义如定理2中的 \(F, L_0, L_1, \ldots\) 和 \(s_f,F\)，对于均匀分布的 \((P_0, P_1, K_0)\) 和所有 \(\ell \in \mathbb{N}_{>0}\)，有 \(\{ \text{view}_\ell(P_0, P_1, K_0), K_\ell \}\) 在 \(((12\ell + 2) \cdot \epsilon \cdot 2^{\lambda + 2} \cdot n^{2\kappa})\) 范围内接近于一个假分布 \(\{ \tilde{\text{view}}_\ell(P_0, P_1, K_0), \tilde{K}_\ell \}\)，其中 \(\tilde{K}_\ell\) 和 \(\tilde{X}_\ell\) 以及 \(\tilde{\text{view}}_\ell \setminus \tilde{X}_\ell\) 是在某些条件下独立的，并且：
\[ \Pr[\tilde{\text{view}}_\ell][H_\infty(\tilde{K}_\ell | \tilde{\text{view}}_\ell) \geq \kappa - \log(\epsilon^{-1})] \geq 1 - 2 \cdot \epsilon^{1/12} \]
\[ \Pr[\tilde{T}_\ell][H_\infty(P_{\rho(\ell)} | \tilde{T}_\ell) \geq n - \log(\epsilon^{-1})] \geq 1 - 2 \cdot \epsilon^{1/12} \]

注意我们在扩展场景中使用了引理1，因为 \(\tilde{K}_\ell\) 和 \(P_{\rho(\ell)}\) 可能不完全独立。但这已经足够了，因为 (i) \((\tilde{K}_\ell, \tilde{X}_\ell)\) 和 \(\tilde{\text{view}}_\ell \setminus \tilde{X}_\ell\)（包含 \(P_{\rho(\ell)}\)）在某些条件下是独立的；(ii) 秘密输入 \(\tilde{K}_\ell\) 在整个视图条件下具有高最小熵；(iii) 公开输入 \(P_{\rho(\ell)}\) 在 \(\tilde{T}_\ell\) 条件下具有高最小熵。

**4.3 使用提取器的替代构造**

前一节分析的一个限制是安全界较为宽松。一种简单的改进方法是用PRG和强2源提取器的组合替换图3中的wPRF，即使用函数 \(F'(K, P) = \text{prg}(\text{ext}(K, P))\)。正如 [9] 中详细讨论的那样，虽然 \(F'\) 不是wPRF，但它足以证明图3中的流密码是泄漏弹性的。

这种基于提取器的构造比定理2中的 \(O(\epsilon^{1/12})\) 界限更紧，因为它涉及较少的计算约简。通过使用2源提取器，我们可以避免使用引理1，但需要引入一个可指数减小的加性项 \(\epsilon_{\text{ext}}\)。如 [37] 所讨论的，还可以进一步提高安全界的紧致性，特别是在使用实际大小参数（例如128位密钥）时，通过依赖种子不可压缩的PRG假设（最初在 [15] 中引入）。

需要注意的是，依赖于种子不可压缩性和/或有界泄露也带来了一些实际问题，因为这些假设对于硬件设计者来说难以满足。为了消除这种限制，[37] 引入了经验可验证的假设（即具有可模拟泄露的2PRG的下一个块不可预测性），在这种假设下可以在标准模型中获得安全证明。但这又会导致更差的安全界。确定是否可能在实践中可量化的假设下获得紧致界限是一个有趣的研究方向。

最后提到，这些改进需要在泄漏设备上实现提取器。如 [34] 所指出的，在物理可观测密码学中使用提取器可能是矛盾的。一方面，如果提取器的实现没有泄露太多信息，它可以恢复（伪）熵损失。另一方面，提取器的实现可能成为标准DPA攻击的良好目标，因为它涉及其公共和私有输入之间的重复算术操作。这说明了实际安全性和证明中的紧致界限之间的权衡。找到最佳折衷方案需要更好地了解低抽象级别对策的提取器实现，这也是进一步研究的方向。

**结论**

设计泄漏弹性的密码原语涉及到有意义的物理假设和严格的数学证明之间的复杂权衡。这导致了一个关于如何最好地结合这两个目标以获得在最小假设下的通用证明的持续讨论。以伪随机生成器为例，本文首先分析了一个简单状态构造的安全性，该构造具有最小的物理要求。我们展示了该构造可以在基于随机预言机的假设下被证明是安全的。然后，我们展示了放松随机预言机假设并在标准模型中证明的成本实际上很小。也就是说，只需假设一个小的公共内存和非自适应泄露函数。更具体地说，我们在密码工程师提供的泄露界限中反映了测量条件的自适应性，而不是在对抗实验中，这符合侧信道攻击的实践。先前在泄漏弹性密码学中的讨论也适用于我们的新构造。例如，用PRG和提取器的组合替换wPRF可以获得更好的安全界，但代价是实现一个潜在的泄露提取器。进一步研究的方向有两个主要方向。一方面，设计能够有效抵御侧信道攻击的专用解决方案可以扩展到其他密码原语。这些进展对于在实际应用中应用泄漏弹性构造是必要的，其中需要良好的实现性能。另一方面，更一般地，引入泄露函数的替代限制也是有用的，例如为了排除模型中不现实的“未来计算攻击”，而不是通过设计调整。这些改进可以为物理可观测密码实现的更通用处理打开道路。

**致谢**

感谢Yevgeniy Dodis就随机预言机在我们证明中的作用进行了有趣的讨论。Olivier Pereira和François-Xavier Standaert是比利时科学研究基金（FNRS-F.R.S）的助理研究员。本研究部分得到了瓦隆地区SCEPTIC项目和SCOOP行动计划的支持。

**参考文献**

[此处省略具体的参考文献列表，但应包括所有引用的工作及其完整信息。]

希望优化后的文本更加清晰、连贯和专业。如果有更多细节需要进一步优化，请告诉我！