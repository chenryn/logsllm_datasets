319s
e
t
y
B
f
o
e
g
a
t
n
e
c
r
e
P
60
50
40
30
20
10
0
Congestion
Host/Sndr/Rcvr
Opportunity
Application
Transport
Unknown
Access1a
Access1b
Access1c
Access2
Peering1
Regional1a
Regional1b
Regional2
Figure 10: Fraction of bytes for each rate limiting factor
l
s
w
o
F
f
o
e
g
a
t
n
e
c
r
e
P
90
80
70
60
50
40
30
20
10
0
Congestion
Host/Sndr/Rcvr
Opportunity
Application
Transport
Unknown
Access1a
Access1b
Access1c
Access2
Peering1
Regional1a
Regional1b
Regional2
Figure 11: Fraction of ﬂows for each rate limiting factor
ously as transport, host window, application, or unknown
limited.
With the Nagle algorithm disabled, the fastest generation
rates were again characterized as congestion and bandwidth
limited. At all the lower rates (1.1 Mbps down to 33 Kbps),
T-RAT deemed the connections as exclusively application
limited when using the data stream, and a combination of
application and transport limited when using the acknowl-
edgment stream. Thus, application limited behavior is easier
to discern when the Nagle algorithm is turned oﬀ.
6. RESULTS
The results of applying T-RAT to the 8 packet traces are
shown in Figure 10. For each trace, the plot shows the
percentage of bytes limited by each factor. The 4 traces
taken from access links are able to diﬀerentiate between
sender and receiver limited ﬂows since they see data and
acknowledgment packets for all connections. The peering
and regional traces, on the other hand, often only see one
direction of a connection and are therefore not always able
to diﬀerentiate between these two causes. We have aggre-
gated the 3 categories identiﬁed by T-RAT—sender, receiver
and host window limited—into a single category labeled
“Host/Sndr/Rcvr” limited in the graph.
As shown in Figure 10, the most common rate limiting
factor is congestion. It accounts for between 22% and 43%
of the bytes in each trace, and is either the ﬁrst or second
most frequent cause in each trace. The aggregate category
that includes sender, receiver and host window limited is
the second most common cause of rate limits accounting
for between 8% and 48% of the bytes across traces. When
we were able to make a distinction between sender and re-
ceiver window limited ﬂow (i.e., when the trace captured
the acknowledgment stream), receiver window limited was
a much more prevalent cause than sender window limited,
by ratios between 2:1 and 10:1. Other causes—opportunity
320opportunity limited
application limited
congestion limited
transport limited
receiver limited
1
0.8
0.6
0.4
0.2
n
o
i
t
c
a
r
F
e
v
i
t
l
a
u
m
u
C
0
0.1
1
10
1000 10000 100000 1e+06 1e+07
100
Flow Rate (Byte/sec)
1
0.8
0.6
0.4
0.2
n
o
i
t
c
a
r
F
e
v
i
t
l
a
u
m
u
C
0
10
opportunity limited
application limited
congestion limited
transport limited
receiver limited
100
1000 10000 100000 1e+06 1e+07 1e+08 1e+09
Flow Size (bytes)
Figure 12: Rate distribution by rate limiting fac-
tor, Access1b trace
Figure 13: Size distribution by rate limiting fac-
tor, Access1b trace
1
0.8
0.6
0.4
0.2
n
o
i
t
c
a
r
F
e
v
i
t
l
a
u
m
u
C
0
0.1
opportunity limited
application limited
congestion limited
transport limited
receiver limited
1
10
100
1000
10000
Flow Duration (sec)
Figure 14: Duration distribution by rate limiting
factor, Access1b trace
limited, application limited and transport limited—usually
accounted for less than 20% of the bytes. Bandwidth lim-
ited ﬂows accounted for less than 2% of the bytes in all
traces (and are not shown in the plot). For most traces,
the unknown category accounted for a very small percent-
age of the bytes. We examined the 2 traces in which the
rate limiting cause for more than 5% of the bytes was un-
known and identiﬁed 3 factors that prevented the tool from
making a rate limiting determination. First, T-RAT can-
not accurately estimate round trips on the order of 3 msec
or less, and therefore, cannot determine a rate limiting fac-
tor for these connections. Second, when the traces were
missing packets in the middle of a connection (which may
have resulted either from loss at the packet ﬁlter or from
multi-path routing) estimating the round trip time and the
rate limiting cause becomes diﬃcult. Finally, multiple web
transfers across a persistent TCP connection also presented
problems. When one HTTP transfer uses the congestion
window remaining from the end of the previous transfer a
moderate size ﬁle may not be opportunity limited (because
it is larger than 13 packets and it never enters slow-start)
and it may not have enough ﬂights (because the initial ﬂight
size is large) for T-RAT to make a rate limit determination.
Not surprisingly, when we look at rate limiting factors by
ﬂows rather than bytes, the results are very diﬀerent. Recall
that we continuously update the reason a ﬂow is limited, and
a single ﬂow may have multiple limiting factors throughout
its lifetime. For example, it may be congestion limited for
one interval, and after congestion dissipates, become win-
dow limited. In those cases when a ﬂow experienced mul-
tiple causes, we classiﬁed it by the factor that most often
limited its transmission rate. Figure 11 shows the percent-
age of ﬂows constrained by each rate limiting factor for the 8
traces. The most common per-ﬂow factors are opportunity
and application limited. Collectively, they account for over
90% of the ﬂows in each of the 8 traces, with opportunity
limited accounting for more than 60% and application lim-
ited accounting for between 11% and 34%. No other cause
accounted for more than 4% of the ﬂows in any trace. These
results are consistent with the results reported in Section 3.
Namely, most ﬂows are small and slow. Small ﬂows are
likely opportunity limited (they don’t have enough packets
to test buﬀer or network limits), and slow ﬂows are likely
application limited (not sending fast enough to test buﬀer
or network limits.)
A general trend is evident when comparing the traces
taken at access links to those taken at the peering and re-
gional links. The former tend to have a higher percentage
of bytes that are window limited. The access links are high
speed links connecting a site to the Internet. As such, they
support a population with good connectivity to the Internet.
The other links are likely seeing a more general cross section
of Internet users, some of whom are well-connected and oth-
ers of whom are not. Since window limits are reached when
the bandwidth delay product exceeds buﬀer resources, the
well-connected users are more likely to reach these limits.
This diﬀerence between the two kinds of traces was evident
in Figure 1. That graph shows that the distribution of rates
has a longer tail for the access links than for the regional
and peering links.
We next ask whether these diﬀerent rate limiting factors
can be associated with diﬀerent performance for users. Fig-
ure 12 plots the CDF of the rates for each of the rate limiting
factors for the Access1b trace. The graph shows very dis-
tinct diﬀerences between subgroups. Overall, receiver lim-
ited and transport limited ﬂows have the largest average
rates, followed by congestion limited, application limited
and opportunity limited. This same trend was exhibited
across the other 7 traces. Figures 13 and 14 plot the distri-
butions of size and duration for each rate limiting factor in
the Access1b trace. Receiver limited ﬂows have the largest
size distribution, followed by transport and congestion lim-
321ited. In the duration distribution, congestion limited ﬂows
have the longest duration, which is consistent with the ob-
servation that ﬂows experiencing congestion will take longer
to transmit their data than ﬂows not experiencing conges-
tion.
7. CONCLUSION
The rates at which ﬂows transmit data is an important
and not well-understood phenomenon. The rate of a ﬂow
can have a major impact on user experience, and the rates
of ﬂows traversing the Internet can have a signiﬁcant eﬀect
on network control algorithms. We had two goals in this
paper. First, we wanted to better understand the charac-
teristics of ﬂow rates in the Internet. Using packet traces
and summary ﬂow statistics we examined the rates of ﬂows
and the relationship between ﬂow rates and other ﬂow char-
acteristics. We found that fast ﬂows are responsible for most
of the bytes transmitted in the Internet, so understanding
their behavior is important. We also found a strong corre-
lation between ﬂow rate and size, suggesting an interaction
between bandwidth available to a user and what the user
does with that bandwidth.
Our second goal was to provide an explanation of the rea-
sons why ﬂows transmit at the rates they do. This was
an ambitious goal, and we have by no means completely
answered this question. We have seen, for a set of Inter-
net packet traces, the reasons that ﬂows are limited in their
transmission rates and have looked at diﬀerences among dif-
ferent categories of ﬂows. We believe our main contribution,
however, is to open up an area of investigation that can lead
to valuable future research. The tool we developed to study
rate limiting behavior provides a level of analysis of TCP
connections that can answer previously unanswerable ques-
tions. Thus, our tool has applicability beyond the set of
results we have obtained with it thus far.
Acknowledgments
We would like to thank Rui Zhang for her work with us on
ﬂow characterization that helped launch this project. We
would also like to express our thanks to the anonymous re-
viewers for many helpful comments on this paper.
8. REFERENCES
[1] M. Allman, “A Web Server’s View of the Transport
Layer,” Computer Communication Review, 30(5),
Oct. 2000.
[2] H. Balakrishnan, S. Seshan, M. Stemm, and R. Katz,
“Analyzing Stability in Wide-Area Network
Performance,” In Proc. ACM SIGMETRICS’ 97,
June 1997.
[3] J. Chambers, W. Cleveland, B. Kleiner, and P. Tukey,
“Graphical Methods for Data Analysis,” Wadsworth
Int’l. Group, Belmont, CA, 1983.
[4] M. Crovella and A. Bestavros, “Self-similarity in World
Wide Web Traﬃc: Evidence and Possible Causes,”
IEEE/ACM Transactions on Networking, 5(6):835-846,
December, 1997.
[5] R. D’Agostino and M. Stephens, Eds., “Goodness-of-Fit
Techniques,” Marcel Dekker, New York, 1986.
[6] H. Jiang and C. Dovrolis, “Passive Estimation of TCP
Round-Trip Times,” To appear in Computer
Communications Review, July, 2002.
[7] C. Labovitz, G. Malan, and F. Jahanian, “Internet
Routing Instability,” IEEE/ACM Transactions on
Networking, 6(5), pp. 515–528, 1998.
[8] W. Leland, M. Taqqu, W. Willinger, and D. Wilson,
“On the Self-Similar Nature of Ethernet Traﬃc
(Extended Version),” IEEE/ACM Transaction on
Networking, 2(1), pp. 1-15, Feb. 1994.
[9] D. Lin and R. Morris, “Dynamics of Random Early
Detection,” in ACM Sigcomm 97, September, 1997.
[10] R. Mahajan, S. Floyd, and D. Wetherall, “Controlling
High-Bandwidth Flows at the Congested Router,” In
Proc. 9th International Conference on Network Protocols
(ICNP), Nov. 2001.
[11] H. Martin, A. McGregor, and J. Cleary, “Analysis of
Internet Delay Times,” In Proc. Passive and Active
Measurements (PAM) workshop, 2000.
[12] J. Nagle, “Congestion Control in IP/TCP
Internetworks”, RFC 896, January, 1984.
[13] ns—Network Simulator (Version 2.1b8).
http://www.isi.edu/nsnam/ns/
[14] R. Pan, L. Breslau, B. Prabhakar, and S. Shenker,
“Approximate Fairness through Diﬀerential Dropping,”
ACIRI Technical Report, 2001.
http://www.icir.org/shenker/afd-techreport.ps
[15] V. Paxson, “Automated Packet Trace Analysis of
TCP Implementations,” In Proc. ACM SIGCOMM ’97,
Sep. 1997.
[16] V. Paxson, and S. Floyd, “Wide-Area Traﬃc: The
Failure of Poisson Modeling,” IEEE/ACM Transactions
on Networking, 3(3), pp. 226-244, June 1995.
[17] V. Paxson, “End-to-End Routing Behavior in the
Internet,” IEEE/ACM Transactions on Networking,
5(5), pp. 601–615, Oct. 1997.
[18] V. Paxson, “End-to-End Internet Packet Dynamics,”
IEEE/ACM Transactions on Networking, 7(3),
pp. 277-292, Jun. 1999.
[19] L. Rizzo, “Dummynet: A Simple Approach to the
Evaluation of Network Protocols”, Computer
Communications Review , 27(1), Jan. 1997.
[20] S. Sarvotham, R. Riedi, and R. Baraniuk,
“Connection-level Analysis and Modeling of Network
Traﬃc,” In Proc. ACM Internet Measurement Workshop
(IMW’ 2001), Nov. 2001.
[21] K. Thompson, G. Miller, and R. Wilder, “Wide Area
Internet Traﬃc Patterns and Characteristics,” IEEE
Network, vol. 11, no. 6, pp. 10-23, Nov. 1997.
322