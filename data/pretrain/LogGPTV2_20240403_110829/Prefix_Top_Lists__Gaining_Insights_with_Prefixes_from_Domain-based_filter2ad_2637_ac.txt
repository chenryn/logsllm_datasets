domains from one day to another results in the discovered artifacts.
4 NAME SERVER ANALYSIS
In this section we analyze the name server records collected by our
DNS scanner. The evaluation is on data from August 1, 2019.
RFC 2182 requires that each zone has topologically different
name server IP addresses to ensure resilience against routing is-
sues [10]. This means the addresses should be at least in two dif-
ferent normalized prefixes for each used IP version. We use the
results of our DNS scanner to determine if the zones of the top list
domains comply with this requirement. In Figure 4 and Figure 5
we sort the domains according to their top list rank and the rank
of the prefix they are in. In order to make the graphs comparable
the x-axis represents the share of ranks per top list (see Table 3 for
total numbers).
Figure 4 shows the domain based top list results. The relative
graphs for all top lists and both IP versions are similar. Their distri-
bution of non-compliant zones is nearly linear. Thus, compliance to
the RFC requirement seems to be independent from the top list rank.
We evaluate the Top 1k zones, which are not visible in the graph
as they represent less than 0.1% of all zones. In this analysis we
2019-04-012019-04-152019-05-012019-05-152019-06-012019-06-152019-07-012019-07-152019-08-012019-08-152019-09-011.001.011.021.031.04CumulativeZipfweightofnewpreﬁxesperdayPTL(IPv4)basedonAlexaPTL(IPv4)basedonMajesticPTL(IPv4)basedonUmbrellaPTL(IPv6)basedonAlexaPTL(IPv6)basedonMajesticPTL(IPv6)basedonUmbrella2019-04-012019-04-152019-05-012019-05-152019-06-012019-06-152019-07-012019-07-152019-08-012019-08-152019-09-010.000.020.040.060.080.10DailyZipfweightchangePTL(IPv4)basedonAlexaPTL(IPv4)basedonMajesticPTL(IPv4)basedonUmbrellaPTL(IPv6)basedonAlexaPTL(IPv6)basedonMajesticPTL(IPv6)basedonUmbrellaAlexadomaintoplistMajesticdomaintoplistUmbrelladomaintoplistPrefix Top Lists
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Alexa
IPv4
2.9M
411k
IPv6
1.4M
610k
14.26% 43.54%
Majestic
IPv4
1.0M
121k
IPv6
505k
250k
12.08% 49.56%
Umbrella
IPv4
327k
26k
IPv6
206k
81k
8.03% 39.52%
Domains
Non-compliant
Share
Table 3: Non-compliance of domains per top list.
Figure 4: Distribution of non-compliant zones ordered by
their rank. The x-axis is normalized to the number of do-
mains per top list. The absolute number for the axes can be
found in Table 3.
In total, we find 12% of all IPv4 zones not respecting the RFC
requirement. This aligns with findings by Allman [4]. For domains
with IPv6 name servers, about half of all entries do not comply with
the RFC requirement (see Table 3). We find that even the top Alexa
entries google.com and youtube.com violate the RFC requirement
for IPv6. In comparison, for IPv4 the first offender is on rank 89
(w3schools.com) followed by rank 95 (onlinesbi.com) and rank 111
(ettoday.net).
Even though Google only hosts a small share of domains, the
importance of these domains corresponds to a large Zipf weight.
Cloudflare on the other side hosts more than 300k zones of the
Alexa list. Our results show that Cloudflare uses a single /48 for
their IPv6 name servers. United Internet, again one of the top five
providers, also uses a single /48 for their IPv6 name servers. These
three providers are among the most important ones in our prefix
top list. The fact that even these are non-compliant indicates a
general problem with the topological diversity of configured IPv6
enabled name servers.
Figure 5 shows the domains sorted by the rank of the highest-
ranking normalized prefix. In comparison to Figure 4, the IPv4
prefix sorted domains provide a smaller share on the top ranks.
While the domain top list ranked violations grow linearly from the
start, the prefix sorted ones start with a near linear growth only
after about 30%. The short and steep increase for Umbrella at about
35% is caused by the domain parking service Bodis. We assess the
DNS availability of parked domains as not critical. Parked domains
by this provider also appear in the Alexa and Majestic list but on
lower ranks. This is due to Umbrella reflecting the Cisco OpenDNS
query count while the other use a more complex metric.
This analysis shows that the topological diversity of configured
name servers supporting IPv6 is in a worse state compared to IPv4.
Nearly half of all zones have name servers in only one /48 prefix.
With this analysis we also provide a metric to compare different top
lists according to the deployed configurations. When evaluating
the RFC requirement on the stricter BGP prefixes we found similar
results as with normalized prefixes. We provide a list of prefixes
with the number of non-compliant zones to interested researchers.
This list can be used for prefix prioritization or comparisons.
Figure 5: Non-compliant zones ranked by the prefix they are
in. Similar to Figure 4 the x-axis also got normalized to the
number of successful resolved domains.
find that 2.3% of the Alexa Top 1k are violating zones. The Majestic
and Umbrella evaluation show similar results. For domains beyond
rank 1000 we observe a steep increasing share of non-compliant
domains, until the stable value becomes visible in the figure. Smaller
variations in the lower ranks may be caused by clustering effects
in top lists described by Rweyemamu et al. [20].
5 DISCUSSION AND LIMITATIONS
In this section we present the key results of our prefix top list
approach and discuss implications, limitations, detail our guiding
ethical considerations, and elaborate on data publication.
Prefix Top List stability and global view: As described in Sec-
tion 2 we provide a local view with our prefix top list. Furthermore,
as shown in Section 3, the prefix top lists are influenced by fluctua-
tions in domain-based top lists as well as DNS load balancing. To
further improve our resulting prefix top list in terms of stability
and global applicability, we propose to perform distributed DNS
measurements and repeatedly resolve popular domains to cover a
larger share of their prefixes.
DNS-based load balancing: In order to gauge the impact of geo-
load balancing on the prefix top list, we performed limited measure-
ments using commercial virtual machines in Newark and Singapore.
The measurements on these vantage points include only the top 65k
domains from each of the three domain-based top lists. Analyzing
020406080100Rankofdomains[%]020406080100%ofnon-compliantzonesAlexaIPv4MajesticIPv4UmbrellaIPv4AlexaIPv6MajesticIPv6UmbrellaIPv6020406080100Domainsbypreﬁxrank[%]020406080100%ofnon-compliantzonesAlexaIPv4#Preﬁxes1.73MMajesticIPv4#Preﬁxes376kUmbrellaIPv4#Preﬁxes105kAlexaIPv6#Preﬁxes365kMajesticIPv6#Preﬁxes118kUmbrellaIPv6#Preﬁxes90kIMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Naab, Sattler, Jelten, Gasser, and Carle
the Alexa-based top list, we find that the additional vantage points
were able to resolve only about 90% of domains compared to our
local vantage point. Further analysis is needed to understand this
divergence. Within the successfully resolved domains, 7% resolve
to different IPv4 addresses on at least one vantage point. When
aggregated to the normalized prefix level, the smallest object in the
prefix top list, only 5% of domains differ in their result.
In order to rate the impact of these differences, we recalculate
the AS-, BGP- and normalized prefix ranking by integrating the
additional addresses. As mentioned in Section 2.3, the base weight
for a domain name is shared between the resolved prefixes. We
compare the rankings by the sum of the absolute differences be-
tween the two variants (local view, vs.semi-global view), similar
to Section 3.2, i.e., 0 indicates no changes, while 2 stands for two
completely different lists. For the AS ranking we observe a Zipf
weight change of 0.0133. With respect to the BGP- and normalized
prefix based top lists we observe a change of 0.2244 and 0.2266,
respectively. The observed change for the normalized prefixes is
only slightly larger than for the BGP prefix. This can indicate that
address changes for load balancing purposes target different BGP
announcements as well. The low change rate with respect to the
AS ranking indicates that the load balanced domains are, however,
served from within the same AS. Those are strong indicators for
DNS-based geo-load balancing.
The impact of DNS geo-load balancing is clearly visible, and
it needs to be taken into account when using this prefix top list.
The two additional measurements of a subset of domains provide a
lower bound estimation to what impact needs to be expected. To
this goal, the measurements have to be scaled up to continuously
cover the entire domain lists. Moreover, additional vantage points
help to further investigate the impact of geo-load balancing.
Localized BGP dump: From the BGP dump we extract the origin
prefix and AS number. The path is not relevant for our results. We
compared the results of our BGP dump to archives of the Route
Views project [18]. Only about 1% of the Top 1k IPv4 BGP prefix
top list entries changes. These changes are substitutions of larger
prefixes with smaller ones. In IPv6 this effect is more prevalent
as the address space is larger, thus there are more possibilities for
more specific prefix announcements. These larger prefixes in our
top list have a minor impact on the total list. In the future, we plan
to merge different BGP dumps using only the longest originating
prefixes across all of them.
Web-based top lists: In order to improve the prefix top list gener-
ation, the shortcomings of the generation of proprietary top lists
have to be considered. The Alexa and Majestic top lists provide
a web-centered view on the Internet, which does not necessar-
ily represent the importance of generic Internet infrastructure. A
prefix top list based on the Umbrella top list, which is generated
from OpenDNS statistics also provides a biased view created by
OpenDNS users. The top lists do not include the www prefix by
default. The www subdomain DNS records can resolve to differ-
ent addresses. We plan to perform such measurements in order to
quantify the impact on the prefix top lists.
DNS resilience: As shown by Allman [4] and confirmed by our
measurements in Section 4, the resilience of the DNS ecosystem
in terms of topologically distributed name servers warrants im-
provements. Especially on the IPv6 side, half of all zones with
IPv6 name server addresses have less than two distributed name
server prefixes—contrary to what is mandated by best current prac-
tices [10]. Even the most popular domains such as google.com and
youtube.com are affected. For clients with IPv6-only resolvers, this
results in a decreased resilience compared to their IPv4 peers.
Ethical considerations: For our active measurements we incor-
porate the proposals by Allman and Paxson [5], Partridge and
Allman [19], and Dittrich et al. [9]. As we limit our query rate and
use conforming packets, we conclude that it is unlikely that our
measurements will cause problems on target systems. During our
measurement period, we received no abuse emails or complaints.
Data publication: We provide our prefix top list for fellow re-
searchers on https://prefixtoplists.net.in.tum.de/.
6 RELATED WORK
In the following section we present work in the fields of top lists
and DNS analysis which is most related to ours.
Top List analysis: In 2018, Scheitle et al. [21] published a thorough
analysis of different domain-based top lists. They analyze structure
and stability of top lists where the authors find low intersections
between lists and daily domain churn of up to 50%. In addition, they
also show that measurement studies using top lists depend on the
top lists themselves and on the dates of the used top lists. Taking
these findings into account, we rank domain-based top lists using
a Zipf distribution and aggregate them based on prefixes, which
results in more representative and stable prefix top lists.
Le Pochat et al. [15] confirmed many of Scheitle et al.’s findings.
With Tranco [16] they provide an aggregated combination of other
top lists over time. In addition to their work we apply a Zipf distri-
bution to rank domains based on popularity and aggregate prefixes
to create prefix top lists.
DNS analysis: Allman [4] analyzes DNS robustness over a period
of nine years. He finds a downwards trend of second level domains
with fewer than two name servers in distinct /24 prefixes in his zone
data analysis. In 2018 he finds that 11% of second level domains
violate RFC robustness requirements. With 12% we find a similar
share of domains in top lists not complying with the robustness
requirements. Our data also shows that the domains on the top
ranks perform better.
7 CONCLUSION
With prefix top lists we proposed a Zipf-weighted aggregation
of popular and distributed services (such as CDNs) into a single
metric. We showed temporal stability and found less than 0.05
weight changes per day, improving on the Alexa top list. When
analyzing name server resilience, we found top domains to be
better configured. Finally, IPv6 resilience still lags behind its IPv4
counterpart.
ACKNOWLEDGMENTS
The authors would like to thank the anonymous reviewers and our
shepherd Priya Mahadevan for their valuable feedback. This work
was partially funded by the German Federal Ministry of Education
and Research under the projects X-CHECK, grant 16KIS0530, and
the German-French Academy for the Industry of the Future.
Prefix Top Lists
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
REFERENCES
[1] Lada A Adamic and Bernardo A Huberman. 2002. Zipf’s law and the Internet.
Glottometrics 3, 1 (2002), 143–150.
[2] Alexa. May 13, 2019. Top 1M sites. https://www.alexa.com/topsites. http:
//s3.dualstack.us-east-1.amazonaws.com/alexa-static/top-1m.csv.zip.
[3] Alexa. May 13, 2019. What’s going on with my Alexa Rank? https://support.
alexa.com/hc/en-us/articles/200449614.
[4] Mark Allman. 2018. Comments On DNS Robustness. In Proceedings of the Internet
Measurement Conference 2018. ACM. https://doi.org/10.1145/3278532.3278541
[5] Mark Allman and Vern Paxson. 2007. Issues and Etiquette Concerning Use of
Shared Measurement Data. In Proceedings of the Internet Measurement Conference
2007. ACM. https://doi.org/10.1145/1298306.1298327
[6] Tim Berners-Lee. 1998. The Fractal nature of the Web. http://edshare.soton.ac.
uk/392/3/DesignIssues/Fractal.html.
[7] Stéphane Bortzmeyer. 2016. DNS Query Name Minimisation to Improve Privacy.
RFC 7816 (Experimental). https://doi.org/10.17487/RFC7816
[8] Cisco. May 13, 2019. Umbrella Top 1M List. https://umbrella.cisco.com/blog/
blog/2016/12/14/cisco-umbrella-1-million/.
[9] David Dittrich, Erin Kenneally, et al. 2012. The Menlo Report: Ethical Principles
Guiding Information and Communication Technology Research. US Department
of Homeland Security (2012).
[10] Robert Elz, Randy Bush, Scott Bradner, and Michael Patton. 1997. Selection
and Operation of Secondary DNS Servers. RFC 2182 (Best Current Practice).
https://doi.org/10.17487/RFC2182
[11] Oliver Gasser, Quirin Scheitle, Pawel Foremski, Qasim Lone, Maciej Korczynski,
Stephen D. Strowes, Luuk Hendriks, and Georg Carle. 2018. Clusters in the
Expanse: Understanding and Unbiasing IPv6 Hitlists. In Proceedings of the Internet
Measurement Conference 2018. ACM. https://doi.org/10.1145/3278532.3278564
[12] Oliver Gasser, Quirin Scheitle, Sebastian Gebhard, and Georg Carle. 2016. Scan-
ning the IPv6 Internet: Towards a Comprehensive Hitlist. In Proceedings of the
Traffic Monitoring and Analysis Workshop 2016.
[13] Jeremy Kepner, Kenjiro Cho, and KC Claffy. 2019. New Phenomena in Large-Scale
Internet Traffic. arXiv:cs.NI/1904.04396
[14] Serge A Krashakov, Anton B Teslyuk, and Lev N Shchur. 2006. On the universality
of rank distributions of website popularity. Computer Networks 50, 11 (2006),
1769–1780.
[15] Victor Le Pochat, Tom Van Goethem, Samaneh Tajalizadehkhoob, Maciej Ko-
rczyński, and Wouter Joosen. 2019. Tranco: A Research-Oriented Top Sites
Ranking Hardened Against Manipulation. In Proceedings of the Network and
Distributed System Security Symposium 2019. Internet Society.
[16] Victor Le Pochat, Tom Van Goethem, Samaneh Tajalizadehkhoob, Maciej Kor-
czyński, and Wouter Joosen. May 13, 2019. Tranco List. https://tranco-list.eu/.
[17] Majestic. May 13, 2019. The Majestic Million. https://majestic.com/reports/
majestic-million/.
[18] University of Oregon. 2019. Route Views Project. http://www.routeviews.org
[19] Craig Partridge and Mark Allman. 2016. Ethical Considerations in Network
Measurement Papers. Commun. ACM (2016). https://doi.org/10.1145/2896816
[20] Walter Rweyemamu, Tobias Lauinger, Christo Wilson, William Robertson, and
Engin Kirda. 2019. Clustering and the Weekend Effect: Recommendations for
the Use of Top Domain Lists in Security Research. In Proceedings of the Passive
and Active Measurement Conference 2019.
[21] Quirin Scheitle, Oliver Hohlfeld, Julien Gamba, Jonas Jelten, Torsten Zimmer-
mann, Stephen D. Strowes, and Narseo Vallina-Rodriguez. 2018. A Long Way to
the Top: Significance, Structure, and Stability of Internet Top Lists. In Proceed-
ings of the Internet Measurement Conference 2018. ACM. https://doi.org/10.1145/
3278532.3278574