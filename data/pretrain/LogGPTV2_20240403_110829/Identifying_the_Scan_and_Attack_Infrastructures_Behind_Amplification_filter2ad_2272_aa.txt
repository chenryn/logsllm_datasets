title:Identifying the Scan and Attack Infrastructures Behind Amplification
DDoS Attacks
author:Johannes Krupp and
Michael Backes and
Christian Rossow
Identifying the Scan and Attack Infrastructures
Behind Ampliﬁcation DDoS Attacks
Johannes Krupp
CISPA, Saarland University
Saarland Informatics Campus
Michael Backes
CISPA, Saarland University &
MPI-SWS
Saarland Informatics Campus
Christian Rossow
CISPA, Saarland University
Saarland Informatics Campus
ABSTRACT
Ampliﬁcation DDoS attacks have gained popularity and be-
come a serious threat to Internet participants. However,
little is known about where these attacks originate, and re-
vealing the attack sources is a non-trivial problem due to the
spoofed nature of the traﬃc. In this paper, we present novel
techniques to uncover the infrastructures behind ampliﬁca-
tion DDoS attacks. We follow a two-step approach to tackle
this challenge: First, we develop a methodology to impose a
ﬁngerprint on scanners that perform the reconnaissance for
ampliﬁcation attacks that allows us to link subsequent at-
tacks back to the scanner. Our methodology attributes over
58% of attacks to a scanner with a conﬁdence of over 99.9%.
Second, we use Time-to-Live-based trilateration techniques
to map scanners to the actual infrastructures launching the
attacks. Using this technique, we identify 34 networks as be-
ing the source for ampliﬁcation attacks at 98% certainty.
1.
INTRODUCTION
Ampliﬁcation attacks [26] have become one of the most
popular and dangerous classes of distributed denial-of-service
(DDoS) attacks nowadays. By spooﬁng the source IP ad-
dress of requests sent to open Internet services (such as
DNS or NTP servers), attackers can amplify traﬃc and dis-
guise their identity at the same time. Incidents in the re-
cent past have demonstrated that ampliﬁcation attacks can
cause attack bandwidths in the range of several hundreds of
Gbit/s [25, 32]. Ampliﬁcation attacks are not only a prob-
lem in terms of bandwidth, but also in terms of frequency
and global scale: During a ﬁve-month measurement period
in 2015, K¨uhrer et al. monitored over 1.5 million such at-
tacks (10k per day) that targeted victims in 192 countries.
Unfortunately, due to the IP-spooﬁng nature of ampliﬁca-
tion attacks, the true origin of the attacks remains hidden.
Consequently, victims do not know whom to contact to stop
the attacks, nor can they ﬁle legal complaints against attack
originators. Even worse, from the victim’s perspective, the
third-party reﬂectors may appear to be the attack origin,
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
CCS’16, October 24 - 28, 2016, Vienna, Austria
c(cid:13) 2016 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ISBN 978-1-4503-4139-4/16/10. . . $15.00
DOI: http://dx.doi.org/10.1145/2976749.2978293
giving false attribution hints. Despite the need for eﬀective
mechanisms to trace back the origin of ampliﬁcation attacks,
we still lack usable mechanisms. While there are attempts
to identify spooﬁng-enabled networks [4, 21], the coverage of
such active probes is limited, and without further evidence
of abuses, the identiﬁed parties feel little social pressure to
ban spooﬁng from their networks (e.g., using BCP38 [24]).
In this work, we tackle this problem and aim to attribute
ampliﬁcation attacks back to the infrastructures that have
caused them. Whereas application-layer DoS attacks can
be attributed to the origin due to the nature of the TCP
handshake, ﬁnding the source of ampliﬁcation attacks is in-
herently more diﬃcult, given that attackers (i) spoof the IP
addresses and (ii) use reﬂectors to diversify traﬃc sources.
IP traceback and similar packet marking schemes have long
been the de facto standard proposal to detect the origin of
spoofed traﬃc [31, 11, 36, 41, 15, 12, 14], but none of these
designs were ever deployed at scale to allow for global attack
attribution. Still, decades after spooﬁng attacks were dis-
covered, tracking the origin of attack traﬃc remains an ad-
hoc process that requires coordination between many ISPs
scattered around the world. The outcome of such tedious
manual attribution processes (if any) comes hours or days
after the traﬃc originated.
We follow a two-step process to establish an attribution
process that identiﬁes the infrastructures operated by at-
tackers to prepare and launch ampliﬁcation attacks.
In a
ﬁrst step, we aim to link the reconnaissance and the attack
phases by tracking which scan for ampliﬁers has resulted
in which attacks. We leverage the fact that scans cannot
forge their source IP address and thus learn about the scan-
ning infrastructures, despite the fact that attack traﬃc is
spoofed. Our key idea is to oﬀer each scanner a diﬀerent
set of potential honeypots that it can abuse. This way, we
implicitly encode a secret identiﬁer to the set of honeypots
that any subsequent attack will use, which varies per scan
source. In a second step, we test if the scan infrastructure
is also used to actually launch (and not just to prepare)
the attacks. We follow the observation that similar traﬃc
sources should have similar “distances” (in terms of hops) to
globally-distributed sensors. Using trilateration, we can link
scanners to attack origins based on hop counts.
With these proposals, we provide a practically-usable at-
tribution methodology for ampliﬁcation attacks. Our frame-
work fulﬁlls important goals: (i) Our method can work in
real-time; that is, we can attribute attacks on the ﬂy without
noticable delay between attack start and attribution out-
come.
(ii) The attribution does not require any coopera-
1426tion between ISPs, and thus solves one of the main practical
problems of existing solutions like IP traceback. (iii) Our
method gives probabilistic guarantees that show if—and at
what conﬁdence level—the attribution outcome is correct.
We have deployed our attribution methodology on a snap-
shot of 1,351,852 ampliﬁcation attacks monitored by honey-
pots during 23 weeks in 2015 and 2016. Our ﬁndings show
that we can identify the scanners that were used during the
reconnaissance phase of 58% of all attacks in our data set.
Further analyses show that only 20 scanners are responsible
for nearly 50% of the attacks. Using our hop-based trilatera-
tion process, we reveal that 22% of the attacks were actually
launched from scan infrastructures, for which we have per-
fect IP, network and geographical attribution information.
We report on the distribution of attack sources and reveal
black sheep networks that cause massive spooﬁng attacks.
To summarize, our contributions are as follows:
• We present a novel honeypot-based technique, selec-
tive response, that enables us to assign a ﬁngerprint
to scanners during the reconnaissance for ampliﬁca-
tion DDoS attacks and give conﬁdence guarantees for
subsequent attribution.
• We evaluate our technique on a set of 1,531,852 attacks
recorded by our honeypot, of which we can link 785,285
back to their corresponding scanner with a conﬁdence
of 99.9% or higher.
• We leverage the TTL ﬁeld of the IPv4 header to com-
pare the location of scanners to origins of attacks, after
evaluating our methodology on data collected by RIPE
Atlas probes.
• We ﬁnd that for 22% of all attacks, the scanner linked
to the attacks is also the source of the attack with 95%
conﬁdence.
The remainder of this paper is structured as follows. In
Section 2, we deﬁne our threat model, discuss the ethical
implications of our work, and describe the data used in this
paper in Section 3. Section 4 introduces a novel honeypot-
based technique to assign identiﬁers to systems that scan
for ampliﬁers. We evaluate this technique in Section 5. In
Section 6, we measure if the infrastructure used to scan for
ampliﬁers is identical to the infrastructure used to launch
ampliﬁcation DDoS attacks. After reviewing our initial as-
sumptions in Section 7 and providing an overview of related
work in Section 8, we conclude with Section 9.
2. BACKGROUND
In this section, we will deﬁne the threat model this paper
considers and discuss the ethical implications of our work.
2.1 Threat Model
The focus of this paper is on ampliﬁcation DDoS attacks.
Before deﬁning our threat model, we ﬁrst give a short de-
scription of this type of attack. The goal of an ampliﬁca-
tion attack is to render a system or network unusable by
ﬂooding the target’s network with a huge amount of traﬃc,
eventually leading to network congestion. To this end, an at-
tacker can leverage ampliﬁcation vectors in various network
protocols by which Internet-facing servers (such as DNS or
NTP) will send many packets towards the target. Our threat
model is therefore comprised of at least three parties: The
attacker, the victim, and a set of ampliﬁers.
In an attack, the attacker will send requests carrying a
spoofed IP header to innocent servers (ampliﬁers). These
ampliﬁers will then (unknowingly) direct their responses to-
wards the victim, given that the victim’s IP is speciﬁed as
the request source in the spoofed header. Thereby, an am-
pliﬁer will be acting as a “reﬂector”, eﬀectively hiding the
attacker’s IP address from the victim. Due to various am-
pliﬁcation vectors in the service implementations, the size
of the responses will be multiple times larger than the ini-
tial request sent by the attacker. This leads to a bandwith
ampliﬁcation, as the incoming bandwidth of traﬃc at the
victim’s system will be much higher than the one sent by
the attacker.
Several protocols have been identiﬁed to be ampliﬁcation-
prone [26], with ampliﬁcation factors (ratio between response
and request size) ranging from 5 to 4000, and misconﬁgured
systems and support for legacy options lead to a plethora
of potential ampliﬁers. Finding these ampliﬁers is a vital
step in attack reconnaissance, and is typically performed by
scanning, i.e., sending requests to every address in a given
range, and recording the answers. Therefore, we include this
additional fourth party of a scanner to our threat model.
While attackers could potentially leverage botnets to launch
ampliﬁcation attacks, previous work documented that the
vast majority of ampliﬁcation attacks stem from a single
origin [20], which also coincides with our ﬁndings.
In the
following, we will thus assume that attackers use only a sin-
gle system to launch their attacks.
We will further assume that scanners do not spoof their
source addresses when performing a scan. While techniques
to perform scans using spoofed addresses are known for TCP
(e.g.“idle scan” [27]), no similar techniques are known for
UDP. Since all known ampliﬁcation DDoS attacks are UDP-
based, this is a valid assumption.
2.2 Ethical Considerations
The data sets used in this paper were collected leveraging
AmpPot [20], a honeypot for DDoS ampliﬁcation, which
works by emulating a server for vulnerable protocols and
thereby becoming one of the ampliﬁers used in attacks. De-
ployment of such a honeypot pose a challenge from an ethi-
cal point of view: By design, an ampliﬁcation honeypot will
also act as an ampliﬁer in an actual attack and thus send
unwanted traﬃc towards DDoS victims.
We argue that the contribution towards attack traﬃc by
our honeypot is negligible and only incurs minimal harm
to the victim’s system. We did not modify the thresholds
chosen by the authors of AmpPot, by which the honeypot
will answer at most three requests per attack. Although we
deployed our honeypot to listen on 48 IPs, as discussed later,
at most 24 of those IPs will send replies towards a victim’s
system. Therefore, our honeypot will reply to at most 72
packets in total, i.e., a few kilobytes at most. Taking into
account that these attacks usually ﬂood a victim’s system
with traﬃc in the order of several Gbit/s, we conclude that
the contribution of our honeypot is negligible.
In addition, we oﬀered attack victims a method to opt out
from our measurements. During the course of our exper-
iments, we received three complaints that we immediately
answered describing our experimental setup, but none of the
complainers asked to opt out. We refer the interested reader
to a more detailed ethical discussion in [20].
Finally, please note that our (non-US) legislation and uni-
versity system does not require nor oﬀer IRB approvals, and
hence, we also could not request such an approval.
14273. DATASET
Our data was collected using AmpPot [20] by Kr¨amer
et al., a honeypot for DDoS amplﬁcation attacks. Amp-
Pot emulates a server oﬀering seven UDP-based protocols
which are known to be abused, namely QOTD, CharGen, DNS,
NTP, RIPv1, MSSQL, and SSDP. For incoming packets, Amp-
Pot will record all header ﬁelds as well as some protocol-
speciﬁc information from the packet’s payload. Due to the
vast amount of traﬃc in a DDoS attack, a sampling approach
is employed: Once a source exceeds 100 packets within one
hour, packets from this source will only be recorded with
a probability of 1/100. In order not to contribute to DDoS
ampliﬁcation attacks and to keep the harm on DDoS vic-
tims minimal, AmpPot will stop sending responses after the
third packet for sources exceeding 1 packet per minute. We
use the same conservative deﬁnition of an attack as Kr¨amer
et al., who deﬁne an attack as a stream of at least 100 consec-
utive packets from the same source to the same port without
gaps longer than one hour. Further details may be found
in [20]. We leveraged AmpPot in two ways:
First, to attribute attacks to scanners, we extended Amp-
Pot in that it only selectively replies to requests. The basic
idea behind this is that every scanner will see a diﬀerent
set of honeypots, which will become a distinctive feature
for attribution. We provide an in-depth description of this
technique in Section 4. We deployed our modiﬁed AmpPot
version on Nov. 25th, 2015.
Second, the authors of AmpPot granted us access to data
they collected from 11 honeypots, which were deployed in
late 2014 and have been operated since then. Combining
their data sets with ours allowed us to examine whether
scans and attacks were launched from the same infrastruc-
ture by comparing TTL values (cf. Section 6).
We base our results on data collected between November
25th 2015 and May 1st 2015 (exclusive). Within this time
our modiﬁed AmpPot version observed 1,351,852 attacks,
1,254,102 of which were also recorded by the secondary data
sets contributed by the AmpPot authors.
4. SELECTIVE RESPONSE
In this section, we describe the idea that our honeypots
selectively respond depending on the scanner origin—a fun-
damental technique that allows for attack attribution.
4.1 Intuition
Launching ampliﬁcation attacks requires prior knowledge
of a set of servers that can be abused as ampliﬁers during the
attack. Finding such servers is commonly achieved through
scanning, i.e., sending a query to every IP in a certain range,
and recording which IPs send back a reply. Since nowadays
scanning the entire IPv4 address space is feasible in a rea-
sonable amount of time even from a single machine [13, 16],
we assumed that in most cases the chosen ampliﬁer set was
based on the scan result(s) from a single scan system. Note
that we will verify this assumption in later analyses.
The main goal of this work is to correlate scan events with
ampliﬁcation attacks. We therefore follow the idea that ev-
ery scanner will ﬁnd a diﬀerent (ideally unique) subset of
our deployed honeypots. We inﬂuence the scan result in