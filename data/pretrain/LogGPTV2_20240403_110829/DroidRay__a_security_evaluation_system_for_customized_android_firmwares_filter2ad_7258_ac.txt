F893F4BE1A0A280BD62887A2BF2C36C6
FD2EA6A845A86AAB0122BB2ADF90F2C1
934
215
225
183
185
1026
262
87
207
83
226
387
937
628
406
113
161
193
81
4.1.2
4.0.3
4.0.4
4.0.4
4.2.2
4.2.1
4.1.2
2.3.7
4.0.4
2.3.7
4.0.4
4.1.2
2.2.2
4.1.2
4.2.1
2.3.7
4.1.2
4.2.2
2.3.7
GT-I9300
ZTE U970
GT-I9300
HUAWEI C8812
Galaxy Nexus
GT-I9300
X907
LT15i
Incredible S
Blade
GT-I9300
LT26i
ZTE-U V880
GT-I9300
ZTE N986
GT-I9000
GT-I9300
SGH-I897
Wildﬁre S
244
83
83
82
78
249
85
18
74
55
86
164
74
170
156
67
64
83
55
/optional/other/digua/preload/
digua.apk
/system/framework/framework.jar
/system/app/BaiduReader.apk/assets/
huafubao.apk
/system/app/168_(2216G7).apk
/system/preload/digua.apk
/optional/other/digua/preload/
digua.apk
/system/app/YXPhoneBook.apk
/system/app/Youni_1.1.16_1103.apk
/system/etc/product/applications/
duoku.apk
/system/app/BaiduReader.apk
/system/app/iReader.apk
/system/app/BaiduReader.apk
system/app/SecuritySms.apk
/system/etc/product/applications/
duoku.apk
/system/app/BaiduReader.apk
/system/app/youni_2.2.2.3.apk
/system/app/Plugnew.apk
/system/preload/digua.apk
/system/app/iReader.apk
Malware
Name
Agent
Agent
Agent
Agent
Agent
Agent
JSmsHider
Hippo
Agent
Agent
Agent
Agent
Stesec
Agent
Agent
Hippo
CEPlugnew
Agent
Agent
Table 4: Malicious ﬁrmwares with pre-installed apps
5.1 System Signature Vulnerability Detection
As mentioned in Section 4, developers should not use the
AOSP default key pairs to build their released Android ap-
plications because anyone can get these key pairs from the
AOSP. For Android ﬁrmwares, it also have two signature
mechanisms for integrity veriﬁcation and system level per-
mission control. However, our experiment result shows that
there exist many Android ﬁrmwares which were signed by
the default AOSP key pairs and this will create two types
of default signature security problem:
(1) Android ﬁrmware default signature problem: The
Android ﬁrmware signature mechanism is similar to other
Android applications. The signing program ﬁrst calculates
the SHA1 value of each ﬁle in the ﬁrmware, then it uses
a private key to encrypt these SHA1 values. The signing
program will put the encrypted SHA1 values and the pub-
lic key in the “META-INF” folder of the ﬁrmware. Before the
ﬁrmware can be ﬂashed to an Android device, the recovery
partition will use the encrypted SHA1 values and its public
key to check the integrity of each ﬁle as well as to verify the
signature of the ﬁrmware. Note that the recovery partition
of some manufacturers’ products (e.g., Samsung) will check
whether the public key is indeed its own key or not. If it
is not, one cannot ﬂash the ﬁrmware to the ﬂash memory.
However, many users may choose to turn oﬀ the signature
veriﬁcation process so to install the third-party ﬁrmwares.
By analyzing all of our 250 downloaded ﬁrmwares, we dis-
covered that 206 (82.4%) ﬁrmwares have the same public
key, which is the test key of the default key pairs provided
by AOSP. The result of our analysis is showed in Table 5.
For example, the ﬁfth row of the table shows the public key
information of the AOSP and there are 206 ﬁrmwares using
this key pairs. Note that if malware writers use the AOSP
default key pairs to create ﬁrmwares, this will give people
the false impression that the Android ﬁrmware was created
by the oﬃcial Android open source project.
(2) Android system default signature problem: The
system signature information is stored at: “/system/frame-
work/framework-res.apk/META-INF/CERT.RSA”. By using the
pkcs7 function of the “openssl” library, the system can parse
the signature information from “CERT.RSA”. Note that the
Android system signature is diﬀerent from the Android ﬁrmware
signature. The Android ﬁrmware signature is used to check
the integrity of the ﬁles in the ﬁrmware. But the system
signature is used for permission control. If one application
has the same public key as the system, it can use the system
level permissions.
By analyzing all of our 250 downloaded ﬁrmwares, we dis-
covered that 142 (56.8%) Android ﬁrmwares have the default
public keys, which are part of the default key pairs provided
by AOSP [10]. This is alarming because if a malware writer
uses the AOSP key pairs to sign their malware, then the
malware can get the system level privilege. With the sys-
tem level privilege, the malware can silently install new ap-
plications and modify other applications. The result of our
analysis is showed in Table 6 (because of the page limit, the
full list can be found at https://www.dropbox.com/s/8fbl
0yujqoaja1h/SystemSign.xls). For example, the ﬁrst row
of the table shows the public key information of the AOSP
and there are 134 Android ﬁrmwares using this key pairs.
5.2 Network Security Vulnerability Detection
Android is a derivative based on a modiﬁed Linux 2.6
with a Java programming interface, so it has components
(e.g., hosts and iptables) similar to those of Linux to control
network ﬁltering and forward. In this subsection, we present
the security issues of these components.
(1) Hosts security: The hosts ﬁle is a plain text ﬁle used
by an operating system to map host names to IP addresses.
For example, if the user wants to visit “www.google.com” and
if there is a map record in the “/etc/hosts” ﬁle, the system
will not request IP lookup from a DNS server but instead, it
directly uses the IP address which is recorded in the hosts
ﬁle. Therefore, it would be very dangerous if the hackers
modify this ﬁle and add malicious redirection information.
For example, if a user wants to visit some legitimate websites
listed in the “/etc/hosts” ﬁle, a compromised system will
MD5 of Signature
Signature Information
1f1b2fd4e0bded6ca5088afa287b5332
5fd1d7579992cff701ea20873e8ac99f
ab82cce8af68057b7ab8867b5dd75d65
943e1151975cfd342a95f2a7512bbff8
e89b158e4bcf988ebd09eb83f5378e87
fcf645259f609183606ab55da67fc9db
fe3c74f0431ea0dc303a10b6af6470fc
No Signature
Total
EMAIL=PI:EMAIL, CN=zte.com.cn, OU=Product R&D Center I, O=ZTE Corpora-
tion, L=Nanjing, C=CN
CN=Smaritsan
EMAIL=PI:EMAIL, CN=Amoi, OU=Amoi, O=Amoi, L=Xiamen, ST=Fujian, C=CN
EMAIL=PI:EMAIL, CN=12001, OU=M6, O=OPPO, L=DongGuang, ST=GuangDong, C=CN
EMAIL=PI:EMAIL,CN=Android,OU=Android,O=Android,L=Mountain
View,ST=California,C=US
EMAIL=PI:EMAIL, CN=SmartPhone, OU=PLF, O=OPPO, L=ChangAn, ST=DongGuan, C=CN
EMAIL=PI:EMAIL,CN=BMS,OU=BaiduYi,O=Baidu,L=Haidian,ST=Beijing,C=CN
No Signature Information
# of
Firmware
1
2
1
1
206
2
9
28
250
Table 5: Firmware signature count with highlighted row indicating misleading signature
MD5 of Signature
Signature Information
# of
Firmware
8ddb342f2da5408402d7568af21e29f9
d087e72912fba064cafa78dc34aea839
2eed75e85b154fb0c1013ecd16115c84
701478a1e3b4b7e3978ea69469410f13
4abc4868a502c9c77b50ca9deb53b672
bb7bce1b1090fc3a6b67ebc88701acdd
0f92c3b692319a1daabac6c94b07fbee
10637522aa8f840170c50fcbe61227ac
9e5b0111e0408bb405c819ea0784b69d
a7babf3e3872080766e5331943aafa58
75711ca27d4693cc27432c47ac8582c0
d4c6ea170fd9ef95572ab50318b695de
2bf07615199371b0c35ef2e23936b345
e89b158e4bcf988ebd09eb83f5378e87
8701cf44ad2623c4a5c89944b24d6417
...
Total
emailAddress=PI:EMAIL,CN=Android,OU=Android,O=Android,L=Mountain
View,ST=California,C=US
emailAddress=PI:EMAIL,CN=Samsung Cert,OU=DMC,O=Samsung Corpora-
tion,ST=South Korea,C=KR
CN=Tencent,OU=Tencent,O=Tencent,L=Beijing,ST=Beijing,C=CN
emailAddress=PI:EMAIL,CN=MIUI,OU=MIUI,O=Xiaomi,L=Beijing,ST=Beijing, C=CN
emailAddress=PI:EMAIL,CN=rom-platform,OU=BaidYi,O=Baidu,L=Haidian,ST=Beijing,
C=CN
emailAddress=PI:EMAIL,CN=AndroidTeam,OU=TerminalCompany,O=Huawei,
L=Shengzhen, ST=Guangdong,C=CN
emailAddress=PI:EMAIL,CN=TAPAS,OU=SDG,O=TAPAS,L=BeiJing,ST=BeiJing,
C=CN
CN=Smartisan
CN=Sony_Ericsson_E_Platform_Signing_Live_864f,O=Sony Ericsson Mobile Communica-
tions AB, C=SE
emailAddress=PI:EMAIL,CN=Android,OU=Android,O=Android,L=Taoyuan,ST=Taoyuan,
C=TW
emailAddress=PI:EMAIL,CN=Android,OU=Android,O=Android,L=Mountain
View,ST=California,C=US
emailAddress=PI:EMAIL,CN=SmartPhone,OU=PLF,O=OPPO,L=ChangAn,ST=DongGuan,C=CN
CN=lidroid,OU=lidroid,O=lidroid,L=xi’an,ST=shaanxi,C=CN
emailAddress=PI:EMAIL,CN=Android,OU=Android,O=Android,L=Mountain
View,ST=California,C=US
CN=lidroid.com,OU=lidroid.com,O=xian,L=shaanxi,ST=SX,C=86
...
134
24
13
12
8
9
5
4
7
6
5
4
3
3
2
...
250
Table 6: System signature count with highlighted row indicating AOSP default signatures
not connect the user to the legitimate server but instead,