title:SHAMROCK: self contained cryptography and key management processor
author:Daniil M. Utin and
Roger Khazan and
Joshua Kramer and
Michael Vai and
David Whelihan
POSTER:  
SHAMROCK: Self Contained Cryptography and  
Key Management Processor 
Daniil Utin 
MIT Lincoln Laboratory 
244 Wood Street 
Lexington, 02420, USA 
PI:EMAIL 
Roger Khazan 
MIT Lincoln Laboratory 
244 Wood Street 
Lexington, 02420, USA 
PI:EMAIL 
Joshua Kramer 
MIT Lincoln Laboratory 
244 Wood Street 
Lexington, 02420, USA 
PI:EMAIL 
Michael Vai 
MIT Lincoln Laboratory 
244 Wood Street 
Lexington, 02420, USA 
PI:EMAIL 
David Whelihan 
MIT Lincoln Laboratory 
244 Wood Street 
Lexington, 02420, USA 
PI:EMAIL 
ABSTRACT 
In  this  poster,  we  describe  a  one-size-fits-many  Intellectual 
Property  (IP)  core  which  integrates  advanced  key  management 
technology and streaming encryption into a single component to 
protect data in-transit. 
Categories and Subject Descriptors 
E.3 [Data Encryption]: Public key cryptosystems; Standards 
Keywords 
key  management;  cyber  security;  cryptography;  self-contained 
encryption; high-Assurance data protection; identity management; 
hardware 
IP  core;  FPGA;  cryptographic  component;  key 
management protocol. 
PROBLEM 
Modern  cryptography  offers  a  variety  of  schemes  for  the 
protection of information at-rest on devices and in-transit among 
This  work  is  sponsored  by  the  United  States  Air  Force  under  Air  Force 
Contract  FA8721-05-C-0002.  Opinions,  interpretations,  conclusions  and 
recommendations are those of the authors and are not necessarily endorsed by 
the United States Government. 
Permission to make digital or hard copies of part or all of this work for personal 
or  classroom  use  is  granted  without  fee  provided  that  copies  are  not  made  or 
distributed for profit or commercial advantage, and that copies bear this notice 
and the full citation on the first page. Copyrights for third-party components of 
this  work  must  be  honored.  For  all  other  uses,  contact  the  owner/author(s). 
Copyright is held by the author/owner(s). 
CCS’13, November 4–8, 2013, Berlin, Germany. 
ACM 978-1-4503-2477-9/13/11. 
http://dx.doi.org/10.1145/2508859.2512515 
devices.  A  cryptographic  scheme 
typically  “scrambles”  or 
“unscrambles”  information  using  a  data-permutation  algorithm 
and  a  short  cryptographic  key.  The  security  of  the  scheme 
depends  on  the  properties  of  the  algorithm  and  the  quality  and 
secrecy of the key. Thus, cryptographic keys need to be created 
and managed carefully. In particular, they need to be protected at-
rest  and  in-transit,  which  itself  calls  for  the  use  of  various 
cryptographic schemes.  
Although  many  cryptographic  schemes  have  been  standardized 
and  implemented  efficiently  in  software  and  hardware,  these 
solutions  are  not  universally  used  or  embedded  in  devices.  The 
two  main  reasons  are  the  lack  of  generic,  easy-to-deploy,  and 
easy-to-use  solutions  for  key  management,  and  the  challenge  of 
integrating  various 
and  key  management 
components  into  a  holistically  secure  design.  While  individual 
cryptographic components exist and may be known to be secure, 
there is no known recipe for integrating different components into 
secure  designs  that  guarantee  security  of  keys  and  other 
information,  at-rest  and  in-transit.  It  is  in  such  integration  that 
major  challenges  exist  and  vulnerabilities  are  oftentimes 
introduced. 
cryptographic 
SOLUTION 
MIT  Lincoln  Laboratory  developed  a  one-size-fits-many 
called  SHAMROCK1. 
Intellectual  Property 
SHAMROCK  integrates  advanced  key  management  technology 
and streaming encryption into a single component to protect data 
in-transit.  It  is  designed  for  low  Size,  Weight,  and  Power 
applications and can be embedded into a wide variety of devices, 
enabling entire systems to be secured with the same component.  
core, 
(IP) 
1  SHAMROCK 
stands 
Cryptography and Key-management. 
for  Self-contained  High-Assurance  MicRO 
1419In
n  this  poster,  w
m
management  fun
te
erms of energy a
we  describe  the 
nctionality,  upg
and speed. 
SHAMROCK 
gradeability  and
embedment,  ke
d  performance 
ey-
in 
as 
e,  accessible 
U
Using  a  simple
ce containing 
in
nterface, a devic
chip  can  use 
SHAMROCK  c
S
SH
th
he 
HAMROCK’s 
c
cryptographic 
components, 
Advanced 
s
an 
such 
ndard  (AES) 
E
Encryption  Stan
ecure its data 
c
cipher core, to se
in
nternally  and  t
o  protect  its 
with  other  devic
c
communication  w
 handle all of th
S
SHAMROCK to
f
for the operation 
of the cryptogra
ces  [1].  The  de
he key managem
aphic componen
vice  can  also  u
ment tasks require
nts.  
use 
ed 
er and is a part o
dinates  a  numb
ns  implemented 
XILINX’s  FPGA
much  lower  (mo
of the SHAMRO
er  of  hardware
in  VHDL.  Kin
As,  with  the  s
ore  than  50%)  t
OCK IP core. 
e-accelerated 
ntex-7  is  the 
static  power 
than  that  of 
micro-controlle
nages  and  coord
graphic  function
generation  of  X
mption  being  m
x-6. 
central 
It  man
cryptog
latest  g
consum
Virtex
T
These  key  mana
c
creating cryptogr
p
protecting keys a
m
making keys ava
d
decryptions,  del
d
devices,  archivin
e
etc.  SHAMROC
c
contained,  secu
in
ncorporating cry
agement  tasks 
raphic keys, asso
at rest in both v
ailable for autho
livering  keys 
ng  keys,  evolvin
CK  integrates  al
ure  design 
the
yptographic prot
may  include  op
ociating keys wi
volatile and non
orized encryption
securely  to  au
ng  keys  with  tim
l  of  the  compo
ereby  simplifyin
ections into appl
as 
perations  such 
es, 
ith their purpose
ry, 
-volatile memor
ed 
ns and authorize
ote 
uthorized  remo
me,  retiring  key
ys, 
lf-
nents  into  a  sel
of 
ng 
lications.  
task 
the 
Figure 1. Kin
ntex 7 Dynami
ic Power (50M
MHz) 
W
While  a  self-con
s
solution is novel 
c
creating this inte
a
attain high perfor
a
all  at  the  same  t
ty
ypically comput
c
components,  suc
c
cryptographic  fu
h
hardware (for ex
[
2]),  while  othe
a
as  key  managem
h
higher-level lang
s
softcore  micro-c
in
ntegrated  circu
m
micro-controller,
a
and  their  extens
S
SHAMROCK, 
m
manufactured  an
im
mplementations 
a
application  and 
lo
ower-power,  h
s
strengthen securi
a
and cost of verify
ted  crypto  and 
ntained,  integrat
ve made a numbe
in itself, we hav
One of the innov
egrated design. O
wer, flexibility, a
rmance, low pow
chieved  by  impl
time.  This  is  ac
nding 
tationally deman
ndard 
ch  as  the  stan
ly  in 
unctions,  directl
HDL 
xample using VH
r  components, 
such 
in  a 
ment  protocols, 
guage, such as C
, in a 
e  the 
controller  inside
-core 
uit.  The 
soft-
ferent  key  mana
,  allows  for  diff
ily  created  for 
sions  to  be  eas
th
he 
integrated 
even  after 
nto  an  applicatio
nd  integrated  in
of  the  cryptog
graphic  compon
anagement  com
by  the  key  ma
operations.  Ot
higher-speed  o
dware design and
ity through hard
ying and modify
ying the design. 
key  manageme
er of inventions 
vations is a way 
and extensibility
lementing  certai
ent 
in 
to 
y – 
in, 
agement  protoco
and  deployed 
circuit  core 
on.  The  hardwa
nents  used  by  th
mponents  facilita
ther 
innovatio
d reduce the effo
ols 
in 
is 
are 
he 
ate 
ns 
ort 
I
IMPLEMEN
A
AND PERF
I
Implementation
b
been realized as 
6
6  and  Kintex-
im
mplemented  in 
T
Tensilica  106mic
NTATION 
E ANALYS
ORMANCE
n  and  performa
ance  analysis:  S
wo types of Xilin
an IP core on tw
key  managemen
7  [3].  The  k
ng  language  an
C  programmin
cro  soft-core  mi
icro-controller  [
SIS 
SHAMROCK  h
nx FPGAs: Virte
nt  protocols  a
nd  execute  in  th
[4].  106micro  is
has 
ex-
are 
he 
s  a 
ming  
Figure 2. Key
F
(FPGA@
1 shows the dy
ferent cryptograp
of  these  operat
ming AES, which
gures, observe th
power,  especial
ons,  such  as  the
e a whole set of 
me  to  perform 
res  them to  thos
he former is clos
CPU.   
y Management
@50MHz / CP
ynamic power c
phic operations i
tions  would  run
h protects applic
hat dynamic pow
ly  for  Streamin
e  generation  and
cryptographic o
these  two  op
se  on  an ARM 
se to an order o
t Function Tim
PU@72MHz)
onsumption on 
in SHAMROCK
n  infrequently, 
cation data.  Com
wer is significant
ng  AES.  Key  m
d  processing  of 
operations.  Figu
perations  on  Ki
Cortex  M3  mic
of magnitude fas
Kintex-7 of 
K. Typically, 
except  for 
mparing the 
tly less than 
management 
f key  wraps, 
ure 2 depicts 
intex-7  and 
croprocessor 
ster than the 
rences 
ps://en.wikipedia
ps://en.wikipedia
ps://en.wikipedia
ps://en.wikipedia
ps://en.wikipedia
anced_Encryptio
a.org/wiki/Adva
a.org/wiki/VHDL
L 
a.org/wiki/Xilinx
x 
lica 
a.org/wiki/Tensi
a.org/wiki/ARM
M_Cortex-M 
on_Standard 
Figure 
the diff
most  o
Stream
two fig
static  p
functio
involve
the  tim
compar
[5]. Th
ARM C
Refer
[1] http
[2] http
[3] http
[4] http
[5] http
1420