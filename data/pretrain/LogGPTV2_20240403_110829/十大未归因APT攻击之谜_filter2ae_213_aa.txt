# 十大未归因APT攻击之谜
##### 译文声明
本文是翻译文章，文章原作者 CNTIC情报组编译，文章来源：国家网络威胁情报共享开放平台
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
概述
定向攻击的溯源归因是十分棘手的工作，通常认为最好由执法机构给出归因结果。原因在于，虽然在90%的情况下，通过语言习惯和地位位置等就可以挖掘出一些关于攻击者的信息，但在其他10%的情况下可能会导致尴尬的归因错误或更糟的结果。高水平的攻击者会在受害者环境中隐藏自身，并尽力抹除痕迹。他们利用多种技术手段，使得调查活动困难重重。例如使用LOLBINS（一种利用系统已有二进制文件进行攻击的方法）、合法的渗透测试工具以及无文件恶意软件，放置虚假标志来误导安全研究人员。这些反侦察技巧通常使威胁归因成为运气问题。这就是为什么多年来一直有一定比例的定向攻击未得到归因的原因。本文介绍了10个最扑朔迷离的未归因APT攻击案例。
1.TajMahal框架
2018年底，一个名为TajMahal的复杂间谍框架被发现。它由两个不同的软件包组成，包名为东京（Tokyo）和横滨（Yokohama），能够窃取各种数据，包括受害者主机上刻录的光盘数据和发送到打印机队列的文件。每个软件包都包括许多恶意工具：后门、键盘记录器、下载器、编排器、屏幕和网络摄像头抓取器、录音机等。两个软件包中共包含多达80个恶意模块。
在首次检测到TajMahal项目之前，它已经活跃了至少五年。更神秘的是，唯一已知的受害者是一个备受瞩目的外交实体。谁是袭击的幕后黑手，是否有其他的受害者，或者整个工具集是否只是为了渗透一个组织而开发的，这些问题仍然没有答案。
2.DarkUniverse
DarkUniverse是在2018年被发现并报告的另一个APT框架。从2009年到2017年，在野时间至少八年，其目标为叙利亚、伊朗、阿富汗、坦桑尼亚、埃塞俄比亚、苏丹、俄罗斯、白俄罗斯和阿拉伯联合酋长国等国家的至少20个民用和军事实体。DarkUniverse通过带有恶意Microsoft
Office文档附件的电子邮件进行鱼叉攻击。它由负责不同间谍活动的数个模块组成，如键盘记录、邮件流量拦截、截图、收集各种系统信息等。
DarkUniverse被发现的唯一案例，是他们的ItaDuke恶意软件是通过带有明显零日漏洞的名为Visaform
Turkey.pdf的PDF下载的。DarkUniverse仍然没有归属，目前还不清楚相关攻击者在2017年后做了什么。
3.PuzzleMaker
2021年4月，研究人员使用复杂的零日漏洞链检测到几次定向攻击，攻击者使用了一个Google Chrome
RCE漏洞对系统进行渗透。该漏洞的详情不明，但疑似CVE-2021-21224，它使攻击者能够在浏览器沙盒内执行任意代码。成功渗透进系统后，攻击者利用Windows内核中的信息披露漏洞CVE-2021-31955来获取EPROCESS结构的内核地址，并使用另一个Windows内核漏洞CVE-2021-31956提权。
在成功利用这些漏洞后，由stager、dropper、service和远程shell四个模块组成的恶意软件被投递到被感染系统，并最终植入一个称为PuzzleMaker的有效载荷。
PuzzleMaker的唯一薄弱环节，是采用了和CHAINSHOT恶意软件相同的漏洞后利用技术，而后者至少被两个具有国家背景的攻击者用于已知的APT活动。然而，该技术是公开的，可以被各种团体独立使用，无法作为归因证据。
4.ProjectSauron
ProjectSauron(别名Strider)于2015年9月首次被发现，当时卡巴斯基反定向攻击平台在客户组织中检测到异常网络流量。流量来自加载到域控制器服务器内存中的可疑库，并注册为Windows密码过滤器，该过滤器可以访问管理帐户的纯文本密码。事实证明，它是针对俄罗斯、伊朗、卢旺达，可能还有意大利语国家的政府、电信、科学、军事和金融组织的复杂APT平台的一部分。
图1：ProjectSauron的名字来自其配置中提到的“Sauron”
ProjectSauron平台为模块化结构。针对每个受害者的核心植入部件都是独一无二的，具有不同的文件名和大小，以及根据目标环境量身定制的时间戳。因此，在一个组织中发现的样本对其他受害者的价值很低。这些核心植入部件充当后门，下载其他模块并在内存中运行命令。这些模块执行特定的间谍功能，例如键盘记录、窃取文档或从被感染的计算机和连接的USB设备劫持加密密钥。一个特殊的模块甚至可以通过被感染的USB设备访问物理隔离系统。
ProjectSauron背后的攻击者使用复杂的C2基础设施，涉及美国和欧洲的多个ISP和IP地址。该攻击者尽一切努力不在其运营中留下可识别的模式。唯一可以确认的是，没有国家级的资源支撑，这种程度的复杂性几乎无法实现。还值得注意的是，该攻击者可能从其他著名的APT攻击中学习，如Duqu、Flame、Equation和Regin。
图2：从其他著名的APT攻击中学习
5.USB Thief
2016年，ESET的安全研究人员发现了一种具有自我保护机制的USB恶意软件，称为USB
Thief。该恶意软件由六个文件组成，其中两个是配置文件，而其他四个是可执行文件。这些文件被设计成按照预定的顺序执行，其中一些文件是经过AES128加密的。加密密钥是使用唯一的USB设备ID和某些磁盘属性生成的。这使得除受感染的USB驱动器外，USB
Thief很难在任何地方解密和运行。
USB
Thief中的三个可执行文件是加载下一阶段文件的加载程序。为了确保文件按正确的顺序加载，它们使用之前加载的文件的哈希值作为其名称。此外，一些文件会检查父进程的名称，如果发现错误，则会立刻终止。最终的有效负载是一个数据窃取器，它首先查找配置文件，以获取要泄露哪些数据、如何加密以及存储位置的信息。被窃取的数据存储在被感染的USB设备上。
USB
Thief中实现的另一个有趣的技术是使用某些应用程序的便携式版本，如记事本、Firefox和TrueCrypt，来诱骗用户运行第一个恶意软件加载程序。为了实现这一目标，它以插件或动态链接库的形式注入这些应用程序的命令链。当用户运行受感染的应用程序时，恶意软件也会随之启动。该恶意软件的传播范围并不广泛，很有可能是用于某一资产的高度针对性的攻击。
ESET团队的进一步研究表明，USB Thief疑似与Lamberts APT组织有关。