title:POSTER: Mining Elephant Applications in Unknown Traffic by Service
Clustering
author:Hongliang Yu and
Yong Zhao and
Gang Xiong and
Li Guo and
Zhen Li and
Yong Wang
POSTER: Mining Elephant Applications in Unknown Traffic 
by Service Clustering 
Hongliang Yu 
School of Computer Science, Beijing 
University of Posts and 
Telecommunications, China  
PI:EMAIL 
Yong Zhao, Gang Xiong,  
Li Guo, Zhen Li 
Institute of Information Engineering, 
Chinese Academy of Sciences, 
China 
PI:EMAIL 
Yong Wang 
The National Computer Network 
Emergency Response Technical 
Team/Coordination Center of China 
PI:EMAIL 
ABSTRACT 
Network  traffic  classification  is  of  great  importance  for  fine-
grained  network  management  and  network  security.  However, 
with the rapid development of new network applications in recent 
years, traffic that cannot be identified by classifiers accounts for 
an  increasing  ratio,  which  brings  a  great  challenge  for  network 
operators.  Most  of  the  unknown  traffic  is  usually  generated  by 
only a few or some certain kinds of applications. We call this kind 
of  traffic  as  the  elephant  traffic.  It  is  generally  recognized  that 
traffic sharing the same server IP and server port is generated by 
the same application. In this paper, we say that they are belonging 
to  the  same  service.  Therefore,  we  propose  a  novel  method,  in 
which  service-based  statistical  features  are  used  for  cluster 
analysis,  to classify these elephant traffic. Preliminary results on 
a  real  network  traffic  dataset  show  that  our  method  is  able  to 
automatically identify similar unknown applications. We believe 
that  classifying  unknown  traffic  in  service  perspective  is  a 
promising direction. 
Categories and Subject Descriptors 
C.2.3 [Computer Communication Networks]: Network 
monitoring; Network management 
Keywords 
Service, Unknown Traffic, Traffic Classification, Elephant 
Applications. 
1.  INTRODUCTION 
is 
Traffic  classification 
the 
the  proportion  of  unidentified 
foundation  of  network 
management and network security. To operate and manage  the 
network effectively, it is essential for the operators to obtain  a 
proper understanding of application protocols in network traffic. 
In  recent  years,  as  more  and  more  new  network  applications 
emerging,  many  of  them  use  a  proprietary  application  layer 
protocol.  It  makes 
traffic 
increasing. On the other hand, many attackers trend to disguise 
Permission to make digital or hard copies of part or all of this work for 
personal or classroom use is granted without fee provided that copies are 
not  made  or  distributed  for  profit  or  commercial  advantage  and  that 
copies bear this notice and the full citation on the first page. Copyrights 
for third-party components of this work must be honored. For all other 
uses,  contact 
the 
owner/author(s). 
CCS’14, November 3–7, 2014, Scottsdale, Arizona, USA. 
ACM 978-1-4503-2957-6/14/11. 
http://dx.doi.org/10.1145/2660267.2662391 
the  Owner/Author.  Copyright 
is  held  by 
malicious traffic, so that they could bypass the detection system. 
So it is very import to study the unidentified traffic, describe the 
unknown  traffic,  identify  new  protocols  or  applications  among 
them and find malicious traffic. J Zhang et al. proposed a series 
of methods to identify unknown application in [1, 2, 3] and they 
called it “zero-day” application. The purpose of this paper is to 
address the issue of unknown traffic classification, while and the 
main contribution of this paper is that this is the first attempt to 
use the service statistical features to classify unknown traffic. 
As  it  is  unable  to  obtain  the  fingerprint  of  these  unknown 
protocols, we use machine learning method to classify the traffic. 
The application of machine learning method in the area of traffic 
classification [4, 5, 6] is based on statistical features, and can be 
generally  divided  into  two  categories,  supervised  method  and 
unsupervised method. The supervised methods need pre-labeled 
train samples to generate a classifier to identify new traffic flows. 
And unsupervised methods group traffic flows that have similar 
characteristics  without  any  pre-labeled  samples.  According  to 
the characteristics of these classification methods, unsupervised 
method is more suitable for the unknown traffic classification. 
To use machine learning methods for traffic classification, we  
need to extract features of network traffic. Traditional machine 
learning methods [7, 8] commonly used flow statistical features, 
but in this scheme, we use the service statistical features instead. 
Service mentioned here refers to all TCP traffic generated by a 
server IP-port pair. Our approach is based on the assumption that 
the  traffic  that  shares  the  same  3-tuple  {server  IP,  server  Port, 
Protocol} is using the same application layer protocol. Therefore, 
we believe that the use of service statistical features reflects the 
characteristics  of  a  protocol  better,  and  can  achieve  better 
clustering results. 
Currently,  Baldi  et  al.  [9]  have  proposed  a  service-based 
method  for  traffic  classification.  Their  approach  is  simple  and 
effective.  However  their  scheme  relies  on  the  results  of  other 
classification methods, such as deep packet inspection, and thus 
cannot handle unknown protocol traffic. 
2.  THE PROPOSED APPROACH 
In  order  to  classify  unidentified  traffic,  and  then  find  a  new 
kind of protocol, we propose a service-based clustering method. 
Our approach is based on a very simple assumption that a certain 
host offers a kind of service on a stable port over a certain time 
span. In this paper, we define a service as the pair of a server IP 
and port in a TCP session. Our clustering method is based on the 
service  statistical  features.  In  order  to  classify  the  unknown 
traffic into different clusters, we  use  k-means  algorithm  as  our 
1532training  method,  as  k-means  algorithm  generally  gives  a  good 
result and has lower computational complexity.  
Our  scheme  is  consisted  of  three  steps.  They  are  a)  getting 
unidentified  traffic,  b)  extracting  service  statistical  features,  c) 
clustering. Figure 1 shows the processing of our scheme.  
2.1  Getting Unknown Traffic 
As shown in Figure 1, we restructure the raw IP packets into 
TCP  flows.  Then,  we  need  to  identify  these  flows  by  a  DPI 
system.  Thus  we  filter  out  unknown  traffic  and  get  unknown 
flow set.  
2.2  Extracting Service Statistic Features 
We  use  the  same  definition  of  bidirectional  flow  and 
unidirectional flow as [10]. 
  Bidirectional flow: all packets share the same 5-tuple 
{source_IP, souce_port, destination_IP, destionation_port, 
transport-level protocol}, include both directions of traffic. 
Also we use a flow timeout of 60 seconds. 
  Unidirectional flow: all packets belonging to a flow, but 
include one direction of traffic, 
Figure 1. The processing of service-based on clustering 
method. 
In a TCP session, we can easily distinguish client and server 
by TCP flags. In the three-way handshake of the TCP protocol, 
server should send a packet with SYN and ACK flags.  
We  extract  separately  flow  statistical  features  of 
the 
unidirectional flow from server to client and the features of the 
other direction. Thus, we get a vector for each bidirectional flow. 
V
feature
csnscn
f
f
2_1
f
2_1
,
sc
,...,
f
cs
2_
,
2_
We  extract  n  kinds  of  features  and  get  a  2n-dimensional 
features  vector.  Then,  we  need  to  generate  service  statistical 
features based on these flow statistical feature vectors. All flows 
belonging to the  same  service  are  clustered  together.  Thus,  we 
get a matrix of m*n for each service. The m is the number of the 
flows belonging to the service. 
f
11
...
f
m
1
f
n
1
...
f
mn
M
features
...
...
Each  field  of  feature  vector  generates  two  service  features. 
They are the mean of (f11, f21, f31… fm1) and the variance of 
(f11, f21, f31… fm1). The service statistical features are the set 
of 4n-dimensional vectors. 
2.3  Clustering 
Due  to  the  effect  of  k-means  algorithm  depends  on  the 
selection of initial value and cluster number k. We select initial 
value  as  description  in  [11],  called  k-means++.  In  order  to  get 
the  best  result  of  clustering,  we’ve  tried  a  large  number  of 
different k. We use silhouette coefficient as an evaluation index 
factor  of  the  results  of  clustering.  The  bigger  silhouette 
coefficient means the better result of clustering. 
3.  THE EXPERIMENT RESULT 
To  verify  the  practicability  of  our  scheme,  we  implement  a 
prototype system and conduct an experiment on a real network 
traffic  dataset.  We  change  nDPI  library,  an  open  source  DPI 
library, and then use it to filter out unknown traffic. And scikit 
tools  are  used  as  clustering  algorithm  library  to  calculate  the 
coefficient  silhouette.  The  dataset  we  used  includes  12300601 
packets, 155758 flows and 6506 services. 
Table 1. Overview of dataset 
The number of packets 
The number of  Flows 
The number of  services 
12300601 
155758 
6506 
We alter the open source nDPI library, update the fingerprint 
library,  and  remove  the  fingerprint  of  RDP  (Remote  Desktop 
Protocol), so that the library cannot identify the traffic of RDP. 
Thus, the set of unknown flows contains the real unknown traffic 
and RDP traffic. The result is shown in the Table 2. 
Table 2. The result of filtering out unknown traffic  
The number of flows 
Known traffic 
Unknown traffic 
124607 
31151 
The flow statistical features extracted are listed in the table 3. 
8  unidirectional  flow  features  were  extracted  to  represent  a 
bidirectional flow.  
1533Table 3. Flow statistic features 
direction 
Server to client 
Client to server 
Server to client 
Client to server 
Server to client 
Client to server 
Server to client 
Client to server 
Feature description 
Max IP packet length 
Max IP packet length 
Mean of IP packet length 
Mean of IP packet length 
Variance of IP packet length 
Variance of IP packet length 
Duration of the flow 
Duration of the flow 
The service statistical features are generated from these flow 
statistical  features.  We  calculate  the  mean  and  the  variance  of 
each field of the flow statistical feature vector. Thus, we obtain a 
16-dimensional  vector  for  each  bidirectional  flow.  Before 
training  clustering  model,  we  need  to  standardize  these  feature 
vectors. 
After  generating  service  features,  we  use  scikit  library  as  a 
clustering  algorithm  implementation  to  achieve  the  clustering 
model, and calculate the silhouette coefficient for each clustering 
number k. Figure 2 shows the result of searching for an optimal 
k.  When k equals to 6, we get the largest silhouette coefficient, 
which means the best clustering effect at this time. After that we 
use  the  original  nDPI  library  to  detect  these  traffic  flows  and 
find  that  most  of  the  RDP  traffic  is  assigned  to  the  same 
category, and accounts for the major part of this category. So we 
find the target elephant application. 
Figure 2. The silhouette coefficient of different k  
4.  CONCLUSIONS AND FUTURE WORK 
This  paper  presents  a  new  scheme  for  unknown  traffic 
classification. To find out the elephant services in the unknown 
traffic, our scheme uses the service statistical features as input to 
train  a  classification  model.  Experiment  results  show  that  the 
service-based  clustering  scheme  is  a  potential  approach  to 
classify unknown traffic. 
Our future work will focus on two separate directions. First, 
we  plan  to  compare  the  result  of  the  flow-based  clustering 
method  with  ours.  Second,  we  plan  to  improve  the  clustering 
scheme to classify UDP traffic. 
5.  ACKNOWLEDGMENTS 
This  paper  is  based  on  work  supported  by  the  National 
Science and Technology Support Program (No. 2012BAH46B02, 
No. 2012BAH47B04); the National High Technology Research 
and  Development  Program  (863  Program)  of  China  (No. 
2011AA010703); the Strategic Priority Research Program of the 
Chinese Academy of Sciences (No. XDA06030200). 
6.  REFERENCES 
[1]  Zhang, J., Xiang, Y., Wang, Y., Zhou, W., Xiang, Y., & 
Guan, Y. 2013. Network traffic classification using 
correlation information. Parallel and Distributed Systems, 
IEEE Transactions on, 24(1), 104-117.  
[2]  Zhang, J., Chen, C., Xiang, Y., Zhou, W., & Vasilakos, A. V. 
2013. An effective network traffic classification method with 
unknown flow detection. Network and Service Management, 
IEEE Transactions on, 10(2), 133-147. Management, IEEE 
Transactions on, 2013, 10(2): 133-147. 
[3]  Zhang, J., Chen, X., Xiang, Y., Zhou, W., & Wu, J. Robust 
Network Traffic Classification.  
[4]  Wang, Y., Xiang, Y., Zhang, J., & Yu, S. 2011. A novel 
semi-supervised approach for network traffic clustering. In 
Network and System Security (NSS), 2011 5th International 
Conference on (pp. 169-175). IEEE.  
[5]  Yingqiu, L., Wei, L., & Yunchun, L. (2007, August). 
Network traffic classification using k-means clustering. In 
Computer and Computational Sciences, 2007. IMSCCS 2007. 
Second International Multi-Symposiums on (pp. 360-365). 
IEEE. 
[6]  Karagiannis, T., Papagiannaki, K., & Faloutsos, M. 2005. 
BLINC: multilevel traffic classification in the dark. In ACM 
SIGCOMM Computer Communication Review (Vol. 35, No. 
4, pp. 229-240). ACM. 
[7]  Moore, A. W., & Papagiannaki, K. 2005. Toward the 
accurate identification of network applications. In Passive 
and Active Network Measurement (pp. 41-54). Springer 
Berlin Heidelberg. 
[8]  Karagiannis, T., Broido, A., & Faloutsos, M. 2004,. 
Transport layer identification of P2P traffic. In Proceedings 
of the 4th ACM SIGCOMM conference on Internet 
measurement (pp. 121-134). ACM. 
[9]  Baldi, M., Baldini, A., Cascarano, N., & Risso, F. (2009, 
March). Service-based traffic classification: Principles and 
validation. In Sarnoff Symposium, 2009. SARNOFF'09. 
IEEE (pp. 1-6). IEEE. 
[10] Dainotti, A., Pescape, A., & Claffy, K. C. 2012. Issues and 
future directions in traffic classification. Network, IEEE, 
26(1), 35-40. 
[11] Arthur, D., & Vassilvitskii, S. (2007, January). K-means++: 
The advantages of careful seeding. In Proceedings of the 
eighteenth annual ACM-SIAM symposium on Discrete 
algorithms (pp. 1027-1035). Society for Industrial and 
Applied Mathematics. 
1534