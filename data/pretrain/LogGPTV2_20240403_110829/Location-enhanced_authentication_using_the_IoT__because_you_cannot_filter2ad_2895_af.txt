### References

1. M. Jakobsson, E. Shi, P. Golle, and R. Chow. "Implicit Authentication for Mobile Devices." In *Proceedings of the 4th USENIX Conference on Hot Topics in Security (HotSec)*, 2009.

2. A. Kalamandeen, A. Scannell, E. de Lara, A. Sheth, and A. LaMarca. "Ensemble: Cooperative Proximity-Based Authentication." In *Proceedings of the 8th International Conference on Mobile Systems, Applications, and Services*, pages 331–344. ACM, 2010.

3. H. Khan, A. Atwater, and U. Hengartner. "A Comparative Evaluation of Implicit Authentication Schemes." In *Proceedings of the International Symposium on Research in Attacks, Intrusions and Defenses (RAID)*, pages 255–275, 2014.

4. H. Khan, A. Atwater, and U. Hengartner. "Itus: An Implicit Authentication Framework for Android." In *Proceedings of the 20th Annual International Conference on Mobile Computing and Networking (MobiCom)*, pages 507–518, 2014.

5. J. Krumm. "A Survey of Computational Location Privacy." *Personal and Ubiquitous Computing*, 13(6):391–399, 2009.

6. J. Krumm and E. Horvitz. "Predestination: Inferring Destinations from Partial Trajectories." In *UbiComp 2006: Ubiquitous Computing*, pages 243–260. Springer, 2006.

7. S. L. Lau and K. David. "Movement Recognition Using the Accelerometer in Smartphones." In *Future Network and Mobile Summit*, pages 1–9, June 2010.

8. L. Liao, D. J. Patterson, D. Fox, and H. Kautz. "Learning and Inferring Transportation Routines." *Artificial Intelligence*, 171(5):311–331, 2007.

9. Y. Lindell and B. Pinkas. "Secure Multiparty Computation for Privacy-Preserving Data Mining." *IACR Cryptology ePrint Archive*, 2008:197, 2008.

10. S. Mare, A. Molina-Markham, C. Cornelius, R. Peterson, and D. Kotz. "ZEBRA: Zero-Effort Bilateral Recurring Authentication." In *Proceedings of IEEE Symposium on Security and Privacy*, May 2012.

11. C. Marforio, N. Karapanos, C. Soriente, K. Kostiainen, and S. Capkun. "Smartphones as Practical and Secure Location Verification Tokens for Payments." In *Proceedings of the Network and Distributed System Security Symposium (NDSS)*, 2014.

12. Microsoft. "Event Hubs." Microsoft Azure. <http://azure.microsoft.com/en-us/services/event-hubs/>

13. D. Naccache, R. Géraud, H. Ferradi, and A. Tria. "When Organized Crime Applies Academic Results: A Forensic Analysis of an In-Card Listening Device." *Journal of Cryptographic Engineering*, pages 1–11, Oct 2015.

14. P. Paillier. "Public-Key Cryptosystems Based on Composite Degree Residuosity Classes." In *Advances in Cryptology - EUROCRYPT '99*, edited by J. Stern, volume 1592 of *Lecture Notes in Computer Science*, pages 223–238. Springer, 1999.

15. V. Pappas, V. P. Kemerlis, A. Zavou, M. Polychronakis, and A. D. Keromytis. "CloudFence: Data Flow Tracking as a Cloud Service." In *Proceedings of the International Symposium on Research in Attacks, Intrusions and Defenses (RAID)*, October 2013.

16. F. Park, C. Gangakhedkar, and P. Traynor. "Leveraging Cellular Infrastructure to Improve Fraud Prevention." In *Proceedings of the Annual Computer Security Applications Conference (ACSAC)*, pages 350–359, December 2009.

17. N. B. Priyantha. "The Cricket Indoor Location System." PhD thesis, MIT, 2005.

18. K. B. Rasmussen, M. Roeschlin, I. Martinovic, and G. Tsudik. "Authentication Using Pulse-Response Biometrics." In *Proceedings of the Network and Distributed System Security Symposium (NDSS)*, February 2014.

19. I. Rhee, M. Shin, S. Hong, K. Lee, S. J. Kim, and S. Chong. "On the Levy-Walk Nature of Human Mobility." *IEEE/ACM Transactions on Networking (TON)*, 19(3):630–643, 2011.

20. O. Riva, C. Qin, K. Strauss, and D. Lymberopoulos. "Progressive Authentication: Deciding When to Authenticate on Mobile Phones." In *Proceedings of the 21st USENIX Security Symposium*, pages 301–316, 2012.

21. R. L. Rivest, L. Adleman, and M. L. Dertouzos. "On Data Banks and Privacy Homomorphisms." *Foundations of Secure Computation*, 32(4):169–178, 1978.

22. V. Roth, K. Richter, and R. Freidinger. "A PIN-Entry Method Resilient Against Shoulder Surfing." In *Proceedings of the ACM Conference on Computer and Communications Security (CCS)*, pages 236–245, 2004.

23. S. Scellato, M. Musolesi, C. Mascolo, V. Latora, and A. T. Campbell. "NextPlace: A Spatio-Temporal Prediction Framework for Pervasive Systems." In *Pervasive Computing*, pages 152–169. Springer, 2011.

24. F. Schuster, M. Costa, C. Fournet, C. M. Peinado, G. Mainar-Ruiz, and M. Russinovich. "VC3: Trustworthy Data Analytics in the Cloud Using SGX." In *Proceedings of the IEEE Symposium on Security and Privacy*, May 2015.

25. S. F. Shahandashti, R. Safavi-Naini, and N. A. Safa. "Reconciling User Privacy and Implicit Authentication for Mobile Devices." *Comput. Secur.*, 53(C):215–233, Sept. 2015.

26. A. Shamir. "How to Share a Secret." *Commun. ACM*, 22(11):612–613, 1979.

27. E. Shi, Y. Niu, M. Jakobsson, and R. Chow. "Implicit Authentication Through Learning User Behavior." In *Proceedings of the International Conference on Information Security (ISC)*, pages 99–113, 2011.

28. starbug. "Fingerprint Biometrics Hacked Again." Chaos Communication Congress (31C3), December 2014. <http://www.ccc.de/en/updates/2014/ursel>

29. M. Terrovitis. "Privacy Preservation in the Dissemination of Location Data." *SIGKDD Explorations*, 13(1):6–18, 2011.

30. The Telegraph – UK. "Three Quarters of Cars Stolen in France 'Electronically Hacked'." <http://www.telegraph.co.uk/news/worldnews/europe/france/11964140/Three-quarters-of-cars-stolen-in-France-electronically-hacked.html>, October 2015.

31. US AirForce. "GPS Accuracy." <http://www.gps.gov/systems/gps/performance/accuracy/>

32. M. van Dijk, C. Gentry, S. Halevi, and V. Vaikuntanathan. "Fully Homomorphic Encryption over the Integers." *IACR Cryptology ePrint Archive*, 2009:616, 2009.

33. R. Verdult, F. D. Garcia, and B. Ege. "Dismantling Megamos Crypto: Wirelessly Lockpicking a Vehicle Immobilizer." In *Supplement to the 22nd USENIX Security Symposium (USENIX Security 13)*, pages 703–718, Washington, D.C., 2015.

34. R. Want, A. Hopper, V. Falcão, and J. Gibbons. "The Active Badge Location System." *ACM Trans. Inf. Syst.*, 10(1):91–102, January 1992.

35. A. C. Yao. "How to Generate and Exchange Secrets (Extended Abstract)." In *27th Annual Symposium on Foundations of Computer Science*, Toronto, Canada, 27-29 October 1986, pages 162–167. IEEE Computer Society, 1986.

36. G. Zhong, I. Goldberg, and U. Hengartner. "Louis, Lester and Pierre: Three Protocols for Location Privacy." In *Privacy Enhancing Technologies, 7th International Symposium, PET 2007*, Ottawa, Canada, June 20-22, 2007, Revised Selected Papers, volume 4776 of *Lecture Notes in Computer Science*, pages 62–76. Springer, 2007.

### Appendix

#### A. Proof of Privacy-Preservation

##### A.1 Background

We briefly recall some fundamental concepts.

**Definition 1 (Negligible Functions)**: A function \(\epsilon : \mathbb{N} \rightarrow \mathbb{R}\) is said to be negligible if for every constant \(c \in \mathbb{N}\), there exists an integer \(n_c \in \mathbb{N}\) such that for all \(n \geq n_c\), \(\left| \epsilon(n) \right| \leq n^{-c}\). This means that \(\epsilon\) decreases faster than the inverse of any polynomial.

**Definition 2 (Computational Indistinguishability)**: Two random variables \(X(n, a)\) and \(Y(n, a)\) (where \(n\) is a security parameter and \(a\) represents the inputs to the protocol) are called computationally indistinguishable, denoted \(X \overset{c}{\equiv} Y\), if for any probabilistic polynomial-time (PPT) adversary \(A\), the function \(\delta(n)\) is negligible:
\[
\delta(n) = \left| \Pr[A(X(n, a)) = 1] - \Pr[A(Y(n, a)) = 1] \right|
\]

**Definition 3 (Semantic Security)**: A public key encryption scheme \(E\) is semantically secure or IND-CPA secure if the advantage of any PPT adversary in winning the game IND-CPA is negligible. The game is won if an attacker can construct procedures \(A_1\) and \(A_2\) such that \(b = b'\) with non-negligible probability. If a cryptosystem is IND-CPA secure, it is also multiple message IND-CPA [10]. Multiple message IND-CPA is formalized by the game MM-IND-CPA, where \(k\) is polynomially bounded by the security parameter. Essentially, this means that any ciphertext or order of ciphertexts is computationally indistinguishable from their plaintexts.

**Game IND-CPA**:
1. \((m_0, m_1) \leftarrow A_1\)
2. \(b \xleftarrow{\$} \{0, 1\}\)
3. \(b' \leftarrow A_2(E_K(m_b))\)
4. Return \(b = b'\)

**Game MM-IND-CPA**:
1. \(((m^0_0, ..., m^0_k), (m^1_0, ..., m^1_k)) \leftarrow A_1\)
2. \(b \xleftarrow{\$} \{0, 1\}\)
3. \(b' \leftarrow A_2(E_K(m^b_0), ..., E_K(m^b_k))\)
4. Return \(b = b'\)

##### A.2 Privacy against Semi-Honest Adversaries

Our privacy definition follows the standard definitions of secure multi-party computation in the semi-honest adversarial model [25, 39], but is simplified for the case with two parties. For two parties \(A\) and \(B\), where \(A\) has inputs \(\vec{x}\) and \(B\) has inputs \(\vec{y}\), the framework formalizes the output of a protocol as \(f(\vec{x}, \vec{y}) = (g(\vec{x}, \vec{y}), h(\vec{x}, \vec{y}))\). The function \(f\) is called the functionality of the protocol, and the functions \(g\) and \(h\) describe the outputs presented to \(A\) and \(B\), respectively.

**Definition 4 (Privacy)**: Privacy within the standard framework (for deterministic functionalities) holds when the overall knowledge of each party after the execution of the protocol, called the party’s view, can be computed from the inputs and outputs of that party. This is called that the view can be simulated. That is, for the two-party case with \(A\) and \(B\) as described above, one must show that:
\[
\{S_A(\vec{x}, g(\vec{x}, \vec{y}))\} \overset{c}{\equiv} \{\text{view}_A(\vec{x}, \vec{y})\}
\]
\[
\{S_B(\vec{y}, h(\vec{x}, \vec{y}))\} \overset{c}{\equiv} \{\text{view}_B(\vec{x}, \vec{y})\}
\]
where \(S_A\) and \(S_B\) are the simulators for \(A\) and \(B\), respectively.

##### A.3 Instantiation for the Proposed Solution

For our purposes, let \(A\) be the hub, \(B\) be the site, and \(f\) be the functionality of the sub-protocol described in Section 6. The function \(g\) returns only the distance between the two points, and \(h\) returns nothing. The site has no inputs, while the hub has the inputs \(p = (b_x, b_y, b_d, \lfloor x_1 \rfloor, \lfloor y_1 \rfloor, \lfloor x_2 \rfloor, \lfloor y_2 \rfloor)\). Both parties also have randomness as inputs for each encryption, but this is omitted here as it is trivial to simulate.

The protocol has two round-trips. During the first round-trip, the site learns the blinded values \(x' = x_1 - x_2 + b_x\) and \(y' = y_1 - y_2 + b_y\), and the hub learns two ciphertexts. During the second round-trip, the site learns the blinded value \(d' = d_2 + b_d\), and the hub learns \(d_2\).

The views of the two parties can be given as:
\[
\text{view}_{\text{hub}} = (p, \lfloor x' \rfloor, \lfloor y' \rfloor, \lfloor d' \rfloor)
\]
\[
\text{view}_{\text{site}} = (x', y', d')
\]

**Theorem 1**: The protocol privately discloses the distance for the hub according to Definition 4.

**Proof**: To prove that Theorem 1 holds, we need to show that there exist two functions \(S_{\text{hub}}\) and \(S_{\text{site}}\) such that:
\[
\{S_{\text{hub}}(p, g(p, \emptyset))\} \overset{c}{\equiv} \{(p, \lfloor x' \rfloor, \lfloor y' \rfloor, \lfloor d' \rfloor)\}
\]
\[
\{S_{\text{site}}(\emptyset, h(p, \emptyset))\} \overset{c}{\equiv} \{(x', y', d')\}
\]

Blinded values are indistinguishable from a random sample in \(\mathcal{M}\) when the blinding used is unknown. Thus, we define:
\[
S_{\text{site}} = (\alpha, \beta, \gamma)
\]
where \(\alpha, \beta,\) and \(\gamma\) are independent and uniformly random variables in \(\mathcal{M}\).

Ciphertexts are easy to simulate for any semantically secure cryptographic system for any principal holding the public key. In fact, for any list of plaintexts, an arbitrary list of ciphertexts of the same length can be used, as per MM-IND-CPA in Definition 3. Since \(g(p, \emptyset) = d\), to create a simulation of \(d'\), one can simply use \(d_2 + b_d\). The simulator for the hub is thus easily defined as:
\[
S_{\text{hub}}(p, g(p, \emptyset)) = (p, E(0), E(0), d_2 + b_d)
\]