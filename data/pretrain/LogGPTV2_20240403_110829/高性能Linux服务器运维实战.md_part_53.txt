透工作铃
添加成员数量导入导出设券所在制门制峰靠信激酒
图6-64企业微信微工作台界面
图6-63
图6-62在企业微信中添加成员
周星星
已关注
普通成片
应用管理
查看企业微信成员信息
←
应用答理
微信玛关注工作台，即可在微信中楼收企业通知和使用企
成员只有关注微工作台后，才能在微信中收到企业微信的数起
记往这个账号，后面在zabix配国告警的的他
密户肤涨
客户联系
运维运队
维舒职人
导出
管理工具
智理工刷
修改名称|添加子部门份置上级
!
293
---
## Page 305
294
微工作台，此外还可以对微工作台进行各种设置。
码关注微工作台，
微工作台的用途。
高性能Linux服务器运维实战：shell编程、
接着，
在图6-65中的“邀请关注”中，有个二维码，
如何关注微工作台呢，
选择左侧导航中的“微工作台”，右边就会出现微工作台的介绍，
成用7
硬件
小程序
选择导航栏中的“应用管理”菜单，开始创建一
首页
微工作台Logo
即可在微信中接收企业通知和使用企业应用。
。通过微工作台，企业微信成员无须下载企业微信客户端，直接用微信扫
开发者工具
设置
详情
®
应用
+
口
机黑人
微信红包封面
文件盘
添加第三方成用
操作方法如图6-65所示。
口开启后
口
在微工作台底部可快捷打开企业微信客户端
关注后，你可在微信中收发企业微信的工作消息和通知
成员使用微工作台时需要使用企业微信客户端
图6-66
图6-65
当前管理员可在工具内模拟微信网页，方便开发与调试web开发工具
应用管理
使用微信扫尚二维码真接关注
+
推荐尺寸640640
创建应用
企业支付
同事吧
事批
创建应用界面
关注微工作台
监控告警、
客户联东
让每个成员扫描这个二维码即可关注
目汇版
获取更多尺寸的二维码
性能优化与实战案例
公费电话图
一个应用，
管理工具
：如图6-66所示。
这里重点了解一下
企业邮箱
---
## Page 306
linux_amd64
毕了。
面 Zabbix配置中会用到。到此为止，关于企业微信的注册和要配置的内容已经介绍完
建成功之后，会显示应用信息，
2.获取微信告警脚本
最后，单击导航中“我的企业”菜单，记录下企业ID这个信息，如图6-69所示，后
要将告警信息发送给微信，就需要一个发送脚本，可从如下地址下载这个脚本：
这里重点记录下此应用的Agentld和 Secret，
这里添加应用logo、应用名称应用介绍和可见范围（选择对应的人员即可）。应用创
这里选择“创建应用”，然后开始创建一个应用，如图6-67所示：
[root@zabbixserver~]#wgethttps://www.ixdba.net/zabbix/weixin
返回
首页
应用负责人
理员
可见范围
Secrel
Ageritld
微信告警
1周量
1周星星
xxIQePF5YJ
1000002
整合微
通讯聚
图6-68微信告警应用详情界面
图6-67创建一个微信告警应用
周星星
可见范围
zabbix整合微信告警
应用介绍（选填）
微信告警
用名称
如图6-68所示。
建议使用750-750.1M以内的pg、png图片
液用管理
RbXF40K5J5_XKW
添加
同在全业信内警理此应用
用
创建应用
微信告警
后面会在Zabbix配置中用到。
记录下这两个值，后面在zabi面踏中会用到
客户联系
运维监控利器Zabbix第6章
资理工具
京
编辑
我的企业
295
---
## Page 307
296
xing
否可用，可执行如下命令测试：
zabbix/alertscripts，接着做一些可执行权限修改：
高性能 Linux服务器运维实战：shell编程、
--corpsecret=FFQgxx3Ef1rcWW1f0
打开Zabbix Web，选择导航栏上面的“管理”菜单，然后选择“报警媒介类型”，
这样设置后，ZabbixWeb 端就可以自动获取到脚本。接下来，先测试一下这个脚本是
最后，修改Zabbix server配置文件zabbix_server.conf，添加如下内容：
然后将此脚本放在Zabbix server的alertscripts目录下，这里是/usr/local/zabbix/share/
3.ZabbixWeb上配置微信告警
如果执行完毕没有报错，那么微信就应该收到了这条命令的告警信息了。
各选项的含义如下所述。
V
V
--agentid=1000002
user：邀请用户的账号，注意是在微信企业号里面成员详情页的账号。
msg：要发送的消息内容。
corpsecret：这里就是自建应用里面的Secret的ID。
corpid:
{"errcode":0,"errmsg":"ok","invaliduser":"")
[root@zabbixserver alertscripts]#./weixin
AlertScriptsPath=/usr/local/zabbix/share/zabbix/alertscripts
[root@zabbixserver
[root@zabbixserver
：企业号里面的企业ID。
用人政上
检头
业国
企业信息
图6-69
alertscripts]# chmod
alertscripts]# mv weixin_linux_amd64 weixin
wa240dab204a619
501-10 
加为企业成受能量增造疫发费批发
1/200电请扩容
1个制门
个成员（速加入1人）
运团队格改
运维团队
企业微信中企业信息界面
--msg="您好，这是微信告警测试"--user=zhouxing-
监控告警、性能优化与实战案例
--corpid=ww962865bb7f121382
755weixin
接
---
## Page 308
击右上方事件源选择“触发器”，然后单击“创建动作”，
的成员详情页面看到的账号，
警媒介”，单击下面的“添加”按钮，添加一个报警类型为“微信告警”，如图6-71所示。
辑，也可以新建用户，这里以管理员用户Admin为例，单击用户进入编辑页面，选择“报
那么这里就填入weixin即可。
微信企业号后台获取的，上面已经做过特别指出了。
着单击右上角“创建媒体类型”，如图6-70所示。
最后一步是配置一个告警动作，单击导航栏上面的“配置”菜单，选择“动作”，单
接着，选择导航栏上面的“管理”菜单，然后选择“用户”，可以在现有的用户下编
另外，报警类型选择“脚本”，脚本名称就是上面下载的那个脚本，已重命名为weixin，
这里需要注意“收件人”的设置，这个收件人就是在微信企业号后台中，通讯录下面
这里有几个需要注意的，就是corpid、corpsecret 和 agentid，这3个参数的值都是从
ZABBIX造到中健产膜
户
报警煤介类型选项
报警媒介类型
一般a代理理
ZABBIX监测中资产记录报表配置管理
已启用
本智数
名称
名称
认证
添加职消
这是卿本的名移，脚本要事先族到Zab1x er上
本报察类型选择脚本
微信告警
加
T(ALERTSENDTO)
pidww
报警媒介
1000007
图6-71设置微信告警收信人和收信时段
即本参数，非蓄重要，其中，前三个参数都婴从企业微信平合获取
用户报营保介失型
一定不要写错了。
图6-70配置微信告警
如图6-72所示。
运维监控利器Zabbix第6章
SunSh
297
---
## Page 309
298
容模板可配置如下：
高性能Linux服务器运维实战：shell编程、监控告警、性能优化与实战案例
消息内容：
默认标题：
在这个界面下，“默认操作步骤持续时间”就选择默认的1h即可，默认标题和消息内
这里自定义一个动作名称，然后单击上面的“操作”标签，如图6-73所示。
动作恢复预作
动作
主机鲜维
ZABBIX监刻中资产记录报表配管理
动作
主机群祖板主机维护动作关联项可
ZABBIX
告警等级：[TRIGGER.SEVERITY）
监控取值：（ITEM.LASTVALUE）
监控项目：{ITEM.NAME}
告警地址：（HOST.IP}
告警主机：HOST.NAME）
服务器：[HOST.NAME）发生：（TRIGGER.NAME}故障！
新的触发条件
监测中
已启用
名称微信告营动作
条件
添加取润
Update operatian
添取润
At least one operation
Atleast one operaton.recovery ope
胜发器名称
Update oper
资产记录报表配管理
消息内容
默认标题
操作
服务(HOSTNAME)发生（TRIGERNAME微障
司
图6-73配置微信告警故障通知内容
contans
图6-72配置微信告警动作
upxlate
peration must exis
0pponare
G
---
## Page 310
上面的“恢复操作”标签，如图6-75所示。
这样，故障时发生的告警信息配置完成，
最后的“操作”按照如图6-74配置即可。
动作