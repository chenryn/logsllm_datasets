# 扩展维纳攻击
* `扩展维纳攻击`来自[`《Extending Wiener's Attack in the Presence of Many Decrypting Exponents》`](https://www.sci-hub.ren/https://link.springer.com/chapter/10.1007/3-540-46701-7_14)，相关题目在CTF中已经出现了，例如2020羊城杯的Simple，但都是一些*模板题*，这里将详细分析原论文中提出的方法以及分析方式，写明扩展维纳攻击原理以及在文末给出了一些**开放问题**欢迎讨论。
## 原理分析
### 维纳（Wiener）的方法
* 维纳`Wiener`提出了一种关于私钥过小时对$N$进行分解的一种方式。并给出了证明当
    $$
    d  0)$$
* 然而即使我们得到了$(k_1d_2)/(k_2d_1)$还是无法分解$N$，原文后面还讨论了郭的提议，尝试对$k_1d_2$进行分解，这里不再讲解。
## 扩展维纳攻击
* 上述部分内容截至目前（2021/10）网络上已经有很多博文进行了讲解了分析，但是对于具体扩展维纳攻击的原理以及格构造或者是更高维的推广都没有给出。这里我将详细的对原论文内容进行翻译以及讲解。
* 为了将分析扩展到$n$个加密指数$e_i$（解密指数$d_i$很小），我们同时使用维纳和郭的方法，我们将关系
    $$
    d_ige_i - k_iN = g + k_is
    $$
    记为维纳等式$W_i$，同样我们可以得到关系
    $$
    k_id_je_j - k_jd_ie_i = k_i - k_j
    $$
    记为郭等式$G_{i,j}$。
    我们假设$d_i$和$k_i$都小于$N^{\alpha_n}$，且$g$很小，$s \approx N^{1/2}$。可以注意到$W_i$和$G_i$的右侧非常小，实际上分别最多为$N^{1/2 + \alpha}$和$N^\alpha$。
    最后，我们考虑复合关系式比如$W_uG_{v,w}$，显然大小为$N^{1/2 + 2\alpha}$。
* 原文中这里是定义了两个关系式以及指出了他们的大小范围，这个范围很重要也容容易分析处理，之后我们所做的其实就是使用这两个式子的不同复合关系去构造一个格，然后通过求其基向量得到$d_1g/k_1$，从而可以算得$\varphi(N)$并可以进一步的对$N$进行分解。
* 其实到这里原理分析已经结束，关于格的构造其实也并不复杂，但是核心是这里的复合关系的选取，以及对于最后$\alpha$大小的分析。
## 两个小解密指数的情况
* 我们选取关系$W_1, G_{1,2},W_1W_2$,这样便有