spectively. Hence, the absolute error of LDA’s standard-deviation
estimator is similarly small in both cases. Delays in Internet routers
are reported to be well-modeled by a Weibull distribution [28], so
relative error is likely to be small in practice.
4.2 Handling unknown loss rates
Up to this point, we have conﬁgured each LDA optimally for
the actual loss rate. Obviously, any real deployment will need to
be conﬁgured for a range of loss rates. Here, we evaluate the efﬁ-
cacy of various conﬁgurations of multi-bank LDAs over a range
of loss rates.
In particular, each bank within the LDA is tuned
(p = αm/(L + 1), α = 0.5 as before) to a different target loss
rate. We consider three alternatives, each with the same total num-
ber (1,024) of counters: two banks of 512 counters tuned towards
loss rates of 0.005 and 0.1, three banks with roughly one-third of
the counters tuned towards loss rates of 0.001, 0.01 and 0.1, and, ﬁ-
nally, four banks of 256 counters each tuned for loss rates of 0.001,
0.01, 0.05 and 0.1, respectively. These particular conﬁgurations are
arbitrary; operators may ﬁnd others better suited for their networks.
We present results along the same three dimensions considered
previously—effective sample size, relative error of delay and stan-
dard deviation estimates—in Figure 7. To facilitate comparison,
we continue with the same uniform loss and Weibull delay distri-
butions and replot the optimal single-bank case conﬁgured for the
actual loss rate as shown in Figures 5 and 6.
Figure 7(a) shows that while practical conﬁgurations collect
fewer samples than optimal, the absolute value is not too far from
our analytical estimates for the single-bank case. The delay and
standard deviation curves in Figures 7(b) and 7(c) follow a similar
trend. The LDAs perform comparably across the ranges of loss,
although the four-bank LDA performs the worst of the three when
the loss rates are high. The number of buckets invested by the four-
bank LDA tuned towards high loss rates (10%) is low, so it strug-
gles to keep up. We note, however, that most real networks operate
at low loss rates—typically substantially less than 5%. In conclu-
sion, we expect a two-bank LDA conﬁguration tuned to relatively
low loss rates will be appropriate for most deployments.
4.3 Comparison with active probes
We compare the accuracy of the delay and standard deviation es-
timates obtained using the two-bank LDA to those that are obtained
using Poisson-distributed active probes (such as those used by the
well-known zing tool [24]) for various probe frequencies. The ac-
262e
z
s
i
l
e
p
m
a
s
e
v
i
t
c
e
f
f
E
e
z
s
i
l
e
p
m
a
s
e
v
i
t
c
e
f
f
E
1000000
10000
100
1
Single bank
Two banks
Three banks
Four banks
 0.05
 0.1
Loss rate
(a) Sample size
 0.15
 0.2
r
o
r
r
e
e
v
i
t
l
a
e
R
 0.09
 0.08
 0.07
 0.06
 0.05
 0.04
 0.03
 0.02
 0.01
 0
Single bank
Two banks
Three banks
Four banks
 0.05
 0.1
 0.15
 0.2
Loss rate
(b) Delay
r
o
r
r
e
e
v
i
t
l
a
e
R
 0.5
 0.45
 0.4
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
 0
Single bank
Two banks
Three banks
Four banks
 0.05
 0.1
 0.15
 0.2
Loss rate
(c) Standard deviation
Figure 7: The performance of various multi-bank LDA conﬁgurations.
106
105
104
103
102
101
100
10-1
 0.0001
LDA
10000 Hz
1000 Hz
144 Hz
7 Hz
1 Hz
10
1
0.1
0.01
r
o
r
r
e
e
v
i
t
l
a
e
r
e
g
a
r
e
v
A
1
0.1
r
o
r
r
e
e
v
i
t
l
a
e
r
e
g
a
r
e
v
A
 0.001
 0.01
 0.1
0.001
 0.0001
 0.001
 0.01
 0.1
0.01
 0.0001
 0.001
 0.01
 0.1
Loss rate
(a) Sample size
Loss rate
(b) Delay
Loss rate
(c) Standard deviation
Figure 8: Sample size, delay and standard deviation estimates obtained using a two-bank LDA in comparison with active probing at
various frequencies. Log-scale axes.
curacy of the active probing approach depends critically upon the
frequency, so we provide a selection of natural comparison points.
One approach is to hold communication overhead constant. First,
we consider an active-probing mechanism that communicates as
frequently as LDA—once an interval, or 1 Hz. In practice, how-
ever, the LDA data structure is too large to ﬁt into one MTU-sized
packet—an Ethernet implementation would actually need to send
seven separate packets per interval assuming 1,024 × 72 bits ≈ 72
Kbits for the data structure and 1,500-byte packets. Thus, to be
fair in terms of number of packets per second, we also use a prob-
ing frequency of 7 Hz. Moreover, probe packets are much smaller
(containing only one timestamp and no counters), so holding band-
width constant—as opposed to packet count—results in a probing
rate of about 144 Hz (assuming probe packets of size 64 bytes).
As we shall see, however, none of these rates approach the accu-
racy of LDA; hence, we also plot a frequency that delivers roughly
equivalent performance: 10,000 Hz.
We generate Poisson-modulated active probes by injecting probe
packets at intervals distributed according to a Poisson process with
the desired average inter-arrival time, and then subjecting the probe
packets to the same delay distribution as the regular trafﬁc. In a nor-
mal queue, adding an active probe affects the queuing dynamics—
for example, it may cause packets behind to experience higher de-
lays and in some cases, even be dropped. We do not, however, re-
create such effects on packets behind active probes, because packet
delays are already based on a distribution and simulating such af-
fects will cause delays to deviate from the distribution. Thus, the
delays of regular packets are not impacted by the presence of active
probes; only their timestamps are shifted.
For these experiments, we continue to use the same Weibull de-
lay distribution as before, but with exponentially distributed (as op-
posed to uniform) loss episodes with each episode consisting of
about 100 packets. We plot two sets of graphs. First, in Figure 8, we
compare the effective sample size, average relative error in the de-
lay and standard deviation estimators using active probes at various
frequencies as well as LDA. In Figure 9, we show the conﬁdence
bounds obtained for LDA. (We refrain from presenting conﬁdence
intervals for active probes, as the bounds that can be derived are
unfairly loose.)
Figure 8(a) clearly shows the impact of increased probe fre-
quency: more samples. As before, each point represents the aver-
age of ten runs. The number of samples collected by active probes
decreases by a small amount as the loss rate increases due to the
lost probes. While the number of effective samples obtained by
LDA decreases more rapidly, the sample size remains far larger
than those obtained by all but the most aggressive active probing
rates under signiﬁcant (> 1%) loss. Consequently, the average rel-
ative error observed by LDA (0.2–4%) is signiﬁcantly lower than
that for active probes with an equivalent number of packets (almost
100%) as shown in Figure 8(b). Even when we hold the measure-
ment bandwidth steady across LDA and active probes (144 Hz),
we observe at least an order of magnitude (11% compared to less
than 1% at loss rates less than 1%) difference in the relative er-
ror between the two. While the improvement in standard deviation
estimates is not as stable as the average delay estimates, LDA is
still considerably more accurate (3%–9% vs. ≈ 15%) over realistic
(< 5%) loss rates. Overall, only the 10,000 Hz probing rate pro-
vides accuracy approaching LDA. Said another way, active probing
requires 50–60 times as much bandwidth to achieve similar results.
Perhaps more importantly, however, LDA is signiﬁcantly more
reliable. Figure 9 shows that the 98%-conﬁdence intervals for the
constituent LDA runs from Figure 8(a) are quite small—generally
26398% Confidence
 0.4
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
)
c
e
s
u
(
y
a
e
D
l
 0
 0.0001
 0.001
 0.01
 0.1
Loss Rate
Figure 9: Delay estimates and 98% conﬁdence bounds from a
two-bank LDA. Actual mean delay is 0.2 μs.
within 25% of the mean (for loss rates less than 0.1%) and less
than a factor of two even at 10% loss. Empirically, however, each
estimate is well inside the analytical envelope. Focusing on loss
rate regimes that the LDA was tuned for, e.g., 0.16%, the maximum
relative error across all runs of LDA was 0.17%. The same cannot
be said for active probing, however, which had runs with relative
errors as large as 87% for 7 Hz and 13% for 144 Hz. Once again,
only 10,000-Hz probes were competitive, with a maximum relative
error of 0.15%.
5. REALIZATION
In this section, we discus two separate aspects of LDA deploy-
ment. First, we explain how LDAs can be implemented within a
router by presenting a sample design. Then, we describe how LDAs
could be deployed across routers (i.e., to measure links) and used
for fault localization.
5.1 Hardware implementation