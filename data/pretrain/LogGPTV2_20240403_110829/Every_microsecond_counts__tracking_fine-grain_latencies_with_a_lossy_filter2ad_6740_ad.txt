### 4.2 Handling Unknown Loss Rates

Up to this point, we have configured each LDA optimally for the actual loss rate. In a real-world deployment, however, the LDA must be configured to handle a range of loss rates. Here, we evaluate the effectiveness of various configurations of multi-bank LDAs over a range of loss rates.

Each bank within the LDA is tuned with \( p = \frac{\alpha m}{L + 1} \) and \( \alpha = 0.5 \) to a different target loss rate. We consider three configurations, each with the same total number (1,024) of counters:
- **Two banks:** 512 counters each, tuned to loss rates of 0.005 and 0.1.
- **Three banks:** Approximately one-third of the counters each, tuned to loss rates of 0.001, 0.01, and 0.1.
- **Four banks:** 256 counters each, tuned to loss rates of 0.001, 0.01, 0.05, and 0.1, respectively.

These configurations are arbitrary, and operators may find other setups better suited for their networks.

We present results along the same three dimensions as before—effective sample size, relative error of delay, and standard deviation estimates—in Figure 7. For comparison, we use the same uniform loss and Weibull delay distributions and replot the optimal single-bank case configured for the actual loss rate, as shown in Figures 5 and 6.

**Figure 7(a)** shows that while practical configurations collect fewer samples than the optimal single-bank case, the absolute value is not too far from our analytical estimates. The delay and standard deviation curves in **Figures 7(b) and 7(c)** follow a similar trend. The LDAs perform comparably across the ranges of loss, although the four-bank LDA performs the worst when the loss rates are high. This is because the four-bank LDA allocates fewer buckets to high loss rates (10%), making it less effective at these rates. However, most real networks operate at low loss rates, typically less than 5%. Therefore, a two-bank LDA configuration tuned to relatively low loss rates is expected to be appropriate for most deployments.

### 4.3 Comparison with Active Probes

We compare the accuracy of the delay and standard deviation estimates obtained using the two-bank LDA to those obtained using Poisson-distributed active probes (such as those used by the well-known zing tool [24]) for various probe frequencies. The accuracy of the active probing approach depends critically on the frequency, so we provide a selection of natural comparison points.

One approach is to hold communication overhead constant. First, we consider an active-probing mechanism that communicates as frequently as LDA—once per interval, or 1 Hz. In practice, however, the LDA data structure is too large to fit into one MTU-sized packet. An Ethernet implementation would need to send seven separate packets per interval, assuming 1,024 × 72 bits ≈ 72 Kbits for the data structure and 1,500-byte packets. Thus, to be fair in terms of the number of packets per second, we also use a probing frequency of 7 Hz. Moreover, probe packets are much smaller (containing only one timestamp and no counters), so holding bandwidth constant—as opposed to packet count—results in a probing rate of about 144 Hz (assuming probe packets of size 64 bytes).

However, none of these rates approach the accuracy of LDA; hence, we also plot a frequency that delivers roughly equivalent performance: 10,000 Hz.

We generate Poisson-modulated active probes by injecting probe packets at intervals distributed according to a Poisson process with the desired average inter-arrival time, and then subjecting the probe packets to the same delay distribution as the regular traffic. In a normal queue, adding an active probe affects the queuing dynamics—for example, it may cause packets behind to experience higher delays and, in some cases, even be dropped. We do not, however, recreate such effects on packets behind active probes, because packet delays are already based on a distribution, and simulating such effects will cause delays to deviate from the distribution. Thus, the delays of regular packets are not impacted by the presence of active probes; only their timestamps are shifted.

For these experiments, we continue to use the same Weibull delay distribution as before, but with exponentially distributed (as opposed to uniform) loss episodes, each consisting of about 100 packets. We plot two sets of graphs. First, in **Figure 8**, we compare the effective sample size, average relative error in the delay, and standard deviation estimators using active probes at various frequencies and LDA. In **Figure 9**, we show the confidence bounds obtained for LDA. (We refrain from presenting confidence intervals for active probes, as the bounds that can be derived are unfairly loose.)

**Figure 8(a)** clearly shows the impact of increased probe frequency: more samples. Each point represents the average of ten runs. The number of samples collected by active probes decreases slightly as the loss rate increases due to lost probes. While the number of effective samples obtained by LDA decreases more rapidly, the sample size remains far larger than those obtained by all but the most aggressive active probing rates under significant (> 1%) loss. Consequently, the average relative error observed by LDA (0.2–4%) is significantly lower than that for active probes with an equivalent number of packets (almost 100%) as shown in **Figure 8(b)**. Even when we hold the measurement bandwidth steady across LDA and active probes (144 Hz), we observe at least an order of magnitude (11% compared to less than 1% at loss rates less than 1%) difference in the relative error between the two. While the improvement in standard deviation estimates is not as stable as the average delay estimates, LDA is still considerably more accurate (3%–9% vs. ≈ 15%) over realistic (< 5%) loss rates. Overall, only the 10,000 Hz probing rate provides accuracy approaching LDA. Said another way, active probing requires 50–60 times as much bandwidth to achieve similar results.

Perhaps more importantly, LDA is significantly more reliable. **Figure 9** shows that the 98%-confidence intervals for the constituent LDA runs from **Figure 8(a)** are quite small—generally within 25% of the mean (for loss rates less than 0.1%) and less than a factor of two even at 10% loss. Empirically, each estimate is well inside the analytical envelope. Focusing on loss rate regimes that the LDA was tuned for, e.g., 0.16%, the maximum relative error across all runs of LDA was 0.17%. The same cannot be said for active probing, which had runs with relative errors as large as 87% for 7 Hz and 13% for 144 Hz. Once again, only 10,000-Hz probes were competitive, with a maximum relative error of 0.15%.

### 5. Realization

In this section, we discuss two separate aspects of LDA deployment. First, we explain how LDAs can be implemented within a router by presenting a sample design. Then, we describe how LDAs could be deployed across routers (i.e., to measure links) and used for fault localization.

#### 5.1 Hardware Implementation