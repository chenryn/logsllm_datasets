once rather than for every adopting AS.
ip as-path access-list allow-all permit
Finally we apply these policies in order, i.e., ﬁrst blocking
invalid routes, then allowing all others.
route-map Path-End-Validation permit 1
match ip as-path as1
match ip as-path allow-all
8. RELATED WORK
The security vulnerabilities of today’s interdomain routing
system motivated many proposals for securing BGP routing.
Due to length restrictions, we only discuss below the main
proposals for how to prevent path manipulation attacks. We
refer the reader to the survey in [13] for an extensive dis-
cussion, which includes a description of important comple-
mentary directions such as detection of attacks (e.g., [25, 31,
46])
Past research analyzed various important aspects of pro-
posals for securing interdomain routing against path manip-
ulations, including security guarantees [10, 23] and adopt-
ability [14, 18]. Several proposals focused on using cryp-
tography to prevent route manipulation attacks, including S-
BGP [27], psBGP [44], and BGPsec [34]. These proposals
require changes to the BGP protocol, and upgrading routers
to support online cryptographic computations, which are sig-
niﬁcant challenges to adoption. In contrast, path-end valida-
tion extends RPKI’s ofﬂine approach, and can be deployed
on top of the current Internet infrastructure, with only router
conﬁguration changes and ofﬂine, off-router cryptography.
Secure-origin BGP (soBGP [45]) was another proposal
for securing BGP using ofﬂine validation of inter-AS con-
nections. It was proposed to the IETF as a general frame-
work allowing for many possible realizations (from essen-
tially RPKI to variants that require signiﬁcant changes to
353
routers and BGP message format), but was abandoned in fa-
vor of S-BGP and BGPsec, and its properties were thus not
sufﬁciently analyzed.
Path-end validation is carefully engineered to be easily de-
ployable and to provide signiﬁcant security beneﬁts even in
very limited partial deployment. We regard path-end vali-
dation as a speciﬁc realization of soBGP designed to real-
ize these objectives. Speciﬁcally, guiding path-end valida-
tion’s design are two insights with important implications
for its adoptability: (1) that validating the 1-AS-hop suf-
ﬁx of the BGP path is already very beneﬁcial in terms of
performance, and (2) that utilizing RPKI’s ofﬂine approach
provides signiﬁcant beneﬁts for adoption (e.g., avoiding the
need to change BGP message format or the decision pro-
cess at routers, no need to trust intermediate ASes to forward
security-related information). Our simulation results estab-
lish that path-end validation indeed provides a very attractive
“return on investment” in partial adoption.
Subsequent to the publication of our results on path-end
validation in [15], a talk at NANOG [38] and several blog
posts [39, 40] presented a related effort by Linkedin and sev-
eral vendors and providers to rethink path validation. We be-
lieve that path-end validation is a good direction to explore in
this context and that our results can be of value in informing
such an effort.
RLP is a recent proposal from the SIDR working group [42]
that suggests mitigating route-leaks by annotating hops in
BGP advertisements with provider-to-customer and peering
links. This allows routers to detect “valley” routes, i.e., BGP
path advertisements that violate the Gao-Rexford export con-
dition [17]. Thus, RLP can protect from all route-leak at-
tacks, whereas our solution, described in Section 6, protects
only the stubs (over 85% of ASes). However, while our
mechanism follows the two design guidelines in Section 2 to
simplify deployment, the RLP proposal violates both: it in-
troduces modiﬁcations to routers, for attaching annotations
to their BGP advertisements, and therefore also changes the
BGP message format, which can limit value under partial
adoption.
Interestingly, [14] examines path-end validation (termed
“ﬁrst-hop authentication” therein) from a very different an-
gle. Speciﬁcally, [14] studies the diffusion of BGP security
solutions from an economic/game-theoretic perspective. Our
foci, in contrast, are on the deployability of path-end valida-
tion (e.g., avoiding the need to upgrade/replace BGP routers)
and on quantifying its security beneﬁts in partial adoption.
Indeed, while [14] mentions online cryptography as a viable
approach to realizing path-end validation, this would elimi-
nate all deployability and security beneﬁts discussed here.
Our preliminary workshop paper [15] studied the security
guarantees of path-end validation, but did not address (1) the
prerequisites to deployment discussed in Section 3, namely,
stability and security monotonicity, (2) path-end validation’s
security beneﬁts when RPKI is only partially deployed, as
discussed in Section 5, and (3) path-manipulation attacks be-
yond next-AS attacks, as discussed in Section 6.
9. CONCLUSION
We presented path-end validation as a means for improv-
ing interdomain routing security while avoiding the hurdles
en route to deployment of BGPsec. Our security evaluation
shows that path-end validation provides a surprisingly high
level of security even with a modest number of adopters, and
an open-source implementation shows the feasibility of its
deployment on top of today’s routing infrastructure.
We hence believe that path-end validation provides a tan-
gible path to signiﬁcant improvements in interdomain rout-
ing security in the seemingly very long interim period before
BGPsec is fully deployed. Our ﬁndings motivate the stan-
dardization of path-end validation and its integration into
RPKI. We propose that governments and industry groups
concentrate regulatory efforts and/or ﬁnancial incentives on
convincing large ISPs in their countries to adopt path-end
validation (on top of RPKI).
Importantly, the success of path-end validation, as an ex-
tension of RPKI, is dependent on the extent to which RPKI is
adopted, especially by the large ISPs. While RPKI is slowly
gaining traction amongst network operators, its deployment
rate remains slow and only rougly 6% of IP preﬁxes adver-
tised in BGP are protected by RPKI. Hence, analyzing the
root causes for RPKI’s sluggish adoption and eliminating
obstacles to adoption is an important direction for future re-
search and standardization efforts.
Acknowledgments
This work was supported by ISF grants 420/12 and 1354/11,
Israel Ministry of Science grants 3-9772 and 3-10884, the
Israeli Center for Research Excellence in Algorithms, and an
ERC Starting Grant. We thank Aditya Akella, Steve Bellovin,
Randy Bush, Sharon Goldberg, Joel Halpern, Hezi Moriel,
and Alvaro Retana for their helpful comments and sugges-
tions.
10. REFERENCES
[1] Hijack Event Today by Indosat. BGPmon.
[2] New Threat: Targeted Internet Trafﬁc Misdirection.
Renesys blog.
[3] Routing Hiccup Brieﬂy takes Google Down
Worldwide. Thousand Eyes blog.
[4] Spotify Route Leak. Thousand Eyes blog.
[5] Turkey Hijacking IP addresses for popular Global
DNS providers. BGPmon.
[6] Pakistan Hijacks YouTube. Renesys Blog, Feb. 2008.
[7] BGP Routing Incidents in 2014, Malicious or Not?
http://www.bgpmon.net/
bgp-routing-incidents-in-2014-malicious-or-not,
2015. BGPMon.
[8] CAIDA AS Relationships Dataset.
http://www.caida.org/data/as-relationships/, Jan. 2016.
[9] Andree Toonk. BGP Hijack Incident by Syrian
Telecomunications Establishment. BGPmon, 2015.
[10] H. Ballani, P. Francis, and X. Zhang. A Study of Preﬁx
Hijacking and Interception in the Internet. In proc. of
ACM SIGCOMM, pages 265–276, 2007.
354
[11] S. Bellovin, R. Bush, and D. Ward. Security
Requirements for BGP Path Validation. RFC 7353
(Informational), Aug. 2014.
[12] R. Bush and R. Austein. The Resource Public Key
Infrastructure (RPKI) to Router Protocol. RFC 6810
(Proposed Standard), Jan. 2013.
[13] K. R. B. Butler, T. R. Farley, P. McDaniel, and
J. Rexford. A Survey of BGP Security Issues and
Solutions. proc. of the IEEE, 98(1):100–122, 2010.
[14] H. Chan, D. Dash, A. Perrig, and H. Z. 0001.
Modeling Adoptability of Secure BGP Protocols. In
L. Rizzo, T. E. Anderson, and N. McKeown, editors,
SIGCOMM, pages 279–290. ACM, 2006.
[15] A. Cohen, Y. Gilad, A. Herzberg, and M. Schapira.
One Hop for RPKI, One Giant Leap for BGP Security.
In J. de Oliveira, J. Smith, K. J. Argyraki, and P. Levis,
editors, HotNets, pages 10:1–10:7. ACM, 2015.
[16] T. Dierks and E. Rescorla. The Transport Layer
Security (TLS) Protocol Version 1.2. RFC 5246
(Proposed Standard), Aug. 2008. Updated by RFCs
5746, 5878, 6176, 7465, 7507, 7568, 7627, 7685.
[17] L. Gao and J. Rexford. Stable Internet Routing without
Global Coordination. IEEE/ACM Transactions on
Networking, 9(6):681–692, 2001.
[18] P. Gill, M. Schapira, and S. Goldberg. Let the Market
Drive Deployment: A Strategy for Transitioning to
BGP Security. In SIGCOMM, pages 14–25, 2011.
[19] P. Gill, M. Schapira, and S. Goldberg. Modeling on
Quicksand: Dealing with the Scarcity of Ground Truth
in Interdomain Routing Data. Computer
Communication Review, 42(1):40–46, 2012.
[20] V. Giotsas, S. Zhou, M. J. Luckie, and kc claffy.
Inferring Multilateral Peering. In K. C. Almeroth,
L. Mathy, K. Papagiannaki, and V. Misra, editors,
CoNEXT, pages 247–258. ACM, 2013.
[21] S. Goldberg. Why is it Taking so Long to Secure
Internet Routing? Commun. ACM, 57(10):56–63,
2014.
[22] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford.
How Secure are Secure Interdomain Routing
Protocols. In SIGCOMM, pages 87–98, 2010.
[23] S. Goldberg, M. Schapira, P. Hummon, and J. Rexford.
How Secure are Secure Interdomain Routing
Protocols? Computer Networks, 70:260–287, 2014.
[24] G. Huston, R. Loomans, and G. Michaelson. A Proﬁle
for Resource Certiﬁcate Repository Structure. RFC
6481 (Proposed Standard), Feb. 2012.
[25] J. Karlin, S. Forrest, and J. Rexford. Pretty Good BGP:
Improving BGP by Cautiously Adopting Routes. In
ICNP, pages 290–299. IEEE Computer Society, 2006.
[26] S. Kent and K. Seo. Security Architecture for the
Internet Protocol. RFC 4301 (Proposed Standard),
Dec. 2005. Updated by RFCs 6040, 7619.
[27] S. T. Kent, C. Lynn, and K. Seo. Secure Border
Gateway Protocol (S-BGP). IEEE Journal on Selected
Areas in Communications, 18(4):582–592, 2000.
355
[28] N. Kephart. Route Leak Causes Amazon and AWS
Outage. Thousand Eyes blog, 2015.
[29] X. Lee, X. Liu, Z. Yan, G. Geng, and Y. Fu. RPKI
Deployment Considerations: Problem Analysis and
Alternative Solutions. Internet Draft, Jan. 2016.
[30] M. Lepinski and S. Kent. An Infrastructure to Support
Secure Internet Routing. RFC 6480 (Informational),
Feb. 2012.
[31] J. Li, T. Ehrenkranz, and P. Elliott. Buddyguard: A
Buddy System for Fast and Reliable Detection of IP
Preﬁx Anomalies. In ICNP, pages 1–10. IEEE, 2012.
[32] R. Lychev, S. Goldberg, and M. Schapira. Brief
Announcement: Network-Destabilizing Attacks. In
D. Kowalski and A. Panconesi, editors, PODC, pages
331–332. ACM, 2012.
[33] R. Lychev, S. Goldberg, and M. Schapira. BGP
Security in Partial Deployment: Is the Juice worth the
Squeeze? In SIGCOMM, pages 171–182. ACM, 2013.
[34] E. M. Lepinski. BGPsec Protocol Speciﬁcation. RFC
1, Oct. 2014.
[35] Mirjam Kuhne. AS Path Lengths Over Time.
https://labs.ripe.net/Members/mirjam/
update-on-as-path-lengths-over-time, 2012.
[36] P. Mohapatra, J. Scudder, D. Ward, R. Bush, and
R. Austein. BGP Preﬁx Origin Validation. RFC 6811
(Proposed Standard), Jan. 2013.
[37] NIST. RPKI Monitor.
http://rpki-monitor.antd.nist.gov/, 2016.
[38] Russ White. Rethinking Path Validation. NANOG 66,
Feb. 2016.
[39] Russ White. Rethinking Path Validation: Pt. 1, New
Requirements. LinkedIn Engineering Blog,
https://engineering.linkedin.com/blog/2016/03/
rethinking-path-valid-pt1, Mar. 2016.
[40] Russ White. Rethinking Path Validation: Pt. 2.
LinkedIn Engineering Blog,
https://engineering.linkedin.com/blog/2016/03/
rethinking-path-validation--pt--2, Mar. 2016.
[41] K. Sriram. BGPSEC Design Choices and Summary of
Supporting Discussions. Internet draft, https://tools.
ietf.org/html/draft-sriram-bgpsec-design-choices-08,
July 2015.
[42] K. Sriram, D. Montgomery, B. Dickson, K. Patel, and
A. Robachevsky. Routing Hiccup Brieﬂy takes Google
Down Worldwide. Internet Draft.
[43] R. Steenbergen. PeeringDB.
http://www.peeringdb.com/, July 2015.
[44] P. C. van Oorschot, T. Wan, and E. Kranakis. On
Interdomain Routing Security and Pretty Secure BGP
(psBGP). ACM Trans. Inf. Syst. Secur, 10(3), 2007.
[45] R. White. Deployment Considerations for Secure
Origin BGP (soBGP), June 2003.
[46] K. Zhang, A. Yen, X. Zhao, D. Massey, S. F. Wu, and
L. Z. 0001. On Detection of Anomalous Routing
Dynamics in BGP. In NETWORKING, volume 3042 of
LNCS, pages 259–270. Springer, 2004.