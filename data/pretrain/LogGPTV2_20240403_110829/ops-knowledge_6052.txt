### 问题描述

我们正在尝试将环境从IE6升级到IE8，但在部署过程中遇到了一些问题。希望有人能提供类似的解决方案或建议。

### 背景信息

1. **下载和配置**：
   - 我已经下载了适用于IE8的Internet Explorer Administration Kit (IEAK)，并创建了一个包含公司设置的自定义.msi文件，用于Windows XP。
   - 配置中选择了无人值守安装，并强制重启。

2. **分发和策略**：
   - 将这个.msi文件放置在域控制器上的软件分发共享目录中。
   - 在组策略对象（GPO）的软件安装部分添加了该.msi文件，并将其分配给域计算机组，设置为“已分配”状态。

### 问题现象

- 只有部分PC成功安装了IE8。
- 其他PC显示“正在安装管理软件 Internet Explorer”，但实际上并未安装任何内容。
- 以下是其中一个失败机器上的`ie8_main.log`日志文件的最后一部分内容：

  ```
  00:08.969: INFO:    |Finalize         &gt;&gt;&gt; &lt;[END]--------------------------------
  00:09.000: INFO:    |Finalize         &gt;&gt;&gt; CPageProgress::_ChangeState: Original Phase: 13
  00:11.860: INFO:    REBOOT: required.
  00:11.875: INFO:    REBOOT: User selected to reboot now.
  00:11.922: INFO:    Installer return value: hr=0x0000f0f4
  00:11.953: ERROR:   Setup exit code: 0x0000f0f4 (Setup has detected the system is missing one or more prerequisites required to install.).
  ```

### 详细检查

- 大多数机器已经更新到了XP SP3。
- 但经过进一步检查，发现有些机器可能只安装了SP2。
- 据我所知，IE8应该仍然可以在SP2上安装，这是正确的吗？

### 解决方案

- **推送SP3更新**：首先通过组策略卸载了IE8（因为IE8在最初的问题中进入了部分安装状态，再次尝试安装时会失败）。然后，向所有客户端推送了SP3更新。
- **重新安装IE8**：一旦SP3安装完成并且IE8被“卸载”，再次通过组策略推送我们的安装包，最终成功安装了IE8。

### 未解决的问题

- 仍不清楚为什么在SP2环境下无法安装IE8。

### 补充说明

- 我们没有安装任何测试版，这是直接从IE6升级到IE8正式版的过程。

### 可能的原因及解决方案

根据其他用户的反馈，问题可能是由于KB923823试图在IE安装之前进行安装，而你在使用IEAK创建自定义安装时启用了“安装最新更新”选项。

**解决方法**：
1. **取消“安装最新更新”选项**：在使用IEAK创建自定义安装时，取消选择“安装最新更新”选项。
2. **先安装安全补丁**：如果您的系统是XP-SP2，并且您启用了“安装最新更新”选项，可以先在整个环境中安装安全补丁KB932823，然后再进行IE8的部署。如果您有补丁管理系统，这一步可以省略。

希望这些信息对您有所帮助！感谢您的关注。