m
u
n
60
2
105
104
103
102
101
100
estimated
observed
4
8
number of classes C
6
10
10−1
2
EM iterations
CPU time (seconds)
4
6
number of classes C
8
10
(a) AIC values;
minimum value.
the marker indicates the
(b) Estimated number of links.
(c) Number of iterations, and the CPU times
(in seconds).
Figure 2: AS graph estimates for October, 2007 with respect to the number of classes C.
30
25
20
15
10
s
k
n
i
l
f
o
’
s
0
0
0
1
5
0
0
5
10
15
25
number of observations
20
30
35
90
80
70
60
50
40
30
20
10
0
Jan04
estimated links (1000’s)
trend estimate
observed links (1000’s)
number of monitors (K)
Jan08
Jan07
Jan05
Jan06
Figure 3: The ﬁtted distribution for C = 7. Bars show the
number of links with respect to how often each is observed, and
the curve shows the estimated distribution.
dataset label
Zhang et al. [13] Updates(1M)
Paper
He et al. [9] All
Mühlbauer et al. [6] N/A
date
2004-10-24
2005-05-12
2005-11-13
ˆE
55,388
59,500
58,903
Table 2: Past estimates of links in the AS-graph.
these are model selection errors). The trend has a growth rate of
18.7 links per day, as compared to the growth in observed links of
16 per day. On a larger scale our results give a yearly growth rate
of around 1000 hidden links.
Several prior studies have attempted to estimate total numbers
of links: 3 such are shown in Table 2. They have used additional
sources of data: e.g., Internet Routing Registries (IRRs), and Look-
ing Glasses, as well as additional route monitors (1000 such in [6]).
IRRs in particular introduce the possibility of “false positives”, and
so they may have overestimated of the number of links. Figure 4
shows each of these estimates by and asterisk ’*’. We can see that
the ﬁrst and third are very close to our own estimate, while the
second is very close to the linear trend. While not absolute proof,
the correlation between the results of different approaches suggests
that all are producing reasonably accurate views. For instance, our
results suggest that He et al. [9] have eliminated the vast majority
of false positive links. Good news!
Figure 4: The trend in the numbers of links. The asterisks show
previous estimates from [6, 9, 13].
5.1 Do classes have meaning?
Until now, we have treated classes as an abstract division of the
links. Our classes were motivated by p2p vs c-p links, but were con-
structed without any reference to any model of inter-AS policies.
The classes incorporate a range of factors including geographic and
topological bias, but the prime motivation stemmed from previous
work showing that peer-2-peer links are harder to see that customer-
provider links. A natural question is “To what extent do our classes
reﬂect actual link policies?”
Dimitropoulos et al [14] provides a recent classiﬁcation of links
into types: p2p, c-p, and s2s. We cross-match their types to the
links in our data. Table 3 shows the breakdown of each type of link
into classes. We can immediately see that class 1 links are largely
made up of p2p links, with a few p2p links appearing in class 2. The
more easily observed classes are dominated by c-p and s2s links in
roughly similar proportions.
These results reﬂect two ﬁndings. Firstly, a signiﬁcant determin-
ing factor of link class is the role for which a link is used, so our
classes do have meaning. The class is not a 100% classiﬁer of the
link policy, though. There are some p2p links in the easily observed
classes, presumably because their place in the network topology
makes them easily viewed, though some may be classiﬁcation er-
rors, either in our algorithm, or in that of Dimitropoulos et al [14].
Secondly, the results clearly show that p2p links are much harder
to observe, supporting intuition generated by previous studies.
Class
1
2
3
4
5
6
7
observed links
estimated links
p2p
74.25
14.50
2.66
1.75
1.43
1.09
4.33
4830
15990
c-p
2.32
4.27
4.01
6.31
8.92
5.04
69.12
48760
57400
s2s
2.33
6.98
5.81
0.78
3.49
5.81
74.81
258
300
Table 3: % of classes by link policies. Note that almost 90%
of p2p links fall into class 1 or 2, whereas well over 90% of c-p
and s2s links fall in classes 3-7.
6. HOW MANY MONITORS?
The most obvious question, following the above analysis, is how
many monitors should we have? Under the above conditions, we
can answer this question. Let us seek to guarantee that we will
observe a given link from class 1 with probability 1 − qj. How
many monitors would we need?
We focus here on class 1, because the observation probability of
the other classes is so much higher for any non-trivial number of
monitors. For small probability q1 of missing class one links, the
probability of missing any of the other links will be so much lower
it will be negligible. The probability of observing a class 1 link,
with K monitors, under the above model is simply 1 − (1 − p1)K,
where p1 is the class 1 link measurement probability from a single
monitor, which we have shown to be around 0.01. So we want the
minimal value of K such that q1 ≤ (1− p1)K. Rearranging we get
K = (cid:9)ln(q1)/ ln(1− p1)(cid:10). For q1 = 0.05, 0.01 and 0.001, we get
K = 299, 459 and K = 684, respectively.
7. CONCLUSION
This paper provides us with a way of estimating the number of
hidden links in an AS graph. The technique performs well against
the best data we have for validation, and allows us to estimate the
trend in the size of the Internet — according to our data it grows
at 18.7 links per day. We use the model to derive the number of
(well placed) monitors that would be needed to see a complete AS-
graph with high-probability. We estimate that 700 route monitors
would see at least 99.9% of links. The results also support previous
studies, and their intuition that peer-2-peer links are much harder
to see than customer-provider links.
There are problems we still wish to explore here, for instance,
the underlying assumption of our approach that the stratiﬁed model
captures the dependencies and heterogeneity of our measurements
is only approximate, and we wish to further improve the model.
Moreover, it is possible that some entire class of links could be
missing from current measurements, and we need to investigate
this further. True validation of the results over the entire Internet is
impractical (for exactly the reasons that make this technique worth-
while), but it is possible that the methodology could be validated on
a smaller segment of the Internet, for which precise ground-truth
data was available.
Finally, this type of technique could be extended to a large num-
ber of Internet measurement problems that have a similar character.
For instance, in anomaly detection, we might see our anomalies
(say a worm, or DoS attack) through some set of monitors. We
could use capture-recapture based techniques to estimate the num-
ber of anomalies we are missing.
Acknowledgement
Olaf Maennel was supported in this work by ARC grants DP0557066
at the University of Adelaide. The data used in this paper was de-
rived from the Oregon RouteViews project. We would also like
to gratefully acknowledge useful conversations with Randy Bush
regarding this work.
8. REFERENCES
[1] M. Faloutsos, P. Faloutsos, and C. Faloutsos, “On power-law
relationships of the Internet topology,” in ACM SIGCOMM,
(Boston, MA, USA), 1999.
[2] J. C. Doyle, D. L. Alderson, L. Li, S. Low, M. Roughan,
S. Shalunov, R. Tanaka, and W. Willinger, “The "robust yet
fragile" nature of the Internet,” Proceedings of the National
Academy of Sciences of the USA, vol. 102, pp. 14497–502,
October 2005.
[3] A. Lakhina, J. Byers, M. Crovella, and P. Xie, “Sampling
biases in IP topology measurements,” in Proc. IEEE
Infocom, April 2003.
[4] S. E. Fienberg, “The multiple recapture census for closed
populatiosn and incomplete 2k contingency tables.,”
Biometrika, vol. 59, no. 3, pp. 591–603, 1972.
[5] International Working Group for Disease Monitoring and
Forecasting, “Capture-recapture and multiple-record systems
estimation i: History and theoretical development,”
American Journal of Epidemiology, vol. 142, no. 10,
pp. 1047–1057, 1995.
[6] W. Mühlbauer, A. Feldmann, M. R. O. Maennel, and
S. Uhlig, “Building an AS-topology model that captures
route diversity,” in ACM SIGCOMM, (Pisa, Italy), 2006.
[7] “University of Oregon Route Views Archive Project.”
www.routeviews.org.
[8] “Ripe NCC: routing information service raw data.”
http://www.ripe.net/projects/ris/.
[9] Y. He, G. Siganos, M. Faloutsos, and S. V. Krishnamurthy,
“A systematic framework for unearthing the missing links:
Measurements and impact,” in USENIX/SIGCOMM NSDI,
(Cambridge, MA, USA), April 2007.
[10] R. Bush, J. Hiebert, O. Maennel, M. Roughan, and S. Uhlig,
“Testing the reachability of (new) address space,” in INM’07:
Proceedings of the 2007 SIGCOMM workshop on Internet
network management, (New York, NY, USA), pp. 236–241,
ACM, 2007.
[11] P. F. Rider, “Truncated binomial and negative binomial
distributions,” Journal of the American Statistical
Association, vol. 50, pp. 877–883, Sept. 1955.
[12] T. Hastie, R. Tibshirani, and J. Friedman, The Elements of
Statistical Learning: Data Mining, Inference and Prediction.
Springer, 2001.
[13] B. Zhang, R. Liu, D. Massey, and L. Zhang, “Collecting the
Internet AS-level topology,” ACM SIGCOMM Computer
Communication Review (CCR) special issue on Internet Vital
Statistics, January 2005.
[14] X. Dimitropoulos, D. Krioukov, M. Fomenkov, B. Huffaker,
Y. Hyun, kc claffy, and G. Riley, “AS relationships:
Inference and validation,” ACM SIGCOMM Computer
Communication Review (CCR), vol. 37, no. 1, pp. 29–40,
2007.