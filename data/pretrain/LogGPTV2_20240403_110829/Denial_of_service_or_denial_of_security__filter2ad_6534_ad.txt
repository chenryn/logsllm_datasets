number of stages (l) has a considerable impact on system
anonymity under selective DoS.
Figure 8(a) shows the eﬀect of varying r on the system
anonymity under selective DoS attack. We ﬁnd that increas-
ing redundancy above r = 3 clearly increases the fraction of
compromised tunnels. Values of r = 2 or r = 3 provide
better anonymity. Though a higher redundancy in r makes
it harder for the attacker to launch a public key modiﬁca-
tion attack, it increases the probability of an attacker being
present in any of the stages. This probability is equal to
1 − tr. An increase in this probability translates into more
opportunities for the attacker to launch the selective DoS at-
tack. It also helps the attacker goal of having a presence in
every stage which compromises the tunnel via passive con-
ventional attacks. We conclude that increasing redundancy
in r does not buy us more anonymity, and r = 2 or r = 3
are good design choices.
Figure 8(b) shows the eﬀect of varying the number of
stages on the system anonymity with a ﬁxed r = 3. We
ﬁnd that increasing the number of stages does not buy us
more anonymity. In fact, increasing l above 3 proves coun-
terproductive. The choice of parameter l has an interesting
trade oﬀ. On one hand, increasing l decreases the probabil-
ity that an attacker has a presence in every stage. However,
it also gives more opportunities for an attacker to launch
a selective DoS attack. Note that for l = 2, the eﬀect of
public key modiﬁcation is dominant for small values of the
attacker ratio, resulting in higher fraction of compromised
tunnels. It becomes optimal (replacing l = 3) for higher at-
tacker values. Under conventional analysis, a higher value
of l can signiﬁcantly improve anonymity at the cost of ex-
tra performance overhead. This is clearly not true with the
selective DoS attack. We have shown that higher values of
redundancy in l does not result in better anonymity. The
values of l = 2 or 3 are optimal design choices.
Another simple change to Salsa design would be to use
a majority, rather than consensus, decision when a conﬂict
arises. In the current Salsa design, a single malicious node
that returns an incorrect result will cause the tunnel to be
aborted. An alternative is to use the result returned by
the majority of the nodes, ignoring the dissenter. This will
greatly reduce the ability to deny service in tunnel building,
at the cost of making a public key modiﬁcation attack eas-
ier. Our analysis of this method with r = 3 and l = 2, 3
shows that it does not perform better than the consensus
algorithm; however, such a modiﬁcation may still be useful
since it takes fewer attempts to build a successful tunnel,
improving usability.
5. COUNTERMEASURES AND RELATED
WORK
In this section we brieﬂy consider potential countermea-
sures to the selective DoS attack. Although applications of
redundancy as seen in Cashmere and Hydra-Onions do not
eﬀectively address the attack, other measures might have a
better chance.
As mentioned in Section 2.1.2, ﬁxing the ﬁrst and last
nodes in a tunnel or mix path, may help defend against selec-
tive DoS attacks. Another straightforward approach would
be to notice that a node is unreliable and exclude it from
future path building. A challenge in this case is to detect
which node is responsible for a packet getting dropped in an
anonymous path. In particular, when a router A is supposed
to send a packet to router B, it is diﬃcult to tell which one
was responsible for dropping a packet. One could design
a reputation system that punishes both A and B, hoping
that malicious routers will be punished more frequently, but
notice that this approach breaks down when t ≤ 0.5.
Dingledine et al. [7] propose the use of witness nodes
to verify that communications were relayed correctly and
design a reputation mechanism to avoid unreliable nodes.
Dingledine and Syverson [11] further extend those ideas to
construct reliable, longer term routes through networks of
mixes. They present a variant of the denial of service attack
that aims to reduce the reputation of honest nodes, so that
they are less likely to be used.
Reliable anonymous communications have been the sub-
ject of a lot of research in the context of electronic elec-
tion, starting with [25]. For this particular application, it is
considered unacceptable to “lose” anonymously transmitted
ballots, and mix systems that oﬀer public veriﬁability of de-
livery have been devised. The state of the art in this ﬁeld
are the techniques by Neﬀ [22] and Furukawa and Sako [14].
However, public veriﬁability in this case requires operat-
ing all of the mixes in a synchronous cascade [10], perform-
ing expensive cryptographic operations on each batch, and
posting all of the intermediate batches on a public bulletin
board. These requirements are appropriate in a voting con-
text, but it would be diﬃcult to design a general anonymous
communication system that satisﬁes them.
 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0 0.05 0.1 0.15 0.2 0.25Fraction of compromised tunnelsFraction of compromised nodesconventional attackspublic key attackselective dos attack(a)
(b)
Figure 8: Eﬀect of varying r (a) and l (b)
Jakobsson et al. [19] present an alternative for public ver-
iﬁability of delivery they call Randomized Partial Checking.
Mixes in a cascade or network, commit to their outputs,
and are then required to reveal half of the correspondences
between inputs and output. Using this technique, cheaters
can be caught and excluded quickly. Gomu lkiewicz et al. [16]
show that the revealed information does not give any advan-
tage to the adversary, even for short path lengths. Yet this
scheme is not without dangers: users may be tempted to
check each mix to determine whether their own messages
have arrived, and naive mechanisms reveal users’ paths. We
note that no widely deployed system uses this mechanism,
and that low-latency networks would not be secure if the
traces necessary to implement it were publicly available (since
they cannot easily be made secure against a global passive
adversary).
6. CONCLUSION
We have shown that in anonymous communications sys-
tems, denial of service attacks reduce anonymity consider-
ably. This shows that availability and anonymity are linked
and reliability must be assured against adversaries and not
just random failures.
Our results have a profound impact on the theory of mixes,
but most importantly on deployed systems such as Mixmin-
ion [6] or Tor [9]: we show that traditional architectures,
oﬀering no protection against DoS attacks, are subject to
complete compromise if the network is contains a major-
ity of dishonest nodes. Traditional mixes aimed to protect
a communication even if a single honest mix was on the
path, and little previous work has questioned this security
assumption [3]. We show that routes with few honest nodes
will be subject to DoS, and only fully honest or fully com-
promised paths will survive. This intuition in an embryonic
form was present in [11] in the context of reputation sys-
tems, but its deep repercussions for general mix systems,
and the fundamental limit on the security it imposes, was
not fully understood until now. For a long time designers
believed that the security of mix systems could be brought
arbitrarily high, as the path length increases. We now prove
this to be wrong.
Mechanisms to prevent our denial of service based attacks,
either by detecting maliciously unreliable nodes, or ensuring
an honest majority, will have to be part of any future mix
systems design and deployment. Sadly, designs that simply
ensure reliability, such as Cashmere and Hydra-Onions, are
curing the symptoms rather than the disease: they only fo-
cus on reliability while making the anonymity of the system
even worse under DoS attacks.
Our work strongly demonstrates that mechanisms to ad-
dress reliability, as well as preventing denial of service, must
be designed and evaluated with criteria from security engi-
neering and not merely network engineering. Our experience
with Salsa suggests that this will be even more important
for future designs that might be based on a peer-to-peer
paradigm, since the extra complexity introduced by peer-
to-peer networks can give attackers more chances for denial
of service.
7. ACKNOWLEDGMENTS
We would like to thank Claudia Diaz and Emilia K¨asper
for their help with, and the proofreading of, some of the
derivations, Paul Syverson for his comments about guard
nodes, the anonymous reviewers for their helpful sugges-
tions, and our shepherd, Roger Dingledine, for his direction
in producing the ﬁnal version of the paper.
8. REFERENCES
[1] K. Bauer, D. McCoy, D. Grunwald, T. Kohno, and
D. Sicker. Low-resource routing attacks against Tor.
In ACM Workshop on Privacy in Electronic Society,
Alexandria, VA, Oct. 2007. ACM Press.
[2] S. M. Bellovin and D. A. Wagner, editors. IEEE
Symposium on Security and Privacy, Berkeley, CA,
May 2003. IEEE Computer Society.
[3] O. Berthold, A. Pﬁtzmann, and R. Standtke. The
disadvantages of free MIX routes and how to overcome
them. In Federrath [13], pages 30–45.
[4] D. Chaum. Untraceable electronic mail, return
addresses, and digital pseudonyms. Communications
of the ACM, 24(2):84–90, February 1981.
[5] D. Daly, D. D. Deavours, J. M. Doyle, P. G. Webster,
and W. H. Sanders. M¨obius: An extensible tool for
performance and dependability modeling. In B. R.
Haverkort, H. C. Bohnenkamp, and C. U. Smith,
editors, Computer Performance Evaluation: Modelling
Techniques and Tools, volume 1786 of Lecture Notes in
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0 0.05 0.1 0.15 0.2 0.25Fraction of compromised tunnelsFraction of compromised nodesr=2r=3r=4r=5r=6r=7 0 0.1 0.2 0.3 0.4 0.5 0.6 0 0.05 0.1 0.15 0.2 0.25Fraction of compromised tunnelsFraction of compromised nodesl=2l=3l=4l=5l=6Computer Science, pages 332–336, Schaumburg, IL,
Mar. 2000. Springer.
[6] G. Danezis, R. Dingledine, and N. Mathewson.
Mixminion: Design of a Type III Anonymous Remailer
Protocol. In Bellovin and Wagner [2], pages 2–15.
[7] R. Dingledine, M. J. Freedman, D. Hopwood, and
D. Molnar. A reputation system to increase MIX-net
reliability. In I. S. Moskowitz, editor, Information
Hiding, volume 2137 of Lecture Notes in Computer
Science, pages 126–141, Pittsburgh, PA, 2001.
Springer Berlin / Heidelberg.
[8] R. Dingledine and N. Mathewson. Anonymity loves
company: Usability and the network eﬀect. In
R. Anderson, editor, Fifth Workshop on the
Economics of Information Security (WEIS),
Cambridge, UK, June 2006.
[9] R. Dingledine, N. Mathewson, and P. F. Syverson.
Tor: The Second-Generation Onion Router. In The
13th USENIX Security Symposium, pages 303–320,
San Diego, CA, August 2004. USENIX Association.
[10] R. Dingledine, V. Shmatikov, and P. F. Syverson.
Synchronous batching: From cascades to free routes.
In D. Martin and A. Serjantov, editors, 4th Privacy
Enhancing Technologies Workshop (PET), volume
3424 of Lecture Notes in Computer Science, pages
186–206, Toronto, Canada, May 2004. Springer Berlin
/ Heidelberg.
[11] R. Dingledine and P. F. Syverson. Reliable MIX
cascade networks through reputation. In M. Blaze,
editor, Financial Cryptography, volume 2357 of
Lecture Notes in Computer Science, pages 253–268,
Southampton, Bermuda, 2003. Springer Berlin /
Heidelberg.
[12] J. Douceur. The Sybil Attack. In P. Druschel, M. F.
Kaashoek, and A. I. T. Rowstron, editors,
International Workshop on Peer-to-Peer Systems
(IPTPS), volume 2429 of Lecture Notes in Computer
Science, pages 251–260, Cambridge, MA, Mar. 2002.
Springer Berlin / Heidelberg.
[13] H. Federrath, editor. Designing Privacy Enhancing
Technologies: Workshop on Design Issues in
Anonymity and Unobservability, volume 2009 of
Lecture Notes in Computer Science. Springer Berlin /
Heidelberg, July 2000.
[14] J. Furukawa and K. Sako. An eﬃcient scheme for
proving a shuﬄe. In J. Kilian, editor, Advances in
Cryptology (CRYPTO), volume 2139 of Lecture Notes
in Computer Science, pages 368–387, Santa Barbara,
CA, USA, 19-23 August 2001. Springer Berlin /
Heidelberg.
[15] P. Golle and A. Juels. Parallel mixing. In ACM
Conference on Computer and Communications
Security, pages 220–226, Washington, DC, Oct. 2005.
ACM Press.
[16] M. Gomu lkiewicz, M. Klonowski, and M. Kuty lowski.
Provable unlinkability against traﬃc analysis already
after O(log(n)) steps! In K. Zhang and Y. Zheng,
editors, Information Security Conference, volume 3225
of Lecture Notes in Computer Science, pages 354–366,
Palo Alto, CA, Sept. 2004. Springer Berlin /
Heidelberg.
[17] C. G¨ulc¨u and G. Tsudik. Mixing E-mail with Babel.
In Network and Distributed Security Symposium
(NDSS), pages 2–16, San Diego, CA, February 1996.
Internet Society.
[18] J. Iwanik, M. Klonowski, and M. Kuty lowski.
DUO-Onions and Hydra-Onions—failure and
adversary resistant onion protocols. In IFIP TC-6
TC-11 Conference on Communications and
Multimedia Security, pages 1–15, Windermere, United
Kingdom, September 2004. Springer Boston.
[19] M. Jakobsson, A. Juels, and R. L. Rivest. Making mix
nets robust for electronic voting by randomized partial
checking. In D. Boneh, editor, USENIX Security
Symposium, pages 339–353, San Francisco, CA, Aug.
2002. USENIX Association.
[20] U. M¨oller, L. Cottrell, P. Palfrader, and L. Sassaman.
Mixmaster Protocol — Version 2. Draft, available at:
http://www.abditum.com/mixmaster-spec.txt, July
2003.
[21] A. Nambiar and M. Wright. Salsa: a structured
approach to large-scale anonymity. In 13th ACM
conference on Computer and Communications
Security, pages 17–26, Alexandria, VA, Oct. 2006.
ACM Press.
[22] C. A. Neﬀ. A veriﬁable secret shuﬄe and its
application to e-voting. In P. Samarati, editor, 8th
ACM conference on Computer and Communications
Security, pages 116–125, Philadelphia, PA, Oct. 2001.
ACM Press.
[23] L. Øverlier and P. Syverson. Valet services: Improving
hidden servers with a personal touch. In Sixth
Workshop on Privacy Enhancing Technologies (PET),
volume 4258 of Lecture Notes in Computer Science,
pages 223–244, Cambridge, UK, June 2006. Springer
Berlin / Heidelberg.
[24] P. Palfrader. Number of Running Tor Routers.
http://www.noreply.org/tor-running-routers/,
2007.
[25] C. Park, K. Itoh, and K. Kurosawa. Eﬃcient
anonymous channel and all/nothing election scheme.
In T. Helleseth, editor, Advances in Cryptology
(EUROCRYPT), volume 765 of Lecture Notes in
Computer Science, pages 248–259, Lofthus, Norway,
23-27 May 1993. Springer Berlin / Heidelberg.
[26] A. Rowstron and P. Druschel. Pastry: Scalable,
distributed object location and routing for large-scale
peer-to-peer systems. In IFIP/ACM International
Conference on Distributed Systems Platforms
(Middleware), pages 329–350, Nov. 2001.
[27] P. Syverson, G. Tsudik, M. Reed, and C. Landwehr.
Towards an analysis of onion routing security. In
Federrath [13], pages 96–114.
[28] M. Wright, M. Adler, B. N. Levine, and C. Shields.
An analysis of the degradation of anonymous
protocols. In Network and Distributed Security
Symposium (NDSS). Internet Society, February 2002.
[29] M. Wright, M. Adler, B. N. Levine, and C. Shields.
Defending anonymous communication against passive
logging attacks. In Bellovin and Wagner [2].
[30] L. Zhuang, F. Zhou, B. Y. Zhao, and A. Rowstron.
Cashmere: Resilient anonymous routing. In USENIX
Symposium on Networked Systems Design and
Implementation (NSDI), Boston, MA, May 2005.