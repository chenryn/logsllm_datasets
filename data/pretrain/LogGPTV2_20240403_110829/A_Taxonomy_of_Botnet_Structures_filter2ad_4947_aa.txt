title:A Taxonomy of Botnet Structures
author:David Dagon and
Guofei Gu and
Christopher P. Lee and
Wenke Lee
23rd Annual Computer Security Applications Conference
23rd Annual Computer Security Applications Conference
A Taxonomy of Botnet Structures
David Dagon, Guofei Gu, Christopher P. Lee, Wenke Lee
Georgia Institute of Technology
{dagon@cc., guofei@cc., chrislee@, wenke@cc.}gatech.edu
Abstract
We propose a taxonomy of botnet structures, based on
their utility to the botmaster. We propose key metrics
to measure their utility for various activities (e.g., spam,
ddos). Using these performance metrics, we consider the
ability of different response techniques to degrade or dis-
rupt botnets.
In particular, our models show that targeted responses
are particularly effective against scale free botnets and ef-
forts to increase the robustness of scale free networks comes
at a cost of diminished transitivity. Botmasters do not ap-
pear to have any structural solutions to this problem in
scale free networks. We also show that random graph bot-
nets (e.g., those using P2P formations) are highly resistant
to both random and targeted responses.
We evaluate the impact of responses on different topolo-
gies using simulation and demonstrate the utility of our pro-
posed metrics by performing novel measurements of a P2P
network. Our analysis shows how botnets may be classiﬁed
according to structure and given rank or priority using our
proposed metrics. This may help direct responses and sug-
gests which general remediation strategies are more likely
to succeed.
1 Introduction
Malware authors routinely harness the resources of their
victims, creating networks of compromised machines called
botnets. The attackers’ ability to coordinate the victim com-
puters presents novel challenges for researchers. To fully
understand the threat posed by such networks, we must
identify classes of botnet topologies, their potential uses,
and the challenges each class presents for detection and re-
mediation.
We believe that it is inadequate to simply enumerate the
botnets we have seen to date in the wild. Botnets have
proven to be very dynamic. For example, researchers have
observed changes in botnet sizes, which have trended from
large networks (100K+ victims) to numerous smaller bot-
nets (1-5K+ victims) [53]. Likewise, we have seen a rapid
transition from centralized botnets (e.g., IRC) to distributed
organizational structures (e.g., P2P) [60]. We expect that
botnets will continue to be a dynamic, evolving threat.
We must therefore consider the structural and organiza-
tional potential of botnets. Similar to how previous work
detailed key aspects of individual classes of worms [57],
this paper provides a taxonomy of botnet organization, and
their utility for various malicious activity. We believe that
future botnet research will share a common goal of reducing
the utility of botnets for botmasters. This raises important
questions: How are botnets utilized? What metrics should
be used to measure the effectiveness of remediation on such
networks?
Recent work by Rajab, et al. [47] noted the need for the
botnet research community to better deﬁne metrics. Their
study examined problems in estimating botnet populations.
This paper argues that other metrics (bandwidth, communi-
cations efﬁciency, robustness) require a similar thoughtful
examination.
This paper therefore proposes a taxonomy of botnet
topologies, based on the utility of the communication struc-
ture and their corresponding metrics. Section 2 details met-
rics for measuring botnet uses, and describes the structural
organization of botnets. In Section 3, we demonstrate how
to perform measurement of selected metrics, and analyze
experimental response techniques designed to address par-
ticular classes of botnets. We note how our work relates to
other areas of inquiry in Section 4. Since this area of re-
search is new and rapidly changing, we conclude with sug-
gestions for future work in Section 5.
Our contribution is the following: we identify a small
number of likely structural forms for botnets, based on a
utilitarian analysis. We propose metrics for measuring a
botnet’s effectiveness, efﬁciency, and robustness. Our anal-
ysis of models and real world observations suggests that
some botnet structures are more resilient than others to dif-
ferent types of remediation efforts. This analysis can guide
future inquiry into how to best address the botnet problem.
1063-9527/07 $25.00 © 2007 IEEE
1063-9527/07 $25.00 © 2007 IEEE
DOI 10.1109/ACSAC.2007.44
DOI 10.1109/ACSAC.2007.44
325
325
2 Botnet Taxonomy
The evolving and evasive nature of botnets requires re-
searchers to anticipate possible topologies. An interesting
early contribution in this area is [13], which listed three
topologies (centralized, peer-to-peer, and random) for bot-
nets, and roughly evaluated performance metrics in terms of
high, medium and low performance.
To more fully understand the threat, we expand on [13]
and propose a taxonomy of possible botnet topologies and
how to measure their utilization in various malicious activ-
ities.
2.1 Purpose and Goals
Taxonomies are most useful when they classify threats in
dimensions that correspond to potential defenses [30, 31].
As [29] noted: “[a]n important and sensible goal for an
attack taxonomy ... should be to help the defender.”
Our botnet taxonomy will help researchers identify what
types of responses are most effective against botnets. Our
design goals are similar to [57]: (a) assist the defender in
identifying possible types of botnets, (b) describe key prop-
erties of botnet classes, so researchers may focus their ef-
forts on beneﬁcial response technologies.
Our taxonomy is driven by possible responses, and not
detection. There is some initial work in botnet detec-
tion [13–15, 17, 18, 20]. Further, the considerable body of
literature on worm detection has identiﬁed detection tech-
niques that can be adapted to botnet detection [9, 21, 26, 44,
58, 61–63]. We therefore leave for future work a classiﬁca-
tion of botnet detection techniques.
2.2 Key Metrics for Botnet Structures
Naively, one could suppose that bots will organize ac-
cording to various regular network topologies such as star,
mesh, or bus networks. These topologies are useful for for-
mal analysis of discrete network properties, but do not let
us describe the utility of large complex botnets.
Instead, we need to pay attention to key discriminators
that let one compare important attributes of botnets. We
identify three important measures of botnets: effectiveness,
efﬁciency, and robustness. We acknowledge there are other
characteristics the botmaster may desire, but these are not
easily designed into the topology of a victim network. For
example, botmasters may desire anonymity from their bot-
net (e.g., to carry out anonymous attacks); however, this
property is not inherently obtained from any single topol-
ogy, and depends more on the application-layer design of a
botnet’s messaging system.
Table 1 lists a few botnet uses, and key relevant metrics.
More than one metric can be relevant to a botnet use, and
botnets certainly have multiple uses. However, the table
lists key metrics critical to the botnet’s speciﬁed function.
2.3 Measuring Botnet Eﬀectiveness
The effectiveness of a botnet is an estimate of overall util-
ity, to accomplish a given purpose. While botmasters may
innovate new uses of botnets, the ability of a botnet to meet
existing uses such as spam, ddos, warez distribution and
phishing is roughly approximated by size and bandwidth.
Both of these terms require elaboration.
We agree with [47], that “botnet size” must be a qualiﬁed
term. Here, we do not use size to mean the total popula-
tion count, such as that usually used in worm epidemiology
studies [37–39, 50]. Instead, we mean the “giant” compo-
nent of the botnet, or largest connected (or online) portion
of the graph [10, 42]. Botnets are of course more powerful
if they have large infected population, but the giant compo-
nent lets us directly measure the damage potentially caused
by certain botnet functions.
In the case of DDoS, the giant component, S, lets us
measure the largest number of bots that can receive instruc-
tions and participate in an attack. This contrasts with the
total population of all infected victims, which may not al-
ways be reachable by the botmaster, e.g., because of diurnal
variations [16].
A related measure is the average amount of bandwidth
that a bot can contribute, denoted as B. Estimating band-
width along a single link is a complex problem, and the
subject of numerous investigations in the networking com-
munity [6, 25]. To estimate the cumulative bandwidth of an
entire botnet presents an even more challenging task. For
example, one could measure the bandwidth between bots,
between a bot and the botmaster, or between any bot and a
third party (e.g., a DDoS victim). By average bandwidth,
B, we mean the cumulative available bandwidth in a bot
that a botmaster could generate from the various bots (e.g.,
for DDoS) under ideal circumstances. Such a measurement
of course varies with the distribution of bandwidth available
to each member of the botnet, the probability that any victim
is “on-line” at any given time, and the amount of bandwidth
already being consumed by the victims themselves (e.g., for
normal use).
We roughly classify three types of bots according to their
transit categories: those using modems (type 1), those using
DSL/cable (type 2), and those using ‘high-speed’ networks
(type 3). While bandwidth within each class is highly vari-
able in itself, we believe this grouping is a reasonable ﬁrst
approximation because they are standard in industry–e.g.,
many commodity databases already map connection classes
according to these categories [34]. The probability of a bot
belonging to type i is denoted as Pi. According to [24],
a reasonable distribution for US-based bots could be esti-
326326
Major Botnet Utilities
Effectiveness
Key Metrics
Giant portion
Ave. Avail. Bandwidth
Efﬁciency
Robustness
Diameter
Local transitivity
Suggested Variables Comment
S
B
l−1
γ
Large numbers of victims increases the likelihood of
high-bandwidth bots. Diurnal behavior favors S over to-
tal population.
Average bandwidth available at any time, because of vari-
ations in total victim bandwidth, use by victims, and di-
urnal changes.
Bots sending messages to each other and coordinating ac-
tivities require efﬁcient communications.
Bots maintaining state (e.g., keycracking or mirroring
ﬁles) require redundancy to guard against random loss.
Highly transitive networks are more robust.
Table 1. Botnet Uses and Relevant Metrics
mated as P1 = 0.3, P2 = 0.6, P3 = 0.1. Similar distribu-
tions could be inferred for a global population.
Let us denote the average maximum network bandwidth
within each type as Mi, the average normal usage of band-
width within each type is Ai. Thus, the average avail-
able bandwidth could be used by a botmaster on a bot is
Mi − Ai. We simplify our measurement by assuming a
botmaster would not use even more bandwidth, since this
would interfere with the victims existing use, and the dis-
ruption might alert them to the infection.
We also need to consider the diurnal sensitivity of these
networks. More complete diurnal models of bot behavior
were presented in [16]. However, to avoid modeling diurnal
changes in numerous time zones, we can use a simpliﬁed
metric based on the estimated number of hours a victim is
online per day (and therefore capable of participating in the
botnet). We assign different weights (denoting the distribu-
tion of time hosts are online each day) to each class of bots.
For example, if we assume average online hours per day for
a bot using modem is 2, for a bot with DSL/cable is 6, and
for a bot with high-speed is 24, then we have the probability
vector (cid:3)W = [2/32, 6/32, 24/32] = [0.0625, 0.1875, 0.75].
We selected these numbers based on [43]; however, our
analysis considers other ranges of values.
Using the simpliﬁed bandwidth estimation for each bot,
and a simpliﬁed diurnal model, we can express the average
available bandwidth of a bot as:
3(cid:2)
B =
(Mi − Ai)PiWi
(1)
i=1
In Section 3, we suggest the utility of this metric by com-
paring different botnets. The weights and distribution of
hosts in each class are of course variable. To understand
their sensitivity, we evaluated the weighted bandwidth for
different ranges of estimates.
Figure 1 shows the weighted bandwidth, with different
variations in diurnal sensitivity. We can see in Figure 1(a),
that the ﬁnal average weighted bandwidth is around 20Kbps
327327
for a single bot, for the values ﬁxed in that plot. With ap-
proximately 50,000 such bots in a botnet, the botmaster can
utilize about 1Gbps bandwidth on average at any time.1 The
parameters for the plots in Figure 1 are drawn from data
measurements described in Section 3.
The plots reveal the sensitivity of this metric to the di-
urnal variation in users. Compare for example Figure 1(a),
where low bandwidth users are presumed online for only
two hours, to Figure 1(c), where six hours is ﬁxed instead.
For diurnal weighing above 6 hours/day, variation in the on-
line hours for the medium and high-bandwidth users does
not result in much variation in the overall bandwidth, as
shown in Figure 1(a). However, in Figure 1(c), the on-
line variation of the other classes has a signiﬁcant impact
on bandwidth particularly when higher-speed users are “al-
ways on” and have a diurnal weight of 1. This suggests that
botnets with many low-speed connections experience less
variation when the lower-speed connections minimize their
time online.
In Section 3, we further compare estimated
bandwidth of two botnets.
2.4 Measuring Botnet Eﬃciency
Botmasters and security researchers may also be con-
cerned about the efﬁciency of a botnet. Whether used to
forward command-and-control messages, update bot exe-
cutable code, or gather host-based information (e.g., key-
logging and data exﬁltration), a botnet may be evaluated by
its communication efﬁciency.
We propose network diameter as one means of express-
ing this efﬁciency. By network diameter, we mean the aver-
age geodesic length of a network, l. This measures the aver-
age length of the shortest edge connecting any two nodes in
the network. If l is large, the dynamics of the network (com-
munications, information, epidemics) is slow. The reader
1We repeat again the caution noted above: our available bandwidth
metric does not measure the bandwidth between any two points. Rather
it measures the amount of trafﬁc the botmaster may reasonably generate
using his network.
)
s
p
b
k
(
24
W
B
d
e
h
g
e
W
t
i
22
20
18
24
22