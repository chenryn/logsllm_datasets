detection of attacks. By contrast, for a site with
worldwide users, our results indicate that deploying
DNSSEC in the current environment amounts to a
self-inﬂicted partial attack on one’s own site on the
order of 0.2214% (the diﬀerence between the goodsec
and nosec failure rates). For a site without signiﬁ-
cant Asian usage, the tradeoﬀ looks more attractive,
and for a site with largely Asian usage it looks less
attractive.
The major source of increased failure rates from
DNSSEC deployment appears to be that increased
packet sizes force clients into DNS over TCP rather
than DNS over UDP. The failure rate for DNS over
TCP is approximately 10 times larger than DNS
over UDP. This phenomenon is strongly localized to
Asia/Paciﬁc browsers.
Some potential future developments could change
this calculation. First, a signiﬁcant number of ISPs
could deploy validating resolvers. As shown by the
9Here we interpret the badsec failure rate as an upper
bound on the fraction of end users protected by DNSSEC
validation because some fraction of the failures may be due
to the fact that DNSSEC was enabled rather than validation
failure
584  22nd USENIX Security Symposium 
USENIX Association
12
Comcast data in Section 4.1.5, unilateral deploy-
ment of DNSSEC by ISPs can have a very large im-
pact on the behavior of their customers. If a few of
the large ISPs were to deploy validating resolvers,
our measured badsec failure rate would no doubt
have been much higher and their customers would
have obtained some level of defense against attackers
outside the ISP’s network. (Validation at the ISP re-
solver level does not provide defense against attack-
ers located between the resolver and the customer.)
Second, there could be widespread deployment
of a technology such as DANE that depends on
DNSSEC. As mentioned above, DNSSEC for A
records does not provide security against on-path
attackers, who can intercept the traﬃc between
the client and the server. Defending against such
attackers
cryptographic
protocol such as SSL/TLS. By contrast, if DANE
is used to attest to end-user certiﬁcates,
then
DNSSEC combined with DANE-based certiﬁcates
can provide security against on-path attackers and
thus a signiﬁcantly greater beneﬁt.
Even with
DANE, however, the collective action problem of
simultaneous client and server deployment persists.
In fact, it is worse since DANE’s security requires
that the client do DNSSEC validation — ISP-level
validation is not suﬃcient.
requires
some
sort of
Our results also serve as a caution for future re-
searchers: Advertisement network based studies —
especially those which attempt to measure success
or failure — are very sensitive to variation in client
and network behavior.
In particular, there is sig-
niﬁcant variation both between browsers and oper-
ating systems and by request order within the same
browser/operating system pair. These variations are
of the same order of magnitude as the signal we are
trying to measure and thus present a signiﬁcant chal-
lenge. Additionally, they may indicate actual prob-
lems with the browsers — or at least opportunities
for improvement. We are currently working with
browser vendors to attempt to determine the reason
for these anomalies.
6 Related Work
Several research groups have performed measure-
ments related to DNSSEC.
The SecSpider project [35, 36, 43] has surveyed
DNSSEC-secured zones since the DNSSEC rollout,
quantifying the rollout using metrics of availability,
veriﬁability, and validity. Deccio et al. [14, 15] sur-
veyed representative DNSSEC domains for miscon-
ﬁguration. Both of these projects focus on properties
of the authoritative DNS server zone data, rather
than the behavior of resolvers or caches.
Several research groups have attempted to charac-
terize the overhead (to clients, servers, and the net-
work) from deploying DNSSEC. Ager, Dreger, and
Feldmann [2] used a trace of DNS traﬃc as the basis
for a testbed experiment. They noted the possibility
of overhead arising from packet fragmentation. Wi-
jngaards and Overeinder [42] described the design of
a DNSSEC resolver and validator and compared its
performance to an ordinary DNS resolver. Migault,
Girard, and Laurent [31] measured the overhead of
DNSSEC resolution in a lab setting, including the
NSEC3 option.
Gudmundsson and Crocker [18] measured the de-
ployment of DNSSEC-capable resolvers using traces
of DNS queries made to the .org servers. Glynn [17]
surveyed DNSSEC deployment in Ireland, highlight-
ing the possibilty that large responses would suﬀer
fragmentation, and noting the geographic variation
in client path MTU.
Dietrich [16] reports on a study of one component
in DNSSEC resolution: users’ home DSL routers.
With the cooperating of network operators, the
study’s authors tested the behavior of 36 routers in
a testbed environment. The DNS proxies in more
than half of these routers were incompatible with
DNSSEC; several of the tested routers could not be
used with DNSSEC even if their internal DNS proxy
were bypassed.
Herzberg and Shulman [19] describe several chal-
lenges to wide-scale DNSSEC deployment. They ob-
serve that large-response fragmentation not only re-
duces performance but can be the basis of down-
grade and forgery attacks on permissive resolvers.
Pappas and Keromytis [37] performed a dis-
tributed measurement of resolution failures in the
aftermath of the May 5, 2010 signing of the DNS
root. They made resolution attempts from hundreds
of geographically dispersed nodes (e.g., Tor exit
nodes), which allowed them to observe the behavior
of many DNS resolvers. Whereas their conclusions
focused on the eﬀects of rolling out DNSSEC on the
DNS root-level servers, our measurements target the
DNS in its steady state behavior nearly two years
later.
Krishnan and Monrose [28] performed a large-
scale measurement of browser DNS prefetching and
characterized its security and privacy implications.
Using a trace-based cache simulator, they showed
that the additional overheads induced by prefetching
would increase the overhead of deploying DNSSEC.
The Netalyzr platform [27] allows interested users
to measure and report on properties of their Inter-
net connection. Netalyzr has uncovered widespread
DNS manipulation by ISPs [40, 41].
USENIX Association  
22nd USENIX Security Symposium  585
13
Zhang et al. [44] included client-side DNS mea-
surement code in a software package used by mil-
lions. They identiﬁed several ISPs that manipulate
DNS results, allowing them to proxy and modify
Web searches.
Ager et al. [3] asked friends to run DNS measure-
ment code on their systems. Their data anlysis fo-
cused on DNS performance.
Honda et al. [21] asked IETF colleagues to run
a measurement tool, TCPExposure; this tool gener-
ated TCP segments with various properties, allowing
Honda et al. to observe how middleboxes between
clients and their servers handle diﬀerent TCP exten-
sions. Of all the related work, Honda et al.’s is the
closest in spirit to ours. They sought to measure the
compatibility of hypothetical future protocols with
deployed middleboxes; we measure the interaction
between DNSSEC and today’s network infrastruc-
ture.
Rather than deploy custom software to users, we
wrote JavaScript code that triggers DNS resolution,
and served this code in an ad we placed with a dis-
play ad network. This strategy for enlisting users
was pioneered by Barth, Jackson, and their coau-
thors [6, 25], who used it to measure the Web plat-
form. This strategy was also recently used by Hus-
ton and Michaelson [23, 24] to measure the deploy-
ment of DNSSEC-capable resolvers and to describe
their geographic distribution. Unlike our study, Hus-
ton did not also measure the prevalence of DNSSEC-
intolerant resolvers.
7 Summary
While DNS name resolution is a key part of the In-
ternet infrastructure, it has long been known that it
is seriously insecure. DNSSEC is designed to repair
that insecurity. We report on a large ad network
based study designed to measure both the current
state of deployment and the extent to which deploy-
ing DNSSEC-signed domains creates collateral dam-
age in the form of failed resolutions of valid domains.
Our measurements conﬁrm previous reports that
DNSSEC deployment is proceeding quite slowly.
Less than 3% of clients failed to retrieve resources
hosted on DNSSEC-signed domains with broken sig-
natures. This indicates that either these clients — or
their resolvers — are not doing DNSSEC validation
or they are not hard-failing on broken validations,
which is eﬀectively the same as not validating at all.
Moreover, about 1.006% of clients fail to retrieve
validly DNSSEC-signed resources (as compared to
0.7846% of unsigned resources. In other words, for
every ten clients a site protects by using DNSSEC, it
self-DoSes about one client. This eﬀect is principally
due to TCP fallback to accomodate larger DNSSEC
packet sizes and is strongly localized to Asian users.
Finally, we report on a number of new measure-
ment artifacts that can aﬀect the results of advertis-
ing network based studies, including some browser-
speciﬁc anomalies which may reveal opportunities
for improvement in those browsers. In future work,
we hope to explore further the speciﬁc causes of these
anomalies.
Acknowledgements
The authors thank the anonymous reviewers and our
shepherd, Tara Whalen. We also thank Duane Wes-
sels, Casey Deccio, Cynthia Taylor, and Stephen
Checkoway for their feedback on the paper, Philip
Stark for suggestions about the analysis, and Collin
Jackson for his help in acquiring an advertising net-
work advertiser account. This material
is based
upon work supported by the MURI program under
AFOSR Grant No. FA9550-08-1-0352.
References
[1] Distributed
director
cache
auto
refresh.
https:
//www.cisco.com/en/US/docs/ios/12_2t/12_2t8/feature/
guide/ftrefrsh.pdf.
[2] B. Ager, H. Dreger, and A. Feldmann. Predicting the
DNSSEC overhead using DNS traces.
In R. Calderbank
and H. Kobayashi, editors, Proceedings of CISS 2006, pages
1484–89. IEEE Information Theory Society, Mar. 2006.
[3] B. Ager, W. M¨uhlbauer, G. Smaragdakis, and S. Uhlig.
Comparing DNS resolvers in the wild.
In M. Allman, ed-
itor, Proceedings of IMC 2010, pages 15–21. ACM Press,
Nov. 2010.
[4] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
DNS Security Introduction and Requirements. RFC 4033
(Proposed Standard), Mar. 2005. Updated by RFC 6014.
[5] R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose.
Protocol Modiﬁcations for the DNS Security Extensions.
RFC 4035 (Proposed Standard), Mar. 2005. Updated by
RFCs 4470, 6014.
[6] A. Barth, C. Jackson, and J. C. Mitchell. Robust defenses
for cross-site request forgery.
In P. Syverson and S. Jha,
editors, Proceedings of CCS 2008, pages 75–88. ACM Press,
Oct. 2008.
[7] R. Bellis. DNS Proxy Implementation Guidelines. RFC 5625
(Best Current Practice), Aug. 2009.
[8] R. Bellis. DNS Transport over TCP - Implementation Re-
quirements. RFC 5966 (Proposed Standard), Aug. 2010.
[9] R. Bellis and L. Phifer.
pact on broadband routers and ﬁrewalls.
https://www.dnssec-deployment.org/wp-content/uploads/
2010/03/DNSSEC-CPE-Report.pdf, Sept. 2008.
Test report: DNSSEC im-
Online:
[10] R. Braden. Requirements for Internet Hosts - Application
and Support. RFC 1123 (Standard), Oct. 1989. Updated by
RFCs 1349, 2181, 5321, 5966.
[11] Caida routeviews preﬁx to as mappings dataset (pfx2as).
http://www.caida.org/data/routing/routeviews-prefix2as.
xml.
14
586  22nd USENIX Security Symposium 
USENIX Association
[12] E. Cohen and H. Kaplan. Proactive caching of DNS records:
Addressing a performance bottleneck. Computer Networks,
41(6):707–26, 2003.
[29] P. Leach, M. Mealling, and R. Salz. A Universally Unique
IDentiﬁer (UUID) URN Namespace. RFC 4122 (Proposed
Standard), July 2005.
[13] What are comcast’s dynamic ip ranges? http://postmaster.
comcast.net/dynamic-IP-ranges.html.
[14] C. Deccio, J. Sedayao, K. Kant, and P. Mohapatra. A
case for comprehensive DNSSEC monitoring and analysis
tools. In R. Clayton, editor, Proceedings of SATIN 2011,
Apr. 2011. Online: http://conferences.npl.co.uk/satin/
agenda2011.html.
[15] C. Deccio, J. Sedayao, K. Kant, and P. Mohapatra. Quan-
tifying and improving DNSSEC availability. In G. Rouskas
and X. Zhou, editors, Proceedings of ICCCN 2011. IEEE
Communications Society, July 2011.
[16] T. Dietrich. DNSSEC support by home routers in Ger-
many. Presented at RIPE 60, May 2010. Online slides:
http://ripe60.ripe.net/presentations/Dietrich-DNSSEC_
Support_by_Home_Routers_in_Germany.pdf.
[17] W. J. Glynn. Measuring DNS vulnerabilities and DNSSEC
challenges from an irish perspective. In R. Clayton, editor,
Proceedings of SATIN 2011, Apr. 2011. Online: http://
conferences.npl.co.uk/satin/agenda2011.html.
[18] ´O. Gudmundsson and S. D. Crocker. Observing DNSSEC
validation in the wild. In R. Clayton, editor, Proceedings of
SATIN 2011, Apr. 2011. Online: http://conferences.npl.
co.uk/satin/agenda2011.html.
[19] A. Herzberg and H. Shulman. Towards adoption of dnssec:
Availability and security challenges. Cryptology ePrint
Archive, Report 2013/254, 2013. http://eprint.iacr.org/.
[20] P. Hoﬀman and J. Schlyter. The DNS-Based Authentica-
tion of Named Entities (DANE) Transport Layer Security
(TLS) Protocol: TLSA. RFC 6698 (Proposed Standard),
Aug. 2012.
[21] M. Honda, Y. Nishida, C. Raiciu, A. Greenhalgh, M. Han-
dley, and H. Tokuda. Is it still possible to extend TCP? In
P. Thiran and W. Willinger, editors, Proceedings of IMC
2011, pages 181–94. ACM Press, Nov. 2011.
[30] J.
Livingood.
Comcast
ployment.
comcast-completes-dnssec-deployment.html.
de-
http://blog.comcast.com/2012/01/
completes
dnssec
[31] D. Migault, C. Girard, and M. Laurent. A performance view
on dnssec migration. In H. Lutﬁyya and Y. Diao, editors,
Proceedings of CNSM 2010, pages 469–74. IEEE Commu-
nications Society, Oct. 2010.
[32] P. Mockapetris. Domain names - concepts and facilities.
RFC 1034 (Standard), Nov. 1987. Updated by RFCs 1101,
1183, 1348, 1876, 1982, 2065, 2181, 2308, 2535, 4033, 4034,
4035, 4343, 4035, 4592, 5936.
[33] P. Mockapetris. Domain names - implementation and spec-
iﬁcation. RFC 1035 (Standard), Nov. 1987. Updated by
RFCs 1101, 1183, 1348, 1876, 1982, 1995, 1996, 2065, 2136,
2181, 2137, 2308, 2535, 2845, 3425, 3658, 4033, 4034, 4035,
4343, 5936, 5966, 6604.
[34] nginx httplogmodule. http://wiki.nginx.org/HttpLogModule.
[35] E. Osterweil, D. Massey, and L. Zhang. Deploying and mon-
itoring DNS security (DNSSEC). In C. Payne and M. Franz,
editors, Proceedings of ACSAC 2009, pages 429–38. ACM
Press, Dec. 2009.
[36] E. Osterweil, M. Ryan, D. Massey, and L. Zhang. Quanti-
fying the operational status of the DNSSEC deployment. In
K. Papagiannaki and Z.-L. Zhang, editors, Proceedings of
IMC 2008, pages 231–42. ACM Press, Oct. 2008.
[37] V. Pappas and A. D. Keromytis. Measuring the deploy-
ment hiccups of DNSSEC. In J. L. Mauri, T. Strufe, and
G. Martinez, editors, Proceedings of ACC 2011, volume 192
of CCIS, pages 44–53. Springer-Verlag, July 2011.
[38] S. Son and V. Shmatikov. The hitchhiker’s guide to DNS
cache poisoning. In S. Jajodia and J. Zhou, editors, Proceed-
ings of SecureComm 2010, volume 50 of LNICST, pages
466–83. Springer-Verlag, Sept. 2010.
[39] P. Vixie. Extension Mechanisms for DNS (EDNS0). RFC
2671 (Proposed Standard), Aug. 1999.
[22] L.-S. Huang, E. Y. Chen, A. Barth, E. Rescorla, and C. Jack-
son. Talking to yourself for fun and proﬁt. In H. J. Wang,
editor, Proceedings of W2SP 2011. IEEE Computer Society,
May 2011.
[40] N. Weaver, C. Kreibich, B. Nechaev, and V. Paxson. Impli-
cations of Netalyzr’s DNS measurements.
In R. Clayton,
editor, Proceedings of SATIN 2011, Apr. 2011. Online:
http://conferences.npl.co.uk/satin/agenda2011.html.
[23] G. Huston. Counting DNSSEC. Online: https://labs.ripe.
net/Members/gih/counting-dnssec, Sept. 2012.
[24] G. Huston and G. Michaelson. Measuring DNSSEC per-
formance. Online: http://www.potaroo.net/ispcol/2013-05/
dnssec-performance.html, May 2013.
[25] C. Jackson, A. Barth, A. Bortz, W. Shao, and D. Boneh.
Protecting browsers from DNS rebinding attacks. ACM
Trans. Web, 3(1), Jan. 2009.
[26]
jquery: The write less, do more, javascript library. http:
//jquery.com.
[27] C. Kreibich, B. Nechaev, N. Weaver, and V. Paxson. Net-
alyzr: Illuminating the edge network. In M. Allman, editor,
Proceedings of IMC 2010, pages 246–59. ACM Press, Nov.
2010.
[28] S. Krishnan and F. Monrose. An empirical study of the
performance, security and privacy implications of domain
name prefetching. In S. Bagchi, editor, Proceedings of DSN
2011, pages 61–72. IEEE Computer Society and IFIP, June
2011.
[41] N. Weaver, C. Kreibich, and V. Paxson. Redirecting DNS
In N. Feamster and W. Lee, editors,
for ads and proﬁt.
Proceedings of FOCI 2011. USENIX, Aug. 2011.
[42] W. C. Wijngaards and B. J. Overeinder. Securing DNS:
Extending DNS servers with a DNSSEC validator. Security
& Privacy, 7(5):36–43, Sept.–Oct. 2009.
[43] H. Yang, E. Osterweil, D. Massey, S. Lu, and L. Zhang.
Deploying cryptography in Internet-scale systems: A case
study on DNSSEC. IEEE Trans. Dependable and Secure
Computing, 8(5):656–69, Sept.–Oct. 2011.
[44] C. Zhang, C. Huang, K. W. Ross, D. A. Maltz, and J. Li.
Inﬂight modiﬁcations of content: Who are the culprits? In
C. Kruegel, editor, Proceedings of LEET 2011. USENIX,
Mar. 2011.
[45] Z. Zhang, L. Zhang, D.-E. Xie, H. Xu, and H. Hu. A novel
dns accelerator design and implementation. In C. S. Hong,
T. Tonouchi, Y. Ma, and C.-S. Chao, editors, Proceedings
of APNOMS 2009, volume 5787 of LNCS, pages 458–61.
Springer-Verlag, Sept. 2009.
USENIX Association  
22nd USENIX Security Symposium  587
15