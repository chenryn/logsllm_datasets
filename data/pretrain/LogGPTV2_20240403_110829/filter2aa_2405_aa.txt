1001 ways to PWN prod
A tale of 60 RCE in 60 minutes
1. Whatâ€™s in this talk?
2. RCE, RCE, RCE!!!
3. Takeaways
@TheLaluka
thinkloveshare.com
1
1. Whatâ€™s in this talk?
2
In this talk, RCEs are : 
- Authent-less
- Fully chained
- Disclosed & Fixed
- Legally POCed ğŸ™ƒ
Le Breakage
Lalu
3
*angry customer data noise*
4
5
2. RCE, RCE, RCE!!!
6
AXIS 1.4 & Custom code
â—
Why & How
â—‹
Vulnerable Axis 1.4 server
â—‹
Usually XXE to SSRF to RCE ğŸ˜
â—‹
BUT Exposed /axis/services/AdminService
â—‹
Misconï¬gured reverse proxy
â—‹
Deploy a custom service : webshell.jsp
â—
Sources
â—‹
https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce 
â—‹
https://copyfuture.com/blogs-details/20211206221333010S 
7
Arbitrary URI copy - rwservlet
â—
Why & How
â—‹
Java report rwservlet = SSRF + ï¬le write
â—‹
Used XXE to read logs, found WEBROOT
â—‹
SSRF to reï¬‚ect a jsp webshell in XSS
â—‹
Copy URI & XSS to WEBROOT/webshell.jsp
â—
Sources
â—‹
https://www.pentestpartners.com/security-blog/hacking-oracle-reporter-a-how-to/ 
â—‹
https://nerdint.blogspot.com/2018/05/less-time-to-perform-penetration-tests.html
8
Weak credentials & JSPF upload
â—
Why & How
â—‹
Exposed WebDav, weak credentials admin:admin
â—‹
Hidden jsp ï¬les but .class accessible, jd-cli ftw!!
â—‹
Reverse shows jspf are included ğŸ¤”
â—‹
Backup and overwrite a .jspf included in a .jsp
â—‹
blocked â€œ ï¬le write -> /log/YYYY-MM-DD/webshell.php
â—
Sources
â—‹
https://wya.pl/2021/12/20/bring-your-own-ssrf-the-gateway-actuator/
â—‹
https://blog.viettelcybersecurity.com/cve-2022-22947-spring-cloud-ga
teway-code-injection-vulnerability/ 
â—
Fun Fact
â—‹
Actuator Gateway used MANY times as an SSRF vector
â—‹
All this time, It was an unknown SpEL RCE........
RCE
RCE
RCE
RCE
RCE
RCE
RCE
RCE
29
Cve-2019-7609 - Kibana prototype pollution
â—
Why & How
â—‹
Hey, itâ€™s a Kibana!
â—‹
Google â€œexploit kibanaâ€ lead to CVE-2019-7609
â—‹
Copy-Paste the prototype-pollution exploit
â—‹
Shell...
â—
Sources
â—‹
https://research.securitum.com/
prototype-pollution-rce-kibana-cve-2019-7609/ 
30
Php SSRF, gopher, & memcached
â—
Why & How
â—‹
Custom php code, *click click* & capture traï¬ƒc in Burp
â—‹
Replay a request with a URL to acquire SSRF
â—‹
SSRF enforces https:// with valid certiï¬cate
â—‹
Use of docker caddy to generate a trusted certiï¬cate
â—‹
Redirect to gopher:// and ï¬nd a memcached
â—‹
Use a ï¬le read to recover all the sources
â—‹
Store a custom serialized php object
â—‹
Trigger the right code path to have the object unserialized
â—
Sources
â—‹
https://www.exploit-db.com/exploits/37815
â—‹
https://www.blackhat.com/docs/us-14/materials/us-14-Novikov-The-New
-Page-Of-Injections-Book-Memcached-Injections-WP.pdf
â—‹
https://hackmag.com/security/a-small-injection-for-memcached/ 
â€œSSRFâ€
31
Gitlab DjVu, â€œloginâ€ to RCE
â—
Why & How