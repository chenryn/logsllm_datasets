8
9
10
11
12
13
14
15
Victim
Attacker
Seattle
London
"
"
"
"
"
"
"
"
"
"
Seattle
Tokyo
"
"
"
"
London
Seattle
"
"
Tokyo
Seattle
"
"
"
"
"
"
Scenario
Hijack start
time (GMT)
Jan 22 14:00
Jan 23 20:00
Jan 25 02:00
Jan 26 08:00
Jan 27 14:00
Jan 28 20:00
Jan 22 20:00
Jan 24 02:00
June 04 02:00
Jan 27 02:00
Jan 28 02:00
June 02 02:00
June 02 06:00
June 03 08:00
June 03 14:00
Pollution
Cuts
Detected?
1st alarming round
Detection
ISPY Performance
(%)
35.6
36.0
36.0
36.4
36.1
36.3
31.4
31.0
34.4
51.3
51.1
51.0
52.3
51.4
51.2
([LB, UB])
[376, 409]
[383, 415]
[384, 417]
[382, 417]
[376, 409]
[379, 413]
[205, 231]
[201, 226]
[219, 246]
[331, 376]
[328, 372]
[788, 839]
[805, 855]
[785, 833]
[793, 841]
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
start time (min)
latency (min)
-2.1
-4.0
-7.0
-4.7
-8.3
-2.6
-2.7
-4.5
0.2
-2.9
-2.7
-0.4
-10.9
-5.5
-6.2
2.1
2.1
2.1
2.7
2.3
2.7
2.7
2.1
3.1
1.4
1.4
3.1
1.8
2.3
2.4
Pollu. at
alarm (%)
0.4
0.4
0.3
0.4
0.4
0.5
0.5
0.3
1.0
0.3
0.4
0.4
0.4
0.4
0.3
low detection latency and low sensitivity to the timings of hijacks
and probing rounds to the fast BGP convergence of new route an-
nouncement [24] and ISPY’s continuous decision making mecha-
nism. The last column of Table 8 shows ISPY only witnessed 0.3
(cid:24) 1.0% of ASes were polluted when the alarm was raised. We note
that the large pollution and number of cuts caused by these hijack-
ing events contributed to the quick discovery of enough polluted
ASes and cuts and hence the low detection latency. For hijacks that
lead to fewer cuts, the detection latency is likely to be longer. Fi-
nally, during the hours when there was no hijacking, ISPY did not
report any false alarm at the three sites.
7. DISCUSSION AND FUTURE WORK
Counter Measures. One potential counter measure by attackers
to data-plane based techniques is to modify the information con-
tained in the probing replies (e.g., [37]). Doing so under a pre(cid:2)x-
owner-centric scheme such as ISPY where the victim AS probes
a large number of ASes requires the attacker AS to manipulate
replies to all traceroute probes that are drawn to itself from pol-
luted ASes. To forward probe replies back to the victim network,
the attacker needs to maintain a valid route back to the victim, i.e.,
it needs to perform an interception attack [4]. We plan to investi-
gate performance-based approaches in our victim-centric detection
framework to detect interception attacks as future work.
Another potential counter measure is pollution shaping, i.e., to
launch an attack with controlled pollution that causes few cuts.
Such a controlled pollution may be achieved by manipulating the
bogus route announcement, e.g., adding certain AS numbers to the
bogus route when it is initially announced, which prevents the route
from being adopted by those ASes. However, such a counter mea-
sure is unlikely to pose a threat for the following reasons. First,
shaping a small-cut pollution is dif(cid:2)cult. Evading pollution at a
few speci(cid:2)ed ASes may not affect the number of cuts due to pollu-
tion, as the large number of peering and multi-homed links of other
polluted ASes will still lead to many cuts. On the other hand, if the
bogus route is padded with too many ASes, its competitiveness and
hence the impact of the hijack become limited. Second, to calcu-
late the exact set of ASes to add to the initial bogus route is quite
challenging. It requires predicting the pollution, which is dif(cid:2)cult
without knowing the exact AS topology and routing policies. We
will investigate these and other counter measures that attackers may
launch against ISPY as part of our future work.
Design Optimizations. Since ISPY will be deployed by the op-
erators of individual networks, its probing module can passively
leverage incoming data traf(cid:2)c into the network to reduce the active
probing cost. We expect there is signi(cid:2)cant temporal diversity in
the incoming data traf(cid:2)c to an AS. A similar idea was exploited in
PlanetSeer [34].
When a network owns multiple pre(cid:2)xes, it can potentially im-
prove ISPY’s detection accuracy of hijacking events by comparing
vPaths generated using probes from different pre(cid:2)xes. Dissimi-
lar cuts, e.g., with some above the threshold and other below, in
these vPaths potentially provide further evidence of hijacking of
some of its pre(cid:2)xes. However, a detailed design exploiting this
idea needs to take into consideration the possibility of all of the
network’s pre(cid:2)xes being hijacked, as well as legitimate reasons for
different vPaths. Another interesting direction to pursue is whether
selecting a (cid:147)personalized(cid:148) threshold by each network can improve
its detection accuracy.
Finally, although the identity of the attacker can potentially be
discovered from RouteViews [18], it remains interesting and we
are currently exploring ways to extend ISPY to also identify the
attacker in real time.
Difference from Reachability Analysis. A recent study by the
Hubble system [16] reported that the extent of reachability prob-
lems is much greater than previously expected. Based on the ac-
tually reported numbers (31692 events with a median duration of
about 2.75 hours from observing 110,000 pre(cid:2)xes for 3 weeks),
we estimate the number of unreachable pre(cid:2)xes to be about 5 in
one ISPY probing round which effectively samples about 3000 pre-
(cid:2)xes. In our 25-day Internet deployment of ISPY in over 100 net-
work locations, we observed the average number of transit ASes
unreachable in a probing round to be 0.9. We attribute the differ-
ence to the fact that ISPY only monitors the reachability to transit
ASes, which are generally much more stable than stub ASes con-
sidered in the Hubble study.
8. RELATED WORK
ISPY is closely related to previous work on IP pre(cid:2)x hijack de-
tection [18, 12, 37, 25]. As summarized in the introduction, none
of the existing detection systems effectively detect IP pre(cid:2)x hijacks
while satisfying all six requirements. The pre(cid:2)x-owner-based prob-
ing in ISPY is intuitive and demonstrated to be effective. Unlike all
previous data-plane-based approaches, the coverage of ISPY is less
limited by probing-unfriendly con(cid:2)gurations and events in the In-
ternet such as traceroute blocking, as we only need to reach transit
networks. Since ISPY is designed to be deployed by pre(cid:2)x owner
networks to protect their own pre(cid:2)xes, it does not detect hijacks of
the unused portion of the pre(cid:2)x address space [26]. Note that the
focus of our work on distinguishing reachability loss patterns due
to hijacking from those due to other failures is a simpler problem
than BGP root cause analysis [9, 30].
Upon detecting pre(cid:2)x hijacking events, the natural next step
of action is to mitigate their impact. Many existing mitigation
schemes include manual response to install (cid:2)lters, ACR [31],
MIRO [33], route purge-promotion [36], and overlay routing. De-
tection followed by reactive mitigation falls into the category of
passive counter measures against pre(cid:2)x hijacking. A number of
proactive prevention solutions have also been proposed [17, 22, 13,
29, 15]. Another area related to pre(cid:2)x hijacking is on impact anal-
ysis [19, 35].
Finally, the probing module design of ISPY builds on previous
work of light-weight end-host-based monitoring systems such as
Rocketfuel [28], PlanetSeer [34], iPlane [20], and Hubble [16]. Our
work also relates to previous work on using data-plane information
to troubleshoot routing problems such as missing routes [7] and
bogon pre(cid:2)xes [6].
9. CONCLUSION
This paper proposes a pre(cid:2)x-owner-based IP pre(cid:2)x hijacking de-
tection system ISPY. The design of ISPY is based on a key obser-
vation we have made on pre(cid:2)x hijacking: due to the rich connec-
tivity of the ASes in the Internet, a pre(cid:2)x hijack almost always
pollutes a signi(cid:2)cant percentage of the ASes. More importantly,
this unreachability has a different signature from that due to a few
link failures near the victim’s network, which can also result in un-
reachability to a large number of ASes.
ISPY is designed to be
readily deployed by a pre(cid:2)x-owner network. It continuously mon-
itors network reachability from external transit networks to its own
network through light-weight probing and scans for the hijacking
signature as the trigger for hijacking alarms.
The pre(cid:2)x-owner-centric design enables ISPY to satisfy all the
requirements of a highly effectively pre(cid:2)x hijacking detection sys-
tem: (1) it is highly accurate with both low false positive and neg-
ative ratios, and its detection accuracy is not limited by the place-
ment of any vantage points; (2) it is real-time, showing a detection
latency of 1.4 (cid:24) 3.1 minutes in our hijacking experiments; (3) it
is light-weight with the average probing traf(cid:2)c rate between 2 (cid:24) 3
KB/s, as it is fully decentralized among the pre(cid:2)x owner networks,
each of which only needs to monitor reachability to the transit net-
works; (4) it is readily deployable by any pre(cid:2)x-owner network; (5)
it creates strong incentive for deployment as deployment by each
pre(cid:2)x-owner network directly bene(cid:2)ts itself, and (6) it is intrinsi-
cally robust in victim noti(cid:2)cation as the pre(cid:2)x owner makes hijack-
ing detection decision locally. Our work departs signi(cid:2)cantly from
the existing infrastructure-based designs of hijacking attack detec-
tion and demonstrates the effectiveness of end-host-based probing
and analysis.
Acknowledgements
We thank the anonymous reviewers for their helpful comments.
This work was supported in part by NSF grants CAREER-0238379,
CyberTrust-0430204, and CAREER-0643612.
10. REFERENCES
[1] RIPE RIS. http://www.ripe.net/ris/.
[2] University of Oregon Route Views Archive Project.
http://www.routeviews.org.
[3] B. Augustin, X. Cuvellier, B. Orgogozo, F. Viger, T. Friedman, M. Latapy,
C. Magnien, and R. Teixeira. Avoiding traceroute anomalies with paris
traceroute. In Proc. ACM SIGCOMM IMC, 2006.
[4] H. Ballani, P. Francis, and X. Zhang. A Study of Pre(cid:2)x Hijacking and
Interception in the Internet. In Proc. ACM SIGCOMM, August 2007.
[5] P. Boothe, J. Hiebert, and R. Bush. How Prevalent is Pre(cid:2)x Hijacking on the
Internet. NANOG36 Talk, February 2006.
[6] R. Bush, J. Hiebert, O. Maennel, M. Roughan, and S. Uhlig. Testing the
reachability of new address space. In Proc. ACM SIGCOMM INM, 2007.
[7] D.-F. Chang, R. Govindan, and J. Heidemann. Exploring the Ability of
Locating BGP Missing Routes from Multiple Looking Glasses. In Proc. ACM
Workshop on Netw. Troubleshooting, 2004.
[8] H. Chang, R. Govindan, S. Jamin, S. Shenker, and W. Willinger. Towards
capturing representative AS-level Internet topologies. Computer Networks, 44
(6):737(cid:150)755, April 2004.
[9] A. Feldmann, O. Maennel, Z. M. Mao, A. Berger, and B. Maggs. Locating
Internet Routing Instabilities. In Proc. ACM SIGCOMM, 2004.
[10] L. Gao. On Inferring Autonomous System Relationships in the Internet. In
Proc. IEEE Global Internet Symposium, 2000.
[11] Y. He, G. Siganos, M. Faloutsos, and S. V. Krishnamurthy. A systematic
framework for unearthing the missing links: Measurements and Impact. In
Proc. NSDI, 2007.
[12] X. Hu and Z. M. Mao. Accurate Real-time Identi(cid:2)cation of IP Pre(cid:2)x Hijacking.
In Proc. IEEE Security and Privacy, 2007.
[13] Y.-C. Hu, A. Perrig, and M. Sirbu. SPV: A Secure Path Vector Scheme for
Securing BGP. In Proc. ACM SIGCOMM, 2004.
[14] B. Huffaker. Caida as ranking project. July, 2006,
http://ww.caida.org/analysis/topology/rank_as/.
[15] J. Karlin, J. Karlin, S. Forrest, and J. Rexford. Pretty Good BGP: Improving
BGP by Cautiously Adopting Routes. In Proc. ICNP, 2006.
[16] E. Katz-Bassett, H. V. Madhyastha, J. P. John, A. Krishnamurthy, D. Wetherall,
and T. Anderson. Studying Blackholes in the Internet with Hubble. In Proc.
NSDI, 2008.
[17] S. Kent, C. Lynn, and K. Seo. Secure Border Gateway Protocol (Secure-BGP).
IEEE J. Selected Areas in Communications, 18 (4):582(cid:150)592, April 2000.
[18] M. Lad, D. Massey, D. Pei, Y. Wu, B. Zhang, and L. Zhang. PHAS: A Pre(cid:2)x
Hijack Alert System. In Proc. USENIX Security Symposium, 2006.
[19] M. Lad, R. Oliveira, B. Zhang, and L. Zhang. Understanding resiliency of
Internet topology against pre(cid:2)x hijack attacks. In Proc. DSN, 2007.
[20] H. V. Madhyastha, T. Anderson, A. Krishnamurthy, N. Spring, and
A. Venkataramani. iPlane: An information plane for distributed services. In
Proc. OSDI, Nov. 2006.
[21] Z. M. Mao, J. Rexford, J. Wang, and R. Katz. Towards an accurate AS-level
traceroute tool. In Proc. ACM SIGCOMM, 2003.
[22] J. Ng. Extensions to BGP to Support Secure Origin BGP (soBGP). IETF Draft:
draft-ng-sobgp-bgp-extensions-01.txt, November 2002.
[23] R. Oliveira, D. Pei, W. Willinger, B. Zhang, and L. Zhang. In search of the
elusive ground truth: The Internet’s AS-level connectivity structure. In Proc.
ACM SIGMETRICS, 2008.
[24] R. Oliveira, B. Zhang, D. Pei, R. Izhak-Ratzin, and L. Zhang. Quantifying path
exploration in the Internet. In Proc. ACM SIGCOMM IMC, 2006.
[25] J. Qiu, L. Gao, S. Ranjan, and A. Nucci. Detecting Bogus BGP Route
Information: Going Beyond Pre(cid:2)x Hijacking. In Proc. SECURECOMM, 2007.
[26] A. Ramachandran and N. Feamster. Understanding the network-level behavior
of spammers. In Proc. of ACM SIGCOMM, 2006.
[27] C. A. Shue, A. Kalafut, and M. Gupta. The web is smaller than it seems. In
Proc. ACM SIGCOMM IMC, 2007.
[28] N. Spring, R. Mahajan, D. Wetherall, and T. Anderson. Measuring ISP
topologies with Rocketfuel. IEEE/ACM Trans. Netw., 12(1):2(cid:150)16, 2004.
[29] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and R. H. Katz. Listen and
Whisper: Security Mechanisms for BGP. In Proc. NSDI, 2004.
[30] R. Teixeira and J. Rexford. A measurement framework for pin-pointing routing
changes. In Proc. ACM Workshop on Netw. Troubleshooting, 2004.
[31] D. Wendlandt, I. Avramopoulos, D. Andersen, and J. Rexford. Don’t Secure
Routing Protocols, Secure Data Delivery. In Proc. ACM HotNets, 2006.
[32] J. Wu, Y. Zhang, Z. M. Mao, and K. Shin. Internet Routing Resilience to
Failures: Analysis and Implications. In Proc. ACM CoNEXT, 2007.
[33] W. Xu and J. Rexford. MIRO: multi-path interdomain routing. In Proc. ACM
SIGCOMM, 2006.
[34] M. Zhang, C. Zhang, V. Pai, L. Peterson, and R. Wang. PlanetSeer: Internet
Path Failure Monitoring and Characterization in Wide-Area Services. In Proc.
OSDI, Dec. 2004.
[35] Y. Zhang, Z. Zhang, Z. M. Mao, Y. C. Hu, and B. Maggs. On the impact of
route monitor selection. In Proc. ACM SIGCOMM IMC, 2007.
[36] Z. Zhang, Y. Zhang, Y. C. Hu, and Z. M. Mao. Practical Defenses Against BGP
Pre(cid:2)x Hijacking. In Proc. ACM CoNEXT, 2007.
[37] C. Zheng, L. Ji, D. Pei, J. Wang, and P. Francis. A Light-Weight Distributed
Scheme for Detecting IP Pre(cid:2)x Hijacks in Realtime. In Proc. ACM SIGCOMM,
2007.