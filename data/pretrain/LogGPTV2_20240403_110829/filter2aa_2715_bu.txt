rameters\Interfaces\{0E271E68
-9033- 4A25-9883-
A020B191B3C1} /Static##### 
Wireless XP 
X
P  
SOFTWARE\Microsoft\EAPOL\ Par
ameters\Interfaces\{0E271E68-
9033- 4A25-9883-A020B191B3C1} 
/ # 
WordPad MRU 
X
P  
7 8 
1
0 
NTUSER.DAT\Software\Microsoft
\ Windows\CurrentVersion\Appl
ets\ Wordpad\Recent File List 
WPD Bus Enum 
Enumeration 
 8 
1
0 
SYSTEM\ControlSet001\Enum\ SW
D\WPDBUSENUM 
WPD Bus Enum Root 
Enumeration User Mode 
Bus Drive Enumeration 
7 8 
1
0 
SYSTEM\ControlSet001\Enum\ Wp
dBusEnumRoot\UMB\ 
WPD Device Interface 
7 8 
1
0 
SYSTEM\ControlSet001\ Control
\DeviceClasses\{6ac27878- 
a6fa-4155-ba85-f98f491d4f33} 
Write Block USB 
Devices 
7   
SYSTEM\ControlSet###\Control\
storageDevicePolicies\ 
Write Block USB 
Devices 
X
P  
7 8  
SYSTEM\ControlSet###\Control\ 
StorageDevicePolicies / 
WriteProtect 
XP Search Assistant 
history 
X
P  
NTUSER.DAT\Software\Microsoft
\Search Assistant\ACMru\#### 
Yahoo Chat Rooms 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\\Chat 
Yahoo! 
NTUSER.DAT\Software\Yahoo\Pag
er\ Profiles\* 
Yahoo! File Transfers 
NTUSER.DAT\Software\Yahoo\Pag
er\ File Transfer 
415 
Yahoo! File Transfers 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\screen name 
\ FileTransfer 
Yahoo! Identities 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\screen name / 
All Identities, Selected 
Identities 
Yahoo! Last User 
NTUSER.DAT\Software\Yahoo\ Pa
ger - Yahoo! User ID 
Yahoo! Message 
Archiving 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\screen 
name\Archive 
Yahoo! Password 
NTUSER.DAT\Software\Yahoo\ Pa
ger - EOptions string 
Yahoo! Recent 
Contacts 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\screen 
name\IMVironments\ Recent 
Yahoo! Saved Password 
NTUSER.DAT\Software\Yahoo\ Pa
ger - Save Password 
Yahoo! Screen Names 
NTUSER.DAT\Software\Yahoo\Pag
er\ profiles\screen name 
Yserver 
NTUSER.DAT\Software\Yahoo\Yse
rver 
REFERENCE: 
https://www.dfir.training/resources/downloads/windows-registry 
https://www.13cubed.com/downloads/dfir_cheat_sheet.pdf 
https://static1.squarespace.com/static/552092d5e4b0661088167e5c/t/5d497aefe
58b7e00011f6947/1565096688890/Windows+Registry+Auditing+Cheat+Sheet+ver+Aug
+2019.pdf 
W
W 
WINDOWS_Structure 
ALL 
INFORMATIONAL 
WINDOWS 
Windows top-level default file structure and locations in C:\. 
DIRECTORY 
DESCRIPTION 
\PerfLogs 
Windows performance logs, but on a 
default configuration, it is empty. 
\Program Files 
32-bit architecture: Programs 16-bit 
and 32-bit installed in this folder. 
64-bit architecture: 64-bit programs 
installed in this folder. 
\Program Files (x86) 
Appears on 64-bit editions of Windows. 
32-bit and 16-bit programs are by 
default installed in this folder. 
\ProgramData  
Contains program data that are expected 
to be accessed by applications system 
416 
wide. The organization of the files is 
at the discretion of the developer. 
\Users 
Folder contains one subfolder for each 
user that has logged onto the system at 
least once. In addition: "Public" and 
"Default" (hidden),"Default User" (NTFS 
"Default" folder) and "All Users" (NTFS 
symbolic link to "C:\ProgramData"). 
\Users\Public 
Folder serves as a buffer for users of 
a computer to share files. By default, 
this folder is accessible to all users 
that can log on to the computer. By 
default, this folder is shared over the 
network with a valid user account. This 
folder contains user created data 
(typically empty). 
%USER%\AppData  
This folder stores per-user application 
data and settings. The folder contains 
three subfolders: Roaming, Local, and 
LocalLow. Roaming data saved in Roaming 
will synchronize with roaming profiles 
to other computer when the user logs 
in. Local and LocalLow does not sync up 
with networked computers. 
\Windows 
Windows itself is installed into this 
folder. 
\Windows\System 
Folders store DLL files that implement 
the core features of Windows. Any time 
a program asks Windows to load a DLL 
file and do not specify a path, these 
folders are searched after program's 
own folder is searched. "System" stores 
16-bit DLLs and is normally empty on 
64-bit editions of Windows. "System32" 
stores either 32-bit or 64-bit DLL 
files, depending on whether the Windows 
edition is 32-bit or 64-bit. "SysWOW64" 
only appears on 64-bit editions of 
Windows and stores 32-bit DLLs. 
\Windows\System32 
\Windows\SysWOW64 
\WinSxS 
This folder is officially called 
"Windows component store" and 
constitutes the majority of Windows. A 
copy of all Windows components, as well 
as all Windows updates and service 
packs is stored in this folder. 
Starting with Windows 7 and Windows 
Server 2008 R2, Windows automatically 
scavenges this folder to keep its size 
in check. For security reasons and to 
avoid the DLL issues, Windows enforces 
very stringent requirements on files. 
417 
W
W 
WINDOWS_Tricks 
RED/BLUE TEAM 
MISC 
WINDOWS 
Allow payload traffic through firewall: 
netsh firewall add allowedprogram C:\payload.exe MyPayload ENABLE 
Open port on firewall: 
netsh firewall add portopening TCP 1234 MyPayload ENABLE ALL 
Delete open port on firewall: 
netsh firewall delete portopening TCP 1234 
Enable Remote Desktop 
reg add 
“HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal 
Server” /v fDenyTSConnections /t REG_DWORD /d 0 /f 
NTFS Enable Last Time File Accessed reg key as 0.  
reg add "HKLM\SYSTEM\CurrentControlSet\Control\FileSystem" /v 
NtfsDisableLastAccessUpdate /d 0 /t REG_DWORD /f 
POWERSHELL REVERSE TCP SHELL 
https://github.com/ZHacker13/ReverseTCPShell 
WINDOWS COVER TRACKS 
Delete all log files from WINDIR directory: 
del %WINDIR%\*.log /a /s /q /f 
Delete all System log files: 
for /f %a in ('wevtutil el') do @wevtutil cl "%a" 
Delete specific System log files: 
#1 List System log file 
wevtutil el 
#2 Delete specific System log 
wevtutil cl [LOGNAME] 
wevtutil el | Foreach-Object {wevtutil cl "$_"} 
PowerShell Change Timestamp of directory 
418 
PS> (Get-Item "C:\Windows\system32\MyDir").CreationTime=("01 March 
2019 19:00:00") 
PowerShell Changing Modification time of a file 
PS> (Get-Item 
"C:\ Windows\system32\MyDir\payload.txt").LastWriteTime=("01 March 
2019 19:00:00") 
PowerShell Changing Access time of a file 
PS> (Get-Item "C:\ Windows\system32\MyDir\payload.txt 
").LastAccessTime=("01 March 2019 19:00:00") 
PowerShell Change all Creation times of files in current directory 
$files =  Get-ChildItem -force | Where-Object {! $_.PSIsContainer}  
foreach($object in $files) 
{ 
     $object.CreationTime=("01 March 2019 19:00:00") 
} 
W
W 
WINDOWS_Versions 
ALL 
INFORMATIONAL 
WINDOWS 
VERSION 
DATE 
RELEASE 
LATEST 
Windows 10 
15-Jul-15 
NT 10.0 
18362 1903 
Windows 8.1  
27-Aug-13 
NT 6.3 
9600 
Windows 8 
01-Aug-12 
NT 6.2 
9200 
Windows 7 
22-Jul-09 
NT 6.1 
7601 
Windows Vista 
08-Nov-06 
NT 6.0 
6002 
Windows XP Pro 
25-Apr-05 
NT 5.2 
3790 
Windows XP 
24-Aug-01 
NT 5.1 
2600 
Windows Me 
19-Jun-00 
4.9 
3000 
Windows 2000 
15-Dec-99 
NT 5.0 
2195 
Windows 98 
15-May-98 
4.1 
2222 A 
Windows NT 4.0 
31-Jul-96 
NT 4.0 
1381 
Windows 95 
15-Aug-95 
4 
950 
Windows NT 3.51 
30-May-95 
NT 3.51 
1057 
Windows NT 3.5 
21-Sep-94 
NT 3.5 
807 
Windows 3.2 
22-Nov-93 
3.2 
153 
Windows 3.11 
08-Nov-93 
3.11 
300 
Windows NT 3.1 
27-Jul-93 
NT 3.1 
528 
Windows 3.1 
06-Apr-92 
3.1 
103 
Windows 3.0 
22-May-90 
3 
N/A 
Windows 2.11 
13-Mar-89 
2.11 
N/A 
Windows 2.10 
27-May-88 
2.1 
N/A 
Windows 2.03 
09-Dec-87 
2.03 
N/A 
419 
Windows 1.04 
10-Apr-87 
1.04 
N/A 
Windows 1.03 
21-Aug-86 
1.03 
N/A 
Windows 1.02 
14-May-86 
1.02 
N/A 
Windows 1.0 
20-Nov-85 
1.01 
N/A 
REFERENCE:  
https://en.wikipedia.org/wiki/List_of_Microsoft_Windows_versions 
W
W 
WINDOWS DEFENDER ATP 
BLUE TEAM 
THREAT HUNT 
WINDOWS 
Microsoft Defender Advanced Threat Protection is a platform 
designed to help enterprise networks prevent, detect, investigate, 
and respond to advanced threats. 
DESCRIPTION 
QUERY 
Possible RDP 
tunnel 
ProcessCreationEvents | where EventTime > 
ago(10d) 
| where (ProcessCommandLine contains ":3389" or 
ProcessCommandLine contains ":6511") 
| project EventTime, ComputerName, AccountName, 
InitiatingProcessFileName, ActionType, 
FileName, ProcessCommandLine, 
InitiatingProcessCommandLine 
Allow RDP 
connection 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where ( ProcessCommandLine contains "SC 
CONFIG" and ProcessCommandLine contains 
"DISABLED" and ProcessCommandLine contains 
"wuauserv" ) 
or (ProcessCommandLine contains "Terminal 
Serve" and ProcessCommandLine contains 
"fDenyTSConnections" and ProcessCommandLine 
contains "0x0"  ) 
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
InitiatingProcessFileName 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName 
inf file echo 
creation/execut
ion 
ProcessCreationEvents   
| where EventTime > ago(17d) 
| where ProcessCommandLine contains "echo" and 
ProcessCommandLine contains ".inf" 
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
420 
InitiatingProcessFileName 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName 
Accounts 
Creation 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where ProcessCommandLine contains "net user" 
and ProcessCommandLine contains "/add" 
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
InitiatingProcessFileName 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName 
Local Accounts 
Activation 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where ProcessCommandLine contains 
"Administrator /active:yes" or 
ProcessCommandLine contains "guest /active:yes"  
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
InitiatingProcessFileName 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName 
User Addition 
to Local Groups 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where ProcessCommandLine contains 
"localgroup" and ProcessCommandLine contains 
"/add" and ( ProcessCommandLine contains 
"Remote Desktop Users" or ProcessCommandLine 
contains "administrators") 
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
InitiatingProcessFileName 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName 
Service 
Creation 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where FileName contains "SECEDIT"  
| where ProcessCommandLine == @"secedit.exe 
/export /cfg ** .inf" 
| summarize makeset(ComputerName), 
makeset(AccountName), 
makeset(ProcessCommandLine)  by 
InitiatingProcessFileName 
421 
Alert Events 
AlertEvents  
| where EventTime > ago(7d) 
| summarize makeset(FileName), 
dcount(FileName), makeset(ComputerName), 
makeset(Category), dcount(ComputerName) by 
Title  
| sort by dcount_ComputerName desc 
Alert Events by 
Category 
AlertEvents  
| where EventTime > ago(7d) 
| summarize dcount(ComputerName), 
dcount(FileName), makeset(FileName), 
makeset(ComputerName) by  Category, Severity 
| sort by dcount_ComputerName desc 
Alert Events by 
ComputerName 
AlertEvents  
| where EventTime > ago(7d) 
| summarize dcount(Category), dcount(FileName), 
makeset(Category), makeset(FileName) by 
ComputerName, Severity 
| sort by dcount_Category desc 
Alert Events by 
FileName 
AlertEvents  
| where EventTime > ago(7d) 
| summarize dcount(ComputerName), 
dcount(Category), makeset(Severity),  
makeset(Category), makeset(ComputerName) by 
FileName 
| sort by dcount_ComputerName desc 
Alert Events by 
Win Defender 
MiscEvents     
| where EventTime > ago(17d) 
| where ActionType == "WDAVDetection" 
| summarize  makeset(FileName), 
makeset(InitiatingProcessParentFileName), 
makeset(InitiatingProcessFileName), 
makeset(InitiatingProcessCommandLine), 
makeset(FolderPath), 
makeset(InitiatingProcessFolderPath) , 
makeset(AccountName )  by ComputerName 
Clearing Event 
Log Activity 
ProcessCreationEvents   
| where EventTime > ago(10d) 
| where ProcessCommandLine contains "call 
ClearEventlog" or InitiatingProcessCommandLine 
contains "call ClearEventlog"  
| summarize makeset(ComputerName), 
makeset(AccountName), dcount(ComputerName)   by 
InitiatingProcessFileName, ProcessCommandLine 
| sort by dcount_ComputerName desc 
Output 
Redirection 
Activity 
ProcessCreationEvents   
| where EventTime > ago(10d) 
| where ProcessCommandLine contains "2>&1" 
| summarize makeset(ComputerName), 
makeset(AccountName), dcount(ComputerName)   by 
422 
InitiatingProcessFileName, ProcessCommandLine 
| sort by dcount_ComputerName desc 
Remote Share 
Mounting 
Activity 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where ProcessCommandLine contains "net.exe" 
| where ProcessCommandLine contains "\\c$" or 
ProcessCommandLine contains "\\admin$" or 
ProcessCommandLine contains "\\ipc$" 
IMPACKET 
Artifact Search 
ProcessCreationEvents   
| where EventTime > ago(10d) 
| where ProcessCommandLine contains 
"127.0.0.1\\ADMIN$\\" and ProcessCommandLine 
contains "2>&1" 
| project EventTime , 
InitiatingProcessFileName , ProcessCommandLine, 
AccountName , ComputerName  
| sort by InitiatingProcessFileName desc 
| top 1000 by EventTime 
Process Dump 
Activity 
ProcessCreationEvents   
| where EventTime > ago(10d) 
| where (ProcessCommandLine contains "-
accepteula" and ProcessCommandLine contains 
"1>") or (ProcessCommandLine contains "-
accepteula" and ProcessCommandLine contains "-
ma") 
| summarize makeset(ComputerName), 
makeset(AccountName), dcount(ComputerName)   by 
InitiatingProcessFileName, ProcessCommandLine 
| sort by dcount_ComputerName desc 
Network 
Activity thru 
Cscript/Wscript 
NetworkCommunicationEvents  
| where EventTime > ago(7d) 
| where InitiatingProcessFileName in 
("cscript.exe", "wscript.exe") 
| summarize 
makeset(InitiatingProcessParentName), 
makeset(RemoteUrl), makeset(RemotePort), 
makeset(InitiatingProcessAccountName)  ,dcount(
RemoteUrl) by InitiatingProcessCommandLine 
| sort by dcount_RemoteUrl desc 
Network 
Activity thru 
PowerShell 
NetworkCommunicationEvents  
| where EventTime > ago(1d) 
| where InitiatingProcessFileName =~ 
"powershell.exe" 
| summarize makeset(RemoteUrl), 
makeset(RemotePort), 
makeset(InitiatingProcessAccountName)  ,dcount(
RemoteUrl) by InitiatingProcessCommandLine 
| sort by dcount_RemoteUrl desc  
BitsAdmin 
Execution 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where FileName contains "bitsadmin.exe" 
423 
| where ProcessCommandLine contains "/TRANSFER" 
or ProcessCommandLine contains "/CREATE" or 
ProcessCommandLine contains "/ADDFILE" 
or ProcessCommandLine contains "/SETPROXY" or 
ProcessCommandLine contains "/SETNOTIFYCMDLINE" 
or ProcessCommandLine contains 
"/SETCUSTOMHEADERS" 
or ProcessCommandLine contains 
"/SETSECURITYFLAGS" or ProcessCommandLine 
contains "/SETREPLYFILENAME" 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName   
| top 1000 by EventTime 
BitsAdmin 
Transfer 
ProcessCreationEvents   
| where EventTime > ago(7d) 
| where FileName =~ "bitsadmin.exe" 
| where ProcessCommandLine contains "/transfer" 
| project EventTime, ComputerName, 
ProcessCommandLine, InitiatingProcessFileName, 
AccountName   
| top 1000 by EventTime 