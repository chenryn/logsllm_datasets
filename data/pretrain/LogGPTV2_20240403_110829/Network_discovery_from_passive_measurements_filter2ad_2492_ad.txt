measurement nodes refers to each hop count vector observ-
ing X randomly selected hop counts with the rest of the
vector incomplete. The new imputation method (Gaussian
mixture EM) results are compared in terms of Root Mean
Squared Error (RMSE, Equation 6) in Figure 11 against
a naive mean method.
In this analysis, we consider mea-
surements from sources that were observed in 16 honey-
pots for the synthetic topology with three diﬀerent sizes
(N = 1000, 2000, 3000). The results shows a clear advan-
tage to using the Gaussian mixture imputation method for
even a small amount of observed measurements.
6.2 Shared Path Estimation with Imputed
Data
Next, we assess how topology estimation is aﬀected by us-
ing imputed data. Following the method from Section 5.2.2,
the incomplete case derives clusters from imputed hop con-
trast vectors (using the Gaussian mixture imputation algo-
rithm) and then performs active measurements on the clus-
ters. The use of imputed hop contrast vectors introduces
more uncertainty on the topological signiﬁcance of the clus-
ters.
To derive the estimated shared path length estimation for
using incomplete data, we follow the derivation from Sec-
tion 5.2.3, replacing all occurrences of the complete hop
count distance vectors hi, with the imputed hop count dis-
tance vectors (cid:98)hi.
(cid:98)P (i, j, k) = α
(cid:179)(cid:98)Ui,j,k, k
(cid:180)
(cid:179)(cid:98)hi,k,(cid:98)hj,k
(cid:180)
(7)
6.3 Topology Estimation Performance with
min
Imputed Data
Using synthetic topologies generated by Orbis, we assess
the impact of missing data imputation on topology estima-
tion. We generate three diﬀerent synthetic topologies with
1000, 2000, and 3000 nodes. The measurement nodes are
randomly chosen from the set of leaf nodes in the topol-
ogy, with the passive measurements simulated as the length
of the shortest path found in the topology between the IP
sources and the measurement nodes. After imputation of
Figure 10: The eﬀect of increasing the number of
clusters on the shared path estimation performance
on the Skitter topology using the Gaussian mixture
EM cluster-level shared path estimation method.
6. THE MISSING DATA PROBLEM
In Section 5, we evaluated our methods for estimating
shared infrastructure between IP sources with hop count
distance values between all sources and measurement nodes.
However, it is unlikely that packets from large numbers of IP
sources will be seen at a random set of widely measurement
nodes. Thus for a given set of measurement nodes (such
as the honeypots describe in Section 3), there will be some
number of hop count distance observations missing from the
observed set. For each IP source i, we have a (potentially
incomplete) hop count vector h
known is a
known subset of the indices of the complete set of measure-
ment nodes for IP source i.
where I(i)
(i)
known
i,I
We assume that this data is Missing-at-Random (where
the missing data locations are chosen at random). With
some assumptions on the topology and statistical tech-
niques, we have developed a method for imputing this miss-
ing data.
6.1 Imputation Methods
6.1.1 Network-centric Imputation
Given missing data, one can easily conceive of simple im-
putation methods, such as imputing based on the mean value
of the element, or using the nearest neighbors based on the
observed elements of the distance vector. One problem with
such a simplistic approach is that it does not take advantage
of the structural characteristics of the network. As describe
in [8], we can exploit the observed hop count distances from
sources that are an integer oﬀset from a source missing a
hop count distance value. This method can be considered
analogous to using nearest neighbor imputation on the hop
count contrast vectors. For N sources and M measurement
nodes in the network, this imputation method has compu-
tation complexity O
. In the following, we describe
a new method for imputing missing data that improves on
the prior, network-centric approach in instances when larger
fractions of data are missing.
6.1.2 Gaussian Mixture EM Imputation
In Section 4.2, we reasoned that a mixture of Gaussians
model encapsulates the variability found in the hop count
contrast vectors.
In [14], a Gaussian mixture EM algo-
N 2M
(cid:161)
(cid:162)
Figure 11: Imputation accuracy over a range of randomly selected missing values using data from M = 16
honeypots. (Left) N = 1000, (Center) N = 2000, (Right) N = 3000
the missing data using the mixture of Gaussians technique,
10 clusters are found in the imputed hop count contrast
vectors, resulting in a active probe budget of 20 active mea-
surements per measurement node. Figure 12 shows that the
estimation of shared paths using the predictive methodol-
ogy from Section 5 is comparable to the cluster-level deter-
ministic estimation method for a majority of missing data
percentages. The RMSE error rate for the estimated path
lengths is deﬁned as:
(cid:115)(cid:88)
RM SE( ˆP ) =
|P (i, j, k) − ˆP (i, j, k)|2
i,j,k
When the simulated topology is expanded to 2000 and
3000 total nodes, the eﬀects on the shared path estimation
algorithms can be seen in Figures 13. As seen from the ﬁg-
ures, the increase in graph size improves upon the estimation
for both algorithms.
We also consider the impact of imputation using the Skit-
ter dataset. We selected a subset of 700 leaf nodes as IP
sources and randomly selected other leaf nodes as measure-
ment nodes. Data representing passive measurements was
derived from the graph and the shared infrastructure was
estimated for diﬀerent levels of missing data. In Figure 14,
we see the performance of the two shared path length esti-
mation methods on the Skitter topology for (M = 8, 16, 24)
and 10 clusters found. In contrast to the results from the
synthetic topologies, the predictive estimation method per-
forms better than the cluster-level method. This can be
explained by the fact that Skitter measurements typically
only have a single leaf node for each branch of the topol-
ogy. This puts the Cluster-level method at a disadvantage
for estimating shared topology.
7. CONCLUSIONS AND FUTURE WORK
In this paper, we address the problem of identifying net-
work structure and topology through the use of passive mea-
surements of IP packet traﬃc. While prior work on client
clustering, shared path estimation and router-level topology
mapping has been based on information embedded in IP ad-
dresses or via active-probes, passive measurements oﬀer an
opportunity to expand perspective and reduce traﬃc and
management overhead. However, the minimal information
(source ID’s and hop counts) considered in our problem for-
mulation presents serious challenges to identifying meaning-
ful network structure. We describe a method for clustering
hosts based on Gaussian mixtures of hop count vectors. We
demonstrate the trade-oﬀs between cluster size and shared
path length using a set of synthetic topologies. We then
describe two topology estimation techniques that rely on
a small set of active probe-based measurements. The ﬁrst
method established ground truth paths between clusters via
active probes, and the second uses a predictive approach to
estimate shared path lengths based on a topology frame-
work established with active probes. The capabilities of
both methods are evaluated using synthetic and empirical
network maps. Finally, we describe an imputation method
for estimating missing data in passive measurements, and
demonstrate the capabilities of this method using data col-
lected in a set of network honeypots distributed around the
Internet.
This study represents a ﬁrst step toward our goal of ac-
curately identifying Internet topology with passive mea-
surements. There are several important next steps that
we intend to address in future work. The ﬁrst is to con-
struct larger graphs of the Internet using datasets from hon-
eynets [1] and other sources such as web servers that receive
a great deal of traﬃc, and to validate these extensively with
data sets from Internet mapping projects such as Skitter.
We also plan to develop additional methods for enriching
our graphs, for example, by coupling them with other data
such as BGP routing information, and to consider how dy-
namic changes in hop counts can be accommodated in our
formulations. Finally, we plan consider problems related to
measurement such as optimal monitor placement, and re-
duction or elimination of active measurements for shared
topology estimation.
Acknowledgments
The authors would like to thank Farnam Jahanian and
Michael Bailey from the IMS project at University of
Michigan for providing the data used in this study. This
work was supported in part by NSF grants CNS-0347252,
CNS-0646256, CNS-0627102 and CCR-0355653. Any opin-
ions, ﬁndings, conclusions, or recommendations expressed in
this material are those of the authors and do not necessarily
reﬂect the views of the NSF.
Figure 12: Topology estimation performance for two diﬀerent estimation methods in a 1000 node synthetic
topology, ((Left) M = 8, (Center) M = 16, (Right) M = 24)
Figure 13: Performance of topology estimation algorithm in 1000, 2000, and 3000 node synthetic topologies
with M = 16, (Left) - Predictive Function Topology Estimation, (Right) - Cluster-Level Topology Estimation.
8. REFERENCES
[1] The Honeynet Project. http://www.honeynet.org/,
2008.
[2] D. Alderson, L. Li, W. Willinger, and J. Doyle.
Understanding Internet Topology: Principles, Models
and Validation. IEEE/ACM Transactions on
Networking, 13(6), December 2005.
[3] M. Bailey, E. Cooke, F. Jahanian, J. Nazario, and
D. Watson. The Internet Motion Sensor: A
Distributed Blackhole Monitoring System. In
Proceedings of The Network and Distributed Security
Symposium (NDSS ’05), San Diego, CA, January
2005.
[4] P. Barford, A. Bestavros, J. Byers, and M. Crovella.
On the Marginal Utility of Network Topology
Measurements. In Proceedings of ACM Internet
Measurement Workshop (IMW ’01), San Francisco,
CA, October 2001.
[5] CAIDA. The Skitter Project.
http://www.caida.org/tools/measurement/skitter/,
2007.
[6] M. Coates, R.Castro, R. Nowak, M. Gadhiok,
R. King, and Y. Tsang. Maximum Likelihood Network
Topology Identiﬁcation from Edge-based Unicast
Measurements. In Proceedings of ACM SIGMETRICS
’02, Marina Del Rey, CA, June 2002.
[7] F. Dabek, R. Cox, F. Kaashoek, and R. Morris.
Vivaldi: A Decentralized Network Coordinate System.
In Proceedings of ACM SIGCOMM ’04, Portland, OR,
August 2004.
[8] B. Eriksson, P. Barford, R. Nowak, and M. Crovella.
Learning Network Topology from Passive
Measurements. In Proceedings of ACM Internet
Measurements Conference (IMC) ’07, San Diego, CA,
October 2007.
[9] M. Fomenkov, K. Keys, D. Moore, and K. Claﬀy.
Longitudinal Study of Internet Traﬃc from 1998-2003.
In Proceedings of the Winter International Symposium
on Information and Communications Technologies,
January 2003.
[10] C. Fraleigh, S. Moon, B. Lyles, C. Cotton, M. Khan,
D. Moll, R. Rockell, T. Seely, and C. Diot.
Packet-Level Traﬃc Measurements from the Sprint IP
Backbone. IEEE Network, 17(6), Nov.-Dec. 2003.
[11] P. Francis, S. Jamin, C. Jin, Y. Jin, D. Raz,
Y. Shavitt, and L. Zhang. IDMaps: A Global Internet
Host Distance Estimation Service. IEEE/ACM
Transactions on Networking, 9(5), 2001.
[12] P. Francis, S. Jamin, V. Paxson, D. Bryniewicz, and
Y. Jin. An Architecture for a Global Internet Host
Distance Estimation Service. In Proceedings of IEEE
INFOCOM ’99, New York, NY, April 1999.
Figure 14: Topology estimation performance for two diﬀerent estimation methods, with Gaussians mixture
imputation in the Skitter topology. ((Left) M = 8, (Center) M = 16, (Right) M = 24)
[13] Z. Ghahramani and M. Jordan. Supervised Learning
from Incomplete Data via the EM Approach. In
Advances in Neural Information Processing, 1994.
[14] Z. Ghahramani and M. I. Jordan. Supervised Learning
from Incomplete Data via the EM Approach.
Advances in Neural Information Processing Systems 6
(NIPS ’94), 1994.
[15] R. Govindan and H. Tangmunarunkit. Heuristics for
Internet Map Discovery. In Proceedings of IEEE
INFOCOM ’00, Tel Aviv, Israel, March 2000.
[16] B. Gueye, A. Ziviani, M. Crovella, and S. Fdida.
Constraint-based Geolocation of Interenet Hosts. In
Proceedings of ACM Internet Measurement Conference
(IMC ’04), Taormina, Italy, October 2004.
[17] B. Gueye, A. Ziviani, M. Crovella, and S. Fdida.
Constraint-Based Geolocation of Internet Hosts.
IEEE/ACM Transactions on Networking, December
2006.
[18] C. Jin, H. Wang, and K. Shin. Hop-Count Filtering:
An Eﬀective Defense Against Spoofed Traﬃc. In
Proceedings of IEEE INFOCOM ’03, San Francisco,
CA, April 2003.
[24] P. Madadevan, C. Hubble, D. Krioukov, B. Huﬀaker,
and A. Vahdat. Orbis: Rescaling Degree Correlations
to Generate Annotated Internet Topologies. In
Proceedings of ACM SIGCOMM ’07, Kyoto, Japan,
August 2007.
[25] E. Ng and H. Zhang. Predicting Internet Network
Distance with Coordinate-baseed Approaches. In
Proceedings of IEEE INFOCOM ’02, New York, NY,
April 2002.
[26] Packetdesign. Route Explorer.
http://www.packetdesign.com/, 2008.
[27] R. Pang, V. Yegneswaran, P. Barford, V. Paxson, and
L. Peterson. Characteristics of Internet Background
Radiation. In Proceedings of ACM Internet
Measurement Conference (IMC ’04), Taormina, Italy,
October 2004.
[28] N. Provos. A Virtual Honeypot Framework. In
Proceedings of the USENIX Security Symposium ’04,
San Diego, CA, August 2004.
[29] Y. Shavitt and E. Shir. DIMES: Let the Internet
Measure Itself. ACM SIGCOMM Computer
Communications Review, 35(5), October 2005.
[19] E. Katz-Bassett, J. John, A. Krishnamurthy,
[30] Y. Shavitt and T. Tankel. Hyperbolic Embedding of
D. Weatherall, T. Anderson, and Y. Chawathe.
Towards IP Geolocation Using Delay and Topology
Measurements. In Proceedings of ACM Internet
Measurement Conference (IMC ’06), Rio de Janerio,
Brazil, October 2006.
[20] B. Krishnamurthy and J. Wang. On Network-Aware
Clustering of Web Clients. In Proceedings of ACM
SIGCOMM ’00, Stockholm, Sweeden, August 2000.
[21] B. Lyon. The Opte Project. http://opte.org, January
2008.
[22] C. Faloutsos M. Faloutsos, P. Faloutsos. On
Power-Law Relationships of Internet Topology. In
Proceedings of ACM SIGCOMM ’99, Cambridge, MA,
August 1999.
[23] A.K. Jain M. Figueiredo. Unsupervised learning of
ﬁnite mixture models. IEEE Transaction on Pattern
Analysis and Machine Intelligence, 24:381–396, 2002.
Internet Graphs for Distance Estimation and Overlay
Construction. IEEE/ACM Transactions on
Networking, To Appear.
[31] N. Spring, R. Mahajan, and D. Wetherall. Measuring
ISP Topologies with Rocketfuel. In Proceedings of
ACM SIGCOMM ’02, Pittsburgh, PA, August 2002.
[32] N. Spring, D. Wetherall, and T. Anderson. Reverse
Engineering the Internet. In Proceedings of Hotnets-II,
Cambridge, MA, November 2003.
[33] L. Tang and M. Crovella. Virtual Landmarks for the
Internet. In Proceedings of ACM Internet
Measurement Conference (IMC ’03), Miami, FL,
October 2003.
[34] V. Yegneswaran, P. Barford, and D. Plonka. On the
Design and Use of Internet Sinks for Network Abuse
Monitoring. In Proceedings of Recent Advances on
Intrusion Detection (RAID ’04), Sophia, France,
September 2004.