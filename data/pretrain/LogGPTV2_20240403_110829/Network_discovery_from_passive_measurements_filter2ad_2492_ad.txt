### 6. The Missing Data Problem

In Section 5, we evaluated our methods for estimating shared infrastructure between IP sources using hop count distance values between all sources and measurement nodes. However, it is unlikely that packets from a large number of IP sources will be observed at a random set of widely distributed measurement nodes. Therefore, for a given set of measurement nodes (such as the honeypots described in Section 3), there will be some missing hop count distance observations. For each IP source \( i \), we have a (potentially incomplete) hop count vector \( h_i \), where \( I(i)_{\text{known}} \) is a known subset of the indices of the complete set of measurement nodes for IP source \( i \).

We assume that this data is Missing-at-Random (MAR), meaning the missing data locations are chosen at random. With certain assumptions about the network topology and statistical techniques, we have developed a method for imputing this missing data.

### 6.1 Imputation Methods

#### 6.1.1 Network-centric Imputation

Given missing data, simple imputation methods, such as imputing based on the mean value or using nearest neighbors, can be considered. However, these approaches do not take advantage of the structural characteristics of the network. As described in [8], we can exploit the observed hop count distances from sources that are an integer offset from a source with a missing hop count distance value. This method is analogous to using nearest-neighbor imputation on the hop count contrast vectors. For \( N \) sources and \( M \) measurement nodes in the network, this imputation method has a computational complexity of \( O(N^2M) \). In the following, we describe a new method for imputing missing data that improves on the prior, network-centric approach, especially when larger fractions of data are missing.

#### 6.1.2 Gaussian Mixture EM Imputation

In Section 4.2, we reasoned that a mixture of Gaussians model encapsulates the variability found in the hop count contrast vectors. In [14], a Gaussian mixture EM algorithm was used to impute missing data. 

The results of the new imputation method (Gaussian mixture EM) are compared in terms of Root Mean Squared Error (RMSE, Equation 6) in Figure 11 against a naive mean method. In this analysis, we consider measurements from sources observed in 16 honeypots for a synthetic topology with three different sizes (\( N = 1000, 2000, 3000 \)). The results show a clear advantage to using the Gaussian mixture imputation method, even with a small amount of observed measurements.

### 6.2 Shared Path Estimation with Imputed Data

Next, we assess how topology estimation is affected by using imputed data. Following the method from Section 5.2.2, the incomplete case derives clusters from imputed hop contrast vectors (using the Gaussian mixture imputation algorithm) and then performs active measurements on the clusters. The use of imputed hop contrast vectors introduces more uncertainty regarding the topological significance of the clusters.

To derive the estimated shared path length for using incomplete data, we follow the derivation from Section 5.2.3, replacing all occurrences of the complete hop count distance vectors \( h_i \) with the imputed hop count distance vectors \( \hat{h}_i \).

\[
\hat{P}(i, j, k) = \alpha \left( \frac{\hat{U}_{i,j,k}, k}{\hat{h}_{i,k}, \hat{h}_{j,k}} \right)
\]

### 6.3 Topology Estimation Performance with Imputed Data

Using synthetic topologies generated by Orbis, we assess the impact of missing data imputation on topology estimation. We generate three different synthetic topologies with 1000, 2000, and 3000 nodes. The measurement nodes are randomly chosen from the set of leaf nodes in the topology, with passive measurements simulated as the length of the shortest path found in the topology between the IP sources and the measurement nodes. After imputation, 10 clusters are found in the imputed hop count contrast vectors, resulting in an active probe budget of 20 active measurements per measurement node. Figure 12 shows that the estimation of shared paths using the predictive methodology from Section 5 is comparable to the cluster-level deterministic estimation method for a majority of missing data percentages. The RMSE error rate for the estimated path lengths is defined as:

\[
\text{RMSE}(\hat{P}) = \sqrt{\sum_{i,j,k} |P(i, j, k) - \hat{P}(i, j, k)|^2}
\]

When the simulated topology is expanded to 2000 and 3000 total nodes, the effects on the shared path estimation algorithms can be seen in Figures 13. As seen from the figures, the increase in graph size improves the estimation for both algorithms.

We also consider the impact of imputation using the Skitter dataset. We selected a subset of 700 leaf nodes as IP sources and randomly selected other leaf nodes as measurement nodes. Data representing passive measurements was derived from the graph, and the shared infrastructure was estimated for different levels of missing data. In Figure 14, we see the performance of the two shared path length estimation methods on the Skitter topology for \( M = 8, 16, 24 \) and 10 clusters found. In contrast to the results from the synthetic topologies, the predictive estimation method performs better than the cluster-level method. This can be explained by the fact that Skitter measurements typically only have a single leaf node for each branch of the topology, putting the cluster-level method at a disadvantage for estimating shared topology.

### 7. Conclusions and Future Work

In this paper, we address the problem of identifying network structure and topology through the use of passive measurements of IP packet traffic. While prior work on client clustering, shared path estimation, and router-level topology mapping has been based on information embedded in IP addresses or via active probes, passive measurements offer an opportunity to expand perspective and reduce traffic and management overhead. However, the minimal information (source IDs and hop counts) considered in our problem formulation presents serious challenges to identifying meaningful network structure. We describe a method for clustering hosts based on Gaussian mixtures of hop count vectors and demonstrate the trade-offs between cluster size and shared path length using a set of synthetic topologies. We then describe two topology estimation techniques that rely on a small set of active probe-based measurements. The first method establishes ground truth paths between clusters via active probes, and the second uses a predictive approach to estimate shared path lengths based on a topology framework established with active probes. The capabilities of both methods are evaluated using synthetic and empirical network maps. Finally, we describe an imputation method for estimating missing data in passive measurements and demonstrate the capabilities of this method using data collected in a set of network honeypots distributed around the Internet.

This study represents a first step toward our goal of accurately identifying Internet topology with passive measurements. There are several important next steps that we intend to address in future work. The first is to construct larger graphs of the Internet using datasets from honeynets [1] and other sources such as web servers that receive a great deal of traffic, and to validate these extensively with data sets from Internet mapping projects such as Skitter. We also plan to develop additional methods for enriching our graphs, for example, by coupling them with other data such as BGP routing information, and to consider how dynamic changes in hop counts can be accommodated in our formulations. Finally, we plan to consider problems related to measurement such as optimal monitor placement and the reduction or elimination of active measurements for shared topology estimation.

### Acknowledgments

The authors would like to thank Farnam Jahanian and Michael Bailey from the IMS project at the University of Michigan for providing the data used in this study. This work was supported in part by NSF grants CNS-0347252, CNS-0646256, CNS-0627102, and CCR-0355653. Any opinions, findings, conclusions, or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the NSF.