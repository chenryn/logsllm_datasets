longer protected. It is unclear if this is an oversight or expected operation.
We discovered two exceptional implementations: First, the Motorola MR2600
maintains a small subset of exposed open ports on its external interface even with
the ﬁrewall enabled. Second, the TP-Link AC1750 maintains an outdated version
of Dropbear SSH despite the public availability of a CVE describing a remote
code execution vulnerability [13]. It is notable that, of the routers that expose
ports in any ﬁrewall conﬁguration, there appear to be a common set of ports that
are open, but provide no banner. We hypothesize that these ports are associated
with common services that each router provides but does not enable by default,
though the ports remain open. For example, multiple routers advertise the ability
to set up local storage sharing, likely using SMB on port 445. Though we did not
exercise this functionality, the exposure of these ports suggests that if a client
were to enable these features they would also be accessible to the wider Internet
NATting Else Matters: Evaluating IPv6 Access Control Policies
383
over IPv6. The default states and mix of services available provide enough unique
scan data to individually identify the device manufacturer; six of the ten routers
we obtain have uniquely identifying features. As a result, we believe it may be
possible to ﬁngerprint routers through probing open IPv6 ports and services,
though we leave this to future work.
Table 2. Externally Exposed Services – This table lists the IPv6 services and open
TCP ports that are exposed by each device with the ﬁrewall either enabled or disabled
for the routers that support such an option. Ports in bold indicate that a service
responded with a banner. We document the services associated with the address from
the router’s external interface. Most routers have a separate address assigned to their
internal interface from their allocated subnet, though we ﬁnd that the exposed services
are typically the same between the two.
Device
Amazon Eero
AmpliFi Gamer’s Edition
Cisco DPC3941T XB3
Google Nest (2nd Gen)
Linksys EA3500
Linksys EA6350 AC1200
Motorola MR2600
Nighthawk X4 R7000
○
○
○
○
○
○
○␣
○
Default FW FW enabled
FW disabled
–
–
–
–
–
–
No disable option
–
–
No disable option
25, 53, 80, 135, 139,
443, 445, 2601,
1080, 10000
25, 53, 80, 135, 139,
443, 445, 2601,
1080, 10000
25, 135, 139, 445, 1080 25, 135, 139, 445,
Surfboard SBG10 DOCSIS 3.0 ○
TP-Link AC1750 v2
○␣
No enable option
–
–
1080
25, 43, 80, 135, 139,
443, 445, 548, 1080,
2601
25, 80, 135, 139,
443, 445, 1080
22, 25, 135, 139,
445,1080
To summarize, our work shows that there is little standardization among the
routers evaluated in this work around the security or operational functionality
provided for IPv6 CE networks. This is in direct contrast to IPv4 where devices
and services are not exposed. While NAT was not designed as a security frame-
work, the deny-all, permit by exception ingress policy serves as an invariant for
consumer routing devices and is noted as such within RFCs when debating the
default recommendations of CE routers [3,16,20]. We see this argument man-
ifest in the inconsistency between device implementations; the default policies
maintained by devices put real users and systems at risk.
384
K. Olson et al.
5 Discussion
The CE environment provides a unique challenge in balancing device capability
against user ability and need. This work demonstrates that the shift to IPv6
removes the consistency of one of its most crucial layers of defense: homogene-
ity in router operation. Without a safe default policy, consumers must rely on
the security of each of their endpoint devices, which can be diﬃcult to ensure,
especially in CE environments where device maintenance is not guaranteed. We
recognize that many of these problems are not caused by or unique to IPv6
consumer networks, but we note that unclear IPv6 implementation strategies
exacerbate these issues by oﬄoading responsibility for securing and conﬁguring
the network to consumers.
We see in our assessment a struggle to shape and deﬁne what exactly is
the right amount of control without under-oﬀering or overwhelming targeted
consumer demographics. This has left router manufacturers to determine what
are the correct abstractions and implementations, and how to communicate these
clearly to a wide demographic of users. Accordingly, we believe that addressing
the general inconsistency is the most direct path to securing CE networks in
IPv6.
5.1 Recommendations
There are multiple parties involved in CE environments each of which have
diﬀerent motivations and risk factors, but it is important that the design of CE
networks prioritizes the wholesale security of consumer data and devices. We
structure our recommendations around the following principles:
– The default operation mode should be secure, and the bulk of network con-
ﬁguration should be moved from consumers to developers.
– Conﬁguration options should be consistent and only as permissive as neces-
sary.
– Conﬁguration pitfalls should have conﬁrmation warnings that ensure users
understand the risks associated with the changes they are making (e.g. making
devices globally accessible).
– Documentation should share abstractions and language across manufacturers
and be as minimally complex as feasible.
It is important to present a clear, consistent threat model to consumers
whose ability and understanding often lags that of developers, to avoid oversight
on responsibility for securing devices connected to home networks. This is the
responsibility of both standardization bodies and the CE router industry as a
whole. We strongly recommend the following defaults:
NATting Else Matters: Evaluating IPv6 Access Control Policies
385
Standardization. We recommend that CE routers universally standardize around
a default ingress ﬁltering policy that denies incoming traﬃc. We further rec-
ommend manufacturers remove or restrict the “one-click open” option on CE
routers as home users are likely to unknowingly expose their whole network, vio-
lating the security principle of least privilege. If this is a required functionality,
routers should warn users (and/or suggest to use IPv6 pinholing) before allowing
them to use this option.
For manual exceptions we recommend that manufacturers implement both
device and IP based rules and develop a consistent vocabulary for describing
them. Providing users with the resources to understand when each option is
preferable will require that the language used to describe IPv6 conﬁguration
options is consistent across manufacturers.
Documentation. It is irrelevant what standards require if manufacturers ignore
them or if parties involved fail to understand their importance or the impor-
tance of their abstractions. Fostering consumer and developer understanding of
IPv6 security can create pressure on manufacturers to adhere to standards and
promote transparency ahead of purchase. Establishing consistent language and
abstractions for describing the security mechanisms of IPv6 networks is the ﬁrst
step.
Currently manufacturers of customer edge routers highlight IPv6 as an
enhanced feature in their product marketing, though we found no instance of edu-
cating users about IPv6 or describing its security implications. Instead, phrases
such as “provides inﬁnite addresses for more devices”, “best possible experience”,
and “simpliﬁes the router’s tasks” are oﬀered as slogans to encourage user com-
mitment [11,12]. These approaches are problematic. This hides a transparent
shift in the security model of home networks that consumers cannot be expected
to inherently understand on their own.
Morgner et al.present one possible solution of oﬀering device label standards
similar to nutrition labels on food [14]. Here, the authors focused on manu-
facturer guarantees for duration of product support and timeliness of updates
in a standardized label. We argue to take this concept further with a holistic
approach to additional aspects of security such as default conﬁguration, control
mechanisms, and 3rd party certiﬁcations. Requirements for labelling standards
incentivize manufacturers to provide and document security features necessary
for consumers to have a functional understanding of their network posture at
purchase.
386
K. Olson et al.
5.2 Future Work
While this work discusses at length the “One-Click Open” option, we have not
conducted a formal user experience study to conﬁrm that users will rely on
this option to achieve simple routing changes in their IPv6 networks as a ﬁrst
choice. A proper study of the UX/UI design involved in home network security
would be informative and could provide developers with a better understanding
of consumer needs and approaches to IPv6 security.
While we use this work to gauge the scope of current security policies of
IPv6 CE routers, a large scale examination of router IPv6 ﬁrewall behavior is
required to better understand the breadth of the impact that the transition from
IPv4 to IPv6 has on CE routing. Speciﬁcally, a tool assisting clients to better
understand the defaults that their network implements could prove a strong
contribution towards this result. Similar large scale studies of IoT and smart
devices operating in IPv6 environments are reserved for future eﬀorts as well.
6 Conclusion
In IPv4 networks, the use of NAT aﬀorded a ubiquitous, de facto default-deny
security posture. The growing deployment of IPv6, which eliminates address
scarcity, no longer requires NAT. In the absence of strong guidance for how router
manufacturers should implement ﬁltering, we examined a diverse set of routers to
measure real-world implementations. We ﬁnd that the access control models and
controls implemented to manage these networks are coarse and contain unsafe
defaults that likely expose devices on the network – often without warning to
the consumer. The result is a systemic, demonstrable failure among all parties
to agree upon, implement and communicate consistent security policies. While
IPv6 brings important advances to the Internet, signiﬁcant eﬀort by academia
and industry is needed to help address and solve access control issues in the
home, including adequately communicating information about these postures to
consumers.
7 Appendix
NATting Else Matters: Evaluating IPv6 Access Control Policies
387
n
a
m
o
r
f
t
s
o
h
l
a
n
r
e
t
n
i
n
a
n
o
s
t
r
o
p
P
C
T
0
0
0
1
n
o
m
m
o
c
t
s
o
m
e
h
t
n
a
c
s
o
t
p
a
m
N
e
s
u
e
W
–
)
P
C
T
(
s
e
i
c
i
l
o
p
s
s
e
r
g
n
i
l
l
a
w
e
r
i
F
.
3
.
g
i
F
t
e
k
c
a
p
e
h
t
s
p
o
r
d
l
l
a
w
e
r
ﬁ
e
h
t
f
i
,
y
l
e
s
r
e
v
n
o
C
.
Y
E
R
G
t
r
o
p
d
e
t
a
i
c
o
s
s
a
e
h
t
k
r
a
m
e
w
s
e
v
i
e
c
e
r
t
s
o
h
e
h
t
t
e
k
c
a
p
h
c
a
e
r
o
F
.
t
n
i
o
p
e
g
a
t
n
a
v
l
a
n
r
e
t
x
e
l
a
n
o
i
t
p
o
n
a
e
v
a
h
t
a
h
t
s
r
e
t
u
o
r
r
o
F
.
K
C
A
L
B
d
e
k
r
a
m
s
i
t
r
o
p
d
e
t
a
i
c
o
s
s
a
e
h
t
e
r
u
l
i
a
f
k
r
o
w
t
e
n
o
t
e
u
d
t
s
o
h
e
h
t
h
c
a
e
r
o
t
s
l
i
a
f
t
e
k
c
a
p
e
h
t
r
o
.
W
F
o
N
r
o
W
F
y
b
d
e
t
a
c
i
d
n
i
s
e
t
a
t
s
h
t
o
b
n
i
n
a
c
s
a
e
d
u
l
c
n
i
e
w
l
l
a
w
e
r
ﬁ
388
K. Olson et al.
References
1. Amazon.com. Amazon Sales Popularity - Computer Routers (2020). https://web.
archive.org/web/20201023233343/www.amazon.com/gp/bestsellers/pc/300189/
ref=zg b bs 300189 1. Accessed 23 Oct 2020
2. Antonakakis, M., et al.: Understanding the Mirai botnet. In: USENIX - 26th Secu-
rity Symposium, pp. 1093–1110 (2017)
3. Chown, T., Arkko, J., Brandt, A., Troan, O., Weil, J.: IPv6 home networking
architecture principles. RFC 7368, Internet Engineering Task Force (October 2014)
4. Frontier Communications: Frontier home Internet setup guide (2020). https://
frontier.com/∼/media/HelpCenter/Documents/internet/installation-setup/hsi-
self-install-guide.ashx?la=en. Accessed 18 Oct 2020
5. Czyz, J., Luckie, M., Allman, M., Bailey, M.: Don’t forget to lock the back door!
A characterization of IPv6 network security policy. In: Proceedings of the 23rd
Annual Network and Distributed System Security Symposium (NDSS 2016), San
Diego, California, USA (February 2016)
6. De Leon, N.: Many wireless routers lack basic security protections, consumer
reports’ testing ﬁnds (2019). https://www.consumerreports.org/wireless-routers/
wireless-routers-lack-basic-security-protections. Accessed 20 Oct 2020
7. Open Connectivity Foundation: UPnP+ Speciﬁcation (2020). https://openconn
ectivity.org/developer/speciﬁcations/upnp-resources/upnp/#upnp-plus. Accessed
18 Oct 2020
8. Hain, T.: Architectural implications of NAT. RFC 2993, Internet Engineering Task
Force (November 2000)
9. Kolias, C., Kambourakis, G., Stavrou, A., Voas, J.: DDoS in the IoT: Mirai and
other botnets. IEEE Comput. 50(7), 80–84 (2017)
10. Kumar, D., et al.: All things considered: an analysis of IoT devices on home net-
works. In: USENIX - 28th Security Symposium, pp. 1169–1185 (2019)
11. Linksys: Diﬀerences between IPv4 and IPv6 (2020). https://www.linksys.com/us/
support-article/?articleNum=139604. Accessed 18 June 2020
12. Microsoft. Support: IPv6 on Xbox one (2020). https://support.xbox.com/help/
Hardware-Network/connect-network/ipv6-on-xbox-one. Accessed 18 June 2020
13. MITRE: CVE-2016-7406
(September
2016). https://cve.mitre.org/cgi-bin/
cvename.cgi?name=CVE-2016-7406. Accessed 20 Oct 2020
14. Morgner, P., Mai, C., Koschate-Fischer, N., Freiling, F., Benenson, Z.: Security
update labels: establishing economic incentives for security patching of IoT con-
sumer products. arXiv:1906.11094 (2019)
15. Ubiquiti Networks. FAQ: does AmpliFi have a ﬁrewall? (2020). https://help.
ampliﬁ.com/hc/en-us/articles/115009611867-Does-AmpliFi-have-a-ﬁrewall-.
Accessed 18 Oct 2020
16. Singh, H., Beebee, W., Donley, C., Stark, B.: Basic requirements for IPv6 customer
edge routers. RFC 7084, Internet Engineering Task Force (November 2013)
17. Tripwire: SOHO wireless router (In)Security (2014). http://www.properaccess.
com/docs/Tripwire SOHO Router Insecurity white paper.pdf. Accessed 20 Oct
2020
18. Van de Velde, G., Hain, T., Droms, R., Carpenter, B., Klein, E.: Local network
protection for IPv6. RFC 4864, Internet Engineering Task Force (May 2007)
19. Wing, D., Cheshire, S., Boucadair, M., Penno, R., Selkirk, P.: Port control protocol
(PCP). RFC 6887, Internet Engineering Task Force (April 2013)
NATting Else Matters: Evaluating IPv6 Access Control Policies
389
20. Woodyatt, J. (ed.): Recommended Simple Security Capabilities in Customer
Premises Equipment (CPE) for Providing Residential IPv6 Internet Service. RFC
6092, Internet Engineering Task Force (January 2011)
21. Zhang, L.: A retrospective view of network address translation. IEEE Netw. 22(5),
8–12 (2008)