• What time did the triggering problem start and when did it stop?
• Which queue did not trigger, and which channel or processs should have been started?
About this task
If the triggering problem is happening right now, or if you are able to reproduce it, you can generate data
to provide more information about the problem.
After collecting the troubleshooting information, you can send it to IBM.
IBM MQ troubleshooting and support 345
Procedure
1.Generate a trace of the queue manager when the triggering problem occurs:
• “Tracing on AIX and Linux” on page 376
• “Tracing on Windows” on page 391
• “Tracing on IBM i” on page 381
2.Collect the IBM MQ data.
You can do this either automatically or manually:
• Collect the data automatically by using the runmqras command as described in “Collecting
troubleshooting information automatically with runmqras” on page 303 to collect the data for both
sides of the channel. Be sure to collect the runmqras defs and trace sections, and to specify
your case number as shown in the following example:
runmqras -section defs,trace -qmlist QMA -caseno TS001234567
• Alternatively, collect the data manually as described in “Collecting troubleshooting information
manually” on page 306.
3.Send the information that you have collected to IBM.
A good description of the problem and the data is the most important information you can provide to
IBM. Do not send data without providing a description!
For FTP and email instructions, see Exchanging information with IBM Software Support.
To open or update a case, go to the IBM My Support site.
Note: Always update your case to indicate that data was sent.
If you need to speak with IBM Software Support, contact your country representative. If you need to
speak with IBM Software Support in the US, you can call 1-800-IBM-SERV.
Related tasks
“Troubleshooting message problems” on page 177
Collecting troubleshooting information on z/OS
An overview of how to collect troubleshooting information for IBM MQ for z/OS.
About this task
Note: In addition to the information described in this section, IBM Support might request further
information on a case by case basis.
Procedure
• For information on how to collect troubleshooting and diagnostic information for a specific problem
area for IBM MQ for z/OS, see the following topics:
– ABEND
– Advanced Message Security (AMS)
– Client Connections
– CICS adapter
– CICS bridge
– Channels
– Clusters
346 Troubleshooting and Support for IBM MQ
– Data conversion
– Databases
– Dead-letter queue messages
– Error messages
– IBM WebSphere MQ File Transfer Edition (FTE): see Managed File Transfer (MFT)
– Hang and high CPU
– IBM MQ Explorer
– IMS
– Install and uninstall
– Java and JMS
– Performance
– Publish/subscribe
– Security
– Shared channels
– Shared queues
– Shutdown problems
– Startup problems
– TLS channels (formerly SSL)
– Triggering channels
– Triggering programs
• For all other problems, see Collect troubleshooting data for a general, or unknown problem in
WebSphere MQ for z/OS.
Related tasks
“Collecting troubleshooting information on Multiplatforms” on page 302
An overview of how to collect troubleshooting information for IBM MQ on Multiplatforms.
Collecting information for abend problems on z/OS
If you need assistance from IBM Support to resolve an abend problem on IBM MQ for z/OS, you first need
to collect troubleshooting information to send to IBM Support to help find a solution.
Procedure
1.Collect the following general information:
• IBM MQ version, release, and maintenance level
• Operating system version, release, and maintenance level
• Related products version, and release levels if applicable
2.Collect the following troubleshooting (MustGather) information for this problem:
a)Collect the following required information:
Job logs
You can find the IBM MQ for z/OS job logs in the Syslog, MSTR job log, and CHIN job log. The
job logs are named xxxxMSTR and xxxxCHIN, where xxxx is the IBM MQ subsystem identifier
(SSID). For more information, see Creating a print data set containing the JES2 joblog for the
IBM MQ for z/OS jobs.
Dumps generated at point of failure
IBM MQ dumps are located in a system dump data set (see Step “4” on page 348).
b)Optionally also collect the z/OS LOGREC report (see “SYS1.LOGREC information on z/OS” on page
286).
IBM MQ troubleshooting and support 347
3.Search the IBM Support site for known problems.
You can search by using symptoms like the message number and error codes.
4.Review the dumps generated at point of failure.
IBM MQ dumps are located in a system dump data set and can be identified by their title. The title for a
dump requested by IBM MQ starts with the four-character subsystem name of the queue manager. For
example:
CSQ1,ABN=5C6-00E20016,U=SYSOPR ,C=MQ900.910.DMC
-CSQIALLC,M=CSQGFRCV,LOC=CSQSLD1 .CSQSVSTK+00000712
The dump title might provide sufficient information in the abend and reason codes to resolve the
problem. For more information, see “Analyzing the dump and interpreting dump titles on z/OS” on
page 283.
For more information about the two system abend completion codes X'5C6' and X'6C6' that IBM MQ
for z/OS uses, see “IBM MQ for z/OS abends” on page 250. You can also search for known problems at
the IBM support site by using abend codes, reason codes, and program names listed in the dump.
5.Check the system log (syslog).
Comm dumps might not contain the queue manager name, depending on the comment specified in the
dump command. Check the syslog for an IEA611I or IEA911E message to determine the dump data
set name and also to see whether the dump is complete or partial. For example:
IEA611I COMPLETE DUMP ON DUMP.MQT1MSTR.DMP00074
DUMPID=074 REQUESTED BY JOB(MQT1MSTR)
FOR ASID(005E)
IEA911E PARTIAL DUMP ON SYS1.MCEVS4.DMP00039
DUMPID=039 REQUESTED BY JOB(DMSGTODI)
FOR ASID(00D2)
If insufficient disk space is the reason for the problem, there might not be sufficient information in the
dump to diagnose the problem.
Dumps might be suppressed by Dump Analysis and Elimination (DAE). In this case, some symptoms
might not appear in the system log (syslog) or joblog, but they appear in Logrec (see “SYS1.LOGREC
information on z/OS” on page 286). For more information about management of DAE, see Generating a
suppressed dump.
6.Send the information that you have collected to IBM.
A good description of the problem and the data is the most important information you can provide to
IBM. Do not send data without providing a description!
For FTP and email instructions, see Exchanging information with IBM Software Support.
To open or update a case, go to the IBM My Support site.
Note: Always update your case to indicate that data was sent.
If you need to speak with IBM Software Support, contact your country representative. If you need to
speak with IBM Software Support in the US, you can call 1-800-IBM-SERV.
Collecting information for AMS problems on z/OS
If you need assistance from IBM Support to resolve a problem with Advanced Message Security (AMS) on
IBM MQ for z/OS, you first need to collect troubleshooting information to send to IBM Support to help find
a solution.
Before you begin
Before you start this task, answer the following initial questions about the problem:
• What AMS error did you observe on the system?
• What is the detailed AMS message flow?
348 Troubleshooting and Support for IBM MQ
• What time did the AMS problem start and when did it stop?
• Which specific users or applications and queue manager queues are involved?
• What IBM MQ security policy is being used, and what files is AMS using?
Provide details on how the AMS files are set up.
Procedure
1.For configuration problems, gather:
• A RACF listing of \drq.ams.keyring - for each application user involved, for example, put
and get applications
• RACDCERT ID(user ID) LISTRING(drq.ams.keyring)
• A RACF listing of \drq.ams.keyring
• RACDCERT ID(CSQ1AMSM) LISTRING(drq.ams.keyring) - replace CSQ1 with the name of your
queue manager
• CSQ0UTIL list of policies :
– dspmqspl -m "CSQ1" - replace CSQ1 with the name of your queue manager
– dspmqspl -m "CSQ1" -p "PROBLEMQ" - replace CSQ1 with the name of your queue manager and
PROBLEMQ with the name of your queue
2.For issues to do with AMS server-to-server Message Channel Agent interception, gather channel
definitions and display the output.
3.For other errors and/or abend failures, additionally gather:
• Dumps of the queue manager, channel initiator, AMSM, and putting/getting application address
spaces.
See “IBM MQ for z/OS dumps” on page 267 for more information.
• Job logs for the queue manager, channel initiator, AMSM address space, and putting/getting
application jobs (as applicable).
• AMS (and/or IBM MQ) internal trace.
See “Tracing on z/OS” on page 395 for more information.
• AMS debug trace (written to SYSOUT of the AMSM address space or to the putting/getting
application job logs).
See step “4” on page 349 for information on how you capture an AMS trace.
• GSKit trace.
See step “5” on page 349 for information on how you capture a GSKit trace.
4.Capture an AMS trace.
For more information, see “Enabling internal trace for the AMSM address space” on page 406.
5.Capture a GSKit trace on your system to help you diagnose problems with keystores and certificates.
For more information, see “Using GSKit trace for problems related to certificates and keys when using
AMS on z/OS” on page 407.
Related tasks
“Troubleshooting AMS problems” on page 67
IBM MQ troubleshooting and support 349
Troubleshooting information to help you identify and resolve problems relating to Advanced Message
Security (AMS).
Collecting information for shared queue problems on z/OS
If you need assistance from IBM Support to resolve a shared queue problem on IBM MQ for z/OS, you first
need to collect troubleshooting information to send to IBM Support to help find a solution.
Before you begin
Before you start this task, answer the following questions about the problem:
• What is the name of the shared queue having a problem?
• What is the name of the IBM MQ Coupling Facility structure(CFSTRUCT) associated with the problematic
shared queue?
• What is the message id associated with the problem?
• What is the name of the queue sharing group?
• What time did the problem occur?
• Which queue manager in the queue sharing group is involved?
About this task
If you can reproduce the shared queue problem or the problem is happening right now, you can generate
data to provide more information about the problem.
After collecting the troubleshooting information, you can send it to IBM.
Procedure
1.Generate the following traces while the problem is happening:
a.Generate a GTF trace.
b.Generate a MSTR internal trace.
c.Generate a CHIN trace.
2.Collect the data.
The following steps include an example of dumping both application structure and the IBM MQ
Administration structure.
a)Record the version, release, and maintenance levels your software:
• IBM MQ: find the version in the CSQY000I message in the MSTR job log.
• The z/OS operating system: find the version in the output of /D IPLINFO in SDSF.
• Any other products involved with the problem: look for the version in the job log for the product.
b)Collect the IBM MQ MSTR and CHIN joblogs and, optionally, collect the syslog.
c)Collect a z/OS LOGREC report.
For more information, see “SYS1.LOGREC information on z/OS” on page 286.
d)Save any z/OS dumps that you generated from IBM MQ.
IBM MQ dumps are located in a system dump data set and can be identified by their title. The
title for a dump requested by IBM MQ starts with the four-character subsystem name of the queue
manager. For example:
CSQ1,ABN=5C6-00E20016,U=SYSOPR ,C=MQ900.910.DMC
-CSQIALLC,M=CSQGFRCV,LOC=CSQSLD1 .CSQSVSTK+00000712
350 Troubleshooting and Support for IBM MQ
Comm dumps might not contain the queue manager name, depending on the comment specified in
the dump command. Check the syslog for an IEA611I or IEA911E message to determine the dump
data set name and also to see whether the dump is complete or partial. For example:
IEA611I COMPLETE DUMP ON DUMP.MQT1MSTR.DMP00074
DUMPID=074 REQUESTED BY JOB(MQT1MSTR)
FOR ASID(005E)
IEA911E PARTIAL DUMP ON SYS1.MCEVS4.DMP00039
DUMPID=039 REQUESTED BY JOB(DMSGTODI)
FOR ASID(00D2)
e)Collect Coupling Facility Structure dumps for the application Structure and the IBM MQ
Administration Structure:
/DUMP COMM=(title)
/R nnn,SDATA=(ALLNUC,LPA,PSA,RGN,SQA,TRT,CSA,XESDATA,COUPLE,GRSQ),CONT
/R nnn,JOBNAME=(ssidMSTR),CONT
/R nnn,STRLIST=(STRNAME=QSGnameStructurename,(LISTNUM=ALL,
ADJUNCT=CAPTURE,ENTRYDATA=UNSER),EVENTQS,(EMCONTROLS=ALL),
/R nnn,STRNAME=QSGnameCSQ_ADMIN,(LISTNUM=ALL,ADJUNCT=CAPTURE,
ENTRYDATA=UNSER),EVENTQS,(EMCONTROLS=ALL)),END
where ssid is the subsystem ID for the queue manager.
An example of QSGnameStructurename is QSG1APPLICATION where QSG1 is the queue sharing
group name.
An example of QSGnameCSQ_ADMIN is QSG1CSQ_ADMIN.
The following example shows dumping the application structure solely:
/DUMP COMM=(title)
/R xx,STRLIST=(STRNAME=QSGnameStructurename,(LISTNUM=ALL,
ADJUNCT=CAPTURE,ENTRYDATA=UNSER),EVENTQS,(EMCONTROLS=ALL))
An example of QSGnameStructurename is QSG1APPLICATION where QSG1 is the queue sharing
group name.
3.Send the information that you have collected to IBM.
A good description of the problem and the data is the most important information you can provide to
IBM. Do not send data without providing a description!
For FTP and email instructions, see Exchanging information with IBM Software Support.
To open or update a case, go to the IBM My Support site.
Note: Always update your case to indicate that data was sent.
If you need to speak with IBM Software Support, contact your country representative. If you need to
speak with IBM Software Support in the US, you can call 1-800-IBM-SERV.
Collecting information for performance problems on z/OS
If you need assistance from IBM Support to resolve a performance problem on IBM MQ for z/OS, you first
need to collect troubleshooting information to send to IBM Support to help find a solution.
Before you begin
Before you start this task, answer the following questions about the problem:
• What effect is the problem having, for instance high CPU or response delays?
• When did the problem first occur?
• Was software or hardware maintenance applied?
• Is the problem a one time failure or reoccurring?
• What are the names of the queue managers, queues, channels, or other jobs involved in the problem?
IBM MQ troubleshooting and support 351
• Have you reviewed the information in Troubleshooting MQ performance problems.
About this task
The IBM Software Support Handbook states that analyzing performance is one of the activities that often
require some form of Advance Support Offering. If analysis reveals a suspected defect in the product and
you can reproduce the performance problem or the problem is happening right now, you can generate
data to provide more information about the problem so that the IBM MQ Support team can diagnose your
problem.
After collecting the troubleshooting information, you can send it to IBM.
Procedure
1.If you can reproduce the performance problem or the problem is happening right now, generate data
to provide more information about the problem:
a.Generate a GTF trace while the problem is happening.
b.Generate a MSTR internal trace and capture it in a dump while the problem is happening.
c.Generate a CHIN trace and capture it in the same dump with the MSTR trace while the problem is
happening.
d.If the network performance is in question, generate a z/OS TCP/IP packet trace and an MQ CHIN
trace simultaneously at the other end of the channel while the problem is happening.
2.Collect the data.
a)Record the version, release, and maintenance levels your software:
• IBM MQ: find the version in the CSQY000I message in the MSTR job log.
• The z/OS operating system: find the version in the output of /D IPLINFO in SDSF.
• Any other products involved with the problem: look for the version in the job log for the product.
b)Collect the IBM MQ MSTR and CHIN joblogs and, optionally, collect the syslog.
c)Collect the z/OS dump that you generated when collecting the traces.
d)Collect a z/OS LOGREC report.