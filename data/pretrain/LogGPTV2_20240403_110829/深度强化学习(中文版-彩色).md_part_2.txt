廖培元 目前本科就读于卡内基·梅隆大学计算机科学学院。研究方向主要涉及表示学习和多模
态机器学习。曾贡献过开源项目 mmdetection 和 PyTorch Cluster，在 Kaggle 数据科学社区曾获
CompetitionsGrandmaster称号，最高排名全球前25位。
读者服务
微信扫码回复：41188
• 获取本书参考链接
• 加入“人工智能”读者交流群，与更多读者互动
• 获取各种共享文档、线上直播、技术分享等免费资源
• 获取博文视点学院在线课程、电子书20元代金券
X
致 谢
首先，我们感谢我国对人工智能事业的大力支持和对开源建设的关注，感谢前辈们的指导，
这鼓励了我们更加大胆地尝试、创新与实践。我们也非常感谢开源用户源源不断地向我们提供反
馈，为我们不断前进提供了方向。
在此，我们特别感谢在本书写作过程中为我们提供建议的朋友们，包括：来自Mila的付杰，
帝国理工学院的王剑红和刘世昆，北京大学的陈坤，加州大学圣地亚哥分校的宋萌，阿尔伯塔大
学的马辰、肖晨骏、梅劲骋、王琰和杨斌，三星研究院的于桐，复旦大学的罗旭，休斯敦大学的
史典，上海交通大学的张卫鹏，乔治亚理工学院的康亚舒，华东师范大学的赵晨萧，弗雷德里希
米歇尔研究所的刘天霖，BorealisAI的丁伟光，小红书的苏睿龙，启元世界的彭鹏，清华大学的
周仕佶、常恒、陈泽铭、毛忆南、袁新杰、叶佳辉，以及中科院自动化所的裴郢郡、张清扬、胡金
城。我们也感谢耶鲁大学的JaredSharp帮助本书英文版本的语言检查，感谢林嘉媛的封面设计。
此外，很多开源社区的贡献者对本书的代码库做出了贡献，包括北京大学的吴睿海和吴润迪、
鹏城实验室的赖铖、爱丁堡大学的麦络、帝国理工的李国、英伟达的JonathanDekhtiar等，他们
为维护TensorLayer和强化学习实例库做了很多工作。
董豪特别感谢北京大学前沿计算研究中心和深圳鹏城实验室对TensorLayer的开发维护，以
及探索下一代AI开源软件的支持。感谢广东省重点领域研发计划资助（编号2019B121204008）、
北大新聘学术人员科启（编号7100602564）和人工智能算法研究（编号7100602567）项目的经
费支持。特别感谢郭毅可院士对他研究生和博士工作的指导。
丁子涵特别感谢帝国理工学院EdwardJohns教授对他硕士研究生工作的指导。
仉尚航特别感谢加州大学伯克利分校KurtKeutzer教授和TrevorDarrell教授对她博士后研究
工作的指导，卡内基·梅隆大学JoséM.F.Moura教授对她博士研究工作的指导，北京大学高文
教授和解晓东教授对她研究生工作的指导，以及清华大学朱文武教授的指导与合作。
XI
前导知识
自从1946年第一台真正意义上的计算机发明以来，人们一直致力于建造更加智能的计算机。
随着算力的提高和数据的增长，人工智能（ArtificialIntelligence，AI）获得了空前的发展，在一
些任务上的表现甚至已经超越人类，比如围棋、象棋，以及一些疾病诊断和电子游戏等。人工智
能技术还能被广泛用于其他应用中，比如药物发现、天气预测、材料设计、推荐系统、机器感知
与控制、自动驾驶、人脸识别、语音识别和对话系统。
近十年来，很多国家，比如中国、英国、美国、日本、德国，对人工智能进行了大量的投入。
与此同时，还有很多科技巨头，比如Google、Facebook、Microsoft、Apple、百度、华为、腾讯、字
节跳动和阿里巴巴等，也都积极地参与其中。人工智能在我们的日常生活中正变得无处不在，如
自动驾驶汽车、人脸ID和聊天机器人。毫无疑问，人工智能对人类社会的发展至关重要。
在我们深入阅读本书之前，第一步应该先了解人工智能领域不同的子领域，如机器学习（Ma-
chineLearning，ML）、深度学习（DeepLearning，DL）、强化学习（ReinforcementLearning，RL），
以及本书的主题——深度强化学习（DeepReinforcementLearning，DRL）。图1用韦恩图（Venn
Diagram）展示了它们之间的关系，下面将会逐一介绍它们。
人工智能
虽然科学家一直以来都在努力让计算机变得越来越智能，但是“智能”的定义直到今天依
然是非常模糊的。在这个问题上，Alan Turing 最早在他 1950 年曼城大学时的文章 Computing
MachineryandIntelligence中介绍了图灵测试（TuringTest）。图灵测试可以用来衡量机器模拟人
类行为的能力大小。具体来说，它描述了一个“imitationgame”，一个质问者向一个人和一台计
算机提出一系列问题，用以判断哪个是人，哪个是机器。当且仅当质问者不能分辨出人和机器时，
图灵测试就通过了。
人工智能的概念最早是由JohnMcCarthy在1956年夏天的达特茅斯（Dartmouth）会议上提
出的。这次会议被认为是人工智能正式进入计算机科学领域的开端。最早期的人工智能算法主要
用于解决可以被数学符号和逻辑规则公式化的问题。
XII
前导知识
人工智能
Artificial Intelligence
机器学习
Machine Learning
深度学习
Deep Learning
深度强化学习
Deep Reinforcement Learning
强化学习
Reinforcement Learning
图1 人工智能、机器学习、深度学习、强化学习及深度强化学习之间的关系
机器学习
机器学习（MachineLearning，ML）的概念和名字是由ArthurSamuel（BellLabs,IBM,Stanford）
在1959年首次提出来的。一个人工智能系统需要具备从原始数据中学习知识的能力，这个能力
就称为机器学习。很多人工智能问题可以被这样解决：通过设计有针对性的模式识别算法来从原
始数据中提取有效特征，然后用机器学习算法使用这些特征。
比如，在早期的人脸识别算法中，我们需要特殊的人脸特征提取算法。最简单的方法就是使
用主成分分析（PrincipalComponentAnalysis，PCA）降低数据的维度，然后把低维度特征输入一
个分类器获得结果。长期以来，人脸识别需要纯手工设计的特征工程算法。针对不同问题设计特
征提取算法的过程非常耗时，而且在很多任务中设计有针对性的特征提取算法的难度非常大。比
如，语言翻译的特征提取需要语法的知识，这需要很多语言学专家帮助。然而，一个通用的算法
应该具备从对不同任务自行学习出特征提取算法，以大大降低算法开发过程中所需的人力的先验
知识。
学术界有很多研究，使得机器学习能自动学习数据的表征。表征学习的智能化不仅可以提升
性能，还能降低解决人工智能问题的成本。
深度学习
深度学习是机器学习中的一个子领域，与其他算法不同，它主要基于人工神经网络（Artificial
NeuralNetwork，ANN）(Goodfellowetal.,2016)来实现。我们之所以称它为神经网络，是因为它
是由生物神经网络启发设计的。WarrenSturgisMcCulloch和WalterPitts在1943年共同发表的A
LogicalCalculusoftheIdeasImmanentinNervousActivity(McCullochetal.,1943)被视为人工神经
XIII
前导知识
网络的开端。至此，人工神经网络作为一种全自动特征学习器，使得我们不需要对不同数据开发
特定的特征提取算法，从而大大提高了开发算法的效率。
深度神经网络（DeepNeuralNetwork，DNN）是人工神经网络的“深度”版本，有很多的神
经网络层，深层的网络相比浅层的网络具有更强的数据表达能力。图2展示了深度学习方法与非
深度学习方法的主要区别。深度学习方法让开发者不再需要针对特定数据来设计纯手工的特征提
取算法。我们因此也称这些学习算法为端到端（End-to-end）方法。但值得注意的是，很多人质
疑，深度学习方法是一个黑盒子（Black-box），我们并不知道它是如何学到数据特征表达的，往
往缺乏透明性和可解析性。
数据 特征工程 学习算法 结果
数据 深度学习算法 结果
图2 深度学习方法与非深度学习方法的区别
虽然现在看来，深度学习非常流行，但是在人工神经网络早期发展阶段，受制于当时计算机
算力和黑盒子问题，实际应用很少，并未受到学术界的广泛关注。
这种情况直到2012年才得到了改变，当年一个叫Alexnet(Krizhevskyetal.,2012)的模型在
ImageNet图像分类竞赛(Russakovskyetal.,2015)中取得了超过其他方法10%以上的性能。从此，
深度学习开始受到越来越多的关注，深度学习方法开始在很多不同领域超越非深度学习方法，比
如大家熟悉的计算机视觉(Girshick,2015;Johnsonetal.,2016;Ledigetal.,2017;Pathaketal.,2016;
Vinyalsetal.,2016)和自然语言处理(Bahdanauetal.,2015)。
强化学习
深度学习虽然具有了很强大的数据表达能力，但不足以建立一个智能的人工智能系统。这是
因为人工智能系统不仅需要从给定的数据中学习，而且还要像人类那样学习与真实世界交互。强
化学习作为机器学习的一个分支，即可让计算机与环境进行交互学习。
简单来说，强化学习把世界分为两个部分：环境（Environment）与智能体（Agent）。智能体
通过执行动作（Action）来与环境交互，并获得环境的反馈。在强化学习中，环境的反馈是以奖
励（Reward）形式体现的。智能体学习如何“更好”地与环境交互，以尽可能获得更大的奖励。
这个学习过程建立了环境与智能体间的环路，通过强化学习算法来提升智能体的能力。
XIV
参考文献
深度强化学习
深度强化学习结合了深度学习和强化学习各自的优点来建立人工智能系统，主要在强化学习
中使用深度神经网络的强大数据表达能力，例如价值函数（ValueFunction）可以用神经网络来近
似，以实现端到端的优化学习。
DeepMind是一家成立于伦敦、以科研为主导的人工智能技术公司，在深度强化学习历史上
具有非常重要的地位。2013年，仅在AlexNet提出一年以后，他们就发表了论文PlayingAtariwith
DeepReinforcementLearning，该文基于电子游戏的原始画面作为输入，学习了7种游戏。DeepMind
的方法不需要手工设计特征提取算法，在 6 个游戏中优于之前的方法，甚至在 1 个游戏中赢了
人类。
2017年，DeepMind的AlphaGO围棋算法在中国打败了世界第一围棋大师——柯洁。该事件
标志着人工智能具备比人类更好表现的潜力。深度强化学习是机器学习的一个子领域，具有实现
通用人工智能（ArtificialGeneralIntelligence，AGI）的潜力。但是还有很多的挑战需要我们解决，
才能真正地实现这个理想的目标。
TensorLayer
强化学习的算法很多，而且从学习算法到实现算法有一定的距离。因此，本书中很多章节会
有实现教学，我们会展示一些算法中的关键部分是如何实现的。自从深度学习变得流行以来，出
现了很多开源的框架，比如TensorFlow、Chainer、Theano和PyTorch等，以支持神经网络的自动
优化。在本书中，我们选择TensorLayer，一个为科研人员和专业工程师设计的深度学习与强化学
习库。该库获得了ACMMultimedia2017年度最佳开源软件奖。在本书定稿时，TensorLayer2.0
支持TensorFlow2.0作为后端计算引擎，而在下一版本中，TensorLayer将会支持更多的其他计算
引擎，如华为MindSpore，以更好地支持国内外的AI训练芯片。更多关于TensorLayer的最新信
息，请访问GitHub页面1。
参考文献
BAHDANAUD,CHOK,BENGIOY,2015. Neuralmachinetranslationbyjointlylearningtoalignand
translate[C]//ProceedingsoftheInternationalConferenceonLearningRepresentations(ICLR).
GIRSHICK R, 2015. Fast R-CNN[C]//Proceedings of the IEEE International Conference on Computer
Vision(ICCV). 1440-1448.
GOODFELLOWI,BENGIOY,COURVILLEA,2016. Deeplearning[M]. MITPress.
1链接见读者服务
XV
前导知识
JOHNSON J, ALAHI A, FEI-FEI L, 2016. Perceptual Losses for Real-Time Style Transfer and Super-
Resolution[C]//ProceedingsoftheEuropeanConferenceonComputerVision(ECCV).
KRIZHEVSKYA,SUTSKEVERI,HINTONGE,2012.Imagenetclassificationwithdeepconvolutional
neural networks[C]//Proceedings of the Neural Information Processing Systems (Advances in Neural
InformationProcessingSystems). 1097-1105.
LEDIG C, THEIS L, HUSZAR F, et al., 2017. Photo-Realistic Single Image Super-Resolution Using
aGenerativeAdversarialNetwork[C]//ProceedingsoftheIEEEConferenceonComputerVisionand
PatternRecognition(CVPR).
MCCULLOCHWS,PITTSW,1943. Alogicalcalculusoftheideas immanentinnervousactivity[J].
Thebulletinofmathematicalbiophysics,5(4): 115-133.
PATHAK D, KRAHENBUHL P, DONAHUE J, et al., 2016. Context encoders: Feature learning by
inpainting[C]//Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition
(CVPR). 2536-2544.
RUSSAKOVSKYO,DENGJ,SUH,etal.,2015.ImagenetLargeScaleVisualRecognitionChallenge[J].
InternationalJournalofComputerVision(IJCV),115(3): 211-252.
VINYALS O, TOSHEV A, BENGIO S, et al., 2016. Show and tell: Lessons learned from the 2015
mscocoimagecaptioningchallenge[J].IEEETransactionsonPatternAnalysisandMachineIntelligence
(PAMI).
XVI
数学符号
本书尽可能地减少了和数学相关的内容，以帮助读者更加直观地理解深度强化学习。本书的
数学符号约定如下。
基础符号
x scalar，标量
x vector，向量
X matrix，矩阵
R thesetofrealnumbers，实数集
dy derivativeofywithrespecttox，标量的导数
dx
∂y partialderivativeofywithrespecttox，标量的偏导数
∂x