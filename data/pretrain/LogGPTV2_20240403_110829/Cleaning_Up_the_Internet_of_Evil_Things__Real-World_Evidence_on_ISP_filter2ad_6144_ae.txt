communication is cheaper and improves the incentives of
ISPs for cleanup, it seems that the rate of seeking help is
related to action on the side of the customers. As we saw in
Section V-A, the remediation rate of the email-only group was
indistinguishable from the control group. The walled garden
groups did take action and this is also associated with more
communication with the ISP.
Table VII: Communication channel used by customers in
different groups
Experimental group
Email-only
Walled garden (improved)
Walled garden (standard)
n
40
40
97
email
contact form
helpdesk
16 (40.0%)
23 (57.5%)
67 (69.1%)
–
31 (77.5%)
59 (60.8%)
3 ( 7.5%)
21 (52.5%)
44 (45.4%)
Next, we read a sample of about 20% of messages in each
category and created labels for recurring themes. We then read
all messages and manually labeled each one as to whether a
certain theme was present in it or not. Table VIII presents the
results aggregated over all customers, i.e., whether a theme
was present in one of the messages of a customer. The general
pattern conﬁrms what we found during the phone interviews.
Some issues are more salient, though. In the walled garden
treatments, about one in three customers states that they have
run an anti-virus scanner on their PC to remediate the problem.
This underlines, even more than the phone interviews, that a
signiﬁcant portion of affected population does not understand
the basic properties of IoT malware, even when they have
actually seen and read the notiﬁcation. We found a weak
correlation with remediation: customers who mention running
anti-virus remediated more slowly. Around 60% was clean
after ﬁve days, whereas 60% of the other customers was clean
within little more than one day. That being said, both groups
reached 90% remediation in two weeks.
While a signiﬁcant portion of the users is working from
an incorrect mental model (‘folk theory’ [34]) of the problem,
they do seem to be able to remediate in the end. Of the 51
customers that mentioned running a virus scanner, 23 also
mentioned disconnecting a device. Proportionally, this rate is
actually a bit higher than for the people who did not mention
running anti-virus. Overall, around 40% of the customers in the
walled garden groups mention that they disconnected a device,
compared to just 7.5% for those who received the email-only
notiﬁcation.
In the improved walled garden group, dissatisfaction or
frustration is substantially lower than in the standard walled
garden group. We are not sure how to explain this. It might
be that the improved message is more helpful. We should
note, however, that the improved walled garden notiﬁcations
were issued several months later in time than the standard
notiﬁcations. By that
time, more people might have seen
11
reports in the media about IoT compromise and they might
thus be more accepting of the need to take countermeasures.
Table VIII: Themes of user experience in communication with
the ISP
Email-only Walled garden
(improved)
n=40
12 (30.0%)
17 (42.5%)
8 (20.0%)
2 (5.0%)
4 (10.0%)
15 (37.5%)
4 (10.0%)
n=40
7 (17.5%)
9 (22.5%)
2 ( 5.0%)
0 ( 0.0%)
0 ( 0.0%)
3 ( 7.5%)
0 (0%)
Walled garden
(standard)
n=97
32 (33.0%)
58 (59.8%)
41 (42.3%)
16 (16.5%)
11 (11.3%)
42 (43.3%)
18 (18.6%)
0 (0%)
0 (0%)
1 (2.5%)
13 (13.4%)
1 (2.5%)
5 (5.2%)
Runs a virus scanner
Identiﬁes IoT device
Requests additional help
Wants possibility to call
the abuse team
Requests paid technician
Disconnects device
Cannot work due to
quarantine
Complaints over
disruption of service
Threatens to terminate
contract
All in all, the customer experience data helps us to make
sense of the high remediation rates for the walled garden
groups. While users might not grasp the technical foundations
of the infection, as signaled by running AV on a PC in their
network, they still end up taking effective action. Disconnect-
ing devices is an intuitive countermeasure, after all, even if it
is also costly on the side of the customer – in the sense of not
being able to use the device.
It
is tempting to speculate about how these customer
responses might help explain the remarkably low reinfection
rate of the the standard walled garden group (see Section V-E).
One might reason, for example, that these users either keep
the devices disconnected over a longer period or that they
reconnect them differently than before, leaving them no longer
exposed to the public Internet. Another explanation is that
they factory reset their router, which for certain models means
closing open ports and disabling the DMZ and uPnP. This
leaves the user in a less vulnerable state.
though,
In the end,
these speculations seem somewhat
beside the point. Remember, even the control group had a
low reinfection rate, in the sense that most of the customers
in that group were not seen again for at least 21 days after
their initial infection disappeared (see Section V). Whatever
the explanation is for this result, it could very well also explain
the bulk of the low reinfection rates in the other groups in the
study, rather than intentional remediation actions on the side
of the users in those groups. For now, we are stuck with a
mystery that future work will have to resolve.
VII. RELATED WORK
In this section, we brieﬂy review three related areas of
work. We survey studies on botnet mitigation by ISPs, efﬁcacy
of abuse notiﬁcations and end user security behavior.
Botnet mitigation by ISPs: Various studies have looked
into the role of ISPs in the ﬁght against botnets mitigation
and remediation. Most notably, [3] empirically conﬁrmed the
point that ISPs are indeed critical control points for botnet
mitigation and that infection levels are very different across
ISPs, even when they operate in the same country and market,
demonstrating they have leeway to act. Work on Conﬁcker
cleanup [2] found no clear impact of national initiatives to
mitigate botnets.
12
Additionally, industry groups and international organiza-
tions have published ISP best practices that explain how
to contact and clean up infected customer’s machines. RFC
6561 describes various methods that can be used by ISPs to
notify end users about a security problem [21]. Some of the
described methods include postal mail, email, phone or walled
garden notiﬁcations. On the other hand, the effectiveness of
the methods is not discussed in detail. A report outlined by
M3AAWG identiﬁes best practices for walled garden notiﬁca-
tion. However, ITUs Anti-Botnet Toolkit raised potential issues
that may result from ISP notiﬁcations [17].
In an earlier study, C¸ etin et al. investigated the usability of
walled garden notiﬁcations [6]. This study mainly focused on
regular malware infections of PCs while presenting a simple
comparison on remediation rates per malware type which also
includes Mirai. This study was purely observational and as
such the authors could not measure the effectiveness of walled
garden notiﬁcations, but instead analyzed users’ behavior while
in quarantine. Nevertheless, the authors reported overall reme-
diation rates as observed for the whole system which cannot
be solely attributed to the effect of the walled garden. Authors
found that were roughly over 85% of Mirai-infected machines
were cleaned after 2 weeks period, which is a bit
lower
than both standard and improved walled garden notiﬁcations
for Mirai-infected customers observed in the current study.
On the contrary, we focused on analyzing the actual impact
of the walled garden by designing an experiment with a
control group which allowed us to estimate the efﬁcacy of
the walled garden notiﬁcations on their own. Moreover, our
study is speciﬁc to Mirai-infected devices which allowed us
to customize the content of the notiﬁcations with IoT-speciﬁc
cleanup instructions.
Efﬁcacy of abuse and vulnerability notiﬁcations: A large
body of research focuses on efﬁcacy of email notiﬁcations on
large scale vulnerability notiﬁcations. For instance, Li et al.
issued various types of notiﬁcations to CERTs and operators
of networks [19]. They concluded that detailed notiﬁcations
to operators made the highest impact. On the other hand,
their results suggested that overall vulnerability remediation
was marginal, even with detailed notiﬁcations to operators.
Similar to this work, Stock et al. studied the feasibility of
large-scale vulnerability notiﬁcation and found that notiﬁed
parties achieved higher remediation rates than the ones that
received no notiﬁcations [28]. Additionally, in another study
on large scale Cetin et al. demonstrated the poor deliverability
of email-based notiﬁcations and proposed searching for other
mechanisms to deliver notiﬁcations [7]. Stock et al. evaluated
the effectiveness of other mechanisms to delivery vulnerability
information such as postal mail, social media, and phone and
reported slightly higher remediation rates for these mecha-
nisms [27]. On the other hand, they stated that slightly higher
remediation do not justify their costs and additional work put
into issuing them. Majority of these studies used email to reach
affected parties. Because it scales reasonably well. Conversely,
many emails bounced before even reaching the affected parties.
Moreover, the ones that reached often triggered no follow-up
actions.
Another series of studies explored the efﬁcacy of email
notiﬁcations on abuse remediation. These notiﬁcations are
sent to the affected owners of the site or to their hosting
provider. Li et al. assess the inﬂuence of abuse notiﬁcations for
761, 935 infected websites detected by Google Safe Browsing
and Search Quality [20]. Direct notiﬁcations to webmasters
increased the likelihood of cleanup by over 50%. Vasek et
al. found that verbose notiﬁcations to webmasters and hosting
providers were the most effective [32]. Cetin et al. studied the
effect of reputation of the sender of the abuse notiﬁcation on
cleanup rates. While notiﬁcations in general improved cleanup,
there was no observable effect of the sender reputation [8].
Results of these website cleanup studies indicate a much
lower remediation rate than that observed in this study. This
could be partly because of Mirai’s non-persistent nature.
End user security behavior: A large body of work has
studied the challenges of end users in obtaining and following
security advice. A study on end user perceptions on automated
software updates concluded that most users do not correctly
understand the automatic update settings on their computer and
thus cannot manage to update as they intend to [33]. Fagan et
al. [13] investigated user motivations regarding their decisions
on following common security advice. They reported that the
majority of users follow the usability/security trade-off. Forget
et al. collected data on users’ behavior and their machine
conﬁgurations and highlighted the importance of content,
presentation, and functionality of security notiﬁcations pro-
vided to users who have different expertise, expectations, and
computer security engagement [15]. This work demonstrated
the importance of effective communication between customers
and the ISP. This can help to ensure a better understanding of
the notiﬁcations and a higher rate of remediation.
VIII. ETHICAL CONSIDERATIONS
This study leveraged passively collected datasets and a
small number of active scans that were carried out following
the guidelines of the Menlo report [4]. All raw data and statis-
tics generated during the study were anonymized, and only the
partner ISP’s employees knew what customer corresponded
to which infection. We always followed the policies of the
ISP and notiﬁed all the infected subscribers accordingly. We
only added the experimental design of random assignment and
the observation in abuse feed and darknet data of the infected
devices. The latter is not regarded as human subject research
by our IRB and thus out of scope. For the purpose of the
experiment, the customers in the control group received the
notiﬁcation with a delay of 14 days. Moreover, during the
phone interviews, interviewees were provided with an opt-out
option. Throughout the interview process, only 20 interviewees
asked to be excluded from the interviews.
IX. LIMITATIONS
Our study faces three key limitations. First, detecting and
tracking infections is difﬁcult. No method detects all infected
machines and when tracking a detected infection there will
also be missing observations complicating inferences about
cleanup. The former issue is less of a problem for our study, as
our design is not based on capturing all infections. The latter
issue we mitigated by adopting a very conservative approach
in measuring cleanup. If we saw the same customer again
within 21 days after the experiment, we would assume they
were not cleaned up, irrespective of the missing observations
in between. This gives us a lower-bound estimate of cleanup.
Second, the external validity of this research project is open
to discussion. On the one hand, the study is conducted in a real-
world setting within normal business processes. In addition,
the ISP is the second largest in the country and has several
million broadband customers. They represent a wide variety
of people in terms of demographics. Therefore, we have no
reason to assume that our ﬁndings are particular to this ISP.
On the other hand, it is impossible to know to what extent a
walled garden mechanism at another ISP would get the same
results until follow-up experiments are conducted.
Last, the dynamic nature of malware limits the generaliz-
ability of our ﬁndings. Our results are based on Mirai. During
the study period, new Mirai versions and other IoT malware
families were still non-persistent. This greatly increases natural
cleanup via rebooting of devices and it also facilitates cleanup
by end users. As IoT malware becomes more sophisticated,
it seems a matter of time before they are able to establish a
more permanent foothold on the device. Indeed, a recent study
reported the ﬁrst persistent IoT malware [5]. We expect this
to cause lower remediation rates.
X. CONCLUSION
We have presented the ﬁrst empirical study on the cleanup
of IoT malware in the wild. We found that quarantining and no-
tifying infected customers via a walled garden remediates 92%
of the infections within 14 days. Email-only notiﬁcations have
no observable impact. We also found high natural remediation
rates and low reinfection rates. We have no good explanation
for the low reinfection rate, though we are quite conﬁdent the
result itself is correct. While quarantining infected devices is