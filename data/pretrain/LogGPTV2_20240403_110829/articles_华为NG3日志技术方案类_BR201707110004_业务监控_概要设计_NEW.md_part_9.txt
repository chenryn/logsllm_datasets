|           |           |      | 。平台扩展信息需  |                 |
|           |           |      | 要包含如下信息：\ |                 |
|           |           |      | 1、               |                 |
|           |           |      | 跟踪              |                 |
|           |           |      | 任务ID，格式为：  |                 |
|           |           |      | TaskID=\*\*\*\*\  |                 |
|           |           |      | 如包含多个跟踪任  |                 |
|           |           |      | 务ID，每个跟踪任  |                 |
|           |           |      | 务ID都以单独的名  |                 |
|           |           |      | 值对输出，输出格  |                 |
|           |           |      | 式为：TaskID=ID1, |                 |
|           |           |      | TaskID=ID2,       |                 |
|           |           |      | TaskID=ID3\       |                 |
|           |           |      | 2、               |                 |
|           |           |      | Tra               |                 |
|           |           |      | ceFlag，格式为：T |                 |
|           |           |      | raceFlag=\*\*\*\* |                 |
|           |           |      | (取值为二进制数)\ |                 |
|           |           |      | 3、               |                 |
|           |           |      | 调用链            |                 |
|           |           |      | 组标识GroupID，BE |                 |
|           |           |      | S中对应为业务交易 |                 |
|           |           |      | 流水号，格式为：  |                 |
|           |           |      | GroupID=\*\*\*\*\ |                 |
|           |           |      | 4、               |                 |
|           |           |      | 调用链            |                 |
|           |           |      | 组名称GroupName， |                 |
|           |           |      | BES中对应为业务交 |                 |
|           |           |      | 易类型名，即Entr  |                 |
|           |           |      | yMenu，格式为：Gr |                 |
|           |           |      | oupName=\*\*\*\*\ |                 |
|           |           |      | 5、               |                 |
|           |           |      | 调用链子          |                 |
|           |           |      | 组标识SubGroupID  |                 |
|           |           |      | ，BES中对应为步骤 |                 |
|           |           |      | 标识，格式为：Su  |                 |
|           |           |      | bGroupID=\*\*\*\* |                 |
+-----------+-----------+------+-------------------+-----------------+
| C         | varchar   | 可选 | 可读文本格式的码  | 填空            |
| odeStream | (max      |      | 流（非二进制码流  |                 |
|           | 10240)    |      | ）输出，仅针对与  |                 |
|           |           |      | 门户中设置的特定  |                 |
|           |           |      | 用户号码匹配（跟  |                 |
|           |           |      | 踪匹配标志hasComp |                 |
|           |           |      | aredTrace为true） |                 |
|           |           |      | 的调用请求和响应  |                 |
|           |           |      | ，以及业务返回码  |                 |
|           |           |      | 异常的调用响应。  |                 |
|           |           |      | 不需要打印码流时  |                 |
|           |           |      | ，该字段可为空。  |                 |
+-----------+-----------+------+-------------------+-----------------+
# 报表设计
不涉及
## XXX统计表的设计或变更
不涉及
### 报表样张
### 程序逻辑
#### 数据库
#### ETL
#### BRIO
### 相关变更
# 数据库设计
## 新增库表
### 业务流水关系日志表(CS_REC_FORMNUMRELALOG)
系统归属：节点CRM
数据库用户：NGCRM_YY
数据描述：
+--------------+-------+-------------+------+-----+-----------------+
| **表名**     | C     |             | **表 | 业  |                 |
|              | S_REC |             | 中文 | 务  |                 |
|              | _FORM |             | 名** | 流  |                 |
|              | NUMRE |             |      | 水  |                 |
|              | LALOG |             |      | 关  |                 |
|              |       |             |      | 系  |                 |
|              |       |             |      | 日  |                 |
|              |       |             |      | 志  |                 |
|              |       |             |      | 表  |                 |
+==============+=======+=============+======+=====+=================+
| **字段名**   | **字  | *           | **   | *   | **变更内容**    |
|              | 段中  | *数据类型** | 是否 | *主 |                 |
|              | 文名  |             | 允许 | 键  |                 |
|              | 称**  |             | 空** | **  |                 |
+--------------+-------+-------------+------+-----+-----------------+
| FORMNUM      | 业    | V           | NOT  | PK  | 业务受理流水号  |
|              | 务流  | ARCHAR2(32) | NULL |     |                 |
|              | 水号  |             |      |     |                 |
+--------------+-------+-------------+------+-----+-----------------+
| RELAFORMNUM  | 关    | V           | NOT  | PK  | 业务关联流水号  |
|              | 联流  | ARCHAR2(32) | NULL |     |                 |
|              | 水号  |             |      |     |                 |
+--------------+-------+-------------+------+-----+-----------------+
| RELATYPE     | 关联  | NUMBER(1)   | NOT  |     | 关              |
|              | 类型  |             | NULL |     | 联类型，枚举值: |
|              |       |             |      |     |                 |
|              |       |             |      |     | 1:业务订        |
|              |       |             |      |     | 单关联交易流水  |
|              |       |             |      |     |                 |
|              |       |             |      |     | 2:信控请        |
|              |       |             |      |     | 求关联交易流水  |
+--------------+-------+-------------+------+-----+-----------------+
| INTIME       | 生成  | DATE        | NOT  |     | 关系生成时间    |
|              | 时间  |             | NULL |     | ，默认系统时间  |
+--------------+-------+-------------+------+-----+-----------------+
SQL脚本：
*\--主键：*
alter table NGCRM_YY.CS_REC_FORMNUMRELALOG
add constraint PK_CS_REC_FORMNUMRELALOG primary key (FORMNUM,
RELAFORMNUM)
tablespace YY_OM_IND;
### ~~业务调用链日志信息表(CFG_DATA_BUSITRACEINFO)~~
~~系统归属：业务配置平台~~
~~数据库用户：YWPZ_BCP~~
~~数据描述：~~
+-----------+---------+-----------+-------+----+--------------------+
| **~       | ~~CFG   |           | **~   | ~~ |                    |
| ~表名~~** | _DATA_B |           | ~表中 | 业 |                    |
|           | USITRAC |           | 文名  | 务 |                    |
|           | EINFO~~ |           | ~~**  | 调 |                    |
|           |         |           |       | 用 |                    |
|           |         |           |       | 链 |                    |
|           |         |           |       | 日 |                    |
|           |         |           |       | 志 |                    |
|           |         |           |       | 信 |                    |
|           |         |           |       | 息 |                    |
|           |         |           |       | 表 |                    |
|           |         |           |       | ~~ |                    |
+===========+=========+===========+=======+====+====================+
| **~~字    | *       | **~~数据  | *     | ** | **~~变更内容~~**   |
| 段名~~**  | *~~字段 | 类型~~**  | *~~是 | ~~ |                    |
|           | 中文名  |           | 否允  | 主 |                    |
|           | 称~~**  |           | 许空  | 键 |                    |
|           |         |           | ~~**  | ~~ |                    |
|           |         |           |       | ** |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~        | ~       | ~~VARCH   | ~~NOT | ~  | ~~业务受理时       |
| TRACEID~~ | ~交易流 | AR2(32)~~ | N     | ~I | 生成的交易流水号~~ |
|           | 水号~~  |           | ULL~~ | ND |                    |
|           |         |           |       | EX |                    |
|           |         |           |       | ~~ |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~SEQNO~~ | ~~调用  | ~~VARCH   | ~~N   |    | ~~服务调用序列号， |
|           | 序号~~  | AR2(32)~~ | ULL~~ |    | 格式如1.1，1.1.1~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~CALLIN  | ~~调    | ~~VARCH   | ~~N   |    | ~~调用者实例标识   |
| GNODEID~~ | 用者服  | AR2(32)~~ | ULL~~ |    | ，如ZJNG3CRM-WAS~~ |
|           | 务实例  |           |       |    |                    |
|           | 标识~~  |           |       |    |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~CA      | ~~调    | ~~VARCH   | ~~N   |    | ~~调用者服务IP地址 |
| LLINGIP~~ | 用者服  | AR2(16)~~ | ULL~~ |    | ，如192.168.1.1~~  |
|           | 务IP~~  |           |       |    |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~CALLE   | ~~被    | ~~VARCH   | ~~N   |    | ~~被               |
| DNODEID~~ | 调用服  | AR2(32)~~ | ULL~~ |    | 调用服务实例标识， |
|           | 务实例  |           |       |    | 如ZJNG3CRM-CICS~~  |
|           | 标识~~  |           |       |    |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~C       | ~~被    | ~~VARCH   | ~~N   |    | ~~被调用服务IP地址 |
| ALLEDIP~~ | 调用服  | AR2(16)~~ | ULL~~ |    | ，如192.168.1.1~~  |
|           | 务IP~~  |           |       |    |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~FLAG~~  | ~~请    | ~~VARCH   | ~~N   |    | ~~请求             |
|           | 求响应  | AR2(16)~~ | ULL~~ |    | 发送：clientSend\  |
|           | 标识~~  |           |       |    | 请求               |
|           |         |           |       |    | 接收：serverRecv~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~响应             |
|           |         |           |       |    | 发送：serverSend\  |
|           |         |           |       |    | 响应               |
|           |         |           |       |    | 接收：clientRecv~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~举例：~~         |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~A服务调          |
|           |         |           |       |    | 用B服务时，A服务打 |
|           |         |           |       |    | 印的两条日志为：~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~请求             |
|           |         |           |       |    | 发送：clientSend~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~响应             |
|           |         |           |       |    | 接收：clientRecv~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~B服              |
|           |         |           |       |    | 务的两条日志为：~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~请求             |
|           |         |           |       |    | 接收：serverRecv~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~响应             |
|           |         |           |       |    | 发送：serverSend~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~         | ~~调    | ~~VARCH   | ~~N   |    | ~~CRM WEB调用CRM   |
| ~METHOD~~ | 用方法  | AR2(64)~~ | ULL~~ |    | WAS服务            |
|           | 名称~~  |           |       |    | 填写调用方法名；~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~CRM WAS调用CRM   |
|           |         |           |       |    | CICS服务填         |
|           |         |           |       |    | 写调用的opcode；~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~CRM CICS调用BOSS |
|           |         |           |       |    | CICS服务填         |
|           |         |           |       |    | 写账务接口标识；~~ |
|           |         |           |       |    |                    |
|           |         |           |       |    | ~~工单             |
|           |         |           |       |    | 发送填写工单标识~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~PROG    | ~~应用  | ~~VARCH   | ~~N   |    | ~~应用名           |
| RAMNAME~~ | 名称~~  | AR2(32)~~ | ULL~~ |    | 称，如ngcustcare.  |
|           |         |           |       |    | war、liborder.so~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~BE      | ~~请求  | ~~VARCH   | ~~N   |    | ~~服务请求时间     |
| GINTIME~~ | 时间~~  | AR2(20)~~ | ULL~~ |    | ，精确到毫秒，格式 |
|           |         |           |       |    | YYMMDDHHMMSS.sss~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~        | ~~响应  | ~~VARCH   | ~~N   |    | ~~服务响应时间     |
| ENDTIME~~ | 时间~~  | AR2(20)~~ | ULL~~ |    | ，精确到毫秒，格式 |
|           |         |           |       |    | YYMMDDHHMMSS.sss~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~        | ~~消息  | ~~NUM     | ~~N   |    | ~~请求响应         |
| MSGSIZE~~ | 大小~~  | BER(14)~~ | ULL~~ |    | 消息大小，单位KB~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~RES     | ~~返    | ~~VARC    | ~~N   |    | ~~请求返回         |
| ULTCODE~~ | 回码~~  | HAR2(8)~~ | ULL~~ |    | 码，成功0，失败1~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~RES     | ~~返回  | ~~VARCHAR | ~~N   |    | ~~返回信息，失     |
| ULTINFO~~ | 信息~~  | 2(1024)~~ | ULL~~ |    | 败时返回失败信息~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~~EXT     | ~~请    | ~~VARCHAR | ~~N   |    | ~~业               |
| ENDINFO~~ | 求扩展  | 2(2048)~~ | ULL~~ |    | 务扩展信息，如操作 |
|           | 信息~~  |           |       |    | 员、业务类型、受理 |
|           |         |           |       |    | 渠道、菜单ID、订单 |
|           |         |           |       |    | 号、服务号码等等~~ |
+-----------+---------+-----------+-------+----+--------------------+
| ~         | ~~入库  | ~~DATE~~  | ~~NOT |    | ~~日志入库时       |
| ~INITME~~ | 时间~~  |           | N     |    | 间，默认系统时间~~ |
|           |         |           | ULL~~ |    |                    |
+-----------+---------+-----------+-------+----+--------------------+
| ~~STATE~~ | ~~日    | ~~NU      | ~~NOT |    | ~~日志             |
|           | 志分析  | MBER(1)~~ | N     |    | 分析状态，枚举:~~  |