# G0074: Dragonfly 2.0

## Description
[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) is a suspected Russian threat group that has targeted government entities and multiple U.S. critical infrastructure sectors since at least March 2016. (Citation: US-CERT TA18-074A) (Citation: Symantec Dragonfly Sept 2017) There is ongoing debate regarding the overlap between [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) and [Dragonfly](https://attack.mitre.org/groups/G0035). However, sufficient evidence exists to warrant tracking them as separate groups. (Citation: Fortune Dragonfly 2.0 Sept 2017)

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Windows, Office 365 | Collection | [Email Collection](https://attack.mitre.org/techniques/T1114/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) accessed email accounts using Outlook Web Access. | Office 365 trace logs, Mail server, Email gateway, Authentication logs, File monitoring, Process monitoring, Network usage by processes |
| Windows, Linux, macOS, SaaS | Initial Access | [Drive-by Compromise](https://attack.mitre.org/techniques/T1189/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised legitimate organizations' websites to create watering holes for victim compromise. | Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection |
| Windows | Execution, Persistence, Privilege Escalation | [Scheduled Task](https://attack.mitre.org/techniques/T1053/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used scheduled tasks to automatically log out of created accounts every 8 hours and to execute malicious files. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows | Defense Evasion, Execution | [Scripting](https://attack.mitre.org/techniques/T1064/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various scripting languages, including Python and batch scripts, to perform operations. The group was observed installing Python 2.7 on a victim. | Process monitoring, File monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion | [File Deletion](https://attack.mitre.org/techniques/T1107/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) deleted many of its files used during operations, including removing applications and deleting screenshots. | File monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | Defense Evasion | [Masquerading](https://attack.mitre.org/techniques/T1036/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts disguised as legitimate backup and service accounts, as well as an email administration account. | File monitoring, Process monitoring, Binary file metadata |
| Linux, macOS, Windows, Office 365, Azure AD | Discovery | [Permission Groups Discovery](https://attack.mitre.org/techniques/T1069/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate administrators in the environment. | Azure activity logs, Office 365 account logs, API monitoring, Process monitoring, Process command-line parameters |
| Windows | Defense Evasion | [Template Injection](https://attack.mitre.org/techniques/T1221/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187). | Anti-virus, Email gateway, Network intrusion detection system, Web logs |
| Linux, macOS, Windows | Execution | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used command-line interfaces for execution. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure AD, Azure, Office 365 | Persistence | [Create Account](https://attack.mitre.org/techniques/T1136/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts on victims, including administrator accounts, some of which were tailored to each individual staging target. | Office 365 account logs, Azure activity logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters, Authentication logs, Windows event logs |
| Windows, macOS, Linux, Office 365, SaaS | Initial Access | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Windows | Execution | [PowerShell](https://attack.mitre.org/techniques/T1086/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used PowerShell scripts for execution. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Windows, Linux, macOS | Credential Access | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump and CrackMapExec, tools that can dump password hashes. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Linux, macOS, Windows, GCP, Azure, AWS | Discovery | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) likely obtained a list of hosts in the victim environment. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |
| macOS, Windows, AWS, GCP, Azure | Discovery | [Network Share Discovery](https://attack.mitre.org/techniques/T1135/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) identified and browsed file servers in the victim network, sometimes viewing files related to ICS or SCADA systems. | Process monitoring, Process command-line parameters, Network protocol analysis, Process use of network |
| Linux, macOS, Windows | Collection | [Screen Capture](https://attack.mitre.org/techniques/T1113/) | [Dragonfly 2.0](https://attack.mitre.org/groups/G0074) performed screen captures of victims, including using a tool, scr.exe (which matched the hash of ScreenUtil). | API monitoring, Process monitoring, File monitoring |

This revised version enhances clarity, coherence, and professionalism, making it easier to understand the activities and techniques employed by Dragonfly 2.0.