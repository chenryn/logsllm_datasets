this is higher than the ω = 1 random walk algorithm
which achieves a top-10 probability of 0.05 with 10
malicious nodes. Also, the random walk based protocols
present a signiﬁcant improvement over the broadcast pro-
tocol which achieves a top-10 probability of 0.85 with
10 malicious nodes.
C. Network Topology
In this section we evaluate the sensitivity of timing
analysis attacks to the network topology. We show that
a triangulation based timing analysis attack remains ef-
fective on a broadcast protocol even when part of the
network topology is unknown (or incorrectly known) to
the adversary. We also study the scalability of caller
identiﬁcation attacks on various route set up protocols.
Topology Discovery. Figure 22 shows the top-10 proba-
bility using different route set up protocols when only a
fraction of the network topology has been discovered
by the adversary. If the adversary’s view of the net-
work topology is not connected, then we simply use
the ﬁrst connected component that receives the route set
up request for the attack. From ﬁgures 14 and 22, we
observe that in a broadcast based route set up protocol,
using m = 20 and ttl = 2 improves top-10 probabil-
ity to 0.72. Hence, even with an incomplete knowledge
of the network topology, the attacker can successfully
launch caller identiﬁcation attacks on a broadcast based
route set up protocol. The top-10 probability for the
controlled random walk and multi-agent random walk
are considerably lower at 0.08 and 0.05 respectively.
The random walk based protocols are more sensitive to
topology knowledge and are thus more resilient to caller
identiﬁcation attacks. Using the multi-agent random walk
protocol, the top-10 probability is 42% below that of
complete topology knowledge; while the numbers for
controlled random walk and the broadcast protocol are
about 33% and 9% respectively.
Network Churn. Figure 23 shows the efﬁcacy of caller
identiﬁcation attacks as the network churn increases for
m = 10 malicious nodes. For instance, churn = 0.1
represents the fact that about 10% of the proxy nodes
have joined and left the network since the last discovery
phase. We observe that for the broadcast protocol, the
attack efﬁcacy drops by less than 15% when 5-10% of
the topology has changed since the last crawl. In contrast,
for the random walk based protocols, the attack efﬁcacy
drops by 40% when 5-10% of the topology changes.
Given that the average lifetime of a VoIP proxy is 10.5
hours [34], one can show that the average time required
for 10% churn is one hour. More time allows a stealthy
attack wherein the adversary does not frequently ﬂood
the network with topology discovery (ping) messages.
Network Size. Figure 24 shows the number of malicious
node required to achieve a top-10 probability of 0.1 as
the VoIP network size increases (x-axis is in log scale);
broadcast nearly coincides with the x-axis. Experi-
ments on topologies whose size was larger than 1024
nodes were performed using a discrete event simulation;
the results obtained from our discrete event simulator
were within 5% of that of NS-2 for topologies of size
up to 1024 nodes. We observe the number of malicious
nodes required for an attack grows very slowly with the
size of the network for the broadcast based route set
up protocol. For instance, using a 10,000 node network
topology, the attacker could achieve top-10 probability
of 0.1 with just 25 malicious nodes using the broadcast
protocol; while it required 400 nodes in the case of con-
trolled random walk protocol and 1200 nodes in the case
of multi-agent random walk. This clearly demonstrates
the ability of random walk based protocols to limit the
scalability of caller identiﬁcation attacks.
VI. RELATED WORK
Several low latency anonymizing networks have been
studied in the literature [12], [17], [8]. Anonymizing
networks protect the identity of the sender and receiver
using the concept of a mix [10], [28]. Onion routing
[17] and its second generation Tor [12] aim at providing
anonymous transport of TCP ﬂows over the Internet. Tor
supports on-demand route set up, but it is not QoS sen-
sitive. ISDN mixes [23] propose solutions to anonymize
61
’broadcast’
’crw’
’marw’
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
y
t
i
l
i
b
a
b
o
r
p
0
1
-
p
o
t
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
y
t
i
l
i
b
a
b
o
r
P
0
1
-
p
o
t
’broadcast’
’crw’
’marw’
’broadcast’
’crw’
’marw’
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
s
e
d
o
N
s
u
o
c
i
i
l
a
M
f
o
r
e
b
m
u
N
 0
 0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
 1
 0
 0
Fraction of Topology Discovered
 0.05
 0.1
 0.15
 0.2
Topology Churn
 0
 100
 1000
VoIP Network Size
 10000
Fig. 22. Partial Topology
Fig. 23. Network Churn
Fig. 24. Scalability
phone calls over traditional PSTN (Public Switched Tele-
phone Networks).
It is widely acknowledged that low latency anonymiz-
ing networks are vulnerable to timing analysis attacks
[30], especially from well placed malicious attackers [35].
Several papers have addressed the problem of tracing en-
crypted trafﬁc using timing analysis [33], [36], [38], [32],
[9], [13], [31]. All these papers use inter-packet timing
characteristics for tracing trafﬁc. The timing character-
istic may be obtained either by passively observing the
trafﬁc or by actively embedding a timing signature in the
trafﬁc. Our approach differs from the above approaches
in several ways. We do not rely on inter-packet timing
characteristics in the data transfer phase. Our approach
speciﬁcally targets QoS sensitive route set up protocols.
Our timing analysis attack is closer to RF localization
techniques that break source location privacy in sensor
networks [18], [20]. Phantom routing [20] also proposes
the use of random-walk based protocols to mitigate lo-
calization attacks in sensor networks.
Some authors have suggested that the VoIP network
can be doubled to act as an anonymizing network [31].
However, the notion of setting up a circuit or a route
on a VoIP network is different from that on state of art
anonymizing networks in the following respects. First, a
random route on an anonymizing network may not meet
latency-based QoS requirements. Hence, VoIP uses route
set up protocols that identify the shortest route from a
caller to a receiver. Second, routes (or circuits) in a VoIP
network are not constructed a priori. VoIP supports client
mobility by allowing a client to connect to any node in
the proxy network7. Hence, VoIP applications use an on-
demand QoS sensitive route set up protocol.
Tarzan [16] presents an anonymizing network layer
using the peer-to-peer model. It uses a gossip based
approach to disseminate the identity of nodes on the
7Although clients typically connect to the nearest proxy network
node
peer-to-peer network. At the end of the gossip protocol,
the caller src supposedly knows the network topology
and the receiver dst, thus obviating the need for a route
set up protocol. This approach requires the caller and
receiver to be connected to the network for enough time
before they can discover each other (and make VoIP
calls). However, most VoIP applications use on-demand
route set up to support client mobility.
Traditionally, multicast and broadcast protocols have
been used to protect receiver anonymity [24]. This ap-
proach sends a unicast message to a single destination
by multicasting the message to a group containing the
destination. The intended destination recognizes the mes-
sage is intended for itself because it expects this message
(Hordes [27]) or because the sender addresses the mes-
sage implicitly [24]. In contrast to these approaches, our
paper focuses on caller (source) anonymity as against
receiver anonymity. Perng et. al. [22] have shown that
multicasting data on an anonymizing network can break
some privacy guarantees. In particular, they show that the
malicious nodes in the network can use the popularity of
a multicast packet to infer some information about the
data.
VII. CONCLUSION
In this paper we have addressed the problem of on-
demand construction of QoS sensitive routes on anonymiz-
ing networks. We have used VoIP as a sample application
to demonstrate potential attacks on QoS sensitive route
set up protocols and proposed solutions to mitigate them.
First, we have identiﬁed triangulation based timing at-
tacks on broadcast based route set up protocols that can
identify the caller with high probability. Second, we have
developed random walk based protocols to mitigate this
attack while suitably trading off QoS guarantees with
anonymity. We have described a prototype implementa-
tion of our guards and presented a detailed experimen-
tal evaluation that demonstrates its QoS properties and
62
attack resilience. We have shown while the broadcast
based route set up protocol is vulnerable to timing anal-
ysis attacks, the random walk based protocols can offer
good attack resilience while satisfying QoS guarantees.
In summary, our solutions effectively protect anonymity
for callers in a VoIP network.
Acknowledgement: This research is partially supported
by NSF CSR and CyberTrust.
REFERENCES
[1] GT-ITM: Georgia
internetwork
http://www.cc.gatech.edu/projects/gtitm/.
tech
topology models.
[2] The network simulator NS-2. http://www.isi.edu/nsnam/ns/.
[3] The
simulator NS-2:
Topology
network
generation.
http://www.isi.edu/nsnam/ns/ns-topogen.html.
[4] Phex client. http://www.phex.org.
[5] Skype
global
the
-
internet
telephone
company.
http://www.skype.com.
[6] Telegeography research. http://www.telegeography.com.
[7] D. Aldous
and
chains
www.berkeley.edu/users/aldous/RWG/book.html.
and
Fill.
random walks
Reversible markov
http://stat-
graphs.
on
J.
[8] A. Back, I. Goldberg, and A. Shostack. Freedom 2.1 security
issues and analysis. Zero Knowledge Systems, Inc. white paper,
2001.
[9] A. Blum, D. Song, and S. Venkataraman. Detection of interac-
tive stepping stones: Algorithms and conﬁdence bounds. In 7th
RAID, 2004.
[10] D. Chaum. Untraceable electronic mail, return addresses, and
digital pseudonyms. In Communications of ACM, 24(2): 84-88,
1981.
[11] L. Deng and M. D. F. Wong. An exact algorithm for statistical
shortest path problem. In Design Automation Conference, 2006.
[12] R. Dingledine, N. Mathewson, and P. Syverson. Tor: The second
generation onion router. In 13th USENIX Security Symposium,
2000.
[13] D. L. Donoho, A. G. Flesia, U. Shankar, V. Paxson, J. Coit, and
S. Staniford. Multiscale stepping stone detection: Detecting
pairs of jittered interactive streams by exploiting maximum
tolerable delay. In 5th RAID, 2002.
[14] Eclipse. Aspectj compiler. http://eclipse.org/aspectj.
[15] B. Fortz and M. Thorup. Optimizing OSPF/IS-IS weights
In IEEE Journal on Special Areas in
in a changing world.
Communication, 2002.
[16] M. J. Freedman and R. Morris.
Tarzan: A peer-to-peer
anonymizing network layer. In 9th ACM CCS, 2002.
[17] D. Goldschlag, M. Reed, and P. Syverson. Onion routing for
In Communica-
anonymous and private internet connections.
tions of ACM, Vol 42(2), 1999.
[18] M. Gruteser and D. Grunwald. Anonymous usage of location-
based services through spatial and temporal cloaking. In ACM
MobiSys, 2003.
[19] K. Gummadi, R. Gummadi, S. Gribble, S. Ratnasamy,
S. Shenker, and I. Stoica. The impact of DHT routing geometry
on resilience and proximity. In ACM SIGCOMM, 2003.
[20] P. Kamat, Y. Zhang, W. Trappe, and C. Ozturk. Enhancing
In IEEE
source location privacy in sensor network routing.
ICDCS, 2005.
[21] A. Papoulis.
Probability, random variables, and stochastic
processes. In 3rd ed. McGraw Hill ISBN 0-07-100870-5, pp.
113-114.
[22] G. Perng, M. K. Reiter, and C. Wang. M2: Multicasting mixes
for efﬁcient and anonymous communication. In IEEE ICDCS,
2006.
[23] A. Pﬁtzmann, B. Pﬁtzmann, and M. Waidner.
ISDN-MIXes:
Untraceable communication with small bandwidth overhead. In
GI/ITG Conference on Communication in Distributed Systems,
1991.
[24] A. Pﬁtzmann and M. Waidner. Networks without user observ-
ability. In Computers and Security, 2(6): 158-166, 1987.
[25] L. Qiu, V. N. Padmanabhan, and G. M. Voelker. On the
In 12th IEEE INFOCOM,
placement of web server replicas.
2001.
[26] S. M. Ross. Introduction to probability models. Academic Press
ISBN: 0125980558, 2002.
[27] C. Shields and B. N. Levine. A protocol for anonymous
communication over the internet. In ACM CCS, 2000.
[28] V. Shmatikov and M. H. Wang. Timing analysis in low latency
mix networks: Attacks and defenses. In 11th ESORICS, 2006.
PSTN?
[29] G.
Sound.
Better
VoIP:
than
I.
http://www.globalipsound.com/demo/tutorial.php.
[30] P. Syverson, G. Tsudik, M. Reed, and C. Landwehr. Towards
an analysis of onion routing security. In Workshop on Design
Issues in Anonymity and Unobservability, 2000.
[31] X. Wang, S. Chen, and S. Jajodia. Tracking anonymous peer-
to-peer VoIP calls on the internet. In 12th ACM CCS, 2005.
[32] X. Wang and D. Reeves. Robust correlation of encrypted attack
trafﬁc through stepping stones by manipulation of interpacket
delays. In 10th ACM CCS, 2003.
[33] X. Wang, D. Reeves, and S. Wu.
Inter-packet delay based
correlation for tracing encrypted connections through stepping
stones. In 7th ESORICS, 2002.
[34] X. Wang, Z. Yao, and D. Loguinov. Residual-based measure-
ment of peer and link lifetimes in gnutella networks. In IEEE
InfoCom, 2007.
[35] X. Y. Wang and D. S. Reeves. Robust correlation of encrypted
attack trafﬁc through stepping stones by manipulation of inter-
packet delays. In ACM CCS, 2003.
[36] K. Yoda and H. Etoh. Finding a connection chain for tracing
intruders. In 6th ESORICS, 2000.
[37] E. W. Zegura, K. Calvert, and S. Bhattacharjee. How to model
an internetwork? In IEEE Infocom, 1996.
[38] Y. Zhang and V. Paxon. Detecting stepping stones.
In 9th
USENIX Security Symposium, 2000.
63