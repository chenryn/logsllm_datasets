title:POSTER: An Empirical Measurement Study on Multi-tenant Deployment
Issues of CDNs
author:Zixi Cai and
Zigang Cao and
Gang Xiong and
Zhen Li and
Wei Xia
POSTER: An Empirical Measurement Study on Multi-tenant 
Deployment Issues of CDNs 
Zixi Cai 
Institute of Information Engineering, 
Chinese Academy of Sciences 
Zigang Cao* 
Institute of Information Engineering, 
Chinese Academy of Sciences; 
Gang Xiong 
Institute of Information Engineering, 
Chinese Academy of Sciences 
School of Cyber Security, University 
of Chinese Academy of Sciences 
PI:EMAIL 
School of Cyber Security, University 
of Chinese Academy of Sciences 
PI:EMAIL 
School of Cyber Security, University 
of Chinese Academy of Sciences 
PI:EMAIL 
Zhen Li 
Institute of Information Engineering, 
Chinese Academy of Sciences 
Wei Xia 
Institute of Information Engineering, 
Chinese Academy of Sciences 
School of Cyber Security, University 
of Chinese Academy of Sciences 
PI:EMAIL 
School of Cyber Security, University 
of Chinese Academy of Sciences 
PI:EMAIL 
ABSTRACT 
Content  delivery  network  (CDN)  has  been  playing  an  important 
role  in  accelerating  users’  visit  speed,  bring  good  experience  for 
popular  web  sites  around  the  world.  It  has  become  a  common 
security  enhance  service  for  CDN  providers  to  offer  HTTPS 
support to tenants. When several tenants are deployed to share a 
same  IP  address  due  to  resource  efficiency  and  cost,  CDN 
providers  should  make  comprehensive  settings  to  ensure  that  all 
tenants’ sites work correctly on users’ requests. Otherwise, issues 
can take place such as denial of service (DOS) and privacy leakage, 
causing  very  bad  user  experience  to  users  as  well  as  potential 
economic loss for tenants, especially under the situation of hybrid 
deployment of HTTP and HTTPS. We examine the deployments of 
typical  multi-tenant  CDN  providers  by  active  measurement  and 
find that CDN providers, namely Akaimai and ChinaCenter, have 
configuration  problems  which  can  result  in  DOS  by  certificate 
name mismatch error. Several advices are given to help to mitigate 
the issue. We believe that our study is meaningful for improving 
the security and the robustness of CDN. 
KEYWORDS: CDN, HTTPS, certificate  
1  INTRODUCTION 
HTTPS  is  a  widely  used  network  protocol  for  secure  web 
communications  over  public  networks.  More  and  more  websites 
are deployed in the form of HTTPS. Until July 2017, according to 
Letsencrypt, the percentage of web pages loaded using HTTPS has 
exceeded half of the total, and the number of digital certificates has 
reached more than 40 million [1]. 
________________________________ 
* corresponding author. 
Permission to make digital or hard copies of part or all of this work for personal or 
classroom use is granted without fee provided that copies are not made or distributed 
for profit or commercial advantage and that copies bear this notice and the full citation 
on  the  first  page.  Copyrights  for  third-party  components  of  this  work  must  be 
honored. For all other uses, contact the Owner/Author. 
CCS '17, October 30-November 3, 2017, Dallas, TX, USA 
 © 2017 Copyright is held by the owner/author(s).  
ACM ISBN 978-1-4503-4946-8/17/10. https://doi.org/10.1145/3133956.3138852 
CDN  or  content  distribution  network  is  a  geographically 
distributed  network  of  proxy  servers  and  their  data  centers  to 
optimize  security,  performance  and  reliability.  Web  sites  using 
HTTPS  are  deployed  on  CDNs  in  different  ways,  which  can  be 
divided  into  two  modes  according  to  whether  the  CDN  node  is 
shared, namely the dedicated IP and the shared IP. Many small and 
medium-sized sites will choose the latter due to economic reasons. 
For  tenants,  it  is  critical  to  understand  how  CDNs  treat  these 
websites deployed on CDNs which share a same IP. CDN acts as a 
proxy  for  those  sites,  therefore  it  assumes  responsibility  for 
providing secure access. For sites, it is important to understand the 
deployment of these multi-tenant CDNs, so they can select a more 
robust  and  secure  CDN  service  provider,  and  try  to  avoid  those 
CDN services with misconfigurations. 
Although a lot of works have been carried out on HTTPS and 
CDN,  we  have  not  seen  any  systematical  measurement  and 
analysis that focus on the shared IP deployment mode in CDN and 
its impact on security, privacy and robustness of service yet. While 
the widely seen deployment approach may bring issues besides its 
convenience and higher exploitation of the machine resources.  
In this paper, we measured the sites which were deployed on 
CDNs  by  different  probing  requests,  summarized  the  typical 
characteristics  among  CDNs  providers  on 
IP 
deployment  mode,  and  discovered  some  misconfiguration 
problems with CDNs providers which may cause severe problems, 
especially when a node is deployed with HTTP and HTTPS sites, 
affecting users’ experience on top popular sites. Some suggestions 
are offered to help CDN providers to mitigate the issues. 
the  shared 
2   HOW MULTI-TENANT CDN PROCESS 
HTTPS 
It  is  quite  common  that  several  web  sites  are  deployed  on  one 
server in CDN for economic reasons. When a HTTPS ClientHello 
request  arrives  at  the  CDN  server,  a  corresponding  server 
certificate  is  required.  If  a  mismatched  certificate  is  returned  to 
user,  it  will  cause  DOS  or  severe  security  warning.  In  practice, 
there are three common solutions exploited by CDN providers.The 
first  solution is  to  assign  a  dedicated  IP  to each  site  to  solve  the 
conflict,  which  means  one  site  monopolizes  an  IP.  Wildcard  SSL 
and Dedicated SSL are using this approach. The second is to add 
the Server Name Indication (SNI) support  [2] , so  the server can 
return  the  corresponding  certificate  according  to  the  host 
name  in  SNI  extension  in  ClientHello.  Currently,  SNI  is 
supported in all popular browsers, so the solution is easy and 
PosterCCS’17, October 30-November 3, 2017, Dallas, TX, USA2471 
economic. The third is to use a shared SSL certificate, which 
requires  to  put  all  sites’  domains  into  the  certificate's  Subject 
Alternative  Name  (SAN)  field  [3].  However,  security  issues  or 
privacy leakage may happen due to improper deployment in  the 
real world. The general work mode of processing HTTPS request 
in CDN is shown in Fig. 1. 
Figure 1: How CDN return certificate 
3  OUR MESUREMENT 
We  try  to  identify  the  deployment  problems  of  CDN  through 
active probing techniques. Based on preliminary investigation, we 
choose the Alexa top 25,000 sites as our experiment objects since 
these sites are the most probably to exploit CDN to improve their 
users’ experience. 
To  simulate  the  situation  of  accessing  the  site  under  different 
circumstances,  we  use  different  SSL/TLS  protocol  versions, 
different  SNIs  to  establish  SSL/TLS  handshakes  with  the  host  of 
Alexa  top  25,000  sites  to  obtain  certificates  [4].  The  CDN  node 
should select the appropriate certificate and return it to the client 
after it sends back the ServerHello message during the handshake. 
When multiple sites share one same IP, different certificates shall 
be return according to SNIs. In previous researches, configuration 
problems  can  be  seen  in  the  certificate  properties  [3-5],  such  as 
domain mismatches between certificates and websites [6].  
Figure 2: A user utilizes HTTPS to access websites 
Fig.  2.  shows  a  way  for  users  to  access  the  Internet  through 
HTTPS. By entering “https” before a URL in the address bar of a 
2 
browser, they want to establish secure connections with sites that 
may  not  support  HTTPS.  We  call  it  forcing  HTTPS  visiting. 
Generally,  CDN  must  provide  the  appropriate  response  on  this 
condition.  However,  different  CDN  service  providers  may  have 
different responses in the real world. We analyze the certificates 
returned by CDNs, as well as the server’s responses to reveal the 
typical issues in current CDN service.  
4  RESULTS AND DISSCUSSIONS 
4.1   Multi-tenant CDN deployment situation 
We  summarize  the  differences  in  the  behavior  of  these  CDN 
providers  in   Table 1.  We  tick  the  checkbox  if  we  can  obtain 
certificate  in  that  case;  otherwise  we  cannot.  Results  shown  that 
SNI is widely deployed by multi-tenant CDNs. Most CDN service 
providers only offer a high version of the TLS protocol. Including 
Distilnetworks, Gannett, Fastly etc.  
Table 1: The inconsistent behavior of returning certificates 
by CDN providers 
CDN provider  TLS1.0  TLS1.2  SNI  NULL 
cloudflaressl 
akamai 
chinanetcenter 
edgecastcdn 
myqcloud 
incapsula 
azurewebsites 
wpengine 
alicdn 
baishancloud 
jiasule 
distilnetworks 
fastly 
yunjiasussl 