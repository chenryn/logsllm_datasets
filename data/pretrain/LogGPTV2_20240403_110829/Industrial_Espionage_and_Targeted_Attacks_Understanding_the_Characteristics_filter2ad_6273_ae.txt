01a1caa4ba9ec050ba8ceafe26998577
Fig. 9. Visualizing the complexity of relationships among TAIDOOR attacks
mailer agent from the very same IP address to launch the attacks. Note that three differ-
ent MD5s were used in this SYKIPOT campaign (nodes in purple).
4.4 Massive Organizational Targeted Attacks (MOTA): Nitro and Taidoor
About 1/3rd of attack campaigns are instead organized on a “large-scale” and ﬁt the
proﬁle of a Massive Organizationally Targeted Attack (MOTA), i.e., they target many
people in multiple organizations, working in different sectors, over multiple days. Most
of these large-scale campaigns are very well resourced, with up to 4 different exploits
used during the same campaign. Some are even multilingual – meaning that the lan-
guage used in the email attack is tuned to the targeted recipients (use of Chinese for
.cn recipient domains, Japanese for .jp, Russian for .ru, etc).
The TAIDOOR attacks, which we covered in a previous threat report [13], illustrate
also nicely this type of mass-scale attack campaign. These attacks can include a long
series of attack waves, sometimes spread over a long period of time (several months, or
even a few years in some cases). As illustrated in Figure 9, the relationships between
attackers in those campaigns are usually much more complex, involving many intercon-
nections at multiple levels (e.g., common MD5s, same mailer or IP address, etc). This
might indicate that several teams of attackers are collaborating or sharing some of their
resources (like malicious code, virtual servers to launch attacks, or intelligence data on
the targets). They usually target a very large number of recipients working for different
organizations, which can be active in completely different sectors.
Industrial Espionage and Targeted Attacks
77
The NITRO attacks are another example of mass-scale attack campaign also iden-
tiﬁed by TRIAGE. The bulk of the NITRO attacks was launched in late July 2011 and
continued into mid-September. Another unconﬁrmed NITRO campaign was also identi-
ﬁed later in October 2011. As for many other targeted attacks, the purpose of the NITRO
attacks appears to be industrial espionage, mainly targeting the chemical and petroleum
industries, to collect intellectual property for competitive advantage. An example of
email sent during those NITRO attack waves is given below. In this campaign, Syman-
tec blocked over 500 attacks of this type, in which the attackers use a spoofed email
address (presumably coming from an IT support desk) to entice users to install a fake
Adobe software update packaged in a zip ﬁle, and which contains a zero-day exploit to
compromise the users machines. While most targeted recipients were employees work-
ing for chemical industries, our research has showed that the NITRO attackers have also
targeted senior executives working in the Defense industry and the Aerospace domain
during the same series of attacks in October 2011.
Case Study - The NR4 Campaign
Let’s focus on another case of MOTA campaign (Figure 10). NR4 is one mass-scale
attack campaign out of 130 identiﬁed by TRIAGE (note that there is no signiﬁcance to
the name NR4). We do not know the ultimate goal of the attackers behind this campaign,
but we do know that they were targeting diplomatic and government organizations.
In this NR4 campaign, 848 attacks were made on 16 different days, over a 3 months
period. The attacks all originated from accounts on a popular free webmail service. All
attacks came from one of three different sender aliases. Multiple email subject lines
were used in the targeted attacks, all of potential interest to the recipients, with the
majority being about current political issues. Almost all targeted recipients were put in
BCC ﬁeld of the email.
The ﬁrst wave of attacks began 4/28/2011 from a single email alias. Four organi-
zations were targeted in this ﬁrst series of attacks. One of these organizations saw the
CEO as well as media and sales people targeted. Over the course of the attack campaign
the CEO was targeted 34 times.
On 5/13/2011 a new email account began sending email to targets. It was from this
account that the majority of the attacks occurred. This aliases continued attacks on the
four previous organizations but added dozens of additional organizations. One organi-
zation ﬁrst targeted in this attack wave was targeted 450 times. A total of 23 people
in the organization were targeted, with the main focus being on researchers within the
organization.
The ﬁnal attack wave started 6/30/2011 and ended 19 days later. While attack-
ing a number of organizations already part of the campaign, it also targeted 5 new
organizations.
By 7/19/2011 the NR4 targeted campaign came to an end. During the 3 months of
this campaign hundreds of emails, in English and in Chinese (used against Chinese
speaking targets) arrived in targeted users mailboxes. While the content of the email
was constantly being changed, each email contained an attached PDF or RAR ﬁle with
the same exploit that would infect users once the attachment was opened. Interestingly,
we also found that the three attackers involved in this NR4 campaign have been using
the same C&C servers for controlling compromised machines and exﬁltrating data.
78
O. Thonnard et al.
KEY
Attack Source
Subject
Targets
Dates
C&C Domains
Targeted Vulnerability
MD5
April 28, 2011
TIMELINE
July 19, 2011
Fig. 10. Visualizing the NR4 targeted attack campaign (mass-scale type)
5 On the Prevalence and Sophistication Level of Targeted Attacks
In this Section, we aim at ﬁnding evidences that support the validity of following as-
sumptions we make about the targeted attacks:
(cid:2) Targeted attacks employ more sophisticated exploitation methods compared to other
types of attacks, therefore, the attachment ﬁles in our experimental data set should
not be seen in the wild long before the attack dates we observed.
(cid:2) Targeted attacks target only a limited number of organizations or sectors, therefore,
the attachment ﬁles or the dropped binaries after successful exploitations should
not be present on a large number of computers.
In addition to the endeavour to ﬁnd such evidences, we perform deeper investigation
on the sophistication level of targeted attacks. To this aim, we enrich the existing infor-
mation about the attachment ﬁles used in targeted attacks by correlating a number of
components of Symantec’s Worldwide Intelligence Network Environment (WINE).
5.1 Investigating Historical Information
To achieve the goals set here above, we took advantage of the information provided
by Symantec’s dynamic malware analysis platform, by VirusTotal5 and by the WINE
platform [7].
The Symantec’s dynamic analysis platform (DAP) not only analyzes binary ﬁles
but also other ﬁle types such as *.pdf, *.doc, *.xlsx. To get a better understanding of
the intentions of the attackers, one reasonable approach is to analyze the ﬁles that are
downloaded after successful exploitations. Hence, we use Symantec’s DAP to acquire
5 VirusTotal – https://www.virustotal.com/
Industrial Espionage and Targeted Attacks
79
a list of downloaded or created ﬁles (droppee) once the attachment ﬁle (dropper) has
been opened by the victims and has successfully compromised their computer. We have
then searched for all droppees in WINE to get some historical information on those
ﬁles. To validate our results, we also queried VirusTotals to be able to compare them
with other Anti-Virus companies’ ﬁndings.
WINE is a platform through which Symantec shares data with the research com-
munity6. WINE consists of a number of datasets such as a malware samples collec-
tion, binary ﬁles reputation data, A/V telemetry data, e-mail spam, URL reputation,
IPS telemetry and yet some others. The WINE datasets on which we performed our
analysis are the A/V telemetry and the binary reputation system. Since the beginning of
2009, the A/V telemetry records the detections of known threats for which Symantec
generated a signature and was subsequently deployed in anti-virus products. A typical
record in A/V telemetry data comprises several ﬁelds; however, in our analysis we only
use the detection time, the associated threat label and the hash (MD5 and SHA2) of the
malicious ﬁle.
The binary reputation data does not involve threat detections; instead, it includes all
binary ﬁles that were not detected by Symantec’s security products. This data allows us
to look back in time and get more insights about what happened before signatures for
malicious binaries were created. The binary reputation component records the down-
load date and time of all binaries, the source they were downloaded from and some
information about the binary ﬁle, such as the ﬁle name, the hash and the ﬁle size. Since
mid-2008, the binary reputation data is collected only from Symantec customers who
gave consent to share this invaluable information.
In summary, to investigate the prevalence and sophistication of the targeted attacks
studied in this paper, we apply the following methodology for each campaign TRIAGE
produces: (i) we prepare a list of MD5 hashes of the droppers employed in the at-
tacks. The droppers afterwards are searched in Symantec’s DAP to ﬁnd the associated
droppees. (ii) Once dropper-droppee association list is constructed, both types of ﬁles
are searched in the A/V telemetry data to determine the lifetime of the targeted attacks
launched by each campaign. (iii) Finally, we search the droppees in the binary reputa-
tion data. Note that droppers in our experimental set cannot be found there, since binary
reputation data only stores binary ﬁles.
Correlating the results of the three WINE components7, we extract following infor-
mation about the dropper and droppees:
- The ﬁrst and last time the ﬁle was detected to be malicious,
- The ﬁrst and last time the ﬁle was downloaded by our customers before a detection
signature was generated for the speciﬁc threat,
- The number of machines that downloaded or attempted to download the ﬁle,
- The associated threat name and vulnerability id if it exists.
6 WINE provides external researchers access to security-related data feeds collected in the wild.
See http://www.symantec.com/WINE for more information.
7 The WINE data set used for this analysis is available to other researchers as “WINE 2012-
002”.
80
O. Thonnard et al.
In the following section, we show how we leveraged this information to ﬁnd interesting
results about the prevalence and sophistication of the targeted attacks we analyzed in
this paper.
5.2 Malware Analysis Results
We performed a set of experiments to get more insights about the characteristics of
malware used in targeted attacks analyzed in this paper.
The ﬁrst experiment consists in querying 18,850 attachment ﬁles in Symantec’s DAP
and VirusTotal. Not surprisingly, only 941 (5.0%) of the droppers used in targeted at-
tacks were identiﬁed. Therefore, we could not retrieve any information about 195 out
of 345 campaigns TRIAGE produces from either Symantec or any other A/V product.
Since a majority of the attachments were not found by any of the Anti-Virus scanners,
we could conclude that targeted attacks are not very prevalent. If they were as preva-
lent as other types of large-scale attacks, it would have been harder to stay undercover.
Another possible reasoning would be that targeted attacks are carried out through more
sophisticated techniques, and therefore, they manage to evade most of the security walls
and can stay hidden over longer periods of time.
In our second experiment, we parsed the analysis reports produced by Symantec’s
DAP to acquire the list of droppees that were downloaded or created after droppers
successfully compromised the victims. The droppers after the exploitation stage cre-
ated 1,660 distinct ﬁles. We then searched all droppers and their associated droppees
in WINE and extracted the information listed above. In WINE, we found records for
droppee/dropper detections and downloads for only 51 attack campaigns identiﬁed pre-
viously by TRIAGE. The explanation for not ﬁnding all dropper and droppees of the
remaining campaigns can be that the victims of the targeted attacks in our experimen-
tal dataset were not Symantec customers. Another reason could be related to the fact
that more sophisticated targeted attacks could use zero-day attacks, and therefore might
escape signature-based detection methods.
To measure the prevalence of those 51 attacks campaigns found in WINE, we com-
puted the number of computers reporting the presence of the droppees or the droppers.
The average number of machines that were subject to one of the attacks sourced by one
of the campaigns is only 5. Hence, this is also a strong evidence that seems to show that
targeted attacks are not very prevalent.
Targeted attacks are usually active for a limited period of time varying from a few
days to several months. To validate this claim, we compared the ﬁrst and last time the
droppers/droppees were recorded in WINE with the start and end time of the targeted
attacks we have analyzed. In Figures 11(a) and 11(b), Δt1 represents the difference
between the start time of the attack and the ﬁrst observation time of the related malware
in WINE, whereas Δt2 represents the difference between the end time of the targeted
attack and the last observation time of the related malware in WINE. Figure 11(a) shows
that the majority of the attachment ﬁles were not observed in the wild more than 2
weeks before the attack time speciﬁed by Symantec.cloud. On the other hand, droppees
exhibit a different behavior than droppers. Figure 11(b) shows that, while there are some
droppees that are never observed outside the attack window (i.e., the period in which
Industrial Espionage and Targeted Attacks
81
Δt1
Δt2
Δt1
Δt2
s
n
g
i
a
p
m
a
c
e
h
t
f
o
%
35
30
25
20
15
10
5
0
-4 m onths
ths
-1 m onth
nth
eks
-2 w eeks
sa m e day
day
ek
+ 1 w eek
(a)
+ 1 m onth
nth
ths
+ 2 m onths
ths
+ 3 m onths
ths
+ 4 m onths
s
n
g
i
a