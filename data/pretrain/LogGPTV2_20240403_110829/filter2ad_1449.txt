title:Secure and Efficient Software-based Attestation for Industrial Control
Devices with ARM Processors
author:Binbin Chen and
Xinshu Dong and
Guangdong Bai and
Sumeet Jauhar and
Yueqiang Cheng
Secure and Efficient Software-based Attestation for 
Industrial Control Devices with ARM Processors  
Binbin Chen*, Xinshu Dong*, Guangdong Bai#, 
Sumeet Jauhar*, Yueqiang Cheng^ 
* Advanced Digital Sciences Center, Illinois at Singapore  
# Singapore Institute of Technology 
^ Baidu USA XLab 
ACSAC 2017, December 7, 2017, Orlando FL, USA 
1 
Attacks on Industrial Control Systems 
2015 Ukraine Power Grid Attack: 
â€¢ Attacker abuses the SCADA and field 
â€¢
â€¢
devices to open circuit breakers 
The attackers persist within the 
environment for six months or more  
Serial-to-Ethernet communications 
devices impacted at a firmware level 
Lack of active defense measures 
â€¢
2016 Ukraine Power Grid Attack: 
â€¢ Automated with a malware framework 
2 
Software Attestation for ICS Devices 
â€¢ Ensuring the software integrity of ICS devices is a foundational 
requirement for enhancing ICS security 
An example RTU device 
             Power Grid Operations 
Systems and Communications 
[source: CRASHOVERRIDE -- Analysis of 
the Threat to Electric Grid, DRAGOS Inc.]  3 
Software Attestation for ICS Devices 
â€¢ ICS devices execute well-specified program logic. This 
allows an attestation-based approach to provide high 
assurance about the software integrity of the 
attested device 
â€¢ In comparison, solutions like anti-virus or host-based 
intrusion detection systems only provide best-effort 
malware detection 
4 
SoftWare-Only Root of Trust (SWORT) 
â€¢ Attestation requires some form of root of trust 
â€“ It is often difficult to deploy a hardware-based 
root-of-trust solution (e.g., TPM) to existing ICS 
â€“ A software-only solution hence is desirable 
5 
Efficient SWORT for ICS 
â€¢ SWORT consumes all computational resources of 
the prover, hence it needs to run fast for ICS 
â€“ E.g., the cycle response time is 20ms for a 50-Hz grid 
â€¢ Short attestation time also helps raise the bar for 
launching proxy attacks, where the device under 
attestation asks a computationally more powerful 
remote device to compute the checksum 
â€“ E.g., if  SWORT completes within 20ms, a proxy attack 
behind a slow link (e.g., cellular) would fail 
6 
Full Memory Walk May Take Too Long 
â€¢ For example, consider an NXP LPC2362 board with 
an ARM7 72MHz CPU and a 58KB RAM, and a 
probability of Pr ğ‘¤ğ‘–ğ‘› = 10âˆ’10 for a prover with 
modified memory to cheat the verifier and win the 
attestation, a random walk over the whole RAM 
takes 156.9ms.  
ğ‘ = ğ‘  Ã— lnâ¡
1
Prâ¡[ğ‘¤ğ‘–ğ‘›]
â€¢ If RAM size grows to a few hundred MB, the memory 
walk can take minutes to complete 
7 
Outline 
â€¢ Background 
â€¢ Memory Stride Design 
â€¢ Analysis and Evaluation 
8 
System & Threat Model 
â€¢ We focus on ICS devices with low-end ARM processors, 
e.g., ARM7 or ARM Cortex-M3 
â€¢ We assume there is a trusted verifier that locates in the 
same local area network (LAN) as the proofer 
â€“ The communication delay between the verifier and the prover is 
short and stable 
â€¢ We trust the physical access control to the ICS environment 
â€“ No proxy devices inside the LAN, no change to proverâ€™s 
hardware spec 
â€“ Malware can still by introduced, though, e.g., by innocent 
insider during maintenance  
â€¢ We do not address malware that launches attacks outright 
(e.g., DoS attacks)  
9 
Attacks to Partial Memory Walk 
Illustration of Memory Copy Attacks 
â€¢ Prior secure partial memory walk solutions 
â€“ Pioneer for Intel platform 
â€“ SCUBA & ICE scheme for a MIPS platform 
â€“ Challenges on ARM platform have been discussed, but no concrete 
solution has been proposed 
10 
Attackerâ€™s Potential Leverage on ARM 
Illustration of Memory Copy Attacks 
â€¢
â€¢
â€œFreeâ€ Offset/Shift with LDR 
â€“ E.g.,  LDR r0, r1, #0x1000    takes the same time as   
          LDR r0, r1 
  where 0x1000 is the offset of a clean copy to launch attack in (b) 
â€œFreeâ€ ARM-Friendly Immediate Value 
â€“ E.g., one can hard code the PC value to launch attack in (c) 
11 
Memory stride 
â€¢ Basic idea I : Two types of memory accesses 
â€“ Memory walk over SWORT code (size ğ¿) 
â€“ Memory stride over stride addresses (neighboring stride 
addresses are separated by ğ¿. Hence for a RAM size of ğ‘ , there 
are 
 stride addresses (see ğ’™ğŸ, ğ’™ğŸ, ğ’™ğŸ, ğ’™ğŸ‘ â‹¯) 
ğ‘ 
ğ¿
â€“ The total number of addresses to cover reduces from ğ‘  to ğ¿ +
ğ‘ 
ğ¿
ğ’™ğŸ 
ğ’™ğŸ 
ğ’™ğŸ 
ğ’™ğŸ‘ 
12 
Memory stride 
â€¢ Basic idea II : Access these two types of memory 
addresses in an interleaving way 
â€¢ Basic idea III: Generate unique values for stride addresses 
(except for ğ’™ğŸ) 
13 
How it works 
â€¢ No matter how the attacker moves the code region or the 
stride addresses, there will always be at least one 
overlapping word between these two address spaces. 
â€¢ This collided address supposes to return different values 
for the two different types of accesses. 
14 
Outline 
â€¢ Background 
â€¢ Memory Stride Design 
â€¢ Analysis and Evaluation 
15 
ASSW Framework 
â€¢ We follow the ASSW analysis framework and simplify their upper 
bound results based on typically used values of parameters 
                                                                    where: 
                                                                    We simplify it to: 
[Armknecht13] F.Armknecht, A.-R.Sadeghi, S.Schulz, andC.Wachsmann. A security 
framework for the analysis and design of software attestation. ACM CCS, 2013. 
16 
An Issue of ASSW Framework 
â€¢ The ASSW framework makes two strong and pessimistic 
assumptions:  
â€“ Once an iteration accesses a collision address, the attacker has 
100% chance to win, i.e., compute the correct checksum for that 
iteration while using 0 time 
â€“ The attacker has 100% chance to win one iteration, if the 
attacker spends (ops + 1) (instead of ops) time for one iteration 
â€¢ Our analysis shows, regardless of the value of ğ‘, when the 
similarity between malicious image and genuine image is 
1
high, i.e., ğœ† = 1 âˆ’
2ğ‘™ğ‘, a simple attack strategy can achieve 
Pr ğ‘¤ğ‘–ğ‘› >
1+
1
ğ‘œğ‘ğ‘  
1
ğ‘’
â€¢ Conclusion: we cannot keep both assumptions 
â€“ ASSW paper didnâ€™t realize this issue, partly because they evaluate a 
smaller value of ğœ† 
17 
Proposed Change to ASSW Framework 
â€¢ Drop ASSW frameworkâ€™s pessimistic assumption about 
collision addresses 
â€“ There is no known attack that can â€œrememberâ€ previously accessed 
address 
â€¢ With this change, we are able to further simplify the upper 
bound to: Pr ğ‘¤ğ‘–ğ‘›  10x compared to  
full RAM walk in several settings 
â€“ Emulation code of prover & verifier at: 
http://www.illinois.adsc.com.sg/attestation/Attestation-ADSC-Release-2017.zip 
19 
Impact of Network Delay 
â€¢ We evaluated two models of industrial Ethernet switches, 
Belden Spider II 8TX Ethernet switch and Moxa EDS-205 Switch 
â€¢ First 5 hops are Belden switches and next 5 are Moxa switches 
20 
Impact of Network Delay 
â€¢
If checksum computation is 12.5 ms, and assume a malicious 
prover incurs x% of overhead, (a pessimistic setting of x=1.6%) 
â€“ 12.5ms x 1.6% = 0.2ms 
â€“ Even a single hop network delay is greater than 0.2ms, so network delay 
needs to be explicitly accommodated 
21 
Impact of Network Delay 
â€¢ Consider the per-hop minimum delay is already factored in. For 
a given hop, we find that the probability for the delay to be 
0.2ms above the minimum delay is less than0.1%. Hence, with a 
delay budget of 0.2 ms, the false positive rate can be low. 
22 
Conclusion 
â€¢ A new memory stride design to reduce the SWORT time 
requirement on ARM-based devices 
â€¢ Analysis based on an adapted version of ASSW framework 
â€“ The proposed change is needed for practical application of the 
framework for SWORT analysis (not only for memory stride) 
â€¢ A push towards real-world system integration 
Thanks! 
Contact:    PI:EMAIL 
23