✓
✓
✓
✓
✓
✓
✓
Corrections”.
and thus, may be mapped to available servers in different countries
and regions.
The effect of local IT infrastructure: We also assess the extend
of which local IT infrastructure deployment plays an important
role in increasing the confinement of tracking flows within national
borders. In Fig. 12, we show the confinement of tracking flows in
the top five countries for the four ISPs on April 4, 2018; similar
observations are derived for the other two dates in our dataset. The
two ISPs that operate in Germany, a country with very developed IT
and networking infrastructure in Europe, have considerably higher
confinement within national borders, 69% for DE-Broadband and
67.31% for DE-Mobile, compared to 0.25% (not visible in Fig. 12(c))
and 6.85% for PL and HU, respectively. As expected, a large fraction
of tracking flows that cross borders are served by servers in other
neighboring EU countries, with a heavy bias on countries with
advanced IT infrastructure, such as the Netherlands and Ireland in
the case of German operators, Germany and the Netherlands in the
case of PL, Austria in the case of HU. This analysis agrees with the
analysis of the data collected from the real users using the browser
extension (see Sect. 4).
8 RELATED WORK
A subsequential amount of recent work has studied the privacy
implications of online advertising and web tracking in desktop [28–
30, 35, 41, 51, 58, 61], mobile [53, 60] or mixed platforms [36, 42, 52].
In Table 9, we summarize and compare some of the key features and
approaches from this literature. We highlight all positive features
of each work with a green checkmark, all negative ones with a red
cross, and all neutral ones with a black dot. The rating scheme in
use is based on the challenges stated in Sect. 2.3. To the best of our
knowledge, our work is the only existing work fully dedicated to
the study of cross border tracking on the web. Few other works
have touched upon geographic matters of tracking but never at the
depth and breadth that we have. Also, in order to carry our study,
we had to come up with methodological contributions that progress
the aggregate state of the art from previous work along multiple
directions (see the right column of Table 9 for an overview).
In regards to reviewing the literature, we focus on four key
aspects:
Third-party request classification: One of the most critical and
non-trivial problems is to be able to distinguish a third-party re-
quest either as ad- or tracking-related or not. Currently, the most
common solution is to use the “easylist” and “easyprivacy” [7] lists
to detect ad- and tracking-related requests, respectively. A naive
usage of the above lists can lead to an over- or under-estimation
of the third-party requests belonging to each category depending
on how the lists are used. For example, one can consider all the
domains included in the list. This approach will lead to an overesti-
mation since domains such as “google.com” can serve all three types
of request. Another way of using the lists is by using the included
blocking rules and classify the third-party request only when there
is an exact match. Note that the lists are constructed to block third-
party requests as observed from the real users browser, thus, any
subsequent third-party requests that is initiated by the blocked
content may include additional domains that will stay outside the
list rules as explained earlier in Sect. 3.2. The above observations
are also identified and reported in [52, 58] and are also confirmed
by our own work. We refer to the extra work we do to collect addi-
tional trackers that do not appear in the standard lists as “Custom
Corrections” in Table 9.
Data collection: The data collection process (Table 9 - Row 5) can
also influence the results in some cases. The convenience of using
web crawling as oppose to real users can limit the number of observ-
able third-party requests due to the lack of user interaction (scroll or
page down) on a webpage that includes tracking code. To improve
user experience, reduce data consumption, and charge advertisers
accurately, ads are rendered only when the ad slot becomes visible
to the user. For more discussion about the advantages of using real
users in the mobile environment see [42, 52]. Web crawling is a bet-
ter approach (given that it is faster) for studies that do not require
Tracing Cross Border Web Tracking
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
user interaction with the content, e.g., collecting information about
mobile apps from app stores [53] or from web-archives [41]. In this
work, the data collection takes place on real users’ browsers using
a browser extension to overcome the above limitation as described
in Sect. 3.1.
Infrastructure geolocation: In order to improve the user experi-
ence, most web platforms and e-stores use a geolocation service
for things like customizing content language or currency based
on the location of a visitor. As a result, most geolocation services
turn their attention towards the accurate geolocation of end users
connecting from residential or mobile broadband networks. Accu-
rately geolocating server infrastructure is a secondary priority for
such services. Indeed, by manually examining some of the avail-
able geolocation services, we noticed that the location for most of
the IPs related to infrastructure servers was determined based on
the legal entity owner’s location (see Sect 3.4). Thus, using such
services to infer server location is problematic. If the focus of a
study is to only geolocate the legal entity behind a specific server
IP, then these services can be used safely (Table 9 - Row 6) [36, 53].
In this work we identify the above problem and we avoid it by
utilizing a state-of-the-art solution based on active measurement to
correctly geolocate infrastructure servers involved in web tracking
and advertising activities.
Traffic type: An additional advantage is to have a methodology
that can work on encrypted traffic (Table 9 - Row 7). Most ad and
tracking related third-party requests that we observe in our study
have already moved to encrypted traffic (83.14% based on the real
users dataset). As we can see in Table 9, ten out of fourteen studies
are able to operate on encrypted traffic. In this work we propose
a novel methodology that can identify tracking flows in the wild
using ISPs NetFlows. In more details, we use active measurement
to carefully identify the IPs associated with ad and tracking related
activities within real users browsers (see Sect. 3.3) irrespectively
of the protocol used (HTTP or HTTPS) and use this information
to analyze ISPs NetFlows at the IP level (see Sect. 7.2) avoiding the
need of any additional meta-data or contextual information.
9 CONCLUSION
We have developed an elaborate measurement and analysis method-
ology for quantifying the percentage of tracking flows that ter-
minate within national borders. Our analysis reveals that most
tracking flows on European Union citizens terminate within EU
members thus putting them under the full jurisdiction of GDPR
and permitting European data protection authorities to conduct full
investigations. This is a rather optimistic result when contrasted
with what happens in other continents, e.g., South America, that
has most of the tracking flows on its citizens terminating in North
America.
Naturally, the level of confinement within national borders is
substantially lower than continent-wide confinement. Looking at in-
dividual European countries we see a clear correlation between the
size of a country and the amount of tracking that is confined within
its borders. There also exists a correlation between the density level
of IT infrastructure of a country, mostly in terms of datacenters,
and the confinement of tracking flows within its borders. National
confinement can be improved substantially via simple DNS redi-
rection to alternative tracking end points. This is something that
most tracking companies could implement with a rather small cost.
However, for some smaller countries with less advanced IT infras-
tructure, DNS redirection alone is not enough but rather needs to
be paired with tracking PoP mirroring within the country.
An important finding of our study is that the confinement level
of tracking flows relating to protected data categories is similar to
that of general traffic. This is a positive or negative result depending
on one’s view-point: positive in the sense that such tracking can
readily be investigated since most of it terminates within GDPR
jurisdiction; negative in the sense that some of it should not be
occurring in the first place.
In this work we provide a methodology on how to bootstrap
and scale an experiment to detect and geolocate the different ad
and tracking related stakeholders under the new regulations with
regards to data protection and we apply it to the timely topic of
GDPR. We can continuously monitor the compliance to GDPR over
time and also include the monitoring of other regulations in the
future at different regional (e.g., USA ) or content scope (Children’s
Online Privacy Protection Act - COPPA [3, 38], etc.)
In our future work we intend to build a system around our
methodology, deploy it, and make it available to whomever would
like to have hard data on cross-border tracking in real-time and at
scale. We also plan to extend our methodology to go beyond the
terminating end-point of tracking to capture inter-tracker collabo-
ration and data exchange.
ACKNOWLEDGMENTS
We thank the anonymous reviewers and our shepherd Aruna Bal-
asubramanian for their thoughtful reviews and suggestions. We
also thank Nicolas Kourtellis (Telefonica I+D) for his help during
the users recruitment process on the CrowdFlower platform. Fi-
nally, we would like to thank Massimo Candela and Emile Aben
(RIPE NCC) for their support and help in using the RIPE IPmap
geolocation tool.
This work and its dissemination efforts were supported in part
by the European Research Council (ERC) grant ResolutioNet (ERC-
StG-679158) and by the European Union H2020 project SMOOTH
(Grant agreement No.:786741).
REFERENCES
[1] AdBlock Plus - Surf the web without annoying ads! https://adblockplus.org/.
[2] Amazon
JSON
https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html.
Address
Ranges
AWS
IP
in
-
format.
(COPPA).
[3] Children’s
Online
Privacy
Protection
Act
https://www.ftc.gov/enforcement/rules/rulemaking-regulatory-reform-
proceedings/childrens-online-privacy-protection-rule.
[4] CrowdFlower. https://www.crowdflower.com/.
[5] Data protection in the EU, The General Data Protection Regulation (GDPR); Reg-
ulation (EU) 2016/679. https://ec.europa.eu/info/law/law-topic/data-protection/.
[6] Digital Ocean network. https://status.digitalocean.com/.
[7] Easylist - The primary filter list that removes most adverts from international
webpages. https://easylist.to/.
Data
Global
[8] Equinix:
https://www.equinix.com/locations/.
Centers
and
Colocation
Services.
[9] Ghostery - Makes the Web Cleaner, Faster and Safer! https://www.ghostery.com/.
[10] Google AdWords. https://adwords.google.com/.
[11] Google Cloud Locations. https://cloud.google.com/about/locations/.
[12] Google: Our Infrastructure. https://peering.google.com/#/infrastructure.
[13] Google: Real-Time Bidding Protocol.
https://developers.google.com/ad-
exchange/rtb/start.
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Costas Iordanou et al.
[14] Interactive
Advertising
Bureau:
OpenRTB
(Real-Time
Bidding).
https://www.iab.com/guidelines/real-time-bidding-rtb-project/.
[15] IP-API - Free Geolocation API. http://ip-api.com/.
[16] MaxMind:
Geolocation
and
IP
Online
https://www.maxmind.com.
Fraud
Prevention.
[17] Microsoft Azure Datacenter IP Ranges.
https://www.microsoft.com/en-
[18] ORACLE: Data Regions
for Platform and
Infrastructure
Services.
us/download/details.aspx?id=41653.
https://cloud.oracle.com/data-regions.
[19] Rackspace Global Infrastructure. https://www.rackspace.com/about/datacenters.
[20] RIPE Atlas. https://atlas.ripe.net/.
[21] RIPE NCC OpenIPmap: Geolocating Internet Infrastructure with Inference En-
gines and Crowdsourcing. https://ipmap.ripe.net/.
[22] Robtex - Everything you need to know about domains, DNS, IP, Routes, Au-
tonomous Systems, and much, much more! https://www.robtex.com/.
[23] The Cloudflare Global Anycast Network. https://www.cloudflare.com/network/.
[24] The IBM Cloud network. https://www.ibm.com/cloud-computing/bluemix/our-
[25] OpenRTB API Specification Version 2.3.1.
https://www.iab.com/wp-
content/uploads/2015/05/OpenRTB_API_Specification_Version_2_3_1.pdf, 2015.
[26] Internet Advertising Bureau: Advertising Revenue Report. https://www.iab.com/
insights/iab-internet-advertising-revenue-report, 2018.
[27] G. Acar, M. Juarez, N. Nikiforakis, C. Diaz, S. Gürses, F. Piessens, and B. Preneel.
FPDetective: Dusting the Web for Fingerprinters. In ACM CCS, 2013.
[28] R. Balebako, P. L. G. De León, R. Shay, B. Ur, Y. Wang, and L. F. Cranor. Measuring
the Effectiveness of Privacy Tools for Limiting Behavioral Advertising. In W2SP
Workshop, 2012.
[29] P. Bangera and S. Gorinsky. Ads versus Regular Contents: Dissecting the Web
Hosting Ecosystem. In IFIP Networking, 2017.
[30] M. A. Bashir, S. Arshad, E. Kirda, W. Robertson, and C. Wilson. How Track-
ing Companies Circumvent Ad Blockers Using WebSockets. In Workshop on
Technology and Consumer Protection, 2018.
[31] M. Calder, X. Fan, Z. Hu, E. Katz-Bassett, J. Heidemann, and R. Govindan. Mapping
the Expansion of Google’s Serving Infrastructure. In ACM IMC, 2013.
[32] B. Claise. Cisco Systems NetFlow Services Export Version 9, October 2004. IETF
network.
RFC 3954.
[33] P. Ferguson and D. Senie. Network Ingress Filtering: Defeating Denial of Service
Attacks which employ IP Source Address Spoofing, May 2000. IETF RFC 2827.
[34] M. J. Freedman, M. Vutukuru, N. Feamster, and H. Balakrishnan. Geographic
Locality of IP Prefixes. In ACM IMC, 2005.
[35] N. Fruchter, H. Miao, S. Stevenson, and R. Balebako. Variations in Tracking in
Relation to Geographic Location. CoRR, 2015.
[36] A. Gervais, A. Filios, V. Lenders, and S. Capkun. Quantifying Web Adblocker
Privacy. 2017.
[37] M. Gharaibeh, A. Shah, B. Huffaker, H. Zhang, R. Ensafi, and C. Papadopoulos. A
Look at Router Geolocation in Public and Commercial Databases. In ACM IMC,
2017.
[38] I. Reyes and P. Wijesekera and A. Razaghpanah and J. Reardon, N. Vallina-
Rodriguez and S. Egelman and C. Kreibich. Is Our Children’s Apps Learning?
Automatically Detecting COPPA Violations. In Workshop on Technology and
Consumer Protection (ConPro), 2017.
[39] E. Katz-Bassett, J. P. John, A. Krishnamurthy, D. Wetherall, T. Anderson, and
Y. Chawathe. Towards IP geolocation using delay and topology measurements.
In ACM IMC, 2006.
[40] A. Langley, A. Riddoch, A. Wilk, A. Vicente, C. Krasic, D. Zhang, F. Yang, F. Koura-
nov, I. Swett, J. Iyengar, J. Bailey, J. Dorfman, J. Roskind, J. Kulik, P. Westin,
R. Tenneti, R. Shade, R. Hamilton, V. Vasiliev, W-T. Chang, and Z. Shi. The QUIC
Transport Protocol: Design and Internet-Scale Deployment. In ACM SIGCOMM,
2017.
[41] A. Lerner, A. Kornfeld Simpson, T. Kohno, and F. Roesner. Internet Jones and
the Raiders of the Lost Trackers: An Archaeological Study of Web Tracking from
1996 to 2016. In USENIX Security Symposium, 2016.
[42] C. Leung, J. Ren, D. Choffnes, and C. Wilson. Should You Use the App for That?:
Comparing the Privacy Implications of App- and Web-based Online Services. In
ACM IMC, 2016.
[43] M. Falahrastegar and H. Haddadi and S. Uhlig and R. Mortier. The Rise of
Panopticons: Examining Region-Specific Third-Party Web Tracking. In TMA,
2014.
[44] M. Falahrastegar and H. Haddadi and S. Uhlig and R. Mortier. Tracking Personal
Identifiers Across the Web. In PAM, 2016.
[45] J. R. Mayer and J. C. Mitchell. Third-party Web Tracking: Policy and Technology.
In IEEE Symposium on Security and Privacy, 2012.
[46] J. S. Otto, M. A. Sanchez, J. P. Rula, and F. E. Bustamante. Content delivery and
the natural evolution of DNS - Remote DNS Trends, Performance Issues and
Alternative Solutions. In ACM IMC, 2012.
[47] P. Papadopoulos, N. Kourtellis, and E. P. Markatos. Exclusive: How the (synced)
Cookie Monster breached my encrypted VPN session. In European Workshop on
Systems Security, 2018.
[48] P. Papadopoulos, P. Rodriguez, N. Kourtellis, and N. Laoutaris. If you are not
paying for it, you are the product: how much do advertisers pay to reach you?
In ACM IMC, 2017.
[49] J. Parra-Arnau, J. P. Achara, and C. Castelluccia. MyAdChoices: Bringing Trans-
parency and Control to Online Advertising. TWEB, 2017.
[50] I. Poese, S. Uhlig, M. A. Kaafar, B. Donnet, and B. Gueye. IP Geolocation Databases:
[51] E. Pujol, O. Hohlfeld, and A. Feldmann. Annoyed Users: Ads and Ad-Block Usage
Unreliable? ACM CCR, 41(2), 2011.
in the Wild. In ACM IMC, 2015.
[52] A. Razaghpanah, R. Nithyanand, N. Vallina-Rodriguez, S. Sundaresan, M. Allman,
C. Kreibich, and P. Gill. Apps, Trackers, Privacy, and Regulators: A Global Study
of the Mobile Tracking Ecosystem. In NDSS, 2018.
[53] B. Reuben, L. Ulrik, M. Van Kleek, J. Zhao, T. Libert, and N. Shadbolt. Third Party
Tracking in the Mobile Ecosystem. CoRR, 2018.
[54] J. Ruth, I. Poese, C. Dietzel, and O. Hohlfeld. A First Look at QUIC in the Wild.
In PAM, 2018.
[55] InMon – sFlow. http://sflow.org/.
[56] S. S. Siwpersad, B. Gueye, and S. Uhlig. Assessing the geographic resolution of
exhaustive tabulation for geolocating Internet hosts. In PAM, 2008.
[57] O. Starov, P. Gill, and N. Nikiforakis. Are You Sure You Want to Contact Us?
Quantifying the Leakage of PII via Website Contact Forms. PoPETs, 2016.
[58] E. Steven and A. Narayanan. Online Tracking: A 1-million-site Measurement
and Analysis. In ACM CCS, 2016.
[59] F. Streibelt, J. Boettger, N. Chatzis, G. Smaragdakis, and A. Feldmann. Exploring
EDNS-Client-Subnet Adopters in your Free Time. In ACM IMC, 2013.
[60] N. Vallina-Rodriguez, J. Shah, A. Finamore, Y. Grunenberger, K. Papagiannaki,
H. Haddadi, and J. Crowcroft. Breaking for Commercials: Characterizing Mobile
Advertising. In ACM IMC, 2012.
[61] R. J. Walls, E. D. Kilmer, N. Lageman, and P. D. McDaniel. Measuring the Impact
and Perception of Acceptable Advertisements. In ACM IMC, 2015.
[62] J. Wang, W. Zhang, and S. Yuan. Display Advertising with Real-Time Bidding
(RTB) and Behavioural Targeting. Foundations and Trends in Information Retrieval,
11, Oct 2016.
[63] F. Weimer. Passive DNS Replication. In 17th Annual FIRST Conference, 2005.