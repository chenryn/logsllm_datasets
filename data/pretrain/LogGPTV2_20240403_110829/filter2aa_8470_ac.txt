            1 & -N & 0 & N^{2} & 0 & 0 & 0 & -N^{3} \\
            0 & e_{1} & -e_{1} & -N e_{1} & -e_{1} & 0 & N e_{1} & N^{2} e_{1} \\
            0 & 0 & e_{2} & -N e_{2} & 0 & N e_{2} & 0 & N^{2} e_{2} \\
            0 & 0 & 0 & e_{1} e_{2} & 0 & -e_{1} e_{2} & -e_{1} e_{2} & -N e_{1} e_{2} \\
            0 & 0 & 0 & 0 & e_{3} & -N e_{3} & -N e_{3} & N^{2} e_{3} \\
            0 & 0 & 0 & 0 & 0 & e_{1} e_{3} & 0 & -N e_{1} e_{3} \\
            0 & 0 & 0 & 0 & 0 & 0 & e_{2} e_{3} & -N e_{2} e_{3} \\
            0 & 0 & 0 & 0 & 0 & 0 & 0 & e_{1} e_{2} e_{3}
            \end{array}\right)
    $$
    其中
    $$
    D = diag(\begin{array}{r}
        N^{\frac{3}{2}}&N&N^{a + \frac{3}{2}}&\sqrt{N}&N^{a + \frac{3}{2}}&N^{a + 1}&N^{a + 1}&1\end{array})
    $$
    同样我们可以得到
    $$
    \Vert bL_2 	\Vert < \sqrt{8}N^{3/2+2\alpha_3}
    $$
    则当
    $$\alpha_3 < 2/5 - \epsilon^{'}$$
    时可以通过格基规约求出向量$b$。
## 四个小解密指数的情况
* 额外选取$G_{1, 4}, W_1G_{2, 4}, G_{1, 2}G_{3,4}, G_{1, 3}G_{2, 4}, W_1W_2G_{3, 4}, W_1W_3G_{2, 4}, W_2W_3G_{1, 4}, W_1W_2W_3W_4$进行构造。不再翻译。
## 分析
* 扩展维纳攻击结合上述三个例子已经详细的阐明了方法细节，但是其中没有讲解如何选取复合关系。其实在原文的附录中给出了复合关系的选取，以及给出了$\alpha_n$的表达式。
* 在原文附录部分，考虑$n$个指数$e_i$，这样则有$2^n$个不同的量$h_j$（一个表达式$e_i$的个数），这样我们的$L_n$在乘上$D$之前，矩阵$L_n$的行列式为$N^{n2^{n-1}}$
    这样最后一个关系$W_1W_2\dots W_n$最大为$N^{n/2 + n\alpha_n}$，这样我们便知道了任意情况的最大界值，我们只需要让其他值增加到这么多即可（即构造$D$矩阵）
    引入了新的关系式
    $$
    R_{u,v} = W_{i_1}\dots W_{i_u}G_{j_1, l_1}\dots G_{j_v, l_v}
    $$
    其中$i_1,\dots,i_u,j_1,\dots,j_u,l_1,\dots,l_v$都不同，那么这里最多会有$u + 2v$个指数$e_i$，则我们的关系$R_{u,v}$最多为$N^{u/2 + (u+v)\alpha_n}$，同时注意我要需要所有系数的大小大致相同，所以我们在某些等式乘上$k_i$，使得关系$R_{u, v} = N^{u/2 + (n-v)\alpha_n}$。
    最后我们再计算所有的大小与最大大小$N^{n/2 + n\alpha_n}$的差值，构造矩阵$D$。
    这样我们便完成了矩阵$D$的构造，同时设矩阵$D$里面指数的乘积为$\beta_n = x+y\alpha_n$，这样有
    $$
    det(L_n) \approx N^{n2^{n-1} + x + y\alpha_n}
    $$
    则有
    $$
    N^{n/2 + n\alpha_n} < (1/c_n)\left(N^{n2^{n-1} + x + y\alpha_n}\right)^{1/2^n}
    $$
    对于小$c_n$，有
    $$
    \alpha_n < \frac{x}{n2^n - y} - \epsilon^{'}
    $$
    所以我们要想让$\alpha_n$更大就需要让$x$和$y$更大，这意味着我们要选取更多的$v$和更小的$u$。比如在$n=2$的情况我们选取$W_1, G_{1, 2}, W_1W_2$而不是$W_1, W_2, W_1W_2$因为前者$\beta_2 = 5/2 + \alpha$而后者$\beta_2 = 2$。
* 到这里，其实已经讲清楚了扩展维纳攻击的整个流程，如何选择复合关系，如何构造格，如何构造矩阵$D$以及如何求解。在原文的文末也给出了$n\le 5$时候的选择关系表。
    这里我也给出$n\le8$的选择关系以及$n=6$时候构造的矩阵以供验证自己是否能够编写出选择关系式的逻辑代码。
    ```txt
    -
    W(1)
    G(1, 2)
    W(1)W(2)
    G(1, 3)
    W(1)G(2, 3)
    W(2)G(1, 3)
    W(1)W(2)W(3)
    G(1, 4)
    W(1)G(2, 4)
    G(1, 2)G(3, 4)
    G(1, 3)G(2, 4)
    W(1)W(2)G(3, 4)
    W(1)W(3)G(2, 4)
    W(2)W(3)G(1, 4)
    W(1)W(2)W(3)W(4)
    G(1, 5)