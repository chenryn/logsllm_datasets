Express (1 KiB)
Sabre-M (1 KiB)
Express (32 KiB)
Sabre-M (32 KiB)
214
216
Number of mailboxes (ùëõ)
212
28
24
20
d
n
o
c
e
s
/
s
e
i
r
e
u
Q
218
212
Riposte
3-party SNIP
2-party SNIP
(2 + 1)-PC
214
216
Number of buckets (ùëõ)
218
(a) Sabre-M vs. Express (1 KiB & 32 KiB messages)
(b) Sabre-BB vs. Riposte (256 byte messages)
Fig. 7: Comparison among Sabre variants, Riposte, and Express when all requests are valid.
Express
Sabre-M
DPF : address ‚áî 2 : 2
DPF : address ‚áî 4 : 0
216
214
212
210
28
26
24
22
216
214
212
210
28
26
24
22
d
n
o
c
e
s
/
s
e
i
r
e
Qu
DPF : address ‚áî 3 : 1
216
214
212
210
28
26
24
22
DPF : address ‚áî 0 : 4
DPF : address ‚áî 1 : 3
216
214
212
210
28
26
24
22
216
214
212
210
28
26
24
22
20
40
80
% bad requests
60
100
20
40
80
% bad requests
60
100
20
40
80
% bad requests
60
100
20
40
80
% bad requests
60
100
20
40
80
% bad requests
60
100
Fig. 8: Varying the percentage of malformed queries for DPFs of size 216 and message size of 10 KiB. Notice the
log-scaling on the ùë¶-axis.
malformed. In the leftmost plot, all bad requests have valid
addresses but malformed DPFs; in the next plot, one in four
have invalid addresses; and so on until the rightmost plot
where all bad requests have invalid addresses. The ùë¶-axis
tracks how many incoming queries (whether ‚Äúgood‚Äù or ‚Äúbad‚Äù)
each protocol was able to process per second.
Notice that, in all cases, throughput actually increases with
the proportion of malformed DPFs, since the servers can stop
processing immediately if auditing fails. (The effect is more
pronounced for Sabre because of its faster auditing.) When
the proportion of requests with invalid addresses increases,
the throughput for Express plummets, while the throughput
for Sabre-M skyrockets. This results from the extremely low
cost of the PRF-based address check that Sabre-M employs.
These findings confirm that Sabre-M performs significantly
better than Express in the presence of a DoS attack.
Atom: Kwon, Corrigan-Gibbs, Devadas, and Ford present
Atom [21], an anonymous microblogging service in the
sender-anonymous bulletin-board model. Atom is notable
for its use of sharding and public-key techniques to support
anonymous broadcasting of ‚Äúshort‚Äù (Tweet-sized) messages
in the presence of actively malicious servers.
XRD: Kwon, Lu, and Devadas present XRD [22], a scalable
end-to-end messaging system. XRD is notable for its use
of parallel mixes and so-called aggregate hybrid shuffles to
achieve high throughput relative to Pung and Atom.
Talek: Cheng, Scott, Masserova, Zhang, Goyal, Anderson,
Krishnamurthy, and Parno present Talek [8], a group mes-
saging system in the anonymous mailbox model. Talek is
notable for its use of information-theoretic PIR techniques
to achieve access sequence indistinguishability under weak
non-collusion assumptions.
VIII. Related Work
Before concluding, we summarize some relevant works on
anonymous messaging. We focus on systems that provide
privacy guarantees comparable to those of Sabre, as opposed
to schemes like Vuvuzela [26], Stadium [25], or Karaoke [23],
which tackle similar problems while providing only differen-
tial privacy-like anonymity guarantees.
Pung: Angel and Setty present Pung [3], a single-server
messaging protocol built from computationally private in-
(CPIR). Pung is notable for its low
formation retrieval
writing costs (though its reliance on CPIR renders reading
expensive) and absence of multiple servers, and resulting
non-collusion assumptions.
IX. Conclusion
We presented Sabre, a family of SAM protocols with
instances operating in both the sender-anonymous mailbox
model (Sabre-M) and the sender-anonymous bulletin-board
model (Sabre-BB). Sabre improves on the state-of-the-art sys-
tems in both models via several innovations that improve not
only its concrete performance and scalability under ‚Äúideal‚Äù
circumstances but also its resilience to resource exhaustion-
style DoS attacks in the sender-anonymous mailbox model.
Our implementation and experimental analysis indicate that
Sabre can feasibly scale to anonymity sets in the tens of
millions and beyond.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 14:58:18 UTC from IEEE Xplore.  Restrictions apply. 
131965
References
[1] Martin R. Albrecht, Christian Rechberger, Thomas Schneider, Tyge
Tiessen, and Michael Zohner. Ciphers for MPC and FHE.
Advances in Cryptology: Proceedings of EUROCRYPT 2015 (Part I),
volume 9056 of LNCS, pages 430‚Äì454, Sofia, Bulgaria (Apr. 2015).
In
[2] Nikolaos Alexopoulos, Aggelos Kiayias, Riivo Talviste, and Thomas
Zacharias. MCMix: Anonymous messaging via secure multiparty
computation.
In Proceedings of USENIX Security 2017, pages 1217‚Äì
1234, Vancouver, BC, Canada (August 2017).
[3] Sebastian Angel and Srinath T. V. Setty. Unobservable communica-
tion over fully untrusted infrastructure. In Proceedings of OSDI 2016,
pages 551‚Äì569, Savannah, GA, USA (Nov. 2016).
[4] Donald Beaver. Efficient multiparty protocols using circuit random-
In Advances in Cryptology: Proceedings of CRYPTO 1991,
ization.
volume 576 of LNCS, pages 420‚Äì432, Santa Barbara, CA, USA (Aug.
1991).
[5] Elette Boyle, Niv Gilboa, and Yuval Ishai. Function secret sharing.
In Advances in Cryptology: Proceedings of EUROCRYPT 2015 (Part II),
volume 9057 of LNCS, pages 337‚Äì367, Sofia, Bulgaria (Apr. 2015).
[6] Elette Boyle, Niv Gilboa, and Yuval Ishai. Function secret sharing:
In Proceedings of CCS 2016, pages
Improvements and extensions.
1292‚Äì1303, Vienna, Austria (Oct. 2016).
[7] Melissa Chase, David Derler, Steven Goldfeder, Claudio Orlandi,
Sebastian Ramacher, Christian Rechberger, Daniel Slamanig, and
Greg Zaverucha. Post-quantum zero-knowledge and signatures from
symmetric-key primitives.
In Proceedings of CCS 2017, pages 1825‚Äì
1842, Dallas, TX, USA (Oct. 2017).
[8] Raymond Cheng, William Scott, Elisaweta Masserova, Irene Zhang,
Vipul Goyal, Thomas E. Anderson, Arvind Krishnamurthy, and
Bryan Parno. Talek: Private group messaging with hidden access
patterns.
In Proceedings of ACSAC 2020, pages 84‚Äì99, Austin, TX,
USA (Dec. 2020).
[9] Benny Chor, Eyal Kushilevitz, Oded Goldreich, and Madhu Sudan.
Private information retrieval. Journal of the ACM (JACM), 45(6):965‚Äì
981, Nov. 1998.
[10] Henry Corrigan-Gibbs and Dan Boneh. Prio: Private, robust, and
scalable computation of aggregate statistics. In Proceedings of USENIX
Security 2017, pages 259‚Äì282, Boston, MA, USA (Mar. 2017).
[11] Henry Corrigan-Gibbs, Dan Boneh, and David Mazi√®res. Riposte:
An anonymous messaging system handling millions of users.
In
Proceedings of IEEE S&P 2015, pages 321‚Äì338, San Jose, CA, USA
(May 2015).
[12] Roger Dingledine, Nick Mathewson, and Paul F. Syverson. Tor:
In Proceedings of USENIX
The second-generation onion router.
Security 2004, San Diego, CA, USA (Aug. 2004).
[13] Wenliang Du and Mikhail J. Atallah. Protocols for secure remote
database access with approximate matching. In E-Commerce Security
and Privacy (Part II), volume 2 of Advances in Information Security,
pages 87‚Äì111, Feb. 2001.
[14] Saba Eskandarian, Henry Corrigan-Gibbs, Matei Zaharia, and
Dan Boneh. Express: Lowering the cost of metadata-hiding
communication with cryptographic privacy. In Proceedings of USENIX
Security 2021, Vancouver, BC, Canada (Aug. 2021).
[15] Amos Fiat and Adi Shamir. How to prove yourself: Practical
solutions to identification and signature problems.
Cryptology: Proceedings of CRYPTO 1986, volume 263 of LNCS, pages
186‚Äì194, Santa Barbara, CA, USA (Aug. 1986).
In Advances in
[16] Irene Giacomelli, Jesper Madsen, and Claudio Orlandi. ZKBoo:
Faster zero-knowledge for boolean circuits. In Proceedings of USENIX
Security 2016, pages 1069‚Äì1083, Austin, TX, USA (Aug. 2016).
[17] Niv Gilboa and Yuval Ishai. Distributed point functions and their
In Advances in Cryptology: Proceedings of EURO-
applications.
CRYPT 2014, volume 8441 of LNCS, pages 640‚Äì658, Copenhagen,
Denmark (May 2014).
[18] Ryan Henry and Adithya Vadapalli. dpf++; version 0.0.1 [computer
software]. Available from: https://www.github.com/rh3nry/
dpfplusplus, July 2019.
[19] Yuval Ishai, Eyal Kushilevitz, Rafail Ostrovsky, and Amit Sahai. Zero-
knowledge from secure multiparty computation.
STOC 2007, pages 21‚Äì30, San Diego, CA, USA (June 2007).
In Proceedings of
[20] Jonathan Katz, Vladimir Kolesnikov, and Xiao Wang.
Improved
non-interactive zero knowledge with applications to post-quantum
signatures. In Proceedings of CCS 2018, pages 525‚Äì537, Toronto, ON,
Canada (Oct. 2018).
[21] Albert Kwon, Henry Corrigan-Gibbs, Srinivas Devadas, and Bryan
Ford. Atom: Horizontally scaling strong anonymity. In Proceedings of
SOSP 2017, pages 406‚Äì422, Shanghai, China (Oct. 2017).
[22] Albert Kwon, David Lu, and Srinivas Devadas. XRD: Scalable
messaging system with cryptographic privacy.
NSDI 2020, pages 759‚Äì776, Santa Clara, CA, USA (Feb. 2020).
[23] David Lazar, Yossi Gilad, and Nickolai Zeldovich. Karaoke:
In Proceedings of
Distributed private messaging immune to passive traffic analysis.
In Proceedings of OSDI 2018, pages 711‚Äì725, Carlsbad, CA, USA (Oct.
2018).
[24] S. M. Matyas, C. H. Meyer, and J. Oseas. Generating strong one-way
functions with cryptographic algorithm.
Bulletin, 27(10A):5658‚Äì565, Mar. 1985.
IBM Technical Disclosure
[25] Nirvan Tyagi, Yossi Gilad, Derek Leung, Matei Zaharia, and Nickolai
Zeldovich. Stadium: A distributed metadata-private messaging
system. In Proceedings of SOSP 2017, pages 423‚Äì440, Shanghai, China
(Oct. 2017).
[26] Jelle van den Hooff, David Lazar, Matei Zaharia, and Nickolai
Zeldovich. Vuvuzela: Scalable private messaging resistant to traffic
analysis. In Proceedings of SOSP 2015, Monterey, CA, USA (Oct. 2015).
Appendix
A. Proof of Observation 1 (from Section II-A)
Observation 1 (Restatement). If a tree is rooted at a 0-node,
then all of its leaves are of type 0; if it is rooted at a 1-node,
then exactly one of its leaves is of type 1 and all others are of
type 0.
Proof. The proof that all leaves of a tree rooted at a 0-node
are of type 0 is trivial; the proof that a tree rooted at a 1-node
has exactly one type-1 leaf with all others being of type 0 is
by induction on the height ‚Ñé of the tree. The base case ‚Ñé = 0
follows immediately from the definition of a 1-node. For the
inductive step, suppose that every height-‚Ñé tree with a type-1
root has exactly one type-1 leaf with all other leaves being of
type 0. Given a height-(‚Ñé + 1) tree with a type-1 root, there