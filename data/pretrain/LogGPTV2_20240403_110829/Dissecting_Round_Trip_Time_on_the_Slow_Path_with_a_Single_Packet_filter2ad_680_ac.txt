e
D
]
s
m
[
25
20
15
10
5
0
−5
09:55
09:57
09:59
10:01
Time
F
D
C
1
0.8
0.6
0.4
0.2
0
0
10:03
10:05
2
AS2907 RTT contribution / RTT entire path
Our Approach
Ping
1.5
0.5
1
(a) Diﬀerence between the average RTTs
up to the destination and up to the last
hop within AS2907.
(b) AS2907 RTT contribution as fraction
of the entire RTT.
Fig. 6. Isolating the RTT contribution of AS2907 over the path of Fig.1(a)
Home network contribution to the RTT. The impact of home networks on Inter-
net performance has recently attracted an increasing interest from the research
community [6, 27]. However, classic diagnostic tools or simply probing the home
gateway are not always able to reliably state if the home network is the cause of
the performance degradation [7].
When the home gateway behaves as a compliant node, our approach allows
us to evaluate the RTT toward any destination, as well as the contribution of
the home network, by using a single packet probe. 7 As a case study, we moni-
tored the RTT toward a top-ranked Italian journal website (repubblica.it). The
monitored home network is connected to the Internet via an ADSL connection
provided by Telecom Italia. The laptop in charge of monitoring is connected via
Wi-Fi to a NETGEAR DGN2200v3, a common commercial modem-router compli-
(cid:2)
(cid:2)WDDW packet probes
ant with our approach. To monitor the RTT, we used D
where W is the private address of the modem-router: We approximate the home
network contribution as RTTS,D(S, W).
Fig. 7(a) shows the trend over time of the RTT chunks. In the beginning, the
home network is unloaded. However, from 9:14 to 9:23, another Wi-Fi connected
host started downloading and uploading large ﬁles through the Internet. Dur-
ing the overloaded period, the RTT grows in median by 356% (from 69.8 ms to
249 ms) but the home network played just a marginal role (see Fig. 7(b)). On
average, packets spent 4.7% and 2.6% of the entire RTT within the home net-
work during the unloaded and overloaded period, respectively. At the same time,
we observed spurious latency spikes inside the home network probably caused
by the packet-by-packet impact of contention-induced transmission delays over
the wireless link (these spikes disappear on the wired connection). In the worst
cases, the spikes represent more than 60% of the total RTT experienced in both
7 In these experiments, the precise border of the home network clearly depends on
when and how the home router handles the IP option. For instance, if the home
router inserts its own timestamp before putting the probe on an overloaded buﬀer
(an instance of home network buﬀerbloat), such buﬀering delay is not included in
the home network contribution.
96
P. Marchetta et al.
]
s
m
i
[
s
k
n
u
h
C
e
m
T
p
i
r
T
d
n
u
o
R
1000
800
600
400
200
0
Remaining Path
Home Network
1
0.8
0.6
0.4
0.2
F
D
C
09:14
09:21
Sending Time
09:28
0
10−3
1000
]
s
m
i
[
k
n
u
h
C
e
m
T
p
i
r
T
d
n
u
o
R
800
600
400
200
0
12:38
12:40
Entire Period
Unloaded Period
Overloaded Period
10−1
100
10−2
Home Network RTT chunk / Entire RTT
Last Mile
Home Network
12:46
12:48
12:42
12:44
Sending Time
(a) RTT chunks over time.
(b) Home network RTT
(c) Home network RTT
Another host transferred large
contribution as a fraction of
contribution over last mile.
ﬁles from 9:14 to 9:23.
the entire RTT.
Fig. 7. Home network RTT contribution toward repubblica.it monitored through a
wireless link and an ADSL connection.
the unloaded and overloaded period. These results suggest that the stable per-
formance degradation observed during the overloaded period is not caused by
the home network but by congestion of the last mile.8 Indeed, by replicating
the experiment while monitoring the RTT on the last mile and isolating the
home network contribution, we observed that downloading and uploading large
ﬁles through the Internet does not aﬀect the intra-home network delay while it
determines a dramatic growth of the delay on the last mile (see Fig. 7(c)).
4 Conclusion
We presented an approach using a single packet to accurately dissect the RTT on
the slow path in chunks mapped to speciﬁc portions of the end-to-end path. We
observed how using other techniques based on ping and traceroute to this end
may provide misleading results. Our approach uses the IP Timestamp option
and a compliant router along the path. A large-scale measurement study we
performed from 116 vantage points comprising 223K traced paths showed that
2.5 router per path on average are compliant. As preliminary evidence of the
use of our approach, we presented two case studies, showing how it allows us to
isolate the RTT contribution of the home network and of an entire AS.
Acknowledgements. This work is partially funded by the MIUR projects:
PLATINO (PON01 01007), SMART HEALTH (PON04a2 C), and S2−MOVE
(PON04a3 00058).
References
1. Almes, G., Kalidindi, S., Zekauskas, M.: A round-trip delay metric for IPPM.
Technical report, RFC 2681 (September 1999)
2. Augustin, B., et al.: Avoiding traceroute anomalies with Paris traceroute. In: ACM
SIGCOMM IMC, pp. 153–158. ACM (2006)
3. Bavier, A., et al.: Operating system support for planetary-scale network services.
In: NSDI (2004)
4. Cymru, T.: (2012), http://www.team-cymru.org/Services/ip-to-asn.html
8 The physical connection between a customer’s home and the DSLAM or the CMTS.
Dissecting Round Trip Time on the Slow Path with a Single Packet
97
5. de Donato, W., Marchetta, P., Pescap´e, A.: A hands-on look at active probing
using the IP prespeciﬁed timestamp option. In: Taft, N., Ricciato, F. (eds.) PAM
2012. LNCS, vol. 7192, pp. 189–199. Springer, Heidelberg (2012)
6. DiCioccio, L., Teixeira, R., May, M., Kreibich, C.: Probe and pray: Using UPnP for
home network measurements. In: Taft, N., Ricciato, F. (eds.) PAM 2012. LNCS,
vol. 7192, pp. 96–105. Springer, Heidelberg (2012)
7. DiCioccio, L., Teixeira, R., Rosenberg, C.: Impact of home networks on end-to-end
performance: controlled experiments. In: ACM HomeNets (2010)
8. Ferguson, A., Fonseca, R.: Inferring router statistics with IP timestamps. In: ACM
CoNEXT Student Workshop (2010)
9. Fonseca, R., Porter, G., Katz, R., Shenker, S., Stoica, I.: IP options are not an
option, Univ. of California, Berkeley (2005)
10. Fransson, P., Jonsson, A.: End-to-end measurements on performance penalties of
IPv4 options. In: IEEE GLOBECOM (2004)
11. Govindan, R., Paxson, V.: Estimating router ICMP generation delays. In: PAM
(2002)
12. He, Y., Faloutsos, M., Krishnamurthy, S.: Quantifying routing asymmetry in the
Internet at the AS level. In: IEEE GLOBECOM (2004)
13. Hyun, Y., Broido, A., et al.: On third-party addresses in traceroute paths. In:
“Passive and Active Measurement” Workshop 2003 (2003)
14. Katz-Bassett, E., et al.: Reverse traceroute. In: NSDI (2010)
15. Madhyastha, H.V.: An information plane for Internet applications. UW dissertation
(2008)
16. Madhyastha, H.V., Katz-Bassett, E., Anderson, T., Krishnamurthy, A., Venkatara-
mani, A.: iPlane Nano: Path prediction for peer-to-peer applications. In: NSDI (2009)
17. Marchetta, P., de Donato, W., Pescap´e, A.: Detecting third-party addresses in
traceroute traces with IP timestamp option. In: Roughan, M., Chang, R. (eds.)
PAM 2013. LNCS, vol. 7799, pp. 21–30. Springer, Heidelberg (2013)
18. Marchetta, P., Persico, V., Katz-Bassett, E., Pescap´e, A.: Don’t trust traceroute
(completely). In: ACM CoNEXT Student Workshop (2013)
19. Marchetta, P., Persico, V., Pescap´e, A.: Pythia: yet another active probing tech-
nique for alias resolution. In: ACM CoNEXT, pp. 229–234 (2013)
20. Marchetta, P., Pescap`e, A.: Drago: Detecting, quantifying and locating hidden
routers in traceroute IP paths. In: IEEE Global Internet Symposium (2013)
21. Pelsser, C., Cittadini, L., Vissicchio, S., Bush, R.: From Paris to Tokyo: On the
suitability of ping to measure latency. In: IMC 2013, pp. 427–432. ACM (2013)
22. Postel, J.: Internet protocol: DARPA Internet program protocol speciﬁcation. RFC
791 (1981)
23. Schwartz, Y., Shavitt, Y., Weinsberg, U.: On the diversity, stability and symmetry
of end-to-end Internet routes. In: IEEE INFOCOM Workshops (2010)
24. Sherry, J.: Applications of the IP timestamp option to Internet measurement. Un-
dergraduate Honor Thesis (2010)
25. Sherry, J., Katz-Bassett, E., Pimenova, M., Madhyastha, H., Anderson, T., Krish-
namurthy, A.: Resolving IP aliases with prespeciﬁed timestamps. In: ACM SIG-
COMM IMC (2010)
26. Sherwood, R., Spring, N.: Touring the Internet in a TCP sidecar. In: ACM SIG-
COMM IMC, pp. 339–344. ACM (2006)
27. Sundaresan, S., de Donato, W., Feamster, N., Teixeira, R., Crawford, S., Pescap`e,
A.: Broadband Internet performance: A view from the gateway. SIGCOMM
2011 41(4), 134 (2011)
28. Zeng, H., Kazemian, P., Varghese, G., McKeown, N.: A survey on network trou-
bleshooting. Technical report, TR12-HPNG-061012, Stanford University (2012)