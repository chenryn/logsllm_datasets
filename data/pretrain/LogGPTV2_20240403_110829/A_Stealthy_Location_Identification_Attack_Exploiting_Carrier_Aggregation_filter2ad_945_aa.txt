title:A Stealthy Location Identification Attack Exploiting Carrier Aggregation
in Cellular Networks
author:Nitya Lakshmanan and
Nishant Budhdev and
Min Suk Kang and
Mun Choon Chan and
Jun Han
A Stealthy Location Identification Attack Exploiting 
Carrier Aggregation in Cellular Networks
Nitya Lakshmanan and Nishant Budhdev, National University of Singapore; Min 
Suk Kang, KAIST; Mun Choon Chan and Jun Han, National University of Singapore
https://www.usenix.org/conference/usenixsecurity21/presentation/lakshmanan
This paper is included in the Proceedings of the 30th USENIX Security Symposium.August 11–13, 2021978-1-939133-24-3Open access to the Proceedings of the 30th USENIX Security Symposium is sponsored by USENIX.A Stealthy Location Identiﬁcation Attack Exploiting Carrier Aggregation in
Cellular Networks
Nitya Lakshmanan
Nishant Budhdev
Min Suk Kang∗
National University of Singapore
National University of Singapore
KAIST
Mun Choon Chan
Jun Han
National University of Singapore
National University of Singapore
Abstract
We present the SLIC that achieves ﬁne-grained location track-
ing (e.g., ﬁnding indoor walking paths) of targeted cellular
user devices in a passive manner. The attack exploits a new
side channel in modern cellular systems through a universally
available feature called carrier aggregation (CA). CA enables
higher cellular data rates by allowing multiple base stations
on different carrier frequencies to concurrently transmit to a
single user. We discover that a passive adversary can learn the
side channel — namely, the number of actively transmitting
base stations for any user of interest in the same macrocell.
We then show that a time series of this side channel can consti-
tute a highly unique ﬁngerprint of a walking path, which can
be used to identify the path taken by a target cellular user. We
ﬁrst demonstrate the collection of the new side channel and a
small-scale path identiﬁcation attack in an existing LTE-A net-
work with up to three CA capability (i.e., three base stations
can be coordinated for concurrent transmission), showing the
feasibility of SLIC in the current cellular networks. We then
emulate a near-future 5G network environment with up to
nine CA capability in various multi-story buildings in our
institution. SLIC shows up to 98.4% of path-identiﬁcation
accuracy among 100 different walking paths in a large ofﬁce
building. Through testing in various building structures, we
conﬁrm that the attack is effective in typical ofﬁce building
environments; e.g., corridors, open spaces. We present com-
plete and partial countermeasures and discuss some practical
cell deployment suggestions for 5G networks.
1 Introduction
LTE, the global de facto standard of mobile broadband ser-
vices [1], is designed to prevent direct leakage of private
location information of its mobile user devices [2]. However,
recent studies demonstrate that adversaries can infer the lo-
cations of targeted individuals [3, 4]. Fortunately, existing
location privacy attacks in cellular systems have limitations
such as inferring only coarse-grained (e.g., macrocell level)
location information [3], or requiring the installation of mal-
ware on victims’ phones [4].
In this paper, we present SLIC1, a novel location inference
attack that overcomes such limitations of the prior attacks
and accurately identiﬁes the walking path taken by a target
user. To the best of our knowledge, SLIC is the ﬁrst attack on
cellular networks shown to be effective in indoor, multi-story
building environments without requiring any malware on the
target user’s phone. SLIC exploits a new side channel in the
multi-carrier transmission (also known as carrier aggregation
or CA; see §2) — i.e., the number of actively transmitting
base stations for concurrent multi-band transmission — in
modern cellular networks.
The proposed SLIC attack relies on two crucial observa-
tions. First, cellular networks produce a speciﬁc time-series of
the above-mentioned side channel when an individual walks
a path. This pattern is path speciﬁc and is distinguishable
from the patterns observed when walking other paths. We
call such unique patterns path ﬁngerprints. Each path exhibits
a highly unique ﬁngerprint because the invariant physical
environment (e.g., building architecture) surrounding each
walking path affects the radio-frequency (RF) signal qual-
ity at each location on the path. As a result, if an adversary
records in advance a path ﬁngerprint as she walks a speciﬁc
path, she can identify with high probability whether a target
user travels the same path. Second, the side channel of any
active users in a macrocell is publicly available since it is
broadcast unencrypted; see 3GPP TS 36.321 [5]. Hence, any
passively-monitoring adversary with commodity tools (e.g.,
open-source LTE tools [6]) in the same macrocell (e.g., 0.4 to
2 kilometers radius) can obtain the ﬁngerprints, rendering our
attack highly stealthy and easily accessible. We have reported
our ﬁndings to GSMA through the coordinated vulnerability
disclosure (CVD) program and they are under review as of
September 2020.
To design and evaluate accurate location inference, we
∗Corresponding author.
1Stealthy Location Identiﬁcation Attack exploiting Carrier Aggregation
USENIX Association
30th USENIX Security Symposium    3899
address three main technical challenges. First, the compar-
ison between path ﬁngerprints is not straightforward when
applying standard techniques for comparing two time series
data. The standard dynamic time warping (DTW) technique
to compute the similarity between two ﬁngerprints removes
the absolute values in ﬁngerprints by normalizing them. The
problem is that the normalization of the side channel values
can also remove the physical location information of a target
user. For example, if a side channel value is seven at a cer-
tain time, it means the user is at one of the few spots where
seven cells are available for concurrent download. Normaliz-
ing this absolute value loses such critical location information.
Thus, instead, we use an absolute-value DTW technique and
preserve the location information during classiﬁcation (§4).
Another technical challenge is to handle the potential noise
in the side channel. The side channel we exploit is shown to
reliably capture the number of available base stations around
a target user when the user is actively downloading (see §3
for several practical attack strategies to trigger downlink ac-
tivities of a target user). However, this may not be always
possible. The side channel may become noisy when a target
user requires fewer than the maximum available base stations
around him; e.g., only a single base station might be required
regardless of where on a path a user is located when downlink
activity is low. We address this by explicitly modeling the
limited downlink activity of a target user. To be speciﬁc, we
use a single integer-value parameter to model the maximum
number of activated secondary cells required for a user. We
then calibrate each ﬁngerprint record with respect to this pa-
rameter and match with the target’s ﬁngerprint (§4). We show
that with this calibration, our attack still identiﬁes paths with
only modest degradation in attack accuracy because the cali-
brated ﬁngerprints reliably capture the unique dead spots (i.e.,
locations with only a small number of available base stations)
in many walking paths in practice (§8).
The last challenge is that the full extent of the SLIC at-
tack cannot be evaluated in the existing cellular networks.
Although our small-scale experiment in an existing LTE-A
network with only three CA capability (§5) shows promising
results (e.g., 50.1% of path identiﬁcation accuracy among
eight different outdoor paths), our attack is expected to be
most effective in a near-future cellular network (e.g., 5G) with
highly dense small-cell deployments [7] for larger downlink
bandwidth. Such highly dense small-cell networks, however,
do not yet exist as of 2020. To that end, we develop a novel Wi-
Fi-to-5G evaluation framework that translates a real-world ex-
periment with existing densely-deployed Wi-Fi access points
into the emulated 5G cellular network experiment results (§6).
We argue that this cross-technology conversion ensures a re-
alistic evaluation of dense 5G small cells because they are
often designed to be indistinguishable from the existing Wi-Fi
systems when the two systems coexist in the same frequency
band; see TR 36.889 [8] and a related whitepaper [9].
Our extensive evaluation with an emulated cellular network
with nine CA capability in multi-story buildings shows that
the SLIC is highly effective in typical ofﬁce buildings (§7).
When we exhaustively search and select 100 different walking
paths in a large building, we achieve up to 98.4% of path-
identiﬁcation accuracy. We extend the experiment to various
types of buildings (e.g., corridors, open spaces, shared ﬂoors)
and show that the SLIC is highly effective in the ﬁrst two ofﬁce
building types (§8). Additionally, we empirically conﬁrm that
the ﬁngerprinting mechanism is robust to minor perturbation
(e.g., transmit-power control) of RF measurements.
Finally, we provide a number of countermeasures against
the SLIC, including some suggested changes to the 3GPP
standards and two partial (but readily available) countermea-
sures (§9). We also brieﬂy discuss cell deployment sugges-
tions for 5G networks so that the risk of location information
leakage can be considered early in the cell planning stage.
2 Carrier Aggregation and New Side Channel
In this section, we ﬁrst present carrier aggregation technol-
ogy that is required to understand the SLIC attack. We then
introduce the new side channel and its real-world examples.
2.1 Carrier Aggregation for Higher Rates
Traditionally, cellular network users are served by a single
base station, called a primary cell. In 2010, to keep up with
increasing data consumption, 3GPP introduced a new feature
called carrier aggregation (CA). CA allows users to connect
to one or more additional base stations, called secondary cells,
to achieve higher data rates [10]. With CA, a user is connected
to a primary cell for control messaging as well as connected
to multiple secondary cells for downlink transmissions.
In the initial releases, 3GPP speciﬁcations supported a max-
imum of four secondary cells [11]. More recently, it has been
extended to a maximum of 31 secondary cells (including
aggregation of the unlicensed spectrum [12]). We observe
ﬂagship phones in the market with increasing CA capabili-
ties (e.g., seven CA supported in Galaxy S20 [13] compared
to ﬁve CA in Samsung Galaxy S8 [14]). Operators around
the world deploy and extensively utilize CA with several sec-
ondary cells (e.g., three CA and four CA capabilities in Singa-
pore and South Korea, respectively). The trend of supporting
higher CA certainly exists.
Figure 1 illustrates how CA is conﬁgured and activated
for a user device.2 We divide the CA operation into three
components: conﬁguration, activation, and transmission.
CA conﬁguration. First, a user equipment (UE) measures the
signal strength of all nearby secondary cells and sends these
2For brevity and easier understanding, we abuse the terminology a lit-
tle and refer to the conﬁguration and activation of secondary cells as CA
conﬁguration and CA activation, respectively. For example, three CA con-
ﬁguration/activation refers to two secondary cell conﬁguration/activation in
addition to one default primary cell.
3900    30th USENIX Security Symposium
USENIX Association
primary cell 
(e.g., eNodeB, gNodeB)
CA configuration
UE physical location
CA activation
Downlink activity in a macrocell
ü Target UE’s downlink activity
ü Other UEs’ downlink activity
secondary cell channel measurements
(encrypted     )
mapping:
ü cell IDs #452
#209
#398
#102
ü indices
1
2
3
4
secondary cell configuration
(in plaintext)
secondary cell activation bits
Figure 2: A diagram that illustrates the logical depen-
dency between the CA operations and the UE physical lo-
cation/downlink activity.
corresponding cells, resulting in a larger aggregate data rate.
5
4
2
6
1
7
0 0 0 1 0 1 1
3
0
downlink 
activity
2.2 The New Side Channel
secondary cells
#398
#209
#102
#452
channel
estimation
UE
configuration
(infrequent)
activation
(frequent)
secondary cell
transmission
secondary cell activation
(in plaintext)
#102
#209
#452
data
data
data
UE is being served by 
three secondary cells
passive adversary
Figure 1: A simpliﬁed illustration showing how secondary
cells are conﬁgured and activated for higher capacity.
measurement reports back to its primary cell. The primary cell
applies the secondary-cell conﬁguration algorithm (omitted
from Figure 1; see §6.2 for more details) to determine the sec-
ondary cells that can be used for downlink transmission. The
primary cell assigns each conﬁgured secondary cell a unique
index so that they can be easily activated later for data trans-
mission (see Section 5.3.10.3(b) in 3GPP TS 36.331 [15]);
see the example in Figure 1 where four secondary cells are
assigned four indices. Note that the conﬁguration messages
are encrypted and thus an unauthorized adversary cannot
learn the CA conﬁguration (see Appendix A6 in 3GPP TS
36.331 [15]).
CA activation. After the secondary cells are conﬁgured for
a UE, it can be activated for downlink transmission at any
time. In the example shown in Figure 1, as the primary cell
receives some downlink trafﬁc for the UE, it activates a subset
of the conﬁgured secondary cells. The activation is made via
a compact (8-bit or 32-bit) activation bitmap MAC control
element (MAC CE) where each bit corresponds to the con-
ﬁgured secondary cell index (see Section 6.1.3.8 in 3GPP
TS 36.321 [5]). Bits set as 1 indicates the activation of the
corresponding conﬁgured secondary cell and set as 0 indi-
cates deactivation. Note that activation bitmaps are sent to
each UE frequently (e.g., 4-8 ms) whenever the secondary
cell activation changes. The activation bitmaps are sent in
plaintext unlike the conﬁguration messages; therefore, any
unauthorized adversary, who is in the communication range
of a primary cell, can easily learn the number of activated sec-
ondary cells for a UE simply by counting 1-bits in a bitmap.
Downlink transmission. Following the activation bitmaps,
the UE decodes the scheduling information from the control
channel and receives the downlink transmission from the
The new side channel found in the CA operation is the number
of activated secondary cells for each UE, as shown in Figure 1.
This side channel information can be easily obtained by unau-
thorized passive adversaries since it is broadcast unencrypted.
The adversary can modify open-source tools [6] and utilize
commodity software-deﬁned radio devices [16] to decode the
control and data channel to obtain the activation bitmap.
Location dependency. Perhaps the most desired property of
this side channel for the SLIC attack is its dependency on
a target UE’s location. Figure 2 visualizes this dependency.
CA conﬁguration exclusively depends on a target UE’s lo-
cation because it is determined by the distance from nearby
secondary cells.
CA activation is also affected by the UE location because
the activated cells are strictly a subset of the conﬁgured cells;
yet, it is also dependent on the downlink activities in the pri-
mary cell. First, it is dependent on the target UE’s downlink
activity because secondary cells are activated only when there
is a need for downlink transmission for the target UE. More-
over, CA activation can be additionally affected by the overall
load of the cellular system; e.g., the CA activation for the
target UE may vary depending on how the secondary cells
are already used for other UEs’ downlink activities.
It is imperative to ensure that CA activation is depen-
dent largely on a target UE’s location despite this multi-
dependency. In this paper, we show that it is possible in prac-
tice. First, we suppress the dependency on a target UE’s down-
link activity by triggering the target UE’s download during
the path identiﬁcation; we present a few practical attack strate-
gies in Section 3. Second, we empirically show that the CA
activation in the existing LTE-A networks is strongly depen-
dent on the UE location and less on the load3 of the cellular
system; see our real-world experiments conducted on one of
the cellular networks later in this section.
Side channel and path ﬁngerprints. Although this new side
channel shows a great potential to leak some UE location
information, the side channel itself is insufﬁcient for user
location identiﬁcation attacks. For instance, learning that a
3To test in varying system loads, we perform experiments in different
times of the day and in different days of the week.
USENIX Association
30th USENIX Security Symposium    3901
)
s
p
b
M
(
e
t
a
r
a
t
a
D
s
A
C
f
o
.
o
N
s
A
C
f
o
.
o
N
3
2
1
3
2
1
Time (seconds)
(a) Observed data rate changes in multiple walks
Wednesday 9 AM
Friday 9 AM
0
50
100
150
Wednesday 8 PM
3
2
1
3
2
1
0
50
100
150
Friday 8 PM
0
50
100
150
0
50
100