恶意程式与防毒软体之争
伙计
NISRA 2016
NISRA
教学目的
• 提供同学们资安相关入门知识，并开启同学们资安研究的兴趣
NISRA
要感谢的人太多
那就谢天吧！
NISRA
大纲
• 前言
• 我的电脑中毒了！？
• 什么是恶意程式？
• 恶意程式的三种躲避侦测原理
• 防毒软体的三道防御机制
• 资安相关名词与工具介绍
• 资安防护的迷思
• 补充：JS木马简单分析心得
NISRA
前言
NISRA
前言
NISRA
每一个人心中或多或少，都有中毒恐惧症
NISRA
NISRA
不只祖克伯，FBI 局长也在笔电视讯镜头贴
胶带防偷窥 [科技新报]
NISRA
敌暗我明，草木皆兵
NISRA
我的电脑中毒了！？
• 电脑速度变慢
• 系统不稳定、常当机
• 出现不明视窗、广告
• 首页被绑架
• 防毒软体跳出警告、或“被”消失
• 出现要求付赎金画面
• 用起来很正常
NISRA
什么是恶意程式？
• 影响使用者的电脑
• 影响使用者的资料或财产
• 影响使用者的隐私
安全
NISRA
病毒、特洛伊木马、蠕虫
会偷偷传送使用者资料
会感染或破坏使用者档案
会运用漏洞或网路主动散播自己
NISRA
统称为“恶意程式”
• 病毒、特洛伊木马、蠕虫
• 病毒产生器
• 病毒下载器
• 浏览器绑架
• 广告程式
• 键盘侧录器
• 间谍程式等等
NISRA
恶意程式常见的三种躲避侦测方法
• 加壳
• 加花
• 去除特征
NISRA
加壳
• 保护档案，不被破解
• 加密壳、压缩壳
• 外壳程式包裹著被保护的程式
• 防毒软体无法辨识内容物
• 常见加壳软体—UPX、ASPACK
被保护的档案
NISRA
加花
• 程式码中塞入无意义的指令
• 影响防毒软体的侦测与工程师的
分析
NISRA
加花
• 程式码中塞入无意义的指令
• 影响防毒软体的侦测与工程师的
分析
题目：我的梦想
第一行：请从第四行开始阅读
第二行：请到第412行开始阅读
第三行：请从第五行开始阅读
第四行：请到1+1+sin 90° 行开始阅读
第五行：我梦想每天睡到自然…
NISRA
去除特征
• 修改被防毒厂商定义为特征的程
式码
• 针对特定防毒软体来达成免杀
• 免杀能力强
•
恶意程式
NISRA
防毒软体的三道防御机制
已知病毒侦测
未知病毒侦测
行为侦测
NISRA
已知病毒侦测病毒码
• 防毒软体辨识病毒的基本方法
• 防毒公司会依每个病毒的特征给予独一无二
的病毒特征码
• 不同防毒软体无法通用
NISRA
已知病毒侦测病毒码
NISRA
未知病毒侦测基因侦测、启发式侦测
基因侦测
• 现有已知病毒中，寻找共同的特
征，作为基因侦测病毒码
启发式扫描
• 启发式(Heuristic)是指探索和发现的
行为过程
• 依靠经验，并在失败中不断学习的过
程
• 不倚靠病毒码来检测
• 启发式引擎用本身的规则库，以静态
分析样本代码的方式，来侦测恶意程
式
NISRA
基因侦测
•
假设 3A 20 B2 9C 55 FF 08 13 7B 58 1D -> Trojan
•
假设 3A 20 B2 9C 55 FF 08 ->GEN
•
BC 15 0C 3A 20 B2 9C 55 FF 08 13 7B 58 1D
•
CA 03 14 AA 3A 20 B2 9C 55 FF 08 43 2D FC
NISRA
启发式扫描
 修改注册表
 对外连线
 更改系统档案
 安装驱动程式
 生成新执行档并执行
 删除自己
总分：________
NISRA
行为侦测HIPS主动式入侵防御系统
• hostbased intrusion prevension system
• 现今防毒软体最终且最重要的防御技术
• 监控系统程序，阻止异常行为
NISRA
NISRA
防毒软体的三道防御机制
已知病毒侦测
未知病毒侦测
行为侦测
白名单
NISRA
云端白名单
NISRA
防毒软体的三道防御机制
已知病毒侦测
未知病毒侦测
行为侦测
白名单
静
态
分
析
动
态
分
析
NISRA
资安相关名词与工具介绍
• 防火墙
• 社交工程与网路钓鱼
• 假防毒软体
• Zero Day 漏洞
• 蜜罐
• 沙盘与虚拟机
• AV-TEST 
• VirusTotal
• Payload security
NISRA
防火墙
• 隔离网路，过滤网路中传送的封包
老板：不是有防
火墙吗？
NISRA
社交工程与网路钓鱼
• 获取使用者信任的欺骗行为
• 假冒客服电话
• 假的好友讯息
• 假的官方邮件
• 假的正常网页
• www.staysecureonline.com/staying-safe-online
NISRA
假防毒软体
NISRA
假防毒软体
NISRA
NISRA
NISRA
NISRA
NISRA
NISRA
ZERO-DAY漏洞 (零天漏洞)
• 先前未知、未发现的漏洞
漏洞被
发现
漏洞被
修复
危险期
NISRA
蜜罐
• 具有漏洞的主机
• 吸引骇客的入侵
• 纪录骇客的攻击方式，并收集恶意程式
虚拟机
• 在作业系统上另外在模拟一台虚拟电脑，两者互不影响
硬体
作业系统
虚
拟
机
虚
拟
机
浏
览
器
播
放
器
NISRA
沙箱
• 在当前系统下创造一个虚拟环境(sandbox)
• 在沙盘内运行的程式，所做的修改都会隔离于
沙盘内
• 强力推荐sandboxie
NISRA
单一档案线上扫描工具-VirusTotal
NISRA
线上沙盘分析
NISRA
最后
• 1+1<2
• 养成良好习惯
• 不点奇怪连结、奇怪广告、奇怪信件、奇怪档案
• 随手更新
NISRA