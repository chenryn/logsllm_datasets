âŸ¨xid, vâ„›âŸ©
âŸ¨xid, ğ‘š Â· vâ„›âŸ©
âŸ¨xid, vâ„›âŸ© = ğ‘š.
=
A non-revoked user will be able to correctly decrypt this
ciphertext with overwhelming probability. On the other hand,
a revoked user cannot implement Step (b).
We now consider the (public) tracing procedure. We will
show that given an oracle access to a pirate decoder ğ’Ÿ and a
set ğ’® = {id1, id2, . . . ,} of suspected traitors with |ğ’®| â‰¤ ğ‘¡, it
is possible to find an identity id in the set ğ’¯ of traitors, as
long as ğ’¯ âŠ† ğ’®. Here, we assume â„› âˆ© ğ’® = âˆ… for simplicity.
Given a pirate decoder ğ’Ÿ, our tracing algorithm first finds
a pair of messages ğ‘š and ğ‘šâ€² such that ğ’Ÿ can distinguish the
encryption of ğ‘š and ğ‘šâ€² with noticeable probability. As we
will show in the main body, such a pair can be found effi-
ciently. Then, the tracing algorithm proceeds as follows. Let
us consider a subset of suspect traitors ğ’®ğ‘– = {idğ‘–, idğ‘–+1, . . .}
for ğ‘– = 1, . . . ,|ğ’®|+1. We then generate a probe ciphertext ğ¶ğ’®ğ‘–
associated to ğ’®ğ‘– with the following properties:
âˆ™ The distribution of ğ¶ğ’® corresponds to the normal en-
âˆ™ The distribution of ğ¶âˆ… corresponds to the normal en-
âˆ™ The probes ğ¶ğ’®ğ‘–âˆ’1 and ğ¶ğ’®ğ‘– are indistinguishable with-
cryption of ğ‘š.
cryption of ğ‘šâ€².
out a secret key for idğ‘–âˆ’1.
The tracing algorithm then estimates the distinguishing ad-
vantage of the decoder ğ’Ÿ for ğ¶ğ’®ğ‘–âˆ’1 and ğ¶ğ’®ğ‘– for all ğ‘– âˆˆ
{2, . . . ,|ğ’®| + 1}. It outputs the identity idğ‘–âˆ’1 of the user that
is excluded from ğ’®ğ‘–âˆ’1 to get ğ’®ğ‘– such that the distinguishing
advantage between them is non-negligible.
We prove that the tracing algorithm always outputs some
user in ğ’¯ . To see this, we first observe that by the first
and second properties above, the decoder ğ’Ÿ distinguishes
ğ¶ğ’®1 = ğ¶ğ’® and ğ¶ğ’®|ğ’®|+1 = ğ¶âˆ… with non-negligible advantage.
Therefore, by the triangle inequality, there exists at least
one index ğ‘– such that ğ’Ÿ distinguishes ğ¶ğ’®ğ‘–âˆ’1 and ğ¶ğ’®ğ‘– with
non-negligible advantage. By the third property above, the
identity idğ‘–âˆ’1 indeed corresponds to a traitor.
The above idea is implemented using inner product func-
tional encryption. To create the probe ciphertext, we first
set vğ’® âˆˆ Zâ„“
ğ‘ as follows: If ğ‘– = 1, we set vğ’® = 0; If ğ‘– = |ğ’®| + 1,
we set vğ’®ğ‘– = (ğ‘šâ€² âˆ’ ğ‘š) Â· vâ„› where vâ„› is chosen as in the
ordinary encryption algorithm; Otherwise, we set vğ’®ğ‘– so that
âˆ™ âŸ¨xid, vğ’®ğ‘–âŸ© = 0 for every id âˆˆ ğ’®ğ‘– âˆª â„›,
âˆ™ âŸ¨xid, vğ’®ğ‘–âŸ© = (ğ‘šâ€² âˆ’ ğ‘š) Â· âŸ¨xid, vâ„›âŸ© for every id âˆˆ ğ’®1âˆ–ğ’®ğ‘–.
Note that this can be implemented only if ğ‘Ÿ + ğ‘¡  0.2 The probability of decryption for
a decoder ğ’Ÿ can be estimated by repeatedly querying the
oracle ğ’ªğ’Ÿ with plaintext-ciphertext pairs, using Hoeffdingâ€™s
inequality. Alternatively, we may force the correct decryption
probability to be non-negligibly close to 1, by using an all-
or-nothing transform (see [24]). We also assume that the
decoder ğ’Ÿ is stateless/resettable, i.e., it cannot see and adapt
to it being tested, and replies independently to successive
queries. Handling stateful pirate boxes has been investigated
in [22, 23].
We let the identity space ID and the message space â„³ be
implicit arguments to the setup algorithm below. We let the
secret key space ğ’¦ and the ciphertext space ğ’ (along with ID
and â„³) be implicit public parameters output by the setup
algorithm.
Definition 2.1. A dynamic identity-based trace-and-revoke
scheme (ğ‘¡, ğ‘Ÿ)-ğ’¯ â„› in black-box confirmation model is a tuple
ğ’¯ â„› = (Setup, KeyGen, Enc, Dec, Trace) of five probabilistic
polynomial-time algorithms with the following specifications.
âˆ™ Setup(1ğœ†, 1ğ‘¡, 1ğ‘Ÿ) takes as input the security parame-
ter ğœ†, the bound ğ‘¡ on the size of traitor coalitions and
the bound ğ‘Ÿ on the number of revoked users. It out-
puts (msk, pk, pd) containing the master secret key, the
encryption key and the (initially empty) public direc-
tory pd. We will implicitly assume that pd is available
to all algorithms.