spoofargumentsinx64childprocesses.
Therealargumentsarewrittentothememoryspacethatholdsthefakearguments.Ifthereal
argumentsarelongerthanthefakearguments,thecommandlaunchwillfail.
UserGuide www.helpsystems.com page:70
PostExploitation/BlockingDLLsinChildProcesses
Blocking DLLs in Child Processes
UseblockdllsstarttoaskBeacontolaunchchildprocesseswithabinarysignaturepolicythat
blocksnon-MicrosoftDLLsfromtheprocessspace.Useblockdllsstoptodisablethisbehavior.
ThisfeaturerequiresWindows10.
Upload and Download Files
download-Thiscommanddownloadstherequestedfile.Youdonotneedtoprovidequotes
aroundafilenamewithspacesinit.Beaconisbuiltforlowandslowexfiltrationofdata.
Duringeachcheck-in,Beaconwilldownloadafixedchunkofeachfileitstaskedtoget.
ThesizeofthischunkdependsonBeacon’scurrentdatachannel.TheHTTPandHTTPS
channelspulldatain512KBchunks.
downloads-UsetoseealistoffiledownloadsinprogressforthecurrentBeacon.
cancel-Issuethiscommand,followedbyafilename,tocanceladownloadthat’sinprogress.You
mayusewildcardswithyourcancelcommandtocancelmultiplefiledownloadsatonce.
upload-Thiscommanduploadsafiletothehost.
timestomp-Whenyouuploadafile,youwillsometimeswanttoupdateitstimestampstomake
itblendinwithotherfilesinthesamefolder.Thiscommandwilldothis.Thetimestomp
commandmatchestheModified,Accessed,andCreatedtimesofonefiletoanotherfile.
GotoView->DownloadsinCobaltStriketoseethefilesthatyourteamhasdownloadedsofar.
Onlycompleteddownloadsshowupinthistab.
Downloadedfilesarestoredontheteamserver.Tobringfilesbacktoyoursystem,highlight
themhere,andpressSyncFiles.CobaltStrikethendownloadstheselectedfilestoafolderof
yourchoosingonyoursystem.
File Browser
Beacon’sFileBrowserisanopportunitytoexplorethefilesonacompromisedsystem.Goto
[Beacon]->Explore->FileBrowsertoopenit.
ThefilebrowserwillrequestalistingforthecurrentworkingdirectoryofBeacon.Whenthis
resultarrives,thefilebrowserwillpopulate.
Theleft-handsideofthefilebrowserisatreewhichorganizestheknowndrivesandfoldersinto
oneview.Theright-handsideofthefilebrowsershowsthecontentsofthecurrentfolder.
UserGuide www.helpsystems.com page:71
PostExploitation/TheWindowsRegistry
Figure35.FileBrowser
Eachfilebrowsercachesthefolderlistingsitreceives.Acoloredfolderindicatesthefolder’s
contentsareinthisfilebrowser’scache.Youmaynavigatetocachedfolderswithoutgenerating
anewfilelistingrequest.PressRefreshtoaskBeacontoupdatethecontentsofthecurrent
folder.
Adark-greyfoldermeansthefolder’scontentsarenotinthisfilebrowser’scache.Clickona
folderinthetreetohaveBeacongenerateatasktolistthecontentsofthisfolder(andupdate
itscache).Double-clickonadark-greyfolderintheright-handsidecurrentfolderviewtodothe
same.
Togoupafolder,pressthefolderbuttonnexttothefilepathabovetheright-handsidefolder
detailsview.Iftheparentfolderisinthisfilebrowser’scache,youwillseetheresults
immediately.Iftheparentfolderisnotinthefilebrowser’scache,thebrowserwillgeneratea
tasktolistthecontentsoftheparentfolder.
Right-clickafiletodownloadordeleteit.
Toseewhichdrivesareavailable,pressListDrives.
File System Commands
YoumayprefertobrowseandmanipulatethefilesystemfromtheBeaconconsole.
Usethelscommandtolistfilesinthecurrentdirectory.Usemkdirtomakeadirectory.rmwill
removeafileorfolder.cpcopiesafiletoadestination.mvmovesafile.
The Windows Registry
Usereg_query[x86|x64][HIVE\path\to\key]toqueryaspecifickeyintheregistry.This
commandwillprintthevalueswithinthatkeyandalistofanysubkeys.Thex86/x64optionis
requiredandforcesBeacontousetheWOW64(x86)ornativeviewoftheregistry.reg_query
[x86|x64][HIVE\path\to\key][value]willqueryaspecificvaluewithinaregistrykey.
UserGuide www.helpsystems.com page:72
PostExploitation/KeystrokesandScreenshots
Keystrokes and Screenshots
Beacon’stoolstologkeystrokesandtakescreenshotsaredesignedtoinjectintoanother
processandreporttheirresultstoyourBeacon.
Tostartthekeystrokelogger,usekeyloggerpidx86toinjectintoanx86process.Use
keyloggerpidx64toinjectintoanx64process.Usekeyloggerbyitselftoinjectthekeystroke
loggerintoatemporaryprocess.Thekeystrokeloggerwillmonitorkeystrokesfromtheinjected
processandreportthemtoBeaconuntiltheprocessterminatesoryoukillthekeystrokelogger
post-exploitationjob.
Beawarethatmultiplekeystrokeloggersmayconflictwitheachother.Useonlyonekeystroke
loggerperdesktopsession.
Totakeascreenshot,usescreenshotpidx86toinjectthescreenshottoolintoanx86process.
Usescreenshotpidx64toinjectintoanx64process.Thisvariantofthescreenshotcommand
willtakeonescreenshotandexit.screenshot,byitself,willinjectthescreenshottoolintoa
temporaryprocess.
Thescreenwatchcommand(withoptionstouseatemporaryprocessorinjectintoanexplicit
process)willcontinuouslytakescreenshotsuntilyoustopthescreenwatchpost-exploitationjob.
Usetheprintscreencommand(alsowithtemporaryprocessandinjectoptions)totakea
screenshotbyadifferentmethod.ThiscommandusesaPrintScrkeypresstoplacethe
screenshotontotheuser'sclipboard.Thisfeaturerecoversthescreenshotfromtheclipboard
andreportsitbacktoyou.
WhenBeaconreceivesnewscreenshotsorkeystrokes,itwillpostamessagetotheBeacon
console.ThescreenshotandkeystrokeinformationisnotavailablethroughtheBeaconconsole
though.GotoView->KeystrokestoseeloggedkeystrokesacrossallofyourBeaconsessions.
GotoView->ScreenshotstobrowsethroughscreenshotsfromallofyourBeaconsessions.
Bothofthesedialogsupdateasnewinformationcomesin.Thesedialogsmakeiteasyforone
operatortomonitorkeystrokesandscreenshotsonallofyourBeaconsessions.
Controlling Beacon Jobs
SeveralBeaconfeaturesrunasjobsinanotherprocess(e.g.,thekeystrokeloggerand
screenshottool).Thesejobsruninthebackgroundandreporttheiroutputwhenit’savailable.
UsethejobscommandtoseewhichjobsarerunninginyourBeacon.Usejobkill[jobnumber]to
killajob.
The Process Browser
TheProcessBrowserdoestheobvious;ittasksaBeacontoshowalistofprocessesandshows
thisinformationtoyou.Goto[beacon]->Explore->ShowProcessestoopentheProcess
Browser.
UserGuide www.helpsystems.com page:73
PostExploitation/DesktopControl
Figure36.ProcessBrowser
Theleft-handsideshowstheprocessesorganizedintoatree.Thecurrentprocessforyour
Beaconishighlightedyellow.
Theright-handsideshowstheprocessdetails.TheProcessBrowserisalsoaconvenientplaceto
impersonateatokenfromanotherprocess,deploythescreenshottool,ordeploythekeystroke
logger.
Highlightoneormoreprocessesandpresstheappropriatebuttonatthebottomofthetab.
IfyouhighlightmultipleBeaconsandtaskthemtoshowprocesses,CobaltStrikewillshowa
ProcessBrowserthatalsostateswhichhosttheprocesscomesfrom.ThisvariantoftheProcess
BrowserisaconvenientwaytodeployBeacon’spost-exploitationtoolstomultiplesystemsat
once.
Simplysortbyprocessname,highlighttheinterestingprocessesonyourtargetsystems,and
presstheScreenshotorLogKeystrokesbuttontodeploythesetoolstoallhighlightedsystems.
Desktop Control
Tointeractwithadesktoponatargethost,goto[beacon]->Explore->Desktop(VNC).This
willstageaVNCserverintothememoryofthecurrentprocessandtunneltheconnection
throughBeacon.
WhentheVNCserverisready,CobaltStrikewillopenatablabeledDesktopHOST@PID.
YoumayalsouseBeacon’sdesktopcommandtoinjectaVNCserverintoaspecificprocess.Use
desktoppidarchitecturelow|high.Thelastparameterlet’syouspecifyaqualityfortheVNC
session.
UserGuide www.helpsystems.com page:74
PostExploitation/DesktopControl
Figure37.CobaltStrikeDesktopViewer
Thebottomofthedesktoptabhasseveralbuttons.Theseare:
Refresh the screen
View only
Decrease Zoom
Increase Zoom
Zoom to 100%
Adjust Zoom to Fit
Tab
Send Ctrl+Escape
Lock the Ctrl key
Lock the Alt key
Ifyoucan’ttypeinaDesktoptab,checkthestateoftheCtrlandAltbuttons.Wheneither
buttonispressed,allofyourkeystrokesaresentwiththeCtrlorAltmodifier.PresstheCtrlor
Altbuttontoturnoffthisbehavior.MakesureViewonlyisn’tpressedeither.Topreventyou
fromaccidentallymovingthemouse,Viewonlyispressedbydefault.
UserGuide www.helpsystems.com page:75
PostExploitation/PrivilegeEscalation
Privilege Escalation
Somepost-exploitationcommandsrequiresystemadministrator-levelrights.Beaconincludes
severaloptionstohelpyouelevateyouraccessincludingthefollowing:
NOTE:
TypehelpintheBeaconconsoletoseeavailablecommands.Typehelpfollowedbya
commandnametoseedetailedhelp.
Elevate with an Exploit
elevate-ThiscommandlistsprivilegeescalationexploitsregisteredwithCobaltStrike.
elevate[exploit][listener]-Thiscommandattemptstoelevatewithaspecificexploit.
Youmayalsolaunchoneoftheseexploitsthrough[beacon]->Access->Elevate.
Choosealistener,selectanexploit,andpressLaunchtoruntheexploit.Thisdialogisa
front-endforBeacon'selevatecommand.
YoumayaddprivilegeescalationexploitstoCobaltStrikethroughtheElevateKit.The
ElevateKitisanAggressorScriptthatintegratesseveralopensourceprivilegeescalation
exploitsintoCobaltStrike.https://github.com/rsmudge/ElevateKit.
runasadmin-Thiscommandbyitself,listscommandelevatorexploitsregisteredwithCobalt
Strike.
runasadmin[exploit][command+args]-Thiscommandattemptstorunthespecifiedcommand
inanelevatedcontext.
CobaltStrikeseparatescommandelevatorexploitsandsession-yieldingexploitsbecausesome
attacksareanaturalopportunitytospawnasession.Otherattacksyielda“runthiscommand”
primitive.Spawningasessionfroma“runthiscommand”primitiveputsalotofweaponization
decisions(notalwaysfavorable)inthehandsofyourtooldeveloper.Withrunasadmin,it’syour
choicetodropanexecutabletodiskandrunit,torunaPowerShellone-liner,ortoweakenthe
targetinsomeway.
Ifyou’dliketouseaPowerShellone-linertospawnasession,goto[beacon]->Access->One-
liner.
UserGuide www.helpsystems.com page:76
PostExploitation/PrivilegeEscalation
Figure38.PowerShellOne-liner
Thisdialogwillsetupalocalhost-onlywebserverwithinyourBeaconsessiontohostapayload
stageandreturnaPowerShellcommandtodownloadandrunthispayloadstage.
Thiswebserverisone-useonly.Onceit’sconnectedtoonce,itwillcleanitselfupandstop
servingyourpayload.
IfyourunaTCPorSMBBeaconwiththistool,youwillneedtouseconnectorlinktoassume
controlofthepayloadmanually.Also,beawarethatifyoutrytouseanx64payload—thiswill
failifthex86PowerShellisinyour$PATH.
CobaltStrikedoesnothavemanybuilt-inelevateoptions.Exploitdevelopmentisnotafocusof
theworkatHelpSystems.ItiseasytointegrateprivilegeescalationexploitsviaCobaltStrike’s
AggressorScriptprogramminglanguagethough.Toseewhatthislookslike,downloadthe
ElevateKit(https://github.com/cobalt-strike/ElevateKit).TheElevateKitisanAggressorScript
thatintegratesseveralopensourceprivilegeescalationexploitsintoCobaltStrike.
Elevate with Known Credentials
runas[DOMAIN\user][password][command]-Thisrunsacommandasanotheruserusingtheir
credentials.Therunascommandwillnotreturnanyoutput.Youmayuserunasfroma
non-privilegedcontextthough.
spawnas[DOMAIN\user][password][listener]-Thiscommandspawnsasessionasanother
userusingtheircredentials.Thiscommandspawnsatemporaryprocessandinjectsyour
payloadstageintoit.
Youmayalsogoto[beacon]->Access->SpawnAstorunthiscommandaswell.
Withbothofthesecommands,beawarethatcredentialsforanon-SID500accountwillspawna
payloadinamediumintegritycontext.YouwillneedtouseBypassUACtoelevatetoahigh
integritycontext.Also,beaware,thatyoushouldrunthesecommandsfromaworkingfolder
thatthespecifiedaccountcanread.
UserGuide www.helpsystems.com page:77
PostExploitation/Mimikatz
Get SYSTEM
getsystem-ThiscommandimpersonatesatokenfortheSYSTEMaccount.Thislevelofaccess
mayallowyoutoperformprivilegedactionsthatarenotpossibleasanAdministrator
user.
AnotherwaytogetSYSTEMistocreateaservicethatrunsapayload.Theelevatesvc-exe
[listener]commanddoesthis.Itwilldropanexecutablethatrunsapayload,createaserviceto
runit,assumecontrolofthepayload,andcleanuptheserviceandexecutable.
UAC Bypass
MicrosoftintroducedUserAccountControl(UAC)inWindowsVistaandrefineditinWindows
7.UACworksalotlikesudoinUNIX.Day-to-dayauserworkswithnormalprivileges.Whenthe
userneedstoperformaprivilegedaction—thesystemasksiftheywouldliketoelevatetheir
rights.
CobaltStrikeshipswithafewUACbypassattacks.Theseattackswillnotworkifthecurrent
userisnotanAdministrator.TocheckifthecurrentuserisintheAdministratorsgroup,userun
whoami/groups.
elevateuac-token-duplication[listener]-Thiscommandspawnsatemporaryprocesswith
elevatedrightsandinjectapayloadstageintoit.ThisattackusesaUAC-loopholethat
allowsanon-elevatedprocesstolaunchanarbitraryprocesswithatokenstolenfroman
elevatedprocess.Thisloopholerequirestheattacktoremoveseveralrightsassignedto
theelevatedtoken.Theabilitiesofyournewsessionwillreflecttheserestrictedrights.If
AlwaysNotifyisatitshighestsetting,thisattackrequiresthatanelevatedprocessis
alreadyrunninginthecurrentdesktopsession(asthesameuser).Thisattackworkson
Windows7andWindows10priortotheNovember2018update.
runasadminuac-token-duplication[command]-Thisisthesameattackdescribedabove,but
thisvariantrunsacommandofyourchoosinginanelevatedcontext.
runasadminuac-cmstplua[command]-ThiscommandattemptatobypassUACandruna
commandinanelevatedcontext.ThisattackreliesonaCOMobjectthatautomatically
elevatesfromcertainprocesscontexts(Microsoftsigned,livesinc:\windows\*).
Privileges
getprivs-Thiscommandenablestheprivilegesassignedtoyourcurrentaccesstoken.
Mimikatz
Beaconintegratesmimikatz.Usemimikatz[pid][arch][module::command]toinjectinto
thespecifiedprocesstorunamimikatzcommand.Usemimikatz(without[pid]and[arch]
arguments)tospawnatemporaryprocesstorunamimikatzcommand.
UserGuide www.helpsystems.com page:78
PostExploitation/CredentialandHashHarvesting
SomemimikatzcommandsmustrunasSYSTEMtowork.Prefixacommandwitha!toforce
mimikatztoelevatetoSYSTEMbeforeitrunsyourcommand.Forexample,mimikatz!lsa::cache
willrecoversaltedpasswordhashescachedbythesystem.Usemimikatz[pid][arch]
[!module::command]ormimikatz[!module::command](without[pid]and[arch]
arguments).
Onceinawhile,youmayneedtorunamimikatzcommandwithBeacon’scurrentaccesstoken.
Prefixacommandwitha@toforcemimikatztoimpersonateBeacon’scurrentaccesstoken.For
example,mimikatz@lsadump::dcsyncwillrunthedcsynccommandinmimikatzwithBeacon’s
currentaccesstoken.Usemimikatz[pid][arch][@module::command]ormimikatz
[@module::command](without[pid]and[arch]arguments).
Credential and Hash Harvesting
Todumphashes,goto[beacon]->Access->DumpHashes.Youcanalsousethehashdump
[pid][x86|x64]commandfromtheBeaconconsoletoinjectthehashdumptoolintothespecified
process.Usehashdump(without[pid]and[arch]arguments)tospawnatemporaryprocessand
injectthehashdumptoolintoit.ThesecommandswillspawnajobthatinjectsintoLSASSand
dumpsthepasswordhashesforlocalusersonthecurrentsystem.Thiscommandrequires
administratorprivileges.Ifinjectingintoapidthatprocessrequiresadministratorprivileges.
Uselogonpasswords[pid][arch]toinjectintothespecifiedprocesstodumpplaintext
credentialsandNTLMhashes.Uselogonpasswords(without[pid]and[arch]arguments)to
spawnatemporaryprocesstodumpplaintextcredentialsandNTLMhashes.Thiscommanduses
mimikatzandrequiresadministratorprivileges.
Usedcsync[pid][arch][DOMAIN.fqdn]toinjectintothespecifiedprocessto
extracttheNTLMpasswordhashes.Usedcsync[DOMAIN.fqdn]tospawna
temporaryprocesstoextracttheNTLMpasswordhashes.Thiscommandusesmimikatzto
extracttheNTLMpasswordhashfordomainusersfromthedomaincontroller.Specifyauserto
gettheirhashonly.Thiscommandrequiresadomainadministratortrustrelationship.
Usechromedump[pid][arch]toinjectintothespecifiedprocesstorecovercredentialmaterial
fromGoogleChrome.Usechromedump(without[pid]and[arch]arguments)tospawna
temporaryprocesstorecovercredentialmaterialfromGoogleChrome.Thiscommandwilluse
Mimikatztorecoverthecredentialmaterialandshouldberununderausercontext.
CredentialsdumpedwiththeabovecommandsarecollectedbyCobaltStrikeandstoredinthe
credentialsdatamodel.GotoView->Credentialstopullupthecredentialsonthecurrentteam
server.
Port Scanning
Beaconhasabuiltinportscanner.Useportscan[pid][arch][targets][ports][arp|icmp|none]
[maxconnections]toinjectintothespecifiedprocesstorunaportscanagainstthespecified
hosts.Useportscan[targets][ports][arp|icmp|none][maxconnections](without[pid]and
[arch]arguments)tospawnatemporaryprocesstorunaportscanagainstthespecifiedhosts.
UserGuide www.helpsystems.com page:79
PostExploitation/NetworkandHostEnumeration
The[targets]optionisacommaseparatedlistofhoststoscan.Youmayalsospecify
IPv4addressranges(e.g.,192.168.1.128-192.168.2.240,192.168.1.0/24)
The[ports]optionisacommaseparatedlistorportstoscan.Youmayspecifyport
rangesaswell(e.g.,1-65535)
The[arp|icmp|none]targetdiscoveryoptionsdictatehowtheportscanningtoolwill
determineifahostisalive.TheARPoptionusesARPtoseeifasystemrespondsto
thespecifiedaddress.TheICMPoptionsendsanICMPechorequest.Thenone
optiontellstheportscantooltoassumeallhostsarealive.
The[maxconnections]optionlimitshowmanyconnectionstheportscantoolwill
attemptatanyonetime.TheportscantoolusesasynchronousI/Oandit'sableto
handlealargenumberofconnectionsatonetime.Ahighervaluewillmakethe
portscangomuchfaster.Thedefaultis1024.
Theportscannerwillrun,inbetweenBeaconcheckins.Whenithasresultstoreport,itwill
sendthemtotheBeaconconsole.CobaltStrikewillprocessthisinformationandupdatethe
targetsmodelwiththediscoveredhosts.
Youcanalsogoto[beacon]->Explore->PortScannertolaunchtheportscannertool.
Network and Host Enumeration
Beacon’snetmoduleprovidestoolstointerrogateanddiscovertargetsinaWindowsactive
directorynetwork.
Usenet[pid][arch][command][arguments]toinjectthenetworkandhostenumerationtool
intothespecifiedprocess.Usenet[command][arguments](without[pid]and[arch]arguments)
tospawnatemporaryprocessandinjectthenetworkandhostenumerationtoolintoit.An
exceptionisthenetdomaincommandwhichisimplementedasaBOF.netdomain.
ThecommandsinBeacon’snetmodulearebuiltontopoftheWindowsNetworkEnumeration
APIs.Mostofthesecommandsaredirectreplacementsformanyofthebuilt-innetcommandsin
Windows(therearealsoafewuniquecapabilitieshereaswell).Thefollowingcommandsare
available:
computers-listshostsinadomain(groups)
dclist-listsdomaincontrollers.(populatesthetargetsmodel)
domain-displaydomainforthishost
domain_controllers-listsDCsinadomain(groups)
domain_trusts-listsdomaintrusts
group-listsgroupsandusersingroups
localgroup-listslocalgroupsandusersinlocalgroups.(greatduringlateralmovementwhen
youhavetofindwhoisalocaladminonanothersystem).
logons-listsusersloggedontoahost
sessions-listssessionsonahost
UserGuide www.helpsystems.com page:80
PostExploitation/TrustRelationships
share-listssharesonahost
user-listsusersanduserinformation
time-showtimeforahost
view-listshostsinadomain(browserservice).(populatesthetargetsmodel)
Trust Relationships
TheheartofWindowssinglesign-onistheaccesstoken.WhenauserlogsontoaWindowshost,
anaccesstokenisgenerated.Thistokencontainsinformationabouttheuserandtheirrights.
Theaccesstokenalsoholdsinformationneededtoauthenticatethecurrentusertoanother
systemonthenetwork.ImpersonateorgenerateatokenandWindowswilluseitsinformation
toauthenticatetoanetworkresourceforyou.
Usesteal_token[pid]toimpersonateatokenfromanexistingprocess.Ifyou’dliketoseewhich
processesarerunninguseps.Thegetuidcommandwillprintyourcurrenttoken.Userev2selfto
revertbacktoyouroriginaltoken.
Ifyouknowcredentialsforauser;usemake_token[DOMAIN\user][password]togeneratea
tokenthatpassesthesecredentials.Thistokenisacopyofyourcurrenttokenwithmodified
singlesign-oninformation.Itwillshowyourcurrentusername.Thisisexpectedbehavior.
TheBeaconcommandpth[pid][arch][DOMAIN\user][ntlmhash]injectsintothespecified
processtogenerateANDimpersonateatoken.Usepth[DOMAIN\user][ntlmhash](without
[pid]and[arch]arguments)tospawnatemporaryprocesstogenerateANDimpersonatea
token.ThiscommandusesmimikatztogenerateANDimpersonateatokenthatusesthe
specifiedDOMAIN,user,andNTLMhashassinglesign-oncredentials.Beaconwillpassthis
hashwhenyouinteractwithnetworkresources.
Beacon’sMakeTokendialog([beacon]->Access->MakeToken)isafront-endforthese
commands.Itwillpresentthecontentsofthecredentialmodelanditwillusetherightcommand
toturntheselectedcredentialentryintoanaccesstoken.
Kerberos Tickets
AGoldenTicketisaself-generatedKerberosticket.It'smostcommontoforgeaGoldenTicket
withDomainAdministratorrights
Goto[beacon]->Access->GoldenTickettoforgeaGoldenTicketfromCobaltStrike.Provide
thefollowingpiecesofinformationandCobaltStrikewillusemimikatztogenerateaticketand
injectitintoyourkerberostray:
1. Theuseryouwanttoforgeaticket.
2. Thedomainyouwanttoforgeaticketfor.
3. Thedomain'sSID
4. TheNTLMhashofthekrbtgtuseronadomaincontroller.
Usekerberos_ticket_use[/path/to/ticket]toinjectaKerberosticketintothecurrentsession.
ThiswillallowBeacontointeractwithremotesystemsusingtherightsinthisticket.
UserGuide www.helpsystems.com page:81
PostExploitation/LateralMovement
Usekerberos_ticket_purgetoclearanyKerberosticketsassociatedwithyoursession.
Lateral Movement
Onceyouhaveatokenforadomainadminoradomainuserwhoisalocaladminonatarget,
youmayabusethistrustrelationshiptogetcontrolofthetarget.CobaltStrike’sBeaconhas
severalbuilt-inoptionsforlateralmovement.
TypejumptolistlateralmovementoptionsregisteredwithCobaltStrike.Runjump[module]
[target][listener]toattempttorunapayloadonaremotetarget.
Jump Module Arch Description
psexec x86 Use a service to run a Service EXE artifact
psexec64 x64 Use a service to run a Service EXE artifact
psexec_psh x86 Use a service to run a PowerShell one-liner
winrm x86 Run a PowerShell script via WinRM
winrm64 x64 Run a PowerShell script via WinRM
Runremote-exec,byitself,tolistremoteexecutionmodulesregisteredwithCobaltStrike.Use
remote-exec[module][target][command+args]toattempttorunthespecifiedcommandona
remotetarget.
Remote-exec Module Description
psexec Remote execute via Service
Control Manager
winrm Remote execute via WinRM
(PowerShell)
wmi Remote execute via WMI
Lateralmovementisanarea,similartoprivilegeescalation,wheresomeattackspresenta
naturalsetofprimitivestospawnasessiononaremotetarget.Someattacksgiveanexecute-