 20
 15
 10
 5
 0
Sep 07
BGP prefixes switchover
ICMP-Paris probes
UDP probes
Oct 07
Nov 07
Dec 07
Jan 08
Feb 08
Mar 08
Apr 08
May 08
sjc-us (2)
gig-br (2)
cmn-ma (2)
hnl-us (2)
lax-us (2)
cbg-uk (2*)
vie-at (2)
iad-us (2*)
yto-ca (1)
bcn-es (1*)
hlz-nz (1)
lej-de (1)
laf-us (1)
syd-au (1*)
san-us (1*)
nrt-jp (1*)
mnl-ph (1)
hel-fi (1*)
dub-ie (1)
cjj-kr (1*)
amw-us (1)
Figure 8: IPv4 Routed /24 Topology Dataset collection on all Ark monitors. The bars indicate the availability
of traceroute data for each monitor. The probing method was UDP (red/dark) until around Nov 2, 2007,
when it changed to ICMP-Paris (green/light). The san-us monitor also probed with UDP between Jan 22
and Feb 15, 2008. We updated the BGP preﬁxes used to dynamically compute the destination list around
Nov 7, 2007. Monitors are grouped into teams 1 and 2 as indicated in parentheses; each team independently
probes the entire set of routed /24’s. To support this study, we ran multiple traceroute methods on the
monitors marked with asterisks.
probing that may elicit complaints. Randomness in probing
also more broadly distributes measurement traﬃc topologi-
cally in order to reduce potential bias or measurement gaps
caused by packet loss or transient routing problems on com-
mon links.
The end product of team probing is the CAIDA IPv4
Routed /24 Topology Dataset [30], which is available for
researchers to download. We have collected this data from
September 13, 2007 to present, using between 8 and 21 mon-
itors located worldwide (see Figure 8). In the ﬁrst 7 months
(up to April 30, 2008), we collected 748 million traceroutes
and completed 107 cycles.
4.3 Dataset pruning
For the purposes of comparing UDP and ICMP-Paris tra-
ceroutes, we exclude a small portion of the dataset that we
know is non-representative in some way. In particular, we
exclude all traces collected by vie-at and gig-br, and dub-
ie traces collected between Apr 10–30, 2008. This excludes
22.3 million traces, or about 3% of the original 748 million.
All tables and analyses in the remainder of this section are
based on this pruned dataset.
For the excluded traces, the loop rate is far higher than for
the other Ark monitors, due to MPLS-induced loops in an
immediate upstream provider serving these monitors. These
loops are caused by improper decrementing of the IP TTL
by MPLS egress routers. These loops start at hop 3 for
vie-at, hop 4 for gig-br, and hop 5 for dub-ie. For dub-ie,
these loops aﬀect as much as 28% of the traces gathered on
a given day. Determining the loop rate is harder for vie-at
and gig-br, since on these monitors we run scamper with a
special option to probe past these loops.3 We can say that
for one set of 50k destinations, vie-at had a loop rate of 50%.
3We used the ‘-L 1’ option. The diﬃculty arises because
this scamper option will lead to the under-counting of loops
in paths that do not cross these nearby MPLS loops.
Table 11: Traceroute method halt reasons for the
Routed /24 Dataset.
UDP
ICMP-Paris
111.98M
613.90M
All traces
Reached
4.25M 3.79%
ICMP-Unreach 11.52M 10.29%
Loop
5.97M 5.33%
Gaplimit
45.67M 7.44%
63.62M 10.36%
21.23M 3.46%
90.24M 80.59% 483.38M 78.74%
Reached
Time exceeded
Unreach port
Echo reply
4.25M
745k
17.54%
3.50M 82.46%
–
45.67M
4.03M 8.83%
0.07%
41.60M 91.10%
31k
4.4 UDP vs. ICMP-Paris analysis
Table 11 gives the breakdown of halt reasons for this
dataset. The reachability rate is 3.79% for UDP and 7.44%
for ICMP-Paris, which are both lower in this dataset than
for the earlier random routable address list, which reaches
an average of 5.1% of UDP and 9.0% of ICMP-Paris traces.
This result is consistent with the fact that this list is con-
structed by subdividing the routable preﬁxes into smaller
chunks, many of which are not occupied.
This dataset shows the same noticeable diﬀerence in reach-
ability between UDP and ICMP-Paris as in the random
routable address list. The diﬀerence with this dataset is
more pronounced, as ICMP-Paris has 1.96 times the reach-
ability rate of UDP, whereas earlier the ICMP-Paris rate
reached 1.75 times more destinations than UDP.
As expected, the ICMP-Paris loop rate of 3.46% is lower
than the UDP rate of 5.33%. Both loop rates are lower than
those observed in the random routable address list, which
has an average loop rate of 7.8% for UDP and 6.3% for
ICMP-Paris.
Table 12: Traceroute halt reasons for the Routed
/24 Dataset for traces collected before and after the
set of BGP preﬁxes used to generate destinations
was updated around Nov 7, 2007. The UDP column
describes san-us traces for Sep 13–Nov 1, 2007 (old)
and Jan 22–Feb 15, 2008 (new). The ICMP-Paris
column describes traces from 7 monitors collecting
data on Nov 1–6, 2007 (old) and the same 7 monitors
on Nov 10–13, 2007 (new).
UDP
ICMP-Paris
Table 13: Traceroute halt reasons for the Routed
/24 Dataset for ICMP-Paris traces collected on Nov
10, 2007 and after (599M total traces). This shows
the variation across 19 monitors.
min
max
avg
stddev
Reached
ICMP-Unreach
Loop
Gaplimit
7.63%
7.47% 0.11%
7.15%
6.89% 12.35% 10.25% 1.11%
3.17%
3.44% 0.28%
76.86% 81.98% 78.84% 1.10%
4.28%
Old preﬁxes
Traces
Reached
ICMP-Unreach
Loop
Gaplimit
New preﬁxes
Traces
Reached
ICMP-Unreach
Loop
Gaplimit
13.38M
505k
3.78%
1.54M 11.51%
5.26%
6.84%
11.89%
3.22%
10.63M 79.46% 6.06M 78.04%
703k
7.77M
531k
924k
250k
6.33M
260k
619k
320k
7.16%
11.09%
3.52%
5.13M 81.07% 5.97M 78.23%
4.10%
9.78%
5.05%
7.63M
546k
846k
268k
4.5 Impact of BGP preﬁxes
Across two intervals we used two diﬀerent sets of BGP
preﬁxes to generate destination addresses for probing. The
ﬁrst set we used from Sep 13 to about Nov 7, 2007, and
the second set thereafter. We obtained the ﬁrst set from
a single RouteViews BGP snapshot taken on Nov 14, 2006
(during the early stages of Ark development). This preﬁx list
provided 6.45 million /24’s for probing after applying our do-
not-probe list. The second set of preﬁxes was derived from
the union of seven RouteViews snapshots taken Oct 14–20
2007, one per day. We excluded preﬁxes that appeared in
only one or two snapshots. This provided 7.02 million /24’s
after applying our do-not-probe list and bogon ﬁltering.
Table 12 lists the reachability statistics for a subset of
UDP and ICMP-Paris traces collected before and after the
BGP preﬁx list switch-over on Nov 7th. Both methods show
small but noticeable trends. With the new preﬁx list, reach-
ability increases slightly, about 8.5% for UDP and 4.7% for
ICMP-Paris. The gaplimit rate also increases slightly, which
seems unsurprising, given the additional half a million /24’s
in the new list. Overall, the change in preﬁx sets did not
have a dramatic impact on reachability, so the signiﬁcant
diﬀerences in reachability between UDP and ICMP-Paris
shown in Table 11 are indicative of real diﬀerences rather
than solely artifacts of the change in BGP preﬁx list.
4.6 Impact of vantage points
We now examine the amount of variation that exists across
vantage points by looking at the reachability statistics for
the 19 monitors that collected ICMP-Paris traces on and
after Nov 10, 2007. As we can see from Table 13, there
is little variation in the percentage of reached destinations
despite the widely diﬀering geographic and topological dis-
tribution of monitors. This suggests that the main cause
of variation for reachability (for a single method) may be
something close to the destination, such as the policy used
in ﬁrewalls. Or said diﬀerently, this result suggests reach-
ability is determined more by the choice of the destination
than the choice of the vantage point, even though diﬀerent
vantage points can encounter signiﬁcantly diﬀerent numbers
of unreachable responses and loops.
5. RELATED WORK
Although the ﬁeld of Internet topology research is at least
a decade old, with 317 citations in Citeseer, we know of
no other work that has formally compared the myriad of
available forward IP path probing methods. Recently Hei-
demann, et al. compared ICMP and TCP methods in a
ping-based census of the IPv4 address space [22], and al-
though they did not attempt to probe entire forward paths,
they gave up early on using TCP after learning it triggered
more abuse complaints. We note that during our data col-
lection, we received a single complaint which was in response
to TCP probes sent to routers in the router address list.
Bush, et al. [31] uses traceroute (but does not specify
which method) to test the reachability of new address space.
Rocketfuel [32] trades breadth of topology collection for more
detail within individual networks. Recent revisions of Paris
traceroute [15] make the same trade: rather than macro-
scopic collection of Internet paths, they focus on enumerat-
ing all possible IP paths between a source and a destination
– which requires an order of magnitude more probes to ac-
complish.
Hubble [33] uses ongoing as well as targeted pings and
traceroutes to diagnose reachability problems to edge net-
works. Traceroute paths are also used to ﬁnd locations
(router or AS) of reachability problems. Because low end-
host responsiveness reduces the utility of active probing,
they base their reachability diagnosis on being able to reach
the origin AS of each announced BGP preﬁx.
6. CONCLUSION
Macroscopic Internet topology data is vital to researchers
trying to develop or empirically validate models of Internet
topology structure and growth. In this paper, we explored
the utility of six traceroute probe methods in three scenarios.
Our results indicate that researchers should be careful when
selecting a probing method, or a topology dataset. While
ICMP-Paris demonstrated superiority in metrics of reached
destinations for both random destination and router sce-
narios, as well as in AS links inferred, it missed IP links
inside each AS which UDP-Paris found, likely due to ICMP
not being load-balanced as widely. We also demonstrated
signiﬁcant variation in the IP paths inferred; despite UDP-
Paris reaching the fewest number of destinations, it inferred
the most IP links, demonstrating its utility for obtaining the
most detailed intra-AS topology.
Our experiments also showed that using more than one
probe method will improve coverage of both AS and IP links.
Using more than one probe method also allows the integrity
of the IP paths to be tested in the face of systems which
spoof their source address, and facilitates inference of next-
hop selection based on the protocol type.
Acknowledgements
We thank the anonymous reviewers, shepherd Simon Leinen,
and kc claﬀy. This work is supported by National Science
Foundation grant CNS 0551542, DHS contract S/N 660001-
08-C-2029, and the New Zealand Foundation for Research
Science and Technology (FRST) contract UOWX0705.
7. REFERENCES
[1] Van Jacobson. traceroute.
ftp://ftp.ee.lbl.gov/traceroute.tar.gz.
[2] Ehud Gavron. NANOG traceroute. http:
//momo.lcs.mit.edu/traceroute/traceroute.c.
[3] J. Mogul and S. Deering. Path MTU discovery. RFC
1191, November 1990.
[4] Michael Toren. tcptraceroute.
http://michael.toren.net/code/tcptraceroute/.
[5] Dan Kaminsky. paratrace. http:
//www.doxpara.com/read.php/docs/paratrace.html.
[6] Brice Augustin, Xavier Cuvellier, Benjamin Orgogozo,
Fabien Viger, Timur Friedman, Matthieu Latapy,
Cl´emence Magnien, and Renata Teixeira. Avoiding
traceroute anomalies with Paris traceroute. In IMC
’06: Proceedings of the 6th ACM SIGCOMM
conference on Internet measurement, pages 153–158,
Rio de Janeiro, Brazil, October 2006.
[7] Alexa. http://www.alexa.com/.
[8] R-fx Networks. Advanced policy ﬁrewall (APF). http:
//www.r-fx.ca/downloads/apf-0.9.6-3.tar.gz.
[9] Bradley Huﬀaker, Daniel Plummer, David Moore, and
k claﬀy. Topology discovery by active probing. In 2002
Symposium on applications and the Internet (SAINT
2002), pages 90–96, Nara City, Japan, January 2002.
[10] S. Savage. Sting: a TCP-based network measurement
tool. In Proceedings of USITS ’99: The 2nd USENIX
Symposium on Internet Technologies and Systems,
pages 71–79, Boulder, CO, October 1999.
[11] Rob Sherwood and Neil Spring. Touring the Internet
in a TCP sidecar. In IMC ’06: Proceedings of the 6th
ACM SIGCOMM conference on Internet
measurement, pages 339–344, Rio de Janeiro, Brazil,
October 2006.
[12] Matthew Luckie. [patch] sys/netinet/udp usrreq.c
modiﬁes received udp checksum, May 2007. http:
//www.freebsd.org/cgi/query-pr.cgi?pr=112471.
[13] Matthew Luckie. scamper.
http://www.wand.net.nz/scamper/.
[14] P. Mockapetris. Domain names - implementation and
speciﬁcation. RFC 1035, November 1987.
[15] Brice Augustin, Timur Friedman, and Renata
Teixeira. Measuring load-balanced paths in the
Internet. In Proceedings of the 7th ACM SIGCOMM
conference on Internet measurement, pages 149–160,
San Diego, California, USA, October 2007.
[16] Routeviews sh ip bgp snapshots.
http://archive.routeviews.org/oix-route-views/.
[17] Z. Morley Mao, Jennifer Rexford, Jia Wang, and
Randy Katz. Towards an accurate AS-level traceroute
tool. In Proc. ACM SIGCOMM, pages 365–378,
Karlsruhe, Germany, September 2003.
[18] Young Hyun. Archipelago measurement infrastructure.
http://www.caida.org/projects/ark/.
[19] Patrick Verkaik. rv2atoms-0.4.
http://www.caida.org/funding/routing/atoms/
download/rv2atoms-0.4/.
[20] Team Cymru. Bogon bit notation list v4.0 25 JAN
2008.
http://www.cymru.com/Documents/bogon-bn.html.
[21] A. Medina, M. Allman, and S. Floyd. Measuring the
evolution of transport protocols in the Internet. ACM
SIGCOMM Computer Communication Review,
35(2):37–52, April 2005.
[22] John Heidemann, Yuri Pradkin, Ramesh Govindan,
Christos Papadopoulos, Genevive Bartlett, and Joseph
Bannister. Census and survey of the visible Internet
(extended). ISI-TR 2008-649, USC/Information
Sciences Institute, February 2008.
[23] J. Postel. Internet control message protocol. RFC 792,
September 1981.
[24] Ramesh Govindan and Hongsuda Tangmunarunkit.
Heuristics for Internet map discovery. In INFOCOM
2000, pages 1371–1380, Tel-Aviv, Israel, Mar 2000.
[25] Jean-Jacques Pansiot and Dominique Grad. On routes
and multicast trees in the Internet. ACM SIGCOMM
Computer Communication Review (CCR), 28(1), Jan
1998.
[26] David Gelernter and Nicholas Carriero. Coordination
languages and their signiﬁcance. Commun. ACM,
35(2):97–107, 1992.
[27] Sascha Ossowski and Ronaldo Menezes. On
coordination and its signiﬁcance to distributed and
multi-agent systems. Concurrency and Computation:
Practice and Experience, 18(4):359–370, 2006.
[28] David Gelernter. Generative communication in linda.
ACM Trans. Program. Lang. Syst., 7(1):80–112, 1985.
[29] Nicholas Carriero and David Gelernter. How to write
parallel programs: a ﬁrst course. MIT Press,
Cambridge, MA, USA, 1990.
[30] CAIDA IPv4 routed /24 topology dataset.
http://imdc.datcat.org/collection/1-0360-J.
[31] Randy Bush, James Hiebert, Olaf Maennel, Matthew
Roughan, and Steve Uhlig. Testing the reachability of
(new) address space. In Sigcomm workshop on
Internet network management, August 2007.
[32] N. Spring, R. Mahajan, and D. Wetherall. Measuring
ISP topologies with Rocketfuel. In Proceedings of
ACM/SIGCOMM ’02, pages 133–145, Pittsburgh, PA,
August 2002.
[33] Ethan Katz-Bassett, Harsha V. Madhyastha, John P.
John, and Arvind Krishnamurthy. Studying black
holes in the Internet with Hubble. In Networked
Systems Design and Implementation (NSDI), Apr
2008.