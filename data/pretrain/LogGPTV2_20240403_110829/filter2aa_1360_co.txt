fraction of available utilities. Note that many of the domain name resources mentioned in the previous chapters 
also allow for query’ by an IP address. Let's begin with the basic resources at ViewDNS.
This service was used earlier to display registration information about an individual domain. Entering an IP 
address will attempt to identify’ details about any domain registrations associated with the address. z\ search of 
54.208.51.71 revealed it to belong to Amazon and provided the public registration details.
This page was previously used to translate a domain name into an IP address. It will also display additional 
domains hosted on an individual IP address. This service identified 134 domains hosted on 104.28.10.123. These 
included domains from websites all over the world without a common theme. This indicates that he uses a 
shared server, which is very common. If I would have seen only a few domains on the server, that may indicate 
that he is also associated with those specific domains.
This utility’ cross-references an IP address with publicly’ available location data connected to the server hosting 
any domains associated with the IP address. A search of 54.208.51.71 revealed the following information.
ViewDNS IP Traceroute (viewdns.info/traceroute)
ViewDNS Reverse DNS (viewdns.info/reversedns)
Similar to the Domain chapter, ViewDNS allows query of IP addresses via URL, as follows.
For redundancy, I also recommend the following UltraTools direct IP address query URLs.
Bing IP (bing.com)
https://www.bing.com/search?q=ip%3A54.208.51.71
IPLocation (iplocation.net)
388 Chapter 24
This simply finds the reverse DNS entry for a given IP, which is usually the host name.
https://viewdns.info/reverseip/?host=70.39.110.82&t=l
https://viewdns.info/iplocation/?ip=70.39.110.82 
https://viewdns.info/portscan/?host=70.39.110.82
https://viewdns.info/whois/?domain=70.39.110.82 
https://viewdns.info/traceroute/?domain=70.39.110.82
https://viewdns.info/reversedns/?ip=70.39.110.82
This tool identifies the path that ViewDNS took from their servers to the target IP address. This can identify IP 
addresses of servers that were contacted while you tried to establish communication with the address. These will 
occasionally identify' associated networks, routers, and servers. Additional IP addresses can be searched for 
further details. The numbers after the IP addresses indicate the number of milliseconds that each "hop" took.
https://www.ultnitools.com/tools/ipWhoisLookupRcsultPip  Address=70.39.110.82 
https://www.ultratools.com/tools/geoIpResult?ipAddress=70.39.110.82
https://www.ultratools.com/tools/pingResult?hostName=70.39.110.82
https://www.iplocation.net/ip-lookuppquery=70.39.110.83&submit=IP+Lookup
Once you have identified an IP address of your target, you can search for websites hosted on that IP address. A 
specific search on Bing will present any other websites on that server. If your target is stored with a large host, 
such as GoDaddy, there will not be much intelligence provided. It will only list websites that share a server, but 
are not necessarily associated with each other. If the user is hosting the website on an individual web server, this 
search will display all other websites that the user hosts. This search only works on Bing and must have "ip:" 
before the IP address. An example of a proper search on Bing would look like ip:54.208.51.71. The results of 
this search identify' ever}' website hosted by a specific local website design company. The direct URL follows.
IPLocation offers unlimited free IP address searches, and queries five unique services within the same search 
results. The results are the most comprehensive I have seen for a free website. While GPS coordinates of an IP 
address are available, this most often returns to the provider of the internet service. This usually does not identify 
die exact location of where the IP address is being used. The country, region, and city information should be 
accurate. If an organization name is presented in the results, this indicates that the address returns to the 
identified company. The exception here is when an internet service provider is identified. This only indicates 
that the IP address belongs to the specified provider. Most results translate an IP address into information 
including business name, general location, and internet service provider. This can be used to determine if the IP 
address that a target is using belongs to a business providing free wireless internet. If you see "Starbucks", 
"Barnes & Noble", or other popular internet cafes listed in the results, this can be important intelligence about 
the target. This can also confirm if an IP address is associated with a VPN service. The direct URL query follows.
That's Them (thatsthem.com/reverse-ip-lookup)
rely
https://thatsthem.com/ip/70.39.110.82
I Know What You Download (iknowwhatyoudownload.com)
https://iknowwhatyoudownload.com/cn/pcer/?ip=70.39.110.82
Movies
Movies
The Beguiled
Figure 24.01: A search result from I Know What You Download.
Exoncrator (metrics.torproject.org/exonerator.html)
IP Addresses 389
Dec 28.2017 
9:53:21 PM
Dec 28. 2017 
9:53:19 PM
Dec 28.2017 
9:5351 PM
Dec 28.2017 
9:53:19 PM
The Onion Router (Tor) was explained in Chapter Three. It is a network that provides anonymity by issuing IP 
addresses to users that connect to servers in other countries. If you possess an IP address of your target, but 
cannot locate any valuable information using the previous techniques, it is possible that the address was part of 
the Tor network and there is no relevant data to be located. Exonerator is a tool that will verify the usage of an 
IP address on the Tor network. Provide the IP address and a date of usage, and the service will display whether 
it was used as a Tor connection. While a date is required, you could provide the current date if your target time 
frame is unknown. Most IP addresses are typically always or never a part of the Tor network.
The previous resources rely on conventional IP address data, which is sourced from various registration 
documentation and scanning of servers. Very little information is sensitive or personal in nature. That's Them 
enters into an environment that is a lot more invasive. This service, mentioned previously during person, email, 
and telephone search, collects marketing data from many sources to populate its database. This often includes 
IP address information. These details could have been obtained during an online purchase or website 
registration. Regardless of the source, the results can be quite beneficial. At the time of this writing, I searched 
an IP address associated with a business email that I received. The result identified a person's name, home 
address, company, email address, and age range. All appeared accurate. This tool will work best when searching 
static business IP addresses, and not traditional home addresses that can change often. VCTiile I get no results 
much more often than positive results, this resource should be in everyone's arsenal. The direct URL query 
follows.
While discussing invasive websites, this resource might be the most personal of all. This service monitors online 
torrents (ways to download large files which often violate copyright laws) and discloses the files associated with 
any collected IP addresses. I searched the previous IP address collected from an associate, and received an 
immediate hie Figure 24.01 displays the result. It identifies that the target IP address was downloading two 
specific movies on December 28,2017 at 9:53 pm. Clicking on the movie tide presents every IP address captured 
that also downloaded the same file. Again, this will work best with IP addresses that rarely change, such as a 
business, organization, or public Wi-Fi network. I have used this to determine the files being downloaded from 
the network with which I was currendy connected. On one occasion, this revealed an employee that was 
downloading enormous amounts of pornography on his employer's network. He should have used a VPN, 
which would have masked his online activity from me. In order to see the power of this type of sendee, tty’ 
searching a known VPN address such as an address provided by Private Internet Access (PIA) 173.244.48.163. 
While I know that no one reading this book has ever downloaded pirated content, this should serve as a reminder 
why VPNs are essential. The direct URL query follows.
Wigle (wigle.net)
Shodan (shodan.io)
country:US city:"Mount Pleasant"
390 Chapter 24
https://wqgle.net/search?ssid=bazzell
https://wigle.net/search#fullSearch?postalCode=62002
An investigator could also search by the target's name. This may identify routers that have the target's name 
within the SSID. A search of "Bazzell" identifies seven access points that probably belong to relatives with my 
last name. These results identify the router name, MAC address, dates, encryption method, channel, and location 
of the device. This can easily lead an investigator to the home of a target.
ManyT internet users will use the same name for their wireless router as they’ use for their online screen name. 
Assume that your target's username was "Hacker21224". A search on Wigle for "Hacker21224" as a router name 
might produce applicable results. These could identify the router's MAC address, encryption type, and GPS 
coordinates. A search on Google Maps of the supplied GPS coordinates will immediately' identify the home 
address, a satellite view of the neighborhood, and a street view of the house of the target. All of this intelligence 
can be obtained from a simple username. These results would not appear on any standard search engines.
Shodan is a search engine that lets you find specific computers (routers, servers, etc.) using a variety’ of filters. 
General search engines, such as Google and Bing, are great for finding websites; however, they’ do not search 
for computers or devices. Shodan indexes "banners", which are metadata that a device sends back to a client. 
This can be information about the server software, what options the service supports, or a welcome message. 
Devices that are commonly identified through Shodan include servers, routers, online storage devices, 
surveillance cameras, webcams, and VOIP systems. Network security’ professionals use this site to identify 
vulnerabilities on their systems. Criminals use it to illegally access networks and alter devices. We will use it to 
locate specific systems near a target location. In order to take advantage of Shodan's full search capabilities, you 
must create a free account. Only a name and email address is required. The following example will identify how 
to locate live public surveillance cameras based on location. The target for this search is Mount Pleasant, Utah. 
The following search on Shodan produced 9,684 results.
There are many investigative uses for this service. You can identify’ the wireless access points in the immediate 
area of a target's home. As an example, a search of the address of a gas station revealed a map of it with the 
associated routers. In this view’, I can identify’ the router names including potential sensitive information. It 
displays wireless router SSID's of AltonBPStore, tankers_netw’ork, Big Toe, and others. Clicking View’ and then 
Search in the upper left of the page presents a detailed query’ engine. A search of tankers_network, as identified 
previously in the map view’, displays details of the wireless access point. It has a MAC address of 
OO:1F:C6:FC:1B:3F, WPA encryption, was first seen in 2011, and operates on channel 11.
Wigle is a crow’d-sourced database of wireless access points. Users in all areas of the countp’ conduct scans of 
wireless devices in their area; identify’ details of each device; and submit this data to Wigle in order to map the 
found devices on the site. This allows anyone to browse an area for wireless access points or search an address 
to locate specific devices. Additionally, you can search for either a specific router name or MAC address and 
locate any matching devices. The results include links that will display the results on an interactive map. Most of 
the w’orld has been covered. In order to take advantage of the search features, y’ou will need to register for a free 
account. Generic or misleading information can be used that does not identify’ y’ou.
If y’ou find Wigle valuable to your investigations, I recommend y’ou create a free account. While logged in, you 
can use their advanced search (wigle.net/search) or submit direct queries via URL as follows.
Figure 24.02: A Shodan Maps search result.
IP Addresses 391
Shodan Beta (beta.shodan.io) offers complete details of a specified IP address. This can be queried with the 
following three URLs.
https://bcta.shodan.io/host/70.39.81.131
https://beta.shodan.io/host/70.39.81.131/raw
https://beta.shodan.io/host/70.39.81.131 /history
City: Name of the city (ex. City:"San Diego") 
Country: 2-lerter country code (ex. Country:US) 
GPS: Latitude and longitude (ex. Geo:50.23,20.06) 
OS: Operating system (ex. Os:Linux) 
IP Address: Range (ex. Net: 18.7.7.0/24 ) 
Keyword: (ex. Webcam)
To connect to the device, you would click on the IP address identified as 63.78.117.229. Clicking through each 
of these options may be time consuming. You can add a search term to filter your results. Replicating this search 
for a GPS location in a large city will produce many results. Clicking the IP address will take you to the page 
that will connect to each device. You must be careful here. Some devices will require a username and password 
for access. You could try' "admin" / "admin" or "guest" / "guest", but you may be breaking the law. This could 
be considered computer intrusion. However, many of the webcam and netcam results will not prompt you for 
a password and connect you to the device automatically. There is likely no law violation when connecting to a 
device that docs not prompt you for credentials. Your local laws may prohibit this activity.
There arc two flaws with this search. First, you may receive results from other cities named Mount Pleasant. 
Second, you will likely receive too many results to analyze effectively. A search of "geo:39.55,-l 11.45" will focus 
only on the specific GPS location of interest (Lat=39.55, Long= -111.45). There were 238 results for this search. 
This is much more manageable and all of the results will be devices in the target area. Adding more specific 
search criteria will filter the results further. A search of "gco:39.55,-l 11.45 netcam" identified only one device. 
The result displays this device as a "Netcam". It also identifies the internet service provider as "Central Utah 
Telephone" indicating the user has a DSL connection.
Shodan Maps (maps.shodan.io) allows you to conduct any of these searches based on location alone while 
Shodan Images (images.shodan.io) displays collected webcam captures from open devices. Figure 24.02 
displays a home using an automated lighting and climate control system in Missouri located with Shodan Maps. 
These two options are premium services and require a modest fee. All Shodan features allow input of the 
following types of information for filtering.
Zoom Eye (zoomcyc.org)
This Shodan competitor provides a similar sendee, often with unique results. A direct URL query follows.
https://www.zoomeye.org/ searchRcsult?q=70.39.110.82
Threat Crowd (tlircatcrowd.org)
https://www.threatcrowd.org/ip.phpPip=70.39.110.82
Censys (ccnsys.io)
https://censys.io/ipv4/70.39.110.82
Ipv6 Addresses
Email Headers
392 Chapter 24
As mentioned in the previous chapter, Threat Crowd is a system for finding and researching artifacts relating to 
cyber threats. Searching an IP address can reveal an association to malicious software being spread over the 
internee A positive result wall display the type of malware, associated domain names, dates of discover)', and any 
comments by other researchers. Most readers that actually need this type of service likely already know more 
about it than me. However, it should be a consideration when investigating suspicious IP addresses. A URL 
query’ follows.
I no longer teach email header analysis in my live courses. The vast majority of users rely on web-based email 
such as Gmail or Yahoo. These services do not disclose the IP address of an individual user within the email 
headers. The only email headers that I have encountered over the past three years that contained valuable IP 
addresses were business users that sent emails within a desktop client such as Oudook. If you would like to 
analyze an email header in order to identify’ the IP address and sender information, you have two options. You 
can look through a few sites and teach yourself how to read this confusing data, or y’ou can use an automated 
sendee.
h ttps://www.ultratools.com/tools/ipv6InfoResult?ip Address=2001 :db8::8a2e:370:7334 
https://www.ultratools.com/tools/ping6?ip Address=2001 :db8::8a2e:370:7334
The first presents the standard view while the second offers text-only’ details which may' be more valuable to a 
report The final option looks at all available details about the domain throughout several scans over time. Each 
entry' displays a date in the format of 2020-04-26T07:49:17 (April 26, 2020 at 7:49 am).
The IP addresses previously mentioned were all version four (Ipv4), such as 192.168.1.1. Due to limited 
availability’, many providers are switching to lpv6, which allows many more addresses. A typical example may 
appear as 2001:0db8:85a3:0000:0000:8a2e:0370:7334. While many of the utilities mentioned here are adapting 
to this input, we should query’ these types of addresses through designated Ipv6 engines. I have tested dozens, 
and I find the following two to work best, both of which are included in rhe search tool.
Similarly, Censys is a search engine that enables researchers to ask questions about the hosts and networks that 
comprise the internet. Censys collects dam on hosts and websites through daily scans of the internet, in rum 
maintaining a database of how hosts and websites are configured. Researchers can interact with this data through 
a search interface. As an example, a search of 173.189.238.211 reveals it to be associated with a Schneider Electric 
BMX P34 2020 device through a Windstream provided internet connection, located near Kansas City’, Kansas. 
A URL query follows.
Obtaining a Target’s IP Address
IP Logger (iplogger.org)
http://www.iplogger.org/3ySz.jpg
http://www.iplogger.org/23fq.jpg
IP Addresses 393
For many years, this was my favorite option for identifying the IP address of a target. There are many options 
now, and most of them will be explained here. This specific technique involves some trickery and the need to 
contact the target from a covert account. For this demonstration, assume your target has a Facebook page that 
he checks regularly. You can send him a private message that includes "bait" in the form of an online link. A 
detailed set of instructions should explain the processes. The main website presents several options, but only 
the "URL & Image Shortener" service will be explained.
IP2Location (ip21ocation.com/free/email-tracer) provides a large text box into which an entire email header 
can be copied for analysis. The response includes the IP address and location of the sender; interactive map 
identifying the originating location; internet service provider; and links to additional information from an IP 
search. Anyone wanting more information from an email threat should start here. An alternative site that 
conducts similar actions is MX Toolbox (mxtoolbox.com/EmailHeadcrs.aspx).
The first link forwards to the image that I provided. During this process, the IP address, operating system, and 
browser details are collected and stored on the page that stored the links. The second link could be inserted 
directly into a web page or email message. Upon loading either, the image is present and collects the same data.
Link: You can generate a URL which will redirect to any website that you provide. IP Logger will save the IP 
address of each user who clicked the link. In the box provided, enter any address that you want the target to see 
when clicking on a link. This could be something generic such as cnn.com. After submitting, you will receive a 
series of links. This page also serves as the log of visitors, and I recommend documenting it In an example, I 
received the following link at the beginning of this list.
Real World Application: I was once communicating with an unknown subject on a web forum about hacking 
and stolen credit card numbers. I wanted to find out his IP address in order to discover his true identity with a 
court order. 1 told the hacker I had an image of a freshly stolen debit card that I was willing to share. He 
requested proof, so I created an IP Logger link based on a generic online image, and embedded that link into 
the web forum where we were communicating. Within a few moments, I visited the log for this image and 
discovered his IP address in Newark, New Jersey.
Although the link appears to be a jpg image, clicking this link or typing it into a browser forwards the target to 
cnn.com. This action collects his or her IP address, operating system, and browser details. These details, along 
with the date and time of capture, can be viewed at the link generated previously. A URL shortening service 
such as Bitly (bit.ly) would make the link look less suspicious.
Image: You can provide a digital image to this service, and it will create a tracker out of it for placement onto 
a website, forum, or email message. I provided an image that is present on my website at 
inteltechniques.com/img/bh2016.png. This presented a page similar to the previous example. I was provided 
the following links.
You may want to know the IP address of the person you are researching as provided by their internet sendee 
provider. This address could be used to verify an approximate location of the person; to provide law 
enforcement details that would be needed for a court order; or to determine if multiple email addresses belong 
to the same subject. All of those scenarios will be explained here while I explain the various services that can be 
used.
Canary Tokens (canarytokens.org)
https://inteltcchniqucs.com/canary
LinkBait (github.com/2YmlJesse/LinkBait)
394 Chapter 24
Always remember that technologies such as VPNs, Tor, and other forms of IP masking may create inaccurate 
results. Always use caution when sending these types of trackers, and make sure you are nor violating any laws 
or internal policies. Due to the heavy usage of VPNs within the communities in which I investigate, I find these 
sendees slowly becoming less useful.
rv:81.0) Gecko/20100101
There is a glaring problem with all of these public IP logging sendees. They are well-known and may be blocked 
by email providers. Gmail typically blocks any domains associated with either IP Logger or Canary Tokens. A 
tech-sawy target may recognize these tactics which could jeopardize your investigation. This is why I rely on 
my own self-hosted option made by my colleague Jesse. The link above includes all files required to host your 
own IP Logger on your website. You simply need to copy the PI-IP file into a web-accessible director}’ on your 
Apache web server, including shared web hosts. I renamed the file to "index.php" and placed it on my website 
at https://inteltechniques.com/site/index.php. If you visited that page by clicking a link I had sent to you, a 
text file would have been generated in that folder. The tide would have included the date and your IP address. 
The following represents a partial view of the content submitted by your computer. This page is nor currently 
live because I do nor want to log visitors to my site.
A newer option for IP identification is Canary Tokens. It offers redundant functionality’ as the previously 
mentioned product, but may be more useful to you. Ultimately, you should familiarize yourself with all options 
and choose which works best for you. Lately, I have found Canary’ Tokens to be the superior option of all. It 
allows creation of a PDF or DOCX file that contains a tracker, and is the most user-friendly' of the sendees. 
After choosing a tracking option, it walks you through the process. I maintain a few Canary’ Token files at the 
following address. They are used as traps for people that conduct Google searches attempting to find my home 
address. Opening any’ of these alerts me to your IP address and general location. Ar the time of this writing, the 
most recent opening of one of these documents occurred only' two days prior. The culprit lives in Matawan, 
New Jersey, possesses MCI as an internet provider, and had recently downloaded an Xbox 360 game through a 
torrent.
70.39.126.131
Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14;
Firefox/81.0
touch: false / mic: Found / gpu: AMD Radeon Pro 560X OpenGL Engine 
Screen Height: 1080
Language: en-US