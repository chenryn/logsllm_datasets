convenient way, and (2) recursively removing all ASes that
had no providers that had low degree (and were not Tier 1
ISPS). The resulting graph had 39056 ASes, 73442 customer-
provider links and 62129 peer-to-peer links. Because empiri-
cal AS graphs often miss many of peer-to-peer links in Inter-
net eXchange Points (IXP) [3, 5, 45], we constructed a sec-
ond graph where we augmented the UCLA graph with over
550K peer-to-peer edges between ASes listed as members of
the same IXP (on September 24, 2012) on voluntary online
sources (IXPs websites, EuroIX, Peering DB, Packet Clear-
ing House, etc.). Our list contained 332 IXPs and 10,835
mappings of member ASes to IXPs; after connecting every
pair of ASes that are present in the same IXP (and were not
already connected in our original UCLA AS graph) with a
peer-to-peer edge, our graph was augmented with 552933
extra peering links. Because not all ASes at an IXP peer
with each other [3], our augmented graph is an upper bound
on the number of missing links in the AS graph. When we
repeated our simulations on this second graph, we found
that all the aggregate trends we discuss in subsequent sec-
tions still hold, which suggests they are robust to missing
IXP edges. (Results in Appendix J.)
S*BGP routing. ASes running BGP compute routes to
each destination AS d ∈ V independently. For every desti-
nation AS d ∈ V , each source AS s ∈ V \{d} repeatedly uses
its local BGP decision process to select a single “best” route
to d from routes it learns from neighboring ASes. s then
announces this route to a subset of its neighbors according
to its local export policy. An AS s learns a route or has
an available route R if R was announced to s by one of its
neighbors; AS s has or uses a route R if it chooses R from
its set of available routes. AS s has customer (resp., peer,
provider) route if its neighbor on that route is a customer
(resp., peer, provider); see e.g., AS 29518 in Figure 1 left.
2.2.1
When choosing between many routes to a destination d,
Insecure routing policy model.
each insecure AS executes the following (in order):
Local pref (LP): Prefer customer routes over peer routes.
Prefer peer routes over provider routes.
AS paths (SP): Prefer shorter routes over longer routes.
Tiebreak (TB): Use intradomain criteria (e.g., geographic
location, device ID) to break ties among remaining routes.
After selecting a single route as above, an AS announces
that route to a subset of its neighbors:
Export policy (Ex):
In the event that the route is via a
customer, the route is exported to all neighbors. Otherwise,
the route is exported to customers only.
The relative ranking of the LP, SP, and TB are standard in
most router implementations [13]. The LP and Ex steps are
based on the classical economic model of BGP routing [16,
17,25,26]. LP captures ASes’ incentives to send traﬃc along
revenue-generating customer routes, as opposed to routing
through peers (which does not increase revenue), or routing
through providers (which comes at a monetary cost). Ex
Figure 1: S*BGP Wedgie.
Secure routing policy models.
captures ASes’s willingness to transit traﬃc only when paid
to do so by a customer.
Robustness to LP model. While this paper reports
results for the above LP model, we also test their robustness
to other models for LP; results are in Appendix K.
2.2.2
Every secure AS also adds this step to its routing policy.
Secure paths (SecP): Prefer a secure route over an inse-
cure route.
We consider three models for incorporating the SecP step:
Security 1st. The SecP is placed before the LP step; this
model supposes security is an AS’s highest priority.
Security 2nd. The SecP step comes between the LP and
SP steps; this model supposes that an AS places economic
considerations above security concerns.
Security 3rd. The SecP step comes between SP and TB
steps; this model, also used in [19], supposes security is pri-
oritized below business considerations and AS-path length.
2.2.3 The security 1st model is unpopular.
While the security 1st model is the most “idealistic” from
the security perspective, it is likely the least realistic. During
incremental deployment, network operators are expected to
cautiously incorporate S*BGP into routing policies, placing
security 2nd or 3rd, to avoid disruptions due to (1) changes
to traﬃc engineering, and (2) revenue lost when expensive
secure routes are chosen instead of revenue-generating cus-
tomer routes. The security 1st model might be used only