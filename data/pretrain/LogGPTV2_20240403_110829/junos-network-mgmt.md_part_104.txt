any critical;
}
1301
Table 138 on page 1301 specifies which messages in a routing matrix are included in the logs on the
T1600 routers and the TX Matrix Plus router. The T1600 routers forward only those messages with
severity critical and higher, so the log on the TX Matrix Plus router does not include the messages with
severity error, warning, or notice that the T1600 routers log locally.
Table 138: Example: Local Severity Is notice, Forwarded Severity Is critical
Log Location Source of Messages Lowest Severity Included
T1600 router Local notice
TX Matrix Plus router Local notice
Forwarded from T1600 routers critical
Messages Logged When the Local Severity Level Is Higher
When the severity level is higher for local messages than for forwarded messages, the log on the TX
Matrix Plus router includes fewer forwarded messages than when the severities are the same, and all
local logs contain fewer messages overall.
For example, you can specify severity critical for the /var/log/messages file and severity notice for
forwarded messages:
[edit system syslog]
file messages {
any critical;
}
host sfc0-master {
any notice;
}
Table 139 on page 1302 specifies which messages are included in the logs on the T1600 routers and the
TX Matrix Plus router. Although the T1600 routers forward messages with severity notice and higher, the
TX Matrix Plus router discards any of those messages with severity lower than critical (does not log
forwarded messages with severity error, warning, or notice). None of the logs include messages with
severity error or lower.
1302
Table 139: Example: Local Severity Is critical, Forwarded Severity Is notice
Log Location Source of Messages Lowest Severity Included
T1600 router Local critical
TX Matrix Plus router Local critical
Forwarded from T1600 routers critical
Configuring Optional Features for Forwarded Messages on a TX Matrix
Router
IN THIS SECTION
Including Priority Information in Forwarded Messages | 1303
Adding a Text String to Forwarded Messages | 1303
Using Regular Expressions to Refine the Set of Forwarded Messages | 1304
To configure additional optional features when specifying how the T640 routers forward messages to
the TX Matrix router, include statements at the [edit system syslog host scc-master] hierarchy level. To
include priority information (facility and severity level) in each forwarded message, include the explicit-
priority statement. To insert a text string in each forwarded message, include the log-prefix statement. To
use regular expression matching to specify more exactly which messages from a facility are forwarded,
include the match statement.
[edit system syslog]
host scc-master {
facility severity;
explicit-priority;
log-prefix string;
1303
match "regular-expression";
}
You can also include the facility-override statement at the [edit system syslog host scc-master] hierarchy
level, but we do not recommend doing so. It is not necessary to use alternative facilities for messages
forwarded to the TX Matrix router, because it runs the Junos system logging utility and can interpret the
Junos OS-specific facilities. For more information about alternative facilities, see "Changing the
Alternative Facility Name for System Log Messages Directed to a Remote Destination" on page 1318.
Including Priority Information in Forwarded Messages
When you include the explicit-priority statement at the [edit system syslog host scc-master] hierarchy
level, messages forwarded to the TX Matrix router include priority information. For the information to
appear in a log file on the TX Matrix router, you must also include the explicit-priority statement at the
[edit system syslog file filename] hierarchy level for the file on the TX Matrix router. As a consequence,
the log file with the same name on each platform in the routing matrix also includes priority information
for locally generated messages.
To include priority information in messages directed to a remote machine from all routers in the routing
matrix, also include the explicit-priority statement at the [edit system syslog host hostname] hierarchy level
for the remote machine. For more information, see "Directing Messages to a Remote Destination from
the Routing Matrix Based on the TX Matrix Router" on page 1323.
In the following example, the /var/log/messages file on all routers includes priority information for
messages with severity notice and higher from all facilities. The log on the TX Matrix router also includes
messages with those characteristics forwarded from the T640 routers.
[edit system syslog]
host scc-master {
any notice;
explicit-priority;
}
file messages {
any notice;
explicit-priority;
}
Adding a Text String to Forwarded Messages
When you include the log-prefix statement at the [edit system syslog host scc-master] hierarchy level, the
string that you define appears in every message forwarded to the TX Matrix router. For more
information, see "Adding a Text String to System Log Messages Directed to a Remote Destination" on
page 1317.
1304
Using Regular Expressions to Refine the Set of Forwarded Messages
When you include the match statement at the [edit system syslog host scc-master] hierarchy level, the
regular expression that you specify controls which messages from the T640 routers are forwarded to the
TX Matrix router. The regular expression is not applied to messages from the T640 router that are
directed to destinations other than the TX Matrix router. For more information about regular expression
matching, see "Using Strings and Regular Expressions to Refine the Set of Logged Messages" on page
1281.
Configuring Optional Features for Forwarded Messages on a TX Matrix
Plus Router
IN THIS SECTION
Including Priority Information in Forwarded Messages | 1305
Adding a Text String to Forwarded Messages | 1305
Using Regular Expressions to Refine the Set of Forwarded Messages | 1306
From the perspective of the user interface, the routing matrix appears as a single router. The TX Matrix
Plus router (also called the switch-fabric chassis SFC) controls all the T1600 or T4000 routers (also
called the line-card chassis LCC) in the routing matrix.
To configure additional optional features when specifying how the connected T1600 or T4000 LCCs
forward messages to the SFC, include statements at the [edit system syslog host sfc0-master] hierarchy
level. To include priority information (facility and severity level) in each forwarded message, include the
explicit-priority statement. To insert a text string in each forwarded message, include the log-prefix
statement. To use regular expression matching to specify more exactly which messages from a facility
are forwarded, include the match statement.
[edit system syslog]
host sfc0-master {
facility severity;
explicit-priority;
log-prefix string;
1305
match "regular-expression;
}
You can also include the facility-override statement at the [edit system syslog host sfc0-master] hierarchy
level, but we do not recommend doing so. It is not necessary to use alternative facilities for messages
forwarded to the SFC, because it runs the Junos system logging utility and can interpret the Junos OS-
specific facilities. For more information about alternative facilities, see "Changing the Alternative Facility
Name for System Log Messages Directed to a Remote Destination" on page 1318.
Including Priority Information in Forwarded Messages
When you include the explicit-priority statement at the [edit system syslog host sfc0-master] hierarchy
level, messages forwarded to the TX Matrix Plus router (or the SFC) include priority information. For the
information to appear in a log file on the SFC, you must also include the explicit-priority statement at
the [edit system syslog file filename] hierarchy level for the file on the SFC. As a consequence, the log file
with the same name on each platform in the routing matrix also includes priority information for locally
generated messages.
To include priority information in messages directed to a remote machine from all routers in the routing
matrix, also include the explicit-priority statement at the [edit system syslog host hostname] hierarchy level
for the remote machine. For more information, see "Directing Messages to a Remote Destination from
the Routing Matrix Based on a TX Matrix Plus Router" on page 1324.
In the following example, the /var/log/messages file on all routers includes priority information for
messages with severity notice and higher from all facilities. The log on the TX Matrix Plus router SFC also
includes messages with those characteristics forwarded from the connected T1600 or T4000 LCCs.
[edit system syslog]
host sfc0-master {
any notice;
explicit-priority;
}
file messages {
any notice;
explicit-priority;
}
Adding a Text String to Forwarded Messages
When you include the log-prefix statement at the [edit system syslog host sfc0-master] hierarchy level, the
string that you define appears in every message forwarded to the TX Matrix Plus router. For more
information, see "Adding a Text String to System Log Messages Directed to a Remote Destination" on
page 1317.
1306
Using Regular Expressions to Refine the Set of Forwarded Messages
When you include the match statement at the [edit system syslog host sfc0-master] hierarchy level, the
regular expression that you specify controls which messages from the connected T1600 or T4000 LCCs
are forwarded to the TX Matrix Plus SFC. The regular expression is not applied to messages from the
connected LCCs that are directed to destinations other than the SFC. For more information about
regular expression matching, see "Using Strings and Regular Expressions to Refine the Set of Logged
Messages" on page 1281.
Configuring System Logging Differently on Each T640 Router in a Routing
Matrix
We recommend that all routers in a routing matrix composed of a TX Matrix router and T640 routers
use the same configuration, which implies that you include system logging configuration statements on
the TX Matrix router only. In rare circumstances, however, you might choose to log different messages
on different routers. For example, if one router in the routing matrix is experiencing problems with
authentication, a Juniper Networks support representative might instruct you to log messages from the
authorization facility with severity debug on that router.
To configure routers separately, include configuration statements in the appropriate groups at the [edit
groups] hierarchy level on the TX Matrix router:
• To configure settings that apply to the TX Matrix router but not the T640 routers, include them in the
re0 and re1 configuration groups.
• To configure settings that apply to particular T640 routers, include them in the lccn-re0 and lccn-re1
configuration groups, where n is the line-card chassis (LCC) index number of the router.
When you use configuration groups, do not issue CLI configuration-mode commands to change
statements at the [edit system syslog] hierarchy level on the TX Matrix router. If you do, the resulting
statements overwrite the statements defined in configuration groups and apply to the T640 routers also.
(We further recommend that you do not issue CLI configuration-mode commands on the T640 routers
at any time.)
The following example shows how to configure the /var/log/messages files on three routers to include
different sets of messages:
• On the TX Matrix router, local messages with severity info and higher from all facilities. The file does
not include messages from the T640 routers, because the host scc-master statement disables message
forwarding.
• On the T640 router designated LCC0, messages from the authorization facility with severity info and
higher.
1307
• On the T640 router designated LCC1, messages with severity notice from all facilities.
[edit groups]
re0 {
system {
syslog {
file messages {
any info;
}
host scc-master {
any none;
}
}
}
}
re1 {
... same statements as for re0 ...
}
lcc0-re0 {
system {
syslog {
file messages {
authorization info;
}
}
}
}
lcc0-re1 {
... same statements as for lcc0-re0 ...
}
lcc1-re0 {
system {
syslog {
file messages {
any notice;
}
}
}
}
lcc0-re1 {
1308
... same statements as for lcc1-re0 ...
}
Configuring System Logging Differently on Each T1600 or T4000 Router
in a Routing Matrix
We recommend that all routers in a routing matrix composed of a TX Matrix Plus router with T1600 or
T4000 routers use the same configuration, which implies that you include system logging configuration
statements on the TX Matrix Plus router only. In rare circumstances, however, you might choose to log
different messages on different routers. For example, if one router in the routing matrix is experiencing
problems with authentication, a Juniper Networks support representative might instruct you to log
messages from the authorization facility with severity debug on that router.
To configure routers separately, include configuration statements in the appropriate groups at the [edit
groups] hierarchy level on the TX Matrix Plus router:
• To configure settings that apply to the TX Matrix Plus router but not the T1600 or T4000 routers,
include them in the re0 and re1 configuration groups.
• To configure settings that apply to particular T1600 or T4000 routers, include them in the lccn-re0
and lccn-re1 configuration groups, where n is the line-card chassis (LCC) index number of the router.
When you use configuration groups, do not issue CLI configuration-mode commands to change
statements at the [edit system syslog] hierarchy level on the TX Matrix Plus router. If you do, the resulting
statements overwrite the statements defined in configuration groups and apply to the T1600 or T4000
routers also. (We further recommend that you do not issue CLI configuration-mode commands on the
T1600 or T4000 routers at any time.)
For more information about the configuration groups for a routing matrix, see the chapter about
configuration groups in the Junos OS CLI User Guide .
The following example shows how to configure the /var/log/messages files on three routers to include
different sets of messages:
• On the TX Matrix Plus router, local messages with severity info and higher from all facilities. The file
does not include messages from the T1600 or T4000 routers, because the host sfc0-master statement
disables message forwarding.
• On the T1600 or T4000 router designated LCC0, messages from the authorization facility with severity
info and higher.
1309
• On the T1600 or T4000 router designated LCC1, messages with severity notice from all facilities.
[edit groups]
re0 {
system {
syslog {
file messages {
any info;
}
host sfc0-master {
any none;
}
}
}
}
re1 {
... same statements as for re0 ...
}
lcc0-re0 {
system {
syslog {
file messages {
authorization info;
}
}
}
}
lcc0-re1 {
... same statements as for lcc0-re0 ...
}
lcc1-re0 {
system {
syslog {
file messages {
any notice;
}
}
}
}
lcc0-re1 {
1310
... same statements as for lcc1-re0 ...
}
Direct System Log Messages to a Remote
Destination
IN THIS SECTION
Specify the Facility and Severity of Messages to Include in the Log | 1310
Direct System Log Messages to a Log File | 1313
Direct System Log Messages to a User Terminal | 1314
Direct System Log Messages to the Console | 1315
Direct System Log Messages to a Remote Machine or the Other Routing Engine | 1315
Specify an Alternative Source Address for System Log Messages Directed to a Remote Destination | 1316
Add a Text String to System Log Messages Directed to a Remote Destination | 1317
Change the Alternative Facility Name for System Log Messages Directed to a Remote Destination | 1318
Default Facilities for System Log Messages Directed to a Remote Destination | 1320
Alternate Facilities for System Log Messages Directed to a Remote Destination | 1320
Examples: Assign an Alternative Facility to System Log Messages Directed to a Remote Destination | 1322
Direct Messages to a Remote Destination from the Routing Matrix Based on the TX Matrix Router | 1323
Direct Messages to a Remote Destination from the Routing Matrix Based on a TX Matrix Plus Router | 1324
Specify the Facility and Severity of Messages to Include in the Log
Each system log message belongs to a facility, which groups together messages that either are
generated by the same source (such as a software process) or concern a similar condition or activity
(such as authentication attempts). Each message is also preassigned a severity level, which indicates how
seriously the triggering event affects routing platform functions.
1311
When you configure logging for a facility and destination, you specify a severity level for each facility.
Messages from the facility that are rated at that level and higher are logged to the following destination:
[edit system syslog]
(console | file filename | host destination | user username) {
facility severity ;
}
For more information about the destinations, see "Directing System Log Messages to a User Terminal"
on page 1314, and, "Directing System Log Messages to the Console" on page 1315.
To log messages belonging to more than one facility to a particular destination, specify each facility and
associated severity as a separate statement within the set of statements for the destination.
Table 140 on page 1311 lists the Junos OS system logging facilities that you can specify in configuration
statements at the [edit system syslog] hierarchy level.
Table 140: Junos OS System Logging Facilities
Facility Type of Event or Error
any All (messages from all facilities)
authorization Authentication and authorization attempts
change-log Changes to the Junos OS configuration
conflict-log Specified configuration is invalid on the router type
daemon Actions performed or errors encountered by system processes
dfc Events related to dynamic flow capture
explicit-priority Include priority and facility in system log messages
external Actions performed or errors encountered by the local external applications
1312
Table 140: Junos OS System Logging Facilities (Continued)
Facility Type of Event or Error
firewall Packet filtering actions performed by a firewall filter
ftp Actions performed or errors encountered by the FTP process
interactive-commands Commands issued at the Junos OS command-line interface (CLI) prompt or by a client
application such as a Junos XML protocol or NETCONF XML client
kernel Actions performed or errors encountered by the Junos OS kernel
ntp Actions performed or errors encountered by the Network Time Protocol processes
pfe Actions performed or errors encountered by the Packet Forwarding Engine
security Security related events or errors
user Actions performed or errors encountered by user-space processes
Table 141 on page 1312 lists the severity levels that you can specify in configuration statements at the
[edit system syslog] hierarchy level. The levels from emergency through info are in order from highest
severity (greatest effect on functioning) to lowest.
Unlike the other severity levels, the none level disables logging of a facility instead of indicating how
seriously a triggering event affects routing functions. For more information, see "Disabling the System
Logging of a Facility" on page 1285.
Table 141: System Log Message Severity Levels
Value Severity Level Description
N/A none Disables logging of the associated facility to a destination
0 emergency System panic or other condition that causes the router to stop functioning
1313