## Syslog {#c09.xhtml#head-2-67}
The amount of digital data we produce is astounding. According to
`www.internetlivestats.com`, Google alone processes more than 40,000
searches every single second. When you click a link, you generate a log.
Around the globe, every second of the day, computer networks are
generating logs. According to the same website, we create 2.5
quintillion bytes of data every single day. Honestly, without searching
Google to define *quintillion*, I don\'t know how many digits that is.
So I just Googled it. It\'s a billion billion, or 18 zeros after the 1.
Some of these logs are routine, and some of these indicate poor network
health or a malicious attempt to breach your network. Log files contain
a wealth of information to reduce exposure to intruders, malware, and
legal issues. Log data needs to be collected, stored, analyzed, and
monitored to meet and report on regulatory compliance standards such as
HIPAA, FISMA, FERPA, PCI DSS, or the newest global compliance standard
focused on privacy, GDPR. This is an incredible and overwhelming task.
[]{#c09.xhtml#Page_118 .pagebreak title="118"
role="doc-pagebreak"}Syslog is a way for network devices to send a
message to a logging server. It is supported by a wide range of devices.
It can be used to log different types of events. Syslog is an awesome
way to consolidate logs from many different sources, in different
formats, and in massive volumes into a single location. If you don\'t
have a log management strategy in place to monitor and secure connected
devices, the results can be difficult to overcome if at all.
Using a syslog server to collect and store syslog messages provides a
reliable central repository for log data. Syslog uses UDP communication
to send messages to a central collector, also known as a *syslog
server*. Syslog messages are used to troubleshoot network problems,
establish forensic evidence, and prove compliance. Forwarding syslog
messages to a central syslog server helps you correlate events across
your network.
Typically, most Syslog servers have the following components:
-   [**Syslog Listener** A Syslog server needs to receive messages sent
    over the network. A listener process gathers syslog data sent over
    UDP port 514. UDP is not connection oriented, so messages aren\'t
    acknowledged. In some cases, network devices will send Syslog data
    over connection‐oriented TCP 1468 to ensure and confirm
    delivery.]{#c09.xhtml#c09-li-0019}
-   [**Database** Large networks can generate a huge amount of Syslog
    data. Most Syslog servers will use a database to store syslog data
    to search and query.]{#c09.xhtml#c09-li-0020}
-   [**Management Software** With so much data, it is like looking for a
    specific needle in a haystack. Use a syslog server that automates
    part of the work. Syslog servers should be able to generate alerts,
    notifications, and alarms in response to select messages. If you
    read the Verizon report, you know you have 16 minutes from
    compromise before the first click on a phishing campaign. As a
    security administrator, you need to be able to work
    quickly.]{#c09.xhtml#c09-li-0021}
A log management solution aggregates, indexes, parses, and generates
metrics. Syslog messages are generated by operating systems and
applications---as well as processes on printers, routers, and
switches---and are configured to be sent to your syslog server. If your
network includes Windows systems, the syslog server can help you manage
Windows event log information.
Logs where there are many login attempts on a single account from
diverse geographic locations or other suspicious system activities is a
situation any administrator will want to investigate. Proactive,
automated detection of unusual activity is critical. Cybersecurity is
incredibly dynamic, and we do not know every single potential attack
pattern in advance, so monitoring for this type of activity is not an
easy task. If you don\'t analyze your logs to see what\'s going on,
you\'ll never be able to detect suspicious activity.
A baseline is a starting point you can use for comparisons. Create a
baseline that represents normal activity on your system so you\'re aware
when there are []{#c09.xhtml#Page_119 .pagebreak title="119"
role="doc-pagebreak"}anomalies occurring. A few failed login attempts by
a user might be considered normal, but hundreds or thousands of failed
login attempts might point to a brute‐force or malicious attack.
Consolidating and centrally managing all your logs is different from
logging each and every event. The big question of what events to record
and how much you need to log is a problem best addressed by an audit.
With the right coordination, an auditor along with your legal department
focused on compliance with a technical CISO\'s perspective can give
consideration as to what the right level of information is. These
questions typically need to be answered for every component of your
system and be well documented so you are able to easily scale in the
future. For most assets, you will probably stick with their defaults.
The only major operating system that does not have built‐in support for
sending syslog is Microsoft Windows. Windows includes PowerShell, and
PowerShell can use the .NET Framework to send UDP packets to a syslog
server.
Another crucial thing to think about is your data retention needs. How
long do you need to keep the logs? Do you need them for troubleshooting?
Are there regulatory or audit requirements that require you to keep the
logs for a certain period of time?
When I was teaching CISSP for ISC^2^, one of the best tools they gave us
to teach with was 250 retired questions. I remember one specifically
concerning logs:
> ::: feature3
> **"You are a system administrator. Your organization\'s security
> policy states that you keep logs for 3 years. You have kept logs for 5
> years. You have been subpoenaed for 5 years of logs. What do you
> legally have to give the authorities?"**
> :::
The answer is you have to turn over everything you have. We have to
trust that the management team has put security policies in place for a
reason. If we disagree with the policy, it is our responsibility as
cyber professionals to pursue a discussion with the chain of command
until either we understand why the policy is in place or we change the
policy. Otherwise, the violation of keeping records too long could open
up potential damaging and sometimes legal issues.
Your daily log volume might already be substantial, but it can increase
exponentially when a device fails. The resulting log messages could
easily quintuple the number of log messages that get generated.
Log files come in a variety of formats. Some formats follow more
traditional standards, while others are completely custom. Your log
solution should be able to parse and present the data in a comprehensive
form in near real time, and it should allow you to define custom parsing
rules. Parsing is breaking down a log into smaller, better digestible
messages and putting them into their own groups so that you can analyze
and even visualize them in order to identify data
inconsistencies.[]{#c09.xhtml#Page_120 .pagebreak title="120"
role="doc-pagebreak"}
:::
::: section
[]{#c09.xhtml#c09-sec-0008}
## SolarWinds Kiwi {#c09.xhtml#head-2-68}
SolarWinds Kiwi Syslog Server has a free edition where you can collect,
view, and archive syslog messages. It is easy to set up and configure
how it receives, logs, displays, and forwards syslog messages from
network devices, such as routers, switches, Unix hosts, and other
syslog‐enabled devices.
The free version of Kiwi will allow you to get statistics in real time
from five sources, with summaries available in the console. You will
also be able to receive and manage syslog messages from network devices
and view syslog messages in multiple windows.
Just like any other software, you will want to make sure that your
system meets the hardware and software requirements and that you\'ve
opened the appropriate ports so communication can occur. In Kiwi Syslog
Server, you will need Windows 7 or newer, Internet access, and at least
4 GB of disk space. Kiwi Syslog Server uses the ports listed in [Table
9.1](#c09.xhtml#c09-tbl-0001){#c09.xhtml#R_c09-tbl-0001}.
```{=html}
```
```{=html}
```
[**[Table 9.1](#c09.xhtml#R_c09-tbl-0001){#c09.xhtml#c09-tbl-0001
role="doc-backlink"}:**]{.figureLabel} Ports used by Kiwi Syslog Server
Source: `https://support.solarwinds.com`
```{=html}
```
  PORT             PROTOCOL   PURPOSE
  ---------------- ---------- ------------------------------------------------------------------
  514 (default)    UDP        Incoming UDP messages
  1468 (default)   TCP        Incoming TCP messages
  162 for IPv4     UDP        Incoming SNMP traps
  163 for IPv6                
  6514             TCP        Incoming secure TCP messages
  3300             TCP        Internal communication between Syslog service and Syslog Manager
  8088 (default)   TCP        Kiwi Syslog Web Access
```{=html}
```
To download and install this syslog server solution, search in your
browser for ***Solarwinds kiwi syslog server free***, and it will easily
take you to the download file. You will need to supply some information
to create an account, and then you will receive the link to download the
software. As you see in [Figure
9.10](#c09.xhtml#c09-fig-0010){#c09.xhtml#R_c09-fig-0010}, you have a
choice to make when you start installing the software. You can choose
either Install Kiwi Syslog Server As A Service on your Windows machine
or Install Kiwi Syslog Server As An Application on your Windows machine.
If you choose to install it as an application, you will be required to
log in as a user before you can use the product. I have installed it as
a service because it also installs the Kiwi Syslog Server Manager, which
you will use to control the service.
![[**[Figure 9.10](#c09.xhtml#R_c09-fig-0010){#c09.xhtml#c09-fig-0010
role="doc-backlink"}:**]{.figureLabel} Choosing a service or application
operating mode with Kiwi Syslog Server](Images/c09f010.jpg){.center
width="498" height="384"}
[]{#c09.xhtml#Page_121 .pagebreak title="121" role="doc-pagebreak"}The
road map to begin collecting syslog data starts with configuring devices
on your network to send the proper logs so that you can start to save,
digest, analyze, and be alerted to issues in your environment. In my
example, I have collected syslog off a router to give you an idea of
what this will look like in Kiwi Syslog Server. In your environment, it
will be dependent on what devices you want to send syslog from. You will
have to access your device product guide to find out whether enabling
syslog can be accomplished through the application GUI or the hardware
CLI. Either way, you configure the asset to send logs to one central
location.
If you have configured the Kiwi Syslog Server and no logs can be
detected from an asset you are attempting to collect logs from, as shown
in [Figure 9.11](#c09.xhtml#c09-fig-0011){#c09.xhtml#R_c09-fig-0011},
you can test the server to make sure it is actually running.
![[**[Figure 9.11](#c09.xhtml#R_c09-fig-0011){#c09.xhtml#c09-fig-0011
role="doc-backlink"}:**]{.figureLabel} Successful test message on Kiwi
Syslog Server](Images/c09f011.jpg){.center width="643" height="148"}
If the syslog server does not display the success message, then you\'ll
want to check to see whether the service has initiated properly. Go to
the Manage menu to start, stop, or ping the service and see whether it
is running. As you learned in [Chapter 1](../Text/c01.xhtml),
"Fundamental Networking and Security Tools," you can run the
`netstat ‐ano` command to see whether there are any active network
[]{#c09.xhtml#Page_122 .pagebreak title="122" role="doc-pagebreak"}ports
using UDP 514, the default port that syslog will use to communicate. If
a different process is consuming UDP 514, open your Task Manager by
pressing Ctrl+Alt+Delete and ending that task. Return to the Manage menu
in Kiwi Syslog Server and restart the service, and it will take its
place on UDP port 514.
According to Request for Comments (RFC) 5424, the document provided by
the Internet Engineering Task Force (IETF) that specifies and defines
the syslog protocol, syslog will convey event notification messages
using an architecture that supports different transport protocols. This
RFC defines syslog as having three layers: content, application, and
transport. There is no rule on how long a syslog will be, but it will
contain at least a timestamp, a hostname or IP address of the device
sending the message, and the message data itself. The message data is
usually human readable like you see in the example in [Figure
9.12](#c09.xhtml#c09-fig-0012){#c09.xhtml#R_c09-fig-0012}.
![[**[Figure 9.12](#c09.xhtml#R_c09-fig-0012){#c09.xhtml#c09-fig-0012
role="doc-backlink"}:**]{.figureLabel} Anatomy of a syslog
message](Images/c09f012.jpg){.center width="720" height="127"}
Once you have logs flowing into the syslog server, it is time to
consider what rules will be applied to the log information. The rules
determine what happens when the syslog server sees certain items in a
log and what action it takes. You can create rules to log all messages,
send an email if something critical occurs, and even run a script if a
log contains a certain word. When you begin building your rules, as you
saw in [Figure 9.12](#c09.xhtml#c09-fig-0012), you will be using filters
and actions. In Kiwi Syslog Server, you can have up to 100 rules, and
each rule has up to 100 possible filters and 100 possible actions.
If you have ever built rules on a firewall, building rules in a syslog
server is similar. When the server sees a message and that message meets
the criteria for the first rule, it is then passed to the second rule,
if there is one. You must build the rules in the order in which you want
them to apply. When a rule applies to a message, the filters will start
matching TRUE or FALSE. If the first filter returns TRUE, it will
attempt to match the second filter. If the filter returns FALSE, the
next message is processed. For example, [Figure
9.13](#c09.xhtml#c09-fig-0013){#c09.xhtml#R_c09-fig-0013} shows the
workflow of a rule matching the first filter but not matching the
second.
![[**[Figure 9.13](#c09.xhtml#R_c09-fig-0013){#c09.xhtml#c09-fig-0013
role="doc-backlink"}:**]{.figureLabel} Syslog message being filtered by
rules](Images/c09f013.jpg){.center width="661" height="397"}
[]{#c09.xhtml#Page_123 .pagebreak title="123" role="doc-pagebreak"}The
default rule in Kiwi Syslog Server applies two actions to all messages
flowing into the server.
-   [Display each message on the console]{#c09.xhtml#c09-li-0022}
-   [Log each message to the `SyslogCatchAll.txt`
    file]{#c09.xhtml#c09-li-0023}
[Figure 9.14](#c09.xhtml#c09-fig-0014){#c09.xhtml#R_c09-fig-0014} shows
the same message being filtered by a different rule where both filters
match so an action is performed. When all actions are performed, the
server applies the next rule to the message.
![[**[Figure 9.14](#c09.xhtml#R_c09-fig-0014){#c09.xhtml#c09-fig-0014
role="doc-backlink"}:**]{.figureLabel} Syslog message being filtered by
rules and initiating an action](Images/c09f014.jpg){.center width="661"
height="397"}
[]{#c09.xhtml#Page_124 .pagebreak title="124" role="doc-pagebreak"}To
create a rule, choose the File menu and go to Setup. Click the New
button, and a new rule is added to the hierarchical tree. You can
replace New Rule with a name that will make sense to the filter and
action you want to create. When the new filter is selected as shown in
[Figure 9.15](#c09.xhtml#c09-fig-0015){#c09.xhtml#R_c09-fig-0015}, you
will see several options to filter on, including priority, IP address,
or hostname. Each field you choose will have its own unique identifiers
to be defined. Once you have defined the logged event you want to be
alerted for, you can create an action to play a sound, send an email,
run another program, or do all of these things. Multiple actions can be
staged for each rule.
![[**[Figure 9.15](#c09.xhtml#R_c09-fig-0015){#c09.xhtml#c09-fig-0015
role="doc-backlink"}:**]{.figureLabel} Creating a filter in Kiwi Syslog
Server](Images/c09f015.jpg){.center width="703" height="286"}
One consideration while building a program with ongoing operational
mechanisms is to visit the possibility of alert fatigue. In grade