concept of identifying features from passive DNS that indicate
higher rates of churn, but the features we have developed are
tailored to our domain and integrate other signals of malicious
network blocks.
VIII. CONCLUSION
In this paper, we have presented the ﬁrst publicly described
method for detecting malicious network blocks that have been
sub-allocated. As part of our methods we have highlighted
the ability to collect Whois information and merge this with
passive DNS to create a set of features that can accurately
detect malicious sub-allocated network blocks. This is useful
for detecting modern BPH services that have evolved from
operating purely static BP ASes to agile services that rent
network blocks from large service providers. After validating
our detection method we then use it to perform a large-scale
study of the malicious network blocks that it detects. This
study sheds new light on the techniques used by these BPH
services to evade AS based reputation metrics and ﬁne-grained
IP address blacklisting. We also highlight the magnitude of this
problem by detecting 39K malicious network blocks, none of
which are allocated to what are considered BP ASes and many
of which have little to no coverage in IP address blacklists.
The method we have presented is by no means optimal
and we have pointed out some of the limitation and potential
directions for future research in this area. Our hope is that the
detection methods and ecosystem analysis we presented will
serve as a building block to guide and spur additional open
research on this topic. The end result ideally being increas-
ingly effective and robust methods for detecting the evolving
techniques used by BPH services to hide their infrastructure.
ACKNOWLEDGMENT
We thank Stefan Savage and Vern Paxson for their valuable
feedback and our reviewers for their insightful comments and
suggestions. We thank Paul Pearce for his help and support.
We also thank those who provided data for our study, but wish
to remain anonymous. This work was supported in part by
National Science Foundation under grants 1223477, 1223495,
1527141, 1618493, 1237265, 1619620 and gifts from Google.
Any opinions, ﬁndings, conclusions or recommendations ex-
pressed in this paper do not necessarily reﬂect the views of
the NSF.
REFERENCES
of
[1] B. Krebs,
“Host
Internet Spam Groups
Is Cut Off,”
http://www.washingtonpost.com/wp-dyn/content/article/2008/11/
12/AR2008111200658.html, 2008.
[2] M. Goncharov, “Criminal hideouts for
lease: Bulletproof hosting
http://www.trendmicro.fr/media/wp/wp-criminal-hideouts-
services,”
for-lease-en.pdf, 2015.
“The spamhaus project,” https://www.spamhaus.org/.
[3]
[4] Alexa, “Alexa top global sites,” http://www.alexa.com/topsites, May
2015.
“The top 500 sites on the web,” http://www.alexa.com/topsites/category/
Computers/Internet/Web_Design_and_Development/Hosting.
“Bgp ranking.” http://bgpranking.circl.lu/.
[5]
[6]
[8]
resellers
program,”
[7] M. Konte, R. Perdisci, and N. Feamster, “Aswatch: An as reputation
system to expose bulletproof hosting ases,” in Proceedings of the 2015
ACM Conference on Special Interest Group on Data Communication,
ser. SIGCOMM ’15. New York, NY, USA: ACM, 2015, pp. 625–638.
[Online]. Available: http://doi.acm.org/10.1145/2785956.2787494
“Colocrossing
services/resellers.
“Reseller
programs/reseller.
“Become an ovh partner,” https://partners.ovh.com/become-a-partner.
“Voxility - iaas for service providers and large websites,” https://www.
voxility.com/info.
“Whmcs web hosting billing and automation platform,” https://www.
whmcs.com/.
https://www.leaseweb.com/partner-
https://www.colocrossing.com/
program,”
partner
[9]
[10]
[11]
[12]
[14]
[20]
[19]
[18]
[17]
[15]
[16]
https://www.ripe.net/analyse/archived-projects/ris-tools-
[13] B. Stone-Gross, C. Kruegel, K. Almeroth, A. Moser, and E. Kirda,
“Fire: Finding rogue networks,” in Computer Security Applications
Conference, 2009. ACSAC ’09. Annual, Dec 2009, pp. 231–240.
“The spamhaus don’t route or peer lists,” https://www.spamhaus.org/
drop/.
“Farsight security information exchange,” https://api.dnsdb.info/.
“Viruswatch – viruswatch watching adress changes of malware URL’s,”
http://lists.clean-mx.com/cgi-bin/mailman/listinfo/viruswatch/.
“Obtaining bulk whois data from arin,” https://www.arin.net/resources/
request/bulkwhois.html.
“Riswhois,”
web-interfaces/riswhois.
“Apnic bulk access to whois data,” https://www.apnic.net/manage-ip/
using-whois/bulk-access.
“Lacni request for bulk whois,” http://www.lacnic.net/en/web/lacnic/
manual-8.
“Afrinic bulk whois data,” https://www.afrinic.net/library/membership-
documents/207-bulk-whois-access-form-.
“Ripe database documentation,” https://www.ripe.net/manage-ips-and-
asns/db/support/documentation/ripe-database-documentation/.
“Registration data access protocol (rdap),” http://www.lacnic.net/en/
web/lacnic/registration-data-access-protocol.
“Registration data access protocol (rdap),” http://rdap.afrinic.net/rdap/.
I. SIE, “Security information exchange (sie) portal,” https://sie.isc.org/.
“The rokso list,” https://www.spamhaus.org/rokso/.
“The wayback machine,” https://archive.org/.
“Spamhaus isp area,” https://www.spamhaus.org/isp/.
“Icq with video calls, free messages and low-cost phone calls,” https:
//icq.com.
“Jabber. the original xmpp instant messaging service,” https://www.
jabber.org/.
[24]
[25]
[26]
[27]
[28]
[29]
[21]
[22]
[23]
[30]
[31] L. Bilge, S. Sen, D. Balzarotti, E. Kirda, and C. Kruegel, “Exposure:
A passive dns analysis service to detect and report malicious domains,”
ACM Trans. Inf. Syst. Secur., vol. 16, no. 4, pp. 14:1–14:28, Apr.
2014. [Online]. Available: http://doi.acm.org/10.1145/2584679
[32] C. Cortes and V. Vapnik, “Support-vector networks,” in Machine
Learning, 1995, pp. 273–297.
[33] L. Breiman, “Random forests,” Machine learning, vol. 45, no. 1, pp.
5–32, 2001.
[34] VirusTotal, “Virustotal - free online virus, malware and URL scanner,”
https://www.virustotal.com/, 2013.
[35] D. Mahjoub, “Marauder or Scanning Your DNSDB for Fun and
http://www.slideshare.net/OpenDNS/marauder-or-scanning-
Proﬁt,”
your-dnsdb-for-fun-and-proﬁt-source-boston, 2014.
“Internet assigned numbers authority,” www.iana.org.
“NetworkX,” https://networkx.github.io/.
[36]
[37]
[38] S. Hao, A. Kantchelian, B. Miller, V. Paxson, and N. Feamster,
“PREDATOR: proactive recognition and elimination of domain abuse
at time-of-registration,” in Proceedings of the 2016 ACM SIGSAC Con-
ference on Computer and Communications Security, Vienna, Austria,
October 24-28, 2016, 2016, pp. 1568–1579.
822
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply. 
True Positive Rate (Recall) =
False Negative Rate (FNR) =
True Negative Rate (TNR)=
False Positive Rate (FPR)=
False Discovery Rate (FDR)=
Accuracy=
TP/ (TP+FN)
FN / (TP + FN) =1 - TPR
TN/ (TN+FP)
FP / (FP + tn)= 1-TNR
FP/ (TP+FP)
(TP + TN) / (TP+FP+FN+TN)
TABLE XVIII: Description of the evaluation metrics used. Acronyms
TP, FP, TN, FN stand for, True Positives, False Positives, True
Negatives and False Negatives respectively.
(a) AltHost
[39] D. Hubbard and D. Mahjoub,
Provider Attacker Attribution
//www.rsaconference.com/writable/presentations/ﬁle_upload/air-r04-
using_large_scale_data_to_provide_attacker_attribution_for_unknown_iocs-
.pdf, 2016.
“Using Large Scale Data
for Unknown
IOC’s,”
to
https:
[40] Z. Chen, C. Ji, and P. Barford, “Spatial-temporal characteristics of
internet malicious sources,” in INFOCOM 2008. 27th IEEE Interna-
tional Conference on Computer Communications, Joint Conference of
the IEEE Computer and Communications Societies, 13-18 April 2008,
Phoenix, AZ, USA, 2008, pp. 2306–2314.
[41] Malicious Hubs: Detecting Abnormally Malicious Autonomous Systems,
vol. Mini-conference 14: Secu, 03/15-19/2010 2010.
[42] F. Roveta, G. Caviglia, L. Di Mario, S. Zanero, F. Maggi, and P. Ciuc-
carelli, “Burn: Baring unknown rogue networks,” in Proceedings of the
8th International Symposium on Visualization for Cyber Security, ser.
VizSec ’11, 2011, pp. 6:1–6:10.
[43] C. A. Shue, A. J. Kalafut, and M. Gupta, “Abnormally Malicious
Autonomous Systems and Their Internet Connectivity,” IEEE/ACM
Trans. Netw., vol. 20, no. 1, pp. 220–230, Feb. 2012.
[44] M. P. Collins, T. J. Shimeall, S. Faber, J. Janies, R. Weaver, M. De Shon,
and J. Kadane, “Using uncleanliness to predict future botnet addresses,”
in Proceedings of the 7th ACM SIGCOMM Conference on Internet
Measurement, ser. IMC ’07, 2007, pp. 93–104.
J. Zhang, Z. Durumeric, M. Bailey, M. Liu, and M. Karir, “On
the mismanagement and maliciousness of networks,” in 21st Annual
Network and Distributed System Security Symposium, NDSS 2014, San
Diego, California, USA, February 23-26, 2014, 2014.
[45]
[46] Z. Li, S. Alrwais, Y. Xie, F. Yu, and X. Wang, “Finding the
linchpins of the dark web: a study on topologically dedicated hosts
on malicious web infrastructures,” in Proceedings of the 2013 IEEE
Symposium on Security and Privacy, ser. SP ’13. Washington, DC,
USA: IEEE Computer Society, 2013, pp. 112–126. [Online]. Available:
http://dx.doi.org/10.1109/SP.2013.18
[47] X. Liao, S. Alrwais, and K. Y. et al., “Lurking malice in the cloud:
Understanding and detecting cloud repository as a malicious service,”
in Proceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security, Vienna, Austria, October 24-28, 2016, 2016.
I. Corona, R. Perdisci, and G. Giacinto, “Early detection of malicious
ﬂux networks via large-scale passive dns trafﬁc analysis,” IEEE Trans-
actions on Dependable and Secure Computing, vol. 9, no. undeﬁned,
pp. 714–726, 2012.
[48]
[49] Z. B. Celik and S. Oktug, “Detection of fast-ﬂux networks using
various DNS feature sets,” in 2013 IEEE Symposium on Computers and
Communications, ISCC 2013, Split, Croatia, 7-10 July, 2013, 2013, pp.
868–873.
[50] D.-T. Truong and G. Cheng, “Detecting domain-ﬂux botnet based on
dns trafﬁc features in managed network,” Security and Communication
Networks, vol. 9, no. 14, 2016.
IX. APPENDIX
(b) GlobalNetwork
Fig. 14: Forum posts of BPH advertisements (translated from Rus-
sian).
TLD+3
mail236.viralmoneyraising.net
mail228.viralmoneyraising.net
mail226.viralmoneyraising.net
mail232.viralmoneyraising.net
mail238.viralmoneyraising.net
mail230.viralmoneyraising.net
mail229.viralmoneyraising.net
mail235.viralmoneyraising.net
mail227.viralmoneyraising.net
mail231.viralmoneyraising.net
mail237.viralmoneyraising.net
click.viralmoneyraising.net
mail234.viralmoneyraising.net
hg1q2s.online
fbgjz778.com
slez778.com
hg888u.racing
lbl778.com
f76ub.racing
hgubt1.date
hg8ry3.host
g17tk.racing
ritarorasco.com
vizinurion.ru
metiztransport.ru
vvservop.at
jufugers.ru
lzhgt.xn3jl.xyz
axbbr.fgvcb.xyz
meqh.ergbd.xyz
4tw6.dfhr3.xyz
mz2c.rn1h7.xyz
598770.top
131622.xyz
578290.top
335235.xyz
282720.top
cobite.ddns.net
sawa5001.no-ip.org
justvirusahmed.zapto.org
fuukrie.ddns.net
xdayshk.ddns.net
6z4ziw.csgwth25.com
audel.dzqds3xt.com
cc7qf.asgdy3xt.com
rdkbtghbcgriztd.com
07tl9.gfghj3xt.com
Start-EndDate
(yyyyMMdd)
20150508-20150509
20150101-20160807
20150101-20160807
20150510-20150510
20150510-20150510
20150510-20150510
20150509-20150520
20150509-20150509
20150101-20160807
20150509-20160611
20150510-20150510
20150101-20160807
20150509-20150509
20160707-20160820
20150101-20150128
20150101-20150216
20160723-20160820
20150101-20150109
20160804-20160813
20160808-20160820
20160808-20160820
20160810-20160820
20160213-20160307
20160214-20150607
20151125-20151215
20160528-20160820
20150112-20150114
20151210-20151210
20160116-20160116
20160116-20160116
20160111-20160111
20151204-20151204
20160814-20160820
20160713-20160820
20160814-20160820
20160619-20160820
20160814-20160820
20160407-20160414
20150616-20150618
20160406-20160411
20160625-20160625
20160408-20160410
20160702-20160702
20160710-20160710
20160608-20160710
20150910-20150910
20160629-20160629
Note
All 13 TLD+3 and 1 FQDN
found on the detected
network block owned by
Irv Freiberg
(216.246.108.224/28).
6 short lived TLD+3
(out 397) hosted on
(107.149.32.128/26)
through VPS Quan.
Sample of TLD+3
in group 1
Sample of TLD+3
in group 2
Sample of TLD+3
in group 3
Sample of TLD+3
in group 4
Sample of TLD+3
in group 5
TABLE XIX: TLD+3 hosted on various detected sub-allocations.
823
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:21:58 UTC from IEEE Xplore.  Restrictions apply.