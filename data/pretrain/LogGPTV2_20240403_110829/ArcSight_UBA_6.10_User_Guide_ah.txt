Poweredby Securonix 	Confidential
Access Reviews Dashboard
Click More Details to view Peer Name for the account. Click Users with Access value to view Out-lier Details. Click Less Details to collapse details.You can take the following actions for each account: 
Click arrow beside account to take the following actions on the account: 
OR
ArcSight User Behavior Analytics 6.10User Guide 	Page 156 of318 Poweredby Securonix 	Confidential
Access Reviews Dashboard
Use dropdown to take the following actions on the account:
Certify: Certifies access for selected account.
Revoke: Revokes access for selected account.Date Extension: Extends the date access should be granted for selected account. Enter exception time frame to confirm the action.
The Access Review Dashboard will reflect the actions taken and display the status of individual reviews.
Past Due Access Reviews
When an Access Review is past due, the status shows Expired and you will be unable to take any actions on the review. You must rerun or create a new Access Review Job from Menu > Analytics > Access Reviews.ArcSight User Behavior Analytics 6.10User Guide 	Page 157 of318 Poweredby Securonix 	Confidential
Investigation Workbench
Investigation Workbench
The Investigation Workbench enables security analysts to investigate and manage high-risk entities in different dimensions. It provides visualization of connections between users, IP addresses, sys-tems, activities and other relevant data involved in an incident.Workbench Overview
The Investigation Workbench provides a quick visualization of multiple data sources and reports. You have the ability to drill down into each and every incident performed by a user.Use the Investigation Workbench to perform root-cause analysis of a particular violation or breach, providing analysts the ability to view anomalous activities in a chronological order. In the Invest-igation Workbench, analysts can pivot around any entity. To pivot across various objects, for example, IP address, systems or peer groups, click an entity within the dashboard and from the list of options, select the activity or information you wish to view. You can save and share the invest-igation results with other analysts.Launching the Investigation Workbench
To navigate to the Investigation Workbench, click Menu > Security Center > Investigation Work-bench. The following screen appears.
The top navigation bar in Investigation Workbench provides filtering options as listed in the table:
ArcSight User Behavior Analytics 6.10User Guide 	Page 158 of318
Poweredby Securonix 	Confidential
Investigation WorkbenchInvestigation Workbench
Tool bar option 	Function
| Analyze Violation Data | NO:By default,the application analyzes alleventdata. YES:The application limits its analysis to violation dataonly. | NO:By default,the application analyzes alleventdata. YES:The application limits its analysis to violation dataonly. |
|---|---|---|
| Analyze Violation Data |Click the |dropdown to access this option. Clicking this icon |clears all current information from the Investigation Workbench screen and begins a new investigation.
Click the icon 	dropdown to access this option. Click this icon to reset the screen to its default position if you have used the 
Pan/Zoom feature.
Click the icon 	dropdown to access this option. Click this icon to lock the screen so that you can use your mouse to pan the screen (left-click and drag), and scroll in or out using the mouse scroll wheel.Search 
Date Filter Use the dropdown to search for an entity.
Use the date filter to choose an hourly range or specify a custom date range.
Simple Search
To do a quick investigation for events in the past hour or for a range, follow these steps:
ArcSight User Behavior Analytics 6.10User Guide 	Page 159 of318
Poweredby Securonix 	Confidential
Investigation WorkbenchInvestigation Workbench
1. Select the date. By default, the Investigation Workbench displays the current date. To select a
different date range, click the date range dropdown menu in the top right area of the screen.
Select from the default date ranges, or click Custom Range to enter a custom date range.
2. Use the Search dropdown to perform a simple search using a single attribute:ArcSight User Behavior Analytics 6.10User Guide 	Page 160 of318
Poweredby Securonix 	Confidential
Investigation Workbench
l Select an entity from the Select Entity dropdown, for example, User.
l Select an attribute from the Select Attribute dropdown, for example, employeeid. The attrib-	utes shown are based on the entity you selected.l Enter the specific search criteria. For example, 1002. The search string allows you to confine 	your search to employee id = 1002.
l Click Search.
The search results appear as shown in the Investigation Workbench. The search results show all the users in ArcSight UBA when Analyze Violation Data is disabled.
Enable Analyze Violation Data to view only those users who have a violation. For example a policy violation.Click on the collapsed menu icon for any user, and select View Policies Violated. All the policies that the user violated show up in the Investigation Workbench that you can investigate further.
The following screen shows an example of the policy that was violated being investigated.
ArcSight User Behavior Analytics 6.10User Guide 	Page 161 of318
Poweredby Securonix 	Confidential
Investigation WorkbenchInvestigation Workbench
Advanced Search 
To perform an advanced search, click Search. From the dropdown, click Go to Advanced Search. This option enables you to search using filtering conditions. To add additional filters, click +. In the fig-ure shown, the search has to filter all users whose employeeid contains the value 10.
The following figure shows an example of the search results.ArcSight User Behavior Analytics 6.10User Guide 	Page 162 of318 Poweredby Securonix 	Confidential
Investigation Workbench
Launching the Investigation Workbench from Other Screens
The Investigation Workbench icon  may appear on other screens. Click the icon to launch invest-
igation into the respective entity. Some screens from where you can launch the Investigation Work-bench include:l The Security Command Center. This is the default overview dashboard that displays the top 	attackers, threats and violation summary.
l Views for users, peer groups, and resources.
Starting Investigation for Multiple Entities Using Workspaces
a. Search for an entity using the Search dropdown.b. Left-click the three-dotted icon to view the associated objects, and pivot on any of them for fur-ther investigation. For example, if you selected a user entity, you can view objects associated with it including View Network Address Used.
c. Click the Network Address Used object. The results appear in a new workspace of the Invest-	igation Workbench as shown.d. Right-click an IP address to start a new investigation. A new investigation is launched in a second workspace. This feature allows you to investigate multiple entities within the same Invest-igation Workbench window in their unique workspaces. Scroll to the right as you add more work-spaces.
ArcSight User Behavior Analytics 6.10User Guide 	Page 163 of318
Poweredby Securonix 	ConfidentialPoweredby Securonix 	Confidential
Investigation Workbench
Pivoting Across Objects
Viewing Objects in Detail
This is another example of how you can view objects associated with an entity. In this example, the entity searched on is the Network Address. When you click a Network address, a summary of the associated objects appears to the right.a. From the Search dropdown, search for Network Address entity. The search results appear with 	all the network addresses used.
b. Right-click an IP address. This launches an Associated Objects menu to the right of the screen. You can expand on a menu item to view additional details. Use this menu for a summarization of the associated objects related to the IP address.
Viewing Objects SummaryViewing Objects Summary
This is another example of how you can view objects associated with an entity. In this example, the entity searched on is the Network Address. When you click a Network address, a summary of the associated objects appears to the right.
ArcSight User Behavior Analytics 6.10User Guide 	Page 164 of318
Poweredby Securonix 	Confidential
Investigation WorkbenchInvestigation Workbench
a. From the Search dropdown, search for Network Address entity. The search results appear with 	all the network addresses used.
b. Right-click an IP address. This launches an Associated Objects menu to the right of the screen. You can expand on a menu item to view additional details. Use this menu for a summarization of the associated objects related to the IP address.ArcSight User Behavior Analytics 6.10User Guide 	Page 165 of318 Poweredby Securonix 	Confidential
Spotter
Spotter
Spotter is a lightning fast, natural language search engine that uses normalized search syntax and visualization techniques to provide threat hunters the tools they need to investigate current threats and trends, and track advanced persistent threats over long periods of time. Spotter is built on Apache Luceneâ„¢, a java-based, high-performance text search engine that provides powerful, effi-cient, and accurate search capabilities.Using Spotter
From the Spotter start screen, you can search for and view threats using various search filters. You can specify the report format to display information in tables, as bar charts, bubble charts, and time charts, or view a geographical map.
	Note: Click F2 to redirect to the Spotter start screen from any section of the ArcSight UBA UI.
Getting Started
1. Log in to ArcSight UBA.1. Log in to ArcSight UBA.
2. Navigate to Menu > Security Center> Spotter.
Spotter Search Summary View
The Spotter Summary displays the Available Violations and the Available Datasources for a spe-cified time frame. From here you can provide a search query, or enter text to filter the available viol-ations and datasources and sort them by name or total events count.ArcSight User Behavior Analytics 6.10User Guide 	Page 166 of318
Poweredby Securonix 	Confidential
Spotter
Use the menu on the right side of the search bar to specify a time range.
Click on the screen navigation bar to access the following screens at any time:
l Summary: Displays a summary of the available violations and datasources l Search Results: Displays the results of search queriesl Cached Queries: Displays recent queries stored in the cache 
l Saved Queries: Displays specific queries saved for future use 
l Console: Displays Spotter activity logs 
l View Jobs: Displays a list of jobs.
ArcSight User Behavior Analytics 6.10User Guide 	Page 167 of318
Poweredby Securonix 	Confidential
Spotter
	Note: The green bar indicates which screen you are currently viewing.Filter Available Violations and Datasources
From the Summary screen, you can click on any available violation or datasource to filter the results.
The view will switch to the Search Results screen.
Spotter Search Results View
Click the collapsed icon to isolate a single event in the results.
Search Filters
Within the event results, you can click on any field to filter the results. You may select any number offilters to narrow your results.
ArcSight User Behavior Analytics 6.10User Guide 	Page 168 of318
Poweredby Securonix 	Confidential
Spotter
l Click Add to search to apply the filter.
l Click Exclude from search to remove the filter.
l Click Start new search to clear all results and start a new search.
The field will be added to the search bar with the AND operator, and the field will be highlighted in the events results.Search Fields
When you import your user, activity, access, watchlist, lookup, and entity metadata, your attributes are mapped to a corresponding attribute within the ArcSight UBA application. These mapped attrib-utes are used as search fields in Spotter.When you enter a query for a particular data source, the fields that are available and mapped are lis-ted by type in the Selected Fields and Other Fields panels on the left side of the Search Results screen beside the events. You can select from these fields to add to the search query and filter your results.
In ArcSight UBA 6.10, you can switch your view between the following options:ArcSight User Behavior Analytics 6.10User Guide 	Page 169 of318
Poweredby Securonix 	Confidential
Spotter
l Securonix Attribute Names: View the attributes in the ArcSight UBA schema to which you 	have mapped the device or datasource attributes:
l User Defined Attribute Names: View the user-defined names of the attributes mapped during data import. If you have not specified a custom name for an attribute, view the device or data-source attribute name:To switch between Securonix Attribute and User Defined Attribute names, click the gear icon and select from dropdown. Click any attribute to filter results. You can also select Hide Fields to max-imize the event results by hiding the Fields panel.
ArcSight User Behavior Analytics 6.10User Guide 	Page 170 of318
Poweredby Securonix 	Confidential
SpotterSpotter
The number beside the field name represents the number of unique attributes for that particular field. Click on the field to drill down into each attribute to see the number of events associated with it.
Click on the attribute to see the events associated with it. The selected attribute will appear high-lighted in the search results.
Search Results ReportsSearch Results Reports
Spotter displays event information in visual reports. By default, the results are displayed as a linear chart representing the number of events on the y-axis and the date on the x-axis.
Select a point on the chart to view the events for that time.
ArcSight User Behavior Analytics 6.10User Guide 	Page 171 of318
Poweredby Securonix 	Confidential
Spotter
Report CommandsSpotter
Report Commands 
Use report commands in the search query to change the format of the reports to any of the following types of reports:
Table 
Use the following syntax: resourcegroupname = "" |TABLE ,  
Example: resourcegroupname = "Digital Guardian Send Mail" |TABLE ipaddress, accountname
Bar chart 
Use the following syntax: resourcegroupname = "" | BARCHART ArcSight User Behavior Analytics 6.10User Guide 	Page 172 of318 Poweredby Securonix 	Confidential
Spotter
Example: resourcegroupname = "Digital Guardian Send Mail" | BARCHART accountname
Bubble chart 
Use the following syntax: resourcegroupname = "" | BUBBLECHART    
Example: resourcegroupname = "Bluecoat Proxy" | BUBBLECHART userid ipaddress source-address
Time chartTime chart 
Use the following syntax: TIMECHART      ...  
Example: resourcegroupname = "Bluecoat Proxy" | TIMECHART hourly ipaddress
Geomap 
Use the following syntax: index= | GEOMAP   Example: index=tpi | GEOMAP latitude longitude
ArcSight User Behavior Analytics 6.10User Guide 	Page 173 of318 Poweredby Securonix 	ConfidentialSpotter
Searching Spotter
Indexes 
Spotter uses natural language to search within the data indexed in the ArcSight UBA application. You can search within any index into which you have imported data. ArcSight UBA uses the fol-lowing indexes to store data:
l Activity 
l Archive 
l Users 
l Violation 
l TPI 
l Watchlist 
l Whitelist 
l Lookup 
l Asset 
l Geolocation 
l Risk Score
l Risk Score Historyl Risk Score
l Risk Score History
By default, Spotter searches the Activity index. You may specify the index you would like to search using the following syntax: 
index =    =  
For example: index=users
ArcSight User Behavior Analytics 6.10User Guide 	Page 174 of318
Poweredby Securonix 	Confidential
Spotter
Use the fields associated with the indexes to filter results.Using Search Queries
Threat hunters can use simple language to find specific events or information associated with entit-
ies, resources, and threats.
To search Spotter, enter the query and hit Enter or the use the magnifying glass icon on the right side
of the search bar.
ArcSight User Behavior Analytics 6.10User Guide 	Page 175 of318
Poweredby Securonix 	Confidential
Spotter
Search ControlsSpotter
Search Controls
The search controls below the search bar show the progress of your search and identifies any errors with search syntax or invalid parameters.
You can also start, stop, or pause queries.
Spotter Search Help
From the other options section on the right side of the search bar, you can access Spotter Search Help to view the syntax and examples of the available commands, operators, and fields Spotter uses to perform functions such as search within indexes, change the report format, and analyze data.ArcSight User Behavior Analytics 6.10User Guide 	Page 176 of318
Poweredby Securonix 	Confidential
Spotter
You can also view this complete information in the Spotter Search Help.
Other Search Options 
On the search bar, you can access other search options, including: Clear search query
Use this option to clear the search bar and results to begin a new search query. Save search resultsUse this option to save the current search on the Saved Queries screen.
ArcSight User Behavior Analytics 6.10User Guide 	Page 177 of318 Poweredby Securonix 	Confidential
Spotter
See more options
Use this option to access more options for searching including the following:
l View Cached queries 
l View Saved queries 
l Update Cache 
l Click Close to close the window and return to the current screen viewSample Spotter Search Queries
Example 1: Find Policy Violations
To view all the violations of a particular policy, use the syntax as in the following example: policyname = "Spike in Number of Records accessed by an Employee"
ArcSight User Behavior Analytics 6.10User Guide 	Page 178 of318
Poweredby Securonix 	Confidential
Spotter
Example 2: Check if user has sent email to personal email addressTo view check if a user has sent email to a personal email address, the following query uses the CondensedStringMatcher: 
resourcegroupname = "Digital Guardian Send Mail" | EVAL matchPerc = emailtoself(first-name,workemail,0.4)
Example 3: Find Asset Data 
To view all the devices in the asset index, use the following query: index = asset
ArcSight User Behavior Analytics 6.10User Guide 	Page 179 of318 Poweredby Securonix 	ConfidentialSpotter
Example 4: View Top IP Address by Account Name 
To view a table with the top IP addresses by account name for a data source, use the following query: 
resourcegroupname = "Bluecoat Proxy" | TOP ipaddress by accountname
Example 5: Search threat intelligence for top countries of origin 
To find the top TPI domains from which threats originate in the Third Party Intelligence index, use the following query:index = tpi | TOP tpi_domain
ArcSight User Behavior Analytics 6.10User Guide 	Page 180 of318
Poweredby Securonix 	Confidential
Spotter
Exporting Search Results as Reports
You can export search results in several file formats. To export Spotter search results, click Reports from the Search Results screen above the Selected Fields.The option to Export Spotter Results appears in the dropdown along with any Spotter reports con-figured under Menu > Reports > Categorized Reports. For information about configuring Spotter Reports, see Reports.
Click Export Search Results or a Spotter Report. The Run Spotter Report window appears.
ArcSight User Behavior Analytics 6.10User Guide 	Page 181 of318
Poweredby Securonix 	ConfidentialPoweredby Securonix 	Confidential
Spotter
Click the attributes to include in the report. Attributes that appear in blue will be included in the report. Attributes that appear in gray are excluded from the report. You can edit the attribute label under which the mapped attribute will appear in the report column.
Click Save to save the label and include the attribute in the report.Click Remove Mapping to remove the attribute from the report.
Select from the dropdown to run report in one of the following formats: l PDF 
l XML
ArcSight User Behavior Analytics 6.10User Guide 	Page 182 of318 Poweredby Securonix 	Confidential
Spotter
l CSV 
l XLS 
l RTF 
l TEXT 
l DOCX 
l XLSX
Click Run to run the report and download the report from the Notifications menu when status is com-plete:ArcSight User Behavior Analytics 6.10User Guide 	Page 183 of318
Poweredby Securonix 	Confidential
Spotter
Viewing Jobs
You may view the jobs in Spotter, including recent search queries and file exports by clicking the View Jobs tab. This will display the recent Jobs.
Click the Console tab to view the Spotter activity log.
ArcSight User Behavior Analytics 6.10User Guide 	Page 184 of318 Poweredby Securonix 	ConfidentialSpotter Search Help
Spotter Search Help 
This section includes the common natural language search commands for ArcSight UBA 6.10, including search, reporting, and analytical operators.
Search Operators
Basic Commands
| Command | Description | Syntax |
|---|---|---|