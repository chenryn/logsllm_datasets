– 如果配置正确，则请执行步骤3。
– 如果配置不正确，则修改配置。
3. 使用display ospf peer命令检查邻居关系是否为Up。
– 如果邻居关系为Up，则请执行步骤4。
– 如果邻居关系为Down，则请执行步骤4。
4. 请收集日志文件，并联系技术支持人员。
步骤5 原因5：Configuration change.
1. 在OSPF进程视图下使用display this命令，检查邻居两端的区域配置是否一致。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤2。
2. 在OSPF进程视图下使用display this命令，检查两端OSPF进程中是否都使能
opaque-capability。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤3。
3. 使用display ospf interface命令，检查链路两端接口的“ospf network-type”是否一
致。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤4。
4. 请收集日志文件，并联系技术支持人员。
步骤6 原因6：Peer router reason.
1. 对端设备是否属于其他厂商。
– 如果属于其他厂商，则请执行步骤2。
– 如果不属于其他厂商，则请执行步骤3。
2. 请联系其他厂商对对端设备运行状况进行排查。
3. 检查对端设备或者OSPF进程是否重启。
– 如果对端设备或者OSPF进程已重启，请结合对端设备的告警、日志信息进行
原因确认。
– 如果对端设备或者OSPF进程没有重启，则请执行步骤4。
4. 请收集日志文件，并联系技术支持人员。
----结束
61.54 OSPF/2/ospfNbrStateChange_clear
日志信息
OSPF/2/ospfNbrStateChange_clear: The status of the non-virtual neighbor has changed.
(RouterId=[RouterId], NbrIpAddress=[NbrIpAddress],
NbrAddressLessIndex=[NbrAddressLessIndex], NbrRtrId=[NbrRtrId], NbrState=[NbrState],
文档版本 06 (2017-09-12) 华为专有和保密信息 638
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
ProcessId=[ProcessId], AreaId=[AreaId], IfnetIndex=[IfnetIndex],
LocalIfIpAddress=[LocalIfIpAddress], IfName=[IfName], VpnName=[VpnName],
SubReason=[SubReason], Reason=[NbrStateChangeReason])
日志含义
OSPF邻居状态发生变化，可能是由于该邻居所在的接口状态发生变化，或者收到的
Hello报文中内容发生改变。
日志参数
参数名称 参数含义
RouterId Router ID。
NbrIpAddress 邻居IP地址。
NbrAddressLessIndex 邻居的Unnumber接口索引号。
NbrRtrId 邻居的Router ID。
NbrState 邻居的状态。
ProcessId 进程号。
AreaId 区域ID。
IfnetIndex 本设备接口索引号。
LocalIfIpAddress 本设备接口的IP地址。
IfName 本设备的接口名称。
VpnName VPN实例名。
SubReason 邻居不可用的详细原因。
Reason 告警产生的原因。
可能原因
原因100：Alarm clear.（告警被清除。）
处理步骤
l 原因100：Alarm clear.
文档版本 06 (2017-09-12) 华为专有和保密信息 639
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
正常运行信息，无需处理。
----结束
61.55 OSPF/3/ospfVirtNbrStateChange_active
日志信息
OSPF/3/ospfVirtNbrStateChange_active: The status of the virtual neighbor changes.
(VirtNbrArea=[VirtNbrArea], VirtNbrRtrId=[VirtNbrRtrId], ProcessId=[ProcessId],
RouterId=[RouterId], VirtNbrState=[VirtNbrState], InstanceName=[InstanceName])
日志含义
OSPF邻居状态发生变化，可能是由于该邻居所在的接口状态发生变化，或者收到的
Hello报文中内容发生改变。
日志参数
参数名称 参数含义
VirtNbrArea Transit区域ID。
VirtNbrRtrId 虚连接邻居的Router ID。
ProcessId OSPF进程号。
RouterId 本设备的Router ID。
VirtNbrState 虚连接邻居状态。
l 1: Down
l 2: Attempt
l 3: Init
l 4: 2-Way
l 5: ExStart
l 6: Exchange
l 7: Loading
l 8: Full
InstanceName VPN实例名称。
可能原因
原因1：The adjacency HoldTimer expired.（邻居定时器超时。）
原因2：The physical interface changed.（物理接口变化。）
文档版本 06 (2017-09-12) 华为专有和保密信息 640
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
原因3：The protocol did not work correctly.（协议原因。）
原因4：The BFD session was interrupted.（BFD会话断开。）
原因5：OSPF configurations changed.（OSPF配置变化。）
原因6：The peer router did not work properly.（邻居路由器原因。）
处理步骤
步骤1 原因1：The adjacency HoldTimer expired.
1. 执行ping命令查看到对端设备的链路状态是否良好。
– 如果不能ping通，请检查传输设备、链路情况、接口情况，通过调整硬件设
备恢复业务。
– 如果能够ping通，则请执行步骤1.2。
2. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
步骤2 原因2：The physical interface changed.
1. 执行display ip interface命令查看建立OSPF邻居的接口物理状态是否良好。
– 如果接口的物理状态为down，请检查接口的光功率、传输设备是否正常，通
过恢复物理接口状态来消除告警。
– 如果接口的物理状态为*down，则该接口被人为执行shutdown操作了，请在
接口下执行undo shutdown命令来消除告警。
– 如果接口的物理状态为Up，则请执行步骤2.2。
2. 执行display ospf interface命令查看建立OSPF邻居的接口协议状态。
– 如果当前协议状态为Down，请检查是否配置了IP地址、IP地址配置得是否正
确，通过对IP地址的检查来消除告警。
– 如果当前协议状态为Up，则请执行步骤2.3。
3. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
步骤3 原因3：The protocol did not work correctly.
1. 分别在本地设备和对端设备的接口视图和OSPF视图下，执行display this命令检查
链路两端的设备是否使能了相同的协议。
– 如果相同，则请执行步骤3.2。
– 如果不同，请在需要建立邻居的链路两端接口上配置相同的协议。
2. 执行display ospf peer命令查看OSPF邻居信息。
– 如果没有任何邻居信息，表示本设备无法接收到对端的Hello报文，或者接收
到的Hello报文被丢弃，则请执行步骤3.3。
– 如果显示的邻居信息为Init，表示本设备可以收到对端的Hello报文，而对端却
无法收到本设备的Hello报文。执行ping命令查看到对端设备的链路状态是否
良好。出现该问题一般是由于转发层面出了问题，导致报文被丢弃。如果不
能通过解决转发故障来消除告警，则请执行步骤3.4。
– 如果显示的邻居信息为2-way，表示设备运行OSPF接口上配置ospf dr-priority
0，请执行ospf dr-priority命令，调整接口的DR优先级大于0来消除告警。
– 如果显示的邻居信息为Exstart，表示告警设备由于一直在进行DD协商，而无
法完成DD同步，则请执行步骤3.3。
– 如果显示的邻居信息为Loading，表示本设备认为收到的LSA为非法LSA，将
其丢弃后不断的请求LSA。可以通过在需要建立OSPF邻居的链路两端执行
reset ospf process命令来恢复告警。
文档版本 06 (2017-09-12) 华为专有和保密信息 641
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
说明
复位OSPF连接（执行reset ospf process命令）会导致设备之间的OSPF邻接关系中断。
务必仔细确认是否必须执行复位OSPF连接的操作。
3. 在接口视图和OSPF进程下分别执行display this命令，检查链路两端配置的认证是
否相同。
– 如果相同，则请执行步骤3.4。
– 如果不同，请将链路两端配置的认证方式改为一致。
4. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
步骤4 原因4：The BFD session was interrupted.
1. 执行ping命令查看到对端设备的链路状态是否良好。
– 如果不能ping通对端设备，请检查传输设备、链路情况、接口情况，通过调
整硬件设备恢复业务。
– 如果能ping通对端设备，则请执行步骤4.3。
2. 执行display ospf peer命令检查邻居关系是否为Up。
– 如果邻居关系为Down，则请执行步骤1。
– 如果邻居关系为up，则请执行步骤4.3。
3. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
步骤5 原因5：OSPF configurations changed.
1. 在OSPF进程视图下执行display this命令，检查邻居两端的区域配置是否一致。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤5.2。
2. 在OSPF进程视图下执行display this命令，检查两端OSPF进程中是否都使能
opaque-capability。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤5.3。
3. 执行display ospf interface命令，检查链路两端接口的“Type”是否一致。
– 如果不一致，将其修改一致。
– 如果一致，则请执行步骤5.4。
4. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
步骤6 原因6：The peer router did not work properly.
1. 对端设备是否属于其他厂商。
– 如果属于其他厂商，则请执行步骤6.2。
– 如果不属于其他厂商，则请执行步骤6.3。
2. 请联系其他厂商对对端设备运行状况进行排查。
3. 检查对端设备或者OSPF进程是否重启。
– 如果对端设备或者OSPF进程已重启，请结合对端设备的告警、日志信息进行
原因确认。
– 如果对端设备或者OSPF进程没有重启，则请执行步骤6.4。
4. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 642
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
61.56 OSPF/3/ospfVirtNbrStateChange_clear
日志信息
OSPF/3/ospfVirtNbrStateChange_clear: The status of the virtual neighbor changes.
(VirtNbrArea=[VirtNbrArea], VirtNbrRtrId=[VirtNbrRtrId], ProcessId=[ProcessId],
RouterId=[RouterId], VirtNbrState=[VirtNbrState], InstanceName=[InstanceName])
日志含义
OSPF邻居状态发生变化，可能是由于该邻居所在的接口状态发生变化，或者收到的
Hello报文中内容发生改变。
日志参数
参数名称 参数含义
VirtNbrArea Transit区域ID。
VirtNbrRtrId 虚连接邻居的Router ID。
ProcessId OSPF进程号。
RouterId 本设备的Router ID。
VirtNbrState 虚连接邻居状态。
l 1: Down
l 2: Attempt
l 3: Init
l 4: 2-Way
l 5: ExStart
l 6: Exchange
l 7: Loading
l 8: Full
InstanceName VPN实例名称。
可能原因
原因100：The alarm was cleared.（告警被清除。）
处理步骤
步骤1 原因100：The alarm was cleared.
文档版本 06 (2017-09-12) 华为专有和保密信息 643
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 61 OSPF
正常运行信息，无需处理。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 644
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 62 OSPFv3
62
OSPFv3
关于本章
62.1 OSPFV3/5/OSPFV3_ABNORMAL_LSA_UPDATE
62.2 OSPFV3/4/OSPFV3_AUTO_CHG_RTRID
62.3 OSPFV3/6/OSPFV3_CONFLICT_ROUTERID_INTER
62.4 OSPFV3/4/OSPFV3_CONFLICT_ROUTERID_INTF
62.5 OSPFV3/4/OSPFV3_CONFLICT_ROUTERID_INTRA
62.6 OSPFV3/6/OSPFV3_CONFLICT_ROUTERID_RECOVER
62.7 OSPFV3/6/OSPFV3_LAST_HELLO_RECV_SEND_TIME
62.8 OSPFV3/6/OSPFV3_NBR_CHANGE
62.9 OSPFV3/3/OSPFV3_NBR_DOWN_REASON
62.10 OSPFV3/6/OSPFV3_INTF_STATE_CHANGE
62.11 OSPFV3/3/OSPFV3_TRAP_IF_CONFIG_ERR
62.12 OSPFV3/3/OSPFV3_TRAP_IF_RX_BAD_PKT
62.13 OSPFV3/4/OSPFV3_TRAP_IF_STATE_CHNG
62.14 OSPFV3/4/OSPFV3_TRAP_RESET_HELP_STAT_CHNG
62.15 OSPFV3/2/ospfv3NbrStateChange_active
62.16 OSPFV3/2/ospfv3NbrStateChange_clear
62.17 OSPFV3/6/OSPFV3_REMOTE_ROUTER_ID_CONFLICT
62.18 OSPFV3/6/OSPFV3_INTF_FALPPING_SUPPRESS_STATUS
文档版本 06 (2017-09-12) 华为专有和保密信息 645
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 62 OSPFv3
62.1 OSPFV3/5/OSPFV3_ABNORMAL_LSA_UPDATE
日志信息
OSPFV3/5/OSPFV3_ABNORMAL_LSA_UPDATE: LSAs change frequently now.
(ProcessId=[ProcessId], AdvertiseRouterId=[AdvertiseRouterId], TotalCount=[TotalCount],
BeginTime=[BeginTime], EndTime=[EndTime], LinkLsaCount=[LinkLsaCount],
RouterLsaCount=[RouterLsaCount], NetworkLsaCount=[NetworkLsaCount], Intra-Area-
PrefixLsaCount=[Intra-Area-PrefixLsaCount], Inter-Area-PrefixLsaCount=[Inter-Area-
PrefixLsaCount], Inter-Area-RouterLsaCount=[Inter-Area-RouterLsaCount], AS-
externalLsaCount=[AS-externalLsaCount], NSSA-externalLsaCount=[NSSA-
externalLsaCount], GraceLSACount=[GraceLSACount],
UnknownLsaCount=[UnknownLsaCount])
日志含义
LSA频繁更新。
日志参数
参数名称 参数含义
ProcessId 进程号。
AdvertiseRouterId 宣告路由器。
TotalCount 总计数。
BeginTime 开始时间。
EndTime 结束时间。
LinkLsaCount Link LSA计数。
RouterLsaCount Router LSA计数。
NetworkLsaCount Network LSA计数。
Intra-Area-PrefixLsaCount Intra-Area-Prefix LSA计数。
Inter-Area-PrefixLsaCount Inter-Area-Prefix LSA计数。
Inter-Area-RouterLsaCount Inter-Area-Router LSA计数。
AS-externalLsaCount AS-external LSA计数。
文档版本 06 (2017-09-12) 华为专有和保密信息 646
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 62 OSPFv3
参数名称 参数含义
NSSA-externalLsaCount NSSA-external LSA计数。
GraceLSACount Grace LSA计数。
UnknownLsaCount Unknown LSA计数。
可能原因
按LSA宣告路由器进行LSA更新计数，每小时输出一次历史记录，从中选出更新次数最
多的10条LSA宣告路由器记录，如其中有总次数超过100的，打印此日志。
处理步骤
l 正常运行信息，无需处理。
----结束
62.2 OSPFV3/4/OSPFV3_AUTO_CHG_RTRID
日志信息
OSPFV3/4/OSPFV3_AUTO_CHG_RTRID: OSPFV3 automatically changes the router ID
when detecting router ID conflict in the area. (ProcessId=[ProcessId],
NewRouterId=[ConflictRtId], OldRouterId=[RouterId], ConflictRtrIdNum=[ConflictCount])
日志含义