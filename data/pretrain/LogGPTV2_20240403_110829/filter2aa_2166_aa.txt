APT与新威胁论坛
2
网络安全威胁中的商业军火
3
从HackingTeam说起
商业化间谍软件现状
商业军火带来的问题
可以采取的应对策略
4
 从                    说起
成立时间
2003年
创始人
David Vincenzetti(CEO)
Valeriano Bedeschi(CIO)
核心人物
Alberto Ornaghi(软件架构师)
Marco Valleri(进攻安全管理)
总部
米兰，意大利
免费开源
内网安全审计工具
基于MITM实现
“第一个面向警方
的商用黑客软件 ”
头像取自领英（ Linkedin）
5
 从                    说起
部门
人数
管理
7
行政
9
销售
8
安全
9
运营
15
研发
17
合计
65
6
 从                    说起
组织名称
国家
区域
最早订单
年费
总收入
智利
拉美
2014
2,289,155
ISO
乌干达
非洲
2015
831,000
2,197,100
CSDN
摩洛哥
非洲
2009
140,000
1,936,050
墨西哥
拉美
2010
130,000
1,390,000
DGST
摩洛哥
非洲
2012
160,000
1,237,500
新加坡
亚洲
2008
89,000
1,209,967
GID Saudi
沙特阿拉伯
非洲
2012
114,000
1,201,000
UAEIntelligence
阿联酋
非洲
2012
150,000
1,200,000
MOD Saudi
沙特阿拉伯
非洲
2013
220,000
1,108,687
SIS
哈萨克斯坦
欧洲
2012
140,000
1,012,500
合同额TOP 10 客户
金额单位：EUR
7
 从                    说起
主要客户分布
8
 从                    说起
RCS 能力
Windows
OSX
BlackBerry
Windows 
Mobile
Android
iOS
9
商业化间谍软件现状
短信息监控
Facebook监控
WhatsApp监控
LINE监控
联系人黑白名单
应用程序监控
应用黑白名单
应用风险状态
通话监控
位置监控
媒体文件监控
Web访问监控
手机开关机记录
10
商业化间谍软件现状
11
商业化间谍软件现状
12
商业化间谍软件现状
多语言界面
有/无图标版本（图标可隐藏）
安装后在Services中可见
中文界面
安装后无图标
安装后在Services不可见
需要手动激活
13
商业化攻击平台
Cobalt Strike
14
商业化攻击平台
Cobalt Strike
公司/项目/机构
职位
时间
Strategic cyber LLC
创始者和负责人
2012.1-至今
特拉华州空军国民警卫队
领导，传统预备役
2009-至今
Cobalt strike
项目负责人
2011.11-2012.5
TDI
高级安全工程师
2010.8-2011.6
Automattic
代码Wrangler
2009.7-2010.8
Feedback Army, After the Deadline
创始人
2008.7-2009.11
美国空军研究实验室
系统工程师
2006.4-2008.3
美国空军
通信与信息 军官
2004.3-2008-3
姓       名：Raphael Mudge
教育背景：Syracuse University 美国雪城大学；密歇根科技大学
目前就职：Strategic Cyber LLC（战略网络有限责任公司）；特拉华州空军国民
警卫队
15
商业化攻击平台
Cobalt Strike
Packages
•
HTML Application
•
Java Application
•
MS Office Macro
•
Payload Generator
•
USB/CD AutoPlay
•
Windows Dropper
•
Windows Executable
•
Windows Executable(S)
Web Drive-by
•
Manage
•
Auto-Exploit Server
•
Client-side-Attacks
•
Clone Site
•
Firefox Add-on Attack
•
……
16
真实案例
APT TOCS
17
真实案例
APT TOCS
18
真实案例
APT TOCS
19
商业军火带来的问题
我们面对怎样的对手
“超级病毒”、“超级工厂病毒”、“超级武器”、
“潘多拉的魔盒”
利用了微软操作系统中至少4个漏洞，其中有3个全新的
零日漏洞；为衍生的驱动程序使用有效的数字签名；通
过一套完整的入侵和传播流程，突破工业专用局域网的
物理限制；利用WinCC系统的2个漏洞，对其开展破坏
性攻击。它是第一个直接破坏现实世界中工业基础设施
的恶意代码。据赛门铁克公司的统计，目前全球已有约
45000个网络被该蠕虫感染，其中60%的受害主机位于
伊朗境内。伊朗政府已经确认该国的布什尔核电站遭到
Stuxnet蠕虫的攻击。
20
商业军火带来的问题
我们面对怎样的对手
21
商业军火带来的问题
我们面对怎样的对手
22
商业军火带来的问题
我们面对怎样的对手
视频演示
23
商业军火带来的问题
我们面对怎样的对手
2012年5月，俄罗斯安全专家发现一种威力强大的电脑病毒“火
焰”(Flame)在中东地区大范围传播。俄罗斯电脑病毒防控机构卡
巴斯基称，这种新病毒可能是“某个国家专门开发的网络战武
器”。
“火焰”病毒最早可能于2010年3月就被攻击者放出，但一直没
能被其他网络安全公司发现。主要感染中东地区。它由一个20MB
大小的模块包组成，共包含20个模块且每个模块有着不同的作用。
flame的体积十分庞大并且结构极为复杂，被称为有史以来最复杂
的病毒，因此很难追踪它的感染途径。受害者的范围极其广泛，
从个人到国家机构及学术和教育体系等。
Flame病毒可以通过USB存储器以及网络复制和传播，并能接受
来自世界各地多个服务器的指令。感染“火焰”病毒的电脑将自
动分析自己的网络流量规律，自动录音，记录用户密码和键盘敲
击规律，并将结果和其他重要文件发送给远程操控病毒的服务器。
一旦完成搜集数据任务，这些病毒还可自行毁灭，不留踪迹。
24
商业军火带来的问题
我们面对怎样的对手
25
商业军火带来的问题
我们面对怎样的对手
26
商业军火带来的问题
我们面对怎样的对手
27
商业军火带来的问题
我们面对怎样的对手
Regin的六个阶段
阶段
组件
阶段 0
投放器。安装Regin 至目
标计算机
阶段 1
加载驱动程序，唯一明显
可见的代码，其余各阶段
均加密数据形式存储
阶段 2
加载驱动程序
阶段 3
加载压缩、解密、联网及
处理加密的EVFS程序
阶段 4