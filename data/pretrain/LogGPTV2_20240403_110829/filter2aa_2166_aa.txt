### APT与新威胁论坛

#### 网络安全威胁中的商业军火

##### 从HackingTeam说起
- **商业化间谍软件现状**
- **商业军火带来的问题**
- **可以采取的应对策略**

#### HackingTeam概览
- **成立时间**: 2003年
- **创始人**:
  - David Vincenzetti (CEO)
  - Valeriano Bedeschi (CIO)
- **核心人物**:
  - Alberto Ornaghi (软件架构师)
  - Marco Valleri (进攻安全管理)
- **总部**: 米兰，意大利
- **产品特点**:
  - 提供免费开源的内网安全审计工具
  - 基于MITM（中间人攻击）实现
  - 被称为“第一个面向警方的商用黑客软件”

#### HackingTeam组织结构
- **部门**:
  - 管理: 7人
  - 行政: 9人
  - 销售: 8人
  - 安全: 9人
  - 运营: 15人
  - 研发: 17人
- **总人数**: 65人

#### 主要客户分布
| 组织名称 | 国家 | 区域 | 最早订单 | 年费 (EUR) | 总收入 (EUR) |
|----------|------|------|-----------|-------------|---------------|
| 智利     | 智利 | 拉美 | 2014      | 2,289,155   | ISO           |
| 乌干达   | 乌干达 | 非洲 | 2015      | 831,000     | 2,197,100     |
| CSDN     | 摩洛哥 | 非洲 | 2009      | 140,000     | 1,936,050     |
| 墨西哥   | 墨西哥 | 拉美 | 2010      | 130,000     | 1,390,000     |
| DGST     | 摩洛哥 | 非洲 | 2012      | 160,000     | 1,237,500     |
| 新加坡   | 新加坡 | 亚洲 | 2008      | 89,000      | 1,209,967     |
| GID Saudi | 沙特阿拉伯 | 非洲 | 2012      | 114,000     | 1,201,000     |
| UAE Intelligence | 阿联酋 | 非洲 | 2012      | 150,000     | 1,200,000     |
| MOD Saudi | 沙特阿拉伯 | 非洲 | 2013      | 220,000     | 1,108,687     |
| SIS      | 哈萨克斯坦 | 欧洲 | 2012      | 140,000     | 1,012,500     |

#### RCS 能力
- **操作系统支持**:
  - Windows
  - OSX
  - BlackBerry
  - Windows Mobile
  - Android
  - iOS

#### 商业化间谍软件功能
- **监控功能**:
  - 短信息监控
  - Facebook监控
  - WhatsApp监控
  - LINE监控
  - 联系人黑白名单
  - 应用程序监控
  - 应用黑白名单
  - 应用风险状态
  - 通话监控
  - 位置监控
  - 媒体文件监控
  - Web访问监控
  - 手机开关机记录
- **界面特性**:
  - 多语言界面
  - 有/无图标版本（图标可隐藏）
  - 安装后在Services中可见
  - 中文界面
  - 安装后无图标
  - 安装后在Services不可见
  - 需要手动激活

#### 商业化攻击平台：Cobalt Strike
- **项目负责人**: Raphael Mudge
- **背景**:
  - Strategic Cyber LLC 创始者和负责人 (2012.1-至今)
  - 特拉华州空军国民警卫队 领导，传统预备役 (2009-至今)
  - Cobalt Strike 项目负责人 (2011.11-2012.5)
  - TDI 高级安全工程师 (2010.8-2011.6)
  - Automattic 代码Wrangler (2009.7-2010.8)
  - Feedback Army, After the Deadline 创始人 (2008.7-2009.11)
  - 美国空军研究实验室 系统工程师 (2006.4-2008.3)
  - 美国空军 通信与信息 军官 (2004.3-2008.3)

- **教育背景**:
  - Syracuse University (美国雪城大学)
  - 密歇根科技大学

- **主要功能**:
  - HTML Application
  - Java Application
  - MS Office Macro
  - Payload Generator
  - USB/CD AutoPlay
  - Windows Dropper
  - Windows Executable
  - Windows Executable(S)
  - Web Drive-by
  - Manage
  - Auto-Exploit Server
  - Client-side-Attacks
  - Clone Site
  - Firefox Add-on Attack
  - ...

#### 真实案例
- **APT TOCS**

#### 商业军火带来的问题
- **我们面对怎样的对手**:
  - **Stuxnet蠕虫**:
    - 利用了微软操作系统中至少4个漏洞，其中有3个全新的零日漏洞。
    - 使用有效的数字签名进行驱动程序衍生。
    - 通过一套完整的入侵和传播流程，突破工业专用局域网的物理限制。
    - 利用WinCC系统的2个漏洞，对其开展破坏性攻击。
    - 是第一个直接破坏现实世界中工业基础设施的恶意代码。
    - 据赛门铁克公司的统计，全球已有约45000个网络被该蠕虫感染，其中60%的受害主机位于伊朗境内。伊朗政府已经确认该国的布什尔核电站遭到Stuxnet蠕虫的攻击。

  - **Flame病毒**:
    - 2012年5月，俄罗斯安全专家发现一种威力强大的电脑病毒“火焰”(Flame)在中东地区大范围传播。
    - 由一个20MB大小的模块包组成，共包含20个模块且每个模块有着不同的作用。
    - 结构极为复杂，被称为有史以来最复杂的病毒。
    - 可以通过USB存储器以及网络复制和传播，并能接受来自世界各地多个服务器的指令。
    - 感染“火焰”病毒的电脑将自动分析自己的网络流量规律，自动录音，记录用户密码和键盘敲击规律，并将结果和其他重要文件发送给远程操控病毒的服务器。
    - 一旦完成搜集数据任务，这些病毒还可自行毁灭，不留踪迹。

  - **Regin病毒**:
    - **阶段**:
      - **阶段 0**: 投放器。安装Regin 至目标计算机。
      - **阶段 1**: 加载驱动程序，唯一明显可见的代码，其余各阶段均加密数据形式存储。
      - **阶段 2**: 加载驱动程序。
      - **阶段 3**: 加载压缩、解密、联网及处理加密的EVFS程序。
      - **阶段 4**: ...

通过上述内容，我们可以看到商业军火对网络安全构成的巨大威胁。了解这些威胁并采取相应的应对策略至关重要。