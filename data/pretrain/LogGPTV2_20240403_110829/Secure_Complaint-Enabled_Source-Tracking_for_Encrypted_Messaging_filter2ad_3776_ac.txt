gets to choose the plaintext ğ‘š that is sent as well as the metadata md
included with authored messages. The same game applies for both
tree-linkable and tree-unlinkable security, with the only change
being that the ğ‘™ğ‘–ğ‘›ğ‘˜ğ‘ğ‘ğ‘™ğ‘’ flag in the malRec oracle is set to true for
tree-linkable security.
In order to keep track of messages and their associated forward-
ing trees, each message sent in the game is identified by a unique
message id ğ‘šğ‘–ğ‘‘, and each forwarding tree is identified by a unique
ğ‘¡ğ‘–ğ‘‘, which is the value of ğ‘šğ‘–ğ‘‘ for the message at the root of the tree.
The game uses table ğ‘‡ğ‘ğ‘¢ğ‘¡â„ to keep track of authoring data ğ‘ğ‘‘ for
each honest user and table ğ‘‡ğ‘Ÿğ‘’ğ‘ to keep track of messages received
by honest users. The set Sğ‘ ğ‘’ğ‘’ğ‘› records which forwarding trees the
adversary has encountered, and the set Sğ‘ğ‘™ğ‘™ğ‘œğ‘¤ğ‘’ğ‘‘ keeps track of the
pairs of trees from which malRec can be given messages without
enabling a trivial win in the tree-linkable variant of the game.
Definition 3.2. The user confidentiality advantage of an adversary
A against a source-tracking scheme ğ‘†ğ‘‡ and messaging scheme E
is defined as
ğ‘†ğ‘‡ ,E = 1(cid:105)(cid:12)(cid:12)(cid:12)
ğ‘†ğ‘‡ ,E = 1(cid:105) âˆ’ Pr(cid:104)ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ A,0,â„“
(cid:12)(cid:12)(cid:12)Pr(cid:104)ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ A,1,â„“
Adv
ğ‘†ğ‘‡ ,E (A) =
uconf
where the adversary is given access to send and receive oracles for
all malicious users in Uğ‘šğ‘ğ‘™ as well as oracles getUser, goodAuth,
goodFwd, malSend, and malRecâ„“,ğ‘(Â·, Â·, Â·, Â·). We refer to the advan-
tage as the tree-linkable advantage if â„“ = true and as the tree-
unlinkable advantage otherwise.
Platform confidentiality. We assume that a platform for an en-
crypted messaging scheme can see that a user ğ‘ˆğ‘  sent a message
to ğ‘ˆğ‘Ÿ , but that it cannot learn anything about the content of that
message, or whether it was a forward. There has been research into
the possibility of metadata-hiding messaging schemes where the
sender or receiver of a message can be hidden from the platform
(e.g., [8, 17â€“19, 36]), but we will be aligning our confidentiality
goals with the former setting, which corresponds to most deployed
messaging schemes, and assuming that the identities of the sending
and receiving users are visible to the platform.
The platform confidentiality game operates similarly to the user
confidentiality game, except that now the adversary controls the
platform and an arbitrary number of malicious users. Similar to user
confidentiality, the game gives the adversary oracles goodSend and
goodRec for sending messages between honest users and malSend
and malRec to send a message from or to a malicious user, respec-
tively. We separate the sending and receiving of messages into
separate oracles to allow the adversary to launch attacks that in-
volve delivering message data to unintended recipients or otherwise
tampering with the message delivery process. Additionally, a new
report oracle allows a user to report a message to the platform.
Finally, since the security game must ensure that the platform
adversary learns nothing about the plaintext of messages, the chal-
lenge message in the platform confidentiality game is sent to an
honest user instead of a malicious user. We formalize platform
confidentiality with the ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ game, described in Appendix A.1.
Definition 3.3. The advantage of an adversary A in the ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹
game against a source-tracking scheme ğ‘†ğ‘‡ and messaging scheme
E is defined as
pconf
ğ‘†ğ‘‡ ,E (A) =
Adv
ğ‘†ğ‘‡ ,E = 1(cid:105)(cid:12)(cid:12)(cid:12)
ğ‘†ğ‘‡ ,E = 1(cid:105) âˆ’ Pr(cid:104)ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ A,0
(cid:12)(cid:12)(cid:12)Pr(cid:104)ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ A,1
where the adversary is given access to the oracles in Figure 7.
Definition 3.4. We say that a source-tracking scheme ğ‘†ğ‘‡ and
associated messaging scheme E satisfy confidentiality if for all effi-
cient adversaries Ağ‘¢ and Ağ‘, we have that both Adv
ğ‘†ğ‘‡ ,E (A) and
uconf
pconf
ğ‘†ğ‘‡ ,E (Ağ‘) are negligible. If the advantage used in the ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹
Adv
game is tree-linkable, then we say the scheme is tree-linkably con-
fidential, and likewise tree-unlinkably confidential if the advantage
is tree-unlinkable.
3.3 Accountability and Unforgeability
Accountability and unforgeability ensure that a source-tracking
scheme can provide the platform with useful and accurate informa-
tion when a message is reported. We present security games for
both properties in Figure 2.
The ğ‘ ğ‘Ÿğ‘ğµğ¼ ğ‘ ğ· game addresses accountability by allowing a user
to send and receive any messages it would like, and then challenging
the adversary to send a message that is received by an honest user,
but fails when the honest user tries to report it to the platform.
The ğ‘¢ğ‘›ğ¹ğ‘‚ğ‘…ğºğ¸ game addresses unforgeability by challenging an
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1488getUser(ğ‘ˆ , ğ‘–ğ‘ ğ‘€ğ‘ğ‘™)
U â† Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆª Uğ‘šğ‘ğ‘™
if ğ‘ˆ âˆˆ U : return âŠ¥
if ğ‘–ğ‘ ğ‘€ğ‘ğ‘™ : Uâ€² â† âŸ¨A, ğ‘ƒğ‘›ğ‘’ğ‘¤ (sk, U)âŸ©(ğ‘ˆ , pk)
return âŠ¥
return âŠ¥
if Uâ€² = âŠ¥ : return âŠ¥
return Uğ‘šğ‘ğ‘™ .ğ‘ğ‘‘ğ‘‘(ğ‘ˆ)
(ğ‘ğ‘‘, Uâ€²) â† âŸ¨ğ‘ˆğ‘›ğ‘’ğ‘¤, ğ‘ƒğ‘›ğ‘’ğ‘¤ (sk, U)âŸ©(ğ‘ˆ , pk)
if (ğ‘ğ‘‘, Uâ€²) = âŠ¥ : return âŠ¥
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆ ] â† ad
return Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ .ğ‘ğ‘‘ğ‘‘(ğ‘ˆ)
goodAuth(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, md)
if ğ‘ˆğ‘  âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ :
ad â† ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ], ğ‘šğ‘ ğ‘” â† (ğ‘š, ad)
(ğ‘ğ‘‘â€², ğ‘ğ‘‘, ğ‘’) â† âŸ¨ğ‘ˆğ‘ğ‘¢ğ‘¡â„(ğ‘šğ‘ ğ‘”), ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
(ğ‘š, fd) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
if (ğ‘š, fd) = âŠ¥ :
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ] â† adâ€²
ğ‘šğ‘–ğ‘‘ â†R {0, 1}ğ‘›
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd, ğ‘šğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘
goodFwd(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘šğ‘–ğ‘‘, md)
if ğ‘ˆğ‘  âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆ¨ ğ‘ˆğ‘Ÿ âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ âˆ¨ ğ‘šğ‘–ğ‘‘ âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆ â€²
if ğ‘ˆ â€²
ğ‘šğ‘ ğ‘” â† (ğ‘š, fd)
(fdğ‘ , ğ‘ğ‘‘, ğ‘’) â† âŸ¨ğ‘ˆğ‘“ ğ‘¤ğ‘‘ (ğ‘šğ‘ ğ‘”), ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
(ğ‘š, fdğ‘Ÿ) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
if fdğ‘Ÿ âˆ¨ fdğ‘  = âŠ¥ :
ğ‘šğ‘–ğ‘‘â€² â†R {0, 1}ğ‘›
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆ â€²
ğ‘Ÿ , ğ‘š, fdğ‘ , ğ‘¡ğ‘–ğ‘‘)
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘â€²] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fdğ‘Ÿ , ğ‘¡ğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘â€²
ğ‘Ÿ , ğ‘š, fd, ğ‘¡ğ‘–ğ‘‘) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘]
ğ‘ , ğ‘ˆ â€²
ğ‘Ÿ â‰  ğ‘ˆğ‘  :
return âŠ¥
return âŠ¥
ğ‘ , ğ‘ˆ â€²
return âŠ¥
ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ A,ğ‘,â„“
ğ‘†ğ‘‡ ,E
(pk, sk) â† KGen(ğ‘ğ‘ğ‘Ÿğ‘ğ‘šğ‘ )
ğ‘â€² â† AOâ„“,ğ‘ (pk)
return ğ‘â€²
malSend(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , md)
if ğ‘ˆğ‘  âˆ‰ Uğ‘šğ‘ğ‘™ : return âŠ¥
(ğ‘ğ‘‘, ğ‘’) â† âŸ¨A, ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
if ğ‘ˆğ‘Ÿ âˆˆ Uğ‘šğ‘ğ‘™ :
return âŠ¥
return âŸ¨A, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
(ğ‘š, fd) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
if fd = âŠ¥ :
ğ‘šğ‘–ğ‘‘ â†R {0, 1}ğ‘›
Sğ‘ ğ‘’ğ‘’ğ‘› .ğ‘ğ‘‘ğ‘‘(ğ‘šğ‘–ğ‘‘), Sğ‘ğ‘™ğ‘™ğ‘œğ‘¤ğ‘’ğ‘‘ .ğ‘ğ‘‘ğ‘‘((ğ‘šğ‘–ğ‘‘, ğ‘šğ‘–ğ‘‘))
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd, ğ‘šğ‘–ğ‘‘)
return ğ‘šğ‘–ğ‘‘
malRecğ‘™ğ‘–ğ‘›ğ‘˜ğ‘ğ‘ğ‘™ğ‘’,ğ‘(ğ‘ˆğ‘Ÿ , ğ‘šğ‘–ğ‘‘0, ğ‘šğ‘–ğ‘‘1, md)
if ğ‘ˆğ‘Ÿ âˆ‰ Uğ‘šğ‘ğ‘™ : return âŠ¥
if ğ‘šğ‘–ğ‘‘0 âˆ¨ ğ‘šğ‘–ğ‘‘1 âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆ (0)
(ğ‘ˆ (1)
if ğ‘ˆ (0)
if ğ‘™ğ‘–ğ‘›ğ‘˜ğ‘ğ‘ğ‘™ğ‘’ âˆ§ (ğ‘¡ğ‘–ğ‘‘0, ğ‘¡ğ‘–ğ‘‘1) âˆ‰ Sğ‘ğ‘™ğ‘™ğ‘œğ‘¤ğ‘’ğ‘‘ âˆ§ {ğ‘¡ğ‘–ğ‘‘0, ğ‘¡ğ‘–ğ‘‘1} âˆ© Sğ‘ ğ‘’ğ‘’ğ‘› â‰  âˆ… :
, ğ‘š0, fd0, ğ‘¡ğ‘–ğ‘‘0) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘0]
, ğ‘š1, fd1, ğ‘¡ğ‘–ğ‘‘1) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘1]
ğ‘Ÿ âˆ¨ ğ‘ˆ (0)
, ğ‘ˆ (0)
, ğ‘ˆ (1)
ğ‘Ÿ â‰  ğ‘ˆ (1)
âˆˆ Uğ‘šğ‘ğ‘™ âˆ¨ ğ‘š0 â‰  ğ‘š1 :
return âŠ¥
return âŠ¥
ğ‘ 
ğ‘ 
ğ‘Ÿ
ğ‘Ÿ
ğ‘Ÿ
return âŠ¥
Sğ‘ğ‘™ğ‘™ğ‘œğ‘¤ğ‘’ğ‘‘ .ğ‘ğ‘‘ğ‘‘((ğ‘¡ğ‘–ğ‘‘0, ğ‘¡ğ‘–ğ‘‘1)), Sğ‘ ğ‘’ğ‘’ğ‘› .ğ‘ğ‘‘ğ‘‘(ğ‘¡ğ‘–ğ‘‘0, ğ‘¡ğ‘–ğ‘‘1)
ğ‘šğ‘ ğ‘” â† (ğ‘šğ‘, fdğ‘)
(fdğ‘ , ğ‘ğ‘‘, ğ‘’) â† âŸ¨ğ‘ˆğ‘“ ğ‘¤ğ‘‘ (ğ‘šğ‘ ğ‘”), ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆ (ğ‘)
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘ğ‘] â† (ğ‘ˆ (ğ‘)
return âŸ¨A, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆ (ğ‘)
, ğ‘šğ‘, fdğ‘ , ğ‘¡ğ‘–ğ‘‘ğ‘)
, ğ‘ˆğ‘Ÿ , ğ‘’, pk)
, ğ‘ˆ (ğ‘)
ğ‘ 
ğ‘Ÿ
ğ‘Ÿ
ğ‘Ÿ
, ğ‘ˆğ‘Ÿ , pk)
Figure 1: User confidentiality game and oracles. The oracle Oâ„“,ğ‘ gives the adversary access to getUser(Â·, Â·), goodAuth(Â·, Â·, Â·, Â·),
goodFwd(Â·, Â·, Â·, Â·), malSend(Â·, Â·, Â·), and malRecâ„“,ğ‘ (Â·, Â·, Â·, Â·) as well as the send(Â·, ğ‘ˆ , Â·) and receive(Â·, Â·, ğ‘ˆ) oracles for the underlying encrypted
messaging scheme for all ğ‘ˆ âˆˆ Uğ‘šğ‘ğ‘™ . â„“ is a fixed variable that determines whether the ğ‘ˆ ğ¶ğ‘‚ğ‘ ğ¹ game requires tree-linkability (â„“ = 1) or
tree-unlinkability (â„“ = 0), and ğ‘ is a hidden variable that determines which version of the game the adversary sees.
adversary who can see the result of receiving and sending messages
to malicious users to create a report that is validated by the platform
but implicates an honest user in sending a message it never sent.
Both games give the adversary a set of oracles which allow it to
send and receive messages between arbitrary users and control the
sending and receiving on a set of users that it controls. The oracle
getUser allows an adversary to add honest and malicious users.
Oracles goodAuth and goodFwd allow sending messages from hon-
est users, and malSend allows malicious users to send messages to
honest users. The adversary is also given access to a reporting ora-
cle âŸ¨Â·, ğ‘ƒğ‘Ÿğ‘’ğ‘(sk)âŸ©(Â·, pk) and oracles for sending messages between
malicious users in the underlying messaging scheme.
We assume the oracle has an associated Mğ‘ ğ‘’ğ‘›ğ‘¡ set that keeps
track of the messages that have been sent by honest users. As in
the confidentiality games (Section 3.2), we use unique message ids
(ğ‘šğ‘–ğ‘‘) to refer to message transactions between honest users, use a
table ğ‘‡ğ‘ğ‘¢ğ‘¡â„ to keep track of the authoring data for honest users, and
use a table ğ‘‡ğ‘Ÿğ‘’ğ‘ indexed by ğ‘šğ‘–ğ‘‘ to keep track of the data associated
with messages received by honest users.
Definition 3.5. We define the advantage of an adversary A in the
ğ‘ ğ‘Ÿğ‘ğµğ¼ ğ‘ ğ· game for a source-tracking scheme ğ‘†ğ‘‡ and messaging
scheme E as
srcâˆ’bind
ğ‘†ğ‘‡ ,E
Adv
(A) = Pr[ğ‘ ğ‘Ÿğ‘ğµğ¼ ğ‘ ğ·A
ğ‘†ğ‘‡ ,E = 1].
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1489goodAuth(ğ‘š, md, ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ)
if ğ‘ˆğ‘  âˆ‰ Uâ„ğ‘œğ‘›ğ‘’ğ‘ ğ‘¡ :
return âŠ¥
ad â† ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ]
ğ‘šğ‘ ğ‘” â† (ğ‘š, ad)
(ğ‘ğ‘‘â€², ğ‘ğ‘‘, ğ‘’) â† âŸ¨ğ‘ˆğ‘ğ‘¢ğ‘¡â„(ğ‘šğ‘ ğ‘”), ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘ğ‘¢ğ‘¡â„[ğ‘ˆğ‘  ] â† adâ€², Mğ‘ ğ‘’ğ‘›ğ‘¡ .ğ‘ğ‘‘ğ‘‘((ğ‘ˆğ‘ , md, ğ‘š))
if ğ‘ˆğ‘Ÿ âˆˆ Uğ‘šğ‘ğ‘™ :
return âŸ¨A, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
(ğ‘š, fd) â† âŸ¨ğ‘ˆğ‘Ÿğ‘’ğ‘, ğ‘ƒğ‘Ÿğ‘’ğ‘ (sk, ğ‘ğ‘‘)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘’, pk)
ğ‘šğ‘–ğ‘‘ â†R {0, 1}ğ‘›
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , ğ‘š, fd)
return ğ‘šğ‘–ğ‘‘
goodFwd(ğ‘šğ‘–ğ‘‘, md, ğ‘ˆğ‘Ÿ)
return âŠ¥
if ğ‘šğ‘–ğ‘‘ âˆ‰ ğ‘‡ğ‘Ÿğ‘’ğ‘ :
(ğ‘ˆ â€²
ğ‘ , ğ‘ˆğ‘ , ğ‘š, fd) â† ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘]
ğ‘šğ‘ ğ‘” â† (ğ‘š, fd)
(fdâ€², ğ‘ğ‘‘, ğ‘’) â† âŸ¨ğ‘ˆğ‘“ ğ‘¤ğ‘‘ (ğ‘šğ‘ ğ‘”), ğ‘ƒğ‘ ğ‘’ğ‘›ğ‘‘ (sk, md)âŸ©(ğ‘ˆğ‘ , ğ‘ˆğ‘Ÿ , pk)
ğ‘‡ğ‘Ÿğ‘’ğ‘ [ğ‘šğ‘–ğ‘‘] â† (ğ‘ˆ â€²
if ğ‘ˆğ‘Ÿ âˆˆ Uğ‘šğ‘ğ‘™ :
ğ‘ , ğ‘ˆğ‘ , ğ‘š, fdâ€²)