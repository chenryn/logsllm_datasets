  huge.	
  They’ll	
  represent	
  real	
  opponents	
  or	
  ﬁcIonal	
  opponents.	
  They	
  get	
accredited.	
  They’re	
  just	
  one	
  part	
  of	
  an	
  exercise	
  that	
  also	
  includes	
  poliIcal,	
  social,	
geographical	
  and	
  other	
  elements.	
  In	
  fact,	
  informaIon	
  warfare	
  tacIcs	
  may	
  be	
  one	
  part	
  of	
  an	
OPFOR	
  exercise.	
In	
  contrast,	
  a	
  Red	
  Team	
  typically	
  consists	
  of	
  a	
  much	
  smaller	
  number	
  of	
  players,	
  and	
  targets	
not	
  a	
  military	
  force,	
  but	
  an	
  organizaIon,	
  facility	
  or	
  security	
  system.	
  A	
  straighqorward	
example	
  is	
  the	
  use	
  of	
  a	
  Red	
  Team	
  to	
  test	
  TSA	
  procedures	
  at	
  a	
  parIcular	
  airport.	
  The	
  goal	
  of	
  a	
Red	
  Team	
  is	
  to	
  measure	
  the	
  state	
  of	
  the	
  system.	
  Is	
  it	
  prepared	
  to	
  defend	
  against	
  a`ack	
  type	
X?	
I	
  prefer	
  the	
  goal	
  of	
  the	
  OPFOR,	
  which	
  is	
  essenIally	
  training	
  –	
  giving	
  human	
  beings	
  something	
that’s	
  as	
  close	
  to	
  real-­‐world	
  experience	
  as	
  we	
  can	
  get.	
The	
  asymmetrical	
  nature	
  of	
  dealing	
  with	
  a	
  Red	
  Team	
  more	
  naturally	
  lines	
  up	
  with	
  a`acks	
  of	
opportunity,	
  where	
  early	
  detecIon	
  is	
  the	
  key.	
  As	
  targeted	
  a`acks	
  become	
  more	
  common,	
  I	
think	
  we’ll	
  see	
  a	
  move	
  to	
  the	
  OPFOR	
  concept	
  where	
  the	
  Blue	
  Team	
  must	
  take	
  the	
  ba`le	
  to	
5	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
By	
  “OPFOR	
  4Ever”,	
  we	
  mean	
  applying	
  the	
  OPFOR	
  concept	
  to	
  informaIon	
  security	
a`ack	
  and	
  defense	
  so	
  as	
  to	
  create	
  a	
  conInuous	
  feedback	
  loop	
  between	
  these	
  two	
communiIes.	
Pentesters	
  train	
  defenders,	
  but	
  equally	
  the	
  defenders	
  must	
  train	
  the	
  opposing	
  force.	
Also,	
  we’re	
  not	
  talking	
  about	
  some	
  once-­‐a-­‐year	
  exercise,	
  but	
  a	
  constant	
  mode	
  of	
operaIon.	
  For	
  organizaIons	
  with	
  both	
  a`ack	
  and	
  defense	
  capabiliIes,	
  this	
  is	
  simply	
a	
  call	
  for	
  more	
  communicaIon	
  and	
  cross-­‐training.	
  For	
  organizaIons	
  with	
  only	
  one	
capability	
  or	
  the	
  other,	
  it	
  means	
  ﬁnding	
  ways	
  to	
  interact	
  with	
  the	
  wider	
  community	
to	
  share	
  results	
  and	
  learn	
  from	
  others.	
6	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
7	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
8	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
7/29/12	
10	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
11	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
12	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
13	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
14	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
15	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
7/29/12	
16	
DEF	
  CON	
  20	
Trustwave	
  SpiderLabs	
First	
  let	
  me	
  explain	
  what	
  I	
  mean	
  by	
  “real-­‐world”	
  here.	
  We	
  have	
  to	
  remember	
  that	
  a	
penetraIon	
  test	
  is	
  a	
  model	
  of	
  something	
  else,	
  and	
  its	
  value	
  is	
  related	
  to	
  how	
  close	
  or	
far	
  away	
  the	
  model	
  is	
  from	
  reality.	
  So	
  by	
  “real-­‐world	
  pentesIng”	
  I	
  don’t	
  mean	
“pentesIng	
  like	
  the	
  real	
  pentesters	
  do	
  it”.	
  I	
  mean	
  “pentesIng	
  like	
  the	
  real	
  a`ackers	
do	
  it”.	
  Or	
  simply	
  a	
  return	
  to	
  the	
  roots,	
  where	
  we	
  pay	
  parIcular	
  a`enIon	
  to	
  the	
diﬀerences	
  between	
  the	
  model	
  and	
  the	
  real	
  world.	
17	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
Consider	
  how	
  white	
  hats	
  choose	
  exploits	
  to	
  defend	
  against.	
Over	
  the	
  years	
  there	
  have	
  been	
  many	
  systems	
  proposed	
  to	
  rank	
  the	
  severity	
  of	
  a	
vulnerability.	
  MicrosoP	
  sIll	
  ranks	
  their	
  patches	
  as	
  CriIcal,	
  Important,	
  Moderate,	
  or	
Low.	
CERT	
  once	
  used	
  a	
  number	
  between	
  0-­‐180	
  based	
  on	
  factors	
  like:	
  is	
  it	
  known,	
  is	
  it	
  being	
exploited,	
  is	
  the	
  Internet	
  at	
  risk,	
  and	
  so	
  on?	
But	
  now	
  we	
  have	
  one	
  scoring	
  system	
  to	
  rule	
  them	
  all:	
  CVSS.	
18	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
Based	
  on	
  my	
  observaIons	
  from	
  my	
  pentesIng	
  experience,	
  and	
  cross-­‐referenced	
against	
  research	
  from	
  the	
  incident	
  response	
  community,	
  I	
  see…	
Four	
  of	
  the	
  biggest	
  factors	
  are:	
•  Safety:	
  the	
  a`ack	
  doesn’t	
  harm	
  the	
  target	
  –	
  ever	
  (for	
  2	
  reasons:	
  stealth	
  +	
reusability)	
•  Power:	
  the	
  a`ack	
  gives	
  the	
  a`acker	
  leverage	
  to	
  carry	
  out	
  further	
  a`acks	
•  Invisibility:	
  the	
  a`ack	
  may	
  be	
  detectable,	
  but	
  is	
  rarely	
  detected	
  (in	
  Ime)	
•  Frequency:	
  the	
  a`ack	
  targets	
  a	
  relaIvely	
  common	
  vulnerability	
  in	
  a	
  relaIvely	
common	
  target	
NoIce	
  that	
  Safety,	
  Power,	
  and	
  Invisibility	
  are	
  completely	
  missed	
  by	
  CVSS.	
19	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
If	
  you	
  spend	
  much	
  Ime	
  looking	
  at	
  CVE	
  data,	
  it’s	
  easy	
  to	
  slip	
  into	
  the	
  view	
  that	
“vulnerability”	
  ==	
  “that	
  which	
  can	
  be	
  patched”.	
  But	
  there’s	
  a	
  trivial	
  proof	
  that	
  this	
  is	
false.	
It’s	
  past	
  Ime	
  we	
  turned	
  more	
  a`enIon	
  to	
  vulnerabiliIes	
  that	
  only	
  exist	
  on	
  internal	
networks.	
  If	
  there’s	
  a	
  moral	
  to	
  be	
  learned	
  from	
  the	
  2011	
  RSA	
  hack,	
  it’s	
  that	
  we	
  are	
*all*	
  one	
  phishing	
  campaign	
  away	
  from	
  a	
  remote-­‐controlled	
  instance	
  of	
  BackTrack	
  on	
our	
  network.	
And	
  for	
  an	
  example	
  of	
  a`ack-­‐chains,	
  think	
  about	
  the	
  lowly	
  NetBIOS	
  null	
  session	
enumeraIon	
  a`ack	
  and	
  what	
  you	
  can	
  do	
  with	
  that	
  data.	
20	
7/29/12	
Trustwave	
  SpiderLabs	
DEF	
  CON	
  20	
In	
  the	
  last	
  couple	
  months	
  the	
  CVE	
  database	
  crossed	
  the	
  50,000	
  vulnerability	
threshold.	
  But	
  there	
  are	
  vastly	