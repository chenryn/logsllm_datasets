# G0077: Leafminer

## Description
[Leafminer](https://attack.mitre.org/groups/G0077) is an Iranian threat group that has targeted government organizations and business entities in the Middle East since at least early 2017. (Citation: Symantec Leafminer July 2018)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows, AWS, GCP, Azure AD, Azure, Office 365 | Persistence | [Create Account](https://attack.mitre.org/techniques/T1136/) | Leafminer used a tool called Imecab to set up a persistent remote access account on the victim machine. | Office 365 account logs, Azure activity logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters, Authentication logs, Windows event logs |
| Linux, macOS, Windows | Discovery | [File and Directory Discovery](https://attack.mitre.org/techniques/T1083/) | Leafminer used a tool called MailSniper to search for files on the desktop and another utility called Sobolsoft to extract attachments from EML files. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure, Office 365, SaaS, Azure AD | Defense Evasion, Persistence | [Redundant Access](https://attack.mitre.org/techniques/T1108/) | Leafminer used a tool called Imecab to set up a persistent remote access account on the victim machine. | Office 365 account logs, Azure activity logs, AWS CloudTrail logs, Stackdriver logs, Process monitoring, Process use of network, Packet capture, Network protocol analysis, File monitoring, Authentication logs, Binary file metadata |
| Windows, Office 365 | Collection | [Email Collection](https://attack.mitre.org/techniques/T1114/) | Leafminer used a tool called MailSniper to search through the Exchange server mailboxes for keywords. | Office 365 trace logs, Mail server, Email gateway, Authentication logs, File monitoring, Process monitoring, Process use of network |
| Linux, macOS, Windows, Office 365, Azure AD, SaaS | Credential Access | [Brute Force](https://attack.mitre.org/techniques/T1110/) | Leafminer used a tool called BruteForcer to perform a brute force attack. | Office 365 account logs, Authentication logs |
| Windows, Linux, macOS, SaaS | Initial Access | [Drive-by Compromise](https://attack.mitre.org/techniques/T1189/) | Leafminer has infected victims using watering holes. | Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection |
| Linux, Windows, macOS, AWS, GCP, Azure | Discovery | [Network Service Scanning](https://attack.mitre.org/techniques/T1046/) | Leafminer scanned network services to search for vulnerabilities in the victim system. | Netflow/Enclave netflow, Network protocol analysis, Packet capture, Process command-line parameters, Process use of network |
| Windows, Linux, macOS | Credential Access | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | Leafminer used several tools for retrieving login and password information. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | Leafminer obfuscated scripts that were used on victim machines. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows | Defense Evasion, Execution | [Scripting](https://attack.mitre.org/techniques/T1064/) | Leafminer infected victims using JavaScript code. | Process monitoring, File monitoring, Process command-line parameters |
| Linux, macOS, Windows, GCP, Azure, AWS | Discovery | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | Leafminer used Microsoftâ€™s Sysinternals tools to gather detailed information about remote systems. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |

This table provides a comprehensive overview of the tactics, techniques, and procedures (TTPs) employed by the Leafminer threat group, along with the relevant data sources for detecting and mitigating these activities.