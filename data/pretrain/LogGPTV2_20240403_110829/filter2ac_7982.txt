### Title: When Machines Can't Talk: Security and Privacy Issues in Machine-to-Machine Data Protocols

Two widely used machine-to-machine (M2M) protocols, MQTT and CoAP, are increasingly forming the backbone of many Internet of Things (IoT) infrastructures, including critical industrial environments. These protocols enable data connectivity for a wide range of "machines." However, our research has uncovered significant security and privacy issues that affect various market verticals, applications, products, and brands.

This talk presents a comprehensive security analysis of MQTT and CoAP at the design, implementation, and deployment levels. We identified several issues, including flaws in the design specifications, vulnerable product implementations, and hundreds of thousands of unsecured, publicly accessible deployments. These vulnerabilities can expose endpoints to denial-of-service attacks and, in some cases, full control by an adversary.

Despite efforts to address these issues in the design specifications, it is challenging for developers to keep up with evolving standards, especially as the technology becomes more pervasive. Additionally, the low barrier to entry in this market has led to a fragmented landscape of implementations. Our analysis of the source code of common MQTT implementations revealed common flaws, often stemming from misinterpretations of the standard. Specifically, we found issues in how multibyte strings, UTF-8 characters, and regular expressions are parsed. Combined with standard features that require servers to retain messages and clients to request acknowledgment for every message, these bugs can lead to persistent denial-of-service conditions. Our findings have been acknowledged by the MQTT Technical Committee, which has released a note to help identify and mitigate these risks.

Furthermore, we analyzed hundreds of millions of MQTT and CoAP messages from hundreds of thousands of servers. Despite previous efforts to raise awareness, we still found exposed data related to various industry sectors, including sensitive information such as credentials and network infrastructure details. Additionally, we discovered that MQTT is being used for purposes beyond messaging, such as transporting binary data, likely for over-the-air (OTA) updates, which raises significant security concerns.

Using MQTT and CoAP as concrete examples of modern M2M technology, we will provide recommendations at various levels—standardization bodies, vendors, developers, and users—to reduce the number of insecure deployments and promote a more responsible approach by standardization bodies.