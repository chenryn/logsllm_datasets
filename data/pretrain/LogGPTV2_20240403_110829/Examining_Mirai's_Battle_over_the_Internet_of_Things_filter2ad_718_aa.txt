title:Examining Mirai's Battle over the Internet of Things
author:Harm Griffioen and
Christian Doerr
Examining Mirai’s Battle over the Internet of Things
Hasso Plattner Institute for Digital Engineering
Hasso Plattner Institute for Digital Engineering
Christian Doerr
University of Potsdam, Germany
PI:EMAIL
Harm Griffioen
University of Potsdam, Germany
PI:EMAIL
ABSTRACT
Using hundreds of thousands of compromised IoT devices, the Mirai
botnet emerged in late 2016 as a game changing threat actor, capable
of temporarily taking down major Internet service providers and
Internet infrastructure. Since then, dozens of variants of IoT-based
botnets have sprung up, and in today’s Internet distributed denial-
of-service attacks from IoT devices have become a major attack
vector. This proliferation was significantly driven by the public
distribution of the Mirai source code, which other actors used to
create their own, customized version of the original Mirai botnet.
In this paper we provide a comprehensive view into the on-
going battle over the Internet of Things fought by Mirai and its
many siblings. Using 7,500 IoT honeypots, we show that we can use
300,000,000 compromisation attempts from infected IoT devices as
well as a design flaw in Mirai’s random number generator to obtain
insights into Mirai infections worldwide. We find that networks
and the particular malware strains that plague them are tightly con-
nected, and malware authors over time take over strategies from
their competitors. The most surprising finding is that epidemiologi-
cally, IoT botnets are not self-sustaining: were it not for continuous
pushes from bootstrapping, Mirai and its variants would die out.
CCS CONCEPTS
• Security and privacy → Network security; Malware and its mit-
igation.
KEYWORDS
Mirai, botnet, IoT, cyber threat intelligence
ACM Reference Format:
Harm Griffioen and Christian Doerr. 2020. Examining Mirai’s Battle over
the Internet of Things. In 2020 ACM SIGSAC Conference on Computer and
Communications Security (CCS ’20), November 9–13, 2020, Virtual Event, USA.
ACM, New York, NY, USA, 13 pages. https://doi.org/10.1145/3372297.3417277
1 INTRODUCTION
The emergence of the Mirai botnet in late 2016 fundamentally
changed the Internet threat landscape. Although the risk of insuffi-
ciently protected Internet-of-Things (IoT) devices was long known,
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
CCS ’20, November 9–13, 2020, Virtual Event, USA
© 2020 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-7089-9/20/11...$15.00
https://doi.org/10.1145/3372297.3417277
the problem made the front pages when its initial distributed denial-
of-service (DDoS) attacks exceeded volumes of 600 Gbps, crippling
major Internet infrastructure and service providers such as OVH
[2] or Dyn [1]. The first attack by an IoT botnet doubled previous
attack volumes from the get go, and in the coming weeks would
continue to increase to break the 1 Tbps threshold [8].
This did not only capture the attention of the general public
and defenders, but also the imagination of perpetrators. Soon after,
the source code of Mirai was published online [5], leading copy-
cats to release clones of Mirai-based IoT malware. Named “MIORI”,
“JOSHO”, or “MASUTA”, these variants are directly derived from the
Mirai source code, copying the core framework and essential rou-
tines for scanning, infection and communication, but also feature
actor-specific modifications to passwords, the way the malware
identifies itself, and the C&C servers bots report back to.
Trivial access of the source and the abundance of vulnerable de-
vices has led to a plethora of Mirai variants, which are fighting over
control over the millions of IoT devices deployed worldwide. In this
paper, we are examining this battle between Mirai and its siblings
that have emerged since. To do this, we leverage the fact that the
Mirai botnet behaves like a worm, using an infected IoT device to
scan the Internet for other devices it could potentially compromise.
With an installation of 7,500 IoT honeypots, we are collecting these
infection attempts, and can turn 300,000,000 received compromisa-
tion attempts into a real-time view which devices around the world
are infected at a given moment with a particular strain.
One of the core features across Mirai and all its variants is how
it searches for victims. To avoid sequential port scanning that is
trivially detected, the malware selects targets based on randomly
generated destination IP addresses, and for which the authors de-
signed their own random number generator (RNG). As we will show,
this design has severe flaws, allowing us to break the seed based on
information from a single incoming packet. This insight can then
be used to learn about the lifetime of the infection on the device
itself. With this work, we are making the following contributions:
• We are the first to provide a comprehensive view into the
infection and reinfection behavior of IoT devices. We demon-
strate that it is possible to exploit structural weaknesses in
Mirai’s RNG to extract the precise moment of compromisa-
tion, which we use to understand the lifetime of infections.
• We show that IoT devices are under intense attack by a
plethora of actors. We follow the activities of 39 variants
and analyze how they infect and retain control over some
200,000 unsecured devices. We find that compromised hosts
frequently change “ownership” through reboots and reinfec-
tions, but also based on hostile takeovers by other actors.
• We show that IoT malware crashes comparatively quickly
on routers, and there are clear differences between particular
malware strains and the network devices are placed in.
2.2 Mirai Behavior
Certain implementation choices of Mirai create unique behavioral
characteristics that can be efficiently fingerprinted. At a high level,
the Mirai IoT malware pursues three different objectives after the
infection of a device: first, it closes the entry point (typically telnet
on TCP port 23, which is also the focus of this paper) in order to gain
exclusivity over the compromised device. Second, the malware will
start a continuous scan for other devices and if it identifies an open
telnet port it begins to brute force based on a built-in credential
list. And third, it establishes a connection with the C&C server
hardcoded in the source and executes commands it receives. Figure
2 shows an excerpt of the Mirai source, which we will discuss in the
following, with these three tasks spawned in main() (see marker
1⃝ in figure 2).
When targeting telnet, Mirai will attempt to bind to port 23. If
this is not possible, it tries to shut down the other telnet process
through which other logins could take place. In killer_init(),
it identifies and kills the process that has bound to this port 2⃝,
thereby locking the router down for the duration of the infection.
Mirai and its descendants are however non-persistent, so after a
reboot the device is restored to its pre-infected, vulnerable state. It
will spin up its original telnet process, and is ready for reinfection.
As one of its first actions, the Mirai malware forks off a separate
thread that performs an Internet-wide scan for other IoT devices. As
shown in scanner_init(), it begins by re-initializing the random