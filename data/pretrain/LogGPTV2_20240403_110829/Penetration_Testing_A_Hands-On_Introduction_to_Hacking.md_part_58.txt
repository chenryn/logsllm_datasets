database
3Com TFTP 2.0.1, 42–43
dumping with SQLMap, 322
Kali Linux, 10
exploiting access to, 188
payload by users, 105
finding name of first, 321
sensitive files, 188–189
for SPF, 448–449
SLMail 5.5, 41–42
debugger, installing, 46
Smartphone Pentest Framework
debugging information, for GDB, 366
(SPF), 27–28
default gateway, 68
with TFTP, 187–188
ARP cache poisoning for
War-FTP, 46
impersonating, 165–166
Windows SAM, 189
finding, 38
WinSCP, 46
default payload, for Metasploit, 97
480 Index
dpkg command, 18 execute (x) permissions, 62
dual-homed systems, 304 execution
dynamic analysis, 261 hijacking as goal, 373
dynamic host configuration protocol hijacking in Linux, 375–376
(DHCP), 68 hijacking in Windows, 390–395
executive summary of report, 5
E exploit code, repositories of, 88
exploit command (Metasploit), 97
EAX register, 362, 403
Exploit Database, 88, 427
EBP register, 362, 363, 369, 390
exploit target, for Metasploit, 95
EBX register, 362
exploit/multi/browser/java_signed_applet
echo command, 61, 76
module, 233–234
ECX register, 363
exploitation, 179–196
EDI register, 362, 390
of buffer overflow in third-party
editing files, 62–64
software, 190–191
EDX register, 363
with client-side attacks, 218–239
EIP register, 362, 363
of compromised service, 193–194
controlling, 373–375
with Java, 230–235
locating, 384–388
mitigation techniques, 439–442
verifying offset, 388–389, 390
of MS08-067 vulnerability,
else statement, in Bash scripts, 78
180–182
email
of open NFS shares, 194–196
searching for addresses, 118–119
phase of penetration testing, 2, 4
social-engineering attacks
of phpMyAdmin, 186–188
with, 244
running through pivot, 306–307
emulator, Android, 449
of third-party web applications,
setting up, 22–27
191–193
starting, 26–27
of WebDav default credentials,
encoders, 263–266
182–183
encryption key, for Syskey utility, 189
Exploit::Remote::UDP mixin, 435
end, in Ruby, 434
exploits
endianness, 376–378, 394
porting public, 427–432
enterprise connection process, in
replacing shellcode, 430
WPA/WPA2, 351
running, 100
escape, double backslashes (\\)
running through SPF agent, 468
for, 186
with SEH overwrites, 403–407
ESI register, 362
writing, 361
ESP register, 362, 363, 390–391
exploit/windows/fileformat/adobe_pdf_
following on stack, 408–409
embedded_exe module, 228
/etc/crontab file, 72–73, 311
exploit/windows/fileformat/adobe_utilprintf
/etc/john/john.conf file, 212
module, 226
/etc/network/interfaces file, 68–69
exploit/windows/fileformat/winamp_maki_
/etc/proxychains.conf configuration
bof module, 238
file, 307
exploit/windows/local/ms11_080_
Ettercap
afdjoinleaf module, 284
installing, 22
exploit/windows/smb/psexec module, 296
for man-in-the-middle attacks, 171
exploit/windows/tftp/tftpd32_long_
exceptions. See structured exception
filename.rb module, 435
handler
external penetration test, 2
executables
Ez7z program, 10
embedded in PDF, 228–229
Hyperion for encrypting, 269–270
using return address from, 394
Index 481
F G
Facebook, 172 GCC (GNU Compiler Collection), 84,
factory restore, 456 289, 366
fake authentication, 347–348 gcc command, 289
file permissions, 61–62 GDB (GNU debugger), 366
filename for exploit, random crashing program in, 372–373
characters for, 438 running, 367–372
files viewing source code, 368
adding text, 61 getsystem command (Meterpreter),
copying, moving, and removing, 60 283–286
creating, 60 getuid command (Meterpreter), 185,
editing, 62–64 279, 281
searching for text in, 65 GNU Compiler Collection (GCC), 84,
sending script results to, 81 289, 366
viewing list of, 18 GNU debugger. See GDB (GNU
FileZilla server.xml configuration file, debugger)
188–189 Google Play apps, signature for, 462
FileZilla services, installing, 44 Google search, on vulnerability, 142
filters, bypassing with Metasploit GoToMeeting, Java for, 241
payloads, 216–218 grep command, 65
finding filtering script output, 80
attack string in memory, 408–411 greppable Nmap, 125
compatible payloads, 96–97 group, permissions for, 62
return address, 429–430 group transient key (GTK), 352
valid usernames, 153
firewalls, intrusion-detection and H
prevention systems on, 125
handler, closing, 228
folders, sharing via FTP, 45
Hardware dialog, 31
for loop, in Bash scripts, 78–79
hashdump command (Meterpreter), 204,
formats, for Nmap log, 125
205, 298
four-way handshake, 351, 352–353
hashes
capturing, 354
converting to plaintext, 203
Wireshark for viewing, 355
for domain users, 302
Framework Android App, 451
dumping with physical access,
FSTENV instruction, 398
206–208
FTP account, default password for, 213
example, 211
FTP server
LM vs. NTLM algorithms, 208
access to file on, 146–147
rainbow table for precompleted, 213
exploiting stack-based buffer
recovering from Windows SAM
overflow in, 379–380
files, 204–206
logging in to, 157, 165
reversing, 203, 298
FTP user, adding, 45
heap in memory, 362
futuresoft_transfermode.rb module,
“Hello World” C program, 84
432–434
help
fuzzing, 421–426
for Meterpreter commands, 278
attempting crash, 424–426
for Msfcli, 101
finding bugs with code review, 422
for Msfconsole, 89–90
for trivial FTP server, 422–423
help upload command (Meterpreter), 279
hidden directories, ls command to
show, 57–58
482 Index
hook.js script (BeEF), 332–333 installed packages, managing, 66
host utility for DNS queries, 117 installing
host-only network, 13, 117 3Com TFTP 2.0.1, 42–43
HTML, for attack email, 254 Adobe Acrobat Reader, 46
HTTP GET request, capture by Burp Android emulators, 22–27
Proxy, 316 Apache, 44
HTTP payload, 217–218 APKTool, 462
exploiting Java vulnerability with, debugger, 46
231–232 Ettercap, 22
HTTPS, 174 FileZilla services, 44
payloads, 217–218 Hyperion, 21, 270
hub, and traffic capture, 156 Immunity Debugger, 46–47
Hydra, guessing usernames and Java 7 Update 6, 52
passwords with, 202–203 Microsoft Security Essentials, 52
Hyperion Ming C Compiler, 20
encrypting executables with, Mona, 47
269–270 Mozilla Firefox, 52
installing, 21, 270 MySQL, 44
Nessus, 17–20
I Python, 46
SLMail 5.5, 41–42
Iceweasel browser, proxy configuration,
Smartphone Pentest Framework
315–316
(SPF), 27–28
ICMP (Internet Control Message
Veil-Evasion, 21
Protocol) message, 76
VMware, 9–10
if statement
vulnerable software, 40–47
Bash, 77–78
War-FTP, 46
C, 84
Winamp version 5.55, 52
Python, 83
WinSCP, 46
ifconfig command, 16, 67, 304–305
XAMPP 1.7.2, 43–45
IIS (Internet Information Services),
Intel-based CPU registers, 362–363
user privileges, 329
internal penetration test, 2
Immunity Debugger, 381–382
Internet access, testing for Kali
installing, 46–47
Linux, 17
#include command (C), 84
Internet Control Message Protocol
Incognito tool, 301–302
(ICMP) message, 76
incoming connection, listening on port
Internet Explorer, vulnerability,
for, 70
220–222
info command (Metasploit), 92–93
Internet Information Services (IIS),
information-gathering phase of
user privileges, 329
penetration testing, 2, 4,
Internet Protocol (TCP/IP) Properties
113–132
dialog, 39
local, 291–296
iOS, approach to preventing malicious
on mobile device, 464–465
code, 441
open source intelligence (OSINT),
IP address, 67–68
114–123
DNS mapping to, 167–168
initialization vector (IV), 344
mapping to MAC address, 161
generating with ARP request relay
setting static, 38–39
attack, 348–349
verifying, 16
inline payloads, 181
IP forwarding, 163–164
input, > symbol for redirecting, 61
ipconfig command, 38
input function (Python), 82
output from, 328
insert mode for vi, 64
Index 483
iPhone Incognito tool, 301–302
default SSH login, 453–454 PSExec technique, 296–297
jailbreaking, 219, 441 SMB capture, 302–304
running application on, 441 SSH Exec, 299–300
IV (initialization vector), 344 token impersonation, 300–301
generating with ARP request relay LHOST, 99–100
attack, 348–349 setting, 184
iwconfig command, 340–341 setting in Msfvenom, 104
iwlist wlan0 scan command, 341 license key, for Windows, 32