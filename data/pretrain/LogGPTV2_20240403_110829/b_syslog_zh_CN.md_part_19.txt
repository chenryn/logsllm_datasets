(mapped-dest-address/mapped-dest-port) [user ], ICMP id icmp-id , ICMP type icmp-type
说明：已收到带错误格式代码（非零）的ICMP回应请求/应答数据包。
建议的操作：如果是间歇性事件，则无需执行任何操作。如果是因为受到攻击，则可以使用ACL拒
绝主机。
314001
错误消息：%ASA-6-314001: Pre-allocated RTSP UDP backconnection for src_intf :src_IP to
dst_intf :dst_IP /dst_port.
思科ASA系列系统日志消息
114
系统日志消息302003-342008
314002
说明：ASA为正在从服务器接收数据的RTSP客户端打开了UDP媒体通道。
•src_intf-源接口名称
•src_IP-源接口IP地址
•dst_intf-目的接口名称
•dst_IP-目的IP地址
•dst_port-目的端口
建议的操作：无需执行任何操作。
314002
错误消息：%ASA-6-314002: RTSP failed to allocate UDP media connection from src_intf :src_IP
to dst_intf :dst_IP /dst_port : reason_string.
说明：ASA无法为媒体通道打开新针孔。
•src_intf-源接口名称
•src_IP-源接口IP地址
•dst_intf-目的接口名称
•dst_IP-目的IP地址
•dst_port-目的端口
•reason_string-针孔已经存在/未知
建议的操作：原因未知时，运行showmemory命令检查空余内存，或运行showconn命令检查使用
的连接数，因为ASA内存不足。
314003
错误消息：%ASA-6-314003: Dropped RTSP traffic from src_intf :src_ipdue to: reason.
说明：RTSP消息违反了用户配置的RTSP安全策略，因为可能是它包含保留端口范围内的某个端
口，或包含长度大于最大允许限制的URL。
•src_intf-源接口名称
•src_IP-源接口IP地址
•reason-原因可能是以下任意一项：
-终端在从0到1024的保留端口范围内协商媒体端口。
-urllength字节的URL长度超出最大的urllengthlimit字节数
建议的操作：调查RTSP客户端为什么发送违反安全策略的消息。如果请求的URL是合法的，您可
以在RTSP策略映射中指定更长的URL长度限制来放宽策略。
314004
错误消息：%ASA-6-314004: RTSP client src_intf:src_IP accessed RTSP URL RTSP URL
说明：RTSP客户端尝试访问RTSP服务器。
思科ASA系列系统日志消息
115
系统日志消息302003-342008
314005
•src_intf-源接口名称
•src_IP-源接口IP地址
•RTSPURL-RTSP服务器URL
建议的操作：无需执行任何操作。
314005
错误消息：%ASA-6-314005: RTSP client src_intf:src_IP denied access to URL RTSP_URL.
说明：RTSP客户端尝试访问禁止的站点。
•src_intf-源接口名称
•src_IP-源接口IP地址
•RTSP_URL-RTSP服务器URL
建议的操作：无需执行任何操作。
314006
错误消息：%ASA-6-314006: RTSP client src_intf:src_IP exceeds configured rate limit of rate
for request_method messages.
说明：特定RTSP请求消息超出了RTSP策略配置的频率限制。
•src_intf-源接口名称
•src_IP-源接口IP地址
•rate-配置的频率限制
•request_method-请求消息的类型
建议的操作：调查客户端发送的特定RTSP请求消息为什么超出了频率限制。
315004
错误消息：%ASA-3-315004: Fail to establish SSH session because RSA host key retrieval failed.
说明：ASA找不到RSA主机密钥，而建立SSH会话时需要用到该密钥。ASA主机密钥可能不存
在，这是因为系统未生成ASA主机密钥，或者此ASA的许可证不允许DES或3DES加密。
建议的操作：在ASA控制台中，输入showcryptokeymypubkeyrsa命令以验证RSA主机密钥是
否存在。如果主机密钥不存在，请输入showversion命令以验证是否允许DES或3DES。如果存在
RSA主机密钥，请重新启动SSH会话。要生成RSA主机密钥，请输入cryptokeymypubkeyrsa命
令。
315011
错误消息：%ASA-6-315011: SSH session from IP_address on interface interface_name for user
user disconnected by SSH server, reason: reason
思科ASA系列系统日志消息
116
系统日志消息302003-342008
315011
说明：SSH会话已结束。如果用户输入quit或exit，系统会显示terminatednormally消息。用户名
在无效或未知时隐藏，但在有效或配置了nologginghideusername命令时显示。如果会话由于其他
原因而断开连接，则文本会描述相应原因。下表列出了会话断开连接的可能原因。
表37:SSH断开连接的原因
文本字符串 说明 操作
Badcheckbytes（校验字 在SSH密钥交换期间，在校验字节 重新启动SSH会话。
节错误） 中检测到了不匹配情况。
CRCcheckfailed（CRC 针对特定数据包计算出的CRC值与 无需执行任何操作。如果此消息仍然
校验失败） 数据包中嵌入的CRC值不匹配；数 存在，请致电思科TAC。
据包出错。
Decryptionfailure（解密 在SSH密钥交换期间，SSH会话密 检查RSA主机密钥，然后重试。
失败） 钥解密失败。
Formaterror（格式错误） 在SSH版本交换期间，收到非协议 检查SSH客户端，确保它是受支持
版本消息。 的版本。
Internalerror（内部错 此消息表示ASA上的SSH内部错 在ASA控制台中，输入showcrypto
误） 误，或者可能未在ASA上输入RSA keymypubkeyrsa命令以验证RSA
密钥或无法检索RSA密钥。 主机密钥是否存在。如果主机密钥不
存在，请输入showversion命令以验
证是否允许DES或3DES。如果存在
RSA主机密钥，请重新启动SSH会
话。要生成RSA主机密钥，请输入
cryptokeymypubkeyrsa命令。
Invalidciphertype（密码 SSH客户端请求不受支持的密码。 输入showversion命令，以确定许可
类型无效） 证支持哪些功能，然后重新配置SSH
客户端以使用支持的密码。
Invalidmessagelength 到达ASA的SSH消息的长度超出 无需执行任何操作。
（消息长度无效） 262144字节或不足4096字节。数
据可能已损坏。
Invalidmessagetype（消 ASA收到非SSH消息，或者不受 检查对等体是否为SSH客户端。如
息类型无效） 支持或不需要的SSH消息。 果是支持SSHv1的客户端，且此消
息仍然存在，请在ASA串行控制台
中输入debugssh命令，并捕获调试
消息。然后联系思科TAC。
Outofmemory（内存不 当ASA无法分配内存以供SSH服 稍后重新启动SSH会话。
足） 务器使用时，或者ASA可能忙于处
理大量流量时，可能会出现此消
息。
思科ASA系列系统日志消息
117
系统日志消息302003-342008
315012
文本字符串 说明 操作
Rejectedbyserver（已被 用户身份验证失败。 要求用户验证用户名和密码。
服务器拒绝）
Resetbyclient（已被客户 SSH客户端将 无需执行任何操作。
端重置） SSH_MSG_DISCONNECT消息发
送给ASA。
statuscode:（状态代 用户关闭了SSH客户端窗口（在 无需执行任何操作。建议用户正常退
码：）hex(hex) Windows上运行），而不是在SSH 出客户端，而不是强制退出。
控制台中输入quit或exit。
Terminatedbyoperator 操作员在ASA控制台中输入了ssh 无需执行任何操作。
（操作员终止了会话） disconnect命令以终止SSH会话。
Time-outactivated（激活 由于超出了sshtimeout命令指定的 重新启动SSH连接。您可以使用ssh
了超时） 持续时间，SSH会话超时。 timeout命令增加超时值，其默认值
为5分钟，可以视需要最长增至60
分钟。
建议的操作：无需执行任何操作。
315012
错误消息：%ASA-3-315012: Weak SSH type (alg) provided from client IP_address on interface
Int. Connection failed.Not FIPS 140-2 compliant.
说明：在FIPS140-2认证过程中，启用FIPS后，只能使用aes128-cbc或aes256-cbc作为密码并使用
SHA1作为MAC，以启动SSH连接。使用不可接受的密码或MAC时，系统将生成此系统日志。如
果禁用FIPS模式，系统将不会显示此系统日志。
•type-密码或MAC
•alg-不可接受的密码或MAC的名称
•IP_address-客户端的IP地址
•int-客户端尝试连接的接口
建议的操作：提供可接受的密码或MAC
315013
错误消息：%ASA-6-315013: SSH session from  on interface 
for user “" rekeyed successfully.
说明：此系统日志表示，已成功完成SSH密钥更新。这是通用标准认证要求。
•SSH_client_address-客户端的IP地址
•interface_name-客户端尝试连接的接口
•user_name-与该会话关联的用户名
思科ASA系列系统日志消息
118
系统日志消息302003-342008
316001
建议的操作：无
316001
错误消息：%ASA-3-316001: Denied new tunnel to IP_address .VPN peer limit
(platform_vpn_peer_limit) exceeded
说明：如果尝试同时建立的VPN隧道(ISAKMP/IPsec)的数量超出平台VPN对等体支持的范围，则
超出部分的隧道将会中止。
建议的操作：无需执行任何操作。
316002
错误消息：%ASA-3-316002: VPN Handle error: protocol=protocol , src in_if_num :src_addr ,
dst out_if_num :dst_addr
说明：由于VPN句柄已存在，因此ASA无法创建VPN句柄。
•protocol-VPN流协议
•in_if_num-VPN流的入口接口数
•src_addr-VPN流的源IP地址
•out_if_num-VPN流的出口接口数
•dst_addr-VPN流的目的IP地址
建议的操作：正常操作期间可能出现此消息；但是，如果此消息重复出现，并且基于VPN的应用发
生重大故障，则可能是因为存在软件缺陷。输入以下命令收集更多信息，并联系思科TAC进一步调
查该问题：
capture
name
type asp-drop vpn-handle-error
show asp table classify crypto detail
show asp table vpn-context
317001
错误消息：%ASA-3-317001: No memory available for limit_slow
说明：请求的操作因内存不足而失败。
建议的操作：减少其他系统活动，从而降低内存需求。如果条件得到保证，则升级到更大内存配置。
317002
错误消息：%ASA-3-317002: Bad path index of number for IP_address , number max
说明：发生了软件错误。
建议的操作：如果问题仍然存在，请联系思科TAC。
思科ASA系列系统日志消息
119
系统日志消息302003-342008
317003
317003
错误消息：%ASA-3-317003: IP routing table creation failure - reason
说明：发生了内部软件错误，阻碍了新IP路由表的创建。
建议的操作：按照显示正确复制此消息，并将其报告给思科TAC。
317004
错误消息：%ASA-3-317004: IP routing table limit warning
说明：指定IP路由表中的路由数量已达到配置的警告限制。
建议的操作：减少表中的路由数量，或重新配置限制。
317005
错误消息：%ASA-3-317005: IP routing table limit exceeded - reason , IP_address netmask
说明：更多路由将添加到路由表中。
建议的操作：减少表中的路由数量，或重新配置限制。
317006
错误消息：%ASA-3-317006: Pdb index error pdb , pdb_index , pdb_type
说明：PDB的索引超出范围。
•pdb-协议描述符块，PDB索引错误的描述符
•pdb_index-PDB索引标识符
•pdb_type-PDB索引错误类型
建议的操作：如果问题依然存在，则按照控制台或系统日志中的显示正确复制此错误消息，然后联
系思科TAC，并向代表提供所收集的信息。
317007
错误消息：%ASA-6-317007: Added route_type route dest_address netmask via gateway_address
[distance /metric ] on interface_name route_type
说明：已向路由表添加新路由。
路由协议类型：
C-已连接，S-静态，I-IGRP，R-RIP，M-移动
B–BGP，D–EIGRP，EX-EIGRP外部，O-OSPF
IA-OSPF中间区域，N1-OSPFNSSA外部类型1
N2-OSPFNSSA外部类型2，E1-OSPF外部类型1
思科ASA系列系统日志消息
120
系统日志消息302003-342008
317008
E2-OSPF外部类型2，E–EGP，i-IS-IS，L1-IS-IS级别-1
L2-IS-IS级别2，ia-IS-IS中间区域
•dest_address-此路由的目的网络
•netmask-目的网络的网络掩码
•gateway_address-进入目的网络所使用的网关地址
•distance-此路由的管理距离
•metric-此路由的度量
•Interface_name-用于路由流量的网络接口的名称
建议的操作：无需执行任何操作。
317008
错误消息：%ASA-6-317008: Deleted route_type route dest_address netmask via gateway_address
[distance /metric ] on interface_name route_type
说明：已从路由表删除新路由。
路由协议类型：
C-已连接，S-静态，I-IGRP，R-RIP，M-移动
B–BGP，D–EIGRP，EX-EIGRP外部，O-OSPF
IA-OSPF中间区域，N1-OSPFNSSA外部类型1
N2-OSPFNSSA外部类型2，E1-OSPF外部类型1
E2-OSPF外部类型2，E–EGP，i-IS-IS，L1-IS-IS级别-1
L2-IS-IS级别2，ia-IS-IS中间区域