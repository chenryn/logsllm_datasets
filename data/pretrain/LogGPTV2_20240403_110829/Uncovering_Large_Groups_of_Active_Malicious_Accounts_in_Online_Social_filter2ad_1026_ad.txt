c
c
a
f
o
n
o
i
t
c
a
r
F
 1
 0.8
 0.6
 0.4
 0.2
 0
Page like
Instagram follow
Application install
Login
Photo upload
Others
AOL
*.ru
Gmail
Hotmail
Yahoo
s
s
e
r
d
d
a
P
I
f
o
F
D
C
1 
0.8 
0.6 
0.4 
0.2 
App install
Page like
Login
Instagram follow
Photo upload
0 
0.0.0.0
3
6
2.0.0.0
4.0.0.0
9
1
2
6.0.0.0
IP address
8.0.0.0
1
6
1
9
2
2
0.0.0.0
2.0.0.0
4.0.0.0
Figure 8: Breakdown of top email domains associated to the ma-
licious accounts in each application.
accounts include creating fake accounts with fraudulent user in-
formation [19, 44], compromising user accounts via malware [10],
stealing user credentials by social engineering [17, 25], etc. A
breakdown of the malicious accounts in app installation is shown
in Table 3. In this application, attackers manipulate malicious ac-
counts to promote rogue Facebook apps that can later be used to
send out spam, to steal user personal information, etc. Clearly,
fake accounts, social engineering, and malware are the dominant
malicious account sources, accounting for more than 90% of the
detected accounts.
Fake accounts
28.6%
Social Engineering Malware Others
7.1%
42.9%
21.4%
Table 3: Classiﬁcation of the malicious accounts detected at
Facebook app install.
Network-level characteristics. We study the email domains and
IP addresses used by malicious users to shed light on the network-
level characteristics of attacks.
An OSN account usually associates to a contact email address.
Figure 8 shows the distribution of the email domains of the iden-
tiﬁed accounts in each application. As we can see, the email cre-
dentials used by the controlled accounts are mainly from ﬁve do-
mains, including those major email domains Yahoo, Hotmail, and
Gmail. Email domains with accounts that can be obtained from un-
derground markets (e.g., Yahoo, Hotmail, and AOL) are likely to be
used to provide fraudulent contact email addresses for controlled
accounts. Whereas Gmail accounts incur higher cost to attackers
according to an underground market survey [37], a fraction of the
identiﬁed accounts are found to use Gmail addresses. In addition,
a non-negligible fraction of the contact email addresses are from
the domain *.ru, which is dominated by mail.ru and yandex.ru. Be-
cause the identiﬁed accounts used a diverse set of email addresses,
this result suggests that the email domain alone is not a reliable
criterion to detect malicious accounts.
We further study the source IP addresses of the detected mali-
cious activities. We found that the two million detected accounts
have used ∼1.2 million IP addresses in total. Figure 9 shows the
distribution of the IPv4 addresses used by attackers in each appli-
cation. As can be seen, the threats are initiated from three major
regions of the IPv4 address space: 36.67.* – 44.99.*, 77.246.*–
125.226.*, and 170.226.* – 207.78.*. The distributions of IP ad-
dresses in different applications are close to each other, except that
attackers in app install use more intensively the IP addresses from
the region 77.246.*–125.226.*. We investigate a random sample
set of those IP addresses via queries to WHOIS servers, which pro-
vide the registration information of the domain names. Many IP ad-
Figure 9: Distribution of the IPv4 addresses used for identiﬁed
attack campaigns in each application.
dresses are administrated by large regional ISPs around the world
(e.g., Global Village Telecom in Brazil and Saudi Telecom in Saudi
Arabia). Some of those IP addresses are used to provide shared In-
ternet access (e.g., for network proxies or public Internet access
points). We also observed that a non-trivial fraction of the IP ad-
dresses are from hosting services such as GoDaddy and Singlehop,
as well as from large cloud computing services such as Amazon
AWS. This observation indicates that cloud-based services open up
another avenue for threats to break into the Internet, which is in
contrast to traditional botnet-based attacks [43].
Application
Page like
Instagram follow
App install
Photo upload
Login
Total
Overlap with
New ﬁndings
existing approaches
by SynchroTrap
175K
66K
N/A
N/A
12K
253K
555K
523K
164K
120K
552K
1,914K
Table 4: New ﬁndings of SynchroTrap. It uncovers a signiﬁcant
fraction of malicious accounts that were undetected previously.
SynchroTrap is the ﬁrst dedicated countermeasure in app in-
stall and photo upload at Facebook. So there is no data avail-
able from previous work to compare with.
8.2 New ﬁndings on malicious accounts
To evaluate SynchroTrap’s capability to ﬁnd malicious activities
that were previously undetectable, we compare the malicious ac-
counts detected by SynchroTrap against those detected by existing
approaches inside Facebook. At Facebook, a large set of exist-
ing approaches cope with aggressive attacks by monitoring abrupt
changes in certain types of user activities [35]. In each deployed ap-
plication, the accounts detected by SynchroTrap in August 2013 are
compared to those detected by other approaches during the same
period. Table 4 shows the overlap of the malicious accounts that
SynchroTrap and other approaches identiﬁed, as well as Synchro-
Trap’s new ﬁndings. As we can see, SynchroTrap identiﬁed a large
number of previously unknown malicious accounts. Speciﬁcally,
in each application at least 70% of the identiﬁed accounts were
not discovered by existing approaches. We investigated the exact
number of accounts detected by each existing approach. We can-
not report them due to conﬁdentiality, but SynchroTrap detects a
fairly large portion of those accounts. We believe that full-ﬂedged
deployment of SynchroTrap in each application on more OSN ob-
1 
0.8 
0.6 
0.4 
0.2 
s
t
n
u
o
c
c
a
f
o
F
D
C
0 
0
0.2
App install
Page like
Login
Photo upload
0.8
1
)
K
(
s
r
e
s
u
d
e
t
c
e
t
e
D
400 
300 
200 
100 
0 
0
Page like
Instagram follow
Login
App install
Photo upload
2
4
6
Time (week)
8
10
12
0.4
0.6
Ranking percentile
Figure 10: CDF of the detected accounts with respect to the
ranking percentile generated by SybilRank. The percentiles
are calculated from the bottom of the ranked list.
Figure 11: Number of users detected by SynchroTrap per week
over a course of 11 weeks.
jects (e.g., certain ﬁelds of browser cookies) could yield more new
ﬁndings and achieve higher recall of malicious accounts.
In particular, the large number of previously undiscovered mali-
cious accounts indicates that the loosely synchronized attacks have
been underestimated in existing countermeasures. SynchroTrap
complements existing OSN countermeasures by effectively uncov-
ering such attacks.
8.3 Social connectivity of malicious accounts
Social-graph-based defense mechanisms have attracted much at-
tention from the research community [19, 39, 41, 45, 46]. We exam-
ine the social connectivity of the identiﬁed accounts by comparing
them against the ranked list generated by SybilRank [19]. Sybil-
Rank discerns bulk accounts created at a low per-account cost. It
ranks users based on connectivity in the social graph. Suspicious
users with limited connections to legitimate users are ranked low.
We run SybilRank on a snapshot of the Facebook friendship
graph obtained in August 2013. This social graph contains all Face-
book users that have been perceived as benign by existing counter-
measures [35] until this study. We do not include the users already
stopped by existing countermeasures before the graph snapshot.
Figure 10 shows the CDF of the ranking percentile of the mali-
cious accounts that SynchroTrap detects in each Facebook applica-
tion. As can be seen, a certain fraction of malicious users (∼40%
in login and ∼15% in each of other applications) are ranked at the
bottom. That portion of users are comprised of fake accounts that
have little engagement on the social graph. Whereas SybilRank
gives low rankings to a large portion of the identiﬁed malicious
users (e.g., 80% of the detected users in app install are among the
lowest 25% rankings), a non-negligible fraction of the users appear
in the middle or even the top intervals of the ranked list. This in-
dicates that attackers manipulate accounts with a variety degree of
social connectivity to legitimate users. For example, a part of the
accounts caught in photo upload are ranked high, presumably be-
cause attackers tend to use well-connected accounts to spread spam
photos to many of their friends. As described in § 8.1, these well-
connected accounts can be obtained via malware, social engineer-
ing, etc. The potential inﬂuence on the social graph and the high
cost to get such accounts make them more valuable to attackers.
8.4 Operation experience
We perform a longitudinal study on the number of users caught
by SynchroTrap for the ﬁrst 11 weeks after SynchroTrap’s deploy-
ment (Figure 11). From the beginning, the variation is small in
Facebook login, app install, and photo upload.
In contrast, the
number of detected users decreases after the ﬁrst month in Face-
book page like and Instagram user following. It then stabilizes at
around 100K per week. We suspect that this drop may be caused
s
r
e
s
u
f
o
n
o
i
t
c
a
r
F
0.15 
0.1 
0.05 
0 
2
Page like
App install
Login
Photo upload
Instagram follow
Times of being caught by SynchroTrap
8
10
12
4
6
Figure 12: Distribution of the users repeatedly caught by Syn-
chroTrap. We depict the fraction of detected users with respect
to the number of times they have been repeatedly caught.
by SynchroTrap’s deployment. Either the attackers are not able to
obtain new controlled accounts to launch attacks or they stop the
attacks temporarily to prevent their controlled accounts from being
caught. The stabilized number of detected accounts in each ap-
plication suggests that SynchroTrap continued to effectively detect
malicious accounts over time.
Although most of the detected accounts were being caught for
the ﬁrst time by SynchroTrap, we observed that a non-negligible
fraction of them were repeatedly caught. Figure 12 shows the frac-
tion of these users (who were caught at least twice). As we can see,
in each application 5%∼15% of the detected users are caught twice
by SynchroTrap; the fraction of users caught more than ﬁve times
is less than 1%. Some accounts are caught repeatedly because they
are able to clear the challenges sent to them. When a malicious
account is detected, Facebook’s security system sends challenges
such as CAPTCHAs or SMS to it. Either the attackers or the own-
ers of the compromised accounts could have cleared the challenges
so that the accounts were used to launch new attacks.
8.5 System performance
We evaluate the performance of SynchroTrap on a 200-machine
cluster at Facebook. The daily activity data in each application is
on the order of terabytes. We measure the execution time of each