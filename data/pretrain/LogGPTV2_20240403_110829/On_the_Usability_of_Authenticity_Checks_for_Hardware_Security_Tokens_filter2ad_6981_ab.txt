pre-initialization
side-channels
microprobing
injection
snooping
Timing
Fault
Bus
IC
modiﬁcation
exploit
ware
Token
USB
Firm
Attack Vectors
. Tamper-evident
k
c
a
P
Holographic sticker
e Single-piece cast
r
a
w
d
r
a
H
Openable device
Secure element (co-processor)
Secure CPU
e Local ﬁrmware attestation
r
a
w
Remote ﬁrmware attestation
t
f
o
S
Key attestation
Manual ﬁrmware load
s
i
e Runtime seed or key exﬁlt. (in-band)
m
o
r
p
m
o
c
Delivery-time seed or key extraction
e
r
u
s
a
e
m
r
e
t
n
u
o
C
/
n
o
i
t
a
t
s
e
t
t
A
1
s
o
i
r
a
n
e
c
S
k
c
a
t
t
A
Hardware
Software
Secret Extraction
(cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35)
(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:35)
(cid:71)(cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:71)(cid:35) (cid:32) (cid:32)
(cid:71)(cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:32)
(cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:71)(cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:32) (cid:35) (cid:71)(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:35) (cid:71)(cid:35) (cid:35) (cid:32) (cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35) (cid:71)(cid:35)
–  –  –
–
–
–
–
–
Runtime seed or key exﬁlt. (out-of-band)      –
–
–
–
–
–
–
–
–
–
–    
y
e
K
Seed or key ﬁxation
  –  –  –
Predictable RNG modiﬁcation
    –
–
r USB pivoting
e
h
t
O
Ransom attack
   –  –
  –  –
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
1 For U2F tokens, the attacker needs a second source for retrieving username/password.
Ransom attack: Using hardware implants, token replica-
tion, or ﬁrmware modiﬁcation, the attacker modiﬁes the token
which then stops operating after some time, demanding a ran-
som to resume operation or release the key material. This
attack is especially efﬁcient with hardware wallets which are
in control of the secret key material and the derivation of the
used addresses. Consequently, a fraudulent hardware wallet
can prevent the user from obtaining a trustworthy backup of
the secret material by displaying a wrong recovery seed. Al-
ternatively, it can generate addresses which cannot be derived
from a correct backup [12]. This attack is limitedly feasible
for YubiKeys, as backup keys are usually generated.
5 Market Review of Authenticity Checks
To answer RQ1, we assessed four different models of the U2F
YubiKey and the ﬁve most recent hardware wallets4 from the
three most popular vendors at the time of writing [73].
We chose YubiKeys as representatives of FIDO/U2F-
tokens based on previous research [18, 88] and Yubico’s role
as the current leading U2F-manufacturer (see Section 2.2). To
ensure that YubiKeys are indeed representative of attestation
and packaging methods used in the U2F token industry, we
surveyed other U2F-certiﬁed tokens (e.g., Google Titan [35],
Thetis BLE/FIDO U2F [105], Feitian ePass FIDO [30]) be-
fore the market review. We found that YubiKeys’ methods
are the most comprehensive in the industry (see Appendix,
Table 6).
We examined nine widely used tokens and are therefore
conﬁdent that our results are representative (although not
exhaustive) of authenticity checks deployed in today’s HSTs.
5.1 Methodology
In order to assess which authenticity checks were deployed
and if they were usable, we performed a set of cognitive
walkthroughs [83]. A cognitive walkthrough is a technique
for expert usability inspection of a system and is commonly
applied in user-centered security research [28]. Thereby, an
expert steps through a set of actions while considering the
interface behavior and its effect on the user. For this study,
two usable security researchers walked through the actions a
user has to perform when receiving an HST and initializing it,
including the examination of the packaging. For each of these
actions, we asked: Does the user understand what they are
supposed to do? Does the user know how to do it? After the
action is done, does the user know whether it was successful?
We used the ﬁndings of the cognitive walkthroughs to design
our quantitative survey (see Section 6).
Additionally, we consulted the manufacturers’ documen-
tation to obtain a complete list of the deployed authenticity
checks. We then connected these ﬁndings with the data of
our cognitive walkthroughs and established three categories
for authenticity checks (Inter-rater reliability: Krippendorff’s
4Some hardware wallets offer U2F functionality as an add-on. However,
we focused only on their core functionality.
40    30th USENIX Security Symposium
USENIX Association
α=.91): (i) packaging, (ii) hardware, and (iii) software. In
order to systematically evaluate each authenticity check, we
mapped them to attack vectors (see Section 4.1), thus building
an evaluation framework for comparing the effectiveness of
current and future authenticity checks (see Table 1).
5.2 Results
In this section, we present a comprehensive evaluation of the
usability and effectiveness of currently deployed authenticity
checks. Table 2 shows the investigated devices and their au-
thenticity checks. Table 1 illustrates our evaluation framework
by mapping deployed authenticity checks to attack vectors.
The effectiveness assessment is based on the currently de-
ployed best-case implementation of every method, as found
in the market review. We also discuss deviations from the best-
case scenario, since ﬂawed or inadequate implementations
make every method ineffective.
5.2.1 Packaging
Trezor One and one of the tested YubiKeys were shipped in a
tamper-evident package, meaning that it shows if a package
has been opened. The hardware wallets arrived in cardboard
boxes or shrink-wrap plastic. YubiKey recently switched to
hard shells (i.e., tamper-evident blister packaging), but older
models were delivered in plastic sleeves. A lot of manufactur-
ers additionally provide pictures of the original packaging on
their websites and encourage customers to report and return
damaged shipments. Six of the assessed devices came with
holographic stickers.
Effectiveness: Tamper-evident packages render an attack
slightly more difﬁcult: an attacker would have to re-package
a modiﬁed device in a genuine-looking way. Still, all types
of packaging can be reproduced; paper boxes and standard
plastic sleeves are easy and cheap, whereas reconstructing
tamper-evident plastic wraps is more expensive, since special-
purpose machines are needed. Hence, the latter only pays off if
attacks are carried out on a large scale. Holographic stickers
only provide a low level of protection against distribution
attacks. They can be removed with a common blow dryer [75],
and new ones are easy to come by [45].
Usability: Some packages are destroyed when opened,
making any tampering clearly visible. Also, there are self-
destroying holographic stickers which cannot be easily re-
placed. However, other types of packaging—e.g., simple pa-
per boxes—do not show obvious signs after they have been
opened. Only a few manufacturers provide information on
what the original package and holographic sticker(s) should
look like. Therefore, users often do not have any possibility
to verify if the packaging is the original one.
5.2.2 Hardware (Enclosure)
Manufacturers take two contrary approaches in order to se-
cure the token body. One way is to use a single-piece cast.
Yubico chose this method and encourages users to check the
integrity of tokens through visual inspection. The other way is
Table 2: Device and Feature Overview
. Tamper-evident
–2
–2
–2
S
T
5
4
(cid:32) fulﬁlled/implemented/included
(cid:72)(cid:35) sometimes
(cid:35) not fullﬁlled
– not applicable
? undisclosed
Openable device
Single-piece cast
Holographic sticker
YubiKey
YubiKey
Model
Keepkey
Key
Neo
Nano
Blue
Sec.
One
4
YubiKey
Yubico
Ledger
Ledger
Trezor
Trezor
(cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:32) (cid:72)(cid:35)1 (cid:72)(cid:35)1 (cid:72)(cid:35)1
(cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35) (cid:72)(cid:35)1 (cid:72)(cid:35)1 (cid:72)(cid:35)1
–2 (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:32)
(cid:32) (cid:32) (cid:35) (cid:35) (cid:35) –2
–2
(cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:32) (cid:35) (cid:35) (cid:35)
Secure element (co-processor) (cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32)
(cid:32) (cid:32) (cid:32) (cid:32) (cid:32) ?
(cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
(cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:32) (cid:32) (cid:32) (cid:35)
(cid:35) (cid:35) (cid:32) (cid:32) (cid:35) (cid:35) (cid:35) (cid:35) (cid:35)
Remote ﬁrmware attestation
Local ﬁrmware attestation
Manual ﬁrmware load
Key attestation
?
?
?
Secure CPU
k
c
a
P
e
r
a
w
d
r
a
H
e
r
a
w
t
f
o
S
1 Packaging changed multiple times in recent years.
2 Mutually exclusive.
a token which can easily be opened to compare the inside
to reference pictures on the manufacturer’s website. The
latter was the case for two of the assessed hardware wallets.
Effectiveness: Some single-piece cast devices are easy to
break by using household chemicals [40]. Therefore, the Yu-
biKey 5 series is made with a more chemical-resistant thermo-
plastic. Since the electronics are tightly molded, it is infeasible
for an attacker to add hardware components. Creating token
replicas or modifying ICs of a single-piece cast token requires