早在公元前1900年，一个古埃及书写员就在一个铭文中使用了非标准的象形文字，这是
人类最早的有记录的密码术。在其后的年代中，古代人使用了各种各样的原始的密码术，如把
学母表的顺序顺创过来，进行字每替代，或者用错后一定位置的字母进行替代。当然，加密解
密技术应用最广泛的领域应该是在军事和政治中，在第二次世界大战中，德国人利用编码机器
创建了加密信息。此后，由于AlanTuring和Ultra计划以及其他人的努力，终于对德国人的密
码进行了破解。
二
1943年4月，日本海军最高司令部发出的绝密电波越过太平洋，到达驻南太平洋和日本占
领的中国海港的各日本舰队，各舰队司令接到命令：日本联合舰队总司令长官山本五十六大将，
将于4月18日上午9时45分，由6架零式战斗机保护，乘两架轰炸机飞抵卡西里湾，山本的
全部属员与他同行。这份电报当即被由数学家和组合学家组成的美国海军破译小组破译，通过
海军部长弗兰克·诺克斯之手，马上被送到美国总统罗斯福的案头。于是，美国闪电式战斗机
群在卡西里湾上空将山本的座机截住，座机在离山本的目的地卡西里只有几英里的荆棘丛中爆
炸。从此，日本逐渐丧失了在太平洋战场上的制空权和制海权。
战后，随着网络应用的迅猛发展，与网络安全相关的问题：如对主机的攻击，网络上传输
的信息被截取、墓改等对网络应用进一步推广构成巨大威胁，这一切都直接或者间接地促进了
加密解密技术的发展，在信息社会的今天，加密技术具有十分重要的意义。进入21世纪，当
我们在享受飞速发展的互联网带来的便利时，也面临很多安全方面的问题。作为一个面向大众
的开放系统，互联网对于信息的保密和系统的安全性考虑得并不完备。如何保护计算机信息的
内容，即信息内容的保密问题显得越来越重要。信息安全的技术主要包括监控、扫描、检测、
加密、认证、防攻击、防病毒以及审计等几个方面，其中加密技术是信息安全的核心技术，已
经渗透到大部分安全产品之中，并正向芯片化方向发展。
5.1.2简单有趣的加密方法欣赏
传统的加密方法有代码加密、替换加密、变位加密以及一次性密码薄加密。
1.代码加密
发送秘密消息的最简单方法，就是使用通信双方预先设定的一组代码，它简单面有效，得
220
---
## Page 229
第5章趣解加密与解密
到了广泛的应用。例如，我们经常在特务电影或者侦察电影中看到的暗号：
。
密文：老鼠已经出洞了
明文：汇徒已出现在目标区
2.替换加密
明文中的每个字母或每组字母被替换成另一个或一组字母，例如下面的一组字母之间的对
应关系就构成了一个替换加密器。在很多军事电台截取的信息中，就是要运用类似的方法去破
解敌人的情报：
·明文字母：ABCD…
密文字母：LKJL
3.变位加密
变位加密不隐藏原明文的字符，但却将字符重新排列。例如：
密钥：3145260
明文：火车已安全发出
密文：出车全火已安发
4.一次性密码薄加密
如果要既保持代码加密的可靠性，又保持替换加密器的灵活性，可采用一次性密码薄进行
加密。密码薄的每一页都是不同的代码表，可以用一页上的代码来加密一些词，用后毁掉：再
相问的密码薄。
5.1.3洞悉奥妙：一个最普通的加密系统分析
通过上面的诺多故事和简单例子分析，我们来归纳分析一下加密系统的基本要素。
1.加密系统的构成
加密和解密过程组成为加密系统，明文与密文总称为报文，任何加密系统，不管形式多么
复杂，至少包括以下4个组成部分。
（1）待加密的报文，也称明文。
(2）加密后的报文，也称密文。
(3）加密、解密装置或算法。
（4用于加密和解密的钥匙，它可以是数字、词汇或语句。
加密是在不安全的环境中实现信息安全传输的重要方法。例如，读者要发送一份文件给别
人时，先用密钥将其加密成密文，当对方收到带有密文的信息后，也要用钥匙将密文恢复成明
文。即使说发送的过程中有人窃取了，得到的也是一些无法理解的密文信息。计算机密码学是
研究计算机的加密和解密及变换的科学，尽管其背后的数学理论相当高深，但加密的概念却十
分简单。加密就是把数据和信息转换为不可识别的密文的过程，使不应了解该数据和信息的人
不能够识别，欲知密文的内容，需将其转换为明文，这就是解密过程。
---
## Page 230
网络安全进阶笔记
这两个方面很容易理解，不过，很多人可能会对“密钥”感到有点陌生，下面，我们重点
分析这个安全术语。
2.密钥
在很多间课影片中，我们常可以看到这样的情节，特工将一个密码箱用手铸和自己的手腕
拷在一起。那么，密码箱中放置的是什么呢？多数情况下，这个箱子里面放的不是导弹发射密
码，也不是化学公式，更不是入侵计划，而是用来解密的密钥。那么，密钥是什么呢？它又是
如何生成的呢？
在加密和解密系统中，密钥是一个数值，它和加密算法一起生成特别的密文。密钥本质上
是非常非常大的数。密钥用位（Bit）来衡量，1024位密钥代表的数是非常巨大的，我们可以感觉
到特工携带的那个密码箱的分量。在公开密钥加密方法中，密钥的尺寸越大，密文就越安全。
然面，公钥的尺寸和传统加密方法中密钥的尺寸是不相关的。传统80位密钥的强度等同于1024
位的公钥，传统128位密钥的强度等同于3000位的公钥，在同种加密算法中，密钥越大越安
全，据说，在反恐期间，美国很多机密部门的加密密钥一般都在2048位左右。但是传统方法
和公开密钥方法所用的加密算法不一样，因此它们的密钥尺寸不能直接比较。如打开IE浏览
器“帮助”菜单下的“关于”选项，可以看到关于密钥长度的说明。如图5.1所示。
关于 Intemet Explorer
e
长度：12-
加利事是得，对巴的连段着码结子注建范图内的全强制
豆
新投所有c）_1392001ifC
图5.1IE浏览器中关于密钥长度的说明
长的密钥会在很长一段时间内是安全的。如果想保密许多年，应该选择非常长的密钥。当
然，谁也不知道使用未来速度更快更有效的计算机来测定密钥会花费多长时间。曾经有一段时
间，人们认为56位的对称密钥是非常安全的。现在说来，可能觉得很幼稚。由于公钥和私钥
是算术相关的，仅凭公钥推算出私钥是非常困难的。然而如果有足够的时间和计算能力，总是
可能导出私钥的。这使得选择合适尺寸的密钥变得非常重要。为了安全需要足够大的密钥，为
了速度要有足够小的密钥。而且，要考虑是谁想要读取这个文件，他有多大的决心，多少时间
和多少可以利用的资源。
就像锁门一样，要想加密一封电子邮件，必须使用钥匙，它是将信息内容变成密文的工具。
要解决这样的问题，目前最好的解决方法是使用公开密钥加密系统，即我们经常听说的PKI
222
---
## Page 231
第5章趣解加密与解密
系统，比较知名的招商银行网上支付系统就使用了这种技术。
5.1.4一个有关加密技术的浪漫故事
在所有浪漫的爱情故事中，都少不了浪漫的情书做铺垫，电脑王子和灰姑娘也不例外。某
个周三的下午，电脑王子总是听到灰姑娘的抱怨：“明明没有进自己的邮箱，邮件却好像被人
浏览过了！”灰姑娘自从到这里开始上班以后，接触的人也不少，当然，追求她的人也就更多
了。谁知道这追求她的人中间没有一个黑客呢？“先下手为强！”想到这里，电脑王子赶紧走
到灰姑娘旁边，今天，他们的话题自然少不了电子部件。
1.邮件基础的安全问题
电脑王子讲了讲电子邮件的一些基础知识。传统的电子邮件基于文本格式，对于非文本格
式的二进制数据，比如大量多媒体数据，如图形、音频、视频数据，首先需要通过一些编码程
序，将这些二进制数据转换为文本格式，然后夹带在电子邮件的正文部分。灰姑娘点了点头，
“这个我知道，你给我讲讲安全方面的基本原理吧！”
电脑王子动了动鼠标，打开了OutlookExpress.在Intemet上，一般采用“类型/编码”格
式的多目的互联网络邮件扩展(Multipurpose IntermetMailExtensions，MIME）标准来标识和编码
多媒体数据。这些数据包如果在传送中途被截获，攻击者按一定顺序就可以重新组装还原成为
你发送的原始文件。由于电子邮件的发送是要通过不同的路由器进行转发的，直到到达电子邮
件目的主机，攻击者完全可以在电子邮件数据包经过这些路由器的时候把它们截取下来面不被
我们发现。从技术上看，没有任何方法能够阻止攻击者截取电子邮件数据包，因为你不能确定
你的邮件将会经过哪些路由器，更不能确定你的邮件在经过这些路由器的时候，是否会有人把
它截获下来。也就是说，没有任何办法可以阻止攻击者截获需要在网络上传输的数据包。灰姑
娘一脸失望的表情，“那我们只有任人宰割的份了吗？”
“当然不是！”电脑王子回答的语气有些坚决。现在，比较可行的办法就是让攻击者截获
数据包后无法组装还原成原始文件，面我们所采用的手段自然就是加密了。你想想，如果我们
以一定的特别方式来加密我们的邮件，只有拥有密钥才能够阅读，这样对于攻击者，得到的只
的，怎么加密呀！我呀，一听到加密就头疼不已！”
电脑王子笑了笑，“放心吧！我观察了一下市面上流行的各类加密方法，对电子邮件的加
密主要有两种方式：一类是通过专门机构发放的数字证书对邮件进行加密：另一类是通过专门
的加密软件对发送邮件进行加密。本来准备给你用一个大型软件讲讲的，但为了你工作方便，
现在我就给你一个惊喜！向你介绍一款比较小巧的邮件加密软件A-Lock，别看它小啊，邮件
快点把这个软件给我吧！”
电脑王子打开http:/www.pc-encrypt.com/_site/alock/download.mhtml，下载了一个软件。他
边下载边说：“A-Lock的加密原理说起来其实很简单，它是利用加密的方式将邮件的文字重
新编码，处理后的文字都变成了我们常见的乱码。面要阅读这些文字的时候，只要输入加密前
设定的密码，A-Lock便可以进行解密操作，恢复邮件的本来面目，非常适合像你们这些在办
22k
---
## Page 232
网络安全进阶笔记
公室里的小妹妹。”
2.给“情书”加密
下面，就是电脑王子的操作步骤。
（1）打开Oulook、Foxmail等电子邮件编辑工具，撰写新的邮件。然后选中需要加密的内
容，将其剪切到剪贴板。单击托盘区的A-Lock图标，在出现的菜单中选择“Encrypt
Decrypt(Auto)（加密/解密)”项。弹出A-Lock-Password Required对话框，要求输入加密密码，
如图5.2所示。需要说明的是，口令保护非常重要，如果自己忘记了密码，那么谁都无法将加
密内容恢复！
 A-lodk Pase
dReqared
厂Hie
图5.2A-Lock的输入密码界面
(2）设置密码薄。可以直接输入密码，也可以通过PasswordBook（密码薄）来管理密码。如
果担心丢失密码，还可以单击New新建）按钮，给自己添加一个密码，单击MakeDefaultOn/off
（是否设置为默认）按钮则可以设置为默认的密码，如图5.3所示。
MPawedok(Pordn）
Seect theimlonthelet beowwhich
djoumrtloae
Dse
EaMiew.
MokeDeau On/O
Nm..
Deete
SerLacson
图5.3设置密码薄
（3）选中密码后，完成选定文字的加密。
此时，你可以看到刚才选定的文本已经变成一堆乱码了，只在信件抬头与结尾处有
及>的提示性文字，表示加密成功。
如图5.4所示。
224
---
## Page 233
与S
S
UK_beenrJate
图5.4发送加密邮件
（4）输入收件人和主题，现在就可以将信件发送出去了。即使邮件在中途被截取或者偷阅，
没有密码是看不到邮件的真实内容的，所得到的仍然是一堆“没有用”的乱码。
操作到这里，灰姑娘也越来越感到自信了，“除了写信，我可以直接在其他编辑器里面加