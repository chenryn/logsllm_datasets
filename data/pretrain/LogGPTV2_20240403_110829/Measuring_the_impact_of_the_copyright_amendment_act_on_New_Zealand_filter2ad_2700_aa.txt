title:Measuring the impact of the copyright amendment act on New Zealand
residential DSL users
author:Shane Alcock and
Richard Nelson
Measuring the Impact of the Copyright Amendment Act on
New Zealand Residential DSL Users
Shane Alcock
University of Waikato
Hamilton, New Zealand
PI:EMAIL
Richard Nelson
University of Waikato
Hamilton, New Zealand
PI:EMAIL
ABSTRACT
The Copyright (Infringing File Sharing) Amendment Act
2011 (CAA) is a New Zealand law that aims to provide
copyright holders with legal recourse when content is ille-
gally shared over the Internet. This paper presents a study
of residential DSL user behaviour using packet traces cap-
tured at a New Zealand ISP before, shortly after and several
months after the CAA coming into eﬀect. We use libpro-
toident to classify the observed traﬃc based on the applica-
tion protocol being used to identify and examine any changes
in traﬃc patterns that may be a result of the new law. We
ﬁnd that the use of peer-to-peer applications declined sig-
niﬁcantly once the CAA was in eﬀect, suggesting a strong
correlation. We also found that there were increases in tun-
neling, secure ﬁle transfer and remote access traﬃc amongst
a small segment of the user population, which may indicate
an increased uptake in the use of foreign seedboxes to bypass
the jurisdiction of the CAA.
Categories and Subject Descriptors
C.2.3 [Computer-Communication Networks]: Network
Operations
Keywords
P2P, seedbox, traﬃc classiﬁcation, residential DSL, Internet
law
1.
INTRODUCTION
The use of Internet ﬁle sharing technologies for copyright
infringement has received signiﬁcant attention from lawmak-
ers in many countries. France, South Korea and the United
Kingdom were among the ﬁrst to enact legislation allowing
for a graduated response to copyright infringement on the
Internet. These countries employ a “three-strikes” approach
where the oﬀender receives warnings for the ﬁrst and sec-
ond infringements but may have their Internet connection
terminated if infringing continues.
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’12, November 14–16, 2012, Boston, Massachusetts, USA.
Copyright 2012 ACM 978-1-4503-1705-4/12/11 ...$15.00.
On the ﬁrst of September 2011, New Zealand joined these
countries with the Copyright (Infringing File Sharing) Amend-
ment Act [15] (which we shall henceforth refer to as the
CAA). The CAA implements a graduated response system
whereby copyright owners can advise the user’s ISP when
they believe a subscriber has breached copyright. The copy-
right holder must pay a NZ $25 processing fee (approxi-
mately $20 US) to the ISP and the ISP in turn must then
issue an infringement notice to the suspected party. After
three infringements, the subscriber can be taken to the New
Zealand Copyright Tribunal by the copyright holder where
the subscriber can be ﬁned up to NZ$15,000. The law also
has a (currently inactive) provision for the termination of
an oﬀending subscriber’s Internet connection.
The CAA received widespread media coverage both inside
and outside of New Zealand and the vast majority of New
Zealand Internet users will have been aware of the new law
by the time it came into eﬀect. However, media reports
diﬀered as to whether the law was having any impact on
user behaviour, i.e. whether users had ceased ﬁle sharing.
One major New Zealand ISP reported a 10% decrease in
peer-to-peer (P2P) traﬃc, another stated that international
traﬃc had declined but was unable to determine whether
this was related to ﬁle sharing while a third claimed there
had been no discernible impact on traﬃc volumes [18]. None
of the three ISPs provided any detail as to the measurement
approach used to reach the publicised conclusions.
Therefore, we have conducted an investigation into the
application protocols used by residential DSL users in New
Zealand, both prior and subsequent to the CAA coming into
force, to analyse the eﬀect of the CAA on the behaviour of
Internet users. We have analysed packet traces captured
from a single New Zealand ISP using libprotoident [19], a
traﬃc classiﬁcation library and compared the popularity of
diﬀerent applications (e.g., P2P, web, mail) both before and
after the CAA came into eﬀect.
Unlike earlier studies that have looked at the impact of
similar laws in other countries, such as [9] and [10], our study
is based on measurements of the traﬃc sent and received by
a cross-section of Internet users. Using this approach, we
can easily and eﬀectively analyse the behaviour of a large
group of Internet users in an objective fashion.
Our results show that P2P traﬃc had more than halved
by the time the CAA became an active law, suggesting that
there may be a strong correlation between anti-ﬁle-sharing
legislation and the use of P2P applications. Traﬃc volumes
also declined notably for newsgroups and encrypted trans-
fers. By contrast, we observed that protocols which can be
551used as secure or private mechanisms for direct ﬁle trans-
fers had become much more popular than they were prior
to September 2011. These results suggest that, while the
CAA may have had the intended eﬀect of discouraging New
Zealanders from partaking in P2P ﬁle sharing, some users
have simply changed their approach to acquiring copyrighted
material to avoid detection by rights-holders.
It should be noted that, due to the diﬃculties in obtain-
ing suitable packet traces, this study has examined only a
small portion of New Zealand Internet traﬃc and therefore
we cannot irrefutably prove that the decline in P2P traﬃc
has been caused by the new law. There are other possible
reasons for the changes that we observed that cannot be
ruled out with the data that we have: for example, a global
trend in declining P2P traﬃc [12]. Therefore, the results of
this study should be seen as an observation of a strong cor-
relation that we believe is both interesting to the Internet
research community and deserving of more detailed analysis
in the future.
2. RELATED WORK
Other studies have examined the impact of laws similar to
the CAA enacted in other countries. Dejean [10] surveyed a
group of Internet users in Brittany following the enactment
of the HADOPI law in France. They found that 25% of users
had altered their downloading habits but less than 15% had
ceased using peer-to-peer ﬁle sharing entirely. Many of those
that had stopped using peer-to-peer had moved to alterna-
tive forms of ﬁle sharing, such as illegal streaming. Danaher
[9] attempted to correlate the introduction of HADOPI with
changes in online sales statistics for music. This study also
suggested that HADOPI had a measurable impact, as song
and album sales had increased signiﬁcantly compared with
other countries without similar legal ramiﬁcations for down-
loading copyrighted material.
Unlike the aforementioned research, we use Internet traﬃc
classiﬁcation techniques to conduct our study. Traﬃc clas-
siﬁcation has been a popular area of research over the past
decade, especially with regard to identifying and analysing
peer-to-peer traﬃc. The current state of the ﬁeld has been
well documented by several summary papers [7] [8] [16]. We
used the libprotoident library [19] to classify the measured
traﬃc for our study. Libprotoident is a lightweight payload
inspection tool which uses only a small amount of appli-
cation payload to identify the application protocol. This
approach is similar to that used by Aceto et al.
[3] with
the PortLoad software but, unlike libprotoident, PortLoad
is not publicly available nor has it been used to conduct any
studies similar to this one.
With regard to identifying and measuring peer-to-peer
traﬃc, Per´enyi [17] proposed a set of heuristics for iden-
tifying P2P traﬃc from NetFlow records. This technique
was used to analyse the characteristics of P2P traﬃc ob-
served at a Hungarian ISP, although they were only able to
identify individual applications in cases where the default
port was used. Another example is Hu [11] which devel-
oped behavioural proﬁles which could identify BitTorrent
and PPLive traﬃc with high accuracy. There have also
been studies using statistical and machine learning tech-
niques to identify Internet applications [6] [13] [14]. These
oﬀer promising results but do not oﬀer enough conﬁrmed re-
liability for the analysis we intended to conduct, particularly
with regard to identifying P2P traﬃc.
Start Date
Duration
Incoming Bytes
Outgoing Bytes
Active Subscribers
Jan
2011
06 Jan
7 days
Sept
2011
12 Sept
8 days
Jan
2012
16 Jan
8 days
5,159 GB 5,079 GB 5,459 GB
896 GB
4135
919 GB
4928
790 GB
4333
Table 1: The trace sets used in this study. Incom-
ing and outgoing bytes refer to the DSL network
only. Active subscribers refers to unique IP ad-
dresses owned by the ISP that transmitted at least
one packet.
3. METHODOLOGY
3.1 Data Sources
Packet traces that were captured using a passive monitor
placed within the core network of a New Zealand ISP were
used for this study. Although not large by New Zealand
standards, the ISP oﬀers DSL plans that are comparable in
price, speed and data allowance with most competing ISPs
in the New Zealand broadband market. The ISP operates
on a nationwide basis and attracts customers from through-
out the country, so we believe that the data set should be
suﬃciently representative for the purposes of our study.
The monitor was able to capture all bidirectional traﬃc for
a subset of the ISP customer base. Each trace set was cap-
tured using an Endace DAG 4.3GE hardware capture card
[2] and was entirely contiguous; all packets passing through
the passive monitor between the start and end of the cap-
ture were written to disk. The trace sets are described in
more detail in Table 1.
The timing of the captures was important for this study.
The traces cover three distinct time periods: one week in
January 2011, eight days in September 2011 and eight days
in January 2012. The CAA came into eﬀect on September
1, 2011. The January 2011 capture will therefore provide a
suitable indication of user behaviour before the subscribers
became conscious of the CAA. The September 2011 capture
will demonstrate what, if any, immediate impact the new
law may have had on user behaviour. Finally, the January
2012 capture will enable us to look at the possible eﬀects
of the CAA in the medium term and compare the traﬃc
pattern with a similar time period from the previous year 1.
During the capture process, each packet was truncated to
only contain the headers up to and including the transport
header, i.e. the TCP or UDP header, plus an additional four
bytes of application payload. The extra payload (captured
with the permission of the ISP) allowed us to use libpro-
toident to classify the traﬃc, while minimising the potential
impact on the privacy of the network users.
When performing the analysis, we used IP ranges provided
by the technicians at the ISP to ﬁlter the captured traﬃc
to only include traﬃc involving residential DSL subscribers.
We chose to focus on residential DSL only as this user type
was the principal intended target of the CAA. However, we
will consider examining the eﬀect of the CAA on other user
classes, e.g. corporate Ethernet, in future work.
1Being diﬀerent months, January and September may have
had diﬀerent traﬃc patterns for non-legislative reasons.
552Category
Chat
Encryption
Files
Gaming
Mail
NAT Traversal
News
P2P
Example Protocols
IRC, MSN, XMPP, Yahoo
Unclassiﬁed SSL/TLS
FTP, Rsync, SMB, Orbit
Steam, Gamespy, XboxLive, WoW
SMTP, POP3, IMAP, IMAPS
STUN
NNTP
BitTorrent, Gnutella, EMule
Pando, Manolito
P2P Structure BitTorrent UDP, Gnutella UDP
P2P TV
Remote
Services
Streaming
Tunneling
VOIP
Web
Emule UDP, Pando UDP
PPStream, PPLive
SSH, RDP, Teamviewer
DNS, NTP
RTMP, RTSP, Flash, Realplayer
TOR, OpenVPN, Teredo, ESP
Skype, SIP, RTP, Teamspeak
HTTP (incl. YouTube), HTTPS
Table 2: Categories supported by Libprotoident.
3.2 Analysis
We developed a program to read and analyse the packet
traces using libtrace [4] and libprotoident [19]. Libtrace is
a trace processing library that supports multiple capture
formats and is required by libprotoident. Libprotoident is
a traﬃc classiﬁcation library that attempts to identify the
application protocol being used by each ﬂow observed in a
packet trace using a technique known as lightweight packet
inspection. Unlike deep packet inspection software, libpro-
toident only requires four bytes of application payload to
be present in each captured packet. The version of libpro-
toident that we used, 2.0.5, supported over 200 unique ap-
plication protocols including twelve P2P protocols and has
been shown to achieve better accuracy than existing open-
source deep packet inspection software [5].
The analysis program examined each ﬂow that started
and ended within the period covered by each trace set and
reported the number of bytes downloaded, byte uploaded
and active subscribers observed for each application proto-
col. Because the three data sets have diﬀerent durations, the
analysis and comparison of traﬃc volumes has been based
on the mean amount of traﬃc observed per day rather than
the total amount of traﬃc observed.
Each application protocol supported by libprotoident was
also assigned to a category which described the purpose of
the protocol, such as Web, P2P or Mail. The categories
that were most prominent in our data sets are described in
Table 2. In this paper, we present some results at the cate-
gory level, as this can provide a clearer view of general user
behaviour than examining popular individual applications.
One useful feature of our data set is that, unlike some
DSL providers, the ISP that we have monitored assigned
static IP addresses to DSL subscribers. We use the term
subscriber to refer to a single premise that is being provided
with broadband by the ISP. There may be multiple users
associated with a single subscription; for example, residents
of the same house who are sharing a broadband connection.
We have assumed that a local IP address in a given trace set
always corresponded to the same subscriber for the duration
of the capture. This allowed us to investigate the number of
1
1
0
2
n
a
J
m
o
r
f
e
g
n
a
h
C
%
 400
 300
 200
 100
 0
-100
A
ll
W
P
P
U
S
G
V
E
M
N
N
T
F
R
e
b
2
2
P
P
n
k
O
n
I
P
c
r
y
a
il
e
A
w
T
u
n
s
_
tr
e
a
m
n
a
o
m
i
n
w
n
i
n
g
g
_
S
tr
u
c
t
u
r
e
p
ti
o
n
il
e
e
s
m
o
t
e
n
e
T
r
a
lli
n
v
g
e
r
s
a
l
Sep 2011
Jan 2012
Figure 1: Bytes downloaded by residential DSL sub-
scribers relative to the value observed in January
2011, broken down by application category.
1
1
0
2
n
a
J
m
o
r
f
e
g
n
a
h
C
%
 300
 250
 200
 150
 100
 50
 0
-50
-100
A
ll
H
B
B
R
H
S
S
S
N
G
S
F
P
T
S
S
E
T
T
S
N
n
T
T