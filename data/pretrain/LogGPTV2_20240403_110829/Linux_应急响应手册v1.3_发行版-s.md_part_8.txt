games
ftp
nobody
systend-network
dbus
polkitd
sssd
1ibstoragemgnt
paoto
rpc
abrt
setroubleshoot
rtkit
chrony
ntp
gluster
unbound
tss
usbmuxd
---
## Page 65
geocLue
pulse
gcm
saned
rpcuser
nfsnobody
gnome-initial-setup
sshd
avahi
postfix
tepdunp
0x05特权账户
awk =F: ‘$3==0 (print $1)'/etc/passwd
[ubuntu server 16.04 64位】默认情况
helper@ubuntu-64bit:~$awk-F:'$3-=0{print S1}’/etc/passwd
root
helper@ubuntu-64bit:~s
【Centos764位】默认情况
[helperecentos-7~]$awk -F:‘$3= {print $1}/etc/passwd
root
[helperecentos-7~]$
0x06登录信息
·w显示当前登录系统的用户信息
·who显示系统中有哪些登录用户
·last-awF显示所有登录信息
users当前登录的账户
·lastlog显示所有用户最后一次的登录信息
参考 https://www.jionshu.com/p/05926453654c
0x07特殊权限文件
·SUID
0find/-perm/4000
·GUID
ofind / =perm /2000
·SUID或者GUID
0009/ wxad=/ puT3o
[ubuntu server 16.04 64位】默认情况
---
## Page 66
ind:
/proc/2954e/task/2954@/fd/6': No such file or directory
find:
/proc/2954e/task/2954e/fdinfo/6°:No such f1e or directory
pu1:
/proc/2954B/fd/5°:No
Such file or directory
ind:
*/proc/2954a/fdinfa/5': No such file or directory
bin/ping
bin/fusermount
bin/ping
ns/u10
/usr/1tb/openssh/ssh-keysign
usr/lib/x86_64-1inux-gru/lxc/1xc-user-ntc
/usr/1tb/eject/dncrypt-get -dev1ce
usr/Ltb/snepd/snop-confine
/usr/ib/policykit1/polkit-genthper
/sr/ib/dbs-1.e/dbus-doeron-1ounch-he1per
/usr/bin/ngL.nsp
usr/btn/chfn
usr/bin/at
/usr/bin/nesutdmop
pussod/u1q/usny
/usr/bin/chsh
/usr/bin/gpesswd
/vsr/bin/sudo
usr/bin/nengrp
usr/btn/pkexec
elpereubuntu-64bit:-3
reil
/grek/3eas/tesk/soes/fd/s": No sach file or eirectory
ind:
ind:
/3eal/fdinfo/S:Nowch fle or directory
Oat/f:osuefiteordtrectory
pin/por_estrsusrrs.chkped
D01/
ma1/tos77d13c7d5F293r8sb222te5634(4
//ser/g/d
ar/Locsl/shore/sgal/declarat1on
nir/Local/shure/sgnl/eis
nir/locat/s
nr/locsL/shore/aL/mi sc
r/Local/ihare/anl
vterplerh
r/ain/et
lecote
u-44bit:-
---
## Page 67
ind:
/erec/12e7/task/12er/fd/6:No sucsflle or directer
oc/1287/task/12e7/fdinfe/5:No suh file er Girectery
1297/505'
sts/pon.extrousers.chkped
stur/untk_chkpwd
n/fusermsunt
r/pirgt
rnol/Ea877d13c745F293F8sF5222588634ct
s14/af/aungs/1930l/zsn
/hcra/sgnt/dt4
isr/(ocel/shere/sgrt/decierst.ion
cntities
s/ssh-keysign
/usr/1ib/s6_(4-1inux-gna//terpter/uteroter
/lx-sar-ni
/usr/lib/eject/dmcrypt-get-device
/usr/Lib/policykit-1/polkit-agent-helper-1
/usr/Lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/chfn
/usr/bin/crontab
/usr/bin/newgi.dnop
/usr/bin/at
/usr/bin/newui.dnap
/usr/bin/passnd
/usr/bin/screen
/usr/bin/chsh
/usr/bin/gpasswd
/usr/bin/choge
/usr/bin/wall
/usr/bin/expiry
/usr/bin/sudo
/usr/bin/ssh-agent
du/uq/Jsn/
/usr/bin/pkexec
/usr/bin/bsd-write
/usr/bin/mlocate
helperéubuntu-64bit:~s
【Centos764位】默认情况
---
## Page 68
/proc/4793/task/4793/Fd/5：交有孔个文件目录
fird
Find
ind:
/c/4793/tosk/4793/Fdfo/5：开期个文件证目
find
ind
ro/479//%：有那个文牛日录
proc/4793/fdsnfo/6:
0个文线日
Fied
n/user//gfs
不
sr/bin/torg
onta
sr/bin/posswd
osr/bin
dr/oi/s
/sudo
isp/sin/unount
usr/11beec/sicegtk8564/sstcecl1etg11bsbocheper
ip/Libesec/dbus-1/dbut
Vr/i//_chd
/sssd/krb5_dhild
usr/1 ilbesec/sssd/prony,chile
sr/libesec/sssd/selinx_chi1d
ar/lib
usr/sbin/nount.efs
sr/sbin/unLx_chkpwd
omp_check
isr/sbin/userhelper
0%7-35
[helpercentos-7 -]$ sudo find / -perm/2800
find:
/proc/485a/task/4858/fd/5：没有期个文件目录
find:
/proc/485e/tosk/485e/fdinfo/5：没有别个文作目录
find:
/proc/4858/fd/6°：设有那个文件或目录
FEnd:
/proc/4858/fdinfo/6：没有那个文件或目录
find:
/run/user/1eee/gvfs：权限不够
/run/log/journol/73c9d059d4bo8941a5be94c15086ftb
/run/Log/journal
/usr/bin/cgclassify
usr/bin/cgexec
usr/bin/locate
/usr/bin/ssh-ogent
110/u1q/5n/
/usr/Lib64/vte-2.91/gnome-pty-helper
usr/bin/write
/usr/libexec/openssh/ssh-keysign
/usr/1ibexec/dbet-action-instal1debuginfotodbrtcoche
/usr/libexec/utempter/utempter
/usr/sbin/netreport
/usr/sbin/pestdrop
/usr/sbin/lockdev
/usr/sbin/postqueue
[helperecentos-7 ~]s
---
## Page 69
1/polast-ogent-halper-
0x08动态链接库劫持
● LD_PRELOAD
0echo $LD_PRELOAD
●/etc/ld.so.conf
● LD_LIBRARY_PATH
0echo SLD_LIBRARY_PATH
●/etc/ld.so.preload
[ubuntu server 16.04 64位】默认情况
helpereubuntu-4bit:~S echo SLD_RELOAD
helpereubuntu-64bit:~5 cot /etc/ld.so.conf
Enclude /etc/Ld.so.conf .d/*,conf
libc defoult configuration
helperlubuntu-64bit:$ cat /etc/Ld.so.conf.d/
/usr/local/1ib
Multiorch support
/1.1b/x86_64-11nux-gnu
helperlubuntu-64bit:5 echo SLO_LIERARY_PATH
/usr/lib/x86_64-1inux-gnu
helperfubuntu-64bit:$
---
## Page 70
helper@ubuntu-64bit:~scat/etc/ld.so.preload
cat:/etc/ld.so.preload:No such file or directory
helper@ubuntu-64bit:~$
【Centos764位】默认情况
[helpenecentos-7 ]$ echo $LD_pRELOAD
[helper@centos-7 ~]$ cat /etc/ld.so.conf
include ld.so.conf.d/*.conf
/usr/1ib64//bind9-export/
[helperecentos-7 ~]$ cat /etc/ld.so.conf.d/*
/usr/lib64/dyninst
/usr/1ib64/nysql
[helpen@centos-7 J$ echo SLD_LIBRARY_PATH
[helperecentos-7~]s
cat:/etc/Ld.so.preload：没有那个文件或目录
[helper@centos-7~]$
具体可以参考
https://mp.weixin.qq.com/s/7mOeZ6DkSAFqzibN82qcMg
https://mp.weixin.qq.com/s/InMQaKOwns2mEIp5yF8dDw
0x09BASH内置命令
 bash
在bash中输入一个命令，如果有多个同名指令，bosh需要按照一定规则去取优先级高的一个执行，bash命令的搜索顺序为：
1、别名，使用alias创建的命令
2、关键字，如if，for
3、函数
4、内置命令，如cd，pwd等
5、外部命令，在PATH路径中寻找
详细可 以参考 https://www.cnblogs.com/zhiminyu/p/14388997.html
根据bash的命令解析顺序，很多内置命令在系统中也有相关的文件，但是不出意外，这翠子不会得到执行，所以这帮文件
就很适合作为后门文件，比较隐蔽
在Centos上很多内置命令是有同名文件的，在/usr/bin/目录下边，在Ubuntu中没有同名文件。这些文件的内容基本就
是执行bash内置命令
·查看内置命令
。compgen-b//不包含使用方法，仅仅列出来命令有哪些
---
## Page 71
[helper@centos-linux--live-dvd-~]s compgen-b
C
alias
bg
bind
break
口
help
//列出命令并给出使用方法
这量
LAU
dash
shell我今是丙部宜义的，请输人“help”以保取
4.2.46（2）-re1eoe
CaB6_64
一个到表
人
infobosh泉使得天手shell的更亲一粒性信
help 出
以得到有天函款名样的更多信息
使用
2用
名标免团的是心（）意味看该命令禁用
3h1pec[]
5[4[-][2-]
《（表达式））
文件名[多题]
if地：then地：elif ：then：]
111[-5声明-n信端|-信光声
[表达式3]
[ocol[option]者格[].
ubuntu 16.04 和 Centos 7默认内置命令是一样的，如下：
alias
bg
bind
break
builtin
caller
cd
command
complete
compopt
continue
declare
dirs
disovn
echo
enable
eval
exec
exit
export
false
fc
fg
getopts
hash
help
---
## Page 72
jobs
kill
let
loca1
logout
mapfile
popd
printf
pushd
pvd
read
readarray
readonly
return
set
shift
shopt
source
suspend
test
times
trap
true
type
typeset
ulimit
unask
unalias
unset
wait
·寻找内置命令同名文件
compgen =b | grep =v =E *\.|\:* |while read line;do 1s /usr/bin/$line 2>null ; done
ubuntu16.04上存在的相关文件
/usr/bin/[
/usr/bin/printf
/usr/bin/test
Centos7上存在的相关文件
/usr/bin/[
/usr/bin/alias
/usr/bin/bg
/usr/bin/cd
/usr/bin/com
/usr/bin/echo
/usr/bin/false
/usr/bin/fc
---
## Page 73
/usr/bin/getopts
/usr/bin/jobs
/usr/bin/ki11
/usr/bin/printf
/usr/bin/pud
/usr/bin/read
/usr/bin/test
/usr/bin/true
/usr/bin/umask
/usr/bin/unalias
/usr/bin/wait
·内置命令对应文件内容
以cd 命令为例，Centos 7中 /usr/bin/cd 内容如下：
[helper@centos-linux--live-dvd-~]scat/usr/bin/cd
#!/bin/sh
builtin cd"s@”
[helper@centos-linux--live-dvd-~]s
这里存在一个问题，有一部分文件（如/usr/bin/test等）不是像上面的脚本文件，而且随着系统版本的不同，bash版本的不
同而不同，所以这里先讨论脚本文件，二进制文件以后我再想办法，命令如下：
compgen =b | grep =v =E *\.|\:"| while read line;do result=$(1s /usr/bin/$line 2>null &&
echo /usr/bin/$line && cat /usr/bin/$line; fi ; done
ubuntu16.04内置命令对应文件内容（脚本文件）
helper@localhost:~Scompgen-b|grep -v-E"\./:1while read line;do result=s（1s/usr/bin/sli
--"8&echo /usr/bin/Sline 8&cat/usr/bin/Sline;fi：done
helper@localhost:~s
ubuntu上没有脚本类同名文件
Centos7内置命令对应文件内容（脚本文件）
---
## Page 74
Centos7默认是存在以下几个同名的脚本文件
/usr/bin/alias
/usr/bin/bg
/usr/bin/cd
/usr/bin/com
/usr/bin/fc
/usr/bin/fg
/usr/bin/getopts
/usr/bin/jobs
/usr/bin/read
/usr/bin/umask
/usr/bin/unalias
/usr/bin/vait
为了方便大家比对，将文件内容粘贴出
/usr/bin/alias
*1/bin/sh
builtin alias "$@*
/usr/bin/bg
!/bin/sh
builtin bg "$@"
/usr/bin/cd
*!/bin/sh
builtin cd "$@"
/usr/bin/command
*1/bin/sh
builtin comm
BS.
---
## Page 75
/usr/bin/fc
*1/bin/sh
builtin fc "$@"
/usr/bin/fg
1/bin/sh
builtin fg "$@"
/usr/bin/getopts
#!/bin/sh
builtin getopts *$@"
/usr/bin/jobs
#!/bin/sh
builtin jobs *$8*
/usr/bin/read
#!/bin/sh
builtin read *$8"
/usr/bin/umask
*!/bin/sh
builtin umask "$@*
/usr/bin/unalias
#!/bin/sh
builtin unalias *$e"
/usr/bin/vait