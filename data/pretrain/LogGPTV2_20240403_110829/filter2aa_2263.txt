And Point of Sale Systems
HACKING HOTEL KEYS
Security Consultant
TWITTER, LinkedIN @westonhecker
Rapid7 www.rapid7.com
 Senior Security Engineer/Senior Pentester/ Security 
Researcher.
 About 11 years pen-testing, Security Research, Speaker at
Defcon 22, 23 and 24 Las Vegas, HOPE 11, 
TakedownCON 2016,B-sides Boston, Blackhat 2016, 
Enterprise Connect 2016, ISC2, SC Congress Toronto.
 12 years programming and Reverse Engineering.
 Side projects Department of Home Land Security. 
Attacking 911 centers / Malware Analysis Ransomware. 
Hacking ATM’s, Cars, Point of Sale Systems, Hotel Key 
Systems - Property Management Software.
“A Little Bit About Myself”
 Explain magstrip readers Magspoofer. 
Difference from RFID
 Explain Modification to device.
 Hotel back ends explained, POS systems 
Explained
 Process of key checkout check in. Different 
parts of hotels.
 Attacks on Privileged Keys. Maids, Service , 
Fireman
 Encryption is just encoded.
What Is This Talk About?
 What lead to research on POS from hotel keys.
 How Do POS systems use magstripe readers.
 Trigger events and when the Reader listening and what 
is it listening for.
 Management cards on POS/card readers on the screen.
 How is a magstripe reader Used as a HID keyboard?.
 Injecting 102-US and proprietary keyboard layouts into 
binary data.
 Cash tend/Check tend attack. 
 Attacking OS SQL injection CMD Drive by attack
 Restaurant attacks/other mag readers/Rewards 
programs and players cards on slot machines
What Is This Talk About?
• What is Magspoofer
Thanks to Samy Kamkar for his work.
How does a Magstipe
Reader work
• Explanation of Magspoofer+ and 
EM fields and how they interact w
ith Heads on magnetic head read
er this is not RFID Cards!!!.
How magspoofer works what is SMT
How To Handle Over Heating
100s of Cards = Heat
Explanation of PMS
Explanation of proprietary card 
readers and security behind hotel 
keys.
Collecting information from keys and 
reissued keys.
Interactions with different readers your door vs 
elevator external access and pool access.
Privileged cards Management, Maids, 
Service, Fireman law enforcement.
Examples of card Dumps Raw data fr
om track 3 other tracks restaurant an
d Resort functions. 
There are limitations on characters
you can enter 
Breaking the complex encryption of hotel 
keys... o it’s simple encoding never mind. 
Checking into your own hotel room 
KIOSK research.
• What lead to this research after 
• hotel keys?
Point of Sale Systems
How do POS systems use magstripe
readers?
Trigger events and when the Reader 
listening and what is it listening for.
• Management cards on 
• POS/card readers on the screen.
How is a magstripe reader Used as a 
HID keyboard?
Injecting 102-US and proprietary 
keyboard layouts into binary data.
Cash tend/Check tend attack. 
Behind every strong man is a strong woman and 
behind ever POS there is a outdated OS.
Exiting POS Software. 
Popping CMD downloading payload.
Payload overview what the bad guys 
would load.
Locked down and custom Dev'ed envi
ronments.
Limitations of mag injection/making a physical car
d attack/ limitations of physical can you make a wa
iter do your dirty work? 
These devices
Are everywhere
Injecting player rewards cards into Slot machines
people already intentionally leave cards in machin
e for this purpose. 
Rewards card point collecting rolling 
10 different accounts/ Grocery store 
and gas stations
Injecting into prepaid/phone card acti
vation/ activate at terminal swapping 
systems at POS
Trigger injection attacks "Sniffing USB reader” power up wh
en power up is detected it triggers the EM read. Some comp
anies ask to confirm account if only you could hit the enter 
key some how !!
Clock-In systems never be late for 
work again.
• Going to inject the Cash Tender
• And next I'm going to Install 
Credit Card Skimming Software with 
a Spoofer.
Going over 2 Demos
Stay Legal
THANKS FOR COMING
Security Consultant
TWITTER, LinkedIN @westonhecker
Rapid7 www.rapid7.com