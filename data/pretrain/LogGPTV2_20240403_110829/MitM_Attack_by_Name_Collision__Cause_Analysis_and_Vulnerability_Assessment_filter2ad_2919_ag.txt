### Optimized Text

#### New gTLDs and WPAD Query Protection
**Figure 15: Protected Leaked WPAD Query Percentage CDF for Partial Deployment of New gTLD Registry Level Defense**
- The figure shows the cumulative distribution function (CDF) of protected leaked WPAD queries for a partial deployment of new gTLD registry level defense.
- The inset lists the top 18 new gTLDs that can protect 80% of total leaked queries if the defense is deployed.

#### Victim AS Level Prevention
Another approach to prevent WPAD query leaks is at the victim Autonomous System (AS) level. Each victim AS can distribute a blacklist of vulnerable domains to their DNS resolvers, filtering queries to these domains before they are sent to the public namespace. To create such a list for all ASes, one method is to find common vulnerable domains using the intersection set of attack surface domains for the victim ASes. 

**Effectiveness of Blacklist Approach:**
- We estimate the effectiveness of this approach using the high-vulnerability domain (HVD) intersection set for 10 highly-vulnerable ASes, which contains 90 domains.
- If all ASes adopt this blacklist, approximately 36.4% of the leaked WPAD queries globally in our 2-year dataset can be filtered.
- Despite the convenience of creating the blacklist without AS-specific customizations, this approach has limited effectiveness because many HVDs are AS-specific.

To increase effectiveness, each victim AS should customize its blacklists based on their own query traffic patterns. This can be enabled by DNS traffic monitoring and filtering in the recently-proposed name collision risk management framework [26]. One candidate approach to create such a list is to use the attack surface quantification method proposed in §V based on NXD query data, which can be obtained either by collecting DNS queries on their own or collaborating with DNS root server operators.

**Deployment Locations:**
- The deployment locations are the ASes with HVDs, including 11,305 ASes globally according to our quantification results.
- If every AS deploys this, it can filter 97.4% of the leaked WPAD queries globally in our dataset.
- Compared to the new gTLD registry level defense, this approach can achieve the same level of high effectiveness but may have higher deployment challenges due to significantly more deployment locations.

**Partial Deployment Strategy:**
- Figure 16 shows the filtered leaked WPAD query percentage CDF for partial deployment of AS level defense.
- The X-axis ranks the 11,305 victim ASes by their leaked WPAD query percentages.
- Deploying at the top 143 (1.2%) ASes can effectively filter more than 80% of the leaked queries.
- Similar to the new gTLD registry level defense, it is not necessary to cover all 11,305 victim ASes; targeting the top 1–5% ASes can achieve a relatively high level of effectiveness.

#### IP-Based Filtering
Victim AS level filtering can also be IP-based. In the WPAD discovery process, leaked WPAD queries are intended to get internal proxy server IP addresses, while in the WPAD name collision attack, the attacker needs to return public proxy IP addresses. Thus, victim AS resolvers can prevent the attack by filtering DNS responses with public IP addresses. The effectiveness of this approach cannot be evaluated using our root NXD dataset, which is left as future work.

#### End User Level Remediation
The major cause of WPAD query leaks is using devices with internal domains outside of the internal network. To fundamentally solve this problem, this unintended client-side behavior needs to be fixed.

**Disabling WPAD:**
- If WPAD proxy discovery service is not actually used in the internal network, local network administrators (e.g., IT departments) should disable this feature in supported browsers and OSes during corporate device setup.
- To enforce this policy more efficiently without enumerating configurations, administrators can change OS-level domain name mapping files (e.g., /etc/hosts) to map all permutations of WPAD URLs within the internal namespace to 127.0.0.1.

**For Corporate Devices Using WPAD:**
- For devices that depend on WPAD for internal network proxy discovery, the WPAD feature in OSes and browsers still needs to be enabled.
- Companies or other entities with internal domains need to stop hardcoding the internal domain search list on their devices.
- If Windows OS is used, they need to stop setting the Windows PC domain and upgrade their OSes.
- These causes may just be the tip of the iceberg, and there might be many other causes under different conditions. New causes, such as domain hardcoding in certain applications, can emerge in the future.

**Long-Term Solution:**
- We propose designing an OS-level daemon that filters queries based on the network environment. This daemon intercepts DNS queries issued by all applications on the device and correctly filters queries with domains not belonging to the current network environment.
- To distinguish unintended queries, it tracks the network environment at each network status change and stores a list of intended domain suffixes for each network environment, either by learning from DHCP configuration messages or being directly configured by the user.
- There are still design challenges, such as accurately distinguishing network environments with the same IP address prefixes, which we leave as future work.

**Effectiveness and Deployment:**
- In theory, these short-term and long-term device-side solutions can fundamentally solve the problem, achieving 100% effectiveness.
- However, it is extremely difficult to reach and apply these solutions to all end-user devices, estimated to have at least 6.6 million deployment points using the number of distinct (IP, sld.tld) pairs in our 2-year root NXD WPAD dataset.
- This is only a lower bound estimation, as there might be more than one user device with domain sld.tld behind a resolver, making it at least two orders of magnitude larger than the new gTLD registry and victim AS level defenses described above.

**Facilitating Deployment:**
- OSes and browsers can display warning messages when detecting potential name collision risks. For example, if a WPAD query is leaked to the public namespace, the response will include a special IP address, 127.0.53.53, during the 90-day "controlled interruption" period [3].
- Browsers and OSes can leverage this to display risk warnings and recommend users to consult their IT department immediately to resolve the problem.
- Note that the 90-day "controlled interruption" period [3] was ineffective in mitigating such issues since victim machines automatically perform vulnerable operations even without user awareness [33].

**Summary:**
- No single defense approach can easily solve the problem. To maximize the chance of preventing the attack in practice, the best choice would be using these approaches jointly.
- Considering the serious and widespread nature of this vulnerability, actions need to be taken as soon as possible.

### Related Work
- **DNS Spoofing Attacks:** Some previous DNS spoofing attacks also try to deceive victims using malicious DNS responses. These attacks can be MitM (Man-in-the-Middle) or off-path, such as DNS cache poisoning. DNSSEC can mitigate these attacks, but the WPAD name collision attack is exploitable even with DNSSEC.
- **New TLD Delegation Study:** The addition of new gTLDs into the DNS root zone requires considerable debate. Previous work has studied the impact of early gTLD delegations, such as .biz and .xxx. Our work targets the security problem exposed by the new gTLD delegation.
- **Name Collision from New gTLD Delegation:** Concerns about potential name collision problems from new gTLD delegations have been raised. Several studies have measured leaked DNS queries and shown potential risks. ICANN's name collision management framework in 2013 allowed new gTLD strings to be delegated, but previous studies have shown that block lists are ineffective. The controlled interruption period is unlikely to change anything for problems similar to the WPAD name collision attack.

### Conclusion
In this work, we performed a systematic study of the underlying problem cause and the vulnerability status for WPAD name collision attacks in the new gTLD era. We characterized the severity of the problem and uncovered that the major cause of the fundamental leakage problem is very likely devices used in their non-intended network, such as work laptops at home. Using a candidate attack surface definition and a quantification method, we assessed the vulnerability of the attack in the wild. We found that proactive protection strategies are still feasible. Based on these insights, we discussed remediation strategies at the new gTLD registry, AS, and end-user levels, and estimated their effectiveness and deployment difficulties. Our work highlights the importance of addressing known security vulnerabilities and serves as the first in-depth study of one type of name collision problem in the new gTLD era, hopefully inspiring other follow-up studies.

### Acknowledgments
We would like to thank Danny McPherson, Nick Feamster, Andy Simpson, Yannis Labrou, Aziz Mohaisen, Shumon Huque, Duane Wessels, Burt Kaliski, Yunhan Jack Jia, our shepherd, Sam King, and the anonymous reviewers for providing valuable feedback on our work. The University of Michigan authors were supported in part by the National Science Foundation under grants CNS-1345226, CNS-1318306, and CNS-1526455, as well as by the Office of Naval Research under grant N00014-14-1-0440.

### References
[References listed here, formatted as in the original text]