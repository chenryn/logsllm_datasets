perhaps remediation was more likely to happen at servers that are
professionally managed versus at workstations.
6.2 Comparison to Open DNS Resolvers
Figure 10: Size of vulnerable NTP (and, for comparison) DNS
ampliﬁer pools, relative to peak, versus weeks since the Open-
NTPProject.org and OpenResolverProject.org, respectively, be-
gan publicizing vulnerable server counts. (We ablate the ﬁrst
three DNS samples and a single DNS outlier, artiﬁcially low due
to collection and methodology issues.) Monlist ampliﬁers have
been remediated dramatically faster than the other two pools.
The initial rapid remediation of over 90% of vulnerable servers is
remarkable in how it compares to another, related, Internet threat,
DNS-based DDoS ampliﬁers. In Figure 10 we show the fraction
of ampliﬁers seen in the wild versus the number of weeks since
the OpenNTPProject began collecting data and raising awareness
of the threat. For comparison, we show the counts of open DNS
resolvers, which are susceptible to use in ampliﬁcation/reﬂection
attacks for the same reasons that NTP servers are attractive. The
OpenResolverProject.org [3], which is run by the same people as the
NTP project, has been conducting identical IPv4-wide surveys of the
size of the vulnerable DNS server population for about a year. As
the ﬁgure shows, that pool has not decreased much in relative terms.
A possible key difference is that open DNS resolvers are often found
on customer premises equipment, which is much more difﬁcult to
update or replace than are infrastructure servers, like those that
typically run NTP. We measured the intersection between the NTP
monlist ampliﬁer IP pool and the corresponding open DNS recursive
resolver pool. It is about 7K out of 107K monlist ampliﬁers in the
latest sample. The aggregate unique IPs seen over 15 ONP samples
and the DNS IPs over the same period show an overlap of 199K
or 9.2%. These badly mis-manged IPs may remain vulnerable for
some time to come given the length of time since the open resolver
threat has been known and that a non-trivial fraction of networks
are mis-managed for reasonable metrics of management [36].
6.3 The Effect of Remediation
The drastic ampliﬁer reduction we saw was also evident in the
number of ampliﬁers seen per each victim IP, which also decreased
by an order of magnitude across the ONP samples. On the other
hand, we don’t show this in a ﬁgure, but the number of packets
0102030405060Weeks after Start of Publicity020406080100Vulnerable Amplifier Pool Size (%) Relative to PeakDNS Open Resolvers (at peak: 33.9M)NTP version Amplifiers (at peak: 4.9M)NTP monlist Amplifiers (at peak: 1.4M)444that the average ampliﬁer sends all victims has actually gone up
by about an order of magnitude, to somewhat compensate for the
reduced number of ampliﬁers. In other words, remaining ampliﬁers
are being put to more use. Likewise, as Table 1 showed, more
victims are being attacked over time, though this stopped increasing
in April. As shown in Figure 6, the average number of packets that
a victim sees has decreased by about an order of magnitude (from
10M in January to 1M starting in mid-February), and the median
has decreased to about a third.
It is possible, and, as discussed in § 3.3, likely, that other NTP
commands may be used by attackers as the pool of monlist ampliﬁers
is reduced. Figure 10 also shows the size of the version command
ampliﬁer pool, which only decreased 19% since peak.
Because our victim and attack counts come from a parsing of the
monlist tables, as our view of the global NTP population is reduced
when the command is blocked or patched, we will see fewer victims,
attacks, and packets. Thus, our estimates of these populations and
the attack trafﬁc are a lower bound. Finally, those small number
of mega ampliﬁers, if they are being exploited by more attackers,
might increase actual overall attack trafﬁc seen by victims.
6.4 Operator Motivation and Notiﬁcation
We learned that part of the reason that monlist ampliﬁers were re-
mediated more quickly than other ampliﬁer populations may be due
to an aggressive notiﬁcation effort that was conducted via CERTs
and direct operator contact, as recently reported by Kührer et al. [20]
just as we were going to press. While it is plausible and likely that
communication had an impact on remediation, causality, unfortu-
nately, can not be determined. Our discussions with experts in
DDoS at Arbor Networks and with one global ISP operator also
suggested that operator motivation to remediate ampliﬁers or other-
wise mitigate NTP trafﬁc in other ways was likely increased by the
large impact that this trafﬁc was having on the operators’ own net-
works. Understanding the reasons and mechanisms for the dramatic
reduction in the NTP monlist population was beyond our scope,
but we mention these two possible causes as it is important for the
community to work to understand what encourages beneﬁcial oper-
ator response to such global Internet threats. Clearly, remediation
and mitigation of ampliﬁers have positive externalities—they are
behaviors that not only help the operator’s own network but help the
Internet at large be more secure.
7. A VIEW FROM REGIONAL NETWORKS
In the previous sections we have focused on the global view of
the NTP DDoS phenomenon. We now turn our attention to how
these events appeared at individual networks and the commonalities
between them.
7.1 Local Impacts
The two local views include Merit Network and Front Range
Gigapop (FRGP). Merit [22] is a large regional ISP serving mul-
tiple educational and non-proﬁt institutions via a state-wide ﬁber
backbone in Michigan while FRGP [1] is the major ISP serving
Colorado State University (CSU).
Overall aggregate Merit trafﬁc ranges from 15-25 Gbps. On a
normal day, NTP constitutes a negligible fraction of this trafﬁc.
The NTP attacks ﬁrst became visible at Merit on the third week of
December 2013. Figure 11 shows an almost instantaneous increase
in both inbound and outbound aggregate NTP volume with peaks
exceeding 200MB/sec. At FRGP/CSU, however, we see the ﬁrst
sign of NTP attacks almost a month later. Figure 12 shows the
aggregate NTP volume at CSU and FRGP. Due to network size
differences and the limited FRGP vantage points, the attack volumes
observed were an order magnitude less than at Merit. The CSU NTP
servers were secured on January 24th, 2014. This is the point at
which the NTP trafﬁc volumes returned to pre-attacks levels. We do
however, note that other networks within FRGP were not nearly as
proactive. A number of vulnerable NTP servers within FRGP were
used to launch attacks throughout the month of February. NTP trafﬁc
volume continues to grow throughout our observation window of 3
months. The distinctive spikes in FRGP ingress trafﬁc in Figure 12
were NTP reﬂection attacks directed at speciﬁc hosts within FRGP
preﬁxes. The largest one on the 10th of February lasted for just
under 23 minutes with an attack rate of close to 3GBps and a total
of 514 GB of attack trafﬁc.
Figure 11: Merit NTP trafﬁc (3 months).
Figure 12: CSU/FRGP NTP trafﬁc (3 months).
For the purposes of conducting detailed forensics we focused our
attention on a 12-day period for the Merit dataset, and a 19-day pe-
riod for CSU and FRGP datasets starting January 25th and January
18th, 2014 respectively. During the corresponding periods, we iden-
tiﬁed 50 NTP ampliﬁers inside Merit with an average ampliﬁcation
factor of 187, nine ampliﬁers at CSU with an average ampliﬁca-
tion factor of 436, and 48 ampliﬁers at FRGP2. Note that, as both
Merit and FRGP are ISPs that each encompass multiple independent
networks, these numbers of NTP servers are larger than a single
enterprise would typically run. Further, depending on conﬁguration,
potentially any server or high-end router can act as an NTP server.
Table 5 shows the ﬁve worst ampliﬁers at Merit and CSU and their
BAF, unique victims contacted over the periods studied, and the total
volume sent in gigabytes3. Our analysis shows the extent to which
2BAF was not computed for FRGP due to incomplete picture of
egress and ingress volume of the dataset.
3In this section, ampliﬁers, victims and the BAF are deﬁned similar
to [32]. Here, a victim is a client receiving at least 100KB from
12-0112-1501-0101-1502-0102-1503-01UTC time01M10M100M1GNTP aggregate volume (Bps)UDP sport=123UDP dport=12312-0112-1501-0101-1502-0102-1503-01UTC time01K10K100K1M10M100MNTP aggregate volume (Bps)UDP sport=123 (CSU)UDP dport=123 (CSU)UDP sport=123 (FRGP)UDP dport=123 (FRGP)445Figure 13: Time series of top-5 affected victims (Table 6).
Figure 15: Common Merit/FRGP victims volume.
Table 5: Top-5 ampliﬁers at Merit and CSU
Ampliﬁer
Merit-A
Merit-B
Merit-C
Merit-D
Merit-E
CSU-F
CSU-G
CSU-H
CSU-I
CSU-J
BAF
1297
1148
1004
993
948
805
797
796
469
465
Unique victims GB sent
375
4697
5808
316
4369
162
163
163
223
222
1966
1626
3072
1801
2740
38
33
33
238
236
extra trafﬁc resulted in a higher billed trafﬁc level after removing
the 5% of peak trafﬁc in a 95th percentile model, it might have
produced more transit cost at the ISP, which was the case at Merit.
Remediation: Figure 3 showed the rate at which remediation efforts
at both these networks progressed. At Merit, trouble tickets were
used to track the status of each identiﬁed ampliﬁer, and customer
notiﬁcations were used to encourage prompt patching of systems.
During the early stages of the attacks, Merit also put in place trafﬁc
rate limits on NTP trafﬁc to minimize the impact of these attacks
to its customers. At CSU, due to the small set of servers, patching
happened rapidly, within a single day, though remediation in the rest
of FRGP is ongoing. Likewise, some holdouts remain under Merit.
7.2 Individual Attacker/Victim Activity
One of the unique aspects of our datasets from these two sites is
that they offer us a level of detail that is not present in some of our
higher level global datasets. In particular, we are able to examine
ﬂow and packet level details that offer additional insight about the
activity of individual attackers and victims as well as validate our
global datasets.
The attack volume to common targets is shown in Figure 15.
We plot the trafﬁc volume to common targets as recorded from
our two vantage points, Merit and FRGP. We found 291 common
targets attacked by ampliﬁers at both sites. However, the attack
Country
Japan
China
USA
Table 6: Top-5 victims at Merit and CSU
ASN
AS4713
AS4837
AS30083
AS8972
AS8972
AS16276
AS39743
AS28666
AS12390
AS16276
Ampliﬁers
42
4
7
7
7
9
9
9
9
9
Dur. Hours
114
143
166
166
166
31
143
30
51
74
BAF
105
1380
202
165
147
730
658
670
670
669
Germany
Germany
France
Romania
Brazil
UK
France
GB
5887
4542
4017
1703
1595
17
14
12
10
10
Victim
Merit-A
Merit-B
Merit-C
Merit-D
Merit-E
CSU-F
CSU-G
CSU-H
CSU-I