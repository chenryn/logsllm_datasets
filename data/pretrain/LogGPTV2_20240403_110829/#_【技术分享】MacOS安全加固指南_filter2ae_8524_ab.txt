### 优化后的文本

#### 密码策略设置
在命令行模式下，可以使用 `powerlicy(8)` 工具来管理密码策略的各个方面。该工具已在第一章中提及，并且其使用方法可以在手册页中找到。实际建议的策略可能会有所不同。

#### 屏幕保护程序锁
许多用户离开电脑时未进行锁屏操作，这可能导致过路人通过简单的窗口点击获取敏感信息或执行恶意命令。因此，建议启用屏幕保护程序并设置自动锁定功能。可以通过系统偏好设置或 `defaults(1)` 命令实现这一配置。

#### 禁用 `su`
虽然 `su(1)` 在安全性方面不如 `sudo(8)`，但有时仍被用于特定任务。为提高系统安全，应禁止使用 `su`。可以通过修改 PAM 配置文件（例如添加 `pam_deny.so`）或执行 `chmod u-s` 操作来实现这一点。

#### 加固 `sudo`
尽管默认情况下 `sudo(8)` 比 `su(1)` 更安全，但其配置仍有改进空间。以下是一些建议：
- 限制只有特定命令可通过 `sudo` 执行。这些命令应包括 `shutdown(8)` 和 `reboot(8)` 等。
- 避免允许所有 shell 通过 `sudo` 运行，因为这可能绕过权限控制。
- 启用 `tty_tickets` 功能以确保超级用户权限仅限于已认证的终端。
- 使用 `log_input` 和 `log_output` 特性记录 `sudo` 命令的输入输出。更多详细信息请参阅 `sudoers(5)` 文档。

#### 定期检查启动项和登录项目
定期审查用户的启动项和登录项目有助于发现潜在的恶意软件。推荐每周至少检查一次，并对新出现的条目进行审核。此外，还应关注登录/注销脚本及其活动情况，以防恶意软件利用计划任务（如 cron 或 at）自我维持。

#### 利用 MDM 或家长控制管理用户会话
MacOS 提供了多种机制来限制用户行为，例如通过 MDM（移动设备管理）或内置的家长控制功能。管理员可以根据需要设定具体规则，从而增强系统的整体安全性。

#### 数据保护
- **加密快照**：定期为关键文件生成加密哈希值（如 MD5 或 SHA-1），以便检测未经授权的更改。重要文件包括 `/etc/hosts`、`/etc/passwd` 等。
- **定期备份**：定期备份用户数据以防意外丢失。可以手动编写脚本或使用第三方工具完成此任务。理想情况下，应将备份存储在一个可信任的服务器上，并通过无密码 SSH 连接进行访问。

#### 关闭 iCloud 存储
iCloud 与 MacOS 的集成日益紧密，但在某些场景下也可能成为数据泄露的风险点。如果不需要云服务，可以轻松禁用 iCloud 存储功能。

#### 启用休眠模式
为了节省电力并延长电池寿命，建议开启休眠模式。可以通过 `pmset hibernatemode 25` 命令将内存内容保存到磁盘上，并断开电源供应。

#### 安全删除
HFS 和 APFS 文件系统中的文件并不会立即从物理介质上移除。要彻底清除数据，可以使用 `srm(1)` 或 `rm -P` 命令覆盖原有内容。不过需要注意的是，在闪存驱动器或 Fusion Drive 上频繁执行此类操作可能会缩短设备使用寿命。

#### 物理安全
设置固件密码可以防止未经授权者修改启动选项，进一步增强了 Mac 的安全性。具体步骤请参考 Apple 官方文档。

#### 查找我的 Mac
“查找我的 Mac” 功能不仅适用于移动设备，也支持台式机。启用后，即使设备遗失也能远程锁定或擦除数据。对于便携式计算机而言尤其有用。

#### FileVault 2
强烈建议启用 FileVault 2 全磁盘加密功能，以保护静止状态下的数据安全。当系统关闭或重启时，未经验证的人员将无法读取硬盘上的任何信息。

#### 待机期间移除密钥
FileVault 2 在待机状态下仍会在内存中保留加密密钥。为了防止基于硬件的攻击，可以设置 `pmset destroyfvkeyonstandby 1` 自动销毁密钥。但这可能会干扰正常待机及 Power Nap 功能，需谨慎考虑。

以上内容摘自 Jonathan Levin 编写的《MacOS and iOS Internals, Volume III》附录 A。完整版 PDF 可从原文链接处下载。