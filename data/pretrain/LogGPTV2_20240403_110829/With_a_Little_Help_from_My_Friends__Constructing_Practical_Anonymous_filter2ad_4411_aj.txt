(2b)
(2c)
We can now follow the proof for FHS15 and in particular Claim 1
and Corollary 1 (which is exactly as in their proof), and by using
the same argumentation as in FHS15 for (2b), from
1
ğ‘¦ ğ‘—
ğ‘¦âˆ— = ğœ‹ğ‘¦ + âˆ‘ï¸
ğœŒğ‘¦,ğ‘—ğ‘§ ğ‘— + âˆ‘ï¸
ğœ“ğ‘¦,ğ‘—
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
(1a)
(1b)
(2a)
for (1a) we need to have ğœ‹ğ‘¦ = ğœ‹ Ë†ğ‘¦ and the non-zero coefficients are
ğœ“ğ‘¦,ğ‘— and ğœ“ Ë†ğ‘¦,ğ‘—, where we have ğœ“ğ‘¦,ğ‘— = ğœ“ Ë†ğ‘¦,ğ‘— for all ğ‘– âˆˆ [ğ‘]. Conse-
quently, the proof continues exactly as the FHS15 with the only
difference that we additionally need to investigate (2c). By leverag-
ing the simplification of Eq. (9) in [45], we know that there exists
one ğ‘› âˆˆ [ğ‘] for which ğ‘¦âˆ— = ğœ“ğ‘¦,ğ‘›
. By construction we have
â„âˆ— = â„ğ‘– for a given ğ‘– âˆˆ [ğ‘˜], i.e., the tag ğœğ‘– of the forgery. Now only
considering non-zero coefficients we can simplify (1b) to
1
ğ‘¦ğ‘›
âˆ‘ï¸
ğœƒ Ë†ğ‘£,ğ‘–â„ğ‘– + âˆ‘ï¸
ğ‘–âˆˆ[ğ‘˜]
ğ‘— âˆˆ[ğ‘]
Ë†ğ‘£âˆ— =
ğœˆ Ë†ğ‘£,ğ‘— ğ‘£ ğ‘— .
From FHS15 we know that ğœŒğ‘§,ğ‘— ğœ‹ğ‘¦ğ‘§ğ‘› = 0 for all ğ‘— âˆˆ [ğ‘]. But since ğ‘§ ğ‘—
and ğœŒğ‘§,ğ‘— are non-zero for some ğ‘—, we have ğœ‹ğ‘¦ = 0 and thus ğœƒ Ë†ğ‘£,ğ‘– = 0
for all ğ‘– âˆˆ [ğ‘˜]. By equating coefficients we have
ğ‘¦âˆ—â„ğ‘– = ğœ“ğ‘¦,ğ‘›
1
ğ‘¦ğ‘›
â„ğ‘– and Ë†ğ‘£âˆ— =
ğœˆ Ë†ğ‘£,ğ‘— (â„ğ‘–
1
ğ‘¦ğ‘–
).
âˆ‘ï¸
ğ‘— âˆˆ[ğ‘]
1
ğ‘¦ğ‘›
By leveraging the fact that all ğ‘¦ğ‘– are distinct, we obtain that Ë†ğ‘£âˆ— =
) with ğœˆ Ë†ğ‘£,ğ‘› = ğœ“ğ‘¦,ğ‘› yielding that the Ë†ğ‘£âˆ— part is consistent
ğœˆ Ë†ğ‘£,ğ‘›(â„ğ‘–
with the remainder representing a previous query with the exact
same tag and in particular the entire forgery is just a multiple of
previously queried message. Note that the simulation error is the
same as in the FHS15 proof.
â–¡
1
ğ‘¦
1
ğ‘¦
1 , ğ‘”
ğ‘– )ğ‘¦, ğ‘”
2 , ğ»(ğœ) 1
(((ğ‘€ğ‘¥ğ‘–
ğ‘‰2), ğœ‡, pk) for ğœ‡ âˆˆ Zğ‘ outputs (((ğ‘€ğ‘¥ğ‘–
B.3 Proof of Lemma 3.8
Proof. For perfect adaption under malicious keys let ğ‘€ âˆˆ (Gâˆ—
1)â„“,
ğœ âˆˆ {0, 1}âˆ—, ğ» : {0, 1}âˆ— â†’ G2, pk âˆˆ (Gâˆ—
2)â„“ and (ğ‘¥ğ‘–)ğ‘–âˆˆ[â„“] be such
that pk = (ğ‘”ğ‘¥ğ‘–2 )ğ‘–âˆˆ[â„“]. A signature (ğ‘1, ğ‘Œ1, ğ‘Œ2, ğ‘‰2) âˆˆ G1 Ã— Gâˆ—
1 Ã—
Gâˆ—
2 Ã— G2 satisfying Verify(ğ‘€, (ğ‘1, ğ‘Œ1, ğ‘Œ2, ğ‘‰2), pk) = 1 is of the form
ğ‘¦ ) for some ğ‘¦ âˆˆ Zğ‘. ChgRep(ğ‘€, (ğ‘1, ğ‘Œ1, ğ‘Œ2,
ğ‘¦ğœ“ ),
which is a uniformly random element ğœ in the signature space
conditioned on Verify(ğ‘€ ğœ‡, ğœ, pk) = 1.
TBEQ in Scheme 2 also satisfies the conventional perfect adap-
tion notion, since sk = (ğ‘¥ğ‘–)ğ‘–âˆˆ[â„“] is the only element satisfying
VKey(sk, pk) = 1 (which checks if pk = ğ‘”sk
2 ) and Sign(ğ‘€ ğœ‡, sk) (as
ChgRep) outputs a uniformly random element ğœ in the space of
signatures conditioned on Verify(ğ‘€ ğœ‡, ğœ, pk) = 1.
ğ‘– )ğ‘¦ğœ“ , ğ‘”
, ğ»(ğœ) 1
1
ğ‘¦ğœ“
2
1
ğ‘¦ğœ“
1
, ğ‘”
â–¡
B.4 Proof of Lemma 3.12
We use the same notation as in the proof of Lemma 3.6 and note that
we consider a bounded attribute-space represented by distinct and
random elements â„ğ‘– âˆˆ Gâˆ—
2, ğ‘– âˆˆ [ğ‘˜], in the mpk (i.e., one for every
possible (Attr, ğ‘£Attr) pair). Moreover, for the sake of readability we
prove the lemma for the case ğ‘¡ = 2 with public keys pk1 = (ğ‘”ğ‘¥ğ‘–2 )ğ‘–âˆˆ[â„“]
and pk2 = (ğ‘”ğ‘¢ğ‘–2 )ğ‘–âˆˆ[â„“] respectively and it is straightforward to gener-
alize it to any ğ‘› > 2. Note that a query for the same representative
ğ‘€ to either of the keys results in using the same randomness ğ‘¦. We
require that for any message ğ‘€ to the Sign oracle of AAEQ, if the
adversary wants to obtain a signature for more than one attribute,
it will obtain signatures under both secret keys (attributes) using
the same randomness ğ‘¦ (which is sampled uniformly at random in
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea2021each query to Sign) and the queried attribute values ğ‘£Attr and ğ‘£Attrâ€²
(which maps to two of the â„ values). We will denote the correspond-
ing ğ‘1 elements of signatures under pk1 and pk2 using superscript
(1) and (2) respectively.
As in the proof of Lemma 3.6, we follow the the proof of the
underlying FHS15 SPS-EQ scheme in [45]. We start by taking the
discrete logarithms of all elements:
ğ‘— + âˆ‘ï¸
ğ‘— + âˆ‘ï¸
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğœƒ Ë†ğ‘¦,ğ‘–â„ğ‘–
ğœ“ğ‘§,ğ‘—
ğœ“ğ‘¦,ğ‘—
1
ğ‘¦ ğ‘—
1
ğ‘¦ ğ‘—
ğ‘–âˆˆ[ğ‘˜]
ğœ“ Ë†ğ‘¦,ğ‘—
1
ğ‘¦ ğ‘—
ğ‘–âˆˆ[â„“]
ğ‘–âˆˆ[â„“]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğœŒ(2)
ğ‘§,ğ‘— ğ‘§(2)
ğœŒ(2)
ğ‘¦,ğ‘— ğ‘§(2)
ğœŒ(1)
ğ‘§,ğ‘— ğ‘§(1)
ğœŒ(1)
ğ‘¦,ğ‘— ğ‘§(1)
ğ‘— +âˆ‘ï¸
ğ‘— +âˆ‘ï¸
ğœ’ Ë†ğ‘¦,ğ‘–ğ‘¥ğ‘–+âˆ‘ï¸
ğœ” Ë†ğ‘¦,ğ‘–ğ‘¢ğ‘–+âˆ‘ï¸
ğœˆ Ë†ğ‘¦,ğ‘— ğ‘£ ğ‘— +âˆ‘ï¸
ğœ” Ë†ğ‘£,ğ‘–ğ‘¢ğ‘–+âˆ‘ï¸
ğœ’ Ë†ğ‘£,ğ‘–ğ‘¥ğ‘–+âˆ‘ï¸
ğœˆ Ë†ğ‘£,ğ‘— ğ‘£ ğ‘— +âˆ‘ï¸
ğ‘— +âˆ‘ï¸
ğ‘˜ + âˆ‘ï¸
ğ‘§âˆ— =ğœ‹ğ‘§ + âˆ‘ï¸
ğ‘¦âˆ— =ğœ‹ğ‘¦ + âˆ‘ï¸
Ë†ğ‘¦âˆ— =ğœ‹ Ë†ğ‘¦+âˆ‘ï¸
+ âˆ‘ï¸
Ë†ğ‘£âˆ— =ğœ‹ Ë†ğ‘£+âˆ‘ï¸
+ âˆ‘ï¸
ğ‘– =ğœ‹ğ‘šâˆ—,ğ‘–+âˆ‘ï¸
+ âˆ‘ï¸
ğ‘š ğ‘—,ğ‘– =ğœ‹ğ‘š,ğ‘—,ğ‘–+ âˆ‘ï¸
+ âˆ‘ï¸
ğœ“ Ë†ğ‘£,ğ‘—
ğ‘— âˆˆ[ğ‘]
ğœŒ(1)
ğ‘šâˆ—,ğ‘–,ğ‘—ğ‘§(1)
1
ğ‘¦ ğ‘—
ğœŒ(1)
ğ‘˜âˆˆ[ ğ‘—âˆ’1]
ğ‘˜âˆˆ[ ğ‘—âˆ’1]
ğœ“ğ‘šâˆ—,ğ‘–,ğ‘—
ğ‘–âˆˆ[ğ‘˜]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘— âˆˆ[ğ‘]
ğ‘§(1)
ğ‘–âˆˆ[â„“]
ğ‘–âˆˆ[â„“]
1
ğ‘¦ ğ‘—
ğœ“ğ‘š,ğ‘—,ğ‘–,ğ‘˜
ğ‘šâˆ—
ğ‘š,ğ‘—,ğ‘–,ğ‘˜
1
ğ‘¦ğ‘˜
ğœƒ Ë†ğ‘£,ğ‘–â„ğ‘–
ğœŒ(2)
ğ‘šâˆ—,ğ‘–,ğ‘—ğ‘§(2)
ğ‘—
ğœŒ(2)
ğ‘š,ğ‘—,ğ‘–,ğ‘˜
ğ‘§(2)
ğ‘˜
(3a)
ğ‘˜âˆˆ[ ğ‘—âˆ’1]
âˆ‘ï¸
ğ‘–âˆˆ[â„“]
And from the forgery we know that:
ğ‘šâˆ—
ğ‘– (ğ‘¥ğ‘– + ğ‘¢ğ‘–) = ğ‘§âˆ— Ë†ğ‘¦âˆ—
ğ‘¦âˆ— = Ë†ğ‘¦âˆ—
Ë†ğ‘£âˆ— = ğ‘¦âˆ—( Ë†â„âˆ—
1 + Ë†â„âˆ—
2)
(3b)
(3c)
with the pair of (Attr, ğ‘£Attr) values in the forgery w.l.o.g. correspond-
ing to â„1 and â„2 respectively. In the following we omit the analysis
of Equation (3c) as this follows from the exact same reasoning as in
the proof of Lemma 3.6. First, we observe that we can adopt Claim 1
and Corollary 1 from the FHS15 proof in [45] to our case of the ğ‘§(1)
ğ‘›
and ğ‘§(2)
ğ‘› which in particular means that all ğ‘¦â€™s in such monomials
are different, one is ğ‘¦ğ‘› and for every ğ‘¥ as well as ğ‘¢ there comes one
ğ‘¦. Moreover, ğ‘§(1)
contains one more ğ‘¥ than ğ‘¢â€™s and vice-versa for
ğ‘§(2)
ğ‘› . Now, we first look at Equation (3b) and comparing coefficients
immediately yields that ğœ‹ğ‘¦âˆ— = ğœ‹ Ë†ğ‘¦âˆ—, that ğœ’ Ë†ğ‘¦,ğ‘– = ğœ” Ë†ğ‘¦,ğ‘– = 0 for all
ğ‘– âˆˆ [â„“], ğœƒ Ë†ğ‘¦,ğ‘– = ğœˆ Ë†ğ‘£,ğ‘— = 0 for all ğ‘– âˆˆ [ğ‘˜] and ğœ“ğ‘¦,ğ‘— = ğœ“ Ë†ğ‘¦,ğ‘— for all ğ‘— âˆˆ [ğ‘].
Moreover, due to Claim 1 we have that ğœŒ(1)
ğ‘¦,ğ‘— = 0 for all
ğ‘— âˆˆ [ğ‘]. This simplifies Equation (3b) to
ğ‘¦,ğ‘— = ğœŒ(2)
ğ‘›
ğ‘¦âˆ— = ğ‘¦ = ğœ‹ğ‘¦ + âˆ‘ï¸
ğœ“ğ‘¦,ğ‘—
1
ğ‘¦ ğ‘—
.
ğ‘— âˆˆ[ğ‘]
+ âˆ‘ï¸
âˆ‘ï¸
ğ‘— âˆˆ[ğ‘]
ğ‘˜âˆˆ[ğ‘]
to: âˆ‘ï¸
âˆ‘ï¸
ğ‘— âˆˆ[ğ‘]
ğ‘˜âˆˆ[ğ‘]
Now, we use this simplification to investigate Equation (3a):
ğ‘–âˆˆ[â„“]
ğœŒ(1)
ğ‘šâˆ—,ğ‘–,ğ‘—ğ‘§(1)
âˆ‘ï¸
(ğœ‹ğ‘šâˆ—,ğ‘–+âˆ‘ï¸
ğ‘— +âˆ‘ï¸
)(ğ‘¥ğ‘– + ğ‘¢ğ‘–) = (ğœ‹ğ‘§ + âˆ‘ï¸
+ âˆ‘ï¸
)(ğœ‹ğ‘¦ + âˆ‘ï¸
+âˆ‘ï¸
ğ‘— + âˆ‘ï¸
ğ‘— âˆˆ[ğ‘]
1
ğ‘¦ ğ‘—
ğœŒ(2)
ğ‘§,ğ‘— ğ‘§(2)
ğœŒ(2)
ğ‘šâˆ—,ğ‘–,ğ‘—ğ‘§(2)