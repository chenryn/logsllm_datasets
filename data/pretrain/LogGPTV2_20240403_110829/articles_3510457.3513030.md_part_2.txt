• Using rich distributional semantics of natural language, ICA extractionandcausalminingneededforRCA.Ourothercontribu-
enablesIncidentSearchandRCA,givenanewincidentsymptom: tionisbuildingaCausalKnowledgeGraphfromtheunstructured
– ANeuralInformationRetrievalSystemtosearchandrankthe incidentdata.Thisisaquitedifferenttaskfromthewell-studied
mostrelevantpastincidentswithsimilarsymptom literatureofcausalgraphconstruction[16,27,32]fromstructured
– AsimpleyeteffectiveRetrievalbasedRCAtodetectthemost calltraces/graphsandsystemdependencygraphs.
likelyrootcausesandresolutionsforthegivenincidentsymp- Motivation-2:PRBasOracleRootCauseKnowledgeSource:
tombasedonthepastinvestigations. TraditionalRCApipelineheavilyrelyondata-sourceslikeapplica-
Additionally,ICAprovidesaframeworkforpost-mortemanalysis tionorerrorlogs[9,11,20,30,31]fromservicehealthmonitoring
intoallpastincidentsandunderstandthenatureofrecurringissues. toolsorexecutiontraces[16–18,28]andtimeseriesofKPImetrics
ItallowsapplicationofformalMLtechniques(e.g.,causalmodelsor [4,21,26,27].Howeverdiscoveringanyroot-causerelatedsignal
graphicalinference)forRCAor,infuture,buildingcomprehensive inthesedata-sourcescanbeacomplextime-consumingtask.On
AIOpspipelineforholisticRCAovermultimodalmulti-sourcedata theotherhand,thepastincidentinvestigationsdocumentedbydo-
likelogs,executiontracesandtimeseriesmetrics.Bysuccinctly mainexpertsarearichgoldmineofOracleRootCauseInformation,
representingandconsumingRCAknowledgeofpastinvestigations, containingmanyexplicitinformativelinguisticcuesconnecting
ICAprovidesanidealframeworkfornoviceinexperiencedSREs theincidentsymptomtotheexpert-recommendedrootcauseand
toquicklygetonboardedintotheRCAprocessandacquirethe resolution.Whileinitsrawform,theselongunstructureddocu-
knowledgeofmoreexperiencedSREs.Infuture,infrastructureslike mentationsarenotaptforknowledgereusal,SoTANLPtechniques
CausalKnowledgeGraph,mightenablediscoveringRCAinsights canprocessthemintoastructuredformamenabletoAImodels.
198
MiningRootCauseKnowledgefromCloudServiceIncidentInvestigationsforAIOps ICSE-SEIP’22,May21–29,2022,Pittsburgh,PA,USA
Figure3:IncidentCausationAnalysisPipelinewithdownstreamIncidentSearchandRetrievalbasedRCAoverPRBData
Investigation,iv)ImmediateResolutionandv)RootCauseInves-
Motivation-3:HandlingRepeatedIncidents:Arepeatedinci- tigation.WiththisformofPRBData,Fig3showsourproposed
dentisonewithsimilarsymptom,rootcauseandresolutionas IncidentCausationAnalysis(ICA)pipeline(whichweelaborate
anypastincident.Wequantitativelydefineextentofrepeatedness below)whosemaincomponentsare:
asthemaximumobtainableWord-Overlapoftheconcatenation i)OfflineNeuralInformationExtractionfromunstructureddata
ofthesethreefields,whencomparedwithallpastincidents.Fig. ii)NeuralKnowledgeMiningtoconstructCausalKnowledgeGraph
2(a)plotsthetimelineofquarterlycountofallandvariousdegrees iii)NeuralSearchtofindpastinvestigationsrelevanttoanyquery
ofrepeatedincidents,showingthatthelatterconsistentlypersists iv)RetrievalbasedRCAusingNeuralSearch&CausalKnowledge
throughouttheperiod.InFig.2(b),weobservethatthedistribution Graphtopredictrootcausesandresolutionsforaquerysymptom.
ofincidentseverity(Sev1/Sev2)isquitesimilaracrossrepeatedand
non-repeatedincidents,indicatingthatrepeatedincidentsneedas
3.1 NeuralInformationExtraction
muchattentionasthenon-repeatedones.AndFig.2(c)showsthat
thedistributionofincidentresolutiontime(anditsmean)isquite HereweextracttargetedinformationfromtheunstructuredPRBs.
similaracrossrepeatedandnon-repeatedincidents.Thisislargely SymptomExtraction:Thisinvolvesarule-basedmoduletoex-
due to the lack of a framework of knowledge-reusal from past tractthegenericsymptomindicatingtheincident(e.g.,connpool)
investigations.Especiallywithincreasingnumberofhigh-stake fromthePRBSubject,byremovingspecificHostMachinedetails.
recurringincidents,AIpipelineshavebecomeessentialtoextract Atinferencetime,foranewincident,thesymptomisobserved
andrepresenttheRCAknowledgeembeddedinPRBs. fromtheKPImetricsandprovidedasinputtotheICApipeline.
Challenge-1:LongUnstructuredDocumentationofPRBWe KeyTopicExtraction:Forthisweemployanensembleofvari-
needtohandlethelong,unstructuredcontentinPRBsthatare ousunsupervisedTopicmodels[3]toextractshorttopicalphrases
oftenrifewithirrelevantdistractiveinformation.Table1presents mostrepresentativeofthedocument.ThisincludesGraphicalTopic
thestatisticsoftheoriginalPRBdocumentsaswellastheextracted ModelslikeTextRank,SingleRank,TopicRank,TopicalPageRank,
information. For instance, it shows that more severe incidents PositionRank,MultipartiteRank,FeaturebasedmodelYAKE,Neu-
(Sev0>1>2)typicallyresultinlongerdocumentation.
ralembeddingbasedSIFRankwhichusespretrainedELMO.The
Challenge-2:UnsupervisedSettingWeneedtotacklethiscom- extractedphrasesalongwiththeirprobabilityscoresaresimply
plexdomain-specificprobleminanunsupervisedsetting,using aggregatedintoadistributionbytheensemblingtechnique.
genericpretrainedorunsupervisedNLPmodels,withminimalas- RootCause&ResolutionExtraction:Toextracttargetedspans
sumptiononthenatureofPRBdocuments. containingcrisprootcausesandresolutioninformationfromthe
CanPRBsbeorganicallygeneratedinastructuredform? PRBdocument,weusepretrainedTransformersthathavebeen
RCAinvestigationstypicallyrequiremultipleiterationsofcross- fine-tunedonMachineReadingComprehensiontaskthatanswers
team communications. This decentralized documentation in an questionsbasedonagivenpassage.Specificallyweapplyanensem-
agiletroubleshootingandtriagingframeworkresultsinPRBfields bleofBERTmodels(DistilBERT,BERT-baseandBERT-large)[7],
beingdirectexcerptsfromemail-exchangesorchat-conversations, RoBERTa[19]andSpanBERT[14],eachfine-tunedonthestan-
makingitimpossibletogeneratePRBsinastructuredform. dardopen-domainextractive-QAdatasetSQuAD.Forextracting
rootcauses,wecreateahand-craftedquery-template,e.g.,“What
wastherootcauseofSYMPTOM? orWhatcausedtheincident?",
whereSYMPTOMreferstotheextractedincidentsymptom.Simi-
3 OURAPPROACH
larlyforresolutionextractionweusequerieslike“Whatwasdone
TherawPRBdocuments(fromFig.1)recordingincidentinvesti- toremedytheSYMPTOM? orWhatactionresolvedtheincident?".
gationshaveagenericstructurecomprisingof:i)IncidentSubject, Empirically,weobservethatthesepretrainedQAmodelsperform
i.e.,atitlecapturingtheprimarysymptomoftheincident,ii)Inci- quitewellonthischallengingproblem,withoutanysupervisionof
dentTimeStampandHostDetails,iii)Sequenceofupdatesofthe
199
ICSE-SEIP’22,May21–29,2022,Pittsburgh,PA,USA AmritaSahaandStevenC.H.Hoi
ourtargetAIOpsdomain.Thesemodelsextractshortspanswitha
probabilityscore,whichareaggregatedbyanensembleafterlexical
de-duplicationresultinginarbitrarilymanytargetspans.
ExtractiveSummarization:Inordertoextractthemostinforma-
tivesentencesfromthePRBinvestigationasasummary,weusea
RoBERTa[19]basedextractivesummarizationmodelfinetunedon
astandardbenchmarksummarizationdataset,CNN-DailyMail.
3.2 NeuralKnowledgeMining
OurNeuralKnowledgeMiningmoduleaggregatesthedocument-
levelinformationextractedinformofsymptoms,rootcausesand
resolutionsandbuildsaglobalCausalKnowledgeGraph(CKG).
Thisinfrastructurenotonlyenablesvisualizationofthecausalstruc-
tureunderlyingtheincidents,italsoplaysakeyroleinpredicting
thelikelyrootcauseandresolutiongivenasymptom.Westorethe
CKGinthepopularGraphDBframework,Neo4j(https://neo4j.com)
whichallowsinteractivevisualizationandnavigationandefficient
queryingoverthegraph.Belowarethestepstoconstructthegraph:
PRBDocumentLevelGraph:Foreachdocument,nodesarecon-
structedoutoftheextractedsymptom,root-causeandresolutions
andedgesaddedindividuallybetweensymptom,root-causeand
symptom-resolutionpairs.Eachnodeisrepresentedasavector Figure4:SnippetofconstructedCausalKnowledgeGraph
obtainedasaverageoftheGloVe[24]basedtokenembeddingsof
thenodedescription,weightedbynormalizedterm-frequency.
3.3 UsingCausalKnowledgeGraphforRCA
AggregatingDocumentLevelGraphs:Weapplysimpleclus-
teringstrategiesoverthedenserepresentationofthegraphnodes TheconstructedgraphhasmanyusesinRCA:
toaggregatetheincidentlevelinformationintoacompactCausal GlobalIncidentAnalysis:Itprovidesinteractivevisualization
KnowledgeGraph.Fig.4showsarandomlyselectedsubgraph,with andintuitivenavigationovertheunderlyingstructureofsymptoms,
thedifferentnode-types,eachwithlabelasthecorrespondingtex- rootcausesandresolutionsconnectingdifferentincidents.Italso
tualdescriptionextractedfromthePRBdocumentorthegenerated servesaspost-mortemanalysistool,tounderstandthenatureof
clusterlabel.Theclusteringinvolvesthebelowsteps: symptomsandrootcausesofthemostrecurringpastincidents.
Step1:ClusteringSymptoms:WeapplyHierarchicalAgglomer- Incident-specificAnalysis:Startingwithanincidentsymptomor
ativeClusteringtechniques[23]tohierarchicallyclusterthesymp- root-cause,ausercanextracttherelevantsubgraphoftheCausal
tomsextractedfromallthepastPRBrecords,bottomtotop,intoa KnowledgeGraphornavigatethelocalclusterofrelatedroot-causes
symptomTypenode,successivelymergingthemtogetherbymin- orsimilarsymptoms.
imisingthesumofsquareddistanceswithinallclusters.Number RootCauseorResolutionPredictionfromSymptom:Our
ofclustersareestimatedusingELBOWandSilhouettemethods. primaryuse-caseoftheCKGistoleveragethegraphicalstructure
Step2:ClusteringRootCausesandResolutions:Next,wein- tocollectivelyinfertherootcauseorresolutionfromallrelevant
dividuallyapplyglobalandlocalAffinityPropagation[23]based pastinvestigationsgivenanincidentsymptom.Weframethem
clusteringontheroot-causesandresolutionsthroughiterativemes- astwoindependenttasks:i)RootCauseii)ResolutionPrediction,
sagepassingbetweennodesasfunctionsoftheirsimilarityscore. giventheSymptom,forwhichweproposeasimpleyeteffective
Hereglobalreferstoclusteringoverallroot-causes(andresolutions) graphicalneuralmodel.ForthefirsttaskweconsidertheCKG
collectedfromallPRBrecords,leadingtoglobalRootCauseTypeand overglobalclusteringofthesymptomandroot-causenodesand
globalResolutionTypenodesascluster-heads.And,localclustering ignoretheresolutionnodesandvice-versaforthesecondtask.We
isonlyrestrictedtotheroot-causes(andresolutions)associatedto describethemodelforthefirsttaskwhichsimilarlyfollowsforthe
symptomswithineachclusterofsymptomType,creatingcluster- secondone.Forsimplicity,weignorethehierarchicalclustering
headsrootCauseTypeandresolutionTypeforthatsymptomcluster. oversymptomsandonlyconsiderthefinallevelofsymptomclus-
tering,i.e.symptomTypeherereferstotheleaflevelclusterheads.
Step3:ClusterLabeling:Foreachcluster,weconstructadocu-
mentbyconcatenatingallthenodelabelsanduseapopularcollo- • 𝑉 𝑆,𝑉 𝑅 =Setofsymptomandroot-causenodesrespectively
cationextractiontechnique[25]onit.Itgreedilyselectsthelongest • 𝐸 𝑆 ={(𝑣 𝑖,𝑣 𝑗)|𝑣 𝑖,𝑣 𝑗 ∈𝑉 𝑆,𝑐𝑙𝑢𝑠𝑡𝑒𝑟(𝑣 𝑖)=𝑐𝑙𝑢𝑠𝑡𝑒𝑟(𝑣 𝑗)}
n(≤3)-gramswithhighestPointwise-MutualInformationfromthe • 𝐸 𝑅 ={(𝑣 𝑖,𝑣 𝑗)|𝑣 𝑖,𝑣 𝑗 ∈𝑉 𝑅,𝑐𝑙𝑢𝑠𝑡𝑒𝑟(𝑣 𝑖)=𝑐𝑙𝑢𝑠𝑡𝑒𝑟(𝑣 𝑗)}
document.Theselectedn-gramsarefurtherrerankedusingaverage • 𝐸 𝑆𝑅 = {(𝑣 𝑠,𝑣 𝑟)|𝑣 𝑠 ∈𝑉 𝑆,𝑣 𝑟 ∈𝑉 𝑅,𝑖𝑛𝑐𝑖𝑑𝑒𝑛𝑡(𝑣 𝑠)∩𝑖𝑛𝑐𝑖𝑑𝑒𝑛𝑡(𝑣 𝑟) ≠
normalizedterm-frequencyweightsofthenon-stopwords. {}}i.e.theybothbelongtothesameincident
200
MiningRootCauseKnowledgefromCloudServiceIncidentInvestigationsforAIOps ICSE-SEIP’22,May21–29,2022,Pittsburgh,PA,USA
Thisresultsinabipartitegraph,betweentheclustergraphformed nodeintheconstructedCKGandoutputtheonewhichyieldsthe
overthesymptomnodesandasimilaroneformedovertheroot- highestsimilarityscoreasthepredictedrootcause.
causenodes.Duringtrainingandinferenceweassumethattheclus-
tergraphoverthesymptomsandrootcauses(i.e.𝑉 𝑆∪𝑉 𝑅,𝐸 𝑆,𝐸 𝑅)is 3.4 IncidentSearchandRetrievalbasedRCA
completelyknown.However,the“symptomroot-causeedges”,𝐸 𝑆𝑅,
WenowfocusonICAmodulescateringtoourRCAgoal.Aftera
whichareobservationsfrompastincidentsareunknownforsome
newincidentoccursanditskeysymptomshavebeenidentified,a
orallincidents.Ourpracticalmotivationisthatwhileorganizing
coreIncidentManagementtaskistoefficientlysearchoverpast
knownsymptomsandroot-causesintoclusterscanbedoneapriori,