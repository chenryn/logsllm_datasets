and the different levels of innovation they have embraced. Curi-
ously though, we find that innovation and a first mover advantage
does not manifest in earnings. The actor with the key hsFAjj, who
was among the first, dominated proxying and controls extensive
infrastructure, did not translate this advantage into earnings at the
same rate as for example the key 6a9929 who would pick up data
on vulnerable routers from public lists to roll out infections.
Also the number of infected routers is not necessarily an indica-
tor for the amount of revenue an adversary has generated, as the
size (and thus also the type) of the router matters more than the
number of compromised devices. Table 6 also lists the total number
of routers a particular siteKey ever had under its control during the
10 month study, and we clearly see that the volume of routers is not
an adequate predictor of monetary success. Another unexpected
story emerges when we look at the routers that are providing the
most revenue. Out of the top 10 most grossing routers, 6 are located
in Iraq, and one each in Turkey, France, Brazil and the Netherlands,
which is counterintuitive looking at the worldwide distribution of
MikroTik installations shown earlier in Figure 6.
6.2 Charting the Ecosystem of Actors
While looking at the life cycle of router infections, we observe
different levels of sophistication in every stage. In the identification
stage, we discover a clear distinction between siteKeys installed as
a result of scanning and infection based on public sources, such as
Shodan. In the exploitation of the routers afterwards we observe a
constantly changing landscape in which actors are regularly infec-
ting new devices and stealing from each other. After infection, only
a limited number of actors demonstrate a high level of sophistication
by setting up an infrastructure. To monetize the hijacked routers,
actors initially set up HTTP proxies, but subsequently increased
their revenues by installing SOCKS proxies with cryptojacking
scripts. The used cryptomining scripts diverge to multiple services,
and we have noticed a continuous flow of router infections and
removals. Clear geographical differences in mining characteristics
are identified, where Brazil and Indonesia are the most infected,
while Iraq seems to have the most lucrative infrastructure to infect.
Observed maintenance patterns show that specific anonymized IPs
can be linked by behavior to siteKeys.
Relating actors and siteKeys. Based on the results of the different
independent components analyzed in the previous sections, we are
able to link certain siteKeys to each other and/or to IPs. To start
with, three siteKeys hsFAjj, SK_LCx, oDcuak show similar behav-
ior as the same infrastructural patterns can be found on routers
infected with these siteKeys, as well as regular contacts with the
same set of attacker IPs for maintenance over SSH. Figure 10 con-
firms this hypothesis by showing numerous routers transitioning
between those siteKeys. Interestingly, the analysis of SOCKS traffic
also links J3rjnv to this set. Additionally, this figure depicts the
sophistication level of the actor behind siteKey 4983e3, as this actor
hijacks vulnerable routers infected with numerous other siteKeys,
but subsequently changes his own siteKey to a masked variant, as
listed in Figure 9. Revisiting Figure 13, which shows 4 clear se-
quential blocks of 10 siteKeys having similar installation sizes and
evolutional patterns. This in combination with the aforementioned
figure, which shows 5 clear siteKey transition chains, an even larger
number of siteKeys can be linked to one single adversary. By fol-
lowing each siteKey within these transition chains in Figure 10,
we noticed that these transitions resemble transitions between the
sequential blocks in Figure 13. All the siteKeys in the transition
chains are located inside these blocks in the same sequence. For
each of the siteKeys inside these four blocks, the first two blocks
(highlighted in green in Figure 13) use a Coinhive miner, with the
uncommon option CoinHive.FORCE_EXCLUSIVE_TAB enabled, and
the latter two (highlighted in yellow) use Omine as a mining service.
Additionally, all 40 mining scripts within these blocks were set to
the same throttle value of 0.1. As a result, this common behavior
across multiple siteKeys strongly suggests that we can thus link
these 40 siteKeys to one single actor.
7 CONCLUSION
In this paper, we have reported on a new attack vector for crypto-
jacking, which does not infect websites but compromises Internet
infrastructure itself. This vector greatly overshadows any cryp-
tojacking campaigns known to date by orders of magnitude in
installation size, and we find groups of actors compromising a to-
tal of 1.4M vulnerable routers, approximately 70% of all deployed
MikroTik routers, with various degrees of sophistication. As the
injection of miners into network traffic affects any user visiting any
website, we find this attack vector to be highly profitable, estimated
to exceed $1,200,000 per month in revenue for the top 10 actors.
Curiously, we find that innovation and the first mover advantage
does not pay off in terms of revenue made. The highest grossing ac-
tors are not the ones creating new monetization options, deploying
sophisticated infrastructure or creating the largest deployment, but
those finding the most productive niche where they can operate
relatively undisturbed.
In April 2019, Interpol has begun an investigation into the cryp-
tojacking campaigns using MikroTik routers to investigate the
perpetrators, clean up the infected routers and take the supporting
infrastructure out of service [9]. To assist with this effort, the re-
search team has shared the results and additional outcomes with
the involved law enforcement agencies.
REFERENCES
[1] Agrawal, R., Srikant, R., et al. Fast algorithms for mining association rules.
In Proc. 20th int. conf. very large data bases, VLDB (1994), vol. 1215, pp. 487–499.
[2] Bijmans, H. L., Booij, T. M., and Doerr, C. Inadvertently making cyber criminals
rich: A comprehensive study of cryptojacking campaigns at internet scale. In
Usenix Security Symposium (2019).
[3] Bilge, L., and Dumitras, T. Before we knew it: An empirical study of zero-day
attacks in the real world. In ACM Conference on Computer and Communications
Security (2012).
[4] Blenn, N., Ghiette, V., and Doerr, C. Quantifying the spectrum of denial-
of-service attacks through internet backscatter. In International Conference on
Availability, Reliability and Security (ARES) (2017).
[5] Carlin, D., O’Kane, P., Sezer, S., and Burgess, J. Detecting cryptomining using
dynamic analysis. In Annual Conference on Privacy, Security and Trust (2018).
[6] Christopher, N. Hackers mined a fortune from indian websites, Sep
2018.
https://economictimes.indiatimes.com/small-biz/startups/newsbuzz/
hackers-mined-a-fortune-from-indian-websites/articleshow/65836088.cms (De-
cember 2018).
[7] Cimpanu, C. A mysterious grey-hat is patching people’s outdated MikroTik
routers, Oct 2018. https://www.zdnet.com/article/a-mysterious-grey-hat-is-
patching-peoples-outdated-mikrotik-routers/ (February 2019).
[8] Claburn, T. Crypto-jackers enlist google tag manager to smuggle alt-coin miners,
Jan 2018. https://www.theregister.co.uk/2017/11/22/cryptojackers_google_tag_
manager_coin_hive/ (December 2018).
[9] CSIRT, N. MikroTik Routers Compromised in Cryptojacking Campaign,
Apr 2019. https://csirt.cy/mikrotik-routers-compromised-in-cryptojacking-
campaign/ (April 2019).
[10] Durumeric, Z., Adrian, D., Mirian, A., Bailey, M., and Halderman, J. A. A
search engine backed by Internet-wide scanning. In 22nd ACM Conference on
Computer and Communications Security (Oct. 2015).
[11] Enge, E. Mobile vs Desktop Traffic in 2019, Apr 2019. https://www.stonetemple.
com/mobile-vs-desktop-usage-study/ (May 2019).
[12] Eskandari, S., Leoutsarakos, A., Mursch, T., and Clark, J. A first look at
browser-based cryptojacking. European Symposium on Security and Privacy
Workshops (2018).
[13] Ghiette, V., and Doerr, C. How media reports trigger copycats: An analysis of
the brewing of the largest packet storm to date. In ACM SIGCOMM Workshop on
Traffic Measurements for Cybersecurity (WTMC) (2018).
[14] Hoffman, J. J., Lee, S. C., and Jacobson, J. S. New jersey division of consumer
affairs obtains settlement with developer of bitcoin-mining software found to
have accessed new jersey computers without users’ knowledge or consent, May
2015. https://nj.gov/oag/newsreleases15/pr20150526b.html.
[15] Hong, G., Yang, Z., Yang, S., Zhang, L., Nan, Y., Zhang, Z., Yang, M., Zhang,
Y., Qian, Z., and Duan, H. How you get shot in the back: A systematical study
about cryptojacking in the real world. In SIGSAC Conference on Computer and
Communications Security (2018).
[16] Huang, D. Y., Dharmdasani, H., Meiklejohn, S., Dave, V., Grier, C., McCoy, D.,
Savage, S., Weaver, N., Snoeren, A. C., and Levchenko, K. Botcoin: Monetizing
stolen cycles. In 21st Annual Network and Distributed System Security Symposium,
NDSS 2014, San Diego, California, USA, February 23-26, 2014 (2014).
[17] Kharraz, A., Ma, Z., Murley, P., Lever, C., Mason, J., Miller, A., Borisov,
N., Antonakakis, M., and Bailey, M. Outguard: Detecting in-browser covert
cryptocurrency mining in the wild.
[18] Konoth, R. K., Vineti, E., Moonsamy, V., Lindorfer, M., Kruegel, C., Bos, H.,
and Vigna, G. Minesweeper: An in-depth look into drive-by cryptocurrency
mining and its defense. In SIGSAC Conference on Computer and Communications
Security (2018).
[19] MaxMind, Inc. MaxMind GeoIP2. https://www.maxmind.com/en/geoip2-
services-and-databases/ (April 2019).
[20] McCarthy, K. Cbs’s showtime caught mining crypto-coins in viewers’ web
browsers, Jan 2018. https://www.theregister.co.uk/2017/09/25/showtime_hit_
with_coinmining_script/ (December 2018).
[21] MineCryptoNight. MineCryptoNight - Making mining profits great again!
https://minecryptonight.net/ (May 2019).
A CENSYS DATASET MINING DETECTION
Table 7: Regular expressions used to detect mining code in
the Censys datasets
Regular expression
new CoinHive\.Anonymous
coinhive.com/lib/coinhive.min.js
authedmine.com/lib/ | coinhive | cnhv\.co
CRLT\.anonymous
webmine.pro/lib/crlt.js | cryptoloot
verifier.live/lib/crypta.js | crypta
coinimp | new CoinImp.Anonymous
new Client.Anonymous | scrip
freecontent.data | freecontent.date
hostingcloud.science | hashing\.win
srcips | freecontent.stream | priv\.su
omine\b | omineID
coinwebmining.com | cwm\.js | serv1swork
mining711 | gazanew
ecart\.html\?bdata= | amo\.js\"
mepirtedic\.com | gramombird\.com
tulip18\.com | mineralt\.io | dinorslick
istlandoll\.com | feesocrald\.com
besstahete\.info | nexioniect\.com
pampopholf\.com | feesocrald
minescripts\.info
coinpot | wait\.php
perfekt
webminepool\.com/lib/base\.js
WMP\.Anonymous
147\.135\.234\.198 | 91\.134\.24\.238
unescape | pastebin
[22] Murphy, M.
Youtube shuts down hidden cryptojacking adverts, Jan
https://www.telegraph.co.uk/technology/2018/01/29/youtube-shuts-
2018.
hidden-crypto-jacking-adverts/ (November 2018).
[23] Mursch, T. Over 100,000 drupal websites vulnerable to drupalgeddon 2 (cve-2018-
7600), Jun 2018. https://badpackets.net/over-100000-drupal-websites-vulnerable-
to-drupalgeddon-2-cve-2018-7600/.
[24] Nakamoto, S. Bitcoin: A peer-to-peer electronic cash system, 2009.
[25] NetLab360. Quick summary about the Port 8291 scan, Mar 2018. https://blog.
netlab.360.com/quick-summary-port-8291-scan-en/ (April 2019).
Miner type
Coinhive
[26] NIST National Vulnerability Database. NVD - CVE-2018-14847 Detail, Jul
2018. https://nvd.nist.gov/vuln/detail/CVE-2018-14847.
Cryptoloot
Coinimp
Omine
Webminer
Mineralt
Coinhave
Coinpot
Monero-mining
Webminepool
Obfuscated
[27] Papadopoulos, P., Ilia, P., and Markatos, E. P. Truth in web mining: Measuring
the profitability and cost of cryptominers as a web monetization model. CoRR
abs/1806.01994 (2018).
[28] Pastrana, S., and Suarez-Tangil, G. A first look at the crypto-mining malware
ecosystem: A decade of unrestricted wealth. CoRR abs/1901.00846 (2019).
[29] Proxy Lists 24. Proxy Lists 24 - Daily Free Proxy Server Lists. http://www.
proxyserverlist24.top/ (April 2019).
[30] Rauchberger, J., Schrittwieser, S., Dam, T., Luh, R., Buhov, D., Pötzels-
berger, G., and Kim, H. The other side of the coin: A framework for detecting
and analyzing web-based cryptocurrency mining campaigns. In International
Conference on Availability, Reliability and Security (2018).
[31] Rodriguez, J. D. P., and Posegga, J. RAPID: resource and api-based detection
against in-browser miners. Annual Computer Security Applications Conference
(2018).
[32] Rüth, J., Zimmermann, T., Wolsing, K., and Hohlfeld, O. Digging into browser-
based crypto mining. In Internet Measurement Conference (2018).
[33] Schwartz, M. J. Cryptojackers Keep Hacking Unpatched MikroTik Routers,
https://www.bankinfosecurity.com/cryptominers-keep-hacking-
Oct 2018.
unpatched-mikrotik-routers-a-11627 (April 2019.
[34] Segura, J.
A look into drupalgeddon’s client-side attacks, Jun 2018.
https://blog.malwarebytes.com/threat-analysis/2018/05/look-drupalgeddon-
client-side-attacks/ (December 2018).
[35] Shodan. Shodan - The search engine for Internet-connected devices. https:
//www.shodan.io/.
[36] SimilarWeb. Similar web. website traffic statistics & market intelligence. https:
//www.similarweb.com (May 2019).
[37] SonicWall. Massive cryptojacking campaign compromised ˜200,000 MikroTik
https://securitynews.sonicwall.com/xmlpost/massive-
routers, Aug 2018.
cryptojacking-campaign/ (March 2019).
[38] Tenable. MikroTik RouterOS Vulnerabilities: There’s More to CVE-2018-14847,
https://www.tenable.com/blog/mikrotik-routeros-vulnerabilities-
Oct 2018.
there-s-more-to-cve-2018-14847 (March 2019).
[39] The Monero Project. Monero: What is monero (xmr)? https://www.getmonero.
org/get-started/what-is-monero/ (December 2018).
[40] The Pirate Bay. The pirate bay-miner, Sep 2017. https://thepiratebay.org/blog/
242.
[41] Wang, W., Ferrell, B., Xu, X., Hamlen, K. W., and Hao, S. SEISMIC: secure
in-lined script monitors for interrupting cryptojacks. In Computer Security - 23rd
European Symposium on Research in Computer Security, ESORICS 2018, Barcelona,
Spain, September 3-7, 2018, Proceedings, Part II (2018), pp. 122–142.
[42] Wordfence.com. Wordpress plugin banned for crypto mining, Nov
https://www.wordfence.com/blog/2017/11/wordpress-plugin-banned-
2017.
crypto-mining/ (January 2019).
[43] Xu, J., Fan, J., Ammar, M., and Moon, S. B. On the design and performance of
prefix-preserving ip traffic trace anonymization. In ACM SIGCOMM Workshop
on Internet Measurement (2001).