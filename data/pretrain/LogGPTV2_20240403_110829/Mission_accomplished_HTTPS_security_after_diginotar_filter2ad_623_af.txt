therefore, deduce that most hosts only deploy one or two
protection mechanisms. This is also the case for mechanisms
which require minimal configuration effort and carry low
Mission Accomplished? HTTPS Security after DigiNotar
IMC ’17, November 1–3, 2017, London, United Kingdom
risk of accidentally making a site unavailable. Ultimately,
we find only 2 domains (sandwich.net and dubrovskiy.net)
to deploy all security mechanisms investigated in this work.
Unfortunately, the latter uses the StartSSL CA, which is now
distrusted by Chrome.
10.3 Top 10 Validation
We validate our findings for the Alexa Top 10 domains using
SSL Labs [58]. Table 12 shows the settings for the Alexa Top
10 domains. In line with our overall results, we find almost
universal support for SCSV, but only few domains deploy
CT, HSTS, or HPKP. Only google.com uses CAA and no
Top 10 domain deploys TLSA. We emphasize the high and
correct usage of SCTs as a TLS extension, caused by Google
domains. Please note that our investigation only looks at base
domains—redirects are not followed. As noted by Kranch and
Bonneau [42], the security extensions covered in this work
are required to work on the base domain, as any insecure
redirect can be exploited by attackers. Under this precept,
we do not attribute HSTS to domains that only use HSTS on
subdomains, such as in the case of google.com where HSTS
is supported for a lot of subdomains such as www.google.com,
but not the base domain (see section 6.2).
10.4 Correlating Effort, Risk, and Usage
We relate deployment effort, risk to site availability, and
measure deployment of technologies that have emerged after
the DigiNotar incident in Table 13.
We classify effort as follows: None, where the server ad-
ministrator has to take no action (e.g., SCSV, embedded
SCTs). Low applies where the operator has to enable an
extension, but no complex configuration is needed. E.g., this
applies to HSTS, as one can just copy a configuration string
from a tutorial. Medium applies where the operator needs
to make simple adjustments to instructions from manuals,
e.g., replacing the domain name or CA name, e.g., for CAA.
High effort is assigned where configuration requires careful
thought or multiple steps, e.g., for HPKP.
We classify availability risk as how easily misconfigurations
can lead to serious availability issues for a domain. We assign
none where no risk exists, and low to technologies that do not
offer much risk potential or are easy and quick to fix. Medium
applies to mechanisms that are more difficult to fix when
deployed incorrectly and can affect a large user base at once.
High is used for technologies that can harm availability for a
large user base and that are difficult and slow to remediate.
Examples are wrongly preloaded HPKP pins [69] and hostile
pinning, where an MITM attacker sends incorrect pins to
restrict user access [25].
Using this classification system, we see that technologies
with low effort and low risk to availability seem to hold a
bigger market share.
10.5
Our data suggests that security extensions with low (or no)
deployment effort and/or little risk to availability can quickly
Improving Deployment
SCSV
Domain
1 google.com
2 facebook.com
3 baidu.com
4 wikipedia.org
5 yahoo.com
6 reddit.com
7 google.co.in
8 qq.com1
9 taobao.com
10 youtube.com
1: No HTTPS support
✓
✓
✓
✓
✓
✓
✓
✗
✓
✓
HSTS
HPKP
CT
TLS
Preloaded
X.509 Preloaded Preloaded
X.509
✗
✗
✗
✗
✗
TLS
✗
✗
TLS
Preloaded
✗
Preloaded
✗
✗
✗
✗
✗
✗
✗
✗
Preloaded
✗
✗
Preloaded
CAA TLSA
✓
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
Table 12: Support of investigated techniques for the Alexa
Top 10 base domains as of April 2, 2017.
Effort
Availability
Mechanism Standard-
Deployment
Overall Top 10K↓
6789
49.2M
1788
7.0M
349
0.9M
27,759
171
156
6616
150
479
144 medium
23,539
20 medium
3057
973
3
0
191
SCSV
CT-x509
HSTS
CT-TLS
HPKP
HPKP PL.
HSTS PL.
CAA
TLSA
CT-OCSP
1: Preloading list first added to Chrome in 2012
2: Requires deployment effort on CA side and a new site certificate.
ized
2015
2013
2012
2013
2015
20121
20121
2013
2012
2013
none
none2
low
high
high
high
high
low
Risk
low
none
low
none
high
high
medium
low
medium
none
Table 13: Correlation of Age, #Deploying Domains, Effort
and Availability Risk of various HTTPS ecosystem security
extensions, sorted by Top 10K domains. Low effort and low
availability risk can drive wide-spread use.
gain market traction. This would support several hypotheses—
among them, administrators shying away from deployment
due to perceived effort or risk, or administrators not caring
enough about additional security, or possibly being unaware
of the new mechanisms. In either of these cases, it would
be essential to design new extensions with a view towards
minimal effort on the side of administrators. Changes in how
updates are shipped can help: Enabling certain mechanisms
by default, as done with SCSV in OpenSSL, could also be
extended to TLS enabled web servers by sending an HSTS
header by default; this approach is complementary to ef-
forts like Let’s Encrypt which can be automated to ensure a
server will always serve a valid certificate. Additionally, web
server software could facilitate successful deployment, e.g., by
providing tools to generate the correct HPKP configuration
directive to pin the currently used TLS key.
Our data suggests how pronounced the effect of big play-
ers pushing the deployment of security extensions can be.
Browser vendors, for example, can drive the ecosystem to-
wards the adoption of extensions, e.g., as Google has demon-
strated with CT. This is most effective when their interests
happen to align with those of the userbase, which is a non-
technical issue.
10.6 Multi-Site and Multi-Protocol Scans
For this work we conduct a multitude of active and passive
measurements, covering three continents and both IPv6 and
IMC ’17, November 1–3, 2017, London, United Kingdom
Amann, Gasser, Scheitle, Brent, Carle, Holz
IPv4. To the best of our knowledge, this is the first work with
such a diverse coverage. We examine how much additional
information can be learned from performing such a varied
array of scans, vs. only using more limited sources of data.
For active scans, we find the IPv4 results from Sydney and
Munich to be very much in line. While we encounter some
expected differences between the vantage points (like DNS
servers returning different A records), these differences are
very limited in scope: Only 15k out of 25M domains (.06%)
serve inconsistent HSTS or HPKP headers.
The same is true when comparing our IPv6 and IPV4
scans: while there are, as expected, fewer responses for IPv6,
domains that respond on both IPv4 and IPv6 are typically
configured consistently: Only 754 out of 1.09M dual-stacked
domains (.06% as well) serve different HSTS/HPKP headers.
Our conclusion is that multiple scans are useful for result
validation, but are only required for studies that seek in-depth
knowledge about how the HTTPS ecosystem presents itself
from different view points. Please note that our analysis only
compares HSTS and HPKP headers across domains — hosts
may still serve different content, present different certificates,
or exhibit different cryptographic algorithms, which were out
of scope in this work. These properties, along with a detailed
analysis of inconsistent domains [52], can be further analyzed
based on our shared raw data.
Even for passive monitoring, the measurements from our
three vantage points yield similar results. Again, having sev-
eral vantage points available still provides valuable validation.
Contrasting active and passive monitoring, we find our active
scans to yield more data points and, in some respects, to
allow for more in-depth analysis and more precise statements.
Some of our measurements are impossible using passive data:
e.g., HTTP headers are not visible in passive monitoring of
HTTPS. We emphasize, however, that passive monitoring
remains a valuable, complementary addition. It allows to
track uptake of new technologies by users, and we found in
our work that it is more likely to lead to discovery of oddities,
such as our discovery of connections to servers that imitate
TLS handshakes to well-known sites (see Section 5.3).
10.7 Limitations and Future Work
Our work takes some important design decisions on the
evaluation of domain-based security.
The first is to only look at domains that behave consistently
across different target and source IP addresses and protocols.
While very few domains fail this test, closer investigation of
inconsistent domains may reveal interesting insight.
The second is to only look at the base domain, i.e., not
prepending the www prefix, not following redirects, and only
evaluating headers of HTTP 200 domains. While it is critical
for domains to protect their base domain, which is the user’s
typical entry point, the correctness and behavior of redirects
into subdomains is another complex field of interesting study.
The third is the more systematic investigation of “parked”
domains, which, e.g., use the same invalid certificate for
millions of hosted domains. Carefully limiting the influence
of such clusters may further sharpen domain-based analysis.
10.8 Reproducible Research & Data Release
We aim for repeatable, replicable, and reproducible research
as defined by ACM [1, 64]. We publish all active scan data
(traces and/or result data), as well as the source code for
the utilities we used and created for this work. We can
not provide more detailed information about passively cap-
tured data for ethical and legal reasons. Hosting is pro-
vided by the TUM library for long-term availability at
https://mediatum.ub.tum.de/1377982
11 SUMMARY
A number of new security measures for the HTTPS ecosystem
have been developed in the five years since the compromise of
DigiNotar. While these techniques protect against a wealth
of different attacks and would have been able to prevent or
at least lessen the impact of the DigiNotar compromise, we
find that deployment is disappointing for most of them. Our
findings suggest a correlation between configuration effort, in-
curred risk to site availability, and actual deployment status.
Technologies that are easy to deploy and have little risk to
availability have the highest deployment (Certificate Trans-
parency and SCSV). Those that have either high deployment
effort or carry a high risk of misconfiguration have often low
deployment. We note that Certificate Transparency may be
a special case in our study: its deployment was massively
supported by a major corporation (Google) whose business
is heavily web-based and which also develops a very popu-
lar browser, hence allowing it to provide both client- and
server-side support.
Our findings would support the hypothesis that operators
consciously decide against deployment based on perceived
effort and/or incurred risk; but it would also be consistent
with a large faction of operators not caring enough about ad-
ditional security to invest the effort or simply being unaware
of available defenses for their sites. Empirical measurement
finds its limits here: a qualitative, interview-based follow-up
study may be advisable and reveal deeper insights why de-
ployment is lacking. As such, the mission to achieve HTTPS
ecosystem security is certainly not yet accomplished.
Acknowledgments:
This work was partially funded by the Major Equipment and Early
Career Researcher grant schemes of the Faculty of Engineering &
Information Technology, The University of Sydney; by the German
Federal Ministry of Education and Research under project X-
Check, grant 16KIS0530, and project DecADe, grant 16KIS0538;
by the National Science Foundation under grant numbers CNS-
1528156 and ACI-1348077. Any opinions, findings, and conclusions