ğ‘ â†$ â„°ğ‘ğ‘˜ (S)
ğ‘ â†$ ğ’â„°
For ğ‘— = 0, . . . , ğœ” do
W[ğ‘—] â†$ â„°ğ‘ğ‘˜ (W[ğ‘—])
W[ğ‘—] â†$ ğ’â„°
ğ‘ ğ‘› â† (ğ‘ğ‘˜, ğ‘, T, W, ğ›¾)
ğ‘â€² â†$ ğ’œSH (ğ‘ ğ‘›)
Return ğ‘ = ğ‘â€²
Figure 10: Games used in the proof of Theorem 5.2.
proc. main// ğº5 , G6
(ğ‘¤0, Ëœğ‘¤1, . . . , Ëœğ‘¤ğ‘›) â†$ ğ’¯
Â¯ğ‘ ğ‘› â†$ PChecker[Î ](ğ‘¤0, Ëœğ‘¤1, . . . , Ëœğ‘¤ğ‘›)
parse Â¯ğ‘ ğ‘› as (S, T, W, ğ›¾)
(ğ‘ğ‘˜, ğ‘ ğ‘˜) â†$ ğ’¦
For ğ‘– = 0, . . . , ğ‘¡
sağ‘– â†$ {0, 1}â„“salt
If sağ‘– âˆˆ {sa0, . . . , sağ‘–âˆ’1}
bad-sa â† true
sağ‘– â†$ {0, 1}â„“salt /{sa0, . . . , sağ‘–âˆ’1}
ğ‘ğ‘– â†$ ğ’E
T[ğ‘–] â† (sağ‘–, ğ‘ğ‘–)
ğ‘ â†$ ğ’â„°
For ğ‘— = 0, . . . , ğœ” do
W[ğ‘—] â†$ ğ’â„°
ğ‘ ğ‘› â† (ğ‘ğ‘˜, ğ‘, T, W, ğ›¾)
ğ‘â€² â†$ ğ’œSH (ğ‘ ğ‘›)
Return ğ‘ = ğ‘â€²
SH(sa â€– ğ‘¤) // ğº0, ğº1 ğº2,...,5 , ğº6
ğ‘Œ â†$ {0, 1}ğœ…
If SH[sa â€– ğ‘¤] =âŠ¥
If âˆƒğ‘– : (sa â€– ğ‘¤) = (sağ‘– â€– T[ğ‘–])
Return SH[sa â€– ğ‘¤]
SH[sa â€– ğ‘¤] â† ğ‘Œ
bad â† true; SH[sa â€– ğ‘¤] â† ğ‘Œ
ciphertexts in ğ‘ ğ‘› are random and independent of the salts and un-
derlying passwords, and so identically distributed to those used by
â„¬1â€™s RoR oracle). Next, â„¬1 encrypts S and the entries in W under
the public key ğ‘ğ‘˜, and assembles challenge state ğ‘ ğ‘› accordingly.
Finally â„¬1 passes ğ‘ ğ‘› to ğ’œâ€², simulating queries to SH by returning
a random bit string to each fresh query, and at the end of the game
outputs whatever bit ğ’œâ€² does. Notice that if ğ‘
= 1 and â„¬1 is re-
ceiving real encryptions from the RoR oracle then this perfectly
simulates G2, and if ğ‘
= 1 this perfectly simulates G3. It follows
that,
|Pr [ G2 â‡’ 1 ] âˆ’ Pr [ G3 â‡’ 1 ]|
â„¬1 â‡’ 1 | ğ‘
(â„¬1, ğ‘¡).
= |Pr
â‰¤ Advmkror
â„¬1 â‡’ 1 | ğ‘
âˆ’ Pr
= 1
= 0
(cid:103)
(cid:102)
(cid:103)
(cid:102)
|
â€²
â€²
â€²
â€²
SE
We can similarly show that the probability that bad is set in G3 is
close to the probability that it is set in G2 via a separate reduction
to the MKROR security of SE. Formally let â„¬2 be an adversary in
game MKRORâ„¬2
SE,ğ‘¡. â„¬2 constructs the simulated state ğ‘ ğ‘› as described
above, using its RoR oracle to compute the symmetric encryptions
in the state. However now when â„¬2 passes ğ‘ ğ‘› to ğ’œâ€², it watches
the queries ğ’œâ€² makes to SH. If there exists a query (sağ‘–|| Ëœğ‘¤ğ‘–) where
ğ‘– âˆˆ [0, ğ‘¡] such that Ëœğ‘¤ğ‘– is equal to the typo corresponding to position
ğ‘– in the cache (in which case the flag bad â† true), â„¬2 outputs 1;
(cid:102)
(cid:103)
else it returns 0. By the same argument made above, it follows that,
Pr [ bad = true in G2 ] â‰¤ Pr [ bad = true in G3 ]
|
= 1
(â„¬2, ğ‘¡) .
â€²
â„¬2 â‡’ 1 | ğ‘
â‰¤ Pr [ bad = true in G3 ] + Advmkror
â„¬2 â‡’ 1 | ğ‘
+ |Pr
âˆ’ Pr
= 0
(cid:102)
(cid:103)
â€²
SE
Â·
SE
SE
SE
SE
SE
SE
(cid:33)
(cid:32)
Advmkror
(â„¬, ğ‘¡) = 1
2 Â· (Advmkror
(â„¬1, ğ‘¡) + Advmkror
(â„¬1, ğ‘¡) + Advmkror
â‰¤ 2 Â· Advmkror
We may now define a third adversary â„¬ in game MKRORâ„¬,ğ‘¡
SE who
flips a bit and depending on the outcome runs either â„¬1 or â„¬2 and
then outputs the same bit as that adversary. It is easy to see that
(â„¬2, ğ‘¡)), and so it
Advmkror
follows that
|Pr [ G2 â‡’ 1 ] âˆ’ Pr [ G3 â‡’ 1 ]| + Pr [ bad = true in G2 ]
â‰¤ 1
2
(â„¬2, ğ‘¡)
+ Pr [ bad = true in G3 ]
(â„¬, ğ‘¡) + Pr [ bad = true in G3 ] .
Now we can define a game G4 which replaces all encryptions under
the public-key encryption scheme PKE with random ciphertexts,
where this transition is bounded by a reduction to the ROR security
of PKE. Formally we can define an adversary ğ’1 in game RORğ’1
â€² who proceeds as follows: on input ğ‘ğ‘˜, ğ’1 first
with challenge bit ğ‘
runs (ğ‘¤1, Ëœğ‘¤1, . . . , Ëœğ‘¤ğ‘›) â†$ ğ’¯ , Â¯ğ‘ ğ‘› â†$ PChecker[Î ](ğ‘¤, Ëœğ‘¤1, . . . , Ëœğ‘¤ğ‘›).
ğ’1 submits S and the elements in W to its RoR oracle, chooses ran-
dom symmetric ciphertexts and salts, and assembles the final state
including the public key ğ‘ğ‘˜ it was given as part of its challenge. ğ’1
then passes ğ‘ ğ‘› to ğ’œâ€², simulating queries to SH in the natural way,
and at the end of the game outputs whatever bit ğ’œâ€² does. Notice
= 0 then ğ’ receives real encryptions and this perfectly
that if ğ‘
(cid:102)
simulates G3; otherwise it perfectly simulates G4. It follows that,
|Pr [ G3 â‡’ 1 ] âˆ’ Pr [ G4 â‡’ 1 ]|
ğ’1 â‡’ 1 | ğ‘
PKE (ğ’1) .
= |Pr
â‰¤ Advror
ğ’1 â‡’ 1 | ğ‘
âˆ’ Pr
= 0
= 1
PKE
(cid:103)
(cid:102)
(cid:103)
|
â€²
â€²
â€²
Furthermore, an analogous argument to that made above implies
16
The TypTop System
CCS â€™17, October 30-November 3, 2017, Dallas, TX, USA
(cid:33)
(cid:32)
â‰¤ 1
2
Â·
that we can construct an adversary ğ’2 in the RORğ’2
PKE game against
PKE who simulates the final state ğ‘ ğ‘› using its RoR oracle, passes ğ‘ ğ‘›
to ğ’œâ€² and outputs 1 if and only if ğ’œâ€² sets the flag bad by guessing
one of the cached passwords. It follows that,
Pr [ bad = true in G3 ] â‰¤ Pr [ bad = true in G4 ] + Advror
PKE (ğ’2) .
With this in place, we may again define an adversary ğ’ in the
RORğ’
PKE game against PKEwho randomly chooses to run either ğ’1
or ğ’2, and outputs the same bit that they do. It follows that
|Pr [ G3 â‡’ 1 ] âˆ’ Pr [ G4 â‡’ 1 ]| + Pr [ bad = true in G3 ]
PKE (ğ’1) + Advror
PKE (ğ’2)
Advror
â‰¤ 2 Â· Advror
PKE (ğ’) + Pr [ bad = true in G4 ] .
+ Pr [ bad = true in G4 ]
Notice that in game G4 all values in the state ğ‘ ğ‘› given to ğ’œâ€² are
random and independent of ğ’¯ , and so the state ğ‘ ğ‘› may be perfectly
simulated by an adversary ğ’¢ in game OFFGUESSğ’¢,ğ‘
Î ,ğ’¯ ; we shall now
use a reduction to this game to bound the probability that bad is set
in game G4. ğ’¢ generates a public / secret key pair (ğ‘ğ‘˜, ğ‘ ğ‘˜) â†$ ğ’¦,
assembles the remainder of ğ‘ ğ‘› by choosing the appropriate random
components, and passes ğ‘ ğ‘› to ğ’œâ€². Now each time ğ’œâ€² makes a new
query (sa|| Ëœğ‘¤) to SH such that sa âˆˆ {sa0, . . . , sağ‘¡}, ğ’¢ returns a fresh
random string to ğ’œâ€², and submits a query of the form (ğ‘–, Ëœğ‘¤) to its
Test oracle. Since by construction all salts are distinct, it follows
(cid:21)
that if ğ’œ makes ğ‘ queries to SH then ğ’¢ makes at most ğ‘ queries to
his Test oracle also. Therefore,
(cid:20)
Pr [ bad = true in game G4 ] = Pr
Î ,ğ’¯ â‡’ 1
OFFGUESSğ’¢,ğ‘
(ğ’¢, ğ‘) .
â‰¤ Advoffguess
Î ,ğ’¯
In game G5 we return SH to responding truthfully to oracle queries.
Since these values are no longer set during the construction of
challenge state ğ‘ ğ‘›, this does not affect the outcome of the game
and so |Pr [ G4 â‡’ 1 ] = Pr [ G5 â‡’ 1 ]| .
Finally in game G6 we return to sampling salts without replace-
ment. An identical argument to that made previously implies that,
|Pr [ G5 â‡’ 1 ] âˆ’ Pr [ G6 â‡’ 1 ]| â‰¤ (ğ‘¡ + 1)2
2â„“salt+1 .
ğ’œâ€²,ğ‘
Î ,ğ’¯ with challenge bit ğ‘ = 1.
Now G6 is identical to game OFFDIST
Putting all this together, we conclude that,
Advoffdist
Î ,ğ’¯ (ğ’œ) â‰¤ Advoffguess
Î ,ğ’¯
+ 2 Â· Advrob
SE (â„›) + 2 Â· Advror
(ğ’¢, ğ‘) + 2 Â· Advmkror
PKE (ğ’) +
(ğ‘¡ + 1)2
2â„“salt
(â„¬, ğ‘¡) +
(ğ‘¡ Â· (ğ‘› + 1) + 1)2
SE
2(ğœ…âˆ’1)
A.4 Proof of Theorem 5.3
Before giving the full proof of Theorem 5.3, we begin by proving a
useful lemma which we will use in subsequent analysis.
Lemma A.1. Let {ğ‘1, . . . , ğ‘ğ‘›} and {ğ‘¥1, . . . , ğ‘¥ğ‘›} be sequences of
numbers such that each ğ‘ğ‘–, ğ‘¥ğ‘– âˆˆ [0, 1] and ğ‘1 â‰¥ ğ‘2 â‰¥ Â·Â·Â· â‰¥ ğ‘ğ‘›.
Then
ğ‘›(cid:88)
ğ‘–=1
ğ‘ğ‘– Â· ğ‘¥ğ‘– â‰¤ ğ‘Ÿ(cid:88)
ğ‘–=1
 ğ‘›(cid:88)
ğ‘–=1
 .
ğ‘ğ‘– where ğ‘Ÿ =
ğ‘¥ğ‘–
ğ‘–=1 ğ‘¥ğ‘–
ğ‘–=1 ğ‘¥ğ‘– +
(cid:80)ğ‘›
Proof: Since ğ‘1 â‰¥ Â·Â·Â· â‰¥ ğ‘ğ‘›, the rearrangement inequality [13] im-
ğ‘–=1 ğ‘ğ‘– Â· ğ‘¥ğ‘– is maximized when the ğ‘¥ğ‘– are such that ğ‘¥1 â‰¥
ğ‘¥2 â‰¥ Â·Â·Â· â‰¥ ğ‘¥ğ‘›, so to upper bound this sum, we reorder them so this
is the case. Notice that since ğ‘Ÿ =
ğ‘–=ğ‘Ÿ+1 ğ‘¥ğ‘–,
this implies that,
plies that(cid:80)ğ‘›
ğ‘¥ğ‘– â‰¥ ğ‘›(cid:88)
ğ‘Ÿ âˆ’ ğ‘Ÿ(cid:88)
ğ‘ğ‘– Â· (1 âˆ’ ğ‘¥ğ‘–) â‰¥ ğ‘ğ‘Ÿ Â· ğ‘Ÿ(cid:88)
ğ‘Ÿ(cid:88)
ğ‘ğ‘– Â· ğ‘¥ğ‘– .
inequality since(cid:80)ğ‘Ÿ
ğ‘–=1
The first inequality follows since ğ‘1 â‰¥ Â·Â·Â· â‰¥ ğ‘ğ‘Ÿ. The second
ğ‘–=ğ‘Ÿ+1 ğ‘¥ğ‘–. The final inequality
follows since ğ‘ğ‘Ÿ â‰¥ Â·Â·Â· â‰¥ ğ‘ğ‘›. Finally rearranging yields,
(cid:107)
â‰¥(cid:80)ğ‘Ÿ
(1 âˆ’ ğ‘¥ğ‘–) â‰¥ ğ‘›(cid:88)
ğ‘¥ğ‘– â‰¥ ğ‘›(cid:88)
(cid:106)(cid:80)ğ‘›
ğ‘¥ğ‘– â‡’ ğ‘Ÿ(cid:88)
(1 âˆ’ ğ‘¥ğ‘–) â‰¥ ğ‘ğ‘Ÿ Â· ğ‘›(cid:88)
With this in place, it follows that