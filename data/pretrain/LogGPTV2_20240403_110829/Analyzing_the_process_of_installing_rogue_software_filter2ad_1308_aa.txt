title:Analyzing the process of installing rogue software
author:Robin Berthier and
Jorge Arjona and
Michel Cukier
978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
560
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:37:13 UTC from IEEE Xplore.  Restrictions apply. 
Analyzing the Process of Installing Rogue SoftwareRobin Berthier*, Jorge Arjona‡*, and Michel Cukier**Center for Risk and ReliabilityDepartment of Mechanical EngineeringUniversity of Maryland, College Park, MD, USA{robinb, jorarar, mcukier}@umd.edu‡Escuela Técnica Superior de Ingenieros deTelecomunicaciónUniversidad Politecnica of Valencia, Spainjorarar@teleco.upv.esAbstractThis practical experience report presents the resultsof an experiment aimed at understanding the sequenceof malicious actions following a remote compromise.The type of rogue software installed during attacks wasused to classify and understand sequences of maliciousactions. For this experiment, we used four Linux targetcomputers running SSH with simple passwords. Duringthe eight-month data collection period, we recorded atotal of 1,171 attack sessions. In these sessions,attackers typed a total of 20,335 commands that wecategorized into 24 specific actions. These actions wereanalyzed based on the type of rogue software installedby attackers.1. IntroductionMost security analysis experiments focus on methodsfor keeping attackers out of target systems, but do littleto address their behavior after a remote compromise. Inthis experiment, we focused exclusively on post-compromise attacker behavior. More specifically, wefocused on the attackers’ actions that led to theinstallation of rogue software. We used four Linux target computers running SSHwith simple passwords. During the eight-month datacollection period, we recorded 1,171 attack sessions. Inthese sessions, attackers typed 20,335 commands thatwe categorized in 24 specific actions. These actionswere analyzed to determine attackers’ patterns andunderstand their motivation. Finally, we analyzed andclassified the rogue software downloaded, installed andrun on the target computers.The paper is structured as follows. Section 2describes the experimental setup used to collect theattack data. In Section 3, we discuss the analyses on theattack data, we present the attackers’ action, and therogue software that was downloaded, installed and runon the target computers. Section 4 discusses the relatedwork. Finally, we present conclusions in Section 5.2. Experimental SetupTo collect our data, we used a set of four high-interaction Linux honeypot computers on a sealed-offnetwork that allowed all incoming connections, butseverely limited outgoing connections to minimizedamage by the attackers. The IP addresses of thesehoneypots were never advertised. The four honeypots allran on an identical Linux disk image: a slimmed-downinstallation of Fedora Core 3. To monitor attackeractivity, we used the following tools: a modifiedOpenSSH server to collect password attempts, syslog-ng[2] to remotely log important system events, includinglogins and password changes, strace [3] to record allsystem calls made by incoming SSH connections, andthe Honeynet Project's Sebek tool [4] to secretly collectall keystrokes on incoming SSH connections. Eachhoneypot had one privileged root account plus five non-privileged user accounts. For additional details on theexperimental setup, refer to [1]. 3. Analyzing the AttacksThe first step of our analysis was to divide theinformation we collected into different attacks andsessions. We assumed that each IP address over a timewindow of 24 hours corresponded to an attacker. Wedefined an attack to be all interactions between anattacker and a honeypot. We then defined a session as asingle SSH interaction between an attacker and ahoneypot. We extracted a total of 1,171 differentsessions. Differentiating attacks from sessions isimportant because we discovered that some attackers978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
561
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:37:13 UTC from IEEE Xplore.  Restrictions apply. 
978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
562