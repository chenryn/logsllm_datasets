5 Preemptive Domain Filtering Scheme
The hazardous paths generated by the scheme proposed in
Section 3 could be used to improve user protection. In this
section, we propose a preemptive domain ﬁltering scheme
based on the risk level evaluation of domains on the hazardous
paths.
Malicious URLs are included in blacklists; however, there
are non-blacklisted URLs that lead to malicious URLs. We
refer to domains that have high probability of leading to
malicious URLs as hazardous domains. Access to malicious
URLs can be minimized by identifying such domains and
taking countermeasures, e.g., adding the domains to blacklists
or alerting users. Figure 6 shows the concept of the proposed
preemptive domain ﬁltering scheme. In this ﬁgure, an access
path tree consisting of multiple access paths that reach
seven different URLs is described, and four of the URLs are
included in a blacklist. The proposed scheme calculates the
probability of reaching malicious URLs from a domain and
identiﬁes the domain as hazardous if the probability is greater
than a certain threshold value. Accesses through domains B
and C reach only blacklisted URLs; thus they are regarded
USENIX Association
23rd International Symposium on Research in Attacks, Intrusions and Defenses    101
domain Adomain Bdomain Ddomain EURL 4URL 2(blacklisted)URL 7(blacklisted)URL5(blacklisted)domain CURL1(blacklisted)URL 3URL 6Hazardous domainIdentifying hazardous domains
5.1
We evaluated risk levels of all domains on hazardous paths
using the proposed preemptive domain ﬁltering scheme. Table
7 shows the top 10 newly identiﬁed domains with a risk level
above 50%, and Table 8 shows those with a risk level of 100%
over 12 months. Note, domains already identiﬁed by GSB
have been excluded. The maximum risk level column shows
the maximum value of monthly risk levels of a domain during
the 12 months, while the number of months column shows
the number of months the domain appeared on hazardous
paths5. As can be seen, the proposed scheme can identify
non-blacklisted domains that most likely navigate users to
malicious URLs.
Table 9 shows the breakdown of the number of domains
on hazardous paths by risk levels. To protect users, if the risk
level of a domain is above a certain threshold, we could ﬁlter
trafﬁc on a domain or issue alerts. If the threshold is set to
80%, 355 domains are identiﬁed as hazardous domains in
addition to 619 domains that have already been identiﬁed by
GSB.
5.2 Blocked URLs
By enforcing the proposed preemptive domain ﬁltering
scheme and blocking access
to hazardous domains,
some URLs will become unreachable. To determine the
effectiveness of the blocking, we identiﬁed URLs that would
have been blocked if we have enforced the scheme using the
dataset. Note that the scheme needs to know the threshold
value to identify hazardous domains that need to be ﬁltered
as we have seen in Section 5.1, and we set the value to 80%
in this section. URLs that became unreachable fall into one
of the following types.
1. Blacklisted URLs: The proposed scheme blocks
accesses to the hazardous domains that are located on
the way to the blacklisted URLs. Therefore, users cannot
reach the URLs, though access to these URLs are anyway
blocked by the existing blacklists. Note that we used
GSB for the blacklist, but other blacklists can be used in
place of GSB to select domains for preemptive ﬁltering.
2. URLs included in other blacklists: These were not
blacklisted by GSB but were known to be malicious
by the other blacklists. Here, we used a proprietary
blacklist that identiﬁes malicious URLs based on the
signatures on URL strings. However, the number of
these URLs remains small. We conjecture it is because
policies of blacklists differ each other on what is
detected as malicious. Indeed, GSB identiﬁes more
social-engineering type URLs and less malware-related
URLs than the proprietary blacklist we used.
5Note that the GSB periodically revises the evaluation results of
blacklisted entries.
3. Non-blacklisted URLs whose domains are the same
as the blacklisted URLs: It may take some time for the
GSB to register a malicious URL; therefore the URL
may not be registered when a user visits it. These URLs
will or should be blacklisted. Sometimes, its domain
instead of the URL could be registered on the blacklist.
already
unreachable at the time of writing this paper. Malicious
URLs often disappear after a period of time. Therefore,
the likelihood that these URLs are malicious is not too
small.
4. Unreachable URLs: These URLs
are
5. URLs with illegitimate or harmful content: Many of
the blocked URLs that do not fall into any of the above
four categories deal with pornography, scanned manga
and books, and music and video ﬁles. None of these
URLs are listed in the Alexa Top 1,000 sites on a global
basis [7] during the entire observation period. Although
the proprietary blacklist we used did not recognize
these URLs as malicious, determination of maliciousness
largely depends on the policy of each blacklist, and these
pages are not necessarily legitimate even if they are not
included in the blacklist. These pages are likely to be
irrelevant for the daily lives of most users. Therefore, the
impact of those pages becoming unreachable is limited.
These URLs that were made unreachable are either
malicious, unreachable, illegitimate, or harmful; thus blocking
them would help improve user protection without impairing
their legitimate activities.
6 Discussion and Analysis
Each technique has been discussed and evaluated in earlier
sections. This section discusses issues related to our data
collection and analysis approaches, limitation of our dataset,
and directions for further analyses.
6.1 Advantages of user-side data collection
The uniqueness of our overall approach stems from our
user-side data collection, which provides various data of
browser users that cannot be collected on the network. These
data provide two types of advantages: analytical efﬁciency
and access to user-side data.
1. Analytical efﬁciency: The collected data includes user
IDs and browser tab IDs. We can narrow down the
data we need to look into by ﬁltering with a user ID
and a browser tab ID. In this way, the complexity and
ambiguity of the data will be minimized, leading to more
accurate analysis. As a result, the cost and time required
for the analysis are also minimized.
2. Access to user-side data: We can obtain data that
are unavailable from data collected on the network,
102    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
Table 9: Evaluation of domains on hazardous paths (February 2019–January 2020)
Blacklist Number of domains
coverage
Risk level
100%
[80%-100%)
[60%-80%)
[40%-60%)
[20%-40%)
Others
Total
full
partial
none
partial
none
partial
none
partial
none
partial
none
partial
none
2019
Feb Mar Apr May
51
72
1
1
24
41
1
0
7
2
2
3
0
8
1
0
24
12
3
3
26
34
1
6
333
192
337
511
60
3
44
1
3
1
5
1
25
2
34
4
218
401
58
2
42
2
1
2
10
1
35
0
53
5
398
609
Jun
61
1
42
2
2
0
5
0
20
1
20
4
193
351
Jul Aug
289
28
0
3
53
69
1
2
1
4
4
6
11
11
0
6
29
23
2
3
30
36
1
5
250
250
407
710
Sep Oct Nov Dec
44
69
0
1
38
24
1
0
1
3
2
0
9
7
1
0
12
18
0
0
33
27
0
2
160
163
337
278
74
2
32
3
3
0
10
1
15
1
26
0
183
350
50
1
30
0
1
1
4
0
19
1
24
2
192
325
2020
Jan
47
1
28
2
1
1
4
1
14
1
22
1
173
296
Total
903
15
467
15
29
22
84
12
246
17
365
31
2,705
4,912
motivated to install the browser extension and continue using
it. We then prepared a web page where people can download
and install the browser extension. We also advertised our
data collection activities at large IT events. As can be seen
in Figure 1, the current approach was successful from the
standpoint of maintaining the number of active users, i.e.,
motivating users to continue using the browser extension.
6.3 Limitation of our dataset
The dataset we used has some limitations. When conducting
further analysis, these limitations should be considered.
First, the demographics of the users of the browser
extension are limited because we are distributing the browser
extension to people who like the Tachikoma character. People
who like Tachikoma tend to be familiar with IT; thus their use
of the web does not necessarily accurately represent behavior
of general web users. In addition, the browser extension and
its distribution page are only available in Japanese; thus the