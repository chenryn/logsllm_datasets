6000 times faster [68], and the Witty worm scanned even
faster at 3 megabytes/second [81]. This additionally hints
that Mirai was primarily powered by devices with limited
computational capacity and/or located in regions with low
bandwidth [3].
5 Ownership and Evolution
After the public release of Mirai’s source code in late
September 2016, multiple competing variants of the bot-
net emerged. We analyze the C2 infrastructure behind
Figure 6: Network Capacity Distribution—Scan duration,
probes, and bandwidth were extrapolated to reﬂect scanning
network capacity across the full IPv4 Internet. A majority of
probes scan below 250 Bps for over 2,700 seconds.
Mirai in order to uncover the relationships between strains,
their relative sizes, and the evolution of their capabilities.
5.1 Ownership
In order to identify the structure of Mirai command and
control servers, we turned to active and passive DNS data,
which we used to cluster C2 IPs and domains based on
shared network infrastructure. Seeding DNS expansion
with the two IPs and 67 domains that we collected by
reverse engineering Mirai binaries, we identiﬁed 33 inde-
pendent C2 clusters that shared no infrastructure. These
varied from a single host to the largest cluster, which con-
tained 112 C2 domains and 92 IP addresses. We show
the connectivity of the top six clusters by number of C2
domains in Figure 7. The lack of shared infrastructure be-
tween these clusters lends credence to the idea that there
USENIX Association
26th USENIX Security Symposium    1101
(cid:1)(cid:1)(cid:2)(cid:3)(cid:1)(cid:2)(cid:4)(cid:1)(cid:2)(cid:5)(cid:1)(cid:2)(cid:6)(cid:1)(cid:2)(cid:7)(cid:1)(cid:2)(cid:8)(cid:1)(cid:2)(cid:9)(cid:1)(cid:2)(cid:10)(cid:1)(cid:2)(cid:11)(cid:3)(cid:3)(cid:12)(cid:3)(cid:1)(cid:1)(cid:3)(cid:12)(cid:3)(cid:1)(cid:2)(cid:3)(cid:12)(cid:3)(cid:1)(cid:3)(cid:3)(cid:12)(cid:3)(cid:1)(cid:4)(cid:3)(cid:12)(cid:3)(cid:1)(cid:5)(cid:3)(cid:12)(cid:3)(cid:1)(cid:6)(cid:3)(cid:12)(cid:3)(cid:1)(cid:7)(cid:3)(cid:12)(cid:3)(cid:1)(cid:8)(cid:3)(cid:12)(cid:3)(cid:1)(cid:9)(cid:1)(cid:2)(cid:3)(cid:13)(cid:14)(cid:15)(cid:16)(cid:17)(cid:18)(cid:19)(cid:20)(cid:21)(cid:22)(cid:13)(cid:14)(cid:15)(cid:16)(cid:20)(cid:15)(cid:16)(cid:23)(cid:24)(cid:25)(cid:23)(cid:26)(cid:27)(cid:28)(cid:20)(cid:29)(cid:26)(cid:21)(cid:22)(cid:30)(cid:22)(cid:21)(cid:14)(cid:31)(cid:13)(cid:14)(cid:15)(cid:16)(cid:23)(cid:32)(cid:18)(cid:15)(cid:26)(cid:25)(cid:19)(cid:16)(cid:28)(cid:22)(cid:21)(cid:14)(cid:19)(cid:16)(cid:23)(cid:22)(cid:31)ID Max Lookup Vol. Notes
6
1
2
13
7
The original botnet. Attacked Krebs on Security, OVH
61,440 Attacked Dyn, other gaming related attacks
58,335
36,378 Attacked Lonestar Cell. Scans TCP/7547 and TCP/5555, removes DoD from blacklist, adds DGA
9,657 —
9,467
Scans TCP/7547
Table 8: Cluster Size Estimate and Characteristics—We highlight the top ﬁve clusters by max single-day lookup volume within
a large U.S. ISP, which provides an indicator of their relative size. Each cluster is additionally labeled with observed evolutionary
patterns and associated attacks.
While we cannot conclusively link each of these clus-
ters to distinct operators, we note that each cluster utilized
independent DNS infrastructure and evolving malware,
underscoring the challenge of defending against these
attacks through bespoke mitigations. Our results also
conﬁrm the recent ﬁndings of Lever et al., who observed
that the naming infrastructure used by malware is often
active weeks prior to its operation [54]. In all cases, the
ﬁrst occurrence of DNS/IP lookup trafﬁc for a cluster far
preceded the date that the domains were used as C2 in-
frastructure for the botnet. For example, even though the
peak lookup for cluster 2 occurred on October 21, 2016,
the ﬁrst lookup of a C2 domain in this cluster occurred
on August 1, 2016 (Table 8). This also signiﬁcantly pre-
dated the ﬁrst binary collected for this cluster (October 24,
2016), and the ﬁrst attacks issued by the cluster (Octo-
ber 26, 2016). These results suggest that careful analysis
of DNS infrastructure can potentially guide preventative
measures.
5.2 Evolution
Although the Mirai ecosystem exploded after the public
source code release on September 30, 2016, this was not
the botnet’s ﬁrst major evolutionary step. Between August
7, 2016 and September 30, 2016—when the source code
was publicly released—24 unique Mirai binaries were
uploaded to VirusTotal, which we used to explore the
botnet’s initial maturation. Several key developments oc-
curred during this period. First, we saw the underlying C2
infrastructure upgrade from an IP-based C2 to a domain-
based C2 in mid-September. Second, the malware began
to delete its executing binary, as well as obfuscate its pro-
cess ID, also in mid-September. We additionally saw a
number of features added to make the malware more vir-
ulent, including the addition of more passwords to infect
additional devices, the closing of infection ports TCP/23
and TCP/2323, and the aggressive killing of competitive
malware in a sample collected on September 29, 2016.
After the public release, we observed the rapid emer-
gence of new features, ranging from improved infection
capabilities to hardened binaries that slow reverse engi-
Figure 7: C2 Domain Relationships—We visualize related
C2 infrastructure, depicting C2 domains as nodes and shared
IPs as edges between two domains. The top six clusters by C2
domain count consisted of highly connected components, which
represent agile, long-lived infrastructures in use by botmasters.
are multiple active bot operators during our study period.
While Figure 7 provides a rough sense of Mirai C2 com-
plexity, it does not indicate the number of bots that each
cluster controlled. To estimate botnet membership, we
measured the DNS lookup volume per cluster. In Figure 8,
we show the top clusters of domains based on the volume
of DNS lookups at a large, name-redacted ISP. This sin-
gle perspective is not comprehensive, but it allows us to
observe the rise and fall of different botnets over time,
and may provide a hint of their relative sizes. A prime
example is cluster 1, which was the initial version of the
Mirai botnet involved in the early, high-proﬁle attacks on
Krebs on Security and OVH. Although it dominated in
lookup volume in late September and early October, it
gave way to newer clusters, 2 and 6, in mid-October. We
provide a list of the largest clusters by lookup and their
unique characteristics in Table 8.
1102    26th USENIX Security Symposium
USENIX Association
dmim.irbklan.ruangoshtarkhatam.iryouporn.wfdibamovie.bizdibamovie.siteip-51-255-103.euxex-pass.comdiamondhax.compiratetorrents.netanabolika.bzelektro-engel.destrongconnection.ccmoreoverus.comnamlimxanh.net.vnkleverfood.vntamthat.comamgauto.vnngot.netdacsanthitchua.comherokids.vnsantasbigcandycane.cxirisstudio.vnjoomlavision.comalexander-block.rulr-top.ruinfonta.ruavtotyn.rusert-cgb.ruigm-shop.ruosinniki-tatu.rufood-syst.rutaylor-lautner.ruupfarm.rudardiwaterjet.rugeneral-city.rutitata.ruvideo-girle.ruhotelkhiva.rufirstclaz-shop.rupornopokrovitel.rusl22.ruchildrens-health.rupoliklinikasp.ruvideostrannik.rudomisto.rupavelsigal.rurussianpotatoes.ruwwrf.rusims-4.rudaf-razbor.rutomlive.rustt-spb.rump3impulse.rusecurityupdates.uskia-moskva.rukiditema.ruavtoatelie-at.rudom-italia39.rushokwave.ruvkladpodprocenti.ru5153030.ruhyrokumata.compolycracks.comabsentvodka.commufoscam.organalianus.comrutrax.ruvoxility.orgvoxility.comvoxility.rovoxility.netvoxility.mobiinvestor-review.comxf0.pwgramtu.plq5f2k0evy7go2rax9m4g.rubebux.netip-149-202-144.eu69speak.euapkmarket.mobisteamcoin24.rukeycoins.rukeygolds.ruskincoin.ruwalletzone.ruplayerstore.ruskinplat.ruskincoin24.rukeyzet.rumuplay.rutradewallet24.rugamewallet.rukeydealer.rusteamon.rugowars.ruboatnetswootnet.xyztradewallet.ruteamcoin.rugameshoper.rugamegolds.rusillycatmouth.uskernelorg.downloaddisabled.racinglateto.workoccurelay.netdopegame.susipa.bebitcoinstats.combluematt.mebitnodes.ioelyricsworld.comemp3world.comboost-factory.cominfoyarsk.ruaodxhb.ruqlrzb.ruzogrm.ruzosjoupf.rutxocxs.runrzkobn.rumehinso.rufastgg.netalexandramoore.co.ukinfobusiness-eto-prosto.rutimeserver.hostparty-bar66.ruaaliya.rujealousyworld.rusony-s.ruagrohim33.ruwapud.rukinosibay.rugam-mon.rusvoibuhgalter.ruudalenievmiatin.rukopernick.ru5d-xsite-cinema.rubocciatime.rukvartplata1.rureceptprigotovlenia.rukunathemes.comchiviti.comintervideo.topintervideo.onlinesmsall.pkdyndn-web.comcheckforupdates.onlinemyfootbalgamestoday.xyzsrrys.pwtr069.onlinenovotele.onlinesoplya.comtr069.supportkciap.pwkedbuffigfjs.onlinemziep.pwbinpt.pwjgop.orgxpknpxmywqsrhe.onlinezugzwang.menuvomarine.comgettwrrnty.usrippr.clubnetwxrk.orgservdiscount-customer.comlayerjet.comproht.usmiddlechildink.comzeldalife.complaykenogamesonline.combrendasaviationplans.xyzthcrcz.topstbenedictschoolbx.orghexacooperation.come3ybt.topgrotekleinekerkstraat.nlcritical-damage.orgzvezdogram.com3200138.comipeb.bizblockquadrat.demy2016mobileapplications.technerafashion.comcenturystyleantiques.commadlamhockeyleague.comrealsaunasuit.comcloudtechaz.netdumpsterrentalwestpalmbeachfl....ok6666.nethappy-hack.rugermanfernandez.clkcgraphics.co.ukthqaf.comaddsow.topsemazen.com.trdoki.cokentalmanis.inforencontreadopoursitedetours.xyznextorrent.net2ws.com.brgeroncioribeiro.comgideonneto.comdrogamedic.com.brpontobreventos.com.brexpertscompany.comwoodpallet.com.brpontobreventos.comacessando.com.br2world.com.brescolavitoria.com.brcontroluz.com.brsistematitanium.combigdealsfinder.onlinemegadealsdiscounter.onlinesuperpriceshopper.onlinebestpricecastle.onlinebestsavingfinder.onlinestarpricediscounted.onlinegreatdealninja.onlinemegadealsfinder.onlinetopdealdiscounted.onlinesuperpriceshopping.onlineeduk-central.nethightechcrime.clubcheapkittensspecial.winyellowpuppyspecial.pwcheapestdogspecial.pw33catspecials.pwfinddogdeal.winyellowcatdeal.wincheapestdoggyspecial.pwfindcatspecial.win33puppiesspecials.winyellowpetsspecials.pwgreendoggyspecial.pw33catsdeal.pwcheapestdogspecials.win33kittensspecials.pwbluepuppiesdeals.pwgreenbirdsspecials.wingreenkittensdeal.pwbluepuppyspecial.pwfindbirdsspecials.pwnfoservers.comicmp.onlinexn----7sbhguokj.xn--p1aitransfer.clubadmin-vk.rufavy.clubxn--b1acdqjrfck3b7e.xn--p1aixn--80aac5cct.xn--80aswgta-bao.comdopegame.rudolgoprud.topocalhost.hostalcvid.comousquadrant.comprotopal.clubtr069.pw6969max.comserverhost.nameas62454.netspevat.netmwcluster.comedhelppro.bidsecure-limited-accounts.commediaforetak.comlottobooker.rupostrader.eurobositer.compostrader.itsiterhunter.compostrader.orgsecure-payment.onlinesecure-support.servicesssldomainerrordisp2003.comclearsignal.comip-151-80-27.euavac.ioip-137-74-49.euCluster 2Cluster 6Cluster 23Cluster 7Cluster 1Cluster 0Figure 8: C2 Cluster Lookup Volume—The DNS lookup volume of C2 DNS clusters in a large U.S. ISP establishes the relative
size of the botnet behind each cluster and chronicles its rise and fall. Note, for example, cluster 1 which represents the original botnet
in use for the early high proﬁle attacks on Krebs and OVH and the emergence of a myriad of clusters after the public source release.
neering efforts. Between November 2, 2016 and February
28, 2017, we observed 48 new sets of usernames and
passwords, as well as changes to the IP blacklist. We note
that while many actors modiﬁed the set of credentials,
they often did so in different ways (Figure 9). This is
true for other features as well. In one example, a variant
evolved to remove U.S. Department of Defense blocks
from the initial scanning blacklist. The malware further
evolved to use new infection mechanisms. Most notably,
in late November 2016, Mirai variants began to scan for
TCP/7547 and TCP/5555, two ports commonly associated
with CWMP [15, 93]. Additionally, one malware strain
began to using domain generation algorithms (DGA) in
the place of a hardcoded C2 domain, though this feature
was short lived. By November 2016, packed binaries had
emerged.
Techniques to improve virulence and to aide in relia-
bility were not simply limited to the client binaries. We
found evidence of operators using DNS to avoid or at-
tempt to evade detection as well. Recent work by Lever
et al. demonstrated how attackers abuse the residual trust
inherited by domains to perform many, seemingly un-
connected types of abuse [55]. Mirai was no different
from other types of malware—we found evidence that at
least 17% of Mirai domains abused residual trust. Specif-
ically, these domains expired and were subsequently re-
registered before they were used to facilitate connections
between bots and C2 servers. This serves as a reminder
that although Mirai is unique in many ways, it still shares
much in common with the many threats that came before
it.
By combining the malware we observed with our DNS
data, we can also measure the evolution of the C2 clusters
in Table 8. We note that cluster 2—the third largest by
lookup volume—evolved to support many new features,
such as scanning new ports TCP/7547 and TCP/5555,
adding DGA, and modifying the source code blacklist to
exclude Department of Defense (DoD) blocks. This is
not to say, however, that evolution guaranteed success.
Figure 9: Password Evolution—The lineage of unique pass-
word dictionaries, labeled with their associated clusters, depicts
many malware strains modifying the default credential list to
target additional devices. The node marked (*) indicates the
released source code password dictionary and serves as the
foundation for the all divergent password variants
Cluster 23, which can be seen clearly in Figure 9, evolved
very rapidly, adding several new passwords over its active
time. Despite this evolution, this cluster was 19th out of
33 clusters in terms of lookup volume over time and was
unable to capture much of the vulnerable population. We
also note that not all successful clusters evolved either; for
example, cluster 6, which showed no evolutionary trend
from its binaries, received the highest lookup volume of
all the clusters.
6 Mirai’s DDoS Attacks
The Mirai botnet and its variants conducted tens of thou-
sands of DDoS attacks during our monitoring period. We
explore the strategies behind these attacks, characterize
their targets, and highlight case studies on high-proﬁle
targets Krebs on Security, Dyn, and Liberia’s Lonestar
Cell. We ﬁnd that Mirai bore a resemblance to booter ser-
USENIX Association
26th USENIX Security Symposium    1103
(cid:1)(cid:2)(cid:3)(cid:2)(cid:1)(cid:1)(cid:4)(cid:3)(cid:2)(cid:1)(cid:1)(cid:5)(cid:3)(cid:2)(cid:1)(cid:1)(cid:6)(cid:3)(cid:2)(cid:1)(cid:1)(cid:7)(cid:3)(cid:2)(cid:1)(cid:1)(cid:8)(cid:3)(cid:2)(cid:1)(cid:1)(cid:9)(cid:3)(cid:2)(cid:1)(cid:1)(cid:1)(cid:10)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:8)(cid:1)(cid:12)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:8)(cid:2)(cid:1)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:8)(cid:2)(cid:2)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:8)(cid:2)(cid:4)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:8)(cid:1)(cid:2)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:9)(cid:1)(cid:4)(cid:11)(cid:1)(cid:2)(cid:11)(cid:2)(cid:9)(cid:1)(cid:2)(cid:3)(cid:4)(cid:5)(cid:6)(cid:7)(cid:1)(cid:8)(cid:9)(cid:10)(cid:11)(cid:11)(cid:12)(cid:13)(cid:14)(cid:15)(cid:13)(cid:14)(cid:15)(cid:16)(cid:17)(cid:18)(cid:19)(cid:20)(cid:15)(cid:16)(cid:21)(cid:22)(cid:13)(cid:2)(cid:4)(cid:6)(cid:7)(cid:8)(cid:9)(cid:2)(cid:2)(cid:2)(cid:5)(cid:2)(cid:7)(cid:4)(cid:6)Attack Type
HTTP ﬂood
UDP-PLAIN ﬂood
UDP ﬂood
ACK ﬂood
SYN ﬂood
GRE-IP ﬂood
ACK-STOMP ﬂood
VSE ﬂood
DNS ﬂood
GRE-ETH ﬂood
Attacks Targets Class
2,736
2,542
2,440
2,173
1,935
994
830
809
417
318
1,035 A
1,278 V
1,479 V
S
875
764
S
587 A
359
S
550 A
173 A
210 A
Table 9: C2 Attack Commands—Mirai launched 15,194 at-
tacks between September 27, 2016–February 28, 2017. These
include [A]pplication-layer attacks, [V]olumetric attacks, and
TCP [S]tate exhaustion, all of which are equally prevalent.
vices (which enable customers to pay for DDoS attacks
against desired targets), with some Mirai operators target-
ing popular gaming platforms such as Steam, Minecraft,
and Runescape.
6.1 Types of Attacks
Over the course of our ﬁve month botnet inﬁltration,
we observed Mirai operators issuing 15,194 DDoS at-
tack commands, excluding duplicate attacks (discussed
in Section 3). These attacks employed a range of dif-
ferent resource exhaustion strategies: 32.8% were vol-
umetric, 39.8% were TCP state exhaustion, and 34.5%
were application-layer attacks (Table 9). This breakdown
differs substantially from the current landscape of DDoS
attacks observed by Arbor Networks [7], where 65% of
attacks are volumetric, 18% attempt TCP state exhaus-
tion, and 18% are higher-level application attacks. While
ampliﬁcation attacks [79] make up 74% of attacks issued
by DDoS-for-hire booter services [40], only 2.8% of Mi-
rai attack commands relied on bandwidth ampliﬁcation,
despite built-in support in Mirai’s source code. This ab-
sence highlights Mirai’s substantial capabilities despite
the resource constraints of the devices involved.
6.2 Attack Targets
Studying the victims targeted by Mirai sheds light on its
operators. We analyzed the attack commands issued by
Mirai C2 servers (as detailed in Section 3) to examine who
Mirai targeted. In total, we observed 15,194 attacks issued
by 484 C2 IPs that overlapped with 24 DNS clusters (Sec-
tion 5). The attacks targeted 5,046 victims, comprised of
4,730 (93.7%) individual IPs, 196 (3.9%) subnets, and 120
(2.4%) domain names. These victims ranged from game
servers, telecoms, and anti-DDoS providers, to political
websites and relatively obscure Russian sites (Table 10).
The Mirai source code supports targeting of IPv4 sub-
nets, which spreads the botnet’s DDoS ﬁrepower across
an entire network range. Mirai issued 654 attacks (4.3%)
that targeted one or more subnets, with the three most
frequently targeted being Psychz Networks (102 attacks,
0.7%), a data center offering dedicated servers and DDoS
mitigation services, and two subnets belonging to Lones-
tar Cell (65 combined attacks, 0.4%), a Liberian telecom.
We also saw evidence of attacks that indiscriminately tar-
geted large swathes of the IPv4 address space, including