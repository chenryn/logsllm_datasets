行。
别忘了把报告带来！
老板
P.S.别穿得太不方便运动，我一直想把我家的
书柜整理一下..··
262
第6章
---
## Page 295
SELECT进阶
GirlSprout的饼干销售冠军问题
镇上的GirlSprout的领队想找出哪个女孩卖
销售饼干的Gitl Sprout
出了最多的饼干。她有一份女孩们每天的销
女孩娃名
销售收入
cookie_sales
销售日期
售量表。
√
ID
first_name
sales
sale_date
1
Lindsay
32.02
3-6-2007
我需要立即找出冠军。
2
Paris
26.53
3-6-2007
3
Britney
没有人喜次一个生气的
11.25
3-6-2007
4
Nicole
Girl Sprout。
18.96
3-6-2007
5
Lindsay
9.16
3-7-2007
6
Paris
1.52
3-7-2007
7
Britney
43.21
3-7-2007
8
Nicole
8.05
3-7-2007
9
Lindsay
17.62
3-8-2007
10
Paris
24.19
3-8-2007
11
Britney
3.40
3-8-2007
12
Nicole
15.21
3-8-2007
13
Lindsay
0
3-9-2007
14
Paris
31.99
3-9-2007
15
Britney
2.58
3-9-2007
16
Nicole
0
3-9-2007
17
Lindsay
2.34
3-10-2007
18
Paris
13.44
3-10-2007
19
Britney
8.78
3-10-2007
20
Nicole
26.82
3-10-2007
21
Edwina，很伤脑筋的
Lindsay
3.71
3-11-2007
22
Paris
.56
3-11-2007
Cil Sprout的领队
23
Britney
34.19
3-11-2007
24
Nicole
7.77
3-11-2007
25
Lindsay
16.23
3-12-2007
26
Paris
0
3-12-2007
27
Britney
4.50
3-12-2007
28
Nicole
19.22
3-12-2007
磨笔上阵
销售量最高的GirlSprout女孩将获得一套免费的马术课程。每个女孩都希
望赢得这项奖励，所以Edwina一定要找出正确的得奖者，以免奖励出现反
效果。
请使用你的ORDERBY子句设计一个可以协助Edwina找出得奖者的查
询。
当前位置
263
---
## Page 296
磨笔上阵解答
磨笔上
BG
解答
销售量最高的GirlSprout女孩将获得一套免费马术课程。每个女孩都希望
赢得这项奖励，所以Edwina
一定要找出正确的得奖者，以免奖励出现反
效果。
请使用你的ORDERBY子句设计一个可以协助Edwina找出得奖者的查
询。
SELECT sitst_name,sales
FROM cookie_sales
ORDER BY fitst_name;
这是我们的叠询
sales
..…这是查询结果。
first_name
Nicole
19.22
Nicole
0.00
Nicole
8.05
Nicole
26.82
96.03
Nicole
7.77
Nicole
15.21
Nicole
18.96
Britney
3.40
Britney
2.58
Britney
每个女孩的销售量还需要手
4.50
Britney
11.25
动加总后才能找出正确的赢
107.91
Britney
8.78
家。
Britney
43.21
Britney
34.19
Lindsay
17.62
Lindsay
9.16
Lindsay
0.00
Lindsay
32.02
81.08
Lindsay
2.34
Lindsay
3.71
Lindsay
16.23
Paris
26.53
Paris
0.00
Paris
0.56
Paris
1.52
98.23
Paris
13.44
Paris
24.19
Paris
31.99
264
第6章
---
## Page 297
SELECT进阶
SUM能为我们加总
数据还真不少，我们千万不能出错，不然小女孩的怒火可是非常可怕的。与其冒着
手动计算出错的危险，不如把这项工作交给SQL。
SQL语言中有些特殊关键字，称为函数（function）。函数是一段代码，可对数据值
执行操作。我们要示范的第一个函数就是对整列执行数学运算。SUM可把括号里指
定的列值全部加总。现在就来观察它的实际运作情况。
SUM函数金把sales列的值加
SUM是个面数。也就是说，
总。
它金对括号中出现的列采取
一些行动。
SELECT
SUM(sales)
FROMcookiesales
WHERE firstname=
：'Nicole'
WHERE子句限定了加总的范围，本例
只限于加总Nicole的销售量。若不限定，
你将得到整个列的总和。
>SELECT SUM(sales)FROM cookie sales
>WHERE first_name=.'Nicole'
SUM(sales)
96.031
rowinset（0.00sec)
现在还需要其他三个人的销售总和，一切就完成了。但如果能用一个
查询就完成，不是更完美吗.
回家试试看
自己试着创建一个像cookie_sales的表并插人一些浮点数值，然后用它尝试后续几页
的查询。
当前位置
265
---
## Page 298
GROUPBY和SUM、AVG合作愉快
利用GROUPBY完成分组加总
有个同时加总（SUM）每个女孩的销售量的方式：在SUM语句
中加上GROUPBY。在本例中，它会根据女孩的姓名分组，再对
各个组进行加总。
加总sales 列的所
K
有数据。
SELECT
first_name,
SUM(sales)
FROMcookie_sales
根据titst_name 值
GROUP BY first name
分组。
ORDER BY SUM(sales)DESC;
我们毒望查询结果能由高至
低排序，这样我才能轻易地
必须根据加总所用的
看出优胜老。
列排序。
上述语句根据名字分组，然
后分别加总每个人的销售量。
first_name
sales
sales
first_name
sales
Britney
Nicole
19.22
first name
3.40
first_name
sales
Lindsay
17.62
Britney
Nicole
0.00
2.58
Paris
26.53
Lindsay
9.16
Britney
8.05
4.50
Nicole
Paris
0.00
Lindsay
0.00
Britney
11.25
Nicole
26.82
Paris
0.56
Lindsay
Britney
32.02
8.78
Nicole
7.77
Paris
1.52
Lindsay
2.34
Britney
43.21
Nicole
15.21
Paris
13.44
Lindsay
Britney
Nicole
18.96
3.71
34.19
Paris
24.19
Lindsay
16.23
Paris
31.99
SELECT first_name,
SUM(sales)
FROM cookie_sales GROUP BY first_name
>
ORDER BY SUM(sales);
优胜老是
first_name|sum(sales）|
Btitney!
Britney
107.911
Paris
98.231
Nicole
96.03
Lindsay
81.081
rows in set （0.00 sec)
266
第6章
---
## Page 299
SELECT进阶
AVG搭配GROUPBY
没办法去骑马的女孩都很失望，所以Edwina决定为平均每日
销量最高的女孩增加一个奖项。她使用了AVG函数。
每个女孩都有7天的销售时间，所以AVG函数会分别把销售量
加总后再除以7。
同样地，我们再次根据
…但这次改为计算
fitst_name 分.....
平均值。
SELECT first
_name,AvG(sales)
FROMcookie_sales
GROUP BY first
name:
AVC先把组里的所有值加
总，再以值的数量均分总
值来求得平均值。
first_name
sales
firstname
sales
Nicole
19.22
first_name
Britney
sales
3.40
Nicole
0.00
first name
sales
Lindsay
17.62
Britney
2.58
Nicole
8.05
Paris
26.53
Lindsay
9.16
Britney
4.50
Nicole
26.82
Paris
0.00
Lindsay
0.00
Britney
11.25
Paris
0.56
Lindsay
Britney
Nicole
7.77
32.02
8.78
15.21
Paris
1.52
Lindsay
Britney
Nicole
2.34
43.21
Nicole
18.96
Paris
13.44
Lindsay
3.71
Britney
34.19
Paris
24.19
Lindsay
Paris
16.23
31.99
ow Heip TheWinnerReaillyls
SELECT
first_name,AvG（sales)
>FROMcookie
_salesGROUPBYfirst
_name;
糟糕，又是Britey获
first
奖了。我们得想办法找
name |AvG(sales)
出另一位赢家。
INicole
13.718571
|Britney
1
15.415714
|Lindsay
11.582857
Paris
14.032857
rowsinset(0.oosec)
当前位置
267
---
## Page 300
MIN和MAX也加入了
MIN和MAX
为了抓住每个机会，Edwina很快地检查了表中的最大（MAX）值
和最小（MIN）值，确认其他女孩是否曾有某天的销售量超越了
Britney，或者Britney曾有某天的销售量低于其他人.…
我们可以使用MAX函数来寻找列里的最大值，用MIN函数则可找出
列中的最小值。
MAX返回每个女孩
SELECT firstname,MAx（sales)
的最高销售量。
FROM cookie sales
GROUP BY first_name;
first_name
sales
Nicole
26.82
吸呀，Btitney 还
Britney
43.21
是拿到了单日销
Lindsay
32.02
售量的冠军。
Paris