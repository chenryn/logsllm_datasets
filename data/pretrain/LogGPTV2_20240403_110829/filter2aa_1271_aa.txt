$ S T A N D A R D _ I N F O R M A T I O N
$ F I L E N A M E
Windows取证分析 
海 报
你不能保护你不知道的东西
digital-forensics.sans.org
DFPS_FOR500_v4.9_4-19
Poster Created by Rob Lee with support of the SANS DFIR Faculty 
 ©2019 Rob Lee.  All Rights Reserved.
翻译：Leon(PI:EMAIL)
文件重命名
本地文件移动
卷文件移动
（通过命令行）
卷文件移动
（通过文件
管理器复制/粘贴)
文件复制
（只有Win7以后的
NTFS不改变）
文件访问
文件修改
访问时间-文件
创建时间
文件创建
文件删除
Windows 痕迹分析: 
...的证据：
UserAssist
描述
Windows系统从桌面启动的GUI程序在启动器中进行跟踪。
位置
NTUSER.DAT HIVE:   
NTUSER.DAT\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist\
{GUID}\Count
解释
所有的值是 ROT-13编码
•  GUID for XP
-  75048700
活动桌面
•  GUID for Win7/8/10
-  CEBFF5CD
可执行文件执行
-  F4E57C4B
快捷方式文件执行
Windows 10 时间线
描述
Win10在“时间线”中记录最近使用的应用程序和文件，可
以通过“WIN + TAB”键访问。 数据记录在一个SQLite数据
库中。
位置
C:\Users\\AppData\Local\ConnectedDevices 
Platform\L.\ActivitiesCache.db
解释
•  应用程序执行
• 每个应用程序的焦点数
RecentApps
描述
在Win10系统上启动的GUI程序执行可在“ RecentApps”键中
进行跟踪
位置
Win10:  
 NTUSER.DAT\Software\Microsoft\Windows\Current Version\Search
\RecentApps
解释
每个GUID键指向一个最近使用的应用程序。
AppID = 应用程序名称
LastAccessTime = UTC格式的最后执行时间
LaunchCount = 执行过的次数
Shimcache
描述
•  Windows使用Windows应用程序兼容性数据库来确定可执行文
件可能出现的应用程序兼容性挑战。
•  跟踪可执行文件的文件名、文件大小、上次修改时间以及
Windows XP中的上次更新时间
位置
XP:   
SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatibility
Win7/8/10:   
SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache
解释
在此注册表项中可以找到Windows系统上运行的任何可执行文
件。 您可以使用此键来识别系统执行了特定恶意软件。另外，
基于对时间数据的解释，您也许能够确定系统上执行或活动的
最后时间。
•  Windows XP包含最多96项
-  执行文件时更新LastUpdateTime
•  Windows 7包含最多1,024项
- Win7系统上不存在LastUpdateTime
跳转列表
描述
•  Windows 7任务栏（跳转列表）经过精心设计，可让用户快
速、轻松地“跳转”或访问他们经常或最近使用的项目。此功
能不仅可以包括最近的媒体文件； 它还包括最近的任务。
•  每个存储在AutomaticDestinations文件夹中的数据具有一个
唯一的文件，该文件前面带有关联应用程序的AppID。
位置
Win7/8/10:   
C:\%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent
\ AutomaticDestinations
解释
• 应用程序首次运行时间
-  Creation Time = 添加到AppID文件的第一个时间项
•  Last time of execution of application w/file open.
-  Modification Time = 添加到AppID文件的最后一条时间项
•  Jump List ID列表 ->
http://www.forensicswiki.org/wiki/List_of_Jump_List_IDs
Amcache.hve
描述
ProgramDataUpdater（与Application Experience Service关联的任
务）使用注册表文件Amcache.hve在进程创建期间存储数据
位置
Win7/8/10:   
C:\Windows\AppCompat\Programs\Amcache.hve
解释
•
•
 Amcache.hve – Keys = Amcache.hve\Root\File\{Volume GUID}\#######
每次可执行文件运行的记录、全路径信息、文件的
$StandardInfo的最后修改时间、可执行文件运行的原磁盘卷
• First Run Time = 键的最后修改时间
• 键中还包含可执行文件的SHA1哈希 
• 系统资源使用情况监视器
(SRUM)
描述
记录30至60天的历史系统性能。运行的应用程序、每次相关的
用户帐户、应用程序、每个应用程序每小时发送和接收的字节
数。
位置
SOFTWARE\Microsoft\WindowsNT\CurrentVersion\SRUM\Extensions 
{d10ca2fe-6fcf-4f6d-848e-b2e99266fa89} = Application Resource Usage Provider 
C:\Windows\ System32\SRU\ 
解释
使用如srum_dump.exe之类的工具来关联注册表键和SRUM 
ESE数据库的数据  
BAM/DAM
描述
Windows后台活动调度（BAM）
位置
Win10:   
SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID} 
SYSTEM\CurrentControlSet\Services\dam\UserSettings\{SID}
调查笔记
提供在系统上运行的可执行文件的完整路径以及上次执行的
日期/时间
Last-Visited MRU
描述
跟踪应用程序用来打开文件的可执行文件，记录在
OpenSaveMRU键中。另外，每个值跟踪应用程序访问的最后一
个文件的目录位置。
例如：Notepad.exe上次使用了C:\%USERPROFILE%\Desktop文
件夹
位置
XP:   
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\ 
LastVisitedMRU
Win7/8/10:  
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\ 
LastVisitedPidlMRU
解释
跟踪用于在OpenSaveMRU中打开文件的应用程序可执行文件以
及所使用的最后的文件路径。
Prefetch
描述
• 通过预加载常用应用程序的代码页来提高系统性能。缓存管理
器监视为每个应用程序或进程引用的所有文件和目录，并将它
们映射到.pf文件。用来了解系统上执行的应用程序。
•  XP和Win7上最多128个
• LWin8上最多1024个
• (exename)-(hash).pf
位置
WinXP/7/8/10:   
C:\Windows\Prefetch
解释
• 每个.pf文件都包括上次执行时间、运行次数以及程序使用的
设备和文件句柄
•  具有该名称和路径的文件的首次执行的日期/时间
- .pf文件的创建日期（-10秒）
•  具有该名称和路径的文件上次执行的日期/时间
- 嵌入.pf文件的最后执行时间
- .pf文件的最后修改日期（-10秒）
- Win8-10包含最后8次执行
程序执行
XP 搜索 – ACMRU
描述
您可以通过Windows XP计算机上的搜索助手来搜索各种信息。
搜索助手会记住用户对文件名，计算机或文件中单词的搜索
词。这是Windows系统上找到“搜索历史”的示例。
Location 
NTUSER.DAT HIVE 
NTUSER.DAT\Software\Microsoft\Search Assistant\ACMru\####
解释
• 搜索Internet – ####=5001
•  文件名的全部或者部分 – ####=5603
• 文件里单词或者用语 – ####=5604
• 打印机、计算机和人员 – ####=5647
Thumbcache
描述
图片、Office文件和文件夹的缩略图保存在一个叫做thumbcache
的数据库里。每个用户具有根据用户查看的缩略图大小(small, 
medium, large, 和extra-larger)区分的独立的数据库。
位置
C:\%USERPROFILE%\AppData\Local\Microsoft\Windows\Explorer
解释
•  这些是在用户将文件夹切换到缩略图模式或通过幻灯片查看图
片时创建的。 我们的缩略图现在存储在单独的数据库文件中。 
Win7以上版本有4种缩略图大小，并且缓存文件夹中的文件反
映了这一点：
- 32 -> small 
- 96 -> medium
- 256 -> large 
- 1024 -> extra large
•  缩略图缓存将根据缩略图的大小将图片的缩略图副本存储在相
应的数据库文件的内容中。
Thumbs.db
描述
计算机上有图片文件的目录中的隐藏文件，以较小的缩略图形
式存储。thumbs.db存储文件夹中的图片的缩略图副本，即使
这个图片被删除了。
Location
WinXP/Win8|8.1 
启用家庭组自动创建
 Win7/8/10  
在任何地方自动创建并通过UNC路径（本地或远程）访问
解释
包括:
• 原始图片的缩略图
• 文档缩略图-即使已删除
• 上次修改时间 (仅XP)
• 原始文件名 (仅XP)
IE|Edge file://
描述
关于IE历史记录的一个鲜为人知的事实是，历史记录文件中存
储的信息不仅与Internet浏览有关。 历史记录还记录了本地和
远程（通过网络共享）文件访问，这为我们提供了一种绝佳的
方式来确定每天在系统上访问哪些文件和应用程序。
位置 
Internet Explorer:
IE6-7 
%USERPROFILE%\LocalSettings\History\History.IE5
IE8-9 
• 在index.dat中存储为: file:///C:/directory/filename.ext
• 并不意味着文件已在浏览器中打开
Search – WordWheelQuery
描述
从Windows 7计算机上的“开始”菜单栏中搜索的关键字。
位置
Win7/8/10 NTUSER.DAT Hive 
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer
\WordWheelQuery
解释
关键字以Unicode添加，并按时间顺序在MRUlist中列出
Win7/8/10 回收站
描述
回收站是Windows文件系统上要知道的一个非常重要的位置。 在
完成取证调查时，它可以为您提供帮助，因为从Windows回收站
相关(aware)程序删除的每个文件通常都首先放入回收站中。
位置
隐藏的系统文件夹
Win7/8/10
. C:\$Recycle.bin
• 每一个删除恢复文件的删除时间和原始文件名包含在独立的
文件中
解释
•  可以通过注册表分析将SID映射到用户
•  Win7/8/10
-  包含以$I######开头的文件
• 原始路径和文件名
• 删除日期/时间
-  包含以$R######开头的文件
%USERPROFILE%\AppData\Local\Microsoft\WindowsHistory\History.IE5 
• 恢复数据
%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat
解释
Last-Visited MRU
描述
T跟踪应用程序用来打开OpenSaveMRU键中记录的文件的特定
可执行文件。 此外，每个值还跟踪该应用程序访问的最后一个
文件的目录位置。
位置
XP  
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\ 
LastVisitedMRU
Win7/8/10   
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\ 
LastVisitedPidlMRU
解释
跟踪用于在OpenSaveMRU中打开文件的应用程序可执行文件以
及所使用的最后的文件路径。
XP 回收站
描述
回收站是Windows文件系统上要知道的一个非常重要的位
置。 在完成取证调查时，它可以为您提供帮助，因为从
Windows回收站相关(aware)程序删除的每个文件通常都首先
放入回收站中。
位置
隐藏系统文件夹
Windows XP
•  C:\RECYCLER” 2000/NT/XP/2003
• 子文件夹使用用户的SID创建
• “INFO2”目录里的隐藏文件
• INFO2包含删除的时间和原始文件名
• 同时有ASCII和UNICODE文件名
解释
• 可以通过注册表分析将SID映射到用户
•  将文件名映射到实际名称以及原始的路径
删除的文件或文件知识
Open/Save MRU
描述
用最简单的术语来说，此键跟踪已在Windows Shell对话框中打开或保存
的文件。 这恰好是一个大数据集，不仅包括Internet Explorer和Firefox等
Web浏览器，而且还包括大多数常用的应用程序。
位置
XP:  