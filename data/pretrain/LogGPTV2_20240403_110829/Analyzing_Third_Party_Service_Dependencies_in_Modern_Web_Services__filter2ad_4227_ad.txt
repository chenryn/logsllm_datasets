ported HTTPS, which has increased to 69,725 websites in 2020.
23,196 additional websites have adopted HTTPS, and 11.9% of
these support OCSP Stapling in 2020. 5% of these which supported
OCSP stapling in 2016, existed in the top-100 including haosou.com,
naver.com, etc.
9.7% of the websites that supported HTTPS in 2016, have drop-
ping support for OCSP Stapling in 2020 as shown in Table 5, in-
cluding popular websites such as dropbox.com, wordpress.com, mi-
crosoft.com, etc. This trend increases across ranks, 7.5% of websites
in the top 100 as compared to 9.7% in the top 100K. We also observe
that 9.9% of the websites that supported HTTPS but did not have
OCSP stapling in 2016, have enabled OCSP stapling in 2020. Overall
in terms of critical dependence, we observe no significant change
in top-100K websites. However, in more popular websites we see
an increase in critical dependency.
4.2 Provider Concentration
Observation 7: 4 (out of 10K) DNS providers critically serve
50% of the top-100K websites, 2 (out of 86) CDNs critically
serve 50% of the websites that use CDNs, and 2 (out of 59) CAs
are critical dependencies for 50% of the websites that support
HTTPS.
640
IMC ’20, October 27–29, 2020, Virtual Event, USA
Aqsa Kashaf, Vyas Sekar, and Yuvraj Agarwal
(a)
(b)
Figure 5: Figure 5a, 5b and 5c show the dependency graph of the top-100K websites and third-party DNS, CDNs, and CAs respectively. The
size of a node is proportional to its indegree. We also label the concentration C and impact I of the top 5 providers in terms of the percentage
of total websites. A few DNS, CDN and CA providers serve a large number of websites.
(c)
At a high level, these results provide empirical confirmation of
observations and concerns in the community [28, 57].
Figure 5a shows the concentration and impact as defined in
Section 2.2, of major third-party DNS providers for the top 100K
websites, in terms of the percentage of websites. DNS ecosystem
is heavily concentrated, with just one DNS provider covering 23%
and the Top-3 DNS providers critically serving ≈ 40% of the top
100K websites.
However, there are subtle differences across popularity ranges.
For example, in Figure 5a the impact of CloudFlare shows that it
critically serves 23% of the websites in the top 100K. Although
we do not show here, it is not a major provider for more popular
websites. Dyn is the most popular in the top-100 websites with 17%
of the websites using Dyn and only 2% critically dependent on it.
Moreover, the difference in concentration and impact in Figure 5a
shows the degree of redundancy for the websites using a particular
provider. For instance, for CloudFlare, it is 1% (C-I = 24-23) of
websites. The near-complete lack of redundancy in CloudFlare’s
consumers is because it requires that DNS traffic is routed through
the CloudFlare network to protect against DDoS and other attacks.
This approach does not allow domains to register a secondary DNS
provider. Although we do not show here, we observe a higher
degree of redundancy in the consumers of Dyn, NS1, UltraDNS,
and DNSMadeEasy. This may be because these providers encourage
the use of secondary DNS provider by giving specific guidelines to
seamlessly incorporate a secondary DNS provider as also observed
by [4]. High redundancy for Dyn and NS1 customers could also
be a result of large-scale attacks on Dyn [24] and NS1 [5] also
independently observed by [1].
Figure 5b shows the major third-party CDN providers in the
top 100K websites. Our characterization of the top providers is
based on their concentration defined in Section 2 and not on how
much traffic they carry. We observe that the CDN market is also
heavily concentrated; Amazon CloudFront supports 30% of the
websites that use a CDN and the top 3 cover 56% of the websites
that use a CDN which is 18.6% of the top-100K websites. Amazon
CloudFront covers 30% of the websites in the top 100K that use a
CDN. However, Akamai which covers 18% of the top 100K websites
is more dominant in popular (top 100) websites as compared to
Amazon CloudFront.
Moreover, if we see redundancy per provider by subtracting im-
pact from concentration, we observe that very few websites using
CloudFront and CloudFlare are redundantly provisioned, as com-
pared to customers of Akamai or Fastly. We find that among top
providers, Akamai and Fastly support multi-CDN strategy and pro-
vide specific guidelines to enable it [58, 59]. However, unlike DNS,
using multiple CDNs does not always require provider support; e.g.,
when using CDN brokers [44]. As a result, there is a comparatively
higher degree of redundancy in the consumers of CDN providers
in contrast to DNS providers.
Finally, Figure 5c shows that there is also a significant concentra-
tion among CAs. 60% of the websites that support HTTPS (46.25%
of the top 100K websites) in the top-100K websites are critically
dependent on the top 3 CAs. DigiCert covers 32% of the top-100K
websites and 44% (which is not shown here) of the top 100 websites
that support HTTPS. Hence, it is equally popular across all ranks
of websites. In terms of OCSP stapling support per provider, we
observe that websites using Let’s Encrypt and Sectigo have higher
support for OCSP stapling as compared to other top providers like
DigiCert, Amazon, and GlobalSign.
Observation 8: Between 2016 to 2020, concentration in DNS
and CA providers has increased. However, concentration in
CDN providers has decreased.
Figure 6a shows that concentration in DNS providers has in-
creased as 54 providers serve 80% of the websites in 2020 as com-
pared to 2705 providers in 2016. The top 3 providers impacted 29.3%
of the top-100K websites in 2016. In contrast, in 2020, the top 3
DNS providers impact 40% of the top-100K websites. The set of
major DNS providers is roughly the same; in 2016 and 2020 the top
3 providers are CloudFlare, AWS DNS, and GoDaddy. Following the
Dyn incident, we also observe a reduced footprint of Dyn; i.e., the
concentration of Dyn has decreased from serving 2% of top-100K
websites in 2016 to serving 0.6% of top-100K websites in 2020.
Figure 6b shows that unlike DNS, concentration in CDNs has
marginally decreased in 2020. 5 CDNs serve 80% of the top-100K
641
Analyzing Third Party Service Dependencies in Modern Web Services: Have We Learned from the Mirai-Dyn Incident?
IMC ’20, October 27–29, 2020, Virtual Event, USA
Figure 6: The CDF of websites against the number of DNS providers can be seen in Figure 6a for 2016 and 2020, against the number of CDNs
is shown in Figure 6b, and against the number of CAs in Figure 6c. Between 2016-2020, concentration has increased in DNS and CA providers.
(c)
(a)
(b)
Dependency
𝐶𝐷𝑁 → 𝐷𝑁 𝑆
𝐶𝐴 → 𝐷𝑁 𝑆
𝐶𝐴 → 𝐶𝐷𝑁
Total
86
59
59
3rd-Party Dep. Critical Dependency
31 (36%)
27 (48.3%)
21 (35.5%)
15 (17.4%)
18 (30.5%)
21 (35.5%)
Table 6: For each dependency type, the table shows the number of
total dependencies, third party dependencies and critical dependen-
cies. Critical dependencies are also prevalent in service providers.
websites in 2020 as compared to 3 CDNs in 2016. It means that the
single points of failures in 2020 are smaller as compared to 2016.
The top 3 CDNs in 2020 cover 18.6% of websites, as compared to
20.8% of websites in 2020. The set of popular providers has some
minor churn; e.g., while CloudFlare was the top CDN provider in
2016, in 2020, Cloudfront has become the most popular provider as
its impact increased by 6% in 2020.
Figure 6c shows that concentration in CAs has increased in
2020, as compared to 2016 as 3 CAs serve 80% of the websites in
2020 as compared to 5 CAs in 2016. While the Top 3 CAs in 2016
impacted 26% of the top 100K websites, in 2020, the top 3 CAs
have an impact on 46.25% of websites. The top 3 providers have
also changed from 2016 to 2020. Symantec which was the third
most popular CA in 2016, has dropped off the top-3 list in 2020.1
Let’s Encrypt has become the second most popular provider in
2020, with an increase in impact from 2.4% in 2016 to 15% in 2020.
Sectigo, formerly Comodo, was the top provider in 2016, and we
see a decrease in its impact from 15% in 2016 to 9% in 2020.
5 Indirect Dependencies
In this section, we look at inter-service dependencies such as CDN
to DNS, or CA to DNS dependency. We analyze the following: 1)
Are critical dependencies present among service providers, as they
are for websites? 2) How do the indirect dependencies (defined in
Section 2.2) arising from critical inter-service dependencies affect
the third-party dependency of websites, and the concentration
among providers?
5.1 𝐶𝐴 → 𝐷𝑁 𝑆 Dependency
We find that out of the 59 CAs, 27 (48.3%) use a third-party DNS
provider. Of these 27 CAs, 18 (66.67%) use a third-party DNS provider
1Symantec CA business was bought by DigiCert [16]
(a)
(b)
Figure 7: Figure 7a and 7b show the top-5 3rd party DNS providers
in terms of concentration and impact respectively in the top-100K
websites when we consider 𝐶𝐴 → 𝐷𝑁 𝑆 and when we just consider
𝑊 𝑒𝑏 → 𝐷𝑁 𝑆 dependency. Indirect dependencies amplify provider
concentration and impact.
exclusively including top-3 CA providers DigiCert, Let’s Encrypt,
and GlobalSign. The use of specific 3rd party DNS providers by
these 18 CAs is less concentrated: 4 use Comodo DNS, 3 use Akamai,
and 3 use AWS DNS.
We find that three additional websites are dependent on a third
party as they use a private CA, which itself uses a third-party DNS.
These include godaddy.com, which uses GoDaddy CA but the CA
uses Akamai as DNS, trustwave.com, and wisekey.com which are
relatively lower ranked websites.
Observation 9: 72% of the websites are critically dependent on
3 DNS providers when we consider direct 𝐶𝐴 → 𝐷𝑁 𝑆 depen-
dency as compared to 40% when we just account for 𝑤𝑒𝑏𝑠𝑖𝑡𝑒 →
𝐷𝑁 𝑆 dependency
Figure 7a shows that the concentration of providers has increased
when we also consider 𝐶𝐴 → 𝐷𝑁 𝑆 dependency; e.g., in the case of
CloudFlare by 18%, as it serves Let’s Encrypt which is the second
major CA. Similarly, for DNSMadeEasy the increase is from 2% to
27% of websites since it is used by DigiCert which itself serves 32%
of the top-100K websites. Figure 7b highlights the change in impact
of providers. Overall, 72% of the websites are critically dependent
642
IMC ’20, October 27–29, 2020, Virtual Event, USA
Aqsa Kashaf, Vyas Sekar, and Yuvraj Agarwal
Private to Single Third Party
Single Third Party to Private
Redundancy to No Redundancy
No Redundancy to Redundancy
Critical dependency
1 (1.4%)
9 (12.8%)
2 (2.8%)
0 (0.0%)
-6 (-8.6%)
Table 7: Trends in 𝐶𝐴 → 𝐷𝑁 𝑆 dependency in 2016 vs. 2020. Critical
dependency decreased in 2020.
on just 3 DNS providers as compared to 40% of websites when we
just consider direct 𝑤𝑒𝑏𝑠𝑖𝑡𝑒 → 𝐷𝑁 𝑆 dependencies.
2016 vs. 2020: We observe a decrease in the critical dependency
of CAs in 2020. Out of the 70 CAs in 2016 data, 33 (47%) used a
third-party DNS provider and 24 (34.2%) were critically dependent
on it. In 2020, we find that 9 of these critically dependent CAs
(GeoTrust, Symantec, etc.) have moved to a private DNS, and 1 CA
(Trust Asia) has moved to a single third party DNS provider from
using a private DNS as shown in Table 7. Moreover, 2 redundantly
provisioned CAs (Digicert, Internet2) have moved to a single third-
party DNS. Overall, critical dependency has decreased by 8.6%
because 9 critically dependent CAs in 2016 have shifted to a private
DNS in 2020, while 3 have became critically dependent.
5.2 𝐶𝐴 → 𝐶𝐷𝑁 Dependency
Out of the 59 CAs that we observe, we find that 24 (40.6%) use
CDNs, and 21(35.6%) use a third-party CDN and use it exclusively.
These include major CAs such as DigiCert, Let’s Encrypt, Sectigo,
GlobalSign, etc. The critically dependent CAs cover 73.8% of the
websites using HTTPs. Akamai and CloudFlare are the dominant
CDNs that are used by 5 CAs each. As a result of this dependency,
32 additional websites now have a third-party dependency. Even
though they use a private CA, it in turn uses a third-party CDN.
This set includes many popular websites such as microsoft.com,
godaddy.com, xbox.com.
Observation 10: 56% of the websites are critically dependent
on 3 CDNs when we consider 𝐶𝐴 → 𝐶𝐷𝑁 dependency as com-
pared to 18% when we only consider 𝑤𝑒𝑏𝑠𝑖𝑡𝑒 → 𝐶𝐷𝑁 depen-
dency
Figure 8a shows that the concentration of CDNs has increased
when we also consider 𝐶𝐴 → 𝐶𝐷𝑁 dependency. For instance,
Cloudflare now covers 30% of the top-100K websites as compared
to 7% when we just consider 𝑤𝑒𝑏𝑠𝑖𝑡𝑒 → 𝐶𝐷𝑁 dependency, because
it is used by Let’s Encrypt which is the second major CA. Similarly,
the concentration of Incapsula has increased from 1% of websites to
27%, as it serves DigiCert which is used by 32% of the sites. Similarly,
Stackpath serves Sectigo which is the third major CA, and hence
we see an increase in its concentration from 2% to 16%. Figure 8b
shows that the impact of CDNs also increases significantly. Overall,
the top 3 CDNs in terms of impact have changed, previously the
top 3 CDNs covered 18% of the websites and now the top 3 CDNs
critically serve 56% of the websites.
2016 vs. 2020: We observe 70 distinct CAs in 2016 data of which
21(30%) used a CDN in 2016. Of these, 18 (25.7%) CAs used a third-
party CDN exclusively including major CAs such as GeoTrust, Glob-
alSign, Symantec, GoDaddy. In 2020, TeliaSonera CA has moved
from a third-party CDN to private in 2020, while three CAs have
(a)
(b)
Figure 8: The Figure 8a and 8b show the top-5 3rd party CDNs
in terms of concentration and impact respectively in the top 100K
websites when we consider 𝐶𝐴 → 𝐶𝐷𝑁 and when we just consider
𝑊 𝑒𝑏 → 𝐶𝐷𝑁 dependency. Indirect dependencies amplify provider
concentration and impact.
No CDN to Third Party CDN 3 (14.28%)