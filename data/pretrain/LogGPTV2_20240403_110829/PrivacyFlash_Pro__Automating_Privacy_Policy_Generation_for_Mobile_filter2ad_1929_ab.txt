### The Opacity of Third-Party Ad and Analytics Libraries

Third-party ad and analytics libraries often lack transparency, making it difficult for developers to manage and address the associated consumer risks [14]. Developer tools can help reduce the barriers for app developers to implement privacy and security best practices. For instance, FixDroid, an Android Studio plugin, highlights security- and privacy-related code issues, provides explanations, and suggests quick fixes [50]. Similarly, Coconut, another Android Studio plugin, identifies potential privacy problems and offers quick fixes [38]. The information provided by FixDroid and Coconut can serve as a starting point for writing the respective apps' privacy policies. PrivacyStreams, an implementation of a functional programming model for evaluating the access and processing of personal information in Android apps, also provides an API on top of the Android API to highlight privacy-related code usage, though it does not account for third-party libraries [39].

### Questionnaire-Based Policy Generators

Questionnaire-based policy generators guide developers through a privacy questionnaire to generate compliant privacy policies. We reviewed six popular generators: App Privacy Policy Generator [7], FreePrivacyPolicy [32], iubenda [35], PrivacyPolicies [53], Termly [69], and TermsFeed [70]. The market for these generators is small but growing, and we focused on those that cover mobile apps. During our evaluation, we found that TermsFeed, FreePrivacyPolicy, and PrivacyPolicies (referred to as "TermsFeed et al.") are provided by the same entity and generate identical policies. This relationship was confirmed by the operator, who also noted that TermsFeed is their primary offering. None of the reviewed generators have code analysis functionality.

#### Generator and Policy Selection

To collect policies from the questionnaire-based generators, we started with a Google search. For example, searching for "ios iubenda site:https://itunes.apple.com/" returned numerous results for iOS app policies generated with iubenda [35]. We collected policies based on the following criteria:
1. In English.
2. Associated with a free iOS app on the US App Store.
3. Linked from the app’s App Store page.
4. Hosted on the generator site or appearing to be generated with the generator.

To ensure the policies were indeed generated by the generators and not modified by developers, we relied on the hosting features offered by most generators. All generators except the App Privacy Policy Generator offer the option to host the generated policies on their servers, allowing them to update the policies in response to changes in the legal environment. Policies from the App Privacy Policy Generator include a reference disclosing that they were created at privacypolicytemplate.net and generated by the App Privacy Policy Generator. We also generated multiple policies from each generator to verify the absence of modifications. Excluding the policies we created, we collected a total of 95 policies from the App Privacy Policy Generator (20), iubenda (20), Termly (20), and TermsFeed et al. (35).

#### Privacy Policy Analysis

Generators must be designed to enable developers to generate compliant privacy policies and must be kept up to date with changing laws. All generators except the App Privacy Policy Generator advertised compliance with the CCPA, COPPA, and GDPR. However, our initial analysis in May 2020 revealed substantial shortcomings. For example, none of the generators created CCPA-compliant policies. Table I shows the compliance tallies for May 2020 and January 2021 after we contacted the generator operators. In May 2020, policies generated with Termly and TermsFeed et al. were only compliant with 3 and 5 out of 18 CCPA requirements, respectively. For instance, none of the policies generated with iubenda, Termly, or TermsFeed et al. provided a list of categories of personal information disclosed for business purposes in the preceding 12 months, as required by CCPA §1798.130(a)(5)(C).

The non-compliance was independent of the answers provided in the generators’ questionnaires. The design of the generators did not sufficiently accommodate the CCPA, which became effective on January 1, 2020, following a rapid lawmaking process. By January 2021, Termly and TermsFeed et al. had adapted their questionnaires, and their policies now comply with CCPA §1798.130(a)(5)(C). The higher levels of GDPR compliance in our first analysis could be attributed to the GDPR being effective since 2018 and its requirements being more general and traditionally included in privacy policies.

#### Privacy Compliance Analysis

Privacy policies are often lengthy, but they must accurately describe the actual behavior of the app. Misalignments between policies and apps can be misleading. We define a compliance issue as an app performing a privacy practice (e.g., using location data) while its privacy policy either fails to disclose it or discloses the opposite. Per the CCPA Regulations [Regs §999.308(a)(1)], the purpose of the policy is to provide consumers with a comprehensive description of online practices regarding the collection, use, disclosure, and sale of personal information. Clear and plain language is required, and not properly disclosing a practice can result in enforcement actions by the Federal Trade Commission [15 USC §45]. The Apple Developer Program License Agreement also requires developers to provide a privacy policy explaining the collection, use, disclosure, sharing, retention, and deletion of user or device data [9].

#### Permission Under- and Over-disclosures

We examined under- and over-disclosures of permissions used by apps and their integrated third-party libraries. These compliance issues can lead to significant discrepancies between the app's actual behavior and the privacy policy. Our findings, current as of May 2020, highlight the need for better alignment between app behavior and privacy disclosures.