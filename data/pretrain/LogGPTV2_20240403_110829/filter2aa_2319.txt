The Real-Life Story of the First Mainframe Container Breakout 
CROSSOVER EPISODE
 @IanColdwater
 @bigendiansmalls
‚Ä¢ Ian is a leading expert on containers and 
container security.
‚Ä¢ Chad is the same, but for mainframes and 
mainframe security.
MINNESNOWTA
 @IanColdwater
 @bigendiansmalls
DEEP MAGIC
 @IanColdwater
 @bigendiansmalls
HOW IT ALL BEGAN
 @IanColdwater
 @bigendiansmalls
LATER THAT WEEK
 @IanColdwater
 @bigendiansmalls
COMMON THREADS
 @IanColdwater
 @bigendiansmalls
WINTER PROJECT
 @IanColdwater
 @bigendiansmalls
THE LIMIT DOES EXIST
 @IanColdwater
 @bigendiansmalls
FORMAL STATEMENT FROM IBM
 @IanColdwater
 @bigendiansmalls
CONTAINERS ON A MAINFRAME?!
‚ÄúContainers?
On my mainframe?‚Äù
THIS IS A MAINFRAME
 @IanColdwater
 @bigendiansmalls
THIS IS ALSO A MAINFRAME
 @IanColdwater
 @bigendiansmalls
ZCX ARCHITECTURE
 @IanColdwater
 @bigendiansmalls
WHAT IS A CONTAINER?
 @IanColdwater
 @bigendiansmalls
HOW DID WE BREAK IT?
 @IanColdwater
 @bigendiansmalls
ASSEMBLING LAYERS
 @IanColdwater
 @bigendiansmalls
SPACE CAMP
 @IanColdwater
 @bigendiansmalls
GETTING TRAINED UP
 @IanColdwater
 @bigendiansmalls
https://evilmainframe.com
GETTING TRAINED UP
 @IanColdwater
 @bigendiansmalls
https://securekubernetes.com
TAKING OFF
 @IanColdwater
 @bigendiansmalls
ZCX PROVISIONING
 @IanColdwater
 @bigendiansmalls
FIRST LOOK
 @IanColdwater
 @bigendiansmalls
EXOTIC HACKER TOOLS
 @IanColdwater
 @bigendiansmalls
JOB LOG
 @IanColdwater
 @bigendiansmalls
VISIBILITY CLOAK
 @IanColdwater
 @bigendiansmalls
PATCHING THE BINARY
 @IanColdwater
 @bigendiansmalls
ECHO PRIVATEKEY.PEM
 @IanColdwater
 @bigendiansmalls
OPE, KEY IN THE LOGS
 @IanColdwater
 @bigendiansmalls
CONTAINER SETUP
 @IanColdwater
 @bigendiansmalls
WARNING LABEL
 @IanColdwater
 @bigendiansmalls
DOCKER IN DOCKER
 @IanColdwater
 @bigendiansmalls
ZCX DOCKER OUT OF DOCKER 
 @IanColdwater
 @bigendiansmalls
ZCXAUTHPLUGIN ERRORS
 @IanColdwater
 @bigendiansmalls
CLI RESTRICTIONS
 @IanColdwater
 @bigendiansmalls
ü¶ã  IS THIS PATTERN MATCHING?
 @IanColdwater
 @bigendiansmalls
CONTAINERS ARE HARD
 @IanColdwater
 @bigendiansmalls
BIND MOUNT RESTRICTIONS
 @IanColdwater
 @bigendiansmalls
DOCKER.SOCK
 @IanColdwater
 @bigendiansmalls
DOCKER ENGINE API
 @IanColdwater
 @bigendiansmalls
DEMO - MAKING CALLS
 @IanColdwater
 @bigendiansmalls
FIX THE COBOL!
 @IanColdwater
 @bigendiansmalls
BOOTING ZCX
 @IanColdwater
 @bigendiansmalls
BUT WHAT IS IT ‚Ä¶ REALLY?
 @IanColdwater
 @bigendiansmalls
CONTAINER SECURITY MODEL
APF SECURITY MODEL
 @IanColdwater
 @bigendiansmalls
WORLDS COLLIDING
 @IanColdwater
 @bigendiansmalls
PASSING THE BALL
 @IanColdwater
 @bigendiansmalls
WHAT ARE THESE ERRORS?
 @IanColdwater
 @bigendiansmalls
WTF SYSTEMD
 @IanColdwater
 @bigendiansmalls
THE SYSCALLS ARE COMING FROM INSIDE THE HOUSE
 @IanColdwater
 @bigendiansmalls
EXITS ON MAINFRAMES
 @IanColdwater
 @bigendiansmalls
WHY IS THIS BINARY SO BIG?
 @IanColdwater
 @bigendiansmalls
GOLANG BINARIES ARE THICC
 @IanColdwater
 @bigendiansmalls
BUILDING A  
MOON LAB
‚Ä¢ Improved bind mounts 
‚Ä¢ Disabled zcxauthplugin service 
‚Ä¢ Removed zcxauthplugin 
references from systemd 
‚Ä¢ Disabled userns remapping 
‚Ä¢ Added root backdoor 
‚Ä¢ Fixed sudoers Ô¨Åle
 @IanColdwater
 @bigendiansmalls
WHAT‚ÄôS NEXT
 @IanColdwater
 @bigendiansmalls
ZCXAUTHPLUGIN
 @IanColdwater
 @bigendiansmalls
CROSS MEMORY
 @IanColdwater
 @bigendiansmalls
DEMO - SHARED MEMORY
 @IanColdwater
 @bigendiansmalls
CLOSING REMARKS
 @IanColdwater
 @bigendiansmalls
REFERENCES
‚Ä¢ Getting Started with zCX 
‚Ä¢ zCX docs 
‚Ä¢ z/OS Overview 
‚Ä¢ z/OS Security book 
‚Ä¢ Container Security book 
‚Ä¢ Container Operator's Manual 
‚Ä¢ The dangers of docker.sock 
‚Ä¢ A Compendium of Container 
Escapes 
‚Ä¢ github.com/kelseyhightower/
nocode - the best way to write 
secure and reliable applications!
 @IanColdwater
 @bigendiansmalls