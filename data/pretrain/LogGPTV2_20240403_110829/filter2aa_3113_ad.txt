no outage 
down for 46 minutes 2013-09-26 
12:36 - 2013-09-26 13:22 
down for 46 minutes 2013-09-26 12:36 
- 2013-09-26 13:22 
no outage 
down for 46 minutes 2013-09-28 
16:19 - 2013-09-28 17:05 
down for 46 minutes 2013-09-28 16:19 
- 2013-09-28 17:05 
The fact that there are so many overlapping outages between AS57604 and AS29004 is unique and further proves 
there is a close relationship between these two sibling autonomous systems listed earlier. The table below lists all 
overlapping outages between each of the sibling autonomous systems as well as the upstream provider AS48361. 
24 
Table 10. Overlapping outages between sibling ASNs. 
57604 
8287 
50896 
49236 
29004 
45020 
44093 48949 
49720 50818 48361 
57604 
x 
20 
17 
12 
22 
16 
11 
24 
20 
13 
5 
8287 
20 
x 
41 
15 
17 
17 
15 
18 
18 
15 
5 
50896 
17 
41 
x 
17 
16 
17 
18 
19 
16 
18 
7 
49236 
12 
15 
17 
x 
8 
15 
13 
8 
12 
17 
3 
29004 
22 
17 
16 
8 
x 
12 
22 
28 
18 
9 
6 
45020 
16 
17 
17 
15 
12 
x 
12 
12 
12 
15 
4 
44093 
11 
15 
18 
13 
22 
12 
x 
16 
10 
13 
6 
48949 
24 
18 
19 
8 
28 
12 
16 
x 
20 
9 
8 
49720 
20 
18 
16 
12 
18 
12 
10 
20 
x 
10 
4 
50818 
13 
15 
18 
17 
9 
15 
13 
9 
10 
x 
4 
48361 
5 
5 
7 
3 
6 
4 
6 
8 
4 
4 
x 
Looking at the results in the table above it is clear that there is a high degree of duplicate outages between all sibling 
Autonomous Systems and to some degree between the sibling Networks hosting the malware and the upstream 
AS48361. 
When correlating the outage results with the earlier results in use case 1, we can see that there is indeed a strong 
relationship between all of the sibling Autonomous systems we found earlier. Not only do we now know they share a 
common upstream provider, we also know that there is a high degree of risk sharing between the networks. It is to be 
expected that when an outage affects the upstream ASN, one or more of the downstream networks will be affected 
as well, especially if the downstream provider is single-homed and relies solely on this upstream provider for network 
connectivity.  However in our data there are many cases where there is no outage for the upstream provider, while 
there are sometimes hour-long outages for the downstream networks of which the timelines overlap exactly up to the 
minute. 
The conclusions we can draw from this are that the set of autonomous systems we looked at most likely rely on the 
same infrastructure for connectivity. Normally an outage by a service provider may cause an outage for some 
customers, but typically only for those in a specific geographic location. The fact that there is so much correlation 
between the Autonomous systems we looked at is a strong indicator that they could be operated by the same 
organization, are in the same physical location, and could even share a joint routing infrastructure. So even though 
typically each Autonomous systems has its own infrastructure in terms of routing, switching and compute, our data 
indicates there are strong indicators that these autonomous systems could well be operated by the same organization 
or even run on the same hardware.  
25 
USE CASE 3: ROGUE ASN DE-PEERED OR GONE STEALTH 
In this section, we discuss one case among many we observed of rogue peripheral ASNs that serve various malware 
content. In this example, it is AS48031, XSERVER-IP-NETWORK-AS PE Ivanov Vitaliy Sergeevich 86400 that had a 
single upstream provider AS15626. AS48031 has been hosting browser-based ransomware, porn sites, spam, and 
radical forums. 
Figure 19. Browlock web page. 
Browser-based ransomware or “browlock” is a rudimentary ransomware that consists of an HTML page that loads 
when the user visits the browlock domain. It locks the browser screen (through HTML or JavaScript code) and 
demands payment, supposedly for either possession of illegal material or usage of illegal software [19]. This is more 
of a scam than real ransomware (which corrupts or encrypts user’s data), because the browlock alert can be 
neutralized by simply killing the browser task. Despite its simplicity, browlock has been around for a few years 
targeting several countries, and seems to be generating profit for the criminals. Browlock has been delivered by 
dedicated (domains specifically registered for malicious intent) as well as compromised domains. 
Table 11. Prefixes announced by AS48031 in Fall 2013. 
Prefixes 
176.103.48.0/20 
193.169.86.0/23 
193.203.48.0/22 
193.30.244.0/22 
194.15.112.0/22 
196.47.100.0/24 
91.207.60.0/23 
91.213.8.0/24 
91.217.90.0/23 
91.226.212.0/23 
91.228.68.0/22 
93.170.48.0/22 
94.154.112.0/20 
26 
In Table 8., we show the prefixes announced by AS48031 in the fall of 2013. A few months later, in January 2014, 
AS48031 stopped advertising prefixes and disappeared from the global routing table as Figure 20 shows. 
Figure 20. AS48031 disappears off the global BGP routing table. 
However, those prefixes did not actually disappear, and AS48031’s only parent in the AS graph, its upstream peer 
AS15626, took over announcing them as Figure 21 shows. The rogue IPs in those prefixes continued to host 
malware content. 
The question remains whether AS15626 had been abused by its downstream client AS48031 to host malware, and if 
it acted responsibly by ceasing to announce those prefixes when it took notice of the malicious content on AS48031 
prefixes, or if both AS48031 and AS15626 are complicit in hosting malware, and AS15626 is simply being evasive by 
hiding AS48031 from the global routing table and yet keeping connectivity to the rogue IPs by announcing their 
prefixes. There are several such suspicious cases occurring on the BGP routing space. 
27 
Figure 21. Former prefixes of AS48031 now announced by upstream AS15626. 
USE CASE 4: MALICIOUS SUB-ALLOCATED RANGES 
In this section, we summarize a study we conducted for 5 months between Oct 2013 and Feb 2014 that consisted of 
monitoring rogue sub-allocated ranges on OVH [20] IP space, where these ranges are reserved by recurring 
suspicious customers and used to serve Nuclear Exploit kit domains. In this type of infection, visitors are lead to the 
Exploit landing sites through malvertising campaigns, and then malware is dropped on victims’ machines (e.g. zbot). 
Results of the study were published in [21]. 
For several months, OVH IP ranges had been abused. Notably, the IPs were exclusively used for hosting Nuclear 
Exploit subdomains, with no other sites sharing the IPs. These IPs were reserved in small ranges from OVH Canada 
and set up with identical services (nmap fingerprint). Consulting ARIN’s referral whois database showed the reserved 
ranges and customer IDs. As an evasive measure, on Feb 7th, the bad actors moved to besthosting.ua, a Ukrainian 
hosting provider. RIPE’s whois service, which covers European IP space, does not always give details on reserved 
ranges and customers, but the Ukrainian IPs in this case were still set up with identical services. Therefore, we 
flagged them as prone to serve the same Nuclear campaign. On Feb 14th, the actors moved to a Russian provider, 
pinspb.ru, with a similar bulk IP range setup. On Feb 22nd, they moved back to OVH, notably changing their MO: 
the IPs being used have been allocated and used in the past for other content. This could be an evasion technique or 
resource recycling. 
However, although bad actors have migrated between hosting providers to host the Nuclear Exploit serving domains, 
they still kept the name server’s infrastructure (authoritative for the Nuclear domains) on ranges reserved on OVH by 
the same customers, which still allows us to track them. Thanks to the great collaboration with the non-profit security 
research group MalwareMustDie, a large number of Nuclear Exploit domains active at the time have been taken 
down [22]. 
28 
Subsequently, bad actors have been circulating between OVH and other hosting providers. Lately, compromised 
domains, especially GoDaddy domains, are being used to host Nuclear and Angler Exploit kit domains (as we will 
cover in Section 5). 
USE CASE 5: PREDICTING MALICIOUS DOMAINS IP INFRASTRUCTURE 
As part of the study described in the previous section, we have been monitoring IP ranges reserved on OVH Canada 
by the suspicious customer(s) who reserved the ranges hosting Nuclear EK domains. Table 3 shows the number of 
reserved ranges, the total number of IPs they represent and the number of IPs effectively used for malicious 
purposes during the months of December 2013, January, February and early March 2014. These IPs were used to 
host Nuclear Exploit kit domains, Nuclear domains’ name servers, and browlock domains. 
Table 12. IP ranges reserved by suspicious customers. 
Reservation dates 
No ranges 
No IPs 
No IPs used 
Dec 1st to 31st 2013 
28 
136 
86 
Jan 1st to 31st 2014 
11 
80 
33 
Feb 1st to 28th 2014 
4 
28 
26 
Mar 1st to 20th 2014 
Mar 7th 
Mar 10th 
43 
40 
3 