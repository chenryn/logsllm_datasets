A⊤B
1 !−1
and V := eV  B|b · a⊥ 0
Ω(p) over A, B ←R Dk,
0
.
.
A⊤B
i
0
0
0
0
0
0
sj
y(β)
j
y(β)
j
sm+j
y(0)
j
0
γrn+i
−z · x(0)
γri
z · x(β)
i
x(β)
i
0
(b⊥)⊤a⊥ 0
1
0
0
0
(b⊥)⊤a⊥ 0
1
⊤
⊤
fW−11
 eV−11
and [bcj]2 :=fW
and [bcm+j]2 :=eV
[ci]1 :=
2
2
[cn+i]1 :=
B2 computes [c0]1 := [γ]1, [bc0]2 := [γ]2, gpk := PG, ct := {[c0]1, [bc0]2, [ci]1, [bcj]2}i∈[2n],j∈[2m].
It returns (gpk, pk, ct) to A. Then, it simulates OKeygen as in G2 (see Figure 7.7). Finally,
when A outputs β′, B2 outputs 1 if β′ = β, and 0 otherwise.
It can be seen that when [z]1 is a real 3-PDDH challenge, i.e., [z]1 = [abc]1, then B2
simulates game G1; whereas it simulates game G2 when [z]1 ←R G1. In particular, while this
is easy to see for the elements of the public key and for ciphertexts [bcj]2, [bcm+j]2, for the
ciphertext elements [ci]1, [cn+i]1 we observe that they can be written as
ci :=
cn+i :=
⊤  B|b · a⊥ 0
⊤  B|b · a⊥ 0
W−1 = γAri + zb−1 · x(β)
V−1 = γArn+i + zb−1 · x(0)
0
· (b⊥)⊤a⊥
x(β)
i
· (b⊥)⊤a⊥
0
So, if z = abc, then zb−1 = aγ and the ciphertexts are distributed as in G1; otherwise if z is
random zb−1 is identically distributed to (aγ+v) as in G2. This proves |AdvG1(A)−AdvG2(A)| ≤
Adv3-PDDH
PG,B2 (λ) + 2−Ω(λ).
1 !−1
1 !−1
−z · x(0)
i
z · x(β)
i
γB⊤Arn+i
i b⊥
V−1.
!⊤
i b⊥
W−1
!⊤
γB⊤Ari
0
0
x(β)
i
Lemma 48: From game G2 to G3
|AdvG2(A) − AdvG3(A)| ≤ 2−Ω(λ).
Here, we change the distribution of the challenge ciphertexts, using a statistical argument.
Proof of Lemma 48. First, we use the fact that for all γ ∈ Zp:
(γ, v + γ)v←RZp ≡ (γ, v)v←RZp.
Therefore, we can write the challenge ciphertexts as follows. For all i∈ [n], j ∈ [m]:
ci := γAri + vx(β)
x(β)
i
i b⊥
!⊤
W−1, cn+i := γArn+i − vx(0)
0
i b⊥
!⊤
V−1.
Then, we use the facts that:
7.2 Public-key FE
153
• (v ←R Zp) ≈ 1
p
(v ←R Zp) such that v + 1 6= 0 mod p.
• (A, B, a⊥)A,B←RDk,a⊥←Rorth(A) ≈ 1
Ω(p)
tion 9.
(A, B, a⊥)A,B←RDk,a⊥←Rorth(A)\Span(B), by Deﬁni-
0
0
0
1
0
v
v+1
0
0
−1
v+1
1
IDk×k
 ·  B|a⊥ 0
1 !−1
• For any v ∈ Zp such that v+1 6= 0 mod p, W ←R GLk+2(p) is identically distributed than
, where fW ←R GLk+2(p),
1 ! ·
fW ·  B|a⊥ 0
A, B ←R Dk, and a⊥ ←R orth(A) \ Span(B).
Therefore, we can change the distribution of {ci,bcj}i∈[n],j∈[m] as follows:
sj
y(β)
j
y(β)
j
IDk×k
v+1
1
−1
0
0
0
1
0
0
0
0
v
v+1
j a⊥
sj
y(β)
j
0
1 ! ·
bcj = fW ·  B|a⊥ 0
1 ! ·
= fW ·  B|a⊥ 0
!
= fW · Bsj + y(β)
 ·
 ·  B|a⊥ 0
1 !−1
· fW−1
 ·  B|a⊥ 0
1 !−1
0
(b⊥)⊤a⊥ 0
1
0
(b⊥)⊤a⊥ 0
1
(b⊥)⊤a⊥
(b⊥)⊤a⊥
0
−1
v+1
v+1
0
IDk×k
v+1
1
−1
A⊤B
0
0
0
0
0
0
v+1
0
v
0
1
−1
0
0
0
0
0
0
v
i b⊥
!⊤
· fW−1
and
0
0
A⊤B
A⊤B
γri
vx(β)
i
x(β)
i
γri
v · x(β)
i
x(β)
i
⊤
⊤
ci =
=
=
·
= γAri + (v + 1) · x(β)
(v + 1) · x(β)
γri
0
0
⊤
i
·  B|a⊥ 0
1 !−1
0
· fW−1
· fW−1
Then, we use the facts that:
• v ←R Zp such that v + 1 6= 0 mod p ≈ 1
p
v 6= 0 mod p.
v ←R Zp such that v + 1 6= 0 mod p and
• For any v ∈ Zp such that v + 1 6= 0 mod p and v 6= 0 mod p, V ←R GLk+2(p) is
 ·  B|a⊥ 0
1 !−1
,
1 ! ·
identically distributed than eV ·  B|a⊥ 0
where eV ←R GLk+2(p), A, B ←R Dk, and a⊥ ←R orth(A) \ Span(B).
IDk×k 0
1
1 1 + 1
v
0
1
v
0
0
0
0
154
Chapter 7. Functional Encryption for Quadratic Functions
Therefore, we can change the distribution of {cn+i,bcm+j}i∈[n],j∈[m] as follows: