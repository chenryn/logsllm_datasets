• Starfi巳ld Technologi巳s
• GoDaddy
• DigiCert
• Network Solutions. LLC
• Entrust
没有办法能够阻止任何组织开展 CA 性质的业务。 然而， 这些由 CA 发布的证书只 是相当于对
发布它们的组织的信任。 在接到来自 第三方的数字证书时， 这一点是需要考虑的重要内容。 如果并
不认可和信任发布证书的 CA， 那么根本就不应该信任这个证书。 如果配置浏览器让其信任一个 CA，
它会自动信任由该 CA 颁发的所有数字证书。 浏览器开发者预先设置了浏览器可信任的主要 CA，
以减轻用 户 的负担。
注册授权机构(RA)在数字证书发布之前帮助 CA 验证用 户 的身份。 队本身并不直接发布证书，
但是在认证过程中 扮演重要的角色， 从而允许 CA 远程验证用户 的身份。
第 7 章 PKI 和密码学应用
@ 真实场景
证书路径确认
在学 习证书授权机构的过程中， 你可能会接触到证书路径验证(Certi自cate Path Validation， CPV)。
CPV 指的是: 从原始起点或可信根源至相关服务器或客户 端的证书路径 中 的每个证书都应 当考虑是
否有效与合法。 如果需要验证 "可信" 端点之间 的每个链接是否保持遥远、 有效和可信， 那 么 CPV
就十分重要。
当中间系统的证书过期或被替换时， 信任链或验证Z各径可能受到破坏， 由此就会引发上述问题。
通过实施所有信任阶段的重新验证， 就可以重新建立所有可信链接并证明假定的信任能够得到保证。
7.4.3 证书的生成与撤消
公钥基础设施背后的技术概念相当 简单。 在下面的 内容中， 我们将研究证书授权机构建立、 确
认和撤消客户 证书的过程。
1 . 注册
当希望获得一个数字证书时， 你必须首先采用某种方式向证书授权机构证明身份， 这个过程被
称为注册。 前一小节曾 经提到过， 这常常涉及携带正确的身份标识文档前往证书授权机构的代理处。
一些证书授权机构提供了 其他认证方法， 包括使用可信团体领导人提供的信用报告数据和身份认证。
一旦证书授权机构对你的身份表示满意， 你就可以 向其提供你的公钥 。 CA 接着建立一个包合
你的身份识别信息和公钥副本的 X.509 数字证书 。 CA 随后使用其私钥对证书进行数字化签名 ， 并
且向你提供己签名数字证书的副本。 最后， 你可以安全地将这个证书分发给希望与之进行安全通信
的人。
2 验证
当 收到来自希望与之通信的人的数字证书时， 就需要通过使用 CA 的公钥检查 CA 的数字签名
来验证这个证书 。 接着， 必须检查并确保证书并没有公布在证书撤消列表(Certificate Revocation List，
CRL)中 。 此时 ， 假如满足下列要求， 那么就可 以认定在证书中列出的公钥是可信的:
• CA 的数字签名 是可信的。
• 你信任 CA。
• 证书没有被列在 CRL 中 。
• 证书实际上包含你信任的 数据 。
最后一点很微妙， 但却是极其重要的要求。 在信任与某人有关的信息中 的身份识别内容之前，
应当确信这些内 容确实包含在证书中 。 如果某个证书包含电子邮件地址(PI:EMAIL)， 但是没
有个人的名字， 那么就只能够确信其中 包含的公钥与这个 电子邮件账户相关联。 CA 不能断定
PI:EMAIL 电子邮件账户 的实际身份。 然而， 如果证书包含名字 Bill Jones 以及地址和电话号
码 ， 那么 CA 也 同样担保这些 内容。
数字证书验证算法内建在许多流行的 Web 浏览器和 电子邮件客户端软件中， 因此不必常常涉及
这个特定的过程。 不过， 深入理解幕后的技术细节， 这对于为组织机构进行正确的安全性判断来说
1 69
1 70
CISSP 官方学习指南(第 7 版)
是十分重要的。 当购买证书时， 应该选择一个被广泛信任的 CA。 这样做的理由是， 如果一款主流
的浏览器不接纳这个 CA 或将此 CA 从信任 CA 列表中移除， 这将极大限制所购买证书的使用 。
3. 撤消
有时， 证书授权机构会由于下列某种原因 需要撤消证书:
• 证书遭到破坏(例如， 证书所有者不慎丢失了私钥)。
• 证书被错误地发放(例如 ， CA 错误地发放了 一个没有进行正确验证的证书) 。
• 证书的细节发生变化(例如， 主体的名 字发生 了 变化)。
• 安全性关联发生变化(例如， 担保这份证书的组织机构不再雇用主体)。
提示 :
撤消请求宽限期是 CA 执行被请求的撤消证书 的 最长响应 时间， 这个时间在证书 实践声 明
(Certificate Practive Statement， CPS) 中 定义。 CPS 规定 了 发布和管理证书 时 CA 的利用 实践。
可 以使用 下列两种技术来验证证书的可靠性 以及确定撤消 的证书:
证书撤消列表 证书撤消列表(CRL)由不同的证书授权机构进行维护， 并且包含 CA 发布的 己
被撤消的证书的序列号以及撤消生效的 日 期和时间 。 证书撤消列表的主要缺点是它们必须定期下载
并交叉参照， 这样就会在证书被撤消和通知最终用户证书撤消之间存在一段时间延迟。 然而， CRL
仍然是今天检查证书状况的最常见方法。
联机证书状态协议(Online Certificate Status Protocol ， OCSP) 这个协议通过提供实时证书验
证方法消除 了认证撤消列表所带来的固有延迟。 当客户端收到一份证书时 ， 就会向 CA的OCSP 服
务器发送 OCSP 请求。 服务器随后回应这份证书的状态(有效、 无效或未知)。
7.4.4 非对称密钥 的管理
在 公钥基础设施 内 ， 通过遵守若干最佳方法需求来维护通信安全性是非常重要的 。
首先， 明智地选择加密系统。 前面曾经学习过， " 隐藏式安全" 不是一种适当的途径。 选择算法
公开的加密系统， 其算法必须经过行业专家的彻底检查。 慎重选择使用 " 黑箱 " 途径的加密系统和
维护算法的秘密性， 这对于密码系统的完整性来说至关重要。
必须以适当的方式选择密钥。 选择密钥长度时应当考虑、安全需求与性能之间的平衡。 此外， 应
当确认密钥真正随机。密钥内的任何模式都会增加攻击者破译加密和减弱密码系统安全性的可能性。
使用公钥加密时， 一定要保证私钥的机密性 ! 在任何情况下都不能允许其他人获知你的私钥。
需要记住的是， 偶尔允许某人访问 私钥， 会持久地危害使用该密钥加密的所有通信(无论是过去、 当
前还是将来)， 并且准许第三方能够成功地进行假冒。
密钥在服务一段时期后应当停止使用。 许多组织机构具有强制的密码轮换需求， 从而防止未被
发现的密钥泄露。 如果没有必须遵循的正式策略， 那么可以基于密钥的使用频率选择适当的密钥轮
换时 间间隔。 如果可能的话， 可 以几个月 更 改一 次密钥对。
最后， 备份密钥 ! 如果由于数据损坏、 崩 溃或其他情况丢失包含私钥的文件， 那么无疑希望具
有可用 的备份。 此时， 既可以创建自 己的备份， 也可以使用维护备份的密钥托管服务。 在任何情况
下 ， 都需要确保以安全的方式处理备份 。 毕竟， 备份与主密钥文件一样重要 !
第 7 章 PKI 和密码学应用
7.5 密码学的应用
到目前为止， 你 已经学习 了 与密码学的基础知识、 各种密码学算法的 内 部工作原理、 使用数字
证书分发身份证书的公钥基础设施的应用等有关的大量内容。 现在， 你应该掌握了 密码学的基础知
识 ， 下面将研究解决 日 常通信 问题的密码学技术的高级应用 。
在接下来的内容中， 我们将介绍用密码学来保护静态数据， 例如存储在便携式设备上的数据，
还有传输中 的数据 。 使用 的技术有: 保护 电子邮件、 加 密 Web 通信和 网络连接。
7.5. 1 便携式设备
现在 ， 笔记本电脑 、 上网本、 智能手机和平板电脑无处不在， 它们给计算世界带来了 新的风险。
这些设备往往包含高度敏感的信息， 如果丢失或被盗， 可能会给组织及其客户 、 员工和分支机构造
成严重伤害 。 基于这个原因 ， 许多组织转向加密来保护这些设备上的数据， 以防止它们被错误放置
和使用 。
目 前流行的操作系统版本都包括磁盘加密功能， 使其便于应用和管理便携式设备上的数据加密。
例如， 微软 Wmdows 包括 BitLocker 和加密文件系统但ncrypting File System， EFS)技术， Mac OS X
包含 FileVault 加密， TrueCrypt 的 开源软件包允许 Linux、 Windows 和 Mac 系统上的磁盘加密。
各种各样的商业工具可以提供额外的功能和管理能力。 这些工具之间 的主要区别在于它们是如
何保护存储在内存中 的密钥的， 它们是否提供完整的磁盘或卷加密， 以及是否将与基于硬件的可信
平台模块(frusted Platform Modul巳， TPM)进行集成并提供附加的安全性。 选择加密软件的任何努力
都应该包括对这些特性的分析。
提示 :
在开发使携式设备的力口密策略时不要忘 了 智能手机。 大多数主要的智能手非周口平板电脑平台 ，
都 包括企业级的功能， 从而 支持对存储在手机上的数据进行加密 。
7.5.2 电子邮件
我们前面曾经多次提到过， 安全性应当考虑成本效益。 对于电子邮件来说， 简 明就是成本效益
最高的选项， 不过有时 密码学提供了 无法避免使用 的特定安全服务。 因为保护安全也具有成本效益，
所 以加密 电子邮件需要遵守下列规则 :
• 如 果在发送邮件时需要实现机密性， 那么就加密邮件 。
• 如果需要维护邮件的完整性， 那么就必须对邮件进行散列运算。
• 如 果需要实现身份认证和完整性， 那么就应当对邮件进行数字化签名 。
• 如果需要实现机密性、 完整性、 身份认证和不可否认性， 那么就应当对邮件进行加密和数
字化签名 。
发送者总是需要负责确保实现正确的机制， 从而保证维护邮件或传输的安全性(也就是机密性、
完整性、 身份认证和不可否认性)与隐私性。
1 71
1 72
CISSP 官方学习指南(第 7 版)
密码学最急需的一种应用是电子邮件的加密和签名 。 直到最近， 加密的 电子邮件仍然需要使用
复杂的、 笨拙的软件， 这些软件需要人工干预和复杂的密钥交换过程。 最近几年， 人们越来越重视
安全性， 这导致在主流电子邮件包中使用强的加密技术。 接下来， 我们将介绍 目 前广泛使用 的一些
电子邮件标准。
1 可靠隐私
1 99 1 年， Phi1 Zimmerman 的可靠隐私σGP)安全电子邮件系统出现在计算机安全领域内 。 它结
合了之前本章 "Web 信任" 概念里面的 CA 层级结构。 在这个概念中 ， 必须被一个或多个 PGP 用 户