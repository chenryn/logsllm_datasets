Our analysis now focuses on results obtained with local graphs. Unlike the global
ones, local graphs shed light to AS dependency only for a speciﬁc origin AS. We
found that the structure of local graphs is very diﬀerent depending on the size
and peering policies of the origin AS. On average in 2017, an IPv4 local graph
contains 98 nodes but 93% of these nodes have an hegemony null (H = 0). Typ-
ically ASes hosting BGP peers have an hegemony null and AS hegemony scores
increases as the paths converge towards the origin AS. Thereby, the upstream
provider of a single-homed origin AS gets the maximum hegemony score, H = 1.
By deﬁnition the origin AS of each local graph also features H = 1, therefore,
we are not reporting the AS hegemony of the origin AS in the following results.
In 2017, local graphs have on average 5 ASes with H > 0.01, which usually
corresponds to a set of upstream providers and tier-1 ASes. We also noticed inter-
esting graphs containing no dominant AS, and other graphs containing numer-
ous nodes with non-negligible AS hegemony scores. To illustrate this we pick a
local graph from both end of the spectrum, namely, AS20940 from Akamai and
AS15169 from Google.
Akamai and Google: The IPv4 graph for Akamai’s main network, AS20940, is
the local graph with the largest number of nodes in our results. In 2017, it con-
tains on average 30 nodes with an AS hegemony greater than 0.01 (see Fig. 5a).
Meaning that accessing Akamai IP space relies on a large set of transit networks.
This is true for our entire analysis period as shown in Fig. 5a. Our manual inspec-
tion of Akamai BGP announcements reveals that Akamai is heavily fragmenting
224
R. Fontugne et al.
(a) AS20940 Akamai, IPv4
(b) AS15169 Google, IPv4
(c) AS20940 Akamai, IPv6
(d) AS15169 Google, IPv6
Fig. 5. Distribution of AS hegemony for Google and Akamai local graphs. Same color
scale as Fig. 3.
its IP space and advertising small preﬁxes at various Points of Presence (PoPs).
Consequently, each preﬁx is accessible only through a very limited number of
upstream providers and all BGP peers report AS paths going through these
providers. In summary, Akamai local graph contains a lot of nodes with weak
but non-negligible AS hegemony scores implying that Akamai has numerous
weak AS-dependencies.
On the other hand, the IPv4 graph for Google (AS15169) in 2017 contains no
node with an hegemony greater than 0.01 (see Fig. 5b). Our manual inspection
of Google BGP advertisements reveals that, unlike Akamai, Google announces
all their preﬁxes at each PoP. Because Google is peering at numerous places,
all BGP peers report very short and diﬀerent AS paths with almost no AS in
common hence no relevant hegemony score. Nonetheless, Google’s local graphs
before 2012 feature a diﬀerent AS hegemony distribution with a few high AS
hegemony scores (Fig. 5b). Level(3) is the most dominant AS observed until
2012. But then Google has clearly succeeded to bypass Level(3) and alleviate
its dependency to this AS (usually H < 0.00005 from 2014). Now Level(3) is
rarely seen in paths towards Google. In summary, we observe that Google used
to depend on a few ASes but it is now mostly independent from all ASes. This
The (Thin) Bridges of AS Connectivity
225
is not an isolated case, we measured no AS dependency for a few other ASes,
notably, Microsoft (AS8075), Level(3) (AS3356), HE (AS6939), and Verisign
(AS7342).
For IPv6, the situations for Akamai and Google are a bit diﬀerent. The local
graph for Akamai contains a lot of nodes with a high AS hegemony (Fig. 5c).
But HE is quite outstanding and features an AS hegemony (H = 0.43) very
close to the one observed for HE in the IPv6 global graph (Fig. 3b). HE is
also the dominant node in Google’s IPv6 local graph (Fig. 5d) but at a much
lower magnitude (H = 0.12). Thereby, our results show that Google’s aggressive
peering policy has partially succeeded to bypass HE ubiquitous IPv6 network.
DNS root servers: Monitoring an AS with our tools provides valuable insights
into its AS dependency. This is particularly useful for networks hosting critical
infrastructure, as operators of these ASes try to minimize their dependencies to
third-party networks. To illustrate the beneﬁts of our tools, we present results for
the local graphs of ASes hosting DNS root servers. Notice that understanding AS
dependency of root servers is usually a complicated task as most root servers are
using anycast and more than 500 instances are deployed worldwide. Due to space
constrains, we detail only IPv4 results for networks hosting the F-root (AS3557)
and B-root (AS394353) servers as they had signiﬁcant structural changes in 2017.
In early 2017, we observe three dominant transit ASes for the network hosting
the F-root server (Fig. 6a). AS30132 and AS1280 are direct upstream networks
managed by ISC, the administrator of the F-root server. AS6939 is HE, the main
provider for AS1280, and is found in about a third of the AS paths toward the F-
root server. From March, Cloudﬂare (AS13335) starts providing connectivity to
new F-root instances [7]. This new infrastructure is clearly visible in our results.
Starting from March 2017, Cloudﬂare hegemony is ﬂuctuating around 0.2 and
seems to divert traﬃc from other instances as the three other transit networks
have their hegemony proportionally decreased. From these results we deduce
that the addition of Cloudﬂare has successfully reduced F-root dependencies on
other ASes.
For the B-root server (Fig. 6b), we observe two dominant ASes in January
and February 2017, Los Nettos (AS226) and NTT America (AS2914). Los Nettos
reaches H = 1 because at that time the B-root server was unicasted and Los
Nettos was the sole provider. NTT also has a very high AS hegemony score,
in fact more than 80% of analyzed AS paths also cross NTT’s network. From
March 2017, we observe two other transit nodes AMPATH (AS20080) and HE
(AS6939). Our manual inspection of the advertised paths reveals that a single
/24 preﬁx is advertised with AMPATH as the ﬁrst hop and usually HE as the
second hop. This preﬁx is one of the two /24 preﬁxes advertised by the network
hosting the B-root server (AS394353) but is not the one containing the server IP
address. We believe that B-root operators were testing anycast in preparation for
the deployment of the second instance of B-root at Miami that happened in May
[14]. In May we acknowledge the deployment of the second instance hosted at
AMPATH as the hegemony of that AS is raising again and the one for Los Nettos
had signiﬁcantly decreased. From July onward, however, we observe a sudden
decrease of AMPATH hegemony while hegemony for Los Nettos is getting back
226
R. Fontugne et al.
Fig. 6. AS hegemony for nodes in F-root (AS3557) and B-root (AS394353) local graphs
from 15th January to 15th September 2017.
close to 1. A manual comparison of AS paths in June and July reveals that
Los Nettos is trying to ﬁx this by prepending its ASN to paths through HE.
Despite these eﬀorts, most of the paths that were transiting through HE and
AMPATH in June are replaced by paths going through HE and Los Nettos in
July. The addition of the second instance in Miami had uncertain beneﬁts, ﬁrst,
it considerably mitigated the dependence on NTT and Los Nettos networks in
May and June, but then, from July Los Nettos is once again totally dominating
the B-root connectivity. Results for IPv6 are quite diﬀerent, after the deployment
in Miami we observe higher hegemony values for AMPATH. Both the IPv4 and
IPv6 observations have been conﬁrmed by the B-root operators.
Future directions: The structural changes observed for the F and B root
servers illustrate the value of AS hegemony to monitor signiﬁcant routing events.
We are now designing an automated detection process to identify signiﬁcant
changes in AS hegemony scores. This detector reports sudden routing changes
such as the recent BGP leak from Google [16]. During this event Google became a
transit provider for NTT OCN, which exhibits a sudden and signiﬁcant increase
in Google’s AS hegemony for NTT’s local graph. Thanks to AS hegemony detect-
ing this type of event is fairly easy, while state of the art tools employed by
network operators (e.g. BGPmon provided by OpenDNS) have usually missed
this signiﬁcant event. As the details and evaluation of this detector go beyond
the scope of this paper we leave this for future work.
In the future we are also planning to investigate diﬀerent weighting schemes.
For example by assigning paths’ weight based on traﬃc volume an ISP can
emphasize destinations that are favored by its customers.
5 Conclusions
We presented a methodology to quantify the AS interdependency in the Internet.
It deals with the various AS paths reported via BGP and produce AS hegemony
scores, that are robust estimates of the ASes centrality. Using 14 years of BGP
The (Thin) Bridges of AS Connectivity
227
data we proved that this method permits to monitor structural changes in the
Internet and identify most important ASes to reach a certain part of the IP
space. We also demonstrated with case studies the beneﬁts of our tools to help
ISPs to plan and assess infrastructure deployment. To assist network operators
in these tasks we make our tools and results publicly available [1].
References
1. AS Hegemony Results (2017). http://ihr.iijlab.net/ihr/hegemony/
2. Cittadini, L., Muhlbauer, W., Uhlig, S., Bush, R., Fran¸cois, P., Maennel, O.: Evolu-
tion of internet address space deaggregation: myths and reality. IEEE JSAC 8(28),
1238–1249 (2010)
3. Comarela, G., Terzi, E., Crovella, M.: Detecting unusually-routed ases: methods
and applications. In: IMC, pp. 445–459. ACM (2016)
4. Dhamdhere, A., Luckie, M., Huﬀaker, B., Elmokashﬁ, A., Aben, E., et al.: Mea-
suring the deployment of ipv6: topology, routing and performance. In: IMC, pp.
537–550. ACM (2012)
5. Fontugne, R., Shah, A., Aben, E.: As hegemony: a robust metric for as centrality.
In: Proceedings of the SIGCOMM Posters and Demos, pp. 48–50. ACM (2017)
6. Gamba, J., Fontugne, R., Pelsser, C., Bush, R., Aben, E.: BGP table fragmentation:
what & who? In: CoRes (2017)
7. Grant, D.: Delivering Dot (2017). https://blog.cloudﬂare.com/f-root/
8. Pan, E.H.: Gigabit/ATM Monthly Newsletter. Information Gatekeepers Inc.,
November 2009
9. Karlin, J., Forrest, S., Rexford, J.: Nation-state routing: censorship, wiretapping,
and BGP. CoRR, abs/0903.3218 2009
10. Lee, S.H., Kim, P.-J., Jeong, H.: Statistical properties of sampled networks. Phys.
Rev. E 73, 016102 (2006)
11. Liu, Y., Luo, X., Chang, R.K., Su, J.: Characterizing inter-domain rerouting
by betweenness centrality after disruptive events. IEEE JSAC 31(6), 1147–1157
(2013)
12. Mahadevan, P., Krioukov, D., Fomenkov, M., Dimitropoulos, X., Claﬀy, K.C.,
Vahdat, A.: The internet as-level topology: three data sources and one deﬁnitive
metric. In: SIGCOMM CCR, vol. 36(1), pp. 17–26 (2006)
13. Orsini, C., King, A., Giordano, D., Giotsas, V., Dainotti, A.: BGPstream: a soft-
ware framework for live and historical BGP data analysis. In: IMC, pp. 429–444.
ACM (2016)
14. Root Operators. B-Root Begins Anycast in May (2017). http://root-servers.org/
news/b-root-begins-anycast-in-may.txt
15. Schuchard, M., Mohaisen, A., Foo Kune, D., Hopper, N., Kim, Y., Vasserman,
E.Y.: Losing control of the internet: using the data plane to attack the control
plane. In: CCS, pp. 726–728. ACM (2010)
16. Toonk, A.: BGP leak causing Internet outages in Japan and beyond, August 2017.
https://bgpmon.net/bgp-leak-causing-internet-outages-in-japan-and-beyond/
17. W¨ahlisch, M., Schmidt, T.C., de Br¨un, M., H¨aberlen, T.: Exposing a nation-centric
view on the german internet – a change in perspective on AS-Level. In: Taft, N.,
Ricciato, F. (eds.) PAM 2012. LNCS, vol. 7192, pp. 200–210. Springer, Heidelberg
(2012). https://doi.org/10.1007/978-3-642-28537-0 20
18. Zhou, S., Mondrag´on, R.J.: Accurately modeling the internet topology. Phys. Rev.
E 70(6), 066108 (2004)