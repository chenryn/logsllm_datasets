with home network 172.16.0.0/12. For evaluating the system on real-world, live
traﬃc, we chose a gateway router to a large academic network with address
141.212.0.0/16. This router copies traﬃc from all ports to a span port, which
can be connected to a separate machine for analyzing the traﬃc.
For DARPA dataset experiments, we used a dual 3.06 GHz Intel Xeon machine
with 2 GB of main memory. The machine was running FreeBSD 6.1 with SMP
enabled. We connected the span port of the gateway router to a machine with
dual 3.0 GHz Intel Xeon processors and 2GB of main memory. The machine was
running FreeBSD 5.4 with SMP enabled. The results that follow are the averages
over 5 runs and with the THRESHOLD value set to 5.
4.2 Processing Time and Memory Usage
We compared Wind with Snort 2.1.3 for all rules included with the distribution.
There were 2, 059 diﬀerent rules, and both Wind and Snort were run using default
conﬁguration. Figure 5 shows the amount by which we improved the number of
packets processed per second by Snort. For most datasets, we ﬁnd that our
system processes up to 1.6 times as many packets as Snort. We also compared
the memory used by our system with that of Snort. Figure 6 shows the memory
saved by our system when compared to Snort. We ﬁnd that our system uses
about 10-20% less memory when compared to the unmodiﬁed Snort. In other
words, we perform up to 1.6 times better in processing time and save 10-20% of
the memory.
Wind and Snort were run on the border router for analyzing a million packets
at a few discrete times in the week. Figure 7 shows the amount by which Wind
improved the number of packets processed per second by Snort. It shows that
the improvement factor on this dataset varied from 1.35 to 1.65. During the
runs, Wind consumed 10-15% less memory than Snort.
304
S. Sinha, F. Jahanian, and J.M. Patel
Factor improvement in number of packets processed per second
 1
 1.1
 1.2
 1.3
 1.4
 1.5
 1.6
 1.7
 1.8
98-test-w1-mon
98-test-w1-tue
98-test-w1-wed
98-test-w1-thu
98-test-w1-fri
98-test-w2-mon
98-test-w2-tue
98-test-w2-wed
98-test-w2-thu
98-test-w2-fri
99-test-w4-mon
99-test-w4-tue
99-test-w4-wed
99-test-w4-thu
99-test-w4-fri
99-test-w5-mon
99-test-w5-tue
99-test-w5-wed
99-test-w5-thu
99-test-w5-fri
Fig. 5. Factor improvement, in terms of number of packets processed per second, when
compared to Snort for the 1998 and 1999 DARPA testing datasets
 0
 5
 10
 15
 20
percentage of memory saved
98-test-w1-mon
98-test-w1-tue
98-test-w1-wed
98-test-w1-thu
98-test-w1-fri
98-test-w2-mon
98-test-w2-tue
98-test-w2-wed
98-test-w2-thu
98-test-w2-fri
99-test-w4-mon
99-test-w4-tue
99-test-w4-wed
99-test-w4-thu
99-test-w4-fri
99-test-w5-mon
99-test-w5-tue
99-test-w5-wed
99-test-w5-thu
99-test-w5-fri
Fig. 6. Percentage of memory saved for each of the 1998 and 1999 DARPA datasets,
when compared to Snort
WIND: Workload-Aware INtrusion Detection
305
Factor improvement in number of packets processed per second
 1
 1.1
 1.2
 1.3
 1.4
 1.5
 1.6
 1.7
Factor improvement in number of packets processed per second
 1
 1.2
 1.4
 1.6
 1.8
 2
 2.2
 2.4
 2.6
Sat-evening-04/02
Sun-evening-04/02
Mon-afternoon-04/03
Mon-evening-04/03
Tue-afternoon-04/04
Tue-evening-04/04
Sat-evening-04/02
Sun-evening-04/02
Mon-afternoon-04/03
Mon-evening-04/03
Tue-afternoon-04/04
Tue-evening-04/04
Fig. 7. Factor improvement in number of
packets processed per second, when com-
pared to Snort, on data from a border
router in an academic network
Fig. 8. Factor improvement in number of
packets processed per second, when com-
pared to Snort, for web-based rules. These
experiments were on traﬃc from a border
router at an academic network.
Factor improvement in number of packets processed per second
 1
 1.2
 1.4
 1.6
 1.8
 2
 2.2
 2.4
 2.6
 2.8
98-test-w1-mon
98-test-w1-tue
98-test-w1-wed
98-test-w1-thu
98-test-w1-fri
98-test-w2-mon
98-test-w2-tue
98-test-w2-wed
98-test-w2-thu
98-test-w2-fri
99-test-w4-mon
99-test-w4-tue
99-test-w4-wed
99-test-w4-thu
99-test-w4-fri
99-test-w5-mon
99-test-w5-tue
99-test-w5-wed
99-test-w5-thu
99-test-w5-fri
Fig. 9. Factor improvement in number of packets processed per second by Wind when
compared to Snort for web-based rules. The datasets include the 1998 and 1999 DARPA
intrusion detection datasets.
4.3 Application-Speciﬁc Rules
Until now, all our experiments were conducted by enabling all rules that came
with the Snort distribution. However, in many networks, only application-speciﬁc
rules can be used. For example, in many enterprise networks, the only open
306
S. Sinha, F. Jahanian, and J.M. Patel
access through the ﬁrewall is web traﬃc. Since web traﬃc forms the dominant
application allowed in many networks, we compared our system with Snort for
web-based rules 2. Figure 8 shows the magnitude by which our system improves
Snort, in the terms of number of packets processed per second, for traﬃc at
the border router. We found that for web-based rules, our system improves
performance by more than two times when compared to Snort. Figure 9 shows
a similar graph for the DARPA datasets. We observed that Wind outperforms
Snort by a factor of up to 2.7 times. In this case, we saved 2-7% of the memory
when compared to Snort.
4.4 Variation with Threshold
In order to investigate how the threshold aﬀects the performance of our system,
we evaluated the DARPA dataset, 98-test-w1-mon, for diﬀerent values of the
threshold. Figure 10 shows the performance variation of our system with the
increasing threshold. As expected, the performance of the system decreases with
increasing cost assigned by threshold. However, we ﬁnd that the changes are
more pronounced only for lower threshold values. We ﬁnd that the memory saved
by our system increases with increasing threshold values, signiﬁcantly only for
lower threshold values. Therefore, we ﬁnd that increasing the threshold reduces
performance, but saves more memory, and this diﬀerence is more pronounced
for lower threshold values.
.
c
e
s
r
e
p
s
t
e
k
c
a
p
f
o
r
e
b
m
u
n
n
i
t
n
e
m
e
v
o
r
p
m
i
r
o
t
c
a
F
 1.65
 1.6
 1.55
 1.5
 1.45
 1.4
 1.35
 1.3
 1.25
 1.2
 0
 30
 28
 26
 24
 22
 20
 18
 16
d
e
v
a
s
y
r
o
m
e
m
f
o
e
g
a
t
n
e
c
r
e
p
 250
 0
 50
 100
 150
 200
Threshold (minimum number of rules to be rejected)
 50
Threshold (minimum number of rules to be rejected)
 100
 150
 200
 250
Fig. 10. The change in number of packets
processed with the threshold for minimum
number of rules to be rejected, when com-
pared to Snort (dataset: 98-test-w1-mon)
Fig. 11. Variation in memory saving with
the threshold for minimum number of
rules to be rejected, when compared to
Snort (dataset: 98-test-w1-mon)
4.5 Comparison with Bro
We also compared Wind with another IDS Bro [6]. We ﬁrst converted Snort
signatures using a tool already provided by Bro [24]. However, only 1, 935 signa-