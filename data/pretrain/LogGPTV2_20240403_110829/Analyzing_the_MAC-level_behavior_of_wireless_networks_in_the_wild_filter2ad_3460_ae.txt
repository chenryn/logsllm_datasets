10
# contenders
15
Figure 14: The prevalence of different levels of contention, com-
puted over a busy hour-long interval of the Channel 1 trace. The
graphs show the percentages of total time spent (left) and packets
sent (right) at each contention level. The y-axes end at 50%.
packets in the trace divided by the sum of this number and the num-
ber of ACKs without a corresponding data packet [11, 21]. We ob-
tain capture percentages of 94% and 85% with this heuristic for the
merged traces of Channel 1 and 11, respectively. The correspond-
ing nitWit estimates stated above are 90% and 79%, respectively.
Again, while we cannot be certain without ground truth, the heu-
ristic seems to overestimate capture. This is presumably because it
does not account for other patterns of missing packets, e.g., missing
ACKs or DATA-ACK pairs, whereas our FSM analysis can account
for such patterns using subsequent packets in the conversation.
5.4 Analysis with dimWit
We now present sample analyses of Channel 1 of the SIGCOMM
2004 wireless environment with dimWit. We present a series of
802.11 operational insights that are enabled by Wit, not simply
by passive monitoring. These observations could not have been
gathered via simulation or testbeds either because they depend on
802.11 usage in real environments.
Uplink was more reliable than downlink
Figure 13 compares
the reception probability for uplink (to the AP) versus downlink
transmissions for 100 randomly selected clients. The reception
probabilities are often asymmetric and the uplink is usually more
reliable. We are surprised by this result; we expected the down-
link direction to be more reliable because APs tend to transmit at a
higher power, boosting the chances of correct reception. Addition-
ally, fewer packets from the AP should be involved in collisions
because all clients should be able to hear the AP even though they
may not all be able to hear each other. We speculate that the uplink
was more reliable because commercial APs have better, possibly
multiple, antennae that improve their decoding ability.
)
%
(
n
o
i
t
a
z
i
l
i
t
u
e
m
i
t
r
i
a
100
80
60
40
20
0
0
5
10
# contenders
15
(a) airtime utilization
y
i
l
i
b
a
b
o
r
p
n
o
i
t
p
e
c
e
r
1.0
0.8
0.6
0.4
0.2
0.0
1000
800
600
400
200
d
n
o
c
e
s
r
e
p
s
t
e
k
c
a
p
transmitted
received
0
5
10
# contenders
15
(b) reception probability
0
0
5
10
# contenders
15
(c) throughput (pkts)
Figure 15: Various measures as a function of the number of contenders in the network, computed over the entire Channel 1 trace.
Offered load was mostly low
Figure 14 shows histograms of
each contention level for an hour long busy interval which had 260
unique clients. The left graph plots the percentage of time spent at
each level. We see that most of the time there are no nodes waiting
to transmit. The time spent at higher contention levels decreases ex-
ponentially such that there are more than ﬁve contenders less than
4% of the time. The right graph plots the percentage of packets sent
at each contention level. We again see that the system is exercised
most at low contention levels. (Of course, no packets are sent at
zero contenders.)
While the prevalence of low contention is perhaps not surpris-
ing, it is difﬁcult to reason about offered load without the analyses
provided by dimWit. For instance, utilization per unit time plots
(e.g, those in earlier work [11, 21]) do not distinguish between low
utilization due to a no-contender scenario and low utilization due
to a high-contender scenario in which there are backed-off stations.
Similarly, active clients per unit time plots do not convey informa-
tion as to whether the clients contend simultaneously.
The medium was inefﬁciently utilized
Figure 15(a) plots air-
time utilization as a function of the number of contenders. Utiliza-
tion is computed as the percentage of time for which the medium
was busy with at least one transmission. The ending time of a
packet is its timestamp, and the starting time is computed using
its size and transmission rate and the length of the 802.11 (long)
preamble. Inter-frame spaces are not included in this computation.
We see that the medium is poorly utilized in the common case of
few contenders. This is surprising because it is not the case that
the medium is idle due to a lack of offered load: by deﬁnition
there is at least one station waiting to transmit at each non-zero
contention level. As reference, the theoretical utilization of a sin-
gle node sending 500 byte data packets at 5.5 Mbps and receiving
ACKs at 2 Mbps (with no losses) is roughly 75% rather than 30%
as we observe. Thus, it appears that nodes often wait unnecessarily
in backoff phases before they transmit.
Reception probability did not decrease with contention
Fig-
ure 15(b) plots the packet reception probability as a function of
the contention level. We expected a decline with the number of
contenders due to increased collision losses. Instead, we were sur-
prised to ﬁnd that reception probability remains steady.6 This sug-
gests that inherent “radio losses” were the dominant cause of packet
drops. Consistently, we ﬁnd that only 0.45% of the packets in our
trace had their transmissions overlap with another packet.
Performance was stable at high contention levels
Figure 15(c)
shows the rates of packets transmitted and received (by the des-
6The increase in reception probability from one to two contenders
might be because poorly connected clients dominate the former
case.
tination) in the network. This is the throughput of the network. It
initially increases with the number of contenders and then stabilizes
at ﬁve or more contenders. As reference, the throughput with a sin-
gle node sending 500 byte data packets at 5.5 Mbps and receiving
ACKs at 2 Mbps (with no losses) will be roughly 1200 packets per
second. Thus, we ﬁnd the MAC operates well at high contention
levels. Contrary to a concern of recent work [11, 21], we do not
observe throughput decreases due to undesirable interactions with
transmission rate adaptation (where high contention leads to lower
transmission rates because of losses).
Taken together, our observations suggest that the 802.11 MAC
is tuned for higher contention levels than those we observe in our
measured network.
It assumes that most losses are due to con-
tention and hence backs off in response to any loss; in reality,
most losses appear to be radio losses that do not warrant backoff.
The MAC appears overly biased towards avoiding collisions by us-
ing larger than necessary backoff intervals. The result is that the
medium usage is quite inefﬁcient for the common case of low of-
fered load. This suggests that there is an opportunity for a MAC
that adapts to its environment to be efﬁcient at low load as well
as high load. Indeed, recent work explores some aspects of this
problem [9].
6. RELATED WORK
Most work on measurement-driven analysis of wireless networks
either uses traces from the wired portion of the network and SNMP
logs of APs [4, 5, 7, 8, 23, 26] or uses instrumentation in testbed
settings [2, 10, 29]. While these approaches provide useful insights
into the behavior of wireless networks, the information they gather
cannot be used to study the detailed behavior of the MAC layer in
deployed networks.
A few recent works have explored passive monitoring of wire-
less networks. Jardosh et al. [11] and Rodrig et al. [21] analyze data
collected by individual monitors at live networks to analyze aspects
such as 802.11 MAC overhead, airtime utilization, and congestion.
But the view of a single monitor is inherently limited. To overcome
this limitation, Yeo et al. originally proposed merging the views of
multiple monitors [27]. Our merging approach is built on their ob-
servation regarding reference packets, though our exact technique
is different and more precise. We view our work as posing passive
monitoring as a broad approach to analyze live wireless networks
and advancing the state of the art through novel techniques to in-
fer, for instance, the reception status of packets and the number of
stations competing for the medium.
Jigsaw is a concurrently developed system to perform cross-layer
analysis of enterprise wireless networks [6]. While it focuses on a
different problem, like Wit, it builds on merging and inferring the
reception status of packets. However, its techniques are different.
Jigsaw focuses on merging a large number of traces in real-time,
and, in contrast to our formal approach, its inferences are based on
an ad hoc set of rules that encode common protocol exchanges.
Our view of traces as sentences from a formal language is ins-
pired by work on using traces to test protocol implementations [14].
Our goal is different, however, and to our knowledge, we are the
ﬁrst to use formal methods to add missing packets to the trace and
infer packet reception statuses.
7. CONCLUSIONS
We presented Wit, a non-intrusive tool that builds on passive
monitoring to support detailed MAC-level analysis of operational
802.11 wireless networks. It uses several novel techniques to en-
hance the necessarily incomplete view of system activity obtained
through passive monitoring. First, it merges the independent views
of multiple monitors into a single, consistent view. Then, it uses an
engine based on formal language techniques to infer packets that
were missed by all monitors as well as infer which packets were
received by their destinations. Finally, it derives detailed perfor-
mance measures. We provided a procedure to estimate offered load
in terms of the number of nodes competing for the medium at any
given time. We used a mix of simulation and real traces to evaluate
our techniques, with encouraging results.
To demonstrate its abilities, we applied Wit to a multi-monitor
trace of a live network, performing analyses that would otherwise
not be possible or rely on less accurate heuristics. We uncovered a
picture of MAC operation that warrants further study. For instance,
we found that our network predominantly had low contention and
that the medium was inefﬁciently utilized during those times. It
appeared that the MAC was tuned for the uncommon case of high
contention levels, e.g., it backs off more than necessary in response
to any loss.
Our work is a nascent step towards non-intrusive methods that
can provide deep analyses of the behavior of operational 802.11
wireless networks. Our formal language based inference engine is
both general (e.g., we have used it to discover protocol violations)
and highly effective in extracting latent information from traces. It
will only improve as we use it to model and infer other behaviors. It
may be applicable in settings beyond 802.11 as well. Our procedure
for estimating the number of contenders highlights new kinds of
analyses that can extract higher-level information from packet-level
wireless traces. We hope that future research in this area will lead
to a better understanding of 802.11 “in the wild.”
8. ACKNOWLEDGMENTS
We thank the anonymous reviewers for feedback on the submit-
ted draft of this paper. This work was supported in part by the NSF
(Grants CNS-0133495 and CNS-0338837).
9. REFERENCES
[1] IEEE Std. 802.11i – Amendment 6: Medium access control security
enhancements, 2004.
[2] D. Aguayo, J. Bicket, S. Biswas, G. Judd, and R. Morris. Link-level
measurements from an 802.11b mesh network. In SIGCOMM, 2004.
[3] A. Akella, J. Pang, B. Maggs, S. Seshan, and A. Shaikh. A
comparison of overlay routing and multihoming route control. In
SIGCOMM, 2004.
[4] A. Balachandran, G. M. Voelker, P. Bahl, and P. V. Rangan.
Characterizing user behavior and network performance in a public
wireless LAN. In SIGMETRICS, 2002.
[5] M. Balazinska and P. Castro. Characterizing mobility and network
usage in a corporate wireless local-area network. In MobiSys, 2003.
[6] Y.-C. Cheng, J. Bellardo, P. Benko, A. C. Snoeren, G. M. Voelker,
and S. Savage. Jigsaw: Solving the puzzle of enterprise 802.11
analysis. In SIGCOMM, 2006.
[7] F. Chinchilla, M. Lindsey, and M. Papadopouli. Analysis of wireless
information locality and association patterns in a campus. In
INFOCOM, 2004.
[8] T. Henderson, D. Kotz, and I. Abyzov. The changing usage of a
mature campus-wide wireless network. In MobiCom, 2004.
[9] M. Heusse, F. Rousseau, R. Guillier, and A. Duda. Idle sense: An
optimal access method for high throughput and fairness in rate
diverse wireless LANs. In SIGCOMM, 2005.
[10] K. Jamieson, B. Hull, A. Miu, and H. Balakrishnan. Understanding
the real-world performance of carrier sense. In workshop on
Experimental Approaches to Wireless Network Design and Analysis
(E-WIND), 2005.
[11] A. Jardosh, K. Ramachandran, K. Almeroth, and E. Belding-Royer.
Understanding congestion in IEEE 802.11b wireless networks. In
IMC, 2005.
[12] D. Kotz, C. Newport, R. S. Gray, J. Liu, Y. Yuan, and C. Elliott.
Experimental evaluation of wireless simulation assumptions. In
symposium on Modeling, Analysis and Simulation of Wireless and
Mobile Systems (MSWiM), 2004.
[13] C. Labovitz, A. Ahuja, A. Bose, and F. Jahanian. An experimental
study of delayed Internet routing convergence. In SIGCOMM, 2000.
[14] D. Lee, A. N. Netravali, K. K. Sabnani, B. Sugla, and A. John.
Passive testing and applications to network management. In ICNP,
1997.
[15] S. Mangold, Z. Zhong, G. R. Hiertz, and B. Walke. IEEE
802.11e/802.11k wireless LAN: Spectrum awareness for distributed
resource sharing. Wireless Communications and Mobile Computing,
4(8), 2004.
[16] A. Miu, H. Balakrishnan, and C. E. Koksal. Improving loss resilience
with multi-radio diversity in wireless networks. In MobiCom, 2005.
[17] V. Paxson. Automated packet trace analysis of TCP implementations.
In SIGCOMM, 1997.
[18] V. Paxson. End-to-end routing behavior in the Internet. In
SIGCOMM, 1997.
[19] Qualnet network simulator by Scalable Network Technologies.
http://www.qualnet.com.
[20] I. Ramani and S. Savage. Syncscan: Practical fast handoff for 802.11
infrastructure netwroks. In INFOCOM, 2005.
[21] M. Rodrig, C. Reis, R. Mahajan, D. Wetherall, and J. Zahorjan.
Measurement-based characterization of 802.11 in a hotspot setting.
In workshop on Experimental Approaches to Wireless Network
Design and Analysis (E-WIND), 2005.
[22] S. Savage, A. Collins, E. Hoffman, J. Snell, and T. Anderson. The
end-to-end effects of Internet path selection. In SIGCOMM, 1999.
[23] D. Schwab and R. Bunt. Characterising the use of a campus wireless
network. In INFOCOM, 2004.
[24] N. Spring, R. Mahajan, and D. Wetherall. Measuring ISP topologies
with Rocketfuel. In SIGCOMM, 2002.
[25] G. Tan and J. Guttag. The 802.11 MAC protocol leads to inefﬁcient
equilibria. In INFOCOM, 2005.
[26] D. Tang and M. Baker. Analysis of a local-area wireless network. In
MobiCom, 2000.
[27] J. Yeo, M. Youssef, and A. Agrawala. A framework for wireless LAN
monitoring and its applications. In workshop on Wireless Security
(WiSe), 2004.
[28] Y. Zhang, L. Breslau, V. Paxson, and S. Shenker. On the
characteristics and origins of Internet ﬂow rates. In SIGCOMM,
2002.
[29] J. Zhao and R. Govindan. Understanding packet delivery
performance in dense wireless sensor networks. In SenSys, 2003.