病人编号
2003004
2003001
..+..
那必须要把联系方式变更为住宅电话和手机号，该怎么办呢，
2003001
病人编号
来看个例子，表5-1是一个病人信息表。
一句话总结：只要是关系数据库都满足第一范式。
如果把联系方式那列再分为手机和家庭电话，
2003012
2003011
2003010
2003009
2003008
2003007
2003006
2003005
2003004
2003003
2003002
号
崔小姐
合小姐
苏小姐
王小姐
高先生
赵先生
闪小姐
张小姐
崔小姐
合小姐
+.+...
苏小姐
王小姐
姓名
姓名
周先生
李先生
邱先生
董先生
高先生
赵先生
闪小姐
张小姐
崔小姐
合小姐
苏小姐
王小姐
姓名
性别
性别
女
女
女
女
男
男
女
女
女
女
女
女
表5-2病人信息表（不符合第一范式）
表5-3病人信息表（符合第一范式）
性别
1989.12.3
1980.5.3
1982.1.19
男
男
男
男
女
女
女
女
女
....
1987.5.6
1982.10.14
1978.2.26
1983.4.14
1984.6.26
1980.5.3
1989.12.3
1987.5.6
1982.10.14
出生日期
出生日期
表5-1
病人信息表
1987.2.14
1985.9.4
1985.6.16
1978.2.26
1983.4.14
1984.6.26
1982.1.19
1978.4.18
1980.5.3
1989.12.3
1987.5.6
1982.10.14
出生日期
子宫内膜增厚
痛经
孕后检查
勃起障碍
精子弱
流产
月经不调
白带增多
子宫内膜增厚
痛经
流产
孕后检查
+....
，就不符合第一范式，如表5-2所示。
就诊记录
就诊记录
生殖器感染
前列腺炎
包皮过长
早泄
勃起障碍
精子弱
月经不调
白带增多
子宫内膜增厚
痛经
流产
孕后检查
就诊记录
6402XXXX
6402XXXX
++....
6402XXXX
6402XXXX
6402XXXX
6402XXXX
6402XXXX
6402XXXX
，可如表5-3一样来调整。
6402XXXX
6402XXXX
6402XXXX
6402XXXX
住宅电话
联系方式
133XXXXXXX
133XXXXXXX
132XXXXXXX
133XXXXXXX
154XXXXXXX
148XXXXXXX
130XXXXXXX
131XXXXXXX
132XXXXXXX
134XXXXXXX
159XXXXXXX
158XXXXXXX
133XXXXXXX
135XXXXXXX
132XXXXXXX
133XXXXXXX
135XXXXXXX
......
132XXXXXXX
134XXXXXXX
159XXXXXXX
158XXXXXXX
133XXXXXXX
135XXXXXXX
132XXXXXXX
联系方式
手机号
---
## Page 145
数据：3名患者找同一个医生看病时，医生编号、姓名、职称等字段就重复了3次。
所示。
必须先满足第一范式（INF)。第二范式（2NF）要求实体的属性完全依赖于主关键字。
还是以上面的病人信息表来举例，下面在上表的基础上新增加了一些字段，如图5-1
下面试着把上面的一张表改为三张表，如图5-2～图5-4所示。
这里，出现了两个主关键字，显然不满足第二范式。从表里的数据来看，出现了冗余
{医生编号}←{姓名，性别，职称，科室编号，科室名称，负责人，诊室号}
{病人编号}一{姓名，性别，出生日期，
图5-1中的信息存在着以下依赖关系：
第二范式（2NF）是在第一范式（1NF）的基础上建立起来的，即满足第二范式（2NF)
第二范式（2NF）
978.
28
686
6.16
4.14
6.26
1.19
12
.5.
医
（主键：病人编号）
牛
口叫
编
图5-1病人信息表（增加字段)
文文男男
图5-2病人信息表
图
5-3
医生信息表
978.4.18
985.
978.2.
983.4.
1987.5.
980.
，就诊记录，联系方式}
生日
5.3
期
品
102
C
回
宫
孕
流
D
妇男男
4
得
科科科科
主主
溢治
医
南
王王贺贺
师
师
某某某菜
某某某某
第5章性能调优·131
王王王贺贺贺贺贺贺
王
+
某某
某某菜某某某菜
某
和
谋谋谋谋某
料
80
---
## Page 146
132
·第二部分故障诊断与性能优化篇
图5-8所示。
就需要通过画E-R图来确定实体之间的关系。我们来看看病人和医生信息的E-R图，如
符合第一至第三范式了。
所以不符合第三范式，将这个表再进行拆分，如图5-5和图5-6所示。
第二范式（2NF)。简而言之，不存在非关键字段对任一候选关键字段的传递函数依赖。
E-R图也称实体－联系图，提供了表示实体类型、属性和联系的方法，程序设计初期
经过上述调整，消除了数据冗余、更新异常、插人异常和删除异常。这些数据库表就
可以看到，科室名称依赖着科室编号、科室编号依赖着医生编号，
{科室编号}←{科室名称，负责人，
仍以上面的医生信息表为例，在图5-3里是存在着传递依赖关系的，如下所示：
另外，图5-4也跟着变动，如图5-7所示。
{医生编号}←{姓名，性别，职称}
第三范式（3NF）是第二范式（2NF）的一个子集，即满足第三范式（3NF）必须满足
3.第三范式（3NF）
这样就符合了第二范式，非关键字段都依赖于主键，但这样拆分是不符合第三范式的。
医生信息表（主键：医生编号，
20030531000001
信息表（主键：科室编号）
102
图5-6科室信息表（拆分后）
图5-5医生信息表（拆分后）
妇科
男科
奎
图5-4病人挂号信息表
手
，诊室号}
贺某某
王某
外键：科室编号）
外键：
病人编号、医生编号）
科室编号
诊室号
209
102
208
01
，这里存在数据冗余，
---
## Page 147
4个字节和按32个字节定位一条记录，谁快谁慢太明显了。涉及几个表做join时，效果就
键，强烈建议用int整型，不用guid，为什么？省空间啊。空间是什么？空间就是效率！按
5.2
为这种做法提供充分的理由。
范式，适度地做余，以达到提高查询效率的目的。注意，这里的反范式是适度的，必须
join很多表，而这会导致查询效率很低。所以有时候基于性能考虑，我们需要有意违反
型的系统来说，三范式是必须遵守的规则。当然，三范式最大的问题在于查询时通常需要
选择字段的一般原则是保小不保大，能用占用字节少的字段就不用大字段。比如，
小结：在开发应用程序时，设计的数据库要最大程度地遵守三范式，特别是对于OLTP
字段类型的选取
FK1
医生信息表
病人信息表
病人编号
医生编号
科室编号
20030531000001
就诊记录
003
号
图5-7病人挂号信息表（调整）
2003012
2003010
图5-8实例关系图
E-R图
北
102
FK3
12
K
病人挂号信息
科室信息表
挂号单流水号
科室编号、医生编号）
构人编号
科室名称
科室编号
医生编号
第5章性能调优·133
主
---
## Page 148
134·第二部分故障诊断与性能优化篇
结构如图5-9所示。
和BIGINT，表5-4列出了各种数值类型以及它们的允许范围和占用的内存空间。
5.2.1
且还会占用更少的带宽。因此，在日常选择字段时必须要遵守这一规则。
更明显了。更小的字段类型占用的内存就更少，
手机号是11位的，
varchar改成了int，结果在录人手机号时，溢出了，全部变成了2147483647。我们知道
注意
BIGINT
INT
MEDIUMINT
SMALLINT
TINYINT
在MySQL中支持的5个主要整数类型是TINYINT、SMALLINT、MEDIUMINT、INT
在这种情况下，可以考虑把int类型转换为bigint,
然后插人手机号，发现已经溢出，如图5-10所示。