is partially funded by the Engineering and Physical Sci-
ences Research Council (EPSRC) under grants EP/R012598/1,
EP/R008000/1, and by the European Union’s Horizon 2020
research and innovation programme under grant agreements
No. 779391 (FutureTPM) and No. 681402 (SOPHIA).
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:04:35 UTC from IEEE Xplore.  Restrictions apply. 
1478
REFERENCES
[1] Ittai Anati, Shay Gueron, Simon Johnson, and Vincent Scarlata. Innova-
tive technology for CPU based attestation and sealing. In Proceedings of
the 2nd international workshop on hardware and architectural support
for security and privacy, volume 13. ACM New York, NY, USA, 2013.
[2] Christian Aum¨uller, Peter Bier, Wieland Fischer, Peter Hofreiter, and
Jean-Pierre Seifert. Fault attacks on RSA with CRT: Concrete results
and practical countermeasures. In CHES 2002, 2002.
[3] Zelalem Birhanu Aweke, Salessawi Ferede Yitbarek, Rui Qiao, Reetu-
parna Das, Matthew Hicks, Yossi Oren, and Todd Austin. ANVIL:
Software-based protection against next-generation Rowhammer attacks.
ACM SIGPLAN Notices, 2016.
[4] Hagai Bar-El, Hamid Choukri, David Naccache, Michael Tunstall,
and Claire Whelan. The sorcerer’s apprentice guide to fault attacks.
Proceedings of the IEEE, 94(2):370–382, 2006.
[5] Guillaume Barbu, Hugues Thiebeauld, and Vincent Guerin. Attacks on
Java Card 3.0 – Combining Fault and Logical Attacks. In Dieter Goll-
mann, Jean-Louis Lanet, and Julien Iguchi-Cartigny, editors, CARDIS
’10, pages 148–163, Berlin, Heidelberg, 2010. Springer.
[6] Sarani Bhattacharya and Debdeep Mukhopadhyay. Curious Case of
Rowhammer: Flipping Secret Exponent Bits Using Timing Analysis.
In CHES, 2016.
[7] Eli Biham and Adi Shamir. Differential Fault Analysis of Secret
Key Cryptosystems.
In Proceedings of the 17th Annual International
Cryptology Conference on Advances in Cryptology – CRYPTO’97, pages
513 – 525, 1997.
[8] Andrea Biondo, Mauro Conti, Lucas Davi, Tommaso Frassetto, and
Ahmad-Reza Sadeghi. The guard’s dilemma: Efﬁcient code-reuse at-
tacks against Intel SGX. In 27th USENIX Security Symposium (USENIX
Security 18), pages 1213–1227, Baltimore, MD, 2018. USENIX Asso-
ciation.
[9] Dan Boneh, Richard A. Demillo, and Richard J. Lipton. On the
Importance of Checking Computations. In Proceedings of Eurocrypt’97,
pages 37 – 51, 1997.
[10] Ferdinand Brasser, Lucas Davi, David Gens, Christopher Liebchen,
and Ahmad-Reza Sadeghi. CAn’t touch this: Software-only mitigation
against Rowhammer attacks targeting kernel memory.
In USENIX
Security Symposium, 2017.
[11] Guoxing Chen, Sanchuan Chen, Yuan Xiao, Yinqian Zhang, Zhiqiang
Lin, and Ten H Lai. Sgxpectre: Stealing intel secrets from sgx enclaves
via speculative execution.
In 2019 IEEE European Symposium on
Security and Privacy (EuroS&P), pages 142–157. IEEE, 2019.
[12] Marco Chiappetta, Erkay Savas, and Cemal Yilmaz. Real time detec-
tion of cache-based side-channel attacks using hardware performance
counters. ePrint 2015/1034, 2015.
[13] Jonathan Corbet. Defending against Rowhammer in the Kernel, October
2016. online, accessed 2019-08-01: https://lwn.net/Articles/704920/.
[16]
[14] Victor Costan and Srinivas Devadas. Intel SGX explained. 2016.
[15] Christoph Dobraunig, Maria Eichlseder, Thomas Korak, Victor Lomn´e,
and Florian Mendel. Statistical Fault Attacks on Nonce-Based Authen-
ticated Encryption Schemes. In Jung Hee Cheon and Tsuyoshi Takagi,
editors, ASIACRYPT 2016, pages 369–395, Berlin, Heidelberg, 2016.
Springer.
´Ulfar Erlingsson, Yves Younan, and Frank Piessens. Low-level software
security by example. In Handbook of Information and Communication
Security, pages 633–658. Springer, 2010.
[17] Junfeng Fan and Ingrid Verbauwhede. An Updated Survey on Secure
ECC Implementations: Attacks, Countermeasures and Cost, pages 265–
282. Springer, Berlin, Heidelberg, 2012.
[18] T. Fuhr, E. Jaulmes, V. Lomn´e, and A. Thillard. Fault Attacks on AES
In 2013 Workshop on Fault Diagnosis
with Faulty Ciphertexts Only.
and Tolerance in Cryptography, pages 108–118, Aug 2013.
[19] Benedikt Gierlichs, J¨orn-Marc Schmidt, and Michael Tunstall. Infective
Computation and Dummy Rounds: Fault Protection for Block Ciphers
without Check-before-Output. In Alejandro Hevia and Gregory Neven,
editors, LATINCRYPT ’12, pages 305–321, Berlin, Heidelberg, 2012.
Springer.
[20] S. Govindavajhala and A. W. Appel. Using memory errors to attack a
virtual machine. In S&P 2003, pages 154–165, May 2003.
[21] Daniel Gruss, Moritz Lipp, Michael Schwarz, Daniel Genkin, Jonas
Jufﬁnger, Sioli O’Connell, Wolfgang Schoechl, and Yuval Yarom. An-
other Flip in the Wall of Rowhammer Defenses. In S&P, 2018.
[22] Daniel Gruss, Cl´ementine Maurice, and Stefan Mangard. Rowham-
mer.js: A Remote Software-Induced Fault Attack in JavaScript.
DIMVA, 2016.
In
[23] Daniel Gruss, Cl´ementine Maurice, Klaus Wagner, and Stefan Mangard.
Flush+Flush: A Fast and Stealthy Cache Attack. In DIMVA, 2016.
[24] Shay Gueron. A memory encryption engine suitable for general purpose
processors. ePrint 2016/204, 2016.
[25] Jago Gyselinck, Jo Van Bulck, Frank Piessens, and Raoul Strackx. Off-
limits: Abusing legacy x86 memory segmentation to spy on enclaved
execution. In ESSoS, 2018.
[26] Hagai Bar-El Hamid, Hamid Choukri, David Naccache, Michael Tun-
stall, and Claire Whelan. The Sorcerer’s Apprentice Guide to Fault
Attacks. In Proceedings of the IEEE, volume 94, 2006.
[27] Nishad Herath and Anders Fogh. These are Not Your Grand Daddys
CPU Performance Counters – CPU Hardware Performance Counters for
Security. In Black Hat Brieﬁngs, 2015.
[28] Petr Hosek and Cristian Cadar. Varan the unbelievable: An efﬁcient
n-version execution framework. In ACM SIGPLAN Notices, volume 50,
pages 339–353. ACM, 2015.
[29] Michael Hutter and J¨orn-Marc Schmidt. The temperature side channel
and heating fault attacks. In International Conference on Smart Card
Research and Advanced Applications, pages 219–235. Springer, 2013.
[30] Inﬁneon. OptiMOS IPOL DC-DC converter single-input voltage,
online, accessed 2019-07-29:
30 A buck regulators with SVID.
https://www.inﬁneon.com/cms/de/product/power/dc-dc-converter/
integrated-dc-dc-pol-converters/ir38163m/, 2019.
11.1:
Regulator-Down
[31] Intel.
Processor
Voltage
Power
2019-07-29:
Delivery Design Guide.
https://www.intel.com/content/www/us/en/power-management/
voltage-regulator-down-11-1-processor-power-delivery-guidelines.
html, 2009.
accessed
online,
[32] Intel. L1 Terminal Fault SA-00161, August 2018.
[33] Intel. 7th Generation Intel Processor Families for U/Y Platforms and 8th
Generation Intel Processor Family for U Quad-Core and Y Dual Core
Platforms. Datasheet, Volume 1 of 2, revision 006, Jan 2019.
[34] Intel. Developer Reference for Intel Integrated Performance Primitives
Cryptography – Example of Using RSA Primitive Functions.
online,
https://software.intel.com/en-us/
ipp-crypto-reference-2019-example-of-using-rsa-primitive-functions,
2019.
2019-07-29:
accessed
[35] Intel. Get Started with the SDK. online, accessed 2019-05-10: https:
[36] Intel. Intel R(cid:2) 64 and IA-32 Architectures Software Developer’s Manual;
//software.intel.com/en-us/sgx/sdk, 2019.
Volume 2 (2A, 2B, 2C & 2D). Number 325383-070US. May 2019.
[37] Gorka Irazoqui, Thomas Eisenbarth, and Berk Sunar. MASCAT:
Stopping microarchitectural attacks before execution. ePrint 2016/1196,
2017.
[38] Yeongjin Jang, Jaehyuk Lee, Sangho Lee, and Taesoo Kim. SGX-Bomb:
Locking Down the Processor via Rowhammer Attack. In SysTEX, 2017.
online,
accessed 2019-07-30: https://software.intel.com/en-us/blogs/2018/12/09/
an-update-on-3rd-party-attestation, December 2018.
An update on 3rd Party Attestation.
[39] Simon Johnson.
[40] Naghmeh Karimi, Arun Karthik Kanuparthi, Xueyang Wang, Ozgur
Sinanoglu, and Ramesh Karri. Magic: Malicious aging in circuits/cores.
ACM Transactions on Architecture and Code Optimization (TACO),
12(1), 2015.
[41] Yoongu Kim, Ross Daly, Jeremie Kim, Chris Fallin, Ji Hye Lee,
Donghyuk Lee, Chris Wilkerson, Konrad Lai, and Onur Mutlu. Flipping
bits in memory without accessing them: An experimental study of
DRAM disturbance errors. In ISCA, 2014.
[42] Paul Kocher, Jann Horn, Anders Fogh, Daniel Genkin, Daniel Gruss,
Werner Haas, Mike Hamburg, Moritz Lipp, Stefan Mangard, Thomas
Prescher, Michael Schwarz, and Yuval Yarom. Spectre Attacks: Ex-
ploiting Speculative Execution. In S&P, 2019.
[43] Koen Koning, Herbert Bos, and Cristiano Giuffrida. Secure and efﬁcient
multi-variant execution using hardware-assisted process virtualization.
In 2016 46th Annual IEEE/IFIP International Conference on Depend-
able Systems and Networks (DSN), pages 431–442. IEEE, 2016.
[44] Andrew Kwong, Daniel Genkin, Daniel Gruss, and Yuval Yarom.
In
RAMBleed: Reading Bits in Memory Without Accessing Them.
41st IEEE Symposium on Security and Privacy (S&P), 2020.
[45] Jaehyuk Lee, Jinsoo Jang, Yeongjin Jang, Nohyun Kwak, Yeseul Choi,
Changho Choi, Taesoo Kim, Marcus Peinado, and Brent ByungHoon
Kang. Hacking in Darkness: Return-oriented Programming against Se-
cure Enclaves. In 26th USENIX Security Symposium (USENIX Security
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:04:35 UTC from IEEE Xplore.  Restrictions apply. 
1479
17), pages 523–539, Vancouver, BC, 2017. USENIX Association.
[46] Sangho Lee, Ming-Wei Shih, Prasun Gera, Taesoo Kim, Hyesoon Kim,
and Marcus Peinado.
Inferring ﬁne-grained control ﬂow inside SGX
enclaves with branch shadowing. In USENIX Security Symposium, 2017.
[47] Francis X McKeen, Carlos V Rozas, Uday R Savagaonkar, Simon P
Johnson, Vincent Scarlata, Michael A Goldsmith, Ernie Brickell,
Jiang Tao Li, Howard C Herbert, Prashant Dewan, et al. Method and
apparatus to provide secure application execution, July 21 2015. US
Patent 9,087,200.
[48] Microsoft. Open Enclave SDK. online, accessed 2019-05-10: https:
//openenclave.io/sdk/, 2019.
[49] Miha Elerˇsiˇc. Guide to Linux undervolting for Haswell and never
online, accessed 2019-07-29: https://github.com/mihic/
Intel CPUs.
linux-intel-undervolt, 2019.
[50] Ahmad Moghimi, Thomas Eisenbarth, and Berk Sunar. MemJam: A
false dependency attack against constant-time crypto implementations
in SGX. In CT-RSA, 2018.
[51] NotebookReview. The ThrottleStop Guide.
online, accessed 2019-
07-29: http://forum.notebookreview.com/threads/the-throttlestop-guide.
531329/, 2019.
[52] Nahmsuk Oh, Philip P Shirvani, and Edward J McCluskey. Error
IEEE
detection by duplicated instructions in super-scalar processors.
Transactions on Reliability, 51(1):63–75, 2002.
[53] Matthias Payer. HexPADS: a platform to detect “stealth” attacks.
In
ESSoS, 2016.
[54] Christian Priebe, Divya Muthukumaran, Joshua Lind, Huanzhou Zhu,
Shujie Cui, Vasily A Sartakov, and Peter Pietzuch. SGX-LKL: Se-
curing the host OS interface for trusted execution.
arXiv preprint
arXiv:1908.11143, 2019.
[55] Kaveh Razavi, Ben Gras, Erik Bosman, Bart Preneel, Cristiano Giuf-
frida, and Herbert Bos. Flip feng shui: Hammering a needle in the
software stack. In USENIX Security Symposium, 2016.
[56] George A Reis, Jonathan Chang, Neil Vachharajani, Ram Rangan, and
David I August. SWIFT: Software implemented fault tolerance.
In
Proceedings of the international symposium on Code generation and
optimization, pages 243–254. IEEE Computer Society, 2005.
[57] RightMark Gathering. RMClock Utility. online, accessed 2019-07-29:
http://cpu.rightmark.org/products/rmclock.shtml, 2019.
[58] Michael Schwarz, Daniel Gruss, Samuel Weiser, Cl´ementine Maurice,
and Stefan Mangard. Malware Guard Extension: Using SGX to Conceal
Cache Attacks . In DIMVA, 2017.
[59] Michael Schwarz, Moritz Lipp, Daniel Moghimi, Jo Van Bulck, Julian
Stecklina, Thomas Prescher, and Daniel Gruss. ZombieLoad: Cross-
privilege-boundary data sampling. In Proceedings of the 26th ACM Con-
ference on Computer and Communications Security (CCS’19). ACM,
November 2019.
[60] Mark Seaborn and Thomas Dullien. Exploiting the DRAM rowhammer
bug to gain kernel privileges. In Black Hat Brieﬁngs, 2015.
[61] Jaebaek Seo, Byoungyoung Lee, Seong Min Kim, Ming-Wei Shih, Insik
Shin, Dongsu Han, and Taesoo Kim. SGX-Shield: Enabling Address
Space Layout Randomization for SGX Programs. In NDSS, 2017.
[62] Sergei P. Skorobogatov. Copy Protection in Modern Microcontrollers,
2001. online; accessed 2019-07-29: http://www.cl.cam.ac.uk/∼sps32/
mcu lock.html.
[63] Sergei P. Skorobogatov and Ross J. Anderson. Optical Fault Induction
Attacks. In Burton S. Kaliski, C¸ etin K. Koc¸, and Christof Paar, editors,
CHES 2002, pages 2–12, Berlin, Heidelberg, 2003. Springer.
[64] Adrian Tang. Security Engineering of Hardware-Software Interface.
PhD thesis, Columbia University, 2018.
[65] Adrian Tang,
Sethumadhavan,
CLKSCREW: Exposing the perils of
management. In USENIX Security Symposium, 2017.
and
Salvatore
security-oblivious
Simha
Stolfo.
energy
[66] Florian Tramer, Fan Zhang, Huang Lin, Jean-Pierre Hubaux, Ari Juels,
and Elaine Shi. Sealed-glass proofs: Using transparent enclaves to prove
and sell knowledge.
In 2017 IEEE European Symposium on Security
and Privacy (EuroS&P), pages 19–34. IEEE, 2017.
[67] Chia-Che Tsai, Donald E Porter, and Mona Vij. Graphene-SGX: A
In 2017
practical library OS for unmodiﬁed applications on SGX.
USENIX Annual Technical Conference (USENIX ATC), 2017.
[68] Michael Tunstall, Debdeep Mukhopadhyay, and Subidh Ali. Differential
fault analysis of the advanced encryption standard using a single fault.
In Claudio A. Ardagna and Jianying Zhou, editors, Information Security
Theory and Practice. Security and Privacy of Mobile Devices in Wireless
Communication, pages 224–233, Berlin, Heidelberg, 2011. Springer
Berlin Heidelberg.
[69] Jo Van Bulck, Marina Minkin, Oﬁr Weisse, Daniel Genkin, Baris
Kasikci, Frank Piessens, Mark Silberstein, Thomas F. Wenisch, Yuval
Yarom, and Raoul Strackx. Foreshadow: Extracting the keys to the
Intel SGX kingdom with transient out-of-order execution. In USENIX
Security Symposium, 2018.
[70] Jo Van Bulck, David Oswald, Eduard Marin, Abdulla Aldoseri, Flavio
Garcia, and Frank Piessens. A tale of two worlds: Assessing the
vulnerability of enclave shielding runtimes. In Proceedings of the 26th
ACM Conference on Computer and Communications Security (CCS’19).
ACM, November 2019.
[71] Jo Van Bulck, Frank Piessens, and Raoul Strackx. SGX-Step: A practical
attack framework for precise enclave execution control. In Proceedings
of the 2nd Workshop on System Software for Trusted Execution, page 4.
ACM, 2017. https://github.com/jovanbulck/sgx-step.
[72] Jo Van Bulck, Frank Piessens, and Raoul Strackx. Nemesis: Studying
Microarchitectural Timing Leaks in Rudimentary CPU Interrupt Logic.
In Proceedings of the 25th ACM Conference on Computer and Commu-
nications Security (CCS’18). ACM, October 2018.
[73] Jo Van Bulck, Nico Weichbrodt, R¨udiger Kapitza, Frank Piessens, and
Raoul Strackx. Telling your secrets without page faults: Stealthy page
table-based attacks on enclaved execution. In Proceedings of the 26th
USENIX Security Symposium. USENIX Association, August 2017.
[74] Victor van der Veen, Yanick Fratantonio, Martina Lindorfer, Daniel
Gruss, Cl´ementine Maurice, Giovanni Vigna, Herbert Bos, Kaveh
Razavi, and Cristiano Giuffrida. Drammer: Deterministic Rowhammer
Attacks on Mobile Platforms. In CCS, 2016.
[75] Stephan van Schaik, Alyssa Milburn, Sebastian ¨Osterlund, Pietro Frigo,
Giorgi Maisuradze, Kaveh Razavi, Herbert Bos, and Cristiano Giuffrida.
RIDL: Rogue In-ﬂight Data Load. In S&P, May 2019.
[76] Stijn Volckaert, Bart Coppens, Alexios Voulimeneas, Andrei Homescu,
Per Larsen, Bjorn De Sutter, and Michael Franz. Secure and efﬁcient
application monitoring and replication.
In 2016 USENIX Annual
Technical Conference (ATC16), pages 167–179, 2016.
[77] Yuan Xiao, Xiaokuan Zhang, Yinqian Zhang, and Radu Teodorescu.
One Bit Flips, One Cloud Flops: Cross-VM Row Hammer Attacks and
Privilege Escalation. In USENIX Security Symposium, 2016.
[78] Yuanzhong Xu, Weidong Cui, and Marcus Peinado. Controlled-channel
attacks: Deterministic side channels for untrusted operating systems. In