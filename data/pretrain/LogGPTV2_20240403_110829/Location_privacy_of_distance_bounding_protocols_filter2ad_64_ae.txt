### 优化后的文本

#### 因为整个序列由全1（左侧）或全0（右侧）组成。
通过排除这两种极端情况，我们确保翻转两个最低有效位永远不会生成HM序列。

为了证明只有当所有位都是0（或全1）时，翻转最后两位才会生成HM序列，我们使用图9中的两个示例。假设比特序列除了以'1 0'或'0 1'结尾外没有其他限制。图9的两个子图分别展示了HM序列以'1 0'和'0 1'结尾的情况。我们将仅描述'1 0'（左侧）的情况，因为解释同样适用于另一种情况。

第一行描绘了通过HM检测器的伪随机比特流的六位。假设b0到b4与HM序列匹配，则意味着最后两位是'1 0'。第二行描绘了最后两位被翻转的情况。此时，如果生成了一个新的有效HM序列，则b2必须为1，否则不会生成有效的HM序列。这又要求其余所有位都为1才能生成有效的HM序列。

这意味着验证者要生成一个160位的HM序列，应先生成一个159位的随机数，然后附加一个0或1，使HM序列的最后两位分别为'0 1'或'1 0'。唯一的限制是随机数不能全是0或全是1。

#### 攻击者的猜测空间
传输流可以防止攻击者获取验证者何时将nonce发送给证明者的信息。如前所述，验证者将建立流并发送一些随机无意义的数据一段时间后，再发送隐藏标记和nonce。这段时间在设置窗口ws内随机选择。攻击者有两种方法来猜测nonce的起始位置：一是猜测HM序列，其概率为2^(j-1)，其中j是HM的长度（一旦猜对了j-1位，最后一位也就确定了），例如对于160位的HM，概率为2^159；二是尝试猜测HM序列的起始位置而不需要实际猜测序列本身。

对于1 Gb/s的比特率和500毫秒的设置窗口，有5 × 10^8 ≈ 2^30个可能的HM序列起始点。然而，由于HM必须以'0 1'或'1 0'结尾，攻击者可以排除那些不以这些组合结尾的起始点（即以'1 1'或'0 0'结尾），假设攻击者知道HM的长度。因此，攻击者的猜测空间约为2.5 × 10^8 ≈ 2^29个可能的起始位置。鉴于攻击者只能进行一次猜测，我们认为这是足够的。如果需要更大的猜测空间，证明者可以增加设置窗口ws或提高流比特率。

攻击者只能进行一次猜测的原因是，尽管他可以多次猜测，但他无法验证猜测是否正确，即使他碰巧猜对了。因此，如果他想攻击协议，他必须做出一次猜测并希望它是正确的。

#### 比特率和调制
验证者通过计算从开始传输Nv到接收到Np ⊕ Nv之间的比特数来测量证明者响应挑战所需的时间。这是唯一可行的方法，因为连续流已经在证明者必须返回Np ⊕ Nv之前建立，因此证明者只能向流中添加数据而不能发送异步消息。

因此，证明者响应的时间粒度等于比特率。这意味着比特率必须足够高，以提供良好的距离粒度。如果比特率为1 Gb/s，即每纳秒一个比特，距离粒度约为30厘米。虽然1+ Gb/s的比特率在消费电子中尚未普遍使用，但市场上已有几种有趣的产品（截至2008年初）。WUSB [2] 已实现高达480 Mbit/s的比特率，距离粒度约为60厘米。还有索尼的TransferJet [3] 在最佳条件下可达560 Mbit/s（约50厘米），无线网络标准IEEE 802.11n [6] 理论上可提供高达248 Mbit/s的速度（约1.15米）。

IEEE 802.15.3-2003 [25] 是一种用于高速（1100至1055 Mb/s）无线个人局域网（WPANs）的MAC和物理层标准，在较短距离内提供27至28厘米的距离粒度。

不仅比特率对协议很重要，调制方式也很重要。假设通过QPSK [1] 调制实现了1 Gb/s的比特率，这意味着无线电每两纳秒接收两个比特，从而将距离粒度降低到60厘米。

#### 使用DSSS隐藏流
我们在4.4节中看到，单独使用DSSS作为保护机制是不可行的，因为其获取时间不可预测。然而，在基于流的协议中，这种不可预测性不是问题，因为流的第一位的确切到达时间无关紧要。正如4.4节所指出的，一旦连接建立并且验证者和证明者同步，DSSS系统引入的延迟可以忽略不计。

为了让证明者和验证者使用DSSS，验证者必须在协议开始时选择一个扩展码，并将其加密后连同HM序列一起发送给证明者。之后，流按照前述方式建立，只是现在使用验证者选择的扩展码通过DSSS进行传输。

使用DSSS会迫使攻击者在猜测HM在流中的位置之前先找到正确的扩展码。如果信号扩展到一个大的频率带宽，攻击者甚至可能无法将其从信道背景噪声中分离出来。在这种情况下，流中使用隐藏标记是多余的。

在基于流的距离绑定协议之上使用DSSS的另一个好处是，多个节点可以同时执行协议而干扰最小，从而使系统更稳健。如果不使用DSSS，协议将占用整个流持续时间内的信道。

唯一的缺点是，DSSS要么增加了（已经很高的）流比特率，要么降低了距离粒度。这是一个技术限制，随着新的高速UWB系统的普及，这个问题可能会变得不那么重要。

### 相关工作
距离绑定的概念最早由Brands和Chaum [4] 于1993年提出。自那时以来，该概念已在无线网络 [23, 27, 30] 和传感器网络 [15, 29, 28, 22] 的多种应用中得到使用。此外，还提出了针对RFID [10, 8, 16] 和超宽带（UWB）设备 [14, 9] 的距离绑定协议。

迄今为止，距离绑定协议泄漏的信息受到了很少的关注。据我们所知，唯一试图解决本文分析的一些问题的是Sahinoglu、Orlik和Molisch [20] 的专利，他们在其中提出了一种为证明者提供更高隐私的协议。

[20] 中的协议与我们在第4节中分析的协议类似，证明者和验证者在实际测距阶段开始前同意一个延迟。该解决方案没有考虑证明者恶意且试图欺骗距离的情况，而只是试图为诚实的证明者提供更高的隐私。隐私是通过从一组固定的自相关码中随机选择一个来实现的。

虽然[20] 中提出的解决方案在一定程度上解决了信息泄漏的问题，但其范围与我们的研究显著不同。它只针对外部攻击者对证明者的隐私，并且没有提供针对攻击者离线尝试所有自相关码的攻击的保护。

我们的工作首次全面分析了距离绑定协议泄漏的信息，并提出了一种解决方案，该方案可以防止恶意证明者、被动窃听者（包括离线攻击）以及试图主动发起距离绑定会话的攻击者。

### 结论
距离绑定协议已被提议用于许多安全关键应用，包括安全定位和访问控制。在这项工作中，我们展示了现有的距离绑定协议会向监听通信的攻击者泄露距离和位置信息。我们识别了代表攻击者不同先验知识的八种场景。在每个场景中，我们分析了泄漏了多少信息以及攻击者如何重建证明者和验证者之间的距离。我们还展示了攻击者如何找到自己相对于证明者和验证者的位置。我们进一步分析了不同的简单对策，并讨论了为什么它们不能提供足够的保护以防止距离绑定协议中的信息泄漏。最后，我们提出了一种位置私密的距离绑定协议，该协议保留了其他距离绑定协议的所有吸引人的特性，但不会向攻击者泄露任何范围和距离信息。因此，我们的协议可用于位置私密的距离绑定或作为位置私密的安全定位的基础。

### 参考文献
[此处省略具体参考文献列表，但请确保按原格式列出所有引用]

---

通过上述优化，文本变得更加清晰、连贯和专业。希望这对你有所帮助！