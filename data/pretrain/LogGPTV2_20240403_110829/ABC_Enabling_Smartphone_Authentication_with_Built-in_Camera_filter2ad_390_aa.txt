title:ABC: Enabling Smartphone Authentication with Built-in Camera
author:Zhongjie Ba and
Sixu Piao and
Xinwen Fu and
Dimitrios Koutsonikolas and
Aziz Mohaisen and
Kui Ren
ABC: Enabling Smartphone Authentication with Built-in Camera
the Built-in Camera. In contrast
Abstract—In this paper, we propose ABC, a real-time smart-
phone Authentication protocol utilizing the photo-response non-
uniformity (PRNU) of
to
previous works that require tens of images to build reliable
PRNU features for conventional cameras, we are the ﬁrst to
observe that one image alone can uniquely identify a smartphone
due to the unique PRNU of a smartphone image sensor. This
new discovery makes the use of PRNU practical for smartphone
authentication. While most existing hardware ﬁngerprints are
vulnerable against forgery attacks, ABC defeats forgery attacks
by verifying a smartphone’s PRNU identity through a challenge
response protocol using a visible light communication channel.
A user captures two time-variant QR codes and sends the two
images to a server, which veriﬁes the identity by ﬁngerprint and
image content matching. The time-variant QR codes can also
defeat replay attacks. Our experiments with 16,000 images over
40 smartphones show that ABC can efﬁciently authenticate user
devices with an error rate less than 0.5%.
I.
INTRODUCTION
Reliably identifying and authenticating smartphones is
critical in our daily life since they are increasingly being
used to manage sensitive data such as private messages and
ﬁnancial data. Federal Reserve System has reported that 53%
of smartphone users are using mobile banking, and 28% of
them are using mobile payments [36]. The widely adopted
ﬁnancial applications make smartphones high-value targets in
cybercrimes. Therefore, there is a vast amount of works study-
ing and implementing Multi-Factor Authentication systems
which verify device’s identity along with user’s. Providing
enhanced security without degrading user experience calls for
secure and practical smartphone identiﬁcation methods.
In the literature, one prevalent methodology to identify
smartphones is to differentiate the ﬁngerprints of their built-in
sensors. Sensor ﬁngerprint is a systematic distortion of sensor
reading incurred by manufacturing imperfection. Such distor-
tion remains constant for each individual hardware and exhibits
strong diversity among different devices. It has been proved
that the ﬁngerprints of motion sensors, WiFi chipsets and
speakers [19], [35], [6], [8] are respectively strong enough to
differentiate smartphones. However, most of existing methods
fail to meet two security requirements: Fingerprint Leakage
Resilience and Fingerprint Forgery Resilience [4]. Although
it is infeasible to steal a sensor in a smartphone, the signals
generated by that sensor, in most cases, are available to the
public. An adversary who has collected those signals might
Permission to freely reproduce all or part of this paper for noncommercial
purposes is granted provided that copies bear this notice and the full citation
on the ﬁrst page. Reproduction for commercial purposes is strictly prohibited
without the prior written consent of the Internet Society, the ﬁrst-named author
(for reproduction of an entire paper only), and the author’s employer if the
paper was prepared within the scope of employment.
NDSS ’18, 18-21 February 2018, San Diego, CA, USA
Copyright 2018 Internet Society, ISBN 1-1891562-49-5
http://dx.doi.org/10.14722/ndss.2018.23xxx
extract the victim’s hardware ﬁngerprint and synthesize forged
signals [8], [13]. This vulnerability to the ﬁngerprint forgery
attack makes them infeasible in practice. It remains open to
ﬁnd usable and secure smartphone ﬁngerprinting method that
can provide physical layer proof of device’s identity.
The Photo-Response Non-Uniformity (PRNU) [31] of an
image sensor has been used as a physical layer ﬁngerprint
identifying conventional digital cameras in digital forensics.
Given a query image taken by a camera of interest, the camera
can be identiﬁed through correlating the query image’s noise
residue against candidate devices’ reference ﬁngerprints. In
this paper, we explore using the PRNU of an image sensor on
a smartphone to authenticate a user’s device to defeat various
frauds and attacks.
There are two grand challenges of using PRNU to identify
and authenticate smartphones. First, eliminating the large reg-
istration overhead. For conventional digital cameras, normally
at least 50 images are required to derive a usable reference ﬁn-
gerprint. Such a large registration overhead is often prohibitive
for a practical smartphone authentication protocol. Second,
defending against impersonation attack. The PRNU-based ﬁn-
gerprinting method is also vulnerable to ﬁngerprint forgery
attacks [26], [34], [23], [37]. To impersonate a victim device,
an adversary could estimate the victim smartphone’s ﬁnger-
print from public images and embed the obtained ﬁngerprint
into an image captured by her own device. Existing forgery
detection mechanisms suffer from either poor reliability [26]
or huge transmission and storage overhead [34].
We performed extensive experiments to understand the
characteristics of PRNU of smartphone cameras in order to
address these challenges in using PRNU to identify and authen-
ticate smartphones. A key observation is that, compared with
conventional digital cameras, a smartphone’s image sensor is
tens of times smaller. With the same level of manufacturing
imperfection, the reduction in the image sensor’s dimension
ampliﬁes the pixels’ dimensional non-uniformity and generates
a much stronger PRNU. Our experimental results reveal that
the PRNU of smartphone cameras is so strong that one
image alone can uniquely identify a smartphone camera. Based
on this observation, we propose directly using the PRNU
estimated from the noise residue of an image taken by a
smartphone as the reference ﬁngerprint. This will signiﬁcantly
reduce the registration overhead of such an authentication
system.
Given the unique PRNU of smartphone cameras, we pro-
pose ABC, a PRNU-based smartphone authentication pro-
tocol that can also defeat various attacks. ABC involves a
registration phase and an authentication phase. During the
registration phase, the user uploads a freshly captured image
to the veriﬁer/server. From this image, the veriﬁer estimates a
reference ﬁngerprint for the user’s smartphone. In the authen-
tication phase, the veriﬁer challenges the user to photograph
and upload two time-variant QR codes, in each of which an
abstract of the ongoing transaction, a random number and
a time stamp are encoded. Each QR code image is also
embedded with a semi-fragile probe signal that can survive
photographing but not ﬁngerprint removal. The user then puts
her smartphone parallel to the screen and takes pictures of
those two QR codes. She veriﬁes the messages in the QR
codes and uploads the images to the veriﬁer. Upon receiving
the images captured by the user, the veriﬁer authenticates the
user’s device through the following procedure: 1) Detect the
existence of the two time-variant QR codes and the target
smartphone’s ﬁngerprint. Replay attacks and man in the middle
attacks can be defeated by the two QR codes. 2) Detect
ﬁngerprint forgery by measuring the similarity between the two
received QR code images. This is based on our observation that
two images forged by the adversary contain both the ﬁngerprint
of the victim device and the ﬁngerprint of the adversary’s
device, and incur a signiﬁcantly higher similarity value. 3)
Detect ﬁngerprint removal through checking the strength of
the probe signal embedded in each received image in case that
the adversary removes the PRNU of her own device from a
forged image.
Our major contributions are summarized as follows:
1
To the best of our knowledge, we are the ﬁrst to ex-
plore the PRNU-based smartphone ﬁngerprinting on a
large scale. We are the ﬁrst to observe that one image
alone can uniquely identify a smartphone due to their
unique PRNU. We conducted extensive experiments
by collecting images taken by smartphones through
Amazon Mechanical Turk and can achieve a total
error rate below 0.5% in differentiating smartphone
cameras. This new discovery makes the use of PRNU
practical for smartphone authentication.
2 We propose a real-time smartphone authentication
protocol that can provide reliable authentication and
defeat various attacks. It has the following salient fea-
tures: 1) ABC achieves secure physical layer smart-
phone authentication with a registration overhead of
merely one photoshot. 2) Our experiments on 4,000
forged images demonstrate that ABC can detect the
ﬁngerprint forgery attack with a total error rate less
than 0.47%. 3) The usability of the proposed protocol
is preserved since the requirement for taking photos
is familiar and convenient to smartphone users.
The rest of this paper is organized as follows. Section II
reviews the current PRNU-based digital camera ﬁngerprinting
method. Section III formulates the problem to be addressed
in this paper. Section IV presents our smartphone authenti-
cation protocol. Section V analyzes the security feature of
the proposed protocol. Section VI conducts the performance
evaluation. Section VII reviews the related existing work on
hardware ﬁngerprinting. Section VIII concludes this research.
II. BACKGROUND
In this section, we ﬁrst introduce the generic Photo Re-
sponse Non-Uniformity (PRNU) based camera ﬁngerprinting
technique, which establishes a link between digital images and
the corresponding cameras. We then introduce the ﬁngerprint
forgery attack against this ﬁngerprinting technique and analyze
existing countermeasures.
2
A. PRNU-based Camera Fingerprinting
PRNU [31], [22] is caused by an image sensor’s non-
uniform sensitivity to light. It introduces a multiplicative factor
to the actual optical view. Denote the real sensor output as I
and the actual optical view as I(0). Any image captured by a
digital camera can be represented as Equation (1) [6],
I = I(0) + I(0)K + Θ,
(1)
where K is the camera’s PRNU, and Θ represents other noise
components such as shot noise and read-out noise.
Since PRNU behaves like a white Gaussian noise variable
with a variance between 3 to 5 [31], [10], it can be extracted
using a denoising ﬁlter. The extracted noise residue W(i) can
be represented as Equation (2) [11],
W(i) = I(i)K + Ξ(i),
(2)
where Ξ(i) is a random noise component combining Θ and
other minor components.
For conventional digital cameras, the noise residue of its
captured image is so noisy that it can not be directly used as a
ﬁngerprint. Therefore, an averaging process is used to reduce
random components (Ξ(i)) and to enhance PRNU (K) [7]. It
suppresses random noise components through averaging the
noise residues of multiple images taken by the same camera.
The obtained ﬁngerprint can be represented as Equation (3),
(cid:80)N
(cid:80)N
ˆK =
i=1 W(i)I(i)
i=1(I(i))2
= K + ∆,
(3)
where ∆ is the difference between the estimated ﬁngerprint ˆK
and the real ﬁngerprint K.
The quality of the estimated ﬁngerprint is deﬁned as q =
corr(K, ˆK) [26], which is the similarity between the estimated
ﬁngerprint and the real ﬁngerprint. For each individual device,
q is positively correlated to the number of images used in the
averaging process. The most commonly used similarity metric
is Peak to Correlation Energy (PCE) [25].
To determine if a query image is taken by a camera
of interest, existing ﬁngerprint detection strategies correlate
the image’s noise residue against
that camera’s reference
ﬁngerprint extracted from at least 50 images. Following this
strategy, Goljan et al. [27] has proved camera ﬁngerprint’s
accuracy and user capacity on over one million images taken
by 6896 individual cameras. They show that camera ﬁngerprint
can achieve a false rejection rate less than 2.38% at false
acceptance rate below 0.002% in differentiating conventional
digital cameras.
B. Fingerprint Forgery Attack and Countermeasures
With a PRNU ﬁngerprint ˆK estimated from a victim’s
public images, an adversary could fabricate forged images
using Equation (4),
J(cid:48) = J(1 + α ˆK),
(4)
where J is a foreign image and α controls the strength of
the injected ﬁngerprint. With an appropriate α, the fabricated
image could easily pass various ﬁngerprint detection schemes.
The state-of-the-art ﬁngerprint forgery detection mecha-
nisms include fragile ﬁngerprint [34] and triangle test [26].
Fragile ﬁngerprint explores the component of the PRNU noise
that is fragile and removed by the lossy JPG compression.
Based on the observation that the majority of images shared
online are in JPG format, this mechanism assumes that an
adversary derives the ﬁngerprint from public JPG images and
such a ﬁngerprint will not contain the fragile ﬁngerprint. If
a user is required to submit uncompressed raw images for
authentication, a ﬁngerprint forgery attack can be detected
through correlating the query image’s noise residue against the
reference fragile ﬁngerprint of the camera of interest. However,
this approach requires 300 raw images to estimate the refer-
ence fragile ﬁngerprint, which will incur a huge transmission
overhead. Moreover, the robustness of this approach relies
on the secrecy of raw images. Triangle test is based on the
observation that the injected ﬁngerprint ˆK shares additional
noise components Ξ(i) with every noise residue W(i) used by
the adversary. These shared Ξ(i)s will sharply increase the PCE
value between ˆK and all W(i)s. Therefore, it tests all candidate
images that might be accessible to the adversary in order to
detect forged images. However, due to the popularity of image
sharing, it is infeasible for the veriﬁer to collect all candidate
images that are accessible to the adversary.
III. PROBLEM STATEMENT
In this section, we ﬁrst introduce the system model and
threat model. We then discuss design goals of the authentica-
tion system.
A. System Model
Smartphone authentication is a process of verifying the
possession factor (i.e., the smartphone) attached to the claimed
identity of a user. Conventionally, the veriﬁcation of a smart-
phone is achieved using a secret key controlled by a pre-
installed app or an additional hardware (e.g., the secure el-
ement in iPhone). In this work, we propose to authenticate
a smartphone through tracking its PRNU ﬁngerprint as it
requires no additional hardware and is physically unclonable.
It is worth mentioning that the proposed ABC can be integrated
with conventional cryptographic approaches to provide greater
security without degrading the user experience.
Fig.1 shows the system model of ABC. The system in-
volves three entities: a user, her smartphone and veriﬁer.
The user performs a transaction or login and needs to be
authenticated. The smartphone is equipped with a built-in
camera and serves as a security token. The user interacts with
the veriﬁer’s interface and provides the veriﬁer this security
token in order to be authenticated. The veriﬁer consists of the
interface and a server. The server maintains a database of each
registered user and her smartphone reference ﬁngerprint.
Without loss of generality, we now use a point of sale
(POS) terminal to illustrate the authentication process through
PRNU of a smartphone. The veriﬁer (bank) maintains a
database that stores each user’s account identiﬁer (e.g., card
number) and reference PRNU ﬁngerprint. When a user requests
to make a payment on the POS terminal, the veriﬁer challenges
the user who has to use her smartphone and take pictures of
what is shown on the terminal’s screen. The user uploads the
Fig. 1. System model. The veriﬁer authenticate a user’s smartphone through
tracking the ﬁngerprint of its built-in camera. The veriﬁer ﬁrst challenges the
smartphone to capture and upload the image shown on its interface. Then, the
veriﬁer extracts the ﬁngerprint of the received image and correlates it to the
reference ﬁngerprint to authenticate the smartphone.
captured images and her account identiﬁer to the bank. The
veriﬁer then extracts the ﬁngerprint of the user’s smartphone
from the images and correlates it to the reference ﬁngerprint
of the account of interest. If the correlation is higher than
a threshold, the transaction will be executed. Therefore, the
PRNU based authentication relies on “something you have”
(i.e. the smartphone) for authentication.
Our PRNU based authentication involves two communica-
tion channels: 1) Visible light communication (VLC) channel
from the veriﬁer’s interface to the smartphone’s built-in cam-
era. The veriﬁer uses the VLC channel and embeds information
into the image taken by the smartphone; 2) Wireless channel