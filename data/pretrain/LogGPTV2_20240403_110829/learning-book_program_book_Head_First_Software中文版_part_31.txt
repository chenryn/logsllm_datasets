≤
description=*Cleans up the build and dist directories,*>
Delete的任务科逐过携定的Din或
ec的任务
文件属性，到除目录，
是在ncii
继泽代
02510
每个0标能
而端译有依税于Jnit目标。
如果你要求
有一个描违，
出来
集一个美用标记。
创建7AR，你可以携明显而易见的信息
以及要排除的文件等。
226
第6%章
---
## Page 263
构建代码
没有愚蠢的问题
问：
我的项目不是用Java写的程
后的章节申谈到的最佳实务），
，你必
须考虑使用构建工具。
我的预定目标是什么？它应
序，我还需要一个构建工具吗？
该是编译代码、打包代码、生成文档
问：
你在哪里得到bin，dist和
全部三个目标吗？
src目录的名字？
答：
环境下工作，你可能已经在使用了。
这真的取决于你的项目。银
如果正在用Microsoft Visual Studio开发
答：
如某个新成员调出你的代码，他最
程序，你几乎已经用了已建立的系统，
对于Java项目，部些目录是非
可能会根据什么来进行？他会希望能
该系统放称之为MSBuild（用写字板
正式的标准。你还会看到一些其他名称，
调出你的代码，
，并预期一个步骤述
打开你的csproj文件）：与Ant的方式
例加，生成文格用docs目最，web服务
行它吗？如果是这样，你可能希望
相似，它用XML描远构建过程，Visual
生成的客户端及代码存根（stubs）用
预定目标去做每件事情。
但如果
件事情”只是递过密钥签名和通过
“每
Studio为你打开了该文件，但还有很
generated目录，你可能要用到的库关
多事情MSBuild可以为依做，
IDE并
联件（dependencies）用1.1b目录，
InstallShield生成安装文件等，你可能
没有让你知道，如果你没有用Visual
这强目录名称并没有硬性规定，你可
就不希望这是预定目标了。实际上，
Studio开发，而是用.NET开发，你可
以调整你的构建文件去处理任何你在
很多项目都让预设目标输出项目的帮
能要调出NAnt，它基本上是.NET环
项目上要使用的东西，然码，如果你
助信息，以使新的开发人员能看到一
境的Ant端口。Ruby用一个称之为
遵摘一般的命名约定、就会使新的团
签递项，并执选进合他们需要的东西，
以及后续的一些清理工作等。
Rake的工其进行测试，打也应用程序。
限成员客易进入项目，
问：
然而，还有些技术，如Perl成PHP，它
问：
build.xml文件在很多地方有
们构建的脚本不是报有作用，因为那
你为什么一直要谈Ant？你不
重复的名字，这样好吗？
些语言不能编译或打包代码（Package
知道Maven吗？
code）。不管怎样、你仍然可以使用
理解的不错！对于我们这里
一个构建工具去打包、
测试和部哥你的
正在使用的构建脚本，是可以的。但
应用程序，即使你不需要构建工具所提
件项目管理和综合工具。
基本
假如你正在编写一个更复杂的的建文
供的每项功能
上，Maven超超了我们一直在谈论
件，使用属性（property）来定义一次
的、较小规模的Ant任务，Maven还增
目票，并在构建文件的其余部分多次
问：
加了支持自动读取库关联件（library
参照它，一般来说，才是一个好想法。
我正在使用IDE，它能精助我
dependencies），和把你构建的程序
在Ant中，你应该使用property来标记
构建所有的事情，用IDE已经足够了吗？
库发布到公用位置以及测试自动化等。
这件事，就像在223页那样。
Maven是一个非需好的工具，但它也
将很多事情隐藏在费后，要充分利用
你图队中的其他成员呢？开发图队中的
Maven所提供的功能，你需要用特殊
我们不能用批文件或脚本语
每个人都要使用IDE吗？对于比较大型
的方式组积你的项目。
言（shell script）做到这些事情吗？
的项目可能也有问题，在其中。由一个
对于大多数中小规模的项目，Am能做
完全独立的组为其他团队负责构建和打
你需要做的每件事情，这不是鼓助你
答：
从提术上讲，是可以的。但
包项目，如款件测试人员或QA人员。
不去会试Maven，但理解Maven凝做
构建工具伴随着很多面向教件开发的
然后，有些任务是IDE没有做的.
庞大工作所蕴含的思想是非常重要的。
任务，对这些任务，你要不自己编写，
（如果你想不到任何这群的事情，我们
你可以从如下网址hrtp://maven.apache,
要不依言外部的工具去做处理。另外。
将在以后的章节中谈到几个很棒的任
org/我到史多有关Maven的信息。
构建工具也可以整合到连续的集成系
务），一般高言，如票你的项目不是一
城（Continuous integration systems），
曲独角戏（或你怒使用我们准备在以
我们将在下一章谈到这一方面的内客。
目前位置，
227
---
## Page 264
构建脚本的良好习惯
良好的构建脚本
构建脚本捕提到了开发人员可能不需要知道的细节，像如何编译和打包应用程
序，如BeatBox。这些信息不是装在一个人的脑袋里，而是被捕提到有版本控
制的、可重复的流程中。但标准的构建脚本到底该做些什么事情？
你可稳金增加一些任务到你自己的构建
脚本，但是所有的构建脚本应该做几伴
其用的事情.·
.生成文档
记住了在构建文件中的那些描述标记吗？
Boi1df1le:bu11d.
只需要输人ant
-projecthelp，就会
Main targeta:
arget
打印出有哪些目标可以使用，每个目标
clean
compile
Cleans up the build and dist directories
的描述，缺省的目标是什么（缺省的目
标是你经常希望去使用的）。
dist
init
Creates the nended directories.
你的物建工具可能具有生成它自身
Default target:dist
和有美你的项目的文格的方式，即
使保湿有使用Ant7an,
编译你的项目
最重要的是，你的构建脚本编译你的项目中的代码。并且，在大多数的脚本中，你希望能用单一
命令处理每件事情，从配置到编译，再到打包应用程序。
这里你可以看
Buildfile:build.xml
hfsd>ant
到目标的实际
美联：我们的
构建兴本星
[mkdix] Created dix: C:\Users\D
康Axt运行缺
老的ist目标
但是，为了做
ompile:
到这一点，构
建奔本要无编
请，而要无端
diet:
[jar] Building jar:C:\Users\Deve
谦，必须无位
fginit,
BUIID SUCCESSTUL
Total time:16 sec
hfed
228
第6%章
---
## Page 265
构建代码
这太础了。但我在构建文停中通到一个我
们运不曾谈到过的eleanD标
很好。很细心！clean目标是为了请理编译过程
中留下来的乱七八槽的东西，有这样一个目标
能让项目恢复到之前的样子是非常重要的，如
果你从存储目录中调出你的项目，那样的话。
你能够从一个新的开发人员的角度去做测试。下
你的工习可能能调用其他的事情，信想
法是相用的，即增理因构建项0等来的
.…..清理所产生的混乱
在BeatBox构建脚本中，我们将讨论的最后目标是要删除在构建过程中创建的目录：为编译类创
建的bin目录和为最终JAR文件创建的dist目录。
由于dinr是缺者的
hfad> ant clesn
目标，你必展明
Buildfile:bui1d.xm1
确告诉Ant去递行
cleex D fs,
[delete]Deleti
[delete]Deleting
UILD SO
Axt抗行删称任务巴清理bix和iirt
录，并旦到融所有的内客。
目前位置
229
---
## Page 266
超越自我
良好的构建脚本超越基本功能
即使有一些标准工作是你的脚本应该完成的，你会发现良好的构建工具中有很
多地方让你的脚本超越一般的基本功能：
D
项目中需要的参考库。
在javac任务中，通过使用classpath元素，在Ant中你能增加库
到你构建的路径中：
每个pethelememt排物暑被增加到elaeseth
中的单一3AR文件，如果你常要，你也可
以指向一个目录。
如果你的项目依赖于你不希望将其包含在1ibs目录中的程序库，你
也可以使用额外的Ant任务，通过FTP，HTTP,SCP等下载程序库（调
出Ant任务文档，可以获得更详细的信息）。
2
运行应用租序。
有时候，不只是编译应用程序需要一定的背景知识：运行应用程序
也非常需要技巧。假设你的应用程序要求设置复杂的程序库路径或
命令行方式下的长字符串选项，你可以使用exec任务，在构建脚本
中，打包所有的程序库路径或命令行的字符串：
在系统上费描执行等件事情明需地
保赖于系统平台，不要试图在Lir
上 ffiexplosen.exe,
或java任务：
 F
如军你据这些打包在目标
中，这样，你就不党最输入
“jenCpeha就能名动
BestBex 3 .
230
第6%章
---
## Page 267
构建代码
3
生成说明文格。
你已经看到Ant如何为构建文件显示其说明文档，但Ant也可以从你
的源代码中生成JavaDoc:
注鲁Axt号b为你生成HTML
<javadoc packagenames="headfirst,sd, **
文件，但不我帮助你拥写说
明文格。
sourcepath=*src"
destdir="docs*
</,uottequeumoog xogaeeg,=etatkopua
如集你需需的活，老含在aaDoc任务中物
其它元意可以生成多页的页悉和页牌。
4
调出代码，运行测试，复制构建到归格目录（arehival
direetories），如密文件，当构建完成时ema给你，放行SQL.……
有很多很多的功能是你可以使用的，取决干你需要构建文件去
做什么。现在你知道一些基本的任务，所有其他的任务看起来
是非常相同的。想知道Ant能提供哪些任务，可以访问以下网址：
http: //ant,apache,org/manual/ index.htm1.
自动化使精力集中于代码，不是重复性的任务
通过良好的构建脚本，你可以使相当精巧和复杂的构建过程自动化。在单个
项目中，能看到多个构建文件并非不常见，每一个分别服务于不同的程序库
或组件库（Component），在这类情况下，你可能会想到主构建文件，有时称
之为引导程序（bootstrap）脚本，主构建文件把所有事情绑定在一起。
目前位置
231
---
## Page 268
构建脚本也是程序代码
构建脚本也是代码
你已经把你的很多工作放到了你的构建脚本中，事实上，正如你的源文件和部署
描述（deployment descriptors）一样，它也是代码。当你把构建脚本看作代码时，
你会发现可以用它做很多聪明的事情，像处理Windows和Unix之间的平台差异
样，利用时间戳（Timestamps）去记录构建版本，或者判断有什么是需要重新编
=
译的—所有一切皆对试图进行构建工作的人的隐藏。但是，像所有的其他代码