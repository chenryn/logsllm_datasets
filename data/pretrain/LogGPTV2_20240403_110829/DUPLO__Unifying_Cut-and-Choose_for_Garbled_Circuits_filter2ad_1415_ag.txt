if ğ‘¥ = 1
We say that a label expression ğ‘¤ is strongly independent if
ğŠğğ²ğ¬(ğ‘¤) is a set of independent keys and, if ğ‘¤ = (ğ‘, (ğ‘˜0, ğ‘˜1))
is a single label then ğ‘˜0 â‰  ğ‘˜1, and if ğ‘¤ = (ğ‘¢, ğ‘£) where ğ‘¢
and ğ‘£ are label expressions, then ğ‘¢ and ğ‘£ are both strongly
independent and ğŠğğ²ğ¬(ğ‘¢) âˆ© ğŠğğ²ğ¬(ğ‘£) = âˆ….
Let us start with some technical lemmas that are helpful to
derive our main result. The ï¬rst lemma can be easily veriï¬ed
by induction on the deï¬nition of ğ™¶ğš‹.
Lemma 4. For any circuit ğ¶ and label expression ğ‘¢, if Ìƒğ¶, ğ‘£ =
ğ™¶ğš‹(ğ¶, ğ‘¢) and ğ‘˜ âˆˆ ğŠğğ²ğ¬( Ìƒğ¶)âˆ©ğğšğ«ğ­ğ¬( Ìƒğ¶), then ğ‘˜ âˆˆ ğŠ is an atomic
key symbol.
Our next lemma shows that ğ™¶ğš‹ produces strongly inde-
pendent output labels from strongly independent input labels.
Furthermore, any key in the output label expression is yielded
from either a new atomic key introduced in the garbled circuit
or a key in the input labels, and it does not yield any other key
in the garbled circuit. The formal proof is done using structural
induction on circuits, and it is omitted due to space constraint.
Lemma 5. For any circuit ğ¶ and any strongly independent
label expression ğ‘¢ such that Ìƒğ¶, ğ‘£ = ğ™¶ğš‹(ğ¶, ğ‘¢), ğ‘£ is strongly
independent, and the following hold for all ğ‘˜ âˆˆ ğŠğğ²ğ¬(ğ‘£):
1) ğ–¦+(ğ‘˜) âˆ© ğŠğğ²ğ¬(( Ìƒğ¶, ğ‘¢)) = âˆ…;
2) âˆƒğ‘˜â€² âˆˆ ğŠğğ²ğ¬(( Ìƒğ¶, ğ‘¢)) âˆ© ğğšğ«ğ­ğ¬(( Ìƒğ¶, ğ‘¢)).ğ‘˜â€² âª¯ ğ‘˜.
A quick observation on ğ™¶ğš‹ is that, for any circuit ğ¶, if ğ‘˜ âˆˆ
ğğšğ­(ğ•‚) appears in
Ìƒğ¶, then either ğ‘˜ is in a plaintext message
and so ğ‘˜ âˆˆ ğğšğ«ğ­ğ¬( Ìƒğ¶), or ğ‘˜ is used as an encryption key. The
former case has been considered in Lemma 4. The following
lemma characterizes the latter case, and it can be proved using
structural induction on circuits.
Lemma 6. For any circuit ğ¶ and any label expression ğ‘¢ such
ğğšğ«ğ­ğ¬( Ìƒğ¶) for some expression ğ‘’ and some key ğ‘˜ âˆˆ ğğšğ­(ğ•‚),
then the following hold:
that ğ‘¢ is strongly independent and Ìƒğ¶, ğ‘£ = ğ™¶ğš‹(ğ¶, ğ‘¢), if â¦ƒğ‘’â¦„ğ‘˜ âˆˆ
1) ğ–¦+(ğ‘˜) âˆ© ğŠğğ²ğ¬( Ìƒğ¶) = âˆ…;
2) ğ–¦âˆ—(ğ‘˜) âˆ© ğŠğğ²ğ¬(ğ‘£) = âˆ…;
3) âˆƒğ‘˜â€² âˆˆ ğŠğğ²ğ¬(( Ìƒğ¶, ğ‘¢)) âˆ© ğğšğ«ğ­ğ¬(( Ìƒğ¶, ğ‘¢)).ğ‘˜â€² âª¯ ğ‘˜.
For the rest of paper, let us ï¬x a circuit ğ¶ âˆˆ Circuit(ğ‘ , ğ‘¡)
and a boolean vector ğ‘¥ âˆˆ {0, 1}ğ‘›
, where ğ‘  is a shape of ğ‘› wires
and ğ‘¡ is a shape of ğ‘š wires. Let ğ‘’ = ( Ìƒğ¶, Ìƒğ‘¥) = ğ™¶ğšŠğš›ğš‹ğš•ğš(ğ¶, ğ‘¥) be
156
the symbolic expression of the garbled circuit and the garbled
input of ğ¶ on input ğ‘¥. Since ğ‘’ is monotone, the greatest ï¬xed
point of ğ‘’ exists and it can be computed in polynomially
many steps. Let ğ‘† = Fix(ğ‘’) and ğ‘’â€² = ğ©(ğ‘’, ğ‘†). Then
ğ‘ğ¨ğ¨ğ­ğ¬(ğ‘†) âŠ† ğŠğğ²ğ¬(ğ‘’) and ğ‘† = ğ‘’(ğ‘†) = ğ«(ğ©(ğ‘’, ğ‘†)) = ğ«(ğ‘’â€²).
For any label (ğ‘, (ğ‘˜0, ğ‘˜1)), we say that it satisï¬es the label
invariant if
(1)
ğ‘ âˆˆ ğ, âˆƒğ‘§ âˆˆ {0, 1} such that ğ‘˜ğ‘§ âˆˆ ğ‘†, ğ‘˜1âˆ’ğ‘§ âˆ‰ ğ‘†,
and we call ğ‘§ the actual value of the label (ğ‘, (ğ‘˜0, ğ‘˜1)).
Lemma 7. For any sub-circuit ğ¶â€² of ğ¶, and for any label
expression ğ‘¢, if Ìƒğ¶â€², ğ‘£ = ğ™¶ğš‹(ğ¶â€², ğ‘¢) and all labels (ğ‘, (ğ‘˜0, ğ‘˜1)) â‹
ğ‘¢ satisfy the label invariant, then all labels (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) â‹ ğ‘£
satisfy the label invariant.
Proof. We use induction on the structure of circuit ğ¶â€². For
the base case, ğ¶â€² is an atomic circuit:
Ì„ğ‘ = ğ‘,
ğ‘£ is also a sub-expression of ğ‘¢. So the lemma holds.
âˆ™ ğ¶â€² = ğ’ğ°ğšğ©, ğ€ğ¬ğ¬ğ¨ğœ, or ğ”ğ§ğšğ¬ğ¬ğ¨ğœ: Any label (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) â‹
âˆ™ ğ¶â€² = ğƒğ®ğ©: Suppose ğ‘¢ = (ğ‘, (ğ‘˜0, ğ‘˜1)) satisï¬es the label
invariant with an actual value ğ‘§. If (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) â‹ ğ‘£,
Ì„ğ‘˜1 = ğ–¦â„(ğ‘˜1) for some
Ì„ğ‘˜0 = ğ–¦â„(ğ‘˜0), and
then
Ì„ğ‘ âˆˆ ğ. Let Ì„ğ‘§ = ğ‘§. Then
Ì„ğ‘˜ Ì„ğ‘§ = ğ–¦â„(ğ‘˜ğ‘§) âˆˆ ğ‘†.
â„ âˆˆ {0, 1}. So
Ì„ğ‘˜1âˆ’ Ì„ğ‘§ âˆˆ ğ‘†. Then
Assume towards a contradiction that
ğ–¦â„(ğ‘˜1âˆ’ğ‘§) = Ì„ğ‘˜1âˆ’ Ì„ğ‘§ âˆˆ ğ–¦âˆ—(ğ‘˜â€²) for some ğ‘˜â€² âˆˆ ğŠğğ²ğ¬(ğ‘’â€²) where
ğ‘˜â€² âˆˆ ğğšğ«ğ­ğ¬(ğ‘’â€²) or âˆƒğ‘˜â€²â€² âˆˆ ğŠğğ²ğ¬(ğ‘’â€²) such that ğ‘˜â€² â‰º ğ‘˜â€²â€².
Notice that ğ‘’â€² = ğ©(( Ìƒğ¶, Ìƒğ‘¥), ğ‘†) = (ğ©( Ìƒğ¶, ğ‘†), ğ©( Ìƒğ‘¥, ğ‘†)), and Ìƒğ‘¥
contains only atomic keys. So ğ‘˜â€²â€² âˆˆ ğŠğğ²ğ¬( Ìƒğ¶â€²) âŠ† ğŠğğ²ğ¬( Ìƒğ¶).
We have two cases:
â€“ ğ–¦â„(ğ‘˜1âˆ’ğ‘§) â‰  ğ‘˜â€²: ğ‘˜1âˆ’ğ‘§ âˆˆ ğ–¦âˆ—(ğ‘˜â€²) âŠ† ğ‘†, a contradiction.
â€“ ğ–¦â„(ğ‘˜1âˆ’ğ‘§) = ğ‘˜â€²: Now ğ‘˜â€² âˆ‰ ğğšğ«ğ­ğ¬(ğ‘’â€²), and thus
â¦ƒğ‘”â€²â¦„ğ‘˜â€² âˆˆ ğğšğ«ğ­ğ¬(ğ‘’â€²) for some pattern ğ‘”â€². Soâ¦ƒğ‘”â€²â¦„ğ‘˜â€² âˆˆ
ğğšğ«ğ­ğ¬(ğ©( Ìƒğ¶, ğ‘†)) and â¦ƒğ‘”â¦„ğ‘˜â€² âˆˆ ğğšğ«ğ­ğ¬( Ìƒğ¶) for some
expression ğ‘” such that ğ‘”â€² = ğ©(ğ‘”, ğ‘†). By Lemma 6,
ğ–¦+(ğ‘˜â€²) âˆ© ğŠğğ²ğ¬( Ìƒğ¶) = âˆ… and hence ğ‘˜â€²â€² âˆ‰ ğŠğğ²ğ¬( Ìƒğ¶), a
contradiction.
â„)). Notice
â„ are
, ğ–ª1
â„
Therefore (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) satisï¬es the label invariant.
âˆ™ ğ¶â€² = ğğ€ğ§ğ: The only label in ğ‘£ is (ğ–¡â„, (ğ–ª0
, ğ–ª1
that the expressions in ğğšğ«ğ­ğ¬(ğ‘’) that contain ğ–ª0
the following and their sub-expressions:
â„
ğ‘–
ğ‘—
â¦ƒâ¦ƒ(Â¬ğ–¡â„, ğ–ª1
â¦„ğ‘˜0
â„)â¦„ğ‘˜0
â¦„ğ‘˜0
â„)â¦„ğ‘˜1
â¦ƒâ¦ƒ(Â¬ğ–¡â„, ğ–ª1
)â¦„
â¦ƒâ¦ƒ(ğ–¡âŠ•(ğ‘¥ğ‘–â†‘ğ‘¥ğ‘—)
ğ‘– )), (ğ‘ğ‘—, (ğ‘˜0
, ğ–ªğ‘¥ğ‘–â†‘ğ‘¥ğ‘—
ğ‘—
ğ‘—
ğ‘–
â„
â„
ğ‘—
â„)â¦„ğ‘˜0
,â¦ƒâ¦ƒ(Â¬ğ–¡â„, ğ–ª1
â¦„ğ‘˜1
â¦„ğ‘˜1
,â¦ƒâ¦ƒ(ğ–¡â„, ğ–ª0
â„)â¦„ğ‘˜1
â¦„ğ‘˜ğ‘¥ğ‘–
ğ‘–
,
ğ‘—
ğ‘–
where ((ğ‘ğ‘–, (ğ‘˜0
four expressions can be generated as
, ğ‘˜1
, ğ‘˜1
ğ‘–
,
ğ‘˜
ğ‘¥ğ‘—
ğ‘—
ğ‘–
for ğ‘¥ğ‘–, ğ‘¥ğ‘— âˆˆ {0, 1}.
ğ‘—))) = ğ‘¢. Observe that these
Let Ì„ğ‘§ = ğ‘§ğ‘– â†‘ ğ‘§ğ‘— . By assumption, we have ğ‘˜ğ‘§ğ‘–
ğ‘˜1âˆ’ğ‘§ğ‘–
ğ‘–
and Condition 1 holds for (ğ–¡â„, (ğ–ª0
âˆ‰ ğ‘†, so ğ‘˜ Ì„ğ‘§ = ğ–ª Ì„ğ‘§
1âˆ’ğ‘§ğ‘—
, ğ‘˜
ğ‘—
, ğ–ª1
â„ âˆˆ ğ‘† and ğ‘˜1âˆ’ Ì„ğ‘§ = ğ–ª1âˆ’ Ì„ğ‘§
ğ‘§ğ‘—
ğ‘— âˆˆ ğ‘† and
â„ âˆ‰ ğ‘†,
, ğ‘˜
ğ‘–
â„)).
â„
Next, consider composite circuits. Assume the lemma holds
for all sub-circuits of ğ¶â€². Then we have these cases:
1) where
, ğ‘¤). Since ğ¶â€²
âˆ™ ğ¶â€² = ğ¶â€²
0
Ìƒğ¶ = ( Ìƒğ¶â€²
0
, ğ‘¢) and
1: Suppose
Ìƒğ¶â€²
1
, ğ‘£ = ğ™¶ğš‹(ğ¶â€²
1
ğ™¶ğš‹(ğ¶â€²
0
â‹™ ğ¶â€²
, Ìƒğ¶â€²
Ìƒğ¶â€²
, ğ‘¤ =
0
0 and ğ¶â€²
1
are both sub-circuits of ğ¶â€², by assumption we see that
Condition 1 holds for all labels in ğ‘¢ and consequently, for
all labels in ğ‘¤, and so it holds for all labels in ğ‘£.
âˆ™ ğ¶â€² = ğ…ğ¢ğ«ğ¬ğ­(ğ¶â€²â€²): Suppose ğ‘¢ = (ğ‘¢â€²â€², ğ‘¤) and ğ‘£ = (ğ‘£â€²â€², ğ‘¤)
Ìƒğ¶, ğ‘£â€²â€² = ğ™¶ğš‹(ğ¶â€²â€², ğ‘¢â€²â€²). For any label (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) â‹
such that
ğ‘£, it is either a sub-expression of ğ‘£â€²â€² or it is a sub-
expression of ğ‘¤. For the former case, since ğ¶â€²â€²
is a
sub-circuit of ğ¶â€², Condition 1 holds for (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) by
induction hypothesis. For the latter case, since ğ‘¤ â‹ ğ‘¢,
Condition 1 holds for this label by assumption.
Therefore the lemma holds for any circuit ğ¶.
Let ğ‘“ = ( Ì‚ğ¶, Ì‚ğ‘¥) = ğš‚ğš’ğš–ğšğš•ğšŠğšğš(ğ¶, ğ¶(ğ‘¥)) be the symbolic
expression of simulated garbled circuit of ğ¶ on output ğ¶(ğ‘¥).
Let ğ‘‡ = Fix(ğ‘“ ), which satisï¬es ğ‘“ (ğ‘‡ ) = ğ«(ğ©(ğ‘“ , ğ‘‡ )) = ğ‘‡ .
The following lemma shows that, for each key pair ğ‘˜0, ğ‘˜1 in
ğ‘“ , exactly one of ğ‘˜0 and ğ‘˜1 is in ğ‘‡ .
Lemma 8. For any sub-circuit ğ¶â€² of ğ¶ and any label
expression ğ‘¢ such that Ì‚ğ¶â€², ğ‘£ = ğš‚ğš’ğš–(ğ¶â€², ğ‘¢),
labels
(ğ‘, (ğ‘˜0, ğ‘˜1)) â‹ ğ‘¢ satisfy the label invariant with actual value 0,
then all labels (Ì„ğ‘, (Ì„ğ‘˜0, Ì„ğ‘˜1)) â‹ ğ‘£ satisfy the label invariant with
actual value 0.