# 360安全大脑赋能安全运营与应急响应：海量数据下的实战方法论
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
> 导语：“常态实战化的安全运营，能够提升企业整体威胁发现和应急响应的能力，在发生安全事件时，改进检测和响应时间，以最短时间保障业务系统的正常运行。”
“常态实战化的安全运营，能够提升企业整体威胁发现和应急响应的能力，在发生安全事件时，改进检测和响应时间，以最短时间保障业务系统的正常运行。”8月19日——21日，第八届互联网安全会（ISC
2020）的应急响应与安全运营论坛中，360集团信息安全中心负责人张睿带来《基于360安全大脑的威胁运营落地与实践》的分享，从360威胁运营的思路与方法、基于360安全大脑的威胁运营建设、基于360安全大脑的威胁运营工程实践三个方面论述了360的安全运营。
## 一、360威胁运营的思路与方法
### 1\. 威胁运营的现状：
360内部安全团队每天面对着非常复杂的运营战场，为满足互联网业务敏捷和弹性需求，将基础网络发展成为庞大异构的互联网业务混合云架构，全球设有200多个数据中心，十几万的云服务器，包括自建骨干网络、边缘网络，私有云和公有云，内部有容器等各类云原生服务等。通过移动客户端“360家”实现BYOD远程办公，集成了云盘、OA、IM等办公应用，后端联动API网关实现基于员工身份对业务系统访问的鉴权。
在高度复杂的基础架构环境下，每天威胁运营团队会面对各种安全问题。总之，在出现问题复盘时，运营的同学总会说自己本可以做到“更”好。
### 2\. 指导安全运营的核心思想：
安全运营团队真实想做的和现实做到的往往有非常大的差距，希望建造一个坚强稳固的堡垒，实际上经常会发现墙上破了一个又一个窟窿，运营人员总是在补窟窿的路上。
在逐步展开安全建设后，360安全运营团队意识到攻防本质上是成本的对抗，也是人与人的对抗，攻防之间需要形成一种相对动态的平衡，安全防御就要在受保护的目标资产价值、安全建设投入和性价比之间的做好平衡关系。
360内部指导安全运营的三条核心思想：（1）找准ROI持续投入进行安全建设；（2）自主可控，攻防实践加工具开发；（3）工程能力是落地安全防御体系能力的核心。
### 3\. 转变思路-走向真正的数据驱动安全：
通过落地基础的日常安全运营工作，可以形成纵深防御体系，提升攻击者成本，减小响应的时间窗口；但仅仅做好这些基础功课肯定还是不够的，会遗漏很多潜在的威胁。入侵是不可避免的，只要检测和响应足够快，业务不会被破坏。所以要转变思路，朝着真正的数据驱动安全的方向。
数据驱动安全的理念代表着是一种检测思路的转变，由传统的以漏洞为中心，聚焦检测逐渐转向以威胁为中心，聚焦在数据收集上。传统的检测是依赖精准的特征，不太区分具体的威胁类型和场景去被动监测这些告警，而基于数据的方法主要会依赖各种来源的数据，逐步覆盖各类威胁场景的攻击手法，依赖内外部的威胁情报，主动做威胁狩猎。
总结来看，就是首先要去积极的检测和响应，结合特征检测和行为检测，运营人员需要主动威胁狩猎和响应，在检测上不再追求单点的完备性和告警的精准性，实现基于全盘数据的统筹关联，有点及面的实现对威胁的探索和发现。
1） 有目标的数据收集
为了实现基于数据驱动的威胁分析，首先需要做到有目标的数据采集与监测。首先数据的存储成本和传输成本是非常高的，数据也永远都没有收集完整的那一天，所以切忌盲目地去收集相关数据。
从经验上来看，首先数据收集要尽可能去靠近一些收敛的集中点，这样可以降低数据收集或者标准化的成本。除此之外，数据本身的收集是一个长期的持续动态的过程。最重要一点就是数据一定要打好基本功，如果没有好的数据质量和数据维度，实际上很多分析工作是没有办法开展的。
2) 基于大数据科学分析方法的威胁判定
电影里的“照片墙”可以非常形象的表达在威胁运营的中面对的问题，首先是威胁运营的分析人员，在海量数据里往往看到的并不是威胁的全貌，能看到是单一的攻击线索，非常碎片化的信息，如何把这些海量的数据中碎片化的信息，通过线索关联起来，去定位攻击者或者受害者，然后找到攻击的手法和工具，这就是整体做威胁运营分析的最重要的思路。具体落地到威胁运营的数据上来看，一般来讲从海量的原始数据到最终的安全事件，是一个逐渐收敛的过程，总结来说就是做到向上智能归并，向下多级的钻取。
3) 建立威胁模型关联聚合分析
在实践中，发挥威胁运营价值很重要的数据包括网络侧NDR和终端侧EDR的数据，网络侧的数据会集中在攻击的初始阶段或者命令控制阶段，有比较高的实时性，能够比较好的实现溯源追踪，但是很难实现实锤，需要终端去做一些实证排查。另外一块是终端侧的数据，会集中在攻击的中后阶段，例如样本或者命令执行的前后阶段，往往是比较碎片化的，需要进行大量的回溯才能还原整个攻击事件。基于ATT&CK矩阵工具的对NDR和EDR覆盖矩阵点的分析结果可以看出，两侧数据的覆盖面是互补的，都无法完全覆盖所有攻击战术和手法，结合起来才能够看的更全面。