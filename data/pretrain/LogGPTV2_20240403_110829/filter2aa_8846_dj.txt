这四个模式很绕，其实一点意义都没有，还要考。列个表吧：
模式/Mode
访问许可
permission
访问需求
need
能否访问
不同级别数据 概括
专用模式 Dedicated 全局权限 不区分 数据不分级 一锅端
系统高级模式 System High 全局权限 区分 不分级，按需访问数据 鸳鸯火锅按需吃
分隔模式 Compartmented 不同权限 区分 数据按权限分级 自助火锅分开吃
多级模式 Multilevel 不同权限 区分 数据分级 不同档次火锅店
除了以上的，还有两种：
（5）受控模式 Controlled Mode
在系统的硬件软件上，有更多有限数量的信任被置于多个等级。其结果是，对分类等级和
级别有更多限制。
（6）受限的访问模式 Limited access mode
最小的用户级别并不清晰，最大的数据敏感度并没有根据敏感而分类。
二、要考的安全模型
先基础概念：
1.令牌、功能和标签 Tokens, Capabilities, and Labels
Token 安全令牌是一个与资源关联的独立客体，描述其安全属性。（单个，是客体的）
Capabilities 功能列表用于存储与多个客体有关的安全信息。（多个，是主体的）
label 安全标签是客体附加的永久部分。（不能修改，是客体的）
2.可信计算基 Trusted Computing Base
美国国防部的桔皮书将可信计算基(TCB)描述为硬件、软件和控制方法的组合，这个组合
形成了一个实施安全策略的可信任基准。通常 TCB 组件负责控制对该系统的各种访问，确保系
统的行为在所有的情况下工作正常并遵守安全策略。从某种意义上说，操作系统的内核就是
TCB。如果启用 TCB，那么系统就拥有一条可信路径、一个可信外壳以及系统完整性检查功能。
①可信路径(trusted path)是用户或程序与内核之间的通信通道。TCB 提供保护资源、以
确保这个通道不会遭受任何方式的危害。
②可信外壳(trusted shel1)意味着任何在这个外壳中工作的人都无法“逃出去”，其他
进程也无法“闯进来”。
③安全边界 Security Perimeter（与上一章中的界限 Bounds 概念不同）
TCB 与系统的其他部分的逻辑边界，TCB 通过严格可信路径（trusted paths）与外部通信。
可信路径是建立在有着严格标准基础上的通道，它在不受 TCB 安全脆弱性影响的情况下准许进
行必要的通信。
—56—
④引用监控器和内核 Reference Monitors and Kernels
TCB 进行访问控制最重要的组件就是引用监控器(Reference Monitor)，也称参考监视器，
它是一个抽象机，是主体对客体进行所有访问的中介，不但要确保主体拥有必要的访问权限，
而且还要保护客体不被未授权访问和破坏性更改。为了让系统能够获得更高的信任级别，就必
须要求主体(程序、用户或进程)在访问客体(文件、程序或资源)之前取得完全授权。它处于每
个主体和客体之间，并且在准许访问之前验证主体的访问凭证（令牌、列表、标签）。
⑤安全内核（security kernel）是使用引用监控器的 TCB 核心组件，是主体访问资源的
中间人，通过可信路径与主体进行通信。安全内核由位于 TCB 内的硬件、软件和固件组件构成，
并且实现和实施引用监控器概念。
3.安全模型
有的模型是概念模型，仅理论描述；有的模型是实际开发运用的，由开发者随便命名；有
的模型是多功能的，是几种类型的混合。
①关于访问控制的：
*访问矩阵 Access Matrix models
*访问控制表 Access control matrix
*Bell-LaPadula 模型
*Take-Grant 模型
*状态机模型 State machine model，也是很多安全模型的基础
②关于完整性的：
*Biba 模型
*Clark-Wilson 模型
完整性模型有下列 3 个主要的目标：
• 防止未授权用户进行更改。
• 防止授权用户进行不正确的更改(职责分离)。
• 维护内部和外部的一致性(格式良好的事务处理)。
Clark-Wilson 实现了以上 3 个目标，Biba 只实现了第 1 个目标。
③关于信息流的：
*信息流模型 Information flow model，也是很多安全模型的基础
*非干扰/非相干模型 Noninterference model/Goguen-Meseguer 模型
*Brewer and Nash 模型（中国墙 Chinese Wall 模型）
*组合论 Composition Theories
④基于状态机的：
*Bell-LaPadula 模型
*Biba 模型
*Brewer and Nash 模型（中国墙 Chinese Wall 模型）
系统的状态是系统在某一时刻的即时快照。很多活动都会改变这个状态，这称为状态迁移
(state transition)。实现状态机模型的开发人员必须标识所有的初始状态(默认变量值)，并
且还要概括说明这些变量如何发生变化(可以接受的输入)，以使最终的各种状态(结果值)仍然
—57—
能够确保系统的安全。
⑤其它：
*Sutherland 模型
*Graham-Denning model 模型
*可信计算基 Trusted computing base，是建立大部分安全模型的基础
下面逐个介绍各种模型：
1.访问控制矩阵 Access Control Matrix
访问控制矩阵是一个由主体和客体组成的表，一一对应的表示每个主体对每个客体的操作
权限。表的每一竖列都是一个访问控制列表（ACL），代表 1 个主体可以怎么操作的客体；表
的每一横行都是功能列表/访问能力列表（capabilities list），代表 1 个客体可以被怎么操
作。只有行或者列是不行的，因为要删除一个客体或主体的时候，必须用到行和列才能快速找
出相关联的主体和客体，并作出相应的修改。在基于角色的访问控制系统中，这个矩阵的主体
就是各种角色。
但它没有考虑主体（用户）间的关系，客体（数据）的共享，所以有了“取—予模型”。
2.取—予模型/Take-Grant 模型
Take -Grant 模型（获取-授予）采用有向图/定向关系图（导航图）来表示访问权限如何
在主体中传递的。它有两个规则：具有授权资格的主体可以向另一个主体或客体授予相应的权
限（授予 Grant）；具有获得权利的主体可以向另一个主体请求获得受益人权限（获取 Take）。
此外，该模型还可以利用 1 个建立规则（create）和 1 个移除规则（remove）来生成权限和删
除权限。自己可读可写，不管其它的人，是安定型（inert）；权限可以申请（取），也能分
配（予），是变换型（transport）。①Grant；②Take；③create；④remove。
这种模型在各种系统的账户管理功能里经常用到，就是管理员可以分配下级用户，下级用
户还可以分配子用户。
3.Bell-LaPadula 模型/BLP
也被称为多级安全系统（multilevel security system），两个专家搞的，美国国防部（DOD）
用的的，为了解决机密性问题，防止信息从高流低。美军的信息分级是三级：非机密（公开）、
机密、秘密以及绝密，前面讲过的。这个模型既是信息流模型，也是状态机模型，也是一种“主
体-客体”模型，每个客体有个安全等级标签，每个主体要验证访问这个客体的权限后，才能
实施相应的访问。它有三个著名的规则：
初级规则①简单安全规则（Simple Security Property）。不能上读（no read up）。
中级规则②*属性（星属性）规则（* Security Property）。不能下写（no write down）。
也被称为约束属性(confinement property) 。
高级规则③强星属性规则（Discretionary Security Property）。主、客体必须同等级
才能读写，通过访问控制矩阵/列表实现。也被称为自主安全属性规则（上级如果要给下级发
文件，因为不能“下写”，所以要自主）。
Bell-LaPadula 只解决机密性问题，不支持完整性和可用性。它还不针对隐蔽通信，不适
应用使用文件共享和服务器的现代系统。它应该和 Biba 模型对比来看。
4.Biba 模型
—58—
两个人为了商业应用，参考 Bell-LaPadula 搞的，主要目的是解决完整性问题，防止信息
从低流高。这个模型既是信息流模型，也是状态机模型，也是一种“主体-客体”模型，每个
客体有个安全等级标签。Biba 也有三大规则：
初级①简单完整性规则(simple integrity property)。不能下读（no readdown）。防止
高级别数据被“污染”。
中级②*完整性规则(star integrity property)。不能上写（no write up）。
高级③引援/调用规则(invocation property)。主体不能请求（调用）完整性级别更高的
主体的服务。
Biba 只解决完整性问题，也解决了调用的问题，不支持机密性和可用性。
它和 Bell-LaPadulap 这两个模型里的 property 翻译成属性、规则、原则、公理都行。“简
单”就是读，“*星”就是写。
5.状态机模型 State machine model
无论处于何种状态，系统总是安全的。这种模型基于有限状态机(FSM)理论：
状态是系统在特定时刻的即时快照，包括各种指标参数；
安全状态是系统的某个状态的所有指标参数都是安全的；
系统的任务操作和变化都用状态转换公式来表示：下一状态=F(输入，当前状态)；
所有的状态转换必须进行评估，如果系统的每一个状态都是安全的，系统被称为安全状态
机（secure state machine）。
6.格子型访问控制 Lattice-Based Access Control
这里插播 1 个访问控制模型，本章讲的安全模型，绝大部分其实就是访问控制模型，这个
格子模型也会被考到。格子型访问控制属于非自主访问控制（UDAC），不也就是说可以是强制
（MAC）、也可以是角色（RBAC），反正就不是自主（DAC）。格子型也是信息流模型，主要解
决机密性问题。
Bell-LaPadula 就是基于强制（MAC）和格子。
这个格子就是指定 1 个主体所拥有权限的二维坐标
（经纬度模型）；它不是一个坐标点，而是一个格
子型的坐标面，这样主体能访问什么级别的数据很
清楚了，高的低的都不能访问。（高不成低不就）
7. Clark-Wilson 模型
另一种用于商业的优秀模型，实现数据的完整性。其实就是 B/S 架构里的三层模型，有个
中间件来实施访问控制。最重要的就是起“中间件”作用的 TP。先搞清几个术语和过程：
①用户 Users：活动个体 Active agents，也就是主体（数据项是客体）；
②转换过程(TP)Transformation Procedure：读、写、改操作，允许更改 CDI 的唯一过程；
③约束数据项(CDI) constrained data item：由 TP 控制，完整性被保护的任何数据项；
④非约束数据项(UDI) unconstrained data item：不受 TP 控制，用户直接操作的，完整
性不被保护的任何数据项；
⑤完整性验证过程(IVP) verification and validation procedures：检查 CDI，确认其
完整性的过程。
主体等级分类
客
体
密
级
分
类
权限格子
—59—
⑥受限接口模型（restricted interface model）：基于对主体、客体的分类，限制主体
仅有用特定的访问授权。
Clark-Wilson 完整性模型的关键原理就是：通过 TP 限制对 CDI 的访问，即用户不能直接
操作数据，必须通过身份验证后，根据授权通过 TP 来操作数据。该模型也要使用安全标签来
授予对客体的访问权限，但只能通过 TP 过程和受限接口模型来完成。这种使用 TP 来操作 CDI
的机制也被称为格式良好的处理（well-formed transaction），它也实现了职责分离。
于是，这个模型中要实现一个成功的数据访问或修改，需要满足 3 个条件，所谓的访问三
元组（access triple）：
①主体（Users）、②程序/过程（TP）、③客体（CDI）。
而且，优秀的完整性模型必须实现 3 个目标：
①防止未授权的更改；
②防止授权用户的不正当更改（职责分离）；
③保持内、外部数据的一致性（格式良好的事务处理）。