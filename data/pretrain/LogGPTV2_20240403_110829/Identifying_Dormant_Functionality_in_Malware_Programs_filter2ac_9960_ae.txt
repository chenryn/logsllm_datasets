### Analysis and Identification of Packed Malware Samples

During the Anubis analysis, SigBuster identified that the samples were packed. Below are the details of the datasets used:

- **Pushdo**: This dataset consists of 77 Pushdo binaries. To identify these, we relied on antivirus signatures to select 25 samples. Additionally, we used a known characteristic behavior observed during the Anubis analysis: Pushdo samples request updates by sending an HTTP query for a URL that starts with the string `/40E8`, which helped us identify another 52 samples.
  
- **Allaple**: This dataset consists of 64 Allaple samples, identified using antivirus signatures.

### Matching Results of Genotype Models

Table IV shows the results of matching the six genotype models extracted from the rbot sample against the two datasets of IRC bots. To compare the coverage provided by our tool with the results reported by dynamic analysis approaches, we present the detection results for each genotype based on a single phenotype.

#### Table II: Number of Samples (Out of 208) Matching Each Behavioral Model in Static and Dynamic Mode Using Different Compilation Options

| Compiler Options | No Parameters | Minimize Size | Optimize for Speed | Full Optimization | Only Inline | Any Suitable |
|------------------|---------------|---------------|--------------------|-------------------|-------------|--------------|
| **httpd**        | S: 144, D: 144 | S: 154, D: 154 | S: 144, D: 144 | S: 144, D: 144 | S: 144, D: 144 | S: 144, D: 144 |
| **keylog**       | S: 133, D: 133 | S: 133, D: 133 | S: 133, D: 133 | S: 133, D: 133 | S: 133, D: 133 | S: 133, D: 133 |
| **killproc**     | S: 149, D: 149 | S: 158, D: 158 | S: 149, D: 149 | S: 149, D: 149 | S: 149, D: 149 | S: 149, D: 149 |
| **simplespam**   | S: 135, D: 135 | S: 158, D: 158 | S: 1, D: 1 | S: 1, D: 1 | S: 135, D: 135 | S: 135, D: 135 |
| **udpﬂood**      | S: 136, D: 136 | S: 138, D: 138 | S: 128, D: 128 | S: 136, D: 136 | S: 136, D: 136 | S: 136, D: 136 |
| **sniff**        | S: 129, D: 129 | S: 134, D: 134 | S: 124, D: 124 | S: 129, D: 129 | S: 129, D: 129 | S: 129, D: 129 |

#### Table III: Number of Samples (Out of 10) Matching Each Behavioral Model in Static and Dynamic Mode Using Different Compilers

| Compiler | VS 2003 | VS 2005 | VS 2008 | Intel |
|----------|---------|---------|---------|-------|
| **httpd**        | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 10 |
| **keylog**       | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 0 |
| **killproc**     | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 0 |
| **simplespam**   | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 0 |
| **udpﬂood**      | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 0 |
| **sniff**        | S: 10, D: 10 | S: 10, D: 10 | S: 10, D: 10 | S: 0, D: 0 |

#### Table IV: Genotype Matching Results on IRC Datasets

| Genotype | Phenotype | Backdoor | Keystroke Logging | Process Killing | HTTP Server | Simple Spam | UDP Flood | Sniffing | Packet Flood |
|----------|-----------|----------|-------------------|-----------------|-------------|-------------|------------|----------|--------------|
| **irc bots** | B: 2014, D: 635, S: 636, B∩S: 279 | 0, 0, 0, 0 | 154, 293, 254, 0 | 0, 43, 400, 0 | 0, 400, 409, 0 | 0, 342, 374, 0 | 0, 270, 72, 0 |
| **packed bots** | B: 840, D: 425, S: 425, B∩S: 264 | 0, 120, 120, 0 | 4, 62, 62, 0 | 53, 204, 204, 0 | 0, 139, 122, 0 | 120, 204, 45, 0 | 0, 0, 0, 0 |

#### Table V: Genotype Matching Results on Pushdo and Allaple Datasets

| Genotype | Drop | Spam | Scan | RPC Bind |
|----------|------|------|------|----------|
| **pushdo** | B: 50, D: 54, S: 54, B∩S: 46 | 1, 42, 43, 1 | 23, 0, 0, 0 | 5, 0, 9, 1 |
| **allaple** | B: 0, D: 0, S: 0, B∩S: 0 | 0, 0, 0, 0 | 58, 61, 61, 58 | 62, 61, 61, 58 |

### Comparison of Anubis and REANIMATOR Results

The observed, dynamic behaviors in Anubis are shown in columns marked with B. Comparing the Anubis results with the static and dynamic REANIMATOR results, it is evident that even with a limited set of genotypes derived from a single malware binary, our techniques can significantly improve the number of malware capabilities discovered. For example, for the sniffing behavior, Anubis detected 163 samples, while REANIMATOR detected 474. The increase in coverage is even more significant for some other genotypes. For instance, only four binaries killed another process while executed in Anubis.

The column B∩ S shows the number of samples matched by both REANIMATOR and Anubis. The fact that, for most behaviors, no samples were matched by both tools may seem surprising at first. However, this does not indicate false negatives on REANIMATOR's part. The genotype models detected by REANIMATOR correspond to a single implementation of a certain behavior. Therefore, completely unrelated implementations would require additional models. For example, the samples that included the simplespam phenotype according to REANIMATOR did not send spam during Anubis analysis, indicating that the bot did not receive commands triggering this behavior. This suggests that the spam functionality modeled by the simplespam genotype is very primitive.