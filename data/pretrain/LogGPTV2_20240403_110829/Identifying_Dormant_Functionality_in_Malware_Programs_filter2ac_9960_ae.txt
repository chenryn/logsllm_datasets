during Anubis analysis. SigBuster was able to recognize that
these samples are packed.
• pushdo: This dataset consists of 77 pushdo binaries. To
identify Pushdo, we relied on anti-virus signatures to select
25 samples. We also used a known, characteristic behavior
of the Pushdo sample observed during analysis in Anubis to
identify another 52 samples. Speciﬁcally, Pushdo samples
request updates by sending an HTTP query for a URL that
starts with the string /40E8.
• allaple: This dataset consists of 64 Allaple samples,
identiﬁed using anti-virus signatures.
Table IV shows the results of matching the six genotype
models extracted from the rbot sample against
the two
datasets of IRC bots. To compare the coverage provided
by our tool with the results reported by dynamic analysis
approaches, we show, for each genotype,
the detection
results for the corresponding phenotype based on a single
72
NUMBER OF SAMPLES (OUT OF 208) MATCHING EACH BEHAVIORAL MODEL IN (S)TATIC AND (D)YNAMIC MODE, USING DIFFERENT COMPILATION
Table II
OPTIONS.
Compiler options
No parameters
Minimize Size
Optimize for Speed
Full Optimization
Only
inline
Any suitable
httpd
S
144
154
144
144
144
144
D
144
154
144
144
144
144
keylog
S
133
133
133
133
133
133
D
133
133
133
133
133
133
killproc
S
D
149
149
158
158
149
149
149
149
149
149
149
149
simplespam
D
135
158
1
1
135
135
S
135
158
1
1
135
135
udpﬂood
S
D
136
136
138
138
128
136
128
136
136
136
136
136
sniff
S
129
134
129
129
129
129
D
129
134
124
124
129
129
NUMBER OF SAMPLES (OUT OF 10) MATCHING EACH BEHAVIORAL MODEL IN (S)TATIC AND (D)YNAMIC MODE, USING DIFFERENT COMPILERS.
Table III
Compiler
VS 2003
VS 2005
VS 2008
Intel
httpd
D
S
10
10
10
10
10
10
0
10
keylog
D
S
10
10
10
10
10
10
0
0
killproc
D
S
10
10
10
10
10
10
0
0
simplespam udpﬂood
D
S
10
10
10
10
10
10
0
0
S
10
10
10
0
D
10
10
10
0
sniff
S
10
10
10
0
D
10
10
10
0
GENOTYPE MATCHING RESULTS ON IRC DATASETS.
Table IV
Genotype
Phenotype
backdoor
keylog
killproc
httpd
keylog
killproc
simplespam spam
udpﬂood
sniff
packetﬂood
sniff
B
2014
0
0
154
0
43
irc bots
D
S
635
636
293
254
400
400
409
409
342
374
270
72
B ∩ S
279
0
0
0
0
0
B
840
0
4
53
0
120
packed bots
S
425
120
62
204
139
204
D
425
111
62
204
122
45
B ∩ S
264
0
0
0
0
0
GENOTYPE MATCHING RESULTS ON PUSHDO AND ALLAPLE DATASETS.
Table V
Genotype
drop
spam
scan
rpcbind
B
50
1
23
5
pushdo
D
54
42
0
0
S
54
43
0
9
B ∩ S
46
1
0
1
B
0
0
58
62
allaple
D
0
0
61
61
S
0
0
61
61
B ∩ S
0
0
58
58
execution in Anubis. The observed, dynamic behaviors in
Anubis are shown in columns marked with B.
Comparing the Anubis results with the static and dynamic
REANIMATOR results shows that, even with a limited set
of genotypes derived from a single malware binary, our
techniques can dramatically improve the number of malware
capabilities that are discovered. For instance, for the snifﬁng
behavior, Anubis detects 163 samples, while REANIMATOR
detects 474. For some of the other genotypes, the increase
in coverage is even more signiﬁcant. For example, only four
binaries killed another process while executed in Anubis.
The B∩ S column shows the number of samples matched
by both REANIMATOR and Anubis. That fact
that, for
most behaviors, no samples were matched by both Anubis
and Reanimator may seem surprising at ﬁrst. However, it
does not indicate false negatives on REANIMATOR’s part.
The genotype models detected by REANIMATOR correspond
to a single implementation of a certain behavior. Hence,
completely unrelated implementations would require addi-
tional models. The samples that included the simplespam
phenotype according to REANIMATOR, for instance, did
not send spam during Anubis analysis. This indicates that,
during analysis, the bot did not receive commands triggering
this behavior. The likely reason is that the spam functionality
modeled by the simplespam genotype is very primitive