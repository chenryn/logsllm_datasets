# Poking a Hole in the Wall: Efficient Censorship-Resistant Internet Communications by Parasitizing on WebRTC

## Authors
Diogo Barradas, Nuno Santos, Luís Rodrigues, Vítor Nunes  
INESC-ID, Instituto Superior Técnico, Universidade de Lisboa  
{diogo.barradas, nuno.m.santos, ler, vitor.sobrinho.nunes}@tecnico.ulisboa.pt

## Abstract
Many censorship circumvention tools rely on trusted proxies to allow users in censored regions to access blocked content via covert channels (e.g., piggybacking on Skype video calls). However, developing tools that can simultaneously provide high bandwidth and strong traffic analysis resistance remains a significant challenge, hindering the practical adoption of such tools.

We introduce Protozoa, a censorship-resistant tunneling tool that offers both high-performance covert channels and robust traffic analysis resistance. To establish a covert channel, a user simply needs to initiate a video call with a trusted party outside the censored region using a popular WebRTC streaming service, such as Whereby. Protozoa then covertly tunnels all IP traffic from unmodified user applications (e.g., Firefox) through the WebRTC video stream. This is achieved by intercepting the WebRTC stack and replacing the encoded video frame data with IP packet payloads, while ensuring the WebRTC stream remains encrypted and its statistical properties are indistinguishable from a typical video call. This technique supports sufficient throughput for common internet activities, such as web browsing or bulk data transfer, and evades state-of-the-art traffic analysis attacks. We demonstrate that Protozoa can effectively evade state-level censorship in China, Russia, and India.

## CCS Concepts
- **Security and Privacy**: Network Security
- **Social and Professional Topics**: Technology and Censorship

## Keywords
Censorship circumvention, Traffic analysis, WebRTC

## ACM Reference Format
Diogo Barradas, Nuno Santos, Luís Rodrigues, Vítor Nunes. 2020. Poking a Hole in the Wall: Efficient Censorship-Resistant Internet Communications by Parasitizing on WebRTC. In Proceedings of the 2020 ACM SIGSAC Conference on Computer and Communications Security (CCS '20), November 9–13, 2020, Virtual Event, USA. ACM, New York, NY, USA, 14 pages. https://doi.org/10.1145/3372297.3417874

## Introduction
State-level censors employ various techniques to restrict free access to information on the Internet. Countries like China, Russia, Iran, Bangladesh, India, Thailand, and Syria have implemented extensive censorship mechanisms. For example, during the recent Coronavirus outbreak, the Chinese government shut down news websites and instructed social media platforms to censor related keywords, aiming to control the spread of negative coverage.

To evade such censorship, numerous tools have been developed to enable users to freely access and share information. These tools often use covert channels, which transmit sensitive data through an apparently innocuous medium, such as a multimedia streaming application like Skype. The key idea is to encode the covert data in a way that it is indistinguishable from legitimate traffic. This approach, known as multimedia covert streaming, can be achieved by mimicking the carrier’s network protocols or embedding the covert data into the video or audio feed of the carrier application.

While all carrier traffic is encrypted, adversaries can block all traffic generated by the carrier application. However, this method has significant drawbacks, including the disruption of essential economic and social interactions. Therefore, leveraging essential streaming applications can deter the enforcement of blocking policies, making multimedia covert streaming effective.

Adversaries can also use traffic analysis to detect covert channels by inspecting for discrepancies in traffic patterns. An effective multimedia covert streaming tool must exhibit traffic patterns indistinguishable from legitimate traffic. Unfortunately, existing tools often fail to meet this requirement. For instance, DeltaShaper, while somewhat resistant to detection, severely limits the covert channel bandwidth capacity, achieving only up to 7 Kbps, which is insufficient for typical internet activities.

Protozoa addresses these challenges by providing a new multimedia covert streaming tool that offers high performance and strong resistance to traffic analysis. Protozoa allows a user in a censored region to access blocked content by establishing a video call with a trusted user in a free region using a WebRTC-enabled streaming service like Whereby. Protozoa then creates a bidirectional covert tunnel, allowing the user to browse the web freely. The local IP traffic is transparently redirected through the covert tunnel to its destination host.

Protozoa incorporates two key innovations: 
1. It uses popular and widely disseminated WebRTC-based streaming applications.
2. It introduces "encoded media tunneling," which embeds covert data into encoded video frames, boosting the capacity of covert channels while resisting traffic analysis.

Our evaluation of Protozoa, conducted through microbenchmarks and realistic usage scenarios, shows that under normal network conditions, Protozoa can deliver a covert channel bandwidth capacity of up to 1.4 Mbps with 98.8% efficiency, while providing strong resistance to state-of-the-art traffic analysis techniques. As illustrated in Figure 1, Protozoa significantly outperforms existing systems in both bandwidth and security.

![Design Space of Multimedia Covert Streaming Tools](figure_1.png)
*Figure 1: Design space of multimedia covert streaming tools along two dimensions: covert channel capacity (X-axis) and traffic analysis resistance (Y-axis). Darker shades indicate increasing chances of detection, i.e., tools are more insecure. Protozoa outperforms existing systems in both dimensions. A detailed analysis of this plot is found in Section 9.1.*