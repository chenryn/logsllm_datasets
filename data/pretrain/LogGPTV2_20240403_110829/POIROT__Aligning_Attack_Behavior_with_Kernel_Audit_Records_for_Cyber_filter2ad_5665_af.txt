∗\vmbusres.dll
∗\vmGuestlib.dll
%TEMP%\∗.%exe%
∗
%TEMP%\temps
∗.%exe%
∗
%temp%\∗
%temp%\[0-9].tmp.%exe%
%Microsoft Word%
∗\rastlsc.%exe%
∗\rastls.dll
∗\(Sylog.bin|OUTLFLTR.DAT)
rastlsc
\SOFTWARE\Classes\AppX∗
∗\HTTPProv.dll
SOFTWARE\Classes\CLSID\{E3517E26-8E93-458D-A6DF-8030BC80528B}
%External IP address%
Aligned Node Label
Thunderbird
invitation.exe
invitation
C:\Windows\SysWOW64\svchost.exe:WofCompressedData
svchost
None
C:\ProgramData\Mozilla\BwgWXFhfbVpfWgJfBg.bin
[HKCU]\Software\Microsoft\Windows\CurrentVersion \Internet Settings
C:\Users\test_user\AppData\Roaming\Mozilla\Firefox\Profiles\
ddl1t72n.default\prefs.js
None
contract.exe
C:\Users\test_user\AppData\Roaming\Microsoft\credprov.tlb
C:\Users\test_user\AppData\Roaming\Microsoft\shdocvw.tlb
rundll32
[HKCU]\Software\Classes\CLSID\42aedc87-2188-41fd-b9a3-
0c966feabec1\
None
None
None
C:\Users\test_user\AppData\Roaming\Microsoft\oleaut32.dll
C:\Users\test_user\AppData\Roaming\Microsoft\oleaut32.tlb
C:\Users\test_user\AppData\Roaming\Microsoft\libadcodec.dll
C:\Users\test_user\AppData\Roaming\Microsoft\libadcodec.tlb
News.docx.exe
News
C:\Program Files\Microsoft Office\Office12\Winword.exe
C:\WINDOWS\vboxmrxnp.dlls
C:\WINDOWS\vmbusres.dlls
C:\WINDOWS\SysWOW64\vmGuestLib.dll
C:\Users\test_user\AppData\Local\Temp
\1371372533114561232114361100131187183149253.exe
1371372533114561232114361100131187183149253
C:\Users\test_user\AppData\Local\Temp\temps
Chi tiet don khieu nai gui saigontel.exe
Chi tiet don khieu nai gui saigontel
C:\Users\test_user\AppData\Local\Temp\tmp.docx
None
C:\Program Files\Microsoft Office\Office12\Winword.exe
C:\Program Files (x86)\Symantec\Officewordtask\rastlsc.exe
C:\Program Files (x86)\Symantec\Officewordtask\rastls.dll
C:\Program Files (x86)\Symantec\Officewordtask\OUTLFLTR.DAT
rastlsc
None
None
SOFTWARE\Classes\CLSID\{E3517E26-8E93-458D-A6DF-8030BC80528B}
None
Table 5: Node labels of the query graphs in Fig. 6 and their alignments.
Fig. 6: Query Graphs of Carbanak, Uroburos, DustySky, and OceanLotus malware extracted from their CTI reports.
ABCDEGHIFJ1. write2. exec3. write4. exec5. unlink7. write8. read6. fork10. send9. readABCDEGHI1. exec2. fork3. read4. read5. read7. write8. fork9. exec10. writeF6. readAB1: writeC2: writeD3: fork4: load5: loadE6: writeF7: write10: unlinkI12: unlinkJ13: unlink11: unlinkK14: unlinkL15: unlinkG8: writeH9: writeUroburosDustySkyCarbanakABDCFHGIKJLM1. exec3. write2. write6. write8. write7. write9. fork10. exec12. read11. load14. load13. read15. write16. write17. readE4. fork5. execOceanLotusSession 6D: Cyber Thread CCS ’19, November 11–15, 2019, London, United Kingdom1806Malware
njRAT
Node
A
B
C
D
E
F
G
H
I
J
K
L
M
N
A
B
C
D
E
F
G
H1
H2
H3
H4
H5
H6
H7
H8
H9
H10
H11
H12
I1
I2
I3
I4
I5
I6
I7
I8
J
K
L
M
A
B
C
D
E
HawkEye
DeputyDog
(Fig. 2)
Label
∗
∗.exe.config
∗.tmp
C:\WINDOWS\Prefetch\∗.EXE-∗.pf
%APPDATA%\∗
∗
C:\WINDOWS\Prefetch\∗.EXE-∗.pf
%USER_PROFILE%\Start Menu\Programs\Startup\∗
netsh
C:\WINDOWS\Prefetch\NETSH.EXE-∗.pf
[HKCU]\Software\Microsoft\Windows\CurrentVersion\Run\
[HKLM]\Software\Microsoft\Windows\CurrentVersion\Run\
[HKLM]\SYSTEM\CurrentControlSet\Services\SharedAccess\-
Parameters\FirewallPolicy\StandardProfile\Authorized-
Applications\List\APPDATA\
%External IP address%
∗.%Compressed%
%Unachiever%
∗.%exe%
∗
RegAsm
vbc
vbc
∗Opera∗
∗Chrome∗
∗Chromium∗
∗Chrome SxS∗
∗Thunderbird∗
∗SeaMonkey∗
∗SunBird∗
∗IE∗
∗Safari∗
∗Firefox∗
∗Yandex∗
∗Vivaldi∗
∗Yahoo∗
∗GroupMail∗
∗Thunderbird∗
∗MSNMessenger∗
∗Windows Mail∗
∗IncrediMail∗
∗Outlook∗
∗Eudora∗
%temp%\∗.tmp
%temp%\∗.tmp
http[s]:\\whatismyipaddress.com\∗
%External IP address%
∗.%exe%
∗
%APPDATA%\∗
[HKCU]\Software\Microsoft\Windows\CurrentVersion\ Run\
%External IP address%
Aligned Node Label
Authorization
C:\Users\test_user\Desktop\Authorization.exe.config
C:\Users\test_user\AppData\Roaming\ja33kk.exe.tmp
C:\Windows\Prefetch\AUTHORIZATION.EXE-69AD75AA.pf
C:\Users\test_user\AppData\Roaming\ja33kk.exe
ja33kk
C:\Windows\Prefetch\JA33KK.EXE-7FA5E873.pf
C:\Users\test_user\AppData\Roaming\Microsoft\Windows\Start
Menu\Programs\Startup\9758a8dfbe15a00f55a11c8306f80da1.exe
netsh
C:\Windows\Prefetch\NETSH.EXE-CD959116.pf
[HKCU]\Software\Microsoft\Windows\CurrentVersion\Run\
[HKLM]\Software\Microsoft\Windows\CurrentVersion\Run\
None
None
PROFORMA INVOICE _20190423072201 pdf.bin.zip
WinRAR.exe
C:\Users\test_user\Desktop\PROFORMA INVOICE _20190423072201 pdf.bin
PROFORMA INVOICE _20190423072201 pdf
RegAsm
vbc (PID1)
vbc (PID2)
C:\Users\test_user\AppData\Roaming\Opera\Opera7\profile\wand.dat
C:\Users\test_user\AppData\Local\Google\Chrome\User Data\Default\Login
Data
C:\Users\test_user\AppData\Local\Chromium\User Data
C:\Users\test_user\AppData\Local\Google\Chrome SxS\User Data
C:\Users\test_user\AppData\Roaming\Thunderbird\Profiles
C:\Users\test_user\AppData\Roaming\Mozilla\SeaMonkey\Profiles
None
C:\Users\test_user\AppData\Local\Microsoft\Windows\History\History.IE5
None
C:\Users\test_user\AppData\Roaming\Mozilla\Firefox\profiles.ini
C:\Users\test_user\AppData\Local\Yandex\YandexBrowser\User
Data\Default\Login Data
C:\Users\test_user\AppData\Local\Vivaldi\User Data\Default\Login Data
[HKLM]\Software\Yahoo\Pager
None
C:\Users\test_user\AppData\AppData\Roaming\Thunderbird\Profiles
[HKLM]\Software\Microsoft\MSNMessenger
C:\Users\test_user\AppData\Local\Microsoft\Windows Mail
[HKLM]\Software\WOW6432Node\IncrediMail\Identities
[HKLM]\Software\Microsoft\Office\16.0\Outlook\Profiles
[HKLM]\Software\Qualcomm\Eudora\CommandLine
C:\Users\test_user\AppData\Local\Temp\tmp8FC3.tmp
C:\Users\test_user\AppData\Local\Temp\tmp8BAB.tmp
None
None
C:\Users\test_user\Desktop\img20130823.jpg.exe
img20130823
C:\ProgramData\28542CC0.dll
None
180.150.228.102
Table 6: Node labels of the query graphs in Figs. 2 and 7 and their alignments.
Fig. 7: Query Graphs of HawkEye and njRAT malware, extracted from their CTI reports.
H1I1I2I8H12H2H1ABCDEGFKJLM1. read2. write3. exec4. fork6. fork5. fork19. open26. open20. open28. write30. read32. unlink7. open8. open18. open27. write29. read31. unlink33. write34. read33. writeHawkEyeBADCEFGHIJKLMN1. read3. write2. write4. write5. fork6. exec7. write8. write9. fork10. write11. write12. write13. write14. sendnjRATSession 6D: Cyber Thread CCS ’19, November 11–15, 2019, London, United Kingdom1807Scenario
BSD-1
BSD-2
BSD-3&4
Win-1&2
Linux-1&2
Linux-3
Linux-4
Size on Disk
(Uncompressed)
Consumption
time
3022 MB
4808 MB
1828 MB
54.57 GB
9436 MB
131.1 GB
4952 MB
0h-34m-59s
0h-58m-05s
0h-21m-31s
4h-58m-30s
1h-26m-37s
2h-30m-37s
0h-04m-00s
Occupied
Memory
867 MB
1240 MB
638 MB
3790 MB
4444 MB
21.2 GB
1095 MB
Log Duration
03d-18h-01m
05d-01h-15m
02d-00h-59m
08d-13h-35m
03d-04h-20m
10d-15h-52m
00d-07h-13m
sub ∈
|V (Gp)|
110.66 K
213.10 K
84.39 K