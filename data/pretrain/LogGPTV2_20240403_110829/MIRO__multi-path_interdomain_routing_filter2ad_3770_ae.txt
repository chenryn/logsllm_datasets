good guesses can greatly shorten the negotiation process. For
a security policy like “avoiding AS 312,” some possible can-
didates are the ASes on the default path between the request-
ing AS and AS 312 that understand the new protocol.
• Responding: whether to allow negotiations The responding
AS could specify a limit for the total number of tunnels, a
rate limit for establishing new tunnels, or a ﬁrewall where
only negotiation requests from trusted peers are accepted.
The responding AS could specify ﬁlter rules to selectively export
its candidate routes. The requesting AS should also set evaluation
rules to determine which candidate to pick. Those rules may evalu-
ate several factors in the decision process, like the price cost or the
quality of different routes.
• Route ﬁltering The ﬁltering rules can draw on existing route
attributes, e.g., only advertise routes that have a local pref-
erence of more than 100. In practice, an ISP often assigns
all customer routes the same preference value, all peer routes
with lower values, and all provider routes with even smaller
values. Therefore we can easily specify the selective export
rules described in Section 3.4 based on local preference.
• Route preference and cost The routes more preferred to the
requesting AS may be those less desired to the responding
AS. For example, the requesting AS wants to select a low
latency route in the responding AS which goes through an
expensive provider link. In this case, we could introduce a
price system so that the responding AS is compensated ac-
cordingly. Any notion of price would work as long as both
parties agree on it. With a price tag attached to each route,
innovative business models could be enabled. For example,
the responding AS could sell all customer routes for a lower
price and all peer routes for a higher price. The requesting
AS then picks routes based on both local preference and cost.
Optionally, the requesting ASes could specify simple require-
ments to avoid sending useless candidate routes. For example, the
requesting AS could explicitly request “only give me paths without
AS 312”. The responding AS adds the requirement to candidate
ﬁltering before responding with ﬁnal answers.
7. DISCUSSIONS
7.1 Route Convergence
Since MIRO changes how ASes select interdomain routes, we
need to consider the possible effects on BGP convergence. Previ-
ous work has shown that certain combinations of routing policies
can cause BGP to oscillate [22]. Follow-up work showed that con-
vergence is guaranteed if ASes select and export routes based on
the conventional business relationships [20]. However, since MIRO
provides ways for ASes to violate these guidelines, convergence
problems could potentially arise.
MIRO is guaranteed to converge in a restricted, yet important,
scenario. If the upstream AS does not advertise the tunneled path
to any other AS, MIRO converges whenever the underlying BGP
converges. For example, the many stub ASes in the Internet do not
export routes learned from one upstream provider to another and,
as such, would never export a tunneled path “back into BGP.” In
reality, a requesting AS often needs just one tunnel to satisfy its
path-selection goals. The diameter of the AS graph is small, and
MIRO enables an AS to negotiate with non-neighboring ASes. As
such, we envision that an end-to-end path would typically include
at most one tunnel. In summary, we think this conservative require-
ment would not be too restrictive for the following reasons:
• Most ASes are stub ASes. In the 2005 topology generated by
the Gao algorithm, 17,347 out of 20,930 ASes are stubs.
• The observed average AS path length is only 4, therefore
tunnel concatenations are likely to be very rare—so rare we
could preclude them.
• We allow negotiations between non-adjacent ASes, so in-
stead of establishing a chain of tunnels, the source AS can
directly contact the other end of the chain.
As ongoing work, we are creating a formal model of multi-path
routing to establish these convergence properties. We have found
several ways to relax the “just one tunnel” requirement that we are
exploring in more detail.
7.2 Routing Loops
BGP takes great care to ensure that paths do not contain loops.
As each router forwards packets solely based on destination IP ad-
dress, loops in BGP paths can lead to lost packets. However, in
overlay networks, packets can physically traverse an AS more than
once. For example, if an overlay node is located in an AS X single-
homed to its ISP Y, all packets forwarded by this node will traverse
the network of Y twice. But this will not lead to lost packets, as
packets in different tunnels bear different destination IP addresses.
Similarly, traversing an AS more than once is not a problem in
MIRO, as long as all the tunnel endpoints and the default path
between tunnel endpoints form a loop-free path—a property that
could be easily checked during the negotiation process.
However, traversing an AS more than once may be inefﬁcient,
so ASes in MIRO can also enforce a stricter kind of loop detection.
Both negotiating parties know the path the packets will take when
they leave the tunnel; moreover, the upstream AS knows the path
traversed by the tunnel itself. Therefore, the upstream AS should
concatenate both parts and reject negotiations if any AS appears
more than once in the resulting end-to-end path.
7.3 Route Aggregation and Security
Like many studies of interdomain routing, we implicitly assume
that the AS path in the BGP announcements identiﬁes the actual se-
quence of ASes the data packets would traverse. However, route ﬁl-
tering and route aggregation may violate this assumption. A down-
stream AS may have a BGP route for a more-speciﬁc preﬁx, which
would deﬂect data packets to a different path. Similar path incon-
sistencies can arise if an adversary has control over the data plane
and deﬂects packets to a different path. Packet deﬂection is a gen-
eral problem that can complicate BGP routing. Ultimately, a secure
and robust interdomain routing infrastructure may require compro-
mising on support for route aggregation (e.g., by routing all trafﬁc
at the AS level, rather than at the preﬁx level). Effective support
for multi-path routing makes that possible, since ASes could still
achieve their load balancing, performance, and security goals with-
out needing to announce separate routes for each destination preﬁx.
We plan to explore these issues in more detail in our ongoing work.
8. RELATED WORK
Previous work has considered other approaches to ﬂexible Inter-
net routing. Source-routing proposals [1–5] can provide multiple
routes for every source-destination pair, and several of them [1, 5]
explicitly suggest routing at the AS level rather than at the router
level, as we do in MIRO. However, source routing does not give
intermediate ASes much control over path selection. Some work
considers receiver policies [4], but primarily to ﬁlter trafﬁc coming
from suspicious routes. MIRO bears some similarities to overlay
networks [6], in terms of establishing tunnels that encapsulate and
decapsulate packets. However, MIRO selects paths on the under-
lay with the cooperation of the routers in intermediate ASes, rather
than directing packets over virtual links to intermediate hosts.
Several papers propose new ways to disseminate reachability in-
formation. Nimrod [23] uses clusters to hide the internal topol-
ogy of a network, revealing additional details only upon request.
However, the members of a Nimrod cluster must be contiguous,
while MIRO’s negotiations can happen between arbitrary pairs of
ASes. Also, the Nimrod work does not present the technical de-
tails of how clusters and the request-response protocol should be
realized. In contrast, MIRO can be deployed incrementally as an
extension to today’s BGP protocol. The recent HLP [14] proposal
uses a hybrid of link-state and path-vector routing. Multiple ASes
with provider/customer relationships form a group and use link-
state routing to compute paths; the groups use a path-vector proto-
col to exchange routing information with each other. In contrast,
MIRO uses BGP route announcements by default and supports ne-
gotiation between arbitrary pairs of ASes.
Other routing architectures consider the role of cost and incen-
tives in making interdomain routing decisions. Nexit [24] enables
pairs of neighboring ASes to cooperate in selecting egress points
for exchanging trafﬁc, to avoid the inherent inefﬁciency of hot-
potato routing and conventional trafﬁc engineering practices [25].
In contrast to MIRO, the negotiation in Nexit focuses speciﬁcally
on selecting between the existing BGP-learned routes at multiple
egress points rather than discovering new interdomain routes. In
that sense, the two proposals are complementary and could con-
ceivably be part of a larger framework for using negotiation to
improve interdomain routing. Another recent study [26] proposes
a routing system that advertises multiple AS paths, with pricing
information attached to each announcement. However, the paper
does not present a concrete design and evaluation of a protocol,
making it difﬁcult to compare to MIRO directly.
Multi-path routing has been explored in the context of intradomain
routing. Equal Cost Multi-Path (ECMP) allows routers to split
trafﬁc over multiple shortest paths in intradomain routing proto-
cols such as OSPF and IS-IS. Some proposals have considered
ways to relax the requirement that all of the paths between two
nodes have the same (lowest) cost [27]. In addition, recent work
on TeXCP [16] has explored how to split trafﬁc over multiple in-
tradomain paths for more effective trafﬁc engineering. In TeXCP,
ingress nodes dynamically adapt the splitting of trafﬁc over multi-
ple paths, which are computed in advance. TeXCP and MIRO are
complementary, in that MIRO focuses on identifying and selecting
paths, whereas TeXCP focuses on how to adjust the proportions of
trafﬁc that traverse the paths.
Techniques for selecting multiple paths within an AS do not ex-
tend directly to interdomain routing. Within an AS, routers can
share topology information and have a common objective. In con-
trast, in interdomain routing, ASes have limited information about
the network topology and may have different (or even conﬂicting)
path-selection goals. Some recent work has proposed extensions
to BGP to propagate QoS metrics [28]. However, this approach is
problematic in practice because its requires extensive deployment
and cooperation among ASes, and may introduce scalability chal-
lenges if the QoS information changes frequently.
Recent work at the IETF proposes extensions to BGP to enable a
BGP speaker to announce multiple routes for the same preﬁx [29],
without describing how these routes are selected, exported, or in-
stalled in the data plane. An implementation of MIRO could adopt
the protocol extensions as a way to identify the advertised routes.
Another related IETF activity is the Path Computation Element
(PCE) working group [30] that is deﬁning an architecture that al-
lows special computational components to select paths on behalf of
the routers. PCE is meant to support constraint-based path compu-
tation both within and across ASes, with an emphasis on satisfy-
ing trafﬁc-engineering goals by establishing MPLS label-switched
paths.
In contrast, MIRO was designed as an incrementally de-
ployable extension to BGP to support multipath routing. Still, the
two schemes share similar requirements for ASes to cooperate in
selecting paths while hiding topology details from each other.
9. CONCLUSION
In this paper, we have presented a multi-path interdomain routing
protocol, called MIRO. MIRO defaults to the single-path routing
provided by conventional BGP but allows ASes to negotiate alter-
nate paths as needed. This provides ﬂexibility where needed while
remaining backwards compatible with BGP. Compared to source
routing, MIRO gives transit ASes more control over the ﬂow of
trafﬁc in their networks. An evaluation on realistic AS-level topolo-
gies shows that MIRO exposes much of the underlying path diver-
sity in the Internet, even when only the major ISPs have deployed
the enhanced protocol. We also ﬁnd that signiﬁcant path diversity
is available even if ASes adhere to conventional practices for ex-
porting routes based on their business relationships.
A natural next step is to ﬂesh out the implementation and build a
prototype system, to quantify the overheads for encapsulating and
decapsulating packets, as well as maintaining the tunnel tables. We
can also evaluate the overhead for distributing the tunnel tables, as
a function of network topology. Another interesting direction for
study is the security implications of MIRO. Without any security
measures, adversaries could spoof the tunnel identiﬁers to direct
their trafﬁc onto better paths or launch a denial-of-service attack on
the downstream AS. A trust system should be in place so spoofed
tunnel identiﬁers could be detected as early as possible.
Efﬁcient support for multi-path routing enables a variety of tech-
niques for ASes to balance load and optimize performance, be-
yond the load-balancing schemes today’s multi-homed ASes can
employ. However, the ﬂexibility to split trafﬁc over multiple paths
introduces the possibility of oscillation, where each AS adjusts its
division of trafﬁc in response to congestion introduced by another
AS. Divising a decentralized load-balancing scheme that prevents
oscillation is an interesting avenue for future work.
In addition,
by allowing ASes to negotiate for alternate routes, MIRO opens up
many interesting questions about how to incorporate pricing, load,
and performance information into the path-selection process.
10. ACKNOWLEDGMENTS
This work was supported by HSARPA grant 1756303, and a URP
grant from Cisco. We thank Ming Zhang for his valuable feedback
in the early stages of this work. We are also grateful to Ioannis
Avramopoulos, Elliott Karpilovsky, Dan Wendlandt, Yaping Zhu,
and the anonymous reviewers for their comments and suggestions.
11. REFERENCES
[1] D. Zhu, M. Gritter, and D. Cheriton, “Feedback based
routing,” in Proc. SIGCOMM Workshop on Hot Topics in
Networking, October 2002.
[2] H. T. Kaur, S. Kalyanaraman, A. Weiss, S. Kanwar, and
A. Gandhi, “BANANAS: An evolutionary framework for
explicit and multipath routing in the Internet,” in Proc.
Future Directions in Network Architecture, 2003.
[3] B. Raghavan and A. C. Snoeren, “A system for authenticated
policy-compliant routing,” in Proc. ACM SIGCOMM,
pp. 167–178, 2004.
[4] K. Argyraki and D. R. Cheriton, “Loose source routing as a
mechanism for trafﬁc policies,” in Proc. Future Directions in
Network Architecture, 2004.
[5] X. Yang, “NIRA: A new Internet routing architecture,” in
Proc. Future Directions in Network Architecture, 2003.
[6] D. Andersen, H. Balakrishnan, F. Kaashoek, and R. Morris,
“Resilient overlay networks,” in Proc. SOSP, 2001.
[7] B. Quoitin, S. Uhlig, C. Pelsser, L. Swinnen, and
O. Bonaventure, “Interdomain trafﬁc engineering with BGP,”
IEEE Communication Magazine, 2003.
[8] “University of Oregon Route Views Project.”
http://www.routeviews.org.
[9] Y. Rekhter, T. Li, and S. Hares, “A Border Gateway Protocol
4 (BGP-4).” RFC 4271, January 2006.
[10] G. Huston, “Interconnection, peering, and settlements,” in
Proc. INET, June 1999.
[11] L. Gao, “On inferring Autonomous System relationships in
the Internet,” IEEE/ACM Trans. Networking, vol. 9, no. 6,
pp. 733–745, 2001.
[12] L. Subramanian, S. Agarwal, J. Rexford, and R. H. Katz,
“Characterizing the Internet hierarchy from multiple vantage
points,” in Proc. IEEE INFOCOM, June 2002.
[13] L. Qiu, Y. R. Yang, Y. Zhang, and S. Shenker, “On selﬁsh
routing in Internet-like environments,” in Proc. ACM
SIGCOMM, pp. 151–162, 2003.
[14] L. Subramanian, M. Caesar, C. T. Ee, M. Handley, M. Mao,
S. Shenker, and I. Stoica, “HLP: A next generation
inter-domain routing protocol,” in Proc. ACM SIGCOMM,
pp. 13–24, 2005.
[15] M. Caesar and J. Rexford, “BGP policies in ISP networks,”
IEEE Network Magazine, October 2005.
[16] S. Kandula, D. Katabi, B. Davie, and A. Charny, “Walking
the tightrope: Responsive yet stable trafﬁc engineering,”
Proc. ACM SIGCOMM, vol. 35, no. 4, pp. 253–264, 2005.
[17] E. Rosen, A. Viswanathan, and R. Callon, “Multiprotocol
Label Switching Architecture.” RFC 3031, January 2001.
[18] M. Caesar, D. Caldwell, N. Feamster, J. Rexford, A. Shaikh,
and J. van der Merwe, “Design and implementation of a
routing control platform,” in Proc. NSDI, May 2005.
[19] X. Yang, D. Wetherall, and T. Anderson, “A DoS-limiting
network architecture,” ACM SIGCOMM Computer
Communication Review, vol. 35, no. 4, pp. 241–252, 2005.
[20] L. Gao and J. Rexford, “Stable Internet routing without
global coordination,” IEEE/ACM Trans. Networking, vol. 9,
no. 6, pp. 681–692, 2001.
[21] Z. M. Mao, L. Qiu, J. Wang, and Y. Zhang, “On AS-level
path inference,” in Proc. ACM SIGMETRICS, 2005.
[22] T. G. Grifﬁn, F. B. Shepherd, and G. Wilfong, “The stable
paths problem and interdomain routing,” IEEE/ACM Trans.
Networking, vol. 10, no. 2, pp. 232–243, 2002.
[23] I. Castineyra, N. Chiappa, and M. Steenstrup, “The Nimrod
Routing Architecture.” RFC 1992, August 1996.
[24] R. Mahajan, D. Wetherall, and T. Anderson,
“Negotiation-based routing between neighboring ISPs,” in
Proc. NSDI, 2005.
[25] R. Johari and J. Tsitsiklis, “Routing and peering in a
competitive Internet.” LIDS Publication 2570, 2003.
[26] M. Afergan and J. Wroclawski, “On the beneﬁts and
feasibility of incentive based routing infrastructure,” in Proc.
Workshop on Practice and Theory of Incentives in
Networked Systems, pp. 197–204, September 2004.
[27] J. Chen, P. Druschel, and D. Subramanian, “An efﬁcient
multipath forwarding method,” in Proc. IEEE INFOCOM,
pp. 1418–1425, March 1998.
[28] L. Xiao, K. Lui, J. Wang, and K. Nahrstedt, “QoS extension
to BGP,” in Proc. International Conference on Network
Protocols, 2002.
[29] D. Walton, A. Retana, and E. Chen, “Advertisement of
multiple paths in BGP.” Internet Draft,
draft-walton-bgp-add-paths-05.txt, Expires August 2006.
[30] “Path computation element charter.” http://www.ietf.
org/html.charters/pce-charter.html.