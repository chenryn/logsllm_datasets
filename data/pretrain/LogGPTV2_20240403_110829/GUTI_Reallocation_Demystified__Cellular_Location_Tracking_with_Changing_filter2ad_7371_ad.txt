CSFB call service, to the network using the old GUTI, and
then, it sends a TAU complete message. Moreover, even if
the network has assigned a new GUTI to the UE, both the UE
and the network continue to communicate using the old GUTI.
This race condition occurs owing to the use of different
standards. The standard [4] associated with this process does
not provide a clear method to handle this collision: it simply
states that both procedures must be carried out but does not
specify the order of processing. Therefore, preparation for
the collision is implemented differently by each carrier. For
example, KR-I set the priority of TAU higher than those of
other service requests. Therefore, when the network received
a TAU request from the UE, it first completed it. In other
words, the scenario described in Figure 7(b) does not occur in
KR-I because the network that received the TAU request does
not forward the Paging request to the UE. In other words,
KR-I avoids this race condition by not forwarding the Paging
request, because it must be handled only after the UE sends
the TAU accept message. However, in the case of US-I and
KR-II, a signaling race condition happens occasionally because
the priority of TAU is not set higher than that of ESR. If
another user had known the time at which the UE had sent a
TAU request, it could have made a voice call to cause the UE
to use its old GUTI.
C. Listening to Paging in Stress Testing
One challenge is listening to paging messages during the
stress test. If the connection between the mobile device and the
network is maintained, the paging message is delivered over the
connected session channel rather than the broadcast channel.
Note that stress testing is conducted by generating CSFB
calls with a short gap before the UE releases the connection.
Therefore, one might wonder whether the paging messages
generated by stress testing are exposed to the broadcast channel.
Carriers want to minimize unnecessary sessions between the
network and the mobile device to reduce the load at the core
network. For instance, many carriers drop the connection by
sending an RRC Connection Release message to the mobile
device immediately after completing the TAU. This allows
us to monitor the GUTI in paging messages during stress
testing. In our dataset, US-II, KR-I, and KR-II also drop the
RRC connection when they completed TAU accept during
the stress test; therefore, we could monitor the GUTI value in
paging messages through the broadcast channel.
We monitored the control plane message through the
diagnostic port in the mobile device. The broadcast channel was
monitored using Universal Software Radio Peripheral (USRP)
B210 [41] and srsLTE [36], an open-source 3GPP LTE library.
Through the stress test, we set up an environment to collect
broadcast messages when the network did not reallocate the
GUTIs to the mobile device. We placed the LTE broadcast
channel receiver (USRP + srsLTE) in a TA to which the
mobile device belonged. In this environment, as we continued
to call the mobile device, it continued to make Service
Requests using the same GUTI. Figure 8 shows the GUTI
monitored on the (a) mobile device and the (b) broadcast
channel during our stress test. The GUTI of the device was
fixed at 0xC816425D (see Fig. 8 (a)), and we captured the
paging message delivered to the device in the broadcast channel
through our LTE broadcast channel receiver. Figure 8(b) shows
that the GUTI with M-TMSI 0xC816425D broadcasted on the
air interface was captured.
D. Ethics
Throughout the stress test experiments along with the global
measurement of GUTI reallocation, we care about the possible
negative impact on the network and other subscribers. First,
one might care about the signaling storm due to stress testing.
However, the generated signaling messages are limited to 30
calls between only two devices, which is negligible for the
network. We also confirm that the test does not affect other
users through an interview with an operator. Second, we only
collect GUTIs in the broadcast channel only, which do not
provide any private information.
8
Tracking Area Update AcceptGUTI Reallocation Command(New GUTI)UE NetworkTracking Area Update Request(Old GUTI)Tracking Area Update CompleteGUTI Reallocation CompleteExtended Service Request(New GUTI)Tracking Area Update AcceptGUTI Reallocation Command(New GUTI)UE Tracking Area Update Request(Old GUTI)Tracking Area Update CompleteGUTI Reallocation CompleteExtended Service Request(Old GUTI)Paging Request (CSFB Call)(Old GUTI)Network(a) Normal GUTI Reallocation with CSFB call(b) GUTI Reallocation and CSFB call collisionPaging Request (CSFB Call)(New GUTI)Fig. 8: GUTI exposed to broadcast channel during stress testing.
VI. ATTACK
In this section, we present our location leakage attack for
using our findings from our measurement study. We show how
the location of the victim can be leaked even in an environment
in which temporary identities are frequently changed by our
attack method. First, we describe the overall flow of our
attacks by categorizing the voice call technology that the
victim uses. We then present the attack procedures and how the
characteristics we found are used for the attack. We also verify
the exposure of privacy through the experiments. Lastly, we
analyze the effectiveness of our attack through the probabilistic
analysis and the experimental study.
A. Methodology
Figure 9 shows the flow of our proposed attack scenario. The
target’s phone number is required as a prerequisite for the attack;
it can be acquired easily through yellow pages, business cards,
or personal homepages 6. We then need information concerning
the target’s voice call technology. It is easy to determine through
session initiation protocol (SIP) packets whether the target
subscriber uses the VoLTE service. For example, if the target
device uses VoLTE, it sends a SIP packet for call connection.
An adversary can take one of two approaches according to the
technology. First, for the VoLTE user, an attacker can exploit
the characteristics that GUTI values persist even after the voice
call or after establishing an RRC connection. If the attacker
fails to leak the location of the victim because the GUTI is
not persistent, he/she can perform our attack, called the smart
tracking attack.
1) Location Tracking Attack on VoLTE User: In our experi-
ment, all carriers supporting VoLTE do not reallocate GUTI
after a voice call. Therefore, an adversary can perform the same
attack as that proposed in previous studies [20], [30]. First,
the adversary generates a VoLTE silent call that allows the
eNodeBs to broadcast a paging message that goes unnoticed by
the victim. In our experiments, US and KR carriers take 4 and
2 s, respectively, to ring the phone, implying that the call would
not have been noticed by the victim if it had been terminated
within these periods; yet, they can trigger a paging message.
Once the adversary makes the silent call, he/she listens to the
broadcast channel to monitor paging messages and records
all GUTIs. Considering the time needed to generate a paging
6This is the same assumption made by previous works [20], [30]
message, the possible GUTIs of the victim after one silent call
are limited to a time window within 1–2 s of the call. After
several silent calls, if one GUTI value is observed constantly
at every call, the attacker can conclude that the GUTI belongs
to the victim. Therefore, the victim is located in the same TA 7
as the adversary. Otherwise, if any GUTI appears in every
silent call, the victim is not in the TA where the attacker is
monitoring the broadcast channel.
2) Smart Tracking Attack: The attack exploiting the persis-
tence of the GUTI does not work with a CSFB call because the
GUTI of the UE changes in every voice call in most carriers.
Moreover, if the carrier adopts the solution recommended in
the literature, namely, reallocating GUTI at every voice call, the
previous attack method will be prevented as well. We consider
the case in which an adversary can predict the UE’s GUTI or
have knowledge of the carrier’s GUTI allocation pattern. As
explored in Sections IV and V, 19 carriers in our dataset have
a noticeable GUTI allocation pattern, and stress testing in four
carriers showed that GUTI is fixed.
The “smart tracking attack” involves two methods: (1) using
the fingerprinted allocation rule and (2) fixing GUTI through
the stress test. In this attack, knowledge of the victim’s carrier
is a prerequisite, as the adversary chooses different methods
according to the victim’s carrier.
Exploiting GUTI Allocation Rule: For carriers that reveal
their GUTI allocation rules (19 of 28 carriers), the attacker
uses fingerprinted information. The overall attack scenario is
similar to that of the previous attack, in which the attacker
makes several silent calls to invoke a paging message through
the broadcast channel and monitors GUTIs during the silent
call. In the attack, the attacker analyzes all candidate GUTIs for
the victim in the paging message at each silent call rather than
focusing only on the constantly monitored GUTI. The attacker
forms a set of candidate GUTIs by using the reallocation rule.
If the monitored GUTI differs from those in the set, but the
hex value at the position where the byte value is fixed by the
allocation rule is identical to that of the GUTI monitored in
the previous silent call, the attacker regards the GUTI as the
possible GUTI of the victim and leaves it in the set. Otherwise,
the attacker removes the GUTI from the set. The silent call
is made repeatedly until the number of remaining candidate
7There are some exceptions that are not TA. For example, KR-I (see
Section VI-D).
9
EXTENDED_SERVICE_REQUEST: SecurityHeaderType: 0ServiceType: 1 (mobile terminating CS fallback or 1xCS fallback)NASKeySetIdentifier: TSC: 0 (native security context)NASKeySetId: 2MTMSI:     Identity: IdentityDigit: 01: 200  = 0xC802: 22    = 0x1603: 66    = 0x4204: 93    = 0x5D(a) M-TMSI monitored by Device(b) Paging Message in Broadcast Channel (USRP)Fig. 9: Attack flow for privacy leakage
GUTIs is one.
Consider the example when the victim’s carrier is BE-II,
the GUTI allocation rule for which is “Values of the first and
second bytes in the GUTI are fixed, and that of the third byte
shows a monotonically increasing pattern.” While making the
silent call and monitoring GUTI, the attacker does not ignore
the monitored GUTIs whose values in the third and fourth
bytes differ from those of candidates GUTIs but those of the
first and second bytes are identical to those of the GUTIs in
the set. These GUTIs are still considered candidates for the
victim’s GUTI. Further, the attacker considers the pattern of
the values in the third byte and repeats the above procedure at
every silent call until the candidate set only has one GUTI.
Attack through Stress Testing: For the remaining carriers for
which we fail to reveal GUTI allocation patterns, an attack can
still succeed through stress testing (see Section V). Through
stress testing, the attacker makes the network (or MME) omit
the GUTI reallocation procedure after several voice calls and
sends a paging message with the same GUTI as that allocated
previously. In the attack, the adversary performs the first
launches stress test to cause the victim to have a persistent
GUTI when the silent call is made. Once the GUTI of the
victim is fixed, the attacker uses the same attack procedure
as that used for VoLTE users. Therefore, the adversary can
still infer mapping information between the GUTI and the
subscriber, which is an opposite result to that specified by the
relevant standard [5].
3) Cell Tracking: Once the TA where the victim is located
is found, the attacker performs an additional procedure to
find the specific cell. Unlike paging messages used to notify
voice calls that are transmitted to multiple cells in the TA,
paging messages for data service or SMS are delivered to only
the cell where the UE is located. This paging procedure is
called “smart paging” [13], [25], [30]. Moreover, all carriers in
our dataset do not reallocate the GUTI after smart paging. In
the attack, an adversary exploits the smart paging mechanism
to find the cell where the victim is located. By invoking
smart paging and monitoring the paging message, the attacker
determines whether the victim is in the same cell if the victim’s
GUTI is monitored. Note that the victim’s GUTI has already
been revealed while finding the TA; therefore, invoking smart
paging once is sufficient to leak the victim’s location. Several
methods that would go unnoticed by the victim can be used to
invoke smart paging: (1) sending a broken SMS [17] and (2)
using social messengers such as WhatsApp [43] or Facebook
Messenger [14].
B. Experiment
We implement an LTE broadcast receiver on a laptop with
a quad-core Intel CPU (i7 7500U) connected with a software-
defined radio peripheral (B210), as described in Sections IV and
V. Our proof-of-concept implementation shows (a) a location
leakage attack on a VoLTE user and (b) the same attack on a
CSFB user for two carriers that reallocate the GUTI at every
voice call. In all experiments, we locate the victim and the
attacker in the same TA, and we check whether our attack
method could successfully locate the victim.
1) Attack on VoLTE User: We first perform location tracking
attack on a VoLTE user subscribing to US-I. Note that a silent
call does not change the GUTI of the target (call recipient).
We generate a VoLTE call two times with a 6 s time gap. After
the first silent call, we record all GUTIs in the paging message.
By intersecting two sets of monitored GUTIs, one GUTI is
obtained, and we confirm that it belongs to the victim. Having
10
Obtain target information (phone number, carrier,device information (§VI)) Voice call technology?VoLTECSFBGUTI Reallocation?YesNoAnalysis of rules for ID reallocation (§IV)Find the target (Cell) (§VI) Have fixed bytes? (§IV.C)NoStress-testing (§V)YesFind the target (§VI) (Tracking Area, MME Area)Fig. 10: Paging request per second in KR-I
found the GUTI and confirmed that the victim is located in
the same TA as the attacker, we perform a broken SMS attack
and succeed in specifying the victim’s cell.
2) Experiments on Smart Tracking Attack: To show that
the deployed GUTI reallocation remains vulnerable to location
tracking attacks, we selected two carriers (US-II and KR-I),
that do not show a noticeable GUTI allocation pattern and
verify that our proposed attack works on both. We first perform
a weak stress test on KR-I to fix the GUTI value. During the
stress test, we monitor the GUTI to check for the existence of
duplicated GUTIs. At the third CSFB call, we notice that one
GUTI was constantly monitored on the paging channel; this is
the victim’s GUTI.
We used a different procedure for US-II. As observed in
Section V, US-II shows duplicate GUTIs two times during the
stress test. We perform stress testing with 30 sequential CSFB
voice calls and listen to the paging channel to check for the
existence of duplicated GUTIs. In our experiment, a GUTI
with the value 0xC25BBDAE appears at the third and fourth
silent calls consecutively. To confirm that this is the victim’s
GUTI, we perform the same procedure again and confirm the
existence of the victim in the same TA. Once GUTIs have
appeared consecutively, we stop the second stress test and
perform a cell tracking procedure by sending an SMS to the
victim. As the GUTI has not changed upon receiving the SMS,
we confirm the user’s cell by checking for the existence of the
GUTI monitored in the previous stress test.
C. Analysis of Effectiveness of Attack Method
One possible counterexample that can confuse our attack
method consists of the cases in which GUTIs that have identical
values in fixed bytes of the victim’s GUTI constantly show
up whenever we make a silent call. In this case, to locate the
victim, the attacker should make the silent call several times
until only one GUTI remains; however, it takes time to make
calls, and this increases the likelihood of failure because the
victim might move to another TA. Complicating the attack is
that the attacker does not know the exact number of silent calls
required to determine the existence of the victim in this case.
To solve this problem, we measure the number of silent calls
required to leak the victim’s location through (a) probabilistic
analysis and (b) simulation of a real environment. To reflect
a real environment, we use the recorded traffic pertaining to
paging messages and GUTI values on the paging channel of
KR-I. Figure 10 shows the observed traffic rate for paging
messages over 18 h.
1) Probabilistic analysis: First, we derive the probability of
success of the smart tracking attack according to the number
of silent call trials. We consider the case in which the GUTI
reallocation rule has a fixed number of k bytes for each user,
where k ∈ {1, 2, 3, 4}. Note that the fixed byte rule applies
to each user, and this does not mean that all bytes of a given
location in the broadcast channel are fixed. As described in