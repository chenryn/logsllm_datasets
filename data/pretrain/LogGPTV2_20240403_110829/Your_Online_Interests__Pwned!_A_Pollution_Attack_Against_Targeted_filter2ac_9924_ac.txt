each of 200 Alexa categories. We observe that the two distributions
almost completely overlap.
We create multiple copies of each user’s proﬁle to load under dif-
ferent pollution settings. The user web traces are replayed to gener-
ate proﬁles that are polluted by forwarding the request to the proﬁle
polluter after visiting the fraudulent publisher. We also create clean
proﬁles by replaying user web traces bypassing the proﬁle polluter.
To eliminate the impact from time and location on distribution of
ads, each user’s proﬁles are generated by replaying her web trace at
the same time from the same IP address. This provides a seamless
approach to measure the extent to which the pollution impacts the
type of ads targeted at the user. Thus, for every experiment pre-
sented in the following two sections, we record the ads targeted at
the user with and without proﬁle pollution.
4.2 Pollution Content
As described in Section 3.1, user proﬁles are polluted in order to
mislead the ad exchange and advertisers from more lucrative ver-
ticals to target ads at users visiting the fraudulent publisher’s web-
page. We pollute each user by generating camouﬂaged visits to
three websites from the top three most expensive display ad cate-
gories of Health, Business and Education. Beyond the top three ad
categories, we pick two additional categories of Sports and Shop-
ping to study the attack on less valuable ad categories.
Polluting for Behavioral Targeting. In order to ﬁnd websites that
alter the user’s interest proﬁle towards the above mentioned cate-
gories, we ﬁrst ﬁlter websites from the corresponding Alexa cate-
gory that contain the DoubleClick tracking script. For each web-
site in this list, we use the Google Ad Preferences Dashboard [7] to
build a map between the websites and categories that are consistent
with DoubleClick. Table 1 provides the three websites selected for
each category.
Polluting for Re-Marketing Targeting. Similar to the previous
approach, we ﬁlter websites in the Alexa category that host the re-
marketing script from DoubleClick. In addition to verifying that the
category matches, we also verify that the re-marketing campaign is
active. Table 1 lists the websites used for re-marketing pollution
for each category.
0510152025300.00.20.40.60.81.0Daily page view per visitorCDFAlexaChrome extensionTable 1: The websites we use for polluting users’ proﬁles in the ﬁve ad categories.
Google Category Alexa Category Re-marketing Pollution Contents Behavioral Pollution Contents
Health
Health
eyemagic.net
Business
Business
incorporate.com
Educaton
Reference
asuonline.asu.edu
Shopping
Shopping
teleﬂora.com
Sports
Sports
moenormangolf.com
intensemuscle.com
bimabazaar.com
allacqueredup.com
bloomberg.com/news/insurance/
bloomberg.com/news/ﬁnance/
bloomberg.com/news/industries
universando.com
campusleader.com
graphs.net
alterationsneeded.com
modernsalon.com
viloux.com
bloguin.com
retospadel.com
golftechnic.com
following, we present an overview of the main modules of the ad
crawler.
DOM Parser/Preprocessor. This module parses the DOM struc-
ture of the page and extracts speciﬁc attributes of display ads that
reveal the landing page for the ad (the website that would be vis-
ited by clicking on the ad). This is complicated by the fact that
display ads are often embedded in nested iframe tags spanning
multiple levels4. In order to bypass the same origin policy enforced
by modern web browsers we disable the web security mechanism
of the PhanromJS headless browser. The DOM Parser reads the
 (or ) attributes for image (or ﬂash) ads,
and aggregates this information for further processing.
This module also logs DoubleClick elements (re-marketing scripts
and cookies) on the page. Re-marketing scripts are detected by
searching for the unique DoubleClick JavaScript code as described
here [10]. DoubleClick cookies are detected by monitoring out-
going HTTP requests and comparing against the publicly available
patterns provided by the Ghostery [6] tracker database.
Ad Landing Page Extractor. For each identiﬁed ad element, this
infers the landing page by parsing the value of the attributes ex-
tracted by the DOM parser module and searching for speciﬁc pat-
terns in the URL like adurl=, redirect_url=, etc. We man-
ually generate these patterns for DoubleClick by inspecting the at-
tribute value. In our experiments, we found that almost 80% of the
ads have a landing page that is encoded by these patterns, while
the remaining ads require actively following HTTP redirects. We
do not follow these redirects; doing so could artiﬁcially inﬂate the
click through rates of the ad campaigns, and bias the user proﬁle
inferred by DoubleClick towards these ad categories.
Semantic Categories of the Ad URL. The landing domains of the
ads are categorized into one of the 13 top-level Alexa web cate-
gories. For each of the landing domain we collected, we queried
www.alexa.com to ﬁnd its corresponding category and assign
the ad landing domain to one or more corresponding Alexa cate-
gories5. For those landing domains with no results returned from
Alexa, we query www.similarsites.com as it provides a sim-
ilar categorizer using the Alexa taxonomy for a much larger catalog
of URLs6. Finally, if the query fails on both services, we manually
categorize the URL.
Verifying the Ad Crawler. We verify the end-to-end implementa-
tion of the ad crawler by performing the following test. We set up
our own re-marketing ad campaign on Google AdWorlds and drive
fake trafﬁc to the website using the trafﬁc emulator. During the pe-
riod that our campaign was active, we veriﬁed that the ad crawling
framework is indeed able to capture our re-marketing ads across a
wide variety of websites and the number of ad impressions closely
matched the number reported by Google AdWords.
4.5 Ad Revenue Estimation
The ﬁnal component of our setup is to estimate the ad revenue
the fraudulent publisher generates. We estimate the revenue by
using the publicly available report provided by Google that ranks
the CPM cost of different ad verticals (categories) and associates
with each vertical a relative cost index [26].
In the Google re-
port, the index for the three most expensive categories of Health,
Business and Job & Education were 257, 221 and 200 cor-
respondingly. The least expensive category was Law & Government
with an index of 46. We further manually mapped each of the 13
top-level Alexa categories to one of the ad verticals used in the
published Google report. Our revenue estimation analysis always
compares the revenue generated by the pollution attack with the
baseline revenue computed by running the exact same experiment
without pollution.
5. VALIDATION AND EFFECTIVENESS OF
THE ATTACK
In this section we evaluate the extent to which proﬁle pollution
impacts the ads by deploying the attack on the controlled publisher
webpage. The primary metric used for the evaluation is the relative
change in ads from the desired ad category (behavioral pollution)
or domain (re-marketing pollution) with and without pollution. For
both user proﬁle sets, the trace emulator ﬁrst visits every website in
a user’s trace to ensure that all users have an online interest proﬁle.
We then take one set of user proﬁles and pollute all users only once.
Subsequently, users from both sets visit the controlled publisher
page once every hour for a duration of 50 hours. For each visit to
the publisher webpage the ad crawler captures all the ads.
4In our experiments we observed up to six levels of nesting.
5We eliminate the top-level category of Regional as it provides in-
formation about the location of the URL
6We do not query this website directly as it is rate limited and re-
quires purchasing an API access
(a) Sports
(b) Reference
(c) Business
(d) Health
(e) Shopping
Figure 5: Effectiveness of pollution attacks against re-marketing ad campaigns across different ad categories.
Table 2: Fraction of total ad impressions resulting from the re-
marketing based pollution for varying number of re-marketing ad
campaigns used for pollution.
Number of Advertisers Avg.
No pollution
1
2
3
4
5
(Min, Max)
(0.68%, 3.51%)
1.86%
55.55% (22.06%, 74.07%)
61.36% (26.47%, 84.61%)
80.11% (39.71.0%, 97.40%)
82.02% (42.34%, 98.72%)
87.87% (53.29%, 100.00%)
5.1 Pollution Using Re-Marketing Campaigns
Figure 5 shows, for each pollution category, the fraction of ads
received with and without proﬁle pollution across all users. As ex-
pected, we observe that only the polluted users receive ads from the
category used in the pollution. Surprisingly, we observe that across
all categories, re-marketing ads aggressively target users, both in
terms of time between the pollution and ﬁrst ad shown, and num-
ber of ads: across all pollution categories users receive ads from
the intended advertisers immediately in the very ﬁrst visit to the
publisher’s webpage, and approximately 40–50% of all display ads
are from these advertisers. We also veriﬁed the distribution of ads
across users (not shown) and found that all the users received ads
from the re-marketing campaigns used for pollution.
Next, we characterize the extent to which the polluter can in-
crease the number of ad impressions served from the re-marketing
advertisers by varying the number of advertisers used for pollution.
Recall that the publisher website is set up with two display ads and
hence requiring at least two re-marketing scripts to ﬁll both slots.
In practice, ad exchanges receive bids from other advertisers target-
ing the user and consequently not all ad slots may be ﬁlled by the
re-marketing advertiser. Table 2 shows the fraction of re-marketing
ads delivered to the users who are polluted by increasing number
of re-marketing campaigns from one to ﬁve. We observe that with
two re-marketing campaigns, the polluter can modify an average
of 61% of ad impressions (min=26%, max=85%) and with three
campaigns the average increases to 80% (min=40%, max=97%).
Beyond three advertisers, the increase in fraction of ads delivered
from the compromised campaigns is much lower. This indicates
that the aggressive targeting performed by re-marketing campaigns
enables the polluter to control a large fraction of ads displayed to
the user.
While the pollution is highly effective once it is triggered, ad-
vertisers may set up speciﬁc rules to trigger the campaign that can
impact the publisher’s ad revenue. First, as seen in Figure 5 adver-
tisers can set up time based triggers. For example, the advertiser
moenormangolf.com from the Sports category set up the cam-
paign to only run during 8 hours of the day, causing a diurnal pat-
tern in the targeted ads. Alternately, campaigns can be set up with
frequency caps or they may be paused by the advertiser. Addition-
Figure 6: Distribution of ads across the 13 top-level Alexa cate-
gories.
ally, the advertiser may set up the campaign with a more complex
control ﬂow of user actions (e.g., went to homepage, placed things
in the cart, but never checked-out) and trigger the campaign only
when a user completes all the steps. Thus, the primary challenge in
effectively exploiting re-marketing campaigns is to select pollution
content that accounts for such speciﬁc trigger rules.
5.2 Pollution Using Behavioral Targeting Cam-
paigns
Impact on Ad Categories. We characterize how the pollution at-
tack alters the distribution of ads across the different semantic cate-
gories. Intuitively, we expect that polluting a user’s proﬁle towards
a speciﬁc category (e.g., Health) should increase the number of ads
delivered in that category. Correspondingly, since the total number
of ad slots (and ad impressions) are the same, ads delivered from
other categories should decrease. This relative change impacts the
publisher’s net revenue .
Figure 6 shows the distribution of ads across the 13 top-level
Alexa categories for user proﬁles that were not polluted. We ob-
serve that the ad distribution spans multiple categories as users have
diverse online interests. We use this baseline distribution and com-
pute the relative change in the distribution of ad categories after
pollution. Figure 7 shows the relative change in the ad categories
across users which validates the effectiveness of our pollution at-
tack – there is a clear increase in ads in the polluted category with
a maximum increase of 12% for the Shopping category. Moreover,
the pollution manages to increase the number of ads in categories
that a user already received prior to pollution. For example, the
fraction of ads in the Health category increases from 23% to 31%.
Temporal Impact. Finally, we study the temporal effect of the
pollution. Figure 8 shows the relative increase in fraction of ads
received from the category used for pollution. We observe that the
effect of the pollution is immediate and leads to an increase in ads
from the desired category. Moreover, the effect of the pollution per-
sists over the entire time duration of the experiment. This indicates
llllllllllllllllllllllllllllllllllllllllllllllllll010203040500.00.20.40.60.81.0Time (hour)Ad fractionlWithout pollutionWith pollutionllllllllllllllllllllllllllllllllllllllllllllllllll010203040500.00.20.40.60.81.0Time (hour)Ad fractionlWithout pollutionWith pollutionllllllllllllllllllllllllllllllllllllllllllllllllll010203040500.00.20.40.60.81.0Time (hour)Ad fractionlWithout pollutionWith pollutionllllllllllllllllllllllllllllllllllllllllllllllllll010203040500.00.20.40.60.81.0Time (hour)Ad fractionlWithout pollutionWith pollutionllllllllllllllllllllllllllllllllllllllllllllllllll010203040500.00.20.40.60.81.0Time (hour)Ad fractionlWithout pollutionWith pollutionArtsBusinessComputersGamesHealthHomeKids-TeensRecreationReferenceScienceShoppingSocietySports0.000.050.100.150.200.25Distribution of ads(a) Sports
(b) Reference
(c) Business
(d) Health
(e) Shopping
Figure 7: Change in the distribution of ads.
(a) Sports
(b) Reference
(c) Business
(d) Health
(e) Shopping
Figure 8: Percentage increase in ads (pollution - no pollution) from the polluted category.
Figure 9: Average indexed CPM across the top 5 and bottom 5
selected websites before and after pollution.
that categories introduced artiﬁcially as an effect of the pollution
have a lasting inﬂuence on the ads received by the user.
Summary of behavioral pollution. The results above indicate that
our approach for behavioral pollution does indeed impact the ads
targeted at the user while the effectiveness of the pollution depends
on many factors like the user’s existing proﬁle, context of the pub-