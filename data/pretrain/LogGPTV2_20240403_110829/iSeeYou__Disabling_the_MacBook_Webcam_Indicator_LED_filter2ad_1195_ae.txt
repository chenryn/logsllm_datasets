https://research.microsoft.com/
pubs/131132/devices-camera-ready.
pdf.
[28] iFixit.
MacBook Pro Retina Display tear-
down. 2013. Online: http://www.ifixit.
com/Teardown/MacBook+Pro+Retina+
Display+Teardown/9493.
[29] Samson Technologies Inc. Meteor Mic - USB
Studio Microphone. 2013. Online: http://www.
samsontech.com/samson/products/
microphones/usb-microphones/
meteormic/.
[30] David Kennedy and Josh Kelley.
PowerShell
omfg. . . .
Presented at DefCon 18, August
2010. Online: http://www.youtube.com/
watch?v=eWoAGxh0a_Q.
[31] Jinyung Kim, Yongho Yoon, Kwangkeun Yi, and
Junbum Shin. ScanDal: Stack analyzer for de-
tecting privacy leaks in android applications.
In
Hao Chen and Larry Koved, editors, Proceed-
ings of MOST 2013. IEEE Computer Society, May
2013. Online: http://www.mostconf.org/
2012/papers/26.pdf.
[32] Nicholas S. Kovach. Accelerating malware detec-
tion via a graphics processing unit. Master’s thesis,
Air Force Institute of Technology, September 2010.
[33] Evangelos Ladakis, Lazaros Koromilas, Giorgos
Vasiliadis, Michalis Polychronakis, and Sotiris Ioan-
nidis. You can type, but you can’t hide: A stealthy
GPU-based keylogger.
In Thorsten Holz and
Sotiris Ioannidis, editors, Proceedings of EuroSec
2013. ACM, April 2013. Online: http://www.
cs.columbia.edu/~mikepo/papers/
gpukeylogger.eurosec13.pdf.
[34] Luxland, Inc. Detect and recognize faces with
2013. Online: http://
Luxand FaceSDK.
luxand.com/facesdk/index_c.php. Last
accessed: 2013-08-06.
[35] Mactaris. Webcam Settings 2.0 will support
FaceTime HD camera on MacBook Air 2013. July
2013. Online: http://mactaris.blogspot.
com/2013/07/webcam-settings-20-
will-support.html.
[36] Philip Marquardt, Arunabh Verma, Henry Carter,
and Patrick Traynor.
(sp)iPhone: Decoding
vibrations from nearby keyboards using mo-
bile phone accelerometers.
In George Danezis
and Vitaly Shmatikov, editors, Proceedings of
CCS 2011. ACM Press, October 2011. Online:
http://www.cc.gatech.edu/~traynor/
papers/traynor-ccs11.pdf.
[37] 1/6-Inch SOC VGA CMOS Digital Image Sensor:
MT9V11212ASTC. Micron Technology, Inc., 2005.
Online:
http://download.micron.com/
pdf/datasheets/imaging/MT9V112.
pdf.
[38] Charlie Miller. Owning the fanboys: Hacking
Mac OS X. Presented at Black Hat Japan Brief-
ings, October 2008. Online: https://www.
blackhat.com/presentations/bh-jp-
08/bh-jp-08-Miller/BlackHat-Japan-
08-Miller-Hacking-OSX.pdf.
USENIX Association  
23rd USENIX Security Symposium  349
13
[39] Charlie Miller. Battery ﬁrmware hacking:
In-
side the innards of a smart battery. Presented
at Black Hat Brieﬁngs, August 2011. Online:
http://media.blackhat.com/bh-us-
11/Miller/BH_US_11_Miller_Battery_
Firmware_Public_WP.pdf.
[40] Emiliano Miluzzo, Alexander Varshavsky, Suhrid
Balakrishnan, and Romit Roy Choudhury. Tap-
Prints: Your ﬁnger taps have ﬁngerprints.
In
Srinivasan Seshan and Lin Zhong, editors, Pro-
ceedings of MobiSys 2012. ACM Press, June
2012.
Online: http://synrg.ee.duke.
edu/papers/tapprints-final.pdf.
[41] HD Moore. A penetration tester’s guide to IPMI
July 2013. Online: https://
and BMCs.
community.rapid7.com/community/
metasploit/blog/2013/07/02/a-
penetration-testers-guide-to-ipmi.
[42] Martha T. Moore. Pa. school district’s webcam
surveillance focus of suit. USA Today, May 2010.
Online:
http://usatoday30.usatoday.
com/tech/news/surveillance/2010-
05-02-school-spy_N.htm.
[43] Andy O’Donnell. How to secure your webcam
in less than 2 seconds. March 2011. Online:
http://netsecurity.about.com/b/
2011/03/25/how-to-secure-your-
webcam-in-less-than-2-seconds.htm.
[44] Devon O’Neil. Reﬂecting on Tony Hawk’s 900.
ESPN, May 2014. Online: http://xgames.
espn.go.com/events/2014/austin/
article/10622648/twenty-years-20-
firsts-tony-hawk-900.
[45] Oracle VM VirtualBox R(cid:31). Oracle Corporation,
2013. Online: http://www.virtualbox.
org/manual/.
[46] Emmanuel Owusu, Jun Han, Sauvik Das, Adrian
Perrig, and Joy Zhang. ACCessory: Password in-
ference using accelerometers on smartphones. In
Rajesh Krishna Balan, editor, Proceedings of Hot-
Mobile 2012. ACM Press, February 2012. On-
line: http://www.hotmobile.org/2012/
papers/HotMobile12-final42.pdf.
[47] Phisher Cat. Webcam light scaring slaves. . . .
July 2013. Online: http://www.hackforums.
net/showthread.php?tid=3660650. Reg-
istration required. Last accessed 2013-08-06.
July 2010.
at BlackHat Brieﬁngs,
https://media.blackhat.com/bh-us-
10/presentations/Rushing/BlackHat-
USA-2010-Rushing-USB-HID-slides.
pdf.
Online:
[49] Sam Prell. Watch the Spelunky run that set a new
high score record. joystiq, February 2014. Online:
http://www.joystiq.com/2014/02/23/
watch-the-spelunky-run-that-set-
a-new-high-score-record/.
[50] Reinhard Riedmüller, Mark M. Seeger, Harald
Baier, Christoph Busch, and Stephen D. Wolthusen.
Constraints on autonomous use of standard GPU
components for asynchronous observations and
intrustion detection.
In Anna Brunstrom and
Svein J. Knapskog, editors, Proceedings of IWSCN
2010. IEEE Computer Society, May 2010. Online:
http://ieeexplore.ieee.org/xpl/
freeabs_all.jsp?arnumber=5497999.
[51] Thomas Ristenpart, Gabriel Maganis, Arvind
Krishnamurthy, and Tadayoshi Kohno. Privacy-
preserving location tracking of lost or stolen devices:
Cryptographic techniques and replacing trusted
third parties with DHTs.
In Paul Van Oorschot,
editor, Proceedings of USENIX Security 2008.
USENIX, July 2008. Online: http://adeona.
cs.washington.edu/papers/adeona-
usenixsecurity08.pdf.
[52] Thomas Ristenpart, Gabriel Maganis, Arvind Kr-
ishnamurthy, and Tadayoshi Kohno. Adeona.
October 2009. Online: http://adeona.cs.
washington.edu/index.html.
[53] Sebastian Rohde, Thomas Eisenbarth, Erik Dahmen,
Johannes Buchmann, and Christof Paar. Fast hash-
based signatures on constrained devices. In Gilles
Grimaud and Frano¸is Xavier Standaert, editors,
Proceedings of CARDIS 2008. Springer, September
2008. Online: https://www.hgi.rub.de/
hgi/publikationen/fast-hash-based-
signatures-constrained-devices/.
[54] Roman Schlegel, Kehuan Zhang, Xiaoyong Zhou,
Mehool Intwala, Apu Kapadia, and XiaoFeng Wang.
Soundcomber: A stealthy and context-aware sound
trojan for smartphones.
In Adrian Perrig, editor,
Proceedings of NDSS 2011. Internet Society, Febru-
ary 2011. Online: http://www.cs.indiana.
edu/~kapadia/papers/soundcomber-
ndss11.pdf.
[48] Jason Pisani, Paul Carugati, and Richard Rushing.
Presented
USB-HID hacker interface design.
[55] Stop Police Brutality. Cop breaks 84 year old’s
neck for touching him. December 2013. Online:
350  23rd USENIX Security Symposium 
USENIX Association
14
http://www.policebrutality.info/
2013/12/cop-breaks-84-year-olds-
neck-for-touching-him.html.
[56] Robert Templeman, Zahid Rahman, David Crandall,
PlaceRaider: Virtual theft
and Apu Kapadia.
in physical spaces with smartphones.
In Peng
Ning, editor, Proceedings of NDSS 2013. Internet
Society, February 2013. Online: http://www.
internetsociety.org/sites/default/
files/02_2_0.pdf.
[57] Alexander Tereshkin and Rafal Wojtczuk.
Intro-
ducing ring −3 rootkits. Presented at Black Hat
Brieﬁngs, July 2009. Online: http://www.
blackhat.com/presentations/bh-usa-
09/TERESHKIN/BHUSA09-Tereshkin-
Ring3Rootkit-SLIDES.pdf.
[58] The iPatch. The iPatch. 2011. Online: http://
www.theipatch.com. Last accessed: 2013-08-
07.
[59] Craig Timberg and Ellen Nakashima.
FBI’s
search for ‘Mo,’ suspect in bomb threats, high-
The
lights use of malware for surveillance.
Washington Post, December 2013.
Online:
http://www.washingtonpost.com/
business/technology/fbis-search-
for-mo-suspect-in-bomb-threats-
highlights-use-of-malware-for-
surveillance/2013/12/06/352ba174-
5397-11e3-9e2c-e1d01116fd98_story.
html.
[60] Giorgos Vasiliadis, Michalis Polychronakis, and
Sotiris Ioannidis. GPU-assisted malware.
In
Jean-Yves Marion, Noam Rathaus, and Cliff
Zhou, editors, Proceedings of MALWARE 2010,
IEEE Computer Society, October
pages 1–6.
2010.
Online: http://dcs.ics.forth.
gr/Activities/papers/gpumalware.
malware10.pdf.
[61] Vimicro.
VC0358 USB 2.0 Camera Proces-
sor, September 2012. Online: http://www.
vimicro.com/english/product/pdf/
Vimicro_VC0358_PB_V1.1.pdf.
[62] Zhaohui Wang and Angelos Stavrou. Exploiting
smart-phone USB connectivity for fun and proﬁt.
In Patrick Traynor and Kevin Butler, editors, Pro-
ceedings of ACSAC 2010, pages 357–366. ACM
Press, December 2010. Online: http://dl.acm.
org/citation.cfm?id=1920314.
[63] Richard Wheatsone.
Video: CCTV footage
shows the moment masked armed robber holds
terriﬁed shopkeeper’s head.
Mirror,
gun at
February 2014. Online: http://www.mirror.
co.uk/news/uk-news/urmston-armed-
robbery-cctv-footage-3149475.
[64] ZTech.
QuickCam Pro 9000 LED Control.
Post on the Logitech Forums, February 2008.
Online:
http://forums.logitech.com/
t5/Webcams/QuickCam-Pro-9000-LED-
Control/td-p/186301.
2013-08-06.
Last accessed:
A Virtual machine escape
The reprogramability of the iSight ﬁrmware can be ex-
ploited to effect a virtual machine escape whereby mal-
ware running in a guest operating system is able to escape
the conﬁnes of the virtual machine and inﬂuence the host
operating system.
One method is to reprogram the iSight from inside the
virtual machine to act as a USB Human Interface Device
(HID) such as a mouse or keyboard. Once the iSight
reenumerates, it would send mouse movements and clicks
or key presses which the host operating system would
then interpret as actions from the user.
To demonstrate the feasibility of a virtual machine es-
cape from a VirtualBox virtual machine, we implemented
a USB HID keyboard which, once loaded, performs the
following actions in order:
1. send a “host key” press;
2. send command-space to open Spotlight;
3. send the key presses for “Terminal.app” one at a
time;
4. wait a few seconds, send a return key press, and wait
a few more seconds for the Terminal to open;
5. send the key presses for a shell command followed
by a return key press;
6. disconnect from the USB bus and modify its USB
device descriptor to use the product ID 0x8300 —
the PID for the iSight in its unprogrammed state; and
7. reenumerate.
The VirtualBox host key, which defaults to the left com-
mand key on a Mac host, releases keyboard ownership,
causing the rest of the key presses to go to the host operat-
ing system rather than to the guest operating system [45,
Chapter 1].
Figure 4 shows an iSight that has been reprogrammed
from inside a VirtualBox virtual machine sending key
presses to Spotlight, instructing it to open Terminal.app.
When a new keyboard is ﬁrst plugged into the com-
puter, the Keyboard Setup Assistant asks the user to press
several keys in order to determine the keyboard layout.
This behavior appears to be controlled by the vendor ID,
product ID, and device release number. By using the ap-
propriate values for an Apple USB keyboard, the assistant
USENIX Association  
23rd USENIX Security Symposium  351
15
352  23rd USENIX Security Symposium 
USENIX Association
Figure4:Virtualmachineescape.TheiSighthasbeenreprogrammedtoactasaUSBkeyboardfrominsideaVirtualBoxvirtualmachineanditissendingkeypressestothehostoperatingsystem.Itisinthemiddleofentering“Terminal.app”intoSpotlight.doesnotappearandthereisnovisualindicationthattheoperatingsystembelievesanewkeyboardhasconnected.TheshellcommandenteredintotheTerminalisuncon-strainedandcould,forexample,usecurltodownloadarbitrary,newcodeandrunit.AftertheiSighthasﬁnishedtypingcommands,itreenu-meratesasanunprogrammediSightwhichcausestheAppleUSBVideoSupportdrivertoreprogramitwiththelegitimateiSightﬁrmware,removingevidencethattheiSightwastheinfectionvector.AlthoughweusetheiSighttoescapefromthevirtualmachine,intheory,anyEZ-USBdevicewhichisaccessi-blefrominsidethevirtualmachinecanbereprogrammedtobehaveasaHIDkeyboard.TheonemajorlimitationisthattheUSBdevicemustbeconnectedtovirtualmachinebeforetheattackispossible.Bydefault,virtualmachinemonitorsdonotprovidethisconnectionformostdevicesandthusmalwarewouldneedtocoercetheuserintoestablishingtheconnection.Evenwiththedeviceconnectedtothevirtualmachine,thereisnofeedbacktotheﬁrmwarethattheattackisproceedingasplanned.AllitcandoissendkeypressesinresponsetheUSBpolling.Iftheuserissittinginfrontofthecomputer,thekeypressessentbytheiSightmaybeapparentandtheusercaninterferebyperforminganactionsuchastypingorclickingthemouse.OnewaytopartiallycompensateistodecreasetheUSBpollingintervalbychangingtheUSBendpointdescriptorsintheﬁrmwareallowingtheiSighttosendkeypressesmorequickly.Eachoperatingsystemhasitsownpolicywhichgov-ernsaprocess’sabilitytosendUSBdevicerequests.OnLinux,thisiscontrolledbyudev.InFigure4,weusedsudoinsidethevirtualmachinetobypasstheaccesscon-trolsoftheguestoperatingsystem.Alternatively,theappropriatepermissionscouldbegrantedtotheuser.Oneofthesestepsisrequiredeventhoughthehostoperatingsystem,OSX,imposesnorestrictionsontheuseofUSBdevicerequests.Sinceeachguestoperatingsystemcon-trolsaccesstotheUSBdeviceonceithasbeenconnectedtothevirtualmachine,toperformanescape,malwaremustﬁrstacquiresufﬁcientprivilegesintheguestop-eratingsystemtoreprogramthecamera—apotentiallynontrivialfeat.16