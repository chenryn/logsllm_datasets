### 创建接收器上的冲突

当Di或Dj的SINR（信号干扰噪声比）低于其所需数据速率的阈值时，两者之间会产生冲突。因此，Di的冲突程度是指在考虑这种方式时与Di冲突的链路请求数量。

### 链路请求的可接纳性判断

为了确定候选无线链路Li在存在同一信道上已调度链路L的情况下是否可以被接纳，调度器计算L' = L ∪ {Li}中每个Lk的SINRk,L'，如下所示：

\[ \text{SINR}_{k,L'} = \frac{S_k}{N + \sum_{j: L_j \in L' \setminus \{L_k\}} I_{jk}} \]

其中，符号与公式(2)中的相同。如果每个SINRk,L'满足相应的数据速率要求，则可以在该信道上调度Li。这考虑了多条链路累积的干扰，并确保已调度的链路可以同时活跃而不会发生冲突。

### 基于冲突度的贪心调度

为了最小化作业完成时间，调度问题可以映射为一个传统的图着色问题，目标是使用最少的颜色来着色所有节点。在我们的案例中，颜色对应60 GHz频率信道和时间槽。我们采用图着色文献[19]中的技术，以贪心的方式按冲突度顺序调度机架级请求。未调度请求Di的冲突度di定义为其他未调度请求集合DC的数量，使得如果Di和DC中的任何请求在同一信道上，至少有一个不能达到所需的数据速率。

### 调度中的链路抢占问题

在调度器中存在链路抢占的问题。对于提供次优链路利用率的长寿命链路，调度器是否应该抢占它们，即暂停它们，以便调度竞争链路？在非抢占模型中，调度器保持未完成链路不变，检查哪些新链路可以添加。这种策略确保已调度链路在完成之前不会受到干扰，从而通过中断正在进行的链路传输来最小化天线旋转延迟和控制开销。在抢占模型中，调度器暂停正在进行的链路，将其视为具有剩余未发送流量的新请求，并与新的链路请求一起进行调度。由于先前的链路请求必须与新请求竞争，这种策略可能导致对正在进行的活动链路的中断。然而，好处是可以增加并发活跃链路的数量。尽管我们在第5节中评估了这两种策略，但默认调度器是非抢占式的。

我们注意到，可以向调度器添加更复杂的策略，例如基于截止日期的数据中心[43]中优先处理任务的替代排名指标。在这种基于优先级的调度策略中，需要注意避免链路饥饿，通过逐渐增加等待时间较长的任务的优先级。我们将这些基于指标的调度器设计作为未来的工作。

### 无线电分配给链路

为了最小化天线旋转开销，调度器在调度过程中将已调度链路分配给未分配的无线电。它应用了一个简单的策略：首先，如果机架上的空闲无线电已经指向所需的接收机架，调度器将链路分配给这个无线电；其次，如果存在多个候选/空闲无线电，调度器会检查这些天线的现有方向，并选择最接近新链路目的地角度的一个。

### 解决流量热点问题

在本节中，我们使用网络仿真来量化3D波束成形在数据中心环境中提供额外带宽的能力及其相对于2D波束成形的优势。我们考虑了使用无线链路覆盖现有有线网络上的流量热点的情况。具体来说，我们试图回答三个关键问题：
1. 在现有有线网络上添加3D波束成形链路是否会显著增加热点可用带宽？
2. 3D波束成形相对于2D波束成形的优势有多大，这些优势在哪些地方最为明显？
3. 当前旋转器的天线旋转延迟是否会成为3D波束成形的性能瓶颈？

虽然我们使用合成流量跟踪的结果来回答这些问题，但我们希望我们的研究结果能够为3D波束成形系统的实际部署提供有用的指导方针。

### 仿真设置

对于流量热点仿真，我们使用第3.2节中描述的数据中心和无线电配置。它由250个机架和总共5000台服务器组成。天线与天花板之间的距离（h）为2米。我们使用60GHz无线电，发射功率为10dBm，天线角为10°。有三个宽度为2.16GHz的信道，每个无线电一次只能在一个信道上工作。根据IEEE 802.11ad标准的规定，我们推导出数据速率。对于这个数据中心规模，每一对机架都可以通过3D波束成形形成一条单跳链路，速率达到5+Gbps。

每个机架顶部有8个无线电。为了考虑旋转延迟，我们假设每个天线使用FLIR[4]的旋转器。平移速度为300°/秒，倾斜速度为60°/秒。我们还研究了旋转瞬间完成的情况，这代表了3D波束成形链路的最佳性能。

### 流量生成

现有的跟踪记录[15, 16, 23, 25]没有将数据源映射到机架位置。因此，我们使用基于流行工作负载[18]生成的合成流量来产生热点。我们模拟了一个简单场景，其中数据中心内的400台服务器各自向200台其他服务器发送固定数据负载。这400台服务器从数据中心的任意机架中随机选择。每个数据负载为128MBytes，每个400个发射机选择一组200台服务器来接收其数据。我们称每个服务器向其200个目的地发送单个负载的完整周期为一个轮次。

为了产生受控的流量热点，我们在服务器选择中引入了一点偏差。这可能模拟了基于某些属性（如计算能力、正常运行时间、内存大小或网络接近存储服务器的距离）对某些机器的轻微偏好。我们在数据中心中随机选择50台服务器作为“首选”服务器。在每个轮次中，每个400个发射机选择200个接收机来接收其数据，随机但带有小偏差。在选择每个200个接收机时，有10%的概率该接收机是50个首选服务器之一。一旦为每个400个发射机选择了200个唯一的接收机，我们根据服务器位置聚合这些服务器对的流量负载，以产生机架级别的流量需求。我们重复上述过程生成10轮机架级别的工作负载。

我们假设底层有线网络提供的网络双切带宽为1Gbps。我们还探索了更大的值，范围从2到6Gbps，这是当今数据中心过载订阅的典型情况[14]。由于我们的目标是了解3D波束成形如何解决流量热点问题，出现的一个问题是流量需求如何在有线和无线网络链路之间分配。我们不提倡任何特定的分配策略，而是假设通过为有线链路设置固定的“截止时间”来完成其部分传输，从而使流量在两个网络之间分配。这允许我们先验地定义通过有线网络发送的流量部分，从而得出分配给60 GHz网络的“溢出”流量。为了计算作业完成时间，我们假设有线和无线链路并行发送数据。

### 添加2D/3D波束成形的影响

2D链路的覆盖范围。2D波束成形的主要限制之一是潜在的阻挡问题，导致信号强度降低和数据吞吐量损失。以前的提议将2D波束成形链路限制为连接没有潜在阻挡问题的相邻机架。我们的第一个实验考虑了可以通过2D链路发送的总溢出流量的比例，其中溢出流量是无法在指定截止时间内通过有线网络发送的流量。图8(a)显示了这一比例，即通过2D链路发送的相邻链接的总流量与总溢出流量的比率。在所有图表中，我们绘制了覆盖90%置信区间的误差条。

无论有多少流量通过有线网络发送，使用2D链路只能解决不到3%的溢出流量。我们注意到，这一数字可能会因数据中心管理员如何安排作业以增加机架亲和力并将热点限制在相邻机架而有所增加，但这会为作业调度引入额外的约束。请注意，我们没有为3D链路绘制类似的数值，因为在我们的场景中，3D链路可以通过单跳连接所有可能的机架对，因此覆盖率是100%。

天线旋转延迟的影响。接下来，我们查看3D性能，并尝试理解天线旋转延迟对端到端延迟的影响。在图8(b)中，我们绘制了无线完成时间，即通过3D链路发送溢出流量所需的时间，与有线完成截止时间的关系。有线截止时间越长，意味着更多流量将通过有线网络，留下的溢出流量就越少。我们还绘制了“y = x”线，以显示如果我们使用理想的有线和无线流量分配，完成传输所需的最短时间。通过绘制带旋转延迟和不带旋转延迟的3D链路，我们看到在现实系统中所有传输都在9秒内完成，但如果完全消除天线旋转延迟，可以改进到8秒。这是在完美无线电分配情况下我们可以实现的有效上限，表明天线旋转延迟只是端到端性能的一个小组成部分。

总完成时间。接下来，在图8(c)中，我们绘制了有效完成时间（如果在最优流量分配下有线和无线网络同时传输），针对不同轮次的仿真，假设有线网络的双切带宽为1Gbps。无论最大流的大小如何，3D无线通常能够将总传输时间减少一半。由于2D链路只能解决一小部分溢出流量，其对完成时间的影响有限。

接下来，我们提出一个问题：“对于具有更高双切带宽的有线网络，3D波束成形链路是否会变得不那么有用？” 我们将在有线网络的基本双切带宽从1 Gbps变化到6 Gbps之间，并在每种情况下，计算如果我们在有线和无线网络之间执行理想流量分配时的最小完成时间。图9显示，即使有线网络的双切带宽增加，添加3D波束成形仍然可以显著减少总传输时间（从超过50%到略低于40%，有线带宽从1 Gbps到6 Gbps）。这并不令人惊讶。由于在我们的热点场景中需求是固定的，具有更大双切带宽的有线网络消耗更多流量，留给60 GHz链路的溢出流量就更少。

### 调度器策略的影响

我们现在评估调度器中不同设计选择的净影响。

抢占与非抢占
我们在第4节中讨论了抢占现有链路的问题。为了了解哪种策略更可取，我们比较了在上述相同工作负载下应用这两种策略的作业完成时间。非抢占式是我们先前实验中使用的默认策略，一旦链路被调度，它就会一直使用无线电直到完成。抢占式策略在调度请求时考虑机架上的所有无线电，并且在调度器认为合适的情况下，会暂停现有链路，将其无线电分配给优先级更高的链路请求。我们在图10(a)中绘制了无线流量负载的完成时间。结果符合预期。非抢占式策略相比抢占式策略最多减少了25%的完成时间。这是因为重新调度暂停的链路会引入显著的额外开销（更多的天线旋转），从而降低了整体效率。

智能无线电分配
最后，我们评估在链路调度过程中使用智能无线电分配的影响。图10(b)绘制了默认调度器（包括智能无线电分配）和基本调度器（使用随机选择来选择可用无线电）的无线流量负载完成时间。两种调度器都不使用链路抢占。

结果因无线网络上的流量负载而异。当大部分流量通过有线网络发送时，只有最强的热点留给无线网络。在这种情况下，少数几个机架上的无线电将会有高争用，而在无线电分配方面几乎没有选择。因此，优化带来的收益较小。当较大比例的流量通过无线网络发送时，优化的效果更为显著。

### 结论

通过上述分析，我们展示了3D波束成形在数据中心环境中的优势，并探讨了不同调度策略对性能的影响。这些结果为实际部署提供了有价值的见解。