218 > 9年双11：互联网技术超级工程
业务身份确定后就要进行业务定义，这其中就涉及管理域和运行域分离的问题。
管理域就是指对业务生命周期、业务身份、业务对象进行定义，包括业务流程、业务
管理等。这些操作完成之后就会将配置文件下发到，运行域上的各种平台就会自动解
析配置域所下发的配置文件，然后将配置文件解析成业务命令来执行。
在上面所讲的业务域中，一个核心的问题就是如何定义业务：核心三要素是业务
身份、业务叠加关系、冲突决策，即基于业务协议标准定义业务，执行单元按协议执
行业务逻辑。
在业务叠加关系中，业务的复杂度就在于业务规则在不同维度下产生的冲突。业
务的复杂度可以分为两个维度，一个是横向维度，一个是垂直维度。
垂直维度，也可称之为“行业”。往往一个特定的“业务对象”（如商品），在静
态期就能确认其具体归属于哪个行业。行业与行业之间的业务规则是不会有叠加的。
比如，付款超时时间，各可以都设置为1天超时。但“天猫汽车”把超时时间改了，
一定不会联动改其他业务的超时设置。横向维度，也称为产品维度，特点有：产品是
可以被多个垂直业务所使用的、一个垂直业务是可以使用多个产品的、产品是否生效
是需要结合业务会话的。比如，“电子凭证”是否生效，要看用户是否选择了“电子
凭证”的交付方式。
通过业务复杂度的分析，可以得出一个结论是：一次业务会话完整的规则=1个
垂直业务规则集合+ N个水平业务规则集。所以在做业务定义和管理的时候，具体就
新基础  9年双11：互联网技术超级工程
户管理，不同的业务系统之间可以通过租户完全隔离的。不同的租户有自己的数据空
间，以及配置推送策略。
在实际应用中，基于TMF2.0交易平台改造效果具体如下：
业务需求平均开发周期缩短至12天。比如汽车4S服务中，在老系统上做了
●
一个月（未完成），新系统7天完成；五道口业务中，在老系统中评估工作量两
个月，新系统12个工作日完成；饿了么业务中，老系统评估要两周，基于新
系统2天完成。
平台与业务解耦。目前已完成的业务，其业务定制均只存在于业务包；在平台
●
未改动情况下，业务方的发布更加灵活（有多次单业务发布，不需要其他业务
方进行回归的案例）。
业务资产库。积累形成了50+业务资产库，新业务可快速进行快速复制、调整
●
并发布。
新体验
一天造出 10 亿个淘宝首页，阿里工程师如何实现？
灵培
阿里妹导读：双十一手淘首页个性化场景是推荐生态链路中最大的场景之一，在
手淘APP承载了整体页面的流量第一入口，对用户流量的整体承接、分发、调控，
以及用户兴趣的深度探索与发现上起着至关重要的作用。
双11手淘首页的几个重要推荐场景截图如下：
如上图所示，左一场景为AIO综合会场，包括AIO日常场景（淘抢购、有好货、
清单等）、双11人群会场及行业会场；中间为AIOplus场景卡片综合会场，包括5
张会场卡片，每张卡片融入了行业主分会场、标签会场，该业务涉及到20多个日常
业务以及标签、行业会场的分发；右三为主会场入口所见所得，用两个素材轮播的方
式给双11主会场进行引流。双十一当天整体点击UV引流效果方面，首页给各会场
222 > 9年双11：互联网技术超级工程
还是取得了很好的分发效果，数据达到数千万UV以上。
与此同时，今年双十一在推荐的去重打散及探索发现上做了很多深度的优化，过
去更多的是在相似性推荐的单一数据目标上进行优化，今年在match及rank技术上
采用了更多多阶游走及探索发现的embedding技术，力争在ctr效果有一定保证的
情况下，加大对用户体验比如多样性、搭配潜在兴趣、深度用户偏好等方面的推荐。
举个简单例子，之前的推荐系统在捕捉到用户对茶杯这一商品感兴趣后，很可能
会推出更多的相似茶杯，新的推荐系统在多阶召回技术的基础上通过对用户兴趣进行
深度学习的挖掘，会按一定的概率推荐茶叶、茶具等"弱相似"但满足用户搭配潜在
兴趣的商品。
究竟阿里如何使用AI构建淘宝首页？今天一起来揭秘。
一、业务技术简介
首页个性化在算法技术上主要涉及Graph Embedding召回模型、Deep-
Cross&ResNet实时网络排序模型，并在搜索工程Porsche&Blink、Rank Ser-
vice、Basic Engine等系统的基础上结合业务应用的需求沉淀了Graph Embedding
召回框架及XTensorflow排序模型平台供推荐其他场景使用，提升效果均达到两位
数以上。
二、首页个性化推荐框架（包括 MATCH 召回和 RANK 排序两
部分）
1.万物皆向量——Graph Embedding深度召回框架
在推荐系统的发展历程中，面临了两个核心问题，用户的长尾覆盖度以及新商品
的冷启动，这两个维度的数据扩展性瓶颈一直以来对广大推荐算法工程师都是不小的
挑战。而我们基于Graph Embedding的理论知识提出的相关创新框架在召回阶段利
用用户的序列化点击行为构建全网行为graph，并结合深度速随机游走技术对用户行
为进行"虚拟采样"拟合出多阶（一般5以上）的潜在兴趣信息，扩大用户的长尾兴
趣宝贝召回，并同时利用side information-based的深度网络进行知识泛化学习，
新体验  9年双11：互联网技术超级工程
①构建同构网络，从网络中的每个节点开始分别进行Random Walk采样，得
到局部相关联的训练数据； ②对采样数据进行SkipGram训练，将离散的网络节点表
示成向量化，最大化节点共现，使用Hierarchical Softmax来做超大规模分类的分
类器；
DeepWalk框架：
●
新体验  9年双11：互联网技术超级工程
Side-information
●
下面我们对演化的过程进行介绍：
（1）Naive版本
将Graph Embedding应用到商品推荐领域中，第一步要解决的就是构建网
●
络，由于商品推荐的整个网络是大规模的异构网络，网络节点类型包括用户、
商品、商品类别、用户画像等各种基础属性，不同类型的节点无法在统一的空
间进行向量表示。为了简化问题，首先使用阿里原创算法swing来计算商品间
的相似度（swing利用user-item二部图计算i2i，比改进过的CF算法仍有
明显提升，目前已在各场景中已经广泛应用，构建关于商品的有向带权图同构
网络；
第二步是对商品网络进行Random Walk采样，此处我们借鉴了《Node-
●
2vec: Scalable Feature Learning for Networks》中灵活的BFS and DFS
search strategies（在采样时以一定的几率回溯），通过改变控制参数灵活的
控制Random Walk游走过程，在Item Graph的局部稳定性和全局扩展性间
做出权衡，调节match结果中多样性和准确性之间的balance。