title:Third-Party Identity Management Usage on the Web
author:Anna Vapen and
Niklas Carlsson and
Anirban Mahanti and
Nahid Shahmehri
Third-Party Identity Management
Usage on the Web
Anna Vapen1, Niklas Carlsson1, Anirban Mahanti2, and Nahid Shahmehri1
1 Link¨oping University, Link¨oping, Sweden
2 NICTA, Sydney, NSW, Australia
Abstract. Many websites utilize third-party identity management ser-
vices to simplify access to their services. Given the privacy and se-
curity implications for end users, an important question is how web-
sites select their third-party identity providers and how this impacts the
characteristics of the emerging identity management landscape seen by
the users. In this paper we ﬁrst present a novel Selenium-based data
collection methodology that identiﬁes and captures the identity man-
agement relationships between sites and the intrinsic characteristics of
the websites that form these relationships. Second, we present the ﬁrst
large-scale characterization of the third-party identity management land-
scape and the relationships that makes up this emerging landscape. As
a reference point, we compare and contrast our observations with the
somewhat more understood third-party content provider landscape. In-
teresting ﬁndings include a much higher skew towards websites selecting
popular identity provider sites than is observed among content providers,
with sites being more likely to form identity management relationships
that have similar cultural, geographic, and general site focus. These ﬁnd-
ings are both positive and negative. For example, the high skew in usage
places greater responsibility on fewer organizations that are responsible
for the increased information leakage cost associated with highly aggre-
gated personal information, but also reduces the user’s control of the
access to this information.
1
Introduction
With an increasing demand for personalized services, many websites ask their
users to create personal user accounts and authenticate themselves before ser-
vice. To simplify account creation and increase personalization opportunities,
many sites use third-party identity management services. These services allow a
user’s digital identity and some personal information to be shared across mul-
tiple distinct sites; however, they also come with their own reliability, privacy,
and security concerns [9, 13].
Third-party identity management providers typically oﬀer simpliﬁed authen-
tication, using a single-sign-on (SSO) [13] service. In a typical authentication
scenario, the browser of a user wanting to use such identity service interacts
with two additional parties: a relying party (RP) and an identity provider (IDP).
M. Faloutsos and A. Kuzmanovic (Eds.): PAM 2014, LNCS 8362, pp. 151–162, 2014.
c(cid:2) Springer International Publishing Switzerland 2014
152
A. Vapen et al.
Fig. 1. Huﬃngton Post login example
Fig. 2. Methodology overview
An RP such as Yahoo can oﬀer that users use their account with a third-party
IDP such as Facebook or Google, to login to Yahoo and access its services.
In this case, the selected IDP, say Facebook, would provide the authentication
service and the user would only need to remember their digital identity with
Facebook to access Yahoo. More formally, we say that two sites have an RP-IDP
relationship, if the user log in to one of the sites (the RP) using the other site
(the IDP). Figure 1 illustrates a more complex scenario. The Huﬃngton Post
site allows local login as well as authentication at multiple trusted third-party
IDPs, including both Facebook and Google. Notice that Huﬃngton Post uses
Yahoo as IDP, illustrating that Yahoo can act as both IDP and RP. While the
ﬁgure only shows a snippet of this complex situation, clearly, the relationships
between these sites are nested.
In this paper we consider any third-party login collaborations in which an
RP is using one or more external IDPs in the login process. In addition to SSO
service, third-party identity providers are increasingly also used to share and
modify information across sites. Following this trend, in addition to authenti-
cation protocols, such as OpenID1 (e.g., used in part by Google), our study
shows that these services are increasingly implemented using authorization pro-
tocols, such as OAuth2 (e.g., used by Facebook). Authorization protocols have
the added functionality that they, on behalf of the user, can allow one site (or
service) to perform actions on a diﬀerent site.
In this paper, we present (i) a novel Selenium-based data collection method-
ology that allows us to accurately identify and validate RP-IDP relationships
that are not easily captured by pattern-matching crawlers (Section 2), and (ii)
a large-scale characterization of the identiﬁed RP-IDP relationships3, study-
ing how websites select their IDPs (Section 3). Our methodology and analysis
capture the impact on IDP selection of things such as relative site popularity,
cultural/geographic biases, and the intrinsic website characteristics. To put dis-
tribution and selection characteristics in perspective, we compare our results
against what is observed for third-party content delivery relationships. To the
1 OpenID (oﬃcial website), http://openid.net/, May 2013.
2 OAuth (oﬃcial website), http://oauth.net/, May 2013.
3 Datasets are available at
http://www.ida.liu.se/divisions/adit/data/pam14.html.
Third-Party Identity Management Usage on the Web
153
best of our knowledge, at the time of writing, there are no other large-scale
studies of the third-party identity management landscape and its structure.
In general, we ﬁnd that IDP usage is highly skewed, with a small set of
IDPs accounting for most of the world-wide usage. These IDPs are typically
globally popular sites (such as Facebook, Twitter, and Google) that have a large
user base. The tendency to select popular services as IDPs has resulted in a
pronounced rich-gets-richer eﬀect. For example, 90% of the RP-relationships are
to an IDP among the top-100 most popular sites according to Alexa, and 50%
of the observed RP-IDP relationships have a site-rank ratio of at least 103 (ratio
between the RP and IDP ranks). In contrast, the third-party content provider
relationships are relatively evenly distributed among Alexa ranks, with 50% of
the observed content provider relationships having a site-rank ratio of at least
four, suggesting a relatively weaker bias towards more popular sites. We also ﬁnd
that IDP selection is more biased towards the same cultural/geographic region
than what is observed for third-party content provider selection, and websites
appear to have a slight preference for selecting IDPs that provide similar service
as the website.
2 Methodology
2.1 Data Collection
At the core of the third-party identity management landscape are the relation-
ships between relaying parties (RPs) and identity providers (IDPs). To identify
relationships for a wide range of sites, we employed a novel two-step approach.
In the ﬁrst step, we use a logarithmic sampling technique to pick a sample set
of sites with varying popularities. In the second step, we use a Selenium-based
crawling tool that allows us to accurately identify and validate RP-IDP rela-
tionships that are not easily captured by pattern-matching crawlers. Figure 2
summarizes our methodology.
Popularity-Based Logarithmic Sampling: The size of the Web precludes
identiﬁcation of all RP-IDP relationships. Instead, we collect a “sample” set of
sites and study these for potential IDP usage. For our sampling we retrieved
the Alexa4 list on April 17, 2012 of the top 1 million most popular websites
worldwide. Based on Web popularity following power-law distributions [5], we
then placed 80,000 points uniformly on a logarithmic range [1, 106] (ensuring that
the number of points in segment [10x, 10x+1] is independent of x) and sampled
the sites with a popularity rank closest to each point. After removal of duplicates
we had a sample set with 35,620 sites.
Relationship Identiﬁcation: To identify RP-IDP relationships of each sam-
pled site, we built a novel Selenium-based5 crawling tool. Our crawler is built
as a cloud-based proxy, and acts like a human user, which may click on many
4 Alexa (oﬃcial website), http://www.alexa.com, April 2012.
5 Selenium. http://seleniumhq.org/, March 2012.
154
A. Vapen et al.
diﬀerent available GUI elements, react to pop-ups, and take a range of other
GUI-driven actions. In comparison with pattern-matching tools, we have found
that our Selenium-based tool does a very good job identifying relationships as-
sociated with more complex Web 2.0 websites. It captures relationships that
are non-trivial and not easily identiﬁed even using manual methods. This is im-
portant as many websites today use clickable images which may not match the
actual IDPs, and/or hide the IDPs within their design.
Our crawler is multi-threaded, explores each site down to a depth two from
the starting page, and uses regular-expression-based pattern matching on all el-
ements (including not only links but also clickable images, pop-ups, and similar)
to ﬁnd elements related to authentication. The tool initially prioritizes clicking
on object elements that match pre-deﬁned patterns and therefore are poten-
tial authentication related elements. When all matched elements on a page are
clicked, the tool continues clicking all other clickable elements until a speciﬁed
per-site timeout value of 25 minutes is reached.
2.2 Statistics and Complementary Datasets
For both the sampled sites and the identiﬁed IDPs, we used the Selenium-based
crawler and complementing scripts to collect statistics and information about
each site. The crawl included the download of 1.4 · 108 objects (totaling 1.6
TB), the identiﬁcation and analysis of 2.5 · 107 links. Out of the 35,620 sampled
websites, 1,865 websites were classiﬁed as RPs. We also observed 50 IDPs and
3,329 unique RP-IDP relations. Finally, complementing scripts were used to
obtain additional ownership, cultural, and geographic information regarding all
observed (sampled and non-sampled) sites. These complementary datasets are
primarily supportive and are discussed when used.
2.3 Validation
To ensure a fairly clean dataset, our Selenium-based data collection tool is de-
signed to carefully identify true RP-IDP relationships and avoid false positives.
The accuracy of our tool was validated using semi-manual relationship identiﬁ-
cation and classiﬁcation. To obtain as exhaustive and accurate a list of RP-IDP
relationships as possible we ﬁrst built yet another crawling tool that identiﬁed
candidate relationships much more loosely (and hence resulted in many false
positives!) that we could later manually verify/reject by examining the identi-
ﬁed objects that suggested such a linkage. We also carefully explored all sites on
the top-200 list manually for relationships. By combining these two approaches
we built a list of relationships involving the top-200 sites.
Out of a total of 69 RPs, 32 IDPs, and 186 relationships, the tool identiﬁed
23, 12, and 36, respectively. While the tool clearly does not ﬁnd all relationships,
it is very successful in avoiding false positives. The single false positive for IDPs
(vkontakte.ru), is due to a name change from vkontakte.ru to vk.com. The
three potentially false RPs (wordpress.com, uol.com.br, and onet.pl) are all
blog hosts, portals and website hosts. Their users create sub-sites which may
Third-Party Identity Management Usage on the Web
155
Table 1. Top-10 list of global IDPs. (a Facebook is a well-known OAuth-only provider,
but has in the past been an RP in OpenID. b Google and Yahoo also occasionally uses
OAuth. c The OpenID ﬁeld allows general login with any OpenID IDP, although some
restrictions may occur.)
IDP Alexa
Number
rank rank IDP/federation Protocol of RPs
1
2
3
4
5
6
7
8
9
10
2
10
9
1
4
16
-
4173
25
12
facebook.com
twitter.com
qq.com
google.com
yahoo.com
sina.com.cn
openID
vkontakte.ru
weibo.com
linkedin.com
OAutha
OAuth
OAuth
OpenIDb
OpenIDb
OAuth
OpenIDc
OAuth
OAuth
OAuth
1293
378
278
250
141
127
87
73
64
63
100
80
60
40
20
)
%
(
t
e
s
P
D
I
y
b
d
e
r
e
v
o
C
0
0
100
80
60
40
20
)
%
(
t
e
s
P
D
I
y
b
d
e
r
e
v
o
C
0
1
RPs
IDP-RP relationships
20
40
60
80
100
Fraction of IDPs (%)
RPs
IDP-RP relationships
10
104
102
Alexa site rank of IDPs
103
105
106
(a) IDP popularity
(b) Alexa rank
Fig. 3. RPs that are served by the most popular IDPs
allow third-party authentication. The third site onet.pl, also shares content
with Facebook. Finally, out of the 13 false relationships, roughly half are due to
sub-domain matches and name changes (as discussed above), and the rest are
due to misclassiﬁed content provider relationships.
While omitted, it should be noted that our conclusions have been tested and
validated using multiple crawlers. The use of our semi-manual dataset further
strengthens our belief in the generality of our results. We have not found any
major biases in the set of relationships included.
3 Characterization Results
3.1 The Big Players
Table 1 summarizes the top-10 globally most popular IDPs in our dataset, the
number of (sampled) RPs that these IDPs help, and the primary protocol used
156
A. Vapen et al.
for third-party authentication. For reference, we also provide the Alexa ranks of
the services.
We note that some of the most popular sites on the Web also are the most used
IDPs. The low Alexa rank for vkontakte.ru is largely due to a domain name
change (to vk.com with an Alexa rank of 41), as many RPs use the old domain
name. Interestingly, the general OpenID ﬁeld that allows the user to input any
OpenID provider is only used by 87 of the sampled sites and no specialized
IDP makes the list. In fact, we observe that OAuth is the dominating protocol.
Among the top-10 IDPs in Table 1, eight IDPs use OAuth as their primary
protocol and nine use OAuth for some of their relationships.
These results suggest that many sites choose to use popular sites as their
IDPs. The users are more likely to already have accounts with these sites, and in
many cases these sites may already have access to large amounts of personal in-
formation that could help the RP improve their personalization and service. This
observation may also provide some insight as to why identity management fed-
erations such as OpenID and third-party services that specialize only in identity
management have struggled to take oﬀ [11].
We next take a closer look at the relative popularity of the IDPs. Figures 3(a)
and 3(b) show the fraction of RPs that are served by the most popular IDPs and
the IDPs of a certain global popularity, respectively. We note that more than
75% of the RPs are served by 5% of the IDPs, and the majority of these 75%
are made up by the IDPs with Alexa ranks in the top 100. In fact, only 15 of
the 44 IDPs outside the top-10 Alexa list serve more than 10 sampled IDPs.
3.2 IDP Usage
We next consider the IDP usage. Figure 4 shows the number of IDPs observed
for each sampled site. While the average is highest for the most popular sites,
we note that there are some less popular sites that use a large number of IDPs.
Among the nine sampled websites with more than ten IDPs, six of the sites are
news sites and all nine use a login widget from gigya.com, providing the sites
with a selection of IDPs.
Figure 5 breaks down the IDP usage for each popularity segment, based on
which IDPs the sites in each segment are using. We can see that the RPs with the
most popular sites on average use the most IDPs, and that the top-ranked IDPs
are the most popular IDP choices for sites belonging to all popularity segments.
For all segments, the IDPs that rank in the top-10 contribute for more than 75%
of the IDP usage.
3.3 Comparison with Content Services
To put popularity skew and biases in perspective, in the following we compare
our observations with those observed in the more traditional content delivery
context. First, we consider the site-rank of the biggest service providers and
service users. In the context of identity management, these entities correspond to
the third-party IDPs and the RPs, respectively. In the context of content delivery,
Third-Party Identity Management Usage on the Web
157
P
R
r
e
p
s
P
D
I
f
o
r
e
b
m
u
N
32
16
8
4
1
IDPs per RP
Estimated weighted average
1
10
103
102
104
Alexa site rank of RPs
105
106
P
R
r
e
p
s
P
D
I
f
o
r
e
b
m
u
N
4
3
2
1
0
> 106
(105-106]
(104-105]
(103-104]
(102-103]
(10-102]
[1-10]
[1-10]
(105
-105
]
-106
]
(102
]
(10-102
(104
-104
]
Alexa site rank of RPs
(103
-103