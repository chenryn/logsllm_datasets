  * 可用性缓解拒绝服务
    * 访问控制
    * 过滤
    * 配额
    * 授权
    * 高可用性设计
  * 授权缓解提权
    * 访问控制
    * 组或角色成员资格
    * 特权管理
    * 输入验证
  * 缓解隐私威胁
    * 数据清洗
    * 数据脱敏
    * 传输/存储加密
    * 访问控制
    * 授权
## 5.4 威胁建模过程
  * 微软提供的方法  
过程如下图：  
    1. 预设场景
      * 场景，会哪里使用该产品？
      * 使用案例
      * 为场景/用例增加安全性
      * 结构化的方式来思考“你告诉客户有关产品的安全性？”
    2. 图表化场景/过程
    3. 识别威胁
      * 如果不知道从哪开始，可以从外部实体或驱动动作的事件开始
      * 不要忽略每一个威胁，因为你可能不知道它的利用方法
      * 聚焦易实现的威胁
    4. 提供每个威胁的缓解措施
    5. 验证所有威胁和缓解措施
      * 图表是否匹配最终的代码？
      * 列举的威胁是？
      * 最小化：触及信任边界的每个元素的STRIDE
      * 有测试检查模型？
        * 创建适当的测试计划
        * 测试者的方法经常发现与TM或问题的细节
      * 每个威胁是否得到缓解？
      * 缓解措施是否正确
另外有套类似风险评估的方法，需要计算每个风险的值，以区分风险级别  
过程见下图：
    6. 识别资产：确定哪些是包含敏感或隐私信息的关键资产/信息/文件/位置
    7. 创建体系结构概述：创建体系结构图以清楚地了解建议的应用程序及其托管环境
    8. 分解应用程序：分解体系结构图以识别各种进入和退出标准
    9. 识别威胁：使用STRIDE（欺骗，篡改，拒绝，信息披露，拒绝服务和特权提升）以及可能发生这些威胁的可能威胁
    10. 记录威胁：识别各种资产，威胁和控制。捕获缺少安全控制的威胁列表，并为每个威胁提供适当的修复建议
    11. 评估威胁：在与相应的客户/客户进行讨论之后，遵循DREAD（潜在损害，可重复性，可利用性，受影响的用户，可发现性）模型来对每个已识别的威胁  
详细可以参考：
  * OWASP 过程
    1. 分解应用程序。威胁建模过程的第一步是关注如何理解应用程序以及如何与外部实体交互。这包括创建用例来了解应用程序的使用方式，确定入口点以查看潜在攻击者可以与应用程序交互的位置，识别资产（即攻击者感兴趣的项目/区域），以及识别代表应用程序将授予外部实体的访问权限。此信息记录在“威胁模型”文档中，也用于为应用程序生成数据流图（DFD）。 DFD 显示通过系统的不同路径，突出特权边界。
    2. 确定并排列威胁。识别威胁的关键在于使用威胁分类方法。可以使用诸如 STRIDE 的威胁分类，或定义诸如审计和日志记录，认证，授权，配置管理，存储和传输中的数据保护，数据验证，例外管理等威胁类别的应用安全框架（ASF）。威胁分类的目标是帮助识别来自攻击者（STRIDE）和防御角度（ASF）的威胁。在步骤1中生成的DFD有助于从攻击者的角度确定潜在的威胁目标，例如数据源，进程，数据流和与用户的交互。这些威胁可以进一步确定为威胁树的根源;每个威胁目标都有一棵树。从防御的角度来看，ASF 分类有助于将威胁识别为这种威胁的安全控制的弱点。常见的威胁列表和例子可以帮助识别这些威胁。使用和滥用案例可以说明现有的保护措施可以被绕过，或者缺乏这种保护措施。可以使用诸如 DREAD 的基于价值的风险模型或基于一般风险因素（例如可能性和影响）的较不主观的定性风险模型来确定每个威胁的安全风险。
    3. 确定对策和缓解措施。缺乏对威胁的保护可能意味着可以通过实施对策来减轻风险。这种对策可以使用威胁对策映射列表来识别。一旦将风险等级分配给威胁，就可以将威胁从最高风险分类到最低风险，并且优先化缓解工作，例如通过应用所识别的对策来对这些威胁进行响应。风险缓解策略可能涉及评估这些威胁所带来的业务影响，并降低风险。其他选择可能包括承担风险，假设业务影响是可接受的，因为补偿性控制，通知用户威胁，完全消除威胁构成的风险，或者是最不可取的选择，即什么都不做。
OWASP的方法也是介绍了风险值的计算方法，详细说明见：
# 6 实际的威胁建模示例
以简单的用户登录情况示例
  1. **设定场景**  
用户使用浏览器登录Web应用系统，登录时检查是否为HTTPS请求，如果不是重定向到HTTPS，用户提交用户名和密码到应用服务器，应用服务网从后台数据库查询是否为正确的输入，如果用户名和密码正确，则认证成功，登录用户自己的首页界面。
  2. **图表化过程**  
使用微软的建模工具辅助作图，过程见下图：  
  3. **识别威胁**  
结合本文 STRIDE 介绍部分，外部实体 User 可能存在欺骗、否认的威胁，否认可能是用户否认某次登录请求。  
过程“提交登录请求”可能存在篡改、拒绝服务威胁，篡改可以是拦截非 HTTPS 请求重定向到一个钓鱼站点。
  4. **缓解措施**  
根据识别的威胁分析可以实施的缓解措施，最后整理成报告格式，可以用表格描述（下图只是个示例）  
# 7 威胁建模工具
  * 通用工具  
白板 + 纸
  * 开源工具  
微软开源的威胁建模工具[github](https://github.com/microsoft/threat-modeling-templates)
    * 下载：  
    * 文档：  
  * 商业工具  
# 8 攻击库
  * 检查清单
  * CAPEC
  * OWASP  
  * 建立自己的威胁库
# _参考_
  * 
  * 
  * 
  * 