\"/api/v0/search/fields/\"
\],
\"ua\": {
\"device\": \[
\"Other\"
\],
\"browser_v\": \[
\"Firefox 34.0\"
\],
\"os\": \[
\"Mac OS X\"
\],
\"os_v\": \[
\"Mac OS X 10.9\"
\],
\"browser\": \[
\"Firefox\"
\]
},
\"method\": \[
\"GET\"
\],
\"request_query\": \[
\"field=appname:&filters=&order=&page=1&query=\*&size=50&sourcegroup=all&sourcegroupCn=%E6%89%80%E6%9C%89%E6%97%A5%E5%BF%97&time_range=-1d,now&type=fields\"
\]
},
\"tag\": \[
\"devtest\"
\]
},
\....
\]
}
## 日志上传
![C:\\Users\\Think\\AppData\\Roaming\\Tencent\\Users\\783170398\\QQ\\WinTemp\\RichOle\\XYZD0\]PQD40EL4VETGO\]BTF.png](media/image8.png){width="6.2020745844269465in"
height="2.346405293088364in"}
日志分析软件支持本地上传和流式上传。
**流式上传**
流式上传分为脚本配置与手工配置
-   *脚本配置*
我们的configure_linux_rsyslog.sh脚本将为用户自动配置linux的标准rsyslog守护进程(deamon)以转发数据到日志分析软件。
1 . 运行生成配置文件脚本
运行下面configure_linux_rsyslog脚本会自动在当前目录生成配置文件模板。
curl -O 
chmod 755 configure_linux_rsyslog.sh
sudo ./configure_linux_rsyslog.sh -t 36a4c2b212d345dda1311517eb6d25fc
2 . 修改配置文件
用户根据需要修改rsyslog配置模版，替换\"FILEPATH\"，\"APPNAME\"，\"TAG\"字段
•FILEPATH: 需要监听的文件路径
•APPNAME:
用于标识上传的唯一应用来源，可用来定义日志分组，这将帮助用户有效划分日志，缩小搜素范围。在/etc/rsyslog.d/目录下，该字段不能重复。
•TAG:
标签，标识日志的扩展信息，可定义多个标识，可用来定义日志分组，这将帮助用户有效划分日志，缩小搜素范围。
3 . 将修改完毕的配置文件放入/etc/rsyslog.d/目录，重启rsyslog服务
-   手工配置
1． 配置系统环境
用户需要粘贴以下脚本并运行（保证/var/spool/rsyslog目录已存在），如果是Ubuntu系统，还需要对目录进行权限设置。
sudo mkdir -v /var/spool/rsyslog
if \[ \"\$(grep Ubuntu /etc/issue)\" != \"\" \]; then
sudo chown -R syslog:adm /var/spool/rsyslog
fi
2． 更新rsyslog配置文件。
sudo vim /etc/rsyslog.d/rizhiyi.conf
并将下列内容粘贴在这个配置文件中
\$ModLoad imfile
\$InputFilePollInterval 10
\$WorkDirectory /var/spool/rsyslog
\$InputFileName FILEPATH
\$InputFileTag APPNAME
\$InputFileStateFile stat_APPNAME
\$InputFileSeverity info
\$InputFilePersistStateInterval 20000
\$RepeatedMsgReduction off
\$InputRunFileMonitor
\$template RizhiyiFormat,\"\%protocol-version%
%timestamp:::date-rfc3339%%HOSTNAME% %app-name% %procid% %msgid%
\[36a4c2b212d345dda1311517eb6d25fc@32473 tag=\\\"TAG\\\"\] %msg%\\n\"
if \$programname == \'APPNAME\' then @@192.168.1.44:5140;RizhiyiFormat
if \$programname == \'APPNAME\' then \~
并替换下列全部字段
•FILEPATH: 需要监听的文件路径;
•APPNAME:
用于标识上传的唯一应用来源，可用来定义日志分组，这将帮助用户有效划分日志，缩小搜素范围。在/etc/rsyslog.d/目录下，该字段不能重复;
•TAG:
标签，标识日志的扩展信息，可定义多个标识，可用来定义日志分组，这将帮助用户有效划分日志，缩小搜素范围。
3 . 重启rsyslog
\$ sudo service rsyslog restart
**本地上传**
日志提供通过简单的命令行上传和拖拽文件直接上传两种方式。用户可以上传单个最大5MB的日志且单条日志信息小于1MB的文件。
用户只需填写tag（标签）、appname（应用名称），选择本地日志文件，或直接拖拽到指定区域即可。
3.  []{#_Toc464246743 .anchor}**设备部署**
![Macintosh HD:Users:huangjunyi:Desktop:屏幕快照 2016-01-29
18.39.36.png](media/image9.png){width="5.7659722222222225in"
height="4.021527777777778in"}
如上图所示，日志分析软件部署在x86集群服务上（或虚拟机），各安全设备，网络设备直接将日志通过syslog方式发送到日志分析软件集群；业务日志，中间件日志，通过部署agent方式，通过agent读取日志文件发送到日志分析软件集群中；linux／windows操作系统日志通过rsyslog和agent方式获取系统日志；数据库日志通过odbc接口直接获取；另外对于第三方系统可以通过定制接口开发或通用webservice／restful接口对接。
日志分析软件处理的日志可以通过标准api接口将数据提供给大屏幕系统进行图形展示；可以提供给BI系统进行数据分析；可以提供给统一告警平台进行统一告警；其他外部系统如果需要进行实时大数据处理的，均可以将数据先导入到日志分析软件平台中进行实时快速处理后，通过接口将结果会送到其他外部系统中。
## 应用部署概况
应用部署策略用以指导用户依据自身的业务规模，以及对性能、可靠性等方面的具体要求，来确定合适的系统配置和部署方案。用户的环境和要求千差万别，本节只是给出一个指导性的配置策略，依实际情况的不同，用户可能需要在本部署策略的基础之上做适当调整以满足特定需求。
## 部署规模与资源需求
日志分析软件系统可以在单台服务器部署(每天为数GB的数据导入并创建索引)，也可以在数台到数十台服务器的集群上部署(要为数
TB 数据创建索引)。
如何评估部署规模？
部署的特性因规模不同而异，但规模只是影响部署需求和架构的诸多因素之一。以下推荐值可为用户的规划提供一些参考，每个特定部署的实际数量将有所出入，根据日志量大小，我们为分别为用户提供了小型、中型、大型3种推荐部署方案，部署的特性将随着规模的增长而变化，用户可以在一定程度上了解所需要的内容。
1.  **CPU资源需求：**
-   小型
数据量20-100 GB/日，1000 \~ 5000 eps （event per
second，每秒日志数量），需要10-20核CPU。
-   中型
数据量100GB-300GB /日，5000 \~ 15000 eps，需要20-54核CPU。
-   大型
数据量 \>= 300GB /日，20000+ eps，至少需要54核CPU。
2.  **磁盘容量需求：**
磁盘容量需求主要集中在消息队列集群和索引集群。我们建议使用带副本的集群方案作为数据容灾的考虑。对于数据的保留方式，通过如下的计算公式便可以根据自身情况进行磁盘容量评估。
-   消息队列集群
磁盘容量 =（原始日志大小（GB）／24小时）\*
峰值（3倍）消息队列存储放大系数（6）\* 存储份数（2份）\* 保留小时数
／（机器数 \* 磁盘使用率（80%））
示例：
  -------------------------------------------------------------------------------------------
  磁盘需求   机器数   保留时间   存储份数   磁盘需求   计算方法
  ---------- -------- ---------- ---------- ---------- --------------------------------------
             3        2 小时     2          1.25 TB    （原始日志大小（1000GB）／24小时）\*
                                                       峰值（3倍）\*
                                                       消息队列存储放大系数（6） \*
                                                       存储份数（2份）\* 保留小时数
                                                       ／（机器数 \* 磁盘使用率（80%））
                      8 小时     2          5 TB       
  -------------------------------------------------------------------------------------------
-   索引集群
磁盘容量 = 原始日志大小（GB）\* 索引放大系数（2.5倍）\* 索引份数 \*
**保留天数 ／ （ 机器数** \* 磁盘使用率（80%））
索引放大系数与抽取的关键字段数相关，抽取的关键字段数越多，索引放大系数就越大，2.5倍是最大值。
示例：
  -------------------------------------------------------------------------------
  磁盘需求   机器数   保留时间   索引份数   磁盘需求   计算方法
  ---------- -------- ---------- ---------- ---------- --------------------------
             36       3天        2          370 GB     原始日志大小（1000GB）\*
                                                       索引放大系数（2.5倍）\*
                                                       索引份数（2） \*
                                                       **保留天数 ／ （ 机器数**
                                                       \* 磁盘使用率（80%））
                      7天        2          1.22 TB    
  -------------------------------------------------------------------------------
## 部署方案
-   单机部署
1台服务器部署日志分析软件所有产品模块。
最低配置：
-   OS：CentOS 6.5 x86_64
-   CPU：4核 2.0GHz
-   MEM：16GB
-   DISK：300GB
处理能力：1000 eps以下。
适用场景：处理小流量数据、体验试用日志分析软件产品。
-   集群部署
日志分析软件整个系统有多个模块构成，用户可以根据自身服务器资源、数据量、系统稳定性等因素自定义各个模块的节点组成。推荐各个模块的集群均有3台及3台以上服务器构成，同时支持物理机和虚拟机混合部署。
示例1.
3台物理机，每台24核、64GB内存，可处理20000
eps条日志。相当于300GB-400GB/天日志量。
示例2.
3台物理机，每台24核、96GB内存，切分成18台虚拟机（每台4核、8GB\~16GB内存），可处理20000
eps条日志。相当于300GB-400GB/天日志量。
4.  []{#_Toc464246747 .anchor}**产品优势**
    1.  ## 统一日志管理
日志实时采集，日志统一处理、统一保存、集中查看、集中搜索，无需登录每台服务器人工查看日志，提高运维效率，保障运维安全。
## 功能强大
-   自动识别各种日志类型，自动抽取关键字段，将非结构化日志转化为结构化数据；
-   对日志做全文索引，方便搜索；
-   对不同来源的日志做关联分析，方便及时定位问题；
-   丰富的统计及可视化功能，日志情况一目了然；
-   对日志进行监控告警，可电邮或短信通知用户；
-   对日志进行分组管理，赋予使用者不同的权限；
-   提供开放API接口，灵活对接第三方系统或二次开发日志应用。
    1.  ## 高性能、可扩展
采用高性能分布式架构，可支持每日TB级别的日志量，每秒钟可处理10万条日志，搜索分析结果秒级延时，让用户查询到十几秒钟之前产生的日志。日志分析软件系统在普通PC服务器上运行，可根据日志量的增长逐步扩容。
## 操作简明易用
不需要用户掌握复杂的搜索语法，使用简单的搜索框查询，及通过用户图形界面和友好的用户交互来完成强大的搜索、分析功能。