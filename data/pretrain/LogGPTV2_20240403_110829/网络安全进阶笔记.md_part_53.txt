C9=1111111111011000000001111111D90000001101000100000110111011
C10=1111111101100000000111111111 D100000110100010000011011101100
C11=1111110110000000011111111111 D11=0011010001000001101110110000
C12=1111011000000001111111111111 D12=1101000100000110111011000000
C13=1101100000000111111111111111 D13=0100010000011011101100000011
C14=0110000000011111111111111111 D14=0001000001101110110000001101
C15=1000000001111111111111111101 D15=0100000110111011000000110100
C160000000011111111111111111011 D16=1000001101110110000001101000
解密过程与加密过程相反，所得的数据的顺序恰好相反。
5.4.4精彩案例：通过加密软件TEFS实现算法
下面将介绍一款性能卓越的加密软件TEFS，它可以同时对儿千个文件瞬间加密，并具有
神奇的透明化加密功能。如可以通过Word对加密后的Word文档进行编辑，通过RealPlayer
观看加密后的电影文件，而且，因为加密操作是在内存中进行，不会在磁盘上产生任何文件。
软件的最新版本为V1.1，下载地址为http://www.ccoresoft.com/chs/download/TEFS1.11
(Integrated).exe。
运行最新版本的集成安装包，按屏幕上的提示进行安装。安装后重新启动计算机。软件启
动后，界面如图5.31所示。
图5.31加密软件TEFS的界面
软件具有如下特点：
安全度高。文件的数据被安全可靠地加密，在任何时间地点只有授权用户可以使用。
使用范围广。适用于所有Windows平台和存储设备，可以加密任何类型的文件、文
件夹和分区，加密引繁可以不断扩充并自行开发。
使用方便。授权用户可以直接使用加密文件和文件夹，无需先进行烦项的解密操作，
就像使用一般的文件和文件夹一样。
界面友好，占用系统资源小。
250
---
## Page 259
与S
1.透明化功能和内核功能
在TEFS运行时，操作系统和所有的应用程序以原始内容为标准，这个过程对于操作系统
和应用程序是透明的，所以叫做透明化。TEFS还是一个内核层的加密软件，具有无需解密便
可直接编辑的特点，而且在内存中进行，不会在磁盘上产生任何文件。
使用TEFS进行透明化服务时，如果某个文件的加密策略还没有配置，要先进行策略配置。
首先，启动TEFS，在工具栏上选择策略，单击“配置”按钮，在弹出的对话框中，选择加密
策略，默认的是SEAL（Software Encryption Algorithm）加密策略，然后，填入所需要的密码。当
TEFS软件在后台运行时，用户就可以使用文本编辑器对它进行编辑，无论是在编辑前还是编
辑后，文件的显示内容始终是正确，而且是加密的。如图5.32所示。
内核是TEFS的核心，如果暂时不需要使用透明功能时，可以关闭内核，这样将暂时失去
造明化服务功能。用鼠标右键单击系统托盘中的TEFS图标，在弹出的菜单中，选择“关闭内
核”命令，如图5.33所示。需要说明的是，动态切换内核的应用范围并不局限于文件的拷贝，
我们还可以发送加密的电子邮件、用WinRAR压缩加密文件。
选择一个加出加以作为加座时所使用款认路
打开TEFS
的后业的配置视配置认与电络
加：
2冲
:
A是一个的加电出
图5.32加密软件TEFS的策略配置
图5.33加密软件TEFS的系统托盘菜单
2.透明加密和解密文件
在浏览栏右边的视图中选择要加密的文件，如选择C：tesLtxt，在工具栏上单击“加密”按
钮，弹出“加密”对话框。然后，选择目标位置和加密策略，并输入密码，如果已经选择加密
策略，则不需要输入。单击“确定”按钮，即可对文件进行加密，如图5.34所示。
目的置相
加座线略：
电码
调认电码
EA
图5.34加密软件TEFS的加密设置
现在，我们来测试一下这个软件的透明化功能。启动TEFS这个软件时，我们可以直接在
TEFS的浏览栏中打开test.txt，其内容正确地显示在屏幕上，这是因为TEFS在透明化地支持
test.txt.
但是，当我们关闭TEFS软件后，重新打开testtxt时，发现其显示内容变成了乱码文件。
通过比较，我们可以确定testtxt已经被加密了，与传统软件相比，TEFS软件被破解的概率明
251
---
## Page 260
网络安全进阶笔记
显变小了。即它在磁盘上的存储内容已经采用了SEAL算法进行加密。如图5.35所示。
IEFS
个16吃的加密算社
图5.35明文和密文比较
对于加密后的文件，我们还可以查看一些详细信息。选中加密后的文件，单击“信息”按
钮，即可得到这个文件的相关信息。如图5.36所示。
需要解密时，在浏览栏右边的视图中选择文件和文件夹，如图5.37所示。
钮后，按提示输入密码，即可完成对文件的解密。
获京1个文作的售息：
信息
定
图5.36文件的相关信息
日的地
第
确定”清
己存在的文件
文持
图5.37加密软件TEFS的解密设置
3.加密和解密文件夹
TEFS还有一个优势，它可以直接对文件夹进行操作。TEFS对文件夹加密后，这个文件夹
就具有了加密功能，如果在该文件夹内生成新文件或子文件夹时，这些文件或子文件夹仍然是
加密的，并使用与这个文件夹相同的加密策略和策略配置。例如，选中“C:test”这个文件夹，
话框。根据实际应用，可以选中“包括子文件夹”和“包括文件”。如图5.38所示。
252
---
## Page 261
第5章趣解加密与解密
社基文收附
图5.38加密文件夹
4.其他
（1）策略缓冲清除功能。若需要暂时离开计算机，可以在工具栏上选择清除，这样TEFS
的所有缓冲密码都被制除掉了.如果要继续使用TEFS的透明化功能，必须重新进行策略配置。
（2）复制和粘贴。由于文件的拷贝是我们经常进行的操作，所以TEFS提供了复制和粘贴
两个菜单来实现这个功能，我们可以通过工具栏上的复制和粘贴按钮的联合使用，使新生成的
目标文件依然是加密文件。
（3）使用报告栏，如果修改了加密后的文件时，报告栏上会出现出错提示，实际上我们还
可以通过报告栏查看其他信息。如成功操作和失败操作，在报告栏的底部选择成功标签，可以
查看对成功操作的描述，也包括使用的策略。在报告栏的底部选择失败标签，可以查看对失败
操作的描述，也包括失败的原因，如图5.39所示。
H
图5.39加密软件TEFS的报告栏
（4）部分加密功能。实际加密应用中，如果我们只需要对部分文件内容进行加密，则可使
应用此配置后，即可对所加密的文件进行部分加密。如图5.40所示。
东党车城2，东有有
武汉贵续，域影五牛
图5.40加密软件TEFS的部分加密功能
253
---
## Page 262
网络安全进阶笔记
通过以上讲解，我们对TEFS的透明加密功能有了一个比较直观的认识，有了这个软件，
我们就可以安全地使用自己的机密文件了。对于硬件加密设备提供商来说，还可以通过编写一
个TEFS策略插件软件包来推广硬件加密设备，从而赢得更广阔的商业市场。
5.5非对称算法基础知识
所谓非对称密钥，指的是加密用的密钥和解密用的密钥不同，虽然两者之间存在一定的关
系，但不可能轻易地从一个推导出另一个。
5.5.1非对称算法简介
非对称密钥由于两个密钥（加密密钥和解密密钥）各不相同，因面可以将一个密钥公开，面
将另一个密钥保密，同样可以起到加密的作用，公钥密码的优点是可以适应网络的开放性要求，
且密钥管理问题也较为简单，尤其可方便地实现数字签名和验证。但其算法复杂，加密数据的
速率较低。尽管如此，随着现代电子技术和密码技术的发展，公钥密码算法将是一种很有前途
的网络安全加密体制。
当然在实际应用中人们通常将常规密码和公钥密码结合在一起使用，比如利用DES或者
IDEA来加密信息，面采用RSA来传递会话密钥。如果按照每次加密所处理的比特来分类，可
以将加密算法分为序列密码和分组密码。前者每次只加密一个比特，而后者则先将信息序列分
组，每次处理一个组。
非对称算法主要包括RSA、背包密码、McEliece密码、Diffie-Hellman、Rabin、OngFiat
Shamir、零知识证明算法、椭圆曲线、EIGamal算法等。最有影响的公钥密码算法是RSA，它
能抵抗到目前为止已知的所有密码攻击。
5.5.2RSA算法描述
基于以下原因，RSA算法会被越来越多的共享软件采用：原理简洁易懂：加密强度高：专
利限制已过期：网上大多数共享软件的注册码（又称为序列号）的设计都不是很好，比较容易被
破解者做出注册机来。利用公钥算法（又称为非对称算法）RSA制作注册码可以达到一个比较高
的安全等级。所以，采用这种方法，不知道密钥的话时将很难破解。目前，有很大一部分软件
已经使用了这类方法。
RSA是一种非对称的公钥密码算法。以RSA为代表，公钥密码算法带来了传统保密通信
的革命，在当今的通信保密领域有着广泛的应用，发挥着巨大的作用。RSA以其算法的简单性，
高强的抗攻击性在公钥密码的应用中占有绝对的优势。
1.公钥密码与传统密码
RSA是用与两个极大质数（a，b）的积互素的一个整数（ency）对整个明文进行数学变换后得
到加密的密文(n=ab，f(n)-（a-1)(b-1).encryp*decryp=1mod f(n))。假设我们目前待加密的明文
254
---
## Page 263
三
与S
是m，密钥是k，密文是c，加密算法是E，脱密算法是D，则在传统的密码学中存在着这样
的一种关系：
·c=Ek（m）
m=Dk（c）
也就是说，加密和脱密的密钥是相同的，如果小王和小张用这种密码进行保密通信，那么
小王和小张必须事先私下里商定好密钥。但是，假设有n个用户用这种方式进行相互保密通信
则需要C=n*（n-1y2个密钥。若n=1000，则C10002=499500，如此之多的密钥的存储、管
理和必要的更换是一项繁重而不够安全的工作。
如果每一用户A都有一加密密钥kae，另外还有一不同于加密密钥的脱密密钥kad，则存
在这样一种关系：
·c=Ekae（m)
·m=Dkad(c)
A将kae公开面将kad保密，当然，前提是kae的公开不会威胁到kad的安全，我们称kac
为公钥，称kad为私钥。这样，A与其他用户进行保密通信时，其他用户可用A公开的公钥进
行加密，A收到密文后，再用自己的私钥进行脱密，完成了保密通信任务。由于第三方可以截
获密文c，他也知道公开的加密密钥kae，但是他无法从加密密钥kae推导出脱密密钥kad，因
此无法恢复明文。
2.RSA算法介绍
RSA是一种非对称的公钥密码算法，是第一个比较完善的公开密钥算法，它既能用于加密
也能用于数字签名。在已公开的公钥算法中，RSA是最容易理解和实现的。
下面介绍一下RSA算法的流程。
（1）首先，选取两个大素数p和q：计算n=p*q：随机选取加密密钥e.使得e与（p-1q-1)
互素。计算脱密密钥d，d满足ed=1mod（(p-1)(q-1)，即d=e-1mod（(p-1)(q-1))。