when_it_happened, how_long, how_many, alien_description,
what_they_did,fang_spotted, other, email)
VALUES（'Sally','Jones'，'3 days ago'，'1day','four'，
green with six tentacles','We just talked and played with a dog',
'yes','I may have seen your dog. Contact me.',
'PI:EMAIL')
File Edit Window Help PugslnSpao
mysql> INSERT INTo aliens_abduction (first_name,last_name,
when_it_happened,how_long,how_many,alien_description,
what_they_did,fang_spotted,other,email)
VALUES（'Sally',Jones'，'3 days ago′,'1 day',four',
'green with six tentacles','We just talked and played with a dog'
'PI:EMAIL');
Query OK,1rows affected (0.0005 sec)
在MySQL终端中执行这个JNSERT语
句金在aliens_abduction表中增加一个
INSERT语句看起来已经成功执行。请写出你认为可以如何确认数
新的数据行。
据已经增加。
你现在的位置
69
---
## Page 106
引入SELECT语句
使用SELECT得到表数据
向数据库表插人数据非常方便，但是由于尚未确认数据确实已经增加到
表中，所以让人不免还是有某种程度的不安。这有些类似于把钱存人一
个存款帐户，但是永远也无法得到帐户余额。利用SELECT语句就可以
得到数据库中一个表的“余额”。或者更确切地说，SELECT允许你从
一个表请求数据列。
SELECT后面是列的一个列表
你希望得到这些列的数据。
SELECT总是针对于一个特定的数据库表
而不是一般参义上的数据库。
SELECT columns FROM table_name
71
70S
SELECT语句中的FROM部分确保SELECT知
道我们将从哪个表选择数据。
SELECT语句
从一个数据
提供给SELECT语句的数据列必须用逗号分隔。不论一个表有多少
库表获取数
个列，只会返回SELECT中指定的列中的数据。这个SELECT语句将
从aliens_abduction表中获取被外星人劫持者的名和姓：
据列。
这个SELECT语句只会
这个SELECT语句只从aliens_
返回这两列的数据。
abduction表获取数据。
SELECT first_name,last_name FRoM aliens_abduction
要检查一条INSERT语句，需要一种快捷的方法来查看一个表中的所有
数据，而不只是某几列。以下SELECT语句提供了一种便捷途径来完成
这个工作：
霍号或“霍”（*）告诉SELECT语句
获取表中所有列的数据。
y
SELECT*FROMaliens_abduction
不必提供列列表，因为*就表
示“全部获取”！
70
第2章
---
## Page 107
连接MySQL
运行测试
通过SELECT选择表数据确保外星人劫持INSERT语句起作用。
使用一个MySQL工具执行SELECT查询来查看aliens_abduction
表的全部内容。确保你刚插入的新数据行出现在结果中。
SELECT * FROM aliens_abduction
这些是列。
mysql>SELECT*FROM aliens_abduction;
first name
|lastname
when_it_happened|how_long
ISally
Jones
13daysago
11day
Ifour
rowinset(0.0005sec)
A
各列名下面是该列的数据。
SELECT壹询显示了表中存储的
一个数据行。
PDG
你的表中有多少个数据行？
你现在的位置
71
---
## Page 108
利用PHP自动执行SQL命令
你是说，每次我想向我的数据库增加一个新的外
星人劫持报告都必须写一个INSERT语句？这么卷
来，这些MySQL内容突然也没那么有吸引力了。
没错，对MySQL数据库的每一个插入都需要一个INSERT语句。
另外正是这一点暴露出纯粹通过SQL命令与MySQL数据库通信很
是繁琐。将Owen的数据存储在数据库中相对于作为收件箱中的邮
件确实能得到很多好处，不过通过在一个MySQL工具中执行SQL
语句来手动地管理这些数据并不是一个可行的方案。
BRAIN
CPOWER
你认为Owen的MySQL数据插人问题可
以如何解决？
72
第2章
---
## Page 109
连接MySQL
让PHP处理繁琐的SQL事务
针对Owen的问题，解决方案并不是避开SQL，而是借助于PHP自动执
行SQL。利用PHP，可以在服务器上运行的脚本中执行SQL语句，所
Owen创建了一个SQLJNSERT语句
以你根本不需要使用MySQL工具。这说明Owen的HTML表单可以调
将email中的数据插入到数据库中。
用一个PHP脚本，这样一旦有数据提交这个脚本便向数据库中插入数
据，不再有email，不再有SQL工具，不再有麻烦！
HTML表单生成Owen
接收的一个email.然
后必须手动地增加到
数据库。
如果没有PHP，需要分别手动执行一条SQL
INSERT语句在数据库中存储各个外星人劫持报告。
有了PHP，PHP脚本会自动地在表单提交时处理
插入（INSERT）。
report.html
We Jas
'3 days
dog.
HTMC表单调用一个PHP脚
本，并请求它将表单数据
增加到数据库。
PHP牌本创建一个INSERT语句，它
将表单数据插入到数据库…根本
report.php
无需Owen介入！
你现在的位置
73
---
## Page 110
Owen的应用如何使用PHP和MySQL
PHP支持数据驱动Owen的Web表单
PHP能够改进Owen的外星人劫持Web表单，由一个脚本直接向数据库发
送表单数据，而不是把数据发送到Owen的email地址并由Owen手动输人。
下面更详细地分析引入PHP后这个应用具体是如何工作的。
Sally填写了外星人劫持表单，并按下Report
Abduction按钮提交表单。有关信息发送到
Web服务器上的report.php脚本。
我太孤单了，
不是吗？
Sally最近被
外星人劫
持过。
Web服务器
report.html
一旦用户提交，teport.htm页面中
的表单金调用We6服务器上的zepott.
太多太多其他人还在继续提交表单。
php脚本。
PDG
74
第2章
---
## Page 111
连接MySQL
Owen的report.php脚本连接到一个MySQL数
据库，并使用SQLINSERT语句插人每次提交得
到的信息
teport.php脚本与MySQL服务器
逐信将数据插入到数据库的
Web服务器
aliens_abduction表。
report.php
aliens_abduction表将外星人
动持报告存储为数据行。
Owen不仅需要一个脚本将数据放入数据库，还需要一个脚本来搜索和查
看数据。实际上，这可以作为他的网站的主页。index.php脚本连接到
数据库，获取外星人劫持数据，并显示给Owen。
Web服务器
数据库服务器就是一个在服
务器计算机上运行的程序，逐
数据库服务器
常与We6服务器在同一个计算
index.php
机上。
index.php脚本从aliens_abduction表获取数据
完成格式化并显示给Owen。
Owen能够采用
aliens_abduction表用作为
多种新的方式访
index.php脚本的数据源。
问数据，从而允
许他重点关注如
何寻找他丢失的
小狗Fang。
你现在的位置
75
---
## Page 112
建立mysql连接
从PHP连接数据库
PHP脚本向一个MySQL数据库插人数据或从中获取数据之前，必须先连
接到这个数据库。从PHP连接到一个MySQL数据库在很多方面类似于从
你的We6托管服务或网管可能金告诉你
这个信息，或者如果你的We6服务器和
一个MySQL工具访问数据库，也需要同样的一些信息。还记得本章前面
MySQL数据库服务器在同一个机器上运
需要你填写的3个选项吗？下面再次给出这几个选项，不过这里另增了一
行.也可以使用“localhost”
个对应数据库名的选项，请再一次填写这些信息。
我的MySQL服务器位置（IP地址或主机名）：
我的数据库用户名：
③我的数据库口令：
先前创建的数据库的名，即
aliendatabase。如果出于某种原因
④我的数据库名：
你的数据库有其他名字或者如果
你决定使用一个已经创建的数据
库.则应使用该数据库名。
通过一个PHP脚本建立与一个MySQL数据库的连接时，数据库服务器的
主机位置、用户名、口令和数据库名都是必要的。一旦建立了连接，脚
本就能够执行SQL命令，就好像你在一个MySQL工具中手动地输人这些
命令一样。
你自己的4部分连接数据
数据库名是aliendatabase.
可能与此不同。
脚本与数据库通信时必须
数据库服务器
提供这个信息。
localhost
report.php
2
owen
aliendatabase
任何向一个MySQL数据库
aliendatabase
存储和获取数据的PHP脚
本必须首先使用这4部分
aliens_abduction
信息建立与数据库的一个
连接：
index.php
这是我们刚创建的
数据库和表。
表名是aliens_abduction，在开始执行
SQL命今之前这个表名还没有正式上
场。
76
第2章
---
## Page 113
连接MySQL
用PHP脚本插入数据
从PHP代码执行一个MySQL查询首先要求建立与数据库的一个连接。然
后将查询构建为一个PHP串。在将这个串传至数据库服务器之前这个串并
不会真正执行。最后，完成对数据库的查询后，要关闭连接。所有这些
任务都通过PHP脚本代码完成。以下是插人一个新的外星人劫持数据行的
例子：
这些应当是你自己的4个值，而
连接到MySQL数
不是Owen的相应信息。
据库。
这些函数要求你的We6服务器安装
有PHP4.（及以后版本。
BRAIN
XPOWER
你认为以下各个PHIP函数在脚本中起什么作用？
mysqli_connect()
mysqli_query()
mysqli_close()
你现在的位置
77
---
## Page 114
PHP的3个mysql连接函数
使用PHP函数与数据库通信
较早的一组与MySQL逐信的PHP
有3个主要的PHP函数用于与MySQL数据库通信：mysqli_connect（）、
西数以mysl_开头，没有这里
的“”。这个"”代表“改
mysqli_query（）和mysqli_close（)。也许你已经发现这里有一
进”（improved），现在更倾向
个规律，这并不是偶然的，所有与MySQL交互的最新PHP函数都以
于使用mysqli_系列面数。
mysqli_开头。
mysqli_connect()
mysqli_query()
mysqli_close()
使用前面已经了解的4部分信息连
在MySQL数据库上执行一个查询，关闭与一个MySQL数据
接MySQL数据库。
这通常涉及在表中存储数据或从库的连接。
表获取数据。
使用上述3个函数通常都需要完成以下可预知的一系列步骤。
提供服务器位置、用户名和口令来得到与MySQL数据库服务器交互的许可。另外还要指定数据库名，
因为这是与一个特定数据库的连接。
喂？呼叫
我在。
MySQL服务器，
你在吗？
mysqli_connect()
已连接！
②创建一个SQL查询，并把它作为一个串存储在一个PHP变量中。
要与数据库服务器通信，必须使用sQL命令。例如，要向aliens_abduction表增加数据
就需要一个INSERT语句。这里选择的变量名并没有什么特殊之处，不过类似Squery的简单
变量名就很不错。
我想要发送一个庞大的
INSERT语句，它存储在一个
PHP变量中。
壹询创建为一个串，
存储在Sguey变量中。
PD
Kxanbs
78
第2章
---
## Page 115
连接MySQL
3
用mysqli_query（)函数执行查询。
利用$query变量使用mysqli_query（）函数与MySQL数据库服务器通信，并向aliens
abduction表增加数据。必须向mysqli_query（）告知第1步创建的连接名以及第2步中存放查询的
变量名。
这个面数全执行你的奎询，这是
个向表中括入数据的INSERT语句
喂，把这些内容插
好的！
入（INSERT）到你的
mysqli_query()
表里。
D
成功！
用mysqli_close(）函数关闭数据库连接。
A
最后，mysqli_close(）告诉MySQL数据库服务器已经结束与它的通信。
工作已经完成，
mysqli_close()
呵连句谢谢都没
再见。
有！
连接关闭。
这是连接变量名
如果出问题，这会向你发回
这是一个SQLJNSERT叠询，
一个消息，并中止所有工作。
用于向数据库增加数据。
<?phP
$dbc = mysqli_connect('data.aliensabductedme.com','owen','aYiensrool','aliendatabase′)
die（'Error connecting to MySQLserver.'):
2
$query = "INSERT INTO aliens_abduction (first_name, last_name, when_it_happened, how_long,
"how_many, alien_description, what_they_did, fang_spotted, other, email) "
"'We just talked and played with a dog','yes','I may have seen your dog. Contact me.