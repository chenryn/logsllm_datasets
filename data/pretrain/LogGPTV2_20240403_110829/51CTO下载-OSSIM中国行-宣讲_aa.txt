OSSIM 中国行 
李晨光（IBM 讲师）
作者简介
李晨光，IBM讲师、中国计算机学会高级会员。 
 OSSIM中国 创始人。 
代表作：《Linux企业应用案例精解 第2版》 
 《UNIX/Linux网络日志分析与流量监控》 
 《开源安全运维平台OSSIM最佳实践》 
| 讨论议题 | 讨论议题 |  |
|---|---|---|
|  |运维背景 | |
|  |SIEM、OSSIM发展史 | |
|  |安全管理 | |
|  |基于插件的事件 | |
|  |关联分析 | |
|  |威胁情报 | |
|  |OSSIM部署、安装 | |
|  |漏洞扫描 | |
|  |流量监测 | |
|  |资产管理 | |
|  | | |
应用系统 
Internet  DHCP 
4 
防病毒 	抓包系统
漏洞扫描 资产管理  管理员 IDS/IPS  日志采集防病毒 	抓包系统
漏洞扫描 资产管理  管理员 IDS/IPS  日志采集
运维人员日常大部分时间和精力都花在处理简单且重复的问题上，而且由于故障预 警机制不完善，往往是故障发生后才会进行处理，这种情况使运维人员的工作经常 处于被动“救火”状态。
Internet 
监控平
汇聚层交换 	台
机 
出口防火墙 
核心层交换机 
接入层交换 机  汇聚层交换 
机 
接入层交换
机 
接入层交换机 
安全运维的新挑战
每天出现巨大数量的安全报警，管理员很难对这些报警做出响应。
误报严重，管理员无法准确判断故障。
大量重复、零散而没有规律的报警，黑客的一次攻击行动，会在不同阶 段触发不同安全设备的告警，这样导致报警数据之间在时间和空间上存 在大量重复数据，如果不实现安全事件的关联处理，就无法有效的提高 告警质量。
| 弊端 | 弊端 |
|---|---|| 弊端 | 弊端 |
|---|---|
|  |可视性缺乏 - 对组织目前所面临的安全威胁及风险无整体视角,合规性状况 |
不是清楚。
	实时性差 - 安全团队不清楚组织现在正在发生哪些安全威胁及风险,在得到 	用户的投诉后，IT部门才知道威胁事件产生。
	取证难 - 在进行事件调查时，常常面临需要跨越多个安全设备，多个IT人 	员联合努力，且某些安全设备日志保存有时限要求，费时费力。
|  | 调查不彻底 - 事件调查往往追溯不到最终的源头。 | 调查不彻底 - 事件调查往往追溯不到最终的源头。 |
|---|---|---|
|  |缺少证据显示 - 审计部门审查，无法提供证据证明对法规、标准的遵循情况 |缺少证据显示 - 审计部门审查，无法提供证据证明对法规、标准的遵循情况 |
|  | | |
| 人工整合开源监控系统的难点 | 人工整合开源监控系统的难点 || 人工整合开源监控系统的难点 | 人工整合开源监控系统的难点 |
|---|---|
|  无法实现数据之间关联分析。  无法生成统一格式的报表。  缺乏统一的仪表板来展示重要监控信息。  无法对网络风险进行检测。 各子系统维护难度，增大了运维成本。	  软件和依赖依赖问题难以解决。  各子系统界面重复验证和界面风格问题。  各子系统数据无法共享。 | 无法实现数据之间关联分析。  无法生成统一格式的报表。  缺乏统一的仪表板来展示重要监控信息。  无法对网络风险进行检测。 各子系统维护难度，增大了运维成本。	  软件和依赖依赖问题难以解决。  各子系统界面重复验证和界面风格问题。  各子系统数据无法共享。 |
|  | |
| 安全信息和事件管理（SIEM） | 安全信息和事件管理（SIEM） |  |  |
|---|---|---|---||---|---|---|---|
|  |SIEM（Security Information and Event Management），它分为商业的解决方案和 开源的两种，本章介绍的OSSIM系统就是 安全信息与事件管理（SIEM) 的开源解决 方案  | | |
|  |SIEM通过相关事件、用户、系统、数据、风险和准确状态对策信息，从而让用户及 | | |
| 时将各个安全节点联系起来，及时定位攻 |时将各个安全节点联系起来，及时定位攻 | | |
| 击，准确了解全网的威胁态势。 |击，准确了解全网的威胁态势。 | | |
|  | | | |
监控到什么程度？
|  | 基于SNMP GET的监控方式只能监控到设备 |  |
|---|---|---||---|---|---|
| 表象，而基于嗅探和抓包的监控才能由表 及里。就好比为每一个TCP/IP连接都拍摄 X光片一样，统计和分析封包的结构。 |表象，而基于嗅探和抓包的监控才能由表 及里。就好比为每一个TCP/IP连接都拍摄 X光片一样，统计和分析封包的结构。 | |
|  | | |
| 开源SIEM系统-OSSIM  | 开源SIEM系统-OSSIM  |  |
|---|---|---|
|  |OSSIM即开源安全信息管理系统（Open  | |
| Source Security Information  Management），是一个目前流行的开源安 全架构体系。 |Source Security Information  Management），是一个目前流行的开源安 全架构体系。 | |
|  |OSSIM能为您的企业网打造一个从运维监控→事前预警→事后报警→SIEM日志分析故 障的这样一个快速解决问题的网络系统。 | ||  | | |
Click to edit master title style 完整OSSIM平台组成
组织人员 程序&流程 运维平台
| 业务流程团队: CEO/CTO与其他 | 业务程序与流程 | SIEM  |
|---|---|---|
| 业务流程团队: CEO/CTO与其他 |业务程序与流程 |•网络监控中心 |
| 维运中心团队:  |•应变机制作业程序 |•网络监控中心 |
| 维运中心团队:  |•应变机制作业程序 |•与工单系统iTop整合 |
| 维运中心团队:  |•服务等级（SLA） |•与工单系统iTop整合 |
| 第一组, 基本监控与事故响应 |•服务等级（SLA） |•与工单系统iTop整合 |
| 第一组, 基本监控与事故响应 |•政策与标准 ISO27001 (ISMS),  |•调查与鉴识工具 || 第二组, 事故调查 |•政策与标准 ISO27001 (ISMS),  |•调查与鉴识工具 |
| 第二组, 事故调查 |BS10012 (PIMS) PCI-DSS  |•调查与鉴识工具 |
| 第三组, 设计与改进维运中心 |BS10012 (PIMS) PCI-DSS  |•安全设备与工具 |
| 第三组, 设计与改进维运中心 |ITIL/ISO20000/BS25999  |•安全设备与工具 |
| 合规团队: 内部/外部稽核员 |ITIL/ISO20000/BS25999  |•渗透测试、弱点扫描 |
•蜜罐诱捕系统
| 发展历程 | 发展历程 |  |
|---|---|---|
| 2003 1  |2010  2.1 64 2010 2.2 64位 |2014  4.3  64位 |
2016  5.2.4   64位
主要组件
有许多开源安全工具2016  5.2.4   64位
主要组件
有许多开源安全工具
| 	MDL 
挑战: 如何将这些开源工具集中到一个 PRADS 	NFSend | 	MDL 
挑战: 如何将这些开源工具集中到一个 PRADS 	NFSend | 	MDL 
挑战: 如何将这些开源工具集中到一个 PRADS 	NFSend | 	MDL 
挑战: 如何将这些开源工具集中到一个 PRADS 	NFSend |
|---|---|---|---|
| OVALdi  |P0F  |PADS  |平台？ |
| OVALdi  |OpenFPC |OpenFPC |平台？ |
OSSIM架构
|  | 从架构上来看，OSSIM系统是一 个开放的框架，它的核心价值在 |  |
|---|---|---|
|  |于创新的集成各开源软件之所长， | ||---|---|---|
|  |于创新的集成各开源软件之所长， | |
|  |OSSIM WebUI主要采用B/S架构与 C/S混合架构，Web服务器使用 Apache。 | |
| OSSIM架构 | OSSIM架构 |  |
|---|---|---|
| 嵌入工具 |嵌入工具 | |
|  |资产发现:   Nmap, Prads  | |
|  |异常行为监控: Netflow, Ntop, Nagios  | |
|  |威胁检测:  Snort, Suricata, OSSEC  | |
|  |漏洞评估: OpenVas  | |
| 扩展插件:  |扩展插件:  | |
|  |Syslog | |
|  |WMI | |
|  |SDEE | |
|  | | |
基于插件的集中数据采集
| 消息总线 | 消息总线 |
|---|---|| 消息总线 | 消息总线 |
|---|---|
|  |Message BUS 消息总线：供其它组件共享(关联引擎、报表、工作流、存储 |
等),已实现 OSSIM 组件间的通信。
| 插件管理 |  |  |
|---|---|---|
|  | | |
|  | | |
OSSIM插件组成
| OSSIM分层模型 | OSSIM分层模型 |  |  |
|---|---|---|---|
|  |第一层：数据源，体现安全事件来源， | | |
| 入侵检测、防火墙等。 |入侵检测、防火墙等。 | | |
|  |第二层，处理层，主要功能是安全事件 | | |
| 的集中并对集中后的事件进行关联分析、 |的集中并对集中后的事件进行关联分析、 | | |
| 风险评估及严重性标注等。 |风险评估及严重性标注等。 | | || 风险评估及严重性标注等。 |风险评估及严重性标注等。 | | |
|  |第三层，Web框架(Framework)，控制台 | | |
| 界面即OSSIM的Web UI  |界面即OSSIM的Web UI  | | |
|  | | | |
| 归一化处理流程 | 归一化处理流程 |  |
|---|---|---|
| 几个典型字段： |几个典型字段： | |
|  |Alarm           报警名称 | |
|  |Event id        安全事件编号 | |
|  |Sensor  id:     发出事件的传感器编号 | |
|  | Source IP :src_ip   安全事件源IP地址 | |
|  | Source Port :src_port安全事件源端口 | |
|  | Type       类型，type类型分为两类一类 | ||  | Type       类型，type类型分为两类一类 | |
| 是detector，另一类是monitor  |是detector，另一类是monitor  | |