without leading zeros.
Effect Size (w)
0.721
0.793
0.622
0.574
0.600
6.009
0.595
0.519
0.530
2.929
0.675
0.512
0.522
0.500
1.327
0.478
8.138
0.664
Service
Google
Google
Instagram
Instagram
Instagram
Jamba
LINE
LINE
LINE
Microsoft
Odnoklassniki
Origin
QQ
SMSGlobal
Talk2
Telegram
Viber
WeChat
Alibaba
Backslash
Baidu
BeeTalk
Circle
Gett
Google
Hushmail
LINE
Origin
RunAbove
Skout
Tuenti
Weibo
WhatsApp
Uniform?


















(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
(cid:2)
p-value
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.000
0.988
0.325
0.015
0.595
0.080
0.461
0.917
0.527
0.698
0.086
0.427
0.004
0.981
0.395
0.022
Effect? Mean Code
547948
Large
558380
Large
503172
Large
498365
Large
497936
Large
Large
4719
5476
Large
5530
Large
5442
Large
357494
Large
433997
Large
502627
Large
Large
505555
5540
Large
5732
Large
54961
Medium
112075
Large
4989
Large
548652
556223
505165
544719
506514
5512
501623
503161
5511
500739
494697
5492
5010
512458
543563
TABLE V: The results of our statistical analysis of authenti-
cation codes from each service. Some services appear more
than once in the data because their messages were split into
multiple clusters (e.g., one for password resets and one for
logins).
the above chi-square test, the service’s codes each generate a
speciﬁc pattern. We mapped the ﬁrst two digits of each code
with the back two digits and show these two services’ codes
in Figure 3.
WeChat. Until April 2015, WeChat’s authentication codes
followed a pattern of rand() ∗ 16 mod 10000, which caused
the stair-step offset-by-16 heatmap in Figure 3a. The pattern
could be explained by a random number generator with low
entropy in the four least signiﬁcant bits. This effectively
reduced the possible space of 4-digit codes to 625. In April
2015, WeChat changed its code generation algorithm. We re-
moved the 625 known-pattern codes from the WeChat set and
recomputed the chi-square entropy test. The p-value increased
to 0.761 with statistical power and effect size of 0.989 and
0.423, respectively, indicating that the new algorithm is likely
producing uniformly-random codes.
Talk2. This service has an extreme lack of entropy in its
code-generation algorithm, as seen in Figure 3b. In particular,
it appears to avoid digits 0, 1, 2, 5, and 8 in positions 1 and 3
of a 4-digit code. We made several attempts to reproduce this
entropy pattern, but we were unable to produce a reasonable
explanation for this dramatic reduction in entropy.
Google. While the Google codes we harvested did not appear
to be uniformly-random in our experiments, this appears to be
caused by duplicate codes. When requesting that a code be
resent, Google will send the same code again. This practice
is potentially problematic because it indicates that the Google
codes have a long lifetime. Since messages on gateways may
be accessible for weeks or months, it may be possible for an
adversary that can identify the associated account to use an
unclaimed code. Without access to the associated accounts,
however, we were unable to determine the exact lifetime of
Google’s codes.
LINE. Although our experiments show LINE’s codes are
348348
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:13:22 UTC from IEEE Xplore.  Restrictions apply. 
the service does not generate
likely uniformly generated,
codes with a leading zero, reducing the overall space of
codes by 10%. This practice is common among our clusters,
with 13 total clusters exhibiting this behavior. For comparison,
we display LINE’s codes in Figure 3c.
C. Takeaways
In this section, we explored the data that is exposed in
the SMS channel for benign purposes. This is problematic
if an adversary has access to SMS messages, as is the case
with the gateways. We observed services that expose sensitive
user data via SMS including ﬁnancial data, account informa-
tion, password reset URLs, and personal information such as
physical and e-mail addresses. We then found that 65% of
services that use SMS to deliver codes generate low-entropy
codes, which may be predictable and grant unauthorized
access to accounts. The design of such services is guided by
an assumption that the SMS channel is secure from external
observation, and our observations show that this results in poor
security design in those applications.
VI. ABUSES OF SMS
Having explored how services attempt to use SMS as a
secure channel, we now discuss what we observed about
the security implications and evidence of abuse related to
gateway activity. This includes phone veriﬁed account evasion,
failed attempts at location anonymity, whether similar gateway
numbers can be detected, and spam and fraud in the messages
themselves.
A. Gateways and PVA
In this subsection, we discuss the relevance of our data to
phone-veriﬁed accounts. In particular, we present evidence
that
the primary activity of the gateways we observe is
evading phone veriﬁed account restrictions, and that existing
countermeasures are ineffective.
g) Message Activity Statistics: In Section IV, we noted
that more than half of the messages received by gateways
are related to account veriﬁcation. This vastly outweighed
any other purpose of sending SMS. Beyond this information,
message activity statistics also support this claim. The median
number lifetime (the time from ﬁrst message to last) in our
dataset is 20 days, and the CDF of number lifetime is shown
in Figure 4a. This lifetime is fairly short, and in fact 73.9%
of numbers do not even last a full billing cycle (31 days).
There are two likely explanations for the short lifetime:
one is that services that facilitate PVA need to replace their
numbers often as they exhaust their usefulness to create new
accounts. The second is that many of these numbers are in
carriers (especially mobile carriers) that shut off numbers
for anomalous message volume. These explanations are not
necessarily mutually exclusive.
To gain insight onto this question, we computed the daily
volume of messages for each phone number used by a gateway,
and we call this series the “daily activity” of the number. If
these numbers were being primarily for personal messages or
informational activities (like signing up for advertising alerts),
we would expect the daily activity of the number to be fairly
constant across the lifetime of the number, or for there to be
a “ramp up” period as new users discover the new line.
Instead, we see almost
the exact opposite behavior. To
concisely express this, we computed skewness and kurtosis
statistics of the daily activity of every number. Simply, kurtosis
is a statistic that indicates if a series is “ﬂat” or “peaky,” while
skewness indicates whether a peak falls closer to the middle,
beginning, or end of a series. A skew of between (−1, 1)
indicates the peak falls in the middle of the series, while a
positive skew indicates a peak that arrives “earlier” in the
series. We plot the skewness and kurtosis for every number in
Figure 4b. Note that we reverse the x-axis, so that the further
left in the plot a number falls, the “earlier” its peak.
Figure 4c shows the CDF of the daily activity skew, and
we observe that approximately 60% of numbers have a skew
towards early activity. This implies that most numbers have a
high message volume early in the lifetime, and consequently,
most of the activity of the number has been completed by
the time it is shut down. If carriers are disabling numbers
(for exceeding a message rate cap, for example), they are
doing so well after most numbers have seen their peak use.
Likewise, if online services are considering a number invalid
for phone veriﬁcation, they are still permitting a high-volume
of registration requests for a number (in aggregate) before
blacklisting the number.
h) User Location Leakage: Some gateways advertise
their services towards users that may be seeking privacy or
anonymity. Although SMS does not provide either of these
properties,
the use of a gateway may provide a sense of
anonymity for a user registering for a service. Shortened
URLs (often provided in space-constrained SMS messages)
leak information about the user clicking the link to the URL-
shortening service. With the statistics we collected from these
services, we have identiﬁed both the source and destination
countries for each message, we also found that the users of
these services are located in signiﬁcantly different locations.
We do not attempt to deanonymize, track, or identify any users.
Our data consists solely of publicly-available aggregate click
statistics.
The number of clicks recorded ranged from 0–1,582,634
with a median of 10. This data represents any click to these
URLs, not just those from the gateway pages. As a result, to
prevent skewing our data with popular and spam messages, we
focused on URLs with ≤ 10 clicks, since many incoming links
expected by users of SMS gateways are likely clicked a small
number of times. We collected the countries associated with
each of the remaining 2,897 clicks and aggregated the results.
Figure 5c shows the total clicks for each country across all
shortened URLs. 194 clicks could not be mapped because the
speciﬁc country information was not available or the service
identiﬁed that the request was from an anonymizing proxy
service.
Also in our data were “test” messages sent by users testing
the services. These messages provide another window into
349349
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:13:22 UTC from IEEE Xplore.  Restrictions apply. 
(a) CDF: Number Lifetime
(b) Daily Activity Skew and Kurt
(c) CDF: Daily Activity Skew
Fig. 4: (a) Only 25% of gateway-controlled numbers are used after one month. The median number lifetime is only 20 days.
(b) The skew and kurtosis of number lifetime indicates that 60% of messages have a signiﬁcant skew towards heavier use at
the beginning of the lifetime, while the kurtosis indicates that these numbers see a sharp increase in activity followed by steep
decline. (c) 60% of numbers used show a strong tendency for heavy use in the early lifetime of the number.
the user base. Figure 5b and Table XI in the appendix show
that the geographical extent of these users goes well beyond
the home countries of gateway numbers. Users of gateways
may not be aware that these URLs and messages are leaking
metadata, and gateways do not adequately warn users of this
danger. We consider the use of a gateway as an anonymizing
service to be a subset of PVA evasion, however, because users
are attempting to evade phone veriﬁcation, albeit for a different
intent.
B. Detecting Gateways
As we have discussed above, these gateways facilitate PVA
evasion and the demographic data we can obtain about the
users of these services clearly shows usage patterns consistent
with PVA fraud. It is clear that in most cases even reputable
well-funded online services are not successfully defending
against
these (and similarly, for-pay gateways). Although
number lifetimes are short, the sheer volume of veriﬁcation
messages in our data indicates that evasion is still an effective
driver of proﬁt for gateways.
PVA evasion is not new to online services. In particular,
Google is acutely aware of this problem, having published a
paper on the topic [72]. In that paper, Thomas et al. propose
several strategies to detect PVA evasion. They include blocking
irreputable carriers, restricting how quickly numbers can verify
accounts, and phone re-veriﬁcation. In this section we explore
the recommendations in [72] and discuss how our data shows
that these recommendations are unlikely to be effective:
Carrier Reputation. While we only see one of the carriers
identiﬁed as abuse-prone in [72] (bandwidth.com), black-
listing blocks of numbers by carrier would not stop all PVA
evasion. Carrier-based blocking is prohibitively expensive for
all but the largest of organizations. We obtained Twilio data
for each number in our data set and although the cost was
relatively small ($0.005/lookup), scaling this (and additional
number metadata such as CNAM and HLR data) to cover
all of a business’s customers represents a substantial cost.
to
Furthermore,