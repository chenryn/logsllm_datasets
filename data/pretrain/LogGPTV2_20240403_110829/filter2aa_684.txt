APK 流量转发保姆级教程 
作者：lings- 时间：2021/10/02 
目  录 
绪  论 ............................................................................................................... 1 
第 1 章 Burpsuite 证书安装 ........................................................................... 2 
1.1 导出 burpsuite 证书 ............................................................................ 2 
1.2 将 Burpsuite 证书放置于 Apache2 服务器 ....................................... 3 
1.3 下载证书并将证书导入 system 证书目录 ........................................ 3 
1.4 若提示权限不足，则执行如下命令获取 root 权限。 .................... 5 
第 2 章 Clash 软件安装及配置 ...................................................................... 6 
2.1 下载 Clash ........................................................................................... 6 
2.2 编辑配置文件 ..................................................................................... 6 
2.2.1 文件内容 ................................................................................... 6 
2.2.2 文件格式及修改 ....................................................................... 6 
2.3 安装 Clash ........................................................................................... 6 
2.4 配置 Clash ........................................................................................... 6 
2.4.1 拖入夜神模拟器导入 ............................................................... 6 
2.4.2 Apache2 服务器下载导入 ......................................................... 6 
2.5 设计全局代理 ..................................................................................... 6 
2.6 设置抓取单个 APP 流量 .................................................................... 6 
第 3 章 Proxifier 代理配置 ............................................................................ 7 
3.1 配置 Windows 全局代理 .................................................................... 7 
3.2 添加安卓模拟器流量转发 ................................................................. 8 
3.3 Windows 不能上网 .............................................................................. 8 
APK 流量转发保姆级教程 lings- 2021/10/02 
1 
绪  论 
教程共有两种方案，一种使用 proxifier 对安卓模拟器的流量进行代理，以实现安
卓全局代理的目的。一种使用 clash 对安卓 APP 进行流量转发，以实现系统级的全局
代理或单个 APP 的代理。 
两种方案均需将 burpsuite 证书安装于系统目录，故而均需安卓 root 权限。 
本次教程以夜神模拟器为主，优先讲解如何使用 adb 模式安装 burpsuite 证书。p
roxifier 代理所需内容与软件有 burpsuite、proxifier、夜神模拟器。Clash 代理所需内
容与软件有 burpsuite、clash、夜神模拟器。 
应注意的是，proxifier 无法实现对于某一个 APP 流量的捕获，相当于是安卓系统
层面的代理。Clash 则会出现浏览器访问网站提示证书错误的情况。 
APK 流量转发保姆级教程 lings- 2021/10/02 
2 
第1章 Burpsuite 证书安装 
1.1 导出 burpsuite 证书 
在导出前建议在 Proxy—>Options—>Add 页面新建局域网代理端口，如下图所
示。 
随后点击 Import / expoet CA certificate 选择 Certificate in DER format 导出 C
A 证书并保存到某一文件夹，如下图所示。 
APK 流量转发保姆级教程 lings- 2021/10/02 
3 
1.2 将 Burpsuite 证书放置于 Apache2 服务器 
启动 Apache2 服务器，将文件上传至 Apache2 服务器，如下图所示。 
证书准备完毕。 
1.3 下载证书并将证书导入 system 证书目录 
启动夜神模拟器，打开浏览器，访问 Apache2 服务器下载证书至 Download 目录。
如下图所示 
APK 流量转发保姆级教程 lings- 2021/10/02 
4 
使用 win+R，唤起 cmd 窗口或 powershell 窗口，切换目录至夜神模拟器安装目
录。如下图所示。（cmd 窗口用 dir 切换目录，powershell 使用 cd 切换目录） 
进入 bin 目录，nox_adb.exe 即为夜神模拟器 adb 模式端口。 
使用.\nox_adb.exe 执行如下命令。 
.\nox_adb.exe root 
.\nox_adb.exe remount 
.\nox_adb.exe shell 
APK 流量转发保姆级教程 lings- 2021/10/02 
5 
Cd 进入 sdcard/Download/目录，查看目录文件内容（TAB 补全对大小写敏感）。 
若目录存在 cacert.der 则执行如下命令，把证书文件复制到手机/模拟器的系统证
书文件夹，并设置 644 权限 
mv cacert.der 9a5ba575.0 
mv /sdcard/Download/9a5ba575.0 /system/etc/security/cacerts/ 
chmod 644 /system/etc/security/cacerts/9a5ba575.0 
若执行成功则证书安装完毕。 
重启安卓系统 
1.4 若提示权限不足，则执行如下命令获取 root 权限。 
.\nox_adb.exe root 
.\nox_adb.exe remount 
若依然提示权限不足，则检查夜神模拟器是否开启开机 root。 
APK 流量转发保姆级教程 lings- 2021/10/02 
6 
第2章 Clash 软件安装及配置 
2.1 下载 Clash 
Github 地址：https://github.com/Kr328/ClashForAndroid 
2.2 编辑配置文件 
2.2.1 文件内容 
见附件。 
2.2.2 文件格式及修改 
Yaml 后缀格式文件。192.168.1.250 为 Burpsuite 的 IP 地址，8080 为 Burpsuite 的
监听端口，均可自行修改。 
2.3 安装 Clash 
将下载好的 APK 软件包拖入夜神模拟器页面即可，配置文件也可托入。 
2.4 配置 Clash 
2.4.1 拖入夜神模拟器导入 
打开 Clash—>配置—>右上角加号—>从文件导入—>浏览文件—>右侧三个点—>
导入—>左侧选择栏 Amaze—>主目录—>Pictures—>xxx.yaml 
2.4.2 Apache2 服务器下载导入 
打开 Clash—>配置—>右上角加号—>从文件导入—>浏览文件—>右侧三个点—>
导入—>左侧选择栏 Amaze—>主目录—>Download—>xxx.yaml 
2.5 设计全局代理 
保存导入后选选中配置—>返回—>启动—>代理—>选择 http，即可全局代理抓
包。 
2.6 设置抓取单个 APP 流量 
停止运行代理，选择设置—>网络—>访问控制模式—>仅允许已选择的应用 
设置—>网络—>访问控制包列表—>选择需要代理抓包的应用。 
APK 流量转发保姆级教程 lings- 2021/10/02 
7 
第3章 Proxifier 代理配置 
可能安全的下载链接：http://www.hanzify.org/software/13717.html  
3.1 配置 Windows 全局代理 
配置文件—>代理服务器—>添加—>HTTPS—>默认情况下使用 
配置文件—>代理规则—>将 Localhost 的动作设置为代理，如下图所示。 
确认后打开夜神模拟器，使用浏览器任意打开某一网站，则出现流量拦截提示。 
APK 流量转发保姆级教程 lings- 2021/10/02 
8 
根据流量拦截情况，推测 NoxVMHandle.exe *64 即为夜神模拟器流量出口。 
3.2 添加安卓模拟器流量转发 
配置文件—>代理规则—>两个规则设置为 Direct。 
配置文件—>代理规则—>添加 
复制 NoxVMHandle.exe 到应用程序，配置动作和名称如图。 
使用夜神模拟器打开任意网站，若出现拦截提示，即为配置成功。 
3.3 Windows 不能上网 
检查配置文件—>代理规则，除安卓模拟器代理，是否均设置为 Direct 
APK 流量转发保姆级教程 lings- 2021/10/02 
9 
附件一： 
mixed-port: 7890 
allow-lan: false 
mode: global 
log-level: info 
external-controller: 127.0.0.1:9090 
proxies: 
  # http 
  - name: "http" 
    type: http 
    server: 192.168.1.250 #burpsuit IP 
    port: 8080 #burpsuite port 
    # username: username 
    # password: password 
    # tls: true # https 
    # skip-cert-verify: true 
    # sni: custom.com 
proxy-groups: 
  - name: Proxy 
    type: select 
    # disable-udp: true 
    proxies: 
      - http