wiﬁ devices by a factor of 5 and predict large scale epi-
demics, but the short range of bluetooth again implies
slower, mobility-based spread. Cole et al. [25] use epi-
demic models and simulations to discuss requirements
for worm mitigation in tactical battleﬁeld MANETS.
Stamm et al. [49] discuss remote attacks on routers
that can be used for large-scale pharming and can also
spread viraly. We, too, discuss pharming as one of the
potential abuses of dense, weak wiﬁ deployments – ex-
ploitable in a different way but to a similar extent.
USENIX Association
16th USENIX Security Symposium
335
Mickens and Noble [43] propose a framework called
probabilistic queuing to model the epidemic spreading in
mobile environment, which aims to treat node mobility
as top priority. Their simulations showed that the proba-
bilistic queuing model could achieve more accurate pre-
diction than standard Kephart-White framework in many
cases. However, this work assumes random waypoint
model for user movement and does not take into account
realistic user mobility patterns.
Henderson et al. [33] analyzed extensive network
traces from mature corporate WLANs and various uni-
versity campuses and observed dramatic changes in wire-
less usage. Indeed, all these changes are favorable for the
spread of a wiﬁ worm. First, users now run a wide vari-
ety of applications such as peer-to-peer, multimedia and
VoIP services, instead of the dominance of web trafﬁc so
there are higher chances of a worm exploitable vulnera-
bility. Local trafﬁc in the WLAN exceeds remote trafﬁc,
i.e. users within the same organization exchange data
more than before. This would help the worm to detect
and probe all wireless neighbors within its reach. The
study also shows that wireless users are also surprisingly
non mobile, half of which remain at home for 98% of
time.
In a similar approach, Hsu and Helmy [34] found that
there exists a preference of wireless user association:
most users only visit a small portion of access points,
i.e.
the ratio of visited access points hardly changes
even though popularity of WLANs increases by years –
this is invariant user characteristics. There is a repeti-
tive pattern of user association over days, i.e.
there is
a high probability that a user reappears at the same ac-
cess point at a certain time every day. This is quanti-
ﬁed as ”network similarity index”. Therefore a mobile
worm could distinguish itself from traditional internet
worm by self-activating at the time where most mobile
users are active. This is also contrary to the general as-
sumption and over-simpliﬁcation that users are always
ON with no preference on association patterns; conven-
tional randomly generated synthetic mobility models are
insufﬁcient. Another recent trend is that a mobile node
stays online on average 87.68% of its life (i.e. its exis-
tence in the wireless network). That is to say, people now
tend to use WLAN as a replacement for wired network
and keep their laptops constantly connected (instead of
old style of establishing only when needed). A modern
paradigm shift from WLAN as temporary connection to
always-on permanent connection. Macro mobility: users
have small converage in all environments (campus + cor-
porate): typically only associate with 1.1% to 4.52% of
total APs in their corporation. Each user has very few
APs where it spends most of its online time.
Blinn et al. [21] monitored ﬁve weeks of Verizon wiﬁ
hotspot network in Manhattan. They observed that far
more cards associated to the network than logged into it.
Most clients used the network infrequently and visited
only few APs. Therefore hotspot are ”locations visited
occasionally” rather than ”primary places of work”.
Kim et al. [37] extracted a mobility model from real
user traces. Speed and pause time follow log-normal dis-
tribution and direction of movements closely related to
road directions. Again, most of laptop clients are NOT
very mobile, so this paper relied on VoIP users to extract
mobility model. The type of mobile device being used
can inﬂuence its user’s mobility: a laptop would tend to
tie its user to his workplace whereas a PDA/VoIP user
would move as he would normally. The reasons could
be due to weight, size and nature of use of the device.
A mobility model for laptop users should reﬂect relative
weightage of immobility and mobility.
Staniford et al. [51] describe the risk to the Internet
due to the ability of attackers to quickly gain control of
vast numbers of hosts. They argue that controlling a mil-
lion hosts can have catastrophic results because of the po-
tential to launch distributed denial of service (DDoS) at-
tacks and access any sensitive information that is present
on those hosts. Their analysis shows how quickly attack-
ers can compromise hosts using “dumb” worms and how
“better” worms can spread even faster.
In subsequent
work [50], the same authors show how a worm using pre-
compiled lists of IP addresses known to be vulnerable
can infect one million hosts in half a second. They also
envision a Cyber “Center for Disease Control” (CCDC)
for identifying outbreaks, rapidly analyzing pathogens,
ﬁghting the infection, and proactively devising methods
of detecting and resisting future attacks. The metropoli-
tan wiﬁ environment offers another opportunity for at-
tacks to occur that may not be covered by defenses built
for Internet worms. Our work also provides estimates of
propagation speed similar to the above studies.
The issue of location privacy in a wireless setting has
been examined in literature [35, 16, 31]. These system
focus attention on protecting physical location privacy
based against signal triangulation techniques and pro-
tecting against source location in sensor networks. More
closely related to our work, is the work by Gruteser et al
[32]. The authors introduce the idea of short-lived dis-
posable MAC addresses as a technique for the reduction
of the effectiveness of location tracking. Our work shows
that even in the presence of such techniques, user proﬁl-
ing can effectively track users in dense urban environ-
ments. Saponas et al. [47] describe a prototype surveil-
lance system that can track people wearing the widely
available Nike+iPod sensors. Tracknets could be ex-
ploited in similar scenarios to track people carrying any
type of device whose trafﬁc can be observed by wiﬁ re-
ceivers, such as wiﬁ-enabled smart-phones.
336
16th USENIX Security Symposium
USENIX Association
7 Concluding remarks
Acknowledgments
The increasing use of wireless technology and particu-
larly wiﬁ is likely to soon attract the attention of attack-
ers, as attackers evolve and explore ways to exploit new
technology to their advantage. This paper discusses a
range of “modern” threats speciﬁcally tailored to metro-
area wireless networks: wildﬁre worms that spread topo-
logically due to infected hosts being able to carry the
worm from one wireless LAN to another; large-scale
wireless spooﬁng attacks that can be highly effective for
phishing and spam campaigns; and malicious Tracknets
that proﬁle and track the whereabouts of wiﬁ users. Such
threats are greatly ampliﬁed by the increasingly dense
deployment of wiﬁ Access Points, and by the limited use
of wireless security mechanisms such as 802.11i. Our re-
sults suggest that the density of large metropolitan areas
has a profound impact on the severity of the threat.
Some speciﬁc contributions of this work include the
modeling of fast, proximity-based worm propagation in
metropolitan areas using real data from wardriving maps,
wiﬁ worm propagation using browser vulnerabilities,
retroﬁtting of reactive mechanisms for wireless worm
detection, spooﬁng defenses that are easy to implement,
discussion of the whisper attack and defenses, and using
RSS feeds to track users.
Our primary intention with this study is to raise aware-
ness on the threats of wireless networks, speciﬁcally in
densely populated areas, and to explore possible counter-
measures. Much of the problem lies in the limited use of
802.11i. The wider deployment of 802.11i would reduce
the risks signiﬁcantly, but it would not completely elim-
inate them. More speciﬁcally, it would counter several
instances of the spooﬁng threat; but it would only slow
down, rather than mitigate wildﬁre worms; and it would
not by itself eliminate the Tracknet threat, as MAC ad-
dresses remain unencrypted in 802.11i and other means
of proﬁling may be possible.
Perhaps one of the main reasons behind the limited
adoption of 802.11i is poor usability, as it involves con-
ﬁguration, and, once again, burdening users with yet
another set of passwords or keys. Wider adoption re-
quires convincing users that the extra trouble is worth
it, by raising awareness on the risks of keeping wireless
LANs open and unencrypted. We hope that our study
contributes to this cause.
Improving usability of wireless security standards, if
feasible, is another path to improving adoption, but until
such adoption is achieved and to counter the remaining
threats, we have also suggested a variety of countermea-
sures, which we have implemented and evaluated exper-
imentally. Users may want to guard themselves against
threats such as those described here, without having to
take the cost of closing down their network using 802.11i
or WEP.
We thank S.P.T. Krishnan for assisting with the vulner-
ability exposure analysis, and K. Xinidis for his imple-
mentation of the basic OpenWRT-based defense infras-
tructure. We also thank Jonathan M. Smith, Pat Lincoln,
Phil Porras, Angelos Keromytis, Michalis Polychron-
akis, Michael Nguyen and Lee Han Boon for extremely
valuable discussions and feedback on this effort.
References
[1] Aircrack: a set of tools for auditing wireless networks. http:
//freshmeat.net/projects/aircrack/.
[2] DShield.org, Distributed Intrusion Detection System. http://
www.dshield.org.
[3] Honeynet project. http://www.honeynet.org.
[4] National vulnerability database, united states. http://nvd.
nist.gov.
[5] OpenWRT Project. http://openwrt.org/.
[6] Securityfocus.com,
securityfocus.com/vulnerabilities.
vulnerabilities.
http://www.
[7] UMich wireless usage. http://www.itcom.itd.umich.
edu/wireless/stats/yr2006/02/campus.html.
[8] WEP: Dead Again. http://www.securityfocus.com/
infocus/1814#aircrack.
[9] Wiﬁtap: proof of concept for communication over WiFi networks
using trafﬁc injection. http://sid.rstack.org/index.
php/Wifitap_EN.
[10] Wireless Geographic Logging Engine. http://www.wigle.
net/.
http:
[11] A year of bugs. http://bcheck.scanit.be/bcheck/
page.php?name=STATS2004&page=3.
[12] The Spread of
the Sapphire/Slammer Worm.
//www.caida.org/publications/papers/2003/
sapphire/sapphire.html, February 2003.
[13] WMF exploitation.
http://www.f-secure.com/
weblog/archives/archive-122005.html, Dec. 2005.
[14] E. Anderson, K. Eustice, S. Markstrum, M. Hanson, and P. Rei-
her. Mobile contagions: Simulation of infection and disease. In
Symposium on Measurement, Modeling, and Simulation of Mal-
ware, June 2005.
[15] W. A. Arbaugh, N. Shankar, and Y. J. Wan. Your 802.11 wireless
network has no clothes. In IEEE Wireless Communications, 2001.
[16] P. Bahl and V. N. Padmanabhan. RADAR: An in-building RF-
based user location and tracking system. In Proceedings of the
19th Annual Joint Conference of the IEEE Computer and Com-
munications Societies (INFOCOM), pages 775–784, 2000.
[17] M. Bailey, E. Cooke, F. Jahanian, J. Nazario, and D. Watson.
The Internet Motion Sensor: A Distributed Blackhole Monitor-
In Proceedings of the 12th ISOC Symposium on
ing System.
Network and Distributed Systems Security (SNDSS), pages 167–
179, February 2005.
[18] R. Beverly and S. Bauer. The spoofer project: Inferring the ex-
In Proceedings
tent of source address ﬁltering on the internet.
of USENIX Steps to Reducing Unwanted Trafﬁc on the Internet
(SRUTI) Workshop, pages 53–59, July 2005.
[19] R. A. Beyah, C. L. Corbett, and J. A. Copeland. The case for
collaborative distributed wireless intrusion detection systems. In
IEEE International Conference on Granular Computing, May
2006.
USENIX Association
16th USENIX Security Symposium
337
[20] A. Bittau, M. Handley, and J. Lackey. The ﬁnal nail in wep’s
In SP ’06: Proceedings of the 2006 IEEE Symposium
cofﬁn.
on Security and Privacy (S&P’06), pages 386–400, Washington,
DC, USA, 2006. IEEE Computer Society.
[21] D. P. Blinn, T. Henderson, and D. Kotz. Analysis of a Wi-Fi
hotspot network. In Proceedings of the International Workshop
on Wireless Trafﬁc Measurements and Modeling, June 2005.
[22] N. Borisov, I. Goldberg, and D.Wagner. Intercepting mobile com-
munications: The insecurity of 802.11. In Proceedings of ACM
Mobicom, Rome, Italy, July 2001.
[23] S. Byers, L. F. Cranor, D. P. Kormann, and P. D. McDaniel.
Searching for privacy: Design and implementation of a P2P-
enabled search engine.
In D. Martin and A. Serjantov, editors,
Privacy Enhancing Technologies, volume 3424 of Lecture Notes
in Computer Science, pages 314–328. Springer, 2004.
[24] J. Cache and D. Maynor. Device drivers. Presentation at Blackhat
USA 2006, August 2006.
[25] R. G. Cole, N. Phamdo, M. A. Rajab, and A. Terzis. Require-
ments on worm mitigation technologies in MANETS. In PADS
’05: Proceedings of the 19th Workshop on Principles of Ad-
vanced and Distributed Simulation, pages 207–214, Washington,
DC, USA, 2005. IEEE Computer Society.
[26] T. Espiner. Does Wi-Fi security matter? http://news.com.
com/2100-1029_3-6088741.html.
Cabir worm description.
[27] F-Secure.
f-secure.com/v-descs/cabir.shtml, June 2004.
http://www.
[28] F-Secure.
Data Security Summary -
January to June
http://www.f-secure.com/2005/1/
2005.
data-security-summary-2005_1.pdf, 2005.
[29] F-Secure.
http:
//www.f-secure.com/v-descs/inqtana_a.shtml,
Feb. 2006.
Inqtana.A worm information.
[30] S. Fluhrer, I. Mantin, and A. Shamir. Weaknesses in the key
scheduling algorithm of RC4. In Lecture Notes in Computer Sci-
ence, 2259:124, 2001.
[31] B. Gedik and L. Liu. Location privacy in mobile systems: A per-
sonalized anonymization model. In ICDCS ’05: Proceedings of
the 25th IEEE International Conference on Distributed Comput-
ing Systems (ICDCS’05), pages 620–629, Washington, DC, USA,
2005. IEEE Computer Society.
[32] M. Gruteser and D. Grunwald. Enhancing location privacy in
wireless LAN through disposable interface identiﬁers: a quanti-
tative analysis. Mob. Netw. Appl., 10(3):315–325, 2005.
[33] T. Henderson, D. Kotz, and I. Abyzov. The changing usage
In Proceedings of
of a mature campus-wide wireless network.
the Tenth Annual International Conference on Mobile Comput-
ing and Networking (MobiCom), Sept. 2004.
[34] W.-J. Hsu and A. Helmy. On modeling user associations in wire-
less LAN traces on university campuses. In Proceedings of the
Second Workshop on Wireless Network Measurements (WiNMee
2006), Apr. 2006.
[35] Hu and Wang. Framework for location privacy in wireless net-
works. In ACM SIGCOMM Asia Workshop, 2005.
[36] M. Hypponen. WLAN viruses, anyone?
http://www.f-secure.com/weblog/archives/
archive-082006.html, August 2006.
F-Secure weblog.
[37] M. Kim, D. Kotz, and S. Kim. Extracting a mobility model from
real user traces. In Proceedings of the 25th Annual Joint Confer-
ence of the IEEE Computer and Communications Societies (IN-
FOCOM), Apr. 2006.
[38] B. Krebs.
2005 patch times
for Firefox and In-
Washington Post weblog. http:
ternet Explorer.
//blog.washingtonpost.com/securityfix/2006/
02/2005_patch_times_for%_firefox_a.html, Feb.
2006.
[39] B. Krebs. Internet Explorer unsafe for 284 days in 2006. Wash-
ington Post weblog. http://blog.washingtonpost.
com/securityfix/2007/01/internet_explorer_
un%safe_for_2.html, Jan. 2007.
[40] N. Leavitt. Mobile Phones: The Next Frontier for Hackers? IEEE
Computer, 38(4), April 2005.
[41] C. Martel and V. Nguyen. Analyzing Kleinberg’s (and other)
small-world models. In PODC ’04: Proceedings of the twenty-
third annual ACM symposium on Principles of distributed com-
puting, pages 179–188, New York, NY, USA, 2004. ACM Press.
[42] R. McMillan. Researchers hack wi-ﬁ driver to breach laptop. In-
foWorld. http://www.infoworld.com/article/06/
06/21/79536_HNwifibreach_1.html, June 2006. Ac-
cessed on September 15th, 2006.
[43] J. Mickens and B. Noble. Modeling epidemic spreading in mobile
environments. In Proceedings of the ACM Workshop on Wireless
Security, pages 77–96, 2005.
[44] S. Milgram. The small world problem.
1967.
In Psychology Today,
[45] G. Portokalidis, A. Slowinska, and H. Bos. Argos: an emula-
In Proc. ACM SIGOPS
tor for ﬁngerprinting zero-day attacks.
EUROSYS’2006, Leuven, Belgium, April 2006.
[46] M. Roesch. Snort: Lightweight intrusion detection for networks.
(software
In Proceedings of USENIX LISA, November 1999.
available from http://www.snort.org/).
[47] T. S. Saponas, J. Lester, C. Hartung, and T. Kohno. Devices That
Tell On You: The Nike+iPod Sport Kit. Technical report, Depart-
ment of Computer Science and Engineering, University of Wash-
ington, 2007.
[48] C. Shannon and D. Moore. The Spread of the Witty Worm. IEEE
Security & Privacy, 2(4):46–50, July/August 2004.
[49] S. Stamm, Z. Ramzan, and M. Jakobsson. Drive-By Pharming.
Technical report, Indiana University, Dec. 2006.
[50] S. Staniford, D. Moore, V. Paxson, and N. Weaver. The Top Speed
of Flash Worms. In Proceedings of the ACM Workshop on Rapid
Malcode (WORM), pages 33–42, October 2004.
[51] S. Staniford, V. Paxson, and N. Weaver. How to 0wn the Inter-
net in Your Spare Time. In Proceedings of the USENIX Security
Symposium, pages 149–167, August 2002.
[52] J. Su, K. K. W. Chan, A. G. Miklas, K. Po, A. Akhavan, S. Saroiu,
E. de Lara, and A. Goel. A preliminary investigation of worm in-
fections in a bluetooth environment. In WORM ’06: Proceedings
of the 4th ACM workshop on Recurring malcode, pages 9–16,
New York, NY, USA, 2006. ACM Press.
[53] Symantec.
Internet Security Threat Re-
http://www.symantec.com/enterprise/
Symantec
port.
threatreport/index.jsp, Sept. 2006.
[54] Trend Micro. Botnet threats and solutions: Phishing - Whitepa-
per, Nov. 2006.
[55] A. Tsow, M. Jakobsson, L. Yang, and S. Wetzel. Warkitting: the
drive-by subversion of wireless home routers. Anti-Phishing and
Online Fraud, Part II Journal of Digital Forensic Practice, 1(3),
Nov. 2006.
338
16th USENIX Security Symposium
USENIX Association