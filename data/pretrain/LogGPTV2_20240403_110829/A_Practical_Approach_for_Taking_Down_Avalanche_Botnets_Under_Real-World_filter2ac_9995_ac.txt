blacklists [54], [81], [101]. Commercial providers publish lists
of the most popular websites that become base sets of seemingly
benign domains [56]. The service may be crawled to populate
search engine results or archive web content [37]: the latter
enables longitudinal analyses of malicious activity [12], [83],
[101]. These methods can be combined to calculate risk scores
for the domain [43].
L6. Service unavailability and domain expiration: The
unavailability of the services offered by the domain, either
intentionally or unintentionally due to misconﬁgurations, may
be detected by any of the previously discussed data sets
depending on the type of disruption. Once a domain is no
longer needed, it may expire: domains that are set to expire
are often monitored for drop-catching [39], i.e., registering
domains as rapidly after expiry as possible. Malicious actors
also reuse previously expired domains to capitalize on the
reputation of those domains [57], [97]. Alternatively, a service
may be interrupted or a domain may be made unavailable
for legal reasons, e.g., in takedown operations. As we study
domains before they would be taken down, we do not consider
this last step in our ﬁnal feature set.
B. General insights
We want to design features that exhibit contrasting prop-
erties of benign and malicious domains and therefore provide
a more accurate classiﬁcation, while still acting within the
constraints imposed by the Avalanche takedown use case (as
outlined in Section III-B). This requires insights into the generic
differences in behavior of legitimate and malicious actors with
respect to their domains. We choose our features to capture the
following three characteristics:
i1. Likelihood of collisions: Given that all domains
are algorithmically generated, our target is to ﬁnd “regular”
(least random) looking domains as they are more likely to be
a collision with a benign domain, which is opposite to other
work that focuses on detecting DGAs solely based on how
random their domain names appear [77], [78], [85], [96].
i2. Investment in the domain: Obtaining and (validly)
maintaining a domain requires an investment from its owner,
both monetary for paying the registration fee and in effort for
setting up DNS and WHOIS records correctly and installing
services attached to the domain. While benign owners value
their domains and are willing to make such an investment,
the opposite is true for malicious actors: they want to set up
6
a campaign with minimal cost and effort to maximize their
revenue. Certain indicators imply high investment, such as
long-term registration (benign domains tend to be older, while
malicious domains tend to be registered shortly before the start
of the validity period [19], [20], [36], [71]) or valid DNS and
WHOIS records (invalid, obfuscated or repeated values hint at
malicious practices [93]).
i3. Website popularity: Establishing a website that
attracts sufﬁcient trafﬁc and is therefore perceived as popular,
requires signiﬁcant effort in creating content and building
an audience. Website popularity is therefore an indication of
benignness: malicious actors will not make the effort of setting
up real websites on dormant domains, especially as it is not
required for the correct operation of botnets. Regular users
as well as web crawlers are also unlikely to end up on these
domains. Moreover, if the domain has not yet been generated
by a DGA, its trafﬁc is low or non-existent, so we can assume
that any trafﬁc that the domain draws is legitimate.
C. Summary of feature sets
We aim to capture the broadest view possible of the life
cycle of the domains to classify, and select the features and
the data sources that provide their values accordingly, further
inspired by our general insights. While potentially useful,
certain features are not applicable to our use case or would have
unwanted consequences for required data collection or wider
applicability of our approach. We elaborate on the reasons for
not retaining these features in Section IV-D.
Table IV gives a summary of the 36 features that we
compute. We distinguish between six feature sets: for each
feature set, we describe what it represents, which features it
includes, how it is obtained, and how complete its coverage
is. We indicate for each feature 1) whether it is binary or
continuous, 2) whether our intuition is that higher or true
values indicate a benign or malicious domain,1 3) which life
cycle step from Section IV-A it covers, and 4) which insight
from Section IV-B is illustrated.
For each domain, we know the start and end dates of their
validity period, i.e. when their respective DGA would generate
the domain. We also retrieve the date when a malware family
started being active from DGArchive [71], where available.
a) Two lexical features capture the linguistic structure
of the domain name. We compute the domain name length, as
shorter domains tend to be more popular and expensive, and
the ratio of digits in the domain name, as domains with more
digits tend to be less readable. Both features discard the TLD.
b) Seven popularity-based features capture whether a
domain hosts a website that appears to attract regular visitors.
Three features use data obtained through the Wayback Machine
API2: the number of unique pages captured on the domain, the
time between the ﬁrst capture of any page and the takedown,
and the time between this ﬁrst capture and the start of the AGD
validity period.
1Note that this is only an intuition—our classiﬁer can detect edge cases that
provide contrary evidence.
2https://archive.org/help/wayback_api.php
TABLE IV.
OVERVIEW OF THE FEATURES USED IN OUR CLASSIFIER. WE INDICATE WHICH OUTCOME (BENIGN OR MALICIOUS) A HIGHER OR TRUE VALUE
DENOTES AND HOW THE FEATURE COVERS THE DOMAIN LIFE CYCLE AND INSIGHTS.
Set
#
Description
Type
Outcome
Life cycle step
(Section IV-A)
Lexical
Popularity
CT
WHOIS
Passive DNS
Active DNS
1
2
3
4
5
6-9
10
11
12
13
14
15
16
17
18
19
20
21
22
23-29
30
31
32-36 Number of days DNS record was seen for resource records A, AAAA, MX, NS, SOA
Domain name length
Digit ratio
Number of pages found in Wayback Machine
Time between ﬁrst entry in Wayback Machine and takedown
Time between ﬁrst entry in Wayback Machine and start of malware validity period
Presence in Alexa, Majestic, Quantcast, and Umbrella top websites rankings
TLS certiﬁcate found in Certiﬁcate Transparency logs
Time between WHOIS creation date and start of AGD validity period
Time between WHOIS creation date and start of malware family activity
Time between WHOIS creation data and takedown date
Time between WHOIS creation date and WHOIS expiration date
Renewal of domain seen in WHOIS data
Domain uses privacy/proxy service
WHOIS registrant email is a temporary/throwaway email service
WHOIS registrant phone number is valid
Number of passive DNS queries
Time between ﬁrst and last seen passive DNS query
Time between ﬁrst seen passive DNS query and takedown
Time between ﬁrst seen passive DNS query and start of AGD validity period
Presence of passive DNS query for resource record: A, AAAA, CNAME, MX, NS, SOA, TXT Binary
Time between ﬁrst seen DNS record and takedown
Time between ﬁrst seen DNS record and start of AGD validity period
Continuous Malicious L1. Domain choice
Continuous Malicious L1. Domain choice
L5. Activity
Continuous Benign
L5. Activity
Continuous Benign
L5. Activity
Continuous Benign
L5. Activity
Benign
Binary
L4. Infrastructure
Binary
Benign
L2. Registration
Continuous Benign
L2. Registration
Continuous Benign
L2. Registration
Continuous Benign
L2. Registration
Continuous Benign
Benign
Binary
L2. Registration
Malicious L2. Registration
Binary
Malicious L2. Registration
Binary
L2. Registration
Binary
Benign
L5. Activity
Continuous Benign
L5. Activity
Continuous Benign
Continuous Benign
L5. Activity
L5. Activity
Continuous Benign
L5. Activity
Benign
L3. DNS conﬁg.
Continuous Benign
L3. DNS conﬁg.
Continuous Benign
Continuous Benign
L3. DNS conﬁg.
Insight
(Section IV-B)
i1. Likelihood
i1. Likelihood
i3. Popularity
i3. Popularity
i3. Popularity
i3. Popularity
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i2. Investment
i3. Popularity
i3. Popularity
i3. Popularity
i3. Popularity
i3. Popularity
i2. Investment
i2. Investment
i2. Investment
Source
[16]
[19]
New
New
New
[58]
New
New
New
[36]
[47]
[38]
New
New
New
[58]
[58]
New
New
New
New
New
New
Four features capture whether the domain is present at
any point in time in the Alexa3, Majestic4, Quantcast5, and
Umbrella6 top websites rankings. These rankings serve as an
approximation of popularity from different vantage points: web
browser visits, incoming links, tracking script/ISP data, and
DNS trafﬁc, respectively. Although they can contain malicious
domains and are susceptible to malicious manipulation [56], we
assume that presence in these lists still serves as a reasonable
indication of benign intent. We retrieve historical data from an
archive of historical top websites rankings [76].
c) One Certiﬁcate Transparency feature captures
whether Certiﬁcate Transparency logs contain a certiﬁcate that
was valid on the date of the takedown, i.e. whether the owner
had obtained a TLS certiﬁcate for the domain. The feature in
this set uses data obtained through an API from Entrust7, which
tracks Google Certiﬁcate Transparency logs [63]. Certiﬁcate
Transparency logs have the most complete coverage of issued
TLS certiﬁcates [92]. Recent browser policies that enforce
logging further increase uptake [75].
d) Eight WHOIS features capture the registration cycle
of a domain as well as registrant details. We base four features
on the time between the WHOIS creation date and the start of
the AGD validity period, the start of malware family activity,
the takedown date, and the WHOIS expiration date respectively.
For an additional feature, we compute whether the domain has
been renewed at least once by the latest registrant, i.e. we ﬁnd
at least two records with different expiration dates.
We capture the validity of registrant data in three features.
We determine if the domain uses a privacy/proxy service
(replacing real registrant data with generic data) by checking
for keywords (e.g. “privacy”, “proxy”) in the WHOIS registrant
records. While legitimate users may prefer to use such a service
3https://www.alexa.com/topsites
4https://majestic.com/reports/majestic-million
5https://www.quantcast.com/top-sites/
6https://umbrella-static.s3-us-west-1.amazonaws.com/index.html
7https://www.entrust.com/ct-search/
to hide personal information [51], malicious domains also tend
to use these services [24]. We also determine whether the
WHOIS registrant email is a disposable address: as the email
account can no longer be accessed after some time, this indicates
that the owner does not consider the domain to be important. We
test non-default/non-proxy email addresses against a manually
curated list of disposable domains8. Finally, we check whether
the WHOIS registrant phone number is valid: malicious actors
would not want any trace leading to their real identity and
therefore resort to fake (e.g., automatically generated) contact
information. We test the validity of phone numbers using an
API from numverify9.
WHOIS-based features are based on historical data gener-
ously provided to us by DomainTools10. To observe long-term
and renewed registrations, we obtain historical records spanning
their full data collection period. The data reﬂects a state before
the introduction of the European General Data Protection
Regulation, so it contains more domains with publicly available
contact details. We elaborate on the continued availability of
such details in Section VI-B.
e) Eleven passive DNS features capture both the period
and frequency of DNS resolutions for a particular domain,
providing a viewpoint on both domain age and popularity. We
retrieve the number of passive DNS queries: when more queries
(for any resource record) have been made for the domain, the
domain appears to be more popular. We base three features
on the time between the ﬁrst seen passive DNS query and the