Further, even for gTLDs, which tends to have highly diverse
and less speciﬁed semantics, the malicious content uploaded
there also tends to be incompatible with the compromised
websites’ themes. This indicates that our approach can be
applied beyond sTLDs. Following we report our ﬁndings.
sTLD as a soft target. To understand the importance of
sTLDs to the adversary, we compared the compromised sTLD
sites with those under the gTLDs, within the same attack
campaign. A campaign here includes a set of websites infected
for promoting unauthorized or malicious content and those sites
share a set of common features, speciﬁcally, they all pointing
to the same target site being advertised, their malicious URLs
having the same features (such as same afﬁliate ID as URL
parameter) and they all share the same redirection chain. In our
research, we discovered a campaign through infected websites’
“link-farm” structure, i.e., a compromised site pointing to
another one. Following the links on the compromised sTLD
sites enabled us to reach a set of infected gTLD sites, mainly
under .com. We then compared the features of those sites with
those of sTLD domains, in terms of Alexa rank, pagerank
(PR) and lifetime, in an attempt to ﬁnd out what type of TLD
domains are more valuable to promotional infections.
Table IV presents the top-3 campaigns (all organized as link
farms) discovered in our study. The largest one covers about 872
sTLDs and 3426 gTLDs across 12 countries and regions (US,
China, Taiwan, Hong Kong, Singapore and others). Among the
victims are 20 US academic institution such as nyu.edu, ucsd.
edu, 5 government agencies like va.gov, makinghomeaffordable.
gov, together with 188 Chinese universities and 510 Chinese
government agencies. Also among the victims are 1507 .com
sites. Figure 9(a) and Figure 9(b) compare the Alexa global
ranks and the page rank (PR) of those gTLD and sTLD websites.
As we can see from the ﬁgures, 50%-75% of sTLD sites are
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:15:32 UTC from IEEE Xplore.  Restrictions apply. 
TABLE IV: Top 3 link-farm campaigns with most injected sTLD
domains.
Name
Campaign 1
Campaign 2
Campaign 3
# sTLD
domains
872
148
60
# gTLD
domains
3,426
5,210
5,198
# coun-
tries
12
7
15
Promotion
Content
Gambling
Cheating
Drug
ranked within the Alexa top 1M, while only 10%-30% of gTLD
sites are at this level. Actually, more than 40% of the gTLD
sites have Alexa rank outside the top 5M. By comparison, less
than 20% of sTLDs have ranks outside the top 5M. In terms
of PR, more than 30% of the sTLD sites have PR from 4 to 6,
while less than 5% of gTLD sites are PR4-PR6. Also, more
than half of gTLD sites have PR as 0, which have a weaker
SEO effectiveness than those with high PR. This indicates
that the majority of sTLD sites have a stronger effect on the
promoted sites than gTLD sites with no or low PR.
We further compared the durations of the infections for these
two types of domains. Again, we continuously crawled the
compromised pages (identiﬁed in 2015/08-2015/09) every two
days from 2015/09 to 2015/11 to check whether the infections
were still there. Figure 9(c) illustrates the distributions of the
sTLD site’s life spans and those of gTLD sites. As can be seen
from the ﬁgure, gTLD sites were cleaned up more quickly than
the sTLD sites. Over 25% of the gTLD sites were cleaned
within 10 days, while 12% of the sTLD sites were cleaned
within 10 days.
Our study demonstrates that the sTLDs are ranked higher
than the gTLD sites and much more effective in elevating
the ranks of promoted content, thereby more valuable to
promotional infections. In the meantime, they are less protected
than the gTLDs: once compromised, the infections will stay
there for a longer period of time. This indicates that, indeed,
the sTLDs are valuable assets to the adversary and effective
protection of the site, as SEISE does, indeed makes the
promotional attacks less effective.
Extension to gTLDs. Compared with sTLDs, gTLDs (e.g.,
.com, .net and .org) do not have ﬁxed semantic meanings.
However, we found that still the malicious content injected
here tends to be incompatible with the semantics of the sites,
which can be captured by the search engine results. Figure 10
presents an example of search engine results for an injected
gTLD site iceriversprings.com, which is the website of Ice
River Green brand of bottled water. However, the injected page
show the semantically inconsistent content for “payday loan”
promotion.
Then, we measure the semantics inconsistency on the
3,000 gTLD sites, which are randomly sampled from the
aforementioned campaigns. Speciﬁcally, we use the Context
Analyzer component
in SEISE to calculate the semantic
distance between the generic content of those known injected
sites (the reference, e.g.,
the search result of the query
site:iceriversprings.com) and the results of querying IBTs on
these sites, which mostly contain injected malicious content
(e.g., site:iceriversprings.com "payday loan"). However, we
Fig. 10: Example of search engine results of an injected gTLD
site iceriversprings.com.
also found that some compromised gTLD sites show semantic
consistent with the promotional content. For example, online
drug library druglibrary.org (in Campaign 3) was injected to
promoted “cheap xanax”. Hence, to identify those suspicious
sites (before they are checked with the Context Analyzer), we
utilized the similarsites website query API [8] to fetch the site
tags (e.g., “recycling” and “water” for site:iceriversprings.com)
to determine a gTLD site’s semantics, and only use the gTLD
sites showing semantic inconsistency with the IBT (i.e., the
site’s tags semantically distance away from the IBT) as the
suspicious candidates for the input of the Context Analyzer.
This ﬁltering step (for the purpose of increasing the “toxicity
level” [21] of the inputs) is built as the Semantic comparator,
which accepts the threshold for the IBT semantics distance
(Section III-B) and outputs the candidate gTLD sites that
have great semantic distances with the IBT used for the
query. For example, iceriversprings.com, which has the site
tag “recycling”, “water” which shows semantic inconsistency
(determined by Semantic comparator Figure 2) with the IBT
“payday loan”, will be regarded as suspicious FQDNs and
become the input of the Context Analyzer.
Figure 9(d) shows the semantic distances between the
reference and the search results of querying an IBT with
and without the Semantic comparator. We observe that the
Context Analyzer can still identify the semantics inconsistency,
particularly with the help of the Semantic comparator that
selects sites with great semantic distances with the IBT: 97%
of the injected sites have semantic distance larger than 0.8
when the threshold of Semantic comparator is set to 0.9; by
comparison, 85% of the injected sites have semantic distance
larger than 0.8 in the absence of the Semantic comparator.
Further, we measure the semantic inconsistency of unknown
injected gTLD sites. This is nontrivial because simply searching
site:.com "payday loan" will return mostly legitimate search
results. Even though we could validate these FQDNs one by one
through the Semantic comparator and the Context Analyzer, the
cost for ﬁnding truly compromised sites becomes overwhelming.
As mentioned earlier, with a similar PR, gTLD sites are
better protected than sTLD sites. Hence, when searching
gTLDs under the IBT (e.g., site:.com "payday loan"), high-
PR gTLD sites tend to appear on top of the search results,
which are actually less likely to be compromised. For example,
719719
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:15:32 UTC from IEEE Xplore.  Restrictions apply. 
(a) Cumulative
of
Alexa global ranks per sites in 3
campaigns.
distribution
(b) Cumulative
of
Alexa bounce rate per sites in 3
campaigns.
distribution
(c) Distribution of
the infection
time for the injected pages in sTLD
sites and gTLD sites.
(d) Cumulative distribution of se-
mantics distance per monitored
sites.
Fig. 9: Alexa global rank, PR and life span of sites in three campaigns, and cumulative distribution of semantics
distance per monitored sites.
when searching “payday loan”, many high-PR sites such as
checkintocash.com, wikipedia.org and www.acecashexpress.com
will show up within the top-100 search results. None of them
appear to be compromised. To address this challenge and
identify the sites likely to be compromised (which will be
further determined by the Context Analyzer), we utilized long
IBTs (word length larger than 4) to feed search engine to
obtain suspicious FQDNs. Generally, longer query keywords
have less search competition [27], i.e., websites with lower PRs
are more likely to appear in the search results. For example,
when searching for “payday loan no credit check” under .com,
bottled water website iceriversprings.com and ATM company
website carolinaatm.com are within the top-10 search results.
In our experiments, we utilized 1000 long IBTs in 10
individual categories to do the search, and 23,098 gTLD
FQDNs were collected for the semantic inconsistency analysis.
We set the threshold of the Context Analyzer to 0.9, and 7,430 of
the gTLD FQDNs were reported to have promotional infections.
We further randomly sampled 400 results (200 injected and 200
not-injected) and manually checked the ﬁndings. We conﬁrmed
that 182 were indeed infections and 196 were not injected,
which gives us an FDR of 9% and FPR of 8.4%. With this
encouraging outcome, how to detect compromised gTLDs
through semantics-based approaches remains to be an open
question. Particularly, new techniques need to be developed to
further suppress FDR and improve its coverage. Also, query
terms for detection should also be automatically discovered.
C. Case Studies
Perhaps the most surprising ﬁndings of our study is the
discovery of several large-scale attacks, infecting many leading
organizations around the world. In addition to the afore-
mentioned gambling campaign, we also found the infections
for promoting counterfeit products, fake essays and political
materials on university and government sites. Here we present
the studies on two cases as examples to provide additional
information about what techniques the adversary uses and how
the attacks are organized.
Exploit kit discovered. We found an exploit toolkit used in
multiple gambling campaigns, for example, Campaign 1. The
toolkit, called xise, was discovered on a cloud drive. By
analyzing its code, we found that xise has the functionalities
for automatic site collection, shell acquisition, customized
injected page generation and a series of evasion techniques such
as redirection cloaking and code obfuscation. More speciﬁcally,
it automatically discovers the domains of high-proﬁle websites
from Google and other search engines, and also scans the
websites for the vulnerabilities within the components such
as phpmyadmin, kindeditor, ueditor, alipay and
fckeditor. Further, it lets its user provide the promoted
site’s URL and keywords and automatically generates the pages
to be injected to the compromised websites along a speciﬁc path
(e.g., ﬁlemanager/browser/default/images/icons). The tool also
uploads a conﬁguration ﬁle to the compromised web server to
perform redirection cloaking: i.e., it will redirect visitors based
on their HTTP referers to protect the compromised site. Also,
to guarantee the malicious content to be indexed by search
engines, xise also uploads scripts to keep generating pages
to guarantee SEO effectiveness. Note that adding and changes
is a freshness factor for high search engine ranking. In our
research, we manually generated signatures for xise as listed
in Table V. 1037 of sTLD sites we detected are related to
xise with the average semantics distance 0.87 to it sTLDs.
Academic cheating infections. Our research also discovered
many infections promoting academic cheating sites. Those sites
provide online services for preparing any kind of homework
at the high school and college levels, and even taking online
tests for students. We found that such attacks mainly aim at
.edu domains and the examples of the IBTs involved include
‘free essay’, ‘cheap term paper’ and others. These terms were
found to be very effective at ﬁnding such malicious activities.
SEISE detected 428 compromised sites, including high-proﬁle
.edu domains such as mit.edu, princeton.edu, havard.edu, etc.
Table VI compares the compromised .edu sites in different
keyword categories. We observe that such malicious activities
have apparently already become a global industry. 119 edu-
cation TLDs in 109 countries have 428 infected domains to
promote academic cheating sites. The Top 3 education TLDs
with most infected sites are edu (23%), edu.mn (11%) and
edu.cn (7%).
720720
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:15:32 UTC from IEEE Xplore.  Restrictions apply. 
TABLE V: Example of signatures.
Signature
...
...
TABLE VI: Comparison of injected education TLDs sites in
different keyword categories.
Category
#
FQDN
# do-
mains
Performance
(term query
per site)
Academic
cheating
Gambling
Drug
Financial
Adult
470
589
423
401
260
428
367
360
327
214
2.2
2.8
2.5
3
3.2
VI. DISCUSSION
Our research shows that semantics-inconsistency search
offers a highly-effective solution to the promotional-infection
threat. In this section, we discuss the tricks the adversary can
play to evade our detection, limitations of our technique and
future research, together with the lesson learnt from our study
and our communication with the victims.
Evasion. The current implementation of SEISE is based upon
the search results returned from Google and Bing. While
both are mainstream search engines targeted by promotional
infections, the data we crawled are limited to the sites that
indexed by Google and Bing. Hence, to evade SEISE, the
adversary, who has full control of a compromised website,
may set robots.txt to prevent part of its content from being
scanned. Such evasion techniques, however, will cause the
promotion pages to lose the visitors from the search engines
and also the high-proﬁle links to the sites being promoted.
This defeats the purpose of the promotional infections, which
are meant to advertise malicious content through the search
engines and therefore should aggressively expose its content