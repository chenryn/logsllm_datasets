 混合加密在安全性和处理速度上都有优势。能够为网络提供通信安全的
35
混合加密
516
---
## Page 149
36
安全算法
第5章
No
全交换。
这种方法通过将双方共有的秘密数值隐藏在公开数值相关的运算中，来实现双方之间密钥的安
在使用公式进行讲解之前，我们先通过图片来理解一下这个算法的概念。
迪菲－赫尔曼（Diffie-Hellman）密钥交换是一种可以在通信双方之间安全交换密钥的方法。
迪菲－赫尔曼密钥交换
terne
S
B
A和B 想交换密钥。
密钥P-S。
个密钥的成分所构成的
钥S，就会得到由这两
方法来合成密钥P和密
成两个密钥。使用这种
假设有一种方法可以合
---
## Page 150
再将其与密钥B合成，得到的就是密钥B-A-C。此处的密钥A-B-C和密钥B-A-C是一样的。
钥B-C，再将其与密钥A合成，得到的就是密钥A-B-C。而合成密钥A和密钥C后，得到的是密钥A-C,
第三，密钥的合成结果与合成顺序无关，只与用了哪些密钥有关。比如合成密钥B和密钥C后，得到的是密
中的这个例子，使用密钥 P和密钥P-S，还能合成出新的密钥P-P-S。
第二，不管是怎样合成而来的密钥，都可以把它作为新的元素，继续与别的密钥进行合成。比如上图
5
3
F
F
F
P
S
WA
WPPS
F
=
d
成，但不能分解。
密钥之间可以合
S
WBAC
续合成。
合成后的密钥还可以继
出来。
也无法把密钥S单独取
钥P和合成的密钥P-S，
征。第一，即使持有密
这种合成方法有三个特
37
一赫尔曼密钥交换
迪菲
517
---
## Page 151
38
安全算法
第5章
06
上
A
也无须担心。
密钥P就算泄露
internet
DO
图灵社区会员夏科(PI:EMAIL）专享尊重版权
DO
F
internet
P
internet
SB进行保密管理。
需要对密钥SA和
?8
和SB。
备自己的私有密钥SA
接下来，A和B各自准
给B。
然后A把密钥P发送
钥P。
吧。首先由A生成密
之间安全地交换密
法，在A和B这两
我们试一试用这种方
密
钥
Y
---
## Page 152
给A。
A将密钥P-SA发送给B，B也将密钥P-SB 发送
P-SA。
A利用密钥P和私有密钥SA合成新的密钥
6
E
F
F
DO
D8
立
VS
internet
internet
图灵社区会员 夏科(PI:EMAIL）专享尊重版权
F
F
F
F
@
SA
的密钥SA-P-SB。
A将私有密钥SA和收到的密钥P-SB合成为新
P-SB。
B也利用密钥P和私有密钥SB合成新的密钥
SB 和 P-SA-SB 相同。
合成的结果与合成顺序无关，所以 SA-P-
F
VS
Bs
internet
internet
F
F
BS
?8
@8
139
丨赫尔曼密钥交换
迪菲
517
---
## Page 153
140
安全算法
第5章
5
寸
3
钥SA和 SB。
所以×无法取得私有密
由于密钥无法被分解，
F
F
图灵社区会员夏科(PI:EMAIL）专享尊重版权
VS
Bs
SA
Bs
Bs
F
internet
P
SB
SA
SA
F
F
EEF
:B
terhe
P
P
as
SA
P
Bs
F
SA
BS
Bs
交换方式是安全的。
P-SA-SB，因此这和
窃听到的密钥合成出
但是，X无法用自己
以有可能会被×窃听。
联网上进行传输，所
和密钥P-SB 需要在互
为密钥P、密钥P-SA
钥交换的安全性。因
下面我们来验证该
密钥”来使用。
“加密密钥”和“解密
SB。这个密钥将作为
B都得到了密钥P-SA-
P-SA-SB。于 是A和
P-SA合成为新的密
密钥SB和收到的密钥
同样地，B也将私
种
己
密
钥
有
---
## Page 154
接下来，A和B分别准备了各自的秘密数字X和Y。X和Y都必须小于P-2。
公开也没有关系。
首先，由A来准备素数P和生成元G。这两个数
接下来用公式来表示这种密钥交换法。用P、G两个整数来表示一开始生成的公开密钥P。其中P是一
EP = P, G
?8
A将素数P和生成元G发送给B。
数量的生成元。
对于所有素数P，都存在一定
G
G
G
一赫尔曼密钥交换
迪菲
517
---
## Page 155
142＇
安全算法
第5章
的结果。
A和B 收到对方的计算结果后，先计算这个值的秘密数字次方，然后再mod P。最后A和B会得到相同
2
=Gmod P
(IG'modP) mod P(G*mod P) mod P
G'mod P
Gmod P
G'modP
GmodP
G
mod P
图灵社区会员 夏科(PI:EMAIL)专享尊重版权
G
?
=Gmod P
Gmod P
G'mod P
P, G
Gmod P
G'mod P
G'mod P
G
密密钥的数字。
同拥有了相当于加
这样，A和 B 就共
果发送给对方。
A和B将自己的计算结
概念意义上的“合成”
数。此处的运算等同于
是计算G除以P后的余
运算。“G mod P”就
P"。mod运算就是取余
秘密数字次方）mod
A和B分别计算“G的
---
## Page 156
全的。
和B共有的数字。而且，X也无法计算出保密数字X和Y。因此，此处使用迪菲－赫尔曼密钥交换是安
下面来验证这种密钥交换法的安全性。即便×窃听了整个通信过程，也无法用窃听到的数字计算出A
23
菲－赫尔曼密钥协议”。
交换。但实际上，双方并没有交换密钥，而是生成了密钥。因此，该方法又被叫作“迪
补充说明
至今还未找到这个问题的解法，而迪菲－赫尔曼密钥交换正是利用了这个数学难题。
（Martin Hellman）提出，两人在 2015年获得了图灵奖。
根据素数P、生成元 G和“G* mod P”求出X的问题就是“离散对数问题"，人们
使用迪菲－赫尔曼密钥交换，通信双方仅通过交换一些公开信息就可以实现密钥
迪菲－赫尔曼密钥交换由惠特菲尔德·迪菲（Whitfield Diffie）和马丁·赫尔曼
解说
GXd P
Gmod P
X
DO
G'modP
Gmod P
P. G
internet
1
Gmod P
43
一赫尔曼密钥交换
迪菲
517
---
## Page 157
４4
安全算法
第5章
No.
况发生的机制。
会被篡改，这会导致解密后的内容发生变化，从而产生误会。消息认证码就是可以预防这种情
5-8
消息认证码可以实现“认证”和“检测篡改”这两个功能。密文的内容在传输过程中可能
abc
internet
abc
消息认证码
B
钥交换等密钥交换协议。
钥加密或迪菲－赫尔曼密
交换密钥可以使用公开密
参考：5-7迪菲－赫尔曼
参考：5-5公开密钥加密
参考：5-4共享密钥加密
全的方法将密钥发送给了B。
密对消息进行加密。A通过安
此处，假设A使用共享密钥加
编号abc告诉B。
在B处购买商品，需要将商品
需要使用消息认证码。假设A
首先，我们来看看什么情况下
密钥交换
---
## Page 158
3
ibc
nternet
B
文的时候。
向 B 发送密
回到A正要
情况。
程中可能会发生下面的
的流程，然而在这个过
以上是没有出现问题时
商品编号abc。
密，最终得到了原本的
收到后对密文进行解
A把密文发送给B，B
对消息进行加密。
A使用双方共有的密钥
45
消息认证码
5１８
---
## Page 159
46
安全算法
第5章
B对被篡改的密文进行解密，得到消息xyZ。
假设A发送给B的密文在通信过程中被×恶意篡改了，
9
abc
internet
xyz
iterne
而B收到密文后没有意识到这个问题。
误的商品发送给了 A。
B以为A订购的是编号为xyz的商品，于是将错
abc
internet
xyz
---
## Page 160
证码，以下简称为MAC（Message Authentication Code）。
接下来，A使用密文和密钥生成一个值。此处生成的是7f05。这个由密钥和密文生成的值就是消息认
一次回到A正要向B发送密文的时候。
改。为了让大家了解实际的处理流程，我们再
如果使用消息认证码，就能检测出消息已被篡
MAC
7f05
后使用安全的方法将密钥发送给了B。
A生成了一个用于制作消息认证码的密钥，然
消息认证码
518
---
## Page 161
148
安全算法
第5章
?
来的7f05一致。
和A一样，B也需要使用密文和密钥来生成MAC。经过对比，B可以确认自己计算出来的7f05和A发
A将MAC（7f05）和密文发送给B。
Cipher-based MAC 的缩写。
One-key MAC 的缩写。
Hash-based MAC 的缩写。
提示
3
参考：5-3哈希函数
HMAC①、OMAC?、CMAC③等。目前，HMAC的应用最为广泛。
我们可以把MAC想象成是由密钥和密文组成的字符串的“哈希值"。计算MAC的算法有
05