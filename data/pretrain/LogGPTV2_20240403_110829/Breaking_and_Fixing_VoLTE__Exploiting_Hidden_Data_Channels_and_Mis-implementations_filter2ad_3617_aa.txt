title:Breaking and Fixing VoLTE: Exploiting Hidden Data Channels and Mis-implementations
author:Hongil Kim and
Dongkwan Kim and
Minhee Kwon and
HyungSeok Han and
Yeongjin Jang and
Dongsu Han and
Taesoo Kim and
Yongdae Kim
Exploiting Hidden Data Channels and Mis-implementations
Breaking and Fixing VoLTE:
∗Hongil Kim† ∗Dongkwan Kim† Minhee Kwon† Hyungseok Han†
Yeongjin Jang§ Dongsu Han† Taesoo Kim§ Yongdae Kim†
†
§
KAIST, Republic of Korea
Georgia Institute of Technology, USA
{hongilk, dkay, minhee.k, han456, dongsu_han, yongdaek}@kaist.ac.kr,
{yeongjin.jang, taesoo}@gatech.edu
ABSTRACT
Long Term Evolution (LTE) is becoming the dominant cellular
networking technology, shifting the cellular network away from
its circuit-switched legacy towards a packet-switched network that
resembles the Internet. To support voice calls over the LTE net-
work, operators have introduced Voice-over-LTE (VoLTE), which
dramatically changes how voice calls are handled, both from user
equipment and infrastructure perspectives. We ﬁnd that this dra-
matic shift opens up a number of new attack surfaces that have not
been previously explored. To call attention to this matter, this paper
presents a systematic security analysis.
Unlike the traditional call setup, the VoLTE call setup is controlled
and performed at the Application Processor (AP), using the SIP over
IP. A legitimate user who has control over the AP can potentially
control and exploit the call setup process to establish a VoLTE
channel. This combined with the legacy accounting policy (e.g.,
unlimited voice and the separation of data and voice) leads to a
number of free data channels. In the process of unveiling the free
data channels, we identify a number of additional vulnerabilities
of early VoLTE implementations, which lead to serious exploits,
such as caller spooﬁng, over-billing, and denial-of-service attacks.
We identify the nature of these vulnerabilities and concrete exploits
that directly result from the adoption of VoLTE. We also propose
immediate countermeasures that can be employed to alleviate the
problems. However, we believe that the nature of the problem calls
for a more comprehensive solution that eliminates the root causes at
mobile devices, mobile platforms, and the core network.
Categories and Subject Descriptors
C.2.0 [Computer-Communications Networks]: General—Secu-
rity and protection; C.2.1 [Computer-Communications Networks]:
Network Architecture and Design—Wireless communication
∗
These two authors contributed equally
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full citation
on the ﬁrst page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from Permissions@acm.org.
CCS‘15, October 12–16, 2015, Denver, CO, USA.
Copyright is held by the owner/author(s). Publication rights licensed to ACM.
ACM 978-1-4503-3832-5/15/10 ...$15.00.
DOI: http://dx.doi.org/10.1145/2810103.2813718.
Keywords
VoLTE; Accounting; Security; Cellular Networks
1 Introduction
Due to the increasing demand for data-centric services, mobile
network operators are quickly moving towards high-speed networks.
With higher bandwidth and lower latency, Long Term Evolution
(LTE) has become the dominant cellular network technology in
recent years. One distinctive feature of LTE is the way it delivers
data such as voice and SMS; LTE operates through packet-based
switching, whereas traditional cellular networks (e.g., 2G or 3G) rely
on circuit-based switching for their voice service. To reliably serve
voice calls on a packet-switching only network, mobile network
operators have adopted, deployed and recently started a service for
end-users, called Voice-over-LTE (VoLTE) [17], which is similar to
a Voice-over-IP (VoIP) service in spirit.
Today, mobile network operators are aggressively deploying
VoLTE services: by April 2015, 16 operators in 7 countries had
commercially launched VoLTE services, and 90 operators in 47
countries are investing to deploy VoLTE services in the near fu-
ture [13]. Despite this fast-moving trend, little research has been
conducted to systematically examine security issues in the upcom-
ing VoLTE services, not only in terms of their end-facing interfaces
but also their cellular infrastructure.
The use of packet-switching in VoLTE opens a large attack surface
that has not been seriously considered thus far. In circuit-switching
mobile networks, the signal processing is conducted by a communi-
cation processor (CP) in a mobile phone, whose detailed implemen-
tation is proprietary to a few chip manufacturers. On the contrary,
VoLTE-compatible devices perform signal processing purely in their
application processor (AP): e.g., initiating Session Initiation Proto-
col (SIP) [29]. As with general-purpose computers, VoLTE relies
completely on Internet Protocol (IP) for packet delivery. Conse-
quently, well-known offensive techniques targeting the IP are also
applicable for abusing or attacking VoLTE-based devices.
Several studies exploring potential attacks and countermeasures
in SIP and VoIP services have been conducted, including, for ex-
ample, works on breaking authentication [8], bypassing account-
ing [36], mounting man-in-the-middle attacks [35], introducing
various attacks by a hacker [24], and even standardizing basic se-
curity issues such as credentiality, integrity and authenticity, by
communities [4, 5, 7, 34].
Since VoLTE operates on the cellular network, it is not only ex-
posed to VoIP-related issues, but also inherits security issues from
the cellular network, such as adversaries being able to interpose
328the signal processing itself. For example, unlike VoIP services, the
LTE network provides a communication channel (which is called a
bearer) with guaranteed bandwidth, once a VoLTE call is established.
As it becomes easy to interpose call signaling with VoLTE func-
tionality, an adversary can create and utilize private communication
channel for peer-to-peer data exchange, which is not a supported
feature in cellular networks. Furthermore, since most operators do
not charge the use of a dedicated channel for VoLTE service, an
adversary can utilize it without being charged.
More seriously, its implementation caveats in authentication and
session management for VoLTE make its infrastructure vulnerable,
and, therefore, an adversary can easily mount various attacks that
bypass the security policy of VoLTE.
Regarding problems with user equipment (UE), VoLTE opens a
security loophole whereby an adversary can make a call without
suitable permission for voice, since the current permission model for
Android devices is only suitable for legacy circuit-switching calls.
In this paper, we ﬁrst present problems of commercially deployed
VoLTE services in 5 operators in the United States and Korea 1.
These problems are mainly caused by legacy policies and the imma-
ture software infrastructure of VoLTE. To show the motivation for
addressing these problems, we demonstrate various attacks that (1)
piggyback a hidden, free data channel (e.g., free extra bandwidth to
the adversary), (2) bypass VoLTE’s accounting system (e.g., direct
calling bypassing the charging server), and (3) abuse the VoLTE
service (e.g., caller spooﬁng, overbilling attack)
In addition, we propose immediate and potential countermea-
sures for these problems. For immediate solutions, 1) operators may
deploy DPI (Deep Packet Inspection) for detecting a hidden data
channel, 2) strict session management on both the phone and op-
erator side is required, and 3) cellular gateways have to be ﬁxed
to prevent hidden channels. As a longer term solution, we suggest
changing the accounting policy of operators, and tighter security
implementation at the mobile devices. To completely eliminate prob-
lems, however, cellular operators, device manufacturers, and mobile
platform providers must draw up a comprehensive solution.
To summarize, we make the three following contributions:
• To the best of our knowledge, this is the ﬁrst attempt to ana-
lyze the security loopholes of commercially deployed VoLTE
services. We found three previously unknown security issues
on VoLTE: 1) hidden data channels in VoLTE services, 2) mis-
implementation of the cellular operators, and 3) fundamental
problems in the mobile devices.
• To show the motivation for addressing these problems, we
successfully demonstrate an attack that enables a free data
channel, and various abuse attacks including call spooﬁng and
denial-of-service. At the time of the submission, all bugs and
exploits are reported to operators.
• We proposed effective, immediate countermeasures, and fur-
ther devise a long-term and comprehensive solution that can
eliminate current security issues in the VoLTE service.
The rest of the paper is organized as follows. §2 presents an
overview of the VoLTE system with the network architecture and
call setup procedure including the accounting policy of real opera-
tors. In §3, we bring up current problems and threats of deployed
VoLTE services through an analysis of VoLTE call ﬂow. We explain
the details of hidden data channel attacks and implementation details
1We performed experiments on 6 operators, but we failed to con-
nect to one operator’s VoLTE service, unlike its advertised service
coverage
3G
UE
NodeB
4G LTE
UE
eNodeB
PS
CS
PS
3G GWs
Internet
MSC
PSTN
MME
4G GWs
Internet
IMS
control plane
data plane
Figure 1: Two-folded architecture of 3G and LTE networks. Mobility Man-
agement Entity (MME) in LTE stands for user mobility.
along with the measurement results in §4. §5 introduces possible
attacks caused by several implementation ﬂaws in the VoLTE ser-
vice. In §6, we provide countermeasures of our attacks and discuss
immediate and fundamental solutions. §7 includes related work, and
we conclude our study and present directions for future work in §8.
2 Background
2.1 LTE Network Infrastructure
A cellular network comprises two architectural components: an
access network that the UE connects to, and a core network that
supports its cellular infrastructure. Figure 1 illustrates the two-folded
architecture of 3G and LTE networks. The access network (left side)
is a radio connection where the UE accesses a base station (e.g.,
NodeB in 3G and evolved NodeB, shortly eNodeB in LTE). On the
other hand, the core network (gray region) handles service-level
connections such as voice calls and the Internet (e.g., PSTN in 3G
and IMS [3] in LTE). IMS stands for IP Multimedia Subsystem,
and it offers IP-based voice calls and multimedia services by using
the SIP (bottom), and PSTN stands for Public Switched Telephone
Network, a typical public telephone network (top). 4G GWs in the
core network consist of Serving Gateway (S-GW) and P-GW. S-GW
is a mobility anchor for inter eNodeB handover and relays the trafﬁc
between 2G/3G systems and P-GW. Meanwhile, the P-GW manages
PDN connection between a UE and a service. It is also responsible
for packet ﬁltering and charging, which are crucial functions for
preventing accounting bypass and service abuse attacks.
The major difference between 3G (top) and LTE (bottom) net-
works is in the way they deliver data in the core network. The 3G
network separates network domains into packet-switching for the In-
ternet connection and circuit-switching for phone calls. The mobile
switching center (MSC) in the circuit-switching domain transfers
voice calls, and the 3G gateways enable data communication in
the packet-switching domain. In contrast, the LTE network only
operates through the packet-switching domain; as it does not have
a circuit-switching domain, its voice calls either fall back into the
3G network (also known as Circuit Switched Fallback, or CSFB
in short) or the LTE provides a VoLTE solution to transfer both
voice calls and data to the packet-switching domain, which does not
require any fallback to the 3G circuit-switching network.
329eNodeB
MME
S/P-GW
CSCF
Media
Proxy
UE A
CSCF
UE B
1
2
3
4
5
6
7
Radio setup
EPS Registration, default bearer setup
IMS registration and user authentication
IMS VoIP session setup
EPS dedicated bearer setup
Media Session
IMS VoIP session and dedicated bearer release
Figure 2: Overview of Epacket-switching and IMS protocols in VoLTE;
registration and call setup between a UE and a LTE network.
2.2 VoLTE Service
VoLTE service is introduced to deliver voice calls over the packet-
switching based LTE network. The service utilizes an IMS network
based on SIP, similar to VoIP service over the LTE network. To
establish a voice call, a UE follows standard procedures as depicted
in Figure 2.
To connect to the LTE network, 1 a UE ﬁrst contacts the eNodeB,
and then 2 the UE registers itself to the Evolved Packet System
(EPS), establishing an Internet Protocol (IP) connection, which is
identiﬁed by a default bearer. Note that this IP address is differ-
ent from the one used for data connection. In other words, every
phone supporting VoLTE is assigned two IP addresses: one for voice
and the other for data [2]. Once the UE has an IP connection to
VoLTE, 3 the UE connects to the IMS network and the IMS server
authenticates whether the device is allowed for the VoLTE service.
If authenticated, 4 the UE can make a voice call through the
SIP signaling service, provided by Call Session Control Function
(CSCF) servers. When a call session is established, 5 a dedicated
bearer is created to identify voice-related trafﬁcs and 6 all voice
packets are transferred through this dedicated bearer. 7 Upon call
termination, the bearer used for the voice session is released.
Note that two bearers are used to enable a connection in the
VoLTE service. The default bearer established during the EPS reg-
istration is for call signaling. Once the default bearer has been
established, all the incoming and outgoing SIP packets are bound
to this bearer. According to the 3GPP speciﬁcation [1], this default
bearer has the highest priority among all possible bearers for voice
or data services. The main reason for this different prioritization
is to support the QoS of a phone call, similar to circuit-switching
based routing. When a phone call is made, the IMS Packet Data
Network (PDN) temporarily creates a dedicated bearer that has a
lower priority than the default one. This dedicated bearer, however,
has a higher priority than the bearers for data services. Although
the dedicated bearer has the same IMS PDN address as the default
bearer, it operates by different rules that make voice packets with
the negotiated media port go through the dedicated bearer.
2.3 VoLTE Signaling Protocol