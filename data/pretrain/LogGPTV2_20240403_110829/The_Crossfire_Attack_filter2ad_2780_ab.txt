persistent6.
B. Attack Setup
The adversary uses the obtained link map to discover the
set of target links whose ﬂooding cuts off the largest number
of routes to the target area. Clearly, the larger the proportion
of cut routes out of all possible routes to the target area,
the stronger the attack. The attack-setup step consists of the
following two sub-steps.
1) Flow-Density Computation:
The adversary analyzes the link map for a target area
and computes ‘target-speciﬁc attack-ﬂow density’, or simply
ﬂow density henceforth, for each network link in the link
map. The ﬂow density of a persistent link is deﬁned as
the number of ﬂows between bots and target-area servers
that can be created through that link. Hence, ﬂow density
is a target-area-speciﬁc metric and can vary widely from
one target area to another (viz., Section III-A). It is a very
different metric from those used for Internet connectivity,
such as the “betweenness centrality” [20] and the degree
of routers [18, 19] (viz., Section III-A), and should not be
confused with them.
A high ﬂow density for a link indicates that the link
delivers both a large number of attack and legitimate (or non-
attack) to a speciﬁc target area, and thus the link becomes a
good attack target. We found that the ﬂow density follows
a power-law distribution in a link map (viz., Section III-A),
and this enables an adversary to easily discover a set of high
ﬂow density links that delivers most trafﬁc to a target area.7
Furthermore,
the computed ﬂow density remains largely
unchanged for at least several hours due to the well-known,
long-term stability of Internet routes [27, 21]. Hence, ﬂow
density can be used as a stable and reliable metric by the
adversary in selecting target links.
2) Target-Link Selection:
In this step, the adversary ﬁnds multiple disjoint sets of
target links to be ﬂooded. The adversary selects at least two
disjoint sets of target links and uses them one at a time, in
succession, to achieve attack persistence (viz., Section II-D).
The goal of this step is to maximize the amount of disrupted
6The link map obtained may not include backup links since these links
typically do not show up in traceroutes. The existence of such links is
largely immaterial to the effectiveness of Crossﬁre. If attack trafﬁc spills
over onto backup links and its intensity dampens appreciably, the adversary
could easily switch to a new set of target links for the same server area, as
shown in Section II-D.
7The power-law of ﬂow density should not be confused with connectivity
properties derived from traceroute, such as those for the degree of router
level topology [19].
trafﬁc ﬂowing into the target area by optimal selection of
target links using the link map and ﬂow density.
To quantify how much of the trafﬁc to a target area can be
cut off by a chosen target-link set, the adversary computes
the degradation ratio for that target area. The degradation
ratio is the fraction of the number of bot-target area routes
cut by the attack over the number of all possible bot-target
area routes. We say that a route is cut by an attack if the
route contains a target link that is ﬂooded by the attack.
To select the target links that maximize the degradation
ratio to a target area, the adversary must solve the general-
ized maximum coverage problem, which is a well-known
NP-hard problem. Instead of ﬁnding an exact solution,
the adversary uses an efﬁcient heuristic, namely a greedy
algorithm [28], presented in Section IV-D. The execution
time of our heuristic is very small, namely less than a minute
in all experiments (viz., Section IV-D). This enables the
adversary to adapt to dynamic route changes, if necessary.
The output of this algorithm shows that ﬂooding a few target
links can block a majority of the connections to a target
area. For example, ﬂooding ten target links causes a 89%
degradation ratio for a small target area; ﬂooding ﬁfteen
target links can block 33% of connections ﬂowing to the
West Coast of the US (viz., Section V-D).
C. Bot Coordination
Once target links are selected at step B-② (Fig. 2), the
adversary coordinates individual bots to ﬂood the target
links. To create ﬂooding ﬂows for a given set of target links,
the adversary assigns to each bot (1) the list of decoy servers
and (2) the send-rates for packets destined to individual
decoy servers. The send-rates are assigned in such a way that
individual attack ﬂows have low intensity (or low bandwidth)
while their aggregate bandwidth is high enough to ﬂood all
target links. This step consists of two sub-steps.
1) Attack-Flow Assignment:
The goal of the attack-ﬂow assignment is to make
the aggregate trafﬁc rate at each target link slightly higher
than the link bandwidth so that all the legitimate ﬂows
are severely degraded in those links. Two assignment con-
straints must be satisﬁed. The ﬁrst is that the adversary
must keep each per-ﬂow rate low enough so that none of
the network protection mechanisms in routers or intrusion
detection systems (IDS) at or near a server can identify the
ﬂow as malicious. The second is that the aggregate attack
trafﬁc necessary to ﬂood all the targeted links is relatively
evenly assigned to multiple bots and decoy servers. The
ﬁrst constraint ensures indistinguishability of attack ﬂows
whereas the second addresses undetectability both at servers
in the target area and at decoy servers; viz., Section VI
for details. The adversary ﬁrst sets the maximum target
bandwidth for each target link and exhausts it with attack
ﬂows. Then, she assigns individual ﬂows for each target link.
130
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:55:31 UTC from IEEE Xplore.  Restrictions apply. 
The rate of an attack ﬂow at a target link is lower-bounded
by the ﬂow density. The average per-ﬂow rate for the target
link should be higher than the target bandwidth divided
by the maximum number of available attack ﬂows on the
link, which is proportional to its ﬂow density. Moreover,
the assignment of the per-ﬂow rate must take into account
the maximum ﬂow rate a decoy server can handle without
triggering trafﬁc alarms. For example, if a decoy server is
a public web server, one web click per second on average
(a HTTP GET packet per second (cid:2) 4 Kbps) would not be
classiﬁed as abnormal trafﬁc at the server. Therefore, the
adversary can easily assign a large enough number of attack
ﬂows with low per-ﬂow rates. The adversary also has to
assign per-bot and per-decoy server rates that are evenly
distributed. For enhanced undetectability of attack trafﬁc at
the bots and the decoy servers, the adversary must account
for all previously assigned trafﬁc rates at the bots and decoy
servers whenever assigning new attack ﬂows. The adversary
conservatively sets the target bandwidth to 40 Gbps, which
is the most widely used link bandwidth currently deployed
(OC-768) for high bandwidth backbones.
Despite an adversary’s careful attack ﬂow assignment,
non-target links located upstream of the target links could
still become congested, which we call early congestion, if
they have limited bandwidth and/or the bot density in a
certain area is too high. The adversary can avoid potential
early congestion using a priori link bandwidth estimation,
which we discuss in detail in Section IV-C.
2) Target-Link Flooding:
The adversary directs her bots to start generating the
attack ﬂows. Each bot is responsible for multiple attack
ﬂows, each of which is assigned a distinct decoy server with
the corresponding required send-rate. Bots slowly increase
the send-rates of their attack ﬂows up to their assigned send-
rates, which makes the attack ﬂows indistinguishable from
the trafﬁc patterns of typical ”ﬂash crowds” [29]. Bots can
adjust the intensity of their ﬂow trafﬁc dynamically, based
on the state of each target link; i.e., if the actual bandwidth
of a target link is less than the assigned attack bandwidth
(set in Section II-C1), the bots stop increasing the rates of
attack ﬂows as soon as the target link is ﬂooded.
D. Rolling attacks
The adversary can dynamically change the set of target
links (among the multiple sets found previously) and extend
the duration of the Crossﬁre attack virtually indeﬁnitely.
Continuous link ﬂooding of the same set of target links
would lead to bot-server route changes since it would
inevitably activate the router’s failure detection mechanism.
Hence, changing the set of target links assures attack per-
sistence and enables the attack to remain a pure data-plane
attack. The adversary can also dynamically change the set of
bots to further enhance the undetectability of the Crossﬁre
attack. These dynamic attack execution techniques are called
rolling attacks in Section IV-B where they are described in
more detail.
III. TECHNICAL UNDERPINNINGS
In this section, we discuss the two characteristics of the
current Internet which enable the Crossﬁre attack, namely
(1) the power law of ﬂow-density distribution, which is
target-area speciﬁc, and (2) the independence of the geo-
graphical distribution of bots from target links and attack
targets, which gives an adversary has a wide choice of bots
in different locations on the globe.
A. Characteristics of Flow-Density Distribution
Before analyzing the distribution of ﬂow density, we
must distinguish between the attack-speciﬁc ﬂow density and
connectivity-speciﬁc metrics, such as the betweenness cen-
trality [20] and the degree of routers [18], which characterize
an Internet topology. Recall that the ﬂow density of a link
represents the number of source-to-destination (i.e., bot-to-
server in the target area in the Crossﬁre attack) pairs whose
trafﬁc crosses the link persistently. In contrast, betweenness
centrality, which is the number of shortest routes among
all vertices that pass through an edge in a graph, does not
reﬂect actual trafﬁc ﬂows and their dynamics. Similarly, the
connectivity degree of a router, which represents the router’s
layer-3 direct connections to neighbor routers, namely the
topological connectivity of the router, does not capture any
dynamics of trafﬁc ﬂows. Thus, neither of these metrics
could be used to evaluate the feasibility of the Crossﬁre
attack.
Our analysis on the ﬂow-density distribution is two-fold;
ﬁrst, we show that it is easy to ﬁnd target links that have
extremely high ﬂow density for a selected target area; and
second, we show that ﬂow density of a link is not a constant
but varies depending on a selected target area (i.e., ﬂow
density is a target-area speciﬁc metric).
1) Universal power-law property of ﬂow-density distribu-
tion: A power-law distribution exhibits a heavy-tail charac-
teristic, which indicates that extreme events are far more
likely to occur than they would in a Gaussian distribution.
More formally, a quantity x obeys a power-law if it follows
a probability distribution
p(x) ∝ x−α for x > x0,
(1)
where α is a constant parameter of the distribution known as
the scaling parameter [30]. The power-law property appears
in the tail of the distribution (i.e., x > x0)8. If a power-law
their datasets follow a power-law distribution [18, 31];
8Some past research relied on simple data-ﬁtting methods to conclude
that
if a
histogram of empirical datasets is well ﬁtted to a straight line on log-log
scale, a power-law behavior would be ascribed to the datasets. However,
recent studies [32, 25] show that these data-ﬁtting methods are insufﬁcient
to conclude the power-law compliance of empirical data. According to
Clauset et al. [30], the majority of purported power-law datasets fail to
pass the rigorous statistical hypothesis test on their power-law distribution.
i.e.,
131
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:55:31 UTC from IEEE Xplore.  Restrictions apply. 
100
10−1
10−2
10−3
)
x
≥
X
(
r
P
10−4
  x
 = 1138
0
  α = 3.15
  p−value = 0.68
(a) East Coast
100
10−1
10−2
10−3
)
x
≥
X
(
r
P
10−4
0
  x
 = 690
  α = 3.45
  p−value = 0.96
(b) New York
10−1 100 101 102 103 104
10−1 100
x
102
103
104
101
x
Figure 3: Flow-density distributions for various target areas:
(a) East Coast and (b) New York. The complementary
cumulative distribution functions (CCDFs) (i.e., Pr(X ≥ x))
of ﬂow density (x) for both areas are plotted on log-log scale.
distribution holds for ﬂow density, that would imply that an
adversary could easily ﬁnd links whose ﬂow density is many
orders of magnitude higher than average. These links would
become good targets for attack for a particular target area.
We use the rigorous statistical test proposed by Clauset
et al. [30]9 to show that a power-law holds for ﬂow-density
distributions. We ﬁrst estimate the parameters (i.e., x0 and
α) of power-law distribution on our ﬂow-density datasets and
test the power-law hypothesis with the estimated parameters.
Fig. 3 shows the ﬂow-density distributions of two different
target areas: (a) East Coast and (b) New York. The com-
plementary cumulative distribution function (CCDF) (i.e.,
Pr(X ≥ x), where x is ﬂow density) of the ﬂow-density
datasets is plotted on a log-log scale. As the graphs show,
both distributions are well ﬁtted to the diagonal lines at the
tail. More precisely, we apply the power-law hypothesis test
proposed by Clauset et al. [30] to the measured ﬂow-density
dataset and obtain the p-value, which indicates the degree
of plausibility of a hypothesis, for each test. The p-values
for the two target areas (i.e., 0.68 and 0.96) are much higher
than the signiﬁcance level, which is often set to 0.05. Hence,
the plausibility of the null hypothesis (i.e., the ﬂow-density
distribution follows a power law) is accepted [33].
2) Target-area dependency of ﬂow density: Unlike
connectivity-related metrics, which are dependent only on
physical network connectivity but
independent of attack
targets, ﬂow density is an attack-speciﬁc metric; i.e., a target
link that has high ﬂow density for a target area may have a
very different density for other areas.
Table I illustrates the top 20 links ordered by ﬂows den-
sities for three target areas of different sizes: the East Coast,
Massachusetts, and Univ2. Naturally, one would expect that
the links’ ﬂow densities would follow the obvious link-
map inclusion relations, namely the link map of Univ2 ⊂
link map of Massachusetts ⊂ link map of the East Coast.
However, Table I shows that the top 20 links for these related
target areas are very different: not only these links do not
follow the link-map inclusion, but also whenever some are
9The statistical tools, proposed by Clauset et al. [30], are available at
http://tuvalu.santafe.edu/∼aaronc/powerlaws/.
Target area
East Coast
Massachusetts
Univ2
Indices of top 20 ﬂow-density links
01, 02, 03, 04, 05, 06, 07, 08, 09, 10,
11, 12, 13, 14, 15, 16, 17, 18, 19, 20
19, 21, 13, 22, 23, 24, 25, 26, 27, 28,
29, 30, 31, 32, 33, 34, 35, 36, 37, 38
39, 40, 30, 41, 42, 23, 43, 44, 45, 46,
47, 48, 49, 50, 51, 52, 53, 54, 55, 56
Table I: Top 20 ﬂow-density links for three different target
areas: the East Coast of the US, Massachusetts, and Univ2.
Each link IP address is mapped to a link index. Bold indices
denote the links shared by different areas.
shared between areas they have different density ranks. For
example, link 19 has the highest ﬂow-density rank when
the state of Massachusetts is targeted, and yet it only ranks
next to the last for the East Coast. Furthermore, link 19
does not even appear in the top 20 link densities of Univ2.
This clearly shows that ﬂow density is a target-area speciﬁc
metric, which reveals a link’s usefulness in an attack that
targets a speciﬁc area.
B. Geographical Distribution of Bots