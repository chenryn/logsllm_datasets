We denoted each unique combination as a region.2 To obtain a
comprehensive list of lspgws, we used Rapid7’s rDNS dataset [53],
which periodically resolves rDNS names of the entire IPv4 address
2Note that If the geolocation hint is stale we generally find some anomaly in the
traceroute that reveals its staleness, e.g., a traceroute with backbone IP addresses in
between nodes with the same geolocation hint likely involves a stale geolocation hint.
736
IMC ’21, November 2–4, 2021, Virtual Event, USA
Zesen Zhang, Alexander Marder, Ricky Mok, Bradley Huffaker, Matthew Luckie, KC Claffy, and Aaron Schulman
Address
192.168.1.254
107.210.168.1
71.157.16.114
75.20.78.58
75.20.78.55
71.157.16.42
1
2
3
4
5
6
rDNS
reply-ttl
107-210-168-1.lightspeed
.sndgca.sbcglobal.net
64
63
62
61
60
59
Table 5: Targeted traceroutes to egress interfaces of MPLS
tunnels reveals the paths hidden by the MPLS in intra-region
probing (hop 4-5).
Central Office type
prefix
71.157.6.0/24
71.148.118.0/24
71.148.71.0/24
71.148.104.0/24
71.148.70.0/24
71.157.16.0/24
75.20.78.0/24
Edge CO
Aggregation CO
Table 6: San Diego AT&T CO prefixes
We applied the Direct Path Revelation (DPR) technique [73] to
reveal the network paths in MPLS tunnels. We targeted inter- and
intra- region traceroute measurements to all of the addresses in the
EdgeCO router prefixes we discovered, which correspond to the
egress interface of the tunnel (i.e., hop 3 in Fig. 20a and hop 7 in
Fig. 20b), which allowed us to discover hidden links in the regional
network. Table 5 shows a sample traceroute within the San Diego
region that revealed an additional link (hop 4 and 5 in Table 5)
that was hidden in traceroutes to lspgws. Table 6 shows all the IP
prefixes for routers we discovered in AT&T’s San Diego region.
D DETAILS ABOUT MOBILE MAPPING
Target Selection. We used the AS relationship dataset [11] to
identify each mobile ISP’s neighboring ASes. We found 266/406/213
neighboring ASes for AT&T/Verizon/T-Mobile, respectively. We
then conducted a pilot test to compile lists of target IPs for each
ISP. For each neighboring AS, we found one IPv4 and one IPv6
destination that were responsive to traceroute probes. We used
the corresponding target list of the current mobile ISP to perform
traceroute measurements.
The ShipTraceroute results showed that the network paths to all
the targets shared the same paths within the mobile network until
exiting the PGWs. Table 7 and Table 8 show the number of PGWs
we inferred using region bits in AT&T and Verizon IPv6 addresses,
respectively.
Address
192.168.1.254
107.210.168.1
71.157.16.42
108.89.115.1
1
2
3
4
rDNS
reply-ttl
107-210-168-1.lightspeed
.sndgca.sbcglobal.net
108-89-115-1.lightspeed
.sndgca.sbcglobal.net
64
63
59
61
(a) Intra-region probing traceroute result. From a VP in San Diego,
CA probe to a lightspeed gateway (lspgw) in the same city. The
third hop is the IP of an EdgeCO router.
Address
192.168.1.254
107.129.92.1
71.148.149.186
71.145.1.52
12.83.39.213
12.123.215.237
71.157.16.42
108.89.115.1
1
2
3
4
5
6
7
8
rDNS
reply-ttl
107-129-92-1.lightspeed
.sntcca.sbcglobal.net
108-89-115-1.lightspeed
.sndgca.sbcglobal.net
64
63
62
61
251
55
55
54
(b) Inter-region probing traceroute result. From a VP in Santa
Cruz, CA to the same lspgw in San Diego, CA. The path first
traversed COs in Santa Cruz region (hops 3-5), then AT&T’s back-
bone network (hops 6-7), and finally San Diego region (hops 8-9).
Figure 20: Traceroute examples of regional probing of AT&T.
space, to find hostnames (and IPs) that matched the regex. We found
95,821 IPs in 37 regions in the September 2020 dataset.
AT&T blocked traceroute measurements toward most of the
lspgws from the public Internet, but allows traceroutes from within
a region and from nearby regions. We used four CAIDA Ark VPs in
and nearby San Diego in AT&T to conduct ICMP paris-traceroutes
to lspgws IPs. This process partially revealed the topology that
connected EdgeCOs and AggCOs in a region.
To observe the rest of the topology, we needed to expose MPLS
tunnels between the BackboneCO and the lspgws that hide the
AggCOs and many EdgeCOs. To expose these tunnels we needed
to discover which IP prefixes are assigned to the EdgeCO routers in
the region we are mapping. We used both intra- (McTraceroute) and
inter-region (Ark) traceroutes to lspgws to discover these prefixes.
Fig. 20a and Fig. 20b show samples of intra- and inter-region probing
to a lspgw in San Diego from a RIPE Atlas VP in San Diego, CA and
an Ark VP in Santa Cruz respectively. The San Diego VP reaches
lspgws in the same region directly without crossing the backbone
(Fig. 20a). The traceroute from the Santa Cruz VP traverses AT&T’s
backbone network, which uses prefix 12.0.0.0/8, to reach other
regions (Fig. 20b). We then extract a preliminary list router prefixes
from hops between two lspgws in intra-region probing (i.e., hop 3
in Fig. 20a) and between the backbone and the destination lspgws in
inter-region probing (i.e., hop 7 in Fig. 20b).
737
Inferring Regional Access Network Topologies: Methods and Applications
IMC ’21, November 2–4, 2021, Virtual Event, USA
Table 7: Inferred number of AT&T PGW in each region.
Region name
Region bits in IP addresses
MTSO number
BTH CNC VNN ALN HST CHC AKR ALP NYC ART GSV
2030
2080
20b0
2040
2090
2010
2000
20a0
2020
2050
2070
2
5
5
5
5
5
3
6
4
3
3
Table 8: Inferred number of Verizon PGW in each region.
RDMEWA HLBOOR
100f:b0
100f:b1
SNVACA RCKLCA
1010:b0
1010:b1
LAX
AZUSCA VISTCA
1012:b0
1012:b1
LSVKNV
1011:b0
2
HCHLIL
1008:b0
NWBLWI
1008:b1
SFLDMI
1009:b1
STLSMO BLTNMN OMALNE
1014:b1
100a:b0
1014:b1
AURSCO WJRDUT
100e:b1
100e:b0
ELSSTX HSTWTX BTRHLA MIAMFL ORLHFL
100b:b1
100c:b2
100d:b0
100d:b1
100b:b0
Backbone Region Name
Wireless Region Name
Region bits in IP addresses
PGW numbers
Backbone Region Name
Wireless Region Name
Region bits in IP addresses
PGW numbers
Backbone Region Name
Wireless Region Name
Region bits in IP addresses
PGW numbers
Backbone Region Name
Wireless Region Name
Region bits in IP addresses
PGW numbers
1
2
2
1
2
2
SEA
DEN
ATL
2
SJC
CHI
2
1
DLLSTX
2
IAD
2
1
1
PHIL
ESYRNY
1002:b1
3
1
MIA
2
2
2
NYC
2
BOS
3
2
CHRXNC WHCKTN ALPSGA CHNTVA JHTWPA WLTPNJ WSBOMA BBTPNJ
1000:b1
1004:b0
1004:b1
1005:b0
1003:b0
1003:b1
1017:b0
1000:b0
4
2
2
1
2
2
1
738