（3）脚本逻辑修改
（2）调整下密码
明白了缘由，解决方案也很清晰了：
1）注释掉这个cron
---
## Page 51
2.1
会按照如下的思路来聊聊我眼中的MySQL 体系结构：
千个人心中就有一千个哈姆雷特，不同的人对体系结构的解读点也会有所差别，接下来
们学习MySQL体系结构，重要的是透彻理解它的设计思路，而不是上来就翻看源码，一
过这个图能够理解多少信息？这里需要打一个大大的问号。
MySQL 对于我们来说，直观的感受就一个服务（内存结构）和一些物理文件。内存
对于很多同学来说，学习一门技术如果有直观感受，对于一个事物的理解就会更加深刻。
（1）通过文件来了解MySQL体系结构。
（4）MySQL是如何保证数据不丢失的。
MySQL体系结构图不是单纯画出来给我们看的，对我们来说，它不是空中楼阁，我
（2）玩转MySQL数据字典。
相信大家在很多场合都看到过下图 2-1所示的 MySQL 体系结构图，但是说实话，通
（3）InnoDB体系结构解读。
你做任何一件事都可以把它做得很漂亮，或是很丑陋。
通过文件来了解MySQL体系结构
第2章
理解MySQL体系结构
lon,Thread
图2-1
罗伯特·m·波西格《禅与摩托车维修艺术》
usonnentionPeon
MySQL Server
中
---
## Page 52
30丨MySQL DBA工作笔记：数据库管理、架构优化与运维开发
结构我们看不到，但是我们能够看到这些物理文件，
performance_schema
下，
mysql-bin.index
mysql-bin.000003
mysql-bin.000002
mysql-bin.000001
mysqld.log
mysqld.pid
如下表2-1所示。
上面的列表信息量很大，
drwxr-x--
devopsdb
drwxr-x--
drwxr-x--
-rw-r----
-rw-r--
-rw-r--
-rw-r-----
drwxr-x--
-rw-r--r--
drwxr-x---
-rw-r--
-rw-r----
-rw-r--
-rw-r--
drwxr-x--
-rw-r----
-rw-r-----
下面是在一个测试环境中得到的文件列表，
ibdatal
ibtmp1
my.cnf
文件名
kmp
testdb
mysql
sys
2
2
2
2
文件夹
文件类
文件夹
文件夹
文件夹
文件夹
文件夹
文件
文件
文件
文件
文件
文件
文件
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql mysql
mysql mysql
文件
文件
mysql
mysql
mysql
mysql
mysql
型
还会有相应的 relay log
还会有相应的
还会有相应的relay log
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
mysql
系统表空间
innodb 临时表的独立表空间
错误日志，记录数据库启动的日志，服务端的一些日志，有的公司习惯用erorlog 命名
MySQL服务的进程号
二进制日志序列文件，里面会记录相应的 binlog 名称
二进制日志，即 binlog，数据变化都会在二进制日志里面记录；如果是在从库，
参数文件，默认是从/etc/my.cnf 中读取，也可以自定义
数据库，存放应用数据
数据库，存放应用数据
数据库，存放应用数据
数据库，MySQL的数据字典
数据库，MySQL的数据字典
数据库，MySQL的数据字典
，如果逐个解释一遍会很散乱，
二进制日志，即binlog，数据变化都会在二进制日志里面记录；如果是在从库，
二进制日志，即binlog，数据变化都会在二进制日志里面记录；如果是在从库，
16432283
12582912
50331648
间
的relaylog
12288
1053
20480
4096
4096
4096
169
435
531
4096
150
860
57
56Jan
9
表
Dec
Jan
Jan 20 15:46
Jan
Sep
Jan
Aug
2
Jan
Jan
Jan
Jan
Sep
Jan
Jan
Jan
Jan
Jan
20
：我们来简单解读一下。
22
20
2
20
26
22
5
5
2
2
6
2
17:52
15:44
22:
15:42
22:33
15:44
23:
22:49 dev01-slow.log
2018 auto.cnf
2018
2018
15:46
15:46
15:46
15:
所以我们先从这里开始。
说
:46
33
：44
sys
performance_schema
mysql-bin.index
明
testdb
#
my.cnf
kmp
devopsdb
我们按照文件名和类型授-
ysql-bin.000001
ibtmp1
ib_logfilel
sql
---
## Page 53
的文件结构大体如下图2-2所示。
用独立表空间还是比较普遍的，在 MySQL 8.0版本之后这种情况又有了变化。
innodb_file_per_table，通俗一些就是每一个表都有独立的文件.frm 和.ibd，而且实际中使
据字典数据也会放在这里。ibdatal 会持续增长，无法收缩。另外一个参数是
file_path，就是共享表空间，数据都往这一个文件里放（也就是 ibdatal），同时 undo 和数
文件存放的是表结构信息，ibd文件存放的是表数据。
数据库 testdb 中存在表 test 和 testdata，所在文件夹下的文件列表如下：
test_data.ibd
testdata.frm
到了这里，我们基本对MySQL文件有了一个直观的认识。我们简单总结一下，MySQL
ib_buffer_pool
dev01-slow.log
MySQL里面的文件蛮有意思，大体有两个参数来做基本的控制；一个是innodb_data
注：对于分区表，ibd文件将会有多个，不过互联网行业中对于分区表使用有限，
这两个表都是InnoDB 存储引擎存储，每个表会有两类文件：.frm 和.ibd，其中.frm
如果我们查看文件夹中的文件，就会对MySQL 数据存储有了一个直观的认识，比如
ib_logfileo
-rw-r-
-rw-r--
-rw-r--
auto.cnf
ib_logfile1
-rw-r-----
文件名
testibd
test.frm
Performance
表testdata
mysqld.pid
ibtmp1
表t2
1mysql mysql
1 mysql mysql
文件类型
mysql mysql
文件
文件
文件
文件
文件
*sSys
热数据转储文件
mysql
mysql
临时表空间文件
数据库testdb
socket文件
进程文件
数据字典文件
mysql
mysq
高使用率和性能
5.7版本新特性，关闭MySQL时，会把内存中的热数据保存在这个文件中，提
MySQL启动时如果没有UUID，就会生成这个文件
慢日志，应用层面若出现了查询性能较差的SQL，都会在慢日志里面记录下来
InnoDB 层特有的日志文件，redo文件，默认是2组，可以设置为3组
InnoDB层特有的日志文件，redo文件
数据文件
系统文件
98304Sep
114688Jun26
8632Sep
8586
61 Jun 26 2018 db.opt
图2-2
MySQL文件
Jun
323:49testdataibd
2018 test.ibd
说
参数文件mycnf
第2章理解MySQL体系结构|31
Error log emysqld.log
Slow log
Binlog
ib_logfileo
mysql-bin.index
mysql-bi.00003
dev01-sow.lg
mysql-bin.000002
mysql-bin.000010
续表
---
## Page 54
32丨MySQL DBA工作笔记：数据库管理、架构优化与运维开发
2.1.2
如下图2-3所示。
（当然也可以根据参数 innodb_page_size 调整为 4k、8k、32k等），然后自成一套体系，
我们来细化一下，其实一个表中的数据不会像文本文件那样存储，表里的数据是以行为
2.1.1
的问题，其实我们能够分析的一个入口就是日志。