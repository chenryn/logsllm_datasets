for (int i = 0; i .*?", "");
value = value.replaceAll("(?i).*?", "");
value = value.replaceAll("(?i).*?", "");
value = value.replaceAll("(?i).*?", "");
return value;
}
}
在 web.xml 中增加对应的过滤器拦截。
XssFilter
XXXXX(该类的路径).XssFilter
XssFilter
/*
（2）SQL 注入。攻击者在 HTTP 请求中注入恶意 SQL 命令，例如 drop table users，
服务器用请求参数构造数据库 SQL 命令时，恶意 SQL 被执行。
解决思路：后台处理。例如，使用预编译语句 PreparedStatement 进行预处理，如
果有使用 mybatis 等持久层框架的话，建议控制相关 SQL 参数的填写格式。
（3）DDoS 攻击。DDoS 攻击又叫流量攻击，是最基本的 Web 攻击；攻击的方式
有很多种，其中最常用的就是静态文件攻击。通过劫持大量的 IP 然后同时访问同一个
静态文件，使服务器一直处于通信堵塞状态，网络带宽被全部占满，使网站崩溃处于
不可访问状态，SSH 连接服务器处于卡顿状态，无法执行相应的命令。
解决思路如下。
查看内存是否已被占满。
第 6章 高级系统运维 205
free -m
如果used项的值接近total的值，说明内存快不够了，正常情况下至少保持1 GB左
右的大小。查看进程情况。
top -c
然后按 Shift + M 组合键对进程进行排序，如果这个时候出现卡顿或者执行不连
贯，应先关闭当前 SSH 连接，重新打开新的 SSH 连接窗口。
进入 Nginx 日志目录（默认安装的情况下在 /etc/Nginx/logs 路径下）。
cd /etc/Nginx/logs
查看实时日志（根据 Nginx 配置时所配置的日志文件）。
tail -f access.log
可以很清晰地看出黑客攻击的路径或点，这时就可以根据具体情况来配置了。
①停掉 Nginx 进程。
②查看 Nginx 的进程 id。
ps -ef | grep Nginx*
③用 kill -9 [pid]强制性把 Nginx 杀掉。
kill -9 23423
④修改 Nginx 配置文件（根据自己配置的所在目录）。
vi /etc/Nginx/conf.d/Web.conf
⑤找到刚刚黑客攻击的地方，代码如下。
location /cstor / {
…
}
⑥增加防盗链，修改如下。
location / cstor / {
valid_referers xxx.com;
if ($invalid_referer) {
return 403;
}
…
}
注：xxx.com为用户自己所需要放开的地址，例如，用户公司的网站域名等。
206 大数据应用部署与调优
3．信息泄露
信息泄露是信息安全的重大威胁，国内外都发生过大规模的信息泄露事件。
2020 年 2 月，体育连锁巨头迪卡侬（Decathlon）发生大范围数据泄露事件，起因
是 1.23亿条记录被保存在一个并不安全的数据库中。这是由 vpnMentor安全研究人员发
现的，并在 2020年 2月 24日公布。该数据库属于迪卡侬西班牙和迪卡侬英国公司。泄
露的数据涉及员工系统用户名、未加密的密码、API日志、API用户名、个人身份信息
等。对于迪卡侬员工来说，涉及的信息包括姓名、地址、电话号码、生日、学历和合同
明细；而对于客户来说，涉及的信息包括未加密的电子邮件、登录信息和 IP地址。
2020 年 3 月 31 日，万豪国际集团发布公告称，正在调查一起涉及客户个人信息
泄露事件，约 520 万名客户的资料可能被泄露。在不到两年的时间里，万豪发生了第
二次大规模数据泄露事件；最终，因未能确保客户个人数据安全，万豪国际被罚1840万
英镑。与此同时，接连两次的股价大跌，直接导致万豪数十亿元市值蒸发。
除了外部攻击的信息泄露外，企业的内部员工利用访问权限获取用户的相关数据，
并非法在黑市上贩卖牟利。这些被贩卖的数据，会被黑客或者其他不法分子利用，借
助社会工程学，对受害者进行诈骗。
4．灾害
灾害发生的概率非常小，但是后果是巨大的，可能会造成整个数据中心停止运行。
1）洪灾
由于恶劣天气和排水不畅，可能会造成水倒灌进数据中心，发生设备短路等故障。
2009 年 9 月 9 日，土耳其伊斯坦布尔遭遇暴雨并引发洪水。疯狂肆虐的洪水淹没了该
市 Ikitelli 区的大部分地段，也淹没了位于该区的 Vodafone 数据中心。
2）火灾
2008 年 3 月 19 日，美国威斯康星数据中心被火烧得一塌糊涂。根据事后统计，
这次大火烧掉了 75 台服务器、路由器和交换机，当地大量的站点都发生了瘫痪。
3）地震
2011 年 3 月 11 日，日本遭受了 9 级大地震。在此次地震中，日本东京的 IBM 数
据中心也受损严重。
4）人为因素
2015 年 5 月 27 日下午 5 点左右，由于光纤被挖断，部分用户无法使用支付宝。
随后支付宝工程师紧急将用户请求切换至其他机房，受影响的用户才逐步恢复使用。
6.1.4 安全措施
1．安全制度规范
政府、企业以及其他组织一般会制订内部的信息安全相关制度，用以规范和约束
管理体系中的各项工作内容，从而确保环境的安全稳定运行，一般包括以下内容。
第 6章 高级系统运维 207
1）人员组织
人员组织用以明确细分各级人员对于信息安全的责任和义务，明确信息安全的管
理机构和组织形式。
2）行为安全
行为安全用以明确细分每个人在组织内部允许和禁止的行为。
3）机房安全
机房安全制度明确细分出入机房、上架设备所必须遵守的流程规范。
4）网络安全
网络安全制度明确组织内部的网络区域划分，以及不同环境网络功能和隔离措施。
5）开发过程安全
开发过程安全制度明确软件的开发设计和测试遵守相关规范，开发体系和运维体
系分离，源代码和文档应落地保存。
6）终端安全
终端安全制度明确终端设备的使用范围，禁止私自修改终端设备，应设置终端口
令，及时锁屏，及时更新操作系统补丁等。
7）数据安全
数据安全制度不对外传播敏感数据，生产数据的使用需要在监督和授权下执行。
如果需要对外提供相关敏感数据，应对数据进行脱敏处理。
8）口令安全
明确口令的复杂程度、定时修改周期等。
9）临时人员的管理
明确非内部员工的行为列表、外包人员的行为规范，防范非法入侵。
2．安全防范措施
在各个层次都有成熟的安全产品，可以供选择来构建组织内部的防御体系，如表6-3
所示。
表6-3 安全产品层次