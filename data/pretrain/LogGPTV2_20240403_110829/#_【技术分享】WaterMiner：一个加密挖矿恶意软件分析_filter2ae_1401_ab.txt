为了在受害者机器上执行挖矿任务，挖矿软件自然地会产生大量的计算，这在一定程度上会占用受害者很多的CPU资源。这意味着当受感染的系统变慢的时候，受害者可能会意识到机器哪里出现了问题。为了调查原因，受害者可能会打开Windows任务管理器或相应的应用程序来查看那个应用拖慢了系统。在WaterMiner攻击活动中，当有如下名字的窗口打开时，攻击者会使用原本的XMRig来避开检测，这些窗口名字是：
**Windows Task Manager (英文或俄文)**
**Task Manager**
**AnVir (俄语的task manager)**
**Process Hacke**
下面的截图中显示了XMRig中检查这些窗口的代码：
会让WaterMiner停止挖矿以逃避探查的窗口名
挖矿机一旦检测到了上述任何应用，挖矿的进程就会停止，使得受害者难以发现恶意程序的存在。早期的同一个攻击组织传播的恶意软件变体包含了另一种不同的测试：挖矿机并不去查看窗口，而是试图通过检查运行进程列表来检测显示器上的应用，一旦下列进程被发现，则它会关闭其自身。
如果找到Task Manager 或 AnVir 则调用 taskkill 来关闭恶意软件
Minerva的反入侵平台通过使恶意软件以为它在持续地受到监视从而迫使其停止所有挖矿活动，该方法正好是利用了挖矿机本身的躲避机制。
**  
**
**谁是WaterMiner背后的组织？**
在网络犯罪的世界中，我们经常遇到品行良好的组织团伙。然而，似乎门罗币也吸引了很多聪明的独行侠，他们并不是我们通常情况下想象中像犯罪大师那种的攻击者，就如同阿拉斯加在淘金热中也同样引诱了很多挖矿者一样。
阿拉斯加淘金热期间的挖矿
根据几个论坛的帖子和Minerva追踪到的源码，WaterMiner组织背后的人似乎藏在“Martin
Opc0d3r”这个化名之后，并且具有开发其他恶意软件的经验，例如bots木马和游戏mods。然而，他最近似乎意识到他开发的mods（用几种不同的恶意软件感染他的“客户”，其中包括加密货币挖矿机）是可以赚钱的。Minerva定位到了WaterMiner中的某个常量URL（hxxp://cw36634[.]tmweb[.]ru/getfile[.]php?file=12），在另外至少12个样本中，都存在由同一个人创建的，几乎从相同的URLs里下载恶意软件，具体如下图所示：
Minerva定位到了更多的例子，它们使用了另一个域名，使用的URL都使用了一个相同的模式：
有些内容已经失效，可能要么是被提供者移除，要么是攻击者自己移走了。但是，从其中尚且有效内容的探查中，我们找到了好几种版本的转换后的XMRig和NiceHash挖矿机，它们同WaterMiner组织之前的样本和代码片段非常相似。另一个0pc0d3r的代码片段在Pastebin上是公开的，这让我们相信，上面某些失效的内容正是木马使用的URL：
其他证据指出，0pc0d3r老版本的带有木马mods被终端用户发现了。通过这条证据，Minerva定位到了另一个俄罗斯论坛，hxxps://video[.]fishyoutube[.]com/watch?v=lU0xJSuj-ZM, we observed the publication of a different mod. Its users posted comments
to flag it with words such as “stealer”, “Trojan” and called 0pc0d3r “the
result of incest”:
从0pc0d3r差劲的操作来看，很明显我们并不是在面对一个老练的网络罪犯。通过跟踪与这个化名有关的活动，我们发现了背后这个人的可能的身份。在俄罗斯社交网络VK上，Anton
[ redacted]这个人提供了0pc0d3r的mod：
当一个用户指责Anton倒卖0pc0d3r的作品的时候，Anton非常骄傲地承认自己就是这个身份背后的人：
结合其他我们在分析这个组织时收集到的敏感信息，我们相信Anton应该就是0pc0d3r-WaterMiner背后的人。
**  
**
**结论与建议**
有善必有恶，这句话也符合加密货币的快速发展。这个全新的领域，混合了前沿的加密算法和抽象的经济观点，人们很难抵御通过非法手段谋取利益的诱惑。当下，加密货币尚未完善，通过backlist主机和端口组合就可以成功地阻挡大部分挖矿机。然而，我们预测挖矿恶意软件将变得更加成熟，也会在防火墙和IPSIDS产品上实验。幸运的是，就如同其他常见的恶意软件一样，它们越想隐蔽，Minerva的反入侵平台就越能够高效地封锁它们。
**  
**
**IOCs**
**IP**
·93[.]188[.]160[.]90
·92[.]53[.]96[.]133
**Hashes (SHA-256)**
·1852bf95b91bc50fb10cd0388595d88ce524dca9607aa3621e7b2587f326ec9d (original
mod)
·b23ce6a8af6cbf7dae517f6736aa69c451347f6b5e7e66d5a1339a4d74e10e66 (WaterMiner
downloader)
·715c3a8f7d5cd921b321a4fa180862315846f408b903d9d2888ae95912dbb9ca (payload)
·db4f825732f27f1163367226c7d565714455f3f51c1cdbd858ed4a0b2335515b (older
payload)
·f5f762a56578a939623da00d8a7bd857c10432b6623d335da20731f9a1b131ba (older
payload)
·1347fbbb5f0c41a27dd06d4d02588e72cd1c8ba6dd609ae15d042895ed1211e9 (older
payload)
·83cfa3f13e6e851c670e491ea29feafa98cb9554fb0458b4897b20b5b0598be2 (older
payload)
**Process Names**
·Intel(R) Security Assistent.exe
**URLs**
**·Downloader:**
hxxps://goo[.]gl/MWTs3Y
hxxps://drive[.]google.com/uc?authuser=0&id=0B04cozXxVfySSGN6UEZfb2xpZms&export=download
**·Payload delivery:**
hxxp://cw36634[.]tmweb[.]ru
hxxp://0psofter[.]esy[.]es