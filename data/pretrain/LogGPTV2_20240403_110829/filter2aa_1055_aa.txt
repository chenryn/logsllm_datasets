# The Commercial Malware Industry
## Peter Gutmann, University of Auckland

### Some History: The Numbers Racket
The numbers racket, a precursor to the modern lottery, was initially operated through local businesses such as barber shops and grocery stores. Bets were placed for small amounts, typically cents, and players would choose a three-digit number. The "draw" was determined by the last three digits of the total amount bet on pari-mutuel racetrack betting machines. Initially, it was seen as a harmless vice, with little attention paid to it.

### Organized Crime's Involvement
However, organized crime eventually took over the numbers racket. Dutch Schultz, a notorious gangster, intimidated existing operators and hired Otto “Aba Daba” Berman, a mathematician, to manipulate the outcomes. Berman ensured that heavily-played numbers never won, a level of sophistication previously unimagined. This is akin to spammers hiring professional linguists to bypass filters, as noted by experts like Mikko Hypponen from F-Secure.

### The Modern Spam Industry
Today, the spam industry is a global operation, often involving technically skilled programmers from Russia and Eastern Europe, who frequently collaborate with local organized crime syndicates. According to Colin Galloway of Asia Times, the modern spam industry is highly organized, with significant financial incentives. In 2004, proceeds from cybercrime surpassed those from illegal drug sales, and the rapid pace of cybercrime has outstripped law enforcement's ability to keep up, as observed by Valerie McNiven, a US Treasury advisor on cybercrime.

### The Malware Industry
#### Types of Malware
- **Publicity Virus:** Created by amateur script kiddies, these are often poorly tested and barely functional.
- **Spam/Phishing Virus:** Developed by professional programmers, these are well-tested and can be highly sophisticated. For example, the Babylonia virus used plug-in virus modules (VMODs) downloaded on-demand, while the Hybris worm employed digitally-signed encrypted updates propagated via web servers and newsgroups.

#### Expertise and Compensation
Serious money can attract serious expertise. Spam vendors employ professional linguists to evade filters, and phishers use psychology graduates to scam victims. Talented employees can earn over $200,000 per year, with remote root zero-day exploits fetching between $50,000 and $100,000.

#### Recruitment
- **Recruitment Process:** A Russian script kiddie running a botnet might be reported to the mafia, who then offer him a position he cannot refuse.
- **Outsourcing:** Kernel-mode rootkits can be purchased from third-party developers, allowing malware authors to focus on the payload.

#### Zero-Day Exploits
Zero-day exploits are sold online through specialized sites, which even provide mechanisms to test the code to ensure it evades anti-virus software. For instance, the WMF exploit was available for $4,000, and a Windows Vista (-1)-day exploit was offered for $50,000 before Vista's release.

### Malware Then and Now
Modern malware is designed to be undetectable, in contrast to the Hollywood-style effects expected by some. Unlike older viruses, which caused visible damage, modern malware operates silently, making it more difficult to detect and remove.

### Malware Economics
Economic factors drive the targeting of specific platforms. For example, despite Firefox's growing market share, attackers still prefer targeting Microsoft Internet Explorer due to its larger user base and higher success rates.

### Malware via the Affiliate Model
This business model involves paying others to infect users with spyware, adware, or trojans. Pioneered by iframedollars.biz, this model has expanded to include numerous adware affiliates, particularly in the adult content industry. These affiliates use context-sensitive advertising and unethical practices to maximize their profits.

### Malware as a Service (MaaS)
Malware vendors have adopted a service-based model, similar to standard commercial software. MaaS includes offerings such as iframe exploits, pop-unders, click fraud, and spam. Services are advertised with try-before-you-buy offers, and prices vary depending on the volume and type of service.

### The Malware Business
The malware business is highly decentralized, with various roles including scammers, spammers, and cashiers. Middlemen play a crucial role, and setting up an automated clearing house (ACH) could further streamline the process. However, the decentralized nature of the system makes it resilient and fault-tolerant.

### Example: Gozi Trojan
The Gozi Trojan, available as a service, involves multiple parties:
- **Gozi Trojan:** Purchased from HangUp Team.
- **Trojan Server Management:** Handled by 76Service.
- **Hosting:** Provided by the Russian Business Network.
- **Cashier Details:** Unknown.

### The Spam Business
Spammers buy harvested email addresses and send spam through brokers. The process is highly organized, with brokers handling distribution via open proxies, relays, and compromised PCs. Spammers use techniques to obscure their sources and have their own trade associations.

### The Carding Business
Carders sell stolen credit card information and other personal data. They use IRC bots to check card validity and have reputation systems similar to eBay. Funds are laundered through compromised bank accounts, and cashiers move the money out using services like Western Union. The carding business operates like an open labor market, with transactions handled through web forums.

### Conclusion
The commercial malware industry is a complex and highly organized sector, driven by significant financial incentives and supported by a network of skilled professionals. Understanding its history, current operations, and economic drivers is crucial for developing effective countermeasures.