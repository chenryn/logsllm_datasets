The Commercial Malware Industry
Peter Gutmann
University of Auckland
Some History: The Numbers Racket
The numbers racket = Lotto before the government took it 
over
• Run through barber shops, groceries by local operators
• Bets were for cents
• Players chose a 3-digit number
• “Drawn” using the last 3 digits of the total amount bet on pari-
mutuel racetrack betting machines
Seen as a harmless vice, no-one paid much attention to it
Some History: The Numbers Racket (ctd)
Then organised crime moved in…
• Dutch Schultz took over from existing operators
• They weren’t career criminals and were intimidated by explicit 
death threats
Dutch hired mathematician Otto “Aba Daba” Berman to fix 
the numbers racket
• Ensure that heavily-played numbers never won
• No-one had ever considered this level of attack
– c.f. spammers hiring professional linguists
– “We can’t repel firepower of that magnitude”
Some History: The Numbers Racket (ctd)
Once organised crime got involved, everything changed
The modern spam industry now is spread across the globe 
and has become infested by technically organised 
programmers from Russia and Eastern Europe, often in 
league with local organised crime syndicates
— Colin Galloway, Asia Times
Most of the big outbreaks are professional operations.  They 
are done in an organised manner from start to finish
— Mikko Hypponen, F-Secure
Last year [2004] was the first year that proceeds from 
cybercrime were greater than proceeds from the sale of illegal 
drugs […] cybercrime is moving at such a high speed that law 
enforcement cannot catch up with it
— Valerie McNiven, US Treasury advisor on cybercrime
The Malware Industry 
Publicity virus: Written by bored script kiddies
• Poorly tested, often barely works
Spam/phishing virus: Written by paid professional 
programmers
• Well-tested, can be quite sophisticated
– The Babylonia virus used plug-in virus modules (VMODs) 
downloaded on-demand by the virus body
– The Hybris worm uses digitally-signed encrypted updates 
propagated via web servers and newsgroups
The [Scob trojan] attack demonstrated the same skills required 
to design an entire software application
— Dan Frasnelli, NetSec
The Malware Industry (ctd)
Serious money can buy serious expertise
• Spam vendors are employing professional linguists to bypass 
filters
• Phishers use psychology graduates to scam victims
– They have better experts than we do!
• Talented employees can earn $200,000+ per year
– Remote root zero-days can go for $50-100,000
The Malware Industry (ctd)
Obtaining new recruits
• Russian script kiddie runs a botnet
• ISP notices this and reports it to their mafia contacts
• Mafia visits the kid and makes him an offer he can’t refuse
• Kid is now working for the Russian mafia
Kernel-mode rootkits can be bought from third-party 
developers
• Outsourcing the anti-detection code allows malware authors to 
concentrate on the payload
The Malware Industry (ctd)
Zero-days are sold online
There are dozens of these sites with hackers offering zero-day 
code for sale all the time.  They even have a mechanism to 
test the code to make sure it is legitimate and will get past 
anti-virus software
— Jim Melnick, iDefense
This [WMF] exploit could be bought from a number of 
specialised sites.  Hacker groups in Russia were selling this 
exploit for $4,000
— Alexander Gostev, senior virus analyst, Kaspersky Labs
• Windows Vista (-1)-day was available for $50K before Vista 
was even released!
Malware Then and Now
People expect Hollywood-style effects from malware
• Exploding panels
• Sparks flying from the case
• Crashing alien spacecraft
Modern malware is designed to be as undetectable as 
possible
• No visible effect  it’s not there
I ran this Anna Kournikova thing and nothing happened.  Why 
not?
— Anti-virus vendor support call
Malware Economics
“Since Firefox now has appreciable market share, it will be 
targeted by malware authors”
• Only if you ignore the money factor
Let’s do the maths…
• Assume MSIE has 80% market share, Firefox has 20% market 
share
• Assume successful exploit probability in MSIE is 3 out of 4 
(75%), in Firefox is one in ten (10%)
• Do you want a 75% chance at 80% of the market (60% return) 
or a 10% chance at 20% of the market (2% return)?
Commercial attackers will expend effort to get the biggest 
market share, not short-lived bragging rights
Malware via the Affiliate Model
Pay others to infect users with spyware/adware/trojans
Business model was pioneered by 
iframedollars.biz
• (IFrames: Browser attack vector of choice)
• Pays webmasters 6 cents for each infected machine
• Alternative payment model is weekly fixed-rate payouts with 
bonuses for clean installs
If your traffic is good, we will change rates for you and make 
payout with new rates
Malware via the Affiliate Model (ctd)
Since extended to a vast mass of adware affiliates (mostly 
porn)
• 12clickscash.com, camazoncash.com, 
gammacash.com, trafficcashgold.com, … (way too 
many to list)
• dollarrevenue.net pays 30 cents for each install of their 
adware in the US, 20 cents in Canada, 10 cents in the UK, and 
one or two cents elsewhere
• T&C generally claim that they’ll terminate affiliates who do 
anything unethical
– Yeah, right
See www.klikteamparty.com for one company’s 
end-of-year party (Mercedes C-Class, Vaios, strippers…)
Malware via the Affiliate Model (ctd)
Adware spams ads in a context-sensitive manner
• User Googles for something
• Adware spams the user with their affiliate’s version of the 
product before they get a Google response
– Variation: Rewrite the search results in the browser to 
favour your products
• Satanic version of the MS Office Assistant
It looks like you’re searching for dog food. Would you like to be 
spammed with penis enlargement ads instead?
Malware via the Affiliate Model (ctd)
A morass of grey-market and unethical practices
• Vendor puts an EULA on their adware so they can claim that 
they warn the user on install
• Affiliate uses OLE automation to click past the EULA without 
the user even seeing it
Piggyback malware on legitimate software
• CoolWebSearch co-installs a mail zombie and a keystroke 
logger
• Gathers credit card numbers, social security numbers, 
usernames, passwords, …
Malware as a Service
Standard commercial vendors are embracing SaaS
• Malware vendors have MaaS
MaaS is advertised and distributed just like standard 
commercial software
Iframe, pop under, накрутка счетчиков, постинг, спам
Также я советую если у вас нет сплоита и трафа, вы
можете взять в аренду у здесь
Iframe exploits, pop-unders, click fraud, posting, spam
If you don’t have it, you can rent it here
• Online video tutorials of the malware in action
Malware as a Service
Try-before-you-buy offers for malware
Трафик на сплоиты. 
Для пробы всем Бесплатно 100 посетителей!!! 
Цена
4 $ за 1000 посетителей - При заказе от 1000 до 5.000
3.8 $ за 1000 посетителей - При заказе от 5.000 до 10.000
3.5 $ за 1000 посетителей - При заказе от 10.000 
Traffic for sploits
Free trial, 100 visitors!!!
Price
$4 per 1000 if buying 1000 – 5000
$3.80 per 1000 if buying 5000 – 10,000
$3.50 per 1000 if buying over 10,000
Malware as a Service (ctd)
Back-end databases 
and control 
systems managed 
via web GUIs
• Sophisticated, 
skinnable
interfaces
• Briz/VisualBriz
at right
Image courtesy Alex Eckelberry, Sunbelt Software
Malware as a Service (ctd)
Buy the basic version for $1000-2000 (Gozi)
• Purchase add-on services at varying prices starting at $20
Также вы може взять и другие страны на заказ. 
За подробной информацией обращайтесь к суппортам
In other countries on request.  Contact us for support
Prices vary by as much as 100-200% across sites – shop 
around
• Prices for non-Russians are often higher
• If you want the discount rate, buy via Russian sites
Malware as a Service (ctd)
Prices are generally advertised in wmz (USD-equivalent 
WebMoney currency)
• WebMoney = more bulletproof Russian version of PayPal
Icq спам по ONLINE номерам
Для пробы всем Бесплатно 10.000 сообщений !!! 
10 000 сообщений - 0,5 wmz
15 000 сообщений - 1,0 wmz
50 000 сообщений - 3,0 wmz
100 000 сообщений - 5 wmz
200 000 сообщений - 9 wmz
500 000 сообщений - 15 wmz
1 000 000 сообщений - 20 wmz
ICQ spam, free trial 10K messages, prices in wmz
Malware as a Service (ctd)
Server-compromise tools are sold in a similar manner
• Feed the tool a list of accounts and it does the rest
Malware as a Service (ctd)
Basic server-exploit tools typically go for $20-25
• Previous slide was FTP-Toolz, a front-end for the MPACK 
exploit toolkit
– Automates deployment of MPACK
– MPACK itself sells for ~$1000
Prime Exploit System - 20 $ (довольно неплохой сплойт)
Нуклеар - 40 $ (Хороший сплойт даже очень) 
+ Ежемесечная оплата за польззования хостингом 10$
Prime Exploit $20 (not so bad sploit)
Nuclear (Grabber) $40 (very good sploit)
Additional $10 payment for hosting
Example: Information Stolen by Malware
Malware server found by investigators contained
• Information from 5,200 PCs
• 10,000 account records for 300 organisations
– Top global banks and financial companies
– US federal, state, and local government
– US national and local law enforcement
– Major US retailers
• SSNs and other personal information
• Patient medical information (via healthcare employees)
US regulations (HIPAA, GLBA, etc) made reporting this to 
the victims very difficult
The Malware Business
Everything can be outsourced
• Scammer buys hosts for a phishing scam
• Buys spam to lure the punters
• Buys drops to send the money to
• Pays a cashier to cash out the accounts
You wonder why anyone still bothers burgling houses 
when this is so much easier…
The Malware Business (ctd)
The money seems to be in being the middleman
• If someone could figure out how to set up an automated 
clearing house (ACH), they’d really clean up
• Probably not possible since it breaks the decentralised model 
that makes the system fault-tolerant
Botnet vendors
Independent 
businessmen
Carders
Malware vendors
Anti-det.vendors
Example: Gozi Trojan 
Available as a service from iFrameBiz, stat482.com
• Gozi Trojan bought from HangUp Team, hangup.da.ru
• Trojan server managed by 76Service, 76service.com
• Trojan server hosted by Russian Business Network, 
www.rbnnetwork.com
• Cashier details unknown
The Spam Business
Buy CDs with harvested addresses
• Prices vary depending on the quality
• Vacuum-cleaner for ~$50, verified for $x00
Send mail via spam brokers
• Handled via online forums like specialham.com, 
spamforum.biz
• $1 buys 1000–5000 credits
• $1000 buys 10,000 compromised PCs
• Credit is deducted when the spam is accepted by the target 
MTA
The Spam Business (ctd)
Broker handles spam distribution via open proxies, relays, 
compromised PCs, …
• Sending is usually done from the client’s PC using broker-
provided software and control information
• Sources are obscured using spread-spectrum/frequency-
hopping style techniques 
This is a completely standard commercial business
• The spammers even have their own trade associations
Nearly a third of users have clicked on links in spam 
messages.  One in ten users have bought products advertised 
in junk mail […] the fact that users are buying things continues 
to make it an attractive business, especially given that sending
out huge amounts of spam costs very little
— BBC News
The Carding Business
Prices are openly published or subject to private 
negotiation
• “CVV for $1, CVV with SSN for $10, bank account $50, …”
– “CVV” implies full CC details down to the CVV level
– A “dump” in carder jargon, dump of the magstripe info
• Some sources give bulk discounts for larger CVV purchases
Carders have ebay-style reputation rating systems
• #rippers on carder IRC nets
The Carding Business (ctd)
Card checks are performed via IRC bots
• !chk cardno expiry
• !cclimit cardno
• !cvv2 cardno expiry
– CVV is the 3-4 digit crypto checksum on the back of the 
card
– Required as an extra check by some merchants
• This is more sophisticated than many merchants!
The Carding Business (ctd)
User identities are hidden via IRC proxies (bouncers) on 
hacked PCs
The trade of BotNets on compromised machines is becoming 
an industry in itself.  Organised crime is making use of this 
industry
— Detective Chief Superintendent Les Hynds, 
head of the UK National Hi-Tech Crime Unit
Funds are moved into drops
• Compromised bank accounts used to launder funds
• Scammers are big fans of online banking, especially via other 
people’s accounts
The Carding Business (ctd)
Cashiers cash out the contents of the drops
• Take 50% of the funds to move the money out via services like 
Western Union
• Many, many ways to cash out the funds.  Example: Find a 
business with $10K of debt, agree to pay them $20K if they 
cash out 50% of the funds
System works like an open labour market
• Handled via web forums like cardingworld.cc, 
darkmarket.org, talkcash.net, 
theftservices.com
• “Need spammer to fill Hotmail boxes, will pay through 
percentage of phishing proceeds”
• “Will trade CVV2 for web site account”
Example: carderplanet.net
i can provide you with excellent credit cards with cvv2 code and
without it. Minimum deal is a USD $200.00. 
•
USD $200.00 - there are 300 credit cards without cvv2 code ( visa 
+ mc ) - USA (included credit card number, exp.day. cardholder 
billing address, zip, state). 
•
USD $200.00 - there are 50cc with cvv2 code (visa + mc) USA 
(included credit card number, exp.day. cardholder billing address 
& CVV code from the back side of the card). 
Also i can provide cards with SSN+DOB. COST 40$ per one. 
Minimal deal 200$ 
•
Also i can provide Europe credit cards, France, Germany + UK 
and many other contries around the globe. 
•
All credit cards with good exp day and it's work also so good. 
Example: vendorsname.ws
On our forum you can buy: 
•
Credit cards with Change Of Billing (COBs)*
•
Dumps of US and European credit cards (Platinum, Gold and 
Classic) 
•
Active eBay accounts with as many positive feedbacks as you 
need 
•
Active and wealthy PayPal accounts 
•
Drops for carding, cashing and money laundering 
•
Carded electronic and stuff for as low as 40 percent of market 
price 
•
PINs for prepaided AT&T and Sprint phone cards 
•
Carded Western Union accounts for safe and quick money 
transfers 
… continues..
* COB = credit card with billing address changed to carder mail drop
Example: vendorsname.ws (ctd)
… continued…
•
Carded UPS and FedEx accounts for quick and free worldwide 
shipping of your stuff   
•
Full info including Social Security Info, Driver Licence #, Mother' 
Maiden Name and much more 
•
DDoS attack for any site you need, including monsters like 
Yahoo, Microsoft, eBay
Come and register today and get a bonus by your choice: 
•
One Citybank account with online access with 3k on board, or 
•
5 COB' cards with 5k credit line  
•
10 eBay active eBay accounts with 100+ positive feedbacks 
•
25 Credit Cards with PINs for online carding 
Be in first 10 who register today and get the very special bonus from 
Administration of Forum. 
The Carding Business (ctd)
Obvious: Get 25 PCs shipped to eastern Europe via 
intermediaries (re-shipping rings)
• Merchandise is shipped via US middlemen
– “Earn big bucks working from home!”
• Countermeasure: Merchants refuse to ship internationally
Slightly less obvious: Set up CC processing on behalf of a 
legitimate company