# OCR Output
## Page 1
如果Ansible、Puppet、
面对众多的设备类型如何实现自动化运维？
吴文豪著
软件设计实战
自动化运维
oa
SaltStack都无法满足你对自动化运维的需求，
那么本书将会带给你一种全新的思路！
des
---
## Page 2
软件设计实战
自动化运维
吴文豪著
Publishing House of Electronics Industry
电子王棠出版社
北京·BEIJING
---
## Page 3
联系及邮购电话：（010）88254888。
版
开
出版发行：
装
责任编辑：
中国版本图书馆CIP数据核字（2015）第142285号
I.①自.II.①吴I.①JAVA语言一程序设计IV.①TP312
ISBN 978-7-121-26468-9
自动化运维软件设计实战/吴文豪著，一北京：电子工业出版社，2015.7
图书在版编目（CIP）数据
版权所有，侵权必究。
未经许可，
设计思想。
为什么要采用OSGi的技术来设计集中化运维软件，第三部分介绍设计这款运维软件所涉及的技术和一些
的运维软件设计与自动化运维解决方案。
质量投诉请发邮件至PI:EMAIL，
本书分三部分，第一部分讲解开源社区中比较流行的三款集中化运维软件，第二部分与读者一起分享
服务热线：（010）88258888。
凡所购买电子工业出版社图书有缺损问题，请向购买书店调换。若书店售缺，请与本社发行部联系，
本书适合从事系统运维及运维开发的人员阅读。
本书主要讲解采用OSGi技术来设计一款可插拔式的运维软件的方法与思想，为读者提供一种不一样
订：
数：3000册定价：69.00元
刷：
次
本：
：2015年7月第1次印刷
：北京京师印务有限公司
：北京京师印务有限公司
北京市海淀区万寿路173信箱
，不得以任何方式复制或抄袭本书之部分或全部内容。
2015年7月第1版
787×9801/16印张：18.25
电子工业出版社
陈晓猛
，盗版侵权举报请发邮件至PI:EMAIL。
字数：408.8千字
邮编：100036
内容简介
---
## Page 4
在思想上的碰撞，在碰撞中让读者发现一些其他的方法。
某个功能如何实现，我们搜索一下就会找到很多方案，而思路的分享更能引起读者与笔者
提供一种不同的思路。书中的内容以思路分享居多，因为笔者认为如今的互联网非常发达，
本书面向的读者
享的内容能够对运维的小伙伴们有所帮助。
与ApacheActiveMQ整合所设计的运维软件的书籍，这让我感到非常荣幸。
是，电子工业出版社的编辑通过我的博客联系上了我，希望我可以写一本关于采用ApacheKaraf
所设计的运维框架也有它的一些优点，于是在OSChina上写了一篇博客与大家分享。非常巧的
决我们所面临的问题。
后，偶然发现OSGi这种技术能够解决我们的问题，所以也就自己重新造了一个轮子来解
常不错的选择，但是偏偏在我们所要面对的环境下用起来实在太困难。在和同事讨论之
当然，还有项目进度的步步紧逼。对于运维的功能，Ansible、Puppet、SaltStack 都是非
面对技术水平参差不齐的维护团队，各种各样的操作系统，限制条件非常多的网络环境，
而且开发过程也非常坎坷。当做到运维部分的时候，出现了非常大的挑战，我们不得不
技术，让我感慨时间过得还是挺快的。
本书面向的读者是从事系统运维的开发人员，希望能够给读者在设计运维软件的时候
我把当初设计这套软件的思路以及一些需要注意的要点写在了这本书中，希望我所分
项目进行得差不多的时候，我觉得ApacheKaraf与ApacheActiveMQ这两种技术整合起来
我曾经接触过一个与自动化运维相关的项目，整个项目对我来说挑战是非常大的，
不知不觉也与各种开发语言做了挺久的小伙伴，依稀记得当初很好奇用C语言这种在
前言
---
## Page 5
致谢
软件所要解决的问题。
的集中化运维框架。
ActiveMQ。
内容介绍
自动化运维软件设计实战
·感谢我的同事陈自欣，我非常佩服他在技术知识面上的广度，采用OSGi的技术来
第11章介绍如何与Zabbix进行整合。
·感谢我的家人，给了我这么多的时间让我可以专心地完成本书的写作。
第12章与读者分享了一个小故事，希望通过这个小故事让读者能够更加了解这款运维
第6章和第7章介绍重复制作轮子所需要的一些技术一
第2到第4章简单介绍目前比较热门的集中化运维软件Ansible、Puppet和 SaltStack。
第1章与读者一起探讨什么是自动化运维。
本书共12章。
的技术发展道路上少走了许多弯路。
感谢我的同事崔威，在我刚工作的时候教会了我许多软件开发的技术，让我在后续
开发运维软件的思路就是他提出来的。
ApacheKaraf和Apache
2015年5月
吴文豪
---
## Page 6
2.2
2.1
1.3
1.2
1.1
环境准备/11
安装Ansible/12
什么是自动化运维/1
2.2.2
2.2.1
小结/9
自动化运维/7
1.3.3Ansible / 7
1.3.2
1.3.1-
运维常用工具／4
1.2.3
1.2.1
软件运维的主要问题/3
1.1.3
1.1.2
1.1.1
硬件运维和软件运维/1
1.2.2
使用Easy_Install安装Ansible/14
使用CentOS的EPEL源进行安装/12
SaltStack/6
Puppet/6
设备数量多/3
小故事之二
小故事之一
虚拟化的成熟带来更大的困难/4
系统异构性大/3
硬件运维与软件运维/2
-Ansible/11
你居然不会修电脑/2
电脑专家/1
三
录
---
## Page 7
自动化运维软件设计实战
3.3
3.1
2.4
2.3
Puppet 基础/56
Puppet 与 Ansible / 52
集中化运维利器-
2.7.1
2.5.3
2.5.1
PlayBook / 37
2.4.5
2.4.4
2.4.3
Ansible常用模块/21
2.3.4
2.3.3
2.3.2
2.3.1
Ansible基础/14
3.3.1
Puppet 的常用资源／64
3.2.4
3.2.3
3.2.2
3.2.1
2.7.2
小结/50
使用Ansible的API/49
2.5.6
2.5.5
2.5.4
2.5.2
2.4.6
2.4.2
2.4.1
定时任务
Ansible 的缺点/51
Ansible 的优点/50
PlayBook使用实例-
Include语法/41
PlayBook 简介／38
Puppet主要配置文件/58
系统管理模块/33
文件管理模块/21
常用命令示例/19
执行命令/17
资产配置/14
第一个Puppet示例/62
颁发证书/61
循环/44
条
变
包
源码管理模块/30
网络相关模块/28
命令执行模块
指定目标主机/18
件
量/41
管理模块/32
cron/64
—Puppet /52
/25
集中化日常巡检/46
---
## Page 8
4.9
4.8
4.1 SaltStack、Puppet、Ansible /77
#
3.5
3.4
4.7.1target/89
无主服务器模式运行／88
4.4.5 Template、Extends、Includes /85
无Agent 模式—
集中化运维利器
4.9.1
小结/96
4.8.1
Pillar/9
实时执行命令／89
使用SaltStack的定时作业/89
4.4.1top.sls/82
Salt State概述／82
SaltStack的基本组成/81
3.5.2
3.5.1
小结
4.8.2
4.7.3
4.7.2
4.4.4
4.4.3
4.4.2
3.4.3
3.4.2
3.4.1
Puppet 语法基础/71
3.3.5
3.3.4
3.3.3
3.3.2
Pillar的一些操作方法/95
使用Pillar/94
arguments/93
Puppet 的缺点/76
Puppet 的优点/76
/76
SaltStack的优点/96
function/93
state文件/83
变量/73
服务管理-
93
SaltState 之 Requires/84
配置主机/83
类/73
资源/72
包管理一
文件管理一
命令执行
SaltSSH/79
packag/69
service/70
—file/67
exec/65
-SaltStack/77
---
## Page 9
自动化运维软件设计实战
6.3
6.2
6.1
5.5
5.1
消息发送/136
重复造一个轮子/97
4.9.2SaltStack的缺点/96
消息生命周期/160
6.2.2FailOver的常用参数/159
6.2.1
断线重连机制FailOver/158
6.1.5
6.1.4
6.1.3
6.1.2
6.1.1
ActiveMQ概览/136
5.5.5
5.5.4
5.5.3
5.5.2
5.5.1
Apache Karaf / 123
5.4.3
5.4.2
5.4.1
ActiveMQ基础/104
轮子需要的特性/102
5.2.4
5.2.3
5.2.2
5.2.1
困难重重/100
从一个自动化运维软件说起/97
配置FailOver/158
BlobMessage /145
BytesMessage/140
MapMessage/138
TextMessage/136
制作第一个OSGi包/127
OSGi简介/123
多变的客户需求/101
为什么选择Karaf/124
4
第一个ActiveMQ例子/117
运维设备的总量大/100
启动ApacheKaraf/126
基础架构设计/124
部署ActiveMQ/114
配置ActiveMQ/105
艰难的环境/100
多样的设备类型/100
---
## Page 10
7.6
7.5
7.4
7.3
L
6.6
6.4
7.6.1使用Maven创建项目/204
扩展Karaf控制台/203
Karaf子实例/197
7.4.1Karaf.Out/194
Karaf的日志/194
7.3.4SSHD模块/192
7.3.3
7.3.1Shell模块/187
使用控制台/187
7.2.2
ServiceWraper/180
理解Import和Export/176
6.6.5
6.6.4
6.6.3
6.6.2
6.6.1
ActiveMQ的HA方案/173
7.5.2
7.5.1
7.4.3
7.4.2
7.3.2
7.2.3
7.2.1