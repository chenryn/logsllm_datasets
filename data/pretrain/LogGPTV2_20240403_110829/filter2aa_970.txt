â€œQuantumâ€ Classification 
of Malware
John Seymour (PI:EMAIL)
2015-08-09
whoami
â€¢ Ph.D. student at the University of Maryland, 
Baltimore County (UMBC)
â€¢ Actively studying/researching infosec for 
about three years (mostly academic)
â€¢ Currently work for CyberPoint International
Outline
â€¢ D-Wave Basics
â€¢
The D-Wave Controversy
â€¢
How to play around on a D-Wave
â€¢ Some Machine Learning Background
â€¢ Building a â€œQuantumâ€ Malware Classifier
https://blog.kaspersky.com/quantum-computers-and-the-end-of-security/
What you might have heard
(and why itâ€™s wrong)
â€¢ FALSE: The D-Wave can solve NP-Complete 
problems in polynomial time.
â€¢ PROBABLY FALSE: The current D-Wave chip is 
already â€œbetterâ€ than classical computing for 
hard problems.
The Current State of Affairs
Quantum effects are happeningâ€¦
â€¦but that might not be interesting
We don't know whether the D-Wave uses 
quantum effects for computation.
Regardless, it cannot run Shor's/Grovers/QKD.
http://www.dwavesys.com/
http://www.nytimes.com/
http://www.nytimes.com/
http://www.dwavesys.com/
http://www.dwavesys.com/
http://www.dwavesys.com/
D-Wave chips consist of:
â€¢ magnetized niobium loops
â€¢ couplers
http://www.dwavesys.com/
The D-Wave QUBO
ð‘–
ð‘Žð‘–ð‘žð‘– +  
ð‘–,ð‘–
ð‘Žð‘–ð‘–ð‘žð‘–ð‘žð‘–
"Quadratic Unconstrained Binary Optimization"
Input
Output
Theyâ€™ve got a website. To do stuff on and stuff.
System 6
System 13
One D-Wave Run
Input
Output
Blackbox/QSage
â€¢ Software, developed by D-Wave
â€¢ Turns arbitrary problems into QUBOs
â€¢ Heuristic-based (problem is NP-Complete)
â€¢ Conversation between classical machine and 
D-Wave
â€¢
Adds time from network latency
Blackbox Python Code
So what can D-Wave machines do?
D-Wave claims applications: classification, 
protein-folding models, finding close-to-
optimal solutions to NPC problems (e.g. 
Traveling Salesman)
Crash Course in Machine Learning
(At least whatâ€™s relevant to this)
Boosting - using combinations of 
weak classifiers
â€¢ Consider 3 classifiers with 70% accuracy
â€¢ Majority vote can increase your accuracy to 
0.7838! (Hint: add up the top row)
â€¢ Most boosting algorithms also allow weights 
for these classifiers.
http://mlwave.com/kaggle-ensembling-guide/
All Correct:
0.7 * 0.7 * 0.7 = 0.3429
Two Correct:
3 * 0.7 * 0.7 * 0.3 = 0.4409
Two Wrong:
3 * 0.3 * 0.3 * 0.7 = 0.189
All Wrong:
0.3 * 0.3 * 0.3 = 0.027
Loss
â€¢ Want to minimize:
â€¢
Number of misclassifications
â€¢
Complexity of the model
N-Grams
â€¢ Sliding window over text
ð·ð·ð´ð·ð´ð·ð·ð·
N-Grams
â€¢ Sliding window over text
ð·ð·ð´ð·ð´ð·ð·ð·
N-Grams
â€¢ Sliding window over text
ð·ð·ð´ð·ð´ð·ð·ð·
N-Grams
â€¢ Sliding window over text
ð·ð·ð´ð·ð´ð·ð·ð·
N-Grams
â€¢ Sliding window over text
ð·ð·ð´ð·ð´ð·ð·ð·
â€¢ Easy to generate
â€¢ Used before in malware with good results
â€¢ Easy to turn into weak classifiers
â€¢ Complex enough to compare classifiers
Building the â€œQuantumâ€ Malware Classifier
QBoost
â€¢ Outperforms Adaboost
â€¢ Robust to label noise
â€¢
Will generally still learn even if training data is 
mislabeled
â€¢
Good for learning malware: ground truth is hard!
â€¢ Doesnâ€™t scale to â€œGoogle-sized problemsâ€
â€¢
Blackbox supposedly can
Dataset used
â€¢ Plenty of malicious datasets to choose from
â€¢
Vx Heaven, VirusShare, scraping the web
â€¢
We used Vx Heaven (fairly standard but old)
â€¢ No standard for benign dataset
â€¢
Problematic
â€¢
Windows + Cygwin + Sourceforge
â€¢
Donâ€™t do this
â€¢
No adware was used in the making of this classifier
(Classical) Preprocessing
â€¢ Resample corpus to be balanced
â€¢
Side-effects: Less time to train, lose information
â€¢ Extract Features (3-gram bytes)
HTTP://XKCD.COM/221/
At first, our classifier was
no better than random chance
Next question: how long do we
need to let Blackbox run?
â€¢ Previous work says 30 minute timeout
â€¢
Pilot Experiment to find how long it should take
â€¢ Even on small problems, it takes 10 minutes to 
find decent solutions
â€¢ Larger problems require even more time
â€¢ Limited to 32 features
â€¢
We used 16 malware and 16 benign n-grams
â€¢
Implemented QBoost with 10-fold cross-
validation using Blackbox
â€¢
Both on D-Wave and using a simulator
â€¢ Compared to several models from WEKA
â€¢
Adaboost
â€¢
J48 Decision Tree
â€¢
Random Forest
Results
Results
Interesting Result 1: takes a LOT of time
Results
Interesting Result 2: Simulator > actual chip
What does it mean?
â€¢ Blackbox/D-Wave CAN learn a classifier
â€¢
Probably a bad idea: significant overhead and 
must restrict problem substantially
â€¢
We donâ€™t know if this is due to Blackbox, the D-
Wave chip, or some other issue
â€¢ General problem-solving on D-Wave is 
probably a bad idea
â€¢
Really shouldâ€™ve stuck with QBoost
â€¢ How much better is the next D-Wave chip?
â€¢ Embed directly onto chip, rather than use 
heuristics
â€¢ Better for another task?
â€¢ e.g. feature preprocessing
â€¢ Machine Learning Standards for Malware 
Analysis
Thank you!
Questions?
PI:EMAIL, @jjseymour3
References
Original thesis: J. Seymour. Quantum 
classification of malware.
Dataset prep: J. Seymour and C. Nicholas. 
Overgeneralization in feature set selection for 
classification of malware.
Qboost: V. S. Denchev. Binary classification with 
adiabatic quantum optimization.
Qloss: V. S. Denchev. Robust Classification with 
Adiabatic Quantum Optimization.
References
Tutorial on Binary Classification using D-Wave: 
https://web.archive.org/web/2013092715505
3/http://www.dwavesys.com/en/dev-tutorial-
qbc.html.
Evaluating Blackbox: C. C. McGeoch and C. 
Wang. Experimental evaluation of an 
adiabiatic quantum system for combinatorial 
optimization.