   Ł ºª   º     º ª       ª  Œ         —  ø  —ø  ª  
   Ł ºª  º     º ª    Ø Œ ª Œ       —  ø ø ª   ł  
   Ł ºª  º     º ª      ª Œ       —  ø ø —ª  ß  
   Ł ºª  º     º ª    Ø Œ ª Œ       —  ø ø     œ 
   Ł ºª  º     º ª      ª Œ       —  ø ø   ß  ø
   Ł ºª  º     º ª    Ø Œ ª Œ       —  ø ø      ø
ª  
I Q $ R   N . * + $ , - .
EIP myJunk1 260 1
I . N  „    O  l  Q R     l \ , 5 .
myJunk2(A’s) 0x0012f460 ( esp-10) jmp esp eip shellcode myJunk2+10 N 
 ] ; ?$$
 $12+!"2+2+12+$2+1"2+,2+2+"2+"2+"2+"2+"2+"2+
2+2+2+2+2+2+2+2+2+2+!2+2+2+2+!
2+2+2+2+2+2+2+!2+!2+2+2+2+2+2+
2+2+2+2+2+2+2+2+2+2+2+2+2+2+
2+2+2+!2+2+!2+2+2+2+2+"2+2+$2+2+!
2+2+2+2+2+2+2+2+2+$2+2+,2+2+,2+$
2+$2+2+2+$2+2+2+2+!2+2+2+2+2+$2+
2+2+2+2+!2+$2+2+2+2+,2+2+2+2+2+
2+2+"2+$2+2+2+2+$2+2+2+2+2+2+2+
2+"2+2+$2+"2+2+$2+$2+2+"2+2+2+2+2+,
2+"2+2+"2+2+2+12+2+2+"2+2+2+2+2+
2+,2+2+2+2+,2+2+2+2+2+2+2+2+$2+
2+2+2+2+2+2+2+2+2+2+2+$2+2+2+$
2+2+2+$2+2+2+2+2+$2+2+2+2+2+$2+
2+2+$2+$2+2+2+2+2+2+12+"2+2+$2+2+
2+2+2+"2+2+2+2+2+2+2+2+2+2+2+
2+2+2+$2+2+2+2+2+2+$2+2+2+2+2+$
2+$2+2+2+2+2+$2+2+12+$2+2+2+!2+2+!
2+2+"2+2+!2+12+2+"2+2+2+2+2+2+2+!
2+$2+2+12+2+2+2+2+2+2+!2+12+!2+2+
2+12+2+2+2+2+,2+2+2+2+,2+2+2+2+
2+2+$2+2+2+2+2+2+
1% $1
':8@.*A-
%:8@.1
$':8@.-
Ollydbg
  ¶ I H  « : ;  2 3  l  fi    s 
openrce.com ollydbg (http://www.openrce.org/downloads/browse/OllyDbg_Plugins 
  / 0 #   $  ]    ˆ   $ : ; i 
exploit OllySEH http://www.openrce.org/downloads/details/244/OllySEH   1
2 ] : ; \ ,   ˘  ’    $ * &  , Ł Ø 9   n A { ˘ £ /  $ 2    |  C  ˘  # F
safeseh OD 1 M 
0 0
 G : ; „ \  9 \ , z |    | U  ]  * &     o   n /  H z \ x  n /    2  D '   
safeseh  
$    ˘ p   \   \ £ $       +  ^ . $ ⁄ ¥ -    |     \  $ !
BlazeDVD5 SEH pop pop ret 1 M
"
   2 # | \ ,     ’ H  n /  $     –   * &    $ $ K 
ollyseh safeseh pop pop ret
  \ ¢ £   
E  
safeseh
  z  æ   !   ! $   * &    $ K    8  $
NO SEH /SafeSEH OFF pop pop ret c:\program
" "
! " # $ ( ) * + , -
files\Blazevideo\BlazeDVD 5 Professional\MediaPlayerCtrl.dll findjmp pop pop ret  % & ’
1 3 4 5 ( 7 ! 9 : ;  ) ? @ A 3 C D E F
ollydbg dll dll . / 0 2 ’  6 % 8 & B
G H ‰  I J K ¥ | U      | \ , 2 ƒ    
”Search for”-“Sequence of commmands” pop eax,pop ,ret 1
   % &  $ $ K j  >        C   $ ¢ £ > ? ' L    |  '  $ K  
findjmp.exe pop pop ret   M
$   ] % &  „ \  ¯ ] – $ % &  5 ¤  X  9 ¥  L ¤ ,call  push  + ret pop pop ret findjmp 1  M
ˆ  o J     S y £ 
msfpescan PyCommand findtrampoline 1 _ ‘  e
a H 9  x % &  ¡   8  Æ    – F H ! y £  
OK e
 "
@  ¯ 9   u &  9 ¤   ’ H      $  p   – )        $ K    Æ 
jmp esp g   ˇ
0
   |  \ ,  o   b c $ K £ y £ K 
!findtrampoline   J _ ‘ J
9 5 ¤   $ K  J    S O 
3 jmp,call,push+ret ”Log data” d   _ ‘
 t      $ $ K  | \ , ‰  G   S a H 9  ı  J  ! 
CPU _ ‘
"
  |  \ ,   K    $ K 
!searchcode jmp esp J
x  ø œ ¤ )   $ K    8 ’    , ’ G $ K    . \ ¢ £ ¶ C   K  \ , e  , I ª
dll searchopcode    1  J
O   ¤   ’ H \ x $ j $ K  p  f <     $ g Z $ K
!findtrampoline searchopcode 1
aslrdynamicbase
2 K  .   ’ H     S )  8   h “     i   
ASLR address space layout randomization (vista and d J  
0 
9 \ , z |    H  B – j A   k $      , 6 V  '  l Z $ -     2 z       \ ¢ £  
2008) 1 
$ * &    ˘ £    K S   f <   /  Æ  7  K £  y £ K   –  
non-aslr dll ASLR  1 J M J _ ‘ J
m 5    $ * &   2  7 \ , k  #   q \   6 V l Z ˆ ¸ ª -   ¡  H  B –
/dynamicbase table ASLR 2 1 
ª ” $ n
 1
…
pvefindaddr
2  †  X Y 0 $  : ;  o U ' «  .  : ; $ ø œ  \ , p q r ~ 7 s 
˚ ¸
http://www.corelan.be:8800/index.php/forum/writing-exploits/pvefindaddr-pycommand-plugin-for-immdbg/
2 3 †    J  6 7 9 $    w x  C h  q <  8 9 ' « $ w x 
4  ˛ 
I   j $ K  V6 . $ - ^  ¡ #  H  9 \ X,  o t A { $      |   $
p pop/pop/ret SEH safeseh  