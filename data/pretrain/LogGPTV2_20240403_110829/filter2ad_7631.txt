title:ZeroAUDIT
author:Aman Luthra and
James Cavanaugh and
Hugo Renzzo Oclese and
Rina M. Hirsch and
Xiang Fu
December 11, 2020      ACSACâ€™2020
ZeroAUDIT
Aman Luthra, James Cavanaugh, Hugo Renzzo Oclese, Rina M. Hirsch, Xiang Fu
Hofstra University
1
PONZI
SCHEME
2
How did you make the money?
Commercial Secret!
Research Question
Audit Transactions But Knowing 
Nothing?
3
Our Contributions
Zk-Membership Proof for 
Merkle Tree
Prove ğ‘› âˆˆğ‘‡ğ‘Ÿğ‘’ğ‘’(cid:4666)ğ‘Ÿ(cid:4667)
Given C(r) and C(n): 
r
n
Implementation & Optimization
â€¢ 25K GO on Fabric
â€¢ Small Test Exponent Test
â€¢ Chained Schnorr Groups
â€¢ Pippengerâ€™s Multi-Exponent.
â€¢ Bullet Range Proof
â€¢ â€¦
ZeroAudit Protocol
Inspect Each Transaction at Fair Market Price
â€¢ Auditor Maintain Fund Portfolio â€“ Work on Commitments
â€¢
â€¢ Certify Net Asset Value Any Time
â€¢ No Trusted Setup! 
â€¢ Eq. Proof of Commits. over 2 Groups of Different Prime Orders
â€¢ Using Range Proof
4
ZeroAUDIT Architecture
Fund B
x
Fund A
Investor
Fund C
Fund D
Fund E
ZeroAUDIT (as Auditor and Accounting)
R
R
R
R
R
Merkle Tree
Buy 10 Units of Fund A 
for $1000
FundID    StockID  Quantity SpendKey
5
Trading Operation
Fund A
Buy 10 Shares of Stock 1
1
2
3
2 Spend Keys, 2 New Cert Roots
Encrypt(Buy 10 Shares of Stock 1)
Zk-Proof
1. Fund A has enough cash (range proof)
2. Spending key is valid
3. Quantities in           same as 
1
2
6
ZeroAUDIT
x
R
x
R
R
R
2
Brokerage
Verify Fair Market Price
 Given 
 Prove: 
and 
Price Merkle Tree
SID: 1
Price: 20
SID: 2
Price: 30
7
Chained Schnorr Groups
P
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043)(cid:4666)ğ‘ƒ(cid:4667)
âˆˆğº(cid:3043)âˆˆğº(cid:3044)âˆˆğº(cid:3044)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ¿(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ‘…(cid:4667)
ğ‘”(cid:3044)(cid:2869)(cid:3013)ğ‘”(cid:3044)(cid:2871)(cid:3045) ğ‘šğ‘œğ‘‘ ğ‘
ğ‘”(cid:3044)(cid:2870)(cid:3013)ğ‘”(cid:3044)(cid:2871)(cid:3045)(cid:4593) ğ‘šğ‘œğ‘‘ ğ‘
2 Primes ğ‘(cid:3407)ğ‘:  ğº(cid:3044) ğ‘ ğ‘¢ğ‘ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ ğ‘œğ‘“ ğ‘(cid:3043)
ğ‘(cid:3407)ğ‘Ÿ:  ğº(cid:3043) ğ‘ ğ‘¢ğ‘ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘ ğ‘œğ‘“ ğ‘(cid:3045)
Pedersen Commitment:
2nd Larger Group
L
R
ğ‘ƒ(cid:3404)â„ğ‘ğ‘ â„(cid:4666)ğ¿,ğ‘…(cid:4667)
ğ‘ƒ(cid:3404) ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ¿,ğ‘…(cid:4667)
ğ‘ƒ(cid:3404)ğ‘”(cid:3044)(cid:2869)(cid:3013) ğ‘”(cid:3044)(cid:2870) (cid:3019)ğ‘”(cid:3044)(cid:2871)(cid:3045) ğ‘šğ‘œğ‘‘ ğ‘
ğº(cid:3044)
ğº(cid:3043) 
ğ‘
modulus
prime order
8
Chained Schnorr Groups
DDLP in Child Proof
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043)(cid:4666)ğ‘ƒ(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ¿(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ‘…(cid:4667)
ğ‘ƒ(cid:3404)ğ‘”(cid:3044)(cid:2869)(cid:3013) ğ‘”(cid:3044)(cid:2870) (cid:3019)ğ‘”(cid:3044)(cid:2871)(cid:3045) ğ‘šğ‘œğ‘‘ ğ‘
ğ‘ƒ(cid:3404)ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)ğ¿ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)ğ‘… ğ‘”(cid:3044)(cid:2871)(cid:3005) mod p for some D
Prover should not release D or ğ‘”(cid:3044)(cid:2871)(cid:3005)
Prover can disclose ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043) (cid:4666)ğ‘”(cid:3044)(cid:2871)(cid:3005) )
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043)(cid:4666)ğ‘ƒ(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043) (cid:4666)ğ‘”(cid:3044)(cid:2871)(cid:3005)(cid:4667)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3019)
ğ‘”(cid:3043)(cid:2869)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3034)(cid:3292)(cid:3119)(cid:3253)  ğ‘”(cid:3043)(cid:2870)(cid:3045)(cid:4593)
Key Observation: 
9
Prover knows the D
Double Discrete Logarithm Proof 
(DDLP) [Stadlerâ€™97]
Complete Merkle Tree Proof
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3043)(cid:4666)ğ‘ƒ(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ¿(cid:4667)
ğ¶ğ‘œğ‘šğ‘šğ‘–ğ‘¡(cid:3044)(cid:4666)ğ‘…(cid:4667)
P
L
R
 Disjunctive Zk-Proof
 Zk-Equality Proof Over Groups of Different Order
 [Camenisch CRYPTâ€™99] Chain Commit. on Unknown Order
 Our Approach [No Trusted Setup]
 Range Proof to Confine Values [Special Chained Schnorr Setting]
 Challenge: Huge Range 0,2(cid:2869)(cid:2876)(cid:2868)(cid:2868)
 Incorporate Inaccurate Range Proof
10
System Implementation
 25K Golang 
 Over Hyperledger Fabric
11
Performance Data
 Extra Cost Paid for No Trusted Setup
 Proof Size Huge (Needs Improvement)
12
Conclusion
 ZeroAUDIT
 Inspect Trading Transactions Without Knowing Details
 Anonymous Merkle Tree Membership Zk-Proof
 No Trusted Setup
 Simple Assumptions: DLP + Random Oracle
 Log(n) Proof Size and Verification Time (n: anonymity set size)
 Equality Proof (on Different Order Groups) Using Range Proof
 Varieties of Optimization Techniques
13
Questions
14