title:ZeroAUDIT
author:Aman Luthra and
James Cavanaugh and
Hugo Renzzo Oclese and
Rina M. Hirsch and
Xiang Fu
December 11, 2020      ACSAC’2020
ZeroAUDIT
Aman Luthra, James Cavanaugh, Hugo Renzzo Oclese, Rina M. Hirsch, Xiang Fu
Hofstra University
1
PONZI
SCHEME
2
How did you make the money?
Commercial Secret!
Research Question
Audit Transactions But Knowing 
Nothing?
3
Our Contributions
Zk-Membership Proof for 
Merkle Tree
Prove 𝑛 ∈𝑇𝑟𝑒𝑒(cid:4666)𝑟(cid:4667)
Given C(r) and C(n): 
r
n
Implementation & Optimization
• 25K GO on Fabric
• Small Test Exponent Test
• Chained Schnorr Groups
• Pippenger’s Multi-Exponent.
• Bullet Range Proof
• …
ZeroAudit Protocol
Inspect Each Transaction at Fair Market Price
• Auditor Maintain Fund Portfolio – Work on Commitments
•
• Certify Net Asset Value Any Time
• No Trusted Setup! 
• Eq. Proof of Commits. over 2 Groups of Different Prime Orders
• Using Range Proof
4
ZeroAUDIT Architecture
Fund B
x
Fund A
Investor
Fund C
Fund D
Fund E
ZeroAUDIT (as Auditor and Accounting)
R
R
R
R
R
Merkle Tree
Buy 10 Units of Fund A 
for $1000
FundID    StockID  Quantity SpendKey
5
Trading Operation
Fund A
Buy 10 Shares of Stock 1
1
2
3
2 Spend Keys, 2 New Cert Roots
Encrypt(Buy 10 Shares of Stock 1)
Zk-Proof
1. Fund A has enough cash (range proof)
2. Spending key is valid
3. Quantities in           same as 
1
2
6
ZeroAUDIT
x
R
x
R
R
R
2
Brokerage
Verify Fair Market Price
 Given 
 Prove: 
and 
Price Merkle Tree
SID: 1
Price: 20
SID: 2
Price: 30
7
Chained Schnorr Groups
P
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043)(cid:4666)𝑃(cid:4667)
∈𝐺(cid:3043)∈𝐺(cid:3044)∈𝐺(cid:3044)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝐿(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝑅(cid:4667)
𝑔(cid:3044)(cid:2869)(cid:3013)𝑔(cid:3044)(cid:2871)(cid:3045) 𝑚𝑜𝑑 𝑝
𝑔(cid:3044)(cid:2870)(cid:3013)𝑔(cid:3044)(cid:2871)(cid:3045)(cid:4593) 𝑚𝑜𝑑 𝑝
2 Primes 𝑞(cid:3407)𝑝:  𝐺(cid:3044) 𝑠𝑢𝑏𝑔𝑟𝑜𝑢𝑝 𝑜𝑓 𝑍(cid:3043)
𝑝(cid:3407)𝑟:  𝐺(cid:3043) 𝑠𝑢𝑏𝑔𝑟𝑜𝑢𝑝 𝑜𝑓 𝑍(cid:3045)
Pedersen Commitment:
2nd Larger Group
L
R
𝑃(cid:3404)ℎ𝑎𝑠ℎ(cid:4666)𝐿,𝑅(cid:4667)
𝑃(cid:3404) 𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝐿,𝑅(cid:4667)
𝑃(cid:3404)𝑔(cid:3044)(cid:2869)(cid:3013) 𝑔(cid:3044)(cid:2870) (cid:3019)𝑔(cid:3044)(cid:2871)(cid:3045) 𝑚𝑜𝑑 𝑝
𝐺(cid:3044)
𝐺(cid:3043) 
𝑝
modulus
prime order
8
Chained Schnorr Groups
DDLP in Child Proof
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043)(cid:4666)𝑃(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝐿(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝑅(cid:4667)
𝑃(cid:3404)𝑔(cid:3044)(cid:2869)(cid:3013) 𝑔(cid:3044)(cid:2870) (cid:3019)𝑔(cid:3044)(cid:2871)(cid:3045) 𝑚𝑜𝑑 𝑝
𝑃(cid:3404)𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)𝐿𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)𝑅 𝑔(cid:3044)(cid:2871)(cid:3005) mod p for some D
Prover should not release D or 𝑔(cid:3044)(cid:2871)(cid:3005)
Prover can disclose 𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043) (cid:4666)𝑔(cid:3044)(cid:2871)(cid:3005) )
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043)(cid:4666)𝑃(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043) (cid:4666)𝑔(cid:3044)(cid:2871)(cid:3005)(cid:4667)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3019)
𝑔(cid:3043)(cid:2869)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3004)(cid:3042)(cid:3040)(cid:3040)(cid:3036)(cid:3047)(cid:3292)(cid:3013)(cid:3034)(cid:3292)(cid:3119)(cid:3253)  𝑔(cid:3043)(cid:2870)(cid:3045)(cid:4593)
Key Observation: 
9
Prover knows the D
Double Discrete Logarithm Proof 
(DDLP) [Stadler’97]
Complete Merkle Tree Proof
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3043)(cid:4666)𝑃(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝐿(cid:4667)
𝐶𝑜𝑚𝑚𝑖𝑡(cid:3044)(cid:4666)𝑅(cid:4667)
P
L
R
 Disjunctive Zk-Proof
 Zk-Equality Proof Over Groups of Different Order
 [Camenisch CRYPT’99] Chain Commit. on Unknown Order
 Our Approach [No Trusted Setup]
 Range Proof to Confine Values [Special Chained Schnorr Setting]
 Challenge: Huge Range 0,2(cid:2869)(cid:2876)(cid:2868)(cid:2868)
 Incorporate Inaccurate Range Proof
10
System Implementation
 25K Golang 
 Over Hyperledger Fabric
11
Performance Data
 Extra Cost Paid for No Trusted Setup
 Proof Size Huge (Needs Improvement)
12
Conclusion
 ZeroAUDIT
 Inspect Trading Transactions Without Knowing Details
 Anonymous Merkle Tree Membership Zk-Proof
 No Trusted Setup
 Simple Assumptions: DLP + Random Oracle
 Log(n) Proof Size and Verification Time (n: anonymity set size)
 Equality Proof (on Different Order Groups) Using Range Proof
 Varieties of Optimization Techniques
13
Questions
14