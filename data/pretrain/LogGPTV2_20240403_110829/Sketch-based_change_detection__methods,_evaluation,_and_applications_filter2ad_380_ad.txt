i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
8192
TopN=50, H=5
TopN=100, H=5
TopN=500, H=5
TopN=1000, H=5
32768
65536
K
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
1
TopN=50,H=5,K=8192
TopN=100,H=5,K=8192
TopN=500,H=5,K=8192
1.25
1.5
X 
1.75
2
(a) Interval=300
(b) Interval=60
(a) Interval=300
(b) Interval=60
Figure 6: topN vs. top-X*N for EWMA model for large router
ﬁle
Figure 8: Similarity metric for EWMA model for medium sized
router ﬁle.(a) top-N vs. topN (b)top-N vs. top-X*N
Figures 5 (a) and (b) use the EWMA model to show average
similarity (across the time intervals), where H is ﬁxed at 5 and K
varies between 8K and 64K, for both 300s and 60s time intervals.
As can be seen, for K=32K, the similarity is over 0.95 even for large
N. For a smaller N (say 50 or 100), the overlap is nearly 100%.
Larger values of K are of limited additional beneﬁt. We note that
similarity improves (for large N) with the smaller interval size of
60. This increased accuracy can be attributed to the fact that for
a smaller interval, there are potentially fewer ﬂows that have to be
summarized in each interval.
We next explore the potential of improving the accuracy by per-
forming the top-N vs.
top-X*N (X = 1, 1.2, 1.5, 2) comparison.
As can be seen in Figures 6 (a) and (b), the similarity increases for
K=8K, even for large N. With X=1.5, the similarity has risen sig-
niﬁcantly even for large N. For the settings we examined, we get
very high accuracy with X ≤ 1.5, and higher values of X result
in marginal additional accuracy gains. This is desirable, because a
larger X while increasing accuracy, also results in more false posi-
tives.
We next consider the effect of varying H on the accuracy. Fig-
ure 7 (a) shows that with a small K=8K, H needs to be at least 9
to get high similarity values, especially for large N. A large H is
undesirable as an increase in H directly corresponds to increased
computation overhead (the number of update operations per key is
proportional to the value of H) and memory (for sketches) over-
head. But, as Figure 7 (b) shows, even for very large N, increasing
K to 32K instantly increases similarity to nearly 1, for a small H=5.
A larger K (for sketches) implies a large space overhead. This sug-
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
8192
TopN=50, H=5
TopN=100, H=5
TopN=500, H=5
TopN=1000, H=5
32768
65536
K
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
8192
TopN=50, H=5
TopN=100, H=5
TopN=500, H=5
TopN=1000, H=5
32768
65536
K
(a) Router=large
(b) Router=Medium
Figure 9: Similarity metric for model ARIMA 0 for large and
medium sized router ﬁles (top-N vs. topN)
gests a space-computation overhead tradeoff. In many applications
where the computation overhead is more critical, with K = 32K or
more, we can get good accuracy results with small H.
We next show the results for a different router ﬁle (all ﬁles have
similar output). Figure 8 (a) and (b) show the similarity metric for
EWMA model for the medium sized router ﬁle.
Likewise, we show the effect of another model (all models had
similar results)—this time we use ARIMA0, i.e., ARIMA with d =
0. Figure 9 (a) and (b) show similarity for large and medium sized
router ﬁles respectively for an interval of 300s.
10000
1000
)
n
a
e
m
sk(K=8192,H=1)
sk(K=8192,H=5)
sk(K=32768,H=5)
sk(K=65536,H=5)
pf
(
s
m
r
a
A
#
l
100
10
0.1
0.08
0.06
0.04
0.02
)
n
a
e
m
(
e
v
i
t
a
g
e
N
e
s
a
F
l
Thresh=0.01, H=5
Thresh=0.02, H=5
Thresh=0.05, H=5
Thresh=0.07, H=5
)
n
a
e
m
(
e
v
i
t
i
s
o
P
e
s
a
F
l
Thresh=0.01, H=5
Thresh=0.02, H=5
Thresh=0.05, H=5
Thresh=0.07, H=5
0.1
0.08
0.06
0.04
0.02
0.01
0.02
0.05 0.07 0.1
Threshold
0
8192
32768
65536
K
0
8192
32768
65536
K
(a) Interval=60s, Use of thresholds
(b) Interval=60s, False negatives
(c) Interval=60s, False positives
Figure 10: Thresholding: large router, 60s interval, non-seasonal Holt-Winters model
)
n
a
e
m
(
s
m
r
a
A
#
l
100000
10000
1000
100
10
1
sk(K=8192,H=1)
sk(K=8192,H=5)
sk(K=32768,H=5)
sk(K=65536,H=5)
pf
Thresh=0.01, H=5
Thresh=0.02, H=5
Thresh=0.05, H=5
Thresh=0.07, H=5
0.1
0.08
0.06
0.04
0.02
Thresh=0.01, H=5
Thresh=0.02, H=5
Thresh=0.05, H=5
Thresh=0.07, H=5
0.1
0.08
0.06
0.04
0.02
)
n
a
e
m
(
e
v
i
t
i
s
o
P
e
s
a
F
l
)
n
a
e
m
(
e
v
i
t
a
g
e
N
e
s
a
F
l
0.01
0.02
0.05 0.07 0.1
Threshold
0
8192
32768
65536
K
0
8192
32768
65536
K
(a) Interval=300s, Use of thresholds
(b) Interval=300s, False negatives
(c) Interval=300s, False positives
Figure 11: Thresholding: large router, 300s interval,non-seasonal Holt-Winters model
5.2.2 Topthresh sketch vs. per-ﬂow evaluation
5.2.2.1 Results.
Instead of comparing just the top-N values, as in the previous
accuracy tests, we now limit the ﬂows to ones whose absolute fore-
cast error is greater than or equal to a certain fraction of the L2
norm (square root of the sum of squares of the forecast errors of
all ﬂows in a time interval). We vary this threshold level across
0.01, 0.02, 0.05, 0.07, and 0.1. We show results for each of the
two time intervals (60s, 300s) for three models (EWMA, NSHW,
and ARIMA with d = 0). For each of sketch and per-ﬂow based
change detection, we rank the ﬂows in decreasing order of absolute
value of forecast error.
The metrics of interest here are the false negative ratio, false pos-
itive ratio, and the number of alarms. For a given value of threshold
τ , let Npf (τ ) and Nsk(τ ) refer to the number of ﬂows that meet
the threshold in per-ﬂow and sketch based detection, respectively.
The number of alarms for per-ﬂow and sketches are then Npf (τ )
and Nsk(τ ) respectively. Let NAB(τ ) be the count of ﬂows that
are common to both the sketch and per-ﬂow lists. The false nega-
. The false positive ratio
tive ratio is computed as
is: Nsk(τ )−NAB (τ )
. At this point, for each metric we have a time
series, with one value per time interval. In our study below, we
consider the mean value over the entire time series.
Npf (τ )−NAB (τ )
Npf (τ )