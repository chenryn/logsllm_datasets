802.11a channels. Figure 9 shows that at each location, the
RSS ratio can be quite large on packets sent from certain
channels. The largest observed r(t) is about 10 where the
sender is 4m away from Antenna 1. However, at each lo-
cation, the r values on different channels vary considerably,
and their mean values are close to 0. By comparison, we
also measured r on different channels when the sender is
very close to the receiver (at 2cm) and show it in Figure 9.
This curve shows that r is relatively stable on different chan-
nels. This experiment indicates that frequency hopping is
able to mitigate the threat of a faraway attacker who tries to
exploit multipath effect.
Figure 9. Using frequency hopping to defeat
attacks using multipath effects
the receiver to send messages via both its antennas. There-
fore, the attacker cannot measure the reverse CSI of both the
channels. Second, even if the receiver sends signals from
both its antennas, the CSI of the reverse channel may be
different from that of the forward one because reciprocity
may not hold due to non-symmetric noise.
6.1.4 Time-of-check to time-of-use attack
Since RSS is measured in the physical layer preamble
while the session key is carried in the frame, an attacker
might try to attack Step 6 in the protocol described in Sec-
tion 3.5 by sending his encrypted session key when the
receiver begins to receive the frame. However, this at-
tack is nearly impossible. First, it is very hard for the at-
tacker to time his frame at the moment just after the re-
ceiver has received the preamble from another user. For
802.11a and 802.11g, a symbol lasts 4 microseconds, in-
cluding an 800 nanosecond guard interval. If the attacker
wants his ﬁrst symbol to arrive at the receiver just after the
genuine sender’s preamble, she must be able to control his
transmission delay within one microsecond. However, it is
nearly impossible to control the transmission delay in such
ﬁne granularity. Even if the attacker could achieve this, his
frame would collide with the genuine sender’s frame, which
would cause the receiver to drop the frame. Although the at-
tacker can launch an DoS attack this way, he could launch
DoS more easily by jamming, which is out of the scope of
this work.
6.1.3 Beam-forming attack
6.2 Usability
In theory, a powerful faraway attacker may attempt to
form special beams to cause a large difference between the
RSS values at the two receiving antennas. In practice, how-
ever, this attack would be very difﬁcult, if not impossi-
ble. The beam forming attacker would need a narrow-width
main lobe (beam). The lobe width is inversely proportional
to the size of the antenna arrays. Since the distance between
the two antennas on the receiver is usually small (typically
less then 1 meter), the attacker would need a very large an-
tenna array, which in many situations would raise suspicion.
Moreover, when the attacker is far from an indoor receiver,
multipath effect would likely distort the intended beam too
much to achieve the required differential RSS on the two an-
tennas on the receiver, unless the attacker knows the accu-
rate channel state information (CSI) from its antenna to the
receiver’s antennas. This information is measurable only at
the receiver’s antennas, but in our protocol (Section 3), the
receiver never sends the measured CSI to the sender. More-
over, the attacker cannot even get an accurate estimation
on the CSI based on its observation of the reverse channel
(the channel from the receiver to the sender) because of the
following two reasons. First, our protocol does not require
We provide an empirical evaluation of the usability of
our scheme. We leave formal usability study for future
work.
Resilience against interference One advantage of our
scheme is its ability to resist interference. Many device
pairing schemes require the use of auxiliary “out-of-band”
channels, such as acoustic [16], that are subject to environ-
ment interference. By contrast, our scheme uses auxiliary
information (RSS) in the existing wireless channel. There-
fore, it inherits the interference-resistance properties from
the wireless channel. All our experiments were conducted
in a typical computer science building with several APs and
even a microwave oven.
Avoiding user errors Our scheme requires no decision
from the user. All the user has to do is to move the sender
from one antenna to another on the receiver. If the user fails
to follow the instruction, it will result in pairing failure, but
not insecure paring. This provides fail-safe default.
Ease of use The relatively challenging part of our scheme
for the user is to align the antennas of two devices; failure
to align may result in device pairing failure. Similar efforts
are required by other device pairing schemes. [14], for in-
stance, requires the user to align the camera of one device
to the screen of the other. In [16], users have to move one
device along the direction of the other one. Both the above
schemes require users to move one device in a 3D space.
By contrast, our scheme only requires the user to move the
sender in the 2D surface of the receiver. When the locations
of the antennas are marked on the surface of the receiver,
this becomes a simple task.
Pairing time The experiments showed that it takes an av-
erage of 11.64s to pair the devices in our prototype, which
is faster than most schemes tested by [10]. Although we
(the authors) conducted the tasks ourselves in our experi-
ments, we expect to observe a similar pairing time on ordi-
nary users because our scheme requires a simple movement
and no user decision.
Versatility Our scheme requires the receiver to have two
antennas separated by a reasonable distance. For example,
when a user pairs a smartphone with his laptop, only the lap-
top needs two antennas. Fortunately, most current laptops,
including the ones without 802.11n modules, use multiple
antennas to take advantage of antenna diversity. Addition-
ally, there is a trend towards embedding 802.11n Wi-Fi in
handheld mobile devices (at least the chip manufacturers
are ready [22]). These devices can take advantage of our
scheme for secure pairing as well.
7 Related work
Wireless device paring With the proliferation of mobile
wireless devices, researchers have proposed many schemes
for secure devices pairing. These schemes rely on trusted
side-channels to pair the devices with each other. Earlier
approaches required the user to be the channel, i.e., they
asked the user to enter the shared secret into the devices,
but these methods suffer from apparent usability and secu-
rity problems discussed in the introduction. To avoid these
problems, researchers have since proposed newer schemes
to use the extra sensory and output hardware present on
many wireless devices as the trusted communication chan-
nel [10]. We can divide these schemes into two categories
in terms of user interaction: (1) those that require the user
to decide whether the device pairing succeeds by compar-
ing visual [26] or audio [6, 23] output; (2) those that require
the user to initiate the device pairing but let the device de-
cide whether the pairing succeeds via the reading from its
sensors (e.g., a camera [14, 21], microphone [17], or ac-
celerometer [8, 13]). Our proposed mechanism falls into
the latter group, which has the advantage that it is less falli-
ble to user errors since users do not need to decide the suc-
cess of the authentication. However, while most wireless
devices have some sensory or output hardware, two arbi-
trary devices may not have the required hardware to provide
secure authentication. For example, [14, 21] applies only to
devices with cameras. By contrast, our scheme uses the
primary communication channel of wireless devices for au-
thentication and thus requires no extra hardware. Although
our scheme requires the receiver to have at least two anten-
nas, multiple antennas are increasingly common as wireless
device manufacturers are embracing the MIMO (Multiple-
Input Multiple-Output) technology. (Note that our scheme
does not require the sender to have more than one antenna.)
Distance bounding protocols Distance bounding proto-
cols [3] are cryptographic protocols that establish an upper-
bound on the physical distance between two parties by tim-
ing the delay between sending out a challenge bit and re-
ceiving the response bit. They have been implemented for
various wireless protocols [27, 7], but all of them rely on
a rapid bit exchange and require precise clocks to mea-
sure the delay between messages traveling at the speed of
light. Since electromagnetic waves propagate over 30cm
in 1 nanosecond, the requirement for such high precision
clocks is unsuitable for consumer electronic devices.
In
fact, many existing implementations [4, 19] are based on
ultrasound ranging techniques.
Our scheme can reliably determine the proximity of the
pairing devices without requiring high-precision clocks; in-
stead, our scheme measures the ratio between the receiving
signal strength at multiple antennas.
Received signal strength Researchers have used Re-
ceived signal strength (RSS) to detect the sybil attack in
wireless sensor networks [5], where they used the RSS ratio
between different monitors to locate users. There are many
differences between our scheme and theirs, the biggest one
being the purpose: our scheme is for deciding whether the
sender is close to the receiver, while their scheme is for de-
ciding if the packets with different identities come from the
same location. As a result, our scheme enjoys the follow-
ing advantages. (1) Our scheme needs only two antennas,
while in theory their scheme requires at least four to achieve
an accurate localization. (2) The precision of their scheme
is in meters, while our scheme can reject attackers that are
merely 20cm away. On the other hand, our scheme also
has to overcome extra challenges: since the user has to hold
and move the sender during device pairing and the sender
is very close to the receiver, our scheme is more susceptible
to radio signal interference and variation. We used statistics
and power level probing to overcome this problem. Finally,
since our goal is device pairing, we also need to design a
protocol that derive a shared secret.
Hu and Evans use directional antennas to verify prox-
imity to prevent wormhole attacks [9]. By contrast, our
scheme does not require directional antennas.
In fact,
our scheme prefers omnidirectional antennas because they
avoid the problem of misalignment between the sending and
receiving antennas. Most consumer wireless devices also
prefer omnidirectional antennas because the users would
not have to orient the devices in certain directions.
8 Conclusion
We have designed a reliable secure device pairing
scheme based on device proximity. The scheme takes ad-
vantage of multiple antennas built in many modern wireless
devices and leverages a characteristic of wireless channels
- the power of the received signal is inversely proportional
to some exponent of the distance between the sender and
receiver. When a nearby sender is very close to one an-
tenna on the receiver, the receiver can observe a large dif-
ference between the power measured on its two antennas,
whereas a faraway sender would be unable to induce this
large difference. We validated our scheme through theoreti-
cal analysis and experimental measurements. We discussed
factors that may affect our scheme, including antenna gain,
antenna alignment, RSS saturation, dynamic rate adaptation
and multipath effects. Finally, we evaluated a prototype of
our scheme by pairing an Openmoko Free Runner mobile
phone with a laptop using threshold values derived from our
measurements. The experiment shows that our scheme is
easy, fast, and reliable.
References
[1] Eye-Fi SD card wiki page. http://en.wikipedia.org/
wiki/Eye-Fi.
[2] Wi-Fi protected setup. http://en.wikipedia.org/wiki/
Wi-Fi_Protected_Setup.
[3] S. Brands and D. Chaum. Distance-bounding protocols. In
EUROCRYPT ’93: Workshop on the theory and applica-
tion of cryptographic techniques on Advances in cryptology,
pages 344–359, Secaucus, NJ, USA, 1994. Springer-Verlag
New York, Inc.
[4] S. Capkun, M. Cagalj, G. O. Karame, and N. O. Tippen-
hauer. Integrity regions: Authentication through presence in
wireless networks. Mobile Computing, IEEE Transactions
on, 9(11):1608 –1621, 2010.
[5] M. Demirbas and Y. Song. An rssi-based scheme for sybil
attack detection in wireless sensor networks. In WOWMOM
’06: Proceedings of the 2006 International Symposium on
on World of Wireless, Mobile and Multimedia Networks,
pages 564–570, Washington, DC, USA, 2006.
[6] M. T. Goodrich, M. Sirivianos, J. Solis, G. Tsudik, and
E. Uzun. Loud and clear: Human-veriﬁable authentication
In ICDCS ’06: Proceedings of the 26th
based on audio.
IEEE International Conference on Distributed Computing
Systems, page 10, Washington, DC, USA, 2006. IEEE Com-
puter Society.
[7] G. Hancke and M. Kuhn. An rﬁd distance bounding pro-
tocol. In Security and Privacy for Emerging Areas in Com-
munications Networks, 2005. First International Conference
on, pages 67–73, Sept. 2005.
[8] L. E. Holmquist, F. Mattern, B. Schiele, P. Alahuhta,
M. Beigl, and H.-W. Gellersen. Smart-its friends: A tech-
nique for users to easily establish connections between smart
artefacts.
In UbiComp ’01: Proceedings of the 3rd inter-
national conference on Ubiquitous Computing, pages 116–
122, London, UK, 2001.
[9] L. Hu and D. Evans. Using directional antennas to prevent
wormhole attacks. In Network and Distributed System Secu-
rity Symposium (NDSS), San Diego, CA, Feb. 2004.
[10] A. Kobsa, R. Sonawalla, G. Tsudik, E. Uzun, and Y. Wang.
Serial hook-ups: a comparative usability study of secure de-
vice pairing methods.
In SOUPS ’09: Proceedings of the
5th Symposium on Usable Privacy and Security, pages 1–
12, New York, NY, USA, 2009. ACM.
[11] J. Krumm and E. Horvitz. Locadio: Inferring motion and
location from Wi-Fi signal strengths. In in First Annual In-
ternational Conference on Mobile and Ubiquitous Systems:
Networking and Services (Mobiquitous, 2004.
[12] S. Mathur, W. Trappe, N. Mandayam, C. Ye, and A. Reznik.
Radio-telepathy: extracting a secret key from an unauthen-
ticated wireless channel. In MobiCom ’08: Proceedings of
the 14th ACM international conference on Mobile comput-
ing and networking, pages 128–139. ACM, 2008.
[13] R. Mayrhofer and H. Gellersen. Shake well before use: In-
tuitive and secure pairing of mobile devices. IEEE Transac-
tions on Mobile Computing, 8(6):792–806, 2009.
[14] J. McCune, A. Perrig, and M. Reiter. Seeing-is-believing:
using camera phones for human-veriﬁable authentication. In
Security and Privacy, 2005 IEEE Symposium on, pages 110–
124, May 2005.
[15] A. Neskovic, N. Neskovic, and G. Paunovic. Modern ap-
proaches in modeling of mobile radio systems propagation
environment.
IEEE Communications Surveys, 3(3):1–12,
2000.
[16] C. Peng, G. Shen, Y. Zhang, Y. Li, and K. Tan. Beepbeep:
a high accuracy acoustic ranging system using cots mobile
devices. In SenSys ’07: Proceedings of the 5th international
conference on Embedded networked sensor systems, pages
1–14, New York, NY, USA, 2007. ACM.
[17] C. Peng, G. Shen, Y. Zhang, and S. Lu. Point&#38;connect:
intention-based device pairing for mobile phone users.
In
MobiSys ’09: Proceedings of the 7th international confer-
ence on Mobile systems, applications, and services, pages
137–150, New York, NY, USA, 2009. ACM.
[18] T. S. Rappaport. Wireless Communications: Principles and
Practice. Prentice Hall, New Jersey, 2001.
[19] K. B. Rasmussen, C. Castelluccia, T. S. Heydt-Benjamin,
and S. Capkun. Proximity-based access control for im-
plantable medical devices. In CCS ’09: Proceedings of the
16th ACM conference on Computer and communications se-
curity, pages 410–419, New York, NY, USA, 2009. ACM.
[20] K. B. Rasmussen and S. apkun. Realization of rf distance
bounding. USENIX ’10: Proceedings of the 19th USENIX
Security Symposium, 2010.
[21] N. Saxena, J.-E. Ekberg, K. Kostiainen, and N. Asokan. Se-
cure device pairing based on a visual channel (short paper).
In SP ’06: Proceedings of the 2006 IEEE Symposium on Se-
curity and Privacy, pages 306–313, Washington, DC, USA,
2006. IEEE Computer Society.
[22] A. Shilov. Mobile phones with faster 802.11n Wi-Fi incom-
http://www.xbitlabs.com/news/networking/
ing.
display/20091110182814_Mobile_Phones_with_
Faster_802_11n_Wi_Fi_Incoming_Research_Firm.
html, December 2009.
[23] C. Soriente, G. Tsudik, and E. Uzun. Hapadep: Human-
assisted pure audio device pairing. In ISC ’08: Proceedings
of the 11th international conference on Information Secu-
rity, pages 385–400, Berlin, Heidelberg, 2008.
[24] F. Stajano and R. Anderson. The resurrecting duckling: Se-
curity issues for ubiquitous computing (supplement to com-
puter magazine). Computer, 35:22–26, 2002.
[25] T. Stoyanova, F. Kerasiotis, A. Prayati, and G. Papadopou-
los. Evaluation of impact factors on rss accuracy for local-
ization and tracking applications.
In MobiWac ’07: Pro-
ceedings of the 5th ACM international workshop on Mobil-
ity management and wireless access, pages 9–16, New York,
NY, USA, 2007.
[26] S. Vaudenay. Secure communications over insecure chan-
nels based on short authenticated strings.
In Advances in
Cryptology - CRYPTO 2005: 25th Annual International
Cryptology Conference, volume 3621 of Lecture Notes in
Computer Science, pages 309–326, 2005.
[27] S. ˇCapkun, L. Butty´an, and J.-P. Hubaux. Sector: secure
tracking of node encounters in multi-hop wireless networks.
In SASN ’03: Proceedings of the 1st ACM workshop on Se-
curity of ad hoc and sensor networks, pages 21–32, New
York, NY, USA, 2003. ACM.
[28] K. Zeng, D. Wu, A. Chan, and P. Mohapatra. Exploiting
multiple-antenna diversity for shared secret key generation
in wireless networks. In IEEE Infocom 2010, March 2010.