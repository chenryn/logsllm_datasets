为 网 络设备和 网 络软件 包的指数级数量增长准备， 所有这一切都需要一个唯一的标识符。
MAC-48 和 EUI-48 地址可以用 EUI-64 进行表示。 在 MAC-48 示例 中 ， 两个额外的字节 FF:FF
被添加到 OUT(头 3 个字节)和单拙的 网 卡(最后 3 个字节)中 间 ， 例女口 ∞.∞:∞:FF:FF:ee:眩目。 在 EUI-48
示例 中 ， 贝IJ 增加两个额外的字节 FF:FE， 例 如 cc:cc:cc:FF:FE:ee:ee:ee.
在 OSI 模型的数据链路层(第 2 层)的协议中， 你应该熟悉其中 的两个协议: 地址解析协议(ARP)
和反向地址解析协议(RARP)。 使用 ARP将E 地址解析为 MAC 地址。 使用 MAC 地址能够将某个
网段(例如， 通过集线器的线路)上的通信数据从源系统定向至 目 标系统。 使用 RARP 将 MAC 地址
解析为 E 地址 。
数据链路层包含两个子层: 逻辑链路控制(Logical Link Control， LLC)子层和 MAC 子层。 这些
层 的细节 内 容并不是 CISSP 考试的关键。
工作在第 2 层(数据链路层)的网络硬件设备包括交换机和桥。 这些设备都支持基于 MAC 的路由
通信 。 交换机从一个端口接收数据帧， 并且根据目的 MAC 地址从另一个端口发送数据帧。 MAC 目
标地址用于确定数据帧是否要通过桥从一个网络传送至另一个网络。
3. 网络层
网络层(第 3 层)负责 向数据中添加路由和寻址信息。 网络层接收来自于传输层的数据段， 并且
通过添加信息创建数据包 。 数据包包括源 IP 地址和 目的IP 地址 。
302
路 由协议位于这一层 ， 包括下列协议:
• 网络控制报文协议(Internet Control Message Protoco! ' ICMP)
• 路由信息协 议(Routing Information Protoco!' 阳P)
• 开放式最短路径优先(Open Shortest Path First， OSPF)
• 边界网关协议(Border Gateway Protocol ， BGP)
• 网 络组管理协 议(Internet Group Management Protoco! ' IGMP)
• 网 际协议(IP)
• 网 际协议安全(IPSec)
• 互联网分组交换协议(Internetwork Packet Exchange， IPX)
• 网络地址转换(Simple Key Management for Internet Protoco! ' NAT)
• 网络简单密钥管理协议(SKIP)
网络层负责提供路由或传送信息， 但是不负责保证传输己进行验证(这个工作 由传输层负责)。
第 1丁 章 网络安全架构与保护网络组件
网 络层还管理着错误检测和节点数据通信(也就是通信控制)。
非 IP 协议
非 lP 协议是作为一种替代 E 并工作在 OSI 的 网络层的协议。 在过去 ， 非 E 协议被广泛使用 。
然而， 与 TCP/lP 的主导地位和成功相比， 非E协议 已成为 专用 网络的 范畴。 三个最被认可的非 E
协议是 lPX、 AppleTalk 和 NetBUI. 互联网分组交换协议(lPX)是 E兀SPX 协议的常用 套件〈虽 然没
有严格的要求)的一部分， 并使用 于 20 世纪 90 年代的 Novell NetWare 网 络中 。 AppleTalk 协议是一
套由苹果公司 开发并使用 于 Macintosh 系统网络上的协议， 最早版本于 1984 年初发布。 在 2009 年，
Mac OS X VlO.6 友布后取消 了 苹果操作系 统对 AppleTalk 的 支持。 lPX 和 AppleTalk 都可作为 lP 协
议网 关 ， 在死区 网络中 实现 E 方案(死区是指一个网段使用 另 一个网络层协议而不是 lP). NetBIOS
扩展用 户 界面(NetBEUI， 又名 NetBIOS 帧协议或 NBF)是最为广泛认知的一个微软协议， 在 1985
年开发出来用 于支持文件和打印机共享。 微软已经通过将 NetBIOS 工作于 TCP/lP 上(NBT)， 使得
NetBEUI 支持现代网络。 这反过来又支持服务器消 息块(Server Message Block， 5MB)协议， 也被称
为 通用 王联网 文件系统(Common Intemet File System， CIFS)。 作为低层协议， NetBEUI 已 不再获得
支持; 只 有 SJ\但和CIFS 仍在使用 @
当 非 E 协议在矛A有网 络中使用 时， 存在潜在的安全风险。 因为非 E 协议是罕见的 ， 大多数防
火墙无法对这些协议的数据包头、 地址或有效载荷执行内容过滤。 因此， 当 涉及非 E 协议时， 防火
墙通常阻止所有或者九许所有。 如果组织依赖于一个使用 非 E 协议的服务， 那 么可能不得冒着让防
火墙通过所有的非 E 协忱的风险。 这是在私有 网络内存在非 lP 协仪之间 的 网络段时主要考虑的 问
题。 然而， 非 E 协议可以封装在 lP 协议中 并在互联网上进行通信。 在封装的情况下 ， lP 防火墙很
少 能够在这样的封装上执行内 容过滤 ， 并且因 此安全性必须设直 为 九许所有或拒绝所有 。
工作在第三层的网络层硬件设备包括路由器和桥式路由器。 路由器基于速度、 跳数、 优先级等
信息决定了数据包传输的最佳逻辑路径。 路由器使用目的E 地址来指导数据包的传输。 桥式路由器
主要在第三层工作， 不过必要时也会在第二层工作， 这是一种先尝试路由、 在失败时默认桥接的设备。
路由协议
路由协议分为 两个主要类别 : 距离 矢量和链路状态。 距离矢量路由协议维护一个 目 的 网络以及
距 离和方向 的跳数列表(也就是到达 目 的地所经过的路由器数量)。 链路状态路由协议维护一张所有
已连接网络的拓扑图 ， 并且使用这张拓圳、图确定到达目 的地的最短路径。 距离 矢量路由协议的常见
例子包括 RIP、 IGRP 和 BGP， 而链且各状态路由 协议的常见例子则是 OSPF。
4. 传输层
传输层(第 4 层)负责管理连接的完整性并控制会话。 传输层接收来自 于会话层的 PDU(又名协议
数据单元、 数据包单元或数据负荷单元， 是一个在网络层流经的包含信息和数据的容器)并将其转换
为数据段。 传输层控制网络上设备的寻址或引用 方式， 以及在节点(也被称为设备)之间建立通信连
接， 还有定义会话的规则。 会话规则指定每个数据段中可以包含多少数据、 如何验证传输数据的完
整性、 如何确定数据是否丢失。 会话规则在握手过程中建立(请参考本章中 的 " 传输层协议 " 中讨论
的 " TCP/IP 的 SYN/ACK 三步握手过程" )。
传输层在两台设备之间建立了一个逻辑连接， 并且提供了能够确保数据传递的端到端传输服务。
这一层包括针对分段、 排序、 错误检查、 数据流控制 、 错误纠正 、 复用和网络服务优化的机制。 下
303
304
CISSP 官方学习指南(第 7 版)
面列 出 了 一些在传输层上运作的协议:
• 传输控制协议(TCP)
• 用户数据报协议(UDP)
• 顺序数据包交换(SPX)
• 安全套接宇层(SSL)
• 传输层安全(TLS)
5. 会话层
会话层(第 5 层)负责在两台计算机之间建立、 维护和终止通信会话。 这一层管理对话模式或对
话控制(单工 、 半双工、 全双工)， 并为分组和恢复建立检查点， 以及重新传输上一次验证检查点 以
来失败或丢失 的 PDU。 下面列出了 一些在会话层上运行的协议:
• 网 络文件系统例FS)
• 结构化查询语言(SQL)
• 远程过程调用 (RPC)
通信会话能够 以 下列 三种 不同模式中 的 一种模式进行操作:
· 单工 单 向直接通信
· 半双工 双 向通信， 但是每次只 有一个方向可以发送数据
• 全双工 双 向通信， 此时数据可以 同时在两个方向上进行传输
6. 表示层
表示层(第 6 层)负责将从应用层接收的数据转换为遵从 OSI 模型的任何系统都能理解的格式。
它 向数据中强行添加通用 的或标准的结构和格式化规则 。 表示层还负责加密和压缩。 因此， 它成为
网络和应用程序之间的接口 。 通过确保数据格式能够被两个系统支持， 表示层准许不同 的应用程序
通过网络交互。 大多数文件或数据格式在这一层上出现， 包括图像、 视频、 音频、 文档、 电子邮件、
Web 页 面和控制会话等格式。 下 面列出了表示层 内存在的一些格式标准:
• 美国信息交换标准代码(ASCII)
• 扩充二进制编码的十进制交换码(EBCDIC)
• 标签图像文件格式(TIFF)
• 联合图像专家组(JPEG)
• 运动图像专家组(MPEG)
• 音乐设备数字接 口 (MIDI)
@ 真实场景
怎样记忆如此多的层和协议
对于这7层和 50 多 个协议， 去记忆各层存在的协议可能十分困难。 创 建闪示卡是帮助记忆的一
种方法。 每张卡片 的正面写 下协议的名字， 背面则写下层的名 字 。 打乱卡片顺序后， 将不同 的协议
堆放在表示不同层的位直。 放直完所有协议以后， 通过查看卡片 背面 的层名来检查记忆状况。 重复
这个过程 ， 直至能够正确放直 所有协议。
第 11 章 网络安全架构与保护网络组件
7. 应用层
应用层(第 7 层)负责将协议枝与用户 的应用程序、 网络服务或操作系统连接在一起。 它准许应
用程序与协议技进行通信 。 应用层确定远程的通信方是否可用和可访问 ， 还确保有足够的资源用于
支持被请求的通信。
应用程序并不位于应用层内; 相反， 传输文件、 交换信息和连接远程终端等任务所需 的协议和
服务都在这一层 。 很多应用专用 的协议也在应用 层 内 ， 例如下面这些协议:
• 超文本传输协议(HTTP)
• 文件传输协议(FTP)
• 行 式打 印机后 台程序(LPD)
• 简单邮件传输协议(SMTP)
• 远程登录(Telnet)
• 普通文件传输协议(TFTP)
• 电子数据交换(EDI)
• 邮局协议第三版(POP3)
• 互联网消息访 问协议(IMAP)
• 简 单网络管理协议(SNMP)
• 网络新闻传输协议例NTP)
• 安全远程过程调用(S-RPC)
• 安全电子交易(SET)
有一种网络设备(或服务)工作在应用层， 名叫网关 。 但是， 应用层网关是一种特定类型的组件。
网关作为协议转换工具使用 。 例如 ， IP-to-IPX 网关接收采用 TCPIIP 协议的入站通信， 并且在转换
为 IPXlSPX 协议的通信后实现出 站传输。 应用防火墙也工作在这一层。 其他网络设备或过滤软件也