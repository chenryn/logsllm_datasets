以下是优化后的文本，使其更加清晰、连贯和专业：

---

### 21. ZDI-16-068
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于堆的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 22. ZDI-16-069
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `NewPointValue` 中的 `strcpy`
- **影响**: 远程代码执行

### 23. ZDI-16-070
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Primary RPC Hostname` 中的 `strcpy`
- **影响**: 远程代码执行

### 24. ZDI-16-071
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 25. ZDI-16-072
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Backup RPC Hostname` 中的 `strcpy`
- **影响**: 远程代码执行

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 55. 变体分析

### 26. ZDI-16-073
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `memcpy`
- **影响**: 远程代码执行

### 27. ZDI-16-074
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 全局变量溢出
- **受影响函数**: `memcpy`
- **影响**: 远程代码执行

### 28. ZDI-16-075
**Advantech WebAccess webvrpcs Service BwpAlarm.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `memcpy`
- **影响**: 远程代码执行

### 29. ZDI-16-076
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 30. ZDI-16-077
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 31. ZDI-16-078
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 32. ZDI-16-079
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 33. ZDI-16-080
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagName` 中的 `strcpy`
- **影响**: 远程代码执行

### 34. ZDI-16-081
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 35. ZDI-16-082
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 36. ZDI-16-083
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 37. ZDI-16-084
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 38. ZDI-16-085
**Advantech WebAccess webvrpcs Service ViewSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 39. ZDI-16-086
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 40. ZDI-16-087
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 41. ZDI-16-088
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 42. ZDI-16-089
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 43. ZDI-16-090
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 44. ZDI-16-091
**Advantech WebAccess webvrpcs Service BwKrlApi.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 45. ZDI-16-092
**Advantech WebAccess webvrpcs Service DrawSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 46. ZDI-16-093
**Advantech WebAccess webvrpcs Service DrawSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `BwBuildPath`
- **影响**: 远程代码执行

### 47. ZDI-16-094
**Advantech WebAccess webvrpcs Service DrawSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagGroup` 中的 `strcpy`
- **影响**: 远程代码执行

### 48. ZDI-16-095
**Advantech WebAccess webvrpcs Service ViewDll.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagGroup` 中的 `strcat`
- **影响**: 远程代码执行

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 56. 变体分析

### 49. ZDI-16-096
**Advantech WebAccess webvrpcs Service ViewDll.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagGroup` 中的 `strcpy`
- **影响**: 远程代码执行

### 50. ZDI-16-097
**Advantech WebAccess webvrpcs Service DrawSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagGroup` 中的 `strcpy`
- **影响**: 远程代码执行

### 51. ZDI-16-098
**Advantech WebAccess webvrpcs Service DrawSrv.dll**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `TagGroup` 中的 `strcpy`
- **影响**: 远程代码执行

### 52. ZDI-16-099
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `strcat`
- **影响**: 远程代码执行

### 53. ZDI-16-100
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `strcpy`
- **影响**: 远程代码执行

### 54. ZDI-16-101
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Path` 中的 `strcat`
- **影响**: 远程代码执行

### 55. ZDI-16-102
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 整数溢出
- **受影响函数**: `ExtDataSize`
- **影响**: 远程代码执行

### 56. ZDI-16-103
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 共享虚拟内存溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 57. ZDI-16-104
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `sprin~`
- **影响**: 远程代码执行

### 58. ZDI-16-105
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于堆的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 59. ZDI-16-106
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Username` 中的 `strcpy`
- **影响**: 远程代码执行

### 60. ZDI-16-107
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 61. ZDI-16-108
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 62. ZDI-16-109
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 63. ZDI-16-110
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Username` 中的 `strcpy`
- **影响**: 远程代码执行

### 64. ZDI-16-111
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Username` 中的 `strcpy`
- **影响**: 远程代码执行

### 65. ZDI-16-112
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Username` 中的 `strcpy`
- **影响**: 远程代码执行

### 66. ZDI-16-113
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 67. ZDI-16-114
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strcpy`
- **影响**: 远程代码执行

### 68. ZDI-16-115
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `Username` 中的 `strcpy`
- **影响**: 远程代码执行

### 69. ZDI-16-116
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `strncpy`
- **影响**: 远程代码执行

### 70. ZDI-16-117
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于堆的缓冲区溢出
- **受影响函数**: `AlarmMessage` 中的 `strcpy`
- **影响**: 远程代码执行

### 71. ZDI-16-118
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于栈的缓冲区溢出
- **受影响函数**: `AlarmMessage` 中的 `sprin~`
- **影响**: 远程代码执行

### 72. ZDI-16-119
**Advantech WebAccess datacore Service datacore.exe**
- **漏洞类型**: 基于堆的缓冲区溢出
- **受影响函数**: `AlarmMessage` 中的 `strcpy`
- **影响**: 远程代码执行

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 57. 研究者指南

### 58. 基本模糊测试
- **简单的位翻转模糊测试** 对 HMI 非常有效。
  - 在安装过程中查找新的文件关联。
- **启用页堆以检测堆损坏**。
  - 使用 `gflags.exe /i hmi.exe +hpa +ust`。
- **利用现有的工具和框架**。
  - `radamsa`
  - `sqlmap`

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 59. 微软的攻击面分析器
- **发布于 2012 年**。
- **在安装前后创建快照**。
- **突出显示安全配置错误**。
  - 注册表设置和文件权限。
- **提供可审计的系统修改列表**。
  - COM 对象
  - ActiveX 控件
  - 文件关联
  - RPC 终端点

### 60. 攻击面分析器报告

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 61. 攻击面分析器报告

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 62. 审计禁止使用的 API
- **C 运行时库中有许多存在严重安全问题的 API**。
- **微软禁止使用有问题的 C 库函数**。
  - “The Security Development Lifecycle” (微软, 2006)
  - 安全开发生命周期禁止调用函数: <https://msdn.microsoft.com/en-us/library/bb288454.aspx>
- **在 HMI 代码中非常常见，具有可预见的负面影响**。
- **IDA 是一个非常有价值的工具，用于审计不当使用**。

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 63. 披露统计

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 64. 漏洞暴露窗口
| 年份 | 数量 |
| --- | --- |
| 2013 | 0 |
| 2014 | 20 |
| 2015 | 40 |
| 2016 | 60 |

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 65. 厂商响应时间
| 厂商 | 时间 (天) |
| --- | --- |
| ABB | 0 |
| Advantech | 50 |
| Codesys | 100 |
| Cogent | 150 |
| Real-Time Systems | 200 |
| Ecava | 250 |
| GE | 300 |
| Honeywell | 350 |
| InduSoft | 400 |
| MICROSYS | 450 |
| PTC | 500 |
| Rockwell Automation | 550 |
| Schneider Electric | 600 |
| Tibbo | 650 |
| Trihedral Engineering Ltd | 700 |
| Unitronics | 750 |
| WellinTech | 800 |

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 66. 行业对比
| 行业 | 数量 |
| --- | --- |
| 商业 | 0 |
| 高度部署的 SCADA | 20 |
| 安全 | 40 |

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 67. 结论

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 68. 去找漏洞吧！
- **ICS 针对性恶意软件正在积极利用 HMI 漏洞**。
- **HMI 代码库中存在大量关键漏洞**。
- **简单的技术可以用来发现漏洞**。
- **暴露窗口约为 150 天，使关键基础设施处于脆弱状态**。

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 69. 问题？

### 版权声明
版权所有 © 2016 Trend Micro, Inc.

### 联系方式
- <www.zerodayinitiative.com>
- @thezdi

---