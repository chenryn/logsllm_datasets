ZDI'16'068,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,strcpy,Heap'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
21. 
ZDI'16'069,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,NewPointValue,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
22. 
ZDI'16'070,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,Primary,RPC,Hostname,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
23. 
ZDI'16'071,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
24. 
ZDI'16'072,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,Backup,RPC,Hostname,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
55,
Variant,Analysis,
25. 
ZDI'16'073,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,memcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
26. 
ZDI'16'074,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,memcpy,Globals,Overﬂow,Remote,Code,Execu:on,Vulnerability,
27. 
ZDI'16'075,',Advantech,WebAccess,webvrpcs,Service,BwpAlarm.dll,memcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
28. 
ZDI'16'076,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
29. 
ZDI'16'077,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
30. 
ZDI'16'078,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
31. 
ZDI'16'079,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
32. 
ZDI'16'080,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,TagName,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
33. 
ZDI'16'081,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
34. 
ZDI'16'082,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
35. 
ZDI'16'083,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
36. 
ZDI'16'084,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
37. 
ZDI'16'085,',Advantech,WebAccess,webvrpcs,Service,ViewSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
38. 
ZDI'16'086,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
39. 
ZDI'16'087,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
40. 
ZDI'16'088,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
41. 
ZDI'16'089,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
42. 
ZDI'16'090,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
43. 
ZDI'16'091,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
44. 
ZDI'16'092,',Advantech,WebAccess,webvrpcs,Service,BwKrlApi.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
45. 
ZDI'16'093,',Advantech,WebAccess,webvrpcs,Service,DrawSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
46. 
ZDI'16'094,',Advantech,WebAccess,webvrpcs,Service,DrawSrv.dll,Path,BwBuildPath,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
47. 
ZDI'16'095,',Advantech,WebAccess,webvrpcs,Service,DrawSrv.dll,TagGroup,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
48. 
ZDI'16'096,',Advantech,WebAccess,webvrpcs,Service,ViewDll.dll,TagGroup,strcat,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
56,
Variant,Analysis,
49. 
ZDI'16'097,',Advantech,WebAccess,webvrpcs,Service,ViewDll.dll,TagGroup,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
50. 
ZDI'16'099,',Advantech,WebAccess,webvrpcs,Service,DrawSrv.dll,TagGroup,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
51. 
ZDI'16'100,',Advantech,WebAccess,webvrpcs,Service,DrawSrv.dll,TagGroup,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
52. 
ZDI'16'101,',Advantech,WebAccess,datacore,Service,datacore.exe,Path,strcat,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
53. 
ZDI'16'102,',Advantech,WebAccess,datacore,Service,datacore.exe,Path,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
54. 
ZDI'16'103,',Advantech,WebAccess,datacore,Service,datacore.exe,Path,strcat,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
55. 
ZDI'16'104,',Advantech,WebAccess,datacore,Service,datacore.exe,ExtDataSize,Integer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
56. 
ZDI'16'105,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Shared,Virtual,Memory,Overﬂow,Remote,Code,Execu:on,Vulnerability,
57. 
ZDI'16'106,',Advantech,WebAccess,datacore,Service,datacore.exe,sprin~,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
58. 
ZDI'16'107,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Heap'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
59. 
ZDI'16'108,',Advantech,WebAccess,datacore,Service,datacore.exe,Username,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
60. 
ZDI'16'109,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
61. 
ZDI'16'110,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
62. 
ZDI'16'111,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
63. 
ZDI'16'112,',Advantech,WebAccess,datacore,Service,datacore.exe,Username,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
64. 
ZDI'16'113,',Advantech,WebAccess,datacore,Service,datacore.exe,Username,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
65. 
ZDI'16'114,',Advantech,WebAccess,datacore,Service,datacore.exe,Username,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
66. 
ZDI'16'115,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
67. 
ZDI'16'116,',Advantech,WebAccess,datacore,Service,datacore.exe,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
68. 
ZDI'16'117,',Advantech,WebAccess,datacore,Service,datacore.exe,Username,strcpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
69. 
ZDI'16'118,',Advantech,WebAccess,datacore,Service,datacore.exe,strncpy,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
70. 
ZDI'16'119,',Advantech,WebAccess,datacore,Service,datacore.exe,AlarmMessage,strcpy,Heap'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
71. 
ZDI'16'120,',Advantech,WebAccess,datacore,Service,datacore.exe,AlarmMessage,sprin~,Stack'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
72. 
ZDI'16'121,',Advantech,WebAccess,datacore,Service,datacore.exe,AlarmMessage,strcpy,Heap'Based,Buﬀer,Overﬂow,Remote,Code,Execu:on,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
57,
Researcher,Guidance,,
Copyright,2016,Trend,Micro,Inc.,
58,
Basic,Fuzzing,
•  Simple,bit'ﬂipping,fuzzing,is,highly,eﬀec:ve,against,HMI,
–  Look,for,new,ﬁle,associa:ons,during,installa:ons,
•  Don’t,forget,to,enable,page,heap,to,ﬁnd,heap,corrup:on,
–  gﬂags.exe,/i,hmi.exe,+hpa,+ust,
•  Leverage,exis:ng,tools,and,frameworks,
–  radamsa,
–  sqlmap,
Copyright,2016,Trend,Micro,Inc.,
59,
MicrosoT’s,Akack,Surface,Analyzer,
•  Released,in,2012,
•  Creates,snapshots,before,and,aTer,installa:on,
•  Highlights,security,misconﬁgura:ons,
–  Registry,semngs,and,ﬁle,permissions,
•  Provides,a,list,of,auditable,system,modiﬁca:ons,
–  COM,objects,
–  Ac:veX,controls,
–  File,associa:ons,
–  RPC,endpoints,
Copyright,2016,Trend,Micro,Inc.,
60,
Akack,Surface,Analyzer,Report,
Copyright,2016,Trend,Micro,Inc.,
61,
Akack,Surface,Analyzer,Report,
Copyright,2016,Trend,Micro,Inc.,
62,
Audit,for,Banned,APIs,
•  C,run:me,has,many,APIs,with,serious,security,programs,
•  MicrosoT,banned,use,of,problema:c,C,library,func:ons,
–  “The,Security,Development,Lifecycle”,(MicrosoT,,2006),
–  Security,Development,Lifecycle,Banned,Func:on,Calls,,
hkps://msdn.microsoT.com/en'us/library/bb288454.aspx,
•  Depressingly,common,in,HMI,code,,with,predictable,
nega:ve,impacts,
•  IDA,is,extremely,valuable,tool,for,audi:ng,for,inappropriate,
uses,,
Copyright,2016,Trend,Micro,Inc.,
63,
Disclosure,Sta:s:cs,
Copyright,2016,Trend,Micro,Inc.,
64,
Vulnerability,Exposure,Windows,
0,
20,
40,
60,
80,
100,
120,
140,
160,
180,
2013,
2014,
2015,
2016,
Copyright,2016,Trend,Micro,Inc.,
65,
Vendor,Response,Times,
0,
50,
100,
150,
200,
250,
ABB,
Advantech,
Codesys,
Cogent,
Real'Time,
Systems,
Ecava,
GE,
Honeywell,
IndusoT,
MICROSYS,
PTC,
Rockwell,
Automa:on,
Schneider,
Electric,
Tibbo,
Trihedral,
Engineering,
Ltd,
Unitronics, WellinTech,
Copyright,2016,Trend,Micro,Inc.,
66,
Industry,by,Industry,Comparison,
0,
20,
40,
60,
80,
100,
120,
140,
160,
180,
200,
Business,
Highly'Deployed,
SCADA,
Security,
Copyright,2016,Trend,Micro,Inc.,
67,
Conclusions,
Copyright,2016,Trend,Micro,Inc.,
68,
Go,ﬁnd,bugs!,
•  ICS'focused,malware,ac:vely,exploi:ng,HMI,vulnerabili:es,
•  HMI,codebases,plagued,with,cri:cal,vulnerabili:es,
•  Simple,techniques,can,be,used,to,ﬁnd,vulnerabili:es,
•  Exposure,windows,is,~150,days,leaving,cri:cal,
infrastructure,vulnerable,
Copyright,2016,Trend,Micro,Inc.,
69,
Ques:ons?,
,
,
,
,
,
www.zerodayini:a:ve.com,
@thezdi,