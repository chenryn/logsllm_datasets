三、网络安全运营实践
网络安全运营实践中，安全风险的全面量化可视是基础，防控措施
的及时精准有效是目标。本节将结合实际案例，从IT资产安全风
险量化管控、威胁响应与安全能力提升方面介绍公司网络安全运营
的工作经验。
（一）IT资产安全风险量化管控
1. IT资产识别与安全管理
为实现IT资产安全风险的全面量化可视，首先需要实现IT资产
的全面识别与安全管理。
图2…互联网资产监测
在技术层面，可采取不同的策略来发现、监控互联网侧资产与内网
侧资产的暴露面： (2)…对于内网侧资产，首先，借助
(1)…对于互联网侧资产，首先，在互联网边界部署全流量威胁监测 运维条线建设动态IT资产管理平
系统，利用其资产发现功能，全面监测暴露在互联网侧的IT资产； 台的契机，定期开展全网IT资产
其次，采购外部供应商的资产检测服务，对所有互联网侧资产进行 排查、域间流量分析和域间防火墙
实时监控，掌握互联网IT资产的状态与变化情况；最后，定期抓 策略命中情况的梳理，通过IT资
取运维管理平台中信息系统上线与互联网边界防火墙的变更记录。 产数据的时序比对，掌握内网资产
将以上数据进行汇总比对与关联分析，全面掌握互联网侧的IT资 变化情况；其次，在运维条线资产
产暴露面。 管理的基本属性（IP、端口、服务
… 实例、人员）增加操作系统、数据 图3…内网资产风险量化
136 137
行
业 可持续的网络安全运营实践
专
刊
库、中间件版本、访问关系、漏洞关联信息等安全属性，在此基础 洞，四是开源软件包、开发工具等研发工具链引入的安全漏洞。
上开展全面IT资产风险的量化工作。
… 前两类漏洞通常会无修复方案，或者修复方案可能会导致业务异
在管理层面，完善信息安全管理制度，明确公司各部门和人员在 常。可结合IT资产管控的过程控制相关风险。可根据访问关系设
IT资产使用与管理方面的职责，与各部门和人员的考核结果挂钩， 置白名单控制策略，并定期审计控制策略的执行情况，控制漏洞
形成制度威慑；上线IT资产认领流程，对于技术手段发现的、未 的影响范围和威胁来源；维护相关漏洞的台账清单，采取“消存量、
明确责任人的IT资产，利用画像和聚类算法，实时对其进行智能 控增量”的策略，配合运维条线的变更操作，逐步淘汰老旧系统、
分析，并将分析结果推送至相关人员进行认领和确认，对于长期没 改进旧业务模式，将相关漏洞带来的安全风险控制在可接受的范
有有效业务流量的，及时提交下线变更流程予以停用。另外，借助 围内。
第三方渗透测试服务，结合重大事件时间节点，不定期地对公司开
展渗透测试活动，将其结果作为IT资产管理的参照数据来源。对 对于后两类漏洞，可在信息系统的全生命周期嵌入安全活动，并结
于未纳入控制范围内的IT资产，及时进入应急处置流程，落实管 合安全编排与自动化响应平台来实现信息资产脆弱性的发现、跟踪
理手段，并最终实现IT资产的全覆盖管理。 与闭环处置。
在设计研发阶段，尽可能降低漏洞来源，设定基本的安全模板，限
定使用安全版本范围的操作系统、中间件、工具链等；建立本地代
码库镜像，采用白名单的形式对设定可引用的代码库版本；引入软
件成分分析工具，对代码库中使用的第三方库等进行核查，并定期
维护第三方库列表备查。
在质控与测试阶段，利用交互式应用安全测试工具，结合黑盒测试，
图4…IP资产认领 充分覆盖软件代码逻辑路径，确保系统不带“病”上线。
2. 漏洞管理 在运行阶段，定期开展常态化的全网主机登录扫描和应用扫描，定
IT资产的漏洞主要来源于四个方面：一是历史老旧系统遗留，由 期开展渗透测试。软件成分库信息、扫描结果、渗透测试结果用于
于源代码丢失或开发商失联导致无法修复，二是特殊业务模式导致 更新IT资源的安全属性，与威胁情报信息共同输入自动化响应平
某些不安全的使用方式（如共享文件），三是系统研发过程中由于 台进行交叉比对分析，对于存在安全风险的，通过ITSM问题工
安全设计缺失、或未遵循安全规范等导致的系统漏洞和业务逻辑漏 单进行闭环跟踪处置。
138 139
行
业 可持续的网络安全运营实践
专
刊
3. 全面风险量化管控 降；经过十几周的持续运转，漏洞整改率逐步恢复到较高水平，并
风险量化管控主要包括风险识别、风险评估和风险处置三个环节。 且新发现的内网漏洞也逐步减少，内网安全情况得到极大改善。
在风险识别环节，基于可持续的IT资产安全管理，整合安全、网络、
维护、运行系统数据形成数据集市，设立动态可配置的评估规则，
实施资产分级分类与量化评估，依托于漏洞管理与风险监测的核心
数据，结合数据集市抽取的评估指标，提炼安全风险模型，实现对
风险的有效识别。
在风险评估环节，一方面沿用漏洞的严重程度、利用难易、影响范
围等传统量化评估项，另一方面，结合外部威胁情报、行业安全情
报、安全报告文档与历史攻击数据对风险评估项进行加权调节，并
引入时效机制，落地风险评估与优先级排序，实现动态可伸缩的风 …
险评估机制。
图5…内网漏洞管理工作的效果
在风险处置环节，参照风险评估结果推动风险的消解，在可承受的
风险容忍度下，综合技术与管理措施，以性价比较高的方案处置安 （二）威胁感知与安全能力提升
全风险，以达到安全与业务的平衡点。同时，设置风险处置的跟踪 安全威胁同时来自于外部与内部。在互联网侧，攻击者时刻在对互
闭环机制，基于积累的风险数据进行复盘分析，结合安全培训赋能 联网资产进行扫描和攻击尝试，采用各种手段绕过公司的安全防御
安全意识提升，推动安全左移，促进风险量化管理水平提升。 体系，以达到突破边界、获取权限或数据、破坏信息系统等目的；
在内网，内部人员的安全意识薄弱，可能会无意或有意绕过安全措
在安全风险全面量化管理过程中，漏洞发现数、漏洞处置数、漏洞 施进行未授权访问，或导致被社工钓鱼进而导致安全防御措施失
处置比例可作为反映安全风险管理的直观指标。下图是公司内网漏 效，危害程度比来自互联网的威胁更甚。
洞管理工作的效果跟踪展示，其中横轴为工作开展的时间线。在第
5周之前，由于IT资源的安全属性数据尚不完备，登录扫描等漏 需要从网络的整体和架构角度建立起纵深防御体系，贯彻执行“分
洞发现机制也未执行到位，所以发现的内网漏洞绝对值较小，但处 区分域、横向到边、纵向到底”的思想，除在网络域边界设置防火
置率尚可；从第5周开始，自动化响应平台开始接入带有全部安 墙等访问控制措施之外，在域内可部署高交互蜜罐，在主机上可配
全属性的IT资源管控平台数据，历史遗留漏洞等“老、大、难” 置HIDS，各防御节点的流量、行为和情报数据经过收集和汇总，
问题开始显现，导致发现的漏洞数量大幅上升，漏洞整改率急剧下 实现对网络运行状态实时监控和全面可视化。
140 141
行
业 可持续的网络安全运营实践
专
刊
… 具，及时处置安全风险，提升安全应急响应的效果和效率。
以网络邮件攻防为例，账号口令安全管理工作是基础，包括设置强
口令策略、随机化初始口令、强制第一次登录系统后改密、试错超
过阈值之后锁定账号、对攻击来源进行分析阻断、定期更新弱口令
库、设置口令重置管理流程等。此外，通过网络安全运营的威胁情
报与监控预警，提升对网络邮件攻击的威胁响应与应急处置能力。
…
图6…互联网流量威胁监测
…
图8…账号口令安全管理与运营
图7…蜜罐实时大屏
具体地，将邮件网关日志、邮件蜜罐日志汇总至日志分析平台，经
在此基础上，安全团队需要从两方面持续提升相关工作能力。一是 过清洗、解析、汇总，结合网络威胁情报，建立邮件账号威胁模型，
安全风险监测能力，安全团队可利用网络画像、关联分析、时序分 抽象出口令爆破、撞库等攻击模式，实现对邮件系统当前遭受网络
析、聚类分类等大数据和人工智能手段，有效地从监测到的网络运 威胁的可视化。将登录账号信息与源IP进行关联分析，可发现单
行状态中发现异常模式，提炼安全场景，实现威胁行为的及时感知。 用户从多IP登录，多用户从单IP登录、单用户异地登录、单IP
二是安全应急响应能力，通过应急演练、实战攻防等，熟悉安全应 多用户失败但单用户成功登录、多个IP尝试登陆多个用户均属于
急响应的流程，积累安全应急响应相关经验，并可进一步固化为标 异常情况，分别对应账号泄露、账号共享、账号爆破、账号撞库等
准操作步骤或安全应急响应脚本，利用安全编排与自动化响应工 安全威胁。
142 143
行
业 可持续的网络安全运营实践
专
刊
………… 避免损失扩大。
在安全编排与自动化响应平台上，不同的响应处置策略落地成类似
下图的、不同的自动化响应的场景脚本。对于需要阻断的情况，场
景脚本与邮件网关进行联动，将处置攻击IP的平均时间从手动处
置时的12h下降至1min，有效提升了邮件系统攻击决策处置的效率。
图9…邮件攻击模式 …
其中一种典型的攻击模式是低频攻击。与基于账号的口令爆破不
同，每个攻击IP仅以低频率进行一次或两次账号登录尝试，导致