original requestor is allowed to make changes only in
the slave server.
To conclude, our lab experiments demonstrate that
systems which allow non-secure dynamic updates are
vulnerable to attacks that can “modify” existing records
and add new records. Non-secure update mechanisms
cover both overly promiscuous address match lists (“any”)
as well as more focused match lists, which can be by-
passed via IP spooﬁng.
4.2 Scanning Setup
To assess the potential impact of non-secure dynamic
updates, we have developed an eﬃcient scanner capable
of sending DNS packets compliant with RFC 2136 [38].
The scanner attempts to add an extra A record to the
zone ﬁle, associating a new upper-level domain, re-
searchdelft, with the IP address of our project’s web
server. We do not spoof the source IP address of the
update request. Our web server describes the project
and provides a method to opt-out from our scans. Note
that we have not received a single abuse complaint or
opt-out request – which might mean that the insertion
of the record was not seen as problematic or, perhaps
more likely, that the insertion went unnoticed. The scan
does not interact with the existing data in the zone ﬁle.
Since our request is technically equivalent to a regular
update request, we do not expect it to interfere with
normal activity and have seen no evidence to the con-
trary.
We analyzed responses of authoritative name servers
and performed DNS lookups to verify if our domain
resolved to our web server’s IP address. We also per-
3http://linux.die.net/man/8/nsupdate
Table 1: Datasets
Table 2: DNS responses to UPDATE requests
#
Domains
NS
IPs of NS
Domain–NS–IP
1% Sample Alexa 1M
2,865,393
510,850
438,478
947,823
487,515
418,251
7,368,659
27,499,061
formed a ten-day long study to estimate the time the
added RR stays in a zone. Finally, we removed the test
DNS record by sending a delete UDPATE request and
then tried to resolve it again. All added records were
successfully deleted.
4.3 Ethical Considerations
While vulnerability scanning has become an estab-
lished part of security research, our approach does raise
ethical questions because of the fact that the only valid
method available to us for assessing the vulnerability of
a DNS server was to add a record to the zone ﬁle.
We have submitted the study to the TU Delft Human
Research Ethics Committee. The committee evaluated
our request and stated that we did not need their autho-
rization since we were not conducting human subjects
research. While this makes sense, it also signals that
current institutional review procedures are not set up
to evaluate ethical issues in computer security.
We have assessed our work using the principles out-
lined in the Menlo report [17]. We do not collect data
on persons. Getting informed consent before adding a
record to the zone ﬁle is both unpractical and would
introduce selection bias, since administrators of well-
secured servers are more likely to consent. We do pro-
vide a clear opt-out mechanism via the website refer-
enced in the added DNS record. The site also provides
full transparency regarding the study and its objectives.
Our approach in testing the vulnerability has been
designed to have as minimal impact as possible: we send
a single RFC-compliant packet. We do not read, change
or otherwise engage with any existing records. We feel
the drawback of lacking consent from server operators is
outweighed by the beneﬁts of our measurement for those
operators: to be made aware of a critical vulnerability in
their DNS server. All notiﬁcations have been completed
before the publication of this paper. The new record is
highly unlikely to be discovered by accident and it is
removed at the end of the study.
4.4 Dataset
To measure the prevalence of non-secure conﬁgura-
tions, we collected data for two samples: a random
sample of 1% of the domain space and the Alexa top
1 million domains (or Alexa 1M) [1].
First, we extracted all domains observed in two com-
plementary datasets between Jan 2015 and Jan 2016: i)
DNSDB that is a large passive DNS database fed by
hundreds of sensors across the world, operated by Far-
sight Security [3], which generously provided access to
DNS
Response
All
REFUSED
FORMERR
NOTAUTH
NOTIMP
SOA
∗
SQR
NOERROR
SERVFAIL
Other
1% Sample
in #
6,007,462
2,325,377
1,374,015
1,198,337
727,734
237,175
114,677
13,580
6,621
9,946
in %
100
38.7
22.8
19.9
12.1
3.9
1.9
0.2
0.2
0.2
Alexa 1M
in #
2,294,099
1,265,544
260,094
357,442
357,592
18,241
25,851
5,093
3,830
412
in %
100
55.2
11.3
15.6
15.6
0.8
1.1
0.2
0.2
0
* Standard Query Response
us and ii) Project Sonar Data Repository obtained though
ANY RR requests, made available by Rapid7 Labs [4].
From the total 286,788,250 unique domains in the
set, we randomly sampled 1%. For that sample and
for the Alexa 1M, we enumerated all observed combi-
nations of name servers and their IP addresses in both
datasets: over 27 and 7 million, respectively (cf. Table
1). The long period of observation and the fact that
DNSDB contains many entries that are poisoned either
maliciously [23, 16] or unintentionally [40], means we
expected a lot of IP addresses on the list to be obsolete,
but we wanted to ﬁnd as many as possible.
We performed the vulnerability assessment against
the random sample on Mar 30, 2016 and against the
Alexa 1M on Apr 10, 2016. For each domain, we sent
an UPDATE request directly to all IP addresses on the list.
As expected, many did not respond. Next to obsolete
NS information, this can also indicate network ﬁltering
and other policies at work. We received responses from
6.0 million (random sample) and 2.3 million (Alexa 1M)
name servers (see Table 2).
5. RESULTS
5.1 Prevalence of Vulnerable Resources
Table 2 summarizes the DNS status codes received
in response packets related to the UPDATE requests. As
expected, the great majority of requests fail to add RRs
to the zone. The most common code is REFUSED, mean-
ing that the server refuses to perform the operation for
security or policy reasons. Around 12.1% and 15.6% of
name servers signal NOTIMP meaning that they do not
implement the protocol extension, whereas 22.8% and
11.3% of servers are not even able to parse and interpret
the dynamic update request and signal FORMERR. Next,
19.9% and 15.6% of name servers signal that they are
not authoritative for the zone. The main reason for
DNS responses with the NOTAUTH error ﬂag is the pres-
ence of obsolete NS information in our dataset as de-
scribed in Section 4.4. Approximately 0.2% of servers
signal SERVFAIL meaning that a hardware error or an
out-of-memory condition might have taken place and
Figure 1: Types of providers hosting vulnerable domains.
Figure 2: Cumulative distribution of vulnerable domains
over providers.
a zone is restored to its state before this transaction
[38]. We ﬁnd 13,580 and 5,093 systems to respond with
NOERROR status code for 1% sample and Alexa 1M re-
spectively, which in both cases corresponds to 0.2% of
responses. Note that NOERROR includes all responses
with this status ﬂag set regardless of whether the ac-
tual content of the zone has been updated.
We sent an A RR request to each of the potentially
updated servers to verify if the zone ﬁle was indeed up-
dated. For the random sample, we observed 2,626 suc-
cessfully added A RRs, corresponding with 188 unique
name servers and 1,877 unique domain names (0.065%
of all randomly selected second-level domains). Sur-
prisingly, we also observed 881 added A RRs that corre-
sponded to 560 unique name servers and 587 domains
from Alexa 1M (0.062%)
5.2 Affected Domains
To get a sense of the population of vulnerable do-
mains, we ﬁrst analyzed the type of network that hosts
them. In earlier work, we developed a categorization of
providers based on ground-truth data, manual labeling,
WHOIS records and passive DNS data – for more details,
see [11, 36]. We were able to classify 105 (out of 206)
providers for the random sample and 210 (out of 398)
for the Alexa 1M.
Figure 1 outlines the number of providers that have
at least one vulnerable server in their network. As ex-
pected, hosting and ISP broadband constitute a great
portion of the aﬀected providers. Interestingly, we ob-
serve misconﬁgured zones in as many as 52 educational
networks in the Alexa 1M.
Figure 2 shows the cumulative distribution of vul-
nerable domains over providers.
In the random sam-
ple, we ﬁnd that 66.2% (1,149) of vulnerable domains
are hosted on the infrastructure of a single Japanese
broadband ISP. Reconﬁguring the zone ﬁles of just 10
providers would reduce the prevalence of the issue with
88.6%. If this kind of concentration is representative of
Table 3: Categories of vulnerable domains for Alexa 1M
Type
Business
Entertainment
Educational
Governmental
News services
Adult
Financial services
Health care
Other
Total
in # in %
181
92
90
56
41
13
9
8
95
587
31
15.7
15.3
9.5
7
2.2
1.5
1.4
16.2
100
the overall domain space, then reaching out to a limited
number of operators could greatly increasing the costs
of ﬁnding vulnerable domains for cybercriminals. For
the Alexa 1M, the pattern is much less concentrated.
This might not be a major obstacle for remediation,
though, as the high traﬃc sites in this set are typically
professionally operated, so a comprehensive notiﬁcation
campaign might be eﬀective.
We further analyze the cumulative distributions of
vulnerable domains on DNS servers in descending order
of the number of their common domains. For reasons of
brevity, we highlight only the most interesting ﬁndings.
In vulnerable 1% sample, we ﬁnd that only one server
is authoritative for as many as 1,635 (87%) domains,
whereas in Alexa 1M, one DNS server is associated with
154 (26%) domains. As expected the cumulative con-
centrations per DNS servers are similar to the ones ob-
served for providers (see Figure 2) as they operate the
name servers themselves. In the 1% sample, for exam-
ple, just six servers that share the same second- and
top-level domain (*.dnsserver.net) are authoritative
for 89.8% of the vulnerable domains, all hosted by the
same broadband ISP in Japan.