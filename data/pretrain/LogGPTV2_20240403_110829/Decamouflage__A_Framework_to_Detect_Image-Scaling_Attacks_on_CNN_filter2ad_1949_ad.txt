Results in the white-box setting: Figure 12 demonstrates that
we can ﬁnd a reasonable threshold (red dashed lines) in both
MSE and SSIM to distinguish original images from attack
images. We use the gradient descent method to ﬁnd such
thresholds in an automated manner. The selected threshold
value for MSE is 1714.96; and the selected threshold value
for SSIM is 0.61.
Fig. 12: Distributions of MSE and SSIM values for the scaling detection
method in the white-box setting with 1000 original images and 1000 attack
images.
With the selected threshold values, we evaluate the scaling
detection method’s performance (accuracy, precision, recall,
FAR, and FRR) for the evaluation dataset. Table II shows
that the detection accuracy results of the scaling detection
method in the white-box setting. The scaling detection method
achieves an accuracy of 99.9% with FAR of 0.0% and FRR
of 0.1% for MSE.
TABLE. II: Results of the scaling detection method in the white-box setting.
Rec.
Acc.
M SE 99.9%
99.9%
SSIM 99.0% 99.7% 99.9%
P rec.
100%
F AR
0.0%
0.3%
F RR
0.1%
0.1%
Results in the black-box setting: We adopt the percentile
of the obtained MSE and SSIM distributions built upon 1000
benign images to validate the black-box scenario performance.
Figure 13 demonstrates that MSE values and the SSIM values
follow a normal distribution, respectively, indicating that a
percentile-based threshold performs well. As percentile in-
creases, FRR also increases.
Fig. 11: Black-box setting to analyze the practicality of Decamouﬂage.
Selecting the optimal threshold for the black-box setting:
To determine the threshold of a metric M for a detection
method in the black-box setting, we compute the metric values
for original images (Moriginal) to use the statistical distribu-
tion of Moriginal, such as its mean and standard deviation. We
adopt a percentile of that distribution as a detection boundary
and use it as a threshold. Percentile is a measure used in
statistics indicating the value beyond a given distribution.
With the training dataset, we select the optimal percentile of
the metrics results from their distributions as the threshold
achieving the best accuracy results for the detection method.
The detection accuracy of Decamouﬂage is evaluated with
ﬁve metrics, accuracy, precision, recall, false acceptance rate
(FAR), and false rejection rate (FRR), which are popularly
used to evaluate the performance of classiﬁers.
70
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 08:54:52 UTC from IEEE Xplore.  Restrictions apply. 
that the detection accuracy results of the ﬁltering detection
method in the white-box setting. The ﬁltering detection method
achieves an accuracy of 98.3% with FAR of 1.0% and FRR
of 2.5% for SSIM.
TABLE. IV: Results of the ﬁltering detection method in the white-box setting.
Acc.
Rec.
M SE 97.3% 97.4% 97.2%
SSIM 98.3% 98.9% 97.5%
P rec.
F AR
2.6%
1.0%
F RR
2.8%
2.5%
Results in the black-box setting: We adopt the percentile
of the obtained MSE and SSIM distributions built upon 1000
benign images to validate the black-box scenario performance.
Figure 15 demonstrates that MSE values and the SSIM values
follow a normal distribution, respectively, indicating that a
percentile-based threshold performs well.
Fig. 15: Distributions of MSE and SSIM values for the ﬁltering detection
method in the black-box setting with 1000 original images. A percentile is
represented as a green segment.
With the three different percentiles (1%, 2%, and 3%),
we evaluate the ﬁltering detection method’s performance (ac-
curacy, precision, recall, FAR, and FRR) for the evaluation
dataset, respectively. Table V shows the detection accuracy
results of the ﬁltering detection method with the three different
percentiles in the black-box setting. Based on the accuracy
results, our recommendation is to use SSIM with 1% per-
centile. In this case, the ﬁltering detection method achieves an
accuracy of 98.2% with FAR of 2.3% and FRR of 1.3% for
SSIM.
TABLE. V: Results of the ﬁltering detection method in black-box setting.
Percentile Acc.
M SE
SSIM
1%
2%
3%
1%
2%
3%
P rec.
Rec.
97.3% 98.7% 93.8%
97.1% 97.7% 96.3%
97.0% 96.3% 97.8%
98.2% 97.7% 98.7%
98.0% 97.7% 99.0%
97.5% 96.1% 99.1%
F AR
1.2%
2.2%
3.7%
2.3%
2.2%
4.0%
1952.32 1543.27
F RR M ean
6.2%
3.7%
2.2%
1.3%
1.0%
0.9%
0.74
ST D
0.11
D. Results of the Steganalysis Detection Method
Results in the white-box setting: Figure 16 shows that 99.3%
of original
images have 1 CSP, whereas 98.2% of attack
images have more than 1 CSP, indicating that we can clearly
distinguish them if we set the CSP threshold to 2.
With the CSP threshold of 2, we evaluate the steganalysis
detection method’s performance (accuracy, precision, recall,
FAR, and FRR) for the evaluation dataset. Table VI shows
that the detection accuracy results of the steganalysis detection
method in the white-box setting. The steganalysis detection
method achieves an accuracy of 98.5% with FAR of 0.3%
and FRR of 2.7%.
Fig. 13: Distributions of MSE and SSIM values for the scaling detection
method in the black-box setting with 1000 original images. A percentile is
represented as a green segment.
With the three different percentiles (1%, 2%, and 3%) that
are eventually preset FRR, we evaluate the scaling detection
method’s performance (accuracy, precision, recall, FAR, and
FRR) for the evaluation dataset, respectively. Table III shows
the detection accuracy results of the scaling detection method
with the three different percentiles in the black-box setting.
Based on the accuracy results, our recommendation is to use
either MSE or SSIM with 1% percentile. The scaling detection
method achieves an accuracy of 98.4% with FAR of 3.2%
and FRR of 1.0% for MSE. When the percentile is 1%, the
scaling detection method produces the best accuracy of 93.6%
with FAR of 11.9% and FRR of 1.0% for SSIM, which are
relatively inferior to the results in the white-box setting.
TABLE. III: Results of the scaling detection method in the black-box setting.
Percentile Acc.
M SE
SSIM
1%
2%
3%
1%
2%
3%
P rec.
F AR
Rec.
3.2%
98.4% 96.8% 99.0%
5.3%
97.3% 94.9% 99.0%
96.2% 93.0% 99.0%
7.5%
93.6% 88.0% 99.0% 11.9%
90.2% 83.6% 99.0% 19.6%
89.1% 82.2% 99.0% 21.8%
218.6
F RR M ean
1.0%
1.0%
1.0%
1.0%
1.0%
1.0%
0.91
ST D
217.6
0.59
C. Results of the Filtering Detection Method
Results in the white-box setting: Figure 14 demonstrates that
we can ﬁnd a reasonable threshold (red dashed lines) in both
MSE and SSIM to distinguish original images from attack
images even though there exist some overlapped part between
them in MSE. Again, we use the gradient descent method
to ﬁnd such thresholds in an automated manner. The selected
threshold value for MSE is 5682.79; and the selected threshold
value for SSIM is 0.38.
Fig. 14: Distributions of MSE and SSIM values for the ﬁltering detection
method in the white-box setting with 1000 original images and 1000 attack
images.
With the selected threshold values, we evaluate the ﬁltering
detection method’s performance (accuracy, precision, recall,
FAR, and FRR) for the evaluation dataset. Table IV shows
71
Authorized licensed use limited to: Tsinghua University. Downloaded on October 11,2021 at 08:54:52 UTC from IEEE Xplore.  Restrictions apply. 
(a) MSE-10010200100200300400500OriginalDistribution(b) SSIM0.511.5020406080100OriginalDistributionMinimum filter/poolingPercentile %Percentile %Fig. 16: Distributions of CSP values for the steganalysis detection method in
the white-box setting with 1000 original images and 1000 attack images.
TABLE. VI: Results of the steganalysis detection method in the white-box
setting.
CSP
Acc.
Rec.
98.5% 99.6% 97.3%
P rec.
F AR
0.3%
F RR
2.7%
Results in the black-box setting: Interestingly, we do not
need to analyze the CSP distribution of original images in
the steganalysis detection method, unlike the other detection
methods. Based on our observation of the white-box setting
experiments, we surmise that
the attack images generated
by image-scaling attacks inherently have multiple centered
spectrum points. Therefore, we use a ﬁxed threshold of 2 for
CSP in the steganalysis detection method regardless of original
and attack images. Consequently, we can reduce the cost of
determining thresholds in the steganalysis detection method.
If we use 2 for the CSP threshold, the steganalysis detection
method achieves an accuracy of 98.5% with FAR of 0.3%
and FRR of 2.7%, which are the same as the results in the
white-box setting.
E. Running Time
As the threshold determination is performed ofﬂine, we focus
on the running time overhead, which is important for real-
time detection. That is, we examine how long the plug-in
Decamouﬂage system takes from getting an input image until
producing the detection decision. We implemented Decam-
ouﬂage in Python 3. We used a PC with an Intel Core i5-
7500 CPU (3.41GHz) and 8GB RAM in all our experiments.
Table VII details the running time overheads of the detection
methods tested, indicating that the detection of each method
requires between 3 and 137 millisecond per image on average.
TABLE. VII: Running time overheads of detection methods.
Method
Scaling
F iltering
Steganalysis
Metric
M SE
SSIM
M SE
SSIM
CSP
Average
(millisecond)
Standard
deviation
(millisecond)
11
137
5
65
3
5
4
1
2
1
Furthermore, each method’s standard deviation is small,
indicating that it takes a similar time regardless of images.
Those measurement results demonstrate that Decamouﬂage
can be deployed for real-time detection. Notably, the steganal-
ysis detection method can be deployed to detect image-scaling
attacks efﬁciently without the threshold setup process.
F. Effects of Attack Image Sizes
In this section, we analyze the effects of attack image sizes
on the performance of Decamouﬂage. We evaluated the per-
formance of Decamouﬂage with different attack image sizes
(56x56), (112x112), and (224x224) in terms of the attack
detection rate (ADR) and the image recognition rate (IRR),
where ADR is the rate of correctly detected attack images
by Decamouﬂage and IRR represents the rate of successfully
recognized as attack images (after applying image-scaling
operations) while still remaining undetected. We manually
measured IRR.
TABLE. VIII: Effects of image sizes on the performance of Decamouﬂage.
(W/B) means (white-box setting/ black-box setting).
56x56
112x112
224x224
Method
Metric
ADR
(W/B, %)
100/100
M SE
SSIM 100/100
60/49
M SE
29/88
SSIM
77/77
CSP
IRR
(W/B, %)
-/-
-/-
15/19.6
15.4/8.3
13.1/17.3
ADR
(W/B, %)
100/100
100/100
96/94
70/92
100/100
IRR
(W/B, %)
-/-
-/-