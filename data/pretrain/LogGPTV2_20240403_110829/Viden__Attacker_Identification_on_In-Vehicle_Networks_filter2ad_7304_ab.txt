1
n (cid:0) 1
r =
)(
);
n∑
i=1
(
1089-7798 (c) 2019 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
 11 bitsACKCRCDataControlArbitrationSOFIDRTRIDERBODLCDataCRCCRCDelACKACKDelEOF4 bits0~64 bits15 bits7 bits (cid:38)(cid:36)(cid:49)(cid:3)(cid:37)(cid:88)(cid:86)(cid:36)(cid:85)(cid:69)(cid:76)(cid:87)(cid:85)(cid:68)(cid:87)(cid:76)(cid:82)(cid:81)(cid:38)(cid:82)(cid:81)(cid:87)(cid:85)(cid:82)(cid:79)(cid:39)(cid:68)(cid:87)(cid:68)(cid:49)(cid:82)(cid:71)(cid:72)(cid:3)(cid:38)(cid:49)(cid:82)(cid:71)(cid:72)(cid:3)(cid:37)(cid:36)(cid:87)(cid:87)(cid:68)(cid:70)(cid:78)(cid:72)(cid:85)(cid:3)(cid:36)(cid:36)(cid:85)(cid:69)(cid:76)(cid:87)(cid:85)(cid:68)(cid:87)(cid:76)(cid:82)(cid:81)(cid:3)(cid:47)(cid:82)(cid:86)(cid:87)(cid:40)(cid:85)(cid:85)(cid:82)(cid:85)(cid:19)(cid:20)(cid:19)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:19)(cid:20)(cid:20)(cid:20)(cid:19)(cid:19)(cid:19)(cid:20)(cid:19)(cid:20)(cid:19)This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/LCOMM.2019.2937097, IEEE
Communications Letters
3
(a) 2017 Luxgen U5 SUV.
(b) 2017 Buick Regal.
(c) Connection to the vehicle.
(d) OBD II connection.
Fig. 4: Two experimental vehicles and other equipments.
A. Experimental Environment
We conducted three types of attacks on two vehicles and
executed intrusion detection experiments using the voltage
characteristics of CAN bus. As shown in Fig.4a and Fig.4b,
the two cars we used are Luxgen U5 SUV and Buick Regal.
We accessed the CAN bus via the vehicle OBD II interface as
shown in Fig.4d, where the 6 pin and 14 pin can be used
to connect to CAN-H and CAN-L lines. Fig.4c shows the
equipments used in our experiments: the voltage measuring
device PicoScope 2204A, which is a portable oscilloscope that
allows us to view waveforms and save data directly on the
computer; the CANalyst II to send camouﬂaged CAN frames
to the vehicles for physical attacks; the CANWIFI II device
that enables us to perform remote wireless attack at a distance
of 30m.
B. Spooﬁng Attack and Detection
By analyzing the CAN bus data, we conducted the reverse
engineering process of CAN bus trafﬁc and performed a
spooﬁng attack. We sent camouﬂaged data that can control
vehicle light wipers, tachometers etc., to the vehicles by using
the aforementioned CANWIFI II device, and collected the
CAN bus voltage at the same time. Since different devices
connected to CAN bus can generate different voltages due to
their unique physical characteristics, the voltage waveform can
be accurately detected by our LOF-based scheme. Fig.3 shows
the procedure of our experiment.
C. Bus-off Attack and Detection
According to Section II-C, we know that there is an arbi-
tration mechanism on CAN bus. Under normal circumstances,
multiple ECUs can transmit messages in parallel to perform
arbitration procedure only when the ID ﬁeld is transferred.
However, under the bus-off attack, parallel transfers can also
happen in other ﬁelds. When two ECUs e.g., B and C in
Fig.2, need to transfer data, they enter the arbitration phase.
If B has a higher priority than C, it will win arbitration.
In subsequent DLC and data ﬁelds, only the winner can
Fig. 3: LOF-based scheme used for sender identiﬁcation and
intrusion detection.
C. Local Outlier Factor
LOF is a distance-based anomaly detection method that can
detect abnormal points in high-dimensional coordinates often
used in areas such as anti-cheating, attack defense, and pseudo
base stations. A key step in density-based outlier detection is
to assign the dispersion for each point. Consider one point in
a given set, if its surrounding points are dense, then the point
is deemed to be normal. Outliers are points farther away from
normal points. There exists a threshold to determine whether a
point is a outlier. If the LOF value of one sample is close to the
threshold, it is likely to be normal, and viceversa. In the actual
scenario, in order to get the best effect, the corresponding
threshold should be carefully set to differentiate normal points
and abnormal points.
The following formula is adopted to represent the LOF value
for point p:
∑
∑
LOFk(p) =
o2Nk(p) lrdk(o)
jNk(p)j
=lrdk(p);
(2)
where lrdk(p) is the so-called local reachable density ex-
pressed as:
lrdk(p) = 1=(
o2Nk(p) max(dk(o); d(p; o))
jNk(p)j
);
(3)
where Nk(p) is the set of k nearest neighbors for point p. The
reachable distance is represented as: max(dk(o); d(p; o)), in
which dk(o) is the distance between the kth nearest neighbor
and o, and d(p; o) is the distance between o and p.
IV. EXPERIMENT AND RESULT ANALYSIS
In this section, three types of attacks i.e., physical attack,
remote attack, bus-off attack, and intrusion detection experi-
ments are introduced detailedly.
1089-7798 (c) 2019 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
(cid:38)(cid:36)(cid:49)(cid:16)(cid:43)(cid:38)(cid:36)(cid:49)(cid:16)(cid:47)(cid:20)(cid:21)(cid:19)(cid:161)(cid:20)(cid:21)(cid:19)(cid:161)(cid:50)(cid:37)(cid:39)(cid:266)(cid:40)(cid:38)(cid:56)(cid:20)(cid:40)(cid:38)(cid:56)(cid:21)(cid:40)(cid:38)(cid:56)(cid:22)(cid:36)(cid:87)(cid:87)(cid:68)(cid:70)(cid:78)(cid:72)(cid:85)(cid:38)(cid:68)(cid:83)(cid:87)(cid:88)(cid:85)(cid:72)(cid:3)(cid:57)(cid:82)(cid:79)(cid:87)(cid:68)(cid:74)(cid:72)(cid:48)(cid:72)(cid:68)(cid:81)(cid:3)(cid:3)(cid:48)(cid:68)(cid:91)(cid:76)(cid:80)(cid:88)(cid:80)(cid:3)(cid:3)(cid:57)(cid:68)(cid:85)(cid:76)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3)(cid:17)(cid:17)(cid:17)(cid:11)(cid:47)(cid:50)(cid:41)(cid:12)(cid:41)(cid:72)(cid:68)(cid:87)(cid:88)(cid:85)(cid:72)(cid:3)(cid:72)(cid:91)(cid:87)(cid:85)(cid:68)(cid:70)(cid:87)(cid:76)(cid:82)(cid:81)(cid:48)(cid:72)(cid:68)(cid:81)(cid:3)(cid:3)(cid:48)(cid:68)(cid:91)(cid:76)(cid:80)(cid:88)(cid:80)(cid:3)(cid:3)(cid:57)(cid:68)(cid:85)(cid:76)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3)(cid:17)(cid:17)(cid:17)(cid:48)(cid:72)(cid:68)(cid:81)(cid:3)(cid:3)(cid:48)(cid:68)(cid:91)(cid:76)(cid:80)(cid:88)(cid:80)(cid:3)(cid:3)(cid:57)(cid:68)(cid:85)(cid:76)(cid:68)(cid:81)(cid:70)(cid:72)(cid:3)(cid:17)(cid:17)(cid:17)(cid:103)(cid:103)(cid:103)(cid:40)(cid:38)(cid:56)(cid:20)(cid:40)(cid:38)(cid:56)(cid:21)(cid:40)(cid:38)(cid:56)(cid:22)(cid:36)(cid:87)(cid:87)(cid:68)(cid:70)(cid:78)(cid:72)(cid:85)Signal ground12345678916151413121110CAN-H lineCAN-L lineThis article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/LCOMM.2019.2937097, IEEE
Communications Letters
4
Fig. 5: Comparison of bus-off and normal signal voltage
waveforms.
transmit data. In this way, if the attacker A and victim B
start transmission simultaneously with the same ID, they can
win arbitration together and transmit data at the same time.
When B sends the recessive bit (1) and A sends the dominant
bit (0) in DLC or data ﬁelds, B will see the opposite bit
to the message it transmits, since that CAN bus logically
behaves as a wired-AND gate. As a result, B is able to
experience a bit error enforced by A, and increase its TEC
by 8. By repeating this procedure on B’s messages, A can
continuously increase B’s TEC and force it to disconnect from
the bus. We reconstruct this bus-off attack to further verify our
intrusion detection method. In Fig.5, we can see that there is
a signiﬁcant difference between normal frames and abnormal
frames at physical level.
D. Experimental Results and Analysis
As shown in Fig.6, the results of attacker identiﬁcation in
Luxgen and Buick cars prove that our method can identify
ECUs accurately. We tested 12 ECUs from Luxgen car, of
which 4 ECUs can be perfectly identiﬁed, and the others can
have identiﬁcation rates of 96% or higher. Our false detection
rate is very low, only 0.5% of ECU3’s signal is considered to
be ECU2’s signal. We also tested 13 ECUs from Buick car,
three of which are perfectly identiﬁed. For other ECUs, the
identiﬁcation rates are all above 98% except for ECU4. Note
that only ECU10 has a false detection rate of 1%.
Fig.6 also shows the effectiveness of our intrusion detection
method on two vehicles. Attack1 and attack2 are physical
connection attack and remote wireless attack, respectively. At-
tack3 is the bus-off attack. We conducted our experiments on
three attack signals and normal signals. The results show that
the proposed LOF-based method can accurately distinguish
between normal signals and attack signals, as well as different
attack signals. Moreover, the intrusion detection results of
Luxgen car and Buick car show that more than 97% of the
signals can be accurately identiﬁed. The detection rate of the
bus-off attack is over 90%.
Fig.7 shows the intrusion detection results realized by
the SVM (Support Vector Machine) algorithm. The average
detection rate on two vehicles is 87.9% and the average
false detection rate is 3.77%. The highest false detection
rate is 17.5%. Comparatively, LOF-based method has higher
detection rate and lower false detection rate.
V. CONCLUSION
In this paper, we have proposed an LOF-based intrusion
detection method to implement attacker identiﬁcation. We
Fig. 6: Experimental results using LOF-based method on two
vehicles.
Fig. 7: Experimental results using SVM on two vehicles.
have conducted three intrusion detection experiments on two
vehicles to prove the superiority of our scheme. The numerical
results have shown that the LOF-based method can greatly
reduce the false detection rate under the premise of ensuring
the accuracy rate. Future work is in progress to implement a
complete intrusion detection system with more attack models
and efﬁcient algorithms. We will use the ﬁltering algorithm
to deal with the error detection problem and improve the
practicability of the method.
ACKNOWLEDGMENT
This work was supported by the National Natural Science
Foundation of China (61771374, 61771373, 61801360, and
61601357), in part by the Fundamental Research Fund for the
Central Universities (3102019PY005, JB181506, JB181507,
and JB181508), and in part by China 111 Project (B16037).
REFERENCES
[1] J. Liu, S. Zhang, S. Wen, and Y. Shi, “In-vehicle network attacks
and countermeasures: Challenges and future directions,” IEEE Network,
vol. 31, no. 5, pp. 50–58, 2017.
[2] T. Q. Duong, T. T. Duy, M. Elkashlan, N. H. Tran, and O. A. Dobre,
“Secured cooperative cognitive radio networks with relay selection,” in
Proc. IEEE Globecom, 2014, pp. 3074–3079.
1089-7798 (c) 2019 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
(cid:49)(cid:82)(cid:85)(cid:80)(cid:68)(cid:79)(cid:3)(cid:41)(cid:85)(cid:68)(cid:80)(cid:72)(cid:37)(cid:88)(cid:86)(cid:16)(cid:82)(cid:73)(cid:73)(cid:3)(cid:40)(cid:85)(cid:85)(cid:82)(cid:85)(cid:3)(cid:41)(cid:85)(cid:68)(cid:80)(cid:72)S1S3S5S7S9S11C1C9C7C5C3C11S1S3S5S7S9S11S13C1C9C7C5C3C11C1340608010020099.5999795979897.5900.5110.5999710099100971001001009899990.5999999.5959898.51009810099.510099.599.51 Luxgen ECU identification Buick ECU identification Luxgen intrusion detectionBuick intrusion detection1S1S3S5S7S9S11C1C9C7C5C3C11S1S3S5S7S9S11S13C1C9C7C5C3C11C13406080100200868785.587.5888484.585317.58.548988928692.5928986918888.589.5787.5879084908988.586.587.58787.59089191513.520.541490.55.511.59Luxgen ECU identificationBuick ECU identificationLuxgen intrusion detectionBuick intrusion detectionThis article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/LCOMM.2019.2937097, IEEE
Communications Letters
5
[3] Q. Luo and J. Liu, “Wireless telematics systems in emerging intelligent
and connected vehicles: Threats and solutions,” IEEE Wireless Commun.,
vol. 25, no. 6, pp. 113–119, 2018.
[4] A. Groll and C. Ruland, “Secure and authentic communication on exist-
ing in-vehicle networks,” in Proc. IEEE Intelligent Vehicles Symposium,
2009, pp. 1093–1097.
[5] K.-T. Cho and K. G. Shin, “Viden: Attacker identiﬁcation on in-
vehicle networks,” in Proc. ACM SIGSAC Conference on Computer and
Communications Security, 2017, pp. 1109–1123.
[6] B. Groza and P.-S. Murvay, “Efﬁcient intrusion detection with bloom
ﬁltering in controller area networks,” IEEE Transactions on Information
Forensics and Security, vol. 14, no. 4, pp. 1037–1051, 2019.
[7] H. M. Song, H. R. Kim, and H. K. Kim, “Intrusion detection system
based on the analysis of time intervals of can messages for in-vehicle
network,” in in Proc. IEEE ICOIN, 2016, pp. 63–68.
[8] M. Kneib and C. Huth, “Scission: Signal characteristic-based sender
identiﬁcation and intrusion detection in automotive networks,” in Proc.
ACM SIGSAC Conference on Computer and Communications Security,
2018, pp. 787–800.
[9] V. D. Nguyen, H. V. Nguyen, T. Q. Duong, O. A. Dobre, and O. S.
Shin, “On the design of secure full-duplex multiuser systems under user
grouping method,” in Proc. IEEE ICC, 2018, pp. 1–6.
[10] K.-T. Cho and K. G. Shin, “Error handling of in-vehicle networks makes
them vulnerable,” in Proc. ACM SIGSAC Conference on Computer and
Communications Security, 2016, pp. 1044–1055.
1089-7798 (c) 2019 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.