# “暴富谎言”网络博彩
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
导读：“相见不问好，开腔言生肖。上期已出牛，这期该马跑？输者长叹息，赢者怨注小。田亩少人耕，沃野生蒿草。电视及时雨，码报如雪飘。遥望买单处，人如东海潮。”一首“买马”诗，形象地刻画出地下“六合彩”的泛滥灾情。互联网的快速发展促使彩票产业从线下转向了线上，网络博彩同样泛滥成灾。最近暗影实验室收集了一批博彩类样本，并对其进行了分类分析。
## 1\. 网络博彩背景
在网站上搜索“网络赌博案”很快映入眼帘的标题就是“全国最大网络赌徒案宣判：‘暴富谎言’吸引4840亿投注”、“全国最大规模网络赌博案，赌徒一月输掉150亿”等案例，从2014年世界杯起催生了约300家互联网公司在线售卖彩票，导致网络售彩各种乱象层出不穷。同时互联网时代，移动数据时代为博彩类应用的滋生提供了良好的环境。国家对网络博彩并没有明确的法律规定，这就导致越来越多人钻法律空子，铤而走险进入博彩行业。近日公安部发布消息称：大连、烟台警方各破获一起特大非法经营案，涉案金额分别为92亿元和15亿元，涉案公司主要从事帮助跨境赌博公司搭建非法支付渠道。由此可以看出网络赌博流转的资金是多么庞大，又有多少民众深受其害。
## 2\. 博彩类应用概述
### 2.1 应用名分布
博彩类应用大部分以…彩票、…娱乐城命名。如下图所示为博彩类应用名称分布情况。
图2-1 博彩类应用名称
### 2.2 样本包名签名信息统计
通过对样本的统计发现这批样本中，以com.apk.u为前缀的包名最多，占比为82%。而这些包名对应的签名信息CN=apk,OU=apk…同样也占比最高占比为83%，由于相同签名的样本只能出自一个组织或个人，其他人无法获得相同的签名。因此可以看出这些应用基本都出自于同一厂家。
图2-2 应用包名与签名分类统计图
样本同质化严重，质量低下，不同的应用的界面结构几乎一模一样。
图2-3 不同应用的“两个”主界面
### 2.3 网络博彩套路
网络博彩通过QQ、比邻、陌陌等社交软件利用男帅女靓的头像吸引他人，获取好感并主动加好友，之后以软件不常用的理由要求对方加微信。微信头像，朋友圈等信息都是盗用他人照片，朋友圈的虚假信息。通过朋友圈营造自己是一个成功人士。主动联系受害者，虚寒问暖、获取信任、了解对方经济情况。之后透露自己有副业，盈利丰富，勾起对方好奇心。以试玩，充值就送，虚假的盈利数据诱惑对方充值。对方上钩后，通过修改开奖结果，带初玩者把把盈利，加深他们对平台以及介绍者的信任。之后便以多输少赢的局面让受害者亏空。
图2-4 网络博彩套路
## 3\. 样本启动流程
博彩类应用基本通过“套壳”方式启动，也就是先利用“壳App”（App内只注册了少量组件，文件结构简单，相当于一个空壳，此文我将它称作壳App）注册并通过审核，接着在后台通过网站接入、变换页面等方式将有赌博内容的网页及功能加入到原来的壳App中替换掉之前的页面，这样就可以形成一个新的博彩应用程序。
以套壳方式启动的原因：
（1）原生app的开发成本和网页相比相对较高，所以越来越多的app使用网页来作为界面，甚至完全将一个网站封装成app，可以提高开发速度，还能基本实现跨平台。
（2）有些应用商店如苹果商店禁止数字货币、博彩类应用的上架，通过这种方式可以躲避应用商店的检测。
图3-1 应用启动流程
## 4\. 技术特点
### 4.1 静默安装
检测手机目录下是否存在应用包名，如果存在则执行cmd命令静默安装。
图4-1 静默安装
### 4.2 套壳启动
壳app文件结构简单，清单文件中只注册了少了activity页面。同时通过该丰富的网页链接，自动加载博彩网页，接入博彩网站。
图4-2 样本文件结构
清单文件中只注册了几个activity。用于加载丰富的博彩网页，接入博彩网站。
图4-3 样本清单文件结构
丰富的网页链接，通过url拼接成各网页地址。
图4-4 丰富的博彩网页
通过WebView的loadurl（）方式接入网站（如https://****.net/mobile/index.php），且通过setJavaScriptEnabled（）设置与页面进行交互。
图4-5 加载方式
### 4.3 规避封堵
（1）应用程序通过频繁更新应用版本来规避封堵。
图4-6 频繁升级版本
（2）应用集成了支付宝、微信支付、云微付各种支付手段。
图4-7 支付渠道多样
通过不定时的更新支付手段，以及收款账号来规避封堵。
图4-8 更新收款方式及账号
（3）频繁更换官网来规避封堵。代码内集成了多条网站路线，如果其中一条网站路线被封堵，可开通其它的路线。
图4-9 多条官网路线
不同的路线指向不同的的内容。
图4-10 不同路线打开的网站不同
### 4.4 固定算法
根据游戏规则制定多样的开奖算法。
图4-11 固定算法
依据“重庆时时彩”每期发布的5个开奖数字，5个数字的大小、单双排列决定输赢。赌博设置了4、5种规则，比如5个数字加起来大于等于23的为大，小于等于22的为小。
图4-12 精密计算
### 4.5 恶意行为
（1）有些博彩应用内存在获取用户隐私、拨打用户电话、向用户发送短信的高危行为。获取用户手机电话号码、网络运行商、sim卡运营商、设备id等信息。
图4-13 获取收集设备信息
（2）获取手机音频、视频以及图片信息。
图4-14 获取手机应用使用情况
（3）获取用户登录账号、邮箱、QQ、微信、卡号、开户行等信息。
图4-15 获取用户个人信息
（4）向用户发送博彩相关的短信，勾起用户好奇心。
图4-16 发送短信
（5）拨打用户电话，向用户推销彩票。
图4-17 拨打电话
## 5\. 追踪溯源
### 5.1 组织架构
俗话说羊毛出在羊身上，从制作到使用，每一环节都可以获利，线上赌博的流程已经形成了一条成熟的产业链，BOSS属于投资方以及幕后最大的操作手，同时也是隐藏最深，制作团队根据需求以及市场情势批量制作应用程序或者网站，这样的产品一般都是套用模板，配合着精心研究的算法批量产出，代理团队使用各种办法将其进行推广及处理售后工作，发展的下线通过设置赔率从流水线中获取佣金，当用户被榨干钱财的时候，推荐与其合作的贷款平台，层层环节获取的黑钱交由洗钱组通过多次转账等手法将其洗出分成。
图5-1 组织架构
### 5.2 传播途径
**5.2.1 微信小程序**
小程序的火热以及它带来的方便高效性博得了用户很多好感，很多人对它们的戒备心并不是很强，随手一个转发到群聊，点击量就会不断增加。同为好奇星人表示不能忍。