title:Detecting Network Anomalies in Backbone Networks
author:Christian Callegari and
Loris Gazzarrini and
Stefano Giordano and
Michele Pagano and
Teresa Pepe
Detecting Network Anomalies in Backbone
Networks
Christian Callegari, Loris Gazzarrini, Stefano Giordano,
Michele Pagano, and Teresa Pepe
Dept. of Information Engineering, University of Pisa, Italy
{c.callegari,l.gazzarrini,s.giordano,m.pagano,t.pepe}@iet.unipi.it
1 Extended Abstract
The increasing number of network attacks causes growing problems for network
operators and users. Thus, detecting anomalous traﬃc is of primary interest in
IP networks management. As it appears clearly, the problem becomes even more
challenging when taking into consideration backbone networks that add strict
constraints in terms of performance.
In recent years, Principal Component Analysis (PCA) has emerged as a very
promising technique for detecting a wide variety of network anomalies. PCA is
a dimensionality-reduction technique that allows the reduction of the dataset
dimensionality (number of variables), while retaining most of the original vari-
ability in the data. The set of the original data is projected onto new axes, called
Principal Components (PCs). Each PC has the property that it points in the
direction of maximum variance remaining in the data, given the variance already
accounted for in the preceding components.
In this work, we have focused on the development of an anomaly based Net-
work Intrusion Detection System (IDS) based on PCA. The starting point for our
work is represented by the work by Lakhina et al. [1], [2]. Indeed, we have taken
the main idea of using the PCA to decompose the traﬃc variations into their
normal and anomalous components, thus revealing an anomaly if the anomalous
components exceed an appropriate threshold. Nevertheless, our approach intro-
duces several novelties in the method, allowing great improvements in the system
performance. First of all we have worked on four distinct levels of aggregation,
namely ingress router, origin-destination ﬂows, input link, and random aggre-
gation performed by means of sketches, so as to detect anomalies that could be
masked at some aggregation level. In this framework, we have also introduced a
novel method for identifying the anomalous ﬂows inside the aggregates, once an
anomaly has been detected. To be noted that previous works are only able to
detect the anomalous aggregate, without providing any information at the ﬂow
level. Moreover, in our system PCA is applied at diﬀerent time-scales. In this
way the system is able to detect both sudden anomalies (e.g. bursty anomalies)
and “slow” anomalies (e.g. increasing rate anomalies), which cannot be revealed
at a single time-scale. Finally, we have applied, together with the entropy, the
Kullback-Leibler divergence for detecting anomalous behavior, showing that our
S. Jha, R. Sommer, and C. Kreibich (Eds.): RAID 2010, LNCS 6307, pp. 490–491, 2010.
c(cid:2) Springer-Verlag Berlin Heidelberg 2010
Detecting Network Anomalies in Backbone Networks
491
Flow Aggregation
Time-series construction
Netflow
Data 
Formatting
ASCII
Aggregate?
Metrics?
OD
IL
IR
random
Entropy
K-L Divergence
Anomaly Detector
Identification
Detection
PCs
computation
ξ
Fig. 1. System Architecture
choice results in better performance and more stability for the system. Figure 1,
shows the architecture of the proposed system.
The proposed system has been tested using a publicly available data-set, com-
posed of traﬃc traces collected in the Abilene/Internet2 Network [3], that is a
hybrid optical and packet network used by the U.S. research and education com-
munity. Since the data provided by the Internet2 project do not have a ground
truth ﬁle, we are not capable of saying a priori if any anomaly is present in the
data. For this reason we have partially performed a manual veriﬁcation of the
data, analyzing the traces for which our system reveals the biggest anomalies.
Moreover we have synthetically added some anomalies in the data (mainly rep-
resentative of DoS and DDoS attacks), so as to be able to correctly interpret the
oﬀered results, at least partially. The performance analysis has highlighted that
the implemented system obtains very good results, detecting all the synthetic
anomalies.
References
1. Lakhina, A., Crovella, M., Diot, C.: Characterization of network-wide anomalies in
traﬃc ﬂows. In: ACM Internet Measurement Conference, pp. 201–206 (2004)
2. Lakhina, A.: Diagnosing network-wide traﬃc anomalies. In: ACM SIGCOMM, pp.
219–230 (2004)
3. The Internet2 Network, http://www.internet2.edu/network/