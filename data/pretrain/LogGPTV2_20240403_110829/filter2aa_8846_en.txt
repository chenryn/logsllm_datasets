报告对外发布的对象是由数据所有者决定的。
G.5 恢复 Recovery
调查人员从一个系统收集所有适当的证据后，下一步是恢复系统，或将其恢复到一个完全
正常的状态。这个工作量根据事件的影响程度可大可小。不过要考虑病毒、木马等是不是没清
干净，要不要彻底的重建系统？
G.6 补救 Remediation
亡羊补牢。在修复阶段（这不是恢复业务的阶段了），人员观察事件并确定什么原因导致
它发生，然后实施措施以防止它再次发生。最简单的就是打补丁，最重要的是根本原因分析。
根本原因分析(RCA)/问题管理 Problem management
从根本上说，根本原因分析(RCA)是问“为什么?”，直到有一个答案。RCA 涉及审查系统
日志，政策，程序，文档的安全性和捕获网络流量，可以先将小事件拼凑一起以推演出导致的
历史事件。一旦该事件被理解，RCA 团队可以反向工作，以确定哪些是允许发生的事件。逆向
工作将涉及与事件管理人员和调查人员合作的能力，确保所有相关信息正在被收集，记录和管
理，根据组织的事件程序处理，而且监管链是严格保持收集的所有证据。
G.7 汲取经验教训 Lessons Learned
最后是教训总结。事件响应小组将参与这个阶段，但是其它了解该事件的员工也将参与。
分析事件的处置流程，总结管理上、技术上、培训上的改进建议。当完成经验教训审查后，通
常需要事件响应团队编写一个报告。最烦就是写事件分析报告了。或许，事件响应的最重要的
部分是总结经验。组织有机会来分析和理解失败，并尝试以确保它不会再次发生。
—201—
这里又要讲一堆的攻击了，都不知道重复多少遍了，再罗列一下：
1.拒绝式服务攻击 Denial-of-Service Attacks
拒绝服务(DoS)攻击能够阻止系统处理或响应来自资源和客体的合法数据或请求。拒绝服
务攻击的最常见形式是向服务器传输使其无法全部处理的过多数据包，或让系统崩溃或 100%
的 CPU 使用率。另一种形式的 DoS 攻击是一种分布式拒绝服务(DDoS)攻击。还有一种变体的
DoS 形式被称为分布式反射拒绝服务(DRDoS) distributed reflective denial-of-service，
域名服务(DNS)投毒攻击和 smurf 攻击就是这样的例子。
2.SYN 泛洪攻击 SYN Flood Attack（让你回不停）
SYN 泛洪攻击是一种常见的 DoS 攻击。它通过破坏 TCP/IP 启动通信会话的三步握手标准
来实施攻击。通常，客户端向服务器发出 SYN (同步) 数据包，服务器向客户端发送 SYN/ACK (同
步/应答)响应数据包，随后客户端向服务器回应 ACK (应答)数据包。这样三步握手建立起了
两个系统间的一个用于数据传输的会话，这个会话直到出现 FIN (结束)或 RST (重置)包才会
断开。然而，在一个同步字符(SYN)洪水式攻击发生时，攻击者发送成千上万个 SYN 包但不回
复响应。这类似于一个喜欢开玩笑的人伸出手去握手，但是当其他人做出回应，伸出手准备握
手时，他却将手缩了回来，留下对方的手悬在半空中。
使用 SYN Cookies 是阻断这攻击的一种方法。这些小记录消耗小部分系统资源，当系统
接收到 ACK 应答肘，它检查 SYN Cookie 并建立会话。防火墙通常能够通过入侵检测和入侵防
御系统检测 SYN 攻击。阻断这种攻击的另一种方法是降低 TCP 重置攻击服务器通常会等待一
段时间以接收 ACK 应答。默认时间是三分钟，但在正常操作中合法系统发送 ACK 应答并不需
要这么长的时间。通过减少时间，半开的会话在系统内存中的刷新会更快。
3.TCP 重置攻击 TCP Reset Attack（让你连不上）
另一种通过操纵TCP 会话的攻击方式叫做TCP 重置攻击，会话通常是FIN(完成)或RST(复
位)包。攻击者可以在一个 RST 包中伪造源 IP 地址并断开会话活动。两个系统之间则需要重
新建立会话。这对系统来说是一个很大的威胁，两系统之间需要持续的会话，以保持数据。当
会话重建时，系统就需要重建数据，所以这不仅仅只是来回发送三个数据包以建立会话的问题。
4.Smurf 和 Fraggle 攻击（前者反弹、后者 UDP）
Srnurf（欺骗）和 Fraggle（磁片）攻击都属于 DoS 攻击。Smurf 攻击是另一种类型的洪
水式攻击，但它使用 Internet 控制消息协议(ICMP) 回送数据包而不是 TCP SYN 包攻击其他
系统。更具体地说，它是一个使用受害者的 IP 地址作为源 IP 地址的伪造广播 ping，让全网
都响应并回送数据包至受害 IP。在 1999 年发行的 RFC 2644 改变了路由器的标准，路由器不
能转发定向广播，网络便不能被放大。这给 Smurf 攻击单一的网络带来了限制。此外，在防
火墙上禁用 ICMP 能够防止利用 ICMP 的任何类型的攻击。现在 Smurf 攻击己经很少见了。
Fraggle 攻击类似于 Smurf 攻击。然而，Fraggle 攻击使用 UDP 端口 7 和 19 而不是 ICMP。
Fraggle 攻击能够使用伪造 IP 地址将一个 UDP 数据包发送给受害者。所有的系统就都会将其
转发给受害者，这类似于 Smurf 攻击。
SMURF 是反弹攻击，消耗带宽（ICMP）；FRAGGLE 消耗性能（UDP）。
5.Ping 洪水攻击（呼死你）
Ping 洪水攻击，通过给受害者发送洪水般的请求来达到攻击目的，在 DDOS 攻击中给僵尸
—202—
网络发送僵尸信息的效果很明显。如果成千上万的系统同时给一个系统发送 ping 请求，该系
统将在试图回答 plng 请求时发生混乱。
6.僵尸网络 Botnets
今天僵尸网络相当普遍。僵尸网络中的计算机就像机器人(通常称为僵尸 zombies，也叫
肉机)，并将会按照攻击者的要求执行命令。僵尸牧人 bot herder 通常是指通过一个或多个命
令控制所有计算机和服务器的罪犯。
7.死亡之 Ping/Ping of Death（PING 大包）
一个 ping 死亡攻击采用了一个超大的 ping 数据包，即超过 64 字节，甚至大到 64KB。
当系统收到 ping 包大于 64 KB 时，就会出现问题。现今死亡 PING 攻击很少能够成功，因为补
丁和更新改善了系统的脆弱性。
8.泪滴攻击 Teardrop（拼不完整）
在泪滴攻击中，攻击者阻碍交通，系统无法将数据包一起发回。大数据包通常被分成较小
的碎片，当它们被发送到网络上时，接收系统把数据包碎片还原到原来的状态。然而，泪滴以
一种系统不能将文件还原在一起的方式分割数据包。旧的系统无法处理这种情况，并会崩溃，
但补丁解决了这个问题。此外，入侵检测系统可以检查畸形数据包。
7.Land 攻击（自己搞自己）
Land 攻击是指攻击者使用受害者的 IP 地址作为源 IP 地址和目的 IP 地址，并发送伪造
的 SYN 包给受害者。这使系统不断地对自己做出应答，并最终可能会冻结，崩溃或重新启动。
这种攻击在 1997 被第一次发现，它又几次攻击不同的端口。保持一个系统更新并使用过滤流
量检测相同的源和目的地地址，有助于防止 Land 攻击的发生。
8.零日攻击 Zero-day Exploit
零日漏洞是指利用他人未知的系统漏洞对系统发起攻击，也指无法修补的漏洞。
9.恶意代码 Malicious Code
恶意代码是指在计算机系统上执行不必要的、未经授权的或未知活动的脚本或程序。恶意
代码可以采取多种形式，包括病毒，蠕虫，木马，具有破坏性宏的文件，和逻辑炸弹。它通常
被称为恶意软件，或恶意代码。恶意代码存在于每一种类型的计算机或计算设备，是现今最常
见的安全漏洞。
10.中间人攻击 Man-in-the-Middle Attacks
当一个恶意用户能够在一个正在进行的通信的两个端点之间的逻辑上获得一个位置时，
一个中间人攻击就会产生。中间人攻击有两种。一个涉及复制或刺探双方通信，这基本上算是
嗅探器攻击；另一种类型是攻击者在通信线上定位自己，他们将其作为一个存储和转发或代理
机制，客户端和服务器认为它们是直接连接的。攻击者可以收集登录凭据和其他敏感数据，以
及改变两个系统之间交换的消息内容。
中间人攻击比其他许多攻击需要更多技术性，因为从客户角度出发，攻击者需要冒充服务
器，从服务器的角度来看，还要模拟客户端。中间人攻击往往需要一个组合的多个攻击。例如
攻击者可能会改变路由信息和 DNS 的值，或伪造地址解析协议(ARP)查找。
11.战争拨号 War Dialing
使用调制解调器搜索接受入站连接尝试的系统的行为，就是大量拨号。一旦检测到某个计
—203—
算机载波音，战争拨号器就会在搜索过程结束时所生成的报告中添加相应的电话号码。一种新
的战争拨号的形式能够在不适用调制解调器的情况下，使用语音互联网协议(VoIP)拨号，这使
得攻击者能够扫描到更多的电话号码，并发现除了调制解调器以外的其他设备，如传真机、语
音信箱、拨号音和人类的声音。
抵御恶意战争拨号攻击的对策包括：实施强大的远程访问安全性(主要依靠强的身份验
证)，确保不存在未授权的调制解调器，以及使用回叫安全机制、协议约束与呼叫登入。
12.破坏 Sabotage
员工破坏指的是员工对单位的破坏行为。员工被解雇后必须立即终止或禁用其账户，预防
员工破坏的其他保障措施还存定期审计、监测异常或未经授权的活动，保持员工和管理人员之
间的沟通开放，并适当奖励员工。
13.间谍 Espionage
间谍活动是一种收集专有的、秘密的、私人的、敏感的或机密信息的恶意行为。
H.操作和维护预防措施
H.1 防火墙
第四域 B.3 章节已经详细讲过防火墙了。这里不讲了。
H.2 入侵检测和预防系统
入侵检测系统(IDS) intrusion detection system 通过自动检测日志和实时系统事件以
检测入侵和系统故障。入侵防御系统(IPS) intrusion prevention system 具有入侵检测系统
的所有功能，而且还可以采取额外的措施来阻止或防止入侵。入侵防御系统( IPS)不是旁路接
的，是串接在网络的，能够在攻击到达目标系统之前进行检测并阻止攻击。
IDS 的三大基本组件是（采集、分析、告警）：
①传感器/探测器（Sensor），也被称为探针，或代理（Agent），采集数据流量。
②分析器/控制与通讯（Analyzer），收集信息，通过分析确定是否有攻击或滥用行为发
生征兆或先兆。
③发声器/用户界面（User Interface），管理员用来查看 IDS 收集的信息以及做出的判
断，对 IDS 进行配置和调整所使用的管理界面。
1.基于知识的和基于行为的检测 Knowledge- and Behavior-based Detection
IDS 通过监控网络流量和检查日志，来检查有无可疑活动。有 2 种常见方法来检测和识别
恶意行为：
①基于知识/模式匹配/特征分析（基于规则，经验式的检测）（Knowledge-Based/Pattern
matching/Signature-Based）。使用签名，又称基于模式匹配的检测或检测签名。它使用 1 个
关于己知攻击的特征的数据库，当模式匹配时，就被认为是一个攻击。它的缺点是，对未知的
攻击无能为力。在产品环境中发现的攻击或病毒称为“野生的(in the wild)”。已经存在但
尚未公布的攻击或病毒称为“动物园内的(in the zoo)”。（发现的是野生，未知的是园内）
此外，它还包括基于状态匹配（State-Based）的：将某些系统状态转变（State Transition）
视为遭受了攻击，以通信流为背景、并分析整个系统的行为，而不是单个数据包或分散的数据
报告。状态（State）是操作系统的值在可变的、临时的和永久内存位置上的一个快照。
—204—
②基于行为/统计异常（Behavior-based/Anomaly-based/ Statistical Anomaly）。不使
用签名，将活动同正常性能的基线进行对比，以检测异常行为。缺点是误报比较多。（基于统
计，启发式的检测）
其实比较清晰的分类是这样的：
①基于特征 Signature-based：
包括特征匹配（Pattern matching）和状态匹配（Stateful matching）。
②基于异常 Anomaly-based，也称为基于行为，或启发式：
包括统计异常（Statistical anomaly–based）、协议异常（Protocol anomaly–based）
和流量异常（Traffic anomaly–based）。
③基于规则 Rule-based（专家系统），一般把基于规则和基于特征都看成是基于知识的。
规则型 IDS 采用一种不同于特征型或统计异常型系统的检测方式。专家系统由知识库、推理引
擎和规则型编程组成。知识以规则表示，将要接受分析的数据则称为事实。系统的知识以规则
性编程(IF situation THEN action)编写。这些规则应用于事实、来自传感器的数据或者某个
被监控的系统。推理引擎负责为这个过程提供某些人工智能；通过使用推理规则，推理引擎可
以从提供的数据中推断出新的信息。
也就是说，在专家系统使用的规则型 IDS 中，IDS 从传感器或日志中收集数据，然后推理
引擎对这些数据应用预先编程的规则。如果发现与规则相符的特征，那么 IDS 就会发出报警戒
提供一个解决方案。
④基于神经网络（Aritificial Neural Network ANN）。专家系统的一种。
2 主机型和网络型的 IDS/ Host- and Network-based IDSs
根据信息来源进行分类，IDS 有 2 种：主机型与网络型。
①主机型 host-based IDS (HIDS)。监视单个计算机系统上的可疑活动，占用系统资源。
②网络型 network-based IDS (NIDS)。监视在网络上进行的可疑活动，对加密数据无效。
NIDS 很难检测交换网络(相对于传统的非交换环境)，因为在这种网络中，数据通过独立
的虚拟电路(PVC)传输，而不是像非交换环境那样通过广播传输。IDS 传感器是一个嗅探器，
它不能访问这些电路中的所有流量。因此，我们必须从每一个虚拟专用连接中提取所有的数据，
复制这些数据，并将数据副本传送到传感器所在的端口(生成端口)。这样，传感器就可以访问
进出交换网络的所有数据。
它们的区别和优缺点经常考，不过都很好理解，容易。
3.IDS 响应 IDS Response
当入侵检测系统检测到事件时，也有 2 种响应方式：主动响应和被动响应。在某些情况下，
可以在防火墙前后各放置一个被动的检测系统，以检查防火墙的有效性。通过检查两个 IDS 警
报，便能确定被防火墙阻挡的攻击类型而不是正在进行的攻击类型。
①被动响应 Passive Response。系统记录事件并发送一个通知。也就是各种形式的告警，
怎么处理看着办。
②主动响应 Active Response。系统通过改变环境来阻止活动而不是做记录和发通知。可
以使用几种不同的方法来修改环境，如修改 ACLs 以阻止基于端口、协议和源地址的流量输出，
甚至禁用某一条通信链路。使用积极响应方式的 IDS，通常被称为 IPS(入侵防御系统)。
—205—
4.黑暗网络/暗网/深网 Darknets