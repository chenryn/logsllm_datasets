editors 239 system, conducting 122-128
information gathering 238 target, pillaging 129-132
miscellaneous 239 tracks, covering 144-146
network utilities 239 user privileges, escalating on compromised
proxy 239 host 139
using 239 Windows UAC, bypassing 120-122
PowerShell
P about 126
cmdlets 127
packages 23
Powershell attack vectors 175
packet capture (pcap) files 67
PowerShell injection attack
Packetstorm security about 190
URL 94
launching 190
passive fingerprinting 77 using 191
patator 260
pre-shared key (PSK) 219
penetration tests
primary targets 92
managing 38-40
process injector 139
persistence, maintaining with Metasploit
proof of concept (POC) exercise 97
metsvc script, using 159-161
pwdump 139
persistence script, using 161-163
persistence script Q
about 161
using 162, 163 QRcode generator attack vector 175
persistent agents quilt
functions 149, 150 installing 267
Netcat, employing 155-158
using 155 R
persistent(stored), XSS vulnerabilities 292
phishing 176 Raspberry
configuring 200
phpmyadmin 324
physical access 197 Raspberry Pi 200
pilfering 129 Raspberry Pi attack vectors
about 200
pillaging 129
configuring 200
pop-under module mechanism 310
ports RDP
bidirectional port redirection 167 about 152
compromising 258-261
[ 332 ]
reconnaissance Sender Policy Framework (SPF) 50
about 43 server exploits 250
active reconnaissance 43 Service records(SRV) 50
basic principles 44, 45 SEToolkit
OSINT 45 about 172, 175
passive reconnaissance 43 advantages 172
reconnaissance, of websites attacks 174
conducting 230-235 launching 172-174
Recon-ng shared folders 28, 29
about 82, 83 shikata_ga_nai protocol 164
using 83-85 shutter 36
redirect command 298 simple port redirection 166
reflected vulnerabilities. See non-persistent Skipfish 240
XSS vulnerabilities SMS spoofing attack vector 175
remote access applications sniffer 194
exploiting 264, 265 social engineering 171
Remote Administration Tool Tommy social engineering attacks
Edition (RATTE) 175 Arduino-based attack vector 175
Remote Desktop Protocol. See RDP create payload and listener module 175
Remote host (RHOST) 102 escalating, DNS redirection used 194-197
Remote port (RPORT) 102 hostile physical access 198
repositories 23 infectious media generator 175
rootkit 149 key factors 171
root password MassMailer Attack 175
resetting 26 physical access 197
RunAs attack Powershell attack vectors 175
disadvantages 121 QRcode generator attack vector 175
launching 121 SMS spoofing attack vector 175
spear-phishing attack vector 174
S third party modules 175
website attack vectors 174
SAM database 129 wireless access point attack vector 175
same-origin policy 291 Social-Engineer Toolkit. See SEToolkit
scrub 36 spear phishing attack
secondary targets 92 about 176
Secunia launching 176
URL 94 performing 177-181
Secure Shell (SSH) protocol spear-phishing attack vector 174
about 21 SQL injection attack
compromising 262, 263 against, Mutillidae database 252
Secure Sockets Layer. See SSL sqlmap 252
security SSL 266
testing, with client-side proxies 243-249 SSL, attacking
Security Accounts Manager Kali, configuring for SSLv2
database. See SAM database scanning 267, 268
SecurityFocus reconnaissance phase, of SSL
URL 94 connections 269-274
[ 333 ]
service attacks denial against SSL 277, 278 Microsoft operating systems, testing 322
sslstrip, used for conducting setting up 321
man-in-the-middle attack 275, 277 third-party Windows applications,
sslcaudit tool 271 testing 322
sslscan tool 271 Unix applications, testing 322
sslsniff tool 271 Unix operating system installations,
sslsplit tool 272 testing 322
sslstrip tool theharvester tool
about 272 about 58
used, for conducting using 58, 59
man-in-the-middle attack 275-277 third-party applications
SSLyze 278 installing 35, 37
sslyze python tool 273 managing 35
sslyze tool 272 running as, with non-root privileges 37, 38
standalone persistent agent third-party Windows applications
creating, Metasploit used 163-165 testing 322
stealth scanning strategies, threat modeling 92, 93
active reconnaissance time to live (TTL) field 54
about 66 TLS 266
packet parameters, modifying 68, 69 tlssled tool 272
proxies, using with anonymity Tor
networks 69-72 about 69
source IP stack and tool identification considerations 73
settings, adjusting 66, 67 installing 70, 71
strong ciphers 269 URL 69
using, with Privoxy 70
T traceroute 74
Transport Layer Security. See TLS
Tabnabbing Attack Method
Trivial File Transfer Protocol (TFTP) 156
about 174
TrueCrypt
launching 188
used, for creating encrypted folder 30-35
using 188
TSSLed 278
targets
TWiki 324
pillaging 129-132
primary targets 92 U
secondary targets 92
tertiary targets 92 Unix applications
TCP/IP Swiss army knife 155 testing 322
team testing Unix operating system installations
Armitage, used 107, 108 testing 322
team viewer 36 updating, Kali Linux
Telnet service Debian package management system 23
enabling, remotely 150-152 user information
terminator 36 document metadata, collecting 59-61
tertiary targets 92 e-mail address, collecting 58
test environment names, collecting 58
complex environments 323 obtaining 57
[ 334 ]
user privileges vulnerability scanning
escalating, on compromised host 139 about 88
users limitations 88
profiling, for password lists 61, 62 vulnerable application
exploring 103, 104
V vulnerable web-based apps
Foundstone 325
VBScript Hackxor 325
about 286
LAMPSecurity 325
used, for launching attacks 286-289
OWASP Broken Web Applications
Vega 240 Project 326
Veil-Evasion WebGoat 326
about 112, 113
Web Security Dojo 326
features 111
VulnHub repository
Vendor ID (VID) 281 URL 323
vertical escalation 139
VulnVoIP 323
virtual machine (VM)
VulnVPN 283, 323
about 16
vulscan script
Kali Linux, installing 315, 316
URL 81
Virtual Network Computing
enabling, remotely 154 W
VirusTotal
URL 165 w3af 240
Visual Basic Scripting Edition. See VBScript Wapiti 241
VPN war dialing attack 48
about 278 WCE
IPSec 278 about 142
SSL 278 using 142
vulnerability scanners weak ciphers 269
about 236 Web Application Attack and Audit
Arachnid 240 Framework. See w3af
for web services 236 web backdoors
functionality of traditional vulnerability used, for maintaining access 254-256
scanners, extending 237, 238 web-based applications
functionality of web browsers, Mutillidae 324
extending 238 phpmyadmin 324
GoLismero 240 testing 324
Nikto 240 TWiki 324
Skipfish 240 webdav 324
Vega 240 webcam_capture command 298
w3af 240 webdav (Web-based Distributed Authoring
Wapiti 241 and Versioning) 324
Webscarab 241 WebGoat 326
web service-specific vulnerability Web Jacking Attack Method 174
scanners 240 Webscarab 241
Webshag 241 Web Security Dojo 326
Websploit 241 web service-specific vulnerability
web vulnerability scanners 236 scanners 240
[ 335 ]
Webshag 241 wkhtmltoimage tool 82
website attack vectors WPA and WPA2
about 174 about 219
Credential Harvester Attack Method 174 attacking 219
Java Applet Attack Method 174 brute-force attacks 219-223
Metasploit Browser Exploit Method 174 wireless routers, attacking with Reaver 223
Multi-Attack Web Method 175
Tabnabbing Attack Method 174 X
Web Jacking Attack Method 174
Websploit 241 x.509 certificate 269
web vulnerability scanners 236 XSS 291
Weevely XSSF logs page 295
about 254 XSS framework
creating 255 about 292
installing 293
WEP encryption
compromising 213-219 XSSF test page 295
WHOIS 48, 49 XSSF Tunnel function
about 292
WiFi Protected Access 2 (WPA2) 219
using 293
WiFi Protected Access (WPA) 213, 219
Wi-Fi Protected Setup (WPS) protocol 223 XSSF Tunnel Proxy 295
Windows Management Instrumentation XSS vulnerabilities
about 291
Command-line (WMIC) 125
non-persistent 291
Windows PowerShell
about 289 persistent 291
used, for launching attacks 290, 291
Y
Windows Terminal Services
enabling, remotely 152, 153
Yandex
Windows UAC
URL 46
bypassing 120, 121
settings 120
Z
wireless access point attack vector 175
wireless communications zombie 299
access point, cloning 224
DoS attacks 225
exploiting 203
Kali, configuring for wireless attacks 204
MAC address authentication,
bypassing 211-213
WEP encryption, compromising 213-218
wireless reconnaissance 204
WPA and WPA2, attacking 219
Wireless Equivalent Privacy (WEP) 213
wireless reconnaissance
about 204-207
Kismet 207
Wireshark 128
[ 336 ]
uploaded by [stormrg]
Thank you for buying
Mastering Kali Linux for Advanced Penetration Testing
About Packt Publishing
Packt, pronounced 'packed', published its first book "Mastering phpMyAdmin for Effective
MySQL Management" in April 2004 and subsequently continued to specialize in publishing
highly focused books on specific technologies and solutions.
Our books and publications share the experiences of your fellow IT professionals in adapting
and customizing today's systems, applications, and frameworks. Our solution based books
give you the knowledge and power to customize the software and technologies you're using
to get the job done. Packt books are more specific and less general than the IT books you have
seen in the past. Our unique business model allows us to bring you more focused information,
giving you more of what you need to know, and less of what you don't.
Packt is a modern, yet unique publishing company, which focuses on producing quality,
cutting-edge books for communities of developers, administrators, and newbies alike.
For more information, please visit our website: www.packtpub.com.
About Packt Open Source
In 2010, Packt launched two new brands, Packt Open Source and Packt Enterprise, in order to
continue its focus on specialization. This book is part of the Packt Open Source brand, home
to books published on software built around Open Source licenses, and offering information
to anybody from advanced developers to budding web designers. The Open Source brand
also runs Packt's Open Source Royalty Scheme, by which Packt gives a royalty to each Open
Source project about whose software a book is sold.
Writing for Packt
We welcome all inquiries from people who are interested in authoring. Book proposals should
be sent to author@packtpub.com. If your book idea is still at an early stage and you would like
to discuss it first before writing a formal book proposal, contact us; one of our commissioning
editors will get in touch with you.
We're not just looking for published authors; if you have strong technical skills but no writing
experience, our experienced editors can help you develop a writing career, or simply get some
additional reward for your expertise.
Web Penetration Testing with
Kali Linux
ISBN: 978-1-78216-316-9 Paperback: 342 pages
A practical guide to implementing penetration
testing strategies on websites, web applications,
and standard web protocols with Kali Linux
1. Learn key reconnaissance concepts needed
as a penetration tester.
2. Attack and exploit key features, authentication,
and sessions on web applications.
3. Learn how to protect systems, write reports,
and sell web penetration testing services.
Kali Linux Cookbook
ISBN: 978-1-78328-959-2 Paperback: 260 pages
Over 70 recipes to help you master Kali Linux for
effective penetration security testing
1. Recipes designed to educate you extensively
on penetration testing principles and Kali
Linux tools.
2. Learning to use Kali Linux tools, such as
Metasploit, Wireshark, and many more
through in-depth and structured instructions.
3. Teaching you in an easy-to-follow style, full of
examples, illustrations, and tips that will suit
experts and novices alike.
Please check www.PacktPub.com for information on our titles
Kali Linux Social Engineering
ISBN: 978-1-78328-327-9 Paperback: 84 pages
Effectively perform efficient and organized social
engineering tests and penetration testing using
Kali Linux
1. Learn about various attacks, and tips and
tricks to avoid them.
2. Get a grip on efficient ways to perform
penetration testing.
3. Use advanced techniques to bypass security
controls and remain hidden while performing
social engineering testing.
Learning Nessus for Penetration
Testing
ISBN: 978-1-78355-099-9 Paperback: 116 pages
Master how to perform IT infrastructure security
vulnerability assessments using Nessus with tips
and insights from real-world challenges faced
during vulnerability assessment
1. Understand the basics of vulnerability
assessment and penetration testing as
well as the different types of testing.
2. Successfully install Nessus and configure
scanning options.
3. Learn useful tips based on real-world issues
faced during scanning.
Please check www.PacktPub.com for information on our titles