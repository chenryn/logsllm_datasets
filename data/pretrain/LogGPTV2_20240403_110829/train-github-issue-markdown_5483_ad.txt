This code functioned well for slightly smaller datasets, but it may not be suitable for the current data size.