THis code worked for slightly smaller datasets but maybe the data is