### Table V: DGA e2LD in the DGArchive Resolved in Malware Executions

This observation is also evident in Table VI, which shows the ratio of MX lookups per malware sample. With the exception of Sality, the top 25 malware families queried at least 40 MX records. Given that most of the malware we studied contacted fewer than 10 domains, this characteristic is particularly noteworthy.

### Figure 10: Number of MX Lookups and Mail-Related DNS Queries for Spam-Related Malware Samples

Figure 10 illustrates the number of MX lookups and mail-related DNS queries for each potentially spam-related malware sample. A significant peak is observed around 100 domains. By associating 5,239 samples with this spike, we obtained VirusTotal reports for 909 (17.4%) of these samples; 892 (98.1%) were instances of Mydoom [77] malwareâ€”a computer worm first detected in January 2004 and used by email spammers to send mail from infected hosts. As noted in Section II, our earliest malware feeds start in January 2011, seven years after the first sighting of Mydoom. Despite being known for over a decade, we still observed active Mydoom variants in our dataset as recently as August 2015. The longevity of this particular malware family suggests that even older malware remains effective for spam-related activities.

### Cumulative Distribution Function (CDF) for NXDomains

Figure 9 presents the cumulative distribution function (CDF) for the number of NXDomains seen in malware samples in our dataset. This indicates a lack of pressure from defenders, allowing the family to continue using the same domain. In contrast, for other families like Gameover, approximately 30% of the queried domains resolved to a registered IP address.

### Unobserved DGA Families in the DGArchive

The 24 DGA families in the DGArchive that we did not observe are likely due to two reasons:
1. Some malware use DGA as a backup communication strategy, only activated if primary C&C domains fail. This may not occur during the brief execution time in the sandbox.
2. For some malware, such as TDSS/TDL4, DGA is used in specific components, such as monetization through ad abuse. Thus, we may not see DGA domains in our traces because the malware samples have not run long enough to be monetized.

### Candidate DGA Families

In our dataset, we also identified five candidate DGA families (fosniw, shiz, softpulse, upatre, wapomi) that perform large numbers of NXDomain queries and have random-looking domains.

## VIII. SPAM-RELATED MALWARE

A common method to monetize malware is through distributed mechanisms for sending spam. As discussed in Section III, we excluded spam-related malware from our analysis because it was outside the scope of this work, and we did not want to influence our results with typical spam behavior. Since there is already extensive research on spam, we provide the following discussion to offer more insight into the spam-related samples we excluded.

### Identification of Spam-Related Malware

Before filtering, we identified several malware samples in our dataset that appeared to be involved in spam behavior. We compiled a set of domains used as MX records or associated with mail-related activity, resulting in a collection of 405,742 malware samples that contacted these domains. These samples are potentially involved in spamming activities. As shown in Figure 10, these samples contacted hundreds to thousands of unique domains.

## IX. RELATED WORK

### A. Malware Infrastructure

Several studies have examined the malicious infrastructure used to distribute malware. For example, Rossow et al. [64] performed a large-scale analysis of malware downloaders and their network infrastructure. They found that 20% of the C&C servers remain operable long-term, with 2,942 C&C domains resolving to 861 IP addresses hosted in various ASs. Malware infrastructures regularly migrate among different domains while maintaining a redundant presence across multiple providers.

### B. PUP Infrastructure

Recent work has studied the prevalence of Potentially Unwanted Programs (PUPs), their distribution through pay-per-install (PPI) services, and their detection. Thomas et al. [72] showed that ad-injectors affect 5% of unique daily IP addresses accessing Google. Kwon et al. [40, 41] detect PUP and malware distribution using graph-based approaches and machine learning. While some studies explore PUP-related domains, none analyze the properties of the PUP domain and server infrastructure. Our work is the first to analyze the properties of the PUP domain and server infrastructure.

### C. Longitudinal Malware Studies

While our study focuses on the network infrastructure, other researchers have investigated the behavior extracted from dynamic analysis sandboxes. Bayer et al. [23] reported that only 47.3% of the samples showing network activity performed a DNS query, which succeeded in over 90% of cases. Lindorfer et al. [44] found that 99.91% of Android malware performed DNS queries, with about one-third failing to resolve, suggesting an increasing adoption of DGAs. Our experiments confirm the widespread use of DGAs, with up to two-thirds (67%) of fully qualified domain names queried by malware failing to resolve to a valid address.

### D. Internet Reputation

Network-level analysis of malicious behavior offers a complementary means of characterizing and mitigating malware. IP blacklists provide a list of known bad actors, but the use of DNS to build malicious network infrastructure has grown due to its resilience against IP blacklisting. Consequently, significant work has focused on analyzing network abuse at the DNS level, leading to the creation of systems to detect and mitigate such abuse.