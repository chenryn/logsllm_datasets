title:Scanning the Scanners: Sensing the Internet from a Massively Distributed
Network Telescope
author:Philipp Richter and
Arthur W. Berger
Scanning the Scanners: Sensing the Internet from a Massively
Distributed Network Telescope
Philipp Richter
MIT / Akamai
PI:EMAIL
Arthur Berger
Akamai / MIT
PI:EMAIL
ABSTRACT
Scanning of hosts on the Internet to identify vulnerable devices
and services is a key component in many of today’s cyberattacks.
Tracking this scanning activity, in turn, provides an excellent signal
to assess the current state-of-affairs for many vulnerabilities and
their exploitation. So far, studies tracking scanning activity have re-
lied on unsolicited traffic captured in darknets, focusing on random
scans of the address space. In this work, we track scanning activity
through the lens of unsolicited traffic captured at the firewalls of
some 89,000 hosts of a major Content Distribution Network (CDN).
Our vantage point has two distinguishing features compared to
darknets: (i) it is distributed across some 1,300 networks, and (ii) its
servers are live, offering services and thus emitting traffic. While
all servers receive a baseline level of probing from Internet-wide
scans, i.e., scans targeting random subsets of or the entire IPv4
space, we show that some 30% of all logged scan traffic is the re-
sult of localized scans. We find that localized scanning campaigns
often target narrow regions in the address space, and that their
characteristics in terms of target selection strategy and scanned
services differ vastly from the more widely known Internet-wide
scans. Our observations imply that conventional darknets can only
partially illuminate scanning activity, and may severely underesti-
mate widespread attempts to scan and exploit individual services in
specific prefixes or networks. Our methods can be adapted for indi-
vidual network operators to assess if they are subjected to targeted
scanning activity.
CCS CONCEPTS
• Networks → Network measurement; Network security;
KEYWORDS
Internet scanning, Internet security, network telescope, unsolicited
traffic.
ACM Reference Format:
Philipp Richter and Arthur Berger. 2019. Scanning the Scanners: Sensing
the Internet from a Massively Distributed Network Telescope. In Internet
Measurement Conference (IMC ’19), October 21–23, 2019, Amsterdam, Nether-
lands. ACM, New York, NY, USA, Article 4, 14 pages. https://doi.org/10.1145/
3355369.3355595
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
© 2019 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-6948-0/19/10...$15.00
https://doi.org/10.1145/3355369.3355595
144
1 INTRODUCTION
Scanning of hosts on the Internet for vulnerable services is a key
component for cyberattacks ranging from exploitation of end de-
vices or servers up to massive botnets capable of carrying out
DDoS attacks exceeding several Tbps. Given that scanning is a
key component in many attack vectors, tracking scanning activity
can illuminate the current status of botnets (e.g, Mirai), can show
which vulnerabilities are targeted, who originates scanning traffic,
and which networks are particularly targeted by scanners. More
generally, scanning activity provides us with an excellent signal
for the current state-of-affairs for many vulnerabilities and their
exploitation. As such, scanning activity might well be suitable to
indicate potential future cyberattacks.
While the existence of widespread port scanning activity is
widely known [7, 8, 10, 18], comparably little research has been
devoted to study and understand scanners and their strategies in de-
tail. The lack of high quality data stems mostly from the absence of
data sources that can illuminate scanning activity at scale. The few
recent studies on scanning base their analysis on traffic arriving at
darknets: a portion of routed address space, such as a /8 IPv4 prefix
or subsets thereof, that does not emit any traffic, and only records
incoming packets. Darknets face two fundamental shortcomings:
Firstly, they are isolated within the address space, often announced
by universities or research networks. Secondly, since darknets do
not emit any traffic, their only attraction of traffic is their routed
address space. Thus, darknets will only be able to detect scanning
activity that targets either the entire IPv4 space, a sufficiently large
random subset, or the unlikely case of scans targeting the darknet
itself [10, 18]. They cannot provide insights into scans targeting
specific regions of the address space, e.g., prefixes or networks with
known clients, servers or other types of “live” hosts. Scans targeting
individual networks, however, could indicate the intent of attackers
to exploit or attack those particular networks, posing a potentially
much greater risk to those networks than a random scan of the
entire IPv4 space.
In this work, we leverage a unique dataset that allows us to over-
come the limitations of network telescopes based on darknets, and
to illuminate the prevalence, and individual strategies of Internet
scanning that have not previously been documented. Our telescope
is based on the logs of unsolicited packets blocked at the firewalls
of servers of a major CDN, which are distributed over more than
1,300 networks, and are live, in the sense of offering services to end
users and thus emitting traffic.
Our key contributions and findings are as follows:
• We provide a detailed study of our distributed vantage point,
89,000 CDN servers, its suitability as a network telescope, and
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Richter and Berger
the unsolicited traffic logged. We find that all CDN servers re-
ceive a consistent baseline number of unsolicited packets, base-
line radiation, but also show evidence of local concentrations
of unsolicited traffic. We quantify the additional unsolicited
traffic attracted due to exposure of CDN IP addresses in forward
DNS responses, and develop tools to isolate scanning activity
from other traffic components. We find that some 87% of logged
traffic is the result of scanning activity.
• We develop tools and metrics to categorize scans into individ-
ual scanning strategies. While Internet-wide scans of the full
IPv4 space and of random subsets thereof are the majority of
overall scan traffic, we find that localized scanning campaigns
constitute some 30% of scan traffic, in terms of number of scans,
number of packets in scans, and number of sources initiating
the scans. We find that localized scans often target addresses
in narrow areas of the address space (e.g., only a small number
of routed prefixes), and that these scans show significantly dif-
ferent characteristics when compared to more widely-known
Internet-wide scans both in terms of services targeted, repeated
stateful scanning behavior, as well as scanner origins. Many of
these characteristics only become visible after isolating these
localized events, since the volume of Internet-wide scanning
campaigns can easily mask characteristics of localized scans.
• We compare our visibility against a /8 darknet and leverage
our ability to classify individual scans to separate background
radiation into baseline scanning and targeted scanning. We show
that IP addresses of darknets receive baseline scanning activity,
but little in terms of targeted scanning, in stark contrast to the
IP addresses of our distributed telescope. We find a three-fold
increase in baseline radiation over the last 3 years.
To the best of our knowledge, our work is the first to document
widespread localized scanning activity in today’s Internet. Our find-
ings have relevance for the research community, as we show that
darknets, and derived statistics and inferences, are biased towards
Internet-wide scans and might underestimate exploitation attempts
of specific services in specific areas of the address space. As our
classification methods can be adapted to individual networks, our
findings are of practical use for network operators who want to
determine if their hosts and infrastructure are subjected to targeted
scans. The remainder of this paper is organized as follows: We
review related work in § 2 and introduce our vantage point and
dataset in § 3. We scrutinize background radiation logged in our
dataset and introduce our scan detection mechanism in § 4. We
study target-selection strategies of our identified scans in § 5 and
drill into further properties of scans in § 6. We compare the visibil-
ity of scans in the broader Internet in § 7 and conclude with our
implications and future work in § 8.
2 RELATED WORK
Scanning the address space is a key element leveraged by many
botnets and worms [8, 23, 31]. While key for malicious actors, scan-
ning the IPv4 space also became more relevant for measurement
studies finding vulnerable host populations, patching strategies,
address activity, (e.g., [17, 19, 20, 24]), fueled by the arrival of tools
enabling fast scanning of large parts of the IPv4 space in short time
periods [6, 21]. Unsolicited traffic received in darknets, Internet
Background Radiation, has been widely used to study spread and ac-
tivity of botnets or exploitation attempts of vulnerabilities [8, 12, 16].
Other works studied both general characteristics of Background
Radiation and how they can be used for network analysis, inference,
and debugging [10, 13–15, 22, 28, 32, 33].
To the best of our knowledge, only one recent work presents
broad and detailed characteristics of widespread scanning behavior
in the Internet [18]. Using a darknet telescope, the authors focus
solely on Internet-wide scans, i.e., scans that probe a random subset,
or the entirety, of the IPv4 space. In this context, they make the
inference that if a source probes a given percentage of the addresses
of the darknet, then that source is likely probing that percentage
of addresses of the public IPv4 address space. Benson et al. [10]
studied scan visibility in two darknets: one is the same as in [18]
and the other darknet is another, different /8 prefix. One of their
findings is that scan traffic arrives with equal probability in the
two different (appropriately scaled) darknets, which is a negative
indication of localized scanning at the level of these two vantage
points. Our work complements and extends previous work. We find
widespread evidence of localized scanning activity and illuminate
a more complex picture of scanning activity in today’s Internet.
3 A DISTRIBUTED NETWORK TELESCOPE
In this section, we introduce our vantage point, relevant properties
of our data collection mechanism, and a first-order characterization
of the traffic arriving at our telescope.
3.1 Data Collection & Sampling
We base this work on logs of unsolicited packets collected at the
firewall of a subset of the servers operated by a major Content
Distribution Network.1 The subset we examine consists of 89,000
servers, and where each server has two publicly facing IPv4 ad-
dresses, and both addresses are in the same /24 address block.2
Although this set of 178,000 addresses is small relative to a darknet
of, say, a /8 IPv4 prefix of 16.8 million addresses, these 178,000 ad-
dresses are located in 2,800 routed BGP prefixes originated by 1,347
Autonomous Systems in 156 countries, spread across 172 different
/8 prefixes.
Client-facing and operations IP address: Of the two public IPv4
addresses on each server, in the same /24 prefix, only one is ever
returned in forward DNS queries for domain names hosted by the
CDN (when clients access content hosted on the CDN). Herein, we
call this address the client-facing IP, and the other address we call
the operations IP. The operations IP is used solely for CDN-internal
communication [29]. The distinction between these two addresses
that is relevant for this study is that the operations IP is never
exposed in replies to forward DNS queries. Both addresses respond
to ICMP pings, and both have PTR records set in the DNS. Each CDN
machine runs services on some port numbers (most prominently
port 80/443 for HTTP(S), and several services using non-standard
port numbers for internal communication and customer services).
All traffic not destined to any of the ports running an active service
is dropped by a firewall, and, as described in the next paragraph, a
1For more information on the spread and visibility of the CDN, we refer to [30].
2The servers also have IPv6 connectivity, but the unsolicited traffic over IPv6 is a tiny
fraction of the total, and we do not report on it.
145
Scanning the Scanners
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
(a) Number of packets logged per 10 second - ma-
chine bin. Less than 0.1% of 10-second bins logged
more than 20 packets.
(b) Daily packets logged per machine. Lines
show median, box shows 25th and 75th percentile,
whiskers show 5th and 95th percentile of machines.
Each machine has two public IPv4 addresses.
(c) Inbound packets blocked by networks hosting
the telescope machines and percentage of telescope
machines in these ASes. Up to 10% of networks filter
specific ports on their ingress, yet the effect on our
data collection remains small.
Figure 1: Statistics on packets received per machine.
total
UDP
pkts
2.3B
bytes