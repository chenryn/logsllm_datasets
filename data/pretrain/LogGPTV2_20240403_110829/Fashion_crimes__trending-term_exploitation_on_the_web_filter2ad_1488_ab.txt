### 优化后的文本

#### 5. 网站分类
- **叠加广告的网站**（例如：http://baltimore-county-news.newslib.com/）
- **内容质量低劣但看似手动编写的网站**，这些网站的内容基于热门话题和趋势词（例如：http://snarkfood.com/mel-gibsons-mistress-says-hes-not-racist/310962/）

在对随机抽取的363个网站进行人工检查后，我们决定将前四类网站归类为MFA（Made for Advertisers），而拒绝第五类网站。因为包括第五类网站会导致误报率上升到不可接受的水平。最终，这363个网站中有44个被标记为MFA。

随后，我们使用监督机器学习算法（通过K2算法构建的贝叶斯网络）来自动分类剩余的6,195个候选网站。用于描述每个页面的特征集结合了结构和行为特征：
1. 内部链接数量：指向同一域名的链接。
2. 外部链接数量：指向外部域名的链接。
3. 页面中是否存在广告。

我们通过解析每个域名的首页及其首页中的五个随机选择的直接链接页面来计算这三种数量。

我们还尝试了许多其他特征（如网站注册时间、私密WHOIS注册、网站出现在搜索结果中的趋势词数量、JavaScript的存在等）。经人工检查确认，这些额外特征并未显著提高分类准确性。MFA网站通常具有大量的外部链接但内部链接较少，因为与广告相关的外部链接可以直接产生收益，而内部链接则不能。

为了确定一个网站是否包含广告，我们在收集的HTML中查找已知的广告域名。由于这些域名经常出现在JavaScript中，我们使用正则表达式在整个页面中进行搜索。我们使用手动收集的Google和Yahoo!使用的广告域名列表，并补充AdBlock Plus维护的“Easy List”（截至2011年1月12日）。

我们使用363个样本域的一个子集作为机器学习算法的训练集。由于该集合中非MFA网站过多（87%非MFA vs. 13% MFA），可能会导致模型过度拟合于非MFA网站。通过减少训练集中非MFA网站的比例（80%非MFA vs. 20% MFA），我们保持了模型对非MFA网站的偏见，从而在假设无罪的前提下仍能识别明显的MFA实例。

通过10轮交叉验证评估预测模型的质量，我们得到了87.3%的成功分类率。最终，算法将838个出现在趋势集结果中的网站分类为MFA（占所有收集域名的0.46%）。这个相对较小的阳性识别数量允许我们进行手动检查以排除假阳性。我们发现120个网站可能是假阳性，并在后续定量分析MFA行为时将其排除。

### 3. 测量趋势词滥用情况
#### 3.1 滥用发生率
现在讨论趋势搜索结果中恶意软件和MFA的普遍性。有许多方法可以总结几个月内收集的数千万条搜索结果。我们考虑四个类别：受影响的术语、搜索结果、URL和域名。

表1展示了每个类别的总数。对于网页搜索，我们在趋势集中观察到1,232个术语的搜索结果中存在恶意软件。每天运行六次查询三个月共产生了980万条搜索结果，其中只有7,889条结果感染了恶意软件（占总数的0.08%）。这些结果对应于607,156个唯一的URL，其中只有1,905个感染了恶意软件。最终，108,815个域名中有495个被感染。

与流行搜索词相比，控制组中更多术语被恶意软件感染，但这主要是由于它们的持续流行。尽管受感染的搜索结果数量相近，但控制组的整体结果几乎是趋势集的两倍（因为任何时候有大约300个趋势词处于“热门”状态，而控制组始终检查495个术语）。趋势集中有1,905个URL被感染，而控制组中只有302个。

Twitter上的恶意软件普遍性明显较低：只有2.4%的趋势集术语被发现含有恶意软件，而搜索结果中为18%，并且只有13个不同域名上的101个URL被感染。虽然观察到的感染数量非常少（0.03%），但它与Grier等人在一个更大的数据集（2500万个唯一URL）中观察到的恶意URL比例一致。控制集和Twitter趋势集也显示出类似的低感染水平。

Grier等人观察到Twitter上“垃圾信息”的比例更高。同样，我们在Twitter上观察到大量推广MFA网站的行为：94%的趋势术语包含带有MFA域名的推文。虽然大多数术语是目标，但只有少数域名被推广——趋势集中有141个，Twitter趋势集中有42个。网页搜索也被MFA网站广泛针对，趋势集中77%的术语至少有一个结果包含629个MFA域名之一。

从表1的数据来看，趋势术语中的恶意软件似乎大部分得到了控制，而MFA网站则相对猖獗。然而，长时间段内的数据汇总可能会掩盖通过趋势术语分发的恶意软件的潜在危害。表2展示了单个时间点的恶意软件感染率：在每个趋势术语上升的三天窗口内，统计受感染的趋势术语和搜索结果的数量。例如，平均有12.8个趋势术语被Safe Browsing API标记的恶意软件感染，相当于任何给定时刻最近热门术语的4.4%。另外还有6.2个趋势术语被感染但尚未被黑名单检测到。平均而言，有1.2个术语的前10个结果中包含未被Safe Browsing API检测到的恶意软件。这样看来，基于Web的恶意软件威胁显得更加令人担忧。

那么这种威胁是否对趋势术语更严重？控制组中有9.5个术语在给定时间点包含被检测到的恶意软件，其中一个术语被感染但尚未被检测到。因此，流行术语仍然被恶意软件针对，但频率低于趋势术语且成功率较低。最后，趋势集的假阴性率远高于控制集：34%（7.6个未检测到的结果对比14.8个检测到的结果） vs. 7%（1个未检测到的结果对比14.1个检测到的结果）。

#### 3.2 网络特性
接下来，我们转向描述利用趋势术语的网站之间的连接方式。为了提升其在Google中的排名，预期由同一实体运营的一组网站会互相链接，形成“链接农场”。因此，我们推测查看MFA和恶意软件分发站点的网络结构可能有助于了解攻击者及其活动方式。

**MFA域名**：我们构建了一个有向图GMFA，其中每个节点对应我们识别出的629个MFA站点之一，每条边（有向）对应两个域名之间的HTML链接。我们通过从Yahoo! Site Explorer获取每个站点的1,000个反向链接来构建该图。从GMFA中提取强连通分量得到一组互相链接的站点。我们发现了407个不同的强连通分量，其中大多数（392个）只包含单个节点。更有趣的是，193个站点（占所有MFA站点的30.7%）形成了一个强连通分量。这些节点的平均度（入度和出度）为12.83，节点间的平均路径长度为3.92，表明这是一个紧密连接的网络。因此，似乎所有MFA域名中的相当一部分可能由同一实体运营，或者至少是由一组相互链接的关联方运营。进一步检查这些站点的托管位置显示，193个站点中有130个属于仅七个不同的自治系统（AS），这里的同一AS中的站点通常由同一个提供商托管，这证实了存在一个相当大的、协同的MFA操作。

**恶意软件分发站点**：检查恶意软件分发站点的网络特性服务于略有不同的目的。这里，互相链接的站点不太可能由同一实体运营，但很可能是由同一组或同一活动所破坏。这与John等人观察到的行为一致，他们发现黑客通过在恶意网站之间添加链接来提升PageRank。与MFA站点类似，我们构建了一个有向图Gmal，其中每个节点对应我们基于更长时间段（2010年4月6日至2011年4月27日）收集的趋势术语识别出的6,133个恶意软件分发域名之一。每条边（有向）对应两个恶意软件分发域名之间的HTML链接。Gmal包含6,133个节点和18,864条边，以及5,125个不同的强连通分量，其中只有216个包含多个节点。表3列出了Gmal中最大的强连通分量（“活动”）。对于这些活动中的每个节点，我们查找其首次被列为感染的时间。通过比较每个活动中最早和最晚被感染的节点，我们可以推断活动的持续时间。我们还查找每个活动中的不同自治系统数量。

我们观察到了不同的活动行为，每个行为都表现出截然不同的攻击者策略。最大的活动（949）在本文撰写时仍在进行：节点以相对较恒定的速度被破坏，并托管在各种自治系统上。这表明这是一个长期、持续的努力。该活动影响了我们观察到的所有恶意软件感染站点的至少9.6%。活动5100和5101可能是同一努力的一部分：所有节点共享相同的服务器集，并似乎被同一漏洞利用。有趣的是，这一活动在至少8个月内没有受到阻碍（直到2010年12月）。最后，我们观察到的其他四个值得注意的活动针对小规模的服务器集，这些服务器几乎同时被破坏，并立即互相链接。

我们的活动定义非常保守：我们只在构建的图中寻找强连通分量。因此，很可能我们观察到的许多单例实际上是更大活动的一部分。进一步检测这些活动需要更复杂的聚类分析。例如，可以尝试使用分类算法的特征集作为坐标系，并将具有附近坐标的节点进行聚类。然而，尚不清楚这种特定的坐标系是否会提供确凿的共谋证据。

#### 3.3 Twitter上的MFA
我们现在关注Twitter帖子中MFA链接的使用情况。我们感兴趣的是测量每个恶意用户发布的独特MFA相关URL的数量，以及这些MFA网站的受欢迎程度。

图3(a)显示，发布MFA URL的作者中有95%链接到不超过5个域名——这大约涉及20,000篇帖子。然而，剩下的5%负责约55,000篇帖子，并链接到870个域名。控制组给出了类似的数据。换句话说，一小部分作者负责广泛的MFA网站推广活动。绝大多数作者只发布少量MFA链接，尚不清楚他们是否真的恶意。

同样，接收大部分相关推文的MFA域名数量也很少，如图3(b)所示。50%的MFA感染推文将用户引导至14个MFA域名，其余50%分布在180个MFA域名中。

#### 3.4 搜索术语特性
我们现在研究趋势术语本身的特性如何影响其搜索结果中恶意软件和MFA站点的普遍性。我们重点关注术语的类别、搜索中的流行度和预期广告收入。

**衡量术语类别、流行度和广告价格**：我们结合多个Google工具的结果，以了解更多关于术语的信息。