own overlaid ads (e.g., http://baltimore-county-news.
newslib.com/).
5. Sites containing shoddily, but seemingly manually written con-
tent based on popular topics informed by trending terms (e.g., http:
//snarkfood.com/mel-gibsons-mistress-says-
hes-not-racist/310962/).
Based on manual inspection of our random sample of 363 sites,
we decided to classify websites in any of the ﬁrst four categories
as MFA, while rejecting sites in the ﬁfth category. (Including those
would have driven up the false positive rate to unacceptable levels.)
This results in 44 of the 363 websites being tagged as MFA.
Subsequently, we used a supervised machine-learning algorithm
(Bayesian Network [29] constructed using the K2 algorithm [7]) to
automatically categorize the remaining 6 195 candidate websites.
The set of measures used to describe each page is a combination
of structural and behavioral characteristics: (1) the number of in-
ternal links, i.e. links to the same domain as the web page under
examination; (2) the number of external links, i.e.
links directed
to external domains; and (3) the existence of advertisements in the
web page. We calculate these three quantities for each of the 6 558
domains by parsing the front page of the domain and a set of ﬁve
additional web pages within the same domain, randomly chosen
among the direct links existing in the front page.
We experimented with many more features in the classiﬁer (e.g„
time since the website was registered, private WHOIS registration,
number of trending terms where a website appears in the search re-
sults, presence of JavaScript, etc). As manual inspection conﬁrmed,
this did not improve classiﬁcation accuracy beyond the three fea-
tures described in the paper. MFA sites exhibit large numbers of
external links but few internal links, because unlike external links
to ads, internal links do not (directly) generate revenue.
We determine whether a website has advertisements by looking
for known advertising domains in the collected HTML. Because
these domains often appear in JavaScript, we use regular expres-
sions to search throughout the page. We use manually-collected
lists of known advertising domains used by Google and Yahoo!,
complemented by the “Easy List” maintained by AdBlock Plus [3]
(Jan. 12, 2011).
We used a subset of the 363 sample domains as a training set
for the machine learning algorithm. We did not use the entire set
Terms
Inf.
Total
% Total
Results
Inf.
% Total
URLs
Inf.
Domains
% Total
Inf. %
6 946
495
1 232 18
123 25
9.8M 7 889
16.8M 7 332
.08 607K 1 905
.04 231K
302
.30 109K 495 .50
.13
86K 123 .14
1 950
495
1 176
46
53 11
20
2.4 466K
1.7 180K
137
1M 139
24
.03 355K
.01 825K
.01 139K
101
129
21
.03
.02
.02
43K 13 .03
98K 101 .02
9 .03
26K
Malware
Web Search
Trending set
Control set
Twitter
Trending set
Control set
Twitter trnd.
MFA sites
Web Search
Trending set 19 792 15 181 76.7 32.3M 954K 3.0
Twitter
Trending set
Twitter trnd.
466K 32 152 6.9
179K 12 145 6.6
1 950
1 176
1 833 94
1 012 86
1.35M 83 920 6.2
183K 629 .34
355K 32 130 9.0
139K 12 144 8.7
43K 141 .3
26K 42 .2
Table 1: Total incidence of malware and MFA in web search
and Twitter results.
because it is overcrowded with non-MFA domains (87% non-MFA
vs. 13% MFA), which would lead to over-training the model to-
wards non-MFA websites. By using fewer non-MFA websites in
the training set (80% vs. 20%), we kept our model biased towards
non-MFA websites, thereby maintaining the assumption of inno-
cence while remaining able to identify obvious MFA instances.
We assessed the quality of our predictive model by performing
10 rounds of cross-validation [19], yielding a 87.3% rate of suc-
cessful classiﬁcations. In the end, the algorithm classiﬁed 838 web-
sites (0.46% of all collected domains) that appear in the trending set
results as MFAs. The relatively small number of positive identiﬁ-
cations allows for manual inspection to root out false positives. We
ﬁnd that 120 of the websites (consistent with the predicted 87.3%
success rate) are likely false positives. We remove these websites
from consideration when conducting the subsequent quantitative
analysis of MFA behavior.
3. MEASURING TRENDING-TERM ABUSE
3.1 Incidence of abuse
We now discuss the prevalence of malware and MFA in the trend-
ing search results. There are many plausible ways to summarize
tens of millions of search results for tens of thousands of trending
terms gathered over several months. We consider four categories:
terms affected, search results, URLs and domains.
Table 1 presents totals for each of these categories. For web
search, we observed malware in the search results of 1 232 of the
6 946 terms in the trending set. Running queries six times a day
over three months yielded 9.8 million search results. Only 7 889
of these results were infected with malware – 0.08% of the total.
These results corresponded to 607 156 unique URLs, only 1 905
of which were infected with malware. Finally, 495 of the 108 815
domains were infected.
How does this compare to popular search terms? As a percent-
age, more control terms were infected with malware, but that is due
to their persistent popularity. Around the same number of search
results were infected, but the control set included nearly twice as
many overall results (because there were around 300 trending terms
“hot” at any one time compared to the 495 terms always checked
in the control set). 1 905 URLs were infected in the trending set,
compared to only 302 in the control set.
The prevalence of malware on Twitter is markedly lower: only
2.4% of terms in the trending set were found to have malware, com-
pared to 18% for search, and only 101 URLs on 13 distinct domains
were found infected. While the number of infections observed is
very small (0.03%), it is consistent with the proportion of malicious
URLs observed by Grier et al. [10] on a signiﬁcantly larger dataset
458Terms
# %
Results
#
Domains
# %
URLs
# %
undetected
12.8
2.9
6.2
1.2
Trending terms – web search (point in time)
detected
top 10
13.8
3.1
6.7
top 10
1.4
Control terms – web search (point in time)
11.5
detected
3.7
top 10
1.0
0.1
4.4
1.0
2.1
0.4
1.9
0.6
0.2
0.0
14.8
3.2
7.6
1.5
14.1
3.9
1.0
0.1
9.5
3.1
1.0
0.1
undetected
top 10
0.089
0.020
0.0
0.009
0.043
0.014
0.0
0.000
8.7
2.4
3.718
0.9
8.9
3.1
0.856
0.1
0.146
0.040
0.061
0.015
0.067
0.023
0.006
0.001
Table 2: Prevalence of malware in trending and control terms,
presented as the average prevalence of malware at every point
in time when searches are issued.
of 25 million unique URLs. The control and Twitter-trending sets
also reveal similarly low levels of infection.
Grier et al. observed a much higher proportion of “spammy”
behavior on Twitter. Likewise, we observe substantial promotion of
MFA websites on Twitter: 94% of trending terms contained tweets
with MFA domains. While most terms are targeted, only a small
number of domains are promoted – 141 in the trending set and 42 in
the Twitter-trending set. Web search is also targeted substantially
by MFA sites. 77% of terms in the trending set included one or
more of the 629 MFA domains in at least one result.
From the ﬁgures in Table 1 alone, it would appear that malware
on trending terms is largely under control, while MFA sites are rel-
atively rampant. However, aggregating ﬁgures across a large period
of time can obscure the potential harm of malware distributed via
trending terms. Table 2 presents the malware infection rate at a sin-
gle point in time: counting the number of terms and search results
that are infected with malware for each of the trending terms within
a 3-day window of rising. For example, on average, 12.8 trending
terms are infected with malware that has already been ﬂagged by
the Safe Browsing API, which corresponds to 4.4% of recently hot
terms at any given moment. A further 6.2 trending terms are in-
fected but not yet detected by the blacklist. On average, 1.2 terms
include a top 10 result that distributes malware and has not yet been
detected by the Safe Browsing API. Viewed in this manner, the
threat from web-based malware appears more worrisome.
But is the threat worse for trending terms? 9.5 control terms
include detected malware at a given point in time, with one term
infected but not yet detected. Hence, popular terms are still tar-
geted for malware, but less frequently than trending terms and with
less success. Finally, the false negative rate for the trending set is
much higher than for the control set: 34% (7.6 results undetected
compared to 14.8 detected) vs. 7% (1 undetected result compared
to 14.1 detected).
3.2 Network characteristics
We next turn to characterizing how sites preying on trending
terms are connected to each other. To prop up their rankings in
Google, one would expect a group of sites operated by a same en-
tity to link to each other – essentially building a “link farm [11].”
Thus, we conjecture that looking at the network structure of both
MFA and malware-serving sites may yield some insight on both
the actors behind these attacks, and the way campaigns are orches-
trated.
MFA domains. We build a directed graph GMFA where each node
corresponds to one of the 629 domains we identiﬁed as MFA sites,
and each of the 3 221 (directed) edges corresponds to an HTML
Campaign ID # Domains
Duration
Distinct ASes
949
5100
5101
5041
5053
4979
4988
590
36
25
11
10
9
9
>1 year
>8 months
>8 months
4 days
2 days
11 days
8 days
>200
1
1
2
1
2
2
Table 3: Malware campaigns observed.
link between two domains. We construct the graph by fetching
1 000 backlinks for each of the sites from Yahoo! Site Explorer [39].
Extracting the strongly connected components from GMFA yields
family of sites that link to each other. We ﬁnd 407 distinct strongly
connected components, most (392) only contain singletons. More
interestingly, 193 sites (30.7% of all MFA sites) form a strongly
connected component. These nodes have on average a degree (in-
and out-links) of 12.83, and an average path length between two
nodes of 3.92, indicating a quite tightly connected network. It thus
appears that a signiﬁcant portion of all MFA domains may be oper-
ated by the same entity – or at the very least, by a unique group of
afﬁliates all linking to each other. Further inspecting where these
sites are hosted indicates that 130 of the 193 sites belong to one of
only seven distinct Autonomous Systems (AS); here, sites within a
same AS are usually hosted by the same provider, which conﬁrms
the presence of a fairly large, collusive, MFA operation.
Malware-serving sites. Examining the network characteristics of
malware-distributing sites serves a slightly different purpose. Here,
sites connected to each other are unlikely to be operated by the
same entity, but are likely to have been compromised by the same
group or as part of the same campaign. This is consistent with
the behavior observed by John et al. [17], who found that miscre-
ants add links between malicious websites to elevate PageRank. As
with MFA sites, we build a directed graph Gmal where each node
corresponds to one of the 6 133 domains we identiﬁed as malware-
serving based on a longer collection of trending terms gathered
from April 6, 2010 to April 27, 2011. Each (directed) edge cor-
responds to an HTML link between two malware-serving domains.
Gmal contains 6 133 nodes and 18 864 edges, and 5 125 distinct
strongly connected components, only 216 of which contain more
than one node. Table 3 lists the largest strongly connected com-
ponents (“campaigns”) in Gmal. For each of the nodes in these
campaigns, we look up the time at which they were ﬁrst listed as
infected. By comparing the ﬁrst and last nodes to be infected within
a given campaign, we can infer the campaign’s duration. We also
look up the number of distinct ASes in each campaign.
We observe divergent campaign behaviors, each characterized by
markedly different attacker tactics. The largest campaign (949) is
still ongoing at the time of this writing: nodes are compromised at
a relatively constant rate, and are hosted on various ASes. This in-
dicates a long-term, sustained effort. This campaign affects at least
9.6% of all the malware-infested sites we observed. Campaigns
5100 and 5101 are likely part of the same effort: all nodes share the
same set of servers, and seem compromised by the same exploit.
Interestingly, this campaign went unabated for at least 8 months
(until Dec. 2010). Finally, the other four notable campaigns we
observed target small sets of servers, that are compromised almost
simultaneously, and all immediately link to each other.
Our deﬁnition of a campaign is extremely conservative: we are
only looking for strongly connected components in the graph we
have built.
It is thus likely that many of the singletons we ob-
459s
r
o
h
t
u
a
f
o
#
0
0
5
0
5
0
1
5
1
28
34
22
1 5 9 14
42
# of MFA domains tweeted by an author
(a) Number of Twitter authors
posting unique URLs contain-
ing MFA domains. Most au-
thors post up to 14 distinct do-
mains.
0
0
1
0
8
0
6
0
4
0
2
i
d
e
v
e
c
e
r
s
t
e
e
w
t
%
0
Control set
Trending set
100
50
# of MFA domains
150
200
(b) CDF of tweets associated
with MFA domains. The x-axis
shows the number of domains
associated with a portion of the
tweets.
Figure 3: Trending-term exploitation on Twitter.
served are in fact part of larger campaigns. Further detection of
such campaigns would require more complex clustering analysis.
For instance, one could try to use the feature set of the classiﬁ-
cation algorithm as a coordinate system, and cluster nodes with
nearby coordinates. However, it is unclear that this speciﬁc coordi-
nate system would provide deﬁnitive evidence of collusion.
3.3 MFA in Twitter
We turn our attention now to the use of MFA links in Twitter
posts. We are interested in measuring the amount of unique MFA-
related URLs each malicious user posts, and the popularity of the
MFA websites among them.
Figure 3(a) shows that 95% of the authors who post MFA URLs
link to 5 domains or less – this amounts to about 20 000 posts.
However, the remaining 5% is responsible for about 55 000 posts,
and links to 870 domains. The control set gives similar numbers.
In other words, a small number of authors are responsible for
wide promotional campaigns of MFA websites. The vast majority
of authors post a small number of MFA links, and it is unclear
whether they are actually malicious or not.
Similarly, the number of MFA domains that receive the majority
of related tweets is small as Figure 3(b) shows. 50% of the MFA
infected tweets direct users to 14 MFA domains, with the remaining
50% distributed across 180 MFA domains.
3.4 Search-term characteristics
We now examine how characteristics of the trending terms them-
selves inﬂuence the prevalence of malware and MFA sites in their
search results. We focus on the importance of the term’s category,
popularity in searches, and expected advertising revenue.
Measuring term category, popularity and ad prices. We com-
bine results from several Google tools in order to learn more about