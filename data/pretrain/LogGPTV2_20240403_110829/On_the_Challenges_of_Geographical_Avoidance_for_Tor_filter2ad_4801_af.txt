There are alternative ways besides geographical avoid-
ance to circumvent the threats of trafﬁc-analysis attacks and
censorship. Sophisticated path selection in Tor focuses on a
dynamic selection of nodes that takes network characteristics
like congestion into account. Other ways of avoidance use
trafﬁc obfuscation to overcome targeted blocking of Tor.
A. Path Selection
Tor selects the relays for a circuit according to the band-
width they can offer, and nodes with better performance are
preferred over smaller and often less stable ones. This does
not only inﬂuence the performance we experience when using
Tor, but it also has an impact on the anonymity set [6], [15],
[23] in which we hide. Recent work suggested different strate-
gies to improve Tor’s circuit establishment. Better congestion
management [20], [48] can help to improve the load balancing
in Tor and increase the number of relay candidates for a circuit
through a better distribution of trafﬁc.
Another important factor are autonomous systems (AS) [4],
[8], [14], [22], as an AS-level adversary is in a powerful
position to perform trafﬁc-analysis attacks. Similar to geo-
graphical avoidance, the core principle of AS awareness is the
circumvention of untrusted areas, while the analysis of paths
must take place in a different layer of the network stack.
B. Censorship Circumvention
Geographical avoidance is just an indirect solution to the
problem of Internet censorship and trafﬁc-analysis attacks in
particular, and we will introduce two classes of alternative
circumvention approaches. Decoy routing is a technique that
combines obfuscation and the support of a proxy to access
content that is otherwise censored. Pluggable transports are an
obfuscation extension to Tor that help make standard Tor trafﬁc
look like something else, e. g., any other trafﬁc that is not the
target of monitoring and blocking. Please note that both types
of circumvention do not consider geographical avoidance.
Decoy Routing: Decoy Routing [16], [24], [55] circum-
vents censorship and blocking by routing critical trafﬁc through
servers outside the censored area. For this context, we assume
to be located in a country where speciﬁc sites are prohibited
and all requests made to such contents are blocked or even
reported. To overcome this situation, so-called decoy routers
are used that provide accepted content outside the censored
area, hence, sites that are not hosted in your country but
tolerated by the censor. They act as said man-in-the-middle
and forward requests to blocked sites as well as send the
contents back to the client, all obfuscated through techniques
that hide the actual payload of a transmission. Countermea-
sures like RAD (routing around decoys) [41] try to avoid the
functionality of decoy routers by forcing routes on alternate
paths that cannot traverse the decoy router. In general, decoy
routing is another possibility to circumvent censorship, but it
does not consider routing attacks and potential consequences
through trafﬁc analysis.
13
Pluggable Transports: Pluggable transports [10], [35],
[53] are another way of censorship circumvention as they
provide access to Tor even in case standard circuits and bridges
are not an option because of blocking. Despite the wide
range of pluggable transport types, the general principle uses
obfuscation to make Tor trafﬁc look like some other, benign,
protocol that is not the target of blocking or monitoring through
the censor. In the context of geographical avoidance, the use
of pluggable transports is complicated. They cannot guarantee
secure routes, even though the obfuscation techniques make
it much harder for an adversary to learn sensitive information
from trafﬁc metadata. That said, it depends. Random patterns
in the obfuscation help to disrupt relations between trafﬁc
streams and detecting a relation to Tor becomes more difﬁcult,
but there is no protection against routing attacks.
VIII. CONCLUSION
In this work, we assessed challenges of geographical avoid-
ance for data transmissions and used it as a foundation to
introduce a novel empirical avoidance concept. To this end, our
concept considers hop-individual transmission characteristics
instead of static thresholds for individual connections, limiting
the collateral damage through overly restrictive avoidance
decisions. In a two-fold experimental study, we ﬁrst com-
pared the performance of our empirical avoidance concepts
to existing work and managed to outperform other approaches
by rejecting 22 % fewer circuits and maintaining on average
27 MB/s more advertised bandwidth. In a second step, we
introduced the prototype implementation TrilateraTor that con-
siders the requirements of a real-world deployment in addition
to the challenges of Tor’s diverse network infrastructure and
untrusted ground truth information. TrilateraTor is the ﬁrst
to provide practical geographical avoidance and overcomes
fundamental security issues of prior systems.
ACKNOWLEDGMENT
This work was supported by Intel as part of ICRI-CARS.
In addition, this work was supported by the German Federal
Ministry of Education and Research (BMBF Grant 16KIS0664
SysKit) and the Franco-German BMBF project BERCOM
(13N13741).
REFERENCES
[1]
[2]
[3]
“SecureList: Law Enforcement Agencies in Tor,” https://securelist.com/
law-enforcement-agencies-in-tor-impact-over-the-dark-web/67574/,
accessed: 2018-05-04.
“Tor Metrics: Bandwidth Usage for October 2017,” https://metrics.
torproject.org/bandwidth.html?start=2017-10-01&end=2017-10-31, ac-
cessed: 2018-02-01.
“Tor Metrics: Users
userstats-relay-table.html, accessed: 2018-05-04.
https://metrics.torproject.org/
by Country,”
[4] M. Akhoondi, C. Yu, and H. V. Madhyastha, “LASTor: A Low-Latency
AS-Aware Tor Client,” in IEEE Symposium on Security and Privacy,
ser. SP ’12. San Francisco, CA, USA: IEEE, May 2012, pp. 476–490.
[5] D. G. Andersen, H. Balakrishnan, N. Feamster, T. Koponen, D. Moon,
and S. Shenker, “Accountable Internet Protocol (AIP),” in Conference
of
the ACM Special Interest Group on Data Communication, ser.
SIGCOMM ’08. Seattle, WA, USA: ACM, Aug. 2008, pp. 339–350.
[6] M. Backes, A. Kate, S. Meiser, and E. Mohammadi, “(Nothing else)
MATor(s): Monitoring the Anonymity of Tor’s Path Selection,” in ACM
Conference on Computer and Communications Security, ser. CCS ’14.
Scottsdale, AZ, USA: ACM, Nov. 2014, pp. 513–524.
14
[7] H. Ballani, P. Francis, and X. Zhang, “A Study of Preﬁx Hijacking and
Interception in the Internet,” in Conference on Applications, Technolo-
gies, Architectures, and Protocols for Computer Communication, ser.
SIGCOMM ’07. Kyoto, Japan: ACM, Aug. 2007.
[8] A. Barton and M. Wright, “DeNASA: Destination-Naive AS-Awareness
in Anonymous Communications,” Proceedings on Privacy Enhancing
Technologies, vol. 2016, no. 4, pp. 356–372, Oct. 2016.
[9] K. Bauer, D. McCoy, D. Grunwald, T. Kohno, and D. Sicker, “Low-
Resource Routing Attacks Against Tor,” in ACM Workshop on Privacy
in Electronic Society, ser. WPES ’07. Alexandria, VA, USA: ACM,
Oct. 2007, pp. 11–20.
[10] D. J. Bernstein, M. Hamburg, A. Krasnova, and T. Lange, “Elligator:
Elliptic-Curve Points Indistinguishable from Uniform Random Strings,”
in ACM Conference on Computer and Communications Security, ser.
CCS ’13. Berlin, Germany: ACM, Nov. 2013, pp. 967–980.
[11] G. Danezis, “Statistical Disclosure Attacks: Trafﬁc Conﬁrmation in
Open Environments,” in Security and Privacy in the Age of Uncertainty:
IFIP TC11 International Conference on Information Security, ser.
SEC ’03. Athens, Greece: Kluwer, May 2003, pp. 421–426.
[12] G. Danezis, C. Diaz, and C. Troncoso, “Two-Sided Statistical Disclosure
Attack,” in International Workshop on Privacy Enhancing Technologies,
ser. PET ’07. Ottawa, ON, Canada: Springer, Jun. 2007, pp. 30–44.
[13] K. P. Dyer, S. E. Coull, T. Ristenpart, and T. Shrimpton, “Peek-a-Boo, I
Still See You: Why Efﬁcient Trafﬁc Analysis Countermeasures Fail,” in
IEEE Symposium on Security and Privacy, ser. SP ’12. San Francisco,
CA, USA: IEEE, May 2012, pp. 332–346.
[14] M. Edman and P. Syverson, “AS-Awareness in Tor Path Selection,”
in ACM Conference on Computer and Communications Security, ser.
CCS ’09. Chicago, IL, USA: ACM, Nov. 2009, pp. 380–389.
[15] A. Edmundson, R. Ensaﬁ, N. Feamster, and J. Rexford, “Characterizing
and Avoiding Routing Detours Through Surveillance States,” CoRR,
vol. abs/1605.07685, May 2016. [Online]. Available: http://arxiv.org/
abs/1605.07685
[16] D. Ellard, C. Jones, V. Manfredi, W. T. Strayer, B. Thapa, M. Van Welie,
and A. Jackson, “Rebound: Decoy Routing on Asymmetric Routes Via
Error Messages,” in IEEE Conference on Local Computer Networks,
ser. LCN ’15.
Clearwater Beach, FL, USA: IEEE, Oct. 2015, pp.
91–99.
[17] D. Fiﬁeld, C. Lan, R. Hynes, P. Wegmann, and V. Paxson, “Blocking-
Resistant Communication through Domain Fronting,” Proceedings on
Privacy Enhancing Technologies, vol. 2015, no. 2, pp. 46–64, 2015.
[18] Y. Gilad and A. Herzberg, “Spying in the Dark: TCP and Tor Traf-
ﬁc Analysis,” in Privacy Enhancing Technologies Symposium, ser.
PETS ’12. Vigo, Spain: Springer, Jul. 2012, pp. 100–119.
[19] K. Jansen, M. Sch¨afer, D. Moser, V. Lenders, C. P¨opper, and J. Schmitt,
“Crowd-GPS-Sec: Leveraging Crowdsourcing to Detect and Localize
GPS Spooﬁng Attacks,” in IEEE Symposium on Security and Privacy,
ser. SP ’18.
San Francisco, CA, USA: IEEE, May 2018, pp. 1018–
1031.
[20] R. Jansen, J. Geddes, C. Wacek, M. Sherr, and P. Syverson, “Never Been
KIST: Tors Congestion Management Blossoms with Kernel-Informed
Socket Transport,” in USENIX Security Symposium, ser. USENIX
Security ’14. San Diego, CA, USA: USENIX Association, Aug. 2014,
pp. 127–142.
[21] R. Jansen, M. Juarez, R. Galvez, T. Elahi, and C. Diaz, “Inside Job:
Applying Trafﬁc Analysis to Measure Tor from Within,” in Network and
Distributed System Security Symposium, ser. NDSS ’17.
San Diego,
CA, USA: Internet Society, Feb. 2017.
[23]
[22] A. Johnson, C. Wacek, R. Jansen, M. Sherr, and P. Syverson, “Users Get
Routed: Trafﬁc Correlation on Tor by Realistic Adversaries,” in ACM
Conference on Computer and Communications Security, ser. CCS ’13.
Berlin, Germany: ACM, Nov. 2013, pp. 337–348.
J. Juen, A. Johnson, A. Das, N. Borisov, and M. Caesar, “Defending Tor
from Network Adversaries: A Case Study of Network Path Prediction,”
Proceedings on Privacy Enhancing Technologies, vol. 2015, no. 2, pp.
171–187, Jun. 2015.
J. Karlin, D. Ellard, A. W. Jackson, C. E. Jones, G. Lauer, D. P.
Mankins, and W. T. Strayer, “Decoy Routing: Toward Unblockable
Internet Communication,” in USENIX Workshop on Free and Open
Communications on the Internet, ser. FOCI ’11. San Francisco, CA,
USA: USENIX Association, Aug. 2011.
[24]
[25] E. Katz-Bassett, J. P. John, A. Krishnamurthy, D. Wetherall, T. An-
derson, and Y. Chawathe, “Towards IP Geolocation Using Delay and
Topology Measurements,” in ACM SIGCOMM Conference on Internet
Measurement, ser. IMC ’06. Rio de Janeiro, Brazil: ACM, Oct. 2006,
pp. 71–84.
[26] D. Kesdogan, D. Agrawal, and S. Penz, “Limits of Anonymity in Open
Environments,” in International Workshop on Information Hiding, ser.
IH ’02. Noordwijkerhout, The Netherlands: Springer, Oct. 2002, pp.
53–69.
[27] D. Kim, S. Sra, and I. S. Dhillon, “A Non-Monotonic Method for
Large-Scale Non-Negative Least Squares,” Optimization Methods and
Software, vol. 28, no. 5, pp. 1012–1039, Oct. 2013.
[28] K. Kohls and C. P¨opper, “DigesTor: Comparing Passive Trafﬁc Analysis
Attacks on Tor,” in European Symposium on Research in Computer
Security, ser. ESORICS ’18. Springer, Sep. 2018.
[29] D. Levin, Y. Lee, L. Valenta, Z. Li, V. Lai, C. Lumezanu, N. Spring, and
B. Bhattacharjee, “Alibi Routing,” in Conference of the ACM Special
Interest Group on Data Communication, ser. SIGCOMM ’15. London,
United Kingdom: ACM, Aug. 2015, pp. 611–624.
[30] B. N. Levine, M. K. Reiter, C. Wang, and M. Wright, “Timing
Attacks in Low-Latency Mix Systems,” in International Conference
on Financial Cryptography, ser. FC ’04. Key West, Florida, USA:
Springer, Feb. 2004, pp. 251–265.
[31] Z. Li, S. Herwig, and D. Levin, “DeTor: Provably Avoiding Geographic
Regions in Tor,” in USENIX Security Symposium, ser. USENIX Secu-
rity ’17. Vancouver, BC, Canada: USENIX Association, Aug. 2017,
pp. 343–359.
[32] Z. Ling, X. Fu, W. Jia, W. Yu, D. Xuan, and J. Luo, “Novel Packet
Size-Based Covert Channel Attacks Against Anonymizer,” IEEE Trans-
actions on Computers, vol. 62, no. 12, pp. 2411–2426, Dec. 2013.
[33] Z. Ling, J. Luo, W. Yu, X. Fu, D. Xuan, and W. Jia, “A New Cell
Counter Based Attack Against Tor,” in ACM Conference on Computer
and Communications Security, ser. CCS ’09. Chicago, IL, USA: ACM,
Nov. 2009, pp. 578–589.
[34] N. Mathewson and R. Dingledine, “Practical Trafﬁc Analysis: Extend-
ing and Resisting Statistical Disclosure,” in International Workshop on
Privacy Enhancing Technologies, ser. PET ’04. Toronto, ON, Canada:
Springer, May 2004, pp. 17–34.
[35] H. Mohajeri Moghaddam, B. Li, M. Derakhshani, and I. Goldberg,
“SkypeMorph: Protocol Obfuscation for Tor Bridges,” in ACM Con-
ference on Computer and Communications Security, ser. CCS ’12.
Raleigh, NC, USA: ACM, Oct. 2012, pp. 97–108.
[37]
[36] S. J. Murdoch and G. Danezis, “Low-Cost Trafﬁc Analysis of Tor,” in
IEEE Symposium on Security and Privacy, ser. SP ’05. Oakland, CA,
USA: IEEE, May 2005, pp. 183–195.
J. Myre, E. Frahm, D. Lilja, and M. Saar, “TNT-NN: A Fast Active
Set Method for Solving Large Non-Negative Least Squares Problems,”
in International Conference on Computational Science, ser. ICCS ’17.
Zurich, Switzerland: Elsevier, Jun. 2017, pp. 755–764.
J. Naous, M. Walﬁsh, A. Nicolosi, D. Mazi`eres, M. Miller, and
A. Seehra, “Verifying and Enforcing Network Paths with ICING,” in
International Conference on emerging Networking EXperiments and
Technologies, ser. CoNEXT ’11.
Tokyo, Japan: ACM, Dec. 2011,
pp. 30:1–30:12.
[38]
[39] R. Nithyanand, O. Starov, A. Zair, P. Gill, and M. Schapira, “Measuring
and Mitigating AS-level Adversaries Against Tor,” in Symposium on
Network and Distributed System Security, ser. NDSS ’16. San Diego,
CA, USA: Internet Society, Feb. 2016.
[40] ——, “Measuring and Mitigating AS-level Adversaries Against Tor,” in
Symposium on Network and Distributed System Security, ser. NDSS ’16.
San Diego, CA, USA: Internet Society, Feb. 2016.
[41] M. Schuchard, J. Geddes, C. Thompson, and N. Hopper, “Routing
Around Decoys,” in ACM Conference on Computer and Communica-
tions Security, ser. CCS ’12. Raleigh, NC, USA: ACM, Oct. 2012,
pp. 85–96.
[42] H. Sengar, Z. Ren, H. Wang, D. Wijesekera, and S. Jajodia, “Tracking
15
Skype VoIP Calls Over The Internet,” in IEEE Conference on Computer
Communications, ser. INFOCOM ’10.
San Diego, CA, USA: IEEE,
Mar. 2010.
[43] V. Shmatikov and M.-H. Wang, “Timing Analysis in Low-Latency Mix
Networks: Attacks and Defenses,” in European Symposium on Research
in Computer Security, ser. ESORICS ’06.
Hamburg, Germany:
Springer, Sep. 2006, pp. 18–33.
[44] Y. Sun, A. Edmundson, L. Vanbever, O. Li, J. Rexford, M. Chiang, and
P. Mittal, “RAPTOR: Routing Attacks on Privacy in Tor,” in USENIX
Security Symposium, ser. USENIX Security ’15. Washington, D.C.,
USA: USENIX Association, Aug. 2015, pp. 271–286.
[45] T. Tickets. Check Maxmind GeoIPLocation Database
before
[Online]. Available: https://trac.torproject.org/projects/
distributing.
tor/ticket/26240
[46] Torspec. NTor Handshake Proposal. [Online]. Available: https://gitweb.
torproject.org/torspec.git/tree/proposals/216-ntor-handshake.txt
[47] S. ˇCapkun and J. P. Hubaux, “Secure Positioning of Wireless Devices
with Application to Sensor Networks,” in Proceedings IEEE 24th
Annual Joint Conference of the IEEE Computer and Communications
Societies., vol. 3, March 2005, pp. 1917–1928 vol. 3.
[48] T. Wang, K. Bauer, C. Forero, and I. Goldberg, “Congestion-Aware
Path Selection for Tor,” in International Conference on Financial
Cryptography and Data Security, ser. FC ’12. Kralendijk, Bonaire:
Springer, Feb. 2012, pp. 98–113.
[49] X. Wang, S. Chen, and S. Jajodia, “Tracking Anonymous Peer-to-Peer
VoIP Calls on the Internet,” in ACM Conference on Computer and
Communications Security, ser. CCS ’05. Alexandria, VA, USA: ACM,
Nov. 2005, pp. 81–91.
[50] ——, “Network Flow Watermarking Attack on Low-Latency Anony-
mous Communication Systems,” in IEEE Symposium on Security and
Privacy, ser. SP ’07. Oakland, CA, USA: IEEE, May 2007, pp. 116–
130.
[51] X. Wang and D. S. Reeves, “Robust Correlation of Encrypted Attack
Trafﬁc Through Stepping Stones by Manipulation of Interpacket De-
lays,” in ACM Conference on Computer and Communications Security,
ser. CCS ’03. Washington, D.C., USA: ACM, Oct. 2003, pp. 20–29.
[52] Z. Weinberg, S. Cho, V. Sekar, and P. Gill, “How to Catch when Proxies
Lie: Verifying the Physical Locations of Network Proxies with Active
Geolocation,” in Proceedings of the 18th ACM SIGCOMM Conference
on Internet Measurement, ser. IMC ’18. New York, NY, USA: ACM,
2018.
[53] Z. Weinberg, J. Wang, V. Yegneswaran, L. Briesemeister, S. Cheung,
F. Wang, and D. Boneh, “StegoTorus: A Camouﬂage Proxy for the Tor
Anonymity System,” in ACM Conference on Computer and Communi-
cations Security, ser. CCS ’12. Raleigh, NC, USA: ACM, Oct. 2012,
pp. 109–120.
[54] P. Winter and S. Lindskog, “How the Great Firewall of China is Block-
ing Tor,” in USENIX Workshop on Free and Open Communications on
the Internet, ser. FOCI ’12. Bellevue, WA, USA: USENIX Association,
Aug. 2012.
[55] E. Wustrow, C. M. Swanson, and J. A. Halderman, “TapDance: End-
to-Middle Anticensorship without Flow Blocking,” in USENIX Security
Symposium, ser. USENIX Security ’14. San Diego, CA, USA: USENIX
Association, Aug. 2014, pp. 159–174.
[56] W. Yu, X. Fu, S. Graham, D. Xuan, and W. Zhao, “DSSS-Based Flow
Marking Technique for Invisible Traceback,” in IEEE Symposium on
Security and Privacy, ser. SP ’07. Oakland, CA, USA: IEEE, May
2007, pp. 18–32.
[57] D. J. Zage and C. Nita-Rotaru, “On the Accuracy of Decentralized
Virtual Coordinate Systems in Adversarial Networks,” in Proceedings of
the 14th ACM Conference on Computer and Communications Security,
ser. CCS ’07. New York, NY, USA: ACM, 2007, pp. 214–224.
[Online]. Available: http://doi.acm.org/10.1145/1315245.1315273
[58] Y. Zhu, X. Fu, B. Graham, R. Bettati, and W. Zhao, “On Flow Correla-
tion Attacks and Countermeasures in Mix Networks,” in International
Workshop on Privacy Enhancing Technologies, ser. PET ’04. Toronto,
ON, Canada: Springer, May 2004, pp. 207–225.