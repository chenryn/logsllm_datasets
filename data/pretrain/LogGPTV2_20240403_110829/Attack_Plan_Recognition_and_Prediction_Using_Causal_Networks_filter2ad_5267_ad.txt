### Optimized Text

The alerts `DB NewClient Target` and `DB Illegal File Access` correspond to attack steps aimed at gaining access to the server and extracting data directly from the host. Specifically, the attacker first performs a buffer overflow attack on the database server, then establishes a covert channel to the host, and finally exports malicious code to gain access to the database and retrieve the data. The alert set `{DB NewClient, Loki}` represents attack steps designed to establish a covert channel and exfiltrate confidential data externally. As shown in Figure 1(b), these two sets of alerts have an indirect relationship but share the same ultimate goal: to steal data from the database server and export it externally.

By applying the scenario correlation technique described in Section 4.3, we can integrate these two scenarios into a single, cohesive scenario, as illustrated in Figure 3(b). This integration allows us to group them together as one evidence set. The advantage of correlating isolated scenarios is that it enables the accumulation of more comprehensive evidence, which can be used for further analysis, such as evaluating the likelihood of each subgoal or final goal and predicting future attacks.

Using the database server as an example, based on the integrated evidence set, we apply probabilistic inference to the causal network (as shown in Figure 1(b)) to compute the likelihood of each subgoal and the final goal. Table 1 presents the likelihood assessment of some subgoals and the final goal based on the evidence set. Specifically, the table shows the probability results for the subgoals "Get confidential data" and "Export confidential data," and the final goal "Steal and export confidential data." It is evident that the probabilities of achieving these subgoals and the final goal increase with the support of incoming evidence corresponding to the attack steps aimed at extracting and exporting data from the database server.

The likelihood of each node in the causal network, based on ongoing evidence, can also be used to predict future attacks. For instance, after obtaining evidence of a `DB FTP Globbing Attack`, the probability of the subgoal "Get data from Server directly" (as shown in Figure 1(b)) increases to 0.67. This suggests that we can expect a future attack where the attacker gains access to files stored in the database server. Similarly, when we receive evidence of `DB NewClient`, the likelihood of "Transfer data via covert channel" (as shown in Figure 1(b)) is computed to be 0.71, indicating a high probability that the attacker will attempt to export data via the covert channel in the future. In the GCP Scenario I, the attacker did indeed launch an attack to access confidential data stored in the database server (indicated by the alert `DB Illegal File Access`) after gaining root access, and subsequently transferred the stolen data externally (indicated by the alert `Loki`) after setting up the covert channel (indicated by the alert `DB NewClient`).

By applying our algorithms for scenario correlation and attack prediction to the GCP dataset, we can correlate isolated attack scenarios resulting from low-level alert correlation and make accurate predictions about the type of upcoming attacks.

In our approach, one of the most important components is the library of attack plans (defined as attack trees). This library serves as the foundation for automatically correlating isolated attack scenarios at a higher level and conducting probabilistic inference for attack prediction. While there are limitations due to the finite nature of the attack plan library, we argue that, in practice, the library can be defined as comprehensively as possible by security experts with their knowledge of attacks, attack strategies, and the networks and systems under protection. The attack plan library can be expanded or redefined with new knowledge of attacks or attack scenarios. Therefore, our approach is practical and has the potential to provide security operators with a way to automatically correlate isolated attack scenarios and predict future attacks based on observed evidence and the networks under protection.

### Challenges and Future Work

There are several challenges in attack plan recognition. First, the current approach relies on predefined attack plans built on the knowledge and understanding of security experts. If attackers' activities extend beyond the predefined scope of attack plans, we face the challenge of handling and identifying new attack scenarios. Another challenge is distinguishing between deceptive plans and the real goals of the attackers, requiring the development of mechanisms to identify and avoid misleading tactics. Finally, we need to consider how to effectively differentiate between attacks conducted by a single attacker and those by a group of coordinated attackers. These challenges will be addressed in our future work.

### Acknowledgments

This work is supported in part by NSF grants CCR-0133629 and CCR-0208655 and Army Research Office contract DAAD19-01-1-0610. The contents of this work are solely the responsibility of the authors and do not necessarily represent the official views of NSF and the U.S. Army.