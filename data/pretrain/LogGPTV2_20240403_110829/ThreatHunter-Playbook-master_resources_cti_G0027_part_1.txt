# G0027: Threat Group-3390

## Description
[Threat Group-3390](https://attack.mitre.org/groups/G0027) is a Chinese threat group known for its extensive use of strategic web compromises to target victims. The group has been active since at least 2010 and has targeted organizations in the aerospace, government, defense, technology, energy, and manufacturing sectors. (Citations: [Dell TG-3390], [SecureWorks BRONZE UNION June 2017], [Securelist LuckyMouse June 2018])

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, Windows, macOS | Execution | [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203/) | Threat Group-3390 has exploited the Microsoft SharePoint vulnerability CVE-2019-0604. | Anti-virus, System calls, Process monitoring |
| Linux, Windows, macOS | Lateral Movement | [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210/) | Threat Group-3390 has exploited MS17-010 to move laterally within networks. | Windows Error Reporting, Process monitoring, File monitoring |
| Linux, Windows, macOS | Persistence, Privilege Escalation | [Web Shell](https://attack.mitre.org/techniques/T1100/) | Threat Group-3390 has used various Web shells. | Anti-virus, Authentication logs, File monitoring, Netflow/Enclave netflow, Process monitoring |
| Linux, macOS, Windows, GCP, Azure, AWS | Discovery | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | Threat Group-3390 has used the `net view` command. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |
| Windows | Persistence, Privilege Escalation, Defense Evasion | [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038/) | Threat Group-3390 has performed DLL search order hijacking to execute their payload. | File monitoring, DLL monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | [Standard Application Layer Protocol](https://attack.mitre.org/techniques/T1071/) | Threat Group-3390 malware has used HTTP for C2. | Packet capture, Netflow/Enclave netflow, Process use of network, Malware reverse engineering, Process monitoring |
| Windows | Persistence, Privilege Escalation | [New Service](https://attack.mitre.org/techniques/T1050/) | A Threat Group-3390 tool can create a new service, naming it after the config information, to gain persistence. | Windows Registry, Process monitoring, Process command-line parameters, Windows event logs |
| Windows | Defense Evasion, Privilege Escalation | [Bypass User Account Control](https://attack.mitre.org/techniques/T1088/) | A Threat Group-3390 tool can use a public UAC bypass method to elevate privileges. | System calls, Process monitoring, Authentication logs, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion, Privilege Escalation | [Process Injection](https://attack.mitre.org/techniques/T1055/) | A Threat Group-3390 tool can spawn `svchost.exe` and inject the payload into that process. | API monitoring, Windows Registry, File monitoring, DLL monitoring, Process monitoring, Named Pipes |
| Windows | Execution | [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/) | A Threat Group-3390 tool can use WMI to execute a binary. | Authentication logs, Netflow/Enclave netflow, Process monitoring, Process command-line parameters |
| Windows | Persistence | [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060/) | A Threat Group-3390 tool can add the binary’s path to the Registry key `Software\Microsoft\Windows\CurrentVersion\Run` to add persistence. | Windows Registry, File monitoring |
| Windows | Defense Evasion | [Modify Registry](https://attack.mitre.org/techniques/T1112/) | A Threat Group-3390 tool can create a new Registry key under `HKEY_CURRENT_USER\Software\Classes\`. | Windows Registry, File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Windows | Discovery | [Query Registry](https://attack.mitre.org/techniques/T1012/) | A Threat Group-3390 tool can read and decrypt stored Registry values. | Windows Registry, Process monitoring, Process command-line parameters |
| Windows, Linux, macOS, SaaS | Initial Access | [Drive-by Compromise](https://attack.mitre.org/techniques/T1189/) | Threat Group-3390 has extensively used strategic web compromises to target victims. | Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection |
| Linux, macOS, Windows | Defense Evasion | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | A Threat Group-3390 tool can encrypt payloads using XOR. Threat Group-3390 malware is also obfuscated using Metasploit’s shikata_ga_nai encoder and compressed with LZNT1 compression. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Windows | Defense Evasion | [Deobfuscate/Decode Files or Information](https://attack.mitre.org/techniques/T1140/) | During execution, Threat Group-3390 malware deobfuscates and decompresses code that was encoded with Metasploit’s shikata_ga_nai encoder and compressed with LZNT1 compression. | File monitoring, Process monitoring, Process command-line parameters |

This table provides a detailed overview of the tactics, techniques, and procedures (TTPs) used by Threat Group-3390, along with the relevant data sources for detection and analysis.