以下是优化后的文本，使其更加清晰、连贯和专业：

---

**参考文献**

[67] S. Khandelwal, "CCleaner攻击时间线：黑客如何感染230万台PC," 2018年, https://thehackernews.com/2018/04/ccleaner-malware-attack.html.

[68] W. Khreich, S. S. Murtaza, A. Hamou-Lhadj, 和 C. Talhi, "结合异构异常检测器以提高软件安全性," *Journal of Systems and Software*, 第137卷, 第415-429页, 2018年.

[69] S. T. King 和 P. M. Chen, "入侵回溯," *ACM SIGOPS Operating Systems Review*, 第37卷, 第5期, 第223-236页, 2003年.

[70] R. Klinkenberg, "学习漂移概念：示例选择与示例加权," *Intelligent Data Analysis*, 第8卷, 第3期, 第281-300页, 2004年.

[71] R. Kondor, N. Shervashidze, 和 K. M. Borgwardt, "图谱," 在*国际机器学习会议*. ACM, 2009年, 第529-536页.

[72] O. Kostakis, "Classy: 快速聚类调用图流," *Data Mining and Knowledge Discovery*, 第28卷, 第5-6期, 第1554-1585页, 2014年.

[73] I. Koychev, "针对概念漂移的渐进遗忘," 在*ICJAI/E-时空推理当前问题研讨会*. CAI, 2000年.

[74] G. Kurtz, "Operation Aurora 攻击谷歌及其他公司," 2010年1月, 可访问于 http://securityinnovator.com/index.php?articleID=42948&sectionID=25.

[75] A. Kyrola, G. E. Blelloch, 和 C. Guestrin, "GraphChi: 仅在个人电脑上进行大规模图计算," 在*操作系统设计与实现研讨会*. USENIX, 2012年.

[76] P. Li, "一致加权采样中的0位一致性," 在*知识发现与数据挖掘国际会议*. ACM, 2015年, 第665-674页.

[77] C. Liu, X. Yan, H. Yu, J. Han, 和 P. S. Yu, "通过挖掘行为图来回溯非崩溃错误," 在*数据挖掘国际会议*. SIAM, 2005年, 第286-297页.

[78] M. Liu, Z. Xue, X. Xu, C. Zhong, 和 J. Chen, "基于系统调用的主机入侵检测系统: 回顾与未来趋势," *ACM Computing Surveys (CSUR)*, 第51卷, 第5期, 第98页, 2018年.

[79] Y. Liu, M. Zhang, D. Li, K. Jee, Z. Li, Z. Wu, J. Rhee, 和 P. Mittal, "企业安全及时因果分析." NDSS, 2018年.

[80] S. Ma, X. Zhang, 和 D. Xu, "Protracer: 通过交替记录和污点追踪实现实际溯源." NDSS, 2016年.

[81] F. Maggi, M. Matteucci, 和 S. Zanero, "通过系统调用序列和参数分析检测入侵," *IEEE Transactions on Dependable and Secure Computing*, 第7卷, 第4期, 第381-395页, 2010年.

[82] M. Manasse, F. McSherry, 和 K. Talwar, "一致加权采样," 技术报告, Microsoft Research, 2010年.

[83] E. Manzoor, S. M. Milajerdi, 和 L. Akoglu, "在流式异构图中快速内存高效的异常检测," 在*知识发现与数据挖掘国际会议*. ACM, 2016年, 第1035-1044页.

[84] ——, "Streamspot 数据集," 2016年, https://github.com/sbustreamspot/sbustreamspot-data.

[85] J. McHugh, "测试入侵检测系统: 对林肯实验室1998年和1999年DARPA入侵检测系统评估的批评," *ACM Transactions on Information and System Security (TISSEC)*, 第3卷, 第4期, 第262-294页, 2000年.

[86] S. M. Milajerdi, B. Eshete, R. Gjomemo, 和 V. Venkatakrishnan, "Poirot: 将攻击行为与内核审计记录对齐以进行网络威胁猎捕," 在*SIGSAC计算机与通信安全会议*. ACM, 2019年, 第1813-1830页.

[87] S. M. Milajerdi, R. Gjomemo, B. Eshete, R. Sekar, 和 V. Venkatakrishnan, "Holmes: 通过可疑信息流的相关性进行实时APT检测," 在*安全与隐私研讨会*. IEEE, 2019年.

[88] M. Mongiovi, P. Bogdanov, R. Ranca, E. E. Papalexakis, C. Faloutsos, 和 A. K. Singh, "Netspot: 在动态网络中识别显著异常区域," 在*数据挖掘国际会议*. SIAM, 2013年, 第28-36页.

[89] J. Morris, S. Smalley, 和 G. Kroah-Hartman, "Linux 安全模块: Linux 内核的一般安全支持," 在*USENIX 安全研讨会*, 2002年.

[90] K.-K. Muniswamy-Reddy, D. A. Holland, U. Braun, 和 M. I. Seltzer, "具备来源感知的存储系统," 在*USENIX 年度技术会议*, 2006年, 第43-56页.

[91] S. S. Murtaza, A. Hamou-Lhadj, W. Khreich, 和 M. Couture, "Total ADS: 自动化软件异常检测系统," 在*第14届源代码分析与操作国际研讨会*. IEEE, 2014年, 第83-88页.

[92] D. Mutz, W. Robertson, G. Vigna, 和 R. Kemmerer, "利用执行上下文检测异常系统调用," 在*最近入侵检测进展国际研讨会*. Springer, 2007年, 第1-20页.

[93] D. Namiot 和 M. Sneps-Sneppe, "关于微服务架构," *International Journal of Open Information Technologies*, 第2卷, 第9期, 第24-27页, 2014年.

[94] A. Narayanan, M. Chandramohan, R. Venkatesan, L. Chen, Y. Liu, 和 S. Jaiswal, "graph2vec: 学习图的分布式表示," CoRR, vol. abs/1707.05005, 2017年.

[95] M. Neuhaus 和 H. Bunke, "用于学习图匹配编辑成本的自组织映射," *IEEE Transactions on Systems, Man, and Cybernetics, Part B (Cybernetics)*, 第35卷, 第3期, 第503-514页, 2005年.

[96] C. Nikos Virvilis, G. CISSP, C. Oscar Serrano, C. CISM 等, "大数据分析用于复杂攻击检测," 2014年.

[97] P. Papadimitriou, A. Dasdan, 和 H. Garcia-Molina, "Web 图相似性用于异常检测," *Journal of Internet Services and Applications*, 第1卷, 第1期, 第19-30页, 2010年.

[98] C. Parampalli, R. Sekar, 和 R. Johnson, "一种针对强大系统调用监控的实用模仿攻击," 在*信息安全、计算机和通信安全研讨会*. ACM, 2008年, 第156-167页.

[99] J. Park, D. Nguyen, 和 R. Sandhu, "基于来源的访问控制模型," 在*隐私、安全和信任国际会议*. IEEE, 2012年, 第137-144页.

[100] T. Pasquier, X. Han, M. Goldstein, T. Moyer, D. Eyers, M. Seltzer, 和 J. Bacon, "实用的全系统来源捕获," 在*云计算研讨会*. ACM, 2017年, 第405-418页.

[101] T. Pasquier, X. Han, T. Moyer, A. Bates, O. Hermant, D. Eyers, J. Bacon, 和 M. Seltzer, "全系统来源的运行时分析," 在*计算机与通信安全会议 (CCS'18)*. ACM, 2018年.

[102] K. Pei, Z. Gu, B. Saltaformaggio, S. Ma, F. Wang, Z. Zhang, L. Si, X. Zhang, 和 D. Xu, "Hercule: 通过相关日志图上的社区发现进行攻击故事重构," 在*第32届计算机安全应用年度会议*. ACM, 2016年, 第583-595页.

[103] B. Perozzi, L. Akoglu, P. Iglesias Sánchez, 和 E. Müller, "在大型属性图中进行聚焦聚类和异常检测," 在*知识发现与数据挖掘国际会议*. ACM, 2014年, 第1346-1355页.

[104] D. J. Pohly, S. McLaughlin, P. McDaniel, 和 K. Butler, "Hi-Fi: 收集高保真全系统来源," 在*计算机安全应用会议*. ACM, 2012年, 第259-268页.

[105] N. Provos, "Systrace-交互式系统调用策略生成," 2006年.

[106] T. Radichel, "案例研究: 可能防止Target Breach的关键控制," SANS Institute InfoSec Reading Room, 2014年9月, 可访问于 https://www.sans.org/reading-room/whitepapers/casestudies/paper/35412.

[107] E. Raff 和 C. Nicholas, "通过随机哈希LZJD进行恶意软件分类和类别不平衡处理," 在*第10届人工智能与安全研讨会*. ACM, 2017年, 第111-120页.

[108] P. J. Rousseeuw, "轮廓系数: 聚类分析解释和验证的图形辅助工具," *Journal of Computational and Applied Mathematics*, 第20卷, 第53-65页, 1987年.

[109] R. Sekar, M. Bendre, D. Dhurjati, 和 P. Bollineni, "一种基于自动机的快速方法用于检测异常程序行为," 在*安全与隐私研讨会 (S&P)*. IEEE, 2001年, 第144-155页.

[110] N. Shervashidze, P. Schweitzer, E. J. v. Leeuwen, K. Mehlhorn, 和 K. M. Borgwardt, "Weisfeiler-Lehman 图核," *Journal of Machine Learning Research*, 第12卷, 第9期, 第2539-2561页, 2011年.

[111] A. Shrivastava 和 P. Li, "为MinHash辩护而非SimHash," 在*人工智能与统计学会议*, 2014年, 第886-894页.

[112] X. Shu, D. D. Yao, N. Ramakrishnan, 和 T. Jaeger, "长跨度程序行为建模与攻击检测," *ACM Transactions on Privacy and Security (TOPS)*, 第20卷, 第4期, 第12页, 2017年.

[113] X. Shu, D. D. Yao, 和 B. G. Ryder, "程序异常检测的形式框架," 在*最近入侵检测进展国际研讨会*. Springer, 2015年, 第270-292页.

[114] A. Somayaji 和 S. Forrest, "使用系统调用延迟的自动化响应," 在*Usenix 安全研讨会*, 2000年, 第185-197页.

[115] J. Sun, C. Faloutsos, S. Papadimitriou, 和 P. S. Yu, "GraphScope: 大型时变图的无参数挖掘," 在*知识发现与数据挖掘国际会议*. ACM, 2007年, 第687-696页.

[116] W. Symantec, "高级持续威胁: Symantec 的观点," Symantec World Headquarters, 2011年.

[117] J. E. Tapiador 和 J. A. Clark, "伪装模仿攻击检测: 随机化方法," *Computers & Security*, 第30卷, 第5期, 第297-310页, 2011年.

[118] D. Tariq, B. Baig, A. Gehani, S. Mahmood, R. Tahir, A. Aqil, 和 F. Zaffar, "识别相关异常的来源," 在*应用计算研讨会*. ACM, 2011年, 第224-229页.

[119] C. Thornton, F. Hutter, H. H. Hoos, 和 K. Leyton-Brown, "Auto-WEKA: 分类算法的选择和超参数优化相结合," 在*第19届SIGKDD国际知识发现与数据挖掘会议*. ACM, 2013年, 第847-855页.

[120] A. Tsymbal, "概念漂移问题: 定义及相关工作," 计算机科学系, Trinity College Dublin, 第106卷, 第2期, 2004年.

[121] E. van der Kouwe, D. Andriesse, H. Bos, C. Giuffrida, 和 G. Heiser, "基准犯罪: 系统安全中的新兴威胁," arXiv 预印本 arXiv:1801.02381, 2018年.

[122] S. V. N. Vishwanathan, N. N. Schraudolph, R. Kondor, 和 K. M. Borgwardt, "图核," *Journal of Machine Learning Research*, 第11卷, 第4期, 第1201-1242页, 2010年.

[123] D. Wagner 和 P. Soto, "对基于主机的入侵检测系统的模仿攻击," 在*计算机与通信安全会议*. ACM, 2002年, 第255-264页.

[124] J. Wang, H. T. Shen, J. Song, 和 J. Ji, "用于相似性搜索的哈希: 一项调查," arXiv 预印本 arXiv:1408.2927, 2014年.

[125] R. N. Watson, "利用系统调用包装器中的并发漏洞." WOOT, 第7卷, 第1-8页, 2007年.

[126] B. Weisfeiler 和 A. Lehman, "将图简化为规范形式及在此过程中产生的代数," *Nauchno-Technicheskaya Informatsia*, 第2卷, 第9期, 第12-16页, 1968年.

[127] A. Wespi, M. Dacier, 和 H. Debar, "使用可变长度审计跟踪模式进行入侵检测," 在*最近入侵检测进展国际研讨会*. Springer, 2000年, 第110-129页.

[128] W. Wu, B. Li, L. Chen, 和 C. Zhang, "更实用的一致加权采样," 在*万维网国际会议*. International World Wide Web Conferences Steering Committee, 2017年, 第1035-1043页.

[129] K. Xu, W. Hu, J. Leskovec, 和 S. Jegelka, "图神经网络有多强大?" arXiv 预印本 arXiv:1810.00826, 2018年.

[130] K. Xu, K. Tian, D. Yao, 和 B. G. Ryder, "更敏锐的自我意识: 具有上下文敏感性的程序行为概率推理用于异常检测," 在*依赖系统和网络国际会议*. IEEE/IFIP, 2016年, 第467-478页.

[131] T. Yadav 和 A. M. Rao, "网络杀伤链的技术方面," 在*计算机与通信安全国际研讨会*. Springer, 2015年, 第438-452页.

[132] D. Yang, B. Li, L. Rettig, 和 P. Cudré-Mauroux, "Histosketch: 在具有概念漂移的流式直方图中进行快速相似性保持的草图绘制," 在*数据挖掘国际会议 (ICDM)*. IEEE, 2017年, 第545-554页.

[133] J. Yang, Y.-G. Jiang, A. G. Hauptmann, 和 C.-W. Ngo, "评估场景分类中的视觉词袋表示," 在*多媒体信息检索研讨会*. ACM, 2007年, 第197-206页.

[134] N. Ye 等, "用于异常检测的时间行为马尔可夫链模型," 在*系统、人与网络安全信息保障研讨会*, 第166卷. West Point, NY, 2000年, 第169页.

---

### 附录

#### A. 可用性
本文第V节描述的实现以及第VI节呈现的评估材料在线提供，并根据Apache License V2.0和GPL v2（详见各个子组件）发布。更多细节请参见: https://github.com/crimson-unicorn。

#### B. Histosketch
##### 符号和基本概念
表X列出了本节中使用的符号。相似性保留的数据草图或局部敏感哈希 (LSH) 使我们能够通过将高维直方图表示投影到低维空间同时保持其相似性来高效地计算两个图之间的相似性 [83]。

| 符号 | 含义 |
| --- | --- |
| $\mathcal{E}$ | 直方图元素集合 |
| $h$ | 直方图元素: $h \in \mathcal{E}$ |
| $L$ | 累积加权直方图计数向量: $L \in \mathbb{R}^{|\mathcal{E}|}$ |
| $L_h$ | 直方图元素 $h$ 的计数 |
| $\lambda$ | 权重衰减因子 |
| $w_t$ | 指数衰减权重: $w_t = e^{-\lambda \Delta t}$ |
| $S$ | 直方图向量 $L$ 的草图: $|S| \ll |\mathcal{E}|$ 并且是固定的 |

**表X: 符号**

形式上，我们将LSH定义如下（源自Charikar [25]）:

**定义1**: 局部敏感哈希方案是一组作用于对象集合的哈希函数分布，使得对于两个对象 $m, n$,
\[ P_{h \in \mathcal{F}}[h(m) = h(n)] = \text{sim}(m, n) \]
其中 $\text{sim}(m, n)$ 是定义在对象集合上的某种相似性函数。

Histosketch [132] 使用归一化的最小最大相似性来衡量两个直方图向量之间的相似性:

**定义2**:
\[ \text{sim}_{\text{min-max}}(H^a, H^b) = \frac{\sum_{h \in \mathcal{E}} \min(H^a_h, H^b_h)}{\sum_{h \in \mathcal{E}} \max(H^a_h, H^b_h)} \]
其中上标 $a, b$ 表示直方图的身份。

**草图创建**
Histosketch 使用一致加权采样的变体，该变体接受正实数作为输入以生成固定大小的草图 [76]。草图的大小 $|S|$ 控制了信息损失和计算效率之间的权衡，以便进行实时检测（第VI节）。为了生成一个草图元素 $S_j$，我们首先为每个 $h \in \mathcal{E}$ 生成三个随机变量：
\[ r_{h,j} \sim \text{Gamma}(2, 1) \]
\[ c_{h,j} \sim \text{Gamma}(2, 1) \]
\[ \beta_{h,j} \sim \text{Uniform}(0, 1) \]

然后按照算法3中的步骤进行。$r, c, \beta$ 对于每个 $\mathcal{E}$ 中的元素都是固定的。

**算法3: 使用Histosketch创建图草图**

**输入**: 直方图 $L, r, c, \beta$

**输出**: 草图 $S$ 及其对应的哈希值 $A$

```plaintext
for j from 1 to |S| do
    foreach h in E do
        y_{h,j} = exp(log(L_h) - r_{h,j} * beta_{h,j})
        a_{h,j} = c_{h,j} / (y_{h,j} * exp(r_{h,j}))
    S_j = argmin_{h in E} a_{h,j}
    A_j = min_{h in E} a_{h,j}
```

草图元素 $j$ 是 $\mathcal{E}$ 中哈希值 $a_{h,j}$ 在矩阵 $A$ 的第 $j$ 列中最小的元素 $h$。

**草图更新**
Histoscketch 使新数据到达时可以快速更新草图。在时间 $t + 1$，它基于加权直方图 $L$、前一个草图 $S(t)$ 及其对应的哈希值 $A(t)$、新数据项 $x_{t+1}$ 和权重衰减因子 $\lambda$ 增量地更新草图 $S(t + 1)$。算法4详细描述了这一过程。

**算法4: 更新图草图**

**输入**: $L, S(t), A(t), x_{t+1}, \lambda$

**输出**: 新草图 $S(t + 1)$ 及其对应的哈希值 $A(t + 1)$

```plaintext
foreach h in E do
    /* 指数衰减 */
    L_h = L_h(t) * exp(-λ)
for j from 1 to |S| do
    if x_{t+1} in E then
        L_{x_{t+1}} = L_{x_{t+1}} + 1
    else
        E = E + {x_{t+1}}
        L_{x_{t+1}} = 1
    计算 a_{x_{t+1},j}
    if a_{x_{t+1},j} < A_j(t) * exp(-λ) then
        S_j(t + 1) = x_{t+1}
        A_j(t + 1) = a_{x_{t+1},j}
    else
        S_j(t + 1) = S_j(t)
        A_j(t + 1) = A_j(t) * exp(-λ)
    /* 见算法3 */
```

#### C. 度量指标
我们用 $fp$ 表示假阳性，$fn$ 表示假阴性，$tp$ 表示真阳性，$tn$ 表示真阴性。

**定义3**:
\[ \text{precision} = \frac{tp}{tp + fp} \]

**定义4**:
\[ \text{recall} = \frac{tp}{tp + fn} \]

精度和召回率衡量分类的相关性，其中精度是精确性的度量，召回率是完整性的度量。

**定义5**:
\[ \text{accuracy} = \frac{tp + tn}{tp + tn + fp + fn} \]

**定义6**:
\[ \text{F-score} = \frac{2 \times \text{precision} \times \text{recall}}{\text{precision} + \text{recall}} \]

F-score 通过精度和召回率的调和平均值来综合它们。在我们的测量中，召回率和精度被同等加权。

---