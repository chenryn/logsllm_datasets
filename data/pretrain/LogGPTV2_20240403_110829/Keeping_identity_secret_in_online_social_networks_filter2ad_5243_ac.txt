1 h
If ID is not accepted, return ⊥
X ← gα
sGi , rGi , t
A ← (g1IDh
B gβ2t
P0 = gα
−t
P2 = g
B
xDO +sGi
B hB )t;
B ; P1 = (gβID
rGi
2
)
1
Figure 2: Joining in A Group Protocol
DO(D, pkDO, skDO)
generate ACL and RL for D
$← Zp
s
for i = 1, · · · , r do
choose random s1, · · · , sr−1
such that sr = s − s1 − · · · − sr−1
F1 = Findexe(gB , gB )αsD; F2 = gs
For each j = 1, 2, · · · , r do
B
(Cj,1 = g
βsj
B , Cj,2 = (g
β2IDj
B
hβ
B )sj )
U pload()
(ACL, RL)
−−−−−−−−→
(Eindex, Findex)
←−−−−−−−−−−−−
{F1, F2, (Cj,1, Cj,2)r
j=1}
−−−−−−−−−−−−−−−−−−→
DB(ACL, pkDB , skDB )
1
If it is the ﬁrst data DB received
index ← 1
Parse ACL as (G1, · · · , Gl(cid:48) )
xe+index+Pl(cid:48)
Eindex ← g
Findex ← e(h, Eindex)
index ← index + 1
publishes Lindex =
(Eindex, F1, F2, (Cj,1, Cj,2)r
j=1 xjGj
j=1, ACL, RL)
Figure 3: Uploading Data Protocol
Retrieve()
DB(skDB , pkDB )
(K, count)
←−−−−−−−
if (count = 0)
R ← e(h, K)
P K{(h) : M = e(g, h)}
−−−−−−−−−−−−−−−−−→
( ˜Ai, ˜g1i , ˜yi, ˜h0i , ˜h1i , ˜h2i )i=1,··· ,l(cid:48) , ZKP
←−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−
R, P K{(h) : M = e(g, h)V R = e(h, K)}
−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−−→
$← ˜G;
V (σ, stV , pkDO, pkDB , Lσ)
Parse stV as (zV , P, count, G, Cred, P )
If ACL (cid:42) G or ID ∈ RL then break
k(cid:48) $← Zp; K ← (Eσ)k(cid:48)
count ← 1
Parse ACL as {G1, · · · , Gl(cid:48)}
u
For i = 1, · · · , l(cid:48) do
t1i , t2i , t3i , t4i , t5i , t6i
γi, δi, ηi, i, φi, ψi
˜Ai ← AGi uγi ; ˜g1i ← g1uδi ˜yi ← yDOuηi ; ˜h0i =
h0ui ; ˜h1i = h1uφi ; ˜h2i = h2uψi ;
D ← F1,σ e(P1,Qr
D ←
F1,σ e(P1,Qr
)e(P2,Qr
ID−IDi
i,1
k(cid:48) e(F2,σ ,P0)
)e(P2,Qr
ID−IDi
i,1
k(cid:48) e(F2,σ ,P0)
ID−IDi
i,2
ID−IDi
i,2
$← Zp
$← Zp
i=1 C
i=1 C
i=1 C
1
R
1
R
1
)
1
i=1 C
)
1
1
Figure 4: Retrieving Data Protocol
alizes the functionalities in Section 2.3. In other words, for
an environment ξ and any adversary A, there exists an ideal
world simulator Sim such that
Realξ,A(k) − Idealξ,Sim(k) ≤ (k),
where (k) is a negligible function in k.
Due to space limit, the proof of this theorem is presented in
our technical report [13].
6. PERFORMANCE EVALUATION
We implemented our protocols on a laptop with dual 2.40
GHz CPUs and 2G memory. In order to generate pairing
groups and bilinear map, our implementation used a Pairing-
Based Cryptography (PBC) library, developed by Lynn [10].
Since our protocols mainly consist of broadcast encryp-
tion, ACL signature, credential signature, and zero-knowledge
proofs, the purpose of our experiments was to test the per-
formance of these four primitives. The underlying elliptical
curve used in our implementation is y = x3 + x with an em-
bedding degree of 2. We chose the group size k, equalling
to 32, 64, 128, 256 and 512 bits. Figure 5 shows the running
time of the four primitives.
The X-coordinate of Figure 5(a) is the number of revoked
visitors, r. In our implementation, r is from 16 to 256 with
increment of 16. From the ﬁgure, we observe that if r is 50,
the running time of the algorithm with variant group size
is less than 5 seconds. This is fast for real-life usage, since
the data owner usually does not add so many people in a
revocation list.
The X-coordinate of Figure 5(b) corresponds to l(cid:48) in our
protocol, representing the number of credentials a visitor
needs to access the data. The range is from 4 to 64 with
increment of 4. From the ﬁgure we can see that when k =
(a) Broadcast Encryption
(b) Zero-knowledge Proofs
(c) ACL Signature
(d) Credential Signature
Figure 5: Running Time
512, it takes about 15 seconds to prove 40 credentials.
Figure 5(c) shows the running time of ACL signature in
uploading data protocol. From the ﬁgure we observe that
when the value k keeps constant, the running time does not
change very much across diﬀerent group size.
The X-coordinate of Figure 5(d) represents the number
of credentials DO needs to sign when uploading a piece of
data. In our implementation, the range is from 4 to 64 with
increment of 4. We can see that when k = 512, it takes less
than 3.5 seconds to sign 64 credentials at one time.
7. RELATED WORK
Privacy issues, especially anonymity issues, in OSNs are
signiﬁcant to their development. However, few works stud-
ied the anonymity issues. Sun et al. [12] proposed a privacy-
preserving scheme for OSNs.
In their work, the authors
presented a scheme to protect data privacy with regard to
the data stored in third party storage site. Public key en-
cryption with keyword search scheme and identity-based en-
cryption are used to enable a user with proper role to eﬃ-
ciently retrieve the data stored in the storage site. However,
their work did not provide an identity concealing mecha-
nism. Baden et al. designed a scheme called Persona which
allows a user to deﬁne ﬁne-grained privacy policy and au-
thorize her friends to access the users’ records depends on
which group the friend belongs to [2]. They used attribute
based encryption to achieve the access control. However,
they did not deal with the identity concealing and revoca-
tion issues. In [11], Squicciarini et al. leveraged game theory
to achieve cooperative privacy management on shared data.
In [6], Camenisch introduced a protocol which could hide
users’ identity from database. As we said in the introduc-
tion part, their access control policy is static, which is not
suitable for the OSN circumstance.
8. CONCLUSION
In this paper, we have proposed a system which can hide
visitors’ identities and the index of the data when they visit
the storage site. Using zero-knowledge proof based oblivious
transfer, the storage site can verify visitors’ credentials with-
out leaking the private information of the signer. We have
designed a group-based ACL for the data owner to freely
determine which group of friends can access the data.
In
addition, we have designed an RL which enables the data
owner to revoke individuals from future accessing. We have
proved the security of our system using UC framework and
demonstrated the eﬃciency of our system..
9. REFERENCES
[1] M. Au, W. Susilo, and Y. Mu. Constant-size dynamic
k-taa. In R. De Prisco and M. Yung, editors, Security
and Cryptography for Networks, volume 4116 of
Lecture Notes in Computer Science, pages 111–125.
Springer Berlin / Heidelberg, 2006.
10.1007/11832072 8.
[2] R. Baden, A. Bender, N. Spring, B. Bhattacharjee,
and D. Starin. Persona: an online social network with
user-deﬁned privacy. SIGCOMM Comput. Commun.
Rev., 39(4):135–146, Aug. 2009.
[3] D. Boneh and X. Boyen. Short signatures without
random oracles. In C. Cachin and J. Camenisch,
editors, Advances in Cryptology - EUROCRYPT 2004,
volume 3027 of Lecture Notes in Computer Science,
pages 56–73. Springer Berlin / Heidelberg, 2004.
[4] D. Boneh, C. Gentry, and B. Waters. Collusion
resistant broadcast encryption with short ciphertexts
and private keys. In V. Shoup, editor, Advances in
Cryptology ? CRYPTO 2005, volume 3621 of Lecture
Notes in Computer Science, pages 258–275. Springer
Berlin / Heidelberg, 2005.
[5] J. Camenisch. Group signature schemes and payment
systems based on the discrete logarithm problem.
Citeseer, 1998.
[6] J. Camenisch, M. Dubovitskaya, and G. Neven.
Oblivious transfer with access control. In Proceedings
of the 16th ACM conference on Computer and
communications security, CCS ’09, pages 131–140,
New York, NY, USA, 2009. ACM.
[7] J. Camenisch, A. Kiayias, and M. Yung. On the
portability of generalized schnorr proofs. Advances in
Cryptology-EUROCRYPT 2009, pages 425–442, 2009.
[8] R. Canetti. Universally composable security: a new
paradigm for cryptographic protocols. In Foundations
of Computer Science, 2001. Proceedings. 42nd IEEE
Symposium on, pages 136 – 145, oct. 2001.
[9] A. Lewko, A. Sahai, and B. Waters. Revocation
systems with very small private keys. In Security and
Privacy (SP), 2010 IEEE Symposium on, pages 273
–285, may 2010.
[10] B. Lynn. The pairing-based cryptography (pbc)
library. http://crypto.stanford.edu/pbc/.
[11] A. C. Squicciarini, M. Shehab, and F. Paci. Collective
privacy management in social networks. In Proceedings
of the 18th international conference on World wide
web, WWW ’09, pages 521–530, New York, NY, USA,
2009. ACM.
[12] J. Sun, X. Zhu, and Y. Fang. A privacy-preserving
scheme for online social networks with eﬃcient
revocation. In INFOCOM, 2010 Proceedings IEEE,
pages 1 –9, march 2010.
[13] X. Zhao, L. Li, and G. Xue. Keeping identity secret in
online social networks. Technical report, Arizona State
University, 2012. http://www.public.asu.edu/
~xzhao32/paper/oblivious_accesscontrol.pdf.