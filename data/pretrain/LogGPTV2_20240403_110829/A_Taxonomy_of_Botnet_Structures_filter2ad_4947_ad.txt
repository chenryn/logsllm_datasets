γ
3.18
3.16
3.14
3.12
0.019
0.018
0.017
0.016
0.015
0.014
0.013
3.1
0
20
40
c
60
80
100
0.012
0
20
40
60
80
100
c
γ
γ
0.015
0.014
0.013
0.012
0.011
0.01
0
0.015
0.014
0.013
0.012
0.011
0.01
0
x 10−3
3.2
3.18
3.16
3.14
3.12
3.1
3.08
1
−
L
0.06
0.05
0.04
m=16
m=8
m=4
m=2
10
5
15
# random loss
20
0
10
5
15
# random loss
20
γ
0.03
x 10−3
3.2
3.18
3.16
3.14
3.12
3.1
3.08
1
−
L
10
5
15
# target loss
20
0
10
5
15
# target loss
20
0.02
0.01
0
0
50
c
100
150
(a) Scale Free Properties
(b) Loss in Scale Free Networks
(c) Scale Free Networks and Transitivity
Figure 3. (a) Changes in diameter and transitivity vs. core size, for a 5K scale free botnet. (b) Loss
in scale free networks. (c) Changes in link count for leaves in a scale free network.
(a) Nugache Worm Link Distribution
(b) Nugache Victim Joins over Time
Figure 4. Measurements of (a) link degree in Nugache and (b) joins observed over time.
unstructured P2P networks) do not signiﬁcantly degrade the
network. Figure 3(b) shows that random losses fail to sig-
niﬁcantly reduce either the diameter or transitivity values.
Of course, we were unable to measure the entire popu-
lation, s, of the nugache network using our data collection
technique. Figure 4(b) illustrates the problem. This ﬁgure
plots the rate of new SYN+ACK connections observed by
our batch WINE nodes. This is therefore a rough measure
of the rate of new link creation, which may or may not cor-
respond to the rate of new victims being recruited. (That
is, a new SYN+ACK may represent an old nugache victim
we’ve just discovered, or a new victim joining for the ﬁrst
time.) Since we did not catch nugache in its early forma-
tion, or successfully inject our honeypots into the inner ring
of high-degree nodes, we saw only a small number of po-
tentially new victims over the study period.
ues is a complex undertaking. We believe our analysis
shows that our proposed metrics are both practical and use-
ful. However, we leave for future work the design of effec-
tive data collection techniques for P2P networks (whether
structured or unstructured). Given the often stealthy cre-
ation of such networks, we expect this may remain a chal-
lenging problem for researchers.
3.4 Empirical Analysis
Our taxonomy also suggested that available bandwidth
B is a useful metric for botnet utility. We again note that
bandwidth estimation for end-to-end hosts is a complex
task. Nonetheless, to show the utility of our proposed met-
ric, we estimated the available average bandwidth in two
botnets.
As the authors in [47] noted, measuring population val-
Using techniques described in [16], we measured one
333333
botnet of approximately 50,000 unique members in Febru-
ary 2005, and estimated the bandwidth of 7,326 bots cho-
sen in a uniformly random manner. Likewise, we measured
the bandwidth of a 3,391 member subsample from a 48,000
member botnet in January of 2006.
We used the tmetric [7] tool to perform the band-
width estimation. tmetric essentially uses successively
larger probes to estimate the bandwidth to a host. We used
a high-capacity link (OC-48) close to our network’s core
routers, so that we were more likely to measure the end
host’s available bandwidth, rather than any limitations in
our internal network. Dozens of probes sent over minutes
were used to obtain an average. Again, we note that the net-
working community has developed far more sophisticated
techniques to estimate bandwidth end-to-end. We believe
our simple measurements were useful to quickly obtain a
ﬁrst order approximation of the average bandwidth in an
entire distributed network.
Figure 5(a) and (b) show the distribution of bandwidth,
with min/max and average bandwidth values observed dur-
ing the probes. Table 2 shows the average available band-
width (that the botmaster can utilize) from a single bot. Us-
ing Eq(1) and without considering the diurnal sensitivity,
we can calculate the average available bandwidth for bot-
master to use on one bot is around 53.3004 Kbps. For data
set 2, the average is 34.8164 Kbps, a few less than the ﬁrst
case.
But when accounting for diurnal sensitivity, and assum-
ing the average online times for each class of bots is [2, 4,
24] hours, then the ﬁnal average bandwidth for botmaster on
one bot is 22.7164 Kbps. If a botnet has a size of 50K, then
on average the botmaster consistently has more than 1Gbps
bandwidth on average at anytime. This suggests the botnet
could easily launch a successful denial of service attack on
almost any web site. (Indeed, during our period of obser-
vation, the 50K member botnet did DDoS several websites
that only had 100Mbs transit.) For data set 2, the weighted
bandwidth is 14.6378 Kbps– comparatively lower.
The metric therefore reveals something counter-intuitive
about botnets. Just looking at the sampled bandwidth in
Figure 5(a) and (b), it seems that the botnets have roughly
the same maximum bandwidth, and the same number of
bots, and therefore have the same general utility from a
DDoS perspective. When accounting for diurnal changes
in populations, however, the second botnet (plotted in Fig-
ure 5(b)) has approximately half the average available band-
width, despite having only 2,000 less members than the
other network. If network administrators had to select be-
tween these two botnets and prioritize a single response ef-
fort, the simple bandwidth estimate B shows a higher utility
in the botnet in Figure 5(a).
Our bandwidth estimate metric may have other uses be-
sides priority ranking botnets. This exercise suggests that
diurnal changes in botnet membership can signiﬁcantly af-
fect a botnet’s utility as a DDoS vehicle. We leave for future
work an analysis of how this metric can be leveraged in a
targeted attack on a botnet. That is, we speculate that re-
sponders might signiﬁcantly reduce a botnet’s DDoS poten-
tial by targeting the “high-speed” members of a botnet. The
bandwidth B metric should let researchers measure their
progress in such a response, and tell them how many more
high-speed members must be removed, relative to the mix
of low-speed members, for a given estimated diurnal usage
pattern.
4 Related Work
Our work ﬁts into the larger body of literature address-
ing the statistical mechanics of complex networks [4]. Oth-
ers have studied the brittle nature of scale-free networks and
resilience of random networks in other contexts [5, 23, 40].
Our work adapts these ﬁndings to the particular domain of
botnets. The topology of networks under active decay was
analyzed in [40]. Many of the results in [40] anticipate our
own. The authors took a fascinating look at all domains of
network structures (e.g., including terror cells, and global
history), and not just computer networks. By restricting our
analysis to botnets, we identiﬁed several unique and inter-
esting phenomena not considered in [40]. For example, the
authors in [40] suggest a strategy of splitting high-degree
nodes to avoid targeted responses. This is analogous to in-
creasing C in scale free networks, discussed in 3. Since
we focused on the botnet domain, we were able to further
observe that this results in a degraded transitivity.
Botnet research is still maturing. The work in [13] antic-
ipated many of the general categories of botnets analyzed
in Section 2, including the difﬁculty in responding to dif-
ferent type of botnet taxonomies. The models and empiri-
cal data we presented in Section 2 ﬂesh out and formalize
the intuitive discussion in [13]. Recently, advanced botnets
with complex network structures have been studied. Vogt,
et al. [54] presented a super-botnet, the network of many
independent, small botnet, which is a special case of a ran-
dom graph botnet. Wang, et al. [55] introduced an advanced
hybrid peer-to-peer botnet. Grizzard, et al. [19] provided an
overview of P2P botnet and a case study of a speciﬁc bot.
There have been several works on botnet measurement.
In [17, 46], the authors used honeynets to track existing
IRC-based botnets and report a few simple statistics about
botnets. Rajab, et al., [47], argue that the estimation of bot-
net size is actually hard in practice, and call for further re-
search on the measurement of botnets. We believe our anal-
ysis in Sections 2 and 3 help with this problem. Wang,
et al. [55], propose two metrics, connection ratio and de-
gree ratio, to measure the resilience of removing mostly-
connected bots from a botnet.
In this paper, we propose
334334
 1600
 1400
 1200
 1000
 800
 600
 400
 200
s
t
o
B
f
o
r
e
b
m
u
N
Sample Botnet Bandwidth Estimate
 Fri Feb 11 09:39:40 EST 2005 
 (Sample n = 7326 of approx. 50K)
Sample Botnet Bandwidth Estimate 2
average bandwidth
minimum bandwidth
maximum bandwidth
average bandwidth
minimum bandwidth
maximum bandwidth
 1000
 900
 800
 700
 600
 500
 400
 300
 200
 100
s
t
o
B
f
o
r
e
b
m
u
N
 0
 0
 100
 200
 300
Bandwidth (kbps)
 400
 500
 0
 0
 100
 200
 300
Bandwidth (kbps)
 400
 500