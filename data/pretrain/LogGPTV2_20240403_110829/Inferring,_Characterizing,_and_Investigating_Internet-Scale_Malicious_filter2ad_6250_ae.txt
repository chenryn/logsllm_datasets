5
4
6
1
7
8
7
5
8
2
9
Interval (143 Hours)
9
9
6
0
1
3
1
1
0
2
1
7
2
1
4
3
1
1
4
1
Fig. 10. The distribution of TCP scanning packets generated by exploited
IoT devices towards the top 5 targeted protocols/services.
the next 30 hours (average of approximately 200,000 TCP
scanning packets per hour). We also compared this suspicious
activity against Cymon, and conﬁrmed that
it was being
involved in malicious scanning activities.
HTTP. A total of 1,763 compromised IoT devices scanned
HTTP ports, among which about 80% are consumer IoT
devices. Moreover, these compromised consumer devices con-
tributed towards the the majority (94.5%) of the scanning
packets targeting HTTP ports, with an hourly average of about
62 thousand generated scanning packets from 415 exploited
devices. It is interesting to see that despite the gradual increase
in the number of generated scanning packets towards HTTP
ports after interval 92 (Figure 10), the overall distribution of
the scanning packets illustrates a more organized and uniform
scanning behavior that does not involve noticeable behavioral
changes from the compromised IoT devices. This behavior
however, might be resulting from orchestrated stealthy scans
generated by compromised IoT devices towards the Internet.
Proving this would require further investigations and will be
considered for future work.
CWMP. The CPE WAN Management Protocol (CWMP) is
a web-based protocol that enables remote conﬁguration and
management of routers, gateways, and other IoT devices [36].
More importantly, CWMP was utilized by some variants of
the Mirai botnet
to exploit routers [3]. A total of 413
compromised IoT devices, among which 59% were CPS-
related, generated more than 4M TCP scanning packets to-
wards CWMP (Table V). On average, CWMP was scanned
by 36 compromised IoT devices, generating more than 31,000
scanning packets per hour. As illustrated in Figure 10, these
scans had the least variations in terms of magnitude of the
generated packets during the analysis interval. Despite that, we
noticed an exploited router, which was located in Australia,
to generate relatively more scanning packets (10.6%), as
compared to other compromised IoT devices. Moreover, a total
of 5 exploited CPS-related IoT devices were also found to
generate relatively more packets than those others deployed in
other CPS, representing a total of about 25% of all scanning
trafﬁc on CWMP. Three of these devices, which supported
Ethernet/IP (used in manufacturing automation), were hosted
570
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
%
F
D
C
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
0.001K
IoT devices
Malicious IoT devices
0.01K
0.1K
1K
10K
Total Packets
100K
1000K 10000K
Fig. 11. Distribution of received packets from the top 8, 839 IoT devices and
the malicious devices ﬂagged by Cymon (N = 816).
in Korea. The remaining two devices, which were used in
control systems (SNC GENe) and oil and gas transportation
pipelines and distribution networks (Telvent OASyS DNA),
were located in China and South Africa, respectively. Finally,
all but two of the aforementioned compromised IoT devices
were conﬁrmed to be performing malicious scanning of the
Internet using Cymon.
V. ANALYZING THE MALICIOUSNESS OF UNSOLICITED
INTERNET-SCALE IOT DEVICES
In this paper, we identiﬁed a large number of compro-
mised/exploited IoT devices while characterizing their unso-
licited trafﬁc, which pinpointed to some malicious scanning
activities. Motivated by these ﬁndings, and the plethora of
IoT-centric malware that are currently “in the wild” (e.g.,
Mirai and Hajime), in this section, we aim at exploring
the maliciousness of the inferred IoT devices by investigating:
(1) whether such IoT devices are involved in other illicit
activities, and (2) whether there exists other malware families
and variants that could possibly be exploiting such IoT devices.
A. IoT Illicit Activities
To investigate the involvement of such IoT devices in
malicious activities, we relied on a publicly available cyber-
threat intelligence service provided by Cymon [35]. The latter
renders a service to track and aggregate Internet-scale events
related to IP addresses and domains, which are involved
in malware, phishing, botnets, spamming, DNS blacklisting,
scanning, and web attacks. We investigated the malicious
activities associated with 8,839 exploited IoT devices, which
represent all devices that generated backscatter trafﬁc (839
DoS victims), and the top 4,000 compromised IoT devices
with the most generated scanning and UDP packets from each
IoT device category (consumer and CPS). As presented in
Figure 11, about 10% of the explored IoT devices sent 50
or less packets to the darknet, while only 15% of them sent
10,000 packets or more during the analysis interval. In fact,
while less than 2% generated 100,000 packets or more, only 15
devices sent more than 1M packets (max = 6.25M packets).
By correlating the explored IoT devices against
those IP
addresses indexed by Cymon, we uncovered 816 IoT devices
(9.2%) that were linked to one or more malicious activities.
IDENTIFIED THREATS SUMMARY. NOTE THAT THE IDENTIFIED THREATS
ARE NOT MUTUALLY EXCLUSIVE.
TABLE VI
Threat Category
Scanning
Miscellaneous (Web/FTP attacks, DNSBL,
Malicious domains, VoIP)
Brute force (SSH)
Spam (Mail, IMAP)
Malware (Virus, Worm, Bot/Botnet, Trojan)
Phishing
IoT Devices %
96.3
70.3
786
574
252
227
117
5
30.9
27.8
14.3
0.6
We amalgamated the identiﬁed activities into 6 illicit cate-
gories, as summarized in Table VI. It is worthy to note that
the threat categories are not mutually exclusive, since different
sources of cyber threat intelligence (within Cymon) might ﬂag
a given host/IP with multiple malicious activities. The majority
of the identiﬁed malicious IoT devices were associated with
illicit scanning (96.3%). Furthermore, about 70% of the IoT
devices were ﬂagged as miscellaneous (e.g., Web attacks),
while about 31% and 28% were associated with SSH brute
force attacks and spamming respectively. Interestingly, a total
of 117 IoT devices were linked to malware-related activities
(14.3%), while only 5 devices were associated with phishing
activities. Speciﬁcally, our ﬁndings identiﬁed a signiﬁcant
91 IoT devices operating in various CPS realms that were
indeed associated with malware, with the majority (85 devices)
to be involved in TCP scanning activities. Furthermore, 26
consumer IoT devices were linked to malware, with 23 devices
performing scanning activities. It is interesting to observe that
a total of 9 devices (generating the DoS peaks of Figure 7),
were found to be related to malware as well.
B. IoT-Centric Malware Families
Given the fact that we have identiﬁed 117 IoT devices
that were related to malware, we attempted herein to further
explore this matter. In this context, we relied on an in-
house built database of malware information. The database
is an artifact of conducting large-scale dynamic malware
instrumentation. Indeed, we have been receiving a malware
feed on a daily basis with an average of 30,000 malware
samples from ThreatTrack Security.2 XML reports are
produced by analyzing the malware binaries in a controlled
environment. It is worthy to mention that these reports contain
the executed activities by the malware samples at the network
and system levels. On one hand, the network level activities
refer to the connections and the exchanged packets, including
IP addresses, port numbers, URLs, visited domains and the
actual payload data that has been sent. On the other hand,
the system level activities constitute the list of Dynamic-link
Library (DLL) ﬁles that are utilized by the malware,
the
key registry changes, and the memory usage. The malware
database is built by parsing and indexing such XML malware
reports. We executed correlations (using IP address informa-
tion) between all the inferred unsolicited IoT devices from
2www.threattrack.com
571
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
IDENTIFIED, PREVIOUSLY UNREPORTED MALWARE FAMILIES EXPLOITING
TABLE VII
IOT DEVICES
Malware Family
Ramnit
Starman
Kryptik
Nivdort
Razy
Zusy
Bayrod
Artemis
MSIL
Vupa
Allaple
Section III (i.e., 26,881 devices) and the malware database.
The outcome is intended to demonstrate if any malware variant
has communicated with (possibly exploited) IoT devices.
Our ﬁndings revealed 33 domain names and 24 unique
malware hashes/variants associated with the identiﬁed IoT
devices. Given the extracted malware hashes from the malware
database, we leveraged VirusTotal to unveil 11 malware
families that were found to be associated with the IoT devices.
The uncovered malware families are summarized in Table VII.
While some of the families are already quite popular, such
as the Ramnit as a backdoor, and Zusy for generating
email spam, our results demonstrate that new variants of
such families are already being empowered to target the IoT
paradigm. To the best of our knowledge, such results (i)
render a ﬁrst attempt ever to shed the light on IoT-centric
malware families by correlating passive measurements and
malware samples facilitated through dynamic analysis, (ii)
highlight on new, previously unreported families (and variants)
that have empirically been demonstrated to target the IoT
paradigm, and (iii) alarm about
the rise of new malware
variants, which undoubtedly would facilitate the establishment
of ever-evolving, IoT-tailored, malware-orchestrated botnets.
VI. DISCUSSION
In this section, we elaborate on a few topics that are worthy
of being discussed in the context of the proposed work.
Comprehensively inferring Internet-scale unsolicited IoT
devices. While this work leveraged the Shodan service to
gather a large dataset of IP information related to deployed
IoT devices in order to facilitate their correlation with passive
measurements, identifying technical information for Internet-
wide IoT devices remains a challenging objective. Indeed,
without addressing this issue at
large, approaches similar
to the one presented in this paper would remain partially
lacking (at least operationally). In this context, we foresee two
approaches moving forward. The ﬁrst is of technical nature
and is rendered by exploring fuzzy matching algorithms and
fuzzy hashes/signatures to identify a broader range of IoT
devices (previously not indexed by Shodan) as perceived
by the network telescope by leveraging IoT-relevant darknet
trafﬁc (from previously inferred IoT devices). The second is
a non-technical approach, requiring ISPs, local IoT operators
and industry to collaborate to make such IoT information
available. Indeed, the authors are already in touch with Cisco
Systems to have access to their IoT platform dubbed as
Jasper, for a larger corpus of IoT device information. The
vision is that threat intelligence from the proposed work will
be fed back to Cisco Jasper.
Malware attribution for tailored remediation. With the
continuous rise of new malware variants that speciﬁcally target
IoT devices in consumer and critical CPS sectors, the objective
to attribute such exploitations to certain malware variants is
undeniably of high signiﬁcance. While this work provided
initial results from such attempt, further exploration is needed.
To this end, we are currently exploring formal correlation ap-
proaches between passive measurements and malware network
trafﬁc samples to fortify the attribution evidence.
Real-time IoT operational cyber security capabilities and
artifacts. IoT-tailored actionable cyber security capabilities are
quite lacking and we hope that this work would motivate
the research and operational communities to devise such
capabilities. In fact, we are currently working to automate
the devised methodologies in this work to index,
in near
real-time, unsolicited Internet-scale IoT devices. We are also
working on creating an authenticated API to share IoT-relevant
malicious empirical data, IoT-centric attack signatures, and
threat intelligence derived from passive measurements with
the research community at large.
VII. CONCLUSION
The Internet of Things (IoT) is an emerging paradigm of
technical, social, and economic signiﬁcance. Nevertheless, the
initial priorities of IoT vendors have been focused on pro-
viding novel functionality, getting products to market sooner,
and making IoT devices more accessible and easier to use.
Unfortunately, security concerns have not received as much
attention. To this end, this paper presented a ﬁrst empirical
look at the magnitude of compromised IoT devices that have
been deployed in both consumer and CPS realms. Initially,
large-scale correlations between passive measurements and
IoT-relevant information is conducted to shed the light on
Internet-wide unsolicited IoT devices. Subsequently, empirical
measurements, characterization, and analysis is presented to
thoroughly investigate IoT-generated unsolicited trafﬁc,
in-
cluding backscattered trafﬁc from IoT devices that have been
targeted by DoS attacks, and scanning activities from exploited
IoT devices. Finally, an attempt
is made to uncover the
maliciousness of such unsolicited IoT devices by utilizing
a publicly available threat repository and an in-house built
malware database. Some of the outcomes include more than
15,000 compromised consumer IoT devices and more than
11,000 compromised IoT devices operating in critical CPS
(including oil and gas, manufacturing plants and power utili-
ties). The results also demonstrate the aggressiveness of more
than 5,000 compromised IoT devices in CPS in exploiting
other services. The outcome also pinpoints the involvement of
a large number of IoT devices in malevolent activities as well
572
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply. 
as the rise of new malware variants that speciﬁcally target the
IoT paradigm. Overall, the presented measurements from this
work highlight, at large, the insecurity of the IoT paradigm. As
for future work, apart from addressing a number of tasks and
issues that have been pinpointed throughout this paper, we are
working on addressing the challenging problem of identifying
and clustering IoT botnets and their illicit activities by solely
scrutinizing passive measurements.
ACKNOWLEDGMENT
The authors would like to express their sincere gratitude
to the anonymous reviewers for their constructive feedback.
The work has been partially supported by Natural Sciences
and Engineering Research Council of Canada (NSERC) and
Concordia University. This work was also partially supported
by a grant from the U.S. National Science Foundation (NSF)
(Ofﬁce of Advanced Cyberinfrastructure (OAC) #1755179).
REFERENCES
[1] Kyoung-Dae Kim and Panganamala R Kumar. Cyber–Physical Systems:
A Perspective at the Centennial. Proceedings of the IEEE 100, (Special
Centennial Issue):1287–1308, 2012.
[2] Jacob Wurm, Khoa Hoang, Orlando Arias, Ahmad-Reza Sadeghi, and
Yier Jin. Security Analysis on Consumer and Industrial IoT Devices. In
21st Asia and South Paciﬁc Design Automation Conference (ASP-DAC),
pages 519–524. IEEE, 2016.
[3] Manos Antonakakis, Tim April, Michael Bailey, Matt Bernhard, Elie
Bursztein, Jaime Cochran, Zakir Durumeric, J. Alex Halderman, Luca
Invernizzi, Michalis Kallitsis, Deepak Kumar, Chaz Lever, Zane Ma,
Joshua Mason, Damian Menscher, Chad Seaman, Nick Sullivan, Kurt
Thomas, and Yi Zhou. Understanding the Mirai Botnet. In 26th USENIX
Security Symposium, pages 1093–1110, Vancouver, BC, 2017.
[4] Wired Andy Greenberg. The reaper IoT botnet has already infected
a million networks. Online: https://www.wired.com/story/reaper-iot-
botnet-infected-million-networks/, 2017.
[5] Tianlong Yu, Vyas Sekar, Srinivasan Seshan, Yuvraj Agarwal, and
Chenren Xu. Handling a trillion (unﬁxable) ﬂaws on a billion devices:
Rethinking network security for the Internet-of-Things. In Proceedings
of the 14th ACM Workshop on Hot Topics in Networks, page 5. ACM,
2015.
[6] Craig Labovitz, Abha Ahuja, and Michael Bailey. Shining Light on Dark
Address Space. Arbor Networks Inc., 2001.
[7] Claude Fachkha, Elias Bou-Harb, Anastasis Keliris, Nasir Memon, and
Mustaque Ahamad. Internet-scale Probing of CPS: Inference, Character-
ization and Orchestration Analysis. In Proceedings of the Network and
Distributed System Security Symposium (NDSS), San Diego, California,
2017.
[8] Claude Fachkha and Mourad Debbabi. Darknet as a Source of Cyber
Intelligence: Survey, Taxonomy, and Characterization. IEEE Communi-
cations Surveys & Tutorials, 18(2):1197–1227, 2016.
[9] Elias Bou-Harb, Mourad Debbabi, and Chadi Assi. On Fingerprinting
Probing Activities. Computers & Security, 43:35–48, 2014.
[10] Zakir Durumeric, Michael Bailey, and J Alex Halderman. An Internet-
In Proceedings of the 23rd
Wide View of Internet-Wide Scanning.
USENIX Security Symposium, pages 65–78, San Diego, CA, 2014.
[11] Nobuaki Furutani, Tao Ban, Junji Nakazato, Jumpei Shimamura, Jun
Kitazono, and Seiichi Ozawa. Detection of DDoS Backscatter Based on
Trafﬁc Features of Darknet TCP Packets. In Ninth Asia Joint Conference
on Information Security (ASIA JCIS), pages 39–43. IEEE, 2014.
[12] Eray Balkanli and A Nur Zincir-Heywood. On the Analysis of Backscat-
ter Trafﬁc. In Local Computer Networks Workshops (LCN Workshops),
2014 IEEE 39th Conference on, pages 671–678. IEEE, 2014.
[13] Norbert Blenn, Vincent Ghi¨ette, and Christian Doerr. Quantifying the
Spectrum of Denial-of-Service Attacks Through Internet Backscatter.
In Proceedings of the 12th International Conference on Availability,
Reliability and Security, ARES ’17, pages 21:1–21:10, Reggio Calabria,
Italy, 2017.
[14] Eduard Glatz and Xenofontas Dimitropoulos. Classifying Internet
In Proceedings of the 2012 Internet Measurement
One-way Trafﬁc.
Conference, IMC ’12, pages 37–50, Boston, MA, USA, 2012.
[15] Yunhan Jack Jia, Qi Alfred Chen, Shiqi Wang, Amir Rahmati, Earlence
Fernandes, Z Morley Mao, Atul Prakash, and Shanghai JiaoTong Unvier-
sity. ContexIoT: Towards Providing Contextual Integrity to Appiﬁed IoT
Platforms. In Proceedings of the 21st Network and Distributed System
Security Symposium (NDSS’17), 2017.
[16] Earlence Fernandes, Justin Paupore, Amir Rahmati, Daniel Simionato,
Mauro Conti, and Atul Prakash. FlowFence: Practical Data Protection
for Emerging IoT Application Frameworks.
In USENIX Security
Symposium, 2016.
[17] Blase Ur, Jaeyeon Jung, and Stuart Schechter. The Current State of
In Workshop on Home
Access Control for Smart Devices in Homes.
Usable Privacy and Security (HUPS), 2013.
[18] Eyal Ronen and Adi Shamir. Extended Functionality Attacks on IoT
Devices: The Case of Smart Lights. In IEEE European Symposium on
Security and Privacy (EuroS&P), pages 3–12. IEEE, 2016.
[19] Yin Minn Pa Pa, Shogo Suzuki, Katsunari Yoshioka, Tsutomu Mat-
sumoto, Takahiro Kasama, and Christian Rossow.
IoTPOT: A Novel
Honeypot for Revealing Current IoT Threats. Journal of Information
Processing, 24(3):522–533, 2016.
[20] Juan David Guarnizo, Amit Tambe, Suman Sankar Bhunia, Mart´ın
Ochoa, Nils Ole Tippenhauer, Asaf Shabtai, and Yuval Elovici. Siphon:
Towards Scalable High-Interaction Physical Honeypots. In Proceedings
of the 3rd ACM Workshop on Cyber-Physical System Security, pages
57–68. ACM, 2017.
[21] Steve Bellovin. There Be Dragons. In USENIX Summer, 1992.
[22] Steven M Bellovin. Packets Found on an Internet. ACM SIGCOMM
Computer Communication Review, 23(3):26–31, 1993.
[23] David Moore, Colleen Shannon, Douglas J Brown, Geoffrey M Voelker,
and Stefan Savage. Inferring Internet Denial-of-Service Activity. ACM
Transactions on Computer Systems (TOCS), 24(2):115–139, 2006.
[24] David Moore, Vern Paxson, Stefan Savage, Colleen Shannon, Stu-
art Staniford, and Nicholas Weaver.
the Sap-
phire/Slammer Worm. https://www.caida.org/publications/papers/2003/
sapphire/sapphire.html, 2003.
The Spread of
[25] Michael Bailey, Evan Cooke, Farnam Jahanian, David Watson, and Jose
Nazario. The Blaster Worm: Then and Now. IEEE Security and Privacy,
3(4):26–31, July 2005.
[26] Kriangkrai Limthong, Fukuda Kensuke, and Pirawat Watanapongse.
Wavelet-based unwanted trafﬁc time series analysis.
In International
Conference on Computer and Electrical Engineering (ICCEE), pages
445–449. IEEE, 2008.
[27] Alberto Dainotti, Alistair King, kc Claffy, Ferdinando Papale, and
Antonio Pescap`e. Analysis of a “/0” Stealth Scan from a Botnet.
In
Proceedings of the 2012 Internet Measurement Conference, IMC ’12,
pages 1–14, 2012.
[28] Claude Fachkha, Elias Bou-Harb, and Mourad Debbabi. Fingerprinting
Internet DNS Ampliﬁcation DDoS Activities. In the 6th International
Conference on New Technologies, Mobility and Security (NTMS), pages
1–5. IEEE, 2014.
[29] Christian Rossow. Ampliﬁcation Hell: Revisiting Network Protocols
In Symposium on Network and Distributed System
for DDoS Abuse.
Security (NDSS), 2014.
[30] Shodan. https://www.shodan.io/.
[31] Elias Bou-Harb, Chadi Assi, and Mourad Debbabi. CSC-Detector: A
System to Infer Large-Scale Probing Campaigns. IEEE Transactions on
Dependable and Secure Computing, 2016.
[32] UCSD Real-time Network Telescope Data. provided by the UCSD -
Center for Applied Internet Data Analysis. Available online at https:
//www.impactcybertrust.org/dataset view?idDataset=206.
[33] Jun Liu and Kensuke Fukuda. Towards a Taxonomy of Darknet Traf-
ﬁc. In International Wireless Communications and Mobile Computing
Conference (IWCMC), pages 37–43. IEEE, 2014.
[34] Tim Yeh.
Netis Routers Leave Wide Open Backdoor.
http://blog.trendmicro.com/trendlabs-security-intelligence/netis-routers-
leave-wide-open-backdoor/, August 2014.
[35] Cymon Open Threat Intelligence. https://cymon.io/.
[36] John Blackford and Mike Digdon.
TR-069: CPE WAN Manage-
ment Protocol. https://www.broadband-forum.org/technical/download/
TR-069 Amendment-5.pdf, November 2013.
573
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:49:07 UTC from IEEE Xplore.  Restrictions apply.