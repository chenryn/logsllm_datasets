### TCP Scanning Activity by Compromised IoT Devices

**Figure 10. Distribution of TCP Scanning Packets Generated by Exploited IoT Devices Targeting the Top 5 Protocols/Services.**

The compromised IoT devices generated a significant amount of TCP scanning packets over the next 30 hours, with an average of approximately 200,000 packets per hour. This suspicious activity was cross-referenced with Cymon, confirming its involvement in malicious scanning activities.

#### HTTP
- **Total Devices**: 1,763 compromised IoT devices scanned HTTP ports.
- **Consumer IoT Devices**: Approximately 80% of these were consumer IoT devices.
- **Scanning Packets**: These consumer devices contributed to 94.5% of the total scanning packets targeting HTTP ports, generating an average of about 62,000 packets per hour from 415 exploited devices.
- **Behavioral Analysis**: Despite a gradual increase in the number of scanning packets towards HTTP ports after interval 92 (as shown in Figure 10), the overall distribution indicates a more organized and uniform scanning behavior without noticeable changes. This behavior might be indicative of orchestrated stealthy scans, which would require further investigation for confirmation.

#### CWMP (CPE WAN Management Protocol)
- **Protocol Description**: CWMP is a web-based protocol used for remote configuration and management of routers, gateways, and other IoT devices [36]. It has been utilized by some variants of the Mirai botnet to exploit routers [3].
- **Total Devices**: 413 compromised IoT devices, with 59% being CPS-related, generated over 4 million TCP scanning packets towards CWMP.
- **Average Scans**: On average, 36 compromised IoT devices generated more than 31,000 scanning packets per hour.
- **Distribution Analysis**: The scans showed the least variations in terms of the magnitude of generated packets during the analysis interval.
- **Notable Devices**: An exploited router in Australia generated 10.6% of the scanning packets, significantly more than other compromised IoT devices. Additionally, 5 CPS-related IoT devices, representing 25% of all scanning traffic on CWMP, generated a higher volume of packets. Three of these devices, supporting Ethernet/IP, were hosted in Korea, while the remaining two, used in control systems and oil and gas transportation, were located in China and South Africa, respectively.
- **Malicious Confirmation**: All but two of these compromised IoT devices were confirmed to be performing malicious scanning using Cymon.

### Analyzing the Maliciousness of Unsolicited IoT Devices

#### A. IoT Illicit Activities
To investigate the involvement of compromised IoT devices in malicious activities, we used Cymon, a publicly available cyber-threat intelligence service that tracks and aggregates Internet-scale events related to IP addresses and domains involved in malware, phishing, botnets, spamming, DNS blacklisting, scanning, and web attacks.

- **Devices Investigated**: 8,839 exploited IoT devices, including 839 DoS victims and the top 4,000 compromised IoT devices with the most generated scanning and UDP packets.
- **Packet Distribution**: About 10% of the explored IoT devices sent 50 or fewer packets to the darknet, while only 15% sent 10,000 packets or more. Less than 2% generated 100,000 packets or more, and only 15 devices sent more than 1 million packets (maximum = 6.25 million packets).
- **Malicious Devices**: 816 IoT devices (9.2%) were linked to one or more malicious activities, as summarized in Table VI.

**Table VI: Identified Threats Summary (Note: The identified threats are not mutually exclusive).**

| Threat Category | IoT Devices (%) |
|-----------------|-----------------|
| Scanning        | 96.3            |
| Miscellaneous   | 70.3            |
| Brute Force (SSH) | 30.9          |
| Spam (Mail, IMAP) | 27.8           |
| Malware         | 14.3            |
| Phishing        | 0.6             |

- **Key Findings**: The majority of malicious IoT devices were associated with illicit scanning (96.3%). About 70% were flagged for miscellaneous activities (e.g., Web attacks), 31% for SSH brute force attacks, and 28% for spamming. A total of 117 IoT devices were linked to malware-related activities, with 91 CPS-related and 26 consumer IoT devices involved in TCP scanning activities.

#### B. IoT-Centric Malware Families
Given the identification of 117 IoT devices related to malware, we further explored this matter using an in-house built database of malware information, which includes network and system-level activities of malware samples.

- **Database Source**: The database is populated by daily malware feeds from ThreatTrack Security, with an average of 30,000 malware samples.
- **Correlation**: We correlated the inferred unsolicited IoT devices with the malware database using IP address information.
- **Findings**: 33 domain names and 24 unique malware hashes/variants were associated with the identified IoT devices. Using VirusTotal, we uncovered 11 malware families, as summarized in Table VII.

**Table VII: Identified, Previously Unreported Malware Families Exploiting IoT Devices**

| Malware Family | Description |
|----------------|-------------|
| Ramnit         | Backdoor    |
| Starman        |             |
| Kryptik        |             |
| Nivdort        |             |
| Razy           |             |
| Zusy           | Email Spam  |
| Bayrod         |             |
| Artemis        |             |
| MSIL           |             |
| Vupa           |             |
| Allaple        |             |

- **Significance**: Some of the families, such as Ramnit and Zusy, are already well-known, but new variants are emerging to target the IoT paradigm. This is the first attempt to shed light on IoT-centric malware families by correlating passive measurements and malware samples through dynamic analysis, highlighting new, previously unreported families and variants.

### Discussion
- **Comprehensive Inference of Internet-Scale Unsolicited IoT Devices**: While Shodan was used to gather a large dataset of IP information, identifying technical details for Internet-wide IoT devices remains challenging. Two approaches are proposed: exploring fuzzy matching algorithms and fostering collaboration between ISPs, local IoT operators, and industry.
- **Malware Attribution for Tailored Remediation**: Further exploration is needed to attribute exploitations to specific malware variants. Formal correlation approaches between passive measurements and malware network traffic samples are being explored.
- **Real-Time IoT Operational Cyber Security Capabilities**: There is a need for IoT-tailored actionable cyber security capabilities. We are working on automating methodologies to index unsolicited Internet-scale IoT devices in near real-time and creating an authenticated API to share IoT-relevant malicious empirical data and threat intelligence with the research community.

### Conclusion
This paper provides an empirical look at the magnitude of compromised IoT devices in both consumer and critical CPS realms. Large-scale correlations between passive measurements and IoT-relevant information highlight the insecurity of the IoT paradigm. Future work will focus on addressing the challenges of identifying and clustering IoT botnets and their illicit activities through passive measurements.

### Acknowledgment
The authors express gratitude to anonymous reviewers for their feedback. This work was partially supported by NSERC, Concordia University, and the U.S. National Science Foundation (NSF).

### References
[References listed here as provided in the original text]