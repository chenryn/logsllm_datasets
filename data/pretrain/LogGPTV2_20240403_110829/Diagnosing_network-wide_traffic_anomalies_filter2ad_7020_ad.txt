1.5
1
0.5
0
4.5
4
3.5
3
2.5
2
1.5
1
0.5
0
2.5
2
1.5
1
0.5
0
5
10
x 107
5
10
x 108
5
10
True Size
Estimated Size
7
8
9
True Size
Estimated Size
5
6
True Size
Estimated Size
4
5
6
Anomaly (rank order)
3
4
Anomaly (rank order)
All
Identified
30
35
40
All
Identified
30
35
40
All
Identified
15
Anomaly (rank order)
20
25
15
Anomaly (rank order)
20
25
i
l
e
z
S
y
a
m
o
n
A
i
l
e
z
S
y
a
m
o
n
A
i
l
e
z
S
y
a
m
o
n
A
4
3.5
3
2.5
2
1.5
1
0.5
2
3
0
1
x 107
4.5
4
3.5
3
2.5
2
1.5
1
0.5
0
2.5
2
1.5
1
0.5
2
1
x 108
(a) Detection
(b) Identiﬁcation
15
Anomaly (rank order)
20
25
30
35
40
0
1
2
3
Anomaly (rank order)
(c) Quantiﬁcation
4
Figure 5: Results of applying our method on link trafﬁc to diagnose volume anomalies found in OD ﬂows by the Fourier approach.
From top to bottom: Sprint-1, Sprint-2, and Abilene.
From the class of forecasting based techniques, we select EWMA
and apply it on each individual OD ﬂow timeseries to isolate anoma-
lies. EWMA (also known as exponential smoothing) is a simple
algorithm that predicts the next value in a given timeseries based
on recent history. Speciﬁcally, if zt denotes the trafﬁc in OD ﬂow
at time t, then the EWMA prediction for time t + 1 is given by ˆzt+1
as:
ˆzt+1 = αzt + (1 − α)ˆzt
where 0 ≤ α ≤ 1 is a parameter that controls the relative weight
placed on past values. We selected values for α based on apply-
ing a multi-grid parameter search (as in [14]) performed on sample
training data, and found that values of 0.2 ≤ α ≤ 0.3 isolated the
spikes in our data well. Anomalies can then be quantiﬁed by tak-
ing the difference between the forecasted and the actual value, i.e.,
|zt − ˆzt|.2
2A problem with using such an EWMA-based approach (and most
From the class of signal analysis techniques, we draw on Fourier
analysis to capture the diurnal trends that most OD ﬂows exhibit
over long periods of time. Speciﬁcally, we approximate the time-
series of each OD ﬂow as a weighted sum of eight Fourier basis
functions. These basis functions correspond to trafﬁc variations
with period 7 days, 5 days, 3 days, 24 hours, 12 hours, 6 hours, 3
hours, and 1.5 hours. The size of an anomaly then is the difference
between the actual value and the modeled value, |zt − ˆzt| where ˆzt
is the Fourier approximation of the OD ﬂow at time index t.
We conﬁrmed that every OD ﬂow anomaly that we could visually
isolate was also discovered by both these approaches. However, we
did ﬁnd several instances where both schemes mistakenly marked a
moving average schemes) to identify single-timestep spikes, is that
the scheme often mistakenly marks the time after a spike as an ad-
ditional spike. To avoid this problem, we ran EWMA in both direc-
tions, estimated the size of the spike in each direction and reported
the minimum of the two estimates.
Validation Dataset
Sprint-1
Fourier
Fourier
Sprint-2
Abilene
Fourier
Sprint-1
EWMA
Sprint-2
EWMA
EWMA
Abilene
Anomaly Size Detection
2.0 × 107
9/9
2.0 × 107
7/11
8.0 × 107
5/6
2.0 × 107
4/5
2.0 × 107
3/4
8.0 × 107
2/3
False Alarm Identiﬁcation Quantiﬁcation
15.6%
21.0%
33.0%
16.8%
20.8%
17.7%
1/999
0/997
10/1002
6/1003
4/1004
13/1005
9/9
6/7
3/5
4/4
2/3
1/2
Table 2: Results from actual volume anomalies diagnosed, all at 99.9% conﬁdence level.
point in time as an anomaly (e.g., because of irregular periodicities
in the underlying OD ﬂow.) We did not remove these erroneous
anomalies, so as to avoid introducing any bias in the set of anoma-
lies. As a result there are some misidentiﬁed anomalies in our set of
“true” anomalies, and in the text that follows we note where these
affect our results.
We now present the results of evaluating our method against the
set of volume anomalies obtained by applying the EWMA and
Fourier methods. Recall that while both Fourier and EWMA are
applied on the OD ﬂow level, our diagnosis method operates on the
link data.
In Figure 5(a) (left hand column) we present the top 40 anoma-
lies isolated by the Fourier scheme for our three datasets. The ﬁrst
point to note is that in each dataset, there is a sharp knee in the
rank-ordered plot of anomaly sizes. This suggests that the largest
anomalies are qualitatively different from the large set of nearly
equal anomalies to the right of the knee. In fact, the question of
how large a spike should be in order to be considered an anomaly
can be addressed in this way. We choose the anomalies that “stand
out” to the left of the knee as the important set to detect. For the
Sprint datasets this means that anomalies of greater than 2 × 107
bytes are important to detect; for the Abilene dataset, the value is
8 × 107 bytes.
Figure 5(a) also shows the performance of the subspace detection
method, applied with a 99.9% conﬁdence limit. (Detected anoma-
lies are the light bars.) The plots show that above the cutoff value,
the subspace method detects and identiﬁes nearly every anomaly.3
In addition, virtually none of the spikes below the cutoff (the non-
anomalies), were detected; thus the scheme has low false alarm
rates.
Figure 5(b) shows the same set of anomalies, but the light bars
here indicate those anomalies for which the underlying ﬂow was
successfully identiﬁed. It shows that nearly every anomaly that was
detected was successfully identiﬁed. (We did not attempt identiﬁ-
cation on anomalies that were not detected.) The accuracy of these
results are consistent across all three datasets.
Finally, Figure 5(c) compares the anomaly size to the estimated
size obtained via quantiﬁcation, for the successfully identiﬁed ﬂows.
These results are sensitive to error in anomaly size determination
in the Fourier analysis, so actual performance may in fact be bet-
ter than what is shown here. Nonetheless, the results show that
quantiﬁcation can in general estimate the anomaly size reasonably
accurately.
In Table 2 we report more detailed diagnosis results from both
validation methods. To interpret these numbers it is useful to note
that each dataset has 1008 points in time. For Sprint-1, only 9 of
these 1008 timepoints are anomalies, all of which are detected and
identiﬁed correctly, with only one false alarm reported. In fact, vi-
3The missing anomaly at bar 4 of Sprint-2 was detected at the
99.5% conﬁdence level. This was a case where Fourier overesti-
mated the size of the anomaly.
sually inspecting the false alarms revealed that most of them were
classiﬁed as such because Fourier and EWMA underestimated the
size of the anomaly. A reason for the higher false alarm rates in
Abilene is that the nature of trafﬁc (sampled 5-tuple IP ﬂows) col-
lected from this network is generally more noisy and so anomalies
are more often missed by the smoothing of Fourier and EWMA.
Therefore the actual rates might be better in reality.
The table conﬁrms quantitatively that identiﬁcation and quan-
tiﬁcation are reasonably accurate across all our datasets. Average
quantiﬁcation estimates for all but one dataset are within 21% of
the true size of the anomaly, which is sufﬁciently accurate for op-
erational settings [25].
To summarize, our results here demonstrate that regardless of the
dataset or the validation method employed, the subspace diagnosis
procedure shows high detection rates and low false alarm rates.
6.3 Synthetic Volume Anomalies
A second approach to quantify the effectiveness of the subspace
method is to evaluate it on anomalies injected into the OD ﬂows of
Sprint-1 and Abilene.
We ﬁrst select two injection sizes, large and small. The large
injections are set to match the largest anomalies seen in the each
dataset (i.e., values above the cutoff in Figure 5). The small injec-
tions are set at values slightly below the cutoff in Figure 5 and so
constitute non-anomalies that we do not want to detect. This al-
lows us to quantify false alarm rates across all timepoints and all
OD ﬂows. For Sprint-1, we set large at 3 × 107 bytes and small at
1.5 × 107 bytes. For Abilene, we set large at 1.2 × 108 bytes and
small at 5 × 107 bytes.
Then, in multiple experiments, we insert a spike of each size in
every OD ﬂow and at every point in time over the period of a day.
For each permutation of spike size, timestep and OD ﬂow selected,
we generate the corresponding set of link trafﬁc counts. We then
apply our procedure and note whether it successfully diagnoses the
injected anomaly.
The ﬁrst set of these results are presented in Figure 6 which
shows mean detection rates (rates are computed over OD ﬂows) as a
timeseries for the large injections in Sprint-1. This plot shows that
the method’s detection rate is fairly constant, regardless of when
the anomaly was injected. Thus the diagnosis procedure works
equally well across time, and is not affected by the underlying non-
stationarity in trafﬁc.
Evaluation results across OD ﬂows are presented in Figure 7,
which shows the histogram of detection rates (rates are computed
over time) for both sized injections for Sprint-1. Figure 7(a) shows
that the method detects the large (and therefore the most important)
injections very well. On the other hand, Figure 7(b) shows that the
small injected spikes rarely trigger detections, which is as desired.
Together, these plots conﬁrm that the subspace method has a high
detection and a low false alarm rate.
In Figure 8, we present a scatter plot of mean detection rate (rates
Network
Sprint
Abilene
Sprint
Abilene
Injection Size
Large (3.0 × 107)
Large (1.2 × 108)
Small (1.5 × 107)
Small (5.0 × 107)
Detection
93%
90%
15%
5%
Identiﬁcation Quantiﬁcation
18%
21%
11%
18%
85%
69%
14%
3%
Table 3: Results on diagnosing synthetic volume anomalies.
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
e
t
a
R
n
o
i
t
c
e
t
e
D
0
0h
6h
12h
Time
18h
24h
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
e
t
a
R
n
o
i
t
c
e
t
e
D
102
104
106
Mean OD Flow Size
Figure 6: Timeseries of detection rates on large injections
(Sprint-1).
Figure 8: Scatter plots of detection rate of large injections and
mean OD ﬂow rate (Sprint-1).
y
c
n
e
u
q
e