 0  0.5  1  1.5  2  2.5  3  3.5  4
log10(n)
)
r
a
v
(
0
1
g
o
l
 0
-0.5
-1
-1.5
-2
-2.5
-3
-3.5
-4
-4.5
)
r
e
w
o
p
(
0
1
g
o
l
 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5
log10(m)
 5
 4
 3
 2
 1
 0
-1
-2
-3.5 -3 -2.5 -2 -1.5 -1 -0.5  0
log10(freq)
(a) R/S diagram (IT trace)
(b) Variance-time (IT trace)
(c) Periodogram (IT trace)
)
)
n
(
S
/
)
n
(
R
0
1
g
o
(
l
 4.5
 4
 3.5
 3
 2.5
 2
 1.5
 1
 0.5
 0
 0  0.5  1  1.5  2  2.5  3  3.5  4
log10(n)
)
r
a
v
(
0
1
g
o
l
 0
-1
-2
-3
-4
-5
-6
-7
-8
)
r
e
w
o
p
(
0
1
g
o
l
 0  0.5  1  1.5  2  2.5  3  3.5  4  4.5
log10(m)
 4
 3
 2
 1
 0
-1
-2
-3
-4
-5
-6
-3.5 -3 -2.5 -2 -1.5 -1 -0.5  0
log10(freq)
(d) R/S diagram (3c trace)
(e) Variance-time (3c trace)
(f) Periodogram (3c trace)
Fig. 3. Self-similarity tests on the IT trace and the 3layer-control (3c) trace
two hosts. We assume it to be related to some automated activity, such as backup,
but we did not attempt to verify which.
4.2 Self-similarity
One of the requirements for a random variable to be self-similar is that it must
be wide-sense stationary [4], which implies, among other things, a constant mean
over time. Therefore, due to the diurnal patterns of activity, network traﬃc is not
truly self-similar [8]. However, network measurements with durations up to a few
hours do present self-similar time series [4,6]. Other sources of non-stationarity
are singular events that cause drastic changes in the network behavior, such as
a maintenance operation or changes in physical processes (see Section 3.2). For
the following analysis, we have taken periods of a few hours from our datasets
where the stationarity requirement is satisﬁed.
The self-similarity analysis is performed for the pkts/s and bytes/s time se-
ries with 100 millisecond bins for all datasets. The results for the bytes/s are
analogous to the ones from pkts/s and, therefore, are omitted. Figure 3 depicts
the R/S pox diagram, the variance time plots and the periodograms for IT in
the ﬁrst row (Figures 3a, 3b and 3c respectively) and 3layer-control in the sec-
ond row (Figures 3d, 3e and 3f respectively). The results for the other SCADA
datasets are analogous, thus also omitted.
The R/S pox diagram of a self-similar random variable should have an asymp-
totic slope between 0.5 and 1 (represented by the black dotted lines). The slope
is typically estimated by least-square ﬁtting (represented by the red dotted line).
It is clear from Figures 3a and 3d that IT presents self-similar behavior, while
3layer-control does not. A comparable result is obtained using the variance-time
Diﬃculties in Modeling SCADA Traﬃc: A Comparative Analysis
133
Table 2. Hurst parameter estimations
bytes/s
pkts/s
dataset
R/S var-time period R/S var-time period
0.72
0.73
0.79
IT
0.22
2layer
0.17 [0.09,0.11]
0.44
3layer-control 0.38 [0.38,0.44]
3layer-ﬁeld
0.02 [0.27,0.31]
0.04
0.79 0.75 [0.71-0.72]
0.13 0.17 [0.32,0.42]
0.43 0.39 [0.36,0.37]
0.29 0.44 [0.35,0.42]
plot test, where the slope of the resulting curve should be shallower than -1
(black dotted line). This test shows that the variance of the SCADA time series
decays much faster than the expected for a self-similar process. In contrast, the
IT dataset result is consistent with the traditional network measurements. The
same conclusion can be drawn from the periodogram test. When applying this
method, we obtain a estimative of H = 0.79 for the IT dataset and of H = 0.44
for 3layer-control. Note that the Hurst parameter of a self-similar process should
be in the interval H ∈ [0.5, 1).
Table 2 summarize the results of our analysis, reporting the estimates for
the Hurst parameter from the R/S analysis (R/S), variance-time plots (var-
time) and periodograms (period). All estimates for the SCADA datasets indicate
a non-self-similar behavior, although the estimates are not consistent between
tests. In contrast, the IT dataset shows more consistent estimate of the Hurst
parameter, which is in agreement with a self-similar behavior. Note also that,
while the R/S analysis and periodograms yield a single estimate, the variance-
time plots produce a small range of estimates. This happens because for both
small and large aggregation levels m there is a considerable amount of variance
that should not be taken into account when performing the least-square ﬁt. In
our analysis we remove up to 15% of either end of the variance-time plot to
obtain the Hurst estimates.
4.3 Distributional Aspects of Connection Sizes
As explained in Section 3.3, there is a debate in the research community around
which distribution best ﬁts the tail behavior of connections sizes1, heavy-tail
(usually Pareto-distributed) or log-normal. We can illustrate both behaviors for
the IT trace. In the case of the number of packets per ﬂow, plotted in Figure
4a, the CCDF presents an almost constant slope, indicating that a Pareto model
might provide a good ﬁt. In the case of ﬂow duration, plotted in Figure 4b, the
behavior is closer to that of an log-normal distribution, with an increasing slope
when approaching extreme values in the tail.
For the SCADA datasets, the results are not always conclusive. For instance,
consider again the connection size in packets plotted in Figure 4a. The tail for
dataset 2layer could be modeled as Pareto, if one considers the tail to consist of
1 In this paper we use the terms connection and ﬂow interchangeably. For the deﬁnition
of ﬂow we refer to Section 2.
134
R.R.R. Barbosa, R. Sadre, and A. Pras
0
10
-1
10
-2
10
-3
10
-4
10
-5
10
)
]
x
>
X
[
P
10
-6
0
10
1
10
2
10
3
10
it
2layer
3layer-control
3layer-field
1
10
0
10
-1
10
-2
10
-3
10
-4
10
-5
10
)
]
x
>
X
[
P
5
6
10
7
10
8
10
9
10
10
-6
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
4
10
10
Packets
it
2layer
3layer-control
3layer-field
2
10
3
10
4
10
5
10
6
10
7
10
1
0
10
10
Duration
(a) Packets CCDF
(b) Flow duration CCDF
Fig. 4. Flow size Complementary CDF’s
values above 102. In the case of 3layer-control, the CCDF presents large varia-
tions and cannot be approximated by either model. When considering duration,
2layer and 3layer-control CCDFs present diﬀerent slopes at diﬀerent ranges.
See for instance the CCDF of 3layer-control in Figure 4b. The slope is relatively
small up to 10s, it sharply increases in the interval [10, 103] after which it sharply
reduces. Finally, the tail of dataset 3layer-ﬁeld for both metrics is dominated by
a small range of values, which produces the nearly vertical lines in both plots.
Irrespective of which is the best model to represent the connection size dis-
tribution, all datasets share a common characteristic: the connection size distri-
bution is always positively skewed, i.e, it has a body containing the majority of
the values in the distribution and a tail with extreme values in the right.
5 Conclusions
The goal of this paper was to verify if models used to describe traditional network
traﬃc can also be applied to SCADA traﬃc. To this end, we have analyzed
SCADA traﬃc traces collected at two water treatment and distribution facilities
and compared their characteristics with those of traditional network traﬃc. Our
analysis has been based on a list of network traﬃc invariants widely observed in
network measurements.
We draw the following conclusions from our results. First, SCADA networks do
not present the diurnal patterns of activity common to traditional IT networks, as
most of the traﬃc is generated by automated processes with little human interac-
tion. More important, self-similar correlations in the time series are not present.
Our results suggest that simple ON/OFF models might provide a good approxi-
mation for the time series. Finally, neither heavy-tail nor log-normal models seem
to provide a good ﬁt for the connection sizes. In summary, our results indicate that
the existing traﬃc models can not be easily applied to SCADA traﬃc.
To our best knowledge, we provide the ﬁrst study on real-world SCADA traces
in this paper. Since existing publications on SCADA networks generally do not
Diﬃculties in Modeling SCADA Traﬃc: A Comparative Analysis
135
rely on empirical data, we believe that our ﬁndings are a ﬁrst step towards
constructing realistic SCADA traﬃc models to support future research in the
area. In future work, we intend to extend our analysis of SCADA traﬃc, including
the characterization of the ﬂow arrival process and the extraction of periodical
patterns.
References
1. Kobayashi, T.H., Batista, A.B., Brito, A.M., Pires, P.S.M.: Using a packet ma-
nipulation tool for security analysis of industrial network protocols. In: IEEE
Conference on Emerging Technologies and Factory Automation (ETFA), pp. 744–
747 (2007)
2. Cheung, S., Skinner, K., Dutertre, B., Fong, M., Lindqvist, U., Valdes, A.: Using
model-based intrusion detection for SCADA networks. In: Proceedings of the
SCADA Security Scientiﬁc Symposium, pp. 1–12. Citeseer (2007)
3. Valdes, A., Cheung, S.: Communication pattern anomaly detection in process con-
trol systems. In: IEEE Conference on Technologies for Homeland Security, HST
2009, pp. 22–29. IEEE (May 2009)
4. Leland, W.E., Willinger, W., Taqqu, M.S., Wilson, D.V.: On the self-similar nature
of Ethernet traﬃc. ACM SIGCOMM Computer Communication Review 25(1),
202–213 (1995)
5. Paxson, V., Floyd, S.: Wide area traﬃc: the failure of Poisson modeling.
IEEE/ACM Transactions on Networking 3(3), 226–244 (1995)
6. Crovella, M.E., Bestavros, A.: Self-similarity in World Wide Web traﬃc: evidence
and possible causes. IEEE/ACM Transactions on Networking 5(6), 835–846 (1997)
7. Downey, A.: Lognormal and Pareto distributions in the Internet. Computer
Communications 28(7), 790–801 (2005)
8. Gong, W.-B., Liu, Y., Misra, V., Towsley, D.: Self-similarity and long range de-
pendence on the internet: a second look at the evidence, origins and implications.
Computer Networks 48(3), 377–399 (2005); Long Range Dependent Traﬃc
9. Loiseau, P., Goncalves, P., Dewaele, G., Borgnat, P., Abry, P., Primet, P.V.-
B.: Investigating Self-Similarity and Heavy-Tailed Distributions on a Large-Scale
Experimental Facility. IEEE/ACM Transactions on Networking 18(4), 1261–1274
(2010)
10. Vázquez, A., Pastor-Satorras, R., Vespignani, A.: Large-scale topological and dy-
namical properties of the internet. Physical Review E 65 (2002)
11. Sadre, R., Haverkort, B.R.: Changes in the Web from 2000 to 2007. In: De Turck,
F., Kellerer, W., Kormentzas, G. (eds.) DSOM 2008. LNCS, vol. 5273, pp. 136–148.
Springer, Heidelberg (2008)
12. Floyd, S., Paxson, V.: Diﬃculties in simulating the Internet.
IEEE/ACM
Transactions on Networking 9(4), 392–403 (2001)
13. Barbosa, R.R.R., Sadre, R., Pras, A.: A First Look into SCADA Network Traﬃc.
In: Network Operations and Management Symposium, NOMS (to appear, 2012)
14. Jacobson, V., Leres, C., McCanne, S., et al.: Tcpdump (1989)
15. Barbosa, R.R.R., Sadre, R., Pras, A., van de Meent, R.: Simpleweb/university of
twente traﬃc traces data repository. Technical report, Centre for Telematics and
Information Technology, University of Twente (April 2010)
16. Nuzman, C., Saniee, I., Sweldens, W., Weiss, A.: A compound model for TCP
connection arrivals for LAN and WAN applications. Computer Networks 40(3),
319–337 (2002)