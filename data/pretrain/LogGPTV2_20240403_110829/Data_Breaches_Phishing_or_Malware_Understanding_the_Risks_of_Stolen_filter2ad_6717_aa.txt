title:Data Breaches, Phishing, or Malware?: Understanding the Risks of Stolen
Credentials
author:Kurt Thomas and
Frank Li and
Ali Zand and
Jacob Barrett and
Juri Ranieri and
Luca Invernizzi and
Yarik Markov and
Oxana Comanescu and
Vijay Eranti and
Angelika Moscicki and
Daniel Margolis and
Vern Paxson and
Elie Bursztein
Data Breaches, Phishing, or Malware?
Understanding the Risks of Stolen Credentials
Kurt Thomas⋄ Frank Li† Ali Zand⋄
Jacob Barrett⋄
Juri Ranieri⋄ Luca Invernizzi⋄
Yarik Markov⋄ Oxana Comanescu⋄ Vijay Eranti⋄ Angelika Moscicki⋄ Daniel Margolis⋄
Vern Paxson†∗ Elie Bursztein⋄
Google⋄ University of California, Berkeley†
International Computer Science Institute∗
ABSTRACT
In this paper, we present the first longitudinal measurement study
of the underground ecosystem fueling credential theft and assess
the risk it poses to millions of users. Over the course of March,
2016–March, 2017, we identify 788,000 potential victims of off-the-
shelf keyloggers; 12.4 million potential victims of phishing kits; and
1.9 billion usernames and passwords exposed via data breaches and
traded on blackmarket forums. Using this dataset, we explore to
what degree the stolen passwords—which originate from thousands
of online services—enable an attacker to obtain a victim’s valid
email credentials—and thus complete control of their online iden-
tity due to transitive trust. Drawing upon Google as a case study,
we find 7–25% of exposed passwords match a victim’s Google ac-
count. For these accounts, we show how hardening authentication
mechanisms to include additional risk signals such as a user’s his-
torical geolocations and device profiles helps to mitigate the risk of
hijacking. Beyond these risk metrics, we delve into the global reach
of the miscreants involved in credential theft and the blackhat tools
they rely on. We observe a remarkable lack of external pressure on
bad actors, with phishing kit playbooks and keylogger capabilities
remaining largely unchanged since the mid-2000s.
1 INTRODUCTION
As the digital footprint of Internet users expands to encompass
social networks, financial records, and data stored in the cloud,
often a single account underpins the security of this entire identity—
an email address. This root of trust is jeopardized by the exposure
of a victim’s email password or recovery questions. Once subverted,
a hijacker can reset a victim’s passwords to other services as a
stepping stone attack; download all of the victim’s private data;
remotely wipe the victim’s data and backups; or impersonate the
victim to spew out spam or worse.
Highly visible hijacking incidents include attacks on journalists
such as Mat Honan and the Associated Press [21, 26], as well as
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
CCS’17, Oct. 30–Nov. 3, 2017, Dallas, TX, USA.
© 2017 Copyright held by the owner/author(s). ISBN 978-1-4503-4946-8/17/10.
DOI: 10.1145/3133956.3134067
politicians and government officials including Sarah Palin, John
Podesta, and Emmanuel Macron [17, 32, 40]. However, the threat
of hijacking extends to millions of users [14, 36]. Indeed, a user
study by Shay et al. in 2014 found 30% of 294 participants reported
having at least one of their accounts compromised [33]. Yet, despite
the prevalence of hijacking, there are few details about the largest
sources of stolen credentials, or the degree to which hardening
authentication mechanisms to include additional risk signals like a
user’s historical geolocation or device profiles helps to mitigate the
threat of compromise.
In this paper, we present the first longitudinal measurement
study of the underground ecosystem fueling credential theft and the
risks it poses to users. Our study captures three market segments:
(1) forums that trade credential leaks exposed via data breaches; (2)
phishing kits that deceive users into submitting their credentials to
fake login pages; and (3) off-the-shelf keyloggers that harvest pass-
words from infected machines. We measure the volume of victims
affected by each source of credential theft, identify the most popular
blackhat tools responsible, and ultimately evaluate the likelihood
that attacks obtain valid email credentials and subsequently bypass
risk-based authentication protections to hijack a victim’s account.
To conduct our study, we develop an automated framework that
monitors blackmarket actors and stolen credentials. Over the course
of March, 2016–March, 2017, we identify 788,000 potential victims
of keylogging; 12.4 million potential victims of phishing; and 1.9
billion usernames and passwords exposed by data breaches. We
emphasize our dataset is strictly a sample of underground activity,
yet even our sample demonstrates the massive scale of credential
theft occurring in the wild. We observe victims from around the
globe, with credential leaks and phishing largely affecting victims in
the United States and Europe, while keyloggers disproportionately
affect victims in Turkey, the Philippines, Malaysia, Thailand, and
Iran.
We find that the risk of a full email takeover depends significantly
on how attackers first acquire a victim’s (re-used) credentials. Using
Google as a case study, we observe only 7% of victims in third-
party data breaches have their current Google password exposed,
compared to 12% of keylogger victims and 25% of phishing victims.
Hijackers also have varying success at emulating the historical login
behavior and device profile of targeted accounts. We find victims of
phishing are 400x more likely to be successfully hijacked compared
to a random Google user. In comparison, this rate falls to 10x for
data breach victims and roughly 40x for keylogger victims. This
discrepancy results from phishing kits actively stealing risk profile
information to impersonate a victim, with 83% of phishing kits
collecting geolocations, 18% phone numbers, and 16% User-Agent
data.
Behind the scenes, we find 4,069 distinct phishing kits and 52
keyloggers were responsible for the active attacks in our year-
long monitoring sample. The most popular phishing kit—a website
emulating Gmail, Yahoo, and Hotmail logins—was used by 2,599
blackhat actors to steal 1.4 million credentials. Likewise, the most
popular keylogger—HawkEye—was used by 470 blackhat actors to
generate 409,000 reports of user activity on infected devices. We
find the operators of both phishing kits and keyloggers concentrate
in Nigeria, followed by other nations in Africa and South-East Asia.
Our findings illustrate the global reach of the underground economy
surrounding credential theft and the necessity of a defense-in-depth
approach to authenticating users.
2 BACKGROUND & RELATED WORK
Miscreants involved in credential theft rely on an array of under-
ground markets and blackhat tools. We provide a brief background
on some of these services, the details of which inform our study.
2.1 Credential Leaks
Media headlines reporting data breaches at major online services
have become a regular occurrence in recent years. Indeed, 26% of
2,618 adults surveyed in the United States reported receiving a
notice related to a data breach in the last year [1]. Prominent exam-
ples of affected online services include Yahoo, MySpace, LinkedIn,
Adobe, and Dropbox, which combined revealed the username and
password details for over a billion users [12, 15, 16, 18, 25]. The pass-
word storage policies of each of these companies varied, with some
breaches exposing plaintext or unsalted password hashes, while oth-
ers exposed salted SHA-1, bcrypt, or even symmetrically encrypted
passwords. Though many of these credential leaks purportedly
date back to 2012–2014, they have only recently percolated through
underground networks and ultimately appeared on more public
blackhat forums or paste sites [6], or on sites like leakedsources.com,
leakbase.pw, or breachalarm.com that charge companies and users
to lookup whether their accounts were impacted.
Apart from the loss of user faith in online services after massive
password resets, credential leaks pose a broader risk to the online
ecosystem due to weak password selection and re-use [34]. Das
et al. examined the password strategies for users who appeared
in multiple credential leaks and estimated 43% of passwords were
re-used [9], while Wash et al. found users re-used 31% of their
passwords based on a study of 113 participants [37]. Even if pass-
words are hashed or include subtle transformations from service
to service, a wealth of prior work has examined how to invert
the hashes via dictionary attacks or modeling password selection
behavior [2, 7, 9, 10, 24, 29, 38]. We re-evaluate the risk of stolen
passwords due to long-term re-use and the susceptibility of hashed
passwords to trivial dictionary attacks.
2.2 Phishing Kits
Phishing kits are “ready-to-deploy” packages for creating and con-
figuring phishing content that also provide built-in support for
reporting stolen credentials [8]. The type of information stolen
depends on the kits, but prior studies have shown that they har-
vest a victim’s username, password, and geolocation information
among other sensitive data [8, 19, 30, 39]. Han et al. estimated the
success rate of kits by monitoring the activity of real visitors to in-
fected honeypots, of which 9% submitted some data to the phishing
page [19].
Kits forward stolen credentials to the operator in one of three
ways: through SMTP to an email address controlled by the opera-
tor, via FTP, or by connecting to a remote database. The number
of phishing websites that rely on kits (as opposed to custom de-
ployments) is unknown, but previous work by Zawoad et al. found
10% of phishing sites active in 2013 left trace evidence of phishing
kits [39]. This is a lower bound due to a limited coverage in the
detection technique for phishing kits and because miscreants may
delete traces of the kit after deployment. Moore et al. demonstrated
how to develop inbound email rules deployed at a large, undis-
closed email provider to discover the email accounts of SMTP-based
phishing kit operators, for which they detected 120–160 different
miscreants [30]. We use this initial system as motivation for our
design to capture the behavior of over ten thousand phishing kits,
discussed in Section 3.
2.3 Keyloggers
Keyloggers have evolved beyond their moniker, with off-the-shelf
families like HawkEye and Predator Pain [28] providing built-in
functionality to steal on-device password stores, harvest clipboard
content, and screenshot a victim’s activity in addition to monitor-
ing keystrokes. As with phishing kits, keyloggers use a variety of
techniques for reporting stolen credentials including SMTP, FTP, or
remote databases. Holz et al. studied public ‘dropzones’ where key-
loggers would upload stolen data and identified more than 10,700
stolen online bank account credentials and over 149,000 stolen
email passwords over a 7 month period in 2008. [20]. While we
focus on off-the-shelf keyloggers in this study, malware families
may broadly include similar capabilities: Stone-Gross et al. exam-
ined the Torpig botnet and found it harvested over 54,000 email
accounts from password stores and over 400,000 other credentials
from HTTP forms over a 10 day period [35].
2.4 Hijacker Behavior
While not the focus of our research, a number of studies have in-
vestigated how hijackers subsequently abuse stolen credentials.
Onaolapo et al. leaked 100 email accounts via paste sites, under-
ground forums, and virtual machines infected with malware [31].
They found a majority of miscreants searched the email history of
accounts for financial data, while a smaller set used the accounts
for spamming. Bursztein et al. reported a similar strategy where
hijackers searched each victim’s email history for financial records
and credentials related to third-party services [5]. Shay et al. con-
ducted a user study of the harm caused by hijacking and found
most participants self-reported being angry or embarrassed, but
that their accounts were mostly used for spam [33]. In the realm
Figure 1: Collection framework for identifying credential leaks on public websites and private forums.
of social networks, Gao et al. identified 57,000 Facebook accounts
that created 200,000 spam posts; they estimated 97% of the accounts
were in fact compromised [14]. Finally, Thomas et al. examined
cascades of hijacking campaigns on Twitter [36]. They identified
13.8 million compromised accounts used for both infecting other
users and for posting spam. These behaviors illustrate a variety of
strategies for monetizing stolen credentials—spam, financial fraud,
and stepping stone access to other accounts.
3 METHODOLOGY
Our study of hijacking risk necessitates access to a significant cor-
pus of stolen credentials. As such, we develop an automated col-
lection framework that combines proprietary data from Google
Search and Gmail to identify over a billion victims of credential
leaks, phishing kits, and off-the-shelf keyloggers. Table 1 contains
a detailed breakdown of the dataset collected by our system. We
discuss the design decisions of our framework, its limitations, and
ethical considerations that guide our approach.
3.1 Credential Leaks
We present our high-level strategy for identifying usernames and
passwords exposed via data breaches in Figure 1. Our design hinges
on the idea that credential leaks sold privately on underground
markets eventually surface for free. We detect when this happens by
regularly crawling a set of paste sites and blackhat forums, as well
as the public Internet at-large in order to identify content that may
contain emails and passwords (➊). We then parse and classify these
documents to confirm whether they contain leaked credentials (➋).
Finally, when possible, we invert any non-salted, hashed passwords
(➌). We supplement this framework with credential leaks that we
manually obtain from private, member-only forums. We discuss
each of these steps in detail.
Sourcing potential credential leaks. As previously demon-
strated by Butler et al. [6], blackhat forums and paste sites are
common haunts for publicly sharing credential leaks. We leverage
Google’s crawler to monitor activity on five public blackhat subfo-
rums1 that deal exclusively with stolen credentials, along with 115
paste sites. As not every paste or forum thread will contain user-
names and passwords, we treat each page as a candidate document
that requires further verification. To avoid applying an expensive
1For operational reasons, we do not reveal the forums that we monitor.
Table 1: Summary of datasets from our collection pipelines.
Dataset
Credential leaks
Phishing kits
Keyloggers
Credential leak victims
Phishing kit victims
Keylogger victims
Phishing victim reports
Keylogger victim reports
Samples
3,785
10,037
15,579
1,922,609,265
3,779,664
2,992
12,449,036
788,606
Time Frame
06/2016–03/2017
03/2016–03/2017
03/2016–03/2017
06/2016–03/2017
03/2016–03/2017
03/2016–03/2017
03/2016–03/2017
03/2016–03/2017
verification process to every new paste, we apply a pre-filter to
omit any pastes without at least 100 email addresses. Forum threads
are far less frequent so we skip pre-filtering.
Given that our coverage of public paste sites and blackhat forums
is undoubtedly incomplete, we improve our recall by identifying
any document in Google’s recent crawl history that contains at
least least 10 of 1,000 common passwords (e.g., 123456, password)
or their MD5 or SHA-1 equivalent, along with email suffixes for
popular mail providers. We bootstrap our list of the most common
passwords from previously collected credential leaks. We note this
technique will miss credential leaks that are compressed, password
protected, or encrypted. Together with paste sites and forums, we
surface a combined total of 31,446 candidate documents, as detailed
in Table 2, based on a snapshot of the search index in June, 2016.
We supplement this automated pipeline by manually collecting
credential leaks shared on 11 private, member-only blackhat forums
where we have access. Over the course of June, 2016–May, 20172, we
periodically monitored new forum threads and obtained 258 large
credential leaks containing a combined 1.79 billion non-unique
usernames and passwords. We emphasize that we never trade or
purchase credential dumps—our activity on these sites is strictly
passive. All of the files we obtained were compressed and shared via
torrents or on file hosting sites, thus being missed by our automated
detection.
2We note that the time we obtain a copy of the leaks is independent from the time the
data breach actually occurred, which might have been many years prior.
Parsing using delimiter detection. For our automatically de-
tected candidate documents, we first apply a delimiter detection
heuristic to columnize the data. Based on a manual investigation of
a random sample of candidate documents, we find that confirmed
credential leaks conform to a small number of highly-structured
formats: delimiter-separated values, key-value pairs, JSON blobs,
and SQL query outputs. Intuitively, this stems from the fact most
leaks are programmatically produced and consumed. In order to
detect the correct file format, we apply multiple parsers configured
with a small list of delimiter characters and then evaluate which
parser generates rows of equal length that consist of at least two
columns.
Table 2: Breakdown of where we source credential leaks.
Source
Paste sites
Search index
Public forums
Private forums
Candidate Confirmed Credentials
documents
extracted
4,855,780
3,317
10,856,227