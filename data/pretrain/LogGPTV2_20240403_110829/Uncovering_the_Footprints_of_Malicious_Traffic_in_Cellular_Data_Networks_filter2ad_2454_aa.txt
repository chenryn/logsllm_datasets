# Uncovering the Footprints of Malicious Traffic in Cellular Data Networks

**Authors:**
- Arun Raghuramu<sup>1</sup>
- Hui Zang<sup>2</sup>
- Chen-Nee Chuah<sup>3</sup>

**Affiliations:**
1. Department of Computer Science, University of California, Davis, USA
2. Guavus Inc., San Mateo, CA, USA
3. Department of Electrical and Computer Engineering, University of California, Davis, USA

**Abstract:**
In this paper, we present a comprehensive characterization of malicious traffic generated by mobile devices using Deep Packet Inspection (DPI) records and security event logs from a large U.S.-based cellular provider network. Our analysis reveals that 0.17% of mobile devices in the cellular network are affected by security threats. This proportion, while small, is orders of magnitude higher than the previously reported infection rate of 0.0009% in 2013. We also perform a detailed comparison of infection rates across various mobile platforms, showing that platforms commonly considered secure, such as BlackBerry and iOS, are not as safe as generally perceived. Android remains the most affected platform with an infection rate of 0.39%. We provide a detailed discussion of the top threat families targeting mobile devices observed in our dataset. Lastly, we characterize the aggregate network footprint of both malicious and benign traffic in the cellular network and demonstrate that statistical network features can be used to distinguish between these traffic classes.

**1. Introduction**
The widespread use of mobile devices, such as smartphones, to access personal and financial information makes them prime targets for malware writers and attackers. Studies have revealed unique threats and attacks specific to mobile platforms, such as SMS and phone call interception malware [1]. Recent claims about the prevalence of mobile malware were challenged when Lever et al. [2] showed that mobile malware appears in only a tiny fraction (0.0009%) of devices in their dataset, suggesting that mobile application markets provide adequate security for users. However, the work in [2] did not offer a comprehensive view of malicious network traffic, as the analysis was limited to threats issuing DNS requests to known malicious domains and did not quantify the prevalence of specific types of threats affecting the network.

In this paper, we conducted a detailed characterization of malicious traffic generated by mobile devices using deep-packet flow records and security event logs from a major U.S.-based cellular network. Our analysis revealed that 0.17% of over 2 million devices in the cellular network triggered security alerts. This fraction, while still small, is significantly higher than the previous infection rate reported in [2] and aligns with recent direct infection rate measurements focusing on the Android platform [3]. This alarming infection rate underscores the need for a more thorough study of malicious traffic in mobile ecosystems.

A second area of focus is the problem of detecting malicious hosts/URLs. Previous studies, such as [4,5], treat this as a supervised learning problem, where a classifier learns from a combination of DNS, WHOIS, lexical, and other features associated with a given host to determine whether it is malicious or benign. Other studies, such as [6,7], exclusively use lexical features to achieve similar goals. A different approach, Nazca [8], was recently proposed to detect malware distribution networks by tracking web requests associated with malware downloads and installations.

Instead of focusing on features associated with the malware or hosts (e.g., URL content, WHOIS, etc.), we examined the network-level statistical features of traffic associated with malicious domains. We observed distinctive network access patterns that can be leveraged to distinguish between benign and malicious sites. To the best of our knowledge, this is the first study that applies such network-level features to the malicious host identification problem.

**Contributions:**
(a) We provide a large-scale characterization of malicious traffic by analyzing DPI records and security alerts of over 2 million devices. Our findings reveal a higher infection rate and show that four classes of threats—privacy leakage, adware, SIP attacks, and trojans—are most prevalent in mobile devices. Additionally, we find that 0.39% of Android devices are infected, while the infection rates of BlackBerry and iOS devices, which are commonly considered more secure, are relatively high at 0.32% and 0.22%, respectively.
(b) We analyze the aggregate network-level features of user traffic for both malicious and benign domains and demonstrate that they are sufficiently distinct. This allows us to build a machine learning classifier that identifies malicious domains using statistical properties of network traffic. We believe this opens up an interesting direction for the detection of unknown malicious domains.

**2. Data Summary and Methodology**
Our dataset, collected at a distribution site operated by a U.S. cellular service provider, is multiple terabytes in size and logs HTTP activities of over two million subscribers for a week-long period in summer 2013. The dataset includes:
- **Deep Packet Inspection (DPI) Records:** These records log HTTP activity of subscribers and contain flow-level information such as timestamp, duration, bytes transmitted, source IP address, URL, and User Agent.
- **Intrusion Detection System (IDS) and Anti-Virus (AV) Alert Logs:** These logs contain threat name, subscriber IP address, timestamp, destination HTTP domain, and destination port of the alerted activity.
- **IP Assignment Records:** These records map dynamically assigned IP addresses to anonymized subscriber device IDs.
- **VirusTotal and McAfee Scan Results:** Additional scans on certain domains and IPs in the IDS and AV logs to gather more information about the threats and the number of malware detection engines flagging them as positive (malicious).

We performed two main processing tasks to characterize malicious events in the carrier’s network:
(a) **Building Ground Truth for Malicious Traffic:** We utilized logs from two separate commercial IDS systems and AV scanners deployed at select end-client devices. Table 1 describes the alert triggering mechanisms of these systems. We collected IPs and URLs associated with alert events and submitted them to commercial URL scanners like VirusTotal to eliminate false positives and gather detailed information about the threats. We manually grouped the most prominent threats into four general categories: Trojans, Privacy Leakage Threats, Potentially Unwanted Applications (PUA), and SIP Threats.
(b) **Identifying Devices and Platforms:** We classified devices into four general categories: phones, tablets, hotspots/modems, and other devices, using registered make, model, and operating system information, and inferred device type, make, and OS type using User-Agent fields from DPI records.

**3. Characterizing Mobile Threats**

**3.1 Prevalence of Malicious Traffic**
We included non-HTTP malicious traffic, such as VoIP security events on ports 5060 and 5061, and security events on non-standard ports like 8080/8090, to capture a more complete view of malicious traffic in the cellular network. In the dataset, 0.23% of devices triggered security alerts, with 73.2% of these events originating from mobile devices. This puts the lower bound of the overall infection rate of mobile devices at 0.17%, which is significantly higher than the 0.0009% reported in [2]. Our notion of 'infection' is similar to that in [2], marking a device as infected when a security alert originates from it.

We ranked the individual infected devices based on the total number of security alerts generated over the week and found that the top 20% of devices account for more than 80% of the security alerts. The top 20% of infected devices primarily consisted of Android and iOS-based phones/tablets.

We extracted detailed information about the threat associated with each security event using commercial virus-scanning tools and manual inspections. We identified 327 unique threats in our dataset and categorized them into three classes: mobile-only, non-mobile, and cross-device threats. Figure 1a characterizes the macroscopic alerting behavior of these threats. A small fraction of threats (5-15%) is responsible for a major proportion (over 80%) of the observed alert traffic. However, mobile threats generally generate fewer alerts than non-mobile counterparts, indicating that attackers have adapted mobile malware to be stealthier and harder to detect.

**3.2 Top Mobile Threats**
We examined the threats that infected the most number of mobile devices. Malware writers often aim to infect as many devices as possible to maximize their gains. We used the number of devices affected by a threat to quantify its success in the cellular network. Figure 2 plots the infection effectiveness of cross-device and mobile-only threats. Only a few threats successfully affect a large number of devices, either cross-device or mobile-only.

**Table 2: Top Categories of Prevalent Mobile Malware**
| Threat Class | Threat Description | Unique Threats | Affected Mobile Devices | Affected Non-Mobile Devices | Associated Ports and IPs |
|--------------|--------------------|----------------|-------------------------|-----------------------------|--------------------------|
| Trojans      | Malware using social engineering, drive-by download, and advanced rootkits. | 8 | 1669 | 470 | 159, 53 |
| Privacy Leakage | Leaks sensitive information such as IMEI number and user location. | 2 | 1277 | 418 | 77, 8080, 80 |
| Adware and PUA | HTTP requests to known adware domains and requests with known malicious UA strings. | 3 | 1179 | 368 | 45, 80 |
| SIP Threats  | Illegal session information modification and replay attacks on SIP protocol. | 2 | 161 | 98 | 21, 5060, 5061 |

**Table 3: Types of Privacy Leakage**
| Type of Data | Affected Devices |
|--------------|------------------|
| IMEI Number  | 757              |
| Device Location | 603             |

**4. Network Footprints of Malicious Traffic**
We analyzed the aggregate network-level features of user traffic for both malicious and benign domains and demonstrated that they are sufficiently distinct. This allows us to build a machine learning classifier that identifies malicious domains using statistical properties of network traffic.

**5. Conclusion**
This paper provides a comprehensive characterization of malicious traffic in cellular data networks, revealing a higher infection rate and the prevalence of specific threat types. We also demonstrate the potential of using network-level features to detect malicious hosts, opening new directions for future research.