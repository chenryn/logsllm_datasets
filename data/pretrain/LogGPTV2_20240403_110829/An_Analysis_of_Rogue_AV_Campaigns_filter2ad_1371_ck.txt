anism enabled the KDR also drops, but not so low, and after a certain period
it stabilises to values slightly below the values without an attack . In Fig. 7 the
impact of the transient grey hole attack is shown, which as in the previous case
drastically decreases the delivery ratio. The detection and mitigation responds
similarly, but in this case it can be observed that the mechanism helps to a
fast recovery once the attack has ended. With this attack the detection delay
is longer and highly dependant on each node. The nodes close to the attackers
show a detection delay around 10-60 seconds after the beginning of the attack
for both continuous and transient modes. It is worth to say that this is a complex
attack to mitigate since once the informed vector is sent there is a contagious
impact on the other partitions while the mitigation is not enabled everywhere
(since the detection is not strong enough in some places with the same threshold
everywhere).
The results shown demonstrate that the approach is successful in creating
a resistance to the attacks that conform to the given threat model despite the
diﬃculties that the complexity of IC-MANET bring to the picture.
5.6 Locality and Classic Metrics
The most usual evaluation metrics for measuring the anomaly detection perfor-
mance are the Detection Rate (DR)1 and the False Positive Rate (FPR)2. In
this section we show why these metrics are less meaningful in IC-MANET. We
begin by discussing how to apply the metrics in the evaluation. To calculate
these metrics we need to determine whether during the period of alarm the node
was under attack. In intermittently connected networks the concept of being
under attack for a particular node is not clear. Just considering a ﬁxed attack
interval for all the nodes is meaningless, since attacks do not always take place
in a well-determined time interval and conﬁned space. Nodes can be isolated
from the attackers during some periods or can be too far from the attackers to
be signiﬁcantly aﬀected by them. Besides, some attacks can be propagated fur-
ther even if their source has stopped attacking, such as some types of ﬂooding
attacks. Hence, our attempt to account for the classic DR and FPR metrics,
is based on tagging the packets sent by the attacker and the packets sent in
response to them. Then, in each aggregation interval Ia(see Section 4.3) a node
has been considered as being under attack if at least one of the tagged packets
has been received in that interval.
1 DR = T P/(T P +F N ) where TP stands for true positives and FN for false negatives.
2 F P R = F P/(F P + T N ) where TN stands for true negatives.
354
J. Cucurull, M. Asplund, and S. Nadjm-Tehrani
i
i
)
c
e
s
/
s
t
k
p
(
s
n
o
s
s
m
s
n
a
r
t
f
o
r
e
b
m
u
N
)
c
e
s
/
s
t
k
p
(
s
n
o
s
s
m
s
n
a
r
t
f
i
i
o
r
e
b
m
u
N
Attack without detection and mitigation
Attack with detection and mitigation
No attack
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 4. Draining continuous attack
Attack without detection and mitigation
Attack with detection and mitigation
No attack
 1800
 1600
 1400
 1200
 1000
 800
 600
 400
 200
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 5. Draining transient attack
)
c
e
s
/
g
s
m
(
s
e
g
a
s
s
e
m
d
e
r
e
v
i
l
e
d
-
K
)
c
e
s
/
g
s
m
(
s
e
g
a
s
s
e
m
d
e
r
e
v
i
l
e
d
-
K
Anomaly Detection and Mitigation for Disaster Area Networks
355
No attack
Attack with detection and mitigation
Attack without detection and mitigation
Load introduced
 18
 16
 14
 12
 10
 8
 6
 4
 2
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 6. Grey hole continuous attack
No attack
Attack with detection and mitigation
Attack without detection and mitigation
Load introduced
 18
 16
 14
 12
 10
 8
 6
 4
 2
 0
 1000
 1200
 1400
 1600
 1800
 2000
 2200
 2400
 2600
 2800
 3000
Time (sec)
Fig. 7. Grey hole transient attack
356
J. Cucurull, M. Asplund, and S. Nadjm-Tehrani
)
%
(
R
D
 1
 0.8
 0.6
 0.4
 0.2
 0
 0
Continuous attack
Transient attack
 0.03
 0.06
 0.09
 0.12
 0.15
FPR (%)
)
%
(
R
D
 1
 0.8
 0.6
 0.4
 0.2
 0
 0
Continuous attack
Transient attack
 0.03
 0.06
 0.09
 0.12
FPR (%)
Fig. 8. ROC drain attack
Fig. 9. ROC grey hole attack
The network wide average results obtained in terms of DR and FPR, by
using diﬀerent T2 values have been depicted on Fig. 8 and 9. These numbers are
computed by averaging the performance of all 25 anomaly detectors over the
entire test interval. The curves demonstrate that in highly partitioned networks
with very diﬀerent conditions it is not feasible to analyse the results of the
detection mechanism on an aggregate basis using these metrics. While the earlier
results were convincing about the success of the approach, these curves show
mediocre results overall.
We have observed that the traﬃc ﬂow, the type of attack, and the number
of attackers in each partition produce very diﬀerent detection rates. The net-
work topology in our disaster area is composed of eight partitions more or less
stable along the whole simulation, with moving nodes acting as “bridges” over
the partitions. Analysing the results node by node we have conﬁrmed that the
parameter with more inﬂuence over the detection performance is the proximity
of the adversaries to the fair nodes. Table 1 show the best, worst, and aver-
age DR and FPR, for the continuous draining and grey hole attacks. Results
in each column are categorised into diﬀerent classes. Each class (diﬀerent rows
as described in column 1) shows the results aggregated for partitions that have
similar number of adversaries, i.e. partions with no adversaries, partitions with
1 adversary, and so on. There are around 1/3 of the fair nodes in each class. The
results, calculated with the alert aggregation threshold T2 at 5%, demonstrate
that the less the partition is aﬀected by attacks the worse is the performance of
the detection. That is, the classes with zero and one adversary are the ones that
reduce the average detection performance. Note that despite having partitions
with no adversaries, some attacks are received by sporadic contacts with other
partitions.
Another aspect which has been observed is that in the transient cases the false
positive rate is a bit lower than in the continuous cases. The reason is that the
attacks are always detected with a small delay, but the alarm also persists when