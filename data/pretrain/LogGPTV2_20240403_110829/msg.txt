### 适用系统
- Windows Server 2022
- Windows Server 2019
- Windows Server 2016
- Windows Server 2012 R2
- Windows Server 2012

### 功能说明
`msg` 命令用于向远程桌面会话主机服务器上的用户发送消息。

**注意：** 发送消息需要具备“Message”特殊访问权限。

### 语法
```plaintext
msg {用户名 | 会话名 | 会话ID | @文件名 | *} [/server:服务器名] [/time:秒数] [/v] [/w] [消息文本]
```

### 参数
- **用户名**
  - 指定要接收消息的用户名。如果未指定用户或会话，命令将显示错误消息。指定会话时，必须是活动会话。
- **会话名**
  - 指定要接收消息的会话名称。如果未指定用户或会话，命令将显示错误消息。指定会话时，必须是活动会话。
- **会话ID**
  - 指定要接收消息的会话的数字ID。
- **@文件名**
  - 指定包含用户名、会话名称和会话ID列表的文件，这些用户将接收消息。
- **\***
  - 向系统中的所有用户发送消息。
- **/server:服务器名**
  - 指定要接收消息的远程桌面会话主机服务器。如果未指定，则默认为当前登录的服务器。
- **/time:秒数**
  - 指定消息在用户屏幕上显示的时间（以秒为单位）。时间到达后，消息将消失。如果不设置时间限制，默认为60秒。
- **/v**
  - 显示正在执行的操作信息。
- **/w**
  - 等待用户确认已收到消息。使用此参数与 `/time:` 结合可以避免因用户未立即响应而导致的长时间等待。与 `/v` 结合使用也很有帮助。
- **消息文本**
  - 指定要发送的消息文本。如果没有指定消息，系统将提示您输入消息。要发送文件中的消息，请使用 `< 文件名` 的格式。

### 示例
1. **向 `User1` 的所有会话发送消息 "Let's meet at 1PM today"：**
   ```plaintext
   msg User1 Let's meet at 1PM today
   ```

2. **向会话 `modem02` 发送相同的消息：**
   ```plaintext
   msg modem02 Let's meet at 1PM today
   ```

3. **向文件 `userlist` 中列出的所有会话发送消息：**
   ```plaintext
   msg @userlist Let's meet at 1PM today
   ```

4. **向所有已登录用户发送消息：**
   ```plaintext
   msg * Let's meet at 1PM today
   ```

5. **向所有用户发送消息，并设置确认超时时间为10秒：**
   ```plaintext
   msg * /time:10 Let's meet at 1PM today
   ```

通过以上示例和参数说明，您可以根据需要灵活地使用 `msg` 命令来发送消息。