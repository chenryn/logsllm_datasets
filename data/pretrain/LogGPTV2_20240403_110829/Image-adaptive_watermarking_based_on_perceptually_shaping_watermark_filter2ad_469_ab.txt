Image number
Figure 2: The detection values of a set of water-
marked image samples.
(c1)
(c2)
(c3)
Figure 1: Test on ’Lena’. (a) Original image ’Lena’;
(b1-b3) The watermarked copies are obtained by
PSW and EX-PSW (the default value of l is set to
1, and r is set to 0.3 and 0.5 respectively). For PSW,
the global perceptual distance is set to 0.3, while for
EX-PSW, in each block, the perceptual distance is
set to 0.3; (c1-c3) The absolute diﬀerence between
original ’Lena’ and the watermarked copies shown
in (b1-b3), modiﬁed by a factor 5.
attacks: in this section some of the most signiﬁcant results
will be shown. For the experiments presented in the fol-
lowing, the perceptual distance between the host image and
the watermarked one is set to 0.3 to guarantee the image
transparency.
First, watermark invisibility is evaluated. A watermark was
embedded into image ’Lena’ by PSW and EX-PSW respec-
tively. In Fig. 1 (a), the original ’Lena’ image is presented,
while in Fig. 1 (b1-b3), the watermarked copies are shown:
the images are evidently undistinguishable (at left bottom
corner, the visible artifact resulted from the overﬂow of pixel
value after DCT transform). In Fig. 1 (c1-c3), the absolute
diﬀerence between the original image and the watermarked
ones, magniﬁed by a factor 5, is shown:
it is evident that
higher level watermark is hidden by EX-PSW into high ac-
tivity regions and around edges than PSW (see, for example,
the high level of watermark at the borders of the hat and
the shoulders of the girl, and over the feathers). And with
r increasing, the eﬀectiveness is becoming more prominent.
That illustrates that the local image characteristics are ex-
ploited more eﬃciently by EX-PSW.
Besides ’Lena’, additional 13 images of diﬀerent size were
also watermarked by EX-PSW and PSW. The resultant de-
tection values are shown in Fig. 2. It is observed that with-
PSW
EX−PSW r=0.1
EX−PSW r=0.4
3
2.5
2
l
e
u
a
V
n
o
i
t
c
e
e
D
t
1.5
1
0.83
0.5
0
10
20
30
40
50
60
70
80
90
100
Quality Factor
Figure 3: The output of detectors after JPEG com-
pression attack with a set of quality factors.
out attacks the detector of EX-PSW outputs larger detec-
tion values than one of PSW for all fourteen images. And
with the order r increasing, the detection values of EX-PSW
are also up, which demonstrates the analysis in Section VI
is correct.
In order to evaluate the robustness of the watermarking EX-
PSW, a serial of competition experiments are done under
some attacks including JPEG compression, additive noise,
ﬁltering, and cropping. These typical attacks were adopted
because we aimed at testing the resilience of the watermark
against the loss of information. All the experiments were
carried out on the ’Lena’ image. The threshold used for
detection was calculated with the given false positive possi-
bility Pf P = 10−8 [9, 18].
Fig. 3 shows that EX-PSW is more robust against JPEG
compression than PSW. EX-PSW with r = 0.4 can resist
JPEG compression with the quality factors above 20, which
is nearly lower one time than PSW. The eﬀect of noise attack
is illustrated in Fig. 4. It can be seen that both EX-PSW

l
s
e
u
a
V
n
o
i
t
c
e
t
e
D
2.6
2.4
2.2
2
1.8
1.6
1.4
1.2
1
0.83
0
PSW
EX−PSW r=0.1
EX−PSW r=0.4
Threshold
PSW
EX−PSW r=0.1
EX−PSW r=0.4
Threshold
l
e
u
a
V
n
o
i
t
c
e
t
e
D
3.5
3
2.5
2
1.5
1
0.83
10
20
30
Noise variance
40
50
60
128*128
112*112
96*96
80*80
64*64
48*48
32*32
16*16
Cropped area
Figure 4: The output of detectors after Gaussian
noise attack with zero mean and a set of variances.
Figure 6: The output of detectors after cropping
attack with a set of regions’ parameters given.
PSW
EX−PSW r=0.1
EX−PSW r=0.4
Threshold
3
2.5
2
1.5
1
0.83
0.5
l
e
u
a
W
n
o
i
t
c
e
t
e
D
0.2
0.4
0.6
0.8
1
Filter Width
1.2
1.4
1.6
1.8
2
Figure 5: The output of detectors after Gaussian
low-pass ﬁltering with a set of ﬁlter widths.
and PSW are very robust against noise attack. Principally,
EX-PSW does better than PSW in this respect.
In Fig. 5, the detector response is given under Gaussian,
low-pass ﬁltering with varying standard deviation (width).
Other than noising, all the detectors are sensitive to ﬁlter-
ing, which is relative to the property of linear correlation de-
tector. The detection values begin falling oﬀ sharply when
the ﬁlter width exceeds 0.4. However, EX-PSW with larger
detection values can tolerant ﬁltering distortion with a rel-
atively higher width, although the improvement is not very
signiﬁcant.
Fig. 6 shows the response of the detectors after a serial of
cropping is applied to the watermarked image. The detec-
tion value is kept very high, even the cropped portion has
only the size of 16 × 16 pixels. The possible explanation
for the excellent results is that the local image characteris-
tics are suﬃciently exploited to improve the robustness of
watermarking.

8. CONCLUSION
A new image-adaptive watermarking has been proposed in
this paper.
Its main idea is to perceptually shape water-
mark blockwise. Unlike the traditional block-based water-
marking, an individual gain factor is assigned to each block
during embedding, which allows us to suﬃciently exploit
the local image characteristics. In one block, we obtain the
maximum detection value under the given distortion con-
straint described by Watson’s model. Further, we proposed
the watermarking EX-PSW to enhance detection value. As
for estimating image quality, we have pointed out that the
perceptual distance is suitable for block with appropriate
size, but not the whole image. We also detailedly described
how to adjust the parameters in EX-PSW, which is essen-
tial and eﬀective to seek the tradeoﬀ between invisibility
and robustness. Both theoretical analysis and experimental
results demonstrated that the robustness of the proposed
watermarking is improved.
9. ACKNOWLEDGMENTS
The authors would like to thank Xuying Zhao of Institute
of Automation for many fruitful discussions. The authors
also want to thank the anonymous reviewers for their many
valuable comments.
10. REFERENCES
[1] M. Barni, F. Bartolini, V. Cappellini, and A. Piva. A
dct-domain system for robust image watermarking.
IEEE Transactions on Signal Processing,
66(3):357–372, 1998.
[2] M. Barni and A. P. F. Bartolini. Improved
wavelet-based watermarking through pixel-wise
masking. IEEE Transactions on Image Processing,
10(5):783–791, May 2001.
[3] I. J. Cox and M. L. Miller. A review of watermarking
and the importance of perceptual modeling. In Proc.
Electronic Imaging, February 1997.
[4] I. J. Cox, M. L. Miller, and J. A. Bloom. Digital
Watermarking. Academic Press, San Francisco, 2002.
[5] J. F. Delaigle and B. M. C. De Vleeschouwer.
Watermarking algorithm based on human visual
model. IEEE Transactions on Signal Processing,
66(3):319–335, 1998.
[6] N. Jayant, J. Johnston, and R. Safranek. Signal
compression based on models of human perception. In
Proc. IEEE, volume 81, Oct. 1993.
APPENDIX
A. THE EMBEDDING STRATEGY WITH
HVM
Here we prove Inequality (11) and analyze how to apply
HVM for watermarking.
Equation (10) can be reshaped as
[7] D. Kirovski and H. S. Malvar. Spread-spectrum
watermarking of audio signals. IEEE Transactions on
Signal Processing, 51(4):1020 – 1033, 2003.
where
(i,j)∈Bk
P k
ij = 1
[8] A. S. Lewis and G. Knowles. Image compression using
the 2-d wavelet transform. IEEE Trans. Image
Processing, 1:244–250, 1992.
[9] M. L. Miller and J. A. Bloom. Computing the
probability of false watermark detection. In Proceeding
of the Third International Workshop on Information
Hiding, pages 146–158, 1999.
[10] A. Nikolaidis and I. Pitas. Region-based image
watermarking. IEEE Transactions on Image
Processing, 10(11):1726–1740, 2001.
[11] C. Podilchuk and W. Zeng. Image-adaptive
watermarking using visual models. IEEE J. Selected
Areas Comm., 16(4):525–539, May 1998.
[12] V. Saravanan, P. Bora, and D. Ghosh. Oblivious
image-adaptive watermarking using quantization
index modulation. In The Eighth National Conf. On
Communications, India, pages 26–37, Jan 2002.
[13] H. M. Tsai and L. W. Chang. Highly imperceptible
video watermarking with the watson’s dct-based
visual model. In International Conference on
Multimedia and Expo, pages 1927 – 1930. IEEE
Computer Society, June 2004.
(23)
(24)
(25)
(27)
(28)
P k
ij =
αk|ws(i, j)|
L2T s(i, j)
(i, j) ∈ Bk
As a result, we have
0 ≤ P k
ij ≤ 1
To maximize the detection value ρk deﬁned as Equation
(26), the sign of ws(i, j) should be made to be the same
as one of wm(i, j).
αk
ws(i, j)wm(i, j) + ρko
(26)
ρk =
L2 (i,j)∈Bk
L2 (i,j)∈Bk
αk
Therefore the equivalent expression for Equation (26) is
ρk =
|ws(i, j)wm(i, j)| + ρko
To substitute Equation (24) into Equation (27) yields
where
ρk = T (i,j)∈Bk |s(i, j)wm(i, j)| (i,j)∈Bk
(i,j)∈Bk |s(i, j)wm(i, j)|
|s(i, j)wm(i, j)|
ij =
Qk
So we have
Qk
ij = 1
(i,j)∈Bk
0 ≤ Qk
ij ≤ 1
P k
ijQk
ij + ρko
(i, j) ∈ Bk
(29)
(30)
(31)
Combining Equation (23), (30), and Inequality (25), (31), it
is easy to derive that
(i,j)∈Bk
ijQk
P k
ij ≤ max
(i,j)∈Bk
Qk
ij
(32)
Finally, substituting Equation (29) and Inequality (32) into
Equation (28), we obtain
ρk ≤ T max
(i,j)∈Bk |s(i, j)wm(i, j)| + ρko
(33)
Inequality (33) upper-bounds the detection value with Wat-
son’s model as distortion measurement.
From Inequality (32), it is observed that the choice of ws(i, j)
to improve detection value should make P k
ij as large as pos-
sible at the point where Qk
ij is the largest. According to the
idea, a simple strategy to design ws(i, j) is represented by
|ws(i, j)|
s(i, j)
= (|s(i, j)wm(i, j)|)l
(34)
0
[14] S. Voloshynovskiy, S. Pereira, V.Iquise, and T. Pun.
Attack modelling: Towards a second generation
watermarking benchmark. Signal Processing, Special
Issue, 81(6):1177–1214, May 2001.
and
[15] A. B. Watson, G. Y. Yang, J. A. Solomon, and
J. Villasenor. Visual thresholds for wavelet
quantization error, spie-2657. pages 381–392, 1996.
[16] B. Watson. Dct quantization matrices optimized for
individual images. Human Vision, Visual Processing,
and Digital Display IV, SPIE-1913, pages 202–216,
1993.
[17] R. B. Wolfgang, C. I. Podilchuk, and E. J. Delp.
Perceptual watermarks for digital images and video. In
Proc. IEEE, volume 87, pages 1108–1126, July 1999.
[18] X. S. Zhu and Y. S. Wang. Better use of human visual
model in watermarking based on linear prediction
synthesis ﬁlter. In International Workshop on Digital
Watermarking IWDW 2004, Lecture Notes in
Computer Science (LNCS), volume 3304, pages 66–76,
2005.
where the sign function, sgn(·), is deﬁned as
t ≥ 0,
t  0. Considering ws(i, j) has the same sign with
wm(i, j), we acquire the expression of ws(i, j) from Equation
(34) as
ws(i, j) = sgn(wm(i, j))s(i, j)l+1|wm(i, j)|l
(35)
