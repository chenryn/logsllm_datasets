titleblackhat:us-23 MoustachedBouncer: AitM-Powered Surveillance via Belarus ISPs
An APT group conducting long-term espionage against diplomats, leveraging email-based C&C protocols, C++ modular backdoors, and adversary-in-the-middle (AitM) attacks… Sounds like the infamous Turla? Think again! We will introduce MoustachedBouncer: a group that's avoided the spotlight while displaying highly advanced capabilities that very much put the "A" in APT.MoustachedBouncer has been using AitM in Belarus to redirect potential targets during captive portal checks. Targeted diplomats are shown fake Windows Update warnings and end up compromised with a custom malware family that we have named Disco. We believe that the tampering is done at the ISP level against specific IP addresses, possibly using SORM devices installed at the country's ISPs, suggesting MoustachedBouncer has full access to the backends of several Belarusian ISPs.We tracked the group's inception back to 2014, when it started using the NightClub implant that leverages email protocols; the ISP-level AitM attacks have been ongoing since 2020. In late February 2022, as the Russia-Ukraine war expanded to the whole country, we detected MoustachedBouncer doing an AitM attack against the embassy of a European country in Belarus.Interestingly, we also discovered evidence of close collaboration between MoustachedBouncer and another group known as Winter Vivern, which likely also originates from the same country and targets government staff in Europe – including Ukraine. We will detail the group's spearphishing campaigns, show how it exploits XSS vulnerabilities in Zimbra in order to steal credentials, and how its infrastructure overlaps with MoustachedBouncer.Finally, we will showcase what happens at the DNS, HTTP, and SMB level, in a network compromised by MoustachedBouncer, and provide practical resources defenders can use against AitM attacks and the implants of this group. Considering Belarus's geopolitical position in the Russia-Ukraine war, MoustachedBouncer's activities need to be high on every threat intelligence analyst's watchlist.