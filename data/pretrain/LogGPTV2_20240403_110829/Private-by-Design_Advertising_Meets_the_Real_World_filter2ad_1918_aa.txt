title:Private-by-Design Advertising Meets the Real World
author:Alexey Reznichenko and
Paul Francis
PRIVATE-BY-DESIGN ADVERTISING AND
ANALYTICS: FROM THEORY TO PRACTICE
by
Alexey Reznichenko
Thesis approved
by the Department of Computer Science
of the University of Kaiserslautern (TU Kaiserslautern)
for the award of the Doctoral Degree
Doctor of Engineering (Dr.-Ing.)
Defense Date:
Dean:
Chair of the Committee: Prof. Dr. Rupak Majumdar
First Reviewer:
Second Reviewer:
26 September 2014
Prof. Dr. Klaus Schneider
Prof. Dr. Paul Francis
Prof. Dr. Jens Schmitt
D 386
ABSTRACT
There are a number of designs for an online advertising system that allow
for behavioral targeting without revealing user online behavior or user inter-
est proﬁles to the ad network. Although these designs purport to be practical
solutions, none of them adequately consider the role of ad auctions, which to-
day are central to the operation of online advertising systems. Moreover, none
of the proposed designs have been deployed in real-life settings. In this thesis,
we present an effort to ﬁll this gap. First, we address the challenge of running
ad auctions that leverage user proﬁles while keeping the proﬁle information pri-
vate. We deﬁne the problem, broadly explore the solution space, and discuss the
pros and cons of these solutions. We analyze the performance of our solutions
using data from Microsoft Bing advertising auctions. We conclude that, while
none of our auctions are ideal in all respects, they are adequate and practical
solutions. Second, we build and evaluate a fully functional prototype of a prac-
tical privacy-preserving ad system at a reasonably large scale. With more than
13K opted-in users, our system was in operation for over two months serving
an average of 4800 active users daily. During the last month alone, we registered
790K ad views, 417 clicks, and even a small number of product purchases. Our
system obtained click-through rates comparable with those for Google display
ads. In addition, our prototype is equipped with a differentially private analyt-
ics mechanism, which we used as the primary means for gathering experimental
data. In this thesis, we describe our ﬁrst-hand experience and lessons learned
in running the world’s ﬁrst fully operational “private-by-design” behavioral ad-
vertising and analytics system.
To Zoe.
ACKNOWLEDGEMENTS
While “der Weg ist das Ziel”, a thesis is certainly a milestone on that path, for
that reason, I would like to thank all the people who helped me make it this far,
and also those who shared this part of the journey with me – it surely was a fun
ride!
It goes without saying that I am extremely grateful to my adviser, Paul Fran-
cis, for many things, among others for having me on board the Privad project,
for letting me spend so many summers at Google, for coming forward while US
government took time to decide whether I am a threat to national security or
not.
I would like to thank Saikat Guha for his tremendous help and for laying
down the path, which I, to a large extent, merely followed. For me, Saikat em-
bodies all the qualities of a researcher one can only aspire to be: inquisitiveness,
commitment, keenness; I hope that some of these qualities rubbed off on me.
I would like to thank my Google hosts, Damon Kohler, Mauricio Zuluaga,
and Manpreet Sight, with whom I worked on some really exciting projects, dur-
ing which I learned a great deal of hands-on software and systems engineering.
I would like to thank my friends and collaborators, Bin Cheng and Ruichuan
Chen, joint work with whom appears in this thesis. Istemi Ekin Akkus has been
a great lab mate, thank you for letting me bounce ideas off of you and listening
to my rambles, for sharing the ofﬁce as well as a few enjoyable beers.
I am also grateful to all students, faculty and staff members of MPI-SWS
for creating a great learning environment. In particular, I would like to thank
Tobias Kaufmann and Christian Klein for their help with all things IT-related,
Susanne Girard, Vera Laubscher, Corinna Kopke, and Maria-Louise Albrecht for
their help with organisational issues and navigation in the German bureaucratic
iii
system, Rose Hoberman for her help with my writings as well as her invaluable
soft-skills seminars.
I am grateful to my family, Mam, Babushka, Ded, Igor, Nastya, and Senya,
who gave me everything I have and supported me in all my undertakings. Also,
I would like to thank my, almost family, physics teacher Nina Semenovna (sorry,
fusion power will have to wait until the next time), for giving me the motivation
to study and appreciate science.
Finally, I would like to give my gratitude to my other half, Yulia, for her
endless support and encouragement, for pushing me to stay the course. More
than that, thank you for enduring my regular grumbling and occasional ﬁts of
nihilism. Without you, I would not be able to enjoy my life (or have one outside
the lab, for that matter).
iv
.
.
.
.
Dedication .
.
Acknowledgements .
.
Table of Contents .
List of Figures .
.
.
.
TABLE OF CONTENTS
ii
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
iii
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
v
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii
1
Introduction
1.1 On the Internet Someone Knows You Are a Dog . . . . . . . . . .
1.2 Private-by-Design Advertising . . . . . . . . . . . . . . . . . . . .
1.3 Contributions .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Structure of this Thesis . . . . . . . . . . . . . . . . . . . . . . . . .
1.4
I Auctions in Private-by-Design Internet Advertising
2 Background and Related Work
2.1 Current Second Price Ad Systems . . . . . . . . . . . . . . . . . . .
2.2 Abstract Private-by-Design Advertising . . . . . . . . . . . . . . .
2.3 Related Work .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3 Designing Online Ad Auctions
3.1 Auction Goals .
3.2 Detailed Designs
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2.1 Rank-at-Client (RaC) . . . . . . . . . . . . . . . . . . . . . .
3.2.2 Rank-at-Broker (RaB) . . . . . . . . . . . . . . . . . . . . . .
3.2.3 Rank-at-Third-Party (RaT) . . . . . . . . . . . . . . . . . . .
3.2.4 Homomorphic Encryption Variant (RaC, RaB, and RaT)
.
3.3 Computing User Score . . . . . . . . . . . . . . . . . . . . . . . . .
4 Auction Analysis
4.1 Privacy Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Auction Properties
4.2.1
System delays . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2.2 Client selection . . . . . . . . . . . . . . . . . . . . . . . . .
4.2.3 Overhead and Latency . . . . . . . . . . . . . . . . . . . . .
4.2.4 Auction Scope . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.3 Attacks .
.
4.4 Discussion .
.
.
.
.
.
5 Trace-Based Simulation: Effect of Churn
5.1 What Causes Churn? . . . . . . . . . . . . . . . . . . . . . . . . . .
5.2 How Does Churn Affect Auctions? . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5.3 Dataset .
.
5.4 Methodology .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
.
.
1
1
2
3
5
7
8
9
11
13
15
15
18
18
20
23
24
24
27
27
29
29
30
31
32
32
35
36
36
37
38
38
v
5.5
Simulation Results
. . . . . . . . . . . . . . . . . . . . . . . . . . .
40
II Private-by-Design Advertising and Analytics Meet the
Real World
45
6 Background and Related Work
6.1 Privad Model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.2 PDDP Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6.3 Related Work .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
.
7 Prototype Details
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.1 User Proﬁling .
7.2 Ad Generation .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.3 Ad Selection and Placement . . . . . . . . . . . . . . . . . . . . . .
7.4 Message Exchange . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.5 Privad Implementation . . . . . . . . . . . . . . . . . . . . . . . . .
7.6 Client Details
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
7.7 Practical Privacy Issues . . . . . . . . . . . . . . . . . . . . . . . . .
7.8 PDDP Implementation . . . . . . . . . . . . . . . . . . . . . . . . .
.
8 Large Scale Deployment
8.1 Deploying Privad at Scale . . . . . . . . . . . . . . . . . . . . . . .
8.2 Privad Advertising . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
48
61
64
68
68
70
72
73
75
76
77
80
84
84
88
9 Collecting Data with PDDP
93
94
9.1 Aggregate User Characteristics . . . . . . . . . . . . . . . . . . . .
9.2 Comparing Privad and Google Performance . . . . . . . . . . . .
99
9.3 Comparing Search and Display Performance . . . . . . . . . . . . 103
9.4 Clickers vs. Non-clickers . . . . . . . . . . . . . . . . . . . . . . . . 106
9.5 Analysis
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
.
.
.
.
10 Summary and Future Directions
Bibliography
Curriculum Vitae
112
116
122
vi
LIST OF FIGURES
2.1 Abstract private-by-design advertising system . . . . . . . . . . .
3.1
3.2
3.3
Rank-at-Client auctions . . . . . . . . . . . . . . . . . . . . . . . .
Rank-at-Broker auctions . . . . . . . . . . . . . . . . . . . . . . . .
Rank-at-Third-Party auctions . . . . . . . . . . . . . . . . . . . . .
5.1 Change in broker’s revenue . . . . . . . . . . . . . . . . . . . . . .
5.2
Fraction of auctions with modiﬁed rankings . . . . . . . . . . . .
12
19
20
23
41
43
49
The Privad architecture . . . . . . . . . . . . . . . . . . . . . . . .
6.1
53
6.2
The client framework . . . . . . . . . . . . . . . . . . . . . . . . .
55
6.3 Message exchange for Pub-Sub ad dissemination . . . . . . . . .
56
6.4 Message exchange for view/click reporting . . . . . . . . . . . .
6.5
62
Traditional deployment model for Differentially Private systems
6.6 Differential privacy in the context of private-by-design advertising 64
7.1 Ad generation pipeline . . . . . . . . . . . . . . . . . . . . . . . .
Examples of auto-generated Privad ads . . . . . . . . . . . . . . .
7.2
7.3
PDDP - the private analytics system . . . . . . . . . . . . . . . . .
8.1
Privad’s participation request . . . . . . . . . . . . . . . . . . . . .
8.2 CDFs of per-client daily communications overhead . . . . . . . .
8.3 Hourly distributions of ad requests, views and clicks . . . . . . .
8.4 CDFs of delays between ad requests and ad views, and between
ad views and ad clicks . . . . . . . . . . . . . . . . . . . . . . . . .
8.5 CCDFs of cosine similarity between terms in ads and corre-
. . . . . . . . . . . . . . . . . . . . . . . . .
sponding ad requests