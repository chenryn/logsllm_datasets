The occurrence of mice, however, shows well-established behavior. They are large
in number but grow with the continuation of traﬃc stream.
4.2 Traﬃc Distribution: Elephants and Mice
In Figures 3 and 4, we analyze the traﬃc carried by elephants and mice when
considering the frequency of occurrence of packets and the the volume of traﬃc
carried by each FlowID as the basis of ﬂow probability calculation. While 99%
FlowIDs carry 70% of network traﬃc, elephant ﬂows (less than 1%) carry 30% of
the traﬃc. Such dynamics is unaﬀected if we choose the frequency or the volume
of traﬃc as the basic for probability calculation.
Fast Classiﬁcation and Estimation of Internet Traﬃc Flows
161
100
90
80
70
60
50
40
30
20
10
0
0 
Elephant
Mice
5
Time (minutes)
10
15
r
o
f
c
i
f
f
a
r
T
f
o
t
n
e
c
r
e
P
i
e
c
M
d
n
a
t
n
a
h
p
e
E
l
Fig. 3. Traﬃc Distribution of Elephant Flows considering the frequency of occurrence
i )
of packets in each ﬂow (i.e., P p
l
w
o
F
c
i
f
f
a
r
T
f
t
o
e
g
a
n
e
c
r
e
P
i
e
c
M
d
n
a
t
n
a
h
p
e
E
l
r
o
f
100
90
80
70
60
50
40
30
20
10
0
0
0.5
Elephant Flow
Mice Flow
2.5
3
x 1011
1
Time (nanoseconds)
1.5
2
Fig. 4. Traﬃc Distribution of Elephant Flows considering the volume of traﬃc in each
i )
ﬂow (i.e., P b
4.3 Entropy Distribution: Elephants and Mice
In Figures 5 and 6, we show the temporal variation of the entropy of the ratio
of entropy between the elephants and mice, where only of the FlowIDs consid-
ered to be mice. During the ﬁrst 500msecs of input traﬃc, we observe a dip
in the entropy of the elephant ﬂows. This is due to the presence of bursty ele-
phant ﬂows which causes a temporary increase in the probability of the set of
elephants. However, as the experiment continues, the entropy of the mice in-
creases while the entropy of the elephant ﬂows decreases. Since the entropy of
the typical set is a decreasing sequence with respect to the number of FlowIDs,
the probability and proportion of FlowIDs classiﬁed as elephants increases.
162
S.R. Kundu et al.
f
o
o
i
t
a
R
y
p
o
r
t
n
E
l
s
w
o
F
e
c
M
d
n
a
i
t
n
a
h
p
e
E
l
l
s
w
o
F
e
c
M
i
f
o
y
p
o
r
t
n
E
0.12
0.11
0.1
0.09
0.08
0.07
0.06
0.05
0 
5
Time (minutes)
10
15
Fig. 5. Ratio of entropy between the elephants and mice
8.5
8
7.5
7
6.5
6
0 
5
Time (minutes)
10
15
Fig. 6. Temporal distribution of Entropy of mice
y
t
i
s
n
e
D
0.2
0.18
0.16
0.14
0.12
0.1
0.08
0.06
0.04
0.02
2
4
6
8
f
(x)
x
10
12
14
16
Fig. 7. Original pdf of the elephants present in the traﬃc stream
Fast Classiﬁcation and Estimation of Internet Traﬃc Flows
163
Fig. 8. Pdf estimated using parzen window technique
This unique trend of entropy variation guarantees conservative, yet accurate ﬂow
classiﬁcation of high traﬃc volumes.
Estimating the density function of the distribution. In Figures 7 and 8,
we plot the pdf of the elephants present in the original traﬃc stream versus
the pdf of elephants identiﬁed using our approach based on the Parzen window
technique. Observe that the trend observed is similar in both the cases.
5 Conclusions
In this paper we have focused on classifying and estimating the properties of
elephants and mice based on AEP from Information Theory. Although consider-
able attention has been directed in identifying high and low traﬃc volumes, we
feel that our approach using typical sequences simpliﬁes the problem to a large
extent and provides a standard yardstick for deﬁning such long-lived-ﬂows. We
have evaluated our algorithm with the approach of [8], and have observed that
our approach is able to identify bursty elephant ﬂows and at the same time does
not overestimate the number of occurrence of the elephants. As part of future
work, we would like to carry out these observations on NLANR trace of more
than one hour duration and see how the classiﬁcation and estimation algorithms
perform if the input traﬃc becomes smooth with non-negligent coeﬃcient of
variation [14].
References
1. J. S. Marron, F. Hernandez-Campos and F. D. Smith, “Mice and Elephants Visu-
alization of Internet Traﬃc”, available online at citeseer.ist.psu.edu/531734.html.
2. A. Kuzmanovic and E. Knightly, “Low-Rate TCP-Targeted Denial of Service At-
tacks (The Shrew vs. the Mice and Elephants)”, in Proceedings of ACM SIG-
COMM, August 2003.
164
S.R. Kundu et al.
3. Y. Joo, V. Riberio, A. Feldmann, A. C. Gilbert and W. Willinger, “On the impact
of variability on the buﬀer dynamics in IP networks”, Proc. 37th Annual Allerton
Conference on Communication, Control and Computing, September 1999.
4. K. Papagiannaki, N. Taft, S. Bhattacharya, P. Thiran, K. Salamatian and C. Diot
“On the Feasibility of Identifying Elephants in Internet Backbone Traﬃc”, Sprint
ATL Technical Report TR01-ATL-110918, November 2001.
5. N. Duﬃeld, C. Lund and M. Thorup, “Properties and Prediction of Flow Statistics
from Sampled Packet Streams”, in Proc. of ACM SIGCOMM Internet Measure-
ment Workshop, Nov. 2002.
6. N. Duﬃeld, C. Lund and M. Thorup, “Estimating Flow Distributions from Sampled
Flow Statistics”, in Proc. of ACM SIGMETRICS, August 2003.
7. A. Kumar, J. Xu, O. Spatschek and L. Li, “Space-Code Bloom Filter for Eﬃcient
Per-Flow Traﬃc Measurement”, IEEE INFOCOM, August 25-29, 2004.
8. T. Mori, M. Uchida, R. Kawahara, J. Pan and S. Goto, “Identifying elephant ﬂows
through periodically sampled packets”, in Proceedings of the ACM SIGCOMM
Workshop on Internet Measurment Workshop (IMW), 2004.
9. J. Sommers and P. Barford, “Self-Conﬁguring Network Traﬃc Generation”, in
Proc. of ACM SIGCOMM Internet Measurement Workshop, October 25-27, 2004.
10. C. Estan and G. Varghese, “New directions in traﬃc measurement and accounting:
Focusing on the elephants, ignoring the mice”, ACM Trans. Comput. Syst., vol.
21, no. 3, 2003.
11. K. Papagiannaki, N. Taft, S. Bhattacharyya, P. Thiran, K. Salamatian and C. Diot,
“A pragmatic deﬁnition of elephants in internet backbone traﬃc”, in Proceedings of
the ACM SIGCOMM Workshop on Internet Measurment Workshop (IMW), 2002.
12. J. Wallerich, H. Dreger, A. Feldman, B. Krishnamurthy and W. Willinger, “A
Methodology for Studying Persistency Aspects of Internet Flows”, in ACM SIG-
COMM Computer Communication Review, vol. 35, Issue 2, pp. 23 - 36, 2004.
13. A. Lall, V. Sekhar, M. Ogihara, J. Xu and H. Zhang, “Data Streaming Algorithms
for Estimating Entropy of Network Traﬃc”, in Proc. of ACM SIGMETRICS, June
2006.
14. J. Cao, W. S. Cleveland, D. Lin and D. X. Sun, ”Internet Traﬃc Tends Towards
Poisson and Independent as Load Increases”,in Nonlinear Estimation and Classi-
ﬁcation, New York, Springer-Verlag, 2002.
15. NLANR AMP Website: http://pma.nlanr.net/Special/
16. N. Brownlee, “Understanding Internet Traﬃc Streams: Dragonﬂies and Tortoises”,
IEEE Communications Magazine, Cot. 2002.
17. A. Kumar, M. Sung, J. Xu and L. Wang, “Data Streaming Algorithms for Eﬃcient
and Accurate Estimation of Flow Size Distribution”, ACM SIGMETRICS, August
25-29, 2003.
18. T. M. Cover and J. A. Thomas ”Elements of Information Theory”, John Wiley, 1991.
19. E. Parzen, “On estimation of a probability density function and mode,” Time
Series Analysis Papers. San Francisco, CA: Holden-Day, 1967.
20. S. Raudys, “On the eﬀectiveness of Parzen window classiﬁer,” Informatics, vol. 2,
no. 3, pp 435-454, 1991.
21. B. W. Silveman, Density Estimation for Statistics and Data Analysis, Chapman
and Hall, 1986.
22. S. R. Kundu, B. Chakravarty, K. Basu, and S. K. Das, “FastFlow: A Framework
for Accurate Characterization of Network Traﬃc”, IEEE ICDCS, 2006.
23. M. Finkelstein, H. G. Tucker and J. A. Veeh, Conﬁdence Intervals for the number
of Unseen Types, Statistics and Probability Letters, vol. 37, pp. 423-430, 1998.