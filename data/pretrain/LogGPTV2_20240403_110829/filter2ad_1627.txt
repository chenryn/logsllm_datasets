title:Measurement Informed Route Selection
author:Nick G. Duffield and
Kartik Gopalan and
Michael R. Hines and
Aman Shaikh and
Jacobus E. van der Merwe
Measurement Informed Route Selection
Nick Duﬃeld1, Kartik Gopalan2, Michael R. Hines2
Aman Shaikh1, and Jacobus E. van der Merwe1
1 AT&T Labs–Research
{duffield,ashaikh,kobus}@research.att.com
2 Binghamton University
{kartik,mhines}@cs.binghamton.edu
1 Motivation
Popular Internet applications exhibit subtle dependencies on data path char-
acteristics [3,5]. On the other hand, various studies [2,1] have shown that non-
default Internet paths can have dramatically diﬀerent quality characteristics
compared to default paths. Unfortunately, the existing Internet routing infras-
tructure is not able to beneﬁt from these observations. However, recently pro-
posed routing architectures [4] open up the possibility to ease these constraints
by allowing route selection to be more dynamic and to be informed by informa-
tion outside the routing protocol. Motivated by these observations, in the work
presented here, we explore the possibility of informing route selection based on
measured path properties. Speciﬁcally, we observe that from their vantage points
in the Internet topology, Tier-1 and other large ISPs typically have multiple
possible routes that can be used to reach the majority of destination preﬁxes
on the Internet. By monitoring routing information we track the availability
of alternative paths available from a Tier-1 ISP. At the same time we perform
detailed measurements of loss and delay to a large number of Internet destina-
tions and characterize various properties of these alternate paths to determine:
(i) Whether there are signiﬁcant diﬀerences in the properties of these diﬀerent
paths that would warrant its consideration as part of the route selection pro-
cess. (ii) The stability of these properties over various timescales which would
impact how they can be utilized and dictate the requirements of a measurement
infrastructure that can provide such information. We believe this is the ﬁrst such
study involving a single Tier-1 ISP.
2 Measurement Informed Route Selection
The essence of our approach is depicted in Figure 2. Consider source s1 and des-
tination d1. s1 connects to network AS0 at ingress router i1. Network AS0 has
two paths available to reach destination d1, through egress router e2 and net-
work AS1 and through egress router e3 and network AS2. In order to determine
the “best” path, we assume the existence of a measurement infrastructure, such
that performance measurements are available for the paths across AS0 between
S. Uhlig, K. Papagiannaki, and O. Bonaventure (Eds.): PAM 2007, LNCS 4427, pp. 250–254, 2007.
c(cid:2) Springer-Verlag Berlin Heidelberg 2007
Measurement Informed Route Selection
251
Fig. 1. Measurement
Informed
Route Selection: Composite mea-
surements (s1, s2, d1) and (s1, s3, d1)
and corresponding alternate paths
Fig. 2. Delay Measurement and
Advantage: most recent measured de-
lay on default and alternate paths. Ad-
vantage is ≥ δ0 during interval [t1, t4)
the ingress router and the two egress routers, and from each of the egress routers
to the destination. To simplify the notation, in what follows we will ignore the
ingress and egress router notation and assume that a measurement source is
co-resident with each of the routers in AS0. The set of measurements between
the ingress router and the two egress routers is thus denoted by Ms1,s2 and
Ms1,s3 respectively, and that between the egress routers and the destination by
Ms2,d1 and Ms3,d1. Given this information, a network equipped with the appro-
priate routing infrastructure [4] can select the “best” route between s1 and d1
by appropriate combination of measured characteristics along the two available
composite measurement paths (s1, s2, d1) and (s1, s3, d1). In this abstract we
present initial results of a measurement study in which we evaluate the beneﬁt
of such Measurement Informed Route Selection as compared with the default
BGP route selection as observed in a Tier-1 ISP.
3 Methodology
Composite Performance Metrics. Given loss and delay (λ1, δ1) on the path
(s1, s2) and (λ2, δ2) on (s2, d1), the composite transmission rate for the composite
path (s1, s2, d1) is the product 1 − λ = (1 − λ1)(1 − λ2). The composite delay
is the sum δ = δ1 + δ2. The composite metric for loss λ(s1,s2,d1),t at time t is
the composite of the most recent measurements λ(s1,s2),t and λ(s2,d1),t on the
internal and external segments, and similarly for delay δ.
Performance Advantage of Alternate Routes. A route trajectory of a
source-destination (SD) pair (s, d) speciﬁes for each time t a source σ(t) which
, d) is
is s if the default path is used, and s
to be used. The loss advantage of using a route trajectory σ is L(σ(t), t) =
λ(s,d),t − λ(s,σ(t),d),t, i.e., the diﬀerence between the most recent performance
metric on the default path and the alternate path (s, σ(t), d). (Here λ(s,s,d),t
simply denotes λ(s,d),t.) The delay advantage D(σ(t), t) is similarly deﬁned.
(cid:2)= s if the alternate path (s, s
(cid:3)
(cid:3)
252
N. Duﬃeld et al.
Available Performance Advantage. The available performance advantage
represents a baseline advantage that would be obtained by a routing policy that
enabled instant selection of the best performing path whenever a new direct or
composite measurement becomes available. Figure 2 illustrates delay measure-
ments for a default path and two alternates. In each case, the curve shows the
value of the most recent measurement on that path, and is hence a right con-
tinuous step function, the measurements occurring at the steps. In the interval
[t1, t2), alternate 1 has the best most recent performance measurement; in [t2, t3)
alternate 2 is best; in [t3, t4) alternate 1 is best again; prior to t1 and after t4 the
default route is best. Note the available delay advantage is positive, i.e., there is
beneﬁt in using a non-default path, only in [t1, t4).
Temporal Performance Advantage Metric. We analyze the duration of
runs of performance advantage, i.e., maximal time intervals in which the avail-
able performance advantage for a given SD pair exceeds a given level. Longer
runs are more useful, since the payoﬀ for switching routes is longer lived. If runs
are shorter than the typical settle down time after route changes, the period
of advantage would be over before its beneﬁt could be utilized. Our delay run
performance statistic is the time fraction FD(τ, δ): the fraction of the measure-
ment interval that a given SD pair spent in a delay advantage run of duration
greater than τ and whose performance advantage exceeds δ, for each τ, δ > 0.
For example, with reference to Figure 2, measuring over [0, t5], then for any
τ  τ = 2000
Available Delay Adv.  Runs of Duration  > τ = 2000
0.25
0.2
0.15
0.1
0.05
0
0.01
loss ≥ 1%
loss ≥ 2%
loss ≥ 3%
loss ≥ 6%
loss ≥ 11%
.
n
o
i
t
i
u
b
i
r
t
s
D
e
v
i
t
l
a
u
m
u
C
0.1
Time Fraction FL(τ,λ)
1
.
p
m
o
C
0.25
0.2
0.15
0.1
0.05
0
0.01
δ=5
δ=10
δ=20
δ=50
δ=100
0.1
Time Fraction FD(τ,λ)
1
.
n
o
i
t
i
u
b
i
r
t
s
D
e
v
i
t
l
a
u
m
u
C
.
p
m
o
C
Fig. 3. Available Loss and Delay Advantage: CCDF of Time Fractions
FL(τ, λ), FD(τ, δ) over all SD pairs. Time fraction in which loss advantage exceeds
threshold for τ = 2000s. Left: loss. Right: delay.
with non-zero median loss rates distributed roughly uniformly between 0 and 1.
About 95% of SD pairs had median delay less than 300ms. Between sources the
median delay was roughly uniformly distributed between 0ms and 80ms.
Routing Data. We also determined BGP egress changes between every probe
source and destination pair for the 12 day period, using BGP updates collected
by a BGP Monitor from Route Reﬂectors in every PoP (Point of Presence) in
the Tier-1 ISP. The updates allow us to determine the egress (the BGP next-
hop) used by the route reﬂector for any destination. We mapped each probe
source to the nearest PoP. We then used the updates collected from a Route
Reﬂector in that PoP to determine egress changes from the source to every
probe destination.
Number of Egress Points. Our framework assumes alternate routes exist.
To test this, we computed the distribution of number of distinct egress points
which advertise a given destination. The maximum number of egresses seen per
destination was 10. For most destinations the number of egresses was constant
for most of the duration trace (about 90% of the time). For example, about 64%
of the destinations spend most of the time advertised by at least 7 egresses.
Performance Advantage Metric. We found the distribution of FL(τ, λ),
FD(τ, δ) over all SD pairs, for a range of parameters τ, λ, δ. Figure 3 illus-
trate these for runs lengths greater than τ = 2, 000s. The left plot shows the
CCDF of FL(2000, λ) for loss advantages at least (1%, 2%, 3%, 6%, 11%). Con-
sider 2% loss curve: about 15% of SD pairs spend at least 10% of the time
in such runs lasting longer than 2,000s. The right plot shows FD(2000, δ) for
δ = (5, 10, 20, 50, 100)ms. Consider the 20ms delay curve: about 17% of pairs
spend about 10% of their time in such runs lasting longer than 2,000s.
Summary. Our initial results show the potential beneﬁt of Measurement In-
formed Route Selection: (i) There is signiﬁcant choice in terms of alternate paths
to reach Internet destinations. (ii) Signiﬁcant beneﬁts in loss (at least 2%) and
delay (at least 20ms) last for time periods that can be exploited by routing.
254
N. Duﬃeld et al.
References
1. A. Akella, J. Pang, A. Shaikh, B. Maggs, and S. Seshan. A Comparison of Overlay
Routing and Multihoming Route Control. In Proc. ACM Sigcomm, Sept. 2004.
2. D. G. Andersen, H. Balakrishnan, M. F. Kaashoek, and R. Morris. Resilient Overlay
Networks. In Proc. 18th ACM SOSP, pages 131–145, Banﬀ, Canada, Oct. 2001.
3. K.-T. Chen, P. Huang, G.-S. Wang, C.-Y. Huang, and C.-L. Lei. On the Sensitivity
of Online Game Playing Time to Network QoS. IEEE Infocom, April 2006.
4. N. Feamster, H. Balakrishnan, J. Rexford, A. Shaikh, and J. van der Merwe. The
Case for Separating Routing from Routers. FDNA Workshop, Aug 2004.
5. O. Tickoo, V. Subramanian, S. Kalyanaraman, and K. K. Ramakrishnan. LT-TCP:
End-to-End Framework to Improve TCP Performance over Networks with Lossy
Channels. IWQoS 2005, June 2005.