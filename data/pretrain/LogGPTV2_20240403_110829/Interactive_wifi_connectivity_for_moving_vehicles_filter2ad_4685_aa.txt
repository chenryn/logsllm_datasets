title:Interactive wifi connectivity for moving vehicles
author:Aruna Balasubramanian and
Ratul Mahajan and
Arun Venkataramani and
Brian Neil Levine and
John Zahorjan
Interactive WiFi Connectivity For Moving Vehicles
Aruna Balasubramanian
University of Massachusetts, Amherst
Ratul Mahajan
Microsoft Research
Arun Venkataramani
Brian Neil Levine
University of Massachusetts, Amherst
John Zahorjan
University of Washington
ABSTRACT
We ask if the ubiquity of WiFi can be leveraged to provide cheap
connectivity from moving vehicles for common applications such
as Web browsing and VoIP. Driven by this question, we conduct
a study of connection quality available to vehicular WiFi clients
based on measurements from testbeds in two different cities. We
ﬁnd that current WiFi handoff methods, in which clients commu-
nicate with one basestation at a time, lead to frequent disruptions
in connectivity. We also ﬁnd that clients can overcome many dis-
ruptions by communicating with multiple basestations simultane-
ously. These ﬁndings lead us to develop ViFi, a protocol that oppor-
tunistically exploits basestation diversity to minimize disruptions
and support interactive applications for mobile clients. ViFi uses a
decentralized and lightweight probabilistic algorithm for coordina-
tion between participating basestations. Our evaluation using a two-
month long deployment and trace-driven simulations shows that its
link-layer performance comes close to an ideal diversity-based pro-
tocol. Using two applications, VoIP and short TCP transfers, we
show that the link layer performance improvement translates to bet-
ter application performance. In our deployment, ViFi doubles the
number of successful short TCP transfers and doubles the length of
disruption-free VoIP sessions compared to an existing WiFi-style
handoff protocol.
Categories and Subject Descriptors
C.2 [Computer Communication Network] Routing protocols
General Terms
Measurement, design, performance
Keywords
Vehicular networks, applications, WiFi, handoff, diversity
1.
INTRODUCTION
Our work is driven by two observations: one a growing need and
another an opportunity. Many users want cheap and high-quality
Internet access from moving vehicles to stay connected while trav-
eling. Cellular networks can provide such connectivity today, but
they tend to be expensive. At the same time, there is an increasingly
ubiquitous deployment of inexpensive WiFi (802.11) networks, and
in many cases, entire cities are being covered [38, 39].
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
SIGCOMM’08, August 17–22, 2008, Seattle, Washington, USA.
Copyright 2008 ACM 978-1-60558-175-0/08/08 ...$5.00.
The ubiquity of WiFi provokes an intriguing question: can WiFi
deployments support common applications such as Web browsing,
instant messaging, and voice over IP (VoIP), from moving vehi-
cles? We are, of course, not the ﬁrst to suggest allowing WiFi ac-
cess from moving vehicles. Several recent works study connectiv-
ity from vehicles to open-access basestations. They propose tech-
niques to improve connectivity to an individual basestation [8, 19].
Some also propose application-speciﬁc techniques or new applica-
tions that work well in such environments [4, 14]. The question
we pose, however, pushes the envelope beyond this type of special-
case usage to supporting common applications.
Our primary contribution is the design of ViFi, a protocol that
minimizes disruptions in WiFi connectivity in order to support in-
teractive applications from moving vehicles. ViFi’s design is moti-
vated by a rigorous measurement study of two vehicular testbeds in
different cities. The goals of our study are to understand the fun-
damental challenges in supporting interactive applications and to
explore opportunities that can be leveraged in this environment.
We ﬁnd that with current WiFi handoff methods clients experi-
ence frequent disruptions in connectivity even when they may be
close to WiFi basestations. Handoffs in WiFi today are hard, i.e.,
at any given time, clients communicate with only one basestation
that is expected to offer the best connectivity. Hard handoffs are
limited by gray periods in which connectivity drops sharply and un-
predictably, the difﬁculty of estimating the continuously changing
channel quality to near-by basestations, and the short-term bursti-
ness of losses. Interestingly, we ﬁnd that even though the impact
on the performance of delay or disruption-tolerant applications is
small, the user-perceived quality for interactive applications that
need consistent connectivity deteriorates signiﬁcantly.
We also ﬁnd that macrodiversity, i.e., using multiple basestations
simultaneously, can help reduce disruptions for vehicular clients.
Its use has been successful in cellular networks [37]. In our con-
text, it overcomes the limitations of hard handoff because of inde-
pendence of packet losses across basestations and even outperforms
an ideal hard handoff strategy with future knowledge of loss rates.
ViFi exploits macrodiversity and opportunistic receptions by near-
by basestations to minimize disruptions for mobile clients. The
challenge in designing ViFi is in coordinating among basestations
that opportunistically receive packets. This coordination must be
nimble enough to allow per-packet processing and must use the
communication channel efﬁciently. ViFi addresses this challenge
using a simple yet effective probabilistic algorithm. Basestations
that opportunistically overhear a packet but not its acknowledg-
ment, probabilistically relay the packet to the intended next hop,
such that wasted transmissions are minimized. Unlike opportunis-
tic routing protocols for wireless mesh networks [5, 9], the per-
packet overhead of ViFi is low enough to not require batching. Batch-
ing tends to delay packets and is thus unsuitable for many interac-
tive applications. And unlike diversity-based handoff protocols for
enterprise WLANs [23, 25, 26], ViFi places little additional demand
The BSes and vehicles have small desktops with Atheros 5213
chipset radios. The antennae are omnidirectional and are mounted
on the roofs of the respective buildings and vehicles. The vehi-
cles are equipped with a GPS unit that outputs location information
once every second. All nodes were set to the same 802.11 channel
for the experiments in this paper.
The radios operate in the ad hoc (IBSS) mode using a locally
modiﬁed Windows driver. The modiﬁcations let us use a ﬁxed
BSSID, which prevents network partitions and reconciliation de-
lays. They also let us log received frames along with PHY layer
information (e.g., RSSI) without place the radio in monitor mode.
2.2 DieselNet
The DieselNet testbed is in Amherst, a college town in Mas-
sachusetts. DieselNet consists of vehicles equipped with a com-
puter, an 802.11 radio, and a GPS unit. To enable trace-driven stud-
ies, we set one vehicle to log all beacons heard from nearby BSes.
Later sections describe how this information is used for analysis.
In this paper, we use traces from Channels 1 and 6. Each chan-
nel was proﬁled for 3 days in December 2007, during which the
vehicle logged more than 100,000 beacons. The proﬁling channel
was ﬁxed so that beacons are not lost while scanning. We limit our
analysis to BSes in the core of the town and to BSes that are visible
on all three days. There are 10 such BSes on Channel 1 and 14
on Channel 6. About half of the BSes on each channel belong to
the town’s mesh network and the rest belong to nearby shops. Our
traces are available at traces.cs.umass.edu.
3. A CASE FOR DIVERSITY
This section presents a case for using BS diversity to support
vehicular WiFi clients, based on measurements from our testbeds.
Client performance in this environment depends on the handoff
strategy. We show that handoff strategies that use one BS at a time,
as is common today, cause disruptions in connectivity that make
supporting interactive applications challenging. We also show that
using multiple BSes can mask these disruptions and improve ap-
plication performance. These results set up our proposal for a new
diversity-based handoff protocol, ViFi, which we present in the next
section. To our knowledge, ours is the ﬁrst study that evaluates var-
ious handoff strategies in vehicular environments.
3.1 Methodology
There are many possible handoff strategies; for a comprehensive
evaluation, we study six different policies. Four of these are practi-
cal and are based on existing literature; the other two are idealized
methods and lend insight into the inherent limitations of the prac-
tical policies. Our goal is to ﬁrst understand the fundamental dif-
ferences among the policies, so we ignore the time taken to switch
between BSes and the time to scan for BSes. Research shows that
careful design can tackle these issues effectively [31, 6, 20, 2].
We analyze the performance of these handoff policies using a
trace-driven evaluation on VanLAN. During the evaluation, each
BS and vehicle broadcasts a 500-byte packet at 1 Mbps every 100 ms.
We veriﬁed that self-interference of this trafﬁc is minimal by com-
paring its packet reception ratio with the case where only one node
sends at a time. Even though unicast packets, followed by acknowl-
edgments, are more common today, broadcast packets sufﬁce to
probe the underlying connectivity and let us measure connectivity
from a sender to all receivers simultaneously [1]. Nodes log all
correctly decoded packets and beacons. Our results are based on
analysis of traces collected over a two-week period.
We evaluate a handoff policy using these traces as follows. The
policy determines which BS a client associates with at a given time.
Figure 1: The layout of BSes in VanLAN.
on the inter-basestation communication plane that is bandwidth lim-
ited in our setting.
We implemented and successfully deployed ViFi on our testbed
in Redmond, Washington, for over two months. We evaluate ViFi
using our deployed prototype and simulations driven by traces from
our testbed in Amherst, Massachusetts. Our evaluation shows that
the link-layer performance of ViFi is comparable to an ideal diversity-
based handoff protocol and outperforms an ideal hard handoff pro-
tocol. At the same time, it uses the wireless medium as efﬁciently
as a single-basestation handoff protocol.
We study the performance of ViFi for two commonly used inter-
active applications: VoIP and short TCP transfers that are typical in
Web browsing. Based on our deployment results, we ﬁnd that ViFi
reduces disruptions for these applications and improves their user-
perceived quality. Trace-driven simulations based on the second
testbed corroborate our ﬁndings.
2. EXPERIMENTAL PLATFORMS
Our designs and evaluations are based on experiments performed
on two vehicular mobile network testbeds: VanLAN and DieselNet.
VanLAN is a vehicular testbed that we deployed in the Microsoft
campus in Redmond, Washington, and we use it for measurements
and to conduct live experiments. DieselNet [7] is also a vehicular
testbed that we deployed in Amherst, Massachusetts. Unlike Van-
LAN, however, in DieselNet we cannot modify the BSes, and can
only control the equipment on the vehicles. We proﬁle the envi-
ronment of DieselNet and use the collected traces for trace-driven
studies of the environment and to evaluate performance. Our intent
in using two distinct environments in two different cities is to gain
conﬁdence that our results apply in different settings.
2.1 VanLAN
VanLAN consists of eleven basestations (BSes) and two vehi-
cles. The BSes are deployed across ﬁve buildings in the Microsoft
campus, as illustrated in Figure 1. The box in the ﬁgure, cover-
ing a 828×559 m2 area, bounds the region in which at least one
packet is received by vehicles from any BS. Not all pairs of BSes
are within wireless range of one another. The vehicles provide a
shuttle service around the town, moving within a speed limit of
about 40 Km/h. Each vehicle visits the region of the BSes about
ten times a day.
The client can communicate with only the associated BS when us-
ing a hard handoff policy. We assume that clients have a workload
that mirrors our trace trafﬁc; i.e., they wish to send and receive
packets every 100 ms. The traces of broadcast packets and the cur-
rent association determine which packets are successfully received.
We use two measures to provide insight into the performance
of different kinds of applications: (i) aggregate performance; (ii)
periods of uninterrupted connectivity. An aggregate performance
measure considers the total number of packets delivered and the
total time or distance over which the vehicle is connected. These
are relevant to delay or disruption-tolerant applications that care
most about total throughput, e.g., synchronizing mail folders in the
background. The period of uninterrupted connectivity measures
contiguous time intervals when the performance of an application
is above a threshold, for some deﬁnition of performance and thresh-
old. Measuring periods of uninterrupted connectivity will, for ex-
ample, tell us the length of time a VoIP caller can talk before the
call quality drops. Applications such as instant messaging lie be-
tween these extremes; interpolating our results can provide insight
into their performance.
The six handoff policies that we study are the following.
1. RSSI, where the client associates to BSes with higher sig-
nal strength, measured as the exponential average of the RSSIs of
received beacons. This policy is similar to what many clients, in-
cluding the NICs in our testbed, use currently in infrastructure WiFi
networks.
2. BRR, where the client associates to the BS with the highest
exponentially averaged beacon reception ratio. This policy is in-
spired by wireless routing protocols that are based on the reception
ratio of probes [12].
We use an exponential averaging factor of half for both methods
above and ﬁnd the results robust to the exact choice.
3. Sticky, where the client does not disassociate from the current
BS until connectivity is absent for a pre-deﬁned time period, set
to three seconds in our evaluation. Once disassociated, the client
picks the BS with the highest signal strength. This policy was used
in the CarTel study [8].
4. History, where the client associates to the BS that has his-
torically provided the best average performance at that location.
Performance is measured as the sum of reception ratios in the two
directions, and the average is computed across traversals of the lo-
cation in the previous day. MobiSteer shows the value of history in
vehicular environments [28].
5. BestBS, where at the beginning of each one-second period,
the client associates to the BS that provides the best performance
in the future one second. Performance is measured as the sum of
reception ratios in the two directions. This method is not practical
because clients cannot reliably predict future performance.
In cellular terminology, all of the policies above use hard hand-
off because the client associates with only one BS at a time. Using
future knowledge, BestBS represents an upper bound on the perfor-
mance of hard handoff methods. Comparing it with macrodiversity
methods (below) reveals the inherent limitations of hard handoff.
6. AllBSes, where the client opportunistically uses all BSes in
the vicinity. A transmission by the client is considered successful if
at least one BS receives the packet. In the downstream direction, if
the client hears a packet from at least one BS in an 100-ms interval,
the packet is considered as delivered.
AllBSes is an ideal method that represents an upper bound on
the performance of any handoff protocol. It exploits path diversity
between the client and the set of nearby BSes. Because of differ-
ences in CDMA and CSMA, it is not identical to, but is inspired by,
macrodiversity methods in cellular networks [37]. Path diversity is
y
a
d
/
)
K
(
s
t
k
P
100
80
60
AllBSes
BestBS
History
RSSI
BRR
Sticky
4
6
8
10
# BSs
Figure 2: Average number of packets delivered per day in Van-
LAN by various methods. Error bars represent 95% conﬁ-
dence intervals.
known to improve performance in WiFi mesh and indoor infrastruc-
ture networks as well [5, 25]. We study if such beneﬁts materialize
in vehicular WiFi settings.
3.2 Aggregate Performance Results
Figure 2 shows the packets delivered by the six handoff policies.
To study the impact of BS-density, the independent variable in the
graph is the number of BSes in the system. There are eleven BSes
in VanLAN, and each point in the ﬁgure represents the average of
ten trials using randomly selected subset of BSes of a given size.
The graph shows that more packets are delivered as the density
of BSes increases but the relative performance of various methods
is similar.1 AllBSes performs best, followed by BestBS, and then
by History, RSSI, and BRR; the performance of Sticky is the worst.
Ignoring Sticky, all methods are within 25% of AllBSes. This re-
sult suggests that for non-interactive applications, the choice of the
exact method is not critical — however, results below demonstrate
that interactive applications manifest great differences among the
policies. Because of space limitations, we omit similar results for
other aggregate performance metrics, such as the total time or dis-
tance for which the methods provide some minimal connectivity.
History, RSSI and BRR perform similarly for all measures that
we study. The competitive performance of History conﬁrms recent
results [28] about the feasibility of using past experience to predict
future performance. For visual clarity, we present results for only
BRR as representative of all three in the remainder of this paper.
3.3 Uninterrupted Connectivity Results
To compare the ability of different handoff methods in provid-
ing uninterrupted connectivity, we start with a qualitative example.
Figure 3 shows the behavior of BRR, BestBS, and AllBSes during
one example trip of the vehicle. In this example, we deﬁne ade-
quate connectivity to mean at least 50% of the packets are received
in a one-second interval. Consistent with our aggregate perfor-
mance measurement, each method provides adequate connectivity
for roughly the same total path length. However, BRR contains
several regions of inadequate connectivity. BestBS has fewer inter-
ruptions because it uses the optimal BS. AllBSes performs best as
it uses multiple BSes to further reduce the number of interruptions.
Frequent interruptions in BRR can be explained through a de-
tailed analysis of the connectivity between a vehicular WiFi client
and a BS. Contrary to earlier studies of controlled environments [29,
17], we ﬁnd that in realistic environments this connectivity is of-
1We ﬁnd it surprising that the curves for number of packet deliv-
ered did not ﬂatten. We expected the density of VanLAN to be suf-
ﬁciently high for performance to be the same as a sparser deploy-
ment. This points to the challenge of deploying WiFi in outdoor
areas such that performance is maximized and not just coverage.
)
F
D
C
(
e
m
i
t