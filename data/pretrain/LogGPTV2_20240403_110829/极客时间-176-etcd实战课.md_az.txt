# 释放锁    Del key以上流程中其实存在以下思考点:1.  NX 参数有什么作用?        2.  为什么需要原子的设置 key    及过期时间？        3.  为什么基于 Set key value EX 10 NX    命令还出现了超卖呢?        4.  为什么大家都比较喜欢使用 Redis    作为分布式锁实现？        首先来看第一个问题，NX 参数的作用。NX参数是为了保证当分布式锁不存在时，只有一个 client 能写入此 key成功，获取到此锁。我们使用分布式锁的目的就是希望在高并发系统中，有一种互斥机制来防止彼此相互干扰，保证数据的一致性。**因此分布式锁的第一核心要素就是互斥性、安全性。在同一时间内，不允许多个client 同时获得锁。**再看第二个问题，假设我们未设置 key 自动过期时间，在 Set key value NX后，如果程序 crash 或者发生网络分区后无法与 Redis 节点通信，毫无疑问其他client将永远无法获得锁。这将导致死锁，服务出现中断。有的同学意识到这个问题后，使用如下 SETNX 和 EXPIRE 命令去设置 key和过期时间，这也是不正确的，因为你无法保证 SETNX 和 EXPIRE命令的原子性。    
# 对资源key加锁，key不存在时创建    SETNX key value    