# G0040: Patchwork
## Description
Patchwork, also known as [G0040](https://attack.mitre.org/groups/G0040), is a cyberespionage group first observed in December 2015. While the group's origin has not been definitively attributed, circumstantial evidence suggests it may be a pro-Indian or Indian entity. Patchwork primarily targets industries related to diplomatic and government agencies. The group often uses code copied and pasted from online forums. Notably, Patchwork conducted spearphishing campaigns targeting U.S. think tanks in March and April 2018. (Citations: [Cymmetria Patchwork](https://attack.mitre.org/groups/G0040), [Symantec Patchwork](https://attack.mitre.org/groups/G0040), [TrendMicro Patchwork Dec 2017](https://attack.mitre.org/groups/G0040), [Volexity Patchwork June 2018](https://attack.mitre.org/groups/G0040))

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | Defense Evasion | [File Deletion](https://attack.mitre.org/techniques/T1107/) | Patchwork removed certain files and replaced them to prevent retrieval. | File monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | Collection | [Automated Collection](https://attack.mitre.org/techniques/T1119/) | Patchwork developed a file stealer to search C:\ and collect files with specific extensions. They also executed a script to enumerate all drives, store them as a list, and upload generated files to the C2 server. | File monitoring, Data loss prevention, Process command-line parameters |
| Linux, macOS, Windows | Exfiltration | [Data Encrypted](https://attack.mitre.org/techniques/T1022/) | Patchwork encrypted the collected files' paths with AES and then encoded them with base64. | File monitoring, Process monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | Defense Evasion | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | Patchwork obfuscated a script using Crypto Obfuscator. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Windows | Execution, Persistence, Privilege Escalation | [Scheduled Task](https://attack.mitre.org/techniques/T1053/) | A Patchwork file stealer can run a TaskScheduler DLL to add persistence. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Windows | Defense Evasion | [DLL Side-Loading](https://attack.mitre.org/techniques/T1073/) | A Patchwork .dll containing [BADNEWS](https://attack.mitre.org/software/S0128) is loaded and executed using DLL side-loading. | Process use of network, Process monitoring, Loaded DLLs |
| Windows | Execution | [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1173/) | Patchwork leveraged the DDE protocol to deliver malware. | API monitoring, DLL monitoring, Process monitoring, Windows Registry, Windows event logs |
| Linux, Windows, macOS | Execution | [User Execution](https://attack.mitre.org/techniques/T1204/) | Patchwork embedded a malicious macro in a Word document and lured victims to click on an icon to execute the malware. | Anti-virus, Process command-line parameters, Process monitoring |
| Linux, macOS, Windows | Defense Evasion | [Binary Padding](https://attack.mitre.org/techniques/T1009/) | Patchwork altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples by adding four bytes of random letters to change the file hashes. | Binary file metadata, File monitoring, Malware reverse engineering |
| Linux, macOS, Windows | Defense Evasion | [Indicator Removal from Tools](https://attack.mitre.org/techniques/T1066/) | Patchwork altered [NDiskMonitor](https://attack.mitre.org/software/S0272) samples by adding four bytes of random letters to change the file hashes. | Process use of network, Process monitoring, Process command-line parameters, Anti-virus, Binary file metadata |
| Linux, macOS, Windows, AWS, GCP, Azure | Collection | [Data Staged](https://attack.mitre.org/techniques/T1074/) | Patchwork copied all targeted files to a directory called "index" that was eventually uploaded to the C&C server. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion, Execution | [Scripting](https://attack.mitre.org/techniques/T1064/) | Patchwork used Visual Basic Scripts (VBS), JavaScript code, batch files, and .SCT files on victim machines. | Process monitoring, File monitoring, Process command-line parameters |
| Windows | Defense Evasion | [Modify Registry](https://attack.mitre.org/techniques/T1112/) | A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications to trick users into thinking there were no issues during application runs. | Windows Registry, File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Windows, Linux, macOS, SaaS | Initial Access | [Drive-by Compromise](https://attack.mitre.org/techniques/T1189/) | Patchwork used watering holes to deliver files with exploits to initial victims. | Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection |
| Windows, macOS, Linux, Office 365, SaaS | Initial Access | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | Patchwork used spearphishing with links to deliver files with exploits to initial victims. The group included embedded image tags (web bugs) with unique, per-recipient tracking links in their emails to identify which recipients opened messages. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Linux, Windows, macOS | Execution | [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203/) | Patchwork used malicious documents to deliver remote execution exploits. The group has exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, and CVE-2015-1641. | Anti-virus, System calls, Process monitoring |
| Windows, macOS, Linux | Initial Access | [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193/) | Patchwork used spearphishing with attachments to deliver files with exploits to initial victims. | File monitoring, Packet capture, Network intrusion detection system, Detonation chamber, Email gateway, Mail server |
| Linux, macOS, Windows | Command and Control, Lateral Movement | [Remote File Copy](https://attack.mitre.org/techniques/T1105/) | Patchwork payloads download additional files from the C2 server. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |
| Linux, macOS, Windows | Discovery | [File and Directory Discovery](https://attack.mitre.org/techniques/T1083/) | A Patchwork payload searched all fixed drives on the victim for files matching a specified list of extensions. | File monitoring, Process monitoring, Process command-line parameters |
| Windows | Defense Evasion | [Process Hollowing](https://attack.mitre.org/techniques/T1093/) | A Patchwork payload used process hollowing to hide the UAC bypass vulnerability exploitation inside svchost.exe. | Process monitoring, API monitoring |
| Linux, macOS, Windows | Command and Control, Defense Evasion | [Web Service](https://attack.mitre.org/techniques/T1102/) | Patchwork hid base64-encoded and encrypted C2 server locations in comments on legitimate websites. | Host network interface, Netflow/Enclave netflow, Network protocol analysis, Packet capture, SSL/TLS inspection |
| Windows, macOS | Defense Evasion | [Software Packing](https://attack.mitre.org/techniques/T1045/) | A Patchwork payload was packed with UPX. | Binary file metadata |
| Windows, Linux, macOS | Credential Access | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | Patchwork dumped the login data database from \AppData\Local\Google\Chrome\User Data\Default\Login Data. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| macOS, Windows | Discovery | [Security Software Discovery](https://attack.mitre.org/techniques/T1063/) | Patchwork scanned the “Program Files” directories for a directory with the string “Total Security” (the installation path of the “360 Total Security” antivirus tool). | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | [Data Encoding](https://attack.mitre.org/techniques/T1132/) | Patchwork used Base64 to encode C2 traffic. | Packet capture, Process use of network, Process monitoring, Network protocol analysis |
| Windows | Lateral Movement | [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076/) | Patchwork attempted to use RDP to move laterally. | Authentication logs, Netflow/Enclave netflow, Process monitoring |
| Linux, macOS, Windows, AWS, GCP, Azure | Discovery | [System Information Discovery](https://attack.mitre.org/techniques/T1082/) | Patchwork collected the victim computer name, OS version, and architecture type and sent the information to its C2 server. They also enumerated all available drives on the victim's machine. | Azure activity logs, Stackdriver logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Discovery | [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033/) | Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion | [Masquerading](https://attack.mitre.org/techniques/T1036/) | Patchwork installed its payload in the startup programs folder as "Baidu Software Update." The group also added its second-stage payload to the startup programs as “Net Monitor.” | File monitoring, Process monitoring, Binary file metadata |
| Windows | Persistence | [Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1060/) | Patchwork added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers also persisted by adding a Registry Run key. | Windows Registry, File monitoring |
| Windows | Defense Evasion, Privilege Escalation | [Bypass User Account Control](https://attack.mitre.org/techniques/T1088/) | Patchwork bypassed User Access Control (UAC). | System calls, Process monitoring, Authentication logs, Process command-line parameters |
| Windows | Execution | [PowerShell](https://attack.mitre.org/techniques/T1086/) | Patchwork used [PowerSploit](https://attack.mitre.org/software/S0194) to download payloads, run a reverse shell, and execute malware on the victim's machine. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, GCP, AWS, Azure | Collection | [Data from Local System](https://attack.mitre.org/techniques/T1005/) | Patchwork collected and exfiltrated files from the infected system. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Execution | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | Patchwork ran a reverse shell with Meterpreter. | Process monitoring, Process command-line parameters |

This revised version provides a clearer and more professional presentation of the Patchwork group's activities and TTPs.