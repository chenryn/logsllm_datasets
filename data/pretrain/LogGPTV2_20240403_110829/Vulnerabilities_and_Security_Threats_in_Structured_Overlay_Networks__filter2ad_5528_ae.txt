2048
4096
8192
(ms)
2.32
4.22
8.47
16.08
2112
4301
8157
16421
0.80
0.76
0.76
0.84
0.96
0.95
0.97
0.99
Table 2: Attack on ID Mapping Scheme
using the above strategy on any of the (cid:0) replicas of data
item (cid:1). When the malicious nodes succeed in gaining
control over (cid:2) copies of the data item (cid:1), they can cor-
rupt it and leave the system.
Consider the case wherein the IP-address of a node
is used as its EID. Given the fact that IPv6 can poten-
tially provide every node with thousands of addresses, it
is quite feasible, though expensive, for a malicious node
to perform this attack. The same argument is also appli-
cable to dial-up users who obtain Dynamic IP-address
from a huge ISP (Internet Service Provider). Also note
that computing (cid:5) hashes is computationally feasi-
ble. As a simple example, using the standard OpenSSL
library, a typical 900MHz Pentium III takes about 1 sec-
ond to compute one million hashes (MD5).
5.2 Experimental Validation
We simulated the Chord lookup protocol [17] with vary-
ing number of good nodes. We chose 100 random data
items to attack. Table 2 summarizes our observations on
the number of EIDs required for a successful attack on
these data items. Our observations very closely match
the results from our analysis (Equation 7):  (cid:2)(cid:4) (cid:0)
(cid:2)(cid:5) (cid:3) (cid:4)(cid:8)(cid:5)(cid:6) and  (cid:2)(cid:4) (cid:0) (cid:7)(cid:5) (cid:3) (cid:4)(cid:8)(cid:6)(cid:8).
5.3 Defense
The Sybil attack paper [5] suggests the use of trusted
certiﬁcation authorities to strictly bind an identity to an
entity (node). However this requires every node to re-
veal its identity in order to join the system. It may also
discourage a few nodes from joining the overlay net-
work in the ﬁrst place. In order to reduce certiﬁcation
costs and motivate users to join the overlay network, one
could employ weak secure identiﬁers, like the node IP-
address, which can be challenged and veriﬁed easily.
There are other approaches that could mitigate this
problem. When a new node joins the system, it typically
contacts a publicly known and trusted bootstrap server
to obtain an entry point node to bootstrap itself into the
system. In our solution, the bootstrap server assigns a
random (cid:9)(cid:1) (cid:0) (cid:10) to a node (and issues a certiﬁcate with
a short life-time) when it joins the system. Observe that
if a malicious node joins the system (cid:5) times, it gets
assigned a given target data item with a large probabil-
ity as in Equation 7. However note that contrary to the
techniques that derive a node’s ID from its EID, a mali-
cious node cannot ofﬂine determine the EID that can be
used to gain control over the target data item. Instead,
the malicious node has to physically attempt joining the
system (cid:5) times, each time contacting the bootstrap
server. Note that contacting the bootstrap server (cid:5)
takes signiﬁcantly longer time; but, it does not prevent a
malicious from eventually gaining control over a target
data item. To prevent this, one could implement weak
security checks through the bootstrap server; for exam-
ple, the bootstrap server could detects frequent attempts
by a node from a single IP-domain 4 to join the sys-
tem. In conclusion, the overlay network may use weak
secure IDs as long as spooﬁng a large number of pseudo-
identiﬁers over a short duration of time is very hard.
6 Related Work
Sit and Morris [16] discuss several security considera-
tions in a distributed hash table based overlay networks.
They present a framework for performing security anal-
ysis of structured overlay networks and discuss a wide
range of possible attacks including: routing table main-
tenance and network partitioning; application layer at-
tacks on ﬁle storage; and ad hoc attacks like denial-of-
service attacks by rapidly joining and leaving the net-
work. Their paper suggests the use of repeated checking
as a defense against routing attacks on the system. Our
work not only quantiﬁes the lookup costs using repeated
checks but also shows that merely performing repeated
checks does not help especially in the absence of multi-
ple independent lookup paths.
Castro et al. [3] discuss several issues on secure rout-
ing in DHT based overlay networks. They suggest re-
dundant routing as a solution for strengthening the rout-
ing scheme using a routing failure test based on the den-
sity of node identiﬁers. In redundant routing, the query
source sends lookup query through different routes with
a hope that at least one them eventually reaches the des-
tination node. Note that our analysis on multiple near
optimal independent paths is applicable to the case where
redundant routing is used. Also note that having multi-
ple independent paths improves the probability of suc-
cess and lowers the lookup cost for both repeated check-
ing and redundant routing techniques.
The Sybil attack paper [5] showed that entities (nodes)
can forge multiple identities for malicious intent, thereby
having a set of faulty entities represented through a larger
set of identities. The paper also suggests that one solu-
tion to the Sybil attack is using secure node IDs that are
signed by well-known certifying agents. However, re-
quiring every node to possess a certiﬁcate would turn
4Multiple IP-addresses owned by a node hopefully fall into the
same IP-domain
9
Proceedings of the 20th Annual Computer Security Applications Conference (ACSAC’04) 
1063-9527/04 $ 20.00 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 11:39:20 UTC from IEEE Xplore.  Restrictions apply. 
[6] Gnutella.
gnutella
http://gnutella.wego.com/, 2002.
The
home
page.
[7] IPv6.
ipv6
http://www.ipv6.org/, 2002.
The
information
page.
[8] J. Kubiatowics, D. Bindel, Y. Chen, S. Czerwin-
ski, P. Eaton, D. Geels, R. Gummadi, S. Rhea,
H. Weatherspoon, W. Weimer, C. Wells, and
B. Zhao. Oceanstore: An architecture for global-
scale persistent storage. In Proceedings of the 9th
International Conference on Architectural Support
for Programming Languages and Operating Sys-
tems, November 2000.
[9] MathWorld.
Menger’s
theorem.
http://mathworld.wolfram.com/MengersTheorem.html,
2002.
[10] MathWorld.
ﬂow.
http://mathworld.wolfram.com/NetworkFlow.html,
2002.
[11] MD5.
The md5 message-digest algorithm.
Network
http://www.ietf.org/rfc/rfc1321.txt, 1992.
[12] S. Ratnasamy, P. Francis, M. Handley, R. Karp,
and S. Shenker. A scalable content-addressable
network.
In Proceedings of SIGCOMM An-
nual Conference on Data Communication, August
2001.
[13] A. Rowstron and P. Druschel. Pastry: Scalable,
distributed object location and routing for large-
scale peer-to-peer systems.
In Proceedings of
the 18th IFIP/ACM International Conference on
Distributed Systems Platforms (Middleware 2001),
November 2001.
[14] SETI@home.
extraterrestrial
Seti@home:
for
intelligence
http://setiathome.ssl.berkeley.edu/.
hash
secure
Us
Search
home.
at
algorithm i.
[15] SHA1.
http://www.ietf.org/rfc/rfc3174.txt, 2001.
[16] E. Sit and R. Morris. Security considerations for
In Proceed-
peer-to-peer distributed hash tables.
ings of IPTPS, 2002.
[17] I. Stoica, R. Morris, D. Karger, M. Kaashoek,
and H. Balakrishnan. Chord: A scalable peer-to-
peer lookup service for internet applications.
In
Proceedings of SIGCOMM Annual Conference on
Data Communication, August 2001.
Birthday
paradox.
http://www.wikipedia.org/wiki/Birthday paradox.
[18] Wikipedia.
out quite expensive; and may discourage even the good
nodes from joining the system in the ﬁrst place. Hence,
one is forced to employ weak secure node IDs (that sig-
niﬁcantly reduce the number of identities owned by an
entity). Therefore, this paper (Section 5) assessed the
risks and security threats when such weak secure IDs
are deployed in a DHT-based overlay network.
7 Conclusion
We have studied vulnerabilities of the overlay network
layer in a DHT-based overlay networks through investi-
gating two targeted attacks and suggesting possible de-
fense mechanisms. We have identiﬁed the key prop-
erties of a DHT-based system that determine the hard-
ness of these attacks. First, we have highlighted the
importance of multiple independent paths, alternate op-
timal paths, the ability to detect and recover from in-
valid lookups. Second, we discussed an attack on the
ID Mapping Scheme and showed that attacks on chosen
data items are quite plausible on DHT-based systems;
we have also demonstrated the dependency between the
hardness of such an attack and the number of external
identiﬁers owned by a node. We have presented quan-
titative analysis to estimate the extent of possible dam-
ages caused by these two types of attacks and used ex-
perimental methods to demonstrate the validity of the
attacks identiﬁed.
In conclusion, we strongly believe
that incorporating these security features in the over-
lay network layer will provide a secure infrastructure for
building large-scale distributed and decentralized appli-
cations.
References
[1] A. Adya, W. Bolosky, M. Castro, G. Cermak,
R. Chaiken, J. R. Douceur, J. Howell, J. R. Lorch,
M. Theimer, and R. P. Wattenhofer. Farsite: Fed-
erated, available and reliable storage for an incom-
pletely trusted environment. In 5th Symposium on
OSDI, 2002.
[2] J. K. B. Zhao and A. Joseph. Tapestry: An infras-
tructure for fault-tolerance wide-area location and
routing. Technical Report UCB/CSD-01-1141,
University of California, Berkeley, 2001.
[3] M. Castro, P. Druschel, A. Ganesh, A. Rowstron,
and D. S. Wallach. Secure routing for structured
peer-to-peer overlay networks. In OSDI, 2002.
[4] F. Dabek, M. F. Kaashoek, D. Karger, R. Morris,
and I. Stoica. Wide-area cooperative storage with
cfs.
In Proceedings of the 18th SOSP, October
2001.
[5] J. Douceur. The sybil attack. In 2nd Annual IPTPS
Workshop, 2002.
Proceedings of the 20th Annual Computer Security Applications Conference (ACSAC’04) 
1063-9527/04 $ 20.00 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 11:39:20 UTC from IEEE Xplore.  Restrictions apply. 
10