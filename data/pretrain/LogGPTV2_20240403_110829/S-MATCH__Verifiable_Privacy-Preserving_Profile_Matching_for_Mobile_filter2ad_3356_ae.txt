o
i
t
t
a
u
p
m
o
C
105
104
103
102
101
100
10í1
64
PM
homoPM
PM
homoPM
105
104
103
102
101
)
s
m
(
t
s
o
c
n
o
i
t
t
a
u
p
m
o
C
PM
homoPM
105
104
103
102
)
s
m
(
t
s
o
c
n
o
i
t
t
a
u
p
m
o
C
128
256
512
1024
Plaintext size (bit)
2048
100
64
128
256
512
1024
Plaintext size (bit)
2048
101
64
128
256
512
1024
2048
Plaintext size (bit)
(a) Computation cost of the server under Info-
com06 dataset
(b) Computation cost of the server under Sig-
comm09 dataset
(c) Computation cost of the server under Weibo
dataset
)
t
i
b
(
t
s
o
c
n
o
i
t
i
a
c
n
u
m
m
o
C
14000
12000
10000
8000
6000
4000
2000
0
64
PM
PM+V
)
t
i
b
(
t
s
o
c
n
o
i
t
i
a
c
n
u
m
m
o
C
512 1024 2048
14000
12000
10000
8000
6000
4000
2000
0
64
128
256
Entropy (bit)
(d) Communication cost under
dataset
Infocom06
128
256
512
Entropy (bit)
(e) Communication cost under
dataset
PM
PM+V
)
t
i
b
(
t
s
o
c
n
o
i
t
i
a
c
n
u
m
m
o
C
14000
12000
10000
8000
6000
4000
2000
0
64
PM
PM+V
128
256
Entropy (bit)
512 1024 2048
1024
2048
sigcomm09
(f) Communication cost under Weibo dataset
Fig. 5. The server computation cost under three datsets are shown in Fig. 5(a), Fig. 5(b) and Fig. 5(c). And Communication cost of S-MATCH under three
datasets are shown in Fig. 4(c), Fig. 4(d) and Fig. 4(e).
Sigcomm09 and Weibo datasets in our mobile device and
PC testbed. Figure 4(c), 4(d) and 4(e) present the client side
computation cost of our scheme (i.e., PM and PM+V) in
comparison to that of homoPM [8] under three real-world
datasets. As the size of plaintext increases, the encryption
time and data processing time of both schemes increase. In our
proﬁle matching scheme with the veriﬁcation technique, when
the plaintext size is small, the computation cost of the client
side mainly comes from the key generation, which is relatively
stable as the plaintext size increases. In the key generation, RS
Decoder algorithm and RSA-OPRF algorithm are run, which
take two modular exponentiations. As the plaintext size in-
creases, the computation cost of the privacy-preserving proﬁle
matching scheme becomes larger, which is much less than
that of the proﬁle matching scheme based on homomorphic
encryption. When the plaintext size is larger than 256 bits in
the three social network datasets, the computation cost of our
scheme is much less than that of those based on homomorphic
encryption. With the plaintext size increases, the advantage of
our scheme’s lower computation cost becomes more obvious.
Figure 5(a), 5(b) and 5(c) presents the server computation
cost of our scheme (i.e., PM) in comparison to that of homoPM
[8] under three real-world datasets. Different from the PPE
schemes, homomorphic encryption implemented by Paillier’s
cryptosystem [18] needs additional modular multiplication
operations in the server after encryption to make the ciphertext
comparable. In that case, the computation cost of homoPM
includes an ofﬂine computation cost (i.e., encryption, which
each user can process independently) and an online compu-
tation cost (i.e., a modular multiplication operation on the
ciphertext, which makes the computation cost increase by the
size of users and causes the latency in the query response).
With a large real-world social network dataset and plaintext
size, the proﬁle matching based on PPE is more advantageous
than homomorphic encryption. This is mainly due to the
server computation cost of homomorphic encryption, where
the computation cost of the multiplication increases with the
increase of users and the attributes. Also, the attribute values
encrypted by the Euclidean-distance close proﬁles key will
further help to ﬁlter the dataset and reduce the search range,
which also increases the performance.
D. Communication Cost Analysis
To evaluate the performance of our scheme, we measured
the communication cost of S-MATCH under the Infocom06,
Sigcomm09 and Weibo datasets between the mobile device
and PC.
Figure 5(d), Figure 5(e) and Figure 5(f) present the commu-
nication cost of our scheme (i.e., PM and PM+V). To evaluate
the communication cost, the user ID length is deﬁned as 32
bits, the number of the query results is 5, and N = M, where
M is the plaintext length and N is the ciphertext length. In
our scheme, the communication only happens between the
untrusted server and the users. In other words, the packages
to exchange the encrypted attribute values and the proﬁle
matching results is the main communication between them.
The veriﬁcation protocol introduces additional communication
cost of the authentication information between the users and
297297297
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:04:56 UTC from IEEE Xplore.  Restrictions apply. 
the server. As Figure 5(d), Figure 5(e) and Figure 5(f) indicate,
the difference between the curve of PM and PM+V is the com-
munication cost of the authentication information. Moreover,
the communication cost under Weibo dataset is larger then
that of Infocom06 dataset and Sigcomm09 dataset because of
the larger number of the attributes. As the evaluation results
indicate, our scheme is feasible for the low-bandwidth case.
X. CONCLUSION AND FUTURE WORK
In this paper, we presented a privacy-preserving proﬁle
matching scheme in large scale mobile social networks. Our
scheme is based on property-preserving encryption (PPE). We
proposed a key generation scheme for PPE to protect from
the key-sharing problem when the user and the untrusted
server collude. Also, we showed that entropy increase of
social attribute data is necessary in PPE to achieve the privacy
needed for the social proﬁle matching process. For this, we
evaluated the security of PPE over three real-world datasets.
We analyzed the information leakage in the PPE schemes.
A veriﬁcation protocol was also proposed for users to verify
the proﬁle matching results, but learn nothing about other
users’ proﬁle attributes. Finally, we showed that our scheme
provided privacy and veriﬁcation guarantees while achieving
good performance in real-world social attribute datasets. The
evaluation results indicated the efﬁciency and validity of our
schemes. In our future work, we will further improve our
scheme by increasing the efﬁciency of OPE. We plan to design
our own OPE scheme which is able to choose the length of
keys adaptively based on the entropy of social attributes.
REFERENCES
[1] A. Chaabane, G. Acs, M. Kaafar. You are what you like! Information
leakage through users’ interests In Proceedings of the 2012 NDSS.
[2] R. Popa, A. J. Blumberg, H. Balakrishnan, F. Li. Privacy and account-
ability for location-based aggregate statistics. In Proceedings of the 2011
ACM CCS, 653-666.
[3] C. Kaufma, R. Perlman, M. Speciner. Network security: private commu-
nication in a public world. Prentice Hall Press, 2002.
[4] P. Riley. The tolls of privacy: An underestimated roadblock for electronic
In Third International Conference on Legal,
toll collection usage.
Security, and Privacy Issues in IT, 2008
[5] R. Reid. TomTom admits to sending your routes and speed information
to the police, 2011. CNET UK
[6] M. Dijk, C. Gentry, S. Halevi, V. Vaikuntanathan Fully Homomorphic
Encryption over the Integers. In Advances in Cryptology-Eurocrypt 2010,
24-43.
[7] J. Coron, A. Mandal, D. Naccache, M. Tibouchi Fully Homomorphic
Encryption over the Integers with Shorter Public Keys. In Advances in
Cryptology-Crypto 2011, 487-504.
[8] R. Zhang, Y. Zhang, J. Sun, and G. Yan. Fine-grained private matching
for proximity-based mobile social networking. In Proceedings of the 2012
IEEE INFOCOM, 1969-1977.
[9] M. Li, N. Cao, S. Yu, W. Lou. FindU: Privacy-preserving personal proﬁle
matching in mobile social networks. In Proceedings of the 2011 IEEE
INFOCOM, 2435-2443
[10] M. Arb, M. Bader, M. Kuhn, R. Wattenhofer. VENETA: Serverless
Friend-of-Friend Detection in Mobile Social Networking. In Proceedings
of the 2008 IEEE WIMOB, 184-189
[11] B. Wang, B. Li, H. Li. Gmatch: Secure and Privacy-Preserving
Group Matching in Social Networks. In Proceedings of the 2012 IEEE
GLOBECOM.
[12] M. Li, Z. Gao, S. Du. PriMatch: Fairness-aware Secure Friend Discovery
In Proceedings of the 2012 IEEE
Protocol in Mobile Social Network.
GLOBECOM.
[13] O. Pandey, Y. Rouselakis. Property preserving symmetric encryption In
Advances in Cryptology-EUROCRYPT 2012, 375-391.
[14] L. Zhang, X. Li, Y. Liu. Message in a sealed bottle: Privacy preserving
friending in social networks. In Proceedings of the 2013 IEEE ICDCS.
[15] M. Nagy, N. Asokan, E. Cristofaro. Do I know you? - Efﬁcient and
Privacy-Preserving Common Friend-Finder Protocols and Applications.
In Proceedings of the 2013 ACSAC.
[16] L. Kissner and D. Song. Privacy-preserving set operations. In Advances
in Cryptology-Crypto 2005, 241-257.
[17] Q. Ye, H. Wang, and J. Pieprzyk. Distributed private matching and set
In Information Security Practice and Experience, 347-360:
operations.
Springer, 2008.
[18] P. Paillier
Residuosity Classes.
223-238.
Public-key Cryptosystems based on Composite Degree
In Advances in cryptology-EUROCRYPT 1999,
[19] R. Agrawal, J. Kiernan, R. Srikant, Y. Xu. Order preserving encryption
for numeric data. In Proceedings of the 2004 ACM SIGMOD, 563-574.
[20] B. Alexandra. Order-preserving symmetric encryption. In Advances in
Cryptology-EUROCRYPT 2009, 224-241: Springer, 2009.
[21] R. Popa, F. Li, N. Zeldovich. An Ideal-Security Protocol for Order-
Preserving Encoding. In Proceedings of the 2013 S&P(Oakland).
[22] G. Ozsoyoglu, D. Singer, S. Chung. Anti-tamper databases: Querying
encrypted databases. In Proceedings of 2003 Annual IFIP WG. 11: 4-6.
[23] W. Sun, B. Wang, N. Cao, M. Li, W. Lou, Y.T. Hou, and H. Li. privacy-
preserving multi-keyword text search in the cloud supporting similarity-
based ranking? In Proceedings of the 2013 ACM ASIACCS.
[24] J. Kornblum. Identifying almost identical ﬁles using context triggered
piecewise hashing. Digit. Investig, 91-97. 2006.
[25] M. Srivatsa, M. Hicks. Deanonymizing mobility traces: using social
network as a side-channel. In Proceedings of the 2012 ACM CCS, 628-
637.
[26] J.
A.
http://crawdad.cs.dartmouth.edu/cambridge/haggle. [2009/05/29].
P. Hui, C. Diot,
dataset
Scott, R. Gass,
Chaintreau.
J. Crowcroft,
CRAWDAD
and
cambridge/haggle.
[27] J.
A.
http://crawdad.cs.dartmouth.edu/thlab/sigcomm2009. [2012/07/15].
J. Crowcroft,
CRAWDAD dataset
Scott, R. Gass,
Chaintreau.
P. Hui, C. Diot,
and
thlab/sigcomm2009.
[28] WEIBO API. http://open.weibo.com/wiki/. [2013/07/10].
[29] E. Cho , S. Myers and J. Leskovec. Friendship and mobility: user
movement in location-based social networks. In Proceedings of the 2011
ACM SIGKDD, 1082-1090.
[30] J. He, W Chu, Z Liu. Inferring privacy information from social networks.
Intelligence and Security Informatics. Springer Berlin Heidelberg, 2006.
154-165.
[31] A. Traud, P. Mucha, M. Porter. Social structure of Facebook networks.
Physica A: Statistical Mechanics and its Applications, 2012, 391(16):
4165-4180.
[32] E.R. Berlekamp. Algebriac Coding Theory. McGraw-Hill New York,
1968.
[33] J.L. Massey. Shift register synthesis and BCH decoding. Information
Theory, IEEE Transactions on 15, no. 1 (1969): 122-127.
[34] V. Guruswami and M. Sudan. Improved decoding of reed-solomon and
algebraic-geometric codes. In Proceedings of the 1988 IEEE FOCS, 28-
37.
[35] T. Hastie, R. Tibshirani. The elements of statistical learning. New York:
Springer, 2001.
[36] J. Katz, Y. Lindell.
man&Hall, 2008.
Introduction to modern cryptography. Chap-
[37] R. Popa, C. Redﬁeld, N. Zeldovich, and H. Balakrishnan. CryptDB: Pro-
tecting Conﬁdentiality with Encrypted Query Processing. In Proceedings
of the 2011 ACM SOSP. 85-100.
298298298
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 08:04:56 UTC from IEEE Xplore.  Restrictions apply.