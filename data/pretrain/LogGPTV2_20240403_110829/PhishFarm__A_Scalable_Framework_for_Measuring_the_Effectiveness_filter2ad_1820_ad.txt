### 优化后的文本

#### 数据
```
0.167
0.137
0.163
0.120
0.182
338
Sb
0.533
0
0
0
0.457
0.947
Sb
0.004
0.296
0.311
0
0.038
0.649
Sb
0.339
0.246
0.297
0.262
0.328
1
Sb
0.024
0.026
0.028
0.032
0.025
0.467
Sb
0.104
0.140
0.160
0.143
0.138
0.995
S
C
S
C
S
C
S
C
S
C
```

#### 风险缓解
与之前的报告相比，我们通过大规模的样本量来缓解这一风险，并在第五部分第七节中详细讨论了这一点。爬虫请求的分布呈现左偏态，特点是我们在报告后不久就收到了少量来自相关实体的请求，随后是大量来自该实体及其他实体的流量。重要的是，不同的隐藏技术对首次爬取尝试的时间没有显著影响；所有过滤器类型的中位响应时间从报告开始大约为50到53分钟。

在我们的完整实验中，只有被爬取的站点最终被列入黑名单。通常情况下，爬取还需要成功检索钓鱼内容才能列入黑名单，但在10个案例（全部是在GSB实验中使用过滤器D）中，即使检索失败，站点也会被列入黑名单。这可能是由于先前工作中描述的因素[20]。

#### 实体评分
对于每个测试的实体，设U为报告给该实体的钓鱼URL集合，B为监控的浏览器集合，T为观察到的列入黑名单的时间集合，F为使用的隐藏过滤器集合，M S表示全球浏览器市场份额。此外，我们定义函数accessible(b, f)的值为真，当且仅当带有过滤器f的钓鱼站点可以在浏览器b中访问。

对于B中的每个URL-浏览器组合，根据公式1，我们定义一个归一化的性能得分SU RLb，在范围[0, 1]内，其中0表示没有列入黑名单，1表示相对于报告时间立即列入黑名单。得分在我们的72小时观察窗口内线性衰减。

| 公式 | 描述 |
| --- | --- |
| (1) | 计算每个URL-浏览器组合的归一化性能得分 |
| (2) | 计算每个浏览器-过滤器组合的平均得分 |
| (3) | 计算每个浏览器的得分 |
| (4) | 计算整体得分 |

例如，一个在36小时后被列入黑名单的站点会有SU RLb = 0.5。我们根据公式2计算每个浏览器-过滤器组合的所有这些URL-浏览器得分的平均值Sbf。

我们进一步汇总Sbf得分以有意义地总结每个浏览器由每个实体提供的保护：根据公式3，浏览器得分Sb是给定浏览器b的所有Sbf的平均值，但限于在b中可访问的过滤器f。为了衡量每个隐藏过滤器的列入黑名单情况，我们报告P Bf作为每个相应过滤器至少在一个浏览器中被列入黑名单的站点的比例。请注意，P Bf将始终大于或等于任何Sbf，因为前者不受及时性差的影响；因此，我们还报告T Bf，即每个过滤器f的平均列入黑名单时间（以分钟为单位）。

为了捕捉每个实体的整体实际表现，我们根据每个浏览器的市场份额加权平均所有Sb，产生S，如公式4所示。得分S使我们能够高效地比较各实体之间的表现，并对未来PhishFarm部署中的长期趋势建模非常有用。我们还包括所有被爬取站点的比例C，以说明实体的响应努力。

我们在表VI中展示了完整测试中所有实体的上述汇总得分。确实，大量的0分或接近0分令人失望，代表了生态系统中的多个弱点，我们将在以下章节中讨论这些问题。初步测试的得分见附录II中的表VIII。注意，由于Chrome、Firefox和Safari在所有实验中的得分几乎相同，我们将表格简化为在GSB标题下报告最高得分。我们对Windows 10和8.1上的IE 11也做了类似的简化。

我们没有单独报告移动浏览器的表现，因为在我们的观察中，移动浏览器的行为与其桌面版本直接相关。在初步测试中，移动版Firefox和Opera的黑名单行为与其桌面版本一致。移动版Chrome和Safari在任何钓鱼站点上都没有显示黑名单警告，因此它们的Sb得分为0。在完整测试中，移动版Chrome、Safari和Opera的行为保持不变。Firefox停止显示黑名单警告，其得分因此降为0（移动浏览器的0分是一个严重的问题；在完整测试后我们联系了Google和Mozilla，如第六部分第一节所述，这个问题得到了纠正）。我们没有测试Microsoft的移动浏览器，因为移动版IE已不再支持；Edge for Android和iOS在我们开始测试后才发布。

#### 初步测试与完整测试
当我们比较同一实体在初步测试和完整测试中的表现时，我们观察到了许多核心相似之处。我们还看到了与我们在披露会议期间分享的建议相关的改进，特别是关于APWG对过滤器C和E的处理。值得注意的是，在完整测试中，具有隐藏技术的站点的爬虫流量增加了44.7%，而总体流量也增加了89.7%。我们在第五部分第六节中讨论了所有特定实体的改进。

然而，这种比较也揭示了一些意外情况。两组测试的主要实验差异在于样本量，以及我们在完整测试中独家使用随机URL。另一方面，初步测试包括了一部分欺骗性URL。在初步测试中，我们观察到Edge和IE在某些欺骗性URL的站点上迅速显示黑名单警告。实际上，许多类型IV URL（域名包含PayPal品牌或欺骗性关键词）在这些浏览器中无需任何先前的爬虫活动即可看到主动的零小时警告。附录II中的图5b显示了初步测试中URL类型对黑名单的影响。在完整测试中，除非之前有爬虫访问过，否则没有任何钓鱼站点被列入黑名单。在没有欺骗性URL的情况下，我们观察到所有黑名单都是纯粹反应性的；这导致Edge、IE和带有过滤器B的站点的Sb得分较低，SmartScreen的整体得分S也较低。

#### 浏览器性能
图2显示了在整个完整实验过程中按浏览器分组的我们钓鱼站点的黑名单百分比，但限于每个桌面浏览器中预期可访问的站点（即Filter B被排除在外，Filter C和D被排除在IE、Edge和Opera之外）。Chrome、Safari和Firefox始终表现出最高的黑名单速度和覆盖率，但仍远未覆盖所有隐藏站点。Opera在前四小时内通常优于Microsoft浏览器，但在剩余实验期间被超越。在没有欺骗性钓鱼URL的情况下，Edge和IE在完整测试中失去了优势；附录II中的图5c显示了它们在初步测试中的优越表现。

1. **浏览器之间的一致性**：
   Chrome、Firefox和Safari都受到GSB黑名单的保护；我们的测试确认这些浏览器确实会一致地显示相同的网站黑名单警告。然而，在我们的完整测试中，Chrome显示警告的时间比Safari提前多达30分钟，比Firefox提前多达一个小时；警告在五小时后变得一致。经过进一步调查，我们认为这种差异是由每个浏览器中GSB Update API (v4)的不同缓存实现引起的（此API确保隐私和快速查找，但需要定期刷新整个黑名单[53]）。延迟是黑名单的一个显著缺点[6]，并且看起来浏览器黑名单缓存仍可以从安全角度进行改进。

   Edge和IE 11（两者都受SmartScreen保护）证明一致性较差。在完整测试中，Edge显示警告的时间比IE早多达两个小时，并且在24小时内覆盖了更多站点。然而，在涉及可以通过启发式检测的欺骗性URL的初步测试中，IE经常会在Edge显示警告之前几个小时甚至根本不显示警告的情况下显示预先警告。这些偏差在初步APWG、SmartScreen和PayPal测试中很明显，如附录II中的表VIII所示。

#### 过滤器性能
图3显示了在整个完整实验过程中按隐藏过滤器类型分组的我们钓鱼站点的黑名单百分比。由于此摘要视图掩盖了我们在表VI中观察到的一些独特的每个实体行为，请参阅附录I中的图4作为补充。请注意，由于这些图表考虑了所有浏览器-过滤器组合，它们的Y轴与图2和表VI中的Sbf得分不同。尽管如此，它们都传达了一个发现：当今的黑名单存在相当大的差距。

我们观察到的最早黑名单出现在大约40分钟后，在Chrome中。在1.5到6.5小时之间出现了显著增长，并在此后的72小时内以较慢的速度继续增长。与没有隐藏的站点相比，我们的隐藏技术在整个钓鱼站点生命周期中显示出中等到高度的有效性。过滤器B在我们测试的任何桌面或移动浏览器中都没有被列入黑名单。过滤器E和F在部署的早期几个小时内最有效，而地理特定的过滤器C和D在长期内黑名单数量最低。在部署后的48到72小时内，带有过滤器E的站点略微超过了带有过滤器A的站点；经过进一步分析，我们发现这是由于向APWG报告后对这类站点的高度关注所致。其他所有类型的带有隐藏技术的站点平均来说被列入黑名单的可能性低于没有隐藏技术的站点。

#### 实体性能
虽然没有单个实体能够独立克服所有的隐藏技术，但集体来看，除了过滤器B外，实体们可以成功做到这一点（这个问题已在第六部分第一节中讨论并得到修正）。

1. **Google Safe Browsing (GSB)**：
   由于它所保护的浏览器市场份额高，GSB是当今最具影响力的反钓鱼黑名单。它在初步测试和完整测试中均获得了最高的S得分。GSB的关键优势在于其速度和覆盖率：我们观察到，通常在我们报告站点后几秒钟就会有一个爬虫访问我们的站点。在完整测试中，我们报告的所有站点中有94.7%实际上被爬取，而没有隐藏技术（过滤器A）的站点中有97%最终被列入黑名单。过滤器D的黑名单情况与此类似，过滤器F在完整测试中有所改善。

   然而，GSB在处理过滤器E（阻止特定于Google爬虫的主机名）和过滤器C（拒绝非美国流量）方面遇到了困难。相应的P Bf得分低的原因是，如果初始爬虫访问钓鱼站点失败，GSB会放弃进一步的爬取尝试；初始访问几乎总是来自可预测的非美国IP地址。另一个弱点似乎是数据共享，因为我们报告给GSB的站点最终没有被列入Edge、IE或Opera的黑名单。

2. **Microsoft SmartScreen**：
   SmartScreen被证明是唯一利用主动URL启发式方法来将钓鱼站点列入黑名单的本地反钓鱼黑名单，这使得Microsoft浏览器在初步测试中取得了高分。这些启发式方法主要由具有欺骗性域名的URL触发。在初步测试中，Edge表现出色，Sb得分为0.87——这是所有浏览器中最高的。

   在完整测试中，IE的表现比初步测试有所提高，并变得更加一致。出乎意料的是，SmartScreen更有可能将带有隐藏技术的站点列入黑名单，而不是那些没有隐藏技术的站点，可能是因为使用了隐藏技术分类（这值得称赞），同时也对我们的钓鱼报告信任度较低（见限制）。向SmartScreen报告似乎对非Microsoft浏览器没有显著影响；因此，该实体与GSB存在类似的缺点。SmartScreen也是对钓鱼报告作出反应最慢的实体之一，其整体覆盖率较差，这是它的关键弱点。

3. **APWG**：
   APWG在我们的完整测试中得分第二高，并且对所有浏览器的保护都很一致。其得分S与初步测试相比有了显著提高，这是因为改进了绕过过滤器C和E的方法，从而允许APWG报告在GSB浏览器中将此类站点列入黑名单——这是我们在直接报告给GSB时未能实现的。APWG还生成了我们测试的所有实体中最高的爬虫流量。

   不幸的是，APWG在完整测试中未能将任何带有过滤器D或F的站点列入黑名单；其初步的成功完全依赖于IE和Edge对欺骗性URL的检测。有趣的是，我们在24小时后观察到带有过滤器E的站点黑名单数量大幅增加；通过对流量日志的分析，我们认为这是由于与PayPal的数据共享（这一趋势也在图4e中反映出来）。

4. **PhishTank**：
   PhishTank是一个社区驱动的清除中心，允许人类志愿者识别钓鱼内容[54]；它还利用一系列爬虫和合作伙伴来辅助这项工作。它是我们在初步测试中表现第二高的实体，得益于其在GSB浏览器中的快速黑名单操作。在完整测试中，我们惊讶地发现只有46.7%的报告站点被爬取，而且很少有站点最终被列入黑名单。尽管如此，PhishTank生成了第二高的总爬虫流量。我们不知道其不足的原因，PhishTank也没有回复我们的披露；我们怀疑PhishTank的手动分类性质可能是其限制因素。

5. **PayPal**：
   在初步测试中，PayPal自己的滥用报告服务难以绕过过滤器D和F，但在完整测试中克服了后者，并保持了一定程度的黑名单操作。其对Opera的保护也在两次测试之间有所改善。尽管在完整测试中，除了两个站点外，所有报告的站点都被爬取，但平均响应时间和浏览器保护总体上仍然较差。我们不能透露原因，但预计未来会因我们的发现而有所改进。

6. **其余实体**：
   仅包含在初步测试中的实体的性能得分见附录II中的表VIII。以下是每个实体的高级描述。
   - 我们报告给ESET的所有站点最终都被爬取，但只有少数站点（所有都是过滤器A）实际上被列入黑名单。整体及时性较差，尽管黑名单涵盖了多个浏览器。
   - Netcraft在初步测试中提供了对Opera的最佳保护，但总体上它难以应对大多数隐藏技术，并且没有及时将其列入黑名单。回顾起来，鉴于PhishTank在完整测试中的意外糟糕表现，我们本应对Netcraft进行重新测试。
   - 向US CERT报告导致的爬虫活动和黑名单数量极少；忽略Microsoft浏览器的启发式方法，只有一个站点被列入黑名单。
   - 我们发送给McAfee的钓鱼报告有效地绕过了过滤器A和E，但似乎只在Microsoft Edge中实现了及时黑名单。
   - 向WebSense的报告除了与Microsoft使用的URL启发式方法相关的爬虫流量外，没有其他效果；尽管我们希望电子邮件报告渠道能取得成果，但这可以理解，因为该公司专注于对其企业客户的保护。

#### 限制
我们的发现基于一项尽可能控制（在不发送真实垃圾邮件的情况下）的经验实验，并结合了大量的支持元数据和高流量的反滥用爬虫流量。我们的研究仅关注在测试的浏览器和平台中默认可用的本地钓鱼黑名单保护。安装第三方安全软件的系统可能会看到增强的保护[6]，尽管隐藏技术也可能对这些系统的功能产生影响。

在其范围内，我们的分析仍需考虑某些限制。我们怀疑现实世界中的钓鱼攻击黑名单可能比我们的结果表明的更为及时，因为我们在实验设计中努力隔离隐藏技术作为变量（即使用随机域名，从未在被监控的浏览器中渲染实际的钓鱼内容，并使用注册几个月后的.com域名），这也消除了生态系统用于检测或分类钓鱼的许多方法（例如，基于URL、网络或DNS的分析）。然而，这种降低的可检测性在一定程度上被恶意行为者同样能够逃避这些形式的检测的可能性所抵消。我们在初步测试中观察到，只有包含品牌名称的URL比其他URL更快被列入黑名单；在野外，也有越来越多的趋势滥用受损基础设施并分发随机钓鱼URL，而不是更具欺骗性的替代方案[8], [49]。就我们可控的因素而言，实现所有域名与IP地址的一对一映射在经济上不可行；这可能在完整测试中对黑名单有利，例如在GSB实验中有10个过滤器D站点尽管未被成功检索但也被列入黑名单。

最后，我们仅为每个部署的钓鱼站点提交了一份直接报告。尽管现实世界的钓鱼站点可能会收到更多的自动报告（例如来自垃圾邮件过滤器等来源），但每条URL的实际钓鱼报告数量实际上可以被攻击者减少（例如通过使用重定向链接）。更重要的是，像我们这样的直接报告（特别是向黑名单运营商）可能会引起更多怀疑，因为反钓鱼实体必须考虑到愿意提交虚假报告或试图剖析爬虫基础设施的对手。尽管我们披露的黑名单运营商并未对我们报告的方法表示担忧，但我们了解到，用于响应直接报告的爬虫基础设施确实被设计成不可预测的，以减轻对抗性提交。SmartScreen较低的爬取率可能是由此解释的；而GSB则始终快速响应，并似乎给予了我们的直接报告很高的优先级。因此，要么报告渠道滥用分类非常准确，要么报告渠道比实体认为的更容易受到对抗性提交的影响；无论如何，为了提高未来报告的有效性，我们在第六部分第二节提出了另一种方法。

最终，如果每份报告都代表一个钓鱼站点被列入黑名单的机会，我们认为我们的实验设计仍然捕捉到了其中的趋势；此外，我们关于隐藏技术有效性的发现与内部PayPal电子邮件和网络流量数据中实际钓鱼受害者的实际情况是一致的。为了解决当前的局限性，我们的框架可以适应不同的（可能是协作安排的）报告方法，考虑更广泛的隐藏技术，甚至应用于可以分析隐藏技术的主动检测的实时钓鱼URL。

1. **统计测试**：
   在完整测试中，我们惊讶地发现每个实体在不同过滤器方面的黑名单表现比初步测试中更加明显；表VI中有11个实体过滤器组完全没有黑名单记录。尽管ANOVA最初计划可以有意义地应用于满足方差齐性的三个或更多过滤器组（即有一些黑名单活动）的子集[50]，但我们选择不执行此类测试，因为