proﬁling tool [9] to conﬁrm the product that is installed on a
given host. For some products (e.g., Netsweeper) WhatWeb
contains a pre-existing signature that we leverage in our val-
idation, whereas in other cases we create signatures based on
HTTP headers observed when running the WhatWeb tool
on an IP address. Table 2 also summarizes how we identify
the various products using WhatWeb.
Finally, we use geolocation data from MaxMind [15] and
whois data from TeamCymru [31] to map the IP addresses
matching WhatWeb signatures to country-level location and
autonomous system (AS) number.
3.2 Networks with URL ﬁltering installations
Figure 1 summarizes the countries where each product
was observed. While ONI tends to focus on installations by
national ISPs, our new methodology allows us to uncover
URL ﬁltering installations in a wider set of countries and
networks. Indeed, we observe Blue Coat in many new coun-
Figure 1: Locations of URL ﬁlter installations
tries and regions: South America (Argentina and Chile),
Europe (Finland, Sweden), Asia (Philippines, Thailand and
Taiwan) and the Middle East (Israel, Lebanon). Further, for
the remaining three products all the installations we discover
(with the exception of McAfee SmartFilter in Pakistan) were
previously unknown.
As expected, we observe installations on a diverse range
of networks in the US, such as Websense in two Texas util-
ities’ networks and Netsweeper installations in educational
networks in West Virginia, Oklahoma and Missouri. How-
ever, we also observe Netsweeper installations in large ISP
networks such as Global Crossing, AT&T, Verizon, and Bell
South; and Blue Coat installations in Comcast and Sprint.
Interestingly, we also observe an installation of Blue Coat
on an IP address registered to the United States Informa-
tion Systems Command (USAISC). The dual-use of these
products for network management and censorship, requires
conﬁrming how they are used before drawing conclusions.
4. CONFIRMING USE OF URL FILTERS
Many of the products we identify play a legitimate role
in network management. Thus, when evaluating the human
rights implications of these technologies, it is important to
validate that they are actually being used for censorship.
Further, vendors may obscure the identities of their prod-
ucts by removing the headers we identiﬁed in Table 2. The
conﬁrmation method we present, is robust to a lack of sig-
natures and does not require the IP address of the URL
ﬁlter be externally visible. However, we use networks iden-
tiﬁed via the techniques in Section 3 as a case study of our
technique.
4.1 In-network testing
To conﬁrm that a URL ﬁlter is being used for censorship,
we perform experiments from within the network under con-
sideration, using our global network of testers. Tests of Web
page accessibility are performed using a measurement client
25that accesses a speciﬁed list of URLs in the “ﬁeld” i.e., the
location where censorship is suspected. This client software
also triggers the same set of URLs to be accessed from a
server in our lab at the University of Toronto (which does
not censor the type of content tested). The results of the
Web page accesses in the ﬁeld and lab are compared to de-
termine if the page was blocked in the ﬁeld location. For our
measurements of URL ﬁltering, we test short lists of URLs
that are amenable to manual analysis of results. Further,
the products we test tend to use block pages that explic-
itly state that content has been censored. Thus, we avoid
ambiguities such as censorship via dropped packets or TCP
resets.
4.2 Methodology
Our methodology seeks to answer the question:
is the
given URL ﬁltering product used for censorship in the mea-
sured ISP? Since many URL ﬁlters provide a mechanism for
users to submit sites that should be blocked, we wondered if
we could use this mechanism to conﬁrm the use of a speciﬁc
URL ﬁlter. The basic idea is to test sites (under our con-
trol) that are not blocked within the ISP, and then submit
a subset of these sites to the appropriate URL ﬁlter vendor.
After 3-5 days, we retest the sites and observe whether or
not the submitted sites are blocked. If they are blocked, it
is highly likely that the URL ﬁlter under consideration is
being used for censorship, and our submission of the sites
triggered the blocking. We present case studies that explore
the eﬀectiveness of this idea to conﬁrm the use of a variety
of products in networks where we have in-country testers.
Table 3 summarizes these case studies.
4.3 Case study: McAfee SmartFilter in UAE
and Saudi Arabia
In 2009, the ONI identiﬁed McAfee SmartFilter being
used in UAE’s national ISP, Etisalat, and in a centralized
blocking implementation in Saudi Arabia (eﬀectively used
for all ISPs) [23, 24]. We use our proposed methodology to
conﬁrm whether these technologies are still deployed in these
networks in 2012 and 2013.
ONI had previously observed Etisalat using SmartFilter to
block content related to anonymizing proxies [24]. Thus, we
created a set of 10 domains providing proxy services to test
whether SmartFilter was still being used. These domains
had the form of two random (non-profane) words registered
with the “.info” top-level domain (e.g., starwasher.info)
and contained the Glype proxy script [8] as their index page.
We ﬁrst ran measurements in the country to verify that these
10 domains were accessible. We then submitted ﬁve of these
domains to SmartFilter for blocking. Within a few days
we observed that the ﬁve submitted sites were blocked on
Etisalat, thus conﬁrming that the product was still in use
within the country (Table 3).
Challenge 1: Access to sites that will be blocked.
Our methodology requires access to Web sites that are blocked
by the studied ISP. Unlike UAE, we found Web sites classi-
ﬁed as proxies by SmartFilter were accessible in Saudi Ara-
bia. Thus it appears that Saudi Arabia is not using the
proxy category provided by SmartFilter in their deployment.
However, Web sites classiﬁed as pornography by SmartFil-
ter are blocked in Saudi Arabia. Thus, we perform a similar
experiment as we did for UAE, except that the 10 created
domains hosted an adult image found via a Google image
search. (The image was only used for the duration of our
experiment and then removed.) Using the ISP Bayanat Al-
Oula, we veriﬁed that the 10 domains were accessible in
Saudi Arabia. We then submitted ﬁve of the domains to
SmartFilter for blocking. After four days, we observed that
these ﬁve domains were blocked (Table 3). We repeated this
methodology on Nournet, also in Saudi Arabia, and Etisalat
to conﬁrm SmartFilter is still used within these ISPs in 2013.
4.4 Case study: Netsweeper in Qatar, UAE
and Yemen
Implementation details of censorship platforms can im-
pact the ability of our method to conﬁrm censorship. For
example, we have observed Netsweeper queuing Web sites
for categorization once they have been accessed within the
country (to expand the set of categorized sites [19]). As a
result, once we have validated that our set of URLs is acces-
sible, they may be queued for categorization by Netsweeper,
and eventually may be blocked. Thus, it is not possible for
us to validate that our sites are accessible prior to submit-
ting a subset of them to be blocked. As a result, we operate
on the assumption that none of our sites will be blocked
prior to submission.
Prior study by the ONI identiﬁed the use of Netsweeper in
YemenNet in Yemen [25], Du, in UAE [24] and Ooredoo, in
Qatar [21] to block content related to anonymizing proxies.
Thus, we use these ISPs to test our proposed methodology.
We created a list of 12 domains providing proxy services and
submitted six of them to Netsweeper’s “test-a-site” service
for classiﬁcation [20]. We then accessed these 12 domains in
YemenNet, Du and Ooredoo, and observed whether the six
submitted sites were blocked. In all three ISPs, the method-
ology was successful with 5 of the 6 sites blocked in Du and
all six blocked in YemenNet and Ooredoo. (Table 3).
Challenge 2: Inconsistent blocking. Validating cen-
sorship in Yemen was complicated by inconsistent blocking.
We observed cases where the blocking technology appeared
to be temporarily “oﬄine” within the country. For exam-
ple, some proxy URLs are accessible on runs where other
proxy URLs are blocked, while in later runs the reverse is
true for the same set of URLs. Indeed, prior work by the
ONI observed a Yemeni ISP using Websense with a limited
number of concurrent user licenses. When the number of
users exceeded the number of licenses no content would be
ﬁltered [25].
Inconsistent blocking means that we need to repeat the
tests numerous times and require a larger set of domains for
testing (as we cannot be sure that previously-accessed sites
are not queued for classiﬁcation). This inconsistency limits
the scalability of our approach for validating Netsweeper
installations in Yemen.
However, we identiﬁed another way to validate that Net-
sweeper is being used for censorship. To help with conﬁg-
uration of the middlebox, Netsweeper provides a Web site
for operators to validate that censorship is working within
their network by querying a set of 66 category-speciﬁc URLs
(e.g., denypagetests.netsweeper.com/category/catno/23
for pornography). While this method is only viable in net-
works where the tool has not been disabled, a manual test of
this tool in YemenNet, in January 2013, indicated that ﬁve
categories were blocked: adult images, phishing, pornogra-
phy, proxy anonymizers, and search keywords.
26Product
Country
ISP
Table 3: Summary of URL ﬁlter case studies.
Date
4/2013
4/2013
4/2013
9/2012
5/2013
9/2012
4/2013
8/2013
3/2013
3/2013
Sites
submit-
ted
3/6
3/6
5/10
5/10
5/10
5/10
5/10
6/12
6/12
6/12
Category
Sites
blocked
Conﬁrmed?
Proxy Avoidance
Proxy Avoidance
Pornography
Pornography
Pornography
Anonymizers
Pornography
Proxy anonymizer
Proxy anonymizer
Proxy anonymizer
0/3
0/3
0/5
5/5
5/5
5/5
5/5
6/6
5/6
6/6
N
N
N
Y
Y
Y
Y
Y
Y
Y
UAE
Blue Coat
Blue Coat
Qatar
McAfee SmartFilter Qatar
McAfee SmartFilter
McAfee SmartFilter
McAfee SmartFilter UAE
McAfee SmartFilter UAE
Qatar
Netsweeper
Netsweeper
UAE
Yemen
Netsweeper
Etisalat (AS 5384)
Ooredoo (AS 42298)
Ooredoo (AS 42298)
Etisalat (AS 5384)
Etisalat (AS 5384)
Ooredoo (AS 42298)
Du (AS 15802)
YemenNet (AS 12486)
Saudi Arabia Bayanat Al-Oula (AS 48237)
Saudi Arabia Nournet (AS 29684)
Table 4: Summary of Web content blocked by URL ﬁltering products.
Category
Media
Freedom
Human
Rights
Political
Reform
LGBT Religious
Criticism
Minority Groups
and Religions
Where
Product
McAfee SmartFilter UAE (AS 5384)
Netsweeper
Netsweeper
Netsweeper
X
Yemen (AS 12486) X
X
UAE (AS 15802)
Qatar (AS 42298)
X
X
X
X
X
X
X
X
X
X
X
X