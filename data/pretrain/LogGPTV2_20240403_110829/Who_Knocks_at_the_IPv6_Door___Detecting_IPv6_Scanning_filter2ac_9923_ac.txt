128
17
16
95
6723
1.90
0.25
0.24
1.41
100.00
the backbone segment or send traffic to the darknet, but potentially
more sensitive at detecting small scans.
First, we find four scanners in both DNS backscatter and MAWI
backbone data: scanners (a) through (d) in Table 5. Only scanner
(a) appears in darknet data.
Scanner (a) probes TCP port 80. It appears in MAWI on six days,
but the intensity of DNS backscatter is not high (Parenthetic number
in DNS BS indicates the number of weeks the originator appears at
least once). Scanners (b) to (d) appear two times in DNS backscatter
and also two days in MAWI. These results provide confirmation
that DNS backscatter does see actual scanners.
This result also shows the limited effectiveness of darknets for
IPv6: they can only see a tiny fraction of the vast IPv6 space, making
DNS backscatter and traffic observation more important techniques
in IPv6. Only scanner (a) appears in the darknet, MAWI, and DNS
backscatter. Some of CAIDA’s Archipelago measurements [3] ap-
pear only in the darknet.
Second, we see that DNS backscatter misses three of the scanners
we see in MAWI (scanners e, f, and g). DNS backscatter only detects
big events that generate many reverse queries, and these scanners
are fairly brief (1 or 2 days seen in MAWI). In addition, scanners (e)
through (g) target only a narrow range of IP blocks (i.e., a single
/48), so DNS backscatter from many locations is unlikely. Thus,
these scanners show that DNS backscatter will miss small scans.
Third, we see that there are 95 unknown (potential abuse) de-
tections seen in backscatter data only. We suggest that these are
potential scanners missed in MAWI and our darknet. In fact, in
discussions with a researcher doing scanning we confirmed that
we see scanner IPs in backscatter although not in MAWI, probably
because their scans do not include enough hosts at the vantage
point in the sampling time window (15 minutes per day) [15].
Scan types: A natural question is to ask what hitlists these
known, detected scanners employ. Carefully checking target IP
addresses of the scanners, we find three typical patterns. First, rand
IID, IPs consisting of /64 prefix + small and random right most
nibble in IID such as scanning 2001:db8:1::10, then 2001:db8:ff::10.
For rDNS, IPs are those with reverse name registered in reverse
DNS. Finally, Gen suggests use of a target generation algorithm. The
hitlist of scanner (a) appears to use a target generation algorithm.
This scanner originates from address space used by Murdock et
al. [24] developers of one such algorithm; they confirmed that we
detected their scanning. Scanners (b) and (c) are rand IID, but since
they lack traffic in the darknet, we guess that they probe specific
routed prefixes as seeds. On the other hand, scanners (d) through
(g) rely on reverse names (rDNS), similar to our probes. In summary,
we confirm that the detected scanners employ multiple types of
hitlists.
Temporal correlation: To better understand the nature of IPv6
scanning we next investigate the temporal behavior of scanners
(a) through (d) in both DNS backscatter and MAWI traffic. Figure 2
shows our six months of observations for each of these scanners.
Each “x” is a detection in MAWI, and the bars show the number of
queriers seen in DNS backscatter.
This comparison confirms that DNS backscatter successfully
detects network-wide scans, since most scans seen in MAWI result
in DNS backscatter. Queries for other isolated DNS backscatter
suggest a possibility of network scans targeting other networks, or
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Kensuke Fukuda and John Heidemann
IP
#days
MAWI
port
scan type
6 TCP80 Gen
2
ICMP
2 TCP80
ICMP
2
ICMP
2
ICMP
1
1
ICMP
rand IID
rand IID
rDNS
rDNS
rDNS
rDNS
Backscatter
#weeks
1 (5)
2 (4)
2 (2)
2 (3)
0 (4)
0 (0)
0 (0)
Dark
#weeks
1
0
0
0
0
0
0
ASN info
40498 New Mexico Lambda Rail
29691 Nine, CH
51167 Contabo, DE
5541 ADNET-Telecom, RO
18403
197540 NETCUP-GmbH, DE
FPT-AS-AP, VN
6057 ANTEL, UY
(a)
(b)
(c)
(d)
(e)
(f)
(g)
2001:48e0:205:2::/64
2a02:418:6a04:178::/64
2a02:c207:3001:8709::/64
2a03:f80:40:46::/64
2405:4800:103:2::/64
2a03:4000:6:e12f::/64
2800:a4:c1f:6f01::/64
Table 5: Observed IPv6 scanners in MAWI; /64 of IPs are anonymized. Scan types consist of Gen: target generation, rand IID:
random and small right most nibble, and rDNS: reverse name registered.
However, we see a consistent, slow increase in confirmed scan-
ners over time. Confirmed scanners increase from 8 originators in
July to 28 in December. We are cautious in interpreting this trend,
since three factors are relevant: greater scanning, greater classifi-
cation of scanning, and generally greater use of IPv6. We do see
this increase outpaces the general increase in all DNS backscatter
over that time, which went from about 5000 to 8000 IPs over this
period. However, the 3× increase in scanning is larger than the 60%
increase in all DNS backscatter. Our count of confirmed scanners
is based on seeing them some other source (MAWI or darknet or
blacklist), so it is possible that we are just better at confirming scan-
ners. However, we cautiously suggest that IPv6 scanning seems to
be increasing over time.
5 CONCLUDING REMARKS
This paper adapts DNS backscatter to IPv6. DNS backscatter is able
to detects many cloud providers, CDNs and services in IPv6, in
addition to finding 16 confirmed scanners and about 95 unknown
(potential abuses) per week. We also show that IPv6 scanning ac-
tivity is increasing, and confirm that IPv6 is less closely monitored
than IPv4. We believe DNS backscatter will be an important tool
in IPv6, since approaches such as darknets are much less effective
with IPv6’s huge address space compared to IPv4.
ACKNOWLEDGMENTS
We thank Yuri Pradkin for B-Root data collection. We thank our
shepherd Alan Mislove, the IMC reviewers, Yoshinobu Matsuzaki,
Kenjiro Cho, Romain Fontugne, and Johan Mazel comments on this
paper. We thank the researchers on IPv6 scanning who discussed
their systems with us [15, 24].
Kensuke Fukuda’s work is partially funded by JSPS KAKENHI
Grant Number 18H03237.
John Heidemann’s work was supported by the Office of the Direc-
tor of National Intelligence (ODNI) and the Intelligence Advanced
Research Projects Activity (IARPA) via the Air Force Research Labo-
ratory (AFRL) contract number FA8750-16-C-0112, and the Depart-
ment of Homeland Security (DHS) via AFRL agreements number
FA8750-17-2-0280 and FA8750-17-2-0096. The U.S. Government is
authorized to reproduce and distribute reprints for Governmental
purposes notwithstanding any copyright annotation thereon. The
views and conclusions contained herein are those of the authors
and should not be interpreted as necessarily representing the offi-
cial policies or endorsements, either expressed or implied, of ODNI,
IARPA, DHS, AFRL, or the U.S. Government.
Figure 2: MAWI scans and DNS backscatter
Figure 3: Number of scans and unknown (potential abuse)
over time
scanning that does not occur in the brief fraction of the day our
MAWI dataset provides.
4.4 Abuse Over Time
Finally, Figure 3 examines the trend in potential abuse originators
over time. We see considerable variation in the unknown (potential
abuse) category, and although the trend is slightly upward, it is
very noisy.
 0 2 4 6 8 10 1207/2708/1008/2409/0709/2110/0510/1911/0211/16xxxxxxx(a)mawi scansNumber of unique queriers 0 5 10 15 20 25 30 35 40 4507/2708/1008/2409/0709/2110/0510/1911/0211/16xx(b)mawi scansNumber of unique queriers 0 10 20 30 40 5007/2708/1008/2409/0709/2110/0510/1911/0211/16xx(c)mawi scansNumber of unique queriers 0 10 20 30 40 50 60 7007/2708/1008/2409/0709/2110/0510/1911/0211/16xx(d)mawi scansNumber of unique queriersdate (2017) 0 20 40 60 80 100 120 140 160 180 200070809101112confirmed scanunknown (potential abuse)Number per weekMonth (2017)Who Knocks at the IPv6 Door? Detecting IPv6 Scanning
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Ireland, 9. https://doi.org/10.23919/TMA.2017.8002909
[24] Austin Murdock, Frank Li, Paul Bramsen, Zakir Durumeric, and Vern Paxson.
2017. Target Generation for Internet-wide IPv6 Scanning. In Proceedings of the
ACM Internet Measurement Conference. ACM, San Diego, CA, USA, 242–253.
https://doi.org/10.1145/3131365.3131405
[25] Robert O’Harrow,
control
2012).
industrial
(June
3
cyber-search-engine-exposes-vulnerabilities/2012/06/03/gJQAIK9KCV_
story.html
Cyber search engine Shodan exposes
The Washington Post
http://www.washingtonpost.com/investigations/
Jr. 2012.
systems
to new risks.
[26] Lin Quan, John Heidemann, and Yuri Pradkin. 2012. Trinocular: Understand-
ing Internet Reliability Through Adaptive Probing. In Proceedings of the ACM
SIGCOMM Conference. ACM, Hong Kong, China, 255–266.
REFERENCES
[1] Steve Bellovin, Bill Cheswick, and Angeleos Keromytis. 2006. Worm propagation
strategies in an IPv6 Internet. ;Login: 31, 1 (Feb. 2006), 70–76. https://www.cs.
columbia.edu/~smb/papers/v6worms.pdf
[2] Kevin Borgolte, Shuang Hao, Tobias Fiebig, and Giovanni Vigna. 2018. Enu-
merating Active IPv6 Hosts for Large-scale Security Scans via DNSSEC-signed
Reverse Zones. In Proceedings of the 39th IEEE Symposium on Security and Privacy.
IEEE, San Francisco, CA, USA, 438–452. https://kevin.borgolte.me/files/pdf/
sp2018-dnssec-ipv6.pdf
[3] CAIDA. 2009. Archipelago (Ark) Measurement Infrastructure. http://www.caida.
org/projects/ark/. (2009).
[4] CAIDA. 2017. The CAIDA UCSD IPv6 Topology Dataset. http://www.caida.org/
data/active/ipv6_allpref_topology_dataset.xml. (2017).
[5] Brian E. Carpenter and Keith Moore. 2001. Connection of IPv6 Domains via IPv4
Clouds. RFC3056. (2001).
[6] Kenjiro Cho, Koshiro Mitsuya, and Akira Kato. 2000. Traffic Data Repository at
the WIDE Project. In USENIX 2000 Annual Technical Conference: FREENIX Track.
USENIX, 263–270.
[7] Kimberly Claffy, Young Hyun, Ken Keys, Marina Fomenkov, and Dmitri Krioukov.
2009. Internet Mapping: from Art to Science. In Proceedings of the IEEE Cyberse-
curity Applications and Technologies Conference for Homeland Security (CATCH).
IEEE, Alexandria, VA, USA, 205–211. https://doi.org/10.1109/CATCH.2009.38
[8] Jakub Czyz, Matthew Luckie, Mark Allman, and Michael Bailey. 2016. Don’t
Forget to Lock the Back Door! A Characterization of IPv6 Network Security Policy.
In Proceedings of the ISOC Network and Distributed System Security Symposium.
The Internet Society, San Diego, CA, USA. http://mdbailey.ece.illinois.edu/
publications/ndss16_ipv6.pdf
[9] Zakir Durumeric, Michael Bailey, and J. Alex Halderman. 2014. An Internet-
Wide View of Internet-Wide scanning. In Proceedings of the 23rd USENIX Security
Symposium. USENIX, San Diego, CA, 65–78.
[10] Zakir Durumeric, James Kasten, Michael Bailey, and J. Alex Halderman. 2013.
Analysis of the HTTPS Certificate Ecosystem. In Proceedings of the ACM Internet
Measurement Conference. ACM, Barcelona, Spain. http://conferences.sigcomm.
org/imc/2013/papers/imc257-durumericAemb.pdf
[11] Zakir Durumeric, Eric Wustrow, and J. Alex Halderman. 2013.
Internet-wide Scanning and Its Security Applications.
ZMap:
Fast
In Proceed-
ings of the USENIX Security Symposium. USENIX, Washington, DC, USA,
605–620. https://www.usenix.org/system/files/conference/usenixsecurity13/
sec13-paper_durumeric.pdf
[12] Tobias Fiebig, Kevin Borgolte, Shuang Hao, Christopher Krugel, and Giovanni
Vigna. 2017. Something From Nothing (There): Collecting Global IPv6 Datasets
From DNS. In Proceedings of the Passive and Active Measurement Conference.
Springer, Sydney, Australia, 30–46.
[13] Pawel Foremski, David Plonka, and Arthur Berger. 2016. Entropy/IP: Uncovering
Structure in IPv6 Addresses. In Proceedings of the ACM Internet Measurement
Conference. ACM, Santa Monica, CA, USA. https://doi.org/10.1145/2987443.
2987445
[14] Kensuke Fukuda, John Heidemann, and Abdul Qadeer. 2017. Detecting Malicious
Activity with DNS Backscatter Over Time. ACM/IEEE Transactions on Networking
25, 5 (Aug. 2017), 3203–3218. https://doi.org/10.1109/TNET.2017.2724506
[15] Oliver Gasser, Quirin Scheitle, Pawel Foremski, Qasim Lone, Maciej Korczynski,
Stephen D. Strowes, Luuk Hendriks, and Georg Carle. 2018. Clusters in the
Expanse: Understanding and Unbiasing IPv6 Hitlists. In Proceedings of the ACM
Internet Measurement Conference. ACM, Boston, Mass., USA, to appear.
[16] Oliver Gasser, Quirin Scheitle, Sebastian Gebhard, and Georg Carle. 2016. Scan-
ning the IPv6 Internet: Towards a Comprehensive Hitlist. In Proceedings of the
IFIP International Workshop on Traffic Monitoring and Analysis. IFIP, Louvain La
Neuve, Belgium, 1–7.
[17] Fernando Gont and Tim Chown. 2016. Network Reconnaissance in IPv6 Networks.
RFC7707. (2016).
[18] Robert Graham, Paul McMillan, and Dan Tentler. 2014. Mass Scanning
https://defcon.
the Internet.
org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/
DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf
Presentation at Defcon 22. (Aug. 2014).
[19] John Heidemann, Yuri Pradkin, Ramesh Govindan, Christos Papadopoulos,
Genevieve Bartlett, and Joseph Bannister. 2008. Census and Survey of the Visi-
ble Internet. In Proceedings of the ACM Internet Measurement Conference. ACM,
Vouliagmeni, Greece, 169–182. https://doi.org/10.1145/1452520.1452542
[20] Christian Huitema. 2006. Teredo: Tunneling IPv6 over UDP. RFC4380. (2006).
[21] Gordon Lyon. 1997. nmap. computer software at http://insecure.org/nmap/.
(Sept. 1997). http://insecure.org/nmap/
[22] Johan Mazel, Romain Fontugne, and Kensuke Fukuda. 2014. A Taxonomy of
Anomalies in Backbone Network Traffic. In TRAC’14. IEEE, Nicosia, Cyprus,
30–36. https://doi.org/10.1109/IWCMC.2014.6906328
[23] Johan Mazel, Romain Fontugne, and Kensuke Fukuda. 2017. Profiling Internet
Scanners: Spatiotemporal Structures and Measurement Ethics. In Proceedings of
the IEEE International Conference on Traffic Monitoring and Analysis. IFIP, Dublin,