SMTP and mail typos. Some typosquatters deliberately target
SMTP subdomains (e.g., registering smtpgmail.com to smtp.gmail.
com) and webmail domains (e.g., by registering mailgoogle.com,
targeting mail.google.com). We found 41 SMTP and 366 mail ty-
posquatting domains registered, targeting Alexa’s top 10,000 .com
domains and Alexa’s top 500 .com domains in the email category.
The SMTP typos include domains smtpgmail.com, smtpoutlook.
com and smtplive.com targeting the biggest email providers. This
could plausibly be defensive registrations. However, they are pri-
vately registered, which is inconsistent with trademark protection—
in our experience, defensive registrations usually point at the legit-
imate owner or their agent, not at a private registration service.
6 EXTRAPOLATING FROM OUR
EXPERIMENTS
In this section, we combine the observations gleaned by through
our experiment (Section 4 and our analysis of the typosquatting
ecosystem (Section 5) to attempt to extrapolate our findings on an
admittedly limited set of domains to the whole Internet.
6.1 Toward a projection
We use a seed of 25 of our typosquatting domains targeting 5 email
domains: gmail.com, hotmail.com, outlook.com, comcast.com,
and verizon.com. These domains are highly popular email services,
and using the information from our small foray into typosquatting
might help us best understand the potential magnitude of email
typosquatting in the wild.
Specifically, we attempt to project our results to other typos of
email domains. To do so, we rely on three hypotheses
(H1) Typing mistakes are equiprobable among users of different
email providers.
(H2) Sending an email is a two-step process. Users type in the
email address. Second, users verify the address and poten-
tially correct any mistakes.
(H3) The number of emails sent to a typosquatting domain is pro-
portional to the number of emails sent to the target domains.
Based on these hyotheses, we build a simple model to estimate
the expected number of emails sent to a given typo domain
Eij = Ei · Pti j · (1 − Pci j) ,
where Ei is the expected number of emails (over a fixed time period,
e.g., a year) sent to email addresses in domain i, Eij is the expected
number of emails sent to email addresses in domain j, where the
DL distance between i and j is either zero or one.
427
Pti j is the probability of user typing j instead of i. (This includes
typing the correct domain.) Pci j is the probability of the user cor-
recting the mistake after typing j instead of i.
Directly validating this model is impossible, because Pti j and
Pci j are unknown, and different for different domains, even in the
case of similar typing mistakes. Instead, we build on this simple
model to devise a linear regression model used to predict Eij based
on features characterizing the process of typing mistakes.
First, we use Alexa’s monthly unique visitors to estimate Ei for
email domains (e.g., gmail.com, outlook.com). We assume Ei is
proportional to the number of active users of domain i.4 We add
three features to incorporate Pci j into our model: the visual distance,
the length of the target domain and position of the mistake, and
the fat-finger distance.
One drawback of our approach is that we were not able to register
domains of popular email providers with deletion or transposition
typos. Thus we used Alexa’s data on typosquatting domains of
the 40 most popular target domains, to estimate the difference in
probability between different typing mistakes. We collected Alexa’s
data from October 27, 2016 to October 30, 2016 [1].
Furthermore, we removed typosquatting domains receiving out-
standing traffic among typos of the same target domains, because
those domains are probably not malicious, and just happen to be
accidentally close to the target domain. We used the median of all
absolute deviations from the median (MAD, [26]) to detect such
outliers. We estimate the 95% confidence interval for the mean of
the different typing mistakes to estimate how different their aver-
age traffic is. We will use these results to estimate the number of
emails received by deletion and transposition typo domains.
6.2 Regression results
The five target domains—gmail.com, hotmail.com, outlook.com,
comcast.com and verizon.com—are targeted by 1,211 typosquat-
ting domains (excluding defensive registrations, and our own 25
domains).
We build a linear regression model, by transforming the depen-
dent variable to square root space. We select the following three
features: the target domain’s Alexa rank (log transformed), the
square root of our visual distance heuristic (between the target and
the typo domain) normalized by the length of the original domain
and the fat-finger distance between the target and the typosquat-
ting domain (zero or one). The R2 value of the fit is 0.74. Running a
leave-one-out cross-validation test the R2 value drops to 0.63.
Our model finds that the 1,211 typosquatting domains regis-
tered by others should receive approximately 260,514 emails per
year, with a 95% confidence interval ranging between 22,577 and
905,174 emails per year. Figure 9 shows based on the AWS Alexa
data collected that deletion and transposition typo mistakes are
significantly more frequent than addition and substitution mistakes.
Taking this information into account, our modified regression anal-
ysis yields an expected number of emails received by typosquatters
equal to 846,219 with a 95% confidence interval ranging between
58,460 and 4,039,500.
4This assumption does not hold in the general case, when web popularity may be very
different from email usage; but we assume it is reasonable in the case of the webmail
domains we are looking at.
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
J. Szurdi and N. Christin
7 IN THE SHOES OF A TYPOSQUATTING
VICTIM
We have discussed the potential threat of email typoquatting and
the existing ecosystem that appear to support it. However, are
typosquatters actually doing anything with the emails that they
are able to collect? To answer this question, we run an additional
experiment, in which we now play the role of a potential victim,
and deliberately email known typosquatting domains with “honey
emails.” This experimental protocol, like the collection protocol
earlier described, was vetted and approved by our IRB.
7.1 Experimental design
Honey email design. We designed our honey emails to 1) signal
back to our servers when opened and 2) to include seemingly sen-
sitive information (e.g., login credentials), whose access we can
monitor.
Our emails included a 1x1-pixel tracking image residing on a
VPS we operate. HTML clients might try to download this image
upon opening the email, but this is not always the case. For instance,
depending on its default configuration, the Thunderbird email client
may not automatically download such embedded images. Shortly
stated, presence of a signal indicates that the email has certainly
been opened, but absence of a signal is not proof that the email was
not opened.
Figure 9: The average relative popularity of typosquatting
domains separated by the type of typing mistakes: addition,
deletion, substitution, transposition. We also marked the av-
erage popularity and the 95% confidence interval for each
type of mistake.
Economic implications. Registering a .com domain costs about
about USD 8.5 per year. Using this price in the model above, a
typosquatter owning these domains can acquire an email for less
than two cents. (This computation excludes spam.) From our own
experience, by keeping our five top performing typosquatting do-
mains we could collect “legitimate,” non-spam emails for less then
a penny a piece (excluding marginal costs, such as those of running
a server, and keeping storage).
However, we conjecture that the domains registered by us were
mostly available, because they are less profitable than other ty-
posquatting domains. In other words, we would not be surprised if
our calculations only provided a relatively conservative estimate
on the number of emails typosquatters actually receive when reg-
istering typosquatting domains targeting popular email service
providers.
The very small set of emails we manually analyzed appear to
contain a wide variety of sensitive information that cannot be ex-
ploited by itself, but can aid miscreants to perform targeted attacks.
For instance, six of the 103 emails we analyzed manually appeared
to contain digital receipts, which contain considerable personal
information that could be used for subsequent spearphishing cam-
paigns or other scams; some other emails included information (car
registration, visa documents, resumes, adult side registration, medi-
cal records) that could plausibly be used for identity impersonation,
spear-phishing, or even intimidation.
428
We included sensitive information in the form of honey tokens
and honey accounts. A honey token is a file attachment that signals
back upon being opened. After experimenting with both PDF and
DOCX, we discovered that DOCX readers tend to allow external
access by default more commonly than PDF readers.
Our honey accounts consisted of email accounts at two major
email providers and a shell account on a VPS we control. The word-
ing and headers of each email were designed to mimic real-life
interactions between users. (We piloted these emails with members
of our research group, to confirm they looked plausible, and were
not caught by spam filters.) In total we used four different email
design templates, and we made sure to send one typosquatter regis-
trant one of each email designs exactly once. Further, we only sent
one email to each typosquatting domain.
Our first email design included login information for a major
email service provider. The second design included login informa-
tion for a shell account under our control. The third design included
a link to a tax document shared through a major document sharing
service, where we could monitor accesses. Our final design had a
DOCX attachment with (fake) payment information.
Sending emails. We ran two measurement experiments.
Email probes. The first experiment had for objective to determine
how many typosquatting domains actually accept email – the idea
is that this gives us a rough idea of how many are deliberately set up
as email typosquatting domains, as opposed to web typosquatting
domains that happen to also target email domains. To that effect,
we started with a pilot, in which we sent out a small number of 164
honey emails between May 2, 2017 and May 6, 2017. We selected
a low number of target domains (and a low sending rate) to avoid
alerting typosquatters to our measurements. However, most of our
emails bounced, or resulted in a timeout or network error.
10−210−1.510−110−0.5100100.5101AdditionTranspositionDeletionSubstitutionDamerau Levenshtein typing mistake typesALexa’s relative popularity of typosquatting domainsEmail Typosquatting
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
After this pilot, we ran a larger measurement to test how many
typosquatting domains accepted any of our emails. To that effect,
on May 15, 2017, we sent out 152,985 benign emails to 50,995 ty-
posquatting domains, including domains of registrants owning the
most typosquatting domains, domains linked with a name server
frequently used for typosquatting domains, typos of the three ma-
jor email domains (gmail.com, hotmail.com, outlook.com), and
finally candidate typosquatting domains that use the most popular
WHOIS privacy service.
Each domain selected listens on (some of) the SMTP server ports,
according to Zmap. To verify which one, we sent three emails – one
each to ports 25 (no authentication), 465 (SSL) and 587 (STARTTLS).
The emails in this experiment were designed to look like test
email without any sensitive information in them. Here, we sent
emails from our own virtual private servers. This allowed us to
determine whether emails were actually received and/or read in a
client that retrieves external resources.
Honey tokens. We then conducted a second set of measurements,
in which the goal was to determine if emails were not only received,
but also read and/or acted upon. Here too, the experiment started
with a honey token pilot measurement limited to 738 domains out
of these 50,995 typosquatting domains, to ensure that the infras-
tructure worked as it was supposed to and to run a conservative
measurement unlikely to be detected by miscreants—indeed, most
typosquatters, even those who operate myriad domains, received at
most one email from us. We selected these 738 domains by 1) pur-
posefully limiting ourselves to at most four domains per registrant
we could identify, and 2) selecting these four domains based on
their Alexa rank and the type of typing mistake. We sent out one
honey email containing sensitive information to each of these ty-
posquatting domains on May 15, 2017. All emails in this pilot were
sent through a major email provider to make them less conspicuous
and to avoid spam filters.
Following this pilot, on June 15, 2017, we ran a far more aggres-
sive measurement, in which we sent all four different honey emails
designs to all 7,269 typosquatting domains which had accepted our
emails in the first set of experiments. Here, due to the size of the
test (close to 30,000 emails), we used our own servers, rather than
a major email provider, to send out these emails. During this test,
while we only sent four (different) emails per domain exactly once,
we potentially sent out the same email multiple times to the same
individuals – since some typosquatters own more than one domain.
We logged access attempts to the “honey” shell account until
July 1, 2017; and accesses to the other resources our honey tokens
were pointing to until September 14, 2017.
Table 5: Error message count received when running the ini-
tial test for the honey email experiment.
Number of typo domains
Public reg. Private reg.
6,099
1,160
6,976
6,584
1,522
22,341
1,170
1,567
17,923
7,901
93
28,654
No error
Bounce
Timeout
Network Error
Other error
Total
6,099 of our emails were accepted on domains using WHOIS
privacy proxy services, which overall presented far less errors. 19
of these emails were read based on our logs. We discovered that 6 of
these domains were clear typosquatting domains, 8 were legitimate
domains that just happened to look like typosquatting domains,
and 5 could be either way. Glancing at the time difference between
emails were sent and when emails were opened seems to suggest
that these emails might have been read by humans – rather than by
automated processes – as it frequently took several hours before
the email was opened. Furthermore, some of these emails were
opened several times, sometimes days after they were first opened
Interestingly, some of these domains appear to be targeting po-
tentially sensitive sectors, such as banking (e.g., disvover.com,
bankofamericqa.com), ...), adult sites (e.g., nuaghtyamerica.com),
or email providers (e.g., comcacst.com).
Table 6: Distribution of the mail exchange server usage for
the domains that accepted our emails.
MX domain
b-io.co
h-email.net
mb5p.com
m1bp.com
mb1p.com
hostedmxserver.com
hope-mail.com
m2bp.com
google.com
googlemail.com