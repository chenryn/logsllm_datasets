# 第二部分:网络安全
> 原文：
## 介绍
*   TCP/IP 是当今占主导地位的网络技术。它是一个五层架构。这些层从上到下依次是应用层、传输层(TCP)、网络层(IP)、数据链路层和物理层。除了 TCP/IP，还有其他网络技术。为了方便起见，我们使用 OSI 网络模型来表示非 TCP/IP 网络技术。不同的网络通过网关相互连接。网关可以放在任何一层。
*   OSI 模型是一个七层体系结构。OSI 体系结构类似于 TCP/IP 体系结构，只是 OSI 模型在 TCP/IP 体系结构的应用层和传输层之间指定了两个附加层。这两层是表示层和会话层。图 5.1 显示了 TCP/IP 层和 OSI 层之间的关系。TCP/IP 中的应用层对应于 OSI 中的应用层和表示层。TCP/IP 中的传输层对应于 OSI 中的会话层和传输层。TCP/IP 体系结构中的其余三层与 OSI 模型中的其余三层一一对应。
    TCP/IP 体系结构和 OSI 模型各层之间的对应关系。还示出了网络层中加密算法的布局，其中虚线箭头表示加密算法的实际通信
OSI 各层的功能简述如下:
1.  应用层是应用和网络程序之间的接口。它支持应用和最终用户处理。常见的应用层程序包括远程登录、文件传输、电子邮件和 Web 浏览。
2.  表示层负责处理不同形式的数据。该协议层允许位于具有不同平台的通信信道的不同端的应用层程序理解彼此的数据格式，而不管它们是如何呈现的。
3.  会话层负责创建、管理和关闭通信连接。
4.  传输层负责提供可靠的连接，如数据包排序、流量控制和拥塞控制。
5.  网络层负责将与设备无关的数据包从当前跳路由到下一跳。
6.  数据链路层负责将设备无关的数据包封装到设备相关的数据帧中。它有两个子层:逻辑链路控制和媒体访问控制。
7.  物理层负责通过某些物理介质传输设备相关的帧。
8.  从应用层开始，应用生成的数据逐层传递到物理层。来自前一层的数据被包含在当前层的新信封中，其中来自前一层的数据也只是包含来自前一层的数据的信封。这类似于将一个较小的信封装入一个较大的信封。每层添加的信封包含足够的信息来处理数据包。应用层数据被分成足够小的块，以便在下一层封装在信封中。
9.  根据以下基本步骤，应用数据块在 TCP/IP 体系结构中被“修饰”。在发送端，当应用数据块被向下传递到 TCP 层时，它被封装在 TCP 数据包中。换句话说，TCP 数据包由报头和有效载荷组成，其中报头对应于 TCP 信封，有效载荷是应用数据块。同样，当 TCP 数据包被向下传递到 IP 层时，它将被封装在 IP 数据包中。IP 数据包由报头和有效载荷组成，有效载荷是从 TCP 层向下传递的 TCP 数据包。当 IP 分组被向下传递到数据链路层时，它将被封装在设备相关的帧(例如，以太网帧)中。一帧有一个帧头，也可能有一个帧尾。例如，除了报头之外，以太网帧还有 32 位循环冗余校验(CRC)报尾。当帧被传递到物理层时，它将被转换成一系列媒体信号进行传输
    ![image15](img/241bbeb68439ce365d32a097c35b826d.png)数据包生成流程图
10.  在目的端，媒体信号由物理层转换成帧，然后向上传递到数据链路层。数据链路层将帧有效负载(即封装在帧中的 IP 数据包)向上传递到 IP 层。IP 层将 IP 有效载荷(即封装在 IP 包中的 TCP 包)向上传递到 TCP 层。TCP 层将 TCP 有效负载(即应用数据块)向上传递到应用层。当数据包到达路由器时，它仅向上到达 IP 层，在那里修改 IP 报头中的某些字段(例如，TTL 的值减 1)。然后，这个修改后的分组被逐层向下传递回物理层，以便进一步传输。
### 公钥基础设施
*   为了在网络应用中部署加密算法，我们需要一种使用开放网络分发密钥的方法。公钥加密是分发这些密钥的最佳方式。要使用公钥加密，我们需要构建一个公钥基础设施(PKI)来支持和管理公钥证书和证书颁发机构(CA)网络。特别是，公钥基础设施被设置为执行以下功能:
*   在向用户颁发公钥证书之前，确定用户的合法性。
*   应用户请求颁发公钥证书。
*   根据用户请求延长公钥证书的有效时间。
*   应用户请求或当相应的私钥泄露时，撤销公钥证书。
*   存储和管理公钥证书。
*   防止数字签名者否认他们的签名。
*   支持 CA 网络以允许不同的 CA 对其他 CA 颁发的公钥证书进行身份验证。
*   x . 509:[https://certificatedecoder.dev/?gclid = eaiaiqobchmi 0m 731 o 6g 6 givvsqrch 04 bqaaaeaayaaegkrkpd _ BwE](https://certificatedecoder.dev/?gclid=EAIaIQobChMI0M731O6G6gIVVSQrCh04bQaAEAAYASAAEgKRkPD_BwE)
### IPsec:网络层的安全协议
*   IPsec 是网络层的主要安全协议
*   IPsec 为构建虚拟专用网络(VPN)提供了一个强大的平台。VPN 是覆盖在公共网络上的私有网络。
*   在网络层部署加密算法的目的是加密或验证 IP 数据包(或者只是有效载荷，或者是整个数据包)。
*   IPsec 还规定了如何交换密钥。因此，IPsec 由认证协议、加密协议和密钥交换协议组成。它们分别被称为认证报头(AH)、封装安全负载(ESP)和互联网密钥交换(IKE)。
### PGP & S/MIME:电子邮件安全性
*   应用层有几种安全协议。这些协议中最常用的是电子邮件安全协议，即 PGP 和 S/MIME。
*   SMTP(“简单邮件传输协议”)用于通过端口 25 从客户端向服务器发送和交付:它是发送服务器。相反，POP(“邮局协议”)允许用户接收邮件并下载到他们的收件箱:它是接收服务器。邮局协议的最新版本被命名为 POP3，从 1996 年开始使用；它使用端口 110
电子邮件加密程序
*   PGP 实现了所有主要的加密算法、ZIP 压缩算法和 Base64 编码算法。
*   它可用于验证消息、加密消息或两者兼而有之。PGP 遵循以下一般过程:身份验证、ZIP 压缩、加密和 Base64 编码。
*   Base64 编码过程使邮件准备好进行 SMTP 传输
GPG (GnuPG)
*   GnuPG 是另一个公司可以使用的基于 OpenPGP 的免费加密标准。
*   GnuPG 是赛门铁克 PGP 的替代品。
*   主要区别在于支持的算法。然而，GnuPG 在设计上与 PGP 配合得很好。因为 GnuPG 是开放的，一些企业更喜欢 Symantec 的 PGP 提供的技术支持和用户界面。
*   需要注意的是，GnuPG 和 PGP 的兼容性之间存在一些细微差别，例如某些算法之间的兼容性，但在大多数应用如电子邮件中，都有变通方法。其中一个算法是 IDEA 模块，由于专利问题，它没有包含在 GnuPG 中。
s/哑剧
*   SMTP 只能处理 7 位 ASCII 文本(您可以使用 UTF-8 扩展来缓解这些限制)消息。虽然 POP 可以处理除 7 位 ASCII 之外的其他内容类型，但是在通用默认设置下，POP 可以将存储在邮件服务器中的所有消息下载到用户的本地计算机。之后，如果 POP 从邮件服务器中删除这些邮件。这使得用户很难从多台计算机上阅读他们的消息。
*   多用途 Internet 邮件扩展协议(MIME)旨在支持发送和接收各种格式的电子邮件，包括由文字处理器生成的非文本文件、图形文件、声音文件和视频剪辑。此外，MIME 允许单个消息以这些格式的任意组合包含混合类型的数据。
*   在 TCP 端口 143 上运行的互联网邮件访问协议(IMAP )(仅用于非加密)在邮件服务器中存储(可在服务器和客户端上配置，就像 PoP 一样)传入的电子邮件消息，直到用户有意删除它们。这允许用户从多台机器访问他们的邮箱，并将消息下载到本地机器，而不用从邮件服务器的邮箱中删除它。
SSL/TLS
*   SSL 通过要求服务器使用由可信 CA 签署的安全证书，使用 PKI 来决定服务器的公钥是否可信。
*   当 Netscape Navigator 1.0 发布时，它信任由 RSA 数据安全公司运营的单个 CA。
*   服务器的公共 RSA 密钥过去被存储在安全证书中，然后可以被浏览器用来建立安全的通信通道。我们今天使用的安全证书仍然依赖于 Netscape Navigator 1.0 当时使用的同一标准(名为 X.509)。
*   Netscape 打算训练用户(尽管后来没有成功)区分安全通信和不安全通信，所以他们在地址栏旁边放了一个锁图标。当锁打开时，通信是不安全的。关闭的锁意味着通信已经通过 SSL 得到了保护，这需要服务器提供一个签名的证书。很明显，你对这个图标很熟悉，因为从那以后它就出现在每个浏览器中。网景公司的工程师们真正创造了安全互联网通信的标准。
*   在发布 SSL 2.0 一年后，Netscape 修复了几个安全问题，并发布了 SSL 3.0，这是一个协议，尽管自 2015 年 6 月以来被正式否决，但在推出 20 多年后，仍在世界上的某些地区使用。为了使 SSL 标准化，因特网工程任务组(IETF)创建了一个稍加修改的 SSL 3.0，并在 1999 年将其公布为传输层安全(TLS) 1.0。SSL 和 TLS 之间的名称变化至今仍在困扰着人们。从官方角度来说，TLS 是新的 SSL，但实际上，人们可以互换使用 SSL 和 TLS 来谈论任何版本的协议。
*   必看:
*   [https://tls.ulfheim.net/](https://tls.ulfheim.net/)
*   [https://davidwong.fr/tls13/](https://davidwong.fr/tls13/)
## 网络边界安全
让我们看看如何检查周边，即边缘，这是第一层保护
### 通用防火墙框架
*   需要防火墙，因为加密算法不能有效地阻止恶意数据包进入边缘网络。
*   这是因为无论 IP 数据包是否加密，它们总是可以被转发到边缘网络。
*   20 世纪 90 年代开发的防火墙是帮助限制网络访问的重要工具。防火墙可以是硬件设备、软件包或两者的组合。
*   从外部流入内部网络的数据包应该在被允许进入之前进行评估。防火墙的一个关键要素是它能够在不影响通信速度的情况下检查数据包，同时为内部网络提供安全保护。
*   防火墙执行的数据包检查可以使用几种不同的方法来完成。根据防火墙使用的特定方法，它可以被描述为包过滤、电路网关、应用网关或动态包过滤。
### 数据包过滤器
*   它检查从外部进入内部网络的入站数据包，并检查从内部网络出去的出站数据包
*   打包过滤只检查 IP 报头和 TCP 报头，而不检查在应用层生成的有效负载
*   包过滤防火墙使用一组规则来确定是允许还是拒绝数据包通过。
*   两种类型:
*   无国籍的
    *   它将每个数据包视为一个独立的对象，并且不跟踪任何以前处理过的数据包。换句话说，无状态过滤会在数据包到达时对其进行检查，并在不留下任何被检查数据包记录的情况下做出决定。
*   宏伟威严的
    *   状态过滤，也称为连接状态过滤，跟踪内部主机和外部主机之间的连接。连接状态(或简称状态)表示是 TCP 连接还是 UDP 连接，以及连接是否建立。
### 电路网关
*   电路网关也称为电路级网关，通常在传输层运行
*   它们评估 TCP(或 UDP)报头中包含的 IP 地址和端口号信息，并使用这些信息来确定是否允许内部主机和外部主机建立连接。
*   通常的做法是将包过滤和电路网关结合起来形成动态包过滤(DPF)。
### 应用网关(ALG)
*   又名代理服务器
*   应用层网关(ALG)充当内部主机的代理，处理来自外部客户端的服务请求。
*   ALG 对每个 IP 数据包(入口或出口)执行深度检查。
*   特别地，ALG 检查包含在分组中的应用格式(例如，MIME 格式或 SQL 格式),并检查其有效载荷是否被允许。
*   因此，ALG 能够检测有效载荷中包含的计算机病毒。由于 ALG 会检查数据包的有效负载，因此除了阻止带有可疑 IP 地址和 TCP 端口的数据包之外，它还能够检测恶意代码并隔离可疑数据包。另一方面，ALG 也会导致大量的计算和空间开销。
### 可信系统和堡垒主机