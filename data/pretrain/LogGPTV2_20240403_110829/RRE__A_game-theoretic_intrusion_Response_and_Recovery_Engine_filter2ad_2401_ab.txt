440
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
ers,andtheglobalengine,whichresidesintheresponseandrecoveryserveranddecidesonglobalresponseactionsoncethesystemisnotrecoverablebythelocalengines.Fur-thermore,thehierarchicalarchitectureimprovesscalability,easeofdesign,andperformanceofRRE,sothatitcanpro-tectcomputingassetsagainstattackersinlarge-scalecom-puternetworks.ThecontributionsofRREareasfollows.First,RREaccountsforplannedadversarialbehaviorinwhichattacksoccurinstagesinwhichadversariesexecutewell-plannedstrategiesandaddressdefensemeasurestakenbysystemadministratorsalongtheway.Itdoessobyapplyinggametheoryandseekingresponsesthatoptimizeonlong-termgains.Second,RREconcurrentlyaccountsforinherentun-certaintiesinIDSalertnotiﬁcationswithattack-responsetreesconvertedtopartiallyobservableMarkovdecisionpro-cessesthatcomputeoptimalresponsesdespitetheseun-certainties.ThisisimportantbecauseIDSestodayandinthenearfuturewillbeunabletogeneratealertsthatmatchperfectlytosuccessfulintrusions,andresponsetechniquesmustthereforeallowforthisimperfectioninordertobepractical.RREachievestheabovetwogoalswithauni-ﬁedmodelingapproachinwhichgametheoryandMarkovdecisionprocessesarecombined.WedemonstratethatRREiscomputationallyefﬁcientforrelativelylargenetworksviaprototypingandexperimentation,anddemonstratethatitispracticalbystudyingcommonlyfoundcriticalinfrastruc-turenetworksassociatedwiththepowergrid.However,webelievethatRREhaswideapplicabilitytoallkindsofnet-works.2.ProblemFormulationWeformulatetheoptimalresponseselectionprob-leminIRSesasadecision-makingfunctionfIRS:(W,O,M,G)→Mwiththefollowingdeﬁnitions:W:asetofthecomputingassetsw∈W,e.g.,aSQLserver,thataretobeprotectedbytheresponseengine.O:asetofIDSalertso∈Othatspeciﬁcallyindicateanadversarialattempttoexploittheexistingspeciﬁcvulner-abilitiesoftheassets,e.g.,alertsfromSnort[22]warningaboutapackettransferringtheSlammerwormthatexploitsabufferoverﬂowvulnerabilityinaSQLserver.M:asetofallpossibleresponseactionsm∈M,in-cludingNo-OPeration(NOP),fromwhichtheintrusionre-sponseenginepicksresponseactions.Forexample,anin-trusionresponsesystemcanrespondtoSQL’sbufferover-ﬂowexploitationbyclosingitsTCPconnection.G:asetofARTgraphsg∈Gthatsystematicallyde-ﬁnehowintrusive(responsive)scenariosabouttheattacker(responseengine)affectsystemsecurity(see§4.1).Therestofthepaperisdevotedtoasolutiontothere-sponseselectionfunction,i.e.,fIRS=RRE;inotherwords,wewillfocusonhowtheRREﬁndstheoptimalre-sponseactionbasedongiveninputarguments.3.RRE’sHigh-levelArchitectureBeforegivingtheoreticaldesignandimplementationde-tails,weprovideahigh-levelarchitectureofRRE,asillus-tratedinFig.1.Ithastwotypesofdecision-makingenginesFigure1.High-levelarchitectureoftheRREattwodifferentlayers,i.e.,localandglobal.Thishierarchi-calstructureofRRE’sarchitecture(discussedlater)makesitcapableofhandlingveryfrequentIDSalerts,andchoos-ingoptimalresponseactions.Moreover,thetwo-layerar-chitectureimprovesitsscalabilityforlarge-scalecomputernetworks,inwhichRREissupposedtoprotectalargenum-berofhostcomputersagainstmaliciousattackers.Finally,separationofhigh-andlow-levelsecurityissuessigniﬁ-cantlysimpliﬁestheaccuratedesignofresponseengines.Astheﬁrstlayer,RRE’slocalenginesaredistributedinhostcomputers.TheirmaininputsconsistofIDSalertsandattack-responsetrees(describedin§4.1).AllIDSalertsaresenttoandstoredinthealertdatabase(Fig.1)towhicheachlocalenginesubscribestogetnotiﬁedwhenanyofthealertsrelatedtoitshostcomputerisreceived.Usingthementionedlocalinformation,localenginescomputelocalresponseactionsandsendthemtoRREagentsthatareinchargeofenforcingreceivedcommandsandreportingbacktheaccomplishmentstatus,i.e.,whetherthecommandwassuccessfullycarriedout.Theinternalarchitectureofen-ginesincludestwomajorcomponents:thestatespacegen-eratorandthedecisionengine.Onceinputshavebeenre-ceived,allpossiblecybersecuritystatesinwhichthehostcomputercouldbearegenerated.Asdiscussedlaterin§7,thestatespacemightbeintractablylarge;therefore,RREpartiallygeneratesthestatespacesothatthedecision-makingunitcanquicklydecideontheoptimalresponseac-tion.Thedecision-makingunitemploysagame-theoreticalgorithmthatmodelsattacker-RREinteractionasatwo-playergameinwhicheachplayertriestomaximizehisorheroverallbeneﬁt.Thisimpliesthat,onceasystemisunderattack,immediategreedyresponsedecisionsarenotneces-sarilythebestchoices,sincetheymaynotguaranteetheminimumtotalaccumulativecostinvolvedincompletere-coveryfromtheattack.Althoughindividuallocalenginesattempttoprotecttheircorrespondinghostcomputers,globalnetwork-level978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
441
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
responseactionsrequireinputsfrommultiplehostcom-puters.Furthermore,individuallocalenginesmaybecomemaliciousthemselvesiftheygetcompromised.Todealwiththeseproblems,RRE’sglobalengine,asitssecondlayer,getshigh-levelinformationfromallhostcomputersinthenetwork,decidesonoptimalglobalresponseactionstotake,andcoordinatesRREagentstoaccomplishtheac-tionsbysendingthemrelevantresponsecommands.Inad-ditiontolocalsecurityestimatesfromhostcomputers,net-worktopologyisalsofedintotheglobalengineintheformofanARTgraph,whichshows1)whatcombinationsofcompromisedhostcomputerswillchangethesecuritysta-tusofthewholenetwork,and2)whatglobalresponseac-tionsareavailabletoterminateattacks.TheARTs,intheglobalengine,dependonthenetwork’stopology;therefore,theyshouldbespeciﬁcallydesignedbyexpertsforeachnet-work.Incontrast,theARTsforlocalassets,oncedesigned,aresimplyre-used.Iftheglobalengineiscompromised,theabilitytoexe-cuteglobal-levelresponseactionsisaffected;however,thelocalenginesarenotaffected.Furthermore,globalenginescanbeprotectedbyemployingadequatesecuritymeasures,andiffeasible,intrusiontolerantapproaches.4.LocalResponseandRecoveryHavinggivenahigh-leveloverviewofhowhierarchi-callystructuredcomponentsinRREinteractwitheachother,wenowpresentthetheoreticaldesignofthesecom-ponentsindetail.Startingwiththelowest-levelmodulesinRRE,weexplainhowlocalengines,residinginhostcom-puters,protectlocalcomputingassetsusingsecurity-relatedinformation,i.e.,IDSalerts,aboutthem.4.1.Attack-ResponseTreeToprotectalocalcomputingasset,itscorrespondinglo-calengineﬁrsttriestoﬁgureoutwhatsecuritypropertiesoftheassethavebeenattacked,givenareceivedsetofalerts.Attacktrees[23]offeraconvenientwaytosystematicallycategorizethedifferentwaysinwhichanassetcanbeat-tacked.Localenginesmakeuseofanewextendedattacktreestructure,calledanattack-responsetree(ART),thatmakesitpossible1)toincorporatepossiblecountermeasure(response)actionsagainstattacks,and2)toconsiderintru-siondetectionuncertaintiesduetofalsepositivesandneg-ativesindetectingsuccessfulintrusions,whileestimatingthecurrentsecuritystateofthesystem.Theattack-responsetreesaredesignedofﬂinebyexpertsoneachcomputingas-set,e.g.,aSQLserver,residinginahostcomputer.Itisimportanttonotethat,unliketheattacktreethatisdesignedaccordingtoallpossibleattackscenarios,theARTmodelisbuiltbasedontheattackconsequences,e.g.,aSQLcrash;thusthedesignerdoesnothavetoconsiderallpossibleat-tackscenariosthatmightcausethoseconsequences.Thepurposeofanattack-responsetreegw∈Gforanassetw∈W,e.g.,aSQLserver,istodeﬁneandanalyzepossiblecombinationsofattackconsequencesthatleadtoviolationofsomesecuritypropertyoftheasset.Thisse-curityproperty,e.g.,integrity,isassignedtotherootnodeofthetree,whichisalsocalledthetop-eventnode.InthecurrentimplementationofRRE’slocalengines,thereFigure2.NodedecompositioninARTareatmostthreeARTsGw={gcw,giw,gaw}foreachassetw,whicharetypicallyconcernedwithconﬁdentiality,in-tegrity,andavailabilityofassets;Gw⊂Gcanbeexpandedtoincludeothersecurityproperties.Anattack-responsetree’sstructureisexpressedinthenodehierarchy,allow-ingonetodecomposeanabstractattackgoal(consequence)intoanumberofmoreconcreteconsequencescalledsub-consequences.Anodedecompositionschemecouldbebasedoneither1)anANDgate,whereallofthesub-consequencesmusthappenfortheabstractconsequencetotakeplace,or2)anORgate,whereoccurrenceofanyoneofthesub-consequenceswillresultintheabstractconse-quence.Foragate,theunderlyingsub-consequence(s)andtheresultingabstractconsequencearecalledinput(s)andoutput,respectively.Beingatthelowestlevelofabstractionintheattack-responsetreestructure,everyleafnodeconse-quencel∈Lismappedto(reportedby)itsrelatedsubsetofIDSalertsOl⊆O,eachofwhichrepresentsaspeciﬁcvulnerabilityexploitationattemptbytheattacker.SomeoftheconsequencenodesinanARTaretaggedbyresponseboxesthatrepresentcountermeasure(response)actionsm∈Magainsttheconsequencestowhichtheyareconnected(In§4.3,wedescribehowtheseboxesareconvertedtoresponsetransitions,andusedtodecideuponoptimalactions).Table1illustratesdifferentclassesofre-sponseactionsthatmightbeapplicabletoaconsequence,dependingonthetypeofconsequenceandtheinvolvedas-sets.Fig.2illustrateshowasampleabstractconsequencenode(output),i.e.,anunavailablewebservice,isdecom-posedintotwosub-consequences(inputs)usinganORgate(i.e.,thewebservicebecomesunavailableifeitherthewebserveriscompromisedorthedomainnameserveriscor-rupted).Furthermore,ifawebserviceisunavailableduetothecompromisedwebserver,theresponseenginecanswitchtothesecondarywebserver.ForeveryART,amajorgoalistoprobabilisticallyver-ifywhetherthesecuritypropertyregardingART’srootnodehasbeenviolated,giventhesequenceof1)there-ceivedalerts,and2)thesuccessfullytakenresponseac-tions.Booleanvaluesareassignedtoallnodesintheattack-responsetree.Eachleafnodeconsequencel∈Lisinitially0,andissetto1onceanyalertolfromitscorrespondingalertsetOl⊆O(deﬁnedearlier)isreceivedfromtheIDS.Thesevaluesforotherconsequencenodes,includingtherootnode,aresimplydeterminedbottom-upaccordingtoleafnodes’valuesinthesubtreewhoserootistheconse-quencenodeunderconsideration.Responseboxesaretrig-geredoncetheyaresuccessfullytakenbytheresponseen-gine;asaresult,allnodesintheirsubtreeareresettozero,andthecorrespondingreceivedalertsarecleared.Asacase978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
442
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
Table1.ResponseandRecoveryActionClassiﬁcation[1]ActionclassDescriptionExamplesRollbackbringthecomponentbacktoasavedsecurestatefreeze/restoreSWRollforwardﬁndanewstate,fromwhichthecomponentcanoperatejournal/restore/updateprocessIsolationperformphysical/logicalexclusionofthefaultycomponentsblockattacker’sIPReconﬁgurationswitchinsparecomponentorreassigntaskstoothersswitchto2ndApacheserverReinitializationcheck/recordnewconﬁgurationandupdatesystemtablesrestartaTCPconnectioninpoint,iftheresponseboxthatisconnectedtoART’srootnodeistriggered,allnodesintheARTareresettozero.Dealingwithuncertainties.Inreality,determinationofBooleanvaluesoftheleafnodeconsequencesinARTismorecomplicated,duetotheuncertaintyaboutwhether1)thereceivedalertsactuallyrepresentsomeconsequenceoc-currence,and2)noconsequencehashappenedifnoalerthasbeenreceived.Takingsuchuncertaintiesintoaccount,RREmakesuseofanaiveBayesbinaryclassiﬁer,similartoeBayes[27],thatusesBernoulivariables,i.e.,alerts,todeterminethevalueofeachleafconsequencenodel,giventhesetofitsrelatedreceivedalertsOrl⊆Ol:δ(l|Orl)=P(l).Πol∈OrlP(ol|l)P(l).Πol∈OrlP(ol|l)+P(¯l).Πol∈OrlP(ol|¯l)(1)whereP(l),theso-calledclassprior,istheprobabilityofconsequencel’soccurrence,andP(¯l)issimplyitscom-plement,i.e.,P(¯l)=1−P(l).Furthermore,P(ol|l)denotestheprobabilitythatalertolwasalreadyreceived,giventhatconsequencelhasactuallyhappened.Theseprobabilitymeasuresarecalculatedbasedonhistoricalin-formationaboutthesystem.Onepossibletechniquetoob-tainthosemeasuresisperiodicalertveriﬁcation[14],whichisanautomaticormanual,possiblytime-consuming,pro-cesstoperiodicallycheckwhethertheattackconsequencelhasoccurredusingthevisibleandcheckabletracesthatacertainattackleavesatahostoronthenetwork,e.g.,atemporaryﬁleoranoutgoingnetworkconnection.Conse-quently,P(l)iscalculatedasaproportionofthepastperi-odicchecksthatveriﬁedtheoccurrenceofconsequencel,andusingBayes’theorem:P(ol|l)=P(ol,l)P(l)(2)whereP(ol,l)denotesthefractionofchecksthatveriﬁedthatconsequencelhadoccurred,andalertolhadbeenre-ceived.Givensatisfactionprobabilitiesofleafnodes,theoutputprobabilityofgateqwithinputsIissimplycalculatedasfollows:δ(q)=(cid:2)Πi∈Iδ(i)ifqisanANDgate,1−Πi∈I(1−δ(i))otherwise(3)wherethereisanimplicitassumptionthatgateinputsareindependent;otherwise,δqiscomputedusingjointproba-bilitydistributionsofinputs.Startingfromtherootnodeandrecursivelyusing(3),itissimpletoobtainδg,i.e.,theprobabilitythatthesecuritypropertyoftherootnodeinARTgraphghasbeencompromised.Thisvalue,asalo-calsecurityestimate,isreportedbythelocalenginetotheRREserver,whereoptimalglobalresponseactionsarede-cideduponaccordingtoreceivedlocalestimates(see§5).Next,wewillexplainhowARTsandtheirnodes’satisfac-tionprobabilitiesareusedinagame-theoreticalgorithmtodecideontheoptimalresponseaction.4.2.StackelbergGame:RREvs.AttackerReciprocalinteractionbetweentheadversaryandre-sponseengineinacomputersystemisreallyagameinwhicheachplayertriestomaximizehisorherownbene-ﬁt.TheresponseselectionprocessinRREismodeledasasequentialStackelbergstochasticgame[19]inwhichRREactsastheleaderwhiletheattackeristhefollower;how-ever,inourinﬁnite-horizongamemodel,theirrolesmaychangewithoutaffectingtheﬁnalsolutiontotheproblem.Speciﬁcally,thegameisaﬁnitesetofsecuritystatesSthatcoverallpossiblesecurityconditionsthatthesystemcouldbein.Thesystemisinoneofthesecuritystatessateachtimeinstant.RRE,theleader,choosesandtakesaresponseactionms∈Madmissibleins,whichleadstoaprobabilisticsecuritystatetransitiontos(cid:3).Theat-tacker,whichisthefollower,observestheactionselectedbytheleader,andthenchoosesandtakesanadversaryactionos(cid:2)∈Oadmissibleins(cid:3),resultinginaprobabilisticstatetransitiontos(cid:3)(cid:3).Ateachtransitionstage,playersmayre-ceivesomerewardaccordingtoarewardfunctionforeachplayer.TherewardfunctionforanattackerisusuallynotknowntoRRE,becauseanattacker’srewarddependsonhisﬁnalmaliciousgoal,whichisalsonotknown;there-fore,assumingthattheattackertakestheworstpossiblead-versaryaction,RREchoosesitsresponseactionsbasedonthesecuritystrategy,i.e.,maximin,asdiscussedlater.ItisalsoimportanttonoteherethatalthoughSisaﬁniteset,itispossibleforthegametorevertbacktosomepreviousstate;therefore,theRRE-adversarygamecantheoreticallycontinueforever.Thisstochasticgameisessentiallyanan-tagonisticmulticontrollerMarkovdecisionprocess,calledacompetitiveMarkovdecisionprocess(CMDP)[8].AdiscretecompetitiveMarkoviandecisionprocessΓisdeﬁnedasatuple(S,A,r,P,γ)whereSisthesecuritystatespace,assumedtobeanarbitrarynon-emptyseten-dowedwiththediscretetopology.Aisametricspacestand-ingfortheactionorcontrolset,whichitselfispartitionedintoresponseactionsandadversaryactionsdependingontheplayer.Foreverys∈S,A(s)⊂Aisthesetofadmissi-bleactionsatstates.Themeasurablefunctionr:K→(cid:6)istherewardwhereK:={(s,a,s(cid:3))|a∈A(s);s,s(cid:3)∈S},andPisthetransitionlaw;thatis,ifthepresentstateofthesystemiss∈Sandanactiona∈A(s)istaken,resultinginstatetransitiontostates(cid:3)withprobabilityP(s(cid:3)|s,a),animmediaterewardr(s,a,s(cid:3))isobtainedbytheplayertak-ingtheaction.γisthediscountfactor,i.e.,0<γ<1.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE