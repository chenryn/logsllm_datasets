traceroute methods. CAIDA’s topology mapping project,
DIMES, and iPlane all derive destination lists from adver-
tised BGP preﬁxes.
This list is actually composed of several diﬀerent lists.
We generated a diﬀerent set of destinations for each vantage
point consistently, using the following procedure. We ﬁrst
derived a set of BGP preﬁxes by merging daily snapshots
of ‘sh ip bgp’ on RouteViews [16] from 19-25 March 2008.
We chose the median ﬁle size snapshot each day to avoid
truncated or otherwise non-representative tables. We then
extracted IP preﬁxes from this set using straightenRV [19].
In prior experience we have found that preﬁxes that ap-
pear in only one or two snapshots tend to be anomalous in
some way, such as being unreachable most of the time, so
we selected preﬁxes that appear in at least three snapshots.
Of the initial set of 257,504 base preﬁxes, 255,981 (99.4%)
appear in at least three snapshots, and represent the equiv-
alent of 110.3 /8’s. 251,452 preﬁxes (97.6%) appear in all
seven snapshots.
We then divided this list of 255,981 preﬁxes into two sets.
The ﬁrst set, roots.le16 , consists of all root preﬁxes (preﬁxes
not enclosed in any other preﬁx) with a preﬁx length of 16 or
shorter. This set contains 10.0k preﬁxes covering 89.8 /8’s.
The second set, prefs.gt16.le24 , consists of the remaining
preﬁxes, those of length greater than 16 and less than or
equal to 24. This set represents 240.6k preﬁxes covering
29.9 /8’s. Note that these two sets of preﬁxes intentionally
overlap in their coverage of the address space.
Finally, we created a custom destination list for each van-
tage point using the following procedure:
(cid:129) select one random address in each /16 covered by the
set roots.le16 ,
(cid:129) select one random address in each preﬁx of the set
prefs.gt16.le24 ,
(cid:129) never select more than one destination in any /24,
(cid:129) exclude addresses in bogon preﬁxes [20],
(cid:129) exclude addresses in CAIDA’s do-not-probe list.
CAIDA’s do-not-probe list consists of 975 preﬁxes covering
the equivalent of 1.14 /8’s, largely due to a single /8 on the
list. This procedure selects as many destinations in a /16 as
there are more speciﬁc preﬁxes for that /16, but never more
than one destination per /24. This constraint may allow
any possible divergent routing introduced by the more spe-
ciﬁc preﬁxes to be captured. This procedure yields 261,530
addresses for each vantage point, with minimal overlap in
addresses between vantage points.
2.4.2 Alexa top 500 websites
The second address list is composed of the top 500 web-
sites as reported by Alexa. We chose this address list for
three reasons: (1) the targets are destination hosts reachable
on TCP port 80, and as popular web servers they probably
receive traceroute traﬃc as users troubleshoot connectivity
problems; (2) the targets are likely to have a ﬁrewall in front
of them, which allows us to compare which probing methods
are more likely to reach the destination, and possibly infer
the approximate location of the ﬁrewall; (3) the Alexa list
is studied in other work [15, 21].
The actual number of IP addresses included in the web-
site list is 422, as some websites in the top 500 have IP
addresses in common with other websites. For example,
several top 500 websites hosted by Akamai resolve to the
same IP addresses. Similarly, some nationalised instances of
Google (e.g., google.co.nz, google.co.uk) and Ebay share
the same sets of IP addresses, and we include them only
once.
Many of these websites have multiple A records (IP ad-
dresses) returned in a single DNS response. In these cases,
we add to the address list a random address from the re-
turned list not previously included. For these reasons, we
Table 4: Median rate of traceroute method halt rea-
son per technique. ICMP-Paris reaches 80% more
destinations than UDP-Paris.
Reached
ICMP-Paris
TCP
UDP-Paris
9.3%
8.5%
5.3%
ICMP-
Unreach
12.7%
11.7%
11.2%
Loop
GapLimit
6.7%
6.3%
6.4%
71.5%
73.7%
77.2%
probe all four addresses returned from an A query to the 58
nationalised instances of Google ranked by Alexa in the top
500 websites. The IP addresses returned by DNS for popu-
lar websites can diﬀer depending on the vantage point. We
did all DNS lookups from the same network as the host from
which we subsequently performed traceroute measurements.
Because we probed this list from a single host, the vantage-
point dependency of DNS mappings should not aﬀect our
conclusions.
2.4.3 Router list
Finally, we probe an address list composed of 2000 ran-
dom router IP addresses previously discovered with trace-
route. We chose this list because the targets are known to
be routers that have recently responded with an ICMP time
exceeded message, and should therefore be reachable. The
objective of probing this list is to determine if any particu-
lar traceroute probe method is likely to be more useful when
probing destinations that are routers.
3. RESULTS
3.1 Random routable probing results
3.1.1 Overall results
Figure 1 shows the distribution of traceroute halt reasons
for all methods per vantage point for the random routable IP
address list. The vantage points cbg-uk and nrt-jp used all
six probing methods, while the other six vantage points used
three probing methods: UDP-Paris, ICMP-Paris, and TCP
traceroute. These six vantage points used a reduced set of
methods due to the limited additional utility of the other
methods; UDP-Paris DNS reached few additional destina-
tions compared to UDP-Paris, and the traditional UDP and
ICMP methods are known to infer false loops at a greater
rate due to not maintaining a constant ﬂow identiﬁer be-
tween probes [6]. The data collection was staggered between
Aug 6th and 16th 2008; the collection for the six vantage
points that used three probing methods completed in ap-
proximately two and a quarter days; the collection for the
two vantage points that used six methods completed in ap-
proximately twice as much time. Table 4 shows the median
rate of halt reason for the three methods which were used
on all eight vantage points.
We now examine the results for each halt reason, start-
ing with the lowest bars in Figure 1 and working up. The
lowest bars, reached, indicate the percentage of traces where
the destination was considered reached according to the def-
inition in Section 2.2.1. The rate of reachability is between
9.0% and 9.4% with the ICMP-Paris method, between 8.2%
and 8.7% with the TCP method, and between 5.1% and
5.4% with the UDP-Paris method – depending on the van-
tage point. The reachability statistics for each method vary
an average of 0.4% across vantage points; an earlier data col-
lection varied less than 0.1% when it was collected across all
vantage points simultaneously, so we believe that the varia-
tion in reachability in this scenario is caused by the variation
in when the data was collected.
The second lowest bars, ICMP-unreach, report the per-
centage of traces whose halt reason was an ICMP destination
unreachable message with a source address not matching the
destination address probed. The median percentage across
vantage points for this halt reason was 12.7% for ICMP-
Paris, 11.7% for TCP, and 11.2% for UDP-Paris. Notably,
the rank order of methods for both the reached and ICMP-
unreachable cases are the same, indicating that ﬁrewalls are
less likely to silently discard ICMP probes than they are
UDP probes, rendering ICMP-Paris a more productive prob-
ing method than UDP-Paris for random destinations.
The next set of bars, loop, indicate the percentage of traces
that halted because an IP address appeared for the second
time in the same trace and was not a case of zero-ttl for-
warding [6]. This halt reason varied more per vantage point
than per probe method, consistent with the fact that loops
are routing issues independent of probe method. The me-
dian rate of observed loops was 6.7% for ICMP-Paris, 6.4%
for UDP-Paris, and 6.3% for TCP.
Finally, the top bars, gaplimit, indicate the percentage of
traces that probed ﬁve consecutive hops and obtained no
responses for any. By far the most common halt reason
for all methods, this unreachability is unsurprising given a
random destination list, since it is well-established that most
IP addresses do not respond to direct probes [22]. As a
result of ICMP-Paris more eﬀectively reaching destinations
or triggering ICMP destination unreachable messages, the
percentage of destinations that result in such unproductive
probing is 2.2% more for TCP and 5.7% more for UDP-Paris.
Two of our vantage points, cbg-uk and nrt-jp, used three
further probe methods; traditional ICMP, traditional UDP,
and UDP-Paris DNS. UDP-Paris DNS is only slightly more
eﬀective than UDP-Paris; from a list of 261,530 addresses,
it reaches 311 more destinations from cbg-uk and 356 more
from nrt-jp. This negligible diﬀerence surprised us; we had
believed that many more operators would conﬁgure their
ﬁrewalls to allow packets with a source port of 53 through
without requiring an initial matching request, which would
have allowed UDP-Paris DNS through while blocking UDP-
Paris, but this data does not support our initial hypothesis.
We note that it could be possible that ﬁrewalls are conﬁg-
ured to drop probes to the traditional traceroute port range
while permitting other packets with a source port value of
53.
Our other two probe methods were the traditional UDP
and ICMP techniques which do not send probes with a con-
stant ﬂow identiﬁer as Paris traceroute does [6]. Table 5
shows the halt diﬀerences between a traditional traceroute
technique and the Paris variation for vantage points cbg-uk
and nrt-jp. Our results show that the UDP technique derives
a greater reduction than ICMP in the number of loops de-
tected, perhaps due to fewer routers that load balance ICMP
packets per ﬂow [15]. The UDP technique also achieves the
greatest percentage increase in reached destinations com-
pared to non-Paris probing. However, approximately 80%
of the paths that inferred a false loop in the traditional case
Figure 1: Traceroute method halt reasons for random routable IP address list. 9.3% of destinations were
reached with ICMP-Paris, 8.5% with TCP, and 5.3% with UDP-Paris. (u=UDP, up=UDP-Paris, upd=UDP-
Paris DNS, i=ICMP, ip=ICMP-Paris, t=TCP)
Table 5: Halt reason diﬀerences between Paris and
traditional traceroute methods. There are signif-
icantly fewer loops inferred with Paris traceroute,
though only a small increase in the number of des-
tinations reached. Percentages give the relative in-
crease/decrease in the number of traces with a given
stop reason.
cbg-uk
Reached
ICMP-Unreach
Loop
GapLimit
nrt-jp
Reached
ICMP-Unreach
Loop
GapLimit
UDP-Paris
vs. UDP
ICMP-Paris
vs. ICMP
(+2.1%)
(+1.3%)
+274
+376
+383
+265
−4563 (−22.4%) −3019
(+2.0%) +2378
+3906
(+1.6%)
(+0.8%)
(−15.5%)
(+1.3%)
(+2.2%)
(+1.9%)
+308
+460
+553
+391
−5463 (−24.7%) −2775
(+2.3%) +1924
+4602
(+1.9%)
(+1.2%)
(−13.7%)
(+1.0%)
now halt in the Paris case due to the gaplimit condition
being met.
3.1.2 Reachability
We next consider aspects of destination reachability for
UDP-Paris, ICMP-Paris, and TCP. We consider these the
canonical traceroute methods; their variations do not reach
signiﬁcantly more destinations. Figure 2 shows reachabil-
ity intersection statistics across each method for all van-
tage points. The destination reachability statistics are sim-
ilar for all probe sources, so we choose cbg-uk for detailed
analysis. In total, 31439 destinations were reachable from
cbg-uk by at least one of the three methods, while 32.5%
UDP−Paris only
UDP−Paris n TCP
TCP only
TCP n ICMP−Paris
ICMP−Paris only
ICMP−Paris n UDP−Paris
by all methods
k
u
−
g
b
c
p
j
−
t
r
n
u
a
−
d
y
s
s
e
−
n
c
b
i
f
−
l
e
h
r
k
−
j
j
c
s
u
−
d
a
i
s
u
−
n
a
s
 30
 25
 20
 15
 10
 5
 0
s
n
o
i
t
a
n
i
t
s
e
d
)
s
d
n
a
s
u
o
h
t
(
f
o
r
e
b
m
u
n
Figure 2: Uniqueness of reached destinations by
combinations of methods for the random routable
address list. Focusing on cbg-uk the total coverage
for individual methods is ICMP-Paris 75.2%, TCP
68.6%, and UDP-Paris 42.7%.
of these were reachable by all methods. The ICMP-Paris
technique reached 75.2% of these destinations. Using both
TCP and ICMP-Paris methods, 97.7% of the destinations
were reached. Put another way, of the 31439 destinations
reached only 2.3% were reachable solely with the UDP-Paris
method. If a goal of Internet topology discovery is to max-
imise discovery at the edges of the Internet, UDP-Paris is
not a good probe method to use compared with the other
methods evaluated.
As described in Section 2.2.1, there is more than one way
to deﬁne a destination as being reached when using trace-
Table 6: Replies classed as reaching a destination
from cbg-uk. At least 95% of the replies from a
destination were of the expected type (shown with
an asterisk).
UDP-Paris
TCP port
Reached
Expected type
Prohib ﬁlter
Prohib host
Unknown host
Unreach net
Unreach host
Unreach proto
Unreach port
Echo reply
Syn-ack
Rst-ack
Rst
Other TCP
13411
(5.1%)
96.0%
156
163
0
8
208
1
12875*
–
–