数据绑定技术 
在大多数设计框架(JSP/Structs，Spring)中看到的另一个流行特性是数据绑定，其中
HTTP GET 请求参数或 HTTP POST 变量直接绑定到相应业务/命令对象的变量。这里的绑
定意味着这种类的实例变量根据它们的名称自动用请求参数值初始化。考虑下面给出的示例
设计。注意业务逻辑类绑定了业务对象类，业务对象类绑定了请求参数。 
这种设计的缺陷是业务对象可能有不依赖于请求参数的变量。这些变量可能是关键变量，
如价格、最高限价、角色等。具有静态值或者依赖于某些服务器端处理逻辑。这种情况下的
一个威胁是，攻击者可能会在请求中提供额外的参数，并试图绑定业务对象类的未公开变量
的值。 
安全设计建议: 
120 
⚫ 
这里需要注意的一点是，业务/表单/命令对象必须只有这些依赖于用户输入的实例变量。 
⚫ 
如果存在额外的变量，这些变量一定不是重要的变量，如与功能的业务规则相关的变量。 
⚫ 
在任何情况下，应用程序必须只接受用户想要的输入，其余的必须被拒绝或保持未绑定。
和未公开的变量的初始化，如果有的话，必须发生在绑定逻辑之后。 
审计标准 
审计应用程序设计并审计它是否包含数据绑定逻辑。如果包含，审计绑定到请求参数的
业务对象/bean 是否有未公开的变量，这些变量要确保是静态值。如果这些变量在绑定逻辑
之前被初始化，这种攻击有可能会成功。 
代码审计需要做什么: 
代码审计者需要“在被审计的代码中，映射出用户输入用于直接参考对象的所有位置”。
这些位置包括用户输入用于访问数据库行、文件、应用程序等的位置。审计者需要了解用于
参考对象的输入的修改是否会导致检索用户无权查看的对象。 
如果使用不受信任的输入来访问服务器端的对象，则必须采用适当的授权审计来确保数
据不会泄露。还需要辅以正确的输入验证，以确保服务器端代码正确处理不可信的输入。请
注意，此授权和输入验证必须在服务器端执行，因为攻击者可以绕过客户端代码。 
MVC.NET 中的绑定问题 
121 
过度发布和批量分配 
在 MVC 框架中，批量分配是一种机制，它允许我们用 HTTP 表单字段中的请求来更新
我们的模型。由于需要更新的数据来自表单字段的集合，用户可以发送请求并修改模型中可
能不在表单中的其他字段，可能开发人员并不打算更新这些字段。 
根据您创建的模型，可能会有不想修改的敏感数据被修改。当恶意用户修改模型的字段
(这些字段不会通过视图暴露给用户)时，该漏洞就会被利用，并且恶意用户更改隐藏的模型
值会添加额外的模型参数。 
样本 1 
public class user 
{ 
public int ID { get; set; }   
Name:   
部分定义一个
插件。定义的属性告诉 struts 框架在哪里定义自定义验证规则(validation.xml)以及实际规
则本身的具体含义(validation-rules.xml)。 
如果没有对 struts 框架的正确理解，并且仅仅通过审核 Java 代码，就看不到任何正在
执行的验证，也看不到已定义的规则和 Java 函数之间的关系。 
动作映射定义了应用程序在接收请求时采取的动作。这里，在下面的样本中，我们可以
看到当 URL 包含"/login "时，将调用 LoginAction。从动作映射中，我们可以看到应用程
序在收到外部输入时执行的事务。 
125 
3.5.2 Java 企业版配置声明方式 
Java 代码安全性是网络应用程序中使用框架或标准的 Java 企业版(JEE)API 来保障的。
JEE 有 JEE 安全模型，该模型使用基于角色的安全模型，根据安全角色授予对应用程序资源
的访问权限。安全角色是主体(经过身份验证的实体，通常是用户)的逻辑分组，通过在角色
上指定安全约束来声明访问。 
约束和角色被表示为部署描述符，部署描述符以 XML 元素形式展示。不同类型的组件
对其部署描述符使用不同的格式或模式: 
⚫ 
网络组件可以在文件中使用网络应用程序部署描述符 
⚫ 
企业 JavaBeans 组件可以使用一个名为 META-INF/ejb-jar.xml 的 EJB 部署描述符 
部署描述符可以定义资源(例如，可通过特定网址访问的小服务程序)，哪些角色被授权
访问资源，以及如何限制访问(例如，通过获取但不发布)。 
下面的样本示例是 Web 组件描述符（包含在“ web.xml”文件中），定义了 Servlet 
catalog “经理”的角色。该角色在用户使用 SSL 并成功通过 HTTP 基本身份验证“经理”
126 
角色后，可通过 GET 和 POST 请求访问的 Servlet 中的 SalesInfo 资源。 
A Secure Application 
catalog 
com.mycorp.CatalogServlet 
catalog 
Spring 
MGR 
manager 
manager 
catalog 
/catalog/* 
127 
SalesInfo 
/salesinfo/* 
GET 
POST 
manager 
CONFIDENTIAL 
BASIC 
file 
还可以在“ejb-jar.xml”文件中为企业 Java beans 声明安全角色，如下面示例所示。 
The single application role 
TheApplicationRole 
128 
然而，对于 bean，不是指定对 servlets 内资源的访问，而是指定对 bean 方法的访问。
下面的示例说明了几个 beans 的几种类型的方法访问约束。 