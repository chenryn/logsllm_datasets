    */
å¯ä»¥çœ‹åˆ° **yOu_L1kE** ï¼Œæ»¡è¶³è¦æ±‚çš„ä¸¤ä¸ªå­—èŠ‚æ˜¯ **0xb7 0xad**
ç„¶åè§£å¯†2æ®µå¯†æ–‡å†æŒ‰ä¸€å®šé¡ºåºæ‹¼æ¥ä¸€ä¸‹å¾—åˆ°ï¼š **_D0_yOu_L1kE_It!**
ç°åœ¨å°±æ˜¯å»æ±‚ **_@#?! &-$+**å¯¹åº”çš„å¤„ç†å‡½æ•°æ€ä¹ˆæ‰èƒ½å°† ** _((_WORD_ )Block + 273)**çš„0xDEADçš„æ”¹ä¸º
**0xB7AD** ã€‚
è¾“å…¥ä¸ºhexï¼Œ4å­—èŠ‚ä¸ºä¸€ç»„è½¬åŒ–ä¸º2ä¸ªbyteï¼Œç¬¬ä¸€ä¸ªbyteæ˜¯indexï¼Œç¬¬äºŒä¸ªbyteæ˜¯data
æ ¹æ®è¦æ±‚æ¨ç®—å‡ºè¿™æ ·ä¸€ä¸ªé¡ºåºæ˜¯æ»¡è¶³bè¦æ±‚çš„ï¼š
é¦–å…ˆ **@** å¯¹åº”çš„å¤„ç†å‡½æ•°å°†block[256] = 0xFEã€‚æ³¨æ„ä¸‹é¢æ˜¯char a2ï¼Œæ‰€ä»¥ä¼ å…¥0xFFå°±æ˜¯-1äº†ï¼Œå› æ­¤æ»¡è¶³è¾“å…¥ä¸ºï¼š
**[@FFFE](https://github.com/FFFE "@FFFE")**
ç„¶å **#** å¯¹åº”çš„å¤„ç†å‡½æ•°å°†block[528] = 0x20ï¼Œå› æ­¤æ»¡è¶³è¾“å…¥ï¼š **#0F20**
æœ€å **â€“** å¯¹åº”çš„å¤„ç†å‡½æ•°å°†block[527] = 0xB7ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬æœ€åçš„ç»ˆç‚¹ã€‚å› æ­¤æ»¡è¶³è¾“å…¥ï¼š **-11B7**
å¯ä»¥çœ‹åˆ°ä¸Šé¢è¦èƒ½æ‰§è¡Œæœ€åçš„ ** _(_BYTE_ )(a1 + 530 + a2) = a3;**è¦æ±‚æ˜¯(*(unsigned __int16 *)(a1
+ 528) % 16) == 0ï¼Œ(unsigned int)(*(unsigned __int16 *)(a1 + 528) / 16) >> a = [i for i in range(0xff) if i%16 == 0 and i/16 >> a
    [0, 16, 32]
è€Œæˆ‘ä»¬çš„indexä¸º17ä¸” **index GetStringUTFChars(a1, a3, 0LL);
      if ( (*a1)->GetStringLength(a1, (jstring)a3) == 32 )
      {
        v6 = (_BYTE *)operator new[](0x21uLL);
        __strcpy_chk(v6, v5, 33LL);
        v7 = (char *)operator new[](0x1EuLL);
        sub_7079FF9E80();
        v8 = __strlen_chk(v7, 0x1Eu);
        v7[(int)v8] = 102;
        v7[((v8 > 32] = 108;
        v7[((v8 > 32] = 103;
        v7[((v8 > 32] = 0;
        v19 = xmmword_707A01E5D0;
        sub_7079FFA934((__int64)v20, v7, (long double *)&v19);
        sub_7079FFAE6C(v20, v6, 0x20uLL);
        strcpy_0(v20, (char *)&qword_707A02F058);
        if ( (v20[0] & 1) != 0 )
          v9 = v21;
        else
          v9 = (char *)v20 + 1;
        sub_7079FFA624((int)&v19, v9);
        v10 = 0LL;
        while ( v16[v10] == stru_707A02F000[0].n128_u8[v10] )
        {
          if ( ++v10 == 32 )
          {
            v11 = strlen((const char *)&aQpyl);
            sub_7079FF9670((int)v17, &aQpyl, v11);
            if ( (v17[0] & 1) != 0 )
              v12 = v18;
            else
              v12 = (char *)v17 + 1;
            goto LABEL_18;
          }
        }
        if ( (v17[0] & 1) != 0 )
          v12 = v18;
        else
          v12 = (char *)v17 + 1;
    LABEL_18:
        v14 = (*a1)->NewStringUTF(a1, v12);
        if ( (v20[0] & 1) != 0 )
          operator delete(v21);
      }
      else
      {
        if ( (v17[0] & 1) != 0 )
          v13 = v18;
        else
          v13 = (char *)v17 + 1;
        v14 = (*a1)->NewStringUTF(a1, v13);
      }
      if ( (v17[0] & 1) != 0 )
        operator delete(v18);
      return v14;
    }
å…ˆç®€å•é™æ€åˆ†æä¸€ä¸‹ï¼Œå¼€å§‹æ˜¯åˆ¤æ–­è¾“å…¥çš„é•¿åº¦æ˜¯å¦ä¸º32ã€‚
ç„¶åsub_7B4933FE80å‡½æ•°è¯»å–æŸä¸ªæ–‡ä»¶å†…å®¹ç»è¿‡å¯¹æ¯”åè¿”å›ä¸€ä¸²å­—ç¬¦ä¸²ï¼š
åé¢æ¥ç€å¯¹ä¸Šé¢è·å–åˆ°çš„å­—ç¬¦ä¸²è¿›è¡Œå¦‚ä¸‹èµ‹å€¼ï¼š
å…¶å®å°±æ˜¯åœ¨å…¶æœ«å°¾åŠ ä¸Š **flg**
    len = strlen(init_key);
    init_key[len] = 'f';
    init_key[len+1] = 'l';
    init_key[len+2] = 'g';
    init_key[len+3] = '\x0';
æ¥ç€sub_7B49340934å‡½æ•°ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­çš„sub_7B49340820å‡½æ•°ç”¨äº†ä¼ å…¥çš„ä¸€ä¸ªå‚æ•°ä¸²è¿›è¡Œaesçš„å¯†é’¥æ‰©å±•ï¼šå­—èŠ‚æ›¿æ¢ï¼ˆä½†æ˜¯è¿™é‡Œçš„sboxæ˜¯æ›¿æ¢è¿‡çš„ï¼‰ï¼Œç§»ä½ï¼Œè½®å¸¸æ•°å¼‚æˆ–ã€‚44/4
= 11ï¼Œè¿™ä¹Ÿè¯´æ˜äº†æ˜¯aes_128ï¼Œå› ä¸ºå¯†é’¥11ç»„ã€‚
å†æ˜¯å°†å¦å¤–ä¸€ä¸ªå‚æ•°å­˜æ”¾åœ¨æ‰©å±•å¯†é’¥çš„å°¾éƒ¨ï¼š
æ¥ç€çš„sub_7B49340E6Cå‡½æ•°ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„aes_128_cbcåŠ å¯†ï¼Œsub_7B4934097Cä¸­æ¸…æ™°çš„åˆå§‹è½®ï¼ˆè½®å¯†é’¥åŠ ï¼‰ï¼Œé‡å¤è½®ï¼ˆå­—èŠ‚æ›¿æ¢ï¼Œè¡Œç§»ä½ï¼Œåˆ—æ··åˆï¼Œè½®å¯†é’¥åŠ ï¼‰ï¼Œæœ€ç»ˆè½®ï¼ˆå­—èŠ‚æ›¿æ¢ï¼Œè¡Œç§»ä½ï¼Œè½®å¯†é’¥åŠ ï¼‰ç»“æ„ï¼š
æœ€åsub_7B49340624å‡½æ•°rc4åŠ å¯†ï¼Œä½†å¤šå¼‚æˆ–äº†0x50ï¼š
æ‰€ä»¥æ•´ä½“ä¸Šæœ¬é¢˜çš„åŠ å¯†å°±æ˜¯aes_128_cbcä¸rc4ï¼Œéº»çƒ¦çš„æ˜¯æ•°æ®éƒ¨åˆ†ï¼Œå¦‚aesçš„å¯†é’¥ï¼Œivï¼Œrc4å¯†é’¥ä¸å¯†æ–‡ç­‰ã€‚å› ä¸ºå¼€å§‹è¯´äº†åœ¨.init_arrayä¸­è¿›è¡Œäº†å¾ˆå¤šæ•°æ®çš„è§£å¯†ï¼Œæˆ‘åœ¨é™æ€åˆ†æçœ‹åˆ°çš„å¤§å¤šæ•°æ•°æ®éƒ½æ˜¯æ²¡æœ‰è§£å¯†çš„ã€‚é‚£æˆ‘ä»¬ç°åœ¨è¦ä¹ˆå¯¹åˆ†æåˆ°çš„æ•°æ®æ‰¾åˆ°å¼•ç”¨ä¿®æ”¹çš„.init_arrayä¸­çš„å‡½æ•°æŒ‰ç…§ç›¸åŒçš„è¿ç®—é€»è¾‘æ‰‹åŠ¨patchä¿®æ”¹ï¼›è¦ä¹ˆå°±æ˜¯æŠŠç¨‹åºè°ƒè¯•èµ·æ¥ï¼Œåˆ†æèµ·æ¥ä¼šç®€å•å¾ˆå¤šã€‚
è¿™é‡Œæˆ‘é€‰æ‹©äº†åŠ¨æ€è°ƒè¯•ã€‚
é¦–å…ˆå°†AndroidMannifest.xmlä¸­çš„ **android:extractNativeLibs=â€falseâ€œ**
æ”¹ä¸ºtrueæˆ–è€…åˆ æ‰ï¼Œé»˜è®¤ä¸ºtrueã€‚å› ä¸ºè¿™ä¸ªå¦‚æœä¸ºfalseä¼šè®©æˆ‘ä»¬åœ¨è°ƒè¯•æ—¶æ‰¾ä¸åˆ°so
ç„¶åå› ä¸ºæˆ‘ä»¬è°ƒè¯•çš„æ–­ç‚¹è¦æ–­åœ¨ **JNI_OnLoad** ä¸­ï¼ˆæ–¹ä¾¿æŠŠæ³¨å†Œçš„å‡½æ•°ä¿®æ”¹ä¸ºæ­£ç¡®çš„åˆ†æ”¯ï¼‰ï¼Œé‚£æˆ‘ä»¬å¿…é¡»åœ¨ç¨‹åºè¿˜æ²¡æ‰§è¡Œ
**System.loadLibrary(â€œnative-libâ€);** ä¹‹å‰å°±æ–­ä¸‹æ¥ï¼Œæ‰€ä»¥è¦ç¨‹åºè¦ä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ã€‚
é¦–å…ˆæˆ‘å°è¯•äº†ida+jdbçš„ç»„åˆï¼š
> è¿è¡Œç¯å¢ƒä¸­rootæ¨¡å¼å¯åŠ¨å¥½ç›¸åº”çš„æœåŠ¡ç¨‹åºï¼Œè½¬å‘ç«¯å£åˆ°æœ¬åœ°ã€‚(åœæ­¢è½¬å‘ç«¯å£ï¼š **adb forward â€”remove tcp:ç«¯å£å·`æˆ–`adb
> forward â€”remove-all**)
>
> ä½¿ç”¨amå‘½ä»¤ä»¥è°ƒè¯•å¯åŠ¨appï¼šadb shell am start -D -n come.wmctf.crackme111/.MainActivity
>
> idaåœ¨JNI_OnLoadä¸­ä¸‹å¥½æ–­ç‚¹ï¼Œç„¶åæ‰¾åˆ°appå¯¹åº”çš„è¿›ç¨‹åé™„åŠ ï¼Œæ¥ç€F9è¿è¡Œ
>
> æ‰“å¼€ddmsï¼Œç”¨é™„åŠ è®©appè¿è¡Œèµ·æ¥ï¼šjdb -connect
> com.sun.jdi.SocketAttach:hostname=127.0.0.1,port=8700
ä½†æ˜¯è¿™æ ·åšåœ¨jdbé™„åŠ appå°±æŠ¥å¦‚ä¸‹çš„é”™è¯¯ã€‚è¿™å¥½åƒæ˜¯æˆ‘æ‰‹æœºçš„åŸå› ï¼Ÿ
æˆ‘ä½¿ç”¨jebæ¥é™„åŠ appåŒæ ·ä¹Ÿæ˜¯æŠ¥é”™ï¼Œè¿™éƒ½æ˜¯åœ¨æˆ‘å…ˆç”¨IDAé™„åŠ äº†è¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œæ¥ç€æˆ‘å°è¯•å‘ç°å…ˆjdbæˆ–jebé™„åŠ å†IDAé™„åŠ æ˜¯å¯ä»¥çš„ï¼Œä½†è¿™æ ·ç¨‹åºå·²ç»è¿è¡Œè¿‡
**System.loadLibrary(â€œnative-libâ€);** äº†ã€‚
è€Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨jebé™„åŠ è°ƒè¯•æ–­åœ¨ **System.loadLibrary(â€œnative-libâ€);** ä¹‹å‰å†ç”¨IDAå»é™„åŠ è¿›ç¨‹å‘€ã€‚
ç„¶åæˆåŠŸæ–­åœ¨JNI_OnLoadä¸­ï¼Œåœ¨æ­£ç¡®åˆ†æ”¯ä¸‹å¥½æ–­ç‚¹ï¼Œä¿®æ”¹æ£€æµ‹ç¯å¢ƒæ˜¯å¦rootçš„è¿”å›å€¼ä¸ºfalseï¼Œä½†æ˜¯è¿™ä¸ªåœ¨nativeå±‚è¿è¡Œå®ŒJNI_OnLoadå‡½æ•°å›åˆ°javaå±‚çš„æ—¶å€™appåˆå´©æºƒäº†ã€‚
æœ€åå¹²è„†ç›´æ¥æ”¹soå¾—äº†ï¼Œå°±æ˜¯æŠŠæ ¹æ®æ£€æµ‹è¿è¡Œç¯å¢ƒæ˜¯å¦æœ‰suçš„è¿”å›å€¼åçš„æ¡ä»¶è·³è½¬æ”¹ä¸€ä¸‹ã€‚
ä¸Šé¢ä¿®æ”¹å®Œåï¼ŒæŠŠappé‡ç¼–è¯‘ä¸€ä¸‹ï¼Œç„¶åæ™®é€šçš„é™„åŠ è°ƒè¯•å°±å¥½äº†ã€‚è¿™ä¹Ÿæ˜¯è°ƒè¯•æœ¬ç¨‹åºæœ€ç®€å•çš„æ–¹æ³•ï¼Œä¸Šé¢ç»•äº†ä¸€å¤§åœˆğŸ˜‚ã€‚
ç°åœ¨å†çœ‹ä¸€ä¸‹å†…å­˜ä¸­è§£å¯†åçš„æ•°æ®ï¼Œä¸€ç›®äº†ç„¶ï¼š
çœ‹åˆ°ä¸Šé¢é™æ€åˆ†æè¯´çš„sub_7B4933FE80å‡½æ•°ç”¨fopen()æ‰“å¼€äº†ä¸€ä¸ªç³»ç»Ÿæ–‡ä»¶ï¼Œç°åœ¨è°ƒè¯•è¿‡å»å‘ç°åŸæ¥æ˜¯è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼š
å†çœ‹åˆ°åé¢è¦åŒ¹é…çš„å†…å®¹ã€‚
è‡ªå·±æ‰‹åŠ¨æŸ¥çœ‹ä¸€ä¸‹ï¼š
æ¥ç€ç›´æ¥è°ƒè¯•åˆ°æœ€åçœ‹è·å–çš„ç»“æœï¼Œå°±æ˜¯è¦è·å– **TracerPid:**
å­—æ®µé‚£ä¸€è¡Œçš„å†…å®¹åŠ ä¸Šflgï¼Œè€Œappæ­£å¸¸ä¸è°ƒè¯•è¿è¡Œè¿™ä¸ªTracerPidæ˜¯0çš„ï¼Œæ‰€ä»¥è¿™é‡Œè·å–çš„æ­£ç¡®å€¼ä¸ºï¼š
**TracerPid:\x090\x0Aflg**
æ¥ç€çœ‹åˆ°ä¸‹é¢ä¸ä¸Šé¢çš„é™æ€åˆ†æç»“åˆå¯ä»¥çŸ¥é“ï¼šç¨‹åºä¸­aes_128çš„keyï¼š **TracerPid:\x090\x0Aflg** ivï¼š **0, 1, 2,
3, 4, 5, 6, 7, 8, 9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF**
å†å°±æ˜¯è¿™ä¸ªaesåŠ å¯†çš„sboxæœç„¶æ˜¯æ›¿æ¢äº†çš„ï¼Œæ­£å¸¸çš„sboxå¼€å¤´ä¸ºï¼š **0x63, 0x7c, 0x77, 0x7b**
æœ€åçœ‹åˆ°å‰©ä¸‹çš„rc4åŠ å¯†ï¼Œä»ä¼ å…¥å‚æ•°çœ‹åˆ°å¯†é’¥æ˜¯ **Hello from C++**
ä¸‹é¢å¼€å§‹è§£å¯†ã€‚
é¦–å…ˆrc4è§£å¯†ï¼š
ç›´æ¥æŠŠè¾“å…¥çš„aesåŠ å¯†ç»“æœä¸æœ€ç»ˆç»è¿‡rc4ç»“æœéƒ½æå–å‡ºæ¥å¼‚æˆ–ä¸€ä¸‹å¾—åˆ°å¼‚æˆ–åºåˆ—ï¼Œå†å°†å…¶ä¸çœŸæ­£çš„å¯†æ–‡å¼‚æˆ–ä¸€ä¸‹å¾—åˆ°çœŸæ­£çš„aesåŠ å¯†ç»“æœï¼š
    >>> s = [0xA4, 0xCD, 0xDA, 0x34, 0xA9, 0xE8, 0xFF, 0x48, 0xD6, 0x74, 0xE7, 0x0F, 0x71, 0xF7, 0xED, 0xB7, 0xC2, 0xA8, 0xE1, 0xE1, 0x0E, 0x2D, 0xD0, 0x8D, 0xF8, 0x20, 0x0E, 0x85, 0x1D, 0xBC, 0xC1, 0x61]
    >>> t = []
    >>> t = [0x6C, 0xDB, 0xC6, 0x75, 0x4A, 0x94, 0xAA, 0xBD, 0xF5, 0x92, 0xCF, 0xB6, 0x4E, 0x0B, 0x38, 0x5B, 0x2E, 0x4F, 0x48, 0xFD, 0xE2, 0x7B, 0xE3, 0xFE, 0x64, 0x7E, 0xEA, 0xA7, 0xB5, 0x8D, 0x96, 0xF5]
    >>> ans = [s[i]^t[i] for i in range(len(s))]
    >>> ans
    [200, 22, 28, 65, 227, 124, 85, 245, 35, 230, 40, 185, 63, 252, 213, 236, 236, 231, 169, 28, 236, 86, 51, 115, 156, 94, 228, 34, 168, 49, 87, 148]
    >>> enc = [0x18, 0x76, 0xEB, 0x87, 0x76, 0x3E, 0x77, 0x08, 0xC0, 0x8D, 0x56, 0x25, 0x9E, 0x35, 0x0D, 0x16, 0x23, 0x65, 0x61, 0x6A, 0x14, 0x9D, 0x4F, 0x1C, 0x64, 0x21, 0x7D, 0x78, 0xBA, 0x53, 0x91, 0x22]
    >>> res = [ans[i]^enc[i] for i in range(len(enc))]
    >>> res
    [208, 96, 247, 198, 149, 66, 34, 253, 227, 107, 126, 156, 161, 201, 216, 250, 207, 130, 200, 118, 248, 203, 124, 111, 248, 127, 153, 90, 18, 98, 198, 182]
ç„¶åaesè§£å¯†ï¼š
å°†ä¹‹å‰è‡ªå·±å†™è¿‡çš„aes_cbcåŠ è§£å¯†ä¸­çš„sboxæ›¿æ¢ä¸ºç¨‹åºä¸­çš„ï¼Œrsboxç®€å•å¯¹sboxæ±‚ä¸€ä¸‹é€†ï¼Œæœ€åè§£å¯†å³å¯ï¼š
    //aes.h
    #ifndef AES_H
    #define AES_H
    #include 
    #include 
    #include  
    #define Nk 4
    #define Nr 10
    #define Nb 4
    #define getSBoxValue(num) (sbox[(num)])
    class aes
    {
    public:
        struct ctx_
        {
            unsigned char RoundKey[11*16];
        }ctx;
    public:
        aes(char *Key);
        void xor_iv(char *a, char *b);
        void KeyExpansion(unsigned char *RoundKey, char *Key);
        void AddRoundKey(unsigned char (*state)[4], unsigned char *RoundKey);
        void SubBytes(unsigned char (*state)[4]);
        void ShiftRows(unsigned char (*state)[4]);
        unsigned char gfmultby(unsigned char a, unsigned char b);
        void MixColumns(unsigned char (*state)[4]);
        void getData(unsigned char (*data)[4], char *enc);
        void encryption_cbc(char *plaint, char *enc);
        void InvSubBytes(unsigned char (*state)[4]);
        void InvShiftRows(unsigned char (*state)[4]);
        void InvMixColumns(unsigned char (*state)[4]);
        void decryption_cbc(char *plaint, char *enc);
    };
    #endif // AES_H
    //main.cpp