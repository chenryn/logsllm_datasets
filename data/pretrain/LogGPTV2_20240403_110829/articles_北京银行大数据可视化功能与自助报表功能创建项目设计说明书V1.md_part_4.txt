### 订阅监控 {#订阅监控 .样式3}
#### 功能概述
用户订阅报表生成文件之后的记录。
#### 操作界面
![](media/image14.png){width="5.995138888888889in" height="4.4625in"}
#### 模块流程
1.查询
在查询条件中输入任务处理日期/订阅名称进行信息的查询.
2.重置
清除查询条件。
#### 关联模块
为了实现本功能需要调用的其它模块、类或方法。
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          monitoring.jsp
  后台类                MonitoringAction.java monitoringservice.java
                        Monitoringdao.java Monitoringentity.java
  主要用途              用户订阅报表生成文件记录的查看。
  --------------------- ---------------------------------------------------
#### 输入输出
【输入参数】
  --------------------- -------------- -------------- ----------- -------------
  **字段名称**          **输入类型**   **字段类型**   **约束**    **说明**
  任务处理日期          日期框选择     数字           无          
  订阅名称              手动输入       中文/英文      无          
  --------------------- -------------- -------------- ----------- -------------
【输出参数】
  --------------------- -------------- -------------- ----------- -------------
  **字段名称**          **输入类型**   **字段类型**   **约束**    **说明**
  任务处理日期                         字符串         无          
  任务处理时间                         字符串         无          
  订阅名称                             字符串         无          
  任务进度                             字符串         无          
  --------------------- -------------- -------------- ----------- -------------
#### 引用的数据库表
RUNQIAN.NP_REPORT_BOOK_LOG_RQ
### 订阅历史数据加工 {#订阅历史数据加工 .样式3}
#### 功能概述
报表订阅表数据全量倒入报表订阅历史表
#### 模块流程
每日由NP_REPORT_BOOK（报表订阅表）全量插入到NP_REPORT_BOOK_HIS（报表订阅历史表）
#### 关联模块
无
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          
  后台类                SP_NP_REPORT_BOOK_HIS
  主要用途              报表订阅表数据全量倒入报表订阅历史表
  --------------------- ---------------------------------------------------
#### 逻辑说明
#### 输入输出
无
#### 引用的数据库表
NP_REPORT_BOOK_HIS
### 订阅任务处理加工 {#订阅任务处理加工 .样式3}
#### 功能概述
加工报表订阅数据生成跑批记录。
#### 模块流程
从（报表订阅历史表）和（订阅报表表）中抽取数据插入到（报表订阅任务处理表）中，判断报表的频度，判断是否有订阅任务。
根据（就绪状态表）和（报表与数据表映射关系表）判断数据文件是否准备完成，如准备完成则调起润干集算器，如没有完成则等待60秒后再次扫描数据是否准备完成。
#### 关联模块
无。
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          
  后台类                SP_NP_REPORT_BOOK_RECORD、SP_NP_REPORT_BOOK_RUN
  主要用途              报表订阅
  --------------------- ---------------------------------------------------
#### 逻辑说明
#### 输入输出
无
#### 引用的数据库表
NP_REPORT_BOOK_RECORD、NP_REPORT_BOOK。
### 订阅调度程序开发 {#订阅调度程序开发 .样式3}
#### 功能概述
#### 模块流程
每日凌晨3点开始调起报表订阅历史表跑批，跑批完成后调起报表订阅任务处理表跑批，完成后调起JS1015报表和JS0026报表跑批。
#### 关联模块
无
#### 设计说明
+------------------+---------------------------------------------------+
| **类             | **描 述**                                         |
| 名/功能点名称**  |                                                   |
+------------------+---------------------------------------------------+
| 前台页面名称     |                                                   |
+------------------+---------------------------------------------------+
| 后台类           | SP_NP_REPORT_BOOK_HIS、SP_NP_REPORT_BOOK_RECORD、 |
|                  |                                                   |
|                  | SP_NP_RUN_JS0026、                                |
|                  |                                                   |
|                  | SP_NP_RUN_JS1015                                  |
+------------------+---------------------------------------------------+
| 主要用途         | 报表订阅跑批作业                                  |
+------------------+---------------------------------------------------+
#### 逻辑说明
#### 输入输出
无
#### 引用的数据库表
NP_REPORT_BOOK_HIS、NP_REPORT_BOOK_RECORD
### 订阅文件校验 {#订阅文件校验 .样式3}
#### 功能概述
ODS系统下发数据文件及控制文件到天眼门户系统的应用服务器上，天眼门户系统WEB应用开启定时任务定时扫描应用服务器的文件目录下的文件，如果检测到ODS下发文件的总记录数与校验文件中数量一致。
#### 操作界面
无。
#### 模块流程
***定时任务*** ***FTP***
#### 关联模块
无
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          
  后台类                
  主要用途              文件校验
  --------------------- ---------------------------------------------------
#### 输入输出
无
#### 引用的数据库表
NP_REPORT_BOOK_HIS、NP_REPORT_BOOK_RECORD
### FTP文件推送 {#ftp文件推送 .样式3}
#### 功能概述
把通过校验的ODS下发的数据文件推送到共享磁盘上方便集算器加载数据。
#### 操作界面
无。
#### 模块流程
把通过校验的ODS下发的数据文件，通过FTP的方式推送到共享磁盘上的对应的日期目录下。
#### 关联模块
无
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          
  后台类                
  主要用途              完成数据文件推送
  --------------------- ---------------------------------------------------
#### 输入输出
无
#### 引用的数据库表
### 订阅邮件发送 {#订阅邮件发送 .样式3}
#### 功能概述
邮件发送是在用户订阅报表后，向用户订阅报表时输入的邮件号进行报表文件发送的功能。
#### 操作界面
无。
#### 模块流程
***生成文件*** ***连接邮件***
#### 关联模块
我的订阅。
#### 设计说明
  --------------------- ---------------------------------------------------
  **类名/功能点名称**   **描 述**
  前台页面名称          无
  后台类                Mytimer.java Email.java FromMail.java
                        MeContent.java ToMail.java
  主要用途              进行邮件的发送
  --------------------- ---------------------------------------------------
#### 逻辑说明
邮件发送是定时任务，设置定时发送邮件的时间，定时查询订阅日志表。
查询出订阅人的邮件信息，进行邮件的发送。
#### 输入输出
无
#### 引用的数据库表
RUNQIAN.NP_REPORT_BOOK_LOG
PORTAL35. NP_REPORT_BOOK
## 自助报表
该模块主要提供数据多维分析功能，目前整个金融BI领域分析分为三大阶段，第一阶段为固定报表层面的常规列表式统计分析，第二阶段为可视化与自助化的多维分析，第三阶段为大数据智能分析，SAS分析等，而多维分析模块为根据我行发展现状，提供的第二阶段的BI分析服务，包括可多拽的灵活性较强的透视分析与组合分析，以及数据画布式的可视化分析，此次智能化门户为该类服务提供栏位，应用层面包含原报表平台CUBE系列服务的前台数据展示，主要实现方式底层调用原报表平台可视化分析模块的升级版框架服务。
### 整体模块业务逻辑 {#整体模块业务逻辑-1 .样式3}
![](media/image15.emf)
上图是自助报表业务流程：
-   业务人员通过大数据可视化智能门户系统的自助报表模块中的电子银行节点访问电子银行的smartBI报表。
-   选择访问的报表后调用CRM提供的验证接口，验证数据是否准备就绪，验证未通过提供稍后再试，验证通过调用smartBI的sdk显示samrtbi报表
### 电子银行 {#电子银行 .样式3}
#### 功能概述
使用smartbi报表工具开发的电子银行报表，用户可通过勾选选择想要的查询条件以及展示内容。
#### 操作界面