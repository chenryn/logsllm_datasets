### Table 2: Summary of Traces
Autograph's suspicious flow classifier identifies unsuccessful connection attempts in each trace. For the IRP trace, Autograph uses ICMP host/port unreachable messages to compile a list of suspicious remote IP addresses. Since neither ICSI trace includes outbound ICMP packets, Autograph infers failed connection attempts by analyzing incoming TCP SYN and ACK pairs.

### Scanner Detection Thresholds
We run Autograph with varying scanner detection thresholds, \( s \in \{1, 2, 4\} \). These thresholds are lower than those used by Bro and Snort, aiming to catch as many worm payloads as possible, especially early in an epidemic. As a result, our flow classifier more frequently misclassifies flows as suspicious, and more innocuous flows are submitted for signature generation.

### Content Block Size Parameters
We also vary the minimum content block size (\( m \)) and average content block size (\( a \)) parameters that govern COPP, while fixing the maximum content block size (\( M \)) at 1024 bytes. We vary \( w \) within the range [10%, 100%] in our experiments. Recall that \( w \) limits the fraction of suspicious flows that may contribute content to the signature set. COPP adds content blocks to the signature set (starting with the most prevalent and then in order of decreasing prevalence) until one or more content blocks in the set match \( w \) percent of the flows in the suspicious flow pool.

### Content Block Prevalence Distribution
To illustrate the content block prevalence distribution found by Autograph, we use a simple example. Figure 5 shows the prevalence of content blocks found by COPP when we run it with \( m = 64 \), \( a = 64 \), and \( w = 100\% \) over a suspicious flow pool captured from the full 24-hour ICSI trace with \( s = 1 \). At \( w = 100\% \), COPP adds content blocks to the signature set until all suspicious flows are matched by one or more content blocks in the set. The x-axis represents the order in which COPP adds content blocks to the signature set (most prevalent first). The y-axis represents the cumulative fraction of the population of suspicious flows containing any of the set of signatures, as the set of signatures grows. The trace contains Code-RedII, Nimda, and WebDAV worm flows. Nimda sources send 16 different flows with every infection attempt, searching for vulnerabilities under 16 different URLs. The first signature COPP generates matches Code-RedII; 28% of the suspicious flows are Code-RedII instances. Next, COPP selects 16 content blocks as signatures, one for each of the different payloads transmitted by Nimda-infected machines. About 5% of the suspicious flows are misclassified. We observe that commonality across these misclassified flows is insignificant, so the content blocks from these misclassified flows tend to be lowly ranked.

### True Positive Rate
To measure true positives (the fraction of worm flows found), we run Bro with the standard set of policies to detect worms (distributed with the Bro software) on a trace, and then run Bro using the set of signatures generated by Autograph on the same trace. The true positive rate is the fraction of the total number of worms found by Bro’s signatures (presumed to find all worms) that are also found by Autograph’s signatures.

### False Positive Rate
To measure false positives (the fraction of non-worm flows matched by Autograph’s signatures), we create a sanitized trace consisting of all non-worm traffic. To do this, we eliminate all flows from a trace that are identified by Bro as worms. We then run Bro using Autograph’s signatures on the sanitized trace. The false positive rate is the fraction of all flows in the sanitized trace identified by Autograph’s signatures as worms.

### Efficiency Metric
Because the number of false positives is very low compared to the total number of HTTP flows in the trace, we report our false positive results using the efficiency metric proposed by Staniford et al. [17]. Efficiency is the ratio of the number of true positives to the total number of positives, both false and true. Efficiency is proportional to the number of false positives but provides detailed insight into the false positive trend when the false positive rate is low.

### Experimental Results
The graphs in Figure 6 show the sensitivity and efficiency of the signatures generated by Autograph running on the full 24-hour ICSI trace for varied \( m \). Here, we present experimental results for \( s = 2 \), but the results for other \( s \) values follow similar trends.

[Insert Figure 6 here]

In summary, the experimental results demonstrate the effectiveness of Autograph in identifying and generating signatures for worm traffic, while balancing the trade-off between true and false positives.