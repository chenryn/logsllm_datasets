48
57
294
-
1396
1022
374
-
Table 2: Summary of traces.
Autograph’s suspicious ﬂow classiﬁer identiﬁes unsuccess-
ful connection attempts in each trace. For the IRP trace, Au-
tograph uses ICMP host/port unreachable messages to com-
pile the list of suspicious remote IP addresses. As neither
ICSI trace includes outbound ICMP packets, Autograph in-
fers failed connection attempts in those traces by looking at
incoming TCP SYN and ACK pairs.
We run Autograph with varied scanner detection thresh-
olds, s ∈ {1,2,4}. These thresholds are lower than those used
by Bro and Snort, in the interest of catching as many worm
payloads as possible (crucial early in an epidemic). As a re-
sult, our ﬂow classiﬁer misclassiﬁes ﬂows as suspicious more
often, and more innocuous ﬂows are submitted for signature
generation.
We also vary the minimum content block size (m) and aver-
age content block size (a) parameters that govern COPP, but
ﬁx the maximum content block size (M) at 1024 bytes. We
vary w ∈ [10%,100%] in our experiments. Recall that w lim-
its the fraction of suspicious ﬂows that may contribute content
to the signature set. COPP adds content blocks to the signa-
ture set (most prevalent content block ﬁrst, and then in order
of decreasing prevalence) until one or more content blocks in
the set match w percent of ﬂows in the suspicious ﬂow pool.
We ﬁrst characterize the content block prevalence distribu-
tion found by Autograph with a simple example. Figure 5
shows the prevalence of content blocks found by COPP when
we run COPP with m = 64, a = 64, and w = 100% over a sus-
picious ﬂow pool captured from the full 24-hour ICSI trace
with s = 1. At w = 100%, COPP adds content blocks to the
signature set until all suspicious ﬂows are matched by one or
more content blocks in the set. Here, the x axis represents
the order in which COPP adds content blocks to the signa-
ture set (most prevalent ﬁrst). The y axis represents the cu-
mulative fraction of the population of suspicious ﬂows con-
taining any of the set of signatures, as the set of signatures
grows. The trace contains Code-RedII, Nimda, and WebDAV
Popularity Distribution of Suspicious Flows (s=1, m=64, a=64), ICSI
F
D
C
 1
 0.8
 0.6
 0.4
 0.2
 0
 0
Misclassified(1)
Nimda(16)
Nimda(1)
CodeRedII
 5
 10
 15
Selected Content Block ID
 20
Figure 5: Prevalence of Selected Content Blocks in Suspi-
cious Flow Pool, ICSI DMZ trace (24 hrs).
worm ﬂows. Nimda sources send 16 different ﬂows with ev-
ery infection attempt, to search for vulnerabilities under 16
different URLs. The ﬁrst signature COPP generates matches
Code-RedII; 28% of the suspicious ﬂows are Code-RedII in-
stances. Next, COPP selects 16 content blocks as signatures,
one for each of the different payloads Nimda-infected ma-
chines transmit. About 5% of the suspicious ﬂows are mis-
classiﬁed ﬂows. We observe that commonality across those
misclassiﬁed ﬂows is insigniﬁcant. Thus, the content blocks
from those misclassiﬁed ﬂows tend to be lowly ranked.
To measure true positives (fraction of worm ﬂows found),
we run Bro with the standard set of policies to detect worms
(distributed with the Bro software) on a trace, and then run
Bro using the set of signatures generated by Autograph on
that same trace. The true positive rate is the fraction of the
total number of worms found by Bro’s signatures (presumed
to ﬁnd all worms) also found by Autograph’s signatures.
To measure false positives (fraction of non-worm ﬂows
matched by Autograph’s signatures), we create a sanitized
trace consisting of all non-worm trafﬁc. To do so, we elimi-
nate all ﬂows from a trace that are identiﬁed by Bro as worms.
We then run Bro using Autograph’s signatures on the sani-
tized trace. The false positive rate is the fraction of all ﬂows
in the sanitized trace identiﬁed by Autograph’s signatures as
worms.
Because the number of false positives is very low com-
pared to the total number of HTTP ﬂows in the trace, we re-
port our false positive results using the efﬁciency metric pro-
posed by Staniford et al. [17]. Efﬁciency is the ratio of the
number of true positives to the total number of positives, both
false and true. Efﬁciency is proportional to the number of
false positives, but shows the detail in the false positive trend
when the false positive rate is low.
The graphs in Figure 6 show the sensitivity and the efﬁ-
ciency of the signatures generated by Autograph running on
the full 24-hour ICSI trace for varied m. Here, we present
experimental results for s = 2, but the results for other s are
y
t
i
v
i
t
i
s
n
e
S
y
c
n
e
c
i
f
f
i
E
y
t
i
v
i
t
i
s
n
e
S
y
c
n
e
c
i
f
f
i
E
y
t
i
v
i
t
i
s
n
e
S
y
c
n
e
c
i
f
f
i
E
y
t
i
v
i
t
i
s
n
e
S
y
c
n
e
c
i
f
f
i
E
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
 0
Minimum block size (m) = 16, (ICSI)
Minimum block size (m) = 16, (ICSI)
 a=16
 a=32
 a=40
 a=64
 a=128
 20
 15
 10
 5
s
e
r
u
t
a
n
g
s
f
i
o
r
e
b
m
u
N
a=16
a=32
a=40
a=64
a=128
 0
 0.1
 0.2
 0.3
 0.4
 0.5
 0.6
 0.7
 0.8
 0.9
 1
Coverage (w)
Minimum block size (m) = 32, (ICSI)
 0
 0
 0.2
 0.4
 0.6
Coverage (=w)
 0.8
 1
Minimum block size (m) = 32, (ICSI)
t
s
e
r
u
a
n
g
s
f
i
a=32
a=40
a=64
a=128
 0
 0.1
 0.2
 0.3
 0.4
 0.5
 0.6
 0.7
 0.8
 0.9
 1
Coverage (w)
Minimum block size (m) = 40, (ICSI)
o
r
e
b
m
u
N
s
e
r
u
t
a
n
g
s
f
i
o
a=40
a=64
a=128
 0
 0.1
 0.2
 0.3
 0.4
 0.5
 0.6
 0.7
 0.8
 0.9
 1
Coverage (w)
Minimum block size (m) = 64, (ICSI)
r
e
b
m
u
N
t
s
e
r
u
a
n
g
s
f
i
o
r
e
b
m
u
N
 a=32
 a=40
 a=64
 a=128