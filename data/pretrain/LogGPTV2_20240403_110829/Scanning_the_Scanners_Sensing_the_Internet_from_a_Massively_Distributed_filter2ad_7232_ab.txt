1.2T
pkts
bytes
702G
19.4B
100% 100% 11.9% 40.0% 88.0% 59.6% 86.3% 58.2%
bytes
pkts
482G 17.1B
TCP
TCP SYN
bytes
pkts
719G 16.8B
Table 1: Total packets logged in November 2018.
portion is logged. We refer to these packets as unsolicited traffic. The
logs are initially stored locally on the server, and then collected into
a centralized repository via a distributed data collection framework.
Token bucket sampling: During heavy bursts of unsolicited traf-
fic, such as DDoS attacks against the CDN machines,3 the logging
of unsolicited packets is controlled via a token bucket, which thus
maximizes the performance of the server under attack. The sam-
ple machines are each configured to have a local token bucket of
capacity 10. Each logged packet consumes 1 token. Each second,
2 new tokens are added to the token bucket, until the bucket is at
max capacity 10. Thus, the token bucket limits prolonged traffic
bursts to only 2 packets per second. Instances of sporadic traffic, on
the other hand, will be fully logged and not undergo any sampling.
We study the effect of this sampling on our dataset in the following
section.
3.2 Dataset Characteristics
Table 1 shows totals of logged packets and bytes from 89,000 ma-
chines in the month of November 2018, our primary measurement
window. TCP packets with the SYN flag set make up the vast ma-
jority of logged packets, and UDP only accounts for some 12%, but
some 40% of the bytes (recall that TCP SYN packets typically do not
carry payload). The high percentage of TCP SYN packets suggests
that the majority of the logged data are actual connection attempts
3While a majority of these attacks target services running on the CDN’s servers (e.g.,
Web) and are thus not visible in our dataset, others target non-service ports and are
reflected in our dataset.
146
to our servers, and not the result of backscatter traffic, i.e., traffic
that third-party servers send in response to DDoS attacks using
spoofed source IP addresses, which would show up with a set ACK
or RST flag [11, 32]. We note that Wustrow et al. already reported an
overall increase of the percentage of Internet Background Radiation
with only the SYN flag set between 2006 and 2010 and found that
packets with the SYN flag set comprised some 94% of TCP traffic
they received in a darknet in 2010 [32]. We find that, as of today,
even more than 98% of the TCP traffic we log has only the SYN flag
set, a first hint towards widespread scanning activity.
Non-burst vs. burst state: We next assess how often the token
buckets are in a burst state, i.e., subjected to large amounts of unso-
licited traffic, since such traffic bursts trigger performance controls
which cause sampled logging of unsolicited packets. Figure 1a par-
titions the logging into (machine, 10 second) bins, and shows the
number of packets that each individual machine logged within each
10 second timeframe in our measurement window. We see that in
more than ≈ 50% of (machine, 10 second) bins, the respective ma-
chine did not log any unsolicited traffic. In another 22% of bins,
one single packet was received, and in another 10% of bins, two
packets were received. Only in less than 0.1% of bins, machines
logged at least 20 packets, indicating that the token bucket was in
a burst state. In November 2018, “burst packets”, i.e., the sum of all
packets logged by a machine that logged 20 or more packets in the
particular 10 second bin, make up some 2.3% of our total dataset
(while an unknown number of unsolicited packets were just blocked
and not logged). The more important takeaway, however, is that
in almost 99.9% of (machine, 10 second) bins, the machine was not
in a burst state and hence logged all unsolicited traffic. Thus, our
dataset provides excellent visibility into sporadic traffic, as caused,
e.g., by scanning. To put these findings into perspective over time,
Figure 1b shows, for each day in November 2018, the distribution of
packets received per individual machine. Recall that the machines
have two public IPv4 addresses. Note that the majority of machines
012345678910111213141516171819≥20packets logged per  binpercentage of binss0.01%0.1%1%10%50%day in November 2018packets logged per machine1714212803K6K9K12K15Kports probedpercentage of ASNs / machines02468102313713813944569010373259808045232123326111211% ASes% machines               TCP                        UDPIMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Richter and Berger
(the box shows the 25/75th percentile) receive a comparable num-
ber of packets, and that few machines log significantly less packets
than that. The 5th percentile of machines (the whiskers are the 5th
and 95th percentile), still log some 5K packets per day, close to the
median of around 6.5K packets. On the other end of the spectrum,
we see that some 5-10% of machines log significantly more packets.
3.3 Assessing Presence of Filtering
The CDN servers are hosted in more than 1,300 individual net-
works, and we do not have control over potential filtering that
happens, e.g., at the AS boundary. Port-based filtering at network
boundaries is common, e.g., to prevent exploitation of well-known
services in local networks (e.g., Windows file sharing, see [1]), and
has the potential to affect the visibility of parts of our telescope.
To assess the prevalence of port-based network filtering, we sent
traffic on benign and on commonly filtered ports from a host in a
major cloud hoster to 5 of our machines within each AS. Figure 1c
shows, for tested ports and transport protocols, the percentage of
ASes in which no machine received our probing packets. In these
cases, we infer that the hosting AS deploys port-based filtering. We
note that an upwards of 10% of ASes (blue bars in Figure 1c) filter
specific ports at the AS boundary; the most common being port 445
(Windows Remote Desktop) and Windows NetBIOS (137,138,139)
service. We also observe filtering on UDP ports, e.g., port 11211,
which has been used for amplification attacks recently. We observe
virtually zero filtering on more benign port numbers, both for TCP
as well as UDP. The red bars in Figure 1c show the percentage of
affected machines (which are a subset of the CDN machines) when
taking their distribution across ASes into account, i.e., we tag ASes
as filtering/non-filtering on a given port and then tag all servers in
this AS consistently. With the tested port numbers, we find that less
than 3% of our servers are affected by port filtering by the hosting
AS. This observation makes us confident that disparate deployment
of network filtering—while clearly present—does not severely affect
our inferences of scanning behavior.4
3.4 Baseline Traffic and local Concentrations
Figure 1b suggests a mostly consistent distribution of packets over
machines. Recall, however, that each machine has two publicly
routed IPv4 addresses in the same /24, a client-facing IP and an op-
erations IP. To get a better intuition of how this difference in surface
of our telescope plays out, i.e., if and to what degree the two types
of telescope IPs receive different amounts of traffic, we next study
logged traffic of our machines on each of these interfaces. Figure 2
shows the daily traffic on client-facing and operations interface for
4 example machines. Both top machines show a steady number of
packets received on both client-facing and operations interfaces,
and we note that a large number machines follow this pattern most
of the time. Traffic is balanced over both IP addresses, steadily at
≈3,000 packets per day and IP address. We refer to this phenomenon
as baseline radiation, which we will further examine in § 7. The
bottom-left machine shows some clear traffic spikes, however we
see that the spikes are exactly correlated over both IP addresses. We
4A notable exception would be scans that are executed from within a network that
deploys filtering at its network boundary, which would result in highly localized
visibility of these scans.
Figure 2: Four example CDN machines and daily packets
received in November 2018. The top examples show ma-
chines that received only baseline radiation. Bottom-left
example shows traffic spikes correlate over both machine
IP addresses (CDN-agnostic pattern). Bottom-right example
shows no change in baseline radiation for the operations
IP address, but shows spikes for the client-facing IP (CDN-
targeted pattern).
refer to such spikes as CDN-agnostic, since we do not see evidence
that hosts targeted traffic specifically at the client-facing IP of CDN
servers, but rather against entire address blocks and/or networks.
Lastly, we show an example of a machine, where the operations
interface receives only baseline radiation, but we observe spikes
of traffic targeting the client-facing IP. We refer to such spikes as
CDN-targeted, since these packets were clearly not destined at an
entire range or network, but towards IP addresses exposed via for-
ward DNS. We only show examples here, but want to highlight
that all machines we manually inspected (several thousands), while
sometimes showing vastly different traffic levels and “amplitudes”,
all fall into one of the 3 shown behavioral patterns, making us
confident that we cover the significant cases. This distinction be-
tween baseline radiation, CDN-agnostic and CDN-targeted traffic
is vital for our upcoming characterization of unsolicited traffic and
scanning activity, since it highlights the different ways that our
machines attract unsolicited traffic.
4 SCRUTINIZING SOURCES
Next, we shift our perspective and present a source-centric per-
spective of unsolicited traffic arriving at our telescope. We first
show macroscopic properties of the activity of individual source
addresses and then proceed to identify and dissect scanning activity
in our dataset.
4.1 Fan-out and Packet Ratio
Figure 3a shows a heatmap of every source IP address that was seen
in the month of November 2018 (N=37.5M), where we bin source
IPs by the number of destination IPs it contacted (x-axis), which
147
●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●1815222903K6K9K●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●1815222903K6K9K●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●1815222903K6K9K●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●1815222903K6K9Kdays [November 2018]packets received per day●client−facing IPoperations IPScanning the Scanners
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
(a) Per source IP (N=37.5M): destination IPs contacted (x-axis) vs. total
packets logged (y-axis) for November 2018.
(b) Distribution of packets, number of unique source IP addresses, and per-
cent bursts, when partitioning source IPs by fan-out (x-axis) and packet-
to-IP ratio (y-axis). In each tile, we show contributions to totals of source
IPs and packets, and the percentage of packets within each tile that were
received as part of packet bursts.
Figure 3: Source IP address statistics.
we call the "fan-out," as well as the total number of packets we
logged from this source across all machines (y-axis). Towards the
very bottom-left, we see source IPs that contacted only a very small
number of destination IP addresses and sent only a tiny number of
packets. Towards the very right of the figure, we find source IPs
that contacted most or all IP addresses of our telescope, and some
of them sent on the order of ≈100M packets within one month,
hinting towards multiple full scans of the IPv4 space carried out by
single IP addresses.
Partitioning source IPs: To get a better understanding of the
proportions of both IP addresses and traffic, we next partition source
IP addresses according to (i) their fan-out, the number of contacted
IP addresses, and (ii) their packet-to-IP ratio, i.e., the number of
packets divided by the fan-out. Figure 3b shows percentages of
unique source IP addresses, total packets, as well as the share of
packets received as part of bursts (recall our sampling from § 3.1) for
our entire dataset. At a high-level, we realized it was illuminating
148
Figure 4: Per source IP: Fraction of packets targeting client-
facing IPs, i.e., addresses exposed via forward DNS to serve
CDN content. The red dashed line indicates that packets
from a source are balanced over client-facing and operations
IP addresses.
to partition source addresses by their fan-out into three regimes:
“few,” “in-between,” and “almost all” destination IPs, and to partition
the packet-to-IP ratio into two regimes: “few,” and “more than few.”
We experimented with various cutoff points that would capture our
intent, and found that it did not matter w.r.t. the subsequent results,
and thus we chose values that would convey their ballpark nature.
We split source IP addresses by a fan-out (x-axis) exceeding 100
IPs, and exceeding 150K IPs. And we picked 10 for the cutoff for
the packet-to-IP ratio (y-axis).
Distribution of IP and packet counts: Figure 3b shows the num-
ber of source IP addresses and total packets sampled for each indi-
vidual tile. We find that the vast majority of source IP addresses falls
in the lower left tile, contacting only a small number of machines
(39% of source IPs in this tile hit a single telescope IP) and send a
small number of packets (41% of source IPs in this tile sent fewer
than 5 packets). While this lower left tile comprises the majority of
source IPs, these IPs are unlikely to be scanning the address space
and account only for 3% of packets. On the other end of the spec-
trum (top right tile), we see some 423 source IP addresses (about
0.001% of source IPs), yet accounting for some 28% of the overall
packets. We note that only a tiny fraction of packets from sources
contacting more than 100 telescope IPs are logged in a burst state.
Most burst packets are sent by sources hitting a small number of
machines with a large number of packets (top left tile), consistent
with DDoS attacks to flood individual machines.
4.2 CDN-targeted vs. CDN-agnostic
From the example machines shown in Figure 2, we know that
some traffic components target exclusively the client-facing IP, as
exposed via DNS to clients, while others target client-facing and
operations IP addresses equally. We next leverage this observation
to classify the behavior of source IP addresses. To this end, we
fan−out (destination IPs contacted per source IP)total packets logged per source IP1101001K10K178K110010K1M100M110010K1M5Mnumber of source IPsIPspkts% burst04080%2.3M(6%)1.3B(6.6%)16.9%IPspkts% burst04080%72.9K(0.2%)7.3B(37.8%)2.5%IPspkts% burst04080%423(0%)5.5B(28.1%)0.2%IPspkts% burst04080%33.6M(89.6%)583.0M(3%)6.3%IPspkts% burst04080%1.6M(4.2%)3.7B(18.9%)0.3%IPspkts% burst04080%1.5K(0%)1.1B(5.6%)0.1%source IP fan outlow(100  150K IPs)packet−to−IP ratiolow (10 pkts/IP)0.00.40.80.20.61.0frac. client−facing pktsfrac. source IPs0.00.40.80.00.40.8frac. client−facing pktsfrac. source IPs0.00.40.80.00.40.8frac. client−facing pktsfrac. source IPs0.00.40.80.20.61.0frac. client−facing pktsfrac. source IPs0.00.40.80.00.40.8frac. client−facing pktsfrac. source IPs0.00.40.80.00.40.8frac. client−facing pktsfrac. source IPssource IP fan outlow(100  150K IPs)packet−to−IP ratiolow (10 pkts/IP)IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Richter and Berger
Scan definition: In our work, a scan, by a given source address,
consists of sequence of probes that hit at least n distinct destination
IP addresses, and the interarrival times of the probes to any address