l 原因2：Socket error.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 使用命令display current-configuration检查对等体两端是否使能组播。
n 如果使能了组播，则请执行步骤4。
n 如果未使能组播，可执行multicast routing-enable命令使能组播解决告警
问题。
d. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了MSDP对等体，则请执行步骤5。
n 如果未配置MSDP对等体，可在MSDP视图下执行peer peer-address
connect-interface interface-type interface-number命令配置MSDP对等体解
决告警问题。
e. 请收集日志信息，并联系技术支持人员。
l 原因3：Receive invalid TLV.
a. 可能由于对等体两端的设备对MSDP协议的实现不一致。请收集日志信息，并
联系技术支持人员。
l 原因4：Receive notification TLV.
a. 确认对端设备是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
n 如果未执行，则请执行步骤2。
b. 在对端设备的MSDP视图下执行命令display this检查是否配置了MSDP对等
体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
文档版本 06 (2017-09-12) 华为专有和保密信息 520
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
c. 使用命令display interface brief命令检查对等体接口是否配置了shutdown命
令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集日志信息，并联系技术支持人员。
l 原因5：User operation.
a. 确认用户是否执行了用户视图下的reset msdp peer命令。
n 如果执行了，则等待对等体重新建立即可。
n 如果未执行，则请执行步骤2。
b. 在MSDP视图下使用命令display this检查是否配置了MSDP对等体。
n 如果配置了，则请执行步骤3。
n 如果未配置，可在MSDP视图下执行peer peer-address connect-interface
interface-type interface-number命令配置MSDP对等体解决告警问题。
c. 使用命令display interface brief命令检查接口是否配置了shutdown命令。
n 如果配置了，可在接口视图下执行undo shutdown命令解决告警问题。
n 如果未配置，则请执行步骤4。
d. 请收集日志信息，并联系技术支持人员。
----结束
53.2 MSDP/2/msdpBackwardTransition_clear
日志信息
MSDP/2/msdpBackwardTransition_clear:MSDP peer enter the established state.
(RemoteAddr=[RemoteAddr], FsmEstablishedTransitons=[EstablishedTransitons],
InstanceName=[InstanceName])
日志含义
MSDP peer进入Established状态。
日志参数
参数名称 参数含义
RemoteAddr MSDP对等体地址。
FsmEstablishedTransitons 转变到连接状态的次数。
InstanceName 实例名称。
可能原因
本端设备与对端设备建立MSDP peer连接，会报告警清除。
文档版本 06 (2017-09-12) 华为专有和保密信息 521
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
处理步骤
l 正常运行信息，无需处理。
----结束
53.3 MSDP/4/MSDP_RCV_ERR_PKT
日志信息
MSDP/4/MSDP_RCV_ERR_PKT:MSDP received an error packet and droppedit.
(VrfName=[VrfName], PktType=[PktType], ErrPktCnt=[ErrPktCnt],
LastPktPeerAddr=[LastPktPeerAddr], LastPktInvType=[LastPktInvType])
日志含义
MSDP收到错误报文后将其丢弃。
日志参数
参数名称 参数含义
VrfName 实例名称。
PktType 报文类型。
ErrPktCnt 错误报文计数。
LastPktPeerAddr 最后报文的对端地址。
LastPktInvType 最后报文的非法类型。
可能原因
MSDP收到错误报文后将其丢弃。
处理步骤
l 正常运行信息，无需处理。
----结束
53.4 MSDP/4/MSDP_SA_LIMIT
日志信息
MSDP/4/MSDP_SA_LIMIT:In the VPN instance, the number of (S, G) entries learned from
an MSDP peer exceeded the maximum number of entries allowed by the SA cache.
(InstanceName=[InstanceName], RPAddr=[RPAddr], SourceAddr=[SourceAddr],
GroupAddr=[GroupAddr], PeerAddr=[PeerAddr], MaxNum=[MaxNum])
文档版本 06 (2017-09-12) 华为专有和保密信息 522
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
日志含义
在VPN实例中，从MSDP对等体学到的（S，G）项数量超过了SA缓存的最大值。
日志参数
参数名称 参数含义
InstanceName VPN实例名。
RPAddr RP地址。
SourceAddr 源地址。
GroupAddr 组地址。
PeerAddr 对等体地址。
MaxNum 最大的数量。
可能原因
在VPN实例中，从MSDP对等体学到的（S，G）项数量超过了SA缓存的最大值。
处理步骤
l 正常运行信息，无需处理。
----结束
53.5 MSDP/6/PEER_NTFDWN
日志信息
MSDP/6/PEER_NTFDWN:In the VPN instance, a session with the peer was closed because a
Notification TLV was received from this peer. (VPNName=[VPNName],
PeerAddr=[PeerAddr], CpuUsage=[CpuUsage], RecvMsgCount=[RecvMsgCount],
SendMsgCount=[SendMsgCount], LastAliveTime=[LastAliveTime])
日志含义
在VPN实例中，因为从对等体收到一个Notification TLV，关闭一个与对等体的会话。
日志参数
参数名称 参数含义
VPNName VPN实例名。
文档版本 06 (2017-09-12) 华为专有和保密信息 523
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
参数名称 参数含义
PeerAddr 对等体IP地址。
CpuUsage CPU使用率。
RecvMsgCount 接收消息数。
SendMsgCount 发送消息数。
LastAliveTime 上次收到消息的时间。
可能原因
在VPN实例中，因为从对等体收到一个Notification TLV，关闭一个与对等体的会话。
处理步骤
l 正常运行信息，无需处理。
----结束
53.6 MSDP/6/PEER_TIMEOUT
日志信息
MSDP/6/PEER_TIMEOUT:In the VPN instance, a session with the peer was initiated.
(VPNName=[VPNName], PeerAddr=[PeerAddr], CpuUsage=[CpuUsage],
RecvMsgCount=[RecvMsgCount], SendMsgCount=[SendMsgCount],
LastAliveTime=[LastAliveTime])
日志含义
在VPN实例中，因为对等体的保留时间超时，关闭一个与对等体的会话。
日志参数
参数名称 参数含义
VPNName VPN实例名。
PeerAddr 对等体IP地址。
CpuUsage CPU使用率。
RecvMsgCount 接收消息数。
SendMsgCount 发送消息数。
LastAliveTime 上次收到消息的时间。
可能原因
在VPN实例中，因为对等体的保留时间超时，关闭一个与对等体的会话。
文档版本 06 (2017-09-12) 华为专有和保密信息 524
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
处理步骤
步骤1 执行ping命令检查线路是否正常连接。
l 如果是，则请执行步骤2。
l 如果不是，则请执行步骤3。
步骤2 执行display msdp peer-status确认对端配置是否改变。
步骤3 请收集日志信息，并联系技术支持人员。
----结束
53.7 MSDP/6/PEER_UP
日志信息
MSDP/6/PEER_UP:In the VPN instance, a session with the peer was initiated.
(VPNName=[VPNName], PeerAddr=[PeerAddr], CpuUsage=[CpuUsage],
RecvMsgCount=[RecvMsgCount], SendMsgCount=[SendMsgCount],
LastAliveTime=[LastAliveTime])
日志含义
在VPN实例中，启动一个与对等体的会话。
日志参数
参数名称 参数含义
VPNName VPN实例名。
PeerAddr 对等体IP地址。
CpuUsage CPU使用率。
RecvMsgCount 接收消息数。
SendMsgCount 发送消息数。
LastAliveTime 上次收到消息的时间。
可能原因
在VPN实例中，启动一个与对等体的会话。
处理步骤
l 正常运行信息，无需处理。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 525
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 54 MSTP
54
MSTP
关于本章
54.1 MSTP/2/MSTPLOG_NEW_ROOT
54.2 MSTP/4/MSTPLOG_PROEDGE_PORT_CHANGED
54.3 MSTP/4/MSTPLOG_PROLOOPBACK_DETECTED
54.4 MSTP/4/MSTPLOG_PROLOST_ROOT_PRIMARY
54.5 MSTP/4/MSTPLOG_PROPORT_BPDU_GUARDED
54.6 MSTP/4/MSTPLOG_PROPORT_LOOP_GUARDED
54.7 MSTP/4/MSTPLOG_PROPORT_ROOT_GUARDED
54.8 MSTP/4/MSTPLOG_PROROOT_CHANGED
54.9 MSTP/4/MSTPLOG_PROTC_GUARDED
文档版本 06 (2017-09-12) 华为专有和保密信息 526
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 54 MSTP
54.1 MSTP/2/MSTPLOG_NEW_ROOT
日志信息
MSTP/2/MSTPLOG_NEW_ROOT:This bridge changed to be the root bridge.
(ProcessID=[ProcessID], InstanceID=[InstanceID])
日志含义
生成树协议计算后，本桥选举成为拓扑中新的根桥。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
可能原因
原因1：本桥新加入一个网络拓扑。
原因2：本桥的优先级被提高。
原因3：原有拓扑中的根桥故障。
原因4：原有拓扑根桥的优先级被降低。
处理步骤
l 原因1：本桥新加入一个网络拓扑。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看本桥的优先级是否是
网络中最小的。
n 如果是，则请执行步骤2。
n 如果不是，则请执行步骤3。
b. 请检查本桥是否被规划为二层网络拓扑中的根桥。
n 如果是，则无需处理。
n 如果不是，则请执行步骤3。
c. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级，或者执行命令undo stp [ instance instance-id ]
priority将本桥优先级还原成缺省值。
l 原因2：本桥的优先级被提高。
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看本桥的优先级是否是
网络中最小的。
n 如果是，则请执行步骤2。
文档版本 06 (2017-09-12) 华为专有和保密信息 527
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 54 MSTP
n 如果不是，则请执行步骤3。
b. 请检查本桥是否被规划为二层网络拓扑中的根桥。
n 如果是，则无需处理。
n 如果不是，则请执行步骤3。
c. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级，或者执行命令undo stp [ instance instance-id ]
priority将本桥优先级还原成缺省值。
l 原因3：原有拓扑中的根桥故障。
a. 请正确修复原有网络拓扑中存在的故障，查看根桥是否恢复。
n 如果是，则无需处理。
n 如果不是，则请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因4：原有拓扑根桥的优先级被降低。
a. 请在原根桥设备上执行命令stp [ instance instance-id ] priority priority或者stp
[ instance instance-id ] root primary重新指定原根桥为根桥。查看问题是否解
决。如果未解决，则请执行步骤2。
b. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
54.2 MSTP/4/MSTPLOG_PROEDGE_PORT_CHANGED
日志信息
MSTP/4/MSTPLOG_PROEDGE_PORT_CHANGED:After the edge port receives a BPDU
packet, the port is no longer an edge port. (ProcessID=[ProcessID], PortID=[PortID],
IfIndex=[IfIndex], PortName=[PortName], PwName=[PwName])
日志含义
边缘端口收到BPDU报文后失去边缘端口属性。
日志参数
参数名称 参数含义
ProcessID MSTP进程ID。
PortID 端口ID。
IfIndex 端口索引。
PortName 端口名称。
PwName PW名称。
可能原因
原因1：MSTP进程内配置为边缘端口的指定端口收到了BPDU报文。
文档版本 06 (2017-09-12) 华为专有和保密信息 528
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 54 MSTP
处理步骤
l 原因1：MSTP进程内配置为边缘端口的指定端口收到了BPDU报文。
a. 请查看端口是否应该被规划为边缘端口。
n 如果应该被规划为边缘端口，则请执行步骤2。
n 如果不应该被规划为边缘端口，则请执行步骤3。
b. 请检查端口上BPDU报文的来源，确认是否有恶意攻击。
n 如果有恶意攻击，则请执行步骤4。
n 如果没有恶意攻击，则请执行步骤3。
c. 在接口视图下，执行命令undo stp edged-port和undo shutdown去除边缘端口
配置，重新启用端口。查看问题是否解决。如果未解决，则请执行步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
54.3 MSTP/4/MSTPLOG_PROLOOPBACK_DETECTED
日志信息