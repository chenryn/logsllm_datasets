This	
  excepTon	
  may	
  be	
  expected	
  and	
  handled.	
eax=c78ac500	
  ebx=0d42cf98	
  ecx=08708f98	
  edx=0726a1b4	
esi=06d48f98	
  edi=08708f98 
eip=635d1a83	
  esp=05438670	
  ebp=05438738	
  iopl=0	
  nv	
  up	
  ei	
  pl	
  nz	
na	
  po	
  nc 
cs=001b	
  ss=0023	
  ds=0023	
  es=0023	
  fs=003b	
  gs=0000	
eﬂ=00010202	
MSHTML!CDispNode::InsertSiblingNode+0x32: 
635d1a83	
  8b4f1c	
  mov	
  ecx,dword	
  ptr	
  [edi+1Ch]	
  ds:
0023:08708}4=???????? 
DOM	
  Tree	
  and	
  Command 
•  Idea 
– DOM	
  tree	
  +	
  execCommand	
•  StateFuzzer	
– CBatchParentUndoUnit	
  Double	
  Free 
ISSUE	
  #12	
IE	
  11	
  Security	
  Bug 
First	
  chance	
  excepTons	
  are	
  reported	
  before	
  any	
  excepTon	
  handling. 
This	
  excepTon	
  may	
  be	
  expected	
  and	
  handled.	
eax=00000001	
  ebx=11692ﬀ0	
  ecx=0fa35fd8	
  edx=00000002	
esi=054b8f64	
  edi=00000000 
eip=652f5631	
  esp=054b8f48	
  ebp=054b8f74	
  iopl=0	
  nv	
  up	
  ei	
  pl	
  nz	
na	
  pe	
  nc 
cs=001b	
  ss=0023	
  ds=0023	
  es=0023	
  fs=003b	
  gs=0000	
eﬂ=00010206	
MSHTML!CImplPtrAry::ReleaseAll+0x41: 
652f5631	
  8b01	
  mov	
  eax,dword	
  ptr	
  [ecx]	
  ds:
0023:0fa35fd8=???????? 
DOM	
  Tree,	
  Style	
  and	
  Clear 
•  Idea 
– DOM	
  tree	
  +	
  style	
  +	
  clear	
•  StateFuzzer	
– COpTonElement	
  UAF 
ISSUE	
  #13	
IE	
  11	
  Security	
  Bug 
(16d8.1d68):	
  Access	
  violaTon	
  -­‐	
  code	
  c0000005	
  (ﬁrst	
  chance) 
First	
  chance	
  excepTons	
  are	
  reported	
  before	
  any	
  excepTon	
  handling. 
This	
  excepTon	
  may	
  be	
  expected	
  and	
  handled.	
eax=0305b778	
  ebx=0305ba28	
  ecx=42424242	
  edx=00000000	
esi=42424242	
  edi=00000000 
eip=65b20405	
  esp=0305b75c	
  ebp=0305b8a8	
  iopl=0	
  nv	
  up	
  ei	
  pl	
  nz	
na	
  pe	
  nc 
cs=001b	
  ss=0023	
  ds=0023	
  es=0023	
  fs=003b	
  gs=0000	
eﬂ=00010206	
MSHTML!CTreeNode::Parent: 
65b20405	
  8b4104	
  mov	
  eax,dword	
  ptr	
  [ecx+4]	
  ds:
0023:42424246=???????? 
Event	
  Handle	
  and	
  Command 
•  Idea 
– Event	
  +	
  execCommand	
•  StateFuzzer	
– HTMLOpTonsCollecTon	
  UAF 
ISSUE	
  #14	
Chrome	
  33	
  Security	
  Bug 
Caught	
  a	
  Read	
  Access	
  ViolaLon	
  in	
  process	
  11188	
  at	
  2014-­‐03-­‐30	
  09:08:20	
  with	
  a	
  crash	
  hash	
  of	
  26FC3609.74C960B2	
Registers:	
  eax	
  =	
  0x24F09657	
  ebx	
  =	
  0x00000000	
  ecx	
  =	
  0x5796EF20	
  (RW-­‐)	
  edx	
  =	
  0x57805BA0	
  (RW-­‐)	
  esi	
  =	
  0x57805BCC	
  (RW-­‐)	
  edi	
  =	
  0x00000000	
  ebp	
  =	
  0x002EA56C	
  (RW-­‐)	
  esp	
  =	
  0x002EA550	
  (RW-­‐)	
  eip	
  =	
  0x5D46056F	
  (R-­‐X)	
  -­‐	
  chrome_child!WebCore::Node::removedLastRef	
Code:	
  0x5D46056F	
  -­‐	
  mov	
  edx,	
  [eax+28h]	
  0x5D460572	
  -­‐	
  push	
  1	
  0x5D460574	
  -­‐	
  call	
  edx	
  0x5D460576	
  -­‐	
  pop	
  esi	
  0x5D460577	
  -­‐	
  ret	
  0x5D460578	
  -­‐	
  push	
  ebp	
  0x5D460579	
  -­‐	
  mov	
  ebp,	
  esp	
  0x5D46057B	
  -­‐	
  and	
  esp,	
  -­‐8	
Call	
  Stack:	
  0x5D46056F	
  -­‐	
  chrome_child!WebCore::Node::removedLastRef	
  0x5D4894D1	
  -­‐	
  chrome_child!WebCore::LiveNodeListBase::~LiveNodeListBase	
  0x5D48B5D1	
  -­‐	
  chrome_child!WebCore::HTMLOpLonsCollecLon::`scalar	
  deleLng	
  destructor'	
  0x5D585725	
  -­‐	
  chrome_child!WebCore::HTMLInputElement::hasValidDataListOpLons	
  0x5D8CDECA	
  -­‐	
  chrome_child!WebCore::TextFieldInputType::listArributeTargetChanged	
  0x5D586D10	
  -­‐	
  chrome_child!WebCore::HTMLInputElement::parseArribute	
  0x5D45CAE5	
  -­‐	
  chrome_child!WebCore::Element::arributeChanged	
  0x5D722E70	
  -­‐	
  chrome_child!WebCore::Element::cloneArributesFromElement	
  0x5D722E7B	
  -­‐	
  chrome_child!WebCore::Element::cloneDataFromElement	
  0x5D725705	
  -­‐	
  chrome_child!WebCore::Document::importNode 
ISSUE	
  #15	
Chrome	
  34	
  Security	
  Bug 
Caught	
  a	
  Read	
  Access	
  ViolaLon	
  in	
  process	
  7892	
  at	
  2014-­‐04-­‐28	
  05:24:54	
  with	
  a	
  crash	
  hash	
  of	
  8DD1D3D5.D12F396B	
Registers:	
  eax	
  =	
  0x093E2FC0	
  (RW-­‐)	
  ebx	
  =	
  0x002AFA08	
  (RW-­‐)	
  ecx	
  =	
  0x093E2FC0	
  (RW-­‐)	
  edx	
  =	
  0x00000000	
  esi	
  =	
  0x055F4870	
  (RW-­‐)	
  edi	
  =	
  0x544F496C	
  ebp	
  =	
  0x002AF8D4	
  (RW-­‐)	
  esp	
  =	
  0x002AF8B0	
  (RW-­‐)	
  eip	
  =	
  0x66121AD1	
  (R-­‐X)	
  -­‐	
  chrome!TaskManagerModel::RemoveResource	
Code:	
  0x66121AD1	
  -­‐	
  mov	
  ecx,	
  [edi+4]	
  0x66121AD4	
  -­‐	
  mov	
  eax,	
  [edi]	
  0x66121AD6	
  -­‐	
  jmp	
  66121ae2h	
  0x66121AD8	
  -­‐	
  mov	
  edx,	
  [ebp+8]	
  0x66121ADB	
  -­‐	
  cmp	
  [eax],	
  edx	
  0x66121ADD	
  -­‐	
  jz	
  66121ae6h	
  0x66121ADF	
  -­‐	
  add	
  eax,	
  4	
  0x66121AE2	
  -­‐	
  cmp	
  eax,	
  ecx	
Call	
  Stack:	
  0x66121AD1	
  -­‐	
  chrome!TaskManagerModel::RemoveResource	
  0x661AF65D	
  -­‐	
  chrome!task_manager::WorkerResourceProvider::BrowserChildProcessHostDisconnected	
  0x65D6AF4C	
  -­‐	
  chrome!content::`anonymous	
  namespace'::NoLfyProcessHostDisconnected	
  0x65B1A369	
  -­‐	
  chrome!base::internal::Invoker,void	
  *	
  __cdecl(base::FilePath	
  const	
  &),void	
  __cdecl(base::FilePath)>,void	
  *	
  __cdecl(base::FilePath	
  const	
  &)>::Run	
ISSUE	
  #16	
Chrome	
  36	
  Bug 
Caught	
  a	
  Read	
  Access	
  ViolaLon	
  in	
  process	
  2208	
  at	
  2014-­‐07-­‐23	
  13:49:59	
  with	
  a	
  crash	
  hash	
  of	
  95BCF056.D5DD4358	
Registers:	
  eax	
  =	
  0x001BDCD0	
  (RW-­‐)	
  ebx	
  =	
  0x2EF00DC0	
  (RW-­‐)	
  ecx	
  =	
  0x00000344	
  edx	
  =	
  0x00000000	
  esi	
  =	
  0x2EF00DC0	
  (RW-­‐)	
  edi	
  =	
  0x00000344	
  ebp	
  =	
  0x001BDC94	
  (RW-­‐)	
  esp	
  =	
  0x001BDC80	
  (RW-­‐)	
  eip	
  =	
  0x62448549	
  (R-­‐X)	
  -­‐	
  chrome_child!WTF::HashTable	
Code:	
  0x62448549	
  -­‐	
  cmp	
  dword	
  ptr	
  [edi],	
  0	
  0x6244854C	
  -­‐	
  jnz	
  62448555h	
  0x6244854E	
  -­‐	
  push	
  0	
  0x62448550	
  -­‐	
  call	
  chrome_child!WTF::HashTable	
  0x62448555	
  -­‐	
  mov	
  ecx,	
  [ebp+0ch]	
  0x62448558	
  -­‐	
  xor	
  eax,	
  eax	
  0x6244855A	
  -­‐	
  mov	
  ebx,	
  [edi+4]	
  0x6244855D	
  -­‐	
  dec	
  ebx	
Call	
  Stack:	
  0x62448549	
  -­‐	
  chrome_child!WTF::HashTable	
  0x629716E6	
  -­‐	
  chrome_child!WebCore::Range::Range	
  0x62B2259C	
  -­‐	
  chrome_child!WebCore::VisibleSelecLon::ﬁrstRange	
  0x62A70E93	
  -­‐	
  chrome_child!WebCore::FrameSelecLon::respondToNodeModiﬁcaLon	
  0x626736CC	
  -­‐	
  chrome_child!WebCore::FrameSelecLon::nodeWillBeRemoved	
  0x62724F57	
  -­‐	
  chrome_child!WebCore::Document::nodeWillBeRemoved	
  0x62724C99	
  -­‐	
  chrome_child!WebCore::ContainerNode::willRemoveChild	
  0x62724AC0	
  -­‐	
  chrome_child!WebCore::ContainerNode::removeChild	
  0x62B2AE94	
  -­‐	
  chrome_child!WebCore::RemoveNodeCommand::doApply	
ISSUE	
  #17	
Chrome	
  34	
  Bug 
Caught	
  a	
  Write	
  Access	
  ViolaLon	
  in	
  process	
  2856	
  at	
  2014-­‐05-­‐17	
  04:23:24	
  with	
  a	
  crash	
  hash	
  of	
  8EAE6D7E.2EB05FCC	
Registers:	
  eax	
  =	
  0x00000010	
  ebx	
  =	
  0x0000000C	
  ecx	
  =	
  0x0000000C	
  edx	
  =	
  0x651DB83B	
  (R-­‐X)	
  -­‐	
  chrome_child!blink::WebMediaPlayerClientImpl::videoDecodedByteCount	
  esi	
  =	
  0x00000010	
  edi	
  =	
  0x0000000C	
  ebp	
  =	
  0x002CEC38	
  (RW-­‐)	
  esp	
  =	
  0x002CEC24	
  (RW-­‐)	
  eip	
  =	
  0x773377A2	
  (R-­‐X)	
  -­‐	
  ntdll!RtlEnterCriLcalSecLon	
Code:	
  0x773377A2	
  -­‐	
  lock	
  btr	
  dword	
  ptr	
  [eax],	
  0	
  0x773377A7	
  -­‐	
  jnb	
  77345aa8h	
  0x773377AD	
  -­‐	
  mov	
  eax,	
  fs:[18h]	
  0x773377B3	
  -­‐	
  mov	
  ecx,	
  [eax+24h]	
  0x773377B6	
  -­‐	
  mov	
  [edi+0ch],	
  ecx	
  0x773377B9	
  -­‐	
  mov	
  dword	
  ptr	
  [edi+8],	
  1	
  0x773377C0	
  -­‐	
  pop	
  edi	
  0x773377C1	
  -­‐	
  xor	
  eax,	
  eax	
Call	