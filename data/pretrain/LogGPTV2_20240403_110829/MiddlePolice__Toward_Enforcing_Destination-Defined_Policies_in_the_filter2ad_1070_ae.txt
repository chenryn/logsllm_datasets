Yes
No
Yes
Unrelated
Related
None
Per-AS
Redesign
None
Victim-chosen
None
None
Per-compute
New header
IPv6 upgrade
the Internet
Table 4. Property comparison with other research proposals. “O(N ) states” means that the number of states maintained by a
router increases with the number of attackers. “Cryptography” means that a router needs to support cryptography operation,
e.g., MAC computation. “Puzzle” means that the mechanism requires computational puzzle distribution.
(a) The NaturalShare Policy
Dp
Thdrop
slr
2s
Flat
1.1
Shrew 1.3
8s
0.17
0.65
0.03
0.78
0.77
0.1
0.39
1.0
β
0.5
1.1
1.2
0.9
0.78
0.80
(b) The PerSenderFairshare Policy
Dp
Thdrop
slr
Flat
Shrew
Reactive
2s
1.0
1.1
1.0
8s
1.1
0.98
0.99
0.03
1.0
0.72
1.0
0.1
0.69
0.83
0.94
β
0.5
0.85
1.0
1.0
0.9
0.81
0.98
1.0
Table 5.
diﬀerent parameter settings.
[Simulation] Clients’ average window size under
Under the NaturalShare policy, the shorter Dp produces a
larger window size for legitimate clients since each sender’s
WR is updated per-period so that a smaller Dp causes faster
cut in attackers’ window sizes. For Thdrop
, a smaller value
slows down the clients’ recovery whereas a larger value al-
lows larger window sizes for attackers. Both will reduce the
clients’ share. A larger β has negative eﬀects as it takes
more time for the clients to recover to a low LLR.
slr
With the PerSenderFairshare policy, MiddlePolice’s perfor-
mance is more consistent under diﬀerent parameter settings.
The most sensitive parameter is Thdrop
slr because it determines
whether one source can send best-eﬀort traﬃc.
9. RELATED WORK
In this section, we brieﬂy discuss previous academic work.
Previous research approaches can be generally categorized
into capability-based approaches (SIFF [50], TVA [51], Net-
Fence [35]), ﬁltering-based approaches (Traceback [44, 46],
AITF [12], Pushback [26,37], StopIt [34]), overlay-based ap-
proaches (Phalanx [18], SOS [28], Mayday [7]), deployment-
friendly approaches (Mirage [38], CRAFT [29]), approaches
based on new Internet architectures (SCION [52], SIBRA [13],
XIA [40], AIP [8]), and others (SpeakUp [49], SDN-based [19,
45], CDN-based [22]). We summarize the properties of one
or two approaches from each category in Table 4. The com-
parison shows that MiddlePolice requires the least deploy-
ment (no source upgrades, no additional router support and
no deployment from unrelated ASes) while providing the
strongest property (enforcing destination-chosen policies).
10. DISCUSSION
We brieﬂy cover some aspects not previously discussed.
mboxes Mapping. MiddlePolice can leverage the end-user
mapping [15] to achieve better mbox assignment, such as
redirecting clients to the nearest mbox, mapping clients ac-
cording to their ASes, and load balancing.
Incorporating Endhost Defense. MiddlePolice can co-
operate with the DDoS defense mechanism deployed, if any,
on the victim. For instance, via botnet identiﬁcation [27,36],
the victim can instruct the mboxes to block botnet traﬃc
early at upstream so as to save more downstream bandwidth
for clients. Such beneﬁts are possible because the policies
enforced by MiddlePolice are completely destination-driven.
Additional Monetary Cost. As discussed in 8.2.1, Mid-
dlePolice introduces small computational overhead. Com-
pared with basic DDoS-as-a-service solutions, MiddlePolice
oﬀers additional functionalities such as enabling destination-
chosen policies and ﬁltering bypassing traﬃc. In a competi-
tive marketplace, service’s price (the monetary cost) should
scale with the cost of providing that service, which, in the
case of MiddlePolice, is low.
11. CONCLUSION
This paper presents MiddlePolice, a DDoS defense system
that is as deployable as cloud-based systems and has the
same destination-based control of capability-based systems.
In its design, MiddlePolice explicitly addresses three chal-
lenges. First, MiddlePolice designs a capability mechanism
that requires only limited deployment from the cloud, rather
than widespread Internet upgrades. Second, MiddlePolice is
fully destination-driven, addressing the shortcomings of the
existing capability-based systems that can work only with a
single fairness regime. Finally, MiddlePolice addresses the
traﬃc-bypass vulnerability of the existing cloud-based solu-
tions. Extensive evaluations on the Internet, testbed and
large scale simulations validate MiddlePolice’s deployability
and eﬀectiveness in enforcing detestation-chosen policies.
12. ACKNOWLEDGMENTS
We thank the anonymous CCS reviewers for their valu-
able feedback. This material is based upon work partially
supported by NSF under Contract Nos. CNS-0953600, CNS-
1505790 and CNS-1518741. The views and conclusions con-
tained here are those of the authors and should not be in-
terpreted as necessarily representing the oﬃcial policies or
endorsements, either express or implied, of NSF, the Univer-
sity of Illinois, or the U.S. Government or any of its agencies.
13. REFERENCES
[1] PlanetLab. https://www.planet-lab.org/. WebCite archive.
[2] AT&T Denial of Service Protection.
http://soc.att.com/1IIlUec, Accessed in 2016. WebCite
archive.
[3] NS-3: a Discrete-Event Network Simulator.
http://www.nsnam.org/, Accessed in 2016.
[4] AS Relationships – CIDR Report.
http://www.caida.org/data/as-relationships/, Accessed in
Dec 2015. WebCite archive.
[5] AS Names - CIDR Report.
http://www.cidr-report.org/as2.0/autnums.html, Dec 2015.
[6] Akdemir, K., Dixon, M., Feghali, W., Fay, P., Gopal,
V., Guilford, J., Ozturk, E., Wolrich, G., and Zohar,
R. Breakthrough AES Performance with Intel R(cid:13) AES New
Instructions. Intel white paper (2010).
[7] Andersen, D. G. Mayday: Distributed Filtering for
Internet Services. In USITS (2003).
[8] Andersen, D. G., Balakrishnan, H., Feamster, N.,
Koponen, T., Moon, D., and Shenker, S. Accountable
Internet Protocol (AIP). In ACM SIGCOMM (2008).
[9] Anderson, T., Roscoe, T., and Wetherall, D.
Preventing Internet Denial-of-Service with Capabilities.
ACM SIGCOMM (2004).
[10] Appenzeller, G., Keslassy, I., and McKeown, N. Sizing
Router Buﬀers. ACM SIGCOMM, 2004.
[11] Argyraki, K., and Cheriton, D. Network Capabilities:
The good, the Bad and the Ugly. ACM HotNets-IV (2005).
[12] Argyraki, K. J., and Cheriton, D. R. Active Internet
Traﬃc Filtering: Real-Time Response to Denial-of-Service
Attacks. In USENIX ATC (2005).
[13] Basescu, C., Reischuk, R. M., Szalachowski, P.,
Perrig, A., Zhang, Y., Hsiao, H.-C., Kubota, A., and
Urakawa, J. SIBRA: Scalable Internet Bandwidth
Reservation Architecture. NDSS (2016).
[14] Briscoe, B. Tunnelling of Explicit Congestion Notiﬁcation.
RFC 6040, 2010.
[15] Chen, F., Sitaraman, R. K., and Torres, M. End-User
Mapping: Next Generation Request Routing for Content
Delivery. In ACM SIGCOMM (2015).
[16] Chiu, D.-M., and Jain, R. Analysis of the Increase and
Decrease Algorithms for Congestion Avoidance in
Computer Networks. Computer Networks and ISDN
systems (1989).
[17] Dimitropoulos, X., Krioukov, D., Fomenkov, M.,
Huffaker, B., Hyun, Y., Riley, G., et al. AS
Relationships: Inference and Validation. ACM SIGCOMM
CCR (2007).
[18] Dixon, C., Anderson, T. E., and Krishnamurthy, A.
Phalanx: Withstanding Multimillion-Node Botnets. In
NSDI (2008).
[19] Fayaz, S. K., Tobioka, Y., Sekar, V., and Bailey, M.
Bohatei: Flexible and Elastic DDoS Defense. In USENIX
Security Symposium (2015).
[20] Gao, L., Griffin, T. G., and Rexford, J. Inherently Safe
Backup Routing with BGP. In IEEE INFOCOM (2001).
[21] Gilad, Y., and Herzberg, A. LOT: a Defense against IP
Spooﬁng and Flooding Attacks. ACM TISSEC (2012).
[22] Gilad, Y., Herzberg, A., Sudkovitch, M., and
Goberman, M. CDN-on-Demand: An Aﬀordable DDoS
Defense via Untrusted Clouds. NDSS (2016).
[23] Goldberg, S., Schapira, M., Hummon, P., and
Rexford, J. How Secure are Secure Interdomain Routing
Protocols. ACM SIGCOMM CCR (2011).
[24] Gueron, S. Intel Advanced Encryption Standard (AES)
Instructions Set. White Paper, Intel (2010).
[25] Herbert, T. UDP Encapsulation in Linux. In The
Technical Conference on Linux Networking (2015).
[26] Ioannidis, J., and Bellovin, S. M. Implementing
Pushback: Router-Based Defense Against DDoS Attacks.
USENIX NSDI (2002).
[27] Karasaridis, A., Rexroad, B., and Hoeflin, D.
Wide-scale Botnet Detection and Characterization. In
USENIX HotBots (2007).
[28] Keromytis, A. D., Misra, V., and Rubenstein, D. SOS:
Secure Overlay Services. ACM SIGCOMM (2002).
[29] Kim, D., Chiang, J. T., Hu, Y.-C., Perrig, A., and
Kumar, P. CRAFT: A New Secure Congestion Control
Architecture. In ACM CCS (2010).
[30] K¨uhrer, M., Hupperich, T., Rossow, C., and Holz, T.
Exit from Hell? Reducing the Impact of Ampliﬁcation
DDoS Attacks. In USENIX Security Symposium (2014).
[31] Kuzmanovic, A., and Knightly, E. W. Low-Rate
TCP-Targeted Denial of Service Attacks: the Shrew vs. the
Mice and Elephants. In ACM SIGCOMM (2003).
[32] Liang, J., Jiang, J., Duan, H., Li, K., Wan, T., and Wu,
J. When HTTPS Meets CDN: A Case of Authentication in
Delegated Service. In IEEE S&P (2014).
[33] Liu, X., Li, A., Yang, X., and Wetherall, D. Passport:
Secure and Adoptable Source Authentication. In USENIX
NSDI (2008).
[34] Liu, X., Yang, X., and Lu, Y. To Filter or to Authorize:
Network-Layer DoS Defense Against Multimillion-node
Botnets. In ACM SIGCOMM (2008).
[35] Liu, X., Yang, X., and Xia, Y. NetFence: Preventing
Internet Denial of Service from Inside Out. ACM
SIGCOMM (2011).
[36] Livadas, C., Walsh, R., Lapsley, D., and Strayer,
W. T. Using Machine Learning Technliques to Identify
Botnet Traﬃc. In IEEE LCN (2006).
[37] Mahajan, R., Bellovin, S. M., Floyd, S., Ioannidis, J.,
Paxson, V., and Shenker, S. Controlling High Bandwidth
Aggregates in the Network. ACM SIGCOMM (2002).
[38] Mittal, P., Kim, D., Hu, Y.-C., and Caesar, M. Mirage:
Towards Deployable DDoS Defense for Web Applications.
arXiv preprint arXiv:1110.1060 (2011).
[39] Miu, T. T., Hui, A. K., Lee, W., Luo, D. X., Chung,
A. K., and Wong, J. W. Universal DDoS Mitigation
Bypass. Black Hat USA (2013).
[40] Naylor, D., et al. XIA: Architecting a More Trustworthy
and Evolvable Internet. ACM SIGCOMM (2014).
[41] Networks, A. Worldwide Infrastructure Security Report,
Volume IX. https://www.arbornetworks.com/images/
documents/WISR2016 EN Web.pdf, 2016.
[42] Parno, B., Wendlandt, D., Shi, E., Perrig, A., Maggs,
B., and Hu, Y.-C. Portcullis: Protecting Connection Setup
from Denial-of-Capability Attacks. ACM SIGCOMM
(2007).
[43] Peter, S., Javed, U., Zhang, Q., Woos, D., Anderson,
T., and Krishnamurthy, A. One Tunnel is (often)
Enough. In ACM SIGCOMM (2014).
[44] Savage, S., Wetherall, D., Karlin, A., and Anderson,
T. Practical Network Support for IP Traceback. ACM
SIGCOMM (2000).
[45] Shin, S., Porras, P., Yegneswaran, V., Fong, M., Gu,
G., and Tyson, M. FRESCO: Modular Composable
Security Services for Software-Deﬁned Detworks. In NDSS
(2013).
[46] Song, D. X., and Perrig, A. Advanced and Authenticated
Marking Schemes for IP Traceback. In INFOCOM (2001).
[47] Sundaresan, S., De Donato, W., Feamster, N.,
Teixeira, R., Crawford, S., and Pescap`e, A. Broadband
Internet Performance: a View from the Gateway. In ACM
SIGCOMM (2011).
[48] Vissers, T., Van Goethem, T., Joosen, W., and
Nikiforakis, N. Maneuvering Around Clouds: Bypassing
Cloud-based Security Providers. In ACM CCS (2015).
[49] Walfish, M., Vutukuru, M., Balakrishnan, H.,
Karger, D., and Shenker, S. DDoS Defense by Oﬀense.
In ACM SIGCOMM (2006).
[50] Yaar, A., Perrig, A., and Song, D. SIFF: A Stateless
Internet Flow Filter to Mitigate DDoS Flooding Attacks. In
IEEE S&P (2004).
[51] Yang, X., Wetherall, D., and Anderson, T. A
DoS-limiting Network Architecture. In ACM SIGCOMM
(2005).
[52] Zhang, X., Hsiao, H.-C., Hasker, G., Chan, H., Perrig,
A., and Andersen, D. G. SCION: Scalability, Control, and
Isolation on Next-Generation Networks. In S&P (2011).