recovery rate) of 90% while only using documents similar to
the encrypted documents. Previous attacks could only achieve
equivalent results by assuming that attacker knows a signiﬁ-
cant part of the encrypted documents (from 20% for Black-
stone et al. [1] to 70% for Cash et al. [3]). Our attack provides
devastating results while avoiding the strong assumption that
the attacker knows a part of the encrypted documents. Unlike
the existing attacks we assume few known queries (around
10 known queries in our experiments over different datasets
of varying size) rather than knowing the plaintext of a sub-
stantial part of the encrypted documents. We argue that it is
more realistic to obtain few known queries (e.g. using active
attacks) than to obtain a part of the documents indexed. Thus,
the reﬁned score attack is more easily performed while previ-
ous attacks had a limited number of realistic use cases. One
conclusion of our experiments is that the more knowledge the
adversary has, the better our reﬁned score attack performs.
Despite the simplicity of this statement, it was not observed in
previous attacks. This sensitivity to the information amount
highlights an optimized adversary knowledge use as opposed
to a relative underutilization of this knowledge by some exist-
ing attacks. We also showed that the existing countermeasures
(padding and obfuscation) can effectively mitigate the reﬁned
score attack. Finally, we highlighted that the distribution of
observed and known queries impacts the accuracy of our at-
tack. It implies that, if the real query distribution is different
from the uniform distribution commonly used in the litera-
ture, the reﬁned score attack can be even more devastating.
Considering the results presented in this article, SSE should
no longer be used without countermeasures.
References
[1] Laura Blackstone, Seny Kamara, and Tarik Moataz. Re-
In Network and Dis-
visiting leakage abuse attacks.
tributed System Security Symposium (NDSS), 2020.
[2] Raphael Bost and Pierre-Alain Fouque. Thwarting leak-
age abuse attacks against searchable encryption – a
formal approach and applications to database padding.
Cryptology ePrint Archive, Report 2017/1060, 2017.
https://eprint.iacr.org/2017/1060.
[3] David Cash, Paul Grubbs, Jason Perry, and Thomas Ris-
tenpart. Leakage-abuse attacks against searchable en-
In Proceedings of the 22nd ACM SIGSAC
cryption.
Conference on Computer and Communications Security,
CCS ’15, page 668–679, New York, NY, USA, 2015.
Association for Computing Machinery.
[4] G. Chen, T. Lai, M. K. Reiter, and Y. Zhang. Differen-
tially private access patterns for searchable symmetric
encryption. In IEEE INFOCOM 2018 - IEEE Confer-
ence on Computer Communications, pages 810–818,
2018.
[5] Prabhakar Raghavan Christopher D. Manning and Hin-
Introduction to Information Retrieval,
rich Schütze.
chapter 17, pages 377–401. Cambridge University Press,
2008.
USENIX Association
30th USENIX Security Symposium    155
[6] Andrew Clark and Ed Dawson. A parallel genetic algo-
rithm for cryptanalysis of the polyalphabetic substitution
cipher. Cryptologia, 21(2):129–138, 1997.
[7] Reza Curtmola, Juan Garay, Seny Kamara, and Rafail
Ostrovsky. Searchable symmetric encryption: Improved
deﬁnitions and efﬁcient constructions. In Proceedings
of the 13th ACM Conference on Computer and Com-
munications Security, CCS ’06, page 79–88, New York,
NY, USA, 2006. Association for Computing Machinery.
[8] Ioannis Demertzis, Dimitrios Papadopoulos, Charalam-
pos Papamanthou, and Saurabh Shintre. SEAL: Attack
mitigation for encrypted databases via adjustable leak-
age. In 29th USENIX Security Symposium (USENIX
Security 20), pages 2433–2450, 2020.
[9] Amrapali Dhavare, Richard M Low, and Mark Stamp.
Efﬁcient cryptanalysis of homophonic substitution ci-
phers. Cryptologia, 37(3):250–281, 2013.
[10] William S Forsyth and Reihaneh Safavi-Naini. Auto-
mated cryptanalysis of substitution ciphers. Cryptologia,
17(4):407–418, 1993.
[11] Helen Fouche Gaines. Cryptanalysis: Study of ciphers
and their solution, 1956.
[12] Matthieu Giraud, Alexandre Anzala-Yamajako, Olivier
Bernard, and Pascal Lafourcade.
Practical passive
leakage-abuse attacks against symmetric searchable en-
cryption. In SECRYPT, 2017.
[13] Paul Grubbs, Marie-Sarah Lacharité, Brice Minaud, and
Kenneth G Paterson. Pump up the volume: Practical
database reconstruction from volume leakage on range
In Proceedings of the 2018 ACM SIGSAC
queries.
Conference on Computer and Communications Secu-
rity, pages 315–331, 2018.
[14] Paul Grubbs, Kevin Sekniqi, Vincent Bindschaedler,
Muhammad Naveed, and Thomas Ristenpart. Leakage-
abuse attacks against order-revealing encryption.
In
2017 IEEE Symposium on Security and Privacy (S&P),
pages 655–672. IEEE, 2017.
[15] Mohammad Saiful Islam, Mehmet Kuzu, and Murat
Kantarcioglu. Access pattern disclosure on search-
able encryption: Ramiﬁcation, attack and mitigation. In
Network and Distributed System Security Symposium
(NDSS), 2012.
[16] Georgios Kellaris, George Kollios, Kobbi Nissim, and
Adam O’neill. Generic attacks on secure outsourced
databases. In Proceedings of the 2016 ACM SIGSAC
Conference on Computer and Communications Security,
pages 1329–1340, 2016.
[17] Bryan Klimt and Yiming Yang. Introducing the enron
corpus. In CEAS, 2004.
[18] Evgenios M Kornaropoulos, Charalampos Papaman-
thou, and Roberto Tamassia. The state of the uniform:
Attacks on encrypted databases beyond the uniform
IACR Cryptology ePrint Archive,
query distribution.
2019:441, 2019.
[19] Marie-Sarah Lacharité, Brice Minaud, and Kenneth G
Paterson. Improved reconstruction attacks on encrypted
In 2018 IEEE Sym-
data using range query leakage.
posium on Security and Privacy (SP), pages 297–314.
IEEE, 2018.
[20] Chang Liu, Liehuang Zhu, Mingzhong Wang, and Yu-
An Tan. Search pattern leakage in searchable encryption:
Attacks and new construction. Information Sciences,
265:176–188, 2014.
[21] Edward Loper and Steven Bird. Nltk: the natural lan-
guage toolkit. arXiv preprint cs/0205028, 2002.
[22] Jianting Ning, Jia Xu, Kaitai Liang, Fan Zhang, and
Ee-Chien Chang. Passive attacks against searchable en-
cryption. IEEE Transactions on Information Forensics
and Security, 14(3):789–802, 2018.
[23] Simon Oya and Florian Kerschbaum. Hiding the access
pattern is not enough: Exploiting search pattern leakage
In 30th USENIX Security
in searchable encryption.
Symposium (USENIX Security 21), 2021.
[24] Sarvar Patel, Giuseppe Persiano, and Kevin Yeo. Lower
bounds for encrypted multi-maps and searchable en-
cryption in the leakage cell probe model. In Annual
International Cryptology Conference, pages 433–463.
Springer, 2020.
[25] Sarvar Patel, Giuseppe Persiano, Kevin Yeo, and Moti
Yung. Mitigating leakage in secure cloud-hosted data
structures: volume-hiding for multi-maps via hashing.
In Proceedings of the 2019 ACM SIGSAC Conference on
Computer and Communications Security, pages 79–93,
2019.
[26] Jeffrey Pennington, Richard Socher, and Christopher D
Manning. Glove: Global vectors for word representa-
tion. In Proceedings of the 2014 conference on empiri-
cal methods in natural language processing (EMNLP),
pages 1532–1543, 2014.
[27] Martin F Porter. An algorithm for sufﬁx stripping. Pro-
gram, 1980.
[28] David Pouliot and Charles V Wright. The shadow
nemesis: Inference attacks on efﬁciently deployable,
In Proceedings of
efﬁciently searchable encryption.
156    30th USENIX Security Symposium
USENIX Association
the 2016 ACM SIGSAC conference on computer and
communications security, pages 1341–1352, 2016.
[29] Dawn X Song, David Wagner, and Adrian Perrig. Prac-
tical techniques for searches on encrypted data. In Pro-
ceeding 2000 IEEE Symposium on Security and Privacy.
S&P 2000, pages 44–55. IEEE, 2000.
[30] Richard Spillman, Mark Janssen, Bob Nelson, and Mar-
tin Kepner. Use of a genetic algorithm in the crypt-
analysis of simple substitution ciphers. Cryptologia,
17(1):31–44, 1993.
[31] Mohammad Faisal Uddin and Amr M Youssef. Crypt-
analysis of simple substitution ciphers using particle
swarm optimization. In 2006 IEEE International Con-
ference on Evolutionary Computation, pages 677–680.
IEEE, 2006.
[32] Stephanie Wang, Rishabh Poddar, Jianan Lu, and
Raluca Ada Popa. Practical volume-based attacks on
encrypted databases. Technical report, University of
California at Berkeley, 2019.
[33] Joe H. Ward. Hierarchical grouping to optimize an
objective function. Journal of the American Statistical
Association, 58(301):236–244, 1963.
[34] Lei Xu, Xingliang Yuan, Cong Wang, Qian Wang, and
Chungen Xu. Hardening database padding for search-
able encryption. In IEEE INFOCOM 2019-IEEE Con-
ference on Computer Communications, pages 2503–
2511. IEEE, 2019.
[35] Yupeng Zhang, Jonathan Katz, and Charalampos Papa-
manthou. All your queries are belong to us: The power
of ﬁle-injection attacks on searchable encryption. In
25th USENIX Security Symposium (USENIX Security
16), pages 707–720, 2016.
A Extended discussion of related work
We have discussed the most relevant related work in Section 1
and compared our reﬁned score attack with the related attacks
in Section 5.3. In this Appendix, we would like to discuss
further lines of related research.
A.1 General overview
Passive attacks against L1 schemes Several attacks have
already been proposed to recover the queries of L1 schemes.
All of them had one common assumption to achieve good
results: the adversary knows at least a part of the documents
indexed. In [15] (IKK), Islam et al. presented the ﬁrst attack
using the co-occurrence of the search tokens. In [3] (CGPR),
Cash et al. presented a simpler but very effective known-data
attack using slightly more knowledge than IKK. Two signiﬁ-
cant advantages of CGPR over IKK were its execution time
and its effectiveness on large keyword sets. However, [3] high-
lighted that IKK and CGPR attacks could not provide com-
pelling results as similar-data attacks, i.e. the attacker needs
to know a part of the indexed data to recover some queries.
In [28], Pouliot and Wright introduced a graph-matching at-
tack. Pouliot et al. [28] proposed a graph matching attack that
can work as a known-data attack and a similar-data attack. As
a similar-data attack, it rarely recovers more than 50% of the
queries and only under rather advantageous conditions (e.g.
small vocabulary). Moreover, the execution time increases
tremendously for bigger keyword sets. In [22], Ning et al.
presented a new known-data attack which represents every
keyword (resp. search token) with a binary sequence: the i-
th bit is 1 if the i-th document contains the keyword (resp.
matches the query), 0 otherwise. The sequences are compared
to ﬁnd the underlying keywords of the queries. This attack
performs better than CGPR. However, it is a known-data-
only attack since it cannot use a distributional knowledge
to construct these binary sequences. In [1], Blackstone et al.
revisited the underlying concepts of the known-data attacks
and presented a new known-data attack. This attack can be
done on co-occurrence-hiding schemes and achieves good
results even when the known data is small. Despite these
results this attack cannot be executed using similar data (i.e.
it is a known-data-only attack) because the algorithm is based
on the assumption that the documents known by the attacker
are indexed. In [32], Wang et al. introduced a volume-based
attack working on co-occurrence-hiding schemes. The lat-
ter two attacks [1, 32] both even work against schemes with
protection beyond L1 security.
All these passive attacks tried to avoid known queries as
part of the adversary knowledge: [1,32] did not assume known
queries while [15] and [3] showed that query knowledge does
not improve the results signiﬁcantly. However, they all made
another strong assumption: the adversary knows a signiﬁcant
part of the encrypted documents. In our work we follow an
orthogonal approach and study similar-data attacks that avoid
partial knowledge of the encrypted documents but exploit a
small subset of queried keywords. We argue that it is easier
to obtain few known queries (using active attacks) than to
obtain a part of the encrypted documents. Thus, the reﬁned
score attack can be considered as much more feasible than
existing leakage abuse attacks.
Other attacks Other attacks exist against L1 schemes but
differ from what is intended by the passive attacks presented
above. In [35], Zhang et al. presented an active attack which
recovers speciﬁc keywords based on maliciously crafted
ﬁles/documents injected by the attacker. In [20], Liu et al.
recovers the queries exploiting the query frequencies. This
last direction has not been treated much more in the literature
since there is no query dataset available. In [23], Oya and Ker-
USENIX Association
30th USENIX Security Symposium    157
schbaum introduced an attack assuming co-occurrence AND
query frequency. This new attacker model is more or less a
mixture of the attacker models from Liu et al. [20] and Black-
stone et al. [1]. While strengthening the attacker assumptions
with the query frequency, it is important to highlight that this
attack can work on schemes with no or partial access pattern
leakage [8, 24, 25].
Several articles have also presented attacks on schemes
other than L1 schemes. In [3, 12, 14], the attacks are focused
on less secure schemes, i.e. schemes with L2, L3 or L4 leakage
proﬁles. In [13, 16, 19], attacks on schemes supporting range
queries were proposed. These SSE schemes are opposed to
the schemes for single-keyword search that are the subject of
our attack.
A.2 Relation between substitution cipher
cryptanalysis and SSE attacks
There exists a particular link between SSE passive query-
recovery attacks and the cryptanalysis of substitution ciphers.
In [3], Cash et al. deﬁne L4 leakage proﬁle as full plaintext
under deterministic word-substitution cipher. We argue that
the analogy to substitution ciphers still holds for most secure
schemes including L1 schemes. In simple substitution ciphers,
each plain letter is replaced by one other letter, the key is a
dictionary, for example {”a” : ”x”,”b” : ” j”, . . .}. In SSE with
single-keyword search, we can construct a similar mapping
such that {trapdoori : keyword j, . . .}. The main difference is
the larger alphabet size for SSE.
To perform a ciphertext-only attack on substitution ciphers,
a frequency analysis is performed. A very common way to pro-
ceed is to compute n-grams from the ciphertext and compare
them with the reference n-grams occurrences computed from
a large publicly available corpus, e.g. the most frequent En-
glish bigram is "th". Several methods, automated or not have
been proposed: [6, 9–11, 30, 31]. Especially in [11] and [9],
simple attacks based on "digrams" are presented. The digrams
are letter-letter co-occurrence matrices. We can see an equiva-
lence between the letter-letter co-occurrences used for substi-
tution cipher attacks and the word-word co-occurrences used
by IKK, CGPR and our attack. However, we note that, with
L1 schemes, the matrix is symmetric while the digrams are