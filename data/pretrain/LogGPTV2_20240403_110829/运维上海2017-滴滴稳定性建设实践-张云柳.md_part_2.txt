曲线图
最近1分钟请求成功率
今天：99.8610%
最近1分钟请求成功率
今天：99.9988%
最近1分钟请求成功率
今天：99.9172%
最近1分钟请求成功率
今天：99.5538%
99.9048 %
本周：99.8635%
本周：99.9989%
99.8248 %
本周：99.9204%
99.4620 %
100%
本周：99.5232%
本月：99.9004%
本月：99.9986%
本月：99.9030%
本月：99.5642%
本季：99.9143%
本季：99.9640%
本季：99.8787%
本季：99.7577%
曲线图
曲线图
曲线图
曲线图
C
数据详情
C
C
C
CNUTCon 2017
Geekbang). InfoQ
主办方
NUT)
全球运维技术大会
极客邦科技
---
## Page 22
灭火图”快速圈定异常系统
【核心业务指标监
控】
发现
【灭火图】
圈定影响面收敛到问题的业务线
/功能/系统/外部依赖
【监控平台/监控大盘】
业务系统监控/机器基础监控/内网监控
定位
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 23
数据可视化也能加速定位！
聚合
01
SparkStreaming+Flink实时聚合
采集
展现
02
展现
存储
系统成功率“红绿灯”
聚合
异常
检测
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 24
监控加不完，但不能不加！
，提供线上服务的环节都需要被监控
，不同业务，个性化的展示提升排查效率
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 25
积木式监控框架建设
核心业务指标监控/其它重要报警
发现
【灭火图/多维度接口】
圈定影响面收敛到问题的业务线/功能/系统/外部依赖
【监控大盘】
【基础设施】
【trace】
各模块状态详情
【监控平台】
机器死机/机房网
细粒度分析流
是否dang掉or hang
络故障/运营商故
各业务常规监控
量状态
住
障
定位
CNUTCon2O17
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 26
监控入口分散沟通成本高
，多渠道提升监控覆盖面，但入口逐渐分散
故障时刻需要逐个监控确认是否有异常
CNUTCon2017
Geekbang>. InfoQ
CNUT
主办方
全球运维技术大会
---
## Page 27
建设开放的事件监控框架
核心业务监控
部署系统
基础监
控
事件库
运营平台
公网监
控
配置管理
多维度监控
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 28
事件库Timeline
事件源②
部署3.0
接入层BI报警Apollo代驾动态配置
机房/网络
全不选①
产品线②
专快车
出租车】
顺风车
代驾
小巴车
接入层
公共平台
平台运营
企业用车
新四
未分类
全不选①
2017-09-01 14:44 ~ 2017-09-01 15:44
1小时
2小时
天
周月
C
部署
■全量回滚
小流量回滚
去长尾
BI报警
接入层上线
部署上线
test123
事件名称：支付瘦身+服务费收敛到He
打印log 
事件分类：部署事件
部署测试
事件描述：
产品线：企业用车
test3
Odin节点:paris.b2b.didi.com
test
正在部署集群：
钉钉消息队列
部署完成集群：pre,gz01
余额还款上线
总体进度：100%(7)
操作人：renzhenjun
开始时间：2017-09-0114:57:55
fixbug
结束时间：2017-09-0115:37:23
余额还款上线
修改鹏元同盾查询流程
钉钉消息队列
修改订单和乘客url，修！
温馨提示：点击事件可查看详情
以及职能组看不到所有职场的bug
修改订单和乘客ur，修复问题
支付瘦身+服务费收敛到Hermes
车辆信息不一
取消改派/排队全量放开，升舱邮件模板调整 
跳转配置引导逻辑增加判断条件 
人力菱
loa
实时目的地bug修复
退回golang1.5
首页兼容数据空
优化企业名称长度校验
代驾动态配置
apollo操作
端到端监控 
机房/网络
14:45
14:50
15:00
15:40
Fri 1 Septe
CNUTCon 2017
Geekbang). InfoQ
主办方
NUTI
全球运维技术大会
极客邦科技
---
## Page 29
积木式监控框架进一步收敛入口
核心业务指标监控/其它重要报警
发现
【灭火图/多维度接口】
圈定影响面收敛到问题的业务线/功能/系统/外部依赖
【基础设施】
【事件监控】
【trace】
【监控平台】
机器死机/机房网
上线操作/活动生效/
细粒度分析流
络故障/运营商故
各业务常规监控
其它线上操作
量状态
障
定位
CNUTCon 2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 30
智能定位，
呼之欲出
核心业务指标监控/其它重要报警
【灭火图/多维度接口】
【智能定位】
圈定影响面收敛到问题的业务线/功能/系统/外部依赖
搜集各个性化监控报
警、变更操作，基于
规则分析业务问题可
能的故障根因
【事件监控】
【基础设施】
【trace】
【监控平台】
上线操作/活动生效/
机器死机/机房网络
细粒度分析流
各业务常规监控
其它线上操作
故障/运营商故障
量状态
发现/定位
CNUTCon 2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 31
稳定性建设阶段回顾
根因推荐
事件收敛
多渠道监控覆盖
系统红绿灯
核心业务指标
基础监控
2013
2015
2016
2017
2017
2017
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 32
TABLEOFCONTENTS
滴滴如何看稳定性
稳定性建设阶段演进
稳定性技术竞赛
稳定性建设心得
CNUTCon2017
主协方Geekbang>.InfoQ
CNUT
全球运维技术大会
---
## Page 33
奖惩
稳定性技术竞赛
·故障分级
·P5～P1根据故障对业务影响程度划分
奖惩
对不可用时长达标及稳定性工作优秀队伍予以现金、荣誉勋章进行奖励
对稳定性不达标队伍亦有相应惩罚
CEO、CTO或者其他VP会参与总结会
CNUTCon2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 34
故障
稳定性技术竞赛
发现：核心业务指标监控
重大异常电话告警
沟通：消防群
滴滴消防群内部
区A回口6口
涉及团队统一沟通
北京嘀嘀无限科技发展有限公司
重点事件汇聚Timeline
###TIMELINE
23:50新四定位流量突增
23:57运红
和业务方
一起定位发现流量陡增约4倍左
右
定位：灭火图等
00:00启动预案切换50%流量到肌房
00:06开始小流量操作
00：12入口流量开始下跌逐步恢复同比正常原因进一步排查中
快速圈定异常系统、场景
恢复了，明天再对一下原因
99.9793
从现象看23:20-00:15入
击，明天再详细查下原因
99.6264
99.9113
0096'66
99.9658°
99.9484%
CNUTCon 2017
Geekbang>. InfoQ
主办方
NUT)
全球运维技术大会
---
## Page 35
稳定性建设，缺一不可
分级监控：全面监控、技术保障
技术竞赛：建立制度、全员参与
CNUTCon2017
Geekbang). InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 36
TABLEOFCONTENTS
滴滴如何看稳定性
稳定性建设阶段演进
稳定性技术竞赛
稳定性建设心得
CNUTCon2017
主协方Geekbang>.InfoQ
CNUT
全球运维技术大会
---
## Page 37
稳定性建设回顾
2016
>99.9%
2017
>99.95%
（截止目前）
方向
思路
全员参与、团队合作
多 idc 建设
故障发现、定
量化系统指标、系统状态
位能力提升
运维
标准化
有激励有惩罚
CNUTCon 2017
Geekbang>. InfoQ
CNUT)
主办方
全球运维技术大会
---
## Page 38
稳定性建设需要所有团队把它放到同等的优先级
而不能只靠单个团队推进
CNUTCon2017
Geekbang>. InfoQ
CNUT
主办方
全球运维技术大会
---
## Page 39
THANKS!
智能时代的新运维
CNUTCon 2017
---