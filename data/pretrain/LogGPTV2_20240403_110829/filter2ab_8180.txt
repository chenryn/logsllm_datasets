### Title: Black Hat US-20: Office Drama on macOS

In the world of Windows, macro-based Office attacks are well-documented and, frankly, somewhat pass√©. However, on macOS, such attacks are gaining popularity and have received far less attention from the research and security communities. In this talk, we will begin by analyzing recent macro-laden documents targeting Apple's desktop OS, highlighting the macOS-specific exploit code and payloads. Although sophisticated Advanced Persistent Threat (APT) groups are behind several of these attacks, the malicious documents and their payloads remain significantly constrained by recent application and OS-level security mechanisms.

However, the situation could be much worse. We will detail the creation of a powerful exploit chain that began with CVE-2019-1457, leveraged a new sandbox escape, and culminated in a full bypass of Apple's stringent notarization requirements. This exploit was triggered simply by opening a malicious (macro-laced) Office document, requiring no alerts, prompts, or other user interactions to persistently infect even a fully-patched macOS Catalina system.

To conclude, we will explore Apple's new Endpoint Security Framework, illustrating how it can be leveraged to thwart each stage of our exploit chain. Additionally, we will discuss how this framework can generically detect advanced "document-delivered" payloads and even persistent nation-state malware.