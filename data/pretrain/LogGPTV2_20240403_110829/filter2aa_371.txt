1
SPARR    W: A Novel Covert Communication 
Scheme Exploiting Broadcast Signals in 
LTE, 5G & Beyond
Reza Soosahabi, Chuck McAuley
Application & Threat Intelligence Research Center
2
WHO
3
4
MOTIVATION
5
Motivation
â€¢ Past research experience in wireless security
â€¢ Worked with US operators before joining Keysight in 2018.
â€¢ Researched data exfiltration techniques at ATI that are 
lesser known in wireless community.
â€¢ Trying to impress a cool boss who drops a big money Base-
Station emulator equipment on your lap to do open field 
research!
â€¢ The satellite talk in DEFCON 28
â€¢ Whispers Among the Stars: Perpetrating (and Preventing) 
Satellite Eavesdropping Attacks â€“ James Pavur
New Job
Old Job
W H AT  M A D E  M E  D O  I T !
6
Motivation
â€¢ Covert Communication: a potential threat
â€¢ Hacker Mentality: Exploit [Software]
â€¢ Tunnelling via 3-7 protos: ICMP, DNS, etc
â€¢ Challenged by Security Boxes: IPS, IDS, LI
F I N D I N G  M I S S I N G  P I E C E
Application
TCP/UDP
IP
MAC
PHY
Application
TCP/UDP
IP
MAC
PHY
Exploit 
MAC?
â€¢ Engineer Mentality: Build [Hardware] 
â€¢ Building L1 (radios): Spread Spectrum, Ham Radios, etc
â€¢ Signal blocking e.g. indoor to outdoor
â€¢ Avoiding spectrum monitoring
a.b.c.d
x.y.z.t
7
Motivation
â€¢ Exploit MAC standard weakness in cellular & satellite, â€¦
â€¢ Radio height makes RF signals unstoppable.
â€¢ What if: Trudy bounces a broadcast signal of from ANY powerful 
Wireless Access Node to Ricky!?
E X P L O I T I N G  A C C E S S  R A D I O S
ğ‘šğ‘–
Ricky
Trudy
This Photo by Unknown Author is licensed under CC BY-SA
This Photo by Unknown Author is licensed under CC BY-SA-NC
This Photo by Unknown Author is licensed under CC BY-SA
8
EXPLOITING LTE & 5G
STANDARD WEAKNESS
9
M E D I U M  A C C E S S  C O N T R O L
What is the MAC layer?
This Photo by Unknown Author is licensed under CC BY-SA
This one
Media Layers
Host Layers
10
LTE/5G Big MAC Layers!
Terminology Quick Start:
UE (User Equipment) 
â€¢
Phone, Tablet, Laptop, Things with SIM!
eNodeB / gNodeB 
â€¢
Cell Tower for LTE/5G
â€¢
No one knows what happened to fNodeB!
â€¢ So, I like using fNodeB to refer to both LTE & 5G cells!!
This Photo by Unknown Author is licensed under CC BY-SA-NC
Crati, CC BY-SA 3.0 via Wikimedia Commons
This Photo by Unknown Author is 
licensed under CC BY-NC
11
https://www.sharetechnote.com/html/FullStack_LTE.html
Normal RA Procedure
Msg3 (RRC-Conn-Req): 
Random 48-bit MAC CRI
Msg4 (RRC-Conn-Setup): Acks 
Msg3 by MAC CRI Rebroadcast
Msg5 (RRC-Setup- Complete): 
UE Starts NAS process
Plain Text Broadcast
Encrypted Data & 
Signaling
Msg2: sends RAR scheduled w/ RA-
RNTI, TC-RNTI, TA, UL grant for Msg3
Msg1: UE starts RA
C O N T E N T I O N  R E S O L U T I O N  P I N G - P O N G
12
Exploiting CRI Broadcast
Msg1: UE starts RA w/ 
RA-RNTI = 1, RAPID = 8
Msg2: eNB sends RAR w/ RA-RNTI = 1, 
TC-RNTI = x , TA, UL grant for Msg3
Sniffing PDCCH RAR w/ 
DCI-1C, RA-RNTI = 1 , 
RAPID = 8 
Sniffing PDCCH for 
DCI-1 w/ TC-RNTI = x
Msg3: Encoded 48-bit MAC CRI
Msg4: Rebroadcasts MAC CRI
Decoding 
MAC CRI
Ricky knows RA-RNTI 
and RAPID.
Ricky
Trudy
Encoding 
(optional)
13
S U C C E S S I V E  AT T E M P T S
Msg1
Msg4
decoding
Msg1
encoding
Msg3
Msg1
Msg4
decoding
Msg1
encoding
Msg3
Msg1
Msg4
decoding
Msg1
encoding
Msg3
Source: 3GPP TS 36.321, sec 5.1.4 
â€¢ A SPARROW UE can send successive 40-bits messages
â€¢ Successive RACH attempts do not impact other users much.
â€¢ Picking low backoff time: like every 40 ms => 1 kbps tput.
â€¢ This vulnerability can be traced back to LTE Rel. 8 and still 
exists in 5G-NR.
â€¢ Although less-relevant FR2 (above 6 GHz) due to beamforming 
it can be easily exploited in LTE lower-bands and FR1 to 
achieve around 5 miles range.
â€¢ Higher ranges achievable in upcoming 5G-NTN (satellite 
gNBs).
Exploiting CRI Broadcast
14
â€¢ No Network or Spectrum Footprint
â€¢ Low Hardware Complexity
â€¢ More Miles per Watt
â€¢ Unstoppable
0.2 W / 5 mi
1 W / 5 mi
2 W / 1 mi
LoRAWAN GW
Sparrow UE
Walkie Talkie
WHY SPARROW?
ğ‘šğ‘–
Ricky
Trudy
15
Demo & Use Cases
16
SPARROW Testbed Setup
Keysight UXM
Rear side
Test PC
PRT
Script
17
17
DEMO
18
Application Scenarios
ğ‘šğ‘–
TX
RX
â¢Data Exfiltration: Extract sensitive data out of secure locations
â¢Supply Chain: Remote access baked into firmware of modem
â¢Command & Control (CnC): trigger or monitor events remotely
This Photo by Unknown Author is licensed under CC BY-NC
This Photo by Unknown Author is licensed under CC BY
19
Application Scenarios
â¢Disaster Recovery: In case of natural disasters, the cellular 
infrastructure could be operational without backhaul links.
ğ‘šğ‘–
TX
RX
â¢Failover Broadcast: Can utilize this as an alternative for 
emergency notifications. Connect parties in case of emergency.
This Photo by Unknown Author is licensed under CC BY-SA
This Photo by Unknown Author is licensed under CC BY-SA
This Photo by Unknown Author is licensed under CC BY-SA
20
Application Scenarios
ğ‘šğ‘–
TX
RX
â¢Extended Network: Make a lightweight IoT network using 
someone elseâ€™s fNodeB
â¢Pager Network: Let everyone know itâ€™s dinner time, create a 
localized medium distance pager network
Image provided curtesy of @_naturalfreq of Dirt Simple Comms
21
ğ‘ğ‘–
Reliability / Rate enhancement 
via parallel PTP links
Range Increase By Relay Nodes 
TX
RX
TX
RX
Low-power self sustained relay UE,
Planted in overlap (handover) areas
ğ‘šğ‘–
ğ‘ªğ’ˆğ’“ğ’“ > ğŸğŸ ğ’Œğ’ˆğ’Œğ’‚ğ’“
Geographical Enhancements
22
Geographical Enhancements
23
GENERAL REMEDIATION
24
A wireless MAC layer protocol is deemed vulnerable
to SPARROW technique, if any of its procedures allows 
forming two sets of uplink messages (M) and the downlink 
broadcast messages (B) satisfying all the following conditions:
1) Passive Reception: any signal in (B) are anonymously 
decodable.
2) Bijectivity: one-to-one correlation between (M) & (B).
3) Anonymous Uplink: no need to attach to the network.
4) Stateless Uplink: Trudy can successively send any 
message from (M) without protocol violation.
Weakness Model
ğ‘šğ‘–
Ricky
Trudy
Ted
ğ‘šğ‘– âˆˆ ğ‘€
ğ‘ğ‘– âˆˆ ğµ
25
Understanding CRI Purpose
Msg1: RA-RNTI = 1, RAPID = 8
Msg2: eNB sends RAR scheduled w/ RA-RNTI = 0, 
and provides TC-RNTI = x , TA, and UL grant for Msg3
Msg3 (RRC-Conn-Req): 
UE1 sends 48-bit MAC CRI
Msg4 (RRC-Conn-Setup): eNB send contention 
resolution response including the UE1 MAC CRI
Msg1: RA-RNTI = 1, RAPID = 8
Msg3 (RRC-Conn-Req): 
UE2 sends 48-bit MAC CRI
Wrong TA!
â€¢
The value is arbitrary by UE 
â€¢
Think of it as a ping-pong or selective 
ack
â€¢
Rebroadcast in Msg4 is universally 
decodable (QPSK) by both UE and 
non-UE devices 
â€¢
UE identities remain hidden
26
â€¢ No preset CRI for privacy
â€¢ No Shared secret UE & fNB
â€¢ Salt must be sent to UE
â€¢ Ricky can still map (B) to (M) 
by computing hash (rainbow)
â€¢ fNB cannot distinguish 
between Trudy and other 
users so cannot risk blocking 
RACH
C RY P T O  H A S H  W I T H  S A LT  |  B L O C K I N G
Solutions that donâ€™t work
D
E
A
D
B
E
E
F
5
A
1
7
E
D
B
E
E
F
4
A
â€¦. AB4C57522458CFEEA69C â€¦.
5
A
1
7
E
D
ğ‘ªğ’“ğ’™ğ’Œğ’“ğ’Œ ğ‘¯ğ’‚ğ’“ğ’ˆ ğ‘ªğ’“ğ’Œğ’‚ğ’“ğ’ˆğ’Œğ’Œ (ğ‘²ğ‘ªğŸ, ğ‘¹ğ‘¯ğ‘¨ğŸ, â€¦ )
(ğ‘²ğ’“ğ’ˆğŸ)
(ğ‘²ğ’“ğ’ˆğŸ)
4
A
1
1
1
1
5
A
1
7
E
D
27
Solution That Works: ELISHA
4
2
F
2
ğ’™ (ğŸğŸ– ğ’‚ğ’ˆğ’“ğ’“)
ğ‘¹ğ’‚ğ’Œğ’‚ğ’Œğ’Œ ğ‘²ğ’“ğ’Œğ’“.
ğ‘¹ğ’‚ğ’Œğ’“ ğ
ğ’“ğ’ˆğ’™ğ’‚ ğ‘¹ ğ’‚ğ’ˆğ’“ğ’“
B
4
2
F
A
C
E
D
B
4
4
2
F
F
A
C
E
D
â€¦. 011101000011110010 â€¦.
ğ‘ªğ’“ğ’™ğ’Œğ’“ğ’Œ ğ‘¯ğ’‚ğ’“ğ’ˆ ğ‘ªğ’“ğ’Œğ’‚ğ’“ğ’ˆğ’Œğ’Œ (ğ‘²ğ‘ªğŸ, ğ‘¹ğ‘¯ğ‘¨ğŸ, â€¦ )
5
0
7
2
5
0
7
2
â€¦. 111100000111011111 â€¦.
â€¦. 010001 â€¦.
â€¦. 111100000111011111 â€¦.
4
2
F
2
ğ‘ªğ‘¯ğ‘ª ğ‘¶ğ’“ğ’“ğ’Œğ’“ğ’“
ğ’“ğ’ˆğ’™ğ’‚ ğ‘² ğ’‚ğ’ˆğ’“ğ’“
ğ‘¹ğ’‚ğ’Œğ’‚ğ’Œğ’Œ ğ’‚ğ’ˆğ’“ ğ‘ªğ’“ğ’‚ğ’“ğ’“ğ’“ğ’‚
ğ‘²ğ’‚ğ’“ğ’Œ (ğ’‚ğ‘²)
ğŸğ‘² âˆ’ ğ‘² + ğ‘¹ ğ’‚ğ’ˆğ’“ğ’“
(ğ‘²ğ’“ğ’ˆğŸ)
(ğ‘²ğ’“ğ’ˆğŸ)
â€¢ Extensible Loss-Induced 
Security Hashing Algo
â€¢ New Salting to reduce 
Short-String hash collision
â€¢ Infeasible to construct 
rainbow table or forward-
error correction code 
books
â€¢ Could have other 
applications other than 
secure RACH
28
v
WRAP UP
29
Disclosure Timeline
Dec 2020
PoC Recording with 
UEsim & UXM 5G
Oct 2020
Engaging CSG and 
Millan Team for PoC
Sep 2020
Internal Review 
& Presentation
Apr 2021
CVD-2021-0045: 
GSMA Disclosure 
& Hall of Fame
May 2021
Remediation US 
Patent Submission 
(in progress)
TBD 2021
Remediation adoption 
in 3GPP 
Aug 2021
Presenting at DEF CON 29
Feb 2020
Inception of Idea
Jan 2021
Remediation Dev & 
GSMA Submission
30
â€¢ Utilize lateral thinking and your peers!
â€¢ Thereâ€™s a nice sweet spot between building your own wireless 
protocol or piggy backing on top of the application layer for 
hidden communication. Just because itâ€™s layer 2 doesnâ€™t mean 
itâ€™s a short distance.
â€¢ We donâ€™t think LTE and 5G are the only radio accessible 
systems with this kind of problem. Start researching other MAC 
layer negotiation protocols, notably for wireless systems, like 
satellites.
â€¢ LTE and 5G is for everyone now - CBRS
Concluding Bit
This Photo by Unknown Author is licensed under CC BY-SA-NC
31
â€¢ Many thanks to Keysight Engineering Team in Millan: 
â€¢ Befekadu Mengesha
â€¢ Luca Mapelli 
â€¢ Thanks to ATI management staff:
â€¢ Chuck McAuley
â€¢ Chris Moore
â€¢ Steve McGregory
â€¢ Thanks to Keysight IP program coordinator:
â€¢ Pete Marsico
â€¢ Thanks DEFCON!
Thank Youâ€™s and Contact
Reza
â€¢
https://twitter.com/darthsohos
â€¢
https://www.linkedin.com/in/sohos
Chuck
â€¢
https://twitter.com/nobletrout