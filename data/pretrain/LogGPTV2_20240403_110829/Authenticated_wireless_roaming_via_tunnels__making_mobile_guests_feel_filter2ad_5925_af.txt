protocol costs by additional modular exponentiations.
Remark 5. Some recent work on AKE-security, additionally, strengthens A by allowing it to corrupt
participants or reveal ephemeral secrets used by (uncorrupted) participants during the test session. It
might be possible to apply techniques used in [39] to achieve such strong AKE-security for the session
keys computed in AWRT (at least for the end-to-end key KM,H). However, we leave such discussion out of
scope of the current work.
6.2 Denial-of-Service and Hijacking
Here we present some ideas on how to enhance AWRT towards resistance against some types of DoS
attacks. Due to the higher communication delays on the path between F and H it might be desirable to
decrease the risk that F opens a connection to H for the third protocol message without gaining stronger
conﬁdence that a party which requested the tunnel is a valid mobile device hosted by H; otherwise a
DoS-attacker can compose the second protocol message B|H and then simply close own connection. A
possible solution to minimize this risk is to equip M with a corresponding public key certiﬁcate issued
by H and demand a signature on this second message (which also includes a fresh nonce of F). Observe,
that this solution, although computationally expensive, minimizes the risk since the attacker must either
forge the signature or be a holder of some valid certiﬁcate. Nevertheless, it is not completely satisfactory
since F is not able to judge (without further interaction) whether the certiﬁcate has not been revoked.
One could further reduce the risk by requiring that device certiﬁcates are issued for some short validity
period.
A similar threat is given for H which could be forced to keep the connection to F after the fourth
protocol message without gaining stronger conﬁdence that both parties M and F are legitimate; otherwise
a DoS attacker may ﬂood H with messages of the form C|T and close own connection thereafter. The
risk here can be minimized by requiring that C|T is signed by F whereby the time-stamp T would also
serve as a protection against replay attacks. Note that this signature cannot replace σF from the last
message as this is required for the mutual authentication between F and H. Additional conﬁdence for
H that C|T has been sent by F after the communication with a valid M can be achieved by letting M
compute a MAC value µ(cid:48)
H (in addition to its
signature) to H. Note that µ(cid:48)
H cannot replace µH as the latter is needed for the mutual authentication
between M and H.
H on the message B|H using αM and F to forward C|T|µ(cid:48)
Finally, we consider protection against hijacking of a roaming session, mentioned in [53] for the non-
tunnel-based case. Similarly, in WRT an attacker can wait until the protocol completes and the tunnel
is established and then try to hijack the session from M or H (or both of them — tunnel hijacking). On
the wireless link between M and F the session can be hijacked by using a more powerful transmitting
device than M, and on the path between F and H a hijacker can be any intermediate communication
node. In WRT this attack may be used to waste the bandwidth resources assigned to the tunnel by F.
Our basic protocol allows for an elegant solution through the use of the tunnel key Kt requiring that each
message which is supposed to be sent through the tunnel during the roaming session is authenticated such
that F is able to verify its validity prior to the delivery. Note that a hijacker cannot bias the end-to-end
communication between M and H which is protected by KM,H.
6.3 Conﬁdentiality of M’s Identity
Whenever a mobile device roams across several foreign networks (contract partners of H) it might be
desirable to keep its identity M undisclosed and even to prevent (possibly colluding) foreign networks
from being able to link its roaming activities, thus eliminating the risk of proﬁling (examples for this can
also be found in roaming for mobile phone networks, e.g., TMSI in GSM and UMTS). A straightforward
solution is to let M choose some set of “one-time” roaming aliases and reveal them to its home network
20
M. Manulis, D. Leroy, F. Koeune, O. Bonaventure, and J.-J. Quisquater
before it roams. Obviously, this solution requires additional storage resources and its most signiﬁcant
disadvantage is that M must choose (and update) its aliases while being in the area covered by H (see
also the discussion in [45]).
Our AWRT protocol allows for a more elegant approach if we rely on the fact that each home network
usually serves as a foreign network from the perspective of its contract partners. This implies that LLH
used in AWRT also includes a key pair (dkH, ekH). Assuming that M knows ekH we can slightly modify
AWRT by replacing the identity M in the second protocol message with its encrypted equivalent EekH(M)
which will also be used in the construction of session ids. Obviously, upon receiving C|T the home network
would be able to recover M through the corresponding decryption. Due to the IND-CCA2 property of
(E,D) this solution would ensure not only anonymity of M towards F but also the unlinkability among
diﬀerent AWRT executions with M; at the cost of one additional public key operation by M and H.
6.4 Reimbursement of F’s Roaming Costs
In commercial scenarios the foreign network F has to be reimbursed for the provided roaming service.
Since F is not aware of M it usually presents its claims to H. Note that the reimbursement process (as
any payment process) cannot be realized solely using cryptographic techniques. Nevertheless, it might be
desirable to allow F to support its claims with some cryptographic proof, which can also be shown to
some judge. Observe, that in AWRT the foreign network obtains σH computed amongst other parameters
on the identity F and the time-stamp T chosen by F. However, the existence of σH alone does not
guarantee that F created a tunnel to H and actually provided the roaming service. Therefore, upon
H from H computed on some fresh
the maintenance of the tunnel F may request further signatures σ(cid:48)
time-stamp T (cid:48) > T and the session id, and close the tunnel connection if the expected signature is not
delivered. Special control messages exchanged between M and H and protected using keys derived from
KM,H can be speciﬁed in order to ensure H (and M) that the tunnel has been created and kept open
during the interval [T, T (cid:48)]; otherwise H may refuse to send σ(cid:48)
H) would then serve
as a cryptographically protected acknowledgement of H that the tunnel connection was kept open by F
within the time interval [T, T (cid:48)].
H. A valid pair (σH, σ(cid:48)
7 Conclusion
The wireless roaming approach via tunnels preserves the home network’s role as the actual service provider
and has a number of additional security beneﬁts. However, it opens new challenges on the authentica-
tion and key establishment protocol that precedes the establishment of the tunnel connection. Having
formally speciﬁed the necessary requirements we designed an appropriate provably secure protocol AWRT
which requires one communication round between the foreign and the home network prior to the creation
of the tunnel. Additionally, we provide some ideas on possible extensions of the basic version of AWRT to-
wards forward secrecy, DoS resistance, anonymity of roaming mobile devices and unlinkability of roaming
sessions, and argued on the possible use of AWRT in commercial scenarios. The most appealing future work
is the detailed speciﬁcation of the protocol within the EAP framework and its implementation based on
current standards within a suitable WRT architecture (the architecture can be based on the ideas given
in [54]), whereby special attention should be paid to the realization of the tunnel connection, including
the necessary control messages and their protection.
References
1. 802.1X-2004 IEEE Standard for Local and Metropolitan Area Networks – Port-Based Network Access Control.
IEEE, 2004.
2. 3GPP. Group Core Network and Terminals; Handover Procedures (Release 7). Technical report, 2007.
3. 3GPP. Group Services and System Aspects; 3G Security; Security Architecture. Technical report, 2008.
4. M. Abdalla, M. Bellare, and P. Rogaway. The Oracle Diﬃe-Hellman Assumptions and an Analysis of DHIES.
In CT-RSA’01, LNCS 2020, pp. 143–158. Springer, 2001.
Authenticated Wireless Roaming via Tunnels: Making Mobile Feel at Home
21
5. B. Aboba, L. Blunk, J. Vollbrecht, J. Carlson, and H. Levkowetz. Extensible Authentication Protocol (EAP).
RFC 3748, IETF, 2004.
6. B. Anton, B. Bullock, and J. Short. Best Current Practices for Wireless Internet Service Provider (WISP)
Roaming. Wi-Fi Alliance - Wireless ISP Roaming (WISPr), Feb. 2003.
7. G. Appenzeller, M. Roussopoulos, and M. Baker. User-Friendly Access Control for Public Network Ports. In
INFOCOM’99, pp. 699–707. IEEE, 1999.
8. P. Bahl, S. Venkatachary, and A. Balachandran. Secure Wireless Internet Access in Public Places. In ICC’01,
vol. 10, pp. 3271–3275. IEEE, 2001.
9. K. Bayarou, M. Enzmann, E. Giessler, M. Haisch, B. Hunter, M. Ilyas, S. Rohr, and M. Schneider. Towards
Certiﬁcate-Based Authentication for Future Mobile Communications. Wireless Personal Communications,
29(3-4):283–301, 2004.
10. M. Bellare. New Proofs for NMAC and HMAC: Security without Collision-Resistance. In CRYPTO’06, LNCS
4117, pp. 602–619. Springer, 2006.
11. M. Bellare, R. Canetti, and H. Krawczyk. Keying Hash Functions for Message Authentication. In CRYPTO
’96, LNCS 1109, pp. 1–15. Springer, 1996.
12. M. Bellare and C. Namprempre. Authenticated Encryption: Relations among Notions and Analysis of the
Generic Composition Paradigm. In ASIACRYPT’00, LNCS 1976, pp. 531–545. Springer, 2000.
13. M. Bellare and P. Rogaway. Entity Authentication and Key Distribution. In CRYPTO ’93, LNCS 773, pp.
232–249. Springer, 1993.
14. M. Bellare and P. Rogaway. Optimal Asymmetric Encryption — How to Encrypt with RSA.
In EURO-
CRYPT’94, LNCS 950, pp. 92–111. Springer, 1994.
15. M. Bellare and P. Rogaway. The Exact Security of Digital Signatures - How to Sign with RSA and Rabin.
In EUROCRYPT’96, LNCS 1070, pp. 399–416. Springer, 1996.
16. D. Boneh. The Decision Diﬃe-Hellman Problem. In ANTS-III, LNCS 1423, pp. 48–63. Springer, 1998.
17. D. Boneh, E. Shen, and B. Waters. Strongly Unforgeable Signatures Based on Computational Diﬃe-Hellman.
In PKC’06, LNCS 3958, pp. 229–240. Springer, 2006.
18. E. Bresson, O. Chevassut, and D. Pointcheval. The Group Diﬃe-Hellman Problems. In SAC’02, LNCS 2595,
pp. 325–338. Springer, 2002.
19. E. Bresson, O. Chevassut, D. Pointcheval, and J.-J. Quisquater. Provably Authenticated Group Diﬃe-Hellman
Key Exchange. In CCS’01, pp. 255–264. ACM, 2001.
20. C. Kaufman, Ed. Internet Key Exchange (IKEv2) Protocol. RFC 4306, IETF, 2005.
21. R. Canetti and H. Krawczyk. Analysis of Key-Exchange Protocols and Their Use for Building Secure Channels.
In EUROCRYPT’01, LNCS 2045, pp. 453–474. Springer, 2001.
22. K.-K. R. Choo, C. Boyd, and Y. Hitchcock. Examining Indistinguishability-Based Proof Models for Key
Establishment Protocols. In ASIACRYPT’05, LNCS 3788, pp. 585–604. Springer, 2005.
23. J.-S. Coron, M. Joye, D. Naccache, and P. Paillier. Universal Padding Schemes for RSA. In CRYPTO’02,
LNCS 2442, pp. 226–241. Springer, 2002.
24. R. Cramer and V. Shoup. A Practical Public Key Cryptosystem Provably Secure Against Adaptive Chosen
Ciphertext Attack. In CRYPTO’98, LNCS 1462, pp. 13–25. Springer, 1998.
25. W. Diﬃe and M. E. Hellman. New Directions in Cryptography. IEEE Trans. on Information Theory, IT-
22(6):644–654, 1976.
26. M. Dischinger, A. Haeberlen, P. K. Gummadi, and S. Saroiu. Characterizing Residential Broadband Networks.
In IMC’07, pp. 43–56. ACM, 2007.
27. Y. Dodis, R. Gennaro, J. H˚astad, H. Krawczyk, and T. Rabin. Randomness Extraction and Key Derivation
Using the CBC, Cascade and HMAC Modes. In CRYPTO’04, LNCS 3152, pp. 494–510. Springer, 2004.
28. eduroam. http://www.eduroam.org.
29. ETSI Technical Speciﬁcation. Digital Cellular Telecommunications System (Phase 2+); Security Related
Network Function. TS 100 929, ETSI, 2008.
30. Fon. http://www.fon.com
31. E. Fujisaki, T. Okamoto, D. Pointcheval, and J. Stern. RSA-OAEP Is Secure under the RSA Assumption.
Journal of Cryptology, 17(2):81–104, 2004.
32. P. Funk and S. Blake-Wilson. Extensible Authentication Protocol Tunneled Transport Layer Security Au-
thenticated Protocol Version 0 (EAP-TTLSv0). RFC 5281, IETF, 2008.
33. J. Gu, S. Park, O. Song, J. Lee, J. Nah, and S. W. Sohn. Mobile PKI: A PKI-Based Authentication Framework
for the Next Generation Mobile Communications. In ACISP’03, LNCS 2727, pp. 180–191. Springer, 2003.
34. Q. Huang, D. S. Wong, and Y. Zhao. Generic Transformation to Strongly Unforgeable Signatures. In ACNS’07,
LNCS 4521, pp. 1–17. Springer, 2007.
35. ITU-T. One-Way Transmission Time. G.114, 2003.
22
M. Manulis, D. Leroy, F. Koeune, O. Bonaventure, and J.-J. Quisquater
36. S. Kent and K. Seo. Security Architecture for the Internet Protocol. RFC 4301, IETF, 2005.
37. S. Kim, H. Cho, H. Hahm, S. Lee, and M. S. Lee. Interoperability between UMTS and CDMA 2000 Networks.
IEEE Wireless Communications, 10(1):22–28, 2003.
38. K. Lakshminarayanan and V. N. Padmanabhan. Some Findings on the Network Performance of Broadband
Hosts. In IMC’03, pp. 45–50. ACM, 2003.
39. B. A. LaMacchia, K. Lauter, and A. Mityagin. Stronger Security of Authenticated Key Exchange.
In
ProvSec’07, LNCS 4789, pp. 1–16. Springer, 2007.
40. M. Long, C.-H. Wu, and J. D. Irwin. Localised Authentication for Inter-Network Roaming across Wireless
LANs. IEE Proceedings Communications, 151(5):496–500, 2004.
41. S. McCann, R. Hancock, and E. Hepworth. Novel WLAN Hotspot Authentication. In 3G Mobile Communi-
cation Technologies Conf., pp. 59–63. IEE, 2004.
42. A. S. Merino, Y. Matsunaga, M. Shah, T. Suzuki, and R. H. Katz. Secure Authentication System for Public
WLAN Roaming. Mobile Networks and Applications, 10(3):355–370, 2005.
43. U. Meyer. Secure Roaming and Handover Procedures in Wireless Access Networks. PhD thesis, TU Darmstadt,
2005.
44. U. Meyer, J. Cordasco, and S. Wetzel. An Approach to Enhance Inter-Provider Roaming Through Secret
Sharing and its Application to WLANs. In WMASH’05, pages 1–13. ACM, 2005.
45. R. Molva, D. Samfat, and G. Tsudik. Authentication of Mobile Users. IEEE Network, 8:26–34, 1994.
46. R. M. Needham and M. D. Schroeder. Using Encryption for Authentication in Large Networks of Computers.
CACM, 21(12):993–999, 1978.
47. NIST. Digital Signature Standard (DSS). FIPS PUB 186-2, 2000.
48. C. Rackoﬀ and D. R. Simon. Non-Interactive Zero-Knowledge Proof of Knowledge and Chosen Ciphertext
Attack. In CRYPTO’91, LNCS 576, pp. 433–444. Springer, 1991.
49. C. Ribeiro, F. Silva, and A. Z´uquete. A Roaming Authentication Solution for Wiﬁ using IPsec VPNs with
Client Certiﬁcates. In TERENA Networking Conf., 2004.
50. C. Rigney, S. Willens, A. Rubens, and W. Simpson. Remote Authentication Dial In User Service (RADIUS).
RFC 2865, IETF, 2000.
51. R. Robert, M. Manulis, F. De Villenfagne, D. Leroy, J. Jost, F. Koeune, C. Ker, J.-M. Dinant, Y. Poullet,
O. Bonaventure, and J.-J. Quisquater. WiFi Roaming: Legal Implications and Security Constraints. Int. J.
of Law and Inf. Technology, 16(3):205–241. Oxford University Press, 2008.
52. G. Rose and G. Koien. Access Security in CDMA2000, including a Comparison with UMTS Access Security.
IEEE Wireless Commmunications, 11(1):19–25, 2004.
53. L. Salgarelli, M. Buddhikot, J. Garay, S. Patel, and S. Miller. Eﬃcient Authentication and Key Distribution
in Wireless IP Networks. IEEE Wireless Communications, 10(6):52–61, 2003.
54. N. Sastry, K. Sollins, and J. Crowcroft. Architecting Citywide Ubiquitous Wi-Fi Access. In HotNets-VI, 2007.
available at http://conferences.sigcomm.org/hotnets/2007/papers/hotnets6-final88.pdf.
55. A. Shamir. How to Share a Secret. CACM, 22(11):612–613, 1979.
56. V. Shoup. Sequences of Games: A Tool for Taming Complexity in Security Proofs. Cryptology ePrint Archive,
Report 2004/332, 2006.
57. D. Simon, B. Aboba, and R. Hurst. The EAP-TLS Authentication Protocol. RFC 5216, IETF, 2008.
58. S. Stamm, Z. Ramzan, and M. Jakobsson. Drive-By Pharming.
In ICICS’07, LNCS 4861, pp. 495–506.
Springer, 2007.
59. W. Townsley, A. Valencia, A. Rubens, G. Pall, G. Zorn, and B. Palter. Layer Two Tunneling Protocol L2TP.
RFC 2661, IETF, 1999.
60. Wisher. http://www.wisher.com