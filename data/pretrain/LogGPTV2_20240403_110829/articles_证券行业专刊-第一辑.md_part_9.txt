### 甲方单位的漏洞管理浅谈

#### 一、漏洞情报预警
漏洞情报来源主要包括国家信息安全漏洞库（CNNVD）、安全服务厂商、行业监管机构和公安机关等。通过资产管理系统借助HIDS抓取的资产组件，可以实现快速匹配和定位受影响资产。

#### 二、漏洞研判
漏洞研判的关键点包括：
1. **快速定位受影响资产**：通过调用扫描器API或自定义检测插件，快速定位受影响资产和关联业务系统。
2. **完善漏洞信息**：
   - 漏洞的可利用程度（如攻击路径、触发要求、权限要求、用户交互程度、利用代码成熟度）；
   - 被攻击后的影响程度（如对机密性、完整性、可用性方面的影响）；
   - 补丁情况和漏洞来源可信度（必要时进行漏洞验证）；
   - 建议的漏洞修复方案和缓解措施；
   - 关联的漏洞知识库条目。
3. **明确漏洞研判人**：根据单位漏洞管理办法，从漏洞类型和受影响资产情况确认研判小组人员。例如，主机漏洞涉及操作系统负责人，外购系统漏洞涉及应用系统负责人和外部厂商，自研系统漏洞涉及开发负责人。
4. **漏洞风险定级**：结合漏洞本身和资产情况对漏洞风险进行综合评价，包括两个步骤：
   - **首次定级**：确定漏洞原始风险等级，采用定性和定量两种方式。定量方式常用通用漏洞评分系统CVSS（最新版为V3.1），其他模型包括微软威胁评级模型DREAD、卡耐基梅隆大学特定相关者漏洞分类法SSVC、OWASP风险评级方法等。
   - **最终定级**：根据实际情况调整漏洞风险级别，考虑因素包括漏洞防范情况和外部环境因素（如监管部门通报或敏感时期的漏洞）。

#### 三、漏洞修复
1. **高效流转**：以工单形式高效流转，自动关联修复责任人，并通过OA任务和邮件自动通知状态变更。
2. **丰富漏洞知识库**：除了漏洞基本信息外，工单关联该类漏洞的知识库，补充漏洞原理、利用手段、加固方法、修复方法和验证方法，并更新到漏洞知识库中。
3. **加强沟通**：修复人可能会质疑通报结果或提出不同的处置方式，需要安全团队提高专业能力，加强沟通。

#### 四、风险控制方案
制定整体控制方案，包括修复方案和防范措施。对于高危及以上漏洞，应评估并采取有效的风险防范措施，如排查、监控和阻断漏洞利用，限制访问时间等。对于超期未修复漏洞，系统应自动提醒修复人，并定期生成修复进度报表发送给相关方。

#### 五、延期修复机制
修复人因特殊情况可申请延期修复漏洞。不同风险等级的漏洞设置不同的审批程序和延期期限要求。对于搁置的漏洞，设置到期前提醒，并列入每月报表中定期跟踪。

#### 六、漏洞复测
对漏洞修复情况进行复测验证，尽量通过自助式自动化实现。通常大部分漏洞可通过自动调用扫描器的API接口进行复测，并同步检测结果。对于业务逻辑类漏洞，主要通过人工复测。复测通过后，回顾之前临时采取的限制性防护措施。

#### 七、复盘优化
1. **单个漏洞层面**：
   - **发现问题**：通过对漏洞管理各环节的过程回顾和数据分析，发现存在的问题。
   - **分析问题**：对发现的问题开展原因分析，深度回溯漏洞发生的原因。
   - **解决问题**：识别可改进环节，与相关人员沟通确认改进措施、负责人和排期，完成漏洞报告中的复盘结论，并更新漏洞知识库。

2. **整体漏洞运营层面**：
   - 定期开展问题分析和总结报告，基于度量指标做漏洞趋势分析、重要漏洞分析、漏洞修复效能分析等。
   - 结合漏洞管理的目标，设置度量指标，分为以下几类：
     - **识别漏洞风险态势**：如攻击暴露面高危风险以上漏洞数、已逾期的高危以上风险漏洞数等。
     - **提高漏洞研判和防护能力**：如不同级别漏洞的研判时间、防护措施生效时间等。
     - **提高漏洞发现能力**：如资产数据、纳管资产数据、未纳管资产数据等。
     - **提高漏洞修复能力**：如修复时间、修复率和逾期修复率等。

通过这些步骤，可以有效管理和控制漏洞，提高整体安全性。