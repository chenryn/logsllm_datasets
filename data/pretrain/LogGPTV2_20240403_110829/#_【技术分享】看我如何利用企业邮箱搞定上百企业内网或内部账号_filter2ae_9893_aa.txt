# 【技术分享】看我如何利用企业邮箱搞定上百企业内网或内部账号
|
##### 译文声明
本文是翻译文章，文章来源：freecodecamp.org
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
译者：[兴趣使然的小胃](http://bobao.360.cn/member/contribute?uid=2819002922)
预估稿费：260RMB
投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿
**一、前言**
****
几个月以前，我发现了一个漏洞，黑客们利用这个漏洞可以获取企业的内部通信数据。漏洞利用起来非常简单，只需要几次点击就有可能访问企业的内部网络、社交媒体账号，比如Twitter以及更为常见的Yammer以及Slack协同账户。
漏洞目前仍然没被修复，因为这种漏洞很难在第一时间修复。在过去的几个月中，我联系了数十家公司以及受影响的厂商，参与这些公司及厂商的漏洞奖励计划以促使他们修复相关漏洞。由于受影响企业数量较多，我无法一一联系上。根据一些黑客小伙伴们的建议，在相关厂商的许可下，我撰写并发布了这篇文章，以便让受影响的每个单位能立即修复这个漏洞。我将这个漏洞称之为Ticket
Trick。
**二、拦路门：需使用企业邮箱注册**
****
如Slack、Yammer以及Facebook
Wrokpace之类的商业协同交流平台要求员工使用他们的企业（@company）邮箱来注册平台账户。员工的企业邮箱会收到一封包含确认链接的邮件，一旦员工点击这个链接，他们就可以成为公司的一份子，进行内部交流。
在Slack中，使用相同@company邮箱的用户可以默认加入同一个团队，我们可以将其改为SSO（单点登录）机制或者邀请机制。
在Yammer中，只要拥有@company邮箱，任何人都可以加入。
在Facebook Workpace中，只要拥有@company邮箱，任何人都可以加入。
**三、敲门砖：服务台（helpdesk）或使用邮件创建（create-by-email）功能**
****
**3.1 方法1：问题追踪功能（THE ISSUE TRACKER）**
事情最早可以从GitLab开始说起，对于Slack而言，我发现只要使用有效的@gitlab.com邮箱，就能加入GitLab官方团队中。
与此同时，GitLab提供了一个功能，可以通过电子邮件来创建issue，只要将具体的issue发送到某个@gitlab.com邮箱地址即可。如下图所示，出于隐私原因，我隐去了这个地址。
还有其他企业提供了通过邮件来创建、跟踪issue的功能，GitLab只是其中一员而已。
我尝试利用这个邮箱地址来加入GitLab在Slack上的团队，想看看能不能成功。
我马上刷新了我的问题清单，然后发现确认邮件已作为某个issue添加到我的项目中：
刚添加进来的这个issue中包含一个神奇链接，通过这个链接我们可以加入GitLab的内部Slack团队：
我点击了这个链接，结果与我设想的一样。我收到了一堆欢迎加入的信息（如下图所示），然后我马上删除了我的账号，并向GitLab反馈了这个问题。
GitLab在在同一天晚上回复了我提交的报告。
他们马上就把Slack设置为邀请模式，并向他们的客户通告了这个功能的危险性。
**3.2 方法2：支持台（THE SUPPORT DESK）**
只有上百个网站拥有开放的issue跟踪功能，所以我想再深入分析一下，看能不能挖掘出一个更加通用的漏洞利用方法。事实上我的确找到了这样一种利用方法，并且这种利用方法比我预想的还要通用，那就是客户服务（customer
service）。
发往PI:EMAIL的邮件有时候会出现在某个在线支持门户平台中，比如Zendesk、Kayako、（Fresh）Desk、WHMCS或者某个定制工具中。因此我决定研究一下这个方面，看黑客能否从数据库里提取出关键链接。
这些门户中，大多数都可以集成单点登录（SSO）功能：经过认证的用户可以自动登录到服务台，以确保用户的无缝体验。在我测试的网站中，超过一半网站不需要验证电子邮件，这意味着任何人都可以使用任何电子邮件地址来注册并阅读由该邮件地址所创建的任何支持票据（support
ticket）。在线视频分享平台Vimeo正是不需要进行验证的公司之一。
所以我注册了一个Vimeo账户，所用邮箱为PI:EMAIL，这个邮箱正是Slack用来发送验证链接的那个邮箱。
Slack有个非常方便的“[查找工作区（find your
workspace）](https://slack.com/signin/find)”的功能，利用这个功能，我找到了Vimeo对应的那个实例，然后使用PI:EMAIL这个地址完成了注册。
在后台处理逻辑中，PI:EMAIL会往PI:EMAIL这个地址发送一封邮件，其中包含验证链接。
当PI:EMAIL收到这封邮件后，该邮件会被归类为由PI:EMAIL所创建的支持票据，而后者正是我用来注册的那个邮箱。
因此，我前往帮助中心，检查我收到的支持票据。
我的确收到了一个支持票据，其中包含一个验证链接，通过这个链接我可以加入Vimeo团队。
Vimeo团队马上响应了我提交的漏洞报告，并根据他们的漏洞奖励计划给我发放了2,000美元的奖励（[#220102](https://hackerone.com/reports/220102)，细节待公布）。
**集成了支持门户工具又缺少邮箱验证机制的所有网站都会受到此漏洞影响，并且形势比想象中的更加严峻。**