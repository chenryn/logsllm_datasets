title:Tracking anonymous peer-to-peer VoIP calls on the internet
author:Xinyuan Wang and
Shiping Chen and
Sushil Jajodia
Tracking Anonymous Peer-to-Peer
VoIP Calls on the Internet ∗
Xinyuan Wang
Shiping Chen
Department of Information and
Center for Secure Information
Software Engineering
George Mason University
Fairfax, VA 22030, USA
PI:EMAIL
Systems
George Mason University
Fairfax, VA 22030, USA
PI:EMAIL
Sushil Jajodia
Center for Secure Information
Systems
George Mason University
Fairfax, VA 22030, USA
PI:EMAIL
ABSTRACT
Peer-to-peer VoIP calls are becoming increasingly popular
due to their advantages in cost and convenience. When these
calls are encrypted from end to end and anonymized by low
latency anonymizing network, they are considered by many
people to be both secure and anonymous.
In this paper, we present a watermark technique that
could be used for eﬀectively identifying and correlating en-
crypted, peer-to-peer VoIP calls even if they are anonymized
by low latency anonymizing networks. This result is in con-
trast to many people’s perception. The key idea is to em-
bed a unique watermark into the encrypted VoIP ﬂow by
slightly adjusting the timing of selected packets. Our analy-
sis shows that it only takes several milliseconds time adjust-
ment to make normal VoIP ﬂows highly unique and the em-
bedded watermark could be preserved across the low latency
anonymizing network if appropriate redundancy is applied.
Our analytical results are backed up by the real-time exper-
iments performed on leading peer-to-peer VoIP client and
on a commercially deployed anonymizing network. Our re-
sults demonstrate that (1) tracking anonymous peer-to-peer
VoIP calls on the Internet is feasible and (2) low latency
anonymizing networks are susceptible to timing attacks.
Categories and Subject Descriptors
C.2.0 [Computer-Communication Networks]: General—
Security and protection (e.g., ﬁrewalls); C.2.3 [Computer-
Communication Networks]: Network Operations—Net-
work monitoring
General Terms
Security
∗This work was partially supported by the Air Force Re-
search Laboratory, Rome under the grant F30602-00-2-0512
and by the Army Research Oﬃce under the grants DAAD19-
03-1-0257 and W911NF-05-1-0374.
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’05, November 7–11, 2005, Alexandra, Virginia, USA.
Copyright 2005 ACM 1-59593-226-7/05/0011 ...$5.00.
Keywords
VoIP, Anonymous VoIP Calls, VoIP Tracing, Peer-to-Peer
Anonymous Communication
1.
INTRODUCTION
VoIP is a technology that allows people to make phone
calls through the public Internet rather than traditional
Public Switched Telephone Network (PSTN). Because VoIP
oﬀers signiﬁcant cost savings with more ﬂexible and ad-
vanced features over Plain Old Telephone System (POTS),
more and more voice calls are now carried at least par-
tially via VoIP. In fact, consulting ﬁrm Frost & Sullivan has
predicted that VoIP will account for approximately 75% of
world voice services by 2007.
For privacy reasons, people sometimes want their phone
conversation to be anonymous and do not want other people
know that they have even talked over the phone. The use
of VoIP has made it much easier to achieve anonymity in
voice communications, especially when VoIP calls are made
between computers. This is because VoIP calls between peer
computers have no phone numbers associated with them,
and they could easily be protected by end to end encryption
and routed through low latency anonymizing networks (e.g.,
Onion Routing [13], Tor [6], Freedom [3], and Tarzan [12]) to
achieve anonymity. People intuitively think their computer
to computer VoIP calls could remain anonymous if they are
encrypted end to end and routed through some low latency
anonymizing network.
On the other hand, law enforcement agencies (LEA) of-
ten need to conduct lawful electronic surveillance in order to
combat crime and terrorism. For example, the LEAs need
techniques to determine who has called the surveillance tar-
get and to whom the surveillance target has called.
In a
letter to FCC [8], several federal law enforcement agencies
have considered the capability of tracking VoIP calls “of
paramount importance to the law enforcement and the na-
tional security interests of the United States.”
How to balance people’s needs for privacy and anonymity
and the security requirements of the law enforcement agen-
cies has been a subject of controversy. In this paper, we leave
the controversy between anonymity and security aside and
instead focus on the technical feasibility of tracking anony-
mous peer-to-peer VoIP calls on the Internet. Our goal is
to investigate practical techniques for the eﬀective track-
ing of anonymous VoIP calls on the Internet and identify
the weakness of some of the currently deployed anonymous
communication systems.
81We choose to investigate the popular Skype [28] peer-to-
peer VoIP calls in the context of the anonymous VPN pro-
vided by ﬁndnot.com [11]. Skype oﬀers free computer to
computer VoIP calls based on KaZaa [16] peer-to-peer tech-
nology. Several properties of Skype have made it an attrac-
tive candidate for the investigation of tracking anonymous
VoIP calls on the Internet:
• It is free and widely used. Since August 2003, there
are over 100 million downloads of the Skype client. It
is being actively used by millions of people all over the
world. Skype is now included in Kazaa v3.0.
• All the Skype traﬃc is encrypted from end to end by
256-bit AES encryption.
• Skype can automatically traverse most ﬁrewalls and
NAT (Network Address Translation) gateways with
the help of intermediate peers.
• Skype intelligently and dynamically routes the encrypted
calls through diﬀerent peers to achieve low latency.
This means that the route and the intermediate peer(s)
of one VoIP call could be changed during a call.
• It uses proprietary peer-to-peer signaling protocol to
set up the VoIP calls.
Since most Skype calls are carried in UDP, we can not di-
rectly use those anonymizing systems (such as Onion Rout-
ing [13], Tor [6] or anonymizer.com [1]), who do not support
anonymization of all UDP ﬂows, to anonymize Skype VoIP
calls. We choose to use the anonymous communication ser-
vices by ﬁndnot.com [11] that support anonymization of all
IP protocols through point to point tunnel protocol (PPTP).
The key challenge in tracking encrypted VoIP calls across
anonymous communication system is how to identify the
correlation between the VoIP ﬂows of the caller and the
callee. Since all the traﬃc of the peer-to-peer VoIP calls are
encrypted, no signaling information is available for correla-
tion. To be able to track encrypted, anonymous VoIP calls
across the Internet, we use the timing characteristics of the
anonymized VoIP ﬂow. Unfortunately, the original inter-
packet arrival characteristics of VoIP ﬂows are not distinct
enough as the inter-packet timing arrival time of VoIP traf-
ﬁc is determined by the frame packetization interval used.
This means that passive comparison of the original inter-
packet timing characteristics of VoIP ﬂows will not be able
to distinguish diﬀerent VoIP calls.
In order to uniquely identify the anonymous VoIP calls
through inter-packet timing characteristics, we use an ac-
tive approach to deliberately make the inter-packet timing
of VoIP calls more distinctive. The idea is to embed a unique
watermark into the inter-packet timing of the VoIP ﬂows by
slightly adjusting the timing of selected packets. If the em-
bedded watermark is unique enough and robust enough, the
watermarked VoIP ﬂows could be eﬀectively identiﬁed. By
utilizing redundancy techniques, we can make the embed-
ded watermark robust against random timing perturbation
provided there are enough packets in the VoIP ﬂow.
Our analytical and experimental results demonstrate that
(1) tracking anonymous peer-to-peer VoIP calls on the In-
ternet is feasible and (2) low latency anonimizing systems
are susceptible to timing attack. Our VoIP tracking tech-
nique does not require the global monitoring capability, and
it could be used to determine if party A is communicating
(or has communicated) with party B via peer-to-peer VoIP
even if the VoIP traﬃc is (or has been) disguised by low
latency anonymous communication systems.
The rest of the paper is organized as follows. Section 2
formulates the problem of tracking anonymous peer-to-peer
VoIP calls, and describes the overall tracing model. Sec-
tion 3 presents the active timing based tracking method and
analyzes its eﬀectiveness. Section 4 describes our implemen-
tation of the high precision VoIP watermarking engine in
real-time Linux kernel. Section 5 evaluates the eﬀectiveness
of our method empirically. Section 6 summarizes related
works. Section 7 concludes the paper.
2. THE OVERALL MODEL OF TRACING
ANONYMOUS PEER-TO-PEER VOIP
CALLS
Given any two diﬀerent Skype peers A and B, we are
interested in determining if A is talking (or has talked) to
B via Skype peer-to-peer VoIP. As shown in Figure 1, both
Skype peers A and B have outgoing and incoming VoIP ﬂows
to and from the Internet cloud. The Skype peers could be
behind ﬁrewall and NAT, and peer A and/or B could be
connected to some low latency anonymizing network. Here
we view the Internet cloud and any low latency anonymizing
network as a black box, and we are interested only in the
Skypy ﬂows that enter or exit the black box. We assume
that (1) we can monitor the Skype ﬂow from the black box
to the Skype peer; (2) we can perturb the timing of the
Skype ﬂow from the Skype peer to the black box.
Here we do not intend to track all the peer-to-peer VoIP
calls from anyone to anyone, nor do we assume the global
monitoring and intercepting capability. Instead we focus on
ﬁnding out if some parties in which we are interested have
communicated via peer-to-peer VoIP calls anonymously, and
we only need the capability to monitor and intercept IP ﬂows
to and from those interested parties. This model is consis-
tent with our understanding of the common practice of law-
ful electronic surveillance by the law enforcement agencies.
Because the Skype VoIP ﬂows are encrypted from end to
end, no correlation could be found from the ﬂow content.
Given that the Skype VoIP ﬂow could pass some intermedi-
ate Skype peers and some low latency anonymizing network,
there is no correlation from the VoIP ﬂow headers. Among
all the characteristics of the VoIP ﬂows, the inter-packet
timing characteristics are likely to be preserved across inter-
mediate Skype peers and low latency anonymizing network.
This invariant property of VoIP ﬂows forms the very foun-
dation for tracking anonymous, peer-to-peer VoIP calls on
the Internet.
A number of timing based correlation methods have been
proposed, and they can be classiﬁed into two categories:
passive and active. Passive timing based correlation ap-
proaches (e.g. [35], [34], [33] [7], [5]) correlate the encrypted
ﬂows based on passive comparison of their timing charac-
teristics, and they have been shown to be eﬀective when
the timing characteristics of each ﬂow are unique enough.
However, the inter-packet timing characteristics of all VoIP
ﬂows are very similar to each other. The inter-packet ar-
rival time of VoIP ﬂows is determined by the voice codec
and the corresponding packetization interval, and there are
only a few commonly used VoIP packetization intervals (i.e.
82Figure 1: Anonymous Peer-to-Peer VoIP Calls Tracing Model
20ms or 30ms). Therefore, passively comparing the timing
characteristics of VoIP ﬂows will not be able to distinguish
diﬀerent VoIP ﬂows.
Wang and Reeves [32] proposed the ﬁrst active approach
to correlate the encrypted ﬂows. They suggested embedding
a unique watermark into the inter-packet timing domain of
the interactive ﬂow through deliberate timing adjustment of
selected packets, and correlating based on the embedded wa-
termark. Because the embedded watermark could make an
otherwise non-distinctive ﬂow unique, their active method
has the potential to diﬀerentiate ﬂows with very similar tim-
ing characteristics. However, the method proposed in [32]
can not be directly used to correlate VoIP ﬂows due to the
following reasons:
• The VoIP traﬃc has stringent real-time constraints,
and the total end to end delay should be less than
150ms.
• The inter-packet arrival time of VoIP ﬂows is very
short (i.e. 20ms or 30ms). This requires any time ad-
justment on VoIP packet to be very precise and small.
• The watermarking method proposed by Wang and Reeves
is based on the quantization of averaged Inter-Packet
Delays (IPDs), and it requires packet buﬀering in or-
der to achieve the even timing adjustment over diﬀer-
ent packets. The required buﬀering would be too long
for the real-time VoIP ﬂows.
To correlate anonymous VoIP ﬂows with similar inter-
packet timing characteristics, we use an active approach to
deliberately yet subtly make the inter-packet timing charac-
teristics of the VoIP ﬂows more unique. This is achieved by
embedding a unique watermark into the inter-packet timing
domain of the VoIP ﬂow in real-time.
To address the limitations of previous work [32], we use a
new watermarking scheme that is suited for tracking anony-
mous VoIP traﬃc in real-time. The key challenge in track-
ing anonymous VoIP calls by the active approach is how
to precisely adjust the packet timing without buﬀering and
guarantee the even time adjustment of those selected pack-
ets.
3. ACTIVE TIMING BASED TRACKING OF
VOIP FLOWS
We present the new watermarking scheme which guar-