### CISSP 学习指南（第 7 版）
#### 19.3.3 事故响应过程

许多组织采用三步骤的事故响应过程，该过程包括以下三个阶段：
1. 检测和确认
2. 响应和报告
3. 恢复和补救

接下来，我们将概述标准事故响应过程的这三个阶段。

**步骤 1: 检测和确认**

事故检测的主要目标是确定事故并通知相关人员。为了成功检测事故，安全团队必须监控所有相关事件，并在事件达到安全事故定义的阈值时发出警报。关键在于识别所有异常或可疑活动，这些活动可能是事故的证据。虽然根据攻击的典型特征可以检测到攻击，但有经验的攻击者知道如何隐藏其行为。因此，清晰了解系统正常运行状态至关重要。异常或可疑活动指的是系统中发生的任何不正常的活动。

以下工具和技术可用于监控表明安全事故的事件：
- 入侵检测/防御系统
- 反病毒软件
- 防火墙日志
- 系统日志
- 物理安全系统
- 文件完整性监控软件

在调查事故时，应使用多个数据源。对任何不合理活动都要保持怀疑态度，并确保能够解释系统中的任何异常活动。如果只是“感觉”不对劲，这可能成为阻止正在发生事故的唯一线索。

一旦初步评估员确定事件满足组织的安全事故标准，就必须通知事故响应团队。通知应总结事故的检测、确认、初步响应和报告阶段。

**步骤 2: 响应和报告**

确定事故后，下一步是采取适当的行动。安全策略应指定针对各类事故的步骤。始终假设事故最终会诉诸法律，收集证据时必须确保证据符合出庭标准。如果证据受损，将无法追回，因此必须确保证据链的完整。

**隔离与抑制**
首要行动应限制组织泄密并防止进一步破坏。对于可能泄密的系统，应断开其与网络的连接，以阻止入侵者访问受危害的系统，并防止受害系统影响网络中的其他资源。

**警告:**
保持受害系统运行状态至关重要。切勿关闭受害系统！关闭计算机会毁坏易失性存储设备中的内容，从而可能破坏证据。

**收集证据**
为了进行适当的调查，通常需要没收设备、软件或数据。以下是三种基本选择方案：

1. **自愿交出**：拥有证据的人可能会自愿交出证据。这种情况通常适用于攻击者不是所有者的情况。然而，有罪的人很少会自愿交出控告他们犯法的证据。经验不足的攻击者可能认为自己已经成功掩盖了痕迹，从而自动交出重要证据。一名优秀的法庭调查员可以从计算机上提取“被隐藏”的信息。在大多数情况下，从可疑攻击者那里寻找证据是为了警告嫌疑犯进一步采取法律行动。
   
   **提示:**
   在内部调查中，你通常会在高级管理人员的支持下进行调查，他们会授权你访问完成调查所需的任何资源。

2. **法院传票或法令**：法院可以发出传票或法令，强迫个人或组织交出证据，并由执法部门强制执行。这种做法会引起注意，并可能导致更改证据使之在法庭上无效。

3. **搜查证**：只有在不惊扰证据的所有者或其他当事人的情况下获取证据时才选择申请搜查证。必须通过合理可信的强烈怀疑使法官同意采取这种行动。

这些选择方案适用于没收组织内外的设备。此外，让所有新员工签署协议，同意在调查期间可搜寻和没收任何必要证据，已成为常见做法。通过这种方式，同意条款作为雇用协议的一部分，使得没收措施更容易执行，并减少了等待法律许可而导致证据丢失的可能性。确保安全策略涉及这一重要主题。

在决定收集何种证据时，应考虑以下数据源：
- 涉及事故的计算机系统（服务器和工作站）
- 安全系统（如入侵检测、文件完整性监控和防火墙）的日志
- 网络设备的日志
- 物理访问日志
- 与被调查事故相关的其他数据源

**分析与报告**
完成证据收集后，应对证据进行分析以确定导致事故的一系列事件。在提交给管理部门的书面报告中概述这些发现。报告应慎重描述事实并给出意见。对可能的原因进行推断是可以接受的，但结论陈述应完全基于事实，并需具备一定的估计判断。

**步骤 3: 恢复与补救**

在完成调查后，还需执行两个任务：将工作环境恢复至正常运营状态，并通过“总结经验教训”过程提高未来应对事故的能力。

**恢复**
恢复过程的目标是修正所有已发生的破坏，并限制未来类似事故造成的破坏。此过程应采取以下关键行动：
- 重构受危害的系统，纠正可能导致事故的安全漏洞。
- 如有必要，还原备份数据以替代完整性出现问题的数据。
- 如有必要，增补现有安全控制以弥补事故分析期间确定的缺陷。

完成恢复过程后，业务应回到事故前的状态并重新运营（但采用更安全的方式）。

**总结经验教训**
事故响应过程的最后阶段是召开“总结经验教训”会议。在此过程中，事故响应团队成员回顾他们在事故期间的活动，寻找改进之处。通过分析实际事故期间的效力，这种事后反思行为为今后成功的事故响应提供了重要参考。

#### 19.3.4 约谈个人

在事故调查期间，可能需要与掌握相关信息的人员进行谈话。如果只是为了获取有助于调查的信息，这种谈话称为约谈。如果怀疑某人涉嫌犯罪并希望收集法庭可用的证据，则称为审问。

约谈和审问是一种专门技巧，应仅由训练有素的调查人员进行。不当方法可能损害执法部门成功起诉嫌疑人的能力。此外，许多法律涉及对人员的限制或拘留。如果打算进行私下审问，必须严格遵守这些法律。在进行任何约谈之前，始终要与律师商讨相应的对策。

#### 19.3.5 事故数据的完整性和保存

无论证据多么有力，如果在收集过程中发生变化，都会被法院拒绝受理。务必确保维护所有证据的完整性，并在数据收集之前了解数据完整性的重要性。

我们不可能检测到所有正在进行的事故。有时，调查结果会揭示以前未被发现的事故。如果在跟踪证据时，发现包含攻击者相关信息的重要日志文件已被清除，将令人沮丧。务必认真考虑日志文件的作用或其他可能存在证据的地方。简单的归档策略有助于确保在需要时获得证据，无论事故发生多长时间。

由于许多日志文件包含有价值的证据，攻击者常在成功攻击后试图清除这些证据。应采取措施保护日志文件的完整性和防止修改。一种技术是实现远程日志记录，其中网络中的所有系统将日志发送到一台中央日志服务器，该服务器被锁定以防止攻击，从而保护日志文件在事故发生后不被清除。此外，系统管理员经常使用数字签名来证明日志文件在最初获取后未被篡改。更多相关信息，请参阅第7章“PKI和密码学应用”。

由于涉及安全计划的各个方面，无法实现统一的解决方案。务必熟悉系统并采取措施，使组织以最合理方式对其进行保护。

#### 19.3.6 事故报告

何时报告事故？向谁报告？这些问题通常很难回答。安全策略中应包含回答这两个问题的指导方针。报告事故时有一条基本原则：如果每个事故都进行报告，可能会被认为是麻烦制造者。当发生严重事故时，报告可能会被忽略。同样，报告不重要的事故会给人留下组织容易受到攻击的印象，这对实施严格安全措施的组织不利。例如，在每天听说银行发生事故后，公众对银行的安全实践措施的信心会下降。

另一方面，如果不及时报告事故，自动调整和法律制裁将变得更加困难。如果延迟向管理机构报告严重事故，可能会面临关于延迟动机的质疑，甚至无辜的人可能看起来像是试图隐瞒某些情况。

与大多数安全主题一样，回答这个问题并不容易。事实上，某些事故的报告可能受到法律或法规的限制。必须确信自己了解所要上报的事故。例如，存储信用卡信息的组织必须对信息泄露事故进行上报。

在事故发生前，与公司的法律人员和适当的执法代理机构建立良好的关系是非常明智的。找到适合组织的执法联络人并与他们协商。提前努力建立关系的工作将在报告事故时见到成效。如果已经了解正在与你谈话的人，将减少介绍和解释的时间。预先确定一名联系人作为组织与执法部门的联络人员是一个不错的主意。这种做法有两点好处：首先，确保执法部门从固定的联络人那里了解组织的想法并知道通过何人进行调查；其次，允许预先指示联络人与执法人员建立良好的工作关系。

**注意:**
与执法部门建立技术联系的一个好方法是参与FBI的InfraGard计划。InfraGard覆盖了美国大部分大都市区域，为执法人员和业务安全人员提供了一个封闭环境中共享信息的论坛。更多信息，请访问www.infragard.org。

一旦决定报告事故，应确保报告尽可能多地包含以下信息：
- 事故的性质是什么？
- 事故是如何开始的？
- 事故是由谁引起的？

通过以上优化，文本更加清晰、连贯和专业，便于读者理解和参考。