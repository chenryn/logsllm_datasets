P
SER
PER
  Inf
 0.00
 0.92
 1.94
 3.10
 7.96
 6.02
 4.44
SNR (dB)
10.46
13.98
20.00
(e) Error Rate Vs. Signal Strength
(f) Error Rate Vs. SNR
USRP N210
Noise Generator
USRP N210
WiFi Detector
USRP N210
Emulated ZigBee Sender
h
t
g
n
e
L
e
d
o
C
h
t
u
A
80
70
60
50
40
30
20
10
0
Auth Code Length
Worst Case Time-consuming
Average Time-consuming
1.05e7
5.25e6
10.04
5.02
9.58e-6
4.79e-6
1.1e13
5.5e12
1015
1010
105
100
10-5
2
4
8
16
Num of Available Symbol Pairs
(c) Experiment Scenario
(d) Security Levels
)
r
a
e
y
(
k
c
a
t
t
A
e
c
r
o
F
e
t
u
r
B
i
f
o
g
n
m
u
s
n
o
c
-
e
m
T
i
1
0.9
0.8
0.7
0.6
i
e
t
a
R
g
n
d
o
c
e
D
y
l
t
c
e
r
r
o
C
0.5
0
1
i
e
t
a
R
g
n
d
o
c
e
D
y
l
t
c
e
r
r
o
C
0.8
0.6
0.4
=1
=2
=3
=4
=5
C=2
C=4
C=8
C=16
5
10
SNR (dB)
15
20
0.2
0
5
10
SNR (dB)
15
20
Figure 13: Attacking Performance
(e) Field Experiment Results of Decoding
Accuracy with different Δ
(f) Field Experiment Results of Decoding
Accuracy with different C
available CP lengths is widened, the distinguishability of different
CP lengths is improved. Therefore, the decoding error rate will
decrease. Fig. 14(b) shows the decoding accuracy with different
C and SNR. In the low SNR part, a small C often has a higher
decoding accuracy. This is because when the number of available
CP lengths is small, the cases that may cause errors are limited, so
the decoding accuracy is higher. However, when the SNR is large,
regardless of how many available CP lengths are used, the decoding
errors are unlikely to happen. So the C value will not affect the
decoding accuracy obviously. From another point of view, the C
value should be as large as possible, because when the number of
available symbol pairs is large, a symbol pair can represent more bits
of the authorization code so that the total length of authorization
code can be longer, which will provide a higher level of security, as
shown in Fig. 14(d).
For the field experiments, we also measure the impact of Δ and
C on decoding accuracy. Fig. 14(e) and Fig. 14(f) show the results,
which are similar to the simulation results although there are some
fluctuations which are caused by multi-path effect and random
noise in the practical environment.
The above experiments demonstrate that our authorization code
decoding mechanism (includes the high-precision delimiting method)
is valid and accurate. In practical applications, we can set the thresh-
old to 80%, i.e., as long as 80% of the received authorization codes
are correct, we can regard the signal as legitimate CTC signal.
Figure 14: WEA Detection and AuthCTC Performance
6 RELATED WORK
6.1 Cross-Technology Communication
Most of existing CTC schemes focus on improving throughput and
shortening the communication delay, which can be classified into
two categories: packet level CTC and physical level CTC.
For the packet level CTC, it uses packet level information (e.g.,
packet duration [5, 53], beacon interval [22], energy pattern [9,
20, 45], energy level [10, 15, 54]) as the minimal unit to construct
special pattern that can be detected by other technologies [18, 40].
Esense [5] proposes a WiFi to ZigBee CTC technology by sensing
the WiFi packet length at the ZigBee side, in which the packet
length is specified and can be distinguished from noise. FreeBee
[22] proposes a CTC technology among WiFi, ZigBee and Bluetooth
by modulating data into WiFi beacons and shifting the transmission
timings of them. C-Morse [45] proposes a WiFi to ZigBee CTC tech-
nology by constructing a series of Morse-code-like long and short
WiFi packets that can be demodulated at the ZigBee side. B2W 2
[10] proposes a Bluetooth to WiFi CTC technology by modulating
the energy level of Bluetooth packets and demodulated through
WiFi CSI at the receiver side. Packet level CTC usually has a low
network throughput and large transmission delay.
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan30The recent advances in physical level CTC [7, 13, 19, 24, 25] estab-
lish direct physical layer communication via software-based signal
emulation. WEBee [24] proposes a WiFi to ZigBee CTC technology
by constructing the payload of a WiFi frame elaborately so that the
waveform of payload resembles that of ZigBee signals. BlueBee [19]
proposes a Bluetooth to ZigBee CTC technology by exploring the
opportunities in the signal phase shifts. TwinBee [7] improves the
reliability of WiFi to ZigBee CTC by recovering intrinsic errors of
signal emulation. LongBee [25] extends the transmission range of
WiFi to ZigBee CTC by concentrating the TX power and improving
RX sensitivity. WIDE [13] proposes a novel WiFi to ZigBee CTC
technology by digital emulation, i.e., decodes symbols by phase
shift instead of waveform. Physical level CTC can achieve the max-
imum transmission rate but also face asymmetric link issues [40],
i.e., signal emulation is only applicable for higher-end transmitter
to lower-end receiver scenario. This is because powerful radios
support sophisticated modulations that can offer higher degrees of
freedom in waveform control but not vice versa [18].
6.2 RF Fingerprinting
RF fingerprinting is also used to identify the transmitter. Most radio
fingerprinting methods identify a device by considering various
physical-layer classification approaches. According to [4], RF fea-
tures are broadly classified into: (1) channel-specific ones, which
characterize the wireless channel, e.g., channel impulse response;
(2) transmitter-specific ones, which are independent of the channel,
e.g., signal encoding. Channel-specific features have been success-
fully adopted in robust location distinction [26, 28] by uniquely
identifying the channel between the transmitter and the receiver.
Transmitter-specific features refer to the RF features that are related
to the signal itself [4, 11, 30]. For example, the authors in [4] mea-
sure differentiating artifacts of individual wireless frames to achieve
accurate NIC identification. In [11], the fingerprinting technique
considers the unique features in the radio turn-on transients that
appear at the beginning of each transmission. Joint time-frequency
Gaborand Gabor-Wigner Transform features are considered in [30]
as an approach to extract greater device discriminating information.
Besides the above software-based radio fingerprinting methods, the
identity can also built on the properties of hardware. However, it is
difficult to apply the radio fingerprint techniques on commercial
off-the-shelf devices since their unmodifiable features.
6.3 PHY Security Schemes in Heterogeneous
Environment
Our identified waveform emulation attack is related to the security
schemes using physical layer approaches. The most relevant works
are either keyless or key-based approaches [17].
For keyless approaches, typical techniques are to improve the
secrecy by making eavesdropper’s SINR lower than the receiver’s
SINR, which include exploiting channel coding [23], channel adap-
tation [47] and artificial noise injection [43], etc. These approaches
focus on avoiding passive eavesdropping instead of recognizing
active attacks.
The key-based approach provides secrecy by extracting random
keys from the channel of legitimate parties and manipulate them
at higher layers. Typical techniques to extract secret key include
exploiting channel variation caused by fading [44], relays [38, 50]
and subcarriers [8], etc. However, key-based approaches are used
among homogeneous devices instead of heterogeneous devices.
To the best of our knowledge, there is no security mechanism
that can effectively detect attacks among heterogeneous devices
(e.g., WEA), especially in an IoT environment that allows the cross-
technology communication.
7 CONCLUSION
In this paper, we propose and implement a novel attack in the cross-
technology communication (CTC) environment, named as Wave-
form Emulation Attack (WEA), where a WiFi device can eavesdrop
on the ZigBee communication channel, and then emulate ZigBee
signals to control target devices. Then, we develop a physical layer
defensive mechanism to defend against this kind of attack. At the
sender side, the legitimate CTC device can embed an authorization
code into the preamble of the packet by changing the CP length
dynamically. At the receiver side, a detector is used to verify the au-
thorization code. Since the authorization code is changing over time,
an illegitimate device cannot know the next available authorization
code so that its packet cannot pass the verification. Through this
mechanism, end ZigBee devices can verify the legitimacy of CTC
signals. Experiment results demonstrate that the WEA is feasible
and our defense mechanism can defeat it effectively.
ACKNOWLEDGMENTS
We would like to thank Dr. Selcuk Uluagac and other anonymous
reviewers for their helpful feedback. The work of L. Guo is partially
supported by National Science Foundation (NSF) CNS-1947065,
ECCS-1949639, and IIS-1949640. The work of K.C. Wang is partially
supported by National Science Foundation (NSF) CNS-1643020.
REFERENCES
[1] Abbas Acar, Hossein Fereidooni, Tigist Abera, Amit Kumar Sikder, Markus Miet-
tinen, Hidayet Aksu, Mauro Conti, Ahmad-Reza Sadeghi, and A Selcuk Uluagac.
2018. Peek-a-Boo: I see your smart home activities, even encrypted! arXiv
preprint arXiv:1808.02741 (2018).
[2] Amazon. [n.d.]. Osram Lightify Smart LED Bulb. https://www.amazon.com/
Sylvania-Osram-Lightify-Daylight-Smart/dp/B01NAIV40U
[3] Bastian Bloessl, Michele Segata, Christoph Sommer, and Falko Dressler. 2013. An
IEEE 802.11 a/g/p OFDM Receiver for GNU Radio. In Proceedings of the second
workshop on Software radio implementation forum. ACM, 9–16.
[4] Vladimir Brik, Suman Banerjee, Marco Gruteser, and Sangho Oh. 2008. Wireless
device identification with radiometric signatures. In Proceedings of the 14th ACM
international conference on Mobile computing and networking. ACM, 116–127.
[5] Kameswari Chebrolu and Ashutosh Dhekne. 2009. Esense: communication
through energy sensing. In Proceedings of the 15th annual international conference
on Mobile computing and networking. ACM, 85–96.
[6] Ruirong Chen and Wei Gao. 2019. Enabling Cross-Technology Coexistence for
Extremely Weak Wireless Devices. In IEEE INFOCOM 2019-IEEE Conference on
Computer Communications. IEEE, 253–261.
[7] Yongrui Chen, Zhijun Li, and Tian He. 2018. TwinBee: Reliable Physical-Layer
Cross-Technology Communication with Symbol-Level Coding. In IEEE INFOCOM
2018-IEEE Conference on Computer Communications. IEEE, 153–161.
[8] Wei Cheng, Aidong Xu, Yixin Jiang, Hong Wen, Huanhuan Song, Kai Ouyang,
and Xiping Zhu. 2017. The realization of key extraction based on USRP and
OFDM channel response. In Communications and Network Security (CNS), 2017
IEEE Conference on. IEEE, 374–375.
[9] Zicheng Chi, Zhichuan Huang, Yao Yao, Tiantian Xie, Hongyu Sun, and Ting
Zhu. 2017. EMF: Embedding multiple flows of information in existing traffic
for concurrent communication among heterogeneous IoT devices. In INFOCOM
2017-IEEE Conference on Computer Communications, IEEE. IEEE, 1–9.
[10] Zicheng Chi, Yan Li, Hongyu Sun, Yao Yao, Zheng Lu, and Ting Zhu. 2016. B2w2:
N-way concurrent communication for iot devices. In Proceedings of the 14th ACM
Conference on Embedded Network Sensor Systems CD-ROM. ACM, 245–258.
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan31[11] Boris Danev and Srdjan Capkun. 2009. Transient-based identification of wireless
sensor nodes. In Proceedings of the 2009 International Conference on Information
Processing in Sensor Networks. IEEE Computer Society, 25–36.
[12] Andrea Goldsmith. 2005. Wireless Communications. Cambridge university press.
[13] Xiuzhen Guo, Yuan He, Jia Zhang, and Haotian Jiang. 2019. WIDE: physical-level
CTC via digital emulation. In 2019 18th ACM/IEEE International Conference on
Information Processing in Sensor Networks (IPSN). IEEE, 49–60.
[14] Xiuzhen Guo, Yuan He, Xiaolong Zheng, Zihao Yu, and Yunhao Liu. 2019. Lego-fi:
Transmitter-transparent ctc with cross-demapping. In IEEE INFOCOM 2019-IEEE
Conference on Computer Communications. IEEE, 2125–2133.
[15] Xiuzhen Guo, Xiaolong Zheng, and Yuan He. 2017. Wizig: Cross-technology
energy communication over a noisy channel. In INFOCOM 2017-IEEE Conference
on Computer Communications, IEEE. IEEE, 1–9.
[16] Ibbad Hafeez, Markku Antikainen, and Sasu Tarkoma. 2019. Protecting IoT-
environments against Traffic Analysis Attacks with Traffic Morphing. In 2019
IEEE International Conference on Pervasive Computing and Communications Work-
shops (PerCom Workshops). IEEE, 196–201.
[17] Jehad M Hamamreh, Haji M Furqan, and Huseyin Arslan. 2018. Classifications
and Applications of Physical Layer Security Techniques for Confidentiality: A
Comprehensive Survey. IEEE Communications Surveys & Tutorials (2018).
[18] Wenchao Jiang, Song Min Kim, Zhijun Li, and Tian He. 2018. Achieving Receiver-
Side Cross-Technology Communication with Cross-Decoding. In Proceedings of
the 24th Annual International Conference on Mobile Computing and Networking.
ACM, 639–652.
[19] Wenchao Jiang, Ruofeng Liu, Ling Liu, Zhijun Li, and Tian He. 2017. BlueBee:
10,000 x Faster Cross-Technology Communication from Bluetooth to ZigBee. In
Proceedings of the 23rd Annual International Conference on Mobile Computing and
Networking. ACM, 486–487.
[20] Wenchao Jiang, Zhimeng Yin, Song Mim Kim, and Tian He. 2017. Transpar-
ent cross-technology communication over data traffic. In INFOCOM 2017-IEEE
Conference on Computer Communications, IEEE. IEEE, 1–9.
[21] Xiaocong Jin, Jingchao Sun, Rui Zhang, and Yanchao Zhang. 2015. SafeDSA:
Safeguard dynamic spectrum access against fake secondary users. In Proceedings
of the 22nd ACM SIGSAC Conference on Computer and Communications Security.
ACM, 304–315.
[22] Song Min Kim and Tian He. 2015. Freebee: Cross-technology communication
via free side-channel. In Proceedings of the 21st Annual International Conference
on Mobile Computing and Networking. ACM, 317–330.
[23] Demijan Klinc, Jeongseok Ha, Steven W McLaughlin, Joao Barros, and Byung-Jae
Kwak. 2011. LDPC codes for the Gaussian wiretap channel. IEEE Transactions on
Information Forensics and Security 6, 3 (2011), 532–540.
[24] Zhijun Li and Tian He. 2017. Webee: Physical-layer cross-technology communi-
cation via emulation. In Proceedings of the 23rd Annual International Conference
on Mobile Computing and Networking. ACM, 2–14.
[25] Zhijun Li and Tian He. 2018. LongBee: Enabling Long-Range Cross-Technology
Communication. In IEEE INFOCOM 2018-IEEE Conference on Computer Commu-
nications. IEEE, 162–170.
[26] Zang Li, Wenyuan Xu, Rob Miller, and Wade Trappe. 2006. Securing wireless
systems via lower layer enforcements. In Proceedings of the 5th ACM workshop
on Wireless security. ACM, 33–42.
[27] TJ OConnor, Reham Mohamed, Markus Miettinen, William Enck, Bradley Reaves,
and Ahmad-Reza Sadeghi. 2019. HomeSnitch: behavior transparency and control
for smart home IoT devices. In Proceedings of the 12th Conference on Security and
Privacy in Wireless and Mobile Networks. 128–138.
[28] Neal Patwari and Sneha K Kasera. 2007. Robust location distinction using tempo-
ral link signatures. In Proceedings of the 13th annual ACM international conference
on Mobile computing and networking. ACM, 111–122.
[29] NIST FIPS Pub. 2001. 197: Advanced encryption standard (AES). Federal informa-
tion processing standards publication 197, 441 (2001), 0311.
[30] Donald R Reising, Michael A Temple, and Mark E Oxley. 2012. Gabor-based
RF-DNA fingerprinting for classifying 802.16 e WiMAX mobile subscribers. In
2012 International Conference on Computing, Networking and Communications
(ICNC). IEEE, 7–13.
[31] Matthias Schulz. [n.d.]. Nexmon. https://github.com/seemoo-lab/nexmon
[32] Matthias Schulz. 2018. Teaching Your Wireless Card New Tricks: Smartphone
Performance and Security Enhancements Through Wi-Fi Firmware Modifications.
Ph.D. Dissertation. Technische Universität.
[33] Matthias Schulz, Jakob Link, Francesco Gringoli, and Matthias Hollick. 2018.
Shadow Wi-Fi: Teaching Smartphones to Transmit Raw Signals and to Extract
Channel State Information to Implement Practical Covert Channels over Wi-Fi.
In Proceedings of the 16th Annual International Conference on Mobile Systems,
Applications, and Services. ACM, 256–268.
[34] Matthias Schulz, Daniel Wegemer, and Matthias Hollick. 2017. Nexmon: The
c-based firmware patching framework.
[35] Amit Kumar Sikder, Leonardo Babun, Hidayet Aksu, and A Selcuk Uluagac.
2019. Aegis: a context-aware security framework for smart home systems. In
Proceedings of the 35th Annual Computer Security Applications Conference. 28–41.
[36] ZigBee Specification. 2012. Document 053474r20. Zigbee Standards Organization:
San Ramon, CA, USA (2012).
[37] statista. [n.d.]. statista report. https://www.statista.com/statistics/471264/iot-
number-of-connected-devices-worldwide/
[38] Chan Dai Truyen Thai, Jemin Lee, and Tony QS Quek. 2016. Physical-layer secret
key generation with colluding untrusted relays. IEEE Transactions on Wireless
Communications 15, 2 (2016), 1517–1530.
[39] Qi Wang, Pubali Datta, Wei Yang, Si Liu, Adam Bates, and Carl A Gunter. 2019.
Charting the Attack Surface of Trigger-Action IoT Platforms. In Proceedings of
the 2019 ACM SIGSAC Conference on Computer and Communications Security.
1439–1453.
[40] Shuai Wang, Zhimeng Yin, Zhijun Li, and Tian He. 2018. Networking Support For
Physical-Layer Cross-Technology Communication. In 2018 IEEE 26th International
Conference on Network Protocols (ICNP). IEEE, 259–269.
[41] Eric W. Weisstein. [n.d.]. Parseval’s Theorem. http://mathworld.wolfram.com/
ParsevalsTheorem.html
[42] Wikipediak. [n.d.]. Pearson Correlation Coefficient. https://en.wikipedia.org/
wiki/Pearson_correlation_coefficient
[43] Qian Xu, Pinyi Ren, Houbing Song, and Qinghe Du. 2017. Security-aware wave-
forms for enhancing wireless communications privacy in cyber-physical systems
via multipath receptions. IEEE Internet of Things Journal 4, 6 (2017), 1924–1933.
[44] Chunxuan Ye, Suhas Mathur, Alex Reznik, Yogendra Shah, Wade Trappe, and
Narayan B Mandayam. 2010. Information-theoretically secret key generation for
fading wireless channels. IEEE Transactions on Information Forensics and Security
5, 2 (2010), 240–254.
[45] Zhimeng Yin, Wenchao Jiang, Song Min Kim, and Tian He. 2017. C-morse:
Cross-technology communication with transparent morse coding. In INFOCOM
2017-IEEE Conference on Computer Communications, IEEE. IEEE, 1–9.
[46] Sihan Yu, Xiaonan Zhang, Pei Huang, and Linke Guo. 2019. Secure Authentica-
tion in Cross-Technology Communication for Heterogeneous IoT. In 2019 IEEE
International Symposium on Dynamic Spectrum Access Networks (DySPAN). IEEE,
1–2.
[47] Marwan Yusuf and Huseyin Arslan. 2016. Controlled inter-carrier interference
for physical layer security in OFDM systems. In Vehicular Technology Conference
(VTC-Fall), 2016 IEEE 84th. IEEE, 1–5.
[48] Wei Zhang, Yan Meng, Yugeng Liu, Xiaokuan Zhang, Yinqian Zhang, and Haojin
Zhu. 2018. Homonit: Monitoring smart home apps from encrypted traffic. In
Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications
Security. 1074–1088.
[49] Xiaonan Zhang, Pei Huang, Linke Guo, and Yuguang Fang. 2019. Hide and
Seek: Waveform Emulation Attack and Defense in Cross-Technology Communi-
cation. In Proceedings of the 39th Annual International Conference on Distributed
Computing Systems. IEEE, 1–10.
[50] Xiaonan Zhang, Pei Huang, Linke Guo, and Mo Sha. 2019. Incentivizing relay
participation for securing IoT communication. In IEEE INFOCOM 2019-IEEE
Conference on Computer Communications. IEEE, 1504–1512.
[51] Xiaonan Zhang, Pei Huang, Qi Jia, and Linke Guo. 2018. Cream: Unauthorized
secondary user detection in fading environments. In 2018 IEEE 15th International
Conference on Mobile Ad Hoc and Sensor Systems (MASS). IEEE, 406–414.
[52] Xiaonan Zhang, Qi Jia, and Linke Guo. 2017. Secure and optimized unauthorized
secondary user detection in dynamic spectrum access. In 2017 IEEE Conference
on Communications and Network Security (CNS). IEEE, 1–9.
[53] Yifan Zhang and Qun Li. 2013. Howies: A holistic approach to zigbee assisted
wifi energy savings in mobile devices. In INFOCOM, 2013 Proceedings IEEE. IEEE,
1366–1374.
[54] Xiaolong Zheng, Yuan He, and Xiuzhen Guo. 2018. StripComm: Interference-
resilient cross-technology communication in coexisting environments. In IEEE
INFOCOM 2018-IEEE Conference on Computer Communications. IEEE, 171–179.
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan32