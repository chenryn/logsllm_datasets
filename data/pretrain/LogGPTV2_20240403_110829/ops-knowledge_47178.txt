User: 请回答以下安全问题攻击办公室打印机？我对一台高级办公打印机进行了nmap扫描，该打印机有域名，可以从公司网络外部访问。令人惊讶的是，我发现了许多开放端口，如http:80、https:443、svrloc:427和其他一些端口。操作系统指纹在某个地方写道：“…x86_64-unknown-linux-gnu…”，这可能表明这是某种嵌入式linux，运行一些用于打印机功能的服务器软件。
我如何知道这台打印机是否增加了网络上的攻击面？例如，是否可以通过远程权限提升漏洞利用它。然后对网络中的其他主机发起隧道攻击？

Assistant: 你可以玩打印机、复印机和其他类似的设备，甚至是UPSE，玩得很开心。如果不是完全没有安全保障的话，安全保障充其量只是事后考虑。
我看到的东西：
到处使用的默认凭据，以及以纯文本形式存储密码的基于web的配置面板，通常在生成的配置文件中。我从未见过比普通MD5更好的密码，有一次我看到了CRC32。
通过SNMP泄露的文档名称和用户名，通常是通过对设备的开放读取访问，以及在不使用传输安全性的情况下通过SNMPv1/2泄露的。
默认或非常弱的SNMP专用命名空间名称（通常为“private”、“SNMP”或制造商名称），允许您远程重新配置TCP/IP设置、将条目注入路由表等，并且通常有一些方法可以更改控制面板中无法设置的设置。对设备进行软砖处理是很琐碎的。
UPnP在设备上以默认设置启用，允许更多远程配置乐趣。通常，您可以打印测试页、硬重置设备、重置web面板凭据等。同样，通常可以修改TCP/IP设置和其他网络属性。
非常过时的2.2.x和2.4.x内核，通常有很多不错的根权限提升漏洞。
系统上的固件升级脚本写得不好，允许您将任意固件闪存到内部微控制器。如果你愿意花很多时间开发它，你可以用它来构建设备，或者安装一个rootkit。
自定义或旧SMB守护程序，通常易受RCE攻击。易于远程pwn。
以root身份运行的服务，用户组设置不正确，文件权限设置不正确。
打印作业通过执行shell脚本异步运行，从而可以轻松地将您的权限提升到守护进程（通常是root）的权限。
设备内置的FTP服务器写得不好。我敢打赌，一个模糊器可以使大多数FTP守护进程崩溃。
所有常见的网络应用都会失败，尤其是文件上传漏洞。
在这里，事情变得格外有趣。一旦你打开了打印机，你通常可以从SMB握手中获得用户名和其他有趣的信息。您还会经常发现打印机web控制面板的密码被重新用于其他网络凭据。
不过，归根结底，打印机是网络上的一台内部机器。这意味着您可以使用它将攻击隧道传输到网络上的其他机器。有好几次，我设法把gcc和nmap放在复印机上，然后把它作为操作的基础。
解决方案是什么？首先，你需要认识到打印机和复印机通常是成熟的计算机，通常在ARM处理器上运行嵌入式Linux。其次，您需要锁定它们：
将设备的固件更新到最新版本。
用防火墙将打印机与互联网隔开。这应该是显而易见的，但却经常被忽略。基于TCP/IP的打印机/复印机通常绑定到0.0.0.0，因此它们可以很容易地潜入WAN。
如果您可以使打印机只侦听来自LAN的通信，请执行此操作。
更改web控制面板上的默认凭据。同样，这是显而易见的，但仍然不经常这样做。
找到设备上运行的任何服务，并尝试自己闯入它们。一旦进入，请更改密码并关闭不必要的功能。
为自己准备一个SNMP发现工具，深入了解打印机的可用信息。SNMP有一个学习曲线，但值得一看。
如果您进行内部网络监控，请设置一个规则来监视打印机是否出现异常。这可以减少误报，并为你提供一个很好的指示，告诉你什么时候发生了不可靠的事情。
总而言之，如果它是一个插入网络的设备，它可能是pwable的，应该是风险管理的一部分。