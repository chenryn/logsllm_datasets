# G0009: Deep Panda

## Description
Deep Panda, also known by various aliases such as Shell Crew, WebMasters, KungFu Kittens, PinkPanther, and potentially Black Vine, is a suspected Chinese threat group. This group has been identified as targeting a wide range of industries, including government, defense, financial, and telecommunications sectors. Notably, the intrusion into the healthcare company Anthem has been attributed to Deep Panda. Some analysts have suggested that Deep Panda and APT19 may be the same group, although this remains unconfirmed based on open-source information.

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Hidden Window](https://attack.mitre.org/techniques/T1143/) | Deep Panda uses the `-w hidden` parameter in PowerShell to conceal windows by setting the `WindowStyle` parameter to `hidden`. | Windows event logs, PowerShell logs, process command-line parameters, process monitoring, file monitoring |
| Linux, macOS, Windows, GCP, Azure, AWS | [Discovery](https://attack.mitre.org/tactics/discovery/) | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | Deep Panda employs the `ping` command to identify other machines of interest. | Network protocol analysis, process monitoring, process use of network, process command-line parameters |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [Accessibility Features](https://attack.mitre.org/techniques/T1015/) | Deep Panda uses the sticky-keys technique to bypass the RDP login screen on remote systems during intrusions. | Windows Registry, file monitoring, process monitoring |
| Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Regsvr32](https://attack.mitre.org/techniques/T1117/) | Deep Panda utilizes `regsvr32.exe` to execute a server variant of Derusbi in victim networks. | Loaded DLLs, process monitoring, Windows Registry, process command-line parameters |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/) | Deep Panda leverages WMI for lateral movement. | Authentication logs, Netflow/Enclave netflow, process monitoring, process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Scripting](https://attack.mitre.org/techniques/T1064/) | Deep Panda uses PowerShell scripts to download and execute programs in memory without writing to disk. | Process monitoring, file monitoring, process command-line parameters |
| Windows | [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Windows Admin Shares](https://attack.mitre.org/techniques/T1077/) | Deep Panda uses `net.exe` to connect to network shares with compromised credentials using `net use` commands. | Process use of network, authentication logs, process monitoring, process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Indicator Removal from Tools](https://attack.mitre.org/techniques/T1066/) | Deep Panda updates and modifies its malware, resulting in different hash values to evade detection. | Process use of network, process monitoring, process command-line parameters, anti-virus, binary file metadata |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [PowerShell](https://attack.mitre.org/techniques/T1086/) | Deep Panda uses PowerShell scripts to download and execute programs in memory without writing to disk. | PowerShell logs, loaded DLLs, DLL monitoring, Windows Registry, file monitoring, process monitoring, process command-line parameters |
| Linux, Windows, macOS | [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [Web Shell](https://attack.mitre.org/techniques/T1100/) | Deep Panda deploys web shells on publicly accessible web servers to access victim networks. | Anti-virus, authentication logs, file monitoring, Netflow/Enclave netflow, process monitoring |
| Linux, macOS, Windows | [Discovery](https://attack.mitre.org/tactics/discovery/) | [Process Discovery](https://attack.mitre.org/techniques/T1057/) | Deep Panda uses the Microsoft Tasklist utility to list processes running on systems. | Process monitoring, process command-line parameters |

This table provides a comprehensive overview of the tactics, techniques, and procedures employed by Deep Panda, along with the relevant data sources for detection and analysis.