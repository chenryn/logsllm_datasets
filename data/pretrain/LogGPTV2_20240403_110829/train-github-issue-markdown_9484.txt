 **Sam Brannen** opened **SPR-6523** and commented
Section _C.2.2.4 util:list/_ of the reference manual states:
> Finally, you can also control the merging behavior using the 'merge'
> attribute of the util:list/ element; collection merging is described in more
> detail in the section called "Collection merging".
This is, however, not true. In contrast to the standard support for
collections (i.e., array, list, set, map) in the _beans_ namespace, the _util_
namespace does not support the merge attribute for collections.
Is this an oversight in the documentation or missing functionality in the util
namespace support?
On a related note (perhaps worthy of its own JIRA issue), given the following
application context configuration and JUnit test class...
            red
            green
            blue
            cyan
            magenta
            yellow
            black
    package com.example;
    import static org.junit.Assert.assertEquals;
    import static org.junit.Assert.assertNotNull;
    import java.util.List;
    import org.junit.Test;
    import org.springframework.context.ApplicationContext;
    import org.springframework.context.support.ClassPathXmlApplicationContext;
    public class MergedListTests {
      @Test
      public void mergedList() {
        ApplicationContext appCtx = new ClassPathXmlApplicationContext(
          "/com/example/MergedListTests-context.xml");
        ListHolder listHolder = appCtx.getBean("listHolder", ListHolder.class);
        assertNotNull(listHolder);
        assertEquals(7, listHolder.getList().size());
      }
      public static class ListHolder {
        private List list;
        public List getList() {
          return this.list;
        }
        public void setList(List list) {
          this.list = list;
        }
      }
    }
... changing the ****definition in _listHolderParent_ to **util:list** results
in the following exception:
> java.lang.IllegalArgumentException: Cannot merge with object of type [class
> org.springframework.beans.factory.config.BeanDefinitionHolder]  
>  at
> org.springframework.beans.factory.support.ManagedList.merge(ManagedList.java:98)  
>  at
> org.springframework.beans.factory.support.ManagedList.merge(ManagedList.java:1)  
>  at
> org.springframework.beans.MutablePropertyValues.mergeIfRequired(MutablePropertyValues.java:221)  
>  at
> org.springframework.beans.MutablePropertyValues.addPropertyValue(MutablePropertyValues.java:169)  
>  at
> org.springframework.beans.MutablePropertyValues.addPropertyValues(MutablePropertyValues.java:138)  
>  at
> org.springframework.beans.factory.support.AbstractBeanDefinition.overrideFrom(AbstractBeanDefinition.java:300)  
>  at
> org.springframework.beans.factory.support.AbstractBeanFactory.getMergedBeanDefinition(AbstractBeanFactory.java:1114)  
>  at
> org.springframework.beans.factory.support.AbstractBeanFactory.getMergedBeanDefinition(AbstractBeanFactory.java:1054)  
>  at
> org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1040)  
>  at
> org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanNamesForType(DefaultListableBeanFactory.java:294)  
>  at
> org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:578)  
>  at
> org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:398)  
>  at
> org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:139)  
>  at
> org.springframework.context.support.ClassPathXmlApplicationContext.(ClassPathXmlApplicationContext.java:83)  
>  at com.example.MergedListTests.mergedList(MergedListTests.java:17)  
>  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  
>  ...
* * *
**Issue Links:**
  * #10561 Merge multiple lists/maps/sets that share the same id into a single map/list ( _ **"Cloned from"**_ )
  * #9658 support cascading merge operation ( _ **"is duplicated by"**_ )
  * #13477 Add MapCombiningFactoryBean ( _ **"is duplicated by"**_ )
  * #7575 Support easier merge/concatenation of lists ( _ **"is duplicated by"**_ )
  * #14186 Respect 'merge' attribute of and elements in conjunction with nested property paths
  * #9437 Merge of util:map does not work
  * #6201 Support for Collection Merging in Parent/Child Bean Definitions
  * #9872 Re-allow merge of util:map list, set, ... based on the same bean ID
**Referenced from:** commits `a827ab8`
16 votes, 18 watchers