IMC ’20, October 27–29, 2020, Virtual Event, USA
Akiwate, Jonker, Sommese, Foster, Voelker, Savage, and Claffy
Year TLD Zone Files Year TLD Zone Files
1221
2011
1237
2012
2013
1241
1235
2014
2015
1206
2016
2017
2018
2019
2020
12
12
49
462
828
Table 2: TLD zone files per year in DNS Coffee data set.
Domains Nameservers (NS)
499.3 M
19.9 M
IPv4 (A)
5.1 M
IPv6 (AAAA)
91.9 k
Table 3: Records in the DNS Coffee data set.
zone files from April 2011 through January 2020, covering nearly
nine years. Over time, as zone files for new TLDs became available,
dns.coffee added them to its collection. Table 2 shows the num-
ber of unique TLDs collected over time, and Figure 1 shows the
number of distinct domains and nameservers across the zone files
every year. As of September 2020, the service collects zone files
for over 1250 different zones on an ongoing basis. The snapshots
include the zone files of legacy generic TLDs (gTLDs), the .us,
.se and .nu country-code TLDs (ccTLDs), and new generic TLDs
(ngTLDs) made available through the ICANN Centralized Zone
Data Service [14].
One issue when analyzing zone files is that records can refer
to TLDs outside of that zone. As we aggregate records from the
zone files together, cross references across zones are automatically
consolidated in the data set. However, for records that refer to TLDs
for which we do not collect zone files, we have to make assumptions,
e.g., that the resolution is valid.
4.2 Active DNS measurement
Certain characteristics of real-world DNS behavior cannot be learned
from zone files. Zone files may list NS records for nameservers
that do not have authoritative data, are not reachable, or do not
even exist. Active measurement data can reveal these additional
insights into lame delegations, although capturing comprehensive
data would require exhaustively querying all nameservers listed
in the zone files for a given domain, and all IP addresses for each
nameserver. Open data sets like the OpenINTEL [28] project do
not exhaustively query all nameservers in the zone file; instead
they perform resolutions as a typical nameserver would, and stop
when they receive an authoritative response for a domain. This
approach will not capture comprehensive data on availability or
authoritativeness of nameservers listed in the zone file, a particular
problem for partly lame delegations. Thus, to gain a more compre-
hensive picture, we perform our own active DNS measurements.
We describe our methodology for doing so later, in Section 6.1.
Given the intrusive nature and overhead of exhaustive probing, we
Figure 1: Number of distinct domains and nameservers in
DNS Coffee zones over the years.
limit the number of domains we actively probe. Further, we supple-
ment these measurements with OpenINTEL data to ascertain the
potential “real-world” impact of lame delegations.
5 LAME DELEGATIONS INFERRED FROM
ZONE FILES
Our first analysis uses the nine years of zone file data to identify
unresolvable nameservers that cause lame delegations. We delin-
eate three periods of a nameserver’s lifetime during which lame
delegations occur, each period associated with different causes and
implications. In this context, we characterize the prevalence of un-
resolvable nameservers and affected domains overall, how long
domains are lame delegated, and how an unusual concentration
in the .biz TLD reveals an undocumented registrar operational
practice. We then examine unresolvable nameservers and lame
delegations longitudinally over the nine years, identifying trends,
prominent events that indicate causes of large-scale lame delega-
tions, and their associated risks.
5.1 Methodology for static analysis
Our analysis of longitudinal zone file data performs “static resolu-
tion” of domains and nameservers to identify unresolvable name-
servers that lead to lame delegations. Specifically, we infer lame
delegations by following chains of records in zone files to establish
that a nameserver has a valid resolution path. We use the zone file
snapshots over time to derive the date ranges for when each name-
server has a valid resolution path. We then identify the registered
domains that depend upon the nameservers during their valid time
periods. Any (domain, nameserver) pair where the domain relies
on a nameserver outside of that nameserver’s periods of valid reso-
lution is a lame delegation. We refer to registered domains in the
zone files simply as domains, and specifically mention in context if
a domain is a fully qualified domain name.
To explain this static resolution process, we use mock NS and
A records (Table 4) to show how we use four criteria to derive
the “valid resolution” date ranges for the nameservers (Table 5).
Each record has a start and an end date. For each TLD we record
2011-042012-122014-082016-042017-122019-08Month050100150200250Domain Count in MillionsDomain Count012345Nameserver Count in MillionsNameserver CountUnresolved Issues: Prevalence, Persistence, and Perils of Lame Delegations
IMC ’20, October 27–29, 2020, Virtual Event, USA
TLD Records
.com foo.com NS ns1.bar.in
.com foo.com NS ns1.baz.org
.com foo.com NS ns1.qux.org
.com foo.com NS ns.1qux.org
.com foo.com NS ns1.thud.org
thud.org NS ns1.baz.org
.org
ns1.baz.org A 93.14.2.34
.org
ns1.qux.org A 93.14.2.36
.org
Start Date
2011-04-11
2011-06-18
2011-04-11
2011-06-11
2011-06-11
2011-06-06
2011-06-06
2011-06-06
End Date
2013-10-31
2013-10-31
2013-10-31
2013-10-31
2013-10-31
2013-10-31
2013-10-31
2013-09-01
Table 4: Mock NS and A records to illustrate static resolution.
Nameserver
ns1.bar.in
ns1.baz.org
ns1.qux.org
ns1.qux.org
ns1.thud.org
ns.1qux.org
Start Date
2011-04-11
2011-06-06
2011-04-11
2011-06-06
2011-06-06
-
Reason
End Date
2013-10-31 Other TLD
2013-10-31 Glue Record
2011-06-05
Late Access
2013-09-01 Glue Record
2013-10-31
-
Parent Resolution
No Records
Table 5: Resolvability at the end of static resolution.
the first time we imported the zone file for that TLD. The earliest
information we have for foo.com, and generally any domain in
.com, is 2011-04-11. We derive resolution validity if any of these
four criteria hold:
(1) Other TLDs: Domains in our set of zone files can have NS
records with nameservers in TLDs for which we do not have a
zone file. In Table 4, foo.com has a nameserver ns1.bar.in. Since
we do not have the zone file for the .in TLD we conservatively
assume that ns1.bar.in can be resolved from 2011-04-11 to
2013-10-31 (Table 5). Of the ∼20 M nameservers in our zone file
data set, 1.4 M (7%) of them belong to such TLDs and we assume
that they are resolvable.
(2) Late Access TLDs: We do not always have the earliest zone
file for a given TLD, e.g., our earliest copy of the .org TLD zone file
is from 2011-06-06. If we see earlier references to nameservers in
the .org TLD in other zone files, we conservatively mark them as
resolvable for the duration before we have visibility into the TLD.
(3) Glue Records: If a nameserver has a glue record in the zone
files, then we assume that the nameserver is resolvable for the dura-
tion of the glue record. In Table 4, ns1.baz.org and ns1.qux.org
have glue records that make them resolvable for the durations
shown in Table 5.
(4) Parent Resolution: Domains using a nameserver that does
not have a glue record can still resolve via the resolution on the
nameserver’s parent domain. In Table 4 consider ns1.thud.org.
While ns1.thud.org does not have a glue record, the nameserver
parent thud.org can be resolved by ns1.baz.org since it has a
valid resolution path via its glue records. Thus, in Table 5 we con-
sider ns1.thud.org resolvable from 2011-06-06 to 2013-10-31
as a result of parent resolution. Determining parent resolution may
involve multiple layers of redirection before reaching a nameserver
with a valid resolution path. Otherwise, a nameserver without a
glue record is unresolvable.
We illustrate this static analysis process by working through
the mock examples in Tables 4 and 5. Table 5 presents the dura-
tions for which a nameserver is conservatively resolvable. Name-
servers ns1.bar.in, ns1.baz.org, and ns1.thud.org have a
valid resolution path for the entire period during which they are
the nameservers of foo.com. However, consider ns1.qux.org
whose glue record is valid only until 2013-09-01. Thus, we in-
fer ns1.qux.org was unresolvable for the period 2013-09-02 to
2013-10-31. Additionally ns.1qux.org, an example of a typo
of the actual nameserver, never has any records associated with
it. This typo results in a security risk since someone can register
1qux.org, set the glue record for ns.1qux.org to a private name-
server, and control the resolution of foo.com for the fraction of
requests that come its way.
Applying the static analysis across all nameservers for the full
time period of our data set, we delineate a nameserver’s “unresolv-
ability”, i.e., when it is unresolvable, across three periods:
(1) Pre-Life: The nameserver is referenced by a domain before
the nameserver is first resolvable, typically due to delayed
glue or delayed registration of the nameserver domain.
(2) In-Life: The nameserver is temporarily unresolvable after
previously being resolvable. The most common type of lame
delegation, it is frequently the result of a nameserver domain
expiring and then being renewed, or its glue records being
misconfigured.
(3) Post-Life: The nameserver is no longer resolvable or was
never resolvable. Typically, it is a result of an expired name-
server domain not being renewed, or a typo when entering
the nameserver domain.
We found these categories useful for identifying causes and impli-
cations of lame delegations.
Our static resolution assumes that a nameserver with a glue
record is routable, reachable, and operates an authoritative DNS
server for the domain. Consequently, the static analysis results are
lower bounds on unresolvable nameservers and lame delegations.
Even so, static analysis uncovers a wide variety of DNS behavior
that leads to lame delegations. Complementing this analysis, Sec-
tion 6 describes our active measurements that derive a snapshot of
lame delegations via operational execution of the DNS protocol.
5.2 Prevalence of lame delegations
We start by characterizing the overall prevalence of unresolvable
nameservers across the zone files in our data set. Table 6 shows the
total number of unresolvable nameservers and the total number of
domains affected. The table also includes two breakdowns of the
overall numbers: by time period (columns), and by TLD (rows).
Unresolvable nameservers may be a small percentage of name-
servers (4%), but they result in more than 4.11 M lame delegated
domains. Most unresolvable nameservers are unresolvable in-life,
which is not surprising since they correspond to issues at any point
during a nameserver’s lifetime. The smallest category of unresolv-
able nameservers are those that are unresolvable pre-life; these
cases are typically delayed registration of the nameserver domain.
EPP constraints do not allow unregistered nameserver domains in
the same TLD, so this situation arises only when the nameserver
domain is in a different TLD from the domain itself.
IMC ’20, October 27–29, 2020, Virtual Event, USA
Akiwate, Jonker, Sommese, Foster, Voelker, Savage, and Claffy
NS TLD Unresolvable NS
367,054 (4.25%)
.com
85,039 (4.91%)
.net
34,669 (3.51%)
.org
39,184 (3.28%)
.info
9,480 (1.41%)
ccTLDs
28,472 (0.57%)
ngTLDs
191,211 (50.8%)
755,109 (4.07%)
.biz
All TLDs
Unresolvable Nameservers by TLD
In Life Unr. NS
277,379 (3.22%)
61,372 (3.55%)
17,540 (1.78%)
29,092 (2.44%)
4,947 (0.74%)
12,351 (0.25%)
8,454 (2.25%)
411,117 (2.22%)
Pre Unr. NS
17,660 (0.20%)
2,531 (0.14%)
828 (0.08%)
831 (0.07%)
333 (0.05%)
2,830 (0.06%)
7,968 (2.12%)
32,981 (0.18%)
Post Unr. NS
85,899 (1.00%)
24,997 (1.45%)
17,438 (1.77%)
10,207 (0.86%)
4,920 (0.73%)
14,474 (0.29%)
181,211 (48.1%)
339,146 (1.83%)
Across All TLDs
Lame Domains
2,122,825
899,082
246,486
67,796
28,193
446,906
551,201
4,114,750
Table 6: Summary of unresolvable nameservers in our zone file data set, broken down by nameserver TLDs. Includes unresolv-
able nameservers as percentage of all nameservers in same TLD. We categorize by TLD of nameserver and not the domain.
Recall that nameservers and domains can be lame in more than one time period, so the sum of the time period columns is
generally larger than the overall total.
Characterizing the prevalence of unresolvable nameservers by
TLD, we found that unresolvable nameservers appear more often
and with roughly similar prevalence in the old generic TLDs in the
first four rows: between 3–4%. Country-code TLDs have compara-
tively fewer unresolvable nameservers, and the many new gTLDs
grouped under ngTLDs have the fewest unresolvable nameservers.5
While domain management practices could be better in the newer
TLDs, a common practice in the new gTLDs is to have the NS records
for domains point to nameservers in another TLD, often .com. Our
method attributes any resulting unresolvable nameserver to .com
and not the newer gTLD.
5.3 DROPTHISHOST anomaly
We placed .biz at the end of the Table 6 since it stands out in sharp
contrast to other TLDs. The .biz TLD has had 381,475 nameservers
across nine years of zone files. Of these, nearly half had no valid
resolution path ever, yet domains still pointed to them. These results