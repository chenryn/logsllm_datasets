+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 之前创建的Service                                          |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 按照健康度分值正序展示Service和Metric。                    |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.                                                         |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点2 | 仅查看WebServer 服务及所属监控项的健康度                   |
+=========+============================================================+
| 说明    |                                                            |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      |                                                            |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 只看到WebServer和Acce                                      |
| 置条件  | ssLogStatus、ResponseTime、NetIOPS、ErrorLogStatus的内容。 |
+---------+------------------------------------------------------------+
| 主流程  | 1.  在页首过滤条件中选择WebServer。                        |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点3 | 钻取查看WebServer 服务及所属监控的详细状态                 |
+=========+============================================================+
| 说明    | 点击健康度分值，可以钻取到服务详情页。展示服               |
|         | 务定义的东西。不过毕竟是查看，所以强调的重点和编辑页不同： |
|         |                                                            |
|         | 健康度历史曲线。                                           |
|         |                                                            |
|         | 监控项列表：列出服务里所有监控项，以及它们的当前分值和sp   |
|         | arkline历史，sparkline带有分等级的背景色。以当前分值排序。 |
|         |                                                            |
|         | 依赖链图：如果服务有依赖                                   |
|         | 关系，以拓扑图形式展示。照样，图上要用颜色区分分值的状态。 |
|         |                                                            |
|         | 多序列视图：选择单个监控项时，如果监控项是智能监控且开     |
|         | 启了切分序列，则可以展示该监控项在不同设备下的情况和细节。 |
|         |                                                            |
|         | 注1：切分字段可能选了多个，相当于是 stats count() by       |
|         | hostname,ap                                                |
|         | pname的返回，需要按照值自动映射回服务所属设备的title展示。 |
|         |                                                            |
|         | 注2：由于sparkline空间有限，展示数据点在12-48之间比较合    |
|         | 适。如果时间范围选择较大，需要聚合展示。比如1个月的，画30  |
|         | 个点，每个点代表1天的值(可以考虑让用户选择平均值/最大值)。 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      |                                                            |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 展示WebServer和database的依赖链拓扑；                      |
| 置条件  |                                                            |
|         | 展示最近一天webserver所属四个Metric的历史状态图。          |
+---------+------------------------------------------------------------+
| 主流程  | 1.  在看板上点击WebServer卡片。                            |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点4 | 点击查看单个监控项的切分序列结果                           |
+=========+============================================================+
| 说明    |                                                            |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 功能点3                                                    |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 展示最近一天AccessLogStatus下分hostname的状态历史图(此     |
| 置条件  | 处可验证4.2.3的功能点3和4.2.4的功能点1效果)，按状态排序。  |
+---------+------------------------------------------------------------+
| 主流程  | 1.  点击AccessLogStatus监控项                              |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点5 | 钻取查看单个监控的结果                                     |
+=========+============================================================+
| 说明    | 从全局看板钻取过来时，如果点的是服务或无切分的监控项，应该 |
|         | 只有前两项；如果点的是切分序列的监控项，应该直接打开三项。 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      |                                                            |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 同功能点4。                                                |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.  在服务概览上点击AccessLogStatus卡片                    |
+---------+------------------------------------------------------------+
  -------------------------------------------------------------------------------------------
  功能点6    钻取查看单个设备的性能状态
  ---------- --------------------------------------------------------------------------------
  说明       在服务详情页第三列展示的分设备历史上，点击某行设备，应该跳转到该设备的展示页。
  规则       
  原型       
  执行者     admin
  前置条件   功能点4
  后置条件   打开web1设备详情页。
  主流程     点击web1设备
  -------------------------------------------------------------------------------------------
+---------+------------------------------------------------------------+
| 功能点7 | 切分队列的模式对比                                         |
+=========+============================================================+
| 说明    | 在服务详情页第三列展示的分设备历史上，                     |
|         | 可以点击进入模式对比状态。模式对比状态下，会自动分析和展示 |
|         | 切分队列的隐藏模式，并高亮标记模式异常的时段，供对比分析。 |
|         |                                                            |
|         | 由于模式对比采用分组趋势图方式，不                         |
|         | 宜展示过多序列，所以只提供按照异常程度排序的前5、10选择。  |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 功能点4                                                    |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 第                                                         |
| 置条件  | 三列分上下两块，上图是top5的设备折线图，下图是模式折线图。 |
+---------+------------------------------------------------------------+
| 主流程  | 点击“模式对比”按钮                                       |
+---------+------------------------------------------------------------+
### 查询和展示设备性能状态
+---------+------------------------------------------------------------+
| 功能点1 | 查看全局设备状态                                           |
+=========+============================================================+
| 说明    | 采用蜂窝式可视化展示全局设备情况，提供分组、名称过滤设置。 |
|         |                                                            |
|         | 默认按所属服务分组。应该可以选设备的索引和附加属性。       |
|         |                                                            |
|         | 设备状态由设备上所有监控项最差的那个状态决定。             |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | Admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 1.  创建10个设备web1-10；                                  |
| 置条件  |                                                            |
|         | 2.  创建两个监控                                           |
|         | 项，一个apachestatus(\>399的count)，一个apacheresptime(avg |
|         |     \>100)；                                               |
|         |                                                            |
|         | 3.  创建webserver服务，加入上面准备好的设备和监控项；      |
|         |                                                            |
|         | 4.  准备一段apache访问日                                   |
|         | 志，其中修改web1的apachestatus都变成404，但resptime不变。  |
+---------+------------------------------------------------------------+
| 后      | 看到9个绿色，1个红色为web1。                               |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.  点击进入“设备概览”                                   |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点2 | 点击查看单台设备状态                                       |
+=========+============================================================+
| 说明    | 在服务详情页切分序列结果处也可以点击跳转到设备详情页。     |
|         |                                                            |
|         | 注：服务                                                   |
|         | 里没有切分序列的监控项，则不会展示在设备页的监控项列表里。 |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | Admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 功能点1                                                    |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | 打开web1设备详情页，展示web1设备属性、所属服务、关         |
| 置条件  | 联的指标趋势图详情。此处应看到web1的apachestatus曲线异常。 |
+---------+------------------------------------------------------------+
| 主流程  | 1.  点击红色的web1图标。                                   |
+---------+------------------------------------------------------------+
### 根因分析功能
+---------+------------------------------------------------------------+
| 功能点1 | 查看WebServer 服务异常的根因分析                           |
+=========+============================================================+
| 说明    | 根因分析模式下，要突出监                                   |
|         | 控项的列表，同时，允许加入异常事件作为标记参照。页面包括： |
|         |                                                            |
|         | 多个监控项的同时间轴展示。                                 |
|         |                                                            |
|         | 多个监控项的相关性表格：包括名称、相关系数、时间           |
|         | 位移量、当前score、归属service等。以相关系数的绝对值排序。 |
|         |                                                            |
|         | 注：列表中可以菜单选择多列一些监控项，比如前10/20个        |
|         | 。但是默认只在图上画前5个。用户可以自己勾选放其他的上去。  |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      |                                                            |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      | WebServer下属的监控项曲线图同轴展示。                      |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 在WebServer上点击进入根因分析模式                          |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点2 | 包含依赖服务的根因分析                                     |
+=========+============================================================+
| 说明    | 可选择将依赖的服务的Metric加入相关性计算                   |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 在WebServer上找到作为分析目标的AccessLogStatus             |
| 置条件  | 监控项曲线图，选择进入根因分析模式                         |
+---------+------------------------------------------------------------+
| 后      | WebServer和Dat                                             |
| 置条件  | abase的下属监控项曲线图取相关性绝对值倒序前5名，同轴展示。 |
+---------+------------------------------------------------------------+
| 主流程  | 1.  点击勾选加入依赖服务                                   |
+---------+------------------------------------------------------------+
+---------+------------------------------------------------------------+
| 功能点2 | 包含异常事件标记的根因分析                                 |
+=========+============================================================+
| 说明    | 可选择将异常事件标记在折线图上                             |
+---------+------------------------------------------------------------+
| 规则    |                                                            |
+---------+------------------------------------------------------------+
| 原型    |                                                            |
+---------+------------------------------------------------------------+
| 执行者  | admin                                                      |
+---------+------------------------------------------------------------+
| 前      | 在WebServer上点击进入根因分析模式                          |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 后      |                                                            |
| 置条件  |                                                            |
+---------+------------------------------------------------------------+
| 主流程  | 1.  点击勾选加入异常事件标记                               |
+---------+------------------------------------------------------------+
# 整合需求
# 非功能性需求
## 安全性需求
## 可用性需求