Capability: CryptSIPDllRemoveSignedDataMsg
Dll: AppxSip.dll
Function Name: EappxSipRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: AppxSip.dll
Function Name: EappxSipVerifyIndirectData
GUID: D1D04F0C-9ABA-430D-B0E4-D7E96ACCE66C
Friendly Name: AppXEncryptedBundle
Capability: CryptSIPDllCreateIndirectData
Dll: AppxSip.dll
Function Name: EappxBundleSipCreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: AppxSip.dll
Function Name: EappxBundleSipGetSignedDataMsg
Capability: CryptSIPDllIsMyFileType2
Dll: AppxSip.dll
Function Name: EappxBundleSipIsFileSupportedName
Capability: CryptSIPDllPutSignedDataMsg
Dll: AppxSip.dll
Function Name: EappxBundleSipPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: AppxSip.dll
Function Name: EappxBundleSipRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: AppxSip.dll
Function Name: EappxBundleSipVerifyIndirectData
GUID: 0F5F58B3-AADE-4B9A-A434-95742D92ECEB
Friendly Name: AppXBundle
Capability: CryptSIPDllCreateIndirectData
Dll: AppxSip.dll
Function Name: AppxBundleSipCreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: AppxSip.dll
Function Name: AppxBundleSipGetSignedDataMsg
Capability: CryptSIPDllIsMyFileType2
Dll: AppxSip.dll
- 53 -
Function Name: AppxBundleSipIsFileSupportedName
Capability: CryptSIPDllPutSignedDataMsg
Dll: AppxSip.dll
Function Name: AppxBundleSipPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: AppxSip.dll
Function Name: AppxBundleSipRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: AppxSip.dll
Function Name: AppxBundleSipVerifyIndirectData
GUID: 9F3053C5-439D-4BF7-8A77-04F0450A1D9F
Friendly Name: ElectronicSoftwareDistribution
Capability: CryptSIPDllCreateIndirectData
Dll: EsdSip.dll
Function Name: EsdSipCreateHash
Capability: CryptSIPDllGetCaps
Dll: EsdSip.dll
Function Name: EsdSipGetCaps
Capability: CryptSIPDllGetSignedDataMsg
Dll: EsdSip.dll
Function Name: EsdSipGetSignature
Capability: CryptSIPDllIsMyFileType2
Dll: EsdSip.dll
Function Name: EsdSipIsMyFileType
Capability: CryptSIPDllPutSignedDataMsg
Dll: EsdSip.dll
Function Name: EsdSipPutSignature
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: EsdSip.dll
Function Name: EsdSipDelSignature
Capability: CryptSIPDllVerifyIndirectData
Dll: EsdSip.dll
Function Name: EsdSipVerifyHash
GUID: C689AAB9-8E78-11D0-8C47-00C04FC295EE
Friendly Name: JavaClass
Capability: CryptSIPDllCreateIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPCreateIndirectData
Capability: CryptSIPDllGetCaps
Dll: WINTRUST.DLL
Function Name: CryptSIPGetCaps
Capability: CryptSIPDllGetSealedDigest
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSealedDigest
Capability: CryptSIPDllGetSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPPutSignedDataMsg
- 54 -
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPVerifyIndirectData
GUID: 1629F04E-2799-4DB5-8FE5-ACE10F17EBAB
Friendly Name: WSHVBScript
Capability: CryptSIPDllCreateIndirectData
Dll: wshext.dll
Function Name: CreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: wshext.dll
Function Name: GetSignedDataMsg
Capability: CryptSIPDllIsMyFileType2
Dll: wshext.dll
Function Name: IsFileSupportedName
Capability: CryptSIPDllPutSignedDataMsg
Dll: wshext.dll
Function Name: PutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: wshext.dll
Function Name: RemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: wshext.dll
Function Name: VerifyIndirectData
GUID: DE351A42-8E59-11D0-8C47-00C04FC295EE
Friendly Name: Flat
Capability: CryptSIPDllCreateIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPCreateIndirectData
Capability: CryptSIPDllGetCaps
Dll: WINTRUST.DLL
Function Name: CryptSIPGetCaps
Capability: CryptSIPDllGetSealedDigest
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSealedDigest
Capability: CryptSIPDllGetSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPVerifyIndirectData
- 55 -
GUID: 5598CFF1-68DB-4340-B57F-1CACF88C9A51
Friendly Name: AppXP7XSignature
Capability: CryptSIPDllCreateIndirectData
Dll: AppxSip.dll
Function Name: P7SipCreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: AppxSip.dll
Function Name: P7xSipGetSignedDataMsg
Capability: CryptSIPDllIsMyFileType2
Dll: AppxSip.dll
Function Name: P7xSipIsFileSupportedName
Capability: CryptSIPDllPutSignedDataMsg
Dll: AppxSip.dll
Function Name: P7xSipPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: AppxSip.dll
Function Name: P7xSipRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: AppxSip.dll
Function Name: P7xSipVerifyIndirectData
GUID: DE351A43-8E59-11D0-8C47-00C04FC295EE
Friendly Name: Catalog
Capability: CryptSIPDllCreateIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPCreateIndirectData
Capability: CryptSIPDllGetCaps
Dll: WINTRUST.DLL
Function Name: CryptSIPGetCaps
Capability: CryptSIPDllGetSealedDigest
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSealedDigest
Capability: CryptSIPDllGetSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPVerifyIndirectData
GUID: C689AAB8-8E78-11D0-8C47-00C04FC295EE
Friendly Name: PortableExecutable
Capability: CryptSIPDllCreateIndirectData
Dll: WINTRUST.DLL
Function Name: CryptSIPCreateIndirectData
Capability: CryptSIPDllGetCaps
Dll: WINTRUST.DLL
- 56 -
Function Name: CryptSIPGetCaps
Capability: CryptSIPDllGetSealedDigest
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSealedDigest
Capability: CryptSIPDllGetSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: WINTRUST.DLL
Function Name: CryptSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: WINTRUST.dll
Function Name: CryptSIPVerifyIndirectData
GUID: BA08A66F-113B-4D58-9329-A1B37AF30F0E
Friendly Name: SilverlightXAP
Capability: CryptSIPDllCreateIndirectData
Dll: XapAuthenticodeSip.dll
Function Name: XAP_CryptSIPCreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: XapAuthenticodeSip.dll
Function Name: XAP_CryptSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: XapAuthenticodeSip.dll
Function Name: XAP_CryptSIPPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: XapAuthenticodeSip.dll
Function Name: XAP_CryptSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: XapAuthenticodeSip.dll
Function Name: XAP_CryptSIPVerifyIndirectData
Capability: CryptSIPDllIsMyFileType2
Dll: XapAuthenticodeSip.dll
Function Name: XAP_IsFileSupportedName
GUID: CB034CC7-4A2D-8E07-48E7-F82436FFA03E
Friendly Name: MicrosoftDynamicsNAV
Capability: CryptSIPDllCreateIndirectData
Dll: navsip.dll
Function Name: NavSIPCreateIndirectData
Capability: CryptSIPDllGetCaps
Dll: navsip.dll
Function Name: NavSIPGetCaps
Capability: CryptSIPDllGetSignedDataMsg
Dll: navsip.dll
Function Name: NavSIPGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: navsip.dll
Function Name: NavSIPPutSignedDataMsg
- 57 -
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: navsip.dll
Function Name: NavSIPRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: navsip.dll
Function Name: NavSIPVerifyIndirectData
Capability: CryptSIPDllIsMyFileType2
Dll: navsip.dll
Function Name: NavSIPIsFileSupportedName
GUID: 9FA65764-C36F-4319-9737-658A34585BB7
Friendly Name: MicrosoftOfficeVBA
Capability: CryptSIPDllCreateIndirectData
Dll: mso.dll
Function Name: MsoVBADigSigCreateIndirectData
Capability: CryptSIPDllGetSignedDataMsg
Dll: mso.dll
Function Name: MsoVBADigSigGetSignedDataMsg
Capability: CryptSIPDllPutSignedDataMsg
Dll: mso.dll
Function Name: MsoVBADigSigPutSignedDataMsg
Capability: CryptSIPDllRemoveSignedDataMsg
Dll: mso.dll
Function Name: MsoVBADigSigRemoveSignedDataMsg
Capability: CryptSIPDllVerifyIndirectData
Dll: mso.dll
Function Name: MsoVBADigSigVerifyIndirectData
- 58 -
References
Prior to authoring this whitepaper, there was no information on the security implications of SIPs and
trust providers. The following references were helpful in completing this research, however:
1. SIP’s (Subject Interface Package) and Authenticode
2. Cryptography Functions
3. How To Get Information from Authenticode Signed Executables
4. Behind PowerShell Installer (for Windows XP / Windows Server 2003)
5. Microsoft Security Bulletin MS13-098
6. MSDN documentation
7. Windows SDK header files: mssip.h, wintrust.h, wincrypt.h, softpub.h
8. Subject Interface Packages - Part 1. Released after research was performed but this is a valuable
resource about SIP design principles.
9. Subject Interface Packages - Part 2.
- 59 -
Acknowledgements
The following people performed a thorough review of this whitepaper and supplied invaluable feedback:
● Brian Reitz, Will Schroeder, and Lee Christensen at SpecterOps
● Casey Smith at Red Canary
● Daniel Schell and David Cottingham at Airlock Digital
● Joe Desimone at Endgame
- 60 -