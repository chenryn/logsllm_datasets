        Group type code/version: 0011/0 (3A  - ODA ID)
        Traffic Program: 1
        Programme Type: 01001 (9  - Varied Speech)
        Decoded TMC Sys Info group (3A - AID 52550):
                Location Table Number: 000001 (1)
                Alternative Frequency bit: 1
                Mode of Transmission: 0
                International Scope: 1
                National Scope: 0
                Regional Scope: 0
                Urban Scope: 0
                AID: 1100110101000110 (52550)
        Raw dump | Data             Checkword  Hex
        Block 1: | 0101001000011000 0000010100 5218
        Block 2: | 0011010100110000 1111101000 3530
        Block 3: | 0000000001101000 0010011011 0068
        Block 4: | 1100110101000110 1111001001 cd46
 Copyright 2007 Inverse Path Ltd.
srdsd + Google Maps
Injecting RDS-TMC Traffic Information Signals
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC
Injecting RDS-TMC Traffic Information Signals
Video Clip time!
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC
Injecting RDS-TMC Traffic Information Signals
* WARNING: Your Experience May Differ
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC
Injecting RDS-TMC Traffic Information Signals
● We use a commercialy available RDS encoder (40$ USD), 
but it's reasonable to build your own (we are working on it)
● i2c is being used for communicating with its chipset, we use 
our custom C application over the supplied client for being 
able to send different Group Types
● We set all parameters (PI, PTY, etc) + the remaining data 
(last 3 RDS Blocks in Hexadecimal)
● The checkword is automatically computed by the chipset
● http://dev.inversepath.com/rds/i2c_minirds.tar.gz
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC
Injecting RDS-TMC Traffic Information Signals
unsigned char PI_buf[PI_BUF]     = { '\x52', '\x18' };                          /* PI */
unsigned char PS_buf[PS_BUF]     = { 'R', 'A', 'D', 'I', '0', '1', '0', '5' };  /* PS */
...
unsigned char UDG2_buf[UDG2_BUF] = {'\x35','\x30','\x00','\x66','\xCD','\x46'}; /* 3A */
unsigned char UDG1_buf[UDG1_BUF] = {'\x85','\x22','\xC8','\x6C','\x05','\x6F'}; /* 8A */
85       22                   C8       6C                   05       6F
10000101 00100010  11001000 01101100  00000101 01101111 
Group B0  TP PTY D F DP        D PN Extent Event           Location
  8   0   1  9   0 0 2         1 1  1      108             1391
 8A Group     Varied Speech      Queueing Traffic          
                                                           | Check against your country |
                                                           |       Location Table       |    
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC
Injecting RDS-TMC Traffic Information Signals
  i2c Application
  RDS Encoder
Parallel
i2c Protocol
  FM Transmitter
MPX
TX Antenna
Main components:
 1x MiniRDS Encoder
   (http://www.pira.cz)
 1x FM transmitter
 1x PIC16F84
 1x SAA1057 (digital PLL tuning)
 1x closed dipole antenna
 Copyright 2007 Inverse Path Ltd.
Injection Circuitry
Injecting RDS-TMC Traffic Information Signals
 Copyright 2007 Inverse Path Ltd.
Transmitting FM
Injecting RDS-TMC Traffic Information Signals
● The FM transmitter can be tuned to arbitrary frequencies
● It's important to have a stable transmitter for data injection
● Long distances can be easily covered (but it might be 
desirable to keep it short enough to reach only the victim)
 Copyright 2007 Inverse Path Ltd.
Transmitting FM
Injecting RDS-TMC Traffic Information Signals
(Resistance is Futile)
TX “The Sterilizer” Antenna
 Copyright 2007 Inverse Path Ltd.
Transmitting FM
Injecting RDS-TMC Traffic Information Signals
Video Clip time!
 Copyright 2007 Inverse Path Ltd.
Locking the SatNav
Tuner
Injecting RDS-TMC Traffic Information Signals
● RDS-TMC is detected using 3A Sys Info groups
which specify the Location Table, the Scope of 
the service and timing settings
● Hijack existing channels:
1. Find the frequency of a channel that provides RDS-TMC
2. Obscure the channel and send 8A packets (3A not
    necessary) when SatNav locks on it (careful timing)
● Fake a FM broadcast using 3A groups:
1. Find an unused frequency
2. Transmit 3A groups continuosly + 8A packets
 Copyright 2007 Inverse Path Ltd.
Being Stealthy
Injecting RDS-TMC Traffic Information Signals
Option 1: Mix the audio component taken on the Alternate
               Frequency (AF) for the hijacked channel
Option 2: Fake a new channel on an unused frequency
  RDS Encoder
  FM Transmitter
MPX
TX Antenna
FM Receiver (on AF)
Audio component
RX Antenna
 Copyright 2007 Inverse Path Ltd.
Attack 1:
Standard Traffic Msgs
Injecting RDS-TMC Traffic Information Signals
● We can create:
1. Queues
2. Bad Weather (Rain, Smog, Fog, Fresh Snow,...)
3. Full Car Parks
4. Overcrowded Service Areas (OMG!)
5. Accidents
6. Roadworks
...and so on...
● Not particularly exciting but still nice...it gets better 
though...
 Copyright 2007 Inverse Path Ltd.
Attack 1:
Standard Traffic Msgs
Injecting RDS-TMC Traffic Information Signals
Code 108
-
Queueing 
Traffic
 Copyright 2007 Inverse Path Ltd.
Attack 2:
Closing Roads
Injecting RDS-TMC Traffic Information Signals
● We can close arbitrary roads, bridges and tunnels with a 
number of Events: Closed, No through traffic, Accidents
● The SatNav will pop-up the event (even if no diversion is 
specified on our model) and ask the user for a detour
● If the closed road is encountered during re-calculation of the 
route (which is a very common thing) it will be silently 
avoided
● this attack is also known as “keep your parents from 
reaching home”...
 Copyright 2007 Inverse Path Ltd.
Attack 2:
Closing Roads
Injecting RDS-TMC Traffic Information Signals
Code 401 - Closed
 Copyright 2007 Inverse Path Ltd.
Attack 2:
Closing Roads
Injecting RDS-TMC Traffic Information Signals
Route avoiding the
“Closed” Event
Normal route to home
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
● The Event table supports a number of security related 
messages
● We doubt anyone ever used them so far
● They pose a very interesting target for social engineering 
purposes (Homeland Security would freak out)
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
Code 1518 – Terrorist Incident
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
Code 1481 – Air raid, danger
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
Code 978 – Air crash
Airport               Event
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
Code 1516 – Bomb alert
 Copyright 2007 Inverse Path Ltd.
Attack 3:
Security Messages
Injecting RDS-TMC Traffic Information Signals
Code 1571
Security alert. Stationary traffic
● Security messages can be pop-up, if they affect current 
route
● Video Clip time!
 Copyright 2007 Inverse Path Ltd.
Other funny messages
Injecting RDS-TMC Traffic Information Signals
Code 1456 – Bull Fight (you never know...)
Code 1560 – Delays due to parade
...and many more...(no you can't have a pony)
 Copyright 2007 Inverse Path Ltd.
Implementation Issues
Injecting RDS-TMC Traffic Information Signals
● On our Honda integrated SatNav we've seen that:
➔ The PI is not associated to the frequency, any PI can be 
used on any frequency for hijacking
➔ Total cancellation (Event: 2047, Location: 65535) is not 
honoured
➔ Broadcast message (Location: 65535) is not honoured
➔ Diversion bit is ignored for some categories and always 
assumed = 1
● We expect other SatNav systems to have similar or even 
more interesting issues
 Copyright 2007 Inverse Path Ltd.
RDS-TMC Encryption
Injecting RDS-TMC Traffic Information Signals
● TMC supports a very lightweight encryption for commercial 
services
● Described in ISO 14819-6
● It's used for signal discrimination rather than authentication
● Only the Location Code is encrypted
● It involves bitwise operations against a key
● The key can be trivially broken by sampling some data
● Terminals that support encryption are also expected to 
accept un-encrypted data, so injection is still possible
 Copyright 2007 Inverse Path Ltd.
Security Considerations
Injecting RDS-TMC Traffic Information Signals
● RDS-TMC can be trivially injected
● Drivers don't tend to have any security awareness towards 
their SatNav, social engineering, forced detours and panic 
attacks are possible
● We don't think it's “The End Of The World As We Know It”
but these systems should be authenticated considering their 
increased usage and expansion
● These technologies have a very long life span and “patching” 
is not easy
● We hope to increase awareness about these kind of problems
 Copyright 2007 Inverse Path Ltd.
TMC Forum
Official Response
Injecting RDS-TMC Traffic Information Signals
● “Hacking TMC – Unsuccessfully” (...not really)
● “The first and overriding statement that should be made is that 
transmissions of this type are directly analogous to “pirate” radio 
broadcasts and certainly will, in the case of Europe and the U.S., 
contravene each countries respective broadcasting legislation and laws.”
● “...there is a chance that the false message could be decoded, but a 
degree of knowledge would have to be gained on parameters of the 
message being coded...”
● “...the random use of any location code would result in a randomly 
located event... Also random choices of Event codes may not cause the 
terminal to react...”
 Copyright 2007 Inverse Path Ltd.
Injecting RDS-TMC Traffic Information Signals
● “In the case of (b), i.e. if the transmission is on a different frequency, it is 
very unlikely that a terminal will even tune to the false service. This is 
because this frequency will not be either in the main AF list or the 
secondary AF list broadcast in any of the tuning variants of the TMC 
data.”
● “Service Providers and Broadcasters, I am sure, have many protection 
mechanisms and processes in place to prevent any illegitimate access to 
their services within their infrastructure.”
● read the full response at: 
http://www.tmcforum.com/en/about_tmc/tmc_news/hacking_tmc_-_unsuccessfully.htm
our reply: 
http://dev.inversepath.com/rds/our_response_to_TMC_Forum_statement.txt
 Copyright 2007 Inverse Path Ltd.
TMC Forum
Official Response
The Future
Injecting RDS-TMC Traffic Information Signals
● TMC is also supported over DAB and satellite radio, it's 
harder to inject compared to FM but still possible
● TPEG (Transport Protocol Experts Group) is the new 
standard designed for replacing TMC. It supports encryption 
but it's still optional. (http://tpeg.org)
● GST (Global System for Telematics) is an impressive new 
architecture for delivering a number of services. It's backed 
up by many manufacturers and it will support PKI for billing 
and transport purposes. Adoption is many years away from 
now. (http://gstforum.org)
 Copyright 2007 Inverse Path Ltd.
Similar Systems
Injecting RDS-TMC Traffic Information Signals
● Microsoft DirectBand (http://www.directband.com), used for 
MSN Direct, is another FM subcarrier channel for data 
transmission
● It has a larger bandwidth (15 times that of RDS) and full 
encryption
● Other than special wristwatches it's also been used on 
SatNav systems for traffic information
(http://garmin.msndirect.com)
● Closed standard, not available in Europe, looks very 
promising...we'd love to play with that too ;)
 Copyright 2007 Inverse Path Ltd.
The End
Thanks for listening! - Questions?
(shameless plug)
http://www.inversepath.com
Traffic Sign Images used with permission from 
http://gettingaroundgermany.home.att.net
Thanks to Brian Purcell
Injecting RDS-TMC Traffic Information Signals
 Copyright 2007 Inverse Path Ltd.