# 复盘网络战：乌克兰二次断电事件分析
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
乌克兰，位于欧洲东部，东接俄罗斯，西欧洲诸国相连。从地缘政治角度来看，这个“桥梁国家”，不断受到俄罗斯与欧洲之间的权力争夺。从历史来看，显而易见，在经过两次大规模“颜
色革命”后，乌克兰经济元气大伤，沦为全欧最穷国。
纵观乌克兰的发展历史，在乌克兰境内发生的网络战争在世界范围内独树一帜，无论是国内反对派的网络攻击，或是邻国的网络攻击，均在不间断的进行中，据外媒报道，乌克兰已经沦为俄罗斯的网络战试验场。
其中，影响力最大的一次网络攻击事件，时至今日仍然活在各类文章引用中的经典攻击案例，莫属二次 **乌克兰断电事件。**
而本文将结合最新线索，回顾并分析该典型网络战役背后的真实目的。
## 乌克兰断电事件回顾
停留在大多数人记忆中的乌克兰断电事件，还是2015年12月23日的那起断电事件，当时乌克兰首都基辅部分地区和乌克兰西部的 140
万名居民遭遇了一次长达数小时的大规模停电，至少三个电力区域被攻击，占据全国一半地区。
而当初的攻击背景是在克里米亚公投并加入俄罗斯联邦之后，因乌克兰与俄罗斯矛盾加剧，在网络攻击发生前一个月左右，乌克兰将克里米亚地区进行了断电。
对于那次攻击，乌克兰的Kyivoblenergo电力公司表示他们公司遭到BlackEnergy[1]网络入侵，因此导致7个110KV的变电站和23个35KV的变电站出现故障，从而导致断电。
本次乌克兰断电事件中，攻击者首先通过“主题为乌克兰总统对部分动员令”钓鱼邮件进行投递，在受害者点击并启用载有BlackEnergy的恶意宏文档后，
BlackEnergy在获取了相关凭证后，便开始进行网络资产探测，横向移动，并最终获得了SCADA系统的控制能力。
从而可以通过该系统，进行断路器操纵，并在攻击发生前，先使用KillDisk擦除入侵痕迹覆盖MBR和部分扇区的方式进行数据破坏，使得系统不能正常自启，阻止断电后的迅速恢复，此外据资料显示，Sandworm在发生攻击时还曾对客服中心发起dos攻击，阻止电力公司提前得知断电消息。
在做好以上准备后，断电攻击就此开始，这一断，“名流千史”。
攻击过程大致如下图所示[6]
事实上，在事件过去接近一年后，也就是2016年12月17日，乌克兰还发生了第二起断电事件，乌克兰国家电网运营商Ukrenergo的网络中被植入了一种被称为Industroyer或Crash
Override的恶意软件，利用已经部署好的恶意软件破坏了乌克兰首都基辅附近一个传输站的所有 **断路器** ，从而导致首都大部分地区断电。
而这次停电持续时间并不长，仅数十分钟，受影响的区域是乌克兰首都基辅北部及其周边地区。也许是由于本次的攻击不够前一次的力度大，或者是乌克兰对于电力系统的应急响应速度提升了等级，因此
Ukrenergo工程师在将设备切换为手工模式便开始恢复供电，75分钟后完全恢复供电。
## Sandworm组织分析
据ESET，Dragos等国外安全厂商研究表明，当初发起这两起电力系统攻击的APT组织，名称为Sandworm(沙虫)，别名TeleBots，组织来自俄罗斯，据Dragos[3]称，发起第二起电网攻击的团队名为ELECTRUM，属于Sandworm的分支攻击团队。
而关于该组织所使用的网络武器方面，经过奇安信威胁情报中心红雨滴团队安全分析人员的深入关联分析，并结合ESET的分析报告[2]，可知该组织曾经使用的有代表性的网络武器如下所示：
BlackEnergy，一个被各种犯罪团伙使用多年的工具。从一个DDoS（分布式拒绝服务）木马被Sandworm开发成一个拥有模块化结构的，整体架构十分复杂的恶意软件，专门用于进行入侵驻留等操作。
Industroyer，又名Crash Override[3]，是一个由一系列的攻击模块(多达十个)组成的模块化结构恶意软件，其中便有著名的实现西门子
SIPROTEC 设备 DoS 攻击模块，可导致其中继变得无响应，也就是第二次乌克兰断网攻击的关键武器。
NotPetya，一个专门用于数据擦除的，并且可以利用”永恒之蓝”系列漏洞进行横向传播的勒索软件，于2017年6月乌克兰遭受NotPetya勒索程序大规模攻击。包括首都基辅的鲍里斯波尔国际机场、乌克兰国家储蓄银行、船舶公司、俄罗斯石油公司和乌克兰一些商业银行以及部分私人公司、零售企业和政府系统都遭到了攻击。实际上NotPetya波及的国家还包括英国、印度、荷兰、西班牙、丹麦等。
GreyEnergy，被称为BlackEnergy的继承者[4]。GreyEnergy的恶意软件框架与BlackEnergy有许多相似之处，各模块均通过组织确认后才进行下发，其中模块都用于间谍和侦察目的（即后门，文件提取，截屏，键盘记录，密码和凭证窃取等）。
KillDisk，其为一种流行于黑客界近十年之久的数据破坏类恶意软件，起初作为BlackEnergy的一个专用于进行数据破坏的插件，后来被安全人员发现与NotPetya存在关联。
## 2016乌克兰断电事件新线索
从前些章节可得知，关于乌克兰在2015年的断电攻击事件相对来说为世人所知，并且细节披露的非常多，而2016年的乌克兰断电事件无论是后续还有攻击过程，都少了些许细节以及真实攻击目的。
从各种资料可得知，乌克兰第二次断电事件虽然攻击入口仍然是电子邮件或社会工程学攻击为主，但执行断电操作不再是人工发起，通过恶意软件样本硬编码的触发攻击的时间戳表明，恶意软件是脱离攻击者控制后，会在指定时间自动启动攻击。
此外本次的攻击者对电网内的工业控制协议，传输协议异常熟悉，从Industroyer的代码中可以发现，其包含针对以下四个电网通信协议的攻击模块：
• IEC 60870-5-101
• IEC 60870-5-104
• IEC 61850
• OLE for Process Control(OPC) Data Access (DA)