iltered
Kill]
图9.9退出Kismet
图9.10停止Kismet服务
（11）在该界面单击Kill，将停止Kismet服务并退出终端模式。此时，终端将会显示
一些日志信息，如下所示：
***KISMET CLIENT ISSHUTTING DOWN ***
[SERVER] INFO: Stopped source‘wlan0
[SERVER] ERROR: TCP server client read() ended for 127.0.0.1
[SERVER]
[SERVER] *** KISMET IS SHUTTING DOWN ***
[SERVER]
155883 logged.
[SERVER] INFO: Closed netxml log file “Kismet-20140723-17-19-48-1.netxml, 26
[SERVER]
logged.
[SERVER] INFO: Closed nettxt log fle *Kismet-20140723-17-19-48-1.nettxt', 26
[SERVER]
logged.
[SERVER] INFO: Closed gpsxml log file *Kismet-20140723-17-19-48-1.gpsxml', 0 logged.
[SERVER] INFO: Closed alert log file *Kismet-20140723-17-19-48-1.alert', 5 logged.
[SERVER] INFO: Shutting down plugins...
[SERVER] Shutting down log files...
[SERVER] WARNING: Kismet changes the configuration of network devices.
[SERVER]
In most cases you will need to restart networking for
[SERVER]
your interface (varies per distribution/OS, but
[SERVER]
usually:/etc/init.d/networking restart
[SERVER]
[SERVER]Kismet exiting.
Spawned Kismet server has exited
*** KISMET CLIENT SHUTTING DOWN.***
Kismet client exiting.
从以上信息的KISMETISSHUTTINGDOWN部分中，将看到关闭了儿个日志文件。
这些日志文件，默认保存在/root/目录。在这些日志文件中，显示了生成日志的时间。当运
行Kismet很多次或几天时，这些时间是非常有帮助的。
接下来分析一下上面捕获到的数据。切换到/root/目录，并使用Is命令查看以上生成的
• 270 ·
---
## Page 283
第9章无线网络渗透测试
日志文件。执行命令如下所示：
root@kali:~# Is Kismet-20140723-17-19-48-1.*
Kismet-20140723-17-19-48-1.alert
Kismet-20140723-17-19-48-1.netxml
Kismet-20140723-17-19-48-1.gpsxmlKismet-20140723-17-19-48-1.pcapdump
Kismet-20140723-17-19-48-1.nettxt
从输出的信息中，可以看到有五个日志文件，并且使用了不同的后缀名。Kismet工具
生成的所有信息，都保存在这些文件中。下面分别介绍下这几个文件的格式。
口alert：该文件中包括所有的警告信息。
口gpsXml：如果使用了GPS源，则相关的GPS数据保存在该文件中。
口nettxt：包括所有收集的文本输出信息。
口netxml：包括所有XML格式的数据。
口pcapdump：包括整个会话捕获的数据包。
下面主要介绍一下PCAP和Text文件的工具。
1.使用Wireshark分析PCAP信号帧
（1）启动Wireshark。执行命令如下所示：
root@kali:~#wireshark &
（2）打开pcapdump文件。在Wireshark界面的菜单栏中依次选择FilelOpen命令，将
显示如图9.11所示的界面。
Wiresharkc: Open Ca
root
位置(R)
名称
大小
修改日期
Q.搜索
 Kismet-20140723-17-19-48-1.alert
1.0 KB
17:24
最近使用的
 Kismet-20140723-17-19-48-1.gpsxml
264字节 17:26
 Kismet-20140723-17-19-48-1.nettxt
35.7 KB 17:24
桌面
 Kismet-20140723-17-19-48-1.netxml
81.7 KB17:24
文件系统
168MA
17
软盘驱动器
 tinux-3.14.6.tar
534.2 MB2014年06月11日
@ Kali Live
 Nessus-5.2.6-debian6_i386.deb
28.4MB2014年04月16日
 replayarp-0723-171023.cap
806字节17:11
Filter:
Filename:
Kismet-20140723-17-19-48-1.pcapdump
 Enable MAC name resolution
Format:
dexdq - /dunpd/y,esauM
Size:
17643643 bytes
Packets:
155883
 Enable transport name resolution
First Packet:
2014-07-23 17:21:12
Elapsed time
00:05:00
取消（C)
打开（0）
图9.11选择捕获的pcapdump文件
（3）在该界面选择Kismet工具捕获的pcapdump文件，然后单击“打开”按钮，将显
示如图9.12所示的界面。
· 271 ·
---
## Page 284
第3篇
各种渗透测试
Kismet-20140723-17-19-48-1.pcapdump [Wireshark 1.8.5 ]
File Edit ViewGoCapture AnalyzeStatistics Telephony Tools Internals Help
不业
Filter:
Expression.
Clea
Apply
保存
No.
Time
Source
Destination
Protocol Length Info
10.00000
Tp-LinkT
2 0.000575
Tp-LinkT_ac:fb:20
ac:1b:20
00:c1:40:76:05:6c
802.11
802.11
58 Deauthentication, SN=0, FN=0, FLags=...
58: Deauth
Flag
3 0.001190
Tp-LinkT_ac:fb:20
00:c1:40:76:05:6c
802.11
58 Deauthentication, SN=o, PN=o, FLags=..-
58 Deauthentication, SN=0, FN=0, FLags=..*
4 0.001552
Tp-LinkT_ac:fb:20
00:c1:40:76:05:6c
802.11
5 0.001963
Tp-LinkT_ac:fb:20
00:c1:40:76:05:6c
802.11
58 Deauthentication, SN=O, PN=O, FLags=,
6 0.003905
00:c1:40: 76:05:6c (R.802.11
42 AcknowLedgenent., FLags=........
7 0.004127
00:c1:40:76:05:6c
Broadcast
802.11
118 Data, SN=1600, FN=0, FLags=-P.....T
8 0.004936
Tp-LinkT_ac:fb:20
00:c1:40:76:05:6c
802.11
58 Deauthentication, SN=0, FN=O, FLags=,
9 0.005301
Tp-LinkT_ac:fb:20
00:c1:40:76:05:6c
802.11
58 Deauthentication, SN=O, FN=O, FLags=,
n.nntats
nn-=1-an-7R-E-6
an711
EN=F1ans
图9.12pcapdump文件数据包
（4）从该界面可以看到，Kismet扫描到的所有无线网络数据包。Beacon包是无线设备
基本的管理包，用来发送信号通知其他的服务。
2.分析Kismet的Text文件
在Linux中，可以使用各种文本编辑器打开nettxt文件，或者使用cat命令查看该文件
内容。下面使用Linux默认的文本编辑器打开nettxt文件，如图9.13所示。
Kismet2014072317-19481.nettxt (~) - VIM
-□x
文件(F)编辑(E）工具（T）语法(S）缓冲区(B）窗口(W）帮助(H)
Wed Jul 23 17:19:48 2014 - Kismet 2013,03.R0
Kismet (http://www.kismetvireless,net)
Netvork 1: BSSID 14:E6:E4:AC:FB:20
Manuf
: wed Jul 23 17:21:12 2014
: Tp-LinkT
Fi rst
Last
: wed Jul 23 17:24:48 2014
Type
: infrastructure
BSSID
: 14:E6:E4:AC:FB:20
SSID 1
Type
: Beacon
SSID
: *Test*
First
: Wed Jul 23 17:24:48 2014
: Wed Jul 23 17:21:12 2014
Last
Max Rate
: 54.0
Beacon
: 10
Encryption : WEP
Packets
:297
Frequency
ChanneL.
:0 - 75050 packets, 71.46%
:1
Frequency
_Frequency
:2417 . 2302 packets, 2.19%
: 2412 - 27652 packets, 26.33%
23, 1
顶端
图9.13nettxt 文件内容
从该界面可以看到nettxt文件中有大量的信息，列出了扫描到的每个无线网络。每个
无线网络都有一个标签，并且列出了连接到这些无线网络的每个客户端，如图9.14所示。
从该界面可以看到一个Client1，其MAC地址为00:c1：40:76:05:6c。它表示一个MAC
地址为00:c1：40:76:05:6c的客户端连接到了一个无线接入点。
·272 ·
---
## Page 285
第9章无线网络渗透测试
Kismet20140723171948-1.nettxt () - VIM
-口x
文件(F）编辑(E）工具（T）语法(S）缓冲区(B)窗口(W）帮助(H)
日
client 1: MAC 00:C1:40: 76:05: 6C
Manuf
: Unknown
First
: Wed Jul 23 17:21:12 2014
Last
: Wed Jul 23 17:24;48 2014
Type
MAC
: 00:C1:40:76:05:6C
: To Distribution
Channe1
Frequency
: 0 -
: 0
74538 packets, 100.00%
:1000
LLC
Data
:74538
: 0
Fragments
Crypt
：0
: 74538
Retries
:0
Datasize
Total
: 74538
Seen By : vlan0 (wLan0mon) b099ece0-124a-11e4-bbef - dc04bb23e201 74538 packe
:6385686
Client 2: MAC 14:E6:E4:AC:FB:20
Wed Jul 23 17:24:48 2014
Manuf
: Tp-LinkT
Fi rst
: Wed Jul 23 17:21:12 2014
Last
: Wed Jul 23 17:24:48 2014
45, 1
3%
图9.14客户端信息
9.2使用Aircrack-ng工具破解无线网络
学社
Aircrack-ng是一款基于破解无线802.11协议的WEP及WPA-PSK加密的工具。该工
具主要用了两种攻击方式进行WEP破解。一种是FMS攻击，该攻击方式是以发现该WEP
漏洞的研究人员名字（ScottFluhrer、ItsikMantin及AdiShamir）所命名：另一种是Korek
攻击，该攻击方式是通过统计进行攻击的，并且该攻击的效率要远高于FMS攻击。本节将
介绍使用Aircrack-ng破解无线网络。
9.2.1破解WEP加密的无线网络
WiredEquivalentPrivacy或WEP（有线等效加密）协议是对在两台设备间无线传输的
数据进行加密的方式，用以防止非法用户窃听或侵入无线网络。不过密码分析学家已经找
出WEP好儿个弱点，因此在2003年被Wi-FiProtectedAccess（WPA）淘汰，又在2004
年由完整的IEEE802.11i标准（又称为WPA2）所取代。本小节将介绍破解WEP加密的
无线网络。
使用Aircrack破解使用WEP加密的无线网络。具体操作步骤如下所示。
（1）使用airmon-ng命令查看当前系统中的无线网络接口。执行命令如下所示：
kali:~# airmon-ng
Interface
Chipset
Driver
wlano
Ralink RT2870/3070 rt2800usb -[phy1]
输出的信息表示，当前系统中存在一个无线网络接口。从输出结果的Interface列，可
· 273 ·
---
## Page 286
第3篇各种渗透测试
以看到当前系统的无线接口为wlan0。
（2）修改wlan0接口的MAC地址。因为MAC地址标识主机所在的网络，修改主机
的MAC地址可以隐藏真实的MAC地址。在修改MAC地址之前，需要停止该接口。执行
命令如下所示：
root@kali:~# airmon-ng stop wlan0
#停止wlan0接口
Interface
Chipset
Driver
wlano
Ralink RT2870/3070 rt2800usb - [phy1]
(monitor mode disabled)
或者：
root@kali:~# ifconfig wlan0 down
执行以上命令后，wlan0接口则停止。此时就可以修改MAC地址了，执行命令如下
所示：
root@kali:~#macchanger --mac 00:11:22:33:44:55 wlan0
Permanent MAC: 00:c1:40:76:05:6c (unknown)
Current
MAC: 00:c1:40:76:05:6c (unknown)
New
MAC: 00:11:22:33:44:55(Cimsys Inc)
输出的信息显示了wlan0接口永久的MAC地址、当前的MAC地址及新的MAC地址。
可以看到wlanl接口的MAC地址已经被修改。
（3）重新启动wlan0。执行命令如下所示：
root@kali:~# airmon-ng start wlan0
Found 3 processes that could cause trouble.
ee buxom sdos bu-unie jo bu-eidaie budnpoie 
a short period of time, you may want to kill (some of) them!
-e
PID Name
2567
NetworkManager
2716
dhclient
15609
wpa_supplicant
Interface
Chipset
Driver
wlano
Ralink RT2870/3070 rt2800usb - [phy1]
(monitor mode enabled on mon0)
输出的信息显示了无线网卡wlan0的芯片及驱动类型。例如，当前系统的无线网卡芯
片为RalinkRT2870/3070：默认驱动为rt2800usb，并显示监听模式被启用，映射网络接口
为mon0。
有时候使用airmon-ngstartwlanO命令启用无线网卡时，可能会出现SIOCSIFFLAGS：
Operation notpossible duetoRF-kill错误。这是因为Linux下有一个软件RF-kill，该软件为
了省电会将不使用的无线设备（如WIFI和Buletooth）自动关闭。当用户使用这些设备时，
RF-kill不会智能的自动打开，需要手动解锁。用户可以执行rfkilllist命令查看所有设备，
如下所示：
root@kali:~# rfkillist
0: ideapad_wlan: Wireless LAN
Soft blocked: yes
Hard blocked: no
1: phy0: Wireless LAN
Soft blocked: yes
· 274 ·
---
## Page 287
第9章无线网络渗透测试
Hard blocked:no