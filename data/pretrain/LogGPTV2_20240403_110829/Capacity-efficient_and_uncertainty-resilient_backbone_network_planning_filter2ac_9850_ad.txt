ğ‘€ âˆˆğ· (ğ‘)
ğ´ğ‘€ âˆˆ {0, 1}, âˆ€ğ‘€ âˆˆ ğ‘‡
We achieve a low DTM count with the commercial ILP solver
FICO Xpress [1]. As will be shown in Figure 9c, a flow slack of
approximately 1% can reduce the number of DTMs by over 75%, a
substantial gain in the computation needed for capacity planning.
A further increase in the flow slack results in even more impressive
results, though at the price of a lower Hose coverage, as we will
see in the next section.
4.4 Hose Coverage
As we perform Hose-compliant capacity planning, we need to define
a metric to evaluate the degree to which our generated reference
TMs cover the entire Hose space. In particular, since we use a
two-stage process, where we sample the Hose space using a large
number of TMs and further down-sample them to reach a smaller
number of DTMs, it is desirable to measure the Hose coverage for
each stage of the process.
Recall that the Hose is represented by a convex polytope ğ‘ƒ in
a high-dimensional vector space, a natural way to measure the
coverage of a set of samples ğ‘† would be by volume, namely the
volume of the convex hull containing all the samples divided by
the volume of the Hose space as follows. This metric is illustrated
in Figure 7 in three dimensions.
Coverage(ğ‘†, ğ‘ƒ) = Volume(ConvexHull(ğ‘†))
Volume(ğ‘ƒ)
(3)
When applying to practical instances of network planning, how-
ever, this metric is intractable. The complexity of computing a
convex hull for ğ‘‰ points in a ğ¿-dimensional space is approximately
2 ) [6]. In our case, ğ‘‰ = ğ‘ 2 âˆ’ ğ‘ where ğ‘ is the node count
ğ‘‚ (ğ‘‰
in the network, which can be a few hundred, and the sample size
ğ‘‰ = |ğ‘† | can be 105.
ğ¿
Instead, we define the planar coverage of the Hose space ğ‘ƒ by a
set of samples ğ‘† on a plane ğ‘ as follows, where Î (ğ‘†, ğ‘) marks the
projection of the samples in ğ‘† on the plane ğ‘, and Î (ğ‘ƒ, ğ‘) is the
projection of the Hose polytope ğ‘ƒ on ğ‘.
PlanarCoverage(ğ‘†, ğ‘ƒ, ğ‘) = Area(Î (ğ‘†, ğ‘))
Area(Î (ğ‘ƒ, ğ‘))
(4)
For a collection of planes ğµ, we define the coverage of the Hose
space ğ‘ƒ by a set of samples ğ‘† to be the mean planar coverage of ğ‘ƒ
by ğ‘† across all the planes in ğµ.
ğ‘›
PlanarCoverage(ğ‘†, ğ‘ƒ, ğ‘ğ‘– )
(5)
Coverage(ğ‘†, ğ‘ƒ) = 1
ğ‘›
ğ‘–=1
The choice of these planes is critical for picturing the high-
dimensional Hose space truthfully. These planes should charac-
terize all the variables in the Hose constraints, and the variables
should contribute equally to shaping the planes. Conveniently, we
construct planes with all the pairwise combinations of the variables
in the Hose constraints. Recall from Formula (1) that each variable is
an off-diagonal coefficient of a valid TM ğ‘€, or a source-destination
pair in the network. In the Figure 7 example, the chosen planes are
ğµ = {Plane(ğ‘š1,2, ğ‘š1,3), Plane(ğ‘š1,2, ğ‘š1,4), Plane(ğ‘š1,3, ğ‘š1,4)}.
5 CROSS-LAYER OPTIMIZATION
Capacity planning requires cross-layer optimization of the optical
network and the IP network. The optimization inputs include the
DTMs, the IP topology ğº = (ğ‘‰ , ğ¸) with backbone routers ğ‘‰ and
IP links ğ¸, and the optical topology ğº (cid:2) = (ğ‘‰ (cid:2), ğ¸ (cid:2)) involving the
OADMs ğ‘‰ (cid:2)
. The outputs are the target IP and
optical topologies ğº +Î”ğº = (ğ‘‰ , ğ¸+Î”ğ¸) and ğº (cid:2)+Î”ğº (cid:2) = (ğ‘‰ (cid:2), ğ¸ (cid:2)+Î”ğ¸ (cid:2))
with the same sites but more links or greater capacity. This section
presents the optimization process in detail.
and fiber segments ğ¸ (cid:2)
5.1 Cost Model
Although planning is not a time-critical mission, given the size of
our network, we want the optimization to at least finish, hopefully
in hours. To simplify the optimization, we devise a cost model to
abstract complications in the optical and routing systems as simple
cost factors multiplied to the decision variables. The five essential
cost factors are:
Fiber procurement and deployment cost This is the entire cost
of purchasing and installing a new fiber before it becomes usable.
If we own the fiber, it includes the equipment cost of procuring the
fiber, optical amplifiers, Configurable Optical Add/Drop Multiplex-
ers (COADMs), Wavelength Selective Switches (WSSes), IP router
chassis, as well as the labor cost of cleaning the fiber, deploying
the amplifiers along the fiber path and deploying COADMs, WSSes,
and router chassis at the terminal sites. If we lease the fiber, it cov-
ers all the usage, operational, and maintenance cost in the leasing
contract. This cost varies fiber to fiber depending on the vendor,
fiber length, fiber type (terrestrial, submarine, or aerial), etc., and
we model it based on these features. We denote this cost as ğ‘¥ (ğ‘™) for
fiber segment ğ‘™ on the optical topology ğº (cid:2)
Fiber turn-up cost This is the cost of turning up a dark fiber that
is already installed. It includes the cost of purchasing extra equip-
ment such as transponders and line cards and the manual effort of
configuring devices. We estimate this cost based on historical data.
It is denoted as ğ‘¦ (ğ‘™) for fiber segment ğ‘™ on ğº (cid:2)
Capacity addition cost This is the cost of provisioning a new
wavelength on a turned-up fiber. It adds one unit of bandwidth
capacity, i.e., 100Gbps, on the IP layer. This cost involves the labor
work of wavelength provisioning and router port configuration. It
is a flat cost, denoted as ğ‘§ (ğ‘’) for IP link ğ‘’ on the IP topology ğº.
Spectral efficiency This factor captures the proportion of optical
spectrum a unit of IP capacity consumes over all fiber segments on
its path, which depends on the modulation required to get error-free
transmission on the circuit. We denote the spectral efficiency of an
IP link ğ‘’ as ğœ‘ (ğ‘’) and delegate the sophisticated optical link engi-
neering calculations to an optical link simulator similar to [21]. The
.
.
following spectral conservation constraint regulates the spectral
consumption per fiber segment ğ‘™ âˆˆ ğ¸ (cid:2)
. Assume ğ‘™ has ğœ™ğ‘™ lighted-up
fibers, each having a maximum allowable spectrum ğ‘€ğ‘ğ‘¥ğ‘†ğ‘ğ‘’ğ‘ (ğ‘™).
For an IP link ğ‘’ âˆˆ ğ¸, the required spectrum is the IP capacity ğœ†ğ‘’
multiplied by its spectral efficiency ğœ‘ (ğ‘’). Thus, the total spectrum
consumed over fiber segment ğ‘™ must be greater than or at least equal
to the sum of spectrum required by each IP link ğ‘’ riding over this
fiber segment, specified by the IP-optical mapping function ğ¹ğ‘† (ğ‘’).
To account for the loss of usable spectrum due to the spectrum
continuity constraint [3], we reserve a percentage of ğ‘€ğ‘ğ‘¥ğ‘†ğ‘ğ‘’ğ‘ (ğ‘™)
as a planning buffer while turning up fibers. This abstraction of
wavelength contention saves the effort of accurate wavelength
allocation and works well in practice.
ğ‘†ğ‘ğ‘’ğ‘ğ¶ğ‘œğ‘›ğ‘ ğ‘’ğ‘Ÿğ‘£ (ğº, ğº (cid:2)):
ğœ‘ (ğ‘’) Ã— ğœ†ğ‘’ â‰¤ ğ‘€ğ‘ğ‘¥ğ‘†ğ‘ğ‘’ğ‘ (ğ‘™) Ã— ğœ™ğ‘™ , âˆ€ğ‘™ âˆˆ ğ¸ (cid:2)
(6)
ğ‘’ âˆˆğ¸, ğ‘™ âˆˆğ¹ğ‘† (ğ‘’),
Routing overhead This is the loss of bandwidth capacity due to
imperfection of routing algorithms. We formulate capacity plan-
ning as a multi-commodity flow problem [11] on the IP layer. In
practice, backbone routers only allow for a small number of paral-
lel paths per flow, such as in Equal-Cost Multi-Path (ECMP) and
K-shortest path routing, which makes the problem NP-hard. To
solve it in polynomial time, we switch to fractional flows, i.e., every
flow being infinitely splittable, and we capture the difference from
the actual routing algorithm by routing overhead. For a particular
routing algorithm, the routing overhead ğ›¾ is a [1, +âˆ) factor multi-
plied to the original traffic demand to give headroom for routing
inefficiency.
5.2 Resilience Policy
Our services are categorized into several QoS classes for different
performance guarantees. Different QoS classes have different re-
silience policies. Higher QoS classes (usually denoted by smaller
class numbers) can tolerate more failures, through more robust
routing algorithms and greater protection capacity in backup paths.
Based on the resilience policy, each QoS class has a pre-defined set
of failure scenarios to protect against. A failure scenario presents
the physical-layer fiber cuts and the loss of IP links on these fibers.
With Hose-based capacity planning, we need to fully satisfy the
traffic demand of each QoS class under the protected failures. As
Equation (7) shows below, for QoS class ğ‘, we have a set of post-
failure residual IP topologies ğºğ‘, whose elements are formed by
removing the failed IP links of a particular failure scenario ğ‘Ÿğ‘ in
the scenario set ğ‘…ğ‘.

ğºğ‘ =
(ğº0 âˆ’ ğ‘Ÿğ‘)
(7)
ğ‘Ÿğ‘ âˆˆğ‘…ğ‘
As described in Section 3, we forecast traffic for individual service
types. Aggregating across services, we have a Hose model ğ»ğ‘ per
QoS class ğ‘ âˆˆ {ğ‘„ğ‘œğ‘† }. We design resilience policies in such a way
that traffic from one QoS class is protected against failure scenarios
from its own class and all other classes lower than it. Hence, the
residual topology ğºğ‘ must carry traffic of its own class and all
higher classes. Per Section 5.1, each QoS class may use a different
routing scheme, thus having a different routing overhead. Like
shown in the equation below, the reference DTMs of a QoS class ğ‘
553
is derived from the TM generation in Section 4 over all the protected
traffic, as the union of the Hose constraints in classes 1 to ğ‘, with
the routing overhead applied.
ğ‘
ğ‘‡ğ‘ = ğ·ğ‘‡ ğ‘€ (
ğ›¾ (ğ‘–) Ã— ğ»ğ‘– )
(8)
ğ‘–=1
For each QoS class ğ‘, given the DTMs ğ‘‡ğ‘ and post-failure IP
topologies ğºğ‘, the traffic flows in each reference TM ğ‘€ âˆˆ ğ‘‡ğ‘ must
satisfy the conservation constraints on every topology ğº âˆˆ ğºğ‘, as
shown below. That is, for every flow in a TM ğ‘€, the source and sink
of the flow have the required traffic amount, all intermediate nodes
of the flow have zero traffic in sum, and the flows over an IP link
cannot exceed the bandwidth capacity ğœ†. Here we simply assume
all flows are infinitely splittable, because the difference from the
actual routing algorithms is accounted for by the routing overhead.
ğ¹ğ‘™ğ‘œğ‘¤ğ¶ğ‘œğ‘›ğ‘ ğ‘’ğ‘Ÿğ‘£ (ğ‘€, ğº) for ğ‘€ âˆˆ ğ‘‡ğ‘, ğº âˆˆ ğºğ‘:


ğ‘“ğ‘–,ğ‘— (ğ‘¢, ğ‘–) = ğ‘šğ‘–,ğ‘—

{ğ‘–,ğ‘¢ } âˆˆğ¸

{ ğ‘—,ğ‘¢ } âˆˆğ¸
ğ‘“ğ‘–,ğ‘— (ğ‘–, ğ‘¢) âˆ’
ğ‘“ğ‘–,ğ‘— (ğ‘¢, ğ‘—) âˆ’
ğ‘“ğ‘–,ğ‘— (ğ‘¢, ğ‘£) âˆ’

{ğ‘–,ğ‘¢ } âˆˆğ¸

{ ğ‘—,ğ‘¢ } âˆˆğ¸
ğ‘“ğ‘–,ğ‘— ( ğ‘—, ğ‘¢) = ğ‘šğ‘–,ğ‘—
ğ‘“ğ‘–,ğ‘— (ğ‘£, ğ‘¢) = 0
(9)
{ğ‘¢,ğ‘£ } âˆˆğ¸,
ğ‘¢â‰ ğ‘–,ğ‘£â‰ ğ‘—
ğ‘“ğ‘–,ğ‘— (ğ‘¢, ğ‘£) â‰¤ ğœ†ğ‘¢,ğ‘£
âˆ€ğ‘šğ‘–,ğ‘— âˆˆ ğ‘€
{ğ‘¢,ğ‘£ } âˆˆğ¸,

ğ‘¢â‰ ğ‘–,ğ‘£â‰ ğ‘—
{ğ‘¢,ğ‘£ } âˆˆğ¸
5.3 Short-Term Planning
Short-term network planning is for the next 6 months to 2 years.
In this period, we rely on the existing optical infrastructure. Thus,
we assume the IP topology stays the same, yet the capacity of
IP links can be increased. The physical-layer topology formed by
active fiber segments can be expanded under the limit of deployed
(maybe inactive) fiber resources. Our goal is to minimize cost while
admitting the future traffic derived from Hose-based traffic forecast.
The ILP formulation is as follows. The optimization takes in
the current IP topology ğº and the expandable optical topology
ğº (cid:2) + Î”ğº (cid:2)
is the expansion budget offered by the dark
fibers. ğœ™ğ‘™ is the number of fibers on fiber segment ğ‘™ âˆˆ ğ¸ (cid:2) + Î”ğ¸ (cid:2)
that
will be lighted in the end, and ğœ†ğ‘’ is the target capacity on IP link
ğ‘’ âˆˆ ğ¸. Multiplying them with the respective cost as described in
Section 5.1, i.e., per-fiber turn-up cost ğ‘¦ (ğ‘™) and per-unit-bandwidth
capacity addition cost ğ‘§ (ğ‘’), we get the optimization objective of
minimizing the total cost of building the final network.
, where Î”ğº (cid:2)
min
s.t.


ğ‘¦ (ğ‘™) Ã— ğœ™ğ‘™ +
ğ‘§ (ğ‘’) Ã— ğœ†ğ‘’
ğ‘™ âˆˆğ¸(cid:2)+Î”ğ¸(cid:2)

ğ‘†ğ‘ğ‘’ğ‘ğ¶ğ‘œğ‘›ğ‘ ğ‘’ğ‘Ÿğ‘£ (ğº, ğº (cid:2) + Î”ğº (cid:2))
ğ‘’ âˆˆğ¸
ğ¹ğ‘™ğ‘œğ‘¤ğ¶ğ‘œğ‘›ğ‘ ğ‘’ğ‘Ÿğ‘£ (ğ‘€, ğº), âˆ€ğ‘ âˆˆ ğ‘„ğ‘œğ‘†
(10)
ğ‘€ âˆˆğ‘‡ğ‘,ğº âˆˆğºğ‘
ğœ†ğ‘’ â‰¥ Î›ğ‘’, âˆ€ğ‘’ âˆˆ ğ¸
ğœ™ğ‘™ â‰¥ Î¦ğ‘™ , âˆ€ğ‘™ âˆˆ ğ¸ (cid:2) + Î”ğ¸ (cid:2)
This objective is intrinsically equivalent to minimizing the addi-
tional cost of network expansion, because the sunk cost of building
the existing network has been paid for, but it simplifies the con-
straints. For example, the spectral conservation constraint described
in Section 5.1 is regarding the total IP capacity and total fiber counts.
554
The flow conservation constraint in Section 5.2 should also be sat-
isfied. Note that we need to consider this constraint for every QoS
class. Besides, we have additional constraints that ğœ†ğ‘’ and ğœ™ğ‘™ must be
greater than or equal to the current values Î›ğ‘’ and Î¦ğ‘™ in the existing
network, based on the fact that a network keeps growing: we do
not reduce IP capacity or disable optical fibers once a network has
been built.
5.4 Long-Term Planning
Long-term network planning targets at 2 to 5 years in the future.
The purpose of long-term planning is to estimate the worst-case
hardware requirements and make sure sufficient equipment is pro-
cured ahead of time. An important difference from short-term plan-
ning is long-term planning considers installation of new fibers. The