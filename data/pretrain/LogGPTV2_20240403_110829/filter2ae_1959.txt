# UAC简介
在完全启用用户帐户控制(UAC)的情况下，交互式管理员通常以最小的用户权限运行，但是他们可以通过使用Consent
UI提供显式准许来提升权限以执行管理任务。此类管理任务包括安装软件和驱动程序、更改系统范围的设置、查看或更改其他用户帐户以及运行管理工具。  
在以最小特权运行时，管理员称为受保护的管理员，除此之外，还有超级管理员。相比之下，标准用户不能自己提升权限，但他们可以要求管理员使用Credential
UI来提升他们的权限。内置管理员帐户不需要提升权限。
Contest UI，提升受保护的管理员从而获得管理权限。
Credential UI，用于提升标准用户权限。
# UAC的好处
它减少了以较高的权限运行的程序数量，因此有助于防止用户意外更改其系统设置，并有助于防止“恶意软件”获得系统范围的访问权限。拒绝提升权限，恶意软件只能影响当前用户的数据，并且恶意软件将无法进行系统范围的更改或影响其他用户。对于管理环境，设计良好的UAC体验允许用户在以标准用户身份运行时通过消除不必要的限制来提高工作效率。它使标准用户能够要求管理员授予他们在当前会话中执行管理任务的权限。对于家庭环境，它使家长能够更好地控制系统范围的变化，包括安装了什么软件。[1]  
与Windows Vista一样，受保护的管理员有权力决定是否收到有关所有系统更改的通知。UAC默认设置是通知所有管理员用户关于系统的更改。  
收到通知后，您的桌面将变暗，您必须在UAC对话框中批准或拒绝该请求，然后才能在计算机上执行任何其他操作。桌面变暗称为安全桌面，因为其他程序在变暗时无法运行。  
除了Windows Vista中的两个设置外，Windows
7还为受保护的管理员引入了两个中间UAC设置。第一种方法是仅在程序进行更改时通知用户，因此管理员在自己更改程序时会自动提升权限。这是Windows
7中的UAC默认设置，它还会使用安全桌面。  
Windows7中的第二个中间设置与第一个相同，只是它不使用安全桌面。
Windows7引入了两个中间UAC设置。
因此，简而言之，UAC是所有windows操作系统中存在的一个非常重要的功能，它将确保您的系统避免一些攻击，并且每次操作执行都要经过管理员权限的批准。[2]
# 击败Windows用户帐户控制
1.UACMe:   
2.系统要求：x86-32/x64 Windows
7/8/8.1/10(TH1/TH2/RS1/RS2/RS3/RS4)(客户端，但某些方法也适用于服务器版本)。  
3.需要UAC设置为默认的管理员帐户。  
第一个参数是要使用的方法数量，第二个参数是要运行的可选命令(可执行文件名，包括完整路径)。第二个参数可以是空的，在这种情况下，程序将从System32文件夹执行cmd.exe来提升权限。  
# 运行实例
akagi32.exe 1
akagi64.exe 3
akagi32 1 c:\windows\system32\calc.exe
akagi64 3 c:\windows\system32\charmap.exe
# Proof of Concept
**POC：1：Windows 7：64位：旗舰版 UAC绕过**  
用户名：Lucideus-TestUser
特权：标准用户
whoami命令的输出结果表明，我们只能使用有限的权限进入用户模式。
从命令行运行可执行文件：`akagi32 [Key] [Param]` 或 `akagi64 [Key]
[Param]`。有关更多信息，请参见下面的“运行示例”。
**POC 2：Windows 8.1 Pro**
在我们输入密码后，我们不会得到管理员特权。
您可以通过以下方式进行检查：-whami(cmd中输入)
从命令行运行可执行文件：`akagi32 [Key] [Param]`或`akagi64 [Key] [Param]`。
有关详细信息，请参阅下面的“运行示例”。
在Windows8.1专业版中与Windows7旗舰版相同。
在这里，我们也获得了管理特权，而不需要任何密码或任何特殊许可。
**POC 3 : Windows 10 Pro**
在我们输入密码后，我们无法获得管理员权限  
您可以通过以下方式检查： - whoami（cmd中输入）
如您所见，我们不是管理员
然后运行 ——> `akagi32 [Key] [Param]`或`akagi64 [Key] [Param]`
我们无需任何密码或任何特殊许可即可获得管理员特权。
解决方案：自定义规则集组策略编辑
# 组策略设置
可以为用户帐户控制(UAC)配置10个组策略设置。下表列出了每个策略设置的默认设置，以下各节解释了不同的UAC策略设置并提供了建议。这些策略设置位于“本地安全策略”管理单元中的“安全设置\本地策略\安全选项”中。有关修补相关内容的更多信息，请参阅以下链接：  
    本文链接：https://medium.com/@lucideus/privilege-escalation-on-windows-7-8-10-lucideus-research-c8a24aa55679