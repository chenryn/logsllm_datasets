outputs one type of semi-functional secret key depending
on the input type ∈ {1, 2, 3}.
. We call ˆ
⃗C1 = д⃗c (⃗s, ⃗h)
, ⃗R3←Z
ˆ
· д⃗c (
⃗s,
2
$← Z
m2
N
ˆ
⃗h)
.
m1
N
, ˆ
⃗s
N
Π0.SKX =
ˆ
ˆ
· д
⃗k (0,
⃗h,
⃗r )
2
ˆ
ˆ
· д
⃗k ( ˆα,
⃗h,
⃗r )
2
· д
⃗k ( ˆα,⃗0,⃗0)
2
· д
R3
3
· д
⃗R3
3
· д
⃗R3
3
⃗k (α, ⃗h,⃗r )
д
1
⃗k (α, ⃗h,⃗r )
д
1
⃗k (α, ⃗h,⃗r )
д
1
if
type = 1
if
if
type = 2
type = 3
SFRE-KeyGen(Π0.PK, Π0.SKX , Πi .Y , Πi .PK) → rkΠ0 .X→Πi .Y . Run
, then
(⃗k; m2) ← Enc1(Π0.X, N ), pick δ
compute
$← GT , ⃗r2
$← Z
m2
N
⃗rk =
type1
X
type2
X
type3
X
· д
⃗k (0, ⃗h,⃗r2)
1
· д
⃗k (0, ⃗h,⃗r2)
1
· д
⃗k (0, ⃗h,⃗r2)
1
(Π0.SK
(Π0.SK
(Π0.SK
Πi . ⃗C ← Πi .Enc(Πi .PK, Πi .Y , δ ).
)H (δ )
)H (δ )
)H (δ )
if
if
if
type = 1
type = 2
type = 3
Notably, here the type of ⃗rk depends on the type of input
Π0.SKX , and Π0.SK
means SKX is a type-i secret user
key.
typei
X
Proof Overview. Here we use a sequence of games, where each game
is defined as follows.
Gamer eal : This is the real game as defined in Section 3.1.
Gamer es : This game is nearly the same as Gamer eal , except that
is Rp2 (Π0.X , Π0.Y∗) = 0 rather
all attribute X queried to O0
than RN (Π0.X , Π0.Y∗) = 0.
K
Modify Π0.CT∗ ← SFEncrypt(Π0.Y∗, Mb, Π0.PK, д2, ˆ
⃗h).
Game0 : Run SFSetup(1λ, k ) in the setup phase.
Gamek : For those key queries and re-encryption key queries to
made by A , C answers the j-th query by generating the
O0
K
corresponding secret key as follows.
ˆαj ← ZN ,
SKXj ← SFKeyGen(Π0.Xj , Π0.MSK, Π0.PK, д2, 3, ˆαj ,⃗0,⃗0)
SFKeyGen(Π0.Xj , Π0.MSK, Π0.PK, д2, 3, ˆαj ,⃗0,⃗0)
KeyGen(Π0.Xj , Π0.MSK, Π0.PK)
j  k
$← M, and Π0.CT∗ ← SFEncrypt(Π0.Y∗,
Gamef inal : Modify M
M, Π0.PK, д2, ˆ
⃗h).
The proof structure is stated as follows.
Gr eal
Gr es
G0
· · ·
Gk−1
· · ·
· · ·
Gk
Gq1+q2
Gf inal
Semi-Functional Key Invariance in Our Proof. In fact, the proof
structure of our proof is similar as the proof in [2],but in our proof
the simulator needs to handle the simulation for the re-encryption
key query from Π0.Xk to Πi .Yk in each phase. As a result, the
original indistinguishability between Gamek−1 and Gamek does
not hold if we use the proof techniques as [2]. Besides, due to the
space limitation, we only give the proof of the indistinguishabil-
ity between these two games, which can be found in Appendix
A. We refer the reader to [2] for the other parts proof, where the
additional simulation for the re-encryption key queries is trivial. In
the following, we give the insight of proof of semi-functional key
invariance.
As mentioned above, the main difference between our proof and
the proof in [2] is that the adversary additionally has the ability to
make query about re-encryption key from Π0.Xk to Πi .Yk in each
phase. As a result, the indistinguishability between Gamek−1 and
Gamek may be compromised. To solve this problem, we further
divide the k-th query into one of the two cases, depending on
whether the key attribute Π0.Xk in the k-th re-encryption key query
can match the ciphertext attribute Π0.Y∗ in the challenge ciphertext.
We prove that in both cases, indistinguishability between Gamek−1
and Gamek holds.
• Case 1: R(Π0.Xk, Π0.Y∗) = 0. That is, secret key of attribute
Π0.Xj cannot decrypt the challenge ciphertext. Then the
security proof in this case is similar as the proof for the
adaptive security of an ABE scheme. Since the simulator in an
ABE scheme can generate all keys which cannot decrypt the
challenge ciphertext, it can also simulate the corresponding
re-encryption key.
• Case 2: R(Π0.Xk, Π0.Y∗) = 1. In this case, secret key of at-
tribute Π0.Xj can decrypt the challenge ciphertext. Addi-
tional technique is required to answer a re-encryption key
query since simulator of an ABE scheme cannot generate
the keys which can decrypt the challenge ciphertext. We
leverage the fact that the simulator is not giving away this
kind of keys in plain. Rather, it is masked by δ. which is
encrypted in the target cryptosystem. The chosen-plaintext
security of the target scheme can guarantee that δ is indistin-
guishable from a randomly and uniformly distributed value.
Session 16: Applied Crypto 2ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea667The crucial point in the proof is that we need to prove a re-
encryption key in which the secret key can decrypt the chal-
lenge ciphertext is indistinguishable from a re-encryption
key whose underlying secret key cannot decrypt the chal-
lenge ciphertext. In this way, simulator of PREs can simulate
this case.
Remark 4.1. We remark that when target PKE scheme Π has an
enhanced security guarantee, e.g., leakage-resilience or relate-key
attack resilience etc., the security of the resulting scheme can also be
boosted (i.e. the CS-PRE will be resilient to the side-channel attacks
or the related-key attacks to some extend). We refer the readers to
the full version of this paper for a more detailed discussion on how to
define CS-PRE with enhanced security and how to prove the enhanced
security.
5 DISCUSSION
Compared with composite-order groups, schemes in prime-order
groups are preferable since they are more efficient. Recently, Chen et
al. present two types of techniques [12, 13] for simulating composite-
order groups in prime-order groups. Via their methods, many fully
secure ABE schemes in prime-order groups ([3, 12, 13]) have been
presented. However, for the sake of efficiency and conciseness, only
those essential properties of composite order groups are simulated.
Therefore, their techniques are not applicable to our framework.
To see this, recall that in these techniques, the encoding parts,
namely, the key encoding and the ciphertext encoding, are dupli-
cated multiple times to simulate those properties of composite order
groups, and in the decryption algorithm, intermediate results for
all pairs of key encoding and ciphertext encoding will be summed
up to recover the mask of the plaintext. These techniques, how-
ever, cannot be directly applied to our construction. Specifically, in
our re-encryption algorithm, the re-encryption key is used to par-
tially decrypt the ciphertext and that different intermediate results
will be masked with different randomness and therefore cannot
be summed up to recover the mask. Hence, we need to seek for
new technique to construct attribute-based proxy re-encryption
schemes in prime-order groups and leave this as an open problem.
Acknowledgement. We appreciate the anonymous reviewers
for their valuable suggestions. Part of this work was supported
by the National Natural Science Foundation of China (Grant No.
61602396, U1636205, 61572294, 61632020). The work of Junzuo Lai
was supported by the National Natural Science Foundation of China
(Grant No. 61572235), and Guangdong Natural Science Funds for
Distinguished Young Scholar (No. 2015A030306045).
REFERENCES
[1] G. Ateniese, K. Fu, M. Green, and S. Hohenberger. Improved proxy re-encryption
schemes with applications to secure distributed storage. ACM Transactions on
Information and System Security (TISSEC), 9(1):1–30, 2006.
[2] N. Attrapadung. Dual system encryption via doubly selective security: Frame-
work, fully secure functional encryption for regular languages, and more. In
Advances in Cryptology–EUROCRYPT 2014, pages 557–577. Springer, 2014.
IACR Cryptology ePrint Archive, 2015:390, 2015.
[4] N. Attrapadung and B. Libert. Functional encryption for inner product: Achieving
constant-size ciphertexts with adaptive security or support for negation. In Public
Key Cryptography–PKC 2010, pages 384–402. Springer, 2010.
[3] N. Attrapadung. Dual system encryption framework in prime-order groups.
[5] M. Backes, M. Gagné, and S. A. K. Thyagarajan. Fully secure inner-product proxy
re-encryption with constant size ciphertext. In Proceedings of the 3rd International
Workshop on Security in Cloud Computing, pages 31–40. ACM, 2015.
[6] M. Blaze, G. Bleumer, and M. Strauss. Divertible protocols and atomic proxy
cryptography. In Advances in Cryptology-ï£¡ï£¡EUROCRYPT’98, pages 127–144.
Springer, 1998.
[7] J. Blömer and G. Liske. Construction of fully cca-secure predicate encryptions
from pair encoding schemes. In CryptographersâĂŹ Track at the RSA Conference,
pages 431–447. Springer, 2016.
[8] D. Boneh, E.-J. Goh, and K. Nissim. Evaluating 2-dnf formulas on ciphertexts. In
Theory of cryptography, pages 325–341. Springer, 2005.
[9] X. Boyen and B. Waters. Anonymous hierarchical identity-based encryption
(without random oracles). In Advances in Cryptology-CRYPTO 2006, pages 290–
307. Springer, 2006.
[10] R. Canetti, O. Goldreich, and S. Halevi. The random oracle methodology, revisited.
[19] C. Gentry and S. Halevi. Hierarchical identity based encryption with polynomially
[20] M. Green and G. Ateniese.
Journal of the ACM (JACM), 51(4):557–594, 2004.
[11] R. Canetti and S. Hohenberger. Chosen-ciphertext secure proxy re-encryption. In
Proceedings of the 14th ACM conference on Computer and communications security,
pages 185–194. ACM, 2007.
[12] J. Chen, R. Gay, and H. Wee. Improved dual system abe in prime-order groups
via predicate encodings. In Annual International Conference on the Theory and
Applications of Cryptographic Techniques, pages 595–624. Springer, 2015.
[13] J. Chen and H. Wee. Fully,(almost) tightly secure ibe and dual system groups. In
Advances in Cryptology–CRYPTO 2013, pages 435–460. Springer, 2013.
oracles.
Springer, 2007.
[14] C.-K. Chu and W.-G. Tzeng. Identity-based proxy re-encryption without random
In International Conference on Information Security, pages 189–202.
[15] R. Cramer and V. Shoup. Design and analysis of practical public-key encryption
schemes secure against adaptive chosen ciphertext attack. SIAM Journal on
Computing, 33(1):167–226, 2003.
[16] H. Deng, Q. Wu, B. Qin, W. Susilo, J. K. Liu, and W. Shi. Asymmetric cross-
cryptosystem re-encryption applicable to efficient and secure mobile access to
outsourced data. In F. Bao, S. Miller, J. Zhou, and G. Ahn, editors, Proceedings of
the 10th ACM Symposium on Information, Computer and Communications Security,
ASIA CCS ’15, Singapore, April 14-17, 2015, pages 393–404. ACM, 2015.
[17] T. ElGamal. A public key cryptosystem and a signature scheme based on discrete
logarithms. In Advances in cryptology, pages 10–18. Springer, 1984.
[18] K. Emura, A. Miyaji, and K. Omote. An identity-based proxy re-encryption
scheme with source hiding property, and its application to a mailing-list system.
In European Public Key Infrastructure Workshop, pages 77–92. Springer, 2010.
many levels. In TCC, volume 5444, pages 437–456. Springer, 2009.
Identity-based proxy re-encryption.
Cryptography and Network Security, pages 288–306. Springer, 2007.
ciphertexts. In USENIX Security Symposium, volume 2011, 2011.
ePrint Archive: Report 2011/389, 2011.
In Applied
[21] M. Green, S. Hohenberger, B. Waters, et al. Outsourcing the decryption of abe
[22] M. Hamburg. Spatial encryption (ph. d. thesis). Technical report, Cryptology
[23] A.-A. Ivan and Y. Dodis. Proxy cryptography revisited. In NDSS, 2003.
[24] S. Jahid, P. Mittal, and N. Borisov. Easier: Encryption-based access control in social
networks with efficient revocation. In Proceedings of the 6th ACM Symposium on
Information, Computer and Communications Security, pages 411–415. ACM, 2011.
[25] A. Lewko, T. Okamoto, A. Sahai, K. Takashima, and B. Waters. Fully secure func-
tional encryption: Attribute-based encryption and (hierarchical) inner product
encryption. In Advances in Cryptology–EUROCRYPT 2010, pages 62–91. Springer,
2010.
[26] A. Lewko and B. Waters. New techniques for dual system encryption and fully
secure hibe with short ciphertexts. In Theory of Cryptography, pages 455–479.
Springer, 2010.
[27] A. Lewko and B. Waters. Unbounded hibe and attribute-based encryption. In
Advances in Cryptology–EUROCRYPT 2011, pages 547–567. Springer, 2011.
[28] A. Lewko and B. Waters. New proof methods for attribute-based encryption:
Achieving full security through selective techniques. In Advances in Cryptology–
CRYPTO 2012, pages 180–198. Springer, 2012.
[29] K. Liang, M. H. Au, J. K. Liu, W. Susilo, D. S. Wong, G. Yang, T. V. X. Phuong, and
Q. Xie. A dfa-based functional proxy re-encryption scheme for secure public
cloud data sharing.
IEEE Transactions on Information Forensics and Security,
9(10):1667–1680, 2014.
[30] K. Liang, M. H. Au, J. K. Liu, W. Susilo, D. S. Wong, G. Yang, Y. Yu, and A. Yang.
A secure and efficient ciphertext-policy attribute-based proxy re-encryption for
cloud data sharing. Future Generation Computer Systems, 52:95–108, 2015.
[31] X. Liang, Z. Cao, H. Lin, and J. Shao. Attribute based proxy re-encryption with
delegating capabilities.
In Proceedings of the 4th International Symposium on
Information, Computer, and Communications Security, pages 276–286. ACM, 2009.
[32] B. Libert and D. Vergnaud. Unidirectional chosen-ciphertext secure proxy re-
In Public Key Cryptography–PKC 2008, pages 360–379. Springer,
encryption.
2008.
Session 16: Applied Crypto 2ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea668[33] Q. Liu, G. Wang, and J. Wu. Time-based proxy re-encryption scheme for secure
data sharing in a cloud environment. Information Sciences, 258:355–370, 2014.
[34] T. Matsuda, R. Nishimaki, and K. Tanaka. Cca proxy re-encryption without
bilinear maps in the standard model. In International Workshop on Public Key
Cryptography, pages 261–278. Springer, 2010.
[35] T. Matsuo. Proxy re-encryption systems for identity-based encryption. In Pairing-
Based Cryptography–Pairing 2007, pages 247–267. Springer, 2007.
[36] T. Mizuno and H. Doi. Hybrid proxy re-encryption scheme for attribute-based
encryption. In Information security and cryptology, pages 288–302. Springer, 2009.
[37] T. Okamoto and K. Takashima. Fully secure functional encryption with general
relations from the decisional linear assumption.
In Advances in Cryptology–
CRYPTO 2010, pages 191–208. Springer, 2010.
[38] T. Okamoto and K. Takashima. Adaptively attribute-hiding (hierarchical) inner
product encryption. In Advances in Cryptology–EUROCRYPT 2012, pages 591–608.
Springer, 2012.
[39] R. L. Rivest, A. Shamir, and L. Adleman. A method for obtaining digital signatures
and public-key cryptosystems. Communications of the ACM, 21(2):120–126, 1978.