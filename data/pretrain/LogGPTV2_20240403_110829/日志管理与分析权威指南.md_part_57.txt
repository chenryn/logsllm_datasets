意日志保护的两个重点：访问控制（保持日志机密性）和完整性保护（保持日志完整性）。大
信息保护”中规定“日志记录设施和日志信息应该得到保护，免遭篡改和未授权访问。”注
以及审核和分析一还可能有实时警报。
合理的基础，不会缺乏或者过度控制。有趣的是，“IVO设备连接/断开”明确地成为监控目标。
能进行）。
操作规程必须包含定期或者实时日志审核工作流。这种审核由应用程序管理员或者安全管理
ISO还暗示着这些策略和规程的持续审核。例如，对于ISO项目范围内的系统和应用程序，
19.4
人员都有效。
将法定操作限制在授权人员上。在此基础上，系统还采用加密机制进行完整性检查，检测任
ISO27002建议“单独设施的监控级别应该通过风险评估确定”，这为安全监控活动提供了
下一小节A.10.10.2“监控系统使用”中明确强制规定“应该建立监控信息处理设施使用
ISO27001包含了加固日志，使之免遭未授权修改和查看的主题。A.10.10.3小节“日志
除此之外，组织必须监控“日志文件媒体的存储容量超限，造成记录事件的失败或者覆
总体来说，这些关键控制要求创建一个日志记录策略，定义日志记录、日志收集和留存
1996年的《The Health Insurance Portability and AccountabilityAct》（HIPAA）概述了健
和PCIDSS一样，日志定时对于安全监控、取证和故障排除都很重要。确保所有收集和
最后，ISOA.10.10.6小节“时钟同步”规定“组织或者安全域内所有相关信息处理系统
HIPAA
第19章日志和依从性271
---
## Page 293
272
和专业性的小型商店。模糊的原则不能帮助组织积极地进行日志记录和日志审核。在此基础
发点。日志需求对某些公司来说可能很难，例如部署了复杂系统的组织或者缺乏时间、资金
程的角度看都是如此。
EventSourceNewsletters-Junel0.php)。"
虑符合两种法规的技术和管理控制是谨慎的做法，在短期和长期来说都能够节约金钱。
用性的范围可能不同，因为支付处理系统不应该保存患者的健康信息，反之亦然。然而，
受支付卡的保险公司和许多医院要同时遵守HIPAA和PCIDSS。可以理解，不同组织中，
所影响的组织，也称为“涵盖实体”，遵循法规的精神和非其文字。还要注意的一点是，
（2009年HITECH法案）。
过加强HIPAA规则的民事和刑事执行，部分解决与健康信息传输相关的隐私和安全忧虑。
HealthAct》（HITECH法案）。该法案寻求“促进健康信息技术的采用和有意义的使用”和“通
EPHI））和隐私规则（2.1节，包括所有受保护的健康信息（ProtectedHealth Information，PHI)）。
上，日志记录和日志审核的复杂性在环境中有定制应用程序（而不仅仅是Windows服务器或
含安全规则（2.3节，包括“受保护的电子健康信息”（ElectronicProtectedHealthInformation，
HIPAA最新的增强版本称为《HealthInformationTechnologyforEconomicandClinical
上面的条款说明，和PCIDSS相比，HIPAA中的日志记录和监控要求本身不能真正地
和PCIDSS不同，HIPAA本身没有涉及安全控制级别和所采用的技术。这要求HIPAA
HIPAA中的其他需求也可能影响日志记录（来源：http://www.prismmicrosys.com/
特别是，该法的第2条（TitleⅡ）“避免保健欺诈和违规；管理简化；医疗责任改革”包
由于这种情况，我们往往注意到，HIPPA日志收集和审核成为了各种规模组织的错误多
特别是，下面的问题没有答案：
■164.312小节（b）“审计控制”广泛涵盖了审计日志记录和处理敏感健康信息的系统上
下面的HIPAA需求广泛适用于日志记录、日志审核和安全监控：
■如何保护审计记录？
“审计控制”应该记录哪些信息？哪些活动和事件？每个活动或者事件的哪些细节？
志、系统利用率报告、事故报告和其他安全相关活动的指示。
应该如何执行安全监控和“登录监控”？
应该审核哪些特殊“活动”？审核的频率如何？
日志记录是否应该集中收集？
的其他审计跟踪。这条需求隐含了这些审计日志的审核。
这一需求适用于失败和成功的“登录企图”。
日志应该留存多久？
一从技术和策略/规
考
接
实
---
## Page 294
PCIDSS进行了审核，它们就可以进行扩展，以覆盖HIPAA系统。
访问报告和安全事故跟踪报告”（日志审核)。虽然每天日志审核不是必需的，但是如果为了
PCIDSS原则。而且，这一过程将创建规程，“定期审核信息系统活动的记录，如审计日志
统上创建日志记录，并且有足够的细节（日志记录）。顺便说一句，这些细节可以借鉴对应的
异常监控过程等。
的问题，人们可以规划这些策略的范围：需求适用性、记录的活动和记录细节、审核规程、
是否被视作“文档”的讨论留给实施者。
有真正解决关键的实施问题，换言之，它没有告诉涵盖实体必须怎么做才能实现依从性。
“审计日志应该包含哪些内容？”（例如，用户ID，事件类型／日期/时间），但是这一文档并没
题，如“监控哪些活动？”（例如，包含EPHI的文件或者记录的创建、读取、更新和删除）和
计信息保存在哪里？（例如单独的服务器）”）而不是提供答案。
Health InsurancePortability and AccountabilityAct（HIPAA）SecurityRule》，见http://csrc.nist.
应用，还是适用于底层平台？（来源：http://www.prismmicrosys.com/EventSourceNewsletters-
全规则）的指南。
施的附加细节。
June10.php)。
存在自制的应用程序中，在这些应用中，日志记录的配置就像是噩梦。
者Cisco防火墙）时显著上升。尽管趋势是远离传统和定制应用程序，
NISTSP800-66提供了加固受保护的电子健康信息的详细日志管理需求（根据HIPAA安
除了上述问题之外，还有一个问题不清晰：这些控制适用于处理敏感健康数据的实际
而且，4.22小节指出，操作和活动文档必须留存至少6年，并将安全活动记录（如日志）
NIST800-66的4.1小节描述了信息系统活动定期审核的需求，例如审计日志、信息和
幸运的是，NIST出版物800-66《AnIntroductoryResourceGuide forImplementing the
推荐的策略建议，公司从信息安全活动审核策略和过程人手。使用NST800-66中提出
4.15小节试图提供“审计控制”的附加指导。虽然力求提供方法和实施者需要询问的问
对此，NIST800-66建议：
接下来，组织必须真正地为日志记录和日志审核实施上述过程。这能够确保在覆盖的系
■审核信息保存在哪里（例如单独的服务器）？
■组织对员工违规有何约束政策？
■审核结果分析的频率多高？
■审核进行的频率多高？
■谁负责总体过程和结果？
下面的内容引自NIST800-66：
，许多医疗数据仍然保
第19章日志和依从性273
---
## Page 295
274
不同，因为支付处理系统不应该保存患者的健康信息，反之亦然。然而，
公司和许多医院要同时遵守HIPAA和PCIDSS。可以理解，不同组织中，适用性的范围可能
组织（也称作涵盖实体）遵循法规的精神而非文字。还要注意的一点是，接受支付卡的保险
意的是，许多遗留应用程序往往没有记录足够的事件细节，甚至完全忽略事件日志的记录。
据库中，由保健专用应用程序处理，如专业供应商制作或者内部开发（通过外包开发人员）
的技术和管理控制是谨慎的做法，在短期和长期来说都能够节约金钱。
分子能够窃取我们最敏感的数据。
才会采取行动。对日志记录的这种短视的方法只会走到“坏孩子“的那一边，使得网络犯罪
证据时，能够证明是可靠的（来源：http://www.prismmicrosys.com/EventSourceNewsletters-
志可以集中起来供分析和留存。最后，它们不应该降低系统的速度，而且，如果用作取证的
中，可能无法联系到这些开发人员，安全团队必须自已推进工作。从日志管理的角度看，日
全需求和NIST800-66HIPAA说明。
有的日志记录级别及方法很有意义。
因此，在启动这种项目之前，确定组织中的哪些应用程序包含受保护的健康信息（PHI）和现
充足的日志记录。现有应用程序的日志记录需要评估，看看是否有充足的日志记录，应该注
的应用程序。
遵循规章的精神而不仅仅是文字。可以理解，一些组织可能要等到经受处罚和强制活动之后
July10.php)。
们的应用程序的情况下进行分析，也肯定不需要该应用程序的开发人员。在保健应用程序
人。这样的日志适合于人工、半自动和自动化分析。理想状况下，它们可以在不包含生成它
日志记录，甚至比平台日志记录有过之而无不及。这意味着，定制应用程序需要设计为具备
和平台日志记录相比，HIPAA164.312小节（b）中提及的审计控制同样适用于应用程序
而且，HIPAA本身没有规定实施的安全控制和技术的级别。这要求受到HIPAA影响的
我们来定义一些原则，指明需要记录哪些日志，才能从精神上和字面上满足HIPAA安
粗略地讲，最好的审计日志告诉你发生了什么，包括何时、何地和如何，以及涉及的
虽然平台级别的日志记录对于保护敏感的健康信息很有用，且大部分健康信息存储在数
这里需要两个主要定义：
虽然HIPAA没有提供日志记录和日志管理的详细指南，但是为公司提供了一个机会，
■首先，有些类型的活动或者事件总是必须记录。例如，身份认证决策、健康信息访问
这时，组织才做好准备进入下一步，启动日志记录并开始持续的日志审核。
■监控报告在哪里归档和维护？”
■确定审计跟踪数据的类型和驱动意常报告所需的监控规程。
■“开发相应的标准操作规程。
■
异常报告或者日志如何审核？
和系统变更总是应该出现在日志中。
，考虑符合两种法规
---
## Page 296
制数据访问的组件，就需要记录。此外，我们需要记录有关健康信息系统的关键事件，因为
未来对保健数据的访问。例如，如果有人关闭日志记录，或者在系统中添加了可能启用无限
身的所有访问。
改或者删除信息。如果我们无法记录对每部分数据的访问，就需要谨慎地记录对应用程序本
更改或者删除信息。但是这并不是全部—我们还需要注意谁试图（但是失败了）读取、更
康信息本身应该排除在日志之外。
不应该出现在日志中（遗憾的是，这有时仍然发生在Web应用程序中)。同样明显的是，健
这些事件可能为未授权访问提供间接证据。
接下来，我们需要知道谁在系统上执行了处理健康信息的操作，因为这些活动可能影响
很明显，我们需要知道谁、什么时候、为什么访问健康信息。我们还需要知道谁添加、
我们应该记录哪些事件？选择日志事件的总体主题是什么？
还应该注意，某些细节绝不应该记录。这样的例子显而易见：应用程序或者系统密码绝
下面的列表提供上述准则的结构化视图
■其次，对于每类记录事件，为了解读它们（由人工或者自动化系统进行），有些特定细
■
■
身份认证，授权，访问：
节是必备的。例如，每个日志应该有可靠的时间戳，每个与用户活动相关的日志应该
包含用户名。
■无效输人，其他可能的应用程序违规使用。
“坏事”／威胁：
■系统、应用程序和应用程序模块/组件的启动和关闭。
可用性问题：
■系统/应用程序变更（尤其是特权变更)。
恶意软件检测事件。
■备份成功及失败(影响可用性)。
■敏感数据更改、添加和删除。
■数据变更(创建和销毁也是变更)。
变更：
■身份认证/授权决策，成功和失败一
■古
远程访问。
故障和错误，特别是影响应用程序可用性的错误。
应用程序和组件安装及更新、删除。
对应用程序的网络访问，包括分布式环境中从一个应用程序组件到另一个组件的
系统访问、数据访问、应用程序组件访问。
从一个用户账户切换到另一个。
记录用户注销，这对于知道何时用户不再有权访问应用程序也很重要。
一特别是特权身份认证。
第19章日志和依从性275
---
## Page 297
276
全性，包括由其他机构、承包商或者其他来源提供或者管理的信息。”
开发、登记文档和实施机构范围内的计划，为支持机构运营及资产的信息和信息系统提供安
（来源：http://www.prismmicrosys.com/EventSourceNewsletters-July10.php）。
作系统的基础设施日志记录不能用于检测和调查对EPHI的应用程序级威胁。安全团队（最
代Windows版本中所使用的模式。在这种情况下，安全监控工具可以请求订阅特定的日志事
中化之王，但是现代的跨平台应用程序框架要求对日志传输使用发布/订阅模式，类似于现
组件的分布式日志分析来说是不可或缺的。虽然syslog因其简单的UDP传输而成为日志集
在此我们使用如下的总体主题：
记录策略，不需要太多额外的工作。
遍应用可能需要几年的时间。在全球性标准没有出台之前，组织应该快速构建并使用自己的
终负责日志审核）需要指导开发人员建立实用和高效的日志记录，用于监控和调查性活动。
式及基于云的应用程序之间敏感信息的移动，要求我们将应用程序日志记录置于控制之下。
应用程序复杂度的增长，日志记录的重要性只会越来越高。特别是，分析应用程序行为和分布
是上述列表可以为相关的应用程序提供一个有用的出发点。它可以转换为你的应用程序日志
19.5
应用程序日志记录标准。HIPAA依从性为创建和采用这样的日志记录标准提供了很好的动机