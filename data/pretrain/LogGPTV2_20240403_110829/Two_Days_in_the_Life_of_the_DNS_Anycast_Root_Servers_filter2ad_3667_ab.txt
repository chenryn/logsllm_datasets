and the third row is for C-root. To conserve space the legend overlaps some bars, but
the bar color does not change within the overlapped area.
The non-monotonically increasing curves in Fig. 2(b) indicate that the number
of requests to a server can be disproportional to the number of clients it serves.
Classiﬁcation of users as “heavy” and “light” and a detailed analysis of their
behavior patterns is a subject of future research.
4 Anycast Coverage
4.1 Client Geographic Distribution
To discover the geographic distribution of each instance’s clients, we map the
client IP addresses to their geographic locations (country and continent) and co-
ordinates (latitude and longitude) using Digital Envoy’s NetAcuity database [10].
The database claims accuracy rates over 99% at the country level and 94% at
the city level worldwide.
C and F-root instances are named using their corresponding airport codes,
e.g. f-lax1 denotes the F-root instance at Los Angeles, while K-root instances are
named either after the exchange points that support them, or their city name.
Therefore, for the root server instance locations we use the coordinates of the
closest airport. We then compute the geographic distance between instances and
their clients as the great circle distance.
130
Z. Liu et al.
100
80
60
40
20
%
0
0  
100
80
60
%
40
20
0
0
%
100
80
60
40
20
0
0
Local
All
Global
5000
10000
Distance (km)
15000
20000
(b) F-root
Local
All
Global
5000
10000
Distance (km)
15000
20000
(c) K-root
All
5000
10000 
Distance (km)
15000
20000
(a) C-root
Fig. 4. CDF of the distance from root nameservers to their clients
Continental Distribution. Distribution of clients by continents for each mea-
sured instance is shown in Fig. 3. Comparing clients of local and global instances
we notice that clients of most global instances are indeed distributed worldwide.
For example, the K-root global instance linx located at London had only 28.6%
of its total clients from Europe. Others were from: North America 40%, South
America 3.7%, Africa 1.6%, Asia 24.3%, and Oceania 1.8%. Most of the local
instances were serving clients from the continent they are located in. For ex-
ample, nearly all the clients of the F-root local instance at Santiago, Chile are
from South America. Such a constrained geographical distribution is consistent
with the goal of DNS anycast deployment: to provide DNS root service closer to
clients.
There are exceptions among both global and local instances. Over 99.7% of
K-root’s tokyo instance were from Asia. Furthermore, 75% of its clients were
less than 1000 km away, i.e. mostly in Japan. Hence, this instance behaves more
like a local instance rather than a global one. The previously mentioned F-root
local instance lax1 at Los Angeles, US (the 4th bar from the left, not to be
confused with the C-root global instance lax1* which has the same code name)
has 88% of its clients from Asia, and only 10% from North America, which
explains its irregular diurnal pattern in Fig. 1. Such abnormal client distribu-
tions result from the instances’ BGP routing conﬁgurations, which we discuss in
Section 4.2.
Distance Distribution. We also study the distance from root server instances
to their clients. Fig. 4 plots, for each root server, a CDF for its local instances,
its global instances, and all its instances combined Only one curve is given for
the C-root instances since they are all global.
Fig. 4 shows that the majority of the local instances were serving clients who
are geographically close to them – 80% of the F-root local instances’ clients
and 70% of the K-root local instances’ clients were within 1800 km. Distances
between the global instances and their clients are generally longer, e.g. for
C-root, over 60% of the clients were beyond 5000 km, and F- and K-root both
had 40% of their clients beyond 5000 km. The F and K roots had lower pro-
portions of clients who were far away from their servers because these anycast
groups include multiple local instances all over the world while the C-root group
currently has only 4 instances and they are all global.
Two Days in the Life of the DNS Anycast Root Servers
131
%
100
90
80
70
60
50
40
30
20
0  
C−root
K−root
F−root
5000
10000
15000
20000
Additional Distance (km)
Fig. 5. CDF of additional distance travelled by requests to instances
Flat segments in the CDF curves (around 5000 km for the C and K roots, and
the especially prominent one from 5000 to 8000 km for the F-root) approximately
correspond to the distances across the Atlantic Ocean (from North America
to Europe) and the Paciﬁc Ocean (from North America to Asia), respectively.
Obviously, fewer clients are found in the ocean areas.
Additional Distance. We wanted to investigate whether the BGP always
chooses the instance with the lowest delay. For this analysis, we use the geo-
graphic proximity as a proxy for latency. A comprehensive study [6] shows that
geographic distance usually correlates well with minimum network delay. Later
studies [11,12] also used geographic distance to compute network delay.
For a given client, we deﬁne the serving instance as the instance the client ac-
tually uses, and the optimal instance as the geographically closest instance from
the same anycast group. We ignore the tiny number of clients that sent requests
to more than one instance. (see Section 4.3 below). We then deﬁne the client’s ad-
ditional distance as the distance to its serving instance minus the distance to its
optimal instance. An additional distance of zero indicates that the client queried
an optimal instance while a positive value suggests a possible improvement.
Analyzing the CDF of the additional distance (Fig. 5), we saw that 52% of C-
root’s clients were served by their optimal C-root instance, and another 40% had
short additional distances. This optimised selection is due to the ﬂat topology
of the C-root anycast group, i.e., all instances are global. In contrast, only 35%
of F-root’s clients and only 29% of the K-root’s clients were served by their
optimal instances. Given that the speed of light in ﬁber is about 2 × 108m/s,
an additional 5000 km of geographical distance adds a 25 ms delay. Our results
imply that a signiﬁcant number of clients would beneﬁt if routing conﬁgurations
of their local DNS root instances were optimized to route these clients to their
optimal instance, thereby reducing their DNS service delay.
4.2 Topological Coverage
We studied the topological coverage of the Internet by anycast clouds of the C,
F, and K root nameservers. Using the RouteViews BGP tables [13] collected on
10 Jan 2006, we mapped each client IP address in our data to its corresponding
132
Z. Liu et al.
%
70
60
50
40
30
20
10
0
0
iad1*
pao1*
C−root
F−root
K−root
linx*
ams−ix* 
%
lax*
ord*
jfk*
sfo2*
nap*
ams1 
muc1 
lga1 
delhi*
denic
tokyo*
10
20
30
Instance
40
50
60
(a) AS level
70
60
50
40
30
20
10
iad1*
lax1*
ord1*
jfk1*
0
0
10
20
C−root
F−root
K−root
linx* 
ams−ix* 
nap* 
delhi*
denic
tokyo*
50
60
pao1*
sfo2* 
lga1 
ams1 
muc1 
40
30
Instance
(b) Preﬁx level
Fig. 6. Topological scope of the instances. The x-axis instance order is the same
in (a) and (b). The instances are plotted in groups for C, F and K roots; within each
group they are arranged in an increasing AS coverage percentage order. The percentage
shown for of each instance is the number of ASes/preﬁxes seen by the given instance
divided by the total number of ASes/preﬁxes seen by all three roots combined.
preﬁx by longest matching, and so determined its origin AS. Out of 21883 ASes
seen in RouteViews tables on that day, we observed IP addresses belonging to
19237 ASes (∼88%) among our clients.
Fig. 6 shows both the AS-level and preﬁx-level coverage for each instance
relative to the total number of ASes (preﬁxes) seen by all instances of the three
root nameservers. As expected, most of the global instances have much higher
topology coverage than the local instances.
Two exceptions are: (1) the K-root local instance denic in Frankfurt, Ger-
many had a wider topological scope than any other local instances; (2) the
K-root global instance tokyo saw a rather small fraction of ASes and preﬁxes.
Such exceptions can be explained by RouteViews BGP data.
Knowing the IP address of the K-root anycast service supernet and using
the AS peering information published at the root server website [14], we ex-
tracted the AS paths to each of its instances. One of the three observed AS paths
to denic is 12956 8763 25152. According to the RIPE-NCC whois database,
AS12956, belongs to Telefonica, which has a global network infrastructure. The
presence of this path explains why denic has a high topological coverage, and,
correspondingly, a high traﬃc load and a large number of clients (cf. Fig. 2).
Considering the K-root instance tokyo, we note that the global instances used
AS-path prepending to intentionally lengthen their paths. This instance announced
a triple AS-prepended path, i.e. 4713 25152 25152 25152 25152 which was the
longest among all of the ﬁve K-root global instances. Such a long AS path caused
tokyo to be seldom chosen by BGP for global clients who sent queries to the K-root
server. Therefore, the clients of tokyo were mostly local (cf. Fig. 3).
Finally, we saw in Section 4.1 that the F-root local instance lax1 had most
of its clients coming from Asia. One of the three AS paths we observe to this
instance was: 7660 2516 27318 3557, where AS7660 and AS2516 are in Japan
thus explaining the source of the Asian clients.
Two Days in the Life of the DNS Anycast Root Servers
133
%
5
4
3
2
1
0
C−root
F−root
K−root
10M
1M
100K
s
t
n
e
i
l
c
#
10K
1K
100
10
1
1
C−root
F−root
K−root
2
# instances requested by clients
3
4
5
(a) Percentage of the clients switching
instances
(b) # clients (log scale) vs # instances
queried within same anycast group
Fig. 7. Instance switching within the same anycast group
4.3 Instance Aﬃnity
Anycast improves stability by shortening AS paths, thus decreasing the num-
ber of possible failure points. However, this enhancement comes at the cost of
increased chance of inconsistency among instances [2] and of clients’ transpar-
ent shifting to diﬀerent instances. As long as DNS traﬃc is dominated by UDP
packets, this route ﬂapping is unimportant, but it may pose a serious problem
if stateful transactions such as TCP or multiple fragmented UDP packets be-
come more prominent [15]. Fortunately, recent studies [9,16,17] suggest that the
impact of routing switches on the query performance is rather minimal.
We observed that a small fraction of clients did switch instances during the
two days: 1.7% of the C-root clients, 1.4% of the F-root clients, and 4.7% of the
K-root clients (Fig. 7(a)). These percentages correlate with the number of global
instances each root server has (4 for C-root, 2 for F-root, and 5 for K-root), since
the clients of a global instance are more easily aﬀected by routing ﬂuctuations.
Actually, the two F-root global instances together saw approximately 99.8%
of the total clients who switched F-root instances, and the ﬁve K-root global
instances together saw 86% of the total clients who switched K-root instances.
Fig. 7(b) shows how many clients queried how many instances. Focusing on
the clients who used the most instances, we found that the two C-root clients
who requested four instances were from Brazil and Bolivia and the three K-root
clients who requested ﬁve instances were all from Uruguay. Note that neither
the C-root nor the K-root had an instance in South America. For F-root, the
27 clients who requested four instances were all from the UK where the F-root
has a local instance lcy1, but the catchment area of this instance was limited.
Actually, those 27 clients never requested from lcy1, but switched between ams1,
lga1, pao1, and sfo2. A detailed analysis of unstable clients could help network
designers decide where to place new instances.
5 Conclusion
From the diurnal patterns of request rates and from the observed geographic clus-
tering of clients around instances we conclude that the current method for limiting
134
Z. Liu et al.
the catchment areas of local instances appears to be generally successful. A few ex-
ceptions, such as the F-root local instance lax1 or the K-root local instance denic,
drew their clients from further away regions due to peculiar routing conﬁgurations.
Instance selection by BGP is highly stable. Over a two-day period less than
2% of both C-root and F-root clients and <5% of K-root clients experienced an
instance change. Since UDP connections are stateless, the vast majority of clients
would not be harmed by such changes, apart from the unavoidable delay created
by BGP convergence. Although the instance ﬂapping could be problematic to
TCP’s stateful connections [15], in our data sample TCP packets constituted
only 3.2% of all DNS root packets.
Overall, the transition to anycasting by the DNS root nameservers not only
extended the origial design limit of 13 DNS roots, but it also provides increased
capacity and resilience, thereby improving DNS service worldwide.
Acknowledgements. We thank ISC, RIPE, and Cogent for collecting the
datasets used in this study. P. Vixie, K. Mitch, and B. Watson of ISC helped
with data storage and answered questions on F-root’s anycast deployment. A.
Robachevsky and C. Coltekin from RIPE provided feedback on K-root’s anycast
deployment. This work was supported by NSF Grant OCI-0427144.
References
1. Mockapetris, P.: Domain Names - Concepts and Facilities, Internet Standard 0013
2. Hardie, T.: Distributing Authoritative Nameservers via Shared Unicast Addresses.
(RFC 1034, 1035), Nov. 1987.
RFC 3258, Apr. 2002.
3. Partridge, C., Mendez, T., Milliken, W.: Host Anycasting Service. RFC 1546, 1993.
4. Abley, J.:Hierachical Anycast for Global Service Distribution.
http://www.isc.org/pubs/tn/isc-tn-2003-1.html
5. DNS root nameservers web sites. http://www.root-servers.org/
6. Padmanabhan, V.N., Subramanian, L.: An Investigation of Geographic mapping
techniques for Internet Hosts. ACM SIGCOMM, Aug. 2001.
7. OARC. https://oarc.isc.org/docs/dns-oarc-overview.html
8. OARC Root DNS Trace Collection January 2006 http://imdc.datcat.org/
collection/1-00BC-Z=OARC+Root+DNS+January+2006
9. Colitti, L., Romijn, E., Uijterwaal, H., Robachevsky, A.: Evaluating The Eﬀect of
Anycast on DNS root nameservers. Unpublished paper, Jul. 2006.
10. NetAcuity. http://www.digital-element.net
11. Spring, N., Mahajan, R., Anderson, T.: Quantifying the Causes of Path Inﬂation.
12. Sarat, S., Pappas, V., Terzis, A.: On the Use of Anycast in DNS. ACM SIGMET-
ACM SIGCOMM, Aug. 2003.
RICS, Jun. 2005
13. Route Views Project. http://www.routeviews.org
14. K-root Homepage. http://k.root-servers.org/
15. Barber, P., Larson, M., Kosters, M., Toscano, P.: Life and Times of J-root. NANOG
32, Oct. 2004
16. Boothe, P., Bush, R.: DNS Anycast Stability.19th APNIC, Feb. 2005.
17. Karrenberg, D.:Anycast and BGP Stability.34th NANOG, May 2005.