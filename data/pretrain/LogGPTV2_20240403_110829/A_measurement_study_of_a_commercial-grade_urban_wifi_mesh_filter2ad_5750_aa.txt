title:A measurement study of a commercial-grade urban wifi mesh
author:Vladimir Brik and
Shravan K. Rayanchu and
Sharad Saha and
Sayandeep Sen and
Vivek Shrivastava and
Suman Banerjee
A Measurement Study of a Commercial-grade
Urban WiFi Mesh∗
Vladimir Brik, Shravan Rayanchu, Sharad Saha, Sayandeep Sen, Vivek Shrivastava,
Department of Computer Sciences, University of Wisconsin, Madison, WI 53706, USA
{vladimir, shravan, sharad, sdsen, viveks, suman}@cs.wisc.edu
Suman Banerjee
ABSTRACT
We present a measurement study of a large-scale urban WiFi
mesh network consisting of more than 250 Mesh Access
Points (MAPs), with paying customers that use it for Inter-
net access. Our study, involved collecting multi-modal data,
e.g., through continuous gathering of SNMP logs, syslogs,
passive traﬃc capture, and limited active measurements in
diﬀerent parts of the city. Our study is split into four com-
ponents — planning and deployment of the mesh, success
of mesh routing techniques, likely experience of users, and
characterization of how the mesh is utilized. During our
data collection process that spanned 8 months, the network
changed many times due to hardware and software upgrades.
Hence to present a consistent view of the network, the core
dataset used in this paper comes from a two week excerpt
of our dataset. This part of the dataset had more than 1.7
million SNMP log entries (from 224 MAPs) and more than
100 hours of active measurements. The scale of the study
allowed us to make many important observations that are
critical in planning and using WiFi meshes as an Internet
access technology. For example, our study indicates that
the last hop 2.4GHz wireless link between the mesh and the
client is the major bottleneck in client performance. Further
we observe that deploying the mesh access points on utility
poles results in performance degradation for indoor clients
that receive poor signal from the access points.
Categories and Subject Descriptors
C.2.3 [Network Operations]: Network monitoring,Public
networks; C.2.1 [Network Architecture and Design]:
Wireless communication
General Terms
Documentation, Experimentation, Measurement, Performance,
Reliability
∗All student authors — V. Brik, S. Rayanchu, S. Saha, S.
Sen, and V. Shrivastava — are in alphabetical order.
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’08, October 20–22, 2008, Vouliagmeni, Greece.
Copyright 2008 ACM 978-1-60558-334-1/08/10 ...$5.00.
Keywords
WiFi Mesh, Commercial, Measurement, Wireless, Access
Network, Urban, Active Measurement, Pathloss, Client Ex-
perience
1.
INTRODUCTION
The widespread availability of WiFi and the beneﬁts of a
low cost tetherless network deployment have spurred a sig-
niﬁcant amount of interest in wireless mesh networks. As
the initial excitement of this new possibility has subsided,
realities and challenges of making such a network as a vi-
able technology have set in. The research community has
been spending many years and person-hours trying to both
understand performance issues of multi-hop wireless com-
munication as an access technology and tackle problems in
multiple innovative ways. A few examples of recent progress
include new channel-aware routing metrics such as ETX [1]
and WCETT [2]; new opportunistic and broadcast-oriented
routing strategies such as ExOR [3], COPE [4], MORE [5],
and CLONE [6]; channel planning and assignment strate-
gies that combine routing decisions [7, 8], mesh deployment
strategies [9, 10]. Additionally, a number of vendors (Cisco
Systems, Firetide, Mesh Networks (now part of Motorola),
Strix Systems, and Tropos Networks, to name a few) have
also spent their eﬀorts in creating and releasing commercial-
grade mesh networking solutions that are being used for dif-
ferent purposes, including municipality-wide Internet access,
public safety, and commercial use.
A number of detailed and insightful measurement stud-
ies in the recent years have characterized performance of
various moderate scale, primarily home-grown and organi-
cally expanding, mesh networks. Examples include pioneer-
ing work on the Roofnet testbed around Cambridge, MA
[11], the TFA-Mesh in Houston, TX [9], and the Digital
Gangetic Plains project in India [12]. Mesh deployments
with a research intent, often, have important limitations. In
such cases, we typically use oﬀ-the-shelf components for cost
reasons, and adapt them to their individual goals. Often, in
such deployments we provision additional capability for mea-
surements and experimentation to further the research goals.
Additionally, the services oﬀered by these deployments are,
often, at no cost to the user. Hence, initial expectations of
performance are relatively low. In contrast, users of a com-
mercial network have signiﬁcantly high expectations of net-
work stability and availability. Therefore, commercial net-
works are, often, carefully deployed, engineered, and tuned
for high quality performance. While multiple studies have
documented the experiences of mesh networks, that are oﬀ-
• User experience: What is the client performance in dif-
ferent parts of the mesh network?
• Usage characterization: How is the mesh utilized by
the users?
While it is always dangerous to generalize observations
based on one single deployment, we believe that the relative
success of this network makes it a reasonable starting point
for other future evaluations along these lines.
1.2 MadMesh Architecture and Use
The MadMesh network is comprised primarily of Cisco
1510 MAPs [13]. The MAPs are typically organized into
a tree structure, with the root referred to as a Root Ac-
cess Point (RAP), i.e., a RAP is a MAP selected to serve
as a root (see Figure 1). While a RAP typically has wire-
line access to the Internet, in the case of MadMesh, the
RAPs use special licensed, wireless frequency bands to com-
municate to an Internet ﬁber hub. MadMesh has multiple
MAPs conﬁgured as RAPs, and hence, there is a separate
tree corresponding to each RAP. Each MAP is conﬁgured to
detect other nearby MAPs, and associate with one tree for
all communication. Based on changing channel conditions,
a MAP can also change its parent in the tree, or even switch
to a diﬀerent tree, if available. A mesh controller directly
conﬁgures and manages all the MAPs in the network.
In
particular, each MAP establishes a Layer 2 tunnel to this
mesh controller soon after it boots up and joins an existing
tree.
We refer to the links between diﬀerent MAPs on a tree,
as the mesh backbone. The Cisco 1510 MAPs are equipped
with two radio interfaces. One interface of each MAP is
dedicated for communication on the mesh backbone, and is
referred to as the backbone interface. The second interface is
conﬁgured to act as a regular Access Point (AP) for regular
clients, and is referred to as the access interface. (When we
refer to the corresponding wireless links, we refer to them
as backbone link and access link respectively.) The back-
bone interface in MadMesh is conﬁgured to operate using
the 802.11a standards in the 5 GHz band, while the access
interface is conﬁgured to operate using the 802.11b/g stan-
dards in the 2.4 GHz band. Since each MAP dedicates a
single radio interface for backbone communication, all these
interfaces of MAPs that form the same tree are made to
operate on the same 802.11a channel to establish commu-
nication links. Diﬀerent trees operate on diﬀerent 802.11a
channels. The access interface of diﬀerent MAPs operate on
diﬀerent 802.11 b/g channels. Clients associate to the access
interface of a MAP using common WLAN procedures.
In the MadMesh deployment, the access interface is al-
ways conﬁgured to use an omni-directional antenna with 5
or 8dBi gain to achieve the desired coverage. The MAPs
are mounted on street utility poles and the expected cover-
age of the AP interface is around 1000 to 1500 feet. Most
backbone interfaces of MAPs use a 11 dBi sector antenna
for more eﬃcient communication. All of the backhaul traf-
ﬁc is encrypted by the MAPs using hardware-based AES to
ensure privacy of the users. The APs support the 802.11i
and WPA standard security authentication and encryption
mechanisms.
How MadMesh is used? MadMesh is used to provide
Internet access to users. Users are typically charged a ﬁxed
monthly fee which varies with the quality of service (like
Figure 1: Logical view of the MadMesh network.
shoot of research endeavors, in this paper, we attempt to
present a ﬁrst systematic study of a commercial-grade WiFi
mesh network 1. The mesh network we study has been op-
erational in Madison, WI, for more than two years now and
is managed by a local company called Mad City Broadband
(see http://www.madcitybroadband.com). We refer to this
mesh as MadMesh. MadMesh consists of more than 250
Mesh Access Points (MAPs) distributed in the greater down-
town area of 10 square miles, currently serves more than
1000 residential customers, provides traﬃc backhauling ca-
pabilities for some other ISPs and small businesses, and pro-
vides additional wireless services to diﬀerent public safety
organizations of the city.
1.1 Study goals
Through detailed measurement eﬀorts spanning more than
8 months, we wish to answer a broad categories of questions.
In each category, apart from trying to understand existing
phenomena, we also attempted to evaluate the relevance of
various ongoing research eﬀorts to improving performance.
For instance, given that a lot of eﬀorts are being spent in de-
signing eﬀective network coding based routing strategies [4,
6, 5], how applicable are they to common deployment sce-
narios. These categories are:
• Mesh planning and deployment: What are the deploy-
ment strategies and their eﬃcacies for a large-scale
mesh network spanning a substantial part of an urban
area? How eﬀective is such deployment in handling
failures?
• Mesh routing strategies: What are common routing
mechanisms adapted? How well do they perform?
1At the time of publication, we became aware of two con-
current pieces of work that examine certain characteristics
of metro-area WiFi mesh networks [22, 23]. As discussed in
Section 7, these eﬀorts are complementary to work reported
in this paper.
bandwidth limits) promised to them. Overall, the end users
of this network use it mostly from the student dormitories,
university buildings, cafeterias and other residences.
Figure 2 presents a high-level view of approximately one-
third of MadMesh. The centers of the circles mark the po-
sitions of the MAP locations. The circle size is proportional
to the number of users served. The lines indicate the typical
connectivity structure within the mesh.
1.3 Main observations
We now highlight some of the most important lessons and
observations learnt about a large-scale, commercial-grade
mesh network through our measurement study.
Robustness — local does not mean global
Each MAP in the network has good connectivity with its
peers. For example, about 60% of the MAPs had a degree
greater than 3 on average, while the top 10% of the MAPs
had a degree of 6 or higher. However, surprisingly there
were multiple cases where a single link failure could partition
the network. Thus although the network planning involved
local redundancy, it did not automatically translate to global
redundancy.
Bottleneck — it is the access link
The performance of the mesh backbone was fairly robust.
The link qualities were usually good. Multiple hops on the
backbone, going all the way up to 6-8 hops did not sig-
niﬁcantly hinder user performance. However, the biggest
hindrance to performance is the interference in the access
link. We believe that there are two reasons for it. First,
the MAPs are on utility poles, and most users are indoors
(in brick or other buildings). The access link, therefore, has
poor signal quality from such indoor locations. Second, the
radio interface in client devices (laptops, PDAs, etc.) of-
ten tend to operate in low-power modes than the MAPs.
Thus, although clients can ‘hear’ MAP beacons, the uplink
communication link is, often, particularly bad. Customer
premise equipments (like 802.11 repeaters) can potentially
help mitigate some of these performance problems.
Routing paths — ﬂapping is prevalent
The trees that deﬁne routing paths have a ﬂapping behav-
ior. While many MAPs had fairly stable paths, about 10%
of the MAPs had routing ﬂaps in a regular fashion (more
than 4 route changes per hour between the same alternative
choices). Often these ﬂaps occur due to availability of mul-
tiple equally good or equally bad alternatives, and call for
dampening mechanisms to be put into place.
Management — client feedback can really help
The usual management tools at the disposal of network ad-
ministrators rely on SNMP data collection from MAPs and
other infrastructure-based components. Unfortunately, the
MAPs, often, do not observe the real performance problems
being experienced at clients.
Inferring client performance
based on observations at the MAPs is harder due to the
high variability and complexity of the urban WiFi environ-
ment. A limited amount of automated client feedback (client
reports) can bring many of these performance problems to
light.
Applicability of recent research results — network
coding and opportunistic routing can help
In the recent past, new, wireless-speciﬁc, routing and MAC
mechanisms, such as network coding and opportunistic rout-
ing, have been proposed and demonstrated to work through
research prototypes in limited settings. However, the ques-
tion of their real applicability in outdoor mesh deployments
have not been answered. Our measurements indicate that
certain degree of topology diversity exists in the network
that will allow for these mechanisms to lead to performance
gains.
User characteristics — night-time peaks and uneven
usage
Finally, we have also studied the usual aspects of user be-
havior on this network. Being primarily a residential ac-
cess network, we observe that traﬃc volumes peak in late
evenings and the night hours, rather than in the daytime.
This is likely to be consistent with traﬃc patterns of other
access networks, but is contrary to observations made in core
ISPs (that see daytime peaks). Client distribution between
MAPs is also quite uneven.
1.4 Roadmap
The rest of the paper is structured as follows.
In the
next section we describe our measurement methodology. In
Sections 3 to 6, we examine diﬀerent questions in the four
broad categories, namely mesh planning and deployment,
mesh routing strategies, user experience, and usage charac-
teristics.
In Section 7, we present some related work and
place our current eﬀort in perspective, We, ﬁnally, conclude
in Section 8.
2. MEASUREMENT METHODOLOGY
For our measurement study we have collected data over a
period greater than 8 months. The main limitation to our
ability to collect data has to do with the commercial nature
of the network we study. Although most of our needs were
accommodated by the network operator, our access to logs
was limited and our experiments had to be conducted in
a manner that would not signiﬁcantly impair the network
performance. Combining the passive and active data, how-
ever, still allowed us to capture and understand the overall
characteristics of the network.
Periodic infrastructure logs
Using our privileged access to the mesh controller we polled
SNMP records from all active MAPs, once every three min-
utes. Each SNMP record had more than 150 parameters
that each MAP records about its performance. For exam-
ple, each MAP maintains statistics about the total number
of clients associated to it, the MAC address of the current
parent MAP, MAC addresses of its neighbors, the current
channel number, the number of failed transmissions, the
noise ﬂoor level at the MAP etc. In addition, we had ac-
cess to various management tools and syslogs at the mesh
controller, that tracked other global mesh parameters.
Passive monitoring
We strategically placed a few monitoring nodes at diﬀerent
parts of the network to gather wireless traﬃc passively. We
used three forms of passive locations — (i) an outdoor utility
Figure 2: A third of the MadMesh deployment area. The circles represent the MAPs, their relative
sizes indicate the relative number of users associated, averaged over three minute intervals over the
duration of the study. The largest circle corresponds to an AP which had 6.55 users in average. The
lines indicate their connectivity into the tree structure.
pole mounted monitoring node that was close to a MAP, (ii)
indoor monitoring nodes co-located with a few residential
users, and (iii) a mobile monitoring node mounted on a city-
bus traveling all over Madison, WI. Unfortunately, all client
traﬃc on the mesh was encrypted, and hence, it was not
feasible for us to do any application-level traﬃc analysis.
However, the MAC-level headers of all wireless frames were
available through this method.
Active measurements
Our log analysis revealed that passively collected data did
not adequately describe experience of individual network
clients. To address this issue, members of our teams period-
ically went to diﬀerent parts of the city to perform limited
volumes of active measurement, using tools such as iperf [14].
For these measurements we used laptops equipped with a
Cisco AIR-PCM352 PC Card wireless adapter and the Mad-
Wiﬁ driver v0.9.3.
Over the duration of these 8 months, the network itself
changed many times. For example, MAPs were moved be-
tween diﬀerent utility poles, hardware was changed and up-
graded, and so on. So to present a consistent view of the
network performance, the core dataset used in this paper
comes from a two-week period, between the end November
and early December 2007. This part of the dataset had
more than 1.7 million SNMP log entries (from 224 MAPs)
and more than 100 hours of active measurements.
Based on these data sets, we now present our observations
in the four diﬀerent categories in the following four sections.
3. ON MESH PLANNING & DEPLOYMENT
We begin with our observations on various topological
properties of MadMesh. Many of these questions arise when
the mesh is being deployed or periodically upgraded. More
speciﬁcally, we focus on the following questions in this sec-
tion:
MadMesh
Roofnet Mesh
1.0
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
n
o
i
t
c