Fig. 1. Number of IP addresses in the blackspace, between September 1st, 2014 and
March 31, 2015.
Demystifying the IP Blackspace
117
Blackspace population breakdown
Reserved
Available
100
80
60
40
20
e
c
a
p
s
k
c
a
b
l
f
o
e
g
a
t
n
e
c
r
e
P
0
          Sep          Oct
          Nov          Dec          Jan          Feb          Mar
Fig. 2. Daily proportion of reserved and available address space in the blackspace,
between September 1st, 2014 and March 31, 2015.
Duration of blackspace prefixes
F
D
C
1
0.8
0.6
0.4
0.2
0
1
All
Without leaks
100
209
10
Duration (days)
Fig. 3. Persistence of blackspace preﬁxes.
As mentioned in Sect. 2, a preﬁx in the blackspace has no inetnum entry in
the IRR, and has not been allocated for use by a RIR. Figure 2 breaks down
the statuses attributed to these IP addresses. Route leaks excluded, most of the
blackspace is actually due to reserved resources, which are set aside by RIRs
because they cannot be allocated right away.
Figure 3 plots the Cumulative Distribution Function (CDF) of the number
of consecutive days a single preﬁx was included in the blackspace. The plain
line plots this duration for all blackspace preﬁxes, including the many transient
ones that were the results of the two route leaks already observed in Fig. 1.
The dashed line plots the same duration, but excludes the preﬁxes resulting
from these leaks. The diﬀerence between these two curves implies that a lot of
distinct preﬁxes were added to the blackspace due to the leak of routes. Indeed,
the plain CDF shows that most blackspace preﬁxes are detected during four or
ﬁve consecutive days, which is precisely the duration of the two leaks observed
in Fig. 1. On the other hand, the dotted CDF shows that 50 % of blackspace
preﬁxes that are not the result of these leaks are seen for at least 12 days, and
that around 28 % of them are seen during one day or less. In order to know how
118
Q. Jacquemart et al.
Daily variation of blackspace
1
0.8
0.6
0.4
0.2
x
e
d
n
i
d
r
a
c
c
a
J
0
          Sep          Oct
All
Without leaks
          Nov          Dec          Jan          Feb          Mar
Fig. 4. Day-to-day variation of the blackspace preﬁxes.
t
t
e
e
g
g
a
a
n
n
e
e
c
c
r
r
e
e
P
P
100
100
80
80
60
60
40
40
20
20
0
0
Post blackspace situation
Post blackspace situation
All
All
Without leaks
Without leaks
withdrawn
withdrawn
inetnum
inetnum
assigned
assigned
Fig. 5. Situation of the preﬁx after if left the blackspace.
much the blackspace varies daily, Fig. 4 plots the Jaccard index in-between two
successive days. We compute the Jaccard index between days d and d + 1 as
the ratio of the number of blackspace preﬁxes that are detected on both days,
divided by the total number of distinct blackspace preﬁxes detected on day d
and d+1. A Jaccard index value of 1 indicates that the computed blackspaces for
days d and d + 1 are identical. Conversely, a Jaccard index value of 0 indicates
that the computed blackspaces for days d and d + 1 are 100 % diﬀerent. The
closer to 1 the value is, the more similar the two blackspaces are. Once again,
the variation is quite high when the route leaks start and ﬁnish, as shown by
the full line; but there is not a lot of daily variation otherwise (as shown by the
dashed curve).
The duration of a preﬁx in the blackspace (Fig. 3) as well as the variation
of the blackspace (Fig. 4) imply that some preﬁxes leave the blackspace. This
is possible if any of the three following conditions are met: (i) the preﬁx is
withdrawn from BGP; (ii) an inetnum entry is added in the IRR; (iii) the preﬁx is
marked as allocated or assigned by a RIR. Figure 5 plots the distribution of
each event for preﬁxes that exited the blackspace during our observation period.
Again, the values are plotted for all entries, and also only for entries that were
Demystifying the IP Blackspace
119
not the result of route leaks. In both situations, the most likely cause is that
the preﬁx has been withdrawn. The second cause is the creation of an inetnum
entry in an IRR database. If the IRR entry is more speciﬁc than the blackspace
preﬁx, another (more) speciﬁc preﬁx will be included in the blackspace instead.
Consequently, a bit less than 45 % of preﬁxes leave the blackspace because the
BGP announcement was withdrawn. On the other hand, the other 55 % become
allocated (in one way or another) afterwards; which implies that half of the
preﬁxes included in the blackspace are, potentially, used in good faith by the
announcers. However, the other half, which globally amounts to a /11 network,
does not end up as a registered network.
3.2 BGP Characterization
In the previous Section, we saw that there are many blackspace preﬁxes, many
of which are long-lasting. In this Section, we focus on the BGP characteristics
of blackspace preﬁxes. We ﬁrst focus on the origin AS of the blackspace preﬁxes
to shed light on their uses. Where we cannot, we look at the temporal evolution
of the blackspace preﬁx along with its origin AS in order to better understand
the root cause.
AS numbers are assigned a status by RIRs, just like IP blocks (see Sect. 2):
either allocated, assigned, available or reserved. Figure 6 plots the daily
proportion of each AS status for ASes that originate a blackspace preﬁx. The plot
has been further broken down by explicitly classifying the private AS numbers
(between 64,512 and 65,535 [12]) separately from the reserved set. As can be
seen by the black/squared line private ASNs are responsible for a large number
of preﬁxes, but only during the two route leaks. In fact, all leaked preﬁxes are
originated from a private ASN. Allocated, assigned and reserved ASNs all
roughly account for a third of blackspace preﬁxes, and available ASNs account
for less than 10 % of those. Just like with IP blocks, reserved and available
ASNs are not allocated, and thus should not be in use. Yet, two thirds of the
blackspace preﬁxes are originated by these ASes.
Status of originating ASes
100
80
60
40
20
e
g
a
t
n
e
c
r
e
P
Allocated
Assigned
Available
Reserved
Private
0
          Sep          Oct
          Nov          Dec          Jan          Feb          Mar
Fig. 6. Daily status of the ASNs originating a blackspace preﬁx.
120
Q. Jacquemart et al.
Figure 7 plots the percentage of blackspace preﬁxes for ASes that announce
(at least) one blackspace preﬁx. The plot is further subdivided by AS status, but
we excluded the private AS numbers, as they were the result of route leaks (see
Fig. 6). Here, both of the allocated and assigned statuses behave similarly,
with more than 90 % of them announcing less than 1 % of blackspace preﬁxes.
Less than 10 % of allocated (and around 20 % of assigned) ASes originate
more than a quarter of blackspace preﬁxes. On the other hand, close to 70 % of
reserved and available ASes only announce blackspace preﬁxes. To put this
into perspective, the (global) average number of announced preﬁxes by allo-
cated ASes is 229; by assigned ASes is 340; by reserved ASes is four, and
by available ASes is two. In order to ﬁnd out who operates these networks,
we look at the names of the corporations behind these ASes (using [9]). We get
185 network names for allocated or assigned ASes that originate blackspace
preﬁxes, for which we located the corporation website using mostly popular
web search engines. We were able to resolve 178 names to mostly telephone or
cable companies and ISPs (of all sizes and shape: tier-1 to tier-3, from dial-
up to business-grade ﬁber providers, all around the world), hosting and cloud
providers, data centers, IT service companies, and world-wide tech companies.
Other companies operated as advertising, airlines, bank and insurances, con-
structions, courier and parcel delivery services, e-commerce, Internet exchange
points, law ﬁrms, medical companies, military contractors, and online news. We
could not resolve seven names. One was established as a company, but the web-
site did not work, one used a name too generic to be found, and for three we
could not locate any further information. The two remaining ASes appear to
have been registered by individuals in Eastern Europe who also own other ASNs
which are known to send spam – but do not originate blackspace preﬁxes at the
same time.
Ratio of blackspace prefixes
F
D
C
1
0.8
0.6
0.4
0.2
0
0
Allocated
Assigned
Available
Reserved
100
20
Percentage of blackspace prefixes
40
60
80