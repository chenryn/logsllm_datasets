(e.g., onion domains with typographical errors, phishing
attacks). Although onion domains are only resolvable
inside the Tor network, Internet users may attempt to ac-
cess an onion site using a browser that is not conﬁgured
to use Tor, resulting in the DNS query for onion domain
“leaking” to conventional DNS resolvers—and ultimately
to a DNS root server. Because all onion lookups to a
conventional DNS server will result in a cache miss, all
leaked onion lookups will ultimately go to a DNS root
server. Thus, DNS root servers see a good sample of
leaked onion domains. Our work builds on a previous
analysis of a similar data set that was conducted several
years ago and which was not focused on onion services
speciﬁcally like our work [18, 33].
We obtained about several days of DNS data from
the B root server through the IMPACT Cyber Trust pro-
gram [34]. This data has several hundred pcap ﬁles, which
contain full packet captures with pseudonymized IP ad-
dresses of all DNS trafﬁc to the B root from September
19, 2017 10:00 UTC to September 21, 2017 23:59 UTC.
We analyzed the DNS queries dataset and present our re-
sults alongside our ﬁndings from the survey and interview
results. We extracted the QNAME of each DNS query,
which yielded 15,471 correctly formatted onion domains
that were 16 characters long (representing an 80-bit hash
of the owner’s public key) had has any letters of the al-
phabet and numbers between 2 and 7. These lookups, of
course, may not always correspond to a real onion site,
but they do reﬂect that some machine issued a DNS query
for that onion domain for some reason.
As we previously mentioned, we asked The Tor Project
to disseminate our survey on its blog and Twitter account,
which likely yielded the following biases.
Non-response bias. People who noticed our call for vol-
unteers but decided against participating may have valued
their privacy too much, falsely believed that their perspec-
tive is irrelevant, lacked time, or had other reasons not to
participate. Nevertheless, non-respondents may exhibit
traits that are fundamentally different from those who did
participate.
Survivor bias. Our participants generally were able to
tolerate Tor Browser’s usability issues, which is why they
are still around to tell their tale. We likely did not hear
from people who decided that Tor Browser was not for
them and were thus unable to tell us what drove them
away. The danger of survivor bias lies in optimizing the
user experience for the subset of people whose tolerance
for inconvenience is higher than the rest.
Self-selection bias. Due to the nature of our online sur-
vey, participants could voluntarily select themselves into
our set of respondents. These respondents may be un-
usually engaged, technical, and opinionated. Indeed, the
demographic for our online survey in Section 4.2 was
young and educated; perhaps Tor Browser’s population
is young and educated, as well, but we have no way of
knowing.
5 Results
We organize the presentation of our ﬁndings by topic, in-
cluding how users perceive and use (Section 5.1), manage
(Section 5.2), and wish to improve (Section 5.3) onion
416    27th USENIX Security Symposium
USENIX Association
Figure 3: A sketch of interviewee P03’s mental model of onion
services. The participant referred to several layers of protection.
services. We interleave the results from our online sur-
vey with our interviews and domain name system data as
appropriate.
5.1 Perception and Use
We ﬁrst explore how users perceive onion site technology
and why they use onion sites.
5.1.1 Incomplete mental models of onion services
We asked only our interviewees (not our survey partic-
ipants) about their mental models of onion services be-
cause it is difﬁcult to collect this type of information
from a survey. This section thus presents results from the
interviews only.
Perceptions of what an onion service is. We asked our
interview participants how they deﬁned an onion service,
how they work, and what types of content and services
they tend to host. Terminology was inconsistent and some-
times confusing: some interviewees referred to onion
services as the dark web and others as hidden services.
(Recall that The Tor Project only uses the term onion
services). About half of our interviewees (9/17) knew
that onion services enabled a user to access Web content
anonymously. Six interviewees stated that onion services
provide extra layers of protection, an idea that is well-
illustrated in Figure 3,6 and further elaborated on by par-
ticipant P03:“I think it’s to do with the different hops that
you build - different layers of making it difﬁcult to ﬁnd out
who this person is.” Four interviewees stated that onion
services work in a similar manner to Tor but with different
encryption methods, which we can see on Figure 4. A
minority of participants had sophisticated understanding:
they referred to the encryption of data on the end points
of a connection; three interviewees referred to the fact
that last hop along the encrypted path corresponds to an
onion link.
Perception of anonymity. Five interview participants
drew the connection between Tor and onion services, stat-
ing that onion services have to be accessed through Tor
6All
sketches are available online at https://nymity.ch/
onion-services/mental-models/.
Figure 4: Comparison of two sketches from interviewee P13.
The ﬁrst sketch shows the P13’s mental model of Tor and the
second one P13’s mental model of onion services.
browser but at least one did not see any connection be-
tween Tor and onion services. Only three interview par-
ticipants knew that onion services do not only provide
anonymity to the visitors to a website but also to the onion
website provider themselves. In contrast to these inter-
viewees who had some sense of what an onion service
was, nearly half of our interviewees (8/17) were confused
about how to deﬁne onion services, were unsure how
onion services function or how to describe them, and did
not understand how onion services protect them. Some of
our interviewees did not distinguish disguising their IP ad-
dress from disguising their real-world identity and instead
used the umbrella term “anonymity” to refer to both con-
cepts. This conﬂation of concepts paints an incomplete
picture of the security and privacy guarantees that the Tor
network provides, with only a few interviewees recogniz-
ing that anonymity is not completely achievable with Tor
onion services: “What’s the point of going to Facebook
using onion services when their business model is still
about collecting your data?” (P7). Other participants
simply thought of onion services as P08 characterized
them: “[the] Internet without hyperlinks.” Some of our
participants were not aware that onion services provide
end-to-end security and self-certifying names. Syverson
and Boyce explored how onion services can improve web-
site authentication [32], but these beneﬁts are difﬁcult to
convey to non-technical users, and even some experts ad-
vocated an “all or nothing” approach to online anonymity,
overlooking important nuances.
The presence of a large quantity onion domains in the
root DNS data corroborates prior studies that suggest
either Internet users are attempting to visit an onion do-
main in a non-Tor browser indicating a misunderstanding
of onion links, that browsers are loading content with
onion links using pre-fetching, or that some web pages
or malware are attempting to load resources from onion
sites [18, 33].
Perceptions of what an onion service is used for. Inter-
viewees had various perceptions of what onion services
were used for or why they existed in the ﬁrst place. In-
USENIX Association
27th USENIX Security Symposium    417
used by the Tor network.”
Anonymity was also the main reason why our inter-
viewees used onion services (6/17). Another reassuring
factor for two of our interviewees was the feeling of secu-
rity and safety that onion services provide. Furthermore,
two interview participants thought of onion services as
“harm reduction technique.” P10 preferred to use Face-
book’s onion domain because it impedes tracking efforts.
Additionally, 47% of survey respondents and three inter-
viewees viewed onion services as the only way to access
content they enjoy, making the use of onion services a
necessity.
Non-browsing activities. Of our survey respondents who
used onion services (485/517), 64% had these services for
purposes other than web browsing. Several protocols such
as the chat application Ricochet [4] and the ﬁle sharing
application OnionShare [15] were purpose-built on top
of onion services while existing TCP-based tools such
as ssh can transparently use onion addresses instead of
traditional IP addresses. Less than a quarter (21%) of our
survey participants used onion services for non-browsing
activities at least once a month such as remote login (ssh)
or chat (IRC or XMPP). Our interviewees similarly men-
tioned using onion services to access Pirate Bay (1/17),
Ricochet (1/17), TorChat (1/17), and OnionShare (1/17).
Work or personal reasons. Survey respondents who se-
lected “Other” (45%) for onion service usage provided
many reasons, including personal (18/517), with the most
predominant personal reason being that an onion service
gives a machine behind a network address translation
(NAT) device a stable identiﬁer and can be reached from
any other user on the Tor network (there are other ways
to achieve this goal, but for these users, setting up an
onion service was the easiest way). Several interviewees
used onion services to accomplish speciﬁc tasks. Five
interviewees reported that they use onion services simply
for their work, while four stated personal reasons, such
as for a personal blog, or giving someone access to their
home network. Two interview participants used onion
services for educational purposes. P3 used onion services
to help teach students about the dark web: “I was teach-
ing a class on Internet technology and regulations. We
were basically showing students how Tor works and part
of what I have to do as a teaching assistant was make
students go and basically get to the moment where they
either hire a hitman, buy drugs, or buy weapons. Just to
show that it’s possible. And then obviously we didn’t buy
it.”
Other survey respondents reported using onion services
to reduce the load on exit relays, to do technical research,
and to access sites that are otherwise unavailable. For
instance, 7/517 used onion services for hosting a service,
one survey respondent admitted using onion services for
e-book piracy, two used onion services as an alternative
Figure 5: Reasons for using onion services.
terviewees sometimes associated onion services with il-
licit content such as the drug trade or credit card data
sales (2/17) or felt that onion services may be the technol-
ogy behind anonymous purchases. Similarly, as reported
later in the paper, many survey respondents also voiced
concern about illegal and questionable content on onion
services, described by some as a “Wild West”. Phishing
sites, honeypots, and compromised onion sites further
contribute to this perception.
5.1.2 Onion services used mostly for more anonymity
Usage. Our survey asked how often our respondents
browse onion services. The usage frequency was almost
uniformly distributed among our survey respondents; 24%
use onion sites less than once a month, 22% use them
about monthly, 25% weekly, and 23% daily. The remain-
ing 6% had never used an onion service. We also asked
our interviewees if they had used onion in the last three
months; seven had and seven had not, with four of the
latter group explaining that they had used onion services
before, just not in the last three months. Only two inter-
viewees had never used onion services before at all.
Anonymity and onion service content. The majority of
our survey participants who used onion services did so
because of the additional anonymity (71%) and the ad-
ditional security (62%) (see Figure 5). For instance, six
survey respondents commented on the onion domain for-
mat, indicating that they believed the seemingly-random
characters in onion domains are the reason why onion ser-
vices are anonymous: “Onion services stay anonymous
through changing their domain, and I feel that there is
a possibility of decreased anonymity with a constant do-
main name.” (S436). These participants also believed
that vanity domains are “less anonymous” because part
of their domains is clearly not random. One survey par-
ticipant (S454) further wrote:“I understand vanity onion
domains are a sign of the weakness of the hash algorithm
418    27th USENIX Security Symposium
USENIX Association
0255075100PercentageofParticipantsNoResponseClickingLinksCuriosityAbout“DarkWeb”OtherOnlyWaytoAccessContentAdditionalSecurityAdditionalAnonymity6.1818.7627.0744.6846.6162.2870.79Figure 6: Reasons for running onion services.
Figure 7: Concerns of onion service operators about attacks.
to a virtual private network and two used them to make
their website as private and personal as they could.
Exploring the dark web. 27% of our survey respondents
and two interviewees wanted to ﬁnd out more about the
dark web and onion domain content (3/517) as reasons to
use onion services. Two interviewees used onion services
for fun and social reasons—to “toy around” (P7) and
also, as a way of spending time with friends, as well as to
“show off” around them by using a technology unfamiliar
to most users. Interestingly, 19% of survey respondents
said that they use onion services for no particular reason
but have clicked on onion links occasionally.
5.1.3 Onion sites operated for various reasons
Setting up an onion service. 39% of survey respondents
had set up an onion service at some point. Of the re-
spondents who had set up onion services of their own
(266/517), 31% had run their onion service for private use
while 21% had run them for the public. Figure 6 gives
an overview of the reasons our respondents have for run-
ning onion services. For instance, the majority of those
with onion services used them for end-to-end security,
curiosity, or NAT traversal. Only 18% survey respondents
had set up onion services for anonymity, such as to pro-
tect their visitors and provide security on their sites. In
the open-ended responses, eleven survey respondents set
up onion services because then their websites could be
accessed from anywhere in the world, and seven survey
respondents set up an onion service simply to test and
learn how they work. Another two survey participants
ran onion mirror sites to their personal websites, and at
least one had an onion service as a backup website in
case he lost control over his personal domain. Finally, at
least two survey respondents set up onion for business
purposes, work requirements, or to add valuable content
to the onion community. In a similar vein, at least two
interviewees spoke about setting up onion services or
using onion services for work, such as to help Internet
users upload leaked documents to their whistleblower
website anonymously. In another example, P5 used onion
services in the academic peer review process to allow
authors to submit source code or supplementary material
anonymously: “If one of the other reviewers connects
to our university site, and we have some sort of tracking
information on there, we would be deanonymizing the re-
viewer. We put it on a Tor hidden service to make sure that
the reviewer remains blind in academic review process.”
Phishing concerns. We inquired how concerned the sur-
vey respondents were about three potential attacks on
their own onion services: (i) somebody setting up a phish-
ing site for the operator’s site, (ii) a denial-of-service
attack, and (iii) a deanonymization attack. According
to the results, shown in Figure 7, less than 8% of our
survey respondents who operated an onion service were
at least somewhat concerned about all of these attacks.
Only a small percentage, 15%, claimed to be extremely
concerned about somebody deanonymizing their onion
service, 10% were extremely concerned about an onion
site being taken ofﬂine, and only 9% were concerned
about an onion site being impersonated for phishing pur-
poses. Indeed, in the open-ended responses, we noted that
several respondents lamented the difﬁculty of protecting
onion services from application-layer deanonymization
attacks. Matic et al. demonstrated some of these attacks
in 2015 [17].
5.1.4 Varying trust in Tor and onion services
Our survey asked how safe our respondents feel when
using Tor Browser and onion services, respectively. Fig-
ure 8 shows that onion services were actually perceived
as less safe than Tor browser. 85% of survey respondents
feel at least somewhat safe or very safe using Tor Browser
as compared to only 66% of onion service users.
Reasons for trust. Survey responses indicated that par-
USENIX Association
27th USENIX Security Symposium    419
0255075100PercentageofParticipantsNoResponseOtherAutomaticCreationAnonymityNATTraversalCuriosityEnd-to-endSecurity60.738.710.8317.9821.6623.424.1710050050100ResponsesPhishingDenialofServiceDe-anonymizationNotatAllSlightlySomewhatModeratelyExtremelycontent I access over onion services. When I want content
from a service, I tend to distrust it from the beginning.”
Two interviewees mentioned that websites cannot identify
you as the general advantage of onion services but at least
three participants pointed out that websites actually can
determine your identity if you write down your personal
details as well as if you log in into any private accounts
while using onion services. Similarly, 20 survey respon-
dents also raised concerned and mentioned not wanting
to log in to onion sites because they believe it defeats the
purpose by revealing private data.