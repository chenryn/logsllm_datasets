针对单独的加密芯⽚，如图所⽰，当我们能获知其消耗的能量后，将其放⼊⽰波器，我们能明显看到其波形的不同
电磁分析
Gandolfi K, Mourtel C, Olivier F. Electromagnetic analysis: concrete results. Cryptographic Hardware and 
Embedded Systems - CHES 2001, LNCS, vol. 2162. Springer Berlin Heidelberg, 2001: 251-261.
电磁分析原理与能量分析相似，在密码算法在硬件上运⾏的过程中，不同的运⾏状态所产⽣的电流，由麦克斯韦的
理论，会在空⽓中逸散⼤量的电磁信号。当然，由芯⽚中电路产⽣的电磁信号很弱，基本需要贴着芯⽚才能探测到
电磁分析和能量分析在攻击⼿段上某种意义上是等价的关系，⼀般选取更为⽅便的⼀种来进⾏分析。相对于能量分
析的优点是不需要修改芯⽚的外围电路，缺点是对环境要求⾼，需要⼀个电磁屏蔽的环境
缓存分析
D. Page. Theoretical use of cache memory as a cryptanalytic side-channel. Technical Report CSTR-02-003, 
Department of Computer Science, University of Bristol, 2002.
缓存就是数据交换的缓冲区，在计算机体系机构中，为了最⼤限度在成本和性能之间寻求最优解，遵从计算机中的
类似82定律，即某个时间段内，计算机⼤部分的时间在读写少量的内存单元。现代计算机设置了多级缓存，读写速
度越快的存储单元价格越贵，使⽤多级缓存能让成本较⼩提升的情况下，⼤幅提⾼计算机性能
针对缓存的分析也是时间分析上的⼀种，当某块内存由本不该互相知道彼此在⼲什么的进程读写，当⼀块内存访问
速度明显快（在实际中是数量级的差别）的时候，可以合理猜测另⼀个进程已经访问过该块内存。著名的计算机体
系结构漏洞：幽灵和熔断，就是利⽤CPU缓存机制，将不可访问的内存中的信息泄露出去
0x02 简单能量分析
简单能量分析，跟名字⼀样，很简单，也不需要太⾼深的密码学知识，本质上就是依据不同条件判断后进⼊的分⽀
不同，对应的操作不同，消耗的能量也就不同，可能这⾥对“简单分析”的概念还是⽐较模糊，接下来就以例⼦说明
DES的简单能量分析
在DES算法中有这么⼀个操作，叫PC-1置换
PC-1置换的实现如果不做侧信道防护的话，就可以通过简单能量分析破解
步骤1：把B清零
步骤2：按A的⽐特编号进⾏56次循环：
if A[i] = 0:
  do nothing
if A[i] = 1:
  查表得知这个1在B中的去向，并写⼊B相应的位置
1
2
3
4
那么，⽤之前的思路来看，A[i] = 0的时候什么都不做，⽽A[i] = 1的时候做了⼀些事情，这⾥的A就是我们要
获取的密钥，在汇编指令层⾯看的话，Key的某些位为0的时候会执⾏条件jmp指令，⽽某些位为1的时候条件jmp指
令判定失败，进⼊下⼀步指令，对置换来说就是数据MOV操作，仔细观察下图波形，再⾃⼰设置密钥做⼀次实验后
就会发现，能量/功耗波形是有规律可循的
使⽤低通滤波器后，可以更清楚的看到这个规律性的能量曲线
⼤数乘法的简单能量分析
在⼀些密码算法中，⼤数乘法的软件/硬件实现是密码算法中常见的运算
AES的简单能量分析
在AES算法中的简单能量分析是对其中列混合阶段的MixColumns也就是列混合，进⾏攻击，列混合⼀般的实现是
有限域上的多项式计算，类似于y1 = 1000 0001时
其常规的实现⽅法为
和上⾯⼀样，多⼀个运算和少⼀个运算的功耗曲线是完全不⼀样的，在进⾏运算时的功耗曲线上，低⾕就表⽰当前
y的值是0，⾼峰代表当前y的值是1，结合密码学的分析⽅法，就可以很容易推算出AES运算的初始密钥
A       1 0 1 1
B  x    1 0 1 0     <- 被攻击的值
---------------
        0 0 0 0     若B[i]=0，什么都不做，功耗低
      1 0 1 1       若B[i]=1，累加A，功耗⾼
    0 0 0 0         若B[i]=0，什么都不做，功耗低
  1 0 1 1           若B[i]=1，累加A，功耗⾼
-----------------
1
2
3
4
5
6
7
8
if MSB(y1) = 0:
  y1 << 1
if MSB(y1) = 1:
  (y1 << 1)^100011011
1
2
3
4
RSA的简单能量分析
RSA总所周知，是基于⼤质数分解难题，在运算时需要计算某个数的⼤幂指数的值，如
在算法实现上会采⽤平⽅乘算法
说⼈话就是，⽐如对于x111000，其中的1，会做平⽅-乘（左移位并在当前位置1），对0就只做平⽅（左移位）
好了，现在你已经学会RSA简单能量分析了，快去破解RSA吧（S为平⽅，M为乘）
ECC的简单能量分析
ECC是椭圆曲线加密算法，是基于椭圆曲线数学理论实现的⼀种⾮对称加密算法。ECC是建⽴在基于椭圆曲线的离
散对数问题上的密码体制，给定椭圆曲线上的⼀个点P，并选取⼀个整数k，求解K=kP很容易(注意根据kP求解出来
的K也是椭圆曲线上的⼀个点)；反过来，在椭圆曲线上给定两个点K和P，若使K=kP，求整数k是⼀个难题
在上图所⽰的算法中，可以看到对于不同的kj输⼊，会只计算Q=2Q或者仍需要计算Q=Q+P，那么你已经学会破解
ECC了，开始“找茬”吧