ğ‘
ğ‘–=1
= ln ğ¾ ğ‘
ğœ(ğ‘–).
We assume that the statistical feature extraction function f cal-
culates the minimum of (cid:174)ğ‘  to acquire the flow-level features. ğ¼min
denotes the index of the sample with the minimum value. The
differential entropy of the feature is Hflowâˆ’min that equals to the
entropy of the random variable with the minimum value:
ğ¼min = arg min
ğ‘ ğ‘–,
ğ‘–
âˆ« +âˆ
âˆ’âˆ
= ln ğ¾ğœ(ğ¼min).
Hflowâˆ’min = âˆ’
ğ‘ğ¼min (ğ‘ ) ln ğ‘ğ¼min (ğ‘ )dğ‘ 
Î”Hflowâˆ’min denotes the differential entropy loss of the minimum
feature, i.e., the difference between the overall differential entropy
and the differential entropy of the minimum feature:
Î”Hflowâˆ’min = Hpacket âˆ’ Hflowâˆ’min
ğœ(ğ‘–).
= ln ğ¾ ğ‘âˆ’1 
We focus on the expectation of the loss, and leverage Jensen in-
equation to get the lower bound of the information loss:
ğ‘–â‰ ğ¼min
E[Î”Hflowâˆ’min] â‰¥ ln ğ¾ ğ‘âˆ’1ğ¸[ğœ ğ‘âˆ’1]
â‰¥ (ğ‘ âˆ’ 1) ln ğ¾E[ğœ].
We conduct the same proof procedure for the features that calculate
the maximum of the per-packet feature sequence and complete the
proof of Theorem 1.
B PROOF OF THEOREM 2 AND THEOREM 3
We consider the situation that a flow-level feature extraction method
calculates the average number of sampled per-packet features. We
denote the average of (cid:174)ğ‘  as a random variable ğ‘“ğ‘š that obeys a Gauss-
ian distribution:
ğ‘
ğ‘–=1
ğ‘
ğ‘–=1
ğ‘“ğ‘š âˆ¼ N( 1
ğ‘
ğ‘¢(ğ‘–),
1
ğ‘ 2
ğœ2(ğ‘–)).
ğ‘ğ‘š denotes the probability density function (PDF) of ğ‘“ğ‘š. We use
Hflowâˆ’avg and Î”Hflowâˆ’avg to indicate the differential entropy of
Session 12C: Traffic Analysis and Side ChannelsCCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3444the average feature and the information loss, respectively:
Hflowâˆ’avg = âˆ’
ğ‘ğ‘š(ğ‘ ) ln ğ‘ğ‘š(ğ‘ )dğ‘ 
âˆ’âˆ
= ln ğ¾
ğ‘
âˆ« +âˆ
(cid:118)(cid:117)(cid:116) ğ‘
= ln ğ‘ ğ¾ ğ‘âˆ’1 ğ‘
(cid:113)ğ‘
ğœ2(ğ‘–),
ğ‘–=1
Î”Hflowâˆ’avg = Hpacket âˆ’ Hflowâˆ’avg
ğ‘–=1 ğœ(ğ‘–)
ğ‘–=1 ğœ2(ğ‘–)
.
To get the upper bound, we use ğ‘„ to indicate the square mean of
the variances of (cid:174)ğ‘ . According to the inequality of arithmetic and
geometric means, the geometric mean is not bigger than the square
mean. We get the upper bound of the differential entropy loss:
Î”Hflowâˆ’avg â‰¤ ln ğ‘ ğ¾ ğ‘âˆ’1
(cid:113)ğ‘
ğ‘„ ğ‘
ğ‘–=1 ğœ2(ğ‘–)
âˆš
â‰¤ ln
ğ‘ ğ¾ ğ‘âˆ’1ğ‘„ ğ‘âˆ’1.
If and only if ğœ(ğ‘–) is a constant, the information loss Î”Hflowâˆ’avg
reaches its maximum. We use ğœmax to indicate the maximum of the
variances of (cid:174)ğ‘ , and get the lower bound of the information loss by
leveraging the non-negative differential entropy assumption:
ğœmax = max(ğœ(ğ‘–))
âˆš
âˆš
ğ‘ ğ¾ ğ‘âˆ’1ğ‘
(1 â‰¤ ğ‘– â‰¤ ğ‘),
ğ‘–=1 ğœ(ğ‘–)
ğœmax
(ğ¾ğœ(ğ‘–) â‰¥ 1).
Î”Hflowâˆ’avg â‰¥ ln
â‰¥ ln
ğ‘
The equality holds iff. ğœ(ğ‘–) =
1
ğ¾ . When the equality holds, the
upper bound equals the lower bound. Here we complete the proof
of Theorem 3. Similar to the proof of Theorem 1, we apply Jensen
inequation to get Î”Hflowâˆ’avg and prove Theorem 2.
C PROOF OF THEOREM 4
We consider the situation that a flow-level feature extraction method
calculates the variance of the sampling sequence to extract the fea-
tures of traffic. Random variable ğ‘‰ denotes the variance of (cid:174)ğ‘ :
ğ‘
ğ‘‰ =
ğ‘–=1(ğ‘ ğ‘– âˆ’ ğ‘¢)2
ğ‘
, ğ‘¢ =
ğ‘–=1 ğ‘ ğ‘–
ğ‘
.
The random variable ğ‘‰ obeys general Chi-square distribution. We
assume that the Gaussian process S is strictly stationary with
zero mean, i.e., ğ‘¢(ğ‘–) = 0 and ğœ(ğ‘–) = ğœ. We present an estimate of
differential entropy loss when ğ‘ is large enough:
ğ‘
ğ‘
ğ‘‰ =
ğ‘–=1 ğ‘ 2
ğ‘
ğ‘–
ğœ2
ğ‘
=
)2,
( ğ‘ ğ‘–
ğœ
)2 âˆ¼ ğœ’2(ğ‘).
( ğ‘ ğ‘–
ğœ
Hflowâˆ’var denotes the differential entropy of the variance feature:
ğ‘
ğ‘
ğ‘–=1
Hflowâˆ’var = H[ğ‘‰ ] = H[
ğ‘–=1
ğ‘
+ H[ ğ‘
ğ‘–=1
+ ln 2Î“( ğ‘
]
ğ‘–
ğ‘–=1 ğ‘ 2
ğ‘
( ğ‘ ğ‘–
ğœ
)2]
ğ‘
= ln ğœ2
= ln ğœ2
ğ‘
2 ) + (1 âˆ’ ğ‘
2 )ğœ“ ( ğ‘
2 ) + ğ‘
2 ,
where Î“ is Gamma function and ğœ“ is Digamma function. When ğ‘
is large enough we take the even number that is closest to ğ‘ to
approach the information loss: (ğ›¾ is Eulerâ€“Mascheroni constant)
â€² (ğ‘¥)
Î“(ğ‘¥)
ğœ“ (ğ‘¥)
Î“(ğ‘¥)
Î“
= Î“
= (ğ‘¥ âˆ’ 1)!
â€² (ğ‘¥) = (ğ‘¥ âˆ’ 1)!(âˆ’ğ›¾ +ğ‘¥âˆ’1
2 )! âˆ’ ğ‘
ğ‘˜=1
2 (âˆ’ğ›¾ +
+ ln 2( ğ‘
ğ‘
ğ‘˜ )
1
ğ‘2
1
ğ‘˜
) + ğ‘
2 .
â‡’ Hflowâˆ’var = ln ğœ2
ğ‘˜=1
Then we approach the Harmonic series as follows,
ğ‘
ğ‘˜=1
1
ğ‘˜
â‰ˆ ln ğ‘ + ğ›¾,
â‡’ Hflowâˆ’var = ln ğœ2
ğ‘
+ ln 2( ğ‘
2 )! âˆ’ ğ‘
2 ln ğ‘
2 + ğ‘
2 .
Finally, we use Î”Hflowâˆ’var to indicate the information loss and
leverage Stirlingâ€™s formula to approach the factorial.
Î”Hflowâˆ’var = Hpacket âˆ’ Hflowâˆ’var
âˆ’ ğ‘
2ğœ‹ğ‘›( ğ‘›
ğ‘’
= ğ‘ ln ğ¾ğœ âˆ’ ln ğœ2
ğ‘
(ğ‘›! â‰ˆ âˆš
)ğ‘›)
= ğ‘ ln ğ¾ğœ âˆ’ ln ğœ2
âˆ’ ğ‘
âˆš
ğ‘
4ğœ‹ ğ‘ 3
= ğ‘ ln ğ¾ğœ âˆ’ ln
ğœ2
.
2 âˆ’ ln 2( ğ‘
2 )! + ğ‘
2 ln ğ‘
2
2 + ğ‘
2 ln ğ‘
âˆš
ğœ‹ ğ‘ ( ğ‘
2 âˆ’ ln 2
2ğ‘’
) ( ğ‘2 )
Here, we complete the proof of the Theorem 4.
D PROOF OF THEOREM 5 AND THEOREM 6
Without the loss of generality, we analyze ğ‘–ğ‘¡â„ kind of per-packet
features, and denote its sampling sequence as (cid:174)ğ‘ . Based on the orig-
inal assumption, we assume that Gaussian process S is strictly
stationary with zero mean, i.e., ğ‘¢(ğ‘–) = 0 and ğœ(ğ‘–) = ğœ. Whisper
extracts the frequency domain features of the per-packet feature
sampling sequence (cid:174)ğ‘  with the following steps:
(1) Perform linear transformation by multiplying ğ‘¤ğ‘– on (cid:174)ğ‘ , for
simplicity, we use ğ‘¤ to indicate ğ‘¤ğ‘–.
(2) Perform DFT on ğ‘¤(cid:174)ğ‘ . We denote the result as (cid:174)ğ¹ = F (ğ‘¤(cid:174)ğ‘ ) and
its ğ‘–ğ‘¡â„ element as (cid:174)ğ¹ğ‘– = (ğ‘ğ‘– + ğ‘—ğ‘ğ‘–)ğ‘¤.
(3) Calculate modulus for the result of DFT. (cid:174)ğ‘ƒ denotes the result
and (cid:174)ğ‘ƒğ‘– = (ğ‘2
(4) Perform logarithmic transformation on (cid:174)ğ‘ƒ. (cid:174)ğ‘… denotes the
extracted frequency domain features for (cid:174)ğ‘  and (cid:174)ğ‘…ğ‘– = ln( (cid:174)ğ‘ƒğ‘– +
1)/ğ¶ denotes its ğ‘–ğ‘¡â„ element.
The property of Discrete Fourier Transformation: F (ğ‘¤(cid:174)ğ‘ ) =
ğ‘– )ğ‘¤2 denotes its ğ‘–ğ‘¡â„ element.
ğ‘– + ğ‘2
ğ‘¤F ((cid:174)ğ‘ ), implies that:
ğ‘ğ‘– =ğ‘ ğ‘¡ ğ‘ğ‘–,
ğ‘ğ‘– âˆ¼ N(0, ğ‘ ğœ2).
We estimate the overall differential entropy of the frequency domain
features by ignoring the impact of the logarithmic transformation
Session 12C: Traffic Analysis and Side ChannelsCCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3445Figure 9: Detection accuracy under 28 evasion attacks. During the attacks, in order to evade the detection, the attackers use
different strategies to inject benign traffic.
and obtain the entropy as HWhisper. According to the properties
of differential entropy and several inequalities about differential
entropy, we obtain an estimation for the differential entropy of the
frequency domain features:
HWhisper = H[ (cid:174)ğ‘ƒ] =
ğ‘
H[ğ‘ƒğ‘– ]
)2],
)2 + ( ğ‘ğ‘–âˆš
H[( ğ‘ğ‘–âˆš
ğ‘
ğ‘
ğ‘¡ğ‘– âˆ¼ ğœ’2(2)),
)2,
We use Î”HWhisper to indicate the information loss of Whisper and
get an estimation of the differential entropy loss of Whisper:
Î”HWhisper = Hpacket âˆ’ HWhisper
= ğ‘ ln ğœ
ğ‘¤2
âˆ’ ğ‘ ln ğ‘ .
(cid:114) ğœ‹
2ğ‘’
We complete the proof of Theorem 5. According to Theorem 1 - 4,
we can obtain Theorem 6.
ğ‘– + ğ‘2
ğ‘– ]
=
ğ‘–=1
H[ğ‘2
ğ‘– + ğ‘2
ğ‘– )]
ğ‘–=1
H[ğ‘¤2(ğ‘2
ğ‘
= ğ‘ ln ğ‘¤2 + ğ‘
= ğ‘ ln ğ‘ ğ‘¤2 + ğ‘
HWhisper = ğ‘ ln ğ‘ ğ‘¤2 + ğ‘
ğ‘–=1
)2 + ( ğ‘ğ‘–âˆš
ğ‘
(ğ‘¡ğ‘– = ( ğ‘ğ‘–âˆš
ğ‘
ğ‘–=1
H[ğ‘¡ğ‘– ]
= ğ‘ ln ğ‘ ğ‘¤2 + ğ‘ (1 + ln 2).
ğ‘–=1
Figure 10: Detection accuracy under sophisticated evasion
strategies.
E THE DETAILED RESULTS OF ROBUST
EVALUATION
Figure 9 shows the detailed detection results under different evasion
attacks, i.e., seven types of malicious traffic mixed with benign
traffic with four types of inject ratio. We observe that the injected
benign traffic has negligible effects on the detection accuracy of
Whisper.
We also measure the effects of more sophisticated evasion strate-
gies on the detection accuracy. The strategies include (i) injecting
different types of benign traffic (i.e., ICMP, DNS, and outbound NAT
traffic that includes various types of benign traffic), (ii) changing the
rate of sending malicious packets according to the rate of benign
TLS flows, (iii) manipulating the packet length in the malicious
traffic according to the benign TLS packet length. Figure 10 shows
that the detection accuracy is not significantly impacted by the
attacks, which is consistent with the results shown in Figure 9.
SSLDoS+BenignTLSOSScaning+BenignUDPTLSPaddingOracle+BenignTLSFuzzingScan+BenignTLSACKSide-Channel+BenignTLSIPIDSide-Channel+BenignTLSTLSScanning+BenignUDP1:11:21:41:8AUC0.9150.9150.9620.9790.9830.9830.9740.9770.9170.9450.9300.9450.9810.9650.9750.9050.9820.9550.9780.9870.9620.9720.8910.9570.9390.9170.9340.956SSLDoS+BenignTLSOSScaning+BenignUDPTLSPaddingOracle+BenignTLSFuzzingScan+BenignTLSACKSide-Channel+BenignTLSIPIDSide-Channel+BenignTLSTLSScanning+BenignUDP1:11:21:41:80.7140.1570.2550.6580.4930.7210.5850.6030.5110.5750.6270.4380.4190.6460.7150.5920.6960.6150.7140.3630.4770.3950.1940.6490.7490.4210.4320.545SSLDoS+BenignTLSOSScaning+BenignUDPTLSPaddingOracle+BenignTLSFuzzingScan+BenignTLSACKSide-Channel+BenignTLSIPIDSide-Channel+BenignTLSTLSScanning+BenignUDP1:11:21:41:80.9640.8560.8430.934///0.8740.7680.7560.838///0.8200.7460.7500.644///0.6310.7440.8140.763///1:11:21:41:8EER0.1060.1720.0580.0370.0250.0240.0690.0350.1440.0860.0810.0840.0330.0740.0310.1950.0420.0650.0320.0200.0710.0350.2080.0760.0810.1030.0950.089Whisper1:11:21:41:80.3000.8330.7450.3420.5060.2790.5090.4030.5030.4210.3730.5630.5810.3330.2860.4080.3040.3860.2850.6350.5360.6020.7730.3510.2640.5790.5680.462FSC1:11:21:41:80.0460.2640.2320.070///0.1840.3280.3460.289///0.2780.3190.3120.412///0.4580.3390.2740.385///KitsuneIPIDSide-Channel+ICMP(1:1)IPIDSide-Channel+ICMP(1:2)IPIDSide-Channel+ICMP(1:4)IPIDSide-Channel+DNS(1:1)IPIDSide-Channel+DNS(1:2)IPIDSide-Channel+DNS(1:4)TLSScanning+NAT(1:1)TLSScanning+NAT(1:2)TLSScanning+NAT(1:4)IPIDSide-Channel+BenignLengthTLSPaddingOracle+BenignLengthSSLDoS+BenignRateACKSide-channel+BenignRate0.800.850.900.951.00AUCAUC0.000.020.040.060.080.10EEREERSession 12C: Traffic Analysis and Side ChannelsCCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea3446