书。幸运的是，骗局很快被揭穿。如果他们拿到不正确发布的证书
而逍遥法外，不管它们最终落到谁的手里，都可以用一个Microsoft
密钥对软件进行签名。站在系统的角度，这种存在缺陷的软件就是
Microsoft的软件。
7.2.3累积式信任
2326
---
## Page 2328
层次式信任的缺点是层次是脆弱的，这就导致了最后一种重要信任
模型的诞生，它就是累积式信任。累积式信任参考了一些因素，根
据这些因素决定证书是否合法。
累积式信任来自于对层次式信任所进行的检查。在理想化的世界
中，当一切事物都表现正常时，层次式信任是最理想的。在现实世
界中，我们一直在使用层次式信任。护照、签证、驾驶证、身份
证、信用卡甚至员工的资格证书都是通过层次式信任系统发挥作用
的。
但是，安全人员最感兴趣的事情并不是一切都正常时会发生什么，
而是一旦出错时会发生什么。层次式信任是脆弱的。由于它们的脆
弱性，所以很自然地产生了一个趋势，就是限制层次的范围。例
如，在一般情况下，护照和驾驶证并不是统一的。政府文档很少成
为信用文档。由于层次是脆弱的，因此不同的层次之间往往互不通
用。能够把你带到工作场所的标识卡并不能把你送上飞机，尽管它
们之间实际上存在着信任链！雇主信任层次中的标识卡通过身份文
档在银行和税务系统都进行了备案。至少从理论上说，它们可以被
联系在一起。但是，它们并没有被联系起来，因为层次之间缺乏信
任。
“我能看一下两种形式的ID吗？”这个问题表达了最简单的累积式信
任系统。两种形式的ID就是一种累积式信任系统。它背后的安全设
想是：两条信任路径同时出现错误的可能性要比一条信任路径出现
错误的可能性低得多。这种思路就是依赖方至少要收集一条信任路
径，使它成为累积式信任。这种累积可以使用不同类型的信任。例
如，当你向一位商家提供信用卡时，商家可能会要求同时看一下你
的驾驶证，这就是累积式信任。注意，信用卡是金融证书，而驾驶
证则类似于身份证书。但是，商家从这两种证书中累积了足够的信
任，然后再完成交易。
注意，累积式信任可以同时包含直接信任和层次式信任。设置一个
包含直接信任和层次式信任的累积式信任系统是非常容易的。我们
还可以把层次式信任看成是一种特殊类型的累积式信任，它将累积
一条信任路径。直接信任也可以看成是特殊形式的层次式信任和累
积式信任。
在公钥基础设施中，最广泛使用的累积式信任系统是PGP信任网
络。但是，交叉认证和桥认证中心A即使还不能说是累积式系统，至
少也是非常接近于累积式信任的。
2327
---
## Page 2329
定义
尽管本章中的大多数术语都是安全领域中常用的，但在这里提供部
分术语的定义还是非常实用的，可以帮助我们保持思维的同步。
PGP术语是有意为口语化设计的，它的目标就是成为与技术术语不
同的常用语言。下面让我们定义其中一些术语，并讨论与PGP相关
的术语：
PKI公钥基础设施。PKI是一组用于创建、发布、维护公钥和证书的
技术和机制。证书（Certificate）
证书是一种数据结构，它包含了一个公钥、一些信息和一个签名，
声明这个密钥和这些信息是相配的。身份证书是最常见的。它们把
一个名称与一个公钥（电子邮件地址只是某种类型的名称）绑定在
一起。属性证书把密钥持有人的相关信息与这个密钥绑定在一起。
例如，一个表示"这个证书的持有人的年龄超过21岁”的证书就是一
个属性证书。
认i证l（Certification）
认证就是用一个数字签名对信息和密钥所进行的单个绑定。X.509证
书包含了一个单独的认证。OpenPGP证书可能包含一些认证。
认证（因此也包括证书）是认证中心（CA）在创建用于绑定密钥和
相关信息的签名时创建的。
密钥（Key）
OpenPGP的术语，其他PKI称之为证书。WhittieldDiffie创建这个术
语的原因是它比"证书”（Certificate）更容易发音、输入和理解。一
般人对密钥有直观的认识，知道它是用来做什么的。目前，这个术
语在有些语境上可能会造成混淆。一个OpenPGP密钥（证书）可能
包含许多认证，事实上许多相关的公钥都是由它自己的上下文环境
和策略所支配的。
密钥环（Keyring）
密钥的集合。它可能是一位用户所维护的私有数据库，也可能由一
些用户所共享，例如下一个术语所提到的密钥服务器。
密钥服务器（Keyserver）
2328
---
## Page 2330
一部通过网络共享大量集合密钥的字典。人们可以把密钥上传到服
务器并把它当成可靠的存储工具。通过密钥服务器，可以使所有与
密钥相关的信息保持最新。
签名（Sign）
OpenPGP使用口语化的"签名"表示其他PKI所称的"批准”。用
OpenPGP的行话来说，就是Alice对Bob的密钥进行了签名（而不是
批准）。
介绍人
创建证书的密钥。因此，介绍人是OpenPGP用来表示认证中心的术
语。和密钥这个术语一样，WhitfieldDifie创造这个术语的原因使它
更加口语化，比“认证中心"这个未语更容易理解。
7.2.4基本的PGP信任网络
对于熟悉其他公钥基础设施（PKI）的人们而言，PGP的一个特点使
它与基本的层次式信任系统有所不同，而它的所有一切都是从这个
特点所衍生而来的。在PGP信任模型中，所有的用户同时也是证书
授权人。当然，并不是所有的授权人都具有平等的地位。Alice可以
批准Bob，但这并不意味着Fran应该接受这个认证。这就是为什么
PGP使用介绍人这个术语而不使用授权人的原因。人们具有一种自
然的心理倾问，觉得授权人是可以信任的，但是对介绍人持很现实
的怀疑态度。
“Phil，这是Bob。"Alice这样进行介绍。根据Phil对Alice的信任程
度，他将会作出一个决定。Phil可以完全信任介绍人Alice，并接受
为Bob为合法的。他也可以等待，直到Jon表示“嗨！Phil，你还没有
碰见Bob吗"这时他才完全接受Bob是合法的。
有一个常见的错误概念是：由于信任网络是相对的，因此所有的参
考系都是同等有效的，可以不存在可识别的授权人和有组织的使
用。这样的思考方式只会混淆体系结构和实现。许多实现和部署把
一组介绍递交给终端用户，由他们使用，就像接受软件中所植入的
根证书一样。
但是，为了理解它的工作方式，让我们观察图7-1，它显示了信任网
络以及它的各个方面。这张图中的每个节点是一个密钥环中的一个
2329
---
## Page 2331
密钥。每个箭头表示一个认证签名。从Alice到Bob的箭头表示Alice
已经签名或批准了Bob的密钥。
在图7-1的顶部，标签为You（你）山的密钥是主人的密钥。它是个
三环圆形，表示它是完全受信任的，意味着它所签名的任何密钥都
是合法的。我们也可以说它是隐式受信任的，因为You同时包含了私
钥和公钥。图中的一些箭头表示You对属于Alice、Bob、Carol、
Dan、Eli和Fran的密钥进行了签名。
图7-1PGP信任网络
图中还有一些孤立的签名，它们是不包含在这个密钥环中的虚引
用。例如，有个You并未签名的密钥对Eli的密钥进行了签名。
图中用灰色填充的密钥是合法的密钥，我们可以认为它们是准确
的，因为信任网络的累积式系统经过计算认为它们是合法的。累积
信任的工作方式如下：部分信任的介绍人在图中用一个双环圆表示
2330
---
## Page 2332
的密钥表示，它们的签名为一个点的积分。完全信任的介绍人在图
中用一个三环圆表示的密钥表示，它们的签名为两个点的积分。如
果一个密钥从介绍人那里所累积的签名达到两个点或更多，它就被
认为是合法的。积分只有一个点或者没有点的密钥不会被认为是合
法的。
为了观察一些例子，让我们注意一些特定的子图：
Alice和Bob分别对Hal进行了签名。因此，Hal是合法的，但Hal并不
是受信任的。
Gil被Alice所签名，但是由于Alice只是部分信任的，因此Gil的密钥
并不是合法的。
Carol签名了一些同样位于这个密钥环中的密钥，但是它们都不是合
法的。有趣的是，Ken签署了Phil，后者是合法的，但它之所以合法
并不是因为Ken对它进行了签名。
Dan、Eli和Fran具有密集的密钥。You对每个密钥都进行了签名。另
外，它们都是完全信任的介绍人。Eli对Fran的密钥签名是允余的，
因为You直接批准了它。或者说，You的直接信任是允余的，因为Eli
对它进行了签名。
Nan、Olivia和Mary是合法的，因为Fran对它们进行了签名。如果问
上追踪到它们中的任何一个，可以看到两条合法路径，一条包含
Eli，另一条是从Fran到You的直接路径。
You认为Jon是合法的，因为Dan对它的密钥进行了签名，You也可以
完全信任它。因此，Phil和Quentin是合法的。You所发现的由Jon进行
签名的任何密钥也是合法的。对于其他完全信任的介绍人而言，这
当然也是正确的。但是，Jon并不是You直接信任的。Dan和Jon的组
合非常像层次式认证中心。
另外，注意Quentin虽然有两条问上路径，但是其中一条经过Nan
它是合法的但并不是受信任的。因此，虽然Nan具有两条合法的向上
路径，但Quentin只有一条。
Ron具有3个签名，但没有一个来自You所信任的人。
Sal是由两个虚密钥签名的，它们表示未连接到这个信任网络的人。
2331
---
## Page 2333
现在，我们可以很方便地通过这张图区分合法和信任这两个很容易
混淆的概念。合法是节点（圆）的特性，而信任是节点之间的边的
特性。我们可以通过信任路径确定是否合法。
[1]You并不是人名，但是为了讨论方便，下面有时把它当做人名处
理。
7.2.5最早的信任网络的毛边
早期版本的PGP基本信任网络与累积式信任系统非常相似。但是，
它在体系结构和语义上存在一些毛边。在后期版本的PGP中，我们
修正了这些毛边。不过，首先还是让我们回顾一下这些毛边。
超级合法
在图7-1中，Fran是个特殊的密钥，因为它的积分达到了4，其中2个
是由You所签名的，另2个是由Eli所签名的。信任网络对这种超级合
法的密钥并没有提供特殊的待遇，但在直觉上Fran应该享有一定的
特权才是。对于Fran和Jon都进行了签名的密钥，应该也有一些特殊
待遇。我们还需要把这种直觉转变为一种实用的机制。
签名密钥的社会影响
尽管如此，如果要为一个自己所不喜欢的人的密钥进行签名，许多
人会感到不太乐意。站在社会的角度，分配信任也可能带来麻烦。
仍然以图7-1为例，假设你在生活中非常信任Carol（她可能是你最好
的朋友），但是你可能无法信任她能够正确地对密钥进行签名，这
是由于她的信任本质所决定的。类似，Fran可能是个无聊的家伙，
喜欢吹毛求疵，你无法忍受和她呆在一个房间里。但是，尽管她是
个讨厌的家伙，但是你可能不得不让她成为一个完全信任的介绍