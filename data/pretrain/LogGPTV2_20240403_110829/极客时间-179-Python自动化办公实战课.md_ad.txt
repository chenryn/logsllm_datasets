# 保存文件    workbook.save(dst_file)可以看到，写入文件的时候，我们使用了一个叫做 write的函数。它的前两个参数代表的写入位置，分别是指定写入的行和列坐标。无需多言，这个写入位置非常重要。如果按照上面的代码方式写入，也就是前两个参数均指定为0，就会覆盖这个 Excel文件中的现有内容了。所以，你如果想完成合并操作的话，就要实现对现有 Excel内容进行追加写入。通常我们会先获取现有的内容一共有多少行、多少列，然后向后移动一个位置，再进行写入。这种追加写入的方式，在我们的工作场景中非常常见。接下来，我们就看看怎么用追加写入的方式，实现多个Excel 文件的合并吧。怎样实现 Excel 的合并？我们还是用前面提到的做调查问卷模板的场景，来具体讲一讲怎么实现 Excel的合并。这里，我们就要用到一个重要功能了：**循环功能**。循环功能的核心代码是：    from pathlib import Path, PurePath    
# 指定要合并excel的路径    src_path = '/Users/edz/Desktop/文章1/调查问卷'    
# 取得该目录下所有的xlsx格式文件    p = Path(src_path)    files = [x for x in p.iterdir() if PurePath(x).match('*.xlsx')在这段代码中，我使用了 for 语句，实现了 Python的循环功能。通过这样的功能，我可以依次获取 src_path变量指向的路径下所有的文件。同时，为了避免这个目录里的文件类型过多，我使用一个if 语句用于条件判断，只提取.xlsx结尾的文件。现在，用 Excel实现调查问卷自动化的主要功能已经都实现了。接下来，我们看看怎样实现整个工作过程。我把它们的工作流程定义为三个步骤：1.       找到整个工作过程当中重复操作的部分；        2.       将重复操作的部分需要哪些手工操作找出来，使用 Python    编写程序代替手工操作的部分；        3.       对重复的部分，使用循环语句进行批量处理。        如果你对把手工操作改成 Python程序，还没有任何经验的话，我还可以为你提供更直观的办法，叫做**画时序图**。我先带你看看时序图是什么呢？如下图表:![](Images/de302eb15bb049cf57ebbf26d1867d89.png)savepage-src="https://static001.geekbang.org/resource/image/b2/90/b2da3c7bfd1c80888d0c4776317fb090.png"}简单来讲，**时序图就是以时间顺序来排列程序中的事件的图表**。通过上图，你应该很容易看出重复操作的这四个事件：1.       打开文件；        2.       提取用户填写内容；        3.       粘贴到汇总文件；        4.       关闭文件。        下面，我们就用 Python来替代这四个事件。由于它们是重复的，所以我会使用 for循环对它们依次进行处理。回到我们的 Excel做调查问卷的场景。当我们回收了调查问卷之后，每份问卷的格式是完全相同的，刚好可以利用上面提到的循环功能处理每份问卷。而问卷的选项则是我们需要提取出来用于汇总的，所以我们要使用Python 实现读取 Excel 调查问卷的功能，最后再写入到一个新的 Excel中。 好了，我们来看下这一功能的 Python代码是如何编写的：    import xlrd    import xlwt    from pathlib import Path, PurePath    
# 导入excel和文件操作库    