can later be reverted to stop diverting traﬃc.
• Canonical Name – Since the DPS controls the au-
thoritative name server for the canonical domain name,
changes can be made in a manner similar to that out-
lined above.
• Name Server – The DPS controls the authoritative
name server for the protected domain name and as
such it can change the address record(s) accordingly.
On-demand protection can be manual or automated. As
an example of the latter consider customer-premise mitiga-
tion equipment (i.e., an in-line appliance) that sends out an
alert to the DPS in case an attack is too large to handle
in-line.
In such a hybrid approach, the DPS can initiate
on-demand protection automatically.
3. METHODOLOGY AND DATA SET
To study the use of DDoS protection services we use data
from active DNS measurements over a period of 1.5 years, for
a large set of domain names. We analyze the measurement
data using Hadoop to identify whether and how domains
are protected by a DPS. The various steps of the measure-
ment and analysis process, as well as general statistics of the
resulting data set, are described next.
280start
days #SLDs #DPs
size
Source
.com
.net
.org
.nl
2015-03 550 161.2M 534.5G 17.5TiB
20.2M 62.4G 2.1TiB
2015-03 550
2015-03 550
13.8M 46.7G 1.5TiB
5.9M 10.4G 2.1TiB
2016-03 184
2.2M 1.7G 77.5GiB
Alexa 1M 2016-03 184
203.3M 655.7G 23.3TiB
Total
Figure 1: Architecture of our measurement system
3.1 Active DNS Measurements
In earlier work, we designed and implemented a measure-
ment system for large-scale, active DNS measurements [12].
This system queries a chosen set of RRs for a given list of
domains, and it repeats these measurements daily. Among
others, it queries for A, AAAA, and NS records. A and AAAA
queries are sent not only for the root label (i.e., apex) of
a domain, but also for other common labels, such as www.
This means for a given domain name, both name.com and
www.name.com are queried. All ﬁelds from the answer sec-
tion of a DNS response are stored, which includes CNAMEs
and their full expansions.
A high-level view of our system is shown in Figure 1. The
measurement starting point is a list of domain names. We
primarily measure entire zones, i.e., the full list of names in
a top-level domain (TLD), for which the system downloads
updated zone ﬁles daily from registry operators. Secondarily
we measure smaller lists, such as the Alexa Top 1M ranking.
In this paper we focus mainly on measurement data for .com,
.net, and .org, which together contain about 50% of the
global domain namespace, which we have been measuring
the longest. We also cover measurements for the country-
code TLD .nl, and for domains on Alexa’s Top 1M list.
3.2 Supplementing AS Numbers
We supplement each IP address with an autonomous sys-
tem number (ASN) on the basis of BGP data. The origin
AS of the most-speciﬁc preﬁx in which an address was con-
tained at measurement time is determined on the basis of
the Routeviews Preﬁx-to-AS mappings (pfx2as) data set3.4
3.3 Deriving DDoS Protection Service Use
We analyzed the measurement data to detect the use of
DPS providers. Several of the studied providers oﬀer DNS-
based traﬃc diversion and (optionally) authoritative name
server protection.
As detailed in Section 2, various ways exist to divert net-
work traﬃc to the infrastructure of a DPS. Our analysis
reveals, per day, if domain x uses one (or several) of these
methods. More speciﬁcally, we detect CNAME-based redirec-
tion by checking whether the CNAME expansion of x contains
a DPS reference. Similarly, the NS record of x will reference
a DPS if the DNS zone of x is managed by that DPS. Lastly,
the ASN of x ’s IP address(es) can also reference a DPS.
We detect DPS references in CNAME and NS records based
on the second-level domain (SLD) contained therein. For
example, we found that Incapsula uses the SLD incapdns.net
3www.caida.org/data/routing/routeviews-preﬁx2as.xml
4For multi-origin AS we add all the involved AS numbers.
Table 1: Data set
in CNAME records. To identify SLD and ASN references, we
apply the following procedure. We take the ASNs of a DPS
as starting point.5 Then we ﬁnd all the domain names that
reference these ASNs and analyze frequently occurring SLDs
in CNAME and NS records. The SLDs obtained in this manner
are used to ﬁnd any ASNs we may have missed in the ﬁrst
step, or to remove ASNs that do not belong to the mitigation
infrastructure of a DPS.
Based on combinations of references and non-references we
can analyze not only if, but also how a domain uses a DPS.
Take for example a domain that references a DPS by CNAME
and ASN, but not by NS record. This combination of refer-
ences shows us not only that the domain uses CNAME-based
redirection to eﬀectively divert traﬃc to a DPS. Moreover,
we learn that the DNS zone of this domain has not been
delegated to the DPS.
By evaluating combinations of references we also iden-
tify frequently-used third parties, such as third-party name
servers that are authoritative for large numbers of domains
that switch on or oﬀ protection simultaneously.
3.4 Always-on and On-demand Use
To analyze if a domain uses a DPS in an always-on or
on-demand manner, we track (non-)use of the DPS by the
domain over the measurement duration. If a domain always
references a DPS by ASN, i.e., without gap days, we as-
sume always-on use. On-demand use is assumed if a domain
switches back and forth between two IP addresses over time
of which the prior does not and the latter does reference
a DPS. In this case, CNAME, NS, and ASN (non-)references
reveal speciﬁcally how on-demand traﬃc diversion was ef-
fected. For example, a domain for which the ASN of an
unchanged IP address references a DPS on and oﬀ suggests
BGP-based traﬃc diversion.
3.5 Data Set
Our data set contains 1.5 years worth of measurements for
the generic TLDs (gTLDs) .com, .net, and .org, in addition
to six months for the country-code TLD (ccTLD) .nl and for
the Alexa Top 1M. Table 1 details the data set. The column
#SLDs shows the number of unique SLDs observed over
the measurement period. #DPs is the number of collected
data points (i.e., CNAME, A, AAAA, and NS measurements6).
The size column shows the compressed measurement data
size in our cluster using Parquet columnar storage7 (before
replication). The three gTLDs contain about 50% of the
global domain namespace; on the last day of the data set
they contain a little over 152M names.
Table 2 shows the ASN and SLD references for the consid-
ered DPS providers, obtained using the procedure described
5We use AS-to-name data to ﬁnd a DPS’s AS numbers.
6AS numbers are supplement and not counted separately.
7https://parquet.io/
databaseper TLDStage Icollectionservercluster managerper TLD…………Worker cloudper TLDStage IIStage IIIInternetHadoop cluster………………TLD zonerepositories……281Provider
Akamai
AS number(s)
20940, 16625, 32787
CNAME second-level domain(s)
akamaiedge.net, edgekey.net,
edgesuite.net, akamai.net
CenturyLink
CloudFlare
DOSarrest
F5 Networks
Incapsula
209, 3561
13335
19324
55002
19551
Level 3
Neustar
Verisign
3549, 3356, 11213, 10753
7786, 12008, 19905
26415, 30060
—
cloudﬂare.net
—
—
incapdns.net
—
ultradns.net
—
NS second-level domain(s)
akam.net, akamai.net, akamaiedge.net
savvis.net, savvisdirect.net, qwest.net,
centurytel.net, centurylink.net
cloudﬂare.com
—
—
incapsecuredns.net
l3.net, level3.net
ultradns.* (e.g., .com & .biz)
verisigndns.com
Table 2: DDoS Protection Service provider references
in Section 3.3.8 Some providers do not work with CNAME
redirection, but through delegation can change the IP ad-
dress of a domain (e.g., Verisign’s Managed DNS service).
Some providers (e.g., F5 Networks & DOSarrest) oﬀer none
of the DNS options.
4. RESULTS
4.1 General Overview
Using the references in Table 2, we analyze the three main
TLDs and ﬁnd per day the number of domains that use the
DPS providers under consideration.9 Fig. 2 shows the varia-
tion of the number of distinct SLDs over time. The ﬁgure is
dominated by many “anomalous” peaks and troughs, which
can involve millions of domains. For example, the peak on
the 5th of March, 2015 involves about 1.1M domain names.
The anomalous trend that is apparent in the largest gTLD,
.com, is replicated in .net and .org, which indicates that
the anomalous behavior is transversal to the zones. Many of
the larger anomalies are part of on-demand behavior, which
we discuss in more detail in Section 4.4.
Figure 2: DPS use and zone breakdown
Fig. 3 shows over time per DPS the number of domains
that use any of the DPS’s services (the top line). As can
be seen, some of the larger anomalies can be traced to In-
capsula (e.g., the previously mentioned peak in March 2015
in Fig. 2). Some providers show very few anomalies, and
contain more domains than the more anomalous providers
on their “quiet” days. For example, CloudFlare versus In-
capsula in March 2015, were it not for the anomalous peak.
8It should be noted that for some of the studied providers
the references can overlap with customers of other services.
For example, for Akamai more than just Kona Site Defender
(their reverse proxy) and Prolexic Routed/Connect (their
BGP-based mitigation solution) domains can be traced to
the found AS references.
9We consider use by domains on their second level, mean-
ing that multiple references in the DNS zone of a domain are
counted as one.
In Fig. 4 we show the (average) distribution of the three
main TLDs over the roughly 50% of the global domain names-
pace that they cover, as well as the distribution of DPS using
domains among these TLDs. Both distributions are remark-
ably similar, suggesting that there is no correlation between
a zone and subscribing to a DPS.
Figure 4: DPS use and gTLD distribution over namespace
4.2 Overall Growth
For our growth analysis we do not count anomalous peaks