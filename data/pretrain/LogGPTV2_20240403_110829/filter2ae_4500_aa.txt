**作者：Antonio Mangino 、Elias Bou-Harb（美国德克萨斯大学圣安东尼奥分校网络安全和分析中心）  
原文链接：[A Multidimensional Network Forensics Investigation of a State-Sanctioned
Internet
Outage](https://www.researchgate.net/publication/350499300_A_Multidimensional_Network_Forensics_Investigation_of_a_State-Sanctioned_Internet_Outage "A Multidimensional Network Forensics Investigation
of a State-Sanctioned Internet Outage")  
翻译：知道创宇404实验室  
译文PDF：[对国家主导的断网的多维网络取证调查](https://images.seebug.org/archive/%E5%AF%B9%E5%9B%BD%E5%AE%B6%E4%B8%BB%E5%AF%BC%E7%9A%84%E6%96%AD%E7%BD%91%E7%9A%84%E5%A4%9A%E7%BB%B4%E7%BD%91%E7%BB%9C%E5%8F%96%E8%AF%81%E8%B0%83%E6%9F%A5.pdf
"对国家主导的断网的多维网络取证调查")**
摘要：2019年11月，伊朗政府强制实施为期一周的全面断网，阻止了大部分互联网接入国内。本文阐述了伊朗断网的特点，通过互联网规模，近实时网络流量对事件展开测量。从调查扫描互联网的受影响设备开始，分析了近50TB的网络流量数据。本文发现了856625个受影响的IP地址，其中17182个属于伊朗。到互联网关闭的第二天，这些数字分别下降了18.46%和92.81%。对物联网（IoT）模式的实证分析显示，90%以上受影响的伊朗主机为物联网设备，在整个关闭过程中出现了显著下降（到断网第二天下降了96.17%）。进一步的检查将BGP可达性度量和相关数据与地理定位数据库相关联，以统计评估可连接的伊朗网关的数量（从大约1100个下降到200个以下的可连接的网络）。深入调查揭示了受影响最大的网关，为此类关键网络的纵向断开提供了网络取证。最后，强调了此次断网对比特币挖矿市场的影响，发现了比特币市场未成功（即未决）交易的激增。综合起来，这些网络流量测量提供了伊朗断网的多维视角。
索引词：断网，互联网背景辐射，物联网，网络取证
### 1.介绍
当今全球地缘政治中，内乱和抗议活动骤然增多。从南美洲到亚洲，各个国家的公民都开始表达他们对政府权威或相关法律政策的不满。持续的内乱可能会在全国范围内造成经济、外交和军事方面的影响。伊朗最近的抗议活动导致美伊外交关系紧张，一架乌克兰客机在伊朗领空上空被击落，多个国家的176人丧生，此后两国关系更加紧张。为了防止运动规模增大，伊朗政府实施了互联网关闭。从2019年11月16日开始，持续整整一周，伊朗公民无法使用互联网进行通信，无法进行金融交流，也无法连接到日常活动所需的大量应用程序。虽然之前也发生过国家主导的互联网审查（例如，土耳其对维基百科的三年禁令以及伊拉克对社交媒体的禁令），而伊朗此次的断网是最彻底的一次，媒体人士通常称之为全面关闭。为此，本文多维地、实证地分析伊朗国家主导的断网，并对此提出了自己的见解。
#### 1.1 研究目的
伊朗国家主导的互联网关闭是一个历史性的重要事件，表明政府正在采取不断升级的措施，以平息内乱。社会越来越依赖有弹性的互联网连接，但各国政府现在却有了一个几乎切断本国互联网连接的先例。为了提供实证测量和量化伊朗断网的规模，本文提供了从各种互联网规模的角度观察和分析的有见地的网络流量测量，而本次伊朗断网可能成为未来国家主导的审查事件的先例。
#### 1.2 贡献
由于猛烈的全球地缘政治动荡以及分析和记录这一重大事件以进行历史分析的必要性，本文为具体衡量伊朗国家主导的断网提供了以下贡献：
  * 从宏观角度解读事件 
之前的一些工作通过使用大规模网络流量和互联网背景辐射来实证研究断网[1–3]。本文通过分析近50TB的近期互联网规模，以及两周时间间隔内的宏观网络流量，汇总了最近伊朗互联网关闭期间生成的数据指标，提供了独特的见解。这些数据显示，每天有80万个主机地址主动接入互联网，在伊朗断网高峰期下降到698532个。此外，伊朗的国家指标显示，伊朗地址受影响的人数大幅减少，从事件前的17677人减少到事件低点的1896人（减少89.3%）。此外，还有分析显示，伊朗网络空间的90%以上由物联网设备组成[4]（16296个物联网设备与886个非物联网设备）。
  * 网关级BGP路由可用性分析 
先前对边界网关协议（BGP）在全国范围内断网期间的可达性进行的调查使我们获得了对网关级别的见解[5]。本文使用BGP流量实用程序，以捕捉跨度两周的BGP路由可用性。地理定位和国别分析显示，伊朗断网使网关可达性下降了近85%（11月14日为1120个网关，11月20日为173个网关）。从多个全球有利点对BGP可达性的进一步比较揭示了许多不一致之处，表明了伊朗可能对其他国家的IP地址进行了全国范围的过滤。北美和澳大利亚的BGP节点无法与阿富汗等国通信，而南美和非洲的BGP节点却没有收到相同的连接错误。
  * 对全球比特币交易所的影响分析 
对比特币加密货币市场的分析显示，因2019年11月伊朗互联网的关闭，成功交易大幅减少。近几年来，随着全球矿商和交易所的迅速扩张，全时外汇市场出现了爆炸性增长，出现了提供纯粹的“在线”网络测量的体系。全球大约25%的比特币交易被切断（11月14号的350023笔交易，11月17日的264370笔交易）。如此大规模的断网导致加密交易的大量延迟，用于存储暂停事务的内存池聚合内存突然膨胀（最大等待大小达到89770655字节）。
本文的其余部分如下。下一节列举了我们的数据汇总和方法，第3节报告了我们的结果，提供了伊朗互联网关闭的详细测量。第4节简要回顾了相关的工作，第5节总结了本文的贡献，同时指出了一些未来感兴趣的话题。
### 2.方法和数据汇总
在这里，我们讨论为本文汇编的各种数据源，以及进行大规模网络流量测量所采用的方法。
#### 2.1 IBR集合
为了提供一个宏观的、互联网规模的IBR视角，我们使用了由应用互联网数据分析中心（CAIDA）运营的a/8网络运动传感器。CAIDA网络运动传感器由超过1600万个分配的IP地址组成，可以路由，但不提供任何服务。在此之前，收集到的网络流量是未经请求的，并且通常是由入侵设备接入互联网空间以试图传播而产生的。这样一个广泛的网络运动传感器提供了非常好的可视化主动互联网流量。CAIDA传感器每天收集大约3.6
TB的网络流量。监测近两周的全球IBR（2019年11月14日- 11月25日），该传感器在全球范围内捕获了近50TB全球生成的IBR-提供了与伊朗互联网关闭相关的综合数据集。
#### 2.2 推断主机节点
接下来，开发了Treshold Random
Walk（TRW）探测算法[6]，用于提取压缩源地址生成的包流。类似于Rossow[7]所提议的方法。TRW算法识别聚合IBR中的恶意端口扫描。为了确认这些主机有意扫描网络运动传感器，并且收集的流量不是配置错误的产物，这些设备被描述为在300秒的时间间隔内发送64个数据包。我们还使用各种公开的列表筛选出典型的良性扫描仪。如果在该时间间隔内未收到任何数据包，并且未满足数据包阈值，则流将被丢弃，并且不会被视为受到攻击/未经请求的主机。从收集到的IBR中，使用TRW算法发现了大约850000个不同的，全球范围内每天扫描的主机。
#### 2.3 应用指纹技术的物联网设备
在发现受影响的主机后，进一步分析将物联网设备与发现正在扫描的非物联网设备进行分类。为了实现这一点，本文使用了Pour等人开发的技术。在被动收集的横幅上操作一组学习算法，并结合主动探测。该技术使用了广泛的功能集，包括IP/TCP数据包头字段和TCP选项[10]。这样的分组信息容易从IBR数据中获得，并且通过主动收集服务横幅能够进一步增强。该技术进一步对每个识别的IP地址进行即时反向扫描，以探测近50个端口和服务，这些扫描旨在检索服务横幅和应用程序级协议详细信息（例如HTTP(s)、TELNET、
SMTP(s)、SSH、FTP等）。不安全的物联网设备通常会对此类扫描作出响应，以包含重要操作系统信息（例如embedded、RouterOS、FritzOS）的基于文本的横幅进行响应，以便在物联网设备指纹识别期间使用。读者如果对所使用技术及其详细操作方法感兴趣，请参阅[8,9]。
本文提出了一种Random
Forest（RF）分类器作为所使用的技术的一部分，该技术每天识别超过250000个全球和16000个伊朗物联网设备。采用浅层机器学习分类器（如RF模型）可减少处理时间和复杂性，同时提供准确的特征和可解释的特征集。
#### 2.4 调查AS可达性
在对全球被使用的设备进行指纹识别后，我们采用了二维方法纵向测量其可达性。首先，使用MaxMind Ge-oLite
2数据库对所使用的TRW算法确定的受影响的主机进行地理定位。确定了位于伊朗IP地址以及邻国（如阿富汗、土耳其等）的网络块。发现由将近150个伊朗的网关托管这种被破坏的设备。接下来，我们通过使用CAIDA的BGPStream框架来细化测量[5]。BGPStream框架由多国节点组成，不断地扫描Internet空间以寻找可使用的网关（例如/24网络）。这些扫描检索到的信息包括直接从响应路由器、其路由表和相邻对等方检索到的BGP路由。
![
](https://images.seebug.org/content/images/2021/06/c9a8be0a-ecf0-499f-8226-37288362bdb6.png-w331s)
图1:扫描互联网的受影响的物联网设备和非物联网（桌面）机器的总数
通过BGP探测发现了1000多个位于伊朗的网关，在伊朗断网期间下降到略低于200的低点。
#### 2.5 CAIDA IODA项目
我们通过分析和检验从CAIDA的IODA项目中获得的测量数据来验证我们的发现[11]。IODA项目通过分析IBR、进行ICMP扫描和执行BGP分析以进行操作监控，提供全面的网络测量。IODA发布的数据提供伊朗互联网关闭的详细测量，且通过补充网关水平和地理结果，对本文的结论作出了贡献。
### 3.实证结果
为了阐明伊朗断网的影响，我们论证说明伊朗互联网的状况。这一部分列举了对伊朗互联网空间进行的多维测量。