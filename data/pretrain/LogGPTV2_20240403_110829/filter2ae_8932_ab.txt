[针对NFS的渗透测试](https://www.freebuf.com/articles/network/159468.html)
简单来说就是两步走：  
`showmount -e `  
然后挂载到本地
    mkdir 
    mount -t nfs :/ / -o nolock
这个点真的能拿蛮多数据的  
后面就不贴图了...
## 弱密码啊弱密码
真的好多好多弱密码！
小技巧就是  
验证爆破用户名的方法就是看response包里的返回结果...比如存在用户名但是密码不对，就会显示`用户名和密码不匹配`，但是如果没有用户名就会显示`不存在用户名`  
然后先根据返回包找到合适的用户名，再用字典有针对性的爆破该用户名的密码。如果没有回显可以通过 **忘记密码**
等选项来进一步测试，找回过程中如果说用户正确就会进入下一步操作，比如发送短信验证码，如果说没有用户就不会进入下一步操作
首先一般弱密码发生在如下几个地方：
  1. 没有限制登录失败次数的登录框
  2. 没有验证码或者验证码可以绕过(比如采用前端校验)的登录框
经过渗透测试统计和分析，将弱密码大致分为以下几个情况
  1. js里有注释掉的测试账号密码
  2. 各种登录界面，各种后台存在测试账号，且可以看到敏感数据（这就可能是为什么test test 可以进去的原因吧）
  3. 改了管理后台页面的所有弱密码，但是在其他地方，比如办公系统等，有员工没有改自己的登录密码，经过爆破可以登录员工账号
  4. 很多公司采用的系统是外部开发的，外部开发的时候有测试账号是弱密码，但是可能交接过程中存在一些问题，导致这边公司根本就不知道有这个账号密码
  5. 很多设备，比如内网里面的防火墙，直接使用了出厂默认的密码
  6. 大家都比较懒，都不想注册很长的密码，然后可能又觉得11111这种不合适，所以就有了那种键盘连键，如qwe123之类的，导致跑一个字典出一堆账号密码
网上大佬收集的，分享给大家
    天融信防火墙，不需要证书 登录地址:https://192.168.1.254 用户名:superman 密码:talent 技术支持热线：8008105119
    天融信防火墙，不需要证书 登录地址:https://192.168.1.254：8080 用户名:superman 密码:talent！23 遇到设备需要把旧设备配置备份下来，再倒入新设备基于console口登陆，用户名，密码跟web界面一致 system config reset 清除配置 save 保存 
    联想网御防火墙，需要证书（最好用IE浏览器登录） 登录地址:https://10.1.5.254:8889 用户名:admin 密码:leadsec@7766、administrator、bane@7766 技术支持热线：4008107766 010-56632666
    深信服防火墙（注安全设备管理地址不是唯一的） https://10.251.251.251
    https://10.254.254.254 用户名：admin 密码：admin 技术支持热线：4006306430
    启明星辰 https://10.1.5.254:8889 用户名：admin 密码：bane@7766
    https://10.50.10.45:8889 用户名：admin 密码：admin@123 电脑端IP：10.50.10.44/255.255.255.0 技术支持热线：4006243900
    juniper 登录地址:https://192.168.1.1 用户名:netscreen 密码:netscreen
    Cisco 登录地址:https://192.168.0.1 用户名:admin 密码:cisco
    Huawei 登录地址:http://192.168.0.1 用户名:admin 密码:Admin@123
    H3C 登录地址:http://192.168.0.1 用户名:admin 密码:admin 技术支持热线：4006306430
    绿盟IPS https://192.168.1.101 用户名: weboper 密码: weboper 配置重启生效
    网神防火墙GE1口 https://10.50.10.45 用户名：admin 密码：firewall 技术支持热线：4006108220
    深信服VPN： 51111端口 delanrecover
    华为VPN：账号：root 密码：mduadmin
    华为防火墙： admin Admin@123 eudemon
    eudemon Juniper防火墙： netscreen netscreen
    迪普 192.168.0.1 默认的用户名和密码（admin/admin_default)
    山石 192.168.1.1 默认的管理账号为hillstone，密码为hillstone
    安恒的明御防火墙 admin/adminadmin
    某堡垒机 shterm/shterm
    天融信的vpn test/123456
## MS17-010能验证但是反弹不了会话
永恒之蓝这种东西之前跟着网上的复现过...网上复现文章通常也是在C段然后MSF一把梭...
所以真正当我遇到这个漏洞的时候，用 验证模块（use
auxiliary/scanner/smb/smb_ms17_010）验证成功之后就以为成功了，但是利用攻击模块却并不能反弹会话
然后去了t00ls发了一篇求助帖 [[【求神问卜】]
求问关于内网中ms17-010的利用](https://www.t00ls.net/thread-52382-1-1.html)
下面的回答都很大程度上帮助到了我...
> 03使用永恒浪漫攻击，不要使用永恒之蓝，没用。请使用原版，不要用msf的。
然后我了解了一下永恒之蓝的历史，和 NSA 原版攻击工具
具体可看一下我转载的博客 [Shadow Brokers - From git clone to
Pwned](https://p2hm1n.github.io/2019/08/16/Shadow-Brokers-From-git-clone-to-Pwned/#more)
还有网上一个大师傅的复现真的非常详细（膜orz）  
[永恒之蓝、永恒浪漫、永恒冠军复现](http://note.cfyqy.com/posts/caffa366.html)
很可惜的是因为一些时间的原因最后也没能成功利用，很多时候跟漏洞都是一个擦肩而过的距离
## 真的没办法进行sql注入了吗？
这个点给我的感触蛮深的，学sql注入的时候知道sql注入发生的点是： **增 删 改 查** ，一切与数据库交互的地方都有可能进行sql注入
但是真正实际操作的时候满脑子都是登录框的用户名密码，甚至为了追求速度，养成了指定参数这种不好的习惯，所以连着很久都没有挖出sql注入
最后由于网站的特殊性，该网站忘记密码界面需要提供注册界面的手机号（emm不方便截图...），最后在POST包里面的一个不显眼的参数存在sql注入...
给的体会就是渗透过程中千万不要偷懒，所有get，post的参数凡是你觉得能够和数据库进行交互的，能手测就手测，不能手测就用sqlmap跑
细心一点，每个地方都测试一下
利用了sqlmap最终跑出用户名密码...  
还有一点小感悟是 XFF 头注入是真的存在，渗透测试本身的过程就是把不可能的事变为可能，虽然我之前也一直觉得讲 XFF
头的注入是为了绕过gpc的过滤，需要很巧合才能完成，但是在测试一个办公系统的时候，开发跟我说到他们需要记录一下每个人登录的IP。所以为什么构成这种漏洞也就不奇怪了
## cookie也敢明文传输用户名密码？
这个也是真的第一次遇到，教科书般的漏洞...
首先用 **弱密码** 进入了网站（手动滑稽）
然后在测试其他漏洞的时候突然发现cookie使用明文传输了用户名密码
第一个想到的当然是XSS，XSS如果能够打到cookie那么将会是很严重的问题...
找了一下午XSS，终于在一个参数那寻找到了一个反射型XSS，且没有设置httponly，最后成功打到了经过base64位加密的用户名密码
## Redis未授权访问
Redis因配置不当可以导致未授权访问，被攻击者恶意利用。当前流行的针对Redis未授权访问的一种新型攻击方式，在特定条件下，如果Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器，可导致服务器权限被获取和数据删除、泄露或加密勒索事件发生，严重危害业务正常服务。
部分服务器上的Redis 绑定在 0.0.0.0:6379，并且没有开启认证（这是Redis 的默认配置）
这个真的蛮多公司都存在，没有接触过的老哥建议补充一下...
Freebuf上有篇文章写得很详细...
[Redis未授权访问详解](https://www.freebuf.com/column/158065.html)
一把梭进去还是 root 权限...
由于全是敏感数据就不贴图了
## 各种中间件的漏洞
各种中间件的漏洞的话在各大论坛都有很详细的文章，大家可以自行查阅
一点小感悟就是，很多公司用的版本真的很老很老，而且几乎不打补丁...虽然可能有的时候 IIS
，Nginx那些解析漏洞没办法使用(真的挺难遇到上传点的)...但是如果看到老一点版本的 JBoss 、 weblogic 就可以利用很多工具了
以下提供一些好用的工具
[Java反序列化集成工具](https://www.freebuf.com/sectool/92011.html)
[【技术分享】Java RMI 反序列化漏洞检测工具的编写](https://www.anquanke.com/post/id/85681)
[WeblogicScan](https://github.com/dr0op/WeblogicScan)
# 写在最后
渗透测试中，工具，经验，还有灵活的思维都是很重要的东西（虽然自己一样也没有）...
有的时候连上了shell之后，然后如同机器人一般的反弹shell，执行 `whoami`，发现权限不够就进一步查看系统信息，接着尝试各种提权的操作。其实可能
**有的时候这些操作没有必要** ，可能最终的目标都是拿到一些信息或者数据。所以根据实际情况判断一下是否需要提权，是一个提高效率不错的办法。
**此外，一个`cat ~/.bash_history` 命令有时候可能会给你带来一些惊喜**
最后，根据信安之路的[史上最强内网渗透知识点总结](https://mp.weixin.qq.com/s/U2MqcjA_YmMlajJzvDCZZw),补充了里面的一点东西。  
分享给大家
[内网渗透之常用命令小结](https://p2hm1n.github.io/2019/08/16/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%B0%8F%E7%BB%93/)
**本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担。**