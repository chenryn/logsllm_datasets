# 【技术分享】22款品牌路由器的漏洞分布报告
##### 译文声明
本文是翻译文章，文章来源：sicherheitsforschung-magdeburg.de
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
译者：[紫曦归来](http://bobao.360.cn/member/contribute?uid=2937531371)
预估稿费：260RMB
投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿
**摘要**
随着网络犯罪手法不断翻新，家用路由器近日也成为网络攻击的新目标。事实上，家用路由器的确存在着大量的安全漏洞。Álvaro Folgado
Rueda等多名网络安全专家近日撰写了一份报告，深入分析SOHO路由器的安全隐患，并针对家用路由器的最新攻击源展开研究。研究发现，22个知名品牌的路由器存在60余个尚未公开的安全漏洞。这也意味着路由器厂商仍须进一步提升其产品的安全性能。该报告中罗列了一系列存在于家用路由器中的安全漏洞，如果上述漏洞被黑客利用，造成的后果将不堪设想。
**1、引言**
****
随着信息时代的到来，小办公室/家庭办公室（Small office Home
office，SOHO）的工作方式，因其具有传统办公无法比拟的灵活性、创造性等优点很快被社会大众所接受。SOHO计算机和网络的普及促使家庭办公逐渐成为当今一种白领时尚，也引领其一股SOHO文化热。
SOHO路由器，即小办公室家庭办公室用的路由器是实现家庭办公必不可少的装备。如果
SOHO路由器中存在漏洞将大大影响整个家庭网络系统的安全性，同时也对用户的隐私造成极大威胁。
在过去的几年时间内，也有C. Heffner等专家针对SOHO路由器的安全问题进行了相关研究。这些研究的目标主要是：
（1）通过寻找可能存在的漏洞问题，评估当前网络安全等级。
（2）针对新的攻击源展开研究
（3）研发能够检测出漏洞的工具。
（4）为后续研究提出方法论依据。
路由器的制造商以及互联网服务提供商也将针对该领域研究成果对产品进行安全升级。
**2、路由器相关知识**
****
所有路由器都为终端用户提供了各种形式的配置方式。
（1）Web配置界面（Web
Interface）：一个用户友好型的Web配置界面有助于用户随时进行设备更改和调试（如图1所示）。当然，访问Web配置界面需要进行身份验证。
图1
（2）命令行界面（command-line
interface）：通过命令行界面用户同样可以对路由器进行操作、设置。命令行界面可通过终端模拟器来访问，用户可利用计算机上已经安装的终端模拟器，在终端模拟器的窗口键入命令并获得从路由器返回的信息（如图2所示）。
图2
路由器除了可以使用上述两种方式进行配置外，还可使用诸如FTP和SMB服务器等方式进行配置。此外，路由器还可采用“即插即用”（Universal Plug
and Play， **UPnP**
）方式进行配置。但使用FTP或Telnet等方式进行配置存在一定安全隐患，更安全的方法是选择更为高级的SFTP和SSH协议。值得注意的一点是，纳入本研究的大部分路由器都默认启用了UPnP协议，
**从而可以允许未经身份验证的攻击者更改路由器的关键配置设置** 。
大多数路由器所提供的服务对于用户来说都是多余且无用的， **这些功能有时反而被黑客利用实施网络攻击**
。此外，研究显示路由器开放端口的数量过多，这一点即使对于有远程WAN的连接来说也是过多了。
研究发现，路由器还普遍存在一个安全隐患，即使用公开的默认密码就可以进入路由器配置界面。（如图3所示）本研究中纳入评估的所有路由器均未使用随机生成的字符串作为默认密码，而是使用了公开的默认密码，而这些用户又不修改默认密码，这使得黑客对路由器实施网络攻击变得更加容易。
图3
**3、安全漏洞**
****
通过分析路由器存在的各类安全漏洞，研究发现黑客从不同的位置对路由器实施攻击：
（1）有线连接到受害者的局域网内。在这一案例中，攻击者使用以太网电缆连接到受害者的局域网，并对其实施攻击。
（2）无线连接到受害者的局域网内。这种形式的网络攻击经常发生在提供免费Wi-Fi热点的路边餐厅或咖啡店。
（3）远程攻击。虽然攻击者在受害者的本地网络之外，但用户使用了存在漏洞的路由器，这使他们极易遭受网络攻击。远程攻击可针对某一个特点目标进行，同时也可以通过僵尸网络等形式无目标地感染多台设备。
攻击者可利用远程漏洞，例如利用公开的路由器连接端口密钥，从而利用那些只能在受害者本地电脑设备利用的漏洞。研究发现，目前广泛使用的路由器存在着多种漏洞。
**3.1 跨站请求伪造（CSRF）**
跨站请求伪造（Cross-site request
forgery）通过向受害者发送特定的恶意链接来更改路由器的配置设置。攻击者常使用远程攻击的方式更改合法的DNS设置。从而使得攻击者可以掌握受害者的隐私设置，并将浏览器请求指向恶意网站，并最终构建一个僵尸网络。
当受害者已经登录导路由器的Web配置界面后，该攻击才能顺利进行。但是，Web配置界面的登录密码可以嵌入到恶意URL中。如果管理员（administrator）的密码从未被更改过（这一点在我们研究的案例中极为普遍），则攻击就可以顺利进行。如图4所示，部分浏览器将针对登录尝试弹出警告消息框；但诸如Google
Chrome浏览器等常用的浏览器均未显示任何警告。如此，攻击行动可以在受害者毫无察觉的情况下进行。
图4
例如，以下URL利用公共默认凭证1更改了Observa Telecom
AW4062路由器的DNS设置。通过BitLy和OwLy等URL短网址工具，链接可以变得很短或者被混淆。如图5所示，缩短的链接容易被用户忽视。
图5
同样，包含恶意参数的网站也可以通过这种做法蒙混过关，如图6所示。
图6
通过共享社交网站上的链接，或者使用一些能够鼓励用户打开恶意URL的社会工程学技巧，可以增强网络攻击的影响面。
**3.2 持久型跨站脚本（XSS）**
XSS攻击通常是指黑客在Web配置界面植入恶意脚本，从而对用户实施会话劫持（Session hijacking）和感染浏览器（browser
infection）的攻击。攻击者可通过向受害者发送恶意链接实施远程攻击（与CSRF攻击类似，如图7所示）；如果用户的密码从未更改过，攻击者可对其实施本地攻击（如图8所示）。
图7
图8
在被发现的XSS攻击中，脚本代码均会保留在Web配置界面中。根据路由器型号的不同，脚本执行可能会在注入后立即进行，也可能在访问某个网页（如主页）时进行。部分输入栏中只能输入有限个数的字符。为了避免这种限制，
**BeEF** （The Browser Exploitation Framework
project）是比较流行的web框架攻击平台。通过XSS这个简单的漏洞，BeEF可以通过一段构造好的javascript脚本控制目标主机的浏览器，通过浏览器拿到各种信息并且扫描内网信息，同时能够配合metasploit进一步渗透主机，强大的有些吓人。下面的URL显示了使用BeEF
hooks2进行XSS开发的示例。图9所示就是受感染的浏览器。
图9
**3.3未经身份验证的跨站脚本攻击**
在特殊情况下，执行脚本代码注入可以在没有任何登陆的情况下实施本地攻击。这主要是通过发送一个包含恶意脚本的动态主机配置协议（DHCP）数据单元（PDU）来实现的，如图10所示，当发送了一个具有有效参数的PDU后（例如客户端MAC地址或恶意主机名），路由器将回复一个DCHP
ACK，之后恶意脚本将植入到Connected Clients的桌面。
图10