**通信隐私：**
流行的SIM卡服务具有集中性，因此容易受到各种隐私问题的影响。首先，所有用户通信（包括组通信和一对一通信）都是在SIM卡提供商运行的服务器的帮助下建立的；因此，SIM提供商可以访问所有通信的元数据（即，与谁通话的人）以及频道所有权和成员关系。最近的工作建议使用各种加密技术，例如私有集相交，以保护隐私不受中央运营商的影响，例如，用于联系人发现。其次，即使IM服务提供商不是恶意的，其服务器也可能受到恶意攻击者的攻击或受到政府的传唤，因此使客户端通信元数据面临风险。
在传统的SIM服务中，用户通信是端到端加密的，即在客户端和SIM服务器之间进行加密。在此类服务中，SIM提供商不仅可以看到用户的通信元数据，还可以看到他们的通信内容。最近，Signal和WhatsApp等主要的SIM提供程序已经开始支持端到端加密，因此可以保护SIM提供程序的通信内容。尽管某些SIM服务的差强人意的实现方式导致了各种安全漏洞和元数据泄漏年龄威胁，但尽管它们使用了端到端加密，例如通过Telegram中的开/关通知和最近的WhatsApp漏洞提供对黑客的远程访问。
**审查：**
流行的SIM服务的集中式体系结构使其审查变得微不足道：审查员可以轻松地将少数IP地址或DNS记录列入黑名单，以阻止与目标SIM服务的所有通信。取消审查的SIM卡服务的一种直接对策是使用标准的规避系统，例如VPN和Tor。可选地，主要的SIM服务允许使用规避代理来避免阻塞，例如，在伊朗和俄罗斯当局进行审查后，该功能已被内置在Telegram软件的最新版本中。
## 0x03 Attack & Threat Model
在本文中，演示了对IM服务的基本攻击：适用于所有主要的IM服务，而不是由于错误的软件实现（可以通过软件更新来修复）引起的，攻击是由仅执行流量分析的攻击者执行的。在这种情况下，攻击者无需破坏或胁迫SIM提供程序，也无需完全阻止目标IM服务。相反，攻击者执行流量分析以标识目标IM通信的参与者，以便惩罚所标识的IM参与者或选择性地阻止目标通信。尤其是，攻击者可以使用流量分析来识别有争议的政治或社交IM渠道的管理员，并迫使他们关闭其频道。或者，攻击者可以使用流量分析攻击来识别有争议的IM频道的成员，从而有选择地破坏对目标频道的访问。
###  A.参与者介绍
攻击者是监视组织，例如由情报机构，目标是识别目标IM对话的成员或管理员（所有者）（的IP地址）。
目标IM对话可以是关于政治或社会敏感主题的公共IM频道（例如聊天室），也可以是目标用户（例如持不同政见者和新闻工作者）之间的私人IM对话。
为了使攻击者能够进行攻击，他需要例如通过窃听被监视用户的ISP来拦截被监视IM用户的（加密）网络流量。
###  B.威胁模型
假定托管IM服务是第二部分中定义的安全IM（SIM）服务。因此，攻击者在执行攻击时不会利用目标SIM服务的任何安全漏洞。例如，SIM系统不会将其客户端的IP地址（或其他敏感的元数据）泄漏给攻击者。此外，假定IM客户端和IM服务器之间的所有流量都将通过强加密进行加密。最后，SIM服务的运营商在确定目标成员时不与攻击者合作。
###  C.如何进行攻击
上图说明了攻击的设置。假设攻击者旨在标识特定IM渠道C的成员/管理员。
**攻击者的任务：** 对于任何目标频道C，攻击者都需要获取有关该频道流量的一些地面事实。这可以通过三种方式完成：
（1）如果C是公开（公开）频道，则攻击者加入该频道（作为成员）并记录在C上发送的消息及其元数据（例如消息的时间和大小）。
（2）攻击者已加入C，并且能够向C发布消息。如果C是一个封闭的组，可以使每个成员都具有发布消息的能力，则可能发生这种情况，或者这可能是因为攻击者已经获得了C的管理员角色（例如，监视者已在政治敏感主题上创建了一个频道以识别目标记者，或者攻击者已获得敏感频道的所有者并滥用了其帐户）。在这种情况下，不仅攻击者可以记录发布到C的消息，而且他可以以自己想要的（明显）流量模式将自己的消息发布到C。
（3）攻击者无法加入C作为成员/管理员，但他已经确定C的成员/管理员之一（的IP地址）。攻击者窃听所识别出的（加密）网络流量成员并记录所标识成员的流量模式。
**攻击者的窃听：**
攻击者监视IM用户的（加密）网络流量，以识别目标IM频道C的成员/管理员（的IP地址）。这可以通过攻击者窃听ISP或IXP的网络流量来执行。可替代地，也许可以在获得窃听令之后，攻击者窃听特定个人（例如怀疑的活动家）的网络流量。
**攻击者做出决策：** 攻击者使用一种检测算法将窃听用户的流量模式与目标渠道C的真实流量模式进行匹配。
###  D.相关的流量分析攻击
先前的工作研究了不同环境下的各种流量分析攻击：
流相关性（Flow correlation
），攻击者尝试通过关联混淆的网络流的流量特性（即数据包的时间和大小）来链接混淆的网络流。流量相关性已作为攻击Tor等匿名系统的方式进行了特别研究，例如Tor：攻击者可以链接Tor连接的入口和出口段（例如，由恶意的Tor
guard和出口中继观察到）关联入口和出口段的流量特征。最近，Nasr等人
[6]引入了一种基于深度学习的技术，称为DeepCorr，该技术可学习一种与Tor流匹配的相关函数，并在流相关性方面优于以前的统计技术。
流水印（Flow watermarking
）是上述流相关攻击的动态版本。在流水印中，攻击者通过对流量特征施加轻微干扰，例如通过延迟数据包，将无法感知的信号编码为交通模式。与常规（被动）流相关技术相比，流水印具有更高的抗噪声能力，但需要实时修改网络流量，并且容易受到检测攻击。
在网站指纹（WF，Website
fifingerprinting）中，攻击者拦截某些受监视用户的网络连接，并尝试将拦截的连接模式与一组目标网页进行匹配。这与流量相关性不同，因为流量相关性会拦截目标连接的两端。
WF被专门研究为对Tor的攻击。现有的WF技术利用各种机器学习算法，例如k-NN，SVM和深度神经网络来设计分类器，以将监视的连接与目标网页进行匹配。
交叉攻击（Intersection
Attacks）试图通过匹配用户的活动/不活动时间段来危害匿名通信。例如，Kesdogan等[7]将匿名系统建模为抽象的阈值混合，并提出了公开攻击，其目的是为任何目标发送者学习潜在的接收者。
Danezis等[8]通过提出攻击的统计版本，使攻击在计算上更加实用。
侧信道攻击另一类流量分析攻击旨在从互联网服务的加密网络流量中泄漏敏感信息。例如，Chang等[9]从加密的Skype流量推断语音活动，Chen等
[10]演示了在线服务如何泄漏敏感的客户活动，Schuster等人 [11]识别加密的视频流。
本文流量分析方向：本文提出的攻击在本质上与流量相关技术的场景最接近。与流量相关性设置类似，在场景中，攻击者拦截实时目标流（例如，通过加入有争议的IM频道），并尝试将其与网络其他部分中监视的流量的流量模式进行匹配（以便能够以标识目标渠道的成员或管理员的IP地址）。但是，由于IM场景中的流量模型和通信噪声完全不同，因此不能简单地将现有的流量相关技术应用于IM场景。因此，设计了针对IM应用程序特定场景量身定制的流相关算法。为此，首先对IM服务中的流量和噪声行为进行建模，然后在此基础上针对特定场景设计量身定制的流量相关算法。
请注意，可以选择使用交叉攻击文献中的技术来设计IM服务的流量分析攻击。但是，流量相关比交叉攻击要强大得多，因为流量相关不仅利用了用户的在线/离线行为，还利用了用户在线时的通信方式。同样，典型的IM客户端往往会在很长的时间间隔内保持在线。因此与基于流相关的攻击相比，期望基于相交的攻击的可靠性大大降低（或需要很长时间的观察才能达到可比的可靠性）。
## 0x04 Characterizing IM Communications
首先描述IM流量并为其推导统计模型。将使用模型找到设计的攻击算法的分析界限，以及生成将在某些实验中使用的综合IM流量。
###  A.主要IM消息
IM服务允许其用户发送不同类型的消息，最常见的是文本，图像，视频，文件和音频消息。 IM消息通过以下主要通信形式之一在用户之间进行通信：
•直接消息是IM用户之间的一对一通信。如前所述，流行的IM服务是集中的，因此所有直接消息都通过IM提供程序的服务器中继，并且除非部署了端到端加密，否则服务器可以看到通信内容。
•专用（封闭）组通信是在多个用户之间进行的通信。分组时，每个成员都可以发布消息并阅读其他成员发布的消息。每个组都有创建该组的管理员成员，并具有管理用户和消息的能力。用户需要邀请才能加入封闭的小组。
•公共（开放）组通信，也称为渠道，是一种广播形式的通信，其中一个或多个管理员可以发布消息，而成员只能阅读这些帖子。用户无需邀请即可加入频道。