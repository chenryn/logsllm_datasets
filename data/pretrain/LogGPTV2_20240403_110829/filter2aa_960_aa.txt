Steele, 
Patten, and 
Kottmann
Black Hat Go
Go Programming 
for Hackers and Pentesters 
Go Programming for Hackers and Pentesters
Black Hat Go explores the darker side of Go,
the popular programming language revered 
by hackers for its simplicity, efficiency, and 
reliability. It provides an arsenal of practical 
tactics from the perspective of security prac-
titioners and hackers to help you test your 
systems, build and automate tools to fit your 
needs, and improve your offensive security 
skillset, all using the power of Go.
You‚Äôll begin your journey with a basic over-
view of Go‚Äôs syntax and philosophy and start 
to explore examples that you can leverage for 
tool development, including common network
protocols like HTTP, DNS, and SMB. You‚Äôll then 
dig into various tactics and problems that pen-
etration testers encounter, addressing things 
like data pilfering, packet sniffing, and exploit 
development. You‚Äôll create dynamic, pluggable 
tools before diving into cryptography, attack-
ing Microsoft Windows, and implementing 
steganography.
You‚Äôll learn how to:
üêπ Make performant tools that can be used for 
your own security projects
üêπ Create usable tools that interact with 
remote APIs
üêπ Scrape arbitrary HTML data
üêπ Use Go‚Äôs standard package, net/http, for 
building HTTP servers 
üêπ Write your own DNS server and proxy
üêπ Use DNS tunneling to establish a C2 channel 
out of a restrictive network
üêπ Create a vulnerability fuzzer to discover an 
application‚Äôs security weaknesses
üêπ Use plug-ins and extensions to future-proof 
products
üêπ Build an RC2 symmetric-key brute-forcer
üêπ Implant data within a Portable Network 
Graphics (PNG) image.
Are you ready to add to your arsenal of secu-
rity tools? Then let‚Äôs Go! 
About the Authors
Tom Steele, Chris Patten, and Dan Kottmann 
share over 30 years in penetration testing and 
offensive security experience, and have deliv-
ered multiple Go training and development 
sessions. (See inside for more details.)
‚ÄúEverything necessary to get started with 
Go development in the security space‚Äù
‚Äî HD Moore, Founder of the Metasploit Project and 
the Critical Research Corporation
THE FINEST IN GEEK ENTERTAINMENT‚Ñ¢
www.nostarch.com
‚ÄúI LIE FLAT.‚Äù This book uses a durable binding that won‚Äôt snap shut.
FSC FPO
Price: $39.95 ($53.95 CDN)
Shelve In: COMPUTERS/SECURITY
Tom Steele, Chris Patten, and Dan Kottmann
Foreword by HD Moore
Black Hat Go
BLACK HAT GO
BLACK HAT GO
Go Programming for 
Hackers and Pentesters
by Tom Steele, Chris Patten,  
and Dan Kottmann
San Francisco
BLACK HAT GO. Copyright ¬© 2020 by Tom Steele, Chris Patten, and Dan Kottmann.
All rights reserved. No part of this work may be reproduced or transmitted in any form or by any means, 
electronic or mechanical, including photocopying, recording, or by any information storage or retrieval 
system, without the prior written permission of the copyright owner and the publisher.
ISBN-10: 1-59327-865-9
ISBN-13: 978-1-59327-865-6
Publisher: William Pollock
Production Editor: Laurel Chun
Cover Illustration: Jonny Thomas 
Interior Design: Octopod Studios
Developmental Editors: Frances Saux and Zach Lebowski
Technical Reviewer: Alex Harvey
Copyeditor: Sharon Wilkey
Compositor: Danielle Foster
Proofreader: Brooke Littrel
Indexer: Beth Nauman-Montana
For information on distribution, translations, or bulk sales, please contact No Starch Press, Inc. directly:
No Starch Press, Inc.
245 8th Street, San Francisco, CA 94103
phone: 1.415.863.9900; PI:EMAIL 
www.nostarch.com
Library of Congress Cataloging-in-Publication Data
Names: Steele, Tom (Security Consultant), author. | Patten, Chris, author. 
   | Kottmann, Dan, author.  
Title: Black Hat Go : Go programming for hackers and pentesters / Tom 
   Steele, Chris Patten, and Dan Kottmann.  
Description: San Francisco : No Starch Press, 2020. | Includes 
   bibliographical references and index. | Summary: "A guide to Go that 
   begins by introducing fundamentals like data types, control structures, 
   and error handling. Provides instruction on how to use Go for tasks such 
   as sniffing and processing packets, creating HTTP clients, and writing 
   exploits."-- Provided by publisher.  
Identifiers: LCCN 2019041864 (print) | LCCN 2019041865 (ebook) | ISBN 
   9781593278656 | ISBN 9781593278663 (ebook)  
Subjects: LCSH: Penetration testing (Computer security) | Go (Computer 
   program language) 
Classification: LCC QA76.9.A25 S739 2020  (print) | LCC QA76.9.A25  (ebook) 
   | DDC 005.8--dc23 
LC record available at https://lccn.loc.gov/2019041864
LC ebook record available at https://lccn.loc.gov/2019041865
No Starch Press and the No Starch Press logo are registered trademarks of No Starch Press, Inc. Other 
product and company names mentioned herein may be the trademarks of their respective owners. Rather 
than use a trademark symbol with every occurrence of a trademarked name, we are using the names only 
in an editorial fashion and to the benefit of the trademark owner, with no intention of infringement of the 
trademark.
The information in this book is distributed on an ‚ÄúAs Is‚Äù basis, without warranty. While every precaution 
has been taken in the preparation of this work, neither the authors nor No Starch Press, Inc. shall have any 
liability to any person or entity with respect to any loss or damage caused or alleged to be caused directly or 
indirectly by the information contained in it. 
About the Authors
Tom Steele has been using Go since the version 1 release in 2012 and was 
one of the first in his field to leverage the language for offensive tooling. 
He is a managing principal research consultant at Atredis Partners with 
over 10 years of experience performing adversarial and research-based 
security assessments. Tom has presented and conducted training courses 
at numerous conferences, including Defcon, Black Hat, DerbyCon, and 
BSides. Outside of tech, Tom is also a Black Belt in Brazilian jiujitsu who 
competes regularly, both regionally and nationally. He owns and operates 
his own jiujitsu academy in Idaho.
Chris Patten is the founding partner and lead consultant of STACKTITAN, 
a specialized adversarial services security consultancy. Chris has been 
practicing in the security industry for more than 25 years in various capaci-
ties. He spent the last decade consulting for a number of commercial and 
government organizations on diverse security issues, including adversarial 
offensive techniques, threat hunting capabilities, and mitigation strate-
gies. Chris spent his latest tenure leading one of North America‚Äôs largest 
advanced adversarial teams.
Prior to formal consulting, Chris honorably served in the US Air 
Force, supporting the war-fighting effort. He actively served within the 
Department of Defense Special Operations Intelligence community at 
USSOCOM, consulting for Special Operations Groups on sensitive cyber 
warfare initiatives. Following Chris‚Äôs military service, he held lead architect 
positions at numerous Fortune 500 telecommunication companies, work-
ing with partners in a research capacity.
Dan Kottmann is a founding partner and lead consultant of STACKTITAN. 
He has played an integral role in the growth and development of the larg-
est North American adversarial consultancy, directly influencing technical 
trade craft, process efficiency, customer experience, and delivery qual-
ity. With 15 years of experience, Dan has dedicated nearly the entirety of 
his professional career to cross-industry, customer-direct consulting and 
consultancy development, primarily focused on information security and 
application delivery.
Dan has presented at various national and regional security confer-
ences, including Defcon, BlackHat Arsenal, DerbyCon, BSides, and more. 
He has a passion for software development and has created various open-
source and proprietary applications, from simple command line tools to 
complex, three-tier, and cloud-based web applications.
About the Technical Reviewer
Alex Harvey has been working with technology his whole life and got his 
start with embedded systems, robotics, and programming. He moved into 
information security about 15 years ago, focusing on security testing and 
research. Never one to shy away from making a tool for the job, he started 
using the Go programming language and has not looked back.
BR IE F CON T E N T S
Foreword by HD Moore  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . xv
Acknowledgments  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . xvii
Introduction  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . xix
Chapter 1: Go Fundamentals  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 1
Chapter 2: TCP, Scanners, and Proxies .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 21
Chapter 3: HTTP Clients and Remote Interaction with Tools  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 45
Chapter 4: HTTP Servers, Routing, and Middleware  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 77
Chapter 5: Exploiting DNS  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 103
Chapter 6: Interacting with SMB and NTLM  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 131
Chapter 7: Abusing Databases and Filesystems  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 153
Chapter 8: Raw Packet Processing  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 173
Chapter 9: Writing and Porting Exploit Code  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 187
Chapter 10: Go Plugins and Extendable Tools .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 217
Chapter 11: Implementing and Attacking Cryptography  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 233
Chapter 12: Windows System Interaction and Analysis  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 263
Chapter 13: Hiding Data with Steganography .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 295
Chapter 14: Building a Command-and-Control RAT  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 315
Index  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 331
CO N T E N T S IN DE TA IL
FOREWORD by HD Moore 
xv
ACKNOWLEDGMENTS 
xvii
INTRODUCTION 
xix
Who This Book Is For . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xx
What This Book Isn‚Äôt. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xx
Why Use Go for Hacking? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxi
Why You Might Not Love Go . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxi
Chapter Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxii
1 
GO FUNDAMENTALS 
1
Setting Up a Development Environment. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
Downloading and Installing Go . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
Setting GOROOT to Define the Go Binary Location. . . . . . . . . . . . . . . . . . . . 2
Setting GOPATH to Determine the Location of Your Go Workspace . . . . . . . . 2
Choosing an Integrated Development Environment . . . . . . . . . . . . . . . . . . . . 3
Using Common Go Tool Commands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
Understanding Go Syntax . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Data Types. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
Control Structures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
Concurrency. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
Error Handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
Handling Structured Data. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
2 
TCP, SCANNERS, AND PROXIES 
21
Understanding the TCP Handshake . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
Bypassing Firewalls with Port Forwarding . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Writing a TCP Scanner . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
Testing for Port Availability. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
Performing Nonconcurrent Scanning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
Performing Concurrent Scanning. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Building a TCP Proxy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Using io.Reader and io.Writer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Creating the Echo Server . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Improving the Code by Creating a Buffered Listener . . . . . . . . . . . . . . . . . . 37
Proxying a TCP Client . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
Replicating Netcat for Command Execution . . . . . . . . . . . . . . . . . . . . . . . . 40
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
x   Contents in Detail
3 
HTTP CLIENTS AND REMOTE INTERACTION WITH TOOLS 
45
HTTP Fundamentals with Go . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Calling HTTP APIs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Generating a Request . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Using Structured Response Parsing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Building an HTTP Client That Interacts with Shodan . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Reviewing the Steps for Building an API Client . . . . . . . . . . . . . . . . . . . . . . 51
Designing the Project Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Cleaning Up API Calls. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
Querying Your Shodan Subscription . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
Creating a Client . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
Interacting with Metasploit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
Setting Up Your Environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
Defining Your Objective. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Retrieving a Valid Token . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
Defining Request and Response Methods . . . . . . . . . . . . . . . . . . . . . . . . . . 63
Creating a Configuration Struct and an RPC Method. . . . . . . . . . . . . . . . . . 64
Performing Remote Calls . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
Creating a Utility Program . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
Parsing Document Metadata with Bing Scraping . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
Setting Up the Environment and Planning. . . . . . . . . . . . . . . . . . . . . . . . . . 69
Defining the metadata Package . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
Mapping the Data to Structs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Searching and Receiving Files with Bing . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
4 
HTTP SERVERS, ROUTING, AND MIDDLEWARE 
77
HTTP Server Basics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
Building a Simple Server . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
Building a Simple Router . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
Building Simple Middleware . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
Routing with the gorilla/mux Package . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
Building Middleware with Negroni . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
Adding Authentication with Negroni . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
Using Templates to Produce HTML Responses . . . . . . . . . . . . . . . . . . . . . . . 88
Credential Harvesting. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Keylogging with the WebSocket API. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
Multiplexing Command-and-Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5 
EXPLOITING DNS 
103
Writing DNS Clients. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
Retrieving A Records . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
Processing Answers from a Msg struct . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
Enumerating Subdomains. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
Contents in Detail   xi
Writing DNS Servers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
Lab Setup and Server Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
Creating DNS Server and Proxy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
6 
INTERACTING WITH SMB AND NTLM 
131
The SMB Package . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
Understanding SMB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
Understanding SMB Security Tokens . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
Setting Up an SMB Session . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
Using Mixed Encoding of Struct Fields. . . . . . . . . . . . . . . . . . . . . . . . . . . 135
Understanding Metadata and Referential Fields . . . . . . . . . . . . . . . . . . . . 138
Understanding the SMB Implementation. . . . . . . . . . . . . . . . . . . . . . . . . . 139
Guessing Passwords with SMB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
Reusing Passwords with the Pass-the-Hash Technique . . . . . . . . . . . . . . . . . . . . . . . . 147
Recovering NTLM Passwords. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
Calculating the Hash. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
Recovering the NTLM Hash . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
7 
ABUSING DATABASES AND FILESYSTEMS 
153
Setting Up Databases with Docker . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
Installing and Seeding MongoDB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
Installing and Seeding PostgreSQL and MySQL Databases . . . . . . . . . . . . 156
Installing and Seeding Microsoft SQL Server Databases. . . . . . . . . . . . . . . 157
Connecting and Querying Databases in Go . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Querying MongoDB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Querying SQL Databases. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160
Building a Database Miner . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
Implementing a MongoDB Database Miner . . . . . . . . . . . . . . . . . . . . . . . 164
Implementing a MySQL Database Miner . . . . . . . . . . . . . . . . . . . . . . . . . 166
Pillaging a Filesystem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172
8 
RAW PACKET PROCESSING 
173
Setting Up Your Environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
Identifying Devices by Using the pcap Subpackage . . . . . . . . . . . . . . . . . . . . . . . . . 174
Live Capturing and Filtering Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
Sniffing and Displaying Cleartext User Credentials. . . . . . . . . . . . . . . . . . . . . . . . . . 178
Port Scanning Through SYN-flood Protections . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
Checking TCP Flags . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
Building the BPF Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181