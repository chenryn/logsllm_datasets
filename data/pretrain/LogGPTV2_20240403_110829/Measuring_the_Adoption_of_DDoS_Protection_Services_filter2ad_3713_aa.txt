title:Measuring the Adoption of DDoS Protection Services
author:Mattijs Jonker and
Anna Sperotto and
Roland van Rijswijk-Deij and
Ramin Sadre and
Aiko Pras
Measuring the Adoption of DDoS Protection Services
Mattijs Jonker
University of Twente
PI:EMAIL
Anna Sperotto
University of Twente
Roland van Rijswijk-Deij
University of Twente and SURFnet bv
Ramin Sadre
Université catholique de Louvain
Aiko Pras
University of Twente
ABSTRACT
Distributed Denial-of-Service (DDoS) attacks have steadily
gained in popularity over the last decade, their intensity
ranging from mere nuisance to severe. The increased num-
ber of attacks, combined with the loss of revenue for the
targets, has given rise to a market for DDoS Protection Ser-
vice (DPS) providers, to whom victims can outsource the
cleansing of their traﬃc by using traﬃc diversion.
In this paper, we investigate the adoption of cloud-based
DPSs worldwide. We focus on nine leading providers. Our
outlook on adoption is made on the basis of active DNS
measurements. We introduce a methodology that allows us,
for a given domain name, to determine if traﬃc diversion to
a DPS is in eﬀect. It also allows us to distinguish various
methods of traﬃc diversion and protection. For our analysis
we use a long-term, large-scale data set that covers well over
50% of all names in the global domain namespace, in daily
snapshots, over a period of 1.5 years.
Our results show that DPS adoption has grown by 1.24×
during our measurement period, a prominent trend com-
pared to the overall expansion of the namespace. Our study
also reveals that adoption is often lead by big players such
as large Web hosters, which activate or deactivate DDoS
protection for millions of domain names at once.
Keywords
DDoS attack mitigation; cloud-based security; protection
networks; protection services; active DNS measurements
1.
INTRODUCTION
In recent years, we have seen a rise of a simple yet very
eﬀective class of attacks: (Distributed) Denial of Service at-
tacks (DDoS) [1]. These can easily generate traﬃc volumes
in the order of hundreds of Gbps. Recent attacks reached
300-600Gbps (e.g., on Spamhaus in 2013 [2], or on BBC in
2016 [3]). To make things worse, on-demand attacks can
easily be purchased online for only a few USD [4, 5], which
has further increased the popularity of such attacks.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage and that copies bear this notice and the full cita-
tion on the ﬁrst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior speciﬁc permission
and/or a fee. Request permissions from permissions@acm.org.
IMC 2016, November 14-16, 2016, Santa Monica, CA, USA
c(cid:13) 2016 ACM. ISBN 978-1-4503-4526-2/16/11. . . $15.00
DOI: http://dx.doi.org/10.1145/2987443.2987487
The growth in number of attacks [6], combined with the
loss of revenue for the targets, has given rise to a market
for DDoS Protection Service (DPS) providers. The protec-
tion of a speciﬁc application, or even an entire network, can
be outsourced to a DPS. Protection can take place on-site,
by means of dedicated appliances [7], or be handled in the
cloud, where malicious traﬃc is ﬁltered or absorbed, thus
eﬀectively thwarting the attack. Hybrid solutions also exist,
where on-site appliances are combined with a cloud-based
component. Attacks can be volumetric (i.e., saturating the
target’s bandwidth) or semantic (e.g., denying service access
with minimal bandwidth eﬀects).
Traﬃc diversion is the key mechanism that allows traﬃc
to be routed through the DPS infrastructure, either in an
always-on or on-demand manner. An eﬀective way to divert
traﬃc for applications that are reached on the basis of a do-
main name, is to exploit the Domain Name System (DNS),
similarly to what is done in content delivery networks for
implementing load balancing [8, 9]. An alternative is to
use the Border Gateway Protocol (BGP) to divert traﬃc
towards the DPS infrastructure.
In this paper, we investigate the adoption of cloud-based
DPSs worldwide. We focus on nine leading providers ac-
cording to [13], namely Akamai, CenturyLink, CloudFlare,
DOSarrest, F5 Networks, Incapsula, Level 3, Neustar, and
Verisign. Our investigation is done on the basis of long-term,
active DNS measurements, which allows us, for a given do-
main name, to verify if traﬃc diversion towards a DPS is
in place. Our large-scale data set consists of daily measure-
ments, over a period of 1.5 years, of the entire .com, .net
and .org zones, which contain about 50% of names in the
global domain namespace [10]. It also contains half a year’s
worth of measurements for the .nl zone, as well as for do-
main names on the Alexa Top 1M list1.
Our study not only conﬁrms an increasing adoption of
DPSs, but it also shows a growth of 1.24× in the zones we
studied for 1.5 years, against an overall growth of these zones
of only 1.09×. In addition, when looking at the breakdown
of the data set per DPS, our results show the emergence of
big players, such as large Web hosters and domainers, which
indicates that the adoption trends are not led by single users
but by larger parties.
We explain the various traﬃc diversion approaches in Sec-
tion 2. Our measurement and analysis methodology is de-
scribed in Section 3, completed by an overview on the stud-
ied data set. We present and discuss our ﬁndings and results
in Section 4, and conclude in Section 5.
1http://www.alexa.com/
2792. DDOS PROTECTION SERVICES
DPS providers can oﬀer cloud-based, in-line, or hybrid
solutions. The type of attack (i.e., volumetric or semantic)
and customer determine the potential of each solution. For
example, an ISP may require BGP-based protection of a
network, but the owner of a popular Web site needs only to
divert traﬃc destined to single host. As another example,
banks want to terminate encrypted e-banking connections
themselves, and therefore require a hybrid solution in which
the in-line appliance mitigates semantic attacks, while the
cloud thwarts large volumetric attacks. For all but strictly
in-line solutions, traﬃc diversion is required.
In the remainder of this section we outline the function-
ing of widely used diversion mechanisms based on DNS and
BGP, and how those are implemented in a DPS.
2.1 DNS-based Network Trafﬁc Diversion
DNS can be used in various ways to divert network traﬃc,
as long as the asset to be protected is reached through a
domain name:
Address record – The owner of a domain name can
(directly) set an A record to a DPS-assigned IP address.2 An
example is shown below. The name server ns.registr.ar is
authoritative for the DNS zone of the domain www.examp.le,
as is indicated by the NS record.
;; ANSWER SECTION :
www . examp . le
;; A U T H O R I T Y SECTION :
www . examp . le
NS
IN
IN
A
1 0 . 0 . 0 . 1
ns . registr . ar
Canonical Name – A domain name can be made into
an alias for another with the CNAME record.
If the CNAME
record of x references the canonical name y, then through
so-called name expansion some record types for x are de-
termined by the DNS zone of y. This means the DNS zone
of y can, among others, set x ’s IP addresses. In the exam-
ple shown below, the domain foob.ar belongs to the DPS,
which through its authoritative name server allows the DPS
to aﬀect the IP addresses for www.examp.le.
;; ANSWER SECTION :
www . examp . le
foob . ar
;; A U T H O R I T Y SECTION :
foob . ar
NS
IN
IN
IN
CNAME
A
foob . ar
1 0 . 0 . 0 . 2
ns . foob . ar
Name Server – The DNS zone of a domain can be dele-
gated to a name server which belongs to a DPS. Unlike the
CNAME use case, the DPS provider is now able to change
the address records of the protected domain. An exam-
ple is shown below, in which the name server of the DPS,
ns.foob.ar, is authoritative for www.examp.le.
;; ANSWER SECTION :
www . examp . le
;; A U T H O R I T Y SECTION :
www . examp . le
NS
IN
IN
A
1 0 . 0 . 0 . 2
ns . foob . ar
The diﬀerence between the outlined CNAME and NS cases
is one that relates to full control over DNS records. In the
CNAME example above, the DPS-controlled ns.foob.ar is not
authoritative for www.examp.le. In eﬀect, the DPS cannot
2Depending on how the DPS operates, the IP address can
either be customer-speciﬁc, or shared among customers in a
“cloud-based” manner. Moreover, in case IPv6 is supported,
the AAAA RR can be set accordingly.
change any of www.examp.le’s records, even though it can
aﬀect IP address records through the CNAME’s expansion.
It is commonplace for DPS providers to combine a DNS-
based diversion approach with a reverse proxy for, e.g., re-
quests to protected Web sites. In such a setup, Web content
is pulled from the customer by forwarding the request. Next,
the request is answered from within the DPS infrastructure.
The customer should drop the requests that are not made
by the DPS because DNS can be bypassed to launch direct
attacks [11].
2.2 BGP Preﬁx Announcements
BGP can be used to divert network traﬃc to a DPS. This
requires the DPS to announce an IP subnet of its customer,
such as a /24. All traﬃc destined for the customer’s subnet
is then routed to the DPS infrastructure for scrubbing. Af-
ter scrubbing, traﬃc is sent back to the customer’s network
by means of, e.g., a Generic Routing Encapsulation (GRE)
tunnel. A BGP-based approach is typically used to protect
entire networks or when a reverse proxy is not feasible.
2.3 Moment of Mitigation
Diversion can be done in an on-demand or always-on man-
ner. In the case of always-on DDoS protection, traﬃc is al-
ways routed to the DPS infrastructure, even if a customer is
not under attack. Thus, if DNS-based diversion is used, an
address lookup always results in an IP address that routes
to the DPS infrastructure. In the BGP case the DPS will
never withdraw the customer’s IP subnet announcement.
If protection is done on-demand, a DNS change is made
by either the provider or the customer, or the DPS could
start announcing a customer’s IP preﬁx using BGP. For the
prior, the DNS change depends on the method of use:
• Address record – The owner of a domain changes
its address records from an IP address that does not
route to the DPS infrastructure to a DPS-assigned
IP address. Multiple address records may need to be
changed if the domain has more than one. All changes