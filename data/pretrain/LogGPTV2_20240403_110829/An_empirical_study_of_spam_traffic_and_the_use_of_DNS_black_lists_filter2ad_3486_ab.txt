24,790
270,655
8 Dec 2000
4,773
186
28,515
2,962
25,553
207,826
19 Feb 2004
76,676
193
787,231
463,097
324,134
2,203,239
20 Feb 2004
70,526
173
765,496
437,143
328,353
2,417,132
12/07/00
02/19/04
 100000
 10000
 1000
 100
 10
s
t
p
m
e
t
t
a
n
o
i
t
c
e
n
n
o
c
d
n
u
o
b
n
I
 1
 1
 10
 100
Remote MTAs
 1000
 10000
 100000
Figure 1: Number of inbound connection attempts that each
remote MTAs made to the monitoring network. Those remote
MTAs are sorted by the decreasing number of connection at-
tempts. Both X and Y axes are in log scale
3.2.2 Spam Sources
To our surprise, we observe that approximately 56% of inbound
SMTP connection attempts seen in February 2004 dataset are re-
jected by local hosts; that is, 56% of all inbound SMTP connec-
tions are to local hosts that are not running a Mail Transfer Agent
(MTA) and hence immediately reset inbound SMTP connections.
This percentage is up from less than 13% in 2000.
We believe that the remote hosts initiating these connections are
likely to be spammers since legitimate email users do not send
emails unless there is reason to believe that the recipient host exists
and is willing to accept their emails.3 Indeed, we ﬁnd that among
the local hosts receiving inbound SMTP connection requests, 38%
of them had not accepted any inbound SMTP connection requests
nor initiated any outgoing SMTP connections. These local hosts
thus function effectively serve as “spam traps”, allowing us to iden-
tify likely spam sources. This is supported by anecdotal evidence:
we know that one of those hosts had formerly been relaying emails
for a certain domain that is not in use any more. Despite now no
longer running an MTA, that host received 141,917 SMTP connec-
tions from 7,732 remote hosts on 20 February 2004. Setting up a
server speaking SMTP, recording all the email messages coming
to the host during 24 hours, and checking them using SpamAssas-
sin [14], we corroborated that all the messages sent to the host were
spam.
We classify a remote host as a spam source if the remote host
attempted to connect local spam traps and there were no success-
ful mail transfers initiated from any local host to that remote host.
The second criterion was needed to ﬁlter out a few mailing lists
3One possibility for legitimate attempts to these hosts would be
misconﬁgured MX records. We did not investigate this possibility.
Table 4: We classify a remote host as a spam source if the re-
mote host attempted to make an SMTP connection to a local
host that was not running a Mail Transfer Agent and hence
rejected the connection attempt. Such a local host effectively
serves as a spam trap to catch spammers walking through a list
of recipients including obsolete ones
Local spam traps
Remote spam sources
7 Dec
2000
19
79
8 Dec
2000
89
66
19 Feb
2004
90
7,970
20 Feb
2004
59
8,780
that may have been led to the spam traps from outdated subscriber
information. Table 4 summarizes the results.
One interesting observation is that connection attempts from this
set of remote hosts is Zipf-like in 2004 but not so in 2000. The
distribution of the number of connections from remote spam hosts
is plotted in Figure 2. The straight line, a/xα, ﬁtting the tail of the
distribution in 2004 shows that the tail can be well approximated
with Zipf-like distribution [8], with α = 1.03.
The heavy-tailedness of Zipf-like distribution results from the
dramatic increase of the number of spam sources that made less
than 10 connections to the monitoring network: In 2000, there are
only 27 such spam hosts, contributing 2.6% to the all incoming
spam trafﬁc, while now the number increased to 4,832 spam hosts
making up 12.5% of the all incoming spam trafﬁc. Assuming that
those low-proﬁle spam sources are hard to identify, the signiﬁcant
increase of low-proﬁle spam sources can affect the effectiveness of
DNSBLs in reducing spam trafﬁc.
4. BLACK LISTS AND SPAM SOURCES
This section explores the effectiveness of DNSBLs in tracking
active spam sources and how different black lists are quantitatively
related to one another.
We selected seven popular DNSBLs to ascertain how many of
the likely spam hosts in our trace appeared in black lists at the time
of our analysis. While this analysis was performed after the traces
were collected and may lead to some inaccuracies, we have no other
way of deﬁnitively knowing if a host was listed since not all local
MTAs used DNSBLs. We use the set of spam sources (described in
§3.2) and check whether each host is listed in a database using DNS
queries. Table 5 shows that over 80% of possible spam sources
connecting to hosts at CSAIL in 2004 are still listed in one or more
black lists in April 2004.
It is interesting to note from Table 5 that 34 of likely spam
sources in December 2000 are still listed in one of the black lists
queried in 2004. It is because that either the 34 listed hosts are still
engaged in spam delivery (although we see no activity from those
hosts in our 2004 trace), or black lists are delinquent in removing
obsolete entries from database. The former indicates a difﬁculty in
stopping spammers even after they have been identiﬁed. The lat-
Table 6: Conditional probability Pr[B|A] matrix for 7 black lists based on Feb 2004 datasets
PPPPPP
spamhaus
spamcop
abuseat
B
rfc-
ignorant
0.16
0.14
0.27
1.00
0.14
0.15
0.07
sorbs
0.77
0.77
0.75
0.57
1.00
0.67
0.44
0.26
0.05
0.39
0.04
0.04
1.00
0.04
0.02
0.01
0.00
0.04
0.06
0.09
1.00
A
abuseat
dsbl
opm
rfc-ignorant
sorbs
spamcop
spamhaus
1.00
0.16
0.69
0.11
0.13
0.74
0.02
dsbl
0.88
1.00
0.99
0.54
0.69
0.76
0.04
opm
0.06
0.02
1.00
0.02
0.01
0.09
0.00
s
t
p
m
e
t
t
a
n
o
i
t
c
e
n
n
o
c
d
n
u
o
b
n
I
 100000
 10000
 1000
 100
 10
 1
 1
12/07/00
02/19/04
alpha = 1.03
 10
 100
 1000
 10000
Spam sources
Figure 2: The number of inbound connection attempts made
by spam sources; spam sources are sorted by decreasing num-
ber of connection attempts. The set of hosts observed in 2004
follows a Zipf-like distribution, but the 2000 set does not.
Table 5: Spam sources listed in DNSBLs
cbl.abuseat.org [2]
list.dsbl.org [3]
opm.blitzed.org [1]
ipwhois.rfc-ignorant.org [4]
dnsbl.sorbs.net [5]
bl.spamcop.net [6]
sbl.spamhaus.org [7]
Total unique hosts black listed
Total spam sources
Dec 2000
0
5
0
25
3
0
2
34
100
Feb 2004
1,401
7,624
122
2,030
8,529
496
1,123
11,521
14,090
ter may prevent those hosts previously used as spam sources from
legitimately sending mail.
We observe that the coverage of each black list widely varies;
highly conservative lists, such as SpamHaus [7], list about 87%
fewer hosts than the aggressive lists, like SORBS [5]. There is also
little overlap between known spam sources and open relay lists —
SpamHaus [7] lists only 6% of hosts that appear in SORBS [5]. In
contrast, different open relay lists are highly correlated: 77% of
hosts listed in DSBL [3] also appear in SORBS [5]. Table 6 shows
conditional probabilities of each pair of black lists that we tested.
For given two black lists A and B, Pr[B|A] is deﬁned as:
# of spam sources that both B and A listed
# of the spam sources that A listed
This conditional probability matrix could be used to weigh the
importance of different black lists in scoring spam (e.g.,
in Spa-
mAssassin [14]). For instance, if the remote host is listed in both
SpamHaus [7] and SpamCop [6], which have very little overlap, it
could be considered more likely to be spam. If false positive data
were available, Table 6 could also be used to choose the member of
a set of highly correlated lists with the least false positives.
5. SUMMARY AND FUTURE WORK
The work in this paper was motivated by a dramatic increase in
the use of DNSBLs at CSAIL from December 2000 to February
2004. DNSBL lookups now account for nearly 14% of all DNS
lookups from our network, up from 0.4% less than four years ago.
This is due to an increase in the volume of mail trafﬁc, as well as a
large increase in the number of public black lists.
By using spam traps, we observed that the activity distribution of
spam source hosts was not Zipf-like in 2000, but is now Zipf-like
with α = 1.03. 80% of these hosts were found to be listed in black
lists, two months after the trace was collected.
Our future work includes better understanding the distribution of
active spam sources, assessing a false positive rate and a miss rate
of DNSBLs, and devising a prescriptive algorithm in using a set of
DNSBLs to block spam.
Acknowledgments
We gratefully acknowledge Hari Balakrishnan and Robert Morris
for their continued support and guidance. Dave Andersen was in-
valuable in helping classify black lists. We also thank Dave Ander-
sen, Nick Feamster, Stuart Schechter, Alex Snoeren, and anony-
mous reviewers for their comments on the previous drafts that im-
proved the paper.
6. REFERENCES
[1] Blitzed open proxy monitor list.
http://opm.blitzed.org/. Last accessed 15 Aug
2004.
[2] Composite blocking list. http://cbl.abuseat.org/.
Last accessed 15 Aug 2004.
[3] Distributed server boycott list.
http://dsbl.org/main/. Last accessed 15 Aug 2004.
[4] Rfc-ignorant.org. http://www.rfc-ignorant.org/.
Last accessed 15 Aug 2004.
[5] Spam & open relay blocking system.
http://www.us.sorbs.net/. Last accessed 15 Aug
2004.
[6] Spamcop. http://www.spamcop.net/. Last accessed
15 Aug 2004.
[7] The spamhaus project. http://www.spamhaus.org/.
Last accessed 15 Aug 2004.
[8] L. Breslau, P. Cao, L. Fan, G. Phillips, and S. Shenker. On
the implications of Zipf’s law for web caching. Technical
Report CS-TR-1998-1371, University of Wisconsin,
Madison, April 1998.
[9] Brightmail. Spam percentages and spam categories.
http://www.brightmail.com/spamstats.html.
Last accessed 15 Aug 2004.
[10] Theo de Raadt. OpenBSD spamd. http://www.
openbsd.org/cgi-bin/man.cgi?query=spamd.
Last accessed May 2004.
[11] Jaeyeon Jung, Emil Sit, Hari Balakrishnan, and Robert
Morris. DNS performance and the effectiveness of caching.
IEEE/ACM Transactions on Networking, 10(5), October
2002.
[12] J. Klensin. Simple Mail Transfer Protocol, April 2001. RFC
2821.
[13] Ben Laurie and Richard Clayton. “proof-of-work” proves not
to work. In Proceedings of the The Workshop on Economics
and Information Security, Minneapolis, MN, May 2004.
[14] Justin Mason. Spamassassin.
http://www.spamassassin.org/. Last accessed
April 2004.
[15] Vern Paxson. Bro: a system for detecting network intruders
in real-time. Computer Networks, 31(23–24):2435–2463,
1999.
[16] Evan I. Schwartz. Spam wars. Technology Review, pages
32–39, July/August 2003.