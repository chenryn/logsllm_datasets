## 1.前言：
参加某国赛去划水，遇到了好多大佬，还遇到了自己收藏夹里面的大佬本人，哇激动的赶紧要了个好友位，要不是比赛时间太赶，说不定我就能在那跟大佬面基聊聊天。本次比赛发现大佬就是大佬强，在前三小时的解题赛的时候开局半小时，我选择题都没写完，大佬连CTF题都解出来了。TQL，然后回去之后自己复现下CTF题，发现大佬太强了。完全是自己用01拼出来的压缩包。接下从零开始手撕压缩包。
## 2.正文：
题目名称：MISC600
题目描述：宇宙的一切的答案就是32
题目附件：链接:  提取码: we4a
打开rar文件里面有个32.jpg，日常BINWALK 发现一个32.txt内容如下
`GUYDIQRQGMYDIMCBGAYDAOJQGAYDAMBQGQ7DIOJQIE7DON7FHBBEENKGGQYTEMBQGAYDAMBQGYYDAMBQGAYDANJQGAYDAMBQGY6DERJXGQ6TQNZUGE6TCNRVGE5EIQZXGJCTIOKEIZBDQRCCGMYTMMZRII7UIQKFIM7DERRZGA7TANCCGA6TAOBXIU5EEQRVIY7DCMRQGAYDAMBQGA6DAMBQGAYDANJQGRBDAMZQGQYECMBQGA5TAMBQGAYDANJTGQ5TAQJUG4BTQNZUIFAUCNJRGIYDAMBQGAYDANRQGAYDAMBQGA7TAMBQGAYDANSDGJCTONBXHA6TIMJXGE6DKMJYIRBTOMSFGQ5UIRSCHBCEEMRWGFBECQJSGRBTMQJWINBDGQRVGA7EEMBXGA5EGOBXGRAUCQJVGEZDAMBQGAYDAMBWGAYDAMBQGA7TANCCGAZTANBQIEYDAMBZGAYDAMBQGAZTINRSGBATINZUGVCDMMBQIMYTCMRQGAYDAMBQGA6DAMBQGAYDAMBVGAYDAMBQGA6DCMSFG57DOOBXGQYTOMJWGUYTQRCDG5ZEKNBZIRDEEOCEII7DCNCBGAZTEQJSGU6UERJSIY5TKMBUIIYDOMBYGQ7UINRQGBBTCMJSGAYDAMBQGAYDMMBQGAYDAMBVGA7EEMBTGA7DAQJQGAYDSMBQGAYDAMBXIQ7DSMCBGQ6TMNBSINBECRKFGEZDAMBQGAYDAMBWGAYDAMBQGAYDKMBQGAYDAMBWG5ZEKNZUG55DONBRG5YTMNJRHBCEGNZSIU7DSRCGII5EIQRQHAYECMBWGZDEMMBSIZDEKQZVGUYDIQRQG5YDQNRUGJBUEQKFIUYTEMBQGAYDAMBQGYYDAMBQGAYDKMBUIIYDCMBSGE7DAMBQIEYDAMBZGAYDAMBQGA7DINBZGBATINZXIU5EEQRVIY7DCMRQGAYDAMBQGA6DAMBQGAYDAMBVGAYDAMBQGAYDAMBQGAYDAMBQGEYDAMRQGAYDAMBQGAYDAMBQGAYDAMBWGYZEKNZUG55DONBVGA7EEMBRGAZDCNBQGAYECMBQGA5TAMBQGAYDANJTGQ5TAQJUG4BTQNZUIFAUCNJRGIYDAMBQGAYDANRQGAYDAMBQGA7TAMBQGAYDAMBQGAYDAMBQGAYDCMBQGIYDAMBQGAYDANBVGAYDAMBQGA6EGMSFG57DOOBXGQ7TANCCGAYTAMRRGQYDAMCBGAYDAOJQGAYDAMBQGM7DMMRQIE7DONBVIQ6DAMCDGEYTEMBQGAYDAMBQGYYDAMBQGAYDANJQGAYDAMBQGAYDAMBQGAYDAMBRGAYDEMBQGAYDAMBQHBATAMBQGAYDANRRGJCTONBXHA6TINJQGRBDAMJQGIYTIMBQGBATAMBQHEYDAMBQGAYDORBUHEYECNBXGY7DEQ7CIFCUKMJSGAYDAMBQGAYDMMBQGAYDAMBQGUYDAMBQGAYDAMBQGAYDAMBQGAYTAMBSGAYDAMBQGAYEGRRQGAYDAMBQGY6TERJXGQ6TQNZUGUYDIQRQGUYDMMBQGAYDAMBQGAYDIMBQGA7DAMCDIMYDAMBQGAYDCNBQGEYDAMBQGAYDAMA=`
仔细看字符串范围1.全是大写，然后没有8，9，确定编码`BASE32`，`PYTHON BASE3`2解密看到字符串如下
    504B03040A00090000004>490A>77\xe58B
    B5F412000000060000000500000062F90?04B0=087E:BB5F>120000
    000B070:C874
    AAA51200000006000000?04B03040A00
    0900000034620A4745D600C112000000
    014A032A25=BE2F;50
    4B07084?D600C1120000000600000050
    \>B030>0A00090000007D>90A4=642CBA
    EE12000000060000000500000067rE74
    7z7417q6518DC72E>9DFB:DB080A066F
    F02FFEC5504B07p8642CBAEE12000000
    06000000504B01021>000A0009000000
    \>4490A477E:BB5F>120000000B010214000A000;
    000000534;0A47\x03874AAA51200000006
    0000000?000000000000000100200000
    0045000000620A>745D2C\xe2A
    EE120000000600000005000000000000
    00010020000000CF0000006=2E74=874
    504B05060000000004000>00CC000000
看到`504b0304`相信大家都看出来是压缩包了吧，仔细看发现里面一堆混淆字符串emem比赛的时候我就是做到这里的，然后就回家补习知识了。
## 3.预备知识：
首先zip压缩包是由多个文件实体（File Entry）和多个目录源数据（Central Directory）以及一个目录结束标识（End of
central directory
record）组成。举个栗子：我们新建个flag.txt文件内容为`xiaomeiqiu007`,然后压缩成flag.zip。用winhex打开下，我稍微标记一下。
**红色部分为：文件实体（File Entry）**
主要是记录文件压缩后的主要内容通常以`504b0304`标识开头，每一被压缩的文件对应一个文件实体。例如本次压缩的flag.txt对应第一个文件实体（红色的部分）。文件实体中存储着当前被压缩文件的名字，文件修改时间，压缩方式，是否加密等信息。从旁边解码中我们也能看到，文件的名字`flag.txt`,以及文件的内容`xiaomeiqiu007`。