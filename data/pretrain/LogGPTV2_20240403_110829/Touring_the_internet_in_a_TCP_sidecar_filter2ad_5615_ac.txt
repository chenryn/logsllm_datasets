we used kernel resource limits to prevent unexpected, excessive
memory and processor consumption. We also fetched result data
often to reduce disk consumption. We tested our Web crawler and
CoDeeN instrumentation from a local machine, grew to a few Pla-
netLab nodes, and only eventually to all of them. This approach
prevented early implementation errors from causing undue havoc.
5. RESULTS
Our evaluation focuses on feasibility, coverage of the topology
with record route, and correctness of address alignment (alias res-
olution). We also comment on the intrusiveness of the technique as
measured anecdotally by the absence of abuse reports. Our exper-
iments traversed 8,817 ASes (Table 1) and generated 65,189,939
unique traces.
Approximately 16% of IP addresses in our experiment were dis-
covered by record route alone (Table 1, row three). These routers
are either anonymous (do not respond to traceroute), use MPLS
to avoid decrementing the TTL, or were interfaces not crossed by
traceroute. Of the remaining IP addresses, 55.9–79.4% were dis-
covered by traceroute only.
5.1
Intrusiveness
We designed Sidecar to discover topology without the abuse re-
ports of traceroute. Our CoDeeN experiment probed 22,428 IP ad-
dresses over a week with no incidents. Our web crawler experi-
ment, however, generated ten abuse reports across 166,761 destina-
tions. All reports noted frequent, unexpected, and synchronized ac-
cesses to robots.txt. One noted ICMP “time-exceeded” messages,
but only after being alerted from web logs. We take this as in-
dication that the Sidecar probing technique is in fact unobtrusive,
but our custom web crawler needs improvement. We received no
reports generated by automated intrusion detection systems. We
describe our experiences in more detail in another paper [25].
5.2 Record Route Coverage
The record route option holds at most nine addresses; record
route adds nothing to topology discovery further than nine hops
from vantage points. To use record route for a broad topology dis-
covery effort requires a measurement platform with sufﬁcient net-
work diversity that most of the Internet is within nine hops of at
least one vantage point. By virtue of its geographic diversity, we
believe that PlanetLab is, or is becoming, such a platform. Here we
attempt to evaluate how well PlanetLab “sees” the broader Inter-
net through record route, to show that record-route-based topology
discovery is feasible with current infrastructure.
Record route provides additional information (aliases) or conﬁ-
dence in that information (multi-path detection) for nodes and links
within nine hops of a vantage point. From the PlanetLab testbed,
we found that 87.6–98.5% of end-hosts and routers in the data set
are within nine hops of at least one PlanetLab node (Table 1, sec-
ond to the last row). Of the links discovered in our topology 59.6–
69.1% were found (or conﬁrmed) by RR. Perhaps surprisingly, the
fraction of addresses and links reachable in nine hops increases
with the number of IP addresses. We speculate that the larger mea-
surement set more completely explores the network that is near
to PlanetLab nodes, while the measurement of the intra-PlanetLab
topology discovers several paths too long for record route and lit-
tle else. A full characterization of addresses outside of nine hops
remains the subject of future work.
5.3 Correct Alias Resolution
Correct alias resolution in the context of record route requires
accurate classiﬁcation of routers in the path. Because the rule set is
ambiguous (Figure 3), many traces, especially those experiencing
multi-path routing or hidden routers, may be incorrectly classiﬁed.
Rather than incorporate faulty data into the analysis, we remove any
trace that results in a classiﬁcation contradiction because the cost
of erroneous data is impermissibly high. Due to the linear nature
of the inference heuristics, one misclassiﬁed router may corrupt an
entire trace. We believe that a more formal inference engine com-
bined with active probing would reduce the number of ambiguous
traces signiﬁcantly.
Alias resolution, as reported in Rocketfuel [27] and conﬁrmed by
Teixeira et al. [29] is typically error prone. We use Rocketfuel’s ally
tool [27] to validate Passenger’s asserted aliases (Table 2, “Alias
pairs”), but we use only the IP identiﬁer and common source ad-
dress techniques because others are too error prone [26]. We traced
the false aliases (Table 2, “Ally: no”) as reported by ally to B-to-
Hidden-to-A transitions in which the Hidden interface address is
falsely associated with the Type A router. We are seeking ways of
resolving this ambiguity from within the trace to reduce the false
positive rate further.
Many of these address pairs cannot be conﬁrmed or disproven
because at least one address is unresponsive or unroutable. Ally
was only able to conﬁrm or deny aliases for 50.6%, 18.4%, and
40.3% (“Ally:yes”+“Ally:no”/“Alias Pairs”) of asserted aliases for
the PlanetLab, Web crawler, and CoDeeN data sets. We report the
false positive rate as the fraction of aliases disproven (“Ally: no”)
divided by aliases responsive (“Ally: yes”+“Ally: no”).
PlanetLab Web crawler
CoDeeN
Alias pairs
Ally: yes
Ally: no
6,789
3,389
46 (1.3%)
108,870
17,972
2041 (10.2%)
9,233
3,291
432 (11.6%)
Table 2: Router alias pairs as compared to Ally.
5.4 MPLS Results
We use MPLS ICMP extensions to discover MPLS usage. Be-
tween PlanetLab hosts, we identify 2,546 distinct routers that ad-
vertise MPLS ICMP extensions, across 38 different ASes. Among
CoDeeN hosts, there were 7,730 routers and 112 different ASes.
Sidecar was not instrumented with MPLS detection at the time of
the web crawler experiment. Further investigation of the possible
uses of this information is the subject of future work.
6. CONCLUSION AND FUTURE WORK
IP’s record route option has the potential to provide more de-
tailed topology information than previously available through trace-
route. The diversity and size of the PlanetLab platform makes this
primitive practical for topology measurement. We have found 16%
more addresses and discovered IP aliases that cannot be resolved
by the techniques of prior mapping efforts, but at the same time,
uncovered an interesting problem of inferring the aliases between
the addresses discovered by traceroute and record route.
We believe TTL-limited record route packets can substantially
improve the efﬁciency of methods like Doubletree [8] that attempt
to reduce the number of probes required to collect a topology.
Sidecar is a new tool for network measurement. Its use of ex-
isting TCP connections enables unintrusive measurement and its
support for IP options and ICMP extensions makes it potentially
useful in developing new measurement techniques.
The code for Sidecar and Passenger, as well as the data gener-
ated from this experiment are available from http://www.cs.umd.
edu/projects/sidecar.
The combination of Sidecar and record route as topology discov-
ery tools provides many potential avenues of future work. The low
rate of abuse reports opens the door for an in depth longitudinal
study of network behavior. While we demonstrate that our heuris-
tic solution for address assignment can classify approximately 65%
of traces, we seek a more formal treatment of the problem, with
solutions that can be veriﬁed. We also hope to investigate how
the new information exposes anonymous routers [31] that do not
generate ICMP responses for traceroute, how record route perfor-
mance affects other traceroute-like measurements like RPT [13] or
pathchar [14], how to assign ownership to routers with this new ad-
dress information [20], how to adapt the frequency of record route
probes to manage load on intermediate routers, how to use conges-
tion control information to limit probe rates, how address alignment
would beneﬁt from other data sources like DNS or active probing,
and many other questions.
Acknowledgments
We owe Mark Huang and the rest of the PlanetLab staff for their
help and patience in the early phases of debugging Sidecar and its
tools. We would also like to thank Vivek Pai and the rest of the
CoDeeN project for allowing us access to their slice, and Fritz Mc-
Call and the UMIACS staff for their timely assistance. Last, we
would like to thank our shepherd, Gianluca Iannaccone, and the
anonymous reviewers for their helpful comments.
7. REFERENCES
[1] Abilene. http://abilene.internet2.edu.
[2] S. Ailleret. Larbin: Multi-purpose web crawler. http://larbin.
sourceforge.net/.
[3] D. Applegate and E. Cohen. Making intra-domain routing robust to
changing and uncertain trafﬁc demands: Understanding fundamental
tradeoffs. In ACM SIGCOMM, 2003.
[4] H. Balakrishnan, et al. TCP behavior of a busy Internet server: Anal-
ysis and improvements. In INFOCOM, 1998.
[5] R. P. Bonica and D.-H. Gan. ICMP extensions for multiprotocol label
switching. Internet Draft (work in progress): draft-ietf-mpls-icmp-05,
2006.
[6] R. P. Bonica, et al. Modifying ICMP to support multi-part mes-
sages. Internet Draft (work in progress): draft-bonica-internet-icmp-
08, 2006.
[7] k. claffy, T. E. Monk, and D. McRobb. Internet tomography. Na-
ture, Web Matters, 1999. http://www.nature.com/nature/webmatters/
tomog/tomog.html.
[8] B. Donnet, P. Raoult, T. Friedman, and M. Crovella. Efﬁcient al-
gorithms for large-scale topology discovery. In ACM SIGMETRICS,
2005.
[9] S. Floyd, J. Mahdavi, M. Mathis, and M. Podolsky. An extension to
the selective acknowledgement (SACK) option for TCP. IETF RFC-
2883, 2000.
[10] R. Fonseca, et al. IP Options are not an option. Tech. Rep.
UCB/EECS-2005-24, EECS Department, University of California,
Berkeley, 2005.
[11] R. Govindan and H. Tangmunarunkit. Heuristics for Internet map dis-
covery. In INFOCOM, 2000.
[12] M. Gunes and K. Sarac. Analytical IP alias resolution. In IEEE Int’l
Conference on Communication, 2006.
[13] N. Hu, O. Spatscheck, J. Wang, and P. Steenkiste. Locating Internet
bottlenecks: Algorithms, measurements, and implications. In ACM
SIGCOMM, 2004.
[14] V. Jacobson. Pathchar. ftp://ftp.ee.lbl.gov/pathchar/.
[15] V. Jacobson. Traceroute. ftp://ftp.ee.lbl.gov/traceroute.tar.Z.
[16] D. Kaminsky. Paratrace. http://www.doxpara.com/read.php/docs/
paratrace.html, 2002.
[17] K. Keys. ifﬁnder. http://www.caida.org/tools/measurement/ifﬁnder/,
2006.
[18] K. Lai and M. Baker. Nettimer: A tool for measuring bottleneck link
bandwidth. In USITS, 2001.
[19] A. Lakhina, J. Byers, M. Crovella, and P. Xie. Sampling biases in IP
topology measurements. In INFOCOM, 2003.
[20] Z. M. Mao, J. Rexford, J. Wang, and R. Katz. Towards an accurate
AS-level traceroute tool. In ACM SIGCOMM, 2003.
[21] A. Medina, M. Allman, and S. Floyd. Measuring the evolution of
transport protocols in the Internet. ACM CCR, 2005.
[22] V. N. Padmanabhan, L. Qiu, and H. J. Wang. Passive network tomog-
raphy using bayesian inference. In IMW, 2002.
[23] J.-J. Pansiot and D. Grad. On routes and multicast trees in the Internet.
ACM CCR, 28(1):41–50, 1998.
[24] L. Peterson, T. Anderson, D. Culler, and T. Roscoe. A blueprint for
introducing disruptive technology into the Internet. In HotNets, 2002.
[25] R. Sherwood and N. Spring. A Platform for Unobtrusive Measure-
ments on PlanetLab. In USENIX Workshop on Real, Large Dis-
tributed Systems (WORLDS), 2006.
[26] N. Spring, M. Dotcheva, M. Rodrig, and D. Wetherall. How to resolve
IP aliases. Tech. Rep. 04–05–04, University of Washington Dept.
CSE, 2004.
[27] N. Spring, R. Mahajan, and D. Wetherall. Measuring ISP topologies
with Rocketfuel. In ACM SIGCOMM, 2002.
[28] N. Spring, L. Peterson, A. Bavier, and V. Pai. Using PlanetLab for
network research: Myths, realities, and best practices. ACM SIGOPS
Operating Systems Review, 40(1):17–24, 2006.
[29] R. Teixeira, K. Marzullo, S. Savage, and G. Voelker. In search of path
diversity in ISP networks. In IMC, 2003.
[30] L. Wang, et al. Reliability and security in the CoDeeN content distri-
bution network. In USENIX Annual Technical Conference, 2004.
[31] B. Yao, R. Viswanathan, F. Chang, and D. Waddington. Topology
inference in the presence of anonymous routers. In INFOCOM, 2003.
[32] Y. Zhang, L. Breslau, V. Paxson, and S. Shenker. On the characteris-
tics and origins of Internet ﬂow rates. In ACM SIGCOMM, 2002.
[33] Y. Zhang, M. Roughan, C. Lund, and D. Donoho. An information-
theoretic approach to trafﬁc matrix estimation. In ACM SIGCOMM,
2003.