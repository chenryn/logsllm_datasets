SG-S6000平台应采用柔性设计，拥有良好的可扩展性，具备业务处理的灵活配置能力，能随着网络与信息安全预警分析中心业务需求变化灵活重组与调整。建立可扩展的系统框架，降低各功能模块间的耦合度，适应分析手段、场景构建的不断发展和变化。
3.  **兼容性原则**
SG-S6000平台具有良好兼容能力，以最小代价快速集成或者获取异构系统。充分考虑已有监控分析平台的系统架构及数据模型，确保系统在采集、分析、展示等层级的兼容和平滑过渡。
4.  **业务协同原则**
考虑平台与外部系统及安全系统之间的业务协同。平台架构中各组件的部署与集成应充分考虑S6000和大数据平台相关的技术标准，实现与内外部应用的紧密协同。
5.  **易用性原则**
提升用户体验。建模和分析手段提供图形化界面，采用点击及拖拽方式，减少操作次数、提供操作反馈。并可直接通过监控页面进行查询、统计、钻取操作，
6.  **标准先行原则**
优先建立和完善相关技术规范和技术标准，实现各系统日志格式、数据接入、集成接口的标准化设计。
## 3.3总体技术路线 {#总体技术路线 .list-paragraph}
表 架构决策
+---------+------------------------------------------------------------+
| 分类    | 选型原则                                                   |
+=========+============================================================+
| 架      | -   符合国网国产化战略，不采用国外商用IOE典型解决方案。    |
| 构选型  |                                                            |
|         | -   架构可扩展性强，系统支持线性扩展。                     |
|         |                                                            |
|         | -   支持网络流量                                           |
|         | 、系统日志等实时高速流式数据采集，支持海量（PB）数据存储。 |
|         |                                                            |
|         | -   支持海量数据实时分析、批量数据挖掘、交互式查询分析。   |
|         |                                                            |
|         | -   系统软硬件成本低。                                     |
+---------+------------------------------------------------------------+
| 平      | -                                                          |
| 台选型  |   优先采用国网大数据平台，技术路线符合国网大数据技术路线。 |
|         |                                                            |
|         | -   业界成熟平台组件，经历业界大规模验证。                 |
+---------+------------------------------------------------------------+
| 部      | -   采用两级                                               |
| 署模式  | 部署，网省侧实时数据采集、实时告警，减少两级数据传输压力。 |
|         |                                                            |
|         | -   总部汇总网省数据，支持跨省分析。                       |
+---------+------------------------------------------------------------+
## 3.4架构遵从 {#架构遵从 .list-paragraph}
### 3.4.1业务架构 {#业务架构 .list-paragraph}
目前公司总体架构蓝图中未对国家电网公司安全预警平台的业务架构进行规划。
### 3.4.2应用架构 {#应用架构 .list-paragraph}
目前公司总体架构蓝图中未对国家电网公司安全预警平台的业务架构进行规划。
### 3.4.3数据架构 {#数据架构 .list-paragraph}
目前公司总体架构蓝图中未对国家电网公司安全预警平台的业务架构进行规划。
### 3.4.4技术架构 {#技术架构 .list-paragraph}
![](media/image3.png){width="6.434372265966754in"
height="3.516213910761155in"}
[]{#_Toc430959679 .anchor}图2 系统技术架构图
安全预警分析平台系统总体上遵循国网大数据处理体系架构，共分为以下几层：
数据整合：通过syslog、webservice、jdbc、网络爬虫、网络捕获等方式等多种技术从外部数据源抽取和采集结构化数据（关系数据库记录）、半结构化数据（日志流量、邮件等）。实时数据采集后放入分布式消息队列。
数据存储：负责进行大数据的存储，针对全数据类型和多样计算需求，以海量规模存储、快速查询读取为特征，存储来自外部数据源的各类数据，支撑数据处理层的高级应用。原始日志及网络流量存放到列式数据库中，标准化、加强后的日志及流量数据存放在分布式列式数据索引中，告警、事件、预警、情报、安全态势等数据存放在关系数据库中。
数据计算：对多样化的大数据提供实时、离线、交互式等计算框架，允许对分布式存储的数据文件或内存数据进行查询和计算。通过负责事件处理及流计算技术提供实时分析处理的计算能力，实现实时决策、预警等。通过离线计算提供落地数据的计算能力，实现数据的批量数据挖掘计算。对标准化日志提供交互式计算。
平台展现：采用大屏可视化、SG-UAP，HTML5等技术实现分析结果综合展现及安全态势研判分析。
安全：解决从大数据环境下的数据采集、存储、分析、应用等过程中产生的诸如身份验证、授权过程和输入验证等大量安全问题。由于在数据分析、挖掘过程中涉及企业各业务的核心数据，防止数据泄露，控制访问权限等安全措施在大数据应用中尤为关键。
管理配置：实时监测大数据处理全过程中的整体运行状态、资源使用情况和接口调用情况等性能指标并对关键系统险情进行告警，支持大数据组件安装、配置和状态管理，可快速扩展应用功能和能力，可实时性监控和调度任务计划。
表 技术架构遵从对照
  -------------------------------------------------------------------------------------
  本系统名称                     总体架构：系统名称             遵从说明
  ------------------------------ ------------------------------ -----------------------
  信息安全预警分析中心支撑平台   信息安全预警分析中心支撑平台   遵从
  集成场景                                                      
  系统架构：集成场景             技术架构：集成场景             遵从说明
  I6000资产数据集成              数据集成                       遵从
  I6000网络与主机安全数据集成    数据集成                       遵从
  I6000网络拓扑数据集成          数据集成                       遵从
  I6000物理环境数据集成          数据集成                       遵从
  统一监控平台安全数据集成       数据集成                       遵从
  电子商务平台数据集成           数据集成                       遵从
  电商平台数据集成               数据集成                       遵从
  ISS安全数据集成                数据集成                       遵从
  95598系统数据集成              数据集成                       遵从
  I6000工单应用集成              应用集成                       遵从
  产品标准                                                      
  系统架构：软件产品             技术架构：软件产品             遵从说明
  SG-UAP 3.0                     开发平台                       遵从
  HDFS 2.6.0.2.2                 文件系统                       遵从
  HBase 0.98.4.2.2               数据库                         遵从
  Storm 0.95                     中间件                         遵从
  Kafka 0.8.2.1                  中间件                         遵从
  ElasticSearch 1.7.1            工具                           遵从
  YARN + MapReduce 2.6.0.2.2     工具                           遵从
  Esper 5.3                      工具                           遵从
  Hive 0.14.0.2.2                工具                           遵从
  Sqoop 1.4.5.2.2                工具                           遵从
  -------------------------------------------------------------------------------------
# 4业务能力视图
## 4.1业务目标 {#业务目标 .list-paragraph}
公司信息安全监控业务包含情报收集、深度监测、大数据分析、预警处理四大业务。
1.  **情报收集**
情报收集是指中心基于公司现状，在确定情报源后通过人工录入、标准接口接收、爬虫等多种方式，获取情报信息。情报收集的输入是从各种渠道获取的原始情报信息，输出是结构化情报、非结构化情报；包含三项主要活动：攻防技术跟踪、情报收集、情报标准化。
2.  **深度监测**
通过对公司各安全监测系统的数据采集，获取包括网络流量特征、安全系统告警日志、业务系统日志等数据，作为发现安全入侵、安全违规和特权滥用的基础数据。
3.  **大数据分析**
对采集的情报和日志等按照特定的场景规则进行智能关联后，经专业安全分析人员分析确认，识别出对公司有危害的安全事件和有影响的安全威胁。
4.  **预警处置**
对安全事件、安全威胁、安全资讯等进行统一处置，对紧急的安全事件启动应急响应流程，对处置完毕的事件进行根因分析，完成归档闭环。
## 4.2组织单元 {#组织单元 .list-paragraph}
1.  **网络与信息安全预警分析中心**
公司网络与信息安全预警分析中心牵头开展中心各项主业务工作，包括情报收集、深度监测、大数据分析、预警处置和违规调查工作。
2.  **公司协作单位**
公司协作单位包括安全红队、检测队伍、督查队伍等，协作中心开展情报收集、大数据分析中的场景建模工作，以及预警处置和违规调查工作。
3.  **省市公司**
省市公司包含内部安全队伍和运维队伍。负责平台在各省的采集端运维工作，同时协作中心开展情报收集中的情报采集工作、大数据分析中的告警分析工作，以及预警处置和违规调查工作。
4.  **国网信通**
国网信通公司负责中心平台的运维工作，协作中心开展情报收集中的情报采集工作、大数据分析中的告警分析工作，以及预警处置和违规调查工作。
5.  **外部机构**
外部机构包括与安全厂商，协作中心开展情报收集中的情报采集工作。
表1 主业务分工
  ---------------------------------------------------------------------------------------------------------------
  **职能分工                       **预警中心**   **公司协作单位**   **省市公司**   **国网信通**   **外部机构**
  执行队伍**                                                                                       
  ---------------- --------------- -------------- ------------------ -------------- -------------- --------------
  **情报收集**     攻防技术跟踪    △              √                                                
                   情报采集        △              √                  √              √              √
  **深度监测**     大数据采集      △                                                               
  **大数据分析**   场景建模        △              √                                                
                   大数据分析      △                                                               
                   告警分析        △                                 √              √              
  **预警处置**     事件处置        △              √                  √              √              
                   预警处置        △              √                  √              √              
  **系统运维**     前端采集                                          △                             
                   后台系统                                                         △              
                                                  △                  负责           √              协作
  ---------------------------------------------------------------------------------------------------------------
## 4.3岗位 {#岗位 .list-paragraph}
表2 岗位定义
  ---------- ----------- ------------------ --------------------------------------------------------------------------------------
  **编号**   **岗位**    **所属组织单元**   **职责**
  1001       情报组      总部               负责公司内部、外部安全情报的收集、识别、分析；公司检测队伍负责本单位掌握情报的导入。
  1002       监测组      总部、网省         通过安全监控预警平台开展日常安全监测，开发安全场景。
  1003       分析组      总部、网省         开展基于数据流、安全日志的大数据分析；针对特殊事件的安全分析。
  1004       处置组      总部、网省         针对安全监测发现事件进行响应、处置、调查、取证等工作。
  1005       管控组      总部、网省         负责中心业务的监控与跟踪，以及流程管理、指标管理与数据管理，发布通告。
  1006       系统管理    总部、网省         负责平台的管理、操作、审计等工作。
  ---------- ----------- ------------------ --------------------------------------------------------------------------------------
## 4.4业务流程 {#业务流程 .list-paragraph}
![](media/image4.png){width="6.044957349081365in"
height="5.10073709536308in"}
[]{#_Toc430959680 .anchor}图3 业务主流程图
1.  情报收集
    1.  情报收集的来源有两种，一种是来自互联网漏洞平台所发布的一些信息通过机器采集系统进行录入，另一种是通过人工录入。
    2.  机器采集录入的情报首先通过机器验证其真假，再提交。
    3.  所有情报提交的结果和资产进行关联分析。
    4.  情报关联分析的结果会产生预警信息。
2.  深度监测
    1.  其他与本系统集成的系统产生的流量以及生成的日志也是数据的重要来源之一，需要在省公司本地存储归档。
    2.  这些数据所传来的格式不一样，信息会有重复，需要经过数据预处理才可以使用。
    3.  数据预处理之后的信息交给系统进行数据分析。
3.  数据分析
    1.  总部的分析员将现有的场景规则化，在大数据分析平台中生成场景模型。
    2.  审核员对建好的场景模型验证后，发现其具备试运行条件，则对该场景进行试运行。
    3.  模型发布后，需要将模型部署到各个网省公司的系统中运行。
    4.  系统根据不同的日志信息对采集的数据进行关联，按照对应的场景经行分析。
    5.  场景分析的结果会产生告警信息。
4.  事件处置
    1.  所有的告警信息和预警信息会上传到总部经行研判。
    2.  分析员如果发现预警或者告警是误报，则将其关闭；如果发现是一般威胁，则将其提交为通告，如果是高危威胁，则将其提交为事件。
    3.  通告的情报提交后，则发布通告，通告可以针对个别区域也可以针对全网。
    4.  事件提交后，审核员进行审核，审核通过的，则变为事件，待处置。
    5.  待处置的事件由各个网省的处置员对事件进行处置，处置完后进行反馈提交。
    6.  提交的事件需要进行审核，审核员审核不通过，需要重新进行处置，如果审核通过后，则关闭事件处置。
## 4.5业务活动  {#业务活动 .list-paragraph}
业务活动清单列表如下：