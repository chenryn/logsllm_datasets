8
16
16
16
8
4
4
4
33
33
488
523
120
2
2
2
2
9-sided
7956
4008
3948
19-sided
19-sided
10-sided
10-sided
14-sided
9-sided
3-sided
3-sided
3-sided
20808
24854
11342
12830
32723
22397
17
22
5
10289
12580
1809
1682
16490
12351
10
16
2
10519
12274
11533
11148
16233
10046
7
6
3
(cid:2)
(cid:2)
2
3-sided
12
12
(cid:2)
Organization
Ranks Banks Pins
×8
×8
×16
×16
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
×8
16
16
8
8
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
16
1
1
1
1
1
1
2
2
1
2
1
2
2
2
1
2
1
1
1
2
2
1
1
2
2
2
1
1
1
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UL
UT
UT
† The module does not report manufacturing date. Therefore, we report purchase date as an approximation.
‡ Analyzed using the FPGA-based SoftMC.
(cid:3) The system runs with double refresh frequency in standard conditions. We conﬁgured the refresh interval to be 64 ms in the BIOS settings.
25
3
10-sided
9-sided
190037
694
63904
239
(cid:2)
126133
455
UL = Unlimited
UT = Untested
parameter in some cases does play a role in the effectiveness
of the pattern and we further discuss it in Appendix B.
Results. TRRespass discovered effective access patterns for
13 of the 42 TRR-protected memory modules in our set.
Table II reports the results for the number of access patterns
identiﬁed and the structure of the most effective pattern. One
interesting insight we gain from our analysis is that there is
not a single effective access pattern per module. In fact, we
can see that all the modules where TRRespass induces bit ﬂips
are vulnerable to at least two different access patterns. On B
modules, we could identify access patterns on 4 out of the
12 modules we analyzed, and always with simple 4-sided and
3-sided patterns as presented in Figure 12. On the other hand,
none of these patterns appear to work on the other vendors’
chips. For example, in Figure 13, we show the number of
aggressor rows required to trigger bit ﬂips on module A10.
We can see that no bit ﬂip can be triggered with fewer than
8 aggressor rows. TRRespass successfully triggers bit ﬂips on
7 of 16A modules, with several very different patterns. A4
and A15 are mainly vulnerable to the 9-sided variant, A10 and
A11 to different variants of the 10-sided pattern, and A8 and
A9 to a 19-sided pattern. On C modules, TRRespass discovers
effective RowHammer patterns on only 2 of 14 modules. We
observe that C12 and C13 are vulnerable to 9-sided and 10-
sided hammering patterns.4
A scalable framework. The results of TRRespass on module
A15 demonstrate how a black-box approach can be extremely
beneﬁcial. In Section V, we describe how complex it can be to
reproduce the optimal access pattern discovered using SoftMC
on a CPU system. In contrast, TRRespass discovers two very
successful access patterns that generate a signiﬁcant number
of bit ﬂips automatically.
4While TRRespass identiﬁes effective RowHammer access patterns only
on 13 out of 42 modules, this does not mean that the other modules are
immune to RowHammer. Similarly, these results do not necessarily show that
that memory modules from a speciﬁc vendor are more or less vulnerable
than modules from other vendors. Similar to regular software fuzzers, it may
simply be a matter of time and better strategies to ﬁnd access patterns that
lead to bit ﬂips. Our testing is also not exhaustive due to limited testing time
and resources.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:42:55 UTC from IEEE Xplore.  Restrictions apply. 
756
TABLE III: LPDDR4(X) results. Mobile phones tested against
TRRespass on ARMv8 sorted by production date. We found bit ﬂip
inducing RowHammer patterns on 5 out of 13mobile phones.
Mobile
Phone
Year
SoC
Google Pixel
Google Pixel 2
Samsung
G960F/DS
Huawei P20 DS
Sony XZ3
HTC U12+
LG G7 ThinQ
Google Pixel 3
Google Pixel 4
OnePlus 7
Samsung
G970F/DS
Huawei P30 DS
Xiaomi Redmi
Note 8 Pro
LPDDR4 (not LPDDR4X)
†
2016 MSM8996
2017 MSM8998
2018
Exynos
9810
2018 Kirin 970
2018
SDM845
SDM845
2018
SDM845
2018
2018
SDM845
SM8150
2019
SM8150
2019
Exynos
9820
2019
2019 Kirin 980
2019
Helio
G90T
Found
Patterns
(cid:2)
Memory
(GB)
4†
4
4
4
4
6
4†
4
6
8
6
6
6
(cid:2)
(cid:2)
(cid:2)
(cid:2)
then examine the memory for RowHammer bit ﬂips in both
true cells and anti cells [51], [68]. In other words, we look
for both 1 → 0 and 0 → 1 bit ﬂips. We show the results for
all the 42 modules in Table II. We now provide a detailed
explanation of these results by discussing them separately for
each DRAM vendor.
Vendor A. In Section VI, we show TRRespass can bypass
how mitigations from manufacturer A. We can recover
multiple effective access patterns for 7 of the 16 modules
in our experiments. In Table II, we provide the number
of bit ﬂips that we observe on the vulnerable A modules.
The results are worrisome: we ﬁnd more than 16K bit ﬂips
on average across the 7 vulnerable modules. In addition
to the large number of bit ﬂips, we also observe that the
bit ﬂips occur with signiﬁcantly fewer row activations on
vendor A’s DDR4 modules compared to previous generation
DDR3 DRAM devices. For example, on A8 and A9, we can
effectively perform 19-sided RowHammer with as few as
∼45K row activations to each of the effective aggressor rows
(i.e., the aggressor rows adjacent to the target victim row(s))
within the 64ms refresh period. In contrast, Kim et al. [51]
show that bit ﬂips occur with ∼139K or more DRAM row
activations on older DDR3 modules.
Vendor B. In Section VI, we describe assisted double-sided
(i.e., 3-sided) and 4-sided hammering as two effective patterns
against a subset of our memory modules from vendor B.
However,
the low bit ﬂip counts in Table II show that
bypassing the TRR mitigation on these modules is non-trivial.
We run further experiments on these modules to understand
the limited number of bit ﬂips we observe. We make two
observations. First, when we repeat for multiple iterations the
Fig. 13: Bit ﬂips vs. number of aggressor rows. Module A10:
Number of bit ﬂips triggered with N-sided RowHammer for varying
number of N on Intel Core i7-7700K. Each aggressor row is one row
away from the closest aggressor row (i.e., VAVAVA... conﬁguration)
and aggressor rows are hammered in a round-robin fashion.
C. TRRespass on LPDDR4(X)
In order to understand how widespread the issue is, we