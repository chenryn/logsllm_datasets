2.6.24,2.6.25,2.6.26,2.6.27,2.6.28,2.6.29,2.6.30,2.6.31,2.6.32,2.6.33,
2.6.34,2.6.35,2.6.36)
33. CVE-2010-1146[reiserfs](2.6.18,2.6.19,2.6.20,2.6.21,2.6.22,2.6.23,
2.6.24,2.6.25,2.6.26,2.6.27,2.6.28,2.6.29,2.6.30,2.6.31,2.6.32,2.6.33,
2.6.34)
34. CVE-2010-0415[do_pages_move](2.6.18,2.6.19,2.6.20,2.6.21,2.6.22,2.6.23,
2.6.24,2.6.25,2.6.26,2.6.27,2.6.28,2.6.29,2.6.30,2.6.31)
35. CVE-2009-3547[pipe.c_32bit](2.4.4,2.4.5,2.4.6,2.4.7,2.4.8,2.4.9,2.4.10,
2.4.11,2.4.12,2.4.13,2.4.14,2.4.15,2.4.16,2.4.17,2.4.18,2.4.19,2.4.20,
2.4.21,2.4.22,2.4.23,2.4.24,2.4.25,2.4.26,2.4.27,2.4.28,2.4.29,2.4.30,
2.4.31,2.4.32,2.4.33,2.4.34,2.4.35,2.4.36,2.4.37,2.6.15,2.6.16,
2.6.17,2.6.18,2.6.19,2.6.20,2.6.21,2.6.22,2.6.23,2.6.24,2.6.25,
2.6.26,2.6.27,2.6.28,2.6.29,2.6.30,2.6.31)
36. CVE-2009-2698[udp_sendmsg_32bit](2.6.1,2.6.2,2.6.3,2.6.4,2.6.5,2.6.6,
2.6.7,2.6.8,2.6.9,2.6.10,2.6.11,2.6.12,2.6.13,2.6.14,2.6.15,2.6.16,
第二课：Linux提权-依赖exp篇
-19-
本文档使用书栈(BookStack.CN)构建
2.6.17,2.6.18,2.6.19)
37. CVE-2009-2692[sock_sendpage](2.4.4,2.4.5,2.4.6,2.4.7,2.4.8,2.4.9,
2.4.10,2.4.11,2.4.12,2.4.13,2.4.14,2.4.15,2.4.16,2.4.17,2.4.18,2.4.19,
2.4.20,2.4.21,2.4.22,2.4.23,2.4.24,2.4.25,2.4.26,2.4.27,2.4.28,2.4.29,
2.4.30,2.4.31,2.4.32,2.4.33,2.4.34,2.4.35,2.4.36,2.4.37,2.6.0,2.6.1,
2.6.2,2.6.3,2.6.4,2.6.5,2.6.6,2.6.7,2.6.8,2.6.9,2.6.10,2.6.11,
2.6.12,2.6.13,2.6.14,2.6.15,2.6.16,2.6.17,2.6.18,2.6.19,2.6.20,2.6.21,
2.6.22,2.6.23,2.6.24,2.6.25,2.6.26,2.6.27,2.6.28,2.6.29,2.6.30)
38. CVE-2009-2692[sock_sendpage2](2.4.4,2.4.5,2.4.6,2.4.7,2.4.8,2.4.9,
2.4.10,2.4.11,2.4.12,2.4.13,2.4.14,2.4.15,2.4.16,2.4.17,2.4.18,2.4.19,
2.4.20,2.4.21,2.4.22,2.4.23,2.4.24,2.4.25,2.4.26,2.4.27,2.4.28,2.4.29,
2.4.30,2.4.31,2.4.32,2.4.33,2.4.34,2.4.35,2.4.36,2.4.37,2.6.0,2.6.1,
2.6.2,2.6.3,2.6.4,2.6.5,2.6.6,2.6.7,2.6.8,2.6.9,2.6.10,2.6.11,2.6.12,
2.6.13,2.6.14,2.6.15,2.6.16,2.6.17,2.6.18,2.6.19,2.6.20,2.6.21,2.6.22,
2.6.23,2.6.24,2.6.25,2.6.26,2.6.27,2.6.28,2.6.29,2.6.30)
39. CVE-2009-1337[exit_notify](2.6.25,2.6.26,2.6.27,2.6.28,2.6.29)
40. CVE-2009-1185[udev](2.6.25,2.6.26,2.6.27,2.6.28,2.6.29)
41. CVE-2008-4210[ftrex](2.6.11,2.6.12,2.6.13,2.6.14,2.6.15,2.6.16,2.6.17,
2.6.18,2.6.19,2.6.20,2.6.21,2.6.22)
42. CVE-2008-0600[vmsplice2](2.6.23,2.6.24)
43. CVE-2008-0600[vmsplice1](2.6.17,2.6.18,2.6.19,2.6.20,2.6.21,2.6.22,
2.6.23,2.6.24,2.6.24.1)
44. CVE-2006-3626[h00lyshit](2.6.8,2.6.10,2.6.11,2.6.12,2.6.13,2.6.14,
2.6.15,2.6.16)
45. CVE-2006-2451[raptor_prctl](2.6.13,2.6.14,2.6.15,2.6.16,2.6.17)
46. CVE-2005-0736[krad3](2.6.5,2.6.7,2.6.8,2.6.9,2.6.10,2.6.11)
47. CVE-2005-1263[binfmt_elf.c](Linuxkernel2.x.xto2.2.27-rc2,2.4.xto
2.4.31-pre1,and2.6.xto2.6.12-rc4)
48. CVE-2004-1235[elflbl](2.4.29)
49. CVE-N/A[caps_to_root](2.6.34,2.6.35,2.6.36)
50. CVE-2004-0077[mremap_pte](2.4.20,2.2.24,2.4.25,2.4.26,2.4.27)
https://github.com/SecWiki/linux-kernel-exploits
https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack/
https://github.com/xairy/kernel-exploits
—ByMicropoor
已对外公开exp注：
第二课：Linux提权-依赖exp篇
-20-
本文档使用书栈(BookStack.CN)构建
Delphi把操作数据的方法分成了两种，一种是function，另一种是procedure，大致理解为“函
数”和“过程”。
Procedure类似C语言中的无返回值函数，即VOID。而Function就是C语言中的有返回值
函数，即没有Void。
程序分为两种连接数据库模式：
Delphi代码审计—项目实战1
1、Function&Procedure
2、连接数据库
第三课：Delphi代码审计—项目实战1
-21-
本文档使用书栈(BookStack.CN)构建
无论是本地模式，还是联网模式，都是读取，当前路径的config.ini配置文件：
（导致敏感信息暴漏，可直连服务器）
第三课：Delphi代码审计—项目实战1
-22-
本文档使用书栈(BookStack.CN)构建
继续跟数据库连接：配合SQLServer数据库，直接带入，可以判断出为明文存储。
config.ini配置如下：
3、config.ini
第三课：Delphi代码审计—项目实战1
-23-
本文档使用书栈(BookStack.CN)构建
基于TCP通信，SQLServer通信构架大致如下：
（可导致通信过程中抓取明文执行）
4、C/S交互过程
第三课：Delphi代码审计—项目实战1
-24-
本文档使用书栈(BookStack.CN)构建
代入执行：（导致可拼接sql语句，查询任意语句或者执行命令）
5、SQL注入
第三课：Delphi代码审计—项目实战1
-25-
本文档使用书栈(BookStack.CN)构建
部分语句其中如下：
1. selectdistinctmemberid,receivecompany
2. fromweighwherereceivecompanyisnotnullandreceivecompanylike
''%'+xxxxxx+'%''
软件呈现如下：
6、Client
第三课：Delphi代码审计—项目实战1
-26-
本文档使用书栈(BookStack.CN)构建
对应收货单位编号，以及收货单位名称。分别为： memberid , receivecompany 。闭合语句为：
1. 2';selectloginidasmemberid,passwordasreceivecompanyfromsysuser--
抓取返回如图：
得到admin账号以及密码。
7、构造SQL语句
第三课：Delphi代码审计—项目实战1
-27-
本文档使用书栈(BookStack.CN)构建
构造读取远程桌面端口号：得到远程服务器端口号
1. 2';EXECmaster..xp_regread'HKEY_LOCAL_MACHINE',
2. 'SYSTEM\CurrentControlSet\Control\TerminalServer\WinStations\RDP-Tcp',
3. 'PortNumber'--
copy获取缓冲区内容：（导致可从服务器端构造代码）
copy用法如下：
copy（a,b,c);
a：就是copy源，就是一个字符串，表示你将要从a里copy一些东西;
b：从a中的第b位开始copy（包含第11位）;
c：copy从第b位开始后的c个字符，
exp：m:=‘thetestfuck’
s：=copy（m,2,2）；//s值为‘he’
当超出范围，会发生异常错误。实例中，从服务器数据库获取数据后进行copy。
软件登陆部分代码如下：（导致可自动化跑loginid。）
8、获取缓冲区内容
第三课：Delphi代码审计—项目实战1
-28-
本文档使用书栈(BookStack.CN)构建
多次尝试错误处理如下：退出软件，并且重新开始计算。
—ByMicropoor
第三课：Delphi代码审计—项目实战1
-29-
本文档使用书栈(BookStack.CN)构建
需要得知周某某的今年采购的其中一个项目具体信息，目前已知该成员是xxx电网。负责丰满大坝的采
购人员。整体思路如下：
找到开发公司->得到源码->审计问题->得到shell->拿到服务器->
得到域控（或者终端管理）->得到个人机->下载任务文件。
得知该电网公司电网相关网站是某公司出品，得到某公司对外宣传网站，并且得到该公司服务器权限，
下载源码模板。
全局共计2个主要文件，分别是Function.asp，Startup.asp。
后台验证项：
来源验证：
注入验证：（目标服务器waf，遂放弃）
ASP代码审计—项目实战2
0x00任务背景：
0x01源码审计：
1、Function.asp
第四课：Asp代码审计—项目实战2
-30-
本文档使用书栈(BookStack.CN)构建
错误处理：
XSS字符处理：
直接输入admin/下文件名处理：
第四课：Asp代码审计—项目实战2
-31-
本文档使用书栈(BookStack.CN)构建
目录生成：针对iis6以及iis7php版本
配置文件：当不可以执行的时候，是否可以备份出数据库，以便下载。
2、Startup.asp
第四课：Asp代码审计—项目实战2
-32-
本文档使用书栈(BookStack.CN)构建
关于新闻显示，全局incudehead.asp
其中check_si.asp主要为防止注入
Get注入
Post注入新版本中加入post注入
3、check_si.asp
第四课：Asp代码审计—项目实战2
-33-
本文档使用书栈(BookStack.CN)构建
过程中遇到服务器卡顿现象，也就是不清楚列名数，本地二分法测试如下：
第四课：Asp代码审计—项目实战2
-34-
本文档使用书栈(BookStack.CN)构建
第四课：Asp代码审计—项目实战2
-35-
本文档使用书栈(BookStack.CN)构建
在admin目录下有个database.asp文件
根据以上信息，构造referrer，构造参数，禁止js。产生出越权漏洞。
4、database.asp
0x02目标测试：
1、越权漏洞
第四课：Asp代码审计—项目实战2
-36-
本文档使用书栈(BookStack.CN)构建
根据越权漏洞，继续看upload.asp文件，允许匿名上传图片文件。在根据越权漏洞备份出webshell
文件
2、上传
第四课：Asp代码审计—项目实战2
-37-
本文档使用书栈(BookStack.CN)构建
第四课：Asp代码审计—项目实战2
-38-
本文档使用书栈(BookStack.CN)构建
得到webshell
3、GetShell
第四课：Asp代码审计—项目实战2
-39-
本文档使用书栈(BookStack.CN)构建
对方没有开启远程桌面，开启：
1. REGADDHKLM\SYSTEM\CurrentControlSet\Control\Terminal""Server/v
fDenyTSConnections/tREG_DWORD/d00000000/f
通过该服务器得到mssql数据库。得到终端管理权限。
4、开启3389
5、GetAdmin
第四课：Asp代码审计—项目实战2
-40-
本文档使用书栈(BookStack.CN)构建
查看在线机器，查找目标人物。
6、查找目标
第四课：Asp代码审计—项目实战2
-41-
本文档使用书栈(BookStack.CN)构建
推送payload反弹。
7、推送Payload
第四课：Asp代码审计—项目实战2
-42-
本文档使用书栈(BookStack.CN)构建
确定是否为目标人物：采购员桌面截图
8、目标确认
第四课：Asp代码审计—项目实战2
-43-
本文档使用书栈(BookStack.CN)构建
按照任务取得该人员的其中一个xls文件
9、Download
第四课：Asp代码审计—项目实战2
-44-
本文档使用书栈(BookStack.CN)构建
任务完成。
10、MissionCompleted
第四课：Asp代码审计—项目实战2
-45-
本文档使用书栈(BookStack.CN)构建
—ByMicropoor
第四课：Asp代码审计—项目实战2
-46-
本文档使用书栈(BookStack.CN)构建
由于Sqlmap是常用工具之一，所以本篇的篇幅较长，详解一次所有参数。
1. Usage:pythonsqlmap.py[options]
2.
3. Options（选项）:
4.
5. -h,--helpShowbasichelpmessageandexit
6. ##展示帮助文档参数
7.
8. -hhShowadvancedhelpmessageandexit
9. ##展示详细帮助文档参数