As described in Section III-A, we assume the attacker knows
which blacklisting strategy is used by the system and can
optimize the guessing strategy by not guessing items on the
blacklist. Here, we consider how much beneﬁt this optimiza-
tion provides. Table VII shows the net gains and losses for
guessing PINs when considering a blacklist-informed attacker.
Knowledge of the blacklist is unhelpful when considering
the placebo (Pla-4 and Pla-6) and the click-through treatments
(iOS-4-wC and iOS-6-wC). The blacklist
is effectively of
size one for the placebo as the ﬁrst choice of a participant
is dynamically blacklisted. Merely knowing that a PIN was
blocked is of little help to the attacker. As there is no clear
gain (or harm), we model a blacklist-knowledgeable attacker
for the placebo treatments (see Table VI).
The case with a non-enforcing blacklist where users can
click through the warning message is more subtle. If the
attacker is explicitly choosing not to consider PINs on the
blacklist, even though they may actually be selected due to
non-enforcement, the guessing strategy is harmed (negative in
Table VII). None of the tested modiﬁcations of this strategy,
e.g. by incorporating the observed click-through rate, lead to
an improvement. As such, we consider an attacker that does
not use the blacklist to change their guessing strategy for the
click-through treatments (iOS-4-wC and iOS-6-wC). In the
remaining treatments (iOS-4-nC, DD-4-27, DD-4-2740), there
are clear advantages when knowing the blacklist.
B. Blacklisting Impact on Security
We now consider how the different blacklists perform
in terms of improving security. The primary results are in
Table VI where we report on the guessing performance against
each treatment. As described in Section III-A, there are certain
rate limits implemented on Android and iOS which is why
we report on throttled attacks with 10, 30, and 100 guesses in
ATTACKER’S GAIN FROM BLACKLIST KNOWLEDGE.
TABLE VII
100 Guesses Guess No. Knowledge
No.
Beneﬁcial
Treatment
Pla-4
iOS-4-wC
iOS-4-nC
DD-4-27
DD-4-2740
Pla-6
iOS-6-wC
30 Guesses
10 Guesses
No.
%
No.
%
%
±0 % ±0 ±0 %
±0 % ±0
±0
-8 %
-2 %
-2 %
-3
-9
-4
+3
+2 %
+6 % +3
+2 % +7
+4 %
+4
+3 % +7
+6 % +5
±0 ±0 % ±0 ±0 % +1
+1 %
±0 % ±0 ±0 %
±0
-6 %
-4 %
-9
±0 % ±0
-5
-7 %
-8
Median
±0
-303
+245
+27
+2740
±0
-7322
–




–

terms of the number and percentage of correctly guessed PINs
(No. and % columns). In addition, we provide the attacker’s
performance in an unthrottled setting based on the median
guess number. The 4-digit attacker is informed by the Amit-4
dataset, while the 6-digit attacker employs the Rock-6 dataset.
Both attackers guess in frequency order with knowledge of the
blacklist where appropriate (see Section VI-A).
We performed a multivariant χ2 test comparison (α = 0.05)
for the PINs guessed within 10, 30, and 100 guesses across
treatments. The test for 10 and 30 guesses did not show any
signiﬁcant difference (p = 0.21 and p = 0.10); the test for
100 guesses did (p < 0.01), as described below.
a) Smaller Blacklists:
In the throttled setting with
100 guesses,
there is little difference among iOS-4-digit-
wCt (15 %), iOS-4-digit-nCt (11 %), DD-4-digit-27 (15 %),
Placebo-4-digit (16 %), compared to Control-4-digit (17 %)
and First-Choice-4-digit
analyses
(Bonferroni-corrected for multiple testing) results support this,
as we found no signiﬁcant difference between the smaller
blacklists. It is therefore hard to justify the combination of
throttling and small blacklists, especially as blacklist warnings
are associated with negative sentiments (see Section VI-F).
(16 %). Our post-hoc
In the unthrottled setting, though, we see some differences
between the smaller and placebo blacklist cases. Notably, the
smallest blacklist (DD-4-digit-27) outperforms the 10× larger
iOS blacklist (iOS-4-digit-nCt). We conjecture this may be
due to iOS’ inclusion of PINs based on repetitions which
were chosen less often by our participants. As a result, in
an unthrottled setting, blacklisting can offer real beneﬁts. The
median guess numbers for both 4- and 6-digit placebos suggest
Authorized licensed use limited to: Cornell University Library. Downloaded on August 30,2020 at 01:28:38 UTC from IEEE Xplore.  Restrictions apply. 
295
that just pushing users away from their ﬁrst choice can improve
security. Unfortunately, direct use of a placebo blacklist is
unlikely to be effective and is problematic in practice as users
will quickly ﬁgure out the deception.
Finally, we reiterate that these improvements to the unthrot-
tled attack setting appear to be only of academic interest: given
the small key space, it is reasonable to assume that all possible
combinations can be exhaustively tested within minutes [33].
b) Large Blacklist: We also consider a very large black-
list in the DD-4-digit-2740 treatment containing 2740 PINs,
10× bigger than the 4-digit iOS blacklist and blocking 27.4 %
of the key space. At this scale, we do see noticeable effects
on security in the throttled setting. Even after 100 guesses,
the attacker ﬁnds only 1 % of 4-digit PINs. Our χ2 tests
support this, for 100 guesses we found a signiﬁcant difference
(p < 0.01). For post-hoc analyses (Bonferroni-corrected) we
found a signiﬁcant difference between the large DD-4-2740
blacklist and Con-6 (p < 0.01) as well as all other 4-digit
treatments: Con-4 (p < 0.001), Pla-4 (p < 0.01), iOS-4-wC
(p < 0.01), iOS-4-nC (p < 0.05), and DD-4-27 (p < 0.01).
This suggests that a larger blacklist can improve security in a
throttled setting.
While similar positive security results are present for the
unthrottled setting, we show in Section VI-E that the larger
blacklist also leads to a perceived lower usability, and thus it
is important to balance the user experience with security gains.
c) Correctly Sizing a Blacklist: While there is a clear
beneﬁt to having a large blacklist, it is important to consider
the right size of a blacklist to counteract negative usability
and user experience issues. This leads to the question: Can a
smaller blacklist provide similar beneﬁts in the throttled setting
and if so, what is an appropriately sized blacklist?
Data from the DD-4-digit-2740 treatment enables us to
simulate how users would have responded to shorter blacklists.
In our user study, we collected not only the ﬁnal PIN accepted
by the system, but also all n − 1 intermediate (ﬁrst-choice,
second-choice, and so on) PINs rejected due to the blacklist.
Consider a smaller blacklist that would have permitted choice
n − 1 to be the ﬁnal PIN, rather than n. To simulate that
smaller blacklist size, we use choice n − 1.
The results of the simulation are shown in Figure 7. We
observe that there are several troughs and peaks in the curves.
We speculate that these relate to changes in user choices as
they move from their ﬁrst choice PIN to their second choice
PIN, and so on due to the expanding blacklist restrictions.
For example, entering the ﬁrst trough, the attacker is most
disadvantaged when it is no longer possible to rely on guessing
only ﬁrst choice PINs and second choice PINs need to be
considered. Eventually,
the blacklist has restricted all ﬁrst
choice PINs, whereby the attacker can now take advantage
of guessing popular second choices which results in a peak.
These cycles continue until the blacklist gets so large that few
acceptable PINs remain, and the attacker’s advantage grows
steadily by guessing the remaining PINs not on the blacklist.
Based on these cycles, we conclude that an appropriately-
sized blacklist should be based on one of the troughs where
Fig. 7. Blacklist size recommendation: For throttled attackers, limited to
100 guesses, a blacklist of ∼ 10 % of the key space (∼ 1150 PINs) is ideal.
an attacker is most disadvantaged to maximize the security
gained in the throttled setting. As we are also concerned about
minimizing user discomfort and frustration (e.g, PIN creation
time, see Table VI), the ﬁrst trough appears the most ideal,
which occurs at about 10 % of the 4-digit PIN space throttled
at 100 guesses. We expect similar results for 6-digit blacklists
as well, but we do not have sufﬁcient examples of selected 6-
digit PINs to perform the same analysis. Future research would
be needed to conﬁrm this. However, as 4-digit PINs are still
exceedingly common, this result provides important insight to
developers to improve user selection of 4-digit PINs.
C. Enforcing the Blacklist
In the 4-digit case, we compared the enforcing (iOS-4-digit-
nCt) with the non-enforcing (iOS-4-digit-wCt) blacklist and
found that enabling a click-through option does not show
signiﬁcant security differences. This suggests that using a
click-through option does not reduce security in the throttled
attacker setting despite the fact that clicked-through PINs are
extremely weak (see row Clicked-through-4 in Table VI).
it
is
uncertain whether the user clicked through (see Table VII).
In an enforcing setting, the attacker can leverage the blacklist
but is equally challenged in guessing the remaining PINs.
These results seem to be driven by the fact
that
We also investigated why participants chose to ignore and
click through the warning messages. From the 28 participants
who saw a blacklist warning in the iOS-4-wC treatment, we
observed a click-through-rate (CTR) of 68 % (19 participants).
In the respective 6-digit treatment iOS-6-wC, 10 out of 15, i.e.,
67 %, ignored the warning. This is twice the rate at which TLS
warnings are ignored (∼ 30 %) [37].
We also asked the 29 participants who pressed “Use Any-
way” about their motivations. The 3 most observed answers
are Memorability Issues: “Because this is the number I can
remember,” Incomplete Threat Models: “Many people don’t
tend to try the obvious PIN as they think it’s too obvious so
people won’t use it,” and Indifference: “I don’t give [sic] about
the warning. Security is overrated.” These ﬁndings are similar
to prior work where users do not follow external guidance for
a number of reasons [26], [48], [34].
Authorized licensed use limited to: Cornell University Library. Downloaded on August 30,2020 at 01:28:38 UTC from IEEE Xplore.  Restrictions apply. 
296
025050075010001250150017502000225025002740Blacklist Size0%5%10%15%20%25%30%35%40%45%50%Percentage GuessedDD-4-digit-2740 - Amitay-4-digit 1000 GuessesDD-4-digit-2740 - Amitay-4-digit   500 GuessesDD-4-digit-2740 - Amitay-4-digit   250 GuessesDD-4-digit-2740 - Amitay-4-digit   100 GuessesDD-4-digit-2740 - Amitay-4-digit     50 GuessesDD-4-digit-2740 - Amitay-4-digit     10 GuessesTreatment
Con-4 0
Pla-4 0
iOS-4-nC 0
iOS-4-wC 0
DD-4-27 0
DD-4-2740 0
Con-6 0
Pla-6 0
iOS-6-wC
0
Security
Memorability
Convenience
20
20
20
20
20
20
20
20
20
40
40
40
40
40
40
40
40
40
60
60
60
60
60
60
60
60
60
80
80
80
80
80
80
80
80
80
100 0
100 0
100 0
100 0
100 0
100 0
100 0
100 0
100
0
20
20
20
20
20
20
20
20
20
40
40
40
40
40
40
40
40
40
60
60
60
60
60
60
60
60
60
80
80
80
80
80
80
80
80
80
100 0
100 0
100 0
100 0
100 0
100 0
100 0
100 0
100
0
20
20
20
20
20
20
20
20
20
40
40
40
40
40
40
40
40
40
60
60
60
60
60
60
60
60
60
80
80
80
80
80
80
80
80
80
100
100
100
100
100
100
100
100
100
Secure
Somew.
secure
Neither
Somew.
insecure
Insecure
Easy
to rmb.
Somew.
easy
Neither
Somew.
hard
Difﬁcult
to rmb.
Easy to
enter
Somew.
easy
Neither
Somew.
hard
Difﬁcult
to enter
Fig. 8. Participants’ perception of their PIN’s security (Secure – Insecure), memorability (Easy to remember – Difﬁcult to remember), and convenience (Easy
to enter – Difﬁcult to enter).
In older versions of iOS, the blacklist warning message
was “Are You Sure You Want to Use This PIN? This PIN
is commonly used and can be easily guessed.” with the safe
option “Choose New PIN” (bold) and the unsafe click-through
option saying “Use PIN.” We observed that Apple changed
this wording with iOS 11 to what is depicted in Figure 4.
Considering that TLS warning design research started with
similarly high CTRs of around 70 % [1], we hope that new
designs can also improve blacklist warning CTRs [37].
D. PIN Changing Strategies
In our study, we asked 367 participants who faced a blacklist
how their creation strategy changed in response to the warning.
We sampled 126 responses (10 % of our total number of par-
ticipants) and grouped them into three categories: participants
who continued using the “Same” strategy, participants who
made “Minor” changes to the strategy, and participants who
came up with a completely “New” strategy. Examples for
those cases can be found in the Appendix E in Table XIII.
Two coders independently coded the data. Inter-rater reliability
between the coders measured by Cohen’s kappa was κ = 0.96.
The results are shown in Table VIII.
About 50 % of the participants choose a new strategy when
confronted with a blacklist warning. Only participants of the
DD-4-27 treatment with a very small blacklist, tended to keep
their pre-warning strategy. The edit distances vary slightly
across the treatments and support this self-reported behavior:
participants in the 4-digit scenario changed on average 3 digits
with the standard deviation showing that some participants
changed their PIN completely while some participants only
changed 2 digits. The same conclusion can be drawn from the
edit distances in the 6-digit case.
E. User Perception
We analyzed participants’ perceptions regarding PIN selec-
tions with respect to security and usability. Participants were
asked to complete the phrase “I feel the PIN I chose is”
with three different adjectives: “secure, memorable, and conve-