Frontrunning the Frontrunners
D r .  P a u l  V i x i e ,  C E O  F a r s i g h t
S e c u r i t y ,  I n c .
© Copyright 2016 Farsight Security, Inc.
All Right Reserved.
Introduction
Frontrunners Exploit Non-Public Information
To Register Domain Names For Profit
• "This Advisory considers the opportunity for a party with 
some form of insider information to track an Internet user’s 
preference for registering a domain name and preemptively 
register that name. SSAC likens this activity to front running in 
stock and commodities markets and calls this behavior domain 
name front running. In the domain name industry, insider 
information would be information gathered from the 
monitoring of one or more attempts by an Internet user to 
check the availability of a domain name."
"SAC 022: SSAC Advisory on Domain Name Front Running,"
ICANN Security and Stability Advisory Committee,
October 2007, [emphasis added]
https://www.icann.org/en/system/files/files/sac-022-en.pdf
Classic "Add Grace Period" Frontrunning 
Was Terminated By ICANN Policy Changes
•
"In response to community concerns about the excessive use and abuse of 
the five-day AGP (Add Grace Period), ICANN implemented two measures to 
address these problems that have resulted in a 99.7% decrease in AGP 
deletes from June 2008 to April 2009. [* * *]  The solution in brief means 
that if a company registers and then returns more than a certain number or 
percentage of domains each month, they are charged for each additional 
registration above that amount. The result is that domain tasting becomes 
increasingly expensive the more a company engages in the practice [...]
"Aside from the problem that domain names may have been difficult to 
register, domain tasting also had a series of negative consequences on the 
manner in which people used the Internet. If individuals accidentally allowed 
their domain names to lapse, it had become extremely difficult for them to 
get the domain back (since it was being picked up and dropped by 
automated systems). Domain tasting also saw an enormous proliferation in 
the number of websites featuring nothing but advertisements, thus leading 
to a form of Internet graffiti."
https://www.icann.org/news/announcement-2009-08-12-en
DNS Query Failure Traffic As A New Potential Source of 
"Insider Information" For Frontrunners?
• We hypothesize that recursive DNS traffic collected from above 
caching recursive resolvers can also potentially drive (and/or 
expose!) speculative domain registration efforts.
• Admittedly, DNS instrumentation normally focuses on domains 
that do resolve rather than domains that don't. 
• In contrast, professional domainers need information about
– (a) domain names that people hit, and 
– (b) which AREN'T registered.
• WHY do domainers need data? 
Ad-hoc vs. Programmatic Registrations
• Small-scale amateur domainers may register a comparative 
handful of domain names:
– Brainstorm a few names while watching TV or taking a shower.
– Manually register those domains. 
– Ad hoc/low volume/sporadic activity.
– We're NOT very interested in these folks.
• Professional domainers, working at scale, tend to be much 
more "data-driven" -- and a bigger problem. They: 
– Identify domains based on empirical data sources, not just "hunches." 
– Programmatically register those names.
– Do so for a material volume of domains on an ongoing basis.
– These are the people/companies we should be paying attention to...
• Does passive DNS have the data the professionals need?
Passive DNS Data Focuses on Successful DNS Queries 
However, We ALSO Have Other Data on DNS Failures
• Data about domain names that people cannot resolve (such as 
NXDOMAINS) would be golden for domainers. They'd love to 
have that sort of data.
• Farsight's not going to give them (or sell them) that data. Why? 
Well...
• Domainers hurt the Internet. They increase costs for those who 
want domains for actual use, complicate life for search engines, 
and decrease the overall Internet signal/noise ratio. Domaining 
is a lot like email spamming.
• We DO need to know if two hypothesized phenomena are 
occurring, however.
The Two Behaviors We Expect We'll See
1) Volumetrically-driven typosquatting: hypothetically, 
domainers may be:
•
Watching DNS query/response traffic
•
Tallying the volume of NXDOMAINs seen by domain, and then
•
Registering the highest volume domains for use in conjunction with 
online advertising programs.
2) Programmatic exploration of domain permutations around 
high value existing brands: "reconnoitering via DNS query."
•
The online analog of Vietnam-war era "recon by fire" 
•
May be seeking available domains that a brand owner might be 
presupposed to buy for brand protection purposes.
•
May be looking for domains that can be used in phishing campaigns, or 
for spamming knock-off products
Data From the 
Security Information Exchange
The Security Information Exchange (SIE)
• Farsight Security may be best known for its passive DNS service, 
DNSDB, but Farsight also operates another service, the less-
well-known Security Information Exchange (SIE).
• SIE is a set of physical locations where Farsight distributes real-
time streaming DNS data as well as other security-relevant data 
received from an international network of hundreds of sensors.
• Cybercrime analysts or academic researchers can select specific 
SIE channels of interest, and then receive (just) those streams
• They can receive this data on a locally-attached system, or via an 
encrypted tunnel started from a remote system. 
• While SIE is a commercial service, Farsight provides free (or 
out-of-pocket-cost-recovery-only) grant access to vetted (but 
unfunded) "Internet Superheroes" working to independently 
combat cybercrime, and to approved university researchers.
The Two SIE Channels We Used
• Channel 221 NXDOMAIN data: This channel answers the 
question, "What (FQDN, rectype)-tuples do we see people 
trying to resolve that don't exist?" 
• Channel 212 Newly Observed Base Domains (NOD) data 
answers the question, "What new effective-2nd-level ("base") 
domains did we just see for the first time?"
1st Channel -- Channel 221: NXDOMAINS
• Volume: 15K observations per second (12-13 Mbps). 
1.3 billion observations/day. That's quite a few observations.
• IMPORTANT: NXDOMAINS are VERY "specific" -- an NXDOMAIN 
for a (FQDN/RecType at time/date foo) does NOT imply that the 
underlying effective 2nd-level domain doesn't exist
• NXDOMAINS is NOT just typos – it's also got LOTS of "junk"
– DNSBL traffic (query for a non-spammy host? ! NXDOMAIN)
– Missing in-addr.arpa's (and ip6.int's, deprecated in Aug 2005)
– Illegal/impossible domains (no dot, too long, illegal characters, 
leaking bogus or locally-made-up "TLDs"), 
• Passive DNS does NOT currently incorporate NXDOMAIN data. 
You CANNOT just query Farsight's DNSDB (or any other passive 
DNS database) to see NXDOMAIN traffic. You MUST wrestle with 
SIE data.
12
Sample Obs From Ch221 In Presentation Format
[88] [2016-06-07 19:01:03.560975962] [2:6 SIE dnsnx] [a1ba02cf] [] [] 
qname: ipv4_1-lagg0-c997.1.sjc002.ix.nflxvideo.net.
qclass: IN (1)
qtype: AAAA (28)
response_ip: 204.13.251.30
soa_rrname: ix.nflxvideo.net.
bold=bita forming the unique tuple (FQDN, recordtype) at date/time
red=the bits of interest to this study
13
nflxvideo.net: already registered, even if "NXD'ing"
$ whois nflxvideo.net
Domain Name: nflxvideo.net
Creation Date: 2011-05-25T12:47:43-0700
Registrant Name: Domain Administrator
Registrant Organization: Netflix, Inc.
Registrant Street: 100 Winchester Circle,
Registrant City: Los Gatos
Registrant State/Province: CA
Registrant Postal Code: 95032
[etc]
NXDOMAINs do NOT mean the base domain is available to 
register! We MUST CHECK TO SEE IF A DOMAIN IS REGISTERED.
14
2nd Channel -- Channel 212 (Newly Observed Domains)
• Volume: roughly three observations per second 
– ~3 obs/sec*(60 sec/min)*(60 min/hr)*(24 hrs/day) = ~259,200
obs/day (comparatively low volume/easy to process)
• 2nd-level effective domains ("delegation point") data: 
example.com, not www.example.com
• Does NOT include domains first seen by Farsight in ICANN ZFA 
zone files
• NOD's a pretty clean data stream
• NOD data DOES gets incorporated into DNSDB
15
Sample Obs From Ch212 In Presentation Format
[98] [2016-07-19 04:14:00.932154893] [2:5 SIE newdomain] [a1ba02cf] [] [] 
domain: startjobs.xyz.
time_seen: 2016-07-19 04:11:31
bailiwick: xyz.
rrname: startjobs.xyz.
rrclass: IN (1)
rrtype: NS (2)
rdata: ns1.sedoparking.com.
rdata: ns2.sedoparking.com.
Note that this is likely an example of a monetized domain (Sedoparking is a 
parked-domain domain-monetization firm)
16
Extracted Obs Per Hour, Ch212 and Ch221, During 
The Data Collection Period (Note Diff Y-Axis Scales)
17
Ch212 (Newly Observed Domains)
Ch221 (NXDOMAINS)
Hottest 2nd Level Domains  From The Full Ch221 Data
440,096,845 ip6.int
121,874,848 spamhaus.org
110,977,781 sophosxl.net
107,574,211 mcafee.com
48,898,438 sophosxl.com
48,469,077 2.ip6.arpa (RIPE NCC)
35,907,658 [large ISP]
33,909,121 spamcop.net
28,726,297 nflxvideo.net
23,916,000 104.in-addr.arpa (ARIN)
21,220,352 barracudacentral.org
19,808,193 surbl.org
18,998,295 intensive.int
17,209,896 sorbs.net
16,007,599 bondedsender.org
14,902,090 10.in-addr.arpa (RFC1918)
14,055,285 [large insurance company]
13,637,914 brightmail.com
13,262,841 habeas.com
12,408,765 isc.org
12,368,645 spameatingmonkey.net
12,284,337 mailspike.net
11,181,446 95.in-addr.arpa (RIPE NCC)
11,058,385 173.in-addr.arpa (ARIN)
10,982,352 17.in-addr.arpa (Apple)
[etc]
These are NOT domains that the 
domainers COULD do anything with...
18
Processing The NXDOMAINS
• We ended up with ~4.5 billion observations for Ch221. 
• To be relevant to potential domainers, the 2nd level effective 
domain cannot be already registered. We need to check to find 
out if each potential domain is already registered, and that's 
TOUGH to do if we need to do it for ~4.5 billion domains.
• We MUST find ways to reduce the number of NXDOMAINS we 
need to check.
• "Good news:" NXDOMAIN observations have lots of "junk" we can 
dump....
19
We Can Drop...
• Domains with Bad Characters
&(\001r\008\011mk\026bcl08\025 2016-06-07 19:19:22
• Domains with Bad Formats
For example, labels that are too long (RFC 1035 2.3.4 says max 
label length is 63 octets)
• Domains with invalid TLDs/no TLD
•
00004109a10090400000000000f01fec.local
•
000fff11668b-home-controller-300
•
What's determinative for valid/invalid TLDs? See
http://data.iana.org/TLD/tlds-alpha-by-domain.txt
• Duplicates/repetitive hits throughout the hour
•
0000.jp had 630 hits during one hour
•
Reduce the query load by ONLY checking for non-existence of the effective 
domain the FIRST time we see it... This is an intentional "simplification" --
the domain COULD get registered during the hour if it wasn't already...
20
Ensure Discovered Effective 2LD's Can Be Registered
• We need to ensure that an an interested party (such as a 
domainer) COULD register the effective 2nd-level domain shown in 
our NXDOMAINs observation, IF they wanted to do so... In some 
cases:
– The TLD might be closed except to some narrowly defined 
community (example: dot int is reserved for nato.int and 
similar international treaty organizations, even if it is often 
used "informally" for "internal" domains)
– Some effective 2nd-level domain name might already be 
registered
• We repeat: just because you saw a domain name mentioned in 
NXD doesn't mean it's registrable for domaining purposes!
21
What Do We Find? 
Did Domains First Seen in NXDOMAINS Eventually 
Show Up Registered/Used in NOD?
Reduce Scope and Winnow That Data Down...
• To keep this manageable, we're actually only going to look at a 
sample -- an hour's worth of processed NXDOMAIN data.
• We'll start with just 50,233,247 Channel 221 observations from
a single hour
• We used a custom piece of code to remove ip6.int, ip6.arpa, in-
addr.arpa, and some other "easy-pickin," "readily-cull-able" stuff, 
plus some illegal characters (!,#,etc) leaving 36,508,570 
observations for further processing.
23
Having processed the entire hour's worth of NXDOMAINS, we 
ended up keeping 1,662,832 domains...
1,662,832/36,508,570*100=4.5% of the original
So the culling process worked, BUT it was slow, taking nearly four
DAYS worth of processing time (single threaded) for just one *hour's*
worth of Ch221 NXDOMAINS data...
We could run more parallel threads to speed that up, obviously. This
is a nice example of the classic embarrassingly parallel problem (c.f.,
https://en.wikipedia.org/wiki/Embarrassingly_parallel ).
We can also pre-filter more efficiently to reduce the number of
domains to check.
24
Matching NXD Domains Against NOD Data
We then read in all 83 hours worth of NOD data, hoping that we'd 
see some of our 1,662,832 residual NXD domains eventually show up 
as having been newly registered in NOD.
We DID see that pattern, just not a lot. We saw 181 NXDOMAIN 
domains from CH221 subsequently show up as registered/used in 
NOD (Ch212).
That's not really very many... That may be:
• A good sign (people aren't culling names to register from 
NXDOMAINs), or
• It may be a sign that we can't see the phenomena: domains 
getting registered aren't getting hit within the first few days, or
what's getting registered shows up in ZFA before we see it in NOD.
25
Sample Matches With NXD Time, NOD Time
23623viaortega.com                     2016/06/07 18:59:04  2016/06/09 22:41:09
2de333fe8d257c3b07b176da743b35d0.org   2016/06/07 19:13:25  2016/06/09  0:13:45 
488d9b5889ba01fc4a0015926945c0f5.org   2016/06/07 19:13:25  2016/06/08  0:12:43 
4la3shezkt6r.com                       2016/06/07 19:13:25  2016/06/08  0:11:57 
505hostel.com                          2016/06/07 18:59:31  2016/06/10  2:18:21 
7wlibclab0py.com                       2016/06/07 19:13:25  2016/06/10  0:09:53 
7wpy34hu345y.com                       2016/06/07 19:13:25  2016/06/08  0:11:57 
abreforming.site
2016/06/07 19:00:38  2016/06/10 17:38:34 
acardianmc.com
2016/06/07 19:05:04  2016/06/10 22:01:07 
acegambling.xyz
2016/06/07 19:07:34  2016/06/07 19:42:07 
amerirech.net
2016/06/07 19:23:55  2016/06/08  2:37:33 
amountstraight.net
2016/06/07 19:07:04  2016/06/07 21:31:55 
arivefloor.net
2016/06/07 19:00:37  2016/06/08  9:31:01 
asapnow.xyz
2016/06/07 19:54:17  2016/06/07 21:43:30 
aurenol.at
2016/06/07 19:27:13  2016/06/09 13:06:13 
azmastergrower.com
2016/06/07 19:04:44  2016/06/07 22:25:08 
bartholomewwinthrop.net
2016/06/07 18:59:35  2016/06/08 21:20:52 
beatseemorearound.net
2016/06/07 18:59:39  2016/06/09 21:06:54 
being.group
2016/06/07 19:04:09  2016/06/08 17:31:40 
besttulsacondos.com
2016/06/07 19:38:31  2016/06/07 23:26:28 
[etc]          
!
!
!
! [GREEN=showed up in NOD Relatively soon after seen in NXDOMAINS]
26
What Else In NXDOMAINS Do We See?
Eyeball This List of Top NXDomains (From One Hour's Worth of 
NXDOMAINs Data): See How Fast It "Tails Off?"
1,842,849 spamhaus.org
1,301,461 sophosxl.net
928,353 mcafee.com
857,609 sophosxl.com
[major ISP elided]
426,533 spamcop.net
302,823 barracudacentral.org
274,890 surbl.org