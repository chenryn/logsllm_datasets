in backbone isps with netpolice,” in Proceedings of
the 9th ACM
SIGCOMM Conference on Internet Measurement, ser. IMC ’09. New
York, NY, USA: ACM, 2009, pp. 103–115.
[Online]. Available:
http://doi.acm.org/10.1145/1644893.1644905
APPENDIX
A. A complete list of drop points in Linux kernel v4.9.3
All of the source-code-level drop points we labeled can be
found in Table VII.
B. TCP PAWS checking in Linux and Snort
As shown in the pseudo-code Listing 1 and Listing 2, the
acceptable TSval ranges of Linux and Snort are “off by 2”.
( ( s i g n e d i n t ) ( l a s t p a c k e t −>t s v a l −
i f
c u r r e n t p a c k e t −>t s v a l ) t s v a l −
i f
l a s t p a c k e t −>t s v a l ) + 1 ) TCP packet size
TCP checksum error
TCP MD5 option check failed
ACK number != server ISN + 1
TCP MD5 option check failed
Challenge ACK (the ACK case)
ACK number >server send next
ACK number older than previous acks but still in window
OFO packet overlap
Empty data packet
Receive window is zero
End SEQ number = rcv nxt + window (out of window)
Receive window is zero
SEQ number <copied seq (SEQ num too old)
PAWS check failed (Timestamp)
Challenge ACK (SYN) (out-of-window)
SEQ out of window
Challenge ACK (RST)
Challenge ACK (SYN)
Packet length <TCP header length
TCP checksum error
Packet size <TCP header length —— TCP checksum error
No RST and no SYN and no ACK ﬂag
ACK ﬂag set
RST ﬂag set
SYN and FIN ﬂags set
No RST and no SYN and no ACK ﬂag
Fastopen tcp check req failed
No RST and no SYN and no ACK ﬂag
SEQ ≥ rcv nxt
Retransmitted SYN
PAWS check failed —— SEQ out of window
SYN or RST ﬂag set
No ACK ﬂag
TCP DEFER ACCEPT drop bare ACK
Total
1
1
2
2
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
4
3
1
1
1
2
1
1
1
1
1
1
1
1
1
2
1
1
1
47
Covered
1
1
1
1
1
1
1
1
1
1
1
1
0
1
1
0
1
1
1
3
3
1
0
1
1
1
1
1
1
1
0
1
1
1
2
1
1
1
39
17