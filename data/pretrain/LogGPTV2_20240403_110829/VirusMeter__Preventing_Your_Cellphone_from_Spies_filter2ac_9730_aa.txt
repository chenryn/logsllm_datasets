title:VirusMeter: Preventing Your Cellphone from Spies
author:Lei Liu and
Guanhua Yan and
Xinwen Zhang and
Songqing Chen
VirusMeter: Preventing Your Cellphone
from Spies
Lei Liu1, Guanhua Yan2, Xinwen Zhang3, and Songqing Chen1
1 Department of Computer Science
George Mason University
2 Information Sciences Group (CCS-3)
Los Alamos National Laboratory
3 Computer Science Lab
Samsung Information Systems America
Abstract. Due to the rapid advancement of mobile communication
technology, mobile devices nowadays can support a variety of data ser-
vices that are not traditionally available. With the growing popularity
of mobile devices in the last few years, attacks targeting them are also
surging. Existing mobile malware detection techniques, which are often
borrowed from solutions to Internet malware detection, do not perform
as eﬀectively due to the limited computing resources on mobile devices.
In this paper, we propose VirusMeter, a novel and general malware de-
tection method, to detect anomalous behaviors on mobile devices. The
rationale underlying VirusMeter is the fact that mobile devices are usu-
ally battery powered and any malicious activity would inevitably consume
some battery power. By monitoring power consumption on a mobile de-
vice, VirusMeter catches misbehaviors that lead to abnormal power con-
sumption. For this purpose, VirusMeter relies on a concise user-centric
power model that characterizes power consumption of common user be-
haviors. In a real-time mode, VirusMeter can perform fast malware detec-
tion with trivial runtime overhead. When the battery is charging (referred
to as a battery-charging mode), VirusMeter applies more sophisticated
machine learning techniques to further improve the detection accuracy.
To demonstrate its feasibility and eﬀectiveness, we have implemented a
VirusMeter prototype on Nokia 5500 Sport and used it to evaluate some
real cellphone malware, including FlexiSPY and Cabir. Our experimental
results show that VirusMeter can eﬀectively detect these malware activi-
ties with less than 1.5% additional power consumption in real time.
Keywords: mobile malware, mobile device security, anomaly detection,
power consumption.
1 Introduction
With the ever-improving chip design technology, the computing power of micro-
processors is continuously increasing, which enables more and more features on
mobile devices that were not available in the past. For example, today many
E. Kirda, S. Jha, and D. Balzarotti (Eds.): RAID 2009, LNCS 5758, pp. 244–264, 2009.
c(cid:2) Springer-Verlag Berlin Heidelberg 2009
VirusMeter: Preventing Your Cellphone from Spies
245
cellphones come with various data services, such as text messaging, emailing,
Web surﬁng, in addition to the traditional voice services. Due to their all-in-one
convenience, these increasingly powerful mobile devices are gaining a lot of pop-
ularity: It has been expected a mobile population of 5 billion by 2015 [1] and out
of 1 billion camera phones to be shipped in 2008, smartphones represent about
10% of the market or about 100 million units [2]. Moreover, the new generation
of mobile devices provide a more open environment than their ancestors. They
now can not only run sandbox applications shipped from original manufacturers,
but also install and execute third-party applications that conform to the norms
of their underlying operating systems.
The new features brought by exotic applications, although rendering mobile
devices more attractive to their users, also open the door for malicious attacks.
By the end of 2007, there were over 370 diﬀerent mobile malware in the wild [21].
The debut of Cabir [3] in 2004, which spreads through Bluetooth connections, is
commonly accepted as the inception of modern cellphone virus [4]. Since then, a
number of malware instances have been found exploiting vulnerabilities of mo-
bile devices, such as Cabir [9] and Commwarrior [8]. These mobile malware have
created serious security concerns to not only the mobile users, but also the net-
work operators, such as information stealing, overcharging, battery exhaustion,
and network congestion.
Despite the immense security threats posed by mobile malware, their detec-
tion and defense is still lagging behind. Many signature- and anomaly-based
schemes for IP networks have been extended for mobile network malware de-
tection and prevention [12,30,31]. For example, Hu and Venugopal proposed to
extract signatures from mobile malware samples and then scan network traﬃc
for these signatures [20]. Similar to their counterparts on IP networks, however,
signature-based approaches can easily be circumvented by various techniques,
such as encryption, obfuscation, and packing. On the other hand, anomaly-based
detection schemes often demand accurate and complete models for normal states
and are thus prone to high false alarm rates.
Recently, behavioral signatures have also been proposed for mobile malware
detection [10]. They have their own limitations. On one hand, monitoring API
calls within an emulated environment and running sophisticated machine learn-
ing algorithms for detection are hardly practical for resource-constrained mobile
devices due to high detection overhead, not mentioning that most manufactur-
ers do not publicize all relevant APIs on commodity mobile devices. On the
other hand, stealthy malware can mimic user behavior or hide its activities
among normal user activities to evade detection by API tracking. For example,
FlexiSPY[5]-like malware that perform eavesdropping does not show anomalies
in the order of relevant API calls, since they are typically implemented as if the
user has received an incoming call. To detect energy-greedy malware and variants
of existing malware, Kim et al. proposed to use power signatures based on sys-
tem hardware states tainted by known malware [22]. Their approach, however,
is mainly useful for detecting known malware and their variants.
246
L. Liu et al.
In this study, we propose VirusMeter, a novel and general mobile malware
detection method, to detect malware on mobile devices without demanding ex-
ternal support. The design of VirusMeter is based on the fact that mobile de-
vices are commonly battery powered and any malware activity on a mobile device
will inevitably consume battery power. VirusMeter monitors and audits power
consumption on mobile devices with a behavior-power model that accurately
characterizes power consumption of normal user behaviors. Towards this goal,
VirusMeter needs to overcome several challenges. First, VirusMeter requires a
power model that can accurately characterize power consumption of user be-
haviors on mobile devices, but such a model is not readily available as yet.
Second, VirusMeter needs to measure battery power in real time. Existing re-
search however shows that precise battery power measurement is diﬃcult due to
many electro-chemical properties. In addition, although in practice mobile de-
vices commonly have battery power indicators, their precision varies signiﬁcantly
from device to device. Examining the battery capacity frequently also incurs high
computational overhead, rendering it hardly practical in reality. Third, as Virus-
Meter aims to run on on-the-shelf mobile devices without external support, it
must be lightweight itself, without consuming too much CPU (and thus battery
power); otherwise, it can adversely aﬀect the detection accuracy.
To overcome these challenges, we design a user-centric power model that, as
opposed to a system-centric model which requires in-depth understanding of
various system-level behaviors and states, has only a small number of states
based on common user operations. VirusMeter is designed to run in two modes:
It, when in a real-time detection mode, performs fast malware detection, but
when in a battery-charging mode, applies advanced machine learning techniques
to detect stealthy malware with high accuracy.
To demonstrate its feasibility and eﬀectiveness, we implement a VirusMeter
prototype on Nokia 5500 Sport and evaluate its performance with real-world
smartphone viruses including Cabir and FlexiSPY. The results show that Virus-
Meter can eﬀectively detect the malware by consuming less than 1.5% additional
power in a real-time mode. In a battery-charging mode, VirusMeter, by using
advanced machine learning techniques, can considerably improve the detection
rate up to 98.6%.
The remainder of the paper is organized as follows. Some related work is
presented in section 2. We overview the VirusMeter design in section 3. We
present our model designs, data collection, and model checking for VirusMeter
in sections 4, 5, 6, respectively. We present our implementation in section 7 and
evaluation results in section 8. We discuss some limitations and future work in
section 9 and make concluding remarks in section 10.
2 Related Work
The increasing popularity of mobile devices with faster microchips and larger
memory space has made them a lucrative playground for malware spreading.
Existing studies [21] show that there are more than 370 mobile malware in the
VirusMeter: Preventing Your Cellphone from Spies
247
wild. As Symbian occupies the largest cellphone OS market share, it has been tar-
geted by most of these mobile malware. Diﬀerent approaches have been employed
to classify existing mobile malware. For instance, mobile viruses have been clas-
siﬁed based on their infection vectors, such as Bluetooth, MMS, memory cards,
and user downloading [13,21]. Currently, user downloading, Bluetooth, and MMS
are the most popular channels for mobile malware propagation. Several studies
on mobile malware have focused on understanding their propagation behaviors.
For example, an agent-based model has been developed to study worms spread-
ing over short-range radio and cellular messaging systems [11]. A probabilistic
queuing model is proposed for the spreading of mobile worms over wireless con-
nections [23], and a detailed mathematical model is also developed in [32] to
characterize speciﬁcally the propagation process of Bluetooth worms. To detect
Bluetooth worm outbreaks, Su et al. proposed to deploy monitors in high-traﬃc
areas [29]. To simulate worm propagation in mobile phone networks, Fleizach et
al. [17] developed a simulator with great details, including realistic topologies,
provisioned capacities of cellular networks, and realistic contact graphs.
Some early studies on defense schemes against mobile malware have mainly
focused on understanding their attack characteristics. For example, various po-
tential attacks from a compromised cellphone and the corresponding defenses
have been studied [15,16,19,26]. An algorithm based on user interactions is pro-
posed to identify vulnerable users [12]. In [30], several schemes have been studied
to mitigate DoS attacks via queuing in the network. To prevent cross service
boundary attacks, a labeling technique is used to separate the phone interface
from the PDA interface of a mobile device [24]. Sarat et al. [27] proposed to
integrate commonwalk lengths and node frequencies to detect worms and deter-
mine their propagation origins. Recently, SmartSiren [13] showed how to use a
proxy to detect malware by analyzing collected user communication logs. Bose et
al. [10] proposed to extract behavioral signatures for mobile malware detection.
So far, existing schemes either have limited eﬀectiveness by targeting particu-
lar situations (such as attacks through SMS), and/or demand signiﬁcant infras-
tructure support, and/or demand non-trivial computing resources from mobile
devices. By contrast, VirusMeter is a general approach, regardless of how mal-
ware invade into a system or whether they are known in advance. VirusMeter is
also lightweight and can run on a mobile device without any external support.
A previous approach that also aims to detect energy-greedy anomalies [22] is
closest to VirusMeter. However, it is only eﬀective to detect known malware and
their variants, and works only for a single process mode which stealthy malware
can easily evade by activating itself on when a user process is active.
3 Overview of VirusMeter Design
The rationale behind VirusMeter is the fact that any malware activities on a mo-
bile device must consume some battery power. Hence, abnormal battery power
consumption is a good indicator that some misbehavior has been conducted.
Accordingly, VirusMeter monitors battery power usage on a mobile device and
248
L. Liu et al.
Data
Collection
VirusMeter
Log
Power
Model
Online
Detection
APIs
(CMsvSession...)
M
o
b
i
l
e
D
e
v
i
c
e
Other 
Applications
VirusMeter
Comms
Framework
Telephone
Services
Networking
Services
Other
Services
Kernel Services and Hardware Interface
n
o
i
t
a
c
i
l
p
p
a
l
e
v
e
l
l
e
v
e
l
m
e
t
s
y
s
Fig. 1. VirusMeter Runs on a Mobile Device
compares it against a pre-deﬁned power consumption model to identify abnormal
activities due to mobile malware.
Figure 1 shows the work ﬂow of VirusMeter when executed on a mobile de-
vice. VirusMeter can run at either the system level or the application level (our
current implementation is at the application level). Running at the system level
is more robust against attacks since mobile OSes, such as Symbian and Windows
Mobile, are often only accessible to device manufacturers or authorized parties.
As shown in the ﬁgure, VirusMeter, using APIs provided by the underlying
mobile OS, collects necessary information of supported services as well as the
current remaining battery capacity. VirusMeter, based on the pre-deﬁned power
model, calculates how much power could have been consumed due to these ser-
vices and then compares it against the actually measured power consumption.
The comparison result portends whether abnormal power draining has occured:
If the diﬀerence exceeds a pre-speciﬁed threshold, VirusMeter raises an alarm
indicating the existence of potential malware. Such comparison can be done in
real time (a real-time mode) for fast malware detection, or when the battery is
charging (a battery-charging mode) for high detection accuracy.
The alarms raised by VirusMeter are instrumental to further revealing ma-
licious activities of the mobile malware. For instance, the user can check the
communication records of her mobile device provided by the network operator
to see whether there are any suspicious phone calls or text messages; she can
also run more advanced virus removal tools to clean the mobile device. Hence,
VirusMeter is a valuable tool to expose malware on mobile devices to their users
at their early stages, thus preventing them from continuously compromising the
service security or data conﬁdentiality of the mobile device.