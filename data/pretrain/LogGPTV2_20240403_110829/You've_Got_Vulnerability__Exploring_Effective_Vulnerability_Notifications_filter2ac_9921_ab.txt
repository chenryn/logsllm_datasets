### 5.9K Chargen Amplifiers, 6.4K NTP Amplifiers, and 71.5K DNS Amplifiers Identified

We identified 5.9K Chargen amplifiers, 6.4K NTP amplifiers, and 71.5K DNS amplifiers across 83.8K distinct IP addresses. To continuously monitor these hosts, we performed daily protocol scans, including Chargen requests, NTP monlist commands, and DNS recursive lookups.

In coordination with the authors of related studies, we ensured that operators were not simultaneously notified. However, it is worth noting that previous efforts have involved notifying DDoS amplifiers [13].

### 3.2 Experiment Variables

To determine the most effective methods for constructing and routing notification messages, we conducted notifications using various methodologies and measured the differences in remediation. Our primary questions were:

- **Who should researchers contact?** Researchers have multiple options for reporting vulnerabilities, such as directly contacting network operators, notifying national CERTs, or requesting their own country’s CERT to disseminate the information. We tested three approaches: (1) notifying the abuse contact from the corresponding WHOIS record, (2) geolocating the host and contacting the associated national CERT, and (3) asking our regional CERT (US-CERT) to propagate the information.
- **How verbose do messages need to be?** It is unclear how much detail is necessary in notifications. We sent three types of messages: (1) a brief message explaining the vulnerability and its impact, (2) a brief message with a link to a website containing detailed information, and (3) a detailed email with information on detection, vulnerability details, and potential remediation steps. The full text of these messages is provided in Appendix B–G.
- **Do messages need to be translated?** We tested sending messages in English and in local languages, translated by native technical speakers.

### 3.3 Group Assignment

To evaluate the impact of our experiment variables, we randomly assigned different notification regimens to experiment groups. Here, we describe the process for constructing these groups.

For each IP address, we extracted the abuse contact from the most specific network allocation's WHOIS record. For dual-stack hosts (16.7% of cases) with different contacts in IPv4 and IPv6 WHOIS records, we used the contact with the deepest level of allocation, preferring IPv6 contacts when all else was equal (4.3% of dual-stack hosts).

To test each variable, we divided the abuse contacts into treatment groups (Table 2). For the ICS and amplifier experiments, we randomly allocated one quarter of abuse contacts to the control group (Group 1), one quarter to the CERT groups (half US-CERT, half national CERTs), and the remaining half to the WHOIS groups. For IPv6, to ensure responsible disclosure, we notified all hosts before the release of the corresponding study [6] in February 2016. We approximated the behavior of the control group using the 25 days of daily scans prior to our notifications. We allocated a third of the IPv6 contacts to the CERT groups and the remainder to the WHOIS groups.

For the vulnerable hosts assigned to the CERT groups, we geolocated each IP using MaxMind [16] and identified the associated CERT. Not all countries have an established CERT organization. This was the case for 2,151 (17%) IPv6 hosts, 175 (8%) ICS devices, and 2,156 (19%) DDoS amplifiers, located in 16, 26, and 63 countries, respectively. Many of these countries are in Africa or Central America, or are smaller island states. We did not include hosts without a CERT organization in the CERT experiment (although we later passed them along to US-CERT).

In total, 64 CERTs were responsible for IPv6 hosts, 57 for ICS, and 86 for amplifiers. To compare direct contact with national CERTs versus having US-CERT distribute information, we randomly divided the affected national CERTs into two halves. For national CERTs in the first half, we contacted them directly with vulnerable hosts in their region (Group 2). We sent the remaining hosts for CERTs in the second half to US-CERT (Group 3).

We obtained native translations of our WHOIS messages for several countries. We allocated contacts in the WHOIS groups that were in those countries (based on WHOIS records) for our language experiment, further detailed in Section 4.3. The remaining contacts were randomly split into three groups based on message verbosity: terse (Group 4), terse with a link (Group 5), and verbose (Group 6).

### 3.4 Notification Process

We sent notification emails with the FROM and REPLY-TO header set to an institutional mailing list: security-notifications@berkeley.edu. Each message included a CSV file with the list of vulnerable hosts, the latest scan timestamp, and the list of vulnerable protocols. We also provided a link to an anonymous survey, which asked for the organization’s perspective on the reported security issue and whether they found our detection and notification acceptable. The messages were sent from a server in UC Berkeley’s network, listed as a valid mail server by UC Berkeley’s SPF policy. We included a randomly generated identifier in each email subject to match replies to the original notification.

### 3.5 Tracking Remediation

We tracked the impact of different notification methodologies by scanning all hosts for several weeks following our notifications. To account for false positives due to random packet loss or temporary network disruptions, we only designated a host as patched if it did not appear vulnerable in any subsequent scans. One limitation in our tracking is the inability to distinguish true patching from network churn, where the host went offline or changed its IP address. While we can still conduct a comparative analysis against our control group, we acknowledge that our definition of patching is a mixture of true patching and churn.

Unless stated otherwise, we consider a host as having taken remediation steps for a particular vulnerability if any of its affected protocols were detected as fixed. Similarly, we say a notification contact has taken remediation steps if any of its hosts have patched. We define the remediation rate as the percentage of notification contacts that have taken remediation steps. This definition is over contacts rather than hosts, as we are measuring the impact of notifying these contacts, and contacts differ in the number of affected hosts.

### 3.6 Ethical Considerations

We followed the guidelines for ethical scanning behavior outlined by Durumeric et al. [10]: we signaled the benign intent of our scans through WHOIS entries and DNS records, and provided project details on a website on each scanning host. We respected scanning opt-out requests and extensively tested scanning methods prior to their deployment.

The ethics of performing vulnerability notifications have not been widely discussed in the security community. We argue that the potential good from informing vulnerable hosts outweighs the risks. To minimize potential harm, we only contacted abuse emails using addresses available in public databases. Additionally, we messaged all unnotified contacts at the conclusion of the study. We offered a channel for feedback through an anonymous survey with questions about the notified organization (described in Appendix A). Because we only collected data about organizational decisions and not individuals, our study did not constitute human subjects research (confirmed by consulting the UC Berkeley IRB committee). Nevertheless, we followed best practices, e.g., our survey was anonymous and optional.

### 4 Results

For both ICS and IPv6, our notifications had a significant impact on patch rates. In our most successful trial—verbose English messages sent directly to operators—the patch rate for IPv6 contacts was 140% higher than in the control group after two weeks. For ICS, the patch rate was 200% higher. However, as shown in Figure 1b, none of our notifications had a significant impact on DDoS amplifiers. This is likely due to the extensive attention DDoS amplifiers have already received in the network operator community, including several prior notification efforts [21]. In addition, these amplifiers were already previously abused in DDoS attacks without administrative responses, potentially indicating a population with poor security stances.

It is also important to note that our best notification regimen resulted in at most 18% of the population remediating. Thus, while notifications can significantly improve patching, the raw impact is limited.

In the remainder of this section, we discuss the impact of each experiment variable and how this informs the construction of future notifications.

To characterize the performance of our trial groups, we measure the area under the survival curve for each group, which captures the cumulative effect of each treatment. To determine if observed differences have statistical significance, we perform permutation tests with 10,000 rounds. In each round, we randomly reassign group labels and recompute the area differences under the new assignments. The intuition is that if the null hypothesis is true and there is no significant difference between two groups, then this random reassignment will only reflect stochastic fluctuation in the area difference. We assess the empirical probability distribution of this measure after completing the permutation rounds, allowing us to determine the probability (and significance) of our observed values.

All reported p-values are computed via this permutation test. We use a significance threshold of α = 0.05, corrected during multiple testing using the simple (although conservative) Bonferroni correction, where each test in a family of m tests is compared to a significance threshold of α/m. Ideally, we would have selected this procedure as part of our original experimental design. Unfortunately, we only identified its aptness post facto; thus, its selection could introduce a selection bias, a possible effect that we lack any practical means to assess.

### 4.1 Notification Contact

For both IPv6 and ICS notifications, directly notifying WHOIS abuse contacts was most effective—particularly early on. Two days after IPv6 disclosure, direct verbose notifications resulted in 9.8% of the population remediating, compared to 3.1% when contacting national CERTs and 1.4% by contacting US-CERT. For ICS, direct notifications promoted 6.8% of the population to patch, more than national CERTs (1.7%) and US-CERT (1.0%). In both cases, direct notifications were notably better than no notifications. As shown in Figures 1a and 1c, this gain was persistent. After two weeks, the patch rate of directly notified IPv6 contacts was 2.4 times as high as the control, and three times as high for ICS contacts.

To determine if these observations are statistically significant, we perform permutation tests using the Bonferroni correction. With six treatment groups, the family of tests is adjusted accordingly.