y
r
i
u
q
n
i
.
g
v
A
s
t
p
m
e
t
t
a
g
n
h
s
i
i
l
b
a
t
s
e
n
o
i
t
c
e
n
n
o
c
n
o
s
t
l
u
s
e
R
 200
 180
 160
 140
 120
 100
 80
 60
 40
 20
 0
succeed, infected
succeed, uninfected
fail, infected
fail, uninfected
 0
 100
 200
 300
 400
 500
 600
 700
Simulation time (sec)
Figure 11. Packet loss rate
due to co-channel
interfer-
75m×75m,
ence (Mobile,
95% conﬁdence interval)
responses per
Figure 12. Average number
of
inquiry
and average inquiry dura-
tion (Mobile, 75m×75m)
Figure 13. Results on suc-
cessful and failed connec-
tion establishing attempts
(Mobile, 75m×75m)
Figure 14 depicts the average time needed to success-
fully establish a connection. After most of the devices are
infected, it is maintained between 1.5 and 2 seconds, which
is similar to the static case. The same graph also gives the
average amount of time needed to replicate the worm code
onto a victim device.
If we disable packet losses due to
co-channel interference, very small variance is observed on
the duration of worm code replication. This conforms to
our earlier ﬁnding that co-channel interference is the major
factor affecting the performance of worm code replication.
6 Modeling Considerations
An accurate worm propagation model can provide use-
ful guidance for effective detection and defense. There have
been substantial efforts on analytically characterizing the
dynamics of Internet worms. A natural question is whether
existing Internet worm propagation models can be directly
borrowed to model Bluetooth worm propagation. To answer
this question, our simulation results can serve for valida-
tion purpose and also provide guidances on what elements
should be captured in a good analytical model.
We start from the logistic model proposed in [17]:
N(t) =N dev × eK(t−T )
(2)
where N(t) be the number of infected devices at time t,
Ndev is the total number of devices in the network, and K
1 + eK(t−T ) ,
and T are the two parameters in the model. In the logistic
model, the growth curve is symmetric around the inﬂection
point, where the growth rate reaches its peak.
A fundamental assumption underlying the logistic model
is that individuals should mix homogeneously so that the
probability an individual infects another one is exactly the
same between any two individuals. This does not hold for
Bluetooth worm propagation in a static network because a
worm can only infect its neighbors. Hence, the model ﬁtting
exercise here is only done on the scenario in Section 5.2
where devices move in a bounded area and are thus mixed
throughout the simulation.
We now examine how well the logistic model ﬁts the
simulation results. Here, we try a simple model ﬁtting
method that still gives us enough insight about how well the
model characterizes the worm propagation. We ﬁx the ini-
tial point N(0) to be 1 and derive the inﬂection point from
the simulation results. Using these two points, we are able
to derive the parameters for the model. In Figure 15, we plot
the average number of infected devices as simulation time
advances and the logistic curve derived according to the
above model ﬁtting method. It is clear that the logistic curve
underestimates the propagation speed at the early phase of
the worm propagation but overestimates it at the late phase.
It is noticed that the logistic model in Equation (2) does not
consider any congestion, which can slow down the worm
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006 
d
e
r
e
v
o
c
s
d
i
s
e
c
v
e
d
i
f
o
r
e
b
m
u
n
m
r
o
w
r
e
p
d
n
o
c
e
s
r
e
p
.
g
v
A
 0.15
 0.14
 0.13
 0.12
 0.11
 0.1
 0.09
 0.08
 0
 100
 200
 300
 400
 500
Simulation time (sec)
Figure 16. Average number
of devices discovered per
second per worm as simula-
tion advances
n
o
i
t
a
r
u
D
 3
 2.5
 2
 1.5
 1
 0.5
 0
 0
worm replication
connection establishment
 100
 200
 300
 400
 500
 600
 700
Simulation time (sec)
i
s
e
c
v
e
d
d
e
t
c
e
f
n
i
f
o
r
e
b
m
u
N
 200
 180
 160
 140
 120
 100
 80
 60
 40
 20
 0
Average, with collision
Logistic, with collision
Average, without collision
Logistic, without collision
 0
 100
 200
 300
 400
 500
Simulation time (sec)
time
Figure 14. Average duration
of connection establishment
and worm replication (Mo-
bile, 75m×75m)
Figure 15. Cumulative num-
ber of infected devices over
simulation
(Mobile,
75m×75m)
propagation. One may wonder whether incorporating ele-
ments that capture packet losses due to co-channel interfer-
ence in the model may lead to a much better model ﬁtting.
We plot the cumulative number of infected devices with-
out co-channel interference and the ﬁtted logistic curve also
in Figure 15. The graph shows that although both curves
move left relative to those with co-channel interference en-
abled, the logistic curve still underestimates the propagation
speed at the early phase of the worm propagation but over-
estimates it at the late phase.
when there exist infected devices in the neighborhood. In
Figure 17, we compare the fraction of uninfected devices
among the whole population and the fraction of uninfected
devices among all the devices discovered as the simulation
time advances in a sample run.
It is clear that relatively
more uninfected devices are discovered than their propor-
tion in the whole population. Hence, a model assuming
the same discovery ratio for uninfected and infected devices
does not fully capture the dynamics of Bluetooth worms.
We also notice that the position of a device on the neigh-
bor list collected by a worm affects the probability that the
device is infected. If a device is closer to the front of the
list, the worm will try fewer devices before starting to in-
fect it and it is thus more likely that the device still remains
in the worm’s radio range when the worm tries to infect
it. Therefore, devices on the front part of the neighbor lists
have higher probability to get infected and vice versa. This
is veriﬁed from our simulation results. Figure 18 plots the
infection probability if a device is uninfected when discov-
ered as opposed to its position on the neighbor list. The
decreasing curve conﬁrms our observation.
7 Effects of Model Parameters
The simulation results with the baseline Bluetooth worm
model in the previous sections gain us some insights about
Bluetooth worm propagation, but it is still unclear how
varying model parameters impacts worm spreading. An ad-
vanced worm may select its parameters strategically to im-
prove its propagation speed.
In the following discussion,
we focus on the type of worms whose objective is to mini-
mize the time required to infect the majority (e.g., 95%) of
all vulnerable devices.
7.1 Tuning Inquiry Parameters
From both Figures 7 and 12, we know that as more de-
vices are infected, the baseline worm has to spend longer
time on collecting its neighbor information and this period
approaches the inquiry timeout value (i.e., Tinq) when the
network is populated with infected devices. The Bluetooth
The observed mismatch suggests that something is still
missing. We mentioned earlier that the logistic function in
Equation (2) assumes that devices are sufﬁciently mixed. It
is important, though, to distinguish the two cases: devices
are physically mixed and devices are logically mixed. Two
devices which are in each other’s communication range can
be neighbors physically, but if both of them perform worm
activities simultaneously, they may not discover each other
and thus they are not neighbors logically. It is obvious that
if we do not consider co-channel interference, worm propa-
gation is essentially affected by the degree to which devices
are mixed logically instead of physically.
In Figure 16, we plot the average number of devices
discovered per second per worm in a sample run (the re-
sults from other sample runs are similar and thus omitted
here). The co-channel interference in this run is disabled to
make explanation easier. It is also worth mentioning that
this graph is different from that in Figure 12 because the
latter gives the average number of devices discovered in a
single infection cycle. The average duration of an infection
cycle may change in the course of the worm propagation.
This is because as more devices are infected in the network,
the inquiry phase lasts longer but fewer neighbors are dis-
covered and contacted. Figure 16 reveals that the overall
logical contact rate between devices actually decreases as
the network is populated with more infected devices. This
can slow down the worm propagation at its late phase.
On the other hand, because an infected device perform-
ing worm activities may not be discovered by its neigh-
bors, the visibility of uninfected devices to a worm increases
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006 1
Fraction of uninfected devices discovered
Fraction of uninfected devices
 0.9
n
o
i
t
c
a
r
F
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
 0
 100
 200
 300
 400
 500
Simulation time (sec)
f
n
I
d
e
t
c
e
f
i
n
n
u
f
i
y
t
i
l
i
b
a
b
o
r
p
d
e
r
e
v
o
c
s
d
n
e
h
w
i
n
o
i
t
c
e
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
 0
 1
 2
 3
 4
 5
 6
 7
The order on the collected neighbor list
)
c
e
s
(
n
o
i
t
c
e
f
n
i
%
5
9
r
o
f
e
m
i
t
n
o
i
t
a
g
a
p