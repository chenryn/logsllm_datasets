PGP
Windows
Thunderbird
●
Outlook
○
Win. 10 Mail
○
Win Live Mail
○
The Bat!
○
Postbox
●
eM Client
○
Linux
KMail
◐
Evolution
◐
Trojitá
◐
Claws
◐
Mutt
◐
macOS
Apple Mail
●
MailMate
●
Airmail
●
iOS
Mail App
●
Android
K-9 Mail
–
R2Mail2
○
MailDroid
○
Nine
○
Web
Exchange/OWA
○
Roundcube
–
Horde/IMP
○
Mailpile
–
● Plaintext can be completely hidden
◐ Plaintext merged with attacker-text
○ No vulnerabilities found
–
Cryptosystem not available
Decryption oracles
● Covert rules kept in reply message
◐ Covert rules only for received mail
Signature oracles
20
OS
Client
Decryption
Signatures
S/MIME
PGP
S/MIME
PGP
Windows
Thunderbird
●
●
Outlook
○
○
Win. 10 Mail
○
–
Win Live Mail
○
–
The Bat!
○
○
Postbox
●
●
eM Client
○
○
Linux
KMail
◐
◐
Evolution
◐
◐
Trojitá
◐
◐
Claws
◐
◐
Mutt
◐
◐
macOS
Apple Mail
●
●
MailMate
●
●
Airmail
●
●
iOS
Mail App
●
–
Android
K-9 Mail
–
○
R2Mail2
○
●
MailDroid
○
○
Nine
○
–
Web
Exchange/OWA
○
–
Roundcube
–
◐
Horde/IMP
○
○
Mailpile
–
○
● Plaintext can be completely hidden
◐ Plaintext merged with attacker-text
○ No vulnerabilities found
–
Cryptosystem not available
Decryption oracles
● Covert rules kept in reply message
◐ Covert rules only for received mail
Signature oracles
20
OS
Client
Decryption
Signatures
S/MIME
PGP
S/MIME
PGP
Windows
Thunderbird
●
●
●
Outlook
○
○
◐
Win. 10 Mail
○
–
◐
Win Live Mail
○
–
●
The Bat!
○
○
○
Postbox
●
●
●
eM Client
○
○
◐
Linux
KMail
◐
◐
○
Evolution
◐
◐
◐
Trojitá
◐
◐
◐
Claws
◐
◐
○
Mutt
◐
◐
○
macOS
Apple Mail
●
●
◐
MailMate
●
●
●
Airmail
●
●
●
iOS
Mail App
●
–
●
Android
K-9 Mail
–
○
–
R2Mail2
○
●
◐
MailDroid
○
○
●
Nine
○
–
●
Web
Exchange/OWA
○
–
●
Roundcube
–
◐
◐
Horde/IMP
○
○
◐
Mailpile
–
○
–
● Plaintext can be completely hidden
◐ Plaintext merged with attacker-text
○ No vulnerabilities found
–
Cryptosystem not available
Decryption oracles
● Covert rules kept in reply message
◐ Covert rules only for received mail
Signature oracles
20
OS
Client
Decryption
Signatures
S/MIME
PGP
S/MIME
PGP
Windows
Thunderbird
●
●
●
●
Outlook
○
○
◐
◐
Win. 10 Mail
○
–
◐
–
Win Live Mail
○
–
●
–
The Bat!
○
○
○
○
Postbox
●
●
●
●
eM Client
○
○
◐
◐
Linux
KMail
◐
◐
○
○
Evolution
◐
◐
◐
◐
Trojitá
◐
◐
◐
◐
Claws
◐
◐
○
○
Mutt
◐
◐
○
○
macOS
Apple Mail
●
●
◐
◐
MailMate
●
●
●
●
Airmail
●
●
●
●
iOS
Mail App
●
–
●
–
Android
K-9 Mail
–
○
–
●
R2Mail2
○
●
◐
◐
MailDroid
○
○
●
●
Nine
○
–
●
–
Web
Exchange/OWA
○
–
●
–
Roundcube
–
◐
◐
◐
Horde/IMP
○
○
◐
◐
Mailpile
–
○
–
○
● Plaintext can be completely hidden
◐ Plaintext merged with attacker-text
○ No vulnerabilities found
–
Cryptosystem not available
Decryption oracles
● Covert rules kept in reply message
◐ Covert rules only for received mail
Signature oracles
20
OS
Client
Decryption
Signatures
S/MIME
PGP
S/MIME
PGP
Windows
Thunderbird
●
●
●
●
Outlook
○
○
◐
◐
Win. 10 Mail
○
–
◐
–
Win Live Mail
○
–
●
–
The Bat!
○
○
○
○
Postbox
●
●
●
●
eM Client
○
○
◐
◐
Linux
KMail
◐
◐
○
○
Evolution
◐
◐
◐
◐
Trojitá
◐
◐
◐
◐
Claws
◐
◐
○
○
Mutt
◐
◐
○
○
macOS
Apple Mail
●
●
◐
◐
MailMate
●
●
●
●
Airmail
●
●
●
●
iOS
Mail App
●
–
●
–
Android
K-9 Mail
–
○
–
●
R2Mail2
○
●
◐
◐
MailDroid
○
○
●
●
Nine
○
–
●
–
Web
Exchange/OWA
○
–
●
–
Roundcube
–
◐
◐
◐
Horde/IMP
○
○
◐
◐
Mailpile
–
○
–
○
● Plaintext can be completely hidden
◐ Plaintext merged with attacker-text
○ No vulnerabilities found
–
Cryptosystem not available
Decryption oracles
● Covert rules kept in reply message
◐ Covert rules only for received mail
Signature oracles
20
1. Introduction
2. Attacks on Encryption
3. Attacks on Signatures
4. Evaluation
5. Mitigation
Overview
21
1. Introduction
2. Attacks on Encryption
3. Attacks on Signatures
4. Evaluation
5. Mitigation
Overview
21
Decryption oracles
22
• Accepting ASCII text only
Decryption oracles
22
• Accepting ASCII text only
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
• Warn on partial encryption
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
• Warn on partial encryption
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
• Warn on partial encryption
• All-or-Nothing Encryption
Decryption oracles
22
• Accepting ASCII text only
• Enforcing digital signatures
• Warn on partial encryption
• All-or-Nothing Encryption
Decryption oracles
Root causes: long-term keys +
ciphertext usage out-of-context
22
Signing oracles
23
• Dropping CSS Support
Signing oracles
23
• Dropping CSS Support
Signing oracles
23
• Dropping CSS Support
• Only ASCII Text in replies
Signing oracles
23
• Dropping CSS Support
• Only ASCII Text in replies
• Remove styles from replies
Signing oracles
23
Conclusion
24
• Crypto is not enough, bypasses exist
Conclusion
24
• Crypto is not enough, bypasses exist
• 22 of 24 tested clients are vulnerable
Conclusion
24
• Crypto is not enough, bypasses exist
• 22 of 24 tested clients are vulnerable
• Building security on top of email is hard
Conclusion
24
• Crypto is not enough, bypasses exist
• 22 of 24 tested clients are vulnerable
• Building security on top of email is hard
Conclusion
Thank you! Questions?
Exploits: github.com/RUB-NDS/Covert-Content-Attacks
24
HTML and CSS support in various email clients
Proprietary conditional features
Blinding options