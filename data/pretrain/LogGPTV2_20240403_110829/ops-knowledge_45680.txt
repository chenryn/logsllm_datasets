User: How to install and configure OpenVPN on a Linux server for remote access to the internal network?
Assistant: Here are the steps to install and configure OpenVPN on a Linux server to allow remote access to the internal network: 1. Install the OpenVPN package You need to install the OpenVPN package on the server. On Debian and Ubuntu, the following command can be used: sudo apt-get install openvpn On CentOS and Red Hat, the following command can be used: sudo yum install openvpn 2. Generate a certificate and key To use OpenVPN, a certificate and key must be created . Run the following commands to create: cd /usr/share/easy-rsa/3.0.5/ ./easyrsa init-pki ./easyrsa build-ca nopass ./easyrsa gen-req server nopass ./easyrsa sign server server ./easyrsa gen -dh openvpn --genkey --secret /etc/openvpn/ta.key 3. Configure the OpenVPN server Create a "server.conf" configuration file on the OpenVPN server, including the following information: dev tun proto udp port 1194 ca /usr/ share/easy-rsa/3.0.5/pki/ca.crt cert /usr/share/easy-rsa/3.0.5/pki/issued/server.crt key /usr/share/easy-rsa/3.0.5/ pki/private/server.key dh /usr/share/easy-rsa/3.0.5/pki/dh.pem server 10.8.0.0 255.255.255.0 ifconfig-pool-persist /var/log/openvpn/ipp.txt keepalive 10 120 tls-auth /etc/openvpn/ta.key 0 cipher AES-256-CBC user nobody group nogroup persist-key persist-tun status /var/log/openvpn-status.log verb 3 4. Create an OpenVPN user by creating " user.ovpn" file and specify the following content to generate certificates and keys for OpenVPN users: client dev tun proto udp remote [server IP] 1194 resolv-retry infinite nobind persist-key persist-tun ca /usr/share/easy- rsa/3.0.5/pki/ca.crt cert /usr/share/easy-rsa/3.0.5/pki/issued/client.crt key /usr/share/easy-rsa/3.0.5/pki/private/ client.key tls-auth /etc/openvpn/ta.key 1 cipher AES-256-CBC verb 3 Replace "[server IP]" with your server's public IP address. 5. Start the OpenVPN server Before running OpenVPN, please ensure that the SELinux state is "permissive" (you can use the command "setenforce 0" to weaken SELinux). Start the OpenVPN server: sudo systemctl start openvpn@server Enable the OpenVPN server with the following command: sudo systemctl enable openvpn@server You can now connect to the server from the client. Use sudo sh -c "echo net.ipv4.ip_forward=1 >> /etc/sysctl.conf" to implement IP forwarding. It should be noted that port number 1194 is opened on the firewall.