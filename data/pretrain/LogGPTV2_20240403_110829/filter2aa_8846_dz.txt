持本地扩展和数字证书等类型，如，开放 PGP 的。SSH 的最初设计是为 UNIX，但现在的操作系
统都支持 SSH，包括 Windows, Macintosh 的实现，和 OpenVMS。
5.永久虚拟电路(PVC)和交换虚拟电路(SVC)
虚电路为终端系统连接提供高带宽、多用户电缆或光纤的一个专用的物理电路，其表现为
一个专有电路。有两种类型的虚电路，基于当电路中的路径建立。
*在永久虚电路 PVC 中，当电路被购买后，运营商配置电路的路线。除非承运人改变路线
调整网络，或响应一个中断等，否则路线不会被改变。
*另一方面，一个交换虚电路 SVC 用于动态配置，更像是一个拨号连接。
5.虚拟私有网络（VPN）Virtual Private Network
VPN 是上一章的内容，和 IPsec、SSL 一起放到本章来讲。这个是必考的。
虚拟专用网(VPN)是一个通信隧道，它可以在不可信的中间网络上提供身份验证和数据通
信的点对点传输。大多数 VPN 使用加密技术来保护封装的通信数据。VPN 在不安全的或不可信
的中间网络上提供了机密性和完整性，但是并不提供和保证可用性。
①隧道技术
—132—
你能真正理解 VPN 之前，你必须先理解隧道技术。隧道技术是网络的通信过程，它通过将
协议包封装到其他协议包中来保护协议包的内容。隧道技术可以用在很多场合(如绕过防火墙、
网关、代理或其他通信控制设备时)。通过将受限制的内容封装入己授权传输的数据包，就可
以实现旁路。每当使用安全的 SSL 或 TLS 访问 Web 站点时，就会使用到隧道技术，此时明文
Web 通信通过隧道技术被装入 SSL 或 TLS 会话。此外，如果使用互联网电话或 VoIP 系统，那
么语音通信会通过隧道技术被装入某种 VoIP 协议。
隧道技术也存在缺点：隧道会消耗额外的网络带宽。此外，隧道技术是一种点对点的通信
机制，并且设计时没有考虑对广播通信的处理。隧道技术也使得在某些情况下监控流量的内容
变得很难。
②VPN 协议
有四种常用的 VPN 协议：PPTP, L2F, L2TP 和 IPSec。（SSL/TLS 也可以被用来作为一个
VPN 协议，而不只是作为一个工作在 TCP 之上的会话加密。不过 CISSP 并不把 SSL/TLS 作为
VPN 来考。）
PPTP+L2F=>L2TP；L2TP+IPSec=VPN。
PPTP, L2F, L2TP 工作在第二层，IPSec 在第三层；
PPTP, L2F,IPSec 仅用于 IP 网络，L2TP 可用于任何局域网协议（LAN）。
VPN 总结如下表，协议详述在后面：
1.点对点隧道协议 Point-to-Point Tunneling Protocol
点对点隧道协议(PPTP)是从拨号协议点对点协议(PPP)开发出来的一种封装协议。它工作
在 OSI 模型的数据链路层(第二层)，依靠通用路由封装(GRE)来建立隧道，并且被用在 IP 网络
中，PPTP 不支持 TACACS+和 RADIUS。PPTP 在两个系统之间创建了一个点对点隧道，并且封装
了 ppp 包。使用与 PPP 相同的身份验证协议，这些身份验证协议包括：
①Microsoft 挑战握手身份验证协议(MS-CHAP)
②挑战握手身份验证协议(CHAP)
③密码身份验证协议(PAP)
④扩展身份验证协议(EAP)
⑤Shiva 密码身份验证协议(SPAP)
CISSP 考试的重点是 PPTP 的 RFC2637 版本，而不是微软版本的实现，那个版本进行了专
有修改并使用微软点对点加密（MPPE）来支持数据加密。PPTP 使用的最初隧道协商过程并没
有加密。因此，包含发送者和接收者 IP 地址(可以包括用户名和散列密码)的会话建立通信包
可能被第三方截获。PPTP 被用在 VPN 上，但是它常常被第二层隧道协议(L2TP)替代。L2TP 可
—133—
以使用 IPSec 为 VPN 提供通信加密。
2.二层转发协议 L2F 和二层隧道协议 L2TP/Layer 2 Forwarding Protocol and Layer 2
Tunneling Protocol
Cisco 公司开发了自己的 VPN 协议：第二层转发协议(L2F)，这是一种相互的身份验证隧
道机制。然而，L2F 并不提供加密。L2F 没有得到广泛部署，并且很快被 L2TP 所取代。正如它
们的名字所提示的，它们都工作在第二层。它们都可以封装任何局域网协议。
二层隧道协议(L2TP)源自于 PPTP 和 L2F 的组合。L2TP 会在通信的端点之间建立了一个点
对点的隧道。L2TP 缺乏内置的加密方案，而是通常依赖 IPSec 作为它的安全机制。L2TP 还支
持 TACACS+和 RADIUS。IPSec 通常为 L2TP 用做一种安全机制。
3. IP 安全协议/ IPSec/IP Security Protocol（重点）
目前最常用的 VPN 协议是 IPSec。IPSec 既是一个独立的 VPN 协议，又是用于 L2TP 的安
全机制，并且只能用于 IP 通信。IPSec 提供了安全的身份验证以及加密的数据传输。IPSec
会改变数据包的报头中的 IP 地址，这可以被认为是一种攻击，因此，NAT 与 IPSec 不能同时
工作。为了解决这两个协议的不兼容问题，可以使用 NAT 穿越(又名 IPSec NAT-T)技术，封装
UDP 端口 4500(参见 RFC 3948)。第三域 I.6 章节也提了下 IPSec。
IPSec 具有下列 3 个主要的组件或功能：
①身份验证头(AH)。AH 提供身份验证、完整性以及不可否认性。在每个数据包(头+数据)
传输之前，一个使用共享秘钥加密数据包内容的哈希值(除了数据包路由时需要使用的信息，
这个地址信息有可能改变)将被插入到 AH 包头中。终端系统之间协商使用哈希算法和共享密钥
后，它们建立安全关联 SA。为帮助防止重放攻击(一个合法会话，被重新转发以获得未经授权
的访问权限)，每个数据包在发送时，其 SA 都有一个序列号，并将其存储在 AH 中。在传输模
式，AH 之间插入数据包的 IP 和 TCP 报头。AH 有助于确保真实性和完整性，不保证其机密性。
加密是通过封装安全载荷(ESP)来实现的。
②封装安全有效载荷(ESP)。ESP 提供了加密，从而能够保护传输数据的机密性，也可以
执行有限的身份验证操作。ESP 在网络层(第三层)上工作，包含四个部分：
*ESP 头部/报头：包含安全关联(SA)使用，数据包的序列号。和 AH 一样，ESP 给每一个数
据包编一个序列号，以阻止重放攻击。
*ESP 有效负载：负载包含数据包的加密部分。ESP 通常使用对称加密算法。
*ESP 尾部：包括填充(填充字节)，满足要求的加密算法的分组字串长度。
*ESP 认证部分/身份认证：如果要使用身份认证，此 ESP 数据包字段应包含完整性检查值
(Hash)。就像也相当于 AH 包头，终端系统相互协商身份认证算法来建立安全关联 SA。
ESP 有两种模式：
传输模式：只加密 IP 数据包，数据包的头部并没有进行加密。主要用于客户端和服务器
等端到端的保护。
隧道模式：整个 IP 数据包都加密，并且新的数据包头被添加至 IP 数据包，从而能够控制
通过隧道进行的传输。通常用于网络之间，如防火墙的 VPN。
③安全关联/安全联盟(SA)
SA 是终端系统间通信的沟通机制。所有的 SA 只能单向传输，双工通信必须要 2 个 SA。
—134—
④因特网密钥交换协议 IKE protocol
因特网密钥交换协议（IKE）允许两个设备“交换”对称密钥，用于在 AH 和 ESP 加密信息。
有两种方式来“交换”密钥：
1 使用 Diffie-Hellman (DH) 式的协商
2.使用公钥证书（PKI）。IKE 会考到，但书上没写详细，算了。
4.SSL/TLS VPNs
SSL(安全套接字层)v3 和 TLS(传输层安全)v1.2 基本上是完全兼容的，最初的 SSL 加密工
具是由 Netscape 开发，TLS 1.2 是由开放标准的 IETF 基于 SSL3.0 开发的。SSL 和 TSL 使用公
钥证书进行彼此身份验证，它们相互认证。
SSL VPN 是远程访问的另一种方法。不像建立一个网络层的 IPSec VPN，SSL VPN 利用 SSL/
TLS 创建隧道回到家庭办公室。远程用户使用 Web 浏览器来访问该组织的网络应用。即使用户
使用 Web 浏览器，SSL VPN 不仅限于使用 HTTP。指插件的帮助下，如 Java，用户可以访问后
端数据库，和其它非 Web 应用程序。SSL VPN 与 IPSec VPN 相比有几个优势。它们比 IPSec 更
容易部署在客户端工作站，因为它们只需要一个 Web 浏览器，和几乎所有的网络允许传出 HTTP。
SSL VPN 可以通过代理服务器的操作。此外，应用程序可以根据安全标准限制用户的访问权限，
如外网网络用户，SSL 有助于建立企业的外联网络。
5.高保证互联网协议加密(HAIPE)
基于 IPSec 的 HAIPE 具有额外的限制和增强：例如，使用高保证硬件加密所有的通讯设
备上对组播数据加密的能力，但是所有设备上的相同的密钥需要手工加载。HAIPE 是 IPSec 的
一个扩展，可用于高度安全的通信，如，使用在军事应用。
高保障 IP 加密机 HAIPE：不通过网络来协商密钥，全部预置在硬件设备里，这样更安全。
C.4 数据通信（例如：VLAN,TLS/SSL）
1.网络拓扑 Network Topologies
环型 ring、总线型 bus、星型 star 和网状型 mesh。都很简单，不讲了。
2.单播 unicast、组播 multicast、广播 broadcast 还有任播 anycast
一对一的主机传输称为单播传输。
广播有特定的使用用途。己知一个路由器的 IP 地址，但不清楚设备的 MAC 地址时，路由
器将广播地址解析协议(ARP)的请求，以解析设备的 MAC 地址。
多播就是组播，目的是要提供一个流，只传送感兴趣的主机。无线电广播是一种多播典型
类型。选择一个特定的电台节目，你需要调整收音机的特定广播电台。同样，获得所需的多播
服务，你需要加入相应的组播组。组播代理用于在网络及管理组播组中路由组播流量。每个支
持组播的网络和子网络必须至少有一个组播代理。主机使用 Internet 组管理协议(IGMP)通告
本地的组播代理，它想加入一个特定的组播组。组播代理也路由组播到本地主机的组播组成员
和中继组播到邻近的代理。当一个主机要离开一个多播组，它发送一个 IGMP 消息到本地组播
代理。组播不使用可靠会话。因此，组播是尽力而为的传送，不保证数据报接收。
任播允许源节点向一组目标节点中的任一节点发送数据报；在 DNS 防护中得到普遍引用。
3.交换网络
—135—
两个系统(单独的计算机或 LAN)通过多个中间网络连接肘，从一个系统向另一个系统传输
数据包的任务是非常复杂的过程。为了简化这个任务，交换技术应运而生。
①电路交换网络（模拟）
主要用于电话网，PSTN 什么的。在终端系统之间，电路交换网络建立专用电路。这些电
路由专用交换机连接。直到电路完全建立，终端系统开始通讯。终端系统使用专用电路及带宽。
运营商计费是基于打开连接的持续时间电路的成本，这使得这种类型的网络终端系统间是稳定
的经济通信。实例，电路交换网络是普通旧式电话服务(POTS)，综合业务数字网(ISDN)，和点
对点协议(PPP)。
②分组交换网络（数字）
端系统之间的分组交换网络不使用专用连接。相反，数据分割分为数据包在一个共享的网
络传输。每个数据包中包含的元信息，它可以独立地在网络中路由。网络设备将尝试为每个数
据包目的地寻找最佳路径，数据包可以采取不同的路径和不同的顺利到达网络对端。目标端点
有责任确保接收到的数据包，以正确的顺序在堆栈中重组。
4.虚拟局域网 Virtual LAN
虚拟局域网（VLAN）被用于硬件上以实施网络分割，这是交换机的最基础功能。搞网络的
都配过 VLAN，没什么好说的。
VLAN 可以控制流量，管理子网，对安全而言有以下功能和好处：
①控制和限制广播流量。阻断在子网和 VLAN 中的广播。
②在子网之间隔离通信和流量。
③减少网络被监听的脆弱点。
④抑制对抗广播风暴(泛洪攻击)。
⑤端口隔离或私有端口。
5.广域网 WAN
搞通信的，做主干网维护的就很清楚。一般分为专线（电信信道）和非专线（拨号）。
专线有欧洲标准和美国标准，都是基于电信光纤传送网的传输系统。
①美国电信专线
0 级数字信号 DS-0，T1，64K 到 1.544M；
1 级数字信号 DS-1，T1，1.544M，24 路电话；
2 级数字信号 DS-2，T2：4×T1，6.312M；
3 级数字信号 DS-3，T3：7×T2，28 个 T1，44.736M；
4 级数字信号 DS-4，T4：6×T3，274.176M。
②欧洲电信专线（中国用的多）
欧洲数字传输格式 1，E1：2.048M；
欧洲数字传输格式 2，E2：8.848M； E3：34.304M； E4：139.264M。
Optical Carrier (OC) Bandwidth：
OC-1：51.84M； OC-3：155.52M
OC-9：466.56M； OC-12：622.08M
—136—
OC-18：933.12M； OC-24：1244.16M
OC-36：1866.24M； OC-48：2488.32M
OC-192：9953.28M。
③数字用户线路(DSL)
DSL 技术利用升级电话网使用户的通信速度达到 144Kbps 至 6Mbps(或更高)的水平。DSL
存在多种格式，例如 ADSL、xDSL、CDSL、HDSL、SDSL、RASDSL、IDSL 与 VDSL，每种格式的区
别在于所提供的下行带宽和上行带宽有所变化，最大传输距离大有几公里。针对考试而言，只
需要理解 DSL 的总体概念。
*不对称数字用户线(ADSL)：下行传输速率比上行的大得多，一般是 256 到 512 Kbps 的下
游和上游 64 kbps。
*速率自适应 DSL(RADSL)：上行传输速率自动调整基于线路质量。
*对称数字用户线(SDSL)：使用相同的速率上行和下行传输。
*高速 DSL (VDSL)：支持的传输速率比其他 DSL 技术更高，如 13Mbps 下行和 2Mps 上行。
*宽带 DSL(HDSL) High-Data-Rate Digital Subscriber Line：上下行相，都是 1.544Mbps。