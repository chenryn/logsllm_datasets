Saâd Kadhi, Leader 
MISP SUMMIT 04 / 2018-10-15 	TLP:WHITE
MISP, THEHIVE & CORTEX 
BETTER, FASTER, HAPPIER
OVERVIEW
THEHIVE PROJECT
| GOALS | HOW | WHAT (TOOLS) |
|---|---|---|
| DRIVE THE TIME TO DETECT & REACT |ALERT/EVENT COLLECTION |CYBER THREAT  INTELLIGENCE |
| CONTRIBUTE TO THE COMMUNITY |AUTOMATION |INCIDENT RESPONSE |
| CONTRIBUTE TO THE COMMUNITY |COLLABORATION |DIGITAL FORENSICS || WHAT (TAKE TWO) |WHO |SINCE WHEN |
| LIBRARIES | LIBRARIES | THEHIVE CORE TEAM (6 MEMBERS) | AGPL 
V3 | OCT 2014 (PRIVATE VERSION) |
|---|---|---|---|---|
| LIBRARIES |LIBRARIES |THEHIVE CORE TEAM (6 MEMBERS) |AGPL  V3 |NOV 2016 (FLOSS) |
| SYNAPSE |‘FEEDERS’ |A LARGE COMMUNITY (SOC/CSIRT/CERT) |AGPL  V3 |FEB 2017 (CORTEX) |
▸ SIRP / SOAR 
▸ collaborate in real-time▸ collaborate in real-time 
▸ Fully customisable dashboards : track activity, follow KPIs… ▸ Use Cortex for at-scale analysis & active response
▸ Leverage MISP for CTI functions 
▸ Multiple auth methods (LDAP, AD, OAuth 2, API keys…) ▸ Webhook support
▸ Observable analysis & active response engine  	93 
ANALYZERS
▸ Analyze using the Web UI or through the REST API ▸ Respond & take action▸ Use Python (or other languages) to write your own ▸ TheHive can leverage 1 or multiple Cortex instances ▸ Use MISP for additional analysis possibilities
▸The de facto standard for threat sharing 
▸Threat intelligence collection, sanitisation & dissemination 
▸Correlation & intelligence storage
▸ Supports tagging, galaxies, objects, taxonomies such as ATT&CK, & 	much more 
	OR BOTH 
	AT THE SAMEOR BOTH 
	AT THE SAME 
▸ Can be highly automated 	TIME
▸ TheHive can import from or export to multiple MISP instances ▸ Tightly integrated with Cortex for indicator enrichment
WORKFLOW
| CASE 
TEMPLATE | USER | ADMIN / AUDIT |
|---|---|---|
| CASE  TEMPLATE |CASE |	ALERT /  MISP EVENT |
	RESPONDER RESPONDER RESPONDER TASK TASK TASK OBSERVABLE OBSERVABLE OBSERVABLE ANALYZER ANALYZER ANALYZERACTION ACTION ACTION LOG LOG LOG ANALYSIS 
	REPORT JOB JOB JOB 	REPORT 
TEMPLATE
TASK GROUPS
INTEGRATION
| Alert/Case Sources SIEM, email, CTI provider… | Feeders | Feeders |
|---|---|---|
| Alert/Case Sources SIEM, email, CTI provider… |Raise alerts |Open cases |
Security Incident 
Response Platform
| Threat Sharing | Enrich events | Observable Analysis  |
|---|---|---||---|---|---|
| Threat Sharing |Enrich events |and Response Engine |
| Platform |Enrich events |and Response Engine |
Leverage other analyzers*
Expansion Modules Analyzers Responders
* Not supported currently by Cortex 2
EVENTS
ONTO ANALYSIS
ONTO ANALYSIS
ONTO ANALYSIS
ONTO ANALYSIS
MISP && THEHIVE
	MIND THE 
INTERVAL (1H BY 
	DEFAULT) 	AS LONG 
AS YOU DON’T MERGE 	CASESAS YOU DON’T MERGE 	CASES
▸ The MISP event used to create the case will feed new 	observables when new attributes are added to it 
▸ When you add observables to your case during your 
	investigation, only those flagged as IOCs can be shared back to 
the MISP event you used to create your case 
▸ If its sync user cannot nt (different org for ex.), 	TheHive will create an▸ You can also create a nmany instances as you’d 	like
EXTENDED EVENTS
EXTENDED EVENTS
EXTENDED EVENTS
BUT THERE’S MORE TO IT
▸ TheHive can monitor the connection ‘health’ of all the 
MISP and Cortex instances it is connected with 
▸ You can tailor MISP settings in TheHive in several ways
MAX ATTRIBUTES 	PER EVENT 	AGE OF THE LAST PUBLICATION DATE ORG BLACKLISTTAG BLACKLIST MAX JSON SIZE IMPORT/EXPORT/ (OR BOTH)
THE FUTURE
▸ CERANA 2 (TheHive 3.2) ~ Q4 2018 	▸ Share sightings with MISP 
	▸ Organization & tag whitelisting
▸ CARNICA 2 (TheHive 4.1) ~ Q2 2019 	▸ Add support for MISP objects
▸ CARNICA 3 (TheHive 4.3) ~ Q3 2019 	▸ Add taxonomy support using MISP 
WANT TO 
KNOW MORE?
THEN OUR JOINT 
WORK WED OCT 17