                                       seclogon, SENS, ShellHWDetection, Themes,
                                       Winmgmt, wuauserv
    audiodg.exe                    916 N/A
    svchost.exe                    992 EventSystem, fdPHost, netprofm, nsi,
                                       WdiServiceHost, WinHttpAutoProxySvc
    svchost.exe                   1104 CryptSvc, Dnscache, LanmanWorkstation,
                                       NlaSvc
    spoolsv.exe                   1244 Spooler
    svchost.exe                   1272 BFE, DPS, MpsSvc
    mDNSResponder.exe             1400 Bonjour Service
    taskhost.exe                  1504 N/A
    taskeng.exe                   1556 N/A
    vmtoolsd.exe                  1580 VMTools
    dwm.exe                       1660 N/A
    explorer.exe                  1668 N/A
    vmware-usbarbitrator.exe      1768 VMUSBArbService
    TPAutoConnSvc.exe             1712 TPAutoConnSvc
    [..Snip..]
    C:Windowssystem32> net start
    These Windows services are started:
       Application Experience
       Application Information
       Background Intelligent Transfer Service
       Base Filtering Engine
       Bluetooth Support Service
       Bonjour Service
       COM+ Event System
       COM+ System Application
       Cryptographic Services
       DCOM Server Process Launcher
       Desktop Window Manager Session Manager
       DHCP Client
       Diagnostic Policy Service
       Diagnostic Service Host
       Diagnostic System Host
       Distributed Link Tracking Client
       Distributed Transaction Coordinator
       DNS Client
       Function Discovery Provider Host
       Function Discovery Resource Publication
       Group Policy Client
    [..Snip..]
这有时是有用的，一些第三方驱动程序,即使是有信誉的公司,也可能有比瑞士奶酪上的孔还多的的漏洞。这仅仅是有可能的,因为对ring0攻击在大多数人专业技能之外。
    C:Windowssystem32> DRIVERQUERY
    Module Name  Display Name           Driver Type   Link Date
    ============ ====================== ============= ======================
    1394ohci     1394 OHCI Compliant Ho Kernel        11/20/2010 6:01:11 PM
    ACPI         Microsoft ACPI Driver  Kernel        11/20/2010 4:37:52 PM
    AcpiPmi      ACPI Power Meter Drive Kernel        11/20/2010 4:47:55 PM
    adp94xx      adp94xx                Kernel        12/6/2008 7:59:55 AM
    adpahci      adpahci                Kernel        5/2/2007 1:29:26 AM
    adpu320      adpu320                Kernel        2/28/2007 8:03:08 AM
    AFD          Ancillary Function Dri Kernel        11/20/2010 4:40:00 PM
    agp440       Intel AGP Bus Filter   Kernel        7/14/2009 7:25:36 AM
    aic78xx      aic78xx                Kernel        4/12/2006 8:20:11 AM
    aliide       aliide                 Kernel        7/14/2009 7:11:17 AM
    amdagp       AMD AGP Bus Filter Dri Kernel        7/14/2009 7:25:36 AM
    amdide       amdide                 Kernel        7/14/2009 7:11:19 AM
    AmdK8        AMD K8 Processor Drive Kernel        7/14/2009 7:11:03 AM
    AmdPPM       AMD Processor Driver   Kernel        7/14/2009 7:11:03 AM
    amdsata      amdsata                Kernel        3/19/2010 9:08:27 AM
    amdsbs       amdsbs                 Kernel        3/21/2009 2:35:26 AM
    amdxata      amdxata                Kernel        3/20/2010 12:19:01 AM
    AppID        AppID Driver           Kernel        11/20/2010 5:29:48 PM
    arc          arc                    Kernel        5/25/2007 5:31:06 AM
    [..Snip..]
**t4 – WMIC的神秘艺术**
我在这里单独的拿出WMIC(Windows Management Instrumentation Command-Line)来讲解，是因为它是Windows平台下最有用的命令行工具。
WMIC在信息搜集和后渗透测试阶段非常实用。话虽这么说，其实它是有一点笨重的，因为它有时候会输出比我们需要的信息更多的信息。
要完全讲完WMIC的使用，要耗费很长的时间。还有不得不提的是，一些输出可能会因为它的格式，很难在命令行下完美的展示出来。
在这里安利两个WMIC的教程：
[[Command-Line Ninjitsu
(SynJunkie)]](http://synjunkie.blogspot.com/2008/03/command-line-ninjitsu.html)
[[Windows WMIC Command Line
(ComputerHope)]](http://www.computerhope.com/wmic.htm)
不幸的是，一些windows默认的配置是不允许使用WMIC命令的，除非你是管理员组成员。经过我的测试，在XP下低权限用户是不能使用WMIC命令，但是在Windows
7 和Windows 8下，低权限用户可以使用WMIC，且不用更改任何设置。这正是我们使用WMIC搜集目标机器信息的前提。
下面是WMIC的命令行帮助：
    C:Windowssystem32> wmic /?
    [global switches] 
    The following global switches are available:
    /NAMESPACE           Path for the namespace the alias operate against.
    /ROLE                Path for the role containing the alias definitions.
    /NODE                Servers the alias will operate against.
    /IMPLEVEL            Client impersonation level.
    /AUTHLEVEL           Client authentication level.
    /LOCALE              Language id the client should use.
    /PRIVILEGES          Enable or disable all privileges.
    /TRACE               Outputs debugging information to stderr.
    /RECORD              Logs all input commands and output.
    /INTERACTIVE         Sets or resets the interactive mode.
    /FAILFAST            Sets or resets the FailFast mode.
    /USER                User to be used during the session.
    /PASSWORD            Password to be used for session login.
    /OUTPUT              Specifies the mode for output redirection.
    /APPEND              Specifies the mode for output redirection.
    /AGGREGATE           Sets or resets aggregate mode.
    /AUTHORITY           Specifies the  for the connection.
    /?[:]    Usage information.
    For more information on a specific global switch, type: switch-name /?
    The following alias/es are available in the current role:
    ALIAS                    - Access to the aliases available on the local system
    BASEBOARD                - Base board (also known as a motherboard or system board) management.
    BIOS                     - Basic input/output services (BIOS) management.
    BOOTCONFIG               - Boot configuration management.
    CDROM                    - CD-ROM management.
    COMPUTERSYSTEM           - Computer system management.
    CPU                      - CPU management.
    CSPRODUCT                - Computer system product information from SMBIOS.
    DATAFILE                 - DataFile Management.
    DCOMAPP                  - DCOM Application management.
    DESKTOP                  - User's Desktop management.
    DESKTOPMONITOR           - Desktop Monitor management.
    DEVICEMEMORYADDRESS      - Device memory addresses management.
    DISKDRIVE                - Physical disk drive management.
    DISKQUOTA                - Disk space usage for NTFS volumes.
    DMACHANNEL               - Direct memory access (DMA) channel management.
    ENVIRONMENT              - System environment settings management.
    FSDIR                    - Filesystem directory entry management.
    GROUP                    - Group account management.
    IDECONTROLLER            - IDE Controller management.
    IRQ                      - Interrupt request line (IRQ) management.
    JOB                      - Provides  access to the jobs scheduled using the schedule service.
    LOADORDER                - Management of system services that define execution dependencies.
    LOGICALDISK              - Local storage device management.
    LOGON                    - LOGON Sessions.
    MEMCACHE                 - Cache memory management.
    MEMORYCHIP               - Memory chip information.
    MEMPHYSICAL              - Computer system's physical memory management.
    NETCLIENT                - Network Client management.
    NETLOGIN                 - Network login information (of a particular user) management.
    NETPROTOCOL              - Protocols (and their network characteristics) management.
    NETUSE                   - Active network connection management.
    NIC                      - Network Interface Controller (NIC) management.
    NICCONFIG                - Network adapter management.
    NTDOMAIN                 - NT Domain management.
    NTEVENT                  - Entries in the NT Event Log.
    NTEVENTLOG               - NT eventlog file management.
    ONBOARDDEVICE            - Management of common adapter devices built into the motherboard (system board).
    OS                       - Installed Operating System/s management.
    PAGEFILE                 - Virtual memory file swapping management.
    PAGEFILESET              - Page file settings management.
    PARTITION                - Management of partitioned areas of a physical disk.
    PORT                     - I/O port management.