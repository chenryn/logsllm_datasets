■ API安全编码案例。
■ API安全测试与工具使用。
这些内容中，API安全管理框架和关键指标主要是面向管理人员，
比如项目经理，告知管理人员在管理活动中需要关注的重点是什么。常
见API安全问题属于普适性的，可以面向所有人员，常见API安全技术
与安全设计适合技术负责人或架构师，API安全编码案例适合开发工程
师，API安全测试与工具使用适合测试人员。如果想做得再上一个层
次，可以再增加一些类似于阶段性产物和关键指标的培训内容，面向质
量工程师，告知质量工程师在做过程审计时，需要审计哪些输出产物，
关注哪些重点指标，比如是否有API安全测试报告，API安全测试报告
中提出的漏洞是否已修复、上线发布后发生API安全事件数量等。
（2）安全培训课程设计与开展形式
安全培训课程的设计对于纯技术人员来说，通常有一定的难度。如
果是安全工程师负责此项工作，建议在设计之前跟运营人员、专职培训
老师做深入的交流。同时，要把过去一年至半年的历史漏洞数据、安
全事件分析数据统计出来，在课程设计时突出重点。
和运营人员、专职培训老师交流时涉及的关键问题如下。
■ 介绍课堂的对象和内容，向这两类人员寻求什么样的开展形式更
好，比如哪些内容适合做培训班形式的课程培训？哪些内容适合做简要
培训加知识竞答？
■ 如果是培训班形式的课程培训，课程结构如何设计更为吸引人，
课件编写时的注意事项有哪些？
■ 
如何在培训过程中让听众更多地参与到课程中？从运营的角度
看，哪些课后评价指标更为合理？过程数据是如何收集的？
和培训对象交流时涉及的关键问题如下。
■ 当前他们最关心的内容是什么？希望获得什么样的帮助？
■ 对于不同的授课形式，他们从实际需求或时间安排上，更趋向于
哪种？
■ 每次授课时长、课后作业或实践情况希望是什么样子的？
■ 过去一段时间内，反复发生的API安全问题有哪些？解决起来最
耗时的安全问题有哪些？
把这些关键问题理清楚，在正式实施培训过程中会少很多麻烦，同
时培训后获得的效果也比较好。
10.2.2 API安全培训相关工具
在实施API安全培训时，需要借助一些工具来辅助培训工作的开
展。除了像在线学习系统、微信答题抽奖系统、考试系统等非技术类
工具外，还有一些开源的或商用的工具供API安全培训时使用。主要如
下。
■ API安全小贴士文档：在4.2.1节中有对此工具的详细介绍，可以
作为API安全培训的普适性教材或材料资料。
■ OWASP API安全Top 10官方文档：作为OWASP对API安全风险
的重点推荐项，对API常见安全问题有详细的原理分析和案例讲解，培
训时可以与业务中发生的API安全问题相结合，做有重点的介绍。
■ 
API技术官方文档：涉及使用的具体API技术，需要了解该技术
的基本使用方法和原理，比如Open 
API规范、OAuth协议核心规范、
JWT规范等。尤其是这些规范的官方文档中提供的相关链接或参考指
引，也是安全培训内容参考资料的来源。
■ Spring-Security官方文档：对于使用Java作为开发技术栈的企业
来说，赋能研发人员熟悉Spring-Security官方文档中的内容，往往对安
全工作的整体推进起到事半功倍的效果，当然，这也包含API安全。
10.3 SDL之API安全需求
安全需求是后续工作开展的基线，通过需求分析将后续需要做的工
作落实到软件架构设计标准中，指导后续开发和实施，在输出产物中具
体表现为功能性安全需求和非功能性安全需求。
10.3.1 如何开展API安全需求
一般来说，安全需求主要考虑以下几方面的内容。
■ 过程保证类需求：是组织级的安全要求，定义SDL的各个关键活
动在什么阶段开展，输出什么样的产物，是在组织层面已明确的操作流
程、工具、关键里程碑、交付成果、验收标准等，需要在管理实践中落
地的内容。
■ 监管合规类需求：是监管部门的安全要求，具有强制性。一般来
源于国家法律法规、行业规范、上级管理部门要求等，典型的例子如个
人隐私保护类合规要求。
■ 
技术保障类需求：从安全攻防的角度，对API研发梳理安全需
求。比如系统需要提供API调用客户端应用程序注册功能、API调用监
控功能、API流量限制功能等，此类需求可以使用业界公开的威胁库或
检查表来作为需求分析的参考依据。
开展API安全需求活动的目的是为了在开发早期对需要开发的API
服务或接口进行安全评估，识别不同类型的安全需求，通过安全设计或
其他消减措施来控制安全风险，提高系统的安全性。
API安全需求实践在实际工作中很少单独开展，甚至安全需求实践
在不少企业中也是和安全设计融合在一起开展实践。考虑到不同的企业
内部安全资源情况，如果安全需求分析工作由安全工程师去做，则只需
要在其中加入API安全需求分析即可；如果是由架构师或技术负责人去
做，则安全工程师需要通过安全培训，指导架构师或技术负责人如何去
做API安全需求分析。简单而常见的做法是，由安全人员牵头，组织编
写安全需求检查表checklist，评审通过后由业务侧技术人员去开展安全
需求工作，安全人员再负责把关审核。
一个简单的API安全需求checklist表单样例如表10-1所示。
表10-1 API安全需求样例表
这个表单的内容多少不重要，重要的是在编制表单时要根据业务的
特性把相关的需求梳理清楚，并由人专门定时审视和维护，更新表单，
以防止需求项的变更没有及时维护在表单中。如果能把表单的内容在信
息化系统中工具化，当技术人员需要做安全需求时，可以直接访问系统
选择业务场景，系统自动生成安全类需求列表，这是比较理想的解决思
路。在没有系统的前提下，使用表单作为检查工具，也是不错的选择。
当然，表130-1也只是一个样例，比较正式的表单中还包括需求编号、
适用范围、详细说明、威胁等级、处置措施等。
10.3.2 API安全需求相关工具
供API安全需求所使用的工具，目前已公开的资料比较少。大多如
上文所述，需要根据企业的业务特点，自己去整理相应的checklist。而
技术保障类要求相对来说比较通用，可以参考以OWASP应用安全验证
标准（OWASP Application Security Verification Standard）为需求制定的
参考文件；除了此文档外，常见攻击模式枚举和分类（CAPEC）、
OWASP API安全Top 10文档也可以作为安全需求的参考文件。
一般来说，当前阶段贴合企业业务需要的API安全需求工具需要企
业内部的专业技术人员自己去整理。在整理时，参考表130-1中的样
例，归纳出业务侧易于上手使用的参考文档。或可以参考某些互联网企
业的做法，根据业务场景将安全需求梳理清楚，固化在信息化系统中。
此信息化系统通常由威胁知识库、业务场景、需求目录树共同构成，安
全人员负责维护威胁知识库、需求目录树与业务场景之间的映射关系。
当研发人员进行安全需求时，通过在信息化系统中的勾选操作，直接导
出安全需求清单，再整合到需求文档中即可。通过需求设计、功能规格
设计、原型设计等，指导后续安全工作的开展。
目前，市场化上以信息化系统作为安全需求工具的产品比较少，大
多处于起步阶段。在产品使用过程中，需要企业内部的安全人员与业务
人员一起，梳理出业务场景与安全需求之间映射关系的集合，这需要不
小的工作量。而且，参与过程梳理的人的业务知识和安全知识的储备要
足，否则难以理清两者的关系。正是这些原因，导致将信息化系统作为
安全需求工具还没有被广泛使用。以信息化系统作为安全需求工具是安
全需求管理的未来发展方向，通过信息化系统，管理需求目录、需求模
型，对安全需求进行需求控制和需求维护，能从管理和技术两个方面，
提高需求工作的效率。对于勇于尝试和探索的团队，仍是一项不错的选
择。
10.4 SDL之API安全设计
安全设计是安全需求分析后确定所采取的风险处理措施在架构中的
体现，相比通用应用软件在安全设计上的关键要求，API安全设计要简
单得多，这与API在整个应用软件架构中承担的功能是相匹配的。
10.4.1 如何开展API安全设计
本书的第6～9章花了大量的篇幅介绍了API安全关键技术，技术层
面的安全设计主要考虑以下几个方面的内容。
■ 
API身份认证：通过身份鉴别机制保障API使用者身份的可信，
为后续API操作提供安全基础。
■ 
API授权与访问控制：通过授权和访问控制访问API的非法访问
和API滥用以及敏感数据的过渡获取等。
■ API通信安全与消息保护：采用数据加密、数据签名、安全信道
等手段保护API传送消息的安全性。
除此之外，还应考虑API调用的限流和熔断、攻击防护，结合安全
管理中心等已有安全技术，将审计和监控等安全设计融入其所属应用程
序的安全生命周期中。
在开展API安全设计过程中，最好是根据固有的软件研发管理流
程，将API安全架构和API安全详细设计融入软件架构设计和详细设计
中。在架构设计环节，遵循5A原则和纵深防御原则，结合威胁建模分
析或威胁库（比如OWASP自动化威胁手册）的结果，完成架构设计；
在详细设计阶段，结合业务流程，参考API安全检查表，完成API的详
细设计。这种不将安全设计过程单独出来进行单独设计的好处是避免安
全与技术分离，导致设计人员做出的设计不切合实际情况。同时，在当
前环境下，大多数企业内部的产品研发还没有到需要单独进行API安全
设计的规模。
在开展API安全设计活动时，以下几点需要读者关注，可以为API
安全设计提供捷径。
■ 在架构设计中引入已有安全组件来满足安全要求，优于在架构中
设计自己的安全机制。在一个企业中，已有的安全组件可能来源于企业
内部团队研发、外部采购、开源项目等。
■ API安全检查表的使用优于单纯性的安全教育课程，特别是根据
业务演进过程中历史数据靠前的安全问题匹配检查项。
■ 
系统性的威胁建模要逐层分解，成本很高，大多数企业都不适
用，不要被书本的理论所干扰。在API安全层面，通过迭代更新的检查
表一般是够用的。
■ 对于编程语言和所依赖组件的选择，在设计阶段就应从安全的角
度去考虑。比如在第6章中提及的API网关与南北向安全中，当设计人员
选择API网关时，除了考虑API的功能、性能是否满足业务需要外，API
网关产品自身的安全性也是一个需要考察的内容。
10.4.2 API安全设计相关工具
在API安全设计方面，业界可供参考的资料比较多，可分为以下几
类。
■ 各大云厂商API使用说明文档：主要为公有云上实际使用场景，
可以从云厂商的官网上找到相关链接，如表10-2所示。
表10-2 云厂商API安全设计参考样例
■ 大型互联网应用API使用说明文档：主要为大型互联网应用对外
部或第三方合作伙伴提供的API开放平台，可以从API开放平台上获取