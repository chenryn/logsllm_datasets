program revenue across the three afﬁliate programs; for
GlavMed and RX-Promotion in particular, the remaining
90% of afﬁliates bring in just 10–15% of total revenue.
In the end, the most important afﬁliates for a program
are just a small fraction of all afﬁliates. From a business
perspective, programs can focus their attention and en-
10
1001152025303540455055606570758085lMale EnhancementlReproductive HealthlHeartlAcnelMale Pattern BaldnesslObesitylMental HealthlInfectionlPainlReproductive HealthlHeartlAcnelObesitylMental HealthlInfectionlPainAge% Items% Items10012152025303540455055606570758085lHormoneslAcnelMale Pattern BaldnesslHeartlObesitylInfectionlMental HealthlMale EnhancementlPainlHormoneslAcnelHeartlObesitylInfectionlMental HealthlPainAge% Items% ItemsGlavMedRX PromotionSpamItFigure 7: Cumulative contribution of new afﬁliates over time to
the three-year total program revenue. Each week adds the con-
tribution to total program revenue made by the new afﬁliates
that appear that week.
ergy on the top performing afﬁliates. Alternatively, from
an intervention perspective, undermining the activities of
just a handful of afﬁliates would have a considerable af-
fect on a program’s bottom line: undermining the top 3–
10 afﬁliates would impact 25–40% of program revenue.
Moreover, there is evidence that these high-revenue
afﬁliates are not simply lucky, but represent the best-
established and experienced advertisers. Figure 7 shows
that it is the oldest afﬁliates who contribute most to
weekly program revenue on an ongoing basis. For both
programs, the curves show the cumulative contribution
to total program revenue over time for new afﬁliates.
For the new afﬁliates that appear each week, we incre-
ment a running sum with the total revenue those afﬁli-
ates generate for the program—revenue generated from
the moment they join until the end of the measurement
period. For instance, the afﬁliates that generate revenue
in the ﬁrst week account for nearly 10% of all revenue
for the entire three years of business. The dashed lines
show the contributions to total revenue by afﬁliates that
have joined on year intervals, emphasizing that the older
afﬁliates are important for generating revenue over time.
The afﬁliates that have appeared by the start of 2008 to-
gether have contributed to 53% and 69% of the total pro-
gram revenue at the end of April 2010 for GlavMed and
SpamIt, respectively. The young afﬁliates that join after
2009, though, contribute less than 10% of total revenue.
5.2.2 Afﬁliate Commissions
Since only a small fraction of afﬁliates account for much
of the business, many afﬁliates earn small commissions.
Indeed, the median annualized afﬁliate commissions for
GlavMed, SpamIt, and RX-Promotion are just $292,
$3,320, and $428, respectively. This skew dovetails with
suggestions that spam-based advertising may be a labor
“lemon market” [5]. On the other hand, the most success-
ful afﬁliates are able to derive substantial income through
Figure 8: Distribution of afﬁliate commissions in each program.
their advertising. Indeed, the top ﬁve afﬁliates were able
to earn over $1M for themselves in a twelve-month pe-
riod (and a dozen exceeded $500K).14 Virtually all of
these earnings result from sales commissions with only
a minor share deriving from referral commissions (i.e.,
referral commissions are not a major source of income).
Figure 8 reveals a more nuanced picture of afﬁliate
commissions. For each program, the graph shows a PDF
of annualized commissions across all afﬁliates: the x-axis
is the annualized commission earned by an afﬁliate, and
the y-axis is the fraction of all afﬁliates that earned a
given commission. We calculate the commission for an
afﬁliate using the total customer sales linked to the af-
ﬁliate multiplied by the commission rate of the afﬁliate,
plus any referral commissions. Sales commission rates
range from 15–45%, with 30–40% being the most com-
mon (generally high-revenue afﬁliates receive the high-
est commission rates).15 The “dots” on the PDFs denote
the median annualized commissions for that program.
For the open programs GlavMed and RX-Promotion,
the majority of afﬁliates earn very low annualized com-
missions. The peaks of the PDFs range between $20–
$200 a year for GlavMed, and $20–$2,000 a year for
RX-Promotion. The closed program SpamIt, however,
shows a bimodal distribution, with a mass of “poor” af-
ﬁliates earning small commissions (mode around $500)
and another mass of “rich” afﬁliates earning large com-
missions (mode around $30,000), but still with many af-
ﬁliates earning over $100,000 a year.
As another perspective, on an ongoing basis the ac-
tive afﬁliates in SpamIt, a closed program, each gen-
erate three times more revenue than active afﬁliates in
14Note that Figure 8 does not involve extrapolating, but is based on
taking the best four consecutive quarter’s earnings for each afﬁliate and
thus gains accuracy at the potential expense of right-censoring.
15Note that not all programs reward commissions uniformly over all
drugs. For example, RX-Promotion typically discounts commissions
by 10% on controlled drugs, so an afﬁliate receiving 40% on the sale
of Viagra may only receive 30% on the sale of Oxycodone.
11
2007200820092010010203040506070809053%91%99%69%93%100%Cumulative revenue (millions)GlavMedSpamItGlavMedSpamItRX Promotionparties. For example, the second most proﬁtable afﬁli-
ate, scorrp2, earned close to $3M while advertising do-
mains that we witnessed emerging from a range of bot-
nets including MegaD, Cutwail and Xarvester. Adding to
the confusion, in a number of cases botnet code is sold
between parties and, thus, what some researchers may
identify as a single botnet may in fact reﬂect multiple
distinct infrastructures. Finally, we also note spamming
is not the only proﬁtable advertising vector. Indeed, the
largest overall earner, webplanet, appears to have earned
$4.6M using Web-based advertising instead. Fully unrav-
eling the complexities of these relationships and why cer-
tain afﬁliates are more successful than others remains an
open question.
5.3 Costs
Afﬁliate programs operate a complex business. As such,
they have a range of costs and overheads to cover and
only a fraction of their revenue translates to proﬁt. Using
a combination of transactional and metadata, we next re-
construct both direct and indirect costs for the programs.
We also explore in more detail the cost structure of ful-
ﬁllment (drug markup and shipping).
5.3.1 Direct Costs and Gross Margin
Direct costs are costs attributable to individual sales.
While advertising is normally considered an indirect
cost, afﬁliate programs pay for advertising as a direct
cost of a sale, so we consider afﬁliate commissions to
be a direct cost in this context. In addition, direct costs
include the supplier costs for the products themselves,
shipping them to customers, the fees charged by banks
and credit card processors for processing customer credit
card transactions, and customer refunds.
However, of these quantities only commissions are
completely unambiguously encoded across all transac-
tional data sets; RX-Promotion also includes a measure
of the supplier cost and a ﬁeld indicating the type of ship-
ping (from which the shipping cost can be reverse engi-
neered). The situation with GlavMed and SpamIt is more
complex. Starting on August 8, 2008 both databases in-
clude ﬁne-grained information about shipping and sup-
ply cost for each order. For periods before this, we are
forced to extrapolate. Refunds can be calculated directly
in the SpamIt and GlavMed data sets; for RX-Promotion,
we infer refunds based on orders with a cancelled sta-
tus. Finally, processing charges can vary among pay-
ment processors, currencies, card brands and over time.
However, in examining a large number of recorded fees
(found in the chatlogs) over the full period these fees
range between 7–12% in practice, so as an approxima-
tion we use 10%.
Putting this data together, Table 3 itemizes the gross
revenue and direct cost breakdown for GlavMed and
Figure 9: Average revenue per active afﬁliate each week.
GlavMed and RX-Promotion, both open programs. Fig-
ure 9 shows the average weekly revenue generated by
active afﬁliates. For each week, we total the revenue
generated by the afﬁliates that were active in attracting
customers that week, and divide by the number of ac-
tive afﬁliates. This metric is surprisingly stable over time
and strongly correlates with the nature of the afﬁliate
program. In both GlavMed and RX-Promotion, the av-
erage weekly revenue per afﬁliate is around $2,000. In
SpamIt, though, the average weekly revenue per afﬁli-
ate ranges between $5,000–$7,000. Open programs fo-
cus on increasing the total number of afﬁliates, but the
vast majority have little impact on total revenue. Instead,
by focusing on quality afﬁliates, the closed nature of the
SpamIt program is much more effective at attracting pro-
ductive afﬁliates and avoiding unproductive ones.
Focusing only on these most productive afﬁliates, we
would intuitively expect them to also be the operators of
the largest spamming botnets. However, even a cursory
examination of the data shows that there is considerable
more complexity at work. For example, while the oper-
ators of the prodigious Rustock botnet (cosma2k, bird,
and adv1) indeed receive large commission payments
(over $1.9M), botnet operators do not appear to dominate
the top earners. Indeed, two of the largest botnet opera-
tors, docent (operator of MegaD) and severa (operator of
Storm and Waledac) only received modest payments of
$308K and $169K, respectively, for directly advertising
SpamIt sites.16
There are a number of potential reasons for these re-
sults. First, we are only privy to sales for these par-
ticular afﬁliate programs and thus, if a botnet devotes
much of its resources to another program, those earnings
are outside our analysis. Moreover, while some botnets
are largely monopolized by their owners, in many other
cases the botnets are rented to provide service for third
16We identify botnet operators through metadata, documented more
fully in the many articles in the “PharmaWars” series [10], and corrob-
orated based on which afﬁliates receive money for domains known to
be advertised via particular botnets.
12
200720082009201020110123456789101112131415Weekly revenue per affiliate (thousands of dollars)GlavMedSpamItRX−Promotion2007
GlavMed & SpamIt
2008
2009
2010
Gross revenue
Direct costs
Commissions
Suppliers (goods)a
Suppliers (shipping)b
Processingc
Refunds
$27.3M
$17.2M (63.1%)
$7.9M (28.9%)
$1.9M (7%)
$3.1M (11.4%)
$2.7M (10%)
$1.6M (5.9%)
$10.1M (36.9%)
$60.1M
$42.9M (71.4%)
$23.0M (38.3%)
$4.3M (7.2%)
$7.6M (12.6%)
$6.0M (10%)
$2.0M (3.3%)
$17.2M (28.6%)
Gross margin
a Average supplier costs used to estimate missing supplier costs for 35% of goods.
b Average shipping costs used to estimate missing shipping costs for 60% of orders.
c Processor costs range between 7% and 11% of sales revenue.
$67.7M
$45.6M (67.3%)
$24.9M (36.8%)
$4.2M (6.2%)
$7.8M (11.5%)
$6.8M (10%)
$1.9M (2.8%)
$22.1M (32.7%)
$18.0M
$12.1M (67.1%)
$6.6M (36.7%)
$1.1M (6.1%)
$2.1M (11.7%)
$1.8M (10%)
$0.5M (2.6%)
$5.9M (32.9%)
RX-Promotion
2010
$12.8M
$9.9M (77.1%)
$3.9M (30.2%)
$1.0M (7.6%)
$1.5M (11.5%)
$1.3M (10%)
$1.0M (7.8%)
$2.9M (22.9%)
Table 3: Gross revenue, direct costs and resulting gross margin for the GlavMed and SpamIt programs combined.
SpamIt (combined) and RX-Promotion on a yearly ba-
sis. Not surprisingly (given average afﬁliate commissions
of 30–40%) direct costs consume the majority of rev-
enue. Note that, due to holdback charges, the gross mar-
gin number likely overstates cash ﬂow by around 10%,
and may in fact overstate revenue as well (if holdback
charges are not released). Payment processors comport-
ing with “high risk” merchants such as these univer-
sally hold back a portion of net proceeds to handle fu-
ture chargebacks and ﬁnes. From examining the logs,
a 10% holdback of up to 180 days is common and, in
reviewing discussions about holdbacks, the operators of
GlavMed/SpamIt routinely operate under the assumption
that this money may never be made available.
5.3.2 Indirect Costs and Net Revenue
Indirect costs are costs that are not generally attributable
to individual sales. For online pharmacies, indirect costs
are incurred for marketing (i.e., advertising the afﬁliate
program on popular blogs and forums to attract new afﬁl-
iates), for IT (i.e., registering domains for afﬁliates to use
in URLs that link to storefront pages, as well as server
and hosting costs), for administrative costs (i.e., staff
salaries), customer service, bank ﬁnes and “lobbying”.
By also calculating indirect costs, we can then estimate a
program’s net proﬁt—its proverbial “bottom line.”
However, indirect costs are difﬁcult to extract from
transaction data since they are necessarily indirect. Thus,
for this analysis we focus in particular on RX-Promotion
for which we have highly detailed metadata comprising
the raw monthly balance sheets (in spreadsheet form)
for seven months of revenue. The full spreadsheet is too
large to reproduce here, but we have extracted the equiv-
alent direct costs that we calculated from transactional
data in Table 3, and aggregated indirect costs in key ar-
eas. We summarize the resulting balance sheet in Table 4,
reﬂecting seven months of revenue between March and
September in 2010.
The direct costs taken from the balance sheet data
are highly similar to the transactional equivalents, dif-
RX-Promotion
March – September 2010
Gross revenue
Direct costs
Commissions
Suppliersa
Processing
Other direct
Indirect costs
Administrative
Customer service
Fines
IT expenses
Domains
Servers, hosting
Selling expenses
Marketing
Lobbying
Other indirect
$7.8M
$5.5M (70.8%)
$3M (38.1%)
$1.4M (17.6%)
$1M (13.2%)
$148.3K (1.9%)
$1004K (12.8%)
$197K (2.5%)
$124K (1.6%)
$107K (1.4%)
$202K (2.6%)
$114K (1.5%)
$66K (0.8%)
$315K (4%)
$105K (1.3%)
$157K (2%)
$134K (1.7%)
$1.3M (16.3%)
Net revenue
a Costs of goods and shipping are combined.
Table 4: Balance sheet for RX-Promotion detailing
indirect costs.
fering primarily due to differences in the make-up of
commission tiers during this seven-month period and the
greater precision available for payment processing over-
heads. Overall indirect costs represent almost 13% of
gross, split among a range of different overheads. Note
that the $157K lobbying charge is concentrated in two
large payments which may be related to conﬂict between