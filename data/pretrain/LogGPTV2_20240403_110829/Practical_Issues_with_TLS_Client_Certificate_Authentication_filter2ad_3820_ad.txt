–*
–
9 hour
20 sec
9 hour
40 sec
9 hour
–
–
–
+
–
–
–
+
+
+
–
+
+
+
+
+
–
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
–
+
–
+
–
+
+
+
+
+
+
+
–
+
–
–
–
–
+
+
–
–
+
+
+
+
+
+
+
–
+
+
+
–
–
–
+
–
–
–
–
–
+
–
–
–
–
–
–
–
–
–
–
–
–
+
–
–
–
–
–
–
–
–
–
+
–
+
–
–
–
–
–
–
–
–
–
+
–
+
+
+
+
–
–
+
+
–
–
–
–
+
+
+
–*
?
?
OCSP
OCSP
OCSP
OCSP
?
?
–
?
–
?
OCSP 2007
+
?
–
–
–
–
–
–
–
–
–
–
–
?
?
–
–
–
–
–
–
–
–
–
–
–
–
–
?
?
–
–
–
+
–
+
–
?
?
–
–
–
–
–
–
–
–
–
–
+
–
?
–
–
–
–
?
–
–
OCSP 2007
OCSP
CRL
OCSP
OCSP
OCSP
OCSP
OCSP
CRL
CRL
CRL
CRL
OCSP
CRL
OCSP
CRL
–
CRL
CRL
OCSP
OCSP
OCSP
CRL
CRL
OCSP
CRL
CRL
CRL
OCSP
CRL
CRL
OCSP
CRL
–
?
?
–
–
?
–
–
–
–
–
–
?
–
?
–
–
CRL 2007
CRL 2007
OCSP
OCSP
Service provider
Banking:
citadele.ee
krediidipank.ee
seb.ee
tbb.ee
unicreditbank.ee
versobank.com
Education:
e-ope.ee
eek.ee
ekool.eu
emu.ee
tlu.ee
Government:
ariregister.rik.ee
digidoc.sk.ee
e-register.ee
e-toimik.ee
eesti.ee
emta.ee
epa.ee
ettevotjaportaal.rik.ee
kala.envir.ee
kassa.ﬁn.ee
kinnistuportaal.rik.ee
kinnistusraamat.rik.ee
paberivaba.ark.ee
pensionikeskus.ee
politsei.ee
pria.ee
riigihanked.riik.ee
sk.ee
stat.ee
tootukassa.ee
Health:
arst.ee
medicum.ee
Insurance:
ergo.ee
iizi.ee
mandatumlife.ee
Utility:
arhivaar.ee
arvekeskus.ee
e-seif.ee
eestiloto.ee
elisa.ee
energia.ee
eparkimine.ee
g4s.ee
gaas.ee
korteriyhistu.net
parkimine.ee
pilet.ee
stv.ee
tallinn.ee
tele2.ee
zone.ee
apollo.ee
auto24.ee
credit24.ee
era.ee
hinnavaatlus.ee
justask.ee
laen.ee
openid.ee
osta.ee
ox.ee
partnerkaart.ee
rahvakogu.ee
skaart.ee
Other:
The availability of a strong locked same-origin-policy would
also bring a practical security value to Extended Validation
(EV) server certiﬁcates, since an attacker who has fraudulently
obtained a low-assurance Domain Validation (DV) certiﬁcate
would not be able to hijack an EV authenticated connection
to the legitimate server [35].
Note that an opt-in for a strong locked same-origin-policy
will not help against attackers who are capable of imperson-
ating TLS servers, if the web site imports or exports content
from/to other origins [36].
IV. ESTONIAN MEASUREMENT STUDY
A. Background
Every Estonian citizen who has reached 15 years of age must
obtain a state-issued ID card in the form of a smart card that
contains two public-key certiﬁcates and corresponding RSA
key pairs. One can be used for TLS CCA and another for
qualiﬁed digital signatures. This has led to the high popularity
of TLS CCA in Estonia, where every major service provider
has implemented a TLS CCA option for authentication when
using their e-services. We analyzed 87 public Estonian web
sites (all that we were aware of) which provide a TLS CCA
option.
The goal of the measurement study was to ﬁnd out how TLS
CCA is deployed in practice and how the issues described in
this paper are handled in real world TLS CCA deployments.
All service providers were tested using a black-box method;
therefore, the results we obtained might have other explana-
tions than the ones provided here.
The tests were performed in the time period between March
5, 2013 and April 19, 2013. The service providers and testing
results related to mod_ssl deployments are provided in
Table I. While this paper’s focus is on Apache mod_ssl TLS
CCA implementation, we also performed common tests on
other CCA implementations as shown in Table II. Our guesses
about the server software used are provided in the column
“Server”.
B. Evaluation and Results
The testing methodology and results are discussed below.
1) Spare CAs: The certiﬁcates that are included in an
Estonian ID card are issued by SK intermediate CA ESTEID-
SK 2007. Since the SK root CA certiﬁcate will expire soon, the
certiﬁcates issued after July 2011 are issued by intermediate
CA ESTEID-SK 2011 that itself is issued by the new root CA
of SK. Therefore, the server-side trust store should have four
certiﬁcates conﬁgured – two SK root CA certiﬁcates and two
corresponding intermediate CA certiﬁcates.
We have analyzed a list of CA DNs provided in the server’s
CertificateRequest message to detect spare (possibly
superﬂuous) and missing certiﬁcates in the server’s trust store.
The list of spare certiﬁcates has been pruned by removing
certiﬁcates that have been issued by these two SK root CAs,
since the presence of intermediate certiﬁcates in the trust store
does not affect trust settings, as described in Section III-B.
The positive number in the column “Spare” most likely
indicates a server misconﬁguration and may allow an attacker
to impersonate a user if the attacker is able to obtain the client
certiﬁcate that contains the user’s personal data and is signed
by any of the spare CAs or their subordinate CAs.