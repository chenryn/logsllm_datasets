âƒ—ğ‘ğ‘š :=
â¨‚ï¸
Similarly, for ğ‘š|ğ‘šâ€² having factorizations ğ‘š =âˆï¸€
â¨‚ï¸
â„“
âƒ—ğ‘ğ‘šâ„“.
â„“, where each ğ‘šâ„“, ğ‘šâ€²
â„“
is a power of a distinct prime ğ‘â„“ (so some ğ‘šâ„“ may be 1), the relative powerful basis of
ğ’ªğ‘šâ€²/ğ’ªğ‘š is
â„“ ğ‘šâ€²
â„“ ğ‘šâ„“, ğ‘šâ€² =âˆï¸€
(2.2.2)
âƒ—ğ‘ğ‘šâ€²,ğ‘š :=
âƒ—ğ‘ğ‘šâ€²
â„“,ğ‘šâ„“.
(2.2.3)
Notice that for ğ‘š|ğ‘šâ€²|ğ‘šâ€²â€², we have that âƒ—ğ‘ğ‘šâ€²â€²,ğ‘š and âƒ—ğ‘ğ‘šâ€²â€²,ğ‘šâ€² âŠ— âƒ—ğ‘ğ‘šâ€²,ğ‘š are equivalent up to order,
because they are tensor products of the same components, but possibly in different orders.
â„“
2.2.4 Canonical Embedding
There are ğ‘› distinct ring embeddings (i.e., injective ring homomorphisms) ğœğ‘– : ğ¾ â†’ C,
âˆšâˆ’1/ğ‘š) âˆˆ C
indexed by ğ‘– âˆˆ Z*
is the principal ğ‘šth complex root of unity. These embeddings come in conjugate pairs
ğ‘š, which are deï¬ned by ğœğ‘–(ğœğ‘š) = ğœ”ğ‘–
ğ‘š where ğœ”ğ‘š = exp(2ğœ‹
(ğœğ‘–, ğœğ‘šâˆ’ğ‘–), because ğœ”ğ‘–
is the concatenation of all the embeddings (under a suitable reindexing of Z*
ğ‘š is the complex conjugate of ğœ”ğ‘šâˆ’ğ‘–
ğ‘š . The canonical embedding
ğ‘š as {1, . . . , ğ‘›}),
ğ‘š = ğœ”âˆ’ğ‘–
â„“ ğ’ªğ‘šâ„“ is the ring tensor product over Z of all the ğ‘šâ„“th cyclotomic rings.
1Equivalently, ğ’ªğ‘š =â¨‚ï¸€
20
i.e., the injective function
ğœ : ğ¾ â†’ ğ»
ğœ(ğ‘) = (ğœğ‘–(ğ‘))ğ‘–âˆˆZ*
ğ‘š
where ğ» âŠ‚ Cğ‘› is the subspace deï¬ned above in subsection 2.1.2.
We endow ğ¾ and ğ‘… with a geometry using the canonical embedding ğœ, i.e., all geometric
quantities on ğ¾ and ğ‘… are deï¬ned in terms of the canonical embedding. For example, we
deï¬ne the â„“2 norm on ğ¾ as â€–ğ‘¥â€–2 = â€–ğœ(ğ‘¥)â€–2 =âˆšï¸€âŸ¨ğœ(ğ‘¥), ğœ(ğ‘¥)âŸ©, and use this to deï¬ne the
continuous Gaussian distribution ğ·ğ‘Ÿ over ğ¾.2 A key property is that both addition and
multiplication in the ring are coordinate-wise in the canonical embedding:
ğœ(ğ‘ + ğ‘) = ğœ(ğ‘) + ğœ(ğ‘)
ğœ(ğ‘ Â· ğ‘) = ğœ(ğ‘) âŠ™ ğœ(ğ‘).
This property aids analysis and allows for sharp bounds on the growth of errors in crypto-
graphic applications.
For two-power cyclotomics, this geometry is particulary simple: ğœ is just a scaling
âˆš
by a
ğ‘› factor, followed by a rigid rotation (an isometry). Therefore, a sample from
the Gaussian distribution ğ·ğ‘Ÿ over ğ» (and over ğ¾, via ğœâˆ’1) has independent power-basis
âˆš
coefï¬cients, drawn from ğ·ğ‘Ÿ/
ğ‘›.
2.2.5
(Tweaked) Decoding Basis
Ideal lattices. Recall that an ideal â„ âŠ† ğ‘… is a nontrivial additive subgroup that is also
closed under multiplication by ğ‘…. The norm is deï¬ned as N(â„) := |ğ‘…/â„|, the index
2To be formal, the continuous Gaussian is deï¬ned over ğ¾R := ğ¾ âŠ—Q R, which is analogous to ğ¾ as the
reals R are to the rationals Q, and which is in bijective correspondence with ğ» via the natural extension of ğœ.
Because precision is always ï¬nite in any computational context, in this work we ignore the formal distinction
between ğ¾ and ğ¾R.
21
of â„ in ğ‘…. A fractional ideal ğ’¥ âŠ‚ ğ¾ is a set that can be expressed as ğ’¥ = ğ‘‘âˆ’1 Â· â„ for
some ideal â„ âŠ† ğ‘… and ğ‘‘ âˆˆ ğ‘…. (We sometimes omit the word â€œfractionalâ€ when it is
clear from context.) Its norm is deï¬ned as N(ğ’¥ ) := N(â„)/ N(ğ‘‘). The fractional ideals
form a group under multiplication (with ğ‘… as the identity), where ideal multiplication is
ğ‘– ğ‘¥ğ‘–ğ‘¦ğ‘– : ğ‘¥ğ‘– âˆˆ â„, ğ‘¦ğ‘– âˆˆ ğ’¥ }. The norm map is then multiplicative:
deï¬ned by â„ğ’¥ = {âˆ‘ï¸€
N(â„ğ’¥ ) = N(â„) N(ğ’¥ ).
Any (fractional) ideal â„ yields a lattice ğœ(â„) âŠ‚ ğ» under the canonical embedding.
As usual, we often leave ğœ implicit and refer to â„ itself as a lattice. The following lower
bound on the minimum distance of an ideal lattice is an immediate consequence of the
arithmetic-mean/geometric-mean inequality.
Lemma 2.2.1. For any fractional ideal â„ âŠ‚ ğ¾, we have ğœ†1(â„) â‰¥ âˆš
ğ‘› Â· N(â„)1/ğ‘›.
The dual ideal, and a â€œtweak.â€ Any fractional ideal â„ âŠ‚ ğ¾ has a dual (fractional)
ideal â„âˆ¨, which under the canonical embedding corresponds to (the complex conjugate of)
the dual lattice of â„, i.e., ğœ(â„) and ğœ(â„âˆ¨) are duals. In particular, the dual ideal ğ‘…âˆ¨ of ğ‘…,
also called the codifferent ideal, is deï¬ned as the dual of ğ‘… under the trace, i.e.,
ğ‘…âˆ¨ := {fractional ğ‘ : Trğ‘…/Z(ğ‘ Â· ğ‘…) âŠ† Z}.
The dual ideal ğ¼âˆ¨ is related to the inverse ideal via the codifferent: â„âˆ¨ = â„âˆ’1ğ‘…âˆ¨. (See,
e.g., [Con09] for further details and proofs.) By the composition property of the trace,
(ğ‘…â€²)âˆ¨ is the set of all fractional ğ‘ such that Trğ‘…â€²/ğ‘…(ğ‘ Â· ğ‘…â€²) âŠ† ğ‘…âˆ¨. In particular, we have
Trğ‘…â€²/ğ‘…((ğ‘…â€²)âˆ¨) = ğ‘…âˆ¨.
Concretely, the dual ideal is the principal fractional ideal ğ‘…âˆ¨ = (ğ‘”ğ‘š/ Ë†ğ‘š)ğ‘…, where
Ë†ğ‘š = ğ‘š/2 if ğ‘š is even and Ë†ğ‘š = ğ‘š otherwise, and the special element ğ‘”ğ‘š âˆˆ ğ‘… is as follows:
â€¢ for ğ‘š = ğ‘ğ‘’ for prime ğ‘ and ğ‘’ â‰¥ 1, we have ğ‘”ğ‘š = ğ‘”ğ‘ := 1 âˆ’ ğœğ‘ if ğ‘ is odd, and
ğ‘”ğ‘š = ğ‘”ğ‘ := 1 if ğ‘ = 2;
22
â€¢ for ğ‘š =âˆï¸€
â„“ ğ‘šâ„“ where the ğ‘šâ„“ are powers of distinct primes, we have ğ‘”ğ‘š =âˆï¸€
â„“ ğ‘”ğ‘šâ„“.
The dual ideal ğ‘…âˆ¨ plays a very important role in the deï¬nition, hardness proofs, and
cryptographic applications of Ring-LWE (see [LPR13b; LPR13a] for details). However,
for implementations it seems preferable to work entirely in ğ‘…, so that we do not to have to
contend with fractional values or the dual ideal explicitly. Following [AP13], we achieve
this by multiplying all values related to ğ‘…âˆ¨ by the â€œtweakâ€ factor ğ‘¡ğ‘š = Ë†ğ‘š/ğ‘”ğ‘š âˆˆ ğ‘…; recall
that ğ‘¡ğ‘šğ‘…âˆ¨ = ğ‘…. To compensate for this implicit tweak factor, we replace the trace by what
we call the twace (for â€œtweaked traceâ€) function Twğ‘šâ€²,ğ‘š = Twğ‘…â€²/ğ‘… : ğ‘…â€² â†’ ğ‘…, deï¬ned as
Twğ‘…â€²/ğ‘…(ğ‘¥) := ğ‘¡ğ‘š Â· Trğ‘…â€²/ğ‘…(ğ‘¥/ğ‘¡ğ‘šâ€²) = ( Ë†ğ‘š/ Ë†ğ‘šâ€²) Â· Trğ‘…â€²/ğ‘…(ğ‘¥ Â· ğ‘”ğ‘šâ€²/ğ‘”ğ‘š).
(2.2.4)
A nice feature of the twace is that it ï¬xes the base ring pointwise, i.e., Twğ‘…â€²/ğ‘…(ğ‘¥) = ğ‘¥ for
every ğ‘¥ âˆˆ ğ‘…. It is also easy to verify that it satisï¬es the same composition property that the
trace does.
We stress that this â€œtweakedâ€ perspective is mathematically and computationally equiva-
lent to using ğ‘…âˆ¨, and all the results from [LPR13b; LPR13a] can translate to this setting
without any loss.
Decoding Basis. The work of [LPR13a] deï¬nes a certain Z-basis âƒ—ğ‘ğ‘š = (ğ‘ğ‘—) of ğ‘…âˆ¨, called
the decoding basis. It is deï¬ned as the dual of the conjugated powerful basis âƒ—ğ‘ğ‘š = (ğ‘ğ‘—)
under the trace:
Trğ‘…/Z(ğ‘ğ‘— Â· ğ‘âˆ’1
ğ‘—â€² ) = ğ›¿ğ‘—,ğ‘—â€²
for all ğ‘—, ğ‘—â€². The key geometric property of the decoding basis is, informally, that the Z-
coefï¬cients of any ğ‘’ âˆˆ ğ‘…âˆ¨ with respect to âƒ—ğ‘ğ‘š are optimally small in relation to ğœ(ğ‘¥), the
canonical embedding of ğ‘’. In other words, short elements like Gaussian errors have small
decoding-basis coefï¬cients.
23
With the above-described â€œtweakâ€ that replaces ğ‘…âˆ¨ by ğ‘…, we get the Z-basis
âƒ—ğ‘‘ğ‘š = (ğ‘‘ğ‘—) := ğ‘¡ğ‘š Â· âƒ—ğ‘ğ‘š ,
which we call the (tweaked) decoding basis of ğ‘…. By deï¬nition, this basis is dual to the
conjugated powerful basis âƒ—ğ‘ğ‘š under the twace:
Twğ‘…/Z(ğ‘‘ğ‘— Â· ğ‘âˆ’1
ğ‘—â€² ) = ğ›¿ğ‘—,ğ‘—â€².
Because ğ‘”ğ‘š Â· ğ‘¡ğ‘š = Ë†ğ‘š, it follows that the coefï¬cients of any ğ‘’ âˆˆ ğ‘… with respect to âƒ—ğ‘‘ğ‘š are
identical to those of ğ‘”ğ‘š Â· ğ‘’ âˆˆ ğ‘”ğ‘šğ‘… = Ë†ğ‘šğ‘…âˆ¨ with respect to the Z-basis ğ‘”ğ‘š Â· âƒ—ğ‘‘ğ‘š = Ë†ğ‘š Â· âƒ—ğ‘ğ‘š of
ğ‘”ğ‘šğ‘…. Hence, they are optimally small in relation to ğœ(ğ‘”ğ‘š Â· ğ‘’).3
Relative decoding basis. Generalizing the above, the relative decoding basis âƒ—ğ‘‘ğ‘šâ€²,ğ‘š of
ğ‘…â€²/ğ‘… is dual to the (conjugated) relative powerful basis âƒ—ğ‘ğ‘šâ€²,ğ‘š under Twğ‘…â€²/ğ‘…. As such, âƒ—ğ‘‘ğ‘šâ€²,ğ‘š
(and in particular, âƒ—ğ‘‘ğ‘šâ€² itself) has a Kronecker-product structure mirroring that of âƒ—ğ‘ğ‘šâ€²,ğ‘š from
Equations (2.2.1) and (2.2.3). Furthermore, by the results of [LPR13a, Section 6], for a
positive power ğ‘š of a prime ğ‘ we have
â§âªâªâ¨âªâªâ©âƒ—ğ‘ğ‘¡
âƒ—ğ‘‘ğ‘¡
ğ‘š,ğ‘š/ğ‘ =
ğ‘š,ğ‘š/ğ‘ Â· ğ¿ğ‘
âƒ—ğ‘ğ‘¡
ğ‘š,ğ‘š/ğ‘
if ğ‘š = ğ‘
otherwise,
(2.2.5)
where ğ¿ğ‘ is the lower-triangular matrix with 1s throughout its lower triangle.
3This is why Invariant 4.2.2 of our somewhat-homomorphic encryption scheme (section 4.3) requires
ğœ(ğ‘’ Â· ğ‘”ğ‘š) to be short, where ğ‘’ is the error in the ciphertext.
24
2.2.6 Chinese Remainder Bases
This section contains a relatively brief summary of the Chinese Remainder sets and bases
used throughout this thesis; see [LPR13b; LPR13a] for many more mathematical and
computational details.
Prime splitting. As usual, let ğ‘… denote the ğ‘šth cyclotomic ring and ğ‘› = ğœ™(ğ‘š). Let ğ‘ âˆˆ Z
be a prime integer, which for simplicity we assume does not divide ğ‘š. The factorization
of the ideal ğ‘ğ‘… into prime ideals is as follows. Let ğ‘‘ be the order of ğ‘ modulo ğ‘š, i.e.,
the smallest positive integer such that ğ‘ğ‘‘ = 1 (mod ğ‘š), and note that ğ‘‘ | ğ‘›. Let âŸ¨ğ‘âŸ© =
{1, ğ‘, ğ‘2, . . . , ğ‘ğ‘‘âˆ’1} âŠ† Z*
ğ‘š denote the multiplicative subgroup generated by ğ‘. Then ğ‘ğ‘…
factors as
âˆï¸
ğ‘ğ‘… =
pğ‘– ,
ğ‘–
where the pğ‘– are indexed by the quotient group ğº = Z*
of cosets ğ‘–âŸ¨ğ‘âŸ© of the subgroup âŸ¨ğ‘âŸ© of Z*
ğ‘…, and their number ğ‘›/ğ‘‘ is called the splitting number of ğ‘ in ğ‘….
ğ‘š/âŸ¨ğ‘âŸ©, i.e., the multiplicative group
ğ‘š. These are called the prime ideals lying over ğ‘ in
Concretely, the ideals lying over ğ‘ are as follows: let ğœ”ğ‘š be some arbitrary element of
order ğ‘š in the ï¬nite ï¬eld Fğ‘ğ‘‘. (Such an element exists because the multiplicative group F*
ğ‘ğ‘‘
is cyclic and has order ğ‘ğ‘‘âˆ’1 = 0 (mod ğ‘š).) For each ğ‘– âˆˆ Z*
ğ‘š, deï¬ne a ring homomorphism
â„ğ‘– : ğ‘… â†’ Fğ‘ğ‘‘ by â„ğ‘–(ğœğ‘š) = ğœ”ğ‘–
ğ‘š. Then the prime ideal pğ¼ corresponding to the coset ğ¼ of âŸ¨ğ‘âŸ©
is the kernel of the homomorphism â„ğ‘–, where ğ‘– âˆˆ ğ¼ denotes some arbitrary element of the
coset. It is easy to verify that this is an ideal, and that it is invariant under the choice of
representative, because â„ğ‘–Â·ğ‘(ğ‘Ÿ) = â„ğ‘–(ğ‘Ÿ)ğ‘ for any ğ‘Ÿ âˆˆ ğ‘… since Fğ‘ğ‘‘ has characteristic ğ‘ and
therefore (ğ‘ + ğ‘)ğ‘ = ğ‘ğ‘ + ğ‘ğ‘ for any ğ‘, ğ‘ âˆˆ Fğ‘ğ‘‘. Because pğ¼ is the kernel of â„ğ‘–, the induced
ring homomorphisms â„ğ‘– : ğ‘…/pğ¼ â†’ Fğ‘ğ‘‘ for all ğ‘– âˆˆ ğ¼ are in fact isomorphisms.
phism from ğ‘…ğ‘ := ğ‘…/ğ‘ğ‘… to the product ring âˆï¸€
The Chinese Remainder Theorem states (in particular) that the natural ring homomor-
ğ¼(ğ‘…/pğ¼) âˆ¼= (Fğ‘ğ‘‘)ğ‘›/ğ‘‘, where ğ¼ ranges
25
over all cosets of âŸ¨ğ‘âŸ© âŠ† Z*
ğ‘š, is a ring isomorphism.
In particular, the concatenation
ğ‘š : ğ‘…ğ‘ â†’ Fğ‘›
2ğ‘‘ is a ring embedding (an injective ring homomorphism). We refer
â„ = (â„ğ‘–)ğ‘–âˆˆZ*
to the set âƒ—ğ‘ = {ğ‘ğ¼} âŠ‚ ğ‘…ğ‘, where ğ‘ğ¼ = 1 (mod pğ¼) and ğ‘ğ¼ = 0 (mod pğ½ ) for all cosets ğ¼ Ì¸= ğ½
of âŸ¨ğ‘âŸ©, as the mod-ğ‘ CRT set of ğ‘…. In particular, for the CRT set âƒ—ğ‘ of ğ‘…ğ‘, for any ğ‘§ âˆˆ ğ‘…ğ‘ we
have
Similarly, for a prime power ğ‘â„“ the natural ring homomorphism from ğ‘…ğ‘â„“ toâˆï¸€
ğ‘ğ‘‘ /Fğ‘(â„(ğ‘§)).
Trğ‘…ğ‘/Zğ‘(ğ‘§ Â· âƒ—ğ‘) = TrF
(2.2.6)
ğ¼(ğ‘…/pâ„“
ğ¼) is a
ring isomorphism, and the mod-ğ‘â„“ CRT set is deï¬ned analogously.
Â¯ğ‘… = ğ’ª Â¯ğ‘š and ğ‘ Â¯ğ‘… =âˆï¸€
Finally, consider the general case where ğ‘ may divide ğ‘š. It turns out that this case easily
reduces to the one where ğ‘ does not divide ğ‘š, as follows. Let ğ‘š = ğ‘ğ‘˜ Â· Â¯ğ‘š for ğ‘ (cid:45) Â¯ğ‘š, and let
ğ‘– Â¯pğ‘– be the prime-ideal factorization of ğ‘ Â¯ğ‘… as described above. Then
the ideals Â¯pğ‘– âŠ‚ Â¯ğ‘… are totally ramiï¬ed in ğ‘…, i.e., we have Â¯pğ‘–ğ‘… = pğœ™(ğ‘š)/ğœ™( Â¯ğ‘š)
for some distinct
prime ideals pğ‘– âŠ‚ ğ‘…. This implies that the CRT set for ğ‘…ğ‘ is exactly the CRT set for Â¯ğ‘…ğ‘,
embedded into ğ‘…ğ‘. Therefore, in what follows we restrict our attention to the case where ğ‘
ğ‘–
does not divide ğ‘š.
CRT Set Extensions. As above, let ğ‘ be a prime integer not dividing ğ‘š, let ğ‘ have order
ğ‘šâ€², and let pğ¼â€² âŠ‚ ğ‘…â€² be the prime ideals lying over ğ‘ in ğ‘…â€², where ğ¼â€² ranges over
ğ‘‘â€²|ğ‘›â€² in Z*
the cosets of âŸ¨ğ‘âŸ© âŠ† Z*
ğ‘šâ€². Then each pğ¼ lies over exactly one pğ¼â€², i.e., it is a divisor of exactly
one ideal pğ¼â€²ğ‘…, namely, the one for which ğ¼â€² = ğ¼ mod ğ‘šâ€². Therefore, there are exactly
(ğ‘›/ğ‘‘)/(ğ‘›â€²/ğ‘‘â€²) prime ideals lying over each pğ¼â€²; this number is called the relative splitting
number of ğ‘ in the extension ğ‘…/ğ‘…â€².
CRT Basis When the order of ğ‘ modulo ğ‘š is 1, ğ‘ğ‘… factors into ğ‘› distinct prime ideals,
and the mod-ğ‘ CRT set becomes a Chinese remainder (or CRT) Zğ‘-basis âƒ—ğ‘ = âƒ—ğ‘ğ‘š âˆˆ ğ‘…ğœ™(ğ‘š)
whose entries are indexed by Z*
ğ‘š. This happens precisely when ğ‘ is a prime congruent to
,
ğ‘
26
1 (mod ğ‘š). The key property satisï¬ed by this basis is
ğ‘ğ‘– Â· ğ‘ğ‘–â€² = ğ›¿ğ‘–,ğ‘–â€² Â· ğ‘ğ‘–
(2.2.7)
for all ğ‘–, ğ‘–â€² âˆˆ Z*
coefï¬cient-wise (and hence linear time): for any coefï¬cient vectors a, b âˆˆ Zğœ™(ğ‘š)
ğ‘š. Therefore, multiplication of ring elements represented in the CRT basis is
, we have
ğ‘
(âƒ—ğ‘ğ‘¡ Â· a) Â· (âƒ—ğ‘ğ‘¡ Â· b) = âƒ—ğ‘ğ‘¡ Â· (a âŠ™ b).
Also by Equation (2.2.7), the matrix corresponding to multiplication by ğ‘ğ‘– (with respect to
the CRT basis) has one in the ğ‘–th diagonal entry and zeros everywhere else, so the trace
of every CRT basis element is unity: Trğ‘…/Z(âƒ—ğ‘) = 1 (mod ğ‘). For completeness, in what
follows we describe the explicit construction of the CRT basis.
the prime-power factorization ğ‘š =âˆï¸€ğ‘¡
ğ‘š â†’âˆï¸€
equivalently index the CRT basis byâˆï¸€
Arbitrary cyclotomics. For an arbitrary index ğ‘š, the CRT basis is deï¬ned in terms of