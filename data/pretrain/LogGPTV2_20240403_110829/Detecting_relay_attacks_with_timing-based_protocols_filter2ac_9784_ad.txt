multiple traces of the ‘REQA’ command/response sequence with three diﬀerent
models of card, all of type A (an advanced dual-interface microprocessor card,
a 4K Mifare card and a ‘Ultra Lite’ low cost Mifare card). Figure 3 shows a
complete sequence. REQA is the ﬁrst command issued by the reader to the card
6 Note that we have not implemented the proposed communication method or distance
bounding protocol in an actual smart card. Such an implementation would require
very low level changes to the card operating system mask and circuitry.
16
Fig. 3. REQA command/response sequence as measured in reader RX circuit.
when it comes into the reader’s ﬁeld. It was chosen because the standard requires
the card to begin modulating its response a ﬁxed number of carrier cycles after
the reader’s last command bit. This mirrors our proposal, where the card takes
a ﬁxed number of cycles to compute its response however, in the case of REQA,
the response always begins with the modulation of a start bit - equivalent to a
logical ‘one’ in our scheme.
Traces were recorded with cards at diﬀerent distances and orientations to the
reader. Orientation and distance eﬀect the voltage across the reader’s receive cir-
cuit. The larger the distance the greater the voltage and as the voltage increases,
the rate of change that the card can eﬀect on the carrier amplitude decreases.
Hence greater card to reader distances mean more cycles are needed to produce
a detectable change in carrier amplitude. This can be seen clearly in Figure 4
which presents the carrier for four diﬀerent voltages around the time marked B
in Figure 3. The ﬁrst carrier half cycle that the card attempts to modulate is
marked with a vertical line. For the two smallest voltage traces an amplitude
change is clearly evident. For the highest voltage trace, there is no discernible
amplitude change on this cycle - the ﬁrst signiﬁcant change can be seen one and
a half cycles later at time 0.8729 µs. We found that the rate of amplitude change
is a function of the voltage, irrespective of the orientation and distance that
produced it, so in our analysis we consider dependent variables such as delay in
detecting a modulation peak, against antenna voltage (rather than distance and
orientation which in practice are diﬃcult to specify with precision).
In ISO 14443 type A, the reader communicates with the card via 100% am-
plitude shift keying (short suspensions of the carrier) as can be seen in the left
part of Figure 3. We aligned the traces on the ﬁrst cycle that resumes the car-
rier in the last bit pause. This can be seen in Figure 5 which shows that the
alignment is precise and unambiguous. Figure 5 presents a short period of the
00.511.522.533.5x 10−4−1.5−1−0.500.511.5TimeVoltageAB17
Fig. 4. Card communicates to reader via load modulation. Higher antenna voltages
produce delays in eﬀecting a detectable amplitude increase.
region marked at point A in Figure 3 for ﬁve diﬀerent trace voltages. Using this
alignment as a reference point, we can conﬁdently identify the half cycle that the
card starts its load modulation on irrespective of whether an amplitude change
is actually evident. Since we can identify this starting half cycle, we can measure
the number of cycles required to produce a detectable amplitude change and
hence characterise the timing latency at that voltage.
5.2 Analysis and results
Using Matlab, (a numerical analysis and simulation tool) we developed a model
of an amplitude peak detection circuit. The detector compares each half cycle
peak amplitude to an average of eight previous peaks of the same sign. If the dif-
ference exceeds a threshold value, the current peak is signaled as a modulation.
The choice of threshold value is important as it determines the sensitivity to
detecting true modulation peaks and also the likelihood that channel noise will
be falsely interpreted as a peak. The tradeoﬀ between such true and false posi-
tives becomes more delicate as the antenna voltage increases because changes in
amplitude become progressively less pronounced, ﬁnally disappearing into the
noise ﬂoor. This eﬀect can be seen in Figure 6. Each data series represents the
percentage change in amplitude for a modulation peak number versus antenna
voltage. For example, the ﬁrst modulation peak shows a 30% amplitude increase
when the antenna voltage is 200 mV but at 1200 mV there is barely any dis-
cernible increase. If the reader examines the amplitudes of each trace on the
‘First Modulation Peak’ line in Figure 4 in relation to the preceding peaks, it
should be evident that the respective increases correspond to the Peak 1 series
in Figure 6.
8.698.78.718.728.738.748.758.768.77x 10−5−1.5−1−0.500.511.5TimeVoltage1st Modulation Peak18
Fig. 5. Trace Alignment on resumption of carrier in last reader to card bit pause.
We derived a voltage-dependent function to generate the ‘Threshold’ val-
ues in Figure 6 in the following manner. Based on 1000 traces taken with one
card type at a range of voltages, we experimentally identiﬁed a threshold for
each trace (by choosing successively smaller values) that correctly identiﬁed the
modulation peaks whilst keeping false positives below a maximum of 20. Low-
ering the threshold increases the probability of detecting the real modulation
cycles as early as possible but also increases the number of false detections of
non-modulated peaks that have slightly higher amplitudes due to environmen-
tal noise. The peak detector examines approximately 2300 peaks per trace (the
portion of the carrier signal between the points marked A and B in Figure 3)
so the somewhat arbitrary false positive count of <20 loosely approximates an
false detect error rate of < 1%, based on the following rationale: in our proposal,
the card signals zero by not modulating, which is what the card is doing in
the 1150 cycles between points A and B so a threshold that produces no more
than 20 false positives in this region provides an approximation of a false detect
error rate on any individual peak of < 1% when the card sends zero (by not
modulating).
The experimentally identiﬁed threshold/voltage data pairs were ﬁtted to a
third degree polynomial and this function was used to specify threshold values
for traces at a range of voltages for the other two card types. We found that
the voltage dependent threshold function derived from the data for one card
produced very similar true and false positive rates when used on traces for the
other cards. While we do not claim our results are conclusive in this respect due
to the small number of cards that we have examined, it appears possible that
a single voltage dependent threshold function will work across a range of cards.
This would certainly simplify the implementation of the peak detection circuitry
0.511.5x 10−6−2.5−2−1.5−1−0.500.511.522.5TimeVoltage19
Fig. 6. Percentage change in modulation peak amplitude vs. antenna voltage.
in reader devices as a simple lookup table could supply the detection threshold
for a given voltage.
Fig. 7. Timing resolution using proposed method.
Figure 7 shows the average and maximum timing resolution as a function of
antenna voltage. The ﬁrst modulation peak is reliably detectable up to 500mV, so
there is no detection delay, thus the timing resolution is 1/2fc or 37 ns. Between
500 and 800 mV there is a slight increase in the average because the ﬁrst peak
is detected in only 75% of cases. We argue that the resolution up to 800mV
05001000150020002500300001020304050Voltage (mV)Percenatge Amplitude ChangePeak 1Peak 2Peak 3Peak 4Peak 5Peak 6Peak 7Peak 8Threshold050010001500200025003000050100150200250300350400Voltage (mV)Timing Resolution (nanoseconds)AverageMaximum20
is suﬃcient for the worst case scenario - detection of short range attacks using
exotic and expensive relay equipment with very low group delay. The average
timing resolution at higher voltages increases to 300 ns which is still 50 times
smaller than the delay introduced by Hancke’s proof of concept attack [11].
Attaining sub-50 ns resolution places a signiﬁcant restriction on the card
to reader operating distance. With our reader, the card needs to be within a
few millimeters to operate in this voltage range. In practice, this would mean
that the user would need to touch the card on the reader. This reduction in
operating range is clearly a disadvantage though it is worth noting that such
ﬁne resolution is only required to detect short range attacks using sophisticated
and expensive relay equipment. Presumably, a large payoﬀ would be required
to motivate an attacker to go to such eﬀort and expense, perhaps larger value
contactless payment applications or high security physical access control. In these
higher risk application scenarios it may be quite sensible to make the act of using
the card more overt and deliberate by requiring very close proximity operation.
With our reader, 300 ns resolution was attained in the 4-5 cm range. Better
distance performance may be possible and further investigation is required to
assess usable operating range. We suspect that our reader may have been down
on power as it was powered from a USB port. It could not operate a card at 10
cm, the maximum distance required by the standard. 7.5 cm was the limit of
reliable operation.
6 Future work
Further investigation is needed into the impact of diﬀerent RF noise environ-
ments on modulation and detection performance. While our experiments were
carried out in a busy electrical engineering laboratory, this does not characterise
the broad range of possible deployment scenarios.
Data needs to be gathered for a much larger range of readers and cards.
Though we have not investigated it, we suspect that ISO 14443 type B cards
may have better modulation performance at larger distances. Type B does not
use 100% ASK in reader to card communications as type A does. Type A cards
need a store of energy (capacitance) to continue operating during the short
periods of carrier suspension. The availability of this reserve of power reduces
the load that the card can apply to the antenna circuit to modulate the carrier.
Interestingly, the smart card manufacturer Inﬁneon has recently applied for a
patent [13] on a decoupling circuit that makes the power reservoir selectively
unavailable when the card is modulating. They claim that the circuit improves
the modulation performance at larger distances. It would be worth investigating
whether this innovation can further improve the operating range and eﬀective
timing resolution for type A cards using our proposed method.
7 Conclusion
21
We have proposed the ﬁrst symmetric key based distance-bounding protocol
that is resistant to so called ‘terrorist fraud’, together with a security analysis.
In contrast to previous proposals the protocol is appropriate for implementation
in resource constrained devices due to its computationally eﬃciency.
We have analysed the unconventional requirements that distance bounding
protocols place on the communication channel used in the time critical phase,
highlighting the importance of low latency as opposed to raw bit rate. In re-
sponse to these requirements, we proposed a novel approach to communication
that leverages the phenomena of side channel leakage, heretofore considered ex-
clusively as a security vulnerability. We exploit the extremely low latency of side
channel leakage to address the requirements of distance bounding protocols.
We presented experimental results indicating that a modiﬁed form of load
modulation, used in the style of our proposed side channel leakage communi-
cation technique, can provide suﬃcient distance resolution to detect advanced
relay attacks on ISO 14443 smart cards. Our technique has the disadvantage of
reducing the operating range of the smart card. We have argued on the basis
of these results, that it may not be necessary to incur the additional expense
and complexity of implementing ultra wide band radio for the distance bounding
communication channel, as Hancke and Kuhn [12] have asserted.
References
1. ISO/IEC 14443 Identiﬁcation cards-contactless
integrated circuit(s) cards-
proximity cards. International Organisation for Standardisation, Geneva.
2. David Ballo. Measuring absolute group delay of multistage converters. In Pro-
ceedings of 33rd European Microwave Conference, volume 1, pages 89–92. IEEE,
2003.
3. Mihir Bellare, Ran Canetti, and Hugo Krawczyk. HMAC: Keyed-hashing for mes-
sage authentication. Internet Request for Comment RFC 2104, Internet Engineer-
ing Task Force, February 1997.
4. Stefan Brands and David Chaum. Distance-bounding protocols.
In EURO-
CRYPT ’93: Workshop on the theory and application of cryptographic techniques
on Advances in cryptology, pages 344–359, Secaucus, NJ, USA, 1994. Springer-
Verlag New York, Inc.
5. L. Bussard. Trust Establishment Protocols for Communicating Devices. PhD thesis,
Institut Eur´ecom, T´el´ecom, Paris, 2004.
6. Srdjan Capkun, Levente Buttyan, and Jean-Pierre Hubaux. Sector: secure tracking
of node encounters in multi-hop wireless networks. In SASN ’03: Proceedings of
the 1st ACM workshop on Security of ad hoc and sensor networks, pages 21–32,
New York, NY, USA, 2003. ACM Press.
7. Srdjan Capkun and Jean-Pierre Hubaux. Secure positioning in wireless networks.
IEEE Journal on Selected Areas in Communications: Special Issue on Security in
Wireless Ad Hoc Networks, 2006. To appear.
8. Yvo Desmedt. Major security problems with the ’unforgeable’ (Feige)-Fiat-Shamir
In SecuriCom ’88, pages 15–17,
proofs of identity and how to overcome them.
SEDEP Paris, France, 1988.
22
9. Klaus Finkenzeller. RFID Handbook. John Wiley and Sons, Hoboken, NJ, 2nd
edition, 2003.
10. Lishoy Francis, William G. Sirett, Keith Mayes, and Konstantinos Markantonakis.
Countermeasures for attacks on satellite tv cards using open receivers. In CRPIT
’44: Proceedings of the 2005 Australasian workshop on Grid computing and e-
research, pages 153–158, 2005.
11. Gerhard Hancke.
A practical
relay
attack
on
proximity
http://www.cl.cam.ac.uk/˜gh275/relay.pdf accessed October 2005.
cards. Manuscript,
February
2005.
ISO 14443
at
Available
12. Gerhard Hancke and Markus Kuhn. An RFID distance bounding protocol.
In
Proceedings of the IEEE, SecureComm 2005, September 2005.
13. Inﬁneon. Device and method for supplying a data transfer unit with energy. US
Patent Application 20050252972, 17 November 2005.
14. Adrian Jones and Jason McManus. The measurement of group delay using a
microwave system analyser. Microwave Journal, 43(8):106–113, 2000.
15. Ziv Kﬁr and Avishai Wool. Picking virtual pockets using relay attacks on contact-
less smartcard systems. In Conference on Security and Privacy for Emerging Ar-
eas in Communication Networks – SecureComm 2005, Athens, Greece, September
2005. IEEE. To appear. Available at http://eprint.iacr.org/2005/052.pdf accessed
September 2005.
16. Paul Kocher, Joshua Jaﬀe, and Benjamin Jun. Diﬀerential power analysis.
In
Michael Wiener, editor, Advances in Cryptology – CRYPTO ’99, number 1666 in
Lecture Notes in Computer Science, pages 399–397. International Association for
Cryptologic Research, Springer-Verlag, Berlin Germany, August 1999.
17. Alfred J. Menezes, Paul C. van Oorschot, and Scott A. Vanstone. Handbook of ap-
plied cryptography. CRC Press series on discrete mathematics and its applications.
CRC Press, 1997. ISBN 0-8493-8523-7.
18. Naveen Sastry, Umesh Shankar, and David Wagner. Secure veriﬁcation of location
claims. In WiSe ’03: Proceedings of the 2003 ACM workshop on Wireless security,
pages 1–10, New York, NY, USA, 2003. ACM Press.