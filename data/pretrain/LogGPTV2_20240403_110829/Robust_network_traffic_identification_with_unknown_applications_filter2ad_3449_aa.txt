title:Robust network traffic identification with unknown applications
author:Jun Zhang and
Chao Chen and
Yang Xiang and
Wanlei Zhou
This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.
IEEE/ACM TRANSACTIONS ON NETWORKING
1
Robust Network Trafﬁc Classiﬁcation
Jun Zhang, Member, IEEE, Xiao Chen, Student Member, IEEE, Yang Xiang, Senior Member, IEEE,
Wanlei Zhou, Senior Member, IEEE, and Jie Wu, Fellow, IEEE
Abstract—As a fundamental tool for network management and
security, trafﬁc classiﬁcation has attracted increasing attention in
recent years. A signiﬁcant challenge to the robustness of classiﬁ-
cation performance comes from zero-day applications previously
unknown in trafﬁc classiﬁcation systems. In this paper, we propose
a new scheme of Robust statistical Trafﬁc Classiﬁcation (RTC)
by combining supervised and unsupervised machine learning
techniques to meet this challenge. The proposed RTC scheme has
the capability of identifying the trafﬁc of zero-day applications as
well as accurately discriminating predeﬁned application classes.
In addition, we develop a new method for automating the RTC
scheme parameters optimization process. The empirical study on
real-world trafﬁc data conﬁrms the effectiveness of the proposed
scheme. When zero-day applications are present, the classiﬁca-
tion performance of the new scheme is signiﬁcantly better than
four state-of-the-art methods: random forest, correlation-based
classiﬁcation, semi-supervised clustering, and one-class SVM.
Index Terms—Semi-supervised learning, trafﬁc classiﬁcation,
zero-day applications.
I. INTRODUCTION
T RAFFIC classiﬁcation is fundamental to network man-
agement and security [1], which can identify different
applications and protocols that exist in a network. For example,
most QoS control mechanisms have a trafﬁc classiﬁcation
module in order to properly prioritize different applications
across the limited bandwidth. To implement appropriate secu-
rity policies, it is essential for any network manager to obtain
a proper understanding of applications and protocols in the
network trafﬁc. Over the last decade, trafﬁc classiﬁcation has
been given a lot of attention from both industry and academia.
There are three categories of trafﬁc classiﬁcation methods:
port-based, payload-based, and ﬂow statistics-based [2]. The
traditional port-based method relies on checking standard ports
used by well-known applications. However, it is not always
reliable because not all current applications use standard ports.
Some applications even obfuscate themselves by using the
well-deﬁned ports of other applications. The payload-based
method searches for the application’s signature in the payload
of IP packets that can help avoid the problem of dynamic
ports. Hence, it is most prevalent in current industry products.
Manuscript received April 11, 2013; revised October 05, 2013; February 06,
2014; and April 16, 2014; accepted April 21, 2014; approved by IEEE/ACM
TRANSACTIONS ON NETWORKING Editor M. Meo.
J. Zhang, X. Chen, Y. Xiang, and W. Zhou are with the School of
3125,
PI:EMAIL;
Information Technology, Deakin University, Melbourne, Vic.
Australia
PI:EMAIL;
PI:EMAIL; PI:EMAIL).
J. Wu is with the Department of Computer and Information Sciences, Temple
(e-mail:
University, Philadelphia, PA 19122 USA (e-mail: PI:EMAIL).
Digital Object Identiﬁer 10.1109/TNET.2014.2320577
However, more often than not, the payload-based method fails
with encrypted trafﬁc. In recent academic research, signiﬁ-
cant attention has been given to applying machine learning
techniques to the ﬂow statistics-based method. The statistical
method only uses ﬂow statistical features, such as interpacket
time, without requiring deep packet inspection (DPI).
In the traditional framework of multiclass classiﬁcation, most
ﬂow statistics-based methods employ supervised or unsuper-
vised machine learning algorithms to classify network trafﬁc
into predeﬁned classes based on known applications. The super-
vised methods can learn a trafﬁc classiﬁer from a set of labeled
training samples. By contrast, the methods using unsupervised
algorithms automatically categorize a set of unlabeled training
samples and apply the clustering results to construct a trafﬁc
classiﬁer with the assistance of other tools, such as DPI. Under
the assumption that any trafﬁc comes from a known class, a
number of promising results have been reported in the literature.
However, existing ﬂow statistics-based methods suffer from
zero-day applications previously unknown in trafﬁc classiﬁca-
tion systems. Generally speaking, the trafﬁc of zero-day applica-
tions (zero-day trafﬁc) is the major portion of unrecognized data
making up to 60% of ﬂows and 30% of bytes in a network trafﬁc
dataset [3]. More speciﬁcally, the problem of zero-day applica-
tions is conventional methods misclassify zero-day trafﬁc into
the known classes, which results in poor accuracies of known
classes.
In this paper, a novel trafﬁc classiﬁcation scheme is proposed
to tackle the problem of zero-day applications. Our scheme
can effectively improve the accuracies of known classes when
zero-day applications are present. The major contributions of
our work are summarized as follows.
• We propose a Robust Trafﬁc Classiﬁcation (RTC) scheme,
combining supervised and unsupervised learning to ad-
dress the problem of zero-day applications.
• We present a new method to effectively extract the samples
of zero-day trafﬁc from unlabeled network trafﬁc.
• We develop a new method for automating the RTC scheme
parameters optimization process.
To evaluate the new scheme, a large number of experiments
were carried out on multiple real-world network trafﬁc datasets.
The results show the proposed scheme signiﬁcantly outperforms
the state-of-the-art trafﬁc classiﬁcation methods when zero-day
applications are present. Following our previous work [4], ﬂow
correlation was used in the new scheme to improve classiﬁca-
tion performance. In this paper, we provide a new quantitative
study based on probability theory to show how ﬂow correlation
can beneﬁt trafﬁc classiﬁcation.
The rest of this paper is organized as follows. Section II
review on ﬂow statistics-based trafﬁc
presents a critical
1063-6692 © 2014 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.
2
IEEE/ACM TRANSACTIONS ON NETWORKING
classiﬁcation. In Section III, a novel
trafﬁc classiﬁcation
scheme is proposed to deal with zero-day applications.
Section IV presents a new method of parameter optimization
for the proposed scheme. For performance evaluation, a large
number of experiments and results are reported in Section V.
Section VI provides further discussion on the proposed scheme.
Finally, Section VII concludes this paper.
II. RELATED WORK
Current research on network trafﬁc classiﬁcation focuses
on the application of machine learning techniques to ﬂow
statistics-based methods [2]. This can avoid problems suffered
by port-based and payload-based methods such as dynamic
ports, encrypted applications, and user privacy. However,
the ﬂow statistic-based method will not be practical until it
meets several challenges. Previously, the biggest challenge was
real-time trafﬁc classiﬁcation at increasing wire speeds. Now,
operators face another challenge—zero-day applications—due
to the tremendous development rate of new applications [5].
We provide a review of state-of-the-art ﬂow statistics-based
methods with consideration given to zero-day applications.
, consists of
unknown classes,
pose the trafﬁc dataset,
Let us start with a typical real-world network scenario. Sup-
known classes and
. In this
paper, a set of labeled ﬂow samples,
, is available for a known
class,
. By contrast, no labeled ﬂow samples are available for
an unknown class associated with a previously unknown appli-
cation in the system. Given a ﬂow in the dataset, the trafﬁc clas-
siﬁcation problem is to identify if it belongs to a speciﬁc known
class. A ﬂow consists of successive IP packets with the same
5-tuple: source IP, source port, destination IP, destination port,
transport protocol.
A. N-Class Classiﬁcation
Conventional ﬂow statistics-based methods address an
-class classiﬁcation problem without consideration of
zero-day trafﬁc. A typical supervised classiﬁcation method
uses the labeled ﬂow samples,
, straightforward,
and employs a machine learning algorithm to construct a clas-
siﬁer. The classiﬁer trained by using will classify any testing
ﬂow into one of the predeﬁned classes. Thus, zero-day trafﬁc
ﬂows in unknown classes,
, will be misclassiﬁed
into
known classes. The classiﬁcation performance will be
severely affected by zero-day trafﬁc. In early work, Moore
and Zuev [6] applied the naive Bayes techniques to classify
network trafﬁc based on the ﬂow statistical features. Later,
several well-known algorithms were also applied to trafﬁc clas-
siﬁcation, such as Bayesian neural networks [7], and support
vector machines [8]. Erman et al. [9] proposed using unidi-
rectional statistical features to facilitate trafﬁc classiﬁcation in
the network core. For real-time trafﬁc classiﬁcation, several
supervised classiﬁcation methods [10], [11] using only the ﬁrst
few packets were proposed. Considering the ﬁrst few packets of
ﬂows could be missed or disguised, some researchers proposed
classifying a subﬂow captured at any given time [12], [13].
Bermolen et al. [14] studied certain popular P2P-TV applica-
tions, and found P2P-TV trafﬁc can simply be identiﬁed by
the count of packets and bytes exchanged among peers during
small time windows. Our previous work [4] incorporated ﬂow
correlation into supervised classiﬁcation, which displayed
superior classiﬁcation performance, even when the training set
was insufﬁcient. Glatz et al. [15] proposed a new scheme to
classify one-way trafﬁc into classes such as “Malicious Scan-
ning,” “Service Unreachable,” etc., based on preﬁxed rules.
Thus, no training stage was needed. Jin et al. [16] developed a
lightweight trafﬁc classiﬁcation architecture combining a series
of simple linear binary classiﬁers and embracing three key in-
novative mechanisms to achieve scalability and high accuracy.
A similar idea of a classiﬁer combination was also applied in
Callado et al.’s work [17]. Carela-Espanol et al. [18] analyzed
the impact of sampling when classifying NetFlow data and
proposed an improvement to the training process in order to
reduce the impact of sampling. Other existing work includes
the Pearson’s chi-Square test-based technique [19], probability
density function (PDF)-based protocol ﬁngerprints [20], and
small time-windows-based packet count [21].
Previous work has also applied unsupervised clustering
algorithms to categorize unlabeled training samples and
used the clusters produced to construct a trafﬁc classiﬁer.
McGregor et al. [22] proposed grouping trafﬁc ﬂows into a
small number of clusters using the expectation maximiza-
tion (EM) algorithm and manually labeling each cluster to an
application. Some other well-known clustering algorithms,
such as AutoClass [23],
-means [24], DBSCAN [25], and
Fuzzy C-means [26], were also applied to trafﬁc classiﬁcation.
Bernaille et al. [27] applied the
-means algorithm to trafﬁc
clustering and labeled the clusters to applications by using a
payload analysis tool. Wang et al. [28] proposed integrating sta-
tistical feature-based ﬂow clustering with a payload signature
matching method to eliminate the requirement of supervised
training data. Finamore et al. [29] combined ﬂow statistical
feature-based clustering and payload statistical feature-based
clustering for mining unidentiﬁed trafﬁc.
In addition, Ma et al. [30] analyzed three mechanisms using
statistical and structural content models for trafﬁc identiﬁcation.
Their classiﬁcation methods rely on the content of IP payload
and employ unsupervised clustering techniques.
Some empirical studies evaluated the trafﬁc classiﬁcation
performance of different methods. The early works were
reported by Roughan et al. [31] and Williams et al. [32].
Kim et al. [3] extensively evaluated the ports-based CorelReef
method, the host behavior-based BLINC method, and seven
common statistical feature-based methods using supervised
algorithms on seven different trafﬁc traces. Lim et al. [33] iden-
tiﬁed the role of feature discretization for different supervised
classiﬁcation algorithms during the empirical study. However,
these empirical studies did not investigated trafﬁc classiﬁcation
with zero-day applications. In addition, Lee et al. [34] recently
developed a benchmark tool
integrating 11 state-of-the-art
trafﬁc classiﬁers.
B.
-Class Classiﬁcation
A semi-supervised method [35] was proposed to take un-
known applications into account. First, a mixture of labeled and
unlabeled training samples are grouped into
clusters using
traditional clustering algorithms such as
-means. Then, trafﬁc
This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination.
ZHANG et al.: ROBUST NETWORK TRAFFIC CLASSIFICATION
3
clusters are mapped to
or unknown, according to
the locations of the labeled (supervised) training samples. For
trafﬁc classiﬁcation, a ﬂow is predicted to the class of its nearest
cluster. This method demonstrates the potential of dealing with
zero-day trafﬁc generated by unknown applications. Our work
is based on Erman’s semi-supervised method [35] and makes
contributions to zero-day trafﬁc identiﬁcation and automatic pa-
rameter optimization. Later, the ensemble clustering technique
is introduced to improve the semi-supervised method [36].
Liu et al. [37] extended Erman’s work to classify encrypted
trafﬁc by using the composite feature set and combining the
ﬁrst 40-B payload with statistical features of the ﬂow level.
Some methods addressed a one-class classiﬁcation problem
that has potential to deal with zero-day trafﬁc. Considering
one-class classiﬁcation, any testing ﬂow can be determined
whether it belongs to a known class. If the ﬂow does not belong
to any known class, it is identiﬁed as unknown trafﬁc. This
means the problem of zero-day applications can be bypassed.
An early work is creating a one-class classiﬁer using a nor-
malized threshold on statistical features [20]. This method is
heuristic and unreliable because the normalized threshold is
hard to tune beforehand, especially without information con-
cerning zero-day trafﬁc. A modiﬁed one-class SVM method has
been proposed for trafﬁc classiﬁcation [8]. For a known class
are used to learn a one-class
SVM, and other training samples in
are used to
adjust the decision boundary. This method has two issues.
First, one-class SVM [38] normally requires a large number of
training samples. Second, the decision boundary is poor due to a
lack of information about the unknown classes,
.
Xie et al. [39] proposed a subﬂow scheme that learns to identify
each application in isolation, instead of distinguishing them
individually using subspace clustering. However, the binary
classiﬁer for each application is heuristic and relies on a prede-
ﬁned distance threshold. Moreover, the implementation of their
scheme is unclear.
, the training samples in
III. PROPOSED SCHEME: RTC
As discussed in Section II, existing trafﬁc classiﬁcation
methods suffer the problem of zero-day applications due to a
lack of zero-day trafﬁc samples in the classiﬁer training stage.
How to obtain sufﬁcient zero-day trafﬁc samples becomes a
key question for fundamentally solving this problem. Our work
is motivated by the observation that unlabeled network data
contains zero-day trafﬁc. We aim to build a robust classiﬁer by
extracting zero-day samples and incorporating them into the
training stage.
This section presents a robust trafﬁc classiﬁcation scheme
to deal with zero-day applications. Fig. 1 shows a new frame-
work of RTC. There are three important modules in the pro-
posed framework: unknown discovery, “bag of ﬂows” (BoF)-
based trafﬁc classiﬁcation, and system update. The module of
unknown discovery aims to automatically ﬁnd new samples of
zero-day trafﬁc in a set of unlabeled trafﬁc randomly collected
from the target network. The module of BoF-based trafﬁc clas-
siﬁcation takes prelabeled training samples and zero-day trafﬁc
samples as input to build a classiﬁer for robust trafﬁc classi-