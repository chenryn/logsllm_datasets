crease K further.
The grid search technique for identifying parameters uses six
models for both 60s and 300s intervals, a representative sample of
router ﬁles (one large, one medium, and one small sized ﬁle), and
1
0.8
0.6
0.4
0.2
F
D
C
l
a
c
i
r
i
p
m
E
H=5, K=1024
H=5, K=8192
H=5, K=65536
0
-0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1 1.2
Relative Difference (%)
(a) Model=EWMA
H=5, K=1024
H=5, K=8192
H=5, K=65536
1
0.8
0.6
0.4
0.2
F
D
C
l
a
c
i
r
i
p
m
E
0
-1.2 -1 -0.8 -0.6 -0.4 -0.2
0
Relative Difference (%)
0.2 0.4
(b) Model=ARIMA0
based on large and diverse data sets show that the values we have
chosen (H = 1..25), (K = 1K .. 64K) are indeed the right ones for
the change detection class of applications.
5.2.1 Top-N sketch vs. per-ﬂow evaluation
Here we are interested in exploring, for a given N, how many of
the top-N ﬂows (ranked in order of decreasing magnitude of fore-
casting errors) detected by the per-ﬂow scheme are also detected as
top-ranking by our sketch-based scheme.
We choose three values of H (5, 9, 25) and K (8K, 32K, 64K),
two values of intervals (60s and 300s), and selected three router
data ﬁles representing high volume (over 60 Million), medium (12.7
Million), and low (5.3 Million) records, to carry out sketch accu-
racy evaluation across all models. For the model parameters, we
use the parameter values selected by the grid search process. For
each time interval, we generate the top-N ﬂows with the maximum
absolute forecast errors (recall that a higher absolute forecast er-
ror indicates that a ﬂow’s volume has a higher deviation from that
predicted by the underlying model) for both sketches and per-ﬂow
techniques. For four values of N (50, 100, 500, 1000), we see how
many of the top-N ﬂows are in common between the two resulting
sets and compute a similarity metric NAB/N, where NAB is the
number of common elements in the two sets.
While some of the top-N ranked elements from the per-ﬂow tech-
nique may not belong to exactly the top-N elements output by the
sketch technique, the hope is that these elements will still be high
in the sketch-based ranking. Thus, it is possible to increase the
accuracy by comparing the top-N per-ﬂow list with additional ele-
ments in the sketch-based ranked list. To evaluate this possibility, a
second set of comparisons involves comparing the top-N per-ﬂow
results against the top-X*N (X = 1, 1.2, 1.5, 2) results from the
sketch-based approach.
Figure 3: Result of varying K in random
5.2.1.1 Results.
(H=1, K=8192) combination. For each (model,router,H,K) combi-
nation, grid search outputs the parameter value(s) for that model
that minimize the total energy in the resulting forecast errors. Us-
ing this parameter setting output by grid search, we run per-ﬂow
analysis and obtain the corresponding total energy. The per-ﬂow
estimate is then compared against the per-ﬂow estimates of the ran-
dom parameters generated in the previous technique, for the same
router ﬁle and model. The goal of this experiment is twofold: ﬁrst,
we ensure that grid search results are never worse than any of the
per-ﬂow values of the random parameters. Second, we show that
grid search results can be signiﬁcantly better than the results in the
random case. Our experimental results (no graphs shown) show
that in all cases (all models, three router ﬁles, both intervals) grid
search is never worse than the random parameters. Secondly, in at
least 20% of the cases the results with the random parameters are
at least twice (and in many cases much more) as bad as the errors in
the grid search case. This justiﬁes the use of grid search to generate
the parameters for the remainder of the experiments.
5.2 Accuracy
After validating the set of parameters from the grid search scheme,
we need to demonstrate that the sketch scheme’s results are accu-
rate as compared to per-ﬂow estimates. We estimate accuracy in
our experiments via two techniques: (i) Top-N, and (ii) Threshold-
ing.
The values of H and K are key to the accuracy of our forecasts as
well as efﬁcient operation. Care must be taken to choose the proper
range of values on a per-application basis. Our experimental results
y
t
i
r
a
l
i
m
S
i
1
0.9
0.8
0.7
0.6
0.5
0
5
y
t
i
r
a
l
i
m
S
i
1
0.9
0.8
0.7
0.6
0.5
30
35
TopN=50
TopN=100
TopN=500
TopN=1000
0
30
90
60
120
Time(unit = 1 min.)
150
180
TopN=50
TopN=100
TopN=500
TopN=1000
10
20
15
25
Time(unit = 5 min.)
(a) Interval=300
(b) Interval=60
Figure 4: Overall similarity of sketch and per-ﬂow for large
router ﬁle, H=5, K=32K
Results in this section show how well sketches perform when
compared with per-ﬂow by comparing their top-N (N=50, 100, 500,
1000) ﬂows. The metric is essentially a similarity one: the number
of common elements in the two sets normalized by N. We start by
showing how this metric is remarkably consistent across the time
intervals, for moderate H and K. We set aside the ﬁrst hour of the
four hour data sets for model warmup purposes leaving 180 and 37
intervals respectively in the 60s and 300s time interval cases. Fig-
ures 4 (a) and (b) show that even for large N (1000), the similarity
is around 0.95 for both the 60s and 300s intervals, for H=5 and
K=32K. In the rest of the ﬁgures in this section, we show the mean
similarity value across the 180 and 37 intervals.
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
8192
TopN=50, H=5
TopN=100, H=5
TopN=500, H=5
TopN=1000, H=5
32768
65536
K
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
8192
TopN=50, H=5
TopN=100, H=5
TopN=500, H=5
TopN=1000, H=5
32768
65536
K
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
1
TopN=50, K=8192
TopN=100, K=8192
TopN=500, K=8192
TopN=1000, K=8192
5
9
H 
1
0.8
0.6
0.4
0.2
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
25
0
1
TopN=50, K=32768
TopN=100, K=32768
TopN=500, K=32768
TopN=1000, K=32768
5
9
H 
25
(a) Interval=300
(b) Interval=60
(a) Interval=300
(b) Interval=60
Figure 5: Similarity using EWMA model for large router ﬁle
(topN sketch vs. topN per-ﬂow)
Figure 7: Effect of varying H and K for EWMA model for large
router ﬁle (topN sketch vs. topN per-ﬂow)
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
1
TopN=50,H=5,K=8192
TopN=100,H=5,K=8192
TopN=500,H=5,K=8192
1.25
1.5
X 
1.75
2
y
t
i
r
a
l
i
i
m
S
e
g
a
r
e
v
A
1
0.8
0.6
0.4
0.2
0
1
TopN=50,H=5,K=8192
TopN=100,H=5,K=8192
TopN=500,H=5,K=8192
1.25
1.5
X 
1.75
2
y
t
i
r
a
l