title:Data management mechanisms for embedded system gateways
author:Justin Ray and
Philip Koopman
978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
175
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 
DataManagementMechanismsforEmbeddedSystemGatewaysJustinRayCarnegieMellonUniversityPittsburgh,Pennsylvania,USAjustinr2@cmu.eduPhilipKoopmanCarnegieMellonUniversityPittsburgh,Pennsylvania,USAkoopman@cmu.eduAbstractItisbecomingincreasinglycommontoconnecttra-ditionalembeddedsystemnetworkstotheInternetforremotemonitoring,high-levelcontrolandintegration.Itisnecessarytoprotecteachpartoftheinterconnectedsystemfromfaultsandattackswhichpropagatefromtheotherside.OnearchitecturalapproachistoaddagatewaytotheembeddedsystemtoreceiveInternettraf-ﬁcanddispersedatatotheembeddedsystem,butthereisnoclearrecipeforbuildingsuchgateways.SinceIn-ternetrouterscommonlyusequeuestomanagetraﬃc,weexaminetheeﬀectivenessofqueuesfortheembeddedsystemgatewaydomain.Weperformaseriesofexper-imentstoevaluatetheeﬀectivenessofthequeuemech-anismandvariousqueuemanagementtechniques.Weshowthatqueuescanexhibitpoorperformanceinthecontextofreal-timeembeddedsystemgatewaysduetoproblemswithmessagelatencyanddroppedmessages.Wethenintroducetheconceptofaﬁltermechanismandshowthatasimpleﬁltermechanismcanoutper-formqueuemechanismswhenusedinthegatewaytomanagereal-timestate-orienteddatastreams.1IntroductionEmbeddedsystemsthattraditionallyhaveoperatedinisolationoronclosednetworksarebeingconnectedtotheInternetortoothernetworkedsystemstoin-creasefunctionalityandconsolidateoperations.Anembeddedsystemgatewayisthedevicethatmanagestheﬂowofinformationbetweenthesetwonetworks,andwewillusetheterm“gateway”throughoutthispapertorefertosuchdevices.Inorderforthesystemtobesurvivable,thegate-waymustcontroltheﬂowofinformationinawaythatmeetstherequirementsofthesystemanddoesnotad-verselyaﬀectlocaltraﬃcontheindividualnetworks[6].Becausethesenetworkshavediﬀerenttimingprop-erties,normal(non-faulty)timingofmessagearrivalontheInternetsidemaycausethegatewaytofailtomeetreal-timerequirementsontheembeddedside.Stan-dardsecurityandsurvivabilitypractices,whileimpor-tant,arenotgearedtowardprotectingsystemsagainstthesekindsoffaults.Gatewaysmustbedesignedtoprovideisolationagainsttimingvariationsandfaultsbetweenthetwonetworksinordertomaintainthede-pendabilityoftheinterconnectedsystems,butthereisverylittleguidanceintheliteratureabouthowtodoso.Thispaperpresentsaninitialinvestigationofthemechanismsthatcanbeusedinagatewayfortimingfaultcontainment,whichisaﬁrststeptowarddevel-opingsurvivablegateways.AgatewayisconceptuallysimilartoroutersusedinInternetinfrastructure.SincequeuesarecommonlyusedtomanagepacketﬂowsinInternetrouters,webe-ginbyusingqueuesasdatamanagementmechanismsingateways.Weexplorevariousdesignparametersforqueues,includingqueuelengthandqueuemanagementpolicies.Inordertoevaluatetheperformanceofdataman-agementmechanismsinthegateway,wedevelopedasimulationframeworkwhichmodelsthegatewayandthetimingcharacteristicsofthetwonetworksattachedtoit.Usingthissimulation,weareabletostudyandcomparediﬀerentmechanismsunderrepeatablecondi-tions.Weusethisframeworktomodelthescenarioofperiodicstatevariabledatabeingtransmittedfromaserveronanenterprisenetworkviaagatewaytoanembeddedcontrolsystemonanembeddednetwork.Webeginbyexploringthedesignspaceofqueu-ingmechanismsandevaluatingtheeﬀectivenesswithwhichqueueswithvariousparameterscanmitigatetimingdiﬀerences.Basedonourexperimentalresults,wewillshowthatqueuemechanismsdonotperformwellinthisscenariobecauseofthelatencytheyin-troduceandbecauseofdroppedmessages.Analysisofthequeuemechanismyieldsanimportantinsight:queueunderﬂowisasigniﬁcantsourceofdelaybecauseitresultsinlostbandwidthformessagesdeliveredin978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
176
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 
gatewayEmbeddednetwork(e.g.CANorFlexRay)Enterprisenetwork(e.g.Ethernet)oranotherembeddednetworknodenodenodenodenodenodenodenodeFigure1.Abasicconﬁgurationoftwonetworksandagatewaythereal-timenetwork.Basedonthisanalysis,wepro-poseaﬁltermechanismtoovercometheshortcomingsofqueuemechanisms.Theremainderofthispaperisorganizedasfollows:Section2expandsontheconceptofanembeddedsys-temgatewayanddescribestheconstraintsunderwhichthesesystemsoperate.Section3highlightspreviousworkrelatedtothispaper.Section4describesqueuemechanismsandtheirdesignparameters.Section5describesourexperimentalapproach,andSection6presentstheresultsofourevaluationofqueuemecha-nisms.Section7oﬀersinsightintotheshortcomingsofthequeuemechanismsandhowthoseshortcomingscanbemitigated.Section8deﬁnesﬁltermechanisms,andSection9oﬀersexperimentalresultscomparingﬁltersandqueues.Section10summarizesourcontributionsandoutlinesfuturedirectionsforthisresearch.2BackgroundAgatewayisasystementitythatmanagestheﬂowofinformationbetweentwonetworks.Figure1showsanexampleoftwonetworksinterconnectedbyagateway.Toimplementcommunicationbetweentwonetworks,theremustbeadevicewithinterfacesonbothnetworkstoeﬀectmessagepassingbetweenthenetworks.Inadditiontothephysicalinterfaces,thegatewayalsomustdeterminewhichmessagesareforwarded,ifanytranslationorrepackagingwilltakeplace,andwhentosendthemessagesbasedonthenet-workschedules.Whileallofthegatewaylogiccouldbeincludedinsuchadual-homeddevice,itisalsopos-sibletoallocatesomeofthedecisionmakingbehaviortoindividualnodesonthetwonetworks.Therefore,theterm“gateway”aswewilluseitinthispaperreferstotheabstractconceptthatincludesnotonlyadual-homeddevice,butalsothelogicgoverninggatewayop-eration,regardlessofwherethatlogicislocated.Embeddedsystemgatewaysgobeyondtraditionalroutersbecausetheyconnecttwodiﬀerenttypesofnet-works.Diﬀerentnetworkscanhavediﬀerenttimingre-quirementsbecauseofthediﬀerentmethodstheyuseforaccesscontrolanderrorcorrection.Forexample,TCP/IPoverEthernetusesretransmissionmechanismstoensurereliabledelivery,butpacketshavehighlyvari-ablelatencywhichisunboundedintheworstcase.AControllerAreaNetwork(CAN)hasbit-arbitratedmessageprioritization,sothelatencyofanymessageisaﬀectedbythescheduleofallhigherprioritymes-sages[10].FlexRay[2]andtheTimeTriggeredPro-tocol(TTP)[13]aretime-divisionmultiplexaccess(TDMA)networksthatexecuteperiodicschedulesandmakestrictreal-timeguaranteesforperiodicschedules.Thereareseveralscenarioswhereagatewaymightbeused.Therequirementsforthegatewaywilllikelybediﬀerentineachscenario.Agatewayinarealsys-temmightberesponsibleforseveraldataﬂowswhichcouldencompassmorethanoneofthesescenarios.•Enterprise-to-Embedded—dataissenttothegate-wayoverenterprisenetworks(suchastheInternetoraLAN).Thegatewaythensendsthisdataoutonareal-timeembeddednetwork.AnexampleofthissystemisasupervisorycontrolapplicationthatrunsonacorporateLANandconnectsviagatewaytoafactorycontrolnetwork.•Embedded-to-Enterprise—thegatewayreceivesdatafromareal-timeembeddednetworkandthensendsittoaserverorpersonalcomputeroveranenterprisenetwork.Thisscenariomightariseifanembeddedsystem(suchasathermostatonahomeautomationnetwork)reportsitsstatustoanInternetserver.•Embedded-to-Embedded—thegatewayconnectstwoembeddednetworksthatareofadiﬀerenttype.Thetwonetworkscouldalsobeofthesametypebutconﬁguredtorunatdiﬀerentspeedsorwithdiﬀerentschedules.Forexample,manyauto-mobileshaveseveralembeddednetworks.Thesenetworkscouldbeinterconnectedtoimplementnewsystemfeatures.Adatamanagementmechanismisthepartofthegatewaythathandlesthetransferofdatafromthein-putinterfacetotheoutputinterface.Whenwerefertoamechanisminthispaper,wearereferringtothesedatamanagementmechanisms.Themechanismdeter-minestheorderinwhichmessagesaresentoutandwhichmessages(ifany)aredropped.Italsoencom-passeswhateverstorageisrequiredforpendingmes-sages.Amechanismonlyhandlesmessagesofonetype,suchasmessagesrelatedtoonestatevariable.Iftherearemultipledatastreamsinthegateway,eachstreamhasitsowndatamanagementmechanism.Atahighlevel,agatewayperformsatasksimilartothatofInternetrouters.Theserouterscommonlyusequeuemechanismstomanagepacketﬂows,sowebeginourexaminationofdatamanagementmechanismswithqueuemechanisms.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
177
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 