title:An End-Host View on Local Traffic at Home and Work
author:Ahlem Reggani and
Fabian Schneider and
Renata Teixeira
An End-Host View on Local Trafﬁc at Home and Work
Ahlem Reggani1, Fabian Schneider2, and Renata Teixeira1
1 UPMC Sorbonne Universit´es and CNRS, LIP6, Paris, France
2 NEC Laboratories Europe, Heidelberg, Germany (work done at UPMC1)
Abstract. This paper compares local and wide-area trafﬁc from end-hosts con-
nected to different home and work networks. We base our analysis on network and
application traces collected from 47 end-hosts for at least one week. We compare
trafﬁc patterns in terms of number of connections, bytes, duration, and applica-
tions. Not surprisingly, wide-area trafﬁc dominates local trafﬁc for most users.
Local connections are often shorter and smaller than Internet connections. More-
over, we ﬁnd that name services (DNS) and network ﬁle systems are the most
common local applications, whereas web surﬁng and P2P, which are the most
popular applications in the wide-area, are not signiﬁcant locally.
1 Introduction
The past couple of decades has seen many studies that characterize Internet trafﬁc [1,
6, 7, 12]. These studies are based on packet traces collected in ISP networks, at border
routers of university campuses or enterprise networks. As such, most prior studies focus
on wide-area trafﬁc. Little is known about the trafﬁc that stays inside a network, which
we call local trafﬁc. The main exception is the study of trafﬁc from one enterprise [8,
9], which shows that local trafﬁc is different from wide-area trafﬁc with a signiﬁcant
amount of name service, network ﬁle system, and backup trafﬁc. As the authors point
out their study is “an example of what modern enterprise trafﬁc looks like” [9]. It is
crucial to reappraise such analysis in other enterprises and more important in other
types of edge networks. For instance, the spread of broadband Internet has caused an
increase in the number of households that have a home network. Yet, there has only
been limited analysis of local trafﬁc volumes in three home networks [5], but no in
depth characterization of in-home trafﬁc patterns. The challenge of studying local trafﬁc
across multiple edge networks is to obtain measurements from inside multiple networks.
This paper characterizes local network trafﬁc of multiple networks from the perspec-
tive of an end-host that connects inside an edge network. This approach is in contrast
with previous work [5, 9], which instruments routers in the local network. Although
instrumenting routers could capture all trafﬁc traversing the local network, it is hard to
have access to routers at more than a few networks. By monitoring trafﬁc directly at
end-hosts, we can sample a larger number of networks, but we can only see the trafﬁc
from one of the hosts in the network. For smaller networks (such as home networks) a
single host’s trafﬁc captures a signiﬁcant fraction of those networks total trafﬁc, whereas
for larger networks (as enterprises) this fraction is less signiﬁcant.
We rely on data collected at end-hosts using the HostView monitoring tool [4].
HostView records packet header traces and information about applications and user
N. Taft and F. Ricciato (Eds.): PAM 2012, LNCS 7192, pp. 21–31, 2012.
c(cid:2) Springer-Verlag Berlin Heidelberg 2012
22
A. Reggani, F. Schneider, and R. Teixeira
environment. The data we study was collected from 47 users who ran HostView for
more than a week each. Given that users move between different networks, this dataset
contains end-host trafﬁc from a total of 185 different networks spread over 18 differ-
ent countries. Section 2 gives an overview of the HostView data. The analysis of local
and wide-area trafﬁc from HostView data is challenging, because HostView has no in-
formation of which trafﬁc ﬂows are local. Worse, HostView scrapes the end-host IP
address from the traces to protect user’s privacy, which makes the identiﬁcation of local
trafﬁc more challenging. Therefore, we develop a heuristic to separate local from wide-
area trafﬁc. Section 3 describes this heuristic together with our method to categorize
environments and applications in the HostView data.
Our analysis (presented in Section 4) asks some high-level questions, for instance:
How does the volume of an end-host’s local trafﬁc compare to wide-area trafﬁc? Do lo-
cal and wide-area applications differ? How does trafﬁc vary between home and work?
The results show that for most users wide-area trafﬁc dominates local trafﬁc, but that
some users have over 80 % of local trafﬁc. Local connections are mostly shorter and
smaller than wide-area connections, but sometimes they transfer a larger amount of
trafﬁc than large wide-area connections. We ﬁnd that typical local applications are
DNS, ssh, and network ﬁle systems (conﬁrming previous ﬁndings [9]). Moreover, com-
mon applications at work include backup, printing, and web. Yet, these applications are
rarely used at home.
2 Summary of HostView Data
In this paper, we use three of the datasets collected by the HostView tool [4]: network
packet traces, application labels, and the end-host’s network environment. HostView
logs all this data directly at the end-host into a trace ﬁle, which is periodically uploaded
to a server. A new trace is created every four hours or when a change in the network
interface or the IP address is detected.
Network traces and application context. HostView logs the ﬁrst 100 bytes of each
packet sent and received by the end-host with libpcap. For DNS packets, it records the
whole packet to enable ofﬂine hostname to IP address mappings. In this paper, we use
the connection summaries generated by previous work [3]. Each connection summary
record describes both directions of a TCP or UDP connection and includes (among
other ﬁelds): The source and destination IP addresses (replacing the host IP address
with “0.0.0.0” to comply with French privacy laws), the source and destination port
numbers, and the network protocol; The number of bytes, the number of packets, and
the duration of the connection; And the name of the process executable that generated
the connection.
Network environment. HostView labels each trace ﬁle with information describing
the network environment the end-host is connected to, including the network interface,
a hash of the wireless network SSID and of the BSSID of the access point for wire-
less networks or a hash of the MAC address of the gateway for wired networks. It also
records the ISP, the city, and the country for each trace using the MaxMind GeoIP
commercial database from March 2011. When the end-host connects to a new wireless
An End-Host View on Local Trafﬁc at Home and Work
23
network, HostView asks the user to specify the network type from a pre-deﬁned list:
Home, Work, Airport, Hotel, Conference meeting, Friend’s home, Public place, Coffee
shop or Other (with the possibility to specify). This user tag is used to classify the net-
work the user connects to according to an environment type. Unfortunately, this tag is
not available for wired connections and users sometimes skip the questionnaire. Origi-
nally, only 40 % of HostView traces had a user tag, but after applying some heuristics
(which exploit the fact that users connect to the same network with both wireless and
wired, for instance) previous work was able to label 78 % of the traces [3]. Still, the data
includes at least one unlabeled trace per user. The next section describes our method to
label most of the remaining traces with an environment type.
Dataset characteristics and biases. HostView was announced in networking confer-
ences and researcher mailing lists. Volunteer users downloaded HostView (which is
available only for Mac OS and Linux) and ran it during different time intervals between
November 2010 and August 2011. In this paper, we use traces from 47 users who ran
HostView for at least one week; 32 of these users ran HostView for more than a month.
Because of the way HostView was advertised and its limited operating-system sup-
port, the user population is biased towards networking researchers. We acknowledge
that networking researchers probably use different applications than the average user
and may also work from home. It is still interesting to study examples of the differences
between local and wide-area trafﬁc. We do observe a diverse set of applications among
different users and our users do use some popular applications like YouTube, Facebook
and BitTorrent. Furthermore, this bias inﬂuences the types of networks we study. Im-
portantly, “work” is often a university. Overall, we study end-hosts connected to 185
unique networks spread over 18 different countries (Italy: 25, France: 22, Germany: 21,
Rest of Europe: 31, Asia: 19, US: 63, Australia: 3, and Brazil: 1); 34 distinct home
networks and 38 distinct work environments (29 are universities and 9 enterprises).
Another bias comes from using data collected for a limited time period on only one
single end-host in the network. It is well known that trafﬁc characteristics can vary
considerably between different networks and over time [10]. HostView can only see a
small fraction of the network’s trafﬁc and there are some types of trafﬁc that it can never
observe. For example, some homes may have a media server that serves content to the
TV; this type of trafﬁc traverses the home network, but it is not originated or consumed
by an end-host. Despite these shortcomings, we believe that this end-host perspective
on local versus wide-area trafﬁc offers the unique opportunity to sample trafﬁc in a
relative large number of networks. Whenever appropriate, we also contrast our ﬁndings
with previous work.
3 Methodology
In this paper, we compare local and wide-area trafﬁc in networks of different types.
In addition, we are interested in the trafﬁc application mix. We follow three steps to
label HostView traces before our analysis: (i) Differentiation of local and wide-area
trafﬁc, (ii) Extension of the incomplete network type labeling, and (iii) Categorization
of connection records into application groups.
24
A. Reggani, F. Schneider, and R. Teixeira
Table 1. Examples of process names and network services to category mappings. This list is not
complete and only intended to give an idea.
Category
Process name (Examples)
Application protocols
retroclient
Skype, iChat, Adium, Pidgin
amanda
ircd, SIP, msnp, snpp, xmpp
ssh(22), webmin
IMAP(S), POP3(S), (S)SMTP
rtsp
ftp, rsync, svn, cvspserver
BOOTP, MySQL, VPN, SNMP, whois
—
domain(53), mdns, netbios-ns
AFP, AFS, LDAP, netbios, nfs
amule, Kazaa, BitTorrent
ipp, printer
HTTP(S)
Mail, Outlook, Thunderbird
Media players, games, productivity
ftp, dropbox, svn, git, SW updates
traceroute, iperf, nmap, ntpd, uPNP
Backup
Chat
DistantControl ssh, sshd, VNC, screen sharing
Email
Personal
FileTransfer
Management
Miscellaneous perl, python, VirtualBox, openvpn
NameService
NetworkFS
P2P
Printing
Web
dns, nmblookup, named, nmbd, nscd
smbclient, smbd, AppleFileServer
amule, uTorrent, transmission
cupsd, lpd, HP, Lexmark
Firefox, Chrome, Safari, Opera, httpd,
plugin-container, WebKitPluginHost
Local vs. wide-area. HostView does not collect the host IP address, so we cannot
identify the local subnet based on the host IP preﬁx. We develop a number of heuris-
tics to classify trafﬁc as local or wide-area. We deﬁne local trafﬁc as all the trafﬁc
exchanged between an end-user machine and a private IP address, i. e., 192.168/16,
172.16/12, 10/8. We expect this classiﬁcation to correctly match most local trafﬁc
at homes, as those typically connect through a NAT gateway sharing one public IP on
the outside. To avoid misclassiﬁcation when the ISP employs carrier-grade NAT, we
develop a second heuristic that analyzes the remote IP addresses of all trafﬁc ﬂows
classiﬁed as local. When we observe that the remote IP addresses fall in more than ﬁve
different subnets, we compute the number of connections and bytes for each remote /24
to identify whether there is a “preferred subnet”, i.e., a remote subnet that carries most
of the trafﬁc (>99.9 %). If there is a preferred subnet, then we leave all trafﬁc classiﬁed
as local. Otherwise, we ﬂag the network for manual inspection. The HostView data had
a total of ﬁve home networks which contacted more than ﬁve different remote subnets,
four of these had a preferred subnet. We manually inspected the remaining home net-
work and found that a large fraction of P2P trafﬁc going to IPs in 10.* networks. In
fact, this user’s home ISP is known deploy carrier-grade NAT, so we label this 10.*
trafﬁc as wide-area and we leave the 192.* trafﬁc as local. For work networks, we
might misclassify local trafﬁc as wide-area when hosts connected to the local network
have public IP addresses. We address this issue with a third heuristic that labels all traf-
ﬁc to a destination IP address that has the exact same organization name as that of the
source network as local. Finally, we classify all broadcast trafﬁc as local. We label all
the remaining trafﬁc as wide-area.
Extension of network environment labels. As discussed in Section 2, some of the
HostView traces have no network type tag (e. g., Home or Work). We manually inspect
the ISP, the network interface, and the geo-location of each unlabeled trace and assign
a label. For example, we label a trace annotated with ISP: “University of California”;
An End-Host View on Local Trafﬁc at Home and Work
25
Wide−Area/TCP
Wide−Area/UDP
Local/UDP
Local/TCP
0
0
1
0
8
0
6
0
4
0
2
0
]
%
[
r
e
s
u
r
e
p
s
n
o
i
t
c
e
n
n
o
c
f
o
s
e
s
s
a
C
l
D
I
r
e
s
U
3
46
47
6
42
5
30
1
39
41
Wide−Area/TCP
Wide−Area/UDP
Local/UDP
Local/TCP
14
23
29
25
22
17
4
11
32
10
2
20
26
31
0
0
1
0
8
0
6
0
4
0
2
0
]
%
[
r
e
s
u
r
e
p
s
e
t
y
b
c
i
f
f
a
r
t