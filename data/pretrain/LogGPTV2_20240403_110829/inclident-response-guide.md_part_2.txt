的计算机，甚至欺骗其他员工通过模拟使用受感染计算机的员工来丢弃所需的数据。
应急响应步骤
本节介绍事件响应过程的基础知识。
关于事件响应
7
事件响应基础
事件响应（IR）是解决和管理事件结果（例如网络攻击）的有组织的过程。
事件响应的主要目标包括：
减小攻击危害
减少灾复时间
制定将来防止这种攻击的指示和防御措施。
事件响应的过程从安全事件的调查开始。 当安全小组调查事件时，必须确定：
攻击途径
攻击者提供有效载荷的手段。
载荷和漏洞利用
攻击者利用的恶意软件和其它工具。
攻击目标
受攻击影响的网络、系统和数据。
造成伤害
攻击造成的物理和声誉损失的数量。
攻击状态
攻击生命周期的当前阶段，攻击者是否能够执行行动来实现目标，以及攻击者是否达到
攻击目标。
攻击时间线
何时攻击开始和结束，何时被检测到，以及何时安全小组能够对攻击做出反应。
调查完成后，安全小组必须使用获取的信息来恢复目标系统，并更新安全策略和IR计划。
关于事件响应阶段
根据有关攻击生命周期的信息，安全小组可以制定防御性战略并将其用于事件响应。 事件响
应示例章节中提供了应用此类策略的示例。
8
事件响应基础
事件响应过程包括以下阶段：
1.准备
2.鉴定
3.遏制
4.根除
5.恢复
6.经验学习
第一阶段：准备
发生攻击时，安全小组必须采取快速准确的行动。 这需要做好准备。 安全团队的成员必须准
备可以帮助防止，检测和应对网络攻击的流程，工具和策略。
准备工作还必须包括对公司员工的培训。 所有公司的员工都必须熟悉安全策略，并知道在面
对网络攻击时该怎么办。
进行事件响应的安全小组必须通过不断获得事件响应领域的知识和不断的实践来建立专业知
识。
第二阶段：鉴定
在此阶段，安全小组必须确定事件(event)是否是信息安全事件。为此，安全小组必须将可用
的事件信息与已知的入侵指标进行比较。
入侵指标（IOC）是识别系统或网络上的潜在恶意活动的数据片段。 IOC示例包括异常网络流
量，多次失败登录尝试，恶意软件使用的文件的存在以及可疑注册表或系统文件更改。
9
事件响应基础
为了收集IOC，安全小组可以从公开报告和威胁资料中获取信息，并对恶意软件进行静态和动
态分析。
在不启动软件的情况下执行静态分析。它可以用于获取几种类型的IOC，包括软件使用的Web
和电子邮件地址以及其文件的散列。
动态分析需要在受保护的环境（沙箱或独立计算机）中执行该软件。动态分析允许检查与之
相关的软件行为和IOC收集。
收集IOC是一个循环过程。 根据有关攻击的初步信息，安全小组可以创建检测方案。 应用这
些场景通常可以检测到新的IOC。 新的IOC有助于进一步识别攻击并获得更多信息，从而创建
一个循环。
只有事件（event）被认为是信息安全事件，才能继续执行IR进程的剩余阶段。
第三阶段：遏制
在此阶段，安全小组必须识别受损的计算机，并调整安全策略，以防止公司资产的进一步感
染。 安全小组还必须重新配置组织的网络，避免受到已经被攻击的资产的影响。
10
事件响应基础
例如，如果组织网络中的其中一台服务器受到攻击者的危害，则安全团队必须将该服务器与
网络隔离。 安全团队还必须调整路由策略，将此服务器的负载分发到其他服务器。
第四阶段：根除
在此阶段，安全小组必须将受损资产恢复到原始状态。 这通常涉及删除恶意软件，恢复配置
和删除恶意软件遗留的任何组件。
例如，如果计算机受到后门软件的侵害，安全小组必须删除后门软件，将受损文件和系统注
册表恢复到原始状态，并删除后门软件安装文件。
第五阶段：恢复
在此阶段，之前受到攻击的资产重新投入使用。 安全小组必须监测资产的状况一段时间，以
确保威胁得到彻底消除。
例如，如果组织网络中的其中一个服务器已恢复，则安全小组将其重新安装到组织的网络
中，调整路由策略以使用此服务器，并监视服务器的行为一段时间以确保没有可疑活动。
第六阶段：经验学习
在这个阶段，安全小组必须对事件进行分析，制定有助于防止今后发生事件的措施，并更新
此类事件的事件应急计划。
这些措施可能包括调整安全政策，改变组织资产的配置，以及对公司员工进行信息安全培
训。
事件响应计划是一组书面指示，可以识别事件和对其的响应。 即使不可能在将来完全防止事
件发生，事件响应计划也将有助于尽可能减少事件发现所需的时间，提高事件响应的有效
性。
11
推荐的IR流程和规则
推荐的IR流程和规则
本章介绍了事件响应和进行事件调查的规则和建议。
准备
本节为事件响应过程的准备阶段提供建议。
防御措施
为了有效防范网络攻击，安全团队必须采取防御措施保护组织资产。 建议创建几层保护，从
而创建一个可以抵御多种攻击方式的网络攻击的防御边界。
例如，考虑以下防御措施：
在所有工作站上安装终端防病毒解决方案。
在网络中安装入侵防御系统。
通过防火墙保护互联网的网关。
互联网访问只能以授权的方式通过组织的代理服务器进行。
组织使用SIEM系统跟踪事件。 SIEM系统集成了威胁情报。
网络攻击的诱饵系统（也称为蜜罐）由安全小组隔离并密切监控。
卡巴斯基实验室专家不断开发新的安全解决方案，为各种信息安全威胁以及网络和网络钓鱼
攻击提供全面的保护：
为了保护工作站免受已知的，未知的和高级的威胁，卡巴斯基实验室专家开发了卡巴斯
基终端安全。
为了保卫企业免受有针对性的攻击和高级威胁，卡巴斯基实验室专家创建了卡巴斯基反
目标攻击平台（KATA）。
有关卡巴斯基实验室企业安全解决方案的更多信息，请参阅：
http://www.kaspersky.com/enterprise-security
渗透测试
渗透测试是对计算机系统的模拟攻击，可以检测其中的安全漏洞。 渗透检测可以由第三方组
织进行，渗透测试的结果将被报告给安全小组。 然后，安全小组可以使用此信息来修复这些
漏洞。
获得专业知识
安全小组成员必须（通过学习）不断增加事件响应理论和实践的知识。
12
推荐的IR流程和规则
卡巴斯基实验室课程提供广泛的网络安全课程，从基础到专家的技术和评估。 所有这些都可
以在客户处所或当地或地区卡巴斯基实验室（如果适用）上课。 有关教育的更多信息，请参
阅http://www.kaspersky.com/enterprise-security/intelligence-services
了解信息安全领域的事件和趋势以及关于新兴的网络安全威胁的信息以及针对这些威胁的防
御措施至关重要。 例如，作为卡巴斯基威胁情报门户解决方案的一部分的APT报告服务可以
持续访问卡巴斯基实验室调查和高调网络间谍活动领域的发现。
收集应急响应信息
安全小组必须收集有关事件和事件响应过程的信息，并制定准备好的事件响应计划。 该信息
可以包括事件报告和有关组织内发生的事件历史的信息。
识别
本节为事件响应过程的识别阶段提供建议。
事件触发器
本节描述可能是信息事件触发器的事件(event)。
本节中描述的事件和事件触发器不构成与网络攻击相关的可疑行为的完整列表。
什么是事件触发器
事件触发是指潜在存在网络威胁的事件。 当生成事件触发器时，安全小组必须意识到可能正
在进行网络攻击。 事件触发器允许安全团队将信息事件与事件区(event)分开来。
关于事件源
事件可以来自多种来源。 这些来源可能是防APT系统，蜜罐，入侵防御系统和很多其他安全
控制。
基于本指南的目的，事件被认为来自单一类型的事件源 - SIEM系统和旨在管理企业网络中的
端点防病毒解决方案的系统。
由SIEM系统生成的事件触发器
SIEM系统可以从非常广泛的软件和硬件安全控制范围（包括代理服务器和防火墙）汇总信
息。
在由SIEM系统汇总的事件(event)中，由于将安全控制事件与威胁馈送匹配而产生的事件可以
被认为是事件触发器。 这种事件的存在表明，在安全控制产生的事件中检测到来自威胁情报
的入侵指标(IOC)。
13
推荐的IR流程和规则
为了本指南的目的，假设使用卡巴斯基实验室的数据馈送将事件与SIEM相匹配。 数据情报是
卡巴斯基威胁情报门户的一部分。
例如，组织网络中的计算机上的恶意软件尝试访问恶意URL。 与常规URL一样，组织的代理
服务器会生成带有恶意URL的事件，并将其发送到组织的SIEM系统。 然后SIEM系统尝试将
此URL与卡巴斯基实验室威胁资讯提供相匹配。 比赛成功，因为这是卡巴斯基实验室威胁资
讯提供中包含的恶意网址。 SIEM系统收到一个新的事件来表示此匹配。 这个新事件(event)
可以被认为是一个事件触发器。
由反病毒管理系统产生的事件触发
防病毒管理系统可以汇集来自端点防病毒解决方案保护的工作站的事件。