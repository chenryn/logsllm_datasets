time and playback bitrate, whose results are shown in Fig-
ure 22(b) and 22(c), respectively. Again, QCUT signiﬁcantly
outperforms CoDel on improving the video streaming QoE
when concurrent bulk upload is present.
 0 200 400 600 800 1000NoCoDel1525RTTF (ms)Target threshold (ms)Good signalFair signal 0 1 2 3 60 120 240 480 960 1920BetterUplink throughput(Mbps)RTTF (ms)CUBICVegasCoDelTSQQCut-B(5KB)QCut-B(20KB)QCut-D(20ms) 0 2 4 6 8 60 120 240 480BetterUplink throughput(Mbps)RTTF (ms)CUBICVegasCoDelTSQQCut-B(5KB)QCut-B(20KB)QCut-D(20ms) 1 10 100Weak SignalStrengthStrong SignalStrengthPage load time (s)No UploadUploadUpload + CoDelUpload + QCut 1 10Weak SignalStrengthStrong SignalStrengthInitial loading time (s)No UploadUploadUpload + CoDelUpload + QCut 0 0.5 1 1.5 2 2.5 3Weak SignalStrengthStrong SignalStrengthVideo bitrate (Mbps)No UploadUploadUpload + CoDelUpload + QCut315As described in §6.2, the effectiveness of QCUT is at-
tributed to two reasons. First, it reduces the ﬁrmware buffer
occupancy (TF ). But doing that alone is not sufﬁcient be-
cause delay sensitive trafﬁc can still be interfered by upload
trafﬁc at Qdisc. QCUT addresses this by performing priori-
tization at Qdisc, resulting in reduced TQ for delay sensitive
trafﬁc.
8. RELATED WORK
Measuring cellular performance. Several prior efforts
focus on characterizing cellular performance at various as-
pects. Studies [15, 39, 37, 31] collect data from deployed
user trials to understand smartphone performance at dif-
ferent layers. To name a few, Sommers et al.
leveraged
speedtest data to compare cellular versus Wi-Fi perfor-
mance for metro area mobile connections [40]. Huang et
al. examined LTE bandwidth utilization and its interaction
with TCP [20]. Shaﬁq et al. conducted a study of cellular
network performance during crowded events [38]. Liu et al.
measured performance of several TCP variants on 3G EvDO
networks [28]. Rosen et al.
studied the impact of RRC
state timers on network and application performance [35,
36]. Jia et al. performed a systematic characterization and
problem diagnosis of commercially deployed VoLTE (Voice
over LTE) [21]. None of the above studies deeply examined
cellular upload trafﬁc that is becoming increasingly popular.
Improving transport protocols. Over the past 30 years,
researchers have produced a large body work on improving
TCP. We already mentioned many TCP congestion control
algorithms in §6.1, such as [19, 29, 16, 13, 25, 23, 12, 24,
11, 17, 27]. Some recent proposals such as TCP-RRE [26],
Sprout [43], Verus [46] and TCP ex Machina [42] leverage
throughput forecasts or machine learning to ﬁnd the opti-
mal data transmission strategy. All these approaches face
the problem of balancing between throughput and latency,
which is a key factor to be considered when selecting the
desired CC given the application requirement. Other solu-
tions like RSFC [44] and DRWA [22] uses receive buffer
to limit the queuing impact. However, transport-layer solu-
tions do not provide cross-ﬂow control, which may not fully
eliminate interference between ﬂows. Compared to these
transport-layer solutions, QCUT uses accurate throughput
estimation based on the information from the ﬁrmware and
explicitly reduces on-device queuing in cellular networks.
Understanding excessive queuing delay (“buffer-
bloat”). The bufferbloat problem is known in both wired
and wireless networks. Gettys et al. presented an anecdo-
tal study [18] on large queuing delay of interactive trafﬁc.
The study focuses on the scenario of concurrent bulk data
transfers in cable and DSL networks. Using real network
traces, Allman argued that although bufferbloat can happen,
the problem happens more in residential than non-residential
networks and the magnitude of the problem is modest [10].
However, the issue is indeed severe in cellular networks that
usually employ deep buffers, as shown in a study conducted
by Jiang et al., who explored the bufferbloat problem of
downlink trafﬁc in 3G and LTE networks [22]. Recent work
by Xu et al. indicates that some newer smartphones seem to
buffer packets in the kernel when UDP packets are transmit-
ted continuously [45]. However, they did not study TCP or
consider how application is affected. In contrast, we carry
out comprehensive measurements to quantitatively under-
stand (i) on-device bufferbloat caused by TCP upload trafﬁc
and its impact on applications, (ii) the interaction between
upload and other trafﬁc patterns, (iii) the interplay between
TCP and lower layer queues, and (iv) the effectiveness of a
wide range of mitigation strategies at different layers.
Mitigating bufferbloat. Besides those evaluated in §7,
there exist other proposals for reducing excessive queuing
delay. Dynamic Receive Window Adjustment (DRWA) [22]
is a receiver-side solution to reduce the queuing delay by ad-
justing the TCP receive window. Originally it is deployed
on mobile devices to reduce the latency for downlink traf-
ﬁc. For the uplink case, DRWA needs to be deployed at
server side that serves both cellular and non-cellular clients,
thus posing deployment challenges. Byte Queue Limits
(BQL) [1] is another proposal that puts a cap on the amount
of data waiting in the device driver queue. It does not ap-
ply to Qdisc that contributes the majority of the on-device
latency. Moreover, BQL needs driver support.
9. CONCLUDING REMARKS
We carried out to our knowledge the ﬁrst comprehensive
investigation of cellular upload trafﬁc and its interaction with
concurrent trafﬁc. Our extensive measurement using 33-
month crowd-sourced data indicates the contribution of up-
load is large, and the upload speed is high enough to enable
applications to upload user-generated trafﬁc. We then com-
prehensively investigated the on-device bufferbloat problem
that incurs severe performance impact on applications. We
identiﬁed a major source of on-device bufferbloat to be the
large ﬁrmware buffer, on which existing bufferbloat mitiga-
tion solutions are ineffective. We then propose a general
and lightweight solution called QCUT, which controls the
ﬁrmware buffer occupancy from the OS kernel. We demon-
strate the effectiveness of QCUT through in-lab experiments
and real deployment.
Acknowledgements
We would like to thank our shepherd, Mark Allman,
and the anonymous reviewers for their valuable comments
and suggestions. We would also like to thank Shichang
Xu for his assistance in obtaining information from ra-
dio ﬁrmware. This research was supported in part by the
National Science Foundation under grants CNS-1059372,
CNS-1345226, CNS-1566331 and CNS-1629894.
10. REFERENCES
[1] Byte Queue Limit.
https://lwn.net/Articles/454390/.
[2] ExoPlayer. http://developer.android.com/guide/
topics/media/exoplayer.html.
[3] Introduction to LTE Advanced. http://www.
androidauthority.com/lte-advanced-176714/.
316[4] OPTICOM, PESQ - perceptual evaluation of speech quality.
http://www.opticom.de/technology/pesq.php.
[5] P.862: Perceptual evaluation of speech quality (PESQ).
https://www.itu.int/rec/T-REC-P.862-200102-I/en.
[6] Qualcomm eXtensible Diagnostic Monitor.
https://goo.gl/LODgRY.
[7] TCP Small Queues.
https://lwn.net/Articles/507065.
[8] tcp_probe. http://www.linuxfoundation.org/
collaborate/workgroups/networking/tcpprobe/.
[9] 3GPP TS 36.321: Medium Access Control (MAC) protocol
speciﬁcation (V10.3.0), 2011.
[10] M. Allman. Comments on bufferbloat. ACM SIGCOMM
CCR, 2012.
[11] A. Baiocchi, A. P. Castellani, and F. Vacirca. Yeah-tcp: yet
another highspeed tcp. In PFLDnet, 2007.
[12] L. S. Brakmo and L. L. Peterson. Tcp vegas: End to end
congestion avoidance on a global internet. Selected Areas in
Communications, IEEE Journal on, 13(8):1465–1480, 1995.
[13] C. Caini and R. Firrincieli. Tcp hybla: a tcp enhancement for
heterogeneous networks. International Journal of Satellite
Communications and Networking, 22(5):547–566, 2004.
[14] Q. A. Chen, H. Luo, S. Rosen, Z. M. Mao, K. Iyer, J. Hui,
K. Sontineni, , and K. Lau. QoE Doctor: Diagnosing Mobile
App QoE with Automated UI Control and Cross-layer
Analysis. In ACM IMC, 2014.
[15] H. Falaki, R. Mahajan, S. Kandula, D. Lymberopoulos, and
R. G. D. Estrin. Diversity in Smartphone Usage. In ACM
Mobisys, 2010.
[16] S. Floyd. Highspeed tcp for large congestion windows. RFC
3649, 2003.
[17] C. P. Fu and S. C. Liew. Tcp veno: Tcp enhancement for
transmission over wireless access networks. Selected Areas
in Communications, IEEE Journal on, 21(2):216–228, 2003.
[18] J. Gettys. Bufferbloat: Dark buffers in the internet. IEEE
Internet Computing, 15(3):96, 2011.
[19] S. Ha, I. Rhee, and L. Xu. Cubic: a new tcp-friendly
high-speed tcp variant. ACM SIGOPS Operating Systems
Review, 42(5):64–74, 2008.
[20] J. Huang, F. Qian, Y. Guo, Y. Zhou, Q. Xu, Z. M. Mao,
S. Sen, and O. Spatscheck. An in-depth study of LTE: effect
of network protocol and application behavior on
performance. In ACM SIGCOMM, 2013.
[21] Y. J. Jia, Q. A. Chen, Z. M. Mao, J. Hui, K. Sontineni,
A. Yoon, S. Kwong, and K. Lau. Performance
Characterization and Call Reliability Problem Diagnosis for
Voice over LTE. In ACM MobiCom, 2015.
[22] H. Jiang, Y. Wang, K. Lee, and I. Rhee. Tackling Bufferbloat
in 3G/4G Networks. In IMC, 2012.
[23] T. Kelly. Scalable tcp: Improving performance in highspeed
wide area networks. ACM SIGCOMM CCR, 2003.
[24] A. Kuzmanovic and E. W. Knightly. Tcp-lp: A distributed
algorithm for low priority data transfer. In IEEE INFOCOM,
2003.
[25] D. Leith and R. Shorten. H-tcp: Tcp for high-speed and
long-distance networks. In PFLDnet, 2004.
[26] W. K. Leong, Y. Xu, B. Leong, and Z. Wang. Mitigating
egregious ack delays in cellular data networks by eliminating
tcp ack clocking. In IEEE ICNP, 2013.
[27] S. Liu, T. Ba¸sar, and R. Srikant. Tcp-illinois: A loss-and
delay-based congestion control algorithm for high-speed
networks. Performance Evaluation, 65(6):417–440, 2008.
[28] X. Liu, A. Sridharan, S. Machiraju, M. Seshadri, and
H. Zang. Experiences in a 3G Network: Interplay between
the Wireless Channel and Applications. In ACM MobiCom,
2008.
[29] S. Mascolo, C. Casetti, M. Gerla, M. Y. Sanadidi, and
R. Wang. Tcp westwood: Bandwidth estimation for
enhanced transport over wireless links. In ACM MobiCom,
2001.
[30] K. Nichols and V. Jacobson. Controlling queue delay. ACM
Queue, 10(5), 2012.
[31] A. Nikravesh, Y. Guo, F. Qian, Z. M. Mao, and S. Sen. An
In-depth Understanding of Multipath TCP on Mobile
Devices: Measurement and System Design. In ACM
MobiCom, 2016.
[32] A. Nikravesh, D. K. Hong, Q. A. Chen, H. V. Madhyastha,
and Z. M. Mao. QoE Inference Without Application Control.
In ACM SIGCOMM Internet-QoE Workshop, 2016.
[33] A. Nikravesh, H. Yao, S. Xu, D. Choffnes, and Z. M. Mao.
Mobilyzer: An open platform for controllable mobile
network measurements. In ACM Mobisys, 2015.
[34] R. Pan, P. Natarajan, C. Piglione, M. Prabhu,
V. Subramanian, F. Baker, and B. VerSteeg. Pie: A
lightweight control scheme to address the bufferbloat
problem. In IEEE HPSR, 2013.
[35] S. Rosen, H. Luo, Q. A. Chen, Z. M. Mao, J. Hui, A. Drake,
and K. Lau. Discovering Fine-grained RRC State Dynamics
and Performance Impacts in Cellular Networks. In ACM
MobiCom, 2014.
[36] S. Rosen, H. Luo, Q. A. Chen, Z. M. Mao, J. Hui, A. Drake,
and K. Lau. Understanding RRC State Dynamics through
Client Measurements with Mobilyzer. In ACM MobiCom S3
Workshop, 2014.
[37] S. Rosen, A. Nikravesh, Y. Guo, Z. M. Mao, F. Qian, and
S. Sen. Revisiting Network Energy Efﬁciency of Mobile
Apps: Performance in the Wild. In ACM IMC, 2015.
[38] Z. Shaﬁq, L. Ji, A. Liu, J. Pang, S. Venkataraman, , and
J. Wang. A First Look at Cellular Network Performance
during Crowded Events. In ACM SIGMETRICS, 2013.
[39] C. Shepard, A. Rahmati, C. Tossell, L. Zhong, and
P. Kortum. LiveLab: Measuring Wireless Networks and
Smartphone Users in the Field. In HotMetrics, 2010.
[40] J. Sommers and P. Barford. Cell vs. WiFi: On the
Performance of Metro Area Mobile Connections. In IMC,
2012.
[41] S. Sundaresan, W. de Donato, N. Feamster, R. Teixeira,
S. Crawford, and A. Pescape. Broadband Internet
Performance: A View From the Gateway . In ACM
SIGCOMM, 2011.
[42] K. Winstein and H. Balakrishnan. TCP ex machina:
computer-generated congestion control. In ACM SIGCOMM,
2013.
[43] K. Winstein, A. Sivaraman, and H. Balakrishnan. Stochastic
forecasts achieve high throughput and low delay over cellular
networks. In USENIX NSDI, 2013.
[44] Y. Xu, W. K. Leong, B. Leong, and A. Razeen. Dynamic
regulation of mobile 3g/hspa uplink buffer with receiver-side
ﬂow control. In IEEE ICNP, 2012.
[45] Y. Xu, Z. Wang, W. K. Leong, and B. Leong. An end-to-end
measurement study of modern cellular data networks. In
PAM, 2014.
[46] Y. Zaki, T. Pötsch, J. Chen, L. Subramanian, and C. Görg.
Adaptive congestion control for unpredictable cellular
networks. In ACM SIGCOMM, 2015.
[47] L. Zhang, S. Shenker, and D. D. Clark. Observations on the
dynamics of a congestion control algorithm: The effects of
two-way trafﬁc. ACM SIGCOMM CCR, 1991.
317