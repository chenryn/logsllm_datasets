存储 安全
-
计算节点 计算节点 计算节点
PG 实例 PG 实例 PG 实例
分布式，共享块存储
1、存储块级别加密，防硬件窃取
多机房容灾
Geo-Replication -
异地C机房
A机房
POLARDB PG POLARDB PG
主节点
备节点
quorum based, 同步复制
2
至少两副本。
RPO=0
备节点
POLARDB PG
1
同城B机房
产品形态差异
POLARDB 开源版
成本 低 高
1、存储按量收费 1、存储预收费
2、只读节点只收计算资源的钱 2、只读节点需要复制数据，节点越多，价格越贵
计算节点弹性 好 较差
1、分钟级添加节点 1、取决于实例大小，TB级实例，数十小时
存储弹性 好 较差
1、近乎无限扩容，对业务无影响 1、扩容需要迁移数据，时间长，角色切换时影响业务
只读节点延迟 低 高
1、共享数据，延迟低 1、需要复制、增量回放。延迟高
备份 快 慢
1、秒级快照备份 1、取决于数据库大小，越大越慢，备份时可能影响性能
恢复 快 慢
1、快照克隆，秒级 1、取决于数据库大小，越大恢复越慢
可靠性 高 一般
1、多副本，parallel raft协议保证强一致 1、依靠STANDBY，异步模式有数据丢失可能性
可用性 高 一般
1、异常failover：由于共享数据，切换时不需要等待恢复，切 1、异常failover切换时，需要等待备库同步完成，激活，切
换时间非常短暂。 换。流程较长。
2、未来支持multi-writer模式，将做到zero downtime。
性能 高 较差
1、分布式块存储，RDMA网络，横向的能力扩展。 1、复杂SQL性能差。
2、支持存储级计算、压缩、filter下推。 2、存储依赖本地设备能力，扩展性较差。
3、计算节点支持mpp模型，加速复杂计算SQL
阿里云 产品生态
POLARDB
定位： 定位： 定位：
百万级QPS +小型OLAP 千万级QPS+中型OLAP 实时PB级OLAP分析
PolarDB HDB
MySQL PG
PG PG
全栈
ES
统 统 统
分布式，共享块存储
一 一 一
Graph 升 共
级 享 技
路 存 术
... ... 径 储 栈 OSS 海量对象存储 (打通所有产品)
全栈 定位：
Oacle兼容性+复杂场景(UDF+时空+搜+图+流,HTAP全栈)
Oracle PPAS
百万级QPS +小型OLAP
产品画像
POLARDB PG
时空、GIS、图像
OLTP、OLAP、
文本、时序、
创
SMP并行计算、
向量相似、图谱
新
GPU并行计算、
流计算、异构、
能
实时分析、 混合
机器学习、
力
多模
JIT、向量计算
多维计算、shard
负载
Oracle
企业级
商 稳定性
兼容
用 可靠性 社区版：orafce
能 可用性 阿里云版：PPAS
力 安全、弹性
云数据库优势
• 自动化备份
• 克隆实例
• 弹性扩容
• 内置同城双机HA
• 允许用户基于RDS搭建物理、逻辑备库
• 行业特性提炼、功能产品化
– varbitx
– oss_fdw (分级存储、冷暖分离、无限扩容)
– ali decode
• 无缝对接云平台其他产品
• 开源生态插件整合，BUG修复
– PostGIS, pgrouting, HLL, MADlib, zhparser, rum, PLpython, PLjava ... ...
云数据库优势
• 云生态，合作伙伴生态，用户生态
• 内核能力，持续交付能力
• ADAM，持续进化能力
• 开源生态
优势
RDS for PostgreSQL
• 性能
– 检查点几乎无抖动 - smooth化，
– 解决 drop 大量对象时的备库延迟(高德极端应用case)
– 高并发性能提升240倍
– GPU时空数据加速
– 备份效率提升5倍（协议级压缩）
– 大规格备份成功率100%（WAL与数据并行备份）
• 功能
– support release cache,
– varbitx,
– 无限容量 - oss_fdw 冷热数据分级存储,
– alidecode,
– cloud DBA
优势
RDS for PPAS
分级存储：
热数据(本地表)
PPAS
OSS 无限对象存储 暖数据(外部表)
优势
HybridDB for PostgreSQL
• 性能
– sortkey
• 单独使用可避免排序， 可结合metascan
– metascan
• 优于brin的地方: 实时更新、树结构搜索高效
– 向量化执行引擎
• 功能
– create extension;
– 标签类型 - roaring bitmap 4阶段化,
阿里云 生态开源
PostgreSQL
• 开源
– rds_dbsync
– gpdb extension
特性
PostgreSQL AP
• JIT(3~5x up)
• 向量计算(3~5x up)
• 单机
– parallel CPU加速(10x up)
– GPU 加速(10x up)
TPC-H
• 多机
200G
– POLARDB
39min
– citus 单机 ECS 测试
– pg shard
– ... ...
特性
PostgreSQL TP
PG vs 商用数据库 (1/12)
使用频率
Feature PG 商用数据库
SQL 标准 SQL:2011
窗口查询 支持
grouping sets 支持 M不支持
语法
CTE 支持
支持
递归调用 支持 M不支持
存储过程 支持
存储过程
支持 不支持
扩展语言
序列 支持
PG vs 商用数据库 (2/12)
Feature PG 商用数据库
nestloop join 支持
hash join 支持 M不支持
merge join 支持 M不支持
优化器
分组聚合 支持
哈希聚合 支持 M不支持
异构查询 支持
PG vs 商用数据库 (3/12)
Feature PG 商用数据库
继承表 支持 不支持
分区表 支持
外部表 支持 M不支持
服务端
check约束 支持 特性
排他约束 支持 不支持
online DDL 支持
dblink 支持
几何类型 支持 M不支持
PG vs 商用数据库 (4/12)
Feature PG 商用数据库
网络类型 支持 不支持
范围类型 支持 不支持
全文检索类型 支持 M不支持
数据类型
JSON类型 支持
数组类型 支持 不支持
树结构类型 支持 不支持
自定义类型 支持
自定义转换 支持
PG vs 商用数据库 (5/12)
Feature PG 商用数据库
b-tree索引 支持
hash索引 支持
gin索引 支持 不支持
索引
gist索引 支持 不支持
SP-GiST索引 支持 不支持
BRIN索引 支持 不支持
rum索引 支持 不支持
bloom索引 支持 不支持
PG vs 商用数据库 (6/12)
Feature PG 商用数据库
表达式索引 支持 不支持
多列复合索引 支持
多索引合并扫描 支持 不支持
索引
分区(条件)索引 支持 不支持
PG vs 商用数据库 (7/12)
Feature PG 商用数据库
PDB 支持
流式物理备库 支持
流式逻辑备库 支持
复制
逻辑订阅 支持 不支持
多副本强同步 支持
PITR 支持
一主多从 支持
级联从库 支持
多MASTER 支持
PG vs 商用数据库 (8/12)
Feature PG 商用数据库
外部表
支持 不支持
条件下推
同构外部表 支持 M不支持
外部
异构外部表 支持 不支持
数据融合
PG vs 商用数据库 (9/12)
Feature PG 商用数据库
ECPG 支持 M不支持
扩展类型 支持 M不支持
扩展操作符 支持 M不支持
扩展索引 支持 不支持 扩展
接口
扩展函数 支持 M不支持
扩展聚合 支持 不支持
扩展插件 支持 不支持
扩展函数、存储
过程语言
支持 不支持
python,java,v8,lu
a,...
PG vs 商用数据库 (10/12)
Feature PG 商用数据库
扩展订阅接口 支持 不支持
扩展FDW接口 支持 不支持
扩展采样接口 支持 不支持
扩展
扩展数据扫描接 接口
支持 不支持
口
扩展WAL接口 支持 不支持
钩子 支持 不支持
性能探针 支持 不支持
扩展存储接口 12+ 支持 不支持
PG vs 商用数据库 (11/12)
Feature PG 商用数据库
2D空间数据 支持
3D，4D空间数据 支持 不支持
拓扑数据 支持 不支持
业务
栅格数据 支持 不支持 特性
空间搜索 支持 M不支持
实时全文检索 支持 不支持
实时模糊查询 支持 不支持
实时ADHoC查询 支持 不支持
关系图式搜索 支持 M不支持
PG vs 商用数据库 (12/12)
Feature PG 商用数据库
实时流计算 支持 不支持
时序数据插件 支持 不支持
估值计算 支持 不支持
业务
实时相似查询 支持 不支持 特性
HDB PG vs. AWS Redshift (1/3)
Feature HybridDB for PostgreSQL AWS Redshift
SQL base PostgreSQL 8.3 & Greenplum 4.3 PostgreSQL 8.0
Oracle Compatibility 20+ functions No
Spatial data types and functions Yes No
Do not for local table
Table Partitioning Yes
Just support at external table
Hybrid, Column, and Row Orientation Yes No
Vacuum/Analyze Allow multi processors Just one processor
Indexes Yes No
Machine Learning Yes (MADlib) No (reload to other product)
HDB PG vs. AWS Redshift (2/3)
Data Type HybridDB for PostgreSQL AWS Redshift
11 General Data types:
SMALLINT, INTEGER, BIGINT, DECIMAL,
REAL, DOUBLE PRECISION, BOOLEAN, CHAR, Yes Yes
VARCHAR, DATE, TIMESTAMP,
TIMESTAMPTZ
Spatial GIS (box, circle, lseg, path, point,
Yes No
polygon)
Network IPv4 / IPv6 (cidr, inet, macaddr) Yes No
JSON Yes No
uuid Yes No
xml Yes No
HDB PG vs. AWS Redshift (3/3)
HybridDB for PostgreSQL AWS Redshift
Massively parallel processing (MPP) MPP MPP
Data compression Yes Yes
Query optimizer Yes Yes
Compiled code JDBC / ODBC / libq JDBC / ODBC / libq
Row-oriented table Yes No
Column-oriented table Yes Yes
External table Yes Yes
User-Defined Functions PL/pgsql, PL/Java No
目录
• 产品介绍
• 生态介绍
• 应用案例
• 开发、管理实践
• 数据库原理
• 参考文档