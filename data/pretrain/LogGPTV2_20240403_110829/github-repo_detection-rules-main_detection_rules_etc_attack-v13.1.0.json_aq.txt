{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of AD design features. For example, mitigating specific AD API calls will likely have unintended side effects, such as preventing DC replication from operating properly. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identification of subsequent malicious behavior.", "external_references": [{"external_id": "T1207", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1207"}], "id": "course-of-", "modified": "2019-07-24T14:23:59.683Z", "name": "DCShadow Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Limit privileges of user accounts and remediate Privilege Escalation vectors so only  authorized administrators can create new services.\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to create services by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1050", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1050"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2020-01-17T16:45:23.647Z", "name": "New Service Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Disable Autorun if it is unnecessary. (Citation: Microsoft Disable Autorun) Disallow or restrict removable media at an organizational policy level if they are not required for business operations. (Citation: TechNet Removable Media Control)", "external_references": [{"external_id": "T1092", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1092"}, {"description": "Microsoft. (n.d.). How to disable the Autorun functionality in Windows. Retrieved April 20, 2016.", "source_name": "Microsoft Disable Autorun", "url": "https://support.microsoft.com/en-us/kb/967715"}, {"description": "Microsoft. (2007, August 31). https://technet.microsoft.com/en-us/library/cc771759(v=ws.10).aspx. Retrieved April 20, 2016.", "source_name": "TechNet Removable Media Control", "url": "https://technet.microsoft.com/en-us/library/cc772540(v=ws.10).aspx"}], "id": "course-of-", "modified": "2019-07-24T18:09:33.072Z", "name": "Communication Through Removable Media Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Clean up SID-History attributes after legitimate account migration is complete.\n\nConsider applying SID Filtering to interforest trusts, such as forest trusts and external trusts, to exclude SID-History from requests to access domain resources. SID Filtering ensures that any authentication requests over a trust only contain SIDs of security principals from the trusted domain (i.e. preventing the trusted domain from claiming a user has membership in groups outside of the domain).\n\nSID Filtering of forest trusts is enabled by default, but may have been disabled in some cases to allow a child domain to transitively access forest trusts. SID Filtering of external trusts is automatically enabled on all created external trusts using Server 2003 or later domain controllers. (Citation: Microsoft Trust Considerations Nov 2014) (Citation: Microsoft SID Filtering Quarantining Jan 2009) However note that SID Filtering is not automatically applied to legacy trusts or may have been deliberately disabled to allow inter-domain access to resources.\n\nSID Filtering can be applied by: (Citation: Microsoft Netdom Trust Sept 2012)\n\n* Disabling SIDHistory on forest trusts using the netdom tool (netdom trust  /domain: /EnableSIDHistory:no on the domain controller). \n* Applying SID Filter Quarantining to external trusts using the netdom tool (netdom trust  /domain: /quarantine:yes on the domain controller)\nApplying SID Filtering to domain trusts within a single forest is not recommended as it is an unsupported configuration and can cause breaking changes. (Citation: Microsoft Netdom Trust Sept 2012) (Citation: AdSecurity Kerberos GT Aug 2015) If a domain within a forest is untrustworthy then it should not be a member of the forest. In this situation it is necessary to first split the trusted and untrusted domains into separate forests where SID Filtering can be applied to an interforest trust.", "external_references": [{"external_id": "T1178", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1178"}, {"description": "Microsoft. (2014, November 19). Security Considerations for Trusts. Retrieved November 30, 2017.", "source_name": "Microsoft Trust Considerations Nov 2014", "url": "https://technet.microsoft.com/library/cc755321.aspx"}, {"description": "Microsoft. (n.d.). Configuring SID Filter Quarantining on External Trusts. Retrieved November 30, 2017.", "source_name": "Microsoft SID Filtering Quarantining Jan 2009", "url": "https://technet.microsoft.com/library/cc794757.aspx"}, {"description": "Microsoft. (2012, September 11). Command-Line Reference - Netdom Trust. Retrieved November 30, 2017.", "source_name": "Microsoft Netdom Trust Sept 2012", "url": "https://technet.microsoft.com/library/cc835085.aspx"}, {"description": "Metcalf, S. (2015, August 7). Kerberos Golden Tickets are Now More Golden. Retrieved December 1, 2017.", "source_name": "AdSecurity Kerberos GT Aug 2015", "url": "https://adsecurity.org/?p=1640"}], "id": "course-of-", "modified": "2019-07-25T11:37:35.427Z", "name": "SID-History Injection Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-06-11T17:06:56.230Z", "created_by_ref": "", "description": "Restrict execution of code to a virtual environment on or in transit to an endpoint system.", "external_references": [{"external_id": "M1048", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1048"}], "id": "course-of-", "modified": "2020-03-31T13:08:03.851Z", "name": "Application Isolation and Sandboxing", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.1"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "external_references": [{"external_id": "T1030", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1030"}, {"description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "source_name": "University of Birmingham C2", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "id": "course-of-", "modified": "2019-07-24T19:05:56.488Z", "name": "Data Transfer Size Limits Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2019-04-22T13:54:51.385Z", "created_by_ref": "", "description": "Consider technical controls to prevent the disabling of services or deletion of files involved in system recovery. \n\nConsider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data.(Citation: Ready.gov IT DRP) Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery.\n\nIdentify potentially malicious software and audit and/or block it by using whitelisting(Citation: Beechey 2010) tools, like AppLocker,(Citation: Windows Commands JPCERT)(Citation: NSA MS AppLocker) or Software Restriction Policies(Citation: Corio 2008) where appropriate.(Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1490", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1490"}, {"description": "Ready.gov. (n.d.). IT Disaster Recovery Plan. Retrieved March 15, 2019.", "source_name": "Ready.gov IT DRP", "url": "https://www.ready.gov/business/implementation/IT"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2020-01-17T16:45:23.917Z", "name": "Inhibit System Recovery Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Ensure that externally facing Web servers are patched regularly to prevent adversary access through [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068) to gain remote code access or through file inclusion weaknesses that may allow adversaries to upload files or scripts that are automatically served as Web pages. \n\nAudit account and group permissions to ensure that accounts used to manage servers do not overlap with accounts and permissions of users in the internal network that could be acquired through Credential Access and used to log into the Web server and plant a Web shell or pivot from the Web server into the internal network. (Citation: US-CERT Alert TA15-314A Web Shells)", "external_references": [{"external_id": "T1100", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1100"}, {"description": "US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.", "source_name": "US-CERT Alert TA15-314A Web Shells", "url": "https://www.us-cert.gov/ncas/alerts/TA15-314A"}], "id": "course-of-", "modified": "2019-07-25T12:34:23.847Z", "name": "Web Shell Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Monitor systems and domain logs for unusual credential logon activity. Prevent access to [Valid Accounts](https://attack.mitre.org/techniques/T1078). Apply patch KB2871997 to Windows 7 and higher systems to limit the default access of accounts in the local administrator group. \n\nEnable pass the hash mitigations to apply UAC restrictions to local accounts on network logon. The associated Registry key is located HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy Through GPO: Computer Configuration > [Policies] > Administrative Templates > SCM: Pass the Hash Mitigations: Apply UAC restrictions to local accounts on network logons. (Citation: GitHub IAD Secure Host Baseline UAC Filtering)\n\nLimit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems. Ensure that built-in and created local administrator accounts have complex, unique passwords. Do not allow a domain user to be in the local administrator group on multiple systems.", "external_references": [{"external_id": "T1075", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1075"}, {"description": "NSA IAD. (2017, January 24). MS Security Guide. Retrieved December 18, 2017.", "source_name": "GitHub IAD Secure Host Baseline UAC Filtering", "url": "https://github.com/iadgov/Secure-Host-Baseline/blob/master/Windows/Group%20Policy%20Templates/en-US/SecGuide.adml"}], "id": "course-of-", "modified": "2019-07-25T11:21:20.411Z", "name": "Pass the Hash Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about local security software, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1063", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1063"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2021-08-23T20:25:18.624Z", "name": "Security Software Discovery Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "Remove users from the local administrator group on systems. Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038). \n\nCheck for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate. (Citation: Github UACMe)", "external_references": [{"external_id": "T1088", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1088"}, {"description": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.", "source_name": "Github UACMe", "url": "https://github.com/hfiref0x/UACME"}], "id": "course-of-", "modified": "2019-07-24T14:13:23.637Z", "name": "Bypass User Account Control Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}
{"created": "2018-10-17T00:14:20.652Z", "created_by_ref": "", "description": "To use this technique remotely, an adversary must use it in conjunction with RDP. Ensure that Network Level Authentication is enabled to force the remote desktop session to authenticate before the session is created and the login screen displayed. It is enabled by default on Windows Vista and later. (Citation: TechNet RDP NLA)\n\nIf possible, use a Remote Desktop Gateway to manage connections and security configuration of RDP within a network. (Citation: TechNet RDP Gateway)\n\nIdentify and block potentially malicious software that may be executed by an adversary with this technique by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "external_references": [{"external_id": "T1015", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1015"}, {"description": "Microsoft. (n.d.). Configure Network Level Authentication for Remote Desktop Services Connections. Retrieved June 6, 2016.", "source_name": "TechNet RDP NLA", "url": "https://technet.microsoft.com/en-us/library/cc732713.aspx"}, {"description": "Microsoft. (n.d.). Overview of Remote Desktop Gateway. Retrieved June 6, 2016.", "source_name": "TechNet RDP Gateway", "url": "https://technet.microsoft.com/en-us/library/cc731150.aspx"}, {"description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "source_name": "Beechey 2010", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "source_name": "Windows Commands JPCERT", "url": "https://blogs.jpcert.or.jp/en/2016/01/windows-commands-abused-by-attackers.html"}, {"description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "source_name": "NSA MS AppLocker", "url": "https://apps.nsa.gov/iaarchive/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "source_name": "Corio 2008", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "source_name": "TechNet Applocker vs SRP", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "id": "course-of-", "modified": "2021-08-23T20:25:19.735Z", "name": "Accessibility Features Mitigation", "object_marking_refs": ["marking-"], "type": "course-of-action", "x_mitre_deprecated": true, "x_mitre_domains": ["enterprise-attack"], "x_mitre_modified_by_ref": "", "x_mitre_version": "1.0"}