                                                       ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:37:28: error: unknown type name 'cudaStream_t'
    __host__ __device__ inline cudaStream_t default_stream()
                               ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:39:10: error: use of undeclared identifier 'cudaStreamLegacy'
      return cudaStreamLegacy;
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:43:1: error: unknown type name 'cudaStream_t'
    cudaStream_t __host__ __device__ 
    ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:50:1: error: unknown type name 'cudaError_t'
    cudaError_t THRUST_RUNTIME_FUNCTION
    ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:53:3: error: use of undeclared identifier 'cudaDeviceSynchronize'; did you mean 'hipDeviceSynchronize'?
      cudaDeviceSynchronize();
      ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:334:12: note: 'hipDeviceSynchronize' declared here
    hipError_t hipDeviceSynchronize(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:54:10: error: use of undeclared identifier 'cudaGetLastError'; did you mean 'hipGetLastError'?
      return cudaGetLastError();
             ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:592:12: note: 'hipGetLastError' declared here
    hipError_t hipGetLastError(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:62:3: error: unknown type name 'cudaStream_t'
      cudaStream_t stream;
      ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:66:26: error: unknown type name 'cudaStream_t'
      execute_on_stream_base(cudaStream_t stream_ = default_stream())
                             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:71:10: error: unknown type name 'cudaStream_t'
          on(cudaStream_t const &s) const
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:79:10: error: unknown type name 'cudaStream_t'
      friend cudaStream_t __host__ __device__
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:85:10: error: unknown type name 'cudaError_t'
      friend cudaError_t THRUST_RUNTIME_FUNCTION
             ^
    [ 45%] Building HIPCC object caffe2/CMakeFiles/torch.dir/__/aten/src/THH/torch_generated_THHTensorMath.hip.o
    /opt/rocm/include/thrust/system/cuda/detail/par.h:96:12: error: use of undeclared identifier 'cudaGetLastError'; did you mean 'hipGetLastError'?
        return cudaGetLastError();
               ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:592:12: note: 'hipGetLastError' declared here
    hipError_t hipGetLastError(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:107:21: error: unknown type name 'cudaStream_t'
      execute_on_stream(cudaStream_t stream) : base_t(stream){};
                        ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:105:25: error: type 'thrust::cuda_cub::execute_on_stream::base_t' (aka 'execute_on_stream_base') is not a direct or virtual base of 'thrust::cuda_cub::execute_on_stream'
      execute_on_stream() : base_t(){};
                            ^~~~~~
    /opt/rocm/include/thrust/system/cuda/detail/par.h:138:6: error: unknown type name 'cudaStream_t'
      on(cudaStream_t const &stream) const
         ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:39:
    In file included from /opt/rocm/include/thrust/system/cuda/detail/copy.h:99:
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:60:5: error: unknown type name 'cudaError'
        cudaError status;
        ^
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:61:14: error: no member named 'trivial_copy_to_device' in namespace 'thrust::cuda_cub'; did you mean 'hip_rocprim::trivial_copy_from_device'?
        status = cuda_cub::trivial_copy_to_device(dst,
                 ^~~~~~~~~~
    /opt/rocm/include/thrust/system/hip/detail/util.h:62:1: note: 'hip_rocprim::trivial_copy_from_device' declared here
    trivial_copy_from_device(Type* dst, Type const* src, size_t count, hipStream_t stream)
    ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:39:
    In file included from /opt/rocm/include/thrust/system/cuda/detail/copy.h:99:
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:64:47: error: no member named 'stream' in namespace 'thrust::cuda_cub'; did you mean 'hip_rocprim::stream'?
                                                  cuda_cub::stream(device_s));
                                                  ^~~~~~~~~~
    /opt/rocm/include/thrust/system/hip/detail/util.h:55:33: note: 'hip_rocprim::stream' declared here
    __host__ __device__ hipStream_t stream(execution_policy& policy)
                                    ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHStorage.hip:7:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:39:
    In file included from /opt/rocm/include/thrust/system/cuda/detail/copy.h:99:
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:65:5: error: no member named 'throw_on_error' in namespace 'thrust::cuda_cub'; did you mean 'hip_rocprim::throw_on_error'?
        cuda_cub::throw_on_error(status, "__copy::trivial_device_copy H->D: failed");
        ^~~~~~~~~~
    /opt/rocm/include/thrust/system/hip/detail/util.h:113:33: note: 'hip_rocprim::throw_on_error' declared here
    static void __host__ __device__ throw_on_error(hipError_t status, char const* msg)
                                    ^
    Skipped writing torch/csrc/jit/generated/register_aten_ops_0.cpp
    Skipped writing torch/csrc/jit/generated/register_aten_ops_1.cpp
    fatal error: too many errors emitted, stopping now [-ferror-limit=]
    Skipped writing torch/csrc/jit/generated/register_aten_ops_2.cpp
    20 errors generated.
    CMake Error at torch_generated_THHStorage.hip.o.cmake:174 (message):
      Error generating file
      /home/luke/Builds/pytorch/build/caffe2/CMakeFiles/torch.dir/__/aten/src/THH/./torch_generated_THHStorage.hip.o
    make[2]: *** [caffe2/CMakeFiles/torch.dir/build.make:86: caffe2/CMakeFiles/torch.dir/__/aten/src/THH/torch_generated_THHStorage.hip.o] Error 1
    make[2]: *** Waiting for unfinished jobs....
    1 warning generated.
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:37:28: error: unknown type name 'cudaStream_t'
    __host__ __device__ inline cudaStream_t default_stream()
                               ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:39:10: error: use of undeclared identifier 'cudaStreamLegacy'
      return cudaStreamLegacy;
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:43:1: error: unknown type name 'cudaStream_t'
    cudaStream_t __host__ __device__ 
    ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:50:1: error: unknown type name 'cudaError_t'
    cudaError_t THRUST_RUNTIME_FUNCTION
    ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:53:3: error: use of undeclared identifier 'cudaDeviceSynchronize'; did you mean 'hipDeviceSynchronize'?
      cudaDeviceSynchronize();
      ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:334:12: note: 'hipDeviceSynchronize' declared here
    hipError_t hipDeviceSynchronize(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:54:10: error: use of undeclared identifier 'cudaGetLastError'; did you mean 'hipGetLastError'?
      return cudaGetLastError();
             ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:592:12: note: 'hipGetLastError' declared here
    hipError_t hipGetLastError(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:62:3: error: unknown type name 'cudaStream_t'
      cudaStream_t stream;
      ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:66:26: error: unknown type name 'cudaStream_t'
      execute_on_stream_base(cudaStream_t stream_ = default_stream())
                             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:71:10: error: unknown type name 'cudaStream_t'
          on(cudaStream_t const &s) const
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:79:10: error: unknown type name 'cudaStream_t'
      friend cudaStream_t __host__ __device__
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:85:10: error: unknown type name 'cudaError_t'
      friend cudaError_t THRUST_RUNTIME_FUNCTION
             ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:96:12: error: use of undeclared identifier 'cudaGetLastError'; did you mean 'hipGetLastError'?
        return cudaGetLastError();
               ^
    /opt/rocm/hip/include/hip/hcc_detail/hip_runtime_api.h:592:12: note: 'hipGetLastError' declared here
    hipError_t hipGetLastError(void);
               ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:34:
    /opt/rocm/include/thrust/system/cuda/detail/par.h:107:21: error: unknown type name 'cudaStream_t'
      execute_on_stream(cudaStream_t stream) : base_t(stream){};
                        ^
    /opt/rocm/include/thrust/system/cuda/detail/par.h:105:25: error: type 'thrust::cuda_cub::execute_on_stream::base_t' (aka 'execute_on_stream_base') is not a direct or virtual base of 'thrust::cuda_cub::execute_on_stream'
      execute_on_stream() : base_t(){};
                            ^~~~~~
    /opt/rocm/include/thrust/system/cuda/detail/par.h:138:6: error: unknown type name 'cudaStream_t'
      on(cudaStream_t const &stream) const
         ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:39:
    In file included from /opt/rocm/include/thrust/system/cuda/detail/copy.h:99:
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:60:5: error: unknown type name 'cudaError'
        cudaError status;
        ^
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:61:14: error: no member named 'trivial_copy_to_device' in namespace 'thrust::cuda_cub'; did you mean 'hip_rocprim::trivial_copy_from_device'?
        status = cuda_cub::trivial_copy_to_device(dst,
                 ^~~~~~~~~~
    /opt/rocm/include/thrust/system/hip/detail/util.h:62:1: note: 'hip_rocprim::trivial_copy_from_device' declared here
    trivial_copy_from_device(Type* dst, Type const* src, size_t count, hipStream_t stream)
    ^
    In file included from /home/luke/Builds/pytorch/aten/src/THH/THHTensorMath.hip:21:
    In file included from /opt/rocm/include/thrust/system/cuda/execution_policy.h:39:
    In file included from /opt/rocm/include/thrust/system/cuda/detail/copy.h:99:
    /opt/rocm/include/thrust/system/cuda/detail/internal/copy_cross_system.h:64:47: error: no member named 'stream' in namespace 'thrust::cuda_cub'; did you mean 'hip_rocprim::stream'?
                                                  cuda_cub::stream(device_s));
                                                  ^~~~~~~~~~