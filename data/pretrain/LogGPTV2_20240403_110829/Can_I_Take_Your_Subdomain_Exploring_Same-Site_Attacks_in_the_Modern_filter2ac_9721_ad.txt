plex and heterogeneous public-facing IT infrastructures that
translate into a high number of subdomains. By restricting
the analysis to the .edu TLD, we observed 1,229 domains
having on average 6,033 subdomains each. The percentage
of domains with at least one vulnerable subdomain is 7.32%,
which is substantially higher than any other TLD considered.
For comparison, the percentage in .com is 1.81%.
Overall, we identiﬁed vulnerabilities affecting top do-
mains across all categories. To exemplify, we found sub-
domain takeover vulnerabilities on news websites like
cnn.com and time.com, university portals like harvard.edu
and mit.edu, governmental websites
like europa.eu
and nih.gov, and IT companies like lenovo.com and
cisco.com. Although most of the discovered issues could be
easily ﬁxed by routinely checking the validity of DNS records,
our large-scale vulnerability assessment raises concerns due
to the number and pervasiveness of the identiﬁed threats.
5.1.2 Analysis of Third-Party Services
We examined 26 service and hosting providers and 5 dynamic
DNS services for a total of 31 third-party services. Our se-
lection comprises services mentioned in previous work [33]
and community efforts [22], excluding those that required
payment to carry out our analysis.
The results are summarized in Table 4. We combined man-
ual testing and review of the documentation to assess the
capabilities available to a registered user of each service. We
also evaluated the considered services against the security pit-
falls described in §3.2.1: (i) wildcard, the domain ownership
veriﬁcation allows attackers to claim subdomains of an al-
ready mapped domain, e.g., due to the presence of a wildcard
DNS entry; (ii) redirect, if the www subdomain of a mapped
domain automatically redirects to the parent domain, e.g.,
www.shop.example.com redirects to shop.example.com,
whether the former can be claimed by a different account;
(iii) PSL, if the service allows users to create a website un-
der a speciﬁc subdomain, whether the parent domain of the
assigned website is included in the PSL.
Table 3 shows the distribution of the vulnerable subdo-
mains across service providers. The majority of the vulnerable
subdomains (93%) are hosted on the ﬁrst four most used ser-
vices: WordPress, Shopify, Tumblr, and GitHub Pages. These
prominent services give users the ability to host a website with
a valid TLS certiﬁcate for the associated domain. Users are
allowed to customize the markup and JavaScript code of the
pages, and for Tumblr and GitHub Pages, users are allowed
to upload arbitrary ﬁles to their websites. In general, the ca-
pabilities obtained by an attacker controlling a service vary
depending on the speciﬁc platform, ranging from content
only (UptimeRobot) to full host control (ngrok). We found
that 19 out of 26 services grant the js and https capabilities,
while 21 provide the js capability alone. The file capability
is the most uncommon, being available for 4 services only.
Surprisingly, we discovered that in 20 out of the 31 ana-
lyzed services, any registered user controls a website that is
in a related-domain position to all the other websites hosted
on the platform. Tumblr and WordPress, along with 11 addi-
tional services, even share their primary domain with user-
controlled websites, e.g., attacker.tumblr.com is related
to tumblr.com. Only GitHub and ngrok prevent this threat
by including the apex domains assigned to their users in the
PSL.
Lastly, we found that 17 services have issues with the own-
ership veriﬁcation mechanism. Among the four most used
services, only WordPress prevents attackers from claiming
USENIX Association
30th USENIX Security Symposium    2927
Table 3: Breakdown of the results in terms of affected domains/sites.
Web mechanisms exploitable exclusively by related-domain attackers
CSP
Domains
CORS
Relaxation
Domains
Attack Vector
Expired Domains
Discontinued Services
(cid:30) WordPress
(cid:30) Shopify
(cid:30) Tumblr
(cid:30) GitHub
(cid:30) Webﬂow
(cid:30) Ngrok
(cid:30) Helpscout
(cid:30) Others
Total
Takeover
Domains
Sites
Cookies
Domains
260
1,260
466
326
310
42
24
22
18
52
1,520
201
699
320
254
24
25
20
13
17
37
887
5,394/5,394
18,798/19,020
13,803/13,803
2,638/2,638
404/404
899/899
601/601
250/250
425/425
464/724
23,178/23,400
Sites
195/195
662/674
312/312
244/244
23/23
24/24
18/18
13/13
16/16
22/35
845/857
35/141
104/294
43/168
32/66
1/2
22/49
0/0
7/9
1/4
1/7
139/428
Sites
13/28
32/75
23/52
5/12
1/2
1/5
0/0
2/2
1/3
1/3
45/100
Domains
35/317
196/1,980
164/1,221
26/459
5/29
2/116
2/122
0/17
0/28
0/25
224/2,254
Sites
16/107
37/392
21/186
11/153
2/12
2/18
2/14
0/5
0/6
0/8
51/488
Sites
6/8
24/55
14/28
5/15
1/2
2/3
1/3
1/3
0/2
2/3
29/61
9/11
49/88
30/49
7/19
1/2
2/3
1/3
8/11
0/2
9/10
57/97
Note: Deployment of CSP only considers policies that are not trivially exploitable by a web attacker (§4.3.2) and whitelist one or more related domains. CORS policies
are only exposed to requests coming from whitelisted origins [18]: for the deployment we report the count of domains/sites vulnerable either to web attackers or related-domain
attackers that were discovered during dynamic testing. postMessage is omitted since related-domain attackers have no gain compared to web attackers.
(a) # Subdomains
(b) Tranco Rank
(c) Categories
Figure 3: Characterization of vulnerable domains.
subdomains of an already mapped domain. Moreover, 8 ser-
vice providers perform an automatic redirection from the www
subdomain to the parent domain. Therefore, users of these
services might erroneously assume that the www subdomain is
implicitly bound to their account and cannot be claimed by
others. Only Shopify and Launchrock do not prevent this sub-
domain from being mapped to different accounts. We reported
to GitHub and Shopify, two of the major service providers,
the vulnerabilities discovered on the domain ownership veriﬁ-
cation process. GitHub acknowledged the problem and told
us that they “[...] are exploring various changes to the cus-
tom domain ﬂow that will improve this situation by requiring
formal domain ownership veriﬁcation”. Shopify awarded us
$1,000 for the report and shipped a ﬁx on April 12, 2021.
Dynamic DNS Services. The adoption of the PSL across
different dynamic DNS providers is shown in Table 5, together
with the number of domains that a user can choose from. We
observed that only 2 providers listed all their domains in
the PSL. Noip and DynDNS left out a small number of the
domains they offer, but it is not clear to us whether this is
due to negligence or if this is a deliberate choice. Instead,
FreeDNS, with more than 50k domains, did not include any
of them in the list, leaving their massive user base at risk.
We reported this major ﬂaw to the FreeDNS maintainer, who
acknowledged it but took no action, as it would be impossible
to maintain an updated list of thousands of domains in the
PSL, given the lack of an API to manage PSL entries.
5.2 Web Threats
We now turn the attention to the web application security
implications of our analysis, as summarized in Tables 3 and
further detailed in Table 6.
We start by discussing conﬁdentiality and integrity of ses-
sion cookies. Overall, our crawler collected 85,169 cookies,
out of which 24,924 have been labeled as session cookies by
our heuristic. Among these, we identify 3,390 (14%) cookies
from 5,051 (33%) domains on 687 sites (81%) whose conﬁ-
dentiality can be violated by a related-domain attacker. This
shows that related-domain attackers can often get access to
session cookies, which may enable attacks like session hijack-
ing. Our analysis also shows that the state of cookie integrity
is even worse: in particular, we identify 24,689 (99%) ses-
sion cookies from 14,964 (99%) domains on 834 (99%) sites
2928    30th USENIX Security Symposium
USENIX Association
12481632641282565121024204840968192163843276865536131072Number of Subdomains0246810121416% Vulnerable0102030405060% Potentially Vulnerable2000400060008000100001200014000160001800020000220002400026000280003000032000340003600038000400004200044000460004800050000Tranco Rank012345% Vulnerable01020304050% Potentially VulnerableDynamic DNS (49)Education (4335)Shopping (3244)Healt (2218)Travel (1408)News (6896)Entertainment (4045)Government (3858)Business (9377)Food (939)Technology (6357)File Sharing (1604)Web Hosting (446)Adult (1632)Other (1380)Malicious (855)Social (1344)012345678% Vulnerable0510152025303540% Potentially VulnerableTable 4: Attackers’ capabilities on vulnerable services.
Table 6: Web security abuses by related-domain attackers (RDA).
Service
Wildcard
Redirect (www)
PSL
Capabilities
Mechanism
s all
e
i
k
o
o
C
P
S
C
session
script inclusion
style inclusion
object inclusion
frame inclusion
framing control
with credentials
S all
R
O
C
postMessage
Domain Relaxation
Deployed
Domains
Sites
23,400
15,179
1,144
961
1,027
967
1,676
-
-
14,045
97
857
846
260
232
250
229
360
-
-
823
61
Exploitable by RDA
Sites
Domains
C
I
C
I
15,025
23,178
5,051
14,964
901 (0)
930 (0)
598 (+12)
664 (+45)
344 (+97)
2,254 (+224)
179 (+63)
14 (0)
57
826
845
687
834
212 (0)
225 (0)
123 (+5)
152 (+12)
59 (+21)
488 (+51)
71 (+27)
11 (0)
29
V
V
V
V
V
V
V
V
¸
V
?
V