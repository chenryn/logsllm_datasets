raw alerts
verification without aggregation
verification with aggregation
4. Related Work
60
50
40
30
20
10
0
120
100
80
60
40
20
0
)
%
(
e
t
a
R
n
o
i
t
c
e
t
e
D
)
%
(
e
t
a
r
t
r
e
l
a
e
s
l
a
F
0
20
40
60
80
100
120
Threshold (0.01)
raw alerts
verification without aggregation
verification with aggregation
0
20
40
60
80
100
120
Threshold (0.01)
Figure 7. Detection rate and false alert rate
o
i
t
a
R
e
c
n
e
d
i
f
n
o
C
30
25
20
15
10
5
0
27.778
Before reasoning
After reasoning
22.222
24.51
19.833
14
1.807
1.807
1.508
1.807
1.807
Scenario 0
Scenario 1
Scenario 2
Scenario 3
Scenario 4
Figure 8. Conﬁdence ratio changes
Figure 8 shows the conﬁdence ratios in all ﬁve attack
scenarios before and after using the proposed techniques.
(We have discussed one scenario in the previous subsec-
tion; details of the other scenarios can be found in the full
paper [31].) These results indicate that with the proposed
techniques, the average conﬁdence in alerts of successful at-
tacks are greatly increased compared with the average con-
ﬁdence in the other alerts (false alerts and alerts for failed
attack attempts). In fact, the average conﬁdence in the other
alerts either remain the same or decrease.
Scenario
Accuracy
0
1
2
75% 100% 50% 100% 50%
3
4
Table 1. Accuracy of hypotheses
We made ten hypotheses during the analysis of the ﬁve
attack scenarios. Table 1 shows the accuracy of these hy-
potheses. In the experiments, six out of the ten hypothe-
sized attacks are actual successful attacks missed by Snort,
and one out of the other 4 hypotheses is a failed attack at-
tempt. Among the seven real attacks, we have deﬁnite conﬁ-
dence that four of them must have happened from the alert-
The techniques closest to ours are M2D2 [20] and the
mission-impact-based correlation method [23], which have
been brieﬂy discussed in the introduction. However, M2D2
is intended to provide a formal model to represent intru-
sion related information, while the mission-impact-based
method requires human experts to specify the correlation
models. In contrast, our method can automatically construct
Bayesian networks of IDS alerts and other complementary
evidence based on the knowledge of individual attacks.
Another approach was proposed in [22] to hypothesize
about missed attacks based on the pre/post-conditions of
known attacks. Our approach differs in that the hypothe-
ses made in our model is based on not only the pre/post-
conditions of known attacks but also the available system
states. The techniques proposed in [8, 21, 28] are also based
on modeling individual attacks. However, they focus on IDS
alerts without exploiting other information sources. Our ap-
proach can potentially get more concrete results due to the
additional, complementary information.
There are other alert correlation techniques. Some ap-
proaches cluster alerts on the basis of the similarities be-
tween the alert attributes (e.g., [7,29]), or hierarchies of con-
cepts (e.g., [17,18]). Some others correlate alerts by match-
ing alerts against known attack scenarios, using languages
such as STATL [13] and LAMBDA [9]. These methods are
potentially complementary to our approach.
Our approach is also related to the recent results on
vulnerability analysis (e.g., [25]). However, our approach
is aimed at reasoning about intrusion evidence rather than
identifying possible sequences of attacks.
5. Conclusion and Future Work
In this paper, we developed a method to integrate and
reason about complementary intrusion evidence, including
IDS alerts, reports of system monitoring or vulnerability
scanning tools, and even human observations. By using
the interdependency between attacks and system states, we
combine various kinds of intrusion evidence into Bayesian
networks, and infer about uncertain IDS alerts based on ad-
ditional observations of system states. We further proposed
to reﬁne these Bayesian networks through alert aggrega-
tion and abstraction, so that we can focus on the reasoning
about existences of successful attacks and use complemen-
tary intrusion evidence more effectively. Our initial exper-
imental results have demonstrated the potential of the pro-
posed techniques.
Proceedings of the 20th Annual Computer Security Applications Conference (ACSAC’04) 
1063-9527/04 $ 20.00 IEEE 
This paper is only the starting point of our effort to inte-
grate and reason about complementary intrusion evidence.
In our future work, we will investigate additional techniques
to improve the performance. In particular, we will study the
use of dynamical Bayesian networks in processing streams
of IDS alerts and other intrusion evidence, investigate ap-
proaches to handling attacks missed by IDSs, and perform
experiments with large sets of intrusion evidence.
References
[1] checkrootkit. http://www.checkrootkit.org. Ac-
cessed on Feb. 4, 2004.
[2] Javabayes.
http://www-2.cs.cmu.edu/
˜javabayes/Home/. Accessed on Oct 10, 2003.
[3] Nessus. http://www.nessus.org. Accessed on Feb.
4, 2004.
[4] Samhain. http://la-samhna.de/samhain/. Ac-
cessed on April 4, 2004.
[5] Tripwire. http://www.tripwire.com. Accessed on
Feb. 4, 2004.
[6] P. Ammann, D. Wijesekera, and S. Kaushik. Scalable, graph-
based network vulnerability analysis. In Proceedings of the
9th ACM Conference on Computer and Communications Se-
curity, pages 217–224, November 2002.
[7] F. Cuppens. Managing alerts in a multi-intrusion detection
environment. In Proceedings of the 17th Annual Computer
Security Applications Conference, December 2001.
[8] F. Cuppens and A. Miege. Alert correlation in a cooperative
intrusion detection framework. In Proceedings of the 2002
IEEE Symposium on Security and Privacy, May 2002.
[9] F. Cuppens and R. Ortalo. LAMBDA: A language to model
a database for detection of attacks. In Proc. of Recent Ad-
vances in Intrusion Detection (RAID 2000), pages 197–216,
September 2000.
[10] O. Dain and R.K. Cunningham. Building scenarios from a
heterogeneous alert stream. In Proceedings of the 2001 IEEE
Workshop on Information Assurance and Security, pages
231–235, June 2001.
[11] O. Dain and R.K. Cunningham. Fusing a heterogeneous
alert stream into scenarios. In Proceedings of the 2001 ACM
Workshop on Data Mining for Security Applications, pages
1–13, November 2001.
[12] H. Debar and A. Wespi. Aggregation and correlation of
intrusion-detection alerts. In Recent Advances in Intrusion
Detection, LNCS 2212, pages 85 – 103, 2001.
[13] S.T. Eckmann, G. Vigna, and R.A. Kemmerer. STATL: An
Attack Language for State-based Intrusion Detection. Jour-
nal of Computer Security, 10(1/2):71–104, 2002.
[14] D. Farmer and W. Venema. SATAN: Security administrator
tool for analyzing networks. http://142.3.223.54/
˜short/SECURITY/satan.html.
[15] Fyodor. Nmap free security scanner.
http://www.
insecure.org/nmap, 2003.
[16] F.V. Jensen.
Bayesian Networks and Decision Graphs.
Statistics for Engineering and Information Science. Springer,
2001.
[17] K. Julisch. Mining alarm clusters to improve alarm handling
efﬁciency. In Proceedings of the 17th Annual Computer Se-
curity Applications Conference (ACSAC), pages 12–21, De-
cember 2001.
[18] K. Julisch and M. Dacier. Mining intrusion detection alarms
for actionable knowledge.
In The 8th ACM International
Conference on Knowledge Discovery and Data Mining, July
2002.
[19] MIT Lincoln Lab. 1999 DARPA intrusion detection scenario
http://www.ll.mit.edu/IST/
speciﬁc datasets.
ideval/data/1999/1999_data_index.html,
1999.
[20] B. Morin, L. M´e, H. Debar, and M. Ducass´e. M2D2: A for-
mal data model for IDS alert correlation. In Proceedings of
the 5th International Symposium on Recent Advances in In-
trusion Detection (RAID 2002), pages 115–137, 2002.
[21] P. Ning, Y. Cui, and D. S Reeves. Constructing attack sce-
narios through correlation of intrusion alerts. In Proceedings
of the 9th ACM Conference on Computer and Communica-
tions Security, pages 245–254, Washington, D.C., November
2002.
[22] P. Ning, D. Xu, C. Healey, and R. St. Amant. Building at-
tack scenarios through integration of complementary alert
correlation methods.
In Proceedings of the 11th Annual
Network and Distributed System Security Symposium (NDSS
’04), pages 97–111, February 2004.
[23] P.A. Porras, M.W. Fong, and A. Valdes. A mission-impact-
based approach to INFOSEC alarm correlation. In Proceed-
ings of the 5th International Symposium on Recent Advances
in Intrusion Detection (RAID 2002), pages 95–114, 2002.
[24] M. Roesch. Snort - lightweight intrusion detection for net-
In Proceedings of the 1999 USENIX LISA confer-
works.
ence, 1999.
[25] O. Sheyner, J. Haines, S. Jha, R. Lippmann, and J.M. Wing.
Automated generation and analysis of attack graphs. In Pro-
ceedings of IEEE Symposium on Security and Privacy, May
2002.
[26] S. Staniford, J.A. Hoagland, and J.M. McAlerney. Practical
automated detection of stealthy portscans. Journal of Com-
puter Security, 10(1/2):105–136, 2002.
[27] Tauscan.
http://www.agnitum.com/products/
tauscan/.
[28] S. Templeton and K. Levitt. A requires/provides model for
computer attacks. In Proceedings of New Security Paradigms
Workshop, pages 31 – 38. ACM Press, September 2000.
[29] A. Valdes and K. Skinner. Probabilistic alert correlation. In
Proceedings of the 4th International Symposium on Recent
Advances in Intrusion Detection (RAID 2001), pages 54–68,
2001.
[30] X-scan. http://www.xfocus.org.
[31] Y. Zhai, P. Ning, P. Iyer, and D.S. Reeves. Reasoning about
complementary intrusion evidence. Technical Report TR-
2004-25, Department of Computer Science, North Carolina
State University, 2004.
Proceedings of the 20th Annual Computer Security Applications Conference (ACSAC’04) 
1063-9527/04 $ 20.00 IEEE