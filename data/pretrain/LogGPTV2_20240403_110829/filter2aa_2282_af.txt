  take	
  precise	
  measurements.	
  This	
  is	
  no	
  longer	
  the	
  case	
  however	
  as	
  the	
rapid	
  evolution	
  of	
  moderately	
  priced	
  3D	
  printing	
  has	
  created	
  a	
  market	
  for	
  hobbyist	
  friendly	
  3D	
  scanning	
solutions.	
  Some	
  software	
  solutions	
  like	
  David	
  3D19	
  process	
  images	
  of	
  an	
  object	
  while	
  a	
  laser	
  beam	
  moves	
across	
  it.	
  This	
  makes	
  it	
  possible	
  to	
  invest	
  more	
  or	
  less	
  depending	
  on	
  the	
  required	
  scan	
  fidelity	
  as	
  the	
software	
  can	
  achieve	
  quality	
  scans	
  with	
  relatively	
  low	
  quality	
  hardware.	
  The	
  technology	
  to	
  map	
  out	
  a	
  3D	
space	
  has	
  also	
  penetrated	
  into	
  consumer	
  devices	
  with	
  the	
  most	
  notable	
  instance	
  being	
  the	
  Xbox	
  Kinnect	
gaming	
  controller.	
  With	
  the	
  release	
  of	
  APIs	
  for	
  working	
  with	
  the	
  Kinnect,	
  software	
  packages	
  such	
  as	
Skannect	
  and	
  ReconstructMe	
  now	
  allow	
  it	
  to	
  be	
  used	
  a	
  general-­‐purpose	
  3D	
  scanner	
  with	
  impressive	
results.	
  More	
  recently	
  VERT	
  has	
  experimented	
  with	
  3D	
  scanning	
  using	
  the	
  free	
  123D	
  Catch	
  app	
  from	
Autodesk20	
  that	
  processes	
  a	
  series	
  of	
  smartphone	
  photos	
  to	
  reconstruct	
  an	
  object.	
Using	
  Proxmark3	
  like	
  a	
  Boss	
The	
  proxmark3	
  is	
  only	
  as	
  powerful	
  as	
  the	
  firmware	
  it	
  uses	
  and	
  the	
  commands	
  known	
  to	
  the	
  operator.	
  In	
the	
  first	
  half	
  of	
  2015	
  there	
  have	
  been	
  several	
  new	
  features	
  implemented	
  to	
  make	
  the	
  system	
  more	
powerful.	
  This	
  section	
  of	
  the	
  white	
  paper	
  starts	
  by	
  giving	
  an	
  example	
  of	
  analyzing	
  an	
  unknown	
  card	
  and	
cloning	
  it	
  to	
  a	
  T55x7	
  using	
  commands	
  from	
  pm3	
  developer	
  Marshmellow42.	
  Sometimes	
  however	
  a	
  job	
may	
  call	
  for	
  digging	
  into	
  the	
  proxmark3	
  firmware	
  and	
  adding	
  new	
  features	
  for	
  specific	
  tasks.	
  This	
  section	
provides	
  an	
  overview	
  of	
  how	
  to	
  use	
  some	
  of	
  the	
  newer	
  advanced	
  features	
  explains	
  by	
  example	
  how	
  to	
design	
  and	
  implement	
  new	
  commands	
  using	
  the	
  AWID26	
  format	
  as	
  an	
  example.	
Using	
  ‘lf	
  search’	
This	
  section	
  white	
  paper	
  focuses	
  on	
  a	
  few	
  of	
  the	
  changes	
  in	
  the	
  low	
  frequency	
  (lf)	
  context	
  of	
  the	
  device.	
New	
  features	
  introduced	
  in	
  March	
  2015	
  allow	
  automatic	
  identification	
  of	
  low	
  frequency	
  tags	
  and	
  easy	
18	
  http://seek.autodesk.com/	
19	
  http://www.david-­‐3d.com/	
20	
  http://123d.autodesk.com/catch/	
HOW	
  TO	
  TRAIN	
  YOUR	
  RFID	
  HACKING	
  TOOLS	
recovery	
  of	
  the	
  demodulated	
  tag	
  data.	
  This	
  is	
  particularly	
  useful	
  when	
  the	
  goal	
  is	
  to	
  simulate	
  or	
  clone	
  a	
tag	
  after	
  interrogating	
  it.	
  The	
  first	
  step	
  in	
  this	
  process	
  is	
  ‘lf	
  search,’	
  a	
  command	
  to	
  sample	
  data	
  from	
  the	
coil	
  and	
  test	
  each	
  implemented	
  demodulation	
  looking	
  for	
  a	
  match.	
Figure	
  21	
  Identifying	
  HID37	
  tag	
  via	
  'lf	
  search'	
With	
  the	
  samples	
  in	
  the	
  proxmark3’s	
  graph	
  buffer,	
  it	
  is	
  possible	
  to	
  use	
  other	
  commands	
  to	
  inspect	
  the	
waveform.	
  Simulation	
  of	
  the	
  tag	
  from	
  this	
  point	
  is	
  as	
  simple	
  as	
  running	
  ‘lf	
  simfsk’	
  with	
  no	
  other	
arguments.	
  Clock	
  and	
  logic	
  settings	
  are	
  used	
  from	
  the	
  identified	
  waveform	
  as	
  well	
  as	
  the	
  demodulated	
bit	
  stream.	
Printing	
  and	
  using	
  the	
  demodulated	
  buffer	
The	
  hexadecimal	
  representation	
  of	
  the	
  demodulated	
  buffer	
  can	
  be	
  printed	
  with	
  the	
  data	
  command	
‘printdemodbuffer	
  x’	
  as	
  shown	
  in	
  the	
  following	
  figure.	
Figure	
  22	
  demodbuffer	
  from	
  HID37	
  waveform	
With	
  a	
  little	
  help	
  from	
  a	
  forum	
  post	
  on	
  the	
  proxmark	
  developers	
  community	
  forum21	
  indicates	
  the	
  T55x7	
block	
  0	
  configuration	
  for	
  different	
  popular	
  tag	
  types.	
  HID	
  tags	
  use	
  FSK2a	
  with	
  an	
  RF/50	
  data	
  rate	
  where	
a	
  logical	
  0	
  consists	
  of	
  six	
  logic	
  0	
  FSK	
  cycles	
  and	
  a	
  logical	
  1	
  is	
  signaled	
  by	
  five	
  logic	
  1	
  FSK	
  cycles.	
  This	
21	
  http://www.proxmark.org/forum/viewtopic.php?id=1767	
HOW	
  TO	
  TRAIN	
  YOUR	
  RFID	
  HACKING	
  TOOLS	
corresponds	
  to	
  block	
  0	
  settings	
  0x00106070.	
  The	
  demodbuffer	
  bytes	
  can	
  then	
  be	
  split	
  up	
  into	
  blocks	
  and	
programmed	
  onto	
  the	
  T55x7	
  card.	
Figure	
  23	
  Writing	
  demodbuffer	
  to	
  T55xx	
Developing	
  New	
  Features	
  for	
  The	
  Proxmark3	
Sometimes	
  a	
  task	
  requires	
  going	
  beyond	
  existing	
  features	
  to	
  get	
  the	
  job	
  done.	
  The	
  open	
  source	
philosophy	
  of	
  tools	
  like	
  the	
  proxmark3	
  make	
  this	
  possible	
  but	
  it	
  is	
  not	
  always	
  intuitive	
  where	
  to	
  begin.	
Designs	
  for	
  the	
  hardware	
  and	
  software	
  of	
  proxmark3	
  are	
  maintained	
  in	
  a	
  GitHub	
  repository	
  along	
  with	
  a	
helpful	
  wiki	
  for	
  getting	
  started.22	
  This	
  section	
  is	
  intended	
  as	
  a	
  reference	
  guide	
  for	
  getting	
  started	
  with	
proxmark3	
  firmware	
  development.	
Before	
  jumping	
  into	
  the	
  code	
  it	
  is	
  helpful	
  to	
  introduce	
  (or	
  refresh)	
  some	
  key	
  concepts	
  related	
  to	
  how	
  the	
pm3	
  operates.	
  Proxmark3	
  is	
  a	
  USB	
  powered	
  device	
  designed	
  to	
  either	
  run	
  independently	
  with	
  push-­‐
button	
  input	
  (stand-­‐alone	
  mode)	
  or	
  receiving	
  commands	
  over	
  a	
  USB	
  serial	
  data	
  link.	
  In	
  contrast	
  to	
  tools	
like	
  RFIDler	
  or	
  the	
  recently	
  released	
  ChameleonMini,	
  serial	
  commands	
  are	
  sent	
  to	
  the	
  pm3	
  using	
  a	
custom	
  client	
  rather	
  than	
  having	
  a	
  native	
  text	
  driven	
  command	
  line	
  interface.	
  The	
  proxmark	
  client	
instead	
  issues	
  commands	
  to	
  the	
  hardware	
  by	
  sending	
  an	
  UsbCommand	
  data	
  structure	
  containing	
  a	
command	
  number	
  and	
  arguments	
  to	
  be	
  consumed	
  and	
  processed	
  by	
  the	
  ARM	
  CPU.	
  This	
  device/client	
model	
  reduces	
  communication	
  on	
  the	
  serial	
  bus	
  and	
  allows	
  developers	
  to	
  offload	
  some	
  operations	
  from	
the	
  resource	
  constrained	
  ARM.	
  (Constraints	
  must	
  be	
  considered	
  in	
  terms	
  of	
  both	
  storage	
  space	
  and	
processing	
  capability.)	
The	
  FPGA	
  is	
  a	
  lot	
  of	
  what	
  makes	
  proxmark3	
  standout	
  from	
  the	
  crowd	
  but	
  fortunately	
  knowledge	
  of	
Verilog	
  is	
  not	
  required	
  for	
  most	
  development	
  tasks.	
  In	
  fact,	
  it	
  should	
  be	
  possible	
  to	
  add	
  support	
  for	
  any	
low-­‐frequency	
  tag	
  format	
  entirely	
  within	
  C	
  code.	
  In	
  low-­‐frequency	
  mode,	
  the	
  FPGA	
  reads	
  raw	
  A/D	
samples	
  via	
  SPI	
  and	
  passes	
  them	
  onto	
  the	
  ARM	
  for	
  processing	
  using	
  SSP.	
  In	
  high-­‐frequency	
  mode	
  the	
FPGA	