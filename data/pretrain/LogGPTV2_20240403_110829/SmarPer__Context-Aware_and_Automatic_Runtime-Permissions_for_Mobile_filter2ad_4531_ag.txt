apps. This might have introduced a bias, as participants
are more familiar with these apps and, in some cases, less
willing to deny their requests. Yet, collecting data from
a larger set of apps requires a long-term user study to
collect enough data from less frequently used apps. Also,
techniques to deal with data sparsity will be needed.
• Simpliﬁed decision modeling. Our prediction model takes
into account only contextual factors that can be col-
lected by the users’ smartphones. There are probably
other contextual factors that are also important but not
considered in our approach. Moreover, there are non-
contextual factors that are important in privacy decision-
making, e.g., psychological factors [20].
• Data set size. Our data set is not large enough to reli-
ably train advanced machine learning models, to cluster
participants, and to obtain a reliable conﬁdence metric.
Hence, we will carry out a longer-term data collection
campaign with more participants.
• Data quality. We took measures to remove noisy decision
data from our data set (Section V). However, we cannot
fully validate if participants made decisions that correctly
conveyed their intentions. For instance, a participant
might have provided only biased or fake decisions, or
just random decisions. This could explain why some
participants are more difﬁcult to predict.
VIII. CONCLUSION
As the number of apps, data types, and permissions in-
creases in mobile platforms, users are increasingly in need
of better mechanisms to manage permissions. Artiﬁcial in-
telligence and machine learning techniques are already being
used for security purposes in mobile platforms such as An-
droid [58]. Therefore, it is logical to use similar techniques to
help users to better control their privacy in mobile devices.
We presented SmarPer, an advanced permission mechanism
for Android, designed to address two important limitations of
current mobile permission systems: the static nature of current
permission policies and the poor trade-off between privacy
and utility. After seeing some initial training decision data
and its corresponding contextual information, SmarPer uses
machine learning to infer users’ permission-decision patterns
at runtime and to automatically respond to future permission
requests (not yet supported). Furthermore, SmarPer offers
“obfuscated” decisions to reduce the information revealed to
apps while still obtaining some utility.
We deployed, under realistic conditions, our SmarPer imple-
mentation to 41 users and collected their permission decisions
and contextual information for around 10 days each. Using
a Bayesian linear regression approach to train a model per
user, we achieved a mean incorrect classiﬁcation rate (ICR)
of 0.20 (±0.03), which is a mean relative improvement of
50% over a static policy baseline, i.e., the approach used by
current permission systems. Our results show that our model
can learn to predict users’ decisions with good accuracy and
that contextual information is important for such a task.
For future work, we plan to expand our data set of per-
mission decisions to train more advanced models for better
accuracy. Moreover, we will evaluate exploration-exploitation
trade-off methods to automate decisions at runtime to complete
our SmarPer implementation and to move a step closer towards
automatic permission-management in smartphones.
1073
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:19:06 UTC from IEEE Xplore.  Restrictions apply. 
REFERENCES
[1] N. Sadeh, J. Hong, L. Cranor, I. Fette, P. Kelley, M. Prabaker, and J. Rao,
“Understanding and Capturing People’s Privacy Policies in a Mobile So-
cial Networking Application,” Personal Ubiquitous Computing, vol. 13,
no. 6, pp. 401–412, 2009.
[2] P. Wijesekera, A. Baokar, A. Hosseini, S. Egelman, D. Wagner, and
K. Beznosov, “Android Permissions Remystiﬁed: A Field Study on
Contextual Integrity,” in Proceedings of the Usenix Security Symposium,
2015.
[3] “CyanogenMod,” https://en.wikipedia.org/wiki/CyanogenMod, Last vis-
ited: February 2017.
[4] M. Bokhorst, “XPrivacy - The ultimate, yet easy to use, privacy man-
ager,” https://github.com/M66B/XPrivacy, Last visited: February 2017.
[5] “LBE Privacy Guard,” http://forum.xda-developers.com/showthread.
php?t=1091065, Last visited: January 2017.
an
“Android
Sawers,
users
[6] P.
have
apps
according to Yahoo Aviate data,”
average
95
of
installed on their phones,
http://thenextweb.com/apps/2014/08/26/android-users-average-95-
apps-installed-phones-according-yahoo-aviate-data/,
February 2017.
Last
visited:
[7] K. Olmstead and M. Atkinson, “Apps Permissions in the Google
Play Store,” http://www.pewinternet.org/2015/11/10/apps-permissions-
in-the-google-play-store/, Last visited: February 2017.
[8] B. Liu, J. Lin, and N. Sadeh, “Reconciling Mobile App Privacy and
Usability on Smartphones: Could User Privacy Proﬁles Help?” in Pro-
ceedings of the International Conference on World Wide Web (WWW),
2014.
[9] B. Liu, M. S. Andersen, F. Schaub, H. Almuhimedi, S. Zhang, N. Sadeh,
A. Acquisti, and Y. Agarwal, “Follow My Recommendations : A Person-
alized Privacy Assistant for Mobile App Permissions,” in Proceedings
of the Symposium On Usable Privacy and Security (SOUPS), 2016.
[10] F. Shih, I. Liccardi, and D. J. Weitzner, “Privacy Tipping Points in Smart-
phones Privacy Preferences,” in Proceedings of the ACM Conference on
Human Factors in Computing Systems (CHI), 2015.
[11] “SmarPer Project: Automatic and Context-Aware Permissions for An-
droid,” https://spism.epﬂ.ch/smarper/, Last visited: March 2017.
[12] A. P. Felt, E. Ha, S. Egelman, A. Haney, E. Chin, and D. Wagner,
“Android Permissions: User Attention, Comprehension, and Behavior,”
in Proceedings of
the Symposium on Usable Privacy and Security
(SOUPS), 2012.
[13] P. G. Kelley, L. F. Cranor, and N. Sadeh, “Privacy as Part of the App
Decision-Making Process,” in Proceedings of the SIGCHI Conference
on Human Factors in Computing Systems (CHI), 2013.
[14] R. Stevens, J. Ganz, V. Filkov, P. Devanbu, and H. Chen, “Asking for
(and about) Permissions Used by Android Apps,” in Proceedings of the
Working Conference on Mining Software Repositories (MSR), 2013.
[15] A. P. Felt, S. Egelman, M. Finifter, D. Akhawe, and D. Wagner, “How
to Ask for Permission,” in Proceedings of the USENIX Workshop on
Hot Topics in Security (HotSec), 2012.
[16] S. Bugiel, S. Heuser, and A.-R. Sadeghi, “Flexible and Fine-grained
Mandatory Access Control on Android for Diverse Security and Privacy
Policies,” in Proceedings of the USENIX Security Symposium, 2013.
[17] S. Heuser, A. Nadkarni, W. Enck, and A.-R. Sadeghi, “ASM: A Pro-
grammable Interface for Extending Android Security,” in Proceedings
of the USENIX Security Symposium, 2014.
[18] Y. Zhou, X. Zhang, X. Jiang, and V. W. Freeh, “Taming Information-
stealing Smartphone Applications (on Android),” in Proceedings of the
International Conference on Trust and Trustworthy Computing (TRUST),
ser. Lecture Notes in Computer Science, 2011, vol. 6740, pp. 93–107.
[19] Y. Agarwal and M. Hall, “ProtectMyPrivacy: detecting and mitigating
privacy leaks on iOS devices using crowdsourcing,” in Proceedings
of the International Conference on Mobile Systems, Applications, and
Services (MobiSys), 2013.
[20] C. Dong, H. Jin, and B. P. Knijnenburg, “Predicting Privacy Behavior
on Online Social Networks,” in Proceedings of the International AAAI
Conference on Web and Social Media (ICWSM), 2015.
[21] M. Conti, V. T. N. Nguyen, and B. Crispo, “CRePE: Context-Related
Policy Enforcement for Android,” in Information Security: 13th Inter-
national Conference, ISC 2010, Boca Raton, FL, USA, October 25-28,
2010, Revised Selected Papers. Springer Berlin Heidelberg, 2011, pp.
331–345.
[22] S. Chakraborty, C. Shen, K. R. Raghavan, Y. Shoukry, M. Miller, and
M. B. Srivastava, “ipShield : A Framework For Enforcing Context-
Aware Privacy,” in Proceedings of the USENIX Symposium on Net-
worked Systems Design and Implementation (NSDI), 2014.
[23] M. Miettinen, S. Heuser, W. Kronz, A.-R. Sadeghi, and N. Asokan,
“Conxsense: Automated context classiﬁcation for context-aware access
control,” in Proceedings of the ACM Symposium on Information, Com-
puter and Communications Security, ser. ASIA CCS ’14, 2014.
[24] P. Hornyack, S. Han, J. Jung, S. Schechter, and D. Wetherall, “These
Aren’t the Droids You’re Looking for: Retroﬁtting Android to Protect
Data from Imperious Applications,” in Proceedings of the ACM Confer-
ence on Computer and Communications Security (CCS), 2011.
[25] A. R. Beresford, A. Rice, N. Skehin, and R. Sohan, “MockDroid:
Trading Privacy for Application Functionality on Smartphones,” in
Proceedings of the Workshop on Mobile Computing Systems and Ap-
plications (HotMobile), 2011.
[26] J. Cranshaw, J. Mugan, and N. Sadeh, “User-Controllable Learning of
Location Privacy Policies with Gaussian Mixture Models,” in AAAI
Conference on Artiﬁcial Intelligence, 2011.
[27] I. Bilogrevic, K. Huguenin, B. Agir, M. Jadliwala, and J.-P. Hubaux,
“Adaptive Information-Sharing for Privacy-Aware Mobile Social Net-
works,” in Proceedings of the ACM International Joint Conference on
Pervasive and Ubiquitous Computing (Ubicomp), 2013.
[28] I. Bilogrevic, K. Huguenin, B. Agir, M. Jadliwala, M. Gazaki, and
J.-P. Hubaux, “A machine-learning based approach to privacy-aware
information-sharing in mobile social networks,” Pervasive and Mobile
Computing, vol. 25, pp. 125–142, 2016.
[29] L. Yuan, J. R. Theytaz, and T. Ebrahimi, “Context-Dependent Privacy-
Aware Photo Sharing based on Machine Learning,” in Proceedings of
32nd International Conference on ICT Systems Security and Privacy
Protection (IFIP SEC 2017), 2017.
[30] J. Lin, B. Liu, N. Sadeh, and J. I. Hong, “Modeling Users’ Mobile
App Privacy Preferences: Restoring Usability in a Sea of Permission
Settings,” in Proceedings of the Symposium On Usable Privacy and
Security (SOUPS), 2014.
[31] rovo89, “Xposed Installer — Xposed Module Repository,” http://repo.
xposed.info/module/de.robv.android.xposed.installer, Last visited: Jan-
uary 2017.
[32] ——,
“Xposed Development Tutorial,” https://github.com/rovo89/
XposedBridge/wiki/Development-tutorial, last visited: January 2017.
[33] R. Shokri, G. Theodorakopoulos, C. Troncoso, J.-P. Hubaux, and J.-Y.
Le Boudec, “Protecting Location Privacy: Optimal Strategy Against Lo-
calization Attacks,” in Proceedings of the ACM Conference on Computer
and Communications Security (CCS), 2012.
[34] N. E. Bordenabe, K. Chatzikokolakis, and C. Palamidessi, “Optimal
Geo-Indistinguishable Mechanisms for Location Privacy,” in Proceed-
ings of the ACM Conference on Computer and Communications Security
(CCS), 2014.
[35] A. T. Truong, Q. C. Truong, and T. K. Dang, “An adaptive grid-based
approach to location privacy preservation,” in Advances in Intelligent
Information and Database Systems, 2010.
[36] R. Shokri, G. Theodorakopoulos, J.-Y. Le Boudec, and J. Hubaux,
“Quantifying Location Privacy,” in Proceedings of the IEEE Symposium
on Security and Privacy (S&P), 2011.
[37] Y. Matsuo, N. Okazaki, K. Izumi, Y. Nakamura, T. Nishimura, and
K. Hasida, “Inferring Long-term User Properties based on Users’
Location History,” in Proceedings of the International Joint Conference
on Artiﬁcial Intelligence (IJCAI’07), 2007.
[38] A. Noulas, M. Musolesi, M. Pontil, and C. Mascolo, “Inferring interests
from mobility and social interactions,” in Proceedings of Workshop on
Analyzing Networks and Learning with Graphs (NIPS’09), 2009.
[39] I. Panagiotis, I. Polakis, E. Athanasopoulos, F. Maggi, and S. Ioan-
nidis, “Face/Off: Preventing Privacy Leakage From Photos in Social
Networks,” in Proceedings of the ACM Conference on Computer and
Communications Security (CCS), 2015.
[40] S. S. Jon Howell, “What You See is What They Get: Protecting users
from unwanted use of microphones, cameras, and other sensors,” in
Proceedings of the Web 2.0 Security and Privacy Workshop, 2010.
[41] J. Lemley, S. Abdul-Wahid, D. Banik, and R. Andonie, “Comparison
of recent machine learning techniques for gender recognition from
facial images,” in Proceedings of the Modern Artiﬁcial Intelligence and
Cognitive Science Conference, 2016.
1074
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:19:06 UTC from IEEE Xplore.  Restrictions apply. 
[42] X. Lu and A. Jain, “Ethnicity identiﬁcation from face images,” in Pro-
ceedings of SPIE - The International Society for Optical Engineering,
2004, vol. 5404, pp. 114–123.
[43] N. K. Malhotra, S. S. Kim, and J. Agarwal, “Internet Users’ Information
Privacy Concerns (IUIPC): The Construct, the Scale, and a Causal
Model,” Information Systems Research, vol. 15, no. 4, pp. 336–355,
2004.
[44] S. Garavaglia and A. Sharma, “A Smart Guide to Dummy Variables:
Four Applications and a Macro,” in Proceedings of the Northeast SAS
Users Group Conference, 1998.
[45] P. A. Norberg, D. R. Horne, and D. A. Horne, “The Privacy Paradox:
Personal Information Disclosure Intentions Versus Behaviors,” Journal
of Consumer Affairs, vol. 41, no. 1, pp. 100–126, 2007.
[46] “ZeroR,” https://weka.wikispaces.com/ZeroR, Last visited: February
2017.
less popular apps or apps that are used less frequent, we need
longer periods of time to collect enough data (avoiding forcing
participants to generate decisions to reduce bias).
APPENDIX B
EXAMPLE SCENARIOS USED IN PERMISSION DECISIONS
After completing our data collection campaign, we sent
an e-mail to some of the participants with a questionnaire
inquiring about example situations in which they chose a
decision for a particular app and data type. Some of the
answers collected are presented in Table III. These responses
show the trade-off between privacy and usability that users
face when making permission decisions. These responses also
provide an idea of the scenarios or contexts that users consider
when making decisions.
[47] K. E. Train, Discrete Choice Methods With Simulation, Cambridge:
Cambridge University Press, Ed., 2009.
[48] C. K. Williams and C. E. Rasmussen, “Gaussian Processes for Regres-
sion,” in Advances in Neural Information Processing Systems (NIPS),
1995.
[49] C. M. Bishop, Pattern Recognition and Machine Learning (Information
Science and Statistics). Secaucus, NJ, USA: Springer-Verlag New York,
Inc., 2006.
[50] J. A. Anderson, “Regression and Ordered Categorical Variables,” Journal
of the Royal Statistical Society. Series B (Methodological), vol. 46, no. 1,
pp. 1–30, 1984.
[51] Z.-H. Zhou and X.-Y. Liu, “On Multi-Class Cost-Sensitive Learning,”
in AAAI Conference on Artiﬁcial Intelligence, 2006.
[52] T. H. R. T. Gareth James, Daniela Witten, An Introduction to Statistical
Learning: with Applications in R. Springer, 2013.
[53] “Gaussian Process Regression and Classiﬁcation (GPML) Tool-
box,” http://www.gaussianprocess.org/gpml/code/matlab/doc/, Last vis-
ited: February 2017.
[54] “How to choose algorithms for Microsoft Azure Machine Learn-
ing,” https://docs.microsoft.com/en-us/azure/machine-learning/machine-
learning-algorithm-choice, Last visited: February 2017.
[55] “Efﬁcient Java Matrix Library (EJML),” http://ejml.org/wiki/index.php?
title=Main Page, Last visited: February 2017.
[56] D. M. Blei, A. Y. Ng, and M. I. Jordan, “Latent dirichlet allocation,”
Journal of machine Learning research, vol. 3, no. Jan, pp. 993–1022,
2003.
[57] E. Brochu, V. M. Cora, and N. De Freitas, “A Tutorial on Bayesian
Optimization of Expensive Cost Functions, with Application to Ac-
tive User Modeling and Hierarchical Reinforcement Learning,” arXiv
preprint arXiv:1012.2599, 2010.
[58] “Google’s Training Its AI
to Be Android’s Security Guard,”
http://www.wired.com/2016/06/googles-android-security-team-turns-
machine-learning/, Last visited: February 2017.
ACKNOWLEDGMENT
This work was partially funded by the Swiss National
Science Foundation with grant 200021-138089 (PICAWA). We
would like express our sincere gratitude to Ketevani Zaridze
and John Stephan for their contributions to this project. The
authors are also extremely grateful to the anonymous reviewers
and to the shepherd, Lujo Bauer, for their insightful comments
and guidance.
APPENDIX A
DISTRIBUTION OF DECISIONS PER APP
Table II shows the total number of decisions per app
collected during our study (Section V). For each app, it also
shows the distribution of decisions per data type (i.e., contacts,
location, storage) and for each data type the distribution of the
type of decision (i.e., allow, obfuscate, deny). These numbers
demonstrate the importance of selecting popular apps in our
study to be able to collect enough decision data in the allotted
time; only 9 apps have more than 200 decisions. Hence, for
1075
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:19:06 UTC from IEEE Xplore.  Restrictions apply. 
App
WhatsApp
Facebook
The Weather Channel
Twitter
Viber
Skype
Instagram
AccuWeather
Snapchat
TripAdvisor
Shazam
Dropbox
Evernote
Waze
iHeartRadio
SoundCloud
Runtastic
Uber
Heroes
Subway Surf
Wish
Yelp
Total
2982
1821
878
569
556
431
350
283
205
153
93
56
45
36
24
16
11
6
2
2