spy	
  vs.	
  spy	
examining	
  spyware	
  on	
  mobile	
  devices	
michael	
  robinson	
  |	
  christopher	
  taylor	
Zarious	
  @	
  zarious.deviantart.com	
Introduc=on:	
  The	
  newest	
  spy	
Spyware	
  can	
  easily	
  run	
  on	
  mobile	
  devices.	
It’s	
  in	
  malware	
and	
  its	
commercially	
available.	
hBp://www.computerweekly.com/Ar=cles/2011/09/12/247857/Mobile-­‐malware-­‐up-­‐273-­‐in-­‐ﬁrst-­‐half-­‐of-­‐2011.htm	
NickiBot:	
-­‐  Spyware	
  (GPS	
  monitoring,	
  sound	
  recording,	
  call	
logs,	
  e-­‐mail	
  uploading)	
-­‐  Fully	
  controlled	
  by	
  SMS	
  messages	
-­‐  Appears	
  as	
  “Android	
  System	
  Log”	
  under	
  installed	
applica=ons	
(See	
  www.csc.ncsu.edu/faculty/jiang/NickiBot.)	
NickiBot	
  Spyware	
and	
Zsone	
hBp://www.pcworld.com/businesscenter/ar=cle/217133/
soundminer_android_malware_listens_then_steals_phone_data.html	
Soundminer	
-­‐ Monitors	
  phone	
  calls	
  (voice	
  and	
  keypad)	
-­‐ Sends	
  credit	
  card	
  data	
  over	
  the	
  network	
-­‐ Paired	
  app	
  with	
  another	
  Trojan	
hBp://slashnext.com/2011/08/mobile-­‐malware-­‐threats-­‐grow-­‐now-­‐they-­‐can-­‐steal-­‐photos-­‐from-­‐your-­‐phone/	
F-­‐Secure:	
Photoscraping	
  for	
  harassment	
  and	
  blackmail.	
hBp://www.unplggd.com/unplggd/safety-­‐security/does-­‐your-­‐smartphone-­‐need-­‐an=virus-­‐protec=on-­‐156222	
ScarleB	
Johansson	
Jessica	
Alba	
Julianne	
Hough	
Heather	
Morris	
Miley	
Cirus	
Mila	
Kunis	
Olivia	
Munn	
Ashley	
  Greene	
Bri=sh	
Royalty	
Commercializa=on	
  of	
  spyware	
hBp://www.android-­‐apps.us/monitor/security-­‐sogware/blackberry-­‐spyware/	
hBp://www.android-­‐apps.us/monitor/security-­‐sogware/blackberry-­‐spyware/	
Did	
  you	
  catch	
  the	
  list	
  of	
compa=ble	
  devices?	
hBp://www.android-­‐apps.us/monitor/security-­‐sogware/blackberry-­‐spyware/	
And	
  this	
  is	
  the	
short	
  list.	
Some	
  commercial	
  versions	
don’t	
  require	
  roo=ng	
  of	
  the	
  phone.*	
*	
  iPhones	
  need	
  to	
  be	
  jailbroken.	
So	
  what	
  does	
  it	
  do?	
Commercial	
  spyware	
  may	
  capture:	
SMS	
  ac=vity	
Loca=on/GPS	
  coordinates	
Pictures	
Videos	
Inbound/outbound	
  call	
  logs	
Browser	
  ac=vity	
  (URLs)	
E-­‐mail	
Iden=fy	
  SIM	
  card	
  changes	
Interac=ve	
  mode	
  may	
  include:	
Taking	
  pictures	
Recording	
  videos	
Record	
  conversa=ons/background	
  via	
  calls	
Wiping	
  the	
  phone	
Viewing	
  the	
  target	
  phone’s	
  screen	
Harvested	
  data	
  sent	
  back	
  to	
  a	
  server.	
Internet	
Server/Website	
Target	
For	
  example:	
Call	
  records	
List	
  of	
Func=ons	
List	
  of	
  Func=ons	
List	
  of	
  Text	
  Messages	
Live	
  pictures	
GPS	
  Coordinates	
(Actually	
  cell	
  phone	
  towers)	
Recorded	
  phone	
  calls	
Alerts	
  can	
  be	
  sent	
  to	
  a	
  monitoring	
  phone	
  via	
  SMS	
directly	
  from	
  target	
  or	
  from	
  the	
  website.	
Target	
Internet	
Server/Website	
Spy	
Commands	
  can	
  be	
  sent	
  to	
  the	
  target	
  phone	
via	
  the	
  observing	
  phone	
  or	
  website.	
Internet	
Server/Website	
Target	
Spy	
Principle	
  diﬀerences	
  between	
malware	
  and	
  commercial	
  versions:	
ABack	
  vector	
(delivery	
  method)	
Logging	
Installa=on	
•  Physical	
  access:	
  required.	
•  Android	
  roo=ng:	
  not	
  always	
  required.	
•  iPhone	
  Jailbreaking:	
  required.	
•  Internet	
  connec=on:	
  required.	
•  Ability	
  to	
  install	
  apps	
  from	
  unknown	
sources.:	
  required	
•  Device	
  may	
  need	
  to	
  be	
  rebooted.	
FreeDigitalPhotos.net	
The	
  BIG	
  ques=on:	
How	
  do	
  you	
  know	
  if	
  you’ve	
  been	
  PWN’d?	
You	
  wouldn’t	
  know,	
  would	
  you?	
Spyware	
  is	
  “undetectable.”	
Here’s	
  what	
  we	
  did:	
We	
  forensically	
  examined	
  smart	
  phones	
infected	
  with	
  diﬀerent	
commercial	
  spyware	
  products.	
HTC	
  Wildﬁre	
  S	
  (rooted)	
on	
  T-­‐Mobile	
LG	
  Op=mus	
  Elite	
on	
  Virgin	
  Mobile	
LG	
  Op=mus	
  V	
on	
  Virgin	
  Mobile	
Samsumg	
  Galaxy	
  Prevail	
on	
  Boost/Sprint	
Apple	
  iPhones	
  4s	
  (jailbroken)	
on	
  T-­‐Mobile	
the	
  legal	
  stuﬀ	
the	
  legal	
  stuﬀ	
the	
  legal	
  stuﬀ	
the	
  legal	
  stuﬀ	
the	
  legal	
  stuﬀ	
Forensic	
  Tools	
URL	
  history	
  Title:
  FlexiSPY	
  Product	
  Download	
  URL:
  hBp://djp.cc	
Cookie	
  Name:
  JSESSIONID	
  Domain:
  djp.cc	
Search	
  of	
  physical	
  dump	
  hBp://djp.cc/checkkey?key=06107769107469&	
Submit=Download.FSXGAD_2.03.3.apk/mnt/sdcard/download/
FSXGAD_2.03.3.apkapplica=on/vnd.android.package-­‐archive	
SD	
  Card	
  \download\FSXGAD_2.03.3.apk	
ATTRIBUTION!	
Registra=on	
  Key	
/bookmark_thumb1/	
s7ea2c639.jpg	
support@ﬂexispy.com	
ATTRIBUTION!	
Registra=on	
  Key	
(in	
  the	
  picture)	
A	
  couple	
  of	
  glitches…	
On	
  the	
  version	
  we	
  tested,	
  we	
  no=ced:	
• 
Messages	
  appeared	
  periodically	
  that	
  “unknown”	
  obtained	
“superuser	
  access.”	
• 
The	
  sogware	
  didn’t	
  always	
  launch	
  on	
  reboot.	
• 
On	
  CDMA	
  phones,	
  stealthy	
  messages	
  sent	
  to	
  the	
  target	
phone	
  appeared	
  to	
  the	
  user,	
  i.e.,	
  they	
  were	
  not	
  stealthy.	
• 
Stealthy	
  phone	
  calls	
  did	
  not	
  work	
  on	
  CDMA	
  phones.	
Note:	
  A	
  new	
  version	
  of	
  the	
  product	
  has	
  since	
  been	
  released.	
152	
  Running	
  Apps	
Superuser	
(Evidence	
  of	
  roo=ng)	
/data/system/usagedata/usage-­‐20120207	
contains	
  a	
  reference	
  to:	
  “com.android.msecurity”	
/data/misc/dm/	
  callog.ref	
  callmgrd.zip	
  conﬁg.dat	
  dev_id	
  event.db	
  fx.log	
  gmail.ref	
  license.db	
  logcat.log	
  maind.zip	
  preference.db	
  s32	
  sms.ref	
/data/misc/dm/fx.log	
Hidden	
  SMS	
  command:	
Conﬁrma=on	
  of	
response	
  sent	
  to	
remote	
  system	
Sogware	
  version	
PROX	
/data/misc/dm/fx.log	
ATTRIBUTION!	
Hidden	
  SMS	
  command	
  &	
Registra=on	
  Number	
ATTRIBUTION!	
Monitoring	
number	
getMobileDataEnabled:	
  true	
Conﬁrma=on	
  of	
Connec=on	
/data/misc/dm/logcat	
Star=ng	
  process:	
com.slacker.radio	
Includes	
  PID	
Monitoring	
  other	
  services,	
e.g.,	
  charging.	
/data/misc/dm/logcat	
Calls	
  to	
  several	
  daemons:	
•  com.fx.callmgrd.CallMgrDaemon	
•  com.fx.pmond.MonitorDaemon	
•  com.fx.maind.MainDaemon	
Database	
  maintenance	
Library	
  loading:	
/data/misc/dm/libexec.so	
/data/misc/dm/logcat	
Image5	
(mtd5_userdata.bin)	
Deleted	
  log	
  data	
  found.	
SIM	
  Card	
  check	
Spyware	
  version	
Instruc=ons	
SMS	
  Commands	
ATTRIBUTION!	
Controlling	
Number	
Auto-­‐reply	
URL	
  history	
  hBp://www.spybubble.com/android/adv/radio.apk	
downloads.db	
  entry	
  uri:	
  hBp://www.spybubble.com/android/adv/radio.apk	
hint:
  radio.apk	
_data: 	
  /mnt/sdcard/Download/radio.apk	
(Phone	
  not	
  shipped	
  with	
  an	
  SD	
  Card.)	
Outgoing	
  call	
  log 	
  #999999*	
There	
  was	
  an	
  error	
  with	