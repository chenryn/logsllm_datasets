# 工控安全分析闲谈
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 0x00写在前面
  * 在互联网时代并未向现在如此普及的情况下，工控设备之间的通信，是采用无线电和电缆进行的。
  * 但随着时代的发展，人们对工控的传统通信方式逐渐产生不满。无论是从性能的可靠性，部署的难易度以及覆盖范围的大小，都不能满足更高生产力需求的工业自动化生产。
  * 在竞争激烈的时代，转向基于IP的系统（接入互联网）可提供巨大的经济优势。因此，预计会有越来越多的系统转向基于IP的系统。例如，从专有的基于无线电的网络迁移到基于IP的网络的优势包括跨多个应用程序的共享网络资源，网络改进，例如增加的冗余和所有应用程序，共享网络管理系统的容量，以及仅为现场支持人员维护一项技能。
  * 随着接入互联网的工控设备越来越多，逐渐的构成了工业互联网体系。
  * 但由于此类互联网体系，存在其中的设备大多更新迭代困难，设备技术严重脱节，所以导致其安全问题十分之多，并因为大多数设备是运用在城市基础设施，甚至是工业制造以及军工产业。
  * 当发生网络安全事件时，影响以及破坏力巨大。针对于工控设备的安全研究分析势在必行。工控系统的安全研究分析势在必行。
## 0x01专业术语
  * 系统类 
    * MCS：机组指令控制系统 
      * 一般是指 纸机控制系统  
(Machine Control System),以传动为主,特别注重张力控制  
    * EMS：能源管理系统 
      * EMS能量管理系统是现代电网调度自动化系统(含硬、  
软件）总称。其主要功能由基础功能和应用功能两个  
部分组成。基础功能包括:计算机、操作系统和EMS支  
撑系统。应用功能包括:数据采集与监视(SCADA）、  
自动发电控制(AGC）与计划、网络应用分析  
    * PMC：生产监控系统 
      * Production material control是指对生产计划与生  
产进度的控制，以及对物料的计划、跟踪、收发、存  
储、使用等各方面的监督与管理和呆滞料的预防处理  
工作。PMC部主要有两方面的工作内容：即PC（生产  
计划、生产进度的管理）与MC（物料的计划、采购、  
跟踪、收发、存储、使用等各方面的监督与管理，以  
及废料的预防与处理工作）。  
n
      * PMC是PLC的一个子集，某些厂商将专用于数控机  
床的PLC称为PMC，所以PMC和PLC是非常相似的。  
比如FANUC PMC  
    * VMS：船舶远程监控管理系统 
      * 能够向岸端实时传输远洋船舶的航行信息、机舱信息、  
视频信息及货物信息，方便岸端管理人员管理其航行于世界各大洋的船舶。
      * 该产品曾圆满完成“神舟七号”、“神舟九号”、  
“神舟十号”载人航天飞行海上应急搜救保障任务，  
并获得总装备部的表彰，近年为我国多艘科考船和调  
查船提供了基础信息平台，并广泛应用于中远集团、  
台塑集团、中海油、安吉物流等大型航运企业及其他  
政府部门。  
    * MES：制造企业生产过程执行系统 
      * MES（制造执行系统Manufacturing Execution System）是企业CIMS信息集成的纽带，是实施企业敏捷制造战略和实现车间生产敏捷化的先进技术手段。MES制造执行系统是处于计划层和现场自动化系统之间的执行层，主要负责车间生产管理和调度执行。 
    * SCADA：数据采集与监视控制系统 
      * SCADA系统在电力系统中的应用最为广泛，技术发展也最为成熟。它作为能量管理系统（EMS系统）的一个最主要的子系统，有着信息完整、提高效率、正确掌握系统运行状态、加快决策、能帮助快速诊断出系统故障状态等优势，现已经成为电力调度不可缺少的工具。  
    * ICS：工业控制系统
    * DCS：分布式控制系统/集散控制系统 
      * DCS系统在石油、化工、电力、冶金等部门有广泛的应用。  
    * PCS：过程控制系统 
      * 过程控制在石油、化工、电力、冶金等部门有广泛的应用。  
    * ESD：应急停车系统  
    * PLC：可编程序控制器(Programmable Logic Controller)  
    * IED：智能监测单元
    * HMI：人机界面(Human Machine Interface)
    * MIS：管理信息系统(Management Information System) 
      * Management Information System是指对火力发电  
企业大量的原始管理数据进行收集、整理，支持查询、  
分析汇总等方面的工作。火力发电厂Mis系统是以生产  
管理为基础，设备管理和经营管理为中心的综合管理  
系统，全面实现成本控制，提高经济效益，实现现代  
化管理的信息系统。它为企业提供辅助决策信息，实  
现企业的生产、物资、人员、资金的优化管理，达到  
安全经济生产的预期目标。  
    * SIS： 生产过程自动化监控和管理系统 
      * Supervisory Information System 厂级监控信息系统是集过程实时监测、优化控制及生产过  
程管理为一体的厂级自动化信息系统，是处于火电厂  
集散控制系统以及相关辅助程控系统与全厂管理信息  
系统之间的一套实时厂级监控信息系统。  
    * MES：制造执行管理系统  
    * FCS：现场总线控制系统 
      * FCS系统可以说是第五代控制系统，本质是信息处理现场化。前现场总线技术的应用主要集中在冶金、电力、水处  
理、乳品饮料、烟草、水泥、石化、矿山以及OEM用户等各个行业，同时还有道路无人监控、楼宇自动化、智能家  
居等新技术领域。
    * FGS：火气系统（火灾/有毒气体检测系统 
      * FGS系统在石油、燃气、管输等部门有广泛  
的应用。  
GDS（气体监测系统）系统在化工部门有广  
泛的应用。
  * 设备类  
序号 | 简称 | 注释  
—-|—-|—-  
1 | RTU | Remote Terminal Unit，中文全称为远程终端控制系  
2 | DTU | 数据传输单元DTU (Data Transfer
unit)，是专门用于将串口数据转换为IP数据或将IP数据转换为串口数据通过无线通信网络进行传送的无线终端设备  
3 | FTU | Feeder Terminal Unit配电开关监控终端  
4 | TTU | distribution Transformer supervisory Terminal Unit，配电变压器监测终端  
5 | ESD | emergency shutdown device 紧急停车系统  
6 | CNC | 计算机数字控制机床(Computer numerical control)  
7 | MCC | 马达控制中心、电机控制系统  
8 | TSI | 汽轮机仪表监视系统  
9 | NCS | 升压站网络监控系统( Network Control System)  
10 | SCS | 顺序控制系统  
11 | CCS | 一种连续的调节系统（Continuious Control System）  
12 | FSSS | 锅炉炉膛安全监视系统  
13 | ETS | 汽轮机保护系统  
14 | ECS | 电气控制系统  
15 | MEH | 小汽轮机数字电液调节系统  
16 | BPCS | 旁路控制系统  
17 | DEH | 汽轮机数字电液调节系统  
18 | LCU | 现地控制单元（Local Control Unit ）  
19 | AGC | 自动发电控制（Automatic Gain Control）  
20 | AGV | Automated Guided Vehicle自动导引运输车  
21 | SIS | Safety Instrumented System 安全仪表系统
## 0x02协议端口及测试脚本
  * Modbus 
    * MODBUS协议定义了一个与基础通信层无关的简单协议数据单元（PDU）。特定总线或网络上的MODBUS协议映射能够在应用数据单元（ADU）上引入一些附加域。  
    * 安全问题： 
      * 缺乏认证：仅需要使用一个合法的Modbus地址和合法的功能码即可以建立一个Modbus会话
      * 缺乏授权：没有基于角色的访问控制机制， 任意用户可以执行任意的功能。