titleblackhat:asia-22 The Hidden RCE Surfaces That Control the Droids
Android OS internally uses a large number of libraries to process incoming files through various standard APIs defined in AOSP as well as self-developed APIs. These libraries are not only used to process some internal format files, but also used to process files during normal use of system applications, including files from untrusted sources, e.g. sent via MMS, chat apps, or e-mails, downloaded in a web browser and then displayed/used in Gallery/Photos applications, opened in Settings, etc).During our research, we found AOSP and almost all mainstream Android devices expose previously ignored remote attack surfaces towards supporting higher-definition images, complex media files and specific configuration files in native code. Following this idea, we finally found dozens of memory corruption vulnerabilities about media format files (eg quram, spi, sdocx, etc.) and other file formats which can be used to achieve 0-click or 1-click RCEs on devices from different manufacturers and AOSP itself. All of these have been reported and confirmed by vendors and got more than 20 CVEs with High or Critical severity by Google and other major manufacturers like Samsung.In this presentation, we will go through these new attack surfaces, introduce how we found the vulnerabilities in them by code auditing and fuzzing, especially how we efficiently conduct binary fuzzing on closed-source libraries developed by vendors, which has not been talked about before. Then we will share our work on analyzing and exploiting these vulnerabilities, including getting PC control and obtaining reverse shells.