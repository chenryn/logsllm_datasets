### Easy Deployment

#### Frequency-Domain Detection
We conducted experiments to evaluate the accuracy of DualGuard in detecting direct replay attacks in the frequency domain. To determine the decision threshold for Algorithm 2, we first obtained the Area Under the Cumulative Distribution Function (AUC) from the amplitude spectrum of the audio signals. Figure 10 illustrates the AUC distributions for both genuine and direct replay audios. The AUC values for genuine audios are concentrated and close to 1, indicating that low-frequency energy is dominant. In contrast, the AUC values for direct replay audios are more distributed and smaller, consistent with the distributed spectrum of replay audios. As shown in Figure 10, the optimal decision threshold is 0.817, as it minimizes classification errors between genuine and replay audios.

Table 1 presents the detection accuracy of DualGuard on direct replay attacks using Algorithm 2 with a decision threshold of 0.817. The accuracy across different speakers consistently exceeds 89%. Additionally, we calculated the false positive rate of our method in detecting direct replay attacks, which remains below 5%. We also tested DualGuard with the ASVspoof 2017 and 2019 datasets, demonstrating its effectiveness in detecting classic replay attacks. Our results show that DualGuard achieves 87.13% and 83.80% accuracy, respectively, in these datasets.

To further demonstrate the necessity of dual-domain detection, we trained another model using only frequency features from a mix of genuine, direct replay, and modulated replay audios. The experimental results showed that this model's accuracy reached only 63.36%, due to the significant spectral similarity between genuine and modulated replay audios in the frequency domain. Therefore, dual-domain detection is essential for accurately identifying both types of replay attacks.

### Robustness of Dual-Domain Detection

We conducted experiments to evaluate the robustness of our dual-domain detection under various conditions, including different sampling rates, recording devices, speaker devices, and noisy environments.

#### Impact of Genuine Audio Sampling Rate
We evaluated the impact of the sampling rate used to record the initial human voice. We used a TASCAM DR-40 digital recorder with a sampling rate of 96 kHz and an iPhone X with a sampling rate of 48 kHz. For both sampling rates, the average detection accuracy of DualGuard on modulated replay attacks was 98.05%. This is because the sampling rate used by attackers only affects the spectral resolution in the modulation process, but the waveform of the modulated replay audios remains unchanged after D/A conversion.

#### Impact of ASR Sampling Rate
We conducted experiments with different recording devices and sampling rates. The settings included: (S1) TASCAM DR-40 with 96 kHz, (S2) TASCAM DR-40 with 48 kHz, and (S3) a Xiaomi 4 mobile phone with 44.1 kHz. Figure 11(a) shows the experimental results. The detection accuracy generally increases with higher sampling rates. Although changing the sampling rate has little effect on frequency-domain detection, it significantly impacts time-domain detection due to changes in the sampling interval. A smaller sampling interval means finer detection granularity of local extrema ratios, enhancing detection accuracy. Even in the worst case, where the sampling rate is 44.1 kHz, DualGuard still achieves around 85% detection accuracy. This minimum sampling rate is common in everyday electronic devices, ensuring good detection accuracy across a range of devices.

#### Impact of Different Recording Devices
Figure 11(a) also shows that the detection accuracy does not vary significantly when using different recorders with the same sampling rate. The accuracy changes by less than 2% with different recording devices at 48 kHz or 44.1 kHz. This indicates that DualGuard can be effectively applied to various recording devices.

#### Impact of Noisy Environments
To test detection accuracy under different noisy environments, we introduced noise factors into our experiments. We tested our method in three scenarios: (1) a quiet environment, (2) a noisy environment with a signal-to-noise ratio (SNR) of 60 dB, and (3) a noisy environment with an SNR of 40 dB. The additive noise signal was generated by a loudspeaker playing a pre-prepared Gaussian white noise signal, simulating real-world noise. The noise was mixed with the test signals at specific SNRs. Figure 11(b) illustrates the detection accuracy in various noise conditions. The impact of noise is limited, with the detection accuracy remaining unchanged at an SNR of 60 dB. When the SNR drops to 40 dB, the detection accuracy decreases by an average of 3.2%. Noise primarily affects the time-domain defense, while the frequency-domain defense remains relatively unaffected. Despite this, DualGuard still performs well at general ambient noise levels.

### Overhead of Dual-Domain Detection
We implemented DualGuard in C++ and built a system prototype on the ReSpeaker Core v2, a popular voice interactive platform with a quad-core ARM Cortex-A7 processor running at 1.5 GHz and 1 GB of RAM. Our experimental results show that the embedded program processes a 32 ms signal segment in an average of 5.5 ms, with CPU usage of 24.2%. The maximum memory usage of the program is 12.05 MB, demonstrating the feasibility of applying our dual-domain detection system in real-world applications.

### Related Work
In this section, we review related research on attacks targeting Automatic Speech Recognition (ASR) systems, techniques for loudspeaker frequency response compensation, and defense systems against replay attacks.

#### Attacks on Speaker Dependent ASRs
Speaker-dependent ASR systems are designed to accept voice commands from specific users, verifying the speakerâ€™s identity through unique voice characteristics. There are four main spoofing attacks: (1) physical impersonation, (2) simple replay attacks, (3) speech synthesis attacks, and (4) speech conversion attacks.

#### Attacks on Speaker Independent ASRs
Speaker-independent systems accept commands from any person without identity verification, making them more vulnerable to attacks. Recent surreptitious attacks include Dolphin attacks, audio injection via laser light, and perturbed malicious audio. These attacks can also target the machine learning module in ASRs, generating noise-like or song-like voice commands that humans cannot interpret.

#### Loudspeaker Frequency Response Compensation
In room acoustics, loudspeaker frequency response compensation improves sound reproduction. Techniques include designing intelligent filters to flatten the frequency response and advanced filtering methods for multichannel systems.

#### Defenses against Replay Attacks
Several replay detection methods have been proposed, utilizing frequency-based features such as Linear Prediction Cepstral Coefficient (LPCC), Mel Frequency Cepstral Coefficient (MFCC), and others. Physical properties, such as body-surface vibration and sound localization, have also been leveraged to detect replay attacks. However, these methods often require special equipment or specific scenarios.

### Conclusion
In this paper, we propose a new modulated replay attack against ASR systems, which can bypass existing replay detection methods. We design an inverse filter to compensate for frequency distortion, making modulated replay signals similar to human voices. To counter this attack, we propose a dual-domain defense that checks audio signal features in both the frequency and time domains. Experiments show that our defense effectively defeats both modulated and classical replay attacks.

### Acknowledgments
This work is partially supported by the U.S. ARO grant W911NF-17-1-0447, U.S. ONR grants N00014-18-2893 and N00014-16-1-3214, and the NSFC grants U1736209 and 61572278. Jiahao Cao and Qi Li are the corresponding authors of this paper.

### References
[References listed as provided, with proper formatting and citations.]