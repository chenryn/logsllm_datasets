21  
22  
25  
26  
27 
32  
33  
bit map extended  
List of fields included in the message 
primary account number  
0x5A – 16-digit card account number 
processing code  
amount, transaction 
amount, reconciliation  
Constant 00 for goods and purchases 
0x9F02 – the transaction amount 
Transaction  amount  0x9F02  converted  into  the  currency  to  be  applied  to  the 
victim’s card, this value is calculated by the rogue POS terminal 
date and time, transmission  
Date and time the rogue POS transmits the transaction to the bank 
conversion rate, reconciliation 
Conversion  rate  for  the  reconciliation  amount,  calculated  by  the  rogue  POS 
terminal 
conversion rate, cardholder billing  
As above; this value is calculated by the rogue POS terminal 
systems trace audit number  
Transaction sequence number generated by the rogue POS terminal 
date, expiration  
date, conversion  
0x5F24 – Expiry date of the card (YYMM) 
Date / time of the currency conversion (same as 7) 
country code, acquiring institution 
Country code of the rogue POS terminal (e.g. 0826 for UK, 0840 for USA, 0036 
for Australia) 
country code, primary account number 
0x5F28 – Country code for the card i.e. 0826 – UK 
country code, forwarding institution 
0x5F28 – Country code for the bank that issued the card i.e. 0826 – UK 
point of service entry mode 
23  
card sequence number  
Type of POS terminal, constant value “051” for Chip & PIN / EMV contactless 
terminals 
0x5F34  –  Identifies  subsidiary  EMV  cards  issued  on  the  same  16-digit  account 
number 
 point of service condition code  
Constant “00” normal card presentment 
 point of service PIN capture code  
Constant “x8xx” indicates a POS terminal that accepts up to 8 digits 
approval code length  
Constant set by acquirer bank 
acquiring institution identification code 
Constant set by acquirer bank 
forwarding institution identification code 
34  
primary account number, extended  
Constant set by acquirer bank, indicates the institution that will provide the card 
payment clearing (steps 6 to 9 in Figure 2) 
Not  applicable  to  Visa  –  used  only  when  the  primary  account  number  begins 
with “59” 
39  
43  
49  
50  
51  
66  
action code (was response code)  
Constant “0xx” for financial transaction request messages 
card acceptor name/location  
Constant string name and location of the merchant 
currency code, transaction  
0x5F2A – Transaction currency code 
currency code, reconciliation  
Currency code for reconciliation, see item 5 
currency code, cardholder billing  
0x9F42 – Currency Code from the card. 
country code, receiving institution 
0x5F28 – Country code for the bank that issued the card i.e. 0826 – UK 
100  
receiving institution identification code  
Code that identifies victim’s bank – ISO 7812 
102  
account identification 1 
Information contained in 16-digit card account number 0x5A 
103 
account identification 2 
Information contained in 16-digit card account number 0x5A 
In the above table, data fields from the EMV card data are denoted by their EMV reference number e.g. 0x5A. 
9 
Table 3 shows the communication sequence required for the POS 
emulation to transmit a transaction to the acquirer bank. 
Table 3. POS / acquirer communication sequence 
Message 
financial presentment 
request message 
financial presentment 
response 
financial presentment 
confirmation 
From → 
To 
POS → 
Acquirer 
Acquirer 
→ POS 
POS → 
Acquirer 
Purpose 
Requests approval and 
money transfer by the 
acquirer 
Contains the answer to the 
request 
Confirms that the 
response was received 
7.  TEST RESULTS 
The  attack  software  has  been  tested  against  various  UK-issued 
credit  /  debit  cards.  Table  4  shows  the  vulnerability  of  several 
different card types. 
Table 4. Vulnerability of UK-issued contactless card types 
Card Type 
Max Value 
Comment 
Visa credit cards  
(UK currency) 
£85.00 
Visa credit cards 
(foreign currency) 
€999,999.99 
$999,999.99 
Visa debit cards 
(UK currency) 
Visa debit cards 
(foreign currency) 
£45.00 
€0.00 
$0.00 
MasterCard 
N/A 
Visa credit cards will 
approve multiple 
transactions until offline 
limit reached  
Visa credit cards will 
approve foreign currency 
transactions up to the 
maximum value possible 
in EMV 
Visa debit cards will 
approve multiple 
transactions until offline 
limit reached 
Visa debit cards decline 
foreign currency 
contactless transactions 
MasterCard is not 
affected by this attack as 
the cards request online 
completion of transactions 
in local currency and 
foreign currencies 
7.1  Transaction capture timings 
The  Android  transaction  capture  app  is  designed  to  operate  as 
quickly as possible, thereby reducing the risk of detection for the 
attacker.    The  software  automatically  collects  the  fraudulent 
transaction as soon as it detects a Visa contactless credit or debit 
card. Table 5 shows analysis of protocol timings from 20 captured 
fraudulent transactions. 
Table 5. Fraudulent transaction capture timings 
Statistics 
Time (in milliseconds) 
Average transaction duration (card 
discovery to transaction approval) 
Standard deviation 
Fastest transaction 
Slowest transaction 
478ms 
36ms 
452ms 
527ms 
8.  POTENTIAL SOLUTIONS 
The key weakness exploited in this paper is that Visa credit cards 
will  authorise  unlimited  value  transactions  in  a  foreign  currency.  
This  makes  the  attack  described  in  this  paper  both  scalable  and 
very lucrative. 
The  solution  is  relatively  simple.    This  can  be  done  by  changing 
future  Visa  credit  cards  to  implement  one  or  both  of  the 
following: 
the  cards  will  request  online  completion  of  contactless 
foreign currency transactions; making the transaction subject 
to the additional online verification steps. 
the cards will force “Chip & PIN” completion of all foreign 
currency  transactions;  this  will  eliminate  the  possibility  of 
high  value  transactions  without  the  added  security  of 
cardholder’s PIN. 
9.  CONCLUSION 
In  this  paper  we  have  demonstrated  that  it  is  possible  to  collect 
high  value  transactions  from  contactless  Visa  credit  cards  whilst 
the  card  is  still  in  the  victim’s  pocket.    The  attack  exploits  a 
previously  undocumented  flaw  in  the  cards,  in  which  the  cards 
will approve transactions of unlimited value in a foreign currency. 
Combined  with  the  lack  of  POS  terminal  authentication  and  the 
threat  of  contactless  payment  card  skimming,  this  vulnerability 
poses  a  real  risk  that  allows  high  value  fraudulent  transaction  to 
be harvested and converted into money. 
Our  experimental  results  show 
that 
implemented in the “real world” because: 
the  attack  could  be 
it takes less than 500milliseconds to collect a transaction 
  NFC enabled Android phones are cheap and readily available 
the phone looks innocent if the attacker is challenged by the 
police or a member of the public 
We have also outlined a scenario by which the captured fraudulent 
transactions could be exploited by a rogue merchant to access the 
money in the victim’s bank account.  The rogue merchant receives 
the  transactions  and  passes  them  off  as  genuine  transactions  to 
their bank.  It should be noted that although we have implemented 
the  rogue POS  terminal  software,  we  have  not  tested  it  against  a 
live acquirer transaction clearing system.  
From  this  we  can  conclude  that  this  attack  represents  a  plausible 
threat to contactless Visa credit cards.  We can also see that it can 
be easily remedied. 
We  have  proposed  two  simple  changes  in  the  operation  of  Visa 
credit  cards  that  would  eliminate  the  risk  posed  by  this  attack.  
Both  of  which  use  the  existing  functionality  of  the  cards  and 
would therefore be relatively inexpensive to implement. 
10.  ACKNOWLEDGMENTS 
Our thanks to Feng Hao and Dylan Clarke for proof reading some 
sections  of  this  paper.    The  work  presented  here  is  partly 
supported by the UK RCUK Social Inclusion through the Digital 
Economy  (SiDE)  EP/G066019/1  project  and  the  UK  EPSRC 
Cybercrime Network EP/K003410/1. 
10 
11.  REFERENCES 
[1]  Bond, M., Choudary, O., Murdoch, S.J., Skorobogatov, S., 
Anderson, R. 2014. Chip and Skim: cloning EMV cards with 
the pre-play attack. 35th IEEE Symposium on Security and 
Privacy. http://arxiv.org/pdf/1209.2531.pdf 
[2]  Cooper, D. and Barner, J. 2008. Tokeneer ID station EAL5 
demonstrator. Technical Report S.P1229.81.1, Altran Praxis. 
[3]  Drimer, S. and Murdoch, S.J. 2007. Keep Your Enemies 
Close: Distance Bounding Against Smartcard Relay Attacks. 
16th USENIX Security Symposium, Boston, MA, USA.  
http://www.cl.cam.ac.uk/~sjm217/papers/usenix07bounding.
pdf 
[4]  EMVCo. 2011. EMV Integrated Circuit Card Specifications 
for Payment Systems – Version 4.3.  
http://www.emvco.com/specifications.aspx?id=223 
[Accessed: 22 August 2014] 
[5]  EMVCo. 2014. EMV Contactless Specifications for Payment 
Systems – Version 2.4. 
http://www.emvco.com/specifications.aspx?id=21 
[Accessed: 22 August 2014] 
[6]  Francis, L., Hancke, G., Mayes, K., Markantonakis, K. 2012. 
Practical Relay Attack on Contactless Transactions by Using 
NFC Mobile Phones. The 2012 Workshop on RFID and IoT 
Security (RFIDsec 2012 Asia), Nai-Wei, L., Yingjiu, L. 
(editors).  Vol.  8, IOS Press (Cryptology and Information 
Security Series), pp. 21-32.  
http://eprint.iacr.org/2011/618.pdf 
[7]  Freitas, L. and Emms, M. 2014. Formal specification of 
EMV protocol. School of Computing Science Technical 
Report Series 1429, Newcastle University. 
[8]  International Organization for Standardization. 1995. ISO 
8583:1995 – Financial transaction card originated messages 
– Interchange message specifications. 
[9]  Murdoch, S.J., Drimer, S., Anderson, R., Bond, M. 2010. 
Chip and PIN is Broken. IEEE Symposium on Security and 
Privacy, pp. 433-446.  
http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=5
504801&isnumber=5504699 
[10] Reason, J. 1990. Human Error. Cambridge University Press. 
[11] Smans, J., Jacobs, B., and Piessens, F. 2013. VeriFast for 
Java: A Tutorial. In: Clarke, D., Noble, J., Wrigstad, T. (eds.) 
Aliasing in Object-Oriented Programming. LNCS, vol. 7850, 
pp. 407– 442. Springer, Heidelberg. 
[12] The UK Cards Association Limited. 2013. Standard 70 – 
Card Acceptor to Acquirer Interface Standards. 
[13] Woodcock, J. and Davies, J. 1998. Using Z. Prentice Hall. 
11