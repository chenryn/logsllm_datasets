### 0x00 简介
本文将基于官方版本的ThinkPHP 3.2.3框架进行介绍。请注意，以下内容为阅读须知部分。

### 0x01 下载与安装测试代码
- **下载地址**：请自行查找并下载ThinkPHP 3.2.3版本。
- **配置数据库路径**：在`test_thinkphp_3.2.3\Application\Common\Conf\config.php`文件中设置正确的数据库连接信息。
- **本地安装**：按照常规步骤完成安装后，请访问项目主页以确保没有错误提示出现。
- **开启调试模式**：为了便于本地测试，建议您打开`index.php`及`test_thinkphp_3.2.3\Application\Common\Conf\config.php`中的debug选项。

### 0x02 ThinkPHP 3.2 SQL注入演示
我们将重点展示`find()`方法中的SQL注入案例；对于`select()`和`delete()`方法，其利用方式类似。

### 0x03 注意事项
- 在本示例中使用了TP框架提供的`I`函数来获取输入数据。需要注意的是，默认情况下该函数会对传入值执行`htmlspecialchars`转义处理。
- 问题核心在于`_parseOptions($options)`方法内部进行了参数合并操作，并且最终未对这些组合后的参数进行二次验证，从而导致潜在的安全漏洞。
- 根据分析，在`Model.class.php`文件中存在六个可以被恶意利用的位置：
  - 当外部能够控制`delete()`方法的第一个参数时可能发生注入。
  - 类似地，如果`select()`或`find()`方法的第一个参数可被操控，则同样存在风险。
  - 对于`add()`、`addAll()`以及`save()`方法而言，当第二个参数受到外界影响时也需警惕注入攻击的可能性。

通过以上说明，希望读者能够更好地理解如何避免此类安全问题的发生。