### Content-Language 首部

`Content-Language` 首部不仅限于文本文档。音频片段、电影以及应用程序都有可能是面向特定语言受众的。任何面向特定语言受众的媒体类型都可以包含 `Content-Language` 首部。例如，在图16-8中，音频文件被标记为面向纳瓦霍语（Navajo）听众。

**示例：**
```
http://www.canyonrecords.com/wav/534.wav
HTTP/1.1 200 OK
Content-Type: audio/x-wav
Content-Length: 289772
Content-Language: i-navajo
```

**音频内容：**
```
00100101110100100101
01010010100111101001
01010101011100000101
01011111001000011...
```

**图16-8** `Content-Language` 首部将名为“Rain Song”（雨之歌）的音频片段标记为面向纳瓦霍语听众。

如果内容是面向多种语言受众的，可以列出多种语言。例如，一份同时用英语和毛利语编写的《怀唐伊条约》（Treaty of Waitangi）可以这样描述：
```
Content-Language: mi, en
```

然而，不能仅因为实体中出现多种语言就认为它是面向多种语言受众的。例如，一本为初学者编写的语言入门教材，如“A First Lesson in Latin”（拉丁语第一课），显然是为英语受众准备的，应当只用 `en` 来描述。

### Accept-Language 首部

大多数人至少懂一种语言。HTTP 允许我们在请求中发送语言偏好。如果服务器有多种语言版本的资源，它会返回我们首选的语言版本。此外，服务器还可以根据 `Accept-Language` 首部生成适合用户语言的动态内容，或选择适当的图像和商业促销。

**示例：**
客户端请求西班牙语内容：
```
Accept-Language: es
```

客户端可以在 `Accept-Language` 首部中枚举所支持的所有语言及其优先顺序（从左到右）。例如，客户端首选英语，但也接受瑞士德语（标准语言标记是 `de-CH`）或其他德语变种（标记是 `de`）：
```
Accept-Language: en, de-CH, de
```

客户端使用 `Accept-Language` 和 `Accept-Charset` 首部请求可理解的内容。第17章将详细讨论这些机制。

### 语言标记的类型

在 RFC 3066 “Tags for the Identification of Languages” 中记录了语言标记的标准语法。语言标记可以表示：

- 一般语言分类（如 `es` 代表西班牙语）
- 特定国家的语言（如 `en-GB` 代表英国英语）
- 语言的方言（如 `no-bok` 代表挪威书面语）
- 地区性语言（如 `sgn-US-MA` 代表美国马撒葡萄园岛上的手语）
- 标准化的非变种语言（如 `i-navajo`）
- 非标准的语言（如 `x-snowboarder-slang`）

### 子标记

语言标记由一个或多个部分组成，用连字符分隔，称为子标记：

- 第一个子标记称为主子标记，其值是标准化的。
- 第二个子标记是可选的，遵循自己的命名标准。
- 其他尾随的子标记都是未注册的。

主子标记只能包含字母（A-Z）。其后的子标记可以包含字母和数字，长度最多8个字符。图16-9展示了语言标记的子标记结构。

**图16-9** 语言标记被分隔为子标记

### 大小写

所有标记都是不区分大小写的。例如，`en` 和 `eN` 是等价的。但习惯上，一般的语言用全小写表示，而特定国家用全大写表示。例如，`fr` 表示所有法语，而 `FR` 表示法国。

### IANA 语言标记注册

第一个和第二个语言子标记的值由各种标准文档及相关的维护组织定义。IANA 依据 RFC 3066 中概述的规则管理标准语言标记列表。如果语言标记由标准的国家和语言值组成，则不需要专门注册。只有那些无法用标准值构成的语言标记才需要向 IANA 注册。

### 第一个子标记——名字空间

第一个子标记通常是标准化的语言记号，选自 ISO 639 中的语言标准集合。也可以用字母 `i` 来标识在 IANA 注册的名字，或用 `x` 表示私有的或扩展的名字。

- 如果第一个子标记包含2个字符，那就是来自 ISO 639 和 639-1 标准的语言代码。
- 如果包含3个字符，那就是来自 ISO 639-2 标准及其扩展的语言代码。
- 如果是字母 `i`，则该语言标记是在 IANA 显式注册的。
- 如果是字母 `x`，则该语言标记是私有的、非标准的或扩展的子标记。

### 第二个子标记——名字空间

第二个子标记通常是标准化的国家记号，选自 ISO 3166 中的国家代码和地区标准集合。也可以是在 IANA 注册过的其他字符串。

- 如果第二个子标记包含2个字符，那就是 ISO 3166 中定义的国家/地区。
- 如果包含3到8个字符，可能是在 IANA 注册的值。
- 单个字符是非法的。

### 其余子标记——名字空间

除了最长可以到8个字符（字母和数字）之外，第三个及其后的子标记没有特殊规则。

### 配置和语言有关的首选项

可以在浏览器的配置文件中设置与语言相关的首选项。例如，网景公司的 Navigator 的设置方法是：编辑→首选项→语言；微软公司的 Internet Explorer 浏览器的设置方法是：工具→Internet 选项→语言。

### 语言标记参考表

为了便于使用，附录 G 提供了语言标记的参考表：

- 表 G-1 列出了在 IANA 注册的语言标记。
- 表 G-2 列出了 ISO 639 中的语言代码。
- 表 G-3 列出了 ISO 3166 中的国家代码。

### 国际化的 URI

目前，URI 对国际化的支持仍然有限。除了少数例外，URI 仍主要由 US-ASCII 字符的一个子集组成。人们正在努力使主机名和 URL 路径中包含更多字符，但这些标准尚未广泛接受和部署。

#### 全球性的可转抄能力与有意义的字符的较量

URI 设计者希望全世界的人都能通过电子邮件、电话、公告板甚至无线电共享 URI。他们还希望 URI 容易使用和记忆，但这两个目标是相互冲突的。为了确保全球范围内的可输入性和共享性，URI 选择了常用字符的一个非常有限的子集（基本的拉丁字母表中的字母、数字和少数特殊符号）。然而，这种限制使得 URI 对许多人来说难以理解和记忆。

#### URI 字符集合

URI 中允许出现的 US-ASCII 字符的子集可以分为保留、未保留和转义字符几类。未保留的字符可用于 URI 允许其出现的任何部分。保留字符在许多 URI 中具有特殊含义，因此通常不能使用它们。表 16-7 列出了全部未保留、保留和转义字符。

| 字符类别 | 字符列表 |
| --- | --- |
| 未保留 | [A-Za-z0-9] | "-" | "_" | "." | "!" | "~" | "*" | "'" | "(" | ")" |
| 保留 | ";" | "/" | "?" | ":" | "@" | "&" | "=" | "+" | "$" | "," |
| 转义 | "%" |

#### 转义和反转义

URI 转义提供了一种安全的方式，可以在 URI 内部插入保留字符和原本不支持的字符（如空白）。每个转义是一组3字符序列，由百分号（%）后面跟两个十六进制数字的字符。这两个十六进制数字表示一个 US-ASCII 字符的代码。

例如，要在 URL 中插入一个空格（ASCII 32），可以用转义 `%20`，因为 20 是 32 的十六进制表示。类似地，如果想插入一个百分号且不想让它被视为转义，可以输入 `%25`，25 是百分号的 ASCII 代码的十六进制值。

**图16-10** 展示了 URI 中的概念性字符是如何转换为当前字符集中字符的代码字节的。处理 URI 时，转义会被反转义回来，产生它们代表的 ASCII 代码的字节。

| 概念性的字符 | 编码后的 URI 字节 | 反转义之后的 ASCII 代码字节 |
| --- | --- | --- |
| ... | ... | ... |
| o=111 | 111 | 111 |
| J=74 | 74 | 74 |
| o=111 | 111 | 111 |
| e=101 | 101 | 101 |
| s=115 | 115 | 115 |
| m=109 | 109 | 109 |
| a=97 | 97 | 97 |
| t=116 | 116 | 116 |
| / = 47 | 47 | 47 |
| S=83 | 83 | 83 |
| a=97 | 97 | 97 |
| l=108 | 108 | 108 |
| e=101 | 101 | 101 |
| B=66 | 66 | 66 |
| i=105 | 105 | 105 |
| g=103 | 103 | 103 |
| 5 = 53 | 53 | 53 |
| %=37 | 37 | 37 |
| 2 = 50 | 50 | 50 |
| 0 = 48 | 48 | 48 |
| s=115 | 115 | 115 |
| ... | ... | ... |

**外部形式** 输入和发送的内容 **处理的内容**
（电子邮件、网页、公告板、无线电） （用当前字符集） （用 US-ASCII 字符集）