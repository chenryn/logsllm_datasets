(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:1)(cid:41)(cid:45)(cid:34)(cid:45)(cid:43)
(cid:6)(cid:16)(cid:33)(cid:22)(cid:25)(cid:18)(cid:35)(cid:15)(cid:22)(cid:22)
(cid:31)(cid:20)(cid:24)(cid:22)(cid:25)(cid:18)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:30)(cid:28)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:3)(cid:9)(cid:6)(cid:10)(cid:1)(cid:16)(cid:21)(cid:8)(cid:5)(cid:1)(cid:14)(cid:23)(cid:11)(cid:17)(cid:22)
(cid:24)(cid:35)(cid:13)(cid:12)(cid:29)
(cid:10)(cid:19)(cid:16)(cid:1)(cid:20)(cid:24)(cid:20)(cid:29)(cid:20)(cid:12)(cid:22)(cid:1)(cid:13)(cid:12)(cid:14)(cid:21)(cid:15)(cid:25)(cid:25)(cid:27)(cid:1)(cid:31)(cid:19)(cid:20)(cid:14)(cid:19)(cid:1)
(cid:14)(cid:25)(cid:24)(cid:24)(cid:16)(cid:14)(cid:29)(cid:28)(cid:1)(cid:29)(cid:25)(cid:1)(cid:22)(cid:30)(cid:14)(cid:21)(cid:33)(cid:13)(cid:12)(cid:13)(cid:33)(cid:28)(cid:35)(cid:14)(cid:25)(cid:23)
(cid:11)(cid:12)(cid:27)(cid:20)(cid:25)(cid:30)(cid:28)(cid:1)(cid:20)(cid:24)(cid:17)(cid:25)(cid:28)(cid:29)(cid:16)(cid:12)(cid:22)(cid:16)(cid:27)(cid:28)
(cid:9)(cid:14)(cid:27)(cid:20)(cid:26)(cid:29)(cid:1)(cid:29)(cid:25)(cid:1)(cid:17)(cid:20)(cid:24)(cid:15)(cid:1)(cid:24)(cid:16)(cid:29)(cid:31)(cid:25)(cid:27)(cid:21)(cid:1)(cid:28)(cid:19)(cid:12)(cid:27)(cid:16)(cid:28)
(cid:3)(cid:9)(cid:6)(cid:10)(cid:1)(cid:16)(cid:22)(cid:8)(cid:5)(cid:1)(cid:15)(cid:20)(cid:11)(cid:16)(cid:15)
(cid:46)(cid:42)(cid:44)(cid:48)(cid:42)(cid:47)(cid:44)(cid:43)(cid:35)(cid:15)(cid:12)(cid:29)
(cid:3)(cid:12)(cid:28)(cid:20)(cid:14)(cid:1)(cid:13)(cid:12)(cid:14)(cid:21)(cid:15)(cid:25)(cid:25)(cid:27)
(cid:8)(cid:16)(cid:23)(cid:25)(cid:29)(cid:16)(cid:1)(cid:28)(cid:19)(cid:16)(cid:22)(cid:22)
(cid:2)(cid:9)(cid:4)(cid:9)(cid:7)(cid:8)(cid:1)(cid:23)(cid:8)(cid:5)(cid:1)(cid:14)(cid:23)(cid:11)(cid:17)(cid:19)
(cid:14)(cid:22)(cid:15)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:2)(cid:9)(cid:4)(cid:9)(cid:7)(cid:8)(cid:1)(cid:15)(cid:14)(cid:8)(cid:5)(cid:1)(cid:14)(cid:23)(cid:11)(cid:16)(cid:22)
(cid:2)(cid:9)(cid:4)(cid:9)(cid:7)(cid:8)(cid:1)(cid:15)(cid:16)(cid:8)(cid:5)(cid:1)(cid:15)(cid:15)(cid:11)(cid:14)(cid:23)
(cid:41)(cid:41)(cid:34)(cid:43)(cid:40)
(cid:41)(cid:41)(cid:34)(cid:45)(cid:43)
(cid:23)(cid:17)(cid:14)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:18)(cid:16)(cid:29)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:16)(cid:32)(cid:26)(cid:35)(cid:16)(cid:32)(cid:16)
(cid:23)(cid:28)(cid:17)(cid:35)(cid:15)(cid:12)(cid:29)
(cid:7)(cid:12)(cid:28)(cid:28)(cid:31)(cid:25)(cid:27)(cid:15)(cid:1)(cid:28)(cid:29)(cid:16)(cid:12)(cid:22)(cid:16)(cid:27)(cid:36)(cid:13)(cid:12)(cid:14)(cid:21)(cid:15)(cid:25)(cid:25)(cid:27)(cid:36)
(cid:15)(cid:25)(cid:31)(cid:24)(cid:22)(cid:25)(cid:12)(cid:15)(cid:16)(cid:27)
(cid:5)(cid:25)(cid:31)(cid:24)(cid:22)(cid:25)(cid:12)(cid:15)(cid:16)(cid:27)(cid:28)(cid:1)(cid:12)(cid:24)(cid:15)(cid:1)(cid:8)(cid:16)(cid:23)(cid:25)(cid:29)(cid:16)(cid:1)(cid:2)(cid:14)(cid:14)(cid:16)(cid:28)(cid:28)(cid:1)
(cid:10)(cid:25)(cid:25)(cid:22)(cid:28)(cid:1)(cid:37)(cid:8)(cid:2)(cid:10)(cid:9)(cid:38)
(cid:2)(cid:9)(cid:4)(cid:9)(cid:7)(cid:8)(cid:1)(cid:16)(cid:16)(cid:8)(cid:5)(cid:1)(cid:15)(cid:18)(cid:11)(cid:18)(cid:14)
(cid:22)(cid:25)(cid:14)(cid:12)(cid:22)(cid:28)(cid:26)(cid:22)(cid:35)(cid:15)(cid:22)(cid:22)
Fig. 2. Timeline of attack
2.3 Signs of a Growing Menace
In 2005, targeted attacks were observed by Symantec.cloud at the rate of one attack per
week, rising to one or two per day during 2006, to approximately 60 per day during
2010, and approximately 100 per day towards the end of 2011 [14]. From April 2008
to April 2012, about 96,000 targeted attack emails have been identiﬁed and recorded by
Symantec, with just under 30,000 of these being identiﬁed during 2011 alone. Figure 3
illustrates the growing trend in targeted attack activity over time by showing the average
number of attacks blocked by Symantec on a daily basis in 2011.
These ﬁgures must be interpreted in the context of the 500,000 malware and phish
emails that are detected each day by Symantec.cloud. Targeted attacks remain rare when
compared with non-targeted malware. However, it is this rarity that makes detection all
the more difﬁcult. Without large volumes of email to sample, it is not possible to collect
a corpus of such attacks containing enough samples to identify similarities between the
attacks.
Two targeted attacks, publicised over the last year, describe the capabilities of attack-
ers. Those are The Nitro Attacks [3] and The Rise of Taidoor [13]. The NITRO campaign
targets chemical and petroleum companies. The attackers do not employ sophisticated
exploits but instead rely on social engineering methods to trick victims into installing a
backdoor. E-mails sent to the victims contain a compressed, password protected archive.
The archive in turn contains a variant of Poison Ivy, a full featured RAT which gives
70
O. Thonnard et al.
200
150
100
50
0
Average nr of targeted attacks blocked per day
154.3
108.3
99.9 94.1
82.1
93.1
92.9
78.0
77.0
50.1
25.6 30.0
Jan Feb Mar Avr May Jun
Jul Aug Sep Oct Nov Dec
2011
Fig. 3. Average number of targeted attacks
an attacker complete control of compromised computers. Twenty nine companies in
the chemical industry were identiﬁed as being targeted and over 100 unique IPs were
compromised. The infections spanned multiple countries but were primarily located in
the United States of America. The ease with which the attackers compromised major
corporate entities demonstrates how serious such targeted attacks are.
The TAIDOOR attacks employ instead more sophisticated malware to compromise
victim computers. The victim industries vary, ranging from educational to think thanks.
Over 160 emails and more than 300 variants of this threat have been identiﬁed by
Symantec indicating the level of continuous effort required by the attackers.
2.4 Detecting Targeted Attacks
Targeted attacks can be identiﬁed by analysing emails containing malware which were
intercepted by Symantec.cloud’s email protection service. As explained in Section 2.1,
we identify a targeted attack as an email attack that meets a speciﬁc set of criteria. High
copy number malware containing emails, as evidenced by the malware or by the email
to which it is attached, are discarded. The low copy number attacks are analysed by
a semi-manual process to identify false positives, apparent prototypes for future high
copy number attacks, as well as low sophistication malware; all of these are discarded.
The remaining emails are manually screened to identify targeted malware containing
emails that exhibit a high degree of sophistication. These emails are logged and added
to the corpus of targeted attacks. The corpus of targeted attack emails almost certainly
includes some emails that may not be considered as targeted attacks according to other
criteria; equally there are almost certainly targeted attacks that should have been in-
cluded that have been omitted. Nevertheless, this corpus represents a large number of
sophisticated targeted attacks compiled according to a consistent set of criteria.
(cid:8)(cid:21)(cid:22)(cid:21)(cid:29)(cid:13)(cid:27)(cid:34)(cid:1)
(cid:39)(cid:48)(cid:1)
(cid:10)(cid:29)(cid:20)(cid:17)(cid:27)(cid:28)(cid:1)
(cid:43)(cid:48)(cid:1)
(cid:10)(cid:21)(cid:22)(cid:1)(cid:36)(cid:1)(cid:5)(cid:24)(cid:17)(cid:27)(cid:19)(cid:34)(cid:1)
(cid:41)(cid:48)(cid:1)
(cid:6)(cid:25)(cid:33)(cid:17)(cid:27)(cid:24)(cid:23)(cid:17)(cid:24)(cid:29)(cid:1)(cid:36)(cid:1)
(cid:4)(cid:21)(cid:26)(cid:22)(cid:25)(cid:23)(cid:13)(cid:30)(cid:15)(cid:1)
(cid:40)(cid:41)(cid:48)(cid:1)
(cid:2)(cid:17)(cid:27)(cid:25)(cid:28)(cid:26)(cid:13)(cid:15)(cid:17)(cid:1)
(cid:44)(cid:48)(cid:1)
(cid:9)(cid:6)(cid:10)(cid:1)
(cid:41)(cid:48)(cid:1)
(cid:3)(cid:20)(cid:17)(cid:23)(cid:21)(cid:15)(cid:13)(cid:22)(cid:1)
(cid:21)(cid:24)(cid:16)(cid:32)(cid:28)(cid:29)(cid:27)(cid:34)(cid:1)
(cid:44)(cid:48)(cid:1)
(cid:4)(cid:17)(cid:18)(cid:17)(cid:24)(cid:15)(cid:17)(cid:1)
(cid:21)(cid:24)(cid:16)(cid:32)(cid:28)(cid:29)(cid:27)(cid:34)(cid:1)
(cid:45)(cid:48)(cid:1)
(cid:11)(cid:17)(cid:27)(cid:33)(cid:21)(cid:15)(cid:17)(cid:28)(cid:1)(cid:13)(cid:24)(cid:16)(cid:1)
(cid:3)(cid:25)(cid:24)(cid:28)(cid:32)(cid:22)(cid:29)(cid:13)(cid:24)(cid:15)(cid:34)(cid:1)
(cid:39)(cid:38)(cid:48)(cid:1)
Industrial Espionage and Targeted Attacks
71
(cid:6)(cid:24)(cid:16)(cid:14)(cid:22)(cid:23)(cid:1)
(cid:32)(cid:38)(cid:1)
(cid:7)(cid:4)(cid:31)(cid:30)(cid:1)(cid:4)(cid:26)(cid:14)(cid:1)
(cid:29)(cid:38)(cid:1)
(cid:8)(cid:17)(cid:12)(cid:16)(cid:1)(cid:9)(cid:14)(cid:26)(cid:24)(cid:1)(cid:5)(cid:20)(cid:22)(cid:18)(cid:11)(cid:24)(cid:1)
(cid:29)(cid:33)(cid:38)(cid:1)
(cid:10)(cid:17)(cid:21)(cid:1)(cid:27)(cid:1)(cid:8)(cid:2)(cid:8)(cid:1)
(cid:30)(cid:34)(cid:38)(cid:1)
(cid:7)(cid:3)(cid:5)(cid:1)(cid:13)(cid:20)(cid:12)(cid:25)(cid:18)(cid:14)(cid:19)(cid:24)(cid:1)
(cid:31)(cid:33)(cid:38)(cid:1)
(cid:6)(cid:15)(cid:12)(cid:14)(cid:1)
(cid:29)(cid:35)(cid:38)(cid:1)
(cid:7)(cid:24)(cid:29)(cid:17)(cid:27)(cid:24)(cid:17)(cid:29)(cid:1)(cid:36)(cid:1)(cid:12)(cid:17)(cid:14)(cid:1)
(cid:28)(cid:17)(cid:27)(cid:33)(cid:21)(cid:15)(cid:17)(cid:28)(cid:1)
(cid:39)(cid:42)(cid:48)(cid:1)
Fig. 4. Left: Top targeted Sectors. Right: Most frequent document types seen as email attachments.
3 Experimental Dataset
For the rest of our analysis, we have focused on a corpus of 26,000 email attacks iden-
tiﬁed by Symantec.cloud during 2011 as targeted based on the set of criteria deﬁned
previously in Section 2. A subset of 18,580 attack samples were then selected in an
automated email parsing and ﬁltering phase based on additional criteria, such as a well-
formed and complete email header and body, a valid attachment, etc. Emails that could
not be parsed or decoded successfully were simply ignored for this analysis.
Emails written in a foreign language were automatically translated to English, to
facilitate the comparison of subject lines but also to understand the topics used by
the attackers. Every attachment was further analyzed in a Symantec dynamic analy-
sis platform (DAP) called RATS– the Response Auto-Analysis Threat System. RATS is
a dynamic analysis platform, which generates and warehouses meta-data on malicious
samples seen by Symantec. This meta-data is partially generated through Response-
owned data collection agents, as well as by leveraging wider data sources available to
Symantec (AV engines, CVE databases, etc). Dynamic data is collected through execut-
ing every sample in a sandbox environment and logging its activity on the ﬁle system
and on the network, allowing us to detect any network connection attempt to external
domains, which could possibly be linked to C&C activity. File parsers and other static
analysis tools extract ﬁle-level characteristics from the sample, such as document type
and the associated software application and version. Fig. 4 (right) shows for example
the distribution of document types seen as malicious attachments in our email dataset.
We can observe that malicious PDFs continue to be largely used in targeted attacks
(over 1/3rd of the attacks). However, malicious Zip and Rar archives start to be very
frequent too (27% of the attacks). Malicious documents exploiting some vulnerabil-
ity in Microsoft Ofﬁce have been used as droppers in about 18% of targeted attacks.
It is also worth noting that PE32 executable attached to emails are quite infrequent in
targeted attacks (only 1% of attacks).
All email recipients were also categorized into activity sectors, based on the informa-
tion we have on our customers as well as public information sources on the companies
72
O. Thonnard et al.
and their business. This allows us to get insights into the top targeted sectors, as shown
in Fig. 4 (left). Not surprisingly, we observe that the most frequently targeted organiza-
tions are in the Government & Diplomatic sector. Note that the Military sector does not
seem to be often targeted directly, but rather indirectly through employees of Defense
and Aerospace industries or Governmental institutions.
Finally, we have extracted a number of email characteristics (or features), which
we think are potentially relevant to correlate attacks, and ultimately identify series of
attacks that are likely originating from the same individuals, forming what we identify
as attack campaigns in Section 4. Some of those extracted features are:
Origin-Related Features: these are characteristics of the source of the attack, such
as the IP address the email was originating from, the country and ISP associated
to the origin IP, the mailer agent used to send the email (e.g., Microsoft Outlook
Express 6.00.x), and the email From address used by the sender.
Attack-Related Features: these are characteristics of the attack by itself. Examples
include the attachment MD5 and ﬁlename, the date of the attack, the subject line
and body of the email, the language of the message, the character set used to en-
code the email, the AV signature given for the malicious attachment (if any), and
the document type of the attachment.
Target-Related Features: these include characteristics of the targeted recipient, such
as the destination ﬁelds (To, Cc or Bcc address ﬁelds of the email), the activity
sector of the recipient’s organization, etc.
Regarding attackers’ IP addresses, most of them were located in large industrialized
countries, with no particular pattern or abnormal bias for speciﬁc countries, and we
have never seen botnets in use in the targeted attacks we could identify. With respect to
mailer agents, most of them were apparently reﬂecting real mail clients with a substan-
tial proportion of targeted attacks (over 45%) sent through popular Webmail providers.
Only in 11% of the attacks, the emails had a fake, randomly chosen Mailer agent, per-
haps as an attempt to fool certain ﬁlters.
4 Analysis of Targeted Attack Campaigns
4.1 Methodology
To identify series of targeted attacks (i.e., attack campaigns) that are likely performed
by the same individuals, we have used an advanced data analytics software framework
named TRIAGE. Originally developed in the context of the WOMBAT project3, TRIAGE
is an attack attribution software that relies on data fusion algorithms and multi-criteria
decision analysis (MCDA) [23,21,19]. This TRIAGE technology can automatically
cluster virtually any type of attacks or security events based upon common elements
(or features) that are likely due to the same root cause. As a result, TRIAGE can iden-
tify complex patterns within a data set, showing varying relationships among series of
attacks or groups of disparate events. Previous analyses of various threat landscapes
3 Worlwide Observatory of Malicious Behaviors and Threats.
http://www.wombat-project.eu/
Industrial Espionage and Targeted Attacks
73
RELATIONSHIPS
DATA FUSION
TARGETED ATTACKS
January 17, 2011
May 12, 2011
July 22, 2011
ORIGINS
From
IP Address
Mailer
AGGREGATION
MODEL
ATTACK
Attach MD5
Subject
Date
TARGET
To Address
BCC Address
Importance Factors,
Interactions
Fig. 5. Illustration of the TRIAGE methodology
[20,4,5] have demonstrated that TRIAGE can provide insights into the manner by which
attack campaigns are being orchestrated by cyber criminals, and more importantly, can
help an analyst understand the modus operandi of their presumed authors.
The TRIAGE approach, as used in this analysis, is represented in Figure 5. For each
targeted attack, a number of attack features were selected from the set of characteristics
extracted previously (see Section 3). In this speciﬁc analysis, we have selected the fol-
lowing features, which we believe could be relevant for linking attacks originating from
the same team of attackers: the MD5 hash and the fuzzy hash (as given by ssdeep [9])
of the email attachment, the origin IP address, the From address, the email subject, the
sending date, the targeted mailbox (To ﬁeld), the mailer agent, and the AV signature.
In the second step, TRIAGE builds relationships among attack samples with respect
to every selected attack feature by using appropriate similarity metrics [19]. In the ﬁnal
step, all feature similarities are fused using an aggregation model reﬂecting some high-
level behavior deﬁned by the analyst, e.g., at least k highly similar attack features (out
of n) are required to attribute different attack samples to the same campaign. In this