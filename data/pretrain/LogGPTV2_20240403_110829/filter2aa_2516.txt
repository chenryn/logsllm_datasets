HACKING TRAFFIC LIGHTS
DEFCON 2020
WHO ARE WE?
06/08/2020
HACKING TRAFFIC LIGHTS
• Wesley Neelen
• Hacker
• OSCP / OSCE
• 8+ years of experience
• Internet of Things security
• Rik van Duijn
• Hacker
• OSCP / OSCE
• 8+ years of experience
• Malware analysis
DISCLAIMER:  NO SMART TRAFFIC EXPERTS ☺. WE DO USE BICYCLES
@WESLEYNEELEN
@RIKVDUIJN
INTRODUCTION TO SMART TRAFFIC
06/08/2020
HACKING TRAFFIC LIGHTS
Creating a platform to exchange information:
• Road signs
• Parking status
• Traffic status
• Traffic light systems
• Road users
• Cyclist, cars, trucks, emergency vehicles ...
INTRODUCTION TO SMART TRAFFIC
06/08/2020
HACKING TRAFFIC LIGHTS
Creating a platform to exchange information:
• Road signs
• Parking status
• Traffic status
• Traffic light systems
• Road users
• Cyclist, cars, trucks, emergency vehicles ...
Our research focus
06/08/2020
HACKING TRAFFIC LIGHTS
FACTS & FIGURES
In the Netherlands:
• 17+ million citizens - 22.8 million bicycles
• 35,000 kilometres cycling infrastructure
06/08/2020
HACKING TRAFFIC LIGHTS
WAIT A MINUTE, YOU ARE LETTING ME TALK TO TRAFFIC LIGHTS?
ONGOING PARTNERSHIPS
06/08/2020
HACKING TRAFFIC LIGHTS
Goal:
• Safety
• Comfort
• Traffic flow
ONGOING PARTNERSHIPS
06/08/2020
HACKING TRAFFIC LIGHTS
Goal:
• Safety
• Comfort
• Traffic flow
Apps to connect:
• Cyclists, decreases the time to green
• Trucks, a green flow
• Emergency vehicles, instant green and notify others
ONGOING PARTNERSHIPS
06/08/2020
HACKING TRAFFIC LIGHTS
Goal:
• Safety
• Comfort
• Traffic flow
Apps to connect:
• Cyclists, decreases the time to green
• Trucks, a green flow
• Emergency vehicles, instant green and notify others
ONGOING PARTNERSHIPS
06/08/2020
HACKING TRAFFIC LIGHTS
Goal:
• Safety
• Comfort
• Traffic flow
Apps to connect:
• Cyclists, decreases the time to green
• Trucks, a green flow
• Emergency vehicles, instant green and notify others
ONGOING PARTNERSHIPS
06/08/2020
HACKING TRAFFIC LIGHTS
Goal:
• Safety
• Comfort
• Traffic flow
Apps to connect:
• Cyclists, decreases the time to green
• Trucks, a green flow
• Emergency vehicles, instant green and notify others
VRI’s are being replaced for iVRI’s (EN: TLC to iTLC)
• VRI controls all traffic lights at 1 intersection
• i for Intelligent  
• Currently: 513 across the Netherlands (5500 VRI’s total)
Image credit: https://en.wikipedia.org/wiki/Traffic_light_control_and_coordination
HOW ARE THINGS CONNECTED (SIMPLIFIED) ?
06/08/2020
HACKING TRAFFIC LIGHTS
WESLEY
CLOUD SERVICES
RIK
ERIK
THEO
ROAD USERS
(Current state. Future: e.g. car-to-car, 5G-enabled… :-s)
ETSI CAM OBJECTS
06/08/2020
HACKING TRAFFIC LIGHTS
• ETSI - European Telecommunications Standards Institute
• ITS Intelligent Transport Systems
• CAM – Cooperative Awareness Message (EU)
• BSM – Basic Safety Message (US)
ETSI CAM OBJECTS
06/08/2020
HACKING TRAFFIC LIGHTS
• Contents
• Basic Container
• Position
• Station type*
• HF Container
• High speed data 
• Speed
• Yaw
• etc
• LF Container
• Static / slow changing data
• Lights
• Path history
Image credit: ETSI (https://www.etsi.org/deliver/etsi_en/302600_302699/30263702/01.03.01_30/en_30263702v010301v.pdf) 
06/08/2020
HACKING TRAFFIC LIGHTS
Image credit: ETSI (https://www.etsi.org/deliver/etsi_ts/102900_102999/102940/01.03.01_60/ts_102940v010301p.pdf) 
ITS SECURITY 
06/08/2020
HACKING TRAFFIC LIGHTS
• Standard describes signing messages
• CAM has a station type 
• Certificate contains SSP and ITS-AID
• Intelligent Transport System Application ID
• Describes basic permissions
• Service Specific Permissions
• Describes specific permissions such as:
• Emergency container
• Dangerous good container
An incoming signed CAM is accepted by the receiver if the certificate is valid 
and the CAM is consistent with  the ITS-AID and SSP in its certificate. 
Image credit: ETSI (https://www.etsi.org/deliver/etsi_ts/102900_102999/102940/01.03.01_60/ts_102940v010301p.pdf) 
ITS SECURITY 
06/08/2020
HACKING TRAFFIC LIGHTS
• Security Standards exists
• Implementation requires a central certificate authority and infrastructure
• Even then it might be good to monitor the messages sent across infrastructure. 
• There are research trying to detect abuse: https://github.com/josephkamel/F2MD
Image credits: (https://docbox.etsi.org/Workshop/2019/201903_ITSWS/SESSION02/SYSTEMX_KAISER.pdf) 
and (https://github.com/josephkamel/F2MD)
REAL LIFE IMPLEMENTATION 1 –VIEWING CAM
06/08/2020
HACKING TRAFFIC LIGHTS
• Android application for cyclists
• Decompiled: CAM objects over MQTT
• Hard time imitating: ASN and Protobuf
• Let’s use (for the first time) ☺:
• Hooked the CAM publisher function:
value basicContainer ::= {
stationType cyclist,
referencePosition {
latitude 51xxxxx,
longitude 50xxxxx,
positionConfidenceEllipse {
semiMajorConfidence unavailable,
semiMinorConfidence unavailable,
semiMajorOrientation unavailable
},
altitude {
altitudeValue 4000,
altitudeConfidence unavailable
}
}
}
REAL LIFE IMPLEMENTATION 1 –MODIFYING CAM
HACKING TRAFFIC LIGHTS 06/08/2020
REAL LIFE IMPLEMENTATION 1 –MULTIPLE CYCLISTS 
06/08/2020
HACKING TRAFFIC LIGHTS
Every new MQTT connection seen as a new cyclist:
REAL LIFE IMPLEMENTATION -2
06/08/2020
HACKING TRAFFIC LIGHTS
• Android application for cyclists
• Burp suite -> POST requests with position
• Backend converting our input to CAM?
• No way to distinguish cyclists (no auth)
[{"heading":,"latitude":,"longitude":,"speed":}]
HACKING TRAFFIC LIGHTS 06/08/2020
HACKING TRAFFIC LIGHTS 06/08/2020
WHAT COULD GO 
WRONG?
HACKING TRAFFIC LIGHTS 06/08/2020
CONCLUSION
06/08/2020
HACKING TRAFFIC LIGHTS
KEY ISSUE: No Signing 
Despite specification in ETSI standard.
Allows to:
• Remotely influence a cycling traffic light;
• Or all cycling lights in a city at once;
• Imitate cyclists only (for now)
CONCLUSION
06/08/2020
HACKING TRAFFIC LIGHTS
KEY ISSUE: No Signing 
Despite specification in ETSI standard.
Allows to:
• Remotely influence a cycling traffic light;
• Or all cycling lights in a city at once;
• Imitate cyclists only (for now)
Impact:
• Limited: safety systems stay intact (no accidents)
• Causing annoyance due to unnecessary red light
• Funny, however: annoyance by red lights can lead to road rage
Ongoing: responsible disclosure process 
CONCLUSION
06/08/2020
HACKING TRAFFIC LIGHTS
KEY ISSUE: No Signing 
Despite specification in ETSI standard.
Allows to:
• Remotely influence a cycling traffic light;
• Or all cycling lights in a city at once;
• Imitate cyclists only (for now)
Impact:
• Limited: safety systems stay intact (no accidents)
• Causing annoyance due to unnecessary red light
• Funny, however: annoyance by red lights can lead to road rage
Ongoing: responsible disclosure process 
FOUNDATION FOR THE FUTURE
TO IMPLEMENT THIS  CORRECTLY
WE ONLY GET ONE CHANCE
RECOMMENDATIONS
1. Implement some form of 
authentication
2. Monitor unexpected / implausible 
behavior at the backend
3. Block abuse
HACKING TRAFFIC LIGHTS 06/08/2020
06/08/2020
HACKING TRAFFIC LIGHTS
Q&A
@WESLEYNEELEN
@RIKVDUIJN
Or contact us directly:
Thursday, August 6th, 2020
13:30 - 14:00 (Pacific Time)