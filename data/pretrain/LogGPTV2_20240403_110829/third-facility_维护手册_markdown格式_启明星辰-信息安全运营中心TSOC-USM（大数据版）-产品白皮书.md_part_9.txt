> 、Web Service 等等。
>
> 系统的安全管理中心自带日志采集功能，同时也支持在用户网络中分布式部署多个日志
> 采集器，就近采集管理对象的日志信息， 并进行日志的范式化、分类、
> 过滤和归并，然后汇
> 聚到管理中心，从而实现对分散管理对象的日志采集，并有效降低网络中日志流的带宽占用。
> []{#_bookmark48 .anchor}**4.5.2** 详尽的日志范化、分类与全文索引
>
> 系统对收集的各种日志进行范式化处理，将各种不同表达方式的日志转换成的统一的描
> 述形式。分析人员不必再去熟悉不同厂商不同的日志信息，从而大大提升分析和审计工作效
>
> 率。系统提供的范式化字段包括日志接收时间
> 、日志产生时间、日志持续时间、用户名称、 源地址、源 MAC
> 地址、源端口、操作、目的地址 、目的 MAC 地址、目的端口、日志的事
> 件名称、摘要、等级、原始等级、原始类型、网络协议、网络应用协议、设备地址、设备名
> 称、设备类型等，除此之外系统还提供多个备用字段，
> 供高级日志分析人员分析时使用，字
> 段数量超过六十余个，并且可以根据安全管理人员的需要进行数量扩展，提供更强大的日志
> 描述信息，使范式化后的日志详尽而易读，更能满足复杂的多维度统计分析和审计要求。启
> 明星辰的安全技术人员还根据最佳实践和相关技术标准对每种日志进行了手工分类和分析
> 工作，加入了日志类型字段，丰富了日志所蕴含的信息量，让枯燥的日志信息变的更可理解。
>
> 与此同时，系统将原始日志都原封不动的保存了下来，
> 以备调查取证之用。安全分析人 员也可以直接对原始日志进行全文检索。
>
> 系统对格式化的日志数据进行索引，
> 同时采用多样并具有弹性的词元收集方法，对原始 日志文本全文进行分词，
> 并对提取的词元进行索引，供后期搜索使用，实现对格式化字段和
> 全文的索引。全文索引不限定原始日志的数据格式，可针对采集的异构的日志进行自动化分
> 析， 即使系统没有对采集的日志进行范式化描述， 通过全文索引技术，
> 系统依然可以为安全 分析人员提供一个灵活方便的分析工具，
> 大大提高使用系统的灵活便利性。
>
> **4.5.3** 灵活强大的交互式安全分析
>
> []{#_bookmark49 .anchor}**4.5.3.1** 基于策略的安全事件分析
>
> 用户可以通过丰富的事件分析策略对全网的安全事件进行全方位、多视角、大跨度、细
> 粒度的实时监测、统计分析、查询、调查、追溯、地图定位、可视化分析展示等等。每条事
> 件分析策略就像是地图的图层，或者是 Photoshop
> 的滤镜，只展现出用户关心的信息，帮助
> 用户快速从海量事件中筛选出重要的事件。借助这种分析过程，用户从传统的"条件编辑"
> 式的分析体验转变为"策略选取"式的分析体验， 大大提升分析效率。
>
> 安全分析师进行日常分析时，可将分析过程中选择的条件组合保存为策略，这样以后需
> 要做类似分析时就可以直接选择该策略，
> 提高了分析效率。系统内置了策略库供用户选择，
> 用户也可以分析策略进行再编辑和保存，包括定义筛选的机制和展示的方式。不同的事件分
> 析策略可以任意组合成为仪表板视图，在系统工作台中予以集中展示。
>
> **4.5.3.2** 交互式查询
>
> 系统使用了大数据交互式查询技术，满足安全分析师的日常工作需要。安全分析师可以
> 通过自定义的仪表盘与系统所存储的所有日志进行交互，
> 实时显示查询到的数据， 查询时间
> 缩短到秒级。系统支持任意嵌套查询，并可随意回退，
> 通过仪表板可视化处理数据，真正做
> 到所见即所查。系统可将查询条件保存为策略，支持策略的导入导出，
> 供后期使用，为安全
> 分析工作提供便利。安全分析师通过仪表板可任意选择需要显示的字段和信息，并可对查询
> 结果随时进行统计分析、可视化分析，包括地理定位、多维分析、 TopN
> 分析，支持关键字
> 和正则表达式的全文检索。系统的交互式分析功能为安全审计和分析人员在进行安全事件调
> 查和威胁分析时提供了一个强有力的武器。
>
> **4.5.3.3** 事件混合检索技术
>
> 传统的安全事件分析技术主要包括两种常见的方式，一种方式是日志进行范式化描述，
> 转化成标准化的统一格式后基于标准化字段进行审计。这种审计的能力主要局限于范式化字
> 段的多少，在范式化过程中字段数据越多从日志中提取的信息就越多，
> 审计能力就越强。对
> 初级使用者来说非常方便，但它存在的问题是对范式化能力要求高，需要审计人员可以根据
> 需要修改范式化脚本或者需要长时间的积累。这种产品的代表有上一代泰合信息安全审计系
> 统和 HP 公司的 ArcSight
> 等；另一种方式是对采集的原始日志不进行范化，直接对原始日志
> 进行保存，同时做一些全文索引，形成日志数据仓库。高级安全审计员可根据自己的需要进
> 行搜索和查找，并在此基础上进行人工分析。这种方式的特点是非常灵活，
> 它为水平较高的
> 安全审计人员提供了一个数据分析平台。安全审计员可以根据自己的审计需要随意进行查询
> 并统计，但它的最大的不足是对日志审计人员的专业技术水平要求非常高，受限于资金和人
> 力的投入，一般组织很难招募到优秀的高水平分析师，所以这类数据搜索工具很难为组织的
> 安全审计提供有效帮助。这样的产品的典型代表为Splunk。
>
> 基于以上日志审计的两种方式，
> 系统提供的混合检索技术属于交互式分析技术。它完全
> 融合了两种日志审计方式的优点，它的特点就是不仅提供了基于范式化后的格式数据内容的
> 实时关联分析和统计报表，同时还提供强大的全文搜索能力。混合式检索技术包括通过对范
> 化后的字段值进行全部日志记录的搜索， 其功能完全等同于传统关系库中的SQL
> 查询，查 询出包含搜索值的所有的日志记录， 并分行显示。同时，
> 支持全文检索技术，它不局限于几 种或几十种固定的字段，
> 不需要指定数据的格式， 可以结合时间与关键词进行搜索，实时展
>
> 现搜索结果，并对关键字进行高亮显示， 使用上就和 Google
> 一样直观易用，用户可以输入
> 关键词或正则表达式进行任意搜索，提供即时的在线查询，立即产生长时期结果；采用交互
> 式对比查询，可以逐渐收敛事件范围；可以用事件、关键词和复杂流程拼接关联事件。
>
> []{#_bookmark50 .anchor}**4.5.4** 智能化安全事件关联分析
>
> 智能化的安全事件分析主要透过智能化的安全事件关联分析来体现。事件关联是指找出
> 大量事件中存在的关系，并从这些大量事件中抽取出真正重要的少量事件。借助先进的智能
> 事件关联分析引擎，
> 系统能够实时不间断地对所有范式化后的日志流进行安全事件关联分
> 析。系统为分析师提供了三种事件关联分析技术，
> 分别是：基于规则的关联分析、基于情境 的关联分析和基于行为的关联分析。
>
> **4.5.4.1** 基于规则的关联分析
>
> 基于规则的关联分析是指系统通过事件关联引擎进行规则匹配，识别已知模式的攻击
> 和违规的过程，
> 属于最经典和传统的一种关联分析技术。基于规则的关联分析核心在于规
> 则的编写。
>
> 系统提供了可视化的规则编辑器，用户可以定义基于逻辑表达式和统计条件的关联规
> 则，所有日志字段都可参与关联。
>
> 规则的逻辑表达式支持等于、不等于、大于、小于、不大于、不小于、位于„„之
> 间、属于、包含、Follow By 等运算符和关键字。
>
> 规则支持统计计数功能，
> 并可以指定在统计时的固定和变动的事件属性，可以关联出
> 达到一定统计规则的事件。
>
> 系统支持建立单事件规则和多事件规则， 实现单事件关联和多事件关联：
>
> ![](media/image83.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"} 单事件关联：通过单事件关联，
> 系统可以对符合单一规则的事件流进行规则匹 配；
>
> ![](media/image84.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"} 多事件关联：通过多事件关联，
> 系统可以对符合多个规则(称作组合规则) 的事件 流进行复杂事件规则匹配。
>
> 系统支持实时关联和历史关联：
>
> ![](media/image85.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"} 实时关联：
> 对当前正在发生的事件进行规则关联分析；
>
> ![](media/image86.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"} 历史关联：
> 对已经发生的事件进行规则关联分析。
>
> 系统支持长周期关联和短周期关联：
>
> ![](media/image87.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 短周期关联：通过关联分析引擎对事件窗口内的实时事件进行规则关联分析；
>
> ![](media/image88.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 长周期关联：通过观察列表结合关联分析引擎和规则，对长周期事件进行规则关
> 联分析；
>
> 系统通过提供
> "观察列表"实现了长周期和短周期事件的关联分析和基于事件或会
> 话状态的关联分析功能。传统的关联分析引擎受限于事件窗口的大小，
> 无法关联长期事
> 件，借助于观察列表和规则，可将符合规则的事件保存至观察列表中，
> 可进一步分析， 观 察列表可根据需要长期或动态保存。
>
> **4.5.4.2** 基于情境的关联分析
>
> 基于情境(Context)
> 的关联分析是指将安全事件与当前网络和业务的实际运行环境进
> 行关联，透过更广泛的信息相关性分析，
> 识别安全威胁。这种技术也被称作"情境感知" (Context-Aware)。
>
> 简单地说，情境关联就是在分析安全事件的时候，
> 不仅考察被分析的事件本身， 还要考
> 虑到事件的上下文相关信息，例如一个事件表示了一个源 IP 攻击了一个目的
> IP，那么，我 们不禁会问，这个目的 IP 是什么资产？它重要吗？
> 是什么操作系统？有什么漏洞？ 开放了 什么端口？
> 开放的端口是否正好是攻击被利用的端口？这些 IP 之间的拓扑关系如何？这个
> 攻击源 IP
> 是来自个人黑客还是有组织犯罪团伙，抑或敌对势力？这就是情境分析。
>
> 系统支持多种基于情境的关联分析：
>
> ![](media/image89.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 基于资产的情境关联：分析师可以将事件中的 IP
> 地址与资产名称、资产价值、资
> 产类型(包括自定义类型)、自定义资产标签进行关联；
>
> ![](media/image90.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 基于弱点的情境关联：将安全事件与该事件所针对的目标资产当前具有的漏洞信
> 息进行关联，包括端口关联和漏洞编号关联；
>
> ![](media/image91.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 基于威胁情报的情境关联：将安全事件与来自外部或内部的威胁情报信息进行关
> 联；
>
> ![](media/image92.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 基于网络告警的情境关联：将安全事件与该事件所针对的目标资产(或发起的源资
> 产)当前发生的告警信息以及当前的网络告警信息进行关联；
>
> ![](media/image95.png){width="8.4919072615923e-2in"