### 4.5.2 详尽的日志范式化、分类与全文索引

系统具备强大的日志处理能力，能够对收集到的各种日志进行范式化处理，将不同厂商和设备生成的日志转换为统一的格式。这一过程不仅简化了分析人员的工作流程，还显著提升了工作效率。范式化字段涵盖日志接收时间、产生时间、持续时间、用户名称、源地址及MAC地址、源端口、操作类型、目的地址及其MAC地址、目的端口、事件名称、摘要、严重等级、原始等级、原始类型、网络协议、应用层协议、设备地址、设备名称与类型等信息。此外，系统还提供了多个备用字段供高级分析人员使用，字段总数超过六十个，并且可以根据安全管理人员的具体需求进行扩展，进一步增强日志描述的详尽性和易读性。

启明星辰的安全专家根据最佳实践和技术标准对手动分类和分析每种日志进行了细致的工作，增加了日志类型字段，丰富了日志的信息量，使得原本枯燥无味的日志变得更加易于理解和分析。同时，所有原始日志均被完整保存下来以备调查取证之用，安全分析师也可以直接对这些未加工的数据执行全文检索。

为了方便后续的数据挖掘，系统不仅对格式化的日志数据建立了索引，还采用了灵活多样的分词技术来处理原始日志文本，并对提取出的关键字建立索引。这种设计既支持结构化数据的高效查询，也能满足非结构化数据的全文搜索需求，即使没有经过范式化处理的日志，也能通过全文索引技术得到有效利用，从而为用户提供了一个更加便捷高效的分析工具。

### 4.5.3 灵活强大的交互式安全分析

#### 4.5.3.1 基于策略的安全事件分析

该功能允许用户定义多种事件分析策略，以便从全局视角出发，对整个网络中的安全事件进行全面而深入的监测与分析。每个策略就像是一张地图上的图层或Photoshop中的滤镜，只展示用户感兴趣的信息，帮助他们迅速定位关键事件。这种方式改变了传统的“条件编辑”模式，转而采用“策略选取”的方式来进行数据分析，极大地提高了效率。

在日常工作中，安全分析师可以将常用的条件组合保存为策略模板，以后遇到类似情况时可以直接调用，节省大量时间。系统内置了丰富的策略库供选择，同时也支持自定义策略的创建与修改，包括筛选机制和结果展示形式的设计。不同的策略还可以组合成仪表板视图，在工作台上集中呈现，便于管理和查看。

#### 4.5.3.2 交互式查询

借助先进的大数据交互式查询技术，系统能够满足安全分析师的各种查询需求。分析师可以通过定制化的仪表盘与存储的所有日志进行实时互动，查询响应时间缩短至秒级。系统支持任意深度的嵌套查询，并能随时回退至先前状态；同时提供可视化界面用于数据展示，真正做到所见即所得。查询条件可保存为策略文件，方便日后重复使用。此外，分析师还能自由选择显示哪些字段，并对查询结果进行统计分析、地理定位、多维度对比以及Top N排名等多种类型的可视化处理，进一步增强了系统的实用性和灵活性。

#### 4.5.3.3 事件混合检索技术

传统的安全事件分析方法主要有两种：一是通过对日志进行范式化处理后基于标准化字段进行审计；二是直接保存原始日志并建立全文索引数据库。前者依赖于预定义的字段数量，后者则需要高水平的专业知识才能有效运用。本系统结合了这两种方法的优点，既支持基于范式化字段的实时关联分析和报表生成，也具备强大的全文搜索功能。用户可以通过简单的关键词输入或正则表达式匹配来快速查找相关信息，实现即时在线查询与长期趋势分析相结合的效果。

### 4.5.4 智能化安全事件关联分析

#### 4.5.4.1 基于规则的关联分析

基于规则的关联分析是一种经典的事件处理方法，它通过预先设定好的逻辑表达式和统计条件来识别已知模式的攻击行为。系统配备了直观易用的规则编辑器，允许用户灵活定义各种复杂的关联规则。支持的操作符包括但不限于等于、不等于、大于、小于等基本运算符以及更高级别的“位于...之间”、“属于”、“包含”等复合判断语句。此外，还具有统计计数功能，可用于检测符合特定频率或阈值要求的异常活动。

#### 4.5.4.2 基于情境的关联分析

情境感知是另一种重要的事件关联技术，它强调在分析过程中不仅要关注单个事件本身，还要综合考虑其发生的上下文环境因素。例如，当检测到某个源IP正在攻击目标IP时，系统会自动搜集关于这两个IP的相关背景资料（如资产重要性、操作系统版本、开放端口等），从而更准确地评估潜在威胁。具体应用场景包括但不限于资产价值评估、漏洞扫描结果整合、威胁情报共享以及网络告警信息联动等方面。