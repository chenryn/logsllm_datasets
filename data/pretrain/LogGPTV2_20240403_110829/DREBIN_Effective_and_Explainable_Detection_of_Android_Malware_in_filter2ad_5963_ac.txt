### Detection Performance and Comparison

In this section, we compare DREBIN's detection performance with other methods: Kirin [?], RPC [?], and the approach by Peng et al. [?]. For the latter, we implemented a support vector machine (SVM) instead of a basic Naive Bayes classifier. The results of these experiments are presented in Figure 3 as ROC curves, which plot the true-positive rate (detection of malware) against the false-positive rate (number of false alarms) for different thresholds.

**Figure 3: Detection Performance of DREBIN and Related Approaches**

DREBIN significantly outperforms the other approaches, detecting 93% of malware samples at a false-positive rate of 1%, corresponding to one false alarm per 100 applications installed. In contrast, the other approaches achieve detection rates between 10%â€“50% at the same false-positive rate. Kirin and RPC, which consider only a subset of requested permissions, have inherent limitations in detecting malicious applications. Even the method by Peng et al., which considers all permissions, falls short compared to DREBIN.

### Malware Families in the Dataset

Table 1 lists the top 20 malware families in our dataset, along with the number of occurrences for each family. These family names are derived from the labels provided by the Kaspersky AV scanner.

| **Id** | **Family**       | **#** |
|--------|------------------|-------|
| A      | FakeInstaller    | 925   |
| B      | DroidKungFu     | 667   |
| C      | Plankton         | 625   |
| D      | Opfake           | 613   |
| E      | GingerMaster     | 339   |
| F      | BaseBridge       | 330   |
| G      | Iconosys         | 152   |
| H      | Kmin             | 147   |
| I      | FakeDoc          | 132   |
| J      | Geinimi          | 92    |
| K      | Adrd             | 91    |
| L      | DroidDream       | 81    |
| M      | LinuxLotoor      | 70    |
| N      | GoldDream        | 69    |
| O      | MobileTx         | 69    |
| P      | FakeRun          | 69    |
| Q      | SendPay          | 61    |
| R      | Gappusin         | 59    |
| S      | Imlog            | 58    |
| T      | SMSreg           | 43    |

**Table 1: Top 20 Malware Families in Our Dataset and Their Occurrences**

### Detection Performance by Malware Family

Given that some malware families are more prevalent than others, we evaluate DREBIN's detection performance separately for the 20 largest malware families. The detection performance for each family is illustrated in Figure 4(b).

**Figure 4: Detection Performance of DREBIN and Related Approaches**

- **(a)** Detection performance as ROC curve.
- **(b)** Detection performance per malware family.
- **(c)** Top malware families in our dataset.

DREBIN reliably detects all families with an average accuracy of 93% at a false-positive rate of 1%. Specifically, all families show a detection rate of more than 90%, with three families (H, O, P) achieving perfect detection. The only family that cannot be reliably detected is Gappusin (R), which will be examined in detail in the next section. Notably, there appears to be no correlation between the size of a malware family and its detection rate, as long as the number of samples is sufficient for the SVM to generalize the features.

### Detection of Unknown Malware Families

DREBIN uses known malware for learning its detection model. To assess how many samples of a family are needed for reliable detection, we conducted two additional experiments:

1. **No Samples Available**: We provided no samples of the family, simulating a completely unknown malware strain.
2. **Limited Samples Available**: We included 10 randomly chosen samples of the family in the training set, simulating the initial spread of a new family.

**Figure 5: Detection Rate with 0 and 10 Available Samples in the Training Set**

- With no samples available, DREBIN struggles to detect the family due to the lack of discriminative patterns.
- With just 10 samples, the average detection performance increases by more than 25 percent, and three families can even be detected perfectly.

### Summary

DREBIN provides effective detection of Android malware, outperforming related detection approaches and several anti-virus scanners. While DREBIN cannot immediately detect entirely unknown malware, it requires only a few samples to achieve reliable detection. Our dataset includes 1,227 further malicious samples beyond the top 20 families.

### Explanations

#### 1. Explanation for Malware Families

To understand the explanations provided by DREBIN, we analyzed four well-known malware families: FakeInstaller, GoldDream, GingerMaster, and DroidKungFu. For each sample, we determined the features with the highest contribution to the classification decision and averaged the results over all members of a family.

**Table III: Top Features for the Malware Families**

| **Malware Family** | **Top 5 Features**                                                                                   | **Feature Set**                        | **Weight \( w_s \)** |
|--------------------|------------------------------------------------------------------------------------------------------|----------------------------------------|----------------------|
| FakeInstaller      | sendSMS, SEND_SMS, android.hardware.telephony, sendTextMessage, READ_PHONE_STATE                    | S7, S2, S1, S5, S2                    | 1.12, 0.84, 0.57, 0.52, 0.50 |
| DroidKungFu       | system/bin/su, BATTERY_CHANGED_ACTION, READ_PHONE_STATE, getSubscriberId, SIG_STR                  | S7, S4, S2, S7, S4                    | 2.02, 1.30, 1.26, 0.54, 0.49 |
| GoldDream         | Telephony.SMS_RECEIVED, lebar.gicp.net, DELETE_PACKAGES, android.provider.Telephony.SMS_RECEIVED, getSubscriberId | S7, S8, S7, S2, S7                    | 1.07, 0.93, 0.58, 0.56, 0.53 |
| GingerMaster      | USER_PRESENT, getSubscriberId, READ_PHONE_STATE, system/bin/su, HttpPost                          | S4, S7, S2, S7, S7                    | 0.67, 0.64, 0.55, 0.44, 0.38 |

#### 2. False and Missing Detections

We also examined benign applications misclassified as malware by DREBIN. These samples often use SMS functionality and access sensitive data, leading to high weights for the corresponding features. Additionally, they may exhibit very little benign behavior, triggering false alarms. DREBIN's ability to provide explainable results helps users determine whether suspicious functionalities are genuinely malicious or necessary for the application's intended purpose.

For the Gappusin family, DREBIN classifies samples as benign despite matching some features. This is because Gappusin primarily acts as a downloader for further malicious applications and does not exhibit common malicious behaviors like data theft.

### Run-time Performance

DREBIN achieves a remarkable analysis performance of 750 ms per application, enabling the scanning of 100,000 applications in less than a day on a Core 2 Duo with 4GB RAM. While mobile device computing power is increasing, DREBIN's efficiency makes it suitable for real-world deployment.