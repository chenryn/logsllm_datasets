oSy列显示了内核进程消耗的CPU时间百分比。Sy的值较高时，说明内核消耗的
ous列显示了用户进程消耗的CPU 时间百分比。us 的值比较高时，说明用户进程
FULL显示前三参数的所有信息。它们可以单独使用或者一起使用。
显示网络接口信息，EDEV显示网络错误的统计数据，SOCK显示套接字信息，
-n，显示网络运行状态。参数后面可跟DEV、EDEV、SOCK和FULL。DEV
-V，显示进程、文件、节点和锁表状态。
-b，
0
-d，
-u，
sar命令
器的带宽瓶颈（主要是块操作）造成的。
起I/O等待的原因可能是磁盘大量随机读写造成的，也可能是磁盘或者磁盘控制
重。根据经验，wa的参考值为20%，如果wa超过20%，说明I/O等待严重。引
wa列显示了IO等待所占用的CPU时间百分比。wa值越高，说明I/O等待越严
消耗的CPU时间多，但是如果长期大于50%，就需要考虑优化程序或算法。
第4篇运维监控与性能优化篇
www.Linuxidc.com
显示缓冲区在采样时间内的使用情况。
显示系统内存在采样时间内的使用状况。
显示系统所有硬盘设备在采样时间内的使用状况。
显示当前系统中指定CPU的使用情况。
显示系统所有CPU在采样时间内的负载状态。
[interva]
[count]]
---
## Page 275
值会偏高一点，不过，这不会对统计结果产生太大影响。
Average是个汇总行，是上面统计信息的平均值。
组合：
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
需要注意的一点是，第一行的统计信息中包含了sar本身的统计消耗，所以%user列的
这个输出是对系统整体CPU使用状况的统计，每项的输出都非常直观，并且最后一行
口
口
口%nice列显示了运行正常进程所消耗的CPU时间百分比。
口%user列显示了用户进程消耗的CPU时间百分比。
上面每项输出的解释如下：
11:41:39
11:41:36
11 :41: 33
11:41:30
11:41:27
11:41:24
Linux 2.6.9-42.ELsmp (webserver)
[root@webserver -]# sar-u35
下面是sar命令对某个系统的CPU统计输出：
sar-nDEV53
sar-r52
同理，查看系统内存使用情况、网络运行状态，
sar-d35
要查看系统磁盘的读写性能，使用以下组合：
sar -P 1 3 5
系统的CPU计数是从0开始的，如果要查看第二个CPU的运行负载，使用下面组合：
sar-u35
例如，要查看系统CPU的整体负载状况，每3秒统计一次，统计5次，可以使用以下
%idle列显示了CPU处在空闲状态的时间百分比。
1%steal 列显示了在内存相对紧张的环境下pagein强制对不同的页面进行的 steal操作。
%iowait列显示了I/O等待所占用的CPU时间百分比。
%system列显示了系统进程消耗的CPU时间百分比。
ocount，表示采样次数，是可选参数，默认值是1。
ointerval，表示采样间隔时间，是必须有的参数。
o-ofilename，表示将命令结果以二进制格式存放在文件中，filename是文件名。
O-w，显示系统交换活动在采样时间内的状态。
www.Linuxidc.com
al1
巴
E
CPU
0.34
0.29
0.04
0.13
0.88
suser
Q.
Q.
0.00
0.00
tnice
00
00
11/28/2008
system
，可以分别使用下面的命令：
0.16
0 .17
0.13
0.04
0.17
0.29
iowait
0.04
0.00
0.00
0.21
0.00
_1686_
tsteal
（8CPU）
0.00
0.00
0.00
0.00
0.00
259
99.45
99.41
99.58
99.92
99.50
98.83
tidle
G
---
## Page 276
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
后就可以直接在系统下运行iostat命令了。
源代码包或rpm包的方式安装。安装完毕，系统会多出3个命令：iostat、sar和mpstat，然
Sysstat是一个开源软件，官方网址为http://pagesperso-orange.fr/sebastien.godard，可以选择
vmstat一样，iostat也不能对某个进程进行深入分析，仅对系统的整体情况进行分析。
作进行监视。它的输出主要显示磁盘读写操作的统计信息，同时给出CPU的使用情况。
10.6.3
表示对系统的第5个CPU进行统计。依此类推，可以看出，上面的系统有8个CPU。
0开始的，因此，“sar-P035”表示对系统的第一个CPU进行信息统计，“sar-P435”则
缓慢现象的发生。
100%，无法处理其他请求，而其他的CPU却闲置，这就导致了整体CPU使用率不高而应用
使用率不高，但是系统应用却响应缓慢。单线程只使用一个CPU，导致这个CPU占用率为
口interval，指定两次统计间隔的时间。
口
口
口-C，显示CPU的使用情况。
各个选项及参数含义如下：
iostat命令的语法如下：
iostat一般不随系统安装，要使用iostat工具，需要在系统上安装一个Sysstat的工具包
口
iostat[-c|-d][-k][-t][-x[device ]][interval
iostat是I/Ostatistics（输入/输出统计）的缩写，主要的功能是对系统的磁盘I/O操
这个输出是对系统的第一个CPU的信息统计，需要注意的是，sar中对CPU的计数是从
Average:
06 : 29 : 48
06:29:45
06:29:42
06:29:39
06:29:36
06:29:33
Linux 2.6.9-42.ELsmp (webserver)
[root@webserver ~]#sar -P035
针对这个问题，
在一个多CPU的系统中，如果程序使用了单线程，会出现这么一个现象，CPU的整体
-xdevice，指定要统计的磁盘设备名称，默认为所有的磁盘设备。
-t，打印出统计信息开始执行的时间。
-k，每秒以KB为单位显示数据。
-d，显示磁盘的使用情况。
iostat命令
Y
，可以分开查询系统的每个CPU，统计每个CPU的使用情况。
CPU
1.07
1.00
0.67
D
tuser
.00
.00
Linuxidc.com
0.00
0.00
0.00
0.00
snice
11/29/2008
esystem
0.33
0.33
0.33
0.33
0.33
siowait
0.07
0.33
0.00
0.00
0.
0.
00
i686
[count]]
steal
(8CPU）
0.00
0.
98.53
98 .34
99.00
99.67
99.00
sidle
PDG
回
---
## Page 277
进行统计。例如下面这个输出：
的：长期的、超大的数据读写，肯定是不正常的，这种情况一定会影响系统性能。
没有一个固定的大小，根据系统应用的不同，会有不同的值。但是有一个规则还是可以遵循
值很大，表示磁盘的读操作很多，可以将读取的数据放入内存中进行操作。这两个选项的值
wrtn/s值很大，表示磁盘的写操作很频繁，可以考虑优化磁盘或优化程序：如果Blk_read/
二次输出的数据才代表在检测的时间段内系统的传输值。
sar命令的输出项完全相同。
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
“iostat-x”组合还提供了对每个磁盘的单独统计，如果不指定磁盘，默认是对所有磁盘
可以通过Blk_read/s和Blk_wrtn/s的值对磁盘的读写性能有一个基本的了解：如果Blk
avg-cpu:
Linux 2.6.9-42.ELsmp (webserver)
[rootswebserver~]#
这里需要注意的一点是，上面输出的第一项是系统从启动到统计时的所有传输信息，第
口Blk_wrtn表示写入的所有块数。
口Blk_read表示读取的所有块数。
口Blk_wrtn/s表示每秒写入的数据块数。
口Blk_read/s表示每秒读取的数据块数，
上面每项输出的解释如下：
sda
Device:
sda
Device:
sda
Device:
Linux 2.6.9-42.ELsmp
下面通过“iostat-d”命令组合来查看系统磁盘的使用状况：
在这里，使用了“-c”参数，
avg-cpu:
Linux 2.6.9-42.ELsmp (webserver)
[root@webserver~]#iostat
看下面的一个输出：
口count，按照“interval”指定的时间间隔统计的次数。
2.45
2.52
euser
suser
www.Linuxidc.com
0.00
0.00
nicesystemtiowaittstealidle
1.00
enice
tps
iostat-x/dev/sda23
(webserver)
iostat -d 2 3
0.30
Blk_read/s
Blk_read/s
Blk_read/s
只显示系统CPU的统计信息，
system
0.24
-C
0.00
0.00
2.58
0.24
iowait steal
0.00
Blk_wrtn/s
12/01/2008
B1k_wrtn/s
B1k_wrtn/s
12/01/2008
0.00
114.12
11/29/2008
12.00
97.03
0.00
96.96
Blk_read
Blk_read
6479462
Blk_read
idle
_i686_
_i686_（8 CPU)
，输出中每项代表的含义与
_i686_
B1k_wrtn
286537372
Blk_wrtn
(8CPU)
Blk_wrtn
（8CPU)
24
261
PDG
---
## Page 278
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
统内存资源紧缺，
存资源非常充足，不影响系统性能；当应用程序可用内存/系统物理内存70%时，表示系统内
“free-m”表示查看以M为单位的内存使用情况，在这个输出中，重点关注的应该
Swap:
-/+buffers/cache:
[root@webserver ~]#free-m
free是监控Linux内存使用状况最常用的指令。看下面这一个输出：
wsec/s表示每秒写入的扇区数，
口rsec/s表示每秒读取的扇区数。
口w/s表示每秒完成写IV/O设备的次数
口r/s表示每秒完成读I/O设备的次数。
口wrqm/s表示每秒进行合并的写操作数目
口rrqm/s表示每秒进行合并的读操作数目。
这个输出基本与“sar-d”相同。需要说明以下几个选项的含义：
Device:rrqm/s
avg-cpu:
sda
Device: rrqm/s wrgm/s
avg-cpu:
sda
0.01
total
tuser
，需要增加系统内存；当20%<应用程序可用内存/系统物理内存<70%时
4.04
8189
8111
4.50
wrgm/s
12.48
nice tsystem tiowait
&niceesystem giowait
0.00
used
r/sw/s
Iinuxidc.com
0.101.782.58
1.83
1.83