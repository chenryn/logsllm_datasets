### 图8. 针对IoT设备的分布情况
图8展示了在遭受DoS攻击最多和生成反弹数据包最多的前15个国家中，目标IoT设备的分布情况。
- **(a)** DoS攻击受害者
- **(b)** 生成的反弹数据包

#### (a) DoS受害者
- 横轴：国家
- 纵轴：数量（单位：千）

| 数量（单位：千） | 国家 |
| --- | --- |
| 700K | - |
| 600K | - |
| 500K | - |
| 400K | - |
| 300K | - |
| 200K | - |
| 100K | - |
| 0K | - |

- 扫描数据包
- 目标IP地址
- 目标端口

分析时间间隔（143小时）
1, 8, 15, 22, 29, 36, 43, 50, 57, 64, 71, 78, 85, 92, 99, 106, 113, 120, 127, 134, 141

#### (b) 生成的反弹数据包
- 横轴：国家
- 纵轴：数量（单位：千）

| 数量（单位：千） | 国家 |
| --- | --- |
| 700K | - |
| 600K | - |
| 500K | - |
| 400K | - |
| 300K | - |
| 200K | - |
| 100K | - |
| 0K | - |

- 扫描数据包
- 目标IP地址
- 目标端口

分析时间间隔（143小时）
1, 8, 15, 22, 29, 36, 43, 50, 57, 64, 71, 78, 85, 92, 99, 106, 113, 120, 127, 134, 141

### 图9. TCP扫描数据包的整体分布
图9显示了被利用的IoT设备（包括CPS和消费者IoT设备）生成的TCP扫描数据包的整体分布。

#### (a) CPS
- 横轴：时间间隔（小时）
- 纵轴：目标端口数量

| 目标端口数量 | 时间间隔（小时） |
| --- | --- |
| 11K | - |
| 10K | - |
| 9K | - |
| 8K | - |
| 7K | - |
| 6K | - |
| 5K | - |
| 4K | - |
| 3K | - |
| 2K | - |
| 1K | - |
| 0K | - |

- 扫描数据包
- 目标IP地址
- 目标端口

分析时间间隔（143小时）
1, 8, 15, 22, 29, 36, 43, 50, 57, 64, 71, 78, 85, 92, 99, 106, 113, 120, 127, 134, 141

#### (b) 消费者
- 横轴：时间间隔（小时）
- 纵轴：目标端口数量

| 目标端口数量 | 时间间隔（小时） |
| --- | --- |
| 11K | - |
| 10K | - |
| 9K | - |
| 8K | - |
| 7K | - |
| 6K | - |
| 5K | - |
| 4K | - |
| 3K | - |
| 2K | - |
| 1K | - |
| 0K | - |

- 扫描数据包
- 目标IP地址
- 目标端口

分析时间间隔（143小时）
1, 8, 15, 22, 29, 36, 43, 50, 57, 64, 71, 78, 85, 92, 99, 106, 113, 120, 127, 134, 141

### 分析结果
总共12,363个被入侵的IoT设备（其中55%是消费者IoT设备）生成了这些TCP扫描数据包。我们展示了这些被入侵的IoT设备在CPS和消费者领域生成的TCP扫描数据包的整体分布。平均而言，被入侵的消费者IoT设备每小时生成的TCP扫描数据包比CPS中的IoT设备更多，分别为约382,000和318,000个数据包。尽管被入侵的IoT设备中包含更多的消费者IoT设备（55%），但分析显示，被入侵的IoT设备数量与每小时生成的扫描数据包总数之间没有线性相关性（Pearson’s r ≈ 0且p > 0.05）。此外，被入侵的消费者IoT设备每小时针对的目标相对较多，分别为约280,000和215,000个目标。有趣的是，虽然CPS中的被入侵IoT设备扫描的目标较少，但它们扫描的端口范围较广，平均每小时扫描576个端口（最小值为271，最大值为987）。而被入侵的消费者IoT设备每小时扫描的端口范围较小（平均为246个端口），但在第119个时间间隔处，扫描端口的数量突然增加（见图9b）。进一步调查发现，在第119个时间间隔内，有734个IoT设备生成了TCP扫描数据包。其中，位于多米尼加共和国的一台IP摄像头负责扫描55个目标地址上的10,249个端口。

### 被扫描协议/服务
表V总结了被入侵的IoT设备扫描次数最多的前14个协议/服务。Telnet接收的TCP扫描数据包最多（约占50%），其次是HTTP和SSH，分别占所有TCP扫描数据包的约9.4%和7.7%。

| 协议/端口 | 数据包数量（%） | 消费者IP（%） | CPS IP（%） |
| --- | --- | --- | --- |
| Telnet /23/2323/23231 | 50.08 | 643 | 553 |
| HTTP /80/8080/81 | 9.4 | 1418 | 345 |
| SSH /22 | 7.7 | 64 | 80 |
| BackroomNet /3387 | 6.2 | - | 1 |
| CWMP /7547 | 4.5 | 169 | 13 |
| WSDAPI-S /5358 | 4.05 | 59 | 48 |
| MSSQLServer /1433 | 3.3 | 8 | 23 |
| Kerberos /88 | 2.7 | 1061 | 330 |
| MS DS /445 | 2.5 | 43 | 65 |
| EtherneIP IO /2222 | 2.49 | 50 | 18 |
| iRDMI /8000 | 0.7 | 42 | 61 |
| Unassigned /21677 | 0.68 | 46 | 54 |
| RDP /3389 | 0.67 | 20 | 33 |
| FTP /21 | 0.57 | - | 1 |

总体来看，HTTP、Telnet、Kerberos和iRDMI被明显更多的被入侵IoT设备扫描（见表V）。此外，更多的被入侵消费者IoT设备扫描HTTP、Kerberos和iRDMI协议，贡献了这些端口上大部分生成的TCP扫描数据包（见表V）。另一方面，虽然只有一个CPS领域的被入侵IoT设备在积极扫描端口3387（BackroomNet），但几乎所有针对端口21677的扫描数据包都是由被入侵的CPS IoT设备生成的（一个被入侵的消费者IoT设备生成了极少量的TCP流量）。

### 前五名被扫描协议/服务的TCP扫描数据包分布
图10展示了针对前五名协议/服务的TCP扫描数据包分布。需要注意的是，这些协议大多也与最近的IoT发起的网络攻击有关（例如Mirai僵尸网络及其变种）。事实上，我们的分析揭示了许多被入侵的IoT设备正在积极参与扫描这些协议。此外，通过与公开威胁库（如Cymon）进行比较，证实了这些被入侵设备确实在执行恶意扫描，详见第五部分。

### 进一步分析
**Telnet**：明显观察到Telnet接收了来自1,196个被入侵IoT设备的最多TCP扫描数据包。此外，略微更多的被入侵消费者IoT设备（54%）在扫描Telnet，生成了所有TCP扫描数据包的约63%。此外，共有7个被入侵IoT设备贡献了针对Telnet的55%的TCP数据包。这些被入侵的IoT设备分布在不同国家，包括三台IP摄像头、一台路由器、DVR、打印机以及两个与电力公用事业和公用事业网络相关的CPS设备。有趣的是，这些被入侵的IoT设备也被Cymon列为恶意扫描设备。

**SSH**：我们在时间间隔32和69处注意到整体扫描活动向SSH的突然增加（见图10），分别由被入侵的IoT设备生成了约242,000和253,000个TCP数据包。令人惊讶的是，只有少数被入侵的IoT设备（主要是CPS中的设备）在这些时间间隔内生成了大部分TCP扫描。特别是，两台位于俄罗斯和澳大利亚的被入侵路由器以及三个位于中国和巴西的CPS中的被入侵IoT设备，在时间间隔32生成了约93%的扫描数据包。有趣的是，这三个在时间间隔32生成了约80%扫描数据包的CPS中的被入侵IoT设备，在时间间隔69也生成了大多数扫描流量（约90%）。实际上，上述五个被入侵的IoT设备都被Cymon标记为参与恶意扫描和/或SSH暴力破解攻击。

**BackroomNet**：我们注意到BackroomNet仅被一个位于加拿大的CPS中的被入侵IoT设备扫描，该设备运行BACnet/IP（用于楼宇自动化）。如图10所示，密集的扫描活动始于时间间隔113（4月16日），在此期间生成了超过620万个数据包。

### 图10. 前五名被扫描协议/服务的TCP扫描数据包分布
- 横轴：时间间隔（小时）
- 纵轴：扫描数据包数量

| 扫描数据包数量 | 时间间隔（小时） |
| --- | --- |
| 550K | - |
| 500K | - |
| 450K | - |
| 400K | - |
| 350K | - |
| 300K | - |
| 250K | - |
| 200K | - |
| 150K | - |
| 100K | - |
| 50K | - |
| 0K | - |

- Telnet
- HTTP
- SSH
- BackroomNet
- CWMP

1, 8, 15, 22, 29, 36, 43, 50, 57, 64, 71, 78, 85, 92, 99, 106, 113, 120, 127, 134, 141