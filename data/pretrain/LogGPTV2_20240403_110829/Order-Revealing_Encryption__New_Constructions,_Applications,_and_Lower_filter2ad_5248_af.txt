4370.64 µs
16.50 µs
54.87 µs
721.37 µs
0.38 µs
0.98 µs
3.20 µs
0.31 µs
0.63 µs
2.61 µs
192 bytes
224 bytes
1612 bytes
192 bytes
224 bytes
1612 bytes
First block of d-bits
that diﬀers
First block of d-bits
that diﬀers
d
–
1
4
8
12
4
8
12
Table 1: Performance comparison between our ORE scheme from Section 4 and existing OPE and
ORE schemes. We consider two variants of our scheme: one where the random oracle is instantiated
using an AES-based construction and one where the random oracle is instantiated with SHA-256.
We describe these two instantiations in greater detail in Section 7. In these benchmarks, we use a
32-bit plaintext space, and measure the time needed to encrypt a (randomly chosen) message and
the time needed to compare two ciphertexts. The parameter d is the block size (in bits) in our ORE
scheme. Our micro-benchmarks are averaged over 50–107 iterations (the precise number is adjusted
based on the approximate runtime of the algorithm).
8 Related Work
In this section, we survey some of the literature on order-revealing and order-preserving encryption,
as well as the existing work on searching over encrypted data.
OPE and ORE. The concept of order-preserving encryption was ﬁrst introduced by Agrawal,
Kiernan, Srikant, and Xu [AKSX04], who explored the application of OPE for performing en-
crypted database queries. The ﬁrst explicit OPE construction was formalized in the seminal
work of Boldyreva et al. [BCLO09], and has subsequently been expanded on in a multitude of
works [BCO11, PR12, PLZ13, TYM14, KS14, Ker15, MCO+15, RACY15, BPP16]. Some of these
works [BCO11, TYM14] have focused on exploring the security properties of order-preserving encryp-
tion. Others [PLZ13, KS14, Ker15, RACY15, BPP16] have considered stateful or interactive OPE
solutions which avoid both the lower bounds in [BCLO09, BCO11, PLZ13] as well as our strength-
ened lower bound from Section 6. However, synchronizing state and coordinating multi-round
interactions in distributed, large-scale execution environments is often diﬃcult, and consequently,
nearly all existing OPE deployments (e.g., SkyHigh Networks, CipherCloud) use stateless variants of
OPE for sorting and ﬁltering on encrypted data. Numerous ad hoc OPE schemes [BHF09, KAK10]
have also been proposed in recent years, but they often lack a formal security analysis.
The notion of order-revealing encryption was ﬁrst introduced by Boldyreva et al. [BCO11] under
the name “eﬃciently-orderable encryption” (EOE). Subsequently, Boneh et al. [BLR+15] gave the
ﬁrst construction of an order-revealing encryption scheme satisfying the best-possible notion of
semantic security from multilinear maps. More generally, ORE is a special case of multi-input
functional encryption (MIFE) [GGG+14]. To date, the only constructions of general-purpose MIFE
rely on heavy primitives such as indistinguishability obfuscation [BGI+12, GGH+13b] and are far too
ineﬃcient to deploy. Chenette et al. [CLWW16] recently proposed an eﬃcient ORE scheme, which
25
10,000
)
s
µ
(
i
e
m
T
n
o
i
t
p
y
r
c
n
E
e
g
a
r
e
v
A
1,000
100
10
1
0
16
Bit Length of Message Space
32
48
64
Boldyreva et al.
Our scheme (SHA)
Chenette et al.
Our scheme (AES)
Figure 1: Performance comparison between our ORE scheme (Section 4) and existing OPE and
ORE schemes. We use a ﬁxed base representation d = 8 for our ORE scheme in these experiments.
The two variants of our scheme, labeled SHA and AES, refer to how we instantiate the random
oracle in our construction.
we improve upon and generalize in our work. In the small-domain setting, it is possible to construct
ORE from either symmetric or public-key encryption [AJ15, BKS15] or bilinear maps [KLM+16],
but these constructions are far less eﬃcient compared to our small-domain ORE from Section 3,
which just relies on PRFs.
Concurrent work on ORE. Concurrent to this work, Joye and Passel´egue [JP16] also construct
a small-domain ORE scheme with best-possible security from one-way functions. Ciphertexts in
their scheme are asymptotically longer that those in our scheme (by a multiplicative factor Ω(log N )
where N is the size of the plaintext space), but at the same time, their construction achieves
simulation security without random oracles. In addition, they construct an ORE scheme (with
leakage) from the decisional linear (DLIN) assumption over bilinear groups. The leakage of their
scheme is incomparable to that of our new PRF-based ORE scheme from Section 4.
In another concurrent work, Cash, Liu, O’Neill, and Zhang [CLOZ16] give a pairing-based
construction of an order-revealing encryption scheme that achieves strictly stronger security than
the Chenette et al. construction. Their construction combines the bit-by-bit (or block-by-block)
encryption approach of Chenette et al. with a novel property-preserving hash function to perform
the comparisons. Their use of the property-preserving hash function enables hiding of the position
of the ﬁrst diﬀering bit (or block). The resulting leakage of their scheme is whether two ciphertexts
diﬀer from a third ciphertext in the same bit (or block) position. Cash et al.
instantiate the
property-preserving hash function using the symmetric external Diﬃe-Hellman (SXDH) assumption
over bilinear groups. While the leakage of their construction strictly improves upon both the work
of Chenette et al. as well as this work (when looking at their blockwise generalization), ciphertexts
26
in their construction are signiﬁcantly longer (by a multiplicative factor that grows linearly in
the security parameter λ). The reliance on pairings also render their scheme less competitive in
terms of practical eﬃciency compared to solutions that only require simple symmetric primitives.
Nonetheless, the Joye-Passel´egue and the Cash-Liu-O’Neill-Zhang constructions both represent
important advancements in the study of eﬃcient ORE constructions with limited leakage.
Searching on encrypted data. Numerous techniques, such as searchable symmetric encryption
(SSE) [SWP00, CGKO06, CK10], property-preserving encryption (PPE) [BCLO09, PR12, CD15],
fully homomorphic encryption (FHE) [Gen09], hidden vector encryption [BW07], oblivious RAMs
(ORAM) [GO96], and others have been proposed for tackling the general problem of searching
and querying on encrypted data. While tools such as FHE or ORAM can be used for searching
on encrypted data [BGH+13, YSK+13], these methods are prohibitively expensive for nearly all
real-world deployments. On the more practical side, numerous SSE schemes [SWP00, Goh03, CM05,
CGKO06, CK10, JJK+13, NPG14] have been proposed in the last 15 years, but these past works
are limited to exact keyword searches, and generally do not handle the eﬃcient computation of
complex queries (such as range queries) over encrypted data. More recently, several works [CJJ+13,
CJJ+14, PKV+14, FJK+15] describe constructions of SSE schemes that are able to handle more
expressive queries. We survey these works below.
Cash et al. [CJJ+13] give the ﬁrst SSE scheme that supports Boolean queries (in time sublinear
in the size of the database) with a small amount of leakage and security from the decisional Diﬃe-
Hellman (DDH) assumption. Subsequently, Cash et al. [CJJ+14] extend the construction to allow
for updates to the encrypted database as well as support multiple, potentially dishonest clients.
Handling updates requires the client to maintain a small amount of state (or requires additional
rounds of communication and leads to increased leakage). Boolean queries alone, however, do
not suﬃce for range queries, so in another follow-up work, Faber et al. [FJK+15] show how the
Cash et al. SSE scheme can be leveraged for range queries. Their resulting construction leaks some
additional information about the database contents, namely the number of values that fall into
certain subintervals within the requested range. Moreover, due to the use of universal covers, the
size of the server’s response set to a range query may be up to 66% larger than the size of the true
response set. We do not know of any existing SSE scheme that can eﬃciently support range queries
with optimal (minimal) leakage.
Concurrent to the work of Cash et al., Pappas et al. [PKV+14] introduce BlindSeer, a private
database management system that can support a wide-range of queries in sublinear time over an
encrypted database. Their construction leverages generic two-party computation tools such as Yao’s
garbled circuits [Yao82], and their construction provides security in the semi-honest model.
Comparison to our techniques. To conclude, we highlight some of the key diﬀerences between
existing SSE methods and our ORE-based construction for implementing range queries over an
encrypted database:
• Like other PPE-based constructions, our ORE-based construction integrates well with existing
database management systems—we just need to implement a custom comparator. With SSE,
we would have to deploy a new, and oftentimes, complex database management system. This
lacks legacy compatibility, which is a barrier to deployment in existing systems. Our approach
provides a fast, simple, and direct solution for supporting range queries on encrypted data
without requiring signiﬁcant infrastructural changes.
27
• We explicitly model and analyze the leakage of our range query protocol assuming adaptive
updates to the database.
• Our construction only requires symmetric primitives and does not require more expensive
primitives such as public-key cryptography or oblivious transfer.
9 Conclusions
In this work, we gave two new constructions of order-revealing encryption schemes that rely only on
symmetric primitives. Both of our constructions ﬁt naturally into the left/right model for ORE
(Section 1.1) and have the appealing property that in isolation, right ciphertexts are semantically
secure. We leveraged this property to build an eﬃcient range query protocol that is robust against
inference attacks. Thus, our work shows that it is possible to leverage property-preserving encryption
for searching on encrypted data while resisting oﬄine inference attacks. As part of our analysis into
the security of OPE and ORE, we also strengthen the lower bound on OPE schemes and show that
there are no eﬃcient OPE schemes on any message space containing at least three messages. To
conclude, we present several interesting directions for future study:
• Can we construct a practical small-domain ORE with best-possible security and ciphertext
length that is sublinear in the size of the message space? Such an ORE scheme can be combined
with our domain-extension technique from Section 4 to obtain an ORE scheme with shorter
ciphertexts or increased security (by allowing for larger block sizes).
• Can we construct a left/right ORE scheme (with similar or less leakage) from simple primitives
where both the left ciphertexts and the right ciphertexts are semantically secure when taken
in isolation? In our constructions from Sections 3 and 4, the left ciphertexts are deterministic
and do not satisfy this property. The only ORE constructions that achieve semantic security
for both left and right ciphertexts require multilinear maps [BLR+15] or indistinguishability
obfuscation [GGG+14]. Concurrently with this work, both Joye and Passel´egue [JP16] as well
as Cash et al. [CLOZ16] proposed pairing-based constructions of ORE with limited leakage
where the ciphertexts can be decomposed into left/right components such that the components
are themselves semantically secure. It still remains an open question whether such a scheme
can be constructed using weaker primitives.
• Can we strengthen our OPE lower bound to show that no OPE scheme can satisfy best-possible
security even if they are stateful or interactive? Popa et al. [PLZ13] previously showed that
even if we allow for state and interaction, the size of the ciphertext space must be exponential
in the size of the plaintext space. However, their lower bound does not rule out the possibility
of a stateful or interactive OPE scheme with best-possible security for small domains.
Acknowledgments
We thank Dan Boneh, Mark Zhandry, and Joe Zimmerman for insightful discussions about this
work. We thank Dmytro Bogatov for pointing out the security issue of using a Feistel network with
a small block size as a concrete instantiation of a small-domain PRP. We thank the members of the
2015 Stanford Theory Retreat for initiating our study of new OPE lower bounds. This work was
28
supported by the NSF, DARPA, the Simons foundation, a grant from ONR, and an NSF Graduate
Research Fellowship. Opinions, ﬁndings and conclusions or recommendations expressed in this
material are those of the author(s) and do not necessarily reﬂect the views of DARPA.
References
[AC15]
[AJ15]
Reed Abelson and Julie Creswell. Data breach at anthem may forecast a trend. The
New York Times, 2015.
Prabhanjan Ananth and Abhishek Jain. Indistinguishability obfuscation from compact
functional encryption. In CRYPTO, 2015.
[AKSX04] Rakesh Agrawal, Jerry Kiernan, Ramakrishnan Srikant, and Yirong Xu. Order-
preserving encryption for numeric data. In ACM SIGMOD, 2004.
[BCLO09] Alexandra Boldyreva, Nathan Chenette, Younho Lee, and Adam O’Neill. Order-
preserving symmetric encryption. In EUROCRYPT, 2009.
[BCO11]
Alexandra Boldyreva, Nathan Chenette, and Adam O’Neill. Order-preserving encryp-
tion revisited: Improved security analysis and alternative solutions. In CRYPTO,
2011.