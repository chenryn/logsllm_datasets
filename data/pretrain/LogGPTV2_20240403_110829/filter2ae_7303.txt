# 360显危镜、加固保免费提供“应用克隆”漏洞检测服务
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 简介
近期国内多款知名手机APP被曝光存在“应用克隆”漏洞。攻击者利用该漏洞，可以轻松“克隆”用户账户，窃取隐私信息，盗取账号及资金等，国内约 **10%**
的主流APP受到漏洞影响。
**作为中国领先的网络安全厂商，360旗下APP从产品开发阶段就已对“应用克隆”攻击威胁进行全面预防，完全不受此次漏洞影响。**
针对移动应用厂商和开发者，360旗下自动化漏洞检测平台 **360显危镜**
即日起将提供免费技术援助，为大家提供Android应用克隆攻击漏洞检测服务，协助开发者修复“应用克隆”漏洞。
根据360信息安全中心的评估，“应用克隆”漏洞攻击模型中主要涉及到两个过程，一是数据读取，二是数据复制。在数据读取过程中主要涉及到WebView的跨源攻击，因为Android沙盒的存在，两个应用之间一般情况下是不可以进行文件的相互访问，但不正确的使用WebView可能会打破这种隔离。WebView未禁用file域访问，允许file域访问http域，且未对file域的路径进行严格限制的情况下，攻击者通过URL
Scheme的方式，可远程打开并加载恶意HTML文件，远程获取APP中包括用户登录凭证在内的所有本地敏感数据，并外传到攻击者的服务器。
漏洞的攻击链条中，需要利用多个漏洞才能实现，因此可有多种方式截断该攻击的实现方式。针对上述几个问题，只要从任何一点截断，即可极大程度上杜绝该漏洞攻击的实现。
## 修复建议
1.在使用Webview时，对于不需要使用file协议的应用， **禁用file协议**
setAllowFileAccess可以设置是否允许WebView使用File协议，默认值是允许，如果不允许使用File协议，则不会存在跨源的安全威胁。
2.对于需要使用file协议的应用， **禁止file协议调用javascript**
setJavaScriptEnabled可以设置是否允许WebView使用JavaScript,默认是不允许，但很多应用，包括移动浏览器为了让WebView执行http协议中的javascript，都会主动设置允许WebView执行Javascript，而又不会对不同的协议区别对待，比较安全的实现是如果加载的url是http或https协议，则启用javascript,如果是其它危险协议，如是file协议，则禁用javascript。
3. **设置file域白名单** ，检查file域路径避免被绕过
固定不变的HTML文件可以放到assets或res目录，可能会更新的HTML文件放到应用私有目录下，避免被第三方替换或修改，对file域请求做白名单限制时，需要对“../../”特殊情况进行处理，避免白名单被绕过。
## Android应用克隆攻击漏洞检测服务网址
## 参考文献
## 360加固保
360加固保一直致力于守护为移动应用安全，会及时推送安全相关资讯、第一时间发布漏洞预警，提供解决方案，关注微信公众号（360加固保；jiagu360），为移动应用安全保驾护航。