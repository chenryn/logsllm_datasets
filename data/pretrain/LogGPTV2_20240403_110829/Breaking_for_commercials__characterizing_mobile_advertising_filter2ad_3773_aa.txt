title:Breaking for commercials: characterizing mobile advertising
author:Narseo Vallina-Rodriguez and
Jay Shah and
Alessandro Finamore and
Yan Grunenberger and
Konstantina Papagiannaki and
Hamed Haddadi and
Jon Crowcroft
Breaking for Commercials:
Characterizing Mobile Advertising
Narseo Vallina-Rodriguez†, Jay Shah†, Alessandro Finamore‡
Yan Grunenberger⋄, Hamed Haddadi§, Konstantina Papagiannaki⋄, Jon Crowcroft†
University of Cambridge†, Politecnico di Torino‡, Telefonica Research⋄
Queen Mary University of London§
PI:EMAIL†, ﬁPI:EMAIL‡, {yan,dina}@tid.es⋄
PI:EMAIL§
ABSTRACT
1.
INTRODUCTION
Mobile phones and tablets can be considered as the ﬁrst incarnation
of the post-PC era. Their explosive adoption rate has been driven
by a number of factors, with the most signifcant inﬂuence being
applications (apps) and app markets. Individuals and organizations
are able to develop and publish apps, and the most popular form of
monetization is mobile advertising.
The mobile advertisement (ad) ecosystem has been the target of
prior research, but these works typically focused on a small set of
apps or are from a user privacy perspective. In this work we make
use of a unique, anonymized data set corresponding to one day of
trafﬁc for a major European mobile carrier with more than 3 million
subscribers. We further take a principled approach to characterize
mobile ad trafﬁc along a number of dimensions, such as overall
trafﬁc, frequency, as well as possible implications in terms of en-
ergy on a mobile device.
Our analysis demonstrates a number of inefﬁciencies in today’s
ad delivery. We discuss the beneﬁts of well-known techniques,
such as pre-fetching and caching, to limit the energy and network
signalling overhead caused by current systems. A prototype im-
plementation on Android devices demonstrates an improvement of
50% in terms of energy consumption for ofﬂine ad-sponsored apps
while limiting the amount of ad related trafﬁc.
Keywords
Energy, Advertisement, Smartphones, Trafﬁc, Cellular, Caching
Categories and Subject Descriptors
D.4.8 [Performance]: Measurements
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’12, November 14–16, 2012, Boston, Massachusetts, USA.
Copyright 2012 ACM 978-1-4503-1705-4/12/11 ...$15.00.
Mobile application (app) markets have been a major success and
adoption factor for smartphones, allowing individuals and organi-
zations to develop and sell apps to interested users. The App Store
from Apple and Google Play (previously named Android Market)
from Google are the two major platforms where developers sell or
freely share their apps. Both Apple and Google have played a major
role in democratizing revenues related to mobile apps. In particu-
lar, considering that 73% of the apps in Google Play are free [1],
it can be expected that free apps tend to obtain a larger number of
downloads than paid apps1. The revenue model adopted by many
free apps includes advertisements (ads) that are embedded in the
app and displayed at various points during use. The adoption of the
ad model in mobile apps has strong implications for both the users
and the network. As an example, a recent study shows that 65-75%
of the energy consumed in a gaming app (Angry Birds) on Android
devices is spent by third party advertising modules [2].
Mobile advertising has been the focus of recent research, target-
ing the system design [3], energy [2, 4], and privacy aspects of ad
services [5, 6]. However, there is still very little known about the
ad delivery mechanisms adopted in current mobile networks. This
happens primarily because existing work tends to focus on the in-
spection of trafﬁc generated by a small number of popular apps.
In this work, we aim to characterize and quantify ad trafﬁc in real
mobile networks. For that, we study a data trace covering one day
of trafﬁc for more than 3 million subscribers of a major European
mobile carrier.
In such an attempt, we develop a methodology for the classi-
ﬁcation of ad trafﬁc that incorporates the inspection of the SDKs
provided by ad networks, trafﬁc inspection of mobile apps, as well
as rules extracted through a web log obtained from the aforemen-
tioned network. Using a rule set comprising 122 rules, we classify
trafﬁc into i) ad networks, ii) analytics, and iii) mediation services,
and study its characteristics along a number of dimensions (traf-
ﬁc volume, frequency, type of content, etc.) for three major mobile
platforms found in the trace. Our analysis reveals several properties
of the mobile ad ecosystem:
• The mobile ad ecosystem is overcrowded and unmoderated,
with AdMob and other Google services being the leaders.
• Ads are not just a strain on Android devices but are also
prominent on Apple devices.
• Ads account for 1% of all mobile trafﬁc in our data set, a
signiﬁcant component of the daily trafﬁc of each device. Re-
1Although no ground truth data has been publicly available to con-
ﬁrm this conjecture.
343Rank
1
2
3
4
5
6
7
8
9
10
Application Name
Facebook
Talking Pierre
Ceramic Destroyer
WhatsApp
Cartoon Camera
Skype
Angry Birds
Onavo
Talking Tom Cat 2
Viber
Category
Social Network
Entertainment
Arcade
Communication
Photo
Communication
Arcade
Tools
Entertainment
Communication
Ad Provider
N/A
MobClix
AdMob
N/A
MobFox, MadVerti
N/A
Burstly
N/A
MobClix
N/A
Table 2: Usage of ad networks on the top 10 most popular free
mobile apps in the UK (As of 27th Feb. 2012).
Type
Object path
adk-core-v40.js Ad Net
mads/gma
Role
Conf. Script
URL domain
media.admob.com
*.g.doubleclick.net
*.googlesyndication.com pagead/simgad
*.googlesyndication.com pagead/js
*.googlesyndication.com pagead
*.g.doubleclick.net
aclk
Ad Net Get Ad
Ad Net Get Ad
Ad Net
Ad Net
Ad Net
Static content
Static content
Report Click
Table 3: Extract of the rule set for AdMob.
Ad networks and publishers are pursuing common objectives.
Ad networks wish to maximize the number of clicks on ads through
targeting the right users to satisfy the demands of the advertisers.
Meanwhile, publishers are looking to maximize their revenue by
increasing their click-through rate (the number of clicks on an ad
divided by the number of times an ad is shown), using mediation
services to ﬁll up their advertising space, and obtain proﬁling in-
formation for targeting. Rather than inspecting all the relations
between the players in this complex ecosystem, we focus our in-
terest on the distribution mechanism used by ad networks and ad-
sponsored apps running on the device, as depicted in Figure 1.
2.1 Understanding ad networks’ SDKs
The ecosystem leverages the relative simplicity in incorporating
ads in mobile app development. Ad networks provide a Software
Development Kit (SDK) that enables integration of ads into mobile
apps, hiding the protocol peculiarities. As shown in Table 1, pop-
ular ad networks such as AdMob, Millennial Media and InMobi
allow developers to deﬁne which kind of ads are embedded, how
they are delivered (push/pull techniques) and how often they are
refreshed. The most common type of ad in mobile apps are ban-
ners (they are placed at the top or bottom of the screen and span
its width) and interstitials (full-screen ads, covering a large part or
all of the screen for a short period of time). Unlike banners, in-
terstitials are typically shown as users transition between different
activities in the app. Banners are usually composed by text, images,
and Javascript code.
The protocols used by ad networks for fetching and reporting
are generally based on plain HTTP requests using REST APIs, with
most using HTTP GET methods. However, the ad networks studied
differ slightly in the way they interact. As an example, AdMob acts
as an internal mediation service to aggregate all Google’s services
(e.g. Doubleclick and AdSense) whereas InMobi only requires a
single HTTP POST request per action. Millennial Media needs
two HTTP connections with two different servers: one to get the
ad, and the other one to get the associated static content.
Figure 1: The mobile advertising ecosystem and the interaction
of the players within it.
Provider
Retrieval Mechanism
Push
Pull
AdMob
Millennial Media
InMobi
X
X
X
X
Refresh Interval (s)
Min
12
15
20
Max
120
N/A
N/A
Table 1: Description of the refresh intervals and retrieval mech-
anisms supported by three popular ad networks.
sults show that for 3% of Android devices, ads account for
more than 1 MB, while for Apple devices this is even higher
and corresponds to more than 3 MB.
• Mobile ad trafﬁc is mainly composed of static images and
text ﬁles that are likely to be re-downloaded, with refresh
intervals in the order of just a few seconds.
• Mobile ad trafﬁc is the only type of network activity for some
apps.
On a wired network, the transmissions of trafﬁc can be assumed
to be "free”, however on a mobile network these are accompanied
by control channel signalling overhead, use of scarce spectrum re-
sources and battery implications. Low refresh intervals for down-
loading objects that have already been fetched previously further
depletes the scarce resources of mobile networks. Moreover, solu-
tions, such as pre-fetching and caching, are well understood in the
system and networking community to readily provide solutions to
a more spectrum-aware and energy-aware delivery of ads. Lever-
aging these techniques, we developed a system, called AdCache,
that enables energy efﬁcient and network friendly cache-based ad
delivery, built on the intrinsic characteristics of ad trafﬁc and mo-
bile apps. AdCache enables the retrieval of ads under optimal net-
work connectivity conditions for later display to the user, hence
avoiding excessive energy wastage, signalling strains on the net-
work and worsening the app responsiveness. We implement and
test AdCache on Android devices and show that it is able to reduce
the energy consumption of mobile advertising in ofﬂine apps by up
to 50% even with a low ad refresh interval of 20 seconds.
2. EXTRACTING AD TRAFFIC
The mobile ad ecosystem, as detailed by Leontiadis et al [1],
comprises multiple players: brands wanting to attract consumers,
ad agencies designing ad campaigns for brands, ad networks used
for distribution, publishers who create and publish mobile apps,
and users to which ads are shown. Mediation services are an addi-
tional player that integrates several ad networks, allowing publish-
ers to combine different ad networks and switch between them on
the ﬂy. Their main advantage is that they can potentially increase
the publisher’s revenues as if one ad network fails to return an ad at
its slot, it can try another ad network to ﬁll this gap.
344Figure 2: Example of a real work ﬂow for AdMob. The device incorporates the three power modes for mobile interfaces, and the
transitions between them. Transport layer details are not included. The HTTP requests include the domain name and the strings
used to identify the semantics in bold.
Figure 2 shows an example of a real work ﬂow for an ofﬂine
app requesting AdMob ads and the action triggered on a user click.
The ﬁgure highlights the semantics of the HTTP requests (shown
in Table 3) and some of the domains used by AdMob. Once a ra-
dio channel has been established, the client performs a DNS lookup
and the necessary HTTP transactions. As we can see, AdMob com-
prises several services and the number of HTTP requests can be
considerably high. A number of intermittent connections are go-
ing to be initiated depending on the refresh interval, causing costly
transitions between the different radio power modes. To our ben-
eﬁt however, the resulting HTTP ”conversations” tend to have a
consistent structure, allowing one to derive a number of regular ex-
pressions that could be used in the classiﬁcation of ad trafﬁc.
2.2 Identiﬁcation of ad trafﬁc
Table 2 lists the top 10 most popular free apps on Google Play,
as of 27th Feb. 2012, and the category that each app belongs to.
Manually inspecting the trafﬁc on a device, we also identiﬁed the
ad networks used by each app. We can see how, only considering
this small set, the ad ecosystem is highly diverse with a number of
different players, potentially following different approaches in the
delivery of ads.
To classify ad trafﬁc accurately, we need to be able to incorporate
such diversity. We perform such a task in two ways: i) by capturing
traces from app execution to understand the cause-effect relation-
ships (e.g. launching an ad-sponsored mobile app, requesting and
clicking on the ad displayed), or ii) by inspecting trafﬁc traces that
are collected within a provider in order to identify peculiar charac-
teristics of the trafﬁc (e.g. hostnames or URL parameters). In the
former case, we will be able to only inspect the ad delivery strategy
chosen by the app publisher. In the latter case, we can further obtain
information about the strategies followed by multiple publishers, as
well as the diversity in ad delivery, as manifested through the use
of different mediation services, and ad networks.
In both cases,
however, the fundamental challenge at hand is to be able to derive
a comprehensive set of rules to classify the ﬂows that are related to
ad networks, mediation services, and any possible analytics trafﬁc,
that facilitates the targeting of users with relevant ads.
With that in mind, we have used four different techniques. First,
we manually inspected the ad network SDKs and their documenta-
tion (if publicly available) to capture the way they use the network.
Second, we installed a number of popular ad-based apps on an An-
droid phone, and ran tcpdump to inspect what kind of services they
use and the network trafﬁc they generate, including the HTTP re-
quests. Third, we created our own app that displayed an ad banner,
and connected it with the most popular ad networks, to character-
ize the network behavior observed across a variety of ad networks.
Lastly, we analyzed a trace containing all HTTP transactions car-
345 1
0.3
 0.1
0.03
 0.01
0.003
F
D
C
C
 0.001
 0.001
Android
iPhone
iPad
 0.01
 0.1
 1
 10
Regex Traffic Volume [MB]
F
D
C
 1
 0.8
 0.6
 0.4
 0.2
 0
Android
iPhone
iPad
 0
 0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
 1
Ratio Regex/Total Traffic Volume
Figure 3: CCDF of the volume of ad trafﬁc per user.
Figure 4: The fraction of mobile ad ecosystem trafﬁc over the
total trafﬁc.
ried out by more than 3 million subscribers during a whole day
on a mobile network covering an entire country in Europe. In this
latter case, we made sure to ﬁlter out trafﬁc resulting from non-
mobile devices, given that the network in question allows tethering
and offers 3G USB dongles that are used by non-mobile devices to
connect to the mobile network.
The combination of the four processes, mentioned above, helped
us obtain a set of 122 rules featuring regular expressions that are
able to parse a URL and classify trafﬁc as i) ad network, ii) ana-
lytics, iii) mediation service, or iv) other. The rule set also helps
us to identify the type of action to be performed given a HTTP re-
quest. In Table 3, we show some examples of the rules obtained.
Each rule, deﬁned by a domain and URL object path, identiﬁes the
type of service, goal of the request (e.g. obtain conﬁguration script,
an ad or reporting a click), ad network and HTTP request method
(e.g. POST vs. GET) used. The compiled dictionary is publicly
available at [7].
3. AD TRAFFIC CHARACTERISATION
In this section we characterize ad trafﬁc leveraging on a data
set containing 1.7 billion trafﬁc connections, which corresponds to
22TB of volume downloaded on 13th Aug. 2011 by more than 3
million subscribers of a major European mobile network. The data
set comprises all TCP trafﬁc, excluding HTTPS, seen by acceler-
ation proxies installed on the network, that also cache and com-
press content for more efﬁcient delivery. To the best of our knowl-
edge, and according to the level of trafﬁc at the peering point of
this provider, we estimate the proportion of the secure trafﬁc to be
11.5%.
The monitoring activity at each vantage point is reported in a set
of text log ﬁles. Each entry in the logs contains a set of standard
information, such as IP addresses, port numbers, number of bytes
downloaded, and other HTTP speciﬁc information, such as content
type, HTTP user agent, and HTTP response code. User information
is anonymized but consistently hashed to a unique ID. Each line of
the logs corresponds to a different TCP connection performed by a
user.
The operator under study allows tethering and 3G connectivity
through a USB dongle. In order to ensure that our analysis focuses
on ad trafﬁc generated truly by mobile devices and apps, we have
ﬁltered out this trafﬁc. To achieve this we used a methodology
based on the inspection of the HTTP user agent, normally including
information about the Operating System (OS) of the device. All
PC users, as well as those found to be using more than one OS
during the day, have been ﬁltered out from the original data set.
This amount of trafﬁc is not negligible, corresponding to 29.6% of
the bytes downloaded by 7.2% of the users. This step further allows
us to study ad delivery against the type of the platform used, e.g.
Android, iPhone and iPad.
In what follows, we study the ad, mediation, and analytics trafﬁc
(called regex trafﬁc for short) extracted from the sanitized mobile
data set. We want to highlight that analytics services provide a stan-
dard framework to control the general activity of apps so they are
not adopted in ad-sponsored apps only. However, we decided to
include them in the analysis for completeness. We focus our char-
acterization along ﬁve main axes: i) overall volume of ad services,
ii) main actors, iii) type of ad content, iv) generating apps, and v)
ad frequency.
3.1 Ad volume
Figure 3 shows the Complementary Cumulative Distribution Func-
tion (CCDF) of the regex trafﬁc volume. While this trafﬁc only
corresponds to 31 kB per day for 50% of the devices, the distribu-
tions are characterized by their long tails. We can see how 10% and
1% of the iPhone devices download more than 400 kB and 2 MB
of advertising related content respectively, while Android and iPad
devices consume even more. Unexpectedly, the top 5 users together
have consumed 1.35 GB, 701 MB and 124 MB just for regex traf-
ﬁc on Android, iPhone and iPad respectively. The single top users
account for 458 MB, 167 MB and 31 MB for the three platforms.
These values might be the indication of outliers in the popula-
tion. To better evaluate the weight of the regex trafﬁc, Figure 4
reports the Cumulative Distribution Function (CDF) of the ratio
between the volume of regex trafﬁc and the total volume of traf-
ﬁc consumed by each user in the entire day. We can see that the
trafﬁc caused by the mobile ad ecosystem players is a strong com-
ponent of the users’ trafﬁc. In particular, for 20% of iPad devices
this trafﬁc accounts for more than 4.7% of their trafﬁc, while for
iPhone devices it is 7.6%. This phenomenon is even more critical
for Android users with 50% of them having more than 5% their
total volume related to regex trafﬁc.
3.2 Main actors
The regex data set contains three classes of ad trafﬁc: ad net-
works, analytics services, and mediation services. These classes do
not have the same weight on the aggregate volume. Table 4 reports
the percentage of users, ﬂows, and bytes for the three classes of
trafﬁc across the three most popular mobile platforms. We can see
some differences across the device types.
In particular, Android
and iPhone present similar shares while for iPad both mediation
and analytics services are less adopted. More than 90% of the vol-
ume is delivered by the ad networks, but we can also notice a sharp
component of “control” trafﬁc related to analytics and mediation
services.
346%Users
%Flows
%Bytes
Devtype
Android
iPhone
iPad
AN AS MS
81.3 61.0 32.2