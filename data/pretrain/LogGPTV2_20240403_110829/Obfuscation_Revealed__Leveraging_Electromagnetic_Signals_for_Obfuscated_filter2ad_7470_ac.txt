[21] Jared Lee, Thomas H Austin, and Mark Stamp. 2015. Compression-based analysis
of metamorphic malware. International Journal of Security and Networks 10, 2
(2015), 124–136.
[22] Stefan Mangard, Elisabeth Oswald, and Thomas Popp. 2007. Power analysis
attacks - revealing the secrets of smart cards. Springer.
[23] Yair Meidan, Michael Bohadana, Yael Mathov, Yisroel Mirsky, Asaf Shabtai, Do-
minik Breitenbacher, and Yuval Elovici. 2018. N-BaIoT—Network-Based Detection
of IoT Botnet Attacks Using Deep Autoencoders. IEEE Pervasive Computing 17,
3 (July 2018), 12–22. https://doi.org/10.1109/MPRV.2018.03367731 Conference
Name: IEEE Pervasive Computing.
[24] A. Nazari, N. Sehatbakhsh, M. Alam, A. Zajic, and M. Prvulovic. 2017. EDDIE:
EM-based detection of deviations in program execution. In 2017 ACM/IEEE 44th
Annual International Symposium on Computer Architecture (ISCA). 333–346.
[25] Markus F.X.J. Oberhumer, László Molnár, and John F. Reiser. [n.d.]. UPX the
Ultimate Packer for eXecutables. https://upx.github.io/
[26] P. O’Kane, S. Sezer, and K. McLaughlin. 2011. Obfuscation: The Hidden Malware.
IEEE Security & Privacy 9, 5 (2011), 41–47. http://dblp.uni-trier.de/db/journals/
ieeesp/ieeesp9.html#OKaneSM11
[27] F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M.
Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cour-
napeau, M. Brucher, M. Perrot, and E. Duchesnay. 2011. Scikit-learn: Machine
Learning in Python . Journal of Machine Learning Research 12 (2011), 2825–2830.
[28] Stjepan Picek, Annelie Heuser, and Sylvain Guilley. 2017. Template attack versus
Bayes classifier. J. Cryptogr. Eng. 7, 4 (2017), 343–351. https://doi.org/10.1007/
s13389-017-0172-7
[29] Milos Prvulovic, Alenka Zajić, Robert L Callan, and Christopher J Wang. 2016.
A method for finding frequency-modulated and amplitude-modulated electro-
magnetic emanations in computer systems. IEEE Transactions on Electromagnetic
Compatibility 59, 1 (2016), 34–42.
[30] Thomas Raffetseder, Christopher Kruegel, and Engin Kirda. 2007. Detecting
System Emulators. In Information Security, Juan A. Garay, Arjen K. Lenstra,
Masahiro Mambo, and René Peralta (Eds.). Springer Berlin Heidelberg, Berlin,
Heidelberg, 1–18.
[31] R. A. Riley, J. T. Graham, R. M. Fuller, R. O. Baldwin, and A. Fisher. 2019. A
New Way to Detect Cyberattacks: Extracting Changes in Register Values From
Radio-Frequency Side Channels. IEEE Signal Processing Magazine 36, 2 (March
717Obfuscation Revealed: Leveraging Electromagnetic Signals for Obfuscated Malware Classification
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
9 APPENDIX
9.1 Neural network architectures
Layer
Flatten
Dense
Dense
Dense
Dense
spectrogram_size
Size
500
200
100
N
Filter Activation
leaky relu
leaky relu
leaky relu
leaky relu
softmax
_
_
_
_
_
Table 4: MLP architecture
when applying this technique to MLP and CNN classifications. One
reason could be that the random user environment changes for
each execution, thus even though the binary stays unaltered, the
measurement trace changes. Now when calculating the mean, the
patterns of features that may help MLP and CNN to make correct
predictions may be mixed or changed. Contrary. NB and even SVM
may not be able to model these patterns due to their more simplistic
nature and computing the mean can be seen as noise reduction
instead.
Layer
Convolution
Max Pooling
Convolution
Convolution
Max Pooling
Convolution
Convolution
Max Pooling
Dense
Dense
Dense
Table 5: CNN architecture
Size
64
64
128
128
128
256
256
256
128
64
N
leaky relu
leaky relu
Filter Activation
7 × 7
leaky relu
2 × 2
3 × 3
3 × 3
2 × 2
3 × 3
3 × 3
2 × 2
_
_
_
leaky relu
leaky relu
softmax
leaky relu
leaky relu
_
_
_
9.2 Experimental results on the meaning of
test traces
Figure 7 shows accuracy of NB and SVM when calculating the mean
over t execution measurements from the same binary in the test
dataset. We see an improvement in all scenarios. Therefore, when
the number of executions/ measurements per unknown binary is
not a restricting factor for the malware analyst, then computing the
mean over t traces will result in a more accurate prediction. This
meaning process is usually in the side-channel domain, as in [8].
Interestingly, we could not observe a straightforward improvement
Figure 7: Accuracy when computing the mean over t =
[1, 2, 3, . . . , 10] samples per binary in the test dataset. One can
observe a drastic performance improvement for SVM and
NB for the scenarios where the accuracy was lower to be-
gin with. For type and novelty classification the accuracy
reaches 100%.
123456789100.600.650.700.750.800.850.900.951.00accuracyNB12345678910SVM0.00.20.40.60.81.0Number of traces bds0.00.20.40.60.81.0ExecutableFamilyNoveltyObfuscationPackerTypeVirtualization718ACSAC ’21, December 6–10, 2021, Virtual Event, USA
D.P. Pham and D. Marion et al.
p
l
a
y
a
u
d
i
o
t
a
k
e
p
i
c
t
u
r
e
e
n
c
o
d
e
v
i
d
e
o
r
e
c
o
r
d
c
a
m
e
r
a
b
a
s
h
l
i
t
e
b
a
s
h
l
i
t
e
_
b
c
f
b
a
s
h
l
i
t
e
_
u
p
x
b
a
s
h
l
i
t
e
_
fl
a
t
t
e
n
b
a
s
h
l
i
t
e
_
s
u
b
b
a
s
h
l
i
t
e
_
v
i
r
t
u
a
l
i
z
e
b
a
s
h
l
i
t
e
_
c
ffl
a
t
t
e
n
b
a
s
h
l
i
t
e
_
a
d
d
o
p
a
q
u
e
.
.
.
k
i
s
n
i
-
4
1
9
5
7
-
v
7
+
k
o
m
a
K
_
i
t
4
1
9
5
7
-
v
7
+
k
o
g
o
n
n
a
c
r
y
_
a
d
d
o
p
a
q
u
e
.
.
.
g
o
n
n
a
c
r
y
_
c
ffl
a
t
t
e
n
g
o
n
n
a
c
r
y
_
s
u
b
g
o
n
n
a
c
r
y
_
b
c
f
g
o
n
n
a
c
r
y
_
fl
a
t
t
e
n
d
e
s
-
u
p
x
-
g
o
n
n
a
c
r
y
g
o
n
n
a
c
r
y
_
V
i
r
t
u
a
l
i
z
e
2
a
e
s
-
g
o
n
a
c
r
y
d
e
s
-
g
o
n
n
a
c
r
y
u
p
x
-
g
o
n
n
a
c
r
y
a
e
s
-
u
p
x
-
g
o
n
a
c
r
y
g
o
n
n
a
c
r
y
u
p
x
-
m
i
r
a
i
i
r
a
i
-
s
u
b
m
m
m
m
m
m
m
i
r
a
i
-
b
c
f
i
r
a
i
_
fl
a
t
t
e
n
i
r
a
i
-
c
ffl
a
t
t
e
n
i
r
a
i
_
v
i
r
t
u
a
l
i
z
e
i
r
a
i
_
a
d
d
o
p
a
q
u
e
r
a
n
d
o
m
3
4
i
r
a
i
.
a
r
m
7
B
i
n
a
r
i
e
s
n
a
m
e
s
1
0
0
0
1
0
0
0
1
0
0
0
1
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0
0
3
0
0