  * 威胁检测并不只是技术问题，同时需要有正确的商业过程和步骤，对员工进行教育让他们知道如何使用工具和做响应的决定。
## 威胁情报定义
企业威胁情报的定义是：
> 上下文相关、基于证据的知识、融入到平台和工具中，能很快和正确的解决个人、企业所面临的威胁的生态系统或标准化的资产。
如果企业想要接近实时地对安全事件进行回应，那么企业就需要威胁情报。但是想要威胁情报作为一种有价值的商业过程并不简单：安全产业并没有在威胁情报的最优管理上达成共识。
威胁情报的源分为以下三类：
  * 目标情报。这包括威胁单元和他们所用的技术，以及C&C基础设施的信息，也可能包含目标行业和伤害着的信息。
  * 恶意软件情报。包括已知恶意软件和技术、目标漏洞、被逆向的恶意软件的信息。
  * 名声情报。已知的恶意IP地址、域名和URL的信息。
## 威胁可见性
### 威胁数据的内部来源
你发现安全事件的主要来源可能是日志数据收集。企业的集中化的日志收集和事件检测应该包含以下的日志源：
  * 防火墙
  * 路由器和交换机
  * IPS
  * 网络流系统
  * Web过滤器
  * Data loss prevention 数据丢失预防系统
  * 邮件服务器和垃圾邮件过滤器
  * 服务器、数据库管理系统和应用
  * 终端
  * 物理安全系统
  * 环境控制系统
  * 代理
  * 无线AP
  * 漏洞扫描工具
网络上存储、处理、传递敏感数据的设备都应该记录日志到集中的日志管理系统中。
### 威胁数据的外部来源
企业要在边界外寻找威胁情报数据来使他们能对潜在威胁进行响应。这包括威胁数据的技术源和策略源。首先看一下技术源：
  * 厂商安全建议。成熟的硬件和软件厂商会公布公司产品的安全建议来向客户发出威胁和解决方案的告警消息。
  * 开源安全建议。一些安全研究团队和公司会公布一些威胁信息。这些建议的发布时间会比厂商的建议更早一些。
  * 法律实施和新闻媒体。美国国土安全部这样的法律实施组织会向公众和可信方发布建议。
  * 商业解决方案。IBM Xforce也会威胁情报提供源。
### 处理威胁数据
之前说过要把分散在不同位置的日志数据集中在一起，但这不只是存储GB/PB级的日志数据。还需要对这些数据进行实时分析，及时识别威胁，让工作人员可以及时响应和阻止威胁。QRadar就是这样的安全信息和事件管理平台，集日志收集、管理、异常检测、取证、漏洞管理为一体。
图3 QRadar主界面
### 异常检测
一个检测威胁的有效方法是能够在系统和网络中检测异常，这是通过长期观察系统行为和网络流量进行的，这也是一个基线。当系统或网络中出现没有出现过的任何事（异常），就会产生告警，工作人员随后采取行动和调查。  
异常检测有三个主要的组件：
  * 用户、应用和数据剖析
  * 阀值
  * 季节性
异常可以通过自动化的规则和特定的查找规则发现。基本点是通过用户行为的明显变化、应用的连接数、数据量等来识别。
# 4 威胁响应
## 响应安全事件
### 响应步骤
1、检测  
在这一阶段意识到安全事件的存在，这可能来源于SIEM（security information and event
management）平台或者外部厂商发布的警告或通知。  
2、分析  
通过研究事件的线索来证明它的合理性，还要看是否和一些预兆信息相关。分析师可能需要做进一步测试、收集额外的信息来建立一个更加完整的事件画面。  
3、优先级  
在事件分析的过程中，专业技术人员会迅速理解事件对组织继续处理能力的影响，也就是对重要信息的机密性和完整性的影响。对事件评定优先级可以帮助管理人员理解随后的步骤中需要使用的资源。  
4、通知  
事件响应需要通过在组织中通知合理的人员。组织需要通知外部的第三方，比如客户、商业伙伴、管理者、法律执行者和公众等。决定通知的范围掌握在高管手中。  
5、遏制和取证  
事件响应者和可能参与的其他工作人员开始采取措施来停止该事件，包括短期的改变来停止该事件。同时，需要进行取证工作的证据采集。  
6、恢复  
事件响应者移除恶意软件、重建系统、备份恢复、系统补丁分发、采取响应的措施防止同样的事件再次发生。  
7、事件回看  
事后回看的目的是检查事件检测开始的步骤和事件响应。这帮助找出事件检测和响应的不同方面，改善系统、工具、过程和员工培训的机会。目的是为了防止再次发生和改善响应。
### 培训
这种事件并不会经常在大多数组织中发生，所以事件响应者可能不熟悉这些过程。为了让事件响应者更熟悉响应的过程，需要进行下面的过程：  
培训：有经验的应急响应专家（老师）进行过程的培训。  
实践：模拟真实的事件，让培训的经验更加真实、记得也更加深刻。  
建议的培训周期是每年一次。
### 自动修复