Note that Â¯ğ‘¥ğ‘– âˆˆ Z2â„“ is chosen from ğ·ğ‘Z+ğ‘¥ğ‘–,ğœ1 if ğ‘– âˆˆ [â„“]
âˆš
and ğ·ğ‘Z+ğ‘¥ğ‘–,ğœ2 otherwise. We thus have â€–Â¯xâ€– â‰¤ (ğœ1 + ğœ2)
â„“ Â·
âˆš
log ğœ†) with probability 1 âˆ’ ğœ†âˆ’ğœ”(1). This, together with
âˆš
ğœ”(
e1 âˆ¼ ğ·2â„“Z,ğ›¼ğ‘, implies that |âŸ¨Â¯x, e1âŸ©| â‰¤ ğ›¼ğ‘(ğœ1 + ğœ2)
â„“ Â· ğœ”(log ğœ†)
with probability 1 âˆ’ ğœ†âˆ’ğœ”(1). Furthermore, since each column
âˆš
of Z is chosen from ğ·2â„“Z,ğœ0 , we have â€–zxâ€– â‰¤ ğœ0(ğœ1 + ğœ2)
â„“ğ‘š Â·
ğœ”(log ğœ†) with probability 1 âˆ’ ğœ†âˆ’ğœ”(1). As a result, we have
|âŸ¨zx, e0âŸ©| â‰¤ ğœ0(ğœ1 + ğœ2)ğ›¼ğ‘
â„“ğ‘š Â· ğœ”(log3/2 ğœ†) with probability
1 âˆ’ ğœ†âˆ’ğœ”(1).
âˆš
Security. We now show that the scheme above is secure,
for our relaxed notion of ğ¿-IND-CPA security. The proof is
similar to [4], but we exploits the weaker security model of
bounded number of random key queries. In particular, we
perform a much more careful analysis on the conditional
distribution of Z from the view of the adversary.
Theorem 4.1. If the parameters are set as above, the
above scheme is ğ¿-IND-CPA secure under the LWEğ‘›,ğ‘š,ğ‘,ğ›¼â€²
assumption.
Proof. The proof proceeds with a sequence of games that
starts with the real game and ends with a game in which the
adversaryâ€™s advantage is negligible. For each ğ‘–, we call ğ‘†ğ‘– the
event that the adversary wins in Game ğ‘–.
Game 0: This is the ordinary security game. Namely, at
the outset of the game, the adversary ğ’œ is given the master
public key pk. Then, it sees ğ‘„ random vectors {xğ‘–}ğ‘–âˆˆ[ğ‘„],
where xğ‘– â†Ë’ Z2â„“
ğ‘ and ğ‘„ is an arbitrary polynomial specified
by ğ’œ. Then, it makes secret key queries for these vectors.
The number of the key queries is bounded by ğ¿. Note that
the adversary can only make key queries for random vectors
chosen as x â†Ë’ Z2â„“
ğ‘ . In the challenge phase, the adversary ğ’œ
7We note that it is possible to choose parameters that allow to take ğ‘ as
low as ğ‘ = 2, but in our trace-and-revoke application we use ğ‘ = ğœ†ğœ”(1)
to guarantee correctness.
Session K1:  Secure ComputationCCSâ€™17, October 30-November 3, 2017, Dallas, TX, USA2288comes up with two distinct vectors y0, y1 and receives an
encryption ğ¶ of yğ›½ for ğ›½ â†Ë’ {0, 1} sampled by the challenger.
The adversary is not allowed to make secret key queries after
the challenge phase. When ğ’œ halts, it outputs ğ›½â€² âˆˆ {0, 1} and
ğ‘†0 is the event that ğ›½â€² = ğ›½. Note that for any vector x for
which ğ’œ makes a secret key query, we must have âŸ¨x, y0âŸ© â‰¡
âŸ¨x, y1âŸ© mod ğ‘ if ğ’œ is a legitimate adversary.
Game 1: We modify the generation of x and Â¯x for all secret
key queries. Namely, instead of choosing x â†Ë’ Z2â„“
ğ‘ and then
sampling Â¯x, the challenger first chooses Â¯x = (Â¯ğ‘¥1, . . . , Â¯ğ‘¥2â„“)ğ‘¡ as
Â¯ğ‘¥ğ‘– â†Ë’ ğ·Z,ğœ1 for ğ‘– âˆˆ [â„“] and Â¯ğ‘¥ğ‘– â†Ë’ ğ·Z,ğœ2 for ğ‘– âˆˆ [â„“ + 1, 2â„“] and
then sets x := Â¯x mod ğ‘. We claim that this changes the joint
distribution of (x, Â¯x) only negligibly. To see this, we observe
that the distribution of Â¯ğ‘¥ğ‘– conditioned on Â¯ğ‘¥ğ‘– â‰¡ ğ‘¥ğ‘– mod ğ‘
is ğ·ğ‘Z+ğ‘¥ğ‘–,ğœ1 for ğ‘– âˆˆ [â„“] and ğ·ğ‘Z+ğ‘¥ğ‘–,ğœ2 for ğ‘– âˆˆ [â„“ + 1, 2â„“].
Therefore, it suffices to show that Â¯ğ‘¥ğ‘– mod ğ‘ is statistically
close to the uniform distribution over Zğ‘ when Â¯ğ‘¥ğ‘– is chosen
âˆš
from ğ·Z,ğœ1 or ğ·Z,ğœ2 . This follows from ğœ1, ğœ2 â‰¥ ğ‘ Â· â„¦(
ğœ†)
and Lemma 2.4. Therefore, we have that | Pr[ğ‘†1] âˆ’ Pr[ğ‘†0]| â‰¤
2âˆ’Î©(ğœ†).
Game 2: We modify the generation of ğ¶ = (c0, c1) in the
challenge phase. Namely at the outset of the game, the chal-
ğ‘ , e â†Ë’ ğ·ğ‘šZ,ğ›¼â€²ğ‘ (which may be chosen
lenger picks s â†Ë’ Zğ‘›
. Let V âˆˆ Z(ğ‘š+2â„“)Ã—ğ‘š
ahead of time) as well as Z â†Ë’ ğ·2â„“Ã—ğ‘šZ,ğœ0
be the matrix that is obtained by putting Iğ‘š on top of Z,
where Iğ‘š is the unit matrix of size ğ‘š. We then set the
ciphertext ğ¶ = (c0, c1) âˆˆ Zğ‘š
ğ‘ Ã— Z2â„“
ğ‘ as
b = As + e
â€²
â€²
ğ‘, ğ›¼/(2ğ›¼
(c0â€–c1) = ReRand(V, b, ğ›¼
this, we first observe that ğ‘ 1(V) â‰¤âˆšï¸€1 + ğ‘ 1(Z)2 â‰¤ ğ‘‚(ğœ0
)) + ğ‘ğ‘˜âˆ’1 Â· yğ›½ (4)
where ReRand is from Lemma 2.5. We claim that this change
âˆš
alters the view of the adversary only negligibly. To show
ğ‘š)
holds with all but 2âˆ’Î©(ğ‘š) â‰¤ 2âˆ’Î©(ğœ†) probability by Lemma 2.7.
By Lemma 2.5 and our parameter choices, we have
c0 = Iğ‘š Â· As + e0 = As + e0,
c1 = Z Â· As + e1 + ğ‘ğ‘˜âˆ’1 Â· yğ›½ = Us + e1 + ğ‘ğ‘˜âˆ’1 Â· yğ›½,
where e0 and e1 are within statistical distance 2âˆ’Î©(ğœ†) from
ğ·ğ‘šZ,ğ›¼ğ‘. Therefore,we have that | Pr[ğ‘†2] âˆ’ Pr[ğ‘†1]| â‰¤ 2âˆ’Î©(ğœ†).
Game 3: We further modify the generation of ğ¶ = (c0, c1)
in the challenge phase. Instead of setting b = As + e, we
choose b = u + e, where u â†Ë’ Zğ‘š
ğ‘ . Then, the ciphertext is
set as in Equation (4). Under the LWE assumption, we have
that | Pr[ğ‘†3] âˆ’ Pr[ğ‘†2]| is negligible.
Game 4: We modify the generation of ğ¶ = (c0, c1) once
more. Namely, the ciphertext is now set as
c0 = u + e0,
c1 = Z Â· u + e1 + ğ‘ğ‘˜âˆ’1 Â· yğ›½,
ğ‘ and e0, e1 â†Ë’ ğ·ğ‘šZ,ğ›¼ğ‘. Similarly to Game 2,
where u â†Ë’ Zğ‘š
this change does not alter the view of the adversary much.
By Lemma 2.5 and our parameter choices, we have that
| Pr[ğ‘†4] âˆ’ Pr[ğ‘†3]| â‰¤ 2âˆ’Î©(ğœ†). Below, we prove that Pr[ğ‘†4] is
exponentially close to 1/2, which will complete the proof.
ğ‘ . Let {xğ‘–ğ‘— âˆˆ Z2â„“
Define y = y1 âˆ’ y0 âˆˆ Z2â„“
ğ‘ }ğ‘—âˆˆ[ğ¿â€²] be the
vectors corresponding to the secret key queries made by
ğ’œ, where ğ¿â€² â‰¤ ğ¿. As ğ’œ is a legitimate adversary, we have
âŸ¨xğ‘–ğ‘— , yâŸ© = 0 mod ğ‘ for each secret key query xğ‘–ğ‘— . The view of
the adversary contains ğ¿â€² tuples {xğ‘–ğ‘— , Â¯xğ‘–ğ‘— , zxğ‘–ğ‘—
}ğ‘—âˆˆ[ğ¿â€²], where
the vectors {xğ‘–ğ‘—}ğ‘—âˆˆ[ğ¿â€²] form a Zğ‘-basis of a subspace of the
(2â„“ âˆ’ 1)-dimensional vector space yâŠ¥ := {x âˆˆ Z2â„“
ğ‘ : âŸ¨x, yâŸ© =
0 mod ğ‘}. We define Xğ‘¡ğ‘œğ‘ âˆˆ Zğ¿â€²Ã—2â„“ as the matrix whose ğ‘—-th
row is Â¯xğ‘¡
ğ‘–ğ‘— for ğ‘— âˆˆ [ğ¿â€²].
We say that Xğ‘¡ğ‘œğ‘ âˆˆ Zğ¿â€²Ã—2â„“ is good when we can choose
U âˆˆ Z2â„“Ã—2â„“ such that | det U| = 1, Xğ‘¡ğ‘œğ‘ Â· U = (Iğ¿â€²|0), and
âˆš
every row of U has norm â‰¤ ğ‘‚(
ğœ…â„“ğœ2) (see Lemma 2.9). For
a good Xğ‘¡ğ‘œğ‘, we can define X âˆˆ Z2â„“Ã—2â„“ as X := Uâˆ’1. It can
be seen that the upper ğ¿â€² rows of X corresponds to Xğ‘¡ğ‘œğ‘.
We denote the lower 2â„“ âˆ’ ğ¿â€² rows of the matrix as Xğ‘ğ‘œğ‘¡.
We note that since X is invertible over Z, so is it modulo ğ‘.
Without loss of generality, we assume that U and Xğ‘ğ‘œğ‘¡ are
deterministically determined from Xğ‘¡ğ‘œğ‘. (If there are more
than one matrix satisfying the required properties, we sort
them in the lexicographical order and pick the first one.)
Note that it might be infeasible to efficiently compute U
and Xğ‘ğ‘œğ‘¡ from Xğ‘¡ğ‘œğ‘. This does not cause any problem in our
proof because all the following arguments are information
theoretic.
We state the following lemmas:
Lemma 4.2. Assume that ğœ0 â‰¥ â„¦(ğ‘ğœ…â„“ğœ2) and ğ‘ğ‘›+1/ğ‘ğ‘š â‰¤
2âˆ’Î©(ğœ…). Then the following distributions are within 2âˆ’Î©(ğœ…)
statistical distance:
(A, u, ZA, Xğ‘¡ğ‘œğ‘, Xğ‘¡ğ‘œğ‘Z, Xğ‘ğ‘œğ‘¡Zu) â‰ˆ
(A, u, ZA, Xğ‘¡ğ‘œğ‘, Xğ‘¡ğ‘œğ‘Z, v)
ğ‘
, u â†Ë’ Zğ‘š
where A â†Ë’ Zğ‘šÃ—ğ‘›
Xğ‘¡ğ‘œğ‘ âˆˆ Zğ¿â€²Ã—2â„“
is chosen from ğ·â„“Z,ğœ1Ã—ğ·â„“Z,ğœ2 , and v â†Ë’ Z2â„“âˆ’ğ¿â€²
.
Note that if Xğ‘ğ‘œğ‘¡ is not good, then Xğ‘ğ‘œğ‘¡ is undefined. In such
a case, the term Xğ‘ğ‘œğ‘¡Zu is replaced with âŠ¥.
ğ‘ , Z â†Ë’ ğ·2â„“Ã—ğ‘šZ,ğœ0
, each row of
ğ‘
ğ‘
Lemma 4.3. If there exists an adversary ğ’œ whose advan-
tage in Game 4 is ğœ–, then there exists another (unbounded)
adversary â„¬ whose distinguishing advantage between the two
distributions in Lemma 4.2 is ğœ€/ğ‘„ğ¿â€²
.
Given these two lemmas, we can conclude the proof of
< 2âˆ’Î©(ğœ…) and thus
â–¡
Theorem 4.1 since these imply ğœ€/ğ‘„ğ¿â€²
ğœ€ < ğ‘„ğ¿ Â· 2âˆ’Î©(ğœ…) = 2ğ‘‚(ğ¿ log ğœ†)âˆ’Î©(ğœ…) â‰¤ 2âˆ’Î©(ğœ†).
It remains to prove Lemmas 4.2 and 4.3.
Proof of Lemma 4.2. By Lemma 2.9, matrix Xğ‘¡ğ‘œğ‘ is
good with all but 2âˆ’Î©(ğœ…) probability. In the following, let us
fix good Xğ‘¡ğ‘œğ‘ and prove that the above two distributions
are 2âˆ’Î©(ğœ…)-close. We first consider the distribution Xğ‘ğ‘œğ‘¡Z
conditioned on Xğ‘¡ğ‘œğ‘Z. Note that in Xğ‘¡ğ‘œğ‘Z and Xğ‘ğ‘œğ‘¡Z, ma-
trices Xğ‘¡ğ‘œğ‘ and Xğ‘ğ‘œğ‘¡ act in parallel on the columns of Z.
We can hence restrict ourselves to the distribution of Xğ‘ğ‘œğ‘¡zğ‘–
conditioned on Xğ‘¡ğ‘œğ‘zğ‘–, with zğ‘– sampled from ğ·Z2â„“,ğœ0 . Let
bğ‘– = Xğ‘¡ğ‘œğ‘zğ‘– âˆˆ Zğ¿â€²
ğ‘– âˆˆ Z2â„“ arbitrary such that
and fix zâ‹†
Session K1:  Secure ComputationCCSâ€™17, October 30-November 3, 2017, Dallas, TX, USA2289Î£
âˆš
Î£
,ğœ0
âˆ’ğ‘¡
Uğ‘¡
ğ‘– ,ğœ0 .
ğ‘– ,ğœ0 is ğ·Z2â„“âˆ’ğ¿â€²
âˆ’1,w, where Î£ = Uğ‘¡
bğ‘– = Xğ‘¡ğ‘œğ‘zâ‹†
ğ‘– . The distribution of zğ‘– given (Xğ‘¡ğ‘œğ‘, Xğ‘¡ğ‘œğ‘zğ‘–) is
ğ‘– ,ğœ0 , with Î› = {x âˆˆ Z2â„“ : Xğ‘¡ğ‘œğ‘x = 0}. Therefore, we
ğ·Î›+zâ‹†
have that given Xğ‘¡ğ‘œğ‘zğ‘–, the vector Xğ‘ğ‘œğ‘¡zğ‘– is distributed as
Xğ‘ğ‘œğ‘¡ Â· ğ·Î›+zâ‹†
Let Uğ‘™ğ‘’ğ‘“ (resp. Uğ‘Ÿğ‘–ğ‘”) denote the left ğ¿â€² (resp. right 2â„“âˆ’ğ¿â€²)
columns of U. We are to show that the distribution Xğ‘ğ‘œğ‘¡ Â·
ğ·Î›+zâ‹†
ğ‘Ÿğ‘–ğ‘”Uğ‘Ÿğ‘–ğ‘” and
w = âˆ’âˆš
ğ‘Ÿğ‘–ğ‘”Uğ‘™ğ‘’ğ‘“ bğ‘–. To see this, we first show that the
supports of both distributions are the same. More specifically,
we prove Xğ‘ğ‘œğ‘¡ Â· Î› = Z2â„“âˆ’ğ¿â€²
. To do so, it suffices to show
that for any a âˆˆ Z2â„“âˆ’ğ¿â€²
, we have a âˆˆ Xğ‘ğ‘œğ‘¡ Â· Î›. By the
construction of U, we have Xğ‘¡ğ‘œğ‘Uğ‘Ÿğ‘–ğ‘” = 0 and Xğ‘ğ‘œğ‘¡Uğ‘Ÿğ‘–ğ‘” =
I2â„“âˆ’ğ¿â€² . Now, a âˆˆ Xğ‘ğ‘œğ‘¡ Â· Î› follows because we have a =
Xğ‘ğ‘œğ‘¡ Â· (Uğ‘Ÿğ‘–ğ‘”a) and Xğ‘¡ğ‘œğ‘ Â· Uğ‘Ÿğ‘–ğ‘”a = 0. We next evaluate the
probability of a âˆˆ Z2â„“âˆ’ğ¿â€²
ğ‘– ,ğœ0 .
This probability equals to the probability of aâ€² âˆˆ Z2â„“ being
ğ‘– ,ğœ0 for aâ€² that is the unique vector in Î› + zâ‹†
output by ğ·Î›+zâ‹†
satisfying a = Xğ‘ğ‘œğ‘¡ Â· aâ€². Since aâ€² âˆˆ Î› + zâ‹†
ğ‘– , we have Xğ‘¡ğ‘œğ‘ Â· aâ€² =
Xğ‘¡ğ‘œğ‘(aâ€² âˆ’ zâ‹†
ğ‘– = 0 + bğ‘– = bğ‘–. Therefore, the vector
aâ€² can be written as aâ€² = Xâˆ’1(bğ‘–â€–a) = U(bğ‘–â€–a) = Uğ‘™ğ‘’ğ‘“ bğ‘– +
Uğ‘Ÿğ‘–ğ‘”a. The probability we consider is proportional to
being output by Xğ‘ğ‘œğ‘¡ Â· ğ·Î›+zâ‹†
ğ‘– ) + Xğ‘¡ğ‘œğ‘zâ‹†
ğ‘–
âˆ’ğ‘¡
ğ‘Ÿğ‘–ğ‘”Uğ‘™ğ‘’ğ‘“ bğ‘–â€–2/ğœ2
Uğ‘¡
âˆš
âˆ’ğ‘¡
Î£
ğ‘Ÿğ‘–ğ‘”Uğ‘™ğ‘’ğ‘“ bğ‘–â€–2)/ğœ2
Uğ‘¡
0
0
)ï¸
0
âˆš
)ï¸€
)ï¸€
â€²â€–2/ğœ2
exp(ï¸€âˆ’ğœ‹â€–a
= exp(ï¸€âˆ’ğœ‹â€–Uğ‘™ğ‘’ğ‘“ bğ‘– + Uğ‘Ÿğ‘–ğ‘”aâ€–2/ğœ2
(ï¸âˆ’ğœ‹â€–
(ï¸âˆ’ğœ‹(â€–Uğ‘™ğ‘’ğ‘“ bğ‘–â€–2 âˆ’ â€–
âŸ
(ï¸âˆ’ğœ‹â€–
does not depend on a
Î£(a âˆ’ w)â€–2/ğœ2
= exp