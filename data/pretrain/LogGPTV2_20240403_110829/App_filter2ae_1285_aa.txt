# 针对比特币钱包App的三种漏洞攻击与对策
|
##### 译文声明
本文是翻译文章，文章原作者 Yiwen Hu, Sihan Wang, Guan-Hua Tu, Chi-Yu Li，文章来源：cse.msu.edu
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
如今，比特币是最受欢迎的加密货币。随着智能手机和高速移动互联网的普及，越来越多的用户开始在智能手机上访问其比特币钱包。用户可以在智能手机上下载并安装各种比特币钱包应用程序（例如Coinbase，Luno，Bitcoin
Wallet），并可以随时随地访问其比特币钱包。但是，这些比特币手机应用程序不一定安全，它们会扩展攻击者的新攻击面。在这项工作中探索了10种最受欢迎的比特币钱包App的不安全性，并发现了三个安全漏洞。通过利用它们，攻击者可以发起各种攻击，包括比特币去匿名，反射和放大垃圾信息以及钱包欺诈攻击。为了解决已确定的安全漏洞，本研究开发了一种工具Bitcoin
Security Rectifier，以保护比特币钱包App用户的安全。开发的工具不需要对当前的钱包应用程序进行任何修改，并且符合比特币标准。
## 0x01 Introduction
许多消费者和企业（例如Microsoft，Newegg，Overstock，Subway，Starbucks）已接受比特币作为付款方式。随着高速移动互联网的迅速部署和智能手机的普及，越来越多的用户开始通过各种比特币钱包App访问其比特币钱包。比特币钱包App是否会为攻击者创建新的攻击媒介，从而对移动用户发起新的攻击？不幸的是，本文研究得出了肯定的答案。在这项工作中，研究了10种最受欢迎的比特币钱包App（按下载次数排名），发现了三个安全漏洞，涵盖了比特币钱包应用程序的实现和比特币钱包应用程序服务的运行。本文发现，已被各种比特币钱包App广泛使用的比特币应用程序库
_BitcoinJ_
泄漏了比特币钱包用户的隐私（例如，所有用户的比特币地址）（漏洞V1）并在不向用户提供任何通知或警报的情况下，在后台不断下载用户不想要的比特币交易（漏洞V2）。此外，发现比特币钱包App可能违反了比特币钱包服务去中心化的原则，这些应用程序的用户更容易受到金融欺诈攻击。更具威胁性的是，大多数用户没有意识到这一点（漏洞V3）。
通过利用这些漏洞，本研究设计了三种针对用户的PoC：（1）比特币去匿名攻击； （2）比特币反射和放大垃圾信息攻击；
（3）比特币钱包欺诈攻击。第一种攻击使攻击者可以取消对比特币钱包使用的非真实比特币地址进行匿名处理。此攻击不仅以低错误率（例如10^(-13)％）识别比特币钱包App用户的所有比特币地址，而且还可以在满足某些使用条件的同时发现应用程序用户的真实身份。在第二种攻击中，攻击者利用中间的公共比特币网络元素（例如，全节点客户端）向比特币钱包App用户连续不断地未经请求地发送垃圾信息。垃圾信息流量由攻击期间全球所有比特币用户产生的所有新比特币交易组成。这是一种低成本的攻击；攻击者只需要向比特币网络发送一些小的发起数据包。在实验中观察到放大系数（垃圾信息流量大小与攻击发起包大小之比）接近3,666。这种攻击以两种方式攻击受害者：（1）在使用蜂窝网络服务时，受害者需要为比特币垃圾消息付费；
（2）受害者的手机比未受到攻击的手机消耗更多的电能96％。第三种攻击显示了攻击者为何可以超越其他类型的金融移动程序攻击的限制，针对比特币钱包应用程序用户发起各种比特币欺诈攻击，下表总结了本文发现。
## 0x02 Threat Model and Methodology
**比特币网络架构：** 下图说明了比特币网络架构。
运行比特币协议的网络节点可能包含四个功能：（1）钱包，（2）矿工，（3）完整的区块链数据库和（4）网络路由。 钱包功能为用户提供了比特币钱包服务。
此功能控制对用户资金（即BTC，比特币的货币）的访问，包括管理私钥/公钥和地址，跟踪余额以及生成和签名交易。
矿工功能瓦利约会新交易并将其附加到比特币区块链。 完整的区块链数据库功能可维护所有比特币区块的完整且最新的副本。 网络路由功能允许一个节点与其他节点通信。
**威胁模型：**
在这项研究中，攻击者是对比特币智能手机钱包用户发起远程攻击的人或组织。认为攻击者具有以下能力：（1）他们可以在公共传播信道中拦截，修改或注入任何消息；
（2）他们遵守所有加密假设，例如，如果没有解密密钥，将无法解密加密消息；
（3）他们无法控制受害者的智能手机和比特币网络基础设施。本文研究了10种流行的比特币钱包App，分别是Coinbase，Bit coin
Wallet，Blockchain Wallet，Bitcoin.com
Wallet，Luno，Mycelium，Coinomi，BRD，BitPay和Simple
Bitcoin。通过两种措施以负责任的方式进行了这项研究。首先，仅将手机用作受害者。其次，没有向公众分发任何恶意的比特币应用程序或库。本研究试图披露比特币钱包App的新安全漏洞和有效攻击，但并不加剧这种破坏。
## 0x03 Security Vulnerabilities
###  V1：钱包比特币地址泄漏
第一个安全漏洞是钱包App的比特币地址可能会泄露给攻击者。特别是， _BitcoinJ_
是一个比特币客户端库，已被许多比特币钱包App（例如，Bitcoin
Wallet，Mycelium）广泛用于与比特币网络通信，从而泄漏了比特币钱包用户的隐私。
根据比特币标准，在SPV客户端（即，比特币钱包应用程序）与比特币FNC（完整节点客户端）连接之后，filterload信息将发送到FNC。该消息用于指定比特币钱包用户对特定交易的兴趣。实际上，通常将SPV客户端配置为对涉及比特币钱包用户的比特币地址的交易的兴趣。该消息带有三个关键参数，即filter，nHashFuncs和nTweak。filter本身是位域Bloom过滤器，因此FNC可以知道其连接的比特币钱包应用程序的地址的兴趣。根据将数据元素（例如，用户的比特币地址）提供给一组不同的nHashFuncs