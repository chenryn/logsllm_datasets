•此块的奖励为Π(Cˆ,i)；
•从诚实方到攻击方的所有转移H→A(Cˆ,i)；
•所有费用
对于包含Cˆ中包含前一个块的时隙i’之后的所有时隙j≤i。
另一方面，当通过奖励Π(C,i)在C中创建区块时，诚实的参与者在C中的相对权益在每个时隙中都会增加（不收取任何feesΠ，因为C中的所有费用均由诚实的参与者支付）
**（iii）上下文无关的交易：** 根据Π产生的有效交易必须忽略在区块链中使用交易的上下文：Π必须允许A从C进行交易，并在Cˆ的不同上下文中使用它们。
**（iv）低增长链的有效性：** 协议Π必须支持“沉睡的大多数”，以确保仅由少数攻击者扩展的链Cˆ（因此在其开始时链增长很小）仍然根据规则被认为是有效的。
在以下定理中，根据初始对抗性权益αA和每个时隙中的交易产生的费用数量，来估算进行攻击所需的时隙数。为简单起见，即使攻击对任何常数αA>
0起作用，也分析1/3  0都满足执行E的要求。1/3 长度（C）。有：
**证明：** 设P∈{A，H}，C’∈{C，Cˆ}的αC’P[i]且i>
0表示时隙i中链C’中的一组参与者P的相对权益（A和H分别表示对手和诚实方）。另外，从对手的角度来看，令length **i**
(C’)表示时隙i中的链C’的长度。然后，由于权益比例增长假设，不等式E [length **T** (Cˆ)]> E [length **T**
(C)]转换为：
由于奖励Π（C’，i）= 0且C中的费用全部由诚实方支付（和接收），因此对于所有i> 0，都有:
在某个时隙i处C和Cˆ的长度由每个≤1≤j≤i的时隙的独立随机变量之和确定。
首先，专注于1/3
<αA<1/2，否则定义T2的事件将永远不会发生。但是，很容易看出，虽然攻击得益于较高的（低于50％）初始对抗性权益，但也可以通过对αA<1/3进行稍加修改的分析来进行攻击。
其次，假设零块奖励和从H到A的转移。但是请记住，transfersH→A(C,i)完全受环境控制
（这是为了表明区块链协议的安全性不依赖于要存储在分类账中的交易的任何特定假设；相反，它必须针对任何此类交易序列安全地运行）因此对于任何rewardsΠ(C,i)，可以通过设置transfersH→A(C,i)来简单地实现相同分析的情况，以使C中的诚实股权比率保持恒定（因为Cˆ中的对抗性股权比率将不断增加）。另一方面，非零rewardsΠ(Cˆ,i)只会使攻击成功更快。
通过更仔细的考虑可以获得更优边界T≈（2-4αA）/ f。
## 0x08 Implications for Existing PoS Protocols
现在总结一下各种PoS协议在多大程度上满足了之前描述的前提条件，主要关注最终共识协议，也指出了攻击概念在逐块BA设置中的适用性。
所有最终共识协议都采用某种形式的检查点，以防止后期腐败攻击。这种一般的对策可以防止权益流损（以及任何其他远程攻击），并且可以以小规模（和模型限制）的方式进行。有趣的是，如果取消检查点，则所有考虑的最终共识构造都将容易受到流损攻击，因为它们都满足条件（ii）-（iv）：它们使用交易费用，交易是上下文相关的-遗忘和低增长链被认为是有效的。。
**NXT和PPCoin：** NXT协议仅允许重组最后的720个块，因此形成了所谓的移动检查点，并且违反了条件（i）。
PPCoin中采用了类似的检查点机制。
**Snow White：** Snow White协议还使用移动检查点来防止后腐败攻击，并且如果没有它，也很容易受到权益流损攻击的影响。
**Ouroboros：**
使用移动检查点作为其maxvalid链选择规则的一部分，以中和远程攻击。如果没有检查点，那么Ouroboros将不容易受到后期腐败和权益流损的攻击，因为它不使用密钥演化的加密技术。
**Ouroboros Praos：**
使用与Ouroboros相同的maxvalid链选择规则，强加了移动检查点。如果没有这种对策，那么由于其使用密钥演化签名来签名区块，Ouroboros
Praos仍将消除后期腐败攻击。但是，这很容易受到权益流损攻击的影响。
正如已经讨论过的， **Algorand**
并不是最终的共识协议，而是遵循逐块BA。尽管如此，可以考虑对Algorand进行权益流损攻击的核心思想的适用性，其目的是创建另一种区块顺序，并利用权益流损来获得那里的临时多数股权。但是对于Algorand而言，这种攻击是通过要求足够多的利益相关方来证明逐块BA的结果而得以防止的，这可以视为违反了（iv）。实际上，Algorand强制执行严格的参与规则，因此始终可以以模型限制的方式找到正确的协议执行。
## 0x09 Mitigations
**a）时域中的最小链密度：**
可以用来减轻权益流损攻击的第一个结果是，的攻击产生的区块链有一段时期，在这段时期内区块链的密度为比较稀疏。接下来阐明密度的概念：在所有PoS协议中，允许某些参与方可能并非一直在线（尽管事实是他们被选为参加协议）。通过观察区块链可以发现他们没有参与。例如对于Ouroboros，将有许多时隙留空，没有相应的块；其他协议中也存在类似的可观测量。这允许协议检测和清除具有此缺陷的区块链，从而将其与诚实方生成的正确区块链区分开。
**b）上下文制约性：**
权益流损攻击的基本特征是“脱离上下文”进行交易，也就是说，将其从诚实维护的区块链复制到攻击者维护的私有区块链。防止这种情况发生的一种非常简单而有效的方法是在每个事务中包括“上下文”，即最近块的哈希。
## 0x10 Conclution
本文提出了一种新型的远程攻击，称为权益流损攻击，适用于在没有任何模型限制假设的情况下运行的所有最终共识PoS协议。鉴于当前的加密货币统计数据，权益流损攻击将需要多年的区块链历史才能成功，因此它们并不是紧迫的问题。
但是，它们从密码学角度指出了重要的设计考虑因素。它们显示了在不依靠后期腐败的情况下进行远程攻击的可能性。从中可以很容易地推断出，密钥演化加密本身不足以缓解远程攻击，需要研究其他算法缓解措施，可以在不受信任的、未经许可的环境中阻止长期攻击，而无需使用检查点或其他方法。