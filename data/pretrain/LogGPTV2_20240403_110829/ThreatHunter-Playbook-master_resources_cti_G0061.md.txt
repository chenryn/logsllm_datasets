# G0061: FIN8

## Description
FIN8 is a financially motivated threat group known for conducting targeted spearphishing campaigns, primarily targeting the retail, restaurant, and hospitality industries. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Fin8 May 2016)

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | FIN8 uses environment variables and standard input (stdin) to obfuscate command-line arguments. They also obfuscate malicious macros delivered as payloads. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/), [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Valid Accounts](https://attack.mitre.org/techniques/T1078/) | FIN8 utilizes valid accounts for persistence and lateral movement. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/), [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Remote File Copy](https://attack.mitre.org/techniques/T1105/) | FIN8 uses remote code execution to download subsequent payloads. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [File Deletion](https://attack.mitre.org/techniques/T1107/) | FIN8 deletes temporary and prefetch files during post-compromise cleanup activities. | File monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048/) | FIN8 uses FTP to exfiltrate collected data. | User interface, Process monitoring, Process use of network, Packet capture, Netflow/Enclave netflow, Network protocol analysis |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Commonly Used Port](https://attack.mitre.org/techniques/T1043/) | FIN8 tunnels RDP backdoors over port 443. | Packet capture, Netflow/Enclave netflow, Process use of network, Process monitoring |
| Linux, Windows, macOS | [Execution](https://attack.mitre.org/tactics/execution/) | [User Execution](https://attack.mitre.org/techniques/T1204/) | FIN8 leverages both Spearphishing Link and Spearphishing Attachment to gain user execution. | Anti-virus, Process command-line parameters, Process monitoring |
| Linux, Windows, macOS | [Exfiltration](https://attack.mitre.org/tactics/exfiltration/) | [Data Compressed](https://attack.mitre.org/techniques/T1002/) | FIN8 uses RAR to compress collected data before exfiltration. | Binary file metadata, File monitoring, Process command-line parameters, Process monitoring |
| Windows, Linux, macOS | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | FIN8 harvests credentials using Invoke-Mimikatz or Windows Credentials Editor (WCE). | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Windows, macOS, Linux | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193/) | FIN8 distributes targeted emails containing Word documents with embedded malicious macros. | File monitoring, Packet capture, Network intrusion detection system, Detonation chamber, Email gateway, Mail server |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/), [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [Scheduled Task](https://attack.mitre.org/techniques/T1053/) | FIN8 uses scheduled tasks to maintain RDP backdoors. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows, GCP, Azure, AWS | [Discovery](https://attack.mitre.org/tactics/discovery/) | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | FIN8 uses `dsquery` and other Active Directory utilities to enumerate hosts. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Standard Cryptographic Protocol](https://attack.mitre.org/techniques/T1032/) | FIN8 uses the Plink utility to tunnel RDP back to C2 infrastructure. | Packet capture, Netflow/Enclave netflow, Malware reverse engineering, Process use of network, Process monitoring, SSL/TLS inspection |
| Windows, macOS, Linux, Office 365, SaaS | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | FIN8 distributes targeted emails containing links to malicious documents with embedded macros. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [PowerShell](https://attack.mitre.org/techniques/T1086/) | FIN8's malicious spearphishing payloads are executed via PowerShell. They also use PowerShell for lateral movement and credential access. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | [Collection](https://attack.mitre.org/tactics/collection/) | [Data Staged](https://attack.mitre.org/techniques/T1074/) | FIN8 aggregates staged data from a network into a single location. | File monitoring, Process monitoring, Process command-line parameters |
| macOS, Windows | [Discovery](https://attack.mitre.org/tactics/discovery/) | [Security Software Discovery](https://attack.mitre.org/techniques/T1063/) | FIN8 uses Registry keys to detect and avoid executing in potential sandboxes. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Execution](https://attack.mitre.org/tactics/execution/) | [Scripting](https://attack.mitre.org/techniques/T1064/) | FIN8 uses a Batch file to automate frequently executed post-compromise cleanup activities. | Process monitoring, File monitoring, Process command-line parameters |
| Windows | [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Remote Desktop Protocol](https://attack.mitre.org/techniques/T1076/) | FIN8 uses RDP for lateral movement. | Authentication logs, Netflow/Enclave netflow, Process monitoring |
| Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Modify Registry](https://attack.mitre.org/techniques/T1112/) | FIN8 deletes Registry keys during post-compromise cleanup activities. | Windows Registry, File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | FIN8 executes commands remotely via `cmd.exe`. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Indicator Removal on Host](https://attack.mitre.org/techniques/T1070/) | FIN8 clears logs during post-compromise cleanup activities. | File monitoring, Process monitoring, Process command-line parameters, API monitoring, Windows event logs |
| Windows | [Execution](https://attack.mitre.org/tactics/execution/) | [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/) | FIN8's malicious spearphishing payloads use WMI to launch malware and spawn `cmd.exe` execution. They also use WMIC during and after compromise. | Authentication logs, Netflow/Enclave netflow, Process monitoring, Process command-line parameters |
| Windows | [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Windows Admin Shares](https://attack.mitre.org/techniques/T1077/) | FIN8 attempts to map to C$ on enumerated hosts to test the scope of their current credentials/context. | Process use of network, Authentication logs, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/) | [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068/) | FIN8 exploits the CVE-2016-0167 local vulnerability. | Windows Error Reporting, Process monitoring, Application logs |

This table provides a comprehensive overview of the tactics, techniques, and procedures (TTPs) used by the FIN8 threat group, along with the relevant platforms, descriptions, and data sources for each technique.