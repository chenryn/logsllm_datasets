Enter the ArcSight password that will be used to log this adaptor into the ArcSight Source Manager.
ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 333 Configuration for HP Operations Manager
7 Enter a name for the connector and provide other information identifying the connector's use in your environment. Click Next.
8 
9 Read the installation summary and click Next. If the summary is incorrect, click Previous to make changes.
When the connector completes its configuration, click Next. The Wizard now prompts you to choose whether you want to run the connector as a process or as a service.If you choose to run the connector as a service, the Wizard prompts you to define service parameters for the connector. 
10 After making your selections, click Next. The Wizard displays a dialog confirming the 	connector's setup and service configuration.
11 Click Finish.
For some connectors, a system restart is required before the configuration settings you made take effect. If a System Restart window is displayed, read the information and initiate the system restart operation.12 Click Done.
Creating an SNMP Interceptor (Policy)
An SNMP Interceptor is a type of HP OM policy (HP OM SNMP Policy Type) with Rules and Actions. These policies can be configured on either HP OM UI, Operations Manager for Windows (OMW) or Operations Manager for Linux (OML). They are uploaded from the policy files using the HP OM ovpmutil tool. The Forwarding Connector sends security events as SNMP traps to an HP OM SNMP Interceptor that you will create.The Interceptor should be configured to monitor SNMP events and respond when a given pattern is found in an SNMP message. ArcSight provides a template interceptor (policy) for use in creating your own customized SNMP Inteceptor. This template policy should be customized and enhanced to satisfy different needs and requirements with HP OM's powerful policy edit features.34 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential
3 Configuration for HP Operations Manager
Uploading Interceptor Template
After you have completed connector installation, navigate to 
$ARCSIGHT_HOME\current\user\agent\hpompolicy. This folder provides policy files as a basic SNMP interceptor template. 
The following files are provided in the ArcSight Events folder:157F1ADF-B7A5-4328-8175-5D370D6EC4A9_data
157F1ADF-B7A5-4328-8175-5D370D6EC4A9_header.xmlPolicyConfig_EE72B589-0893-4EC1-899B-502DE1289DBF.xml
Using Operations Manager for Windows
Copy the hpompolicy folder from $ARCSIGHT_HOME\current\user\agent to the destination HP OM (OMW, the Windows version of HP OM) machine's C:\temp directory. 
Then use the following command to upload the policy:C:\Program Files\HP\HP BTO Software\bin\win64>ovpmutil CFG POL UPL 
"C:\temp\hpompolicy" 
You should receive the following messages:
Root policy group "for ArcSight Integration" uploading:
Policies upload completed successfully.
 For descriptions of specific HP OM commands, refer to the HP Operations Manager online help and documentation.
Using Operations Manager for LinuxUsing Operations Manager for Linux
Copy the hpompolicy folder from $ARCSIGHT_HOME\current\user\agent to the destination HP OM machine's /tmp directory. Then use the following command to upload the policy: 
/opt/OV/bin/OpC/utils/opcpolicy -upload 
dir=/tmp/hpompolicy/"ArcSight Events"
You should receive the following message: 
Operation successfully completed.Operation successfully completed.
 For descriptions of specific HP OM commands, refer to the HP Operations Manager online help and documentation.
Deploying the Policy
Once you have created your customized Interceptor, deploy or assign the policy through the HP Operations Manager UI (for Windows)or HP Operations Manager Administration UI (for Linux). For details, refer to the HP Operations Manager online help and documentation.ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 35
3 Configuration for HP Operations Manager
Adjusting the Event Processing Rate
The default event processing rate for forwarding events from ESM to HP OM is 50 eps. If this rate proves excessive for your system, HP OM may queue some incoming events and affect the rate at which these events are processed.If this occurs, you can adjust the rate at which events are forwarded to HP OM. To do so, you will need to change the event processing rate within your XML properties file.
To adjust the event processing rate, 
1 	Stop the currently running SmartConnector from operating.
2 	From a Windows command line, access your XML properties file using the command 
cd %ARCSIGHT_HOME%/current/user/agentcd %ARCSIGHT_HOME%/current/user/agent
3 Use WordPad or any XML Editor to open the .xml file for your HP OM destination, similar to the example below:
0Ajv5S8BABCAAeabNXP5Rw==.xml
4 	From within the .xml file, search for the following:
ProcessingSettings.ThrottleRate="50"
This value controls the current processing event rate, and has a default value of 50 eps.5 Change this value to the desired rate of events per second. For example, to lower the rate of events to 10 eps, change the value after the string to 10:
ProcessingSettings.ThrottleRate="10"
|  |  | If there are multiple destinations, repeat the steps above to change the rate for each destination, as required. | If there are multiple destinations, repeat the steps above to change the rate for each destination, as required. ||---|---|---|---|
| 6 |Save the .xml file and exit the XML editor. |Save the .xml file and exit the XML editor. |Save the .xml file and exit the XML editor. |
| 7 |Restart the SmartConnector. |Restart the SmartConnector. |Restart the SmartConnector. |
| 36 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |36 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |36 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector |ArcSight Confidential |Appendix A 	Using the Forwarding Connector in FIPS mode
The following provides explanation and instructions for enabling FIPS compliance in the use of the Forwarding Connector.
“What is FIPS?” on page 37
“ArcSight ESM Installation” on page 37
“FIPS-Enabled Forwarding Connector Installation” on page 38
“Enable FIPS Suite B Support” on page 43
“Using Logger in FIPS Mode” on page 43
What is FIPS?What is FIPS?
Under the Information Technology Management Reform Act (Public Law 104-106), the Secretary of Commerce approves standards and guidelines that are developed by the National Institute of Standards and Technology (NIST) for Federal computer systems. 
These standards and guidelines are issued by NIST as Federal Information Processing Standards (FIPS) for use government-wide. NIST develops FIPS when there are compelling Federal government requirements such as for security and interoperability and there are noacceptable industry standards or solutions.
  FIPS compatibility applies only to standard ESM and Logger destinations.
ArcSight ESM Installation
Before you install an ArcSight Forwarding Connector, make sure that ArcSight ESM has already been installed correctly for FIPS compliance. See “Standard InstallationProcedures” on page 7 for instructions. Also, ArcSight recommends reading the ArcSight ESM Installation and Configuration Guide before attempting to install a new Forwarding Connector. 
For information regarding operating systems and platforms supported, see SmartConnector Product and Platform Support, available from ArcSight Technical Support with each SmartConnector release.ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 37
A Using the Forwarding Connector in FIPS mode
FIPS-Enabled Forwarding Connector Installation 
After completion of ArcSight ESM installation (which includes assigning privileges on the source manager, allowing the forwarding of correlation events, and so on), follow the instructions under “Installing the Forwarding Connector” on page 12 up to and including step 2.When the installation is complete after step 2, the following dialog is displayed:
1
2 Click Cancel to exit connector setup in order to perform configuration of the NSS DB, a necessary step for installing the connector in FIPS-compliant mode. (You will return to the wizard after performing these configuration steps.)
Create a properties file using the following location:
$ARCSIGHT_HOME/user/agent/agent.properties3 
4
5 Add the following line within the file: fips.enabled=true 
Copy your key files for source and destination Managers (in this example, srcmgrkey.cert and destmgrkey.cert) into the 
$ARCSIGHT_HOME\current\bin directory.
Turn off FIPS enablement on the new installation using the following command:
arcsight runmodutil –fips false –dbdir user/agent/nssdb.client6 Import the certificates for the source and destination Managers. To do this, see the detailed instructions below:
Where srcmgrkey and destmgrkey are alias names and srcmgrkey.cert and destmgrkey.cert are the names with which the certificates from the Managers were saved, import the certificates for the source and destination Managers, using the following commands:This command imports the source Manager’s certificate: arcsight runcertutil –A –n srcmgrkey –t "CT,C,C" –d user/agent/nssdb.client –i 
bin/srcmgrkey.cert
This command will display, in plain text (as shown below), the contents of the source Manager’s certificate and can be used to determine the name put into the connector 
38 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight ConfidentialA Using the Forwarding Connector in FIPS mode
configuration for the source Manager: arcsight runcertutil –L –n srcmgrkey –t "CT,C,C" –d user/agent/nssdb.client
 To confirm the Manager’s certificate name, look under Subject: “CN=*”, as shown in the example below.
This command imports the destination Manager’s certificate: arcsight runcertutil –A –n destmgrkey –t "CT,C,C" –duser/agent/nssdb.client –i bin/destmgrkey.cert
This command will display, in plain text, the contents of the destination Manager’s certificate and can be used to determine the name put into the connector 
configuration for the destination manager: arcsight runcertutil –L –n 
destmgrkey –t "CT,C,C" –d user/agent/nssdb.client|  |  | Your host name needs to match the Manager’s certificate name (circled above as an example) and be DNS resolvable. If these fields do not match, the connection will be unsuccessful. |
|---|---|---|| 7  8 |Re-enable FIPS using the following command: arcsight runmodutil –fips true –dbdir user/agent/nssdb.client Return to connector setup by entering the following command from the $ARCSIGHT_HOME\current\bin directory: |Re-enable FIPS using the following command: arcsight runmodutil –fips true –dbdir user/agent/nssdb.client Return to connector setup by entering the following command from the $ARCSIGHT_HOME\current\bin directory: |arcsight connectorsetup
| 9 | When prompted to start in Wizard Mode, click Yes. | When prompted to start in Wizard Mode, click Yes. |
|---|---|---|
| ArcSight Confidential |ArcSight Confidential |SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 39 |
A Using the Forwarding Connector in FIPS mode
10 The Destination selection window is again displayed. Make sure ArcSight Manager(encrypted) is selected and click Next.
11 You are prompted for Manager Host Name and Manager Port.
 The host name and manager’s certificate name must match and be DNS resolvable. If these fields do not match, the connection will be unsuccessful.
This is your destination Manager. Enter the information and click Next.
40 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight ConfidentialA Using the Forwarding Connector in FIPS mode
12 Enter a valid ArcSight User Name and Password, andclick Next. This should be the user name and password for the user account you created on the destination Manager.
13 You are given a choice of Forwarding Connector versions to install. If you are currently using ESM v4.0 SP3 or later, ArcSight recommends choosing the ArcSightForwarding Connector (Enhanced) option.
When choosing which version to use, note the following: 
 The ArcSight Forwarding Connector option supports the previous software version and does not include the increased event rate and recoverability features of ArcSight Forwarding Connector (Enhanced). ArcSight recommends using the older option only when communicating with a pre-v4.0 SP3 ESM installation.The capacity of events that can be stored during a system failure is dependent on the FileStore size of your source Manager. Choosing the ArcSight Forwarding Connector (Enhanced) version requires configuration adjustments on your source Manager.
For instructions on how to determine and change your source disk settings, see “Increasing the FileStore size (Enhanced version only)” on page 11. Click Next.ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 41
A Using the Forwarding Connector in FIPS mode
14 Enter the information to configure the Forwarding Connector. 
 The host name and manager certificate name must match and be DNS resolvable. If these fields do not match, the connection will be unsuccessful.
This is information about your source Manager, as described in the table below.Click Next to continue.
Parameter Description
ArcSight Source 
Manager Hostname
ArcSight Source 
Manager Port
ArcSight Source 
Manager User Name
ArcSight Source 
Manager Password
Fips Cipher Suites
Hostname where the ArcSight Source Manager is installed.
Network Port where the ArcSight Source Manager is accepting requests.
The ArcSight user name created with permissions for the Forwarding Connector on the ArcSight Source Manager.ArcSight's password that will be used to log this Connector into the ArcSight Source Manager.
fipsDefault: Standard Fips
SuiteB 128: Fips Suite B with 128Bit encryption
SuiteB 192: Fips Suite B with 192Bit encryption
15 Enter a name for the connector and provide other information identifying the 	connector's use in your environment. Click Next.16 Read the connector summary; if it is correct, click Next. If the summary is not correct, 	click Previous to make changes before continuing.
17 When the connector completes its configuration, click Next. The wizard now prompts you to choose whether you want to run the connector as a process or as a service. If you choose to run the connector as a service, the wizard prompts you to define service parameters for the connector.42 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential
A Using the Forwarding Connector in FIPS mode
18 After making your selections, click Next. The wizard displays a dialog confirming the 	connector's setup and service configuration.
19 Click Finish.
Enable FIPS Suite B Support
If you have installed a SmartConnector in FIPS-compliant mode, you can enable FIPS Suite B support by modifying the ESM destination parameters.The Manager must also be installed in FIPS Suite B mode.
To enable FIPS Suite B support:
1 
2 From $ARCSIGHT_HOME\current\user\agent, open agent.properties to edit.
Locate the following property for ESM destination parameters (approximately, line 10 in the file):
agents[0].destination[0].params=\n\n    \n    \n    \n 
\n    \n\n
3
4 The destination parameters are specified here as an XML string where each element is one parameter. Based upon the Suite B mode of the Manager, change fipsDefault to suiteb128 (for 128-bit security) or suiteb192 (for 192-bit security).Save and exit agent.properties.
Using Logger in FIPS Mode
Arcsight Logger supports the Federal Information Processing Standard 140-2 (FIPS 140-2). If you want to use Logger in the FIPS mode, refer to the ArcSight Logger Administrator's Guide and see “Installing or Updating a SmartConnector to be FIPS-compliant” in Chapter 7, “System Admin” for complete instructions.ArcSight Confidential SmartConnector™ Configuration Guide for ArcSight Forwarding Connector 43
A Using the Forwarding Connector in FIPS mode
44 SmartConnector™ Configuration Guide for ArcSight Forwarding Connector ArcSight Confidential