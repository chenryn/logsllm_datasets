User: How can I write a script using Python to extract data from a text file and import it into a database?
Assistant: 1. Determine the database table structure and field type Before writing a Python script, you need to determine the table structure and field type of the data to be imported in order to create a database table. Tables can be created using MySQL Workbench or other database management tools. 2. Open the file, read the data and parse it In the Python script, you can use the open function to open the text file, and use the read or readline function to read the data in the file. Depending on the format of the data in the file, the data can be split into fields and parsed using split, strip, or other string processing functions. 3. Connect to the database and insert data Use the Python database driver to connect to the database, create a database connection and obtain a cursor. The data can then be inserted into the database table using the execute SQL insert statement. For example, the following is a sample code snippet that reads data from a file in Python and imports it into a MySQL database: ``` import MySQLdb # database configuration HOST = 'localhost' USER = 'root' PASSWORD = '123456' DATABASE = 'test' # Open the file and parse the data with open('data.txt', 'r') as f: for line in f: data = line.strip().split(',') # Database operation db = MySQLdb.connect(host=HOST, user=USER, password=PASSWORD, db=DATABASE) cursor = db.cursor() # Execute SQL insert statement sql = "INSERT INTO users(name, age, gender) VALUES ('%s ', %d, '%s')" % (data[0], int(data[1]), data[2]) cursor.execute(sql) db.commit() # Close the database connection db.close( ) ``` According to the actual situation, it needs to be adjusted according to the format of the data in the file and the structure of the database table.