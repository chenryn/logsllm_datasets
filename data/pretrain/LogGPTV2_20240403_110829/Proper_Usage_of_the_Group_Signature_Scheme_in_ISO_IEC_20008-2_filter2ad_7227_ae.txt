logV R4
(cid:12)(cid:12)(cid:12)(cid:12)(
)
)
(1)
(cid:3)
i
(cid:3)
i
=
(cid:3)
(cid:3)
i
(cid:3)
i
12
Pr[Bad
(3)
6 ] = 1=p.
m). Thus, the probability that there exists (cid:27)r such that the equation (1) holds for ec is 1=p. That is,
(cid:12)(cid:12)Pr[S5] (cid:0) Pr[S6]
(cid:12)(cid:12) (cid:20) 1=p by showing Bad
(cid:18) Bad
(3)
(3)
6
In the following, we prove
(3)
6 . We consider that the
6 happens, that is, the situation that A sends the opening query (m; (cid:6) = (fTigi2[1;4]; c; (cid:27)x;
event Bad
(cid:27)y; (cid:27)(cid:14); (cid:27)q; (cid:27)r)) such that GVf(gpk; m; (cid:6)) = 1 and logU T3 ̸= logV T4. Since we assume that the adversary
A does not generate related queries, it holds that (fTigi2[1;4];fRigi2[1;4]; m) ̸= (fT
gi2[1;4];
gi2[1;4];fR
). Also from the condition which is made in Game 0, the random oracle query X = (gpk;fTigi2[1;4];
(cid:3)
m
fRigi2[1;4]; m) is generated before (m; (cid:6)) is queried to the Open oracle where R1 = e(H; G2)(cid:27)x(cid:1)e(K; G2)(cid:27)(cid:14)(cid:1)
ec be the reply of X. Since c = ec holds when GVf(gpk; m; (cid:6)) = 1, it holds that R3 = U (cid:27)r (cid:1) T3
(cid:0)c, and R4 = V (cid:27)r (cid:1) T4
(cid:0)c. Let
(cid:0)ec and
(cid:0)ec. For the two equations, we consider the discrete logarithm by considering the base as
R4 = V (cid:27)r (cid:1) T4
, R2 = G(cid:27)x+(cid:27)r (cid:1) T2
(cid:0)(cid:27)q (cid:1) e(T1; G2)(cid:27)y (cid:1)
(cid:0)c, R3 = U (cid:27)r (cid:1) T3
)(cid:0)c
e(G1;G2)
e(T1;Y )
e(K; Y )
(
(cid:3)
i
(cid:3)
i
U and V , and then the simultaneous equation
(
)
(
logU R3
logV R4
=
1 (cid:0) logU T3
1 (cid:0) logV T4
)(
)
(cid:27)rec
(3)
6 ] (cid:20) Pr[Bad
holds. Therefore, the query X satis(cid:12)es two conditions of the event Bad
satis(cid:12)es the equation (1) for the replyec. Thus, Bad
Pr[Bad
Lemma 4.7. There exists a PPT algorithm B2 such that
((cid:21)) for any PPT A.
Proof. Let B2 be an adversary that tries to solve the DDH problem. First, B2 receives the DDH tuple
G; U; R; W 2 G. Let U = Gu and R = Gr. The element W is Gur or a random value in G. Next, B2
(cid:12)(cid:12)Pr[S6](cid:0)Pr[S7]
(cid:12)(cid:12) = AdvDDHB2
(3)
6 , and there exists (cid:27)r which
(3)
6 holds and we obtain
(3)
6 ] = 1=p.
(cid:18) Bad
(3)
6
(cid:12)(cid:12)Pr[S5] (cid:0) Pr[S6]
(cid:12)(cid:12) (cid:20)
generates the instance of the anonymity game. Here for G and U , he uses the ones in the DDH tuple.
Other elements are generated by following the GKg algorithm. Let gpk = (G1; G2; G; H; H; K; Y; U; V ),
ik = w, and ok = (u; v), B2 sends (gpk; ik) to the adversary A. We note that B2 does not know the
for opening in Game 6 and Game 7 is v = logG V . Therefore, B2 possesses all keys which are needed to
reply oracle queries, and can simulate the replies of all queries. Especially, B2 generates the challenge
discrete logarithm u of the value U . Although u is the part of the opening key ok, the key that is used
signature as follows:
(cid:3)
2
1. Choose q
; r
(cid:3)
where R and W are the part of the DDH tuple.
2 Zp uniform randomly and compute (T
(cid:3)
1 ; T
(cid:3)
2 ; T
(cid:3)
3 ; T
(cid:3)
4 ) = (Aib
(cid:3)
(cid:1) K q
(cid:1) R; W; Gr
(cid:3)
2 )
; Qib
(
(cid:3) 2 Zp uniform randomly, and computes R
2 Zp and c
y (cid:1)
(cid:3)
1 ; G2)(cid:27)
)(cid:0)c
(cid:3)
2 = G(cid:27)
r (cid:1) T
(cid:3)
x+(cid:27)
, R
, R
(cid:0)c
(cid:3)
2
(cid:3)
(cid:3)
(cid:3)
(cid:3)
e(G1;G2)
(cid:3)
1 ;Y )
e(T
(cid:3)
1 = e(H; G2)(cid:27)
x (cid:1)
(cid:3)
(cid:3)
3 = U (cid:27)
(cid:3)
r (cid:1) T
(cid:3)
3
(cid:0)c
(cid:3)
, and
2. Choose (cid:27)
e(K; G2)(cid:27)
(cid:3)
(cid:3)
4 = V (cid:27)
R
(cid:3)
y; (cid:27)
(cid:3)
(cid:3)
(cid:3)
(cid:3)
q ; (cid:27)
(cid:14) ; (cid:27)
x; (cid:27)
r
(cid:14) (cid:1) e(K; Y )
q (cid:1) e(T
(cid:0)(cid:27)
(cid:3)
(cid:3)
r (cid:1) T
.
(cid:0)c
(cid:3)
(cid:3)
4
3. If the value ((gpk;fT
(cid:3)
gi2[1;4];fR
fT
gi2[1;4]; m
(cid:3)
(cid:3)
i
(cid:3)
(cid:3)
(cid:3)
(cid:3)
i
i
q ; (cid:27)
(cid:14) ; (cid:27)
x; (cid:27)
c
; (cid:27)
is set to be ?.
(cid:3)
y; (cid:27)
gi2[1;4]; m
gi2[1;4];fR
(cid:3)
);(cid:1)) is not de(cid:12)ned in the list L, the value ((gpk;
gi2[1;4];
(cid:3)
r ). On the other hand, if such a value is already de(cid:12)ned, the challenge signature
) is added to L and the challenge signature (cid:6)
is set to be (fT
); c
(cid:3)
i
(cid:3)
i
(cid:3)
(cid:3)
(cid:3)
Finally, when A terminates witheb 2 f0; 1g, B2 outputs 1 if b =eb. Otherwise he outputs 0.
If the DDH tuple that B2 obtains is (G; U; R; W ) = (G; Gu; Gr; Gur), it holds that (T
(cid:3)
T
4 ) = (Aib
(cid:1)Gr; W; Gr
(cid:3)
Gur)](cid:0) Pr[1   B2(G; Gu; Gr; W )]j = j Pr[b =eb in Game 6](cid:0) Pr[b =eb in Game 7]j =
the element W is a random value in G, it holds that (T
4 ) = (Aib
B2 perfectly simulates Game 7 for A. Therefore, it holds that AdvDDHB2
(cid:3)
(cid:3)
2 ; T
3 ;
2 ). Then, B2 perfectly simulates Game 6 for A. On the other hand, if
(cid:1)K q
((cid:21)) = j Pr[1   B2(G; Gu; Gr;
(cid:12)(cid:12)Pr[S6](cid:0) Pr[S7]
(cid:12)(cid:12).
(cid:3)
1 ; T
(cid:3)
2 ). Then,
(cid:1) Gr; Gur; Gr
(cid:1) K q
(cid:3)
2 ; T
(cid:3)
3 ; T
(cid:3)
1 ; T
; Qib
; Qib
(cid:3)
(cid:3)
(cid:3)
(cid:3)
; r
; r
1; r
For random values q
(cid:3)
(cid:3)
(cid:3)
(cid:3)
q ; (cid:27)
r ) = (Aib
(cid:14) ; (cid:27)
i
gi2[1;4]; c
(cid:3)
x; (cid:27)
(cid:3)
y; (cid:27)
; (cid:27)
(cid:3)
2
(cid:3)
(cid:3)
(cid:3)
(fT
2 Zp, the challenge signature in Game 7 is denoted by (cid:6)
(cid:3)
(cid:3)
(cid:1) K q
; Qib
(cid:3)
(cid:1) Gr
(cid:3)
1 ; V r
(cid:3)
2 ; c
(cid:3)
; (cid:27)
; U r
(cid:3)
x; (cid:27)
(cid:3)
y; (cid:27)
(cid:3)
(cid:14) ; (cid:27)
(cid:3)
q ; (cid:27)
=
(cid:3)
r ). Therefore, the
13
choice of the challenge bit b and the distribution of the challenge signature (cid:6)
we can say that Pr[S7] = 1=2. From this fact and Lemma 4.1 to Lemma 4.7, we get
(cid:5)FI;A((cid:21)) (cid:20) 6∑
(cid:12)(cid:12)Pr[Sℓ] (cid:0) Pr[Sℓ+1]
(cid:12)(cid:12) +
(cid:12)(cid:12)Pr[S7] (cid:0) 1=2
(cid:12)(cid:12)
Advanon
(cid:3)
are independent. Thus,
ℓ=0
(cid:20) AdvDDHB1
((cid:21)) + AdvDDHB2
((cid:21)) +
qH (1 + qopen) + 1
p
:
Since qH and qopen are polynomial in (cid:21) and p is exponential in (cid:21), we see that (qH (1 + qopen) + 1)=p
is negligible in (cid:21). Therefore, if the adversary does not generate related queries, Mechanism 6 satis(cid:12)es
anonymity under the DDH assumption in the random oracle model.
4.2 Analysis of Related Queries
(cid:3)
(cid:3)
i
and (cid:6)
= (fT
(cid:3)
Let m
gi2[1;4]; c
From the result of the previous section, we see that the only way to break the anonymity of Mechanism 6
is generating a related query. Therefore in this section, we analyze all cases of a related query and (cid:12)nd
out the cases in which the adversary might generate it.
ture, respectively. Let (em;e(cid:6) = (feTigi2[1;4];ec;e(cid:27)x;e(cid:27)y;e(cid:27)(cid:14);e(cid:27)q;e(cid:27)r)) be a related query. From the de(cid:12)nition of
a related query it holds that (feTigi2[1;4];feRigi2[1;4];em) = (fT
(em;e(cid:6)) ̸= (m
) holds, it is required that (e(cid:27)x;e(cid:27)y;e(cid:27)(cid:14);e(cid:27)q;e(cid:27)r) ̸= ((cid:27)
_ e(cid:27)q ̸= (cid:27)
(cid:3)
r ) be the challenge message and the challenge signa-
gi2[1;4]; m
gi2[1;4];fR
(cid:3)
i
(cid:3)
(cid:3)
(cid:14) ; (cid:27)
y; (cid:27)
_ e(cid:27)y ̸= (cid:27)
_ e(cid:27)r ̸= (cid:27)
_ e(cid:27)(cid:14) ̸= (cid:27)
e(cid:27)x ̸= (cid:27)
(cid:3)
r ). That is,
). Moreover, since
(cid:3)
(cid:14) ; (cid:27)