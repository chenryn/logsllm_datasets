tions (to client and to server), and only inject block pages if
this condition is met. This makes it more difﬁcult for an at-
tacker to spoof a connection, as it is infeasible for them to get
both sides of a spoofed connection to pass by the same middle-
box to induce injection. However, this solution will not work
for large-scale middleboxes that sit in large transit networks
and more frequently see only one side of a connection.
Limit injected response sizes Some middleboxes inject
large block pages, directly enabling large ampliﬁcation at-
tacks. An alternative approach is for these middleboxes to
only respond with a single RST to close a forbidden connec-
tion, or a with a minimal HTTP redirect to a different server
that hosts a block page. If the middlebox’s response size is
smaller than the minimum size required to trigger it, this en-
sures that the middlebox will not be a productive ampliﬁer.
Egress ﬁltering Though middleboxes are only supposed to
block websites for a limited group (such as a country or within
a corporate or school network), many operate “bidirection-
ally”, such that users outside the network accessing content
within can also trigger injected responses. For instance, users
outside China can still elicit the Great Firewall of China to
inject RST packets despite not being the intended target of
censorship. Instead, middleboxes should be conﬁgured to only
censor requests originating from within the intended network,
limiting the scope of victims of ampliﬁcation.
Remove or limit censorship devices Many middleboxes
inject block pages into censored HTTP requests which use
an outdated protocol that has been far surpassed in trafﬁc vol-
ume and page loads by HTTPS [38]. The utility that HTTP-
injecting devices provide is shrinking, and will ultimately
disappear as more sites use TLS. However, the damage they
inﬂict via ampliﬁcation attacks will remain until these de-
vices are removed. Disabling HTTP injection in these devices
altogether would prevent abuse from attackers.
9.2 End Hosts
End hosts can take steps to mitigate the potential impact of
these attacks. Hosts that drop outbound RST packets are more
susceptible to TCP handshake-based attacks, but hosts that
do not are susceptible to sustaining a packet storm from a
victim-sustained ampliﬁer. Instead, we recommend end hosts
be conﬁgured to drop outbound RST packets probabilistically;
this prevents an inﬁnite packet storm, while still offering some
protection from handshake-based ampliﬁers.
10 Conclusion
We presented the ﬁrst non-trivial TCP-based reﬂected ampli-
ﬁcation attacks. To discover them, we made use of a novel
genetic algorithm that we trained directly against censoring
middleboxes. We then scanned the Internet dozens of times
3358    30th USENIX Security Symposium
USENIX Association
and ﬁnd over 200 million IPv4 addresses that provide am-
pliﬁcation from 1× to over 700,000×, as well as others that
effectively yield inﬁnite ampliﬁcation.
Through a series of thorough follow-up experiments, we
found that these TCP ampliﬁers are predominantly middle-
boxes, and frequently nation-state censorship devices. It has
long been understood that nation-state censors restrict open
communication for those in their borders; our work shows
that they pose an even greater threat to the Internet as a whole,
as attackers can weaponize their powerful infrastructures to
attack anyone.
Our results show that middleboxes introduce an unexpected,
as-yet untapped threat that attackers could leverage to launch
powerful DoS attacks. Protecting the Internet from these
threats will require concerted effort from many middlebox
manufacturers and operators. To assist in these efforts, we
have made our code publicly available at:
https://geneva.cs.umd.edu/weaponizing
Acknowledgments
We thank the network infrastructure team at the University
of Colorado Boulder for supporting our scanning efforts and
providing the resources that made this work possible. We also
thank the anonymous reviewers for their helpful feedback.
Finally, we thank our collaborators from the OTF and OONI
communities for contributing resources that enabled this work.
This research was supported in part by the Open Technology
Fund and NSF grants CNS-1816802 and CNS-1943240.
References
[1] Marios Anagnostopoulos, Georgios Kambourakis, Pana-
giotis Kopanos, Georgios Louloudakis, and Stefanos
Gritzalis. DNS Ampliﬁcation Attack Revisited. Com-
puters & Security, 39(B):475–485, November 2013.
[2] Bilal Anwer, Theophilus Benson, Nick Feamster, and
Dave Levin. Programming Slick Network Functions. In
Symposium on SDR Research (SOSR), 2015.
[3] Simurgh Aryan, Homa Aryan, and J. Alex Halderman.
Internet Censorship in Iran: A First Look. In USENIX
Workshop on Free and Open Communications on the
Internet (FOCI), 2013.
[4] Robert Beverly and Steven Bauer. The Spoofer Project:
inferring the Extent of Source Address Filtering on the
Internet. In USENIX Workshop on Steps to Reducing
Unwanted Trafﬁc on the Internet (SRUTI), 2005.
[5] Kevin Bock, Yair Fax, Jasraj Singh, Kyle Reese,
Iran: A New Model for Cen-
https://geneva.cs.umd.edu/posts/
and Dave Levin.
sorship.
iran-whitelister.
[6] Kevin Bock, George Hughey, Xiao Qiang, and Dave
Levin. Geneva: Evolving Censorship Evasion Strategies.
In ACM Conference on Computer and Communications
Security (CCS), 2019.
[7] Eric Cronin, Micah Sherr, and Matthew A. Blaze. The
Eavesdropper’s Dilemma. Technical report, Penn Engi-
neering, February 2006.
[8] CVE-2018-1000115: Memcached version
National Vulnerability Database, March
http://nvd.nist.gov/nvd.cfm?cvename=
CVE-2018-1000115.
1.5.5.
2018.
[9] Jakub Czyz, Michael Kallitsis, Manaf Gharaibeh, Chris-
tos Papadopoulos, Michael Bailey, and Manish Karir.
Taming the 800 Pound Gorilla: The Rise and Decline
of NTP DDoS Attacks. In ACM Internet Measurement
Conference (IMC), 2014.
[10] Zakir Durumeric, Eric Wustrow, and J. Alex Halderman.
ZMap: Fast Internet-wide Scanning and its Security Ap-
plications. In USENIX Security Symposium, 2013.
[11] Arturo Filasto and Jacob Appelbaum. OONI: Open
Observatory of Network Interference. In USENIX Work-
shop on Free and Open Communications on the Internet
(FOCI), 2012.
[12] Freedom House.
Freedom in the world re-
https://freedomhouse.org/countries/
port.
freedom-world/scores.
[13] Ben Jones, Tzu-Wen Lee, Nick Feamster, and Phillipa
Gill. Automated Detection and Fingerprinting of Cen-
sorship Block Pages. In ACM Internet Measurement
Conference (IMC), 2014.
[14] Sam Kottler.
report.
cident
2018-03-01-ddos-incident-report/,
2018.
February
28th DDoS
in-
https://github.blog/
Mar
[15] Marc Kührer, Thomas Hupperich, Christian Rossow, and
Thorsten Holz. Exit from Hell? Reducing the Impact
of Ampliﬁcation DDoS Attacks. In USENIX Security
Symposium, 2014.
[16] Marc Kührer, Thomas Hupperich, Christian Rossow, and
Thorsten Holz. Hell of a Handshake: Abusing TCP for
Reﬂective Ampliﬁcation DDoS Attacks. In USENIX
Workshop on Offensive Technologies (WOOT), 2014.
[17] Citizen Lab. Block test list. https://github.com/
citizenlab/test-lists.
USENIX Association
30th USENIX Security Symposium    3359
[18] Bingshuang Liu, Skyler Berg, Jun Li, Tao Wei, Chao
Zhang, and Xinhui Han. The Store-and-Flood Dis-
tributed Reﬂective Denial of Service Attack. In Inter-
national Conference on Computer Communication and
Networks (ICCCN), 2014.
[19] Gordon Lyon. nmap. https://nmap.org/.
[20] Bill Marczak, Nicholas Weaver, Jakub Dalek, Roya En-
saﬁ, David Fiﬁeld, Sarah McKune, Arn Rey, John Scott-
Railton, Ron Deibert, and Vern Paxson. An Analysis
of China’s “Great Cannon”. In USENIX Workshop on
Free and Open Communications on the Internet (FOCI),
2015.
[21] MaxMind. GeoLite2. https://dev.maxmind.com/
geoip/geoip2/geolite2, 2020.
[22] Allison McDonald, Matthew Bernhard, Luke Valenta,
Benjamin VanderSloot, Will Scott, Nick Sullivan,
J. Alex Halderman, and Roya Ensaﬁ. 403 Forbidden:
A Global View of CDN Geoblocking. In ACM Internet
Measurement Conference (IMC), 2018.
[23] Robert T. Morris. A Weakness in the 4.2BSD Unix
TCP/IP Software. CSTR 117, 1985.
[24] Zubair Nabi. The Anatomy of Web Censorship in Pak-
istan. In USENIX Workshop on Free and Open Commu-
nications on the Internet (FOCI), 2013.
[25] Craig Partridge and Mark Allman. Addressing ethical
considerations in network measurement papers. In NS
Ethics@ SIGCOMM, 2015.
[26] Vern Paxson. End-to-End Routing Behavior in the In-
ternet. In ACM SIGCOMM, 1996.
[27] Censored Planet. Censored Planet Raw Data. https:
//censoredplanet.org/data/raw.
[28] John Postel. Transmission control protocol. RFC 793,
Internet Engineering Task Force, September 1981.
[29] Matthew Prince.
that
The
almost
Cloudﬂare Blog, March
broke the internet.
2013.
https://blog.cloudflare.com/
the-ddos-that-almost-broke-the-internet/.
ddos
[30] Ram Sundara Raman, Prerana Shenoy, Katharina Kohls,
and Roya Ensaﬁ. Censored Planet: An Internet-wide,
Longitudinal Censorship Observatory. In ACM Confer-
ence on Computer and Communications Security (CCS),
2020.
[31] Ram Sundara Raman, Adrian Stoll, Jakub Dalek, Armin
Sarabi, Reethika Ramesh, Will Scott, and Roya Ensaﬁ.
Measuring the Deployment of Network Censorship Fil-
ters at Global Scale. In Network and Distributed System
Security Symposium (NDSS), 2020.
[32] Christian Rossow. Ampliﬁcation Hell: Revisiting Net-
work Protocols for DDoS Abuse. In Network and Dis-
tributed System Security Symposium (NDSS), 2014.
[33] Matthew Sargent, John Kristoff, Vern Paxson, and Mark
Allman. On the Potential Abuse of IGMP. ACM SIG-
COMM Computer Communication Review (CCR), 47(1),
2017.
[34] Will Scott, Thomas Anderson, Tadayoshi Kohno, and
Arvind Krishnamurthy. Satellite: Joint Analysis of
In USENIX
CDNs and Network-Level Interference.
Annual Technical Conference, 2016.
[35] Justine Sherry, Shaddi Hasan, Colin Scott, Arvind Krish-
namurthy, Sylvia Ratnasamy, and Vyas Sekar. Making
Middleboxes Someone Else’s Problem: Network Pro-
cessing as a Cloud Service. In ACM SIGCOMM, 2012.
[36] Rob Sherwood, Bobby Bhattacharjee, and Ryan Braud.
Misbehaving TCP Receivers Can Cause Internet-Wide
Congestion Collapse. In ACM Conference on Computer
and Communications Security (CCS), 2005.
[37] Kulvinder Singh and Ajit Singh. Memcached DDoS
Exploits: Operations, Vulnerabilities, Preventions and
Mitigations. In International Conference on Computing,
Communication and Security (ICCCS), 2018.
[38] Let’s Encrypt Stats. Percentage of Web Pages Loaded by
Firefox Using HTTPS. https://letsencrypt.org/
stats/#percent-pageloads, 2018.
[39] The Spoofer Project: State of IP Spooﬁng. https://
spoofer.caida.org/summary.php.
[40] UDP-Based Ampliﬁcation Attacks: Alert (TA14-017A).
National Cyber Awareness System Alerts, January
2014. https://www.us-cert.gov/ncas/alerts/
TA14-017A.
[41] Benjamin VanderSloot, Allison McDonald, Will Scott,
J. Alex Halderman, and Roya Ensaﬁ. Quack: Scalable
Remote Measurement of Application-Layer Censorship.
In USENIX Security Symposium, 2018.
[42] Zhongjie Wang, Yue Cao, Zhiyun Qian, Chengyu Song,
and Srikanth V. Krishnamurthy. Your State is Not Mine:
A Closer Look at Evading Stateful Internet Censorship.
In ACM Internet Measurement Conference (IMC), 2017.
[43] Zhongjie Wang, Shitong Zhu, Yue Cao, Zhiyun Qian,
Chengyu Song, Srikanth V. Krishnamurthy, Kevin S.
Chan, and Tracy D. Braun. SYMTCP: Eluding Stateful
Deep Packet Inspection with Automated Discrepancy
Discovery. In Network and Distributed System Security
Symposium (NDSS), 2020.
3360    30th USENIX Security Symposium
USENIX Association
[44] Xing Xu, Yurong Jiang, Tobias Flach, Ethan Katz-
Bassett, David Choffnes, and Ramesh Govindan. Inves-
tigating Transparent Web Proxies in Cellular Networks.
In Passive and Active Network Measurement Conference
(PAM), 2015.
[45] Xueyang Xu, Morley Mao, and J. Alex Halderman. In-
ternet Censorship in China: Where Does the Filtering
Occur? In Passive and Active Network Measurement
Conference (PAM), 2011.
[46] Tarun Kumar Yadav, Akshat Sinha, Devashish Gosain,
Piyush Kumar Sharma, and Sambuddho Chakravarty.
Where The Light Gets In: Analyzing Web Censorship
Mechanisms in India. In ACM Internet Measurement
Conference (IMC), 2018.
USENIX Association
30th USENIX Security Symposium    3361