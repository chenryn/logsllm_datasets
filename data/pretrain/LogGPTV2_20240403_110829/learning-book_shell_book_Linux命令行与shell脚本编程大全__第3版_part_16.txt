### 3. Linux 文件系统的挂载与管理

在第3章中已经讨论过，Linux文件系统将所有磁盘设备整合到一个统一的虚拟目录结构下。使用新的存储媒体之前，需要将其挂载到这个虚拟目录树中，这一过程被称为挂载（mounting）。

在现代图形化桌面环境中，大多数Linux发行版能够自动挂载特定类型的可移动存储媒体。这些可移动存储媒体包括CD-ROM、软盘和U盘等，它们可以从计算机上轻松移除。如果所使用的发行版不支持自动挂载或卸载功能，则需手动完成相关操作。本节将介绍一些可用于管理可移动存储设备的Linux命令行命令。

#### 1. mount 命令
`mount` 是Linux中用于挂载存储介质的命令。默认情况下，执行 `mount` 命令会列出当前系统上已挂载的所有设备信息。
```bash
$ mount
```
该命令提供了以下四部分信息：
- 媒体设备的设备文件名
- 设备挂载点（即在虚拟目录中的位置）
- 文件系统类型
- 已挂载媒体的访问状态

例如，上述输出的最后一行显示了一个被GNOME桌面环境自动挂载至 `/media/disk` 的U盘，其文件系统类型为 `vfat` ，表明它是在Windows系统中格式化的。

要手动挂载一个设备，你需要以root用户身份登录或者使用 `sudo` 来获取权限。基本的手动挂载命令格式如下：
```bash
mount -t <type> <device> <directory>
```
其中 `<type>` 参数指定了磁盘的文件系统类型。对于与Windows PC共享的存储设备，常见的文件系统类型有：
- `vfat`：适用于Windows长文件名系统。
- `ntfs`：广泛应用于Windows NT, XP, Vista以及Windows 7等操作系统中的高级文件系统。
- `iso9660`：标准的CD-ROM文件系统。

大多数U盘和软盘通常会被格式化成 `vfat` 文件系统，而数据光盘则必须使用 `iso9660` 类型。后两个参数分别指定了设备文件的位置及其在虚拟目录中的挂载点。例如，若想将U盘 `/dev/sdb1` 手动挂载到 `/media/disk` ，可以使用如下命令：
```bash
sudo mount -t vfat /dev/sdb1 /media/disk
```

一旦设备被挂载，root用户将拥有对该设备的全部访问权限，其他用户的访问权限则受到限制。可以通过设置目录权限来控制用户对设备的访问（相关内容将在第7章详细介绍）。

表4-5列出了 `mount` 命令的一些常用参数：

| 参数 | 描述 |
| --- | --- |
| `-a` | 挂载 `/etc/fstab` 文件中指定的所有文件系统 |
| `-f` | 模拟挂载但不实际执行挂载操作 |
| `-V` | 详细模式，展示挂载过程的每一步骤 |
| `-l` | 为ext2, ext3 或 XFS 文件系统添加标签 |
| `-r` | 将设备挂载为只读模式 |
| `-w` | 将设备挂载为读写模式（默认） |
| `-o` | 添加特定选项 |

`-o` 参数允许在挂载文件系统时添加额外的选项，如 `ro` （只读）、`rw` （读写）、`user` （允许普通用户挂载）等。

#### 2. umount 命令
当从Linux系统上移除可移动设备时，不能直接拔出，而是应该先卸载。`umount` 命令用于卸载设备，其语法简单明了：
```bash
umount [directory | device]
```
此命令支持通过设备文件名或挂载点来指定待卸载的设备。如果任何程序正在使用该设备上的文件，那么卸载操作将失败，并提示“device is busy”。

#### 3. df 命令
`df` 命令可以帮助你查看已挂载磁盘的使用情况。执行该命令将显示每个已挂载文件系统的总容量、已用空间、可用空间及挂载点等信息。
```bash
$ df
```
使用 `-h` 参数可以使输出结果更易读，单位将以KB, MB, GB等形式呈现。

#### 4. du 命令
`du` 命令用于显示特定目录下的磁盘使用情况，默认显示当前目录下所有文件和子目录的占用空间。为了提高效率，可以结合 `-c`, `-h` 和 `-s` 等参数来简化输出。

#### 5. sort 命令
`sort` 命令用于对文本数据进行排序，默认按字典顺序排列。对于数值排序，应加上 `-n` 参数以确保数字按值大小而非字符顺序排列。