### References

1. Adobe, Inc. *PDF Reference and Adobe Extensions to the PDF Specification*. [Online]. Available: http://www.adobe.com/devnet/pdf/pdf_reference.html
2. Marco Barreno, Blaine Nelson, Russell Sears, Anthony D. Joseph, and J. Doug Tygar. "Can Machine Learning Be Secure?" In *First ACM Symposium on Information, Computer and Communications Security (ASIACCS)*, 2006.
3. Battista Biggio, Giorgio Fumera, and Fabio Roli. "Multiple Classifier Systems for Adversarial Classification Tasks." In *Multiple Classifier Systems*. Springer, 2009.
4. Battista Biggio, Igino Corona, Davide Maiorca, Blaine Nelson, Nedim Šrndić, Pavel Laskov, Giorgio Giacinto, and Fabio Roli. "Evasion Attacks against Machine Learning at Test Time." In *6th European Machine Learning and Data Mining Conference (ECML/PKDD)*, 2013.
5. Stephan Chenette. *Malicious Documents Archive for Signature Testing and Research - Contagio Malware Dump*. [Online]. Available: http://contagiodump.blogspot.de/2010/08/malicious-documents-archive-for.html
6. Deepak Chinavle, Pranam Kolari, Tim Oates, and Tim Finin. "Ensembles in Adversarial Classification for Spam." In *18th ACM Conference on Information and Knowledge Management (CIKM)*, 2009.
7. Marco Cova, Christopher Kruegel, and Giovanni Vigna. "Detection and Analysis of Drive-By-Download Attacks and Malicious JavaScript Code." In *19th International World Wide Web Conference (WWW)*, 2010.
8. CVE Details. *Adobe Acrobat Reader — CVE Security Vulnerabilities, Versions and Detailed Reports*. [Online]. Available: http://www.cvedetails.com/product/497
9. George E. Dahl, Jack W. Stokes, Li Deng, and Dong Yu. "Large-Scale Malware Classification Using Random Projections and Neural Networks." In *38th IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)*, 2013.
10. Nilesh Dalvi, Pedro Domingos, Sumit Sanghai, and Deepak Verma. "Adversarial Classification." In *10th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD)*, 2004.
11. Stephanie Forrest. "Genetic Algorithms: Principles of Natural Selection Applied to Computation." *Science*, 261(5123), 1993.
12. Claudio Guarnieri, Alessandro Tanasi, Jurriaan Bremer, and Mark Schloesser. *Cuckoo Sandbox: A Malware Analysis System*. [Online]. Available: http://www.cuckoosandbox.org/
13. Mark Harman, William B. Langdon, and Westley Weimer. "Genetic Programming for Reverse Engineering." In *20th IEEE Working Conference on Reverse Engineering (WCRE)*, 2013.
14. Thomas Hungenberg and Matthias Eckert. *INetSim: Internet Services Simulation Suite*. [Online]. Available: http://www.inetsim.org/
15. John R. Koza. *Genetic Programming: On the Programming of Computers by Means of Natural Selection*, Volume 1. MIT Press, 1992.
16. Pavel Laskov and Nedim Šrndić. "Static Detection of Malicious JavaScript-Bearing PDF Documents." In *27th ACM Annual Computer Security Applications Conference (ACSAC)*, 2011.
17. Claire Le Goues, ThanhVu Nguyen, Stephanie Forrest, and Westley Weimer. "GenProg: A Generic Method for Automatic Software Repair." *IEEE Transactions on Software Engineering*, 2012.
18. Daniel Lowd and Christopher Meek. "Adversarial Learning." In *11th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining (KDD)*, 2005.
19. Davide Maiorca, Giorgio Giacinto, and Igino Corona. "A Pattern Recognition System for Malicious PDF Files Detection." In *8th International Conference on Machine Learning and Data Mining in Pattern Recognition*, 2012.
20. Davide Maiorca, Igino Corona, and Giorgio Giacinto. "Looking at the Bag Is Not Enough to Find the Bomb: An Evasion of Structural Methods for Malicious PDF Files Detection." In *8th ACM Symposium on Information, Computer and Communications Security (ASIACCS)*, 2013.
21. Patrick Maupin. *PDFRW: A Pure Python Library That Reads and Writes PDFs*. [Online]. Available: https://github.com/pmaupin/pdfrw
22. Anh Nguyen, Jason Yosinski, and Jeff Clune. "Deep Neural Networks are Easily Fooled: High Confidence Predictions for Unrecognizable Images." In *28th IEEE Conference on Computer Vision and Pattern Recognition (CVPR)*, 2015.
23. Conor Ryan. *Automatic Re-Engineering of Software Using Genetic Programming*, Volume 2. Springer Science & Business Media, 2012.
24. Karthik Selvaraj and Nino Fred Gutierrez. *The Rise of PDF Malware*. [Online]. Available: https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the_rise_of_pdf_malware.pdf, March 2010.
25. Charles Smutz and Angelos Stavrou. *Malicious PDF Detection Using Metadata and Structural Features*. Technical report, 2012.
26. Charles Smutz and Angelos Stavrou. "Malicious PDF Detection Using Metadata and Structural Features." In *28th ACM Annual Computer Security Applications Conference (ACSAC)*, 2012.
27. Nedim Šrndić and Pavel Laskov. *Mimicus: A Library for Adversarial Classifier Evasion*. [Online]. Available: https://github.com/srndic/mimicus
28. Nedim Šrndić and Pavel Laskov. "Detection of Malicious PDF Files Based on Hierarchical Document Structure." In *20th Network and Distributed System Security Symposium (NDSS)*, 2013.
29. Nedim Šrndić and Pavel Laskov. "Practical Evasion of a Learning-Based Classifier: A Case Study." In *35th IEEE Symposium on Security and Privacy (Oakland)*, 2014.
30. Symantec Corporation. *Symantec Internet Security Threat Report*, 2015.
31. VirusTotal. *Free Online Virus, Malware and URL Scanner*. [Online]. Available: https://www.virustotal.com/

### Appendix

#### A. Mutated Features in PDFrate

The 68 features mutated in our experiments to evade PDFrate are listed in Table VI. It is important to note that the absence of a feature from this list does not imply it is robust to evasion. The listed features were sufficient to achieve a 100% evasion rate in our experiment. Additionally, the unidirectional mutations observed in the evasion attack do not preclude the possibility of reverse mutations without corrupting malware samples in practice.

| **Feature Name** | **Mutability** |
|------------------|----------------|
| box nonother types | ↓ |
| box other only | ↑↓ |
| count acroform | ↑↓ |
| count action | ↑↓ |
| count box letter | ↓ |
| count box other | ↑↓ |
| count endobj | ↑↓ |
| count endstream | ↑↓ |
| count font | ↑↓ |
| count image med | ↑ |
| count image small | ↑ |
| count image total | ↑ |
| count image xsmall | ↓ |
| count javascript | ↓ |
| count js | ↓ |
| count obj | ↑↓ |
| count objstm | ↓ |
| count page | ↑↓ |
| count page obs | ↓ |
| count stream | ↑↓ |
| createdate mismatch | ↓ |
| createdate ts | ↑ |
| createdate tz | ↑↓ |
| createdate version ratio | ↑ |
| creator mismatch | ↓ |
| creator dot | ↑ |
| creator lc | ↑↓ |
| creator len | ↑↓ |
| creator num | ↑↓ |
| creator oth | ↑↓ |
| creator uc | ↑ |
| delta ts | ↑ |
| delta tz | ↑↓ |
| image mismatch | ↑↓ |
| image totalpx | ↑ |
| len obj avg | ↑↓ |
| len obj max | ↑↓ |
| len obj min | ↑↓ |
| len stream avg | ↑↓ |
| len stream max | ↑↓ |
| len stream min | ↑↓ |
| pos acroform avg | ↑↓ |
| pos acroform max | ↑↓ |
| pos acroform min | ↑↓ |
| pos box avg | ↑↓ |
| pos box max | ↑↓ |
| pos box min | ↑↓ |
| pos eof avg | ↑↓ |
| pos eof max | ↑↓ |
| pos eof min | ↑↓ |
| pos image avg | ↑↓ |
| pos image max | ↑↓ |
| pos image min | ↑↓ |
| pos page avg | ↑↓ |
| pos page max | ↑↓ |
| pos page min | ↑↓ |
| producer dot | ↑ |
| producer lc | ↑↓ |
| producer len | ↑↓ |
| producer mismatch | ↓ |
| producer num | ↑↓ |
| producer oth | ↑↓ |
| producer uc | ↑ |
| ratio imagepx size | ↑ |
| ratio size obj | ↑↓ |
| ratio size page | ↑↓ |
| ratio size stream | ↑↓ |
| size | ↑ |

#### B. Mutated Features in Hidost

The 24 inserted features and the 19 deleted features used to find 2,859 evasive variants against Hidost are listed in Table VII. As with PDFrate, the absence of a feature from this list does not imply it is robust to evasion.

| **Inserted Feature** | **Counts** |
|----------------------|------------|
| Metadata | 2,507 |
| Metadata/Length | 2,507 |
| Metadata/Subtype | 2,507 |
| Metadata/Type | 2,507 |
| PageLabels | 2,454 |
| ViewerPreferences/Direction | 2,363 |
| Pages/Resources/ProcSet | 1,991 |
| Pages/Resources | 1,968 |
| Pages/Rotate | 1,702 |
| Pages/MediaBox | 1,382 |
| Threads | 825 |
| OpenAction/MediaBox | 718 |
| OpenAction/Contents/Filter | 385 |
| OpenAction/Contents/Length | 385 |
| OpenAction/Contents | 369 |
| OpenAction/Resources | 319 |
| OpenAction/Resources/ProcSet | 319 |
| OpenAction/Rotate | 158 |
| OpenAction/CropBox | 158 |
| OpenAction/Type | 51 |
| OpenAction | 51 |
| PageLabels/Nums | 41 |
| PageLabels/Nums/S | 41 |
| PageLayout | 40 |

| **Deleted Feature** | **Counts** |
|--------------------|------------|
| Names/JavaScript/Names/S | 1,345 |
| PageLayout | 865 |
| Outlines/Type | 615 |
| Outlines | 615 |
| Outlines/Count | 615 |
| AcroForm/Fields | 502 |
| AcroForm | 500 |
| OpenAction/JS/Length | 330 |
| Pages/Rotate | 54 |
| Pages/Resources/ProcSet | 14 |
| AcroForm/DR/Encoding/PDFDocEncoding | 12 |
| AcroForm/DR/Encoding/PDFDocEncoding/Differences | 12 |
| AcroForm/DR/Encoding/PDFDocEncoding/Type | 12 |
| Pages/Resources | 11 |
| AcroForm/DA | 9 |
| Pages/MediaBox | 8 |
| OpenAction/S | 4 |
| Names/EmbeddedFiles | 3 |
| Names | 2 |