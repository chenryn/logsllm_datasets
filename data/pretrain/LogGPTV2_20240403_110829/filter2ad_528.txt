# Automating the Analysis of Honeypot Data (Extended Abstract)

**Authors:**
- Olivier Thonnard<sup>1</sup>
- Jouni Viinikka<sup>2</sup>
- Corrado Leita<sup>1</sup>
- Marc Dacier<sup>3</sup>

**Affiliations:**
- 1. Institut Eurecom, [Email](mailto:PI:EMAIL), [Email](mailto:PI:EMAIL)
- 2. France Telecom R&D, [Email](mailto:PI:EMAIL)
- 3. Symantec Research Labs, France, [Email](mailto:PI:EMAIL)

## Abstract
This extended abstract describes ongoing work aimed at further automating the analysis of data generated by large honeynet architectures, specifically Leurre.com and SGNET. The primary goal is to integrate the use of honeypot data into daily network security monitoring. We propose a two-step automated system: i) detecting relevant attack events within a large dataset, and ii) extracting highly similar events based on temporal correlation.

**Keywords:** Honeypots, Internet threats analysis, malicious behavior characterization

## 1. Introduction
Our objective is to identify and characterize large-scale phenomena on the Internet by automatically detecting similarities across network attack traces. The data analyzed is extracted from datasets collected through Leurre.com [4] and SGNET honeypot deployments [5]. By automating this analysis, we aim to integrate honeypot data into daily network security monitoring. This requires identifying relevant periods of activity on the sensors shortly after they occur and analyzing these periods to detect temporal and spatial similarities in observed attack processes.

In [2], the authors highlighted the utility of analyzing temporal correlations between different attacks collected through a honeynet. This can reveal synchronized attack patterns or uncover stealthier attack phenomena related to botnet propagation schemes or "multi-headed" attack tools [3]. Once groups of similar attack events are identified, a more in-depth analysis can be performed to characterize them with respect to other relevant attack features, such as spatial and temporal characteristics of attackers, or by examining meta-information from SGNET sensors, such as shellcode or malware characteristics when attacks result in successful uploads of shellcode commands and malicious binaries.

Through extensive characterization of similar attack events, we aim to discover other types of similarities across attack events, even if they occurred at different times. This process should facilitate the identification of possible root causes for new attack phenomena. Currently, the characterization and correlation steps may require some manual or semi-automated work.

## 2. Analysis Process
Our ongoing effort focuses on two main steps: i) automatically detecting relevant attack events within a large honeynet traffic dataset shortly after collection, and ii) grouping highly similar temporal events using clique algorithms and appropriate similarity metrics.

### Step i: Detection of Relevant Attack Events
We use a non-stationary autoregressive (NAR) modeling approach with Kalman fixed-lag smoothers [1] to detect relevant attack events. This method effectively flags the beginnings of activity periods and isolated activity peaks. Our initial results show that the algorithm is effective for three types of time series: ephemeral spikes, sustained bursts, and continuous patterns. However, it has limitations in detecting the end of an activity period, associating the end with the beginning, and avoiding masking of activity peaks by closely preceding peaks. We are working to improve these aspects of the detection algorithm.

### Step ii: Grouping Similar Temporal Events
To correlate the identified attack events, we use maximal clique algorithms [6], which group all events with significant similarities in an unsupervised manner. The advantage of this approach is that the number of groups (or cliques) does not need to be specified beforehand, and various feature vectors and similarity distances can be used transparently. We currently use two techniques: i) the dominant sets approach developed by Pavan and Pelillo [7], and ii) the quality-based clustering developed in [2]. The first approach provides a real approximation of the maximum clique problem (known to be NP-hard), while the second is more pragmatic, focusing on finding high-quality cliques with low computational overhead. The choice of the clique algorithm depends on the intrinsic characteristics of the dataset and the feature vectors used in the data mining process.

## References
1. Viinikka, J., Debar, H., MÂ´e, L., Lehikoinen, A., Tarvainen, M.: Processing intrusion detection alert aggregates with time series modeling. Information Fusion Journal (2008); Special Issue on Computer Security (to appear)
2. Thonnard, O., Dacier, M.: A Framework for Attack Patterns Discovery in Honeynet Data. In: Digital Forensic Research Workshop (DFRWS) (2008)
3. Pouget, F., Urvoy-Keller, G., Dacier, M.: Time signatures to detect multi-headed stealthy attack tools. In: 18th Annual FIRST Conference, Baltimore, USA (2006)
4. The Leurre.com Project, http://www.leurrecom.org
5. Leita, C., Dacier, M.: SGNET: a worldwide deployable framework to support the analysis of malware threat models. In: Proceedings of EDCC 2008, 7th European Dependable Computing Conference, Kaunas, Lithuania, May 7-9 (2008)
6. Pouget, F., Dacier, M., Zimmerman, J., Clark, A., Mohay, G.: Internet attack knowledge discovery via clusters and cliques of attack traces. Journal of Information Assurance and Security 1(1) (March 2006)
7. Pavan, M., Pelillo, M.: A new graph-theoretic approach to clustering and segmentation. In: Proceedings of IEEE Conference on Computer Vision and Pattern Recognition (2003)