Linode
Betcoin
3171 Mar 2012
Bitcoinica 18,547 May 2012
Jul 2012
Bitcoinica 40,000
Bitﬂoor
Sep 2012
24,078
Oct 2012
Trojan
3257
A/P/S
A/P/F
F/A/P
P/A
P/A/S
P/A/P
F/A
Yes
Yes
Yes
Yes
Yes
Yes
No
Table 3: Tracking thefts. For each theft, we list (approximately)
how many bitcoins were stolen, when the theft occurred, how the
money moved after it was stolen, and whether we saw any bitcoins
sent to known exchanges. For the movement, we use A to mean
aggregation, P to mean a peeling chain, S to mean a split, and F
to mean folding, and list the various movements in the order they
occurred.
the ones that did. For each theft, we ﬁrst found the speciﬁc set
of transactions that represented the theft; i.e., the set of transac-
tions in which the sender was the service being stolen from, and
the recipient was the thief. Starting with these transactions, we did
a preliminary manual inspection of the transactions that followed
to determine their approximate type: we considered aggregations,
in which bitcoins were moved from several addresses into a single
one; folding, in which some of the addresses involved in the ag-
gregation were not clearly associated with the theft, and thus were
potentially there to “clean” the stolen money; splits, in which a
large amount of bitcoins was split among two or more addresses;
and ﬁnally peeling chains, in which relatively small amounts were
peeled off from a succession of one-time change addresses holding
a large amount of bitcoins. Our results are summarized in Table 3.
Brieﬂy, the movement of the stolen money ranged from quite so-
phisticated layering and mixing to simple and easy to follow. Ex-
amining thefts therefore provides another demonstration of the po-
tential for anonymity provided by Bitcoin, and the ways in which
current usage falls short of this potential: for the thieves who used
the more complex strategies, we saw little opportunity to track the
ﬂow of bitcoins (or at least do so with any conﬁdence that owner-
ship was staying the same), but for the thieves that did not there
seemed to be ample opportunity to track the stolen money directly
to an exchange.
One of the easiest thefts to track was from Betcoin, an early gam-
bling site that was shut down after its server was hacked on April
11 2012 and 3,171 BTC were stolen in four installments of 2,902,
165, 17, and 87 BTC each. The stolen bitcoins then sat in the
thief’s address until March 15 2013 (when the bitcoin exchange
rate began soaring), when they were aggregated with other small
addresses into one large address that then began a peeling chain.
After 10 hops, we saw a peel go to Bitcoin-24, and in another 10
hops we saw a peel go to Mt. Gox; in total, we saw 374.49 BTC go
to known exchanges, all directly off the main peeling chain, which
originated directly from the addresses known to belong to the thief.
For some of the other thefts, de-anonymizing the ﬂow of bitcoins
was similarly straightforward: for the May 2012 Bitcoinica theft,
for example, we observed one peeling chain, occurring directly af-
ter an aggregation of addresses belonging to the thieves, in which
large amounts (i.e., hundreds of bitcoins) were peeled off directly
to known exchanges; in total, we saw 4,588 BTC peeled off to three
different exchanges (BTC-e, CampBX, and Bitstamp). Again, al-
though we do not account for every stolen bitcoin, watching even
a portion of them ﬂow to exchanges provides the opportunity we
need to potentially compromise the anonymity of the thieves.
In contrast, some of the other thieves used more sophisticated
strategies to attempt to hide the ﬂow of money; e.g., for the Bit-
ﬂoor theft, we observed that large peels off several initial peeling
chains were then aggregated, and the peeling process was repeated.
Nevertheless, by manually following this peel-and-aggregate pro-
cess to the point that the later peeling chains began, we system-
atically followed these later chains and again observed peels to
multiple known exchanges: the third peel off one such chain was
191.09 BTC to Mt. Gox, and in total we saw 661.12 BTC sent to
three popular exchanges (Mt. Gox, BTC-e, and Bitstamp).
Even the thief we had the most difﬁculty tracking, who stole
bitcoins by installing a trojan on the computers of individual users,
seemed to realize the difﬁculty of cashing out at scale. Although
we were unable to conﬁdently track the ﬂow of the stolen money
that moved, most of the stolen money did not in fact move at all:
of the 3,257 BTC stolen to date, 2,857 BTC was still sitting in the
thief’s address, and has been since November 2012.
With these thefts, our ability to track the stolen money provides
evidence that even the most motivated Bitcoin users (i.e., crimi-
nals) are engaging in idioms of use that allow us to erode their
anonymity. While one might argue that thieves could easily thwart
our analysis, as Heuristic 2 is admittedly not robust in the face of
adversarial behavior, our observation is that — at least at present —
none of the criminals we studied seem to have taken such precau-
tions. We further argue that the fairly direct ﬂow of bitcoins from
the point of theft to the deposit with an exchange provides some
evidence that using exchanges to cash out at scale is inevitable, and
thus that — again, at present — Bitcoin does not provide a partic-
ularly easy or effective way to transact large volumes of illicitly-
obtained money.
6. RELATED WORK
Since its inception, questions regarding the security — and in
particular the anonymity — of Bitcoin have received considerable
interest. On the ﬁrst front, much work has concerned the strength
of Bitcoin’s settlement mechanism and the difﬁculty of an adver-
sary in subverting it. The two best known explorations concerning
Bitcoin “double spending” are from Karame et al. [9] and Meni
Rosenfeld [19]. At their core, both focus on the tradeoffs between
latency (the number of conﬁrmations made through the Bitcoin net-
work) and the computational requirements of an attacker — a trade-
off that implicitly explains the different risk regimes operational in
the Bitcoin ecosystem today.
The second thrust of Bitcoin security research, closer to our own
interest, has focused on the anonymity of its transactions. In 2011,
fueled by the high-proﬁle MyBitcoin theft, Reid and Harrigan [17]
provided one of the ﬁrst written analyses. Using a clustering algo-
rithm similar to our Heuristic 1, they obtained a condensed “user”
graph, and used it to describe the ﬂow of stolen money from the
aforementioned theft. In a more recent paper, Ron and Shamir [18]
performed a similar analysis over the user graph (again using an
heuristic similar to our Heuristic 1), and provided an in-depth ex-
amination of the largest transactions in Bitcoin history. From this
data they conclude that there is massive hoarding in the Bitcoin sys-
tem and that the vast majority of capital does not circulate. Concur-
rently with the work of Ron and Shamir, Androulaki et al. [2] ap-
plied a similar analysis, but focused more squarely on privacy con-
cerns. Unlike Ron and Shamir, their analysis attempts to account
for the complexity of “change” accounts which are central to how
Bitcoin is used in practice. Applying this analysis to a simulated
Bitcoin graph (in which ground truth data was known), 40% of user
identities were correctly classiﬁed through such clustering. As we
mention brieﬂy in Section 4.3, their approach is insufﬁcient for an
empirical characterization of Bitcoin trafﬁc since the assumptions it
makes (particularly around the use of multi-output transactions) are
routinely violated today. On the constructive side, Miers et al. [12]
presented Zerocoin, a system designed to cryptographically am-
plify the anonymity guarantees in Bitcoin, precisely motivated by
potential of the analysis techniques described in this paper.10 Most
recently, Möser [14] examined the anonymity of three Bitcoin mix
services, and found that some were more successful than others,
although all had a distinct transaction graph pattern due to their
centralized nature.
Finally, we are aware of three analyses of key parts of the Bitcoin
economy: Kroll et al.’s economic analysis of Bitcoin mining [10],
Christin’s study of the Silk Road marketplace [4] and Moore and
Christin’s analysis of Bitcoin exchange failures [13]. The ﬁrst pa-
per applies a game-theoretic analysis to the mining mechanism of
Bitcoin, and in particular creates a formal model for a 51% (or
“Goldﬁnger”) attack, in which a cartel of miners are responsible for
over half of the blocks being mined. They then discuss the circum-
stances under which such an attack could take place, and conclude
that Bitcoin governance is not only inevitable but also necessary
for the future of the currency. The second effort uses regular Web
crawling of the Silk Road marketplace to characterize the popular-
ity of illicit goods (typically controlled substances) and to estimate
the total market value of such transactions. While this work does
not examine the Bitcoin block chain at all, it could be used in tan-
dem with our analysis to estimate the spread of such “dirty money”
in the Bitcoin graph. Finally, the third paper is driven by the cen-
tral role of Bitcoin exchanges, which are commonly used to deposit
user funds. However, by escrowing funds with a third party outside
the protections of the Bitcoin protocol, users can, and are, exposed
to the risk of these exchanges failing. Moore and Christin provide a
meta-analysis showing that almost half of all such exchanges have
failed, and that failure is positively correlated to transaction volume
(which they hypothesize is because the risk of a data breach is re-
lated to the value a criminal may obtain through such an action).
While the authors do not focus on anonymity, we note that such
breaches also provide large amounts of labeling data by which the
broader Bitcoin graph can be de-anonymized.
7. CONCLUSIONS
In this study, we presented a longitudinal characterization of the
Bitcoin network, focusing on the rise of services and the grow-
ing gap — due to certain idioms of use — between the potential
anonymity available in the Bitcoin protocol design and the actual
anonymity that is currently achieved by users. To accomplish this
task, we developed a new clustering heuristic based on change ad-
dresses, allowing us to cluster addresses belonging to the same user.
Then, using a small number of transactions labeled through our
own empirical interactions with various services, we identify major
institutions and the interactions between them. Even our relatively
small experiment demonstrates that this approach can shed consid-
erable light on the structure of the Bitcoin economy, how it is used,
and those organizations who are party to it.
Although our work examines the current gap between actual and
potential anonymity, one might naturally wonder — given that our
new clustering heuristic is not fully robust in the face of chang-
10The authors write, “There is reason to believe that sophisticated
results from other domains (e.g., efforts to deanonymize social net-
work data using network topology) will soon be applied to the Bit-
coin transaction graph.”
ing behavior — how this gap will evolve over time, and what users
can do to achieve stronger anonymity guarantees. We argue that to
completely thwart our heuristics would require a signiﬁcant effort
on the part of the user, and that this loss of usability is unlikely to
appeal to all but the most motivated users (such as criminals). Nev-
ertheless, we leave a quantitative analysis of this hypothesis as an
interesting open problem.
Acknowledgments
We would like to thank Brian Kantor and Cindy Moore for man-
aging our systems and storage needs, and for helping to set up and
maintain our mining rig. We are also grateful to Andreas Pitsillidis
for his advice in creating ﬁgures and overall useful discussions.
Finally, we thank our anonymous reviewers and our shepherd, Ka-
terina Argyraki, for their helpful feedback and guidance.
This work was supported by National Science Foundation grants
NSF-1237264 and NSF-1237076, by the Ofﬁce of Naval Research
MURI grant N00014-09-1-1081, and by generous research, opera-
tional and/or in-kind support from Google, Microsoft, Yahoo, and
the UCSD Center for Networked Systems (CNS).
8. REFERENCES
[1] G. Andresen. bitcointools.
github.com/gavinandresen/bitcointools.
[2] E. Androulaki, G. Karame, M. Roeschlin, T. Scherer, and
S. Capkun. Evaluating User Privacy in Bitcoin. In
Proceedings of Financial Cryptography 2013, 2013.
[3] CBC News. Revenue Canada says BitCoins aren’t tax
exempt, Apr. 2013.
www.cbc.ca/news/canada/story/2013/04/26/
business-bitcoin-tax.html.
[4] N. Christin. Traveling the Silk Road: A Measurement
Analysis of a Large Anonymous Online Marketplace. In
Proceedings of WWW 2013, 2013.
[5] B. P. Eha. Get ready for a Bitcoin debit card. CNNMoney,
Apr. 2012.
money.cnn.com/2012/08/22/technology/
startups/bitcoin-debit-card/index.html.
[6] European Central Bank. Virtual Currency Schemes. ECB
Report, Oct. 2012. www.ecb.europa.eu/pub/pdf/
other/virtualcurrencyschemes201210en.pdf.
[7] Federal Bureau of Investigation. (U) Bitcoin Virtual
Currency Unique Features Present Distinct Challenges for
Deterring Illicit Activity. Intelligence Assessment, Cyber
Intelligence and Criminal Intelligence Section, Apr. 2012.
cryptome.org/2012/05/fbi-bitcoin.pdf.
[8] FinCEN. Application of FinCEN’s Regulations to Persons
Administering, Exchanging, or Using Virtual Currencies,
Mar. 2013. www.fincen.gov/statutes_regs/
guidance/pdf/FIN-2013-G001.pdf.
[9] G. Karame, E. Androulaki, and S. Capkun. Double-Spending
Fast Payments in Bitcoin. In Proceedings of ACM CCS 2012,
2012.
[10] J. A. Kroll, I. C. Davey, and E. W. Felten. The Economics of
Bitcoin Mining, or Bitcoin in the Presence of Adversaries. In
Proceedings of WEIS 2013, 2013.
[11] J. Matonis. Bitcoin Casinos Release 2012 Earnings. Forbes,
Jan. 2013. www.forbes.com/sites/jonmatonis/
2013/01/22/bitcoin-casinos-release-2012-
earnings/.
[12] I. Miers, C. Garman, M. Green, and A. D. Rubin. Zerocoin:
Anonymous Distributed E-Cash from Bitcoin. In
Proceedings of the IEEE Symposium on Security and
Privacy, 2013.
[13] T. Moore and N. Christin. Beware the Middleman: Empirical
Analysis of Bitcoin-Exchange Risk. In Proceedings of
Financial Cryptography 2013, 2013.
[14] M. Möser. Anonymity of Bitcoin Transactions: An Analysis
of Mixing Services. In Proceedings of Münster Bitcoin
Conference, 2013.
[15] S. Nakamoto. Bitcoin: A Peer-to-Peer Electronic Cash
System, 2008. bitcoin.org/bitcoin.pdf.
[16] M. Peck. Bitcoin-Central is Now The World’s First Bitcoin
Bank...Kind Of. IEEE Spectrum: Tech Talk, Dec. 2012.
spectrum.ieee.org/tech-talk/telecom/
internet/bitcoincentral-is-now-the-
worlds-first-bitcoin-bankkind-of.
[17] F. Reid and M. Harrigan. An Analysis of Anonymity in the
Bitcoin System. In Security and Privacy in Social Networks,
pages 197–223. Springer New York, 2013.
[18] D. Ron and A. Shamir. Quantitative Analysis of the Full
Bitcoin Transaction Graph. In Proceedings of Financial
Cryptography 2013, 2013.
[19] M. Rosenfeld. Analysis of hashrate-based double-spending,
Dec. 2012. bitcoil.co.il/Doublespend.pdf.
[20] Securities and Exchange Commission. SEC Charges Texas
Man With Running Bitcoin-Denominated Ponzi Scheme,
July 2013. www.sec.gov/News/PressRelease/
Detail/PressRelease/1370539730583.
[21] znort987. blockparser.
github.com/znort987/blockparser.