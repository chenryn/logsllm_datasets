title:Email typosquatting
author:Janos Szurdi and
Nicolas Christin
Email Typosquatting
Janos Szurdi
Carnegie Mellon University
PI:EMAIL
Nicolas Christin
Carnegie Mellon University
PI:EMAIL
ABSTRACT
While website domain typosquatting is highly annoying for le-
gitimate domain operators, research has found that it relatively
rarely presents a great risk to individual users. However, any appli-
cation (e.g., email, ftp,...) relying on the domain name system for
name resolution is equally vulnerable to domain typosquatting, and
consequences may be more dire than with website typosquatting.
This paper presents the first in-depth measurement study of
email typosquatting. Working in concert with our IRB, we regis-
tered 76 typosquatting domain names to study a wide variety of user
mistakes, while minimizing the amount of personal information ex-
posed to us. In the span of over seven months, we received millions
of emails at our registered domains. While most of these emails
are spam, we infer, from our measurements, that every year, three
of our domains should receive approximately 3,585 “legitimate”
emails meant for somebody else. Worse, we find, by examining a
small sample of all emails, that these emails may contain sensitive
information (e.g., visa documents or medical records).
We then project from our measurements that 1,211 typosquatting
domains registered by unknown entities receive in the vicinity
of 800,000 emails a year. Furthermore, we find that millions of
registered typosquatting domains have MX records pointing to only
a handful of mail servers. However, a second experiment in which
we send “honey emails” to typosquatting domains only shows very
limited evidence of attempts at credential theft (despite some emails
being read), meaning that the threat, for now, appears to remain
theoretical.
CCS CONCEPTS
• Security and privacy → Human and societal aspects of se-
curity and privacy; Network security; • Networks → Network
measurement;
KEYWORDS
Domain name, Typosquatting, Abuse, Measurement, Ethics
ACM Reference Format:
Janos Szurdi and Nicolas Christin. 2017. Email Typosquatting. In Proceedings
of IMC ’17: Internet Measurement Conference . ACM, New York, NY, USA,
13 pages. https://doi.org/10.1145/3131365.3131399
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
© 2017 Association for Computing Machinery.
ACM ISBN 978-1-4503-5118-8/17/11...$15.00
https://doi.org/10.1145/3131365.3131399
1 INTRODUCTION
Domain typosquatting is the act of registering a domain name very
similar to an existing, legitimate, domain, in an effort to capture
some of the traffic destined for the original domain. Domain ty-
posquatting exploits the propensity of users to make typographical
errors when typing domain names—as opposed to clicking on links—
and is frequently used for financial profit. For instance, somebody
registering googe.com would immediately receive large amounts
of traffic meant for google.com. That traffic could then in turn
be monetized, by showing ads or setting up drive-by-downloads.
Domain typosquatting has been shown to be profitable [18, 24],
while requiring no technical skill.
In some jurisdictions, domain typosquatting is considered illegal,
and may trigger trademark infringement cases.1 In 1999, ICANN,
the authority which regulates domain names on the Internet, cre-
ated the Uniform Domain Name Dispute Resolution Policy (UDRP)
as a solution for trademark owners to claim cybersquatting or ty-
posquatting domain names [21].
Thus far, most of the studies in the related literature have solely
focused on web typosquatting, that is, domain typosquatting used
to illicitly acquire “page views.” However, domain typosquatting
can be equally used with other target applications—ssh, ftp, email,
and so forth.
This paper is the first in-depth study to focus on email typosquat-
ting, in which miscreants could register domain names mimicking
those of large email providers to capture emails. Even though typing
mistakes may be fairly rare, typosquatting a large email provider
(e.g., gmail.com) could remain a profitable endeavor by virtue of
the number of emails passing through the service. Indeed, while
most emails illicitly received would be of limited use to the attacker,
some could contain sensitive information that could yield large
payoffs for the attacker, and cause considerable losses to the victim.
We put this hypothesis to the test in this paper. Specifically, we
register 76 email typosquatting domains, collect data from these
domains for more than seven months (June 4, 2016–January 15,
2017), and—working in concert with our Internal Review Board
(IRB)—design a protocol to process the emails we receive to deter-
mine the potential harm email domain typosquatting might inflict
on users, as well as its potential benefits to attackers (Section 4).
We discover that a number of actors already have the infrastruc-
ture necessary for bulk email domain typosquatting (Section 5).
Extrapolating from our observations through regression analysis
(Section 6), we find that setting up the necessary infrastructure
costs attackers only in the order of a couple of cents per email, and
that they can expect to receive hundreds of thousands of emails
over a few months. However, by actively sending “honey emails”
containing credentials, we discover, that even though a lot of these
1See, e.g., in the U.S., the Federal Trademark Dilution Act, or FTDA, and the Anti-
cybersquatting Consumer Protection Act, ACPA.
419
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
J. Szurdi and N. Christin
emails are accepted, they are not actually read (Section 7), meaning
that email typosquatting does not appear, for now, to be monetized.
2 RELATED WORK
Our work broadly inscribes itself in the general line of research
in online crime measurements, which has been an extremely ac-
tive area of research over the past fifteen years or so. Rather than
providing a comprehensive overview of the entire area, we refer
the reader to recent survey papers in the field [12, 28]. Here, we
focus instead on the narrower body of work that has attempted
to characterize the prevalence of domain typosquatting, and its
economic effects, and outline how our work builds on more than
fourteen years of research in the community.
Most typosquatting papers have focused on web typosquatting,
which targets users who make a mistake while typing an URL in
their browser. In 2003, Edelman undertook the first case study of one
typosquatter who registered, at the time, thousands of domains [17].
Subsequently, a number of efforts [13–15, 31] proposed methods to
detect typosquatting domains targeting popular websites, as ranked
by the Alexa service [1], and to differentiate legitimate domains
from typosquatting domains [27]. Some of these studies suggest
that monetization is achieved through domain parking – the act of
monetizing otherwise empty web pages with advertisements.
Moore and Edelman [24] discussed monetization of typosquat-
ting, and showed that miscreants might be relying on Google Ad-
Words to select which typosquatting domains to register. Along
the same lines, Agten et al. [11] provided a longitudinal study of
monetization strategies of typosquatting targeting Alexa’s top 500
domains. More recently, Khan et al. [22] quantified the harm of
typosquatting caused to users, and found that a typical user loses
1.3 seconds on average when visiting a typosquatting domain.
Different from this entire body of work, we broaden the scope
of investigation to email typosquatting, which, from a technical
standpoint shares many similarities with web typosquatting (low
barrier to entry, low sophistication), but whose monetization strate-
gies ought to be completely different—whereas web typosquatting
primarily profits from advertisements, through “parking pages [30],”
email typosquatting is likely to benefit from capturing credentials
or sensitive information.
To the best of our knowledge, only one white paper looked
at domain typosquatting beyond web typosquatting [19]. The au-
thors registered domains that were similar to existing subdomains,
with the exception of a missing dot—e.g., caibm.com as opposed
to ca.ibm.com. They claim to have collected 120,000 mis-directed
emails over six months, but do not report on the number of do-
mains they registered, and do not discuss whether they filtered out
spam. Our work attempts to provide a far more detailed picture
of email typosquatting in the wild; in particular, we will observe
that filtering out spam email is a crucial step in providing credible
measurements of the attack’s impact. We also investigate whether
typosquatters act upon emails they receive.
3 TERMINOLOGY
Typosquatting actually involves a number of different concepts,
which we discuss here.
420
Distance metrics. We use two metrics to characterize the distance
between various domain names. The Damerau-Levenshtein distance
[16] is the minimum number of operations (deletion, addition, sub-
stitution, or transposition of two neighboring characters). Papers
on typosquatting often rely on Damerau-Levenshtein distance of
one (“DL-1”) to detect typosquatting domains. Moore and Edelman
define the fat-finger distance as “the minimum number of insertions,
deletions, substitutions or transpositions using letters adjacent on
a QWERTY keyboard to transform one string into another.” [24]
A fat-finger distance of one (FF-1) implies a DL-1 distance. The
visual distance measures how different the mistyped character looks
compared to the original character. We use a set of heuristic rules
to compute the visual distance, which incorporate how confusing
alphabet letters with numbers (e.g., “o” and “O,” “1” and “l”) is more
likely to happen than confusing two (different) letters or numbers.
Typosquatting domains. The target domain name refers to any
domain name targeted by typosquatters. Previous work on web
typosquatting usually relies on Alexa rankings [1] to identify target
domains.
We adopt Szurdi et al.’s taxonomy [27] to clearly differentiate
lexically close domains from true typosquatting domain names.
Generated typo domains (“gtypos”) are “domain names which are
lexically similar (e.g. at DL-1) to some set of target domains.” Candi-
date typo domains (“ctypos”) are “the subset of registered domains
within the gtypo set which have been registered.” Finally, typosquat-
ting domains are candidate typo domains that “(i) [were] registered
to benefit from traffic intended for a target domain,” and “(ii) that
[are] the property of a different entity.”
Misdirected email taxonomy. Typosquatting of email domains
allows an attacker to capture a number of different emails. First,
receiver typo emails are simply sent to the wrong address by the
sender mistyping the recipient’s email address. We only focus on
typos in the domain name, and leave the issue of typos in the
recipient name to future work.2
We also consider reflection typo emails. Those emails are the
result of users mistyping their email address when registering for
an online service. As a consequence, emails from the service are
subsequently sent to the wrong address. While the harm caused
would be likely negligible in the case of an online raffle, providing
the wrong address to a financial services company might lead to
leaks of confidential or sensitive information.
Last, we capture a completely different type of error with SMTP
typo emails, which result from a user mistyping their SMTP settings
in their email client. This type of error is pernicious, as all emails
sent by the victim may be intercepted until the typo is fixed.
4 IN THE SHOES OF A TYPOSQUATTER
In this section we describe a seven-month experiment (June 4, 2016–
January 15, 2017), during which we acted as email typosquatters
ourselves, in an effort to gain insights into whether email typosquat-
ting could be a potential problem or not. The idea is simple: by reg-
istering typosquatting domains, we can simply count the number
of emails these domains—which we absolutely did not advertise or
otherwise use, to avoid measurement confounds—receive, and infer
whether email typos occur frequently or not, and if so, which kind
2For instance, we consider PI:EMAIL, but not aliec@gmail.com.
Email Typosquatting
IMC ’17: Internet Measurement Conference , November 1–3, 2017, London, United Kingdom
of typos seem more prevalent than others. This analysis will later
be useful in attempting to derive more general projections, beyond
the set of domains we registered, on the potential magnitude of the
problem overall.
Because we are ultimately acting as attackers, our experimental
setup is driven by ethical considerations. We start with a discussion
of these ethical objectives, before turning to how our collection
methodology attempts to fulfill these objectives. We then analyze
the results of our data collection.
4.1 Ethical challenges and how to address them
Registering a set of typosquatting domain names ourselves pro-
vides a very precise view of the type of information users may
accidentally leak. At the same time, 1) we need to tread carefully
with possible trademark infringement, and, even more importantly,
2) we can potentially receive users’ personal information.
Both issues are very serious and led us to design our protocol
with the collaboration of our university’s Internal Review Board
(IRB), in an effort to minimize the risk to users, and to ourselves. The
protocol was approved by our IRB, and our sponsor’s IRB, before
we started our experiments.
The trademark infringement part—which actually does not im-
pact any users but us—was relatively quickly settled. We agreed
to surrender any domain we registered to the legitimate owner of
a trademark it could potentially infringe upon simple request. To
date, we have not received any such requests.
While we elected to keep emails accidentally sent to our domains
to carry out deeper analyses than could be done by simply keep-
ing headers, we take three measures to protect the users who sent
these emails. First, our storage infrastructure consists of a hard-
ened server accessible only from our university network. Second,
we automatically remove sensitive information using regular ex-
pression matching prior to storage. Finally, we encrypt all emails
prior to storing them, using an encryption key kept separately from
the server (i.e., on removable storage). To result in potential harm,
accidental disclosure of the contents of the server would need to
be accompanied by a leakage of our encryption key.
Even though our IRB protocol allows us to look at the content
of the emails we receive, provided that we do our best effort to
automatically sanitize personal identifiers prior to doing so, we
wanted to minimize as much as possible such interactions. Initially,
we were hoping to be able to derive the content of these emails
purely programmatically—i.e., inferring the presence of leaks from
regular expression matching on the body, classification of attach-
ment names, etc. However, we received an enormous amount of
spam email, which made it important to fine-tune and evaluate the
spam filtering system we used. We eventually settled on looking at
a small sample of 103 emails (out of several millions we received
overall) that were classified as non-spam to evaluate the perfor-
mance of our spam classifier, which is absolutely crucial to the rest
of our analysis due to the imbalance of our dataset.
In other words, we adopted a utilitarian ethics view—while it is
undesirable (but permitted by our IRB-approved protocol) to look
at some of these email contents, we were satisfied that the small
minority of emails we were manually analyzing would 1) not result
in any risk to the users who sent (or were meant to receive) these
421
emails, while 2) giving us stronger confidence in our results. We
re-emphasize that potentially sensitive information (e.g., credit card
numbers) was automatically scrubbed prior to our looking at these
103 emails.