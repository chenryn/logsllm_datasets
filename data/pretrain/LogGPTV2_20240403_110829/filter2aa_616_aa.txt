© 2013 tenacitysolutions.com 1835 Alexander Bell Drive, Suite 100, Reston, VA 20191 703-673-3100
Weaponizing your Pets!
The War Kitteh and the Denial of 
Service Dog!
DefCon!
10 August 2014!
!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Introductions!
•  Gene Bransﬁeld @gbransﬁeld!
•  Principle Security Engineer @ Tenacity!
•  I Love My Job!
•  They want my job!
•  They can’t have it!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
What is This About?!
•  Having a humorous idea!
•  Bringing Ideas to Fruition!
•  Stories of Triumph and Woe!
•  Valuable Lessons Learned!
!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Weaponize your PETS!?!?!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Background:!
•  15% of the world’s Internet trafﬁc is 
dedicated to Cats!
•  I ﬁnd most tech brieﬁngs boring, so I use 
pics of cats to help keep people awake!
!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
The pic that started it all:!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Just Finished a Presentation…
"!
•  Someone told me they were going to 
give me this tracking collar that they won!
– GPS!
– Cellular!
– Told you where the Kitteh was at all times!
•  …add a little wiﬁ sniffer and we’d have a 
WAR KITTEH!!!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
What about the DoS Dog?!
•  AT Outerz0ne!
•  LadyMerlin walked in with a dog wearing 
a harness that said Denial of Service 
Dog!
•  I said “Is there a Pineapple in there?”!
– No, the dog is a pain, but that’s a geat idea!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Working Animals!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Bad Ass Working Animals!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Badder Ass Working Animals!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Real Navy Seal!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Flipper Pic!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Other Research Efforts!
•  Accoustic Kitty!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
MY STUFF -- Requirements!
•  War Kitteh Requirements:!
•  CONOP:  Put a collar/harness on a cat and allow said 
feline to roam the neighborhood normally.  The collar/
harness shall contain a GPS tracking device and a 
wireless sniffer/scanner.  We'll be looking to map WiFi 
Access points similar to war driving. !
–  0.) CAT SHALL NOT BE HARMED!
–  1.) Cat shall be able to comfortably wear stuff and should not be 
harmed by said stuff or by wearing said stuff!
–  2.) GPS shall record waypoints with associated date/time stamp for 
collection post-walkabout (e.g. when the cat returns).!
•  a.) optionally, solution to provide on-demand locational data as well so we can 
ﬁnd a lost kitteh or kitteh harness!
–  3.) WiFi sniffer scanner shall sync time with GPS device and collect 
wiﬁ SSIDs and other WiFi-related signals for later Analysis!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Other Products!
•  Mr Lee Cat Cam!
– http://www.mr-lee-catcam.de!
•  Pet Tracker !
– http://www.pettracker.com!
•  Garmin!
– https://buy.garmin.com/!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
GumStix!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Cotton Candy!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
RockChip 3066!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Thinking about it…!
•  Small form factor!
•  GPS!
•  Wiﬁ!
•  Cellular!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
How ‘bout a Cell Phone?!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Now make an APK!?!?!
•  Need to code a wiﬁ war driving!
•  Let’s do some android coding…?!
•  They already thought of that…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
WiGLE WiFi!
!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Volunteer Cat!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Cat Coat?!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
“Cat” Coat!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Plan:!
•  Put Tech in Coat!
!
•  Put Coat on Cat!
•  Send cat on walkabout!
•  Recover data when cat returns!
•  Proﬁt!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Step 1!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Step 2!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Step 2 cont!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Step 3!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Step… 4?!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
…yeah…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Trying this again….!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Ummm….!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
FAIL!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Last Known GPS…?!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Lessons Learned!
•  Cats are damn hard to work with!
•  Always test before you send out ‘spensive 
stuff!
•  Amazon Prime account!
•  Worried about cat, so no more coat!
•  Smaller form factor with same capability!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Talked to my Friend Bill…!
•  Hobbiest & Technologist!
•  What about Arduino!
– Small form factor!
– Low power consumption!
– Does what you need it to do and no more!
– Many chips, variety of solutions!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
What is Arduino?!
•  Arduino is an open-source electronics 
platform based on easy-to-use hardware 
and software. It's intended for anyone 
making interactive projects.!
•  Lots of expansion boards of “Shields”!
•  Make robots, remote control cars, home 
security products, etc.!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Freezer check!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Robotic Hand!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Video Games!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Small Form Factor…!
•  Arduino Mini…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Good News… Bad News…!
•  Good News!!
– Open Source!
– Inexpensive!
•  Bad News!!
– Poorly Documented!
– Takes forever to get to you!
– Questionable performance…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Well I Never… !
•  Done Anything with Arduino!
•  Worked with ﬁrmware/small chip sets!
•  Not a professional coder…!
•  Soldered !
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Don’t Worry!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Plan…!
1.)  Learn about Arduino!
"
"-- Get some basic stuff!
!
2.) Decide on most accommodating form 
factor for WarKitteh!
!
3.) Put it all together in a collar FTW!
!
4.)  Do some stuff with DoS Dog…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Learning Arduino…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Basic Stuff…!
•  Arduino Uno!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Flashy Things…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Cooler Stuff!!
•  I need software libraries for WiFi !
– They got it!!
•  I need software libraries for GPS!
– They got it!!
•  I need software libraries for SD card stuff!
– They got it!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Shout Out…!
•  Jeremy Blum Videos!
– Jeremyblum.com!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
I r a Expert!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
So I got…!
•  Arduino WiFi Shield!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
And Finally…!
•  Itead Studio GPS Shield!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
The plan…!
•  Get a WiFi collection function!
– Write to SD Card!
•  Get a GPS tracker!
– Write to SD card!
•  Combine!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
WiFi Shield!
•  Set up was easy!
•  Drivers worked!
•  Messing around with parameters and 
variables and!
•  VICTORY!!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
EASY!!!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
A bit about GPS!
•  NMEA string!
–  National Maratime Electronics Association!
   $GPGGA,123519,4807.038,N,01131.000,E,1,08,0.9,545.4,M,46.9,M,,*47!
!
•  Boot process!
–  Start up!
•  Where am I…?!
–  Listen to SPACE!
–  Get a lock (at least 3 satellites)!
•  2-15 minutes!!! (depending on conditions)!
!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
GPS Shield!
•  Poorly Documented!
•  No docs in kit!
•  Searched forever to ﬁnd baudrate of 
34800!
•  Now I can’t NOT ﬁnd it!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Put all the components 
together!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
So weird error…!
•  Something about 80% of memory 
utilized…!
•  Libraries and variables were too much…!
•  Arduino Uno – 32K!
•  Arduino Mega2560 – 256K!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Purchased the Mega…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Put THAT all together!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
It WORKS!!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Arduino Mega2560!
•  Mo Memory!
– Mo betta!
•  Mo Ports!
– Mo betta!
•  Mo Size!
– Not Mo betta!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Tiny Arduino2560?!
•  Arduino MegaMini from JK Devices!
•  DON’T DO IT!!!!! more later…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Small Form Factor!
•  Adafruit Wiﬁ…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Spark Core!
•  Spark.io!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
GPS chip!
•  GP-635T!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Micro SD Card!
•  SparkFun MicroSD Breakout Board!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
So it works, but…!
•  MegaMini says it’s going to be 4 weeks 
to ship at least…!
•  Other solutions are too big (size) or too 
small (memory)!
•  Spark.io Spark Core!
– Shipping problem, had to borrow one!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Real Tech on Spark!
√!
√!
√      !
√!
X!
•  ARM 32-bit M3 CPU                     !
•  128KB Memory (wooHOO!!!)       !
•  SPI and I2C compliant                       !
•  TI CC3000 WiFi chip                    !
•  “Arduino Compatible”                   !
– Worked with external components!
– Coding wouldn’t work!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
OMG!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Start-up Product!
•  Starting everything from scratch!
–  Didn’t have libraries for the stuff I needed!
•  To spite that, VERY COOL!
•  Dedicated core group of developers!
–  Shout out to peekay123!
•  Lets see what happens…!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100
Libraries!
•  Someone Posted SD Card Libraries to 
the forums!
– They Compiled!  !
•  Someone posted GPS libraries to the 
forums…!
– They Compiled & Worked with GPS Shield!!
© 2013 tenacitysolutions.com 1835 Alexander Bell Dr. Suite 100, Reston, VA 20191 703-673-3100