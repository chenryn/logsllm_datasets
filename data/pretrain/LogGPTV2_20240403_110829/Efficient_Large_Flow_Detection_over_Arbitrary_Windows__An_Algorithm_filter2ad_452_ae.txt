TH
h
2
3
Attack Flow Rate (Byte/s)
2.5
3.5
4
4.5
5
x 10
  0
100
200
300
400
Duration of Burst (ms)
500
600
700
800
900
1000
(a) Flooding DoS Attack
(b) Shrew DoS Attack
Figure 5: Detection Probability in Experiment with 55*2 counters in Multistage Filter.
Evaluation metrics. We consider three evaluation met-
rics: detection probability, false positive probability on small
ﬂows, and incubation period. Detection probability is the
probability to successfully detect a generated attack ﬂow.
False positive probability on small ﬂows is the probability
to wrongly catch a small ﬂow when the link is attacked by
attack ﬂows of a certain rate. Incubation period represents
the time needed to catch a generated attack ﬂow since it is
generated.
5.3 Experimental Comparison
Since the results for the two datasets are similar, we omit
CAIDA’s results due to space constraints.
Figure 5(a) and 5(b) shows the detection probability in
the face of diﬀerent types of attack ﬂows. We focus on the
scenario of using 55 ∗ 2 counters in FMF and AMF, as the
results of 250 ∗ 2 counters are similar. In Figure 5(b), the
T Hh line indicates whether a bursty ﬂow exceeds the high-
bandwidth threshold. The results show that EARDet de-
tects attack ﬂows with a 100% detection probability, which
conﬁrms Theorem 4. On the contrary, Figure 5(b) shows
that FMF cannot catch most of the Shrew ﬂows. Moreover,
EARDet can catch most of the attack ﬂows in the ambigu-
ity region (between T Hℓ(t) and T Hh(t)).
Figure 6(a) to Figure 6(h) show the results of FPs rates.
While EARDet has zero FPs in any case as expected, Fig-
ure 6(a) to Figure 6(d) shows that both FMF and AMF
have high FPs rates in both attack scenarios when using
very limited memory as EARDet. That is, the attacker
can successfully incriminate benign small ﬂows. Worst yet,
when the link is congested by attack ﬂows, the FPs rate can
be as high as 4% for FMF and 1% for AMF under ﬂooding
attacks, and for FMF, the FPs rate is also extremely high
under Shrew attacks. An interesting observation is that, in
Figure 6(a), both FMF and AMF have a higher FPs rate
when the link is congested by malicious small ﬂows. As Fig-
ure 6(e) to 6(h) show, using more counters in FMF and AMF
can reduce, but not eliminate, the FPs rates. The results of
the CAIDA dataset exhibit similar trends.
Also, in our experiments, EARDet always produces sim-
ilar results no matter whether the link is congested. In con-
trast, the results of AMF and FMF are much diﬀerent be-
tween the congested-link version and non-congested-link ver-
sion. This supports the conclusion in Section 5.1 that AMF
and FMF rely on the number of active ﬂows but EARDet
does not. This advantage makes EARDet stable in any
networking environment.
)
c
e
s
(
d
o
i
r
e
P
n
o
i
t
a
b
u
c
n
I
1
0.8
0.6
0.4
0.2
0
2
Incubation Period
Ave t
incb
Max t
incb
t
upincb
γ
h
2.5
3
3.5
4
Attack Flow Rate (Byte/s)
4.5
5
x 10
Figure 7: Incubation Period.
Figure 7 describes the maximum and average incubation
period of high-rate ﬂows with diﬀerent rates in ﬂooding at-
tacks. We can ﬁnd that the maximum incubation period for
ﬂows whose rate is over γh is always below the theoretical
upper bound for the incubation period, tupincb, which sup-
ports Theorem 7. Moreover, the average incubation period
is much lower than the theoretical upper bound, which shows
EARDet’s incubation period is much shorter in practice.
6. RELATED WORK
Section 2.1 classiﬁes prior work on detecting large ﬂows
and its closely related problem of ﬁnding frequent items
based on the types of monitoring windows. Cormode and
Hadjieleftheriou [9] present a thorough survey and compari-
son of algorithms for ﬁnding frequent items. This section re-
views prior approaches based on the techniques used. Most
219False Positive Of Legitimate Flow Under Large Rate Flow Attack
False Positive Of Legitimate Flow Under Shrew Attack
False Positive Of Legitimate Flow Under Large Rate Flow Attack
y
t
i
l
i
b
a
b
o
r
P
0.06
0.05
0.04
0.03
0.02
0.01
   0
0.2
EARDet
FMF
AMF
γ
atk
γ
y
t
i
l
i
b
a
b
o
r
P
0.1
  0
1
2
3
Attack Flow Rate (Byte/s)
4
5
x 10
EARDet
FMF
AMF
TH
h
0.004
0.003
0.002
0.001
y
t
i
l
i
b
a
b
o
r
P
    0
200
400
600
800
1000
Duration of Burst (ms)
EARDet
FMF
AMF
γ
atk
γ
1
2
3
Attack Flow Rate (Byte/s)
4
5
x 10
(a) 55*2 counters - Congested Link
(b) 55*2 counters - Congested
Link
(c) 55*2 counters - Non-congested
Link
False Positive Of Legitimate Flow Under Large Rate Flow Attack
False Positive Of Legitimate Flow Under Shrew Attack
EARDet
FMF
AMF
TH
h
0.002
EARDet
FMF
AMF
γ
atk
γ
y
t
i
l
i
b
a
b
o
r
P
0.001
y
t
i
l
i
b
a
b
o
r
P
0.005
0.004
0.003
0.002
0.001
    0
False Positive Of Legitimate Flow Under Shrew Attack
EARDet
FMF
AMF
TH
h
200
400
600
800
1000
Duration of Burst (ms)
y
t
i
l
i
b
a
b
o
r
P
0.0012
0.0011
 0.001
0.0009
0.0008
0.0007
0.0006
0.0005
0.0004
0.0003
0.0002
0.0001
     0
1
2
3
Attack Flow Rate (Byte/s)
4
5
x 10
    0
200
400
600
800
1000
Duration of Burst (ms)
(d) 55*2 counters - Non-congested
Link
(e) 250*2 counters
Link
- Congested
(f) 250*2 counters - Congested
Link
False Positive Of Legitimate Flow Under Large Rate Flow Attack
False Positive Of Legitimate Flow Under Shrew Attack
0.0004
0.0003
0.0002
0.0001
y
t
i
l
i
b
a
b
o
r
P
     0
EARDet
FMF
AMF
γ
atk
γ
0.0002
y
t
i
l
i
b
a
b
o
r
P
0.0001
EARDet
FMF
AMF
TH
h
1
2
3
Attack Flow Rate (Byte/s)
4
5
x 10
     0
200
400
600
800
1000
Duration of Burst (ms)
(g) 250*2 counters - Non-congested
Link