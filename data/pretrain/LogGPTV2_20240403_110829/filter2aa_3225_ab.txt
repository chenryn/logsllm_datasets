  time	
  that	
  there	
  was	
  a	
financial	
  case	
  for	
  neat	
  and	
  tidy	
  interconnect	
  cabling.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  5	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
Variations from Common Practices 
In	
  order	
  to	
  meet	
  the	
  requirements	
  dictated	
  by	
  the	
  low	
  latency	
  /	
  deterministic	
performance	
  model	
  identified	
  above,	
  a	
  number	
  of	
  critical	
  variations	
  from	
  common	
practice	
  must	
  be	
  made.	
For	
  nearly	
  all	
  installations,	
  the	
  usual	
  perimeter	
  defensive	
  mechanisms	
  will	
  be	
completely	
  absent.	
  You	
  won’t	
  find	
  a	
  firewall,	
  you	
  won’t	
  see	
  routers	
  with	
  ACLs,	
  you	
won’t	
  see	
  IDS	
  and	
  frankly,	
  anything	
  that	
  you’d	
  recognize	
  as	
  a	
  security	
  tool.	
The	
  essential	
  reason	
  that	
  security	
  devices	
  are	
  largely	
  (if	
  not	
  wholly)	
  absent	
  from	
most	
  implementations	
  is	
  that	
  the	
  best	
  the	
  IT	
  Security	
  industry	
  can	
  offer	
  falls	
  short.	
Most	
  commercial	
  firewalls	
  process	
  data	
  and	
  add	
  a	
  few	
  milliseconds	
  of	
  additional	
latency.	
  In	
  the	
  vast	
  majority	
  of	
  interconnection	
  scenarios,	
  a	
  few	
  milliseconds	
  isn’t	
  that	
much	
  of	
  a	
  problem.	
  In	
  the	
  case	
  of	
  low	
  latency	
  trading,	
  it’s	
  about	
  100,000	
  times	
  too	
  slow.	
In	
  addition	
  to	
  products	
  which	
  simply	
  do	
  not	
  support	
  this	
  mode	
  of	
  operation,	
  there’s	
  a	
skills	
  gap	
  in	
  the	
  practitioner	
  space,	
  the	
  majority	
  of	
  IT	
  Security	
  workers	
  in	
  very	
  large	
organizations	
  which	
  are	
  utilizing	
  low	
  latency	
  trading	
  don’t	
  have	
  the	
  necessary	
background	
  to	
  implement	
  some	
  very	
  old-­‐fashioned	
  and	
  very	
  basic	
  network	
  security	
while	
  at	
  the	
  same	
  time	
  determine	
  how	
  to	
  properly	
  secure	
  a	
  host	
  with	
  custom	
everything.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  6	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
Threat Models 
Training	
  staff	
  with	
  the	
  necessary	
  skills	
  to	
  do	
  network	
  security	
  like	
  it’s	
  1999	
  and	
also	
  the	
  insight	
  necessary	
  to	
  find,	
  understand	
  and	
  communicate	
  flaws	
  in	
  custom	
  FPGA	
based	
  network	
  interface	
  hardware	
  is	
  not	
  a	
  trivial	
  exercise.	
  And	
  for	
  this	
  reason,	
  the	
  vast	
majority	
  of	
  installations	
  simply	
  skip	
  security	
  and	
  rely	
  on	
  market-­‐data	
  providers	
  and	
exchanges’	
  commitments	
  around	
  the	
  security	
  of	
  the	
  network	
  itself	
  without	
  real	
comprehension	
  of	
  the	
  potential	
  threats.	
Developing	
  an	
  appropriate	
  trust	
  model	
  should	
  be	
  trivial	
  –	
  we	
  already	
  know	
  that	
we’re	
  missing	
  our	
  entire	
  set	
  of	
  controls	
  –	
  but	
  how	
  to	
  describe	
  the	
  real	
  issue	
  and	
  how	
  do	
we	
  determine	
  the	
  most	
  appropriate	
  response?	
Start	
  by	
  managing	
  the	
  three	
  largest	
  threats:	
The	
  Developers	
  –	
  In	
  most	
  algo-­‐trading,	
  the	
  developer	
  isn’t	
  a	
  traditional	
developer	
  with	
  all	
  of	
  the	
  usual	
  SDLC	
  controls.	
  The	
  developer	
  is	
  probably	
  a	
  trader	
  or	
trader’s	
  underling	
  who	
  has	
  live	
  access	
  to	
  the	
  production	
  algo	
  engine	
  and	
  can	
  make	
  on	
the	
  fly	
  changes.	
The	
  Insider	
  –	
  This	
  is	
  not	
  the	
  “financial	
  insider”,	
  but	
  rather	
  a	
  trader	
  or	
  an	
administrator	
  of	
  a	
  set	
  of	
  low-­‐latency	
  systems	
  who	
  is	
  utilizing	
  access	
  to	
  market	
  data	
networks	
  or	
  exchange	
  networks	
  to	
  cause	
  negative	
  effects	
  of	
  the	
  other	
  participants.	
The	
  Market	
  Itself	
  –	
  This	
  is	
  an	
  odd	
  kind	
  of	
  technical	
  threat	
  –	
  but	
  as	
  the	
  other	
  party	
in	
  a	
  communication,	
  could	
  the	
  market	
  cause	
  issues	
  with	
  your	
  systems?	
  What	
  about	
malformed	
  messages?	
  What	
  about	
  other	
  participants	
  with	
  compromised	
  systems?	
As	
  you	
  build	
  the	
  picture	
  of	
  what	
  your	
  threat	
  model	
  should	
  encompass,	
  ensure	
that	
  you	
  consider	
  that	
  even	
  very	
  odd	
  cases	
  might	
  actually	
  be	
  the	
  common	
  case.	
  At	
  the	
speed	
  of	
  transaction	
  flow,	
  can	
  you	
  really	
  prevent	
  things	
  from	
  occurring	
  or	
  should	
  you	
build	
  your	
  threat	
  model	
  around	
  post-­‐fact	
  detective	
  controls?	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  7	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
Beginning the Solution 
‡ The	
  journey	
  of	
  a	
  thousand	
  miles	
  begins	
  with	
  a	
  single	
  step.	
  ~	
  Lao-­‐tzu	
From	
  where	
  most	
  low-­‐latency	
  or	
  algo	
  trading	
  systems	
  are	
  currently	
  in	
  terms	
  of	
security,	
  any	
  change	
  would	
  be	
  a	
  positive	
  change.	
  Due	
  to	
  the	
  need	
  for	
  speed,	
  some	
  of	
the	
  techniques	
  utilized	
  in	
  the	
  late	
  90s	
  are	
  completely	
  appropriate	
  –	
  bastion	
  hosts,	
router	
  acls,	
  layer	
  3	
  and	
  4	
  firewall	
  rules	
  –	
  assuming	
  you	
  are	
  using	
  sufficiently	
  fast	
equipment	
  –	
  and	
  top-­‐of-­‐rack	
  switches	
  are	
  now	
  available	
  that	
  offer	
  sub-­‐microsecond	
performance	
  for	
  cut	
  through	
  layer	
  4	
  switching.	
Even	
  if	
  you	
  cannot	
  implement	
  any	
  changes,	
  it	
  would	
  be	
  an	
  improvement	
  in	
security	
  posture	
  to	
  have	
  a	
  complete	
  architectural	
  understanding	
  of	
  the	
  systems	
  as	
implemented.	
  Situational	
  awareness	
  is	
  important.	
Product	
  vendors	
  –	
  it’s	
  time	
  to	
  step	
  up	
  and	
  give	
  this	
  market	
  some	
  attention.	
There’s	
  money	
  to	
  be	
  had	
  by	
  individuals	
  who	
  want	
  more	
  than	
  checkbox	
  protection.	
Risk	
  /	
  Process	
  /	
  Policy	
  /	
  GRC	
  –	
  work	
  with	
  the	
  business,	
  they	
  understand	
  risk	
  –	
probably	
  better	
  than	
  you	
  do	
  –	
  but	
  have	
  a	
  different	
  set	
  of	
  tolerances.	
  Use	
  their	
knowledge	
  to	
  help	
  make	
  good	
  decisions	
  rather	
  than	
  blindly	
  following	
  dogmatic	
statements.	
IT	
  Compliance	
  –	
  meet	
  the	
  financial	
  compliance	
  people	
  –	
  I’m	
  sure	
  you’ll	
  find	
things	
  to	
  talk	
  about.	
  Finally.	
Practitioners	
  in	
  the	
  Trenches	
  –	
  research	
  everything.	
  Be	
  prepared	
  to	
  operate	
  at	
all	
  levels	
  simultaneously	
  with	
  reaction	
  times	
  that	
  match	
  your	
  low-­‐latency	
  business	
partners.	
  Work	
  on	
  proof	
  of	
  concept	
  to	
  see	
  where	
  you	
  can	
  and	
  cannot	
  actually	
  help.	
  And	
most	
  of	
  all,	
  be	
  prepared	
  for	
  the	
  continued	
  downward	
  pressure	
  on	
  transaction	
  times.	
Security	
  When	
  Nanoseconds	
  Count	
  -­‐	
  Blackhat	
  USA	
  Briefings	
  2011	
2011-­‐07-­‐13	
Page	
  8	
Arlen-­‐SecurityWhenNanosecondsCount-­‐Whitepaper-­‐v1.docx	
About James Arlen, CISA 
James	
  Arlen,	
  CISA,	
  is	
  Principal	
  at	
  Push	
  The	
  Stack	
  Consulting	
  providing	
  security	
consulting	
  services	
  to	
  the	
  utility	
  and	
  financial	
  verticals.	
  He	
  has	
  been	
  involved	
  with	
implementing	
  a	
  practical	
  level	
  of	
  information	
  security	
  in	
  Fortune	
  500,	
  TSE	
  100,	
  and	
major	
  public-­‐sector	
  corporations	
  for	
  more	
  than	
  15	
  years.	
  James	
  is	
  also	
  a	
  contributing	
analyst	
  with	
  Securosis	
  and	
  has	
  a	
  recurring	
  column	
  on	
  Liquidmatrix	
  Security	
  Digest.	
  Best	
described	
  as:	
  "Infosec	
  geek,	
  hacker,	
  social	
  activist,	
  author,	
  speaker,	
  and	
  parent."	
  His	
areas	
  of	
  interest	
  include	
  organizational	
  change,	
  social	
  engineering,	
  blinky	
  lights	
  and	
shiny	
  things.