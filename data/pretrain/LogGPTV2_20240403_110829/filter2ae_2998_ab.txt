     (u'2019-05-02T19:37:20', 8181, u'http', u'Apache Tomcat/Coyote JSP engine')
     (u'2019-05-01T00:48:05', 8009, u'ajp13', u'Apache Jserv')
     (u'2019-04-09T16:29:58', 8181, u'http', u'Apache httpd')
     (u'2019-03-24T20:46:31', 8181, u'http', u'Apache Tomcat/Coyote JSP engine')
很典型的JSP运行环境，在2019年5月的时候开了8009端口，Tomcat后台管理弱口令等问题一直都是渗透常用手段～～
顺带提一句，其实这次的攻击还涉及了另外一个IP，因为这个IP相关端口banner因为更新被覆盖了，所以直接通过ZoomEye线上搜索是搜索不到的，不过如果你知道这个IP也可以利用ZoomEye历史数据API来查询这个IP的历史数据，这里就不详细展开了。
## 案例二：毒云藤（APT-C-01）
关于毒云藤（APT-C-01）的详细报告可以参考
我们直接把关注点放在
“毒云藤组织使用的一个用于控制和分发攻击载荷的控制域名 ”
“然后从 `hxxp://updateinfo.servegame.org/tiny1detvghrt.tmp` 下载 payload”
URL上，我们先尝试找下这个域名对应的IP，显然到现在这个时候还没有多大收获：
    ╭─heige@404Team ~
    ╰─$ping updateinfo.servegame.org
    ping: cannot resolve updateinfo.servegame.org: Unknown host
在奇安信的报告里我们可以看到使用的下载服务器WEB服务目录可以遍历
所以我们应该可以直接尝试搜索那个文件名“tiny1detvghrt.tmp”，果然被我们找到了
这里我们可以基本确定了`updateinfo.servegame.org`对应的IP为165.227.220.223 那么我们开始老套路查询历史数据：
        >>> data = zm.history_ip("165.227.220.223")
        >>> 9
        >>> for i in data['data']:
         ...     print(i['timestamp'],i['portinfo']['port'])
         ...
         (u'2019-06-18T19:02:22', 22)
         (u'2018-09-02T08:13:58', 22)
         (u'2018-07-31T05:58:44', 22)
         (u'2018-05-20T00:55:48', 80)
         (u'2018-05-16T20:42:35', 22)
         (u'2018-04-08T07:53:00', 80)
         (u'2018-02-22T19:04:29', 22)
         (u'2017-11-21T19:09:14', 80)
         (u'2017-10-04T05:17:38', 80)
继续看看这个`tiny1detvghrt.tmp`部署的时间区间：
    >>> for i in data['data']:
     ...     if "tiny1detvghrt.tmp" in i['raw_data']:
     ...             print(i['timestamp'],i['portinfo']['port'])
     ...
     (u'2018-05-20T00:55:48', 80)
     (u'2018-04-08T07:53:00', 80)
     (u'2017-11-21T19:09:14', 80)
最起码可以确定从2017年11月底就已经开始部署攻击了，那么在这个时间节点之前还有一个时间节点2017-10-04
05:17:38，我们看看他的banner数据：
    >>> for i in data['data']:
     ...     if "2017-10-04" in i['timestamp']:
     ...             print(i['raw_data'])
     ...
     HTTP/1.1 200 OK
     Date: Tue, 03 Oct 2017 21:17:37 GMT
     Server: Apache
     Vary: Accept-Encoding
     Content-Length: 1757
     Connection: close
     Content-Type: text/html;charset=UTF-8
      Index of /
    Index of /
       NameLast modifiedSizeDescription
    doajksdlfsadk.tmp2017-09-15 08:21  4.9K 
    doajksdlfsadk.tmp.12017-09-15 08:21  4.9K 
    doajksdlrfadk.tmp2017-09-27 06:36  4.9K 
    dvhrksdlfsadk.tmp2017-09-27 06:38  4.9K 
    vfajksdlfsadk.tmp2017-09-27 06:37  4.9K 
    wget-log2017-09-20 07:24  572  
从这个banner数据里可以得出结论，这个跟第一个案例里目标明确的入侵后植入水坑不一样的是，这个应该是攻击者自主可控的服务器，从`doajksdlfsadk.tmp`这些文件命名方式及文件大小（都为4.9k）基本可以推断这个时间节点应该是攻击者进行攻击之前的实战演练！所以这个IP服务器一开始就是为了APT攻击做准备的，到被发现后就直接抛弃！
## 总结
网络空间搜索引擎采用主动探测方式在网络攻击威胁追踪上有很大的应用空间，也体现了历史数据的价值，通过时间线最终能复盘攻击者的攻击手段、目的及流程。最后感谢所有支持ZoomEye的朋友们，ZoomEye作为国际领先的网络空间测绘搜索引擎，我们一直在努力！
* * *