        Tour
        admin
        User account actionsView profileEdit profileLog out      
  File system
Add to Default shortcuts
    Breadcrumb
                  Home
                  Administration
                  Configuration
                  Media
                  Error message
                    The directory phar://./sites/default/files/pictures/2020-10/blog-ZDI-CAN-7232-cat.jpg does not exist and could not be created.
      Public file system path
        sites/default/files
      A local file system path where public files will be stored. This directory must exist and be writable by Drupal. This directory must be relative to the Drupal installation directory and be accessible over the web. This must be changed in settings.php
      Public file base URL
        http://172.17.41.106:8080/sites/default/files
      The base URL that will be used for public file URLs. This can be changed in settings.php
      Private file system path
        Not set
      An existing local file system path for storing private files. It should be writable by Drupal and not accessible over the web. This must be changed in settings.php
      Temporary directory
      A local file system path where temporary files will be stored. This directory should not be accessible over the web.
    Default download method
        Public local files served by the webserver.
              This setting is used as the preferred download method. The use of public files is more efficient, but does not provide any access control.
      Delete temporary files after
        Never6 hours12 hours1 day1 week4 weeks3 months
      Temporary files are not referenced, but are in the file system and therefore may show up in administrative lists. Warning: If enabled, temporary files will be permanently deleted and may not be recoverable.
```
## 检测规则/思路
### Suricata规则
```s
alert http any any -> any any (msg:"CVE-2019-6339-Drupal远程代码执行漏洞";flow:established,to_server;content:"POST";http_method;content:"/admin/config/media/file-system";http_uri;content:"phar%3A%2F%2F.%2Fsites%2Fdefault%2Ffiles%2Fpictures%2F";http_client_body;reference:url,blog.csdn.net/qq_40989258/article/details/104970882;classtype:web-application-attck;sid:3002021;rev:1;)
```
### 建议
流量+安全设备比较容易检测到此攻击行为。
## 参考推荐
MITRE-ATT&CK-T1190
(环境搭建+复现) CVE-2019-6339 Drupal远程代码执行漏洞