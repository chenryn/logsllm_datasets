err 144
err object 134
Error
try/catch 259
error
properties 135
run-time 134
error handling 277
DCOM 285
error messages 267
common 279
ERROR_INVALID_PARAMETER 283
ERROR_SUCCESS 283
ErrorInfo 145
ErrorMessage 259
exception 258
EXE 14
EXECPINFO 134
ExitInstance 199, 225
export file 58
F
facility 265
FAILED 264
fiber 152
FindConnectionPoint 224
first_is 120
fixed 119
float 108
FormatMessage 268
Free 156
294    Index
free threads 153, 155, 160, 164
FreeLibrary 29
G
garbage collection 242
GetIDsOfNames 128
GetMessage 154
GetTypeInfo 128
GetTypeInfoCount 128
Globally Unique IDentifier 12
GUID 5, 12
GUIDGEN 13
H
hard typing 136
heap 2
heartbeat 242
helpcontext 97
helpstring 97
hives 168
HKEY 168
HKEY_CLASSES_ROOT 168
HKEY_LOCAL_MACHINE 168
HRESULT 22
bit fields 264
facility codes 265
severity codes 266
HRESULT_CODE 265
HRESULT_SEVERITY 266
HRESULTS 263
hyper 108
I
i.c file 94, 194
ICallBack 215
IClassFactory 79
IConnectionPointContainer 224
IConnectionPointContainerImpl 214, 
216
IConnectionPointImpl 214, 225
ICpTest 215
id binding 127
identity 238
IDispatch 98, 127
IDispatchImpl 129, 139, 252
IDL boolean 113
IDL definitions 126
IDL language 91, 95
IDLdefinitions 126
IDLTESTLib 102
IID 22, 87
impersonation 237
levels 241
import directive 260
importlib 100, 103, 107
inheritance 88
object 61
Init 197
InitInstance 196
in-process server 14, 29, 178
InprocServer32 172
int 108
interactions
between client and server 16
interface 7, 68, 73
as contract 69
attributes 99
callback 181
defining and using 107
defining with IDL language 92
dispatch 140
dual 98, 125, 137
execute a method 24
IDispatch 127
inheritance 89
isolate 8
key 170
map 194
polling 183
release 24
InterfaceSupportsErrorInfo 146
InterlockedDecrement 84
InterlockedIncrement 84
inter-process 6
inter-thread marshaling 204, 207
invasion of the body-snatchers 255
Invoke 128, 133
IPersistFile 98
Index
295
IRegister 175
isolate 8
implementation 10
IStream 207
ISupportErrorInfo 144, 145
IUnknown 10, 74
K
keys 170
L
language indpendent 5
language-independent 68
last_is 120
late binding 127
launch permissions 236
launching servers 288
LaunchPermission 236
length_is 120
library
statement 102
type 102, 126
lifetime 83
LoadLibrary 29
Local Procedure Calls 229
local/remote transparency 69, 234
LocalServer32 171, 172
LocalService 174
LocalSystem 239
lock 227
long 108
LPC 229
lstrlen 113
M
marshaling 85, 86, 151
between threads 162
custom 95
inter-thread 204, 207
standard 94
max_is 120
message loop 153
method 144
adding 36
method call 24, 85
MFC 27, 245, 246
MFC dialog 191
Microsoft Interface Definition Language 
91
MIDL 70, 91
base types 108
compiler 91
post-processing 103
special tab 96
structures 121
MKTYPLIB 95
model 70, 152
MTA 155
MULTI_QI 232
multi-dimensional 120
multiple inheritance 98
multi-threaded programming 204
N
name 10
name resolution 287
named arguments 130
namespace 254
native compiler directives 253
network 4
traffic 182
new 2
NMAKE 103
no_namespace 254
NoRemove 176
NT LAN Manager Security Support Pro-
vider 237
NTLMSSP 237
NULL 109
O
OAIDL.IDL 129, 133
object
browsing 136
inheritance 61
maps 58
stateless 164
viewer 289
296    Index
objected oriented model 2
OBJIDL.IDL 99
OLE 27
automation 125
OLE/COM object viewer 289
OLE32.DLL 72
oleautomation 99
OLECTL.H 129
OLEVIEW 289
on _com_ptr_t 256
open 120
Open Software Foundation 12
OSF 12, 107
out 109
out-of-band 264
out-of-process server 14
P
parameter
boolean 113
double 112
permissions
access 235
launch 236
ping 286
PLG file 105
pointer 110
pointer_default() 99
polling 183
post build step 104
PostThreadMessage 158
POTS 152
pre-processor 97, 247
principles of COM 67
process 3, 152
ProgID 170, 172
registration 172
programmatic identifier 172
progress 182
property 140
attributes 141
standard 129
propget 141
propput 141
propputref 141
protocol 230
proxy 85
published 70
pure virtual 74
Q
QueryInterface 76, 81
R
raw method 260
ref 110
reference counting 82
REG scripts 175
RegCreateKey 178
REGDB_E_CLASSNOTREG 283
RegDeleteValue 178
REGEDIT 175
registration
server 64
registry 73, 167, 178
editor 167
resources 175
scripts 65
RegServer 177
REGSVR32 103, 178
Release 82
Remote Procedure Calls 229
RemoteServerName 174, 134
retval 110, 141
RGS 175
RPC 229
RPC_C_AUTHN_NONE 241
RPC_S_SERVER_UNAVAILABLE 284
RPC_X_NULL_REF_POINTER 111
RPCDCE.H 241
RPCSS 72
RunAs 174
S
SCM 14, 73, 167, 230
SCODES 267
security 234
custom 239
Index
297
self-registration 168, 174
server 43
adding a method 36
context 88
creation using ATL wizard 30
in-process 14, 29, 178
multi-threaded 203
out-of-process 14
registration 64
running with client 40
service 15
Service Control Manager 167, 230
ServiceParameters 174
short 108
signed 108
single threads 155, 159
singleton classes 79
sink 184
size_is 113, 114, 115, 120
size_is(llen) 116
smart pointer
classes 256
error handling 258
smart pointers 255, 220
source 184
STA 155
stability 89
standard keys 170
standard marshaling 94
standard properties 129
stateful 164
stateless 164
static member 208
STDAFX.H 191
string 113, 114
strlen 113
struct 74
structure 121
stub 85
SUCCEEDED 22, 264
Support Connection Points 186, 216
surrogate 15
synchronization 151, 162
synchronous 190
SysAllocString 118
SysFreeString 118
T
TCP/IP address 232
template 247
classes 250
example 248
this pointer 210
thread 152
apartment 155, 158
free 155, 164
single 155, 159
testing different models 165
worker 205
thread local storage 152
threading models 151, 153
ThreadingModel 172
THREADPROC 153
ThreadProc 208
TLH 260
TLS 152
TRACERT 287
transparency 69
TRG file 103
try/catch 259
type library 87, 95, 102, 126, 290
typedef 121
typelib 170
header 260
U
UDP 230
UnAdvise 189
Unadvise 225
UNC 232
unicode 113
unique 5, 110
universal naming convention 232
Universally Unique Identifier 12
Unlock 227
unregistration 176
UnRegserver 177
unsigned 108
298    Index
UpdateRegistryFromResource 177
User Datagram Protocol 230
user interface thread 153
uuid 12, 99
V
v1_enum 122
VARIANT 128
VARIANTARG 130
VariantInit 132
varying arrays 119, 121
VB run-time error 134
version 99
VersionIndependantProgID 172
very early binding 127
Virtual Function Table 75
Visual Basic 125
VT 132
types 132
VTABLE 24, 75
W
wchar_t 108, 113
wcslen 113
Win32 Debug 41
Windows Service Control Manager 14
WINERROR.H 266
WinMain 177
WM_CLOSE 154
WM_QUIT 154
worker thread 205
implementing 209
simple 208
starting 207
wrapper method 260