1
1
2
3
4
5
output w0 = 0 w1 = 0 w2 = 1 w3 = 0 w4 = 1
w4
1
1
0
1
1
w1
0
0
0
0
1
w0
0
1
0
0
0
4.2 False Positive probability
The probability of an m-bit watermark matching another
watermark extracted from a randomly picked document is
2−m. Since each bit of the watermark is actually embedded
at µ positions, µ
2 +1 of those µ bits should match correspond-
ing bit of our watermark. This makes the actual probability
of having False Positives = 2−(m+ µ
2 +1). This is lower than
probability of false positives in [1].
4.3 Watermarking Capacity
The optimal capacity utilization is when a document con-
j=1 xj sentences and each sentence carries β bits.
sentences.
j=1 xj
µ
Every watermark bit is embedded in µ = τ β
γ
Hence the watermarking capacity of our scheme is
β× y
tains y
γ× y
=
j=1 xj
τ
.
5. EXPERIMENTAL RESULTS
5.1 Implementation details
The experiments were carried out in Unix using C lan-
guage on Pentium 4 2.4 GHz processor. Usage of C as a
programming language makes the implementation extremely
eﬃcient in terms of time. Quartz digital signature scheme
was utilized for producing digital signatures since the size
of these signatures is very small (128-bits). Java implemen-
tation provided by Christophe Wolf was used to generate
signatures.
5.2 Results
We used 5 sample documents of varying sizes (from 16505
words to 46271 words) and paragraph structures to embed
watermarks of 5 sizes constructed using quartz digital sig-
nature scheme (which produces 128-bit digital signatures)
and analyzed the results of the experiments. It should be
noted that the watermark embedded essentially consists of
two signatures - user’s and publisher’s) and optionally other
information like timestamp, metadata, padding and so on.
The number of bits that change are proportional to the wa-
termark size as indicated in Table 5.
The net change in document size is fairly constant for a
speciﬁc document. The change in document size is less than
1% in most of the cases (refer to Table 6). Hence, quantita-
tively speaking, there is minimal distortion to the document.
It was observed that the documents with larger paragraphs
had fewer changes as compared to documents with smaller
paragraphs. This also suggests that the paragraph struc-
ture, and thereby the permutation we select play a key role

in determining the number of words that will be added or
deleted from the document.
6. CONCLUSION AND FUTURE WORK
Our scheme is shown to be resilient against document re-
production, reformatting, synonym substitution, text addi-
tion, text deletion, text swapping and paragraph shuﬄing.
Previous watermarking schemes [6, 5, 7, 8, 11, 12, 13, 14, 18]
are not secure against majority of these these attacks. Com-
pared to [1], our scheme provides higher security (determin-
istic resilience to at least µ
2 − 1 changes against probabilistic
resilience to single change in [1]) against text addition, text
deletion, text swapping and total security against paragraph
shuﬄing. It is also secure against collusion attacks. An ex-
haustive cryptographic attack on the scheme takes O(22k)
time (k being the size of key used). With high probability,
the scheme can successfully identify at least one of the col-
luding users in event of a collusion attack. The capacity of
the scheme is
watermark bits.
γ× y
j=1 xj
τ
We are currently working on the following aspects of our
scheme -
1. Designing indigenous collusion-secure codes: Currently,
we are using collusion secure codes given by Boneh.
We are trying to design alternative collusion-secure
codes which have shorted length but similar security.
2. Increasing the capacity of the scheme by using an er-
ror correcting code instead of the currently used repet-
itive correcting code/ majority-voting: In the existing
scheme, each watermark bit is embedded in multiple
paragraphs making it a repititive code that reduces the
watermark-carrying capacity of a document. Instead,
if error-correcting codes are utilized, capacity would
signiﬁcantly improve.
3. Extending the scheme to multilingual documents in-
corporating the grammatical aspects of various lan-
guages: In the current implementation, only English
documents are watermarked. Watermarking other doc-
uments would required analysis of grammer rules of
that language. This is more of an implementation is-
sue than a design issue as the underlying principle is
the same.
7. ACKNOWLEDGEMENTS
We would like to thank Vijayakrishnan Pasupathinathan,
Robert Dale, Krystian Matusiewicz and Christophe Tartary
for their valuable contributions towards this research.
Table 5: Number of bit changes in document with increase in watermark size
Watermark Size
(in bits)
320
400
480
560
640
Bit Changes
document 1
document 2
document 3
document 4
document 5
1802
1903
2003
2182
2301
1762
1895
2037
2121
2266
1431
1507
1589
1657
1717
1269
1436
1522
1631
1726
1280
1334
1438
1526
1604
Table 6: Number of words added to document with increase in watermark size
Watermark Size
Words Added
(in bits)
document 1
document 2
document 3
document 4
document 5
320
400
480
560
640
-8
-11
-15
-14
-11
8
2
-5
-5
-7
0
-4
-17
-20
-24
1
-16
-1
-10
17
-14
-12
-19
-26
-14
The second author is supported by Australian Research
Council grants DP0345366 and DF0451484.
8. REFERENCES
[1] M. Atallah, V. Raskin, M. Crogan, C. Hempelmann,
F. Kerschbaum, D. Mohamed, and S. Naik. Natural
language watermarking: design, analysis, and a
proof-of-concept implementation. In Proc. of 4th
International Workshop on Information Hiding, IH
2001. LNCS, volume 2137, pages 185–199.
Springer-Verlag, Heidelberg, 2001.
[2] P. Bassia and I. Pitas. Robust audio watermarking in
the time domain. In 9th European Signal Processing
Conference (EUSIPCO’98), pages 25–28, Island of
Rhodes, Greece, 8–11 1998.
[3] D. Boneh and J. Shaw. Collusion-secure ﬁngerprinting
for digital data. Lecture Notes in Computer Science,
963:452 – 465, 1995.
[4] L. Boney, A. H. Tewﬁk, and K. N. Hamdy. Digital
watermarks for audio signals. In International
Conference on Multimedia Computing and Systems,
pages 473–480, 1996.
[5] J. Brassil, S. Low, N. Maxemchuk, and L. O’Gorman.
Marking text features of document images to deter
illicit dissemination. In Proc. of the 12th IAPR
International Conference on Computer Vision and
Image Processing, volume 2, pages 315 – 319,
Jerusalem, Israel, October 1994.
[6] J. Brassil, S. Low, N. F. Maxemchuk, and
L. O’Gorman. Hiding information in documents
images. In Conference on Information Sciences and
Systems (CISS-95), 1995.
[7] N. Chotikakamthorn. Electronic document data hiding
technique using inter-character space. In Proc. of The
1998 IEEE Asia-Paciﬁc Conference on Circuits and
Systems, IEEE APCCAS 1998, pages 419–422,
Chiangmai, Thailand, November 1998.
[8] N. Chotikakamthorn. Document image data hiding
technique using character spacing width sequence
coding. In Proc. of International Conference on Image
Processing, ICIP 1999, volume 2, pages 250–254,
Kobe, Japan, October 1999.
[9] I. Cox, J. Kilian, T. Leighton, and T. Shamoon.
Secure spread spectrum watermarking for multimedia.
Technical Report 128, NEC Research Institute,
August 1995.
[10] F. Hartung and B. Girod. Digital watermarking of raw
and compressed video. In Proc. European EOS/SPIE
Symposium on Advanced Imaging and Network
Technologies, Berlin, Germany, October 1996.
[11] H. Ji, J. Sook, and H. Young. A new digital
watermarking for text document images using
diagonal proﬁle. In Proc. of Second IEEE Paciﬁc Rim
Conference on Multimedia, PCM 2001. LNCS, volume
2195, pages 748 –, Beijing, China, October 2001.
Springer-Verlag, Heidelberg.
[12] M. S. Kankanhalli and K. F. Hau. Watermarking of
electronic text documents. Electronic Commerce
Research, 2(1-2):169–187, 2002.
[13] S. Low, N. Maxemchuk, J. Brassil, and L. O’Gorman.
Document marking and identiﬁcation using both line
and word shifting. In Fourteenth Annual Joint
Conference of the IEEE Computer and
Communications Societies. Bringing Information to
People, INFOCOM 1995, volume 2, pages 853–860,
Boston, USA, April 1995.
[14] N. Maxemchuk and S. Low. Marking text documents.
In Proc. of International Conference on Image
Processing, page 13, Washington, USA, 26-29 October
1997.
[15] M. Monsignori, P. Nesi, and M. Spinu. Watermarking
music sheets. In Proc. of Second IEEE Paciﬁc Rim
Conference on Multimedia, PCM 2001. LNCS, volume
2195, pages 646–653, Bejing, China, 2001.
[16] T.-S. K. K.-R. K. Seung-Jin Kim, Suk-Hwan Lee and
K.-I. Lee. A video watermarking using the 3-d wavelet
transform and two perceptual watermarks. In Proc. of
Fourth International Workshop on Digital
Watermarking, IWDW 2002. LNCS, volume 3304,
pages 294 – 303, Seoul, Korea, October 2004.

Springer-Verlag, Heidelberg.
[17] R. Sion, M. Atallah, and S. Prabhakar. On
watermarking numeric sets. In Proc. of First
International Workshop on Digital Watermarking,
IWDW 2002. LNCS, volume 2163, pages 130–146,
Seoul, Korea, November 2002. Springer-Verlag,
Heidelberg.
[18] I.-S. O. Young-Won Kim, Kyung-Ae Moon. A text
watermarking algorithm based on word classiﬁcation
and inter-word space statistics. In Conference on
Document Analysis and Recognition (ICDAR03), 1995.
[19] W.-T. H. Yuei-Lin Chiang, Lu-Ping Chang and W.-C.
Chen. Natural language watermarking using semantic
substitution for chinese text. In Proc. of Second
International Workshop on Digital Watermarking,
IWDW 2002. LNCS, volume 2939, pages 129–140,
Seoul, Korea, October 2003. Springer-Verlag,
Heidelberg.
