title:Measuring Home Networks with HomeNet Profiler
author:Lucas DiCioccio and
Renata Teixeira and
Catherine Rosenberg
Measuring Home Networks with HomeNet Proﬁler
Lucas DiCioccio1,2, Renata Teixeira2, and Catherine Rosenberg3
1 Technicolor
2 CNRS and UPMC Sorbonne Universit´es
3 University of Waterloo
Abstract. This paper designs HomeNet Proﬁler, a software that runs on any
computer connected inside a home network, to collect a wide range of measure-
ments about home networks including the set of devices, the set of services (with
UPnP and Zeroconf), and the characteristics of the WiFi environment. To attract a
larger number of users, HomeNet Proﬁler runs one-shot measurements upon user
demand. We evaluate this design choice against periodic measurements taken
from six home networks. Data collected from these six homes and with Home-
Net Proﬁler in more than 1,600 homes in France shed light on the diversity of de-
vices that connect to home networks and of the WiFi neighborhood across home
networks.
1 Introduction
The availability of cheap broadband Internet is popularizing Internet access from homes.
A household today can have a variety of networked devices ranging from personal de-
vices like laptops and smartphones to printers and media centers. These devices connect
among themselves and to the Internet via a local-area network—the home network. Al-
though there is increasing interest in home networking [1–3, 12, 19], there is yet little
data on current home networks. Most prior work has focused on measuring and charac-
terizing residential Internet access [4, 5, 9, 11, 13, 14, 17, 18]. The lack of data on home
networks is partially due to the challenges of measuring home networks at large scales.
The vast majority of home networks are behind network-address translators, so a de-
vice outside the home often cannot measure the characteristics of the home network
itself. Some prior studies have deployed measurement points inside the homes of a few
volunteers [10, 12, 15], but it is hard to get representative results from a few homes.
This paper designs HomeNet Proﬁler, a tool to measure home network conﬁguration
and performance (§2). Users run HomeNet Proﬁler on-demand from an end-system di-
rectly connected to their home network. HomeNet Proﬁler scans the local network for
active devices and services advertised via protocols such as Universal Plug and Play
(UPnP). It also measures the wireless environment per home. HomeNet Proﬁler incor-
porates features to help recruit a large number of volunteers. For example, it performs
on-demand, one-time measurements, because many users feel uncomfortable down-
loading software that will run continuously in their machines. We evaluate this design
choice with a periodic measurement from six homes in France (§3).
Between April 2011 and May 2012, users from 46 different countries ran HomeNet
Proﬁler. This paper presents our analysis of home networks in France, where we have
M. Roughan and R. Chang (Eds.) PAM 2013, LNCS 7799, pp. 176–186, 2013.
c(cid:2) Springer-Verlag Berlin Heidelberg 2013
Measuring Home Networks with HomeNet Proﬁler
177
data from over 1,600 homes. We analyze devices present in home networks (§4) and
the WiFi environment (§5). Our results show that in 80% of homes, users connect less
than a dozen devices to their home network. In addition, only a small number of these
devices, mainly home gateways, are active at any given time. We also observe that the
density of the WiFi neighborhood varies considerably across homes.
The main contribution of this paper is the design and evaluation of HomeNet Proﬁler.
Our initial experience shows that HomeNet Proﬁler was able to reach a large number
of users (2,432 homes worldwide). Our periodic measurements from six homes in Paris
put HomeNet Proﬁler results into perspective by analyzing the dynamics of both the set
of devices and the WiFi neighborhood, which we cannot study with HomeNet Proﬁler’s
one-shot experiments. As more users run HomeNet Proﬁler, we plan to conduct a larger
characterization study to shed light on home networks performance and conﬁguration
worldwide.
2 Design
This section discusses the requirements of HomeNet Proﬁler as well as our design and
implementation decisions.
2.1 Requirements
The primary requirement for a home network data collection tool is that it runs from
inside the home. Measurements from outside the home cannot have visibility into the
home network conﬁguration and its devices. The goal of measuring a large diversity of
home networks and the fact that it is not possible to collect data inside a user’s home
without explicit user participation impose the following additional requirements:
– Ease of Use. The tool should be simple to run, even for non-expert users.
– Portability. The tool should run on all home networks and end-systems.
– Respect Users’ Privacy. Users are unlikely to run a measurement tool inside their
homes if the tool collects information that they consider private or any personally
identiﬁable information. Our data collection effort has to comply with the rules of
the French National Commission of Informatics and Freedom.1
– Light User Commitment. We ask home users to do us a favor by allowing us
to collect data in their homes. We cannot ask users to commit too much time or
resources without running the risk of reducing the number of users willing to par-
ticipate.
– Incentive for Participation. Some users will run research tools altruistically. How-
ever, if users can get something out of the experiment, then we are more likely to
get a larger number of participants.
2.2 Design and Implementation Decisions
The design requirements outlined in the previous section lead to some high-level design
and implementation decisions.
1 Commission nationale de l’informatique et des libert´es (CNIL):
http://www.cnil.fr/english/.
178
L. DiCioccio, R. Teixeira, and C. Rosenberg
First, HomeNet Proﬁler runs on end-systems. We considered deploying measure-
ments on the home router/gateway or on one of the end-systems connected to the home
network. Although some home users deploy routers with measurement capabilities [18],
a hardware deployment has higher cost and more complicated logistics.
Second, inspired by the success of Netalyzr [13], HomeNet Proﬁler runs one-shot
measurements on user demand. On one hand, long term, periodic measurements would
give us a complete picture of home networks. On the other hand, users may be uncom-
fortable with installing a permanent software on their machine for privacy concerns and
because of the possible impact on machine performance. We evaluate one-shot mea-
surements against periodic measurements in § 4.1 and § 5.1.
Third, HomeNet Proﬁler is a Java executable JAR. We considered implementing
HomeNet Proﬁler as a signed Java applet similar to prior work [13, 16], but it is hard
to load system libraries such as the Windows Native WiFi interface from an applet and
we need sudo rights on some Linux distributions, which is not possible from an applet.
Instead, a Java executable JAR can collect the datasets we want and yet it is portable
and simple for users to run.
Finally, HomeNet Proﬁler takes the user perspective. We include a user survey to
obtain information that would be hard to infer automatically from the measurements
(such as ﬁnding devices which are turned off). To see the survey questions, we invite
the reader to run HomeNet Proﬁler. As an incentive for users to run HomeNet Proﬁler,
we output a detailed report of their home network.2 Before the measurements begin,
HomeNet Proﬁler lets the user select which measurements to execute. Hence, users
who are uncomfortable with some measurements can still run HomeNet Proﬁler with a
subset of the measurements.
System Overview. We design HomeNet Proﬁler as a client-server application. The
server hosts the HomeNet Proﬁler website, which users visit to fetch and run the Home-
Net Proﬁler client. HomeNet Proﬁler starts in a separate window. Users then complete
the survey while the measurement modules run in the background. Upon completion,
the client sends all collected data to the server and redirects the web browser to the
report page. When HomeNet Proﬁler exits, it leaves a random identiﬁer on the user’s
machine to track multiple runs from the same end-system. A run refers to one execution
of HomeNet Proﬁler.
2.3 Measurement Modules
We select a broad range of measurements to learn as much as possible about the home
network. At the same time, measurements should not take too long to execute, otherwise
users might give up in the middle of the experiment. Our main goal is to discover the
devices connected to the home network and the services they provide as well as the
network technologies connecting the home to the Internet and inside the home. We
also characterize the WiFi neighborhood by measuring the quality of all visible WiFi
networks. In addition to these direct measurements, we collect the conﬁguration of the
machine running HomeNet Proﬁler as well as the list of applications running on the
2 For an example report refer to: http://cmon.lip6.fr/hnp/example
Measuring Home Networks with HomeNet Proﬁler
179
machine. This extra information helps us interpret the results in case some conﬁguration
affects some of our measurements (e.g., a ﬁrewall or a VPN).
The HomeNet Proﬁler client has the following measurement modules.3
Device Scan: Searches the home network for active network devices. This module
ﬁrst populates the ARP cache by sending UDP packets on Port 9 (i.e., the discard port)
to all IP addresses in the sub-network of the end-system. We force a 10 seconds timeout
on the scan to avoid long delays when sub-networks are too large. Our data conﬁrms
that the vast majority of scans ﬁnishes before the timeout. This module then reads the
ARP cache to collect the vendor ID (OUI) and the SHA1 hash of the MAC of each
network interface on the LAN. If the associated IP address is private we also collect it,
otherwise we just record the presence of a public IP.
WiFi Scan: Collects a list of access points found with one WiFi scan. For each access
point we collect the ESSID (the network name), the BSSID (the MAC address of the
access point), the channel number, and the Received Signal Strength Indicator (RSSI).
We anonymize ESSIDs and BSSIDs. We distinguish between the home WiFi, which is
the one the end-system is connected to, and neighbor WiFis. On MacOS, the airport
command-line tool provides all this information. On Linux, we use iwconﬁg and iwlist.
On Windows, we use the Win32 Native WiFi API, which is not available on windows
XP prior to SP3. We also observe that some Linux WiFi drivers only report information
for the network the end-system is associated to.
Service Scan: Queries two protocols commonly-used to advertise services in home
electronics: Zeroconf and UPnP. We opt for querying these protocols instead of a port
scan per device because a port scan is intrusive and may take too much time.
Netalyzr [13]: Performs a number of tests related to the access network conﬁgura-
tion, security, and performance. At each execution, HomeNet Proﬁler downloads and
runs the latest version of Netalyzr’s command-line client.
Conﬁguration of the UPnP Gateway: In cases where the home gateway supports
UPnP, HomeNet Proﬁler collects the model of the gateway, the connection type, and
the connection speed. It also tests trafﬁc counters using UPnP queries.
Aside from these measurements taken from the client, when HomeNet Proﬁler’s
server receives the collected measurements, it maps the client’s public IP address to
its geographical location and AS number using the Maxmind database. We then discard
the public IP address. HomeNet Proﬁler also sends meta-data such as the time taken by
each module and whether HomeNet Proﬁler was running with sudo privileges.
This paper reports preliminary results on devices (§ 4) and WiFi (§ 5). We report on
the Netalyzr and UPnP gateway conﬁguration measurements in prior work [6].
3 Measurements
Testbed. In most cases, users run HomeNet Proﬁler once, but both the WiFi neighbor-
hood and the devices connected to a home network vary over time. We thus complement
HomeNet Proﬁler by instrumenting six different home networks in Paris. We installed
laptops in homes of colleagues from Technicolor and UPMC Sorbonne Universit´es.
3 To address privacy concerns and comply with French laws, we anonymize all personally-
identiﬁable information using SHA1 hash.
180
L. DiCioccio, R. Teixeira, and C. Rosenberg
The households have between one and three members. Each laptop runs the WiFi scan
module every ten seconds using an Intel WiFi card. Every ten minutes, laptops also run
the device scan module on an Ethernet adapter. We collect data from March 19, 2012 to
July 31, 2012. These six homes are not representative of the population at large, but in-
strumenting a larger number of homes is a practical challenge. Nevertheless, this testbed
allows us to evaluate HomeNet Proﬁler and put the collected data into perspective.
HomeNet Proﬁler Data. We announced HomeNet Proﬁler by email to family, friends,
colleagues, and mailing lists of networking researchers as well as through grenouille.com,
a French website for people who want to monitor their ISP performance. Between April
2011 and May 2012, a total of 2,721 distinct end-systems ran HomeNet Proﬁler 3,634
times. Some users run HomeNet Proﬁler multiple times on the same end-system or
from multiple end-systems in the same home. Users may also run HomeNet Proﬁler
when they are not at home. For our analysis, we select a single representative run per
home using two heuristics described in our technical report [7]. After applying these
heuristics, we infer that our data comes from a total of 2,432 distinct homes. Users ran
HomeNet Proﬁler from home networks in 46 countries and 210 different ASes (more
details in our previous work [8]). This paper focuses on the 1,682 homes in France.
Two thirds of French users answering the survey say that they ‘know Internet tech-
nology well’. Hence, our dataset is biased towards experts users. This bias may be an
advantage because expert users may have home networks more representative of future
trends than other users.
4 Set of Devices in Home Networks
This section studies the set of devices that connects to home networks. We ﬁrst use our
testbed to analyze the dynamics of devices over time. Then, we analyze differences in
number of devices across homes in the HomeNet Proﬁler data.
4.1 Completeness of Device Scans
Some devices may be disconnected from the home network at the time when users run
HomeNet Proﬁler. We evaluate whether HomeNet Proﬁler would beneﬁt from addi-
tional device scans.
Repeated device scans in our testbed observe different sets of devices. Fig. 1 shows
the presence of a given device during the four months of data collection. The x-axis is
the time of each device scan. The y-axis represents individual devices measured in each
home network (identiﬁed by their MAC address). We label the y-axis with the home-id
and below each home-id, the number of devices observed in that home network during
our measurements. We order devices per home based on their occurrence. The most
prevalent device of all six homes is the home gateway. Note that there are gaps in the
data collection because of maintenance or other measurement campaigns running on
the same testbed. These gaps are easily identiﬁed by the vertical bars with no points per
home. We ignore these gaps in the following discussion.
The number of devices measured per home in four months varies between 6 and 19
depending on the home. We ask each home user to manually label each device ob-
served over the whole data collection period. We divide devices into types: home de-
vices, which are those that belong to members of the household; and visitor devices,
Measuring Home Networks with HomeNet Proﬁler
181
s
e
m
o
h
f
o
n
o
i
t
c
a
r
F
0
1
.
8
0
.
6
.
0
4
0
.
2
0
.
0
.
0
Devices
Total − 514
Active − 1594
Difference − 487
0
5
10
15
20
Number of devices
Fig. 2. Number of active devices versus the
total number of devices per home. The
number in the legend represents the number
of homes included in the respective curve.
Fig. 1. Observed devices per home network
which belong to friends who are just using the home network for a short stay. The top-
most devices of each home, those we only observed in a small fraction of the scans,
correspond to visitor devices. We observe two types of home devices: always-on de-
vices and on-off devices. Always-on devices are the ones users leave on all the time
after the device ﬁrst connects to the home network and until the device is decommis-
sioned. These typically include home gateways and access points/routers. In Home-6
we also observe an IP printer and an IP security camera that were always on, and in
Home-1 a network disk appears just before Week 5. On-off devices have prevalence
between always-on home devices and visitor devices. We observe two types of on-off
devices: personal mobile devices (such as laptops and smartphones) that leave the house
with their owners; and devices that people turn on when needed (e.g., a weighing scale
and a gaming console).
We compute the fraction of the home devices observed in a single scan over the total
number of home devices. Given that HomeNet Proﬁler requires at least one user in the
home to run the tool, we only count device scans when at least one laptop or desktop is
on. Overall, we ﬁnd that a single device scan only observes a small fraction of the home
devices. For example, 92% of the scans with at least one laptop/desktop observe at most
half of the home devices. Nevertheless, one single device scan captures all always-on