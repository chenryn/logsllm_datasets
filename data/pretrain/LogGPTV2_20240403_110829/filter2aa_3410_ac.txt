Since the attacker’s automation script is running, the authenticated session can be
maintained from a few hours up to a few days depending the design of the web 
application and frequency of server maintenance or reboot
•
If the victim’s banking account is preset with daily transaction limit, then the attacker might 
perform several transactions repeatly in different days to steal all the money
Account Balance
: $100, 000
Daily Transfer Limit
: $  20, 000
Account Balance
: $100, 000
Daily Transfer Limit
: $  20, 000
Day 1 : - $20, 000
(Victim pays electricity bill)
- 1 security token
Day 1 : - $20, 000
(Victim pays electricity bill)
- 1 security token
Day 1 : $0
(Victim logins to the account) 
- 1 security token
Day 1 : $0
(Victim logins to the account) 
- 1 security token
Day 2 : - $20, 000
(Victim logins to the account) 
- 1 security token
Day 2 : - $20, 000
(Victim logins to the account) 
- 1 security token
Day 2 : - $20, 000
(Victim performs fund transfer for business)  - 1 security token
Day 2 : - $20, 000
(Victim performs fund transfer for business)  - 1 security token
Day 2 : - $20, 000
(Victim pays mobile phone bill)
- 1 security token
Day 2 : - $20, 000
(Victim pays mobile phone bill)
- 1 security token
Day 3 : - $20, 000
(Victim login just to check balance)
- 1 security token
Day 3 : - $20, 000
(Victim login just to check balance)
- 1 security token
Account Balance
: $ 0
Daily Transfer Limit
: $ 20, 000
Account Balance
: $ 0
Daily Transfer Limit
: $ 20, 000
Sunday, June 29, 2008 Page 25
Targeted phishing attacks (spear phishing)
Source: http://arstechnica.com/news.ars/post/20080606-spear-phishers-land-15000-sucker-fish.html
USER EDUCATION IS IMPORTANT!
USER EDUCATION IS IMPORTANT!
•
Highly targeted (corporate, gov., etc.)
•
Usually make use of email
•
Not just for financial gain!
•
Hard to protect users again such threat
Sunday, June 29, 2008 Page 26
Existing phishing identification techniques
•
Domain name age checking
•
Suspicious IFRAME with tiny width and height
•
Suspicious URL or encodings used in URL
•
Similar HTML / Javascript source with legitimate website
•
SSL certificate validation
Sunday, June 29, 2008 Page 27
Approach used by website blocker / filter
Blacklisting - Identify the bad sites with blacklisted URL database
•
Receive phishing reports from public
•
Automated crawler to find suspicious domain names and websites
•
Exchange phishing URLs with security vendor partners
•
Block blacklisted URLs with tools installed on client machine
Sunday, June 29, 2008 Page 28
Disadvantages of blacklisting approach
•
Unable to identify unreported phishing websites in the wild
•
Client side has to keep updated with latest blacklisted URL DB
•
Efficiency issue as the amount of blacklisted URL grows
Sunday, June 29, 2008 Page 29
How can we improve it better?
1.Identify the visual similarity of rendered 
website with legitimate website
2.Check target web server characteristics for 
identification (WEBSITE FINGERPRINTING!)
3.Check target URL’s domain name age
4.Check target URL’s similarity with legitimate 
URL and suspicious encoding
5.Check target website’s content for suspicious 
characteristics
6.Compare the data obtained from Step 2-5 
with the pre-analyzed information of original 
banking/financial website
Whitelisting approach
Sunday, June 29, 2008 Page 30
Identifying visual similarity of a website
Simple approach to create signature for web appearance
1.Take screenshot image of a rendered website
2.Calculate the mean values for red, green and blue of the image
3.Use the RGB mean values as ‘website appearance signature’
paypal.png - Screenshot of the real PayPal website
messed.png – Messed up image modified from paypal.png
Red: 226.26349166666665
Green: 232.64016333333333
Blue: 236.67534166666667
Red: 226.26936333333333
Green: 232.64310833333334
Blue: 236.67663166666668
[MEAN VALUES]
[MEAN VALUES]
Sunday, June 29, 2008 Page 31
Identifying visual similarity of a website
fake.png – Screenshot of fake PayPal website
[with contrast and brightness level purposely tweaked]
2checkout.png – Screenshot of the real 2Checkout.com website
Red: 225.603835
Green: 231.98625166666667
Blue: 236.01825500000001
Red: 207.40960000000001
Green: 220.19798166666666
Blue: 213.34901500000001
[MEAN VALUES]
[MEAN VALUES]
Sunday, June 29, 2008 Page 32
r1 – Red color mean value of image-1,
r2 – Red color mean value of image-2
g1 – Green color mean value of image-1,
g2 – Green color mean value of image-2
b1 – Blue color mean value of image-1,
b2 – Blue color mean value of image-2
rDiff = | ( ( r1 – r2 ) / 256 ) |
gDiff = | ( ( r1 – r2 ) / 256 ) |
bDiff = | ( ( r1 – r2 ) / 256 ) |
Therefore,
100 – ((rDiff  + gDiff  + bDiff) * 100) = % of similarity
Example calculation:
Difference of paypal.png and messed.png
rDiff = |((226.26349166666665 - 226.26936333333333) / 256)| = 0.00002293619791671875
gDiff = |((232.64016333333333 - 232.64310833333334) / 256)| = 0.0000115039062500390625
bDiff = |((236.67534166666667 - 236.67663166666668) / 256)| = 0.0000050390625000390625
100 – (0.000039479166666796875 * 100) = 99.9960520833333203125 % similar
Difference of paypal.png and fake.png
rDiff = |((226.26349166666665 - 225.603835) / 256)| = 0.0025767838541666015625
gDiff = |((232.64016333333333 - 231.98625166666667) / 256)| = 0.002554342447916640625
bDiff = |((236.67534166666667 - 236.01825500000001) / 256)| = 0.002566744791666640625
100 – (0.0076978710937498828125 * 100) = 99.23021289062501171875 % similar
Difference of paypal.png and 2checkout.png
rDiff = |((226.26349166666665 - 207.40960000000001) / 256)| = 0.0736480143229165625
gDiff = |((232.64016333333333 - 220.19798166666666) / 256)| = 0.0486022721354166796875
bDiff = |((236.67534166666667 - 213.34901500000001) / 256)| = 0.091118463541666640625
100 – (0.2133687499999998828125 * 100) = 78.66312500000001171875 % similar
Identifying visual similarity of a website
Sunday, June 29, 2008 Page 33
Example of a basic anti-phishing system
Sunday, June 29, 2008 Page 34
Advantages of ‘web appearance signature’
•
Easier to obtain signatures of legitimate sites
•
Able to detect unknown phishing websites
Proof-of-Concept Demonstration
Sunday, June 29, 2008 Page 36