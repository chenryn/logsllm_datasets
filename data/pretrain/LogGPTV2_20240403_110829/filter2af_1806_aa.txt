**作者：Maddie Stone@Google Project Zero  
译者：知道创宇404实验室翻译组  
原文链接：**
这是我们回顾在野利用 0day 漏洞的第三个年度 [[2020
年](https://googleprojectzero.blogspot.com/2021/02/deja-vu-lnerability.html)，[2019
年](https://googleprojectzero.blogspot.com/2020/07/detection-deficit-year-in-review-of-0.html)]。每年我们都会回顾所有检测到和披露的在野
0day，并综合分析其趋势和要点。本报告旨在整体分析年度漏洞利用，寻找趋势、差距，总结经验教训等等。如果你对单个漏洞利用感兴趣，可以查看我们的[分析](https://googleprojectzero.blogspot.com/p/rca.html)。
我们发布这篇分析报告是希望 0day 漏洞利用变得更有难度，希望攻击者使用 0day 所花费的成本和资源更高。2021
年的趋势也更强调了这一点如此重要。我们一遍又一遍地听到各国政府如何将记者、少数群体、政客、人权捍卫者，甚至是世界各地的安全研究人员作为目标。我们切身体会到，在安全和技术社区做出的决定会对社会和人类的生活产生真正的影响。
本文正文中将会提供我们分析结论的证据和过程，总结下一步的想法和对 2022 年的希望。
### 摘要
2021 年共检测和披露的在野 0day 漏洞有 58 个，这是自从 2014 年年中 Project Zero
团队开始跟踪以来记录到最多的一年，是之前的最高值——2015 年检测到 28 个的两倍多，2020 年我们仅检测到 25 个。自 2014
年年中以来，我们一直在[此表格](https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=0)中跟踪公开的在野利用
0day 漏洞。
虽然我们经常谈论在野 **利用** 的 0day 漏洞数量 **，** 但我们实际上讨论的是在野 **检测到和披露** 的 0day
漏洞利用数量。这也是我们的第一个结论：2021 年在野 0day 漏洞的大幅上升是由于检测和披露的增加，而不是简单的 0day 漏洞利用的增加。
通过对这些在野 0day 的分析，我们发现攻击者的方法实际上与前几年相比并没有太大变化，他们成功地使用了相同的模式和技术，并针对相同的攻击面。Project
Zero 团队的使命是“让利用 0day 变得更难”。总的来说，当攻击者无法使用公开的方法和技术来开发利用时，0day 的利用才将更加困难。而 2021
年这 58 个 0day，与以前公开已知的漏洞都很相似，只有两个 0day
脱颖而出：一个是因为其漏洞利用的技术复杂性，另一个是因为它使用逻辑错误来逃离沙箱。
因此，虽然我们认识到业界在检测和披露在野 0day 漏洞数量方面取得了进步，但我们也承认还有很多改进工作要做。 攻击者利用 0day
的事实表明了，他们能够使用先前已知的技术和方法取得成功，而不必投入开发新的技术，这对科技行业来说也是一个机会。
我们在 2021 年拥有比过去更多的数据点来了解攻击者的行为，然而，这些数据也给我们留下了更多的问题。攻击者不会分享他们正在使用的
0day，以及我们在调查中遗漏了多少 0day，因此我们永远无法确切知道这些公开披露的 0day 所占比例是多少。
根据我们对 2021 年 0day 的分析，我们希望在 2022 年看到以下进展，以继续采取措施使 0day利用变得更有难度：
  1. 所有厂商都同意在其安全公告中披露漏洞的在野利用状态；
  2. 漏洞利用示例或漏洞利用的详细技术描述可以更广泛的共享；
  3. 继续共同努力减少内存损坏漏洞，或者使其无法被利用。启动一些缓解措施来影响内存损坏漏洞的利用。
### 在野 0day 漏洞破纪录的一年
2021 年是在野 0day 漏洞数量创纪录的一年。到底发生了什么呢？
[](https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=2129022708
"!\[\]\(https://images.seebug.org/content/images/2022/04/c5a619c1-7630-4b4f-9f5c-f4d5fb357d81.png-w331s\)")
是软件安全性越来越差？还是攻击者更多地使用了 0day 漏洞？还是我们发现和披露 0day 的能力有所提高？从 2020 年到 2021
年的显著增长，我们认为这主要是由于后者。虽然我们认为过去几年攻击者对 0day
利用的兴趣和投入一直在稳步增长，而且软件安全性也仍需迫切提高，但似乎最主要的原因还是安全行业检测和披露 0day 漏洞的能力提升了。
虽然我们经常谈论“在野 **利用** 的 0day 漏洞”，但我们实际调查的是“ **检测到并披露** 的在野利用 0day 漏洞”。除了 **利用**
之外，还有更多因素导致该数量的增加，最值得注意的是：检测和披露。更好地检测 0day 漏洞和更透明地披露被利用的 0day
漏洞是行业安全和进步的一项积极指标。
总而言之，我们可以将在野 0day 数量的提升分解为：
  * 更多的在野 0day 漏洞检测；
  * 更多的公开披露在野 0-day 漏洞利用。
#### 更多检测
在 [2019 年的回顾中](https://googleprojectzero.blogspot.com/2020/07/detection-deficit-year-in-review-of-0.html)，我们写了关于“检测赤字”——“ **作为一个社区，我们严重缺乏检测在野利用 0day
的能力，以至于收集数据的缺乏和偏差，使我们无法得出有意义的结论** 。” 在过去的两年里，我们相信这方面已经取得了进展。
我们听说有更多人已经开始致力于检测 0day 漏洞。从数量上看，虽然是一个非常粗略的衡量标准，但我们也看到报告的在野 0day
数量正在增加。所以有理由认为，如果努力寻找 0day 漏洞利用的人数增加，那么检测到的在野 0day 漏洞数量可能会增加。
[](https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=2129022708
"!\[\]\(https://images.seebug.org/content/images/2022/04/51962db4-e509-4f4c-b27f-9af20a71da65.png-w331s\)")
[](https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=2129022708
"!\[\]\(https://images.seebug.org/content/images/2022/04/52a0dfd7-eaf9-4780-8bf3-97a66463d42f.png-w331s\)")
我们还看到在自己产品中检测到在野 0day 漏洞的厂商数量也在增加，无论这些厂商之前是否检测，在 2021
年他们似乎找到了更成功的方法。厂商对他们自身产品有拥有更多的遥测技术和全面的知识，因此他们投资检测针对自己产品的
0day。如上图所示，厂商在自家产品中发现的在野 0day 数量显著增加。谷歌在他们自己的产品中发现了 7 个 0day，而微软在他们的产品中发现了 10
个！
#### 更多披露
在野 0day 漏洞数量增加的第二个原因就是由于有了更多地披露。 Apple 和 Google Android（这里把“Google”和“Google
Android”区分开，是因为 Google Chrome 在过去几年一直安全公告中有添加注释） 首先分别在 2020 年 11 月和 2021 年 1
月开始在其安全公告中使用有关潜在野外利用的信息来标记漏洞。当厂商不在发布公告中添加注释时，我们了解 0day
被疯狂利用的唯一方法是发现该利用的研究人员站出来说明。如果 Apple 和 Google Android
之前没有注释他们的漏洞发布公告，公众可能不会知道至少有 7 个 Apple 的在野 0day 漏洞和 5 个 Android 的在野 0day
漏洞。为什么？因为这些漏洞是由“匿名人士”报道的，如果他们不想因为发现漏洞而受到赞扬，他们就不太可能公开说这些漏洞有被利用的迹象。 如果 Apple 和
Google Android 没有透明化地注释它们的安全公告，那么就有 12 个 0day 就不会被列入今年的漏洞列表。
[](https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit#gid=2129022708
"!\[\]\(https://images.seebug.org/content/images/2022/04/bcb7fefe-f07d-4f91-b4e4-6dca0da5949f.png-w331s\)")
向 Microsoft、Google Chrome 和 Adobe 致敬并感谢他们多年来一直在为其安全公告添加注释以提高漏洞状态透明化。还要感谢
Apache 在
过去一年中还为[CVE-2021-41773](https://httpd.apache.org/security/vulnerabilities_24.html)
的公告添加了注释。
高通和 ARM 产品中的在野 0day 在 Android 安全公告中被注释为在野，但在厂商自己的安全公告中却没有。
很有可能在 2021 年，还有其他 0day 在野利用并被检测到，但厂商在其公告中并未提及这一点。在 2022
年，我们希望更多厂商在修补已被广泛利用的漏洞时注意这一点。在我们确信所有厂商都在透明地披露在野利用状态之前，还有一个大的问题：到底有多少个在野 0day
被发现了，但没有被厂商公开标注。
### 新的一年，不变的技术
在 2021 年我们拥有破纪录数量的数据点，以了解攻击者如何实际利用 0day
漏洞。不过，让人有点惊讶的是，在所有这些数据点中，这些数据中并没有什么新东西。0day
漏洞被认为是攻击者可以使用的最先进的攻击方法之一，因此我们很容易从中总结出攻击者使用的特殊技巧和攻击面。但相反，我们在 2021 年发现的 0day
基本上遵循之前在公开研究中出现的相同模式、攻击面和利用方法。一旦“利用 0day
很困难”，攻击者要想成功就必须使用前所未有的利用方法，以及在新的攻击面中找到新的漏洞。总体来说，这一年的数据并没有展现出这一点。在 58 个 0day
中，除了两个例外（在下面的 iOS 部分中描述），我们看到的一切都非常标准。
在这一年中的 58 个在野 0day 中，有 39 个也就是 67%