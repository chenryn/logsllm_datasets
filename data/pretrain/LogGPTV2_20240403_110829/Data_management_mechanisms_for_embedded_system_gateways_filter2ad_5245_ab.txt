Themotivatingexamplewhichwewillexamineinthispaperisanenterprise-to-embeddedscenario.Anincomingstreamofvehiclespeeddataarrivesatthegatewayviaanenterprisenetwork(e.g.wirelessorcellularnetwork).Themessagesaresentoutbythegatewayduringaperiodictimeslotonanembeddedcontrolnetwork(e.g.TTP,FlexRayorCANwithratemonotonicscheduling).Inoursimulation,wemodelmessagearrivalswithaPoissonrandomprocessandmessagedepartureswithadeterministicperiodicpro-cess.Ourexamplehassingledataﬂowandasingledatamanagementmechanismtohandleit.Inadditiontotheexampleusedinthispaper,webelievethesetechniquescanbeappliedtoanysystemthata)usesreal-timecontrolormonitorsstatevari-ablesandb)hascomponentsthataresuﬃcientlyre-mote,plentifulormobilethattheuseofexistingnet-workinfrastructuresisdesirableornecessarytomakethesystemeconomicallyfeasible.MostSupervisoryControlandDataAcquisition(SCADA)systems,suchaspipelineandpowergridcontrolsystems,wouldﬁtthisdescription.AlthoughcurrentSCADAapplica-tionsuseremoteconnectionsprimarilyformonitoringactivities,theexpansionofthesesystemstoincludereal-timecontrolseemslikelyinthefuture.Webelievethedatasetsweusedinourexperimentsarerepresentativeofsometypesofdatafromtheseap-plications.Whileapplicationsthatinvolvedatawithafundamentallydiﬀerentcharactermightproducedif-ferentresults,theimportantinsightsfromourexper-imentsaretheidentiﬁcationofqueueunderﬂowasamajorcauseofqueuedelayandtheproposedsolution(ﬁlters)formitigatingthisproblem.Forothertypesofdata,itislikelythatthereareothermechanismswhichcanbeusedinthegatewaytomeetapplicationrequire-ments.Bycontinuingtoexaminelikelyscenariosandusecasesforembeddedsystemgatewaysinthefuture,wecanidentifyanddevelopadditionalmechanismstomeetawidevarietyofsystemrequirements.3RelatedworkTherearenumerousnetworkdeviceswhicharere-ferredtoasgateways,especiallyintheInternetdo-main,butwehavefoundfewexamplesthatdealwithconnectionstoembeddednetworks.OnedesignforagatewaybetweenInternetandCANispresentedin[4],althoughthatworkfocusesonthehardwaredesignandimplementation.Thetiminganalysisfocusesontheca-pabilityofthegatewaytoprocessallthemessagesandassumesthattheCANnetworkisstrictlyanevent-triggerednetwork.Itdoesnotaddressthesituationofhowtohandlearrivingmessagesiftheycannotimme-diatelybesentoutontheCANnetwork,asmightbethecaseiftransmissionisblockedbyhigherprioritymessages.Queuingistheprimarymechanismusedtoman-agepacketsinInternetrouters,andmuchworkhasbeendonewithactivequeuemanagementtechniquesforoptimizingthroughputandimplementingconges-tioncontrolalgorithms.RandomEarlyDetect(RED)[3]orBLUE[1]aretwoexamplesthataredesignedtomaximizethroughputandreducecongestion.Thesetechniquesareusuallyappliedtounboundedqueues.[12]modiﬁesREDinanattempttomaintainatargetqueuelength,buttheproposedmethodprovidesonlyaprobabilisticbound.AlthoughthesetechniquesarequitesuccessfulintheInternetdomain,theyareintendedtooptimizeband-widthutilizationandthroughput.Incontrast,anem-beddedsystemgatewayshouldbedesignedtoprovideforthetimelinessofthedatathatispassedthroughthegateway.Thisimpliessomefundamentaldiﬀerencesintheoperationofanembeddedsystemgateway.ActivequeuemanagementtechniquesinInternetroutersusedroppedpacketsasinimplicitcommunicationchanneltocontrolthesenderrate.Whenapacketisdropped,theTCPretransmissionmechanismscausethepackettoberesent,sothedroppedpacketwilleventuallybedelivered.Incontrast,ourgatewayacknowledgesev-erymessageandthendeliversthemessagetothedatamanagementmechanism.Ifthemechanismindicatesthatamessageshouldbedropped,thenthemessageisdroppedsilentlyandnonotiﬁcationisgiventoeitherthesendingorthereceivingnetwork.Thisapproachisusefulfortworeasons.First,fortheparticularcaseofTCP/IP,itavoidsthedelayofanotherround-triptimetoresendthepacketontheInternetsideofthegateway.Second,itallowsustoapplythesametech-niquestonetworkswhichdonothaveanautomaticretransmissionmechanism.4QueuemechanismsSincequeuemechanismsareappliedsuccessfullyinInternetrouters,webeginourexaminationofdatamanagementmechanismsbyevaluatingtheireﬀective-nessasmechanismsforembeddedsystemgateways.Allthequeuesdiscussedinthispaperusetheﬁrst-in-ﬁrst-out(FIFO)queuediscipline.Therearetwokeyparametersforqueuedesignthatweconsider:queuelengthandqueuemanagementpoli-cies.Forqueuelength,weconsiderbothboundedqueues,whichareconstrainedtoacertainmaximumlength,andunboundedqueues,whichareallowedtogrowtoanylength.Whileitisnotpossibletoim-plementatrulyunboundedqueue,weassumeforthesakeofanalysisthatthestoragecapacityofanypracti-978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
178
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 
calimplementationcanbemadearbitrarilylarge.Forqueuemanagementpolicies,weconsiderbehaviordur-ingunderﬂowandoverﬂowsituations.4.1QueueunderﬂowpoliciesQueueunderﬂowisoneexceptionalsituationthatqueuemanagementpoliciesmustdealwith.Queueun-derﬂowoccurswhentheoutgoingnetworkscheduleisreadyforanewmessage,butthequeueisexhaustedandnonewmessagehasarrived.Thissituationislikelytoariseifthearrivingdataisbursty(e.g.aPoissonrandomprocess),butitcouldalsooccurifboththeincomingandoutgoingnetworksareperiodicwithran-domjitter.Werefertotheunderﬂowpolicyweuseasamailboxpolicybecauseofitssimilaritytothemailboximple-mentationusedinCANcontrollers[10].Themailboxholdsthemostrecentlytransmittedvalue,andifnonewvalueisavailablefromthequeue,thatsamevalueissentagain.Dependingontheimplementation,astal-enessindicatormayalsoaccompanytherepeatedvalue.Therearetwoalternativestothemailboxpolicy:sendaninvalidvalueorsendnovalue.Ifaninvalidvalueissentornovalueissent,theapplicationisgoingtocontinuetousethelastvalidvalue(e.g.thesetpointforanactuatorremainsatthelastreceivedvalue),sotheneteﬀectoftheseotherpoliciesisverysimilartothatofthemailboxpolicy.Ifthedatabeingsentiseventorienteddata,thenthemailboxpolicycouldresultinthesysteminterpret-ingrepeatedvaluesasadditionalevents.Inthiscase,thenullorinvalidmessagepoliciesmightbepreferred.Sincetheexamplesdiscussedinthispaperareallcon-cernedwithperiodicstatevariabledata,allthequeuemechanismsdiscussedusethemailboxpolicy.4.2QueueoverﬂowpoliciesQueueoverﬂowpoliciesdescribetheactiontobetakenwhenthequeueexceedsitsdesignedmaximumlength.Thesepoliciesonlyapplytoboundedqueues.Foranunboundedqueue,anoverﬂowconditioncannotoccurunlessthephysicallimitationsofthesystemareexceeded.Somepoliciesmaydropmorethanonemes-sageorcausetheincomingmessagetobedropped.AswasmentionedinSection3,whenamessageisdroppedbythegateway,thefactthatthemessagewasdroppedisnotreportedtoeitherthesendingorreceivingnet-work.Wehaveidentiﬁedfourqueueoverﬂowpolicieswhichwedescribebelow.TheDropNewestPolicyrequiresthatthenewestmessage(thearrivingmessage)bedropped.ThisissimilartotheactivequeuemanagementtechniqueknownasDropTail[3],whichhasbeenusedinInter-netrouters.TheDropOldestPolicyrequiresthattheoldestmessage(i.e.themessageattheheadofthequeue)bedropped.Thistechniqueismoreusefulforstate-orientedmessageswherethemorerecentmessagescon-tainamoreaccuratedescriptionofthecurrentsystemstate.ThisissimilartotheDropFrontcongestioncontroltechniqueproposedin[7].TheDropRandomPolicyrequiresthatamessagebedroppedatrandomfromthequeuewhenanincomingmessagearrivesatafullqueue.Theincomingmes-sageisincludedinthepoolofcandidatemessagestobedropped.ThistechniqueissimilartotheRandomEarlyDroptechnique[8].TheDropAllPolicyrequiresthatthequeuebeﬂushed(completelyemptied)whenanewmessagear-rivesatafullqueue.Thearrivingmessageisnotdropped,butallthemessagesalreadystoredinthequeuearedropped.WhiletheDropAllpolicyisnovel,theremainingthreeareanapplicationofexistingqueuemanagementtechniquestoembeddedsystemgatewayqueuemech-anisms.5ExperimentalapproachHerewedescribetheexperimentalsetupweusedtoevaluatethevariousqueuemechanisms,theapparatusweusedtocollectinputdataforthesimulations,andthemetricswerecordedtoevaluateandcomparedif-ferentmechanisms.5.1SimulationframeworkInordertoevaluatetheperformanceofthevari-ousqueuemanagementmechanisms,wedevelopedadiscretetimeeventsimulatorinJava.Thesimulationmodelsanarrivalprocesswhichdeliversdatatothequeueandaserviceprocesswhichremovesmessagesfromthequeue.Bothprocessescanbespeciﬁedtobedeterministic(e.g.periodic)orrandomaccordingtoaprobabilitydistribution.Alltherandomelementsorsequencesinthesim-ulationaregeneratedusingadeterministicpseudo-randomnumbergenerator.Thesoftwarecanrepeat-ablygeneratethesamepseudo-randomsequencefromagivenseedvalue.Thus,thesamepseudo-randomar-rivalsequencecanberecreatedandappliedtogatewayswhichimplementdiﬀerentdatamanagementmecha-nismstoallowforafaircomparisonoftheirperfor-mance.5.2InputdatacollectionIntheseexperiments,weareconcernedwithstate-orientedperiodicdatastreams.Wedevelopedadata978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
179
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 
Medium Speed Input DataTime (s)02004006008001000Vehicle Speed (km/h)020406080Figure2.Oneinputdatasetforthesimulation,col-lectedonresidentialroadswithrelativelyfewstopsignsandstoplights.collectionsystemthatusestheautomotivestandardOBD-IIdiagnosticinterface[11]torecordthespeedofavehicleduringoperation.Theresultingdataisareasonableexampleofastate-orienteddataset.Anexampleofanapplicationwhichmightgeneratesimilardataisatraﬃccontrolsystemthatreportsthespeedofvehiclesfurtheruptheroadviaroadsidetransmittersoradhocvehicle-to-vehiclenetworks.Thisdatacouldthenbedeliveredviareal-timenetworktoanonboardembeddedcontrollerandusedtomakeadjustmentstoadaptivecruisecontrolsettings.Wecollectedfourdiﬀerentdatasetstouseasinputstothesimulation.Theﬁrstdatasetisaneighborhooddrivingscenariowithlowspeedsandfrequentstopsandstarts.Thesecondset(showninFigure2)isamediumspeedscenarioonroadsthatarenothighways,buthavefewstopsignsorstoplights.Theﬁnaltwosetsarehighwaydrivinginlighttraﬃcandinheavytraﬃc.5.3MetricsThereareseveralrelevantmetricswhichwererecordedinthesimulations.Eachmetricisaggregatedoverallvaluesforasingletrial,soitproducesasin-glevalueforeachtrial.Intheresults,wecomparethedistributionofthesevaluesfromexperimentswithdiﬀerentgatewayconﬁgurations(e.g.diﬀerentmecha-nisms).•Maximumqueuelengthisthemaximumqueuelengthobservedduringasingletrial.•Averagequeuedelayisthedelayforeachmessage(timebetweenarrivalatthequeueanddeparturefromthequeue)averagedforallmessagesinasin-gletrial.Droppedmessagesarenotfactoredintothismetric,andneitherareduplicatedeliveriesthatoccurbecauseofthemailboxpolicy.•Droppedmessagecountisthetotalnumberofdroppedmessagesinasingletrial.•Meanvalueerrorisametricdesignedtocapturehowwelladatamanagementmechanismpreservesthedatasequence.Itiscomputedbyrecordingthepoint-by-pointdiﬀerencebetweentheoriginaldatasequenceandthedatasequenceoutputbythegateway.Theaverageoftheabsolutevalueofthesediﬀerencesiscomputedoverthewholerun.5.4ExperimentalsetupOurexperimentsaredesignedtomodeltheenterprise-to-embeddedscenariodescribedinSection2.Internettraﬃchasbeenshowntobebursty[5],sowechoosetomodelthearrivingdatawithaPois-sonrandomprocess.[9]discussesseveraldelaymodelsthatcanbeusedtomodelthearrivalprocess:constantdelays,independentrandomdelays(e.g.thePoissonprocess),andMarkovchainmodels(whichcapturetheeﬀectofnetworkloadonthedistributionofdelays).ThePoissonprocessmodelissimplerbecauseitdoesnotrequireanexplorationoftheadditionalparame-tersoftheMarkovchainmodels,butitcapturestheburstynatureofthearrivingdata.Webelievethatex-perimentswithotherburstyarrivalprocesswouldhavesimilarresults.Foreachexperiment,thesimulatorwasconﬁguredwithaPoissonarrivalprocesswithmeaninterarrivaltimeofonemessagepersecondandaperiodicserviceprocessalsowithaperiodofonesecond.WeuseoneofthevehiclespeeddatasetsdescribedinSection5.2asinputdata.Thesimulatedgatewayisconﬁguredwithaparticulardatamanagementmechanism(e.g.ﬁnitequeueoflength50usingtheDropOldestoverﬂowpol-icy).Atrialisasinglerunofthesimulationandpro-ducesasinglevalueforeachofthemetricsdescribedinSection5.3.Ineachtrial,adiﬀerentpseudo-randomarrivalsequenceisappliedtothegateway.Eachex-perimentconsistsof5000trials.Thesequenceofdatavaluesdeliveredtothegatewayineachtrialisthesame(suchasthosepicturedinFigure2).Onlythetimingofthearrivalschangesfromtrialtotrial.Anexperimentsetisaseriesofexperimentsperformedwithdiﬀerentmechanisms(e.g.asetofexperimentsonqueuesoflength10,20,and50)intendedtocomparetheperfor-manceofthemechanismswithrespecttooneormoremetrics.Experimentsetsarerepeatedusingeachofthefourdatasetsasinputs.6QueuingResultsThissectiondescribesthequeuemechanismsthatwereusedinthevariousexperimentsandhighlightssomeofthesigniﬁcantresults.Althoughexperimentswereperformedonallfouroftheinputdatasetsde-scribedinSection5.2,wehavechosentoreportonly978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
180
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 
FirstquartileMedianThirdquartile25thSummaryofBoxPlotStatistics10th50th75th90th95thpercentiles5thFigure3.Summaryofthestatisticsprovidedbytheboxplotdiagram.theresultsfromtheseconddataset(showninFigure2)becauseofthelimitedspaceavailable.Theresultsfromtheotherdatasetsarequalitativelysimilarandalsosupportourconclusions.Manyoftheresultspresentedbelowuseboxplotstosummarizetheresultsforaparticularmetricforasingleexperiment.ThestatisticsgiveninaboxplotaresummarizedinFigure3.Theresultsfromasetofexperimentsarepresentedinasinglegraphtofacilitatecomparisonoftheresults.6.1UnboundedqueuesOurﬁrstexperimentusedanunboundedqueuemechanism.Figure4showsaselectionoftimeseriesdatafromasingletrialoftheexperiment.Part(a)showstheinputandoutputdatastreamsandhigh-lightsthedelaybetweentheinputandoutput.Part(b)showsthesizeofthequeueovertime.Thedelayincreasesasthequeuelengthincreases.Asmightbeex-pected,thedelayisdirectlyproportionaltothequeuelength,sincethelengthofthequeuewhenamessagearrivesdetermineshowlongitremainsinthequeue.Onegoalwastoseehowlongthequeuescouldgrow.Figure5showsthedistributionofmaximumqueuelengthsforthisexperiment.Whilethemedianofthedistributionisaround38,themaximumqueuelengthobservedwas125.Althoughlongerqueuesarelesslikely,thereisnotheoreticalupperboundontheworstcasequeuelengthforaninﬁnitelylongdataset.ThemeanvalueerrorresultsforunboundedqueuesexperimentsareincludedinFigures8wheretheyarecomparedtotheresultsfromtheboundedqueueex-perimentsdescribedinSection6.2.Theseexperimentsshowthattransientqueuelengthsanddelayscangrowquitelarge,eveniftheaveragerateofthedatagoinginandoutofthequeueisthesame.Whilethisresultmaybeexpected,itisim-portantbecauseitleadsustoexamineboundedqueuesasawaytomitigatethisdelay.6.2BoundedqueuesWenowexamineboundedqueues,sinceaboundedqueueshouldhaveboundeddelay.WhenwestudyExperiment Trial Time Series Data(unbounded queue, run #4851)Time (s)04080120160200Vehicle Speed (km/h)0102030405060InputOutputTime (s)04080120160200Queue Length0102030Queue Length(a)(b)QueueDelayFigure4.Timeseriesdatafromasingletrial.Queuedelayincreasesasthequeuelengthin-creases.Distribution of Maximum Queue Lengths(Infinite queue, 5000 trials)Maximum Queue Length020406080100120Frequency020406080100120140160180Figure5.Distributionofmaximumqueuelengthsobservedduringeachof5000trials.boundedqueues,weconsidertwoparameters:thelengthofthequeueandtheoverﬂowpolicy.First,weexaminetheeﬀectofqueuelengthonde-layandonthenumberofdroppedmessages.Figure6showsthatthenumberofdroppedmessagesdecreasesasthequeuelengthincreases.Forqueuesoflength50ormore,veryfewmessagesaredroppedatall.Thisisbecauselongerqueuesarelesslikelytooverﬂow.Ontheotherhand,Figure7showsthattheaveragedelayincreasesasthequeuesizeincreases.Forqueues978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
181
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:57:51 UTC from IEEE Xplore.  Restrictions apply. 