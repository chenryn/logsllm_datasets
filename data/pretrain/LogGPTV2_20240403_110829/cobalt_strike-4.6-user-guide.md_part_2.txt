fileisanencryptedblobthatprovidesinformationaboutyourlicensetotheCobaltStrike
product.Thisinformationincludes:yourlicensekey,yourlicenseexpirationdate,andanID
numberthatistiedtoyourlicensekey.
How do I get an authorization file?
Thebuilt-inupdateprogramrequestsanauthorizationfilefromCobaltStrike'supdateserver
whenit'srun.Theupdateprogramdownloadsanewauthorizationfile,evenifyourCobaltStrike
versionisuptodate.Thisallowstheauthorizationfiletostaycurrentwiththelicensedatesin
HelpSystemsrecords.
UserGuide www.helpsystems.com page:13
WelcometoCobaltStrike/InstallationandUpdates
What happens when my license expires?
CobaltStrikewillrefusetostartwhenitsauthorizationfileexpires.Thereisnoimpactifan
authorizationfileexpireswhileCobaltStrikeisrunning.ThelicensedCobaltStrikeproductonly
checksauthorizationfileswhenitstarts.
When does my authorization file expire?
YourauthorizationfileexpireswhenyourCobaltStrikelicenseexpires.IfyourenewyourCobalt
Strikelicense,runthebuilt-inupdateprogramtorefreshtheauthorizationfilewiththelatest
information.
GotoHelp->SystemInformationtofindoutwhenyourauthorizationfileexpires.Lookforthe
"validto"valueundertheOthersection.Remember,theClientInformationandTeamServer
Informationmayhavedifferentvalues(dependingonwhichlicensekeywasusedandwhenthe
authorizationfilewaslastrefreshed).
CobaltStrikewillalsowarnyouwhenitsauthorizationfileiswithin30daysofitsvalidtodate.
How do I bring an authorization file into a closed
environment?
Theauthorizationfileiscobaltstrike.auth.Theupdateprogramalwaysco-locatesthisfilewith
cobaltstrike.jar.TouseCobaltStrikeinaclosedenvironment:
1. DownloadtheCobaltStriketrialpackageathttps://www.cobaltstrike.com/download
2. UpdatetheCobaltStriketrialpackagefromaninternetconnectedsystem
3. Copythecontentsoftheupdatedcobaltstrike/folderintoyourenvironment.Themost
importantfilesarecobaltstrike.jarandcobaltstrike.auth.
Does Cobalt Strike phone home to HelpSystems?
Beyondtheupdateprocess,CobaltStrikedoesnot"phonehome"toHelpSystems.The
authorizationfileisgeneratedbytheupdateprocess.
How do I use an older version of Cobalt Strike with a
refreshed authorization file?
CobaltStrike3.8andbelowdonotcheckfororrequireanauthorizationfile.
CobaltStrike3.9andlatercheckforacobaltstrike.authfileco-locatedwiththecobaltstrike.jar
file.UpdateCobaltStrikefromanotherfolderandcopythenewcobaltstrike.authfiletothe
folderthatcontainsyourold-versionofCobaltStrike.Theauthorizationfileisnottiedtoa
specificversionoftheproduct.
What is the Customer ID value?
TheCustomerIDisa4-bytenumberassociatedwithaCobaltStrikelicensekey.CobaltStrike
3.9andlaterembedthisinformationintothepayloadstagersandstagesgeneratedbyCobalt
UserGuide www.helpsystems.com page:14
WelcometoCobaltStrike/InstallationandUpdates
Strike.
How do I find the Customer ID value in a Cobalt Strike
artifact?
TheCustomerIDvalueisthelast4-bytesofaCobaltStrikepayloadstagerinCobaltStrike3.9
andlater.
ThisscreenshotistheHTTPstagerfromthetrial.ThetrialhasaCustomerIDvalueof0.The
last4-bytesofthisstager(0x0,0x0,0x0,0x0)reflectthis.
HTTPPayloadStager(CobaltStrikeTrial)
TheCustomerIDvaluealsoexistsinthepayloadstage,butit'smorestepstorecover.Cobalt
StrikedoesnotusetheCustomerIDvalueinitsnetworktrafficorotherpartsofthetool.
How do I protect disparate red team infrastructure from
cross-identification with this ID?
Ifyouhaveauniqueauthorizationfileoneachteamserver,theneachteamserverandthe
artifactsthatoriginatefromitwillhaveadifferentID.
CobaltStrike'supdateservergeneratesanewauthorizationfileeachtimetheupdateprogram
isrun.EachauthorizationfilehasauniqueID.CobaltStrikeonlypropagatestheteamserver's
ID.ItdoesnotpropagatetheIDfromtheGUIorheadlessclient'sauthorizationfile.
After You are Done
Congratulations!CobaltStrikeisnowinstalled.Readthefollowingforadditionalinformation
andyournextsteps.
Next Steps
StartingtheTeamServeronpage16
StartingaCobaltStrikeClientonpage16
UserGuide www.helpsystems.com page:15
WelcometoCobaltStrike/StartingtheTeamServer
Starting the Team Server
CobaltStrikeissplitintoclientandaservercomponents.Theserver,referredtoastheteam
server,isthecontrollerfortheBeaconpayloadandthehostforCobaltStrike’ssocial
engineeringfeatures.TheteamserveralsostoresdatacollectedbyCobaltStrikeanditmanages
logging.
TheCobaltStriketeamservermustrunonasupportedLinuxsystem.TostartaCobaltStrike
teamserver,issuethefollowingcommandtoruntheteamserverscriptincludedwiththeCobalt
StrikeLinuxpackage:
Figure3.StartingtheTeamServer
./teamserver   [ ]
Theteamserverscriptusesthefollowingtwomandatoryandtwooptionalparameters:
IPAddress-(mandatory)EntertheexternallyreachableIPaddressoftheteamserver.Cobalt
Strikeusesthisvalueasadefaulthostforitsfeatures.
Password-(mandatory)Enterapasswordthatyourteammemberswillusetoconnectthe
CobaltStrikeclienttotheteamserver.
MalleableC2Profile-(optional)SpecifyavalidMalleableC2Profile.SeeMalleableCommand
andControlonpage95formoreinformationonthisfeature.
KillDate-(optional)EnteradatevalueinYYYY-MM-DDformat.Theteamserverwillembed
thiskilldateintoeachBeaconstageitgenerates.TheBeaconpayloadwillrefusetorunon
orafterthisdateandwillalsoexitifitwakesuponorafterthisdate.
Whentheteamserverstarts,itwillpublishtheSHA256hashoftheteamserver’sSSL
certificate.Distributethishashtoyourteammembers.Whenyourteammembersconnect,their
CobaltStrikeclientwillaskiftheyrecognizethishashbeforeitauthenticatestotheteam
server.Thisisanimportantprotectionagainstman-in-the-middleattacks.
Starting a Cobalt Strike Client
FollowthestepsbelowtoconnecttheCobaltStrikeclienttotheteamserver.
Steps
1. TostarttheCobaltStrikeclient,usethelauncherincludedwithyourplatform’spackage.
a. ForLinux:
i. Enterthefollowingcommands:
./cobaltstrike
UserGuide www.helpsystems.com page:16
WelcometoCobaltStrike/StartingaCobaltStrikeClient
b. ForMacOSX:
i. NavigatetotheCobaltStrikefolder.
ii. Double-clickcobaltstrike.
c. ForWindows:
i. NavigatetotheCobaltStrikefolder.
ii. Double-clickcobaltstrike.exe.
TheConnectDialogscreendisplays.
CobaltStrikeConnectDialog
2. CobaltStrikekeepstrackoftheteamserversyouconnecttoandremembersyour
information.Selectoneoftheseteamserverprofilesfromtheleft-hand-sideofthe
connectdialogtopopulatetheconnectdialogwithitsinformation.UsetheAliasNames
andHostNamesbuttonstotogglehowthelistofhostsaredisplayed.Activeconnections
willbedisplayedinbluetext.Youmaycontrolhowthehostlistisinitiallydisplayed,active
connectiontextcolor,andprunethelistthroughCobaltStrike->Preferences->Team
Servers.
Parameters:
Alias-Enteranaliasforthehostorusethedefault.Thealiasnamecannotbeempty,
startwithan'*',orusethesamealiasnameofanactiveconnection.
Host-Specifyyourteamserver’saddressintheHostfield.Thehostnamecannotbe
empty.
Port-DisplaysthedefaultPortfortheteamserver(50050).Thisisrarelychange.The
portcannotbeemptyandmustbeanumericnumber.
User-TheUserfieldisyournicknameontheteamserver.Changethistoyourcallsign,
handle,ormade-uphackerfantasyname.Theusernamecannotbeempty.
Password-Enterthesharedpasswordfortheteamserver.
3. PressConnecttoconnecttotheCobaltStriketeamserver.
Ifthisisyourfirstconnectiontothisteamserver,CobaltStrikewillaskifyourecognize
theSHA256hashofthisteamserver.
UserGuide www.helpsystems.com page:17
WelcometoCobaltStrike/DistributedandTeamOperations
Verifyingtheserver’sSSLcertificate
4. Ifyoudo,pressYes,andtheCobaltStrikeclientwillconnecttotheserverandopenthe
clientuserinterface.
NOTE:
CobaltStrikewillalsorememberthisSHA256hashforfutureconnections.Youmay
managethesehashesthroughCobaltStrike->Preferences->Fingerprints.
Distributed and Team Operations
UseCobaltStriketocoordinateadistributedredteameffort.StageCobaltStrikeononeor
moreremotehosts.Startyourteamserversandhaveyourteamconnect.
DistributedOperationswithCobaltStrike
Onceconnectedtoateamserver,yourteamwill:
UserGuide www.helpsystems.com page:18
WelcometoCobaltStrike/DistributedandTeamOperations
l Usethesamesessions
l Sharehosts,captureddata,anddownloadedfiles
l Communicatethroughasharedeventlog.
TheCobaltStrikeclientmayconnecttomultipleteamservers.GotoCobaltStrike->New
Connectiontoinitiateanewconnection.Whenconnectedtomultipleservers,aswitchbarwill
showupatthebottomofyourCobaltStrikewindow.
ServerSwitchbar
ThisswitchbarallowsyoutoswitchbetweenactiveCobaltStrikeserverinstances.Eachserver
hasitsownbutton.Right-clickabuttonandselectRenametomakethebutton’stextreflectthe
roleoftheserverduringyourengagement.Theserverbuttonwilldisplaytheactivebuttonin
boldtextandcolorbasedoncolorpreferencefoundinPreferences->TeamServerstobetter
indicatewhichbuttonisactive.ThisbuttonnamewillalsoidentifytheserverintheCobaltStrike
ActivityReport.
Whenconnectedtomultipleservers,CobaltStrikeaggregateslistenersfromalloftheservers
it’sconnectedto.Thisaggregationallowsyoutosendaphishingemailfromoneserverthat
referencesamaliciouswebsitehostedonanotherserver.Attheendofyourengagement,Cobalt
Strike’sreportingfeaturewillqueryalloftheserversyou’reconnectedtoandmergethedatato
tellonestory.
Reconnecting the Client
Whentheclientdisconnectionisuser-initiatedwiththeMenu,ToolbarorSwitchbarServer
button,aredbannerdisplayswithaReconnectandClosebutton.
PressClosetoclosethewindow.PressReconnecttoreconnecttotheTeamServer.
IftheTeamServerisnotavailableadialogdisplaysaskingifyouwanttoretry(Yes/No).IfYes
thenconnectionisattemptedagain(repeatsifneeded).IfNo,thedialogcloses.
WhendisconnectionisinitiatedbytheTeamServerorothernetworkinterruptionthered
bannerwilldisplayamessagewithacountdownforconnectionretry.Thiswillrepeatuntila
UserGuide www.helpsystems.com page:19
WelcometoCobaltStrike/ScriptingCobaltStrike
connectionismadewiththeTeamServerortheuserclicksonClose.Inthiscasetheusercan
interactwithotherpartsoftheUI.
Whentheclientreconnects,theredreconnectbardisappears.
Scripting Cobalt Strike
CobaltStrikeisscriptablethroughitsAggressorScriptlanguage.AggressorScriptallowsyouto
modifyandextendtheCobaltStrikeclient.
History
AggressorScriptisthespiritualsuccessortoCortana,theopensourcescriptingenginein
Armitage.CortanawasmadepossiblebyacontractthroughDARPA'sCyberFastTrack
program.CortanaallowsitsuserstoextendArmitageandcontroltheMetasploit®Framework
anditsfeaturesthroughArmitage'steamserver.CobaltStrike3.0isaground-uprewriteof
CobaltStrikewithoutArmitageasafoundation.Thischangeaffordedanopportunitytorevisit
CobaltStrike'sscriptingandbuildsomethingaroundCobaltStrike'sfeatures.Theresultofthis
workisAggressorScript.
AggressorScriptisascriptinglanguageforredteamoperationsandadversarysimulations
inspiredbyscriptableIRCclientsandbots.Itspurposeistwo-fold.Youmaycreatelongrunning
botsthatsimulatevirtualredteammembers,hackingside-by-sidewithyou.Youmayalsouseit
toextendandmodifytheCobaltStrikeclienttoyourneeds.
Loading Scripts
AggressorScriptisbuiltintotheCobaltStrikeclient.Tomanagescripts,gotoCobaltStrike->
ScriptManagerandpressLoad.
ScriptManager
AdefaultscriptinsideofCobaltStrikedefinesallofCobaltStrike’spopupmenusandformats
informationdisplayedinCobaltStrike’sconsoles.ThroughtheAggressorScriptengine,youmay
overridethesedefaultsandcustomizeCobaltStriketoyourpreferences.
YoumayalsouseAggressorScripttoaddnewfeaturestoCobaltStrike’sBeaconandto
automatecertaintasks.
TolearnmoreaboutAggressorScript,seeAggressorScriptonpage131.
UserGuide www.helpsystems.com page:20
WelcometoCobaltStrike/RunningtheClientonMacOSX
Running the Client on MacOS X
TheCobaltStrikeclientmaynotbeabletoshowcontentsoftheDocuments,Desktop,and
Downloadsfoldersinthefilebrowserinitially.(e.g.loadingscripts,uploadingfiles,generating
payloads,etc…)
Bydefault,OSXlimitswhataccessapplicationshavetotheDocuments,Desktop,andDownload
folders.Theseapplicationsneedtoexplicitlybegrantedaccesstothesefolders.
SinceCobaltStrikeisathirdpartyapplication,itisn'tasstraightforwardasgrantingtheapp
"CobaltStrike"access.YoumayneedtogivetheJRErunningCobaltStrikeclientaccesstothe
filesystem.YoucangiveaccesstothespecificFilesandFoldersorFullDiskAccess.
Youmaybepromptedfortheaccess:
Or,iftheaccesshasbeenpreviouslydenied,youmayneedtoedittheaccessintheOSXSystem
Preferences/Security&Privacy/Privacydialog:
UserGuide www.helpsystems.com page:21
UserInterface/Overview
PleasebeadvisedthatotherapplicationsthatusetheJREwillalsohavethisaccess.
NOTE:
Thesamestepsmayalsoneedtobetakenfor'/bin/bash'.
User Interface
Overview
TheCobaltStrikeuserinterfaceissplitintotwoparts.Thetopoftheinterfaceshowsa
visualizationofsessionsortargets.ThebottomoftheinterfacedisplaystabsforeachCobalt
Strikefeatureorsessionyouinteractwith.Youmayclicktheareabetweenthesetwopartsand
resizethemtoyourliking.
UserGuide www.helpsystems.com page:22
UserInterface/Toolbar
CobaltStrikeUserInterface
Toolbar
ThetoolbaratthetopofCobaltStrikeoffersquickaccesstocommonCobaltStrikefunctions.
KnowingthetoolbarbuttonswillspeedupyouruseofCobaltStrikeconsiderably.
Connect to another team server
Disconnect from the current team server
Create and edit Cobalt Strike’s listeners
Change to the “Pivot Graph” visualization
Change to the “Session Table” visualization
Change to the “Target Table” visualization
View credentials
View downloaded files
View keystrokes
UserGuide www.helpsystems.com page:23
UserInterface/SessionandTargetVisualizations
View screenshots
Generate a stageless Cobalt Strike executable or DLL
Setup the Java Signed Applet attack
Generate a malicious Microsoft Office macro
Stand up a stageless Scripted Web Delivery attack
Host a file on Cobalt Strike’s web server
Manage files and applications hosted on Cobalt Strike’s web server
Visit the Cobalt Strike support page
About Cobalt Strike
Session and Target Visualizations
CobaltStrikehasseveralvisualizationseachdesignedtoaidadifferentpartofyour
engagement.Youmayswitchbetweenvisualizationsthroughbuttons onthetoolbar
ortheCobaltStrike->Visualizationmenu.
Pivot Graph
CobaltStrikehastheabilitytolinkmultipleBeaconsintoachain.TheselinkedBeaconsreceive
theircommandsandsendtheiroutputthroughtheparentBeaconintheirchain.Thistypeof
chainingisusefultocontrolwhichsessionsegressanetworkandtoemulateadisciplinedactor
whorestrictstheircommunicationpathsinsideofanetworktosomethingplausible.This
chainingofBeaconsisoneofthemostpowerfulfeaturesinCobaltStrike.
CobaltStrike’sworkflowsmakethischainingveryeasy.It’snotuncommonforCobaltStrike
operatorstochainBeaconsfourorfivelevelsdeeponaregularbasis.Withoutavisualaidit’s
verydifficulttokeeptrackofandunderstandthesechains.ThisiswherethePivotGraphcomes
in.
ThePivotGraphshowsyourBeaconchainsinanaturalway.EachBeaconsessionhasanicon.As
withthesessionstable:theiconforeachhostindicatesitsoperatingsystem.Iftheiconisred
withlightningbolts,theBeaconisrunninginaprocesswithadministratorprivileges.Adarker
iconindicatesthattheBeaconsessionwasaskedtoexitanditacknowledgedthiscommand.
ThefirewalliconrepresentstheegresspointofyourBeaconpayload.Adashedgreenline
indicatestheuseofbeaconingHTTPorHTTPSconnectionstoleavethenetwork.Ayellow
dashedlineindicatestheuseofDNStoleavethenetwork.
UserGuide www.helpsystems.com page:24
UserInterface/SessionandTargetVisualizations
CobaltStrikeGraphView
AnarrowconnectingoneBeaconsessiontoanotherrepresentsalinkbetweentwoBeacons.
CobaltStrike’sBeaconusesWindowsnamedpipesandTCPsocketstocontrolBeaconsinthis
peer-to-peerfashion.Anorangearrowisanamedpipechannel.SSHsessionsuseanorange
arrowaswell.AbluearrowisaTCPsocketchannel.Ared(namedpipe)orpurple(TCP)arrow
indicatesthataBeaconlinkisbroken.
ClickaBeacontoselectit.YoumayselectmultipleBeaconsbyclickinganddraggingaboxover
thedesiredhosts.PressCtrlandShiftandclicktoselectorunselectanindividualBeacon.
Right-clickaBeacontobringupamenuwithavailablepost-exploitationoptions.
SeveralkeyboardshortcutsareavailableinthePivotGraph.
l Ctrl+Plus—zoomin
l Ctrl+Minus—zoomout
l Ctrl+0—resetthezoomlevel
l Ctrl+A—selectallhosts
l Escape—clearselection
l Ctrl+C—arrangehostsintoacircle
l Ctrl+S—arrangehostsintoastack
l Ctrl+H—arrangehostsintoahierarchy.
Right-clickthePivotGraphwithnoselectedBeaconstoconfigurethelayoutofthisgraph.This
menualsohasanUnlinkedmenu.SelectHidetohideunlinkedsessionsinthepivotgraph.Select
Showtoshowunlinkedsessionsagain.
Sessions Table
ThesessionstableshowswhichBeaconsarecallinghometothisCobaltStrikeinstance.Beacon
isCobaltStrike’spayloadtoemulateadvancedthreatactors.Here,youwillseetheexternalIP
addressofeachBeacon,theinternalIPaddress,theegresslistenerforthatBeacon,whenthe
Beaconlastcalledhome,andotherinformation.Nexttoeachrowisaniconindicatingthe
UserGuide www.helpsystems.com page:25
UserInterface/Tabs
operatingsystemofthecompromisedtarget.Iftheiconisredwithlightningbolts,theBeaconis
runninginaprocesswithadministratorprivileges.AfadediconindicatesthattheBeacon
sessionwasaskedtoexitanditacknowledgedthiscommand.
CobaltStrikeBeaconManagementTool
IfyouuseaDNSBeaconlistener,beawarethatCobaltStrikewillnotknowanythingabouta
hostuntilitchecksinforthefirsttime.Ifyouseeanentrywithalastcalltimeandthat’sit,you
willneedtogivethatBeaconitsfirsttasktoseemoreinformation.
Right-clickoneormoreBeacon’stoseeyourpost-exploitationoptions.
Targets Table
TheTargetsTableshowsthetargetsinCobaltStrike’sdatamodel.Thetargetstabledisplaysthe
IPaddressofeachtarget,itsNetBIOSname,andanotethatyouoroneofyourteammembers
assignedtothetarget.Theicontotheleftofatargetindicatesitsoperatingsystem.Aredicon
withlightningboltsindicatesthatthetargethasaCobaltStrikeBeaconsessionassociatedwith
it.
CobaltStrikeTargetsView
Clickanyofthetableheaderstosortthehosts.Highlightarowandright-clickittobringupa
menuwithoptionsforthathost.PressCtrlandAltandclicktoselectanddeselectindividual
hosts.
Thetarget’stableisausefulforlateralmovementandtounderstandyourtarget’snetwork.
Tabs
CobaltStrikeopenseachdialog,console,andtableinatab.ClicktheXbuttontocloseatab.Use
Ctrl+Dtoclosetheactivetab.Ctrl+Shift+Dwillclosealltabsexcepttheactiveon.
Youmayright-clicktheXbuttontoopenatabinawindow,takeascreenshotofatab,orclose
alltabswiththesamename.
UserGuide www.helpsystems.com page:26
UserInterface/Consoles
Keyboardshortcutsexistforthesefunctionstoo.UseCtrl+Wtoopentheactivetabinitsown
window.UseCtrl+Ttoquicklysaveascreenshotoftheactivetab.
Ctrl+BwillsendthecurrenttabtothebottomoftheCobaltStrikewindow.Thisisusefulfor
tabsthatyouneedtoconstantlywatch.Ctrl+Ewillundothisactionandremovethetabatthe
bottomoftheCobaltStrikewindow.
HoldshiftandclickXtoclosealltabswiththesamename.Holdshift+controlandclickXto
openthetabinitsownwindow.
UseCtrl+LeftandCtrl+Righttoquicklyswitchtabs.Youmaydraganddroptabstochangetheir
order.
Consoles
CobaltStrikeprovidesaconsoletointeractwithBeaconsessions,scripts,andchatwithyour
teammates.
AConsoleTab
Theconsolestrackyourcommandhistory.Usetheuparrowtocyclethroughpreviouslytyped
commands.Thedownarrowmovesbacktothelastcommandyoutyped.Thehistorycommand
listspreviouslytypedcommands.The!commandallowspreviouslytypedcommandstoberan
again.
NOTE:
Thelistofpreviouslytypedcommandsisnotmaintainedbetweensessions.Closinga
consolewindowandthenreopeningitwillstartwithnopreviouslytypedcommands.
UsetheTabkeytocompletecommandsandparameters.
UseCtrl+Plustomaketheconsolefontsizelarger,Ctrl+Minustomakeitsmaller,andCtrl+0to
resetit.Thischangeislocaltothecurrentconsoleonly.VisitCobaltStrike->Preferencesto
permanentlychangethefont.
PressCtrl+Ftoshowapanelthatwillletyousearchfortextwithintheconsole.UseCtrl+Ato
selectalltextintheconsole’sbuffer.
UserGuide www.helpsystems.com page:27
DataManagement/Tables
Tables
CobaltStrikeusestablestodisplaysessions,credentials,targets,andotherengagement
information.
MosttablesinCobaltStrikehaveanoptiontoassignacolorhighlighttothehighlightedrows.
ThesehighlightsarevisibletootherCobaltStrikeclients.Right-clickandlookfortheColor
menu.
PressCtrl+Fwithinatabletoshowthetablesearchpanel.Thisfeatureletsyoufilterthe
currenttable.
TablewithSearchPanel
Thetextfieldiswhereyoutypeyourfiltercriteria.Theformatofthecriteriadependsonthe
columnyouchoosetoapplythefilterto.UseCIDRnotation(e.g.,192.168.1.0/24)andhost
ranges(192.168.1-192.169.200)tofiltercolumnsthatcontainaddresses.Usenumbersor