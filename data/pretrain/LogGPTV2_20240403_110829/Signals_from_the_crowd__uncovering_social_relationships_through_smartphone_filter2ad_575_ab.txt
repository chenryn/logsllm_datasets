(32.8%)
(39.6%)
(36.6%)
(51.6%)
(32.5%)
(30.6%)
(36.1%)
(36.2%)
Total Probes
1,190,481
330,936
820,806
393,143
5,349,894
1,234,416
507,945
1,309,090
11,136,711
Directed Probes (%) Broadcast Probes (%)
406,002
(65.9%)
(64.5%)
117,644
(52.0%)
394,184
(44.5%)
218,234
(47.6%)
2,803,104
555,361
(55.0%)
(60.0%)
208,028
(51.0%)
642,526
5,345,083
(52.0%)
784,479
213,292
426,622
174,909
2,546,790
679,055
299,917
666,564
5,791,628
(34.1%)
(35.5%)
(48.0%)
(55.5%)
(52.4%)
(45.0%)
(40.0%)
(49.0%)
(48.0%)
SSIDs
14,740
11,145
10,451
17,295
14,751
29,533
23,345
42,105
133,351
Table 2: Statistics on the probes captured in our target events. The column “PNLs” reports the number (and percentage) of devices
that disclosed at least one entry of their Preferred Network List.
i
s
e
c
v
e
d
f
o
t
e
g
a
n
e
c
r
e
P
i
s
e
c
v
e
d
s
’
r
o
d
n
e
v
f
o
e
g
a
t
n
e
c
r
e
P
 60
 50
 40
 30
 20
 10
 0
A
S
N
H
S
104K
88K
72K
52K
36K
16K
N
u
m
b
e
r
o
f
d
e
v
c
e
s
i
R
I
M
p
a
ple
m
s
u
o
kia
T
C
o
n
y
n
g
Figure 1: Vendors distribution (All datasets).
 100
 80
 60
 40
 20
 0
A
p
ple
S
a
m
N
H
S
o
kia
T
C
o
n
y
s
u
n
g
R
I
M
Figure 2: Vendor percentage of devices that exposed part or all
the SSIDs in their Preferred Network List (dataset All).
by Musa et. al.
in [32], and we can observe that all vendors in
our list are amongst the market leaders of mobile devices, such as
smartphones and tablets. This suggests that our datasets indeed
capture a representative sample of the most commonly used mobile
devices.
A question that we raise is how the choice of a particular ven-
dor affects the probability that all or part of the PNL is exposed
by means of directed probe requests. This is relevant for our anal-
ysis, and may also be an important information from a security
and privacy point of view. An adversary, by using just commodity
hardware, might collect the SSIDs in the PNL of a user’s device
and perform an Evil Twin man-in-the-middle attack [4] against the
user. Also, the names of the networks may reveal sensible infor-
mation on the user, such as the place where she lives or works, the
communities she belongs to, and the places she likes or frequently
visits. The percentage of devices of each of the most common ven-
dors in the datasets is reported in Figure 2: 92% of RIM devices
disclosed part of their PNL, followed by HTC (55%), Sony (35%),
Apple (35%), Samsung (31%) and Nokia devices (13%).
4.2 SSIDs Analysis
Today it is becoming more and more common to ﬁnd WiFi ac-
cess points not only in homes and workplaces, but also in public
environments such as restaurants, hotels, and pubs. As a result, the
probability that users connect to the WiFi networks of the places
they visit is increasing too.
Intuitively, this should produce two
side effects: First, SSIDs of WiFi networks of public places that
are popular among the people that participated to an event should
be found in many of their devices. Second, a signiﬁcant fraction of
the PNLs of these devices should store more than one SSID—e.g.
home WiFi, ofﬁce WiFi, and so on. We investigate whether the
datasets we collected conﬁrm these two intuitions. To do so, we re-
constructed the PNLs of the devices in our datasets by collecting all
the directed probe requests we logged. The total number of devices
with a non-empty PNL is around 59K. The results of our analysis
for Politics 1 (P1), Vatican 1 (V1), University (U) and the Mall, as
well as for all the datasets together (All), are shown in Figure 3.
The other datasets show similar trends.
The distributions of the popularity of the SSIDs are reported in
Figure 3(a) for a selection of the datasets, one for each type of
event we targeted. As the ﬁgure shows, in our datasets the dis-
tributions are heavy-tailed, with very few highly popular access
points coexisting with hundred of thousands of SSIDs stored in a
handful of PNLs. It is also interesting to notice that this result is
consistent across different datasets independently on the data col-
lection methodology. In fact, the datasets collected in local events
(P1, Mall), those collected in international events (V1), and the
long term dataset (U) show the same type of distribution. As ex-
pected, many popular SSIDs are relative to the WiFi network of
public places, such as airports, tourist attractions, university cam-
puses and so on. Among them, there are also SSIDs of a number of
city-wide WiFi networks, such as “Provincia WiFi”, serving around
268I
s
D
S
S
f
o
r
e
b
m
u
N
 100000
 10000
 1000
 100
 10
 1
All
P1
V1
U
Mall
s
e
d
o
n
f
o
r
e
b
m
u
N
 10000
 1000
 100
 10
 1
All
P1
V1
U
Mall
 1
 10
 100
Number of devices
(a) SSIDs
 1
 10
 100
Length of the PNL
(b) PNLs
Figure 3: Distribution of the popularity of the SSIDs (a) and of the sizes of the PNLs (b) relative to the All, Politics 1 (P1), Vatican 1
(V1), University (U), and The Mall (Mall) datasets.
300K users in Rome, and “Guglielmo”, a WiFi network with more
than 9K hotspots across Europe. Although we found SSIDs that are
popular only because they have very generic names (e.g., “Hotspot”
or “Dlink”), our results suggest that popular, public networks can
indeed be detected by our data collection methodology.
The distributions of the lengths of the PNLs are shown in Fig-
ure 3(b). All the distributions present a peculiar shape: Up to
about 16, the curves approximately follow a heavy-tailed distribu-
tion, then we observe a peak and a very steep drop. This behavior is
easily explained by the fact that many vendors limit the number of
different networks to which send directed probe requests to 16. For
instance, we found that in the Android OS this limit is hard-coded
as a constant with value 16 in the wireless driver source code4.
These results, which are consistent across all the datasets, conﬁrm
the intuition that a signiﬁcant fraction of users have more than just
1 SSID in the PNL of their device. More in detail, for the All
dataset, 50% of the PNLs of all the devices store one SSID only,
around 30% store between two and 10 SSIDs, and the remaining
20% store more than 10 SSIDs.
4.3 Uncovering the underlying social network
A contribution of our work is to show how WiFi probes can be
used as a new lens to look at a crowd and uncover important infor-
mation about it. One relevant information is the social structure of
the set of people in the crowd.
We can regard the PNL of a device as a list of signiﬁcant places
visited by the user—signiﬁcant enough that the user spent some
time to connect to the access point. Therefore, the fact that two
users share one or more SSIDs in the PNL of their devices should
intuitively provide some information on the existence of a social
relationship between the two. This intuition is supported by recent
ﬁndings on the spatio-temporal properties of human behavior that
have shown how social relationships can be correctly inferred be-
tween people sharing similar location trails [14, 10]. We investigate
whether, by considering social links inferred from WiFI probes, we
can uncover a social network that underlies the crowd that partic-
ipated to the events we targeted. We do so by describing an auto-
matic method for inferring social links between users starting from
the PNLs of their mobile devices. We then apply this method to
show how full-ﬂedged social networks emerge from our datasets.
4.3.1 From afﬁliation networks to social networks
The SSIDs in the PNLs of a set of devices can be represented in
the form of an afﬁliation network [23, 5]. An afﬁliation network,
denoted as G = (V1,V2,E), is a bipartite graph that connects a set V1
of actors and a set V2 of groups they belong to. In our case, V1 is
the set of devices that disclosed at least one entry of their PNL, V2
is the set of the network SSIDs we collected, and an edge (v1,v2) ∈
E represents v1 having v2 in its PNL. Statistics of the afﬁliation
networks relative to each of our datasets are reported in Table 3.
Starting from an afﬁliation network of devices and SSIDs we
can build a social network ¯G = (V1, ¯E) between devices as fol-
lows: First, we deﬁne a similarity measure f : V1 ×V1 → R that,
given two devices u and v, yields the strength of the social relation-
ship between their respective users. Then, we impose a minimum
threshold τ and place an edge {u,v} ∈ ¯E only if f (u,v) > τ. A
ﬁrst possible choice of a similarity measure would be one based
the size of the intersection between the PNLs of the two devices.
In order for an edge to be placed, we would require at least τ = k
common SSIDs. Although widely used in the literature [22, 23],
this similarity measure would not work in our case as it gives the
same importance to all SSIDs regardless of their popularity. In fact,
in Section 4.2 we have seen how very popular SSIDs correspond to
city-wide free networks, or to networks with very generic names
(e.g., “Dlink”) that, intuitively, should not produce strong social
links. On the other hand, less popular SSIDs of home or small
private networks clearly denote a potential strong relationship be-
tween users that connect to them. We therefore need a similarity
measure that takes into account both the intersection of the PNLs
and the popularity of the SSIDs. The similarity measure we found
out to be the one best matching our needs is the Adamic-Adar [1]
which penalizes SSIDs of popular networks in favour of those of
networks shared by few people only (see Figure 4). More formally,
the Adamic-Adar measure is deﬁned as follows:
fADA(u,v) = ∑
w∈N(u)∩N(v)
1
log2(|M(w)|)
(1)
4http://androidxref.com/4.1.1/xref/external/