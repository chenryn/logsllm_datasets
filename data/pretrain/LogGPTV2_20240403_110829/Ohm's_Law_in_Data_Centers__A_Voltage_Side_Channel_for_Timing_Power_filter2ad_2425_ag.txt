### References

1. **Number: 332937-003, Jul. 2016.**
2. **"Allowed in data centers,"** in ICAC, 2011.
3. **"Key drivers and barriers,"** Issue Paper, Aug. 2014.
4. **DataCenterKnowledge, April 2016.**
5. **NRDC, "Scaling up energy efficiency across the data center industry: Evaluating key drivers and barriers,"** 2014.
6. **Y. Sverdlik, "Google to build and lease data centers in big cloud expansion,"** DataCenterKnowledge, 2016.
7. **Apple, "Environmental responsibility report,"** 2016.
8. **Internap, "Colocation services and SLA,"** http://www.internap.com/internap/wp-content/uploads/2014/06/Attachment-3-Colocation-Services-SLA.pdf.
9. **On Semiconductor, "Power factor correction (PFC) handbook,"** http://www.onsemi.com/pub/Collateral/HBD853-D.PDF.
10. **H. W. Beaty and D. G. Fink, Standard handbook for electrical engineers. McGraw-Hill New York, 2007.**
11. **EdgeConnex, http://www.edgeconnex.com/.**
12. **DatacenterMap, "Colocation USA,"** http://www.datacentermap.com/usa/.
13. **"Colocation market by solutions, end users, verticals & region - worldwide market forecast and analysis (2013 - 2018),"** http://www.researchandmarkets.com/research/pxndbm/colocation_market.
14. **DatacenterKnowledge, "Vapor IO to sell data center colocation services at cell towers,"** http://www.datacenterknowledge.com/archives/2017/06/21/vapor-io-to-sell-data-center-colocation-services-at-cell-towers.
15. **Vapor IO, "The edge data center,"** https://www.vapor.io/.
16. **Telecommunications Industry Association, "Data center standards overview," TIA-942, 2005 (amended in 2014).**
17. **Colocation America, "Data center standards (Tiers I-IV),"** 2017, https://www.colocationamerica.com/data-center/tier-standards-overview.htm.
18. **M. Sedaghat, E. Wadbro, J. Wilkes, S. D. Luna, O. Seleznjev, and E. Elmroth, "Diehard: Reliable scheduling to survive correlated failures in cloud data centers,"** in CCGrid, 2016.
19. **M. Sheppy, C. Lobato, O. V. Geet, S. Pless, K. Donovan, and C. Powers, "Reducing data center loads for a large-scale, low-energy office building: NREL’s research support facility,"** Nov. 2011.
20. **S.-J. Moon, V. Sekar, and M. K. Reiter, "Nomad: Mitigating arbitrary cloud side channels via provider-assisted migration,"** in CCS, 2015.
21. **X. Gao, Z. Xu, H. Wang, L. Li, and X. Wang, "Reduced cooling redundancy: A new security vulnerability in a hot data center,"** in NDSS, 2018.
22. **DatacenterKnowledge, "Can EdgeConnex disrupt incumbent data center providers?,"** http://www.datacenterknowledge.com/archives/2016/09/13/can-edgeconnex-disrupt-incumbent-data-center-providers/.
23. **Vertiv, "Flexible, efficient scalable UPS for room or row-based applications,"** Liberty APS Product Brochure, 2016.
24. **Energy Star, "Computers specification version 7.0,"** 2018, https://www.energystar.gov/products/spec/computers_specification_version_7_0_pd.
25. **IECEE, "IEC 61000-3-2:2018: Electromagnetic compatibility (EMC) - part 3-2,"** http://www.iec.ch.
26. **Microchip, "Switch mode power supply (SMPS) topologies,"** http://ww1.microchip.com/downloads/en/AppNotes/01114A.pdf.
27. **Infineon Technologies AG, "PFC boost converter design guide,"** https://goo.gl/MePNFj.
28. **L. Chen, J. Xia, B. Yi, and K. Chen, "Powerman: An out-of-band management network for datacenters using power line communication,"** in NSDI, 2018.
29. **J. Zhang, J. Shao, P. Xu, F. C. Lee, and M. M. Jovanovic, "Evaluation of input current in the critical mode boost PFC converter for distributed power systems,"** in IEEE Applied Power Electronics Conference and Exposition.
30. **G. Wang, S. Wang, B. Luo, W. Shi, Y. Zhu, W. Yang, D. Hu, L. Huang, X. Jin, and W. Xu, "Increasing large-scale data center capacity by statistical power control,"** in EuroSys, 2016.
31. **D. G. Feitelson, D. Tsafrir, and D. Krakov, "Experience with using the parallel workloads archive,"** Journal of Parallel and Distributed Computing, vol. 74, no. 10, pp. 2967–2982, 2014.
32. **Parallel Workloads Archive, http://www.cs.huji.ac.il/labs/parallel/workload/.**
33. **N. Rasmussen, "High-efficiency AC power distribution for data centers,"** Schneider Electric White Paper Library, http://www.apc.com/salestools/nran-6cn8pk/nran-6cn8pk_r2_en.pdf.
34. **N. Rasmussen, "Efficiency and other benefits of 208 volt over 120 volt input for IT equipment,"** Schneider Electric White Paper Library, http://www.apc.com/salestools/SADE-5TNQZ7/SADE-5TNQZ7_R3_EN.pdf.
35. **W. Xu, W. Trappe, and Y. Zhang, "Anti-jamming timing channels for wireless networks,"** in WiSec, 2008.
36. **D. Wang, C. Ren, A. Sivasubramaniam, B. Urgaonkar, and H. Fathy, "Energy storage in datacenters: What, where, and how much?,"** in SIGMETRICS, 2012.
37. **S. Govindan, D. Wang, A. Sivasubramaniam, and B. Urgaonkar, "Leveraging stored energy for handling power emergencies in aggressively provisioned datacenters,"** in ASPLOS, 2012.
38. **D. S. Palasamudram, R. K. Sitaraman, B. Urgaonkar, and R. Urgaonkar, "Using batteries to reduce the power costs of internet-scale distributed networks,"** in SoCC, 2012.
39. **M. Guri, M. Monitz, Y. Mirski, and Y. Elovici, "Bitwhisper: Covert signaling channel between air-gapped computers using thermal manipulations,"** in IEEE Computer Security Foundations Symposium, 2015.
40. **P. C. Kocher, J. Jaffe, and B. Jun, "Differential power analysis,"** in CRYPTO, 1999.
41. **M. A. Islam, H. Mahmud, S. Ren, and X. Wang, "Paying to save: Reducing cost of colocation data center via rewards,"** in HPCA, 2015.
42. **C. Wang, N. Nasiriani, G. Kesidis, B. Urgaonkar, Q. Wang, L. Y. Chen, A. Gupta, and R. Birke, "Recouping energy costs from cloud tenants: Tenant demand response aware pricing design,"** in eEnergy, 2015.
43. **N. Nasiriani, C. Wang, G. Kesidis, B. Urgaonkar, L. Y. Chen, and R. Birke, "On fair attribution of costs under peak-based pricing to cloud tenants,"** in MASCOTS, 2015.
44. **M. A. Islam, X. Ren, S. Ren, and A. Wierman, "A spot capacity market to increase power infrastructure utilization in multi-tenant data centers,"** in HPCA, 2018.
45. **On Semiconductor, "Switch-mode power supply reference manual,"** https://www.onsemi.com/pub/Collateral/SMPSRM-D.PDF.

### Appendix

#### A. The Need for PFC in Server’s Power Supply Unit

In this section, we discuss the implications of not using a power factor correction (PFC) circuit in a server’s power supply unit. Figure 20(a) shows an AC-to-DC converter without the PFC stage. The output of the bridge-rectifier is delivered to the load (e.g., CPU, disk, etc.) through a diode. A bulk capacitor is placed at the output to stabilize the voltage. As shown in Figure 20(b), this circuit can provide a relatively stable DC voltage to the load. However, due to the diode, the load receives current from the source only when the load voltage is lower than the rectifier output voltage. It gets its needed current from the bulk capacitor when the rectifier output voltage is lower than the load voltage. Hence, the bridge rectifier only conducts current during a brief moment near the input voltage’s peak when the input voltage is higher than the load voltage (which is also the voltage across the bulk capacitor). In addition, during the rectifier conduction, the external source line powers both the load and the bulk capacitor, creating a high current spike from the source line.

Figure 20(c) shows the source voltage at the AC-to-DC converter’s input and the current supplied by the source line (i.e., drawn from the UPS through the PDU). The large difference between the voltage and the current shape reduces the power factor to a level much less than 1 (i.e., for much of the time, the UPS and PDU are not delivering any actual current or power to the server).

Thus, for improving the power factor as mandated by [39, 40], a PFC circuit (which universally uses the PWM switching design due to its high efficiency [60]) is needed for the server’s power supply unit.

![Figure 20: (a) A basic AC/DC power supply unit without a PFC circuit. (b) Rectifier delivers current in bursts. (c) The heavily-distorted current drawn by the server’s power supply unit without the PFC.](figure20.png)

#### B. Server Power vs. PSD for Alternate Power Supply Unit

Figure 21 shows the relationship between the server power and the resulting PSD for one of our servers with a 350W power supply unit. As in Figure 9(b), we see a monotonic increasing relation between the aggregate PSD and the server’s power consumption.

![Figure 21: Server power vs. PSD aggregated within the bandwidth of 63 ∼ 64kHz for the 350W PSU.](figure21.png)

#### C. Power vs. PSD for Different Servers

Figure 22 shows the power vs. aggregate PSD plot for the three benign tenants from our 12-hour experiment. This figure is based on the same results of Figure 12. Instead of plotting all data points from the 12-hour trace, we randomly choose 500 data points for this figure. It reveals that for the same power level, tenant #1’s servers have a smaller aggregate PSD than the other two tenants. This supports our choice of treating each group of spikes separately.

![Figure 22: Power vs. PSD plot of different server groups.](figure22.png)

#### D. When UPS is On Battery

In our previous experiments, the UPS was working in the normal mode without performing voltage regulation. Now, we examine if the voltage ripple is still prominent when the UPS is active and providing power through its battery. Figure 23(a) shows the waveforms of the UPS output voltage in the normal and on-battery modes: the UPS passes the grid voltage to the PDU without much modification in the normal mode, whereas it produces an alternating square wave with a duty cycle of 0.5 when on battery (typically due to loss of grid power). Intuitively, when on battery, the non-sinusoidal voltage will add additional frequency components. When the UPS is on battery, we turn on one server and show in Figure 23(b) the resulting PSD of the measured voltage. While the battery operation introduces additional frequency components (mostly at the lower frequencies), the PSD spike due to the server’s PFC switching is still clearly visible at around 70kHz. Along with our previous experiments, this demonstrates that, even though the UPS modifies the incoming grid voltage, the attacker can still exploit the PSD spikes to estimate servers’ aggregate power usage.

![Figure 23: (a) Voltage reading at the PDU with the UPS running in normal mode and in battery-backup mode. (b) The PSD spike from server power supply unit is still visible with the non-sinusoidal voltage during the battery-backup mode.](figure23.png)

#### E. Power Supply Units

Figure 24 shows the three different types of power supplies we have in our servers. Even though all of these are used by the Dell PowerEdge servers, they have different model numbers and are manufactured by different companies. While the 350W power supply unit apparently has a different size and rating than the other two, and therefore cannot be swapped, the similar-sized 495W power supplies are also not allowed (server does not boot) to be swapped due to their model differences.

![Figure 24: The three different types of server power supplies in our experiments.](figure24.png)

#### F. PFC Switching Frequency

Here, we investigate the temporal variation of the switching frequency of the server power supply unit. For this, we record the PDU voltage reading for two hours with one server running. We then get the PSD for each one-second sample and extract the switching frequency from the PSD spike around 70kHz. Figure 25 shows the probability mass function (PMF) of the switching frequency. We see that while not perfectly fixed, the switching frequency remains mostly within a narrow (<100Hz) window. Due to this small temporal variation combined with the random manufacturing imperfections, PSD spikes from multiple servers with the same (model and generation) power supply unit do not perfectly overlap with each other, and therefore generate a group of spikes in the voltage PSD.

![Figure 25: PMF shows the PFC switching frequency only fluctuates slightly.](figure25.png)

#### G. DC Power Distribution

We show a data center with DC power distribution in Figure 26. In this type of data center, a UPS converts the grid’s three-phase AC voltage to a 380V-DC voltage and distributes it inside the data center through DC PDUs. DC distribution requires all servers to have DC power supply units which use only a DC to DC converter to supply regulated 12V to server internal components. Unlike AC power supplies, the DC power supplies do not require a power factor correction circuit.

![Figure 26: DC power distribution with DC server power supply unit that has no PFC circuit.](figure26.png)

#### H. Different Three-Phase Line Connections

We show two alternate three-phase line connections used in large multi-tenant data centers.

Figure 27 shows the connectivity for a three-phase line-to-neutral connection that supplies power to servers at 120V. In this type of connection, a server/server rack is connected to only one phase. Thus, the voltage drop of each phase depends on only the servers connected to that phase. As a result, this can be handled as three separate single-phase systems, and the attacker can easily track the tenants’ per-phase total power usage by housing one server rack on each phase.

![Figure 27: Three-phase distribution with single-phase, 120V server/server racks.](figure27.png)

Figure 28 shows the line connectivity that uses three-phase distribution all the way down to servers. This type of connection is not common because of the three-phase server power supply unit requirement. The 3-phase power supply unit equally loads its three phases, and hence this type of connection can be treated as a single-phase system replicated three times.

![Figure 28: Three-phase distribution with three-phase server/server racks.](figure28.png)