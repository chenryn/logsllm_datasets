1070
1020
1030
1035
1040
1050
1055
10 
2430
2350
2360
2370
2380
2390
2400
15 
1550
1470
1480
1490
1500
1515
1530
15 
2970
2820
2830
2840
2850
2860
2870
20 
2080
1760
1780
1790
1800
1810
1825
20 
3430
3240
3250
3260
3265
3270
3280
25 
2710
2350
2360
2370
2380
2400
2410
25 
3870
3720
3730
3740
3750
3760
3770
30 
3190
2990
3000
3020
3030
3050
3060
30 
4250
4020
4030
4050
4070
4090
4100
Figure  8:  Tables  of  minimum  number  of  packets  needed  for 
reconstruction. Up: q = 0.04; Down: q = 0.01. q: marking probability; 
Len1: length of the path from attacker to reflector; Len2: length of the 
path from reflector to victim; nRf: the number of reflectors. 
The  experimental  results  show  that  our  proposed 
marking  scheme  is  feasible  and  the  performance  is 
satisfactory.  They  also  confirm  that  the  attack  paths 
reconstruction algorithm yields negligible false positives. 
Figures 8 tabulates the results of the minimum number 
of packets required to reconstruct paths of varying lengths 
with  95%  probability  of  success,  and  the  marking 
probabilities q are 4% and 1% respectively. In a reflector 
attack,  the  attack  path  is  composed  of  two  parts,  namely 
the  sub-path  from  the  attacker  to  the  reflectors,  and  the 
sub-path from the reflectors to the victim. So the total path 
length would be equal to the sum of the lengths of the two 
parts. We set the number of reflectors nRf involved in the 
reflector  attacks  equal  to  30.  For  the  two  sets  of 
experiments  presented  in  Figures  8,  we  varied  the  attack 
path  (from  attacker  to  reflector)  length  parameter  Len1
from 5 to 30, and the attack path (from reflector to victim) 
length  parameter  Len2  from  0  to  30.  Each  data  point  in 
each  of  the  tables  corresponds  to  an  average  of  the  data 
values obtained from over 200 independent experiments. 
f
o
r
e
b
m
u
N
s
t
e
k
c
a
p















Len1






Figure  9:  Bar  chart  representation  of  minimum  number  of  packets 
needed for attack paths reconstruction (q = 0.01).  
When  the  parameter  Len2  is  0,  the  simulated  attacks 
would  be  the  ordinary  DoS  attacks  and  not  reflector 
attacks. When compared with FMS [7], and scheme  1  of 
the  advanced  marking  scheme  [9],  our  marking  scheme 
requires  significantly 
less  packets  for  attack  paths 
reconstruction.  Our  scheme  is  also  slightly  better  than 
scheme 2 with m>7 (for the case with a minimum number 
of false positives), and not worse than scheme 2 with m>6 
(for  the  case  with  a  second  minimum  number  of  false 
positives) of the advanced marking scheme [9]. In addition, 
our  scheme  also  outperforms  other  traceback  schemes 
based  on  the  criterion  of  producing  the  least  number  of 
false positives. 
For  the  cases  with  Len2  not  equal  to  0,  the  simulated 
attacks  belong  to  reflector  attacks.  Figure  9  shows  a  bar 
chart view of the minimum number of packets needed for 
attack  paths  reconstruction  with  q  =  0.01.  The  bar  chart 
Proceedings of the 19th Annual Computer Security Applications Conference (ACSAC 2003) 
1063-9527/03 $17.00 © 2003 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:51:38 UTC from IEEE Xplore.  Restrictions apply. 
representation  for  q  =  0.04  should  look  similar.  From 
Figure 9, it can be observed that the minimum number of 
packets needed for paths reconstruction depends primarily 
on  the  path  (from  the  attacker  to  the  reflector)  length 
parameter Len1. For each value of Len1, and let Len2 vary 
from  5  to  30,  the  minimum  number  of  packets  varies  by 
only a small amount, no more than 70, for different values 
of  Len2.  We  can  also  see  that  for  each  value  of  Len1,  a 
non-reflector attack needs slightly more packets than does 
a  reflector  attack.  Such  experimental  results  are  as  what 
have  been  expected  because  any  attack  path  from  the 
reflector  to  the  victim  usually  involves  an  amplified 
number of reflected packets which could be more than the 
minimum  number  for  reconstructing  the  path  from  the 
victim  to  the  reflector.  Note  that  the  number  of  packets 
from the reflectors to the victim is nRf times the number of 
packets from the attacker to the reflectors. Therefore, for a 
given  value  of  Len1,  the  minimum  number  of  packets 
varies only slightly for different values of Len2. We also 
found that the number of reflectors has little effect on the 
results  as 
ten.  As  for 
reconstruction,  there  is  little  difference  between  the 
reconstruction  result  of  using  6000  packets  and  that  of 
using 60000 packets. 
is  greater 
than 
long  as 
it 
Concerning  the  speed  of  attack  paths  reconstruction, 
our  algorithm  can  reconstruct  50  distributed  attack  paths 
with lengths ranging from 20 to 30 within 5 seconds. It is 
obviously  much  faster  than  FMS  [7].  A  good  portion  of 
the  reconstruction  time  is  spent  on  grouping  the  packets. 
When the number of received packets becomes very large, 
say, more than 300,000, the reconstruction time might be 
somehow  longer  than  the  advanced  marking  scheme  [9]. 
However, in practice, the number of marked packets is not 
expected  to  be  too  large;  moreover,  if  necessary,  the 
computation  overhead  on  grouping  the  packets  could  be 
much  reduced  by  using  a  sophisticated  sorting  algorithm 
and some advanced implementation techniques. 
7. Conclusion
We  have  proposed  in  this  paper  a  reflective  algebraic 
marking  scheme  for  tracing  the  ordinary  DoS  attacks,  as 
well  as  reflector  attacks.  Similar  to  the  advanced  and 
authenticated marking scheme [3],  our  proposed  marking 
scheme  also  makes  use  of  an  upstream  routers  map  for 
speeding  up  attack  paths  reconstruction.  In  coping  with 
reflector  attacks,  we  copy  marked  information  from 
incoming request packets to outgoing replied packets. The 
proposed marking scheme can be proved from theory and 
have  been  shown  through  extensive  experiments  that  it 
would  produce  negligible  false  positives  during  attack 
paths  reconstruction.  The  huge  number  of  experiments 
carried  out  demonstrates  that  the  marking  scheme  can 
trace effectively both the general DoS and DDoS attacks, 
including reflector attacks. Up to the present moment, we 
have  not  come  across  any  published  methods  capable  of 
tracing  reflector  attacks.  When  compared  with  other 
methods  in  the  literature,  our  marking  scheme  requires 
relatively  less  packets  for  attack  paths  reconstruction. 
Moreover,  its  attack  paths  reconstruction  could  be  done 
quite fast. We have also shown that the proposed marking 
scheme could be put into practice. 
The  most  fundamental  disadvantage  of  the  proposed 
method is that the marked information is not authenticated. 
Therefore,  a  compromised  router  might  tamper  the 
information marked by its upstream routers and make the 
victim  reconstruct  wrong  paths.  It  limits  our  marking 
scheme to reconstruct only a valid suffix of the real attack 
path; however a compromised router could be regarded as 
an attacker to a certain extent. In our future work, we shall 
develop  a  technique  to  authenticate  the  marked  data  so 
that the compromised routers could be identified. Another 
disadvantage is that our scheme could have difficulty to be 
applied  to  IPv6,  where  the  IP  header  does  not  have  the 
Identification field and the IP address is 128 bits. This is a 
inherited  problem  of  any  marking  traceback  technique. 
We believe a feasible solution could be worked out before 
IPv6 would become widely used. 
References
[1]  Drew  Dean,  Matt  Franklin,  and  Adam  Stubblefield,  “An 
Algebraic  Approach  to  IP  Traceback”,  ACM  Transactions  on 
Information  and  System  Security,  Vol  .5  No.2,  May  2002,  pp. 
119-137. 
[2]  S.  Savage,  D.Wetherall,  A.  Karlin,  and  T.  Anderson, 
“Practical  Network  Support  for  IP  Traceback”,  2000  ACM 
SIGCOMM Conference, Aug. 2000. 
[3]  D.  Song  and  A.  Perrig,  “Advanced  and  Authenticated 
Marking  Schemes  for  IP  Traceback”,  Proc.  IEEE  INFOCOM 
2001.
[4]  W.  H.  Press,  B.  P.  Flannery,  S.  A.  Teukolsky,  and  W.  T. 
Vetterling,  “Numerical  Recipes  in  FORTRAN:  The  Art  of 
Scientific  Computing”,  Cambridge  University  Press,  1992,  pp. 
83-84. 
[5]  Wolfgang  Theilmann  and  Kurt  Rothermel,  “Dynamic 
distance  maps  of 
internet”,  Proc.  IEEE  INFOCOM 
Conference, Vol.1, Mar 2000, pp. 275-284. 
[6]  I  Stoica  and  H.  Zhang,  “Providing  guaranteed  services 
without per flow management”, ACM SIGCOMM ’99, pp. 81–
94, Cambridge, MA, 1999. 
[7] Alex C. Snoeren, Craig Partridge, Luis A. Sanchez, Christine 
E.  Jones,  Fabrice  Tchakountio,  Stephen  T.  Kent,  and  W. 
Timothy  Strayer,  “Hash-Based  IP  Traceback”,  Proc.  ACM 
SIGCOMM 2001, August 2001. 
[8]  Thomas  W.  Judson.  “Abstract  algebra: 
theory  and 
applications”,  Boston,  MA:  PWS  Pub.  Co.,  c1994,  pp.  379.”, 
Boston, MA: PWS Pub. Co., c1994, pp. 379. 
[9].  Vern  Paxson,  “An  Analysis  of  Using  Reflectors  for 
Distributed Denial-of-Service Attacks”,  ACM Comp. Commun. 
Rev., vol.31, no.3, July 2001, pp. 3-14. 
the 
Proceedings of the 19th Annual Computer Security Applications Conference (ACSAC 2003) 
1063-9527/03 $17.00 © 2003 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:51:38 UTC from IEEE Xplore.  Restrictions apply. 
[10].  Lau,  F.,  Rubin,  S.H.,  Smith,  M.H.,  and  Trajkovic,  L, 
“Distributed  denial  of  service  attacks”  Systems,  Man,  and 
Cybernetics, 2000 IEEE International Conference on , Volume: 
3 , 2000, pp. 2275 -2280 vol.3. 
flooding-based 
[11].  Chang,  R.K.C.,  “Defending  against 
IEEE 
distributed  denial-of-service 
Communications  Magazine,  Volume:  40  Issue:  10  ,  Oct  2002, 
pp. 42 -51. 
[12]. Yamada, T., Nakamura, H., Nishimura, K., Ishizaki, T. and 
Ogawa,  K.,  “A  flat-time-delay  transversely  coupled  resonator 
SAW  filter  comprising  parallel  connected  filter 
tracks”, 
Ultrasonics  Symposium,  2000  IEEE  ,  Volume:  1  ,  22-25  Oct. 
2000, pp. 121-124, vol.1. 
tutorial” 
attacks: 
a 
Proceedings of the 19th Annual Computer Security Applications Conference (ACSAC 2003) 
1063-9527/03 $17.00 © 2003 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:51:38 UTC from IEEE Xplore.  Restrictions apply.