OpenDNS (5.08)
5,036
Local-ISP (74.12)
Google (19.32)
LEVEL3 (2.88)
Verizon (0.99)
12,739
Local-ISP (95.50)
ASVPSHOSTING (3.73)
Google (0.69)
CELCOMNET (0.06)
OpenDNS (0.02)
Residential Trafﬁc
15,821
Local-ISP (93.89)
OpenDNS (5.49)
ASVPSHOSTING (0.49) ASVPSHOSTING (0.62) Google (3.05)
LEVEL3 (0.11)
TIGGEE (0.01)
—
5,451
Local-ISP (92.20)
—
ASVPSHOSTING (4.59) —
—
—
—
6,767
Local-ISP (93.08)
Google (6.18)
LEVEL3 (0.09)
OpenDNS (0.03)
LEVEL3 (0.13)
OpenDNS (0.04)
—
—
—
-
—
—
Table 9: Distribution of DNS A/AAAA queries for blocked categories across top 5 DNS resolvers.
the block, the residential porn bandwidth falls by more than half
(averaging 3.7% of HTTP bandwidth post-block).
For SOHO trafﬁc, the average porn bandwidth reduces by a fac-
tor of three. In contrast to video, we do not observe a signiﬁcant
increase in the HTTP-to-SSL trafﬁc ratio in response to porn cen-
sorship, indicating a subset of users either stopped watching porn
or shifted to alternate porn providers.9.
6.2 Impact on User Behavior
Censorship can potentially modify the network behavior of users
or result in new behavior driven by trying to access blocked content.
In this section we assess this possibility by examining the usage of
DNS resolvers and web proxies over time, along with a look at user
browsing activities immediately after encountering the block page.
DNS resolvers. For both censorship events we study, the censor
employed DNS redirection by local ISP resolvers as the primary
means of censorship enforcement. Circumvention to counter this
step only requires using an alternate DNS resolver. Table 9 illumi-
nates the degree to which users pursued this option by examining
the top-5 DNS resolvers used to resolve DNS A or AAAA queries
across the six traces.10 We ﬁnd that prior to censorship, local ISP
servers resolved at least 90% of queries for both categories. Post-
porn censorship, we observe a small increase (≈ 5%) in queries
resolved by Google’s public DNS resolvers, with a correspond-
ing decrease in queries resolved by the ISP. This number rises to
≈ 13% in post-YouTube censorship traces. At the same time, the
queries resolved by local ISP servers drops to 70%, and we see an
increase in queries resolved by OpenDNS and LEVEL-3. The use
of alternate DNS resolvers to circumvent censorship has appeared
in other censorship incidents [37], and potentially increases user
exposure to security risks [12].
Web proxies.
For each trace we identify unique domains
in HTTP requests labeled by McAfee’s categorization service as
Anonymizers. For SOHO trafﬁc, we observe only 1 web proxy
in our additional
9For SOHO trafﬁc,
traces (18Sep12 and
02Aug13) the SSL ratio increases by several orders of magnitude;
however this may instead reﬂect the YouTube censorship that spans
this same timeline.
10To eliminate bias due to automated DNS queries that might po-
tentially use a diverse set of DNS resolvers, we limit our analysis
to queries for the blocked categories, as these unlikely are due to
non-human actors.
prior to the YouTube block, which rises to an average of 41 prox-
ies post-block, with a striking 114 proxies on the day of the block.
Residential trafﬁc shares the same pre-block distribution of web
proxies as SOHO trafﬁc, though with a less dramatic increase
post-block (11.5% on average). From domains extracted from
SSL certiﬁcates, we ﬁnd no proxy hosts in traces prior to the
YouTube block, but after the block we observe 15 and 8 unique
proxy hosts (18Sep12 and 02Aug13, respectively). These hosts
either operate encrypted by default or provide an easy option for
encryption, as conﬁrmed through manual analysis. For example,
the top two, youtubeproxy.org and 12345proxy.net, use
HTTPS by default, and another popular one, 4everproxy.com
lists HTTPS-based proxies prominently on its home page. In addi-
tion, the respondents to our survey indicated that SSL-based soft-
ware such as OpenVPN and Hotspot Shield are among the most
popular circumvention tools. Apparently these tools grew in popu-
larity during the year between our last trace and our survey, as we
did not ﬁnd dominant usage trends for either in our data.
User behavior after viewing block page. We can also gain in-
sight into how users responded to censorship by analyzing their
actions after encountering a block page: in particular, whether they
then attempt to access similar unblocked content, attempt to em-
ploy circumvention, or apparently give up (shift to some other form
of activity).
We assess this as follows: for each user encountering a block
page, we analyze their HTTP transactions in the subsequent 5-
minute window. To reduce ambiguities due to IP aliasing, we con-
ﬁne this analysis to activity from the same address that also uses
the same User Agent, which we assume is likely stable over
short time intervals. (This approach still suffers from the possibil-
ity of multiple users behind a single IP address/NAT who employ
the same user agent [29].) We then examine a histogram of the do-
main names and search keywords11 in the HTTP requests generated
by the users. We observe:
• On average 60% of the users performed a search engine
query after encountering a block page for a porn domain,
and 75% of users did so after encountering a block page
for YouTube. Note that these proportions represent a lower
11We developed signatures to extract keywords from popular search
engine queries.
279Domain Shorthand (% of total porn bandwidth)
Trace
Total (GB)
Blocked domains (%) Unblocked (%)
21Dec11
(a) Residential Trafﬁc (GB)
28Feb12
18Sep12
02Aug13
03Oct11
22Oct11
4.91
7.37
A / 42.3% A / 26.4%
B / 15.4%
B / 12.1%
F / 9.5%
C / 7.9%
D / 7.4%
D / 5.9%
E / 3.2%
E / 3.8%
2.67
2.32
M / 23.2%
I / 22.8%
J / 16.8%
R / 13.7%
¯A / 7.9%
S / 7.3%
T / 4.1%
K / 5.5%
L / 4.1%
U / 3.8%
(b) SOHO Trafﬁc (GB)
0.47
6.71
12.32
3.37
A / 42.4% A / 46.2% M / 27.4%
B / 11.3% D / 12.0%
B / 8.7%
D / 7.5%
C / 5.2%
G / 3.5%
H / 2.7%
E / 3.2%
V / 16.5%
N / 8.3% W / 13.4%
O / 8.3%
X (9.3%
Y / 7.1%
P / 4.8%
Q / 4.6%
F / 6.6%
—
—
—
—
—
—
—
—
—
—
—
—
2.76
1.90
X / 71.7%
R / 14.0%
Z / 12.5%
S / 13.0%
BB / 4.9%
H / 11.1%
AA / 7.8% CC / 1.6%
DD / 1.4%
¯A / 5.5%
Table 10: Top ﬁve porn domains sorted by bandwidth over time.
The top row in parts (a) and (b) represents the total bandwidth in
(GB) per trace. Domains with bar are blocked in the given trace.
Underlined domains are blocked in the next trace. Bold domains
are new domains, not seen in previous traces. Italic domains are
unblocked in the next trace. Others are currently unblocked cases
for which we do not have backward or forward reference.
bound because we lack visibility into encrypted trafﬁc.12 We
ﬁnd that for porn, content-speciﬁc searches heavily dominate
these queries, rather than searches for porn domains, which
matches previous ﬁndings that porn users are ﬂexible about
served content as long as it falls into a broad class [42]. For
YouTube, we ﬁnd a diverse range of primarily informational
queries.13.
• For porn, on average 70% of users who hit a block page ac-
cess another porn domain within the next 5 minutes. For
YouTube, on the day of the block 7% of users viewed a video
using an alternate video content, rising to 12% in 02Aug13.
These ﬁgures run slightly lower than those from our sur-
vey, where 17% of respondents indicated that they would
use an alternate provider to access YouTube videos that they
ﬁnd blocked. Tying this in with our earlier result for search
queries being dominated by information-retrieval intent, we
speculate that users primarily settle for non-video represen-
tations of information, rather than actively searching for al-
ternate/unblocked providers to serve a video.
• Surprisingly, we do not ﬁnd a wide interest in either search-
ing for circumvention mechanisms or directly accessing non-
SSL web proxies within our analysis time window. For porn,
this is perhaps because users have a tendency to shift to other
unblocked porn providers, resulting in little incentive to try
circumvention.
7.
IMPACT ON CONTENT PROVIDERS
Upon the imposition of censorship, users have a range of op-
tions: (i) stop accessing the censored content altogether, (ii) access
the same or similar content hosted by an alternate content provider,
or (iii) employ a censorship-bypass mechanism to directly access
the censored content. The ﬁrst two options lead to the censored
12We ﬁnd that among popular search engines, google.com.pk
has a dominating presence in our data, and also appears in top-5
servers in the SSL logs.
13Queries that represent user intent to obtain information about an
object of interest, with potentially a large number of diverse results.
21Dec11
28Feb12
21Dec11
28Feb12
18Sep12
02Aug13
2.67
2.32
3.37
0.47
2.76
1.90
Residential Trafﬁc
SOHO Trafﬁc
9.00
3.94
0.16
0.29
10.70
0.01
91.00
96.06
99.84
99.71
89.30
99.99
Table 11: Distribution of porn bandwidth among blocked and un-
blocked domains. In 21Dec11 and 28Feb12 the censor only uses
DNS for blocking, hence users can still access blocked content by
using an alternative name server. In 18Sep12, although the censor
uses IP blocking in addition to DNS blocking, its blocking is partial
for some domains. In 02Aug13, the censor uses a combination of
DNS blocking and HTTP redirection.
content provider losing a fraction of its previous trafﬁc, the sec-
ond of these may have a positive impact on the trafﬁc for alternate
content providers. The last option potentially increases costs for
content providers from the perspective of content distribution: they
will have to serve the blocked content remotely, due to the inabil-
ity to deploy local servers in the censored region. Additionally,
if the chosen circumvention mechanism anonymizes user location,
the censored content provider can no longer serve geographically-
relevant advertisements, which may reduce revenue. While our cur-
rent study does not concretely establish the economic implications
of censorship on content providers, we highlight where these may
manifest with a view to motivate further research.
7.1 Video Content
Table 8(a) illustrates the distribution of video bandwidth among
the four major providers before and after the YouTube block. An
overwhelming portion (an average of ≈ 97% across four pre-block
traces) of video content was provided by YouTube, up until the cen-
sorship event concurrent with 18Sep12. On that day, only ≈ 15%
of video content was fetched from YouTube, half of which was be-
ing served by local ISP cache servers, and the other half fetched
from servers located outside Pakistan. Recall that on that day, one
of the two national service providers (with direct international con-
nectivity) redirected YouTube HTTP trafﬁc to one of its own error
pages (Section 4). The residual percentage of YouTube trafﬁc per-
haps reﬂects the providers lacking sufﬁcient capacity to handle the
full load, and thus it failed to consistently redirect trafﬁc.
The following two ﬁndings support this hypothesis. First, the er-
ror page initially appeared only ﬁve minutes into the trace, suggest-
ing that the censorship was already taking place at the time trafﬁc
was captured. Second, we did not ﬁnd evidence of any incomplete
coverage in blocking YouTube’s IP address space: we ﬁnd sets of
IP addresses for which both videos were fetched successfully as
well as users were redirected to the error pages (for different HTTP
requests). The trace collected 11 months later does not manifest
any content served from YouTube. This does not necessarily im-
ply that users stopped accessing the site. Indeed, the percentage
of encrypted trafﬁc increased manyfold (see SOHO trafﬁc in Ta-
ble 7), from about 6% in Feb 2012 to over 30% of total trafﬁc post-
YouTube censorship, potentially indicating the use of SSL-based
censorship bypass mechanisms, as we discussed in Section 6.
Table 8(b) also indicates that post-censorship, most of the video
trafﬁc generated from within Pakistan initially switched to Daily-
Motion (82% of total trafﬁc in 18Sep12), but 11 months later split
between DailyMotion (40.9%) and Tune.pk (57.6%). This trafﬁc
280distribution is unusual considering the global trafﬁc statistics of
DailyMotion (≈ 23x more compared to Tune.pk [2]), thus indi-
cating strong regional popularity. Tune.pk is a Pakistani video por-
tal that essentially provides a censorship-friendly wrapper around
YouTube.
It downloads inoffensive YouTube videos and serves
them from its servers with an option for users to report offensive
videos [41]. The case of Tune.pk highlights the beneﬁts reaped by
local markets due to blocking of a competitor.
The overall shift in trafﬁc potentially leads to a redistribution
of advertisement revenue; the censored content provider loses out
in favor of alternate providers, a shift exacerbated by the fact that
local content owners tend to provide their content through video
sharing sites that remain accessible to their viewers without the
use of any circumvention technology. We ﬁnd such a trend in Ta-
ble 8(c), which shows more and more embedded links shifting from