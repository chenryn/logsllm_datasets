environments. 
17
6  Simulation Results 
We use the ns-2 simulation environment [34] to simulate a data exchange protocol, individually in the baseline 
case without any protection, and with LITEWORP. We distribute the nodes randomly over a square field with a 
fixed average node density. Thus, the field size varies (80×80 m to 204×204 m) with the number of nodes. We use 
a  generic  on-demand  shortest  path  routing  that  floods  route  requests  and  unicasts  route  replies  in  the  reverse 
direction.  A  route,  once  established,  is  not  used  forever  but  is  evicted  from  the  cache  after  a  timeout  period 
expires (TOutRoute). When a malicious node hears a route request, it directs the request to all the malicious nodes 
in the network using an out-of-band channel or using packet encapsulation. For packet encapsulation, we assume 
that the colluding nodes always have a route between them. We simulate the out-of-band channel by letting the 
compromised nodes deliver the packets instantaneously to their colluding parties. These two schemes exercise the 
principal feature of LITEWORP, namely, local monitoring and are the  most challenging to mitigate. Hence, we 
simulate them in preference to other modes of attack. After a wormhole is established, the malicious nodes at each 
end of the wormhole drop all the packets forwarded to them.  
Each node acts as a data source and generates data using an exponential random distribution with inter-arrival 
rate of m. The destination is chosen at random and is changed using an exponential random distribution with rate 
x.  The  input parameters  with  the  experimental  values  are  given  in  Table  2.  The  output parameters  include  the 
isolation latency, the number of data packets dropped due to the wormhole, the number of routes established, and 
the number of routes affected by the wormhole. The simulation also accounts for losses due to natural collisions. 
The isolation latency is calculated from the time a malicious node starts a wormhole attack until it is completely 
isolated  by  all  of  its  neighbors.  The  guards  inform  all  the  neighbors  of  the  detected  malicious  node  through 
multiple unicasts. The output parameters that we present here are obtained by averaging over 30 runs. For each 
run, the malicious nodes are chosen at random such that they are more than 2 hops away from each other. 
Value 
2-8 
1/10 sec 
0-4 
0.5 sec 
Parameter 
Total # nodes (N) 
x 
Channel BW 
T 
Table 2: Input parameter values for LITEWORP simulations 
Parameter 
g 
m 
M 
t 
Parameter 
Tx Range (r) 
NB 
TOutRoute 
b 
Value 
30 m 
8 
50 sec 
5 
Value 
20,50,100,150 
1/200 sec 
40 kbps 
200 
18
Figure 8 shows the number of packets dropped as a function of simulation time for the 100-node setup with 2 
and 4 colluding nodes both with LITEWORP and without LITEWORP.  The attack is started 50 sec after the start of 
the simulation. Since the numbers are vastly different in the two cases, they are shown on separate Y-axes; the 
axis  on  the  left  corresponds  to  the  baseline  case  and  the  axis  to  the  right  corresponds  to  the  system  using 
LITEWORP. In the baseline case, since wormholes are not detected and isolated, the cumulative number of packets 
dropped  continues  to  increase  steadily  with  time.  But  in  the  LITEWORP  case,  as  wormholes  are  identified  and 
isolated permanently, the cumulative number stabilizes. Notice that the cumulative number of packets dropped 
grows for some time even after the wormhole is locally isolated at 75 sec, due to the cached routes that contain 
the wormhole and continue to be used till route timeout occurs.  
100-node scenario
4 w/o LiteWorp
2 w/o LiteWorp
4 w/ LiteWorp
2 w/ LiteWorp
p
r
o
W
e
t
i
L
t
u
o
h
t
i
W
3500
3000
2500
2000
1500
1000
500
0
160
140
120
100
80
60
40
20
0
p
r
o
W
e
t
i
L
h
t
i
W
0
50
100 200 300 400 500 600
Simulation time
Figure 8: Cumulative number of dropped packets 
with and without LITEWORP 
0.80
p
r
o
W
e
t
i
L
t
u
o
h
t
i
W
0.60
0.40
0.20
0.00
0
100-node scenario
fr. dropped
fr. mal routes
fr. dropped (LiteWorp)
fr. mal route(LiteWorp)
1
2
3
# compromised nodes
0.0120
0.0100
0.0080
0.0060
0.0040
p
r
o
W
e
t
i
L
h
t
i
W
0.0020
0.0000
4
Figure 9: Fraction of dropped packets and 
malicious routes with and without LITEWORP  
Figure  9  shows  a  snapshot,  at  simulation  time  of  2000  sec,  of  the  fraction  of  the  total  number  of  packets 
dropped to the total number of packets sent, and the fraction of the total number of routes that involve wormholes 
to the total number of routes established. This is shown for 0-4 compromised nodes for the baseline and with 
LITEWORP. With 0 or 1 compromised node, there is no adverse effect on normal traffic since no wormhole is 
created. The relationship between the number of dropped packets and the number of malicious routes is not linear. 
This  is  because  the  route  established  through  the  wormhole  is  more  heavily  used  by  data  sources  due  to  the 
aggressive nature of the malicious nodes at the ends of the wormhole. If we track these output parameters over 
time, with LITEWORP, they would tend to zero as no more malicious routes are established or packets dropped, 
19
while without LITEWORP they would reach a steady state as a fixed percentage of traffic continues to be affected 
by the undetected wormholes. 
50-node scenario
Sim P(detection)
Ana P(detection)
sim isolation latency
)
n
o
i
t
c
e
t
e
D
P
(
1
0.8
0.6
0.4
0.2
0
30
24
18
12
6
0
y
c
n
e
t
a
l
n
o
i
t
a
o
s
l
I
4
5
7
3
2
1
8
Detection confidence index
6
Figure 10: Detection probability and latency with 
varying g 
Figure  10  bears  out  the  analytical  result  for  the 
detection probability as γ is varied with NB = 15 and M= 
2.  As  γ  increases,  the  detection  probability  goes  down 
due to the need for alarm reporting by a larger number 
of  guards,  in  the  presence  of  collisions.    Also  the 
isolation latency goes up, though it is very small (less 
than  30  s)  even  at 
the  right  end  of 
the  plot.
7  Conclusion and Future Work 
We  propose  to  investigate  the  extension  of  LITEWORP  to  mobile  ad-hoc  and  sensor  networks.  The 
fundamental requirement is the ability of a node to securely determine its first hop and second hop neighbors in 
the  face  of  mobility.  We  can  augment  LITEWORP  with  existing  work  on  dynamic  secure  neighborhood 
determination  protocols,  e.g.,  [15],[16]  to  achieve  the  goal  as  in  static  networks.  However,  we  are  also 
investigating an alternate design of LITEWORP that is customized to mobile networks.  
In this paper, we have presented a taxonomy for attack modes used to launch the wormhole attack in multihop 
wireless networks. We have presented a protocol called LITEWORP that incorporates a detection protocol and an 
isolation protocol. The detection protocol can be applied for detecting each mode of the wormhole attack except 
the protocol deviation. The fundamental mechanism used is local monitoring whereby a node monitors traffic in 
and out of its neighboring nodes and uses a data structure of first and second hop neighbors. LITEWORP isolates 
the malicious node and removes its ability to cause future damage. The coverage analysis of LITEWORP brings out 
the  variation  of  probability  of  missed  detection  and  false  detection  with  increasing  network  density.  The  cost 
analysis shows that LITEWORP has low storage, processing, and bandwidth requirements. These, together with the 
fact that no specialized hardware is required, make the protocol ideally suited to resource-constrained wireless 
networks, such as sensor networks. 
20
8  References 
[1]  B.  Dahill,  B.  N.  Levine,  E.  Royer,  and  C.  Shields,    “A  secure  routing  protocol  for  ad-hoc  networks,”  Electrical 
Engineering and Computer Science, University of Michigan, Tech. Rep. UM-CS-2001-037, August 2001.  
[2]  Y.-C. Hu, D. B. Johnson, and A. Perrig, “SEAD: Secure efficient distance vector routing for mobile wireless ad hoc 
networks,”  in  Proceedings  of  the  4th  IEEE  Workshop  on  Mobile  Computing  Systems  and  Applications  (WMCSA 
2002), June 2002, pp. 3-13.  
[3]  Y.-C.  Hu,  A.  Perrig,  and  D.  B.  Johnson,  “Ariadne:  A  secure  on-demand  routing  protocol  for  ad  hoc  networks,” 
Department of Computer Science, Rice University, Tech. Rep. TR01-383, December 2001. 
[4]  P. Papadimitratos and Z. Haas,  “Secure routing for mobile ad hoc networks,” in SCS Communication Networks and 
Distributed Systems Modeling and Simulation Conference (CNDS 2002), January 2002.  
[5]  C. Intanagonwiwat, R. Govindan, and D. Estrin, “Directed diffusion: A scalable and robust communication paradigm 
for sensor networks,” in Proceedings of the 6th Annual International Conference on Mobile Computing and Networks 
(MobiCOM 00), August 2000.  
[6]  D. Ganesan, R. Govindan, S. Shenker, and D. Estrin, “Highly-resilient, energy-efficient multipath routing in wireless 
sensor networks,” Mobile Computing and Communications Review, vol. 4, no. 5, October 2001.  
[7]  F. Ye, A. Chen, S. Lu, and L. Zhang, “A scalable solution to minimum cost forwarding in large sensor networks,” at 
the 10th International Conference on Computer Communications and Networks (ICCCN), 2001, pp. 304-309. 
[8]  D. Braginsky and D. Estrin,  “Rumor routing algorithm for sensor networks,”  at the 1st ACM International Workshop 
on Wireless Sensor Networks and Applications (WSNA), 2002. 
[9]  C. E. Perkins and P. Bhagwat, “Highly dynamic destination-sequenced distance-vector routing (DSDV) for mobile 
computers,” In ACM SIGCOMM Conference on Communications Architectures, Protocols and Applications, 1994. 
[10] D.  Johnson,  D.  Maltz,  and  J.  Broch,  “The  Dynamic  Source  Routing  Protocol  for  Multihop  Wireless  Ad  Hoc 
Networks,” in Ad Hoc Networking, C. Perkins, Ed., Addison-Wesley, 2001. 
[11] C.  Karlof  and  Y.  Li,  J.  Polastre,  “ARRIVE:  Algorithm  for  Robust  Routing  in  Volatile  Environments,”  Technical 
Report UCB//CSD-03-1233, March 2003. 
[12] C.  Karlof  and  D.  Wagner,  “Secure  Routing  in  Sensor  Networks:  Attacks  and  Countermeasures,”  at  the  1st  IEEE 
International Workshop on Sensor Network Protocols and Applications, May, 2003.  
[13] S. Marti, T. J. Giuli, K. Lai, and M. Baker, “Mitigating routing misbehavior in mobile ad hoc networks,” at the 6th 
ACM International Conference on Mobile Computing and Networking (MobiCOM), 2000. 
[14] Y. C. Hu, A. Perrig, and D.B. Johnson, “Packet leashes: a defense against wormhole attacks in wireless networks,” in 
Proceedings of the 22nd Annual Joint Conference of the IEEE Computer and Communications Societies (INFOCOM), 
pp. 1976-1986, 2003. 
[15] L. Hu and D. Evans, “Using Directional Antennas to Prevent Wormhole attacks,” in Network and Distributed System 
Security Symposium, 2004. 
[16] Y. C. Hu, A. Perrig, and D. Johnson, “Rushing Attacks and Defense in Wireless Ad Hoc Network Routing Protocols,” 
ACM Workshop on Wireless Security (WiSe 2003) September 19, 2003.  
[17] K.  Sanzgiri,  B.  Dahill,  B.  N.  Levine,  C.  Shields,  and  E.  Belding-Royer,  “A  Secure  Routing  Protocol  for  Ad  hoc 
Networks,” in Proceedings of the 10th IEEE International Conference on Network Protocols (ICNP  02), November 
2002. 
[18] S. Zhu, S. Xu, S. Setia, and S. Jajodia, Establishing Pair-wise Keys For Secure Communication in Ad Hoc Networks: 
A  Probabilistic  Approach,  in  the  11th  IEEE  International  Conference  on  Network  protocols  (ICNP’03),  Atlanta, 
Georgia, November 4-7, 2003. 
[19] W. Du, J. Deng, Y. Han, and P. Varshney, “ A Pairwise Key Pre-distribution Scheme for Wireless Sensor Networks,” 
in Proceedings of the 10th ACM conference on Computer and communication security (CCS’03),  Washington D.C., 
USA    October 27-30, 2003. 
[20] D. Liu and P Ning, “Establishing Pair-wise Keys in Distributed Sensor Networks,” in Proceedings of the 10th ACM 
conference on Computer and communication security (CCS’03),  Washington D.C., USA    October 27-30, 2003. 
[21] C. E. Perkins and E. M. Royer, “Ad-Hoc On-Demand Distance Vector Routing,” in Proceedings of the Second IEEE 
Workshop on Mobile Computing Systems and Applications (WMCSA’99), pp. 90-100, February 1990. 
[22] A.  Qayyum,  L.  Viennot,  and  A.  Laouiti,  “Multipoint  Relaying:  An  Efficent  Technique  for  Flooding  in  Mobile 
Wireless Networks,” Technical Report Research Report RR-3898, project HIPEERCOM, INRIA, February 2000. 
21
[23] B. Bellur and R. G. Ogier, “ A Reliable, Efficient Topology Broadcast for Dynamic Networks,” in Proceedings of the 
18th Annual Joint Conference of the IEEE Computer and Communications Societies (INFOCOM’99), pp. 178-186, 
March 1999. 
[24] Defense Advanced Research Projects Agency. Frequently Asked Questions v4 for BAA 01-01, FCS Communications 
Technology. Washington, DC. Available at http://www.darpa.mil/ato/solicit/baa01_01faqv4.doc, October 2000. 
[25] Y.  Ko,  V.  Shankarkumar,  and  N.  Vaidya,  “Medium  access  control  protocols  using  directional  antennas  in  ad  hoc 
networks,” in Proceedings of the 19th Annual Joint Conference of the IEEE Computer and Communications Societies 
(INFOCOM), pages 13–21, 2000. 
[26] R. Choudhury, X. Yang, R. Ramanathan, and N. Vaidya, “Using directional antennas for medium access control in ad 
hoc networks,” at the 8th ACM International Conference on Mobile Computing and Networking (MobiCOM), 2002. 
[27] B.  Awerbuch,  R.  Curtmola,  D.  Holmer,  C.  Nita-Rotaru,  and  H  Rubens,  “Mitigating  Byzantine  Attacks  in  Ad  Hoc 
Wireless  Networks,”  Department  of  Computer  Science,  Johns  Hopkins  University,  Tech.  Rep.  Version  1,    March 
2004. 
[28] S.  Capkun,  L.  Buttyán,  and  J.-P.  Hubaux,  ”SECTOR:  Secure  Tracking  of  Node  Encounters  in  Multi-hop  Wireless 
Networks,” in Proceedings of the 1st ACM workshop on Security of ad hoc and sensor networks (SASN 03), pp.21-32, 
2003. 
[29] D. Liu and P. Ning, “Efficient Distribution of Key Chain Commitments for Broadcast Authentication in Distributed 
Sensor Networks,” in Proceedings of the 10th Annual Network and Distributed System Security Symposium (NDSS), 
pages 263-276, February 2003. 
[30] P.  Kyasanur  and  N.  H.  Vaidya,  “Detection  and  handling  of  MAC  layer  misbehavior  in  wireless  networks,”  in 
Proceedings of the International Conference on Dependable Systems and Networks (DSN ’03), pp. 173- 182, 2003.  
[31] S. Buchegger and J.-Y. Le Boudec, “Performance analysis of the CONFIDANT protocol,” in Proceedings of the 3rd 
ACM  International  Symposium  on  Mobile  Ad  Hoc  Networking  and  Computing  (MobiHoc),  pages  226-236,  June 
2002. 
[32] Ralph C. Merkle, “Protocols for Public Key Cryptosystems,” in Proceedings of the IEEE Symposium on Security and 
Privacy, 1980. 
[33] G.  Bianchi,  “Performance  analysis  of  the  IEEE  802.11  Distributed  Coordination  Function,”  in    IEEE  Journal  on 
Selected Areas in Communications, 18(3):535-547, March 2000. 
[34] “The Network Simulator - ns-2,” At: http://www.isi.edu/nsnam/ns/ 
22