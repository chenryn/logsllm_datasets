title:Digging into Browser-based Crypto Mining
author:Jan R&quot;uth and
Torsten Zimmermann and
Konrad Wolsing and
Oliver Hohlfeld
Digging into Browser-based Crypto Mining
Jan Rüth, Torsten Zimmermann, Konrad Wolsing, Oliver Hohlfeld
Communication and Distributed Systems, RWTH Aachen University, Germany
{lastname}@comsys.rwth-aachen.de
8
1
0
2
p
e
S
1
2
]
R
C
.
s
c
[
2
v
1
1
8
0
0
.
8
0
8
1
:
v
i
X
r
a
ABSTRACT
Mining is the foundation of blockchain-based cryptocurrencies
such as Bitcoin rewarding the miner for finding blocks for new
transactions. The Monero currency enables mining with standard
hardware in contrast to special hardware (ASICs) as often used in
Bitcoin, paving the way for in-browser mining as a new revenue
model for website operators. In this work, we study the prevalence
of this new phenomenon. We identify and classify mining websites
in 138M domains and present a new fingerprinting method which
finds up to a factor of 5.7 more miners than publicly available
block lists. Our work identifies and dissects Coinhive as the major
browser-mining stakeholder. Further, we present a new method to
associate mined blocks in the Monero blockchain to mining pools
and uncover that Coinhive currently contributes 1.18% of mined
blocks having turned over 1293 Moneros in June 2018.
CCS CONCEPTS
• Security and privacy → Malware and its mitigation; • Net-
works → Network measurement;
KEYWORDS
Mining, Cryptocurrency, Monero, Blockchain, Webassembly, Wasm,
Malware, Cryptojacking
ACM Reference Format:
Jan Rüth, Torsten Zimmermann, Konrad Wolsing, and Oliver Hohlfeld. 2018.
Digging into Browser-based Crypto Mining. In IMC ’18: Internet Measure-
ment Conference, October 31–November 2, 2018, Boston, MA, USA. ACM, New
York, NY, USA, 7 pages. https://doi.org/10.1145/3278532.3278539
1 INTRODUCTION
The web economy has traditionally used advertisements as means
to monetize services that are offered free of charge. This business
model relies on the implicit agreement between content providers
and users where viewing ads is the price for the “free” content.
This traditional approach has very recently been complemented
by a new monetizing model in which the computational resources
of website visitors are used to mine cryptocurrencies to generate
revenue for the website operators (browser-based mining).
Mining is the method of producing new blocks in blockchain
systems, most prominently cryptocurrencies such as Bitcoin. It
requires miners to solve a computationally expensive puzzle to
cryptographically link a new block to the previous block in the
IMC ’18, October 31–November 2, 2018, Boston, MA, USA
© 2018 Association for Computing Machinery.
This is the author’s version of the work. It is posted here for your personal use.
Not for redistribution. The definitive Version of Record was published in IMC ’18:
Internet Measurement Conference, October 31–November 2, 2018, Boston, MA, USA,
https://doi.org/10.1145/3278532.3278539.
blockchain. The difficulty to solve this puzzle depends on the com-
bined computing power of all users—depending on the difficulty, an
individual requires powerful machines to increase the probability of
mining a block (e.g., GPUs, FPGAs, or even ASICs). To provide an in-
centive for contributing computational power, miners are awarded
currency for every mined block. This monetary reward has ren-
dered crypto mining a business—browser-based mining extends
this business to monetize the web.
Not all cryptocurrencies are equally suited for browser-based
mining. The hardware imbalance and the consequential high diffi-
culty to mine Bitcoin renders its in-browser mining inefficient and
motivates the use of, e.g., Monero as an alternative currency that can
be efficiently mined on CPUs and thus browsers. Given its design,
Monero has been adopted by websites (e.g., The Piratebay or a video
streaming service with subsequent media exposure [9, 28]) and even
among botnets to mine on millions of compromised hosts [18]. To
ease browser mining, APIs [5, 6] exist, e.g., for in-game financ-
ing [7], link forwarding [16], captchas, during video streaming [10]
or even as an entry fee for parties [15]. Our work identifies Coin-
hive [5] as a widely used service which provides a framework for
embedding a Monero miner into a website. While these frameworks
enable mining without the users’ knowledge (cryptojacking), other
services (Authedmine) actively ask users for their consent to do so
as an alternative to displaying ads. Besides media reports, little is
known about the ubiquity and use of browser-based mining.
Coinhive and dissect their link-forwarding service.
Given these new possibilities, we provide a first in-depth study
of the prevalence and economics of browser-based mining as a new
web business model. We base this perspective on crawls of 137M
.com/.net/.org domains and the Alexa Top 1M list to first identify
sites using browser-based mining enabling to create a new finger-
printing method to identify mining code. Second, we dissect the
short link service of the largest web-mining stakeholder Coinhive
and screen their market power and profits. Our contributions are:
• We investigate the prevalence of browser-mining in the three
largest TLDs and the Alexa Top 1M, i.e., at over 138M domains.
• We present a new Wasm-based fingerprinting method showing
• Moreover, we identify the largest browser-based mining provider
• We present a novel methodology enabling us to associate blocks
• By applying our methodology, we screen Coinhive and show that
they contribute 1.18% of the blocks in the Monero blockchain
mining Moneros worth 150,000 USD per month (as of writing).
Structure. Section 2 establishes the basics of mining. Section 3
measures the prevalence of browser-mining. Section 4 studies the
practices, userbase, and economics of Coinhive. Section 5 discusses
related work and Section 6 concludes the paper.
the inadequate capabilities of block lists to detect mining.
in a privacy-preserving blockchain to a mining pool.
IMC ’18, October 31–November 2, 2018, Boston, MA, USA
Rüth et al.
Figure 1: Monero blockchain and PoW mining input.
2 BROWSER-BASED MINING 101
Blockchain-based cryptocurrencies build on the principle of embed-
ding financial transactions in a public, tamper-proof series of blocks.
To evolve the system, new blocks must constantly be appended to
store pending transactions; their generation is called mining. Miners
solve a crypto puzzle as a proof of work (PoW) whose difficulty is
dynamically adjusted to produce new blocks at a constant block rate
guaranteeing predictability and tamper resistance. Consequently,
when more miners compete for finding blocks, the difficulty rises
such that the block rate is met. When the PoW meets the difficulty,
it links the newly mined block (containing new transactions) to the
previous one rewarding the miner with currency in exchange for
the contributed computing power.
The recent hype around cryptocurrencies has led to substantial
increases in difficulty resulting in the need for faster hardware
to mine blocks profitably w.r.t. the energy costs. To increase the
chance of earning currency, miners seek to increase their available
computational power. This quest for speed is currently served by
GPUs, FPGAs, or even specialized ASICs. One can host substantial
amounts of mining hardware in dedicated data centers. Another
way is to bundle the computing power of multiple miners in mining
pools that share the earned revenue for the newly mined block.
Browser-based Mining. Utilizing the computation power of web-
site visitors provides yet another mean of increasing the mining
power. By embedding mining code into websites, a miner can make
use of the visitor’s CPU resources during the visit. The website oper-
ator thereby saves energy costs and mining hardware investments.
Thus, web-based mining is an alternative revenue generating model
to monetize websites and services. However, hidden mining or with-
out user consent (i.e., cryptojacking) poses a significant challenge
and it is a known attack vector (Section 5). While browser miners
for Bitcoin exist (e.g., jsMiner from 2011 [30]), the performance im-
balance between CPUs, GPUs, and ASICs poses an insurmountable
challenge for Bitcoin browser mining. Consequently, browser-based
mining requires cryptocurrencies with PoW functions that are only
efficiently computable on CPUs.
Monero. Launched in 2014, Monero [25] (see Figure 1) is a privacy-
preserving cryptocurrency whose PoW is designed to be ASIC
resistant (memory intensive and periodically redesigned) enabling
CPUs and thus browser-based mining. Specifically, it uses the Cryp-
tonight hash function [23] in its PoW to mine a new block with an
average block rate of two minutes. Figure 1 shows the PoW inputs;
in Monero, a miner constructs a Merkle tree of the transactions that
are to be included in the new block, requiring at least the Coinbase
Figure 2: NoCoin detected miners on the Alexa Top 1M and
.com/.net/.org domains.
transaction paying the block reward to the miner. A node in this
tree is the hash of its two children with the hash of the transactions
as the leaves of the tree. Including the tree’s root links the trans-
actions to the PoW and the final block. Now the miner’s goal is to
find a nonce such that the PoW output (a hash) meets the global
difficulty (here, literally the product of the hash multiplied by the
difficulty must be smaller than 2256). Thus, a miner needs to draw a
new nonce and recompute the hash until it satisfies this goal. The
network can easily verify that the proof holds through a single
round of hashing, and by including the block in the blockchain,
rewards the miner with the block reward expressed through the
Coinbase transaction. When using mining pools, the pool pushes
jobs (containing the PoW input) asking the miners participating in
the pool to find a nonce that satisfies a lower difficulty than that
of the total network. When this lower difficulty is met, the miner
is awarded a share of the final block reward and if by chance the
actual difficulty is also met, the pool mined a block.
3 PREVALENCE OF BROWSER MINING
We start our analysis of browser-based mining by investigating its
prevalence in the web. Thus, we visit landing pages of a large body
of domains and identify the presence of mining code using two
approaches. Initially, we use a light-weight approach to download
website landing pages via TLS across several datasets, i.e., .com
(∼116M), .net (∼12M), .org (∼9M), and Alexa Top 1M (∼950K), and
match their HTML body against a public filter list (Section 3.1).
Subsequently, we instruct a Chrome browser to visit a subset of
these domains to execute the webpage code and thereby monitor
Websocket interactions and WebAssembly (Wasm) code as preva-
lent techniques for browser-based mining (Section 3.2). We obtain
our datasets through DNS resolutions [11] from zone files available
at Verisign [27] (.net/.com) and PIR [19] (.org).
3.1 NoCoin List
We visit every domain, prefixed with www., via TLS and download
the first 256 kB of the domains’ landing pages using zgrab. 256 kB
offers a good tradeoff between capturing most content (i.e., scripts
are often located in the head of the document) and having a point
where to stop downloading when pages do not stop sending data.
We then extract all javascript tags using lxml to apply the NoCoin
filter list [12]. This list contains regular expressions to detect and
subsequently block mining code using common ad blockers. Fig-
ure 2 shows the number of domains with hits to NoCoin filter rules
Miner’sCoinbase TXmaj: 7min: 7ts: time.now()prev:nonce: ???merkle_root:num_tx: 4…BlockchainMerkle TreeP2P NetworkPending TXNetworkStateDifficultyBlock Reward…PoWInputBlock HeaderTX1TX2TX3TX4TX5TX..?11.01.1811.03.1802.03.1811.05.1827.02.1808.05.1828.02.1809.05.18ScanDate0.000.250.500.751.00NoCoinDetectionShareAlexa.com.net.orgcoinhiveauthedminewp-monerocryptolootcpmstarother71062166765744618553473399#PotentialMiningDomainsDigging into Browser-based Crypto Mining
IMC ’18, October 31–November 2, 2018, Boston, MA, USA
Alexa
Class.
coinhive
skencituer
cryptoloot
UnknownWSS
notgiven688
1
2
3
4
5
Total WebAssembly
.org
Class.
coinhive
cryptoloot
Count
311
123
103 web.stati.bid
56
46
796 WebAssembly
freecontent.date
notgiven688
Count
711
183
120
108
92
1491
NoCoin
Hits
993
978
Alexa
.org
having Wasm
Miner
129
450
Wasm
Hits
737
1372
blocked
by NoCoin
129
450
missed
by NoCoin
608 (82%)
922 (67%)
Table 2: Miners on Chrome data (incl. non-TLS) found
through NoCoin and by our WebAssembly signatures.
Table 1: Top 5 (∼80%) WebAssembly signatures. Most Web-
Assembly are miners (∼96%), dominated by Coinhive.
NoCoin