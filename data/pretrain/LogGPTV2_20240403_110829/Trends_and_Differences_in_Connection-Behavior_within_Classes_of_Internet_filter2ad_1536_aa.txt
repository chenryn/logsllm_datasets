title:Trends and Differences in Connection-Behavior within Classes of Internet
Backbone Traffic
author:Wolfgang John and
Sven Tafvelin and
Tomas Olovsson
Trends and Diﬀerences in Connection-Behavior
within Classes of Internet Backbone Traﬃc
Wolfgang John, Sven Tafvelin, and Tomas Olovsson
Department of Computer Science and Engineering
Chalmers University of Technology, G¨oteborg, Sweden
{johnwolf,tafvelin,tomas}@chalmers.se
Abstract. In order to reveal the inﬂuence of diﬀerent traﬃc classes on
the Internet, backbone traﬃc was collected within an eight month pe-
riod on backbone links of the Swedish University Network (SUNET).
The collected data was then classiﬁed according to network application.
In this study, three traﬃc classes (P2P, Web and malicious) are com-
pared in terms of traﬃc volumes and signaling behavior. Furthermore,
longitudinal trends and diurnal diﬀerences are highlighted. It is shown
that traﬃc volumes are increasing considerably, with P2P-traﬃc clearly
dominating. In contrast, the amount of malicious and attack traﬃc re-
mains constant, even not exhibiting diurnal patterns. Next, P2P and Web
traﬃc are shown to diﬀer signiﬁcantly in connection establishment and
termination behavior. Finally, an analysis of TCP option usage revealed
that Selective Acknowledgment (SACK), even though deployed by most
web-clients, is still neglected by a number of popular web-servers.1
1 Introduction
Today, many network operators do not know which type of traﬃc they are
carrying. This problem emerged mainly in the early 2000’s, when P2P ﬁle sharing
applications started to disguise their traﬃc in order to evade traﬃc ﬁlters and
legal implications. Since then, the network research community started to draw
increasing attention to classiﬁcation of Internet traﬃc. Traditional port number
classiﬁcation was shown to underestimate actual P2P traﬃc volumes by factors
of 2-3 [1], thus more sophisticated classiﬁcation methods have been proposed.
These methods are typically either based on payload signatures [2], statistical
properties of ﬂows [3] or connection patterns [4].
A number of articles also present properties of diﬀerent traﬃc classes resulting
from traﬃc classiﬁcation. Gerber et al. [5] classiﬁed ﬂow measurements from a
tier-1 ISP backbone in 2003. Even if their classiﬁcation method has been based
on port numbers, they indicate a dominance of P2P applications. Sen et al. [6]
investigated connectivity aspects of P2P traﬃc on diﬀerent levels of aggregation
(IP, preﬁx, AS) in 2002. The study was based on ﬂow data collected at a single
ISP, classiﬁed by a port number method. More recent articles from 2005 and 2006
1 This work was supported by SUNET, the Swedish University Network.
M. Claypool and S. Uhlig (Eds.): PAM 2008, LNCS 4979, pp. 192–201, 2008.
c(cid:2) Springer-Verlag Berlin Heidelberg 2008
Trends and Diﬀerences in Connection-Behavior within Classes
193
present diﬀerences between P2P and non-P2P traﬃc in terms of ﬂow properties
such as size, duration and inter-arrival times [7,8]. Perenyi et al. [8] additionally
presents a comparison of diurnal patterns for P2P vs. non-P2P traﬃc.
This article presents the results of a classiﬁcation of current Internet backbone
data. The datasets do not include packet payloads, thus connection pattern
heuristics [9] were used to classify the datasets. The classiﬁcation approach,
disregarding packet payload data, has the advantage of avoiding legal issues and
has the capability to classify even encrypted traﬃc, which is gaining popularity
among P2P traﬃc. We chose to focus on 3 main traﬃc classes: (1) P2P ﬁle
sharing protocols; (2) Web traﬃc; (3) malicious and attack traﬃc. First, we
show how these traﬃc classes develop over a time period of eight months by
highlighting trends in traﬃc volumes and connection numbers, also pointing out
some diurnal diﬀerences. Next, we present diﬀerences between the traﬃc classes
in terms of connection signaling behavior. This includes success rates for TCP
connection establishment, a breakdown of diﬀerent TCP connection termination
possibilities and TCP option usage within established connections.
To our knowledge, this is the ﬁrst attempt to characterize diﬀerences and
trends within traﬃc classes in terms of connection signaling, with exception of
a brief discussion about connection termination in [10]. We provide a thorough
analysis of diﬀerences and trends for the selected traﬃc classes, since they have
a major impact on the overall traﬃc behavior on the Internet. It is of gen-
eral importance to follow trends in contemporary Internet traﬃc in order to
react accordingly in both infrastructure and protocol development. Furthermore
a thorough analysis of speciﬁc connection properties reveals how diﬀerent traf-
ﬁc classes are behaving ’in the wild’. Since the data analyzed was collected on
a highly aggregated backbone during a substantial time period, the results re-
ﬂect contemporary traﬃc behavior of one part of the Internet. These results are
thereby not only valuable input for simulation models, they are also interesting
for developers of network infrastructure, applications and protocols.
2 Data Description
The two datasets used in this article [11] were collected in April (spring dataset)
and in the time from September to November 2006 (fall dataset) on an OC192
backbone link of the Swedish University Network (SUNET). In spring, four traces
of 20 minutes were collected each day at identical times (2AM, 10AM, 2PM,
8PM) as described in [12]. The fall dataset was collected at 276 randomized
times during 80 days. At each random time, a trace of 10 minutes duration was
stored. To avoid bias when comparing the datasets, the 20 minute samples from
spring were treated as two separate 10 minute traces. Furthermore, for this study
traces from fall are only considered if collected during the time-window between
20 minutes prior and after the collection times of spring (e.g. 1:40AM-2:40AM).
When recording the packet level traces on the 2x10GB links, payload beyond
transport layer was removed and IP addresses were anonymized due to privacy
concerns. After further pre-processing of the traces, as described in [11] and
194
W. John, S. Tafvelin, and T. Olovsson
[12], a per-ﬂow analysis was conducted on the resulting bi-directional traces.
Flows are deﬁned by the 5-tuple of source and destination IP, port numbers and
transport protocol (TCP or UDP). TCP ﬂows represent connections, and are
therefore further separated by SYN, FIN and RST packets. For UDP ﬂows, a
ﬂow timeout of 64 seconds was used [4]. The 146 traces in the spring dataset
include 81 million TCP connections and 91 million UDP ﬂows, carrying a total
of 7.5 TB of data. The reduced fall dataset, consisting of 65 traces, includes 49
million TCP connections and 70 million UDP ﬂows, carrying 5 TB of data. In
both datasets, TCP connections are responsible for 96% of all data.
3 Methodology
The resulting 130 million TCP connections and 161 million UDP ﬂows have been
fed into a database, including per-ﬂow information about packet numbers, data
volumes, timing, TCP ﬂags and TCP options. The ﬂows have then been classiﬁed
by use of a set of heuristics based on connection patterns. The classiﬁcation
method was introduced and veriﬁed on the April dataset, as described in [9]. The
heuristics are intended to provide a relatively fast and simple method to classify
traﬃc, which was shown to work well on traces even as short as 10 minutes. In
the present study the ﬂows are summarized into three diﬀerent traﬃc classes:
P2P (ﬁle-sharing); Web or HTTP (incl. HTTPS); Malicious and attack (i.e. scan,
sweep and DoS attacks). Remaining traﬃc was binned in a fourth class, denoted
’others’. ’Others’ includes mail, messenger, ftp, gaming, dns, ntp and remaining
unclassiﬁed traﬃc. The latter accounts for about 1% of all connections. In this
study, the focus is on trends and diﬀerences between P2P and Web traﬃc, with
some notable observations from malicious traﬃc highlighted as well. Besides the
traﬃc classiﬁcation, an analysis of traﬃc volumes and signaling properties is
carried out in two further dimensions: longitudinal trends between April and
November and diurnal patterns between the four time clusters (times of day).
4 Trends in Traﬃc Volumes
Longitudinal trends in TCP traﬃc volumes have been analyzed by building
time series for the three traﬃc classes within each of the four time clusters,
representing times of day (2AM, 10AM, 2PM, 8PM). Due to space limitations,
only a condensed time series of TCP traﬃc is illustrated in Fig.1. The x-axis of
the graphs represent time, with one bar for each 10 minute long trace. The ﬁrst
row indicates an increase in traﬃc volume during 2006. While peak volume per
10 minutes lies at 70 GB in early April, volume reaches 85 GB in late April (right
after Easter vacation). This trend continues, with peaks of 94 GB in September
and ﬁnally 113 GB in November. During one speciﬁc interval on November 8 as
much as 131 GB have been transfered via TCP. All peak intervals fall into the
time cluster of 8PM. The second busiest time cluster in terms of traﬃc volumes
is the one at 2PM. Transfer volumes during 2PM reach on average 80% of the
peak values at 8PM. Nighttime and morning hours (2AM, 10AM) show the
Trends and Diﬀerences in Connection-Behavior within Classes
195
Fig. 1. TCP data vs time (1st row); Appl. breakdown by data(2nd) and #conn.(3rd)
lowest activity with half the transfer volumes of the busy evening hours. This
diurnal pattern is best visible in the April section of the ﬁrst row in Fig.1.
Even if there is an increase in data volumes of around 65% during a time
period of eight months, the breakdown into traﬃc classes remains constant.
P2P applications account constantly for as much as 93% and 91% of the data
during evening and night time, respectively. During oﬃce hours (10AM, 2PM)
the fraction of P2P data is reduced to 86%. HTTP, in contrast, is responsible for
9% of TCP data transfered during oﬃce hours, and drops down to 5% and 4%
during evening and night time. This diurnal diﬀerence is explained by a network
preﬁx analysis, yielding that most P2P traﬃc originates from student dormitories
whereas Web traﬃc is commonly generated by Universities. The remaining data
fractions account mainly for ’other’ traﬃc, since malicious traﬃc and attacks
tend to be single packet ﬂows, not carrying substantial amounts of data.
The traﬃc breakdown in terms of connection numbers clearly shows that P2P
connections typically carry higher amounts of data. Between 40% and 55% of
the connections are classiﬁed as P2P, following the diurnal patterns of traﬃc
volumes. HTTP connections account for 25% of all TCP connections during of-
ﬁce hours, but drop down to 7% at night hours. Interestingly, the fractions of
both P2P and HTTP connections (or connection attempts) increased slightly
from April to November, while the fraction of malicious traﬃc decreased from
around 30% to 20% during the same time. This development turns out to be a
consequence of the constant nature of malicious traﬃc, such as scanning attacks.
In absolute numbers, this traﬃc class remained remarkably constant during the
eight months. Due to the increase in overall traﬃc volume, its relative fraction
evidently was decreased. Since malicious or attack traﬃc shows neither longitu-
dinal trends nor any signiﬁcant diurnal pattern, we conclude that this type of
traﬃc rather forms a constant ’background noise’ in the Internet.
A similar analysis was also done for UDP ﬂows. Even though larger in number,
they are only responsible for 4% of all data. UDP data volumes during 10 minutes
increased from peak values of 2.8 GB in April up to 4.6 GB in November. As in
the case of TCP, peak intervals fall into the 8PM time cluster. Afternoon hours
196
W. John, S. Tafvelin, and T. Olovsson
experience moderate UDP data volumes, and little UDP activity takes place
during night and morning hours.
P2P ﬂows over UDP carry in 76% of all cases less than three packets, which
can be explained by signaling traﬃc as commonly used in P2P overlay networks
such as Kademlia. In April, P2P ﬂows are responsible for around 80% of UDP
data volumes and connection counts, while the fraction has increased to about
84% in November. In absolute numbers, UDP P2P ﬂow counts have even dou-
bled from April until November, which shows that P2P applications deploying
overlay networks via UDP are gaining popularity. Other traﬃc, including tra-
ditional UDP services like NTP or DNS, accounts on average for only 8% of
the UDP ﬂows. As for TCP, malicious traﬃc remains very constant in absolute
numbers, which means that relative fractions decreased from 12% to around 8%
in November.
5 Diﬀerences between Traﬃc Classes
The following subsection highlights diﬀerences between P2P, Web and malicious
connections in terms of establishment and termination behavior. In the next
subsection, TCP option deployment for P2P and Web connections is compared.
5.1 Diﬀerences in Connection Behavior
Fig.2 breaks down the success-rates of connection attempts for the three classes.
Established connections include TCP ﬂows with successfully carried out 3-way-
handshakes. The second group of connection attempts did not fulﬁll 3-way-
handshakes, but included an initial SYN packet. Finally, there are ﬂows with
no SYN seen. These are TCP sessions starting before the measurement interval.
Such session fragments account for 13.5% of the 130 million connections seen.
Malicious traﬃc usually consists of 1-packet ﬂows only, which explains why only
few malicious connection attempts fall into the no SYN category. In the further
analysis, we will only focus on connections including initial SYN packets.
A notable trend can be observed in the P2P graph in Fig.2, where the fraction
of unsuccessful connection attempts increased from an average of 49% in April to
54% in November. Web traﬃc on the other hand has signiﬁcantly larger fractions
Fig. 2. TCP Connection Breakdown
Trends and Diﬀerences in Connection-Behavior within Classes
197
of established connections, leaving only an average of 16.3% non-established.
Malicious traﬃc is more likely to be established in the fall data, even though a
majority of the malicious connections are still connection attempts. The increase
in established attack connections is caused by an increase in login attempts to
MS-SQL and SSH servers, with a few MS-SQL servers at a local University
responsible for the majority of the attempts. According to SANS Internet Storm
Center (ISC), malicious activities on both SSH (22) and MS-SQL (1433) ports
increased signiﬁcantly during 2006, which explains the trends seen here.