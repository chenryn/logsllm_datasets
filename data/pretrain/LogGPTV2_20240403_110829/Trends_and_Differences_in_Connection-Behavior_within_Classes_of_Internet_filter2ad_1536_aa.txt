# Trends and Differences in Connection-Behavior within Classes of Internet Backbone Traffic

**Authors:**
- Wolfgang John
- Sven Tafvelin
- Tomas Olovsson

**Affiliation:**
Department of Computer Science and Engineering, Chalmers University of Technology, Göteborg, Sweden

**Contact:**
- {johnwolf, tafvelin, tomas}@chalmers.se

## Abstract

To understand the impact of different traffic classes on the Internet, backbone traffic was collected over an eight-month period from the Swedish University Network (SUNET). The data was classified based on network applications. This study compares three traffic classes—P2P, Web, and malicious—in terms of traffic volumes and signaling behavior. Longitudinal trends and diurnal differences are also highlighted. The results show a significant increase in traffic volumes, with P2P traffic being the dominant class. In contrast, the amount of malicious and attack traffic remains constant, without exhibiting diurnal patterns. Additionally, P2P and Web traffic exhibit distinct connection establishment and termination behaviors. An analysis of TCP option usage revealed that Selective Acknowledgment (SACK), although widely deployed by web clients, is still underutilized by many popular web servers.

## 1. Introduction

Many network operators today lack a clear understanding of the types of traffic they carry. This issue became prominent in the early 2000s when P2P file-sharing applications began disguising their traffic to evade filters and legal implications. Since then, the network research community has increasingly focused on classifying Internet traffic. Traditional port number classification methods have been shown to underestimate actual P2P traffic volumes by factors of 2-3 [1], leading to the development of more sophisticated methods based on payload signatures [2], statistical flow properties [3], or connection patterns [4].

Several studies have explored the properties of different traffic classes. Gerber et al. [5] classified flow measurements from a tier-1 ISP backbone in 2003, indicating a dominance of P2P applications despite using port number-based classification. Sen et al. [6] investigated connectivity aspects of P2.P traffic at different levels of aggregation (IP, prefix, AS) in 2002, using a single ISP's flow data. More recent studies from 2005 and 2006 [7,8] highlight differences between P2P and non-P2P traffic in terms of flow properties such as size, duration, and inter-arrival times. Perenyi et al. [8] also compared diurnal patterns for P2P vs. non-P2P traffic.

This article presents the results of a classification of current Internet backbone data. The datasets do not include packet payloads, so connection pattern heuristics [9] were used for classification. This approach avoids legal issues and can classify even encrypted traffic, which is becoming more common among P2P traffic. We focus on three main traffic classes: (1) P2P file-sharing protocols; (2) Web traffic; (3) malicious and attack traffic. We analyze how these traffic classes evolve over eight months, highlighting trends in traffic volumes and connection numbers, as well as diurnal differences. We also present differences in connection signaling behavior, including TCP connection establishment success rates, termination possibilities, and TCP option usage.

To our knowledge, this is the first attempt to characterize differences and trends within traffic classes in terms of connection signaling, except for a brief discussion about connection termination in [10]. Our thorough analysis of the selected traffic classes provides valuable insights into overall traffic behavior on the Internet. Understanding these trends is crucial for both infrastructure and protocol development. Furthermore, analyzing specific connection properties reveals how different traffic classes behave in real-world scenarios. The data analyzed was collected on a highly aggregated backbone over a substantial period, making the results reflective of contemporary traffic behavior on a part of the Internet. These findings are not only useful for simulation models but also for developers of network infrastructure, applications, and protocols.

## 2. Data Description

The two datasets used in this study [11] were collected in April (spring dataset) and from September to November 2006 (fall dataset) on an OC192 backbone link of the Swedish University Network (SUNET). In spring, four 20-minute traces were collected each day at fixed times (2 AM, 10 AM, 2 PM, 8 PM) as described in [12]. The fall dataset was collected at 276 randomized times over 80 days, with each trace lasting 10 minutes. To ensure comparability, the 20-minute samples from the spring dataset were treated as two separate 10-minute traces. For this study, fall traces were considered only if collected within a 20-minute window around the spring collection times (e.g., 1:40 AM-2:40 AM).

During the recording of packet-level traces on the 2x10GB links, transport layer payload was removed, and IP addresses were anonymized due to privacy concerns. After further preprocessing [11, 12], a per-flow analysis was conducted on the resulting bidirectional traces. Flows were defined by the 5-tuple of source and destination IP, port numbers, and transport protocol (TCP or UDP). TCP flows represent connections and were further separated by SYN, FIN, and RST packets. For UDP flows, a 64-second timeout was used [4]. The spring dataset includes 81 million TCP connections and 91 million UDP flows, carrying 7.5 TB of data. The reduced fall dataset, consisting of 65 traces, includes 49 million TCP connections and 70 million UDP flows, carrying 5 TB of data. In both datasets, TCP connections account for 96% of all data.

## 3. Methodology

The 130 million TCP connections and 161 million UDP flows were stored in a database, including per-flow information about packet numbers, data volumes, timing, TCP flags, and TCP options. The flows were classified using heuristics based on connection patterns [9]. The heuristics provide a fast and simple method for classifying traffic, which works well even on short 10-minute traces. The flows were categorized into three traffic classes: P2P (file-sharing), Web or HTTP (including HTTPS), and malicious and attack (e.g., scans, sweeps, and DoS attacks). Remaining traffic was grouped into a fourth class, "others," which includes mail, messenger, FTP, gaming, DNS, NTP, and unclassified traffic. The latter accounts for about 1% of all connections.

This study focuses on trends and differences between P2P and Web traffic, with some notable observations from malicious traffic. Besides traffic classification, we analyze traffic volumes and signaling properties in two dimensions: longitudinal trends between April and November and diurnal patterns across four time clusters (times of day).

## 4. Trends in Traffic Volumes

Longitudinal trends in TCP traffic volumes were analyzed by building time series for the three traffic classes within each of the four time clusters, representing times of day (2 AM, 10 AM, 2 PM, 8 PM). Due to space limitations, only a condensed time series of TCP traffic is illustrated in Figure 1. The x-axis represents time, with one bar for each 10-minute trace. The first row shows an increase in traffic volume during 2006. While the peak volume per 10 minutes was 70 GB in early April, it reached 85 GB in late April (right after Easter vacation). This trend continued, with peaks of 94 GB in September and 113 GB in November. During a specific interval on November 8, as much as 131 GB were transferred via TCP. All peak intervals fell into the 8 PM time cluster. The second busiest time cluster in terms of traffic volumes is the 2 PM cluster, with transfer volumes reaching 80% of the peak values at 8 PM. Nighttime and morning hours (2 AM, 10 AM) showed the lowest activity, with half the transfer volumes of the busy evening hours. This diurnal pattern is most visible in the April section of the first row in Figure 1.

Even though there was a 65% increase in data volumes over eight months, the breakdown into traffic classes remained relatively constant. P2P applications consistently accounted for 93% and 91% of the data during evening and night hours, respectively. During office hours (10 AM, 2 PM), the fraction of P2P data dropped to 86%. HTTP, in contrast, was responsible for 9% of TCP data transferred during office hours and decreased to 5% and 4% during evening and night hours. This diurnal difference is explained by a network prefix analysis, showing that most P2P traffic originates from student dormitories, while Web traffic is commonly generated by universities. The remaining data fractions mainly consist of "other" traffic, as malicious traffic and attacks tend to be single-packet flows, not carrying substantial amounts of data.

The traffic breakdown in terms of connection numbers clearly shows that P2P connections typically carry higher amounts of data. Between 40% and 55% of the connections were classified as P2P, following the diurnal patterns of traffic volumes. HTTP connections accounted for 25% of all TCP connections during office hours but dropped to 7% at night. Interestingly, the fractions of both P2P and HTTP connections (or connection attempts) increased slightly from April to November, while the fraction of malicious traffic decreased from around 30% to 20% during the same period. This development is a consequence of the constant nature of malicious traffic, such as scanning attacks. In absolute numbers, this traffic class remained remarkably constant over the eight months, but its relative fraction decreased due to the overall increase in traffic volume. Since malicious or attack traffic shows neither longitudinal trends nor significant diurnal patterns, we conclude that this type of traffic forms a constant "background noise" on the Internet.

A similar analysis was conducted for UDP flows. Although larger in number, they were responsible for only 4% of all data. UDP data volumes during 10 minutes increased from peak values of 2.8 GB in April to 4.6 GB in November. As with TCP, peak intervals fell into the 8 PM time cluster. Afternoon hours experienced moderate UDP data volumes, and little UDP activity occurred during night and morning hours.

P2P flows over UDP carried less than three packets in 76% of cases, which can be explained by signaling traffic commonly used in P2P overlay networks such as Kademlia. In April, P2P flows were responsible for around 80% of UDP data volumes and connection counts, increasing to about 84% in November. In absolute numbers, UDP P2P flow counts doubled from April to November, indicating that P2P applications deploying overlay networks via UDP are gaining popularity. Other traffic, including traditional UDP services like NTP or DNS, accounted for only 8% of the UDP flows on average. As with TCP, malicious traffic remained very constant in absolute numbers, with relative fractions decreasing from 12% to around 8% in November.

## 5. Differences between Traffic Classes

### 5.1 Differences in Connection Behavior

Figure 2 breaks down the success rates of connection attempts for the three classes. Established connections include TCP flows with successfully completed 3-way handshakes. The second group of connection attempts did not complete 3-way handshakes but included an initial SYN packet. Finally, there are flows with no SYN seen, which are TCP sessions starting before the measurement interval. Such session fragments accounted for 13.5% of the 130 million connections observed. Malicious traffic usually consists of 1-packet flows, explaining why few malicious connection attempts fall into the no SYN category. In the further analysis, we focus on connections including initial SYN packets.

A notable trend can be observed in the P2P graph in Figure 2, where the fraction of unsuccessful connection attempts increased from an average of 49% in April to 54% in November. Web traffic, on the other hand, had significantly larger fractions of established connections, leaving only an average of 16.3% non-established. Malicious traffic was more likely to be established in the fall data, even though a majority of the malicious connections were still connection attempts. The increase in established attack connections was caused by an increase in login attempts to MS-SQL and SSH servers, with a few MS-SQL servers at a local university responsible for the majority of the attempts. According to the SANS Internet Storm Center (ISC), malicious activities on both SSH (port 22) and MS-SQL (port 1433) increased significantly during 2006, explaining the trends observed here.