any in-depth analysis of malicious IP addresses included in
the responses. Moreover, and most importantly, the project
has been discontinued since January 2017.
Another project, which is called the shadowserver dnss-
can [21], provides daily information on the number and geo-
graphical distribution of open resolvers, but does not specif-
ically analyze the behavior of each open resolver. Therefore,
it is difﬁcult to use the result of this project for understanding
the threat of open resolvers in such relevant details. This is
because the decrease in the number of open resolvers, as
pointed by our work, does not directly mean that the associated
threats are also reduced. Just as the number of open resolvers
showing malicious behavior has increased, an in-depth analysis
of their behavior is required for an accurate understanding of
the role of open resolver on the Internet.
Censys [30] and Rapid7 [31] also provide weekly (censys)
or monthly (rapid7) scan using ZMap. These raw scan datasets
are more useful in that the DNS response packets can be
inspected, but still have limitations. First, this raw dataset is
from the measurement result only using prober, not the author-
itative name server. As shown in Fig. 2, if the measurement
is conducted only at the prober, we cannot catch the packet
ﬂow of R1 and Q2, which makes it difﬁcult to investigate the
behavior of open resolvers in-depth. Moreover, because both
repositories use ZMap as a scanning tool, these datasets may
have a blind spot that ZMap has. For example, the current
ZMap can miss packets in that it only stores results for the
responses from the target port of the scan (e.g., DNS responses
only from port 53). This incomplete measurement can lead to
the underestimation of the threat of misbehaving resolvers.
To this end, we believe a systematic and constant follow-
up of the behavioral analysis in the open resolver ecosystem
is a gap in the literature, and is needed for improving DNS
security. For understanding the behavioral changes in open
resolvers and ﬁnding countermeasures against the malicious
activities such a steady observation is required.
Private Network in Incorrect Information. In Table VIII,
we show that four of the top 10 IP addresses with the
incorrect R2 responses in 2018 are addresses in private net-
works (196.168.1.1, 192.168.2.1, 172.30.1.254, and 10.0.0.1).
Besides the Top 10, several private networks appeared in the
incorrect responses as well.
We speculate multiple scenarios that could lead to such a
behavior. For example, landing on such a private network may
be a redirection to a webpage for the user’s consent or form
submission in a public network (e.g., Wi-Fi in airport). It is
also likely to be a similar redirection in the responses with
the particular company’s IP address. However, in the case of
a private network, and given the fact that our DNS query was
sent from outside the network, this behavior is difﬁcult to
accurately understand. If it is a DNS server for users inside
the network, it means that the connection is also allowed from
the outside. For accurate analysis, we will conduct an in-depth
analysis that focuses on these behaviors as a future work.
Open Resolver as an Existent Threat. In section II-C, we
described two threats that open resolvers can bring about:
DNS ampliﬁcation (DDoS attacks) and DNS manipulation.
In our analysis, we found that there are millions of open
resolvers still exist in the wild, which allows us to deduce that
these resolvers can be exploited by adversaries for launching
ampliﬁcation attacks. The number of open resolvers around
the world can be equated to the magnitude of the potential
threat as it is a threat from the functional loophole of the
open resolver (no veriﬁcation method for spoofed source IP
address is in place). The mere existence of open resolvers and
the adversary’s malice are a guarantee for an attack.
However, in terms of DNS manipulation, the existence of
malicious open DNS resolvers may not directly correspond
to an actual threat. This is due to the passive role of open
resolvers in DNS resolution. A malicious open resolver can
perform its (malicious) actions only when it receives a domain
502
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:55:40 UTC from IEEE Xplore.  Restrictions apply. 
name resolution request. If no user queries the malicious
open resolver,
the manipulated DNS record is essentially
meaningless. At this point, we need to see how malicious open
resolvers are actually queried by legitimate users. Moreover, it
would be further important research topic to investigate how
malicious open resolvers attract legitimate users, which is our
future work.
To answer these questions, we plan to conduct a follow-
up analysis to investigate the actual use of malicious open
resolvers with the annual Day In The Life of the Internet
(DITL) collection from Domain Name System Operations
Analysis and Research Center (DNS-OARC). Through the
analysis combined with the DITL data, we expect to measure
the actual impact of malicious open resolvers.
VI. RELATED WORK
Open resolvers can be attacked and abused to conduct
wide variety of attacks on behalf of the attackers. Therefore,
researchers have done a lot of work to understand open DNS
resolvers and associated threats.
Internet-Wide Scanning. Durumeric et al. [32] proposed
ZMap, a high-speed application to run Internet-wide scans
capable of surveying the IPv4 address space within 1 hour on
a single machine. In addition, Open Resolver Project [4] is a
project that actively investigates DNS servers world-wide since
March 2013 and regularly provides open resolver statistics on
the web. One can browse information of open resolvers from
March 2013 until January 2017. Moreover, Shadowserver [21]
is an organization that conducts surveys related to Internet
security, and they also conduct active measurements of open
resolvers. Takano et al. [8] focused on DNS server software
and their distribution and performed measurements.
DNS Measurement. A large body of work exists on analyzing
DNS resolvers, however most of them focused only on a
small subset of resolvers. Therefore,
is unclear if the
observed results can be generalized to all resolvers around
the globe. For instance, Sisson [14] analyzed open resolvers
based on sampled scans that repeatedly queried the same set
of resolvers, thus covering only a small fraction of all open
resolvers. Furthermore, Jiang et al. [33] analyzed the caching
behavior of resolvers. The authors identiﬁed an attack vector
in DNS software that allows to extend the caching of domains
even after they have been removed from the upper DNS hier-
archy. Schomp et al. [34] randomly probed the IPv4 address
space to enumerate DNS resolvers and distinguish between
recursive DNS resolvers and DNS proxies. Furthermore, the
authors closely analyzed the caching behavior of resolvers in
more detail. Gao et al. [35] analyzed a large set of DNS
query-response pairs collected from over 600 recursive DNS
resolvers. They observed that although there is a great variation
in the characteristics of the DNS trafﬁc across networks, the
behavior of resolvers within an organization is very similar.
In addition, Scott et al. [36] analyzed DNS resolutions by
probing the IPv4 address space for open resolvers. Top 10,000
Alexa domain names at the identiﬁed resolvers were queried
to analyze the infrastructure of the Content Delivery Networks
it
(CDNs). By deploying the automated clustering algorithms,
they detected CDN deployments in their scanning results.
Hao et al. [37] conducted a large-scale measurement to ﬁgure
out the authoritative DNS deployment patterns of modern web
services and their characteristics. In addition, Thomas and
Mohaisen [38] conducted a measurement of the leakage of
Tor’s .onion in global DNS.
DNS Manipulation and Poisoning. As the role of DNS on the
Internet becomes more and more important, research on DNS
poisoning or manipulation has been actively conducted. Here,
we introduce a couple of representative works about DNS
manipulation. Antonakakis et al. [6] analyzed geographically
diverse set of about 300,000 open recursive DNS servers
and found that attackers generally point victims to rogue IP
addresses. Kuhrer et al. [9] tried to shed light on the negative
aspect of open resolvers which can be abused by attackers. The
authors measured the response authenticity of the resolvers
from users’ point of view and found that a large number
of resolvers intentionally manipulate DNS resolutions. This
work is similar to our study, but different
in two points.
First, we deal with more comprehensive behavioral aspects of
open resolvers including how to ﬁll the DNS header. Second,
the previous work only focused on the manipulation for
phishing, so they parsed and analyzed the HTTP ﬁle from the
resolved address to identify the webpage for phishing purpose.
In contrast, our work covers the wider scope of malicious
activities including malware, phishing, botnet, etc. Schomp
et al. [10] measured the vulnerability of the user-side DNS
infrastructure to record injection threats and found that many
open DNS resolvers, which are vulnerable to record injection
attack, are being abused to attack shared DNS infrastructure.
The recent work also highlighted that more than 92% of DNS
resolution platforms are vulnerable to cache injection [39]. On
the other hands, there have been lots of works to improve the
consistency of DNS cache [40], [41], [42].
Many studies for dealing with DNS manipulation also have
been proposed. DNSSEC provides the authentication and data
integrity, which allows it to counter the DNS manipulation.
However, DNSSEC did not yet completely replace DNS,
which leaves a threat to malicious behavior on DNS. There
are also studies for estimating the open resolvers supporting
DNSSEC validation in real networks [43], [44]. Perdisci et
al. [45] proposed a WSEC DNS as a solution for DNS
poisoning attack. By combining the use of wildcard domain
name and TXT resource, WSEC DNS can protect the recursive
name server against the poisoning attack. Recently, Pearce
et al. [11] proposed a scalable and lightweight system, Iris,
to detect and measure DNS manipulation. It performs DNS
queries through geographically distributed DNS resolvers and
analyzes the responses.
VII. CONCLUSION
In this study, we conducted an up-to-date measurement of
the distribution and behavior of open resolvers. Through an
Internet-wide probing, we can see that about 3 million open
resolvers still exist on the Internet and many of them operate
503
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:55:40 UTC from IEEE Xplore.  Restrictions apply. 
in a way that deviates from the standard. From the result, we
detected two threats posed by open resolvers.
First, the presence of millions of open resolver increases the
threat of a DNS ampliﬁcation DDoS attack. The adversary can
exploit open resolvers as an ampliﬁer by simply sending DNS
‘ANY’ queries to them, which results in the concentration of
large DNS answers to the victim. Moreover, we also found
evidence suggesting open resolvers’ abnormal behaviors. The
ﬂag bits in the DNS response from open resolvers are often
inappropriately marked. More than 69k open resolvers in 2018,
for example, state that they are not recursion available (RA bit
of 0) although they include the result of recursive resolution.
More seriously, it is also shown that over 110k open resolvers
provide the incorrect IP address as a DNS response, while
more than 26k open resolvers return the IP addresses reported
as malware, phishing, etc.
A comparison between a recent scan and data obtained in
2013 shows the threat of DNS manipulation has increased,
despite the decrease in the number of open resolvers. This
result stresses the need of continuous observations of those
resolvers to understand and mitigate their risk.
Acknowledgement. We thank our shepherd Kaustubh Joshi
and the anonymous reviewers for their feedback and sugges-
tions. This work is supported in part by NSF grant CNS-
1809000 and NRF grant 2016K1A1A2912757.
REFERENCES
[1] “Public DNS - google developers.” https://developers.google.com/speed/
public-dns/.
//www.opendns.com.
[2] “Cloud
delivered
enterprise
security
by
opendns.”
https:
[3] M. K¨uhrer, T. Hupperich, C. Rossow, and T. Holz, “Exit from hell?
reducing the impact of ampliﬁcation ddos attacks,” in Proceedings of
the USENIX Security Symposium, 2014.
[4] Open Resolver Project. http://openresolverproject.org/.
[5] D. Dagon, N. Provos, C. P. Lee, and W. Lee, “Corrupted DNS resolution
paths: The rise of a malicious resolution authority,” in Proceedings of
the Network and Distributed System Security Symposium (NDSS), 2008.
[6] M. Antonakakis, D. Dagon, X. Luo, R. Perdisci, W. Lee, and J. Bellmor,
“A centralized monitoring infrastructure for improving DNS security,”
in proceedings of the International Symposium on Recent Advances in
Intrusion Detection (RAID), 2010.
[7] CloudFlare, “The ddos that knocked spamhaus ofﬂine (and how we mit-
igated it).” http://blog.cloudﬂare.com/the-ddos-that-knocked-spamhaus-
ofﬂine-and-ho, 2013.
[8] Y. Takano, R. Ando, T. Takahashi, S. Uda, and T. Inoue, “A measurement
study of open resolvers and dns server version,” in Proceedings of the
Internet Conference (IC), 2013.
[9] M. K¨uhrer, T. Hupperich, J. Bushart, C. Rossow, and T. Holz, “Going
wild: Large-scale classiﬁcation of open DNS resolvers,” in Proceedings
of the ACM Internet Measurement Conference (IMC), 2015.
[10] K. Schomp, T. Callahan, M. Rabinovich, and M. Allman, “Assessing
DNS vulnerability to record injection,” in Proceedings of the Interna-
tional Conference on Passive and Active Measurement (PAM), 2014.
[11] P. Pearce, B. Jones, F. Li, R. Ensaﬁ, N. Feamster, N. Weaver, and
V. Paxson, “Global measurement of DNS manipulation,” in Proceedings
of the USENIX Security Symposium, 2017.
[12] N. Weaver, C. Kreibich, and V. Paxson, “Redirecting DNS for ads and
proﬁt,” in Proceedings of the USENIX Workshop on Free and Open
Communications on the Internet (FOCI), 2011.
[13] B. Ager, W. M¨uhlbauer, G. Smaragdakis, and S. Uhlig, “Comparing
the ACM Internet
DNS resolvers in the wild,” in Proceedings of
Measurement Conference (IMC), 2010.
[14] G. Sisson, “Dns
survey: October 2010.” http://dns.measurement-
factory.com/surveys/201010/dns survey 2010.pdf, 2010.
[15] P. V. Mockapetris, “Domain names: Implementation speciﬁcation.” IETF
RFC 883, 1983.
[16] M. Thomas and A. Mohaisen, “Kindred domains: detecting and clus-
tering botnet domains using dns trafﬁc,” in Proceedings of the ACM
International Conference on World Wide Web (WWW), 2014.
[17] J. Damas, M. Graff, and P. Vixie, “Extension mechanisms for DNS
(EDNS(0)).” IETF RFC 6891, 2013.
[18] Z. Durumeric, E. Wustrow, and J. A. Halderman, “Zmap: Fast internet-
wide scanning and its security applications.,” in Proceedings of the
USENIX Security Symposium, 2013.
[19] Vultr. https://www.vultr.com/.
[20] GoDaddy. https://www.godaddy.com/.
[21] Shadowserver. https://dnsscan.shadowserver.org/.
[22] P. V. Mockapetris, “Domain names - implementation and speciﬁcation.”
IETF RFC 1035, 1987.
1034, 1987.
RFC 6895, 2013.
[23] P. V. Mockapetris, “Domain names - concepts and facilities.” IETF RFC
[24] D. Eastlake, “Domain name system (dns) iana considerations.” IETF
[25] R. Tracker. https://ransomwaretracker.abuse.ch/ip/208.91.197.91/.
[26] Cymon. https://cymon.io/208.91.197.91.
[27] C. API. http://docs.cymon.io/.
[28] IP2location. https://lite.ip2location.com/.
[29] I. O. for Standardization. https://www.iso.org/obp/ui/#search.
[30] Censys. https://censys.io/data/.
[31] Rapid7. https://opendata.rapid7.com/.
[32] Z. Durumeric, E. Wustrow, and J. A. Halderman, “Zmap: Fast internet-
wide scanning and its security applications,” in Proceedings of the 22th
USENIX Security Symposium, pp. 605–620, 2013.
[33] J. Jiang, J. Liang, K. Li, J. Li, H. Duan, and J. Wu, “Ghost domain
names: Revoked yet still resolvable,” in Proceedings of the Network
and Distributed System Security Symposium (NDSS), 2012.
[34] K. Schomp, T. Callahan, M. Rabinovich, and M. Allman, “On measuring
the client-side DNS infrastructure,” in Proceedings of the ACM Internet
Measurement Conference (IMC), 2013.
[35] H. Gao, V. Yegneswaran, Y. Chen, P. A. Porras, S. Ghosh, J. Jiang,
and H. Duan, “An empirical reexamination of global DNS behavior,” in
Proceedings of the ACM SIGCOMM conference, 2013.
[36] W. Scott, S. Berg, and A. Krishnamurth, “Satellite: Observations of the
internet’s star,” tech. rep., University of Washington, 2015.
[37] S. Hao, H. Wang, A. Stavrou, and E. Smirni, “On the dns deployment
of modern web services,” in 2015 IEEE 23rd International Conference
on Network Protocols (ICNP), pp. 100–110, IEEE, 2015.
[38] M. Thomas and A. Mohaisen, “Measuring the leakage of onion at the
root: A measurement of tor’s. onion pseudo-tld in the global domain
name system,” in Proceedings of the ACM Workshop on Privacy in the
Electronic Society (WPES), 2014.
[39] A. Klein, H. Shulman, and M. Waidner, “Internet-wide study of dns
cache injections,” in Proceedings of the IEEE Conference on Computer
Communications (INFOCOM), 2017.
[40] X. Chen, H. Wang, S. Ren, and X. Zhang, “Maintaining strong cache
consistency for the domain name system,” IEEE Transactions on Knowl-
edge and Data Engineering, vol. 19, no. 8, pp. 1057–1071, 2007.
[41] S. Hao and H. Wang, “Exploring domain name based features on the ef-
fectiveness of dns caching,” ACM SIGCOMM Computer Communication
Review, vol. 47, no. 1, pp. 36–42, 2017.
[42] X. Chen, H. Wang, and S. Ren, “Dnscup: Strong cache consistency
protocol for dns,” in Distributed Computing Systems, 2006. ICDCS 2006.
26th IEEE International Conference on, pp. 40–40, IEEE, 2006.
[43] K. Fukuda, S. Sato, and T. Mitamura, “A technique for counting
dnssec validators,” in Proceedings of the IEEE Conference on Computer
Communications (INFOCOM), 2013.
[44] Y. Yu, D. Wessels, M. Larson, and L. Zhang, “Check-repeat: A new
method of measuring dnssec validating resolvers,” in Proceedings of the
IEEE Conference on Computer Communications Workshops (INFOCOM
WKSHPS), 2013.
[45] R. Perdisci, M. Antonakakis, X. Luo, and W. Lee, “WSEC DNS: Pro-
tecting recursive DNS resolvers from poisoning attacks,” in Proceedings
of the IEEE/IFIP International Conference on Dependable Systems &
Networks (DSN), 2009.
504
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 10:55:40 UTC from IEEE Xplore.  Restrictions apply.