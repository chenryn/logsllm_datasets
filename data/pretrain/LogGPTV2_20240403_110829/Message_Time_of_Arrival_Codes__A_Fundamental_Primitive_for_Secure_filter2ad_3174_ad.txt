0
10
20
t
30
Figure 11. Legitimate (blue) and attack (red) signals in a scenario with four bits and 10 bits per symbol and repetition coding. The ﬁrst plot shows the
shape of the transmitted signal. The attack signal is winning since each bit contains sufﬁcient power, despite the attacker only guessing 2 out of 10 pulses
per symbol. The second plot shows the noisy signals at the receiver. The third plot shows the received signal after removing the data modulation. The
residual after the expected signal component has been removed is shown in the rightmost plot. It becomes evident that the attack residual can be discerned
easily from the legitimate residual, despite the attack on repetition coding (i.e., the bit level) being successful.
6.3. Variance-Based MTAC: Summary
To summarize and illustrate how to embed the Variance-
Based MTAC into a distance-measurement system, we high-
light the steps involved in the detection of an advancement
attack by a receiver (Rx) on a signal originating from a
transmitter (Tx).
(a) Pre-conﬁguration
1) Rx determines the maximum accepted distortion
threshold ˆTD based on the maximum communication
distance and maximum tolerated noise level, subject
to a performance region P.
(b) Key generation (Gen)
1) Tx and Rx derive a fresh pseudorandom XOR
sequence x from some shared secret. x could
theoretically also be secretly shared before each
round8.
(c) Mtac generation (Mtac)
1) Tx encodes the message m using repetition coding
according to a chosen conﬁguration p ∈ P and
applies the XOR sequence.
(d) Mtac veriﬁcation (Vrfy)
1) Rx constructs the message m′ by multiplying the
received pulse sequence c′ with the expected XOR
sequence and applying a bit-wise binary hypothesis
test on the overall symbol energy.
2) Based on the received message m′ and the XOR
sequence, Rx constructs the expected pulse-level
sequence ˆc (i.e., the template).
3) Rx computes the signal distortion D(c′, ˆc) between
received and expected pulse sequence.
4) Rx checks if D exceeds ˆTD. If so, it declares attack.
6.4. Practical concerns
Time reference: Distance commitment. We assume the de-
tection of an advancement attack to be limited to veriﬁcation
8. We don’t have any requirements on ToA protection in this step.
of the data relative to some established time frame. This can
be achieved by a distance commitment as introduced in [16].
This means the prover is assumed to have already responded
in quick fashion to the query by transmitting a deterministic
preamble, i.e., is committed to certain temporal reference.
Relative to this temporal reference, the prover then has to
deliver the secret information (i.e., m, correctly modulated)
at a pre-agreed time relative to the preamble. It is realistic
to assume a channel to be coherent throughout the frame, as
the duration of a UWB frame used for distance measurement
is typically less than 1ms. Through a distance commitment,
the vulnerabilities of a back-search [36] on the data-bearing
part can be avoided.
Ranging precision. Under a distance commitment, the back-
search for the acquisition of the ﬁrst signal path is only
necessary on the preamble of the frame. Therefore, the
precision of the ranging procedure is not determined by
any operation applied to the data-bearing part. Consequently,
the precision of our proposal cannot be worse than that of
existing schemes relying on a distance commitment. It has
been shown that such a system can achieve a precision of
10cm, irrespective of communication distance [19], [24].
Bit-level security. We assume a bit-level procedure to detect
if the received bits m′ do not match the transmitted message
m. This could be achieved by a message authentication code
(MAC) appended to the frame or even transmitted on a
separate, potentially ToA-agnostic channel.
7. Analysis
In the following, we explore the tradeoff between security
and performance by modeling the effect of the channel and
evaluating the classiﬁcation performance of our Variance-
Based MTAC from the previous section. The results are
based on simulations, which, however, make assumptions in
line with realistic UWB-based distance measurement systems.
From these results, we can derive the performance region
in which our proposal maintains bit-equivalent security (i.e.,
Adv( ˆA) < 2−nb ) and how to scale to longer distances.
LoS
NLoS
LoS (BER=1e-8)
NLoS (BER=1e-8)
300
200
b
p
p
n
100
0
600
400
200
d [m]
-8
-2
-4
-6
log
10
(BER)
300
200
b
p
p
n
100
0
60
40
20
d [m]
-8
-2
-4
-6
log
10
(BER)
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
200
400
600
20
40
60
distance [m]
distance [m]
Figure 12. The number of pulses per symbol as a function of the target
performance level, i.e., the target bit error rate (BER) and operating distance
under FCC/ETSI constraints. These numbers refer to a LoS (left) as well
as a NLoS scenario (right) with 20dB attenuation of the direct path. Lower
BERs over longer distances require more pulses per symbol.
Figure 13. Over longer distances, the legitimate distortion increases. The
gap between maximum legitimate distortion and minimum attack distortion
becomes smaller for longer distances, eventually vanishing altogether. This
means, under our strong attacker model, MTAC security can only be
maintained up to some distance.
7.1. Model
Path loss model. To evaluate the impact of distance on a) the
modulation required and b) the implications on security, we
assume a free-space path loss model. This means the received
power degrades inversely to the square of the distance, as in
Prx = Ptx(cid:18) λ
4πd(cid:19)2
Γnlos.
We assume the antennas to be operated in each other’s far
ﬁeld, as the goal of this analysis is to understand the tension
between long distance and security. As input power, we
rely on the constraints put forward by the FCC and ETSI
regarding UWB in licensed spectrum. This is, a maximum
peak power of 0dBm within the 50MHz around the peak
and an average limitation on signal power spectral density
of -41.3dBm/Hz. We assume that our pulses are sufﬁciently
spaced, such that each pulse can be sent at peak power.
We assume a signal bandwidth of 620MHz at a center
frequency of 6681.6MHz, which is a typical UWB channel
conﬁguration [37]. For receiver-side noise, we consider
the thermal noise ﬁgure at room temperature, given by
-174dBm/Hz. In a separate non-line-of-sight (NLoS) scenario,
we assume an additional attenuation of 20dB which is roughly
the attenuation the signal experiences when traversing the
human body. In Figure 12, we show the number of pulses per
symbol required under both LoS and NLoS conditions. The
required number of pulses increases with longer distances
and decreases if the requirement on target BER gets relaxed.
Gaussian model for variance distributions. The variance
constitutes a sum of np independent random variables. Due
to the central limit theorem, for a sufﬁciently high overall
number of pulses, the variance distribution converges to a
Gaussian, i.e.,
(d), σD ˆA
(d)(cid:1)
D ˆA(d) ∼ N (cid:0)µD ˆA
Dlgt(d) ∼ N (cid:0)µDlgt (d), σDlgt (d)(cid:1) .
(2)
(3)
In general, these distributions are a function of the communi-
cation range as well as the target BER. Through simulations,
we can verify that in the area of interest (i.e., where the
distributions signiﬁcantly overlap), these distributions indeed
ﬁt a Gaussian hypothesis well, as we show in detail in
Appendix C.
7.2. Results
We model the bit error rate of the underlying modulation
according to Equation 1. We simulate this in MATLAB for
a frame of 32 bits. As we detail in Appendix D, the security
guarantees are maintained for longer frames. For robustness,
the choice of the decision threshold should result in the
same false negative rate of Vrfy as under bit-wise detection,
!= 1 − (1 − BER)nb . Under the Gaussian
i.e., FNRVrfy
hypothesis for the distortion distribution, we can derive the
practical decision threshold by choosing it Q−1(FNRVrfy )
normalized standard deviations above the expected legitimate
distortion. The resulting threshold is indicated in Figure 13.
We evaluate the probability of attacker success for a given
maximum communication distance based on the attacker’s
best case statistics and the legitimate worst-case statistics,
over a range of target BER values. This is in line with our
attacker model, which does not make any assumptions about
the attacker’s position. For a given performance region, the
upper bound of the attacker’s advantage is given by
Adv( ˆA) = Q(cid:18) ˆµD ˆA
− (ˆµDlgt + Q−1(FNRVrfy ) · ˆσDlgt )
ˆσD ˆA
(cid:19) ,
whereas the statistical parameters, i.e., means and vari-
ances, are chosen in favor of forger ˆA. Speciﬁcally, we
choose the attacker’s parameters under minimization of the
worst-case distortion and the parameters of the legitimate
transmitter under maximization of the distortion, within the
deﬁned performance region. The details of those choices
we provide in Appendix B. Unsurprisingly, the worst-case
distance for the legitimate transmitter amounts typically to the
maximum distance. The numerical values of those statistical
parameters (i.e., means and variances) were obtained through
simulation. We thereby modeled the attacker as having an
ideal pulse-level bias of 20%, as motivated in Section 4. In
the following, we are interested in the performance region
in which the MTAC provides bit-equivalent security, i.e.,
Adv( ˆA) ≤ 2−nb .
LoS
NLoS
References
1
0.5
0
600
400
200
d
max
 [m]
-8
-2
-4
-6
log
10
(BER)
1
0.5
0
60
40
20
d
max
 [m]
-8
-2
-4
-6
log
10
(BER)
Figure 14. Attacker’s advantage as a function of the performance level.
We highlight the performance region within which the MTAC provides
bit-equivalent security. The secure distortion test provides us with a bit-
equivalently secure MTAC for distances up to 200m and 20m for LoS and
NLoS scenarios, respectively.
Performance-equivalent MTAC region. Figure 14 shows
the attacker’s advantage as a function of the performance
level. The ﬁgure highlights the performance region in which
we have bit-equivalent MTAC security.
Observation 5 Under any tradeoff between symbol length
and target bit error rate: For any frame m of at least 32
bits, we can ﬁnd a distortion threshold ˆTD resulting in an
MTAC with bit-equivalent security for distances up to 200m
under LoS conditions and up to 20m under NLoS conditions.
Extending the MTAC region. By comparing the results for
LoS and NLoS conditions, we see that the MTAC region
seems to degrade proportionally to the attenuation added,
i.e., the results are invariant under ampliﬁcation/attenuation.
This means we can extrapolate to any communication range
if we allocate a security link margin Γsec ≥ 0 satisfying
Γsec
!
≥ 20 · log10(cid:18) dmax
200m(cid:19) + Γnlos.
8. Conclusion
With MTAC, we propose a physical-layer primitive for
secure distance measurement. We formally deﬁne the security
of its underlying algorithms. We then derive design principles
for the practical instantiation of an MTAC: A randomized
pulse sequence and a secure distortion test over the entire
signal. The results indicate that the bit-equivalent security
level can be regained over a meaningful performance region,
thereby resulting in a fundamental building block preventing
any physical-layer, distance-reducing attacks.
9. Acknowledgements
This project has received funding from the European
Research Council (ERC) under the European Union’s Hori-
zon 2020 research and innovation programme under grant
agreement No 726227.
[1] K. Markantonakis, L. Francis, G. Hancke, and K. Mayes, “Practical
relay attack on contactless transactions by using nfc mobile phones,”
Radio Frequency Identiﬁcation System Security: RFIDsec, vol. 12,
p. 21, 2012.
[2] A. Francillon, B. Danev, and S. Capkun, “Relay attacks on passive
keyless entry and start systems in modern cars,” in Proceedings of
the Network and Distributed System Security Symposium, NDSS 2011,
San Diego, California, USA, 6th February - 9th February 2011, 2011.
[3] A. Ranganathan, B. Danev, A. Francillon, and S. Capkun, “Physical-
layer attacks on chirp-based ranging systems,” in Proceedings of the
ﬁfth ACM conference on Security and Privacy in Wireless and Mobile
Networks. ACM, 2012, pp. 15–26.
[4]
[5]
“Mercedes
’relay’ box thieves caught on cctv in solihull.”
http://www.bbc.com/news/uk-england-birmingham-42132689, [Online;
Accessed November 10th 2018].
“Radio attack lets hackers steal cars with just $20 worth of
gear.” https://www.wired.com/2017/04/just-pair-11-radio-gadgets-can-
steal-car/, [Online; Accessed November 10th 2018].
[6] T. E. Humphreys, B. M. Ledvina, M. L. Psiaki, B. W. O’Hanlon,
and P. M. Kintner, “Assessing the spooﬁng threat: Development
of a portable gps civilian spoofer,” in Radionavigation Laboratory
Conference Proceedings, 2008.
[7]
P. Papadimitratos and A. Jovanovic, “Gnss-based positioning: Attacks
and countermeasures,” in Military Communications Conference, 2008.
MILCOM 2008. IEEE.
IEEE, 2008, pp. 1–7.
[8] N. O. Tippenhauer, C. P¨opper, K. B. Rasmussen, and S. Capkun, “On
the requirements for successful gps spooﬁng attacks,” in Proceedings of
the 18th ACM conference on Computer and communications security.
ACM, 2011, pp. 75–86.
[9]
S. Capkun, M. Cagalj, G. Karame, and N. O. Tippenhauer, “Integrity
regions: Authentication through presence in wireless networks,” IEEE
Transactions on Mobile Computing, vol. 9, no. 11, pp. 1608–1621,
2010.
[10] K. B. Rasmussen, S. Capkun, and M. Cagalj, “Secnav: secure
broadcast localization and time synchronization in wireless networks,”
in Proceedings of the 13th annual ACM international conference on
Mobile computing and networking. ACM, 2007, pp. 310–313.
[11] S. Brands and D. Chaum, “Distance-bounding protocols,” in Workshop
on the Theory and Application of of Cryptographic Techniques.
Springer, 1993, pp. 344–359.
[12] C. H. Kim, G. Avoine, F. Koeune, F.-X. Standaert, and O. Pereira,
“The swiss-knife rﬁd distance bounding protocol,” in International
Conference on Information Security and Cryptology. Springer, 2008,
pp. 98–115.
[13] A. Brelurut, D. Gerault, and P. Lafourcade, “Survey of distance
bounding protocols and threats,” in International Symposium on
Foundations and Practice of Security. Springer, 2015, pp. 29–49.
[14] G. P. Hancke and M. G. Kuhn, “An rﬁd distance bounding
protocol,” in Proceedings of
the First International Conference
on Security and Privacy for Emerging Areas in Communications
Networks, ser. SECURECOMM ’05. Washington, DC, USA:
IEEE Computer Society, 2005, pp. 67–73. [Online]. Available:
http://dx.doi.org/10.1109/SECURECOMM.2005.56
[15] K. B. Rasmussen and S. Capkun, “Realization of rf distance bounding.”
in USENIX Security Symposium, 2010, pp. 389–402.
[16] N. O. Tippenhauer, H. Luecken, M. Kuhn, and S. Capkun, “Uwb
rapid-bit-exchange system for distance bounding,” in Proceedings
of the 8th ACM Conference on Security & Privacy in Wireless and
Mobile Networks. ACM, 2015, p. 2.
[17] A. Ranganathan, B. Danev, and S. Capkun, “Proximity veriﬁcation for
contactless access control and authentication systems,” in Proceedings
of the 31st Annual Computer Security Applications Conference. ACM,
2015, pp. 271–280.
[18] “3db access ag - 3db6830 proximity based access control,”
[Online; Accessed
https://www.3db-access.com/Product.3.html,
November 8th 2018].
[19] “DecaWave
”dw1000 product description and applications”,”
[Online; Accessed
https://www.decawave.com/products/dw1000,
November 8th 2018].
[20] “Zebra Technologies ”sapphire dart ultra wideband (uwb) real time lo-
cating system 2010.”,” https://www.zebra.com/us/en/solutions/location-
solutions/enabling-technologies/dart-uwb.html,
[Online; Accessed
November 8th 2018].
[21] J. Clulow, G. P. Hancke, M. G. Kuhn, and T. Moore, “So near and yet
so far: Distance-bounding attacks in wireless networks,” in European
Workshop on Security in Ad-hoc and Sensor Networks.
Springer,
2006, pp. 83–97.
[22] M. Flury, M. Poturalski, P. Papadimitratos, J.-P. Hubaux, and J.-
Y. Le Boudec, “Effectiveness of distance-decreasing attacks against
impulse radio ranging,” in Proceedings of the third ACM conference
on Wireless network security. ACM, 2010, pp. 117–128.
[23] M. Poturalski, M. Flury, P. Papadimitratos, J.-P. Hubaux, and J.-Y.
Le Boudec, “Distance bounding with ieee 802.15. 4a: Attacks and
countermeasures,” IEEE Transactions on Wireless Communications,
vol. 10, no. 4, pp. 1334–1344, 2011.
[24] M. Singh, P. Leu, and S. Capkun, “UWB with pulse reordering:
Securing ranging against relay and physical-layer attacks,” in 26th