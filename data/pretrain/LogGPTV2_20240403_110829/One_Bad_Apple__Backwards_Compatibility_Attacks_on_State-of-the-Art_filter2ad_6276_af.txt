patibility attacks. Our attacks highlight a lack of apprecia-
tion for the principle of key separation in real world deploy-
ments of cryptography, and bring to the surface weaknesses
in current standards for digital certiﬁcates.
Acknowledgements
We would like to thank Christopher Meyer for help-
ful discussions and the anonymous reviewers for providing
helpful comments. We would also like to thank all men-
tioned vendors and the W3C Working Group for their coop-
eration and discussions on our attacks. Especially we would
like to thank Scott Cantor, Colm O hEigeartaigh, and Yang
Yu.
References
[1] T. Acar, M. Belenkiy, M. Bellare, and D. Cash. Cryp-
tographic agility and its relation to circular encryption.
In H. Gilbert, editor, Advances in Cryptology – EURO-
CRYPT 2010, volume 6110 of Lecture Notes in Computer
Science, pages 403–422. Springer, May 2010.
[2] Advanced encryption standard (AES). National Institute of
Standards and Technology (NIST), FIPS PUB 197, U.S. De-
partment of Commerce, Nov. 2001.
[3] N. AlFardan and K. G. Paterson. Plaintext-recovery attacks
against Datagram TLS. In Network and Distributed System
Security Symposium (NDSS 2012), 2012.
[4] Apache Software Foundation. Apache Axis2. http://
axis.apache.org/axis2/java/core.
[5] Apache Software Foundation. Apache CXF. http://
cxf.apache.org.
[6] Apache Software Foundation. Apache WSS4J - Web
http://ws.
Services Security for Java, May 2012.
apache.org/wss4j/.
[7] R. Bardou, R. Focardi, Y. Kawamoto, G. Steel, and J.-K.
Tsay. Efﬁcient Padding Oracle Attacks on Cryptographic
Hardware. In R. Canetti and R. Safavi-Naini, editors, Ad-
vances in Cryptology – CRYPTO, 2012.
[8] E. Barkan, E. Biham, and N. Keller.
Instant ciphertext-
only cryptanalysis of GSM encrypted communication.
In
D. Boneh, editor, Advances in Cryptology – CRYPTO 2003,
volume 2729 of Lecture Notes in Computer Science, pages
600–616. Springer, Aug. 2003.
[9] M. Bellare and C. Namprempre. Authenticated encryption:
Relations among notions and analysis of the generic compo-
sition paradigm. In T. Okamoto, editor, Advances in Cryp-
tology – ASIACRYPT 2000, volume 1976 of Lecture Notes
in Computer Science, pages 531–545. Springer, Dec. 2000.
[10] M. Bellare and P. Rogaway. Optimal asymmetric encryp-
tion. In A. D. Santis, editor, Advances in Cryptology – EU-
ROCRYPT’94, volume 950 of Lecture Notes in Computer
Science, pages 92–111. Springer, May 1994.
[11] M. Bellare, P. Rogaway, and D. Wagner. The EAX mode of
operation. In B. K. Roy and W. Meier, editors, Fast Software
Encryption – FSE 2004, volume 3017 of Lecture Notes in
Computer Science, pages 389–407. Springer, Feb. 2004.
[12] S. Bellovin. Problem areas for the IP security protocols. In
Proceedings of the Sixth Usenix Unix Security Symposium,
pages 1–16, July 1995.
[13] D. Bleichenbacher.
Chosen ciphertext attacks against
protocols based on the RSA encryption standard PKCS
In H. Krawczyk, editor, Advances in Cryptology –
#1.
CRYPTO’98, volume 1462 of Lecture Notes in Computer
Science, pages 1–12. Springer, Aug. 1998.
[14] T. Bray, J. Paoli, C. M. Sperberg-McQueen, E. Maler, and
F. Yergeau. Extensible Markup Language (XML) 1.0 (Fifth
Edition). W3C Recommendation, 2008.
[15] S. Cantor, J. Kemp, R. Philpott, and E. Maler. Assertions
and Protocol for the OASIS Security Assertion Markup Lan-
guage (SAML) V2.0. OASIS Standard, March 2005.
[16] Centers for Disease Control and Prevention. Public Health
Information Network (PHIN) – Secure Message Transport
Guide, July 2008. Version 2.0.
[17] V. Cerf. ASCII format for network interchange. RFC 20,
Oct. 1969.
[18] Committee IT-014. Australian Technical Speciﬁcation – E-
health XML secured payload proﬁles, March 2010.
[19] D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley,
and W. Polk. Internet X.509 Public Key Infrastructure Cer-
tiﬁcate and Certiﬁcate Revocation List (CRL) Proﬁle. RFC
5280 (Proposed Standard), May 2008.
[20] Danske Bank / Sampo Pankki. Encryption, Signing and
Compression in Financial Web Services, May 2010. Ver-
sion 2.4.1.
[21] J. P. Degabriele, A. Lehmann, K. G. Paterson, N. P. Smart,
and M. Streﬂer. On the joint security of encryption and sig-
nature in EMV. In O. Dunkelman, editor, CT-RSA, volume
7178 of Lecture Notes in Computer Science, pages 116–135.
Springer, 2012.
[22] J. P. Degabriele and K. G. Paterson. Attacking the IPsec
standards in encryption-only conﬁgurations. In 2007 IEEE
Symposium on Security and Privacy, pages 335–349. IEEE
Computer Society Press, May 2007.
[23] T. Dierks and E. Rescorla. The Transport Layer Security
(TLS) Protocol Version 1.1. RFC 4346 (Proposed Standard),
Apr. 2006. Obsoleted by RFC 5246, updated by RFCs 4366,
4680, 4681, 5746.
[24] T. Duong and J. Rizzo. Cryptography in the web: The case
In 2011 IEEE
of cryptographic design ﬂaws in asp.net.
Symposium on Security and Privacy, pages 481–489. IEEE
Computer Society Press, May 2011.
[25] T. Duong and J. Rizzo. Here come the ⊕ Ninjas. Unpub-
lished manuscript, 2011.
[26] M. Dworkin. Recommendation for block cipher modes
of operation: Galois/counter mode (GCM) and GMAC.
In NIST Special Publication 800-38D, November 2007,
National Institute of Standards and Technology. Available
at
http://csrc.nist.gov/publications/nistpubs/800-38D/SP-
800-38D.pdf, 2007.
[27] D. Eastlake, J. Reagle, F. Hirsch, T. Roessler, T. Ima-
mura, B. Dillaway, E. Simon, K. Yiu, and M. Nystr¨om.
XML Encryption Syntax and Processing 1.1. W3C Can-
didate Recommendation, 2012. http://www.w3.org/
TR/2012/WD-xmlenc-core1-20121018.
[28] D. Eastlake, J. Reagle, T. Imamura, B. Dillaway, and E. Si-
mon. XML Encryption Syntax and Processing. W3C Rec-
ommendation, 2002.
[29] D. Eastlake, J. Reagle, D. Solo, F. Hirsch, and T. Roessler.
XML Signature Syntax and Processing (Second Edition).
W3C Recommendation, 2008.
[30] E. Fujisaki, T. Okamoto, D. Pointcheval, and J. Stern. RSA-
Journal of
OAEP is secure under the RSA assumption.
Cryptology, 17(2):81–104, Mar. 2004.
and
2012.
Signing
services
[31] Fuse
Encryption
documentation.
Pro-
framework
Keys
Keys,
http://fusesource.com/
viding
July
docs/framework/2.4/security/
MsgProtect-SOAP-ProvideKeys.html#
MsgProtect-SOAP-ProvideKeys-SpringConfig.
[32] D. Gligoroski, S. Andova, and S. J. Knapskog. On the im-
portance of the key separation principle for different modes
of operation. In L. Chen, Y. Mu, and W. Susilo, editors, IS-
PEC, volume 4991 of Lecture Notes in Computer Science,
pages 404–418. Springer, 2008.
[33] M. Gudgin, M. Hadley, N. Mendelsohn, J.-J. Moreau, and
H. F. Nielsen. SOAP Version 1.2 Part 1: Messaging Frame-
work. W3C Recommendation, 2003.
[34] M. Horsch and M. Stopczynski.
Strategy, 2011. Technical Report.
The German eCard-
[35] IBM.
WebSphere DataPower SOA Appliances.
http://www-01.ibm.com/software/
integration/datapower.
[36] P.
Identity.
PingFederate.
https://www.
pingidentity.com.
[37] T. Jager, S. Schinzel, and J. Somorovsky. Bleichenbacher’s
attack strikes again: breaking PKCS#1 v1.5 in XML En-
cryption. In S. Foresti and M. Yung, editors, Computer Se-
curity - ESORICS 2012 - 17th European Symposium on Re-
search in Computer Security, Pisa, Italy, September 10-14,
2012. Proceedings, LNCS. Springer, 2012.
[38] T. Jager and J. Somorovsky. How to break XML encryp-
In Y. Chen, G. Danezis, and V. Shmatikov, editors,
tion.
ACM CCS 11: 18th Conference on Computer and Commu-
nications Security, pages 413–422. ACM Press, Oct. 2011.
http://www.
JBoss Projects.
[39] JBoss Community.
jboss.org/projects.
[40] M. Jones, J. Bradley, and N. Sakimura.
JSON Web
Signature (JWS) – draft-ietf-jose-json-web-signature-06,
October 2012.
http://tools.ietf.org/html/
draft-ietf-jose-json-web-signature-06.
[41] M. Jones, E. Rescorla, and J. Hildebrand.
JSON Web
Encryption (JWE) – draft-ietf-jose-json-web-encryption-06,
October 2012.
http://tools.ietf.org/html/
draft-ietf-jose-json-web-encryption-06.
[42] J. Jonsson and B. Kaliski. Public-Key Cryptography Stan-
dards (PKCS) #1: RSA Cryptography Speciﬁcations Ver-
sion 2.1. RFC 3447 (Informational), Feb. 2003.
[43] B. Kaliski. PKCS #1: RSA Encryption Version 1.5. RFC
2313 (Informational), Mar. 1998. Obsoleted by RFC 2437.
[44] B. Kaliski and J. Staddon. PKCS #1: RSA Cryptography
Speciﬁcations Version 2.0. RFC 2437 (Informational), Oct.
1998. Obsoleted by RFC 3447.
[45] B. S. Kaliski Jr. On hash function ﬁrewalls in signature
schemes. In B. Preneel, editor, Topics in Cryptology – CT-
RSA 2002, volume 2271 of Lecture Notes in Computer Sci-
ence, pages 1–16. Springer, Feb. 2002.
[46] Kantara Initiative. Kantara Initiative eGovernment Imple-
mentation Proﬁle of SAML V2.0, June 2010. Version 2.0.
[47] J. Kelsey, B. Schneier, and D. Wagner. Protocol interac-
tions and the chosen protocol attack.
In B. Christianson,
B. Crispo, T. M. A. Lomas, and M. Roe, editors, Security
Protocols Workshop, volume 1361 of Lecture Notes in Com-
puter Science, pages 91–104. Springer, 1997.
[48] K. Lawrence and C. Kaler. WS-SecurityPolicy 1.2. OASIS
Standard, July 2007.
[49] Layer7 Technologies.
Layer7 XML Firewall.
http://www.layer7tech.com/products/
xml-firewall.
[50] F. McCabe, D. Booth, C. Ferris, D. Orchard, M. Champion,
E. Newcomer, and H. Haas. Web services architecture. W3C
note, W3C, Feb. 2004. http://www.w3.org/TR/2004/NOTE-
ws-arch-20040211/.
[51] D. A. McGrew and J. Viega. The security and performance
of the Galois/counter mode (GCM) of operation. In A. Can-
teaut and K. Viswanathan, editors, Progress in Cryptology -
INDOCRYPT 2004: 5th International Conference in Cryp-
tology in India, volume 3348 of Lecture Notes in Computer
Science, pages 343–355. Springer, Dec. 2004.
[52] Nimbus Directory Services. Nimbus JSON Web Token,
May 2012. https://bitbucket.org/nimbusds/
nimbus-jwt.
[53] NIST. Cipher block chaining. NIST FIPS PUB 81, U.S.
Department of Commerce, 1980.
[54] NIST. AES key wrap speciﬁcation, 2001.
[55] NIST. Recommendation for block cipher modes of opera-
tion. Special Publication 800-38A, 2001.
[56] NIST. Recommendation for block cipher modes of opera-
tion: The CCM mode for authentication and conﬁdentiality.
Special Publication 800-38C, 2004.
[57] Oracle. Securing SOA and Web Services with Oracle Enter-
prise Gateway, April 2011. Technical Report.
[58] K. G. Paterson, J. C. N. Schuldt, M. Stam, and S. Thomson.
On the joint security of encryption and signature, revisited.
In D. H. Lee and X. Wang, editors, Advances in Cryptol-
ogy – ASIACRYPT 2011, volume 7073 of Lecture Notes in
Computer Science, pages 161–178. Springer, Dec. 2011.
[59] K. G. Paterson and A. K. L. Yau. Cryptography in theory
and practice: The case of encryption in IPsec. In S. Vaude-
nay, editor, Advances in Cryptology – EUROCRYPT 2006,
volume 4004 of Lecture Notes in Computer Science, pages
12–29. Springer, May / June 2006.
[60] Ping Identity product documentation. PingFederate 6.6,
Selecting a Decryption Key (SAML), July 2012. http://
documentation.pingidentity.com/display/
PF66/Selecting+a+Decryption+Key+(SAML).
[61] J. Rizzo and T. Duong. Practical padding oracle attacks.
In Proceedings of the 4th USENIX conference on Offensive
technologies, WOOT’10, pages 1–8, Berkeley, CA, USA,
2010. USENIX Association.
[62] P. Rogaway.
Problems with proposed IP cryptog-
http:
Unpublished manuscript,
raphy.
//www.cs.ucdavis.edu/˜rogaway/papers/
draft-rogaway-ipsec-comments-00.txt.
1995.
[63] P. Rogaway, M. Bellare, J. Black, and T. Krovetz. OCB:
A block-cipher mode of operation for efﬁcient authenticated
encryption. In ACM CCS 01: 8th Conference on Computer
and Communications Security, pages 196–205. ACM Press,
Nov. 2001.
[64] SAP.
SAP Netweaver.
http://scn.sap.com/
community/netweaver.
[65] J. Schaad, B. Kaliski, and R. Housley. Additional Algo-
rithms and Identiﬁers for RSA Cryptography for use in the
Internet X.509 Public Key Infrastructure Certiﬁcate and Cer-
tiﬁcate Revocation List (CRL) Proﬁle. RFC 4055 (Proposed
Standard), June 2005. Updated by RFC 5756.
Shibboleth.
http:
[66] Shibboleth Consortium.
//shibboleth.net.
[67] J. Somorovsky and J. Schwenk. Technical Analysis of Coun-
termeasures against Attack on XML Encryption – or – Just
Another Motivation for Authenticated Encryption. In SER-
VICES Workshop on Security and Privacy Engineering, June
2012.
[68] S. Vaudenay. Security ﬂaws induced by CBC padding - ap-
plications to SSL, IPSEC, WTLS ... In L. R. Knudsen, ed-
itor, Advances in Cryptology – EUROCRYPT 2002, volume
2332 of Lecture Notes in Computer Science, pages 534–546.
Springer, Apr. / May 2002.
[69] K. U. Veiko Sinivee. Encrypted DigiDoc Format Speciﬁca-
tion, June 2012. Version 1.1.
[70] J. Viega and D. McGrew. The Use of Galois/Counter Mode
(GCM) in IPsec Encapsulating Security Payload (ESP).
RFC 4106 (Proposed Standard), June 2005.
[71] D. Wagner and B. Schneier. Analysis of the SSL 3.0 proto-
col. In Proceedings of the 2nd conference on Proceedings
of the Second USENIX Workshop on Electronic Commerce -
Volume 2, WOEC’96, pages 4–4, Berkeley, CA, USA, 1996.
USENIX Association.
[72] F. Yergeau. UTF-8, a transformation format of Unicode and
ISO 10646. RFC 2044 (Informational), Oct. 1996. Obso-
leted by RFC 2279.