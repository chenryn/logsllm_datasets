日志对于安全来说很重要，特别是nginx服务器的访问日志，笔者曾经自己搭建elk日志系统，从搭建、日志采集，到部署调优，花费了相当长的时间，而且服务运行的过程中，经常出现不稳定的情况，以及从2.2升级到5.0的时候也出现很多不稳定的情况，慢慢也发现绝大多数安全人员对于这套架构部署和维护很难驾驭，而且这套架构也存在一些弊端：
每台nginx服务器上都要去部署logstash采集器，logstash采集日志会会消耗不少nginx服务器资源，一般来说，标准的生产环境:php+nginx或者java+tomcat,另外还需要去写shell脚本来定时切割日志，将日志分存，进档
Es在并发接收logstash丢过来的json格式日志，有时由于网络原因，存在丢包情况，另外存在无法正确解析的情况，有人建议有redis的队列做缓存，实践效果不佳
elk搭建不难，但是Es本身的维护，调优需要具备较专业的知识，kibana的查询数据过大的话经常会导致超过，然后需要重启处理
基于以上问题，笔者调研几款第三方云产品
日志易，需要安装agent来收集日志，不过同样需要安装到每台nginx服务器上,但统计报表比较简单。
阿里云日志服务,logtail组件（类似logstash）在高并发的场景下，比logstash的性能要好，资源占比少，另外配合阿里的elasticsearch产品，可以完全替代自建的elk系统，而且如果需要日志查询，可以使用类似sql查询方式比kibana的Lucene更友好，最重要的是阿里已经与elastic官方合作了！
### 移动安全：
对于移动安全，笔者涉略不多，故将移动的安全全部基于阿里云的移动安全产品来完成，定期将安卓包上传，扫描，下载输出安全报告，反馈给移动开发的同事，进行修复和优化。但对app的核心业务，笔者会跟PC，wap一样定期进行安全测试，当然会稍微麻烦一点，使用代理工具进行抓包追踪，或者直接安装安卓模拟器来替代手机，因为手机一段时间不操作会进行锁屏状态，很麻烦，而安卓模拟器则不会锁屏，可以跟测试PC端一样方便，苹果模拟器也差不多，具体模拟器选型可以私聊。
### 内网安全
办公账号弱口令：统计下内部oa,erp系统,发布系统,客
服系统，后台系统，邮件系统等使用的账号数量，并做个详细记录，逐一排查哪些员工账号存在弱口令。普遍很多员工抱怨，公司有太多系统，要记太多密码记不
住，确实对人来说，那么多账号，不愿去记，也记不住那么多系统账号，这里分享下笔者的方法：每个人入职只有一个密码，通用所有系统。肯定有人说这样会有隐
患，其实可以这样，这个密码是由数字+大写字母+小写字母+特殊符号，然后每个人从4种类型中，每种类型选2个，然后自由排序，组成一个8位的密码。那么这个密码可以用作这个人在公司的终身密码，通用公司所有系统，也很难被破解。
重点说下企业邮箱安全：
大家都知道企业邮箱里有太多的秘密了，工资，公司通讯录等等，敏感信息比比皆是，笔者自研了一个暴力破解脚本，从人事处拿到所有人的邮箱地址后，开始逐一
爆破弱口令，如果爆破成功，直接找到对应人让他修改。一般来说第三方的企业邮箱都有一些安全机制，高频尝试暴力登录，会封ip或者限制访问，需要采取一些hack手法，具体操作可以私聊。
### 等级保护测评
随着安全法的落地，测评工作也是必不可少，配合测评机构逐步进行，对测评出的问题，按需完善即可。由于我们是ECS，有阿里做后盾，所以评测流程比较顺利。
### 安全培训：
这个可以根据实际情况来做，如果有分享会，可以定期分享一些安全知识，提高开发的安全意识，就笔者所在的公司来说，开发的安全的意识普遍不高，对安全的认识
停留在初级阶段，对其中安全漏洞的成因不了解，导致开发过程中会出现不少的安全问题，如果没时间培训，也可以订阅安全牛、i春秋的课程推荐给开发同事学习，当出现安全事故之后，需要把还原整个安全事件，让所有的开发了解，避免下次范同样的问题，当然也可以设置惩罚机制，根据自己的情况去做，深入的话也可以私聊。
### 威胁情报搜集
其实一个人精力有限，时时刻刻去盯爆出来的0day很难，建议多订阅一些高质量的公众号，时常关注0day的预警，一旦发现及时修复漏洞，最好不要用第三方的产品如discuz，phpcms等，因为不定时就报0day，如果非要用，也建议把周期性去排查是否有新版本，及时升级补丁。另外对于github上的敏感信息泄露，建议使用脚本去周期性的扫描，或者使用携程云的github扫描功能，如果发现自家代码，必须找到对应人强制下线。
### 安全应急中心
对于一个人的安全部，有人说意义不大，但笔者觉得，还是有必要的，很多白帽子，在发现安全问题之后，其实是想找一个渠道反馈给官方，如果企业有反馈渠道即
应急响应中心话，白帽还是很乐意去提交的，如果官方没有渠道，那么基本只能提到补天这种平台，这就会导致获取安全问题滞后，甚至被黑！当然自家实在没有应
急中心的，建议时常去补天看看是否有自家漏洞，尽快认领修复！
要做好企业安全建设，对一个或几个安全人员来说，确实不是一件易事，因为安全涉及的东西比较多，随着企业业务的扩展，安全需要为其保驾护航，随之而来的工
作增多，先解决掉存在的问题，再一步步横纵向扩展，建立起多层防御机制，就能减少被攻击的风险，另外不要存侥幸心理，细扣每个细节，用有限的精力把安全做好！
### 结语：
感谢atiger77，晓风两位的无私分享,以及其他开源产品的开发者，并附上两位同行的文章链接  
atiger77   
晓风   
巡风系统   
cobra   
sonar   
rips   
seay源代码审计工具 www.cnseay.com闭站了，去百度搜吧！  
携程云安全   
号安   
云加速   
加速乐 