title:blackhat:eu-22 Knockout Win Against TCC - 20+ NEW Ways to Bypass Your MacOS Privacy Mechanisms
"TotallyNotAVirus 2.app" would like to access the camera and spy on you. To protect your privacy, Apple introduced the Transparency, Consent, and Control (TCC) framework that restricts access to sensitive personal resources: documents, camera, microphone, emails, and more. Granting such access requires authorization, and the mechanism's main design concern was clear user consent. In this talk we will share multiple techniques that allowed us to bypass the TCC authorization and as a malicious application get access to protected resources without any additional privileges or user's consent.Did you read a similar abstract before? Yeah, this is the brand new version of our TCC bypasses talk. There is so much new to cover that we decided to come back to you with brand new macOS privacy / TCC vulnerabilities and techniques that we never discussed before.During this talk, we will give you an overview of the TCC framework, its building blocks, and how it limits application access to private data. We will explore the various databases it uses and discuss the difference between user consent and user intent. Next, we will go through various techniques and specific vulnerabilities that we used to bypass TCC. It will cover techniques like regression vulnerabilities, code injections, logic bugs, built-in sysadmin tools abuse, and more. We will see how things improved (or not) in Monterey vs Big Sur, which we covered earlier. In the end, we'll cover security improvements and exploit mitigations delivered by Apple in the new macOS Ventura.The audience will leave with a solid understanding of the macOS privacy restrictions framework (TCC) and its weaknesses. We believe there is a need to raise awareness on why OS protections are not 100% effective, and in the end, users have to be careful with installing software on their machines. Moreover - as we're going to publish several exploits - red teams will also benefit from the talk.