Above.com
#
1
2
3
4
5
6
7
8
9
10
# TDSes
263
246
148
86
61
53
33
18
17
11
Name-services.com
Parkpage.foundationapi.com
Sedo Parking
Name Drive Parking
Parking-page.net
Internet Trafﬁc Corp
Table XIII
TOP 10 PARKING SERVICES
Trafﬁc comparison before and after parking. We ﬁrst
compare the amount of trafﬁc to these TDS domains be-
fore and after they are parked. Before parking, they can
redirect trafﬁc to exploit servers to monetize trafﬁc while
after parking, the new domain owners can monetize the
incoming trafﬁc through the advertising models offered by
parking services. To compare the trafﬁc volume, we utilize
the previously introduced “PassiveDNS” dataset. As each
aggregated DNS record contains the start time, end time, and
lookup count, we calculate the number of lookups per day.
Note that such numbers are lower bounds, as many lookups
may be resolved through caching by local resolvers. Figure
13(a) displays the number of lookups per day before and
after parking. As we can see from the ﬁgure, the amount
of trafﬁc does not change signiﬁcantly after the domain is
parked. Compromised door way pages still redirect trafﬁc to
the TDS domains, even after the TDSes are taken down and
parked.
Trafﬁc comparison between regular parked domains
and parked TDSes. Next, we want to examine whether
monetizing TDSes through parking is more proﬁtable for
domainers than regular domains. To achieve this, we obtain
664 regular parked domains on TrafﬁcZ name servers on
Nov15, one of the most reputable parking services, and
obtain their lookup rates from the PassiveDNS dataset.
Figure 13(b) shows trafﬁc volume of regular vs TDS parked
domains. It is surprising that parked TDSes have more than
10 times the the amount of lookups per day than the regular
parked domains. This observation shows that even after
the TDSes are taken down, they can still bring remarkable
revenue to domainers.
124
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
Trafﬁc monetization. We ﬁnd that 61.66% of
the
parked TDSes use ad-networks and ad exchanges such as
DoubleClick and BidSystem. While 56% go through
tracker networks used for targeted advertising, 3.94% of
the parked paths monetizing trafﬁc directly through the
ZeroClick model.
1
0.8
0.6
0.4
0.2
0
0.00001
0.001
Before parking
After parking
0.1
1000
Traffic Per Day (log scale) 
10
100000
1
0.8
0.6
0.4
0.2
0
0.00001
Regular parking
TDS parking
0.001
0.1
Traffic Per day (log scale) 
10
1000
100000
(a) Before and after TDS parking.
After TDSes are taken down and
parked, they continue to receive sim-
ilar amount of trafﬁc from compro-
mised doorways.
(b) Regular vs TDS parking. The
median lookup rate of TDSes is over
10 times higher than regular parked
domains.
Figure 13. CDF of Trafﬁc hits per day
VII. DISCUSSION
Although some types of dedicated malicious services
have long been known [8], topological studies on the hosts
playing dedicated roles in malicious Web infrastructures,
regardless of the speciﬁc types of malicious activities they
are involved in, have never been done before. Such studies
are important because they can bring us to new types of
malicious services and help detect these linchpins of the
dark Web even before knowing what they exactly do. Here
we discuss what we have learnt from our ﬁrst step on this
direction and what needs to done in the follow-up research.
Based on the large amount of data crawled from the Web
during a long period of time, we discover interesting topo-
logical features of these malicious hosts: they tend to have
very close relations with malicious hosts but rather tenuous
connections to even highly popular legitimate services. This
ﬁnding leads us to the PageRank-based approach, which
works effectively in detecting those dedicated services, with-
out relying on their malicious semantics. On the other hand,
we are far from fully exploiting the opportunities even our
preliminary discoveries present to us: as an example, the
paths associated with those dedicated hosts link to a large
number of malicious nondedicated hosts, which need to be
captured with right techniques. Also, progress can still be
made on the detection of such dedicated hosts, particularly
those also serving doorway pages.
Our preliminary analysis of those topologically dedicated
hosts has already brought us to a type of understudied
malicious services—TDSes. With all the ﬁndings we make,
including their unexpectedly long life span and the way they
are monetized even after taken down, more questions have
been raised than solved. For example, to what extent do they
monetize trafﬁc? How can an ad network trace whether the
trafﬁc is redirected from malicious channels? Answers to
these questions would be invaluable to the online industry.
While we are studying the attacker’s infrastructures, at-
tackers are actively tracing us as well. They now smartly
record IP addresses of visitors and only deliver malicious
content to each IP once. They can also employ various
cloaking techniques. Moving forward, we feel the research
community should unite to build a distributed crawling
infrastructure and also leverage normal user inputs to better
ﬁght against attackers.
Finally, we call for the regulation on the usage and resell
of takendown domains. Our study shows that even after
TDSes are taken down, they continue to receive a large
amount of trafﬁc from compromised doorway pages. Such
trafﬁc is currently leveraged by domain owners to gain
revenue from the ad networks. These actions should be
prohibited as such trafﬁc is not valid human generated ones.
VIII. RELATED WORK
Study on malicious Web infrastructures. Malicious activi-
ties are becoming more organized and even turning into a big
underground business. Prior research focuses on the mali-
cious infrastructures associated with speciﬁc attack channels,
such as Spam [2], black-hat Search-Engine Optimization
(SEO) [11] and malvertising [16]. These studies analyze the
different parties in the underground business and how the
malicious campaigns operate. Our study provides a topolog-
ical view of the malicious Web infrastructures and we study
the dedicated malicious hosts and their relationships with
other entities.
Detection of malicious entities. To detect malicious entities,
prior research either relies on content analysis or redirection
chain analysis. However, these approaches are not robust
against attackers’ ever-changing strategies. Code analysis [5]
and URL patterns [11] can be evaded if attackers change
signatures. Researchers have also explored the features of
redirection chains including length, short sub-sequences,
cross-site redirections [14], [16], [17]. These features are
proved to be effective against speciﬁc attacks but they may
not be fundamental to the malicious infrastructures. Instead,
we utilize the topological features, such as the relationships
between different entities, which are more difﬁcult to evade.
The detected hosts are dedicated for a variety of different
malicious purposes, more than just the central servers stud-
ied in [33].
PageRank algorithm. Our approach adopts the PageRank
algorithm [3] to differentiate the malicious and legitimate
entities. This algorithm has been used to detect spammers
in social networks [9], online comments [32] and web
spam pages [4]. Our study shows that the malicious Web
infrastructures have similar properties and PageRank is also
effective on their topology graphs.
IX. CONCLUSION
In this paper, we report our study on a set of topologically
dedicated hosts discovered from malicious Web infrastruc-
tures. Those hosts are found to play central roles in the dark
125
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply. 
Web, serving over 70% of the nearly 4 million malicious
redirection paths collected in our research and rarely being
connected to by any legitimate hosts. Leveraging this unique
feature, we develop a topology-based technique that detects
these hosts without even knowing exactly what they do. This
approach utilizes the PageRank algorithm to capture those
with high status on the dark side of the Web but very much
unknown on the bright side, and brings to the light thousands
of dedicated hosts missed by the state-of-the-art malware
scanner. Taking a close look at our ﬁndings, we learn that
many of those hosts are actually TDSes, which play a key
role in trafﬁc exchange in malicious activities. Our further
study on such services reveals their unusually long life span
(65 days), compared with the exploit services studied before,
and the way they are used to monetize trafﬁc, even after their
domains have been taken down.
ACKNOWLEDGEMENTS
We thank anonymous reviewers for their insightful com-
ments. This work is supported in part by NSF CNS-1223477
and CNS-1117106. Alrwais also acknowledges the fund
from the College of Computer and Information Sciences,
King Saud University, Riyadh, Saudi Arabia.
REFERENCES
[1] Alexa. Alexa top 500 global sites. http://www.alexa.com/topsites.
[2] D. S. Anderson, C. Fleizach, S. Savage, and G. M. Voelker. Spamscat-
ter: characterizing internet scam hosting infrastructure. In Proceedings
of 16th USENIX Security Symposium on USENIX Security Sympo-
sium, SS’07, pages 10:1–10:14, Berkeley, CA, USA, 2007. USENIX
Association.
[3] S. Brin and L. Page. The anatomy of a large-scale hypertextual web
search engine. In Proceedings of the seventh international conference
on World Wide Web 7, WWW7, pages 107–117, Amsterdam, The
Netherlands, The Netherlands, 1998. Elsevier Science Publishers B.
V.
[4] P.-A. Chirita, J. Diederich, and W. Nejdl. Mailrank: using ranking
for spam detection.
In Proceedings of the 14th ACM international
conference on Information and knowledge management, CIKM ’05,
pages 373–380, New York, NY, USA, 2005. ACM.
[5] C. Curtsinger, B. Livshits, B. G. Zorn, and C. Seifert. Zozzle: Fast and
precise in-browser javascript malware detection. In USENIX Security
Symposium. USENIX Association, 2011.
[6] J. Fitzpatrick. Five best domain name registrars. http://lifehacker.
com/5683682/ﬁve-best-domain-name-registrars, November 2012.
[7] M. Goncharov.
distribution
malware-distribution-tools-research-paper-en.pdf, 2011.
tools.
Trafﬁc
direction
as malware
http://www.trendmicro.es/media/misc/
systems
[8] C. Grier, L. Ballard, J. Caballero, N. Chachra, C. J. Dietrich,
K. Levchenko, P. Mavrommatis, D. McCoy, A. Nappa, A. Pitsillidis,
N. Provos, M. Z. Raﬁque, M. A. Rajab, C. Rossow, K. Thomas,
V. Paxson, S. Savage, and G. M. Voelker. Manufacturing compromise:
the emergence of exploit-as-a-service.
In Proceedings of the 2012
ACM conference on Computer and communications security, CCS
’12, pages 821–832, New York, NY, USA, 2012. ACM.
[9] Z. Gy¨ongyi, H. Garcia-Molina, and J. Pedersen. Combating web
spam with trustrank.
In Proceedings of the Thirtieth international
conference on Very large data bases - Volume 30, VLDB ’04, pages
576–587. VLDB Endowment, 2004.
[10] T. Holz, C. Gorecki, K. Rieck, and F. C. Freiling. Measuring and
detecting fast-ﬂux service networks. In NDSS. The Internet Society,
2008.
[11] J. P. John, F. Yu, Y. Xie, A. Krishnamurthy, and M. Abadi. deseo:
combating search-result poisoning.
the 20th
USENIX conference on Security, SEC’11, pages 20–20, Berkeley, CA,
USA, 2011. USENIX Association.
In Proceedings of
[12] C. Kanich, N. Weavery, D. McCoy, T. Halvorson, C. Kreibichy,
K. Levchenko, V. Paxson, G. M. Voelker, and S. Savage. Show me
the money: characterizing spam-advertised revenue. In Proceedings
of the 20th USENIX conference on Security, SEC’11, pages 15–15,
Berkeley, CA, USA, 2011. USENIX Association.
[13] Kytoon. Sutra tds. http://kytoon.com/sutra-tds.html.
[14] S. Lee and J. Kim. WarningBird: Detecting suspicious URLs in
the 19th Annual Network &
Twitter stream.
Distributed System Security Symposium, Feb. 2012.
In Proceedings of
[15] K. Levchenko, N. Chachra, B. Enright, M. Felegyhazi, C. Grier,
T. Halvorson, C. Kanich, C. Kreibich, H. Liu, D. McCoy, A. Pitsillidis,
N. Weaver, V. Paxson, G. M. Voelker, and S. Savage. Click Trajecto-
ries: End-to-End Analysis of the Spam Value Chain. In Proceedings
of 32nd annual Symposium on Security and Privacy. IEEE, May 2011.
[16] Z. Li, K. Zhang, Y. Xie, F. Yu, and X. Wang. Knowing your enemy:
understanding and detecting malicious web advertising. In Proceed-
ings of the 2012 ACM conference on Computer and communications
security, CCS ’12, pages 674–686, New York, NY, USA, 2012. ACM.
[17] L. Lu, R. Perdisci, and W. Lee. Surf: detecting and measuring search
poisoning. In Proceedings of the 18th ACM conference on Computer
and communications security, CCS ’11, pages 467–476, New York,
NY, USA, 2011. ACM.
[18] Malwaredomains.
url shorteners.
http://mirror1.malwaredomains.
com/ﬁles/url shorteners.txt.
Runforestrun
legitimate
http://blog.unmaskparasites.com/2012/07/26/
now encrypts
Parasites.
ﬁles.
[19] U.
js
runforestrun-now-encrypts-legitimate-js-ﬁles/, 2012.
[20] R. Petnel. Adblock plus. http://adblockplus.org/en/.
[21] R. Petnel.
easylist.txt.
Easylist.
https://easylist-downloads.adblockplus.org/
[22] R. Petnel. Easyprivacy. https://easylist-downloads.adblockplus.org/
easyprivacy.txt.
[23] N. Provos, P. Mavrommatis, M. A. Rajab, and F. Monrose. All
your iframes point to us. In Proceedings of the 17th conference on
Security symposium, pages 1–15, Berkeley, CA, USA, 2008. USENIX
Association.
[24] Sedo. Domain parking terms and conditions. https://sedo.com/us/
about-us/policies/domain-parking-terms-and-conditions-sedocom/
?tracked=1&partnerid=38758&language=us.
[25] I. SIE. Isc dnsdb api. https://dnsdb.isc.org/doc/isc-dnsdb-api.html.
[26] I. SIE. Security information exchange (sie) portal. https://sie.isc.org/.
[27] J. W. Stokes, R. Andersen, C. Seifert, and K. Chellapilla. Webcop:
locating neighborhoods of malware on the web. In Proceedings of the
3rd USENIX conference on Large-scale exploits and emergent threats:
botnets, spyware, worms, and more, LEET’10, pages 5–5, Berkeley,
CA, USA, 2010. USENIX Association.
[28] B. Stone-Gross, M. Cova, L. Cavallaro, B. Gilbert, M. Szydlowski,
R. Kemmerer, C. Kruegel, and G. Vigna. Your botnet is my botnet:
analysis of a botnet takeover.
In Proceedings of the 16th ACM
conference on Computer and communications security, CCS ’09,
pages 635–647, New York, NY, USA, 2009. ACM.
[29] Twitter. Using the twitter search api. https://dev.twitter.com/docs/
using-search, 2012.
[30] Y. Wang, D. Beck, X. Jiang, and R. Roussev. Automated web patrol
with strider honeymonkeys: Finding web sites that exploit browser
vulnerabilities.
In In Proceeding of the Network and Distributed
System Security Symposium (NDSS’06), 2006.
[31] Whois.net. Whois lookup - domain names search, registration, &
availability. http://www.whois.net/, 2011.
[32] J. Zhang and G. Gu. Neighborwatcher: A content-agnostic comment
the Network and
spam inference system.
Distributed System Security Symposium (NDSS’13), 2013.
In In Proceeding of
[33] J. Zhang, C. Seifert, J. W. Stokes, and W. Lee. Arrow: Generating
signatures to detect drive-by downloads. In Proceedings of the 20th
international conference on World wide web, WWW ’11, pages 187–
196, New York, NY, USA, 2011. ACM.
126
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:54:53 UTC from IEEE Xplore.  Restrictions apply.