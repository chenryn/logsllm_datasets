# 实战化ATT&CK
##### 译文声明
本文为翻译文章，仅供参考。具体内容和含义以原文为准。

## 序言
本文是实战化ATT&CK™系列专题文章的开篇，主要介绍当前网络空间安全的威胁形势、情报驱动防御和ATT&CK™模型等核心概念，旨在帮助读者深入理解ATT&CK™模型并为其打下坚实的理论基础。

## 1. 当前网络空间安全的威胁形势

### 1.1 NotPetya勒索病毒事件：技术能力越来越强大的对手

**1.1.1 事件背景**
2017年6月27日，一种名为NotPetya的新勒索病毒袭击了乌克兰、俄罗斯、西班牙、法国、英国、丹麦、印度和美国等多个国家和地区。这种病毒导致重要基础设施瘫痪，并造成了超过30亿美元的经济损失。其中，乌克兰约有10%的计算机系统被感染。

**1.1.2 攻击目标**
具体受攻击的目标包括：
- 乌克兰政府部门的电脑网络，导致央行配电系统等设施受损。
- 荷兰船运巨头马士基集团（A.P. Moller – Maersk）在洛杉矶码头的设施。
- 全球最大的广告传播集团WPP，员工被迫关闭电脑。
- 一家乌克兰媒体公司，黑客要求支付300美元比特币解锁系统。
- 俄罗斯央行及其消费信贷公司的电脑系统受到严重影响。
- 俄罗斯石油公司（Rosneft）的电脑系统也遭受重创。

**1.1.3 攻击者的战术、技术和过程分析**
通过ATT&CK™模型分析，NotPetya利用了多种手段进行传播，包括钓鱼邮件（利用CVE-2017-0199漏洞）、软件供应链后门（操纵M.E.Doc更新服务器）和水坑攻击（乌克兰巴哈姆特市的网站）。成功感染目标系统后，NotPetya会释放Downloader获取病毒母体，形成初始扩散节点，随后通过EternalBlue（永恒之蓝，CVE-2017-0144）和EternalRomance（永恒浪漫，CVE-2017-0145）漏洞、WMI、PsExec以及系统弱口令进行蠕虫传播。此外，它还具备对抗杀毒软件（如卡巴斯基和诺顿）和反取证（如wevtutil日志清除）的能力。

### 1.2 组织：“方程式组织”（Equation Group）- 超高能力网空威胁行为体

网空威胁行为体根据其动机、攻击能力和资源可分为七个层级，从业余黑客到超高能力国家/地区行为体。其中，“方程式组织”属于超高能力网空威胁行为体，拥有严密的规模建制、庞大的支撑工程体系和先进的攻击装备。该组织高度追求隐蔽性和反溯源性，使其攻击难以察觉。

#### “方程式组织”的攻击装备
- **漏洞利用工具和攻击平台**：针对网络设备和防火墙，突破边界并横向移动。典型装备包括EPICBANANA、EXTRABACON和FuzzBunch漏洞利用平台。
- **持久化/植入攻击装备**：用于在目标系统中建立持久化的控制点。例如，FEEDTROUGH可在防火墙启动时植入载荷。
- **控制/后门类恶意代码**：最终植入目标系统的载荷，用于持久化或非持久化控制。DanderSpritz是一个典型的控制平台，具有界面化的远程控制功能和复杂的指令体系。

面对技术能力越来越强大的对手或“方程式组织”这样的超高能力网空威胁行为体，我们需要采用体系化、框架化的威胁分析模型，如洛克希德·马丁公司的Kill Chain和MITRE公司的ATT&CK模型，来进行更深入、系统的分析和有效的防御。

## 2. 情报驱动防御（Intelligence Driven Defense）

情报驱动防御是一种以威胁为中心的风险管理战略，通过分析对手的能力、目标和局限性，帮助防守方获得弹性的安全态势，并有效指导安全投资的优先级。

### 2.1 指标（Indicator）和失陷指标（IOCs）
- **原子指标（Atomic）**：不可再分拆的指标，如IP地址、电子邮件地址和漏洞编号。
- **计算指标（Computed）**：从事件数据派生出的指标，如Hash值和正则表达式。
- **行为指标（Behavioral）**：结合原子指标和计算指标，描述入侵行为。

### 2.2 失陷指标（IOCs）
- IOCs记录事件的特征和证物，包含主机和网络的所有内容，而不仅仅是恶意软件。
- IOC使用详细逻辑语句描述恶意活动，如基于XML语言的实例化。

### 2.3 痛苦金字塔模型（The Pyramid of Pain）
痛苦金字塔模型对IOCs进行分类，描述其在攻防对抗中的价值。TTPs（战术、技术及过程）处于塔尖，调整TTPs所需的成本最高，但基于TTPs的检测和响应对防守最有价值。

## 3. MITRE ATT&CK™ 模型的核心概念

### 3.1 MITRE公司
MITRE公司最初从事国防部的威胁建模和情报分析，后来扩展到网络安全领域。其特色在于分类建模，构建了STIX情报架构。随着STIX的发展，MITRE引入了ATT&CK™模型，用于改进攻击描述。

### 3.2 ATT&CK模型（ATT&CK™）
ATT&CK™模型是一个反映攻击生命周期的模型和知识库，枚举和分类对手使用的战术和技术，用于理解和追踪攻击者的行为。该模型还整理了APT组织及其使用的TTP。

特点：
- 对手在真实环境中使用的TTP。