分析视频和时域CSI信号，以调查是否可以可靠地捕获活动或事件的开始和结束时间。上图描绘了一个活动，其中一个人在任意时间范围内上下移动左臂，重复三遍。
请注意，可以从其他身体部位（例如，左肘）获得类似的视频信号，但是算法会选择左手腕，因为它包含的幅度最大。两种信号都显示相似的开始和结束时间，并且在多个试验，人员和事件中始终观察到这种趋势。这可以得出结论，它们可以作为视频和CSI信号之间比较的可靠属性。
为了提取事件的开始时间和结束时间，使用称为运动能量的度量，该度量捕获CSI信号不同频带中的能量。可以将运动能（E）计算为：
其中FFThalf(i)是在时间窗口L上计算的FFT系数幅值。
请注意，仅考虑前半部分是因为另一半是多余的，所以忽略了FFT系数，忽略了DC分量。将视频和CSI信号的总事件时间窗分为0.1秒的L，因为这为属性比较提供了足够的时间粒度。
当事件的运动能量E增加并超过阈值时，将检测事件的开始时间。对于视频反馈，监视瞬时E值，并在E变得比其移动平均值大十倍时确定事件的开始。对于仍然比视频信号嘈杂的CSI信号，当E的方差变得大于其移动平均值时，确定事件的开始。结束时间可以类似地计算。表示从视频和CSI信号为事件测量的开始时间和结束时间，如下所示：
**突出的频率：**
提取的第三个属性是事件的突出频率分量。观察到有可能提取单个频率分量，该单个频率分量在主频率中表现出最大的信号幅度。下图显示了上述活动的选定视频和CSI信号的FFT图。观察到视频和CSI信号均显示约0.6
Hz的主频率分量。因此得出结论，重复事件被捕获为频域中的主要频率分量。
为了计算事件的突出频率，首先对视频信号应用FFT，然后将幅度最大的频率视为突出频率f
V。然后以从视频信号f^V获得的频率对CSI信号应用带通滤波器，以去除无关的频率分量（例如，小于0.3
Hz的频率分量，主要捕获诸如姿态变化之类的较慢的运动），并且提取最大幅度频率f^C。
## 0x08 Comparison Module
给定视频和CSI信号的两组属性:
计算出相似度S(i)一个观察到的事件Event(i)。首先确定两个信号之间的每个属性相似度得分，如下所示：
其中Tj是每个属性的阈值，△j是两个信号的三个属性之间的差，如下所示：
根据经验选择每个属性阈值，以获得可接受的检测精度，并且每个属性的误报率低。为了实现这一点，计算每个属性将合法视频检测为合法，将重放视频检测为重放的准确性。较低的阈值可能会导致将合法视频误识别为重放视频，而较高的阈值会导致将重放视频错误地检测为合法视频，从而降低了准确性。
因此，选择精度最大的阈值作为每个属性阈值。观察到开始和结束时间属性阈值分别为2.5秒和2秒，而频率属性阈值为0.25
Hz是最佳的。随后计算每个事件的相似性得分，范围从0到3，如下所示：
## 0x09 Decision Module
决策模块将一个或多个单独观察到的事件的相似性得分作为输入，并输出是否重放视频馈送的最终决策。当考虑多个事件时，检测准确性（即SurFi检测到视频馈送何时重放的有效程度）将提高，误报率降低。
这是因为考虑到来自独立观察事件的更多相似性评分时，SurFi可以为最终决策获得更高的置信度。首先获取多个事件的相似性得分的平均值，然后将其与决策阈值进行比较。该阈值的选择会影响检测准确性和误报率。
## 0x10 Evaluation
###  A、实验设置
下图显示了特定地点的设置。在一个小型室内办公室（宽4.9米×长2.6米）中进行了受控实验。使用两台配备Intel NIC 5300的Thinkpad
W500笔记本电脑设置了收发器，它们在桌上的间隔为1.6米。在Ubuntu 14.04上使用Linux 802.11n CSI工具从5
GHz频率范围的Wi-Fi数据包中提取CSI值。发送器每1毫秒发送一个ping数据包，接收器收集CSI值。总体而言，由于两台笔记本电脑配备了一个发射器和三个接收器天线，因此获得了90个子载波的CSI值。
对于视频源采集，使用安装在墙中间的移动电话上的摄像头录制视频片段（分辨率为1300万像素，采样率为30帧/秒）。
要求参与者执行以下三个事件：
（E1）以0.6 Hz的频率重复站立和左臂上下移动；
（E2）以1 Hz的频率反复在桌子上坐着并重击右拳；
（E3）以1.6 Hz的频率反复坐着并拍手。
在实验中，让四个参与者测试了三个事件，每个参与者进行了21次试验。指示参与者以一定的频率执行选定的活动。为了表示更现实的事件发生时间，将每个试验的开始和结束时间随机化（分别在5到15秒的范围和25到35秒的范围内随机选择），使得每个试验的长度为10到30秒。
###  B、基于属性的相似度比较
现在，评估SurFi如何利用这三个属性比较视频和CSI信号之间的相似性，从而最终检测出潜在的攻击。下图描绘了在三种事件类型中，合法事件和攻击事件的观察到Event(i)的每个事件相似性得分S(i)的分布。对于合法情况，通过比较从实时（因此是真实的）视频提要中提取的属性和CSI信号来计算S(i)。随后，将其余事件视为攻击事件。
因此，对于攻击事件，通过比较从循环视频源中提取的属性（包含不同事件类型）和CSI信号来计算事件S(i)。例如，在循环视频反馈中执行E1，而在实际实验中执行E2。总体而言，针对每种事件类型（例如E1，E2，E3）进行了84次代表合法事件的判断，并针对代表攻击事件的每种事件类型进行了14,112次判断。
合法事件的平均每次事件相似性得分（即2.6、2.5和2.8）比攻击事件（即0.81、0.77和0.79）高得多。两种事件的每次事件相似性得分的明显差异表明，所选属性可以独立于事件类型和主题有效地区分案例。但是，它们的高方差（例如，通常接近1）可能会导致某些错误的攻击检测和错误警报。
###  C、攻击检测精度
现在在短时间内（例如几分钟）观察到多个事件评估SurFi的整体性能，以提高攻击检测的准确性。定义两个性能指标，如下所示：
（1）攻击检测准确度：正确地将循环视频馈送识别为循环的比率；
（2）误报率：合法视频提供的比率被错误地检测为循环。
将事件随机附加在一起以模拟多个事件序列。然后获取该序列的每个事件相似度得分的平均值。如前所述，观察到的事件越多，用于检测攻击的事件越多，对最终决定的准确率就越高，从而提高了攻击检测的准确性。下图显示了SurFi攻击检测对不同事件数量（从1到5）和目标误报率（0.1％至0.9％）的准确度。
可以观察到，当获得的误报率不超过0.1％时，SurFi仅一次事件即可达到36％的检测精度。当它对相同的目标误报率使用五个事件时，它可以实现高达98.8％的检测精度。如图所示，随着目标误报率的增加，检测精度进一步提高。将更多事件用于攻击检测时可以实现更高的检测精度，因为随着事件数量的增加，相似性分数分布的方差会减小。
## 0x11 Conclution
**更强大的攻击者模型：**
攻击者击败SurFi的方法之一是模仿受攻击视频中对象的活动。但是，此类攻击所需的复杂程度非常高，因为小的差异将导致属性上的差异。此外，SurFi的决策模块要求攻击者一直模仿多个事件，这使得规避SurFi防御更加困难。
**部署注意事项：** 在实际使用SurFi系统时，可能需要执行一些校准，因为在攻击检测中使用了一些阈值适应新环境。
SurFi还需要在战略上将接收器放置在离墙壁一定距离的位置，以最大程度地减少由于墙下活动引起的误报。
在本文中提出了SurFi，这是一种实时检测监控摄像头回放攻击的系统。SurFi利用现有的Wi-Fi基础架构（因此不需要额外的硬件或部署成本）来提取通道状态信息（CSI），以处理和关联视频和CSI信号以检测任何不匹配。
随着更多的事件被两种异质感测方式感知和关联，SurFi增加了其检测置信度。SurFi概念验证可实现高达98.8％的攻击检测精度和0.1％的误报率。在今后的工作中，计划针对更复杂的攻击者模型，针对各种事件和环境进行更全面的实验。