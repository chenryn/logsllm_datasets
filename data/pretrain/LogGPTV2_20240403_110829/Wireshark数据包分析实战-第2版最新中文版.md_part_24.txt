无线客户端
无线客户端
无线客户
图11-4不同的无线网卡模式
二
adhoc模式
被管理模式
无线客户端
（监听）
监听模式
无线客户端
无线AP
（主机）
主模式
二
无线客户端
无线客户端
无线客户端
无线客户
第11章无线网络数据包分析 241
---
## Page 256
11.3
11.3.1
在Windows上噢探无线网络
242Wireshark数据包分析实战（第2版）
配置AirPcap
件来完成工作。
3章讨论的WinPcap驱动和一个特制的客户端配置工具。
AiPcap像U盘一样小巧，如图11-5所示，用于捕获无线流量。AirPcap使用第
www.cacetech.com/）被设计用来突破Windows强加给无线数据包分析的限制。
控制面板提供了以下几个选项。
多个AirPcap设备时，可用来识别正在使用的适配器。
你使用多个AirPcap设备，同时噢探多个信道。
勾选这个复选框（包含FCS校验和）。
Interface：你可以在这里选择要捕获的设备。
Include 802.11 FCSimFrames:默认情况下，
AirPcap
FCS
---
## Page 257
11.3.2
你需要在这里填入正确的WEP密码。WEP密码将在11.8节“无线网络安全”
可见）允许你输入所噢探网络的WEP密码。为了能解密WEP加密的数据，
认为成功接收的那些数据包。
设备0，如图11-7所示。
中讨论。
AirPap Control Pane
[etContguion)
Setinu 
CT11
Ch2.
Batic.Conigsaton
Modt Aacan Tx
nietace
图11-6AirPcap配董程序
Tianmt.er
011
第11章无线网络数据包分析243
---
## Page 258
11.4在Linux上嗅探无线网络
WihCatureOons
在Linux系统中
mit ech pcet to1
lntelflaceLocal
Coptute-
Stop Cagturt
Z lngbufe with
uxmutletles
Fle
Captune Fles
Capture fiten
-e
Nntfitoog
Hetleoe
-alle
-ahte
lnlertace
Advancd WiesSetngi
SaticParameters
图11-7 选择AirPcap设备作为捕获接口
Capture Type.
Channel Otfset
Channet
pedebi
0211·Fado
2462[0G11]
Emieeod
LEbyte
minutetx
nmertal
Browse..
FCSFiterA Fames
1l82.11 FC5in ftmes
Buftersize1
Display Opton
EMACme lton
Nane Recoluton
Automticicollngi fiecaptus
ptlfkint
Erleportnres
Enleeomestn
Remete Settings
Bink Led
然后启动
---
## Page 259
注意
的信道为信道3。
可以将eth1配置成监听模式。
切换用户（su）命令，如下所示。
模式已经被设置为“被管理”，这就是我们想改动的地方。
（Extended Service Set ID，ESSID）、频率等。我们注意到“eth1”下面一行显示，
extensions".
它显示了与802.11g协议有关的数据，反观eth0和1o0，它们只返回了“nowieless
应该会看到这样的结果。
#iwconfig eth1 up
下命令，
#iwconfig eth1 mode monitor
Password:
Ssu
eth1
100
etho
$ iwconfig
你成为root用户后，就可以键入命令来配置无线网卡选项。输入以下命令
要将eth1改成监听模式，你必须以root用户身份登录。可以直接登录或用
这个命令提供了许多无线配置信息，仔细看下，有无线扩展服务设置ID
iwconfig命令的输出显示eth1 接口可以进行无线配置。这是显然的，因为
no wireless extensions
Tx excessive retries:0 Invalid misc:0 Missed beacon:2
Bit Rate:54 Mb/s
Mode:Managed Frequency:2.462 GHz
Power
no wireless extensions
，以确保ethl接口可以工作。
Access Po1nt:00:02:20:88:70:2E
第11章 无线网络数据包分析245
---
## Page 260
11.5
802.11数据包结构
246Wireshark数据包分析实战（第
常见的子类型包括请求发送（request-to-send）和准予发送（clear-to-send）数据包。
数据包
网络的数据包。
10-2d11cfeSN15N=0g
控制：控制数据包允许管理数据包和数据数据包的发送，并与拥塞管理有关。
数据：这些数据包含有真正的数据，也是唯一可以从无线网络转发到有线
®
C
③
个无线数据包的类型和子类型决定了它的结构，因此各种可能的数据包
0155
seacon
8888
Ver
yar
3288
dor
nuber
Indic
551
Info
Db-222ba(02113:46:0b:22:ba)
32#8
1352
D-Lfnl0b:22:ba
Ather
anageent frase
1359#
30828
---
## Page 261
11.6
在Packet List面板增加无线专用列
结果不符的数字。
相差不大。
11上工作。
很多信息。显然这是一台D-Link设备，使用802.1Ib标准（B），在信道
虽然802.11管理数据包的具体内容和用途不一样，但总体结构跟这个例子
SSIDParameter Set WAP广播的 SSID（网络名称）
在802.11管理帧头部发现了其他信息，包括以下内容。
在这些知识的基础上，我们可以了解到示例文件中发送beacon的WAP的
这个头部也包含了来源和目的地址以及厂商信息
DS Parameter WAP广播使用的信道。
Supported RatesWAP支持的数据传输率。
Capability Information WAP的硬件容量信息
Beacon Interval beacon数据包重传间隔
信号强度。
Timestamp
发送数据包的时间戳。
第11章无线网络数包分析247
---
## Page 262
Wie
11.7无线专用过滤器
248Wireshark数据包分析实战（第）
aput
Font
加3列之后，Preferences窗口应该像图11-10一样。
1.选择Edit->Preferencesa
2.
到Columns 部分，并单击Add。
6.重启Wireshark以显示新列。
5.单击OK按钮使改动生效。
Title
TXRate
RS
le
Add
sabon
cy/Channe
图11-10在PacketList面板增加与无线相关的列
thefiitywiedyetle
hopenan
Time fmtpecfed)
fieldtype
主0.11
TEE802.11RSS
Pretocoi
Destinationaddress
Sourct ddren
linfocmation
fadnamr
FedtpeX
col
Appy
---
## Page 263
11.7.1
11.7.2
筛选特定 BSS ID 的流量
筛选特定的无线数据包类型
使用这个过滤器。
BSSID域。过滤器就基于这个地址来编写。找到BSSIDMAC地址后，你可以
到这个信息易如反掌。
组都包含这个名称。
包类型和子类型的简要参考。
fc.type来实现：对于特定类型或子类型的组合，可以用过滤器we.fc.type_subtype
常需要基于这些类型和子类型来筛选数据包。对于特定类型，可以用过滤器wlan
wlan.bssid.eq 00:11:22:33:44:55:66
Association request
Data frame
Control frame
Management frame
帧类型/子类型
表11-1无线类型/子类型和相关过滤器语法
Disassociate
Beacon
Probe response
Probe request
Reassociation response
Reassociation request
Association response
在本章前面，我们曾讨论过你可能在网络上看见的无线数据包类型。你通
这样你就能只看见流经该特定WAP的流量了。
一旦得到感兴趣的WAP所传输的数据包，你需要在802.11头部中找它的
一旦你知道想要查看的BSSID名称，你需要做的只是找到那个WAP发送
过滤器语法
wlanfsupqA
wan.f.yp_subpq08
wan.fey
obdnd
wun.fctsueq3
wlan.fe.typesubypecq02
wlan.ftpesubtyeqxo1
wn.f.ypesyeq0
wlan.fe.ype.q2
wlan.fc.typeeq
wlan.fc.type.cq
第11章 无线网络数据包分析249
---
## Page 264
11.7.3
筛选特定频率
顿类型/子类型
BlockACKrequests
Action frame
Deauthentication
Authentication
Clear to send
Request to send
Power save poll
BlockACK
流量。如果发现有流量，那你就知道一定是哪里弄错了一
Null QoS data
QoS data
NULLdata
Contention free period end
ACK
频率。表11-2列出了信道和频率的对应表格。
radiotap.channel.freq == 2412
信道
表11-2802.11无线信道和频率
wlan.fc.type_subtypeeq OxOD
wlan.fc.typesubtype eq Oxoc
wlan.fe.type_subtype eq OxOB
过滤器语法
wlan.fe.type_subtype cq Ox1A
wlan.fe.type_subtype eq 0x19
wlan.fc.type_subtype eq 0x18
wlan.fc.type_subtype eqOx1E
wlan.fe.type_subtype eq 0x1D
wlan.fe.type_subtype eq 0x1C
wlan.fe.type_subtype eq 0x1B
wlan.fc.type_subtypeeq 0x2C
wlan.fe.type_subtype eq 0x28
wlan.fc.type_subtype eq 0x24
2412
频率
2437
2432
2427
2422
2417
2457
2452
2447
2442
2462
—或许是配置错误，
续表
---
## Page 265
11.8
11.8.1
注意
无线网络安全