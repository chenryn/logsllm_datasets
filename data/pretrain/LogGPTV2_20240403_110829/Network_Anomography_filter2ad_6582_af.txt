4
6
6
17
18
18
6
1
6
1
7
6
17
18
17
6
8
7
8
2
8
20
20
23
4
3
5
3
6
1
13
14
16
14
10
15
10
18
12
14
14
11
14
13
13
13
19
13
0
1
8
Table 1: False positives seen in the top 30 inferred anoma-
lies compared against the top 50 benchmark anomalies.
Top 50
Inferred Diff ARIMAEWMA H-W FFT Wavelet PCA TPCA
False Negatives with Top 30 Benchmark
Diff
ARIMA
EWMA
0
1
0
Holt-Winters 1
3
0
14
10
17
Wavelet
TPCA
PCA
PCA*(37)
FFT
1
0
1
0
8
2
14
13
18
0
1
0
1
4
1
14
10
18
1
0
1
0
8
2
14
13
18
5
6
5
6
1
5
19
15
21
5
4
5
4
7
0
15
11
19
12
12
12
12
18
11
15
13
16
17
18
17
18
19
13
3
1
8
Table 2: False negatives seen in the top 50 inferred anoma-
lies compared against the top 30 benchmark anomalies.
N . We therefore report the actual number of anomalies in
the table next to the label PCA*.
From the table, we observe from the upper left 6 × 6
quadrant that the ARIMA, FFT and Wavelet approaches
tend to have relative low false positives among detected
anomalies. Thus, the top 30 ranked anomalies derived
through these approaches indeed appear to be anomalous
trafﬁc events that are worth investigating.
The PCA based approaches, however, exhibit a higher
false positives when benchmarked against other ap-
proaches. This appears to be partially due to PCA iden-
tifying anomalies of a different type than those identiﬁed
by the methods. Consider, for example, a sudden increase
of trafﬁc for an OD ﬂow that persists for a couple of hours.
PCA methods may identify every instance within the two-
hour period as anomalous. ARIMA based approaches de-
tect abrupt trafﬁc changes. Hence ARIMA based methods
likely extract only the “edges” – the ﬁrst and last instance
– of the two-hour period. Another factor contributing to
PCA’s false positives may be its lack of self-consistency:
anomalies present in the OD pairs but not detected by the
method in the link loads. In addition, unlike ARIMA, FFT,
or wavelet based tomography, both spatial PCA and tem-
poral PCA cannot fully utilize temporal ordering informa-
tion in the measured time series data. For example, any
reordering of the time series, b1, b2, ...,bt, does not affect
the outcome of the algorithm.
Table 2 presents the number of false negatives for M =
30 and N = 50, where we are interested in the number of
large anomalies that are not identiﬁed by each approach.
We observe that the ARIMA methods, FFT and Wavelet
anomography approaches have superb performance – the
number of false negatives are very low. This indicates that
very few important trafﬁc anomalies can pass undetected
by these approaches. The PCA based approaches, however,
identify about half of the anomalies.
7 Conclusions
In this paper, we introduced network anomography, the
problem of inferring network-level anomalies from widely
available data aggregates. Our major advances are:
1. We introduced a powerful framework for anomography
that cleanly separates the anomaly detection component
from the inference component. The framework opens
up a wide ﬁeld for innovation and for the development
of families of new algorithms. The novel method of
Lakhina et al. based on PCA falls within the framework.
2. Within the framework, we put forward a number of
novel algorithms,
taking advantage of the range of
choices for anomaly detection and inference compo-
nents and choosing between temporal versus spatial ap-
proaches.
3. We developed a new dynamic anomography algorithm,
which tracks both routing and trafﬁc measurements, and
so enables alerting with high ﬁdelity on trafﬁc matrix
anomalies, without alerting on internal routing changes
that leave the trafﬁc matrix relatively stable. As rout-
ing changes are often due to normal internal self-healing
behavior separating these changes from intrinsic trafﬁc
anomalies is advantageous. An additional beneﬁt of dy-
namic anomography is that is robust to missing data, an
important operational reality.
4. Using extensive data from Internet2’s Abilene net-
work and a Tier-1 ISP, we evaluated these anomogra-
phy methods. The ﬁndings are encouraging. Speciﬁ-
cally, the results indicate that the new set of temporal
anomography methods introduced here have better ﬁ-
delity, particularly when using l1 minimization for the
inference step. Dynamic anomography using ARIMA
based methods and l1 norm minimization shows uni-
formly high ﬁdelity (low false positive and false nega-
tives) and high robustness (to routing changes and miss-
ing or corrupted data).
While we believe our work represents a signiﬁcant ad-
vance in the state of the art, we recognize that the the ul-
timate test of performance is signiﬁcant operational expe-
rience: utility is bringing to light in the ﬁeld new anoma-
lies that were “ﬂying under the radar” of other techniques,
while producing very few false alarms. Our larger goal in
future work is to explore the feasibility and performance
of automated trafﬁc management systems, which incorpo-
rate anomaly detection, root cause diagnosis and trafﬁc and
route control for operational networks.
USENIX Association
Internet Measurement Conference 2005  
329
Notes
1Note that the link load vector bj includes the aggregated traf-
ﬁc at different ingress/egress points; the corresponding rows in Aj
encode the OD ﬂows that enter/exit the network at these points.
2We have veriﬁed that Pseudoinverse and Sparsity-Greedy
work even worse than Sparsity-L1 for PCA.
References
[1] P. Barford, J. Kline, D. Plonka, and A. Ron. A signal analy-
sis of network trafﬁc anomalies. In ACM Internet Measure-
ment Workshop, Nov. 2002.
[2] G. E. P. Box, G. M. Jenkins, and G. C. Reinsel. Time Series
Analysis, Forecasting and Control. Prentice-Hall, Engle-
wood Cliffs, 1994.
[3] P. J. Brockwell and R. A. Davis. Introduction to Time Series
and Forecasting. Springer-Varlang, 2nd edition, 2002.
[4] J. D. Brutag. Aberrant behavior detection and control in
time series for network monitoring. In 14th Systems Admin-
istration Conference (LISA 2000), Dec. 2000.
[5] J. Cao, D. Davis, S. V. Wiel, and B. Yu. Time-varying net-
work tomography. J. Amer. Statist. Assoc, 95(452):1063–
1075, 2000.
[6] I. Daubechies. Orthonormal bases of compactly supported
wavelets. Communications on Pure and Applied Mathemat-
ics, 41:909–996, 1988.
[7] I. Daubechies. Ten Lectures on Wavelets, volume 41 of
CBMS-NSF Regional Conference Series in Applied Mathe-
matics. SIAM, 1992.
[8] D. L. Donoho. For most large underdetermined systems
of equations, the minimal l1-norm near-solution approxi-
mates the sparsest near-solution, Aug. 2004. http://
www-stat.stanford.edu/˜donoho/Reports/.
[9] D. L. Donoho. For most large underdetermined systems of
equations, the minimal l1-norm solution is also the sparsest
solution, Sept. 2004. http://www-stat.stanford.
edu/˜donoho/Reports/.
[10] A. Feldmann, A. Greenberg, C. Lund, N. Reingold, and
J. Rexford. Netscope: Trafﬁc engineering for IP networks.
IEEE Network Magazine, pages 11–19, Mar./Apr. 2000.
[11] A. Feldmann, A. Greenberg, C. Lund, N. Reingold, J. Rex-
ford, and F. True. Deriving trafﬁc demands for operational
IP networks: Methodology and experience.
IEEE/ACM
Transactions on Networking, 9(3):265–279, 2001.
[12] A. Graps. Amara’s wavelet page, 2004. http://www.
amara.com/current/wavelet.html.
[13] M. Grossglauser, N. Koudas, Y. Park, and A. Variot. FAL-
CON: Fault management via alarm warehousing and min-
ing. In NRDM 2001 Workshop, May 2001.
[14] A. Gunnar, M. Johansson, and T. Telkamp. Trafﬁc matrix
estimation on a large IP backbone: A comparison on real
data. In ACM Internet Measurement Conference, Oct. 2004.
[15] C. Hood and C. Ji. Proactive network fault detection. IEEE
Trans. Reliability, 46(3):333–341, 1997.
[16] Katzela and Schwartz. Schemes for fault identiﬁcation in
communication networks. IEEE/ACM Transactions on Net-
working, 3(6):753–764, 1995.
[17] B. Krishnamurthy, S. Sen, Y. Zhang, and Y. Chen. Sketch-
based change detection: Methods, evaluation, and applica-
tions. In ACM Internet Measurement Conference, Oct. 2003.
[18] A. Lakhina, M. Crovella, and C. Diot. Characterization of
network-wide anomalies in trafﬁc ﬂows. In ACM Internet
Measurement Conference, Oct. 2004.
[19] A. Lakhina, M. Crovella, and C. Diot. Diagnosing network-
wide trafﬁc anomalies. In ACM SIGCOMM, Aug. 2004.
[20] A. Lakhina, K. Papagiannaki, C. D. Mark Crovella, E. D.
Kolaczyk, and N. Taft. Structural analysis of network trafﬁc
ﬂows. In ACM SIGMETRICS, 2004.
[21] S. Mallat. A Wavelet Tour of Signal Processing. Academic
Press, San Diego, 2nd edition, 2001.
[22] A. Medina, N. Taft, K. Salamatian, S. Bhattacharyya, and
C. Diot. Trafﬁc matrix estimation: Existing techniques and
new directions. In ACM SIGCOMM, Aug. 2002.
[23] A. Nucci, R. Cruz, N. Taft, and C. Diot. Design of IGP link
weights for estimation of trafﬁc matrices. In IEEE Infocom,
Mar. 2004.
[24] Y. C. Pati, R. Rezaiifar, and P. S. Krishnaprasad. Orthog-
onal matching pursuit: Recursive function approximation
with applications to wavelet decomposition. In 27th Annual
Asilomar Conference on Signals, Systems, and Computers,
1993.
[25] M. Roughan, T. Grifﬁn, M. Mao, A. Greenberg, and B. Free-
man. IP forwarding anomalies and improving their detection
using multiple data sources. In ACM SIGCOMM Workshop
on Network Troubleshooting, pages 307–312, Sept. 2004.
[26] SAS 9 online document. Equations for the smoothing mod-
els, Jan. 2004. http://support.sas.com/91doc/
getDoc/hpfug.hlp/hpfdet_sect7.htm.
[27] A. Shaikh, C. Isett, A. Greenberg, M. Roughan, and J. Got-
tlieb. A case study of OSPF behavior in a large enterprise
network. In ACM Internet Measurement Workshop, 2002.
[28] C. Tebaldi and M. West. Bayesian inference on net-
work trafﬁc using link count data. J. Amer. Statist. Assoc,
93(442):557–576, 1998.
[29] R. Teixeira, N. Dufﬁeld, J. Rexford, and M. Roughan. Traf-
ﬁc matrix reloaded: Impact of routing changes renata teix-
eira.
In Workshop on Passive and Active Measurements
(PAM), 2005.
[30] M. Thottan and C. Ji. Proactive anomaly detection using
distributed intelligent agents. IEEE Network, Sept/Oct 1998.
estimating source-
destination trafﬁc intensities from link data. J. Amer. Statist.
Assoc., 91(433):365–377, 1996.
Network tomography:
[31] Y. Vardi.
[32] A. Ward, P. Glynn, and K. Richardson.
Internet service
performance failure detection. ACM SIGMETRICS Perfor-
mance Evaluation Review archive, 26(3):38–43, Dec. 1998.
[33] Y. Zhang, Z. Ge, A. Greenberg, and M. Roughan. Network
anomography. UT-Austin Technical Report, 2005. http:
//www.cs.utexas.edu/˜yzhang/papers/.
[34] Y. Zhang, M. Roughan, N. Dufﬁeld, and A. Greenberg. Fast
accurate computation of large-scale ip trafﬁc matrices from
link loads. In ACM SIGMETRICS, June 2003.
[35] Y. Zhang, M. Roughan, C. Lund, and D. Donoho. An
information-theoretic approach to trafﬁc matrix estimation.
In ACM SIGCOMM, Aug. 2003.
330
Internet Measurement Conference 2005 
USENIX Association