The good and bad about 
Streaming media 
How streaming media can be 
stolen and how to protect it.
Who are you?
tommEE pickles
Crazy clown from 
NYC
Lives in LA
Single
Arrested, Jailed…
Media Whored…
Likes to drink
Qualifications
Over 12 years of commercial computer 
experience
Worked on Computer Radar Controlled 
Weapon Systems
Developed streaming media solutions for 
Digital Club Network
Runs media website Moloch.TV
Always encoding TiVo Videos and storing 
them on a file server.
What the hell is Streaming Media?
Streaming Media is multimedia content 
transported though protocol like http, 
pnm, rtsp, or mms
Common types of Streaming Media are
 Real Networks (aka Real One)
 Shoutcast, Icecast (aka MP3 streaming)
 Microsoft Windows Media (aka most 
proprietary)
Media Players…
Quick and dirty intro to the 
different clients.
Real Player
Windows Media Player
Quicktime
Winamp,
etc…
Real Player
Plays lots of file formats
Multi platform
 Windows
 Unix
 Mac
 Linux
SureStream Technology
Full Screen
MPEG4 with Envivo Plug-in
But…
Real Player
Plus Version costs money
Player has not been updated on Unix
 Update: codec has been updated
Sole purpose seems to be commerce
Windows Media
Multiple media formats: asf, wmv, avi, mpeg, 
mp3
Included with Windows
Skin-able
Full Screen
Large Demographic
Wine will support Media Player 6.4
But…
Windows Media
DRM (Digital Rights Management)
No constancy between player versions.
Makes use of shared libraries for codec
Quicktime Player
Supports MPEG4
Can edit files
Supports Windows and Mac
But…
Quicktime
Not supported by Unix without wine 
 Plugger is an exception
Full screen only used in Paid Versions
Editing only used in Paid Version
The servers…
Brief introduction into the various 
servers that have ability to stream
Real Server
Windows Media Server
Darwin
Shoutcast, Icecast
Real Server
It’s free… (to an extent)
It’s multi platform, runs from cmd line
It’s widely used
But…
It’s costly and can be exploited
Quicktime Server
Free Server
But…
Not as easy to serve stuff
Has been exploited in the past
Microsoft Media Server
Free… with Microsoft Windows 2000 
Advanced Server
But…
Many exploits
Poor logging
Shoutcast, IceCast
MP3 streaming
Free servers
Runs on Linux
But…
It has been exploited in the past.
Lets start simple
The easiest ways of serving and 
how to steal…
Lets let people download
One way people can serve today is just 
by the upload-and-serve method.
 Make a file. Real, Windows, MP3, QT, etc.
 Upload it to your site. SCP, FTP, etc.
 Create a link on your page.
Ok, you can probably see how to grab the 
media here but you can control the 
downloading by htaccess or JavaScript.
Ok, lets stream it, cheap
For every file there is another way to 
make it look like streaming with a batch 
file type of text file.
(e.g. ram > rm, or asx > asf or m3u > 
mp3)
Two reasons for this…
 To make the file stream instead of save as.
 Security though obscurity
Getting around the html
wget or lynx –dump
right click and save as.
 Either way, get the file local. You can then look at 
the ram or asx, etc. in a text editor and figure 
where to go from there.
 If it is a http:// inside the text file, just wget or 
lynx –dump the location. If you are on windows, 
make a html file with right click here and 
right click and save.
Siphoning the html
For even the easiest streaming theft you 
have to look through the html code.
View source or view page source and 
search for media types. (e.g. 
rm,ram,mpg, mp3, wav, avi, mov)
If right clicks and the menus don’t 
work. Don’t forget the windows keys.
Sniffing
Sniffing is another way of finding the 
URLs that the javascript or SQL is 
hiding.
Advanced ways can include tcpdump or 
windump
Media from media servers
Some people/companies have figured out 
the best and most secure way of 
serving data is with media servers.
There are ways around this also
A word about realmedia logs
Real server logs are best on Linux
They only log on disconnect
 It’s a TCP connection, then it will stream UDP
 Real will log when player disconnect from the 
server. (info like ip, player version, time media 
was played and what speed)
 Most times the media will be served over UPD and 
the TCP session will control the SureStream speed.
Streambox VCR
Preceded by Streambox Ripper. An 
enemy of Real Networks.
10/2000 Streambox settled with Real Networks a dispute where to 
supposedly protect private content of Real Media publishers by no longer 
allowing Streambox to sell its utility Streambox Ripper which actually 
converts real media files to wav format. 
Still can be found on the net and 
updated for Real 9 Helix
Basically it fakes a real player 
connection, that’s all.
Streambox VCR
Streambox VCR
Streambox VCR
Lets try to fight this…
How?
It’s possible but there are problems.
Real doesn’t log until disconnect
 So you have to watch for the first file…
So if they use Streambox is there ways to 
hide the files from it?
 Yes, with J2EE or tomcat along with sql. Very 
effective.
What about the signature of Streambox?
 Its possible to stop illegal players connecting in 
the real server configuration.
Leeching Windows Media
Windows makes internet fun by integrating the 
desktop with the browser
You can use mms:// in most applications
mms is the Microsoft media server protocol. 
Windows Media Server comes with Windows 
2000 Advanced Server.
Doesn’t log well at all
 After all, it’s Windows
STOIK Video Converter 
This is one program that converts asf to wmv or avi. I experimented it with mms://
STOIK Video Converter
Basically you have to find the source by siphoning the html and 
then usually wget the asx file. cat/notepad/more the file to get 
the mms:// url.
STOIK Video Converter
ASFR+
ASFR+ is the successor of asfrecorder
Support HTTP and MMS(TCP) protocol.
Download multiple parts simultaneously 
for a huge speed up.
Fixing data while downloading.
Auto retry & resume if connection's 
broken.
Support CJK characters in URL
ASFR+
Windows Media Protection
Proxy it? Maybe. Beyond that?
I don’t know
Clearly it must, right?
Event type
Message
Station
New station added. Station name is station name.
Station
Station has been deleted. The station name was station name and the 
description was station description.
Station
Station property changed. Station name is station name.
Stream
Stream from source stream alias or stream URL on station station name
activated.
Stream
Stream from source stream alias or stream URL on station station name
deactivated.
Stream
New stream opened. Stream source is stream alias or stream URL.
Stream
Stream closed. The stream source was stream alias or stream URL and 
the description was stream description.
Stream
Stream has started. Stream source is stream alias or stream URL.
Stream
Stream has stopped. Stream source is stream alias or stream URL.
Stream
Stream property changed. Stream source is stream alias or stream URL.
Stream
Stream archive closed.
Client
Client connected. The client address/port is IP Address/Port.
Client
Client disconnected. The client address/port is IP Address/Port.
How to Grab the MP3s
If MP3 files are on a website, you can 
just right click, and save as.
If .m3u files are on a website, you can 
save or wget the file and find the links.
If it is then Shoutcast (IceCast), one 
way is Winamp…
Winamp
Winamp is a graphical MP3 player
Available in Versions 2 and 3
Winamp 2 below
Disk Writer and File Writer
Disk Writer and File Writer are plugins 
for Winamp
File Writer is newer and 
faster for writing files.
This is dependant on 
bandwidth and 
buffering.
My Stream Saver
Really Simple
Just like File Writer in a way.
Bad News
Winamp corrected the Disc Writing Steal
But…
Good News
Streamripper
Streamripper started as a way to separate 
tracks via Shoutcast's title-streaming feature. 
This has now been expanded into a much 
more generic feature, where part of the 
program only tries to "hint" at where one track 
starts and another ends, thus allowing a mp3 
decoding engine to scan for a silent mark, 
which is used to find an exact track 
separation.
Streamripper
Freeamp 2.1
XMMS
Will work with Disk Writer Plug-In
Protect the MP3 Streaming
Embedded MP3s could help but 
someone can siphon the html
.htaccess files could limit users
Disk Writing and File Writing Plug-Ins 
won’t work.
Last Words
Watermarking or embossing logos 
would own your media.
Security through obscurity in a solution, 
sometimes.
When you want to stream, decide on 
you security need first. Should the 
people have the right to save your 
content.
Links
http://www.interlog.com/~tcharron/wgetwin.html
http://www.souxin.com/en/stream-software-down.htm
http://www.afterdawn.com/software/audio_software/
http://www.stoik.com/products/morphman/mm30_svc.htm
http://astalavista.box.sk
http://www.streamking.com
http://www.eeye.com/html/Products/Iris/Download.html
http://classic.winamp.com/
http://classic.winamp.com/plugins/detail.jhtml?componentId=96985
http://streamripper.sourceforge.net/
ftp://ftp.cs.tu-berlin.de/pub/misc/freeamp/FreeAmpSetup_2_1_1.exe
http://windump.polito.it/
http://www.garykessler.net/library/file_sigs.html
QUESTIONS
Contact
tommEE pickles
Moloch Industries
PI:EMAIL
http://moloch.org
http://moloch.tv
http://tommEE.net