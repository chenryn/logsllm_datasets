Conﬁcker
Flashback
Virut
ZeuS P2P
Table 6. Coverage of DGA-based domains
Family # Domains Listed Reg. tReact # Domains Listed Reg.
Table 6 illustrates
the listing behavior
we monitored in the
period Jan. 2012 to
Mar. 2014 for
the
public blacklists (ﬁrst
major column) and
on a typical week-
day in Mar. 2014 for
the AV vendor black-
(second major
lists
column). In total, less than 1.2% of all domains were listed by the public black-
lists. On the positive side, blacklists have a low reaction time for three families
(if they blacklist a domain). On the downside, 82.1% of the matches are found
in the blacklist Virustracker only. When removing Virustracker from SMal, the
reaction times increase signiﬁcantly for most families (i.e., Bamital : 12 days,
Conﬁcker : 12 days, Flashback : 381 days, Virut : -271 days, and ZeuS P2P : 16
days). Before removing Virustracker from SMal, we ﬁnd 0.2% of the Virut do-
mains to be blacklisted. After removing Virustracker, we ﬁnd merely 167 domains
(0.002%) to be listed. Due to the generic structure of Virut domains, we assume
that these domains are not listed to protect against Virut in particular but
rather because they were related to other malicious activities. The reaction time
conﬁrms our assumption as it is not reasonable to blacklist domains 271 days
before they become active for a single day.
We also determine the coverage of the AV vendor blacklists regarding DGA-
based domains. To avoid requesting millions of domain names, we divide our
Paint It Black: Evaluating the Eﬀectiveness of Malware Blacklists
17
analysis into two steps. To measure if the blacklists protect against threats of
DGA-based domains that are currently active, we request listing information
and DNS A records for all the domains that are valid on the day we perform this
experiment (i.e., 03/24/2014). Second, we analyze if blacklists include domain
names which become active in the future. We thus also request a sample of DGA-
based domain names (i.e., a random selection of at most 10 domains per day
and malware family, respectively, type for Conﬁcker ) that will be valid between
03/25/2014 and 04/24/2014, i.e., up to 31 days ahead of the day of requesting.
For the domains valid on the day of performing our experiment, we ﬁnd 76.1%,
respectively, 28.9% of the ZeuS P2P domains to be blacklisted by McAfee and
Bitdefender and observe the best coverage for Norton as most of the results
in Table 6 are caused by this blacklist—with a single exception. Norton lists
95.5% of the ZeuS P2P domains while the union of all AV vendor blacklists
increases the coverage up to 99.5%. For the remaining blacklists and malware
families, we ﬁnd a negligible number of listed domains (if domains are listed at
all). When taking a closer look at the registered domains that day, we ﬁnd half of
the Bamital domains and most of the domains for Conﬁcker B/C and Flashback
to be sinkholed. Further on, four domains of ZeuS P2P are sinkholed while the
168 registered Virut domains are associated to parking providers and benign
web pages. In conclusion, a partition of valid domains is sinkholed by security
researchers, yet the remaining domains could be used for malicious activities.
We thus recommend to blacklist each DGA-based domain for security reasons
(i.e., to trigger alerts). For the domains getting active in the near future, we
again ﬁnd the blacklist provider Norton to perform best. Except for Flashback
(no listed domain) and Bamital (coverage of 46.5%), we ﬁnd Norton to include
at least 94.5% of the domains for each of the remaining families. For the other
families and blacklists, we again observe a negligible number of listed domains.
Our analysis shows that as of today, only one blacklist can reasonably protect
against any of the ﬁve DGAs used in our experiments. This is surprising to us,
given the fact that—once the DGA is known—the DGA-based domains can be
accurately predicted unless there are external dependencies (e.g., DGAs utilizing
lists of popular feeds from social network web pages). One of the reasons could
be that DGAs are often used as a C&C backup mechanism only. For example,
Zeus P2P uses a DGA only if its peer-to-peer communication fails [35]. Another
reason could be that DGA-based domains may, by coincidence, collide with
benign domains. Still, as these issues can be overcome, the potential of including
DGA-based domains is unused in most of the nowadays blacklists.
6 Discussion and Future Work
We showed that our parking detection approach can eﬀectively distinguish parked
and benign domains. As our features depend on the content delivered by park-
ing services such as sponsored ads, domain resellers serving benign content and
parked domains exhibiting parking behavior diﬀerent from the expected however
cannot be eﬀectively identiﬁed by our detection model. This is particularly prob-
lematic when parking providers block us, e.g., for sending too many requests.
18
M. K¨uhrer, C. Rossow, and T. Holz
Parking services employ diﬀerent types of blocking (e.g., provide error messages,
benign content, or the parking page template without any referral links). To
avoid getting blocked, we could distribute the requests to several proxy servers
or rate-limit our requests. Further, domains might perform cloaking [36], i.e.,
provide malicious content for real users while serving parking content for auto-
mated systems. We leave a detection of cloaking domains for future work and
acknowledge that a large number of parked domains alone does not necessarily
imply that a blacklist is not well-managed. We also have to keep in mind that the
parking IDs might be biased in respect to the language of the blacklist content,
as we obtained the IDs by leveraging the NS used by the blacklisted domains.
However, our dataset does not include any national blacklists, which primarily
list domains of a speciﬁc country or language. While performing the manual
veriﬁcation for the real-world datasets in Section 3.3, we monitored many do-
mains providing content in foreign languages that were ﬂagged as parked by the
classiﬁer. This shows that our approach is largely language-independent.
The proposed sinkhole detection method relies on the blacklists to observe
behavior that can be attributed to sinkholes. As such, our detection capabilities
are limited to sinkholes that are blacklisted. We could use the identiﬁed sinkhole
dataset as ground truth and leverage techniques such as passive DNS analysis to
identify further potential sinkholes [37]. Additionally, the quality of our approach
depends on the accuracy of the blacklists. If blacklists contain too many benign
domains that cannot be ﬁltered, e.g., by removing Alexa Top 25k, parking, and
shared hosting IPs, we might ﬂag benign IP addresses as potential sinkholes.
Our evaluation on the completeness of blacklists is limited to estimating lower
bounds as Sandnet only covers a random subset of all samples of the active
malware families. Consequently, we may have missed malicious domains in Sand-
net. We aim to scale up malware execution to achieve a higher coverage.
We classiﬁed the blacklist content as parked, sinkholed, or unregistered and
analyzed the completeness of the blacklists in regards to domains of various
malware families. Yet, the blacklists also include domains we could not classify
accordingly, leaving 23.7% of the currently blacklisted domains to be unspeci-
ﬁed. These domains might also include potential false listings, e.g., caused by
erroneous setups of analysis back-ends or insuﬃcient veriﬁcation of domains that
are ﬂagged to be potentially malicious. False listings, however, are hard to iden-
tify as each blacklist applies its own listing strategy and might include domains
of malware families that are not present in Sandnet and the DGA-based do-
main dataset. Analysis techniques to identify potential false listings thus require
a thorough evaluation of correctness. We leave the categorization of the so far
unclassiﬁed domains for future work.
7 Related Work
The eﬀectiveness of malware blacklists is still largely unstudied. In prior work, we
proposed a system to track blacklists and presented ﬁrst details regarding black-
list sizes [6]. With this paper, we extend our work and evaluate malware blacklist
Paint It Black: Evaluating the Eﬀectiveness of Malware Blacklists
19
eﬀectiveness—motivated by promising results others reported with blacklists in a
diﬀerent context. For example, Thomas et al. [38] looked at blacklists in Twitter.
Similarly, Sinha et al. [39], Rossow et al. [40], and Dietrich et al. [41] evaluated
the strength of blacklists in the context of email spam, while Sheng et al. [42]
analyzed phishing blacklists.
Concurrent to our sinkhole identiﬁcation work, Rahbarinia et al. developed a
system called SinkMiner [37] to identify sinkhole IPs. They leverage pDNS data
and a priori information about sinkholes to extrapolate to other sinkholes. Our
approach does not rely on an initially-known set of sinkholes and, in its simple
form, works without pDNS. In addition, we found sinkholes which were not linked
to other sinkholes—many of which SinkMiner would miss. Nevertheless, a com-
bination of SinkMiner and our graph-based approach could identify yet unknown
sinkholes, as SinkMiner analyzes the global history of domains using pDNS while
we are limited to the history of blacklisted domains. We further proposed a more
advanced mechanism to identify parking providers. Rahbarinia et al. ﬁlter for NS
that include the term park in their hostnames. Yet, of the 204 parking NS iden-
tiﬁed in Section 3.1 we ﬁnd 59 NS to not specify this term in their hostnames.
Halvorson et al. [23,24] identify parked domains by applying regular expressions
to the aggregated web content. Instead, we introduced characteristic features for
parking behavior and—to the best of our knowledge—are the ﬁrst to propose a
generic mechanism to identify parked domains.
Orthogonal to our work, a number of proposals aim to increase the quality of
existing blacklists. Neugschwandtner et al. [43] proposed Squeeze, a multi-path
exploration technique in dynamic malware analysis to increase the coverage of
C&C blacklists. Stone-Gross et al. [44] proposed FIRE, a system to identify
organizations that demonstrate malicious behavior by monitoring botnet com-
munication. Our ﬁndings show that usage of such systems should be fostered.
8 Conclusion
We have shown that blacklists have to be employed with care as the nature of
the listings is diverse. First, one needs to keep in mind that also sinkholes may
be blacklisted. Second, many parking providers re-use popular malware domains.
This is crucial to know, e.g., when blacklists raise false positives or one aims to
attribute a reputation to certain providers based on blacklist data. In addition,
our evaluation of blacklist coverage indicates how blacklists can be improved
in the future as none of the public blacklists is suﬃciently complete to protect
against the variety of malware threats we face nowadays. We further have shown
that most blacklists operated by AV vendors do not cover DGA-based malware
to eﬀectively protect users, although integration would be straight-forward. We
are conﬁdent that our analyses will help to improve blacklists in the future.
Acknowledgment. We would like to thank our shepherd Manos Antonakakis
for his support in ﬁnalizing this paper. We also would like to thank the anony-
mous reviewers for their insightful comments. This work was supported by the
German Federal Ministry of Education and Research (Grant 01BY1110, MoBE).
20
M. K¨uhrer, C. Rossow, and T. Holz
References
1. Kolbitsch, C., Livshits, B., Zorn, B., Seifert, C.: Rozzle: De-Cloaking Internet Mal-
ware. In: Proceedings of the 2012 IEEE Symposium on Security and Privacy, SP
2012, pp. 443–457. IEEE Computer Society, Washington, DC (2012)
2. Antonakakis, M., Perdisci, R., Lee, W., Vasiloglou, I.N., Dagon, D.: Detecting Mal-
ware Domains at the Upper DNS Hierarchy. In: Proceedings of the 20th USENIX
Conference on Security, SEC 2011, p. 27. USENIX Association, Berkeley (2011)
3. Antonakakis, M., Perdisci, R., Nadji, Y., Vasiloglou, N., Abu-Nimeh, S., Lee, W.,
Dagon, D.: From Throw-Away Traﬃc to Bots: Detecting the Rise of DGA-Based
Malware. In: Proceedings of the 21st USENIX Conference on Security Symposium,
Security 2012, p. 24. USENIX Association, Berkeley (2012)
4. Bilge, L., Kirda, E., Kruegel, C., Balduzzi, M.: EXPOSURE: Finding Malicious
Domains Using Passive DNS Analysis. In: 18th Annual Network and Distributed
System Security Symposium. The Internet Society, San Diego (2011)
5. Rossow, C., Dietrich, C., Bos, H.: Large-Scale Analysis of Malware Downloaders.
In: Flegel, U., Markatos, E., Robertson, W. (eds.) DIMVA 2012. LNCS, vol. 7591,
pp. 42–61. Springer, Heidelberg (2013)
6. K¨uhrer, M., Holz, T.: An Empirical Analysis of Malware Blacklists. Praxis der
Informationsverarbeitung und Kommunikation 35(1), 11–16 (2012)
7. Microsoft Corp.: Citadel Botnet (2014), http://botnetlegalnotice.com/citadel
8. Abuse.ch Malware Trackers (2014), http://www.abuse.ch/
9. CyberCrime Tracker (2014), http://cybercrime-tracker.net
10. Malc0de.com (2014), http://malc0de.com/
11. Malware Domain List (2014), http://www.malwaredomainlist.com/
12. Malware-Domains (2014), http://www.malware-domains.com/
13. Shadowserver: Botnet C&C Servers (2014), http://rules.emergingthreats.net
14. Shalla Secure Services (2014), http://www.shallalist.de/
15. URLBlacklist (2014), http://urlblacklist.com/
16. Kleissner & Associates (2014), http://virustracker.info/
17. Bitdefender TraﬃcLight (2014), http://trafficlight.bitdefender.com/
18. BrowserDefender (2014), http://www.browserdefender.com
19. McAfee SiteAdvisor (2014), http://www.siteadvisor.com/
20. Norton Safe Web (2014), http://safeweb.norton.com/
21. K¨uhrer, M., Rossow, C., Holz, T.: Paint it Black: Evaluating the Eﬀectiveness of
Malware Blacklists. Technical Report HGI-2014-002, University of Bochum - Horst
G¨ortz Institute for IT Security (June 2014)
22. Li, Z., Alrwais, S., Xie, Y., Yu, F., Wang, X.: Finding the Linchpins of the Dark
Web: A Study on Topologically Dedicated Hosts on Malicious Web Infrastructures.
In: Proceedings of the 2013 IEEE Symposium on Security and Privacy, SP 2013,
pp. 112–126. IEEE Computer Society, Washington, DC (2013)
23. Halvorson, T., Szurdi, J., Maier, G., Felegyhazi, M., Kreibich, C., Weaver, N.,
Levchenko, K., Paxson, V.: The BIZ Top-Level Domain: Ten Years Later. In: Taft,
N., Ricciato, F. (eds.) PAM 2012. LNCS, vol. 7192, pp. 221–230. Springer, Heidel-
berg (2012)
24. Halvorson, T., Levchenko, K., Savage, S., Voelker, G.M.: XXXtortion?: Inferring
Registration Intent in the. XXX TLD. In: Proceedings of the 23rd International
Conference on World Wide Web, WWW 2014, pp. 901–912. International World
Wide Web Conferences Steering Committee, Geneva (2014)
25. Farsight Security, Inc.: DNS Database (2014), https://www.dnsdb.info/
26. Alexa Internet, Inc.: Top 1M Websites (2013), http://www.alexa.com/topsites/
Paint It Black: Evaluating the Eﬀectiveness of Malware Blacklists
21
27. Damerau, F.J.: A Technique for Computer Detection and Correction of Spelling
Errors. Commun. ACM 7(3), 171–176 (1964)
28. RapidMiner, Inc. (2014), http://rapidminer.com/
29. Hofmann, T., Sch¨olkopf, B., Smola, A.J.: Kernel Methods in Machine Learning.
Annals of Statistics 36, 1171–1220 (2008)
30. Rossow, C., Dietrich, C.J., Kreibich, C., Grier, C., Paxson, V., Pohlmann, N., Bos,
H., van Steen, M.: Prudent Practices for Designing Malware Experiments: Status
Quo and Outlook. In: Proceedings of the 2012 IEEE Symposium on Security and
Privacy, SP 2012. IEEE Computer Society, San Francisco (2012)
31. Rossow, C., Dietrich, C.J., Bos, H., Cavallaro, L., van Steen, M., Freiling, F.C.,
Pohlmann, N.: Sandnet: Network Traﬃc Analysis of Malicious Software. In: Pro-
ceedings of the First Workshop on Building Analysis Datasets and Gathering Ex-
perience Returns for Security, BADGERS 2011, pp. 78–88. ACM, NY (2011)
32. Dietrich, C.J., Rossow, C., Pohlmann, N.: CoCoSpot: Clustering and Recogniz-
ing Botnet Command and Control Channels using Traﬃc Analysis. Comput.
Netw. 57(2), 475–486 (2013)
33. Rossow, C., Dietrich, C.J.: ProVeX: Detecting Botnets with Encrypted Command
and Control Channels. In: Rieck, K., Stewin, P., Seifert, J.-P. (eds.) DIMVA 2013.
LNCS, vol. 7967, pp. 21–40. Springer, Heidelberg (2013)
34. VirusTotal (2014), http://www.virustotal.com/
35. Rossow, C., Andriesse, D., Werner, T., Stone-Gross, B., Plohmann, D., Dietrich,
C.J., Bos, H.: P2PWNED: Modeling and Evaluating the Resilience of Peer-to-Peer
Botnets. In: Proceedings of the 2013 IEEE Symposium on Security and Privacy,
SP 2013, pp. 97–111. IEEE Computer Society, Washington, DC (2013)
36. Kolbitsch, C., Livshits, B., Zorn, B., Seifert, C.: Rozzle: De-cloaking Internet Mal-
ware. In: Proceedings of the 2012 IEEE Symposium on Security and Privacy, SP
2012, pp. 443–457. IEEE Computer Society, Washington, DC (2012)
37. Rahbarinia, B., Perdisci, R., Antonakakis, M., Dagon, D.: SinkMiner: Mining Bot-
net Sinkholes for Fun and Proﬁt. In: 6th USENIX Workshop on Large-Scale Ex-
ploits and Emergent Threats. USENIX, Berkeley (2013)
38. Thomas, K., Grier, C., Ma, J., Paxson, V., Song, D.: Design and Evaluation of a
Real-Time URL Spam Filtering Service. In: Proceedings of the 2011 IEEE Sym-
posium on Security and Privacy, SP 2011, pp. 447–462. IEEE Computer Society,
Washington, DC (2011)
39. Sinha, S., Bailey, M., Jahanian, F.: Shades of Grey: On the eﬀectiveness of
reputation-based “blacklists”. In: 3rd International Conference on Malicious and
Unwanted Software, MALWARE 2008, pp. 57–64 (2008)
40. Rossow, C., Czerwinski, T., Dietrich, C.J., Pohlmann, N.: Detecting Gray in Black
and White. In: MIT Spam Conference (2010)
41. Dietrich, C.J., Rossow, C.: Empirical Research on IP Blacklisting. In: Proceedings
of the 5th Conference on Email and Anti-Spam, CEAS (2008)
42. Sheng, S., Wardman, B., Warner, G., Cranor, L.F., Hong, J., Zhang, C.: An Em-
pirical Analysis of Phishing Blacklists. In: Proceedings of the Sixth Conference on
Email and Anti-Spam (2009)
43. Neugschwandtner, M., Comparetti, P.M., Platzer, C.: Detecting Malware’s Failover
C&C Strategies with Squeeze. In: Proceedings of the 27th Annual Computer Se-
curity Applications Conference, ACSAC 2011, pp. 21–30. ACM, NY (2011)
44. Stone-Gross, B., Kruegel, C., Almeroth, K., Moser, A., Kirda, E.: FIRE: FInding
Rogue nEtworks. In: Proceedings of the 2009 Annual Computer Security Applica-
tions Conference, ACSAC 2009, pp. 231–240. IEEE Computer Society, Washington,
DC (2009)