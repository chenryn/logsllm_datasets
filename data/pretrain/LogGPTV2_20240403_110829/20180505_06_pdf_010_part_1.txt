Overview
OracletoPostgreSQL
InformixtoPostgreSQL
MySQLtoPostgreSQL
MSSQLtoPostgreSQL
Replicationand/orHighAvailability
Discussion
Migration to PostgreSQL - preparation and
methodology
Joe Conway, Michael Meskes
credativGroup
September 14, 2011
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Joe Conway - Open Source
PostgreSQL (and Linux) user since 1999
Community member since 2000
Contributor since 2001
Commiter since 2003
PostgreSQL Features
PL/R
Set-returning (a.k.a. table) functions feature
Improved bytea and array datatypes, index support
Polymorphic argument types
Multi-row VALUES list capability
Original privilege introspection functions
pg settings VIEW and related functions
dblink, connectby(), crosstab()), generate series()
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Joe Conway - Business
Currently President/CEO of credativ USA
Previously IT Director of large company
Wide variety of experience, closed and open source
Full profile:
http://www.linkedin.com/in/josepheconway
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Michael Meskes - Open Source
Since 1993 Free Software
Since 1994 Linux
Since 1995 Debian GNU/Linux
Since 1998 PostgreSQL, mostly ECPG
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Michael Meskes - Business
1992 - 1996 Ph.D
1996 - 1998 Project Manager
1998 - 2000 Branch Manager
since 2000 President of credativ Group
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Why migrate?
Free and Open Source Software
No licence cost
Open standards
High quality software and support
White box testing
Tailor-made standard software
Independence
Protection of investment
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Intro to Migration
Choose a capable manager
Create a solid planning basis
Design top-down, implement bottom-up
Consider all processes and data traffic
No interim, temporary or isolated solutions
Essential parts have to be redundant
Remember training, maintenance and support
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Intro to Database Migration
Porting projects are hard
SQL Standard and compatibility layers are not a panacea
You might be better off not migrating
Success can pay off big
Disclaimers:
Presentation written from perspective of PostgreSQL expert
Almost anything is possible; we are looking for reasonable
options
3 hours is not nearly enough time to cover this topic in depth
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Best case
Admins know PostgreSQL
Middleware supports PostgeSQL
Standard datatypes
Standard SQL code
⇒ Only one hour of work
⇒ Instant Return of Investment!
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Lots of licenses
600 Installations
$5,000 per database server
$150,000 up-front migration costs
$2,000 additional rollout costs
25 rollouts per month
⇒ Return of Investment: 2 months after begin of rollout!
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Lot of Migration Work
1800 installations with 2 servers each
$2,000 per installation per year
Migration costs $1,000,000
$1,000 additional rollout costs
125 rollouts per month
⇒ Return of Investment: 8 months after begin of rollout!
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Inventory Your Requirements
What features of the incumbent database are in use by your
application?
Which of them are unique and likely need substitution?
What PostgreSQL specific features would bring great benefits?
What are your upcoming requirements?
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Inventory Your Requirements
Requirements to consider
Data Types
Database Object Types
SQL Syntax
Stored Functions and/or Procedures
Client libraries
Encodings
Replication and/or High Availability
Extensions
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Data types
PostgreSQL supported Data Types
INTEGER, NUMERIC, DOUBLE PRECISION
CHARACTER (CHAR), CHARACTER VARYING
(VARCHAR), TEXT
TIMESTAMP WITH[OUT] TIME ZONE, INTERVAL
BYTEA, BOOLEAN, BIT
http://www.postgresql.org/docs/9.0/interactive/datatype.html
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Data types
PostgreSQL supported Data Types
large object
spatial, geometric
full text
XML, UUID, network address
composite, array, enumerated
others ...
http://www.postgresql.org/docs/9.0/interactive/datatype.html
http://www.postgis.org/documentation/manual-1.5/
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Database Object Types
PostgreSQL supported Object Types
DATABASE, SCHEMA
USER, GROUP, ROLE
TABLE, INDEX, SEQUENCE, VIEW, FOREIGN
FUNCTION, AGGREGATE, TRIGGER, RULE, OPERATOR
TYPE, DOMAIN, CAST, COLLATION, CONVERSION
EXTENSION, LANGUAGE, TABLESPACE, TEXT SEARCH
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
SQL Syntax
Identifiers
UPPER
lower
MiXeD cAsE
NULL value handling
Sub-selects
targe list
FROM clause
WHERE clause
correlated
uncorrelated
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
SQL Syntax
Outer joins
WITH clause
WINDOW clause
UPSERT/MERGE
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Stored Functions and/or Procedures
PostgreSQL supports Stored Functions
SELECT a, foo(b) FROM bar;
SELECT a, b FROM foo() AS t(a, b);
PostgreSQL does not support Stored Procedures
EXEC sp_foo(42);
CALL sp_bar(’abc’);
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Stored Functions
PL/pgSQL similar to PL/SQL
Also distributed with PostgreSQL
C, SQL, Perl, Python, Tcl
Other languages available:
Java, PHP, Ruby, R, Shell, others ...
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Client libraries
PostgreSQL supported Client Libraries
Interface available in virtually every programming language
Check syntax and semantics
Use Database agnostic interface, e.g. Perl DBI
ODBC, .Net, JDBC
ECPG
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Encodings
PostgreSQL supported Encodings
Too many to list
Pay attention to:
server vs. client-only encodings
compatible conversions and locale settings
See:
http://www.postgresql.org/docs/9.0/interactive/multibyte.html
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Replication and/or High Availability
PostgreSQL supported HA and Replication Options
Covered separately later in this presentation
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Extensions
Current ”other” database extensions in use
⇒ Check equivalent PostgreSQL extension availability
Existing PostgreSQL extensions
⇒ Leverage where it makes sense
Missing PostgreSQL extensions
⇒ Write your own!
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Database Conversion
General Thoughts
Practice, practice, practice, ...
Plan final conversion well in advance
Convert
Check
Go live!
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Practice
Script your conversion
Figuratively: document the steps to be taken
Literally: automate the data processing and checking as much
as possible
Identify criterion to declare success
No unexpected errors
Time meets available window
One or more methods to check result for correctness
Execute your conversion script, beginning to end
Rinse and repeat until consistently flawless
JoeConway,MichaelMeskes PostgresOpen2011
Overview
OracletoPostgreSQL
Presenters
InformixtoPostgreSQL
Intro
MySQLtoPostgreSQL
Preparation
MSSQLtoPostgreSQL
Conversion
Replicationand/orHighAvailability
Discussion
Convert
Conversion - possible methodologies
Hard cutover
Requires downtime
Provides cleanest result
Continuous cutover
Use external replication or manual sync
Minimal downtime
Tricky to do