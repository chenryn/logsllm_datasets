### Running OPERA-SV Frontends in Enclaves

OPERA may choose to run OPERA-SV frontends within enclaves. This design choice is driven by two primary reasons:

1. **IAS Verification Reports**: The IAS (Intel Attestation Service) verification reports are encrypted using the OPERA-SV’s public key. Consequently, the OPERA-SV frontend must be involved to decrypt these reports. Since periodic validation of IssueEs and AttestEs is required, the OPERA-SV frontend must remain online continuously.

2. **Data Collection and Privacy**: During periodic validation, the OPERA-SV frontends may collect information related to the setup and validation of both IssueEs and AttestEs. Although the privacy of IssueEs and AttestEs is generally less critical (as they are public enclaves), under certain circumstances, such as decentralized attestation schemes, users of OPERA may place less trust in the OPERA-SV than in Intel. To address this, OPERA-SV can deploy the decryption functionality in enclaves, referred to as FrontE, which can run on the same OPERA Server as IssueE. 

FrontE can attest itself to other OPERA enclaves using IAS to derive shared keys for secure communication. The EPID private key can be provisioned into FrontE after attestation, ensuring that the OPERA Servers do not need to handle OPERA-SV’s private keys. Alternatively, FrontE can generate a public/private key pair inside the enclave and expose the certificate externally. This approach ensures that even OPERA-SV cannot participate in the validation process of IssueEs and AttestEs, thereby preserving the privacy of these enclaves.

### OPERA on AMD’s Secure Encrypted Virtualization (SEV)

OPERA is primarily designed for Intel SGX platforms. However, we do not foresee major challenges in adapting OPERA to other trusted execution environments, such as AMD’s SEV. As of now, we have not been able to obtain the source code to perform remote attestation for SEV-enabled virtual machines, and AMD’s attestation service is not available to us. We plan to extend OPERA to other platforms in future work.

### Dependence on Intel

OPERA still relies on Intel (Intel Provisioning Service and Intel Attestation Service) to establish the root of trust on the underlying SGX platforms. As analyzed by Francillon et al. [16], a remote attestation protocol requires exclusive access to a long-term key for generating attestation signatures. For Intel SGX, Intel, as the manufacturer, is the only entity that can embed such long-term secrets into SGX processors and retain exclusive access to these secrets. Therefore, OPERA and any alternative attestation services must rely on Intel to bootstrap trust on the SGX platform.

Intel may decide to ban IssueE and AttestE. However, in its current design, Intel can only ban OPERA-SVs but not individual enclaves. This is because enclave launch control is enforced in the launch enclave using a whitelist of MRSIGNERs (corresponding to ISVs), and using IAS's service requires the ISV’s registered SPID and certificate. Thus, Intel can only ban the OPERA-SVs that run IssueE and AttestE. With the formation of an open attestation framework, OPERA will invite a large number of ISVs to participate in the attestation service, making it difficult for Intel to ban all participating OPERA-SVs. Banning individual enclaves instead of ISVs would require significant changes to the current design of SGX.

Given the benefits of security, privacy, and usability, Intel stands to gain by supporting OPERA rather than suppressing it. OPERA may attract more ISVs with specific security and/or privacy requirements, such as confidential cloud computing and privacy-preserving blockchains, to adopt SGX for development. We are currently in discussions with Intel to gain their support for OPERA.

### Intel’s Third-Party Attestation Scheme

Concurrently with our work, Intel announced Data Center Attestation Primitives (DCAP) to support third-party attestation in on-premise networks, such as data centers [32]. In this scheme, third-party quoting enclaves can be used instead of Intel’s quoting enclave. A pair of attestation keys used by the third-party quoting enclave are generated internally, using algorithms like Elliptic Curve Digital Signature Algorithm (ECDSA). The public key is exported to Intel’s Provisioning Certification Enclave (PCE) and signed using the private Provisioning Certification Key (PCK). PCK is a pair of asymmetric keys derived from the root provisioning secret burned into the SGX platform’s e-fuses.

To establish a chain of trust, Intel needs to publish PCK certificates for users to verify the public key of PCKs, which can be used to verify the ECDSA public key certificate generated by the PCE. Therefore, a user with knowledge of Intel’s public key, PCK certificates, and ECDSA public key certificates can verify the ECDSA attestation result independently (i.e., the quote signed by the ECDSA private key). Similar to OPERA, the revocation list of PCKs still needs to be periodically retrieved from Intel, thus maintaining some reliance on Intel.

However, what is unclear from Intel is where the verification should be performed [32]. Depending on whether the PCK certificates can be made publicly available, two verification models can exist (Fig. 10):

1. **Publicly Available Certificates (Fig. 10a)**: If the certificates can be made publicly available, the attestation results can be verified locally by the users without trusting any third party. However, a PCK certificate can uniquely identify an SGX platform, which can be a privacy concern. This is also the motivation for adopting EPID in the original SGX attestation scheme. In the context of confidential cloud computing, users of public clouds may use such information to perform co-location attacks [30, 45].

2. **Service Provider Access (Fig. 10b)**: If the certificates are only accessible by the service provider, users must fully trust the third-party attestation service. As argued by Swami [39], collusion between the attester and the verifier could completely invalidate the attestation results. Specifically, if the attestation service provider is the same as the operator of the data center—which is typically the case—enclave programs can be launched on non-SGX machines but still pass the remote attestation.

In comparison, OPERA addresses the disadvantages of both designs. It adopts EPID schemes to protect SGX platforms’ privacy and leverages Intel SGX to exclude the third party from the trusted domain. Therefore, OPERA can be used in cases where Internet-based attestation services are required, such as privacy-preserving permissionless blockchains [13, 50] and confidential public clouds [2, 31].

### Integrating OPERA with DCAP

It is also possible to integrate OPERA and DCAP. The idea is to replace the functionality of IAS with DCAP. IAS is used to (1) prove AttestE’s identity to IssueE and (2) prove IssueE’s identity to the ISV. For the first purpose, instead of sending an IAS quote, AttestE sends a DCAP quote and the corresponding PCK certificate and ECDSA public key certificate to IssueE. IssueE can then verify AttestE’s identity and provision the private EPID member key. The PCK certificate and ECDSA public key certificate of the SGX platform will not be recorded by IssueE nor forwarded to IsvE, preserving the SGX platform's privacy. For the second purpose, instead of appending the IAS verification report in the gvCert, IssueE appends the PCK certificate and ECDSA public key certificate of the OPERA Server in gvCert. This way, IssueE’s identity can be verified by the ISV, and only the OPERA Server’s identity is disclosed.

### Conclusion

This paper presents OPERA, an Open Platform for Enclave Remote Attestation for SGX applications, enabling distributed, frequent, and privacy-preserving remote attestation. Compared to Intel’s attestation service, OPERA offers openness, improved privacy, and better performance. We have analyzed and proven the security and privacy guarantees of OPERA, implemented a prototype, and evaluated its performance.

### Acknowledgments

This work was supported in part by NSF grants 1718084 and 1750809, and research gifts from Intel and Dfinity.

### References

[References listed here, formatted as per the original text]

---

This revised version aims to improve clarity, coherence, and professionalism while retaining the technical details and structure of the original text.