Table 6: Top 25 ranked keywords for stalkerware detection
derived using Random Forest (RF).
apps with keystroke logging functions contain the indicative key
words such as “keymonitor” and/or “keystrokes”. These keywords
are exclusively observed in the Keylogging type. It is thus easy to
attribute this surveillance type accurately.
6.4 Importance Ranking of the Keywords
To deepen our understanding of the nuanced classification mech-
anism, we evaluate the informativeness of each textual feature
dimension using a random forest classifier with the criterion of
mean decrease impurity [11]. Each feature adopted in the RF-based
detector is the TF-IDF value of a keyword. We rank the keywords
according to feature informativeness and provide the top-25 ranked
keywords in Table 6. Also, we count the frequency of occurrence
of each keyword in the stalkerware and non-stalkerware apps to
illustrate how the top-ranked keywords trigger detection.
In general, the top-ranked keywords are more indicative of the
text-based descriptions of stalkerware than of non-stalkerware apps.
For example, the following terms only exist in the titles and descrip-
tions of stalkerware apps: keymonitor, whatweb, clone, biometrics,
database restore, whatsmessage, phonefind, spyhuman, espiar, and
stealer. The keyword “keymonitor” is the name of a popular stalk-
erware that appears many times in the app stores under different
app identifiers, including ikeymonitor [4]. It stands out as one of
the most fully-featured stalkerware apps we have observed, cov-
ering messages from Facebook Messenger, Line, Hangouts, Viber,
WeChat, Kik and Skype, if these applications are installed. It also
enables access to call history logs, call recordings, calendar events,
screen captures, audio recordings, contact lists, GPS locations, on-
line browsing history, notes, pasteboard data and keystrokes. An-
other unsurprisingly prominent keyword is spy, which appears
very often in the title and descriptions of stalkerware, and even as a
substring in app titles such as mSpy and spyhuman. These two apps
conduct a broad spectrum of surveillance functions including copy-
ing call logs, tracking the app installation history, and copying text
messages. These stalkerware apps provide good examples showing
the multi-label nature of the nuanced stalkerware classification: a
stalkerware app is usually equipped with multiple surveillance activ-
ities at the same time. In contrast, other prominent keywords that
correspond to app titles are for apps that spy on a single commu-
nication channel, such as WhatsApp: whatsmessage, whatweb, and
whatweb cloner. Each of these apps enable an attacker to spy on an
9
TowardsStalkerwareDetectionwithPreciseWarningsACSAC’21,December6–10,2021,VirtualEvent,USACapabilityACCAUCPositivelabelfractionBrowsing-History0.9050.8820.019Call-Logs0.9670.9370.051Call-Recordings0.8900.8770.027Camera0.9610.9350.022Contacts0.8820.8500.039Email0.9090.8790.009GPS-Tracking0.9710.9370.099Installed-Apps0.8570.8200.016Keylogging0.9680.9400.009Media-Extraction0.9810.9420.024Microphone0.9340.9070.030Screen0.9660.9350.012SMS0.9880.9600.055Social-Media0.9830.9420.124Table5:NuancedstalkerwareclassificationresultsforeachsurveillancecapabilityusingRandomForest(RF).WereporttheresultsofactivelearninginTable4,howeverthistimeweuseMacro-F1andMicro-F1scorestomeasuretheaccuracyofourmulti-labelclassifieronthetestinginstances.Again,wedividethedatasetintotestingandtrainingdatafivetimesatrandomandreporttheaveragedresults.Thetableshowsthatclassificationeffectivenessconsistentlyincreaseswitheachtrainingroundasmoretraininginstancesareadded.Theaccuracystabilizesonce52%ofthetraininginstancesareselectedformodeltraining,regardlessoftheclassifier’sarchitecture.ComparedtotheresultsofbinarystalkerwaredetectioninTa-ble2,surveillance-capabilityclassificationrequiresmorelabelledtraininginstancesattheinitialtrainingstepduetothenatureofmulti-labellearning,inwhichsuccessdependsontheabilitytocap-turethecorrelationbetweendifferentlabels[12,55,61,62].Inourcase,theclassifiermustlearntherelationshipsandco-occurrencesofdifferentsurveillancecapabilitiesinthetrainingset.Therefore,itrequiresmorelabeledtraininginstancessothatitcanidentifythestatisticalcorrelationsbetweensurveillancecapabilitylabels.InTable5,wealsoshowtheACCandAUCscorespersurveil-lancecapabilityachievedafterthesecondroundofactivelearning.Foreachsurveillancecapabilitylabel,wealsogivethefractionofstalkerwareinourdatasetwiththissurveillancecapability,pro-videdunderthePositivelabelfractioncolumn.Alowervaluedenotesthatthecorrespondingsurveillancecapabilityappearsless.AsshowninTable5,thesparsitylevelofthesurveillancelabelisassociatedwiththeclassificationaccuracywithrespecttothecorrespondingsurveillancefunction.Thesurveillancelabelswiththepositivelabelratiohigherthan0.02ingeneralhaveACCandAUCscoreshigherthan0.93.Withmorelabeloccurrences,theclassifiercancapturemorestablecorrelationsbetweentheTF-IDFtextfeaturesandthelabelsitattemptstopredict.ThetwoaccuracymetricvaluesofCall-RecordingsandContactsareexceptionallylow,under0.9.Onelikelyexplanationforthisobservationisthatthekeywordsdescribingthefunctionofrecordingincomingcallsandremoteaccesstothecontacts(like“dialing”,“memo”and“chat-ting”)canbealsofoundinthetextdescriptionsofappsattributedtotheothersurveillancetypes,suchasScreenandSocial-Media.Thesekeywordsdonotprovideenoughconfidencetoenableaccu-ratedetectionofthesesurveillancecapabilities.Inversely,theACCscoreofKeyloggingishigherthan0.96.TextsofthestalkerwareCountsKeywordStalk.Non-stalk.keymonitor120whatweb110biometrics70calendar308clone203databaserestore60whatsmessage60phonefind60spy60espiar50read_phone_state50stealer30monitoreddisplay20CountsKeywordStalk.Non-stalk.intercept51transcript51memos21infrared21keystrokes21hider21dialing125chatting2413gps12870message207157locate3937email64Table6:Top25rankedkeywordsforstalkerwaredetectionderivedusingRandomForest(RF).appswithkeystrokeloggingfunctionscontaintheindicativekeywordssuchas“keymonitor”and/or“keystrokes”.ThesekeywordsareexclusivelyobservedintheKeyloggingtype.Itisthuseasytoattributethissurveillancetypeaccurately.6.4ImportanceRankingoftheKeywordsTodeepenourunderstandingofthenuancedclassificationmech-anism,weevaluatetheinformativenessofeachtextualfeaturedimensionusingarandomforestclassifierwiththecriterionofmeandecreaseimpurity[11].EachfeatureadoptedintheRF-baseddetectoristheTF-IDFvalueofakeyword.Werankthekeywordsaccordingtofeatureinformativenessandprovidethetop-25rankedkeywordsinTable6.Also,wecountthefrequencyofoccurrenceofeachkeywordinthestalkerwareandnon-stalkerwareappstoillustratehowthetop-rankedkeywordstriggerdetection.Ingeneral,thetop-rankedkeywordsaremoreindicativeofthetext-baseddescriptionsofstalkerwarethanofnon-stalkerwareapps.Forexample,thefollowingtermsonlyexistinthetitlesanddescrip-tionsofstalkerwareapps:keymonitor,whatweb,clone,biometrics,databaserestore,whatsmessage,phonefind,spyhuman,espiar,andstealer.Thekeyword“keymonitor”isthenameofapopularstalk-erwarethatappearsmanytimesintheappstoresunderdifferentappidentifiers,includingikeymonitor[4].Itstandsoutasoneofthemostfully-featuredstalkerwareappswehaveobserved,cov-eringmessagesfromFacebookMessenger,Line,Hangouts,Viber,WeChat,KikandSkype,iftheseapplicationsareinstalled.Italsoenablesaccesstocallhistorylogs,callrecordings,calendarevents,screencaptures,audiorecordings,contactlists,GPSlocations,on-linebrowsinghistory,notes,pasteboarddataandkeystrokes.An-otherunsurprisinglyprominentkeywordisspy,whichappearsveryofteninthetitleanddescriptionsofstalkerware,andevenasasubstringinapptitlessuchasmSpyandspyhuman.Thesetwoappsconductabroadspectrumofsurveillancefunctionsincludingcopy-ingcalllogs,trackingtheappinstallationhistory,andcopyingtextmessages.Thesestalkerwareappsprovidegoodexamplesshowingthemulti-labelnatureofthenuancedstalkerwareclassification:astalkerwareappisusuallyequippedwithmultiplesurveillanceactiv-itiesatthesametime.Incontrast,otherprominentkeywordsthatcorrespondtoapptitlesareforappsthatspyonasinglecommu-nicationchannel,suchasWhatsApp:whatsmessage,whatweb,andwhatwebcloner.Eachoftheseappsenableanattackertospyonan9965ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Han, Roundy, Tamersoy
individual’s WhatsApp account on another device. A few other note-
worthy examples are the keywords clone, biometrics, phonefind,
and stealer, each of which indicate a surveillance modality or style
of privacy theft. It is interesting that some foreign language key-
words did appear in the list, including the keyword espiar, which
is the Spanish translation of “spy.”
It is important to note that Dosmelt also detects apps that do
not openly reference stalking functionality through words like
“spying”, on the basis of keywords that skew towards stalkerware
but appear both in stalkerware and non-stalkerware apps, such
as dialing, chatting, gps, and message. Consider for example, the
dual-use app com.maha.orд.f indmylostphone, that was detected
as having a stalkerware use case with .946 probability, largely on
the basis of such keywords as “automatically”, “quick”, and “stolen.”
Such words could appear in the description of a benign or malicious
app, but taken together were correctly adjudged to be indicative of
location-tracking functionality. In the appendix, we provide 19 con-
crete examples of detected stalkerware apps by Dosmelt. We also
show the identified surveillance capabilities of these stalkerware
apps, which were verified manually by human experts.
7 DISCUSSION
We provide a brief discussion around the deployment plans of
Dosmelt, its limitations and a few pointers for future work.
Impact. Our experimental evaluation suggest that Dosmelt’s min-
ing of app titles and descriptions is a useful means of detecting
stalkerware apps and identifying their surveillance capabilities.
Though this method would be insufficient as a standalone method,
its ability to quickly detect new apps based on their advertised
functionality seems a good complement to existing static and dy-
namic analysis techniques [23, 33], and to reputation systems [42]
for detecting stalkerware, with the crucial benefit of being the first
system to detect individual stalkerware surveillance capabilities.
To help the survivors of intimate partner violence (IPV), we sub-
mitted the manually labeled dataset we constructed, which consists
of several hundred stalkerware apps that did not previously exist
in the the Coalition Against Stalkerware’s [18] Stalkerware Threat
List, which includes 246 apps directly detected by Dosmelt. The
coalition’s threat list is used as a source of detections by several
security vendors to protect their customers from stalkerware.
Dosmelt is notable because it enables the creation of precise
stalkerware warnings based on app capabilities, as shown in Fig-
ure 1. While we believe that this represents a substantial leap for-
ward, it only solves one of several challenges in providing well-
considered, usable stalkerware warnings. Consider, for instance,
that for a warning to be useful in intimate partner violence settings,
we must consider that it is the abuser who will be installing the
stalkerware app on the targeted individual’s device [26]. Thus, an
immediate warning by an installed security app could be counter-
productive. The goal should be to warn the all other users of the
device other than the person who installed the app, as this indi-
vidual is already aware of the app’s functionality and is likely to
uninstall the security application once aware of its detection capa-
bilities. Furthermore, the language used in the app itself should be
carefully considered, as it is designed to be seen by IPV survivors,
who may be suffering from post-traumatic stress [37] and other
mental health complications as a result of ongoing abuse [29]. As
important as these notification-related challenges are, we leave
them out of scope, and plan to address them in our future work.
Limitations. We designed Dosmelt to test the limits of an app’s
self-description as a way to detect new stalkerware apps. While this
method has clear advantages, it also comes with obvious limitations.
First, this method works best for apps that have at least at one point
been hosted on the Google Play app store. While we are able to
extract descriptions from stalkerware that hosts its self-descriptions
on its own website, the extraction of these descriptions for newly
detected stalkerware would be very difficult to automate. Additional,
complementary methods of stalkerware detection such as dynamic
analysis [23] and reputation-based systems [42] are needed to assist
in this case. Dynamic analysis methods could be used to identify
some of an app’s stalkerware capabilities, but these methods do not
distinguish between stalkerware and non-stalking spyware.
A second limitation of our approach is the possibility of adver-
sarial attacks. The most obvious attack to conduct against Dosmelt
or a similar approach based on an app’s self-description, would
be to avoid stalkerware-related keywords, though this approach is
disadvantageous to the developer because those same keywords
enable abusers to discover the app through internet and app store
searches. Alternatively, a stalkerware developer might gain access
to a list of keywords that Dosmelt associates with benign apps,
and inject benign keywords into the title or description of the app
to weaken the classifier’s confidence in its prediction. While this is
certainly a feasible attack, a more adversarially-resistant version
of Dosmelt could perhaps be based on recent work in adversari-
ally robust decision trees [13, 16] to form a resilient random forest
model. We intend to explore these directions in future work, though
ultimately, we recommend Dosmelt as a complement to existing
techniques like dynamic tracking of sensitive information flow
within the app [20, 24, 59] and not as a standalone solution.
Finally, we evaluated Dosmelt only on apps with titles and de-
scription in English (because the training data that we had access to
was English-centric). There is a clear need for extending the stalk-
erware detection methods like ours to be applied to non-English
apps. We will address this gap in our future work.
8 CONCLUSION
Stalkerware is a global phenomenon, having both security and pri-
vacy implications for an increasing number of individuals. Existing
work has not attempted to automatically identify the varied surveil-
lance capabilities of stalkerware apps, which results in confusing
stalkerware notifications, particularly for apps that can be used
as stalkerware but have legitimate benign uses. It was challeng-
ing to perform this task at scale however, as there were no large
datasets of stalkerware for which individual surveillance features
had been labeled. To this end, we developed Dosmelt, a multi-label
stalkerware detection system that identifies the various types of
surveillance that each app conducts. Our method leverages an ac-
tive learning methodology to promote effective learning with a
modest set of hand-annotated apps. We conducted an extensive
evaluation of Dosmelt to show its effectiveness, and we submitted
our manually labeled dataset of stalkerware apps and those detected
by Dosmelt to the Coalition Against Stalkerware’s Stalkerware
Threat List, to which interested researchers can apply for access.
10
966Towards Stalkerware Detection with Precise Warnings
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
REFERENCES
[1] Saeed Alahmari, Dmitry Goldgof, Lawrence Hall, Palak Dave, Hady Ah-
mady Phoulady, and Peter Mouton. 2018. Iterative Deep Learning Based Un-
biased Stereology with Human-in-the-Loop. In 2018 17th IEEE International
Conference on Machine Learning and Applications (ICMLA). 665–670. https:
//doi.org/10.1109/ICMLA.2018.00106
[2] Deborah K Anderson, Daniel G Saunders, Mieko Yoshihama, Deborah I Bybee, and
Cris M Sullivan. 2003. Long-term trends in depression among women separated
from abusive partners. Violence against women 9, 7 (2003), 807–838.
[3] AV Comparatives. 2020. Stalkerware Test 2020. https://www.av-comparatives.
org/reports/android-stalkerware-report-2021/.
[4] Avira. 2020. Avira is on the hunt for Stalkerware. https://www.avira.com/en/
blog/on-the-hunt-for-stalkerware.
[5] Jason Bays and Umit Karabiyik. 2019. Forensic analysis of third party location
applications in android and ios. In IEEE INFOCOM 2019-IEEE Conference on
Computer Communications Workshops (INFOCOM WKSHPS). IEEE, 1–6.
[6] Steven Bird, Ewan Klein, and Edward Loper. 2009. Natural language processing
with Python: analyzing text with the natural language toolkit. " O’Reilly Media,
Inc.".
[7] Lindsay Blackwell, Jill Dimond, Sarita Schoenebeck, and Cliff Lampe. 2017. Clas-
sification and Its Consequences for Online Harassment: Design Insights from
Heartmob. Proceedings of the ACM on Human-Computer Interaction, Article 24
(2017). https://doi.org/10.1145/3134659
[8] Matthew R. Boutell, Jiebo Luo, Xipeng Shen, and Christopher M. Brown. 2004.
Learning multi-label scene classification. Pattern Recognition 37, 9 (2004), 1757–
1771. https://doi.org/10.1016/j.patcog.2004.03.009
[9] Matthew J. Breiding, J. Chen, and M. C. Black. 2014. Intimate Partner Violence
in the United States — 2010. Technical Report. Atlanta, GA: National Center for
Injury Prevention and Control, Centers for Disease Control and Prevention.
[10] Leo Breiman. 2001. Random forests. Machine learning 45, 1 (2001), 5–32.
[11] Leo Breiman. 2002. Manual on setting up, using, and understanding random
forests v3. 1. Statistics Department University of California Berkeley, CA, USA 1,
58 (2002).
[12] Serhat Selcuk Bucak, Rong Jin, and Anil K Jain. 2011. Multi-label learning with
incomplete class assignments. In CVPR. 2801–2808. https://doi.org/10.1109/
CVPR.2011.5995734
[13] Stefano Calzavara, Claudio Lucchese, and Gabriele Tolomei. 2019. Adversar-
ial training of gradient-boosted decision trees. In Proceedings of the 28th ACM
International Conference on Information and Knowledge Management. 2429–2432.
[14] Rahul Chatterjee, Periwinkle Doerfler, Hadas Orgad, Sam Havron, Jackeline
Palmer, Diana Freed, Karen Levy, Nicola Dell, Damon McCoy, and Thomas Ris-
tenpart. 2018. The Spyware Used in Intimate Partner Violence. In IEEE Symposium
on Security and Privacy. IEEE, 441–458. https://doi.org/10.1109/SP.2018.00061
[15] Gang Chen, Yangqiu Song, Fei Wang, and Changshui Zhang. 2008. Semi-
supervised multi-label learning by solving a sylvester equation. In Proceedings of
the 2008 SIAM International Conference on Data Mining. SIAM, 410–419.
[16] Hongge Chen, Huan Zhang, Duane Boning, and Cho-Jui Hsieh. 2019. Robust de-
cision trees against adversarial examples. In International Conference on Machine
Learning. PMLR, 1122–1131.
[17] Danielle Keats Citron. 2015. Spying Inc. Washington and Lee Law Review 72, 3
[18] Coalition Against Stalkerware. 2020. What is Stalkerware.
https://
(2015), 1242–1282.
stopstalkerware.org/#whatis.
[19] Shubhomoy Das, Weng-Keen Wong, Thomas Dietterich, Alan Fern, and Andrew
Emmott. 2016. Incorporating Expert Feedback into Active Anomaly Discovery.
In 2016 IEEE 16th International Conference on Data Mining (ICDM). 853–858.
https://doi.org/10.1109/ICDM.2016.0102
[20] Anthony Desnos and Patrik Lantz. 2011. Droidbox: An android application
sandbox for dynamic analysis. Lund Univ., Lund, Sweden, Tech. Rep (2011).
[21] Karen M Devries, Joelle Y Mak, Loraine J Bacchus, Jennifer C Child, Gail Falder,
Max Petzold, Jill Astbury, and Charlotte H Watts. 2013. Intimate partner violence
and incident depressive symptoms and suicide attempts: a systematic review of
longitudinal studies. PLoS Med 10, 5 (2013), e1001439.
[22] Jill P. Dimond, Casey Fiesler, and Amy S. Bruckman. 2011. Domestic violence
and information communication technologies. Interacting with Computers 23, 5
(2011), 413–421.
[23] Manuel Egele, Chris Krügel, Engin Kirda, Heng Yin, and Dawn Song. 2007. Dy-
namic Spyware Analysis. In USENIX Annual Technical Conference.
[24] William Enck, Peter Gilbert, Seungyeop Han, Vasant Tendulkar, Byung-Gon
Chun, Landon P Cox, Jaeyeon Jung, Patrick McDaniel, and Anmol N Sheth. 2014.
Taintdroid: an information-flow tracking system for realtime privacy monitoring
on smartphones. ACM Transactions on Computer Systems (TOCS) 32, 2 (2014),
1–29.
[25] Jerry Finn. 2004. A survey of online harassment at a university campus. Journal
of Interpersonal violence 19, 4 (2004), 468–483.
[26] Diana Freed, Sam Havron, Emily Tseng, Andrea Gallardo, Rahul Chatterjee,
Thomas Ristenpart, and Nicola Dell. 2019. "Is My Phone Hacked?" Analyzing
Clinical Computer Security Interventions with Survivors of Intimate Partner
Violence. Proc. ACM Hum.-Comput. Interact. 3, CSCW, Article 202 (Nov. 2019),
24 pages. https://doi.org/10.1145/3359304
[27] D. Freed, Jackeline Palmer, Diana Elizabeth Minchala, K. Levy, T. Ristenpart,
and Nicola Dell. 2018. “A Stalker’s Paradise”: How Intimate Partner Abusers
Exploit Technology. Proceedings of the 2018 CHI Conference on Human Factors in
Computing Systems (2018).
[28] Pierre Geurts, Damien Ernst, and Louis Wehenkel. 2006. Extremely Randomized
Trees. Mach. Learn. 63, 1 (April 2006), 3–42. https://doi.org/10.1007/s10994-006-
6226-1
[29] Jacqueline M. Golding. 1999.
Intimate Partner Violence as a Risk Factor for
Mental Disorders: A Meta-Analysis. Journal of Family Violence 14 (1999), 99–132.
[30] Google. 2020. Developer Program Policy: September 16, 2020 announce-
https://support.google.com/googleplay/android-developer/answer/
ment.
10065487#stalkerware.
[31] D. Harkin and Adám Molnár. 2021. Operating-System Design and Its Implications
for Victims of Family Violence: The Comparative Threat of Smart Phone Spyware
for Android Versus iPhone Users. Violence Against Women 27 (2021), 851 – 875.
[32] Laura Hautala. 2020. Stalkerware sees all, and US laws haven’t stopped its spread.
Installing hidden spy software is illegal, so why is it so easy? https://www.cnet.
com/news/stalkerware-sees-all-and-us-laws-havent-stopped-its-spread/.