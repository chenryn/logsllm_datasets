:   ::: para
    指​​​​​​​定​​​​​​​文​​​​​​​件​​​​​​​系​​​​​​​统​​​​​​​的​​​​​​​设​​​​​​​备​​​​​​​节​​​​​​​点​​​​​​​。​​​​​​​
    :::
:::
::: para
[表 3.4 "添​​​​​​​加​​​​​​​日​​​​​​​志​​​​​​​时​​​​​​​可​​​​​​​用​​​​​​​的​​​​​​​ GFS2
特​​​​​​​定​​​​​​​选​​​​​​​项​​​​​​​"](#ch-manage.html#tb-table-gfs2-addjournal){.xref} describes
the GFS2-specific options that can be used when adding journals to a
GFS2 file system.
:::
[]{#ch-manage.html#idm140321023380736
.indexterm}[]{#ch-manage.html#idm140321023379328 .indexterm}
::: table
[⁠]{#ch-manage.html#tb-table-gfs2-addjournal}
**表 3.4. 添​​​​​​​加​​​​​​​日​​​​​​​志​​​​​​​时​​​​​​​可​​​​​​​用​​​​​​​的​​​​​​​ GFS2 特​​​​​​​定​​​​​​​选​​​​​​​项​​​​​​​**
::: table-contents
  -----------------------------------------------------------------------------------------------------------
  标​​​​​​​签​​​​​​​            参​​​​​​​数​​​​​​​                 描​​​​​​​述​​​​​​​
  --------------- -------------------- ----------------------------------------------------------------------
  `-h`{.option}                        帮​​​​​​​助​​​​​​​，显​​​​​​​示​​​​​​​简​​​​​​​短​​​​​​​用​​​​​​​法​​​​​​​信​​​​​​​息​​​​​​​。​​​​​​​
  `-J`{.option}   *`MegaBytes`*        以​​​​​​​ MB 为​​​​​​​单​​​​​​​位​​​​​​​指​​​​​​​定​​​​​​​新​​​​​​​日​​​​​​​志​​​​​​​的​​​​​​​大​​​​​​​小​​​​​​​。​​​​​​​默​​​​​​​认​​​​​​​日​​​​​​​志​​​​​​​大​​​​​​​小​​​​​​​为​​​​​​​ 128MB，最​​​​​​​小​​​​​​​值​​​​​​​为​​​​​​​
                                       32MB。​​​​​​​要​​​​​​​在​​​​​​​文​​​​​​​件​​​​​​​系​​​​​​​统​​​​​​​添​​​​​​​加​​​​​​​不​​​​​​​同​​​​​​​大​​​​​​​小​​​​​​​的​​​​​​​日​​​​​​​志​​​​​​​，必​​​​​​​须​​​​​​​为​​​​​​​每​​​​​​​个​​​​​​​不​​​​​​​同​​​​​​​大​​​​​​​小​​​​​​​的​​​​​​​日​​​​​​​志​​​​​​​运​​​​​​​行​​​​​​​
                                       `gfs2_jadd`{.command}
                                       命​​​​​​​令​​​​​​​。​​​​​​​指​​​​​​​定​​​​​​​的​​​​​​​大​​​​​​​小​​​​​​​会​​​​​​​不​​​​​​​断​​​​​​​下​​​​​​​降​​​​​​​，因​​​​​​​此​​​​​​​在​​​​​​​生​​​​​​​成​​​​​​​文​​​​​​​件​​​​​​​系​​​​​​​统​​​​​​​时​​​​​​​会​​​​​​​指​​​​​​​定​​​​​​​多​​​​​​​个​​​​​​​日​​​​​​​志​​​​​​​区​​​​​​​段​​​​​​​。​​​​​​​
  `-j`{.option}   *`Number`*           用​​​​​​​ `gfs2_jadd`{.command} 命​​​​​​​令​​​​​​​指​​​​​​​定​​​​​​​要​​​​​​​添​​​​​​​加​​​​​​​的​​​​​​​新​​​​​​​日​​​​​​​志​​​​​​​数​​​​​​​目​​​​​​​，默​​​​​​​认​​​​​​​值​​​​​​​为​​​​​​​ 1。​​​​​​​
  `-q`{.option}                        静​​​​​​​默​​​​​​​，降​​​​​​​低​​​​​​​详​​​​​​​细​​​​​​​等​​​​​​​级​​​​​​​。​​​​​​​
  `-V`{.option}                        显​​​​​​​示​​​​​​​命​​​​​​​令​​​​​​​版​​​​​​​本​​​​​​​信​​​​​​​息​​​​​​​。​​​​​​​
  -----------------------------------------------------------------------------------------------------------
:::
:::
:::
:::
::: section
::: titlepage
# [⁠]{#ch-manage.html#s1-manage-data-journal}3.7. 数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​ {.title}
:::
[]{#ch-manage.html#idm140321037082128
.indexterm}[]{#ch-manage.html#idm140321037080688 .indexterm}
::: para
Ordinarily, GFS2 writes only metadata to its journal. File contents are
subsequently written to disk by the kernel\'s periodic sync that flushes
file system buffers. An `fsync()`{.command} call on a file causes the
file\'s data to be written to disk immediately. The call returns when
the disk reports that all data is safely written.
:::
::: para
数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​可​​​​​​​减​​​​​​​小​​​​​​​ `fsync()`{.command}
时​​​​​​​间​​​​​​​，特​​​​​​​别​​​​​​​是​​​​​​​对​​​​​​​于​​​​​​​小​​​​​​​文​​​​​​​件​​​​​​​，因​​​​​​​为​​​​​​​文​​​​​​​件​​​​​​​数​​​​​​​据​​​​​​​在​​​​​​​写​​​​​​​入​​​​​​​元​​​​​​​数​​​​​​​据​​​​​​​外​​​​​​​还​​​​​​​要​​​​​​​写​​​​​​​入​​​​​​​日​​​​​​​志​​​​​​​。​​​​​​​数​​​​​​​据​​​​​​​写​​​​​​​入​​​​​​​日​​​​​​​志​​​​​​​后​​​​​​​
`fsync()`{.command} 就​​​​​​​会​​​​​​​返​​​​​​​回​​​​​​​，这​​​​​​​样​​​​​​​就​​​​​​​比​​​​​​​将​​​​​​​文​​​​​​​件​​​​​​​数​​​​​​​据​​​​​​​写​​​​​​​入​​​​​​​主​​​​​​​文​​​​​​​件​​​​​​​系​​​​​​​统​​​​​​​要​​​​​​​迅​​​​​​​速​​​​​​​。​​​​​​​
:::
::: para
依​​​​​​​赖​​​​​​​ `fsync()`{.command}
同​​​​​​​步​​​​​​​文​​​​​​​件​​​​​​​数​​​​​​​据​​​​​​​的​​​​​​​应​​​​​​​用​​​​​​​程​​​​​​​序​​​​​​​可​​​​​​​能​​​​​​​因​​​​​​​使​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​而​​​​​​​使​​​​​​​性​​​​​​​能​​​​​​​有​​​​​​​所​​​​​​​提​​​​​​​高​​​​​​​。​​​​​​​在​​​​​​​被​​​​​​​标​​​​​​​记​​​​​​​的​​​​​​​目​​​​​​​录​​​​​​​及​​​​​​​其​​​​​​​所​​​​​​​有​​​​​​​子​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​生​​​​​​​成​​​​​​​的​​​​​​​
GFS2 文​​​​​​​件​​​​​​​可​​​​​​​自​​​​​​​动​​​​​​​启​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​。​​​​​​​现​​​​​​​有​​​​​​​长​​​​​​​度​​​​​​​为​​​​​​​ 0
的​​​​​​​文​​​​​​​件​​​​​​​也​​​​​​​可​​​​​​​以​​​​​​​打​​​​​​​开​​​​​​​或​​​​​​​者​​​​​​​关​​​​​​​闭​​​​​​​其​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​功​​​​​​​能​​​​​​​。​​​​​​​
:::
::: para
Enabling data journaling on a directory sets the directory to \"inherit
jdata\", which indicates that all files and directories subsequently
created in that directory are journaled. You can enable and disable data
journaling on a file or a directory with either of the following
methods:
:::
::: {.itemizedlist xmlns:d="http://docbook.org/ns/docbook"}
-   ::: para
    在​​​​​​​文​​​​​​​件​​​​​​​或​​​​​​​者​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​执​​​​​​​行​​​​​​​ `chattr +j`{.command} 或​​​​​​​者​​​​​​​
    `chattr -j`{.command}
    :::
-   ::: para
    使​​​​​​​用​​​​​​​ `gfs2_tool setflag`{.command} 或​​​​​​​者​​​​​​​
    `gfs2_tool clearflag`{.command} 命​​​​​​​令​​​​​​​为​​​​​​​文​​​​​​​件​​​​​​​或​​​​​​​者​​​​​​​目​​​​​​​录​​​​​​​设​​​​​​​定​​​​​​​或​​​​​​​者​​​​​​​清​​​​​​​除​​​​​​​
    `jdata`{.option} 标​​​​​​​签​​​​​​​
    :::
:::
::: para
使​​​​​​​用​​​​​​​ `chattr`{.command}
命​​​​​​​令​​​​​​​是​​​​​​​在​​​​​​​某​​​​​​​个​​​​​​​文​​​​​​​件​​​​​​​或​​​​​​​者​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​启​​​​​​​用​​​​​​​和​​​​​​​禁​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​的​​​​​​​首​​​​​​​选​​​​​​​方​​​​​​​法​​​​​​​。​​​​​​​
:::
::: section
::: titlepage
## [⁠]{#ch-manage.html#s1-chattr-j}3.7.1. 使​​​​​​​用​​​​​​​ `chattr`{.command} 命​​​​​​​令​​​​​​​启​​​​​​​用​​​​​​​和​​​​​​​禁​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​ {.title}
:::
::: para
您​​​​​​​可​​​​​​​以​​​​​​​使​​​​​​​用​​​​​​​ `chattr`{.command}
命​​​​​​​令​​​​​​​为​​​​​​​某​​​​​​​个​​​​​​​文​​​​​​​件​​​​​​​启​​​​​​​用​​​​​​​或​​​​​​​者​​​​​​​禁​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​。​​​​​​​以​​​​​​​下​​​​​​​命​​​​​​​令​​​​​​​为​​​​​​​
`/mnt/gfs2/gfs2_dir/newfile`{.filename}
文​​​​​​​件​​​​​​​启​​​​​​​用​​​​​​​了​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​功​​​​​​​能​​​​​​​，并​​​​​​​检​​​​​​​查​​​​​​​是​​​​​​​否​​​​​​​正​​​​​​​确​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​标​​​​​​​签​​​​​​​。​​​​​​​
:::
``` screen
[root@roth-01 ~]# chattr +j /mnt/gfs2/gfs2_dir/newfile
[root@roth-01 ~]# lsattr /mnt/gfs2/gfs2_dir
---------j--- /mnt/gfs2/gfs2_dir/newfile
```
::: para
以​​​​​​​下​​​​​​​命​​​​​​​令​​​​​​​禁​​​​​​​用​​​​​​​了​​​​​​​ `/mnt/gfs2/gfs2_dir/newfile`{.filename}
文​​​​​​​件​​​​​​​中​​​​​​​的​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​，并​​​​​​​查​​​​​​​看​​​​​​​是​​​​​​​否​​​​​​​正​​​​​​​确​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​标​​​​​​​签​​​​​​​。​​​​​​​
:::
``` screen
[root@roth-01 ~]# chattr -j /mnt/gfs2/gfs2_dir/newfile
[root@roth-01 ~]# lsattr /mnt/gfs2/gfs2_dir
------------- /mnt/gfs2/gfs2_dir/newfile
```
::: para
您​​​​​​​还​​​​​​​可​​​​​​​以​​​​​​​使​​​​​​​用​​​​​​​ `chattr`{.command} 在​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​设​​​​​​​定​​​​​​​ `jdata`{.literal}
标​​​​​​​签​​​​​​​。​​​​​​​当​​​​​​​您​​​​​​​为​​​​​​​某​​​​​​​个​​​​​​​目​​​​​​​录​​​​​​​设​​​​​​​定​​​​​​​此​​​​​​​标​​​​​​​签​​​​​​​时​​​​​​​，之​​​​​​​后​​​​​​​在​​​​​​​那​​​​​​​个​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​创​​​​​​​建​​​​​​​的​​​​​​​所​​​​​​​有​​​​​​​文​​​​​​​件​​​​​​​和​​​​​​​目​​​​​​​录​​​​​​​也​​​​​​​都​​​​​​​会​​​​​​​进​​​​​​​行​​​​​​​日​​​​​​​志​​​​​​​操​​​​​​​作​​​​​​​。​​​​​​​以​​​​​​​下​​​​​​​一​​​​​​​组​​​​​​​命​​​​​​​令​​​​​​​可​​​​​​​在​​​​​​​
`gfs2_dir`{.literal} 目​​​​​​​录​​​​​​​中​​​​​​​设​​​​​​​定​​​​​​​ `j`{.literal}
标​​​​​​​签​​​​​​​，然​​​​​​​后​​​​​​​查​​​​​​​看​​​​​​​是​​​​​​​否​​​​​​​正​​​​​​​确​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​该​​​​​​​标​​​​​​​签​​​​​​​。​​​​​​​此​​​​​​​后​​​​​​​，该​​​​​​​命​​​​​​​令​​​​​​​会​​​​​​​在​​​​​​​
`/mnt/gfs2/gfs2_dir`{.filename} 目​​​​​​​录​​​​​​​中​​​​​​​创​​​​​​​建​​​​​​​一​​​​​​​个​​​​​​​名​​​​​​​为​​​​​​​ `newfile`{.filename}
新​​​​​​​文​​​​​​​件​​​​​​​，然​​​​​​​后​​​​​​​查​​​​​​​看​​​​​​​是​​​​​​​否​​​​​​​将​​​​​​​为​​​​​​​该​​​​​​​文​​​​​​​件​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​ `j`{.literal}
标​​​​​​​签​​​​​​​。​​​​​​​因​​​​​​​为​​​​​​​是​​​​​​​为​​​​​​​该​​​​​​​目​​​​​​​录​​​​​​​设​​​​​​​定​​​​​​​的​​​​​​​ `j`{.literal} 标​​​​​​​签​​​​​​​，然​​​​​​​后​​​​​​​应​​​​​​​该​​​​​​​也​​​​​​​为​​​​​​​
`newfile`{.literal} 启​​​​​​​用​​​​​​​日​​​​​​​志​​​​​​​操​​​​​​​作​​​​​​​。​​​​​​​
:::
``` screen
[root@roth-01 ~]# chattr -j /mnt/gfs2/gfs2_dir
[root@roth-01 ~]# lsattr /mnt/gfs2
---------j--- /mnt/gfs2/gfs2_dir
[root@roth-01 ~]# touch /mnt/gfs2/gfs2_dir/newfile
[root@roth-01 ~]# lsattr /mnt/gfs2/gfs2_dir
---------j--- /mnt/gfs2/gfs2_dir/newfile
```
:::
::: section
::: titlepage
## [⁠]{#ch-manage.html#s1-jdataflag}3.7.2. 使​​​​​​​用​​​​​​​ `gfs2_tool`{.command} 启​​​​​​​用​​​​​​​或​​​​​​​者​​​​​​​禁​​​​​​​用​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​ {.title}
:::
::: para
以​​​​​​​下​​​​​​​命​​​​​​​令​​​​​​​在​​​​​​​ GFS2 文​​​​​​​件​​​​​​​ `/mnt/gfs2/gfs2file`{.filename} 中​​​​​​​启​​​​​​​用​​​​​​​了​​​​​​​数​​​​​​​据​​​​​​​日​​​​​​​志​​​​​​​
:::
``` screen
[root@roth-01 ~]# gfs2_tool setflag jdata /mnt/gfs2/gfs2file 
```
::: para
您​​​​​​​可​​​​​​​以​​​​​​​使​​​​​​​用​​​​​​​ `lsattr`{.command} 命​​​​​​​令​​​​​​​确​​​​​​​认​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​ `jdata`{.literal} 标​​​​​​​签​​​​​​​。​​​​​​​
:::
``` screen
[root@roth-01 ~]# lsattr /mnt/gfs2
---------j--- /mnt/gfs2/gfs2file
```
::: para
当​​​​​​​为​​​​​​​该​​​​​​​目​​​​​​​录​​​​​​​设​​​​​​​定​​​​​​​ `jdata`{.literal}
标​​​​​​​签​​​​​​​时​​​​​​​，之​​​​​​​后​​​​​​​在​​​​​​​那​​​​​​​个​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​创​​​​​​​建​​​​​​​的​​​​​​​所​​​​​​​有​​​​​​​文​​​​​​​件​​​​​​​和​​​​​​​目​​​​​​​录​​​​​​​都​​​​​​​进​​​​​​​行​​​​​​​日​​​​​​​志​​​​​​​操​​​​​​​作​​​​​​​。​​​​​​​
:::
::: para
以​​​​​​​下​​​​​​​命​​​​​​​令​​​​​​​会​​​​​​​在​​​​​​​ `/mnt/gfs2`{.filename} 目​​​​​​​录​​​​​​​中​​​​​​​生​​​​​​​成​​​​​​​名​​​​​​​为​​​​​​​ `gfs2_dir`{.filename}
的​​​​​​​新​​​​​​​子​​​​​​​目​​​​​​​录​​​​​​​，并​​​​​​​为​​​​​​​该​​​​​​​目​​​​​​​录​​​​​​​设​​​​​​​定​​​​​​​ `jdata`{.literal}
标​​​​​​​签​​​​​​​，然​​​​​​​后​​​​​​​确​​​​​​​认​​​​​​​标​​​​​​​签​​​​​​​设​​​​​​​置​​​​​​​是​​​​​​​正​​​​​​​确​​​​​​​的​​​​​​​。​​​​​​​此​​​​​​​后​​​​​​​，这​​​​​​​些​​​​​​​命​​​​​​​令​​​​​​​在​​​​​​​该​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​生​​​​​​​成​​​​​​​文​​​​​​​件​​​​​​​
`gfs2file`{.filename}，然​​​​​​​后​​​​​​​确​​​​​​​认​​​​​​​为​​​​​​​那​​​​​​​个​​​​​​​文​​​​​​​件​​​​​​​正​​​​​​​确​​​​​​​设​​​​​​​定​​​​​​​了​​​​​​​标​​​​​​​签​​​​​​​。​​​​​​​
:::
``` screen
[root@roth-01 ~]# mkdir /mnt/gfs2/gfs2_dir
[root@roth-01 ~]# gfs2_tool setflag jdata /mnt/gfs2/gfs2_dir
[root@roth-01 ~]# lsattr /mnt/gfs2
---------j--- /mnt/gfs2/gfs2_dir
[root@roth-01 ~]# touch /mnt/gfs2/gfs2_dir/newfile
[root@roth-01 ~]# lsattr /mnt/gfs2/gfs2_dir
---------j--- /mnt/gfs2/gfs2_dir/newfile
```
::: para
要​​​​​​​从​​​​​​​某​​​​​​​个​​​​​​​文​​​​​​​件​​​​​​​或​​​​​​​者​​​​​​​目​​​​​​​录​​​​​​​中​​​​​​​清​​​​​​​除​​​​​​​ `jdata`{.literal} 标​​​​​​​签​​​​​​​，您​​​​​​​可​​​​​​​以​​​​​​​使​​​​​​​用​​​​​​​
`gfs2_tool clearflag jdata`{.command} 命​​​​​​​令​​​​​​​，如​​​​​​​下​​​​​​​示​​​​​​​例​​​​​​​中​​​​​​​所​​​​​​​示​​​​​​​：
:::
``` screen
[root@roth-01 ~]# gfs2_tool clearflag jdata /mnt/gfs2/gfs2file 
[root@roth-01 ~]# lsattr /mnt/gfs2
------------- /mnt/gfs2/gfs2file
```
:::
:::
::: section
::: titlepage
# [⁠]{#ch-manage.html#s1-manage-atimeconf}3.8. 配​​​​​​​置​​​​​​​ `atime`{.command} 更​​​​​​​新​​​​​​​ {.title}