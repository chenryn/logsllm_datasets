R I C K Y  H I L L  
D E F C O N  2 1  
8 / 3 / 2 0 1 3  
Phantom Network Surveillance 
UAV / Drone 
1 
About Me 
 Security Consultant, D.C. Area 
 Specialties: Wireless & SCADA Security 
 US Govt. and Commercial Engagements 
 Previous DEFCON talks:  WarRocketing & 
WarBallooning, (over Las Vegas ;-) 
 Hobbies:  R/C heli’s, Deep Sea Fishing 
2 
Outline 
 Intro - Aerial Wireless Surveillance 
 Past Attempts: Balloons, Rockets, UAVForge 
 New Technology: The Phantom Drone 
 Building the Network Surveillance Drone 
 Flights & Results 
 Conclusion 
3 
What’s this About? 
 Aerial visual and wireless (802.11) surveillance 
 Challenge: Personal previous attempts to capture 
and, more importantly to engage wireless targets 
from aerial platforms have been problematic: 
  WarRocketing– limited air time, Warballooning– 
limited directional control,  weak signals 
 Others: 
 Blackhat 2011, Tassey & Perkins - WASP wireless spy drone 
 UAVForge, 2011 - Covert visual surveillance, No Winner 
4 
But I luv Heli’s & Drones:  Why did UAVForge fail?  
 Factors: 
 Govt. required Heli operations be conducted 
beyond line of sight (LoS) 
 Limited First Person View (FPV) R/C techniques 
  Autonomous drone operation required, (including 
obstacle avoidance) 
 Landings Problematic: Many Crashes – Teams 
needed better descent & flight attitude indicators 
5 
UAVForge – Flight Problems 
6 
UAVForge – Another Flight 
7 
What’s New Since 2011? 
 Technology has improved dramatically: 
 Computers super tiny: Cotton Candy (30 grams) 
 CC is Bluetooth, HDMI, and 802.11 capable 
 Wifi Pineapple  (Hak5):  small + remotely 
assessable via 3G, 4G 
 DJI Phantom = the first “consumer quality” drone 
that is easily flyable by the average person.  
8 
Meet “THE” DJI Phantom 
 DJI Innovations introduced the Phantom JAN 2013 
 It quickly gained a reputation for being the most 
stable drone platform in the air today 
 Features:  
 GPS Auto-Pilot 
 Auto “Return to Home”  
 High payload capability: up to 400 grams 
 Relatively Inexpensive: $679. UAVForge Dones: $2K-9K 
9 
TechnoLust Overcomes Me:  Let’s build this! 
 I envision 3 uses for Phantom Network 
Surveillance: 
 Site Survey – large area / short time 
 Observation and Communications Capture 
Platform for incidents such as the recent Boston 
Marathon Bombing 
 Covert missions using the “Perch, Listen & 
Engage” technique from Rooftops or other 
normally inaccessible locations  
10 
TechnoLust … 
 Designed & Built 2 payloads: 
 Cotton Candy + WiSpy or KillerBee 
 Flying Pineapple = Hak5 Pineapple + GSM 3G/4G 
11 
Site Survey Payload 
 Design Considerations: 
 Cotton Candy makes a perfect headless computer 
 Apple Bluetooth KB & Mouse “detach” instantly 
 ARM processor runs Ubuntu or Android O/S 
 1.2 GHz ARM Cortex-A9 CPU, 1GB of RAM, image 
on microSD  
 Wireless Tools:  Kismet, Wispy (spectools) 
available, or pretty much any USB device, even 
Killerbee for ZIGBEE 
12 
WiSpy Flight Results 
 Lake Neighborhood:  (more flights in Progress) 
13 
WiSpy Flight Results 
 2.4 Ghz: 
14 
We found 802.11 sources – What’s next? 
 The Flying Pineapple: Tools –> Airodump, sslstrip, site 
survey, etc. 
 Payload Objectives: 
 [1] Land on a residential or commercial building, “Perch” 
 [2] Conduct Op’s 
 [3]  Return Phantom + payload safely to starting point 
 “Perch, Listen, and Engage” predictably will become an 
important technique as in the words of DARPA:  
    “The primary (perching) benefit is to increase 
(surveillance) persistence by reducing mission power 
demands while providing stable sensor emplacement.” 
15 
Pineapple Remote Operation 
 Remote admin. & monitoring via 3G or 4G (a sweet 
pen-testing drop box) 
 Utilizes a relay server, ssh proxy (Hawaii) 
 Autossh keeps the tunnel alive to the Pineapple 
(Hak5 episode 1112) 
 Operations team shells into the Drone & utilizes 
command prompt or GUI. 1200 mAh LiPo life ~=2-3 
hours with the T-Mobile Rocket ZTE-MF592 (GSM) 
 CDMA devices consume 2x power! (not 
recommended) 
16 
Pineapple Offensive Ops 
 Selected Pineapple Capabilities: 
 OpenWRT running Jasager – >“the yes man” 
 URL Snarf 
 DNS Spoofing 
 New http landing page for phishing, etc. 
 airodump-ng runs great in-flight!  
cd /usb/airodump-ng-logs 
airomon-ng start wlan0  (monitor mode) 
airodump-ng -w pcap mon0 
 Demo Pineapple GUI:  
 http over ssh 
17 
Network Diagram 
 Placeholder: Reverse ssh with Hawaii relay 
diagram shown here.   
 Update will be posted to DEFCON site. 
18 
Pineapple Flight Results 
 Airodump-NG: 
19 
Pineapple Flight Result2 
 Airodump-NG: 
20 
Flight Video 
 This slide is a placeholder: 
 Show Phantom Mission Flight Videos here (5 
min. MAX) 
 No text: all live flights from July 2013 
 Updates will be posted to DEFCON site. 
21 
How did we compare to UAVForge Team Scores?
22 
How did we compare to UAVForge Team Scores?
Phantom ~= 35 
23 
Conclusion / Future Work 
 Phantom Network Surveillance Drone: 
successful proof of concept demonstration for 
“Perch, Listen, and Engage” wireless network 
surveillance. 
 Next DARPA Challenge: 
Full FPV for non-LoS operations 
Autonomous operation with waypoints, (Naza-M 
available now.) 
Descent rate instruments for precision landing 
Extend 3 Hr. surveillance capability with better 
power design... Multiple building operations 
become possible. 
24 
Legal & Safety Issues 
 Do NOT attempt to fly a quadcopter as large and 
expensive as the Phantom without experience! (I 
highly recommend joining an R/C club or getting a 
mentor). Start small:  the Blade MQX quadcopter is 
ideal… 
 Under current FAA rules flying beyond LOS or above 
400 ft. AGL  is Illegal 
 Under no circumstances fly within 3 miles of 
any airport. 
 Do NOT violate people’s privacy with cameras or 
other devices. 
25 
Legal & Safety Issues… 
 Respect property rights: If your helicopter, drone, 
or other expensive equipment comes down on 
someone else’s property (house, roof or land): 
 Probable Case – you may Never get it back,  
 Worst Case – you may be arrested for Trespassing 
 In no way endanger people on the ground – this 
means flying away from other people and making 
sure everyone around you is aware of the aerial 
operation. 
 For more info. on pending Legislation & Legal 
Issues, (see bibliography) 
26 
Bibliography 
 DARPA UAVForge project site: 
http://www.uavforge.net/ 
 DJI Innovations, Inc. Phantom: http://www.dji-
innovations.com/product/phantom/ 
 Cotton Candy Computer: 
http://www.fxitech.com/cotton-candy/what-is-it/ 
 WiFi Pineapple (Hak5): “The Hot-Spot Honeypot 
Pen-Testing Platform”: http://wifipineapple.com/ 
 Congressional Research Service, “Integration of 
Drones into Domestic Airspace: Selected Legal 
Issues”, Dolan and Thompson, April 4, 2013 
27 
Questions?