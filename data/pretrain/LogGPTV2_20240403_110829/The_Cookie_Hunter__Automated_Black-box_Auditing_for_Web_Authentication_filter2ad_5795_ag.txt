network failures. Also, when re-evaluating these domains other
factors can affect the execution of our modules, such as our test
account being deactivated, expired domains etc.
False negatives. To obtain more insights about our framework’s
effectiveness we perform an indicative experiment where we inves-
tigate the false negative rates (FN) of the different modules in our
system. Specifically, we randomly sample 20 websites per module,
where the module’s execution did not complete successfully, and
manually inspect whether these failures were actual true negatives
or not. For our URL discovery module, we identified only four FNs,
i.e. in four cases there was a login option that our system failed
to detect. Our generic account setup component yielded 3 FNs, i.e.
we successfully signed up and/or logged in the website, but were
not able to infer the state. Similarly, the SSO module had 5 FNs.
Session 6D: Web Security CCS '20, November 9–13, 2020, Virtual Event, USA1967Figure 4: Success rate for different workflow phases.
The Cookie Auditor yielded zero FN, meaning that there was not a
single case where our system identified a website as secure against
an attack, while it really was vulnerable. Finally, the Privacy Audi-
tor had 4 FNs, i.e. there was account information that we provided
during the signup process that was not detected as being leaked.
We did not measure the Authentication Cookies FN rates, as man-
ually identifying all authentication cookies and combinations is
prohibitively time consuming or even infeasible in many cases.
URL discovery effectiveness. As mentioned, our URL discov-
ery module initially explores the URLs provided by [44] before
falling back to our own crawling approach. As such, it is of interest
to quantify how useful this dataset was and, more importantly,
how effective our system was in cases where it had to employ our
own approach. For all the websites where we identified a signup
option, 23.1% were fully discovered using the dataset from [44],
while for the remaining 76.9% we had to fall back to crawling the
websites (43.1% were included in both datasets, while 33.8% were
not included in [44]).
Failed registrations. In an attempt to better understand the
reasons behind failed registrations, we manually inspected 50 ran-
domly selected websites. In 22 cases, there was some form of an
anti-bot challenge that our system was not able to solve and, thus,
could not proceed with registration. In 23 websites one of the fields
was rejected due to inappropriate formatting, e.g. mobile phones,
addresses, passwords etc. Finally, the remaining 5 websites failed
due to unexpected or complex form behavior, e.g. after filling in a
specific field, a custom drop down list appeared that also needed to
be detected and filled out.
A.3 Manual Session Hijacking Verification.
Table 6 breaks down the results from our manual session hijacking
validation experiment. We observe that in all but one cases, the
access we obtain through our cookie hijacking attacks leads to
the exposure of sensitive information and functionality even if we
Table 4: Most common categories of susceptible domains.
Category
Online Shopping
Business
Marketing/Merch.
Internet Services
Entertainment
Education/Reference
Blogs/Wiki
Fashion/Beauty
#domains Category
#domains
3,725
1,117
1,100
642
586
558
393
322
Soft/Hardware
Sports
Job Search
Pornography
News
Real Estate
Public Info
Health
252
234
229
194
187
178
153
148
only obtain partial access. This includes the ability to view and edit
personal information, as well as execute site-specific functionality.
As expected, in most cases we cannot (fully) change account settings
(e.g., password, email). This is due to the fact that such operations
typically require the user to retype their password, which is not
known to the cookie-hijacking attacker. Nonetheless, we found that
multiple domains allow the attacker to change the password even
without knowledge of the current password.
A.4 Domain Categorization
Domain categorization. Table 4 reports the top domain categories
(classified using McAfee’s URL Ticketing System [14]) that are
vulnerable to at least one attack. We find that online shopping is
the most prevalent category of susceptible domains, highlighting
the privacy threat of cookie hijacking. These services include a
plethora of personal data (e.g., address), while. recommendations
and prior purchases can reveal sensitive user traits (e.g., sexual
orientation, religion). We also find 148 and 194 domains that provide
health-related functionality and adult content respectively,. which
potentially enable access to extremely sensitive user data.
Session 6D: Web Security CCS '20, November 9–13, 2020, Virtual Event, USA1968Table 5: The 20 most popular vulnerable domains.
Domain
amazon.com
reddit.com
twitch.tv
mail.ru
aliexpress.com
alipay.com
bing.com
amazon.co.jp
ebay.com
msn.com
xvideos.com
wordpress.com
amazon.in
xhamster.com
amazon.co.uk
pixnet.net
bongacams.com
roblox.com
nytimes.com
soundcloud.com
Eavesdropping
JS cookie stealing
✓
✗
✗
✓
✓
✓
✗
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
✗
✓
✓
✓
✓
✗
✓
✓
✓
✓
✗
✓
✗
✓
✗
✓
✓
✗
✗
✓
✓
A.5 Popular Domains
Table 5 presents the 20 most popular domains found vulnerable
during our study, which span various categories (e.g., e-commerce,
blogging, pornography etc.). We manually verified the feasibility
of session hijacking attacks in every one of these domains. It is
important to note that all of these services have a massive user
base, most likely employ professional development teams and may
even have dedicated security teams, yet they still expose their users
to significant threat. Our PrivacyAuditor module also uncovered
several interesting findings. One domain leaked the password hash
in a cookie (avgle.com), two leaked the phone number in the page’s
source (123rf.com, naukri.com) and one in the local storage (south-
west.com). One domain leaked the user’s postal address in the
source (asus.com) and two leaked the user’s workplace in the source
(alibaba.com, mailchimp.com).
Another interesting observation is that even major services like
Amazon struggle with the correct deployment of security mecha-
nisms. Specifically, we found that while amazon.com deploys HSTS,
it does so in an incomplete manner. The policy is only set on the
“www” subdomain and thus the authentication cookies we have
identified are leaked over unencrypted connections to the base
domain, since their domain attribute is set to “.amazon.com”.
Session 6D: Web Security CCS '20, November 9–13, 2020, Virtual Event, USA1969Domain
Top-1K (hand-picked)
amazon.com
aliexpress.com
ebay.com
alibaba.com
reddit.com
bing.com
bestbuy.com
banggood.com
wish.com
cloudflare.com
Top-1K (randomly selected)
indeed.com
hotels.com
vidio.com
nature.com
sciencedirect.com
1fichier.com
bitly.com
cdiscount.com
elsevier.com
espncricinfo.com
Any-rank (randomly selected)
sendatext.co
metzlerviolins.com
swotanalysis.com
kokpit.aero
brauchekondome.com
soccergarage.com
packlane.com
doggiesolutions.co.uk
jellyfields.com
helmetstickers.com
Table 6: Manually validated domains and hijacking capabilities.
Read Write
Settings
Exposed information & functionality
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✗
✓
✗
✗
N/A
✗
✗
✗
✗
N/A
✓
✗
✓
✗
✗
N/A
✗
✓
✓
View/edit cart, ad preferences, vouchers/coupons, shopping list, email subscriptions,
deals & notifications, browsing history and recommendations
View/edit favorite stores, wish list, cart, profile photo, full name, follow sellers. View
messages, order history, coupons
View/edit cart, watchlist, saved searches/sellers, messages, address, profile photo. View
recently viewed items, active bids/offers, purchase history, own items for sale
View/edit cart, full name, phone number, gender, address, job information, favorites,
profile photo. View messages, orders, transactions, contacts, recommendations
View/edit posts, comments, saved, display name, about section, profile photo, inbox,
email notifications, block users
View/edit search history, interests. View first name, profile photo
View/edit cart, saved items. View shopping history, orders
View/edit cart, wishlist, address, full name, gender, phone number, messages, reviews,
comments, download full activity record. View orders, coupons, gifcards, search history
View/edit cart, wishlist, full name, birthdate, email, notification settings. View orders,
recently viewed items
None. The attack only succeeds when performed from the same PC
View/edit saved job offers, job applications, scheduled interviews, visited jobs
View/edit favorties, searches
View/edit phone number, comments, followed channels, password. View transaction
history, watch history
View/edit full name, professional information, subscriptions. View email
View/edit full name, email, job information, phone number, address. View recommen-
dations, history
View/edit files, folders, full name, address, phone number.
View/edit bitlinks, link statistics, email address, delete account. View API key, session
history (and disconnect all sessions)
View/edit subscriptions, wish/favorites list, address, phone number. View email, birth-
date, orders, messages, vouchers, credit card info
View/edit cart, full name, email, address, phone number, partial payment information,
add new credit card
View/edit full name, email, phone number, gender, address, delete account
View/edit SMS texts (sent and replies), calls, address book
View/edit address, cart, wish list, password. View orders
View/edit teams and members, billing history, projects
View/edit full name, email, phone number, password, comments
View/edit full name, address. View email, birth date, orders
View/edit username, email, company name, address, cart, wish list, delete profile
View orders, saved designs
View/edit full name, email, address, cart, delete profile. View order history
View/edit email, username, website, favorites, password
View/edit full name, address, cart, password, delete profile. View order history
Access: full
, partial
, none
Session 6D: Web Security CCS '20, November 9–13, 2020, Virtual Event, USA1970