title:Characterizing Large-Scale Routing Anomalies: A Case Study of the
China Telecom Incident
author:Rahul Hiran and
Niklas Carlsson and
Phillipa Gill
Characterizing Large-Scale Routing Anomalies:
A Case Study of the China Telecom Incident
Rahul Hiran1, Niklas Carlsson1, and Phillipa Gill2,(cid:2)
1 Link¨oping University, Sweden
2 Citizen Lab, Munk School of Global Aﬀairs
University of Toronto, Canada
Abstract. China Telecom’s hijack of approximately 50,000 IP preﬁxes
in April 2010 highlights the potential for traﬃc interception on the In-
ternet. Indeed, the sensitive nature of the hijacked preﬁxes, including US
government agencies, garnered a great deal of attention and highlights
the importance of being able to characterize such incidents after they oc-
cur. We use the China Telecom incident as a case study, to understand
(1) what can be learned about large-scale routing anomalies using public
data sets, and (2) what types of data should be collected to diagnose
routing anomalies in the future. We develop a methodology for infer-
ring which preﬁxes may be impacted by traﬃc interception using only
control-plane data and validate our technique using data-plane traces.
The key ﬁndings of our study of the China Telecom incident are: (1) The
geographic distribution of announced preﬁxes is similar to the global dis-
tribution with a tendency towards preﬁxes registered in the Asia-Paciﬁc
region, (2) there is little evidence for subpreﬁx hijacking which supports
the hypothesis that this incident was likely a leak of existing routes,
and (3) by preferring customer routes, providers inadvertently enabled
interception of their customer’s traﬃc.
Keywords: Measurement, Routing, Security, Border Gateway Protocol.
1
Introduction
On April 8, 2010, AS 23724, an autonomous system (AS) owned by China Tele-
com, announced approximately 50,000 preﬁxes registered to other ASes. These
preﬁxes included IPs registered to the US Department of Defense [8], which
caught the attention of the US-China Economic and Security Review Commis-
sion [5]. Unlike previous routing misconﬁgurations [6, 18], China Telecom’s net-
work had the capacity to support the additional traﬃc attracted [4]. Further,
there is ample data-plane evidence suggesting that during the incident, Internet
traﬃc was reaching its correct destination. This unique situation is what led
some to suggest this was an attempt to intercept Internet traﬃc.
While the China Telecom incident has garnered attention in blogs [4, 8], news
outlets [17], and government reports [5], there has been no academic attempt
(cid:2) Data sets available at: http://www.ida.liu.se/∼nikca/papers/pam13.html
M. Roughan and R. Chang (Eds.) PAM 2013, LNCS 7799, pp. 229–238, 2013.
c(cid:2) Springer-Verlag Berlin Heidelberg 2013
230
R. Hiran, N. Carlsson, and P. Gill
to understand this incident. This dearth of understanding is especially appar-
ent when considering the many questions that remain unanswered about this
incident. These include (1) understanding properties of the hijacked preﬁxes,
(2) quantifying the impact of the event in terms of subpreﬁx hijacking, and (3)
explaining how interception was possible. We tackle these questions using pub-
licly available control- and data-plane measurements and highlight what types of
data would be useful to better understand routing anomalies in the future. We
emphasize that while we are able to characterize the incident and show evidence
supporting the hypothesis that this incident appears to be an accident, there is
currently no way to distinguish between “fat ﬁnger” incidents and those that
have malicious intent based on empirical data alone.
1.1 Insecurity of the Internet’s Routing System
Routing security incidents have happened repeatedly over the past 15 years [6,13,
18]. These incidents involve an AS originating an IP preﬁx without permission of
the autonomous system (AS) to which the preﬁx is allocated: hijacking. Usually
when hijacks happen, the misconﬁgured network either does not have suﬃcient
capacity to handle the traﬃc [18] or does not have an alternate path to the
destination [6]. In these cases, the impact of the incident is immediately felt as
a service outage or interruption of connectivity.
More troubling, are cases of traﬃc interception, where traﬃc is able to ﬂow
through the hijacking AS and on to the intended destination. Without contin-
uous monitoring of network delays or AS paths [3], incidents such as these are
diﬃcult to detect, thus creating opportunity for the hijacker to monitor or alter
intercepted traﬃc. Traﬃc interception was demonstrated in 2008 [21] and more
recently occurred during the China Telecom incident [8].
Since the China Telecom incident involved interception, measuring its im-
pact is extremely diﬃcult without extensive monitoring infrastructure. We de-
ﬁne criteria that allow us to infer potential interceptions using only control-plane
data [19]. We use data-plane measurements [15] to validate our criteria and char-
acterize the AS topologies that allowed for inadvertent interception.
1.2 Key Insights
The Geographic Distribution of Announced Preﬁxes Does Not Sup-
port Targeted Hijacking. The distribution of announced preﬁxes is similar
to the geographic distribution of all globally routable preﬁxes with a tendency
towards preﬁxes in the Asia-Paciﬁc region.
The Preﬁxes Announced Match Existing Routable Preﬁxes. We observe
that > 99% of the announced preﬁxes match those existing at the Routeviews
monitors. This supports the conclusion that the announced preﬁxes were a subset
of AS 23724’s routing table.
Providers Inadvertently Aided in the Interception of Their Customers’
Traﬃc. Many networks that routed traﬃc from China Telecom to the correct
Characterizing Large Scale Routing Anomalies
231
destination did so because the destination was reachable via a customer path
which was preferred over the path through China Telecom (a peer).
2 Related Work
While China Telecom incident occurred in April 2010, it received little attention [4,
17] until November 2010 when the US-China Economic and Security
Review Commission published their report to congress [5] which included a de-
scription of the event. After the release of the report, the incident received atten-
tion in news articles and was investigated by some technically-oriented blogs [8,14].
BGPMon, an organization that provides monitoring and analysis of BGP
data, performed the ﬁrst investigation of the China Telecom incident [4]. Using
control-plane measurements of BGP messages, they were able to identify anoma-
lous updates as those where the path terminated in “4134 23724 23724.” They
also study the geographic distribution of the hijacked preﬁxes and ﬁnd that the
majority of hijacked preﬁxes belong to organizations in the US and China.
Using both control- and data-plane data, Renesys conﬁrmed the geographic
distribution of hijacked preﬁxes observed by BGPMon [8]. Using traceroute,
Renesys was also able to show that network traﬃc was able to pass into China
Telecom’s network and back out to the intended destination. Further analysis was
performed by Arbor Networks [14] which focused on understanding how much
traﬃc was diverted into China Telecom using traﬃc ﬂows observed through
ASes participating in the ATLAS project [2]. They do not observe a signiﬁcant
increase in traﬃc entering AS 4134 on the day of the incident.
In contrast to the blog entries, our focus is on analyzing the incident using
only publicly available data to understand what can be learned using today’s
public data and what types of data should be collected in the future.
3 Methodology
To characterize the events that took place on April 8, 2010, we use a combination
of publicly available control- and data-plane measurements [7, 15, 19].
3.1 Control-Plane Measurements
BGP Updates. We use Routeviews monitors as a source of BGP updates from
around the time of the attack. We consider updates with the path attribute end-
ing in “4134 23724 23724” as belonging to the incident [4].1 Table 1 summarizes
the updates and preﬁxes matching this signature from the Routeviews monitors.
Topology Data. We use the Cyclops AS-graph from April 8, 2010 [7] to infer
the set of neighbors of China Telecom and their associated business relationships.
Knowing the neighbors of China Telecom is particularly important when iden-
tifying ASes that potentially forwarded traﬃc in (and out of) China Telecom
during the incident.
1 All but 36 preﬁxes originated by AS 23724 match this signature.
232
R. Hiran, N. Carlsson, and P. Gill
Table 1. Summary of control-plane updates matching the attack signature
Monitor (Location)
LINX (London, England)
DIXIE (Tokyo, Japan)
ISC PAIX (Palo Alto, CA)
Route-views2 (Eugene, OR)
Route-views4 (Eugene, OR)
Equinix (Ashburn, VA)
BGPMon list
Total
Number of Updates Number of Unique Preﬁxes
11,413
15,773
35,957
29,998
18,624
13,250
37,213
43,357
60,221
80,175
123,723
216,196
49,290
44,793
-
574,398
AT&T
7018
April 7, 9, 2010
6461
4134
2914
April 8, 2010
Hanaro Telecom
Korea
9318
3 more hops 
to destination
Legend
Peer
Cust
Peer
Pe
Prov
Normal traceroute
Norm
Traceroute during hijack
Fig. 1.
research.net to 125.246.217.1 (DACOM-PUBNETPLUS, KR)
Interception observed in the traceroute from planet2.pittsburgh.intel-
3.2 Data-Plane Measurements
We use data-plane measurements from the iPlane project [15] and extract tracer-
outes transiting China Telecom’s network on April 8, 2010. We ﬁrst map each IP
in the traceroute to the AS originating the closest covering preﬁx at the time of
the traceroute. If we observe a traceroute AS-path that does not contain China
Telecom (AS 4134 or AS 23724) on April 7 or 9, that does contain these networks
on April 8, we conclude that this traceroute was impacted by the incident. Fur-
ther, if we observe a traceroute that was impacted, and the ﬁnal AS in the path
is not AS 4134 or 23724, we conclude that this traceroute was intercepted. Fig-
ure 1 shows a traceroute where interception was observed. This traceroute only
transits AS 4134 (China Telecom) on April 8 and is able to reach the destination
through AS 2914 (NTT) who provides transit for AS 9318 (Hanaro Telecom).
In total, we observed 1,575 traceroutes transiting China Telecom on April 8.
Of these, 1,124 were impacted by the routing incident and 479 were potentially
intercepted, with 357 of these receiving a successful response from the target.
3.3 Limitations
We face limitations in existing data sets as we reuse them for the unintended
task of analyzing a large-scale routing anomaly.
Inaccuracies in the AS-Graph. AS-graphs suﬀer from inaccuracies infer-
ring AS-relationships (e.g., because of Internet eXchange Points (IXPs) [1]) and
Characterizing Large Scale Routing Anomalies
233
s
e
x
i
f
e
r
P
f
o
n
o
i
t
c
a
r
F
0.6
0.5
0.4
0.3
0.2
0.1
0
All Hijacked Prefixes
Hijacked prefixes excluding AS 4134
All Globally Routable Prefixes
US CN KR AU MX RU IN BR JP
Country
FR
Fig. 2. Top 10 countries impacted by the China Telecom incident
poor visibility into peering links [20]. These inaccuracies impact our analysis of
interception which uses the AS-graph to infer China Telecom’s existing path to
a destination. We discuss this limitation in more detail in Section 5.3.
Inaccurate IP to AS Mappings. We note that our mapping of IP addresses
to ASes may be impacted by IXPs or sibling ASes managed by the same insti-
tution [16]. Since our primary concern is paths that enter China Telecom only
on April 8 the impact of siblings (e.g., per-province ASes managed by China
Telecom) should be mitigated. This is because paths to China Telecom’s siblings
would normally transit China Telecom’s backbone AS 4134.
4
Impact of the China Telecom Hijack
We now consider the impact of the China Telecom incident in terms of the
preﬁxes that were announced.
4.1 What is the Geographic Distribution of the Announced
Preﬁxes?
Figure 2 shows a breakdown of the preﬁxes that were hijacked by country, with