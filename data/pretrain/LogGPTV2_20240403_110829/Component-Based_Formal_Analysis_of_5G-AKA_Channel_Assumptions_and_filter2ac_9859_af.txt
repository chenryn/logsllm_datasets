violate any security properties when the SNID ﬁx is adopted.
A2, A5, A6 are only achieved with adoption of the SNID ﬁx.
We were not able to achieve termination for A7.
E. Discussion: AStronger
We have shown that preventing compromise of each core
component is essential for secrecy and authentication properties,
as all components have signiﬁcant inﬂuence over whether
the protocol achieves the properties it seeks to uphold. For
the “Not-My-X ” scenario, we believe our analysis further
demonstrates the importance of explicitly including the SNID
in an authenticated part of the protocol’s messages.
Compromise of secure channels has a similarly devastating
effect. Unsurprisingly, Dolev-Yao-like channel compromise
allows an adversary to violate most security properties. Read-
only access does not allow the adversary to break many
agreement properties between 5G core components; more
interestingly, this read-only access to either secure channel
allows the adversary to violate almost all agreement properties
from the UE’s point of view, as this new information allows
the adversary to impersonate a serving and/or home network
successfully to the UE over the insecure UE ↔ SEAF channel.
The 5G speciﬁcation requires lawful intercept capability,
whether enabled or not. Older (current) methods to implement
this are described in TS 33.106 [6]. The 5G speciﬁc methods
for this are described and explored in TS 33.842 [2], which
is currently at version 0.0.0 since November 2017, and is a
skeleton document with little to no detail. If one implements
lawful intercept by giving law enforcement read-only access to
one of the channels, our analysis implies that law enforcement
immediately also gains the power to impersonate. This would
violate the principle of least privilege. Given such subtleties, it
would be prudent to explicitly incorporate any lawful intercept
mechanisms in the security analysis of the protocol, such
that one can provide assurance that the additional mechanism
provides what is required by law, but does not accidentally
provide any further capabilities. Analyses like the one we
perform here are suitable for this purpose.
While the 5G-AKA protocol meets its desired security
properties after inclusion of our proposed ﬁxes, it is still a
very fragile protocol. 5G-AKA loses the ability to uphold most
of its desired properties very quickly upon compromise of
almost anything outside of its explicit (relatively weak) threat
model compared to almost all modern key-exchange protocols.
XI. ATTACK IMPLICATIONS, DISCLOSURE, AND IMPACT
ON TS 33.501
The secrecy violation described in Section VIII-A allows
an adversary to impersonate another user to a serving network.
From the point of view of 5G-AKA this allows the attacker
to agree an anchor key (gaining serving network access)
dishonestly, under newly generated false credentials of a
legitimate user. This is a substantial containment problem.
The attack relies on a race condition between two sessions
of the protocol. The attack is probabilistic, and an attacker
would not be able to guarantee success; however, in any secure
protocol, there ought not exist any run of the protocol adhering
to the threat model which violates the security properties.
13
N.B. This does not allow an attacker to decrypt any honest
radio trafﬁc originally generated by the legitimate user.
A. Potential practical implications
In the real world, we conjecture that this attack might
allow an attacker to access a serving network in the name of a
legitimate user other than itself. This attacker could then bill
services, air-time, or access charges to another user; this is
clearly not the intended behaviour or level of security required.
We are not conﬁdent of the range of further authentication
and authorisation procedures which may or may not be in
place distinct from the 5G-AKA protocol, or any billing—
authentication procedures: e.g., whether speciﬁc billing actions
sent back to a user’s home network are tied to and veriﬁed
against a named anchor key or not. We note that an ARPF
would be able to establish that the anchor key was not for
the correct user; but that an AUSF or any other party without
direct access to the honest user’s long-term key K would not.
We believe it is plausible that once access is granted in the
form of an anchor key, this key is sufﬁcient to allow a user to
perform the normal range of actions within a network.
We acknowledge that there may be other technical measures
within any real-world 5G network that make full implementation
of this attack impossible in the real world. Regardless, we
believe that any authentication and key agreement protocol as
deﬁned must meet its own required security properties.
The real-world practicality of this attack will depend
on carrier-speciﬁc implementations, and to the best of our
knowledge these are not available. This makes it hard to provide
evidence of practicality, but we believe this research shows we
could easily create a ‘correct’ implementation of the standard
that makes the attack feasible. With access to a range of 5G
implementations, we hypothesise that we would ﬁnd vulnerable
instances; at the time of research this was not possible.
The strongest statement we can deﬁnitively make is that the
5G-AKA protocol on its own does not meet its security require-
ments. However, as the primary method for authentication and
key agreement within 5G, we believe that 5G networks should
not rely solely upon secondary mechanisms for security; we
believe this is sufﬁcient reason on its own to ﬁx the protocol
to prevent this and similar attacks.
B. Liaison with 3GPP SA3 and CT4
At the time of writing, 5G (and 5G-AKA) is not yet an
implemented, used, or complete standard; our publication of this
work was intended to highlight issues during the standardisation
phase, rather than after it has been ﬁnalised. As a result, we
communicated directly with the relevant working groups.
After discovering the secrecy violation, we prepared a
document describing the vulnerability, its potential implications,
and our proposed ﬁx. We then contacted members of the 3GPP
SA3 (Security) working group, informing them of our research,
and requesting they read and comment upon it.
Following the document’s distribution, we received mostly
supportive feedback from members of SA3 and other re-
searchers. Some SA3 members did not view the vulnerability
as an issue with TS 33.501, suggesting that it was not the
standard’s responsibility to ensure security, and that individual
vendors could introduce further measures to guarantee security
if they desired. We respectfully but strongly disagree.
Senior security experts from a global carrier kindly helped
us to prepare a Change Request [27] to TS 33.501. They
submitted this on our behalf to 3GPP SA3. As a result of
our publicly released document and change request, SA3 have
stated that they believe our described race condition could arise,
and that they need to ensure its mitigation. This has resulted in
a formal liaison document detailing our described mis-binding,
and how this could lead to parties being “unable to correlate
the different responses to the respective requests” [17].
The liaison document requests of 3GPP working group CT4
whether they agree that this lack of binding is present, whether
it has been taken into account, and if so, how the race condition
is avoided (requesting reference to the relevant speciﬁcation).
Finally, the document attaches a change request by another
global carrier, which is proposed as a solution. This is a generic
adaptation of our proposed ﬁx from Section IX-A.
XII. CONCLUSIONS
In this research we have demonstrated issues within the
draft 5G-AKA protocol, particularly one which, if unmitigated,
could potentially allow a malicious actor to impersonate an
honest user to a network. We propose a possible ﬁx, and we
have veriﬁed its correctness using the TAMARIN Prover. We
have worked with 3GPP, encouraging them strongly to adopt
our proposed ﬁx, and are pleased with the progress made here.
We believe our results demonstrate the importance of ﬁne-
grained component-based formal modelling: without this level
of detail in modelling, we would not have discovered the
presented race condition.
We recognise that standards often make implicit assumptions
about the reality of engineering solutions, and that there may
be other mechanisms in place which in practice mitigate the
real-world impact of this protocol vulnerability. It might be
tempting to think our attack would be prevented if underlying
layers (accidentally) provide session binding, but we showed
in Section IX-D that this need not be the case. Regardless of
whether or not implementations at lower layers accidentally
prevent the described attack, our analysis demonstrates that
such mechanisms would in fact be security-critical.
We emphasise that security critical properties of any
protocol must not depend on implicit engineering solutions;
the speciﬁcation of a standard should be such that any correct
implementation provides the desired security properties. This
is not true for the modelled TS 33.501 v0.7.0, [5], or the latest
version at the time of writing, v15.1.0.
Many of the encountered issues are exacerbated by con-
tinued reliance on symmetric cryptography. We recognise that
legacy considerations restrict the choices available to protocol
designers, but continuing to rely solely on symmetric cryptog-
raphy seems wholly inadequate in 2018. Future standards could
achieve much stronger security properties in authentication and
secrecy with the introduction of a modern, asymmetric key-
exchange mechanism at the core of any new ‘AKA’ protocol.
Identity binding and protocol design is tough, especially
within complex, multi-party protocols with subtle assumptions.
14
[14] C. Brzuska and H. Jacobsen, “A modular security analysis of EAP
and IEEE 802.11,” in Public-Key Cryptography - PKC 2017 - 20th
IACR International Conference on Practice and Theory in Public-Key
Cryptography, Proceedings, Part II, 2017, pp. 335–365.
[15] C. Cremers and M. Dehnel-Wild, “5G-AKA Tamarin Models,” 2018.
[Online]. Available: https://people.cispa.io/cas.cremers/tamarin/5G/
[16] C. Cremers, M. Horvat, J. Hoyland, S. Scott, and T. van der Merwe,
“A comprehensive symbolic analysis of TLS 1.3,” in Proceedings of
the 2017 ACM SIGSAC Conference on Computer and Communications
Security, CCS 2017, 2017, pp. 1773–1788.
[17] S. de Kievit, “S3-181468-v3 - LS to CT4 on avoiding race condition in
5G AKA,” 3GPP SA WG3 Meeting #91, 16 – 20 April 2018. [Online].
Available: http://www.3gpp.org/ftp/TSG SA/WG3 Security/TSGS3 91
Belgrade/Docs/S3-181468.zip
[18] S. R. Hussain, O. Chowdhury, S. Mehnaz, and E. Bertino, “LTEinspector:
A Systematic Approach for Adversarial Testing of 4G LTE,” in 25th
Annual Network and Distributed System Security Symposium, NDSS,
2018.
[19] G. M. Køien, “Mutual entity authentication for LTE,” in Proceedings of
the 7th International Wireless Communications and Mobile Computing
Conference, IWCMC, 2011, pp. 689–694.
[20] G. Lowe, “A Hierarchy of Authentication Speciﬁcations,” in Proceedings
10th Computer Security Foundations Workshop, Jun 1997, pp. 31–43.
[21] S. Meier, B. Schmidt, C. Cremers, and D. A. Basin, “The TAMARIN
Prover for the Symbolic Analysis of Security Protocols,” in Computer
Aided Veriﬁcation - 25th International Conference, CAV. Proceedings,
2013, pp. 696–701.
[22] H. Mun, K. Han, and K. Kim, “3G-WLAN interworking: security
analysis and new authentication and key agreement based on
EAP-AKA,” in 2009 Wireless Telecommunications Symposium, WTS.
IEEE, 2009, pp. 1–8. [Online]. Available: http://ieeexplore.ieee.org/xpl/
mostRecentIssue.jsp?punumber=4977245
[23] P. O’Hanlon, R. Borgaonkar, and L. Hirschi, “Mobile Subscriber WiFi
Privacy,” in 2017 IEEE Security and Privacy Workshops, SP Workshops
2017, 2017, pp. 169–178.
[25] E. Rescorla,
[24] K. G. Paterson and T. van der Merwe, “Reactive and Proactive
Standardisation of TLS,” in Security Standardisation Research, 2016.
“The Transport Layer Security (TLS) Protocol
Version 1.3,” Network Working Group, Internet Engineering Task
Force
[Online]. Available:
(IETF), RFC 8446, August 2018.
https://datatracker.ietf.org/doc/draft-ietf-tls-tls13/
J. Tsay and S. F. Mjølsnes, “A vulnerability in the UMTS and LTE
authentication and key agreement protocols,” in Computer Network
Security - 6th International Conference on Mathematical Methods,
Models and Architectures for Computer Network Security, MMM-ACNS.
Proceedings, 2012, pp. 65–76.
[26]
[27] Vodafone, “S3-180727 - pCR to TS33.501 - Session binding to prevent
potential 5G-AKA vulnerability,” 3GPP SA WG3 Meeting #90Bis, 26
Feb – 2 March 2018. [Online]. Available: http://www.3gpp.org/ftp/
TSG SA/WG3 Security/TSGS3 90Bis SanDiego/Docs/S3-180727.zip
We believe that the discovery of these issues further demon-
strates the importance of systematic automated veriﬁcation for
security-critical functionality and protocols.
Finally, we want to emphasise the importance of com-
munication between academia and industry: as we describe
earlier, Tsay and Mjølsnes [26] discovered a very similar style
attack across a different network boundary in 2012, but when
designing 5G-AKA, 3GPP do not appear to have taken this
into account. If they had, we believe our presented vulnerability
could also have been avoided. When we contacted 3GPP with
our report, not a single reply mentioned this previous research.
While the implications of some of the issues we discuss
can be subtle and tricky to convey, we need to ensure these
can still be communicated to industry clearly and accurately.
Some parties may not yet be used to receiving and acting upon
results and feedback from academia. In spite of this, in our
view, it is important to continue to analyse systems, providing
feedback to the relevant stakeholders, ensuring that our research
is received, read, and most importantly, acted upon.
REFERENCES
[1] TS 33.902: 3G Security: Formal Analysis of the 3G Authentication
[Online]. Available: http://www.3gpp.org/
Protocol, 3GPP, 1999.
DynaReport/33902.htm
[2] TR 33.842: Study on Lawful
Interception (LI) service in 5G,
3rd Generation Partnership Project
(3GPP); Technical Speciﬁca-
tion Group Services and System Aspects (SA3), November 2017,
version 0.0.0., https://portal.3gpp.org/desktopmodules/Speciﬁcations/
SpeciﬁcationDetails.aspx?speciﬁcationId=3184.
[3] TR 33.899: Study on the security aspects of the next generation system
(SPECIFICATION WITHDRAWN), 3rd Generation Partnership Project
(3GPP); Technical Speciﬁcation Group Services and System Aspects
(SA3), August 2017, version 1.3.0.
[4] TS 33.102: 3G security; Security architecture, 3rd Generation Partnership
Project (3GPP); Technical Speciﬁcation Group Services and System
Aspects (SA3), March 2017, version 14.1.0.
[5] TS 33.501: Security Architecture and Procedures for 5G System, 3rd
Generation Partnership Project (3GPP); Technical Speciﬁcation Group
Services and System Aspects (SA3), December 2017, version 0.7.0.
[6] TR 33.106: 3G security; Lawful interception requirements, 3rd Genera-
tion Partnership Project (3GPP); Technical Speciﬁcation Group Services
and System Aspects (SA3), June 2018, version 15.1.0.
[7] TS 33.401: 3GPP System Architecture Evolution (SAE); Security
architecture, 3rd Generation Partnership Project (3GPP); Technical
Speciﬁcation Group Services and System Aspects (SA3), January 2018,
version 15.2.0.
[8] S. Alt, P. Fouque, G. Macario-Rat, C. Onete, and B. Richard, “A cryp-
tographic analysis of UMTS/LTE AKA,” in Applied Cryptography and
Network Security - 14th International Conference, ACNS, Proceedings,
2016, pp. 18–35.
[9] M. Arapinis, L. I. Mancini, E. Ritter, M. Ryan, N. Golde, K. Redon,
and R. Borgaonkar, “New privacy issues in mobile telephony: ﬁx and
veriﬁcation,” in the ACM Conference on Computer and Communications
Security, CCS’12, 2012, pp. 205–216.
J. Arkko, V. Lehtovirta, and P. Eronen, “Improved Extensible
Authentication Protocol Method for 3rd Generation Authentication
and Key Agreement (EAP-AKA’),” RFC, vol. 5448, pp. 1–29, 2009.
[Online]. Available: https://tools.ietf.org/html/rfc5448
[10]
[11] D. A. Basin, J. Dreier, L. Hirschi, S. Radomirovic, R. Sasse, and
V. Stettler, “A Formal Analysis of 5G Authentication,” in ACM
Conference on Computer and Communications Security. ACM, 2018.
[12] D. A. Basin, S. Radomirovic, and L. Schmid, “Modeling human errors
in security protocols,” in IEEE 29th Computer Security Foundations
Symposium, CSF, 2016, pp. 325–340.
[13] B. Blanchet, “A Computationally Sound Mechanized Prover for Security
Protocols,” IEEE Trans. Dependable Sec. Comput., vol. 5, no. 4, 2008.
15