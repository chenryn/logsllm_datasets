## IMPORTANT: DevOps Kit (AzSK) is being sunset by end of FY21. More details [here](../../../ReleaseNotes/AzSKSunsetNotice.md)
----------------------------------------------
HDInsightDescription & RationaleControlSeverityAutomatedFix Script
HDInsight must have supported HDI cluster version
Being on the latest/supported HDInsight version significantly reduces risks from security bugs or updates that may be present in older or retired cluster versions.  
HighNoYes
Use Public-Private key pair together with a passcode for SSH login
Public-Private key pair help to protect against password guessing and brute force attacks
HighNoNo
HDInsight cluster access must be restricted using virtual network or Azure VPN gateway service with NSG traffic rules
Restricting cluster access with inbound and outbound traffic via NSGs limits the network exposure for cluster and reduces the attack surface.
HighNoYes
Secure transfer protocol must be used for accessing storage account resources
Use of secure transfer ensures server/service authentication and protects data in transit from network layer man-in-the-middle, eavesdropping, session-hijacking attacks. When enabling HTTPS one must remember to simultaneously disable access over plain HTTP else data can still be subject to compromise over clear text connections.
HighNoNo
Storage used for cluster must have encryption at rest enabled
Using this feature ensures that sensitive data is stored encrypted at rest. This minimizes the risk of data loss from physical theft and also helps meet regulatory compliance requirements.
HighNoNo
Sensitive data must be stored on storage linked to cluster and not on cluster node disks
Cluster node restart may cause loss of data present on cluster nodes. Also currently HDInsight does not support encryption at rest for cluster node disk.
HighNoNo
Access to cluster's storage must be restricted to virtual network of the cluster
Restricting storage access within cluster network boundary reduces the attack surface.
MediumNoNo
All users/identities must be granted minimum required cluster operation permissions using Ambari Role Based Access Control (RBAC)
Granting minimum access by leveraging RBAC feature ensures that users are granted just enough permissions to perform their tasks. This minimizes exposure of the resources in case of user/service account compromise.
MediumNoNo
Only required users/identities must be granted access to Ambari views
Granting access to only required users to Ambari views ensures minimum exposure of underline data resources.
MediumNoNo
Ambari admin password must be renewed after a regular interval
Periodic key/password rotation is a good security hygiene practice as, over time, it minimizes the likelihood of data loss/compromise which can arise from key theft/brute forcing/recovery attacks.
MediumNoNo
Diagnostics must be enabled for cluster operations
Diagnostics logs are needed for creating activity trail while investigating an incident or a compromise.
MediumNoNo
Secrets and keys must not be in plain text in notebooks and jobs
Keeping secrets such as connection strings, passwords, keys, etc. in clear text can lead to easy compromise. Storing them in a secure place (like KeyVault) ensures that they are protected at rest.
MediumNoNo