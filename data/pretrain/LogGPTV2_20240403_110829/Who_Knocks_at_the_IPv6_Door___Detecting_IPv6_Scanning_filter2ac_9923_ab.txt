servers, perhaps due to very wide use of ephemeral IPv6 addresses.
3.3 Applications and Backscatter in IPv6
To better understand how prevelant monitoring is in IPv6 and how
that affects DNS backscatter, we next look at scans to specific ap-
plication ports. We evaluate applications in two steps: we establish
a baseline response rate. We then compare DNS backscatter that
results from scans on different ports.
For both experiments we scan targets from the rDNS hitlist (our
largest list), then evaluate how often we see an expected reply (for
example, an ICMP echo reply in response to an echo request), an
unexpected reply (for example, ICMP destination unreachable), or
lack of reply.
Direct scans: Table 2 shows the results of direct scans of five
different application ports. As expected, the fraction of replies varies
by application, with the most replies from ICMP (62.9%) and fewest
from NTP (4.7%). These results are consistent with prior application
scans (for example, [8]), although they show that our target lists
have slightly higher response rate than random scanning.
Our IPv4 reply rate is also about the same as the v6 rate.
Backscatter: Having established that our target list is typical,
we next consider what DNS backscatter triggered by these scans
shows. Our goal is to understand what DNS backscatter sees of our
scans, so we can evaluate what backscatter shows of other scanners.
100101102103104105106103104105106107108109full IPv4 spaceIPv4 random(fit)rdns6rdns4alexa6alexa4p2p4p2p6Number of unique queriers (IP addresses)Number of targets (IP addresses) IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Kensuke Fukuda and John Heidemann
icmp6 (ping)
tcp22 (ssh)
tcp80 (web)
udp53 (DNS)
udp123 (NTP)
type
queries
expected reply
other reply
no reply
expected v4 reply
Table 2: Scan results overview (rDNS): expected reply is the number of expecting unique replies, e.g., ICMP echo reply for
ICMP echo. Other reply is unexpected one, e.g., ICMP destination unreach., and no reply is lack of reply.
...
1476509
27.8% 661182
13.9% 201627
58.3% 613700
30.0%
-
...
100%
44.8%
69965
13.7% 672171
41.5% 734373
35.4%
-
62.9% 410421
9.8% 205446
27.2% 860642
57.8%
-
4.7% 140893
45.5% 371044
49.4% 964572
6.3%
-
928953
145264
402292
-
9.5%
25.1%
65.3%
5.9%
v6 backscatter
w/expected reply
w/other reply
w/no reply
v4 backscatter
icmp6 (ping)
1809
1371
44
394
4478
(0.12%)
75.8% (0.09%)
2.4% (0.002%)
21.8% (0.03%)
(0.30%)
tcp22 (ssh)
(0.05%)
47.2% (0.03%)
12.1% (0.006%)
40.7% (0.02%)
(0.18%)
774
365
94
315
2731
tcp80 (web)
udp53 (DNS)
udp123 (NTP)
1020
597
87
336
3094
(0.07%)
58.5% (0.04%)
8.5% (0.006%)
32.9% (0.02%)
(0.21%)
653
137
265
251
3961
(0.04%)
21.0% (0.01%)
40.6% (0.02%)
38.4% (0.02%)
(0.27%)
746
134
183
429
4045
(0.05%)
18.0% (0.01%)
24.5% (0.01%)
57.5% (0.03%)
(0.27%)
Table 3: DNS backscatter and application behavior (rDNS).
The relationship between DNS backscatter and applications is not
obvious, because DNS backscatter typically results from logging,
and the choice to log (or not) depends on perceptions of protocol
sensitivity.
Table 3 shows DNS backscatter detections and their yield, how
many replies are seen relative to different types of replies (expected,
other, or no reply). Yield is small, varying from 0.12% for ICMP
echo (icmp6) to 0.04% for DNS (udp53), consistent with limited
monitoring in IPv6, compared to monitoring DNS backscatter in
IPv4 (0.2-0.3%). The amount of DNS backscatter depends on the
protocol. For common protocols like icmp6 and web, we see more
DNS backscatter from IP addresses that give the expected reply (for
example, icmp6 shows 0.09% yield for IP addresses that return an
echo reply). For less common protocols like DNS and NTP, DNS
backscatter is more common for hosts that do not reply to the
protocol, suggesting organizations that are logging traffic to closed
ports.
4 FINDING SCANNING ACTIVITY IN IPV6
DNS BACKSCATTER
Having established DNS backscatter for IPv6, we next examine how
much scanning we see in six months of data observed at B-Root
DNS.
4.1 Datasets
We use B-Root DNS to find DNS backscatter, then confirm scanners
against data from the MAWI backbone and the NII darknet.
DNS backscatter: We extract all reverse DNS for IPv6 as seen
at B-Root from July to December 2017. Original data is full capture,
but with occasional packet loss during very busy periods. We use
both UDP and TCP queries. We see 31M unique querier-originator
pairs, 435k unique queriers, and 29M unique IPv6 originators over
this time.
Backbone traffic: To confirm scanners we use MAWI traffic
traces [6] that are captured at a transit link of AS2500 (WIDE) from
June 2017 to March 2018. Data is a sample taken for 15 minutes
at 2pm JST each day. We extract IPv6 packets from the mixed un-
anonymized v4 and v6 trace. We see about 7M IPv6 packets in each
day’s sample.
Followed by a heurestic classifier [22] for MAWI data, we define
a network scanner as a source IPv6 address that (1) has five or
more destination IPs, (2) all going to a common destination port,
(3) with, on average, fewer than ten packets per destination IP, and
(4) the entropy of packet length is smaller than 0.1. The last crite-
rion helps distinguish network scans from DNS resolvers because
DNS resolvers query a wide variety of QNAMEs. These criteria are
conservative to reduce false positives.
Darknet traffic: We also use darknet data to confirm scanners.
Darknets are network address blocks that are routed, but that have
no hosts in them, so traffic that arrives is likely not benign (instead
it is scanning, DoS reflection, misconfiguration, etc.). We operate a
/37 IPv6 darknet from June 2017 to March 2018. We announce it with
a different AS (AS2907; SINET) than the backbone measurements
to avoid measurement overlap. We capture 15k packets from 106
source IPs in this period.
4.2 Backscatter Detection
We next look at what DNS backscatter sees in IPv6 over six months:
services, routers, and potential abuse. Table 4 gives the mean num-
ber of each group that appears per week over all six months.
We first show that DNS backscatter detects a variety of services:
large service and cloud providers (Facebook, Google, and Microsoft)
are prominent, as are CDNs. This result suggests services may
consider increasing use of reverse DNS names in IPv6.
Well known services account for about 12% of DNS backscatter.
Reverse name checks are part of validation of services such as NTP
and SMTP.
Who Knocks at the IPv6 Door? Detecting IPv6 Scanning
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
Category
Services:
Content Provider
Facebook
Google
Microsoft
Yahoo
CDN
Well-known service
DNS
NTP
mail (SMTP)
web (HTTP)
Minor service
other services
qhost
Routers:
Router
iface
near-iface
Tunnel
Teredo/6to4
tor
Potential Abuse:
Abuse
spam
scan
unknown (potential abuse)
Total
Table 4: Weekly average number of originators in each class
for six month DNS backscatter data. (Indented values sum
to their boldface parent.)
We also see a large number of routers and tunnel interfaces.
We believe those interfaces appear as a result of traceroutes from
topology studies. Traceroutes will look up the reverse names of
each router hop, and carrying out traceroutes everywhere will
look up the names of first few hops many, many times (even with
caching); our near-iface definition captures this abundance. (This
observation was confirmed by operators of a major ISP.) Tunnels
and VPNs seem to often do reverse queries, presumably during
setup.
Finally, the smallest but most important category is potential
abuse. We see 17 spammers, 16 scanners, and 95 events that are
consistent with scanning, on average per week. We discuss these
cases in detail next.
4.3 Confirming Scanners
We next discuss 7 scanners we see in backbone and darknet data.
Completeness: We first compare DNS backscatter against back-
bone and darknet data. Backscatter provides wide-angle view that
can see globally, but it only sees large events. Backbone and darknet
data are both narrowly focused, seeing only events that traverse
Count
(mean/week)
4722
3653
727
329
13
286
815
337
414
42
22
268
83
185
288
256
32
216
207
9
%
total
70.24
54.34
10.82
4.89
0.19
4.25
12.12
5.01
6.16
0.62
0.33
3.99
1.23
2.75
4.28
3.81
0.48
3.21
3.08
0.12