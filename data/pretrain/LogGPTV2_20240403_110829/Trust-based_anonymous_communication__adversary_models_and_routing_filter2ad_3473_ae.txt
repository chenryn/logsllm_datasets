to them. Analysis of this algorithm in our model shows that
it signiﬁcantly improves the anonymity of onion routing, es-
pecially when an adversary can compromise a large fraction
of the network.
An adversary that learns the trust placed in speciﬁc routers
may learn something about the resources a user (or her orga-
nization) has applied to protect her communications. And,
trust information must ﬁrst be learned to be used in deanon-
ymization as analyzed in Section 4.1. Given available space,
we leave any discussion of how an adversary might learn
trust values to future work. Similarly we do not discuss an
adversary-learning adversary for either the usage scenario
and algorithm we have described or for other cases. (For
example, if Alice is a so-called “road warrior” travelling on
behalf of her employer, and she wishes to log in from her ho-
tel to her workstation back at her oﬃce, starting her circuits
at highly trusted nodes would reveal something about who
she is trying to hide from. Such a setting requires a comple-
mentary uphill-trust algorithm, although the complement
is not simply a reverse of the downhill algorithm. There
are other subtleties, such as the diﬀerent need for dynamic
hops.)
As in onion-routing networks, trust can play a role in mix
networks too by helping to avoid compromised routers. But
the adversary and communication assumptions are some-
what diﬀerent, leading to diﬀerent strategies. Our general
model encompasses both of these types of anonymous com-
munication as well as others; however, in this paper we limit
discussion to onion-routing networks. We would like to in-
vestigate the impact of trust on other protocols to provide
secure routes. The following are some of the other issues
we intend to explore in future work: What impact might
more user classes trying to avoid distinct nonuniform adver-
saries have on each other? How robust are our results when
a fraction of users defect from the strategy that is optimal
for a given non-na¨ıve user, and what incentive mechanisms
can induce them to cooperate? Note that users with ﬂat
trust distributions will choose (cid:96)=1 plus two dynamic hops—
which is exactly the path-selection algorithm that Tor uses
today [39]. The adversaries could employ other methods of
attack, such as congestion attacks [23, 36], DoS attacks [4],
changing the network topology, and manipulating the trust
values. In addition to routers, we would like to investigate
the eﬀect of diﬀerent trust values among links, to account
for real-world Internet routing issues [21, 24]. We would
like to investigate a roving adversary that tries to compro-
mise diﬀerent sets over time [38, 48]. The joint distribution
of the events that adversaries compromise nodes could be
arbitrary, instead of assuming independence of compromise
between nodes. We could give the attacker a budget and
assign costs to attempting compromise on a node. Users
might have multiple adversaries. Every user could set a cost
for every adversary of losing privacy to that adversary. Thus
we could model the case where Alice doesn’t want to be ex-
posed by either Eve or Mallory, but would prefer one to the
other.
Though just a simple example, we have shown that our
new routing algorithm has signiﬁcant security impact in
plausible usage scenarios. Our model incorporates trust-
based routing, a novel aspect of both anonymous commu-
nication in particular and secure communication in general.
We hope that other researchers will see the potential of our
184approach and take up the above questions or be inspired to
explore our model through questions of their own.
Proceedings of 6th Information Hiding Workshop (IH
2004), pages 293–308, 2004.
6. ACKNOWLEDGMENTS
The authors would like to thank Nick Hopper for much
guidance in improving this paper. We would also like to
thank George Danezis, Karsten Loesing, and the anonymous
reviewers for helpful comments on drafts of this paper. This
work supported by ONR, NSF, and DARPA.
7. REFERENCES
[1] K. Bauer, D. McCoy, D. Grunwald, T. Kohno, and
D. Sicker. Low-resource routing attacks against Tor.
In Proceedings of the Workshop on Privacy in the
Electronic Society (WPES 2007), Washington, DC,
USA, October 2007.
[2] R. Beauxis and C. Palamidessi. Probabilistic and
nondeterministic aspects of anonymity. Theoretical
Computer Science, 410(41):4006–4025, 2009.
[3] A. Beimel and S. Dolev. Buses for anonymous message
[14] C. D´ıaz, S. Seys, J. Claessens, and B. Preneel.
Towards measuring anonymity. In R. Dingledine and
P. Syverson, editors, Privacy Enhancing Technologies,
Second International Workshop, PET 2002, Revised
Papers, pages 54–68. Springer-Verlag, LNCS 2482,
2003.
[15] R. Dingledine, M. J. Freedman, D. Hopwood, and
D. Molnar. A reputation system to increase MIX-net
reliability. In I. S. Moskowitz, editor, Information
Hiding: 4th International Workshop, IH 2001, pages
126–141, Pittsburgh, PA, USA, April 2001.
Springer-Verlag, LNCS 2137.
[16] R. Dingledine and N. Mathewson. Anonymity loves
company: Usability and the network eﬀect. In
R. Anderson, editor, Fifth Workshop on the Economics
of Information Security (WEIS 2006), June 2006.
[17] R. Dingledine, N. Mathewson, and P. Syverson. Tor:
The second-generation onion router. In Proceedings of
the 13th USENIX Security Symposium, pages 303–319.
USENIX Association, August 2004.
delivery. Journal of Cryptology, 16(1):25–39, 2003.
[18] R. Dingledine, N. Mathewson, and P. Syverson.
[4] N. Borisov, G. Danezis, P. Mittal, and P. Tabriz.
Denial of service or denial of security? How attacks on
reliability can compromise anonymity. In Proceedings
of the 14th ACM Conference on Computer and
Communications Security (CCS), October 2007.
[5] J. Camenisch and A. Lysyanskaya. A formal treatment
of onion routing. In V. Shoup, editor, Advances in
Cryptology – CRYPTO 2005: 25th Annual
International Cryptology Conference, pages 169–187.
Springer-Verlag, LNCS 3621, August 2005.
[6] D. Chaum. Untraceable electronic mail, return
addresses, and digital pseudonyms. Communications
of the ACM, 4(2), 1981.
[7] D. Chaum. The dining cryptographers problem:
Unconditional sender and recipient untraceability.
Journal of Cryptology: The Journal of the
International Association for Cryptologic Research,
1(1):65–75, 1988.
[8] T. M. Cover and J. A. Thomas. Elements of
information theory. Wiley-Interscience, New York,
NY, USA, 1991.
[9] G. Danezis. Mix-networks with restricted routes. In
R. Dingledine, editor, Privacy Enhancing
Technologies: Third International Workshop, PET
2003, pages 1–17. Springer-Verlag, LNCS 2760, 2003.
[10] G. Danezis and R. Clayton. Route ﬁngerprinting in
anonymous communications. In Sixth IEEE
International Conference on Peer-to-Peer Computing,
P2P 2006, pages 69–72. IEEE Computer Society
Press, 2006.
[11] G. Danezis, C. Diaz, and P. Syverson. Anonymous
communication. In B. Rosenberg, editor, Handbook of
Financial Cryptography. CRC Press, 2010.
[12] G. Danezis, R. Dingledine, and N. Mathewson.
Mixminion: Design of a Type III Anonymous
Remailer Protocol. In Proceedings of the 2003 IEEE
Symposium on Security and Privacy, pages 2–15, 2003.
[13] G. Danezis and A. Serjantov. Statistical disclosure or
intersection attacks on anonymity systems. In
Deploying low-latency anonymity: Design challenges
and social factors. IEEE Security & Privacy,
5(5):83–87, September/October 2007.
[19] R. Dingledine and P. Syverson. Reliable MIX cascade
networks through reputation. In M. Blaze, editor,
Financial Cryptography, 6th International Conference,
FC 2002, pages 253–268. Springer-Verlag, LNCS 2357,
2003.
[20] S. Dolev and R. Ostrovsky. Xor-trees for eﬃcient
anonymous multicast and reception. ACM
Transactions on Information and System Security,
3(2):63–84, 2000.
[21] M. Edman and P. Syverson. AS-awareness in Tor path
selection. In S. Jha, A. D. Keromytis, and H. Chen,
editors, CCS’09: Proceedings of the 16th ACM
Conference on Computer and Communications
Security, pages 380–389. ACM Press, 2009.
[22] M. Edman and B. Yener. On anonymity in an
electronic society: A survey of anonymous
communication systems. ACM Computing Surveys,
42(1), 2010.
[23] N. S. Evans, R. Dingledine, and C. Grothoﬀ. A
practical congestion attack on Tor using long paths. In
Proceedings of the 18th USENIX Security Symposium,
pages 33–50, Montreal, Canada, August 2009.
USENIX Association.
[24] N. Feamster and R. Dingledine. Location diversity in
anonymity networks. In Proceedings of the Workshop
on Privacy in the Electronic Society (WPES 2004),
pages 66–76, 2004.
[25] S. Goel, M. Robson, M. Polte, and E. G. Sirer.
Herbivore: A scalable and eﬃcient protocol for
anonymous communication. Technical Report
2003-1890, Cornell University, Ithaca, NY, February
2003.
[26] D. M. Goldschlag, M. G. Reed, and P. F. Syverson.
Hiding routing information. In Information Hiding:
First International Workshop, Proceedings, pages
137–150. Springer-Verlag, LNCS 1174, 1996.
185[27] P. Golle and A. Juels. Dining cryptographers revisited.
[39] L. Øverlier and P. Syverson. Locating hidden servers.
In Advances in Cryptology – EUROCRYPT 2004,
pages 456–473, Interlaken, Switzerland, May 2004.
Springer-Verlag, LNCS 3027.
[28] C. G¨ulc¨u and G. Tsudik. Mixing E-mail with Babel.
In Proceedings of the Network and Distributed Security
Symposium (NDSS 1996), pages 2–16, 1996.
[29] A. Hintz. Fingerprinting websites using traﬃc
analysis. In R. Dingledine and P. Syverson, editors,
Privacy Enhancing Technologies: Second International
Workshop, PET 2002, pages 171–178, San Francisco,
CA, USA, April 2002. Springer-Verlag, LNCS 2482.
[30] N. Hopper, E. Y. Vasserman, and E. Chan-Tin. How
much anonymity does network latency leak? ACM
Transactions on Information and System Security,
13(2):13–28, 2010. February.
[31] A. Johnson and P. Syverson. More anonymous onion
routing through trust. In 22nd IEEE Computer
Security Foundations Symposium, CSF 2009, pages
3–12, Port Jeﬀerson, New York, July 2009. IEEE
Computer Society.
[32] D. Kesdogan, D. Agrawal, and S. Penz. Limits of
anonymity in open environments. In Proceedings of
Information Hiding Workshop (IH 2002), 2002.
In Proceedings of the 2006 IEEE Symposium on
Security and Privacy. IEEE CS, May 2006.
[40] C. Rackoﬀ and D. R. Simon. Cryptographic defense
against traﬃc analysis. In Proceedings of ACM
Symposium on Theory of Computing, pages 672–681,
1993.
[41] M. Reiter and A. Rubin. Crowds: Anonymity for web
transactions. ACM Transactions on Information and
System Security, 1(1):66–92, 1998.
[42] V. Sassone, S. Hamadou, and M. Yang. Trust in
anonymity networks. In P. Gastin and F. Laroussinie,
editors, CONCUR 2010 - Concurrency Theory: 21st
International Conference, pages 48–70.
Springer-Verlag, LNCS 6269, 2010.
[43] B. Schneier. Secret German IP addresses leaked.
Schneier on Security, http://www.schneier.com/,
November 2008.
[44] A. Serjantov and G. Danezis. Towards an information
theoretic metric for anonymity. In R. Dingledine and
P. Syverson, editors, Privacy Enhancing Technologies,
Second International Workshop, PET 2002, Revised
Papers, pages 41–53. Springer-Verlag, LNCS 2482,
2003.
[33] M. Liberatore and B. N. Levine. Inferring the source
[45] P. Syverson. Why I’m not an entropist. In Seventeenth
of encrypted HTTP connections. In R. N. Wright,
S. De Capitani di Vimercati, and V. Shmatikov,
editors, CCS’06: Proceedings of the 13th ACM
Conference on Computer and Communications
Security, pages 255–263. ACM Press, 2006.
International Workshop on Security Protocols.
Springer-Verlag, LNCS, 2009. Forthcoming.
[46] P. Syverson. Sleeping dogs lie in a bed of onions but
wake when mixed. In 4th Hot Topics in Privacy
Enhancing Technologies (HotPETs 2011), July 2011.
[34] N. Mathewson and R. Dingledine. Practical traﬃc
[47] P. Syverson, A. Johnson, R. Dingledine, and
analysis: Extending and resisting statistical disclosure.
In D. Martin and A. Serjantov, editors, Privacy
Enhancing Technologies, 4th International Workshop,
PET 2004, Revised Selected Papers, pages 17–34.
Springer Verlag, LNCS 3424, 2005.
[35] U. M¨oller, L. Cottrell, P. Palfrader, and L. Sassaman.
Mixmaster Protocol — Version 2. Draft, 2003.
[36] S. J. Murdoch and G. Danezis. Low-cost traﬃc
analysis of Tor. In Proceedings of the 2005 IEEE
Symposium on Security and Privacy, pages 183–195,
2005.
[37] S. J. Murdoch and P. Zieli´nski. Sampled traﬃc
analysis by internet-exchange-level adversaries. In
N. Borisov and P. Golle, editors, Proceedings of the
Seventh Workshop on Privacy Enhancing Technologies
(PET 2007), Ottawa, Canada, June 2007. Springer.
[38] R. Ostrovsky and M. Yung. How to withstand mobile
virus attacks. In Proceedings of the Tenth ACM
Symposium on Principles of Distributed Computing
(PODC ’91), pages 51–59. ACM Press, 1991.
N. Mathewson. Trust-based anonymous
communication: Adversary models and routing
algorithms. Technical report, University of Texas at
Austin, 2011.
[48] P. Syverson, G. Tsudik, M. Reed, and C. Landwehr.
Towards an analysis of onion routing security. In
H. Federrath, editor, Designing Privacy Enhancing
Technologies: International Workshop on Design
Issues in Anonymity and Unobservability, Proceedings,
pages 96–114. Springer-Verlag, LNCS 2009, July 2001.
[49] The Tor project home page.
https://www.torproject.org/ .
[50] Tor metrics portal. https://metrics.torproject.org/,
April 2011.
[51] Y. Zhu, X. Fu, B. Graham, R. Bettati, and W. Zhao.
On ﬂow correlation attacks and countermeasures in
mix networks. In Proceedings of Privacy Enhancing
Technologies workshop (PET 2004), pages 207–225,
2004.
186