provided us with the following data on each output interface: all
packets that exited that interface, the input timestamp (at the corre-
sponding input interface), the output timestamp and the packet size.
Since the timestamps were synchronized, we could also calculate
the delay experienced by all packets across the monitored router.
The output links of the chosen router had different levels of uti-
lization. To investigate convexity and the variance properties of
various probing processes, we start by choosing a target output in-
terface for each of our datasets. Since a low-utilization interface is
not of much interest, we choose two of the most heavily-utilized
(OC-3) interfaces of the router. The output interface we choose for
the ﬁrst dataset is the same as the one used in [7]. For each inter-
face, we illustrate our results using a few representative 5-minute
intervals. We show the utilization of the chosen interfaces and the
representative time intervals in Figure 2.
4.2 Two Router Queueing Models
We start by using our datasets to determine if the auto-covariance
of the mean delay across a link is convex. Since our focus is on non-
intrusive probing, we focus on the mean virtual delay. To check for
the convexity condition, we need to use a model of the queueing
process in the router. We start with a simple FIFO model, i.e., the
input timestamp of each packet destined to the chosen output inter-
face is considered to be the arrival time of that packet to a FIFO
queue. The queue drains at the same rate as the OC-3 link. We
plot the (normalized) auto-covariance of the virtual delay function
obtained with both our datasets in Figure 3. In Figure 3 (Left), we
plot the auto-covariance computed using 2, 20 and 200 seconds of
P1. There are no visual signs of non-convexity once the variance of
the auto-covariance estimates become negligible. We also see sim-
ilar conﬁrmation of the convexity condition for the second dataset
in Figure 3 (Right).
Previous work [7] has shown that the simple FIFO model cannot
accurately predict per-packet delays. This is primarily because the
model ignores the time spent by packets in traversing the back-
plane.
It was shown in [7] that a more detailed model, which
uses backplane transit times dependent on packet sizes, can predict
per-packet delays more accurately. In Figure 4, we plot the auto-
covariance of the virtual delay obtained by applying this detailed
model on P2. We ﬁnd that, even under this model, convexity is not
violated. The results presented in the rest of this section are true
when either model is used with our datasets. To avoid repetitive-
ness, we only present the results obtained by applying the simple
FIFO model on P2 and the detailed model on P1.
4.3 Comparing Probing Streams
Since our empirical evaluation appears to support the convexity
condition, we next investigate if the conclusions of Theorem 2 hold
good. To do so, we choose 4 kinds of probing streams - Poisson,
deterministic (periodic probing) and two different Erlang probing
streams (recall that an Erlang law is a Gamma law with an integral
shape value). We choose two different shape parameters - 2 and
4 - for the Erlang probing streams. For each representative time
interval, we conduct 50000 experiments with each probing stream.
In every experiment, the probing stream starts at a random time
from the beginning of the representative time interval. The probing
x 10−5
x 10−5
1.15
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
n
o
i
t
1.1
1.05
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
n
o
i
t
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
4.6
4.5
4.4
4.3
4.2
4.1
4
3.9
3.8
0.01 0.02
0.05  0.1
 0.5
Mean Inter−probe Time [secs]
 0.2
   1
1
0.01 0.02
0.05  0.1
 0.5
Mean Inter−probe Time [secs]
 0.2
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
n
o
i
t
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
   1
1.3
1.25
1.2
1.15
1.1
1.05
1
0.95
0.9
0.85
x 10−4
0.01 0.02
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
0.05  0.1
 0.5
Mean Inter−probe Time [secs]
 0.2
   1
Figure 6: Comparison of the standard deviation of the mean virtual delay estimates achieved with P2 (20 probes) (Left), P4 (20
probes) (Middle) and Q3 (20 probes) (Right).
x 10−4
1.2
1.15
n
o
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
i
t
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
1.1
1.05
1
0.95
0.9
0.85
0.01 0.02
0.05  0.1  0.2
Mean Inter−probe Time [secs]
 0.5    1    2
   5
Figure 5: Plot illustrating the higher standard deviation of
Poisson probing as compared to Gamma probing with P1 (10
probes). We use a log-scale on the x-axis.
stream consists of virtual probes, whose delays are computed using
one of our two queueing models. These virtual delays are then used
to estimate the mean virtual delay.
In Figure 5, we plot the standard deviation of the mean virtual de-
lay estimates obtained with P1 (10 probes) for various mean inter-
probe times. We make three observations. First, Poisson prob-
ing clearly demonstrates higher variance than both types of Erlang
probing especially at the low inter-probe times. For inter-probe
gaps closer to a second, we ﬁnd that the difference in variance be-
comes minimal. Second, at small inter-probe times, the periodic
probing stream has the lowest variance. This agrees with Theorem
2. Third, as the inter-probe times increase, the variance of periodic
probing actually increases before decreasing at the inter-probe time
of 5s.
In Figure 6, we show plots similar to Figure 5 for P2, P4 and Q3
(with 20 probes). The ﬁrst two observations hold true in all of them
- Poisson probing continues to be worse than Erlang probing espe-
cially at smaller mean inter-probe times. However, the variance of
periodic probing does not always increase. In P4 and Q3, it has the
lowest variance, which is consistent with Theorem 2.
4.4 Number of Probes
When we used up to 20 probes, we found that Poisson is dis-
tinctly inferior to Gamma probing (Erlang probing being a special
case) and periodic probing especially at small mean inter-probe
times. We now investigate if this behavior depends on the num-
ber of probes used. To do so, we compare the standard deviation of
the various strategies by varying the number of probes. We plot the
results for P1 and Q3 (for inter-probe time of 10ms) in Figure 7.
We ﬁnd that the number of probes does not affect the relative per-
formance of the probing strategies. Moreover, the results remain
consistent with our theorems. Periodic is optimal and Erlang con-
verges to the optimal value as the shape parameter increases.
Slower links are likely to have non-zero auto-covariance at much
larger lag values than OC-3 links. Hence, if the convexity condition
is true, we expect that Poisson probing will be inferior to Gamma
probing on slower links for a larger range of inter-probing times.
Hence, in practice, the sub-optimality of Poisson probing is likely
to be more signiﬁcant.
4.5 Periodic Probing
In Figure 5, we saw that the variance of periodic probing anoma-
lously increased before converging to the variance of all other prob-
ing strategies at an average inter-probe time of 5s. To investigate if
this behavior is consistent, we plot similar results for P2 and Q2 in
Figure 8 (Left and Middle). We ﬁnd that the variance of periodic
probing is not predictable - it shows an anomalous increase for P2
but not for Q2.
There are a few possible reasons behind the anomalous behavior
of periodic probing. Though the auto-covariance plots for the vir-
tual delay in either dataset show no visible signs of non-convexity,
there might be non-convex effects that are signiﬁcant only at certain
lag values. The anomalous behavior could also be a manifestation
of residual phase-locking effects that make the system lack ergod-
icity when periodic probing is used. Indeed, one of the goals be-
hind Theorem 2 and our use of Gamma probing over periodic prob-
ing was precisely to avoid such potential sample-path bias while
achieving near-optimal variance (when R(τ ) is convex).
In Figure 8 (Right) we compare Erlang probing streams with
shape parameters between 2 and 2048. We ﬁnd that the shape pa-
rameters 4 and 16 possess good variance reduction properties. We
also see that, with higher shape parameters, the variance of Erlang
probing streams does converge to that seen by periodic probing.
Thus, empirically, small shape parameters of Erlang between 4 and
16 appear to provide a good trade-off - lack of sample-path bias
due to the mixing property and a near-optimal variance.
n
o
i
t
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
6.4
6.2
6
5.8
5.6
5.4
5.2
x 10−5
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
x 10−5
11
10.5
n
o
i
t
i
a
v
e
D
d
r
a
d
n
a
S
n
o
t
i
t
a
m
i
t
s
E
0.01 0.02
0.05  0.1  0.2
Mean Inter−probe Time [secs]
 0.5    1    2
   5
10
9.5
9
8.5
8
Poisson
Erlang (Shape=2)
Erlang (Shape=4)
Deterministic
x 10−4
1.15
1.1
n
o
i