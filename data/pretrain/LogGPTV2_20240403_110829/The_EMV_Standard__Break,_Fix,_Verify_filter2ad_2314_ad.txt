common practice of terminals is to reject the attempt and
instruct the cardholder to switch to the contact interface.
V. ANALYSIS RESULTS
We conducted a full-scale, automated security analysis of
40 conﬁgurations of EMV, including both types of transac-
tions: contact and contactless. We describe the results of this
comprehensive analysis in this section.
A. Analysis Results for the EMV Contact Protocol
Our analysis results for the 24 conﬁgurations of the EMV
contact protocol are summarized in Table I. Although there
are no major surprises here, the results illustrate the beneﬁts
of a comprehensive formalization and analysis. In particular,
we both rediscovered existing, known attacks on the contact
protocols as well as attacks that, to our knowledge are new,
but relatively difﬁcult to carry out in practice and therefore
have limited practical relevance. Note that we have omitted the
results for secrecy from the table because they are identical for
all models. All of our models and proofs are available at [33].
Our analysis revealed disagreement, both between the ter-
minal and the card and between the bank and the card, on the
selected CVM for transactions using SDA or ofﬂine (plain or
enciphered) PIN veriﬁcation (Table I, Remark 1).
For transactions where the terminal performed ofﬂine PIN
veriﬁcation, our analysis identiﬁes a trace that represents the
PIN bypass attack ﬁrst observed by Murdoch et al. [1] for
transactions using SDA. In this attack, a man-in-the-middle
sends the success response to the terminal’s PIN veriﬁcation
request. The actual request is blocked and so the card believes
that no PIN veriﬁcation was required, ergo the disagreement
between the terminal and the card. The terminal forwards
the transaction to the bank (either for online authorization or
to collect the funds), which then leads to the disagreement
between the bank and the card.
A prerequisite for this attack to succeed is that, even if the
terminal sends to the card the Cardholder Veriﬁcation Method
Results (CVMR) data object, which encodes the terminal’s
view of the CVM used, and the card detects the mismatch with
its own view of the CVM used, the card does not abort the
transaction. This appears to be the case in practice (although
EMV’s speciﬁcation is not explicit about this) and has been
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:10:50 UTC from IEEE Xplore.  Restrictions apply. 
1773
Contact SDA PlainPIN Online
Contact SDA PlainPIN Ofﬂine
Contact SDA OnlinePIN Online
Contact SDA OnlinePIN Ofﬂine
Contact SDA NoPIN Online
Contact SDA NoPIN Ofﬂine
Contact SDA EncPIN Online
Contact SDA EncPIN Ofﬂine
Contact DDA PlainPIN Online
Contact DDA PlainPIN Ofﬂine
Contact DDA OnlinePIN Online
Contact DDA OnlinePIN Ofﬂine
Contact DDA NoPIN Online
Contact DDA NoPIN Ofﬂine
Contact DDA EncPIN Online
Contact DDA EncPIN Ofﬂine
Contact CDA PlainPIN Online
Contact CDA PlainPIN Ofﬂine
Contact CDA OnlinePIN Online
Contact CDA OnlinePIN Ofﬂine
Contact CDA NoPIN Online
Contact CDA NoPIN Ofﬂine
Contact CDA EncPIN Online
Contact CDA EncPIN Ofﬂine
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
Legend:
(cid:88): property veriﬁed ×: property falsiﬁed
(1): disagrees with the card on the CVM used
(cid:88)
(cid:88)
(cid:88)
–
(cid:88)
(cid:88)
–
–
(cid:88)
(cid:88)
(cid:88)
–
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
–
(cid:88)
(cid:88)
(cid:88)
(cid:88)
bank accepts
×(2)
×(2)
×(2)
–
×(2)
×(2)
–
–
×(2)
×(2)
×(2)
–
×(2)
×(2)
×(2)
×(2)
(cid:88)
(cid:88)
(cid:88)
–
(cid:88)
(cid:88)
(cid:88)
(cid:88)
Properties
auth. to terminal
×(1,2)
×(1,2)
×(1,2)
–
×(1,2)
×(1,2)
–
–
×(1,2)
×(1,2)
×(2)
–
×(2)
×(2)
×(1,2)
×(1,2)
×(1)
×(1)
(cid:88)
–
(cid:88)
(cid:88)
×(1)
×(1)
auth. to bank
×(1)
×(1)
×(1)
–
×(1)
×(1)
–
–
×(1)
×(1)
(cid:88)
–
(cid:88)
(cid:88)
×(1)
×(1)
×(1)
×(1)
(cid:88)
–
(cid:88)
(cid:88)
×(1)
×(1)
LoC
Time
758
761
758
731
752
755
758
761
766
769
775
739
769
772
766
769
763
766
781
739
775
778
763
766
13m07s
11m39s
13m02s
11m48s
8m21s
6m37s
12m21s
11m36s
13m48s
12m20s
16m04s
12m27s
12m15s
8m43s
14m07s
12m59s
1h55m31s
14m10s
6h03m05s
12m15s
2h31m23s
12m16s
1h59m44s
14m00s
ANALYSIS RESULTS FOR THE EMV CONTACT PROTOCOL. ALL TARGET MODELS HAVE 55 RULES. THE LAST TWO COLUMNS INDICATE, IN THAT ORDER,
THE NUMBER OF LINES OF TAMARIN CODE THAT THE MODEL COMPRISES, AND THE TIME TAKEN FOR OUR ANALYSIS, USING TAMARIN V1.5.1 ON A
COMPUTING SERVER RUNNING UBUNTU 16.04.3 WITH TWO INTEL(R) XEON(R) E5-2650 V4 @ 2.20GHZ CPUS (WITH 12 CORES EACH) AND 256GB
OF RAM. HERE WE USED 10 THREADS AND AT MOST 20GB OF RAM PER MODEL. THE MODELS FOR WHICH ALL FOUR PROPERTIES WERE VERIFIED
ARE HIGHLIGHTED IN BOLD.
TABLE I
No.
Target model
executable
–: not applicable
(2): disagrees with the card on the last AC
successfully tested with three different Mastercard cards using
our Android app. Such tests, even though they were conducted
contactless, give us a fair degree of conﬁdence that it also
occurs with contact transactions.
Our analysis also exhibits that all transactions using SDA
or DDA are vulnerable to a Transaction Cryptogram (TC)
modiﬁcation. This is because in neither of these methods the
card authenticates the TC to the terminal (Table I, Remark 2).
In terms of secrecy, the results are identical for all models.
The keys (private and shared) are secret, whereas the PAN
is not. Interestingly, our analysis reports that the PIN is not
secret. A man-in-the-middle attack between the card and the
terminal can use a compromised bank’s private key to produce
the card records needed to make the terminal believe that
the only CVM the card supports is plain PIN. These (fake)
records are twofold: a list of supported CVMs composed of
plain PIN only, and either an SSAD or a card’s PKI certiﬁcate
validating such a CVM list. The terminal thus downgrades to
plain PIN veriﬁcation and consequently the PIN entered by the
cardholder can be intercepted and learned by the attacker. This
is a non-trivial attack though, as carrying this out in practice
requires that the attacker:
1) knows a compromised bank’s private key, and
2) inconspicuously controls the terminal’s contact interface.
Our model considers these two conditions to be possible,
at least in theory. However, in practice they are difﬁcult to
achieve. We note however that a single compromised bank is
sufﬁcient, and it need not be the one that issued the victim’s
card.
Summary: We show that only three conﬁgurations of the
EMV contact protocol guarantee secure transactions in terms
of the three main properties we considered. These conﬁgu-
rations all use CDA as the authentication method and are
typeset in bold in Table I. In combination with online PIN
as the Cardholder Veriﬁcation Method, the resulting target
conﬁguration allows all transactions (high and low value) and
is secure. It is also the only one of the three conﬁgurations
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:10:50 UTC from IEEE Xplore.  Restrictions apply. 
1774
that effectively checks that the person presenting the card is
the legitimate cardholder. The other two conﬁgurations instead
delegate this check to the cashier, e.g., by a paper signature
(whose actual veriﬁcation is out of EMV’s scope). This makes
these two conﬁgurations not usable for high-value transactions
in many countries.
B. Analysis Results for the EMV Contactless Protocol
Our analysis results for the 16 conﬁgurations of the EMV
contactless protocol are summarized in Table II. Here Tamarin
uncovered new, potentially high-valued attacks.
Our analysis shows that the Mastercard contactless protocol
provides security for all high-value transactions. During trans-
actions using SDA or DDA, the card does not authenticate
the Application Cryptogram (AC) to the terminal (Table II,
Lines 5, 7, 9, and 11, Remark 2). Therefore, during ofﬂine
transactions using either of these methods, a man-in-the-
middle can modify the AC (or Transaction Cryptogram due