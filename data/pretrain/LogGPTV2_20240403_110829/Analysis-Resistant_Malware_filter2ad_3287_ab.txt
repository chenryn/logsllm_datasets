### Achieved Alone
These properties exhibit another intriguing relationship. When a malware author aims to conceal the function being computed on a compromised host, this requirement intensifies the need for reduced communication. Specifically, if either a public key obfuscation scheme or the straightforward method of returning all input data is used to hide the function, an analyst on the remote host will only see the set of inputs that are read. The malware author will want this set to be as large and generic as possible to minimize the information revealed about their activities. In the case of Private Information Retrieval (PIR), the set of inputs read reveals everything the malware could possibly be retrieving, so it must be large to achieve meaningful secrecy. This relationship between the need for secrecy of the function computed (or documents returned in the special case of PIR) and the need to read a large amount of data on the remote host limits the circumstances under which the trivial approach of returning all input is feasible. The malware author may also wish to limit exfiltration bandwidth to reduce the chances of detection.

### Properties Offered by These Techniques

1. **Low Bandwidth:**
   - The malware can scan a large amount of data, effectively hiding its intentions, but only use bandwidth to send back what is deemed relevant. This decreases the likelihood of detection.

2. **Hiding:**
   - In the event of discovery, the malware will not reveal the specific information it sought. Even with full access to and control over the malware binary (or even its source code), its execution environment, and all associated data, security professionals and researchers will be unable to determine which specific pieces of data the malware was retrieving.

This raises a natural question: "Under what circumstances are these properties important to a malware author?" To answer this, we explore the goals of targeted malware and the constraints under which they operate.

## 3. PIR-Based Malware

Having considered the general definitions of public key obfuscation and cryptographic tools for implementing it, we now delve into a specific example of such techniques that could be used in malware today. Specifically, we investigate the possibility of malware employing PIR techniques.

### 3.1 Targeted Espionage

Compromised hosts are desired for various purposes, including DDoS attacks and as stepping stones for further malicious activities. However, PIR techniques are most useful for malware designed to retrieve information. Recent years have seen increasing cases of malware found within organizations specifically targeted for military or industrial espionage.

One such case, dubbed "Trojangate," involved tens of thousands of commercially sensitive documents captured by malware on hosts within dozens of prominent Israeli companies and exfiltrated to about 100 receiving servers, causing widespread media attention [29, 27]. The trojan, known as Rona or Hotword.B, was specifically written for espionage and had not been previously encountered in the wild. The incident was not an opportunistic attempt by an isolated hacker; instead, the malware was sold to and used by several private investigation firms hired by three of Israel’s top telecom companies. The trojan was introduced through carefully executed social engineering efforts, using infected documents attached to emails and delivered on CDs. It used lists of keywords to trigger keystroke logging and screen captures, in addition to searching for sensitive documents [20]. Due to the low profile maintained by the infected machines, the trojan was not discovered for over a year and a half, leading to stock losses, numerous arrests, and a possible attempted homicide.

Other incidents highlight the threat of carefully targeted malware. In 2004, several New York banks were affected by malware designed to infect only specific systems within their organizations. A project by the Ponemon Institute revealed malware that searched for documents flagged as confidential or "critical." Anti-virus firm MessageLabs discovered a trojan specifically designed to obtain data from an application used in airplane design, suggesting military espionage [29]. These incidents underscore a setting where stealthy operation is crucial for the malware author. Explicitly searching for sensitive documents may unacceptably reveal a link between the malware and its origin when analyzed. In cases of military, political, or commercial espionage, PIR techniques may be key to effectively obtaining sensitive information while exfiltrating minimal data and avoiding detection.

### 3.2 Attacker Goals and PIR

We now consider in greater detail the possible motivations of malware authors and the challenges they face to determine the conditions under which PIR techniques will be beneficial. Table 1 lists several types of information they may seek from a compromised host.

#### Exfiltration Strategies

For each example in Table 1, we provide the general type of document or data desired, the criteria for finding the specific documents or pieces of data of interest, and the risk incurred by performing an explicit search for the items of interest. We also estimate the bandwidth necessary to exfiltrate all data of that type and the bandwidth necessary to exfiltrate only the specific item of interest. Some examples involve transient data (e.g., network traffic), which must be recorded by malware as it arises, while others correspond to static data stored on the host. For static data, the malware may immediately begin scanning and exfiltrating upon arrival and terminate upon completion. For transient data, the malware must wait within the system.

To retrieve the desired information, a malware author has three options:

- **Return All:** Exfiltrate all data of that type.
- **Explicit Search:** Include a keyword list or other search criteria and return only the relevant items.
- **Private Search:** Use PIR techniques to return the relevant items while hiding the search criteria.

The "return all" strategy may be employed when a type of data is small enough to be exfiltrated without arousing suspicion or when the malware author knows no system will be monitoring bandwidth. In such cases, PIR techniques are not necessary. Otherwise, the malware author will need to selectively return only items matching a list of keywords or other criteria. If these keywords or criteria do not reveal an unacceptable link with the source of the malware or their intentions, the search may be performed normally within the malware (explicit search), and PIR techniques are again unnecessary. However, when exfiltrating all data of interest would consume a conspicuous amount of bandwidth and revealing the specific information sought would be unacceptable, the private search strategy becomes key to achieving the malware author’s goals.

#### Available Bandwidth

To date, malware authors have primarily retrieved information from compromised machines by directly forming new outgoing connections rather than attempting to piggyback data on existing traffic using network covert channels. To avoid detection, the traffic may be minimally disguised as legitimate, for example, by using port 80 and formatting the traffic as an HTTP request. Recently, a web proxy called Web Tap was developed to detect automated outbound transmissions disguised as browsing sessions [7]. By recording statistics such as the timing and sizes of HTTP requests in legitimate browsing sessions, Web Tap was able to detect several spyware clients and backdoors that tunnel communication in this manner. To avoid detection by similar monitoring techniques, the malware must time traffic to blend in with existing web browsing sessions and throttle its bandwidth to be below alert thresholds. Both of these techniques have been observed in the wild [8, 20].

During the development of Web Tap, detailed statistics on typical web browsing sessions were collected, providing insights into the patterns that malware must mimic to remain undetected.