tracing [37]. In Zcash, the low volume of anonymous transac-
tions was shown to enable tracing of many transactions via
usage pattern heuristics [4,28]. These works suggest protocol-
level issues with these schemes, which is very different to the
side-channel information leakage studied in this paper.
Our side-channel attacks complement a large body of work
on de-anonymization of crypto-currency transactions. Many
authors have shown that analyzing Bitcoin’s public transac-
tion graph breaks users’ pseudonymity [2, 24, 34, 42, 44]. In
privacy-focused currencies, common usage patterns can be
exploited to link and trace certain transactions in Zcash [4,28,
USENIX Association
29th USENIX Security Symposium    2753
0210220230240250260Value in pico-monero20.820.921.021.121.221.3Proof Time [ms]R=0.04Acknowledgments
We thank the Zcash and Monero security teams for their pro-
fessional handling of the vulnerability disclosure process, for
insightful discussions, and for the prompt deployment of re-
mediations.
Dan Boneh’s research was supported in part by NSF, ONR,
the Simons Foundation and a Google faculty fellowship. Ken-
neth G. Paterson’s research was supported in part by a gift
from VMware.
References
[1] Nadhem J Al Fardan and Kenneth G Paterson. Lucky
thirteen: Breaking the TLS and DTLS record proto-
cols. In 2013 IEEE Symposium on Security and Privacy,
pages 526–540. IEEE, 2013.
[2] Elli Androulaki, Ghassan Karame, Marc Roeschlin, To-
bias Scherer, and Srdjan Capkun. Evaluating user pri-
In International Conference on Fi-
vacy in Bitcoin.
nancial Cryptography and Data Security, pages 34–51.
Springer, 2013.
[3] Daniel Arp, Fabian Yamaguchi, and Konrad Rieck. Tor-
ben: A practical side-channel attack for deanonymizing
Tor communication. In Proceedings of the 10th ACM
Symposium on Information, Computer and Communica-
tions Security, pages 597–602. ACM, 2015.
[4] Alex Biryukov, Daniel Feher, and Giuseppe Vitto. Pri-
vacy aspects and subliminal channels in Zcash. In ACM
SIGSAC Conference on Computer and Communications
Security, 2019.
[5] Nir Bitansky, Ran Canetti, Alessandro Chiesa, and Eran
Tromer. From extractable collision resistance to succinct
non-interactive arguments of knowledge, and back again.
In Innovations in Theoretical Computer Science, pages
326–349, 2012.
[6] Daniel Bleichenbacher. Chosen ciphertext attacks
against protocols based on the rsa encryption standard
pkcs# 1. In Annual International Cryptology Confer-
ence, pages 1–12. Springer, 1998.
[7] Sean Bowe. Rust crate bls12_381 v0.1.0. https://
github.com/zkcrypto/bls12_381, 2019.
[8] Billy Bob Brumley and Nicola Tuveri. Remote timing
attacks are still practical. In European Symposium on Re-
search in Computer Security, pages 355–371. Springer,
2011.
[9] David Brumley and Dan Boneh. Remote timing attacks
are practical. Computer Networks, 48(5):701–716, 2005.
[10] Benedikt Bünz, Jonathan Bootle, Dan Boneh, Andrew
Poelstra, Pieter Wuille, and Greg Maxwell. Bulletproofs:
Short proofs for conﬁdential transactions and more. In
2018 IEEE Symposium on Security and Privacy (SP),
pages 315–334. IEEE, 2018.
[11] Chainalysis. https://www.chainalysis.com/.
[12] Ciphertrace. https://www.ciphertrace.com/.
[13] Fergus Dall, Gabrielle De Micheli, Thomas Eisenbarth,
Daniel Genkin, Nadia Heninger, Ahmad Moghimi, and
Yuval Yarom. Cachequote: Efﬁciently recovering long-
IACR
term secrets of SGX EPID via cache attacks.
Transactions on Cryptographic Hardware and Embed-
ded Systems, pages 171–191, 2018.
[14] Danny Dolev, Cynthia Dwork, and Moni Naor. Non-
malleable cryptography. SIAM review, 45(4):727–784,
2003.
[15] Electric Coin Company. Zcash pull request #2120: Ex-
perimental feature: remote proving service. https:
//github.com/zcash/zcash/pull/2120, 2017.
[16] Electric Coin Company.
[ZIP 305] best practices
for hardware wallets supporting Sapling. https://
github.com/zcash/zcash/issues/3038, 2018.
[17] Electric Coin Company.
Security announcement
2019-09-24. https://z.cash/support/security/
announcements/security-announcement-2019-
09-24/, 2019.
[18] Electric Coin Company.
Zcash documentation—
https:
security warnings—side-channel attacks.
//zcash.readthedocs.io/en/latest/rtd_pages/
security_warnings.html#side-channel-attacks,
2019. Revision fe830a5a.
[19] Electric Coin Company. Zcash documentation—Tor
support in Zcash. https://zcash.readthedocs.io/
en/latest/rtd_pages/tor.html, 2019. Revision
fe830a5a.
[20] Electric Coin Company.
Zcash release v2.0.7-
https://github.com/zcash/zcash/releases/
3.
tag/v2.0.7-3, 2019.
[21] Electric Coin Company.
mobile,
building
ECC releases resources
shielded-Zcash wallets.
for
https://electriccoin.co/blog/ecc-releases-
resources-for-building-mobile-shielded-
zcash-wallets/, 2020.
[22] Electric Coin Company. Zcash release v2.1.1. https:
//github.com/zcash/zcash/releases/tag/v2.1.1,
2020.
2754    29th USENIX Security Symposium
USENIX Association
[23] Elliptic
forensics
www.elliptic.co.
software.
https://
2013 conference on Internet measurement conference,
pages 127–140. ACM, 2013.
[24] Michael Fleder, Michael S Kester, and Sudeep Pillai.
arXiv preprint
Bitcoin transaction graph analysis.
arXiv:1502.01657, 2015.
[35] Monero. Monero Pull Request #6074: Fix info leak
when using a remote daemon. https://github.com/
monero-project/monero/pull/6074, 2019.
[25] Jens Groth. On the size of pairing-based non-interactive
arguments. In Annual International Conference on the
Theory and Applications of Cryptographic Techniques,
pages 305–326. Springer, 2016.
[26] Dominik Herrmann, Rolf Wendolsky, and Hannes Fed-
errath. Website ﬁngerprinting: attacking popular pri-
vacy enhancing technologies with the multinomial naïve-
Bayes classiﬁer. In Proceedings of the 2009 ACM work-
shop on Cloud computing security, pages 31–42. ACM,
2009.
[27] Daira Hopwood, Sean Bowe, Taylor Hornby, and
Nathan Wilcox. Zcash protocol speciﬁcation. Tech-
nical report, Electric Coin Company, 2019.
Ver-
sion 2019.0.1 https://github.com/zcash/zips/
blob/d39ed0/protocol/protocol.pdf.
[28] George Kappos, Haaroon Yousaf, Mary Maller, and
Sarah Meiklejohn. An empirical analysis of anonymity
in Zcash. In 27th USENIX Security Symposium, pages
463–477, 2018.
[29] Paul C Kocher. Timing attacks on implementations
of Difﬁe-Hellman, RSA, DSS, and other systems. In
Annual International Cryptology Conference, pages 104–
113. Springer, 1996.
[30] Amrit Kumar, Clément Fischer, Shruti Tople, and Pra-
teek Saxena. A traceability analysis of Monero’s
blockchain. In European Symposium on Research in
Computer Security, pages 153–173. Springer, 2017.
[31] Sergio Lerner. About my new Bitcoin vulnerability: get
your peer public addresses. https://bitslog.com/
2013/01/23/new-bitcoin-vulnerability-get-
your-peer-public-addresses/, 2013.
[32] Brian N Levine, Michael K Reiter, Chenxi Wang, and
Matthew Wright. Timing attacks in low-latency mix sys-
tems. In International Conference on Financial Cryp-
tography, pages 251–265. Springer, 2004.
[33] Greg Maxwell.
transac-
https://people.xiph.org/~greg/
Conﬁdential
tions.
confidential_values.txt, 2016.
[36] Monero-Hax123. Corrupt RPC responses from remote
daemon nodes can lead to transaction tracing. https:
//hackerone.com/reports/304770, 2018.
[37] Malte Möser, Kyle Soska, Ethan Heilman, Kevin Lee,
Henry Heffan, Shashvat Srivastava, Kyle Hogan, Ja-
son Hennessey, Andrew Miller, Arvind Narayanan, and
Nicolas Christin. An empirical analysis of traceabil-
ity in the Monero blockchain. Proceedings on Privacy
Enhancing Technologies, 2018(3):143–163, 2018.
[38] Steven J Murdoch and George Danezis. Low-cost trafﬁc
analysis of Tor. In 2005 IEEE Symposium on Security
and Privacy (S&P’05), pages 183–195. IEEE, 2005.
[39] Andriy Panchenko, Lukas Niessen, Andreas Zinnen, and
Thomas Engel. Website ﬁngerprinting in onion routing
based anonymization networks. In Proceedings of the
10th annual ACM workshop on Privacy in the electronic
society, pages 103–114. ACM, 2011.
[40] Jeffrey Quesnelle. On the linkability of Zcash transac-
tions. arXiv preprint arXiv:1712.01210, 2017.
[41] Charles Rackoff and Daniel R Simon. Non-interactive
zero-knowledge proof of knowledge and chosen cipher-
text attack. In Annual International Cryptology Confer-
ence, pages 433–444. Springer, 1991.
[42] Fergal Reid and Martin Harrigan. An analysis of
anonymity in the Bitcoin system. In Security and pri-
vacy in social networks, pages 197–223. Springer, 2013.
[43] Ronald L. Rivest, Adi Shamir, and Yael Tauman. How to
leak a secret. In Advances in Cryptology - ASIACRYPT,
pages 552–565, 2001.
[44] Dorit Ron and Adi Shamir. Quantitative analysis of the
full Bitcoin transaction graph. In International Con-
ference on Financial Cryptography and Data Security,
pages 6–24. Springer, 2013.
[45] Eli Ben Sasson, Alessandro Chiesa, Christina Garman,
Matthew Green, Ian Miers, Eran Tromer, and Madars
Virza. Zerocash: Decentralized anonymous payments
from Bitcoin. In 2014 IEEE Symposium on Security and
Privacy, pages 459–474. IEEE, 2014.
[34] Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kir-
ill Levchenko, Damon McCoy, Geoffrey M Voelker, and
Stefan Savage. A ﬁstful of Bitcoins: characterizing pay-
ments among men with no names. In Proceedings of the
[46] Vitaly Shmatikov and Ming-Hsiu Wang. Timing analy-
sis in low-latency mix networks: Attacks and defenses.
In European Symposium on Research in Computer Se-
curity, pages 18–33. Springer, 2006.
USENIX Association
29th USENIX Security Symposium    2755
[47] Nicolas Van Saberhagen. Cryptonote v2.0, 2013.
[48] Serge Vaudenay.
Security ﬂaws induced by CBC
padding—applications to SSL, IPSEC, WTLS... In In-
ternational Conference on the Theory and Applications
of Cryptographic Techniques, pages 534–545. Springer,
2002.
A Side-Channel Attacks on the Monero CLI
Wallet
The command-line interface (CLI) for the Monero wallet has
a slightly different behavior than the RPC and GUI versions
analyzed in Section 5. As a result, the side-channel attacks
that apply to the CLI wallet are also different.
The CLI wallet makes use of a Monero privacy feature
known as a tracking key. Note that in the description of
blockchain scanning in Section 5.1, a user only needs “half”
of her secret key (the scalar a) to check whether she is the
recipient of a transaction. To compute the secret value x re-
quired to later spend the received funds further involves the
use of the second half of the key, the scalar b. The CLI wallet
only keeps the “tracking key” a in memory, to determine when
the user has received transactions. At that point, it prompts
the user for a password to decrypt the “spending key” b. This
behavior differs from the RPC and GUI wallets that hold both
keys in memory (or in a hardware wallet).
The attacks described in Section 5 do not directly apply to
the CLI wallet. The CLI wallet only refreshes its copy of the
memory pool of unconﬁrmed transactions on an explicit user
prompt, so the attacks from Section 5 that target unconﬁrmed
transactions do not apply. Instead, the wallet is vulnerable to
a much more pernicious timing attack on block processing,
in a setting where the wallet connects to a remote node.
Indeed, recall that the CLI wallet requires a user password
in order to obtain the user’s spending key. When processing
new blocks, if the wallet detects that it is the payee of a trans-
action (using the tracking key), it displays a password prompt
to the user and interrupts any further refreshes until the user
responds. This is trivially observable by a remote node or by
a network adversary as this interrupts the ﬂow of requests for
new blocks, potentially for several seconds, minutes or hours
depending on the user’s activity.
This attack vector has only been partially ﬁxed. As of re-
lease v0.15.0, the CLI wallet refreshes at randomized intervals,
to obfuscate delays between refreshes caused by an unan-
swered password prompt. Yet, as noted in Section 5.4, such
a randomized defense approach is likely insufﬁcient against
a determined adversary that aims to identify the owner of a
speciﬁc public key. Such an attacker can send multiple trans-
actions to this key, and obtain multiple timing measurements
that would average out the variability caused by the random-
ized delays between refreshes.
2756    29th USENIX Security Symposium
USENIX Association