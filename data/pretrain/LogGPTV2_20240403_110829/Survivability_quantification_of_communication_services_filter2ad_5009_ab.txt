### Composite CTMC State and Reward Rates

The composite Continuous-Time Markov Chain (CTMC) state \((y, \#x)\) represents the phase \(y\) and the vector \(\#x = (x_1, x_2, \ldots, x_n)\), where \(x_i\) is the number of packets in node \(i\). The reward rates for node \(i\) are defined as follows:

1. **Loss Rate Computation:**
   \[
   f_{L_i}(t, y, x_i) = 
   \begin{cases} 
   \Gamma_i(y) & \text{if } x_i = n_i \text{ at time } t \\
   0 & \text{otherwise}
   \end{cases}
   \]
   Here, \(n_i\) is the maximum number of packets, and \(\Gamma_i(y)\) is the arrival rate to node \(i\) in phase \(y\).

2. **Mean Number of Packets:**
   \[
   f_{N_i}(t, y, x_i) = x_i
   \]

### Performance Metrics

The transient probabilities \(p(t, y, \#x)\) are obtained from the composite CTMC model. The performance metrics are then computed as follows:

- **Expected Total Loss Rate at Time \(t\):**
  \[
  E[L(t)] = \sum_{y=1}^{Y} \sum_{i=1}^{n} \sum_{x_i=0}^{n_i} f_{L_i}(t, y, x_i) p(t, y, \#x)
  \]

- **Expected Total Loss Probability at Time \(t\):**
  \[
  E[l(t)] = \frac{E[L(t)]}{\gamma}
  \]
  where \(\gamma\) is the external arrival rate.

- **Expected Total Number of Packets at Time \(t\):**
  \[
  E[N(t)] = \sum_{y=1}^{Y} \sum_{i=1}^{n} \sum_{x_i=0}^{n_i} f_{N_i}(t, y, x_i) p(t, y, \#x)
  \]

- **Expected Total Delay of Non-Lost Packets at Time \(t\):**
  \[
  E[D(t)] = \frac{E[N(t)]}{\gamma (1 - E[l(t)])}
  \]

### Modeling Approaches for Exact Network Survivability

This section presents two modeling approaches to determine the exact transient probabilities \(p(t, y, \#x)\) and the above four performance metrics. Both the simulation and Stochastic Reward Net (SRN) models assume exponentially distributed inter-event times and time-independent but phase-dependent routing probabilities. This allows for cross-validation and comparison of their solution efficiency. The SRN model simplifies the complex task of CTMC construction.

#### 3.1 Stochastic Reward Net (SRN) Model

**Figure 3(a)** shows the SRN model of a 4-node network used as a case study. Packets are generated by the timed transition "arrival" into the place "InQ1". If there are fewer than \(n_1\) tokens in place "Node1", the immediate transition "Q1" is enabled; otherwise, the "loss1" transition is enabled, removing the token and counting a packet loss. The same structure is replicated for each node. Routing is determined by probabilities on the immediate transitions out "OutQ1". Rerouting, failure, and repair are modeled using inhibitor arcs.

Performance metrics in the SRN model are obtained by assigning reward rates that depend on the markings in different places. To numerically obtain the transient probabilities \(p(t, y, \#x)\) from the SRN model, a complete multidimensional CTMC model is generated and solved. This is computationally demanding and increases exponentially with the number of buffers and nodes. Decomposition of the SRN model, as proposed in [8], utilizes near-independence between nodes to address this issue.

#### 3.2 Simulation Model

**Figure 3(b)** shows the process-oriented discrete event simulation model. The source process generates packets at the ingress router. Each node process describes the packet life cycle, which may be interrupted by a failure process. In each node, if the "InBuffer" contains at least one packet, the node checks if the number of tokens exceeds the maximum buffer size and if the node is currently working. The packet is then served and sent to the next node by random selection among available buffers. If no buffers are available due to failure, the packet is counted as lost.

Failure is modeled such that at the instant of a failure (phase I), the "working" attribute of the "Node j" process is set to "false". After the rerouting time (phase II), all routing probabilities into the failed node are set to 0. After repair and rerouting (phase III), the routing probabilities are restored, and the "working" attribute is set to "true" again (phase IV).

Performance metrics in the simulator are obtained by a measurement process that reads counters at regular time intervals \(\Delta t\). The average at time \(t\) over \(R\) transient simulation replications is estimated by:
\[
\bar{C}_t = \frac{1}{R} \sum_{r=1}^{R} \sum_{i=1}^{n} \frac{c_{r,i,t} - c_{r,i,t-\Delta t}}{\Delta t}
\]
where \(c_{r,i,t}\) is the value of the counter in node \(i\) at time \(t\) in simulation replication \(r\). The average packet loss rate \(\bar{L}_t\) and number of packets \(\bar{N}_t\) are obtained similarly. The packet loss probability is estimated by \(\bar{l}_t = \bar{L}_t / \gamma\) and the average delay of served packets by \(\bar{D}_t = \bar{N}_t / \gamma (1 - \bar{l}_t)\).

### Space Decomposed Model

Obtaining the transient probabilities \(p(t, y, \#x)\) is challenging due to the large state space. We decompose the problem and approximate the global probabilities by the product:
\[
p(t, y, \#x) = p_1(t, y, x_1) \cdot p_2(t, y, x_2) \cdots p_n(t, y, x_n)
\]
where \(p_i(t, y, x_i)\) is the transient probability of \(x_i\) packets in node \(i\) at time \(t\) in phase \(y\). This approach is similar to the product-form solution of Jackson [16] or BCMP networks [2].

#### 4.1 Network Performance Model

The network is represented as a graph \(\mathcal{G} = (v, e)\), where \(v\) is the set of nodes and \(e\) is the set of links. Single- or multi-path routing of a virtual connection between source node \(s\) and destination \(d\) reduces \(\mathcal{G}\) to a directed graph \(\mathcal{G}[s,d]\). The network model is Markovian with Poisson external arrivals and exponential service time distribution with an FCFS service discipline at each node. The routing between node \(i\) and \(j\) is stochastic with time-independent probability \(q_{ij}\). Each packet occupies one buffer position, and the state \(x_i\) in the CTMC is the number of packets in node \(i\). The node capacity \(n_i\) is the number of buffer positions.

With finite \(n_i\), the arrival rate \(\Gamma_i\) is obtained by solving the linear system of traffic equations:
\[
\Gamma_i = \gamma_i + \sum_{j \neq i} q_{ji} \Gamma_j (1 - \pi_j(n_j))
\]
where \(\pi_j(n_j)\) is the steady-state probability that node \(j\) will reject an incoming packet. For infinite \(n_j\), \(\pi_j(n_j) = 0\) for all \(j\), and the model is an open BCMP-type queuing network [2]. A single path virtual connection is modeled as a special case where each hop has a single link \(j\) with \(q_{ij} = 1\) and 0 for all other links. The total external traffic \(\gamma_i\) to node \(i\) is \(\gamma_i = 0\) for all \(i \neq s\) and \(\gamma_s = \gamma\).

#### 4.2 Survivability Model

We model the transient behavior in each node separately. The node dynamics depend on whether a link connected to this node, or the node itself, has failed. For example, consider the four-node case in **Figure 4** where node \(j = 2\) has failed. The following two CTMC models describe the failed node and the non-failed nodes:

1. **CTMC Model for the Failed Node (Figure 5):**
   Immediately after the undesired event, all packets sent to node \(j\) are lost, leading to state \((I, n_j)\) where all resources are unavailable and no packets will be served.

2. **CTMC Model for the Non-Failed Nodes (Figure 6):**
   Immediately after the undesired event, the network state changes from \((IV, x_i)\) to \((I, x_i)\). This means no packets are lost, but the arrival rates \(\Gamma_i(IV)\) change to \(\Gamma_i(I)\).

This decomposition approach simplifies the analysis and provides a good approximation for both steady-state and transient behavior.