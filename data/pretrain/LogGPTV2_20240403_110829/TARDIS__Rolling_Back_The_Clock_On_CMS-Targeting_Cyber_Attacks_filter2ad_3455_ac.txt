### 优化后的文本

#### 一、攻击检测与代码生成能力
TARDIS 使用以下条件来识别潜在的高风险代码片段：
\[ \text{Sev}(elj(\psi_{i-1})) = \text{High} \] 
并且满足以下任一条件：
\[ \text{Sev}(elj(\psi_i)) = \text{None} \]
或
\[ \text{Sev}(elj(\psi_i)) = \text{Low} \]
或
\[ elj(\psi_i) \notin V_i \]

在每个时间快照 \(\psi_i\) 中，TARDIS 会为检测到的不安全或可疑代码添加一个压缩后的代码指标 \(EvDc(elj(\psi_i))\) 到空间指标集 \(M_i\) 中，以避免被常规检测器发现。

**代码生成能力：**
我们观察到，几乎每一个参与多阶段 CMS 攻击的服务器端空间元素都包含 `create_function` 代码生成。尽管一些开发者会在某些 CMS 插件中使用这一功能，但在普通的服务器端代码开发中很少见。TARDIS 会寻找这种代码生成能力，并在找到符合条件的元素 \(elj \in V_i\) 时，将代码指标 \(CodeGen(elj(\psi_i))\) 添加到空间指标集 \(M_i\) 中。

#### 二、时间关联与取证恢复
基于收集的空间指标，TARDIS 尝试跨时间快照进行时间关联，以识别网站内随时间演变的可疑活动。TARDIS 被编程为在一个滑动的时间窗口（例如 20 天）内跟踪这些空间指标的发展。在此阶段，TARDIS 会将当前时间快照 \(\psi_i\) 的空间指标集 \(M_i\) 与滑动窗口内的所有先前时间快照的空间指标 \(M_x\) 进行时间关联。这与我们之前对表 I 中差分文件类型指标的视觉检查结果一致。

这些攻击模型是可扩展的，无论底层 CMS 如何，当发现新的战术时，TARDIS 框架设计为高度模块化，可以轻松更新以捕捉新战术和相关攻击标签的本质。通过将攻击建模规则应用于空间指标并逐步滑动每个时间快照，TARDIS 可以在入侵窗口内分配适当的标签 \(L\)，从而提供多阶段攻击调查的时间线。

#### 三、验证我们的直觉
我们的研究始于一个关键见解，即针对 CMS 的网络攻击表现出“低且慢”的特征，这是多阶段攻击的典型特征。基于此，我们设计了 TARDIS 以恢复入侵窗口并重建攻击时间线。我们通过一组已知真实情况的网站进行了多次微基准测试，以验证这一直觉。

**数据集与真实情况：**
初步研究中，我们查看了 70 个最近被入侵的 CMS 网站的夜间备份。我们手动调查了这些网站并标记了观察到的攻击模型。我们将再次使用这 70 个网站作为真实情况。此外，我们还添加了从合作伙伴数据中随机选择的 93 个额外 CMS 网站的完整历史夜间备份。同样，我们对这 93 个新网站进行了手动调查以获得真实情况。这总共产生了 163 个网站，每个网站代表从 2018 年 4 月到 2019 年 5 月期间每晚收集的备份。

为了验证 TARDIS 的性能，我们手动调查了这 163 个网站以获取真实情况。我们首先在本地安装了一个干净的 CMS 版本，并移除了每个快照中未修改的文件。然后，我们搜索所有代码文件中的恶意负载，并与 CodeGuard 工程师确认了我们的发现。如果我们在调查中发现了攻击，我们会标记第一次出现攻击的快照。如果攻击通过回滚被清理，我们会标记相应的快照。接着，我们在整个入侵窗口内标注了预期的攻击标签。在 163 个网站中，有 80 个被发现受到入侵。请注意，这个样本是有偏的（因为其中许多是已知受入侵的），但它仍然提供了多种良性与恶意案例的测试套件。

我们使用 WhatCMS 和 CMS Garden 识别了每个网站使用的 CMS 平台。表 IV 显示了该数据集中 CMS 市场份额的分布。该分布大致类似于现实世界中基于 CMS 的网站的分布，例如，大多数网站是基于 WordPress 构建的，Drupal 和 Joomla 分别排名第二和第三。

#### 四、攻击模型的识别
我们进一步深入研究了被标记为受入侵的网站。为了验证 TARDIS 的攻击时间线重建能力，我们首先将每个网站的备份序列通过 TARDIS 运行，并记录每个夜间快照分配的攻击标签。需要注意的是，TARDIS 不需要访问我们的真实情况来进行网站备份调查，它仅依赖于空间指标的时间关联和攻击模型来进行时间线提取。

表 IV 显示了 163 个网站的妥协分布。
表 V 展示了 163 个网站的微基准测试结果。第一列列出了 CMS 平台。对于每个 CMS 平台，后续的成对列显示了 TARDIS 标记为包含每个攻击标签的网站数量（表示为 #）以及其中假阳性的情况数量（表示为 #FP）。例如，表 V 的第 3 行显示 TARDIS 在 8 个基于 Joomla 的网站中标记了混淆代码注入，其中有 1 个是假阳性。

从表 V 中，我们可以得出几个观察结果：单独来看，TARDIS 的攻击模型在检测受入侵网站中的攻击标签时具有很高的准确性。