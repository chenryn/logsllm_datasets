two special cases of interest below, namely ğ´ âŠ— ğ¼ğ‘˜ and ğ¼ğ‘˜ âŠ— ğ´:
[ï¸‚ğ‘1 ğ‘2
]ï¸‚
ğ‘3 ğ‘4
âŠ—ğ¼3 =
â¡â¢â¢â¢â¢â¢â¢â£
ğ‘1
ğ‘3
â¤â¥â¥â¥â¥â¥â¥â¦ ,
ğ‘2
ğ‘4
ğ‘2
ğ‘4
ğ‘2
ğ‘4
ğ‘1
ğ‘3
ğ‘1
ğ‘3
[ï¸‚ğ‘1 ğ‘2
ğ‘3 ğ‘4
ğ¼3âŠ—
]ï¸‚
=
ğ‘1 ğ‘2
ğ‘3 ğ‘4
â¡â¢â¢â¢â¢â¢â¢â£
â¤â¥â¥â¥â¥â¥â¥â¦
ğ‘1 ğ‘2
ğ‘3 ğ‘4
ğ‘1 ğ‘2
ğ‘3 ğ‘4
Tensoring with identity (on either side) corresponds to applying ğ´ to certain â€œslicesâ€ of
the input vector, giving a simple and efï¬cient parallel algorithm for multiplying by a tensor
with the identity matrix.
A useful fact about the Kronecker product which we use frequently is called the mixed-
product property: (ğ´ âŠ— ğµ) Â· (ğ¶ âŠ— ğ·) = ğ´ğ¶ âŠ— ğµğ· (when we can form the matrix products
ğ´ğ¶ and ğµğ·).
2.1.1
Integers
Eulerâ€™s Totient Function We frequently need Eulerâ€™s totient function ğœ™(ğ‘›), which counts
the number of integers that are both less than ğ‘› and coprime with ğ‘›. ğœ™(1) = 1, and for a
prime power ğ‘ğ‘’ with ğ‘’ â‰¥ 1, ğœ™(ğ‘ğ‘’) = (ğ‘ âˆ’ 1)ğ‘ğ‘’âˆ’1. For an arbitrary positive integer ğ‘š with
ğ‘– ), i.e., the totient function is
prime-power factorization ğ‘š = ğ‘ğ‘’1
ğ‘˜ , ğœ™(ğ‘š) =âˆï¸€ğ‘˜
1 . . . ğ‘ğ‘’ğ‘˜
ğ‘–=1 ğœ™(ğ‘ğ‘’ğ‘–
multiplicative.
Modular Arithmetic. As usual, Z denotes the ring of integers, and the quotient ring
âˆ¼= Z/(ğ‘Z) is the ring of integers modulo ğ‘, i.e., the cosets ğ‘¥ + ğ‘Z with the usual addition
Zğ‘
and multiplication operations.
Rounding. For integers ğ‘ â‰¥ ğ‘ â‰¥ 2, we deï¬ne the rounding function âŒŠÂ·âŒ‰ : Zğ‘ â†’ Zğ‘
by âŒŠğ‘¥âŒ‰ğ‘ = âŒŠ(ğ‘/ğ‘) Â· Â¯ğ‘¥âŒ‹, where Â¯ğ‘¥ âˆˆ Z â‰¡ ğ‘¥ mod ğ‘. We extend this function to vectors
component-wise.
13
Chinese Remainder Theorem. The Chinese remainder theorem (CRT) gives an isomor-
phism between Zğ‘1Â·ğ‘2 and the ring product Zğ‘1 Ã— Zğ‘2 when ğ‘1 and ğ‘2 are coprime. In fact,
the CRT holds in a more general setting, which we will also need (see below).
2.1.2 Lattices
In cyclotomic ring-based lattice cryptography, we use the space ğ» âŠ† Cğ‘› for some even
integer ğ‘›, deï¬ned as
ğ» := {x = (ğ‘¥1, . . . , ğ‘¥ğ‘›) âˆˆ Cğ‘› : ğ‘¥ğ‘– = ğ‘¥ğ‘–+ğ‘›/2, ğ‘– âˆˆ {1, . . . , ğ‘›/2}}.
It is easy to check that ğ», with the inner product âŸ¨x, yâŸ© =âˆ‘ï¸€
ğ‘– ğ‘¥ğ‘–ğ‘¦ğ‘– of the ambient space Cğ‘›,
is an ğ‘›-dimensional real inner product space, i.e., it is isomorphic to Rğ‘› via an appropriate
rotation. Therefore, the reader may mentally replace ğ» with Rğ‘› in all that follows. We let
â„¬ = {x âˆˆ ğ» : â€–xâ€– â‰¤ 1} denote the closed unit ball in ğ» (in the Euclidean norm).
For the purposes of this work, a lattice â„’ is discrete additive subgroup of ğ» that is full
rank, i.e., spanR(â„’) = ğ». A lattice is generated as the set of integer linear combinations of
some linearly independent basis vectors B = {b1, . . . , bğ‘›}:
{ï¸âˆ‘ï¸
ğ‘§ğ‘–bğ‘– : ğ‘§ğ‘– âˆˆ Z}ï¸
.
â„’ = â„’(B) :=
ğ‘–
The volume (or determinant) of a lattice â„’ is vol(â„’) := vol(ğ»/â„’) = |det(B)|, where B
denotes any basis of â„’. The minimum distance of â„’ is ğœ†1(â„’) := min0Ì¸=vâˆˆâ„’â€–vâ€–, the length
of a shortest nonzero lattice vector. The dual lattice â„’âˆ¨ of a lattice â„’ is the set of all points
in ğ» having integer inner products with every vector of the lattice: â„’âˆ¨ := {w âˆˆ ğ» :
âŸ¨w,â„’âŸ© âŠ† Z}.
14
2.1.3 Gaussians.
The Gaussian function ğœŒ : ğ» â†’ R+ is deï¬ned as ğœŒ(x) := exp(âˆ’ğœ‹â€–xâ€–2), and is scaled to
have parameter (or width) ğ‘Ÿ > 0 by deï¬ning ğœŒğ‘Ÿ(x) := ğœŒ(x/ğ‘Ÿ). The (spherical) Gaussian
probability distribution ğ·ğ‘Ÿ over ğ» is deï¬ned to have probability density function ğ‘Ÿâˆ’ğ‘› Â· ğœŒğ‘Ÿ.
(We usually omit the subscript when ğ‘Ÿ = 1.)
The following bounds use the function
âˆš
ğ‘“ (ğ‘¥) =
2ğœ‹ğ‘’ Â· ğ‘¥ Â· exp(âˆ’ğœ‹ğ‘¥2),
(2.1.1)
âˆš
which is strictly decreasing and at most 1 for ğ‘¥ â‰¥ 1/
2ğœ‹.
âˆš
Lemma 2.1.1 ([Ban93, Lemma 1.5]). For any ğ‘ > 1/
2ğœ‹ deï¬ning ğ¶ = ğ‘“ (ğ‘)  0, then
2 ln(2ğœ‹ğ‘’) for some ğ‘ > 1/
ğ‘› ln( 1
ğœ€ ) + 1
The following is an immediate corollary of Lemma 2.1.1 and [MR07, Lemma 4.1].
Lemma 2.1.3. For any lattice â„’ âŠ‚ ğ» and ğ‘Ÿ >âˆšï¸€ğ‘›/2ğœ‹/ğœ†1(â„’âˆ¨) deï¬ning ğ¶ = ğ‘“ (ğ‘Ÿğœ†1(â„’âˆ¨)/
âˆš
ğ‘›) <
1, the statistical distance between ğ·ğ‘Ÿ mod â„’ and the uniform distribution over ğ»/â„’ is less
than 1
2ğ¶ ğ‘›/(1 âˆ’ ğ¶ ğ‘›).
15
2.2 Cyclotomic Rings
2.2.1
Introduction
of all ï¬nite-degree formal sumsâˆ‘ï¸€ğ‘›
Polynomial Rings. For a ring ğ‘… and indeterminate ğ‘‹, a polynomial ring ğ‘…[ğ‘‹] is the set
ğ‘–=0 ğ‘ğ‘– Â· ğ‘‹ ğ‘–, where each ğ‘ğ‘– âˆˆ ğ‘… and ğ‘‹ is an indeterminate.
For example, 3ğ‘‹ 2 âˆ’ 5ğ‘‹ + 1 âˆˆ Z[ğ‘‹]. As with the integers, we can take quotients of the
form ğ‘…[ğ‘‹]/(ğ‘“ (ğ‘‹)) where ğ‘“ (ğ‘‹) âˆˆ ğ‘…[ğ‘‹] and (ğ‘“ (ğ‘‹)) = ğ‘“ (ğ‘‹) Â· ğ‘…[ğ‘‹] is the ideal generated
by ğ‘“ (ğ‘‹). Continuing our example, we set ğ‘“ (ğ‘‹) = ğ‘‹ 2 + 2 so that 3ğ‘‹ 2 âˆ’ 5ğ‘‹ + 1 =
3(ğ‘‹ 2 + 2) âˆ’ 5ğ‘‹ âˆ’ 5 âˆ¼= âˆ’5ğ‘¥ âˆ’ 5 âˆˆ Z[ğ‘‹]/(ğ‘‹ 2 + 2). In particular, if ğ‘“ (ğ‘‹) has degree ğ‘›,
the quotient is a polynomial of degree < ğ‘›.
Basic Cyclotomic Rings. For a positive integer ğ‘š, let ğ‘… = Z[ğœğ‘š] denote the ğ‘šth cyclo-
tomic ring, where ğœğ‘š is an abstract element of multiplicative order ğ‘š, i.e., ğœ ğ‘š
ğ‘š = 1 and
ğ‘š Ì¸= 1 for all positive ğ‘— < ğ‘š. For example, the ï¬rst cyclotomic ring is ğ’ª1 = Z. The
ğœ ğ‘—
parameter ğ‘š is known as the index or conductor of the cyclotomic ring. For a positive integer
ğ‘, we frequently use the quotient ring ğ‘…ğ‘ = ğ‘…/ğ‘ğ‘… = Zğ‘[ğœğ‘š], i.e., the ğ‘šth cyclotomic over
base ring Zğ‘. As with the integers, we can represent ğ‘…ğ‘1Â·ğ‘2 as a ring product ğ‘…ğ‘1 Ã— ğ‘…ğ‘2, with
component-wise operations, via the Chinese Remainder Theorem. (Note that we also use the
Chinese Remainder Theorem on the factorization of ğ‘ğ‘… into prime ideals below. These two
uses are independent, but we refer to their combined use as â€œdouble CRTâ€ representation.)
The ğ‘šth cyclotomic ring is the ring of algebraic integers of (and therefore contained
in) the ğ‘šth cyclotomic number ï¬eld ğ¾ = Q(ğœğ‘š), the ring extension of the rationals Q
obtained by adjoining an element ğœğ‘š. The minimal polynomial Î¦ğ‘š(ğ‘‹) (over the rationals)
of ğœğ‘š is called the ğ‘šth cyclotomic polynomial. This polynomial has degree ğ‘› = ğœ™(ğ‘š), so
deg(ğ¾/Q) = deg(ğ‘…/Z) = ğ‘›.
We may also view ğ¾ (respectively, ğ‘…, ğ‘…ğ‘) as a polynomial ring via the isomorphism
Q(ğœğ‘š) âˆ¼= Q[ğ‘‹]/(Î¦ğ‘š(ğ‘‹)) (resp. Z[ğœğ‘š] âˆ¼= Z[ğ‘‹]/(Î¦ğ‘š(ğ‘‹)), Zğ‘[ğœğ‘š] âˆ¼= Zğ‘[ğ‘‹]/(Î¦ğ‘š(ğ‘‹)), by
16
identifying ğœğ‘ with ğ‘‹. In particular, this means we write may cyclotomic ring elements as a
vector of coefï¬cients with respect to some ï¬xed basis, e.g., the standard polynomial basis
{1, ğ‘‹, ğ‘‹ 2, . . .}. That is, an element of ğ¾ (respectively, ğ‘…, ğ‘…ğ‘) can be uniquely represented
as a rational (resp., integral, ğ‘ğ‘) polynomial in ğ‘‹ of degree less than ğ‘›.
Cyclotomic Heierarchy. The ğ‘šth cyclotomic ring ğ‘… = Z[ğœğ‘š] can be seen as a subring
of the ğ‘šâ€²th cyclotomic ring ğ‘…â€² = Z[ğœğ‘šâ€²] if and only if ğ‘š|ğ‘šâ€², and in such a case we can
embed ğ‘… into ğ‘…â€² by identifying ğœğ‘š with ğœ ğ‘šâ€²/ğ‘š
. The dimension of the ring extension ğ‘…/ğ‘…â€²
is dim(ğ‘…/ğ‘…â€²) = ğœ™(ğ‘š)/ğœ™(ğ‘šâ€²).
ğ‘šâ€²
The trace function Trğ‘…â€²/ğ‘… : ğ‘…â€² â†’ ğ‘… is the ğ‘…-linear function deï¬ned as follows: ï¬xing
any ğ‘…-basis of ğ‘…â€², multiplication by an ğ‘¥ âˆˆ ğ‘…â€² can be represented as a matrix ğ‘€ğ‘¥ over ğ‘…
with respect to the basis, which acts on the multiplicandâ€™s vector of ğ‘…-coefï¬cients. Then
Trğ‘…â€²/ğ‘…(ğ‘¥) is simply the trace of ğ‘€ğ‘¥, i.e., the sum of its diagonal entries. (This is invariant
under the choice of basis.) Because ğ‘…â€²/ğ‘… is Galois, the trace can also be deï¬ned as the sum
of the automorphisms of ğ‘…â€² that ï¬x ğ‘… pointwise. All of this extends to the ï¬eld of fractions
of ğ‘…â€² (i.e., its ambient number ï¬eld) in the same way.
Notice that the trace does not ï¬x ğ‘… (except when ğ‘…â€² = ğ‘…), but rather Trğ‘…â€²/ğ‘…(ğ‘¥) =
deg(ğ‘…â€²/ğ‘…) Â· ğ‘¥ for all ğ‘¥ âˆˆ ğ‘…. For a tower ğ‘…â€²â€²/ğ‘…â€²/ğ‘… of ring extensions, the trace satisï¬es the
composition property
Trğ‘…â€²â€²/ğ‘… = Trğ‘…â€²/ğ‘… âˆ˜ Trğ‘…â€²â€²/ğ‘…â€² .
2.2.2 Tensor Product of Rings
Let ğ‘…, ğ‘† be arbitrary rings with common subring ğ¸ âŠ† ğ‘…, ğ‘†. The ring tensor product of ğ‘…
and ğ‘† over ğ¸, denoted ğ‘… âŠ—ğ¸ ğ‘†, is the set of ğ¸-linear combinations of pure tensors ğ‘Ÿ âŠ— ğ‘ 
17
for ğ‘Ÿ âˆˆ ğ‘…, ğ‘  âˆˆ ğ‘†, with ring operations deï¬ned by ğ¸-bilinearity, i.e.,
(ğ‘Ÿ1 âŠ— ğ‘ ) + (ğ‘Ÿ2 âŠ— ğ‘ ) = (ğ‘Ÿ1 + ğ‘Ÿ2) âŠ— ğ‘ 
(ğ‘Ÿ âŠ— ğ‘ 1) + (ğ‘Ÿ âŠ— ğ‘ 2) = ğ‘Ÿ âŠ— (ğ‘ 1 + ğ‘ 2)
ğ‘’(ğ‘Ÿ âŠ— ğ‘ ) = (ğ‘’ğ‘Ÿ) âŠ— ğ‘  = ğ‘Ÿ âŠ— (ğ‘’ğ‘ )
for any ğ‘’ âˆˆ ğ¸, and the mixed-product property
(ğ‘Ÿ1 âŠ— ğ‘ 1) Â· (ğ‘Ÿ2 âŠ— ğ‘ 2) = (ğ‘Ÿ1ğ‘Ÿ2) âŠ— (ğ‘ 1ğ‘ 2).
We need the following facts about tensor products of cyclotomic rings. Let ğ‘… = ğ’ªğ‘š1
and ğ‘† = ğ’ªğ‘š2. Their largest common subring and smallest common extension ring (called
the compositum) are, respectively,
ğ¸ = ğ’ªğ‘š1 âˆ© ğ’ªğ‘š2 = ğ’ªgcd(ğ‘š1,ğ‘š2)
ğ‘‡ = ğ’ªğ‘š1 + ğ’ªğ‘š2 = ğ’ªlcm(ğ‘š1,ğ‘š2).
Moreover, the ring tensor product ğ‘…âŠ—ğ¸ ğ‘† is isomorphic to ğ‘‡ , via the ğ¸-linear map deï¬ned by
âˆ¼= ğ’ªğ‘š1ğ‘š2.
sending ğ‘ŸâŠ—ğ‘  to ğ‘ŸÂ·ğ‘  âˆˆ ğ‘‡ . In particular, for coprime ğ‘š1, ğ‘š2, we have ğ’ªğ‘š1âŠ—Zğ’ªğ‘š2
2.2.3 Powerful Basis
Prime cyclotomics. For a prime ğ‘, the ğ‘th cyclotomic ring is ğ’ªğ‘ = Z[ğœğ‘], where ğœğ‘ denotes
a primitive ğ‘th root of unity, i.e., ğœğ‘ has multiplicative order ğ‘. The minimal polynomial
over Z of ğœğ‘ is Î¦ğ‘(ğ‘‹) = 1 + ğ‘‹ + ğ‘‹ 2 + Â·Â·Â· + ğ‘‹ ğ‘âˆ’1, so ğ’ªğ‘ has degree ğœ™(ğ‘) = ğ‘ âˆ’ 1 over Z,
âˆ¼= Z[ğ‘‹]/(Î¦ğ‘(ğ‘‹)) by identifying ğœğ‘ with ğ‘‹. The
and we have the ring isomorphism ğ’ªğ‘
18
power basis âƒ—ğ‘ğ‘ of ğ’ªğ‘ is the Z-basis consisting of the ï¬rst ğ‘ âˆ’ 1 powers of ğœğ‘, i.e.,
âƒ—ğ‘ğ‘ := (1, ğœğ‘, ğœ 2
ğ‘ , . . . , ğœ ğ‘âˆ’2
ğ‘
).
For example, the 5th cyclotomic polynomial is 1 + ğ‘‹ + ğ‘‹ 2 + ğ‘‹ 3, and the 5th cyclotomic
ring is isomorphic to Z[ğ‘‹]/(1 + ğ‘‹ + ğ‘‹ 2 + ğ‘‹ 3). The power basis for ğ’ª5 is (1, ğœ5, ğœ 2
5 ).
5 , ğœ 3
Prime-power cyclotomics. Now let ğ‘š = ğ‘ğ‘’ for ğ‘’ â‰¥ 2 be a power of a prime ğ‘. Then we
can inductively deï¬ne ğ’ªğ‘š = ğ’ªğ‘š/ğ‘[ğœğ‘š], where ğœğ‘š denotes a primitive ğ‘th root of ğœğ‘š/ğ‘. Its
minimal polynomial over ğ’ªğ‘š/ğ‘ is ğ‘‹ ğ‘ âˆ’ ğœğ‘š/ğ‘, so ğ’ªğ‘š has degree ğ‘ over ğ’ªğ‘š/ğ‘, and hence
has degree ğœ™(ğ‘š) = (ğ‘ âˆ’ 1)ğ‘ğ‘’âˆ’1 over Z.
The above naturally yields the relative power basis of the extension ğ’ªğ‘š/ğ’ªğ‘š/ğ‘, which is
the ğ’ªğ‘š/ğ‘-basis
âƒ—ğ‘ğ‘š,ğ‘š/ğ‘ := (1, ğœğ‘š, . . . , ğœ ğ‘âˆ’1
ğ‘š ).
More generally, for any powers ğ‘š, ğ‘šâ€² of ğ‘ where ğ‘š|ğ‘šâ€², we deï¬ne the relative power basis
âƒ—ğ‘ğ‘šâ€²,ğ‘š of ğ’ªğ‘šâ€²/ğ’ªğ‘š to be the ğ’ªğ‘š-basis obtained as the Kronecker product of the relative
power bases for each level of the tower:
âƒ—ğ‘ğ‘šâ€²,ğ‘š := âƒ—ğ‘ğ‘šâ€²,ğ‘šâ€²/ğ‘ âŠ— âƒ—ğ‘ğ‘šâ€²/ğ‘,ğ‘šâ€²/ğ‘2 âŠ— Â·Â·Â· âŠ— âƒ—ğ‘ğ‘šğ‘,ğ‘š.
(2.2.1)
ğ‘šâ€²
for ğ‘ğ‘– â‰¤ ğ‘šâ€², the relative power basis âƒ—ğ‘ğ‘šâ€²,ğ‘š consists of
Notice that because ğœğ‘ğ‘– = ğœ ğ‘šâ€²/ğ‘ğ‘–
all the powers 0, . . . , ğœ™(ğ‘šâ€²)/ğœ™(ğ‘š) âˆ’ 1 of ğœğ‘šâ€², but in â€œbase-ğ‘ digit-reversedâ€ order (which
turns out to be more convenient for implementation). Finally, we also deï¬ne âƒ—ğ‘ğ‘š := âƒ—ğ‘ğ‘š,1
and simply call it the powerful basis of ğ’ªğ‘š.
Of special interest are the two-power cyclotomic rings, which have especially simple
representations and are widely used in practical instantiations of lattice cryptography. When
ğ‘š = 2ğ‘˜ â‰¥ 2 is a power of two, the ğ‘šth cyclotomic polynomial is Î¦ğ‘š(ğ‘‹) = ğ‘‹ ğ‘› + 1,
where ğ‘› = ğœ™(ğ‘š) = 2ğ‘˜âˆ’1. Thus the 8th cyclotomic ï¬eld is ğ¾ = Q[ğ‘‹]/(ğ‘‹ 4 + 1) and the
19
corresponding ring is ğ‘… = Z[ğ‘‹]/(ğ‘‹ 4 + 1). For this special case, the power basis is identical
to the powerful basis âƒ—ğ‘ and the â€œtweakedâ€ decoding basis ğ‘¡ Â· âƒ—ğ‘‘ of ğ‘… as deï¬ned below.
Arbitrary cyclotomics. Now let ğ‘š be any positive integer, and let ğ‘š =âˆï¸€ğ‘¡
â„“=1 ğ‘šâ„“ be its
factorization into maximal prime-power divisors ğ‘šâ„“ (in some canonical order). Then we
can deï¬ne
ğ’ªğ‘š := Z[ğœğ‘š1, ğœğ‘š2, . . . , ğœğ‘šğ‘¡].1
It is known that the rings Z[ğœâ„“] are linearly disjoint over Z, i.e., for any Z-bases of the
individual rings, their Kronecker product is a Z-basis of ğ’ªğ‘š. In particular, the powerful
basis of ğ’ªğ‘š is deï¬ned as the Kronecker product of the component powerful bases: