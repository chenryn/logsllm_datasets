Administration [15]. We ran a single query in the form
of “no prescription [drug name]” and collected the ﬁrst
64 results for each drug in the list. We executed the 9 000
queries over ﬁve days in August 2010. About 2 500 of
the queries returned no search results. Of the queries that
returned results, we observed redirection in at least one
of the search results for 4 350 terms.
For the second list, we inspected summaries of server
logs for 169 infected websites to identify drug-related
search terms that redirected to pharmacies. We obtained
this information from infected web servers running The
Webalizer,7 which creates monthly reports, based on
HTTP logs, of how many visitors a website receives, the
most popular pages on the website, and so forth. It is not
uncommon to leave these reports “world-readable” in a
standard location on the server, which means that anyone
can inspect their contents.
In August 2010, we checked 3 806 infected websites
for Webalizer, ﬁnding it accessible on 169 websites.
We recorded all available data – which usually included
monthly reports of activity up to and including the cur-
rent month. One of the individual sub-reports that We-
balizer creates is a list of search terms that have been
used to locate the site. Not all Webalizer reports list
referrer terms, but we found 83 websites that did in-
clude drug names in the referrer terms for one or more
months of the log reports. Since we identiﬁed the in-
fected servers running Webalizer by inspecting results of
the 218 queries from our main corpus, it is unsurpris-
ing that 98 of these terms appeared in the logs. However,
the logs also contained an additional 1 179 search queries
with drug terms. We use these additional search terms as
an extra queries list to compare against the main corpus.
We collected the top 64 results for the extra queries list
daily between October 20 and 31, 2010. When compar-
ing these results to our main query corpus, we examine
only the results obtained during this time period, result-
ing in a signiﬁcantly smaller number of results than for
our complete nine-month collection.
We compare our main list to the additional lists in
three ways. First, we compare the classiﬁcation of search
results for differences in the types of results obtained.
Second, we compare the distribution of TLD and PageR-
ank for source infections obtained for both samples.
Third, we compute the intersection between the domains
obtained by both sets of queries for source infections,
redirects and pharmacies.
7http://www.mrunix.net/webalizer/
FDA drug list
Drug list
Extra query list
Main list
Extra list
Main list
dom. URIs
dom. URIs
dom. URIs
dom.
43.7
2.8
0.03
8.2
18.6
26.7
URIs
Search result classiﬁcation
Source infections
24.7
4.0
Health resources
12.7
7.4
Legit. pharm.
0.5
0.1
Illicit pharm.
6.7
6.9
Blog/forum spam 25.4
23.7
Uncategorized
30.1
57.9
Source infection TLD breakdown
.com
60.0
.org
13.8
.edu
5.6
.net
6.1
other
14.3
Source infection PageRank breakdown
PR 0 ≤ 3
PR 3 ≤ 6
PR ≥ 7
47.2
41.4
11.4
22.4
3.5
0.07
13.6
17.8
42.7
35.6
4.9
0.1
6.1
26.3
27.2
56.9
17.0
8.9
5.6
11.5
35.0
51.3
13.7
14.0
4.2
0.1
11.6
22.7
46.9
56.3
15.4
6.2
5.6
16.5
47.5
44.2
8.3
49.3
2.4
0.02
6.5
17.8
24.0
27.9
3.0
0.05
12.0
17.7
39.4
54.6
18.0
9.3
4.6
13.5
41.9
46.3
11.8
Table 4: Comparing different lists of search terms to the
main list used in the paper. All numbers are percentages.
Table 4 compares the FDA drugs and extra queries lists
to the main list. The breakdown of search results for both
samples is slightly different from what we obtained us-
ing the main queries. For instance, only 25% of the URIs
in the FDA results are infections, compared to 44% for
the main list during the same time period. 13% of the
results in the FDA drug list point to legitimate health re-
sources, compared to only 3% of the main sample. This
is not surprising, given that the drug list often included
many drugs that are not popular choices for sales by on-
line pharmacies. Illicit pharmacies appear slightly less
often in the drugs sample (6% vs. 8%), while blog and
forum spam is more prevalent (25% to 19%).
The extra queries list follows the FDA list in some
ways, e.g., more blog infections and fewer source infec-
tions than results from the corresponding main list. On
the other hand, the URI breakdown in health resources
is much closer (4.9% vs. 2.4%).
In all samples, the
number of results that point to legitimate pharmacies is
very small, though admittedly biggest in the drugs sam-
ple (0.5% vs. 0.1% for the extra queries).
We next take a closer look at the characteristics of the
source infections themselves. The TLD breakdown is
roughly similar, with a few exceptions. .com is found
slightly more often in the FDA drugs and extra queries
results, while .org and .edu appear a bit more often
in the results for the main sample. The drugs and extra
queries list tend to have slightly lower PageRank than the
results from the main sample, but the difference is slight.
B Estimating the number of sites involved
We also wish to compare the number of attack domains
that can be identiﬁed for different sets of queries. Fig-
ure 7 compares the overlap between each class of do-
mains for the different samples. The FDA drugs queries
identiﬁed 1 919 distinct source infections, compared to
16
source infections and redirects generated by comparing
the different samples are fairly close. Both predict that
the true number of redirects to be near 500, and the num-
ber of source infections to be around 5 000-6 000. The
estimates for the number of pharmacies is more diver-
gent, with one predicting a population size of 2 523 and
the other predicting 795.
FDA Drugs
Main
Extra Queries Main
Source
Infections
1 516
403
934
2 120
823
516
Capture-recapture: 6 367
Capture-recapture: 4 788
FDA Drugs
Main
Extra Queries Main
Redirects
185
55
58
271
69
27
Capture-recapture: 493
Capture-recapture: 473
FDA Drugs
Main
Extra Queries Main
Pharmacies
192
9
104
406
41
32
Capture-recapture: 2 523
Capture-recapture: 795
Figure 7: Comparing the source, redirect and pharmacy
domains observed for different query lists.
1 337 found in the main sample during the same time pe-
riod. 403 infected domains appeared in both lists.
It is unreasonable to expect any single query list to be
comprehensive and identify all attack websites. In both
of our test cases, we compared much larger query cor-
pora to a smaller list (6 500 and 1 179 versus 218). De-
spite this, in each case many domains were found exclu-
sively in the results of the smaller main sample. This is a
common outcome when trying to measure online attacks
such as phishing websites [28].
Given the difﬁculty in getting a truly comprehensive
query list, one alternative is to estimate the total number
of affected domains to get a better sense of an attack’s
impact. We apply capture-recapture analysis [21] based
on our incomplete samples to get an estimate of the mag-
nitude of the activity studied in this paper.
Capture-recapture analysis uses repeated sampling to
estimate populations. In its simplest form, a sample S1
is taken, then replaced into the population. A second
sample S2 is taken, and the population can be estimated
P =
|S1|×|S2|
|S1∩S2| .
For the capture-recapture model to be perfectly accu-
rate, a number of assumptions must apply. Notably, the
population must be homogeneous and closed (i.e., no
new entries). These assumptions do not entirely hold
for our analysis: some websites are more likely to ap-
pear in the search results than others, and websites can
be added and removed frequently. Nonetheless, we have
computed the capture-recapture estimate in order to get
a ﬁrst approximation of the greater population size. The
results are given in Figure 7. Notably, the estimates for
17