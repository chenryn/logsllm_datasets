### Table 3: DoubleX Findings on Chrome Extensions
- **HTML files are exposed** due to extensions allowing all files to be web-accessible.

### 5.2 Analyzing DoubleX Reports
Overall, out of our 154,484 extension set, DoubleX reported 278 extensions as suspicious, which sums up to 309 suspicious data flows. In this section, we report on the exploitability of these flows and present case studies. Subsequently, we discuss the evolution of vulnerable extensions between 2020 and 2021 and vulnerability disclosure.

#### 5.2.1 Suspicious Data Flows
Our main findings regarding suspicious and exploitable data flows are summarized in Table 3. For each sensitive API (with a subtotal per flaw category), we first indicate the number of data flow reports generated by DoubleX (#Reports). Subsequently, we present the results of our manual analysis, including:
- The number of reports with a data flow between an attacker and a sensitive API (#DF).
- The number of reports with a data flow between an attacker and a sensitive API but not back to the attacker (#1-way DF).
- The number of reports that an attacker could exploit based on our threat model (#Exploitable).

To assess the exploitability of the reported flows, two experts with over 5 years of JavaScript experience reviewed the reports and extensions. DoubleX produces fine-grained data flow reports containing precise information about extension components, line numbers, and corresponding computed values where a potentially dangerous data flow was detected. This allowed us to directly examine the code logic at specific line numbers to verify the actual behavior.

For trivially exploitable or clearly wrong cases, we flagged the reports accordingly. For more complex cases, such as multiple data flows or sanitization functions, we installed the extension and built a payload to test its exploitability locally.

- **Code Execution APIs**: 102 out of 113 reports contain an attacker-controllable flow to a sink, and 63 can be confirmed as vulnerable.
- **Download Triggering**: All 21 reports have a verified dangerous data flow and could be exploited to download arbitrary files.
- **Cross-Origin Requests**: 49 out of 95 flaws can be exploited, even though 75 have a confirmed dangerous data flow. In some cases, the attacker could only control part of the URL, while we aim to make arbitrary requests. Additionally, 11 reports allow any request but do not receive the response (e.g., only a status code).
- **Data Exfiltration**: Almost all dangerous data flows (76 out of 80) can be exploited.

Overall, out of 309 reports, 275 (89%) have a confirmed full data flow between a sensitive API and an attacker, with 209 being exploitable under our threat model. The remaining 66 reports with a verified, yet unexploitable, dangerous data flow were unexploitable for the following reasons:
- 24 cases had exploitation prevented by sanitization functions or additional checks.
- 20 reports (cross-origin requests) only allowed partial URL control.
- 12 cases involved predefined functions with attacker-controllable parameters.

We also observed 11 cross-origin requests with a data flow from an attacker to the sink but not back to the attacker, leaving 23 reports without dangerous data flow. Common limitations included over-approximation of data flows and confusion regarding the sender of an attacker-controllable message.

Despite these limitations, DoubleX detected 184 vulnerable extensions, totaling 209 vulnerable data flows, impacting between 2.4 and 2.9 million users. Notably, almost 40% of these extensions can be exploited by any website or extension. Overall, 172 extensions are susceptible to a web attacker, and 12 extensions are exploitable through an unprivileged extension. We confirmed 89% of the suspicious data flows reported by DoubleX, highlighting its high precision.

#### 5.2.2 Case Studies
Based on our data flow reports and findings, we describe five case studies of vulnerable extensions detected by DoubleX, showcasing the tool's versatility in detecting non-obvious vulnerabilities.

1. **Arbitrary Downloads with a Confused Deputy**
   - **Extension ID**: eflehphffapiajamoknfnpfapdgaeffk (10k+ users)
   - **Issue**: Registers an external message handler without specifying the `externally_connectable` field in its manifest, allowing messages from any extension. These messages are forwarded to the `downloads.download` API, enabling arbitrary file downloads.

2. **Arbitrary Code Execution**
   - **Extension ID**: cdighkgkcaadmonmbocgpcnenffjjdfc (4k+ users)
   - **Issue**: Content script forwards messages from any website to the background page, where they flow into the `tabs.executeScript` API without sanitization, allowing arbitrary code execution.

3. **Cross-Origin Requests from WARs**
   - **Extension ID**: kohfgcgbkjodfcfkcackpagifgbcmimk (200k+ users)
   - **Issue**: Registers an external message handler in its WARs to communicate with naturalreaders.com and its subdomains. If the website is compromised, an attacker can leverage the extension’s elevated privileges to make arbitrary requests and leak content.

4. **Most Visited Website Exfiltration**
   - **Extension ID**: lklfbkdigihjaaeamncibechhgalldgl (700k+ users)
   - **Issue**: Content script injected into msn.com and its subdomains. If the website is compromised, an attacker can send a payload to exfiltrate information about a user’s most visited websites.

5. **Arbitrary Cross-Origin Requests via eval and $.post**
   - **Extension ID**: ecnobkadlbkbcdmaidnhigklogkidlhf (100+ users)
   - **Issue**: Data flow to `eval` in the content script, allowing an attacker to conduct arbitrary cross-origin requests and read any resource of their choosing.

#### 5.2.3 Comparison Between 2020 and 2021
In this section, we discuss the evolution of vulnerable extensions between 2020 and 2021. Specifically, we focus on the life cycle of vulnerable extensions, i.e., whether vulnerable extensions from 2020 are still in the store in 2021 and, if so, whether they are still vulnerable. We crawled the Chrome Web Store on June 19, 2020, and March 16, 2021. Of the 166,513 extensions extracted in 2020, 132,231 (79%) were still present in the store in 2021, with 65,546 not updated in the nine-month period.

Running DoubleX on the 2020 extension set, we flagged 279 extensions (0.17%) as having a suspicious data flow, similar to our 2021 results (278 / 154,484 extensions). These 279 suspicious extensions expanded to 317 suspicious data flows. Manual review confirmed that 286 (90%) had a verified dangerous data flow, and 219 of these flows were exploitable, leading to 193 vulnerable extensions.

While the overall number of extensions in the Chrome Web Store slightly decreased in 2021, the proportion of vulnerable extensions remained unchanged (0.12%). However, 30 vulnerable extensions from 2020 are no longer in the store, and only 3 have been fixed. There are 19 new vulnerable extensions, and 5 existing extensions turned vulnerable in 2021. Overall, 87% of the extensions vulnerable in 2021 were already vulnerable in 2020, indicating the need for a system like DoubleX to prevent vulnerable extensions from entering the store.

#### 5.2.4 Disclosure to Extension Developers
We disclosed our findings to the corresponding extension developers, focusing on extensions that can be exploited by any website or extension, leading to universal XSS or sensitive user data exfiltration. In October 2020, we contacted 22 developers via email, 4 through contact forms, and reported 9 issues directly to Google. In May 2021, we reported 13 additional vulnerable extensions, contacting 9 developers via email and 4 directly to Google.

As of July 2021, of the 48 vulnerable extensions reported, 45 are still in the store. Of those, 13 have been updated since our disclosure, but only 5 have been fixed (impacting 300k+, 50k+, 3k+, 2k+, and 35 users). For example, one extension (300k+ users) was updated to remove the permission to only allow sites related to the extension, thus limiting the damage to third parties.

### 5.3 Comparative Analysis
The only related work leveraging a similar threat model and conducting a large-scale analysis on Chrome extensions is EmPoWeb by Somé (2019). We contrast our results against EmPoWeb's here and defer discussion of additional related work to Section 7. EmPoWeb uses a lightweight call graph analysis, yielding a high number of reports: of the 66k Chrome extensions analyzed, it flagged 3.3k as suspicious, with only 5% confirmed to be vulnerable after extensive manual review.

We compared DoubleX’s findings with EmPoWeb’s on our 154,484 extension set. EmPoWeb flagged significantly more extensions as suspicious (2,665 vs. 268) and reported more flaws (4,379 vs. 299). Since EmPoWeb does not use data flow analysis, it over-approximates the presence of an external message and a sensitive API as a potential flaw. DoubleX, however, flags extensions only if there is a confirmed data flow, resulting in fewer false positives.

Given EmPoWeb's low true-positive rate (5%) and DoubleX's detection of almost 93% of the vulnerable extensions released with the EmPoWeb paper, we are confident that the majority of EmPoWeb’s additional reports are false positives. DoubleX also detects vulnerabilities that EmPoWeb misses, particularly for the `cookies.getAll` and `tabs.executeScript` APIs.

### 5.4 Evaluation on a Labeled Dataset
To evaluate DoubleX's false negatives, we considered the dataset of vulnerable extensions released by Somé with EmPoWeb. Of the 171 Chrome extensions reported as vulnerable in 2019, 82 still existed on March 16, 2021. After manual analysis, we confirmed that 73 out of 82 are still vulnerable, totaling 163 previously reported vulnerabilities. We added some APIs not part of our original attacker model to our sensitive API list to ensure comprehensive coverage.