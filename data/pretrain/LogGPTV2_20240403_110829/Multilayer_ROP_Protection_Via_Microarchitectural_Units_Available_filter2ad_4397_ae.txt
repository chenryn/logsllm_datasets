(cid:17)
(cid:29)
(cid:34)
(cid:1)
(cid:14)
(cid:14)
(cid:18)
(cid:20)
(cid:1)
(cid:35)
(cid:25)
(cid:19)
(cid:27)
(cid:30)
(cid:1)
(cid:40)
(cid:27)
(cid:20)
(cid:37)
(cid:13)
(cid:23)
(cid:1)
(cid:35)
(cid:16)
(cid:27)
(cid:26)
(cid:30)
(cid:1)
(cid:30)
(cid:30)
(cid:16)
(cid:24)
(cid:12)
(cid:18)
(cid:1)
(cid:36)
(cid:12)
(cid:29)
(cid:33)
(cid:26)
(cid:27)
(cid:1)
(cid:27)
(cid:27)
(cid:31)
(cid:16)
(cid:25)
(cid:24)
(cid:26)
(cid:1)
(cid:35)
(cid:20)
(cid:23)
(cid:32)
(cid:14)
(cid:23)
(cid:12)
(cid:14)
(cid:1)
(cid:29)
(cid:16)
(cid:24)
(cid:24)
(cid:19)
(cid:1)
(cid:3)
(cid:9)
(cid:3)
(cid:4)
(cid:30)
(cid:24)
(cid:16)
(cid:5)
(cid:1)
(cid:24)
(cid:32)
(cid:31)
(cid:25)
(cid:12)
(cid:32)
(cid:28)
(cid:13)
(cid:20)
(cid:23)
(cid:1)
(cid:14)
(cid:23)
(cid:20)
(cid:24)
(cid:1)
(cid:8)
(cid:10)
(cid:7)
(cid:7)
(cid:1)
(cid:30)
(cid:14)
(cid:12)
(cid:24)
(cid:26)
(cid:29)
(cid:18)
(cid:1)
(cid:30)
(cid:16)
(cid:33)
(cid:12)
(cid:34)
(cid:13)
(cid:1)
(cid:22)
(cid:24)
(cid:13)
(cid:26)
(cid:18)
(cid:1)
(cid:17)
(cid:14)
(cid:24)
(cid:1)
(cid:25)
(cid:12)
(cid:12)
(cid:11)
(cid:23)
(cid:1)
(cid:8)
(cid:3)
(cid:2)
(cid:30)
(cid:32)
(cid:31)
(cid:14)
(cid:12)
(cid:14)
(cid:1)
(cid:24)
(cid:13)
(cid:23)
(cid:1)
(cid:15)
(cid:24)
(cid:12)
(cid:25)
(cid:1)
(cid:15)
(cid:41)
(cid:16)
(cid:20)
(cid:23)
(cid:30)
(cid:16)
(cid:23)
(cid:1)
(cid:27)
(cid:24)
(cid:30)
(cid:32)
(cid:16)
(cid:37)
RET mp is the number of return addresses that are mispre-
dicted at Layer 1; hence, falling into Layer 2. RET vo is the
veriﬁcation overhead per return instruction. This metric is
calculated as follows:
RET vo =
ExTime complete − ExTime pruned
RET N
ExTime complete is the execution time taken by an appli-
cation monitored by the complete Pintool, as seen in Sec-
tion IV-C1. This Pintool has every data structure used in the
implementation of Layer 2 (LBR structure, veriﬁcation of the
instruction that precedes a return address, veriﬁcation of a
LBR match for indirect calls, calculation of targets for direct
calls, veriﬁcation of permissions of targets of direct calls
and manipulation of counters). ExTime pruned is the execution
time taken by an application monitored by a Pintool that does
not have the veriﬁcation code. This Pintool has: LBR structure
and manipulation of counters. Finally, RET N is the number
of return operations executed by each application.
Analysis of Results. Figure 10 presents the results for the
multilayer system based on the Executable Target Constraint.
Most of the benchmarks present an overhead close to 0%. The
weighted average overhead is 0.57%.
The cumulative overhead of a CET-like shadow stack is
even lower, due to the lower overhead of our shadow stack
implementation (Section IV-C2). Figure 11 shows this result.
The weighted average in this case is just 0.02%. The numbers
outlined in Figure 10 and 11 reinforces our thesis that a
multilayer system allows the combination of costly anti-ROP
protections. Notice that our overhead results are an upper
(cid:47)(cid:44)(cid:1)
(cid:46)(cid:40)(cid:1)
(cid:43)(cid:44)(cid:1)
(cid:41)(cid:40)(cid:1)
(cid:38)(cid:44)(cid:1)
Weighted average = 21.65%
d
e
s
o
p
m
i
)
%
n
i
(
k
c
a
t
s
w
o
d
a
h
s
y
b
d
a
e
h
r
e
v
O
(cid:1)
(cid:24)
(cid:13)
(cid:23)
(cid:1)
(cid:15)
(cid:42)
(cid:16)
(cid:20)
(cid:23)
(cid:30)
(cid:16)
(cid:23)
(cid:1)
(cid:27)
(cid:24)
(cid:30)
(cid:32)
(cid:16)
(cid:37)
(cid:1)
(cid:24)
(cid:32)
(cid:31)
(cid:25)
(cid:12)
(cid:32)
(cid:28)
(cid:13)
(cid:20)
(cid:23)
(cid:1)
(cid:8)
(cid:3)
(cid:2)
(cid:30)
(cid:32)
(cid:31)
(cid:14)
(cid:12)
(cid:14)
(cid:1)
(cid:17)
(cid:14)
(cid:24)
(cid:1)
(cid:15)
(cid:24)
(cid:12)
(cid:25)
(cid:1)
(cid:30)
(cid:14)
(cid:12)
(cid:24)
(cid:26)
(cid:29)
(cid:18)
(cid:1)
(cid:3)
(cid:9)
(cid:3)
(cid:4)
(cid:30)
(cid:24)
(cid:16)
(cid:5)
(cid:1)
(cid:17)
(cid:29)
(cid:34)
(cid:1)
(cid:30)
(cid:16)
(cid:33)
(cid:12)
(cid:34)
(cid:13)
(cid:1)
(cid:35)
(cid:20)
(cid:23)
(cid:32)
(cid:14)
(cid:23)
(cid:12)
(cid:14)
(cid:1)
(cid:30)
(cid:30)
(cid:16)
(cid:24)
(cid:12)
(cid:18)
(cid:1)
(cid:29)
(cid:16)
(cid:24)
(cid:24)
(cid:19)
(cid:20)
(cid:1)
(cid:35)
(cid:25)
(cid:19)
(cid:27)
(cid:30)
(cid:1)
(cid:26)
(cid:31)
(cid:25)
(cid:26)
(cid:31)
(cid:1)
(cid:8)
(cid:10)
(cid:7)
(cid:7)
(cid:1)
(cid:17)
(cid:16)
(cid:29)
(cid:43)
(cid:45)
(cid:41)
(cid:19)
(cid:1)
(cid:6)
(cid:6)
(cid:23)
(cid:12)
(cid:16)
(cid:15)
(cid:23)
(cid:1)
(cid:35)
(cid:16)
(cid:27)
(cid:26)
(cid:30)
(cid:1)
(cid:14)
(cid:23)
(cid:20)
(cid:24)
(cid:1)
(cid:41)
(cid:27)
(cid:20)
(cid:37)
(cid:13)
(cid:1)
(cid:36)
(cid:12)
(cid:29)
(cid:33)
(cid:26)
(cid:27)
(cid:1)
(cid:14)
(cid:14)
(cid:18)
(cid:1)
(cid:18)
(cid:25)
(cid:16)
(cid:21)
(cid:30)
(cid:1)