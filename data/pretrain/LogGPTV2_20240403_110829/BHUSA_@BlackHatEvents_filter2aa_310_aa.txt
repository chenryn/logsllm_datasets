#BHUSA @BlackHatEvents
UWB Real Time Locating Systems
Andrea Palanca
Luca Cremona
Roya Gordon
PI:EMAIL
How Secure Radio Communications May Fail in Practice
© 2022 Nozomi Networks Inc.  
2
Overview
01
02
03
04
Methodology of Research
Attack Demos 
Remediations
05
Summary & Key Takeaways
Introduction
Introduction
4
Wireless communication systems are susceptible to various security threats that can compromise their 
reliability and impact production operations
Introduction
•
Ideal for short-range devices 
•
Can transmit information quickly 
over short distances 
•
Ability to send data through solid 
objects like walls and other barriers 
•
UWB is the preferred 
communication protocol for RTLS 
Spectral density for UWB and narrowband - Source: FiRa Consortium 
UWB
© 2022 Nozomi Networks Inc.  
5
Wireless communication systems are susceptible to various security threats that can compromise their 
reliability and impact production operations
Introduction – Cont’d
•
Uses UWB signals to locate 
stationary/mobile objects
•
3 components:
§
Tags
§
Anchors
§
Server that computes, shows 
and stores tag positions
•
The time of arrival is analyzed to 
determine the position of a tag
RTLS
Anchors
RTLS Server
Tag
Ts_1
Ts_2
Ts_3
Ts_4
UWB
Ethernet, or Wi-Fi, or other media
Operation of an UWB TDoA RTLS
© 2022 Nozomi Networks Inc.  
6
Wireless communication systems are susceptible to various security threats that can compromise their 
reliability and impact production operations
Introduction – Cont’d
Networks will be vulnerable 
to attacks by cyber criminals 
who are seeking to exploit 
vulnerabilities in order to gain 
access to sensitive data or 
disrupt operations.
Cyber Threats
Source: FiRa Consortium 
© 2022 Nozomi Networks Inc.  
Motivation
According to the FiRa consortium, in 2018 there was an increased demand for “improvements to existing 
modulations to increase the integrity and accuracy of ranging measurements”
Motivation
This is what motivated 
us to take a deeper 
look into how threat 
actors can exploit this 
vulnerability and 
disrupt environments 
utilizing UWB RTLS.
• In 2020, the Institute of Electrical and Electronic Engineers 
(IEEE) released standard 802.15.4
• IEEE quickly followed up with the 802.15.4z amendment, also 
released in 2020
• Synchronization and exchange of location data are 
considered “out-of-scope” by the standard
• These communications, whose design is left entirely to vendors, 
are critical aspects for the overall posture of TDoA RTLS
• Additionally, there has not been any research on UWB 
focusing on this specific problem
8
© 2022 Nozomi Networks Inc.  
Scope
Industry Scope
Examples of UWB RTLS use cases advertised by vendors
Focus: industrial and 
healthcare sectors
•
Highly targeted
•
UWB RTLS widely used in critical applications
Examples: use cases where 
UWB is protecting people’s lives
•
Employee and patient tracking
•
Geofencing
•
Contact tracing
10
© 2022 Nozomi Networks Inc.  
Analyzed Solutions
Sewio Indoor Tracking 
RTLS UWB Wi-Fi Kit
Avalue Renity
Artemis Enterprise Kit
• Both these UWB RTLS kits come equipped with a set of tags, anchors, and a 
server software that provides the aforementioned safety features
• Our research was performed on the 
following solutions, which target the 
industrial and healthcare sectors:
11
© 2022 Nozomi Networks Inc.  
Technical Scope
• Network communications occurring in a 
normal RTLS infrastructure:
o UWB
§
Tags to anchors
§
Anchors to anchors
o Ethernet/Wi-Fi/other
§
Anchors to RTLS server
As in a chain, a flaw in any of these 
communications may lead to a 
compromise of the entire infrastructure
• Up to now, security research has exclusively focused on 
the analysis of UWB signals. This is the first research 
analyzing the communications on Ethernet/Wi-Fi/etc.
Ethernet, or Wi-Fi, or other media,
focus of this research
Ultra-wideband
Anchors
RTLS Server
Tag
Architecture of an UWB TDoA RTLS
12
© 2022 Nozomi Networks Inc.  
TDoA Background 
and Theory
In a TDoA RTLS there are normally two kinds of packets exchanged among anchors and server
Packet Taxonomy
Synchronization packets
• Anchors’ clocks are usually not in-sync, 
(different boot times, clock drifts, etc.)
• A reference anchor continuously sends an 
UWB signal that is received by all non-
reference anchors
• The reference anchor sends a 
synchronization packet containing the 
transmission timestamp, the non-reference 
anchors a synchronization packet containing 
the receiving timestamp
• The server uses this information to build a 
common notion of time
Positioning packets
• A tag emits an UWB signal that is 
received by all anchors
• All anchors send the timestamps at 
which they received the UWB 
signal from the tag to the central 
positioning server, inside 
positioning packets
14
© 2022 Nozomi Networks Inc.  
𝐷𝑒𝑙𝑡𝑎 𝑖, 𝑗, 𝑡
=
𝐺𝑇 𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑗, 𝑡 − 𝐺𝑇 𝑖, 𝑗, 𝑡
∗ 𝑐 = 𝐺𝑇 𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑗, 𝑡 ∗ 𝑐 − 𝐺𝑇 𝑖, 𝑗, 𝑡 ∗ 𝑐
= 𝑑 𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑗, 𝑡 − 𝑑 𝑖, 𝑗, 𝑡
The routine implemented in TDoA RTLS can usually be divided in two major phases
Algorithm Details
Clock Synchronization
• There are many synchronization algorithms 
in literature. This work used the Linear 
Interpolation algorithm
• The basic idea is to convert all anchors’ 
timestamps to a common clock domain, so 
that they can be compared. These converted 
timestamps are called Global Times (GT)
Position Estimation
• We cannot immediately derive the 
distances from the GTs as we are 
missing the transmission instants
• We can, however, correlate the 
difference of GTs to the difference of 
distances. This is why the algorithm is 
called Time Difference of Arrival
All details in our whitepaper! Download it from the briefing page, or from the nozominetworks.com website
15
© 2022 Nozomi Networks Inc.  
The routine implemented in TDoA RTLS can usually be divided in two major phases
Algorithm Details – Cont’d
𝑝𝑇𝑠(𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑗, 𝑡) − 𝑠𝑇𝑆(𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑡) − (𝐶𝑆 1, 𝑡 ∗ 𝑝𝑇𝑠 1, 𝑗, 𝑡 − 𝑠𝑇𝑆 1, 𝑡
+ 𝑇𝑜𝐹(1)) ∗ 𝑐 =
𝑋𝑗, 𝑡 – 𝑋𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! +
𝑌𝑗, 𝑡 – 𝑌𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! +
𝑍𝑗, 𝑡 – 𝑍𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! −
𝑋𝑗, 𝑡 – 𝑋1 ! +
𝑌𝑗, 𝑡 – 𝑌1 ! +
𝑍𝑗, 𝑡 – 𝑍1 !
…
𝑝𝑇𝑠(𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑗, 𝑡) − 𝑠𝑇𝑆(𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒, 𝑡) − (𝐶𝑆 𝑁, 𝑡 ∗ 𝑝𝑇𝑠 𝑁, 𝑗, 𝑡 − 𝑠𝑇𝑆 𝑁, 𝑡
+ 𝑇𝑜𝐹(𝑁)) ∗ 𝑐 =
𝑋𝑗, 𝑡 – 𝑋𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! +
𝑌𝑗, 𝑡 – 𝑌𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! +
𝑍𝑗, 𝑡 – 𝑍𝑟𝑒𝑓𝑒𝑟𝑒𝑛𝑐𝑒 ! −
𝑋𝑗, 𝑡 – 𝑋𝑁 ! +
𝑌𝑗, 𝑡 – 𝑌𝑁 ! +
𝑍𝑗, 𝑡 – 𝑍𝑁 !
•
All coordinates of the anchors involved
•
Synchronization timestamps
•
Positioning timestamps
Summary
To obtain the position of a tag, the 
following data need to be known:
16
© 2022 Nozomi Networks Inc.  
Position Estimation – Cont’d
• Eventually, a non-linear system of equations can be set up to solve for Xj,t, Yj,t, and Zj,t, i.e., the position of tag 
j at the instant t:
Reverse Engineering of 
Devices Network Traffic
Network Traffic
• Both solutions use custom, unknown binary network protocols for the communications among anchors and 
server. No standard data structures are immediately recognizable
Example of Ethernet network packet in Sewio RTLS
18
© 2022 Nozomi Networks Inc.  
Packet Dissection
• By reverse engineering the server software, full packet structure was reconstructed
Sewio and Avalue RTLS dissectors
Example of code snippets from Sewio and Avalue RTLS servers
19
© 2022 Nozomi Networks Inc.  
We are freely releasing PCAPs and dissectors for both Sewio and Avalue RTLS! Download them from the 
briefing page, or from github.com/NozomiNetworks
Security Considerations
Confidentiality
• No confidentiality in the 
anchors-server communications
o The synchronization and 
positioning timestamps 
are sent in cleartext
Integrity
• No secure integrity 
mechanisms either
o Sewio RTLS uses CRC-16
o Avalue RTLS performs a byte 
per byte sum of all packets
Sewio RTLS – Extraction of timestamps directly from the network traffic
Avalue RTLS – Checksum computation
20
© 2022 Nozomi Networks Inc.  
Anchors 
Coordinates 
Prerequisite
Obtaining the anchor coordinates is the most challenging requirement. They are manually input at the first 
installation and never transmitted through the network
Anchor Coordinates Prerequisite
Attacker with Physical Access
• If the anchors are visible, obtaining their 
coordinates is simple
• If not, an attacker can still produce an estimation 
by measuring the power levels of the anchors’ 
wireless signals (UWB, Wi-Fi, etc.)
• In fact, tag coordinates can be estimated even 
with imperfect anchor coordinates
If anchor coordinates are estimated with a 
<10% error, the tag coordinates are computed 
with an average error of <20%, i.e., ~50 cm in 
a 6m x 5m room
Tag Coordinates Average Error with 
respect to Anchor Coordinates Error
22
© 2022 Nozomi Networks Inc.  
Anchor Coordinates Prerequisite – Cont’d
Power level information in Avalue RTLS packets
Attacker with Remote Access
• Besides timestamps, anchors transmit on the wire 
the power level information of the received UWB 
signal. We can compute two different metrics:
o First Path Power Level (FPPL)
𝐹𝑃𝑃𝐿 = 10 ∗ log!"
#$!!%#$&!%#$'^&
$)*!