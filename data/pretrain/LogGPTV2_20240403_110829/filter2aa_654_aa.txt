Social 
Networking 
Special 
Ops: 
Extending 
Data 
Visualization
 Tools
 for 
Faster 
Pwnage
1
Chris Sumner | @TheSuggmeister | www.securityg33k.com 
Tuesday, 3 August 2010
Disclaimer
“I am not speaking on behalf of my 
employer.
 The information and perspectives I 
present are personal and do not 
represent those of my employer.”
2
Tuesday, 3 August 2010
What yer in for…
3
Tuesday, 3 August 2010
What yer in for…
1. Intro to Social Network Analysis & 
Visualization 
3
Tuesday, 3 August 2010
What yer in for…
1. Intro to Social Network Analysis & 
Visualization 
2. Case study using Twitter & Maltego
3
Tuesday, 3 August 2010
What yer in for…
1. Intro to Social Network Analysis & 
Visualization 
2. Case study using Twitter & Maltego
3. Something a bit darker using facebook & 
Maltego
3
Tuesday, 3 August 2010
Goals
4
Tuesday, 3 August 2010
Goals
• Overview/appreciation of possibilities in 
this field
4
Tuesday, 3 August 2010
Goals
• Overview/appreciation of possibilities in 
this field
• Expose you to some ideas that you can 
apply to your specific situation
4
Tuesday, 3 August 2010
Who’s the talk aimed at?
5
This talk
Tuesday, 3 August 2010
Who’s the talk aimed at?
5
Data 
Visualization
Social Networking Analysis
This talk
1337
n00bs
1337
Tuesday, 3 August 2010
Who’s the talk aimed at?
5
Data 
Visualization
Social Networking Analysis
This talk
1337
n00bs
1337
Tuesday, 3 August 2010
Who’s the talk aimed at?
5
Data 
Visualization
Social Networking Analysis
This talk
1337
n00bs
1337
Tuesday, 3 August 2010
Who’s the talk aimed at?
5
Data 
Visualization
Social Networking Analysis
This talk
1337
n00bs
Y’all 
probably 
get it
1337
Tuesday, 3 August 2010
Who am I?
@TheSuggmeister
6
Tuesday, 3 August 2010
Who am I?
@TheSuggmeister
6
• By day
– Corporate security
Tuesday, 3 August 2010
Who am I?
@TheSuggmeister
6
• By day
– Corporate security
• By night | weekend
– Data analysis
– Data visualization
– Social Media
– DC4420
Tuesday, 3 August 2010
Who am I?
@TheSuggmeister
6
• By day
– Corporate security
• By night | weekend
– Data analysis
– Data visualization
– Social Media
– DC4420
• A strange sequence of 
events led to me 
appearing here
Tuesday, 3 August 2010
Social Network Analysis
+  Target Rich Environment
=  Problem
=  Opportunity
7
Tuesday, 3 August 2010
Social Network Analysis
Sociogram- Jacob Moreno 1933
8
Tuesday, 3 August 2010
Target Rich Environment
9
Tuesday, 3 August 2010
Target Rich Environment
• Data – ~21 exabytes per month
9
Tuesday, 3 August 2010
Target Rich Environment
• Data – ~21 exabytes per month
• Facebook – ~500 ish million users
9
Tuesday, 3 August 2010
Target Rich Environment
• Data – ~21 exabytes per month
• Facebook – ~500 ish million users
• Privacy paradox
– “I take privacy seriously”
– 89% use real names
– 61% use identifiable picture
9
Tuesday, 3 August 2010
Target Rich Environment
• Data – ~21 exabytes per month
• Facebook – ~500 ish million users
• Privacy paradox
– “I take privacy seriously”
– 89% use real names
– 61% use identifiable picture
• “I’ve got nothing to hide and Other 
Misunderstandings of Privacy” – Daniel 
Solove
9
Tuesday, 3 August 2010
Problem  
Your anonymous searches, 
aren’t all that anonymous
10
Tuesday, 3 August 2010
Problem  
Your anonymous searches, 
aren’t all that anonymous
10
• AOL user 4417749
• Ms. Thelma Arnold, 
Lilburn Georgia
Tuesday, 3 August 2010
Opportunity
• Lots of data
• Lots of noise
11
Tuesday, 3 August 2010
Opportunity
• Lots of data
• Lots of noise
• Find “interesting” stuff a bit faster….
11
Tuesday, 3 August 2010
Opportunity
• Lots of data
• Lots of noise
• Find “interesting” stuff a bit faster….
…..by combining Data Mining/Screen Scraping, 
Named Entity Recognition and Data 
Visualization
11
Tuesday, 3 August 2010
Named Entity Recognition
“Parsing data to extract & classify information”
12
Tuesday, 3 August 2010
Named Entity Recognition
“Parsing data to extract & classify information”
12
“Greg bought 300,000 shares of LIGATT in 2010”
Tuesday, 3 August 2010
Named Entity Recognition
“Parsing data to extract & classify information”
12
“Greg bought 300,000 shares of LIGATT in 2010”
Greg bought 
300,000 shares of 
LIGATT in 
2010. 
Tuesday, 3 August 2010
Data Visualization
13
1. Acquire
2. Parse
3. Filter
4. Mine
5. Represent
6. Refine
7. Interact
Ben Fry
Tuesday, 3 August 2010
Data Visualization
13
1. Acquire
2. Parse
3. Filter
4. Mine
5. Represent
6. Refine
7. Interact
Ben Fry
Tuesday, 3 August 2010
Raffael Marty
Check out secviz.org
14
Tuesday, 3 August 2010
Tools
• Maltego
• Processing
• Prefuse and PrefuseFlare toolkit
• Afterglow
• DAVIX (Data Analysis & Visualization Linux)
• TouchGraph
• Vizster
• Graphviz
15
Tuesday, 3 August 2010
16
21 September 2009
What the &$#@! is 
Maltego?
Tuesday, 3 August 2010
Maltego
17
Tuesday, 3 August 2010
Maltego
• An information gathering tool that allows 
you to visually see relationships.
17
Tuesday, 3 August 2010
Maltego
• An information gathering tool that allows 
you to visually see relationships.
• Infrastructure
– DNS, IP Addresses, URLs, MX Records
17
Tuesday, 3 August 2010
Maltego
• An information gathering tool that allows 
you to visually see relationships.
• Infrastructure
– DNS, IP Addresses, URLs, MX Records
• Human 
– Email, Phone…
17
Tuesday, 3 August 2010
Maltego
• An information gathering tool that allows 
you to visually see relationships.
• Infrastructure
– DNS, IP Addresses, URLs, MX Records
• Human 
– Email, Phone…
• Other… Extendable by design
17
Tuesday, 3 August 2010
18
www.paterva.com
Tuesday, 3 August 2010
18
25% 
Discount
‘BlackHat’
www.paterva.com
Tuesday, 3 August 2010
E.G.
19
Tuesday, 3 August 2010
20
Domains
Tuesday, 3 August 2010
21
MX Records
Tuesday, 3 August 2010
Web Sites…
22
Tuesday, 3 August 2010
23
21 September 2009
Tuesday, 3 August 2010
24
21 September 2009
Tony Hawk Twitter Hunt versus 
Maltego
Tuesday, 3 August 2010
25
Tuesday, 3 August 2010
26
Tuesday, 3 August 2010
“Guarded by a fearsome troll, NW from a 
house where you might have to pay money 
to pass & a sk8park”
27
Tuesday, 3 August 2010
28
Tuesday, 3 August 2010
29
@steven_gill
Tuesday, 3 August 2010
30
“cammo netting! 
You’re a bad man”
Tuesday, 3 August 2010
31
@steven_gill
Tuesday, 3 August 2010
32
Tuesday, 3 August 2010
I wanted to see a map
33
obviously
Tuesday, 3 August 2010
Should be easy enough
• Hiders are all friends of @hidingit
• Finders all tweet @ifoundone when 
they find one.
• Tony sends out “Found” tweets 
with #THTH
34
Tuesday, 3 August 2010
Twitter’ll fix it
35
Tuesday, 3 August 2010
Twitter’ll fix it
35
Tuesday, 3 August 2010
Twitter’ll fix it
35
@l0sthighway
Tuesday, 3 August 2010
Twitter’ll fix it
35
@l0sthighway
Tuesday, 3 August 2010
Hypothesis
36
=
=
+
Tuesday, 3 August 2010
List the Hiders
37
Tuesday, 3 August 2010
Derive @HidingIt
38
@HidingIt
Tuesday, 3 August 2010
To Tweets [Search Twitter]
39
Tuesday, 3 August 2010
Tweets
40
Tuesday, 3 August 2010
To Twiiter Affiliation [Convert]
41
Tuesday, 3 August 2010
42
Tuesday, 3 August 2010
To friends of this person
43
Tuesday, 3 August 2010
44
Tuesday, 3 August 2010
“Suggy”
45
Tuesday, 3 August 2010
To Tweets [That this person wrote]
46
Tuesday, 3 August 2010
47
Tuesday, 3 August 2010
Twitter Search Limitations
48
Tuesday, 3 August 2010
Local Transforms
If you can call  script/program 
and pass input… AND
If you can get your output to 
STDOUT, THEN
you can write a local transform
49
Tuesday, 3 August 2010
50
Tuesday, 3 August 2010
3 x API’s
• 2 x REST
• 1 x Streaming
• PERL & ::LWP  e.g. from latest tweet
$url = "http://twitter.com/statuses/
user_timeline.xml?count=200&id=" . 
$entityValue2;
51
Tuesday, 3 August 2010
Gotcha’s
• 200 tweet limit
• Couldn’t search by date
• Max history of 3200 tweets
• 150 API calls an hour
• 100 people * 3 api calls each = 300
52
Tuesday, 3 August 2010
Whitelisting
• 150 versus 20,000 per hour
53
Tuesday, 3 August 2010
54
21 September 2009
Find the winners
Tuesday, 3 August 2010
55
Tuesday, 3 August 2010
List of all @mentionee’s
56
Tuesday, 3 August 2010
57
x3
Tony’s @ mentionee’s (potential finders….)
Found ATL by @blahblahblah
Tuesday, 3 August 2010
58
Repeat for each of Tony’s mentionee’s
Tuesday, 3 August 2010
59
Tuesday, 3 August 2010
60
Big graph
Tuesday, 3 August 2010
61
FAIL
Tuesday, 3 August 2010
A bit less messy
62
Tuesday, 3 August 2010
Centrality layout
63
Tony Hawk
HidingIt
People Tony mentioned who tweeted 
with followers of @HidingIt... & vice-
versa
Tuesday, 3 August 2010
Organic
64
Tuesday, 3 August 2010
Organic
64
Tony
HidingIt
Me
Steven
Tuesday, 3 August 2010
Edge Weighted
65
Tony Hawk
Hiding It
Jerome Case
Tuesday, 3 August 2010
So what? What on earth have I 
been going on about?
66
Jerome Case
Steven_Gill
Suggy
Tuesday, 3 August 2010
@sweetjerome & @tonyhawk
67
Tuesday, 3 August 2010
Lessons learned #1
• Plan
68
Tuesday, 3 August 2010
Lessons learned #2
• Speed/Accuracy bar set to left until you know it works
• If you ever think, “that’s weird. Not many results”, it’s 
probably because your Speed/Accuracy bar isn’t over to 
the right. 
69
Tuesday, 3 August 2010
Lessons learned #3
70
Tuesday, 3 August 2010
Lessons learned #3
• Local transforms open up a world of opportunity 
70
Tuesday, 3 August 2010
Lessons learned #3
• Local transforms open up a world of opportunity 
• Enterprise? Consider the server platform. 
70
Tuesday, 3 August 2010
Lessons learned #3
• Local transforms open up a world of opportunity 
• Enterprise? Consider the server platform. 
• If you’re going to leverage Twitter API heavily, you should 
really consider making a whitelisting request
70
Tuesday, 3 August 2010
71
21 September 2009
The Mission
Tuesday, 3 August 2010
72
“Just Landed:
 Processing, Twitter, MetaCarta & Hidden Data”
Jer Thorp, using processing
Tuesday, 3 August 2010
Graphs for DEC.org.uk
73
……Check out RowFeeder.com
Tuesday, 3 August 2010
74
Tuesday, 3 August 2010
74
Tuesday, 3 August 2010
74
I go 
chop your dollar...
Tuesday, 3 August 2010
Disclaimer
“The only way you can tell the truth is 
through fiction” 
Via Richard Thieme/his friend at NSA
“Events, Names, dates, images etc all 
changed to protect the innocent and 
the not so innocent”
75
Tuesday, 3 August 2010
Meet “Jess”
76
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
• Jess exchanges emails with the buyer
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
• Jess exchanges emails with the buyer
• Notification from “paypal”
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
• Jess exchanges emails with the buyer
• Notification from “paypal”
• Jess sends laptop to valid address in 
UK
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
• Jess exchanges emails with the buyer
• Notification from “paypal”
• Jess sends laptop to valid address in 
UK
• Notice from auction site that buy 
account had been hacked
Tuesday, 3 August 2010
Meet “Jess”
76
• Laptop on auction site
• Gets bought quickly at “Buy now price”
• Jess exchanges emails with the buyer
• Notification from “paypal”
• Jess sends laptop to valid address in 
UK
• Notice from auction site that buy 
account had been hacked
• Jess contacts police
Tuesday, 3 August 2010
Hypothesis
77
=
=
+
Tuesday, 3 August 2010
Step #1 Where is our scammer?
78
Tuesday, 3 August 2010
Step #1 Where is our scammer?
• Need to get email header, but he/she uses 
webmail……
78
Tuesday, 3 August 2010