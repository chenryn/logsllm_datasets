### Fingerprint Matching
The fingerprint matching process involves two rounds of noise extraction and PCE (Pairwise Correlation Estimation) calculation. The time consumption for this procedure is illustrated in Fig. 17(a).

### Forgery Detection
Since the required noise residues have already been obtained from the previous step, forgery detection only requires one round of PCE calculation. The time consumption for this process is shown in Fig. 17(b).

### Removal Detection
Removal detection also involves two rounds of noise extraction and PCE calculation. For the probe signal used in our prototype (800×800), the protocol takes up to 0.9 seconds to detect fingerprint removal.

### Overall Protocol Efficiency
For each test, we utilized a parallel pool of MATLAB with four workers on a local machine. Two workers sequentially conducted fingerprint matching and forgery detection, while the other two workers performed removal detection using the probe signals listed in Table II. As shown in Fig. 17(c), ABC achieves high efficiency for most common resolutions. Compared to the fingerprint matching process, the security mechanisms integrated into the protocol introduce only an additional 7.5% runtime to the authentication process.

The latency for high-resolution images is primarily due to the fingerprint extraction process. It is worth noting that the code published by the Digital Data Embedding Laboratory [27] does not leverage GPU or parallel computing. With further optimization, the efficiency could be significantly improved. Additionally, as demonstrated in Sections VI-B4 and VI-B5, images with low scaling rates can achieve high accuracy with reasonable registration overhead. Therefore, for smartphone models with high-resolution cameras, the verifier can reduce the overhead of the authentication process by cropping the received image to a lower resolution.

### Usability Study
To understand users' behaviors, needs, and attitudes towards the ABC protocol, we conducted a user study with a prototype using two Samsung Galaxy Note 5 devices: one as the smartphone to be authenticated and the other as the verifier. In the prototype, we used an NFC channel to implement the wireless communication between the smartphone and the verifier. We tested our system with 40 participants (20 males and 20 females) aged between 21 and 54, randomly selected from the general public.

During the test, we provided a one-minute introduction to the system. Each participant was then required to conduct the smartphone authentication using our prototype without further guidance. Since people are familiar with taking photos with smartphones, all participants were able to complete the task on their first attempt. Fig. 17(d) shows the CDF (Cumulative Distribution Function) of the time taken by each participant to photograph the challenging QR code. 95% of the participants found the photographing phase to be efficient and comfortable. Specifically, five female participants noted that photographing is better than typing passwords, as remembering passwords places a considerable burden on them.

For the NFC transmission phase, 80% of the male participants criticized the NFC channel's transmission speed as being somewhat slow, while 90% of the female participants found the transmission speed acceptable and the data transfer method interesting.

### Related Work
Hardware fingerprinting has been an active area of research in recent years. Due to manufacturing imperfections, physical sensors introduce systematic distortions in their output. Studies have shown that the distortions generated by motion sensors, acoustic sensors, and wireless transmitters are strong enough to uniquely identify off-the-shelf smartphones.

Dey et al. [20] exploit the imperfections of the accelerometer by stimulating it with a vibration motor and using machine learning to create a fingerprint. Bojinov et al. [5] analyze the calibration error of the accelerometer and verify its effectiveness with a large number of devices. This method requires the user to perform a calibration of the accelerometer. Das et al. [18] further investigate combining the features of both accelerometers and gyroscopes to generate more accurate fingerprints. However, their method requires the user to precisely rotate the smartphone at specific angles. Moreover, the fingerprints of motion sensors are manipulatable and can be easily eliminated [18], [17].

Acoustic fingerprints can also be used to uniquely identify smartphones. Das et al. [16], [15] extract auditory fingerprints from the process of playing and recording audio clips. Zhou et al. [41] explore the speaker's frequency response to specially designed audio inputs. Chen et al. [9] combine the frequency response of one device’s speaker and another device’s microphone as the hardware fingerprint for device authentication. However, these methods require access to the microphone and raise privacy concerns [17].

Radio frequency fingerprinting is another active research area. Various steps in the process of generating wireless signals, all due to hardware imperfections of a transmitter [14], can serve as sources of RF fingerprints. Different fingerprint sources include clock jitter [39], device antenna [12], DAC sampling error [32], power amplifier non-linearity [32], [33], [30], modulator sub-circuit [6], and the mixer or local frequency synthesizer [38].

Although hardware fingerprinting has proven effective in tracking smartphones, it is unclear whether these methods can resist impersonation attacks. Since the signals generated by sensors are manipulatable, most fingerprinting methods are vulnerable to forgery attacks where an adversary intentionally tampers with the sensor data [8], [13].

### Conclusion and Future Work
In this paper, we explore the use of the image sensor's PRNU (Photo Response Non-Uniformity) as a unique fingerprint for implementing physical-layer device authentication in smartphones. We find that smartphone cameras exhibit very strong PRNU. Based on this, we designed ABC, an attack-resilient, real-time, and user-friendly smartphone authentication protocol that differentiates smartphones through the PRNU of their built-in cameras. The registration of a smartphone's PRNU requires only one image. We implemented a prototype of ABC and tested it with 16,000 images collected from Amazon Mechanical Turk and our own devices. The experimental results show that ABC can efficiently authenticate users' devices with an error rate of less than 0.5% and detect fingerprint forgery attacks with an error rate of less than 0.47%. Our user study suggests that PRNU-based authentication is a promising approach for enhancing smartphone security.

With more smartphone manufacturers adopting dual-camera systems, we plan to investigate how to leverage the extra camera to improve the security of ABC. With a dual-camera system, the verifier will be able to identify each smartphone using the fingerprints of both cameras, thereby increasing the difficulty of fingerprint forgery. We will also consider the characteristics of different dual-camera system types: for example, the iPhone 7 Plus uses a wide-angle camera and a telephoto camera to achieve higher-quality zoom, while the Huawei P9 combines an RGB and a monochrome image sensor to enhance the detail of captured images.