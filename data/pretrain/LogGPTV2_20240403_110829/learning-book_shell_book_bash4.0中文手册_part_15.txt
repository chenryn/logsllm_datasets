S6.2.6由远程的shell守护进程启动
Bash会试图把它的标准输出和一个网络连接相关联，就好像它由远程的shell守护进程（通常是rehd
或sehd）启动的一样。如果Bash以这种方式启动，它就会读取并执行-/.bashrc里面的命令（如果这
个文件存在并且可读）。而如果以sh来启动就不这么做。可以使用"--nore"选项来制止这种行为，或者
定它们。
p57
目录
BASH 中文文
---
## Page 69
第六章BASH的功能
§6.3交互式的 SHELL
6.2.7启动时实际用户（组）号和有效用户（组）号不同
如果Bash启动时实际用户（组）号和有效用户（组）号不同，并且没有指定“-p选项，它就不会读取初
始化文件，也不从环境中继承shell函数：如果环境中有SHELLOPTS变量，也会被忽略。这时，把有效用户
号设为实际用户。如果启动时指定了“p”选项，则启动行为仍然这样，但不设置有效用户号。
S6.3交互式的shell
S6.3.1什么是交互式的shell
交互式的shell是指它启动时没有非选项的参数（除非指定了“-"选项），也没有指定"-e"选项，并且标
准输出和标准错误输出都和终端关联（可以用iBatty（3）查看），或者通过“-i"选项启动。通常，交互式的
S6.3.2当前的shell是交互式的吗？
如果想在初始化脚本中检测Bash是否以交互方式运行，可以检测特殊变量-的值。如果它的值包
含“i"，那么它就是交互的。另外一种方法是，检查变量PS1的值：这个变量在交互式的shell中设置，而
非交互的 shell 重置了它。
豪代码清单4：Readline启动脚本的例子
1#第一种方法
2 case "s=" in
*i*)
echo这个是交互式的shel1。
echo这个不是交互式的shell。
9 esac
11#第二种方法
0
12 if [=z "$PS1" ];then
13
echo 这个不是交互式的shell。
14 else
15
echo这个是交互式的shel1。
16 fi
S6.3.3交互式shell的行为
Shell在交互式运行时，会改变几个方面的行为：
读取并执行初始化文件（参见56.2[Bash的启动脚本]，p56）。
2默认启用作业控制（参见57[作业控制，p69）.已经启用作业控制时，Bash就会忽略来自键盘的作业
控制信号SIGTTIN、SIGTTOU、SIGTSTP
3Bash会在读取第一行命令之前先扩展并显示PS1，在读取多行命令的第二和其余行之前扩展并显示
PS2.
4
Bash会在打印主提示符PS1之前把变量PROMPT_COMMAND的值当成一个命令去执行（参见S5.2Bash
的变量]，p53）
BASH 中文文档
目录
894
---
## Page 70
6.4BASH条件表达式
第六章BASH的功能
5用Readline（参见≤8编辑命令行]，p72）从用户的终端读取命令。
在读取命令时，Bash会检查Bet-o命令的gnoreeof选项（参见586[内部命令set]，p49）的值，而
不是接收到标准输入中的EDF后就立即退出。
默认启用命令历史（参见s9.1[Bash的历史功能]，p90）和历史补全（参见59[历史的交互使用]，p90）。
在退出时，Bash会把命令历史写入到SHISTFILE指定的文件中.
默认进行别名（参见56.6别名].p62）扩展。
9如果没有定义任何陷阱，Bash就忽略SIGTERM信号（参见53.7.6[信号]，p26）。
1如果没有定义任何陷阱，Bash就捕获并处理SIGINT信号（参见专3.7.G[信号].p26）.SIGINT信号可能
会中断某些内部命令，
11如果打开了huponexit选项（参见&87[内部命令shopt]，p46），交互式的登录shell在退出时会向所有
的作业发送SIGHUP信号。
1②忽略启动选项"-n”。“Bet=n"也不会起作用（参见S86[内部命令set]，p42）。
p4&)-
14设置Bet=u（参见586[内部命令set]，p44）后，扩展一个末定义的变量发生的错误不会导致shell退
出。
15Shell不会因为在扩展s{var：?word}时发生变量var未定义错误而退出（参见3.5.3[Shell参数扩展]。
pI6).
16Shell内部命令的重定向错误不会导致退出。
17如果在POSIX模式下运行，特殊命令返回错误状态不会导致shell退出（参见6.11Bash的POSIX模
式], p67).
执行exec失败不会导致shell退出（参见专4.1波恩 Shell 的内部命令exec].p30）。
19解析器遇到语法错误不会导致shell退出，
2默认打开了内部命令cd对目录参数的简单拼写更正功能（参见多87[内部命令shopt].p45)。
②1Shell会检查TMOUNT变量（参见5.2[Bash的变量]，p54）的值，如果打印提示符后$PS1后在其指定
的秒数内没有读取到命令就会退出。
$6.4Bash条件表达式
条件表达式由复合命令[L和内部命令teBt与【使用。这些表达式可以是单目或者双目的。单目
表达式常常用来检测文件的状态。此外还有字符串运算符和数值比较运算符。如果某个基本表达式的文
件参数格式为/dev/fd/N，则测试的是文件描述符N.如果某个基本表达式的文件参数是/dev/stdin。
/dev/etdout、/dev/stderr之一，则测试的分别是文件描述符0、1、2
下面除非特别说明，下列操作文件的表达式将跟随符号链接去操作其指向的目标，而不是操作符号链接
本身。
文件
如果文件存在则为真。
b文件
如果文件存在并且是个块设备文件则为真。
p59
目录
BASH中文文
---
## Page 71
第六章BASH的功能
56.4BASH条件表达式
c文件
如果文件存在并且是个字符设备文件则为真。
d文件
如果文件存在并且是个目录则为真。
e文件
如果文件存在则为真。
f文件
如果文件存在并且是个常规文件则为真。
g文件
如果文件存在并且设置了有效组号则为真。
h文件
如果文件存在并且是个符号链接则为真。
k文件
如果文件存在并且设置了“滞留位”则为真。
p文件
如果文件存在并且是个命名管道（FIFO）则为真。
r文件
如果文件存在并且可读则为真。
B文件
如果文件存在并且其大小不为零则为真。
t文件描述符
如果文件描述符已打开并且指向终端则为真。
u文件
如果文件存在并且设置了有效用户号则为真，
V文件
如果文件存在并且可写则为真。
x文件
如果文件存在并且可执行则为真。
文件
如果文件存在并且被其有效用户号所拥有则为真。
G文件
如果文件存在并且被其有效组号所拥有则为真。
L文件
如果文件存在并且是个符号链接则为真。
S文件
如果文件存在并且是个套接字文件则为真，
-N文件
如果文件存在并且大上次读取过后被修改过则为真。
文件-=nt文件二
如果文件一比文件二新（根据修改时间）或者文件一存在而文件二不存在则为真。
文件一=t文件二
如果文件一比文件二旧（根据修改时间）或者文件二存在而文件一不存在则为真。
文件一=ef文件二
如果文件一和文件二指向同样的设备或文件节点则为真。
0选项名称
如果shell的选项名称已设置则为真。可以用内部命令Bet的“=o选项（参见586[内部命令
set]：p42）列出所有选项。
z字符串
如果字符串的长度是零则为真。
字符串
BASH 中文文档
目录
p60
---
## Page 72
6.5SHELL的算术运算
第六章BASH的功能
n字符串
如果字符串的长度不是零则为真。
字符串-字符串二
如果字符串一与字符串二相等则为真。可以把--换成－以保证与POSIX
致。
字符串一-字符串二
如果字符申一与字符串二不相等则为真。
字符串一字符串二
在当前语言区域中排序时，如果字符串一排在字符申二后面则为真。
数值一运算符数值二
运算符是"=eq”、“=ne”、“-1t”、“-1e"、“=gt"、“=ge"之一.在这些算术双目运
算中，如果数值一分别为等于、不等于、小于、小于或等于、大于、大于或等于数值二则为真。数值
一和数值二可以是正或负整数。
$ 6.5
Shell的算术运算
Shell可以对算术表达式求值，它可以是shell扩展的结果，也可以由内部命令let，或者declare
的“=i"选项来实现。
求值时使用固定宽度的整数，并且不检查溢出，虽然它可以捕获到除以零的情况并报错。运算符的优先
级、结合性、以及值都和C语言相同。下列运算符按优先级分组，并按优先级从高到低的顺序列出。
id++ id=-
后增和后减
++id --id
先增和先减
单目负号和正号
逻辑取反，按位取反
**
指数
*/%
乘，除，求余
+：
加，减
>
按位左移，按位右移
= <>
比较
== |=
相等，不等
按位与
按位异或
按位或
逻辑与
逻辑或
cond ? exprl : expr2
条件运算符
=/-y=+===>===|=
赋值
exprl, expr2
逗号运算
可以使用shell变量作为运算数。在进行求值之前会进行参数扩展。在表达式中，还可以通过名称直接
使用变量而无需参数扩展的语法形式。如果是通过名称而不是参数扩展来使用变量，则对于未设置或设为
空值的变量在求值时为0.在引用到一个变量时，或者对一个用declare-i设置了其integer属性的变
量进行赋值时，就把这个变量当成算术表达式进行求值。空值运算结果为0.要在表达式中使用一个shell
变量，不需要设置它的interger属性。
以0开头的常量当作八进制数解释，而以“0x"或"0x"开头表示十六进制数。此外，数值的格式是
[basen：其中的base是2到64之间的一个十进制数，它表示算术进制基数：而n是这个进制中的一个
1即不需要变量前面的"$”。
p61
目录
BASH 中文文
---
## Page 73
第六章BASH的功能
6.6别名
数。如果省略了baBe#部分，则表示10进制。大于9的数字依次用小写字母、大写字母、“”、“"来表
示。
如果base小于或等于36，则可以混合使用大小写字母来表示10到35之间的数。
求值时按运算符的优先顺序进行。括号中的子表达式先求值，可以用来改变运算顺序。
56.6别名
对于简单命令中的第一个单词，别名可以把它替换成一个字符串。Shell维护一个别名列表，可以用内
部命令aliae或unaliae进行设置或删除。
对于每条简单命令的第一个单词，如果没有引用，shell都会去检查它是否有别名。如果有，这个单词
就用别名中的文本替换。“/"、“$"、“"、“”以及前面列出的任一shell元字符都不能在别名的名称中出
现：而要替换的文本中可以含有任何有效的shell输入，包括shell元字符。检查别名时只测试替换文件中
的第一个单词，但是与别名扩展后完全一样的单词不会再次被扩展。例如，这就意味着可以把1作为18