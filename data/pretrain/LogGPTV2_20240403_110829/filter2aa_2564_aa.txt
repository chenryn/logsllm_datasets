1
Attacking BaseStations
Hendrik Schmidt  / @hendrks_
Brian Butterly  / @BadgeWizard
2
Who we are
o
Old-school network geeks,
working as security researchers for
o
Germany based ERNW GmbH
o
Independent
o
Deep technical knowledge
o
Structured (assessment) approach
o
Business reasonable recommendations
o
We understand corporate
o
Blog: www.insinuator.net 
o
Conference: www.troopers.de
3
Motivation
o
The 4G standard introduces a lot of new technologies 
providing modern services to the customer.
o
This includes features as VoLTE, SON, ………..Trust 
and optional controls
o
BaseStations are the big (and small) antennas in the 
field
o
With our research we want to bring visibility to
o
How the environment works
o
What providers do
o
What vendors do
4
5
Introduction
A 4G/LTE Telecommunication Network
6
4G Core
eUTRAN
UE
eNodeB
MME
PDN-GW
Serv-GW
HSS
IMS
S1-MME
S1-U
OSS
S1-MME
IP Network
7
Typical 
Environment?
Source: 
worldlte.blogspot.com
8
Typical 
Environment?
9
The Idea
1. Understand BaseStation Setup
2. Purchase an old BaseStation out of the field
3. Get BS running in an emulated environment
4. Perform an evaluation of configuration & 
security
10
What we need:
Basestation Physical Setup
o
Base Band Unit (BBU)
o
Usually standing on the ground
o
Including Power Distribution Unit (PDU) and Power 
Supply Unit (PSU)
o
Remote Radio Head/Unit (RRH/RRU)
o
May be placed on the cell mast or on the ground
o
Antenna
o
Come in various shapes and sizes
o
Nowadays often vector antennas
o
All active parts are interconnected
o
BBU, RRU, sensors, power supply, vents
11
o Components run on -48V
o
Not +-48V (96V differential)
o
Basically just 48V connected 
the other way round
o Basically receives raw RF 
signals via Fiber and sends 
them out via Copper
o
Towards the antenna
o Usually capable of serving a 
specific frequency band
Power Supply
RRU
12
o Frame for holding power unit 
and functional blades
o Sometimes have a backplane 
for interconnection between 
components
o
Arbitrary PCB connectors
o
Multiple interfaces (LAN, 
UART, Arbitrary, CAN)
o
Functional blades decide the 
network type
o
Ericsson: DUL/DUW/DUG -> Digitial
Unit LTE/WCDMA/GSM
o
Slots for multiple blades
o
Single BBU could serve GSM and 
WCDMA
o
Depends highly on specific BBU and 
blade combination
o
Single blade can serve multiple 
cells
o
Using sector antennas a single mast 
could i.e. serve 4 cells in 4 different 
directions
Most important Unit: the BBU
13
Variants of an eNodeB
o Come in different shapes and sizes.
o
Rack, “Small-Boxes“, Portable
o Different types for different size cells.
o
Macro (>100m), Micro (100m), Pico (20-50m), 
HeNB (10-20m)
o
(WiFi/WiMax)
o Termination Point for Encryption
o
RF channel encryption
o
Backend channel encryption
14
Implementing a Lab
Just a Quick HowTo
15
Ebay 
Some helpful words:
Nokia - FlexiBTS
Huawei – BBU + 
LMPT/UMPT
Ericsson – RBS + 
DUL
ALU – MBS
16
Lab Setup – What You Need
o A Basestation
o
The RRU is optional if you just want to play with 
the BTS itself
o Power Supply
o
-48V ~ 5A will be sufficient
o Power Connectors
o
Good luck ;-)
o
The devices sometimes have strange plugs, so 
you might need some time to find or make them
o Stack of network cables
17
18
Our Lab 
Let‘s start
reconnaissance!
19
o
GPS
o
For timing or positioning (during setup)
o
EC
o
Equipment Control
o
AUX
o
Auxiliary Bus
o
LMT A
o
Local maintenance terminal A
o
LMT B
o
Local maintenance terminal B
o
TN A
o
Backhaul Access – S1
o IDL
o
Inter-DUL-Link
o TN B
o
Backhaul Access – S1
o A, B, C, D, E, F
o
Interfaces towards RRU
Ericsson RBS6601 - DUL
RJ-45 & Gbic Interfaces
20
The First Sniff 
21
Let‘s get Started!
o The most important interfaces of our setup:
o
Vlan 3: Signalling
o
Vlan 2: O&M
o You see a lot of traffic, the eNB is designed to
operate almost as standalone
 Not that many modifications needed
22
The Second Sniff
23
23
Attacking the BS
o Signalling Traffic
o Local Maintenance Interface
o Remote OAM Interface
o Physically
o Our goals: Understanding the device, configuration access and
finally – getting root
 Keep in mind: this is a real BTS like out in the field
24
The Transport Interface
Access to, or How to Build Your Own Provider Network
25
S1-Interface
o S1 interface is divided into two parts
o
S1-MME (Control Plane)
o Carries signalling messages between
base station and MME
o
S1-U (User Plane)
o Carries user data between base station
and Serving GW
X2
S1-MME
S1-U
26
S1-Interface
o After the host 10.27.99.169 on VLAN 2 
becomes available the eNodeB activates 
communication over the S1-Interface
o Using SCTP it tried to reach 7 different hosts 
by SCTP INIT request to establish a 
connection
27
From 3GPP TS 33.401
o
“In order to protect the S1 and X2 control plane as required by clause 5.3.4a, it is 
required to implement IPsec ESP according to RFC 4303 [7] as specified by TS 
33.210 [5]. For both S1-MME and X2-C, IKEv2 certificates based authentication 
according to TS 33.310 [6] shall be implemented”
o
“NOTE 1: In case control plane interfaces are trusted (e.g. physically protected), 
there is no need to use protection according to TS 33.210 [5] and TS 33.310 [6].”
o
“In order to protect the S1 and X2 user plane as required by clause 5.3.4, it is 
required to implement IPsec ESP according to RFC 4303 [7] as profiled by TS 
33.210 [5], with confidentiality, integrity and replay protection.”
o
“NOTE 2: In case S1 and X2 user plane interfaces are trusted (e.g. physically 
protected), the use of IPsec/IKEv2 based protection is not needed.” 
o
“In order to achieve such protection, IPsec ESP according to RFC 4303 [7] as 
profiled by TS 33.210 [5] shall be implemented for all O&M related traffic, i.e. the 
management plane, with confidentiality, integrity and replay protection.”
o
“NOTE 2: In case the S1 management plane interfaces are trusted (e.g. physically 
protected), the use of protection based on IPsec/IKEv2 or equivalent mechanisms is 
not needed.”
28
S1-AP
o S1 Application Protocol (S1AP), designed by 
3GPP for the S1 interface
o Specified in 3GPP TS36.413
o Necessary for several procedures between 
MME and eNodeB
o Also supports transparent transport procedures 