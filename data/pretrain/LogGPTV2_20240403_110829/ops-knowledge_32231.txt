User: How to use a third-party library in Python to send emails and add attachments?
Assistant: Use the smtplib library and email.mime.multipart library in Python to realize the functions of sending emails and adding attachments. 1. First, import the required libraries: ```python import smtplib from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.mime.application import MIMEApplication ``` 2. Create the mail object: `` `python msg = MIMEMultipart() msg['From'] = 'sender@example.com' msg['To'] = 'recipient@example.com' msg['Subject'] = 'This is the subject line' ` `` 3. Add message body: ```python body = 'This is the message body' msg.attach(MIMEText(body, 'plain')) ``` 4. Add attachment: ```python with open(' /path/to/attachment.pdf', 'rb') as f: attachment = MIMEApplication(f.read(), _subtype='pdf') attachment.add_header('Content-Disposition', 'attachment', filename=' attachment.pdf') msg.attach(attachment) ``` Here it is assumed that a PDF file named attachment.pdf is to be added as an attachment. 5. Create SMTP connection and send mail: ```python smtp_server = 'smtp.gmail.com' smtp_port = 587 username = 'sender@example.com' password = 'password' with smtplib.SMTP(smtp_server, smtp_port) as smtp : smtp.starttls() smtp.login(username, password) smtp.send_message(msg) ``` Here, it is assumed that Gmail is used as the mail server, and the SMTP server address, SMTP port number, sender email address and password are required. The complete code is as follows: ```python import smtplib from email.mime.multipart import MIMEMultipart from email.mime.text import MIMEText from email.mime.application import MIMEApplication msg = MIMEMultipart() msg['From'] = ' sender@example.com' msg['To'] = 'recipient@example.com' msg['Subject'] = 'This is the subject line' body = 'This is the message body' msg.attach(MIMEText(body , 'plain')) with open('/path/to/attachment.pdf', 'rb') as f: attachment = MIMEApplication(f.read(), _subtype='pdf') attachment.add_header('Content- Disposition', 'attachment', filename='attachment.pdf') msg.attach(attachment) smtp_server = 'smtp.gmail.com' smtp_port = 587 username = 'sender@example.com' password = 'password' with smtplib. SMTP(smtp_server, smtp_port) as smtp: smtp.starttls() smtp.login(username, password) smtp.send_message(msg) ``` Note that this is just a demonstration of using Gmail as the mail server. If you use other mail servers, You need to provide the corresponding SMTP address and port number. At the same time, the password provided in the code is not secure, please make sure to use a more secure way to store the password in actual use.