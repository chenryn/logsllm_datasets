detection by common AV products. Typically, targets receive
either (1) a PE in a .zip or .rar, (2) a ﬁle download link, or
(3) a link that will trigger a drive-by download. The messages
usually include text, often in Arabic, that attempts to persuade
the target to execute the ﬁle or click the link.
The ﬁrst attacks in Figure 3 date to 2012, and use bait ﬁles
with a DarkComet RAT payload. These attacks share the same
C&C, 216.6.0.28, a Syrian IP address belonging to the Syr-
ian Telecommunications Establishment, and publicly reported
as a C&C of Syrian malware since February 2012 [45]. The
ﬁrst bait ﬁle presents to the victim as a PDF containing infor-
mation about a planned uprising in Aleppo. In fact the ﬁle is a
Windows Screensaver (.scr) that masquerades as a PDF using
Unicode RLO, rendering a name such as “.fdp.scr” dis-
play to the victim as “.rcs.pdf.” The second bait ﬁle is
a dummy program containing DarkComet while masquerading
as a Skype call encryption program, playing to opposition para-
noia about government backdoors in common software. The
third attack in Figure 3, observed in October 2013, entices tar-
gets with e-mails purporting to contain or link to videos about
the current conﬂict, infecting victims with Xtreme RAT, and
using the C&C tn1.linkpc.net.
For seeding, the attackers typically use compromised ac-
counts (including those of arrested individuals) or fake iden-
tities masquerading as pro-opposition. Our illustration shows
in abstract terms the use of Victim A’s account to seed mal-
ware (“Aleppo Plan”) via (say) Skype messages to Victim(s)
Bn.
In the cases of Opp. Member C and NGO Worker
D (here, actual victims, not abstract), targeting was by e-mail
from domains apparently belonging to opposition groups, in-
dicating a potential compromise. One domain remains active,
hosting a website of the Salaﬁst Al-Nusra front [46], while the
other appears dormant. Opp. Member C received a malicious
ﬁle as an e-mail attachment, while NGO Worker D was sent a
shortened link (url[.]no/Uu5) to a download from a directory
of Mrconstrucciones[.]net,7 a site that may have been com-
promised. Both attacks resulted in an Xtreme RAT infection.
Interestingly,
in the case of the fake Skype encryption
the deception extended to a YouTube video from “IT Se-
curity Lab” [47] demonstrating the program’s purported ca-
pabilities, as well as a website promoting the tool, skype-
encryption.sytes.net. The attackers also constructed a ba-
sic, faux GUI for their “Encryption” program (see Figure 4).
The fake GUI has a number of non-functional buttons like “En-
crypt” and “DeCrypt,” which generate fake prompts. While dis-
tracted by this meaningless interaction, the victim’s machine is
infected with DarkComet 3.3 [32, 33].
Anecdotally, campaign volume appears to track signiﬁcant
7Obfuscated to avoid accidental clicks on active malware URLs.
516  23rd USENIX Security Symposium 
USENIX Association
6
USENIX Association  
23rd USENIX Security Symposium  517
TypeFeaturesExamples(RATs)SecuritytoolsExecutableﬁlespresentedasa“tool”oftenaccompaniedbyjustiﬁca-tionsorstatementsofitsvalueinthetargetedseeding,forexampleonasocialmediasite,atthedownloadlocation,orinvideos“SkypeEncryption”(DC)[32,33],“FacebookSecurity”(cus-tom)[34],Anti-hacker(DC)[35],FakeFreegateVPN(ST)[36]Ideologicallyormovement-relevantﬁlesAdocumentorPEasdownloadorattachmentwithaccompanyingen-couragementtoopenoractonthematerial,oftenmasqueradingaslegitimatePDFdocumentsorinadvertentlyleakedregimeprograms.FrequentuseofRLOtodisguisetrueextension(suchas.exeor.scr)“NamesofindividualswantedbytheRegime,”(DC)“Aleppo[uprising]Plan”(DC)[37],importantvideo(BS)[38],“HamaRebelsCouncil”document(DC)[39],“wantedpersons”databasefrontend(custom),movementrelevantvideo(njRAT),ﬁleabouttheFreeSyrianArmy(XtremeRAT)MiscellaneoustoolsToolspretendingtoofferfunctionalityrelevanttotheopposition,suchasafaketoolclaimingto“massreport”regimepagesonFacebookhackfacebookprov6.9(DC)[40]Table3:CampaignsandRATsemployedinSyriansurveillance.BS=Blackshades,DC=DarkComet,ST=Shad-owTech.Victim(s) BnAccount seeds“Aleppo Plan”ClicksfileArrestedAccount seeds“Aleppo Plan”CredentialsgainedDark CometSY Gov't216.6.0.28SY Malware ActorsOpp. Member Cfsa@freesyria.comE-MailXtreme RatNGO Worker Dmohamed@jalnosra.comE-Mail tn1.linkpc.netMrconstrucciones.netUrl.no“Aleppo Plan”fsa.zipVictim Askype-encription.sytes.net“Skype Encryption”Figure3:AsamplefromtheecosystemofSyrianmalwarecampaigns.eventsintheongoingconﬂict.Forexample,campaignsdwin-dledandthenreboundedwithinhoursafterSyria’s2012Inter-netshutdown[48].Similarly,activityobservedbytheauthorsalsodwindledpriortoexpectationofUS-ledmilitaryactionagainstSyriangovernmenttargetsinSeptember2013.Oncethisoptionappearedtobeoffthetable,thevolumeofnewsamplesandcampaignsweobservedagainincreased,includ-ingtherecenttargetingofNGOworkersperFigure3.WeareawareofonlyanegligiblenumberofcasesoftheoppositionusingsimilarRATsagainstSyrianGovernmentsupporters,al-thoughevidenceexistsofotherkindsofelectronicattacksbythirdparties.Realworldconsequences.ThelogisticsandactivitiesofSyria’snumerousoppositiongroupsareintentionallyconcealedfrompublicviewtoprotectboththeirefﬁcacy,andthelivesofpeopleparticipatinginthem.Nevertheless,Syrianoppositionmembersaregenerallyfamiliarwithstoriesoffdigitalcompro-misesofhigh-proﬁleﬁgures,includingthoseentrustedwiththemostsensitiveroles,aswellasrank-and-ﬁlemembers.Com-promiseofoperationalsecurityposesadocumentedthreattolifebothforvictimsofelectroniccompromise,andtofamilymembersandassociates.TheSyrianconﬂictisongoing,makingitdifﬁculttoassem-Figure4:ThefakeSkypeprogramdistractsthevictimwiththepromiseofencryptedcommunicationswhilein-fectingtheirmachinewithDarkComet.7518  23rd USENIX Security Symposium 
USENIX Association
blecomprehensiveevidenceoflinkagesbetweengovernmentactorsandmalwarecampaigns.Moreover,manyindividualswhoseidentitieshavebeencompromisedareinprisonoroth-erwisedisappeared,andthusunabletorelatetheevidencepre-sentedtothemduringinterrogation.Still,strongcircumstantialevidencelinkstheuseofRATs,phishing,andgovernmentac-tivity,whichwebrieﬂysummarizehere:(1)manySyrianshaverecountedtojournalistsandtheauthorshowinterrogatorscon-frontedthemwithmaterialfromtheircomputers.Forexample:Thepolicemantoldme,“Doyourememberwhenyouweretalkingtoyourfriendandyoutoldhimyouhadsomethingwrong[sic]andpaidalotofmoney?Atthattimeweweretakinginformationfromyourlaptop.”[41](2)Syrianactivistshavesuppliedcasestointernationaljournal-ists[41],wherearrestsarequicklyfollowedbythesocialme-diaaccountsofdetainedindividualsseedingmalwaretocontactlists(Figure3).(3)Finally,despitethenotorietyoftheattackcampaigns,includingmentionofC&CIPsininternationalme-dia[45],theSyriangovernmenthasmadenopublicstatementsaboutthesecampaignsnoractedtoshutdowntheservers.Beyondtheongoingchallengesofattribution,thesemalwarecampaignshaveatangibleimpactontheSyrianopposition,andgenerallyalignwiththeinterestsoftheSyriangovernment’spropagandaoperations.ThecaseofAbdulRazzaqTlass,aleaderintheFreeSyrianArmy,isillustrativeofthepotentialusesofsuchcampaigns.In2012astringofvideosemergedshowingTlasssextingandengagedinlewdactivityinfrontofawebcam[49].Whilehedeniedthevideos,theharmtohisrep-utationwassubstantialandhewaseventuallyreplaced[50].4.3UAEWhiletheUAEhasexperiencednorecentuprisingorpoliti-calunrest,ithasneverthelesscrackeddownonitsopposition,concurrentwiththeArabSpring.TheﬁrstattacksweobservedintheUAEinvolvedagovernment-grade“lawfulinterception”trojanknownasRe-moteControlSystem(RCS),soldbytheItaliancompanyHack-ingTeam.TheassociatedC&CserverindicateddirectUAEgovernmentinvolvement.Overtime,westoppedreceivingRCSsamplesfromUAEtargets,andinsteadobservedashifttotheuseofoff-the-shelfRATs,andpossibleinvolvementofcyber-mercenarygroups.However,poorattackeroperationalsecurityallowedustolinkmostobservedattackstogether.RCS.UAEactivistAhmedMansoor(perFigure5),impris-onedfromApriltoNovember2011aftersigninganonlinepro-democracypetition[51],receivedane-mailpurportedlyfrom“ArabicWikileaks”inJuly2012.Heopenedtheassociatedat-tachment,“veryimportant.doc,”andsawwhathedescribedas“scrambledletters”.Heforwardedusthee-mailforinvestiga-tion.TheattachmentexploitedCVE-2010-3333,anRTFpars-ingvulnerabilityinMicrosoftOfﬁce.Thedocumentdidnotcontainanybaitcontent,andpartofthemalformedRTFthattriggeredtheexploitwasdisplayedinthedocument.Theexploitloadedshellcodethatdownloadedasecondstage3-StageExploit Kitowner.no-ip.bizXtreme RATRCSLaptopinfectedCommunicatedvia E-MailAhmedAuthor“wikileaks”“veryimportant”UAE Gov'tHackingTeamE-Mail accountcompromisedar-24.comCVE-2010-3333Figure5:PartoftheecosystemofUAEsurveillanceat-tacks.fromar-24.com,whichinturndownloadedspywarefromar-24.com.Wedenotethiscombinationasthe3-StageEx-ploitKitinFigure5.TheC&Cserveralsoranonar-24.com.Whenweob-tainedthesampleinJuly2012,ar-24.comresolvedtoanIPaddressonLinode,ahostingprovider.Threemonthslater,itresolvedtoaUAEaddressbelongingtotheRoyalGroup[52],anorganizationlinkedtotheUAEgovernment;itischairedbySheikhTahnoonbinZayedAl-Nayhan,amemberoftheUAErulingfamilyandasonofthefounderoftheUAE.IdentiﬁcationasRCS:WeidentiﬁedstringsinmemorythatmatchedthoseinaSymantecanalysis[53]ofRCS(alsoknownasDaVinciorCrisis),aproductoftheItaliancom-panyHackingTeam[54].Wealsolocatedastructurallysim-ilarWorddocumentviaVirusTotal.Thedocumentusedthesameexploitandattemptedtodownloadasecondstagefromrcs-demo.hackingteam.it,whichwasunavailableatthetimeoftesting.Analysisofcapabilities:RCShasasuiteoffunctionalitylargelysimilartoFinSpy.Onedifferencewasinthevectorsusedtoinstallthespyware.Welocatedadditionalsamples(see§5),someofwhichwereembeddedina.jarﬁlethatinstallsanOS-appropriateversionofRCS(WindowsorOSX),option-allyusinganexploit.Ifembeddedasanapplet,andnoexploitispresent,Javadisplaysasecuritywarningandaskstheuserwhethertheyauthorizetheinstallation.Wealsosawinstancesofthe3-StageExploitKitwheretheﬁrststagecontainedaFlashexploit;insomecases,wecouldobtainallstagesandconﬁrmthattheseinstalledRCS.SomesampleswerepackedwiththeMPresspacker[55],andsomeWindowssampleswereobfuscatedtolooklikethePuTTYSSHclient.Anotherdifferenceisinpersistence.Forexample,theRCSsamplesenttoAhmedaddsaRunregistrykey,whereastheFinSpysamplesusedinBahrainoverwritetheharddisk’sbootsectortomodifythebootprocess;thespywareisloadedbe-8USENIX Association  
23rd USENIX Security Symposium  519
foretheOS,andinjectsitselfintoOSprocessesastheystart.TheRCSsamplesweexaminedalsohadtheabilitytopropa-gatetootherdevices,includingintoinactiveVMWarevirtualmachinesbymodifyingthediskimage,ontoUSBﬂashdrives,andontoWindowsMobilephones.WedidnotobservesimilarcapabilitiesintheFinSpysamplesweexamined.Exploitationofcaptureddata:WhenAhmedMansoorre-ceivedtheRCSdocument,heopenedit,infectinghiscomputer(Figure5).Ahmedsubsequentlynotedseveralsuspiciousac-cessestohisGMailaccountusingIMAP.Evenafterhechangedhispassword,theaccessescontinued.WhilecorrespondingwithAhmedonhiscompromisedaccount,anauthorofthispa-perdiscoveredthattheattackershadinstalledanapplication-speciﬁcpassword[56]inAhmed’sGMailaccount,asecondarypasswordthattheyapparentlyusedtoaccesshisaccountevenafterhechangedhismainpassword.Thesuspiciousaccessesstoppedafterremovaloftheapplication-speciﬁcpassword.TwoweeksafterthiscorrespondencewithAhmed,oneofus(AuthorinFigure5)receivedatargetede-mailwithalinktoaﬁlehostedonGoogleDocscontainingacommercialoff-the-shelfRAT,XtremeRAT.Thee-mailwassentfromtheUAE’stimezone(aswellasofothercountries)andcontainedtheterms“veryimportant”and“wikileaks”,justlikeinthee-mailre-ceivedbyAhmed.TheinstanceofXtremeRATsenttoAuthorusedowner.no-ip.bizforitsC&C,oneofthedomainsmen-tionedinareportpublishedbyNormanaboutayear-longcam-paignofcyberattacksonIsraeliandPalestiniantargetscarriedoutbyagroupthatNormanwasunabletoidentify[57].ThreemonthsafterAuthorwastargeted,Ahmedreceivedane-mailcontaininganattachmentwithXtremeRATthattalkedtothesameC&Cserver(Figure5),suggestingthattheattackerswhoinfectedAhmedwithRCSmayhaveprovidedalistofinterest-inge-mailaddressestoanothergroupforfurthertargeting.Possibleconsequences:Shortlyafterhewastargeted,AhmedsayshewasphysicallyassaultedtwicebyanattackerwhoappearedabletotrackAhmed’slocation[58].Healsore-portsthathiscarwasstolen,alargesumofmoneydisappearedfromhisbankaccount,andhispassportwasconﬁscated[59].Hebelievestheseconsequencesarepartofagovernmentin-timidationcampaignagainsthim,butwedidnotuncoveranydirectlinkstohisinfection.(Interestingly,spywaresubse-quentlysenttoothershasusedbaitcontentaboutAhmed.)Furtherattacks:InOctober2012,UAEJournalistAandHumanRightsactivistB(perFigure6)forwardedussuspi-ciouse-mailstheyhadreceivedthatcontainedaWorddocu-mentcorrespondingtotheﬁrststageof3-StageExploitKit(Figure5).TheattachmentcontainedanembeddedFlashﬁlethatexploitedavulnerabilityﬁxedinAdobeFlash11.4,loadingshellcodetodownloadasecondstagefromfaddeha.com.Wewereunabletoobtainthesecondstageortheultimatepay-load,asthewebsitewasunavailableatthetimeoftesting.However,theexploitkitappearsindicativeofHackingTeaminvolvement.Apageonfaddeha.comfoundinGoogle’scachecontainedanembedded.jarwiththesameappletclass(WebEnhancer)asthoseobservedinother.jarﬁlesthatwefoundtocontainRCS.Same IPHosts sample thattalks to C&CUsed by samplethat talks to C&Cdreems.no-ip.caupload.bzhamas.sytes.netfaddeha.comsn.all-google.comSpyNetCVE-2013-0422njRATstorge.myftp.orgVB PackerDarkCometCVE 2012-0158H.R. activist EJournalist CJournalist FJournalist A,H.R. activist BRelative ofpolitical detainee DAppinSameIP1 SameIP1 njq8Figure6:AnotherpartoftheecosystemofUAEsurveil-lanceattacks.Off-the-shelfRATs.WefoundaﬁlethatVirusTotalhaddownloadedfromfaddeha.com,whichappearedtobeare-moteaccesstoolkitknownasSpyNet,availableforgeneralpur-chasefor50Euros[60].TheSpyNetsamplecommunicatedwiththeC&Chamas.sytes.net.SpyNetPacking:Wefoundanotherinstanceoftheﬁrststageofthe3-StageExploitKitonVirusTotal.Theexploitdownloadedasecondstage,whichinturndownloadedasam-pleofSpyNetfrommaile-s.com.ThissampleofSpyNetcommunicatedwiththesameC&Chamas.sytes.net.ThesamplewaspackedusingASProtect[61].Whenrun,thesampleunpacksacompiledVisualBasicprojectthatloads,viatheRunPEmethod[62],anexecutablepackedwithUPX[63].Finally,thisexecutableunpacksSpyNet.SpyNet’sGUIonlyoffersanoptiontopackwithUPX,suggestingthattheattack-ersspeciallyaddedtheotherlayersofpacking.Insomecases,theVisualBasicprojectbearsthenameNoWayTech,whichappearstobeanundergroundRunPEtool,whileothersarenamedSpyVisual,whichwehavebeenunabletotracetoanypublicundergroundtools,andthusalsomayreﬂectcustomiza-tionbytheattacker.TheSpyVisualprojectscontainthestringc:\Users\Zain\AppData\Local\Temp\OLE1EmbedStrm.wav,whichweusedastheﬁngerprintVBPackerinFigure6.CedarKeyattack:ThesameVBPackerwasusedinanattackonRelativeofpoliticaldetaineeDandH.R.activistEinFigure6.Theseindividualsreceivede-mailscontainingalinktoawebpagehostedoncedarkeyrv.comimpersonat-ingYouTube.Loadingthepagegreetedthetargetwith“Videoloadingpleasewait...”ThepageredirectedtoaYouTubevideoafewsecondslater,butﬁrstloadedaJavaexploit[64]—a9known vulnerability with no patch at the time that the e-mails
were sent. Oracle released a patch 12 hours after activists began
receiving these links.
The cedarkeyrv.com domain is associated with an RV
park in Cedar Key, Florida. The website’s hosting company
told us that the site had apparently suffered a compromise, but
did not have further details.
The exploit used in the attack appears to have been origi-
nally posted by a Kuwaiti user, njq8, on an Arabic-language
exploit sharing site [65]. We contacted njq8, who told us
that he had obtained the exploit elsewhere and modiﬁed it
prior to posting.
The attack downloaded an instance of
SpyNet from isteeler.com (which from our inspection did
not appear to have any legitimate content), which used the
C&C storge.myftp.org. This same C&C occurred in an-
other attack (Figure 6) targeting Relative of political detainee
D; in that case, the payload was a freely-available RAT known
as njRAT, written by the same njq8 as the exploit-poster dis-
cussed above. However, we did not ﬁnd any other evidence
suggesting njq8’s involvement in either attack.
resolved
to 67.205.79.177.
More SpyNet attacks: The domain hamas.sytes.net,
sam-
which we previously saw used by two SpyNet
ples,
Historically,
dreems.no-ip.ca also resolved to this address. An
unidentiﬁed dropper using this C&C targeted Journalist F; a
SpyNet attack on Relative of political detainee D also used
this C&C. In that latter case, the sample arrived via e-mail
in a .rar attachment that contained an .scr ﬁle disguised
as a Word document. The .scr ﬁle was a self-extracting
archive that decompressed and ran both the bait document
and the payload.
The SMTP source of the e-mail was
webmail.upload.bz.
Appin: In early 2013 UAE H.R. activist E forwarded nu-
merous documents that included a particular CVE-2012-0158
exploit for Microsoft Word.
In all, these totaled 17 distinct
hashes of documents, and 10 distinct hashes of payloads (some
documents that differed in their hash downloaded the same pay-
load). The exploits primarily downloaded instances of SpyNet
from upload.bz, which for the most part communicated
with C&C at sn.all-google.com. This domain was also
used for C&C in other attacks, including that on Journalist C.
the other CVE-2012-0158 exploits down-
loaded DarkComet
and
www.technopenta.com after posting system infor-
mation to random123.site11.com. All three domains
match those used by an Indian cybermercenary group said
The former
to be linked to Appin Security Group [66].
two domains hosted content other than spyware (i.e.,
they
may have been compromised). We alerted the owner of
www.getmedia.us, who removed the payloads.
from www.getmedia.us
Two of
5 Empirical characterization
The samples we received afforded us an opportunity to em-
pirically characterize the use of FinFisher and Hacking Team
around the world, enabling us to assess their prevalence, and
identify other country cases that may warrant future investiga-
tion. We analyzed the samples and the behavior of their C&C
servers to develop indicators (ﬁngerprints) for how the servers
respond to certain types of requests. We then scanned the full
Internet IPv4 address space (“/0”) for these, along with prob-
ing results found by past scans. In many cases we do not release
the full details of our ﬁngerprints to avoid compromising what
may be legitimate investigations.
5.1 FinSpy
Identifying and linking servers: We developed a number
of ﬁngerprints for identifying FinSpy servers using HTTP-
based probing as well as FinSpy’s custom TLV-based proto-
col. We leveraged quirks such as speciﬁc non-compliance
with RFC 2616, responses to certain types of invalid data,
and the presence of signatures such as the bizarre “Hallo
Steffi” that Guarnieri identiﬁed from Bahraini FinSpy C&C
servers [67, 68]. See Appendix A for details. We then exhaus-
tively scanned the Internet looking for matches to these ﬁnger-
prints.
Gamma documentation advertises that an operator of FinSpy
can obscure the location of the C&C server (called the mas-
ter) by setting up a proxy known as a relay. In Spring 2013
we noticed FinSpy servers now issuing 302 Redirects to
google.com. However, we noticed anomalies:
for ex-
ample, servers in India were redirecting to the Latvian ver-
sion of Google google.lv. We suspect that the server
in India was a relay forwarding to a master in Latvia. Be-
cause the master served as a proxy for Google, we could
uncover its IP address using a Google feature that prints a
user’s IP address for the query “IP address.” We created an
additional ﬁngerprint based on the proxying behavior and is-
sued GET /search?q=ip+address&nord=1 requests to
servers We note some interesting master locations in Table 4.
Server locations: In all, our ﬁngerprints matched 92 dis-
tinct IP addresses in 35 different countries. Probing these on
8/8/13 revealed 22 distinct addresses still responding, sited
in: Bahrain, Bangladesh, Bosnia and Herzegovina, Estonia,
Ethiopia, Germany, Hong Kong, Indonesia, Macedonia, Mex-
ico, Romania, Serbia, Turkmenistan, and the United States. We
found servers responding to a number of our ﬁngerprints, sug-
gesting either that some servers lag in their updates, or a con-
certed effort to vary the behavior of FinSpy servers to make
detection harder.
We found: (1) 3 IP addresses in ranges registered to Gamma.
(2) Servers in 3 IP ranges explicitly registered to govern-
ment agencies: Turkmenistan’s Ministry of Communications,
Qatar’s State Security Bureau, and the Bulgarian Council of
(3) 3 additional IP addresses in Bahrain, all in
Ministers.
Batelco. (4) Servers in 7 countries with governments classiﬁed
as “authoritarian regimes” by The Economist [69]: Bahrain,
Ethiopia, Nigeria, Qatar, Turkmenistan, UAE, Vietnam.
Additional FinSpy samples: In parallel to our scanning,
we obtained 9 samples of FinSpy by writing YARA [70] rules
for the “malware hunting” feature of VirusTotal Intelligence.
This feature sends us all newly-submitted samples that match
our signatures. We located a version of FinSpy that does not
use the normal FinSpy handshake, but instead uses a protocol
based on HTTP POST requests for communication with the
C&C server. This did not appear to be an older or newer ver-
520  23rd USENIX Security Symposium 
USENIX Association
10
Relay Block Assignment
Relay IP
SynWebHost
5.199.xxx.xxx
UK2 VPS.net
46.23.xxx.xxx
HostGator
119.18.xxx.xxx
Asia Web Services
180.235.xxx.xxx
GPLHost
182.54.xxx.xxx
206.190.xxx.xxx WestHost
Softlayer
206.190.xxx.xxx
Endurance International
209.59.xxx.xxx
Endurance International
209.59.xxx.xxx
Relay Country Master IP
Lithuania
UK
India
Hong Kong
Australia
USA
USA
USA
USA
188.219.xxx.xx
78.100.xxx.xxx
81.198.xxx.xxx
80.95.xxx.xxx
180.250.xxx.xxx
112.78.xxx.xxx
197.156.xxx.xxx
59.167.xxx.xxx
212.166.xxx.xxx
Master Block Assignment Master Country
Vodafone
State Security Building
Statoil DSL
T-Systems
PT Telekom
Biznet ISP
Ethio Telecom
Internode
Vodafone
Italy
Qatar
Latvia
Czech Republic
Indonesia
Indonesia
Ethiopia
Australia
Spain
Table 4: Deproxifying FinSpy (mapping initial C&C IP addresses to the masters to which they forward).
sion of the protocol, suggesting that our scan results may not
reveal the full scope of FinSpy C&C servers.
Perhaps, the
HTTP POST protocol was only delivered to a speciﬁc Gamma
customer to meet a requirement.
5.2 Remote Control System (RCS)
We began by analyzing the UAE RCS sample from Ahmed and
6 samples obtained from VirusTotal by searching for AV re-
sults containing the strings “DaVinci” and “RCS.” At the time,
several AV vendors had added detection for RCS based on a
sample analyzed by Dr. Web [71] and the UAE RCS sample
sent to Ahmed. We also similarly obtained and analyzed sam-
ples of FSBSpy [72], a piece of malware that can report system
information, upload screenshots, and drop and execute more
malware, Based on these samples, we devised YARA signa-
tures that yielded 23 additional samples of structurally similar
malware.
Fingerprints: We probed the C&C servers of the RCS and
FSBSpy samples, and found that they responded in a distinc-
tive way to HTTP requests, and returned distinctive SSL cer-
tiﬁcates.
We searched sources including Shodan, 5 Internet Census
service probes [73], and Critical.IO scanning data [68] for the
observed distinctive HTTP behavior. We searched for the dis-
tinctive SSL certiﬁcates in two Internet Census service probes,