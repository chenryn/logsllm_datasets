ing itself cannot make any avoidance guarantees for users
within a censored regime.
We believe, however, that Alibi Routing complements the
others well. For example, consider Tor [10], in which a
source chooses a set of relay nodes and constructs a virtual
circuit through them. These relays are typically chosen at
random, but doing so can result in two consecutive relays
whose trafﬁc transits a censoring regime. Alibi Routing can
be applied to Tor’s relay selection to compute which circuits
provably avoid known censors. Alibi Routing also composes
well with decoy routing: one could for instance use decoy
routing to get out of a censored regime, and Alibi Routing to
avoid others further down the path. These are but brief de-
sign sketches, but they demonstrate Alibi Routing’s potential
for composing with prior work.
Inﬂuencing underlay paths with overlay routes. Overlay
routing protocols, such as RON [3] and SOSR [15], demon-
strate that overlay paths can be used to inﬂuence and im-
prove upon the underlay paths that packets take. A natural
approach would be to use overlay routing to ﬁnd a path that
avoids a censor—much like how SOSR uses one-hop relays
to avoid slow parts of the network. This is in essence the
approach we take, but the primary challenges are in prov-
ing when a relay avoids a part of the network, and ﬁnding
relays who can achieve such proof. To meet this goal, our
overlay routing techniques exploit the connection between
geographic distance and latencies.
Other systems incorporate latency measurements into over-
lay routing [25, 36, 44]. Meridian [44] is an unstructured
overlay system that iteratively uses latency measurements to
perform a set of queries, such as nearest-neighbor search
and leader election.
It may be possible to achieve some
form of avoidance routing with Meridian, for instance as
a sort of “nearest-but-not-too-near” neighbor search. How-
ever, Meridian is not designed to operate in an adversarial
setting, and, unfortunately, it is straightforward for an at-
tacker to appear to be “not too near” by fabricating higher
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1-0.4-0.2 0 0.2 0.4 0.6 0.8 1CDFLatency inflation factorδ=0.0δ=0.5δ=1.0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1-0.4-0.2 0 0.2 0.4 0.6 0.8 1CDFLatency inflation factorδ=0.0δ=0.5δ=1.0622RTTs. We believe that the mechanisms we present in this
paper can be generally applied in securing these systems.
Geographic routing. Geographic routing protocols incor-
porate the location of nodes in their routing decisions [20,
32, 23], as does Alibi Routing. The typical approach to geo-
graphic routing is to apply a greedy heuristic which attempts
to move as close to the target as possible at each hop. This
is similar to Alibi Routing’s use of target regions, but we are
not aware of any geographic routing protocol that achieves
avoidance in an adversarial setting.
In such a setting, ap-
plying a greedy heuristic can, in the worst case, traverse the
forbidden region; even when the heuristic is safe, it may end
up forwarding it to a node who is just outside the border of
the forbidden country. Alibi Routing shows that progress
and safety must be balanced to achieve high query success
rate; we believe these lessons can apply to other geographic
routing protocols, as well.
Accountability and provenance. A tempting way to prove
what routers did not do is to exhaustively prove what actions
they did take. There is a wealth of prior work on holding
participants in a network accountable for the actions they
did take [2, 16, 50]. For instance, PeerReview [16] assigns
“witnesses” to each participant, which monitor all incoming
and outgoing messages, and emulate the protocol to ensure
that the participant behaved correctly. More recent ﬁndings
apply counterfactual reasoning to observations about the net-
work to achieve “negative provenance:” attributing a set of
(in)actions led to the absence of an expected event [45].
Unfortunately, it is not clear how to apply these approaches
to solve the problem of provable route avoidance; it would
appear to require witnesses to be able to verify latency mea-
surements (which does not seem possible in general settings,
but would be an interesting area of future work).
Alibi Routing’s light-weight proof structure can be per-
formed using only local observations. We believe our “proof
by alibi” can be combined with both positive and negative
provenance systems to yield a broader set of inferences.
8. CONCLUSION
This paper introduces a primitive, provable avoidance rout-
ing, that, when given a destination and region to avoid, pro-
vides “proof” after the fact that a packet and its response did
not traverse the forbidden region. We rely on the insight that
a packet could provide an “alibi”—a place and time where it
was—to prove that it must have avoided the forbidden region
in transit from source to destination.
To demonstrate the feasibility of implementing this prim-
itive, we have developed and evaluated an overlay routing
protocol, Alibi Routing. Alibi Routing assumes that nodes
outside the forbidden region are trustworthy in reporting their
geographic locations and in vouching for neighbors that are
too nearby to be in the forbidden region. It leverages this
assumption to direct relay discovery queries toward a target
region in which alibis might reside.
Our empirical results show that Alibi Routing is effective
at ﬁnding alibis for a range of forbidden countries. How-
ever, Alibi Routing is not a panacea; primarily, it is unable
to assist hosts who are very close to (or, of course, inside of)
the regions they seek to avoid. But because its properties are
largely orthogonal to prior work, we believe that Alibi Rout-
ing will compose well with them to strengthen their security
guarantees. Moreover, we believe the techniques we have
introduced can be applied to myriad other domains.
There are several possible extensions to Alibi Routing.
Allowing routes through more than one relay could poten-
tially improve Alibi Routing’s success rates; discovering multi-
relay paths and generating proof that they collectively avoid
a forbidden region is an interesting area of future work.
Our implementation and data are publicly available at:
https://alibi.cs.umd.edu
Acknowledgments
We thank the anonymous reviewers and our shepherd, Xi-
aowei Yang, for their helpful comments. We also thank
Brendan Rowan for his help in developing an earlier ver-
sion of the Alibi Routing protocol, and Dave Mount for his
helpful guidance on computing target regions. Finally, we
thank Brandi Adams for coming up with the name “Alibi
Routing.” This research was supported in part by NSF grant
IIS-0964541, ONR grant N00173-13-1-G001, and an Ama-
zon Web Services in Education grant.
9. REFERENCES
[1] S. Agarwal and J. R. Lorch. Matchmaking for online games
and other latency-sensitive P2P systems. In ACM
SIGCOMM, 2009.
[2] D. G. Andersen, H. Balakrishnan, N. Feamster, T. Koponen,
D. Moon, and S. Shenker. Accountable Internet Protocol
(AIP). In ACM SIGCOMM, 2008.
[3] D. G. Andersen, H. Balakrishnan, M. F. Kaashoek, and
R. Morris. Resilient overlay networks. In ACM Symposium
on Operating Systems Principles (SOSP), 2001.
[4] Anonymous. The collateral damage of Internet censorship by
DNS injection. ACM SIGCOMM Computer Communication
Review (CCR), 42(3):21–27, 2012.
[5] Anonymous. Towards a comprehensive picture of the Great
Firewall’s DNS censorship. USENIX Workshop on Free and
Open Communications on the Internet (FOCI), 2014.
[6] ARRL. The ARRL Handbook for Radio Communications.
The ARRL, 89th edition, 2012.
[7] S. Aryan, H. Aryan, and J. A. Halderman. Internet censorship
in Iran: A ﬁrst look. In USENIX Workshop on Free and Open
Communications on the Internet (FOCI), 2013.
[8] I. Clarke, O. Sandberg, B. Wiley, and T. W. Hong. Freenet: A
distributed anonymous information storage and retrieval
system. In Designing Privacy Enhancing Technologies:
Workshop on Design Issues in Anonymity and
Unobservability, pages 46–66, July 2000.
[9] B. Cohen. Incentives build robustness in BitTorrent. In
Workshop on Economics of Peer-to-Peer Systems (P2PEcon),
2003.
[10] R. Dingledine, N. Mathewson, and P. Syverson. Tor: The
second-generation onion router. In USENIX Security, 2004.
[11] N. Feamster, M. Balazinska, G. Harfst, H. Balakrishnan, and
D. Karger. Infranet: Circumventing censorship and
surveillance. In USENIX Security, 2002.
623[12] R. Feynman, R. Leighton, and M. Sands. The Feynman
Lectures on Physics Vol. 1. (Chapter 26). Addison-Wesley,
1963.
[13] Global Administrative Areas (GADM) Database.
http://www.gadm.org.
[14] P. B. Godfrey, I. Ganichev, S. Shenker, and I. Stoica. Pathlet
Routing. In ACM SIGCOMM, 2009.
[15] K. Gummadi, H. Madhyastha, S. D. Gribble, H. M. Levy, and
D. J. Wetherall. Improving the reliability of Internet paths
with one-hop source routing. In Symposium on Operating
Systems Design and Implementation (OSDI), 2004.
[16] A. Haeberlen, P. Kuznetsov, and P. Druschel. PeerReview:
Practical accountability for distributed systems. In ACM
Symposium on Operating Systems Principles (SOSP), 2007.
[17] A. Houmansadr, G. T. K. Nguyen, M. Caesar, and
N. Borisov. Cirripede: Circumvention infrastructure using
router redirection with plausible deniability. In ACM
Conference on Computer and Communications Security
(CCS), 2011.
[18] J. Karlin, D. Ellard, A. W. Jackson, C. E. Jones, G. Lauer,
D. P. Mankins, and W. T. Strayer. Decoy routing: Toward
unblockable Internet communication. In USENIX Workshop
on Free and Open Communications on the Internet (FOCI),
2011.
[19] J. Karlin, S. Forrest, and J. Rexford. Nation-state routing:
Censorship, wiretapping, and BGP.
http://arxiv.org/pdf/0903.3218.pdf, Mar. 2009.
[20] B. Karp and H. T. Kung. GPSR: greedy perimeter stateless
routing for wireless networks. In ACM Conference on Mobile
Computing and Networking (MobiCom), 2000.
[21] E. Katz-Bassett, C. Scott, D. R. Choffnes, Ítalo Cunha,
V. Valancius, N. Feamster, H. V. Madhyastha, T. Anderson,
and A. Krishnamurthy. LIFEGUARD: Practical repair of
persistent route failures. In ACM SIGCOMM, 2012.
[22] T. H.-J. Kim, C. Basescu, L. Jia, S. B. Lee, Y.-C. Hu, and
A. Perrig. Lightweight Source Authentication and Path
Validation. In ACM SIGCOMM, 2014.
[23] E. Kline and P. Reiher. Securing data through avoidance
routing. In New Security Paradigms Workshop (NSPW),
2009.
[24] D. Levin, A. Bender, C. Lumezanu, N. Spring, and
B. Bhattacharjee. Boycotting and extorting nodes in an
internetwork. In Joint Workshop on the Economics of
Networked Systems and Incentive-Based Computing
(NetEcon+IBC), 2007.
[25] C. Lumezanu, R. Baden, D. Levin, B. Bhattacharjee, and
N. Spring. Symbiotic relationships in Internet routing
overlays. In USENIX Symposium on Networked Systems
Design and Implementation (NSDI), 2009.
[26] MaxMind, Inc.
http://dev.maxmind.com/geoip/legacy/geolite/.
[27] S. J. Murdoch and P. Zieli´nski. Sampled trafﬁc analysis by
Internet-exchange-level adversaries. In Workshop on Privacy
Enhancing Technologies (PET), 2007.
[28] J. Naous, M. Walﬁsh, A. Nicolosi, M. Miller, and A. Seehra.
Verifying and enforcing network paths with ICING. In ACM
Conference on emerging Networking EXperiments and
Technologies (CoNEXT), 2011.
[29] J. A. Obar and A. Clement. Internet surveillance and
boomerang routing: A call for Canadian network
sovereignty. Online:
http://ssrn.com/abstract=2311792, 2013.
[30] V. Paxson. End-to-End Routing Behavior in the Internet. In
ACM SIGCOMM, 1996.
[31] J. Postel. Internet Protocol. IETF RFC-791, Sept. 1981.
[32] J. Preethi and R. Sumathi. An energy efﬁcient on-demand
routing by avoiding voids in wireless sensor network. In
Internation Conference on Information Systems Design and
Intelligent Applications (INDIA), 2012.
[33] C. Reis, S. D. Gribble, T. Kohno, and N. C. Weaver.
Detecting in-ﬂight page changes with web tripwires. In
USENIX Symposium on Networked Systems Design and
Implementation (NSDI), 2008.
[34] Reporters Without Borders. Enemies of the internet 2013,
report. http://surveillance.rsf.org/en/
wp-content/uploads/sites/2/2013/03/
enemies-of-the-internet_2013.pdf, Mar. 2013.
[35] E. Rosen, A. Viswanathan, and R. Callon. Multiprotocol
label switching. IETF RFC-3031, Jan. 2001.
[36] S. Savage, T. Anderson, A. Aggarwal, D. Becker,
N. Cardwell, A. Collins, E. Hoffman, J. Snell, A. Vahdat,
G. Voelker, and J. Zahorjan. Detour: Informed Internet
routing and transport. IEEE Micro, 19(1):50–59, 1999.
[37] M. Schuchard, J. Geddes, C. Thompson, and N. Hopper.
Routing around decoys. In ACM Conference on Computer
and Communications Security (CCS), 2012.
[38] J. Seibert, S. Becker, C. Nita-Rotaru, and R. State. Securing
virtual coordinates by enforcing physical laws. In
International Conference on Distributed Computing Systems
(ICDCS), 2012.
[39] R. Sherwood, B. Bhattacharjee, and R. Braud. Misbehaving
TCP receivers can cause Internet-wide congestion collapse.
In ACM Conference on Computer and Communications
Security (CCS), 2005.
[40] R. Sherwood, B. Bhattacharjee, and A. Srinivasan. P5: A
protocol for scalable anonymous communication. Journal of
Computer Security, 13(6):839–876, 2005.
[41] A. Singh, M. Castro, P. Druschel, and A. Rowstron.
Defending against eclipse attacks on overlay networks. In
Proc. of ACM SIGOPS European Workshop, 2004.
[42] G. Varghese. Network Algorithmics: An Interdisciplinary
Approach to Designing Fast Networked Devices. Morgan
Kaufmann, 2004.
[43] G. Wang and T. E. Ng. Distributed algorithms for stable and
secure network coordinates. In ACM Internet Measurement
Conference (IMC), 2008.
[44] B. Wong, A. Slivkins, and E. G. Sirer. Meridian: A
lightweight network location service without virtual
coordinates. In ACM SIGCOMM, 2005.
[45] Y. Wu, M. Zhao, A. Haeberlen, W. Zhou, and B. T. Loo.
Diagnosing Missing Events in Distributed Systems with
Negative Provenance. In ACM SIGCOMM, 2014.
[46] E. Wustrow, S. Wolchok, I. Goldberg, and J. A. Halderman.
Telex: Anticensorship in the network infrastructure. In IFIP
International Information Security and Privacy Conference
(SEC), 2011.
[47] X. Yang, D. Clark, and A. W. Berger. NIRA: A New
Inter-Domain Routing Architecture. IEEE/ACM
Transactions on Networking (ToN), 15(4):775–788, 2007.
[48] X. Yang and D. Wetherall. Source Selectable Path Diversity
via Routing Deﬂections. In ACM SIGCOMM, 2006.
[49] X. Zhang, H.-C. Hsaio, G. Hasker, H. Chan, A. Perrig, and
D. G. Andersen. SCION: Scalability, Control and Isolation
On Next-Generation Networks. In IEEE Symposium on
Security and Privacy, 2011.
[50] M. Zhao, W. Zhou, A. J. T. Gurney, A. Haeberlen, M. Sherr,
and B. T. Loo. Private and veriﬁable interdomain routing
decisions. In ACM SIGCOMM, 2012.
624