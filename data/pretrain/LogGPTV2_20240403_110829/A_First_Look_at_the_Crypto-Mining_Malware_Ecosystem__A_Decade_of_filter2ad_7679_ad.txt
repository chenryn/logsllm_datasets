10
Fig. 5: Number of different mining pools used by the cam-
paigns grouped by earnings.
mining pools instead of “solo-mining strategies” has several
advantages: it increases the chances of receiving payments
for mining and reduces the need for specialized mining
equipment. Selecting a mining pool is not straightforward
because it depends on many dynamic factors such as the
current hashrate of the pool, or the complexity required for
mining. Pools with a high number of workers are more likely
to mine a block faster, but the reward received is lower. To
understand the popularity of the different mining pools among
criminals, we look at the number of wallets and the amount
of XMR mined over the most consolidated pools (according
to various benchmarks such as http://moneropools.com, or
https://minexmr.com/pools.html) that provide public informa-
tion about
the wallets. Table VII provides a list of these
pools ranked by popularity among criminals (in terms of
earnings). We show that the most popular pools are crypto-
pool and dwarfpool, with more than 429K and 168K XMR
mined respectively. When looking at the number of wallets
observed, the most common pool used is minexmr, with (at
least) 608 wallets. An interesting pool not included in our
analysis is minergate. We have found 4,980 emails mining
at this pool in our dataset. Since minergate does not provide
public information about the rewards paid to the miners, we
are unable to estimate proﬁts from this pool.
Our analysis show that 49.3% of the campaigns use or have
used more than one pool. Figure 5 shows the number of pools
used by different campaigns grouped by the amount of Monero
mined. As it can be observed, the 97% of the campaigns with
largest earnings (i.e., over 1K XMR) have used more than
one pool. However, seven campaigns with earnings over 10K
are using just one pool. Out of these, six use dwarfpool and
one uses crypto-pool. This suggests that mining in different
pools depends on different strategies, probably driven by the
revenues from each pool and their banning policies.
D. Monero-based Campaigns
As shown in Table IV, we ﬁnd 2,360 campaigns mining
Monero. Out of those, we are able to get payments to 2,145
campaigns through querying the various mining pools.
1234567891011121314151617Number of different pools% of campaigns010203040506070XMR mined (#campaigns)    =10000 (15)Pool
crypto-pool
dwarfpool
minexmr
poolto
prohash
nanopool
monerohash
ppxxmr
supportxmr
Others (8)
XMR Mined
429,393
168,796
74,396
29,044
12,833
5,205
4,046
3,860
3,217
2,797
#Wallets
487
461
608
38
54
375
217
185
241
314
USD
47,261,821
1,088,516
5,320,397
35,815
275,471
858,949
477,557
518,487
443,087
325,034
TABLE VII: Overview of the popularity of the different min-
ing pools ranked by the amount of XMR mined by malware.
Campaign
C#627
C#3027
C#268
C#102
C#693
C#1290
C#10465
C#3311
C#2642
C#2202
TOP-10
ALL-2235
#S
66
20
134
59
106
91
6
9
46
25
562
64 K
#W
7
2
4
1
2
14
1
1
1
1
34
2532
Period
06/16 to active*
10/16 to 04/18
01/15 to 02/19
09/14 to 04/18
08/14 to 02/19
06/16 to active*
09/16 to 04/18
06/16 to 05/18
09/14 to 04/18
09/14 to 04/18
2014/08/30 - *
2014/07/18 - *
XMR
163,756
59,620
42,069
32,886
27,985
27,086
23,300
22,520
21,389
20,694
441,305
740,927
$
20 M
8 M
323 K
53 K
95 K
1 M
2 M
5 M
42 K
38 K
38 M
58 M
TABLE VIII: Top 10 campaigns ranked by amount of XMR
mined. C=Campaign #S=Num. of samples, #W=Num. of wal-
lets, and active* on April 2019. Recall that the exchange
rate to USD is computed dynamically based on when the
payments were made.
We summarize the results of our aggregation in Table VIII
and show some demographics for the top 10 campaigns. Note
the difference between USD and XMR in some campaigns.
As explained before, this is due to ﬂuctuations of the XMR
value and depends on when payments were made. A note of
precaution when looking at the USD ﬁgures as we are unaware
of when criminals cash-out their moneros. Thus, we prefer to
report our ﬁndings in primarily in XMR. Overall, we estimate
that there are at least 2,235 campaigns that have accumulated
about 741K XMR (58M USD). Some of them are still active.
Interestingly, just a single campaign (C#627) has mined more
than 163K XMR (20M USD), which accounts for about 22%
of the total estimated. This campaign is still active at the time
of writing and it is later studied in §V-A. We observe that
only the top 10 campaigns mine more than the remaining 2,225
ones. Overall, we observe that 99% of the campaigns earn less
than 100 XMR (see Figure 4). We also observe that while
majority of the campaigns earn very little, there are a few
campaigns overly proﬁtable. This indicates that the core of this
illicit business is monopolized by a small number of wealthy
actors.
There are campaigns with a large number of samples, with
up to 12K in the case of C#4 (see further details in our
repository).14 However, some of the most proﬁtable campaigns
have few samples (e.g., C#10465 or C#3311). This means that
14https://github.com/gsuareztangil/cryptomining-malware
Tool
xmrig
claymore
niceHash
learnMiner
ccminer
#I
415
861
108
2
1
(#S)
(299)
(853)
(21)
(2)
(1)
#V
59
14
11
2
1
#C
262
98
67
2
1
TABLE IX: The most popular mining tools used. I=Instances,
S=Samples, V=Versions, C=Campaigns
either the samples in those campaigns have infected a large
number of victims, or that other samples from the campaign
are not detected by any AV. In either case, it suggests that
there are some miscreants that are proﬁcient in remaining
undetected. In the next section we analyze the infrastructure
and stealth techniques used by the different campaigns, and
how this affects their efﬁciency.
While most of proﬁtable campaigns started in 2016 or
earlier, we observe recent campaigns with large earnings. In
particular, 21 campaigns that started in 2018 have mined more
than 100 XMR, 12 of which are active at the time of writing
(April 2019).
E. Infrastructure
We next analyze the third-party infrastructure used in the
different Monero campaigns.
Mining software. Table IX shows an overview of the stock
mining tools used by the different campaigns. We show that
xmrig, claymore and niceHash are the most popular
tools we account for. With the current distance threshold in
our Fuzzy Hashing algorithm, we found no evidence pointing
to the use of other less popular tools such as: cast-xmr,
jceMiner, srbMiner, or yam. When using a higher thresh-
old, we found one campaign using xmr-stak. Overall, the
top most popular frameworks account for approximately 18%
of the Monero campaigns. Note that obfuscated versions of
these tools are sold in underground marketplaces. Thus, these
numbers should be viewed as a lower approximation.
Domain aliases for mining pools. A common mitigation
strategy often suggested in commercial reports [4] is to
block known mining pools, using blacklists. Criminals create
CNAME domain aliases to evade this mitigation. In our
analysis, we observe 215 different CNAMEs. Most of these
are aliases of minexmr (176), crypto-pool (21) and dwarfpool
there are two aliases (x.alibuf.com and
(14). Interestingly,
xmrf.fjhan.club) which have been eventually used to hide two
different pools each. This suggests again dynamic changes
in the mining strategy used by criminals to maximize their
revenue. We note that the former alias is actually part of the
most proﬁtable campaign (C#627), which is detailed in §V-A.
Pay-Per-Install services. In order to spread malware, crimi-
nals use commodity botnets offered as PPI services in under-
ground markets [33], [34]. We ﬁnd samples from 3 different
botnets offering PPI services. In particular, we observe 511
samples associated with the Virut botnet (in 44 different cam-
paigns), 46 from Ramnit (in 10 campaigns) and 27 from Nitol
(in 3 campaigns). Also, in one of the biggest campaigns (C#8),
11
UPX
NSIS
maxorder
SFX
INNO
Others
Not packed
328,493
17,464
5,988
3,928
2,423
eval
docwrite
ARJ
CAB
Enigma
2,032
1,490
858
721
710
4,019
862,712
TABLE X: Packers used for binary obfuscation.
known as Photominer [29], we ﬁnd 346 samples (3.01%) of
the samples belonging to this campaign) using Virut to deploy
the mining operation. Recall that campaigns are automatically
extracted. Observing campaigns from botnets that are know
to the community shows that our heuristics provide a reliable
aggregation. Yet, our framework steps up ﬁnding novel cam-
paigns as shown in §V.
Obfuscation. A common practice when spreading malware is
to obfuscate the binary to avoid detection. Criminals typically
use existing tools, such as well-known packers (e.g., UPX)
or crypters. Packers can be ﬁngerprinted more easily than
crypters, but crypters — which are usually purchased in
underground markets — increase the cost of the operation.
By leveraging the F-Prot unpacker [38], we extract packer
information associated with each sample (when applicable).
This tool also identiﬁes compression algorithms, which are
not considered obfuscation. Then, we look at the entropy to
detect whether some other unknown obfuscation is applied in
samples where no packer or compression algorithm is detected.
In our implementation, we choose a conservative threshold
of 7.5 (where 8 means total randomness) to decide when a
sample is obfuscated, which is more restrictive than values
tested in previous works [39], [40]. We found that around 30%
of the samples are obfuscated. We consider that a campaign
uses obfuscation if a large proportion of their samples (i.e.,
80%) are obfuscated. While this is the ratio in the overall
dataset, we found that only 4.16% of Monero campaigns use
obfuscation. Table X summarizes the number of samples using
obfuscation together with the tool used to obfuscate it. UPX
is by far the most common tool used. Interestingly, we have
seen many binaries created using AutoIt (a Windows-based
scripting language) which by default packs the script into
an PE ﬁle using UPX. In §VI we discuss the limitations of
analyzing obfuscated binaries.
Analysis. Table XI shows the third-party infrastructure, stealth
techniques and period of activities for the different Monero
campaigns (both divided according to their proﬁts, and over-
all). While only 1.1% of the campaigns use domain aliases, a
higher proportion is found in most proﬁtable campaigns (9.4%
of those mining between 1K and 10K XMR, and 26.7% of
those mining more than 10K XMR). A similar situation hap-
pens with proxies and PPI services, which are more common
in successful campaigns (i.e., with larger earnings).
Most proﬁtable campaigns have longer period of activity
(46.7% have been active since 2014). However, we also
observe a high portion of campaigns (26.7%) operating only
XMR Mined 10k ALL
2,235
53
15
THIRD PARTY INFRASTRUCTURE
154
3.2%
14.9%
1.3%
1.3%
8.6%
0.4%
STEALTH TECHNIQUES
4.0%
0.3%
2.6%
PERIOD OF ACTIVITY
5.2%