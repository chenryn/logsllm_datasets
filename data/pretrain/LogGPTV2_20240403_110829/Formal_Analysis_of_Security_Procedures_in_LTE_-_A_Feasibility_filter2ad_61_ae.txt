### 优化后的文本

#### 图8. X2切换模型
在用户设备（UE）和源演进节点B（S-eNB）之间共享的X2切换模型（步骤26）。其余的附加步骤用于建立一些参数，这些参数对于派生当前和未来的切换密钥是必需的，例如下一跳密钥（步骤27-28）和目标演进节点B（T-eNB）的小区标识符（步骤29）。

#### 图9. S1切换模型
S1切换模型几乎需要相同的初始化步骤（此处省略），除了HO X2中的附加小区标识符cellid参数不再需要。两种模型的主要区别在于移动管理实体（MME）的角色。在S1切换中，由MME计算将在T-eNB中使用的密钥NH2。而在X2切换中，是由S-eNB计算目标密钥K* eNB。此外，在协议的最后步骤（第7-8行和第20-21行）中，MME提供其密钥（NH2）以供下次切换使用。

在这两种切换模型中，我们考虑了相同类型的健全性查询来检查正确性。请记住，这些查询是为了在每个过程宏的末端执行特殊可达性事件。ProVerif无法证明所有这些查询。然而，ProVerif能够伪造的查询的攻击跟踪表明，未解决查询的可达性事件也得到了执行。对于对应断言，目的是证明用户设备（UE）和目标演进节点B（T-eNB）之间对收到的切换密钥（K* eNB或NH2）及其选择算法的一致性。ProVerif能够证明HO X2模型中的所有断言。

### 表1. 分析结果
| 属性 | AKA | NAS SCP | NAS SRP | HO X2 | HO S1 |
|---|---|---|---|---|---|
| 保密性 | 真 | 真 | 弱一致 UE => ... 真 | 真 | 弱一致 ... => UE 真 |
| 弱一致性 | 真 | 真 | 弱一致 UE => ... 真 | 真 | 弱一致 ... => UE 真 |
| 注入一致性 | 真 | 假 | 注入一致 UE => ... 真 | 假 | 注入一致 ... => UE 未解决 |
| 注入一致性 | 真 | 假 | 注入一致 ... => UE 真 | 假 | 注入一致 ... => UE 未解决 |

对于HO S1模型，ProVerif无法证明注入一致性断言，但可以证明基本断言。

### 结论
我们介绍了我们在LTE中安全协议的工作，并使用ProVerif进行形式化和验证。我们的分析表明，所有的保密性和弱一致性属性都成立，这是预期的结果。然而，我们在证明更强的一致性属性时遇到了困难。所有结果总结见表1。据我们所知，安全命令程序和切换程序以前没有以这种方式进行过分析。在建模过程中，我们的目标是尽可能忠实地遵循3GPP规范[1]中的协议及其信任模型。ProVerif的一个重要缺失是对本地状态信息的支持。如后文所述，支持这一点将使协议设计者免于确保密钥导出函数输入唯一性的常见且繁琐的任务。

ProVerif能够在几秒钟内在普通笔记本电脑上验证这些模型，因此运行时间对于实际应用来说是足够的。ProVerif输入语言的概念与3GPP规范中使用概念相匹配。因此，假设熟悉ProVerif和研究系统的情况下，构建模型不会花费太多时间。

### 未来工作
我们已经尝试了其他形式验证工具。对于这项初步工作，我们认为ProVerif在易用性和输入语言表达能力方面提供了良好的折衷。尽管如此，我们计划对类似工具进行更全面的评估和比较。此外，我们相信在工业环境中，如标准化提案，应结合使用多种工具以克服它们各自的不足。这并不意味着必须由标准化组织正式规定使用这些工具。实际上，正如下面解释的那样，有一些协议方面我们无法通过ProVerif妥善处理。

一般来说，新鲜度是通过保证每个会话中派生密钥的唯一性来实现的。这可以通过使用nonce（如AKA中KASME密钥的派生）来实现。然而，所有较低级别的密钥派生依赖于其他协议参数，如计数器、小区标识符等。计数器是不断更新的协议状态的一部分。我们认为，任何涉及协议的问题很可能是与此方面相关，尤其是在不同协议交错并在更复杂的复合程序中任意使用时。基于状态的形式验证工具可能更适合对此类特征进行模型检查。然而，为了提高此类（通常是穷尽的）状态搜索的效率，可以假设一个较弱的攻击者模型。作为未来的工作，我们正在研究可以在多大程度上简化攻击者模型，同时仍能找到攻击。

其他继续的工作包括对LTE与其他类型无线电接入网络（如GSM和WCDMA）之间的互操作性协议进行类似的分析，并更新我们的模型以处理不同的场景。例如，在图3的AKA模型中，每个UE进程的运行代表一个新的设备，因为每次运行都会创建并使用新的IMSI和K的新鲜对。该模型可以通过添加另一个类似的UE进程来进行更改，该进程从原始进程填充的表中获取这对数据。这样可以模拟同一UE多次运行AKA的情况。此外，移动模型可以增强以包含多跳切换。这可以用来验证进一步的安全属性，例如两跳前向安全性。

### 参考文献
1. 3GPP The Mobile Broadband Standard, http://www.3gpp.org/specifications/
2. 10th Computer Security Foundations Workshop (CSFW 1997), Rockport, Massachusetts, USA, June 10-12. IEEE Computer Society (1997)
3. Abadi, M., Blanchet, B., Fournet, C.: Just Fast Keying in the Pi Calculus. In: Schmidt, D. (ed.) ESOP 2004. LNCS, vol. 2986, pp. 340–354. Springer, Heidelberg (2004)
...
（参考文献部分保持不变）

希望这能帮助你更好地理解并传达你的内容！如果有任何进一步的修改需求，请告诉我。