高校 （地理信息、财务、办公、
太阳塔科技、 ERP、安全）
磐极云数、
服务 软件
云和恩墨、
提供商 开发商
阿里云、
海量云图、
腾讯云、
华为云、青云、金山云、
aws(bigsql, rds, aurora, redshift)
微软:citus
Ibm:edb
用户
云、 瀚高、优炫、恒辉、云图、
PG中国社区、
开源
Polardb, tbase, 高斯，
数据库
开源联盟PG分会、 亚信、pivotal gpdb、偶数、
社区
zilliz、南大富士通。。。
厂商
培训 硬件 Apple、lazada、redhat、
ToCB发力：
平安、国家电网、邮储银行、阿里、腾讯、
机构 厂商
阿里云大学 高德、华为、gov、
探探、去哪儿、亚信、海鼎、苏宁、斗鱼、
云和恩墨、晟数
中兴、国信、……..
社区、分会
Who use PG?
PG 衍生数据库、插件 应用
Greenplum、redshift、asterdata 大数据分析
Agensgraph\edgedb 图计算
Citus、xc\xl、antdb、阿里巴巴POLARDB HTAP
timescaledb IoT 时序数据(工业物联网)
EDB\POLARDB\orafce 兼容Oracle 替换 商业数据库
Pipelinedb、imgsmlr 流计算、图像识别
Yahoo everest 搜索引擎
阿里巴巴 Pase 插件 高维向量相似搜索(人脸识别)
Madlib、rdkit 机器学习、化学计算
PostGIS、阿里巴巴 Ganos 插件 时空、地理信息
教科书级代码 教学价值
可插拔接口， 科研价值
前沿科技快速集成
带动数据库产业 避免重复造轮子
DBA核心诉求:O vs PG
O PostgreSQL
品牌 国内外用户：
版本发布节奏稳定(每年大版本、每月小版本，十年如一日)，产品稳定。
价格 不要钱，类似bsd许可，风险低。
允许云上、线下输出，厂商可以基于PG分发。
核心技术 • RAC -> pg (polardb, xl,xc, antdb,… 弯道超车) ACID，单机，集群（分布式），多写(pro)，进程，线程池(13+)，bg process, 守护进程,
• 优化器：动态规划(超复杂SQL) AM开放(heap,zheap,zedstore,btree,hash,gin,gist,spgist,brin,bloom,rum)
• 内存表 Database，schema，tbs，redo，arch，stream，pitr，
• TBS(multi datafile-block dev[s]) -> pg(zfs, lvm) Compress(block level, openapi), ssl, auth(pwd,ldap,sspi,peer,md5,…)
• RAW 设备， quorum base(多副本),
• Redo group -> pg(zfs, storage) cbo, geqo(图式规划), aqo, cost const, hint, sr plan
• Block level compress AWR, auto parallel (sql, mainantence, idx, bak , restore)
HA(shared store, stream rep)
MPP, HTAP (citus, gpdb, antdb, polardb,…)
功耗 ECS 单机 160万+ tpmc total (1000Warehouse),
能耗比 104 core ，160万+ tpmc total => ….
故障率 稳如狗 (前提：基本的部署系统、参数优化)
稳定性 CKPT动态调度，波动较小。
自动垃圾回收，vacuum freeze。带调度，波动小。
大查询资源抢占，支持用户级并行度配置，波动小。
锁粒度细，读写不冲突，行锁不耗费内存，没有锁放大问题。
advisory lock, ssi隔离级别
安全性 ACL，认证过程加密，ssl，敏感信息掩码，tde(13)，存储级加密，权限控制粒度（sec label, column,
table, object, schema, database）
Barrier view
DBA核心诉求:O vs PG
空调 O PostgreSQL
核心功能 • Bitmap index -> (pg: gin,rum) 数据类型(普通类型，数组，json，kv，几何，多维，range，comp,uuid,xml,textsearch,枚举，字节流，大对象，
图像，扩展(pase)…)，
索引（btree,hash,gin,gist,spgist,bloom,brin,rum,排他，partial idx, express idx,虚拟索引, including index），
FDW(postgres, mysql, oracle,mongo, ms sql, jdbc, odbc, Hadoop, …)
数据存储(heap, zheap, zedstore, 未来扩展 )
Sql语法兼容性，内置函数、操作符，自定义函数，类型，操作符，
高可用，在线备份，增量备份，增量恢复，实时容灾，审计
增值能力 • 闪回，闪回query，-> pg(pro snapfs) 插件化：GIS，路由，图，推荐，分布式，MM，流计算，多维向量，
• im-db 外部访问源，逻辑订阅，资源隔离，HTAP，
• Datafile direct-io GPU加速，并行计算，传输表空间(pg pro)，块级压缩(zedstore) , pg_repack(在线重组垃圾回收)
• Interval partition 函数语言扩展（plpgsql, c, plperl, pljava, pltcl, plpython, pllua, plgo,….)
• 自动内存管理，asm
维护 日常维护，性能监控手段，优化，诊断，上报BUG、与社区联络非常容易，可直接解读源码
产品限制 支持的芯片，操作系统，可以建不限个数db，user，schema，table，有限取决于block size和编译头文件:
column，index，记录数，表大小，数据库大小
售前服务 云、数据库厂商、支持公司、培训公司、高校
售后保障 同上(代码级服务除了社区提供，还有很多公司可以提供)
使用便捷 语法丰富程度（最接近SQL标准的数据库），gui, cli，函数开发、调试，develop框架，isv 集成
说明书 手册，源码，书，搜索引擎，视频，培训，认证，blog，微信，qq，钉钉群，公众号，5万+社群
DBA核心诉求:O vs PG
空调 O PostgreSQL
外观 • 代码可读性（堪称教科书级），引用各种论文，注释说明丰富。
• 模块化设计。
• 开放hook, api，可扩展能力强。
做工 Psql 帮助，tab补齐，快捷命令，快捷帮助、管理函数，框架自动补全，手册index，插件集中化管理。
用料 纯C代码。
产能 • 每年一个大版本，
• 小版本平均1.5个月发布，
• 每个大版本维护5~6年。
上市时间 追溯到1973（论文， ingres）,
第一个开源版本始于1995
企业股权分布 NPO组织化运作，社区组成：遍及全球，涉及众多商业巨头，民主化，不受国家、公司控制
注册资本 （aws, ms, ibm, google, apple, ……。 Cloud: Alibaba, Tencent, Huawei, ）
行业认证(3C，ISO) 遵循SQL标准，同时扩展SQL能力。
质量控制。 商业化公司（认证）
社区化运作（管理体系完善）
开发者核心诉求: O vs PG
类目 O PostgreSQL
GUI管理工具 Toad，PLSQL Developer Pgadmin, navicat for PG
CLI管理工具 Sql*plus psql
函数、存储过程语言 PL/SQL Plpgsql,
+ plpython, pltcl, plperl, pljava, plv8, pllua …
C嵌入式开发 PRO*C ecpg
数据类型 数值、时间、字符串、二进制、 全部包括。
大对象、枚举、GIS、BIT、 +数组、range、树、网络、UUID、全文检索、货
JSON、XML、复合 币、域、向量、扩展类型
SQL语法 增、删、改、查、函数调用、 全部包括。
聚合、窗口、分组、排序、子查询、 +异步消息，
关联、递归、逻辑集合、 +索引：Gin,gist,spgist,brin,bloom,rum
触发器、事件触发器、
HINT、索引、explain
目录
• PG和mongo的渊源
• 去O的大背景
• 去O难点
• PG+mongo的优势
• 参考资料
Mongo+PG : 1+1>2
• PG
• 关系数据：核心，可靠性|可用性|安全性要求高，数据处理逻辑复杂
• PG：
• ISO/IEC 9075 : 2016
• 并行计算
• Mongo
• 弱结构化数据：如日志型流水数据，量大，可靠性要求较低，写入要求
快，弹性伸缩
• Mongo：
• Sharding
• JSON
Mongo_fdw
目录
• PG和mongo的渊源
• 去O的大背景
• 去O难点
• PG+mongo的优势
• 参考资料
• https://github.com/digoal/blog/blob/master/README.md
Thanks
PG技术进阶群
3500+人，每周技术分享