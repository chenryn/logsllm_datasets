risks to individuals. We concur with the assessment
that
answering our research questions is beneﬁcial for future end-
to-end encryption research, which ultimately beneﬁts society,
and that there was no harm done to any participants based
on possibly re-identiﬁable metadata. Importantly, we will not
publish the metadata we collected and only an encrypted copy
will be stored at the university data center for ten years without
access by researchers to follow good scientiﬁc practice. As is
common in research, we only publish aggregate data, and no
email accounts can be re-identiﬁed through the publication
of this paper. As part of the joint development of our data
collection plan, we decided to take the following measures
to protect users’ (metadata) privacy and adhere to the GDPR,
German, and state laws:
• The involved researchers never had access to raw data.
The data collection pipeline was executed by the uni-
versity’s IT staff who operate the email servers and
have access to the backup data. They transferred the
pseudonymized data to the researchers to a secure server.
• We reduced the amount of data to the absolute minimum
we required to investigate our research questions.
• We used cryptographically secure hash functions with
salts unavailable to the researchers to pseudonymize user
data.
• At all times pseudonymized data (cf. Table IV in the
appendix) was only stored on secured university servers.
• We did not and will not share any data other than the
aggregate numbers in the paper with anyone outside the
team of involved researchers.
• We assured the data protection ofﬁcer and the works
committee that we would not take any actions to de-
identify users.
The above data protection precautions ensured the necessary
compromise between user privacy and data utility in order to
perform the analyses on which we report in Section V.
D. Limitations
Data Set. Our dataset includes email data from January 1994
to July 2021 covering 81,647,559 emails of 37,463 users from
a large Germany University with more than 30,000 students
and 5,000 employees. However,
the dataset might not be
complete. We could not include emails that users deleted from
their accounts; similarly, we did not include emails sent to
deleted accounts. Some research groups and departments have
their own email servers; their emails were also not included
in our dataset. Therefore, the dataset should not be assumed
to include all emails that were sent or received from January
1994 to July 2021 at our university. Additionally, we do not
assume that our dataset is representative for all email data
in Germany or globally. Instead, we think our data set might
overreport the use of email encryption since most email users
in the dataset are highly educated and our university offers
free S/MIME certiﬁcates to all email users.
However, we think our dataset is one of the largest and most
valuable for the type of analysis we perform and our results
are a valuable contribution to the security research community.
Data Analysis. We could not analyse all cryptographic de-
tails, e.g., we could not verify digital signatures since we were
not allowed to parse the body content of emails and we could
not extract details for certiﬁcates or signatures that were used
in encrypted emails, since this data is also encrypted.
We tested our pipeline thoroughly but still missed some
edge cases that inevitably arise in mail software that evolves
over a long time span. While our pipeline was able to process
99.91% of all emails, processing failed for the remaining
0.09%. Errors during S/MIME and PGP parsing were logged
separately. We encountered 1,199 S/MIME and 23,168 PGP
emails where parsing failed (cf. Appendix A for more details).
We deemed this margin of error tolerable compared to the high
organizational costs of reﬁning and repeating the entire process
once more.
Distinction Between Send and Receive. The dataset we
evaluated did not contain information whether an email was
sent or received. To still group emails into sent and received
emails, one approach would be to group emails based on the
folder they were stored in. However, this would introduce
challenges such as email clients using different names for sent
folders or users using their own folder names. Therefore, we
decided to identify emails based on multiple parameters. Sent
emails were not allowed to contain a return_path header,
since it is added by outgoing mail servers and emails were
only allowed to go through at most one mail relay12. Most
incoming emails have more than ﬁve email relays.
Mail Client Behaviour. The macOS and iOS clients Apple-
Mail, iPhoneMail and iPadMail generally identify themselves
using the X-Mailer header in mails, but the copy placed in
the sent folder by these clients does not contain this header.
As a result, these clients could only be correctly detected on
received emails, their sent mails are included in the ”No User
Like every measurement study, our work comes with several
limitations:
12One mail relay header is added when the webmail client of the university
is used for sending mails. Regular mail clients do not add this header.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
866
Agent” group. The ticket system used by the university data
center automatically deletes mails in its inbox and does not
place a copy in the sent folder and as a result only the answered
tickets are available in our dataset.
E. Replication Package
To improve the replicability of our work, we provide a
replication package including the following material: (a) the
complete processing pipeline consisting of multiple Python
scripts to process and pseudonymize emails from Dovecot
mail servers, (b) the analysis scripts to replicate our results
on different datasets, and (c) the agreement with our data pro-
tection ofﬁcer. Due to the sensitive nature of our measurement
study, we cannot make raw email data available. We hope this
replication package helps future studies to better compare and
position themselves to our work; and hope others replicate our
work on different email datasets to improve our community’s
understanding of the use of email encryption. The replication
package is available on our website at [39].
V. RESULTS
We provide a detailed analysis of the email corpus we
collected and the adoption of S/MIME and PGP from 1994 to
July 2021 below.
A. Dataset Summary
In total, we analyzed metadata for 81,647,559 emails from
37,089 email accounts. Overall, the university’s email users
exchanged 40,540,140 (49.67%) emails internally.
Figure 2 illustrates the use of email at our university
in the past 27 years. While we found only 350 emails in
1994, we detected an almost exponential growth and found
17,190,472 emails in 2020. This development reﬂects the
enormous relevance of email as a communication tool and
is in line with reports on the global use of email13.
Use of Email Encryption and Signatures. We found
2,334,042 (2.86%) emails that were either encrypted or signed
using S/MIME or PGP. We identiﬁed a huge difference
between the use of email encryption and signatures.
46,973 (0.06%) emails were encrypted. 26,105 (55.57%)
emails were encrypted using S/MIME and 20,868 (44.43%)
of them were encrypted using PGP. In contrast, 2,287,922
(2.8%) emails were signed. 2,040,794 (89.2%) of them were
signed using S/MIME and only 247,128 (10.8%) were signed
using PGP.
Figure 2 illustrates the use of S/MIME and PGP between
1994 and 2020. We found the ﬁrst S/MIME signed email in
1998 and the ﬁrst S/MIME encrypted email in 1999. The
ﬁrst PGP signed email appeared in 1994 and the ﬁrst PGP
encrypted email in 1997.
Key Insights: Dataset.
• We saw an exponential growth of the use of email between 1994
and 2020.
• Only 0.06% of emails were encrypted.
13cf. https://www.emailisnotdead.com/
Fig. 2. Rise of email, S/MIME and PGP over time at our university.
• 2.8% of emails were signed.
• S/MIME was more widely used than PGP.
B. S/MIME Certiﬁcates and PGP Keys
Below, we give an overview of the S/MIME certiﬁcates and
PGP keys we found. This includes certiﬁcates and keys from
internal and external senders. Overall, we were able to collect
9,765 S/MIME certiﬁcates, 3,741 primary PGP keys and 3,840
sub keys (cf. Table II for details).
S/MIME Certiﬁcates. All but one certiﬁcate that used an
elliptic curve encryption algorithm supported the RSA encryp-
tion algorithm.
2048 bits was the most widely used RSA key size (91.58%);
5.54% of the RSA keys had 4096 bits. In 237 cases we saw
1024 bits RSA keys; 6 RSA keys had 512 bits. While the
last 512 bits RSA key we found was created in 2010, we saw
2 1024 bits RSA keys created in 2020.
7,472 (76.52%) certiﬁcates supported the SHA-256 signa-
ture algorithm. However, we also found outdated signature
algorithms including SHA-1 (2,028; 20.77%) or MD5 (148;
1.52%). Surprisingly, we found 11 certiﬁcates issued in 2020
using SHA-1. The last certiﬁcate using MD5 was generated
in 2017.
5,194 (53.19%) of all certiﬁcates expired in 2020 or earlier.
The mean validity period for S/MIME certiﬁcates was 3.13
years (sd= 2.70) ranging overall from a minimum of 4.00
weeks to a maximum of 99.99 years. 6,953 (71.20%) cer-
tiﬁcates were created between 2015 and 2020 with a peak of
1,654 certiﬁcates (16.94% of all S/MIME certiﬁcates) in 2019.
Overall, we found 671 different issuer names. However,
1,150 (11.78%) certiﬁcates had no issuer. The most promi-
nent issuer was the DFN issuing 3,209 (32.86%) certiﬁcates.
622 (6.37%) were issued by our university. Another German
university issued 563 (5.77%) of all S/MIME certiﬁcates we
found. In 332 (3.40%) cases, a distinct issuer only signed a
single certiﬁcate. 89 (0.91%) issuers signed only two certiﬁ-
cates. 137 of them (32.54%) had no root CA. In total, we
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
867
S/MIME
PGP
Total
Sent
Received
Sent
Received
Sent
Received
Signed
Encrypted
Signed
Encrypted
Signed
Encrypted
Signed
Encrypted
356,330
9,358
1,684,464
16,747
69,950
8,197
176,983
12,633
16,660,280
64,952,315
231,475
78,736
0
?1
11,479
0
7
0
?1
2,361
1,270
31,002
167,350
60,827
5,909
1
81
135
91,025
31,002
237,579
106,434
9,903
1,700
714
6,311
1,675
0
?1
190
29
0
0
?1
8
3
1,142
2,183
3,985
170
0
1
3
1,874
1,142
3,992
5,318
20
28
0
508,423
258,013
311,743
58,752
16,366
50
7,355
145
5,275
3,526
13,397
501,419
326,747
164,926
88,144
5,294
66
831
597,037
501,419
808,539
684,791
121,243
67,813
2,078
7,103
3,728
1
2,157
341
31
31
0
104
3
128
3,120
2,555
4,379
2,397
104
0
8
4,184
3,120
8,376
8,155
129
71
16
46,407
325
0
?1
232
564
0
1,654
?1
63
2,804
17,901
38,751
8,797
2,126
0
34
10
2,331
17,901
66,483
2,122
77
1,242
26
5,775
22
0
?1
48
1
0
207
?1
2
221
1,921
2,531
3,372
172
0
101
2
98
1,921
6,708
1,134
39
311
5
85,904
5,528
223
20,722
1,387
11,506