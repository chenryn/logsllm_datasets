2015年初,小米发布基于ZigBee协议的智能家庭套装,使得基于ZigBee协议通讯的智能家居产品又映入人们的眼帘。随即,我们研究团队也及时对ZigBee协议安全性进行研究,发现其主要风险主要压在密钥的保密性上,比如明文传输密钥【图8】,或者将密钥明文写在固件中,这些都可能直接导致传输的敏感信息被窃取,甚至伪造设备去控制智能家居产品。关于ZigBee安全更多的探讨,可以参考[《ZigBee安全探究》](http://security.tencent.com/index.php/blog/msg/92)。
图8:ZigBee密钥明文传输
2、移动金融设备
移动金融设备主要还是偏向于手持刷卡设备,并支持手机绑定控制的,比如基于蓝牙的移动POS机或刷卡器,一些智能验钞机也可以算在本类设备里面,这类产品很多,价格几十到几百不等,相对还算便宜。
早在2013年,国外安全公司IOActive就曾对某款验钞机进行研究,发现其在固件更新时未作签名校验,导致可刷入被恶意篡改的固件,最后研究人员通过刷入经篡改的固件,使得将一张手写的假钞被验钞机识别为真钞的攻击场景【图9】。
图9:篡改验钞机固件绕过假钞检测
2014年,我们研究团队发现目前市面上常见的移动POS机普遍存在严重漏洞,利用漏洞可以在无卡无密码的情况下盗刷他人银行卡,取走卡上余额【图10】,具体可参见发表在TSRC博客上的文章[《你的银行卡,我的钱——POS机安全初探》](http://security.tencent.com/index.php/blog/msg/76)。
图10:利用移动POS机漏洞盗刷银行卡
移动金融设备的沦陷,更为直接地危害到用户的财产安全,漏洞的出现可直接导致真金白银的流失,危害是浅显易见的。
3、车联网产品
图11:车联网
车联网【图11】的概念早在2010年就出现过,但一直到2013年来逐渐火起来,还有BlackHat大会上对汽车的破解议题,也引发了广泛关注。
2014年,我们也发现某款车联网产品存在漏洞,可以远程破解蓝牙密码,并实时获取汽车数据,比如车速、温度等等【图12】,由于设备硬件不支持写OBD接口(车载诊断系统接口),否则就可能远程控制汽车。
图12:远程破解某车联网产品连接密码实现对汽车实时数据的窃取
在今年BlackHat USA大会上,著名安全研究人员Charlie Miller与 Chris
Valasek就演示了如何远程黑掉一辆汽车【图13】,这也成为菲亚特克莱斯勒召回140万辆汽车的缘由,更加引发人们对车联网安全的关注。
图13:BlackHat上演示如何远程黑掉汽车
4、可穿戴设备
图14:可穿戴设备
可穿戴设备根据人体部分划分,大体可以分为:头颈穿戴设备、手腕穿戴设备、腰部穿戴设备、腿脚穿戴设备,其中最为常见的穿戴设备应该就是运动手环和手表了。
在GeekPwn
2014大会上,360儿童卫士手表就被破解【图15】,主要利用其中2处漏洞,一个是敏感信息窃取,可以随时随地获得孩子的位置信息;一个是把儿童卫士的手机客户端踢掉线,使家长失去和小孩的联系。
图15:360儿童卫士被破解
2015年中旬,我们研究团队也曾对Android
Wear进行分析,虽然最终未发现安全问题,但通过分析也学习到不少内容。比如,许多Android系统原先的组件都被割舍掉,特别是经常被黑的Webview被移除了,导致攻击面被缩小很多。同时,在Android
Wear上,普通应用程序与Google Play服务之间均有双向检验【图16、17】,会相互判断各自调用者的合法性,因此无法通过伪造请求实现通知消息的伪造。
图16:手表应用会检测调用者(手机应用)的包名及签名
图17:手机端应用Google Play 服务的安全检测
以上几个实例只是冰山一角,但它涵盖了人们日常的住、行、金融消费等活动。随着智能设备的普及和功能的多向化,人们的衣、食、住、行已经逐渐被覆盖到,比如已经出现的智能内衣(衣)、智能筷子(食)等等,甚至一些涉及人体健康的生物医学智能设备也逐渐出现,特别是像心脏起搏器、胰岛素泵等医疗设备,倘若出现安全漏洞,可能就是直接危害生命的问题。
**【沉淀:厚积薄发】**
在安全圈有句行话叫“未知攻,焉知防”,这与我在题记中所阐述的道理是一致的。研究并破解智能设备只是为了更好地防御攻击,制定更完善的安全体系。
为此,我们针对智能设备开发者(面向腾讯公司内部)制定出《智能设备安全开发规范》【图18】,以帮助业务同事在开发智能设备时能够规避常见的安全问题,提升业务产品的安全性。
图18:智能设备安全开发规范
此处简单列举几点智能设备的安全开发实践:
1、由于智能设备涉及领域较广,因此传统的WEB、APP安全检测依然需要使用到;
2、固件安全保护:对升级固件进行签名校验,同时尽量避免留硬件调试针脚,防止提取固件进行逆向,也可以参考某移动POS机的做法,即拆开自毁的霸气做法;
3、无线传输加密保护:不仅局限于WEB传输,其它蓝牙、ZigBee、RFID等等无线传输途径均需要做好敏感信息的保护工作;
4、权限控制保护:做好水平与垂直权限的防护,避免被越权操作,当前许多智能家居设备就普遍存在此类问题,导致可被远程控制;
5、安全编码:无论是固件层开发,还是网站、手机APP,都应遵循相应的安全开发规范,相信许多企业都有其内部的一些安全开发规范。
**【展望:路漫修远】**
目前智能设备安全问题的出现仅是个开端,未来随着其普及化,漏洞所能造成的危害将会被扩大化,渗透到人们日常生活的方方面面,未来智能设备的安全道路还有很长的路要走。
未来我们会继续关注智能设备安全、移动通讯安全(3G、4G)、车联网安全、移动支付等等方向,继续完善相关安全规范和审计工具,以帮助提高业界产品的安全性,也欢迎各位业界同仁共同探讨学习。
**【注】** :本文中所提及的所有漏洞,均已反馈给相应厂商修复。