having to manually decompress the archives. The application lets you view or 
change the values of settings specified in the META-INF and WEB-INF directories of the 
archives. See “Configuring Applications” (page 15) for more information.
The management tool allows you to manage application servers (JBoss instances) 
running on one or more computers. This application lets you start and stop services 
provided by individual application servers, configure services, and create data 
sources, queues, and topics. See “Administering Application Servers” (page 47) for 
details.
This chapter provides an overview of JBoss for Mac OS X Server.
12
JBoss in Mac OS X Server
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
2
Application Server Overview
JBoss in Mac OS X Server
Mac OS X Server version 10.3 includes JBoss version 3.2.2RC2. To provide a high 
level of availability, Mac OS X Server includes a “watchdog” process that ensures 
that the application server is always running (if you turn on the application server 
in Server Admin). If the application server freezes or crashes, the daemon restarts it 
automatically.
In addition, Mac OS X Server offers load balancing and session failover through 
Apache and JBoss:
I
Apache, coupled with the mod_jk plug-in, provides HTTP load balancing with 
session affinity (sticky sessions) and connects to JBoss instances through AJP 
connectors.
I
JBoss offers session failover through HTTP session state replication in the cluster 
configuration.
I
JBoss also provides load balancing for enterprise beans, including failover for 
stateful session beans, and support for session affinity.
In Mac OS X Server, JBoss is configured to use Tomcat (using the AJP connector) as 
its web server and servlet container. In addition, HTTP and HTTPS (through port 
8443) are enabled by default.
You can manage the application server from the Server Admin application. This 
provides you with a simple way to start, stop, and monitor the application server. 
You can use the command line, if you prefer.
Mac OS X Server includes two applications that allow you to deploy applications on 
JBoss and monitor their performance. They are the JBoss deployment tool and the 
JBoss management tool.
The deployment tool allows you to configure an application or an application 
component so that, for example, it accesses the appropriate data sources and 
database tables when it’s run. This is how application developers decouple business 
logic from the database engine that is used to persist data. That way, you can use 
C H A P
T
E
R
2
Application Server Overview
Three Deployment Conﬁgurations
13
  Apple Computer, Inc. January 22, 2004
the database engine that meets your needs and not the one the developer used while 
developing the application. For details on the deployment tool, see “Configuring 
Applications” (page 15).
The management tool lets you administer the local (running on the computer you 
are logged in to) application server, and monitor local and remote (running on a 
computer in the local network) application servers. As part of administering an 
application server, you may start and stop services, configure services, deploy 
applications, and add data sources, queues, and topics. When monitoring an 
application server, the management tool lets you access the statistics provided by 
the resources and services running on it. For example, a service may indicate its 
name, its purpose, and when it was started. For more information on the 
management tool, see “Administering Application Servers” (page 47).
Three Deployment Configurations
In Mac OS X Server, all the JBoss configurable settings are set up for maximum J2EE 
compliance. There are three standard deployment configurations in JBoss for Mac 
OS X Server:
I
The development configuration offers increased logging and also consults 
schema documents. As a result, an application is not deployed when the 
configuration files do not adhere to their respective schemas.
I
The standalone configuration is set up for high performance on a single server.
I
The cluster configuration is optimized for high performance on a cluster of 
servers. This includes load balancing as well as session replication among 
stateful session beans and HTTP sessions.
14
Three Deployment Conﬁgurations
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
2
Application Server Overview
Starting the Application Server
15
  Apple Computer, Inc. January 22, 2004
C H
A P
T
E
R
3
3
Configuring Applications
Before you can deploy an application on an application server, you have to start the 
application server and then configure or assemble the application. This is the process 
through which you specify data sources, database mappings, JNDI resources, and 
so on.
You configure J2EE applications by modifying XML files in META-INF and WEB-INF 
directories in application archives. Performing this task manually is tedious and 
error prone. The JBoss deployment tool allows you to configure applications 
without having to unarchive EAR files, WAR files, or JAR files, as the tool lets you 
configure these files directly.
This chapter explains how to start the application server and configure and deploy 
your application.
Starting the Application Server
To configure an application using the deployment tool, you must connect to a 
running application server. Follow these steps to start the application server on a 
computer.
1. Launch Server Admin, located in /Applications/Server.
2. In the Computers & Services list, select Application Server.
16
Starting the Application Server
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
3. In the configuration pane, click Settings. From Configuration Name pop-up 
menu, choose the appropriate configuration.
C H A P
T
E
R
3
Conﬁguring Applications
Starting the Application Server
17
  Apple Computer, Inc. January 22, 2004
4. Click the Start Service toolbar button. After a few seconds the application server 
should be running. You can confirm that JBoss is running by accessing http://
localhost:8080 in your web browser. You should see a webpage titled Welcome 
to JBoss/Tomcat.
You can also start JBoss in Terminal with the following command:
$ /Library/JBoss/3.2/bin/run.sh -c deploy-standalone
To get detailed information on JBoss activities, use the develop configuration. This 
is useful when you need to make sure JBoss notices when you deploy or undeploy 
a module, or when you need to determine whether exceptions are thrown as JBoss 
starts a deployed application. The develop configuration produces a detailed log of 
JBoss activities. It is more useful when you launch the application server from the 
command line because you see the results of actions immediately in the Terminal 
window from which you launch the application server.
18
Conﬁguring Your Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
Configuring Your Application
The following sections teach you how to start the deployment tool and configure 
your application.
Starting the JBoss Deployment Tool
To start the deployment tool, double-click DeploymentTool.woa in /Library/JBoss/
Applications or enter the following command in Terminal:
$ /Library/JBoss/Applications/DeploymentTool.woa/DeploymentTool
After a moment, the Load Application window appears.
Loading Your Application
The Load Application window is where you specify the location of the application 
or component you want to configure. Although the window is titled Load 
Application, you can also use the deployment tool to configure EAR files, WAR 
files, and JAR files.
Figure 3-1 shows the Load Application window.
Note: Running the JBoss Deployment Tool requires a web browser that supports 
Frames and Javascript. Some web browsers may need to have pop-up blocking 
disabled.
C H A P
T
E
R
3
Conﬁguring Applications
Conﬁguring Your Application
19
  Apple Computer, Inc. January 22, 2004
Figure 3-1
The Load Application window of the deployment tool
1. Enter the full path to the file in the text field in the Load Application window, 
and click Load Application.
Normally, you cannot save an application with invalid XML files. That is, you 
have to configure all the elements that show up in red in the main window. You 
can override this by deselecting Validate XML Files in the Load Application 
window. However, you may not be able to reload an application that has been 
saved in this state.
After the deployment tool loads the application, it displays the Loaded 
Application window, shown in Figure 3-2. 
Note: The file path you enter in the text field is from the perspective of the server 
the deployment tool runs on. That is, if you access the deployment tool from a 
web browser that runs on a different computer, the archive you configure must 
reside on the server, not the computer the web browser runs on.
20
Conﬁguring Your Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
Figure 3-2
The Loaded Application window
2. Click “Click here to continue” to move on.
The deployment tool displays the main window (also known as the navigation 
window). The main window presents a hierarchy of components generated 
from the XML files present in the META-INF and WEB-INF directories of the 
components contained in the archive you opened. For example, Figure 3-3 
shows the components present in the petstore.ear file of Sun Microsystem’s Pet 
Store application. You must configure the items in red to save the application. 
“Configuring Your Application’s Components” (page 22) shows you how to do 
this.
C H A P
T
E
R
3
Conﬁguring Applications
Conﬁguring Your Application
21
  Apple Computer, Inc. January 22, 2004
Figure 3-3
The deployment-tool main window
Figure 3-3 shows the components of the petstore.ear archive. The following list 
describes some of the items in the main window:
I
PetStoreEAR (Application) Represents the Pet Store enterprise-application 
archive.
I
Application Settings Clicking this link allows you to configure settings that 
affect all the modules in the archive when the application is deployed.
22
Conﬁguring Your Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
I
AsyncSenderEJB (EJB) Represents the archive (JAR file) that contains the files 
that define the AsyncSender enterprise bean (the asyncsender-ejb.jar file). 
Clicking the Module Settings link lets you configure module-wide settings and 
set default values for some settings for all the enterprise beans defined in the 
module. See “Configure the Customer Module” (page 32) for an example.
I
PetStoreWAR (WebApp) Represents the archive (WAR file) that contains the 
files that define the web module of the Pet Store enterprise application.
Configuring Your Application’s Components
To configure a component, you choose it from the main window by clicking the 
appropriate link. This causes the deployment tool to display the configuration 
window for the component. As you can see in Figure 3-4, this is a tabbed window 
that contains one or more panes, which you use to configure specific aspects of the 
component. The configuration window also contains a Quick Config pane, which 
contains elements of the component that you must configure for the application to 
be deployable. Figure 3-4 shows the Quick Config pane of the CatalogEJB module. 
It indicates that the JBoss resource references must be configured. The JBoss 
resource references also appear in the JNDI Resource Refs pane. However, you need 
to configure them in only one of the two panes.
C H A P
T
E
R
3
Conﬁguring Applications
Conﬁguring Your Application
23
  Apple Computer, Inc. January 22, 2004
Figure 3-4
The Quick Config pane of a component’s configuration window
Some settings apply to an entire module, for example, security roles. In addition, 
some module settings serve as defaults for settings of individual components in the 
module. Figure 3-5 shows some of the module settings of the CustomerJAR module 
of the petstore.ear application. Configuring modules settings can help to speed up 
the configuration of a module. See “Configure Module-Wide Settings” (page 32) for 
an example.
Note: For applications with many components, you may want to configure the 
Quick Config pages of the invalid components and save the application. Then 
you can configure each component further in a piecemeal fashion.
24
Conﬁguring Your Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
Figure 3-5
A module-settings window
After configuring the elements in a pane, you click Update to confirm the changes. 
Keep in mind that the changes are not saved until you save the application.
Saving a Configured Application
To save a configured application, that is, when no components are shown in red in 
the main window, click Save in the top of the main window. The Save Application 
window (Figure 3-6) appears.
C H A P
T
E
R
3
Conﬁguring Applications
Deploying Your Application
25
  Apple Computer, Inc. January 22, 2004
Figure 3-6
The Save Application window of the deployment tool
Enter the destination of the configured application in the text field of the Save 
Application window, and click Save Application.
Deploying Your Application
To deploy a configured application from the deployment tool, simply save the 
application to /Library/JBoss/3.2/deploy in a single-server deployment or /
Library/JBoss/3.2/farm in a cluster deployment.
26
Deploying Your Application
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
3
Conﬁguring Applications
Set Up the Environment
27
  Apple Computer, Inc. January 22, 2004
C H A P
T
E
R
4
4
Configuring and Deploying Sun’s 
Pet Store
Pet Store is a sample J2EE application from Sun Microsystems. Pet Store showcases 
the power and flexibility of the J2EE platform. This chapter provides a tutorial on 
the configuration of Sun’s Pet Store for deployment in Mac OS X Server.
Sun’s Pet Store is comprised of several applications. This tutorial uses the Pet Store 
enterprise application and the Supplier enterprise application.
In this tutorial you obtain the Pet Store files from Sun, prepare your Mac OS X 
Server system for a Pet Store deployment, and configure the Pet Store and Supplier 
applications for deployment on JBoss.
See http://developer.java.sun.com/developer/releases/petstore for more 
information on Sun’s Pet Store application.
Set Up the Environment
Before you can configure an enterprise application for deployment in Mac OS X 
Server, make sure that you have all the files you need. Then create any necessary 
tables in your database, and ensure that the appropriate processes are running:
Note: The companion files of this document include configured Pet Store 
archives that are ready for deployment using MySQL as the database engine. 
They’re at Application_Server_companion/Configured_Pet_Store_archives. You 
need to perform only the steps listed in “Set Up the Environment” (page 27) and 
“Deploy and Test the Application” (page 45).
28
Set Up the Environment
  Apple Computer, Inc. January 22, 2004 
C H A P
T
E
R
4
Conﬁguring and Deploying Sun’s Pet Store
1. Get Pet Store from Sun.
Download the Pet Store enterprise application from http://
developer.java.sun.com/developer/releases/petstore, and place the 
petstore1.3.2 directory in your home directory. (Pet Store 1.3.2 is also included 
as part of this document’s companion files.)
2. Configure MySQL:
a. Launch MySQL Manager, located in /Applications/Server.
b. Click the lock button, and authenticate as the system administrator.
c.
Click Install and then click Start.
d. Quit MySQL Manager.
3. Create the Pet Store Tables:
a. In Terminal, run the mysql command-line tool.
b. Enter use test and press Return.
c.
Copy the text in Application_Server_companion/Pet_Store_resources/
create_tables_sql.txt (in this document’s companion files) to the 
Clipboard, and paste its contents into the mysql command-line tool.
d. Enter quit and press Return.
4. Deploy the petstore-destinations-service.xml file.
To prepare JBoss for running Pet Store, copy the Application_Server_companion/
Pet_Store_resources/petstore-destinations-service.xml file included in this 
document’s companion files to /Library/JBoss/3.2/deploy.
5. Start the application server.
You must be running the application server to configure Pet Store. Make sure the 
application server is running on your computer. See “Starting the Application 
Server” (page 15) for details.
C H A P
T
E
R
4
Conﬁguring and Deploying Sun’s Pet Store
Conﬁgure the Pet Store Enterprise Application
29
  Apple Computer, Inc. January 22, 2004
Configure the Pet Store Enterprise Application
This section guides you through the steps required to configure the petstore.ear 
file so that it can be deployed in Mac OS X Server. This process involves specifying 
the data source that enterprise beans use to obtain a connection to the database, 
mapping the enterprise beans’ CMP fields to table columns, defining relationships 
among enterprise beans, and so on.
Open the petstore.ear File in the Deployment Tool
1. Launch the JBoss deployment tool. (See “Starting the JBoss Deployment Tool” 
(page 18) for details.)
2. In the Load Application window, enter the full path to the petstore.ear file in 
the text field, and click Load Application.