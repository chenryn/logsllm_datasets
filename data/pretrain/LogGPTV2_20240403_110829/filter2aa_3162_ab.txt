  xx:xx:xx	
  UTC	
– MD5=ad4ec04ea6db22d7a4b8b705a1c*****	
  2012-­‐07-­‐13	
  xx:xx:xx	
  UTC	
– MD5=5b759a7e9195247fa2033c8f33e*****	
  2014-­‐09-­‐05	
  xx:xx:xx	
  UTC
Tools	
  evolved	
  overGme	
Lateral	
  Movement
•  Leveraging	
  Asset	
  Management	
  System	
  to	
deploy	
  trojan:	
– MD5=61020085db3ﬀ7ccf6243aa1133*****	
  2010-­‐09-­‐20	
  xx:xx:xx	
  UTC	
– MD5=85b219a4ab1bcdbf5a3ac27f8bf*****	
  2012-­‐06-­‐20	
  xx:xx:xx	
  UTC	
– MD5=da9e74cfacccf867c68d5a9cceb*****	
  2014-­‐10-­‐15	
  xx:xx:xx	
  UTC
Agenda	
•  IntroducGon	
•  PLEAD	
  began	
•  PLEAD	
  malware	
  analysis	
•  PLEAD	
  lateral	
  movement	
•  GDrive	
  Rat:	
  Hiding	
  behind	
  PLEAD?	
•  The	
  phantom	
  of	
  routers	
•  Conclusion	
GDrive	
  Rat
•  GDrive	
  Rat	
  –	
  a	
  data	
  exﬁltraGon	
  tool	
  discovered	
  in	
late	
  2014	
–  implanted	
  in	
  vicGm	
  hosts	
  to	
  automaGcally	
  upload	
docs	
–  leveraging	
  google	
  drive	
  APIs,	
  stolen	
  data	
  were	
  stored	
on	
  google	
  drive	
  storage	
  registered	
  by	
  actors	
–  all	
  traﬃc	
  is	
  encrypted,	
  only	
  connecGons	
  to	
  google	
  can	
be	
  seen	
–  almost	
  impossible	
  to	
  detect	
  for	
  IDS/IPS	
–  GDrive	
  Rat	
  was	
  discovered	
  by	
  our	
  colleague	
  J	
GDrive	
  Rat
•  Links	
  of	
  GD	
  Rat	
  to	
  PLEAD:
DXXXXXXX
  2014-­‐10-­‐22	
  15:24:01 C:\PROGRAM	
  FILES	
  (X86)\JAVA\JRE7\BIN\JAVAS.EXE
  2014-­‐10-­‐22	
  14:25:58 C:\PROGRAM	
  FILES	
  (X86)\XXXXXXXXXX\XXXXXXXXXX	
  CLIENT\PATCH64.EXE
JXXXX
  2014-­‐10-­‐23	
  16:51:58 C:\PROGRAM	
  FILES	
  (X86)\GOOGLE\COMMON\GOOGLE	
  UPDATER\CHROME.EXE
  2014-­‐10-­‐23	
  14:34:04 C:\PROGRAM	
  FILES	
  (X86)\XXXXXXXXXX\XXXXXXXXXX	
  CLIENT\PATCH64.EXE
RXXXXX
  2014-­‐10-­‐24	
  15:42:09 C:\PROGRAM	
  FILES	
  (X86)\COMMON	
  FILES\JAVA\JAVA	
  UPDATE\JAVAS.EXE
  2014-­‐10-­‐24	
  15:13:52 C:\PROGRAM	
  FILES	
  (X86)\XXXXXXXXXX\XXXXXXXXXX	
  CLIENT\PATCH64.EXE	
……
Logs	
  collected	
  in	
  an	
  IR	
  case	
  in	
  TW
GD	
  Rat
PLEAD
Agenda	
•  IntroducGon	
•  PLEAD	
  began	
•  PLEAD	
  malware	
  analysis	
•  PLEAD	
  lateral	
  movement	
•  GD	
  Rat:	
  Hiding	
  behind	
  PLEAD?	
•  The	
  phantom	
  of	
  routers	
•  Conclusion	
Phantom	
  in	
  routers
•  Compromised	
  servers	
  have	
  been	
  used	
  as	
  C2s	
in	
  a[acks	
  for	
  decades.	
•  Since	
  2014,	
  we’ve	
  seen	
  some	
  a[acks	
  in	
Taiwan,	
  whose	
  C2	
  Ips	
  were	
  dynamic	
  IP	
addresses.
Phantom	
  in	
  routers
•  One	
  a[ack	
  targeGng	
  TW	
  in	
  March	
  2015	
  from	
PLEAD	
  group,	
  using	
  the	
  following	
  C2:	
•  One	
  interesGng	
  alias	
  was	
  observed:
xxxx.chickenkiller.com
CNAME	
  nxxxx1.asuscomm.com
Phantom	
  in	
  routers
•  Port	
  scanning	
  result	
  showing	
  it	
  to	
  be	
  an	
  ASUS	
device:
PORT	
  STATE	
  SERVICE	
  VERSION	
80/tcp	
  open	
  h[p	
  Microsor	
  IIS	
  h[pd	
  6.0	
|	
  h[p-­‐methods:	
  OPTIONS	
  TRACE	
  GET	
  HEAD	
  POST	
|	
  PotenGally	
  risky	
  methods:	
  TRACE	
|_See	
  h[p://nmap.org/nsedoc/scripts/h[p-­‐methods.html	
|_h[p-­‐Gtle:	
  \xAB\xD8\xBAc\xA4\xA4	
443/tcp	
  closed	
  h[ps	
1723/tcp	
  open	
  pptp	
  linux	
  (Firmware:	
  1)	
8443/tcp	
  open	
  ssl/h[p	
  Linksys	
  wireless-­‐G	
  WAP	
  h[p	
  conﬁg	
  (Name	
  RT-­‐N66U)	
|	
  h[p-­‐auth:	
|	
  HTTP/1.0	
  401	
  Unauthorized	
|_	
  Basic	
  realm=RT-­‐N66U	
Phantom	
  in	
  routers
•  Remote	
  code	
  exploit	
  (CVE-­‐2013-­‐4659)	
  for	
  the	
device	
  could	
  be	
  found	
  on	
  internet:
Phantom	
  in	
  routers
•  With	
  the	
  help	
  of	
  our	
  friends,	
  we	
  got	
  some	
insight	
  to	
  the	
  compromised	
  device:
ASUS	
  provides	
  DDNS	
service	
  for	
  its	
  routers
Vpn	
  account	
added	
  by	
  actors
Phantom	
  in	
  routers
•  Asus	
  is	
  not	
  the	
  only	
  one	
  being	
  abused
Phantom	
  in	
  routers	
•  We	
  conducted	
  a	
  simple	
  staGsGcs	
  of	
  8	
  Class	
  B	
Net-­‐Blocks	
  in	
  Taiwan:	
Vulnerable:	
  10140	
  /	
  Total:	
  91405	
  IP	
11.09%	
  vulnerable!!	
Agenda	
•  IntroducGon	
•  PLEAD	
  began	
•  PLEAD	
  malware	
  analysis	
•  PLEAD	
  lateral	
  movement	
•  GD	
  Rat:	
  Hiding	
  behind	
  PLEAD?	
•  The	
  phantom	
  of	
  routers	
•  Conclusion	
Conclusion
•  PLEAD	
  has	
  targeted	
  TW	
  for	
  at	
  least	
  5	
  years.	
•  Phantom:	
– Several	
  RATs,	
  developed	
  in	
  shellcode	
– Diskless	
  RAT	
  used	
  with	
  Hacking	
  Team	
  tool	
– Excellent	
  0day	
  exploits	
  for	
  post-­‐exploitaGon	
– Gdrive	
  RAT	
  might	
  be	
  their	
  data	
  exﬁltraGon	
  tool	
– Routers,	
  embedded	
  devices	
  are	
  used	
  as	
  C2	
Q	
  &	
  A	
PI:EMAIL	
PI:EMAIL