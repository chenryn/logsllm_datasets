578
577
Category
Shopping
Finance and Investing
Ent. & Music
Educational Site
Hosting
Count
572
502
313
305
298
Table 5: Top 10 categories of the unbiased dataset < 10K
hashes.
Figure 5: Mined blocks over time from the Coinhive net-
work. Black parts mark outages of our infrastructure.
can be sure that the PoW input was the one that was used to mine
the block. This uniquely identifies the origin as each block contains
the Coinbase transaction (first leaf of the Merkle tree) which is
used to pay the block rewards to the miner (i.e., Coinhive). Thus
we could never by accident see a Merkle tree root of another miner
in the PoW input.
We investigate the PoW inputs that are delegated by Coinhive
to its users by connecting to one of their mining pools and request
a new PoW input every 500 ms. As the network finds a new block
on average every two minutes, we cluster the PoW inputs by the
pointer to the previous (at time of reception, most recent) block.
We found that we never obtain more than 8 different PoW inputs
(even though more exist theoretically). Coinhive currently operates
32 mining endpoints (which can be gathered from the javascript
or by enumerating the domain name), when we connect to all of
them and repeat the process, we observe at most 128 different PoW
inputs per block. While this suggests that there are two endpoints
per backend system, it also puts us into the position to actually
investigate each of the 128 PoW inputs and check the Merkle tree
root against the Merkle tree root of the transactions in the block
that was actually mined after that referenced in the PoW input.
Measurements. We have been requesting new PoW inputs for
four weeks and we are thus able to confidently estimate a lower
bound on the blocks mined through Coinhive. Figure 5 shows a blue
block for every Coinhive-mined block as well as the total number
of blocks on that day. As finding blocks correlate with users mining
through Coinhive, we were interested to see if blocks are found
at certain times which could hint at the geolocation of the users.
However, the figure (upper subplot) shows that blocks are found
throughout the whole day which might be an indicator of the global
reach of Coinhive. We find multiple days with significantly more
blocks than on average, e.g., the 30th of April, 10th and 22nd of
May 2018. The 30th of April precedes Labor Day, a public holiday in
010%Blocks010305070911131517192123HourofDay(UTC)26.04.1803.05.1810.05.1817.05.1824.05.18Day010#BlocksmedianIMC ’18, October 31–November 2, 2018, Boston, MA, USA
Rüth et al.
[MH/s]
Med. Avg. Hashrate Currency
[XMR]
[blocks/day]
1231
8.8
9.0
1293
9.7
10.0
9.0
9.1
1215
5.5
5.5
5.8
May
June
July
Table 6: Coinhive mining statistics for three month in 2018.
over 80 countries, time zone shifts to UTC or holidays could explain
increased Internet usage resulting in more mined blocks. Similarly,
the latter two were Ascension Day and the day after Pentecost,
both public holiday in many (mostly) European countries.
In the median (average), we find 8.5 (9.0) blocks per day, we
noticed a disruption of Coinhive’ service on the 6th and 7th of
May which resulted in only a few to no announced PoW inputs.
We can estimate the combined hash rate of Coinhive by taking
the network’s difficulty into account. The difficulty denotes the ex-
pected number of hashes that are required to find a block which is
adjusted after each block such that the block rate of two minutes is
met. Over the course of our observations, the median difficulty was
55.4G hashes, which translates to a network hash rate of 462M h/s.
As Coinhive mines roughly 8.5 blocks per day, they produce 1.18%
of all 720 blocks/day which translates to 5.5M h/s. If we assume
that a web client performs between 20 to 100 h/s, then Coinhive
requires between 292K and 58K constantly mining users. Compare
our findings with numbers reported by Coinhive [4] from Septem-
ber 2017 is difficult. Coinhive wrote that their hash rate peaked
at 13.5M h/s (then 5% of the network’s hash rate). However, our
results are averages over long periods of time and derived from
the statistical properties of the network, while those published are
momentary peak rates, thus a direct comparison is not possible.
If we sum up the block rewards of the actually mined blocks
over the observation period of four weeks, we find that Coinhive
earned 1,271 XMR. Table 6 complements our four-week analysis
with three full months in 2018 showing its continuity. Similar to
other cryptocurrencies, Monero’s exchange-rate fluctuates heavily,
at the time of writing one XMR is worth 120 USD, having peaked at
400 USD at the beginning of 2018. Thus, assuming 120 USD, Coin-
hive mines Moneros worth around 150,000 USD per month of which
they say, they give 70% to their users. Still, the operational costs
seem manageable, making it potentially profitable for Coinhive.
Takeaway. Coinhive currently contributes ∼1.18% of the mining
power of the Monero network. While probably profitable for Coinhive,
it remains questionable whether mining is a feasible ad alternative.
5 RELATED WORK
Browser-based mining has been subject to substantial media cover-
age, e.g., reports on Pirate Bay [9] mining, about hacked websites
for mining [28], miners injected into the Google’s DoubleClick ad-
platform [26] or drive-by Monero mining on Android [22]. Many
blog posts exist that report on Alexa-listed websites to include min-
ing code [2, 17], however, without detailing a methodology. A list
published on Github [21] provides an overview of potential mining
domains. However, this list also includes entries such as google.com
which is unlikely to be mining. To the best of our knowledge, [8]
are the first to academically investigate browser-based mining par-
allel to our work. While they also find Coinhive to be the most
prominent service, their analysis is based on a string search over
a large set of HTTP bodies, thus not accounting for actual HTML
structure which we did in our first analysis (see Section 3.1) which
showed to already produce skewed results, e.g., the categories of
websites significantly differs. We thus complement their results by
incorporating WebAssembly fingerprinting and further shed light
on the inner workings of Coinhive. In concurrent work, Konoth
et al. [13] estimate revenue for websites on the Alexa Top 1M in-
cluding mining scripts. Further, they also analyze the nature of
Wasm mining for detection using a very similar methodology to
what was the basis for our fingerprinting such as counting certain
instruction or memory access pattern. Based on monitoring DNS,
[1] also observes Coinhive as the dominant player. They report
that most crypto miners are present on adult websites in the Alexa
Top 1K/3K. Similar with regards to link-forwarders, [14] analyzed
ad-based link forwarding services and their revenue model which
relates to that of Coinhive, thus we believe their results to also
apply here.
6 CONCLUSION
This paper analyzes the prevalence of browser-based mining, a new
revenue generating model to monetize websites and an alternative
to ad-based financing that is enabled by ASIC resistant cryptocur-
rencies such as Monero. By inspecting 137M .com/.net/.org and
Alexa Top 1M domains for mining code, we indeed find websites
that utilize browser-mining. Yet, the prevalence of browser mining
is currently low at < 0.08% of the probed sites. For its detection,
we find the public NoCoin filter list to be insufficient to broadly
detect browser mining. We thus present a new technique based
on WebAssembly fingerprinting to identify miners, up to 82% of
thereby identified mining websites are not detected by block lists.
We identify Coinhive as the largest web-based mining provider
used by 75% of the mining sites. Given its popularity, we further
dissect Coinhives’ link-forwarding service. We find that 10 heavy
users contribute over 80% of all short links mostly targeting stream-
ing and filesharing services. The remaining short links target a
diverse set of websites. We continue by dissecting the economics of
Coinhive, we devise a new method that allows associating mined
blocks with a mining pool and we find that Coinhive mines 1.18%
of all Monero blocks and their visitors have a combined median
hash rate of 5.5M h/s. While we find that Coinhive turns around
Moneros worth 150,000 USD per month, the current value stability
of cryptocurrencies requires further investigations if browser-based
mining can be an alternative revenue model to ad-based financ-
ing. Further, the impact of the CPU intensive miner on a website’s
performance, a mobile device’s battery lifetime or a visitor’s en-
ergy bill is yet to be quantified but it could be a huge hurdle to be
competitive to ad-based financing on a larger scale.
ACKNOWLEDGMENTS
Funded by the Excellence Initiative of the German federal and state
governments, as well as by the German Research Foundation (DFG)
as part of project B1 within the Collaborative Research Center (CRC)
1053 – MAKI. Further, we thank Martin Coughlan from Symantec
for granting us access to the RuleSpace classification engine as well
as the network operators at RWTH Aachen University, especially
Jens Hektor and Bernd Kohler.
Digging into Browser-based Crypto Mining
IMC ’18, October 31–November 2, 2018, Boston, MA, USA
REFERENCES
[1] 360Netlabs and Xu Yang. 2018. Who is Stealing My Power: Web Mining Domains
Measurement via DNSMon. http://web.archive.org/web/20180515135858/http:
//blog.netlab.360.com/who-is-stealing-my-power-web-mining-domains-
measurement-via-dnsmon-en/. Archived on 2018-05-15.
[2] AdGuard. 2017. Cryptocurrency mining affects over 500 million people. And they
have no idea it is happening. http://web.archive.org/web/20180515160301/https:
//adguard.com/en/blog/crypto-mining-fever/. Archived on 2018-05-15.
[3] ChromeDevTools. 2018. DevTools Protocol API docs – its domains, methods,
and events. http://web.archive.org/web/20180517161942/https://github.com/
ChromeDevTools/debugger-protocol-viewer. Archived on 2018-05-17.
[4] Coinhive. 2017.
http://web.archive.org/web/
20180515151445/https://coinhive.com/blog/status-report. Archived on 2018-
05-15.
First Week Status Report.
[5] Coinhive. 2018. Coinhive – Monero JavaScript Mining. https://web.archive.org/
web/20180515073251/https://coinhive.com/. Archived on 2018-05-15.
[6] Crypto-Loot. 2018. Crypto-Loot - A Web Browser Miner | Traffic Miner | CoinHive
Alternative. https://web.archive.org/web/20180515073236/https://crypto-loot.
com/. Archived on 2018-05-15.
[7] Robert DeVoe. 2017. Tombs.io Launches Collaborative Online Game Powered by
Monero Mining. http://web.archive.org/web/20180516070407/https://btcmanager.
com/tombs-io-launches-collaborative-online-game-powered-monero-mining/.
Archived on 2018-05-16.
[8] Shayan Eskandari, Andreas Leoutsarakos, Troy Mursch, and Jeremy Clark. 2018.
A first look at browser-based Cryptojacking. In IEEE Security & Privacy on the
Blockchain.
[9] Guardian. 2017.
Ads don’t work so websites are using your electric-
http://web.archive.org/web/20180515115349/https:
ity to pay the bills.
//www.theguardian.com/technology/2017/sep/27/pirate-bay-showtime-ads-
websites-electricity-pay-bills-cryptocurrency-bitcoin. Archived on 2018-05-15.
[10] Guardian. 2017. Billions of video site visitors unwittingly mine cryptocur-
http://web.archive.org/web/20180516072539/https:
rency as they watch.
//www.theguardian.com/technology/2017/dec/13/video-site-visitors-
unwittingly-mine-cryptocurrency-as-they-watch-report-openload-
streamango-rapidvideo-onlinevideoconverter-monero.
2018-05-16.
[11] Oliver Hohlfeld. 2018. Operating a DNS-based Active Internet Observatory. In
Archived on
ACM SIGCOMM Posters and Demos.
[12] Hosh (hoshsadiq). 2018.
Github: Block lists to prevent JavaScript min-
ers. http://web.archive.org/web/20180517153826/https://github.com/hoshsadiq/
adblock-nocoin-list. Archived on 2018-05-17.
[13] Radhesh Krishnan Konoth, Emanuele Vineti, Veelasha Moonsamy, Martina
Lindorfer, Christopher Kruegel, Herbert Bos, and Giovanni Vigna. 2018.
MineSweeper: An In-depth Look into Drive-by Cryptocurrency Mining and
Its Defense. In ACM CCS.
[14] Nick Nikiforakis, Federico Maggi, Gianluca Stringhini, M. Zubair Rafique, Wouter
Joosen, Christopher Kruegel, Frank Piessens, Giovanni Vigna, and Stefano Zanero.
2014. Stranger Danger: Exploring the Ecosystem of Ad-based URL Shortening
Services. In ACM WWW ’14.
[15] Omsk Social Club and !Mediengruppe Bitnik. 2018. Cryptorave #5 Alexiety -
0b673cce.xyz. http://web.archive.org/web/20180515160638/https://0b673cce.xyz/.
Archived on 2018-05-15.
[16] Paper Authors. 2018. Coinhive Link Forwarding Example to Youtube. http:
//web.archive.org/web/20180516094141/https://cnhv.co/3w88o. Archived on
2018-05-16.
[17] Pixalate. 2017. Pixalate unveils the list of sites secretly mining for cryptocur-
rency. http://web.archive.org/web/20180515155855/http://blog.pixalate.com/
coinhive-cryptocurrency-mining-cpu-site-list. Archived on 2018-05-15.
[18] Proofpoint. 2018.
Smominru Monero mining botnet making mil-
https://web.archive.org/web/20180515071304/https:
lions for operators.
//www.proofpoint.com/us/threat-insight/post/smominru-monero-mining-
botnet-making-millions-operators. Archived on 2018-05-15.
Extract
[19] Public Interest Registry. 2018. Zone File Access. http://pir.org/.
[20] Jan Rüth. 2018. Coinhive Paper Tools. https://doi.org/10.5281/zenodo.1421702.
(and
[21] Paul Sec. 2018.
http:
also from investigations) using coin-hive mining service.
//web.archive.org/web/20180515161228/https://gist.github.com/PaulSec/
029d198a1e049acead74c31db0de1466. Archived on 2018-05-15.
from the Top 1M Alexa domains
[22] Jérôme Segura. 2018. Drive-by cryptomining campaign targets millions
http://web.archive.org/web/20180515162842/https:
of Android users.
//blog.malwarebytes.com/threat-analysis/2018/02/drive-by-cryptomining-
campaign-attracts-millions-of-android-users/. Archived on 2018-05-15.
[23] Seigen, Max Jameson, Tuomo Nieminen, Neocortex, and Antonio M. Juarez. 2013.
CryptoNight Hash Function. CRYPTONOTE STANDARD 008.
[24] Symantec. 2018.
Advanced Web Intelligence - RuleSpace | Syman-
tec. http://web.archive.org/web/20180516095136/https://www.symantec.com/
products/rulespace. Archived on 2018-05-16.
[25] The Monero Project. 2018. Monero - secure, private, untraceable. http://web.
archive.org/web/20180517083008/https://getmonero.org. Archived on 2018-05-
17.
[26] TrendMicro. 2018. Malvertising Campaign Abuses Google’s DoubleClick to De-
liver Cryptocurrency Miners. http://web.archive.org/web/20180515134601/https:
//blog.trendmicro.com/trendlabs-security-intelligence/malvertising-campaign-
abuses-googles-doubleclick-to-deliver-cryptocurrency-miners/. Archived on
2018-05-15.
[27] Verisign. 2018. Zone Files For Top-Level Domains (TLDs). verisign.com.
[28] Mark Ward. 2018. Websites hacked to mint crypto-cash. http://web.archive.org/
web/20180515154917/http://www.bbc.com/news/technology-41518351. Archived
on 2018-05-15.
[29] WebAssembly Community Group. 2018. WebAssembly. http://web.archive.org/
web/20180525093453/https://webassembly.org. Archived on 2018-05-25.
[30] Jason Whitehorn. 2011. jsMiner. http://web.archive.org/web/20180517091106/
https://github.com/jwhitehorn/jsMiner. Archived on 2018-05-17.