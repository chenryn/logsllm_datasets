—127—
⑤传输层安全(TLS) Transport Layer Security
TLS 的功能类似于 SSL，相当于 SSL3.1 版本，但是它使用更健壮的认证和加密协议。
SSL 和 TLS 都有以下功能特性：
*支持在不安全的网络中提供安全的客户-服务器方式通信，并防止篡改、欺骗和窃听。
*支持单向认证。
*使用数字证书支持双向认证。
*通常实现为一个 TCP 包的初始载荷，允许它封装所有的更高层协议的有效载荷。
*可以应用在低层，如在第三层(网络层)作为一个 VPN。这被称为 OpenVPN。
此外，TLS 能用于加密 UDP 和会话初始协议(SIP)连接。SIP 是一个和 VoIP 有关联的协议。
⑤安全电子交易(SET) Secure Electronic Transaction
这是一种在互联网上进行交易传输时所使用的安全协议。SET 的基础是 RSA 加密以及数据
加密标准(DES)。主要的信用卡公司都支持 SET，例如 Visa 和 MasterCard 。然而，SET 没有
被互联网广泛接受：相反，SSL/TLS 加密的会话是安全电子商务的首选机制。
⑥安全外壳 SSH (Secure Shell)
安全外壳(SSH)在功能上类似于一种隧道机制，它为远程计算机提供终端式访问。SSH 是
一种能够用于通过网络访问另一台计算机的程序。SSH 在易受攻击的通道(如 Intemet)上提供
身份验证和安全传输。两台计算机会进行握手，并且(通过 Diffie-Hellman)交换会话密钥，
这个会话密钥将在会话过程中加密和保护传送的数据。SSH 应当取代 Telnet、FTP、rlogin、
rexec 或 rsh 使用，它们提供的功能与 SSH 的功能是一样的，但是安全程度要低得多。
⑦IPSec/Intemet 协议安全(Intemet Protocol Security, IPSec)
必考，详见第四域 C.3 章节。
2.用于身份验证的（必考）
①密码身份验证协议(PAP) Password Authentication Protocol
这是一种用于 PPP 的标准身份验证协议。PAP 以明文的形式传递用户名和密码，不提供任
何形式的加密；只是简单地提供了一种从客户端向身份验证服务器传输登录凭证的手段。
②挑战握手身份验证协议(CHAP) Challenge Handshake Authentication Protocol
这是在 PPP 链接上使用的一种身份验证协议。CHAP 对用户名和密码进行加密。它通过使
用不能重放的“挑战——响应”对话来执行身份验证操作。在建立的通信会话持续期间，CAHP
也会定期对远程系统重新进行身份验证，从而验证远程客户端的持久性身份。这个活动对用户
是透明的。
③可扩展身份验证协议(EAP) Extensible Authentication Protocol
这是一个身份验证架构/框架，而不是一种实际的协议。EAP 允许自定义身份验证安全解
决方案，例如支持智能卡、令牌和生物测定学。
上述三种身份验证协议最初用在拨号 PPP 连接上。现在，大量的远距离连接技术(包括宽
带和 VPN) 都应用了这些协议与其他很多较新的身份验证协议和概念。
④EAP，PEAP 和 LEAP
受保护的可扩展认证协议(PEAP)Protected Extensible Authentication Protocol 封装
在一个 TLS 隧道中。PEAP 优于 EAP 是因为 EAP 假设信道已经被保护，但是 PEAP 实施自己的
—128—
安全。PEAP 在802.11 无线连接上用于保障通信安全。PEAP可以采用无线协议接入WPA和WPA-2
连接。PEAP 也优于思科专有的 EAP ，即轻量级的 EAP 协议 Lightweight Extensible
Authentication Protocol (LEAP)。LEAP 是思科对不安全 WEP 的一个对策。LEAP 支持频繁的
再认证和 WEP 密钥的变化（WEB 使用单个认证和一个静态密钥）。然而，LEAP 可以被各种工具
和技术进行破解，包括漏洞利用工具 Asleap。
C.1 语音
常规的专用分支交换/专用小型交换机/用户级交换机(PBX) Normal private branch
exchange 或普通传统电话服务(POTS)plain old telephone service 或公共交换电话网络
(PSTN) public switched telephone network 的语音通信容易遭受截获、偷听、分机窃听和
其他利用。
1.互联网语音协议(VoIP)
VoIP 是一种将语音封装成 IP 数据包并支持音频电话通过 TCP/IP 网络进行连接的技术。
一些 VoIP 系统其本质上是纯明文形式的通信，这将容易被拦截和窃听。
*呼叫 ID 可以轻易的被伪造，从而执行语音钓鱼(VoIP phishing)攻击或在网络中进行语
音垃圾邮件(SPIT)攻击 Spam over Internet Telephony。
*呼叫管理系统和 VoIP 电话本身漏洞可能会受到 DOS 攻击。
*黑客可能会通过欺骗用户进行回拨的方式发动中间人(MitM)攻击。man-in-the-middle
*不加密的 VoIP 流量可以通过解码的方式被监听。
电信诈骗什么的社会工程学就不提了。
2.直接拨入系统访问控制 DISA
PBX 系统的“安全”一般会用直接拨入系统访问控制(DISA)，此系统被设计为通过为用户
指派访问码来帮助管理 PBX 的外部访问和外部控制。
这种系统会遭到飞客（phreaker）的危害和滥用。一旦外部的飞客获悉了 PBX 访问码，他
们往往能够完全控制和滥用公司的电话网络，这包括使用 PBX 将长途呼叫的计费指向公司的电
话账户，而不是指向飞客的电话。飞客行为(phreaking)是一种针对电话系统的特定攻击类型。
飞客使用各种技术回避电话系统，从而获得免费的长途呼叫、更改电话服务的功能、窃取特殊
的服务甚至导致服务中断。下面列出了你需要了解的一些飞客工具（前提是已经搭线）：
①黑盒。控制线路电压，只是使用电池和线夹定做的电路板。（加电）
②红盒。模拟硬币存入付费电话时的声音来盗打电话，比如用磁带录音机。（投币）
③蓝盒。模拟与电话网络主干系统直接互动的 2600Hz 声音，可以是哨子、磁带录音机或
数字音频生成器。（发声）
④白盒。用于控制电话系统，它是一种双音多频(DTMF)生成器(就是键盘)，维修员有这样
的装备。（控制）
记忆：黑电（黑店）、红币（人民币）、蓝声（男声）、白控。
3.传真的安全
可以通过传真加密器、链路加密、活动日志以及异常报告提高安全性。
—129—
C.2 多媒体协作（例如：运程会议技术、即时消息）
视频会议，即时消息 IM，互联网中继聊天 IRC 什么的，它们有三种类型：
①P2P 网络；②代理通讯；③面向服务的网络。它们的安全很重要，重点讲下电子邮件。
电子邮件服务器通过使用简单邮件传输协议(SMTP) Simple Mail Transfer Protocol 接
收来自客户端的消息，向其他服务器传送这些消息，并且将消息存放入用户基于服务器的收件
箱。除了电子邮件服务器之外，这个基础架构还包括电子邮件客户端。客户端通过邮局协议版
本 3 (POP3) Post Offi ce Protocol version 3 或互联网消息访问协议(IMAP) Internet Message
Access Protocol 从基于服务器的收件箱中检索电子邮件。互联网兼容的所有电子邮件系统都
依赖于 X.400 标准定位和处理邮件。
Sendmai1 是 UNIX 系统中最常用的 SMTP 服务器，Exchange 是 Microsoft 系统中最常用的
SMTP 服务器，而 GroupWise 则是 Novell 系统中最常用的 SMTP 服务器。
1.安全多用途互联网邮件扩展(S/MIME) Secure Multipurpose Internet Mail Extensions
S/MIME 通过公钥加密和数字签名为电子邮件提供了身份验证和隐私保护。通过 X.509 数
字证书能够提供身份验证，隐私则是通过使用公钥密码术标准(PKCS)加密提供的（使用 PKI）。
使用 S/MIME 可以构成两种类型的邮件：
①签名的邮件 signed messages：提供了完整性和对发送者的身份验证。
②安全封装的邮件 enveloped message：提供了完整性、对发送者的身份验证以及机密性。
MIME 对象安全服务 MIME Object Security Services (MOSS)为邮件提供身份验证、机密
性、完整性和不可否认性。MOSS 利用了 MD2 和 MD5（Message Digest）算法、RSA 公钥以及数
据加密标准(DES)，从而提供了身份验证和加密服务。经 MIME 加密的邮件格式后缀名为.P7S。
2.隐私增强邮件(PEM) Privacy Enhanced Mail
隐私增强邮件 PEM 是一种电子邮件加密机制，它使用 RSA、DES 和 X.509 提供了身份验证、
完整性、机密性和不可否认性。
3.域名密钥识别邮件(DKIM) DomainKeys Identified Mail
DKIM 是一个重要的手段，通过域名的身份验证来检测邮件发送自哪个组织。
4.可靠加密/良好的隐私(PGP) Pretty Good Privacy
可靠加密/良好的隐私(PGP) 是一个使用多种加密算法对文件和电子邮件进行加密的公私密钥系统。它使用 RSA 来管理密钥，使用国际数据加密算法(IEDA)来加密数据，使用 MD5 来
提供完整性，使用公钥证书来提供身份验证，对消息进行加密签名来实现不可否认性，但是以
后的版本提供了算法选择。PGP 不是标准，而是一个自主开发的产品。它获得互联网草根阶层
广泛的支持。PGP 最初是任何人都可以使用的免费产品，但是随后又被分为两个不同的产品。
PGP 是一种商业产品；而 OpenPGP 是一个正在开发的标准，GnuPG 依从这个标准，并且这个标
准被免费软件基金会独立开发。
PGP 使用自己的数字证书，不使用 PKI 的 CA。也就是说，PGP 是端到端的互相信任，PKI
只信任 CA。PGP 的每个用户都有一个称为密钥环(key ring)的文件，它是从其他用户那里接收
的公钥的集合。密钥环上的每个密钥都有一个参数，该参数表明相应用户的可信程度以及这个
特定密钥的有效性。
—130—
C.3 远程访问（例如：VPN、屏幕截取、虚拟应用/桌面、远程办公）
这里讲远程接入的安全。客户端可以采用这样的形式建立远程通信会话：
①使用调制解调器直接拨号登录远程访问服务器。
②在互联网上通过 VPN 连接至某个网络。
③通过瘦客户端(thin-client)连接与某个终端服务器系统相连接。
当然，还有卫星什么的接入手段。
1.安全措施
①传输保护
各种加密，这可能包括 VPN、SSL，TLS、SecureShell (SSH)、IPSec 以及 L2TP。
②身份验证
可能包括密码验证协议(PAP)、挑战握手验证协议(CHAP)、扩展验证协议(EAP 或者它扩展
的 PEAP 或 LEAP)、远程验证拨号用户服务(RADIUS) 以及终端访问控制器访问控制系统
(TACACS+)。
一个集成的身份验证机制通常使用 802.1x，即 EAP+RADIUS。
2.拨号协议
拨号协议的两个最主要的例子，PPP 和 SLIP。
①点对点协议(PPP) Point-to-Point Protocol
一种全双工协议，用于在各种非 LAN（局域网）连接上传输 TCP/IP 数据包，这些连接包
括调制解调器、ISDN、VPN 和帧中继等。它通过使用各种协议(例如 CHAP 或 PAP)实现身份验证。
PPP 是替换 SLIP 的协议，并且可以支持任何 LAN 协议，而不是只支持 TCP/IP。
②网络串行线路协议(SLIP) Serial Line Internet Protocol
这是一种较老的技术，用于支持异步串行连接(例如串行线缆或调制解调器拨号)上的
TCP/IP 通信。SLIP 已很少使用，不过仍然得到很多系统的支持。SLIP 只能够支持 IP 协议，
需要静态的 IP 地址，不提供差错检测或纠正功能，并且不支持压缩。
3.集中化的远程身份验证服务
集中化的远程身份验证服务(例如 RADIUS 和 TACACS+) 就提供了这种额外的保护层。具体
看第五域 B.3 章节吧。
4.远程访问服务
这里描述的服务许多用于 UNIX 操作系统。
①Remote Shell (RSH)
从概念上讲，因为它们是建立在相互信任的基础上，因此可以滥用于被获得水平访问权限
和垂直提升权限的攻击。它们的认证和传输能力在设计时没有考虑安全性，因此，它们必须使
用封装(如，X11)或通过 SSH 代替 Telnet 和 Rlogin，来获得安全性。
②Telnet
是一个基于命令行的协议，其设计目的是给通过命令行访问到另一个主机。虽然 WINDOWS
实现了这个协议，但 telnet 的最初是用在 UNIX 服务器世界中，事实上，一个 telnet 服务器
是任何 UNIX 服务器标准配置。它存在的问题：
*极不安全，事实上，它使用在不受信任的环境中，会造成严重的安全隐患。
—131—
*提供有限的用户名/密码认证。
*不提供加密。
一旦攻击者获得了正常用户的凭据，他很容易完成权限升级，他可以在机器上传输数据和
执行命令。作为运行在系统特权上的 Telnet 服务器，它本身就是一个有吸引力的攻击目标；
攻击正使用 Telnet 服务器的漏洞可以提升系统权限。因此，建议安全从业人员在互联网和互
联网连接的主机上停止使用 Telnet。事实上，标准的 Internet 服务器安全加固过程中，任何
服务器都应该禁用的 Telnet 服务，在 UNIX 系统通常运行 telnet 进程下，并应利用 ssh v2 远
程管理和管理所需的范围。
③远程登录(rlogin)，远程 shell(RSH)，远程复制(RCP)
rlogin 是一种使用 rlogin 授予远程访问机器的协议，通常是一个 UNIX 服务器。
同样，RSH 被赋权直接远程命令执行，RCP 拷贝数据或远程机器。如果一个 rlogin daemon
(rlogind)进程，在一台主机上运行远程访问，可以通过两种方式获得：
*通过中央配置文件使用；
*通过用户配置。
后者，用户可以授权访问，而不是由系统管理员允许的。同样的机制适用于 RSH 和 RCP，
虽然他们都是依靠不同的守护进程(rshd)。其认证是基于主机/IP 地址，虽然基于用户 ID 的
rlogin 授予访问权限，但它不做验证：即，如果请求来自受信任的主机，则 ID 远程客户端所
声明的权限，即被授予给该 ID，rlogin 协议传输数据没有加密，因此受窃听和截取。
更安全的 SSH v2，可以替代 rlogin,rsh 和 rcp。
④SSH
相当于 SSL+Telenet
SSH 隧道的保护通信的完整性，防止会话劫持，中间人攻击。有两个不兼容的版本，SSH-1
和 SSH-2。SSH-2 具有改进的完整性检查(SSH-l 容易由于弱 CRC-32 完整性检查插入攻击)，支