DigiCert Inc
ContentWatch, Inc.
NetSpark, Inc.
Sweesh LTD
IBRD
Cloud Services
Other (332)
4,788
1,200
966
927
829
589
310
267
167
109
95
62
61
52
49
42
42
39
26
23
1,121
Table 1: Issuer Organization ﬁeld values
Proxy Type
Connections Percent
Personal Firewall
Enterprise Firewall
Personal/Enterprise Firewall
Organization
Malware/Spam
Unknown
6,384
463
1,528
1,448
1,141
800
54.27%
3.94%
12.99%
12.31%
9.70%
6.80%
Table 2: Classiﬁcation of claimed issuer
of the relevant ﬁelds to identify the issuing organization and
their software products, using web searches to determine their
identity. We emphasize that our results in this section are
based on the intercepting proxy self-identifying themselves in
the certiﬁcate. It is certainly possible that malicious proxies
have hidden their tracks by masquerading as a legitimate
organization in the Issuer Organization ﬁeld, and we cannot
detect this.
Table 1 shows the values for the Issuer Organization ﬁeld
of the substitute certiﬁcates. Table 2 provides a breakdown
of values present in the Issuer Organization ﬁeld of the sub-
stitute certiﬁcates. The majority of certiﬁcates from proxied
connections have an Issuer Organization ﬁeld matching the
name of a personal or enterprise ﬁrewall (71.2%). Another
12.3% have the name of an organization set as the Issuer
Organization (e.g., Lawrence Livermore National Labora-
tory, Lincoln Financial Group). Additionally, 6.8% (800)
of the substitute certiﬁcates have null values for the Issuer
Organization ﬁeld.
ClientHelloServerHelloWeb ServerServerHelloClientHello(1)(2)(3)CertificateBrowser: HTTPS RequestHTTPS Response with Flash Measurement ToolClientTLS Proxy?CertificateCertificate1488The most suspicious activities discovered were revealed
by certiﬁcates with an Issuer Organization that matched
the names of malware. “Sendori, Inc”, “WebMakerPlus Ltd”,
and “IopFailZeroAccessCreate” appeared in 966, 95, and 21
Issuer Organization ﬁelds, respectively. Sendori poses as a
legitimate enterprise, however they produce software that
compromises the DNS lookup of infected machines, allowing
them to redirect users to improper hosts. A TLS proxy
component is used to bypass host authenticity warnings in
the browser. The substitute certiﬁcates generated by the
TLS proxy are signed by a root authority that was added to
the root store of the local machine at the time of infection.
Substitute certiﬁcates issued by Sendori originated from 30
distinct countries.
The WebMakerPlus malware is primarily associated with
inserting advertisements into Web pages. Since modern
browsers issue warnings when insecure content is queried
from secure connections, we hypothesize that WebMakerPlus
uses a TLS proxy to simulate that their advertisements
are served from a secure connection. Substitute certiﬁcates
containing markings for WebMakerPlus originated from 16
distinct countries.
Manual Internet queries revealed that malware was re-
sponsible for an Issuer Common Name ﬁeld value of “Iop-
FailZeroAccessCreate”. The certiﬁcates containing this value
originated from 14 distinct countries. Disturbingly, each cer-
tiﬁcate contained the same 512-bit public key. This malware
was also reported by [4].
In addition to malware discoveries, we found that the
names of two companies highly associated with spam were
also present in numerous Issuer Organization ﬁelds. The
names “Sweesh LTD”, and “AtomPark Software Inc” were
found in 39 and 20 substitute certiﬁcates, respectively. Atom-
Park oﬀers tools for spammers including “email extractors”
and “bulk mailers”. Sweesh oﬀers services to spammers to
overcome “hurdles” faced by advertisers and publishers. In-
ternet searches reveal that Sweesh may be responsible for
the development of WebMakerPlus.
2.2 Negligent Behavior
Where possible, we installed and characterized personal
ﬁrewall software from many of the most common companies
whose names were provided in the Issuer Organization, Issuer
Organizational Unit, and Issuer Common Name ﬁelds of our
collected certiﬁcates. We characterized the behavior of these
solutions when running behind our own TLS proxy which
issued certiﬁcates signed by an untrusted CA. While most
solutions properly rejected our forged certiﬁcates, Kurupira, a
parental ﬁlter that is responsible for 267 proxied connections
in our dataset, did not. When visiting google.com and
gmail.com, Kurupira replaced our untrusted certiﬁcate with
a signed trusted one, thus allowing attackers to perform
a transparent man-in-the-middle attack against Kurupira
users without having to compromise root stores. In contrast,
BitDefender not only blocked this forged certiﬁcate, but also
blocked a forged certiﬁcate that resolved to a new root we
installed in the victim machine’s root store.
Among the negligent behavior we found are TLS proxies
that generate substitute certiﬁcates with weak cryptographic
strength. Our original certiﬁcate has a public key size of 2048
bits. However, we ﬁnd that 5,951 (50.59%) substitute certiﬁ-
cates have public key sizes of 1024 bits and 21 certiﬁcates
have public key sizes of 512 bits. 23 (0.20%) TLS proxies
generated substitute certiﬁcates that used MD5 for signing,
21 (0.18%) which were also 512 bit keys. Interestingly, some
TLS proxies generated certiﬁcates that have better crypto-
graphic strength than our certiﬁcate. Seven (0.06%) used
certiﬁcates with a key size of 2432 and ﬁve (0.04%) used
SHA-256 for signing.
In addition to problems with cryptographic strength, we
discovered that 49 (0.42%) substitute certiﬁcates claim to be
signed by DigiCert, though none of them actually are. The
original certiﬁcate from our secure web server is issued by
DigiCert High Assurance CA-3, indicating the TLS proxy
likely copied this ﬁeld when creating the substitute.
Finally, we note that 110 substitute certiﬁcates have modi-
ﬁcations to the subject ﬁeld. For 51 (0.43%) certiﬁcates, the
subject did not match our website’s domain. In many cases
a wildcarded IP address was used that only designated the
subnet of our website. In two cases the substitute certiﬁcate
is issued to the wrong domain entirely: mail.google.com
and urs.microsoft.com. These certiﬁcates appear to be
legitimate for those domains and properly validate back to
GeoTrust and Cybertrusts roots, respectively.
3. CONCLUSION
Using an automatic measurement tool and a Google Ad-
Words campaign, we show that corporations and a surprising
number of individuals are deploying proxies to protect against
malware, phishing, and other undesirable practices. How-
ever, our study also shows that malware is using this same
technique, comprising 9.70% of all proxied connections, and
that spammers are using TLS proxies in their products. In
some cases a personal ﬁrewall acting as a TLS proxy may
weaken user security. Our analysis of the Kurupira parental
ﬁlter ﬁnds that it masks forged certiﬁcates from an attacker,
allowing the attacker to easily perform a MitM attack against
the ﬁrewall’s users. We also ﬁnd numerous other suspicious
or negligent circumstances in substitute certiﬁcates, such as
a null Issuer Organization, falsiﬁed DigiCert signatures, and
downgraded public key sizes.
4. REFERENCES
[1] M. Alicherry and A. D. Keromytis. Doublecheck:
Multi-path veriﬁcation against man-in-the-middle
attacks. In 14th IEEE Symposium on Computers and
Communications (ISCC), pages 557–563. IEEE, 2009.
[2] B. Amann, M. Vallentin, S. Hall, and R. Sommer.
Extracting certiﬁcates from live traﬃc: A near real-time
SSL notary service. Technical report, TR-12-014, ICSI
Nov. 2012, 2012.
[3] R. Holz, T. Riedmaier, N. Kammenhuber, and G. Carle.
X.509 forensics: Detecting and localising the SSL/TLS
men-in-the-middle. In 17th European Symposium on
Research in Computer Security (ESORICS), pages
217–234. Springer, 2012.
[4] L.-S. Huang, A. Rice, E. Ellingsen, and C. Jackson.
Analyzing forged ssl certiﬁcates in the wild. In IEEE
Symposium on Security and Privacy, 2014.
[5] M. Marlinspike. SSL and the future of authenticity.
Black Hat USA, 2011.
[6] D. Wendlandt, D. G. Andersen, and A. Perrig.
Perspectives: Improving SSH-style host authentication
with multi-path probing. In USENIX Annual Technical
Conference, pages 321–334, 2008.
1489