102
81
03
03
85
04
101
50
04
02
40
04
03
30
05
01
76
05
02
87
06
01
43
06
03
56
θ7
02
67B不满足
89
07
03
94
18
rows
inset
（0.00
sec)
通过自连接查询的语句如下：
http://liyangbit.com
22
---
## Page 23
Chapter1.超经典MySQL练习50题
Python数据之道
mysql>
select s2.s_id from Score s2
joinScores3
on s2.s_id=s3.s_id
wheres2.c_id='01'
ands3.c_id='02';
θ1
θ2
θ3
θ4
θ5
rows
in set （0.00 sec）
查询出学号后再匹配出学生信息：
mysql>
from Student s1
第二步
where s idin（
select s2.s_id from Score s2
join Score s3
on s2.s_id=s3.5_id
where s2.c_id='θ1'
and s3.c_id='02'
）：
PL
S_name |s_birth
Is_sex
01
赵雷
1990-01-01
男
θ2
钱电
1990-12-21
男
03
孙风
1990-05-20
男
04
李云
1990-08-06
男
05
周梅
1991-12-01
女
rows
in set （0.θθ sec)
http://liyangbit.com
23
---
## Page 24
Chapter1.超经典MySQL练习50题
Python数据之道
通过where语句实现：
mysql> select s1.
->from Student s1，Score s2，Score s3
->where s1.s_id=s2.s_id
->and s1.s_id=s3.s_id
->and s2.c_id=01 and s3.c_id=02;
where语句实现
s_id 1s_name |s_birth
1s_sex
θ1
赵雷
|1990-01-01
男
θ2
钱电
1990-12-21
男
θ3
孙风
1990-05-20
男
θ4
李云
1990-08-06
男
05
周梅
|1991-12-01
1女
rows in set (0.θθ sec)
方法3的实现：
nysql> select *
fron Student
Mheres_id1n（select sc1.s_1d·指定学号是符合要求的
from (select * fron Score s1 where sl.c_id=*01') sc1,
(select *fron 5core s1 where s1.c_1d=*e2') sc2
mhere sc1.s_id=sc2.s_id):
s_id I s_nane I s_birth
1 s_sex 1
01
赵雷
|1990-01-01|男
92
线电
1996-12-21
孙风
1990-05-20
男
03
94
李云
1996-88-06
男
05
周梅
1991-12-01|女
1.11题目10
1.11.1题目需求
查询学过01课程，但是没有学过02课程的学生信息（注意和上面题目的区别)
http://liyangbit.com
24
---
## Page 25
Chapter1.超经典MySQL练习50题
Python数据之道
1.11.2SQL实现
首先看看哪些同学是满足要求的：只有06号同学是满足的
[mysql>select*fromScore;
C
id
sscore
中
+：
01
01
80
01
θ2
90
01
03
96
θ2
01
70
θ2
02
60
θ2
03
80
θ3
01
80
03
θ2
81
03
03
85
θ4
01
50
θ4
θ2
40
04
03
30
05
01
76
05
θ2
87
06
01
43
06
3
56
07
θ2
89
θ7
03
94
18
rows
inset(0.00
sec)
1.11.2.1错误思路1
直接将上面一题的结果全部排出，导致那些没有学过01课程的学生也出现了：07，08
http:/liyangbit.com
25
---
## Page 26
Chapter1.超经典MySQL练习50题
Python数据之道
select s1,*
from Student s1
where s_id not in (
直接将上面
导致那些没有学过01课程的
学生也出现了：07，08
select s2.s_id from Score s2
join Score s3
on s2.s_id=s3.s_id
where s2.c_id=*01* and s3.c_id ='02
）；
mysql>
select s1.
>
from Student s1
where s_idnot in
select s2.s_id from
Score s2
join Score s3
on s2.s_id=s3.s_id
wheres2.c_id='01'ands3.c_id='02
）：
PL
s_name
s_birth
sex
06
吴兰
1992-03-01
女
07
郑竹
1989-07-02
女
08
王菊
1990-01-20|
女
rows
in set （0.00 sec）
1.11.2.2错误思路2
将上面题目中的02课程直接取反，导致同时修过01，02，03或者只修01，03的同学也会出现
select s1,*
fron Student s1
where s_id in (
select s2.s_id from Score s2
join Score s3
on s2.s_1d=s3.s_id
where s2.c_id=*01* and s3.c_id !=*02*
直接取反是不行的，因为修改
(01,02 , 03) 的 同学 也会出现
)；
http:/liyangbit.com
26
---
## Page 27
Chapter1.超经典MySQL练习50题
Python数据之道
fros 5tu
ent s1
Score s3
fres 5core s2
直接最反是不行的，因为排改（01.02.83）的用学也会出现
1.11.2.3正确思路
https://www.jianshu.com/p/9abffdd334fa
方法1：根据两种修课情况来判断
select s1.*
fron Student s1
where sl.s_id in (select s_id from Score where c_id='01')
=-修过01课程，更保
and s1.s_id not 1n (select s_id from Score where c_id='02');
留
==哪些人修过 02 ,
需要排除
mysql> select s1.*
->
fron Student s1
-> where s1.s_id in (Lelect s_id fron Score where
（.t0.=P
->
and si.s id not in
(select s_id from Score
..+.....
...+........
yas 1 weus l pss
1s_sex 1
06
吴兰
|1992-03-01|女
/
1 row in set (0.θ9 sec)
http://liyangbit.com
27
---
## Page 28
Chapter1.超经典MySQL练习50题
Python数据之道
[mysql> select s_1d fron Score where
c_1d=*01':
s_1d
课程01出现的学号，需要保留
θ4
185
106
6 rows in set (0.θ9 sec)
[mysql> select s_id from Score where
c_id ='02
s_id1
课程02出现的学号，需要排除
01
θ2
03
04
05
rows 1n set (0.99 sec)
！！！！！方法2：先把06号学生找出来
select * from Student where s_id in (
select s_id
from Score
where c_id='θ1*
修过 81课程的学号
and s_id not in (select s_id
同时学号不能在修过02课程中出现
from Score
where c_id=′02')
http://liyangbit.com
28
---
## Page 29
Chapter1.超经典MySQL练习50题
Python数据之道
mysql> select s_id
->from Score
-> where c_id=*θ1'
-> and s_id not in (select s_id from Score where c_id=*θ2'):
_id
row in set (θ.08 sec)
mysql>
Select*from Student where s_id in(
select s_id
from Score
where c_id='01*
ands_idnot in（select s_id
主体部分
from Score
where c_id='θ2')
）：
s_id1
S_name Is_birth
s_sex
06
1吴兰
|1992-03-011女
row
in
set
(0.00 sec)
1.12题目11
1.12.1题目需求
查询没有学完全部课程的同学的信息
1.12.2SQL实现
自己的方法
select *
排除学号后得别的结果
from Student
where s_id not in (select s_id from (select s_id, count(s_id) as number
量大课程数所在的学号需要排除
from Score
http://liyangbit.com
29
---
## Page 30
Chapter1.超经典MySQL练习50题
Python数据之道
group by s_id) s
-取别名
where number=(select max (number)
--2.保证最大的课程数
from( select s_id, count(s_id) as number
1.学号和个数统计 (即
修了几门课)
from Score group by s_id) t)) ;
别名
1_idnof
Ct s_id fron (select s_id, cour
nt(s_ie) as nusber
-3.量大课程数账在的学
p by s_i6) s
fron( select s_i6,
-2.保证最大的速程款
ron Score gt
:((1(ps"s kg dno
1.学号和个替的计（即修了几门课）
1 s_sex 1
1991-12-81 |女
10-0-766
1女
x 1 62-18-9661
自己的方法一开始在课程的最大数中没有使用Course表，导致多使用了一个临时表的结果，现在改成使用
Course表的统计值（3）作为课程的总数：
fron Student s
select s, *
where s_id not in (
select s_id
from Score s1
group by s_id
having count(*) = (select count(*) from Course)
);
mysql> select s.*
->from Student s
-> where s_id not in (
select s_id
>
from Score s1
>
group by s_id
having count(*)=（select count(*) from Course)
->）：
s_id|
s_nane
|s_birth
1s_sex|
+*...
95
|周梅
|1991-12-01
女
06
吴兰
1992-03-01
女
|郑竹
1989-07-021
女
@7
王菊
11990-01-20
女
rows
1nset
(0.66 sec)
http://liyangbit.com
30
---
## Page 31
Chapter1.超经典MySQL练习50题
Python数据之道
方法2：having
select s, *
from Student s
left join Score s1
学生表
成绩表
on sl.s_id = s.s_id
group by s.s_id
学号分组
having count(s1.c_id) select
*
from Score;
id
C
id
S
score
01
01
80
01
2
90
01
03
96
θ2
01
70
02
02
60
θ2
03
80
θ3
01
80
1
03
02
81
03
03
85
1
04
01
50
04
02
40
04
03
30
05
01
76
05
θ2
87
06
01
43
06
03
56
07
02
89
07
03
941
18
rows in set （o.oo sec)
具体实现过程为：
select *
3、求出学生信息
from Student
where s_id in (
select distinct s_id
号去重，同时将01白己排除
from Score
where c_id in (
http://liyangbit.com
32
---
## Page 33
Chapter1.超经典MySQL练习50题
Python数据之道
select c_id
from Score
where s_id=01
找出学号01同学的全部课程
10
and s_1d 1= 61);
）
11
3、求出学生售息
here s_id 1n (
froa Scare
select distinct s_16
2.提出满足速程在村学生课理中的全部学号（学生】。学号造量，黄时济中1自己用是
ere s_1d=61
1.批出享号01用学的全部速程
1s_birth
方法 2
fron Student s1
select s1.*
3
join Score s2
on sl.s_id = s2.s_id
学生表和成绣表的关联
and c_id in (select c_id from Score where s_id=o1)
对课程进行限制，只在01学
生的课程内
group by s1 s_id;
=根据学号分组
mysql> select s1.*
-> joia Score s2
-> from 5tudent s1
->on 51.5_1d=52.5_1d--学生表和成表的关联
> and c_id fa (select c_id frem Score where s_id=e1)
课程在01所学的课程内
名：pssq dno
q1Jμ4"s 1 aaeu"s 1 ps“s |
1s_sex 1
赵雷
钱电
|1990-01-011男
02
1990-12-211男
93
04
李云
孙风
1996-08-061男
1996-05-20
1男
1991-12-91
吴兰
|1992-03-91|女
女
1989-07-921
http://liyangbit.com
33
---
## Page 34
Chapter1.超经典MySQL练习50题
Python数据之道
1.14题目13
1.14.1题目需求
查询和01同学学习的课程完全相同的同学的信息
1.14.2SQL实现
1.自己的方法
select *
from Student