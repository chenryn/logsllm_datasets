### 65
**授权使用限制：清华大学。下载时间：2021年3月20日，UTC时间09:56:40，来源：IEEE Xplore。适用相关限制。**

当电流 \( I \) 流过时，总电荷将线性减少，参见公式 (2)。总电荷被离散化为 \( N \) 个大小为 \( \Gamma = C / N \) 的部分。以电流 \( I \) 放电时，减少一个电荷单位需要的时间为 \( \Gamma / (I \cdot T) \) 时间单位。同时，放电会使高度差增加 \( \Gamma / c \)，这是高度差的离散化步长。

一旦从可用电荷井中抽取了一些电荷，电荷将在边界和可用电荷井之间开始流动。这是一个非线性过程，由公式 (2) 中的第一个方程的第二部分描述：
\[ \frac{d\delta}{dt} = -k \cdot \delta. \]
该微分方程的解为：
\[ \delta(t) = \delta(0) \cdot e^{-k \cdot t}. \]
如果在时间点 0 处的高度差为 \( \delta = m \cdot \Gamma / c \)，那么减少一个单位高度差所需的时间为：
\[ t = -\frac{1}{k} \cdot \ln\left(\frac{m-1}{m}\right). \]
为了获得减少一个单位高度差所需的步数，我们将这个时间 \( t \) 除以 \( T \) 并四舍五入到最接近的整数。

### 3 线性定价时态自动机

本节非正式地描述了线性定价时态自动机网络（NLPTA），它们作为输入用于Cora [22]。通过一个例子来说明NLPTA的主要成分。这个例子本身与电池调度无关，但很好地展示了NLPTA的重要组成部分。

#### 3.1 时态自动机网络

NLPTA的基本组成包括位置、开关、时钟、守卫条件、不变量、赋值和通道。一个NLPTA由一组并行运行并通过通道通信的时态自动机构成。

图2（来自[3]的例子）展示了一个非常简单的NLPTA，仅包含两个组件。该网络模拟了一个灯的行为，其行为取决于开/关开关何时被按下。图2(a)展示了灯的行为模型，可以看到三个位置off、low和bright，分别表示灯关闭、低亮度和高亮度的状态。初始位置是off。从off到low的转换标记为接收操作（用问号表示）在通道press上。只有当图2(b)中的用户模型执行相应的发送操作（用感叹号表示）在通道press上时，才能进行此转换，即两个时态自动机在通道press上同步。

在执行off→low转换时，时钟变量 \( y \) 被重置为0，通过赋值 \( y := 0 \)。时钟是实数值变量，用于测量时间：时钟值随时间线性增加，速率为1。时钟用于根据时间表达启用和紧急条件。例如，low→off转换标记有守卫条件 \( y \geq 5 \)，这意味着只有当时钟 \( y \) 的值至少为5时，才能执行此转换。在这种情况下，如果用户再次按下按钮，灯将关闭。

### 4.3 电池调度

在负载自动机（图5(c)）中，数组load_time用于确定负载中不同时间段的开始和结束时间。数组cur用于确定时间段是否包含任务（cur[j]>0）或空闲期（cur[j]=0）。当时间段包含任务时，负载自动机将通过new_job通道与调度器自动机同步，以安排下一个电池。在任务结束时，负载自动机通过go_off通道与分配的电池同步，将其关闭。这两个同步对于空闲期是不需要的，因为没有电池被使用。

当负载自动机通过new_job通道与调度器自动机（图5(d)）同步时，调度器将以非确定性方式通过go_on通道与其中一个电池同步。如果在任务过程中某个电池耗尽，调度器会选择另一个电池继续任务。尽管电池仍可以恢复一些电荷，但我们假设一旦观察到电池为空，它就不能再被使用。

最优调度是指使系统寿命最长的调度，即两个电池达到empty位置所需时间最长的调度。我们希望模型检查器找到通向该状态的最长路径。不幸的是，Cora无法找到通向目标状态的最长路径。因此，有必要将最长路径问题转化为最小成本问题。这通过添加最大查找器自动机（图5(e)）来实现。当电池为空时，总电荷自动机会在emptied通道上通知最大查找器自动机。最大查找器自动机计算空电池的数量。当所有电池都为空时，最大查找器自动机会在allempty通道上广播，停止其他自动机中的所有进程。此时，最大查找器自动机将剩余的电荷转换为成本。导致系统寿命最长的路径将使用最多的电荷，因此剩余的电荷最少。

---

**版权信息：**
978-1-4244-4421-2/09/$25.00 © 2009 IEEE