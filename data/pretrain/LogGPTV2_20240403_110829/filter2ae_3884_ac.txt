，网络分区策略和隔离手段无疑是必备、必要的安全策略，但如果不能伴随更强有力的内网安全策略，其可能带来更大的安全风险。安全策略和安全投入，需要基于以内网已被穿透和“内鬼”已经存在作为前提假定来实行。
**大国防御力，由设计所引导、以产业为基础、与投入相辅相成，但最终其真实水平，要在与攻击者和窥探者的真实对垒中来检验。**
### 2.4 超级攻击组织攻击载荷具备全平台覆盖能力
2015年初卡巴斯基和安天先后对“方程式”组织使用的恶意代码进行分析曝光后，“方程式”组织又在2016年一系列事件中浮出水面。在2016年8月和10月，一个自称“影子经纪人”（Shadow
Brokers）的黑客团体所曝光的资料显示了“方程式”组织和此前被斯诺登曝光的ANT攻击装备存在一定联系，并由此看到其针对Cisco、Juniper、Fortinet等防火墙产品达成注入和持久化的能力。“影子经纪人”爆料“方程式”组织从2000年开始入侵了全球大量服务器，包括部分
Solaris、Oracle-owned
Unix等版本的操作系统，尽管并未提供证据，但这与安天的捕获分析工作相互印证，一个关于这个超级攻击组织的几乎无死角的、全平台化攻击能力已经日趋清晰。在这种情况下，安天于2016年11月4日发布《从“方程式”到“方程组——EQUATION攻击组织高级恶意代码的全平台能力解析》报告，独家分析了其Solaris平台和Linux平台的攻击样本，这是业内首次正式证实这些“恶灵”真实存在的公开分析。
图 5 “影子经济人”爆料的“方程式”组织在2000~2010年间在全球范围内入侵服务器的情况
在过去数年，这种分析如此漫长、复杂和艰难，超出了我们之前对“震网”、“火焰”的分析和复现中所面临的挑战。这种高度复杂、隐蔽的全能高级恶意代码，无论是对受害者，还是分析者来说，都是一个巨大的挑战。特别是当其打击范围几乎覆盖所有体系结构与操作系统的时候，相对更擅长Windows、Linux和Android等主流操作系统平台下恶意代码分析的传统安全分析团队感受到了巨大的压力和挑战。如果用这个组织的名称“方程式”做一个关于分析难度的比喻的话，我们需要破解的已经并不只是一个“方程式”，而是更为复杂的多元多次的“方程组”。通过梳理当前对“方程式”组织的主要分析成果和爆料，可以看到“方程式”组织的多平台操作系统覆盖能力图表：
**表1“方程式”组织多平台操作系统拼图**
注：安天在Solaris样本中分析出的User Agent具有Solaris标识，而卡巴斯基在“EQUATION GROUP: QUESTIONS AND
ANSWERS”中披露出曾捕获到Mac OS X的User Agent的信息，由此来看，尽管安天、卡巴斯基等厂商，目前都尚未捕获Mac OS
X的样本，但方程式组织针对MAC OS X的攻击载荷是真实存在的。
安天希望用自己的工作告诉用户，那些关于超级攻击组织全平台覆盖能力的种种爆料并非传说，而且是一种真实的威胁，是一种既定的事实。而这种武器，不仅被用于攻击隔离网内的传统高等级目标，也被用于攻击互联网节点。
在我国安全防御的实践中，有一种先入为主的观点，即认为由于各种规定和约束，暴露在互联网上的节点，乃至能够访问互联网的内网中，并不存放高价值的信息。“一切有价值的信息都存在于隔离网内”——这是一个美好的愿景和想象，但并非是这个信息大量产生、高速流动时代的真实情况。同时在大数据时代，高价值信息的定义和范围也在不断变化着。更多的信息资产已经不可避免地分布在公共网络体系中，而对这些资产的窥视和攻击也在持续增加着。而超级攻击组织则是类似攻击的始作俑者和长期实践者。
针对DNS服务器的入侵，可以辅助对其他网络目标实现恶意代码注入和信息劫持；针对邮件服务器的植入可以将用户所有的邮件通联一网打尽，针对运营商骨干节点的持久化，可以用来获取全方位的信息，包括收获类似Camberdada[12]计划中说的那种“轻而易举的胜利（An
Easy Win）”。
注：Camberdada计划是斯诺登曝光的一份监听行动计划，相关机构通过在运营商的持久化节点，监听用户发放给杀毒厂商的邮件，以发现自己的攻击是否暴露，并实现对其他方投放的样本捕获和再利用。
就像我们此前所概括的那样，相关超级攻击组织拥有“成建制的网络攻击团队、庞大的支撑工程体系与制式化的攻击装备库、强大的漏洞采集和分析挖掘能力和关联资源储备以及系统化的作业规程和手册，具有装备体系覆盖全场景、漏洞利用工具和恶意代码载荷覆盖全平台、持久化能力覆盖全环节的特点。面对这种体系化、既具备工业级水准又具有高度定向性的攻击，永动机注定停摆，银弹注定哑火。想要达成防御效果，实现追踪溯源，唯有以清晰的战略、充分的成本投入，以体系化的防守对决体系化的攻击，通过长期艰苦、扎实的工作和能力建设，才能逐渐取得主动。”
### 2.5 网络空间的商业军火进一步降低APT成本
网络空间安全中的“商业军火”，是指以商业产品方式进行销售和交易的、具有武器级水准的攻击平台、恶意代码、漏洞及其利用程序，以及其他的用于助力达成攻击的工具或组件等。其中包括Cobalt
Strike等商用攻击平台，也包括RIG、Magnitude等漏洞工具包等。安天在2015年5月27日发布的《一例针对中国官方机构的准APT攻击事件中的样本分析》[13]中，充分解读了商业攻击平台Cobalt
Strike在攻击中发挥的作用，并指出“商业攻击平台使事件的攻击者不再需要高昂的恶意代码开发成本，相关攻击平台亦为攻击者提供了大量可选注入手段，为恶意代码的加载和持久化提供了配套方法。这种方式降低了攻击的成本，使得缺少雄厚资，也缺少精英黑客的国家和组织依托现有商业攻击平台提供的服务即可进行接近APT级水准的
攻击，而这种高度“模式化”的攻击也会让攻击缺少鲜明的基因特点，从而更难追溯。”而在2016年全年，中国所遭遇到的APT攻击中，能反复看到Cobalt
Strike的痕迹。友商360企业安全对此发布了报告跟进分析[14]。
## **商业军火通常具有以下几个特点：**
• 具备武器级水准
商业军火不是一般性质的恶意代码或者漏洞情报，而是具有武器级水准的攻击装备，以Cobalt
Strike为例，其尽管号称是开源漏洞测试平台Metasploit和Armitag（Metasploit的图形界面）的商用版本，但其Payload能力完全是按照实战设计的——可投放载荷覆盖全操作系统平台、格式文档载荷包括大量可构造溢出格式、载荷可以实现样本不落地、窃密加密回传和远程加密控制。其根本不是一般意义上的漏洞扫描测试平台，更不是军火商自我比喻的靶弹，而是真实的带有战斗目的的导弹。
• 高附加值交易是维持商业军火交易供需关系的纽带
商业军火尽管反复出现在APT攻击中，但商业军火的供应是商业行为，而不是类似TAO等攻击组织人员的职务行为。同时，尽管木马交易和漏洞交易都一直存在，但商业军火不是传统黑产低水准的木马交易买卖，也不是传统的漏洞收购，而是高质量的攻击装备“商品”，这使这种交易既是高附加值的，也是规模化的。如其提供的实际是有效的、包括0Day漏洞利用工具，而不是基本的漏洞信息或POC，其木马往往带有较高的模块化水平和Rootkit能力。
• 商业军火的出品机构往往具有一定的政经背景
以Cobalt Strike的出品人Raphael Mudge为例（美国），他曾经是美国空军的安全研究员，渗透实验的测试者。并深度参与Red Team项目。
表 2 Raphael Mudge的履历
• 商业军火背景下的能力流动导致威胁复杂化