== 报表
为了更方便的查看日志统计信息，您可以使用日志易的报表功能，将多个趋势图合并为一个报表，并按时发送至指定邮箱。一个报表最多可添加10个趋势图。
image::images/report-list.png[]
在列表页上，可以对报表可以进行如下操作：
* 标签过滤：根据标签选择过滤显示同组的报表
* 删除报表
* 禁用报表
* 查看报表记录：
** 报表生成历史记录：支持界面查询完整的报表生成历史
** 单次报表文件记录：支持点击查看单次报表生成的PDF结果
报表的新建和配置界面，提供以下功能：
* 设置报表名称、标签、所属应用等
* 设置报表描述：描述文字将渲染在报表文件的起始位置
* 设置报表运行用户：报表内所有趋势图请求都将使用该用户的搜索权限
* 设置是否在交易日执行并选择交易日历：该配置同时运用于报表任务的运行和报表内各趋势图的查询时间范围。
* 设置报表运行计划：
** 间隔式：支持日报、周报、月报三种发送频率。日报即意味着报表内所有趋势图搜索范围都是最近一天。同理，周报都是最近一周，月报都是最近一月。如需特殊时段，请采用 SPL 中的 startime/endtime 语法设定。
** crontab式： 采用标准的crontab式语法设定报表发送频率。您可以在填写完毕后，点击输入框右侧的"解析" 按钮， 在弹出层预览"最近十次执行时间"，确保编写的 crontab 语法符合预期。
+
image::images/report-schedule-preview.png[]
+
** 高级计划配置：点击展开更多计划配置后，可以配置运行计划的优先级和启动窗口：
*** 优先级：可以设置报表任务的优先级为默认、高和更高。
*** 启动窗口：可以设置报表任务的启动窗口为无、5/15/30分钟、1/2/4/8小时、自动或自定义时间窗口。当选择自动时，日志易系统将根据任务的历史运行耗时来自动确定监控的最佳窗口配置。
* 模板渲染报表邮件主题：支持模板渲染的动态邮件主题
* 设置报表收件人、抄送人、密送人：设置报表的邮件收件、抄送、密送人。如果不设置收件人，报表依旧运行，只生成文件供页面下载查看。
* 设置邮件类型：支持PDF，URL，WORD和EXCEL邮件格式发送报表，配置时可以点击"预览"选择"下载到本地预览"或"运行测试"（发送报表到配置的邮箱），实际运行一次报表，从而验证报表配置是否符合预期。
** EXCEL 格式下，每个趋势图独立占用一个工作表空间。
** PDF 格式下，按照自定义布局排列趋势图。
** WORD 格式下，按照自定义模板渲染趋势图内容。
** URL 格式下，报表文件只包含一行 PDF 下载地址。
* 图表是否显示在邮件正文：是/否/采用系统设置。除 URL 格式以外，其他报表可以选择是否在邮件正文中平铺图表数据。注意：正文中超过 100 行的表格内容将强制忽略，请点击附件查看全部内容。
邮件类型配置同时存在于系统设置和日志易 Manager 中。优先级为：任务设置 > 系统设置 > Manager 设置。report.type为系统默认配置，新建报表，默认报表类型是report.type中的格式。但是也同时支持用户配置格式。例如report.type设置为PDF，新建报表设置格式为WORD，则生成的报表格式是WORD。
报表支持编辑趋势图配置：可编辑内容为名称，描述，搜索内容，图表类型。用户可以选择图表类型，更改参数配置。
image::images/report-edit-qushitu.png[]
基本设置完成后，即可点击下一步开始趋势图配置。不同的报表格式，有不同的趋势图配置方法。
=== PDF 报表布局
只有PDF类型才支持布局设置。当选择的布局数量不足以放下选中趋势图时，从头开始继续。
image::images/report-buju.png[]
当布局配置中有table数据展示时，如果布局大小不足以放下完整的table数据行数，布局位置将只展示前10行预览，表格下方添加一个跳转链接：【全部内容，请查看附表-N】，然后在报表最后附录完整表格内容。例如下图： 
image::images/report-table-tomuch.png[]
如果您的报表中大量使用表格形式，且表格内数据较长，建议不要选择任何布局。系统将自动采用顺序渲染方式依次往下排列各个图表，并能较好的完成表格列宽的调整。
=== Word 富文本报表
WORD 类型支持富文本设置。在富文本编辑器中，您可以像编辑 Word 文档一样，进行页眉页脚设置，页码设置，目录设置，文字的字体大小和颜色设置，粗细斜体下划线设置，居中居上居下、左对齐右对齐设置，插入图片，插入表格（支持隐藏/显示边框），设置正文和标题样式，设置代码背景样式等。
需要设置目录效果时，您需要先把相关文字从正文设置为：标题1、标题2、标题3，然后点击插入目录。系统将自动生成页内链接跳转。
如果企业内部有统一的 Word 样式要求，则可以通过"系统设置-报表配置-报表统一样式"功能，上传统一的 Word 样式示例文件。日志易将自动提取样例文件中的标题1、标题2、标题3、正文的字体字号行间距等样式配置，强制运用到所有的 Word 富文本报表任务上。无需您逐一任务配置。
image::images/report-global-style.png[]
此外，您可以按需选择插入上下型文字环绕的趋势图和段内嵌入型的单值趋势图两种不同效果。
趋势图采用文字环绕效果时，趋势图的各部分可以独立删减。为了更好的区分不同的趋势图，在模板编辑中，将采用 `.` 的占位符来代表不同趋势图的不同组建部分。比如一个名为 `lv_line` 的折线图，将包含以下可删减组件：
. `lv_line.name` ：趋势图名称
. `lv_line.description` ：趋势图描述文字
. `lv_line.chart` ：趋势图实际图表内容
. `lv_line.timerange` ：趋势图本次搜索查询时间范围
单值趋势图采用段内嵌入效果时，趋势图的各部分不单可以独立删减，还可以分开挪到到段内文本的其他位置上，以便更好的生成比较通顺的报表文案。如下图所示：
image::images/report-word-tmpl.png[]
如果有其他更灵活的布局需要，则可以通过插入表格的方式完成。光标停留在一个表格单元格内，再选择插入趋势图，则该趋势图会限定在这个单元格内。如果是单纯的布局目的，在插入表格时，可以勾选'无边框'。
点击趋势图.chart 上的编辑小图标，可以打开编辑弹窗，修改报表内趋势图配置：
image::images/report-word-chart-edit.png[]
=== Word 模板文件
如果要制作页面富文本编辑器依然满足不了的复杂报表，您可以直接采用个人电脑桌面端上的 MS Office 或 WPS Office 软件，完成报表的样式设置，文本编写等绝大多数内容，然后，将需要填充的趋势图、表格、统计值位置，写上诸如 `{{N.chart}}` 的替换占位符，然后把保存的文件通过 Word 模板文件管理的方式运用到日志易中。
==== 模板文件管理
报表列表页右上角，点击"其他-报表模板管理"，打开报表模板列表页。点击"新建"进入报表模板的创建流程。
. 填写模板名称；
. 点击本地上传，上传个人电脑上已经编辑完成的Word 模板文件；
. 点击下一步，进入内容编辑，可以对照右侧布局设计的内容，逐一配置 Word 模板文件中每一个替换占位符对应的实际趋势图信息。
. 全部占位符的趋势图配置完毕后，点击完成。
image::images/report-word-tmpl-edit.png[]
==== 使用模板创建报表任务
报表列表页右上角，点击"新建-使用模板"，除报表类型为 Word 不可修改以外，基础设置和普通报表一致。点击下一步进入内容编辑，选择之前已经创建好的模板文件，即可直接保存完成。
image::images/report-create-from-tmpl.png[]
当模板文件管理内再次编辑内容时，所有使用该模板的报表任务，都会自动运用编辑后的新内容。您可以巧妙的运用报表运行用户的数据权限区别，为不同部门、不同业务创建同一个模板的不同报表任务。
如果有个别趋势图内容需求不一致的，可以在报表的内容编辑步骤中，单独修改具体趋势图。日志易会自动合并模板默认内容和报表独立变更的内容。
如果您不打算让报表内容持续和模板文件保持一致，则可以点击"新建-从空白开始"，然后在编辑方式中，选择"使用模板"，临时性选择报表文件或本地文件上传。
image::images/report-use-tmpl-from-blank.png[]
<<<