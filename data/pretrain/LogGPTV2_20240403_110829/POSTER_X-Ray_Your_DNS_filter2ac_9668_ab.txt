resolvers. AFNIC operates the Zonemaster1, which crawls domains
and provides information about the connectivity and configuration
of the zonefile and the nameservers. There are also commercial
services, such as2 which monitor latency and availability of name-
servers. Tools for measuring resolvers focus on checking whether
the ports are randomly selected. Such service is offered by the DNS
OARC via a porttest tool. These tools do not provide an insight
into the internals of the DNS resolution platforms.
3 DNS X-RAY
System Design. DNS X-Ray is composed of a client side script
running in browsers, nameservers hosting our zone files to which
we trigger DNS requests and a website, which displays the analysis
of DNS platforms and statistics in form of graphs and charts of all
the collected data. DNS X-Ray components are illustrated in blue in
Figure 1. Using our own nameservers allows us to receive requests
from the tested DNS platforms and based on requests/responses to
learn information about the components in a tested DNS platform.
We use two hierarchies in DNS for our study each is configured in a
separate zonefile. DNS X-Ray is running on four Ubuntu servers and
uses MongoDB to store the collected raw data. Our implementation
of the DNS resolution functionality is based on the Stanford DNS
server. The analysis of the statistics is performed by Perl scripts on
the webserver.
Methodology. DNS X-Ray uses the standard DNS request/response
behaviour. Client side script triggers specially crafted DNS requests
for records in our domains. The DNS requests (including the re-
quested records and their type), that arrive from the DNS platforms
at our nameservers, are used to infer information about the caches
hidden behind the IP addresses of the tested DNS platform. DNS
X-Ray ‘decouples’ the caches from the IP addresses and counts
the number of caches and the IP addresses. Based on the caching
behaviour, specifically eviction of cached records and overwriting
of the cached records with new values, we learn the DNS software
on the caches. DNS X-Ray also infers the operating system on the
caches based on ports’ allocation by egress IP addresses in DNS
platform.
Data Collection and Statistics Generation. After each eval-
uation of DNS X-Ray on a new network the data is added to the
1http://zonemaster.net/
2http://dnscheck.pingdom.com/
PosterCCS’17, October 30-November 3, 2017, Dallas, TX, USA2520database and the statistics are recalculated to incorporate the new
results.
We analyse the collected data and generate the following output:
the number of caches used by the tested DNS resolution platform,
DNS software on the caches, number of egress IP addresses, net-
works and countries where the egress IP addresses are hosted,
whether the egress resolvers use random source ports and TXIDs.
The focus of DNS X-Ray is to collect the basic information about
the components on the DNS platforms, and in particular to charac-
terise the caching component, e.g., its software. Nevertheless, we
implemented DNS X-Ray in a modular way so that we can easily
extend it with new graphs and charts. Specifically, we store all the
collected data during the evaluation of a given DNS platform in a
database, hence we can define new graphs that would be calculated
over all the previously collected data. For instance, we can extend
DNS X-Ray to present statistics about the latency to each DNS
platform, nameserver selection, IP identifier assignment or even
support of cryptography, such as DNSSEC validation [RFC4033-
RFC4035].
Non-Exposure to Attacks. DNS X-Ray does not expose to at-
tacks neither the network on which it is evaluated nor other net-
works. A user can only evaluate the security of DNS platform on a
network to which it has access. This does not introduce an addi-
tional threat to the network on which a user evaluates DNS X-Ray.
Since the user anyway has access to its network - it can itself trig-
ger queries to DNS platform to evaluate its security. We do not
allow evaluating networks to which a user does not have access
to. Finally, the traffic volume that is generated to measure the DNS
platform is moderate (14 tests each repeated 30 times) and lasts for
5-10 minutes.
Bypassing Local Caches. Upon invocation on a given network,
a script running in client’s browser causes the stub resolver on
client’s machine to send DNS requests to the resolution platform
(Figure 1). However, since DNS X-Ray does not have a direct access
to the DNS resolution platform, the requests will go through inter-
mediate caches; see [5] for more details. To cope with intermediate
caches DNS X-Ray maps the same hostname to multiple aliases
using CNAME records. We setup q DNS records in our
cache.example zone mapping them to CNAME DNS record as
follows:
x-1.cache.example
x-2.cache.example
...
x-q.cache.example
name.cache.example IN A
IN CNAME name.cache.example
IN CNAME name.cache.example
IN CNAME name.cache.example
a.b.c.d
Then the script running in client’s browser triggers q DNS re-
quests for names x-1.cache.example,...,x-q.cache.example. The lo-
cal caches are not involved in the resolution process (specifically
in resolving the CNAME redirection) and only receive the final
answer.
4 CONCLUSIONS
Our current view of basic Internet components is based on stan-
dardisation documents and initial designs. However, most systems
significantly evolved since their conception. Furthermore, typically
the networks or Internet operators make different choices when
setting up their infrastructure. In order to evaluate or improve secu-
rity of the basic Internet components a clear understanding thereof
is important. We design and implement DNS X-Ray - which enables
users to evaluate DNS platforms and security of their components,
as well as to obtain collective information about DNS platforms in
other networks in the Internet. DNS X-Ray is important to allow
clients to identify vulnerabilities in their DNS platforms even if
DNSSEC validation [RFC4033-RFC4045] is applied. This ensures
security even when DNSSEC is incorrectly adopted [13].
ACKNOWLEDGEMENT
The research reported in this paper has been supported in part by
the German Federal Ministry of Education and Research (BMBF),
by the Hessian Ministry of Science and the Arts within CRISP
(www.crisp-da.de/) and co-funded by the DFG as part of project
S3 within the CRC 1119 CROSSING. This work was also partially
supported by the HUJI Cyber Security Research Center in conjunc-
tion with the Israel National Cyber Bureau in the Prime Minister’s
Office.
REFERENCES
[1] Ruetee Chitpranee and Kensuke Fukuda. 2013. Towards passive DNS software
fingerprinting. In Proceedings of the 9th Asian Internet Engineering Conference.
ACM, 9–16.
[2] David Dagon, Niels Provos, Christopher P Lee, and Wenke Lee. 2008. Corrupted
DNS Resolution Paths: The Rise of a Malicious Resolution Authority.. In NDSS.
[3] Amir Herzberg and Haya Shulman. 2013. Fragmentation considered poisonous,
or: One-domain-to-rule-them-all. org. In Communications and Network Security
(CNS), 2013 IEEE Conference on. IEEE, 224–232.
[4] Amir Herzberg and Haya Shulman. 2013. Socket overloading for fun and cache-
poisoning. In Proceedings of the 29th Annual Computer Security Applications
Conference. ACM, 189–198.
[5] Amit Klein, Haya Shulman, and Michael Waidner. 2017. Counting in the Dark:
Caches Discovery and Enumeration in the Internet. In The 47th IEEE/IFIP Inter-
national Conference on Dependable Systems and Networks (DSN).
[6] Amit Klein, Haya Shulman, and Michael Waidner. 2017. Internet-Wide Study of
DNS Cache Injections. In INFOCOM.
[7] Marc Kührer, Thomas Hupperich, Jonas Bushart, Christian Rossow, and Thorsten
Holz. 2015. Going wild: Large-scale classification of open DNS resolvers. In
Proceedings of the 2015 ACM Conference on Internet Measurement Conference.
ACM, 355–368.
[8] Kyle Schomp, Mark Allman, and Michael Rabinovich. 2014. DNS resolvers
considered harmful. In Proceedings of the 13th ACM Workshop on Hot Topics in
Networks. ACM, 16.
[9] Kyle Schomp, Tom Callahan, Michael Rabinovich, and Mark Allman. 2013. On
measuring the client-side DNS infrastructure. In Proceedings of the 2013 conference
on Internet measurement conference. ACM, 77–90.
[10] Kyle Schomp, Tom Callahan, Michael Rabinovich, and Mark Allman. 2014. As-
sessing dns vulnerability to record injection. In Passive and Active Measurement.
Springer, 214–223.
[11] Craig A Shue and Andrew J Kalafut. 2013. Resolvers revealed: Characterizing
DNS resolvers and their clients. ACM Transactions on Internet Technology (TOIT)
12, 4 (2013), 14.
[12] Haya Shulman and Michael Waidner. 2014. Fragmentation considered leak-
ing: port inference for DNS poisoning. In International Conference on Applied
Cryptography and Network Security. Springer, 531–548.
[13] Haya Shulman and Michael Waidner. 2017. One Key to Sign Them All Considered
Vulnerable: Evaluation of DNSSEC in Signed Domains. In The 14th USENIX
Symposium on Networked Systems Design and Implementation (NSDI). USENIX.
[14] Yingdi Yu, Duane Wessels, Matt Larson, and Lixia Zhang. 2012. Authority Server
Selection of DNS Caching Resolvers. ACM SIGCOMM Computer Communication
Reviews (April 2012).
Jing Zhang, Zakir Durumeric, Michael Bailey, Mingyan Liu, and Manish Karir.
2014. On the Mismanagement and Maliciousness of Networks. In to appear)
Proceedings of the 21st Annual Network & Distributed System Security Symposium
(NDSS’14), San Diego, California, USA.
[15]
PosterCCS’17, October 30-November 3, 2017, Dallas, TX, USA2521