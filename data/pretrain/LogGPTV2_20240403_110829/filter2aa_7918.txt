# 告警筛选笔记

安全运营的一个关键任务是进行告警监控。随着安全行业的快速发展，各种安全产品不断涌现，产生了大量的数据，这对人力提出了更高的要求。然而，攻防对抗本质上是成本的较量。虽然海量告警有助于我们掌握整体安全态势，但过多的告警会增加实际研判的难度。因此，最理想的情况是用最少数量的告警精准地覆盖最全面的安全事件。为此，我们将探讨以下内容。

## 告警筛选

### 传统方法
- **风险筛选法**：关注高风险等级的告警。
- **规则筛选法**：关注特定防护规则产生的告警。
- **目标筛选法**：关注关键资产相关的告警。
- **失陷筛选法**：关注攻击源为内网主机的告警。

### 前沿技术
- **攻击链筛选法**：将告警与标准攻击步骤对应，关注构成攻击链的告警。
- **威胁情报筛选法**：利用云端共享信息，关注恶意IP相关的告警。
- **异常检测筛选法**：关注罕见类型、罕见端口等在统计分布中孤立或离群的告警。

关于异常检测筛选法，其本质是对安全能力依赖较小的方法，只需从正常数据中找出异常即可。但由于业务和网络环境复杂且独特，加上高危告警本身非常稀有，导致精准识别高风险非常困难。从成本角度考虑，使用机器学习和数据分析算法进行异常检测可以提高效率，但有监督学习方式对于海量数据来说，需要大量特征工程工作。

### 实战相关

#### 猜想一
人类专家在分析防护告警时，可能关注的是某种与攻击相关的、抽象层次很高的概念。具体指标，甚至是攻击方法和对象这样的浅层抽象，都只是参考信息。专家更关心的可能是攻击行为背后的潜在利益、攻击者的内在目的、信心和决心等更高层次的抽象。

#### 猜想二
最能反映这些抽象概念的信息可能位于告警载荷或原始网络流量中。这表明现有的防护系统可能存在缺陷——在根据原始流量生成告警的过程中，可能丢失了某些关键信息，而这些信息恰恰能够反映告警的实际重要程度。

### 方案的完善

1. **引入数据分析方法**
   - 信息处理过程高度抽象，难以直接定义处理逻辑，需通过机器学习找出关联。
   - 模型输入应为原始告警，输出应为重要性分值或分类。

2. **将告警载荷或原始流量内容纳入模型输入**
   - 告警载荷通常是二进制流数据，没有统一结构，目前尚不明确哪些成分能够真正反映告警重要程度。
   - 需要一种广泛的特征提取方法，将二进制流数据转换为模型可用的特征输入。

3. **需要人类专家的参与**
   - 真实环境中的信息安全事件稀缺，真阳性样本非常少。
   - 不同漏洞在不同场景下的利用方法千变万化，靶场模拟效果难以保证。
   - 需要设计一种方式，让模型能够从人类专家那里获取标注、反馈或其他关键知识。

### 一些思考

#### 机遇
当前国内的威胁情报发展仍处于起步阶段，存在以下机遇：
- **威胁情报的共享**：不同公司、部门甚至小组间的数据割裂严重。
  - 不同行业间
  - 不同公司间
  - 公司的不同部门间
  - 部门的不同小组间
- **威胁情报的生产**：自动化是未来方向，但对算法和场景的要求很高。
  - 私有化生产
  - 共享化交换
- **威胁情报的运营**：仅有数据而无人消费是无意义的。

#### 需要做的一些事情
安全运营专家的成长往往从实战开始，对真实攻击有深入了解，并在此基础上观察和思考防御的缺陷，解决人力、设备和组织架构等方面的难题。对于希望成为安全运营专家的人来说，持续学习技术、理解流程管理、深入研究产品和架构以及积极参与项目实战都是非常重要的。

加油！

## References
\[1] 【攻击意图评估：序】误报太多？谈海量告警筛选，[绿盟科技研究通讯](https://mp.weixin.qq.com/s/izwotbdfcxybZ02gIw-nFg)