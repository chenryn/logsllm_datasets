                v34 += _byteswap_ushort(*(_WORD *)v20);
                v33 = v48;
                v20 += 2;
              }
              *(_DWORD *)a3 = v34;
              a3 += 4;
              v32 = (char *)v51 + 1;
              v51 = (char *)v51 + 1;
              v30 = v55;
              if ( v20 > *(_DWORD *)(a4 + 8) )
                return 5133;
              v48 = ++v33;
            }
            while ( v33  t
    eax=097eee24 ebx=00000000 ecx=00000024 edx=0000efeb esi=2952cfeb edi=00000024
    eip=0959a224 esp=2911e5f8 ebp=2911e608 iopl=0         nv up ei pl zr na pe nc
    cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
    CoolType!CTInit+0x45ed9:
    0959a224 895d28          mov     dword ptr [ebp+28h],ebx ss:002b:2911e630=097eee24
    0:022> db esi
    2952cfeb  3c ef 3c 2c 38 38 2c 3c-ef 3c 5e 01 19 5e 2d 38   dd 097ef3bc L40
    097ef3bc  0000321f 0000321f 00003132 00003132
    097ef3cc  00003132 00003134 00003135 0000317f
    097ef3dc  000031af 000077f5 ffffa825 ffffed6a
    097ef3ec  ffffed67 ffffed67 ffffed6e 0000239a
    097ef3fc  00004ed1 000055e5 ffff8d10 ffffb847
    097ef40c  ffffcc4b ffffbe8f ffffeebf ffffee7b
    097ef41c  ffffee37 ffffee07 ffffee07 ffffee07
    097ef42c  ffffedd7 ffffedd7 ffffedd7 ffffee1b
    097ef43c  ffffee1b ffffee1b ffffef17 ffffefeb
    097ef44c  00000000 00000000 00000000 00000000
    097ef45c  00000000 00000000 00000000 00000000
    097ef46c  00000000 00000000 00000000 00000000
    097ef47c  00000000 00000000 00000000 00000000
    097ef48c  00000000 00000000 00000000 00000000
    097ef49c  00000000 00000000 00000000 00000000
    097ef4ac  00000000 00000000 00000000 00000000
接下来,下面的C代码来自IDA Pro的sub_8049FA2函数，用来处理yCoordinates[]字段:
    if ( v30 > 0 )   // handle yCoordinates, the result is stored in param a2. 
          {    //v20 points to the following buffer.
                      2952cfeb  3c ef 3c 2c 38 38 2c 3c-ef 3c 5e 01 19 5e 2d 38   *(_DWORD *)(v41 + 8) )
                return 5133;
            }
            while ( ++v31  t
    eax=097eeeed ebx=00000015 ecx=097ef6e0 edx=0000cc6c esi=2952d000 edi=00000024
    eip=0959a23c esp=2911e5f8 ebp=2911e608 iopl=0         nv up ei pl nz na po nc
    cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000202
    CoolType!CTInit+0x45ef1:
    0959a23c 0fb606          movzx   eax,byte ptr [esi]         ds:002b:2952d000=??
    0:022> t
    (8de0.6bc4): Access violation - code c0000005 (first chance)
    First chance exceptions are reported before any exception handling.
    This exception may be expected and handled.
    eax=097eeeed ebx=00000015 ecx=097ef6e0 edx=0000cc6c esi=2952d000 edi=00000024
    eip=0959a23c esp=2911e5f8 ebp=2911e608 iopl=0         nv up ei pl nz na po nc
    cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00010202
    CoolType!CTInit+0x45ef1:
    0959a23c 0fb606          movzx   eax,byte ptr [esi]         ds:002b:2952d000=??
    0:022> dd 097ef510
    097ef510  00003cef 00003cef 00003d2b 00003d57
    097ef520  00003d8f 00003dc7 00003dc7 00003dc7
    097ef530  00003d9b 00003dd7 00003ec6 00003f02
    097ef540  ffff9d03 ffff9cea ffff9c8c ffffc9c4
    097ef550  ffffc9fc ffffca29 ffffca87 ffffcb85
    097ef560  ffffcc6c 00000000 00000000 00000000
    097ef570  00000000 00000000 00000000 00000000
    097ef580  00000000 00000000 00000000 00000000
    0:022> db esi L10
    2952d000  ?? ?? ?? ?? ?? ?? ?? ??-?? ?? ?? ?? ?? ?? ?? ??  ????????????????
因为ebx小于edi,循环条件仍然是正确的,程序会继续解析yCoordinates[]字段。虽然esi指向简单符号的结尾,但是它会导致一个界外内存访问。
总之,这个漏洞是一个典型的堆缓冲区溢出漏洞。特别的是,这个漏洞是由一个精心制作的PDF文件引发的。该PDF文件包括一个无效字体文件，由于操作数组指针时不当的边界检查，它会导致一个界外内存访问。攻击者可以通过越界访问来达到意想不到的读,写或释放,甚至导致恶意代码插入、控制流劫持或信息泄露攻击。
**缓解措施**
鼓励所有Adobe Acrobat和Reader的用户都升级到该软件的最新版本。此外,部署Fortinet
IPS解决方案的组织机构也已经免受这个签名为Adobe.Acrobat.Reader.CoolType.TTF.Memory.Corruption的漏洞威胁。