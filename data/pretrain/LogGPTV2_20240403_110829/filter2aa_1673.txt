Cheating in eSports
How to cheat at virtual cycling using USB hacks
Brad Dixon, Carve Systems
Photo by Markus Spiske on Unsplash
Sweaty eSports
EGVsOG
CVRWorldCup
Virtual Cycling is Part of Cycling
Cycling: Over 100 Years of Cheating Innovation
1903, 1904: Hippolyte Aucouturier
1904: Maurice Garin
1947: Jean Robic
Will people cheat at virtual cycling, too?
"This is a sport with literally 
hundreds of dollars on the 
line, and dozens of fans...the 
stakes are medium!"
Marty Hass -- Tour de Pharmacy, 2017, HBO
No… Marty Hass is not a real person. Don’t you recognize Jeff Goldblum?
It is a silly mockumentary. Have a laugh.
Bike Radar: Best Cycling Smart Trainers - 10-Way Mega-Test
Virtual Cycling: How does this work?
• Just like any MMPOG plus
• Sensors to measure real 
world performance
• App-controlled resistance
Speed Estimation
• Course terrain model
• Power
• Rider mass
• Drafting model?
The Easy Way to Cheat at Virtual Cycling
• Lighter riders go faster
• Shorter riders draft better
…there are limits!
given the same power…
0
5
10
15
20
25
ZWIFT e-Racing Performance Limits (men, watts/kg)
20 min
5 min
1 min
5 sec
Vulnerable Sensor Network
HRM
Cadence
Power
ANT+
USB
Stick
ANT+ RF @ 2457 Mhz GFSK
Optional AES
Cheat the Hard Way with USBQ
HRM
Cadence
Power
ANT+
USB
Stick
USB
Host
Zwift
App
Zwift
API
ANT+ RF @ 2457 Mhz GFSK
Optional AES
USB
USBQ
Hack’in USB ain’t new
• Facedancer: excellent!
• Travis Goodspeed (@travisgoodspeed)
• Sergey Bratus (@sergeybratus)
• Kate Temkin (@ktemkin)
• Dominic Spill (@dominicgs)
• Michael Ossmann (@michaelossmann)
• Hardware Village USB Links: Andrey Konovalov
• USB Reverse Engineering: Down the Rabbit Hole: Grant “devalias” 
Glenn
Just want to observe USB?
•
Requires Linux and the usbmon module.
•
Capture with tcpdump –i usbmon0 …
•
Wireshark is great!
usbip + Wireshark
tcpdump + Wireshark
•
Linux usbip module can export USB devices 
over TCP.
•
Capture TCP, observe in Wireshark.
Stuff Brad Knows
•
Emulate USB host or device functions at the 
lowest level.
•
Behave badly and deviate from the expectations 
of USB drivers.
•
Use GoodFET-based board and Facedancer!
USB Device Drivers and Kernel Code
JAN 2019 
EDITION
USBiquitous by Benoît Camredon
• USB 2.0 MITM using 
loadable kernel module
• Beaglebone Black
• Python 2 userspace
• usbq_core
• usbq_userland
plugin
plugin
plugin
plugin
plugin
USBQ Architecture
ANT+
USB
Stick
USB
Host
USBQ
USB Proxy 
Device
• Uses USBiquitous kernel 
module (now GPLv2).
• New userspace Python 
application for 
inspecting and mangling 
USB data.
UDP
Stuff Brad Knows
•
Emulate USB host or device functions at the 
lowest level.
•
Behave badly and deviate from the expectations 
of USB drivers.
•
Consider: GreatFET One and Facedancer!
Applications Using USB Peripherals
USB Device Drivers and Kernel Code
•
Inspect and mangle application-specific 
payloads transported across a USB bus.
•
Use commodity hardware for USB hacking.
•
Consider: USBQ
USBQ
+ Hardware
AUG 2019 
EDITION
USBQ
Do Device 
USB Packet
Do Host 
USB Packet
Tick
DO Host/Device Packet
1. Wait for a packet
2. Get the packet
3. Decode the packet
4. Log the packet
5. Modify the packet
6. Encode the packet
7. Send the packet out
USBQ Main Loop
USBQ Plugins – Built with Pluggy
• Defined extension points for plugins to use.
• Plugins can stack and modify the results of plugins lower-
down the stack. LIFO-call order.
• Plugins can be distributed as independent Python 
packages.
included:
• Get and Send USB packets using the proxy kernel module
• Decode/Encode packets to a more useful representation
• Implement convenience features for development
plugin
plugin
plugin
plugin
plugin
USBQ
Get Hack’in
• Inspect PCAP
• Modify plugins on-the-fly
• IPython console
What is next for USBQ?
• Release: Visit usbq.org
• Need help with / working on:
• USBIP support: Native Linux kernel system for remote USB
• Device emulation with Function FS
• Replace USBiquitous kernel module? Need Linux kernel USBIP + Multipoint USB 
Highspeed Dual-Role Controller (MUSB)
• GreatFET One: Looks awesome… need to fiddle with it!
• More plugins and tools
Photo by Simon Connellan on Unsplash
L
A
N
C
E
E
eSports
Leet
Automatic
Network
Cheating
Enhancement
EPO Mode
Sustain performance with less effort 
and more guilt!
•Boost your power with a multiplier
•Make the world flat
Tour de Pharmacy
Slacker Mode
Why even risk sweating a little?
•Automatic pedal POWER
•Cruise control with random jitter
•Terrain-sensitive heart rate and 
cadence data generation
ELANCE Plugins for USBQ
• Decode ANT+ USB Payload.
• Decode three different ANT+ Payload types: fitness, 
HRM, and cadence.
USBQ Host, Device, or 
Management
USB Host or Device
ANT+
ANT+ Profile Pages
USBQ
Cheat the Hard Way with USBQ
HRM
Cadence
Power
ANT+
USB
Stick
USB
Host
Zwift
App
Zwift
API
ANT+ RF @ 2457 Mhz GFSK
Optional AES
• Modify power
• Modify heart rate
• Modify cadence
• Set grade to “flat”
Photo by Simon Connellan on Unsplash
Could it work?
1.Workouts
2.Online racing
3.Live event racing
Workouts
• Yeah, go ahead and cheat yourself.
• You’ll need to use sensible limits.
Online Racing*
• Plausible to stretch a mediocre rider into a 
competitor.
• Use multiple accounts to establish the
actual performance limits for verification.
• Build an IRL riding record and a public 
Strava profile.
• Verification cheats:
• 2nd power monitor / IRL power monitor
• Either real height + weight or fake videos
• Bribe / dodge / fake 3rd party verification lab
* Never actually tried to cheat in an online race nor applied the techniques listed above.
Live Event Racing*
• This is harder but live events are rare.
• High-stakes events use equipment 
provided by race.
• Probably can’t fake weigh-in.
• Infiltrate a NSA COTTONMOUTH-I style
hacked cable?
• Working on some other techniques, too.
CVRWorldCup
* Never tried this, either. There is no way anyone would believe I’m an elite cyclist. Not even for a second.
Wrap up
1. Overall system not designed 
for high-integrity competition.
2. Insecure sensor networks and
untrusted hardware are not a
good foundation for security.
3. Electronics and software are 
part of cycling. New domains 
for cheaters to exploit.
Photo by Troy Oldham on Unsplash
Winners never cheat. Cheaters never win. 
Hackers sometimes cheat for fun.
edope.bike