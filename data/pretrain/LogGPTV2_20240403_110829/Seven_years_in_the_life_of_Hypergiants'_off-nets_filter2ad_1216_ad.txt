[2021/01]
[2017/07]
[2019/01]
[2020/04]
[2020/04]
[2021/04]
2021/04
(only certs)
3810 (3835)
2214 (2229)
2115 (2288)
1094 (1107)
136 (301)
110* (137)
62 (218)
11 (31)
32 (32)
0 (267)
4 (180)
Table 3: List of the examined HGs according to the Rapid7 dataset
(Oct. 2013-Apr. 2021), sorted by the max # ASes hosting the HG’s
off-nets (validated by both certificates and headers). (* See the last
paragraph of Section 6.1 for a discussion of Cloudflare.)
DNS names of off-nets based on Facebook naming conventions and
global airport codes. Our technique uncovered 1153 of the 1201
ASes (96%) in the team’s 2018 data, 1599 of the 1704 ASes (94%) in
the 2019 data, and 2068 of the 2187 ASes (95%) in the 2021 data. We
have applied the same IP-to-AS mapping in both datasets.
Netflix: A previous study [18] reported that on May 15 2017, 743
ASes hosted Netflix Open Connect servers. In April 2017, we report
769 ASes.
6 HGS’ OFF-NET FOOTPRINTS & GROWTH
This section discusses the footprint and growth of HGs’ off-net
deployments. We characterize their growth by type of network,
region, and coverage of Internet users. We also comment on the
network providers’ hosting strategies for HGs.
6.1 Hypergiant Statistics
We first consider the Rapid7 certificate dataset. In Figure 2 we
show the number of IP addresses with a certificate during the
period of our study, from Oct. 2013 to Apr. 2021. We report the
number directly from the raw Rapid7 data, i.e., before validating
the certificate. Then, we apply our methodology from §4.1-§4.3 to
infer the IP addresses that use certificates associated with any of
the HGs we study. In Figure 2 (refer to the right y-axis) we plot the
percentage of IP addresses we infer serving any of the HGs, either
hosted in each HG (dashed line) or in a non-HG AS (dotted line).
At the start of 2021, only around 3.8% of the IP addresses seen with
valid certificates in Rapid7 are associated with any of the HGs we
study, either hosted in one of HGs’ ASes or in a non-HG AS and,
thus, can potentially be HG off-nets.
Table 3 reports the number of ASes that host each HG off-net foot-
print at the beginning of our study period (Oct. 2013) and at the end
of the study period (Apr. 2021) after validation with headers (§4.5).
521
Seven Years in the Life of Hypergiants’ Off-Nets
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
Figure 2: # IP addresses (millions) hosting TLS certificates in raw
Rapid7 dataset files (left y-axis). Of those, % that host a HG certifi-
cate, broken down by whether the IP address belongs to a HG AS or
not (right y-axis).
The middle columns of the table gives the maximum number of
ASes observed hosting off-nets for a HG and the timestamp when
that maximum deployment occurred. The table ranks HGs based on
their maximum AS footprint. For half of the HGs (Microsoft, Hulu,
Disney, Yahoo!, Chinacache, Fastly, Cachefly, Incapsula, CDN77,
Bamtech, and Highwinds), our methodology inferred no off-net
footprint during the period of our study, and so the table excludes
them.
The deployment strategies of HGs differ. In Section 5, we ex-
plained that the absolute number of IP addresses is a good compar-
ison metric. The percentage of IP addresses with certificates (of the
top-4 HGs, see Table 3) that were hosted in non-HGs ASes is very
high for some HGs, e.g., Google, Netflix, Facebook, and very low
for others e.g., Amazon. However, the total number of IP addresses
is only a small percent of the dataset of IP addresses with certifi-
cates. We also notice that there are two distinct HG groups. First,
there are the four largest HGs, namely Google, Netflix, Facebook,
and Akamai, which have off-nets in more than 1,000 ASes at the
beginning of 2021. For some of HGs, e.g., Google and Akamai, the
size of the off-net footprint with server installations (after the vali-
dation with headers) is very close to the size of the service-present
off-net footprint (as inferred by the certificates alone; see values in
parentheses). In some other HGs, e.g., Alibaba, this is not the case,
as they run services by relying on servers operated by other HGs
or datacenter providers. CloudFlare poses an interesting case, since
our manual investigation reveals that it does not have an off-net
footprint, but, because it issues and installs certificates in clients
that operate in other networks (and to support its DNS service
1.1.1.1), Cloudflare is misidentified as having off-nets.
6.2 Longitudinal Growth
Figure 3 plots the off-net footprint growth (after the validation with
HTTP(S) headers) of the top-4 HGs (Google, Netflix, Facebook, and
Akamai) based on our analysis of the Rapid7 certificate dataset. The
off-net footprint of these HGs is growing substantially, with the
exception of Akamai. Facebook has shown rapid growth since it
launched its own CDN in the summer of 2016 [61].
The case of Netflix is the most complex one, requiring manual
investigation. Although Netflix’s off-net footprint grew constantly
after 2015 (we conjecture this may be due to peering disputes with
Figure 3: Off-net footprint growth for top-4 HGs over time.
ISPs [72] and the strategic decision to launch Open Connect), we
observed a significant fraction of IP addresses responding with an
expired certificate after April 2017. This is visible in Figure 3 (solid).
When we ignore the expiration date of this certificate, we can
restore the activity of Netflix as shown by the Netflix dashed line.
In Oct. 2019 the default certificate of these IP addresses changed
back to a valid one. We also validate this by using PTR records
which at that time contained information about Netflix’s footprint.
We also observed that 26.8% of the IP addresses serving a certificate
for Netflix before April 2017 and after July 2019 stopped responding
to HTTPS requests on port 443.
To further investigate, we downloaded and studied the responses
to HTTPS GET (port 443) and HTTP GET (port 80) requests from
Rapid7. We found that these IP addresses were in fact active dur-
ing this period, but on HTTP instead of HTTPS. We conjecture that
Netflix moved from HTTPS to HTTP to cope with high demand as
encryption requires additional resources, a challenge Netflix has
admitted [99]. However, the Netflix SNI policy might also have
changed. By restoring these IP addresses as well, we plot (dotted
line) the number of ASes that hosted Netflix off-nets between Oct.
2017–Nov. 2019. For the rest of the paper, we will use the envelope
of these two lines (solid, dotted) to refer to the ASes that form the
Netflix off-net footprint.
We want to study the impact of using only the certificate datasets
in the number of ASes we identify as off-nets, compared to using
certificates plus HTTP and/or HTTPS headers, as discussed in Sec-
tion 4. As shown in Figure 4, the differences are minimal, as all
straight and dotted lines seem to converge. Rapid7 offers HTTPS
data since July 2016, and we have Censys data since October 2019.
However, in the case of Google, using the Censys dataset we are able
to identify more ASes, possibly because Censys employs sophisti-
cated scanning techniques. This fact is also apparent in Table 2.
6.3 Growth by Network Type
We are also interested in understanding the “demographics” of ASes
that host HGs. To this end, we label ASes that host HGs following a
similar approach to the one from previous related work [22], i.e., by
characterizing the ASes based on their AS customer cone size. To
do this, we employed the CAIDA AS Relationships Dataset, specif-
ically the provider-peer customer cone inferred for each AS [21].
We obtain more than 7 years of monthly snapshots of the dataset
522
2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-04010203040# IPs (in Millions)0.00.51.01.52.02.53.0% IPs# IPs in Rapid7% IPs in HG ASes% IPs in non HG ASes2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0405001000150020002500300035004000Total number of ASesGoogleFacebookAkamaiNetflix (initial)Netflix (w/ expired)Netflix (w/ expired, non-tls)SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
P. Gigis et al.
(a) Google
Figure 4: Comparison of Rapid7 (R7) and Censys (CS) datasets (certification and headers) for Google, Facebook, and Akamai, across time.
Recall, the HTTPS headers are available only after Summer 2016. (note: y-axis scales differ)
(b) Facebook
(c) Akamai
(a) Google
(d) Akamai
Figure 5: Growth of top-4 HGs’ off-net footprints grouped by AS customer cone size. (note: y-axis scales differ)
(c) Facebook
(b) Netflix
matching our study timeline. We consider 5 categories of ASes,
separated by an order of magnitude in terms of their customer cone
size. Stub ASes have no customer cone (other than themselves),
Small ASes have customer cones ≤ 10 ASes, Medium ASes have
customer cones ≤ 100 ASes, Large ASes ≤ 1000 ASes, and XLarge
ASes > 1000 ASes.
In Figure 5 we plot the top-4 HGs’ off-net footprint in the form
of stacked bars. Each bar refers to one of the AS categories: Stub,
Small, Medium, Large, and XLarge. Smaller ASes, namely, Stub,
Small, and Medium ASes contribute most (between 93-96%) to the
growth of Google, Netflix, and Facebook. For Akamai’s off-net
footprint, the contribution of Stub ASes declines since 2018, while
the contribution of Small and Medium ASes remains the same.
However, the sum of the 3 categories also remains high, reaching
84%. To better understand the dynamics and how the numbers we
see might be biased by the pre-existing ratios of every category, we
compute the number of ASes in the entire CAIDA dataset for all
categories from 2013-2021. Even though the number of active ASes
has substantially increased, from around 45k in 2013 to more than
71k in 2021, the percentage of ASes in each of the aforementioned
categories is surprisingly stable. Specifically, Stub ASes are by far
the most numerous, with around 85% of all ASes being Stubs. Small
ASes are also common, around 12% of all ASes. The rest of the
categories are smaller. Medium ASes have a share of 2.6%, Large
ASes less than 0.5%, and XLarge ASes less than 0.1%. These are
striking differences compared with the percentages reported in
Figure 5a, 5b, and 5c for Google’s, Netflix’s, and Facebook’s off-net
footprint, respectively. Indeed, the percentage of Stub ASes ranges
from 27% to 31%, the percentage of Small ASes is between 41% to
44%, and for Medium ASes it ranges from 22% to 24%. Thus, the
demographics of ASes that host the top HGs do not agree with
the overall demographics of ASes in the Internet. In the case of
Akamai’s off-net footprint, the percentage of Stub ASes is even
smaller, 13%. Although the share of Large and XLarge ASes in the
Internet is a bit more than 0.5%, more than 5% of the ASes that
host HGs belong to this category (over 16% in the case of Akamai).
Deploying in these large ASes can help HGs serve many users, a
subject we elaborate on in Section 6.5.
6.4 Regional Growth
To investigate the HGs’ off-net footprint growth in different re-
gions, we assign each AS to one country. We are aware that this
may be misleading, especially for XLarge and Large ASes, as they
may operate in multiple countries. However, studying a snapshot
of the APNIC dataset [65] (see Section 6.5 for more information on
this dataset), we observe that 95% of the 26K ASes that are included
in this dataset have only one country of operation. To map ASes
to countries, we used CAIDA’s AS Organizations Dataset [20] (Ap-
pendix A.2), resulting in an AS-to-country dataset that spans 7
years and covers 99.9% for the ASes of our study. We compare our
AS-to-country dataset with the APNIC dataset [65] and find they
agree for 97% of overlapping ASes. However, the APNIC dataset
includes many fewer ASes.
The mapping of ASes to countries/regions may be influenced by
geopolitics. For example, Hong Kong may appear as part of China
523
2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-040400800120016002000240028003200360040004400Total number of AsesR7 - Only CertsR7 - Certs & (HTTP & HTTPSR7 - Certs & (HTTP or HTTPs)CS - Only CertsCS - Certs & (HTTP & HTTPSCS - Certs & (HTTP or HTTPs)2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-040200400600800100012001400160018002000220024002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0401002003004005006007008009001000110012001300140015002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-040400800120016002000240028003200360040004400Total number of AsesXLarge (>1000)Large (1000)Medium (100)Small (10)Stub2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-04020040060080010001200140016001800200022002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-040200400600800100012001400160018002000220024002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0402004006008001000120014001600Seven Years in the Life of Hypergiants’ Off-Nets
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
with the exception of Alibaba that has strong regional growth in
Asia. After its launch in late 2014, Alibaba’s footprint gradually
increases to more than 100 ASes in Asia. A closer investigation by
analyzing HTTP(S) headers shows that Alibaba deploys its own
hardware servers mainly in Asia and relies on other HGs in other
regions.
In Figures 6d, 6e, and 6f, we present areas with lower growth, i.e.,
North America, Africa, and Oceania. The off-net footprint growth
of Google, Netflix, and Facebook is between 200 and 400 ASes in
North America, 60-150 ASes in Africa, and 20-30 ASes in Oceania.
We attribute this to consolidation in the network market in North
America and the relatively small network market in Africa and
Oceania. Nevertheless, both Google’s and Facebook’s off-net foot-
prints include many ASes in Africa. Appendix A.7 investigates the
growth of off-net footprints per network type in different regions.
We also noticed a slowdown during the COVID-19 pandemic,
but growth continued when the economy opened again in Summer
2020 and especially in the first months of 2021. Anecdotal evidence
confirms that additional capacity was allocated in peerings during
the pandemic (e.g., for Facebook [63]), as it was more difficult to
increase capacity at off-nets inside eyeball networks which can
require sending engineers in the field during the lockdown.
6.5 Internet User Population Coverage
Next, we estimate the coverage of Internet user population in a
country that can access HGs services located inside their network