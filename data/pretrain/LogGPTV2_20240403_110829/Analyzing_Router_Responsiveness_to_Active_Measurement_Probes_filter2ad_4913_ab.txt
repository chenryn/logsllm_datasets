1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
225,456
207,067
305,331
231,633
Table 2. *-Substring distribution
Same AS
100 %
12.5 %
22.8 %
9.8 %
20.3 %
44.2 %
12.6 %
11.6 %
14.4 %
14.0 %
1
1
24
57
41
79
86
*-substring length
4
2
-
-
-
-
-
-
-
-
-
-
-
-
3
-
-
-
-
-
-
151,133
137,829
212,263
148,182
63,662
59,171
73,263
63,944
6,360
5,828
14,019
13,733
4,301
4,239
5,779
5,772
5
-
-
-
-
-
-
-
-
7
2
Table 2 on the right hand side presents the frequency distribution of *-substrings
w.r.t. their length. In this table, we present the number of unique *-substrings
in the original data set. For uniqueness, we represent a *-substring of length l
as a triplet (IP1, l, IP2) and avoid counting the duplicate triples of this form
in the table. The results in the table show a bimodal behavior where data sets
prior to 2005 have only length l = 1 *-substrings. Starting from 2005, we ob-
serve *-substrings of larger lengths with the majority of *-substrings being of
length l = 1 or l = 2. We partly attribute the bimodal behavior of the routers to
changes in the skitter data collection process such as the increased probing rate
and dynamically updating destination lists. Longer *-substrings might also be
due to growth in networks where more hops of an autonomous system are tra-
versed or due to increased use of MPLS. One general observation in this part is
that within the last decade ISPs have become less cooperative to active probing
and conﬁgure their routers to stay anonymous to such probes.
We also classify *-substrings into two based on their topological position. That
is, for a given *-substring, say (IP1, l, IP2), we look at the relation between IP1
and IP2. If the IP address share the same 16-bit IP preﬁx, then we assume that
these IP addresses belong to the same domain and therefore the anonymous
nodes in between also belong to the same domain. We look at the ratio of this
type of *-substrings in the data sets and present them in the “Same AS” column
in Table 2. An alternative approach for this classiﬁcation would be to map each
such IP address (IP1 and IP2) to their corresponding Autonomous System (AS)
number and do the check. But, since we did not have access to IP-to-AS mapping
information for most of these historic data sets, we utilized the above mentioned
heuristic. The results presented in the “Same AS” column suggest that most
*-substrings after 2004 (e.g., more that 85%) were in the form that the two
IP addresses IP1 and IP2 seemed to belong to diﬀerent domains. The ratio
prior 2005 did not show a consistent trend which we contribute to the relatively
small number of occurrences of *-substrings during that time (see the “Unique *-
substrings” column in the table). Given that most *-substrings are of length l = 1
or l = 2 from the right hand side of the table, we suspect that the majority of
Analyzing Router Responsiveness to Active Measurement Probes
29
Fig. 1. Distance distribution
*-substrings that occurs in data sets after 2004 originated from routers at domain
boundaries or exchange points between neighboring ASes. We also observed that
even though the number of path traces used in our study decreased after 2004,
the number of unique *-substrings increased during the same time period.
In the next step, we are interested in the position of anonymous nodes within
path traces. In order to observe anonymous node positions in our path traces, we
counted the number of anonymous nodes at each hop distance from trace sources
in all path traces grouped by years. Figure 1 presents the distance distribution
of anonymous nodes for four diﬀerent years as samples. Similar to the previous
case, this analysis excludes nodes due to Type 3 anonymity. Note that, the
results presented in the ﬁgure do not consider the path length distribution of
individual path traces in these data sets. According to the ﬁgure, early data sets
(i.e., before 2005) contained small number of anonymous nodes that were mostly
distributed 10 to 20 hops away from the source. On the other hand, recent data
sets included much more anonymous nodes majority of which appeared 3 to 25
hops away from the source. The ﬁgure also shows a high number of anonymous
nodes at a distance of 2 from the source for the 2008 data set. A close examination
of the corresponding data set shows that this case is due to the existence of an
anonymous router at a 2 hops distance to one of the vantage points.
5 Current Practices
In this section, we present our ﬁndings in an experimental study where we ob-
serve router responsiveness to direct and indirect probe messages. We use 536,743
IP addresses obtained from skitter and iPlane project web sites. These IP ad-
dresses were recently collected (between Apr 7-11, 2008) by running traceroute
queries in the Internet, i.e., they belong to routers/systems that recently re-
sponded to indirect probe messages (i.e., traceroute probes issued from skitter
and/or iPlane systems).
In our study, we ﬁrst issued UDP, TCP, and ICMP based direct probes to
each of these IP addresses and recorded the response (or the lack of it). For each
30
M.H. Gunes and K. Sarac
Table 3. Responsiveness to direct probes
All
.net
537 K 320 K
Router End-Host
.gov
Year
# IPs
1.7 K 0.5 K
ICMP 81.9 % 84.6 % 77.9 % 92.3 % 86.4 % 88.9 % 95.5 % 92.9 %
TCP 67.3 % 70.4 % 62.8 % 76.7 % 72.6 % 83.2 % 77.3 % 83.0 %
UDP 59.9 % 64.7 % 50.3 % 63.5 % 61.7 % 57.3 % 64.4 % 62.8 %
.com
25.5 K 10.1 K
217 K
.edu
5 K
.org
case, we issued three probes from a host in UT-Dallas network and expected
to receive at least one response to consider the probed node as responsive. In
general, UDP probes are expected to return ICMP Port Unreachable messages;
TCP probes (TCP SYN packets) are expected to return TCP SYNACK or TCP
RST messages; and ICMP probes (Echo Requests) are expected to return ICMP
Echo Reply messages. Finally, we issued another set of ICMP probes with IP
Route Record option set (by using the ping command available in Linux system).
We observed a very small response rate (124 responses out of 536K+ probes)
and therefore excluded them from discussion.
Table 3 presents the response rate that we observed during our direct probing.
The ﬁrst row gives the number of IP addresses (i.e., IP addresses responding to
indirect probes by skitter and iPlane systems via traceroute). The following three
columns give the percentage of the IP addresses (out of the absolute numbers
given on the same column above) responding to direct probes by ICMP, TCP, or
UDP based probes respectively. The table also groups IP addresses as belonging
to routers or end systems; and classiﬁes them based on their top level domain
extensions (only 5 of them are presented).
According to the results presented in the table, ICMP based direct probes
have the highest rate of responses followed by TCP and then UDP probes. The
results suggest that TCP based probes are more welcomed than the UDP ones.
However, during our TCP based active probing, we received several security alert
e-mails from a national ISP indicating that our probe messages were detected
by their monitoring system as possible network scan activity and we were asked
to stop our probing. On the other hand, our UDP or ICMP based active probing
did not raise any security alert (that we know) by this or any other ISPs. These
results also indicate that many routers that respond to indirect query probes do
not respond to direct query probes. The ratio of such routers ranges from around
18% for ICMP probes to 40% for UDP probes. This implies that in practice
network operators are tolerating indirect active probing such as traceroute more
than direct active probing such as ping.
In the next step, we issued DNS queries to obtain the host names correspond-
ing to these IP addresses. Through DNS querying, we obtained host names of
around 250K IP addresses (out of 536K IPs). We then use the host name ex-
tensions to classify our IP addresses into several groups including .gov, .net,
.org, .edu, and .com and look at the responsiveness of each group of nodes to
active probes. Our data set had many host names with diﬀerent extensions (e.g.,
.jp, .fr, .tr, etc.) which we did not include in the results. According to the re-
sults given in Table 3, the responsiveness ratio of routers in diﬀerent types of
Analyzing Router Responsiveness to Active Measurement Probes
31
Table 4. Responsiveness to indirect probes
Initial
Final
Type #Traces Reached #Nodes Anonymous #Nodes Anonymous
ICMP 306 K
306 K
TCP
306 K
UDP
93.1 %
73.4 %
45.0 %
9.7 %
12.5 %
9.4 %
1.0 M
1.0 M
1.5 M
68.7 %
72.3 %
86.0 %
45 K
35 K
41 K
institution networks present similarity with each other and also has a similar
trend as the overall results presented earlier on the same table.
In the ﬁnal step, we issued ICMP, TCP, and UDP based probes toward 306K
of our IP addresses to observe router responsiveness to diﬀerent indirect probes.
For this, we used ICMP, TCP, and UDP based traceroute queries toward the IP
addresses. Table 4 presents the results obtained in this experiment. According
to the table, over 93% of our ICMP based probes reached their ﬁnal destination
whereas these ratios for TCP and UDP based probes were around 73% and
45% respectively. These results suggest that most network operators cooperate
with ICMP based traceroute queries but more than half of the operators block
UDP based traceroute queries in their domain. In addition, according to the
“Anonymous” labeled columns in the Initial sections of the table (i.e., before IP
alias and anonymous router processing), UDP based traceroute queries cause the
highest anonymity percentage. This is also seen in the topology size diﬀerence
under the “#Nodes” labeled column before processing. However, the trend in the
results changes after processing indicating that IP alias and anonymous router
resolution processing were eﬀective in eliminating the large number of redundant
nodes in the initial raw data. In the ﬁnal data set, the diﬀerences in topology
sizes are much smaller and the anonymity ratios are somehow close to the values
reported for the historical data for 2005-2008 period in Table 1.
6 Conclusion
In this paper, we presented an experimental study on the responsiveness of
routers to active probe messages. In our historical analysis, we observed that
responsiveness reduced during the last decade. We also observed that network
operators are increasingly using rate limiting to control the impact of such active
probes in their network. Another observation from our study is that the desti-
nation reachability considerably reduced over time indicating that systems (i.e.,
routers and end hosts) are increasingly unwilling to respond to direct probes.
In the second part of our work, we observed that routers are less willing
to respond to direct active probes as compared to indirect active probes. In
addition, our active direct and indirect probing based experiments showed that
the responsiveness of routers changes with the type of the probes; ICMP based
probes having the highest response rate and UDP based ones having the lowest
response rate. Even though TCP based probes receive responses much better
than UDP based ones, this type of probes sometimes raise security alerts at
their destinations.
32
M.H. Gunes and K. Sarac
References
1. Archipelago Measurement Infrastructure, http://www.caida.org/projects/ark
2. Chun, B., Culler, D., Roscoe, T., Bavier, A., Peterson, L., Wawrzoniak, M., Bow-
man, M.: PlanetLab: an overlay testbed for broad-coverage services. SIGCOMM
Comput. Commun. Rev. 33(3), 3–12 (2003)
3. Donnet, B., Huﬀaker, B., Friedman, T., Claﬀy, K.: Increasing the coverage of a
cooperative internet topology discovery algorithm. In: Akyildiz, I.F., Sivakumar,
R., Ekici, E., Oliveira, J.C.d., McNair, J. (eds.) NETWORKING 2007. LNCS,
vol. 4479, pp. 738–748. Springer, Heidelberg (2007)
4. Donnet, B., Raoult, P., Friedman, T., Crovella, M.: Eﬃcient algorithms for large-
scale topology discovery. In: Proceedings of ACM/SIGMETRICS, pp. 327–338
(June 2005)
5. Donnet, B., Raoult, P., Friedman, T., Crovella, M.: Deployment of an algorithm
for large-scale topology discovery. IEEE Journal on Selected Areas in Communi-
cations 24, 2210–2220 (2006)
6. Gunes, M., Sarac, K.: Analytical IP alias resolution. In: IEEE International Con-
ference on Communications (ICC), Istanbul, Turkey (June 2006)
7. Gunes, M., Sarac, K.: Resolving anonymous routers in Internet topology measure-
ment studies. In: Proceedings of IEEE INFOCOM, Phoenix, AZ, USA (April 2008)
8. Jin, X., Tu, W., Chan, S.-H.: Scalable and eﬃcient end-to-end network topology
inference. IEEE Transactions on Parallel and Distributed Systems 19(6), 837–850
(2008)
9. Katz-Bassett, E., Madhyastha, H., John, J., Krishnamurthy, A., Wetherall, D.,
Anderson, T.: Studying black holes in the Internet with hubble. In: Proceedings
of USENIX Symposium on Networked Systems Design and Implementation, San
Fransicso, CA, USA (April 2008)
10. Madhyastha, H.V., Isdal, T., Piatek, M., Dixon, C., Anderson, T., Krishnamurthy,
A., Venkataramani, A.: iPlane: An information plane for distributed services. In:
OSDI (November 2006)
11. McRobb, D., Claﬀy, K., Monk, T.: Skitter: CAIDA’s macroscopic Internet topology
discovery and tracking tool (1999), http://www.caida.org/tools/skitter/
12. Nakao, A., Peterson, L., Bavier, A.: A routing underlay for overlay networks. In:
Proceedings of ACM SIGCOMM, Karlsruhe, Germany, pp. 11–18 (August 2003)
13. Shavitt, Y., Shir, E.: DIMES: Let the Internet measure itself. ACM SIGCOMM
Computer Communication Review 35(5), 71–74 (2005)
14. Spring, N., Mahajan, R., Wetherall, D., Anderson, T.: Measuring ISP topologies
using rocketfuel. IEEE/ACM Transactions on Networking 12(1), 2–16 (2004)
15. Triukose, S., Wen, Z., Derewecki, A., Rabinovich, M.: Dipzoom: An open ecosystem
for network measurements. In: Proceedings of IEEE INFOCOM, Anchorage, AK,
USA (May 2007)