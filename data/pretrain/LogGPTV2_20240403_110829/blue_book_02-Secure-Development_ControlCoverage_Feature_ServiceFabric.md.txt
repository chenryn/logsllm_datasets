## IMPORTANT: DevOps Kit (AzSK) is being sunset by end of FY21. More details [here](../../../ReleaseNotes/AzSKSunsetNotice.md)
----------------------------------------------
ServiceFabricDescription & RationaleControlSeverityAutomatedFix ScriptPublicly exposed microservice endpoints must have authentication and authorization enforcedIf authentication and authorization are not correctly implemented, microservice endpoints may be easily accessed by anyone on the internet leading to compromise of sensitive data.HighNoNoPublicly exposed endpoints must be secured using SSLUse of SSL ensures server/service authentication and protects data in transit from network layer man-in-the-middle, eavesdropping, session-hijacking attacks.HighYesNoApplication secrets must be encrypted with a certificateProtecting the connection string, storage account keys, password, etc., (stored in Settings.xml file in ConfigPackage of microservice, ServiceManifest.xml and ApplicationManifest.xml) ensures that these secrets do not get compromised through copies of the settings/manifest files that might be left unprotected on various systems.HighNoNoData replication must be secured with certificateThe replication traffic of microservices must be protected using a certificate so that microservices are not be able to see each others' replication traffic.MediumNoNoSensitive data must not be stored inside DataPackageDataPackage files can be accessed from other microservices running on same node (VM). DataPackage files get distributed along with the application package while publishing/deployment. This can lead to compromise of any sensitive data as copies of these deployment packages are often left unprotected.HighNoNoReplica set size for stateful services must be set to a minimum of 3A replica set size of 3 or more in the case of stateful services ensures that data is not lost in the event of a single node failure.MediumYesNoInstance count for stateless service must be set to a minimum of 3An instance count of 3 or more guarantees high availability for stateless services in the event of a single node failure.MediumYesNoService Fabric cluster security must be enabled using security mode optionA secure cluster prevents unauthorized access to management operations, which includes deployment, upgrade, and deletion of microservices. Also provides encryption for node-to-node communication, client-to-node communication etc. In oppose to unsecure cluster which can be connected by any anonymous user.HighYesNoService Fabric cluster must contain only microservices which trust each otherMicroservice hosted on same Service Fabric cluster can monitor traffic of other microservices and access the files hosted on cluster. Hence the same Service Fabric cluster must not host microservices which do not trust each other.HighNoNoSelf-signed certs must not be used for Service Fabric cluster primary certificateThe primary certificate of Service Fabric must be obtained from a trusted certification authority. This ensures that client applications/endpoints can validate the identities of microservices in the cluster in a secure manner.HighYesNoClient authentication must be performed only via Azure Active DirectoryUsing the native enterprise directory for authentication ensures that there is a built-in high level of assurance in the user identity established for subsequent access control. All Enterprise subscriptions are automatically associated with their enterprise directory (xxx.onmicrosoft.com) and users in the native directory are trusted for authentication to enterprise subscriptions.HighYesNoThe ClusterProtectionLevel property must be set to EncryptAndSignWith cluster protection level set to 'EncryptAndSign', all the node-to-node messages are encrypted and digitally signed. This protects the intra-cluster communication from eavesdropping/tampering/man-in-the-middle attacks on the network.HighYesNoNetwork security group (NSG) must be enabled on subnets of Service Fabric clusterUse of appropriate NSG rules can limit exposure of Service Fabric cluster in multiple scenarios. For example, RDP connections can be restricted only for specific admin machines. Incoming requests to microservices may be restricted to specific clients. Also, deployments can be restricted to happen only from an allowed range of IP addresses.MediumYesNoEncryption must be enabled on all storage accounts which store VHDs of Service Fabric cluster VMsUsing this feature ensures that sensitive data is stored encrypted at rest. This minimizes the risk of data loss from physical theft and also helps meet regulatory compliance requirements.HighYesNoDiagnostics must be enabled for Service Fabric clusterDiagnostics logs are needed for creating activity trail while investigating an incident or a compromise.MediumYesNoMonitor publicly exposed ports on load balancers used by Service Fabric clusterPublically exposed ports must be monitored to detect suspicious and malicious activities early and respond in a timely manner.MediumNoNoReverse proxy service should be secured using SSLUse of SSL ensures server/service authentication and protects data in transit from network layer man-in-the-middle, eavesdropping, session-hijacking attacks.Medium NoNoReverse proxy port must not be exposed publiclyConfiguring the reverse proxy's port in Load Balancer with public IP will expose all microservices with HTTP endpoint. Microservices meant to be internal may be discoverable by a determined malicious user. HighYes NoUpgrade mode should be set to automatic for clusterClusters with unsupported fabric version can become targets for compromise from various malware/trojan attacks that exploit known vulnerabilities in software.MediumYesNo