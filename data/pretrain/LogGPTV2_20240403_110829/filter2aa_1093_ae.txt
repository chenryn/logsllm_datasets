（二）事中
1.加强 API 身份认证实时监控能力建设
企业应加强 API 身份认证实时监控能力建设，重点监控高频登
录尝试、空 Referer、非浏览器 UA 头登录等具有典型机器行为特征
的操作，对异常登录、调用行为进行分析，发现恶意行为及时告警。
此外，企业应实时监控接口运行中的单因素认证、弱密码、密码明
文传输等脆弱性问题，建立账号登录行为画像，形成用户常规登录
特征基线，对不同 IP 登录、连续认证失败、境外 IP 访问等敏感操
作进行监测分析，发现账号共享、借用、兼任等违规行为及时对相
关账号操作进行限制、阻断，避免安全事件的发生或扩大。
2.加强异常行为实时监测预警能力建设
企业应加强异常访问行为监测能力建设，针对短时间内大量获
取敏感数据、访问频次异常、非工作时间获取敏感数据、敏感数据
外发等异常调用、异常访问行为进行实时监测分析，根据自身业务
应用程序接口（API）数据安全蓝皮报告（2020 年）
23
情况建立正常行为基线，防范内部违规获取数据、外部攻击或网络
爬虫等数据安全风险。此外，由于内部特权账号权限远超普通用户
账户，企业应针对此类账号建立实时行为监测和审计机制，对账号
异常、高危操作进行严格管控，建立精准、细化的特权账号行为基
线，及时对特权账号异常行为进行预警，并定期进行特权帐号安全
审计。
3.加强数据分类分级管控能力建设
企业应梳理 API 数据类型，落实数据分类分级管控措施，针对
API 涉及的敏感数据按照统一策略进行后端脱敏处理，并结合数据加
密、传输通道加密等方式保护 API 数据传输安全。企业应严格落实
敏感数据保护策略，部署敏感数据监测工具，及时发现未脱敏展示、
前台脱敏等现象，并对接口流量进行分析，杜绝敏感数据明文传输
等违规行为。企业应评估涉及敏感数据的 API 参数设置情况，重点
关注接口单次返回数据量过多、返回数据类型过多等情况，建立后
端数据量、数据类型筛查机制，确保敏感数据暴露可知、可控、可
追溯。
4.加强 API 数据流向监控能力建设
企业应建立 API 数据流量监测机制，实时监控数据流向，加强
数据流向监控能力建设。通过分析访问和被访问 IP 的局域、地域或
法域，实现对数据流向的实时监控，防范数据接收方非法出售或滥
用个人信息风险，发现相关违法违规事件及时阻断 API 接入，为后
应用程序接口（API）数据安全蓝皮报告（2020 年）
24
续溯源调查积极存证。此外，企业应对境外 IP 访问内网 API 或者内
部 IP 访问境外 API 的情况重点关注、及时预警，确保敏感数据出境
活动合法合规。
（三）事后
1.建立健全应急响应机制
当前 API 应用广泛，业务逻辑复杂，涉及数据量大，一旦发生
安全事件，可能给企业、用户带来严重影响。企业应严格落实《网
络安全法》《电信和互联网用户个人信息保护规定》（工信部第 24
号令）等法律法规要求，出现数据泄露等严重安全事件及时告知相
关用户并上报电信主管部门，制定 API 安全事件应急响应预案并纳
入企业现有应急管理体系，应急流程包括但不限于监测预警及报告、
数据泄露事件处置、危机处理及信息披露等环节。
2.建立健全日志审计机制
API 数据安全审计可以帮助企业有效识别具体的高危访问行为，
为企业 API 安全提供有力帮助。建议企业对接口访问、数据调用等
操作进行完整日志记录，并定期开展安全审计，对 API 安全进行回
顾，结合旁路 API 流量捕获等技术手段，对传输协议等安全要点进
行分析还原，识别 API 漏洞、异常调用、外部攻击等安全风险。同
时，建议企业根据安全审计结果编制审计报告，跟踪审计意见的后
续落实，并依据相关监管要求妥善保存日志信息等，为安全事件追
应用程序接口（API）数据安全蓝皮报告（2020 年）
25
溯提供依据。
3.建立健全数据泄露溯源追责机制
企业应建立健全数据泄露溯源追责机制，制定 API 相关安全事
件溯源方案，发生安全事件后及时追踪数据泄露途径、类型、规模、
原因，分析根本原因，提取有效证据。结合审计机制进行事件溯源，
在确定责任主体后，严肃问责。API 数据泄露溯源机制可分为线索溯
源和主体溯源，线索溯源以泄露数据内容为线索，在系统中进行回
溯，提取 API 日志中的相关记录进行分析，确实责任人和泄露路径；
主体溯源根据账号、接口信息等访问特征线索在日志流量信息中进
行筛选，分析匹配特征，追溯事件源头。由于传统人工溯源费时费
力，溯源结果准确度有限，建议企业结合自身需求部署自动化溯源
工具，提升溯源效率，为企业 API 安全管理提供助力。
应用程序接口（API）数据安全蓝皮报告（2020 年）
26
五、附录
（一）全知科技 API 安全实践
1.开放 API 安全实践
（1）场景简介
开放 API 将接口开放到公网，为不同用户、产品提供数据操作、
传输渠道。开放 API 可分为两类，一类通过网页交互即可调用后端
API 进行数据查询，例如企业门户网站；一类仅对注册用户开放，需
用户主动注册后才可调用，例如政务开放平台数据调用接口。此类
API 主要具有两大特点。一是接口对社会公众开放。只要获知 URL 链
接，任何人都可以对 API 进行访问，而调用 API 接口即代表着调用
API 背后不同的业务功能，获取不同的服务数据。二是 API 参数由数
据提供方进行定义。全面开放的 API 通常无法满足所有用户的访问
需求，为了业务的正常开展，通常需进行标准化的接口定制。
（2）安全方案
企业应全面梳理其开放 API 现状，了解开放 API 数量、性质、
活跃程度，确保没有内网接口开放到外网的情况，并关注活跃 API
数据调用情况是否存在异常，及时下线失活 API。
在此基础上，企业可采用多种技术手段保护 API 安全，降低安
全风险。一是对 API 进行生命周期监控，二是健全账号认证机制和
授权机制，三是实时监控 API 账号登录异常情况，四是执行敏感数
应用程序接口（API）数据安全蓝皮报告（2020 年）
27
据保护策略，五是建立接口防爬虫防泄漏保护机制。
来源：全知科技（杭州）有限责任公司
API 生命周期监控：企业需实时监控新 API 上线、API 在运行过
程中变更，API 失活后正确下线情况，并在新 API 上线前对其进行风
险评估，对通信协议、路径、请求方式、请求参数、响应参数等要
素中的潜在安全漏洞进行排查，发现可能被攻击导致数据泄露的安
全漏洞，应及进行调整，确保上线前的安全性和可靠性。API 上线后，
企业则需实时监控其运行状态，发现风险应及时修正后再重新上线。
若 API 由于业务更迭等情况不再使用，企业应按照正确流程对其进
行下线。
健全认证授权机制：首先，企业需排查缺少身份认证的高危开
放 API，并对其建立身份认证机制。其次，企业应采取强密码、双因
素认证等方式增强身份认证机制。此外，在身份认证的基础上，企
业应建立健全授权机制，对用户账号授予所需最小权限，尤其注意
应用程序接口（API）数据安全蓝皮报告（2020 年）
28
增、删、改等高危操作，如无必要，不授予系统管理员 admin 或 export
等高级权限。建立健全认证授权机制一方面可以确保数据调用方为
真实用户而非网络爬虫，另一方面可以保证用户访问记录可追溯。
登录异常行为监控：企业应建立 API 异常登陆实时监控机制，
监测账号异常登陆情况并及时预警。账号异常登录情况可能由账号
暴力破解、撞库、单因素认证等登录系统脆弱性导致。登陆异常情
况监控机制可对接口登陆方式、IP 登陆失败频率、失败原因等进行
分析，发现异常情况及时预警。
敏感数据保护策略：企业应对开放 API 涉及的敏感数据进行梳
理，在分类分级后按照相应策略进行脱敏展示，所有敏感数据脱敏
均在后端完成，杜绝前端脱敏。此外敏感数据需通过加密通道进行
传输，防止传输过程中的数据泄露。以金融类系统为例，客户端应
用软件、银行卡受理设备、自助终端设备等界面展示的个人金融信
息需进行脱敏处理，确保登陆系统前不展示敏感信息。在此基础上，
企业应部署敏感数据监测工具，实时监测前端界面是否存在敏感数
据明文显示，以及通过流量分析检测是否存在敏感数据明文传输，
验证是否有效执行敏感数据保护策略。
部署防爬虫、防泄漏保护机制：企业应部署接口防爬虫、防泄
漏保护机制，分析用户访问行为特征，辨别该访问是真实用户行为
还是机器行为，并根据网络爬虫特征制定监控策略，部署工具进行
实时监控预警，发现潜在数据泄露事件及时触发熔断机制，阻断网
络爬虫行为对 API 数据安全的威胁。
应用程序接口（API）数据安全蓝皮报告（2020 年）
29
2.面向合作方 API 安全实践
（1）场景简介
商业生态系统的建立涉及企业与顾客、市场媒介、供应商等各
方的合作互动，面向合作方 API 被广泛用于合作方之间的数据交互
共享。此类 API 主要具有 3 大特点。一是数据交换类型多。通过此
类 API 进行数据交换的多为企业合作伙伴，包括但不限于资源供应
商和服务提供商。二是数据交换参与方数量少。开放 API 用户一般
以个人居多，组织较少，而面向合作方的 API 调用则以组织居多，
个人较少。三是接口定义需双方协商。此类 API 需在满足业务要求
的前提下根据双方要求进行自定义，往往需预留等多种接口以满足
业务需求。
（2）安全方案
企业应建立完善的供应商接口管理制度，包括准入制度、授权
管理制度和退出制度等，约束企业与合作方间的合作，从源头上对
合作方 API 进行把控，预防数据安全风险。在合作结束后，企业应
及时下线相关接口，并按照合作协议要求，进行数据留存审计，确
保合作方完成数据删除和销毁。
此外，企业还可通过部署相关技术手段保护面向合作方的 API
安全。一是部署敏感数据保护策略，二是建立账号异常行为监测机
制，三是部署自动化审计与溯源工具。
应用程序接口（API）数据安全蓝皮报告（2020 年）
30
来源：全知科技（杭州）有限责任公司
敏感数据保护策略：企业应对数据交换过程中涉及的敏感数据
制定保护策略，并通过脱敏、匿名化、去标识化、数据加密、传输
通道加密等方式对敏感数据加以保护。同时，组织机构还可以选择
VPN 传输、专线传输等安全性更高的安全防护手段，保护 API 接口数
据安全。
账号异常行为监测：企业应建立账号异常行为风险监测机制，
根据业务实际情况制定监控策略，实时监控合作方账号操作行为，
一旦监测发现存在越权操作、非工作时间访问、非工作时间大量获
取数据等情况，及时预警，降低数据安全事件风险。
自动化审计与溯源：企业与合作方之间通过 API 进行数据分享