这里可以使用 Send Test Email 来测试是否能发送邮件。在第三个 input 填入收件人邮箱，点击 Send。
在收件人的邮箱可以看到发送成功。
发件人为刚才我们自己命名的。到此邮件发送服务配置完毕。
### 2\. 创建邮件内容模板
在左侧栏找到 Email Templates，点击添加新模板。
这里我们可以使用 GoPhish 的邮件模板导入功能，该功能十分强大。  
我们去QQ邮箱随意点开一封邮件，例如下面。
点开右上角的更多选项，找到显示邮件原文。
全选显示出来的内容并复制。
找到 Import Email 按钮。
粘贴内容并点击导入。这里的 Change Links to Point to Landing Page
意思是将邮件内的链接替换成显示钓鱼页面的地址。因为你还没设置，所以使用 {{.URL}} 暂填代替。
导入后点击 Source 就可以看到邮件内的所有链接替换成了 {{.URL}}。
旁边的小图标，点击之后可以进行预览。可以拿来发现问题。
确认无误后点击保存，这里的 Add Tracking Image
的作用是在你的邮件内添加一张看不到的图片，用来判断是受害者是否点击了该邮件，用来统计数据使用。
> outlook 禁止图片加载，可能会影响数据读取。
### 3\. 创建钓鱼页面
在左侧栏找到 Landing Pages，点击新建页面。
这里系统自带的 importsite 可以直接输入要 copy 的网站地址，但是这种方法我尝试了一些网站，有许多网站都不能完美 copy
，这里我介绍一种方法，使用火狐带的插件 Save Page WE 可以完美把网页给 copy 下来，然后把 copy 下的页面源码贴在 HTML
的位置就行了，这里我随便找个后台演示下。  
火狐插件 Save Page WE下载地址：[https://addons.mozilla.org/zh-CN/firefox/addon/save-page-we/?utm_source=addons.mozilla.org&utm_medium=referral&utm_content=search](https://addons.mozilla.org/zh-CN/firefox/addon/save-page-we/?utm_source=addons.mozilla.org&utm_medium=referral&utm_content=search)  
安装好插件，访问后台页面，右上角点击插件图标即可下载后台页面 html。
将下载好的 html 拖入任意编辑器，使用编辑器搜索 ` 通常，进行钓鱼的目的往往是捕获受害用户的用户名及密码，因此，在点击Save Page之前，记得一定要勾选 Capture Submitted Data
> 。  
>  当勾选了 Capture Submitted Data 后，页面会多出一个 Capture Passwords
> 的选项，显然是捕获密码。通常，可以选择勾选上以验证账号的可用性。如果仅仅是测试并统计受害用户是否提交数据而不泄露账号隐私，则可以不用勾选。  
>  另外，当勾选了Capture Submitted Data后，页面还会多出一个Redirect
> to，其作用是当受害用户点击提交表单后，将页面重定向到指定的URL。可以填写被伪造网站的URL，营造出一种受害用户第一次填写账号密码填错的感觉。  
>  一般来说，当一个登录页面提交的表单数据与数据库中不一致时，登录页面的URL会被添加上一个出错参数，以提示用户账号或密码出错，所以在Redirect
> to中， **最好填写带出错参数的URL，或着跳到错误页面** 。
### 4\. 添加受害人邮箱发送组
在左侧栏找到 Users & Groups 点击添加组，这里我们先下载导入模板。
这里我们只需要填写 Email 一栏，为受害者邮箱地址，当然你也可以填写 First Name 作为收件人的名称。
导入并保存，别忘记填写 Name 作为组的名称。
### 5\. 发送钓鱼邮件测试
在左侧栏找到Campaigns，点击新建，这里表单里面的 URL 就是填充到上面第二部邮件内容里面的 {{.URL}} 处。  
这里 Gophis 默认起的服务是 80 端口，通过 docker 映射到了 8003 端口，所以这里填入
点击发送后，可以在受害者邮箱内看到邮件信息。
> 这里有个图片没用被加载，所以我们没法从 Gophis 的控制台看到统计。
点击下面的链接可以看到会跳转到我们指定的URL地址。
点击继续访问就是我们仿冒的网站后台页面。
这里我们任意输入内容并提交后，就会跳转到我们第三步填写的 Redirect to 里面的地址。
填写并提交之后可以看到记录了我们填写的表单信息。
### 6\. 错误钓鱼页面模板坑
在导入真实网站来作为钓鱼页面时，绝大多数情况下并非仅通过Import就能够达到理想下的克隆，通过多次实践，总结出以下几点注意事项 。  
**【捕获不到提交的数据】**  
导入后要在HTML编辑框的非Source模式下观察源码解析情况，如果明显发现存在许多地方未加载，则有可能导入的源码并非页面完全加载后的前端代码，而是一个半成品，需要通过浏览器二次解析，渲染未加载的DOM。这种情况下，除非能够直接爬取页面完全加载后的前端代码，否则无法利用gophish进行钓鱼，造成的原因是不满足第2点。  
**【捕获不到提交的数据】**  
导入的前端源码，必须存在严格存在` ··· `结构，即表单（POST方式）—
Input标签（具有name属性）Input标签（submit类型）— 表单闭合的结构，如果不满足则无法捕获到提交的数据 。  
**【捕获不到提交的数据】**  
在满足第2点的结构的情况下，还需要求``在浏览器解析渲染后（即预览情况下）不能包含action属性，或者action属性的值为空。  
否则将会把表单数据提交给action指定的页面，而导致无法被捕获到 。  
**【捕获数据不齐全】**  
对于需要被捕获的表单数据，除了input标签需要被包含在中，还需满足该存在name属性。例如``,否则会因为没有字段名而导致value被忽略 。  
**【密码被加密】**  
针对https页面的import，通常密码会进行加密处理，这时需要通过审计导入的前端代码，找到加密的Java函数（多数情况存在于单独的js文件中，通过src引入），将其在gophish的HTML编辑框中删除，阻止表单数据被加密
。
## 0x05 发件人伪造
为了让邮件更加真实，明面上的功夫必不可少。其中发件人的信息是重点。如何进行发件人伪造，我们可以利用自己搭建的 EwoMail 邮件服务器进行伪造。  
首选进入邮件服务器后台，在左侧栏找到邮箱域名选项，添加不属于我们自己的域名，或者不存在的域名。
保存后利用 EwoMail 内部通信的机制，我们添加一道解析记录。
    # 修改文件
    vi /etc/hosts
    # 填入
    127.0.0.1   mail.baidu.com smtp.baidu.com imap.baidu.com
然后再添加该邮箱后缀的邮箱用户。
在 Gophis 新建邮件服务配置，同一个 Host 不同的邮件用户。在 Campaigns 的时候选择这个发送配置即可。
## 0x06 其他
  1. **拦截**
在实战中，我们可能拿到的受害者名单非常多。导致可能存在邮箱服务器一个时间内发送邮件数量太多会导致很多邮件被退回的情况。我们可以在 Users &
Groups 处将受害者名单分成多个组，并在 Campaigns 配置 send email by
处指定不同的时间段进行发送。而且不同的组可以使用不同的邮件服务发送人，这样可以大大降低拦截的概率。
  1. **其他用法**
不一定是发送邮件然后让受害者进入我们准备好的界面，这个链接也可以是问卷星收集信息，也可以是被我们插入恶意存储XSS的网页。甚至你可以放入捆绑木马，恶意Office，ZIP
+ Link 钓鱼，Office里面放恶意仿冒钓鱼链接等，具体看技战法。
## 0x06 参考文章致谢
●   
●   
●   
●   
●   
● 