f
0.075
0.050
0.025
0.000
10m
1h
prefixes
/32
/31−/25
/24−/18
]
0
1
g
o
l
[
x
i
f
e
r
p
r
e
p
s
t
n
e
m
e
c
n
u
o
n
n
a
w
e
n
f
o
r
e
b
m
u
n
6h
duration [log 10]
24h
72h 7d 14d 40d 90d
100
10
1
1 2 3 4 5 6 7 8 9 A B C D E F G H I K L M N O P Q R S T
member AS
(a) Fraction of all announcement spermin-
utes binnedbypreﬁx.
(b) Announcement frequency perpreﬁx
[log 10].
Fig. 3. Preﬁx and AS view of blackholing.
almost stable. In particular, the /18 − /31 preﬁx cluster contains eight /24
announcements that are active over the entire measured period. Unfortunately,
we did not get a response from the operator to fathom the intention for the
long lasting announcements. For announcements between /25 – /30, we again
see permanently announced preﬁxes that are active for a period of several weeks.
Since the announcements with preﬁxes of the /18 - /31 are only short-lived, they
do not impact the average number of active ones. In contrast, the most prevalent
preﬁx class, the /32s, varies signiﬁcantly. It ranges from an average minimum of
994 to a maximum of 1, 463 and a mean of 1, 195 for all active announcements.
The number of new announcements per day diﬀer notably compared to the
averages. They show signiﬁcant variations. From no activities over several days to
large numbers of new announcements during one day for all but the /32. Indeed,
focusing on the peak on January 27th, we see a total of 415 newly announced
unique preﬁxes. All preﬁxes are announced simultaneously by the same AS at 6
A.M. and last for about 10 minutes. The number of new announcements for the
/32 preﬁxes varies between 102 and 1211.
Next, we consider the durations and remove all announcements where we did
not capture either the beginning or the end. We cluster these announcements
(100 %) by preﬁx length and show in Fig. 3(a) the histogram of announcement
durations in minutes using log-scale. The majority of long announced preﬁxes
are /32s. Altogether, the largest fraction (0.1 of all preﬁxes) is announced for
about ﬁve minutes. The two clusters with the less speciﬁc preﬁxes (/18 – /24
fraction of 0.004 and /25 – /31 with 0.015) have few announcements longer
than ﬁve minutes. Their longest announcements last for 57.39 days. The /32
preﬁxes are again more diverse. Notably, around 9 % of the announcements
are active for about 10 minutes while 38.5 % last longer than 240 minutes.
Blackholing at IXPs: On the Eﬀectiveness of DDoS Mitigation in the Wild
325
Interestingly, multiples of 1 hour are more dominant. The longest duration we
observe is 76.31 days.
The operational background for such observation is that the members’ mon-
itoring capabilities for blackholing are limited. As soon as a preﬁx is announced
for blackholing, the announcing AS is not aware of the amount of traﬃc that
is dropped. Hence, some members turn blackholing oﬀ and on within a short
period of time in order to check whether the DDoS attack is still on-going.
4.2 An as View of Blackholing
To understand how the 75 diﬀerent ASes (12 % of member ASes) use blackholing
we take a closer look at the announcements from a member AS perspective.
These ASes are categorized according to Peering DB: Network Service Providers
(NSP) 50 %, Cable/DSL/ISP 25 %, and Content Providers 19 %. The NSPs are
overrepresented compared to IXP-wide 42 %, while the latter two accord to those.
The ASes announced 7, 864 unique preﬁxes, of which 10 % were announced
once and around 15 % between two and three times. 47 ASes announced fewer
than 50 preﬁxes in total and were excluded to focus on the blackholing-heavy
ASes. We then focus on the remaining 28 ASes. The mean of all announcements
for the same preﬁxes across all remaining ASes is 3.13 with a median of only 1.
Figure 3(b) shows the number of announcements per unique preﬁx by AS in a
boxplot. Overall, the median is almost always lower than 10. Looking at the
details we ﬁnd that, despite the prevailing low announcing frequencies, there are
also AS-wide high frequencies. Surprisingly, outliers spread from 10 to 100. The
observed maximum number of a unique announced preﬁx is 623. This observation
may provide further evidence for an operational procedure where blackholing is
switched on and oﬀ many times for the very same IP preﬁx within a short time
frame.
To check if the frequently announced preﬁxes have an impact over the total
time span that they are active, we accumulate the duration for all unique preﬁxes
of our selected ASes. Figure 4(a) shows these values at the y-axis with the same
ASes as in Fig. 3(b). We ﬁnd that the majority of ASes announce preﬁxes for a
duration longer than 1 hour but less than 7 days. Nevertheless, we observe some
ASes that either announce their preﬁxes primarily over a short or long period of
time.
Figures 3(b) and 4(a) expose no clear correlation between frequency and dura-
tion of announcements for the same AS. On the one hand some ASes announce
the same preﬁx frequently for short times, and on the other hand some ASes
announce blackholing only once for a short duration. However, also the contrary
can be observed: frequent and once for a longer duration. This indicates that
there is no common operational procedure for triggering blackholing. This is not
surprising as DDoS attacks often diﬀer from attack to attack. Thus, operators
respond to each attack individually.
Nevertheless, we want to see if there are operational patterns: one would
expect either more announcements during daytime working hours, or during
peak hours. Neither is the case and the behavior diﬀers by AS. For some, we
326
C. Dietzel et al.
90d
40d
14d
7d
72h
24h
6h
1h
10m
]
0
1
g
o
l
n
i
i
n
m
[
x
i
f
e
r
p
r
e
p
m
u
s
n
o
i
t
a
r
u
d
t
n
e
m
e
c
n
u
o
n
n
a
e
v
i
t
c
a
]
0
1
g
o
l
[
s
t
n
e
m
e
c
n
u
o
n
n
a
w
e
n
f
o
r
e
b
m
u
n
100
10
1 2 3 4 5 6 7 8 9 A B C D E F G H I K L M N O P Q R S T
member AS
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
day time [hour]
(a) # active duration per preﬁx [log 10].
(b) Selected ASes: announcements by time.
Fig. 4. AS views of blackholing.
see clear patterns, e.g., see Fig. 4(b). Here, the number of new announcements
is substantially smaller but the variance is higher at night.
5 Blackholing Impact on Traﬃc
To study the eﬀectiveness of blackholing on the data plane, we correlate the
actual traﬃc with the BGP announcements on the control plane. Figure 5(a)
depicts the bit rates of the blackholed traﬃc at the IXP during our three month
observation period. It shows per day the hourly maximum and hourly average
in Mbit/s. The per day maximum varies from 50 to 1, 000 Mbit/s with a peak
at 2, 100 Mbit/s. At ﬁrst glance, this may seem small especially when compared
to the average traﬃc rates at this IXP. However, keep in mind that this is the
traﬃc that is discarded and should only eﬀect short time-scale DDoS attacks.
Moreover, as soon as the blackhole is in eﬀect, this regulates traﬃc volume. For
TCP, blackholing disables connections and for UDP the sender might notice the
blackhole and therefore throttle the attack. Another reason is what we plot: the
average across a full hour. Indeed, the daily averages (dashed line) are up to 10
times smaller than the daily maxima (solid line).
Given the large number of blackholing announcements, see Sect. 4, we next
determine how many of these preﬁxes actually receive traﬃc. We ﬁnd that in
those hours with more than 1 Mbit/s average blackhole traﬃc, a mean of 81 and
a maximum of 871 IPs receive traﬃc. Thus, we conclude that typically only a
small number of IPs receive a substantial amount of blackholed traﬃc.
To assess the impact of blackholing we next examine the temporal correlation
of blackhole announcements with traﬃc. We focus on two case studies: (Case
Study I) an event that lasted a relatively short time period and (Case Study II)
one lasting longer and involving a larger traﬃc volume.
Blackholing at IXPs: On the Eﬀectiveness of DDoS Mitigation in the Wild
327
]
0
1
g
o
l
[
s
P
I
t
s
o
h
/
d
n
o
c
e
s
r
e
p
t
i
b
m
1000
100
10
1333
133