We estimate the access bandwidth of an infectee as fol-
lows. Let Pi and Pj be two packets from the same in-
fectee, received at the telescope at time ti and tj respec-
tively. Using the mechanism developed in § 4 we can
deduce Xi and Xj, the state of the PRNG at the sender
when the two respective packets were sent. Now, we can
simulate the LC PRNG with an initial state of Xi and re-
peatedly apply Eqn 1 till the state advances to Xj. The
number of times Eqn 1 is applied to get from Xi to Xj is
the value of j − i. Since it takes 4 cranks of the PRNG
to construct each packet (lines 3–5, in Fig. 2), the to-
tal number of packets between Pi and Pj is (j − i)/4.
Thus the access bandwidth of the infectee is approximately
average packetsize∗(j −i)/4∗1/(tj −ti). While we can
compute it more precisely, since reproducing the PRNG se-
quence lets us extract the exact size of each intervening
packet sent, for convenience we will often use the average
payload size (1070 bytes including UDP, IP and Ethernet
headers). Thus, the transmission rate can be computed as
356
Internet Measurement Conference 2005 
USENIX Association
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
k
n
a
R
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
k
n
a
R
 0
 10000
 100000
 1e+06
 1e+07
 1e+08
 1e+09
Estimated access bandwidth (bits per sec.)
 0
 10000
 100000
 1e+08
Estimated effective bandwidth (bits per sec.)
 1e+06
 1e+07
 1e+09
Figure 4: Access bandwidth of Witty infectees estimated
using our technique.
Figure 6: Effective bandwidth of Witty infectees.
 1e+09
 1e+08
 1e+07
 1e+06
)
.
c
e
s
r
e
p
s
t
i
b
(
e
p
o
c
s
e
e
l
t
A
D
A
C
I
 100000
 100000
 1e+06
 1e+07
 1e+08
 1e+09
Wisconsin telescope (bits per sec.)
Figure 5: Comparison of estimated access bandwidth using
data from two telescopes.
(j−i)∗1070∗8
tj −ti
bits per second.
4(tj −ti) = 2140 j−i
Figure 4 shows the estimates of access bandwidth of in-
fectees5 that appeared at the CAIDA telescope from 05:01
AM to 06:01 AM UTC (i.e., starting about 15 min after
the worm’s release). The x-axis shows the estimated ac-
cess bandwidth in bps on log scale, and the y-axis shows
the rank of each infectee in increasing order. It is notable
in the ﬁgure that about 25% of the infectees have an ac-
cess bandwidth of 10 Mbps while about 50% have a band-
width of 100 Mbps. This corresponds well with the popular
workstation conﬁgurations connected to enterprise LANs
(a likely description of a machine running the ISS software
vulnerable to Witty), or to home machines that include an
Ethernet segment connecting to a cable or DSL modem.
We use the second set of observations, collected inde-
pendently at the Wisconsin telescope (located far from the
CAIDA telescope), to test the accuracy of our estimation,
as shown in Figure 5. Each point in the scatter plot rep-
resents a source observed in both datasets, with its x and
y coordinates reﬂecting the estimates from the Wisconsin
and CAIDA observations, respectively. Most points are lo-
cated very close to the y = x line, signifying close agree-
ment. The small number of points (about 1%) that are sig-
niﬁcantly far from the y = x line merit further investiga-
tion. We believe these reﬂect NAT effects invalidating our
inferences concerning the amount of data a “single”source
sends during a given interval.
Extrapolation-based estimation of effective band-
width. Previous analyses of telescope data (e.g., [18])
used a simple extrapolation-based technique to estimate the
bandwidth of the infectees. The reasoning is that given a
telescope captures a /8 address block, it should see about
1/256 of the worm trafﬁc. Thus, after computing the pack-
ets per second from individual infectees, one can extrap-
olate this observation by multiplying by 256 to estimate
the total packets sent by the infectee in the correspond-
ing period. Multiplying again by the average packet size
(1070 bytes) gives the extrapolation-based estimate of the
bandwidth of the infectee. Notice that this technique is not
measuring the access bandwidth of the infectee, but rather
the effective bandwidth, i.e., the rate at which packets from
the infectee are actually delivered across the network.
Figure 6 shows the estimated bandwidth of the same
population of infectees, computed using the extrapolation
technique. The effective bandwidth so computed is signif-
icantly lower than the access bandwidth of the entire pop-
ulation. To explore this further, we draw a scatter-plot of
the estimates using both techniques in Fig. 7. Each point
corresponds to the PRNG-estimated access bandwidth (x
axis) and extrapolation-based effective bandwidth (y axis).
The modes at 10 and 100 Mbps in Fig. 4 manifest as clus-
ters of points near the lines x = 107 and x = 108, re-
USENIX Association
Internet Measurement Conference 2005  
357
 1e+09
 1e+08
 1e+07
 1e+06
 100000
)
.
c
e
s
r
e
p
s
t
i
b
(
h
t
d
w
d
n
a
b
e
v
i
t
c
e
f
f
i
E
 10000
 10000
 100000
 1e+06
 1e+07
 1e+08
 1e+09
Access bandwidth (bits per sec.)
d
n
o
c
e
s
r
e
p
s
t
e
k
c
a
P
 12000
 10000
 8000
 6000
 4000
 2000
 0
 0
 500  1000  1500  2000  2500  3000  3500  4000  4500  5000
Time (sec)
Figure 7: Scatter-plot of estimated bandwidth using the two
techniques.
Figure 8: Aggregate worm trafﬁc in pkts/sec as actually
logged at the telescope.
spectively. As expected, all points lie below the diagonal,
indicating that the effective bandwidth never exceeds the
access bandwidth, and is often lower by a signiﬁcant factor.
During infections of bandwidth-limited worms, i.e., worms
such as Witty that send fast enough to potentially consume
all of the infectee’s bandwidth, mild to severe congestion,
engendering moderate to signiﬁcant packet losses, is likely
to occur in various portions of the network.
Another possible reason for observing diminished effec-
tive bandwidth is multiple infectees sharing a bottleneck,
most likely because they reside within the same subnet and
contend for a common uplink.
Indeed, this effect is no-
ticeable at /16 granularity. That is, sources exhibiting very
high loss rates (effective bandwidth  50% access). For example, only 20%
of the sources exhibiting high loss reside alone in their own
/16, while 50% of those exhibiting lower loss do.
Telescope Fidelity. An important but easy-to-miss fea-
ture of Fig. 7 is that the upper envelope of the points is
not the line y = x but rather y ≈ 0.7x, which shows
up as the upper envelope of the scatter plot lying paral-
lel to, but slightly below, the diagonal. This implies either
a loss rate of nearly 30% for even the best connected in-
fectees, or a systematic error in the observations. Further
investigation immediately reveals the cause of the system-
atic error, namely congestion on the inbound link of the
telescope. Figure 8 plots the packets received during one-
second windows against time from the release of the worm.
There is a clear ramp-up in aggregate packet rate during the
initial 800 seconds after which it settles at approximately
11,000 pkts/sec. For an average packet size of 1,070 bytes,
a rate of 11,000 pkts/sec corresponds to 95 Mbps, nearly
the entire inbound bandwidth of 100 Mbps of the CAIDA
 1e+09
 1e+08
 1e+07
 1e+06
 100000
)
.
c
e
s
r
e
p
s
t
i
b
(
e
p
o
c
s
e
e
l
t
A
D
A
C
I
y=x
 10000
 10000
 100000
 1e+06
 1e+07
 1e+08
 1e+09
Wisconsin telescope (bits per sec.)
Figure 9: Comparison of effective bandwidth as estimated
at the two telescopes.
telescope at that time.6
Fig. 8 suggests that the telescope may not have suffered
any signiﬁcant losses in the ﬁrst 800 seconds of the spread
of the worm. We veriﬁed this using a scatter-plot similar to
Fig. 7, but only for data collected in the ﬁrst 600 seconds of
the infection. In that plot, omitted here due to lack of space,
the upper envelope is indeed y = x, indicating that the best
connected infectees were able to send packets unimpeded
across the Internet, as fast as they could generate them.
A key point here is that our ability to determine access