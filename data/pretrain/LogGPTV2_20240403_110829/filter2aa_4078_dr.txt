动检测和连接功能的设备不仅可以看到网络， 也可以开始与 网 络进行连接。 网 络管理员 可以选择禁
用 SSID 广播以使隐藏 自 己的 网络， 从而免受未经才是权人员 的访问 。 然而， SSID 仍然需要直接从基
站进行发送， 使用 无线数据包嗅探器的人仍然可以发现。 因 此， 如果网络不供公众使用 ， 则 SSID
应被禁用 ， 但需要意识到 隐藏 SSID 不是真正的安全机制 ， 因 为具备基础无线知识的任何黑客都可
以 很容易地发现 SSIDo
1 1 .5.3 执行现场勘测
用于发现不需要无线接入的物理环境区域的一种方法是执行现场勘测。 现场勘测的过程是调查
在环境中部署无线接入点所需的信号强度。 这项任务通常包括携带便携式无线设备进行现场行走观
察 ， 留意无线信号的 强度 ， 并据此在建筑图 上进行标注。
执行现场勘测来确保无线设备使用 的所有位置具备足够的信号强度， 同时在同一时间 ， 最大限
度地减少或消除不允许无线接入位置(公共区域、 跨楼层、 其他房间或建筑夕阳的无线信号。 现场勘
测 对于评估现有无线 网络的部署、 扩展当前应用 的计划 以及未来部署计划非常有用 。
319
320
CISSP 官方学 习指南(第 7 版)
1 1 .5.4 使用 加密协议
在使用无线链路进行正常的网络通信之前， IEEE 802. 1 1 标准定义了 两种 由无线客户端向无线接
入点进行验证的方法。 这两种方法是开放系统认证(Open Sγstem Authentication， OSA)和共享密钥认
证(Shared Key Authentication， SKA)o OSA 没有真正的认证要求。 只 要无线电信号可以在客户端和
WAP 之间传输， 通信即被允许。 而且， 使用 OSA 的无线网络通常以 明文发送一切信息， 因此未提
供任何保密或安全。 SKA 意味着在进行网络通信时必须进行某种形式的身份认证。 802. 1 1 标准定义
了 有线等效保密(WEP)协议为 S:KJ气 的可选技术之一。 随后， 对原标准 802.11 进行了修订， 增加了
WPA、 WPA2 以及其他的技术。
1. WEP
有线等效保密(WEP)被定义为 IEEE 802. 1 1 标准， 目 的在于为无线网络提供与有线或通信电缆网
络相 同级别的安全性和加密 。 WEP 提供无线传输保护中对数据包嗅探和窃听攻击的防护 。
WEP 的另一个好处是， 它可以被配置来防止未经授权的无线网络访问。 WEP 使用预定义的共
享密钥， 然而并非典型的动态对称密码方案， 共享密钥是静态的并在所有的无线接入点和设备接口
之间进行共享。 此密钥用于在无线链路传输之前加密数据包， 从而提供机密性保护。 哈希值用来验
证接收的数据包在传输过程中不被修改或遭受损坏。 因此， WEP 也提供完整性保护 。 知晓或拥有的
密钥不仅可以加密通信 ， 同 时也 可作为一种基本的身份认证， 没有则禁止进入无线网络。
WEP 在发布的同时几乎就被破解。 目 前， 可 以在不到一分钟 的时 间就破解 WEP， 从而使它成
为毫无价值的安全防范。 幸运的是， 己有 WPA 和 WPA2 来替代 WEPo WPA 是对 WEP 的改进， 它
不使用静态密钥来加密所有的通信 。 相反， 它和每一个主机协商一个单独的密钥 。 然而， 一个单一
的 口令被用来授权与基站之间的关联(例如， 让一个新客户建立连接)。 如果密码不够长 ， 它可能被
猜到 ， 通常建议采取 1 4 个字符或更长 的 口令。
WEP 加密采用 RC4 流密码算法， 它是一个对称流加密算法(可 以参阅第 6 章 " 密码学与对称密
钥算法" 以及第 7 章 " PKl 和密码学应用 " 以获得更多关于该加密算法的信息)。 由于 RC4 在设计
和实现上的缺陷， WEP 在若干地方存在薄弱点 ， 它们是使用静态的公共密钥和薄弱的 Iv(起始向 量)。
由于这些缺点， 对 WEP 进行破解后可以获得足够的、 使用不当 的 IV 以发现 WEP 密钥。 这种攻击
现在可以在不到 60 秒的时间 内进行 。 当 WEP 密钥被发现后， 攻击者就可以加入网络， 并监听所有
其他无线客户端的通信。 因此， 不应该使用 WEPo WEP 并没有提供真正的保护， 可能会导致产生
一种虚假的安全感。
2. WPA
WPA 被设计用来替代 WEP; 它是一个临时的解决办法， 直到新的 802. 1 1i 修订版完成。 制作新
修订花费了数年的时间， 因此 WPA 在市场上得以立足并且直到今天仍然被广泛使用 。 此外 ， WPA
可用于大多数设备 ， 包括不支持 802. 11i 特性的一些低端硬件。
802. 11i 是代替 WEP 加密解决方案的修订协议。 然而， 当 802. 11i 定稿时， WPA 解决方案己经
被广泛使用 ， 所以不能使用原来计划的 WPA 名称， 于是被称为 WPA2 。但这并不表明 802.1li是 WPA
第二版。 事实上， 它们是完全不同 的技术。 802. 11i或 WPA2 实现了类似于 IPSec 的概念并为无线通
信带来最好、 最新的加密和安全性。
第 11 章 网络安全架构与保护网络组件
WPA 基于 LEAP 和 TKIP 加密体系并通常使用安全加密用于认证。 遗憾的是， 使用单个静态的
密码将彻底损坏 WPA 的安全性。 攻击者可以简单地在 WPA 网络中运行暴力猜测攻击以发现密码。
如果密码是 1 4 位字符或更长， 这通常是时间 问题， 但并非不可能无法破解。 此外， 无论是 WPA 的
LEAP 还是 TKIP 加密选工页 ， 目 前都可以使用不同的破解技术进行破解。 尽管 WPA 比 WEP 更复杂，
但 WPA 不再提供长期可靠的安全。
3. WPA2
最后， 一种新的确保无线安全的方法被开发出来， 井且截至 目 前仍然被认为是安全的。 这就是
被称为 802.11i 或 WPA2 的修订方案。 这是一种新的加密方案， 称为计数器模式密码块链接消息认
证码协议(Counter Mode Cipher Block Chaining Message Authentication Code Protocol， CCMP) ， 这是基
于 AES 的加密方案 。 到 目 前为止， 还没有实际的攻击能破坏正确配置的 WPA2 无线网络加密。
4. 802.1X1EAP
WPA 和 WPA2 都支持称为企业认证的 802.1 万EAP ， 这是一个标准的基于端口 的网络访问控制
协议， 确保客户端在没有发生正确认证时不能和资源发生通信联系。 802. 1 X 是一种有效允许无线网
络利用现有的网络基础设施进行认证服务的协议 。 通过使用 802.1x， 其他技术和解决方案 ， 如
RADIUS、 TACACS、 证书、 智能卡、 令牌和生物识别设备， 可 以被集成到无线网络中并提供包括
进行交互和 多 因 子认证的技术。
EAP(Extensible Authentication Protocol， 可扩展认证协议)是认证框架而不是具体的认证机制。 实
际上， EAP 可 以允许新的认证技术与现有无线或点对点连接技术兼容。 有超过 40 种不同 的 EAP 认
证方法获得广泛支持。 这些 EAP 方法包括 LEAP、 EAP-TLS、 EAP-SIM、 EAP-成A 和 EAP-τTLS。
不是所有的 EAP 方法都是安全的。 例如， EAP-MD5 和之前版本的 LEAP 也会被破解。
5. PEAP
PEAP(prot巳cted EAP， 受保护的可扩展认证协议)通过 TLS 隧道封装 EAP 方法， 提供了认证和
潜在的加密功能。 由于 EAP 最初被设计用于在物理上隔离通道， 因此假定固定通路， EAP 通常是
不加密的。 所以， PEAP 可以为 EAP 方法提供加密 。
6. LEAP
LEAP(Lightweight EAP， 轻量级可扩展认证协议)是 Cisco 专有的， 用 于 WPA 替代 TKIP。 在
802. 1 1川TAP2 系统被批准为标准之前， 它被开发用于应对 TKIP 地址不足的情况 。 一种称为 Asleap
的攻击工具在 2004 年发布， 该工具可以破解 LEAP 提供的最终脆弱保护。 如果可能， 应尽量避免
使用 LEAP 并建议使用 EAP-TLS 作为一种替代。 但如果己使用 LEAP， 强烈推荐使用复杂的密码。
7. MAC 过滤器
MAC 过滤器是一系列授权的无线客户端接口 MAC 地址， 这些地址被无线接入点用来阻断那些
未经授权的设备。 虽然这是一个有用的特性， 但是它难 以管理， 并且往往只使用在小型、 静态的环
境中。 此外， 黑客通过基本的无线黑客工具就可以发现有效客户端的 MAC 地址， 然后伪装成该地
址对无线客户端发起攻击。
321
322
CISSP 官方学习指南(第 7 版)
8. TKIP
TKIP(Temporal Key Integrity Prot∞01， 临时密钥完整性协议)被设计为替代 WEP 而不需要更换无
线硬件。 TKIP 在无线网络 802. 1 1 WPA 的名称下得到应用 。 TKIP 改进了很多， 包括密钥的混合功
能， 该功能在使用 RC4 算法密钥进行加密之前结合了初始向量(IV， 一个随机数)与安全的根密钥;
一个序列计数器被用来防止报文重放攻击; 同时还使用 了 一种强大的称为 Michael 的完整性检查。
TKIP 和 WPA 在 2004 年被 WPA2 正式取代。 此外 ， 对 WPA 和 TKIP 的特定攻击(如 WPAtty 和
基于 GPU 的攻击工具)都验证了 WPA 提供的安全性是不可靠的 。
9. CCMP
CCMP(计数器模式密码块链接消息认证码协议)用 于取代 WEP 和 TKIP/\\几PAo CCMP 使用
AES(高级加密标准)和 128 位的密钥。 CCMP 是 802.l1i 制定的在 802. 1 1 无线网络中首选的标准安全
协 议。 到 目 前为止， 还没有攻击能成功破解 AES/CCMP 加密。
1 1 .5.5 天线位置的确定
在部署无线网络时， 天线位置应该是一个值得关注的 问题。 不要在适当的现场勘测完成之前就
固定到一个特定的位置。 将无线接入点和/或它的天线放置在一个可能的位置， 然后测试不同位置的
信号强度和连接质量。 只有在确认该潜在的天线位置提供了令人满意的连接后， 才应该进行永久性
的固定。
在寻找最佳天线位置时应考虑 以下准则 :
• 使用 中 央位置
• 避开固体物理障碍物
• 避开反射或其他平整 的金属表面
• 避开电气设备
如果基站具有外部的全向天线， 通常它们应该在垂直方向进行垂直定位。 如果使用定向天线 ，
指向所需使用的区域的焦点。 记住 ， 无线信号会受到干扰、 距离和障碍物的影响 。 当设计安全的无
线网络时， 工程师可以选择定向天线， 以避免在不希望的地区提供广播信号或在专门覆盖的区域具
有更强的信号 。
1 1 .5.6 天线类型
有很多各种各样的天线类型可用于无线客户端和基站。 许多设备可以用更强的(例如， 信号增强)
天线替代原有的标准天线 。
标准的直杆或杆天线是一种全向天线 ， 可 以在垂直于天线本身的方向上发送和接收信号。 在大
多数基站和一些客户端设备上可发现这种天线类型。 这种类型的天线有时也被称为基础天线或橡胶
天线(事实上大多数天线 由橡胶涂层覆盖)。
其他大多数类型的天线是定向的， 这意味着它们专注于某个主要方向 的发送和接收能力。 一些
例子包括 Yagi 天线、 cantenna 天线、 面板天线和抛物面天线。 Yagi 天线的结构和屋顶上传统的 电视
天线是相似的。 Yagi 天线从一个截面直杆在主杆的方向捕捉特定的无线电频率。 臼ntenna 天线由一
第 11 章 网络安全架构与保护网络组件
段封闭的许多管子构成。 它们沿着管的开口 方向集中 。 一些第一代的 cantenna 天线选取 Pringles 薯
片罐进行制作 。 平板天线是一种平板设备， 只 关注于面板的一个侧面。 抛物面天线则用来聚焦从很
远 的距离发来的或微弱来源的信号 。
1 1 .5.7 调整功率水平控制