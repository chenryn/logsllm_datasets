。均.ct
SQU飞OUlil
Dð.ml
Accou!ll Oom.ajn; SQU
logon险 。<l9b!扮
。崎tctsuver: Se<:unty
Objtd Type: File
。bj<<t陆"，.， c八ClSSPStudy NOlM\OSSP udy Notes 时
HlIndlt:1&. 0-剖面
Proctss lnforMIlt1<。比 Process 10: O)(cd)
Process N.me C:、，Wu晤。削飞"，，1脯，回走
阳怠."R明u四InfonTIllti。民
Ac(es宫四 OElETE
Ac(_ess- M础 。地创阳
i吨Nilme murity
Source: M睬r05cftWindov.馆$民untyaudrt l吨9'" 71'"1l.OI5 10<33，崎AM
‘晶3 TaskC.t吨。甲 阳e 知白m
In旬rmatlon k句、，w:uds::: Auctit Success
N/A Comput配 SQU
In'，。
胁时响rlT'lllt1on:m皿L皿且曲且且血
图 1 7.5 查看 日 志条 目
只 要身份识别和认证过程是安全的 ， Dani1 就有权删除文件。 另 一方面， 如果组织不使用安全
认证流程， 就很可能有其他人冒充另外的用户， Danil 可能面临错误指控。 安全识别和认证实施作
为可 问 责性的先决条件， 如有要求便需要加强 。
注意 :
日 志通常被称为 审计日志， 而 日 志记录通常被称为 审计 日 志记录。 然而， 我们要认识到 : 审计(在
本章后面 会有叙述)不仅仅是 日 志记录。 日 志记录是记录事件， 而 审计会检查所处环境。
2 通用 日 志类型
有许多不同类型 的 日 志。 下面是一个在 IT 环境中常见 日 志的短列表。
安全日 志 安全 日 志能够记录对一些资源的访问 ， 如文件、 文件夹、 打印机等。 例如， 当用户
访问、 修改或删除文件时， 安全 日 志能够记录下来， 如 图 17.5 所示。 许多系统能够 自动记录对关键
系统文件的访问， 但需要管理员在登录访问之前启用对其他资源的审计。 例如， 管理员可能会为专
有数据配置 日 志记录， 但不会对发布在网站上的公共数据进行配置。
系统日 志 系统日 志记录类似于系统或服务器的开启或关闭等事件。 如果攻击者能够关闭系统
第 1 7 章 事件预防和晌应
并使用 CD 或 USB 闪存驱动器将其重启 ， 他们就可以从系统中窃取数据而不留下任何访问记录。 同
样， 如果攻击者能够将正在监视系统的服务停止， 他们就可能能够在不产生任何行动 日 志的情况下
访问系统。 能够检测 出系统重启 或服务停止的 日 志有助于管理员 发现潜在恶意行为 。
应用程序 日 志 这些 日 志记录特定应用程序的信息 。 应用程序开发人员能够选择要在应用程序
日 志中做出记录 的程序。 例如， 开发人员可以设置在任何人访问特定的数据对象(如表或视图)时，
日 志做出记录。
防火墙日 志 防火墙 日 志可 以记录与到达防火墙的流量相关的任何事件， 包括防火墙允许的流
量和阻止的流量。 这些 日 志通常记录主要的数据包信息 ， 如源和目的E地址、 源和 目 的端口， 但不
记录数据包的实际 内容。
代理日 志 代理服务器为用户提高了互联网访问性能， 并可以控制用户访问的网站的范围。 代
理 日志有记录详细信息的功能， 如特定用户访问 了 哪些网站， 以及他们浏览网站花费了 多长时间。
当用户试图访 问 己知的禁止访 问 的网站时 ， 代理 日 志也能够做 出记录。
变更 日 志 作为整体变更管理过程的一部分， 变更 日 志能够记录变更请求、 批准和系统的实际
变更。 跟踪被批准的变更是很有益处的。 作为灾难恢复计划的一部分， 变更日 志仍大有益处。 例如，
发生故障之后， 灾难管理员或技术人员可 以使用变更 日 志将系统还原， 其中包括所有应用的变更。
日 志记录通常是操作系统中 的本地功能， 并用于大多数应用程序和服务。 这使得管理人员和技
术人员能够相对容易地配置系统来记录特定类型的事件。 特权账户 的事件， 如管理员和根用 户账户 ，
应包含在任何 日 志记录计划中。 这有助于防止恶意内部人员 的攻击， 并能够在必要时提供起诉的活
动文件。
3 保护日志数据
组织内 部人员可以使用 日 志来重新创建事件， 但前提是 日志没有被修改。 如果攻击者可以修改
日志， 他们便能够擦除 自 己的活动痕迹， 有效地清除有价值的数据。 文件便不再含有准确的信息 ，
也不能作 为起诉攻击者的证据 。 所以， 保护 日 志文件免受未授权的访 问和修改是很重要的 。
在 中央系统上存储日 志的副本来保护 日 志的方法很常见。 即使攻击者修改或破坏了 原始文件，
工作人员也仍然可以使用副本查看事件 。 保护 日 志文件的一个方法是通过指定权限来限制他们的访
问权。
对于实施 日 志文件备份的组织通常都有严格的管理策略。 此外， 这些策略都规定了 备份保留时
间 。 例如， 组织可能会将归档 日 志文件保存一年、 三年或更长时间。 一些政府法规要求组织无限期
地保存归档 日志。 能够设置 日 志只读模式、 分配权限、 实施物理控制的安全控制可以保护归档 日 志
免受未授权的访问和修改。 当不再需要 日 志时 ， 应及时销毁。
提示 :
组织有法律经验的话， 就会意识到对不必要 日 志的过度保存会导致劳动成本的过度使用 。 例如，
如果法规要求组织保存一年内 的日志， 而组织却保存了 十年， 法院在检查时就会要求相关人员 检索
这十年内 日 志 中 的相 关数据。 相比之下 ， 如果组织只保存了 一年的 日 志， 相关人员 只 需要在这一年
的日志 中 检索有价值的信息 ， 这会显著减少所需的 时间和精力 。
美国国家标准与技术研究所例1ST)发表了 大量的与 IT 安全问题相关的信息， 包括联邦信息处理
标准σIPS)出版物。 联邦信息和信息系统σIPS 200)的最低安全要求中 明确指明 了 以下信息为审计数
据 的最低安全要求:
51 5
51 6
CISSP 官方学 习指南(第 7 版)
• 建立、 保护和保留信息系统审计记录 ， 以使监测 、 分析、 调查和报告非法的 、 未授权的或
不适当的信息系统活动的 需求范围扩大。
• 确保个人信息系统用户的行为能够被唯一地追踪到这些用户 ， 以便他们能够为自 己的行动
负责。
注意 :
在准备 CISSP 考试时 ， 你会发现复习 NIST 文件是很有帮助的。 对于不 同 的安全概念， 它 能为
你提供更全面的信息。 这些信息都是免费的， 下 面是网址: htφ:/ /csrc.nist. gov。 也可以点击下面这个
网 址来下载 FIPS 200 文件 http://csrc.nist.gov/publications/自ps/:fips200IFIPS-200-:final-march. pdf.
4. 角 色监控
监控功能为组织带来了 很多好处， 比如增加可问责'性、 帮助调查、 提供基本的故障排除方法。
下面将更深入地描述这些好处。
监控和可问责性
监控是一个必要的功能， 能够确保受监控者(如用户和员工)可以对他们的行动和活动负责 。 用
户提供身份(如用户名)并证明 自 己的身份(通过认证)， 然后审计跟踪系统就会在其登录时记录活动。
监控和审 计跟踪 日 志使得用户 能够承担相应责任 。
这直接促进用户 的积极行为并能使其遵守组织的安全策略。 意识到 日 志能够记录活动信息的用
户 ， 不大可能会尝试绕过安全控制或执行未授权威受限制 的活动 。
一旦发生违反安全策略的事件， 应确定违规的来源。 如果确定是个人责任， 他们应该依照组织
的 安全策略承担相应的责任 。 如果事件严重， 可能会终止劳动合同 或进行法律起诉。
立法往往需要具体的监督和可问责实践。 这包括许多组织都必须遵守的法律， 如 2002 萨班斯奥克斯利法案、 健康保险流通与责任法案(HJPAA)和欧盟的隐私法律。
⑤ 真实场景
监控活动
从一线步兵到监控 日 常运作的 高级指挥官， 对于每个层面 的业务工作来说， 可 问责都是相当必
要的 。 如果不对用 户 及其活动 ， 或者 系统中 的应 用 程序进行监控的话， 就无法实现可问 责性。
Duane 是一家石 油钻井数据挖掘公司 数据录入部 门 的质量安全主管。 在日常工作 中 ， 他能够看
到许多敏感文件， 其 中 包括有价值的信息， 这些信息可以帮助 Duane 从那些对这些数据感兴趣的人
那里获得不菲的小费。 他也会纠正一些可能会导致客户 严重不满的幸如吴， 有时f候!美吴， 一个小
会给客户 的 整个计划划l 带未非常严重的 问题。
Duane 在其工作站中接触或转发这类信息时， 就会留 下 电子追踪证据。 他的主管 Nicole， 能够
使用 该线索检查 Duane 的操作是否是在被监控的情况下进行的。 她可以在 D回ne 访 问或修改敏感信
息时， 监控到 Duane 从哪里获得信息， 并将其放直到哪里， 同 时还能监控到信息从信息源到客户 端
之间 的 处理过程。
这种可问 责性能够为公司提供保障 ， 以免 Duane 滥用信息。 同 时也能保护 Duane， 以 防他人指
控 自 己 滥用 数据处理职能。
第 1 7 章 事件预防和响应
监控和调查
审计跟踪系统使得调查人员在发生事件之后能够对其进行重建。 它们可以记录访问权限的滥用 、
特权侵犯、 试图入侵和许多不同类型的攻击。 在检测到安全冲突后， 通过对审计追踪信息进行检查 ，
安全专业人员可 以重建导致事件的条件和系统状态。
确保日 志有准确的时间戳很重要， 这些时间戳在整个环境中 需要保持一致。 常用 的方法是建立
一台内部的网络时间协议(Network Time Protocol. NTP)服务器， 该服务器是同步的可信时间源， 如
公共 NTP 服务器。 其他系统可 以用此内部 NTP 服务器同步时间。
注意 :
系 统应保持时间与一台 集中或受信任的公共时间服务器同步， 这确保所有的审计 日 志记录事件
的 准确 性和时间的一致性。
监控和问题识别
审计跟踪为管理员提供了一些有用的 、 与事件相关的详细信息。 它们可以记录系统故障、 操作
系统错误和软件错误， 还有恶意攻击。 一些 日 志文件甚至可以捕获应用程序或系统崩溃时内存的 内
容。 这些信息可以帮助查明事件的原因， 如果确认是攻击的话， 信息还能够帮助消除威胁。 例如，
如果系统 由于内存不 足而崩溃 ， 崩 溃转储文件可 以帮助诊断问题。
为此而使用 日 志文件通常被称为问题识别 。 一旦确定了 问题， 执行解决问题的步骤则需要更多