title:Proof of plaintext knowledge for code-based public-key encryption
revisited
author:Rong Hu and
Kirill Morozov and
Tsuyoshi Takagi
Public-Key Encryption, Revisited: Tight Security and
Richer Functionalities
Romain Gay
To cite this version:
Romain Gay. Public-Key Encryption, Revisited: Tight Security and Richer Functionalities. Cryptog-
raphy and Security [cs.CR]. PSL Research University, 2019. English. tel-02137987
HAL Id: tel-02137987
https://tel.archives-ouvertes.fr/tel-02137987
Submitted on 23 May 2019
HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.
L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.
Préparée à l’École normale supérieure 
Public-Key Encryption, Revisited: 
Tight Security and Richer Functionalities 
Soutenue par 
Romain Gay  
Le 18 mars 2019 
Ecole doctorale n° 386 
Sciences Mathématiques de 
Paris Centre 
Spécialité 
Informatique 
Composition du jury : 
M. Michel FERREIRA ABDALLA 
École Normale Supérieure  
M. Hoeteck WEE 
École Normale Supérieure  
M. Benoît LIBERT 
École normale supérieure de Lyon   
M. Katsuyuki TAKASHIMA 
Mitsubishi Electric 
M. Dario FIORE 
IMDEA Software Institute   
M. Pierre Alain FOUQUE 
Université Rennes 1 
M. Dennis HOFHEINZ   
Karlsruher Institut für Technologie   
Mme. Huijia LIN 
University of Washington   
Directeur de thèse 
Directeur de thèse 
Rapporteur 
Rapporteur 
Examinateur 
Examinateur 
Examinateur 
Examinatrice 
Public-key Encryption, Revisited: Tight Security and Richer
Functionalities
Romain Gay
Supervised by Michel Ferreira Abdalla and Hoeteck Wee
ii
Abstract
Our work revisits public-key encryption in two ways: 1) we provide a stronger security guaran-
tee than typical public-key encryption, which handles many users than can collude to perform
sophisticated attacks. This is necessary when considering widely deployed encryption schemes,
where many sessions are performed concurrently, as in the case on the Internet; 2) we consider
so-called functional encryption, introduced by Boneh, Sahai, Waters in 2011, that permits se-
lective computation on the encrypted data, as opposed to the coarse-grained access provided by
traditional public-key encryption. It generalizes the latter, in that a master secret key is used
to generate so-called functional decryption keys, each of which is associated with a particular
function. An encryption of a message m, together with a functional decryption key associated
with the function f, decrypts the value f(m), without revealing any additional information
about the encrypted message m. A typical scenario involves the encryption of sensitive medical
data, and the generation of functional decryption keys for functions that compute statistics on
this encrypted data, without revealing the individual medical records.
In this thesis, we present a new public-key encryption that satisﬁes a strong security guar-
antee, that does not degrade with the number of users, and that prevents adversaries from
tampering ciphertexts. We also give new functional encryption schemes, whose security relies
on well-founded assumptions. We follow a bottom-up approach, where we start from simple
constructions that can handle a restricted class of functions, and we extend these to richer
functionalities. We also focus on adding new features that make functional encryption more
relevant to practical scenarios, such as multi-input functional encryption, where encryption
is split among diﬀerent non-cooperative users. We also give techniques to decentralize the
generation of functional decryption keys, and the setup of the functional encryption scheme,
in order to completely remove the need for a trusted third party holding the master secret key.
iii
iv
Résumé
Nos travaux revisitent le chiﬀrement à clé publique de deux facons: 1) nous donnons une
meilleure garantie de sécurité que les chiﬀrements à clé publique typiques, qui gère de nom-
breux utilisateurs pouvant coopérer pour réaliser des attaques sophistiquées. Une telle sécu-
rité est nécessaire lorsque l’on considère des schémas de chiﬀrement largement déployés, où de
nombreuses sessions ont lieu de manière concurrente, ce qui est le cas sur internet; 2) nous
considérons le chiﬀrement fonctionnel, introduit en 2011 par Boneh, Sahai et Waters, qui per-
met un calcul sélectif sur les données chiﬀrées, par opposition à l’accès tout ou rien permis par
les schémas de chiﬀrement à clé publique traditionnels. Il généralise ce dernier dans le sens
où une clé secrète maîtresse permet de générer des clés de chiﬀrement fonctionnelles, qui sont
chacune associées à une fonction particulière. Le déchiﬀrement du chiﬀrement d’un message m
avec une clé de déchiﬀrement fonctionnelle associée à une fonction f obtiendra la valeur f(m),
et aucune autre information à propos du message chiﬀré m. Un scénario typique: des données
médicales privées sont chiﬀrées, et des clés de déchiﬀrement fonctionnelles sont générées pour
des fonctions qui permettent de calculer des statistiques, sans révéler les données individuelles
chiﬀrées.
Dans cette thèse, nous présentons un nouveau schéma de chiﬀrement à clé publique satis-
faisant une garantie de sécurité forte, qui ne se dégrade pas avec le nombre de clients utilisant
le schéma, et qui empêche les adversaires de modiﬁer activement les chiﬀrés. Nos donnons aussi
des schémas de chiﬀrement fonctionnels, dont la sécurité repose sur des hypothèses calcula-
toires robustes. L’approche suivie est bottom-up, où des constructions simples qui permettent
de générer des clés pour une classe restreinte de fonctions sont étendues à des classes de fonc-
tions plus riches. Un intérêt a aussi été porté à l’étude d’améliorations qui rendent le chiﬀre-
ment fonctionnel plus utilisable en pratique, tel que le chiﬀrement fonctionnel multientré, où le
chiﬀrement est partagé entre diﬀérents utilisateurs, sans coopération. Nous donnons aussi des
techniques permettant de décentraliser la génération de clés de déchiﬀrement fonctionnelles,
et la mise en place du schéma de chiﬀrement, de sorte que la présence d’un tiers de conﬁance
possédant la clé secrète principale ne soit plus nécessaire.
v
vi
Contents
1 Introduction
1.1 Tight Security . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.1.1
State of the Art in Tight Security . . . . . . . . . . . . . . . . . . . . .
1.1.2 Contribution 1: Tightly CCA-Secure Encryption without Pairing . . . .
1.2 Functional Encryption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2.1
State of the Art in Functional Encryption . . . . . . . . . . . . . . . . .
1.2.2 Contribution 2: Functional Encryption with New Features, and Richer
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2.3 Other contributions
Functionalities
2 Preliminaries
2.1 Notations and Basics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.1 Collision resistant hashing . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.2
Symmetric-Key Encryption . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.3 Authenticated Encryption . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.4 Public-Key Encryption . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.1.5 Key-Encapsulation Mechanism . . . . . . . . . . . . . . . . . . . . . . .
2.2 Cryptographic Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.1 Prime-Order Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.2 Pairing Groups . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.3 Matrix Diﬃe-Hellman . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2.4 Decisional Composite Residuosity . . . . . . . . . . . . . . . . . . . . . .
2.2.5 Learning With Errors
. . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Deﬁnitions for Single-Input Functional Encryption . . . . . . . . . . . . . . . .
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Deﬁnitions for Multi-Input Functional Encryption . . . . . . . . . . . . . . . .
2.4.1
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4.2 Removing the extra condition generically . . . . . . . . . . . . . . . . .
2.5 Deﬁnitions for Multi-Client Functional Encryption . . . . . . . . . . . . . . . .
2.6 Concrete Instances of Functional Encryption for Inner Products . . . . . . . . .
Inner-Product FE from MDDH . . . . . . . . . . . . . . . . . . . . . . .
Inner-Product FE from LWE . . . . . . . . . . . . . . . . . . . . . . . .
Inner-Product FE from DCR . . . . . . . . . . . . . . . . . . . . . . . .
Security notions
Security notions
2.3.1
2.6.1
2.6.2
2.6.3
3 Tightly CCA-Secure Encryption without Pairings
3.1 Multi-ciphertext PCA-secure KEM . . . . . . . . . . . . . . . . . . . . . . . . .
3.1.1 Our construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.1.2
Security proof . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
. . . . . . . . . .
3.2.1 Our construction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.3 Security proof of PKE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3.2 Multi-ciphertext CCA-secure Public Key Encryption scheme
vii
1
2
3
4
4
6
9
14
19
19
19
20
20
20
21
22
22
23
23
26
26
27
28
31
32
33
35
38
38
44
45
47
50
50
51
60
60
62
viii
CONTENTS
4 Multi-Input Inner-Product Functional Encryption from Pairings
4.1 Selectively-Secure, Private-Key MIFE for Inner Products
. . . . . . . . . . . .
4.1.1
Selectively-secure, multi-input scheme from single-input scheme . . . . .
4.1.2 Putting everything together . . . . . . . . . . . . . . . . . . . . . . . . .
4.2 Achieving Adaptive Security . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
80
80
91
93
5 Multi-Input Inner-Product Functional Encryption without Pairings
101
5.1 From Single to Multi-Input FE for Inner Product . . . . . . . . . . . . . . . . . 102
5.1.1
Information-Theoretic MIFE with One-Time Security . . . . . . . . . . 103
5.1.2 Our Transformation for Inner Product over ZL . . . . . . . . . . . . . . 104
5.1.3 Our Transformation for Inner Product over Z . . . . . . . . . . . . . . . 106
5.2 Concrete instances of FE for Inner Product . . . . . . . . . . . . . . . . . . . . 112
Inner Product FE from MDDH . . . . . . . . . . . . . . . . . . . . . . . 112
Inner Product FE from LWE . . . . . . . . . . . . . . . . . . . . . . . . 113
Inner Product FE from DCR . . . . . . . . . . . . . . . . . . . . . . . . 114
5.2.1
5.2.2
5.2.3
6 Multi-Client Inner Product Functional Encryption
117
6.1 MCFE with one-AD-IND-weak security . . . . . . . . . . . . . . . . . . . . . . 119
6.2 From one to many ciphertext for MCFE . . . . . . . . . . . . . . . . . . . . . . 124
6.3 Secret Sharing Encapsulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
6.3.1 Deﬁnitions
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
6.3.2 Construction of the Secret Sharing Encapsulation . . . . . . . . . . . . . 131
6.4 Strengthening the Security of MCFE Using SSE . . . . . . . . . . . . . . . . . 133
6.4.1 Generic construction of xx-AD-IND security for MCFE . . . . . . . . . 133
6.5 Decentralizing MCFE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
6.5.1 Distributed Sum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
6.5.2 Our DSum Protocol
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
Security Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
6.5.3
6.5.4 Application to DMCFE for Inner Products
. . . . . . . . . . . . . . . . 140
7 Functional Encryption for Quadratic Functions
141
7.1 Private-key FE with one-SEL-IND security . . . . . . . . . . . . . . . . . . . . 143
7.2 Public-key FE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
8 Conclusion
157
8.1 Summary of the Contributions
. . . . . . . . . . . . . . . . . . . . . . . . . . . 157
8.2 Open Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
Chapter 1
Introduction
Cryptography helps resolve the tension between the ubiquitous use of mistrusted third-party
servers to store sensitive data, and the desire for privacy. Concentrating data in a few powerful
centers induces economies of scale, and provides an unprecedented availability of computing
power and data storage. However, giving away sensitive data in the clear implies that clients
have to trust their providers. Advanced encryption mechanisms overcome this issue by allowing
users to encrypt their data in a way that still permits servers to perform selective computation
on this encrypted data. The information revealed is exactly what is required by the server to
provide its service to the clients, and nothing else. Moreover, given its unprecedented world-
wide deployment, public-key cryptography needs to fulﬁll a strong security, which prevents
sophisticated attacks using multiple concurrent sessions, which are inevitable on the Internet.
The work presented in this thesis addresses the following two limitations of traditional
public-key cryptography: 1) it provides stronger security for public-key encryption, that does
not degrade with the number of users, as is necessary for largely deployed systems, 2) it presents
encryption schemes, known as functional encryption schemes, which permit ﬁne-grained access