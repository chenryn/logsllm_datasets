relays provide us with an accurate view of all Tor network
trafﬁc, we conducted an analysis of the exit policies used by
Tor exit relays. After analyzing multiple consensuses that
were produced during April 2016, we found that all 219 ports
rejected in Tor’s default exit policy6 (most of which are re-
4https://research.torproject.org/safetyboard.html
5Our usage of exit policies only involves port numbers, al-
though IP addresses may also be speciﬁed.
6reject 25, 119, [135-139], 445, 563, 1214, [4661-4666], [6346-
6429], 6699, [6881-6999]; accept *
Table 5: Ports considered for exploratory measurements
Trafﬁc Type
HTTP/S
BitTorrent Base
BitTorrent Extended
Other File-Sharing
Various
Label
web
btb
bte
ofs
var
Ports
80,443
[6881-6889]
[6890-6999]
1214,[4661-4666],[6346-6429],6699
25,119,[135-139],445,563
Table 6: Policies considered for exploratory measurements
and weighted exit bandwidth supporting each policy
Name
Strict
Default
FS
FS+
FS++
Open
Policy by Label (see Table 5)
reject web, btb, bte, ofs, var
accept web; reject btb, bte, ofs, var
accept web, ofs; reject btb, bte, var
accept web, bte, ofs; reject btb, var
accept web, btb, bte, ofs; reject var
accept web, btb, bte, ofs, var
Exit BW (%)
14
68
3.7
2.7
9.9
1.1
lated to ﬁle-sharing) constituted the 219 most rejected ports
in Tor. We also found that similar fractions of exit bandwidth
are available for several of the ports that are blocked by de-
fault. Table 5 shows these similarly grouped ports and the
type of trafﬁc commonly associated with them, as well as the
ports of the most accepted trafﬁc type (HTTP/S).
We continued our analysis to understand which combina-
tions of the groups of ports in Table 5 are accepted and re-
jected by each relay. We computed the percentage of exit
relays, weighted by their probability of selection in the exit
position, that accepted or rejected each group of ports. Of
the 25 = 32 possible combinations of these exit policies, only
7 of them were valid (that is, at least one exit matched the
policy). Table 6 lists the top 6 policies7 and the percentage
of exit bandwidth that supported each policy (we ignore the
remaining valid exit policy as it was supported by less than
0.1% of exit bandwidth).
We found that the default policy is by far the most popu-
lar policy: it is supported by 68% of relays and supports exit
to the 65,315 most allowed ports. We also found that 17%
of exits support at least some of the ports commonly asso-
ciated with ﬁle-sharing, even though those ports are among
the least allowed ports. Finally, over 14% of exit bandwidth
does not support exiting to the HTTP/S ports 80 and 443,
although it is the most allowed trafﬁc type in Tor. We se-
lected the exit policies to use on our exit relays during the
exploratory phase based on the results of this analysis.
5.2 Exploratory Measurements
We ﬁrst discuss the measurement results collected with
our PrivCount deployment before describing how to use them
to infer full Tor network statistics.
Results. Our primary measurement results related to trafﬁc
distribution are shown in Figure 3. Figure 3a shows the total
number of active circuits (circuits with at least one completed
stream) as counted by our exit relays over the 24 hour collec-
tion intervals and according to the trafﬁc type classiﬁed by
PrivCount. Figure 3b similarly shows the number of streams
(TCP connections that exit the Tor network) observed by our
exit relays, and Figure 3c shows the sum of the amount of
data transferred in both directions on those streams. The col-
lected measurement results for each of the exit policies from
7All policies are prepended to Tor’s default policy.
(a) Counts of active Tor circuits
(b) Counts of connections exiting Tor
(c) Counts of data transferred on connections exiting Tor
Figure 3: Measurement results collected while using vari-
ous exit policies, by the trafﬁc type classiﬁed by PrivCount.
Error bars show 95 percent conﬁdence intervals.
Table 6 are shown with 95% conﬁdence intervals that account
for the noise that was probabilistically added to each counter.
Consistent across all six exit policies and all three statis-
tics shown in Figure 3, we observed very low counts for In-
teractive trafﬁc relative to Web or Other. This indicates that
Interactive trafﬁc is a very minor part of Tor’s overall trafﬁc
distribution and so may be safely ignored during later mea-
surement periods.
We also observed that the number of circuits (3a) and the
number of streams (3b) for the Web class remained relatively
consistent across all of the exit policies that we used dur-
ing measurement, except for the strict policy. The number
of streams did show some ﬂuctuation among exit policies,
which we attribute to the somewhat large error bounds for
the Web class. Note that the strict exit policy does not allow
trafﬁc that would have been classiﬁed as Web, and therefore
the positive counts for Web under the strict policy in Fig-
ure 3 correspond directly to the noise that was added to those
counters by PrivCount.
InteractiveWebOther0123456NumberofCircuits×1064,78056,315397,9796,6451,415,683490,7442,8171,129,0561,126,7311,8801,608,1164,927,4503611,467,0243,513,1196,7571,422,4201,890,266StrictDefaultFSFS+FS++OpenInteractiveWebOther0.00.51.01.52.02.53.03.54.04.5NumberofStreams×10711,5787,551,9812,518,2658,90531,335,1621,863,0136,99528,947,6112,467,31415,60123,581,9707,403,54810,23134,608,62610,011,7628,47532,297,26615,694,073StrictDefaultFSFS+FS++OpenInteractiveWebOther0.00.51.01.52.02.5StreamDataTransferred(GiB)×10321541062,28435811,68135831,48560441,8531,127134771,295StrictDefaultFSFS+FS++OpenTable 7: 10-minute mean Tor network activity inferred from exploratory measurements
Trafﬁc
Class
Stream Data (GiB)
Count
Streams (×103)
95% CI
Count
Total
Interactive
Web
Other
Active Circuits (×103)
95% CI
Count
1,200 (100%) ±500 (42%)
±2 (67%)
3 (0%)
640 (53%)
±80 (13%)
±50 (9%)
580 (48%)
17,000 (100%) ±4,000 (24%)
±4 (80%)
5 (0%)
15,000 (88%)
±4,000 (27%)
±200 (11%)
1,900 (11%)
95% CI
1,100 (100%) ±300 (27%)
±1 (33%)
3 (0%)
1,000 (91%)
±300 (30%)
±40 (15%)
260 (24%)
Although Web circuits and streams remain relatively con-
sistent across exit policies, Other circuits and streams do not.
The number of observed Other circuits (3a) increases dra-
matically and somewhat sporadically when using exit poli-
cies that allow exiting to ﬁle-sharing ports. The number of
observed Other streams (3b) similarly increases when ﬁle-
sharing ports are allowed, and the number of streams trends
higher as less restrictive exit policies are used (and therefore
more ﬁle-sharing ports are allowed). These observations fol-
low common trafﬁc patterns of ﬁle-sharing protocols, which
tend to create many connections with their peers in order to
decrease download times for large ﬁles.
Similar to the circuit and stream count trends, we observed
that the amount of Other stream data transferred on con-
nections exiting Tor (3c) also increases signiﬁcantly as the
number of ﬁle-sharing ports that our exit relays allow in-
creases. However, unlike the Web circuit and stream counts
(which are mostly unaffected by the increase in Other cir-
cuits and streams), the amount of Web data transferred de-
creases as the amount of Other data transferred increases.
This suggests a crowding-out situation, where each of the
trafﬁc classes are in direct competition for the limited band-
width of our exit relays and ﬁle-sharing trafﬁc wins the com-
petition. The number of Web circuits (3a) and streams (3b)
are consistent even when the amount of transferred Web data
(3c) decreases, indicating that the performance for the web
streams that coexist with ﬁle-sharing streams may be sig-
niﬁcantly reduced. If this hypothesis holds true, then users
could potentially improve their web browsing experience sim-
ply by excluding those exit relays that allow ﬁle-sharing ports
in their exit policies when building circuits. This presents an
interesting area for future work.
Finally, we observed that restricting Web trafﬁc from exit-
ing our relays using the strict policy did not result in a dra-
matic increase in circuits, streams, or data transferred for
either the Interactive or Other classes. This increases our
conﬁdence that there are not other ports whose activity is
crowded out by the activity associated with the Web ports.
Inferring Network Totals. Our results from the exploratory
phase improve our understanding of how trafﬁc character-
istics vary with different exit policies. However, the results
can be somewhat misleading when compared directly with-
out accounting for the relative exit bandwidth support avail-
able for each exit policy type. Accounting for the popularity
of each exit policy used during measurement will provide a
better estimate of the overall trafﬁc characteristics over the
entire Tor network. We now produce such an inference.
We collected the 24 consensus ﬁles (one for each hour) that
were produced during each of the 6 exploratory measure-
ment rounds presented above (24 · 6 = 144 ﬁles total). For
each set of 24 ﬁles, which corresponds to a single exit pol-
icy and a collection of measurement results, we computed
the mean fractional weight for selecting our relays in the en-
try position as Wg, the mean fractional weight for selecting
Table 8: Comparison of exit trafﬁc distribution
This Work
Trafﬁc Class
2008 [23]
s HTTP/S
n
n
o
C
s HTTP/S
Interactive
Other
Interactive
Other
e
t
y
B
2010 [8]
96.51% 70.40%
0.08%
1.72%
3.41% 27.88%
59.52% 41.81%
0.23%
0.26%
51.82% 57.92%
88%
0%
11%
91%
0%
24%
our relays in the exit position as We, and the mean fractional
weight of other relays supporting the exit policy that we used
during that collection phase as Wp. We then scale our mea-
sured entry statistics by Wp/Wg and our measured exit statis-
tics by Wp/We, and sum the scaled results from all phases to
produce a ﬁnal network total estimate.
Table 7 shows the inferred estimates of the number of ac-
tive circuits, streams, and total amount of data transferred
on streams for each trafﬁc class and across the entire Tor net-
work during an average 10-minute interval. Note that for
the statistics that don’t sum to 100%, the percentages shown
in the table are calculated using a separate, single total count
that we collected (e.g. total active circuits) rather than a sum
of the three class-speciﬁc individual counts. This was done
to avoid aggregating noise and improve the accuracy of the
estimate where possible. The conﬁdence intervals shown in-
clude the uncertainty associated with the noise added to the
counters as well as the sampling error.
As with our direct measurements, our inference indicates
that Interactive trafﬁc is a very minor contributor to the over-
all inferred activity on Tor. Our inference also indicates that
Web trafﬁc is the dominant type of trafﬁc seen on the network
for all three of the statistics shown in the table. In particular,
we found that Web trafﬁc accounts for 88% of the streams
created in Tor and 91% of the stream data. A comparison to
previous measurement studies is given in Table 8. Overall,
our results indicate that HTTP/S usage has increased since
2010 relative to other protocols, which we suggest is due to
usability improvements in browsing the web with Tor (e.g.
Tor Browser).
5.3
In-Depth Measurements
We present the results from our in-depth rounds as in-
ferred Tor network totals that we computed by adjusting each
entry and exit statistic by our mean entry and exit probability,
respectively. Note that the inferences based on exit statistics
assume that relays using non-default exit policies observe
trafﬁc characteristics similar to those observed while using
the default policy. Future work should consider taking these
measurements with different exit policies (e.g., that allow or
partially allow ﬁle-sharing ports).
Entry Statistics. The entry statistics that we collected focused
on counting the number of observed unique clients and the
number of those clients that were active and inactive. Re-
Table 9: 10-minute mean Tor network activity inferred from
single-counter in-depth entry statistics
Statistic
Unique Clients (×103)
Active
Inactive
Client Conns (×103)
Count
95% CI
710 (100%) ±85 (12%)
550 (77%)
±70 (13%)
140 (20%)
±30 (21%)
560 (100%) ±60 (11%)
Table 10: 10-minute mean Tor network activity inferred
from single-counter in-depth exit statistics
Statistic
Active Circuits (×103)
Web
Other
Inactive Circuits (×103)
Streams (×103)
Web
Other
Stream Data (GiB)
Web
Other
Count
95% CI
±200 (14%)
1,400 (100%)
±100 (14%)
700 (50%)
±50 (7%)
680 (49%)
±100 (8%)
1,300 (100%)
15,000 (100%) ±3,000 (20%)
17,000 (113%) ±3,000 (18%)
±200 (13%)
1,600 (11%)
±200 (15%)
1,300 (100%)