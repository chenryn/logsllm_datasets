1
1
4
4
6
6
245891
245891
6
6
3
3
7
7
3
3
0
0
4
4
2
2
4
4
3
3
7
7
10
10
11
11
12
12
14
14
15
15
17
17
18
18
28
28
34
34
39
39
43
43
44
44
1
1
6
6
13
13
19
19
20
20
21
21
22
22
23
23
24
24
25
25
26
26
27
27
29
29
30
30
31
31
32
32
33
33
35
35
38
38
41
41
2
2
4
4
5
5
8
8
9
9
16
16
36
36
37
37
40
40
42
42
Figure 3:  Clustered adjacency matrix for attack 
graph in Figure 1. 
0
0
0
-2
-2
-2
-4
-4
-4
-6
-6
-6
-8
-8
-8
-10
-10
-10
-12
-12
-12
-14
-14
-14
-16
-16
-16
-18
-18
-18
-20
-20
-20
Figure 4:  Clustered adjacency matrix for attack 
graph in Figure 1, raised to 2nd power for 2-step 
attacks. 
In  Figure  6,  we  have  combined  the  reachability 
matrices in Figure 5 (and the adjacency  matrix in  Figure 
3)  into  a  single  matrix,  as  defined  by  Equation  (3).    All 
the  information  in  the  separate  per-step  reachability 
matrices  can  now  be  seen  together.    This  multi-step 
reachability matrix is used again in Section 4.4 for attack 
origin and impact prediction. 
A2
A2
A3
A3
A4
A4
Figure 5:  Reachability for 2, 3, and 4 steps for attack graph in Figure 1. 
¥
¥
¥
s
s
p
p
e
e
t
t
s
s
k
k
c
c
a
a
t
t
t
t
a
a
f
f
o
o
r
r
e
e
b
b
m
m
u
u
n
n
m
m
u
u
m
m
i
i
n
n
i
i
M
M
4
4
4
3
3
3
2
2
2
1
1
1
Figure 6:  Multi-step reachability for attack graph 
in Figure 1. 
4.2  Reachability for Attack Graph Changes 
Figure 7 shows an attack graph adjacency matrix for 
a network of 730 machines.  While we do not show it, the 
corresponding  drawn  attack  graph  would  be  exceedingly 
cluttered  and  difficult  to  understand.    Again,  we  have 
aggregated low-level security conditions to machines and 
sets of exploits between them, so that rows and columns 
are  machines,  and  non-zero  entries  mean  at  least  one 
exploit  between  a  pair  of  machines.    Here,  a  priori 
ordering of machines (rows and columns) is sufficient, so 
that  we  do  not  apply  matrix  clustering.    In  the  figure, 
black  indicates  the  attack  graph  for  a  baseline  network 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:12:28 UTC from IEEE Xplore.  Restrictions apply. 
configuration, before any network configuration changes.  
Orange  then  indicates  new  attack  graph  edges,  resulting 
from changes to the network configuration.  In this case, 
the  vertical  orange  lines  (columns)  indicate  vulnerable 
web servers that  have been added to the network,  with a 
policy  that  all  machines  in  the  network  can  connect  to 
these vulnerable servers. 
Figure  8  shows  the  resulting  transitive  closure  (all-
step  reachability)  for  the  baseline  (black)  and  changed 
(black+orange)  network. 
  Here  we  see  that  before 
deployment  of  the  web  servers  (black),  attacks  are  only 
possible within the main diagonal blocks, from block A2,2 
to blocks A3,3 and A4,4, and from block A3,3 to block A4,4.  
But  after  deployment  of  the  web  server  (black+orange), 
machines  in  block  A1,1  can  reach  all  machines  in  the 
network,  and  all  machines  in  the  network  can  reach  the 
machines in blocks A2,2, A3,3, A4,4, and A5,5.  That is, only 
machines in block A1,1 are safe from attacks outside their 
block. 
100
100
200
200
300
300
400
400
500
500
600
600
700
700
100
100
200
200
300
300
400
400
500
500
600
600
700
700
Figure 7:  Attack graph adjacency matrix for 
baseline (black) and changed (orange) network. 
100
100
200
200
300
300
400
400
500
500
600
600
700
700
100
100
200
200
300
300
400
400
500
500
600
600
700
700
Figure 8:  Transitive closure for Figure 7, for 
baseline (black) and changed (black+orange) 
network. 
4.3  Prediction of Attack Origin and Impact  
Figure  9  shows  the  multi-step  vulnerability-based 
reachability  matrix  from  Figure  6,  but  this  time  with 
intrusion  alarms  associated  with  elements  of  the  matrix.  
Thus, knowing attack reachability across the network, we 
can  categorize  and  correlate  detected  intrusions  in  terms 
of  it.    In  Figure  9,  an  intrusion  alarm  (in  yellow)  occurs 
between  a  pair  of  machines  that  are  known  to  be 
unreachable from one to the other.  In this case, we might 
consider  it  to  be  a  false  alarm.    Similarly,  an  intrusion 
alarm  (in  purple)  occurs  between  a  pair  of  machines, 
which,  according  to  the  attack  graph,  should  require  at 
least 4 attack steps to reach from one to the other.  If we 
were  to  rely  on  traditional  attack  graph  drawings,  we 
would  need  to  trace  many  edges  before  coming  to  this 
conclusion. 
There  are  2  other  intrusion  alarms  in  Figure  9  that 
according to the attack  graph, are each possible one-step 
attacks.    In  fact,  if  we  project  (along  a  column)  from 
Alarm 1  to  the  main  diagonal,  we  find  Alarm 2  on  the 
projected  row,  indicating  that  according  to  the  attack 
graph,  Alarm 2  follows  immediately  after  Alarm 1.    In 
this  case,  we  correlate  the  two  alarms  based  on  the 
likelihood that they are part of a coordinated attack. 
Figure  10  shows  another  intrusion  alarm  associated 
with  the  multi-step  reachability  matrix  from  Figure  6.  
This  time,  we  project  to  the  main  diagonal  in  each 
direction,  i.e.,  along  columns  and  rows,  to  explore 
forward and backward steps from this alarm.  In this way, 
we can predict the origin of the attack (from the backward 
direction) and the impact of the attack (from the forward 
direction).  Projecting along the row to the main diagonal, 
we  reach  a  column  that  has  non-zero  entries  only  within 
the  2nd  main-diagonal  block  (block  A2,2).    In  fact,  these 
non-zero  entries  are  all  of  unity  value,  indicating  that 
these  are  all  one-step  attacks.    In  other  words,  only  an 
attack from one of the machines in block A2,2 could have 
led  to  the  detected  intrusion,  and  that  could  have 
happened within one attack step. 
In Figure 10, when we project the detected intrusion 
to  the  main  diagonal  along  its  column,  the  row  of 
intersection  shows  all  possible  forward  steps  from  the 
detected event.  In this case, we see that machines in the 
2nd  block  cannot  be  reached  by  the  attacker,  since  block 
A3,2 is zero-valued.  For this reason, no attack response is 
necessary  for  defending  machines  in  these  columns.  
However, because block A3,1 shows reachability  within 2 
to 3 steps, measures might be taken to defend machines in 
these  columns,  although  not  at  the  highest  priority.    The 
highest priority should be for machines in the columns of 
block A3,3, because those machines are all reachable from 
the detected event within a single step. 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:12:28 UTC from IEEE Xplore.  Restrictions apply. 
4 missing
4 missing
4 missing
steps
steps
steps
No known paths
No known paths
No known paths
(likely false alarm)
(likely false alarm)
(likely false alarm)
Alarm 1
Alarm 1
Alarm 1
Alarm 2
Alarm 2
Alarm 2
¥
¥
¥
¥
s
s
s
s
p
p
p
p
e
e
e