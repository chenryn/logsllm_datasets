and agile DDoS defense framework that leverages the new
opportunities provided by programmable switches.
Programmable Switches. Researchers have looked at accel-
erating various applications in networking and distributed sys-
tems using programmable switches. Examples include layer-4
load balancing [51], [58], network resource allocation mech-
anisms [69], key-value stores [35], [48], coordination ser-
vices [34], [46], [47], fair queueing [70], fast connectivity re-
covery [32], network monitoring and measurement tasks [73],
[55], [74], [75], [30], [87]. These applications achieve far better
performance with lower costs than their software counterparts
that run on commodity servers. POSEIDON is inspired by these
works, but focuses on a different problem, DDoS defense, and
provides a systematic approach to integrating programmable
switches into the current DDoS defense framework.
Policy Languages. There are many domain-speciﬁc languages
in networking and security communities which aim to simplify
policy expression, such as Chimera [8], NetCore/NetKAT [2],
[65], [4], [25], [24], PSI [89]. Although our key idea of
software-deﬁned programmable security is not
tied to any
speciﬁc language,
to hide underlying hardware complexity
and reduce operator burden, we extend POSEIDON policy
language based on Pyretic NetCore [53], and provide a high-
level abstraction tailored for DDoS defenses.
XI. CONCLUSION
In this paper, we highlight the challenges for today’s DDoS
defense and identify new opportunities that programmable
switches bring for mitigating volumetric DDoS attacks. We
introduce POSEIDON, a performant, cost-efﬁcient and agile
DDoS defense system, which addresses the key limitations
in today’s DDoS defense. The POSEIDON language provides
a simple, modular DDoS policy abstraction that can sup-
port a range of policies, shielding the low-level hardware
complexity. The POSEIDON orchestration component provides
an optimized, efﬁcient resource orchestration mechanism to
map the high-level policy primitives to the underlying hard-
ware resources. The POSEIDON runtime manager provides a
transparent, effective scheme to adapt to the attack dynamics
while achieving resource utilization efﬁciency and guaran-
teeing correctness for legitimate ﬂows. Our implementation
and evaluation demonstrate that POSEIDON is highly effective
in attack mitigation, and only incurs negligible overheads.
These results show that POSEIDON is an effective system for
mitigating modern advanced DDoS attacks.
ACKNOWLEDGMENT
We thank our shepherd, William Enck, and the anonymous
NDSS reviewers for their valuable comments. We would also
like to thank Ennan Zhai and Yifei Yuan for their feedback
on the policy language, and Douglas Everson from Clemson
University for proofreading this paper. We also thank Xiao
Kong, Yi Qiao, Jiasong Bai, Zili Meng and Haixin Duan from
Tsinghua University, Lei Xu from Texas A&M University
and Palo Alto Networks, Kai Gao from Sichuan University,
Zhaogeng Li for Baidu Inc. for joining some discussions
on this paper. Menghao, Guanyu, Shicheng and Chang are
also sincerely grateful for their former Ph.D. advisor, Jun Bi
from Tsinghua University, for his strong support. This work
is supported in part by the National Key R&D Program of
China (2017YFB0801701), the National Science Foundation
of China (No. 61625203, No.61872426, No. 61832013, No.
61572278, U1736209), the BNRist Network and Software Se-
curity Research Program (No. BNR2019TD01004), ONR grant
14
N00014-20-1-2734, and the US National Science Foundation
(No. 1617985, No. 1642129, No. 1700544, No. 1740791, No.
1846291, No. 1700499, No. 1642143). Mingwei Xu and Qi Li
are the corresponding authors.
REFERENCES
[1] Y. Afek, A. Bremler-Barr, and L. Shaﬁr, “Network anti-spooﬁng with
SDN data plane,” in INFOCOM 2017-IEEE Conference on Computer
Communications, IEEE.
IEEE, 2017, pp. 1–9.
[2] C. J. Anderson, N. Foster, A. Guha, J.-B. Jeannin, D. Kozen,
C. Schlesinger, and D. Walker, “Netkat: Semantic foundations for
networks,” in ACM SIGPLAN Notices, vol. 49, no. 1. ACM, 2014,
pp. 113–126.
[3] M. Antonakakis, T. April, M. Bailey, M. Bernhard, E. Bursztein,
J. Cochran, Z. Durumeric, J. A. Halderman, L. Invernizzi, M. Kallitsis
et al., “Understanding the mirai botnet,” in USENIX Security Sympo-
sium, 2017, pp. 1092–1110.
[4] M. T. Arashloo, Y. Koral, M. Greenberg, J. Rexford, and D. Walker,
“Snap: Stateful network-wide abstractions for packet processing,” in
Proceedings of the 2016 ACM SIGCOMM Conference. ACM, 2016,
pp. 29–43.
[5] A. T. ARTICLES,
“5 most
famous DDoS attacks,” https://
www.a10networks.com/resources/articles/5-most-famous-ddos-attacks,
2018, [Online; accessed Aug. 19, 2019].
J. Bai, J. Bi, M. Zhang, and G. Li, “Filtering spoofed ip trafﬁc
using switching asics,” in Proceedings of the ACM SIGCOMM 2018
Conference on Posters and Demos. ACM, 2018, pp. 51–53.
[6]
[7] P. Barford, J. Kline, D. Plonka, and A. Ron, “A signal analysis of
network trafﬁc anomalies,” in Proceedings of the 2nd ACM SIGCOMM
Workshop on Internet measurment. ACM, 2002, pp. 71–82.
[8] K. Borders, J. Springer, and M. Burnside, “Chimera: A declarative
language for streaming network trafﬁc analysis.” in USENIX Security
Symposium, 2012, pp. 365–379.
[9] P. Bosshart, D. Daly, G. Gibb, M. Izzard, N. McKeown, J. Rexford,
C. Schlesinger, D. Talayco, A. Vahdat, G. Varghese et al., “P4: Pro-
gramming protocol-independent packet processors,” ACM SIGCOMM
Computer Communication Review, vol. 44, no. 3, pp. 87–95, 2014.
[10] P. Bosshart, G. Gibb, H.-S. Kim, G. Varghese, N. McKeown, M. Iz-
zard, F. Mujica, and M. Horowitz, “Forwarding metamorphosis: Fast
programmable match-action processing in hardware for SDN,” in ACM
SIGCOMM Computer Communication Review, vol. 43, no. 4. ACM,
2013, pp. 99–110.
[11] A. Business, “Distributed denial of service (ddos) defense,” https:
//www.business.att.com/products/ddos-protection.html, 2018, [Online;
accessed Aug. 13, 2019].
J. Cao, Q. Li, R. Xie, K. Sun, G. Gu, M. Xu, and Y. Yang, “The
crosspath attack: Disrupting the {SDN} control channel via shared
links,” in 28th USENIX Security Symposium (USENIX Security 19),
2019, pp. 19–36.
[12]
[13] O. Cetin, C. Gan´an, L. Altena, T. Kasama, D. Inoue, K. Tamiya, Y. Tie,
K. Yoshioka, and M. van Eeten, “Cleaning up the internet of evil things:
Real-world evidence on isp and consumer efforts to remove mirai,”
2019.
[14] Cisco,
https://www.cisco.com/c/en/
“Cisco
5650,”
guard
xt
us/products/collateral/security/guard-xt-5650a/product data
sheet0900aecd800fa55e.html, 2018, [Online; accessed Jul. 8, 2019].
[15] A. Cloud, “Anti-ddos basic,” https://www.alibabacloud.com/products/
ddosdip, 2018, [Online; accessed Jul. 19, 2019].
[16] T. Cloud, “Dayu anti-ddos,” https://intl.cloud.tencent.com/product/bad,
2018, [Online; accessed Aug. 19, 2019].
[17] Corero, “The evolution of ddos protection,” http://info.corero.com/the-
evolution-of-ddos-protection.html, 2018, [Online; accessed Jun. 19,
2018].
[18] G. Cormode and S. Muthukrishnan, “An improved data stream sum-
mary: the count-min sketch and its applications,” Journal of Algorithms,
vol. 55, no. 1, pp. 58–75, 2005.
I. DPDK,
www.dpdk.org/, 2017, [Online; accessed Jun. 13, 2019].
involved with dpdk,” https://
“Learn how to get
[19]
[20] Engadget, “New dos attack exploits algorithms to knock sites ofﬂine,”
https://www.engadget.com/2019/08/09/new-ddos-attack-algorithms/,
2019, [Online; accessed Aug. 19, 2019].
[21] Epsylon, “Ufonet - denial of service toolkit,” https://ufonet.03c8.net,
2019, [Online; accessed Aug. 19, 2019].
[22] S. K. Fayaz, Y. Tobioka, V. Sekar, and M. Bailey, “Bohatei: Flexible
and elastic DDoS defense.” in USENIX Security Symposium, 2015, pp.
817–832.
[23] C. I. for Cybersecurity, “A realistic cyber defense dataset,” https:
//www.unb.ca/cic/datasets/ids-2018.html, 2019, [Online; accessed Aug.
19, 2019].
[24] N. Foster, R. Harrison, M. J. Freedman, C. Monsanto, J. Rexford,
A. Story, and D. Walker, “Frenetic: A network programming language,”
ACM Sigplan Notices, vol. 46, no. 9, pp. 279–291, 2011.
[25] N. Foster, D. Kozen, K. Mamouras, M. Reitblatt, and A. Silva, “Prob-
abilistic netkat,” in European Symposium on Programming Languages
and Systems. Springer, 2016, pp. 282–309.
[26] R. Gandhi, H. H. Liu, Y. C. Hu, G. Lu, J. Padhye, L. Yuan, and
M. Zhang, “Duet: Cloud scale load balancing with hardware and
software,” ACM SIGCOMM Computer Communication Review, vol. 44,
no. 4, pp. 27–38, 2015.
[27] S. Ganguly, M. Garofalakis, R. Rastogi, and K. Sabnani, “Streaming
algorithms for robust, real-time detection of ddos attacks,” in 27th In-
ternational Conference on Distributed Computing Systems (ICDCS’07).
IEEE, 2007, pp. 4–4.
[28] P. X. Gao, A. Narayan, S. Karandikar, J. Carreira, S. Han, R. Agarwal,
S. Ratnasamy, and S. Shenker, “Network requirements for resource
disaggregation.” in OSDI, vol. 16, 2016, pp. 249–264.
[29] A. Gember-Jacobson, R. Viswanathan, C. Prakash, R. Grandl, J. Khalid,
S. Das, and A. Akella, “Opennf: Enabling innovation in network func-
tion control,” in ACM SIGCOMM Computer Communication Review,
vol. 44, no. 4. ACM, 2014, pp. 163–174.
[30] A. Gupta, R. Harrison, M. Canini, N. Feamster, J. Rexford, and
W. Willinger, “Sonata: query-driven streaming network telemetry,” in
Proceedings of the 2018 Conference of the ACM Special Interest Group
on Data Communication. ACM, 2018, pp. 357–371.
[31] Gurobi, “The fastest mathematical programming solver,” http://
www.gurobi.com/, 2019, [Online; accessed Jun. 19, 2019].
[32] T. Holterbach, E. C. Molero, M. Apostolaki, A. Dainotti, S. Vissicchio,
and L. Vanbever, “Blink: Fast connectivity recovery entirely in the data
plane,” in 16th USENIX Symposium on Networked Systems Design and
Implementation (NSDI 19), 2019, pp. 161–176.
[33] S. Jero, W. Koch, R. Skowyra, H. Okhravi, C. Nita-Rotaru, and
D. Bigelow, “Identiﬁer binding attacks and defenses in software-deﬁned
networks,” in 26th USENIX Security Symposium (USENIX Security 17),
2017, pp. 415–432.
[34] X. Jin, X. Li, H. Zhang, N. Foster, J. Lee, R. Soul´e, C. Kim, and
I. Stoica, “Netchain: Scale-free sub-rtt coordination,” in 15th USENIX
Symposium on Networked Systems Design and Implementation (NSDI
18). USENIX Association, 2018.
[35] X. Jin, X. Li, H. Zhang, R. Soul´e, J. Lee, N. Foster, C. Kim, and
I. Stoica, “Netcache: Balancing key-value stores with fast in-network
caching,” in Proceedings of the 26th Symposium on Operating Systems
Principles. ACM, 2017, pp. 121–136.
[36] L. Jose, L. Yan, G. Varghese, and N. McKeown, “Compiling packet
programs to reconﬁgurable switches.” in NSDI, 2015, pp. 103–115.
[37] A. Juels and J. G. Brainard, “Client puzzles: A cryptographic counter-
measure against connection depletion attacks.” in NDSS, vol. 99, 1999,
pp. 151–165.
[38] S. Kandula, D. Katabi, M. Jacob, and A. Berger, “Botz-4-sale: Surviving
organized DDoS attacks that mimic ﬂash crowds,” in Proceedings of
the 2nd conference on Symposium on Networked Systems Design &
Implementation-Volume 2. USENIX Association, 2005, pp. 287–300.
[39] M. S. Kang, V. D. Gligor, and V. Sekar, “SPIFFY: Inducing cost-
detectability tradeoffs for persistent link-ﬂooding attacks.” in NDSS,
2016.
[40] M. S. Kang, S. B. Lee, and V. D. Gligor, “The crossﬁre attack,” in
IEEE, 2013,
Security and Privacy (SP), 2013 IEEE Symposium on.
pp. 127–141.
15
[41]
J. Khalid, A. Gember-Jacobson, R. Michael, A. Abhashkumar, and
A. Akella, “Paving the way for nfv: Simplifying middlebox modiﬁ-
cations using statealyzr.” in NSDI, 2016, pp. 239–253.
[42] D. Kim, Y. Zhu, C. Kim, J. Lee, and S. Seshan, “Generic external
memory for switch data planes,” in Proceedings of the 17th ACM
Workshop on Hot Topics in Networks. ACM, 2018, pp. 1–7.
[43] R. R. Kompella, S. Singh, and G. Varghese, “On scalable attack
detection in the network,” in Proceedings of the 4th ACM SIGCOMM
conference on Internet measurement. ACM, 2004, pp. 187–200.
[44] G. Li, M. Zhang, C. Liu, X. Kong, A. Chen, G. Gu, and H. Duan,
“Nethcf: Enabling line-rate and adaptive spoofed ip trafﬁc ﬁltering,” in
ICNP.
IEEE, 2019.
[46]
[45] H. Li, H. Hu, G. Gu, G.-J. Ahn, and F. Zhang, “vNIDS: Towards elastic
security with safe and efﬁcient virtualization of network intrusion de-
tection systems,” in Proceedings of the 2018 ACM SIGSAC Conference
on Computer and Communications Security. ACM, 2018, pp. 17–34.
J. Li, E. Michael, and D. R. Ports, “Eris: Coordination-free consistent
transactions using in-network concurrency control,” in Proceedings of
the 26th Symposium on Operating Systems Principles. ACM, 2017,
pp. 104–120.
J. Li, E. Michael, N. K. Sharma, A. Szekeres, and D. R. Ports, “Just say
no to paxos overhead: Replacing consensus with network ordering.” in
OSDI, 2016, pp. 467–483.
[47]
[48] M. Liu, L. Luo, J. Nelson, L. Ceze, A. Krishnamurthy, and K. Atreya,
“Incbricks: Toward in-network computation with an in-network cache,”
ACM SIGOPS Operating Systems Review, vol. 51, no. 2, pp. 795–809,
2017.
[49] Z. Liu, A. Manousis, G. Vorsanger, V. Sekar, and V. Braverman, “One
sketch to rule them all: Rethinking network ﬂow monitoring with
univmon,” in Proceedings of the 2016 ACM SIGCOMM Conference.
ACM, 2016, pp. 101–114.
[50] A. Mahimkar, J. Dange, V. Shmatikov, H. M. Vin, and Y. Zhang,
“dfence: Transparent network-based denial of service mitigation.” in
NSDI, vol. 7, 2007, pp. 327–340.
[51] R. Miao, H. Zeng, C. Kim, J. Lee, and M. Yu, “Silkroad: Making
stateful layer-4 load balancing fast and cheap using switching asics,” in
Proceedings of the Conference of the ACM Special Interest Group on
Data Communication. ACM, 2017, pp. 15–28.
J. Mirkovic and P. Reiher, “A taxonomy of DDoS attack and DDoS
defense mechanisms,” ACM SIGCOMM Computer Communication Re-
view, vol. 34, no. 2, pp. 39–53, 2004.
[52]
[53] C. Monsanto, J. Reich, N. Foster, J. Rexford, D. Walker et al.,
“Composing software deﬁned networks.” in NSDI, vol. 13, 2013, pp.
1–13.
[54] S. Moss, “Major DDoS attack on dyn disrupts aws, twitter, spotify and
more,”
http://www.datacenterdynamics.com/content-tracks/security-
risk/major-ddos-attack-on-dyn-disrupts-aws-twitter-spotify-and-more/
97176.fullarticle, 2016, [Online; accessed Jul. 15, 2018].
[55] S. Narayana, A. Sivaraman, V. Nathan, P. Goyal, V. Arun, M. Alizadeh,
V. Jeyakumar, and C. Kim, “Language-directed hardware design for
network performance monitoring,” in Proceedings of the Conference of
the ACM Special Interest Group on Data Communication. ACM, 2017,
pp. 85–98.
[56] B. Networks, “Toﬁno: World’s fastest p4-programmable ethernet switch
asics,” https://barefootnetworks.com/products/brief-toﬁno/, 2017, [On-
line; accessed Jun. 13, 2019].
[57] NSFOCUS, “Nsfocus anti ddos solution,” https://nsfocusglobal.com/
wp-content/uploads/2018/05/Anti-DDoS-Solution.pdf, 2018, [Online;
accessed Jul. 8, 2019].
[58] V. Olteanu, A. Agache, A. Voinescu, and C. Raiciu, “Stateless data-
center load-balancing with beamer,” in 15th USENIX Symposium on
Networked Systems Design and Implementation (NSDI), vol. 18, 2018,
pp. 125–139.
[59] D. Pauli, “Chinese gambling site served near record-breaking complex
DDoS,” https://www.dailydot.com/debug/lizard-squad-hackers/, 2016,
[Online; accessed Jul. 15, 2019].
“Mawi working
[60] W.
archive,”
Project,
trafﬁc
group
http:
//mawi.wide.ad.jp/mawi/, 2019, [Online; accessed Aug. 19, 2019].
[61] S. Ramanathan, J. Mirkovic, M. Yu, and Y. Zhang, “SENSS against
16
volumetric DDoS attacks,” in Proceedings of the 34th Annual Computer
Security Applications Conference. ACM, 2018, pp. 266–277.
[62] R. Rasti, M. Murthy, N. Weaver, and V. Paxson, “Temporal lensing
and its application in pulsing denial-of-service attacks,” in Security and
Privacy (SP), 2015 IEEE Symposium on.
IEEE, 2015, pp. 187–198.
increased 91% in 2017 thanks
to iot,” https://www.techrepublic.com/article/ddos-attacks-increased-
91-in-2017-thanks-to-iot/, 2018, [Online; accessed Jul. 23, 2019].
[63] A. D. Rayome, “Ddos attacks
[64] C. Rossow, “Ampliﬁcation hell: Revisiting network protocols for DDoS
abuse,” in NDSS, 2014.
[65] C. Schlesinger, M. Greenberg, and D. Walker, “Concurrent NetCore:
From policies to pipelines,” in ACM SIGPLAN Notices, vol. 49, no. 9.
ACM, 2014, pp. 11–24.
[66] A. Scroxton, “Dyn reveals details of complex and sophisticated iot bot-
net attack,” https://www.computerweekly.com/news/450401857/Dyn-
reveals-details-of-complex-and-sophisticated-IoT-botnet-attack, 2016,
[Online; accessed Jul. 15, 2018].
[67] C. Security,
“Ddos
and trends,”
https://www.calyptix.com/top-threats/ddos-attacks-2018-new-records-
and-trends/, 2019, [Online; accessed Mar. 19, 2019].
attacks 2018: New records
[68] H. Shan, Q. Wang, and C. Pu, “Tail attacks on web applications,” in
Proceedings of the 2017 ACM SIGSAC Conference on Computer and
Communications Security. ACM, 2017, pp. 1725–1739.
[69] N. K. Sharma, A. Kaufmann, T. E. Anderson, A. Krishnamurthy,
J. Nelson, and S. Peter, “Evaluating the power of ﬂexible packet
processing for network resource allocation.” in NSDI, 2017, pp. 67–
82.
[70] N. K. Sharma, M. Liu, K. Atreya, and A. Krishnamurthy, “Approximat-
ing fair queueing on reconﬁgurable switches,” in USENIX Symposium
on Networked Systems Design and Implementation, 2018.
[71] S. Shin, V. Yegneswaran, P. Porras, and G. Gu, “Avant-guard: Scalable
and vigilant switch ﬂow management in software-deﬁned networks,”
in Proceedings of the 2013 ACM SIGSAC conference on Computer &
communications security. ACM, 2013, pp. 413–424.