40
41
42
43
41
40
41
40.3
2.06
21
21
21
21
22
23
23
23
22
24
22
22
22.1
0.996
0.793
3.1  Removing high variance (unusable) data
We  want  to  remove  high  variance.    Based  on  the
normal  distribution  assumption  of  the  time  intervals,  we
develop  a  quantitative  method  for  the  exclusion  of  high
variance data.  We use three steps:  remove high variance
cases,    exclude  data  for  high  variance  system  calls,  and
mark unusable clusters.
3.1.1 Removing high variance cases.    First, we remove
high variance cases. Consider case 11 that has the single
divergent  time  measure  associated  with  seteuid      that
varies  greatly  from  the  mean.    Based  on  the  normal
distribution  assumption  of  time  intervals,  the  probability
of high variance time intervals is low, therefore to remove
the high variance value, we exclude the entire case 11 so
that it does not contribute to the cluster summary.
   To determine criteria for excluding such data, we use a
common notation for the variance of each interval, called
the  z-score  [13].  It  is  the  number  of  standard  deviations
that an interval is from its corresponding mean. Let ti, mi,
and  si  represent  the  time  interval,  mean,  and  standard
deviation of the ith system call.  Then the z-score can be
expressed as:
zi = (ti-mi)/si
The z-score is a balanced and normalized time interval.
It  will  satisfy  the  standard  normal  distribution,  which  is
the normal distribution with a mean of zero and standard
there 
deviation  of  one.  The  z-scores  can  thus  be  compared  to
each  other.  Furthermore,  given  a  certain  probability
criteria  of  being  normal  or  abnormal, 
is  a
corresponding value, which can be compared with the z-
scores. For example, if we regard all data that will appear
with  probability  less  than  5%  as  abnormal,  then  we  can
compare  the  z-score  with  2.33  which  is  the  maximum
permitted z value with 5% abnormal cases. If the z-score
of a time interval is larger than 2.33, it will be regarded as
abnormal. Because the time intervals within one case are
related  to  each  other,  whenever  one  time  interval  is
excluded, the whole case will be excluded.
Table 3 shows the mean vector, the standard deviation
vector  and  the  max  z-score  for  each  case.  The  gray  cell
(for seteuid case 11) is unusable data (because the z-score
z  is  large)  and  case  11  will  be  removed  in  the  next
iteration.
Table 3. Given mean m and standard deviation s,
each interval in a column has a corresponding z-
score, which is supposed to satisfy the standard
normal distribution.
System
interval  calls
sequence
open
fstat
seteuid
socket
setsockop
bind
z
Case 1
Case 2
Case 3
Case 4
Case 5
Case 6
Case 7
Case 8
  Case 9
    Case 10
    Case 11
    Case 12
m
s
108
84
84
84
116
85
87
87
 114
83
 120
98
95.8
24
23
23
24
25
23
25
24
24
23
24
23
23.8
14.6
0.75
22
23
23
22
23
23
23
24
23
23
50
23
25.2
7.84
43
37
37
38
41
40
41
42
43
41
40
41
40.3
2.06
21
21
21
21
22
23
23
23
   22
   24
   22
   22
22.1
27
27
27
27
28
28
29
29
 28
 27
 27
 27
27.6
1.29
1.62
1.62
1.13
1.66
0.99
1.79
1.79
   1.29
   1.92
3.17
0.99
0
0.996
0.793
N/a
The mean and standard deviation for each column will
change after exclusions are made. So, m s and z-score are
recalculated. It is possible that this recalculation will need
to be performed several times because additional intervals
might satisfy the criteria of high variance intervals. Such
exclusions should be performed iteratively, until no case
is to be excluded. Typically, two or three iterations will be
sufficient to exclude all the high variance cases. In our
example, one iteration is sufficient.
3.1.2  Excluding  data  of  high  variance  system  calls.
After excluding high variance cases the possibility of high
4
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:06:42 UTC from IEEE Xplore.  Restrictions apply. 
variance  systems  call  data  should  be  considered.  The
standard deviation of the open column in Table 3 remains
high.  Again,  I/O  (disk  access)  is  typically  the  source  of
high variance (columns). Network operations and, in rare
cases,  code  algorithms  may  exhibit  high  variance.
(Timing  of  such  system  calls  should  not  be  used  as  the
basis of the comparison because their high  variance.) So
we remove the timing values of such system calls entirely
from the cluster summary.
Although we do not want the high variance timing data
to  contribute  to  the  cluster  summary,  we  do  not  remove
the system call, open, from the title in order to maintain a
single sequence length for all clusters.
   Because  experimental  data  shows  that  the  standard
deviation is usually  higher  when  the  mean  is  higher,  we
compute  a  normalized  standard  deviation.  We  define  Cs
to be a threshold that s/m cannot exceed. Cs is called the
criteria  of  high  variance  system  calls.  Any  system  call
with normalized standard deviation larger than Cs will be
regarded  as  a  high  variance  system  call.  This  model  is
experimentally  based  and  Cs  is  an  adjustable  parameter.
Typically, Cs takes a value in the range of .1 to .3 based
on experimental observation.
   Table 4 shows the final values for m’, s’, s’/m’, and z-
score after all the high variance cases have been removed.
The column for open in Table 4 has been shaded gray to
show  a  high  variance  system  call  values  that  will  be
elided.
Table 4. High variance case 11 has been removed.
m, s, s/m are recomputed.
System
interval
calls
sequence
Case1
Case 2
Case 3
Case 4
Case 5
Case 6
Case 7
Case 8
Case 9
 Case 10
Case12
m΄
s΄
fstat
seteuid
socket setsockopt bind
open
108    24
23
84
84
23
24
84
25
116
23
 85
 87
25
24
 87
24
114
23
 83
98
23
23.7
93.6
 22
23
23
22
23
23
23
24
23
23
23
22.9
13.02 0.786 0.539
 43
37
37
38
41
40
41
42
43
41
41
40.4
2.16
    21
21
21
21
22
23
23
23
22
24
22
22.1
27
27
27
27
28
28
29
29
28
27
27
27.6
1.044 0.809
s΄/m΄
0.139 0.033 0.024
0.053
0.047 0.029
z΄
1.69
1.56
1.69
1.69
1.62
0.92
1.69
2.02
1.22
1.83
0.92
0
n/a
n/a
Using  Cs  as  a  criterion  is  a  simple  method  for
determining  what  system  call  time  measures  to  exclude.
There  are  more  formal  and  strict  statistical  methods  to
check  whether  the  distribution  of  a  sample  is  a  normal
distribution  or  not,  for  example,  using  the  equation
W=Σ(tj-m)2/n  which observes  the  chi-square  distribution.
We  did  not  use  this  approach,  however,  because  our
model  does  not  satisfy  all  the  assumptions  required  to
apply  such  methods.  Instead  of  the  strict  methods,  we
used the relatively simple model and empirical criteria.
The  exclusion  of  the  timing  information  of  high
variance  system  calls  will  not  affect  the  calculation  of
mean and deviation for other system calls, so they do not
need to be recalculated. Note that the high variance cases
must  be  excluded  before  the  exclusion  of  high  variance
system calls. If we exclude the high variance system calls
first,  those  columns  with  just  one  or  several  abnormal
time  intervals  in  the  columns  will  be  excluded  as  high
variance  system  calls,  while  typically  such  columns  are
still usable.
3.1.3  Mark  unusable  clusters.    Our  experiments  have
shown that typically, only a small percentage of the total
cases  and  system  calls  are  excluded.  However,  it  is
necessary  to  check  whether  exclusions  have  made  the
whole cluster unusable because of insufficient valid data.
    We define the percentage of valid cases for a cluster to
be cluster Pv, i.e. the percentage of cases remaining after
high variance cases are excluded. We can also compute a
similar Pv value for an entire database or for a comparison