### Title: BlackHat US-21: A New Class of DNS Vulnerabilities Affecting Multiple DNS-as-a-Service Platforms

We present a novel class of DNS vulnerabilities that affect multiple DNS-as-a-Service (DNSaaS) providers. These vulnerabilities have been confirmed and successfully exploited on three major cloud providers, including AWS Route 53, and may potentially impact many others. Successful exploitation of these vulnerabilities can lead to the exfiltration of sensitive information from customers' corporate networks. The leaked information includes internal and external IP addresses, computer names, and, in some cases, NTLM or Kerberos tickets.

The root cause of these vulnerabilities is the non-standard implementation of DNS resolvers, which, when combined with specific unintended edge cases on the DNS service provider's side, result in significant information leakage from internal corporate networks. In this research, we detail a specific vulnerability that is common across many major DNS service providers, leading to information leakage in connected corporate networks. Specifically, we demonstrate how Microsoft Windows endpoints reveal sensitive customer information when performing DNS update queries.

The security risk associated with this vulnerability is high. If an organization's DNS updates are leaked to a malicious third party, they can provide sensitive network information that can be used to map the organization and facilitate operational goals. Internal IP addresses reveal the network segments within the organization; computer names can hint at the potential content they may hold; external IP addresses expose geographical locations and the organization's sites worldwide; and internal IPv6 addresses, which are sometimes accessible from the outside, can provide an entry point into the organization.

The impact of this vulnerability is significant. Out of six major DNSaaS providers we examined, three were found to be vulnerable to nameserver registration. Any cloud provider, domain registrar, or website host that offers DNSaaS could be at risk. The number of organizations vulnerable to this weakness is alarming. Over a few hours of DNS sniffing, we observed DNS updates from 992,597 Windows endpoints belonging to approximately 15,000 potentially vulnerable companies, including 15 Fortune 500 companies. In some organizations, more than 20,000 endpoints were actively leaking their information.

Exploiting this vulnerability is relatively straightforward. A single attacker with a single cloud account can gather information on thousands of organizations in one step. There are several possible mitigations for this issue, which we will review for both DNSaaS providers and managed networks.