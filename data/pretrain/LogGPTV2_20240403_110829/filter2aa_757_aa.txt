[SensePost – 2009]
Click to edit Master subtitle style
 8/21/09
Clobbering the Cloud!
{ haroon | marco | nick }
@sensepost.com
[SensePost – 2009]
 8/21/09
about: us
 {Nicholas Arvanitis | Marco Slaviero | Haroon Meer}
[SensePost – 2009]
 8/21/09
Why this talk ?
[SensePost – 2009]
 8/21/09
This is not the time to split hairs
[SensePost – 2009]
 8/21/09
The LOUD in cLOUD security..
• A bunch of people are talking about “the 
cloud”
• There are large numbers of people who 
are immediately down on it:
• “There is nothing new here”
• “Same old, Same old”
• If we stand around splitting hairs, we risk 
missing something important..
[SensePost – 2009]
 8/21/09
So, what 
exactly *is* 
the Cloud?
[SensePost – 2009]
 8/21/09
Cloud delivery models
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Why would we want to break 
it?
• It will be where the action is..
• Insidious the dark side is..
• Amazingly we are making some of the 
same old mistakes all over again
• We really don’t have to..
[SensePost – 2009]
 8/21/09
What is driving Cloud 
adoption?
• Management by in-flight magazine
– Manager Version
– Geek Version
• Poor history from IT
• Economy is down
– Cost saving becomes more attractive
– Cloud computing allows you to move from 
CAPEX to OPEX
– (Private Clouds?)
[SensePost – 2009]
 8/21/09
A really attractive option
• EC2 is Cool!
• Like Crack..
[SensePost – 2009]
 8/21/09
Problems testing 
the Cloud
[SensePost – 2009]
 8/21/09
Transparency
[SensePost – 2009]
 8/21/09
Compliance in the Cloud
“If its non-regulated data, go ahead and 
explore. If it is regulated, hold on. I have not 
run across anyone comfortable putting 
sensitive/regulated data in the cloud”
“doesn’t seem to be there as far as comfort 
level that security and audit aspects of that 
will stand up to scrutiny” (sic)
--Tim Mather: RSA Security Strategist 
[SensePost – 2009]
 8/21/09
Privacy and 
legal issues
[SensePost – 2009]
 8/21/09
Privacy
• Jim Dempsey (Center for Democracy and 
Technology): “Loss of 4th Amendment 
protection for US companies”
• A legal order (court) to serve data, can be 
used to obtain your data without any 
notification being served to you
• There is no legal obligation to even inform 
you it has been given
[SensePost – 2009]
 8/21/09
Simple solution..
Crypto Pixie Dust!
Would you trust crypto on an owned box ?
[SensePost – 2009]
 8/21/09
Vendor Lock-in
• Pretty self-explanatory
• If your relationship dies, how do you get 
access to your data ?
• Is it even your data ?
[SensePost – 2009]
 8/21/09
Availability [Big guys fail 
too?]
[SensePost – 2009]
 8/21/09
Availability [Not Just Uptime!]
[SensePost – 2009]
 8/21/09
Availability [not just uptime!]
• Account Lockout?
• “Malicious activity from your account”
[SensePost – 2009]
 8/21/09
Monoculture
[SensePost – 2009]
 8/21/09
Monoculture
• MonocultureGate is well known in our 
circles.
• Just viewing that pic resulted in a raised 
average IQ in this room.
• His (their) thesis:
“ A monoculture of networked computers is a 
convenient and susceptible reservoir of platforms 
from which to launch attacks; these attacks can 
and do cascade. ”
• Most people agreed with Dr Geer (et al) 
back then..
[SensePost – 2009]
 8/21/09
SmugMug Case Study
• Process 50+ terapixels per day
• Posterchild of AWS
• Heavy use of S3 and EC2
• Launched 1920 standard instances in one 
call
• You don’t get monoculture’er than ~2000 
machines that are all copies of the same 
image..
• ASLR Fail .. ?
[SensePost – 2009]
 8/21/09
Extending 
your attack 
surface
[SensePost – 2009]
 8/21/09
While we’re 
talking 
about 
phishing…
[SensePost – 2009]
 8/21/09
Trust…
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Cloud #fail
• MediaMax Online Storage – inactive 
account purging script error whacked 
active customer accounts
• Nokia Ovi (like MobileMe) lost 3 weeks of 
customer data after crash
• Jan 2009 – SF.com customers couldn’t log 
in – “core network device failed with 
memory allocation errors”
[SensePost – 2009]
 8/21/09
But you have to trust 
someone!
 kostyas cloudbreak stuff really 
scares me
 its impressive for sure, but why 
would that scare you more than simple 
Amazon evilness ? (Malfeasance)
 You have to trust someone.. Just 
like how you trust Microsoft not to backdoor 
your OS, you trust Amazon not to screw you
[SensePost – 2009]
 8/21/09
Red Herring Alert!
[SensePost – 2009]
 8/21/09
Complete the popular phrase.
• Trust, but …………… !
• Reverse Engineers keep Microsoft honest
• (or at least raise the cost of possibly 
effective malfeasance)
• Even “pre-owned” hardware is relatively 
easy to spot (for some definition of easy)
• But how do we know that Amazon (or 
other big names) “Wont be evil”™ 
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Web Application 
Security
[SensePost – 2009]
 8/21/09
Using the Cloud..
For hax0r fun and profit:
– Dino Dai Zovi vs. Debian
– Ben Nagy vs. MS Office
– Dmolnar && Zynamics
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
DDZ vs Debian
1. Populate a distributed queue with 
strings describing which keys to 
generate
2.  Launch 20 VMs (the default limit) 
3. Fetch key descriptors from queue, 
generate batches of keys, and store 
in S3 
524,288 RSA keys – 6 Hours - $16
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Zynamics && DMolnar
• Zynamics use EC2 to demo software and 
classify malware, upto ~50k samples/day
• David Molnar and friends fuzztest Linux 
binaries, sift results and notify devs, all on 
EC2
[SensePost – 2009]
 8/21/09
Some of the players
[SensePost – 2009]
 8/21/09
The ones we looked at…
[SensePost – 2009]
 8/21/09
Autoscaling / Usage costing
• Autoscaling is a great idea for companies.
[SensePost – 2009]
 8/21/09
Can you spot the 
danger?
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Storage as a Service
• In most cases this is a really simple model
• Faster Internet tubes is making backing up 
over tubes reasonable
• Disk access anywhere is a nice idea
• All throw crypto-pixieDust-magic words in 
their marketing documents
• For good measure all throw in Web based 
GUI access
[SensePost – 2009]
 8/21/09
Web Apps
+
File Systems
[SensePost – 2009]
 8/21/09
Amazon EC2 
Secure Wiping
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
• file:///Users/haroon/Desktop/Vegas_Video/sug
• Overview of sugarsync + normal password 
reset
• Ends with sample link..
[SensePost – 2009]
 8/21/09
Its Short, Brute & Declare Victory
?secret= for472gtb422
= lower case alphanumeric
= 35^12
= Still a too big number 
Birthday Attack ?
= 1.2 * sqrt(35^12)
= Still a pretty big number
[SensePost – 2009]
 8/21/09
https://www.sugarsync.com/reset-password?secret=dk0tot820d7vs
https://www.sugarsync.com/reset-password?secret=b6bip7pswf9m2
https://www.sugarsync.com/reset-password?secret=bx424nj2p2y9e
https://www.sugarsync.com/reset-password?secret=bz6to064jf3qp
https://www.sugarsync.com/reset-password?secret=ebgbgprc6eq2f
https://www.sugarsync.com/reset-password?secret=modziars6o2d
https://www.sugarsync.com/reset-password?secret=wi3vkonsia3
https://www.sugarsync.com/reset-password?secret=cmbicqc34apjf
https://www.sugarsync.com/reset-password?secret=e2fqw2kogy8gc
https://www.sugarsync.com/reset-password?secret=fkno8o8ws7th
https://www.sugarsync.com/reset-password?secret=8g8jfig0m8hk
https://www.sugarsync.com/reset-password?secret=ea760dof3zpve
https://www.sugarsync.com/reset-password?secret=dr8rsap8ieinv
https://www.sugarsync.com/reset-password?secret=d3hmdc3srnyng
https://www.sugarsync.com/reset-password?secret=dcnckpph35vko
https://www.sugarsync.com/reset-password?secret=ejr0k3ro4nepm
https://www.sugarsync.com/reset-password?secret=etcasjbo2sa9k
https://www.sugarsync.com/reset-password?secret=e0ijravm5awrf
https://www.sugarsync.com/reset-password?secret=bbjb3rabpngha
https://www.sugarsync.com/reset-password?secret=di8qwc355270y
https://www.sugarsync.com/reset-password?secret=cm5esewps28y2
https://www.sugarsync.com/reset-password?secret=mofph975924
https://www.sugarsync.com/reset-password?secret=b5eptnaefja5f
https://www.sugarsync.com/reset-password?secret=dqshjvg8pyyxn
https://www.sugarsync.com/reset-password?secret=byjd3bwq39rgi
https://www.sugarsync.com/reset-password?secret=di4wgdecj2ci0
https://www.sugarsync.com/reset-password?secret=ebiyxam7cextk
https://www.sugarsync.com/reset-password?secret=emxscrt769hi
https://www.sugarsync.com/reset-password?secret=ein2b5gwj4vpx
https://www.sugarsync.com/reset-password?secret=c485kmqj7jcvo
https://www.sugarsync.com/reset-password?secret=x83hrq5zgkfc
https://www.sugarsync.com/reset-password?secret=ejrdyyr02pxcz
https://www.sugarsync.com/reset-password?secret=dnacznkenc57z
https://www.sugarsync.com/reset-password?secret=emmiagm6b55ig
https://www.sugarsync.com/reset-password?secret=ca3xztf6pj44i
https://www.sugarsync.com/reset-password?secret=dqmejm2dfq8jb
https://www.sugarsync.com/reset-password?secret=c9879b9oqzbzj
https://www.sugarsync.com/reset-password?secret=d9vc00wo09mc0
https://www.sugarsync.com/reset-password?secret=e9ghwgdt5eze6
https://www.sugarsync.com/reset-password?secret=cgk799cwjgmaa
https://www.sugarsync.com/reset-password?secret=6pz2nk4sdr20
https://www.sugarsync.com/reset-password?secret=6076kgbni87b
https://www.sugarsync.com/reset-password?secret=bt45nq32gvzc9
https://www.sugarsync.com/reset-password?secret=fk0c79goxbzwb
https://www.sugarsync.com/reset-password?secret=bzx5gor7yaj45
https://www.sugarsync.com/reset-password?secret=b9xhfaitwok6a
https://www.sugarsync.com/reset-password?secret=evifc5cvd79aw
https://www.sugarsync.com/reset-password?secret=d7q7mba80hpqs
https://www.sugarsync.com/reset-password?secret=ds3a27qdpyoym
https://www.sugarsync.com/reset-password?secret=bms9kxwp2ypeq
https://www.sugarsync.com/reset-password?secret=xi3pzry9s7kz
https://www.sugarsync.com/reset-password?secret=cs3pd8tyenedp
https://www.sugarsync.com/reset-password?secret=dmmzgfgvyqw72
https://www.sugarsync.com/reset-password?secret=cw8jqev4yvv0w
https://www.sugarsync.com/reset-password?secret=edp9iog7fj60r
https://www.sugarsync.com/reset-password?secret=cxom0z2a62iva
https://www.sugarsync.com/reset-password?secret=bv45tsonz8tdi
https://www.sugarsync.com/reset-password?secret=cv7z95jyctnd5
https://www.sugarsync.com/reset-password?secret=cq2j8wdbbo7om
https://www.sugarsync.com/reset-password?secret=bmtjn6j3hteky
https://www.sugarsync.com/reset-password?secret=fjrofysj887bf
https://www.sugarsync.com/reset-password?secret=de4acew6hsn4s
https://www.sugarsync.com/reset-password?secret=fdie4jk2jy56c
[SensePost – 2009]
 8/21/09
We Have 2 Days..
single thread
: 1 hour :
648
: 2 days : 31104
10 threads
:
:
221472
10 machines
:
:
2 214 720
Wont they notice ?
[SensePost – 2009]
 8/21/09
[SensePost – 2009]
 8/21/09
Saved (some pride)
[sugarsync vids]
[SensePost – 2009]
 8/21/09
PaaS
[SensePost – 2009]
 8/21/09
Actually..
• SF.com is both SaaS and PaaS
• We took a quick look at SaaS
• Good filtering, and held up well to cursory 
testing
• Why cursory?
• Ultimately, it *is* a web application..
[SensePost – 2009]
 8/21/09
Clickjack
[clickjack vid]
[SensePost – 2009]
 8/21/09
SalesForce back story
• 10 years old
• Initially web-based CRM software
– 59 000 customers
– $1 billion in revenue
• Distributed infrastructure was created to 
support CRM (SaaS, weeeee!)
• Platform was exposed to architects and 
devs, for PaaS and IaaS
– (Ambitious project with solid aims)
[SensePost – 2009]
 8/21/09
Salesforce business model