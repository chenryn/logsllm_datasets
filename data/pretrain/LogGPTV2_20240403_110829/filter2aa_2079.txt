Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Adversarial 
Machine Learning 
And Several 
Countermeasures 
Trend Micro 
ch0upi 
miaoski 
7 Dec 2017 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
ch0upi 
â€¢
Staff engineer in Trend Micro 
â€¢
Machine Learning + Data Analysis 
â€¢
Threat intelligence services 
â€¢
NIPS 
â€¢
KDDCup 2014 + KDDCup 2016: Top10 
â€¢
GoTrend: 6th in UEC Cup 2015 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
miaoski 
â€¢
Senior threat researcher in Trend Micro 
â€¢
Threat intelligence 
â€¢
Smart City 
â€¢
SDR 
â€¢
Arduino + RPi makers 
â€¢
çŒ«å¥´ 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
4 
Outline 
â€¢
Cheating machine learning? 
â€¢
Attacking theories and practices 
â€¢
Countermeasures 
â€¢
Conclusion 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
CHEAT 
MACHINE LEARNING MODELS 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
We Were Good Guys ... 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Even NVIDIA... 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
ML-Based Anti-Virus? 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
ML-Based Anti-Virus? 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
CSOs Explained 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
But Still ... 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Rescan Makes It Worse 
Compiler 
Hello World 
(no debug) 
Hello World 
(debug) 
Nothing (no 
debug) 
Nothing 
(debug) 
Visual Studio 
2017 
Cylance, 
Jiangmin 
Cylance, Cyren, 
F-Prot, Sophos 
ML, 
SentinelOne 
Static ML 
Cylance, 
Jiangmin 
Cylance, Cyren, 
F-Prot, Sophos 
ML, 
SentinelOne 
Static ML 
MingW64 
Good 
Good 
Good 
Good 
Cygwin x86_64 Baidu, Cylance Baidu 
Baidu, Cylance Baidu 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
ML is Prosperous 
Taigman et al. (2014) DeepFace: Closing the Gap to Human-Level Performance in Face Verification 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
ML Drives 
https://www.tesla.com/sites/default/files/images/videos/tesla_autopilot_2_video.jpg 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine learning has its particular vulnerabilities. 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
NIPS 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
THEORIES AND 
PRACTICES 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Methodology 
â€¢
Evasion 
â€¢
Black box 
â€¢
White box 
â€¢
Model stealing 
â€¢
Poisoning 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Methodology 
â€¢
Evasion 
â€¢
Black box 
â€¢
Random 
â€¢
Evolutionary algorithms (GA) 
â€¢
White box 
â€¢
Model stealing 
â€¢
Poisoning 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box 
â€¢
No model 
â€¢
Only predict interface & result 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box: Random Noise Attack 
â€¢
Add some white noise? 
? 
Not effective for most model 
random.normalvariate(0, 5) 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box: Iterative Random Attack 
Add some 
noise 
Repeat 
hundreds times 
Select the best 
one 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Random â€“ STOP 
â€¢
Inspired by Evtimov et al. (2017) 
â€¢
We use iterative random attack instead 
â€¢
Difficult: STOP sign  something else 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Random â€“ STOP 
â€¢
Evtimov et al. (2017)  80 KM/h 
Hacked in iteration 5 
Predicted Labels: 39 ['Keep left'] 
(confidence = 73%) 
39 - Keep left 
14 - Stop 
13 - Yield 
  6 - End of speed limit (80km/h) 
41 - End of no passing 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Random â€“ Faces 
â€¢
VGG Face and @mzaradzki 
N 
Square Size 
Success? 
10 
4x4 
Adam Driver 
10 
4x3 
Adam Driver 
10 
3x3 
Adam Driver 
10 
2x2 
Adam Driver (difficult) 
-- 
Cat face 
Failed 
10 
1x1 
Failed* 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Random â€“ Faces 
Adam Driver 
           Aamir Khan 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Genetic Algorithm 
â€¢
Effective random search 
â€¢
Inspired by the process of natural selection 
â€¢
Belongs to evolutionary algorithms (EA) 
â€¢
Solving optimization and search problems 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Black Box â€“ Genetic Algorithm 
â€¢
Selection 
â€¢
Crossover 
â€¢
Mutation 
â€¢
Evaluation 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Methodology 
â€¢
Evasion 
â€¢
Black box 
â€¢
White box 
â€¢
FGSM 
â€¢
One-step target class 
â€¢
Model stealing 
â€¢
Poisoning 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
White Box 
â€¢
With all model detail 
â€¢
DNN architecture, weights 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Fast Gradient Sign Method 
â€¢
simple and computationally efficient 
â€¢
non-target attack 
â€¢
Goodfellow et al. (2014) 
Xadv: Adversarial image 
X: Original image 
ğœ–: perturbation level 
ğ›»ğ‘‹ ğ½(ğ‘‹, ğ‘¦): gradient 
ğ‘‹ğ‘ğ‘‘ğ‘¡ = ğ‘‹ + ğœ–ğ‘ ğ‘–ğ‘”ğ‘›(ğ›»ğ‘‹ğ½ ğ‘‹, ğ‘¦ğ‘¡ğ‘Ÿğ‘¡ğ‘‘ ) 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Attack a Linear Model 
â€¢
Introduction to FGSM 
Fei-Fei Li, Andrej Karpathy, Justin Johnson, Lecture 9-72, 2016 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
White Box Attack Methods 
â€¢
Fast gradient sign method (non-target, one step) 
â€¢
One-step target class methods (target, one step) 
â€¢
Basic iterative method (non-target, multiple steps) 
â€¢
Iterative least-likely class method (target , multiple 
steps) 
Kurakin et al., ADVERSARIAL MACHINE LEARNING AT SCALE. ICLR 2017 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
White Box â€“ FGSM â€“ Trash Can 
label: 412 (ashcan, trash can), certainty: 37.47% 
label: 899 (water jug), certainty: 10.85% 
label: 503 (cocktail shaker), certainty: 7.98% 
label: 412 (ashcan, trash can), certainty: 87.68%  
label: 463 (bucket, pail), certainty: 3.08% 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
White Box â€“ One-Step Target 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Methodology 
â€¢
Evasion 
â€¢
Black box 
â€¢
White box 
â€¢
Model stealing 
â€¢
Poisoning 
API 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Model Stealing 
Florian Tramer et. al., Stealing Machine Learning Models via Prediction APIs, Usenix Security Symposium 2016 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Model Stealing 
â€¢
Model is data 
â€¢
Model is asset 
â€¢
Train a local DNN for Black box attack 
â€¢
Data privacy 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Model Stealing: Adversarial Attack 
â€¢
Transferability Property 
â€¢
Train a local model for attack 
â€¢
Effective data augmentation 
Ian Goodfellow, Practical Black-Box Attacks against Machine Learning, 2017 
Model A 
Model B 
Adversarial Samples 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Model Stealing: Data Privacy 
â€¢
How to re-build your face if we have the model? 
Florian Tramer et. al., Stealing Machine Learning Models via Prediction APIs, Usenix Security Symposium 2016 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Methodology 
â€¢
Evasion 
â€¢
Black box 
â€¢
White box 
â€¢
Model stealing 
â€¢
Poisoning 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Poison Attack 
â€¢
Crowdsourcing 
â€¢
Amazon Mechanical turk 
â€¢
Mis-labeling 
â€¢
Online training 
â€¢
Microsoft chatbot: Tay 
â€¢
User feedback 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Real World Adversarial 
â€¢
Evading Against PDF ML 
â€¢
Auto-pilot cars 
â€¢
Access control w/ face recognition 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Evading Against PDF ML 
â€¢
Genetic algorithm to generate adversarial sample 
â€¢
Sandbox to ensure malicious behavior kept 
Weilin Xu, Yanjun Qi, and David Evans. Automatically Evading Classifiers A Case Study on 
PDF Malware Classifiers. Network and Distributed Systems Symposium 2016 
http://evademl.org/ 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Auto-pilot Cars 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Access Control w/ Face Recognition 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
COUNTERMEASURES 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Countermeasures 
â€¢
Ensemble & Stacking 
â€¢
Retrained model 
â€¢
Denoiser 
â€¢
Prevent Model Leakage 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Ensemble & Stacking 
â€¢
Layer protection 
Xgboost 
SVM 
CNN 
RNN 
LR 
LDA 
Layer 1 
Layer 2 
Layer 3 
Input Data 
Prediction 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Retrained Models 
â€¢
Distortion 
â€¢
Retrain with noisy sample 
â€¢
Randomization layer in DNN (NIPS 2nd) 
â€¢
Generative Adversarial Networks (GAN) 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Denoiser 
â€¢
Use denoise technologies from image processing 
â€¢
Train a DNN denoiser to reduce the noise 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Prevent Model Leakage 
â€¢
Avoid Model stealing 
â€¢
Increase the challenge of black box attack 
â€¢
Keep some info secret or add some noise 
â€¢
Randomization and disinformation 
â€¢
Adversarial sample detection 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
CONCLUSION 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Conclusion 
â€¢
Know the limitations and weakness of your model 
â€¢
Integrate adversarial machine learning into product 
development cycle 
â€¢
Improve ML 
â€¢
QA process 
â€¢
Trend Micro is working on bypassing anti-virus with 
ML in order to make our product robust 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
References 
â€¢
Evtimov et al. (2017) Robust Physical-World Attacks on Deep Learning Models 
â€¢
https://iotsecurity.eecs.umich.edu/#roadsigns 
â€¢
Nguyen et al. (2015) Deep Neural Networks are Easily Fooled: High Confidence 
Predictions for Unrecognizable Images. IEEE CVPR â€˜15. 
â€¢
Kurakin A., Goodfellow I.J., Bengio S. (2017) Adversarial Examples in the Physical 
World.  
â€¢
https://github.com/tomaszkacmajor/CarND-Traffic-Sign-Classifier-P2 
â€¢
https://aboveintelligent.com/face-recognition-with-keras-and-opencv-
2baf2a83b799 
â€¢
https://github.com/davidsandberg/facenet 
â€¢
http://www.vlfeat.org/matconvnet/pretrained/#face-recognition 
â€¢
https://github.com/mzaradzki/neuralnets/tree/master/vgg_faces_keras 
Machine 
Learning 
Protect against 
tomorrowâ€™s 
threats 
USE THE SOURCE, LUKE! 
https://github.com/miaoski/hitcon-2017-adversarial-ml