# How Healthy are Today’s Enterprise Networks?

**Authors:**
- Saikat Guha, Cornell University
- Jaideep Chandrashekar, Intel Research
- Nina Taft, Intel Research
- Konstantina Papagiannaki, Intel Research

**Abstract:**
In this paper, we evaluate the health of a typical enterprise network using a new metric based on the fraction of useful flows generated by end hosts. Flows are considered non-useful if they explicitly fail or do not elicit a response from the intended destination. Analyzing traces collected from a large number of mobile hosts in an enterprise network, we find that approximately 34% of the flows are non-useful. Through our study, which combines data analysis and ongoing interactions with our IT department, we identify several causes for these non-useful flows. These include frequent environmental changes (e.g., moving in and out of the corporate environment), lack of environment awareness, misconfiguration, unnecessary broadcast traffic, and excessive connection retries. Understanding this persistent noise in end-host communication is crucial for various reasons, including its impact on anomaly detection and resource wastage, particularly in wireless and mobile environments. Finally, we discuss potential strategies to design applications and services that can significantly improve network health.

**Categories and Subject Descriptors:**
- C.2.3 [Computer Systems Organization]: Computer Communication Networks—Network Operations
- C.4 [Computer Systems Organization]: Performance of Systems

**General Terms:**
- Measurement, Performance

**Keywords:**
- Network Health, Enterprise, Mobility, Environment Awareness

**Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. To copy otherwise, to republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee.**

**IMC’08, October 20–22, 2008, Vouliagmeni, Greece.**
**Copyright 2008 ACM 978-1-60558-334-1/08/10 ...$5.00.**

## 1. Introduction

Enterprise networks today often rival the complexity of the larger Internet, with stringent policies imposed on employee host machines to protect against malicious entities and control network traffic. For example, strict policies for software patching and updates are enforced, and certain programs are blacklisted to prevent security risks. Despite these measures, the traffic generated by user end hosts is not always well-behaved or easily analyzable. This paper demonstrates that this is far from the case.

The disconnect arises from the complexity of modern applications, coupled with the highly distributed infrastructure and shrinking IT budgets, leading to an ailing network with poor diagnostic properties. Small problems go unnoticed and accumulate over time, depleting network resources.

In this paper, we analyze traffic traces from a large number of enterprise end hosts to quantify and understand the traffic at the edge of the enterprise network. We introduce a new metric to capture the "health" of an enterprise network from the perspective of the end hosts. We define health as the fraction of observed flows that are useful. A flow is deemed useful if it successfully contacts the intended destination application; otherwise, it is non-useful. Non-useful flows are symptomatic of misconfigurations, stale information, or other underlying issues.

Our definition of health, while simplistic, is well-suited for identifying suboptimal designs in both applications and network architecture. In-network mechanisms such as NATs, firewalls, intrusion detection systems, and application dependency extraction operate at the granularity of flows. Our health metric captures, at least to the first order, the noise these mechanisms must contend with.

Identifying and quantifying this noise is important for several reasons. First, it complicates the design of end-host-based anomaly detectors, as failed connections may be benign but can drown out existing anomalies and symptoms of poor performance. Second, it highlights inherent inefficiencies, such as NATs and firewalls consuming more resources than necessary, and in wireless environments, causing unnecessary channel contention and increased costs under metered pricing.

Overall, our contributions are as follows:
1. We analyze traffic traces from a large population of enterprise end hosts and quantify their health, finding that the level hovers between 60% to 70%.
2. We study the traffic from various perspectives, including temporal, application-based, changes in environment, protocol behavior, and failure types.
3. We quantify the problem of lack of environment awareness, finding that roughly 77% of observed failures occur within a minute of the end host switching between networks.
4. We categorize failures into three groups: persistent connection retries, service discovery, and vulnerability testing, and suggest coping strategies to address these issues.

## 2. Methodology

Traditional network trace collection efforts are "network-centric," gathering traces at routers or other aggregation points. Inferring the cause of failures from such traces is problematic due to dynamic addresses and the mobility of users. To study health from the end-host perspective, we collected data directly from the end hosts.

In February 2007, we gathered data from over 350 volunteering employees across multiple sites. We collected all packet headers and 150 bytes of the payload for all traffic at the end host across any active network interface. Of this set, 95% were mobile hosts, and the remaining were desktops. The traces included activity when the host was outside the enterprise, such as at coffee shops, home, and airports.

Each trace file was annotated with coarse-grained user location (internal, VPN, external) and a unique per-user identifier. Traffic was captured using WinPcap, which was restarted upon any change in environment, address, or interface. All hosts ran an up-to-date version of Windows XP SP2, yielding a total of 31 million flows.

Our analysis used flow-level data, post-processed with BRO, which performed flow reassembly and summarized the connection state. We classified individual flows as useful or non-useful. Useful flows elicited a response from the destination, including TCP flows that completed the 3-way handshake and UDP flows that saw packets in both directions. Failed flows corresponded to BRO flags S0, REJ, and RSTOS0.

Classifying flows at the transport layer introduces artifacts, such as flows that succeed at the transport layer but fail at the application layer, and unidirectional UDP flows. We manually identified broadcast traffic and analyzed the most egregious applications, omitting such flows from our analysis unless specified.

To generalize our results to other enterprise networks, we shared our findings with the IT department and relied on their expertise. Many failures are endemic to common enterprise software, such as the Windows OS, antivirus software, and software-patching services. Given the size and complexity of today's enterprise networks, it is reasonable to expect similar designs and configurations, suggesting that our results apply, at least in part, to other typical large enterprises.

## 3. Network Health

The overall health of our enterprise network, defined as the fraction of successful flows, is 66%, indicating significant room for improvement. In this section, we analyze the factors affecting health, including time of day, user location and activity, and applications.

[Insert relevant figures and tables here]

### 3.1 Time of Day
[Discuss how network health varies with time of day, providing relevant data and insights.]

### 3.2 User Location and Activity
[Discuss how network health varies with user location and activity, providing relevant data and insights.]

### 3.3 Applications
[Discuss how different applications affect network health, providing relevant data and insights.]

### 3.4 Environmental Changes
[Discuss the impact of environmental changes on network health, providing relevant data and insights.]

### 3.5 Failure Types
[Discuss the different types of failures and their impact on network health, providing relevant data and insights.]

## 4. Conclusion

In conclusion, our study provides a comprehensive analysis of the health of a typical enterprise network. We introduce a new metric to quantify network health and identify several key factors contributing to non-useful flows. By understanding and addressing these factors, we can significantly improve the health and efficiency of enterprise networks. Future work will focus on developing and implementing strategies to mitigate the identified issues and enhance overall network performance.

[Insert references and acknowledgments as needed]