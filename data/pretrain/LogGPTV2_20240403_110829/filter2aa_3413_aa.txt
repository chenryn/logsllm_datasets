A
Atttt
SSaattaann  
m
myy  FFrriieenn
ttttaacckkiinngg  SSoocc
::::  D
DeeffCCoonn  SSiixxtteeee
SShhaaw
wnn  M
M
aanndd
N
Naatthhaann  H
H
n  iiss  oonn  
nnddss  LLiisstt  ::  
cciiaall  N
Neettw
woorrkk
eenn  ((FFTTM
MFFW
W))  ::::  
M
Mooyyeerr    
dd    
H
Haam
miieell 
kkss  
"Has what we've learned about writing software the last 20 years been expressed in the 
design of Web 2.0? Of course not! It can't even be said to have a 'design.' If showing people what 
vulnerabilities can do were going to somehow encourage software developers to be more careful 
about programming, Web 2.0 would not be happening. 
Trust model? What's that? The so-called vulnerability 'researchers' are already sharpening 
their knives for the coming feast." 
:: Marcus Ranum in InfoSec Magazine, May 2008 
P.S. Thanks for lending us a whetstone, Marcus. =) 
Table of Contents 
:: About the authors ........................................................................................................... 3 
:: Introduction ................................................................................................................... 4 
:: Vivisecting The Social Net Model ....................................................................................... 5 
:: Connections, Entities ............................................................................................. 5 
:: Personae and Simulacra ......................................................................................... 5 
:: Culture of Trust .................................................................................................... 6 
:: Framework and Platform ........................................................................................ 6 
:: Attacking Social Networks ................................................................................................ 7 
:: Attacking Social Network Functionality ..................................................................... 7 
:: Attacking Via Offsite Content .................................................................................. 8 
:: Attacking with the IMG Tag .................................................................................... 8 
:: Request Forgeries and Social Nets ........................................................................... 8 
:: Attacking “Innocuous” Functions ............................................................................. 8 
:: SocEng and technical attacks .................................................................................. 9 
:: Attacking Social Network Applications ...................................................................... 9 
:: Attacking Via Social Network Applications .............................................................. 10 
:: An impersonation experiment ......................................................................................... 11 
:: Connections are currency, but currency is cheap ......................................................... 13 
:: Good bait yields results ........................................................................................ 14 
:: About the authors  
:: Shawn Moyer is the founder of Agura Digital Security, a web and network 
security consultancy. He has led security projects for major multinational 
corporations and the federal government, written for Information Security magazine, 
and spoken previously at BH and other conferences.  
Shawn is currently working on a slash fanfic adaptation of 2001:A Space 
Odyssey, told from the perspective of Hal9000. He only accepts friend requests on 
Facebook if they include a DNA sample and a scanned copy of a valid driver's license 
or passport.  
:: Nathan Hamiel is a Senior Consultant for Idea Information Security and 
the founder of the Hexagon Security Group. He is also an Associate Professor at the 
University of Advancing Technology. Nathan has previously presented at numerous 
other conferences including DefCon, Shmoocon, Toorcon, and HOPE.  
Nathan spent much of DefCon 15 without shoes and is planning ahead this 
year with a defense-in-depth approach that includes failover footwear. He has 1,936 
people in his extended network, and finds that disturbing on a number of levels.  
S a t a n  i s  o n  m y  F r i e n d s  L i s t  
Page 4 
  :: Introduction  
Like most folks of a security bent (and if you're reading this, that probably 
means you), we've spent a lot of time watching Web 2.0 with bemusement. 
Promiscuous sharing of information, client-side Javascript goop, blogging, 
mini-blogging, micro-blogging, vlogging, social nets and social media have all given 
the web much of what the starry-eyed latte-chugging idealists of Web 1.0 and the 
dot-bomb boom were yammering on about ten years ago: a platform for anyone to 
create content, to connect, to share, and to carve out a little space for themselves 
and a few million of their closest friends. 
All of the above, of course, seems to run absolutely orthogonal to everything 
those of us in InfoSec preach: "Validate all user input. Authenticate and tokenize 
everything. Sanitize all output. Audit the crap out of anything before it goes live. 
Limit functionality to core functional requirements. Trust no one." 
From a securability perspective, giving every user of an application a more or 
less open platform to create content and write their own (carefully sanitized and oh-
most-assuredly vetted) apps, stylesheets and scripts to share with their Interweb 
penpals sounds like the lunatics running the asylum, doesn't it? Nobody can build a 
sandbox that big -- or rather an infinite series of sandboxes, with a series of little 
tunnels between them... Does your head hurt yet? 
And yet, here we are. This year BlackHat and sister con DefCon invited 
attendees and speakers to join LinkedIn groups and are micro-blogging on Twitter 
(as are both of your intrepid authors). These are organizations whose members are 
often only known by their handles, who have lived through presenters being sued, 
arrested, and detained in airports, part of what is arguably the largest hacker 
community in existence, made up of some of the most paranoid netizens on the 
planet. Asking us to join their friends list? What gives? 
Well, let's face it. This stuff is like crack. The ability to connect and 
communicate in a simple interface brings the human back into the digital. The thrill 
of someone accepting a friend request or responding to a message in many ways 
evokes the old feeling you got in the heydays of BBSing when you stumbled on a 
new board and saw someone you knew... Someone on the other side of the screen, 
out there, is listening to you. Someone else out there thinks you matter. 
So if even those of us in the paranoid-by-profession security world are getting 
sucked in, and we accept this stuff isn't going away any time soon, how bad is it 
really? How far behind the usual safety versus features curve are we at this point? 
That's what we've been trying to work out.  
S a t a n  i s  o n  m y  F r i e n d s  L i s t  
Page 5 
  :: Vivisecting The 
Social Net Model 
To build a framework for how social 
nets can be attacked, we spent some time 
trying understand all of the moving parts. 
There are literally hundreds of social 
networking sites, but most share some 
basic functionality, with varying degrees of 
flair and features, from the very sparse 
(Twitter, Pownce, and social components 
of blogging sites and forums) to the 
staggeringly complex features arms race 
between Facebook and MySpace.
  :: Connections, Entities 
An entity is simply something that 
can share connections with other entities. 
It might be a bot, it might be a group or 
affiliation, it might be an app, or it might 
be a human. If it has a friends list, it's an 
entity. 
The key here is that a connection between two entities implies some degree 
of trust, and each entity is a spoke that creates nth-degree connections. If you install 
an application, join a group, or add a connection, you've trusted that entity, and by 
association those in your connection list have some level of transitive trust of the 
entity as well. 
Connections and links between entities are the meat and bones of social 
networks, naturally. Much of SocNet attack vectors come from here, and for us, the 
framework of connections mean that by definition, any social network contains a 
social component. 
For our purposes, and with moves to interoperation and applications built on 
building connections between SocNets, we also consider connections to span not only 
a given site, but potentially to span other SocNets as well. 
  :: Personae and Simulacra 
SocNets have a voyeuristic quality to them that seems to draw people in. Our 
SocNet profiles are about showing the world our perception of ourselves. Users make 
S a t a n  i s  o n  m y  F r i e n d s  L i s t  
Page 6 
liberal use of soft-focus pics and flattering angles -- the“LiveJournal head tilt” and 
the “MySpace angle shot” and create a thinner, richer, more clever simulacrum of 
themselves. On the business networking side, bombastic resumes and reciprocal 
endorsements from coworkers help build the identity of a model SocNet citizen. 
Effective approaches of attack take into account this seemingly universal need 
to build up a better-than-IRL persona. Approaches that play on vanity, or provide a 
way to further build the persona will yield better results. 
  :: Culture of Trust 
Building a platform based on user-created content and applications means 
that from inception there is a basic trust of the user population. Interestingly, 
though, unlike other social media like Wikis, there's very little democracy involved, 
and users have few recourses to police bad actors other than to send complaints to 
an always-full complaint mailbox. 
Since becoming a member of a SocNet requires the initial leap of creating at 
least a semi-public profile, it becomes a small step to move a bit further, and accept 
message and connection requests from people you haven't really verified, and to 
share further and further information. This pervasive culture of trust and sharing is 
much of what makes SocNets so appealing from an attacker's standpoint.  
  :: Framework and Platform 
SocNet frameworks are built on facilitating connections, and then creating 
rapport between those connections. Providers are constantly extending this 
functionality and adding new features to match up potential connections, send 
messages and share media, creating more affinities and eyeballs for hyperfocused 
targeted advertising (which ultimately, is the reason Social Nets exist in the first 
place).  
OpenSocial and other published application APIs have now made it far more 
possible to integrate social apps and share data between sites, and we're now seeing 
a move to cross-site functionality, and naturally, the creation of new shared 
exposure.  
  :: Attacking 
Social Networks
Social networks make great 
targets due to the fact they are 
large collections of individuals. 
Large collections of indi
usually equal large collection of 
potential victims. 
also provide an environment 
where victims are more likely to 
come to an attacker. Social 
network culture is a trusting 
culture. Typically people trust by 
default. Whenever you hav
environment where individuals 
trust by default there is a high 
degree of attacks being successful. 
Individuals are less likely to think 
that attackers would target them 
or that anything they have would 
be worth an attacker’s time. 
Individuals in so
software is less dangerous th
warnings and disclaimers aside
download and install a traditional exec
As of late there has been a shift of focus for social networks toward business 
and professionals. More and more social networks are cropping up that have this 
focus. There are many professional networks that cater to business pr
like LinkedIn, Plaxo, and Naymz, and Facebook has also worked at attracting some 
level of professional networking.
become a path into a corporate user population and a new vector for targeted 
attacks. 
  :: Attacking
A quick inventory of what an attacker has at their disposal when attacking 
social networks reveals quite a few possibilities. Social networks are constructed with 
a great majority of their content provided by their users. Thi
introduce many potential vulnerabilities. The more restrictions that are
the less “open” 
restrictive they risk losing their users to other networks.
S a t a n  i s  o n  m y  F r i e n d s  L i s t
Attacking 
Social Networks 
Social networks make great 
targets due to the fact they are 
large collections of individuals. 
Large collections of individuals 
usually equal large collection of 
tial victims. Social networks 
also provide an environment 
where victims are more likely to 
come to an attacker. Social 
network culture is a trusting 
culture. Typically people trust by 
default. Whenever you have an 
environment where individuals 
trust by default there is a high 
degree of attacks being successful. 
Individuals are less likely to think 
that attackers would target them 
or that anything they have would 
be worth an attacker’s time.  
Individuals in social nets may also have the perception that browser based 
software is less dangerous than installed software. Users are far more
warnings and disclaimers aside, to install social 
download and install a traditional executable.
As of late there has been a shift of focus for social networks toward business 
and professionals. More and more social networks are cropping up that have this 
focus. There are many professional networks that cater to business pr
LinkedIn, Plaxo, and Naymz, and Facebook has also worked at attracting some 
level of professional networking. This means that Social Networks can now also 
become a path into a corporate user population and a new vector for targeted 
Attacking Social Network Functionality 
A quick inventory of what an attacker has at their disposal when attacking 
social networks reveals quite a few possibilities. Social networks are constructed with 
a great majority of their content provided by their users. Thi
introduce many potential vulnerabilities. The more restrictions that are
the less “open” the social network becomes. If the social network becomes too 
restrictive they risk losing their users to other networks.
S a t a n  i s  o n  m y  F r i e n d s  L i s t  
cial nets may also have the perception that browser based 
ed software. Users are far more likely, 
social applications than they are to 
utable. 
As of late there has been a shift of focus for social networks toward business 
and professionals. More and more social networks are cropping up that have this 
focus. There are many professional networks that cater to business professionals, 
LinkedIn, Plaxo, and Naymz, and Facebook has also worked at attracting some 
This means that Social Networks can now also 
become a path into a corporate user population and a new vector for targeted 
Social Network Functionality  
A quick inventory of what an attacker has at their disposal when attacking 
social networks reveals quite a few possibilities. Social networks are constructed with 
a great majority of their content provided by their users. This content model can 
introduce many potential vulnerabilities. The more restrictions that are put in place, 
s. If the social network becomes too 
restrictive they risk losing their users to other networks. 
Page 7 
cial nets may also have the perception that browser based 
, 
to 
As of late there has been a shift of focus for social networks toward business 
and professionals. More and more social networks are cropping up that have this 
ofessionals, 
LinkedIn, Plaxo, and Naymz, and Facebook has also worked at attracting some 
This means that Social Networks can now also 
become a path into a corporate user population and a new vector for targeted 
A quick inventory of what an attacker has at their disposal when attacking 
social networks reveals quite a few possibilities. Social networks are constructed with 