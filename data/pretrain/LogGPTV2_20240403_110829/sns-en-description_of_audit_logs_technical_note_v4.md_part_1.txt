TECHNICAL NOTE
STORMSHIELD NETWORK SECURITY
DESCRIPTION OF AUDIT LOGS
Productconcerned:SNS4.7.2
Documentlastupdated:December14,2023
Reference:sns-en-description_of_audit_logs_technical_note_v4
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Table of contents
Gettingstarted 3
Readinglogs 4
Readinglogsinthewebadministrationinterface 4
Readinglogsinlogfiles 4
Readinglogarchives 5
Archivenames 5
Managinglogstorage 6
Configuringlogs 7
Understandinglogtypes 7
Choosingwheretosavelogs 7
Choosingwhichlogstogenerate 7
AddinglogstofilterandNATrules 8
Understandingauditlogs 9
Commonfieldsinalllogs 9
Specificfields 11
Fieldsspecifictothe“l_filter”, “l_alarm”,“ l_connection”and“l_plugin”logs 11
Fieldsspecifictothe“l_filter”log 15
Fieldsspecifictothe“l_alarm”log 16
Fieldsspecifictothe“l_connection”log 17
Fieldsspecifictothe“l_plugin”log 18
Fieldsspecifictothe"l_pvm"log 24
Fieldsspecifictothe"l_system"log 26
Fieldsspecifictothe"l_server"log 27
Fieldsspecifictothe"l_vpn"log 27
Fieldsspecifictothe"l_monitor"log 29
Fieldsspecifictothe"l_smtp","l_pop3","l_ftp","l_web",and"l_ssl"logs 33
Fieldsspecifictothe"l_smtp","l_pop3","l_ftp"and"l_web"logs 35
Fieldsspecifictothe"l_smtp"log 36
Fieldsspecifictothe"l_pop3"log 38
Fieldsspecifictothe"l_ftp"log 40
Fieldsspecifictothe"l_web"log 40
Fieldsspecifictothe"l_ssl"log 43
Fieldsspecifictothe"l_auth"log 44
Fieldsspecifictothe"l_xvpn"log 46
Fieldsspecifictothe"l_sandboxing"log 47
Fieldsspecifictothe“l_filterstat”log 49
Fieldsspecifictothe"l_count"log 52
Fieldsspecifictothe“l_routerstat”log 52
Furtherreading 54
Page2/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Getting started
StormshieldNetworkSecurityfirewallslogtheactivityofthevariousenabledserviceswhile
theyarerunning.Generatedevents(logs)aresavedlocallybydefaultinauditlogfilesonthe
harddiskorinSDmemorycardsforsmallerappliances.Theyalsoappearintheweb
administrationinterface,displayedbytheme,e.g.,Networktraffic,Alarms,Web,etc.
Logsallowyoutocheckthefirewall'sactivityorfixpotentialissues.Stormshield'stechnical
supportteamalsoreliesonsuchlogsfortroubleshootingwherenecessary.
Inthisdocument,youwilllearnhowtolookupandconfigurelogs,aswellasthebestpractices
toadoptwhenstoringandusingthem.
Page3/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Reading logs
Logscanbereadinthewebadministrationinterfaceordirectlyinfilesstoredontheharddisk
orSDcard.IflogsaresenttoaSyslogserverorthroughanIPFixcollector,theycanalsoberead
intheseprograms.
Inahighavailability(HA)cluster,logsarenotreplicatedonallnodes.Theactivefirewallwrites
logstoitsharddisk.Ifthefirewallbecomesthepassivefirewall,theotheractivefirewallwill
continuewritinglogs.Asaresult,neitherfirewallintheclustercontainsalllogs,andtheweb
administrationinterfacedisplaysonlylogsfoundonthefirewalltowhichitisconnected.To
readlogsmoreeasilyinaHAsetup,sendthemtoaSyslogserver.
InlinewiththeGeneralDataProtectionRegulation(GDPR),accesstofirewalllogsisrestricted
bydefaultforalladministrators.Theadminsuperadministratorcaneasilyaccessfulllogsbut
otheradministratorsmustrequestatemporaryaccesscode.Everytimearequestissubmitted
forfullaccesstologs,alogwillbegenerated.Forfurtherinformation,refertotheTechnicalnote
Complyingwithprivacyregulations.
Reading logs in the web administration interface
1. Intheupperpartofthewebadministrationinterface,clickontheMonitoringtab.
2. Inthemenuontheleft,selectLogs-Auditlogs.
3. Todisplayalllogs,clickonAlllogs.Otherwise,selectthedesiredview.
Logsaredisplayedinchronologicalorder,thefirstbeingthemostrecent.Onlylogsfromthe
lasthouraredisplayedbydefault,butthetimerangecanbechangedbyclickingonthe
drop-downlist.
4. ClickonActions>Expandallelementsifyouwishtodisplayallavailablecolumns.
5. Tofilterlogs,entertextintheSearchfieldorclickonAdvancedsearch,thenAddacriterion
tocombinevarioussearchcriteria.
Forfurtherinformationonsearchesanddisplayinglogs,refertoViewsandInteractionsinthe
Userguide.
Reading logs in log files
LogintothefirewallinSSHtoreadlogsstoredinthe/logfolder.Theselogsconsistofthe
l
followingfiles:
l_alarm Eventsrelatingtointrusionpreventionfunctions(IPS)andthoseloggedwithaminoror
majoralarmlevelinthefilterpolicy.
l_auth Eventsrelatingtouserauthenticationonthefirewall
l_connection EventsrelatingtoTCP/UDPauthorizedconnectionstoandfromthefirewall,whichhave
notbeenanalyzedbyanapplicationplugin.Thelogiswrittenattheendofthe
connection.
l_count Statisticsregardingthenumberoftimesarulehasbeenexecuted.Suchlogsarenot
generatedbydefault.Forfurtherinformation,seeAddinglogstofilterrules.
l_date Eventsrelatingtotimechangesonthefirewall.
l_filter Eventsrelatingtofilterand/orNATrules.Suchlogsarenotgeneratedbydefault.For
furtherinformation,seeAddinglogstofilterrules.
Page4/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
l_filterstat Statisticsregardingtheuseofthefirewallanditsresources.
l_ftp EventsrelatingtoconnectionsgoingthroughtheFTPproxy.
l_monitor Statisticsforthecreationofperformancegraphsandsecurityreports(web
administrationinterface).
l_plugin Eventsrelatingtoprocessescarriedoutbyapplicationplugins(FTP,SIP,etc.).
l_pop3 EventsrelatingtoconnectionsgoingthroughthePOP3proxy.
l_pvm EventsrelatingtotheoptionStormshieldNetworkVulnerabilityManager.
l_sandboxing Eventsrelatingtofilesandboxingifthesubscriptionforthisoptionhasbeenactivated.
l_server Eventsrelatingtotheadministrationofthefirewall
l_smtp EventsrelatingtoconnectionsgoingthroughtheSMTPproxy.
l_ssl EventsrelatingtoconnectionsgoingthroughtheSSLproxy.
l_system Eventsdirectlyrelatingtothesystem(shutdown/rebootofthefirewall,systemerror,
serviceoperation,etc).
l_vpn EventsrelatingtotheIPSecVPNtunnelnegotiationphase.
l_web EventsrelatingtoconnectionsgoingthroughtheHTTPproxy.
l_xvpn EventsrelatingtothesetupofanSSLVPNtunnel(tunnelorportalmode).
l_routerstat Statisticsrelatingtorouterobjects(SD-WAN)
Formoreinformationonthevariousfieldsinthesefiles,refertothetechnicalnote
Understandingauditlogs.
Reading log archives
Assoonasalogfileexceeds20MB,itwillbeclosedtomakewayforanother.Theclosedfile
canbefoundinthe/logfileunderanewname.
Archivenames
Closedlogfilesarenamedaccordingtothefollowingstructure:
Typeoflogfile(e.g.:l_filter,l_alarm,etc.),
l
An8-digitindexnumber(startsfrom0),
l
Creationdate:GMTdateofthefirstlogcontainedinthefile,
l
Closingdate:GMTdateofthelastlogcontainedinthefile,
l
Thenumberoflogsstoredinthefile.
l
Page5/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Example:
Fileindexation(managedincrementallyandstartingfrom0)makesitpossibletonothaveto
relyonlyoncreationorclosingdates,asthesedatesmaybedistortedwhenthetimeis
changedonthefirewall.
Managinglogstorage
Bydefault,whenthestoragespacereservedforalogtypereachesfullcapacity,theoldest
archivefilewillbeerasedtofreeupspace.
Twoothercoursesofactionareavailable,andcanbeenabledforeachtypeoflogfileusing
CLI/serverdCONFIG LOG commands:
Logsstopbeinggeneratedoncethededicatedspacereachesfullcapacity,
l
Thefirewallshutsdownoncethededicatedspacereachesfullcapacity.
l
Formoreinformationonthesyntaxofthesecommands,refertotheCLI SERVERD Commands
ReferenceGuide.
Page6/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Configuring logs
Youcanselectthelogsyouwantthefirewalltogenerate,wherelogswillbesaved,andthe
leveloflogstogenerate.
Loggingmustbeoptimallyconfiguredsothatonlynecessarylogswillbegenerated.Whenthe
amountoflogsgeneratedexceedsthewritingcapacityonthestoragemedium,abufferwill
allowwritingtobedelayed,butwilleventuallyfillup.Toanticipateorresolvesuchissues,refer
totheknowledgebasearticleHowcanIsolvealogoverflowissue?anditsrelatedarticles.
Understanding log types
Therearetwotypesoflogs:
Standardactivitylogsthatareenabledbydefaultandwhichcanbeconfiguredinthe
l
moduleConfiguration>Notifications>Logs-Syslog-IPFIX.
FilterandNATlogsthataredisabledbydefaultandwhichcanbeconfiguredinthemodule
l
Configuration>Securitypolicy>Filter-NAT:
o Inthewindowtoeditfilterrules,Actionmenu,Generaltab,Loglevelfield,
o InthewindowtoeditNATrules,Optionsmenu,Loglevelfield.
FilterandNATlogsmustonlybeenabledtemporarilytodiagnoseissues.
Choosing where to save logs
LogsaresavedlocallybydefaultontheharddiskoronanSDcard.Theycanalsobesenttoa
SyslogserveroranIPFixcollector.
1. GotoConfiguration>Notifications>Logs-Syslog-IPFIX.
2. SwitchontheON/OFF switchdependingonwhereyouwishtosendlogs:local,
Syslogand/orIPFix.Forexample,ifyouchoosetoviewlogsonlythroughSIEMtools,enable
aSyslogprofileanddisablelocalstorageandtheIPFIXcollector.
Iflocalstorageisdisabled,onlythemostrecentlogsstoredintheRAM(about200logsper
category)canbeviewedinthewebadministrationinterfaceonthefirewall.Olderlogswill
notbedisplayed.
Choosing which logs to generate
Allstandardactivitylogsareenabledbydefaultandcanbeviewedinthewebadministration
interface.OnlyfilterandNATlogsaredisabledbydefault.Disablealllogsthatyoudonotneed.
ThisfeatureisnotavailableforIPFixcollectors.
Page7/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
1. GotoConfiguration>Notifications>Logs-Syslog-IPFIX.
2. Forlocalstorage,disablelogfamiliesbydouble-clickingintheEnabledcolumninthetable
Configurationofthespacereservedforlogs.Youcanadjustthepercentageofdiskspace
accordingtoyourneeds.
FortheSyslogserver,disablelogfamiliesbydouble-clickingintheStatuscolumnin
Advancedproperties.
Logsdisabledforlocalstoragewillnotappearinthewebadministrationinterfaceofthe
firewall.
Formoreinformation,refertothesectionLogs-Syslog-IPFIXintheUserguide.
Adding logs to filter and NAT rules
TrafficthatgoesthroughafilterorNATrulegeneratelogsbydefaultintheNetworkconnections
log,orintheApplicationconnectionslogifapluginconductsapplicationanalysesinIPSorIDS
mode.Onlyconnectionswitha"Pass"actionandinTCP/UDParelogged
TochecktheeffectivenessofafilterorNATrule,youcangenerateadditionallogsthatdonot
appearinotherlogs:
Logsofalltrafficthatafilterrulehasblocked,
l
Logsofalltraffictowhichaddresstranslation(NAT)hasbeenapplied,
l
LogsofalltrafficdirectlyabovetheIPlayerthatmatchesafilterrule,regardlessofwhether
l
ithasbeenpassedorblocked.
Enableverbosemodewithcareandonlyforthedurationofthecheck,asalargevolumeoflogs
willbegenerated,includingduplicatesofstandardactivitylogs.Thismaycausealogoverflow
andslowdowntheperformanceofthefirewall.
SuchlogsappearintheLogs-Auditlogs>Filteringmonitoringmenuinthewebadministration
interfaceandaresavedinthel_filterlogfile.
1. GotothemenuConfiguration>Securitypolicy>Filter-NAT.
2. Double-clickintheActioncolumnofthefilterrule.TheEditingrulewindowappears.
3. IntheActionmenu:
Generaltab,choosetheVerbose(filterlog)loglevel,
l
Advancedpropertiestab,Logssection,selectthelocationwherelogsfortherulewillbe
l
saved.DonotcheckDiskifyoudonotwishtosavesuchlogslocally.
Advancedpropertiestab,Logssection,selectCounttogeneratestatisticsinthel_count
l
logonthenumberoftimesarulehasbeenexecuted.
4. ConfirmchangestotherulebyclickingonOK,thenclickonApply.
5. RunyourcheckbylookinguptheNetworktrafficorFilteringviewsintheweb
administrationinterface,orinthe/log/l_filterfile.
6. IntheGeneraltabinthewindowtoeditfilterrules,resetthelogleveltothedefaultvalue
Standard(connectionlog).
Page8/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Understanding audit logs
Logsarewrittentotheircorrespondinglogfiles.
AuditlogsareWELF-compatibleUTF-8textfiles.TheWELFformatisasequenceofitems,written
asfield=valueandseparatedbyspaces.Valuesmaybeframedbydoublequotes.
Asinglelogcorrespondstoalineendingwithareturncarriage(CRLF).
Example
id=firewall time="1/27/2019 13:24:28" fw="V50XXA0G0000002" tz=+0000
startime="2011-01-27 13:24:28" pri=4 srcif="Ethernet0" srcifname="out"
ipproto=tcp proto=ssh src=192.168.0.1 srcport=54937 srcportname=ephemeral_
fw dst=192.168.1.1 dstport=22 dstportname=ssh dstname=Firewall_out
action=pass msg="Interactive connection detected" class=protocol
classification=0 alarmid=85
InthesectionsCommonfieldsinalllogsandSpecificfields,logsaredescribedasfollows:
Fieldname Descriptionofthefield
Formatofthefield.Example:"rawvalue"
Valueifdifferentfromtherawvalue.
Thelogsl_server,l_auth,l_vpnandl_systemcontainfieldsthatarespecifictoStormshield
Networkfirewalls.Theseparticularfields,whichdonotbelongtotheWELFformat,willbe
describedinthesectionSpecificfields.
Somelogfiles,suchasl_filterstat,l_routerstatandl_count,whichareusedtocalculate
statistics,containmanyspecificfields.
Theyarethereforesimilartosnapshotsofthestateofthefirewall.Theyarecalculatedand
writtenatregularintervals.
Changingthetime
Whenthetimeonthefirewallischanged,aspecificlinewillbewritteninallthelogs.
Thislinecontainsthefieldsdatechangeandduration.Thedatechangevalueinthiscase
willbe"1"toreflectthetimechange.Asforthedurationfield,itwillindicatethedifference(in
seconds)betweenthetimeonthefirewallbeforeandafterthischange.
Theotherfieldsofthislogarecommontoalllogs(describedinthefollowingsection).
Example
id=firewall time="1/1/2019 01:00:00" fw="U800SXXXXXXXXXX" tz=+0100
startime="1/1/2019 01:00:17" datechange=1 duration=-18
IntheAuditlogsmenuinthewebadministrationinterface,thislogwillappearinallmodules
highlightedinyellow.
Common fields in all logs
id Typeofproduct.
Thisfieldconstantlyhasthevalue“firewall”forlogsontheFirewall.
Page9/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
time “Local”timeatwhichthelogwasrecordedinthelogfile(timeconfiguredontheFirewall).
Stringin“YYYY-MM-DDHH:MM:SS”format.
Availablefrom:SNSv1.0.0.
Savedat
Thedisplayformat dependsonthelanguageoftheoperatingsystemonwhichthe
administrationsuitehasbeeninstalled.Example:“DD/MM/YYYY”and“HH:MM:SS”for
French;“YYYY/MM/DD”and“HH:MM:SS” forEnglish.
fw firewall'sIDThisisthenameenteredbytheadministratoror,bydefault,itsserialnumber.
StringofcharactersinUTF-8format.
Example:“firewall_name”or“V50XXXXXXXXXXXX”
Availablefrom:SNSv1.0.0.
tz TimedifferencebetweentheFirewall’stimeandGMT.Thisdependsonthetimezoneused.
Stringin“+HHMM”or“-HHMM”format.
Availablefrom:SNSv1.0.0.
GMToffset
Example:“gmt+01:00”
startime “Local”timeatthebeginningoftheloggedevent(timeconfiguredontheFirewall).
Stringin“YYYY-MM-DDHH:MM:SS”format.
Availablefrom:SNSv1.0.0.
Dateandtime
Thedisplayformat dependsonthelanguageoftheoperatingsystemonwhichthe
administrationsuitehasbeeninstalled.Example:“DD/MM/YYYY”and“HH:MM:SS”for
French;
“YYYY/MM/DD”;and“HH:MM:SS” forEnglish.
Page10/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
Specific fields
Thefieldspresentedbelowmaybecommontoasetoflogsorspecifictoasinglelog.
Fieldsspecifictothe“l_filter”, “l_alarm”,“ l_connection”and“l_plugin”logs
Thefieldsdescribedbelowappearinthewebadministrationinterfaceofthefirewallunderthe
Monitoring>Logs-Auditlogsmodule,intheviews:Alllogs,Networktraffic,Filtering,Alarms,
Web,E-mailsandSystemevents.
pri Representsthealarmlevel.
Values (cannotbecustomized):"0 "(emergency),"1 "(alert),"2 "(critical),"3 "(error),"4 "
(warning),"5 "(notice),"6 "(information)or"7 "(debug).
Availablefrom:SNSv1.0.0.
Priority
confid Indexofthesecurityinspectionprofileused.
Valuefrom“0”to“9”.
Availablefrom:SNSv1.0.0.
Config
slotlevel Indicatesthetypeofrulethatactivatedlogging.
Values:“0” (implicit),“1”(global),or“2” (local).
Availablefrom:SNSv1.0.0.
Rulelevel
Values:“Implicit”,“Global”or“Local”.
ruleid Numberofthefilterruleapplied.
Example:“1”,“2”…
Availablefrom:SNSv1.0.0.
Rule
srcif Internalnameoftheinterfaceatthesourceofthetraffic.
StringofcharactersinUTF-8format.Example:“Ethernet0”
Availablefrom:SNSv1.0.0.
Sourceinterf.(ID)
srcifname Nameoftheobjectrepresentingtheinterfaceatthesourceofthetraffic.
StringofcharactersinUTF-8format.Example:“out”
Availablefrom:SNSv1.0.0.
Sourceinterf.
srcmac MACaddressofthesourcehost.
Maybedisplayedanonymouslydependingontheadministrator'saccessprivileges.
Availablefrom:SNSv1.0.0.
SourceMACaddress
ipproto NameoftheprotocolaboveIP(transportlayer).
StringofcharactersinUTF-8format.Example:“tcp”
Availablefrom:SNSv1.0.0.
InternetProtocol
Page11/55 sns-en-description_of_audit_logs_technical_note_v4-12/14/2023
SNS-TECHNICALNOTE
DESCRIPTIONOFAUDITLOGS
ipv VersionoftheIPprotocolusedinthetraffic
Values:“4”,“6”…
Availablefrom:SNSv1.0.0.
IPversion
proto Nameoftheassociatedplugin.Ifthisisnotavailable,thenameofthestandardservice
correspondingtothedestinationport.StringofcharactersinUTF-8format.Example:“http”,
“ssh”
Availablefrom:SNSv1.0.0.
Protocol
src IPaddressofthesourcehost.
Decimalformat.Example:”192.168.0.1”
Maybedisplayedanonymouslydependingontheadministrator'saccessprivileges.
Availablefrom:SNSv1.0.0.
Source