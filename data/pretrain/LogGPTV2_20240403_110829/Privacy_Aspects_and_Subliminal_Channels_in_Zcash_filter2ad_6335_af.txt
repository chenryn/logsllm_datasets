[2] 2014. Monero. https://getmonero.org
[3] 2016. Zcash. https://z.cash/
[4] Elli Androulaki, Ghassan O Karame, Marc Roeschlin, Tobias Scherer, and Srdjan
Capkun. 2013. Evaluating user privacy in bitcoin. In International Conference on
Financial Cryptography and Data Security. Springer, 34–51.
[5] Alex Biryukov, Dmitry Khovratovich, and Ivan Pustogarov. 2014. Deanonymisa-
tion of clients in Bitcoin P2P network. In Proceedings of the 2014 ACM SIGSAC
Conference on Computer and Communications Security. ACM, 15–29.
[6] George Bissias, A Pinar Ozisik, Brian N Levine, and Marc Liberatore. 2014. Sybil-
resistant mixing for bitcoin. In Proceedings of the 13th Workshop on Privacy in the
Electronic Society. ACM, 149–158.
[7] Joseph Bonneau, Arvind Narayanan, Andrew Miller, Jeremy Clark, Joshua A Kroll,
and Edward W Felten. 2014. Mixcoin: Anonymity for Bitcoin with accountable
mixes. In International Conference on Financial Cryptography and Data Security.
Springer, 486–504.
[8] Jens Groth. 2016. On the size of pairing-based non-interactive arguments. In
Annual International Conference on the Theory and Applications of Cryptographic
Techniques. Springer, 305–326.
[9] G. Kappos, H. Yousaf, M. Maller, and S. Meiklejohn. 2018. An Empirical Analysis
of Anonymity in Zcash. ArXiv e-prints (May 2018). arXiv:cs.CR/1805.03180
[10] Amrit Kumar, Clément Fischer, Shruti Tople, and Prateek Saxena. 2017. A trace-
ability analysis of monero’s blockchain. In European Symposium on Research in
Computer Security. Springer, 153–173.
[11] Greg Maxwell. 2013. CoinJoin: Bitcoin privacy for the real world. In Post on
Bitcoin forum.
[12] Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kirill Levchenko, Damon
McCoy, Geoffrey M. Voelker, and Stefan Savage. 2013. A Fistful of Bitcoins:
Characterizing Payments Among Men with No Names. In Proceedings of the 2013
Conference on Internet Measurement Conference (IMC ’13). ACM, New York, NY,
USA, 127–140. https://doi.org/10.1145/2504730.2504747
[13] Sarah Meiklejohn, Marjori Pomarole, Grant Jordan, Kirill Levchenko, Damon
McCoy, Geoffrey M Voelker, and Stefan Savage. 2013. A fistful of bitcoins:
characterizing payments among men with no names. In Proceedings of the 2013
conference on Internet measurement conference. ACM, 127–140.
[14] Ian Miers, Christina Garman, Matthew Green, and Aviel D Rubin. 2013. Zerocoin:
Anonymous distributed e-cash from bitcoin. In Security and Privacy (SP), 2013
IEEE Symposium on. IEEE, 397–411.
[15] Andrew Miller, Malte Möser, Kevin Lee, and Arvind Narayanan. 2017. An
empirical analysis of linkability in the Monero blockchain. arXiv preprint
arXiv:1704.04299 (2017).
[16] Satoshi Nakamoto. 2008. Bitcoin: A peer-to-peer electronic cash system. (2008).
[17] Shen Noether, Adam Mackenzie, et al. 2016. Ring confidential transactions. Ledger
1 (2016), 1–18.
[18] Philippe Oechslin. 2003. Making a Faster Cryptanalytic Time-Memory Trade-Off.
In Advances in Cryptology - CRYPTO 2003, Dan Boneh (Ed.). Springer Berlin
Heidelberg, Berlin, Heidelberg, 617–630.
[19] Torben Pryds Pedersen. 1992. Non-Interactive and Information-Theoretic Se-
cure Verifiable Secret Sharing. In Advances in Cryptology — CRYPTO ’91, Joan
Feigenbaum (Ed.). Springer Berlin Heidelberg, Berlin, Heidelberg, 129–140.
[20] Jeffrey Quesnelle. 2017. On the linkability of Zcash transactions. arXiv preprint
arXiv:1712.01210 (2017).
[21] Fergal Reid and Martin Harrigan. 2013. An Analysis of Anonymity in the Bitcoin
System. Springer New York, New York, NY, 197–223. https://doi.org/10.1007/978-
1-4614-4139-7_10
[22] Fergal Reid and Martin Harrigan. 2013. An analysis of anonymity in the bitcoin
system. In Security and privacy in social networks. Springer, 197–223.
[23] Dorit Ron and Adi Shamir. 2013. Quantitative analysis of the full bitcoin trans-
action graph. In International Conference on Financial Cryptography and Data
Security. Springer, 6–24.
[24] Tim Ruffing, Pedro Moreno-Sanchez, and Aniket Kate. 2014. CoinShuffle: Practical
decentralized coin mixing for Bitcoin. In European Symposium on Research in
Computer Security. Springer, 345–364.
[25] Eli Ben Sasson, Alessandro Chiesa, Christina Garman, Matthew Green, Ian Miers,
Eran Tromer, and Madars Virza. 2014. Zerocash: Decentralized anonymous
payments from bitcoin. In Security and Privacy (SP), 2014 IEEE Symposium on.
IEEE, 459–474.
[26] Gustavus J. Simmons. 1984. The Prisoners’ Problem and the Subliminal Channel.
Springer US, Boston, MA, 51–67. https://doi.org/10.1007/978-1-4684-4730-9_5
[27] Gustavus J. Simmons. 1994. Subliminal Communication is Easy Using the DSA.
In Advances in Cryptology — EUROCRYPT ’93, Tor Helleseth (Ed.). Springer Berlin
Heidelberg, Berlin, Heidelberg, 218–232.
[28] Luke Valenta and Brendan Rowan. 2015. Blindcoin: Blinded, accountable mixes for
bitcoin. In International Conference on Financial Cryptography and Data Security.
Springer, 112–126.
[29] Nicolas van Saberhagen. 2013. Cryptonote v 2.0. (2013). https://cryptonote.org/
whitepaper.pdf
[30] Adam Young and Moti Yung. 2004. Malicious Cryptography: Exposing Cryptovi-
rology. John Wiley &#38; Sons, Inc., USA.
[31] Zuoxia Yu, Man Ho Au, Jiangshan Yu, Rupeng Yang, Qiuliang Xu, and Wang Fat
Lau. 2019. New Empirical Traceability Analysis of CryptoNote-Style Blockchains.
A EXPERIMENTAL RESULTS
In order to provide experimental results for the presented stochastic
model in Section 4, we must gather the relevant statistics from
the chain itself. First, we have investigated the Sapling shielded
transaction set, as that provides a view for us on the usual amount of
shielded inputs and outputs for a shielded transaction. Secondly, we
have observed the public blockchain data to estimate the fingerprint
survival probabilities.
A.1 Notation
For the ease of exposition, we introduce a notation to describe
transactions based on their number of shielded and transparent
inputs and outputs. We denote a Zcash transaction as
(sin · tin | sout · tout )
where sin and sout are the number of shielded inputs and out-
puts, respectively, and similarly, tin and tout are the number of
transparent inputs and outputs.
Depending on the number of shielded and transparent inputs
or outputs, transactions are then divided into hiding t-to-z, fully
shielded z-to-z and revealing z-to-t transactions as follows:
• t-to-z : tin ≥ 1 and sout ≥ 1 and negative balance value (hiding)
• z-to-z: sin ≥ 1 , sout ≥ 1 and tin = tout = 0
• z-to-t : sin ≥ 1 and tout ≥ 1 and positive balance value (revealing)
Few examples are the following transactions: (0·1|1·0) is a hid-
ing t-to-z transaction with 1 transparent input and 1 shielded output;
(1·0|2·0) is a fully shielded z-to-z transaction with 1 shielded input
and 2 shielded outputs; (2·0|1·1) is a z-to-t (partially) revealing
transaction with 2 shielded inputs and 1 shielded and 1 transparent
output.
Session 8C: Blockchain VICCS ’19, November 11–15, 2019, London, United Kingdom1825A.2 Sapling Transactions Dataset
Our transactions dataset includes all hiding, fully shielded and
revealing Sapling transactions occurred from block 419,200 (mined
October 29, 2018 when the official Sapling fork happened) to block
472,285 (mined January 29, 2019).
The distribution of these collected transactions is reported in
Table 2, row All. Since we are mainly interested in transactions
that more likely occur as coin transfers between non-miner users
which are not already linkable with a direct unique value match,
we removed from our starting database the following transactions:
• Mining activities: when a block is successfully mined, the miners
have to transfer their rewards to a shielded address before being
able to spend them, hence creating lots of hiding transactions.
Many miners transfer their shielded mining rewards directly to
transparent addresses, thus creating many revealing transactions.
Using the heuristics from [9] we have been able to trace back
to miners’ public addresses 6,827 hiding t-to-z transactions and
5,718 revealing z-to-t transactions.
• Direct unique value matches: where an hiding transaction is di-
rectly followed by a revealing transaction with same unique value
(Heuristic 1), i.e. the paths
(0·1|1·0)-(1·0|0·1)
We have found 37 such transactions.
• 1-Hop fingerprint matches: the paths
(0·1|1·0)-(1·0|1·0)-(1·0|0·1)
where a hiding transaction with a unique value is directly fol-
lowed by a revealing transaction with a unique value, where the
value difference is equal to 10,000 Zatoshis, the standard transac-
tion fee (Heuristic 2). We have found 676 such transactions.
• Small value transactions: we noticed that while there were 2,436
t-to-z transactions with total transparent value less than 1 ZEC
each (for a total hiding value of 841.74 ZEC), there were only 286
z-to-t revealing transactions with an overall value lower than 1
ZEC (for a total value of 68.76 ZEC). Checking the discrepancy
between these two numbers, we have found that there were 3
transactions of the form (>10·0|0·1) and 25 transactions of the
form (>10·0|1·1), where >10 indicates that there are more than
10 shielded inputs. The total number of shielded inputs of these
28 z-to-t transactions is 1,756 for an average revealed value of
39.97 ZEC (total revealed value 1119 ZEC). Assuming these 28
transactions were independent, the ratio between the revealed
value and the number of shielded inputs is 0.45 ZEC (weighted
median) and 0.64 ZEC (weighted arithmetic mean). Since the
Zcash official wallet, when combining spends, takes them in
decreasing value order, we speculate that these spends are mainly
small value spends (less than 1 ZEC) which are collected and
eventually combined with few higher value ones9 before being
transferred to a transparent address. Our speculation is enforced
by the fact that in 25 transactions out of 28, the revealed values
are round, e.g. 3, 5, 30, 35, 40, 50, 120 ZEC. In other words, there
are many small values which are collected and then spent as soon
as their total value is close to certain round amount of ZEC. Due
to their unusual high number of combined shielded inputs, we
suspect that these transactions are related to mining activities
(e.g. transparent fractions of mining rewards that are shielded
and sent to mining pool members) and can be then traced back to
t-to-z transactions whose total value is less than 1 ZEC. Thus we
have opted to not consider 2,436 small value t-to-z transactions10
and 314 z-to-t transactions.
All these dataset updates are summarized in Table 2 resulting
after all the removals in 1,613 t-to-z hiding, 1,570 fully shielded and
1,633 revealing transactions. The distribution of different types of
transaction in the final dataset is reported in Table 3.
Assuming that all t-to-z transactions are independent, we can
then approximate the average number of transaction-hops Zlen
for a generic path in the shielded pool as the ratio between the
sum of all transactions types that have at least 1 shielded input and
1 shielded output and all the t-to-z transactions. We then obtain
Zlen ≈ 1.42.
A path in the shielded pool goes through transaction-hops that
have at least one shielded input and one shielded output: in Table 4
we reported the most frequent types of these transactions (≈ 95.8%)
among with their distribution and the corresponding survival prob-
ability of good fingerprints observed in all public blockchain data.
More precisely, given a transaction (sin · tin | sout · tout ) hap-
pening in the shielded pool, we set the corresponding survival
probability of a good fingerprint to be equal to the fingerprint sur-
vival probability observed in the transparent transaction of the
same input-output degree (0· sin +tin | 0· sout +tout ) multiplied
by the probability that the fee ends with 4 zeroes (≈ 96.8%), i.e. the
fee doesn’t affect the fingerprint.
Similarly, we report in Table 5 the relative distribution and sur-
vival fingerprint probabilities for the most frequent exit nodes
(≈ 96.9%), i.e. revealing z-to-t transactions.
Given a path x = x1 − ... − xn − xn+1 ∈ ZPaths(n + 1), where
x1, . . . , xn, are transactions inside the shielded pool while xn+1 is
a revealing transaction, it is now straightforward to estimate both
P(F P | x) and P(x) and, ultimately, P(F P).
Indeed, assuming each transaction independent and considering
only paths x made by the most frequent types of transactions, we
i =1 p(xi)(cid:17) · (0.958n · 0.969),
(cid:16)n+1
i =1 P(xi) =
where p(xi) denotes the probability to have a transaction type
equal to xi, i.e. the values in column “%” of Table 4 and 5. Similarly,
i =1 pF P(xi), where pF P(xi) denotes the fingerprint
survival probability for transaction xi, which are again reported in
Table 4 and 5.
Letting ZPaths′(n + 1) ⊂ ZPaths(n + 1) be the set of paths con-
sisting of the most frequent transactions types reported in Table 4
and 5 and modeling P(Z = n) = Zlenn ·e−n
by a Poisson distribu-
tion with parameter Zlen, we obtain an estimation for the overall
fingerprint survival probability as:
n!
have that P(x) = n+1
P(F P | x) =n+1
(cid:33)
P(F P | x) · P(x)
P(F P) ≈ k
n=0
Zlenn · e−n
n!
·
(cid:32) 
x ∈Z Paths′(n+1)
Letting k = 5 we obtained P(F P) ≈ 16.6%
9This could also explain why the revealed value of 1,119 ZEC is greater than 841.74
ZEC, the overall total hidden value of small value t-to-z transactions
10It is not statistically relevant which ones are removed, since 99.8% of t-to-z transaction
are of the single input-single output form: (0·1|1·0).
Session 8C: Blockchain VICCS ’19, November 11–15, 2019, London, United Kingdom1826All
Remove Mining
Remove Direct Matches
Remove 1-hop Matches
Remove Small Values
t-to-z
11,589
4,762
4,725
4,049
1,613
z-to-z
2,246
2,246
2,246
1,570
1,570
z-to-t
8,408
2,690
2,653
1,977
1,663
Table 2: Number of transactions after each corresponding
dataset update.
t-to-z
Type
(0·1|1·0)
(0·t|s·0)
(s·t|s·0)
#
1,594
15
4
z-to-z
Type
(1·0|1·0)
(1·0|2·0)
(2·0|2·0)
(2·0|1·0)
(3·0|1·0)
(3·0|2·0)
(s·0|s·0)
#
699
491
176
78
36
21
69
Total
1,613
1,570
z-to-t
Type
(1·0|0·1)
(1·0|1·1)
(2·0|0·1)
(2·0|1·1)
(3·0|0·1)
(3·0|1·1)
(s·t|0·t)
(s·t|s·t)
#
664
504
224
129
54
36
31
21