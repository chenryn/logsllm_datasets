前5大其它端口：
  * 80
  * 443
  * 8080
  * 8443
  * 22
## 研究成果
如上所见，很多设备在端口80、443或8080都暴露了管理面板。远程技术人员可以在不必实际到达现场的情况下接触管理设备。然而，从安全的角度来看，这个解决方案应该增加其它措施。默认或弱密码是对工控设备或物联网设备最常见也最不负责任的做法。开源情报同时也包括阅读文档和系统指南以获取相关运作情况以及应该使用哪些功能以获取更多信息或完整的访问权限。
已知默认凭证的完整清单见：
> 
有很多面板在不安全的端口80或8080运行。
另外，也可从登陆面板获取其它有价值的线索，其中包括站点名称、组织机构或工厂的图片，这样我们就能将结果缩小到某个具体的品牌。
某些设备暴露了无需认证即可发现的自身的网络配置、诊断信息、统计数据或设置。这是另外一种指标，可以帮助我们获取所运行基础设施的完整图片。
如果某人已经建立了对网络的访问权限并查找潜在的工控设备，那么所暴露的信息就能够起到重要作用，它包括IP地址、子网掩码、网关地址或名称服务器。在很多情况下我看到使用外部
DNS 系统，从而为多种不同的攻击敞开大门。
在工控设备上运行无需认证的 VNC
也并非最佳想法。这是根本不应该发生的事情，这是个明显的错误或者表明对自己的基础设施缺乏了解。从攻击者的角度来看这简直是小菜一碟——他无需验证即可获得访问权限并完全控制该设备。当然，我们不会将其称为攻陷整个设施但它肯定是一个好的开端。所有的VNC都在端口5900上以人机交互
(HMI) 的身份运行。
VNC 并非设备可能暴露的唯一方式；某些制造商设备上的端口80在无需验证的情况下返回 HMI。其中某些网站要求登录进行交互但它并非必需步骤。
你可能注意到了，判断某个建筑物或设施的连接和地理定位信息的另外一个指标是 HMI。HMI
本身披露了对设备的使用，因此很容易判断出是洗车场某个废水处理厂的设备。屏幕上显示的技术和品牌也披露出很多规格以及设备的用途。
地理定位要仅针对关键基础设施发动攻击，我们需要排除不具备战略意义的设备。例如，管理公园喷泉的设备可能遭暴露但攻陷它并不会带来任何利益，因此对于任何人而言它都不是关键基础设施。那么，如何找到负责关键基础设施的设备和建筑物？你可以使用生成的地图并查看目标附近的每台设备如城市或政府建筑物。第二种方法就是通过逆向工程查找设备的部件如车站名称、说明或未知。如上所述，Niagara
Fox 和 BACnet
有时候会披露不该披露的信息，包括街道名称、未知或设施的名称。结合其它指标信息，我们就能找到正确的建筑物。IP地理定位也并不一定是精确的，它不会指向确切的位置但能够准确地显示出城市，而且有些时候能够显示出该设备可能位于哪条街道。为了验证我的说法，我将列举一些案例，说明我如何通过利用所收集的信息找到对某国或某城市而言具有战略意义的建筑物。水和废水系统行业如上所述，水和废水系统行业也属于关键基础设施。当它们遭到破坏时，我们将无法获取饮用水从而引发企业和社会问题。在这个案例中，Niagara
Fox 设备的“station.name”字段中披露了设施的名称。
IP 地理定位指向佛蒙特州伯林顿的夏日街道14号 (IP geolocation points to 14 Summer Street
inBurlington, Vermont)，距离最近的废水工厂1.5英里。
有了这个信息后，下一步就是通过扫描资产和查找网络上的更多资产来准备实施物理监控和主动收集情报。化学制品行业当你管理很多站点时，你必须知道站点连接到何处。这个案例表明舒适是安全的大敌。该站点的位置被暴露在设备中，而且甚至不需要正确的地理定位就能获取该建筑物的位置信息。
“station name”包含了所在地“珍珠河” (Pearl River)、所在州“纽约” (New York) 和组织机构名称“辉瑞”
(Pfizer)。
从他们的官方网站来看，我们获悉它是辉瑞的九大主要研发站点之一。
医疗行业所有医院的设备都非常脆弱而且服务破坏可导致出诊顺序紊乱或者引发不可挽回的健康问题如死亡等。这些设施应该执行特殊的安全控制并不允许远程连接。医疗行业错误配置的一个例子是
Piedmont医院。在本案例中，确切位置遭暴露——街道、城市和所在州。
这是测试地理定位能力的很好的一个例子——了解设备的确切位置后我们就能查看IP地理定位是否准确。
在本案例中，距离目标3.5英里远——西春街 2151号 (2151 West Spring Street)。
在一些案例中，你可以从官方网站上看到建筑物的内部情况，每层楼和每个房间都一览无余，包括会议室、存储和工厂运作等。它是我们获取精确情报信息的又一个指标。你可以看出如果了解了该设施的内部情况会掌握多少有价值的信息。有人可能能够连接到该设备并实施破坏，当然这也取决于俄设备的实际用途。
能源行业能源行业非常具体，因为它高度依赖于其它行业如制造业或政府设施。没有稳定的能源供应，社会和企业就无法正常运转。基于此前的网络攻击的情况来看，它是遭受攻击最多的行业之一，例如乌克兰电力网遭到攻击后导致停电数小时并可能使所有城市瘫痪。有时候，我们无法确定IP地理定位信息，它只是指向某个国家的中心。如果不存在其它之标的，我们就无法找到它的位置信息。
“station name”清楚地说明了设施的名称以及设备可能具备的功能“核心”。
温斯顿·塞勒姆（Winston-Salem）有一家著名的发电厂，最近进行了翻新并举办了许多活动。
制造业/国防工业基地行业很多国防承包商都协助处理机密材料、制造设备或以其它方式进行合作。如果他们的系统遭暴露，那么就会危害国家安全。确定地理位置后，我们就能找到该公司的名称，从而找到某个设施。
地理定位指向宾夕法尼亚州的克拉克斯峰 (Clarks Summit)。最近的洛克希德·马丁 (Lockheed Martin) 公司距离11英里。
从官网可获得关于该具体设施及其作用的相关信息。
对比该研究结果和谷歌地图提供的真实视图，我们可以从官网找到这个建筑物。
我将以上提及的研究成果都告知相关组织机构，但并未收到任何回复。
## 总结
即使是老练的网络工程师，维护关键基础设施和工控设备的安全也并非易事，而且错误时时都在发生。当在建造基础设施时未考虑安全性，那么就会将其暴露于网络攻击和间谍活动中，尤其是当你在其中任何一个关键行业行动时。任何针对设施的网络攻击可能引发愤怒、给企业造成金钱损失甚至导致命案，我们需要认识到，这些行业相互依存而且是所有人日常生活的必需品。我总结了为何暴露在互联网上的工控设备如此多的四种原因：
  * 某些设备是用于追踪威胁行动者的蜜罐——研究人员设置模拟工控基础设施的陷阱以查看追逐这类型设备的人员以及在侦查和攻击阶段所使用的战术、技术和程序 (TTPs)。其中一个 ICS/SCADA 蜜罐例子是 Conpot。
  * 技术人员偷懒——参与工控设备安装的技术通常允许远程连接，这样技术人员就不必在每次需要更改配置时实际到达现场。
  * 错误配置——每个人都会出错，而错误的防火墙设置可能是设备遭暴露的罪魁祸首之一。然而，追踪这些错误并及时做出反应起着重要作用。
  * 金钱——它和前一个“偷懒”的原因相关。每次技术人员到访现场都会产生支出。组织机构想要节约一切可节约的钱财，通常这个被节约的领域就是安全。
  * 很遗憾，我们无法预知所有的事情，但我们可以积极地对抗可能暴露设施或设备信息的错误信息行为。当然，当设备被暴露在互联网上时，就可能招来各种攻击，从脚本小子到有经验的脚本小子不一而足。
但我们可以采取一些防范措施：
  * 执行信息分类计划——威胁行动者实施间谍或侦查活动使用的详情是什么？这种数据应该限制访问权限且设置为无法公开获取；
  * 维护详尽的清单——持续记录环境中发生的变化并试着理解潜在的外部攻击向量；
  * 主动监控——监控外围网络安全设备并利用主动侦查技术（如端口扫描）
  * 使用开源情报收集——收集尽可能多的关于攻击者可能用于攻击基础设施的信息。地理定位数据、设备详情或个人数据对于威胁行动者而言都是有价值的信息。尝试了解任何危害设施安全的方法。
## 结论
本研究仅展示了可能构成关键基础设施的2.6万台设备中的5个设备案例。这些设施提供的设备或服务确保国家的持续性并发挥着重要的社会作用。在商业行业的情况下，企业有责任确保自身网络的安全，但对于关键基础设施而言，保护它的安全事关公众利益。利用情报收集方法可以特别关注所在国的关键基础设施，了解威胁行动者可能会收集哪些信息。另外，本文所展示的方法可用于收集对手网络潜力和能力数据以及关键基础设施的战略位置。参考资料及补充资料
>  story-archive/open-source-intelligence.html>
>
> 
>
>  report-when-the-lights-went-out.pdf>
>
> 
>
> 
Kamerka 地址：
原文链接
题图：Pixabay License
本文由奇安信代码卫士编译，不代表奇安信观点，转载请注明“转自奇安信代码卫士 [www.codesafe.cn](www.codesafe.cn)”