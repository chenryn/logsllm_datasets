ceived by remote networks.
We examine ISC report summaries for several scans from
Table 4. These summaries are compiled daily for each service
(e.g., HTTP) and consist of the number of scanned targets,
scanning hosts that targeted that service, and the ratio of
packets that are TCP. We are particularly interested in the
ﬁrst metric as all reports related to our 24-hour scans should
be contained in a single data point.
We downloaded summary data from ISC for one month
surrounding a sample of our HTTP, EPMAP, DNS, and
ECHO scans (i.e., 15 days prior and after). The result is
plotted in Figure 5, where the x-axis labels days in the
30-day window surrounding each scan and the highlighted
points represent the days our scanner was actively probing
that particular port. We happened to scan both HTTP in
part (a) and EPMAP in part (b) on days when ISC expe-
rienced roughly a third of its peak number of daily reports
(i.e., 27K compared to 80 − 90K), which is nevertheless an
huge number. The ﬁgure also shows that EPMAP clearly
stands out as being scanned with a consistently high amount
of daily traﬃc.
4
x 10
10
s
t
r
o
p
e
r
7.5
5
2.5
4
x 10
10
s
t
r
o
p
e
r
7.5
5
2.5
0
1
9
17
day
25
1
0
15
23
1
day
9
16
(c) DNS (May 08)
(d) ECHO (June-July 08)
Figure 5: ISC reports with our scans marked.
In contrast, parts (c) and (d) for DNS and ECHO show
that IRLscanner spiked report levels well above those of sur-
rounding days. In fact, in the case of ECHO we produced
an extremely anomalous event, raising the total from al-
most zero to 50K. Our activity on that port created con-
cerns among network administrators that a new exploit was
under way and/or a virus outbreak was in progress. All this
eventually drew the attention of one of the traﬃc monitors
at ISC, who wrote an explanatory blog post to calm down
the ISC community.
Given the large amount of background noise from many
scanning sources (whose totals ISC also makes available) in
parts (a) and (b) of Figure 5, we conjecture that network
administrators are more likely to react only to traﬃc that
clearly stands out (i.e., makes its presence known by its high
signal-to-noise ratio) rather than to scans on sensitive ports.
This is conﬁrmed by the fact that attack-reconnaissance port
135 generated the least number of complaints and that the
ECHO port, which inherently represents little real threat to
administrators due to the lack of hosts oﬀering this service
and heavy ﬁrewall ﬁltering, produced an unusually strong
blowback. This relationship where higher background scan
traﬃc seems to imply fewer complaints might beneﬁt re-
searchers considering scans on sensitive/popular ports in the
future.
5.3 Enumerating Contributors
It is well-known [6], [48] that the contributors to ISC and
other ﬁrewall log correlation systems are vulnerable to los-
ing their anonymity due to the nearly real-time public dis-
play of ﬁrewall reports with only the destination IP address
omitted. Several techniques for correlating reports with tar-
geted subnets (which is called contributor enumeration) have
been proposed [6]; however, they require tens of billions of
packets, allow for false positives, and consume multiple days
during full enumeration.
Given our high-performance scanner that is capable of lo-
cally using multiple IP addresses, a much simpler attack
preys on the source port, destination port, and source IP ad-
120dress reported in detailed ISC logs, which are displayed for
all scanning hosts that ISC tracks. Probing each address in
BGP set B with a unique combination of source/destination
ports and source IP eliminates the possibility of false posi-
tives and the need to send any extra packets beyond those in
B. This can be accomplished for the current 2.1B hosts with
128 source IPs by simply rotating through all 64K source
ports and roughly 250 destination ports, which can be hand-
picked from the most-scanned lists to minimize the likeli-
hood of raising suspicion. However, by removing the source
port from the public report, ISC can render this technique
largely ineﬀective.
5.4 ACK Scans
To prepare their subnet’s data for submission to ISC,
many network administrators rely on ﬁrewall log analyzers
such as psad [44] to separate scan traﬃc from innocuous
packets dropped by the ﬁrewall. During our analysis, we
discovered that many such tools ignore ACK packets, which
suggests that network administrators often do not consider
them to be particularly dangerous. To leverage this intu-
ition, we propose a scan technique for cases where ﬁnding
the majority of hosts in open set O, while signiﬁcantly re-
ducing IDS detection, is beneﬁcial (e.g., for rarely scanned
ports).
The ﬁrst phase of the technique is a simple ACK scan
to every host in B, which eﬀectively discovers the subset of
hosts that are not heavily protected by stateful ﬁrewalls. For
every RST received, we verify that it has not been previously
probed using a hash table and then immediately send it a
SYN packet to establish whether the service is open or not.
By only targeting hosts that previously responded, this type
of scan reduces the SYN footprint by 94% for HTTP. We
performed a single test measurement (HTTPAS in Table 4),
which discovered 31.7M of the 44M total responsive hosts,
while requiring only 125M SYN packets to be sent. ISC data
shows only 4, 746 reports for our IPs during HTTPAS com-
pared to 29, 869 reports collected for HTTP2, which used
the same T and m. This is signiﬁcant as it amounts to an
84% decrease in the perceived intrusiveness of the scan.
5.5 DNS Lookups
We now turn to the last form of feedback we consider in
this paper. While whois lookups seem to be the predominate
form of reconnaissance performed by remote network ad-
ministrators and individuals when they detect a scan, many
specialized tools augment IDS reports and ﬁrewalls logs with
DNS lookups on oﬀending IPs to provide more information
on the scanning host to the user. While for large networks
this functionality should be disabled (as it allows remote
hosts to DoS the network by loading it up with billions of
useless DNS lookups), many personal ﬁrewalls and small
subnets implement some form of it.
We tested the frequency of these additional lookups by col-
lecting all incoming requests for IP addresses and hostnames
at our locally controlled authoritative DNS server. To en-
sure that each request initiated by a remote entity contacted
our nameserver, we set the DNS TTL to zero for both the
reverse and forward lookups on scanner IPs/hostnames. Af-
ter doing so, no RFC compliant nameserver should maintain
our records in their cache.
The result of this collection process for three HTTP scans
is contained in Table 11, which lists the number of reverse
Scan
HTTP2
HTTP3
HTTP6
Reverse
3.03M
2.89M
2.85M
Forward Req/sec
85.4K
80.1K
66.3K
36
34
33
Servers
47.8K
48.2K
49.2K
Table 11: DNS lookups on scanner source IPs.
lookups for the IP addresses themselves and forward lookups
on the names returned by those queries. We made sure
that these IP addresses were not used for any other purpose
but scanning and their names were not publicized beyond
the project web-site. Therefore, forward lookups are almost
certainly due to the common veriﬁcation technique of deter-
mining the consistency between the forward and the reverse
response. While the number of requests slightly declined
for each subsequent scan, the last column shows that the
number of unique servers in each dataset had the opposite
trend. The decline in lookup rates can be attributed to ran-
dom noise, long-term caching at non-compliant DNS servers,
and users growing tired of looking up our IPs.
It should be noted that performing DNS queries on scan-
ner IPs potentially reveals the location of the IDS tool unless
steps are taken to increase anonymity (e.g., using a DNS for-
warding service at some distant location). The three scans
in Table 11 have identiﬁed 64K unique DNS servers, out of
which 35K were present in each dataset. Further analysis of
this data is deferred to future work.
6. CONCLUSION
In this paper, we designed novel algorithms for maxi-
mally polite Internet scanning and documented our expe-
rience through extensive service-discovery statistics based
on our implementation of the proposed methods. Future
work involves exploring methods for reducing B to avoid
scanning unproductive networks, expanding RLCG/RR to
provide optimal spacing for multiple destination ports (i.e.,
in hybrid vertical/horizontal scanning), and more in-depth
analysis of scan data.
7. ACKNOWLEDGMENT
We are grateful to the Network Security team at Texas
A&M University for their helpful discussions and profes-
sional handling of network administrator complaints.
8. REFERENCES
[1] M. Allman, W. M. Eddy, and S. Ostermann, “Estimating
loss rates with TCP,” ACM Performance Evaluation
Review, vol. 31, pp. 12–24, 2003.
[2] M. Allman, V. Paxson, and J. Terrell, “A Brief History of
Scanning,” in Proc. ACM IMC, Oct. 2007, pp. 77–82.
[3] G. Bartlett, J. Heidemann, and C. Papadopoulos,
“Understanding Passive and Active Service Discovery,” in
Proc. ACM IMC, Oct. 2007, pp. 57–70.
[4] H. Bauke and S. Mertens, “Random numbers for large-scale
distributed Monte Carlo simulations,” Phys. Rev. E,
vol. 75, no. 6, p. 066701, 2007.
[5] D. Benoit and A. Trudel, “World’s First Web Census,” Intl.
Journal of Web Information Systems, vol. 3, no. 4, pp.
378–389, 2007.
[6] J. Bethencourt, J. Franklin, and M. Vernon, “Mapping
Internet Sensors with Probe Response Attacks,” in Proc.
USENIX Security, Jul. 2005, pp. 193–208.
[7] Bro IDS. [Online]. Available: http://bro-ids.org/.
121[8] H. Burch and B. Cheswick, “Mapping the Internet,” IEEE
Computer, vol. 32, no. 4, pp. 97–98,102, 1999.
[9] M. Casado, T. Garﬁnkel, W. Cui, V. Paxson, and
S. Savage, “Opportunistic Measurement: Extracting Insight
from Spurious Traﬃc,” in Proc. HOTNETS, Nov. 2005.
[10] Z. Chen and C. Ji, “Optimal Worm-Scanning Method using
Vulnerable-Host Distributions,” ACM IJSN, vol. 2, no. 1/2,
pp. 71–80, Mar. 2007.
[11] B. Cheswick, H. Burch, and S. Branigan, “Mapping and
Visualizing the Internet,” in Proc. USENIX Annual
Technical Conference, Jun. 2000, pp. 1–12.
[12] Team Cymru. [Online]. Available:
http://www.team-cymru.org/Services/Bogons/.
[13] D. Dagon, N. Provos, C. P. Lee, and W. Lee, “Corrupted
DNS Resolution Paths: The Rise of a Malicious Resolution
Authority,” in Proc. NDSS, Feb. 2008.
[14] L. Deri and F. Fusco, “Exploiting Commodity Multicore
Systems for Network Traﬃc Analysis,” Jul. 2009. [Online].
Available:
http://ethereal.ntop.org/MulticorePacketCapture.pdf.
[15] R. Govindan and H. Tangmunarunkit, “Heuristics for
Internet Map Discovery,” in Proc. IEEE INFOCOM, Mar.
2000.
[16] B. He, M. Patel, Z. Zhang, and K. C.-C. Chang, “Accessing
the Deep Web,” Comm. of the ACM, vol. 50, no. 5, pp.
94–101, 2007.
[17] J. Heidemann, Y. Pradkin, R. Govindan, C. Papadopoulos,
G. Bartlett, and J. Bannister, “Census and Survey of the
Visible Internet,” in Proc. ACM IMC, Oct. 2008, pp.
169–182.
[18] Geoﬀ Huston. [Online]. Available: http://bgp.potaroo.net.
[19] IANA, “IPv4 Global Unicast Address Assignments.”
[Online]. Available:
http://www.iana.org/assignments/ipv4-address-space/.
[20] IANA, “Special-Use IPv4 Addresses,” IETF RFC 3330,
Sep. 2002.
[21] IRL Internet-Wide Fingerprinting Dataset. [Online].
Available: http://irl.cs.tamu.edu/projects/sampling/.
[22] B. Irwin and J. P. van Riel, “Using InetVis to Evaluate
Snort and Bro Scan Detection on a Network Telescope,” in
Proc. IEEE VizSEC, Oct. 2007, pp. 255–273.
[23] ISC Internet Domain Survey. [Online]. Available:
http://www.isc.org/index.pl?/ops/ds/.
[24] Juniper IDP. [Online]. Available: http://www.juniper.net/.
[25] M. G. Kang, J. Caballero, and D. Song, “Distributed
Evasive Scan Techniques and Countermeasures,” in Proc.
DIMVA, Jul. 2007, pp. 157–174.
[26] D. Knuth, The Art of Computer Programming, Vol. II,
2nd ed. Addison-Wesley, 1981.
[27] A. Langley, “Probing the Viability of TCP Extensions,”
Google, Inc., Tech. Rep., Sep. 2008.
[28] S. Lawrence and C. L. Giles, “Accessibility of Information
on the Web,” Intelligence, vol. 11, no. 1, pp. 32 ˝U–39, 2000.
[29] D. H. Lehmer, “Mathematical Methods in Large-Scale
Computing Units,” in Proc. Large-Scale Digital Calculating
Machinery, 1949, pp. 141–146.
[30] Z. Li, A. Goyal, Y. Chen, and V. Paxson, “Automating
Analysis of Large-Scale Botnet Probing Events,” in Proc.
ACM ASIACCS, Mar. 2009, pp. 11–22.
[31] P. K. Manna, S. Chen, and S. Ranka, “Exact Modeling of
Propagation for Permutation-Scanning Worms,” in Proc.
IEEE INFOCOM, Apr. 2008, pp. 1696–1704.
[32] S. McClure, J. Scambray, and G. Kurtz, Hacking Exposed:
Network Security Secrets & Solutions, 5th ed.
McGraw-Hill/Osborne, 2005.
[33] A. Medina, M. Allman, and S. Floyd, “Measuring the
Evolution of Transport Protocols in the Internet,” ACM
SIGCOMM Comp. Comm. Rev., vol. 35, no. 2, pp. 37–52,
Apr. 2005.
[34] X. Meng, Z. Xu, B. Zhang, G. Huston, S. Lu, and
L. Zhang, “IPv4 Address Allocation and the BGP Routing
Table Evolution,” ACM SIGCOMM Comp. Comm. Rev.,
vol. 35, no. 1, pp. 71–80, 2005.
[35] D. Moore, V. Paxson, S. Savage, C. Shannon, S. Staniford,
and N. Weaver, “Inside the Slammer Worm,” IEEE S&P,
vol. 1, no. 4, pp. 33–39, 2003.
[36] myNetWatchman – Network Intrusion Detection and
Reporting. [Online]. Available:
http://www.mynetwatchman.com/.
[37] Netcraft Web Server Survey. [Online]. Available:
http://news.netcraft.com/.
[38] NetVCR. [Online]. Available: http://www.niksun.com/.
[39] Nmap. [Online]. Available: http://nmap.org/.
[40] J. Padhye and S. Floyd, “On Inferring TCP Behavior,” in
Proc. ACM SIGCOMM, Aug. 2001, pp. 287–298.
[41] R. Pang, V. Yegneswaran, P. Barford, V. Paxson, and
L. Peterson, “Characteristics of Internet Background
Radiation,” in Proc. ACM IMC, Oct. 2004, pp. 27–40.
[42] N. Provos and P. Honeyman, “ScanSSH - Scanning the
Internet for SSH Servers,” in Proc. USENIX LISA, Dec.
2001, pp. 25–30.
[43] Y. Pryadkin, R. Lindell, J. Bannister, and R. Govindan,
“An Empirical Evaluation of IP Address Space Occupancy,”
USC/ISI, Tech. Rep. ISI-TR-2004-598, Nov. 2004.
[44] Psad: Intrusion Detection and Log Analysis with Iptables.
[Online]. Available: http://www.cipherdyne.org/psad/.
[45] K. K. Ramakrishnan, S. Floyd, and D. Black, “The
Addition of Explicit Congestion Notiﬁcation (ECN) to IP,”
IETF RFC 3168, Sep. 2001.
[46] Route Views Project. [Online]. Available:
http://www.routeviews.org/.
[47] SANS Internet Storm Center – Cooperative Network
Security Community. [Online]. Available:
http://isc.sans.org/.
[48] Y. Shinoda, K. Ikai, and M. Itoh, “Vulnerabilities of Passive
Internet Threat Monitors,” in Proc. USENIX Security, Jul.
2005, pp. 209–224.
[49] M. Smith and D. Loguinov, “Enabling High-Performance
Internet-Wide Measurements on Windows,” in Proc. PAM,
Apr. 2010, pp. 121–130.
[50] Snacktime: A Perl Solution for Remote OS Fingerprinting.
[Online]. Available:
http://www.planb-security.net/wp/snacktime.html.
[51] Snort IDS. [Online]. Available: http://www.snort.org/.
[52] S. Staniford, J. A. Hoagland, and J. M. McAlerney,
“Practical Automated Detection of Stealthy Portscans,”
Computer Security, vol. 10, no. 1–2, pp. 105–136, 2002.
[53] S. Staniford, V. Paxson, and N. Weaver, “How to 0wn the
Internet in Your Spare Time,” in Proc. USENIX Security,
Aug. 2002.
[54] B. Veal, K. Li, and D. Lowenthal, “New Methods for
Passive Estimation of TCP Round-Trip Times,” in Proc.
PAM, Mar. 2005, pp. 121–134.
[55] F. Veysset, O. Courtay, and O. Heen, “New Tool And
Technique For Remote Operating System Fingerprinting,”
Intranode Software Technologies, Tech. Rep., Apr. 2002.
[56] Z. Yao, D. Leonard, X. Wang, and D. Loguinov, “Modeling
Heterogeneous User Churn and Local Resilience of
Unstructured P2P Networks,” in Proc. IEEE ICNP, Nov.
2006, pp. 32–41.
[57] F. V. Yarochkin, O. Arkin, M. Kydyraliev, S.-Y. Dai,
Y. Huang, and S.-Y. Kuo, “Xprobe2++: Low Volume
Remote Network Information Gathering Tool,” in Proc.
IEEE/IFIP DSN, Jun. 2009, pp. 205–210.
[58] J. Zhang, P. Porras, and J. Ullrich, “Highly Predictive
Blacklisting,” in Proc. USENIX Security, Jul. 2008, pp.
107–122.
[59] C. C. Zou, D. Towsley, W. Gong, and S. Cai, “Routing
Worm: A Fast, Selective Attack Worm based on IP Address
Information,” in Proc. IEEE PADS, Jun. 2005, pp. 199–206.
122