Smart Contract Hacking
Konstantinos Karagiannis
CTO, Security Consulting, BT Americas
@KonstantHacker
when transactions aren’t enough
• “The key 
component is this 
idea of a Turing-
complete 
blockchain”
• --Vitalik Buterin
meow—putting that computing to use
smart contracts
billions, or just millions, of reasons
problem isn’t going away
Solidity
dev tools
• .sol files > bytecode > blockchain
• Atom with plugins:
• language-ethereum
• etheratom
• Remix: browser based
oyente and Manticore
MAIAN
basic methodology
• Interview devs
• Review .sol file
• Try compiling
• Dissect code flow
• Run oyente (cross fingers)
• Run Manticore
• Run MAIAN
• Manually check for following vulns…
reentrancy
leave off the first “re-” for savings
reentrancy (and irony) in the dao code
default public – Parity wallet hack
initWallet
execute
Parity multisig wallet hack 2
Parity 2 transactions
not going with the (over)flow
2256 -1
unchecked send in king of the ether
unchecked send
gas limits
withdraw don’t send
withdrawn not sent
encryption
transaction-ordering dependence
transaction-ordering dependence
call-stack depth limit
variable or function ambiguity
odds and ends
• Timestamp dependence
• Business logic flaws
• Separating public/private 
data
things might be getting better?
keep in touch
@KonstantHacker