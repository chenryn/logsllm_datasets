prot opt source
destination
ACCEPT
α11
anywhere
ctstate RELATED,ESTABLISHED
ACCEPT
α11
anywhere
anyrhere
INPUr_direct al1
anywhere
anywhere
INPUT_ZONES_SOURCE al1
anywhere
anywhere
INPUT_ZONES
al1
anywhere
anywhere
DROP
α11
anywhere
anywhere
ctstate INVALID
REJECT
α11
anywhere
anywhere
reject=vith icmp-host=prohibited
Chain FORMARD (policy ACCEPT)
target
prot opt source
destination
ACCEPT
a11
--anywhere
anywhere
ctstate RELATED,ESTABLISHED
ACCEPT
α11
==anywhere
anywhere
FORWARD_direct all == anywhere
anywhere
FORWARD_IN_ZONES_SOURCE a11==
anywhere
anyrhere
FORWARD_IN_zONES al1==anywhere
anywhere
---
## Page 172
RD_OUT_20
FORWARD_OUT_ZONES
a11
anyvhere
anywhere
DROP
a11
==
anywhere
anywhere
ctstate INVALID
REJECT
a11
==
anywhere
anywhere
reject=vith icmp-host=prohibited
Chain OUrpUT (policy ACCEPT)
target
prot opt source
destination
ACCEPT
a11
anywhere
anywhere
OUTPur_direct a11
==
anyvhere
Chain FORKARD_IN_ZONES (1 references)
target
prot opt source
destination
FNDI_publical1==
anywhere
anyvhere
[goto]
FHDI_publieal1==
anywhere
anywhere
[goto]
Chain FORWARD_IN_ZONES_SOURCE (1 references)
target
prot opt source
destination
Chain FORKARD_OUT_zONES (1 references)
target
prot opt source
destination
FNDO_pub1ic
anywhere
anywhere
[goto]
FWDO_pub1ic
a11
anywhere
anywhere
[goto]
Chain FORMARD_OUr_zONES_SOURCE (l references)
target
prot opt source
destination
Chain FORKARD_direct (1 referenc
(sa=
target
prot opt source
destination
Chain FWDI_public (2 references)
target
prot opt source
destination
FHDI_public_log all == anywhere
anywhere
FHDI_public_deny al1 ==  anywhere
anyrhere
FHDI_public_allov al1  == anywhere
anywhere
ACCEPT
icmp ==
anywhere
anywhere
Chain FWDI_public_allow (1 references)
target
prot opt source
destination
Chain FWDI_public_deny (1 references)
target
prot opt source
destination
Chain FWDI_public_log (1 references)
target
prot opt source
destination
Chain FWDo_public (2 references)
target
prot opt source
destination
FHDO_public_log all == anywhere
anyvhere
FWDO_public_deny  al1 -- anywhere
anywhere
FHDO_public_allov al1 == anywhere
anywhere
Chain FwDo_public_allow (l references)
---
## Page 173
Chain FWDo_public_deny (1 references)
target
prot opt source
destination
Chain FWDo_publie_log (1 references)
target
prot opt source
destination
Chain INPUT_zoNES (1 references)
target
prot opt source
destination
IN_public
a11
==anywhere
anywhere
[goto]
IN_public a11
=
anywhere
anywhere
[goto]
Chain INPUT_zONES_SOURCE (1 referen
target
prot opt source
destination
Chain INPUT_direct (1 references)
target
prot opt source
destination
Chain IN_public (2 references)
target
prot opt source
destination
IN_public_log all -- anywhere
anywhere
IN_public_deny all  == anywhere
anywhere
IN_public_allow all - anywhere
anyvhere
ACCEPT
icmp ==anywhere
anywhere
Chain IN_publie_allov (1 refere
(s
target
prot opt source
destination
ACCEPT
tcp
==anywhere
anywhere
tcp dptissh ctstate NEW, UNrRACKED
ACCEPT
udp
anywhere
224.0.0.251
udp dptimdns ctstate
NEW, UNTRACKED
Chain IN_public_deny (1 references)
target
prot opt source
destination
Chain IN_public_log (l references)
target
prot opt source
destination
Chain ourrur_direct (1 references)
target
prot opt source
destina
0x22密码填充检查
如果攻击者对/etc/passwd文件有写的权限，可以直接在密码字段处填写密码，之后便可以直接使用这个密码进行登录
x。△=daxbJ=.1P=4ns|pnssed/osa/eo
[Ubuntu Server 16.04】默认情况
---
## Page 174
helperelocalhost:-S
-f21grep-v
helperelocalhost:-s
【Centos7】默认情况
[helperelocalhost~]s
0x23服务检查
系统服务相关检查
列出正在运行的系统服务
[Ubuntu Server 16.04】默认情况
helperelocalhost:-$ sudo syst
UNIT
LOAD
ACTIVE SUB
DESCRIPTION
-state=r
accounts-daemon.service
looded
active running
Accounts Service
atd.service
acpid.service
looded
active running
active running
Deferred execution
scheduler
looded
looded
active running D-Bus System Messoge Bus
active running
irqbalance.service
gettyettyl.service
looded
looded
active running L
active running
LSB: doemon to balance interrupts for SMP systems
Getty on tty1
1vm2-1vmetod.service
lscsid.service
looded
active running
iSCSI initiator doenon (iscsid)
lxcfs.service
loaded
active running LvM2 metadata daemon
loaded
active running
FUSE
filesystem for LXC
open-vn-tools.service
ndadm.service
loaded
active running
LS8: MD monitoring doenon
polkitd.service
loaded
octive running
Service for virtual machines hosted on VMware
Loaded
active running
Authenticate and Authorize Users to Run Privileged Tasks
rsyslog.service
looded
active running S
System Logging Service
systemd-journald.service
ssh.ser
vice
Looded
Journal Service
OpenBSD Secure Shell server
systemd-logind.service
looded
looded
active running 
systemd-tinesyncd.service
active running
active running N
Network Time Synchronization
Login Service
systemd-udevd.service
looded
looded
active running
udev Kernel Device Manager
usere1eee.service
active running
loaded 
gauth.service
looded active running Authentication service for virtual mochines hosted on VMware
LOAD
ACTIVE = The high-level unit activation state,i.e.9
The low-level unit activotion state,values depend on unit type.
eralization of SUB.
UB
22 looded units listed. Pass
--all to see looded but inactive units, too.
To show all installed unit files use 'systenctl list-unit-files'.
helperelocalhost:-s
helper@localhost:-$ sudo systemetl list-units --type=service --state=running
UNIT
LOAD ACTIVE SUB
DESCRIPTION
accounts=daenon.service
loaded active running Accounts Service
---
## Page 175
acpid.service
loaded active running AcPI event daemi
atd.service
loaded active running Deferred execution scheduler
cron.service
loaded active running Regular background program processing daem
dbus .service
loaded active running D-Bus System Message Bus
getty@ttyl.service
loaded active running Getty on tty1
irqbalance.service
loaded active running LSB: daenon to balance interrupts for SHP
systems
iscsid.service
loaded active running iScSI initiator daenon (iscsid)
1vm2=1vmetad -service
loaded active running LVM2 metadata daemon
lxefs.service
loaded active running FUSE filesystem for LXC
mdadn.service
loaded active running LSB: ND nonitoring daemon
open-vm-tools.service
loaded active running Service for virtual machines hosted on VMware
polkitd.service
loaded active running Authenticate and Authorize Users to Run
Privileged Tasks
rsyslog.service
ssh. service
systemd-journald.service
loaded active running Journal Service
systemd-logind.service
loaded active running Login Service
systend-timesyncd.service
 loaded active running Network Time Synchronization
systend-udevd.service
loaded active running udev Kernel Device Hanager
unattended-upgrades.service loaded active running Unattended Upgrades Shutdown
user@1000.service
loaded active running User Hanager for UID 1000
vgauth.service
loaded active running Authentication service for virtual machines
hosted on Vhvare
LOAD
= Reflects whether the unit definition vas properly loaded.
ACTIvE = The high-level unit activation state, i.e. generalization of SUB.
SUB
= The lov-level unit activation state, values depend on unit type.
22 loaded units listed. Pass --all to see loaded but inactive units, too.
To show all installed unit files use 'systenctl list=unit=files'.
【Centos7】默认情况
---
## Page 176
Senvte
Funing Don
911 
UNIT
LOAD ACTIVE SUB
DESCRIPTION
abrt-oops.service
abrt=xorg-service
 loaded active running ABRT Xorg log watcher
abrtd.service
[oo butarodog 6ng posesosny satv 5utuunz aagaoe papeot
accounts-daenon.service
 loaded active running Accounts Service
alsa-state.service
loaded active running Manage Sound Card State (restore and store)
atd.service
loaded active running Job spooling tools
auditd.service
loaded active running Security Auditing Service
avahi-daemon.service
loaded active running Avahi mDNs/DNS=SD Stack
bluetooth.service
loaded active running Bluetooth service
bolt.service
loaded active running Thunderbolt system service
chronyd.service
loaded active running NTP client/server
colord.service
loaded active running Hanage, Install and Generate Color Profiles
crond.service
 loaded active running Command Scheduler
cups-service
loaded active running CUPS Printing Service
dbus .service
loaded active running DBus Systen Message Bus
firevalld.service
loaded active running firevalld - dynamic firewall daemon
fprintd.service
loaded active running Fingerprint Authentication Daenon
fvupd.service
gdm. service
loaded active running GNOHE Display Manager
geoclue.service
gssproxy -service
loaded active running GSSAPI Proxy Daemon
libstoragemgnt.service
loaded active running libstoragemgmt plug-in server daemon
lvm2=1vmetad.service
loaded active running LVM2 metadata daemon
ModenManager .service
loaded active running Hodem Manager
NetworkManager.service
loaded aetive running Netvork Hanager
packagekit.service
loaded active running PackageKit Daemon
polkit.service
loaded aetive running Authorization Manager
postfix,service
loaded active running Postfix Hail Transport Agenf
---
## Page 177
Loaded active running Hardware
rpcbind.service
loaded active running RPc bind service
rsyslog-service
rtkit-daemon.service
loaded active running RealtimeKit Scheduling Policy Service
snartd.service
loaded active running Self Monitoring and Reporting Technology (SMART)
Daemon
sshd.service
loaded active running OpenSSH server daenon
systend-journald.service loaded active running Journal Service
systemd-1ogind.service
loaded active running Login Service
systend-udevd. service
loaded active running udev Kernel Device Hanager
tuned.service