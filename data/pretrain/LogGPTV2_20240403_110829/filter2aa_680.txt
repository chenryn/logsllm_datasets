Ladar Levison
Stephen Watt
What is Dark Mail?
What is Dark Mail?
What is DIME?
Did you write down the formula?
Dark Internet Mail Environment
DIME Illustrated
User
Client
DARPA NET
DMAP
DMTP
Resolver
Transport
Signet Service
Global Ledger
(Optional)
Dark 
Messages
Server
]
]
Signets
Signets
DNS
Why Do We Need It?
• Guilt by Association
• Mass Surveillance (Gotta Love Backbone Slurping)
• Service Provider (PRTT Orders, Search Warrants, NSLs, FISC Warrants)
Goals
•
Message Confidentiality
•
Author Validation
•
Minimize Metadata Exposure
•
Automagical Key Management
•
Efficient Access from Multiple Clients
•
Deployment Flexibility
Get everyone using it! The more people using it, the more valuable it becomes.
How far will they go?
How will they attack?
Weak Points
• DNS
• Password Strength
• Endpoint Security
• Cryptographic Algorithms
• Implementation Vulnerabilities
• JavaScript Clients
• For those addicted to Webmail
* Warning: if the world adopts end-to-end cryptography for communications, then
it’s only a matter of time – hardware will start shipping from the factory with a 
backdoor. 
Let’s Get Back to DIME
Lead by Example
DIME Management Record
DIME Management Record
DIME Management Record
What is a Signet?
Signet
Header
Byte 1: Signet Format Version Number
Bytes 2-4: Length of the Signet (minus the 4 byte header) 
Defined Attributes
Byte 1: Attribute Type (Signing key, Encryption Key, Org Signature, Etc.) 
Bytes 2-3: Value Length
Bytes 4-X: Value
Undefined Attributes
Byte 1: Indicates Undefined Attribute Type (Value == 255)
Byte 2: Name Length
Bytes 3-N: Name
Bytes (N+1)-(N+3): Value Length
Bytes (N+4)-(N+4+X): Value
* Because the overall length is 3 bytes, the maximum size of a Signet is 16 megabytes.
Signet Construction
Signet Construction
Signet Construction
Signet Construction
Signet Construction
Signet Construction
Trust Model
Signet resolver obtains a signet from an authoritative primary source and then validates it
using a pre-authenticated secondary source.
User Signet
Org Signet
Management 
Record
RRSIG
DS
TLD
Trust Model
* Trust no one. You’ll live longer. 
Signet resolver obtains a signet from an authoritative primary source and then validates it
using a pre-authenticated secondary source.
User Signet
Org Signet
Management 
Record
RRSIG
DS
TLD
Registrar
TLD
Princess
Message
Header
Content
Tracing / Unencrypted
Return-Path: 
Destination: 
Destination-Key: [CD1ZS2B6ZpyfRiUeo63tJFc2Ca]
Received: from lavabit.com (153.31.119.142)
by mail.domain.tld with DMTP id N5HHRJGSDW5T
for ; Wed, 4 Jun 2014 13:37:02 -0500
Origin / ARO
Author: 
Author-Key: [wREBqUxPadqBzSCodroFYScLOI]
Destination: 
Destination-Key: [CD1ZS2B6ZpyfRiUeo63tJFc2Ca]
Destination / ARD
Recipient: 
Recipient-Key: [58+FsG1Y3n4SveTfX9PN68KoWS]
Origin: 
Origin-Key: [VLbfEsXhxtSzHpu61bRW+iyXLR]
Display / AR
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
Mr. President, I’m afraid the ubiquitous adoption of dmail has made mass surveillance 
technologically impossible. 
Sincerely, 
Ladar Levison 
Common Fields / AR
Date: Sat, 13 Jul 2013 03:15:42 -0500
From: Ladar Levison 
Organization: Lavabit LLC
To: "President, Mister" 
CC: "Snowden, Edward" ,
Subject: Hey, who turned out the lights?
Other Fields / AR
Message-ID: 
References: 
In-Reply-To: 
User-Agent: Volcano/1.2.8 
Thread-Topic: Hey, who turned out the lights?
Thread-Index: AbVQ9wJlc9KwLwQcsVw9lJHWFOzw9D==
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
X-Nonspam: None
Attachment / AR
Content-Type: application/octet-stream; 
name="TOP-SECRET-SLURPEE-net-data-collection-sources.pdf"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; 
filename="TOP-SECRET-SLURPEE-net-data-collection-sources.pdf"
JVBERi0xLjcNJeLjz9MNCjQ1MCAwIG9iag08PC9MaW5lYXJpemVkIDEvTCAyMDk0M
jUvTyA0NTIvRSAxNzA0Ni9OIDQxL1QgMjAwMzc3L0ggWyA2MzYgNzQ3XT4+DWVu
ZG9iag0gICAgICAgICAgICAgDQp4cmVmDQo0NTAgMTcNCjAwMDAwMDAwMTYgM
DAwMDAgbg0KMDAwMDAwMTM4MyAwMDAwMCBuDQowMDAwMDAxNDQ5ID
AwMDAwIG4NCjAwMDAwMDE3MJSVFT0YNCg==
Access  Identifiers
A = Author
D = Destination
O = Origin
R = Recipient
Signature
Signatures
User = Tree Signature (Combined Chunk Hashes) / Complete Content Signature
Domain = Return Subset Signature (If Applicable) / Complete Content Signature
Envelope
Pseudo Onion
Destination
silentcircle.com
Origin
lavabit.com
Author
Recipient
What the Origin Sees
What the Destination Sees
Fin