title:POSTER: TLS Proxies: Friend or Foe?
author:Mark O'Neill and
Scott Ruoti and
Kent E. Seamons and
Daniel Zappala
Poster – TLS Proxies: Friend or Foe?
Mark O’Neill, Scott Ruoti, Kent Seamons, Daniel Zappala
Brigham Young University
Computer Science Department
PI:EMAIL, PI:EMAIL, PI:EMAIL, PI:EMAIL
Provo, UT 84602
ABSTRACT
The use of TLS proxies to intercept encrypted traﬃc is
controversial since the same mechanism can be used for both
benevolent purposes, such as protecting against malware, and
for malicious purposes, such as identity theft or warrantless
government surveillance. To understand the prevalence and
uses of these proxies, we build a TLS proxy measurement
tool and deploy it via a Google AdWords campaign. We
generate 2.9 million certiﬁcate tests and ﬁnd that 1 in 250
TLS connections are proxied. The majority of these proxies
appear to be benevolent, however we identify over 1,000
cases where three malware products are using this technology
nefariously. We also ﬁnd numerous instances of negligent
and duplicitous behavior, some of which degrade security for
users without their knowledge.
Categories and Subject Descriptors
C.2.0 [Computer-Communication Networks]: General
- Security and protection
Keywords
TLS proxy; measurement; man-in-the-middle attack
1.
INTRODUCTION
Communicating securely over the Internet requires authen-
ticating the identity of a website to establish trust. Web
browsers authenticate a site by validating a chain of trust
from the site’s certiﬁcate back to one of a set of trusted root
certiﬁcates. These certiﬁcates comprise the root store and
are typically bundled with the operating system or browser.
This validation system is currently being compromised by
the use of TLS proxies, which can act as a man-in-the-middle
(MitM) for TLS connections. Companies typically employ
TLS proxies for benevolent reasons, particularly to protect
intellectual property and to protect their network from in-
truders. Personal ﬁrewalls use similar techniques to protect
users from malware and phishing attempts. Despite their
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for proﬁt or commercial advantage, and that copies bear this notice and the full ci-
tation on the ﬁrst page. Copyrights for third-party components of this work must be
honored. For all other uses, contact the owner/author(s). Copyright is held by the
author/owner(s).
CCS’14, November 3–7, 2014, Scottsdale, Arizona, USA.
ACM 978-1-4503-2957-6/14/11.
http://dx.doi.org/10.1145/2660267.2662393.
benevolent uses, TLS proxies can also be used by a malicious
entity to steal a user’s private information, such as a credit
card number, or by a government to snoop on encrypted
traﬃc. The most dangerous aspect of TLS proxies is that
the user is entirely unaware that encrypted traﬃc is being
intercepted by an organization or attacker. Current browser
software shows a reassuring lock icon during such sessions,
which could lead most users to assume they are having a
conﬁdential conversation with the website. Essentially, in
the name of providing increased security, TLS proxies have
violated the authentication guarantees TLS was designed to
create.
Although TLS proxies subvert the security of a TLS con-
nection, little work has been done to characterize the preva-
lence and use of these proxies. Huang et al. measured the
prevalence of TLS proxies using measurements deployed at
Facebook [4], ﬁnding 0.20% of TLS connections are proxied,
mostly by corporate Internet ﬁlters and personal antivirus
software. In addition, a small number of connections were
found to be intercepted by malware.
The focus of our research is to better understand the cur-
rent uses of TLS proxies through a large-scale measurement
of TLS proxies found in the wild. We have developed a
tool to automatically measure the presence of TLS proxies,
using the Flash runtime. Our method requires no user action
and silently runs to determine whether a proxy is present
whenever the user visits our web site. Using this tool, we
conducted a measurement study of TLS proxies using a novel
Google AdWords campaign. With this campaign, we au-
tomatically scan TLS connections when Google serves our
ad, without any user involvement. Our study found 11,764
proxied connections out of 2.9 million total measurements
(0.41% of all connections) spanning 142 countries. Most sub-
stitute certiﬁcates claim to be from benevolent TLS proxies,
however we also found numerous instances of negligent and
malicious behavior, aﬀecting thousands of systems.
We developed our tool and conducted our measurement
study independently and prior to Huang’s publication [4].
The advantage of Huang’s methodology is that they ﬁnd prox-
ies speciﬁcally targeting Facebook, whereas the advantage
of our methodology is that we can collect results without
the cooperation of a major website and ﬁnd proxies that
may have whitelisted Facebook or other high-proﬁle sites.
As compared to Huang, we ﬁnd that TLS proxies are twice
as common, we ﬁnd some additional malware, we ﬁnd evi-
dence of spammers using TLS proxies, and we ﬁnd that one
parental ﬁlter weakens security for its users by opening them
up to a MitM attack.
1487Figure 1: TLS Proxy Measurement
2. MEASUREMENT STUDY
We have developed a tool to measure the prevalence of
TLS proxies using existing, widely-deployed technologies.
The tool runs silently from the perspective of the user; no
user action is required, either to install any software or to
interact with the tool. This is a signiﬁcant advantage as
compared to other work that requires client-side software
installation [6, 5, 1, 3, 2], since it enables us to quickly deploy
our measurement tool and obtain millions of measurements
within a week. We do not need to encourage users to adopt
our tool in order to obtain measurements. The primarily
limiting factor regarding how fast we collect data is the
amount of money we wish to spend on Google’s ad network.
Our tool detects TLS proxies in three steps, illustrated in
Figure 1. We take advantage of the widespread deployment
and transparency aﬀorded by the Adobe Flash runtime. The
Flash application runs without any user interaction and need
not even be visible to the user. The application sends a
ClientHello message to a TLS-enabled server and records
the ServerHello and Certificate messages received in re-
sponse. The retrieved certiﬁcates are then forwarded to the
Web server, which compares the certiﬁcate received with the
original sent and reports a mismatch as a TLS proxy.
To determine the prevalence and uses of TLS proxies, we
conducted an advertising campaign using Google AdWords.
We uploaded our tool as part of a Flash advertisement so that
it runs automatically on any client that views our ad. Our
advertising campaign ran from January 6, 2014 to January
30, 2014. During the duration of our ad campaign, we
served 4.6 million ads and successfully completed 2.9 million
measurements.
In total we spent $5,101.88. Along with
the certiﬁcate, we also recorded the IP address of the client
tested. This IP address was then used to query the MaxMind
GeoLite database to gather geolocation information. Of those
tests, 11,764 returned a diﬀerent X.509 certiﬁcate than was
served by our secure web server, indicating the presence of a
TLS proxy.
The proxies identiﬁed by our campaign originated in 142
countries and from 8,589 distinct IP addresses. Due to the
targeting algorithms used by Google AdWords, our tool’s
exposure to these countries is not uniformly distributed.
Connections from the United States and Brazil account for
36% of all proxies. Some countries have signiﬁcantly higher
percentages of proxied connections than the average, includ-
ing France (1.09%), Canada (0.87%), Belgium (0.81%), the
United States (0.79%), and Romania (0.74%).
2.1 Analysis of Issuer Organization
We ﬁrst analyze the contents of the Issuer Organization in
the substitute certiﬁcates we collected. We use OpenSSL to
decode the certiﬁcates and store them in a database, where
we can run queries. We also manually inspect the contents
Rank
Issuer Organization
Connections
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
Bitdefender
PSafe Tecnologia S.A.
Sendori Inc
ESET spol. s r. o.
Null
Kaspersky Lab ZAO
Fortinet
Kurupira.NET
POSCO
Qustodio
WebMakerPlus Ltd
Southern Company Services
NordNet
Target Corporation