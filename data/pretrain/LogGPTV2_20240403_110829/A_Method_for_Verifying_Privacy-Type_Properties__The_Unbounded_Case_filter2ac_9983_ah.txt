selected equivalences for security protocols,” Journal of Logic and
Algebraic Programming, 2008.
[23] V. Cortier, S. Delaune, and P. Lafourcade, “A survey of algebraic prop-
erties used in cryptographic protocols,” Journal of Computer Security,
vol. 14, no. 1, pp. 1–43, 2006.
[24] M. Feldhofer, S. Dominikus, and J. Wolkerstorfer, “Strong authentication
for RFID systems using the AES algorithm,” in Cryptographic Hardware
and Embedded Systems-CHES 2004. Springer, 2004, pp. 357–370.
[25] S. Delaune, S. Kremer, and M. D. Ryan, “Verifying privacy-type prop-
erties of electronic voting protocols: A taster,” in Towards Trustworthy
Elections – New Directions in Electronic Voting. Springer, 2010, vol.
6000.
[26] M. Brus´o, K. Chatzikokolakis, S. Etalle, and J. Den Hartog, “Linking
unlinkability,” in Trustworthy Global Computing. Springer, 2012, pp.
129–144.
[27] M. Brus´o, “Dissecting unlinkability,” Ph.D. dissertation, Technische
Universiteit Eindhoven, 2014.
[32] B. Blanchet, M. Abadi, and C. Fournet, “Automated veriﬁcation of
selected equivalences for security protocols,” in Logic in Computer
Science, 2005. LICS 2005. Proceedings. 20th Annual IEEE Symposium
on.
IEEE, 2005, pp. 331–340.
[33] M. Abadi and B. Blanchet, “Computer-assisted veriﬁcation of a protocol
for certiﬁed email,” in Static Analysis. Springer, 2003, pp. 316–335.
[34] A. Juels and S. A. Weis, “Deﬁning strong privacy for RFID,” ACM
Transactions on Information and System Security (TISSEC), vol. 13,
no. 1, p. 7, 2009.
[35] S. Lee, T. Asano, and K. Kim, “RFID mutual authentication scheme
based on synchronized secret information,” in Symposium on cryptog-
raphy and information security, 2006.
[36] “PKI for machine readable travel documents offering ICC read-only
access,” International Civil Aviation Organization, Tech. Rep., 2004.
[37] M. Arapinis, V. Cheval, and S. Delaune, “Verifying privacy-type prop-
erties in a modular way,” in Proceedings of the 25th IEEE Computer
Security Foundations Symposium (CSF’12). Cambridge Massachusetts,
USA: IEEE Computer Society Press, Jun. 2012, pp. 95–109.
[38] “Technical
advisory group on machine
travel docu-
ments (tag/mrtd).” [Online]. Available: http://www.icao.int/Meetings/
TAG-MRTD/TagMrtd22/TAG-MRTD-22 WP05.pdf
readable
[28] M. Backes, M. Maffei, and D. Unruh, “Zero-knowledge in the applied pi-
calculus and automated veriﬁcation of the direct anonymous attestation
protocol,” in Security and Privacy, 2008. SP 2008. IEEE Symposium on.
IEEE, 2008, pp. 202–215.
[29] J. Bender, M. Fischlin, and D. K¨ugler, “Security analysis of the pace
key-agreement protocol,” in Information Security. Springer, 2009, pp.
33–48.
[30] “Proverif: Cryptographic protocol veriﬁer
in the formal model.”
[Online]. Available: http://prosecco.gforge.inria.fr/personal/bblanche/
proverif/
[31] “UKano tool and case studies.” [Online]. Available: http://projects.lsv.
ens-cachan.fr/ukano/
579579
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:14:24 UTC from IEEE Xplore.  Restrictions apply. 
[39] J. Bender,
¨O. Dagdelen, M. Fischlin, and D. K¨ugler, “The pace aa
protocol for machine readable travel documents, and its security,” in
Financial Cryptography and Data Security. Springer, 2012, pp. 344–
358.
[40] L. Cheikhrouhou, W. Stephan, ¨O. Dagdelen, M. Fischlin, and M. Ull-
mann, “Merging the cryptographic security analysis and the algebraic-
logic security proof of pace.” in Sicherheit, 2012, pp. 83–94.
[41] R. K¨usters and T. Truderung, “Reducing protocol analysis with XOR
to the xor-free case in the horn theory based approach,” J. Autom.
Reasoning, vol. 46, no. 3-4, pp. 325–352, 2011.
APPENDIX A
PROOFS OF SECTION IV
is the least relation such that:
We detail below how to obtain Proposition 1.
maximum number of nested transparent function symbols in u.
Deﬁnition 17: Let u ∈ T (Σc,N). We deﬁne h0(u) as the
Then, ht(u) is the minimum of all h0(v) for u=E v.
Proposition 5: For any u =E f(u1, . . . , un) with f ∈ Σt, we
have ht(u)> ht(ui) for all i.
Proof. We show that, for all v =E u, h0(v)> ht(ui). Since
v =E f(u1, . . . , un), and since the equational theory cannot
involve f by deﬁnition of Σt, we have v = f(v1, . . . , vn) with
vi =E ui. We conclude: ht(ui)= ht(vi)≤ h0(vi)< h0(v). ◻
Deﬁnition 18: The relation Rideal∶T (Σc,N)×T (Σt,{◻})
● u Rideal f(t1, . . . , tn) if there exist f ∈ Σt and messages
ui for 1≤ i≤ n= ar(f), such that u=E f(u1, . . . , un) and
ui Rideal ti for all 1≤ i≤ n;
● uRideal ◻ otherwise.
uRideal v. Furthermore, whenever u =E u′, u Rideal v and
u′ Rideal v′, then we have that v = v′.
Proof. We proceed by induction over ht(u). If u cannot
at toplevel, then the result is obvious with v = ◻. Otherwise,
assume u=E f(u1, . . . , un). By induction hypothesis we obtain
ui Rideal vi for all i, and thus uRideal f(v1, . . . , vn). Consider
now u′, v and v′ such that u=E u′, uRideal v and u′ Rideal v′.
Observe that u′ =E f′(u′
m) is only possible if f = f′,
n = m and ui =E u′
i for all i. Thus v = f(v1, . . . , vn) and
v′ = f(v′
◻
by deﬁning[u]ideal to be the unique v such that uRideal v. The
last point is an easy consequence of the deﬁnition of [⋅]nonce.
be equated to a message with a transparent function symbol
Proposition 6: For all message u there exists a v such that
The above results immediately allow to show Proposition 1,
n). Moreover, vi = v′
on ui, which concludes the proof.
i by induction hypothesis
1, . . . , u′
1, . . . , v′
APPENDIX B
PROOFS OF SECTION V
Proposition 3: Let Π be a protocol ensuring frame opacity.
Let P be a ground conﬁguration of Π, ta an annotated trace,
and ρ an arbitrary renaming of agents. If (P;∅) ta(cid:18)→(P1; φ1)
and (Pρ;∅) taρ(cid:18)→(P2; φ2), then [φ1]ideal =[φ2]ideal.
Proof. Intuitively, this is a consequence of the second point
(ii) of frame opacity for the execution where ta and taρ are
we consider a bijective renaming of names (instead of agents)
still a ground conﬁguration. We also consider a bijection θ over
executed in sequence, because any handle w in dom(φ1) =
dom(φ2) must carry the same label in φ1 and φ2. Formally,
σ such that no agent is both inP andPρσ, so thatP∪(Pρσ) is
W such that dom(φ1)∩ dom(φ2θ) = ∅ and θ is the identity
on dom(φ1). Let ρ′ be ρσ and ta′ = taρ′θ. We can deduce
from the execution of taρ by Pρ that (Pρ′;∅) ta′(cid:18)→ (P ′
2)
with P ′
2 = θ−1φ2σ. By concatenating the above
′);∅) ta.ta′(cid:18)(cid:18)(cid:18)→(P1∪P ′
Further, we have (Mid
Π;∅) ta0(cid:18)→ (P ∪(Pρ′);∅) for some ta0
because P∪(Pρ′) is a ground conﬁguration. Applying frame
2) that carry the same label (cid:10) ∈ L, one
w, w′ ∈ dom(φ1 ∪ φ′
has [w(φ1 ∪ φ′
2)]ideal. In particular, for
all w ∈ dom(φ1) carrying a label (cid:10) ∈ L, since wθ ∈ dom(φ′
2)
2 =P2σ and φ′
(P ∪(Pρ
opacity on the execution of ta0.ta.ta′, we obtain that for all
2)]ideal = [w′(φ1 ∪ φ′
executions, we obtain
2; φ1∪ φ
2).
2; φ′
′
must carry the same label (cid:10),
w[φ1]ideal =(wθ)[φ
2]ideal = w[φ2σ]ideal.
′
Finally, since σ is a bijection on names, we have [φ2]ideal =
[φ2σ]ideal and thus w[φ1]ideal = w[φ2]ideal as expected.
◻
ration P of the protocol such that
(P;∅) ta(cid:18)→ K,
Proposition 4: For any protocol and any ground conﬁgu-
there exists an agent renaming ρ satisfying the hypothesis of
Lemma 1 and such that Pρ is single-session.
Proof. We ﬁrst deﬁne Co(k) as the set of all (n1, n2)
such that I(k, n1) and R(k, n2) are connected in (ta, φ(K)).
Next, we assume for each (k, n1, n2) a vector of names
kc(k, n1, n2) of the length of identity parameters of Π. These
any name already occurring in the annotations of P. This
combination of k, n1, n2 taken from the annotations of P.
We also assume name vectors k1(k, n1) which are again
disjoint and not overlapping with annotations of P and any
kc(k′, n′
2), and similarly for k2(k, n2) which should also
name vectors are assumed to be all disjoint and not containing
gives us a mean to pick fresh identity parameters for each
not overlap with k1 vectors. These last two collections of
identity parameters will be used to give fresh identities to
initiator and responder agents, independently. We then deﬁne
ρ as follows:
1, n′
I(k, n1) ↦ I(kc(k, n1, n2), n1)
R(k, n2) ↦ R(kc(k, n1, n2), n2)
↦ I(k1(k, n1), n1)
↦ R(k2(k, n2), n2)
if (n1, n2)∈Co(k)
if (n1, n2)∈Co(k)
otherwise
otherwise
By construction, agents that were connected in ta are renamed
into agents sharing same identity names kc(k, n1, n2). Other
◻
agents have distinct, fresh identities. Finally, we have not used
id0, and the image of ρ obviously has at most one session per
identity and role: our renaming is single-session.
580580
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:14:24 UTC from IEEE Xplore.  Restrictions apply. 
two identities id1 and id2, and the attacker is allowed
to interact again with x (an arbitrary number of times).
It may also interact with tags and readers of identities
different from id1 and id2.
The attacker wins the game if he can infer whether x is id1 or
id2, i.e. if he is able to distinguish between these two scenarios.
This is typically the kind of scenario that can be checked
relying on the diff-equivalence notion implemented in several
automatic tool (e.g. ProVerif, Tamarin). However, here we
failed to prove it using ProVerif due to the ⊕ operator that
ProVerif can not handle. The attack scenario described in the
previous paragraph can be done in the guessing phase with tag
id1, and can be mimicked on the other side using two sessions
of the tag with identity id2. Actually, we believe that these two
scenarios are indistinguishable, i.e. the resulting processes are
in trace equivalence.
This example shows that game-based variants of unlink-
ability that are amenable to automation relying on the diff-
equivalence notion is rather weak.
APPENDIX C
EXAMPLE
In this section, we give a protocol that does not preserve
unlinkability according to the deﬁnition we used in this paper
(see Deﬁnition 7). However,
this protocol
would be considered secure w.r.t. a game-based deﬁnition
of unlinkability suitable for direct veriﬁcation using diff-
equivalence.
it appears that
Description of the protocol: The protocol can be pre-
sented in Alice & Bob notation as follows:
1. T → R ∶ {nT}k
2. R → T ∶ {nR}k
3. T → R ∶ {nR⊕ nT}k
The protocol is between a tag T and a reader R that share a
symmetric key k. Moreover, we assume that T aborts in case
the nonce nR he receives is equal to the nonce nT he sent
previously (in the same session). We consider the term algebra
introduced in Example 1, and the equational theory introduced
in Example 2 with in addition the following equation:
dec(enc(x, y), y) = x
Attack against unlinkability (Deﬁnition 7): To show that
the property formally stated in Deﬁnition 7 does not hold,
consider the following scenario.
1. T → R ∶ {nT}k
1′. T ′ → R ∶ {n′
T}k
2. I(R)→ T ∶ {n′
T}k
2′. I(R)→ T ′ ∶ {nT}k
3. T → R ∶ {n′
T ⊕ nT}k
3′. T ′ → R ∶ {nT ⊕ n′
T}k
A same tag starts two sessions and therefore generates two
nonces nT and n′
T . The attacker answers to these requests
by sending back the two encrypted messages to the tag who
will accept both of them, and sends on the network two
messages that are actually equal (the exclusive or operator
is commutative). Therefore the attacker observes a test (the
equality between the two last messages), and this equality
has no counterpart in the single session scenario. In practice,
this can be very harmful when e.g. tags are distributed among
distinct groups (e.g. for access control policies) sharing each
the same key k. By interacting with two tags, the attacker
would then be able to know if they belong to the same group.
Game-based deﬁnition: We will not give any formal
deﬁnition but instead brieﬂy give its general idea. In such a
deﬁnition, the two scenarios under study will be made of two
phases:
1) Learning phase: During this phase, the attacker can
trigger an arbitrary number of sessions of the two roles
(namely tag and reader) with the identity of his choice.
This allows him to gain some knowledge.
2) Guessing phase: This phase starts once the previous one
is ﬁnished. The challenger chooses an identity x among
581581
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:14:24 UTC from IEEE Xplore.  Restrictions apply.