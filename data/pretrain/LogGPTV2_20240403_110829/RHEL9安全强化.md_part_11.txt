| 最低级               | nt_profile_anssi_bp2 |                      |
|                      | 8_minimal`{.literal} |                      |
+----------------------+----------------------+----------------------+
| \[DRAFT\] CIS Red    | `xccdf_org.s         | 草案[^\[a\]^](       |
| Hat Enterprise Linux | sgproject.content_pr | #scanning-the-system |
| 9 基准（第 2 级 -    | ofile_cis`{.literal} | -for-configuration-c |
| 服务器）             |                      | ompliance-and-vulner |
|                      |                      | abilities_security-h |
|                      |                      | ardening.html#ftn.ci |
|                      |                      | s){#scanning-the-sys |
|                      |                      | tem-for-configuratio |
|                      |                      | n-compliance-and-vul |
|                      |                      | nerabilities_securit |
|                      |                      | y-hardening.html#cis |
|                      |                      | .footnote}           |
+----------------------+----------------------+----------------------+
| \[DRAFT\] CIS Red    | `x                   | DRAFT[^\[a\          |
| Hat Enterprise Linux | ccdf_org.ssgproject. | ]^](#scanning-the-sy |
| 9 基准（第 1 级 -    | content_profile_cis_ | stem-for-configurati |
| 服务器）             | server_l1`{.literal} | on-compliance-and-vu |
|                      |                      | lnerabilities_securi |
|                      |                      | ty-hardening.html#ft |
|                      |                      | n.cis){.footnoteref} |
+----------------------+----------------------+----------------------+
| \[DRAFT\] CIS Red    | `xccdf_              | DRAFT[^\[a\          |
| Hat Enterprise Linux | org.ssgproject.conte | ]^](#scanning-the-sy |
| 9 Benchmark for      | nt_profile_cis_works | stem-for-configurati |
| Level 1 -            | tation_l1`{.literal} | on-compliance-and-vu |
| Workstation          |                      | lnerabilities_securi |
|                      |                      | ty-hardening.html#ft |
|                      |                      | n.cis){.footnoteref} |
+----------------------+----------------------+----------------------+
| \[DRAFT\] CIS Red    | `xccdf_              | DRAFT[^\[a\          |
| Hat Enterprise Linux | org.ssgproject.conte | ]^](#scanning-the-sy |
| 9 Benchmark for      | nt_profile_cis_works | stem-for-configurati |
| Level 2 -            | tation_l2`{.literal} | on-compliance-and-vu |
| Workstation          |                      | lnerabilities_securi |
|                      |                      | ty-hardening.html#ft |
|                      |                      | n.cis){.footnoteref} |
+----------------------+----------------------+----------------------+
| \[DRAFT\]            | `xccdf_org.s         | r2                   |
| 在                   | sgproject.content_pr |                      |
| 非保障信息系统和机构 | ofile_cui`{.literal} |                      |
| 中未分类的信息(NIST  |                      |                      |
| 800-171)             |                      |                      |
+----------------------+----------------------+----------------------+
| 澳大利亚网           | `xccdf_org.          | 未版本化             |
| 络安全中心(ACSC)要点 | ssgproject.content_p |                      |
| 8                    | rofile_e8`{.literal} |                      |
+----------------------+----------------------+----------------------+
| 健康保险可移植       | `xccdf_org.ssg       | 未版本化             |
| 性和责任法案(HIPAA)  | project.content_prof |                      |
|                      | ile_hipaa`{.literal} |                      |
+----------------------+----------------------+----------------------+
| 澳大利亚网           | `xccdf_org.ssg       | 未版本化             |
| 络安全中心(ACSC)ISM  | project.content_prof |                      |
| 官方                 | ile_ism_o`{.literal} |                      |
+----------------------+----------------------+----------------------+
| \[DRAFT\] Protection | `xccdf_org.ss        | 4.2.1                |
| Profile for General  | gproject.content_pro |                      |
| Purpose Operating    | file_ospp`{.literal} |                      |
| Systems              |                      |                      |
+----------------------+----------------------+----------------------+
| 适用于 Red Hat       | `xccdf_org.ssgpr     | 3.2.1                |
| Enterprise Linux 9   | oject.content_profil |                      |
| 的 PCI-DSS v3.2.1    | e_pci-dss`{.literal} |                      |
| 控制基本行           |                      |                      |
+----------------------+----------------------+----------------------+
| \[DRAFT\] DISA STIG  | `xccdf_org.ss        | 草案[^\[b\]^](#s     |
| for Red Hat          | gproject.content_pro | canning-the-system-f |
| Enterprise Linux 9   | file_stig`{.literal} | or-configuration-com |
|                      |                      | pliance-and-vulnerab |
|                      |                      | ilities_security-har |
|                      |                      | dening.html#ftn.stig |
|                      |                      | ){#scanning-the-syst |
|                      |                      | em-for-configuration |
|                      |                      | -compliance-and-vuln |
|                      |                      | erabilities_security |
|                      |                      | -hardening.html#stig |
|                      |                      | .footnote}           |
+----------------------+----------------------+----------------------+
| \[DRAFT\] DISA STIG  | `xccdf_org.ssgpro    | DRAFT[^\[b\]         |
| with GUI for Red Hat | ject.content_profile | ^](#scanning-the-sys |
| Enterprise Linux 9   | _stig_gui`{.literal} | tem-for-configuratio |
|                      |                      | n-compliance-and-vul |
|                      |                      | nerabilities_securit |
|                      |                      | y-hardening.html#ftn |
|                      |                      | .stig){.footnoteref} |
+----------------------+----------------------+----------------------+
| ::: {#scanning-th    |                      |                      |
| e-system-for-configu |                      |                      |
| ration-compliance-an |                      |                      |
| d-vulnerabilities_se |                      |                      |
| curity-hardening.htm |                      |                      |
| l#ftn.cis .footnote} |                      |                      |
| [^\[a\]^](#scannin   |                      |                      |
| g-the-system-for-con |                      |                      |
| figuration-complianc |                      |                      |
| e-and-vulnerabilitie |                      |                      |
| s_security-hardening |                      |                      |
| .html#cis){.simpara} |                      |                      |
| CIS 尚未发布 RHEL 9  |                      |                      |
| 的官方基准           |                      |                      |
| :::                  |                      |                      |
|                      |                      |                      |
| ::: {#scanning-the   |                      |                      |
| -system-for-configur |                      |                      |
| ation-compliance-and |                      |                      |
| -vulnerabilities_sec |                      |                      |
| urity-hardening.html |                      |                      |
| #ftn.stig .footnote} |                      |                      |
| [^\[b\]^](#scanning  |                      |                      |
| -the-system-for-conf |                      |                      |
| iguration-compliance |                      |                      |
| -and-vulnerabilities |                      |                      |
| _security-hardening. |                      |                      |
| html#stig){.simpara} |                      |                      |
| DISA 尚未发布 RHEL 9 |                      |                      |
| 的官方基准           |                      |                      |
| :::                  |                      |                      |
+----------------------+----------------------+----------------------+
:::
:::
:::
::: section
::: titlepage
# []{#scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening.html#related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities}其他资源 {.title}
:::
::: itemizedlist
-   [RHEL 中支持的 SCAP
    安全指南版本](https://access.redhat.com/articles/6337261){.link}
-   [OpenSCAP 项目页面](http://www.open-scap.org){.link} -
    OpenSCAP项目的主页提供了关于 `oscap`{.literal}
    实用程序和其他与SCAP相关的组件和项目的详细信息。
-   [SCAP Workbench
    项目页面](https://www.open-scap.org/tools/scap-workbench/){.link} -
    SCAP Workbench 项目的主页提供了有关 `scap-workbench`{.literal}
    应用的详细信息。
-   [SCAP
    安全指南(SSG)项目页面](https://www.open-scap.org/security-policies/scap-security-guide/){.link} -
    为 Red Hat Enterprise Linux 提供最新安全内容的 SSG 项目的主页。
-   [红帽安全演示：创建自定义安全策略内容以自动化安全合规](https://2020-summit-labs.gitlab.io/rhel-custom-security-content/){.link} -
    一个动手实验室，使用 Red Hat Enterprise Linux
    中包含的工具来获取自动化安全合规的初始经验，以符合行业标准安全策略和自定义安全策略。如果您希望为您的团队提供培训或访问这些实验室练习，请联系您的红帽客户团队以了解更多详细信息。
-   [红帽安全演示：使用 RHEL
    安全技术保护自己](https://github.com/RedHatDemos/SecurityDemos/blob/master/2020Labs/RHELSecurity/documentation/README.adoc){.link} -
    实机实验室，了解如何使用 Red Hat Enterprise Linux
    中可用的关键安全技术（包括 OpenSCAP）在所有 RHEL
    系统级别实施安全性。如果您希望为您的团队提供培训或访问这些实验室练习，请联系您的红帽客户团队以了解更多详细信息。
-   [美国国家标准与技术研究院(NIST) SCAP
    页面](http://scap.nist.gov/){.link} - 此页面包含了大量与 SCAP
    相关的材料，包括 SCAP 出版物、规范和 SCAP 验证计划。
-   [国家漏洞数据库(NVD)](http://nvd.nist.gov/){.link} - 此页面代表了
    SCAP 内容和其他基于 SCAP 标准漏洞管理数据的最大存储库。
-   [红帽 OVAL
    内容存储库](http://www.redhat.com/security/data/oval/){.link} -
    这是一个包含 Red Hat Enterprise Linux 系统漏洞的 OVAL
    定义的存储库。这是推荐的漏洞内容来源。
-   [MITRE CVE](http://cve.mitre.org/){.link} - 这是一个由 MITRE
    公司提供的已知安全漏洞的数据库。对于 RHEL，建议您使用红帽提供的 OVAL
    CVE 内容。
-   [MITRE OVAL](http://oval.mitre.org/){.link} - 这是一个 MITRE
    公司提供的与 OVAL 相关的项目。除了与 OVAL
    相关的信息外，这些页面还包含 OVAL 语言和具有数千个 OVAL 定义 的 OVAL
    内容存储库，。请注意，要扫描 RHEL，建议使用红帽提供的 OVAL CVE
    内容。
-   [在红帽 Satellite
    中管理安全性合规](https://access.redhat.com/documentation/en-us/red_hat_satellite/6.6/html/administering_red_hat_satellite/chap-red_hat_satellite-administering_red_hat_satellite-security_compliance_management){.link} -
    这组指南除了其他主题外，还描述了如何使用 OpenSCAP
    来在多个系统上维护系统安全性。
:::
:::
:::
[]{#checking-integrity-with-aide_security-hardening.html}
::: chapter
::: titlepage
# []{#checking-integrity-with-aide_security-hardening.html#checking-integrity-with-aide_security-hardening}第 8 章 使用 AIDE 检查完整性 {.title}
:::
高级入侵检测环境（`Advanced Intrusion Detection Environment，简称 AIDE`{.literal}）是一个实用工具，它可以创建系统上的文件数据库，然后利用该数据库来确保文件的完整性，并检测系统入侵。
::: section
::: titlepage
# []{#checking-integrity-with-aide_security-hardening.html#installing-aide_checking-integrity-with-aide}安装 AIDE {.title}
:::
安装 `AIDE`{.literal} 并启动其数据库需要执行下列步骤。
::: itemizedlist
**先决条件**
-   `AppStream`{.literal}存储库已启用。
:::
::: orderedlist
**步骤**
1.  安装 [*aide*]{.emphasis} 软件包：
    ``` screen
    # dnf install aide
    ```
2.  生成初始数据库：
    ``` screen
    # aide --init
    ```
    ::: {.note style="margin-left: 0.5in; margin-right: 0.5in;"}
    ### 注意 {.title}
    在默认配置中，`aide --init`{.literal} 命令只检查
    `/etc/aide.conf`{.literal} 文件中定义的一组目录和文件。要在
    `AIDE`{.literal}
    数据库中包含其他目录或文件，并更改其监视的参数，请相应地编辑
    `/etc/aide.conf`{.literal}。
    :::
3.  要开始使用数据库，请从初始数据库文件名中删除 `.new`{.literal}
    子字符串：
    ``` screen
    # mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz
    ```
4.  要修改 `AIDE`{.literal} 数据库的位置，请编辑
    `/etc/aide.conf`{.literal} 文件并修改 `DBDIR`{.literal}
    值。要获得额外的安全性，请将数据库、配置和
    `/usr/sbin/aide`{.literal} 二进制文件存储在安全的位置，如只读介质。
:::
:::
::: section
::: titlepage
# []{#checking-integrity-with-aide_security-hardening.html#performing-integrity-checks-with-aide_checking-integrity-with-aide}使用 `AIDE`{.literal} 执行完整性检查 {.title}
:::
::: itemizedlist
**先决条件**
-   `AIDE`{.literal} 已正确安装，其数据库已初始化。请参阅 [安装
    AIDE](#checking-integrity-with-aide_security-hardening.html#installing-aide_checking-integrity-with-aide "安装 AIDE"){.link}
:::
::: orderedlist
**步骤**
1.  启动手动检查：
    ``` screen
    # aide --check
    Start timestamp: 2018-07-11 12:41:20 +0200 (AIDE 0.16)
    AIDE found differences between database and filesystem!!
    ...
    [trimmed for clarity]
    ```
2.  至少，将系统配置为每周运行 `AIDE`{.literal}。最好地，每天运行
    `AIDE`{.literal}。例如，要使用 `cron`{.literal} 命令计划在每天早上
    [*04:05*]{.emphasis} 执行 `AIDE`{.literal}，请在
    `/etc/crontab`{.literal} 文件中添加以下行：
    ``` screen
     05 4 * * * root /usr/sbin/aide --check
    ```
:::
:::
::: section
::: titlepage
# []{#checking-integrity-with-aide_security-hardening.html#updating-an-aide-database_checking-integrity-with-aide}更新 AIDE 数据库 {.title}
:::
在验证您的系统更改后，如软件包更新或配置文件调整，红帽建议更新您的基准
`AIDE`{.literal} 数据库。
::: itemizedlist
**先决条件**
-   `AIDE`{.literal} 已正确安装，其数据库已初始化。请参阅 [安装
    AIDE](#checking-integrity-with-aide_security-hardening.html#installing-aide_checking-integrity-with-aide "安装 AIDE"){.link}
:::
::: orderedlist
**步骤**
1.  更新您的基准 [**AIDE**]{.strong} 数据库：
    ``` screen
    # aide --update
    ```
    `aide --update`{.literal} 命令创建
    `/var/lib/aide/aide.db.new.gz`{.literal} 数据库文件。
2.  若要开始使用更新的数据库进行完整性检查，请从文件名中删除
    `.new`{.literal} 子字符串。
:::
:::
::: section
::: titlepage
# []{#checking-integrity-with-aide_security-hardening.html#file-integrity-tools-aide-and-ima_checking-integrity-with-aide}文件完整性工具：AIDE 和 IMA {.title}
:::
Red Hat Enterprise Linux
提供多个用于检查和维护系统上文件和目录完整性的工具。下表可帮助您决定哪个工具更适合您的场景。
::: table
[]{#checking-integrity-with-aide_security-hardening.html#idm139911306859456}
**表 8.1. AIDE 和 IMA 之间的比较**
::: table-contents