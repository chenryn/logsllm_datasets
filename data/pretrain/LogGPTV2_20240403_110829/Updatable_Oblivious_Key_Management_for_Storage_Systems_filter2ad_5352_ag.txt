bottleneck (of course, in large operations multiple HSMs will be used). Importantly, in UOKMS
encrypting data does not necesitate of interaction with the KmS, further increasing performance.
Additionally, the UOKMS approach oﬀers much more eﬃcient key rotation than traditional systems
where rotation requires communication with the KMS for each key (dek or kek) to be updated. This
slows down the rotation process, resulting in longer rotation periods and reduced security.
Acknowledgments
We thank Anja Lehmann for very helpful discussions related to security notions of Updatable En-
cryption schemes. Our implementation experience and reporting has beneﬁted enormously from the
work of Martin Schmatz, Navaneeth Rameshan, and Mark Seaborn. We thank the CCS reviewers
who helped improving the presentation of the paper.
References
[1] J. F. Almansa, I. Damg˚ard, and J. B. Nielsen. Simpliﬁed threshold RSA with adaptive and
proactive security. In S. Vaudenay, editor, Advances in Cryptology - EUROCRYPT 2006, pages
593–611, Berlin, Heidelberg, 2006. Springer Berlin Heidelberg.
[2] Amazon Web Services. Aws key management service cryptographic details, 2016. https:
//d1.awsstatic.com/whitepapers/KMS-Cryptographic-Details.pdf.
[3] Amazon Web Services. Aws elastic compute cloud, 2018. https://aws.amazon.com/ec2/.
[4] E. Barker and W. Barker. Recommendation for key management, part 2: Best practices for
key management organizations (2nd draft). Technical report, National Institute of Standards
and Technology, 2018.
[5] M. Bellare, C. Namprempre, D. Pointcheval, and M. Semanko. The one-more-RSA-inversion
Journal of Cryptology,
problems and the security of Chaum’s blind signature scheme.
16(3):185–215, June 2003.
[6] M. Bellare, C. Namprempre, D. Pointcheval, and M. Semanko. The One-More-RSA-Inversion
problems and the security of chaum’s blind signature scheme. Journal of Cryptology, 16(3):185–
215, 2003.
[7] M. Blaze, G. Bleumer, and M. Strauss. Divertible protocols and atomic proxy cryptogra-
phy. In K. Nyberg, editor, EUROCRYPT’98, volume 1403 of LNCS, pages 127–144. Springer,
Heidelberg, May / June 1998.
[8] D. Boneh, X. Boyen, and H. Shacham. Short group signatures.
In M. Franklin, editor,
CRYPTO 2004, volume 3152 of LNCS, pages 41–55. Springer, Heidelberg, Aug. 2004.
23
[9] D. Boneh, K. Lewi, H. W. Montgomery, and A. Raghunathan. Key homomorphic prfs and their
applications. In Advances in Cryptology - CRYPTO 2013 - 33rd Annual Cryptology Conference,
Santa Barbara, CA, USA, August 18-22, 2013. Proceedings, Part I, pages 410–428, 2013.
[10] D. Boneh, K. Lewi, H. W. Montgomery, and A. Raghunathan. Key homomorphic prfs and
their applications. IACR Cryptology ePrint Archive, 2015:220, 2015.
[11] Z. Brakerski and V. Vaikuntanathan. Fully homomorphic encryption from ring-LWE and
security for key dependent messages. In P. Rogaway, editor, CRYPTO 2011, volume 6841 of
LNCS, pages 505–524. Springer, Heidelberg, Aug. 2011.
[12] E. Brier, J.-S. Coron, T. Icart, D. Madore, H. Randriam, and M. Tibouchi. Eﬃcient indiﬀer-
entiable hashing into ordinary elliptic curves. Cryptology ePrint Archive, Report 2009/340,
2009. http://eprint.iacr.org/2009/340.
[13] R. Canetti, R. Gennaro, S. Jarecki, H. Krawczyk, and T. Rabin. Adaptive security for threshold
cryptosystems. In M. Wiener, editor, Advances in Cryptology — CRYPTO’ 99, pages 98–116,
Berlin, Heidelberg, 1999. Springer Berlin Heidelberg.
[14] R. Canetti, S. Halevi, and J. Katz. A forward-secure public-key encryption scheme. In E. Bi-
ham, editor, EUROCRYPT 2003, volume 2656 of LNCS, pages 255–271. Springer, Heidelberg,
May 2003.
[15] D. Chaum. Zero-knowledge undeniable signatures. In I. Damg˚ard, editor, EUROCRYPT’90,
volume 473 of LNCS, pages 458–464. Springer, Heidelberg, May 1991.
[16] D. Chaum and T. P. Pedersen. Wallet databases with observers. In E. F. Brickell, editor,
CRYPTO’92, volume 740 of LNCS, pages 89–105. Springer, Heidelberg, Aug. 1993.
[17] A. Davidson, A. Deo, E. Lee, and K. Martin. Strong post-compromise secure proxy re-
encryption. In Information Security and Privacy (ACISP) 2019, 2019.
[18] D. Derler, S. Krenn, T. Lor¨unser, S. Ramacher, D. Slamanig, and C. Striecks. Revisiting
proxy re-encryption: Forward secrecy, improved security, and applications.
In M. Abdalla
and R. Dahab, editors, PKC 2018, Part I, volume 10769 of LNCS, pages 219–250. Springer,
Heidelberg, Mar. 2018.
[19] A. Everspaugh, R. Chaterjee, S. Scott, A. Juels, and T. Ristenpart. The pythia PRF service. In
24th USENIX Security Symposium (USENIX Security 15), pages 547–562, Washington, D.C.,
2015. USENIX Association.
[20] A. Everspaugh, K. G. Paterson, T. Ristenpart, and S. Scott. Key rotation for authenticated
encryption. In Advances in Cryptology - CRYPTO 2017 - 37th Annual International Cryptology
Conference, Santa Barbara, CA, USA, August 20-24, 2017, Proceedings, Part III, pages 98–
129, 2017.
[21] W. Ford and B. S. Kaliski Jr. Server-assisted generation of a strong secret from a password. In
9th IEEE International Workshops on Enabling Technologies: Infrastructure for Collaborative
Enterprises (WETICE 2000), pages 176–180, Gaithersburg, MD, USA, June 4–16, 2000. IEEE
Computer Society.
[22] M. J. Freedman, Y. Ishai, B. Pinkas, and O. Reingold. Keyword search and oblivious pseu-
dorandom functions. In J. Kilian, editor, TCC 2005, volume 3378 of LNCS, pages 303–324.
Springer, Heidelberg, Feb. 2005.
24
[23] R. Gennaro, M. O. Rabin, and T. Rabin. Simpliﬁed VSS and fact-track multiparty computa-
tions with applications to threshold cryptography. In B. A. Coan and Y. Afek, editors, 17th
ACM PODC, pages 101–111. ACM, June / July 1998.
[24] Google Cloud. Google cloud key management service, 2018. https://cloud.google.com/
kms/.
[25] A. Herzberg, S. Jarecki, H. Krawczyk, and M. Yung. Proactive secret sharing or: How to cope
with perpetual leakage. In D. Coppersmith, editor, CRYPTO’95, volume 963 of LNCS, pages
339–352. Springer, Heidelberg, Aug. 1995.
[26] B. A. Huberman, M. K. Franklin, and T. Hogg. Enhancing privacy and trust in electronic
communities. In EC, 1999.
[27] IBM.
Ibm key protect, 2018.
https://console.bluemix.net/catalog/services/
key-protect.
[28] S. Jarecki, A. Kiayias, and H. Krawczyk. Round-optimal password-protected secret sharing and
T-PAKE in the password-only model. In P. Sarkar and T. Iwata, editors, ASIACRYPT 2014,
Part II, volume 8874 of LNCS, pages 233–253. Springer, Heidelberg, Dec. 2014.
[29] S. Jarecki, A. Kiayias, H. Krawczyk, and J. Xu. Highly-eﬃcient and composable password-
protected secret sharing (or: how to protect your bitcoin wallet online). In Security and Privacy
(EuroS&P), 2016 IEEE European Symposium on, pages 276–291. IEEE, 2016.
[30] S. Jarecki, A. Kiayias, H. Krawczyk, and J. Xu. TOPPSS: Cost-minimal password-protected
secret sharing based on threshold OPRF. In D. Gollmann, A. Miyaji, and H. Kikuchi, editors,
ACNS 17, volume 10355 of LNCS, pages 39–58. Springer, Heidelberg, July 2017.
[31] S. Jarecki, A. Kiayias, H. Krawczyk, and J. Xu. TOPPSS: Cost-minimal password-protected
secret sharing based on threshold OPRF. Cryptology ePrint Archive, Report 2017/363, 2017.
http://eprint.iacr.org/2017/363.
[32] S. Jarecki, H. Krawczyk, and J. Resch. Updatable oblivious key management for storage
In 2019 ACM SIGSAC Conference on Computer and Communications Security
systems.
(CCS’19). ACM, 2019.
[33] S. Jarecki and X. Liu. Fast secure computation of set intersection. In J. A. Garay and R. D.
Prisco, editors, SCN 10, volume 6280 of LNCS, pages 418–435. Springer, Heidelberg, Sept.
2010.
[34] Jeﬀ
Barr.
/
Amazon
quests
amazon-s3-two-trillion-objects-11-million-requests-second/.
Second,
–
S3
2013.
Two
Trillion Objects,
1.1 Million Re-
https://aws.amazon.com/blogs/aws/
[35] M. Klooß, A. Lehmann, and A. Rupp. (R)CCA secure updatable encryption with integrity
protection. In Eurocrypt 2109, 2019.
[36] R. Lai, C. Egger, M. Reinert, S. Chow, M. Maﬀei, and D. Schr¨oder. Simple password-hardened
encryption services. In 27th USENIX Security Symposium (USENIX Security 18), 2018.
[37] A. Lehmann and B. Tackmann. Updatable encryption with post-compromise security.
In
Advances in Cryptology - EUROCRYPT 2018 - 37th Annual International Conference on the
Theory and Applications of Cryptographic Techniques, Tel Aviv, Israel, April 29 - May 3, 2018
Proceedings, Part III, pages 685–716, 2018.
25
[38] A. Y. Lindell. Adaptively secure two-party computation with erasures. In M. Fischlin, editor,
Topics in Cryptology – CT-RSA 2009, pages 117–132, Berlin, Heidelberg, 2009. Springer Berlin
Heidelberg.
[39] Microsoft.
How many cryptographic operations are supported per second with ded-
https://docs.microsoft.com/en-us/azure/dedicated-hsm/faq#
icated hsm?, 2019.
performance-and-scale.
[40] Microsoft Azure. Azure key vault, 2018.
https://docs.microsoft.com/en-us/azure/
key-vault/key-vault-overview.
[41] M. Naor, B. Pinkas, and O. Reingold. Distributed pseudo-random functions and KDCs. In
J. Stern, editor, EUROCRYPT’99, volume 1592 of LNCS, pages 327–346. Springer, Heidelberg,
May 1999.
[42] M. Naor and O. Reingold. Number-theoretic constructions of eﬃcient pseudo-random func-
tions. In 38th FOCS, pages 458–467. IEEE Computer Society Press, Oct. 1997.
[43] OASIS Open. PKCS #11 Cryptographic Token Interface Base Speciﬁcation Version 2.40,
https://docs.oasis-open.org/pkcs11/pkcs11-base/v2.40/os/pkcs11-base-v2.
2015.
40-os.html.
[44] R. Ostrovsky and M. Yung. How to withstand mobile virus attacks (extended abstract). In
L. Logrippo, editor, 10th ACM PODC, pages 51–59. ACM, Aug. 1991.
[45] A. Patel and M. Yung. Fully dynamic password protected secret sharing, 2017. manuscript.
[46] T. P. Pedersen. A threshold cryptosystem without a trusted party (extended abstract) (rump
In D. W. Davies, editor, EUROCRYPT’91, volume 547 of LNCS, pages 522–526.
session).
Springer, Heidelberg, Apr. 1991.
[47] Y. Polyakov, K. Rohloﬀ, G. Sahu, and V. Vaikuntanathan. Fast proxy re-encryption for
publish/subscribe systems. ACM Transactions on Privacy and Security (TOPS), 20, 2017.
[48] K. Sakurai and Y. Yamane. Blind decoding, blind undeniable signatures, and their applications
In Proceedings of the First International Workshop on Information
to privacy protection.
Hiding, pages 257–264, London, UK, UK, 1996. Springer-Verlag.
[49] Thales. SafeNet Luna Network HSM, 2019. https://safenet.gemalto.com/resources/
data-protection/luna-sa-network-attached-hsm-product-brief/.
A Proof of the OMDH-IO Assumption in the Generic Group
Model
We sketch the steps for adapting the GGM proof of OMDH from [31] to the OMDH-IO case. As
argued in [31], it suﬃces to show OMDH security for N = Q + 1, in which case the upper-bound on
a probability that a GGM adversary solves the OMDH problem in a group of prime order q while
making r group operations and Q queries to the exponentiation oracle (·)k is (Q(2Q + r)2)/q. In
a GGM proof, see Theorem 6 in Appendix A in [31], every group element the adversary obtains
is represented with a (random string assigned to) a polynomial in unknowns (u1, ..., uN , k) for
ui = DL(g, gi). Group multiplications or divisions correspond to, respectively, adding or subtracting
such polynomials, and querying oracle (·)k on a group element corresponds to multiplying the
corresponding polynomial by k.
26
The proof argues that the only way the adversary can win is either if some two diﬀerent poly-
nomials it creates have equal values on random inputs (u1, ..., uN , k), or that the group elements it
outputs correspond to polynomials k·u1, . . . , k·uN . The latter case is easily seen as impossible for an
adversary which can has only Q = N − 1 accesses to the “multiply-a-polynomial-by-k” oracle (·)k,
while the upper-bound on the probability of the ﬁrst case comes from the fact that there are at most
2Q + r polynomials, each one has at most degree Q in k (and linear in variables u1, . . . , uN ), and
the fact that a non-zero Q-degree polynomial can have at most Q roots, hence each pair of diﬀerent
polynomials can evaluate to the same value on random exponent (u1, ..., uN , k) with probability at
most Q/q. If the GGM adversary in addition makes t queries to the inverse-exponentiation oracle
(·)1/k, each query multiplies the corresponding polynomial by k−1, and the resulting polynomials,
after multiplying all of them by kt, can be thought of as polynomials of degree at most Q + t instead
of Q. Thus by the same argument, the upper-bound on the probability of GGM adversary to solve
all N = Q + 1 challenges is bounded by (Q + t)(2Q + t + r)2/q. Note that r >> max(Q, t) in typical
applications, including our UOKMS scheme, hence this bound can be approximated as (Q + t)r2/q.
27