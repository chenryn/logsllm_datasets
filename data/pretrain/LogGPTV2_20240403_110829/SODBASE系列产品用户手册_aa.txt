目录
  TOC \o "1-3" \h \z \u    HYPERLINK \l "_Toc426981409"  1 SODBASE
Studio	  PAGEREF _Toc426981409 \h  3  
  HYPERLINK \l "_Toc426981410"  1.1简介	  PAGEREF _Toc426981410 \h  3 
  HYPERLINK \l "_Toc426981411"  1.2 用户操作	  PAGEREF _Toc426981411
\h  3  
  HYPERLINK \l "_Toc426981412"  1.2.1学习SODBASE
Studio(以股票数据为例)（3分钟）	  PAGEREF _Toc426981412 \h  3
  HYPERLINK \l "_Toc426981413"  1.2.2 功能介绍	  PAGEREF_Toc426981413 \h  8  
  HYPERLINK \l "_Toc426981414"  1.3 运行环境	  PAGEREF _Toc426981414
\h  32  
  HYPERLINK \l "_Toc426981415"  1.3.1 硬件环境	  PAGEREF
_Toc426981415 \h  32  
  HYPERLINK \l "_Toc426981416"  1.3.2 软件环境	  PAGEREF
_Toc426981416 \h  32  
  HYPERLINK \l "_Toc426981417"  2 SODBASE CEP Server Admin	  PAGEREF
_Toc426981417 \h  32  
  HYPERLINK \l "_Toc426981418"  2.1 简介	  PAGEREF _Toc426981418 \h32  
  HYPERLINK \l "_Toc426981419"  2.2 用户操作	  PAGEREF _Toc426981419
\h  33  
  HYPERLINK \l "_Toc426981420"  2.2.1 学习管理SODBASE CEP
Server（3分钟）	  PAGEREF _Toc426981420 \h  33  
  HYPERLINK \l "_Toc426981421"  2.2.2集群管理	  PAGEREF
_Toc426981421 \h  37  
  HYPERLINK \l "_Toc426981422"  3 SODBASE CEP服务器安装	  PAGEREF
_Toc426981422 \h  37  
  HYPERLINK \l "_Toc426981423"  3.1 简介	  PAGEREF _Toc426981423 \h37  
  HYPERLINK \l "_Toc426981424"  3.2
Windows服务器安装步骤（10分钟）	  PAGEREF _Toc426981424 \h 
37  
  HYPERLINK \l "_Toc426981425"  3.3
Linux服务器安装步骤（10分钟）	  PAGEREF _Toc426981425 \h  38 
  HYPERLINK \l "_Toc426981426"  3.4集群配置	  PAGEREF _Toc426981426
\h  39  
  HYPERLINK \l "_Toc426981427"  3.5多用户共享一个数据源	 
PAGEREF _Toc426981427 \h  40  
  HYPERLINK \l "_Toc426981428"  3.5.1共享数据源	  PAGEREF_Toc426981428 \h  40  
  HYPERLINK \l "_Toc426981429"  3.5.2使用共享数据源	  PAGEREF
_Toc426981429 \h  41  
  HYPERLINK \l "_Toc426981430"  3.5.3 保留命名空间	  PAGEREF
_Toc426981430 \h  42  
  HYPERLINK \l "_Toc426981431"  4自定义函数开发	  PAGEREF
_Toc426981431 \h  42  
  HYPERLINK \l "_Toc426981432"  4.1 简介	  PAGEREF _Toc426981432 \h 
42  
  HYPERLINK \l "_Toc426981433"  4.2学习自定义函数制作(3分钟)	
 PAGEREF _Toc426981433 \h  42PAGEREF _Toc426981433 \h  42  
  HYPERLINK \l "_Toc426981434"  5.自定义适配器开发	  PAGEREF
_Toc426981434 \h  45  
  HYPERLINK \l "_Toc426981435"  5.1 简介	  PAGEREF _Toc426981435 \h 
45  
  HYPERLINK \l "_Toc426981436" 
5.2学习自定义适配器制作(20分钟)	  PAGEREF _Toc426981436 \h 
45  
  HYPERLINK \l "_Toc426981437"  5.3 接口定义	  PAGEREF _Toc426981437
\h  51  
  HYPERLINK \l "_Toc426981438"  5.3.1 输入适配器	  PAGEREF_Toc426981438 \h  51  
  HYPERLINK \l "_Toc426981439"  5.3.2 输出适配器	  PAGEREF
_Toc426981439 \h  52  
  HYPERLINK \l "_Toc426981440"  5.4示例	  PAGEREF _Toc426981440 \h  54
  HYPERLINK \l "_Toc426981441"  5.4.1 输入适配器	  PAGEREF
_Toc426981441 \h  54  
  HYPERLINK \l "_Toc426981442"  5.4.2输出适配器	  PAGEREF
_Toc426981442 \h  54  
  HYPERLINK \l "_Toc426981443"  5.5 参考类	  PAGEREF _Toc426981443 \h
 5454  
  HYPERLINK \l "_Toc426981444"  5.5.1 PrimitiveEvent类	  PAGEREF
_Toc426981444 \h  54  
  HYPERLINK \l "_Toc426981445"  5.6使用RESTful接口插入事件	 
PAGEREF _Toc426981445 \h  55  
  HYPERLINK \l "_Toc426981446"  6. 流数据项目开发	  PAGEREF
_Toc426981446 \h  56  
  HYPERLINK \l "_Toc426981447"  6.1 模型XML文件	  PAGEREF
_Toc426981447 \h  56  
  HYPERLINK \l "_Toc426981448"  6.1.1inputAdaptors配置	  PAGEREF_Toc426981448 \h  56  
  HYPERLINK \l "_Toc426981449"  6.1.2outputAadaptors配置	  PAGEREF
_Toc426981449 \h  56  
  HYPERLINK \l "_Toc426981450"  6.1.3SODSQL语句	  PAGEREF
_Toc426981450 \h  56  
  HYPERLINK \l "_Toc426981451"  6.2程序编制	  PAGEREF _Toc426981451
\h  57  
  HYPERLINK \l "_Toc426981452"  6.3在线修改规则	  PAGEREF
_Toc426981452 \h  57  
  HYPERLINK \l "_Toc426981453"  7. 配置文件	  PAGEREF _Toc426981453\h  58  
  HYPERLINK \l "_Toc426981454"  7.1 configuration/global.properties	 
PAGEREF _Toc426981454 \h  58  
  HYPERLINK \l "_Toc426981455"  7.2 configuration/adaptor.properties	 
PAGEREF _Toc426981455 \h  58  
  HYPERLINK \l "_Toc426981456"  7.3 configuration/db.properties	 
PAGEREF _Toc426981456 \h  59  
1 SODBASE Studio 
1.1简介
SODBASE Studio是实时数据分析模型建模和单元测试软件。
1.2 用户操作1.2 用户操作
1.2.1学习SODBASE Studio(以股票数据为例)（3分钟）
进入解压后的目录双击cepstudio.exe	
新建按钮
在自动弹出的“选择一个名字”框中手工取名填写exampl
e，点击确定。在左侧资源管理目录中会出现example模型
，双击该模型。
INPUT拖动到工作区面板中，自动弹出“Input配置项”面
板，输入源选择“模拟股票行情”，点击“确定”：
拖动到工作区面板，自动弹出“filter配置条件”面板，
点击“确定”：
拖动到工作区面板，自动弹出“Output配置项”，输出选
择“屏幕打印输出”，SELECT输出选择“否”，点击确定
相连接，如下图所示：
这样一个模型就建立完成了
（7）在工作区空白区域右键“测试运行”，查看结果
是否正确：
运行结果将在“信息显示”中显示：
1.2.2 功能介绍
1.2.2.1. 模型文件管理1.2.2 功能介绍
1.2.2.1. 模型文件管理
（1）新建文件
来新建空白模型文档。
  效果如下：
（2）修改文件名
弹出如下窗口：
手工输入文件名后，点击确定即可。
（3）删除模型文件
右键点击选择所需删除的文件，选择删除选项即可。
（4）文件信息
用户可通过两种方式查看或添加模型的版本号及描述信
息：
在资源管理面板中右键点击所需查看的文件，选择“属
性”选项
在已打开文的文件工作区空白位置点击鼠标右键，选择
“属性”选项
的错误提示
（5）模型部署文件导出
方法1：菜单导出
，弹出如下操作界面：
选择要导出的文件后，点击“浏览”，选择目录，填写
所需导出的文件名。此功能可以将多个文件合并为一个
CEP模型.soddata文件保存以供部署使用。
方法2：拷贝导出
SODBASE
CEP.soddata2部署文件存放在程序根目录/files目录中，将文CEP.soddata2部署文件存放在程序根目录/files目录中，将文
件手工拷贝到目的目录即可。
（6） 模型文件导入
方法1：菜单导入
，弹出如下界面：
选择.sod格式的文件，点击打开即可导入。
方法2：拷贝导入
SODBASE
CEP.sod模型图形文件存放在程序根目录/files目录中，将.s
od文件手工拷贝到此目录即可。
参考实践：只将SODBASE
Studio的files目录作为工作目录，其中的文件可看做未完
成作品。将完成的.sod和.soddata2文件，编辑完后导出到
用户自定义的目录进行管理，需要修改时再拷贝回files
目录修改。
1.2.2.2. 模型设计
（1） 结点绘制
在工作区内，以同样的方式进行结点的移动。
使用Studio编辑CEP模型时，一个单元模型中可以有多个输
入，或多个输出，但目前只支持包含一个主计算节点。入，或多个输出，但目前只支持包含一个主计算节点。
采用XML自行编辑模型部署文件，则没有此限制。根据实
践经验，单元模型中最好只一个主计算节点，防止最后
模型不好管理和模型描述不易阅读理解。
（2） 结点信息配置
配置窗口会在结点被移动到工作区后自动弹出。也可右
击结点，点击配置菜单，进入配置界面。
以Input配置界面为例，选择一项输入源，点击确定即可
。（如不选择，则为系统默认输入源）。
（3） 结点连接
双击结点，移动鼠标至另一节点后单击，两结点即被箭
头连接成功。
（4） 模型信息保存
点击工具栏的保存按钮即可。
如此文件为新建文件，则提示输入文件名：
如文件为已创建文件，则直接保存。
（5） 本地测试运行
在工作区空白区域点击鼠标右键，则弹出如下菜单。
点击测试运行。如结点配置尚未完成，则信息栏将出现
相关提示。
如配置已完成，则开始测试运行。相关提示。
如配置已完成，则开始测试运行。
点击停止测试菜单项，则测试运行停止。
（6）图形模型转换为SODSQL语句
为了方便单元调试，可以在Studio中查看SODSQL代码。在工
作面板空白区域右键点击“转换为代码”
（7）模型的级联
为了保证单元测试的正确性和简洁性，SODBASE
Studio在一个工作区面板只能放置f(x),sequence,conjunction,disj
unction,filter中的一个主计算操作节点，同时Kleen
closure和negation必须配合sequence使用。
将模型M的Output配置为“节点级联”
注：模型M的参数“级联到的输入”和模型N的参数“名
称”必须保持一致。
1.2.2.3. 模式操作符使用实例
（1）sequence顺序发生
Sodsql语句：CREATE QUERY querySEQ1Sodsql语句：CREATE QUERY querySEQ1
		      SELECT T1,T2,T3
			  FROM T1:data-src1,T2:data-src1,T3:data-src1
			  PATTERN T1;T2;T3 //T1 T2 T2 顺序发生
			  WHERE T1.name=T3.name
			  AND T2.name='Google'
			  AND T1.price > (1+0.2)*T2.price
			  AND T3.price  (1+0.2)*T2.price
		AND T3.price  20 
			AND T2.price 20*(1+0.2) 
			WITHIN 500 
表示T1,T3之间T2没有发生。
首先拖入input，与上例一样；
然后拖入negation节点，并配置如图：
然后拖入sequence节点，并配置如图：
最后拖入output节点，并连接各节点，运行。
（5） filter过滤
Sodsql语句： CREATE QUERY queryFilter
		SELECT T1
		FROM T1:stockIn
		PATTERN T1 
		WHERE T1.name='Google' AND T1.price > 80
		WITHIN 500
filter是一种特殊的sequence模式，即sequence模式上只有一
个事件发生。
首先拖入input，并选择模拟股票输入。个事件发生。
首先拖入input，并选择模拟股票输入。
然后拖入filter节点，并配置如图：
最后拖入output节点，并连接各节点，运行。
注：filter因为不受时间窗口限制，填写>1的数字都可。
（6） f(x)结点
此节点为通用结点，可以自己书写PATTERN表达式。
模式表达式可以是前面操作符表达式，也可以加括号进
行复合，例如T1;T2;T3;T4，表示T1,T2,T3,T4顺序发生。又如T1
;(T2;!T3;T4)，表示T1之后(T2;!T3;T4)发生。
（7）条件“与”和条件“或”
数据过滤条件的布尔计算时，SODBASE
Studio采用关键字”AND”表达。条件“与”
通过Filter操作符，在同一流标识符上设置条件。
例如：下图中对流标识符的T1.name=”GOOGLE” AND
T1.price>80。表示选取name='Google '且price>80的数据。条件“或”
使用disjunction实现，例如我们想选取name='Google
'或者price>80。首先，将输入数据分为两个Input
T1和T2,使用相同的数据源；其次，配置disjunction条件
T1.name='Google ' AND T2.price>80
最后输出采用能除去重复事件的级联输出（watermark）,
将输出级联到需要的数据流上，Watermark长度设置为1即
可。
1.2.2.4调试与SODSQL语句编写
Studio的工具菜单下，可以将.soddata2和xml之间相互转化，
从而将CEP模型转为可读的XML文件，供调试检查使用。
读者可以看到XML文件中，主要由SODSQL语句，输入流适配
器，输出适配器组成，读者也可以自行编辑XML文件。
因为.soddata2文件最终被部署到CEP
Server，所以也可以使用这两个工具脱离模型的图形表示Server，所以也可以使用这两个工具脱离模型的图形表示
，xml文件编辑后转为.soddata2文件部署的CEP Server。
1.2.2.5自定义函数和自定义适配器
实际应用往往需要自定义数据选择条件（SELECT语句和WHE
RE语句中），而不仅仅是简单的四则运算和布尔运算。
这就要学会自定义函数用法，这会让您真正把实时数据
分析平台使用好，发挥强大的效用。
例如：在模型中使用java类com.example.Compare的boolean
greaterThan(String arg1,String arg2)函数。
在Studio中为以下SODSQL语句建模。
CREATE QUERY querySEQ1