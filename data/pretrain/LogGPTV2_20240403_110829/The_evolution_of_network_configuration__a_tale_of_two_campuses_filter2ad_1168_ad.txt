GT network that close-to-border ﬁrewalls are periodically backed
up and commit to the CVS every six hours, while unit ﬁrewalls
which are deployed closer to the edge are not managed that inten-
sively. We assume this is due to the higher reliability requirement
for the border ﬁrewalls compared to the unit ﬁrewalls; failure or
misconﬁguration on border ﬁrewalls can bring destructive conse-
quences to the whole network.
Distinct practice using sec stanzas is captured. There are some
noticeable sec stanzas on the UW network in Figure 9b. Inspection
of the actual commands changed show that operators are turning off
failover for the interfaces (internal and external). This prevents the
virtual ﬁrewalls from failing over when the interfaces or connected
devices are taken down. The anomalies occur in the ﬁrewalls used
primarily by the campus IT department.
In summary, the two campus networks show very similar conﬁg-
uration change and usage patterns when it comes to ﬁrewalls. The
majority of the changes occur at the border ﬁrewalls, where the
changes on virtual ﬁrewalls are aggregated to. Border ﬁrewalls are
also managed more intensively compared to simple unit ﬁrewalls at
the edge.
4.3.2 Longitudinal analysis
Figure 10 shows the longitudinal view of ﬁrewall conﬁguration
evolution over a span of ﬁve years. The number of lines for acl
commands increases sharply over ﬁve years. For the GT network,
there was a factor of six increase. In the case of the UW network,
ﬁrewalls were deployed starting in January 2006, and around 260
ﬁrewalls were added through April 2010.
Figures 10b and 10e show how the conﬁguration of a typical ﬁre-
wall evolves over time. The small spike in the GT network around
July 2007 is caused by adding new ﬁrewall machines and moving
a substantial amount of access control lists to those ﬁrewalls. ACL
conﬁgurations in previous ﬁrewalls are removed several days after
the migration occurs. A slight increase of qos commands occurs
around July 2008. Further inspection in the conﬁguration shows
a global policy map, which includes default inspection ports and
Session Initiation Protocol (SIP) ports, is deﬁned and inserted into
around 40 ﬁrewalls. This policy map enforces further inspection on
the speciﬁed services. In the UW network (Figure 10e), we observe
a similar increase in qos commands around January 2008. These
deﬁne two class maps: one for SIP ports as with the GT network,
and one for a speciﬁc list of management services, ranging from
DNS and rsh to SunRPC.
The decrease of mgt commands around January 2008 is due to
the removal of the “pdm” (PIX Device Manager) commands from
all ﬁrewalls. This command allows the device to determine who
will have access to the management GUI for the ﬁrewalls. The re-
moval of these commands prevents access to the GUI and forces the
departments to submit all changes to the campus IT team, reﬂecting
a new campus-wide security policy instituted in UW in 2008.
As with routers, we observe that a variety of network-wide fac-
tors, ranging from infrastructure expansion, to policy changes, and
addition/modiﬁcation of features, contribute to ﬁrewall conﬁgura-
tion evolution.
4.3.3 Correlation analysis
Correlation analysis on ﬁrewall devices has not shown any spe-
ciﬁc correlated change behavior on stanzas, as most changes are
solely made to acl stanzas. Clearly, the functionality abstraction
we employ in this paper is too high-level for correlation analysis
on ﬁrewalls. We do witness many correlated changes within the
acl commands. Speciﬁcally, if there is a change in the network
object group deﬁnition (where operators can combine multiple IP
addresses, ports, subnets to separate groups), there are also changes
in the actual access control lists which reference that particular net-
work object. More ﬁne-grained classiﬁcation of commands within
the acl stanza may show interesting correlated change behavior.
For example, there might be correlated changes within the access
control lists; such an exploration would make a good direction for
future work.
4.4 Switches
In this section, we study changes in switch conﬁgurations. We
ﬁnd: (i) interface deﬁnition and related subcommands dominate
the changes in switches (Figures 11c and 11d); and (ii) extensive
correlated changes (Table 7).
507s
e
n
i
l
f
o
r
e
b
m
u
N
s
e
n
i
l
f
o
r
e
b
m
u
N
 1e+06
 100000
 10000
 1000
 100
 10
 1
s
e
n
i
l
f
o
r
e
b
m
u
N
 1e+06
 100000
 10000
 1000
 100
 10
 1
mgt
l1
l2
vlan
l3
acl
sec
cflt qos etc
mgt
l1
l2
vlan
l3
acl
sec
cflt qos etc
Functionality
Functionality
(a) Static analysis of latest snapshot (logscale) - GT
(b) Static analysis of latest snapshot (logscale) - UW
 500000
 400000
 300000
 200000
 100000
 0
Addition
Deletion
Modification
s
e
n
i
l
f
o
r
e
b
m
u
N
 400000
 350000
 300000
 250000
 200000
 150000
 100000
 50000
 0
Addition
Deletion
Modification
mgt
l1
l2
vlan
l3
acl
sec
cflt qos etc
mgt
l1
l2
vlan
l3
acl
sec
cflt qos etc
Functionality
Functionality
(c) Change characteristic over ﬁve years- GT
(d) Change characteristic over ﬁve years- UW
Figure 8: Static analysis and change analysis for ﬁrewalls. (a) and (b) shows a static analysis of the latest ﬁrewall conﬁgurations all combined
for each campus. (c) and (d) shows the number of additions, deletions and modiﬁcations of each functionalities in a row-stacked fashion, all devices
combined over 5 years.
d
e
g
n
a
h
C
s
a
z
n
a
S
t
f
o
#
h
t
n
o
m
r
e
p
)
s
d
o
m
,
l
e
d
,
d
d
A
(
 22
 20
 18
 16
 14
 12
 10
 8
 6
 4
 2
vlan
Mgmt
L1
Sec
L2
QoS
CTRL
L3
ACL
 0
 5
 10
 15
 20
 25
 30
Device ID (top 30)
(a) GT
 30
 25
 20
 15
 10
d
e
g
n
a
h
C
s
a
z
n
a
S
t
f
o
#
h
t
n
o
m
r
e
p
)
s
d
o
m
,
l
e
d
,
d
d
A
(
 5
 0
vlan
Mgmt
L1
Sec
L2
QoS
CTRL
L3
ACL
 5
 10
 15
 20
 25
 30
Device ID (top 30)
(b) UW
Figure 9: Number of changes to each ﬁrewall device per month for the GT and UW networks.
4.4.1 Snapshot and change analysis
Many changes involve management, layer 1, layer 2 and VLAN
commands. Figure 11 shows the static snapshot and change analy-
sis of switches from both campuses. If we focus on changes of the
conﬁguration, Figures 11c and 11d show that there are many mgt,
l1, l2 and vlan command changes. Note from Figures 11a and 11b
that these lines also constitute a majority of any given switch con-
ﬁguration snapshot. As seen previously, l1 and vlan changes occur
together naturally. l2 changes are understandable as switches can
offer layer 2 connectivity. The abnormality seems to be the sig-
niﬁcant number of changes in mgt commands. A majority of mgt
changes in switch devices are in fact snmp trap and logging com-
mands; snmp trap is for sending events to the SNMP server when
particular conditions are met, and logging conﬁgures the logging
behavior for the interface. The default is to deﬁne SNMP trap and
logging commands along with the port conﬁguration in the UW
network. This induces the bulk of the mgt and l1 changes to the
network.
Certain practices shape how switch conﬁguration evolves. The
GT network has many additions, while the UW network experi-
ences many modiﬁcations. Most of the changes in the GT network
are actually due to additions in l1 and vlan, followed by mgt and l2
commands. However, the UW network looks different; there are a
lot of modiﬁcations in general, with changes in mgt and l1 followed
by vlan appearing to dominate the changes. We found that this re-
sulted from a large number of modiﬁcations that operators made to
a majority of switches in the UW network, including interface and
their subcommands, snmp trap and logging. From this behavior,
it appears as though operators of the UW network have decided to
uniformly enable or disable some functions on ports across most of
its switches.
Specialized switch devices can be identiﬁed by their distinct
508s
e
n
i
l
f
o
r
e
b
m
u
N
s
e
n
i
l
f
o
r
e
b
m
u
N
 140000
 120000
 100000
 80000
 60000
 40000
 20000
 0
 120000
 100000
 80000
 60000
 40000
 20000
 0
s
e
n
i
l
f
o
r
e
b
m
u
N
 300
 250
 200
 150
 100
 50
 0
Jan/06 Jan/07 Jan/08 Jan/09 Jan/10
Jan/06
Jan/07
Jan/08
Jan/09
Jan/10
Time
vlan
l3
acl
mgt
l1
l2
(a) All devices - GT
sec
cflt
qos
Time
vlan
l3
acl
mgt
l1
l2
(b) Median - GT
sec
cflt
qos
s
e
n
i
l
f
o
r
e
b
m
u
N
 200
 180
 160
 140
 120
 100
 80
 60
 40
 20
 0
Jan/06 Jan/07 Jan/08 Jan/09 Jan/10 Jan/11
Jan/06