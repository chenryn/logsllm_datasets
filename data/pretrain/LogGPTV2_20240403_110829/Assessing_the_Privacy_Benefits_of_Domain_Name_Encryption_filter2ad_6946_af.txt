[69] Y. Lu and G. Tsudik. 2010. Towards Plugging Privacy Leaks in the Domain Name
System. In 2010 IEEE Tenth International Conference on Peer-to-Peer Computing
(P2P). 1–10. https://doi.org/10.1109/P2P.2010.5569976
[70] Majestic. Accessed 2019. The Majestic Million. Web page. https://majestic.com/
reports/majestic-million
[71] MaxMind. 2019. MaxMind GeoLite2 Databases. https://www.maxmind.com/
[72] Patrick McManus. 2018. Improving DNS Privacy in Firefox. https://blog.nightly.
mozilla.org/2018/06/01/improving-dns-privacy-in-firefox/.
[73] Zubair Nabi. 2013. The Anatomy of Web Censorship in Pakistan. In FOCI.
USENIX, Berkeley, CA, Article 2, 7 pages.
[74] Milad Nasr, Amir Houmansadr, and Arya Mazumdar. 2017. Compressive Traffic
Analysis: A New Paradigm for Scalable Traffic Analysis. In Proceedings of the
2017 ACM SIGSAC Conference on Computer and Communications Security (CCS
’17). Association for Computing Machinery, New York, NY, USA, 2053–2069.
https://doi.org/10.1145/3133956.3134074
[75] Arian Akhavan Niaki, Shinyoung Cho, Zachary Weinberg, Nguyen Phong
Hoang, Abbas Razaghpanah, Nicolas Christin, and Phillipa Gill. 2020. ICLab:
A Global, Longitudinal Internet Censorship Measurement Platform. In IEEE
Symposium on Security and Privacy.
[76] Nick Nikiforakis, Marco Balduzzi, Lieven Desmet, Frank Piessens, and Wouter
Joosen. 2014. Soundsquatting: Uncovering the Use of Homophones in Domain
Squatting. In Information Security. Springer, 291–308.
[77] Nick Nikiforakis, Steven Van Acker, Wannes Meert, Lieven Desmet, Frank
Piessens, and Wouter Joosen. 2013. Bitsquatting: Exploiting Bit-flips for Fun,
or Profit?. In Proceedings of the 22Nd International Conference on World Wide
Web (WWW ’13). ACM, New York, NY, USA, 989–998. https://doi.org/10.1145/
2488388.2488474
[78] Andriy Panchenko, Fabian Lanze, Jan Pennekamp, Thomas Engel, Andreas
Zinnen, Martin Henze, and Klaus Wehrle. 2016. Website Fingerprinting at
Internet Scale. In Proceedings of NDSS ’16.
[79] Andriy Panchenko, Lukas Niessen, Andreas Zinnen, and Thomas Engel. 2011.
Website Fingerprinting in Onion Routing Based Anonymization Networks. In
Proceedings of the 10th Annual ACM Workshop on Privacy in the Electronic Society
(WPES ’11). Association for Computing Machinery, New York, NY, USA, 103–114.
https://doi.org/10.1145/2046556.2046570
[80] Elkana Pariwono, Daiki Chiba, Mitsuaki Akiyama, and Tatsuya Mori. 2018.
Don’T Throw Me Away: Threats Caused by the Abandoned Internet Resources
Used by Android Apps. In Proceedings of the 2018 on Asia Conference on Computer
and Communications Security (ASIACCS ’18). ACM, New York, NY, USA, 147–158.
https://doi.org/10.1145/3196494.3196554
[81] Simran Patil and Nikita Borisov. 2019. What Can You Learn from an IP?. In
Proceedings of the Applied Networking Research Workshop (ANRW ’19). ACM,
New York, NY, USA, 45–51. https://doi.org/10.1145/3340301.3341133
[82] Paul Pearce, Ben Jones, Frank Li, Roya Ensafi, Nick Feamster, Nick Weaver, and
Vern Paxson. 2017. Global Measurement of DNS Manipulation. In 26th USENIX
Table 3: Breakdown of the five largest TLDs studied.
Daily
1,031
7,556,066
3,835,080
347,993
264,057
263,262
210,701
Total
1,125
13,597,409
7,026,005
584,924
501,597
442,729
346,194
TLDs
FQDNs
.com
.org
.de
.net
.ru
Security Symposium (USENIX Security 17).
[83] Matthew Prince. 2018. Encrypting SNI: Fixing One of the Core Internet Bugs.
https://blog.cloudflare.com/esni/. Online; accessed September 2018.
[84] quantcast. Accessed 2019. Quantcast Top Websites. Web page. https://www.
quantcast.com/top-sites/
[85] Florian Quinkert, Tobias Lauinger, William Robertson, Engin Kirda, and
Thorsten Holz. 2019.
It’s Not What It Looks Like: Measuring Attacks and
Defensive Registrations of Homograph Domains. In 2019 IEEE Conference on
Communications and Network Security (CNS).
[86] Venugopalan Ramasubramanian and Emin Gün Sirer. 2005. Perils of Transitive
Trust in the Domain Name System. In Proceedings of the 5th ACM SIGCOMM
Conference on Internet Measurement (IMC ’05). USENIX Association, Berkeley,
CA, USA, 35–35. http://dl.acm.org/citation.cfm?id=1251086.1251121
[87] Rapid7. 2019. Rapid7: Open Data. https://opendata.rapid7.com/.
[88] Fahmida Y. Rashid.
Amazon joins Google
2018.
in shut-
https://duo.com/decipher/
down
ting
amazon-joins-google-in-shutting-down-domain-fronting.
fronting.
doamin
[89] E. Rescorla, K. Oku, N. Sullivan, and C. Wood. 2019. Encrypted Server Name
https://tools.ietf.org/html/
Internet Draft. IETF.
Indication for TLS 1.3.
draft-ietf-tls-esni-03
[90] Walter Rweyemamu, Christo Lauinger, Tobiasand Wilson, William Robertson,
and Engin Kirda. 2019. Clustering and the Weekend Effect: Recommendations
for the Use of Top Domain Lists in Security Research. In Passive and Active Mea-
surement, David Choffnes and Marinho Barcellos (Eds.). Springer International
Publishing, 161–177.
[91] Mahrud Sayrafi. 2018. Introducing DNS Resolver for Tor. https://blog.cloudflare.
com/welcome-hidden-resolver/. Online; accessed September 2018.
[92] Quirin Scheitle, Oliver Hohlfeld, Julien Gamba, Jonas Jelten, Torsten Zimmer-
mann, Stephen D. Strowes, and Narseo Vallina-Rodriguez. 2018. A Long Way to
the Top: Significance, Structure, and Stability of Internet Top Lists. In Proceed-
ings of the Internet Measurement Conference 2018 (IMC ’18). ACM, New York, NY,
USA, 478–493. https://doi.org/10.1145/3278532.3278574
[93] Will Scott, Thomas Anderson, Tadayoshi Kohno, and Arvind Krishnamurthy.
2016. Satellite: Joint Analysis of CDNs and Network-Level Interference. In
USENIX Annual Technical Conference.
[94] Craig A. Shue, Andrew J. Kalafut, and Minaxi Gupta. 2007. The Web is Smaller
Than It Seems. In Proceedings of the 7th ACM SIGCOMM Conference on Internet
Measurement (IMC ’07). ACM, New York, NY, USA, 123–128. https://doi.org/10.
1145/1298306.1298324
[95] Haya Shulman. 2014. Pretty Bad Privacy: Pitfalls of DNS Encryption. In Pro-
ceedings of the 13th Workshop on Privacy in the Electronic Society (WPES ’14).
ACM, New York, NY, USA, 191–200. https://doi.org/10.1145/2665943.2665959
[96] Janos Szurdi, Balazs Kocso, Gabor Cseh, Jonathan Spring, Mark Felegyhazi, and
Chris Kanich. 2014. The Long “Taile” of Typosquatting Domain Names. In 23rd
USENIX Security Symposium (USENIX Security 14). USENIX Association, San
Diego, CA, 191–206. https://www.usenix.org/conference/usenixsecurity14/
technical-sessions/presentation/szurdi
[97] Cisco Umbrella. Accessed 2019. Umbrella Popularity List. Web page. https:
//s3-us-west-1.amazonaws.com/umbrella-static/index.html
[98] Verisign. 2019. The Domain Name Industry Brief. Technical Report. Verisign.
https://www.verisign.com/assets/domain-name-report-Q12019.pdf
[99] Tao Wang, Xiang Cai, Rishab Nithyanand, Rob Johnson, and Ian Goldberg.
2014. Effective Attacks and Provable Defenses for Website Fingerprinting. In
Proceedings of the USENIX Security Symposium.
[100] Florian Weimer. 2005. Passive DNS replication. In FIRST conference on computer
security incident. 98.
[101] Charles V Wright, Scott E Coull, and Fabian Monrose. 2009. Traffic Morphing:
An Efficient Defense Against Statistical Traffic Analysis.. In NDSS.
[102] Joss Wright. 2014. Regional Variation in Chinese Internet Filtering. Information,
Communication & Society 17, 1 (2014), 121–141.
[103] Xueyang Xu, Z. Morley Mao, and J. Alex Halderman. 2011. Internet Censorship
in China: Where Does the Filtering Occur?. In Passive and Active Measurement
(LNCS), Vol. 6579. Springer, Berlin, Heidelberg, 133–142.
[104] Young Xu. 2016.
nical Report. Thousand Eyes.
deconstructing-great-firewall-china/
Deconstructing the Great Firewall of China.
Tech-
https://blog.thousandeyes.com/
[105] Fangming Zhao, Yoshiaki Hori, and Kouichi Sakurai. 2007. Two-Servers PIR
Based DNS Query Scheme with Privacy-Preserving. In Proceedings of the The
2007 International Conference on Intelligent Pervasive Computing (IPC ’07). IEEE
Computer Society, Washington, DC, USA, 299–302. https://doi.org/10.1109/
IPC.2007.107
[106] George Kingsley Zipf. 1929. Relative frequency as a determinant of phonetic
change. Harvard studies in classical philology 40 (1929), 1–95.
[107] J. Zittrain and B. Edelman. 2003.
IEEE Internet
Computing 7, 2 (March 2003), 70–77. https://doi.org/10.1109/MIC.2003.1189191
[108] ÃŞlafur GuÃřmundsson. 2018. Introducing DNS Resolver, 1.1.1.1. https://blog.
Internet filtering in China.
cloudflare.com/dns-resolver-1-1-1-1. Online; accessed September 2018.
A BREAKDOWN OF DOMAINS STUDIED
As shown in Table 3, our derived list comprises an average of 7.5M
popular fully qualified domain names (FQDNs) collected on a daily
basis, covering 1,031 TLDs. For the whole experiment duration, we
studied a total of 13.6M domains and 1,125 TLDs. Table 3 also shows
the top five largest TLDs in our dataset, with .com being the most
dominant, comprising more than 50% of the domains observed.
B POISONED RESPONSE SANITIZATION
While processing public DNS datasets from other sources (to which
we compare our findings in §6), we surprisingly discovered thou-
sands of low-ranked or obscure domains seemingly being co-hosted
on the same IP addresses that also host very popular websites, such
as Facebook and Twitter—which of course was not actually the case.
As part of our investigation, we observed that the authoritative
servers of most of these domains were located in China (using the
MaxMind dataset [71]). We then queried the same domains from
outside China using their authoritative servers, and indeed received
responses pointing to IP addresses that belong to either Facebook
or Twitter. By inspecting network traffic captures taken during
these name resolutions, we observed that the initial response con-
taining the wrong (falsified) IP address was followed by another
DNS response with the same valid DNS query ID that contained a
different (correct) IP address.
We attribute the above observed behavior to DNS-based censor-
ship by the “Great Firewall” (GFW) of China [1, 24, 67, 102, 104, 107],
which has also been observed and analyzed by previous studies [2,
39]. Censorship leakage happens due to the GFW’s filtering design,
which inspects and censors both egress and ingress network traffic.
While some censors (e.g., Pakistan, Syria, Iran) forge DNS responses
with NXDOMAIN [13, 20, 22, 73] or private addresses [12], mak-
ing them easier to distinguish, China poisons DNS responses with
routable public IP addresses belonging to other non-Chinese orga-
nizations [39, 49, 104]. In contrast to the findings of previous works,
however, in this case the real hosting IP addresses of the censored
domains are located within China, while previous works mostly
focus on investigating the blockage of websites that are hosted
outside China (e.g., google.com, facebook.com, blogger.com).
To validate our findings, we cross-checked the IP addresses from
second (real) DNS responses with the ones obtained by resolving
the same domains from locations in China. As the authoritative
servers of these domains are also in China, our queries did not cross
the GFW, which mostly filters traffic at border ASes [2, 26, 103],
and thus were not poisoned.
Table 4: Most frequently abused subnets in poisoned DNS
responses from China.
AS32934
Facebook
31.13.72.0
31.13.69.0
31.13.73.0
31.13.66.0
69.171.245.0
AS13414
Twitter
199.59.148.0
199.59.149.0
199.16.156.0
199.59.150.0
199.16.158.0
AS36351
SoftLayer
74.86.12.0
67.228.235.0
74.86.151.0
75.126.124.0
67.228.74.0
We follow this verification technique, where we issue additional
queries to resolve domains whose authoritative name server is
located in China and then detect injected DNS packets to exclude
poisoned responses from analyses. In total, we detected more than
21K domains based in China with poisoned responses. Table 4
shows the top /24 IP subnets belonging to Facebook, Twitter, and
SoftLayer, which are the most frequently observed in poisoned
responses. Our observation aligns with recent findings of other
censorship measurement studies [49, 75].
C REVERSE DNS LOOKUPS
The Internet Engineering Task Force (IETF) recommends that it
should be possible to conduct a reverse DNS lookup for every given
domain [37]. In a forward DNS lookup, a domain name is resolved
to an A (IPv4) record, while a reverse DNS lookup sends out an IP
address to ask for its associated FQDN. The DNS record storing
this information is called a PTR (pointer) record. Unless configured
Although performing reverse DNS lookups seems to be a straight-
forward way of mapping a given IP address back to its associated
FQDN, this can potentially uncover only single-hosted domains.
More importantly, not all reverse DNS queries return a (meaning-
ful4) domain name because the IETF’s recommendation is only
optional, and thus not adopted universally.
We analyzed Rapid7’s reverse DNS dataset, which contains PTR
records for the whole public IPv4 space, to see how many IP ad-
dresses could be used to reveal the visited destinations under the
assumed global ESNI deployment, by just performing a reverse DNS
lookup. We find that there are 1.27B unique IP addresses having PTR
records. Of these, at least 172M (14%) of them point to a meaningful
FQDN (i.e., not in the form of dash-separated IP segments). Within
this set of domains, we could find 136K single-hosted domains
observed by our dataset. This means about 10% of single-hosted
domains have PTR records configured. Under a global ESNI deploy-
ment, IP addresses of these domains would be detrimental to the
privacy of users who connect to them.
to point to a FQDN by its owner, it is not compulsory to configure
PTR records for every IP address.
As expected, we also observed more than 3M PTR records in
which domain names explicitly indicate through the prefix “mail”
that they correspond to email servers. These email servers support
PTR record because many providers will not accept messages from
other mail servers that do not support reverse lookups [66].
4Many PTR records are formatted with dash-separated IP segments. For example, the
Amazon EC2 IP address 54.69.253.182 has a PTR record to ec2-54-69-253-182.us-west-
2.compute.amazonaws.com, which may not actually correspond to a user-facing web
service.