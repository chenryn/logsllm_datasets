O Footprint L1
[Dom
This perf
mis a level
 1 (last b
I of a d
 Footprint L2
int of a do
O Footprint L3
[Dor
This perfon
a whi
 Show on startup
Show on emptygraph cick
xp>
Next>
Einish
Cancel
Help
图4.15选择主机
（7）该界面用来选择运行的主机，这里选择CompanyStalker（组织网）选项。然后单
击Next按钮，将显示如图4.16所示的界面。
（8）在该界面输入一个域名。然后单击Finish按钮，将显示如图4.17所示的界面。
· 106 ·
---
## Page 119
第4章信息收集
Start a Machine
Steps
Run Machine - Specify target (2 of 2)
Specify target
Choose machine
2.
The Cor
ng inputs
图4.16指定目标
Results Limited
 Don't show again
图 4.17Results Limited
（9）该界面提示信息在paterva.com主机中仅限于12个实体。在该界面选择Dontshow
again，然后单击OK按钮，将显示如图4.18所示的界面。
G目d
go Kali Linux Edition 3.4.0
C
1
HAAA
2
3
 Sart Page
 New Graph (1) ×]
NAINRG
Main View
Bubble View
Enty List
DNS Nam
图4.18运行的主机
· 107 ·
---
## Page 120
第2篇信息的收集及利用
（10）该界面显示了刚创建的paterva.com。如果没显示，在右侧栏Palette下选择Domain，
然后用鼠标拖拽域名到Graph中。在该界面选择paterva.com域名，将会在右侧栏显示
paterva.com域名的相关信息，如图4.19所示。该域名的信息可以修改，如修改域名。单击
PropertyView框中的DomainName，将鼠标选中当前的域名就可以修改。例如，将这里的
域名paterva.com修改为targethost.com，将显示如图4.20所示的界面。
E Detail View
Main View
Bubble View
Entity List
Domain
maltego.Dor
paterva.com
FORDEMO USEONLY
Properties
Type
Domain Name
paterva.com
ou udeg 
VHOIS Info
Veight
图4.19paterva.com 信息
Start Page
× New Graph (1)x
@ DetailView
Main View
Bubble View
Entity List
Domain
rwogolanjew
targethost.com
Property View
Properties
FORDEMO USEONLY
Domain Name
Type
targethost.com
WHOIS Info
Graph info
Weight
图4.20targethost.com信息
（11）一旦目标主机设置成功后，用户就可以启动收集信息。首先右击创建的域实体，
并选择RunTransform将显示有效的选项，如图4.21所示。
（12）在该界面可以选择寻找DNS名，执行WHOIS和获取电子邮件地址等等。或者
选择运行所有转换，显示结果如图4.22所示。
（13）从该界面可以看到获取了很多关于targethost.com的信息。用户也可以使用同样
的方法，单击子节点获取想要查看的信息。
用户可以使用Maltego映射网络。Maltego是由Paterva创建的一个开源工具，用于信
息收集和取证。前面分别介绍了Maltego的安装向导，通过拖曳它到图表中并使用该域实
· 108 ·
---
## Page 121
第4章信息收集
体。现在将学习允许Maltego去绘制自已的图表，并检查各种来源完成工作。因为用户可
以利用这一点自动化快速地在目标网络内收集信息，如电子邮件地址、服务器和执行
WHOIS查询等。
 Start Page CG New Graph(1)xCG New Graph (2)x
Main View
Bubble View
Entity List
由
 Run Transform
All Transforms
Q Run Machine
DNS from Domain
Copy to New Graph
Domain owner detail
Change Type
Email addresses from Domain
Merge
Files and Documents from Domain
Clear/Refresh
Other transforms
Attach
All transforms
Type Actions
Copy
FORDEMOUSEONLY
Copy (as List)
Cut
Delete
图4.21启动收集信息
 Stat PageC New Graph()CG New Grnagh (2) *
Main View
BbbleVieEnttyList由
 Output - Transform Output
图4.22信息收集
用户可以通过TransformManager窗口中AllTransforms标签，启动和禁用转换节点，
如图4.23所示。
· 109 ·
---
## Page 122
第2篇信息的收集及利用
Transform Manager
X
3X
 Aias
0
lasToFacebookProfile
图 4.23Transform Manager 界面j
在该界面列出了所有转换节点。为了能够使用几个转换节点，必须先接受disclaimer。
接受disclaimer的方法，在该界面选择转换节点后，单击最底部的Viewdisclaimer按钮，
将显示如图4.24所示的界面。
Transform Disclaimer
X
Please note this trarsform is being run on the Patena Transform
MacPhersor. Ths trarsfom wil be nun on
http://lalpine.patenva.com/cgi-bin/flickrGetFriends-py and Patenva
trarsform,you run this AT voUR OwN RISK. Fer more
cannot be held responsible for any damage carused by this
Indrew@ patena.com Addi
outside of this worlishep
tional: PoC Onily Please do not use
Ia
图 4.24Transform Disclaimer
在该界面将Iaccepttheabovedisclaimer复选框勾上，然后单击Close按钮就可以了。
4.9
绘制网络结构图
CaseFile工具用来绘制网络结构图。使用该工具能快速添加和连接，并能以图形界面
形式灵活的构建网络结构图。本节将介绍MaltegoCaseFile的使用。
在使用CaseFile工具之前，需要修改系统使用的Java和Javac版本。因为CaseFile工
•110 •
---
## Page 123
第4章信息收集
具是用Java开发的，而且该工具必须运行在Javal.7.0版本上。但是在KaliLinux中，安装
了JDK6和JDK7，而CaseFile默认使用的是JDK6。此时运行CaseFile工具后，图形界面
无法显示菜单栏。所以就需要改变JDK版本，改变JDK版本的方法如下所示。
使用update-alternatives命令修改java命令版本。执行命令如下所示：
root@kali:~# update-alternatives --config java
有2个候选项可用于替换java（提供/usr/bin/java）
选择
路径
优先级
状态
*0
/usr/lib/jvm/java-6-openjdk-i386/jre/bin/java
1061
自动模式
1
/usr/lib/jvm/java-6-openjdk-i386/jre/bin/java
1061
手动模式
2
/usr/lib/jvm/java-7-openjdk-i386/jre/bin/java
1051
手动模式
要维持当前值[*请按回车键，或者键入选择的编号：2
#输入JDK7版本编号
update-alternatives: using /usr/lib/jvm/java-7-openjdk-i386/jre/bin/java to provide /usr/bin/java
(java）in手动模式
从输出的信息中可以看到已经修改为JDK7版本，而且是手动模式。或者使用java命
令查看当前的版本信息，执行命令如下所示：
root@kali:~# java -version
java version“1.7.0_25”
OpenJDK Runtime Environment (IcedTea 2.3.10) (7u25-2.3.10-1~deb7u1)
OpenJDK Server VM (build 23.7-b01, mixed mode)
比格
从以上结果中可以确定当前系统的java命令版本是1.7.0
使用update-alternatives命令修改javac命令版本。执行命令如下所示：
root@kali: ~# update-alternatives --config javac
有2个候选项可用于替换javac（提供/usr/bin/javac）。
选择
路径
优先级
状态
* 0
/usr/lib/jvm/java-6-openjdk-i386/bin/javac
1061
自动模式
1
/usr/lib/jvm/java-6-openjdk-i386/bin/javac
1061
手动模式
2
/usr/lib/jvm/java-7-openjdk-i386/bin/javac
1051
手动模式
要维持当前值[]请按回车键，或者键入选择的编号：2
#输入JDK7版本编号
update-altermatives: using /usr/lib/jvm/java-7-openjdk-i386/bin/javac to provide /usr/bin/javac
(javac）in手动模式
从输出的信息中可以看到已经修改为JDK7版本，而且是手动模式。这时，再使用javac
命令查看当前的版本信息，执行命令如下所示：
root@kali:~#javac-version
java version"1.7.0_25"
从以上结果中可以确定当前系统的javac命令版本是1.7.0。
【实例4-7】使用CaseFile工具绘制一个网络结构图。具体操作步骤如下所示。
（1）启动CaseFile。依次选择“应用程序”KaliLinux“信息收集”“情报分析”casefile
命令，将显示如图4.25所示的界面。
· 111 •
---
## Page 124
第2篇信息的收集及利用
Welcome to Maltego!
Steps
Startup wizard - Welcome (1 of 2)
2
Ready..Set..Go
Welcome to Maltego CaseFile!
We hope that you enjoy using our product as much as we
enjoy building itl
EGO
casefile
Einish
Cancel
Help
图4.25欢迎界面
（2）该界面是一个欢迎信息，这里单击Next按钮，将显示如图4.26所示的界面。
Welcome to Maltegol
Steps
Startup wizard Ready..Set..Go! (2 of 2)
Ready...Set...GO!
jxau op o1 juem noA op jeqM
 Open a blank graph and let me play around
 Open an example graph
 Go away, 1 have done this before!
case file
Einish
Help
图4.26设置向导
(3）该界面选择将要进行什么操作。这里选择Openablankgraphandletmeplay around，
然后单击Finish按钮，将显示如图4.27所示的界面。
（4）从该界面可以看到没有任何信息，因为默认没有选择任何设备。该工具和Maltego
工具一样，需要从组件Palette中拖曳每个实体到图表中。本例中选择拖曳域实体，并且改
变域属性，如图4.28所示。
（5）在该界面可以为域添加一个注释。将鼠标指到域实体上，然后双击注释图标，将
显示如图4.29所示的界面。
• 112 ·
---
## Page 125
第4章信息收集
Maltego CaseFile Cor
nunity 1.0.1
Investigate
Manage
Organize
Copy
HAAA
Paste Clea
KCut
Quick
Entity
%xx
Delete
Selection.。食
AlI
Find
ard
Find
Selection
Pal.
ge New Graph (1) ×
2 Over.
 Devic...
Main View
Bubble View
Entity List
Desktop
A person
Device
C Detai.- x
A device
Mobile (
A portab
o selectio
Mobile F
A device
Prope.x
图4.27初始界面
电日话
Investigate
Manage
Ado
HAAA
Paste Clear
Delete
Cut
%XX
AlI
Find
Selectik
geC New Graph （1)*x
Dverv
O-Events
Main View
Bubble View
Entity List-
Infra.
AS
DNS Na
paterva.com
maA Ajadoay
IPv4 Adc
IPveI
图4.28域名实体
智电目
Investigate
ebJo