-k++++++:+++++Defined+SRTP+key++(uK+RfjSi9/fUFr8zoJu6zdqPw6MGtONhgX4yqwRj+in+this+case)+
• 
Normal_Call_two_parties.pcap++
+Input+file+
• 
decoded.raw+
+
+
+Output+file+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+decoded.raw+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Importing+Decrypted+Content+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Importing+Decrypted+Content+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Imported+Decrypted+UDP+Packets+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Decode+As+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Decode+As+RTP+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Decoded+Packets+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Checking+RTP+Streams+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Analysing+RTP+Streams+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SRTP+Decrypt:+Playing+Decrypted+Call+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp+
• 
Implementation+of+the+Secure+Real-time+Transport+Protocol+(SRTP)+
+
• 
Can+decipher+SRTP+packets+
+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp+
• 
GitHub:+github.com/cisco/libsrtp++++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Installation+
• 
Cloning+
+
+
+
+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Installation+
• 
Configure+
+
+
+
+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Installation+
• 
Make+
+
+
+
+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Ready+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+SRTP+key+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Copying+SRTP+key+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Filtering+for+one+sender+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Filtering+single+RTP+stream+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Exporting+filtered+traffic+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Saving+exported+traffic+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Command+
• 
./rtp_decoder+-a+-t+10+-e+128+-b+2stvabBcXXf3HtaHCSsB8WACeRBst9f7lwLqlzqE+*++./Normal_Call_two_parties_Decrypted.pcap+
+
• 
-t+++++++++++++++++++++++++Treat+the+text+before+the+packet+as+a+date/time+code+
• 
%M:%S+++++++++++++++Time+format+
• 
-u+++++++++++++++++++++++++Prepend+dummy+UDP+header+with+specified+source+and+destination+ports+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Decrypting+RTP+traffic+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Decrypted+traffic+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Decode+as+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Decode+as+RTP+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Decrypted+RTP+traffic+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Analysing+RTP+Streams+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Analysing+RTP+Streams+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Libsrtp:+Playing+decrypted+call+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Other+Important+Parts?+
•  DTMF+
+
•  Messages+(SMS)+
+
•  Exporting+Call+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
RTP+DTMF+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Message+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Online+service++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Uploading+PCAP+and+Downloading+Wav+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Wav+in+audacity+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Offline+script+
• 
Bash+script+to+extract+the+audio+from+VoIP+calls+
+
• 
Outputs+.wav+file+
+
• 
Uses+tshark+and+sox+
+
• 
GitHub:+https://gist.github.com/avimar/d2e9d05e082ce273962d742eb9acac16++
+
+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Help+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Installing+tshark+and+sox+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Running+the+tool+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Directory+contents++
• 
Directory+content+before+running+the+script+
+
+
+
+
• 
Directory+content+after+running+the+script+
+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
PCAP2WAV:+Wav+in+audacity+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark+
• 
Collection+of+Wireshark+plugins+to+
–  Decrypt+VoIP+calls+
–  Export+call+audio+
–  Overview+of+traffic+(Extensions,+SMS,+DTMF)+
–  Common+VoIP+attacks+
+
• 
GPL+just+like+Wireshark+
+
• 
Github:+github.com/pentesteracademy/voipshark++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+Need?+
• 
Cumbersome+and+complex+process+
+
• 
Multiple+tools+
–  Need+compilation,+hence+time+consuming+to+set-up++
–  Not+easy+to+use+
–  User+dependent,+prone+to+mistakes+
+
• 
Inability+to+retain+timestamp,+IP+addresses+etc.+during+decryption+
+
• 
Live+traffic+not+supported+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Why+Wireshark+Plugins?+
• 
Plug+and+play+
+
• 
Plugins+can+be++
–  Lua+scripts+
–  Compiled+C/C+++code+
+
• 
Harnessing+power+of+Wireshark+
+
• 
OS+independent+
+
• 
Large+user+base+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Wireshark+Plugins+Types+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Dissector+
• 
To+interpret+the+payload+data+
+
• 
Decodes+its+part+of+the+protocol+and+passes+the+payload+to+next+
+
+
+
Example/Dissection/Flow+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Chained+Dissector+
• 
Takes+data+from+previous+dissector,+processes+its+part+and+pass+the+payload+to+next+
dissector+
Example/Dissection/Flow 
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+Hook+in+Dissector+Chain+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+Overall+Architecture+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+Decryption+Routines+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Plugins+locations+
• 
Check+Help+>+About+Wireshark+>+Folders+
/
/Windows////////////////////////////////////////////////////////////////////////////////////Ubuntu+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Decrypting+SRTP:+SRTP+Packets+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Decrypting+SRTP:+Enabling+Auto+Decryption+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Decrypting+SRTP:+Decrypted+SRTP+(RTP)+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+Exporting+Call+Audio+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Exporting+Call+Audio:+Specifying+Location+and+File+name+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
Exporting+Call+Audio:+Exported+Streams++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+SIP+Information+Gathering++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering+:+DTMF+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering:+Extensions+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering:+RTP+Packet+Transfers+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering+:+SIP+Auth+Export+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering+:+Servers+and+Proxy+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
SIP+Information+Gathering:+Unique+Messages++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
VoIPShark:+VoIP+Attack+Detection+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
+VoIP+Attack+Detection:+Bruteforce+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
+VoIP+Attack+Detection:+Invite+Flooding++
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
+VoIP+Attack+Detection:+Message+Flooding+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
+VoIP+Attack+Detection:+MiTM+Attempts+
PentesterAcademy.co
m/
©PentesterAcademy.com 
PentesterAcademy.co
m/
+VoIP+Attack+Detection:+Unauthenticated+Users+
PentesterAcademy.co
m/
©PentesterAcademy.com 
Demo+
PentesterAcademy.co
m/
©PentesterAcademy.com 
Q+&+A+
+
Github:+github.com/pentesteracademy/voipshark+
PI:EMAIL+