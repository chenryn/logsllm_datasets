title:Lights on Power Plant Control Networks
author:Stefan Mehner and
Franka Schuster and
Oliver Hohlfeld
Lights on Power Plant Control Networks
Stefan Mehner(B), Franka Schuster, and Oliver Hohlfeld
Brandenburg University of Technology
{stefan.mehner,franka.schuster,oliver.hohlfeld}@b-tu.de
Cottbus – Senftenberg, Cottbus, Germany
Abstract. Industrial Control Systems (ICS) are critical systems to our
society. Yet they are less studied given their closed nature and often the
unavailability of data. While few studies focus on wide-area SCADA sys-
tems, e.g., power or gas distribution networks, mission critical networks
that control power generation are not yet studied. To address this gap,
we perform the ﬁrst measurement study of Distributed Control System
(DCS) by analyzing traces from all network levels from several opera-
tional power plants. We show that DCS networks feature a rather rich
application mix compared to wide-area SCADA networks and that appli-
cations and sites can be ﬁngerprinted with statistical means. While traces
from operational power plants are hard to obtain, we analyze to which
extent easier to access training facilities can be used as vantage points.
Our study aims to shed light on traﬃc properties of critical industries
that were not yet analyzed given the lack of data.
1 Introduction
Insights gained from two decades of Internet measurement research enabled the
evolution and optimization of Internet technology—including Internet perfor-
mance and security. This research has provided many fundamental results on
network operation or network traﬃc that form the basis for network planning
or optimization (e.g., the ﬁnding of the self-similar character of Internet traf-
ﬁc [9] or the evolving application mix [11]). These eﬀorts focus on the Internet
as the largest and general-purpose communication network. In contrast, impor-
tant application-speciﬁc networks that increasingly rely on Internet technologies
received less attention from a measurements’ perspective yet, e.g. power plants.
The Hidden Networks. Critical industrial systems such as power plants rely
on industrial control systems (ICS) for their operation. These systems are based
on proprietary protocols and typically closed. Especially the access to critical
infrastructures in the energy and water sector is highly restricted, which limits
the potential for conducting measurement studies. As a result, little is pub-
licly known about networks, which limits research potential for enhancements,
e.g., to improve their security. While these networks experience an attack vec-
tor of increasing relevance [8], the little public knowledge about their properties
and functions limits the design of mitigation strategies. By studying traﬃc-level
properties of operational power plants, we make step towards closing this gap.
c(cid:2) The Author(s), under exclusive license to Springer Nature Switzerland AG 2022
O. Hohlfeld et al. (Eds.): PAM 2022, LNCS 13210, pp. 470–484, 2022.
https://doi.org/10.1007/978-3-030-98785-5_21
Lights on Power Plant Control Networks
471
Related Work. Prior work on measurement of real infrastructure traﬃc focused
on SCADA networks. While SCADA networks control the interactions of dis-
persed assets to enable power and water distribution, Distributed Control Sys-
tems (DCS) are dedicated to the control of the local core processes in power
plants and water treatment sites [15]. The most recent SCADA work shows that
IEC 60870-5-104 is used as the only protocol in the studied infrastructure [10]. In
contrast, our work will show that DCS systems feature a much richer application
mix. Other studies investigated in water treatment and distribution facilities, a
gas utility as well as an electricity and gas utility. They show that SCADA traﬃc
largely diﬀers from Internet traﬃc given the absence of human users (and thus
diurnal patterns) and self-similarity [3]. In later works, the same authors prove
that traﬃc in SCADA networks is periodic and provides a stable connection
matrix [2,5]. Since these prior measurements focussed on SCADA infrastruc-
tures, we will complete the picture (for the energy sector) by focussing on the
DCS part of the energy supply by investigating four operational real power
plants.
Our Contribution. In this ﬁrst of its kind study, we shed light on traﬃc
properties of critical yet unstudied type of infrastructure networks: internal (i.e.,
not intentionally Internet facing) control networks of three power plants and one
power plant simulation facility. Our study is enabled by the rare opportunity to
capture traﬃc traces during maintenance slots at three operational power plant
sites. Our main objective is to provide a ﬁrst empirical perspective on these
otherwise hidden networks since traﬃc properties pave the way for controlled
simulation and evaluation studies. Our contributions are as follows.
– We show that DCS networks in power plants feature a rich protocol mix that
diﬀers by automation layer. This is in contrast to typical SCADA networks
that are often realized using a single protocol only. That is, while a recent
survey [6] found in every ICS testbed one dominant protocol, we show that
in power plant DCS features ‘zoo’ of protocols on diﬀerent network levels.
– We show that the proprietary and publicly undocumented ICS protocols used
can be identiﬁed by applying statistical clustering approaches. These cluster-
ings even work in the absence of payload by analyzing inter-arrival times and
header information.
– We ﬁnally applied our methods to a dataset from a plant simulator that serves
as training facility. Given that measurements in operational power plants can
only be conducted in rare maintenance windows, we study if easier to access
simulation facilities are an option for measurements.
2 ICS 101
ICS aim at controlling and supervising machines or processes (e.g., coal ﬁring).
SCADA vs. DCS. There is not one type of ICS, but many [7]. Most promi-
nently, both SCADA and DCS systems enable the supervision and control of
industrial processes. Studied types of SCADA networks are wide-area networks
472
S. Mehner et al.
that are scattered over hundreds of kilometers, e.g., bulk power grids for power
distribution [10] or water treatment and distribution facilities [2,5]. In contrast
to the widely studied SCADA network, DCS oﬀer integrated solutions provided
by a single vendor and are thus often designed for local use—like the power plant
networks studied in this paper. Consequently, the used protocols and traﬃc pat-
terns in both network types diﬀer and, as a consequence, it is not possible to
infer the characteristics of one network type from the characteristics of the other.
For example, IEC 60870-5-104 (one of the most widely used SCADA protocols,
e.g., studied in [10]) is a telecontrol protocol that does not play any role in DCS.
Also, SCADA networks are dominated by a single or few protocols, while—as we
will show—the integrated nature of DCS systems yields a much richer protocol
mix. The unstudied nature of DCS traﬃc thus motivates our work.
Fig. 1. Network architecture levels of plant DCS with vantage point locations.
ICS Architecture. While ICS diﬀer in their physical extension and associated
network characteristics, they are quite similar in terms of network organization.
Typically they follow a layered, hierarchical design. The lowest network part,
the Field Network, consists of the physical level, including sensors and actuators
measuring and adjusting basic physical parameters (e.g., temperature, pressure,
speeds, feeds). They are connected to programmable logic controllers (PLC).
Each PLC controls actuators and/or monitors sensors and hence realizes a low-
level control according to an implemented application-speciﬁc control loop. In
the Control Network, inputs from various PLC are collected and evaluated by
subsystem-speciﬁc servers in order to aggregate all activities corresponding to a
subprocess. For power plants, these sub-processes include, for example, temper-
ature monitoring of the boiler. There are also servers that prepare the process
data for visualization on the Human Machine Interfaces (HMI) and others that
Lights on Power Plant Control Networks
473
connect legacy systems to the control system. Monitoring and manual adjust-
ment of the physical process is realized in the Supervisory Network. Here the
operator interacts with the subsystems via HMI that incorporate the data from
the Control Network.
Power Plants. ICS in plants use DCS architectures, often realized as large pro-
prietary networks provided by a single vendor. As such, the concrete network
design including its conﬁguration (e.g., addressing schemes) is vendor depen-
dent and diﬀers. We observe three typical server types in plants, which are
also depicted in Fig. 1. Automation servers (Auto) provide so-called automa-
tion objects that enable clients to automate well-deﬁned procedures by directly
accessing reusable functionality made available by the server. Migration servers
(Mig) aggregate data from Field-Network communication to representations
appropriate for the application servers (App) connected to the Control Network.
These application servers in turn realize further data preparation for graphical
applications, such as the control center’s screens, attached to the Supervisory
Network. Another characteristic is that these networks are rarely upgraded. In
the case of power plants, operators only plan for one network upgrade during the
entire lifetime of a power plant, i.e., once installed, the networks run for decades
without major changes. This is in stark contrast to classical Internet-networks
that are upgraded much more frequently.
3 Power Plant Datasets
Our study is based on packet traces captured at three operational power plants
(see Table 1). The traces contain traﬃc from all physical subprocesses including
coal ﬁring, ﬂuid ﬂow, and turbine operation. As our datasets account for two of
the leading vendors of control systems that are of widespread use world-wide,
they enable us to provide a representative picture of traﬃc characteristics.
Table 1. Dataset overview
Vendor Level
Duration # packets # devices
Plant 1 A
Plant 2 B
Plant 3 B
Supervisory 3.3 h
Control
Field
18.6 h
1.4 h
Control
Control
54.9 h
2.7 h
38 M
96 M
6 M
17 M
61 M
39
44
52
89
65
Plant 1. The ﬁrst dataset was captured in the main process control network of a
unit of capacity class of 800/900 MW as part of a two-unit coal-ﬁred power plant.
We were allowed to monitor vantage points at all three network levels shown in
Fig. 1. In this network, process control technology of type A (we omit vendor
names due to a non-disclosure agreement) from one of the few major vendors in
this ﬁeld is installed, which is of widespread use in power plants worldwide.
474
S. Mehner et al.
Plant 2. This trace was taken at the control level network of one unit of a multi-
unit coal-ﬁred power plant of capacity class (in total) of 1000 MW. The control
system is from a diﬀerent vendor also being a dominant supplier in that ﬁeld.
The main activity of the system is realized by virtualized components encapsu-
lating machine-to-machine communication. Since communication within virtual
environments does not leave the hosting machines, virtual machine-to-machine
communication is not seen on the wire and a signiﬁcant proportion of process
communication could not be captured by listening at the chosen network switch.
That is why the captured process traﬃc is incomplete. Since virtualization is a
new trend in ICS, this trace represents network traﬃc visible in newer systems.
Plant 3. The third dataset was taken at a third black coal power plant, also
at the control level network of the process control system. In contrast, here
the control system was shared among both units representing in total 700 MW
installed capacity. Here, the applied process control system is of the same type
as the one in Plant 2. In contrast, no system components are virtualized and
thus more process control traﬃc is visible.
Some Plant Network Details. We observed that the interaction between the
identiﬁed network levels is deﬁned by separated networks, each having its own
IP subnet. The communication among multiple levels is realized by a certain set
of clients and servers that are connected to one or two network levels. In our
case, the supervisory network in the studied plants is not intentionally connected
to the Internet for remote access. Remote access is a procedure that has also to
be manually initiated from inside the power plants and is only performed when
necessary. Except for one system that, due to legal regulations, has to regularly
report pollution measurements to authorities, no data is made available to out-
side. In all considered plant networks the IP address assignment is static and
the only security devices installed are border ﬁrewalls to higher-level networks of
the owner company or dedicated networks for remote access. The network link
speeds are 1 GBit/s. The average packet rates can be derived from Table 1.
Measurement Setup. The data was captured during the downtime of the phys-
ical generation process during a regular maintenance. In this time, the physical
processes were stopped (i.e., no power was produced). However, the operators
and the system vendors conﬁrmed that the DCS is running in normal operation,
only links to physical actuators are deactivated. For this reason, we assume the
application mix studied in this work to be the same as in normal operation. Yet
the content of control messages and network load might diﬀer to normal opera-
tion (not studied). We captured all traces using tcpdump [1] and port mirroring
at one or several switches placed in the network part/s stated to the datasets.
Vantage points were chosen to capture traﬃc from servers relevant to plant
operation. Not all vantage points shown in Fig. 1 were available at all power
plants.
Ethics. The operators granted permission to capture traﬃc during maintenance
intervals in which it was ensured that our setup cannot impair physical processes.
All traces contain only machine-to-machine traﬃc. We do not reveal ICS protocol
details or network conﬁgurations that could help in attacking these power plants.
Lights on Power Plant Control Networks
475
4 The Rich Application Mix of Power Plant ICS
Networks
A common assumption is that ICS networks are dominated by a single proto-
col only, e.g., which controls the automation process. Prior work showed that
this is indeed the case in a number of industrial settings and identiﬁed Mod-
bus TCP/MMS [3–5] and IEC 104 [10] as typical protocols used. This originates
from the dedicated design of many SCADA networks and is in contrast to the
typical Internet application mix that is dominated by diﬀerent protocols (see
e.g., as observed at an IXP [14]). The existence of only a single control protocol
can ease network management and dimensioning. In this section, we show that
this common assumption of a single dominant protocol is not the case for all
industrial settings. We show that the integrated DCS architecture of the studied
power plants yields a more complex traﬃc composition than commonly believed
by actually representing a mix of diﬀerent application protocols.
4.1 Application Mix of Power Plant 1
Approach. We refer to an “application protocol” as a protocol used to trans-
mit application payload—regardless of the underlying transport protocol. We
thus omit network control protocols such as ARP and LLC, but consider COTP
that also is a MAC-layer protocol. Frequently used dissectors (e.g., by tshark or
Zeek) can identify common Internet protocols. ICS networks, however, often use
proprietary protocols which are not recognized by such tools. We thus manually
inspected all traﬃc traces and created payload based identiﬁers for each propri-
etary protocol. We further identify known Internet protocols (e.g., HTTP/NTP)
by the destination port in Zeek logs. All well known protocols are mapped by
their name, while the remaining ones are shown by their port number.
HTTPS
12,8 %
SMB
other
6,2 %
RMI Reg
DCE RPC
SPPA
12,8 %
NTP
10,5 %
ICS 2
14,8 %
ICS 1
56,2 %
Java RMI
76,6 %
COTP
100 %
(a) Supervisory Level
(b) Control Level
(c) Field Level
Fig. 2. Application mix of Plant 1 divided into the hierarchical layers.
Protocol Shares Diﬀer Substantially by Level. Figure 2 shows the protocol
mix of Power Plant 1 by hierarchical layer. While only COTP is visible at the
lowest layer (ﬁeld), above layers show more protocol variety, as we discuss next.
476
S. Mehner et al.
Field Level. We observe one dominant protocol (COTP as identiﬁed by Wire-
sharks dissector) that is served via Ethernet with 100% traﬃc share. The reason
is that on ﬁeld level point-to-point communication with sensors and actuators
(e.g., using Proﬁnet IO to meet real-time guarantees) is used. The sensor data
is then directly encapsulated on top of Ethernet as payload using proprietary
protocols. At the control and supervisory level, all communication is IP-based
and thus UDP and TCP are the dominant transport protocols. However, both
layers diﬀer substantially in transport protocol share. While the supervisory level
shows 99.0% TCP communication, the control level shows 40.9% UDP traﬃc.
Control Level. The application mix at the control level features multiple pro-
tocols, see the protocol share by packets in Fig. 2b. This is rooted in multiple
functions that are performed at the control level. First, sensor data is obtained
from ﬁeld level devices and then aggregated and processed by migration and
automation servers (see Fig. 1). Aggregated data is then prepared for graphical
representation (at the supervisory level) by application servers. The communica-
tion between the migration and the application servers is based on two protocols.
The ﬁrst is a proprietary TCP-based protocol that we observe on multiple ports,
referred to as ICS 1. With a share of 56,2% of the exchanged packets it is the
dominant protocol at the control level. The second, referred to as ICS 2, is a
UDP-based protocol used to share information between multiple servers via IP
multicast. Automation servers, that are responsible for the time-critical automa-
tion process, further communicate with application servers by using a proprietary
protocol—we call SPPA—on ports 10002 and 10003. In Sect. 5, we describe in
detail our approach of identifying the protocols on the diﬀerent port numbers.
Beyond these proprietary ICS protocols, we also see RPC communication with
the supervisory layer using Java RMI (for graphical representation) and further
classical Internet protocols such as NTP.
Supervisory Level. The communication at the supervisory level is dominated
by Java RMI based RPC communication, see Fig. 2a again showing the packet
share per protocol. Proprietary or classical ICS protocols known in the SCADA
domain are absent. Java RMI based RPC communication is used for graphi-
cal representation by browser-based thin clients at the supervisory level, which
interact with application servers. As in the control level, there is an RMI registry,
here on port 1099, with a share of 5.3%. The app mix is dominated by two RMI
RPC-based applications each running on a diﬀerent port with a share of 44.2%