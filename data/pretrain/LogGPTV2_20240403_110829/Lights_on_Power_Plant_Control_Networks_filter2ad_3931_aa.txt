# Title: Insights into Power Plant Control Networks

## Authors
Stefan Mehner, Franka Schuster, and Oliver Hohlfeld  
Brandenburg University of Technology  
{stefan.mehner, franka.schuster, oliver.hohlfeld}@b-tu.de  
Cottbus â€“ Senftenberg, Cottbus, Germany

## Abstract
Industrial Control Systems (ICS) are critical to our society. However, due to their closed nature and the limited availability of data, they remain under-studied. While some studies have focused on wide-area SCADA systems, such as power or gas distribution networks, mission-critical networks that control power generation have not been extensively examined. To address this gap, we conducted the first measurement study of Distributed Control Systems (DCS) by analyzing network traces from several operational power plants. Our findings indicate that DCS networks feature a more diverse application mix compared to wide-area SCADA networks, and applications and sites can be fingerprinted using statistical methods. Although obtaining traces from operational power plants is challenging, we also explore the potential of using training facilities as accessible vantage points. This study aims to provide insights into the traffic properties of critical industrial networks that have not yet been analyzed due to the lack of data.

## 1. Introduction
Two decades of Internet measurement research have enabled significant advancements in Internet technology, including improvements in performance and security. These studies have provided fundamental insights into network operation and traffic, which form the basis for network planning and optimization. For example, the self-similar character of Internet traffic [9] and the evolving application mix [11] have been well-documented. However, important application-specific networks, such as those in power plants, have received less attention from a measurement perspective.

### The Hidden Networks
Critical industrial systems, such as power plants, rely on ICS for their operation. These systems are often based on proprietary protocols and are typically closed. Access to critical infrastructures in the energy and water sectors is highly restricted, limiting the potential for conducting measurement studies. As a result, little is publicly known about these networks, which hinders research efforts aimed at enhancing their security. Despite the increasing relevance of attack vectors [8], the limited public knowledge about their properties and functions restricts the design of effective mitigation strategies. By studying traffic-level properties of operational power plants, we aim to close this gap.

## 2. Related Work
Previous work on the measurement of real infrastructure traffic has primarily focused on SCADA networks. SCADA networks control the interactions of dispersed assets, enabling power and water distribution. In contrast, Distributed Control Systems (DCS) are dedicated to controlling local core processes in power plants and water treatment sites [15]. Recent SCADA studies have shown that IEC 60870-5-104 is the only protocol used in the studied infrastructure [10]. Our work, however, reveals that DCS systems feature a much richer application mix. Other studies have investigated water treatment and distribution facilities, gas utilities, and electricity and gas utilities. These studies show that SCADA traffic differs significantly from Internet traffic due to the absence of human users and the presence of self-similarity [3]. Later works have demonstrated that SCADA traffic is periodic and provides a stable connection matrix [2, 5]. Since these prior measurements focused on SCADA infrastructures, we aim to complete the picture for the energy sector by focusing on the DCS part of the energy supply, specifically by investigating four operational power plants.

## 3. Our Contribution
In this pioneering study, we shed light on the traffic properties of critical yet unstudied infrastructure networks: internal control networks of three power plants and one power plant simulation facility. Our study was made possible by the rare opportunity to capture traffic traces during maintenance slots at three operational power plant sites. Our main objective is to provide an empirical perspective on these otherwise hidden networks, as traffic properties pave the way for controlled simulation and evaluation studies. Our contributions are as follows:

- **Rich Protocol Mix**: We demonstrate that DCS networks in power plants feature a rich protocol mix that varies by automation layer. This contrasts with typical SCADA networks, which often use a single protocol. While a recent survey [6] found that each ICS testbed had one dominant protocol, we show that power plant DCS networks feature a "zoo" of protocols across different network levels.
- **Statistical Clustering**: We show that proprietary and publicly undocumented ICS protocols can be identified using statistical clustering approaches. These clusterings work even in the absence of payload by analyzing inter-arrival times and header information.
- **Simulation Facilities**: We applied our methods to a dataset from a plant simulator that serves as a training facility. Given that measurements in operational power plants can only be conducted during rare maintenance windows, we investigate whether easier-to-access simulation facilities can serve as viable alternatives for measurements.

## 4. ICS 101
ICS are designed to control and supervise machines or processes, such as coal firing. There are two main types of ICS: SCADA and DCS. SCADA networks are wide-area networks that span hundreds of kilometers, such as bulk power grids for power distribution [10] or water treatment and distribution facilities [2, 5]. DCS, on the other hand, offer integrated solutions provided by a single vendor and are designed for local use, such as the power plant networks studied in this paper. Consequently, the protocols and traffic patterns in both network types differ, and it is not possible to infer the characteristics of one type from the other. For example, IEC 60870-5-104, a widely used SCADA protocol, does not play a role in DCS. SCADA networks are dominated by a single or few protocols, while DCS systems, as we will show, feature a much richer protocol mix.

### ICS Architecture
ICS typically follow a layered, hierarchical design. The lowest level, the Field Network, consists of physical components like sensors and actuators, which measure and adjust basic parameters such as temperature, pressure, and speed. These components are connected to Programmable Logic Controllers (PLCs), which control actuators and monitor sensors, implementing low-level control loops. The Control Network collects inputs from various PLCs and evaluates them using subsystem-specific servers to aggregate activities corresponding to a subprocess. For power plants, these subprocesses include, for example, temperature monitoring of the boiler. Servers in the Control Network also prepare process data for visualization on Human Machine Interfaces (HMIs). The Supervisory Network enables monitoring and manual adjustment of the physical process through HMIs, which incorporate data from the Control Network.

### Power Plants
ICS in power plants use DCS architectures, often realized as large proprietary networks provided by a single vendor. The specific network design, including configuration, varies by vendor. We observed three typical server types in power plants: Automation servers (Auto), Migration servers (Mig), and Application servers (App). Automation servers provide automation objects that enable clients to automate well-defined procedures by directly accessing reusable functionality. Migration servers aggregate data from Field-Network communication to representations suitable for Application servers, which in turn prepare data for graphical applications, such as the control center's screens. Another characteristic of these networks is that they are rarely upgraded. For power plants, operators typically plan for only one network upgrade during the entire lifetime of the plant, meaning the networks run for decades without major changes. This is in stark contrast to classical Internet networks, which are upgraded much more frequently.

## 5. Power Plant Datasets
Our study is based on packet traces captured at three operational power plants (see Table 1). The traces contain traffic from all physical subprocesses, including coal firing, fluid flow, and turbine operation. Since our datasets cover two of the leading vendors of control systems, they provide a representative picture of traffic characteristics.

| Vendor | Level       | Duration | # Packets | # Devices |
|--------|-------------|----------|-----------|-----------|
| Plant 1 | A           | 3.3 h    | 38 M      | 39        |
| Plant 2 | B           | 18.6 h   | 96 M      | 44        |
| Plant 3 | B           | 1.4 h    | 6 M       | 52        |
| Plant 1 | Supervisory | 54.9 h   | 17 M      | 89        |
| Plant 2 | Control     | 2.7 h    | 61 M      | 65        |

### Plant 1
The first dataset was captured in the main process control network of a unit with a capacity class of 800/900 MW, part of a two-unit coal-fired power plant. We monitored vantage points at all three network levels. The process control technology, type A (vendor names omitted due to non-disclosure agreements), is widely used in power plants worldwide.

### Plant 2
This trace was taken at the control level network of one unit of a multi-unit coal-fired power plant with a total capacity class of 1000 MW. The control system is from a different vendor, also a dominant supplier in the field. The main activity is realized by virtualized components encapsulating machine-to-machine communication. Since communication within virtual environments does not leave the hosting machines, a significant proportion of process communication could not be captured. This trace represents network traffic visible in newer systems with virtualization.

### Plant 3
The third dataset was taken at a black coal power plant, at the control level network of the process control system. The control system is shared among both units, representing a total installed capacity of 700 MW. The process control system is of the same type as in Plant 2, but no system components are virtualized, making more process control traffic visible.

### Some Plant Network Details
We observed that the interaction between the identified network levels is defined by separated networks, each with its own IP subnet. Communication among multiple levels is realized by a certain set of clients and servers connected to one or two network levels. The supervisory network in the studied plants is not intentionally connected to the Internet for remote access. Remote access is manually initiated from inside the power plants and is only performed when necessary. Except for one system required to report pollution measurements to authorities, no data is made available to the outside. In all considered plant networks, the IP address assignment is static, and the only security devices installed are border firewalls to higher-level networks or dedicated networks for remote access. The network link speeds are 1 GBit/s, and the average packet rates can be derived from Table 1.

### Measurement Setup
The data was captured during the downtime of the physical generation process during regular maintenance. During this time, the physical processes were stopped, but the DCS was running in normal operation, with links to physical actuators deactivated. We assume the application mix studied in this work to be the same as in normal operation, though the content of control messages and network load might differ. We captured all traces using `tcpdump` and port mirroring at one or several switches placed in the network parts stated in the datasets. Vantage points were chosen to capture traffic from servers relevant to plant operation.

### Ethics
The operators granted permission to capture traffic during maintenance intervals, ensuring that our setup could not impair physical processes. All traces contain only machine-to-machine traffic. We do not reveal ICS protocol details or network configurations that could aid in attacking these power plants.

## 6. The Rich Application Mix of Power Plant ICS Networks
A common assumption is that ICS networks are dominated by a single protocol, such as Modbus TCP/MMS [3â€“5] and IEC 104 [10], which control the automation process. This assumption originates from the dedicated design of many SCADA networks and contrasts with the typical Internet application mix, which is dominated by different protocols (e.g., as observed at an IXP [14]). The existence of only a single control protocol can ease network management and dimensioning. In this section, we show that this common assumption is not the case for all industrial settings. We demonstrate that the integrated DCS architecture of the studied power plants yields a more complex traffic composition, representing a mix of different application protocols.

### 6.1 Application Mix of Power Plant 1
**Approach**: We define an "application protocol" as a protocol used to transmit application payload, regardless of the underlying transport protocol. We omit network control protocols such as ARP and LLC but consider COTP, a MAC-layer protocol. Commonly used dissectors (e.g., by tshark or Zeek) can identify standard Internet protocols. However, ICS networks often use proprietary protocols that are not recognized by such tools. We manually inspected all traffic traces and created payload-based identifiers for each proprietary protocol. Known Internet protocols (e.g., HTTP/NTP) were identified by destination port in Zeek logs. Well-known protocols are mapped by name, while the remaining ones are shown by port number.

**Protocol Shares Differ Substantially by Level**: Figure 2 shows the protocol mix of Power Plant 1 by hierarchical layer. While only COTP is visible at the lowest layer (field), above layers show more protocol variety.

- **Field Level**: We observe one dominant protocol (COTP) served via Ethernet with 100% traffic share. This is because point-to-point communication with sensors and actuators (e.g., using Profinet IO to meet real-time guarantees) is used. Sensor data is then directly encapsulated on top of Ethernet as payload using proprietary protocols. At the control and supervisory levels, all communication is IP-based, with UDP and TCP as the dominant transport protocols. However, the transport protocol shares differ substantially between the layers. The supervisory level shows 99.0% TCP communication, while the control level shows 40.9% UDP traffic.
- **Control Level**: The application mix at the control level features multiple protocols. This is due to the multiple functions performed at this level. First, sensor data is obtained from field-level devices and aggregated and processed by migration and automation servers. Aggregated data is then prepared for graphical representation (at the supervisory level) by application servers. Communication between migration and application servers is based on two protocols: a proprietary TCP-based protocol (ICS 1) with a 56.2% share and a UDP-based protocol (ICS 2) used for sharing information via IP multicast. Automation servers, responsible for time-critical automation, communicate with application servers using a proprietary protocol (SPPA) on ports 10002 and 10003. Beyond these proprietary ICS protocols, we also see RPC communication with the supervisory layer using Java RMI and classical Internet protocols such as NTP.
- **Supervisory Level**: Communication at the supervisory level is dominated by Java RMI-based RPC communication. Proprietary or classical ICS protocols known in the SCADA domain are absent. Java RMI-based RPC communication is used for graphical representation by browser-based thin clients, which interact with application servers. The app mix is dominated by two RMI RPC-based applications, each running on a different port with a 44.2% share.

![Application Mix of Plant 1](fig2.png)

## Conclusion
In this study, we provide the first empirical analysis of DCS networks in power plants. Our findings highlight the rich and diverse protocol mix in these networks, which differs significantly from the single-protocol dominance observed in SCADA networks. We also demonstrate that proprietary protocols can be identified using statistical clustering, even in the absence of payload. Finally, we explore the potential of using training facilities as accessible vantage points for future studies. This work paves the way for further research into the security and optimization of critical industrial networks.