The receiver averages individual samples using a sliding win-
dow over 100 packets.
3.3 Spruce Characteristics
The following properties distinguish Spruce from other
available bandwidth tools.
1. Spruce uses a Poisson process of packet pairs rather
than packet trains (or chirps). This form of sampling
allows Spruce to be both non-intrusive and robust, as
explained in §3.1.
2. By carefully choosing the value of ∆in, Spruce ensures
that the bottleneck queue does not empty between the
two probes in a pair, which is a requirement for the
correctness of the gap model.
3. Spruce separates capacity measurement from available-
bandwidth measurement. It assumes that capacity can
be measured easily with one of the capacity measure-
ment tools and that capacity stays stable when mea-
suring available bandwidth. For the environments for
which Spruce is designed, selecting paths in overlay
networks, this assumption holds.
4. Spruce doesn’t overwhelm the narrow link on a path,
because its probe rate is no more traﬃc than the mini-
mum of 240 Kb/s and 5% of the capacity of the narrow
link.
5. Apart from the number of pairs K over which to aver-
age the measurements, Spruce does not have any tun-
able parameters.
4. ABSOLUTE ACCURACY
We evaluate the ability of Pathload, IGI, and Spruce to
compute the available bandwidth in real network settings.
We focus on these three tools because they cover the spec-
trum of underlying models in this area; Pathload is a pure
PRM tool; Spruce is a pure PGM tool; whereas IGI borrows
from both models. IGI ﬁrst ﬁnds the turning point at which
the probes’ sending rate starts matching their receiving rate.
Then it sends a train of packets at that rate and computes
the available bandwidth using the probe gap information.
4.1 Methodology: The MRTG Test
The Multi-Router Traﬃc Grapher (MRTG) [19] reports
the amount of traﬃc forwarded by a router interface. It col-
lects its measurements from the router’s Management Infor-
mation Base (MIB) using SNMP, generating a reading every
5 minutes. Given the capacity of the link, the MRTG data
allows us to compute the average available bandwidth ev-
ery 5 minutes. Despite its low resolution, the MRTG data
is the most accurate way to verify the output of available
bandwidth estimation tools.
This method requires access to MRTG logs from all links
along the path and the knowledge of the capacity of all
traversed links. Because of these diﬃculties, we apply the
MRTG test only to a pair of paths for which we have such
data. One path, which traverses MIT’s campus network,
consists of 5 hops, has an RTT of 4 ms, and its tight and
narrow link is a 100 Mb/s Ethernet connecting the Lab of
Computer Science (LCS) to the rest of the MIT network.
The other path is from UC Berkeley to MIT over the Abi-
lene network, with 17 hops and an RTT of 76 ms. This path
also has a tight and narrow link of 100 Mb/s, though the
remainder of the path is 1 Gb/s or faster. While we do not
claim that these paths are representative of most Internet
paths, they may be typical of many university networks.
We monitor these paths over a period of one week and
for a total monitoring time of 130 hours. We repeatedly run
Pathload followed by IGI then Spruce. All three tools use
the same sender and receiver machines. Since MRTG data
provides an average over a period of 5 minutes, we smooth
the measurements by taking the average output of each tool
over similar 5 minute periods.
Occasionally, we actively increase the cross traﬃc travers-
ing the monitored path. The objective of this induced load
is to discover the responsiveness of the measurement tools to
changing network conditions. The sender of the cross traﬃc
is diﬀerent from the machine running the tools. The cross
traﬃc uses UDP (though similar results were obtained with
TCP cross traﬃc). We generate cross traﬃc by taking a few
NLANR [1] traces and playing them at an adjustable rate,
while maintaining the same packet size. This choice ensures
that the packet size distribution of our cross traﬃc follows
the size distribution in the Internet.
4.2 MRTG Test Results
Figures 3 and 4 illustrate typical segments of our results.
They plot the available bandwidth over a period of a day as
measured by MRTG, Pathload, IGI, and Spruce. In ﬁgure 3,
during the interval from hour 5 to 10, we inject cross traﬃc
at a rate of 20 Mb/s. From hour 10 to 12, we increase the
generated cross traﬃc rate to 40 Mb/s. The rest of the time,
we only monitored the path using the various tools. In ﬁgure
4 we inject cross traﬃc at 20 Mb/s from hour 10 to 14.
The main observation from Figures 3 and 4 is that Path-
load was consistently inaccurate, over- or under-estimating
the available bandwidth, whereas IGI did not respond prop-
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
100
80
60
40
20
0
0
100
80
60
40
20
0
0
100
80
60
40
20
0
0
Pathload high
Pathload low
MRTG
5
10
15
20
time (hours)
(a)Pathload
5
10
15
time (hours)
(b)IGI
5
10
15
time (hours)
(c)Spruce
IGI
MRTG
20
spruce
MRTG
20
Figure 3: MRTG available bandwidth estimate vs.
Pathload, IGI, and Spruce. Data is for a 100 Mb/s
path connecting LCS to the MIT network.
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
)
s
p
b
M
(
h
t
i
d
w
d
n
a
B
e
b
a
l
l
i
a
v
A
100
80
60
40
20
0
0
100
80
60
40
20
0
0
100