â‰¤ e
The last inequality also follows from Chernoff bound.
Combining Lemmas C.11, C.12 and C.13, we obtain
P(cid:0)Ec(cid:2)r âˆ’ r
, r(cid:3)(cid:1) â‰¤ P(cid:0)Ec1(cid:2)r âˆ’ r
â€²
, r(cid:3)(cid:1) + P(cid:0)Ec2(cid:2)r âˆ’ r
, r(cid:3)(cid:1) + P(cid:0)Ec3(cid:2)r âˆ’ r
, r(cid:3)(cid:1)
â€²
â€²
â€²
âˆ’ (1âˆ’2Î²)2 Â¯f râ€²
âˆ’ (1âˆ’2Î²)2 Â¯f râ€²
36
36
.
â‰¤ 2e
â‰¤ 4e
âˆ’ Â¯f râ€²
+ e
+ e
âˆ’ Â¯f râ€²
36
â–¡
â–¡
â–¡
9https://github.com/ccanonne/probabilitydistributiontoolbox/blob/master/poissonconcentration.pdf
22
D TOTAL ORDERING FOR PRISM: PROOFS OF THEOREMS 4.1 AND 4.2
In Appendix C, we proved three chain properties â€“ chain-growth, common-prefix and chain-quality â€“ for the
Bitcoin backbone under events defined in Equation (18). The voter blocktrees in Prism also follow the longest
chain protocol, hence these three chain properties will directly hold for each of the m voter blocktree under
the corresponding events:
Similar to section C.1, let Hj[r] and Zj[r] be the number of blocks mined by the honest nodes and by the
adversarial node in round r on the ith voter tree for j âˆˆ [m]. From section 2 and the sorition technique, we
know that Hj[r], Zj[r] are Poisson random variables with means (1 âˆ’ Î²)fv âˆ† and Î² fv âˆ† respectively. Note that
random variables {Hj[r]}r âˆˆ{0,rmax }, jâˆˆ[m], {Zj[r]}r âˆˆ{0,rmax }, jâˆˆ[m] are independent of each other. We now
define auxiliary random variables Xj[r] and Yj[r] as follows: If at round r an honest party mines at least one
block on voter tree j, then Xj[r] = 1 , otherwise Xj[r] = 0. If at round r an honest party mines exactly one
block on voter tree i, then Yj[r] = 1, otherwise Yj[r] = 0. Let râ€² = k
2 Â¯f
â€² âˆ’ a, r + b] âˆ’ Zj[r âˆ’ r
â€² âˆ’ a, r + b] >
(1 âˆ’ 2Î²)k
Yj[r âˆ’ r
(cid:27)
E1, j
â€²
.
8
(cid:2)r âˆ’ r
(cid:2)r âˆ’ r
(cid:2)r âˆ’ r
, r(cid:3) := 
, r(cid:3) :=(cid:8)Hj
(cid:26)
, r(cid:3) :=
Xj
a,bâ‰¥0
(cid:26)
(cid:2)r âˆ’ r
(cid:2)r âˆ’ r
â€²
â€²
â€²
E2, j
E3, j
Ej [r âˆ’ r
, r(cid:3) 
(cid:2)r âˆ’ r
(cid:27)
k
6
â€²
, r] âˆ© E2, j[r âˆ’ r
â€²
â€²
â–¡
Let the first proposer block at level â„“ appear in round Râ„“. We will now prove common-prefix and chain-quality
for the leader block sequence defined in Equation (11).
Common prefix property: The common-prefix property of the leader sequence gives us the confirmation
policy. We derive this property using the common prefix and the chain-quality properties of the voter blocks.
Refer Figure 13.
Lemma D.2 (Common-prefix). At round r â‰¥ Râ„“, if every voter blocktree has a voter block mined by the honest
users after round Râ„“ which is at least k-deep, then w.p 1 âˆ’ Îµk , the leader block sequence up to level â„“ is permanent
i.e,
Here Îµk â‰¤ 4mr
LedSeq â„“(r) = LedSeq â„“(rmax).
maxeâˆ’Î³ k/2 and Î³ = 1
2
36(1 âˆ’ 2Î²)2.
Proof. Fix a voter blocktree j and denote its k-deep voter block in round r by bj. From the definition in
Equation (24) and common-prefix Lemma C.8 we know for under the event Ej(râ€²), for râ€² = k
, the k-deep
2 Â¯fv
voter block and its ancestors permanently remain on the main chain of voter blocktree j. From Lemma D.1 we
. Therefore, the k-deep voter block on the voter blocktree j is permanent w.p 1 âˆ’ Îµk
know that P
.
m
On applying union bound we conclude all the k-deep voter block on the m voter blocktrees are permanent w.p
j (râ€²)(cid:17) â‰¤ Îµk
(cid:16)
Ec
m
23
, r] := E1, j[r âˆ’ r
(23)
Note the similarity between the above events and events defined in Equation (18). We know that Xj [r âˆ’ râ€², r] and
Yj [r âˆ’ râ€², r] are the number successful and uniquely successful rounds respectively in the interval [r âˆ’ râ€², r] on
the blocktree j. Along the same lines, Zj [r âˆ’ râ€², r] is the number of voter blocks mined by the adversary on the
blocktree j in the interval [r âˆ’ râ€², r]. Events E1, j [r âˆ’ râ€², r], E2, j [r âˆ’ râ€², r] and E3, j [r âˆ’ râ€², r] have corresponding
interpretation of the events E1 [r âˆ’ râ€², r], E2 [r âˆ’ râ€², r] and E3 [r âˆ’ râ€², r].
Typical event: For a given râ€², define the following event:
, r] âˆ© E3, j[r âˆ’ r
, r].
â€²
â€²) := 

(24)
Ëœr â‰¥râ€²
maxeâˆ’Î³ Â¯fv râ€²
2
Lemma D.1. For any j, P
Proof. Use Lemma C.10 and apply union bound.
Ec
(cid:16)
Ej(r
j (râ€²)(cid:17) â‰¤ 4r
Ej [r âˆ’ Ëœr , r] .
0â‰¤r â‰¤rmax
, where Î³ = 1
36(1 âˆ’ 2Î²)2.
Figure 13: Dependencies of properties required to prove the common-prefix property of the leader
sequence.
1 âˆ’ Îµk. Each of these voter blocks, bjâ€™s, are mined by the honest users after round Râ„“. Therefore, by the voter
mining policy defined in Section 3, the main chain of the voter blocktree j until voter block bj has votes on
proposer blocks on all the levels â„“â€² â‰¤ â„“ and all these votes are permanent w.p 1 âˆ’ Îµk. Therefore, for each level
â„“â€² â‰¤ â„“ has m permanent votes and this implies that the leader block at level â„“â€² is also permanent w.p 1âˆ’ Îµk. â–¡
Therefore, to confirm leader blocks with 1 âˆ’ Îµ security, votes on all the m voter blocktrees should be at least
k = 2
deep. The natural question is: how long does it take to have (at least) k-deep votes on all m
Î³
voter blocktrees? The next lemma answers this question.
log 4mrmax
Îµ
Lemma D.3. By round Râ„“ + rk , wp 1 âˆ’ Îµâ€²
k , all the voter blocktrees have an honest voter block mined after round
64k
(1âˆ’2Î²) Â¯fv
Râ„“ and is at least k-deep, where rk â‰¤
k â‰¤ 8mr
and Îµâ€²
âˆ’ Î³ Â¯fv rk8
2
maxe
.
(cid:16) k1
Proof. Fix a blocktree j. Using the chain growth Lemma C.7 under the event Ej (rk), we know that the main
Â¯fv3
chain of voter blocktree j grows by k1 â‰¥ rk
voter blocks. Next, using the chain-quality Lemma C.9 under the
fraction of these k1 voter blocks are mined by the honest
second event Ej
users and the earliest of these voter block, say bj, is at least k2-deep, where k2 â‰¥ (1âˆ’2Î²)k1
:= k. It
is important to note that the depth k2 is observable by all the users. The probability of failure of either of these
two events is
(cid:17), we know that at least 1âˆ’2Î²
(cid:19)(cid:19)
(cid:18) k1
â‰¥ (1âˆ’2Î²) Â¯fv rk
2 Â¯fv
(cid:18)
24
8
8
j (rk)
P
Ec
Ec
j
2 Â¯fv
Ec
Ec
+ P
Ec
j
2 Â¯fv
(cid:18)
(cid:16)
(cid:19)(cid:19)
(cid:17)(cid:17)
(cid:18) k1
(cid:16) rk
(cid:16)
(cid:16)
â‰¤ P
(a)â‰¤ P
(b)â‰¤ 2P
(c)â‰¤ Îµâ€²
j (rk)(cid:17)
j (rk)(cid:17)
(cid:16) rk
(cid:16)
j (râ€²)(cid:17) increases, and because k1
(cid:17)(cid:17)
k
m
Ec
j
Ec
j
+ P
6
6
(cid:16)
(25)
From Lemma D.1, we see that as râ€² decreases, P
â‰¥ rk6 , we have the
inequality (a). The inequality (b) also follows by the same logic. The last inequality (c) is given by Lemma D.1.
Now applying union bound on Equation (25) over m blocktree gives us the required result.
â–¡
Proof of Theorem 4.1:
2 Â¯fv
Ec
.
24
CPCQCPCQCPCQCP: Leader sequenceVoter blocktrees12ğ‘š.  .  .  .  .  .Chain Quality (CQ)Bitcoin backboneCommon Prefix (CP)Proposer blocktreelog 8mr 2
max
Îµ
10 for k â‰¥ 2
Î³
. Now applying Lemma D.2 for k â‰¥ 2
Î³
Proof. From Lemma D.3 we know that by round Râ„“ + r(Îµ), all the voter blocktrees will have a k-deep
honest voter blocks wp at least 1 âˆ’ Îµ2
,
we obtain that all these honest voter blocks are permanent w.p 1 âˆ’ Îµ2 . On combining these two, we obtain that