tersection protocol based on homomorphic encryption [13].
For the special case where each party’s input is a sin-
gleton set, this yields a protocol with O(1) modular ex-
ponentiations and communication of a constant number
of ﬁeld elements, assuming Paillier encryption is used.
Many other papers have studied private set intersection:
[10, 18, 9, 7, 21, 22, 8, 19].
Juels and Sudan construct
“fuzzy vaults” which is a related primitive [24]. Our pro-
tocol 3 has similarities to their construction.
Cryptography and social networking. The intersection of
cryptography and social networking does not appear to be
well-studied in the academic literature. The one major work
we are aware of in this area is Persona [3], which is a sys-
tem that gives users ﬁne-grained control of privacy policies
using attribute-based encryption.
FaceTrust is a system for users to prove their identity
and attributes in a peer-to-peer manner [45], reminiscent of
the Web of Trust paradigm [1]. This kind of system can
be complementary to SocialKeys because user trust in their
friends’ online identities is important in the absence of a
certiﬁcate infrastructure.
A Facebook application called My Public Key allows
users to associate a public key with their Facebook ac-
count [29]. Of course, the interoperability is limited to
Facebook users who also install this application.
There is a draft speciﬁcation for OpenID key discov-
ery [31]. It appears not to be ﬁnal and there is no actual
support from any vendors yet.
8 Conclusion
Location privacy is an important and growing concern
in the real world today. Even problems that appear sim-
ple such as privacy-aware proximity testing can prove to be
surprisingly tricky. In contrast to previous work, we stud-
ied this problem on a ﬁrm theoretical footing and presented
a variety of cryptographic protocols motivated by and opti-
mized for practical constraints. While we have built a proto-
type implementation, it remains to be seen if any vendors of
location-based services will deploy cryptographic systems
in the market.
Several of the techniques we came up with may be of
independent interest. Asymmetric private equality testing
is a versatile primitive, and in Sections 3.1 and 3.2 we pro-
vided new protocols and improvements over previous work.
Finally, SocialKeys, our approach to managing user public
keys via a social network, is likely to have many applica-
tions beyond location privacy.
9 Acknowledgments
Di Qiu deserves special thanks for discussions about lo-
cation tags, and Elie Bursztein for pointing out problems
with protocols where the server learns the result of proxim-
ity testing. Frank Wang and Kina Winoto provided invalu-
able help with the implementation. We are also grateful to
thank Andrew Bortz, Aaron Johnson, Ann Kilzer, Ananth
Raghunathan, Nitesh Saxena and the anonymous review-
ers for comments on a draft, and Eric Lam, David Mol-
nar, Hart Montgomery, Ram Ravichandran, Elaine Shi and
Vinod Vaikuntanathan for useful discussions.
References
[1] A. Abdul-Rahman and S. Halles. A distributed trust
In New security paradigms, pages 48–60.
model.
ACM, 1997.
[2] M. J. Atallah and W. Du. Secure multi-party computa-
tional geometry. In International Workshop on Algo-
rithms and Data Structures, pages 165–179. Springer-
Verlag, 2001.
[3] R. Baden, A. Bender, N. Spring, B. Bhattacharjee, and
D. Starin. Persona: an online social network with user-
deﬁned privacy. SIGCOMM Comput. Commun. Rev.,
39(4):135–146, 2009.
[4] A. R. Beresford and F. Stajano. Location privacy
in pervasive computing. IEEE Pervasive Computing,
2(1):46–55, 2003.
[5] A. J. Blumberg and P. Eckersley. On locational pri-
vacy, and how to avoid losing it forever. http:
//www.eff.org/wp/locational-privacy.
[6] F. Boudot, B. Schoenmakers, and J. Traore. A fair and
efﬁcient solution to the socialist millionaires’ prob-
lem. Discrete Applied Mathematics, 111:23–36, 2001.
[7] J. Camenisch and G. Zaverucha. Private intersection
of certiﬁed sets. In Proc. of Financial Crypto 2009,
volume 5628 of LNCS, pages 108–127, 2009.
[8] E. D. Cristofaro and G. Tsudik. Practical set inter-
section protocols with linear complexity. In Proc. of
Financial Crypto 2010, volume 6052 of LNCS, pages
143–159, 2010.
[9] D. Dachman-Soled, T. Malkin, M. Raykova, and
M. Yung. Efﬁcient robust private set intersection. In
Applied Cryptography and Network Security (ACNS),
pages 125–142, 2009.
[10] L. K. Dawn and D. Song. Privacy-preserving set op-
erations. In Proc. of Crypto, pages 241–257. Springer,
2005.
[11] N. Eagle, A. S. Pentland, and D. Lazer.
Inferring
friendship network structure by using mobile phone
data. Proceedings of the National Academy of Sci-
ences, 106(36):15274–15278, August 2009.
[12] R. Fagin, M. Naor, and P. Winkler. Comparing infor-
mation without leaking it. Comm. of the ACM, 39:77–
85, 1996.
[13] M. Freedman, K. Nissim, and B. Pinkas. Efﬁcient pri-
vate matching and set intersection. In Proc. of Euro-
crypt’04, pages 1–19. Springer-Verlag, 2004.
[14] G. Friedland and R. Sommer. Cybercasing the joint:
In Pro-
On the privacy implications of geotagging.
ceedings of the Fifth USENIX Workshop on Hot Topics
in Security (HotSec 10), 2010.
[15] G. Ghinita, P. Kalnis, A. Khoshgozaran, C. Shahabi,
and K.-L. Tan. Private queries in location based ser-
In SIGMOD
vices: anonymizers are not necessary.
Conference, pages 121–132, 2008.
[16] P. Golle and K. Partridge. On the anonymity of home,
work location pairs. In Proceedings of the 7th Inter-
national Conference on Pervasive Computing, pages
390–397. Springer, 2009.
[17] M. Gruteser and D. Grunwald. Anonymous usage of
location-based services through spatial and temporal
cloaking. In MobiSys ’03, pages 31–42. ACM, 2003.
[18] C. Hazay and Y. Lindell. Efﬁcient protocols for set in-
tersection and pattern matching with security against
malicious and covert adversaries. In Theory of cryp-
tography (TCC), pages 155–175, 2008.
[19] C. Hazay and K. Nissim. Efﬁcient set operations in the
presence of malicious adversaries. In Proc. of public
key crypto (PKC), volume 6056 of LNCS, pages 312–
331, 2010.
[20] R. Honicky, E. A. Brewer, E. Paulos, and R. White. N-
smarts: networked suite of mobile atmospheric real-
time sensors. In NSDR ’08, pages 25–30. ACM, 2008.
[21] S. Jarecki and X. Liu. Efﬁcient oblivious pseudoran-
dom function with applications to adaptive ot and se-
cure computation of set intersection. In Proc. of The-
ory of Cryptography, pages 577–594, 2009.
[22] S. Jarecki and X. Liu. Fast secure computation of set
In Proc. of Security and Cryptography
intersection.
for Networks (SCN’10), volume 6280 of LNCS, pages
418–435, 2010.
[23] T. Jiang, H. J. Wang, and Y.-C. Hu. Preserving loca-
In MobiSys ’07: Pro-
tion privacy in wireless lans.
ceedings of the 5th international conference on Mo-
bile systems, applications and services, pages 246–
257, New York, NY, USA, 2007. ACM.
[24] A. Juels and M. Sudan. A fuzzy vault scheme. Designs
Codes and Cryptography, 38(2):237–257, 2006.
[25] B. Kaliski. PKCS 5: Password-based cryptography
http://www.apps.ietf.org/
speciﬁcation.
rfc/rfc2898.html.
[26] H. Lipmaa. Veriﬁable homomorphic oblivious transfer
and private equality test. In Proc. of Asiacrypt, pages
416–433, 2003.
[27] S. Lo, D. D. Loenzo, P. Enge, and P. Bradley. Sig-
nal authentication: A secure civil gnss for today. In-
side GNSS Magazine, 4(5), October 2009. www.
insidegnss.com/node/1633.
[28] J. Manweiler, R. Scudellari, Z. Cancio, and L. P. Cox.
We saw each other on the subway: secure, anony-
mous proximity-based missed connections. In HotMo-
bile ’09: Proceedings of the 10th workshop on Mobile
Computing Systems and Applications, pages 1–6, New
York, NY, USA, 2009. ACM.
[29] R. McGeehan. My public key (facebook appli-
cation). http://www.facebook.com/apps/
application.php?id=7923770364.
[30] A. Menezes, P. van Oorschot, and S. Vanstone. Hand-
book of Applied Cryptography. CRC, 1996.
[31] G. Monroe
key
and C. Howells.
1.0
Openid
draft
http://openid.net/specs/
service
01.
openid-service-key-discovery-1_
0-01.html, 2006.
discovery
-
[32] M. Naor and B. Pinkas. Oblivious transfer and polyno-
mial evaluation. In Proc. of symposium on the theory
of computing (STOC), pages 245–254, 1999.
[33] A. Narayanan and V. Shmatikov. De-anonymizing so-
In IEEE security and privacy, pages
cial networks.
173–187, 2009.
[34] D. Pescovitz.
Cell phone as sensor.
http:
//coe.berkeley.edu/labnotes/0805/
honicky.html.
[35] R. A. Popa, H. Balakrishnan, and A. Blumberg. VPriv:
Protecting Privacy in Location-Based Vehicular Ser-
In 18th USENIX Security Symposium, Mon-
vices.
treal, Canada, August 2009.
[36] D. Qiu, D. Boneh, S. Lo, and P. Enge. Robust location
tag generation from noisy location data for security
applications. In The Institute of Navigation Interna-
tional Technical Meeting, 2009.
[37] D. Qiu, S. Lo, P. Enge, D. Boneh, and B. Peterson.
Geoencryption using loran. In The Institute of Navi-
gation International Technical Meeting, 2007.
[38] R. Ravichandran, M. Benisch, P. G. Kelley, and N. M.
Sadeh. Capturing social networking privacy prefer-
ences: Can default policies help alleviate tradeoffs
In PETS,
between expressiveness and user burden?
pages 1–18, 2009.
[39] M. Raya and J.-P. Hubaux. The security of vehicular
In SASN ’05: Proceedings of the
ad hoc networks.
3rd ACM workshop on Security of ad hoc and sensor
networks, pages 11–21. ACM Press, 2005.
[40] P. F. Riley.
The tolls of privacy: An underesti-
mated roadblock for electronic toll collection usage.
Computer Law and Security Report, 24(6):521 – 528,
2008.
[41] N. Sastry, U. Shankar, and D. Wagner. Secure veriﬁ-
cation of location claims. In WiSe ’03: Proceedings
of the 2nd ACM workshop on Wireless security, pages
1–10. ACM, 2003.
[42] J. Scheck. Stalkers Exploit Cellphone GPS, 2010.
Wall Street Journal.
[43] L. Scott and D. E. Denning. A location based encryp-
tion technique and some of its applications. In Insti-
tute of Navigation National Technical Meeting, pages
734–740, 2003.
[44] P. Shankar, V. Ganapathy, and L. Iftode.
In UbiComp’09:
Pri-
vately querying location-based services with sybil-
the
query.
11th International Conference on Ubiquitous Com-
puting, pages 31–40, Orlando, Florida, Septem-
ber/October 2009. ACM Press, New York, NY, USA.
http://doi.acm.org/10.1145/1620545.1620550.
Proceedings of
• Alice obtains answer: Alice decrypts C using sk and
obtains r(a − b) from which she learns if a = b, but
nothing else.
Security follows as in Protocol 1 as long as Alice does not
collude with the server. The advantage of this protocol over
Protocol 2 is that there is only one round of communication
between Alice and the server, since there is no need for a
counter. The disadvantage over Protocol 2 is the increased
computational and bandwidth requirement.
[45] M. Sirivianos, K. Kim, and X. Yang. FaceTrust: As-
sessing the Credibility of Online Personas via Social
Networks. In Usenix HotSec, 2009.
[46] R. Thomas. Getting in Bed with Robin Sage, 2010.
Black Hat.
[47] L. ˇSikˇsnys, J. R. Thomsen, S. ˇSaltenis, M. L. Yiu, and
O. Andersen. A location privacy aware friend locator.
In SSTD ’09, pages 405–410. Springer-Verlag, 2009.
[48] A. Whitten and J. D. Tygar. Why Johnny can’t en-
In 8th
crypt: A usability evaluation of PGP 5.0.
USENIX Security Symposium, 1999.
[49] A. C.-C. Yao. How to generate and exchange secrets.
In Proc. of foundations of computer science (FOCS),
pages 162–167, 1986.
[50] M. E. Zarki, S. Mehrotra, G. Tsudik, and N. Venkata-
subramanian. Security issues in a future vehicular net-
work. In In European Wireless, pages 270–274, 2002.
[51] G. Zhong, I. Goldberg, and U. Hengartner. Louis,
Lester and Pierre: Three protocols for location pri-
vacy. In Privacy Enhancing Technologies, pages 62–
76, 2007.
[52] K. Zickuhr and A. Smith. 4% of online Americans use
location-based services, 2010. Pew Research Center
Survey.
A An asynchronous variant of protocol 1
using an oblivious server
In Section 3.1 we presented a synchronous private
equality test using an additively homomorphic encryption
scheme such as ElGamal. The protocol requires both Alice
and Bob to be online at the same time. Here we present an
asynchronous variant of the protocol using a trusted server.
The server learns nothing at the end of the protocol, assum-
ing the server does not collude with Alice.
Let (G, E, D) be a public-key additively homomorphic
encryption scheme over a group of size p. We assume Alice
has the secret key sk and Bob and the server have the public
key pk. Using the notation of Section 3.1 the protocol works
as follows:
server,
• Bob’s message: at any time Bob sends E(pk, b) to the
• Alice queries the server: At any time Alice sends
E(pk, a) to the server. The server generates a random
r ∈ Zp and sends C ← E(cid:0)pk, r(a−b)(cid:1) back to Alice.
The server constructs C using the additive property of
encryption as in Section 3.1.