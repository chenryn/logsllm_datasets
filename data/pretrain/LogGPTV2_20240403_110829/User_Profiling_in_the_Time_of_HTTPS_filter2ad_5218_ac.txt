c(pi
j) that the pro-
ﬁler assigns to that user as a true positive. Similarly,
any category not in c(pi
j) that the proﬁler assigns to
that user is a false positive.
j). We consider any category in c(pi
The basic eavesdropper of Section 3 learns wi from
the client_hello message issued by the user browser
and assigns the categories of the main page c(pi
0) to
that user. However, because of HTTPS, the baseline
proﬁling system cannot tell which page pi
j was visited.
If we denoted with T i and F i the true positive and
the false positive, respectively, we have:
0) ∩ c(pi
j)|
|c(pj) \ c(p0)|
• T i = 1
• F i = 1
(cid:80)
(cid:80)
|c(pi
j=0..si
si+1
si
j=1..si
The advanced eavesdropper of Section 4 tries to
infer the page pi
j the user has fetched by looking at
the encrypted traﬃc trace. This is done by means
of a classiﬁer trained on a snapshot of wi. As shown
in the previous section, the freshness of the snapshot
used to train the classiﬁer impacts its accuracy.
We denote the expected number of true positives
and false positives with a classiﬁer that is ti epochs
stale by T i
ti, respectively. Thus we have:
ti and F i
(cid:80)
ti =(cid:80)
(cid:80)
ti =(cid:80)
j=0..si
j=0..si
j=0..si
• T i
• F i
(cid:80)
π(pi
j)|+
j)|c(pi
l)|(c(pi
l=0..si, l(cid:54)=j π(pi
j, pi
j, pi
l=0..si, l(cid:54)=j π(pi
j, pi
j) ∩ c(pi
l)|c(pi
l))|
l)\c(pi
j)|,
where π(pi
j, pi
l) denotes the probability of predict-
l (depends on the freshness of the
j as pi
ing page pi
classiﬁer).
Given the expected number of true and false posi-
tives, we set B as the bandwidth budget made avail-
able to eavesdropper at every epoch, and bi as the
bandwidth required to refresh the classiﬁer for we-
biste wi. We also denote by ui the popularity of web-
site wi (i.e., the number of users that visit wi in an
epoch).
Upon every epoch, the eavesdropper decides to spend
the budget B by training classiﬁers on a fresh snap-
shots of a subset X of the monitored websites.
If
website wi is included in X, the available budget is
reduces by bi and the expected number of correct cat-
egories assigned is ui ·T i
0 , while the expected number
of categories miss-assigned is ui · F i
0. If website wi
is not included in X, the budget remains untouched
and the expected number of correctly assigned and
mis-assigned categories is ui · T i
ti, respec-
tively, assuming the most recent classiﬁer for wi is ti
epochs stale.
ti and ui · F i
The selection of X, therefore, tries to maximize the
number of true positive and to minimize the number
of false negative, while respecting the available bud-
get.
Select X ⊆ {1, . . . , n}
s.t. Max
ui(T i
0 − F i
0) +
(cid:88)
(cid:88)
i∈X
i∈X
bi ≤ B
Where
(cid:88)
i /∈X
ui(T i
ti
− F i
ti)
If a classiﬁer were never trained on wi we fall-back
to the proﬁling technique of the na¨ıve eavesdropper
so that the number of true positives is ui · c(pi
0) and
the number of false positive is |c(pi
0)|.
j) \ c(pi
The above problem resembles the well-known 0/1
knapsack problem with the only diﬀerence that items
that are not selected add a non-zero value to the total
gain.
A toy example.
To illustrate the workings and the value of the
above optimization we have conducted a simulation
based on the 15 websites from previous sections. We
empirically assessed the training bandwidth require-
ment and probabilities of the confusion matrices, while
we used Alexa to obtain the popularity of each web-
site.
In Figure 7 we use a black box to mark a domain
that is being selected for re-training on a particular
day. We show which domains get to be classiﬁed every
day under two diﬀerent budgets – 500mb and 2Gb,
representing 10% and 40%, respectively of the budget
needed to re-classify all sites every day.
We observe that bandwidth availability can strongly
aﬀect the daily classiﬁcation pattern. In case of 500mb
budget, the same set of websites gets to be picked for
3787. REFERENCES
[1] J. M. Carrascosa, J. Mikians, R. Cuevas,
V. Erramilli, and N. Laoutaris, “I always feel
like somebody’s watching me measuring online
behavioural advertising,” in Proc. of ACM
CoNEXT’15.
[2] “Display Planner basics.” https://support.
google.com/adwords/answer/3056115?hl=en.
”[Online; accessed 12-May-2016]”.
[3] “SSL compliance.” https://support.google.com/
richmedia/answer/6015286?hl=en. ”[Online;
accessed 12-May-2016]”.
[4] M. Belshe, R. Peon, and M. Thomson,
“Hypertext transfer protocol version 2
(http/2),” RFC 7540, RFC Editor, May 2015.
http://www.rfc-editor.org/rfc/rfc7540.txt.
[5] “HTTPS Everywhere.” https://addons.mozilla.
org/en-US/ﬁrefox/addon/https-everywhere/.
”[Online; accessed 12-May-2016]”.
[6] R. Dingledine, N. Mathewson, and P. Syverson,
“Tor: The second-generation onion router,”
tech. rep., DTIC Document, 2004.
[7] T.-F. Yen, Y. Xie, F. Yu, R. P. Yu, and
M. Abadi, “Host ﬁngerprinting and tracking on
the web: Privacy and security implications.,” in
Proc. of NDSS’12.
[8] A. Hintz, “Fingerprinting websites using traﬃc
analysis,” in Proc. of PETS’02.
[9] D. Herrmann, R. Wendolsky, and H. Federrath,
“Website ﬁngerprinting: attacking popular
privacy enhancing technologies with the
multinomial na¨ıve-bayes classiﬁer,” in Proc. of
CCSW’09.
[10] A. Panchenko, L. Niessen, A. Zinnen, and
T. Engel, “Website ﬁngerprinting in onion
routing based anonymization networks,” in
Proc. of ACM WPES’11.
[11] A. Panchenko, F. Lanze, A. Zinnen, M. Henze,
J. Pennekamp, K. Wehrle, and T. Engel,
“Website ﬁngerprinting at internet scale,” in
Proc. of NDSS’16.
[12] “Alexa Top Sites.”
http://www.alexa.com/topsites. ”[Online;
accessed 12-May-2016]”.
Figure 7: Output of the optimization problem across
15 days for 2 diﬀerent bandwidth budgets (500mb
and 2Gb). A black box represents a website which
classiﬁer must be refreshed on that day.
classiﬁcation every day.
In the case of 2Gb, how-
ever, diﬀerent websites get to compete for the avail-
able budget and thus end up being picked or skipped
on diﬀerent days. The actual resulting pattern de-
pends on the interplay between website popularity,
size, and dynamicity of content.
The small number of websites in the above exam-
ple does not leave a lot of margin for proﬁling per-
formance diﬀerence between optimizing only once vs
optimizing every day. We have, however, simulated a
larger example that includes 200 pages with a mix of
popularities, content dynamicity, and size and have
observed that in more complex settings the diﬀerence
between optimizing only once vs. every day is sub-
stantial.
6. CONCLUSIONS
To the best of our knowledge our study is the ﬁrst
one to demonstrate that network eavesdroppers can
proﬁle user interests despite HTTPS. We have shown
that even oﬀ-the-shelf traﬃc classiﬁcation algorithms
can guess the page that a user is viewing. Caching
and dynamic content tailored to the device capabil-
ities make the whole eﬀort harder but the obtained
accuracy remains high. We believe that more spe-
cialized classiﬁcation algorithms, coupled with care-
ful optimisation of classiﬁcation bandwidth can yield
accurate and scalable user proﬁling even in more com-
plex settings than the ones we have considered. We
plan to prove our claim by developing a fully func-
tioning prototype.
Acknowledgments
We are grateful to Juan Miguel Carrascosa, Ruben
Cuevas and Costas Iordanou for helpful comments
and discussions. We also thank anonymous reviewers
and our shepherd for their valuable comments and
suggestions. This work has been partially supported
by the European Union through the FP7 METRICS
(607728), H2020 TYPES (653449) and ReCRED(653417)
Projects.
0.00.20.40.60.81.0Days0.00.20.40.60.81.0051015aarp.comabout.comamazon.comchron.comcnn.comnbcnews.comrakuten.comreuters.comwonderhowto.commashable.comslashdot.orgbu.edunec.comtelefonica.esuc3m.es500mb0510152Gb379