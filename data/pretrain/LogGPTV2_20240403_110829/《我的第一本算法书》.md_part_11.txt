将用户输入的密码保存到服务器时也需要用到哈希函数。
哈希函数的算法中具有代表性的是 MD5①、SHA-12和 SHA-2 等。其中 SHA-2 是现
图灵社区会员 夏科(PI:EMAIL)专享尊重版权
哈希函数
５１3
---
## Page 133
120
安全算法
第5章
No
用不同密钥的“公开密钥加密”。本节将讲解共享密钥加密的机制及其相关问题。
理流程。假设A准备通过互联网向B 发送数据。
我们先从整体上来了解一下共享密钥加密的处
加密数据的方法可以分为两种：加密和解密都使用相同密钥的“共享密钥加密”和分别使
A
abc
internet
共享密钥加密
abc
abc
数据加密后再发送。
由于有被窃听的风险，所以需要把想要保密的
03
abc
internet
加密”。
种算法也被称为“对称
用的密钥相同，所以这
一种加密方式。由于使
解密都使用相同密钥的
共享密钥加密是加密和
abc
abc
B
---
## Page 134
?
小知识
就算被第三者恶意窃听也无须担心。
B收到密文后，使用相同的密钥对其进行解密。这样，B就取得了原本的数据。只要是加密好的数据，
A使用密钥加密数据。
 Data Encryption Standard 的缩写。
AdvancedEncryptionStandard的缩写。
OD
为广泛。
实现共享密钥加密的算法有凯撒密码、AES①、DES②、动态口令等，其中AES的应用最
internet
D
nterne
A将密文发送给B。
abc
D
B
ihterhet
D
m
2
共享密钥加密
51
---
## Page 135
122
安全算法
第5章
时使用的是什么密钥。
这里假设A和B无法直接沟通，B不知道加密
回到B收到A发送的密文的时候。
接下来想一想共享密钥加密中的问题。让我们
D
erne
D
B
B
样，A又在互联网上向B发送了密钥。
A需要通过某种手段将密钥交给B。和密文一
密文可能已经被×窃听了。
D
D
D
---
## Page 136
B使用收到的密钥对密文进行解密。
小知识
参考：5-7迪菲－赫尔曼密钥交换
参考：5-5公开密钥加密
面本书将会对这两种方法进行详细说明。
方式，又会产生如何把加密密钥的密钥发送给对方的问题，还是回到了一开始的问题。
解说
要想解决这个问题，可以使用“密钥交换协议”和“公开密钥加密”两种方法。后
因此需要找到可以把密钥安全送出的方法，这就是“密钥分配问题”。
既然密钥有被第三者窃听的风险，那是不是也可以先加密密钥再发送呢？使用这种
A
盟军的胜利带来了极大的帮助。
地出现相同的文字，英国的数学家艾伦·图灵就是利用这一点破译了密文，给
密钥分配并不是该密码机的弱点。然而，使用该密码机加密后的密文会周期性
加密方式就是共享密钥加密。德军将一个月的密钥记录成表格进行交接，因此
现在被普遍使用的加密算法即便连续发送相似的文字，也难以被破解。
internet
abc
D
B
×也可以使用密钥对密文进行解密了。
但是，该密钥也有可能会被X窃听。这样一来，
2
大的问题。
密钥加密最
这就是共享
internet
abc
abc
D
?
123
共享密钥加密
514
---
## Page 137
24
安全算法
第5章
No
，非，
5-5
我们先从整体上来了解一下公开密钥加密的处理流程。假设A准备通过互联网向B发送数据。
公开密钥加密是加密和解密使用不同密钥的一种加密方法。由于使用的密钥不同，所以这种算
abc
公开密钥加密
nternet
abc
:
internet
私有密钥用S（secretkey）来表示。
公开密钥用P（publickey）来表示，
，解密用的叫作“私有密钥”。
---
## Page 138
A使用B发来的公开密钥加密数据。
然后把公开密钥发送给A。
提示
abc
2002年获得了图灵奖。
RSA算法。RSA算法由其开发者Rivest、Shamir、Adleman 的首字母命名而来，三人在
实现公开密钥加密的算法有RAS算法、椭圆曲线加密算法等，其中使用最为广泛的是
D
internet
abc
行解密。这样，B就得到了原本的数据。
A将密文发送给B，B再使用私有密钥对密文进
B
abc
internet
abc
+D
B
25
公开密钥加密
51５
---
## Page 139
126
安全算法
第5章
预先准备好了公开密钥和私有密钥。
密十分方便。来看一个具体的例子吧。假设B
此外，在和多人传输数据时，使用公开密钥加
此×也无法得到原本的数据。
公开密钥和密文都是通过互联网传输的，因此可能会被X窃听。但是，使用公开密钥无法解密密文，因
9
abc
internet
abc
D
被人知道，必须严密保管。
开密钥发布在网上。与此相反，私有密钥不能
公开密钥是不怕被人知道的，所以B可以把公
钥分配问题。
公开密钥加密不会出现密
与共享密钥加密不同的是，
日
---
## Page 140
然后用它加密要发送的数据。
假设有许多人都想向B发送数据。
提
示
例子中只有2个人，因此只需要2个密钥，但5人就需要10个，100人就需要4950个（n=
如果使用共享密钥加密，密钥的需求数量会随着发送人数的增多而急剧增多。上一节的
最后把密文发给B。
发送数据的
B
27
公开密钥加密
515
---
## Page 141
128
安全算法
第5章
公开密钥Px和私有密钥Sx
×想要窃听A发给B的数据，于是他也准备了
机
5
M
A
abc
abc
internet
nterne
公开密钥
abc
S
私有密钥
T
B
B
在B把公开密钥P发给A的时候..….
时候。在接下来的说明中，B生成的公开密钥
题。让我们回到B生成公开密钥和私有密钥的
不过，公开密钥加密存在公开密钥可靠性的问
仅由接收方保管，所以安全性也更高。
都准备相对应的密钥了。需要保密的私有密钥
本的数据。这种情况就不需要为每个发送对象
B用私有密钥对收到的密文进行解密，取得原
D
abc
internet
B
B
---
## Page 142
A使用公开密钥Px对数据加密。
X把公开密钥P;替换成自己的公开密钥P…….
abc
abc
D
internet
1
S
S
8
这个密文。
当A把想要给B的密文发送出去后，X接收了
2
自己收到的公开密钥已经被人替换。
无法显示自己是由谁生成的，所以A不会发现
于是公开密钥Px传到了A那里。由于公开密钥
abc
abc
internet
B
29
公开密钥加密
５１５
---
## Page 143
130
安全算法
第5章
接下来，×用B生成的公开密钥P:加密数据。
abc
abc
abc
internet
internet
B
B 的数据。
×成功窃听了A准备发送给
X可以用自己的私有密钥Sx对密文进行解密。
这个密文由×生成的公开密钥Px加密而成，所以
叫作“中间人攻击”（man-in-the-middle attack）
通过中途替换公开密钥来窃听数据的攻击方法
问题，因此B也意识不到数据已经被窃听。这种
Sp来解密。从收到密文到解密密文都没发生任何
钥Ps加密而成，所以B可以用自己的私有密
X把密文发送给B，这个密文由B发出的公开密
23
abc
internet
abc
S
D
钥
---
## Page 144
以实现公开密钥加密的算法的提出，对当今互联网社会的安全有着重要的意义。
须满足如下条件。
参考：5-10数字证书
参考：5-6混合加密
于持续发送零碎数据的情况。要想解决这个问题，就要用到“混合加密”。
要想解决这个问题，就要用到之后会讲到的“数字证书”。
解说
公开密钥加密还有一个问题，那就是加密和解密都比较耗时，所以这种方法不适用
补充说明
稍微思考一下便知道，想要找到满足以上条件的算法难度有多大。所以，RSA等可
要想找到实现公开密钥加密的算法并不容易。考虑到加密所需的计算流程，算法必
公开密钥的可靠性会出现问题，就是因为A无法判断收到的公开密钥是否来自 B。
③无法从一种密钥推算出另一种密钥。
①可以使用某个数值对数据进行加密 (计算)。
公开密钥加密
515
---
## Page 145
132
安全算法
第5章
No
参考：5-5公开密钥加密
参考：5-4共享密钥加密
较慢的问题。结合这两种方法以实现互补的一种加密方法就是混合加密。
S
准备通过互联网向B发送数据。
我们来看看混合加密具体的处理流程。假设A
要用没有密钥分配问题的公开密钥加密进行处理。
在混合加密中，要用处理速度较快的共享密钥加密对数据进行加密。不过，加密时使用的密钥，则需
2
共享密钥加密存在无法安全传输密钥的密钥分配问题，公开密钥加密又存在加密解密速度
A
共享密钥加密
internet
混合加密
B
ibc
D
■
因此A需要把密钥发送给B。
加密。加密时所用的密钥在解密时也要用到，
使用处理速度较快的共享密钥加密对数据进行
abc
D
U
公开密钥加密
internet
B
---
## Page 146
要使用的密钥进行加密。
A使用收到的公开密钥，对共享密钥加密中需
以将其安全地发送给B了。
将密钥通过公开密钥加密进行加密后，A就可
9
因此，作为接收方，
A将加密后的密钥发送给B。
B将公开密钥发送给A。
D
３3
混合加密
516
---
## Page 147
３4
安全算法
第5章
密钥加密。
接下来，A只要将使用这个密钥加密好的数据发送给B即可。加密数据时使用的是处理速度较快的共享
B使用私有密钥对密钥进行解密。
D
abc
D
internet
abc
D
B
地发送给了B。
这样，A就把共享密钥加密中使用的密钥安全
了原本的数据。
B安全地收到
---
## Page 148
协议或者 SSL /TLS 协议。
全)。但是，SSL这个名字在人们心中已经根深蒂固，因此该协议现在也常被称为 SSL
该协议经过版本升级后，现在已正式命名为TLS（Transport Layer Security，传输层安
SSL 协议也应用了混合加密方法。SSL 是 Secure Sockets Layer（安全套接层）的简写,
解说
像这样，