NCC Group Whitepaper
Secure Messaging for Normal People
July 20, 2015 – Version 1.0
Prepared by
Justin Engler — Principal Security Consultant
Cara Marie — Senior Security Consultant (Diagrams)
Abstract
"Secure" messaging programs and protocols continue to proliferate, and crypto ex-
perts can debate their minutiae, but there is very little information available to help the
rest of the world differentiate between the different programs and their features. This
paper discusses the types of attacks used against a variety of messaging models and
discusses how secure messaging features can defend against them. The goal of this
paper is to help inform those who are tech-savvy but not crypto-experts to make smart
decisions on which crypto applications to use.
Table of Contents
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.1
What is a message? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
Cryptography is magic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.3
Cryptobabble . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
2
Your own threat model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2.1
Adversary types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
2.2
Why are you keeping secrets? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
3
Messages without encryption . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
4
Encryption endpoints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
9
5
Key validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
5.1
Trust on first use. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
5.2
Out-of-band validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
5.3
Transitive trust . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
5.4
Validation is forever until it isn't . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
6
Group messaging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
6.1
Ice cream attack . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
6.2
Membership changes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
6.3
Group chat protocols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
7
Open source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
7.1
Security audits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
7.2
Does it do what it says? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
7.3
Did we get the program we analyzed? (reproducible builds) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
7.4
Operating systems and open source . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
7.5
How many operating systems are on your device? And what do they run on? . . . . . . . . . . . . . . . . 18
8
Metadata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
8.1
Direct collection of metadata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
8.2
Inferring metadata as a global passive adversary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
8.3
Identifiers as metadata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
2 | Secure Messaging for Normal People
NCC Group
8.4
Address book harvesting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
8.5
Is there any cure for metadata? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
9
Physical device access/seizure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
9.1
Logs & transcripts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
9.2
Forward secrecy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
10 Things that don't work
like you think they do . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.1 Auto-deleting messages . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.2 One time pads . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.3 Special crypto hardware . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.4 Geofencing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.5 Mesh networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
10.6 Military-grade. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
10.7 Bespoke cryptography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
10.8 Multiple synchronized devices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
11 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
3 | Secure Messaging for Normal People
NCC Group
1 Introduction
Security and privacy continue to be on the minds of the public, and many users want to know how to keep their
communications private. At the same time, users are being offered more choices in how to communicate with
each other than ever before, and some of these choices purport to be "secure". By the end of this paper, you
will be able to understand what types of things the "bad guys" will try to do to access your communications
and what features messaging systems offer to thwart those attempts.
1.1 What is a message?
For the purposes of this paper, a "message" is any information you want to send to another person or group
of people. Phone calls, SMS, email, video chat, text chat, and other similar items are included, but things like
communications between your computer and a server are not messages themselves as far as we're concerned
in this paper.
A messaging client is whatever collection of systems you use to send messages. This could mean anything
from a traditional phone up to a niche messaging application on a computer.
1.2 Cryptography is magic
There are a huge number of different types of cryptographic algorithms that are used for different situations.
Algorithm choice, implementation flaws, and similar considerations can have huge impacts on the security
of your data, but such details are outside of the scope of this discussion. While reading this paper, you
can translate "encrypted" as "impossible for anyone else to read or modify", unless otherwise stated. You
shouldn't necessarily translate it that way in the real world though, you would need to have cryptography and
application security experts sign off on the actual algorithms and implementations used.
Even though we're making this assumption that encryption is unbreakable, there are plenty of other ways
adversaries could get to your data. The purpose of this paper is to explain those things and what to do about
them.
1.3 Cryptobabble
This paper attempts to simplify things as much as possible, but there are a few key cryptography terms that
we'll be using. Sometimes their meanings can be confusing if you don't already know what they are, so let's
lay a few out now.
• Key - A secret value that "unlocks" an encrypted message.
• Public Key/Private Key - These come in pairs. The idea is that you give your public key away to everyone,
but you keep the private key to yourself. Anyone with your public key can send an encrypted message that
can only be decrypted with the private key. You can imagine this as you distributing the blueprints to a lock
that will only open with your key. Now, anyone with the blueprints (public key) can build a locked container
(encrypt a message) that only the private key can open.
• Signatures - This is another use for public keys. If you have my public key, you can verify that a given
message actually came from me. Interestingly, that message can be sent unencrypted (so anyone can read
it), but you can still use the public key to validate it. For a real-world analogy, imagine that you have a
sample of my handwriting signature (public key). If I send you a document and I sign it with my pen (private
key), you can check to see if the signatures match.
• Fingerprints - Usually in cryptography a fingerprint has nothing to do with the oily smudges you leave
everywhere. Instead, when we say fingerprint, we mean a short value that can represent a longer one. Keys
can be very long (a number 925 digits long, for one example), so we use some math to boil that down into
something manageable that a person could read and compare (a 13 digit fingerprint for the previous 925
digit key). Machines will use the full key, but if a person needs to verify the value of a key, the person could
4 | Secure Messaging for Normal People
NCC Group
use fingerprints instead. It's called a fingerprint because it uniquely identifies the larger value. Don't panic
if someone wants to see your fingerprints!
• Trust - If we say that we "trust" people, we're not saying we'd let them house-sit or borrow money. It simply
means that we're relying on them to vouch for someone's identity. Sometimes we'll trust an individual
person, other times we'll trust a more abstract entity.
5 | Secure Messaging for Normal People
NCC Group
2 Your own threat model
It's impossible to determine what the "best" encrypted chat program is because everyone has different needs.
To decide what kinds of security you need, first understand who is trying to attack you and what they are trying
to take from you.
2.1 Adversary types
For the purposes of this talk, we're going to talk about four different types of adversary.
Opportunistic, Low-resource adversaries: These attackers aren't targeting you directly, and they aren't willing
to commit much effort, skill, and/or time on you. Novice troublemakers, corporate/educational monitoring
systems, analysis for use in advertising systems, etc.
Targeted, Low-resource adversaries: These attackers are specifically after your information, but they don't
have massive resources. Targeted hackers, organized crime, corporate espionage, harassers, and the like
make up this group.
Opportunistic, High-resource adversaries: These attackers aren't looking at you specifically, but they have
massive resources to throw at the problem of bulk surveillance. This group is likely to be a government program
doing large scale data collection, monitoring, and/or filtering.
Targeted, High-resource adversaries: These attackers are likely government actors who have already zeroed
in on you specifically. It is highly unlikely that anything we discuss in this paper will be able to protect you in
any meaningful way from this kind of attention, but hopefully we'll at least be able to explain why your choice
of secure messaging program won't be much help against this class of threat.
2.2 Why are you keeping secrets?
When choosing a messaging system, you need to consider how much you value the information you want to
keep secret. You also need to consider how much value your data has to an adversary who wants to steal it.
Both of these inform how much effort you should put into your security.
Different types of data will have different value. This paper is mostly concerned with the value of the actual