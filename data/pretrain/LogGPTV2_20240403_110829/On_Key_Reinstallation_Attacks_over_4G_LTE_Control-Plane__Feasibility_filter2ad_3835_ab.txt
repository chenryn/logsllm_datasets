OFDM subchannels. The interference brings loss of subchannel
orthogonality, and as a result the network cannot recover the origi-
nal OFDM data symbols over its subchannels which are spectrally
overlapping. In our AOTJ technique, the jammer is off-tone or not
synchronous with the target signal. It transmits asynchronous off-
tones which are not perfectly periodic or have an offset at the
sampling frequencies that brings ICI at the receiver.
Evaluation of attacks We evaluated our attacks in terms of
their feasibility and practicality over real operational LTE networks.
We use Google Pixel 2 as an attacker device, and Google Pixel 1
as victim device. We consider two U.S LTE operators, i.e. AT&T
(OPI) and T-mobile (OPII) to run our experiments. The attacker and
victim devices use AT&T and T-mobile pre-paid sim cards to register
with these two network operators. We use LTE signaling messages
analyzer, MobileInsight, to capture LTE signaling messages at both
attacker and victim devices. We run total of 200 experiments on
each network operator to assess the practicality of attack for each
attack step. To evaluate the practicality of the attacks, we use low-
cost commodity SDR hardware (HACKRF One) of the value of $299
to jam LTE signaling messages. HACKRF One has capability to
block UL and DL LTE signaling messages by generating ICI signals
towards LTE frequency band. To calibrate start and stop of jamming
with respect to LTE signaling messages, we use QXDM[3] which
is a real time LTE signaling messages sniffing/capturing tool from
Qualcomm.
4 OVERVIEW ON ATTACKS AND THEIR
ROOT CAUSES
The attacker can launch two types of key reinstallation attacks
by exploiting signaling vulnerabilities. In the first type, he hijacks
the location update procedure of the victim device. Consequently,
879ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Muhammad Taqi Raza, Yunqi Guo, Songwu Lu, and Fatima Muhammad Anwar
the network cannot reach the victim for the incoming voice calls
and data packets destined to the device. In the second type, the
attacker may incur LTE service outage at the victim device by
deregistering the device from the network. In our experiments, we
demonstrate the feasibility of these attacks over real LTE carrier
networks and their practicality in our testbed. There are two root
causes for the attacks. The first root cause is that the LTE control-
plane procedure is vulnerable to key reinstallation attacks. Such
attacks arise when the count reset procedure (i.e. LTE Security
Mode Command procedure) is allowed to re-execute many times
after the completion of key installation procedure (i.e. LTE NAS
Authentication procedure). The second root cause is that certain
control-plane messages are partially accepted even though they fail
the integrity check. These messages are finally accepted when the
network re-authenticates the device. The network does not request
the device to re-send the message that has failed the integrity check.
5 ATTACKING LTE CONTROL PLANE
Overview We demonstrate the feasibility and practicality of key
reinstallation attacks in LTE control-plane. The adversary adopts
the fact into his advantage that on inter-system switch from LTE
→ 3G→ LTE, location update procedure is triggered that installs
the key and resets the count values. The attacker silently2 brings
an inter-system switch at victim device through CSFB procedure.
He lets the device to complete the key installation procedure, but
strategically blocks the victim device UL signaling messages to bring
count reset procedure failure. The network re-initiates the failed
procedure that resets the count values at device again. This results
into keystream block reuse for those signaling messages that the
victim device sends after resetting the count values. The attacker
stops jamming, encrypts his spoofed message by using victim’s
keystream block3, and dispatches it to the network without being
MitM. The network receives two messages, the one originated from
the device and the other from the attacker. The network executes
the latest received message, according to 3GPP standard[6], and
discards the message received earlier. This makes our attack realistic
as the attacker message and the victim messages are not racing
with each other. Because the message was modified by the attacker,
it fails the integrity check at the network. However, instead of
dropping the packet, the network re-authenticates the victim device
and accepts the received spoofed message.
5.1 LTE Location Hijacking Attack
Feasibly analysis from LTE standard. Following we discuss
5.1.1
two vulnerabilities that we exploit in attacking LTE confidentiality
and integrity protocols.
1.1 LTE Integrity and confidentiality are enforced
through two disjoint procedures LTE security is enforced
through two separate procedures. In the first procedure, the LTE
core network invokes mutual authentication procedure, i.e. AKA
procedure, with the subscriber device. In LTE AKA procedure,
as shown in Figure 3 (upper rectangular part), the core network
element sends an Authentication Request message to the device.
2Attacker terminates the call before the victim device starts ringing, hence making it
silent inter-system switch.
3Attacker gets the keystream block by xoring location update message with the
encrypted message.
The device authenticates the LTE core network element, installs the
key and sends the Authentication Response message to network.
LTE core network verifies the response message and installs
the key at its end. After authentication procedure, the network
triggers NAS Security Mode Command (SMC) procedure. The
network sends SMC message to device, as shown in Figure 3 (lower
rectangular part) that includes NAS security algorithms to derive
integrity and ciphering keys4, as well as NAS-MAC (NAS Message
Authentication Code). As the device does not know the selected
encryption algorithm yet, this message is integrity protected only
but not ciphered. On receiving the SMC message the device resets
the pair of count (one for UL and one for DL transmission) values
to zero after NAS-MAC verification for integrity protection. The
LTE security specification (3GPP TS 33.401[7]) states:
“Only after EPS AKA the NAS security mode command message
shall reset NAS uplink and downlink COUNT values. Both the NAS
security mode command and NAS security mode complete messages
are protected based on reset COUNT values (zero).”
Thereafter, the device generates NAS Security Mode Complete
message to network which is both ciphered and integrity protected.
The network successfully verifies the integrity of the received NAS
Security Mode Complete message and resets the counts. Now the
NAS security setup procedure is said to be completed.
Figure 3: Authentication procedure installs security key and enables integrity
protection at the device and the network. The NAS Security Mode Command
procedure activates ciphering at the device and the network sides after suc-
cessful completion of the authentication procedure.
Now it is easy to see the vulnerability in which the attacker ex-
ploits the fact that the device resets the count values after installing
the key. The attacker can block the transmission of NAS Security
Mode Complete message and lets the network to re-initiate the
SMC procedure; causing the device to reset the counts again. In
this way, the signaling messages sent by device between subsequent
SMC procedures use same keystream block for their encryption.
Vulnerability 1: Failure of SMC procedure does not renew the
security key.
1.2 Network accepts certain NAS messages that fail the in-
tegrity check It is understandable that a number of NAS signaling
messages can be exchanged between device and the network before
the activation of NAS security. These signaling messages include
Attach Request, Authentication Request/Response/Failure, Security
Mode Reject, Identity Response, and few others. However, there are
a number of other messages (that include TAU Request and Detach
4For simplicity, in this paper we name all types of keys (i.e. integrity, ciphering) as
key.
Authentication Request (Not ciphered, not integrity protected)Core NetworkDeviceAuthentication Response (Response) (Not ciphered, not integrity protected)NAS Security Mode Command (Ciphering and integrity algorithms, NAS-MAC) (Not ciphered, NAS integrity protected)NAS Security Mode Complete (NAS-MAC) (NAS ciphered and integrity protected)Verify Response, install keyDecided to perform mutual authenticationPerforming ciphering procedureInstall key, enable integrityReset counts, enable cipheringReset counts, enable cipheringIntegrity setup procedureCiphering setup procedureCiphered and Integrity protected NAS signaling messages exchange880On Key Reinstallation Attacks over 4G LTE Control-Plane: Feasibility and Negative Impact
ACSAC ’21, December 6–10, 2021, Virtual Event, USA
Table 1: Silently getting victim TMSI: The time margin the attacker has to
hang-up the call by making sure that (1) paging message is broadcasted to-
wards victim, and (2) victim device does not ring.
Operator
OPI
OPII
Operator
OPI
OPII
Paging msg to call ringing event
Victim receives call through CSFB
Call init to paging msg
Min Max Avg
3.2s
4.6s
3.5s
2.5s
STD Min Max Avg
0.5s
3.3s
5.3s
0.6s
6.1s
4.8s
Victim receives call through VoLTE
2.4s
3.5s
4.4s
6.6s
STD
0.4s
0.9s
Call init to paging msg
Min Max Avg
2.3s
3.3s
3.3s
2.2s
4.4s
4.6s
STD Min Max Avg
0.5s
1.3s
2.2s
0.6s
0.7s
1.6s
2.0s
2.6s
STD
0.3s
0.3s
Paging msg to call ringing event
Request/Accept messages) that are “conditionally” accepted when
they fail the integrity check.
LTE NAS specification (3GPP TS 24.301[6]) states:
“These messages are processed by the MME even when the MAC that
fails the integrity check or cannot be verified, as in certain situations
they can be sent by the UE protected with an EPS security context that
is no longer available in the network.”
However, LTE core network re-authenticates the device before
finally accepting the message. As stated in LTE NAS specification
(3GPP TS 24.301[6]):
“If a TRACKING AREA UPDATE REQUEST message fails the in-
tegrity check, the MME shall initiate a security mode control procedure
to take a new mapped EPS security context into use.”
Such a 3GPP standard approach is vulnerable in which the net-
work accepts the spoofed message, failing the integrity check, after
re-authenticating the device.
Vulnerability 2: The network re-authenticates the device instead
of rejecting certain messages failing the integrity check.
5.1.2 Detail attack procedure. We describe step by step attack pro-
cedure as follow.
Pre-condition Before launching the attack, the attacker needs
to know the TMSI of the victim subscriber for identification pur-
pose. The attacker gets the TMSI through broadcast paging message
addressing the victim device. He can easily generate the paging
message for victim device by simply calling the victim. If the victim
phone is in idle state, the core network sends a paging broadcast
message that includes victim’s temporary identity (TMSI). On re-
ceiving the paging message, the victim device switches to connected
state and prepares to receive its call. Because the paging is a broad-
cast message within the tracking area, the attacker device also
receives the paging message[14]. By repeating this procedure, the
attacker can ensure that the TMSI maps to the victim device (sub-
scriber’s phone number).
Experiment results: A clever attacker would hang-up the call
before the victim device starts ringing. To assess the practicality of
hanging-up the call so that the victim device does not start ringing,
we run several experiments. We record the signaling messages and
the time between call initialization and call ringing events. In our
experiments, both caller and callee phones are time synchronized
through which we accurately correlate the events between two
phones. In total we collected 200 logs with 2 major US operators.
We consider the cases when the victim device receives the call
through CSFB, and VoLTE. The attacker always makes a CSFB call
(by turning off VoLTE option at its phone).
After initiating the call, the attacker must wait for paging mes-
sage to be delivered to victim device before hanging-up the call.
We can see from Table 1 that it takes around 3.5 seconds and 4.6
seconds (on average) for paging message to be received at victim
device for OPI and OPII, respectively. The attacker can terminate
the call afterwards where he has the error margin of 3.3 seconds
and 5.3 seconds (on average) to hang-up the call so that victim
device does not ring for OPI and OPII, respectively. Table 1 also
shows the results when the victim device receives the call through
VoLTE instead of CSFB.
There is a possibility that the call from the attacker does not
trigger any paging message towards the victim device. This is the
case when the victim device is in connected state. From Table 1, we
can see that the attacker can easily determine whether the victim
device is in idle or connected state. He first waits from call init to
paging message triggering time. If he does not sniff the broadcast
paging message during this period then he assumes that the victim
device is in connected state. The attacker then backs-off for tens of
seconds (the device’s default inactivity timer – time to transition
from connected to idle state – is 10s) and retries the call.
We now discuss our attack procedure in 3 main steps as shown
in Figure 4.
Triggering key update through inter-system switch The
attacker’s goal is to install fresh key and reset count values at vic-
tim device. To achieve this, he dials a phone call towards victim to
get CSFB call connection established with victim device and then
hangs-up the call. The CSFB call forces victim device to perform
inter-system switch (from LTE to 3G/2G). Once the attacker hangs-
up the call, the victim device moves back to LTE (from 2G/3G) and
performs random-access channel (RACH) procedure to synchro-
nize with LTE base station. Through RACH procedure, the device
receives a temporary radio identity (C-RNTI) mapped with its TMSI
from the base station. The attacker sniffs RACH messages to asso-
ciate victim subscriber’s TMSI with its C-RNTI. After RACH proce-
dure, the device setups its radio connection and sends unciphered
TAU Request message as initial NAS message. The device also starts
timer T3430 (default value of 15s) to retransmit the TAU Request
message if timeout occurs. On receiving the TAU Request message,
the network performs the Authentication procedure through which
both victim device and the network authenticate each other and
install the key.
Experiment results: We run more than 200 experiments to assess
the practicality of the attack. At first, we assess how successfully an
attacker can trigger inter-system switch by dialing a phone call. We
find that there are two cases: (1) either victim device or the network
does not supports VoLTE feature; or (2) both the victim device and
its associated network support VoLTE. In case of (1) the victim