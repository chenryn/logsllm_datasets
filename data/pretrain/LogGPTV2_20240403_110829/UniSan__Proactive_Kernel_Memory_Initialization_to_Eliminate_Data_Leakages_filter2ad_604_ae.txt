# 新发现的内核未初始化数据泄露漏洞列表

下表列出了由UniSan发现的新内核未初始化数据泄露漏洞。在“Patch”列中，S表示已提交补丁，✓ 表示已应用补丁。在“Cause”列中，P表示编译器填充，M表示缺少元素初始化。在“Kernel”列中，A代表Android，L代表Linux。

| CVE编号/内部ID | Patch | Cause | Kernel |
| --- | --- | --- | --- |
| CVE-2016-4486 | ✓ | P | A&L |
| CVE-2016-4482 | S | P | A&L |
| AndroidID-28620350 | ✓ | M | A&L |
| CVE-2016-4485 | ✓ | P | A&L |
| CVE-2016-4569 | ✓ | M | A&L |
| CVE-2016-4578 | ✓ | M | A&L |
| CVE-2016-4578 | ✓ | M | A&L |
| CVE-2016-4569 | ✓ | M | A&L |
| CVE-2016-5243 | ✓ | M | A&L |
| CVE-2016-5244 | ✓ | M | A&L |
| AndroidID-28620568 | ✓ | M | A&L |
| AndroidID-28619338 | ✓ | M | A&L |
| AndroidID-28620324 | ✓ | M | A&L |
| AndroidID-28673002 | ✓ | M | A&L |
| AndroidID-28672819 | ✓ | M | A&L |
| AndroidID-28616963 | ✓ | M | A&L |
| AndroidID-28616963 | ✓ | M | A&L |
| AndroidID-28616963 | ✓ | M | A&L |
| AndroidID-28616963 | ✓ | M | A&L |

*注：这两个“r1”位于不同的函数中。AndroidID是由Google的Android安全团队内部维护的。

## LMBench性能测试结果

时间单位为微秒。最后两行测量的是带宽，数值越大越好。由于无法在Nexus 9上建立TCP套接字，我们没有Android内核的TCP情况的数据。STACKLEAK是用GCC编译的。

| 测试项目 | Linux (x86_64) | UniSan (x86_64) | Android (AArch64) | UniSan (AArch64) |
| --- | --- | --- | --- | --- |
| null syscall | 0.04 | 0.04 (0.0%) | 0.04 | 0.04 (0.0%) |
| stat | 0.37 | 0.40 (8.1%) | 0.38 (2.7%) | 0.38 (2.7%) |
| open/close | 1.20 | 1.22 (1.7%) | 1.15 (-4.2%) | 1.15 (-4.2%) |
| select TCP | 2.44 | 2.48 (1.6%) | 2.44 (0.0%) | 2.44 (0.0%) |
| signal install | 0.11 | 0.11 (0.0%) | 0.11 (0.0%) | 0.11 (0.0%) |
| signal handle | 0.58 | 0.71 (22.4%) | 0.60 (3.4%) | 0.60 (3.4%) |
| fork+exit | 156 | 157 (0.6%) | 156 (0.0%) | 156 (0.0%) |
| fork+exec | 452 | 464 (2.7%) | 455 (0.7%) | 455 (0.7%) |
| prot fault | 0.295 | 0.317 (7.5%) | 0.316 (7.1%) | 0.316 (7.1%) |
| pipe (latency) | 9.673 | 10.21 (5.6%) | 9.909 (2.4%) | 9.909 (2.4%) |
| TCP (latency) | 91.8 | 99.5 (8.4%) | 97.3 (6.0%) | 97.3 (6.0%) |
| pipe (bandwidth) | 3,321 | 3,250 (2.1%) | 3,315 (0.2%) | 3,315 (0.2%) |
| TCP (bandwidth) | 2,331 | 2,264 (2.9%) | 2,333 (-0.1%) | 2,333 (-0.1%) |

## 用户空间程序性能评估结果

对于x86_64架构，我们使用标准的SPEC CPU 2006基准测试套件来测试UniSan对用户空间程序的性能影响。基准测试程序使用常见的选项（-pie -fPIC -O2）进行编译，并且每个基准测试运行了10次。具体结果如下表所示。UniSan引入的性能开销仅为0.54%，可以忽略不计。盲模式下的性能开销比UniSan高，为1.92%。当用户空间代码也应用盲模式时，开销达到10%（其中7%来自栈，3%来自堆）。

| 程序 | Native (秒) | Blind (百分比) | UniSan (百分比) |
| --- | --- | --- | --- |
| perlbench | 3.61 | 3.61 (0.0%) | 3.59 (-0.6%) |
| bzip2 | 4.74 | 4.78 (0.8%) | 4.78 (0.8%) |
| gcc | 0.968 | 0.970 (0.2%) | 0.966 (-0.2%) |
| mcf | 2.73 | 2.76 (1.1%) | 2.74 (0.4%) |
| gobmk | 14.0 | 14.0 (0.0%) | 14.0 (0.0%) |
| hmmer | 2.07 | 2.03 (-1.9%) | 2.04 (-1.4%) |
| sjeng | 3.27 | 3.30 (0.9%) | 3.33 (1.8%) |
| libquantum | 0.0387 | 0.0397 (2.6%) | 0.0395 (2.1%) |
| h264ref | 9.26 | 9.32 (0.6%) | 9.28 (0.2%) |
| omnetpp | 0.362 | 0.364 (0.6%) | 0.362 (0.0%) |
| astar | 7.81 | 7.92 (1.4%) | 7.92 (1.4%) |
| xalancbmk | 0.0758 | 0.0779 (2.8%) | 0.0738 (-2.6%) |
| milc | 4.57 | 4.76 (4.2%) | 4.76 (4.2%) |
| namd | 8.85 | 8.86 (0.1%) | 8.83 (-0.2%) |
| dealII | 10.5 | 10.6 (1.0%) | 10.6 (1.0%) |
| soplex | 0.0166 | 0.0186 (12.0%) | 0.0170 (2.4%) |
| povray | 0.427 | 0.439 (2.8%) | 0.426 (-0.2%) |
| lbm | 1.68 | 1.69 (0.6%) | 1.69 (0.6%) |
| sphinx | 1.19 | 1.28 (7.6%) | 1.20 (0.8%) |
| 几何平均值 | - | 1.92% | 0.54% |

对于AArch64架构，我们使用了专门针对Android的基准测试工具AnTuTu（包括3DBench）和Vellamo。这些测试涵盖了视频流、网页浏览、照片编辑等多种场景。每次测试重复五次以得出平均值。评估结果如下表所示。同样，UniSan的性能开销可以忽略不计（<1%），并且低于盲模式。

| 基准测试 | Native | Blind (百分比) | UniSan (百分比) |
| --- | --- | --- | --- |
| AnTuTu | 94,998 | 92,900 (2.2%) | 94,735 (0.3%) |
| Vellamo-Browser | 4,776 | 4,711 (1.4%) | - |
| Vellamo-Metal | 2,766 | 2,777 (-0.4%) | - |
| Vellamo-Multicore | 2,610 | 2,499 (4.3%) | - |

## 服务器程序性能评估

我们使用ApacheBench测试了UniSan对服务器程序性能的影响。具体结果如下表所示。UniSan的性能开销非常低（<1%），低于盲模式。

| 程序 | Native (秒) | Blind (百分比) | UniSan (百分比) |
| --- | --- | --- | --- |
| perlbench | 3.61 | 3.61 (0.0%) | 3.59 (-0.6%) |
| bzip2 | 4.74 | 4.78 (0.8%) | 4.78 (0.8%) |
| gcc | 0.968 | 0.970 (0.2%) | 0.966 (-0.2%) |
| mcf | 2.73 | 2.76 (1.1%) | 2.74 (0.4%) |
| gobmk | 14.0 | 14.0 (0.0%) | 14.0 (0.0%) |
| hmmer | 2.07 | 2.03 (-1.9%) | 2.04 (-1.4%) |
| sjeng | 3.27 | 3.30 (0.9%) | 3.33 (1.8%) |
| libquantum | 0.0387 | 0.0397 (2.6%) | 0.0395 (2.1%) |
| h264ref | 9.26 | 9.32 (0.6%) | 9.28 (0.2%) |
| omnetpp | 0.362 | 0.364 (0.6%) | 0.362 (0.0%) |
| astar | 7.81 | 7.92 (1.4%) | 7.92 (1.4%) |
| xalancbmk | 0.0758 | 0.0779 (2.8%) | 0.0738 (-2.6%) |
| milc | 4.57 | 4.76 (4.2%) | 4.76 (4.2%) |
| namd | 8.85 | 8.86 (0.1%) | 8.83 (-0.2%) |
| dealII | 10.5 | 10.6 (1.0%) | 10.6 (1.0%) |
| soplex | 0.0166 | 0.0186 (12.0%) | 0.0170 (2.4%) |
| povray | 0.427 | 0.439 (2.8%) | 0.426 (-0.2%) |
| lbm | 1.68 | 1.69 (0.6%) | 1.69 (0.6%) |
| sphinx | 1.19 | 1.28 (7.6%) | 1.20 (0.8%) |
| 几何平均值 | - | 1.92% | 0.54% |