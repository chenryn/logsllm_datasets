CN
AS Name
CHINANETBACKBONE
Uninet S.A. de C.V.
ASN-IBSNAZ
TELECOMUNICACOES
CHINA169-BACKBONE
data center type
AS Name
NOBISTECH
SOFTLAYER
GTT
NOC
TRANQUIL-HOSTING
Country
US
US
US
US
US
Table 9. Top 5 ASes for both types of clusters
IP/Preﬁx
IP
/24 Preﬁx
% in the Conﬁcker Botnet
11.29%
72.75%
Table 10. Percentages of botnet IPs/preﬁxs in
the top 5 ASes that appear in the Conﬁcker
botnet
access networks, while data center clusters mainly consist
of hosts from cloud computing or hosting service infrastruc-
tures. For example, NOBISTECH [3] and SOFTLAYER [4]
are two large service providers that provide hosting services
and data center services.
4.3.3 Comparison with Known Botnet Hosts
We also compare our botnet IP address list with the set of
known Conﬂicker bots derived using methods from [28] by
their courtesy. We ﬁnd that all the top ﬁve popular ASes
in our botnet clusters are the exact same set of popular
ASes for Conﬁcker bots. We also compare the IP addresses
from the top 5 ASes (see Table 9) in our botnet clusters to
the known Conﬁcker IP address set. Table 10 shows that
11.29% of the botnet IPs identiﬁed by SBotScope overlap
with the set of known Conﬁcker IPs, and 72.75% of the bot-
net IPs fall into the set of known /24 Conﬁcker IP preﬁxes.
This result suggests that the subset of botnet hosts that over-
lap with Conﬂicker bots are indeed correctly identiﬁed and
classiﬁed.
4.4 Comparing Botnet and Data Center Query
Activities
The categorization of query contents and host types al-
lows us to perform comprehensive analysis and compar-
isons on the query intentions and the network infrastruc-
tures from botnets and data centers.
In this section, we
quantitatively study the different behaviors and intentions
from these two types of hosts.
Botnet clusters
php
download
powered
email
pdf
email
php
topic
download
blog
Data center clusters
black
light
gold
video
bank
certiﬁed
ﬂights
car
shirt
adult
D1
D2
Table 11. Popular keywords in the patterns
4.4.1 Comparison on Search Behaviors
We ﬁnd that the search contents and behaviors of the two
types of clusters are drastically different. Table 11 sum-
marizes the most popular words in the query patterns from
different types of clusters. We ﬁnd that botnet clusters
mainly focus on discovering vulnerabilities (e.g., using
word “php”, “powered”, “pdf”), searching for email ad-
dresses and user account information (e.g., “email”), and
looking for free content downloads (e.g., “download”). In
contrast, data center clusters focus more on looking for
commercially relevant information using keywords related
to apparel and entertainment.
# of clusters
# of IP-segments
# of IPs
avg # of IPs/cluster
# of queries
avg # of queries/IP
avg # of patterns/cluster
botnet type
37,268
8,355,098
8,154,180
219
2,278,143,556
279
148
data center type
137
13,853
13,364
98
101,638,148
7,605
4,208
Table 12. Host activity summary for dataset
D1
# of clusters
# of IP-segments
# of IPs
avg # of IPs/cluster
# of queries
avg # of queries/IP
avg # of patterns/cluster
botnet type
44,252
7,423,261
7,278,295
164
1,444,931,738
198
166
data center type
150
20,099
19,559
130
198,903,861
10,169
3,121
Table 13. Host activity summary for dataset
D2
Besides different query contents, we also observe distin-
guishing activity patterns. Table 12 and 13 summarize the
statistics of the host activities from dataset D1 and D2. We
ﬁnd that the results are consistent over time. Overall, botnet
clusters include more IP addresses and submit an order of
magnitude of more queries in total than data center clusters.
In contrast, data center hosts are usually long-lived; each
host submits more queries on average, with a larger number
of query patterns per cluster.
4.4.2 Comparisons on Network Infrastructures
We then analyze the network infrastructures used by the
two different types of clusters. The number of botnet clus-
ters clearly dominates among the results. SBotScope identi-
ﬁes 37,268 botnet clusters and only 137 data center clusters
from dataset D1. Similarly, it identiﬁes 44,252 botnet clus-
ters and 150 data center clusters from dataset D2.
IP addresses in May, 2011 overlap with the botnet IP ad-
dresses in October, 2011.
To summarize, our ﬁndings indicate that botnet is a pop-
ular means for attackers to gather vulnerabilities and other
information from search engines. The majority of the bot
queries come from botnets on a global scale. Bot queries
from data centers are of mixed categories. We observe both
queries that are triggered by real users as well as malicious
queries. The appearance of data center hosts performing
malicious activities is a relatively new trend and deserves
futher study.
1
0.8
0.6
0.4
0.2
n
o
i
t
c
a
r
f
e
v
i
t
a
l
u
m
u
c
s
r
e
t
s
u
l
c
f
o
e
h
T
0
0
Botnets
Data Centers
0.2
0.1
0.9
Maximum percentage of IP addresses from one AS
0.5
0.3
0.4
0.6
0.7
0.8
1
Figure 8. Distribution of the maximum per-
centage of IP addresses from one AS for each
cluster
We ﬁnd that hosts in a data center cluster are more likely
to be from the same organization, perhaps due to the lower
costs and efforts in comparison to the case of renting hosts
from many organizations. We reverse look up the AS num-
ber for each IP address in data centers clusters. We ran-
domly pick 1000 botnet clusters (since the number of botnet
clusters is signiﬁcantly more than the number of data center
clusters) and look up the AS numbers for all of their hosts.
For each cluster, we identify the AS with the most num-
ber of hosts and compute the percentage. Figure 8 presents
the corresponding distribution. More than 90% data center
clusters have a large fraction of hosts (≥ 75%) hosts coming
from the same AS. In contrast, less than 5% botnet clusters
have a dominant AS with over 50% of their hosts.
Botnet IPs
Data center IPs
D1 D1 ∩ D2
489,251
4,544
8,154,180
13,364
% of persistent IPs
6%
34%
Table 14. Host overlap across time
In addition, we also compare the set of classiﬁed IP ad-
dresses across the two datasets collected from different pe-
riods. We ﬁnd that data center hosts are much more stable
over time. As presented in Table 14, for data center IP ad-
dresses that appeared in May, 2011 (D1), 34% of them were
still active and also belong to the data center clusters in Oc-
tober, 2011 (D2). As a comparison, only 6% of the botnet
5 Case Studies and Applications
In this section, we perform in-depth analysis on the in-
tentions and the origins of botnets and data center clusters
using three case studies. From these case studies, we show
how one can derive different attack phases, identify the pre-
cise botnet memberships, and uncover the exact vulnerabil-
ities targeted by attackers.
One application of SBotScope is to leverage the derived
query patterns for detecting bot queries that slipped through
the radar. To our knowledge, all existing bot-query detec-
tion systems rely on host (or user) behaviors or IP address
information for detection. None of them have explored the
use of query contents, which can be more robust to attacker
counter strategies, as it is fundamentally difﬁcult to modify
query keywords without affecting search results.
5.1 Case Study I: A Botnet Cluster
One detected botnet cluster is distinguished by the query
pattern “WordPress forum plugin Fredrik”. Table 15 shows
the statistics for this cluster. It includes 1,807 IP addresses
distributed across 1,752 /24 network preﬁxes, submitting in
total 127,557 queries with 62,115 unique ones. The vast
majority of hosts are active for only 1 day.
# of IPs
# of /24 preﬁxes
# of queries
# of unique queries
1,807
1,752
127,557
62,115
Table 15. Statistics of a botnet cluster
Tokens for vulnerabilities
WordPress forum plugin by Fredrik Fahlstad
fbconnec action=myhome
plugins/wpforum
forum.php
Powered by Joomla!. valid XHTML and CSS
# of queries
48,010
10,699
1,160
1,150
1,012
Table 16. Most popular vulnerability tokens in
the queries.
We examine this cluster and ﬁnd that a large fraction of
its queries are related with vulnerability searching. Each
query contains a quoted sub-string token for discovering
different types of vulnerabilities. There are in total 443
unique sub-string tokens. Table 16 lists the top popular
tokens that were searched most frequently. In addition to
the quoted sub-string tokens, each query also contains addi-
tional words, either specifying the query scopes, or aiming
to increase the search coverage.
14000
12000
10000
8000
6000
4000
2000
s
P
I
/
s
e
i
r
e
u
q
f
o
r
e
b
m
u
n
e
h
T
0
0
20
40
60
Queries
IPs
160
180
200
80
Time elapsed in hour
100
120
140
Figure 9. Number of queries/IPs in each hour
This botnet cluster shows strong bursty patterns in its
temporal behavior. Figure 9 plots the number of queries and
the number of IP addresses observed overtime. We see two
clear bursty periods, one for 6 hours, and the other for 21
hours. A closer look at these two bursts (Table 17 and 18)
reveals a multi-phase strategy adopted by attackers.
Burst1
Burst2
Duration (in hours)
# of IPs
# of queries
Duration (in hours)
# of IPs
# of queries
6
149
41,276
21
1,682
53,821
Table 17. Detailed statistics of the two phases
“index.php/thread-” shooter
“yabb/yabb.pl?board¯’’ siver
“index.php/thread-” site:com
“register.php?do=” socal
“memberlist.php?page=” somerset