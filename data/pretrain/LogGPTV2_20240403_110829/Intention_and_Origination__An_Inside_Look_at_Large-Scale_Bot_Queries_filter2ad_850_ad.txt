### 优化后的文本

#### 表9. 两种集群类型中排名前五的自治系统 (AS)

| AS编号 | AS名称 | 国家 |
| --- | --- | --- |
| CN | CHINANETBACKBONE | 中国 |
| AS Name | Uninet S.A. de C.V. | 墨西哥 |
| ASN-IBSNAZ | TELECOMUNICACOES | 巴西 |
| CHINA169-BACKBONE | 数据中心类型 | 中国 |
| AS Name | NOBISTECH | 美国 |
| SOFTLAYER | 美国 |
| GTT | 美国 |
| NOC | 美国 |
| TRANQUIL-HOSTING | 美国 |

#### 表10. 排名前五的AS在Conficker僵尸网络中的IP/前缀百分比

| IP/前缀 | % 在Conficker僵尸网络中 |
| --- | --- |
| IP | 11.29% |
| /24 前缀 | 72.75% |

### 4.3.3 与已知僵尸网络主机的比较
我们还将我们的僵尸网络IP地址列表与使用[28]方法得出的已知Conficker僵尸网络主机进行了对比。我们发现，在我们的僵尸网络集群中，排名前五的流行AS与Conficker僵尸网络中的流行AS完全一致。我们将排名前五的AS中的IP地址（见表9）与已知的Conficker IP地址集进行比较。表10显示，由SBotScope识别的僵尸网络IP中有11.29%与已知的Conficker IP重叠，而72.75%的僵尸网络IP属于已知的/24 Conficker IP前缀。这一结果表明，与Conficker僵尸网络主机重叠的僵尸网络主机确实被正确识别和分类。

### 4.4 比较僵尸网络和数据中心查询活动
对查询内容和主机类型的分类使我们能够对来自僵尸网络和数据中心的查询意图和网络基础设施进行全面分析和比较。本节中，我们定量研究了这两类主机的不同行为和意图。

#### 表11. 不同类型集群中最流行的关键词

| 僵尸网络集群 | 数据中心集群 |
| --- | --- |
| php, download, powered, email, pdf, topic, blog | black, light, gold, video, bank, certified, flights, car, shirt, adult |

### 4.4.1 查询行为的比较
我们发现，这两种集群的搜索内容和行为存在显著差异。表11总结了不同集群类型中最流行的查询关键词。僵尸网络集群主要关注发现漏洞（例如，“php”、“powered”、“pdf”）、搜索电子邮件地址和用户账户信息（例如，“email”），以及寻找免费内容下载（例如，“download”）。相比之下，数据中心集群更关注使用与服装和娱乐相关的关键词来查找商业相关信息。

#### 表12. 数据集D1的主机活动汇总

| 类型 | 集群数量 | IP段数量 | IP数量 | 平均每集群IP数 | 查询数量 | 平均每IP查询数 | 平均每集群模式数 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 僵尸网络 | 37,268 | 8,355,098 | 8,154,180 | 219 | 2,278,143,556 | 279 | 148 |
| 数据中心 | 137 | 13,853 | 13,364 | 98 | 101,638,148 | 7,605 | 4,208 |

#### 表13. 数据集D2的主机活动汇总

| 类型 | 集群数量 | IP段数量 | IP数量 | 平均每集群IP数 | 查询数量 | 平均每IP查询数 | 平均每集群模式数 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 僵尸网络 | 44,252 | 7,423,261 | 7,278,295 | 164 | 1,444,931,738 | 198 | 166 |
| 数据中心 | 150 | 20,099 | 19,559 | 130 | 198,903,861 | 10,169 | 3,121 |

除了不同的查询内容外，我们还观察到明显的活动模式。表12和表13总结了数据集D1和D2中的主机活动统计数据。我们发现这些结果在时间上是一致的。总体而言，僵尸网络集群包含更多的IP地址，并且提交的查询总数比数据中心集群多一个数量级。相比之下，数据中心主机通常是长期存在的；每个主机平均提交更多的查询，并且每个集群中的查询模式数量更多。

### 4.4.2 网络基础设施的比较
接下来，我们分析了这两种不同类型集群使用的网络基础设施。僵尸网络集群的数量明显占主导地位。SBotScope从数据集D1中识别出37,268个僵尸网络集群和137个数据中心集群。同样，它从数据集D2中识别出44,252个僵尸网络集群和150个数据中心集群。

### 5 案例研究与应用
在本节中，我们通过三个案例研究深入分析僵尸网络和数据中心集群的意图和来源。通过这些案例研究，我们展示了如何推导出不同的攻击阶段、确定精确的僵尸网络成员以及揭示攻击者针对的具体漏洞。

SBotScope的一个应用是利用推导出的查询模式来检测那些未被检测到的僵尸查询。据我们所知，所有现有的僵尸查询检测系统都依赖于主机（或用户）行为或IP地址信息进行检测。没有任何一个系统探索过查询内容的使用，而查询内容可以更好地抵御攻击者的反制策略，因为修改查询关键词而不影响搜索结果是非常困难的。

### 5.1 案例研究I：一个僵尸网络集群
一个被检测到的僵尸网络集群以查询模式“WordPress forum plugin Fredrik”为特征。表15显示了该集群的统计信息。它包括1,807个IP地址，分布在1,752个/24网络前缀中，总共提交了127,557次查询，其中62,115次是唯一的。绝大多数主机仅活跃一天。

#### 表15. 一个僵尸网络集群的统计信息

| 项目 | 数量 |
| --- | --- |
| IP数量 | 1,807 |
| /24前缀数量 | 1,752 |
| 查询数量 | 127,557 |
| 唯一查询数量 | 62,115 |

#### 表16. 查询中最受欢迎的漏洞标记

| 漏洞标记 | 查询数量 |
| --- | --- |
| WordPress forum plugin by Fredrik Fahlstad | 48,010 |
| fbconnec action=myhome | 10,699 |
| plugins/wpforum | 1,160 |
| forum.php | 1,150 |
| Powered by Joomla!. valid XHTML and CSS | 1,012 |

我们检查了这个集群，发现其大量查询与漏洞搜索有关。每个查询都包含一个用于发现不同类型漏洞的引用子字符串标记。总共有443个唯一的子字符串标记。表16列出了最常被搜索的标记。除了引用的子字符串标记外，每个查询还包含其他词汇，这些词汇要么指定了查询范围，要么旨在增加搜索覆盖率。

### 图9. 每小时的查询/IP数量

![查询/IP数量](https://example.com/figure9.png)

该僵尸网络集群在时间行为上表现出强烈的突发性。图9绘制了随时间变化的查询数量和IP地址数量。我们看到两个明显的突发期，一个持续6小时，另一个持续21小时。仔细查看这两个爆发期（表17和表18）揭示了攻击者采用的多阶段策略。

#### 表17. 两个阶段的详细统计

| 突发期 | 持续时间（小时） | IP数量 | 查询数量 |
| --- | --- | --- | --- |
| 突发1 | 6 | 149 | 41,276 |
| 突发2 | 21 | 1,682 | 53,821 |

#### 表18. 两个阶段的查询示例

| 突发1 | 突发2 |
| --- | --- |
| “index.php/thread-” shooter | “yabb/yabb.pl?board¯’’ siver |
| “yabb/yabb.pl?board¯’’ siver | “index.php/thread-” site:com |
| “index.php/thread-” site:com | “register.php?do=” socal |
| “register.php?do=” socal | “memberlist.php?page=” somerset |

通过这些案例研究，我们展示了如何推导出不同的攻击阶段、确定精确的僵尸网络成员以及揭示攻击者针对的具体漏洞。