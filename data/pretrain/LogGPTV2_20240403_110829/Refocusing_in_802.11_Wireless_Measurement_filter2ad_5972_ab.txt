amsniﬀers capturing frames matching this predicate will be instructed by the
amcontroller to devote more sampling time to the channels recently carrying
that traﬃc. AMs not capturing traﬃc from this laptop will continue to follow
a default sampling policy. If the laptop associates with a diﬀerent access point
using another channel, or moves within range of diﬀerent AMs, the shorter time
spent on other channels will facilitate those AMs to focus on the laptop. A short
cycle time, typically 1 or 2 seconds, enables each amsniﬀer to quickly identify
Refocusing in 802.11 Wireless Measurement
147
and focus on required traﬃc patterns. Again, this ability to remotely program
the AMs with a wide variety of predicates facilitates experimentation.
4 Applications of Refocusing
We believe that refocusing has many applications in wireless research, secu-
rity, and network management. Any application that requires more than cursory
scanning of the traﬃc in the wireless medium will sometimes desire an increased
focus on some subset of the traﬃc, and yet other applications will simultaneously
need a baseline broad sampling.
Filtering alone may not achieve the results needed by the application, because
the necessary frames may not be available. Therefore, there is a need for online
dynamic refocusing of the monitoring hardware.
We consider three classes of application.
Localization. If a WIFI device needs to be geographically localized, the refo-
cusing system can focus more attention on it by capturing more frames to and
from it. Refocusing may aid in better localizing the laptop, by capturing more
frames from as many diﬀerent perspectives (AMs) as possible. We can capture
more samples in less time, increasing the accuracy or reducing latency for esti-
mating the location of the laptop using any of the state-of-the-art methods. We
describe one such experiment in Section 5.2.
VOIP-quality measurement. Consider an enterprise network manager who
wishes to monitor the quality of Voice-over-IP calls. If there are known VoIP
clients using the Wi-Fi network, we can focus on those MAC addresses and
thus monitor the relevant channels, more closely. Alternately, we could focus
on channels with observed VoIP activity (by recognizing the use of particular
protocols) or through a higher-level metric like the jitter, per-frame delay in the
VoIP calls, or the observed congestion in a channel. For example, the predicate
may take the form “jitter >= x ms”. Such high-level predicates cannot yet be
matched in dingo. This capability is part of our future work.
Security monitoring. For example, we can refocus on channels that carry
an excessive number of deauthentication messages, or on MAC addresses that
are known to have been recently spoofed. In the future, using our techniques,
we can focus on channels where new clients appear, then study their packets
to discern whether they seem especially vulnerable to attack. The system can
ﬁngerprint new clients to determine if they are employing drivers, cards, or
operating systems with known vulnerabilities [5]. If indeed they are vulnerable,
we can refocus our sampling to more closely monitor them.
5 Results
We set out to investigate whether refocusing can be a valuable tool in wireless
measurement systems. In this short paper, we do not have the space for a complete
evaluation, but we seek to demonstrate the potential value of this approach.
148
U. Deshpande, C. McDonald, and D. Kotz
5.1 Improved Volume of Capture
In our CS department, we deployed 19 Aruba AP70 AMs throughout the three
ﬂoors of the building. The building also has 20 802.11a/b/g access points. The
AP70 has a MIPS IDT32434 CPU running at 266MHz, 32MB DRAM, two
Atheros AR5212 802.11a/b/g NICs (network interface controllers), two Ether-
net NICs and one USB port. We installed OpenWRT Linux (Kamikaze branch,
r5494) and Madwiﬁ (v0.9.2) on each, and a copy of amsniﬀer on each. In this
experiment, we only used one of the two wireless NICs on each AM.
We performed two experiments in which a laptop transmitted 10 UDP frames
per second to the non-existent MAC address 22:22:22:22:22:22 on a channel
randomly selected from the 11 802.11b channels. The laptop changed channels
every 10 seconds. In each experiment, the laptop was carried around a ﬁxed path
in the CS department building for a period of 10 minutes.
In the ﬁrst experiment our AMs used the traditional equal-time sampling
strategy in which the AMs spend equal time on all the channels. In the second
experiment, we refocused the AMs to spend more time on the channels that
were observed to capture more frames from the experimental laptop, using the
predicate "dst == 22:22:22:22:22:22".
Figure 2 plots the number of frames that matched the predicate, as seen in the
output of the AMs in both cases. We can see that every AM consistently captured
more frames from our mobile laptop when we ran the refocusing strategy than
when we ran the equal-time strategy.
s
e
m
a
r
f
f
o
r
e
b
m
u
N
16000
14000
12000
10000
8000
6000
4000
2000
0
1
3
5
7
9
11
13
15
17
19
AM number
Equal sampling
Refocused sampling
Fig. 2. Number of frames captured that matched predicate
In Figure 3 we present the number of frames that did not match the predicate.
Although the refocused strategy captured fewer such frames than the equal-
time strategy, it still provided a ﬂow of such baseline traﬃc suﬃcient for use by
other subscribers. That is, the refocusing requested by one application does not
preclude ongoing monitoring by background activities, at least in this case.
Refocusing in 802.11 Wireless Measurement
149
Fig. 3. Number of frames captured that did not match predicate
5.2 Localization Experiment
Our hypothesis is that refocusing will allow an application to more accurately,
and more quickly, determine the location of a given wireless client. We chose
a technique, the Nearest Neighbor in Signal Space (NNSS) method, described
by Bahl et al. [3]. This localization algorithm uses observed signal strengths
of frames heard by clients from APs. We used the dual of this algorithm and
constructed the signal space by using the RSSI of captured frames from the
client at AMs to populate our signal space.
Firstly, we calibrated the corridor of the third ﬂoor of our building. We mea-
sured the signal strength at every AM from the frames of a client transmitting
50 frames at every ﬁve feet along the corridor. In this phase, we conﬁgured all
of the AMs to capture traﬃc on channel 1, and conﬁgured the client to transmit
on channel 1. In the second phase, we conﬁgured the AMs to sample equally on
every channel, and we captured a trace of the client transmitting 10 frames at
every 10 feet along the corridor. Finally, we conﬁgured the AMs to refocus on the
MAC address of our client and captured a trace of the transmissions of the client
at the same locations as in the second case. With our refocusing mechanism we
observe localizations that are, on average, 1.95 feet more accurate than without
refocusing.
6 Discussion
Given that the Internet edge is increasingly wireless, and the increasing num-
ber of channels in Wi-Fi (802.11n includes far more channels than 802.11b, for
example), any researcher or network manager seeking to measure their network
traﬃc must ﬁnd eﬃcient mechanisms to sample the network traﬃc. We pro-
pose a mechanism for applications to dynamically refocus the attention of the
wireless-measurement infrastructure to capture more of a desired kind of network
traﬃc.
150
U. Deshpande, C. McDonald, and D. Kotz
Our experimental results indicate that refocusing was successful in capturing
a greater number of frames matching the supplied predicate. Simultaneously, the
capture of non-matching frames was not degraded substantially.
These preliminary results demonstrate the potential for our framework to be
used in scenarios where stateless predicate matching is suﬃcient. There may,
however, be more complex scenarios that require more state to be maintained.
For example, our framework cannot currently express the desire to refocus on
newly arrived clients, on those channels with an increase in some metric, or on
channels with high jitter (inter-arrival times between frames) in a voice ﬂow.
Our next step is to extend the framework to be able to refocus on the basis of
temporal changes like those.
Acknowledgments
We gratefully acknowledge the input and support of colleagues on the MAP
team, and Dartmouth’s network administrators, including Wayne Cripps and
Tim Tregubov. The staﬀ at Aruba Networks has been invaluable, including Nick
DePetrillo and Mike Baker.
This research program is a part of the Institute for Security Technology Stud-
ies, supported under award number NBCH2050002 from the U.S. Department
of Homeland Security, Science and Technology Directorate. Points of view in
this document are those of the authors and do not necessarily represent the of-
ﬁcial position of the U.S. Department of Homeland Security or the Science and
Technology Directorate. This project was also supported by the Cisco Systems
University Research Program, the Center for Mobile Computing at Dartmouth
College, and NSF Infrastructure Award EIA-9802068.
References
1. Aruba Networks Air Monitors,
http://www.arubanetworks.com/technology/air-monitors/
2. Bahl, P., Chandra, R., Padhye, J., Ravindranath, L., Singh, M., Wolman, A., Zill,
B.: Enhancing the security of corporate Wi-Fi networks using DAIR. In: Proceed-
ings of MobiSys 2006, Uppsala, Sweden, June 2006, pp. 1–14 (2006)
3. Bahl, P., Padmanabhan, V.N.: RADAR: An in-building RF-based user location
and tracking system. In: Proceedings of InfoCom 2006, pp. 775–784 (2000)
4. Bellardo, J., Savage, S.: 802.11 denial-of-service attacks: Real vulnerabilities and
practical solutions. In: Proceedings of the Twelfth USENIX Security Symposium,
Washington, DC, USA, August 2003, (USENIX Association), pp. 15–28 (2003)
5. Bratus, S., Cornelius, C., Kotz, D., Peebles, D.: Active behavioral ﬁngerprinting of
wireless devices. In: Proceedings of the First ACM Conference on Wireless Network
Security (WiSec), March 2008, ACM Press, New York (accepted for publication,
2008)
6. Chandra, R., Padhye, J., Wolman, A., Zill, B.: A location-based management sys-
tem for enterprise wireless LANs. In: Proceedings of the 4th USENIX Symposium
on Networked Systems Design and Implementation (NSDI 2007), Cambridge, MA,
USA (2007)
Refocusing in 802.11 Wireless Measurement
151
7. Cheng, Y.-C., Afanasyev, M., Verkaik, P., Benk¨o, P., Chiang, J., Snoeren, A.C.,
Savage, S., Voelker, G.M.: Automating cross-layer diagnosis of enterprise wireless
networks. SIGCOMM Comput. Commun. Rev. 37(4), 25–36 (2007)
8. Cheng, Y.-C., Bellaro, J., Benko, P., Snoeren, A.C., Voelker, G.M., Savage, S.: Jig-
saw: Solving the puzzle of enterprise 802.11 analysis. In: Proceedings of SIGCOMM
2006, Pisa, Italy, September 2006, pp. 39–50 (2006)
9. Deshpande, U., Henderson, T., Kotz, D.: Channel sampling strategies for mon-
itoring wireless networks. In: Proceedings of the Second Workshop on Wireless
Network Measurements, USA, April 2006, IEEE Computer Society Press, Boston
(2006)
10. Jardosh, A.P., Ramachandran, K.N., Almeroth, K.C., Belding-Royer, E.M.: Un-
derstanding congestion in IEEE 802.11b wireless networks. In: Proceedings of the
2005 Internet Measurement Conference, Berkeley, CA, USA, October 2005, pp.
279–292 (2005)
11. Kismet wireless sniﬀer, http://www.kismetwireless.net
12. Mahajan, R., Rodrig, M., Wetherall, D., Zahorjan, J.: Analyzing the MAC-level
behavior of wireless networks in the wild. In: Proceedings of SIGCOMM 2006, Pisa,
Italy, September 2006, pp. 75–86 (2006)
13. Rodrig, M., Reis, C., Mahajan, R., Wetherall, D., Zahorian, J.: Measurement-based
characterization of 802.11 in a hotspot setting. In: Proceedings of the ACM SIG-
COMM 2005 Workshop on Experimental Approaches to Wireless Network Design
and Analysis (E-WIND-2005), Philadelphia, PA, USA (August 2005)
14. Wireless vulnerabilities & exploits database, http://wirelessve.org
15. Yeo, J., Youssef, M., Henderson, T., Agrawala, A.: An accurate technique for mea-
suring the wireless side of wireless networks. In: Proceedings of the International
Workshop on Wireless Traﬃc Measurements and Modeling, Seattle, WA, USA,
June 2005, pp. 13–18 (2005)