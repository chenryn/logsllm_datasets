message. This again prevents the adversary from performing
a matching attack on the first block of the hash function
implementation only, because that first block will already
have an unknown input, and will in turn make unknown the
inputs of all further blocks.
These observations lead us to the following definition.
Definition 7.4. A hash function H : â„› Ã— â„³ â†’ â„¬ with
leakage function L is (ğ‘, ğ‘¡, ğœ–)-leakage-resilient if, for every (ğ‘, ğ‘¡)-
bounded adversary ğ’œL, the advantage
is bounded by ğœ–, where Hashğ‘ğ’œL,H is defined as the probability
âƒ’âƒ’âƒ’Hash0ğ’œL,H âˆ’ Hash1ğ’œL,H
âƒ’âƒ’âƒ’
Conferenceâ€™17, July 2017, Washington, DC, USA
that ğ’œL outputs 1 when, after a query (ğ‘š0, ğ‘š1) âˆˆ â„³2, he is
returned with the pair (H(ğ‘Ÿâ€–ğ‘šğ‘), L(ğ‘Ÿâ€–ğ‘šğ‘)) with ğ‘Ÿ $â† â„›.
Based on these definitions of leakage resilient PRF and
hash function, the following section shows the LMCPA secu-
rity of DCE and DTE. Admittedly, these results should be
understood similarly to the ones in [37], where it was argued
that semantic security with negligible advantage is impossible
to achieve even if the leakage of an encryption would be
as low as a single message bit (in contrast, leaking a bit of
the secret key may not be an issue). So informally, what
we show next is that the execution of our leakage-resilient
authentication scheme for many messages does not signifi-
cantly degrade the security compared to the situation with a
single message, and that the security degradation resulting
from the encryption of a long multi-block message is not
significantly worse than if this message had been encrypted
block by block, with fresh independent keys for each block.
Concretely though, it always remains that manipulating the
message leaks some information that can be exploited via
SPA (as just explained), because of the initial hashing of
Figures 2 and 5 and the stream encryption of Figure 3.
7.3 LMCPA Security of the DCE and DTE
schemes
We start by focusing on the LMCPA security of the DCE
scheme. The leakage function L(ğ‘˜, ğ‘Ÿ, ğ‘š) for DCE is defined
by the pair (LH(ğ‘Ÿ, ğ‘š), LPSV(ğ‘˜0, ğ‘Ÿâ€–ğ‘š)), where ğ‘˜0 is defined as
Fğ‘˜(H(ğ‘Ÿâ€–ğ‘š)). The LH component of this leakage contains the
leakage occurring during the evaluation of the hash function in
DCE encryption, and the LPSV component contains the leakage
of the encryption part of the DCE as depicted in Figure 3,
which we refer to as the â€œPSV-encryption componentâ€ of
DCE. The LPSV function itself returns leakages that are made
of individual leakages by each PRF and XOR operation, as
defined in [37], but this is irrelevant for our analysis.
PSVâˆ’ENC)-leav secure.
Theorem 7.5. Let H : â„› Ã— â„³ â†’ â„¬ be a (0, ğ‘¡, ğœ–ğ‘ğ‘Ÿ)-
collision resistant and (ğ‘, ğ‘¡, ğœ–LH )-leakage-resilient hash func-
tion. Let F be a (ğ‘, ğ‘¡, ğœ–F)-pseudorandom function. Let DCE
be implemented with a PSV-encryption component that is
(ğ‘, ğ‘¡, ğœ–leav
Then, the DCE scheme with the leakage function L de-
scribed above is (ğ‘â€², ğ‘¡â€², ğœ–lmcpa)-secure. Here: ğ‘â€² â‰¤ ğ‘ âˆ’ ğ‘ğ‘’ âˆ’ 1
where ğ‘ğ‘’ is the number of encryption queries made by the
(ğ‘â€², ğ‘¡â€²)-bounded LMCPA adversary; ğ‘¡â€² â‰¤ ğ‘¡1 âˆ’ ğ‘¡ğ‘ âˆ’ ğ‘¡ğ‘ ğ‘, where ğ‘¡ğ‘
is the running time needed to run the LMCPA challenger in
front of a (ğ‘, ğ‘¡â€²)-bounded adversary, ğ‘¡ğ‘ ğ‘ is the time needed to
determine whether a list of ğ‘ğ‘’ hash values contains a collision;
and ğœ–lmcpa â‰¤ 2 ğ‘2
ğ‘’|â„›| + 2ğœ–ğ‘ğ‘Ÿ + 4ğœ–F + ğœ–LH + ğœ–leav
PSVâˆ’ENC.
The proof of Theorem 7.5 is given in Appendix C.
The leakage-resilient CPA security of the DTE scheme can
be shown in an almost identical way.
Theorem 7.6. Let H : â„› Ã— â„³ â†’ â„¬ be a (0, ğ‘¡, ğœ–ğ‘ğ‘Ÿ)-
collision resistant and (ğ‘, ğ‘¡, ğœ–LH )-leakage-resilient hash func-
tion. Let F be a (2ğ‘, ğ‘¡, ğœ–F)-pseudorandom function. Let DTE
Francesco Berti, FranÂ¸cois Koeune, Olivier Pereira,
Thomas Peters, FranÂ¸cois-Xavier Standaert.
PSVâˆ’ENC)-leavsecure.
be implemented with a PSV-encryption component that is
(ğ‘, ğ‘¡, ğœ–leav
Then, the DTE scheme with the leakage function L de-
scribed above is (ğ‘â€², ğ‘¡â€², ğœ–lmcpa)-secure. Here: ğ‘â€² â‰¤ ğ‘ âˆ’ ğ‘ğ‘’ âˆ’ 1
where ğ‘ğ‘’ is the number of encryption queries made by the
(ğ‘â€², ğ‘¡â€²)-bounded LMCPA adversary; ğ‘¡â€² â‰¤ ğ‘¡1 âˆ’ ğ‘¡ğ‘ âˆ’ ğ‘¡ğ‘ ğ‘, where ğ‘¡ğ‘
is the running time needed to run the LMCPA challenger in
front of a (ğ‘â€², ğ‘¡â€²)-bounded adversary, ğ‘¡ğ‘ ğ‘ is the time needed to
determine whether a list of ğ‘ğ‘’ hash values contains a collision;
and ğœ–lmcpa â‰¤ 2 ğ‘2
|â„¬| + 2ğœ–ğ‘ğ‘Ÿ + 4ğœ–F + ğœ–LH + ğœ–leav
ğ‘’|â„›| + 4 (ğ‘ğ‘’+1)2
PSVâˆ’ENC.
The proof shares almost all features of the one for the DCE
scheme, and the handling of adversarial queries is the same.
The double use of Fğ‘˜ just loosens the bounds of Thm. 7.5 by
constant factors, by increasing the probability of collisions
and doubling the number of queries that are needed when
replacing the evaluation of F with the selection of random
values (which is included in the ğ‘¡ğ‘ bound on the challenger
running time). It is given in Appendix D.
8 CONCLUSIONS
To conclude this paper, we first observe that our analyzes
focus on the leakages occurring during AE, so far excluding
the possibility to target a decryption device. Interestingly,
this limitation is very strong in the LR MAC and encryption
schemes of [37] because random IVs are strictly needed for
LR security, and a decryption oracle allows the adversary
to control the IV. As discussed in Section 4, contradicting
this requirement directly enables devastating forgery attacks
based on a standard DPA. By contrast, our notion of CIML
aims at mitigating the impact of IV control. So it is natu-
ral to investigate whether it formally rules out any attack
against the decryption oracle. Unfortunately, and despite
CIML security indeed rules out many realistic attacks against
a decryption device, our schemes remain susceptible to strong
attacks when the decryption leaks. Taking the case of DTE,
we can for example show that it is possible to forge valid
ciphertexts thanks to decryption leakages as follows: (1) Pick
a random ğ‘Ÿ and message ğ‘š and compute â„ = H(ğ‘Ÿâ€–ğ‘š). (2)
Ask decryption of ciphertext ğ¶ ğ‘– = (ğœ, ğ‘ğ‘–) with ğœ = â„ and a
random ğ‘ğ‘– and recover ğ‘˜0 thanks to leakage. (3) Ask decryp-
tion of ciphertext ğ¶ ğ‘— = (ğœâ€², ğ‘ğ‘—) with ğœâ€² = ğ‘˜0 and a random
ğ‘ğ‘— and recover ğ‘˜â€²
0, compute
the ciphertext ğ‘ produced using the encryption part of DTE
from the ephemeral key ğ‘˜â€²
0, the random ğ‘Ÿ and the message
ğ‘š, so that ğ¶ = (ğ‘˜0, ğ‘) is valid (and has decryption ğ‘š). A
similar attack can be performed against DCE. Note that this
attack (which essentially exploits SPA to recover ephemeral
keys) is admittedly more challenging than the standard DPAs
in Section 4. Yet, it is also impossible to argue why such
attacks should not be covered by our threat model. A formal
treatment of CIML extended with decryption leakages has
been recently proposed in [11].
0 thanks to leakage. (4) From ğ‘˜â€²
We finally mention that our work is focused on CIML which
is an integrity notion primarily intended for authentication
(or the authentication part of an AE scheme). By contrast,
Ciphertext Integrity with Misuse and Leakage
Conferenceâ€™17, July 2017, Washington, DC, USA
our treatment of LR CPA security so far excludes randomness
misuse. The main reason for this separate treatment is that
CIML can be achieved in a very liberal (mostly unbounded)
leakage model. We leave the extension of these definitions
towards a complete definition of LR MR AE as an interesting
scope for further research.
Acknowledgments. Thomas Peters is a postdoctoral re-
searcher and FranÂ¸cois-Xavier Standaert is a senior research
associate of the Belgian Fund for Scientific Research (F.R.S.-
FNRS). This work has been funded in parts by the European
Union (EU) through the ERC projects CRASH (280141)
and SWORD (724725), the INNOVIRIS projects SCAUT
and C-Cure, the ARC project NANOSEC and the European
Union and Walloon Region FEDER USERMedia project
501907-379156.
REFERENCES
[1] M. R. Albrecht and K. G. Paterson. Lucky microseconds: A timing
attack on amazonâ€™s s2n implementation of TLS. In EUROCRYPT,
pages 622â€“643, 2016.
[2] M. R. Albrecht, K. G. Paterson, and G. J. Watson. Plaintext re-
covery attacks against SSH. In S&P, pages 16â€“26. IEEE Computer
Society, 2009.
[3] E. Andreeva, A. Bogdanov, A. Luykx, B. Mennink, N. Mouha,
and K. Yasuda. How to securely release unverified plaintext in
authenticated encryption. In ASIACRYPT 2014, volume 8873 of
LNCS, pages 105â€“125. Springer, 2014.
[4] E. Andreeva and M. Stam. The symbiosis between collision and
preimage resistance. In L. Chen, editor, IMACC, volume 7089 of
LNCS, pages 152â€“171. Springer, 2011.
[5] J. Balasch, B. Gierlichs, O. Reparaz, and I. Verbauwhede. DPA,
bitslicing and masking at 1 GHz. In T. GÂ¨uneysu and H. Handschuh,
editors, CHES, volume 9293 of LNCS, pages 599â€“619. Springer,
2015.
[6] G. Barwell, D. P. Martin, E. Oswald, and M. Stam. Authenticated
encryption in the face of protocol and side channel leakage. In
T. Takagi and T. Peyrin, editors, Advances in Cryptology - ASI-
ACRYPT 2017 - 23rd International Conference on the Theory
and Applications of Cryptology and Information Security, Hong
Kong, China, December 3-7, 2017, Proceedings, Part I, volume
10624 of Lecture Notes in Computer Science, pages 693â€“723.
Springer, 2017.
[7] G. Barwell, D. Page, and M. Stam. Rogue decryption failures:
Reconciling AE robustness notions. In IMACC 2015, volume
9496 of LNCS, pages 94â€“111. Springer, 2015.
[8] S. BelaÂ¨Ä±d, V. Grosso, and F. Standaert. Masking and leakage-
resilient primitives: One, the other(s) or both? Cryptography and
Communications, 7(1):163â€“184, 2015.
[9] M. Bellare and C. Namprempre. Authenticated encryption: Re-
lations among notions and analysis of the generic composition
paradigm. J. Cryptology, 21(4):469â€“491, 2008.
[10] F. Berti, F. Koeune, O. Pereira, T. Peters, and F. Standaert.
Leakage-resilient and misuse-resistant authenticated encryption.
IACR Cryptology ePrint Archive, 2016:996, 2016.
[11] F. Berti, O. Pereira, T. Peters, and F. Standaert. On leakage-
resilient authenticated encryption with decryption leakages. IACR
Trans. Symmetric Cryptol., 2017(3):271â€“293, 2017.
[12] G. Bertoni, J. Daemen, M. Peeters, and G. V. Assche. On the
indifferentiability of the sponge construction. In EUROCRYPT,
pages 181â€“197, 2008.
[13] A. Boldyreva, J. P. Degabriele, K. G. Paterson, and M. Stam. On
symmetric encryption with distinguishable decryption failures. In
FSE 2013, volume 8424 of LNCS, pages 367â€“390. Springer, 2013.
[14] CAESAR. Competition for authenticated encryption: Security, ap-
plicability, and robustness. https://competitions.cr.yp.to/caesar.
html, 2012.
[15] S. Chari, J. R. Rao, and P. Rohatgi. Template attacks. In B. S. K.
Jr., CÂ¸ . K. KoÂ¸c, and C. Paar, editors, CHES, volume 2523 of LNCS,
pages 13â€“28. Springer, 2002.
[16] C. Dobraunig, M. Eichlseder, S. Mangard, F. Mendel, and T. Un-
terluggauer. ISAP - towards side-channel secure authenticated
encryption. IACR Trans. Symmetric Cryptol., 2017(1):80â€“105,
2017.
[17] C. Dobraunig, F. Koeune, S. Mangard, F. Mendel, and F. Stan-
daert. Towards fresh and hybrid re-keying schemes with beyond
birthday security. In CARDIS, pages 225â€“241, 2015.
[18] T. Duong and J. Rizzo. Cryptography in the web: The case of
cryptographic design flaws in ASP.NET. In S&P, pages 481â€“489.
IEEE Computer Society, 2011.
[19] S. Dziembowski and K. Pietrzak. Leakage-resilient cryptography.
In FOCS, pages 293â€“302, 2008.
[20] S. Faust, K. Pietrzak, and J. Schipper. Practical leakage-resilient
symmetric cryptography. In CHES, pages 213â€“232, 2012.
[21] B. Fuller and A. Hamlin. Unifying leakage classes: Simulatable
leakage and pseudoentropy. In ICITS, pages 69â€“86, 2015.
[22] D. Gruss, R. Spreitzer, and S. Mangard. Cache template attacks:
Automating attacks on inclusive last-level caches. In USENIX
Security, pages 897â€“912, 2015.
[23] S. Gueron and Y. Lindell. GCM-SIV: full nonce misuse-resistant
authenticated encryption at under one cycle per byte. In CCS,
pages 109â€“119. ACM, 2015.
[24] V. T. Hoang, T. Krovetz, and P. Rogaway. Robust authenticated-
encryption AEZ and the problem that it solves. In EUROCRYPT,
volume 9056 of LNCS, pages 15â€“44. Springer, 2015.
[25] ISO/IEC 19772:2009.
Information technology â€“ security tech-
niques â€“ authenticated encryption. https://www.iso.org/standard/
46345.html, 2009.
[26] J. Katz and M. Yung. Unforgeable encryption and chosen ci-
In FSE, pages 284â€“299,
phertext secure modes of operation.
2000.
[27] J. Longo, D. P. Martin, E. Oswald, D. Page, M. Stam, and M. Tun-
stall. Simulatable leakage: Analysis, pitfalls, and new construc-
tions. In ASIACRYPT, Part I, pages 223â€“242, 2014.
[28] J. Longo, E. D. Mulder, D. Page, and M. Tunstall. SoC it to EM:
electromagnetic side-channel attacks on a complex system-on-chip.
In CHES, pages 620â€“640, 2015.
[29] S. Mangard. Hardware countermeasures against DPA ? A statis-
tical analysis of their effectiveness. In CT-RSA, pages 222â€“235,
2004.
[30] S. Mangard, E. Oswald, and F. Standaert. One for all - all for
one: unifying standard differential power analysis attacks. IET