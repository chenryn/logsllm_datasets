  new	
  command	
AWID26	
  BitStream	
  Added	
  getAWIDBits()	
  utility	
  function	
  on	
  client	
  side	
  Translate	
  facility-­‐code	
  and	
  card	
  number	
  into	
  bits	
  Card	
  data	
  stored	
  as	
  array	
  of	
  12	
  uint8_t	
  Logic	
  via	
  AWID	
  PDF	
parityTest()	
  via	
  lfdemod.h	
  Hardcoded	
  for	
  26-­‐bit	
  Wiegand	
lf	
  awid	
  clone	
  Programs	
  T55x7	
  as	
  speciﬁed	
  AWID26	
  Uses	
  getAWIDBits()	
  to	
  determine	
  BitStream	
  Block	
  0	
  is	
  static	
  rate/modulation	
  conﬁg	
Bitstream	
  split	
  into	
  blocks	
  1-­‐3	
Cmd	
  =	
  CMD_T55XX_WRITE_BLOCK	
Args:	
  (data,	
  block	
  num,	
  password)	
lf	
  awid	
  clone	
lf	
  awid	
  sim	
Calculates/displays	
  ‘lf	
  simfsk’	
  parameters	
  for	
  AWID26	
cmd	
  =	
  CMD_FSK_SIM_TAG	
arg[0]	
  =	
  fcHigh<<8	
  +	
  fcLow	
  =	
  (10<<8)+8	
arg[1]	
  =	
  CLK	
  &	
  Invert	
  =	
  50	
arg[2]	
  =	
  Length	
  =	
  96	
  (bits)	
d.asBytes	
  =	
  BitStream	
  (1	
  bit	
  per	
  byte)	
Antenna	
  Construction	
  The	
  Problem	
  Traditional	
  DIY	
  involves	
  a	
  lot	
  of	
  trial	
  and	
  error	
  The	
  outcome	
  is	
  not	
  always	
  ideal	
  for	
  practical	
  attacks	
  My	
  Solution:	
  3D	
  Printing	
  Create	
  forms	
  with	
  precise	
  measurements	
  easily	
  Make	
  coils	
  that	
  blend	
  in	
Supplies	
  High	
  AWG	
  magnet	
  wire	
  (e.g.	
  40AWG)	
  Utility	
  knife	
  (to	
  remove	
  enamel	
  from	
  wire	
  ends)	
  Soldering	
  iron	
  Heat	
  shrink	
  tubing	
  (optional)	
  Inductance	
  meter	
  (optional)	
The	
  Math	
  of	
  Tuning	
  The	
  antenna	
  coil	
  is	
  an	
  inductor	
  (L)	
  An	
  LC	
  circuit	
  is	
  formed	
  by	
  pairing	
  it	
  with	
  a	
  capacitor	
  Goal	
  is	
  to	
  match	
  the	
  coil’s	
  L	
  with	
  the	
  capacitor	
  @	
  F	
F =
1
2π CL
The	
  Math	
  of	
  Tuning	
  Microchip	
  AN170	
  Coil	
  induction	
  equations	
  Organized	
  by	
  coil	
  shape	
  For	
  my	
  ‘multilayer	
  rectangular	
  loop	
  coil’:	
L =
0.0276(CN)2
1.908C + 9b+10h (µH)
WHEREè	
Making	
  a	
  Fake	
  Badge	
  Started	
  with	
  D18c7db’s	
  LF	
  design	
  Constructed	
  with	
  CD	
  jewel	
  cases	
  cut	
  to	
  size	
  Rectangular	
  “badge-­‐like”	
  70x40mm	
  coil	
  is	
  perfect	
  Drew	
  with	
  CAD	
  and	
  exported	
  for	
  printing	
  Add	
  an	
  ID	
  sticker	
  for	
  an	
  extra	
  convincing	
  look	
  Lanyard	
  clip	
  allows	
  route	
  for	
  discrete	
  wiring	
Winding	
  the	
  Coil	
  Coil	
  inductance	
  is	
  matched	
  to	
  capacitor	
  for	
  resonance	
  First	
  calculate	
  L	
  based	
  on	
  F	
  and	
  C	
  Calculate	
  turns	
  required	
  for	
  L	
  based	
  on	
  shape	
  For	
  my	
  Proxmark3:	
  ~87	
  turns	
  For	
  my	
  RFIDler:	
  ~57	
  turns	
  Calculations	
  only	
  give	
  guideline	
  due	
  to	
  natural	
  variance	
L =
1
4π 2CF 2
Winding	
  the	
  Coil	
  Wind	
  more	
  turns	
  than	
  you	
  expect	
  to	
  need	
  Removing	
  extra	
  turns	
  is	
  easy	
  Making	
  up	
  for	
  not	
  enough	
  turns	
  –	
  NOT	
  SO	
  EASY	
  Count	
  and	
  watch	
  for	
  wire	
  getting	
  caught	
  on	
  edges	
First	
  Antenna	
  Attempt	
DIY	
  vs.	
  Oﬀ-­‐the-­‐Shelf	
Badge	
  Revision	
BADge-­‐tenna	
  $7.68	
  +	
  $4.99	
  shipping	
  for	
  ﬂexible	
  white	
  plastic	
  Suitable	
  alternative	
  for	
  those	
  without	
  a	
  3d	
  printer	
  With	
  CubePro:	
  about	
  $4	
  ﬁlament	
  Print	
  costs	
  below	
  $1	
  with	
  generic	
  ﬁlament	
  Cable	
  hidden	
  in	
  black	
  lanyard	
  Scavenged	
  RCA	
  cable	
  for	
  length	
Clipwned	
Storage	
  clipboards	
  are	
  great	
  cover!	
They	
  blend	
  well	
  with	
  room	
  for	
  toys!	
Printed	
  spacers	
  hold	
  the	
  gear	
  tight.	
An	
  oﬃcial	
  sticker	
  seals	
  the	
  deal…	
Clipboards	
  lend	
  authority,	
  it’s	
  up	
  to	
  you	
  to	
  take	
  it!	
What	
  is	
  Clipwned	
  “Could	
  I	
  just	
  grab	
  that	
  badge	
  one	
  second	
  to	
  make	
  sure	
  I’ve	
  got	
  your	
  name	
  right?”	
Clipwned	
  Supplies	
Amazon	
  is	
  full	
  of	
  “Storage	
  Clipboards”	
Step	
  1	
  is	
  ﬁnding	
  one	
  with	
  the	
  depth	
  needed	
  (3/4”	
  minimum,	
  1”	
  is	
  great)	
• Check	
  dimensions	
  of	
  tools	
  going	
  into	
  clipwned	
3D	
  printed	
  parts	
  provide	
  guides	
  to	
  keep	
  components	
  in	
  place	
• Tape,	
  wood,	
  and	
  other	
  materials	
  work	
  as	
  well	
Making	
  Clipwned	
  2.0	
• Proxmark	
  client	
  compiles	
  easily	
  on	
  many	
  platforms	
• libNFC	
  supports	
  major	
  distros	
• The	
  RFIDler	
  USB	
  serial	
  is	
  almost	
  universally	
  supported	
Attach	
  battery	
  to	
  embedded	
  computer	
  for	
  power	
Connect	
  embedded	
  computer	
  to	
  RFID	
  tool	
  of	
  choice	
  via	
  USB	
Cover	
  stash	
  with	
  legitimate	
  forms	
  or	
  blank	
  pages	
Make	
  clipwned	
  look	
  like	
  something	
  a	
  pro	
  uses	
  (notes,	
  pens,	
  etc.)	
Making	
  Fake	
  Readers	
  Building	
  Information	
  Modeling	
  Models	
  available	
  for	
  common	
  building	
  components	
  This	
  includes	
  access	
  control	
  readers	
  Models	
  are	
  suited	
  for	
  modiﬁcation	
  and	
  printing	
Fake	
  Readers	
•  Models	
  via	
  BIM	
  make	
  3D	
  printed	
  readers	
  possible	
•  Add	
  an	
  antenna	
  inside	
  for	
  a	
  hostile	
  reader	
•  Place	
  it	
  over	
  an	
  existing	
  reader	
  and	
  relay/record	
  badge	
  scans	
  for	
  a	
  day	
•  Install	
  rogue	
  readers	
  in	
  unexpected	
  places	
  and	
  see	
  who	
  scans	
•  “Badge	
  for	
  the	
  elevator?	
  Cool	
  upgrade!!!”	
Phone	
  Case	
  Snooper	
  Phone	
  based	
  NFC	
  payment	
  is	
  being	
  hailed	
  for	
  security	
  What	
  is	
  possible	
  by	
  having	
  a	
  coil	
  hidden	
  in	
  a	
  case?	
  Snooping	
  on	
  transactions	
  for	
  research?	
  Stealthy	
  relay	
  attacks?	
  Android	
  Beam/NDEF	
  attacks?	
  Phone	
  case	
  models	
  readily	
  available	
  on	
  web	
  Cube	
  even	
  includes	
  an	
  iPhone	
  case	
  as	
  a	
  test	
  ﬁle	
SD	
  Storage	
• Log	
  stolen	
  IDs	
Networking	
• Remote	
control	
Automation	
• Scriptable	
responses	
Low-­‐proﬁle	
• Small	
footprint	
More	
  Embedded	
  Help	
Pairing	
  the	
  RFIDler	
  with	
  a	
  Raspberry	
  Pi	
  enables	
  stealth	
  &	
  advanced	
  attacks.	
Thanks!	
Much	
  more	
  info	
  will	
  is	
  included	
  in	
  the	
  whitepaper.	
Please	
  direct	
  questions	
  to:	
Craig	
  Young	
Security	
  Researcher,	
  Tripwire	
  VERT	
@CraigTweets	
  ||	
  PI:EMAIL	
Special	
  thanks	
  to:	
•  Marshmellow42,	
  Iceman,	
  &	
  the	
  rest	
  of	
  the	
  PM3	
  collaborators	
•  To	
  my	
  family	
  for	
  putting	
  up	
  with	
  all	
  the	
  crazy	
  hours	
  leading	
  up	
  to	
  DC23!