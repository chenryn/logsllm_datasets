User: Given an Apache Kafka topic, please guide how to set up consumer groups, and explain how to consume messages.
Assistant: When setting up a consumer group, it can be specified in the configuration of the consumer client. The purpose of the consumer group is to group consumers, and each group can only have one consumer subscribed to the messages of each partition of a topic to avoid repeated consumption of messages and ensure load balancing. Only in the consumer group, the consumer coordinator can be used for dynamic allocation and reallocation of consumers. To consume messages, you must first create a Kafka consumer object, use the consumer object to specify the topic to consume and the ID of the consumer group. Then specify the ID of the consumer group in the consumer configuration to assign the consumer group to the consumer. After consumers subscribe to topics and partitions, they can use the poll() method to obtain messages from the Kafka cluster, and consumers will obtain messages from the specified partitions. After processing the message, use the commitSync() method to submit the offset to the Kafka cluster. In a consumer group, the same partition is equally assigned to consumers by the coordinator to ensure load balancing and high availability. A consumer may be assigned multiple partitions, or have multiple consumers subscribed to the same partition. Each consumer is independent and can consume messages in any way, but they must specify the same consumer group ID in order for the coordinator to rebalance the consumers in the consumer group.