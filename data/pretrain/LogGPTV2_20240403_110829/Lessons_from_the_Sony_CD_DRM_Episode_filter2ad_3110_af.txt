sion to get access to her protected CDs.
This approach would convince some users to update,
and would thereby prolong the DRM’s efﬁcacy for those
users. But it has several drawbacks. If the computer is
not networked, the software will eventually lock down
because it cannot get certiﬁcates. (If the software kept
working in this case, users could avoid updates by pre-
venting the DRM software from making network connec-
tions.) A bug in the software could cause an accidental
but irreversible lockdown. Or the software could lock it-
self down if the vendor’s Internet site is shut down, for
example if the vendor goes bankrupt.
Strong-arm tactics can also be counterproductive, by
giving the user further reason to defeat or remove the
DRM software.11 The software is more likely to remain
on the user’s system if it does not behave annoyingly.
Trying to force updates can reduce the DRM system’s ef-
ﬁcacy if it convinces users to remove the DRM altogether.
From the user’s standpoint, every software update is a se-
curity risk—a possible vector for hostile or buggy code.
Given the problems with forced updates, and the user
backlash they likely would have triggered, we are not sur-
prised that neither XCP nor MediaMax tried to force up-
dates.
10 User Outrage, and the Fight to Control
Users’ Computers
One notable aspect of the Sony CD DRM episode was
the level of outrage expressed by users. All too fre-
quently, bugs in popular software products endanger
users’ security or privacy, and users just grumble and
update their software. Users’ anger over the CD DRM
episode was much more intense. What made this issue
so different?
There are three answers. First, many users did not ex-
pect audio CDs to contain software. Users did not want
the software, and they recognized that Sony-BMG chose
to include it anyway. Unlike (say) an email client, which
necessarily includes complex software components that
might have bugs, CDs need not include software, so users
are less willing to accept the risk of security problems in
order to get CDs.
Second, some harmful aspects of the CD DRM soft-
ware reﬂected deliberate choices by the vendors (and by
extension, Sony-BMG). Users who might be willing to
forgive implementation errors will not accept the delib-
erate introduction of security and privacy risks. There
can be little question that XCP’s rootkit functionality, the
installation without consent of MediaMax software, the
lack of uninstallers, and phone-home behavior were put
in place deliberately by the vendors.
Third, when the vendors did make apparent implemen-
tation errors, the errors were compounded by the prod-
ucts’ aggressive installation and reluctant uninstallation
mechanisms. For example, the ﬁle permission problem
discovered by Burns and Stamos was difﬁcult to ﬁx be-
cause the MediaMax autorun program aggressively reset
the permissions to dangerous values, without asking the
user for permission, every time a disc was inserted. Sim-
ilarly, the vendors’ apparent desire to limit use of their
uninstallers led to designs that relied on downloading
code using ActiveX controls—leaving users just one bug
away from critical code-download vulnerabilities.
These factors led some users to conclude that Sony-
BMG and the DRM vendors not only put their own busi-
90
Security ’06: 15th USENIX Security Symposium
USENIX Association
ness interests ahead of their customers’ interests, but also
made deliberate choices that endangered customers’ se-
curity and privacy. Users who would have forgiven a few
implementation mistakes by a well-intentioned vendor
were not so quick to forgive when they felt the vulner-
abilities were less than accidental.
Though Sony-BMG and other copyright owners will
presumably tread more carefully in the future, there re-
mains a fundamental tension between DRM vendors’ de-
sire to control and limit how computers are used, and the
need of users to manage their own systems. Users and
DRM distributors will continue to struggle for control of
users’ computers.
11 Conclusion
Our analysis of Sony-BMG’s CD DRM carries wider
lessons for content companies, DRM vendors, policy-
makers, end users, and the security community. We draw
six main conclusions.
First, the design of DRM systems is driven strongly
by the incentives of the content distributor and the DRM
vendor, but
these incentives are not always aligned.
Where they differ, the DRM design will not necessarily
serve the interests of copyright owners, not to mention
artists.
Second, DRM, even if backed by a major content
distributor, can expose users to signiﬁcant security and
privacy risks. Incentives for aggressive platform build-
ing drive vendors toward spyware tactics that exacerbate
these risks.
Third, there can be an inverse relation between the ef-
ﬁcacy of DRM and the user’s ability to defend her com-
puter from unrelated security and privacy risks. The
user’s best defense is rooted in understanding and con-
trolling which software is installed, but many DRM sys-
tems rely on undermining this understanding and control.
Fourth, CD DRM systems are mostly ineffective at
controlling uses of content. Major increases in complex-
ity have not increased their effectiveness over that of
early schemes, and may in fact have made things worse
by creating more avenues for attack. We think it unlikely
that future CD DRM systems will do better.
Fifth, the design of DRM systems is only weakly con-
nected to the contours of copyright law. The systems
make no pretense of enforcing copyright law as written,
but instead seek to enforce rules dictated by the label’s
and vendor’s business models. These rules, and the tech-
nologies that try to enforce them, implicate other public
policy concerns, such as privacy and security.
Finally, the stakes are high. Bad DRM design choices
can seriously harm users, create major liability for copy-
right owners and DRM vendors, and ultimately reduce
artists’ incentive to create.
Acknowledgments
We are grateful for the expert legal advice of Deirdre
Mulligan and her colleagues at U.C. Berkeley: Aaron
Perzanowski, Sara Adibisedeh, Azra Medjedovic, Brian
W. Carver, Jack Lerner, and Joseph Lorenzo Hall. We
are also grateful to Clayton Marsh at Princeton. Sadly,
research of this type does seem to require support from a
team of lawyers.
We thank the readers of Freedom to Tinker for their
comments on partial drafts that we posted there; thanks
especially to C. Scott Ananian, Randall Chertkow, Tim
Howland, Edward Kuns, Jim Lyon, Tobias Robison,
Adam Shostack, Ned Ulbricht, and several pseudony-
mous commenters. Jeff Dwoskin provided valuable tech-
nical assistance, and Shirley Gaw, Janek Klawe, and Har-
lan Yu gave helpful feedback. We are also grateful to the
anonymous reviewers for their suggestions. Thanks to
Claire Felten for help with copy editing.
This material is based upon work supported under a
National Science Foundation Graduate Research Fellow-
ship. Any opinions, ﬁndings, conclusions or recommen-
dations expressed in this publication are those of the au-
thors and do not necessarily reﬂect the views of the Na-
tional Science Foundation.
Notes
1As news of the rootkit spread, we added to the public discus-
sion with a series of 27 blog posts analyzing XCP and MediaMax.
This paper provides a more systematic analysis, along with much new
information. Our original blog entries can be read at http://www.
freedom-to-tinker.com/?cat=30&m=2005.
2Music industry rhetoric about DRM often focuses on P2P, and
some in the industry probably still think that DRM can stop P2P shar-
ing. We believe that industry decision makers know otherwise. The
design of the systems we studied in this paper supports this view.
3Similar application blacklisting techniques have been used in other
security contexts. The client software for World of Warcraft, a mas-
sively multiplayer online role playing game, checks running applica-
tions against a regularly updated blacklist of programs used to cheat in
the game [12].
4An extreme extension of this would be to adopt rootkit-like tech-
niques to conceal the copying application’s presence, just as XCP hides
its active protection software.
5Forging a mark is probably not copyright infringement. Unlike the
musical work in which it is embedded, the mark itself is functional and
contains little or no expression, and therefore seems unlikely to qualify
for copyright protection.
In principle, the mark recognition process
could be covered by a patent, but we are unaware of any such patent
relating to XCP or MediaMax. Even if the vendor does have a legal
remedy, it seems worthwhile to design the mark to prevent forgery if
the cost of doing so is low.
6By locating the watermark nearly ﬁve seconds after the start of the
track rather than at the very beginning, MediaMax reduces the likeli-
hood that it will occur in a very quiet passage (where it might be more
audible) and makes cropping it out more destructive.
7This design seems to be intended to lessen the audible distortion
caused by setting one of the bits to the watermark value. The change
in the other two bits reduces the magnitude of the difference from the
USENIX Association
Security ’06: 15th USENIX Security Symposium
91
[12] Greg Hoglund. 4.5 million copies of EULA-compliant
http://www.rootkit.com/blog.
spyware, October 2005.
php?newsid=358.
[13] Greg Hoglund and James Butler. Rootkits: Subverting the
Windows Kernel. Addison-Wesley, 2005.
[14] Kazumasa Itabashi. Trojan.Welomoch technical descrip-
tion, December 2005. http://securityresponse.symantec.
com/avcenter/venc/data/trojan.welomoch.html.
[15] Yana Liu. Backdoor.Ryknos.B technical description,
November 2005. http://securityresponse.symantec.com/
avcenter/venc/data/backdoor.ryknos.b.html.
[16] MediaMax Technology Corp. Annual report (S.E.C.
Form 10-KSB/A), September 2005.
[17] Microsoft Corporation. Windows Media data session
http://download.microsoft/com/download/
toolkit.
a/1/a/a1a66a2c-f5f1-450a-979b-ddf790756f1d/
Data Session Datasheet.pdf.
[18] Matti Nikki. Muzzy’s research about Sony’s XCP
DRM system, December 2005. http://hack.ﬁ/∼muzzy/
sony-drm/.
[19] K. Reichert and G. Troitsch. Kopierschutz mit ﬁlzstift
knacken. Chip.de, May 2002.
[20] Mark Russinovich. More on Sony: Dangerous de-
cloaking patch, EULAs and phoning home, Novem-
ber 2005.
http://www.sysinternals.com/blog/2005/11/
more-on-sony-dangerous-decloaking.htm.
[21] Mark Russinovich.
and
digi-
far, October
http://www.sysinternals.com/blog/2005/10/
rootkits
too
Sony,
gone
rights management
tal
2005.
sony-rootkits-and-digital-rights.html.
[22] Sony-BMG Music Entertainment. Portable device: iPod
information. http://cp.sonybmg.com/xcp/english/form10.
html.
[23] Sony-BMG Music Entertainment. XCP frequently asked
questions. http://cp.sonybmg.com/xcp/english/faq.html.
original audio sample, but it also introduces a highly uneven distribu-
tion in the three least signiﬁcant bits that makes the watermark easier
to detect or remove.
8The restrictions imposed by the DRM players only loosely track
the contours of copyright law. Some uses that could be prohibited under
copyright—such as burning three copies to give to friends—are allowed
by the software, while some perfectly legal uses—like transferring the
music to one’s iPod—are prevented.
9This ﬁle is hidden and protected by the XCP rootkit. Before the
user can access the ﬁle, the rootkit must be disabled, as described in
Section 7.2. We did not determine how the MediaMax player stores the
number of copies remaining.
10The rootkit also hooks NtOpenKey but does not alter its behavior.
11Users could also mislead the DRM software about the date and
time, but most users with the inclination to do that would probably just
remove the DRM software altogether.
References
[1] Class action complaint.
In Hull et al. v. Sony BMG et
al., 2005. http://www.eff.org/IP/DRM/Sony-BMG/sony
complaint.pdf.
[2] Consolidated amended class action complaint.
Michaelson et al. v. Sony BMG et al., 2005.
sonysuit.com/classactions/michaelson/15.pdf.
In
http://
[3] Original plantiff’s petition. In State of Texas v. Sony BMG
Music Entertainment, 2005. http://www.oag.state.tx.us/
newspubs/releases/2005/112105sony pop.pdf.
[4] Peter Biddle, Paul England, Marcus Peinado, and Bryan
Willman. The Darknet and the future of content distribu-
tion. In ACM Workshop on Digital Rights Management,
November 2002.
[5] Jesse Burns and Alex Stamos. Media Max access con-
trol vulnerability, November 2005. http://www.eff.org/IP/
DRM/Sony-BMG/MediaMaxVulnerabilityReport.pdf.
[6] Ingemar Cox, Joe Kilian, Tom Leighton, and Talal
Secure spread spectrum watermarking for
IEEE Transactions on Image Processing,
Shamoon.
multimedia.
6(12):1673–1687, 1997.
[7] Scott A. Craver, Min Wu, Bede Liu, Adam Stubbleﬁeld,
Ben Swartzlander, Dan S. Wallach, Drew Dean, and Ed-
ward W. Felten. Reading between the lines: Lessons from
the SDMI challenge. In Proc. 10th USENIX Security Sym-
posium, August 2001.
[8] Edward W. Felten and J. Alex Halderman. Digital rights
management, spyware, and security. IEEE Security and
Privacy, January/February 2006.
[9] Allan Friedman, Roshan Baliga, Deb Dasgupta, and Anna
Dreyer. Understanding the broadcast ﬂag: a threat anal-
ysis model.
In Telecommunications Policy, volume 28,
pages 503–521, 2004.
[10] J. Alex Halderman. Evaluating new copy-prevention tech-
niques for audio CDs. In Proc. ACM Workshop on Digital
Rights Management (DRM), Washington, D.C., Novem-
ber 2002.
[11] J. Alex Halderman. Analysis of the MediaMax CD3 copy-
prevention system. Technical Report TR-679-03, Prince-
ton University Computer Science Department, Princeton,
New Jersey, 2003.
92
Security ’06: 15th USENIX Security Symposium
USENIX Association