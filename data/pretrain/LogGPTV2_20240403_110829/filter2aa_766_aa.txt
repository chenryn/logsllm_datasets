Sniper Forensics 
“One Shot, One Kill”
Christopher E. Pogue - Trustwave
Copyright Trustwave 2009
Confidential
Thank You Dan Christensen!
http://dcdrawings.blogspot.com/
Copyright Trustwave 2009
Confidential
Who Am I?
• 
Senior Security Consultant for the Trustwave SpiderLabs
• 
Master’s degree in Information Security
• 
Author of “Unix and Linux Forensic Analysis” by Syngress
• 
Author of the blog, “The Digital Standard”
• 
Board of Governors for the HTCIA
• 
Member of the USSS Miami Electronic Crimes Task Force
• 
Speaker @ SANS “What Works in Incident Response” ‘09 and ‘10, The 
Computer Forensics Show ‘09 and ‘10, Direct Response Forum, SecTor 
‘09 and ‘10, USSS ECTF - Miami Conference, The Next HOPE, 
BSIDESLV, and most recently, DEF CON 18.
• 
Former US Army Signal Corps Warrant Officer
• 
Former CERT team member – SEI at CMU
Copyright Trustwave 2009
Confidential
Agenda
• What is Shotgun Forensics?
• What is Sniper Forensics?
• Guiding Principles
• Create an Investigation Plan
• Data Reduction
• Volatile Data Gathering and Analysis
• Data Correlation
• Tools
• Case Studies
• Bring it All Together
• Conclusion
Copyright Trustwave 2009
Confidential
Shotgun Forensics
The process of taking a haphazard, unguided approach to
forensic investigations:
• “Old school”
• Image everything
• Reliance on tools –
autopilot
• Pull the plug
Copyright Trustwave 2009
Confidential
Sniper Forensics
The process of taking a targeted, deliberate approach to
forensic investigations:
• Create an investigation plan
• Apply sound logic
−
Locard
−
Occam
−
Alexiou
• Extract what needs to be extracted, nothing more
• Allow the data to provide the answers
• Report on what was done
• Answer the questions
Copyright Trustwave 2009
Confidential
Three Round Shot Group
Infiltration
• How did the bad guy(s) get onto the system(s)
Aggregation
• What did they do
−
What did they steal
Exfiltration
• How did they get off the system
−
How did they get stolen data off the system
* This is commonly referred to as the “Breach Triad”
–
term credited 
to Colin Sheppard, Incident Response Director, SpiderLabs.
Copyright Trustwave 2009
Confidential
What Others are Saying
Q: How important do you think it is to have a clear plan of 
attack for a forensic investigation? 
A: “I'd suggest that its paramount...whether you develop the plan 
from scratch or start with documented processes. If you have a 
plan and miss something, you can determine what you missed; 
without a plan, you can't do that.”
Harlan Carvey, VP of Advanced Security Projects, Terremark/Author
“Having an investigative plan is critical. Such a plan should describe 
what you're looking for, how you'll know when you've found it, and 
when to stop.  Without it, an investigation can become mired or 
unfocused.”
Jesse Kornblum, Senior Forensic Scientist, Mantech
Copyright Trustwave 2009
Confidential
What Others are Saying (cont.)
“You cannot just cross your fingers and magically hope you will 
find the evil you are looking for. You have to know what you are 
looking for. Finding evil requires you to know what you need to 
prove and then use a combination of scientific analysis and proven 
techniques to find it.”
Rob Lee, Principle Consultant, Mandiant/SANS
“Having a clear plan of attack for a forensic investigation is 
absolutely paramount. This is especially true when operating in 
environments when a forensic team may not be necessarily 
welcome. A clear plan of attack allows the investigator to conduct 
their investigation in a efficient and deliberate manner.”
Auston Davis, Senior Manager, Global Cyber-Threat Response, Symantec/OSI Officer, USAF
Copyright Trustwave 2009
Confidential
Guiding Principles
• Locard’s Exchange Principle
• Occam’s Razor
• The Alexiou Principle
Copyright Trustwave 2009
Confidential
Locard’s Exchange Principle
• Established by Edmund Locard (1877-1966)
• Regarded as the father of modern forensics
• Uses deductive reasoning
–
All good forensic investigators are bald
–
Harlan Carvey is bald
–
(Therefore) Harlan Carvey is a good forensic investigator.
Edmund Locard
Copyright Trustwave 2009
Confidential
Occam’s Razor
• Establish by William of Occam
–
13th
century Franciscan Friar
–
Major contributor to medieval thought
–
Student of Aristotelian logic
• The simplest answer is usually right
–
The modern KISS principle
• “Keep It Simple Stupid”
–
Don’t speculate
–
Let the data be the data
William of Occam
Copyright Trustwave 2009
Confidential
The Alexiou Principle
Documented by Mike Alexiou, VP, Engagement Services 
Terremark 
−
What question are you trying to answer?
−
What data do you need to answer that question?
−
How do you extract/analyze that data?
−
What does the data tell you?
Copyright Trustwave 2009
Confidential
Create an Investigation Plan
What are your goals?
• Write them down
−
Clear, concise, obtainable
• If they are not CLEAR and CONCISE, you need to make them that 
way
• Success indicators
−
What will it look like when you find what you are looking for
−
Don’t blow this off, REALLY think about this
• Make sure you are on the same page with the client
−
Define and deliver
−
Give them what you told them you were going to give them
Plan the work and work the plan
• Answer the questions you ask yourself
• Show your work
• If an answer cannot be found, provide the negative evidence
Copyright Trustwave 2009
Confidential
Create an Investigation Plan
This is THE MOST important phase of the investigation process.
(If you blow this, the entire case will be in jeopardy…Seriously)
• You CANNOT be asked to “find the bad guy stuff”
and walk away!  
There is no way to qualify or quantify that kind of statement!
Identify the target
Lock on
Engage
Copyright Trustwave 2009
Confidential
Data Reduction
• Determine what is “normal”
• Eliminate “normal” from your view
• What’s left over is abnormal
• Provides good ole fashioned “leads”
• Document what you did, why you did it, and the results
• Answer the new questions
Copyright Trustwave 2009
Confidential
Volatile Data Gathering
Critical to the investigation
• Likely your only chance to review the live system
−
Attackers may still be present
−
Malware is running in its original state
−
THIS is the crime scene
• Gather as much as you can
−
Use “trusted”
tools
−
No such thing a “court approved”
−
Know your footprint, and be able to account for it
• Review during image acquisition
−
Major developments in minutes
−
Customer is good source of intel
−
Feeds back into the investigation plan
Copyright Trustwave 2009
Confidential
Volatile Data Analysis
What is the suspect system “supposed” to be doing
• Primary function of system
• Define what “normal”
looks like
• Use the customer’s knowledge of their own system
What does it look like it’s doing
• Running Processes
−
What is running
−
From where
−
Why
• Network connections
−
What connections are being made
−
To where
−