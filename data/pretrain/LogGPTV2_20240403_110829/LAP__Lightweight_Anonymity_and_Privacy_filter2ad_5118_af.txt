measure latency using the actual Tor network. Speciﬁcally,
we measure the latency with and without Tor between
10 geographically distributed machines and the top 200
university websites reported by Alexa8, and also resolve the
URLs of these sites in advance to exclude DNS lookup
time. We use university sites as they are less likely to
redirect trafﬁc based on source addresses (in contrast to
popular commercial sites). As Figure 8(b) shows, LAP
users experience signiﬁcantly lower latency compared to Tor
users: 90% of LAP requests ﬁnish in less than one second,
while most (> 99%) of Tor requests take more than one
second.
B. Throughput Evaluation
We evaluate LAP’s impact on throughput using Netperf
2.5.09 with synthetic trafﬁc of different packet sizes. Fig-
ure 8(c) shows the average throughput of LAP-disabled and
LAP-enabled systems. We observe that the throughput grows
with packet size for both cases. In particular, the throughput
for the LAP-enabled case is slightly lower than the one for
LAP-disabled, since it takes more time for LAP to process a
packet than to simply forward it. However, the difference in
these throughput is very small or even negligible, especially
when the packet size is beyond 1 KByte. This result conﬁrms
that LAP has a small impact on router performance.
We also compare the throughput between LAP and Tor
using a small testbed that runs LAP as well as a private Tor
8http://www.alexa.com/topsites/
9http://www.netperf.org/netperf/
network with three Tor relays. For this evaluation, we set
four machines in the testbed to be connected among each
other using 1-Gbps links, each machine dedicated to be a
source, a destination (ﬁle server), an intermediate machine
running three Tor relays, and a Tor directory server. With
this testbed, we measure the average throughput of a client
machine that is downloading a 10-GB ﬁle from the ﬁle server
for LAP and Tor. When downloading a 10-GB ﬁle using the
Tor network, the client’s average throughput is μ = 50.79
Mbit/s (σ = 1.41). With LAP, μ = 939.50 Mbit/s (σ =
32.76), showing a signiﬁcant throughput increase.
To summarize, the overhead that LAP imposes is minor,
which makes LAP suitable for practical deployment. In
particular, at the cost of a small throughput decrease, LAP
can improve the anonymity in current IP networks.
IX. RELATED WORK
The most closely related schemes for anonymity pro-
tection, namely Tor Instead of IP [14] and AHP [7], are
described and compared in the security analysis section
(Section VII).
High-stretch anonymity systems.
In Chaum’s mix net-
work [8], layer-encrypted messages are sent through a list
of mixes, each of which can buffer, reorder, decrypt/encrypt
these messages to defend against a global eavesdropper.
However, delaying and reordering renders it impractical for
real-time communication.
Onion routing systems, such as Tor [1], enable low-
latency, bi-directional anonymous communication by send-
ing layer-encrypted packets through indirect and unpre-
dictable cryptographic circuits [37]. Unlike mix networks,
onion routing systems are designed to defend against a local
attacker (or a government-class attacker, as referred to in this
paper) that observes only a fraction of the network. Under
some realistic attacker scenarios, onion routing systems
are shown to be more secure than mix networks [38].
Tarzan [39] explores onion routing in a peer-to-peer setting,
and ANDaNA [40] adopts Tor in content-centric network-
ing. However, onion routing systems still suffer from high
latency due to high path stretch. To reduce Tor’s latency,
518
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:49:13 UTC from IEEE Xplore.  Restrictions apply. 
new relay selection algorithms are suggested considering
relay geolocations or link characteristics in addition to relay
bandwidth [4], [41]. However, further studies are required
to understand their impact on existing attacks against Tor.
Researchers have also explored solutions without layered
encryption. For example, Information slicing [42] achieves
source and destination anonymity through multi-path and
secret sharing. However, Information slicing operates on
overlays and suffers from noticeable latency. Crowds [43]
leverages a crowd of users to collaboratively remove the
trace of the real requester, and Hordes [44] exploit the inher-
ent crowds within muticast groups for receiver anonymity.
However, both Crowds and Hordes signiﬁcantly stretch end-
to-end paths.
Low-stretch anonymity systems. Using a single anony-
mous proxy such as anonymizer.com [45] results in low
path stretch. However, users have to trust a remote proxy
in burying the linkage between a sender and a receiver, and
the proxy could easily become a single point of failure.
Censorship-resilient systems such as Decoy routing [46],
Telex [47], and Cirripede [48] rely on ISPs to redirect trafﬁc
to blocked destinations. Although they also require enlisting
ISPs for protection as LAP does, they place trust on remote
ISPs to help defend against a much stronger adversary
monitoring local networks.
Attacks on anonymity systems.
Several researchers have
studied how to passively and actively attack anonymity
systems. For passive attacks, the adversary attempts to de-
anonymize trafﬁc by observing side-channel
information
such as packet timing [49], clock skew [35], and unique
system state [50], [51]. However, such passive attacks often
fail to scale or rely on information leaked from higher layer
protocols. On the other hand, active attacks can accelerate
trafﬁc correlation. DoS is one type of active attacks that can
be used for additional attack opportunities [32]. For example,
by clogging the network and monitoring the latency change,
the attacker can identify Tor entry nodes [20], [21] and locate
Tor users [22]. Although our main objective is to camou-
ﬂage one’s topological location to enhance anonymity and
privacy, LAP can mitigate DoS-based attacks by selectively
publishing encrypted paths.
Low-latency anonymity systems are shown to be inher-
ently vulnerable to timing and trafﬁc analysis [22], [23],
[52], because an adversary can easily correlate the trafﬁc
patterns of a sender and a receiver. Since our goal in this
paper is to provide topological anonymity, we consider such
temporal side-channel attacks as future work.
X. CONCLUSIONS
Current anonymous communication systems achieve a
high level of anonymity against a strong attacker model, but
pay a dear price in terms of overhead: high communication
latency with high in-network computation and storage state.
Especially the high latency causes the Internet browsing
experience to endure a signiﬁcant slowdown.
Anonymous communication would thus be more usable
with reduced overhead. Indeed, we believe that many users
can live with a relaxed attacker model, as they can trust their
local ISPs but want protection from tracking by ISPs that
are further away (potentially in other countries with different
privacy laws) and from tracking by websites. Given such a
weaker attacker model, we attempt to provide source and
destination anonymous communication, session unlinkabil-
ity, and location privacy at a very low overhead, barely more
than non-anonymous communication.
In this framework, our approach is simple yet effective: by
leveraging encrypted packet-carried forwarding state, ISPs
that support our protocol can efﬁciently forward packets to-
wards the destination, where each encrypted ISP-hop further
camouﬂages the source or destination address or its location.
Although encrypted packet-carried forwarding state is cur-
rently not supported in IP, we design simple extensions to IP
that could enable this technology. In particular, our approach
is even more relevant in future network architectures, where
the design can be readily incorporated.
This new point in the design space of anonymity protocols
could also be used in concert with other techniques, for
example in conjunction with Tor to prevent one Tor node
from learning its successor. Despite weaker security proper-
ties than Tor, we suspect that LAP contributes a signiﬁcant
beneﬁt towards providing topological anonymity, as LAP is
practical to use for all communication.
ACKNOWLEDGEMENTS
We gratefully thank Soo Bum Lee and Sangjae Yoo for
their help with Tor experiments, Nicholas Hopper and Paul
Syverson for bringing related work to our attention and
providing insightful feedback, and the anonymous reviewers
for their valuable comments.
This research was supported by CyLab at Carnegie Mellon
under grants DAAD19-02-1-0389 and W911NF-09-1-0273,
from the Army Research Ofﬁce, and by support from NSF
under the TRUST STC award CCF-0424422, CNS-1040801,
CNS-1040735, and CNS-0845896. The views and conclu-
sions contained here are those of the authors and should not
be interpreted as necessarily representing the ofﬁcial policies
or endorsements, either express or implied, of ARO, CMU,
NSF or the U.S. Government or any of its agencies.
REFERENCES
[1] R. Dingledine, N. Mathewson, and P. Syverson, “Tor: the second-
generation onion router,” in Proceedings of conference on USENIX
Security Symposium, 2004.
[2] J. A. Muir and P. C. V. Oorschot, “Internet geolocation: Evasion and
counterevasion,” ACM Comput. Surv., vol. 42, pp. 4:1–4:23, December
2009.
[3] R. Dingledine and S. J. Murdoch, “Performance improvements on
Tor — or, why Tor is slow and what we’re going to do about it,”
2009. [Online]. Available: https://www.torproject.org/press/presskit/
2009-03-11-performance.pdf
519
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:49:13 UTC from IEEE Xplore.  Restrictions apply. 
[31] H. Burch and B. Cheswick, “Tracing anonymous packets to their
approximate source,” in Proceedings of LISA, Dec. 2000.
[32] N. Borisov, G. Danezis, P. Mittal, and P. Tabriz, “Denial of service
or denial of security?” in Proceedings of ACM CCS, 2007.
[33] A. Houmansadr and N. Borisov, “Swirl: A scalable watermark to
detect correlated network ﬂows,” in NDSS, 2011.
[34] P. Mittal, A. Khurshid, J. Juen, M. Caesar, and N. Borisov, “Stealthy
low-latency anonymous communication using
trafﬁc analysis of
throughput ﬁngerprinting,” in Proceedings of ACM CCS, 2011.
[35] T. Kohno, A. Broido, and K. C. Claffy, “Remote physical device
ﬁngerprinting,” IEEE Trans. Dependable Secur. Comput., vol. 2, pp.
93–108, April 2005.
[36] “The click modular
router project.” [Online]. Available: http:
//read.cs.ucla.edu/click/
[37] P. Syverson, “A peel of onion,” in ACSAC, 2011.
[38] ——, “Sleeping dogs lie in a bed of onions but wake when mixed,”
in HotPETs, 2011.
[39] M. J. Freedman and R. Morris, “Tarzan: a peer-to-peer anonymizing
network layer,” in Proceedings of ACM CCS, 2002.
[40] S. DiBenedetto, P. Gasti, G. Tsudik, and E. Uzun, “ANDaNA:
Anonymous named data networking application,” in Proceedings of
NDSS, 2012.
[41] M. Sherr, M. Blaze, and B. T. Loo, “Scalable link-based relay
selection for anonymous routing,” in Proceedings of PETS, 2009.
[42] S. Katti, J. Cohen, and D. Katabi, “Information slicing: anonymity
using unreliable overlays,” in Proceedings of NSDI, 2007.
[43] M. K. Reiter and A. D. Rubin, “Crowds: anonymity for web transac-
tions,” ACM Trans. Inf. Syst. Secur., vol. 1, November 1998.
[44] C. Shields and B. N. Levine, “A protocol for anonymous communi-
cation over the internet,” in Proceedings of ACM CCS, 2000.
[45] “Anonymizer.” [Online]. Available: http://www.anonymizer.com/
[46] J. Karlin, D. Ellard, A. W. Jackson, C. E. Jones, G. Lauer, D. P.
Mankins, and W. T. Strayer, “Decoy routing: Toward unblockable
internet communication,” in Proceedings of FOCI, 2011.
[47] E. Wustrow, S. Wolchok, I. Goldberg, and J. A. Halderman, “Telex:
Anticensorship in the network infrastructure,” in Proceedings of
USENIX security, 2011.
[48] A. Houmansadr, G. T. Nguyen, M. Caesar, and N. Borisov, “Cirripede:
circumvention infrastructure using router redirection with plausible
deniability,” in Proceedings of CCS, 2011.
[49] B. N. Levine, M. K. Reiter, C. Wang, and M. K. Wright, “Timing
attacks in low-latency mix-based systems,” in Proceedings of FC,
2004.
[50] P. Eckersley, “How unique is your web browser?” in Proceedings of
PETS, 2010.
[51] T.-F. Yen, Y. Xie, F. Yu, R. P. Yu, and M. Abadi, “Host Fingerprinting
and Tracking on the Web: Privacy and Security Implications,” in
Proceedings of NDSS, 2012.
[52] S. J. Murdoch, “Hot or not: Revealing hidden services by their clock
skew,” in Proceedings of ACM CCS, 2006.
[4] A. Panchenko, L. Pimenidis, and J. Renner, “Performance analysis of
anonymous communication channels provided by Tor,” in Proceedings
of Availability, Reliability and Security, 2008.
[5] P. G. Leon, B. Ur, R. Balebako, L. F. Cranor, R. Shay, and Y. Wang,
“Why johnny cant opt out: A usability evaluation of tools to limit
online behavioral advertising,” in Proceedings of CHI, 2012.
[6] R. Kohavi and R. Longbotham, “Online experiments: Lessons
learned,” Computer, vol. 40, pp. 103–105, 2007.
[7] B. Raghavan, T. Kohno, A. C. Snoeren, and D. Wetherall, “Enlisting
ISPs to improve online privacy: IP address mixing by default,” in
Proceedings of PETS, 2009.
[8] D. L. Chaum, “Untraceable electronic mail, return addresses, and
digital pseudonyms,” Commun. ACM, vol. 24, pp. 84–90, February
1981.
[9] X. Zhang, H.-C. Hsiao, G. Hasker, H. Chan, A. Perrig, and D. G. An-
dersen, “SCION: Scalability, control, and isolation on next-generation
networks,” in Proceedings of IEEE Symposium on Security and
Privacy, 2011.
[10] “MobilityFirst
architecture
[Online].
project.”
future
internet
Available: http://mobilityﬁrst.winlab.rutgers.edu/
[11] J. Naous, M. Walﬁsh, A. Nicolosi, D. Mazires, M. Miller, and
A. Seehra, “Verifying and enforcing network paths with icing,” in
Proceedings of ACM CoNEXT, 2011.
[12] A.
“’like’
button
Efrati,
2011.
users,”
follows
http://online.wsj.com/article/
web
May
SB10001424052748704281504576329441432995616.html
[Online]. Available:
[13] “British telecom phorm pagesense external validation report,” 2008.
[Online]. Available: http://www.wikileaks.org/wiki/British Telecom
Phorm Page Sense External Validation report
[14] V. Liu, S. Han, A. Krishnamurthy, and T. Anderson, “Tor instead of
IP,” in Proceedings of ACM Hotnets, 2011.
[15] A. Pﬁtzmann and M. K¨ohntopp, “Anonymity, unobservability, and
pseudeonymity — a proposal for terminology,” in Proceedings of
PETS, 2001.
[16] O. Berthold, A. Pﬁtzmann, and R. Standtke, “The disadvantages of
free mix routes and how to overcome them,” in Proceedings of PETS,
2001.
[17] P. Syverson, “Why I’m not an entropist,” in International Workshop
on Security Protocols. Springer-Verlag, LNCS, 2009, forthcoming.
[18] J. Krumm, “A survey of computational location privacy,” Personal
Ubiquitous Comput., vol. 13, pp. 391–399, August 2009.
[19] S. Burnett, N. Feamster, and S. Vempala, “Chipping away at censor-
ship ﬁrewalls with user-generated content,” in Proceedings of USENIX
Security, 2010.
[20] S. J. Murdoch and G. Danezis, “Low-cost trafﬁc analysis of Tor,” in
Proceedings of IEEE Symposium on Security and Privacy, 2005.
[21] N. S. Evans, R. Dingledine, and C. Grothoff, “A practical congestion
attack on Tor using long paths,” in Proceedings of USENIX security,
2009.
[22] N. Hopper, E. Y. Vasserman, and E. Chan-Tin, “How much anonymity
does network latency leak?” in Proceedings of ACM CCS, 2007.
[23] S. Chakravarty, A. Stavrou, and A. Keromytis, “Trafﬁc analysis
against low-latency anonymity networks using available bandwidth
estimation,” in Proceedings of ESORICS, 2010.
[24] M. TechNet, “DHCP best practices.” [Online]. Available: http:
//technet.microsoft.com/en-us/library/cc780311(WS.10).aspx
[25] Z. Wang, Z. Qian, Q. Xu, Z. M. Mao, and M. Zhang, “An untold
story of middleboxes in cellular networks,” in Proceedings of ACM
SIGCOMM, 2011.
[26] “The RouteViews
[Online]. Available:
http://www.
project.”
routeviews.org
[27] L. R. Group, “Nearly 1.3 million add broadband in the ﬁrst quarter of
2011.” [Online]. Available: http://www.leichtmanresearch.com/press/
051711release.pdf
[28] “Tor metrics portal: Users.” [Online]. Available: https://metrics.
torproject.org/users.html
[29] “Internet
world
stats.”
[Online].
Available:
http://www.
internetworldstats.com/
[30] J. Trostle, B. Way, H. Matsuoka, M. Tariq, J. Kempf, K. T., and
R. Jain, “Cryptographically protected prexes for location privacy in
IPv6,” in Proceedings of PETS, 2004.
520
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:49:13 UTC from IEEE Xplore.  Restrictions apply.