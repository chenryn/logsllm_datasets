title:Flexible multicast authentication for time-triggered embedded control
network applications
author:Christopher Szilagyi and
Philip Koopman
978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
165
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:37:05 UTC from IEEE Xplore.  Restrictions apply. 
  Flexible Multicast Authentication for Time-Triggered Embedded Control Network Applications  Christopher Szilagyi ECE Department Carnegie Mellon University PI:EMAIL  Philip Koopman ECE Department Carnegie Mellon University PI:EMAIL Abstract  Security for wired embedded networks is becoming a greater concern as connectivity to the outside world increases. Protocols used in these networks omit sup-port for authenticating messages to prevent masquer-ade and replay attacks. The unique constraints of em-bedded control systems make incorporating existing multicast authentication schemes impractical. Our approach provides multicast authentication for time-triggered applications by validating truncated message authentication codes (MACs) across multiple packets. We extend this approach to tolerate occasional invalid MACs, analyze our approach through simulated at-tacks, and give an upper bound on the probability of successful attack. This approach allows a tradeoff among per-packet authentication cost, application level latency, tolerance to invalid MACs, and probabil-ity of induced failure, while satisfying typical embed-ded system constraints.  1. Introduction Distributed embedded systems employing wired net-works have numerous potential vulnerabilities. Anyone with physical access to the system, including the owner, can perform an attack to manipulate message traffic on the internal network. Increasing connectivity to external networks, such as the Internet or wireless networks, can also make wired embedded networks susceptible to attacks originating from those external networks, making security a more significant consid-eration in embedded control system design [14].   If an attacker can gain control over one of the nodes connected to a system, either through physical tamper-ing or remotely subverting a gateway node, they gain access to the potentially safety-critical internal bus traffic of these systems. An attacker can eavesdrop on traffic, inject and modify messages, and can even per-form DoS attacks [29]. By accessing this internal traf-fic, the attacker might, for example, engage the emer-gency brake in a car while it is traveling on a highway, unlock doors and start the engine, or shut off head-lights while traveling at night.  Embedded control networks commonly use proto-cols such as Controller Area Network (CAN) [3], FlexRay [1], and Time-Triggered Protocol (TTP) [16]. Applications include distributed automotive, aviation, robotics, and industrial control systems. Safety, reli-ability, and cost have traditionally been the primary concerns in these systems, with security a minor con-cern. Most embedded control networks do not have any built in security to support authenticating nodes, en-crypting data, restricting message types a node can send, or preventing Denial of Service (DoS) attacks.   In this paper, we expand upon our approach for au-thentication in time-triggered applications [28] which prevents both masquerade and replay attacks. Mas-querade attacks [27] occur when a node sends a mes-sage in which it claims to be a node other than itself. This attack can be performed by broadcasting during another node's Time Division Multiple Access (TDMA) slot or by changing a message identifier value. Replay attacks [27] occur when a previously sent message is recorded and retransmitted by an at-tacker. Authentication allows a receiver to confirm the identity of a sender, typically via cryptographic mechanisms such as a Message Authentication Code (MAC) or a Digital Signature [27]. While wired em-bedded network protocols use error detection codes to verify message integrity, these codes can readily be forged, and are no substitute for strong cryptographic mechanisms.  Our previous work [28] provides multicast authenti-cation in a single-hop wired embedded network, using truncated MACs. Truncating MACs allows the sender to place one small authenticator field per receiver in each message to allow authentication on a per-packet basis and provide tolerance to lost messages. It takes advantage of the time-triggered nature of many em-bedded control systems to authenticate a series of packets with consistent message values to gain confi-dence in both state-changing and reactive control mes-sages. In this paper, we extend our approach to tolerate occasional invalid MACs (malicious and non-malicious) which could disrupt authentication of state-978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
166
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:37:05 UTC from IEEE Xplore.  Restrictions apply. 
  changing messages. We also investigate cases where forging nonconsecutive reactive control messages within a period of time might lead to a successful at-tack. Finally, we provide analysis and experimental verification of the probability of maliciously induced failures for our approach.   In this paper Section 2 describes common wired embedded network constraints. Section 3 discusses multicast authentication using one MAC per receiver. Section 4 reviews related work. Section 5 describes our approach for authentication and Section 6 contains our analysis of the approach. Finally, Section 7 presents our conclusions. 2. Embedded network constraints  Distributed embedded networks are composed of a number of hardware Electronic Control Units (ECUs). These ECUs communicate via a network using a pro-tocol such as CAN, FlexRay, or TTP to accomplish time-triggered communications. These protocols are among the most capable of those currently in use in wired embedded system networks. Many other proto-cols are even more resource constrained, but have gen-erally similar requirements. We assume that embedded networks exhibit the following characteristics:  Time-triggered - In this paper, we consider only time-triggered applications. [15] defines a real-time system as time-triggered if all communications and processing activities are initiated at predetermined points in time from an a priori designated clock tick. Each node periodically broadcasts current values of state variables and sensor inputs to the rest of the net-work at designated times.  Multicast communications - Most distributed em-bedded networks are inherently multicast. All  nodes connected to the network receive every packet. (In CAN, hardware performs message filtering at the re-ceiver based on content.) Each packet includes the sender's identity, often implicitly through a message identifier (CAN; FlexRay) or time slot (TTP), but usu-ally no explicit destination information. The configura-tion of the network is usually fixed at design time, with little or no run-time reconfiguration. Usually only a few nodes are attached to any network (commonly 32 or fewer).  Resource limited nodes - Processing and storage capabilities of nodes are often limited due to cost con-siderations. For example, the S12XD series, produced by Freescale [2], is a family of 16-bit microcontrollers designed for use in general automotive body applica-tions. These microcontrollers provide up to 32 kilo-bytes of RAM, 512 kilobytes of flash memory, and four kilobytes of EEPROM, with a core operating fre-quency of 80 MHz. Flash memory is generally not written except for software updates, so EEPROM holds non-volatile application data. Buffering and storage for authentication consume space in RAM, which is far more expensive and scarce than flash memory in such systems. Authentication mechanisms which require large amounts of processing power or storage in RAM may not be feasible. More powerful ECUs are imprac-tical for most nodes in the system, and many nodes are 8-bit ECUs with significantly smaller memories due to cost and power considerations.  Small packet sizes - Packet sizes are small in em-bedded network protocols when compared to those in enterprise networks. Packets have maximum data pay-load sizes as small as eight bytes in the case of CAN, with the largest payloads for FlexRay and TTP being 254 bytes and 236 bytes respectively. Cost, signal in-tegrity, and network node synchronization concerns limit data rates to 1 Mbit/sec for CAN and 10 Mbit/sec for TTP and FlexRay. Low-cost embedded networks can be orders of magnitude slower than that. Authenti-cation should incur minimal bandwidth overhead.  Tolerance to packet loss - Distributed embedded systems are subject to message blackouts from envi-ronmental disturbances such as interference from large electric motors. High quality cable shielding is often impractical due to cost, size, and weight limits. As such, authentication schemes must tolerate packet losses as part of normal system operation.  Real-time deadlines - In real-time systems, proc-esses must complete within specified deadlines. Au-thentication of nodes must occur within a known time bound, with that bound being fast enough to match the physical time constants of the system being controlled (as fast as tens of milliseconds). 3. Multicast authentication with respect to embedded constraints The multicast nature of distributed embedded commu-nications makes authentication particularly challeng-ing. Point-to-point cryptographic mechanisms, such as appending a MAC to a message using a single key shared across all nodes, do not provide adequate au-thentication. If more than two nodes share a key, any node which holds that key can masquerade as a differ-ent sender. For this reason, multicast authentication requires some form of key asymmetry, so that no node or group of colluding nodes can masquerade as another node. Sections 3.1 and 3.2 discuss the use of a single MAC per receiver and the limitations of this technique. Our approach, described in Section 5, validates trun-cated MACs over multiple messages. 3.1. One MAC per receiver While typically avoided in enterprise networks where hundreds of receivers can require kilobytes of authenti-cation data per message, using one MAC per receiver 978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
167