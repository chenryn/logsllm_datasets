4.2 
Manual 
Strategic Cyber LLC (A HelpSystems Company) 
www.cobaltstrike.com/
/
2/
Table of Contents 
Table&of&Contents&..................................................................................................................................&2/
1.&Welcome&to&Cobalt&Strike&..............................................................................................................&6/
1.1#What#is#Cobalt#Strike?#............................................................................................................................#6/
1.2#Installation#and#Updates#.......................................................................................................................#7/
System'Requirements'...................................................................................................................................................'7/
Run'the'‘update’'program'............................................................................................................................................'7/
1.3#The#Team#Server#......................................................................................................................................#8/
1.4#Cobalt#Strike#Client#.................................................................................................................................#9/
1.5#Distributed#and#Team#Operations#...................................................................................................#10/
1.6#Scripting#Cobalt#Strike#.........................................................................................................................#11/
2.&User&Interface&.................................................................................................................................&12/
2.1#Overview#...................................................................................................................................................#12/
2.2#Toolbar#......................................................................................................................................................#12/
2.3#Session#and#Target#Visualizations#...................................................................................................#13/
Targets'Table'.................................................................................................................................................................'13/
Sessions'Table'...............................................................................................................................................................'14/
Pivot'Graph'.....................................................................................................................................................................'14/
2.4#Tabs#............................................................................................................................................................#16/
2.5#Consoles#....................................................................................................................................................#16/
2.6#Tables#........................................................................................................................................................#17/
3.&Data&Management&..........................................................................................................................&19/
3.1#Overview#...................................................................................................................................................#19/
3.2#Targets#......................................................................................................................................................#19/
3.3#Services#.....................................................................................................................................................#20/
3.4#Credentials#...............................................................................................................................................#20/
3.5#Maintenance#............................................................................................................................................#20/
4.&Listener&and&Infrastructure&Management&.............................................................................&21/
4.1#Overview#...................................................................................................................................................#21/
4.2#Listener#Management#..........................................................................................................................#21/
4.3#Cobalt#Strike’s#Beacon#Payload#.........................................................................................................#21/
4.4#Payload#Staging#......................................................................................................................................#22/
4.5#HTTP#Beacon#and#HTTPS#Beacon#.....................................................................................................#22/
Manual'HTTP'Proxy'Configuration'......................................................................................................................'24/
Redirectors'......................................................................................................................................................................'24/
4.6#DNS#Beacon#..............................................................................................................................................#25/
Data'Channels'................................................................................................................................................................'25/
Listener'Setup'................................................................................................................................................................'26/
4.7#SMB#Beacon#.............................................................................................................................................#27/
Linking'and'Unlinking'................................................................................................................................................'27/
4.8#TCP#Beacon#..............................................................................................................................................#28/
Connecting'and'Unlinking'........................................................................................................................................'29/
4.9#External#C2#...............................................................................................................................................#29/
4.10#Foreign#Listeners#................................................................................................................................#30/
4.11#Infrastructure#Consolidation#..........................................................................................................#30/
4.12#Payload#Security#Features#................................................................................................................#31/
www.cobaltstrike.com/
/
3/
5.&Getting&a&Foothold&.........................................................................................................................&32/
5.1#Client-side#System#Profiler#.................................................................................................................#32/
5.2#Cobalt#Strike#Web#Services#.................................................................................................................#32/
5.3#User-driven#Attack#Packages#.............................................................................................................#32/
HTML'Application'........................................................................................................................................................'33/
MS'Office'Macro'............................................................................................................................................................'33/
Payload'Generator'.......................................................................................................................................................'33/
Windows'Executable'..................................................................................................................................................'33/
Windows'Executable'(S)'...........................................................................................................................................'33/
5.4#Hosting#Files#............................................................................................................................................#34/
5.5#User-driven#Web#Drive-by#Attacks#..................................................................................................#34/
Java'Signed'Applet'Attack'.........................................................................................................................................'34/
Java'Smart'Applet'Attack'..........................................................................................................................................'34/
Scripted'Web'Delivery'(S)'........................................................................................................................................'34/
5.6#Client-side#Exploits#...............................................................................................................................#35/
5.7#Clone#a#Site#...............................................................................................................................................#35/
5.8#Spear#Phishing#........................................................................................................................................#36/
Targets'..............................................................................................................................................................................'36/
Templates'........................................................................................................................................................................'36/
Sending'Messages'........................................................................................................................................................'37/
6.&Payload&Artifacts&and&Anti-virus&Evasion&..............................................................................&39/
6.1#Philosophy#...............................................................................................................................................#39/
6.2#The#Artifact#Kit#.......................................................................................................................................#39/
The'Theory'of'the'Artifact'Kit'.................................................................................................................................'39/
Where'Artifact'Kit'Fails'.............................................................................................................................................'40/
How'to'use'the'Artifact'Kit'.......................................................................................................................................'40/
6.3#The#Veil#Evasion#Framework#.............................................................................................................#41/
6.4#Java#Applet#Attacks#...............................................................................................................................#41/
6.5#The#Resource#Kit#....................................................................................................................................#42/
7.&Post&Exploitation&............................................................................................................................&43/
7.1#The#Beacon#Console#..............................................................................................................................#43/
7.2#The#Beacon#Menu#..................................................................................................................................#43/
7.3#Asynchronous#and#Interactive#Operations#...................................................................................#44/
7.4#Running#Commands#..............................................................................................................................#44/
7.5#Session#Passing#.......................................................................................................................................#45/
7.6#Alternate#Parent#Processes#................................................................................................................#46/
7.7#Spoof#Process#Arguments#...................................................................................................................#46/
7.8#Blocking#DLLs#in#Child#Processes#.....................................................................................................#47/
7.9#Upload#and#Download#Files#................................................................................................................#47/
7.10#File#Browser#..........................................................................................................................................#47/
7.11#File#System#Commands#......................................................................................................................#48/
7.12#The#Windows#Registry#......................................................................................................................#48/
7.13#Keystrokes#and#Screenshots#...........................................................................................................#49/
7.14#Post-Exploitation#Jobs#.......................................................................................................................#49/
7.15#The#Process#Browser#.........................................................................................................................#49/
7.16#Desktop#Control#...................................................................................................................................#50/
7.17#Privilege#Escalation#............................................................................................................................#52/
Elevate'with'an'Exploit'..............................................................................................................................................'52/
Elevate'with'Known'Credentials'...........................................................................................................................'53/
www.cobaltstrike.com/
/
4/
Get'SYSTEM'.....................................................................................................................................................................'53/
UAC'Bypass'.....................................................................................................................................................................'53/
Privileges'.........................................................................................................................................................................'54/
7.18#Mimikatz#................................................................................................................................................#54/
7.19#Credential#and#Hash#Harvesting#....................................................................................................#54/
7.20#Port#Scanning#.......................................................................................................................................#54/
7.21#Network#and#Host#Enumeration#....................................................................................................#55/
7.22#Trust#Relationships#............................................................................................................................#55/
Kerberos'Tickets'...........................................................................................................................................................'55/
7.23#Lateral#Movement#...............................................................................................................................#56/
7.24#Lateral#Movement#GUI#.......................................................................................................................#57/
8.&Browser&Pivoting&...........................................................................................................................&58/
8.1#Overview#...................................................................................................................................................#58/
8.2#Setup#..........................................................................................................................................................#59/
8.3#Use#..............................................................................................................................................................#60/
8.4#How#it#Works#...........................................................................................................................................#60/
9.&Pivoting&.............................................................................................................................................&61/
9.1#What#is#Pivoting#.....................................................................................................................................#61/
9.2#SOCKS#Proxy#............................................................................................................................................#61/
Proxychains'....................................................................................................................................................................'61/
Metasploit'........................................................................................................................................................................'61/
9.3#Reverse#Port#Forward#..........................................................................................................................#62/
9.4#Spawn#and#Tunnel#.................................................................................................................................#62/
Agent'Deployed:'Interoperability'with'Core'Impact'....................................................................................'62/
9.5#Pivot#Listeners#........................................................................................................................................#63/
9.6#Covert#VPN#...............................................................................................................................................#64/
10.&SSH&Sessions&..................................................................................................................................&66/
10.1#The#SSH#Client#......................................................................................................................................#66/
10.2#Running#Commands#...........................................................................................................................#66/
10.3#Upload#and#Download#Files#.............................................................................................................#66/
10.4#Peer-to-peer#C2#....................................................................................................................................#66/
10.5#SOCKS#Pivoting#and#Reverse#Port#Forwards#..............................................................................#67/
11.&Malleable&Command&and&Control&..........................................................................................&68/
11.1#Overview#................................................................................................................................................#68/
11.2#Checking#for#Errors#............................................................................................................................#68/
11.3#Profile#Language#..................................................................................................................................#68/
Data'Transform'Language'........................................................................................................................................'70/
Strings'...............................................................................................................................................................................'71/
Headers'and'Parameters'...........................................................................................................................................'71/
Options'..............................................................................................................................................................................'72/
11.4#HTTP#Staging#........................................................................................................................................#74/
11.5#A#Beacon#HTTP#Transaction#Walk-through#...............................................................................#74/
11.6#HTTP#Server#Configuration#.............................................................................................................#76/
11.7#Self-signed#SSL#Certificates#with#SSL#Beacon#.............................................................................#76/
11.8#Valid#SSL#Certificates#with#SSL#Beacon#........................................................................................#77/
11.9#Profile#Variants#....................................................................................................................................#78/
11.10#Code#Signing#Certificate#..................................................................................................................#78/
11.11#Which#is#more#dangerous,#Malleable#C2#or#a#swimming#pool?#.........................................#79/
www.cobaltstrike.com/
/
5/
12.&Malleable&PE,&Process&Injection,&and&Post&Exploitation&.................................................&80/
12.1#Overview#................................................................................................................................................#80/
12.2#PE#and#Memory#Indicators#...............................................................................................................#80/
Cloning'PE'Headers'.....................................................................................................................................................'81/
In-memory'Evasion'and'Obfuscation'..................................................................................................................'82/
12.3#Process#Injection#.................................................................................................................................#83/
12.4#Post#Exploitation#Jobs#........................................................................................................................#85/
13.&Reporting&and&Logging&..............................................................................................................&87/
13.1#Logging#....................................................................................................................................................#87/
13.2#Reports#...................................................................................................................................................#87/
Activity'Report'..............................................................................................................................................................'88/
Hosts'Report'...................................................................................................................................................................'88/
Indicators'of'Compromise'........................................................................................................................................'89/
Sessions'Report'.............................................................................................................................................................'90/
Social'Engineering'.......................................................................................................................................................'90/
Tactics,'Techniques,'and'Procedures'..................................................................................................................'90/
13.3#Custom#Logo#in#Reports#....................................................................................................................#91/
13.4#Custom#Reports#...................................................................................................................................#91/
Appendix&A.&Keyboard&Shortcuts&..................................................................................................&92/
Last Updated: November 5, 2020 
www.cobaltstrike.com/
/
6/
1. Welcome to Cobalt Strike 
1.1 What is Cobalt Strike? 
Cobalt Strike is a platform for adversary simulations and red team operations. The product is 
designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat 
actors. This sector describes the attack process supported by Cobalt Strike’s feature set. The rest 
of this manual discusses these features in detail. 
Figure 1. The Offense Problem Set 
A thought-out targeted attack begins with reconnaissance. Cobalt Strike’s system profiler is a 
web application that maps your target’s client-side attack surface. The insights gleaned from 
reconnaissance will help you understand which options have the best chance of success on your 
target. 
Weaponization is pairing a post-exploitation payload with a document or exploit that will 
execute it on target. Cobalt Strike has options to turn common documents into weaponized 
artifacts. Cobalt Strike also has options to export its post-exploitation payload, Beacon, in a 
variety of formats for pairing with artifacts outside of this toolset. 
Use Cobalt Strike’s spear phishing tool to deliver your weaponized document to one or more 
people in your target’s network. Cobalt Strike’s phishing tool repurposes saved emails into pixel-
perfect phishes.  
Control your target’s network with Cobalt Strike’s Beacon. This post-exploitation payload uses 
an asynchronous “low and slow” communication pattern that’s common with advanced threat 
malware. Beacon will phone home over DNS, HTTP, or HTTPS. Beacon walks through 
common proxy configurations and calls home to multiple hosts to resist blocking. 
www.cobaltstrike.com/
/
7/
Exercise your target’s attack attribution and analysis capability with Beacon’s Malleable 
Command and Control language. Reprogram Beacon to use network indicators that look like 
known malware or blend in with existing traffic.  
Pivot into the compromised network, discover hosts, and move laterally with Beacon’s helpful 
automation and peer-to-peer communication over named pipes and TCP sockets. Cobalt Strike is 
optimized to capture trust relationships and enable lateral movement with captured credentials, 
password hashes, access tokens, and Kerberos tickets. 
Demonstrate meaningful business risk with Cobalt Strike’s user-exploitation tools. Cobalt 
Strike’s workflows make it easy to deploy keystroke loggers and screenshot capture tools on 
compromised systems. Use browser pivoting to gain access to websites that your compromised 
target is logged onto with Internet Explorer. This Cobalt Strike-only technique works with most 
sites and bypasses two-factor authentication.  
Cobalt Strike’s reporting features reconstruct the engagement for your client. Provide the 
network administrators an activity timeline so they may find attack indicators in their sensors. 
Cobalt Strike generates high quality reports that you may present to your clients as stand-alone 
products or use as appendices to your written narrative. 
Throughout each of the above steps, you will need to understand the target environment, its 
defenses, and reason about the best way to meet your objectives with what is available to you. 
This is evasion. It is not Cobalt Strike’s goal to provide evasion out-of-the-box. Instead, the 
product provides flexibility, both in its potential configurations and options to execute offense 
actions, to allow you to adapt the product to your circumstance and objectives. 
1.2 Installation and Updates 
Strategic Cyber LLC distributes Cobalt Strike packages as native archives for Windows, Linux, 
and MacOS X. To install Cobalt Strike, simply extract its archive onto your operating system.  
System Requirements 
Cobalt Strike requires Oracle Java 1.8, Oracle Java 11, or OpenJDK 11.  
If you have an anti-virus product on your system, make sure you disable it before you install 
Cobalt Strike.  
Run the ‘update’ program 
The Cobalt Strike distribution package contains the Cobalt Strike launcher(s) for that system, 
supporting files, and the updater program. It does not contain the Cobalt Strike program itself. 
You must run the update program to download the Cobalt Strike product. 
www.cobaltstrike.com/
/
8/
Figure 2. The Update Process (Nice try, but the pictured key is no longer valid) 
Make sure you update both your team server and client software with your license key. Cobalt 
Strike is generally licensed on a per user basis. The team server does not require a separate 
license. 
1.3 The Team Server 
Cobalt Strike is split into a client and a server component. The server, referred to as the team 
server, is the controller for the Beacon payload and the host for Cobalt Strike’s social 
engineering features. The team server also stores data collected by Cobalt Strike and it manages 
logging. 
The Cobalt Strike team server must run on a supported Linux system. To start a Cobalt Strike 
team server, use the teamserver script included with the Cobalt Strike Linux package. 
Figure 3. Starting the Team Server 
The team server has two mandatory parameters and two optional parameters. The first is the 
externally reachable IP address of the team server. Cobalt Strike uses this value as a default host 
for its features. The second is the password your team members will use to connect the Cobalt 
Strike client to the team server.  
The third parameter is optional. This parameter specifies a Malleable C2 Profile. Chapters 11 and 
12 discuss this feature. 
The fourth parameter is also optional. This parameter specifies a kill date in YYYY-MM-DD 
format. The team server will embed this kill date into each Beacon stage it generates. The 
Beacon payload will refuse to run on or after this date. The Beacon payload will also exit if it 
wakes up on or after this date as well. 
www.cobaltstrike.com/
/
9/
When the team server starts, it will publish the SHA256 hash of the team server’s SSL 
certificate. Distribute this hash to your team members. When your team members connect, their 
Cobalt Strike client will ask if they recognize this hash before it authenticates to the team server. 
This is an important protection against man-in-the-middle attacks. 
1.4 Cobalt Strike Client 
The Cobalt Strike client connects to the team server. To start the Cobalt Strike client, use the 
launcher included with your platform’s package. 
You will see a connect dialog when the Cobalt Strike client starts.  
Figure 4. Cobalt Strike Connect Dialog 
Specify your team server’s address in the Host field. The default Port for the team server is 
50050. There’s rarely a reason to change this. The User field is your nickname on the team 
server. Change this to your call sign, handle, or made-up hacker fantasy name. The Password 
field is the shared password for the team server.  
Press Connect to connect to the Cobalt Strike team server.  
If this is your first connection to this team server, Cobalt Strike will ask if you recognize the 
SHA256 hash of this team server. If you do, press OK, and the Cobalt Strike client will connect 
to the server. Cobalt Strike will also remember this SHA256 hash for future connections. You 
may manage these hashes through Cobalt Strike -> Preferences -> Fingerprints. 
www.cobaltstrike.com/
/
10/
Figure 5. Verifying the server’s SSL certificate 
Cobalt Strike keeps track of the team servers you connect to and remembers your information. 
Select one of these team server profiles from the left-hand-side of the connect dialog to populate 
the connect dialog with its information. You may also prune this list through Cobalt Strike -> 
Preferences -> Team Servers. 
1.5 Distributed and Team Operations 
Use Cobalt Strike to coordinate a distributed red team effort. Stage Cobalt Strike on one or more 
remote hosts. Start your team servers and have your team connect. 
Figure 6. Distributed Operations with Cobalt Strike 
Once connected to a team server, your team will: 
• Use/the/same/sessions/
• Share/hosts,/captured/data,/and/downloaded/files/