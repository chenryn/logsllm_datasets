N
N
=
=
=
Â·
Â·
Â·
2N 2 + k Â· o
N 2
N 2 + o
N 2
i =0
as desired.
â–¡
The next lemma estimates, for any x âˆˆ [N], the expected number
of preimages of the point h[1,k](x) and its variance. We use IA to
denote the indicator variable of probability event A.
and let Lj =N
Lemma A.3. Let {hi}k
i =1 âˆˆ â„±N be independent random functions,
i =1 Ih[1,k](i)=j be a random variable of the number of
different preimages under h[1,k] of j âˆˆ [N]. For every x âˆˆ [N],
(cid:104)
(cid:104)
(cid:105)
(cid:105)
E
Lh[1,k](x)
= k + 1 âˆ’ o(1)
h1, ...,hk
Varh1, ...,hk
Lh[1,k](x)
= 1
2
(k + 1)2 .
Proof. From the linearity of expectation and the previous lemma,
we find that
(cid:104)
E
h1, ...,hk
Lh[1,k](x)
(cid:105)
=
=
xâ€²=1
Ih[1,k](x)=h[1,k](xâ€²)
(cid:34) N
(cid:35)
(cid:104)
(cid:105)
(cid:2)h[1,k](x) = h[1,k](x
(cid:18) k
Ih[1,k](x)=h[1,k](xâ€²)
(cid:19)
âˆ’ o( 1
N )
N
h1, ...,hk
E
N
N
xâ€²=1
E
h1, ...,hk
=
Pr
h1, ...,hk
xâ€²=1
= 1 + (N âˆ’ 1) Â·
â€²)(cid:3)
= k + 1 âˆ’ o(1).
(cid:104)
Additionally,
L2
h[1,k](x)
h1, . . .,hk
E
=
E
h1, . . .,hk
(cid:105)
(cid:34) N
N
 N
xâ€²=1
xâ€²â€²=1
=
E
xâ€²,xâ€²â€²=1
h1, . . .,hk
= (N âˆ’ 1)(N âˆ’ 2) Â·
Ih[1,k](x)=h[1,k](xâ€²) Â· Ih[1,k](x)=h[1,k](xâ€²â€²)
Ih[1,k](x)=h[1,k](xâ€²)=h[1,k](xâ€²â€²)
(cid:104)
(cid:35)
(cid:105)
Ih[1,k](x)=h[1,k](xâ€²)=h[1,k](xâ€²â€²)
+ 3(N âˆ’ 1) Â·
E
(cid:105)
(cid:19)
+ 1
h1, . . .,hk
Ih[1,k](x)=h[1,k](xâ€²)
x,xâ€²,xâ€²â€² different
E
h1, . . .,hk
x (cid:44)xâ€²
(cid:104)
(cid:18) k(3k âˆ’ 1 + oN (1))
2 + oN (1)(cid:1) k + 1
(cid:104)
(cid:105)
(cid:104)
(cid:105) âˆ’
2 + oN(1)(cid:17)
(cid:16) 1
h1, ...,hk
2k2 +
L2
h[1,k](x)
Lh[1,k](x)
2N 2
= 1
E
=
+ 3(N âˆ’ 1) Â·
2 k2 +(cid:0) 5
= (N âˆ’ 1)(N âˆ’ 2) Â·
= 3
and thus
Varh1, ...,hk
(cid:1)(cid:19)
+ 1
(cid:18) k
N
N
âˆ’ o(cid:0) 1
(cid:104)
(cid:105)2
Lh[1,k](x)
E
h1, ...,hk
2(k + 1)2.
k â‰¤ 1
and let Lj =N
â–¡
i =1 âˆˆ â„±N be independent random functions,
i =1 Ih[1,k](i)=j be a random variable of the number of
Lemma A.4. Let {hi}k
different preimages under h[1,k] of j âˆˆ [N]. For every x âˆˆ [N],
Pr
h1, ...,hk
(cid:20)
Lh[1,k](x) â‰¥ 2kâˆš
(cid:21)
Ïµ
Proof. Applying Chebyshevâ€™s inequality, we obtain
Pr
h1, . . .,hk
â‰¤
Pr
(cid:34)
Lh[1,k](x) â‰¥ 2kâˆš
Lh[1,k](x) â‰¥ (k + 1) +
Ïµ
(cid:114) 2
Ïµ
(cid:35)
(cid:114) 1
2
Â·
(k + 1)
â‰¤ Ïµ
2 .
â–¡
h1, . . .,hk
Lemma A.5. Let {hi}k
dom functions, and let Lj =N
(cid:20)
i =1 âˆˆ â„±M, N be independent identically ran-
i =1 Ih[1,k](i)=j be a random variable of
the number of different preimages under h[1,k] of j âˆˆ [M] Ã— [N]. For
every (s, x) âˆˆ [M] Ã— [N],
(cid:21)
Pr
h1, ...,hk
Lh[1,k](s,x) â‰¥ 2kâˆš
Ïµ
â‰¤ Ïµ
2 .
Proof. Fix s âˆˆ [M], and define hi,s(x) to be the last n bits of
i =1 yields the result.
â–¡
hi(s, x). Applying the previous lemma to {hi,s}k
(cid:21)
â‰¤ Ïµ
2 .
(cid:20)
B PROOF OF THEOREM 8.2
Our proof reduces the problem of inverting a random function to
the problem of inverting a random hash chain.
Let ğ’Ÿ be a distribution over functions from ğ’³ to ğ’³ such that
for every x âˆˆ ğ’³
(cid:20)
(cid:21)
Lh[1,k](x) â‰¥ 2kâˆš
Ïµ
â‰¤ Ïµ
2 .
(7)
Pr
h1, ...,hk âˆˆğ’Ÿ
14
since Theorem 8.1, and therefore also our reduction, can be arbitrar-
ily non-uniform in the input size. Another way of thinking about
this is that since our model charges the algorithm only for oracle
queries, an algorithm in this model can deterministically determine
the best iâˆ— and the remaining functions by simulating Aâ€™s behavior
on all possible inputs (without making any oracle queries).
Consider the following algorithm Aâ€² for inverting a random
function h âˆˆ ğ’Ÿ. Algorithm Aâ€² gets the same S bits of advice as
A and is given oracle access to h. On input z âˆˆ ğ’³ , Aâ€² computes
y = h[iâˆ—+1,k](z) and then simulates A on y as follows: Aâ€² uses its
own oracle to answer oracle queries to hiâˆ— and uses the chosen func-
tions h1, . . . , hiâˆ—âˆ’1, hiâˆ—+1, . . . , hk to answer all other oracle queries.
Furthermore, Aâ€² bounds the number of queries to h by 2T
k . Thus,
if during the simulation A tries to make more than this number of
queries to h, algorithm Aâ€² aborts. Otherwise, Aâ€² obtains A(y) and
then computes and outputs h[1,iâˆ—âˆ’1](A(y)).
To analyze the success probability of Aâ€², the key observation is
h ), then Aâ€² inverts h(w) successfully. To see
that if w âˆˆ h[1,iâˆ—âˆ’1](Giâˆ—
h , then Aâ€² simulates A
this, note that if w = h[1,iâˆ—âˆ’1](x) for x âˆˆ Giâˆ—
on
y = h[iâˆ—+1,k](h(w)) = h[1,k](x) âˆˆ Giâˆ—
h ,
(cid:2)A
thus A(y) = x, and Aâ€²(h(w)) = h[1,iâˆ—âˆ’1](A(y)) = w as desired.
Therefore
Pr
hâˆˆğ’Ÿ
w âˆˆğ’³
âˆ’1(h(w))(cid:3) â‰¥ Pr
â€²(h(w)) âˆˆ h
(cid:2)w âˆˆ h[1,iâˆ—âˆ’1](G
â€²)(cid:3)
(cid:104)
(cid:105) â‰¥ Ïµ3/2
hâˆˆğ’Ÿ
w âˆˆğ’³
,
x âˆˆ Giâˆ—
h
8k
where the penultimate equality holds because h[1,k] and therefore
also h[1,iâˆ—âˆ’1] have no collisions on Giâˆ—
h , and the last inequality
follows from Equation 8.
To complete the proof of the theorem, we apply the lower bound
given by Theorem 8.1 to algorithm Aâ€² and the distribution SM, N ,
which gives
(cid:32)
(cid:33)
,
1 + S
M
â‰¥ Ëœâ„¦
Ïµ3/2N
8k
(cid:19)
(cid:19)
(cid:18)
(cid:18)
1 + S
M
â‰¥ Ëœâ„¦(Ïµ3/2N)
â–¡
2T
k
T
and therefore
as required.
(cid:19)(cid:27)
(cid:18)
(cid:17) âˆ§
(cid:26)
(cid:16)
Let A be an oracle algorithm, which, given oracle access to h1, . . . , hk âˆˆ
ğ’Ÿ and S bits of advice, makes at most T oracle queries to all of its or-
acles combined and successfully inverts with probability Ïµ âˆˆ (0, 1).
For any choice of functions {hi}k
i =1 âˆˆ ğ’Ÿ, let
Gh1, ...,hk
=
x âˆˆ ğ’³ :
A(h[1,k](x)) = x
Lh[1,k](x) â‰¤ 2kâˆš
Ïµ
be the set of good points, where we say that a point is good if
A outputs x when executed on h[1,k](x), and the point does not
have many collisions under h[1,k]. Note that the first condition is
stronger than the condition that A merely inverts h[1,k](x). Denote
by h[1,k](Gh1, ...,hk ) the corresponding set of good images. Observe
that the second condition above guarantees that each point in the
image h[1,k](Gh1, ...,hk ) has at most 2kâˆš
Ïµ preimages under h[1,k].
Using this observation and a union bound, we conclude that
(cid:2)h[1,k](x) âˆˆ h[1,k](Gh1, . . .,hk )(cid:3)
h1, . . .,hk
Pr
xâˆˆğ’³
âˆš
Ïµ
2k
â‰¥
Â·
âˆš
Ïµ
2k
(cid:2)x âˆˆ Gh1, . . .,hk
(cid:104)
Â·(cid:169)(cid:173)(cid:173)(cid:171)
(cid:3) â‰¥
A(h[1,k](x)) âˆˆ hâˆ’1[1,k](h[1,k](x))(cid:105)
(cid:20)
Pr