# 使用OpenVAS进行漏洞扫描

## 5.2.2 扫描本地漏洞

### 1. 创建目标
在Targets界面，点击“New Target”图标，将显示如图5.37所示的界面。

**图5.37 新建Target界面**

在此界面中输入Target名称及要扫描的主机。然后点击“Create Target”按钮，将显示如图5.38所示的界面。

**图5.38 新建的目标**

从该界面可以看到新建的Local Vulnerabilities目标。

### 2. 创建任务
在OpenVAS的菜单栏中依次选择“Scan Management” -> “New Task”，将显示如图5.39所示的界面。

**图5.39 新建任务**

在此界面设置任务名称、Scan Config和Scan Targets，然后点击“Create Task”按钮，将显示如图5.40所示的界面。

**图5.40 新建的任务**

在该界面点击“Start”图标，开始漏洞扫描。当启动扫描任务后，按钮将变为“Pause”，可以暂停扫描，也可以点击“Stop”停止扫描。

### 3. 扫描本地漏洞
OpenVAS允许用户大范围扫描漏洞，并且将限制在用户的评估列表中。目标主机的漏洞信息是从评估中获得的。本小节将介绍使用OpenVAS来扫描用户指定本地目标系统上的漏洞。

#### 具体操作步骤：
1. 创建目标系统。
2. 创建名为“Local Vulnerabilities”的扫描任务。
3. 完成本地漏洞扫描后的界面如图5.41所示。

**图5.41 扫描漏洞完成**

4. 在该界面点击“Task Details”图标，查看漏洞扫描的详细信息，显示界面如图5.42所示。

**图5.42 扫描的详细信息**

5. 该界面显示了两个窗口：任务详细信息和本地漏洞扫描报告信息。用户可以从报告信息中了解本地系统是否有漏洞。在Actions栏下点击“Details”图标可以查看详细情况，显示界面如图5.43所示。

**图5.43 报告摘要**

6. 在该界面显示了所有信息，这些信息可以通过点击“Download”图标下载扫描报告。

### 5.2.3 扫描网络漏洞
本小节将介绍使用OpenVAS扫描一个网络漏洞。这些漏洞的信息是指一个目标网络中某个设备的信息。本小节中将Windows XP、Windows 7、Metasploitable 2.0 和 Linux 系统作为目标测试系统。

#### 具体操作步骤：
1. 新建名为“Network Vulnerability”的Scan Config。
2. 添加所需扫描的类型，如表5-5所示。

**表5-5 扫描类型**
- 暴力攻击
- 缓存溢出漏洞
- CISCO路由器漏洞
- Compliance漏洞
- 数据库漏洞
- 默认账号漏洞
- 拒绝服务漏洞
- FTP服务器漏洞
- Finger滥用漏洞
- 防火墙漏洞
- 获取远程Shell的漏洞
- 通用漏洞
- 恶意软件漏洞
- 网络操作系统漏洞
- NMAP NSE漏洞
- 共享文件漏洞
- 端口漏洞
- 提升特权漏洞
- 产品侦察漏洞
- RPC漏洞
- 远程文件访问漏洞
- SMTP问题
- SNMP漏洞
- 服务侦察漏洞
- 基本设置漏洞

3. 创建名为“Network Vulnerability”的目标系统。
4. 创建名为“Network Scan”的扫描任务。
5. 扫描结果如图5.44所示。

**图5.44 Network扫描结果**

6. 从该界面可以看到整个网络中的漏洞情况不太严重，漏洞状态为Medium。查看详细漏洞扫描情况的方法在前面已经介绍，这里不再赘述。

### 5.2.4 扫描指定Linux系统漏洞
本小节将介绍使用OpenVAS扫描指定Linux系统的漏洞。这些漏洞信息来自一个目标网络中指定的Linux系统。推荐使用的目标Linux系统为Metasploitable 2.0和其他任何版本的Linux。

#### 具体操作步骤：
1. 新建名为“Linux Vulnerabilities”的Scan Config。
2. 添加所需的扫描类型，如表5-6所示。

**表5-6 扫描类型**
- 暴力攻击
- 缓存溢出漏洞
- Compliance漏洞
- 数据库漏洞
- 默认用户账号漏洞
- 拒绝服务漏洞
- FTP服务器漏洞
- Finger滥用漏洞
- 获取远程Shell漏洞
- 通用漏洞
- 恶意软件漏洞
- 网络操作系统漏洞
- NMAP NSE漏洞
- 端口漏洞
- 提升特权漏洞
- 产品侦察漏洞
- RPC漏洞
- 远程文件访问漏洞
- SMTP问题
- SNMP漏洞
- 服务侦察漏洞
- 基本设置漏洞
- Web服务漏洞

3. 创建“Linux Vulnerabilities”目标系统。
4. 创建“Linux Scan”扫描任务。
5. 扫描结果如图5.45所示。

**图5.45 Linux扫描结果**

6. 从该界面可以看到目标系统中有非常严重的漏洞。此时点击“Task Details”图标，查看漏洞扫描的详细信息，如图5.46所示。

**图5.46 Task Details**

7. 从该界面的扫描报告中可以看到有14个非常严重的漏洞信息。在Actions栏下点击“Details”图标查看具体漏洞情况，如图5.47所示。

**图5.47 详细漏洞情况**

通过以上步骤，您可以使用OpenVAS对本地和网络中的系统进行全面的漏洞扫描，并获取详细的漏洞报告。