localhost
OpenVAS Delault
R00
图5.36Targets 界面
· 139 ·
---
## Page 152
第2篇信息的收集及利用
在该界面单击（NewTarget）图标，将显示如图5.37所示的界面。
Local Vulnerabities
Hests
 Manual
[localhost
O From fle Browse.  No file selected.
Port List
ALL IANA assigned TCP 2012-02-10
n pon|22
MB Credential (optional)
-
Create Target
图5.37新建Target界面
在该界面输入Target名称及扫描的主机。然后单击CreateTarget按钮，将显示如图5.38
所示的界面。
Name
Hosts
IPsPort List
SSH Credential
SMB Credential
Actions
Local Vulnerabilities
localhost 
AlI IANA assigned TCP 2012-02-10
Localhost
localhost
1
OpenVAS Default
图5.38新建的目标
从该界面可以看到新建的LocalVulnerabilities目标。
3.新建任务
在OpenVAS的菜单栏中依次选择ScanManagementNewTask命令，将显示如图5.39
所示的界面。
New Task
Name
Local Vulnerabilities
ent (opf
can Config
Local Vulnerabilities
Scan Targets
Alerts (optional)
Schedule (optional)
Slave (optional)
Observers (optional)
Add results to Asset
Management
 yes O no
Scan Intensity
20
Create Task
图5.39新建任务
· 140 ·
---
## Page 153
第5章漏洞扫描
在该界面设置任务名称、ScanConfig和ScanTargets，然后单击CreateTask按钮，将
显示如图5.40所示的界面。
Tasks 1 - 1 of (total: 1) 
vNo aruto -refnesh
Applyov
rdesG
Fiter: apply_overrides=1 first=1 rows=10 sort=name
目
Reports
Threat
Local Vulnerabilities
图5.40新建的任务
在该界面单击口（Start）图标，将开始漏洞扫描。当启动该扫描任务后，按钮将变为Ⅲ
（Pause），单击该按钮可以暂停扫描，也可以单击口（Stop）停止扫描。
5.2.3扫描本地漏洞
OpenVAS允许用户大范围扫描漏洞，并且将限制在用户的评估列表中。目标主机的漏
洞指定是从评估中获得的信息。本小节将介绍使用OpenVAS来扫描用户指定本地目标系
统上的漏洞。扫描本地漏洞的具体操作步骤如下所示。
表5-4扫描的类型
H
Compliance
扫描Compliance漏洞
Default Accounts
扫描默认账号漏洞
Denial of Service
扫描拒绝服务漏洞
FTP
扫描FTP服务器漏洞
Ubuntu Local Security Checks
扫描Ubuntu系统的本地安全漏洞
（3）创建目标系统。
（4）创建名为LocalVulnerabilities扫描任务。
（5）扫描完本地漏洞的显示界面如图5.41所示。
4
Flter: applyoverrides=1 frst=1 rows=10 sort=name
Reports
irstLast
Threat
LocalVulner
Apr 25 2014
None
图5.41扫描漏洞完成
（6）在该界面单击（TaskDetails）图标，查看漏洞扫描的详细信息。显示界面如图
5.42所示。
（7）该界面显示了两个窗口，分别是任务详细信息和本地漏洞扫描报告信息。用户从
报告信息中可以了解本地系统是否有漏洞。在该界面单击Actions栏下的Q（Details）图
· 141 •
---
## Page 154
第2篇信息的收集及利用
标可以查看详细情况。单击该图标后，将显示如图5.43所示的界面。
Task Details 
Name:
Local Vulnerabilities
ID:
ab1e5a09-a029-4881-827c-l525ead7ddt
Last Modited: Sat.Apr 26 04:051 2014
Scan Config Local Vulnerabilties
Alerts
Schedule:
(Net due: over)
Target:
Local Vulnerabiities
Slave:
Status
Observers
Reports:
1 (Finished: 1)
Add to Asets: yes
Notes:
Overrides
Scan Intensity
Maximum concurrently erecuted NVTs per host: 4
m concurrently scanned hosts
20
Threat
Scan Resul
Sat Apr 26 04:05:48 2014
Done
None
X
图5.42扫描的详细信息
Result of Task: Local Vulnerabilities
Order of results: by host
Scan started: Sat Apr 26 07:25:19 2014
Scan ended:
Sat.Apr 26 07:25:24 2014
Total
Run Alert
Fullreport:
0
PDF
Allfiltered results:
PDF
Filtered results:
日
PDF
图5.43报告摘要
（8）在该界面显示了所有信息，这些信息可以通过单击！（Download）图标下载扫描
报告。
5.2.4
扫描网络漏洞
本小节将介绍使用OpenVAS扫描一个网络漏洞。这些漏洞的信息是指一个目标网络
中某个设备的信息。本小节中将WindowsXP、Windows7、Metasploitable2.0和Linux系
统作为目标测试系统。扫描网络漏洞的具体操作步骤如下所示。
（1）新建名为NetworkVulnerability的ScanConfig。
（2）添加所需扫描的类型，如表5-5所示。
· 142 ·
---
## Page 155
第5章漏洞扫描
表5-5扫描类型
Brute force attacks
暴力攻击
Buffer overflow
扫描缓存溢出漏洞
CISCO
扫描CISCO路由器
Compliance
扫描Compliance 漏洞
Databases
扫描数据库漏洞
Default Accounts
扫描默认账号漏洞
Denial of Service
扫描拒绝服务漏洞
FTP
扫描FTP服务器漏洞
Finger abuses
扫描Finger滥用漏洞
Firewalls
扫描防火墙漏洞
Gain a shell remotelly
扫描获取远程Shell的漏洞
General
扫描漏洞
Malware
扫描恶意软件
Netware
扫描网络操作系统
NMAP NSE
扫描 NMAP NSE 漏润
Peer-To-Peer File Sharing
扫描共享文件漏洞
Port Scanners
扫描端口漏洞
Privilege Escalation
扫描提升特权漏洞
Product Detection
扫描产品侦察
RPC
扫描RPC漏洞
Remote File Access
扫描远程文件访问漏洞
SMTP Problems
乐扫描SMTP问题
SNMP
扫描SNMP漏洞
Service detection
扫描服务侦察
Settings
扫描基本设置漏洞
（3）创建名为NetworkVulnerability目标系统
（4）创建名为NetworkScan扫描任务。
（5）扫描结果，如图5.44所示。
Tasks 1- 7 of 7(total: 7）目
 apply-overrides=1 frst=1 rows=10 sort=name
国
Name
Status
ota
Reports
FirstLast
Actions
Network Scan
Apr 28 2014
Windows Scan
Apr 26 2014
M
图5.44Network扫描结果
（6）从该界面可以看到整个网络中漏洞的情况不太严重，漏洞状态为Medium。查看
详细漏洞扫描情况的方法在前面已经介绍，这里就不再赘述。
5.2.5扫描指定Linux系统漏洞
本小节将介绍使用OpenVAS扫描指定Linux系统的漏洞。这些漏洞信息来自在一个
· 143 •
---
## Page 156
第2篇信息的收集及利用
目标网络中指定的Linux系统。推荐使用的目标Linux系统为Metasploitable2.0和其他任
何版本Linux。扫描指定Linux系统漏洞的具体操作步骤如下所示。
（1）新建名为LinuxVulnerabilities的Scan Config。
（2）添加所需的扫描类型，如表5-6所示。
表5-6扫描的类型
Brute force attacks
暴力攻击
Buffer overflow
扫描缓存溢出漏洞
Compliance
扫描Compliance漏洞
Databases
扫描数据库漏洞
Default Accounts
扫描默认用户账号漏洞
Denial of Service
扫描拒绝服务的漏洞
FTP
扫描FTP服务器漏洞
Finger abuses
扫描Finger澄用漏洞
Gain a shell remotely
扫描获取远程Shell漏洞
General
扫描General 漏洞
Malware
扫描恶意软件漏洞
Netware
扫描网络操作系统
NMAP NSE
扫描NMAPNSE漏洞
Port Scanners
扫描端口漏洞
Privilege Escalation
扫描提升特权漏洞
Product Detection
扫描产品侦察漏洞
RPC
扫描RPC漏洞
Remote File Access
扫描远程文件访问漏洞
SMTP Porblems
扫描SMTP问题
SNMP
扫描SNMP漏洞
Service detection
扫描服务侦察漏洞
Settings
扫描基本设置漏洞
Web Servers
扫描Web服务漏洞
（3）创建LinuxVulnerabilities目标系统。
（4）创建Linux Scan扫描任务。
（5）扫描结果，如图5.45所示。
Tasks 1 - 7 of 7 (total: 7）
Filte: applyoverrides=1 first=1 rows=10 sort=name
Name
Status
Total
Reports
First Last
Threat
Actions
inux
Apr 28 2014
Ho
图5.45Linux扫描结果
（6）从该界面可以看到目标系统中有非常严重的漏洞。此时单击（TaskDetails）图
标，查看漏洞扫描的详细信息，如图5.46所示。
（7）从该界面的扫描报告中可以看到有14个非常严重的漏洞信息。在该界面的Actions
中单击Q（Details）图标查看具体漏洞情况，如图5.47所示。
· 144 ·
---
## Page 157
第5章漏洞扫描
Task Detalls图
Name:
Linux
0310b89d -ae1a4fto-9le-ed31ed1c96
Comment:
Last Medifed: Men Apr 28 07:09:06 2014
Creutied:
Men Apr 28 07:08:45 2014
Alerts:
Schedule:
(Next due: over)
Target:
Linux
Slave:
Status:
Reports:
Observers:
1 (Finished: 1)
Add to Assets: yes
Notes:
Overrides:
Scan Intensity
Maximum concurrently executed NVTs per host: 4
reat
ctions
Mon Apr 28 07:08:49 2014
120
图 5.46 Task Details
Security Issues reported for 192.168.41.142
ligh (CVS5: 9.3)
ution Vulnerabity (OID: 1.3.6.1.4.1.25623.1.0.103553)
istcc (3632
25
ite Code Execut
distcc 2.x, as used in XCode 1.5 and others, when not configured to restrict
Aeu
commands via compilation jobs, which are executed by the server without
access to the server port, allows remote attackers to execute arbitrary
authorization checks.
Solution: