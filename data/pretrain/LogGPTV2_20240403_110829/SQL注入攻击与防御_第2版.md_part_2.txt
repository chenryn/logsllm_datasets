Dafydd Stuttard是一位独立的安全顾问、作者和软件开发人员，他精通Web应用程序的
渗透测试和汇编软件。Dafydd 是畅销书 Web 4pplicarion Hacker’s Handbook 的作者。他的别名
是PortSwigger，他创建了流行的 Web应用程序黑客工具Burp Suite。Dafydd 为安全会议以及
在世界上其他地点举办的会议开发并提供培训课程。Dafydd具有牛津大学哲学硕士和博士
学位。
AI
---
## Page 8
致谢
首先再次感谢 Syngress 的编辑团队(特别感谢Chris Katsaropoulos 和 Heather Scherer)，感谢
他们愿意再次出版一本由多名作者共同编写的图书。作为本书的主要撰稿人，还要感谢本书的
作者团队，感谢他们齐心协力共同完成了本书。
---
## Page 9
前言
自从2009年本书第1版出版以来又过去了不少时间，大约经过了3年之后，本书的第2
版也已经面世。当我们在第1版中讨论SQL注入的理念时，SQL注入已经出现了10多年，并
且在本质上并没有新的改变。截至2008年（大约在发现SQL注入这一问题10年之后，当本书
第1版刚开始成形时），对于什么是SQL注入、如何发现SQL注入漏润，以及如何利用漏洞，
人们依然没有综合性的理解，更不用说如何防御SQL注入漏洞，以及如何从一开始就避免SQL
注入漏洞的出现。另外，普通的观点是SQL注入仅仅与Web应用程序有关，对于混合攻击或
者作为一种渗透组织机构外部安全控制的方法面言，SQL注入并不是一种危险因素—事实充
分证明这种观点是错误的，在本书第1版付梓前后发生的黑客安全事件就是最好的说明（比如
Heartland Payment Systems 的安全事件)。
现在是2012年，笔者完成了本书的第2版，虽然在SQL注入的基础理论上只有很小的变
化，但是SQL注入的技术已经不断进步，在将SQL注入应用于较新的领域方面已经有了新的
发展，比如将SQL注入应用于移动应用程序，以及通过HTML5实现客户端SQL注入。另外，
此书第2版还为我和本书的合著者提供了一次机会，对读者在第1版中提出的问题提供反馈。
在第2版中，不但全面更新了本书的所有内容，还介绍了一些新的技术和方法。另外在第2版
中还扩大了数据库的范围，包含对PostgreSQL数据库的介绍。在本书的各个章节中，都将
Microsoft SQL Server、Oracle、MySQL和 PostgreSQL数据库作为主要的数据库平台，并在相
关内容中使用Java、.NET和 PHP编写了代码示例。
本书总体上分为4个部分——理解SQL注入（第1章）、发现SQL注入（第2~3章）、利用
SQL注入漏洞（第4~7章），以及防御SQL注入（第8章～10章)。每一部分都有意针对不同的
读者，从所有读者（理解SQL注入)、安全专家和渗透测试人员(发现和利用SQL注入漏洞），到
管理数据库的开发专家和IT专家（发现和防御SQL注入)。为了使本书的内容更丰富，包含了
第11章以提供参考资料，该章还包含了本书并未详细介绍的其他数据库平台。如果偶然遇到
这样的平台，读者可以参考本书前面章节中讨论的各种技术。
下面是每一章的内容提要：
第1章—介绍什么是SQL注入，以及SQL注入是如何发生的。
第2章一介绍如何从Web应用程序前端发现SQL注入，包括如何检测可能存在的 SQL
注入漏洞、如何确认SQL注入漏洞的存在，以及如何自动发现SQL注入漏洞。
第3章—如何通过审查代码来发现SQL注入漏洞，既可以手工方式审查代码，也可以
通过自动方式审查代码。
第4章—如何利用SQL注入漏洞，包括几种常见技术，比如UNION语句和条件语句、
枚举数据库模式、盗取密码哈希，以及以自动化利用SQL注入漏洞。
第5章—如何利用SQL盲注漏洞，包括使用基于时间、基于响应和非主流通道返回
数据。
---
## Page 10
SQL注入攻击与防御（第2版）
第6章一—介绍如何通过SQL注入利用操作系统的漏洞，包括读取和写入文件，以及通
过SQL注入漏润执行操作系统命令。
第7章一介绍利用漏洞的高级主题，包括如何利用二阶SQL注入漏洞、如何利用客户
端SQL注入漏洞，以及如何通过SQL注入执行混合攻击。
第8章一介绍针对SQL注入的代码层防御，包括基于设计的方法、使用参数化查询、
编码技术以及验证有效SQL注入方法。
数据库加固，以及如何减小SQL注入影响的安全部署方面的考虑。
失败、确定SQL注入是否已经成功，以及在受到SQL注入攻击时如何对数据库进行恢复。
第11 章—介绍 SQL基础知识，为 Microsof SQL Server、Oracle、MySQL 和 PostgreSQL
数据库平台的SQL注入提供快速参考，还包括在其他平台上执行SQL注入的细节，比如DB2、
Sybase、Access和其他数据库。
VII
---
## Page 11
目
录
第1章什么是SQL注入
3.2.4复查Android应用程序代码 88
1.1概述
3.2.5复查 PL/SQL 和 T-SQL 代码·93
1.2理解Web应用的工作原理
2
3.3自动复查源代码
.- 99
1.2.1一种简单的应用架构
.3
3.3.1 Graudit
100
1.2.2
一种较复杂的架构
4
3.3.2YASCA
101
1.3理解SQL注入…
-- 5
3.3.3Pixy
101
1.4理解SQL注入的产生过程
0I --
3.3.4AppCodeScam
·102
1.4.1构造动态字符串…
10
3.3.5 OWASPLAPSE+项目-
201
1.4.2不安全的数据库配置
16
3.3.6Microsof SQL注入源代码
1.5本章小结
 18
分析器
103
1.6
快速解决方案
 18
3.3.7 CAT.NET
·103
1.7常见问题解答
6I
3.3.8 RIPS
PHP 脚本漏润
的静态源代码分析器
 103
第2章SQL注入测试
21
3.3.9  CodePro AnalytiX-
--104
2.1概述
·21
2.2寻找SQL注入.
·21
3.3.10
22
Workbench
·104
2.2.1借助推理进行测试
3.3.11商业源代码复查工具
 104
2.2.2数据库错误
·28
·39
3.3.12Fortify 源代码分析器
·105
2.2.3应用程序的响应
42
3.3.13 Rational AppScan Source
2.2.4SQL 首注
Edition
106
2.3
确认SQL注入.
·45
3.3.14 CodeSecure
106
2.3.1区分数字和字符串
46
·46
3.3.15 Klocwork Solo
106
2.3.2内联 SQL注入
3.4
本章小结·
- 107
2.3.3终止式SQL注入
·52
59
3.5
快速解决方案
· 107
2.3.4时间延迟
3.6
常见问题解答
108
2.4
自动寻找 SQL 注入
·60
2.5
本章小结…
68
利用SQL注入
111
2.6
快速解决方案
·68
4.1
概述
- 111
2.7
常见问题解答·
·69
4.2
理解常见的漏洞利用技术-
. 112
-- 71
4.2.1使用堆叠查询
113
复查代码中的SQL注入.
- 71
4.2.2在Web应用程序中利用Oracle
3.1
概述
71
漏洞
 114
3.2
复查源代码中的SQL注入
4.3
识别数据库
 14
3.2.1危险的编码行为
·73
·78
4.3.1非首取踪
115
3.2.2
危险的函数
4.3.2自跟踪
119
3.2.3跟踪数据
·81
---
## Page 12
SQL注入攻击与防御（第2版）