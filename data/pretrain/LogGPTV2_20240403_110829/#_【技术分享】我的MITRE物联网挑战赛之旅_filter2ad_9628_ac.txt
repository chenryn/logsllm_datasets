（解释一下这里所说的不同环境，主办方给出了4个文件，2.42GHz和908MHz的文件各两个，这里每个文件代表一个环境，例如B1代表的一个环境是有N个物理设备在工作的环境，C1却可能代表B1改变后的环境，改变可以是添加或者移除了一些物理设备或者系统重置了，重置的结果可能造成物理设备的网络ID和设备ID发生改变，所以网络ID和设备ID并不能唯一定位标识一个设备）
例如下图中，我们在B1环境中发现了28个物理设备，这其中某些物理设备可能在C1中采用不同的网络ID和设备ID进行通信。
所以我们需要寻找并进行统计的是包含网络ID与设备ID与IEEE地址对应关系的数据包，就像下图这种：
将B1和C1中的所有的IEEE地址（唯一识别物理设备的地址）及对应的网络ID和设备ID关系统计出来就能够回答ZigBee相关的题目了。如下图中的统计结果可以看出红色IEEE标记的物理设备在两个不同环境中的网络ID和设备ID都不同，但其实就是同一个物理设备。
好了，ZigBee部分讲完了接下来我们讲一讲Z-Wave,虽然我还没有时间来得及做，但是在这里还是可以和大家分享一下我的思路和一些相关资料。
对于Z-Wave我们可以发送主办方给的数据，然后用Z-Wave分析工具进行分析。
**Z-Wave简介**
Z-Wave是由丹麦公司Zensys所一手主导的无线组网规格，Z-wave联盟(Z-wave Alliance)虽然没有ZigBee联盟强大，但是Z-wave联盟的成员均是已经在智能家居领域有现行产品的厂商，该联盟已经具有160多家国际知名公司，范围基本覆盖全球各个国家和地区。
Z-Wave技术设计用于住宅、照明商业控制以及状态读取应用，例如抄表、照明及家电控制、HVAC、防盗及火灾检测等。Z-Wave可将任何独立的设备转换为智能网络设备，从而可以实现控制和无线监测。如下图中是一些采用Z-Wave的产品。
每一个Z-Wave网络都拥有自己独立的网络地址(HomeID);网络内每个节点有其地址(NodeID)，由控制节点(Controller)分配在节点入网时分配。如下图：
图片 Z-Wave设备入网过程图
（来源
）
ZWave网络中有两种节点主控设备（Primary
Controller）、从设备（Slave）。主控设备的HomeID是出厂就已经设定好的，并且NodeID通常都是0x01，用户无法改变。从设备的HomeID和NodeID在入网前都未初始化，如下表：
举个例，注意下图中的从设备（slave）在加入网络之前homeID和nodeID均为0
下图是当从设备加入网络后Slave已经获得了homeID和nodeID
所以不难想象除了主控设备例外，Z-Wave设备的HomeID和NodeID不能用于唯一识别一个物理设备，因为一个从设备可以加入不同的网络（入网在ZWave术语中叫inclusion
）从而得到不同的homeID和nodeID。
一篇非常有参考价值的文章：
Z-Wave每个网络最多容纳232个节点(Slave)，包括控制节点在内。控制节点可以有多个，但只有一个主控制节点，即所有网络内节点的分配，都由主控制节点负责，其他控制节点只是转发主控制节点的命令。已入网的普通节点，所有控制节点都可以控制。超出通信距离的节点，可以通过控制器与受控节点之间的其他节点，即路由(Routing)的方式完成控制。
Z-Wave 有一种命令可以用来请求节点信息帧NIF（Node Information Frame
参考http://blog.csdn.net/junglefly/article/details/53184484），或许可以用来识别设备。
最重要的一点是Z-Wave和ZigBee设备一样在实际的应用场景中经常会通过一个网关来接入互联网，实现远程控制，这就引起了物联网设备被远程控制或者被作为攻击入口的可能性！
可以用于Z-Wave抓包分析或者发送Z-Wave包的一些工具
OpenZWave
**最后比赛结果**
大年初一收到一封邮件说比赛结果公布了，如下
激动地发现我居然不出所料地没有拿第一名，不过值得庆幸的是没有白做，上了Leaderboard排行榜。
全球130个参赛队，得了第六名，而且由于报名时间晚，为期2个月大比赛我只有6天，所以当在榜单上看见Selfighter的ID时还是非常满意的。
看到Selfighter这个ID只是我个人的ID，其实是由于对比赛背景不了解，所以我们部门就先派我去当小白鼠试试水。
**往届比赛简介**
**MITRE反无人机挑战赛**
官网信息：
关于比赛的一片中文报道
个人认为比较有意思的几个比赛入围成果介绍
**Skywall 100**
官网： 
视频：
**DroneTracker**
官网： 
视频： 
中文介绍：
**MESMER**
官网及视频
**总结 &展望**
在我写这篇文章的时候RSA大会正在美国举行，对于企业安全产品厂商来说这可以说是全球最重要逼格最高的行业大会了，所以很多安全企业漂洋过海去参展/参会，RSA大会能够一定程度反映安全行业的动态。独角兽团队的会棍老大杨卿也去参会了，还写了一篇参(liao)会(mei)经历，（感兴趣的童鞋可以看看http://mp.weixin.qq.com/s/Bc0cGblm7Vl0n-r60y4K6Q
）
在他这篇文章中我看到2张图片
可以看到这家企业展示的方案不正是IoT设备的检测识别方案吗！
MITRE去年的比赛题目是对抗无人机，比赛过程涌现出的那些idea可能早已应用于美国国防，而过去的这一年我们看到了很多无人机造成的安全事件相关新闻，有用无人机扔炸弹的、偷拍的、造成航班延误的、甚至用无人机作为中继进行渗透测试的，所以无人机已经作为一种安全隐患受到全球关注。我们团队的无线入侵检测产品天巡也将会加入无人机检测及对抗功能，下图
综上所述，MITRE作为一个与美国政府有合作的巨型企业，提出的比赛题目都是和国防有关的具有前瞻性的课题，虽然参赛者们的研究出的方案IP归研究者所有，但是这并不能阻止他们将这些研究成果应用于美国的国防等领域，或者从参赛者的方案中寻求灵感，一场比赛结束或许就意味着他们的某个技术难题被解决。
**致谢**
感谢独角兽团队提供地研究环境，祝我的团队越来越强大。
特别感谢团队同事杨卿、黄琳、曾颖涛、张婉桥等怪人的帮助。
**作者**
李均(selfighter)，360独角兽安全团队安全研究员。