title:Medical Protocol Security: DICOM Vulnerability Mining Based on Fuzzing
Technology
author:Zhiqiang Wang and
Quanqi Li and
Yazhe Wang and
Biao Liu and
Jianyi Zhang and
Qixu Liu
Poster—Medical Protocol Security: DICOM Vulnerability Mining
Based on Fuzzing Technology
Zhiqiang Wang
1.Beijing Eletronic Science and Technology Institute
2.State Key Laboratory of Cryptology
3.State Information Center
Beijing, China
PI:EMAIL
Biao Liu∗
Jianyi Zhang†
Beijing, China
PI:EMAIL
PI:EMAIL
Beijing Eletronic Science and Technology Institute
Quanqi Li
Yazhe Wang
Beijing Eletronic Science and Technology Institute
Beijing, China
PI:EMAIL
Key laboratory of network assessment technology of
Institute of Information Engineering, Chinese Academy of
Qixu Liu
Sciences
Beijing, China
PI:EMAIL
ABSTRACT
DICOM is an international standard for medical images and related
information, and is a medical image format that can be used for
data exchange. The agreement is widely used in medical fields such
as radiology and cardiovascular imaging. However, since DICOM
libraries have less security considerations in protocol implemen-
tation, they have a large number of security risks. Aiming at the
security issue of DICOM libraries, the paper conducts research on
vulnerability mining technology for DICOM open source libraries,
proposes a vulnerability mining framework based on Fuzzing tech-
nology, and implements a prototype system named DICOM-Fuzzer,
which includes initialization, test case generation, automatic test,
exception monitoring and other modules. Finally, the open source
library DCMTK was selected for testing, and it was found that data
overflow would occur when the content of the received file was
greater than 7080 lines. Found that there is a vulnerability that
causes the PACS system to refuse service. In conclusion, the DI-
COM protocol does have risks, and its information security needs
to be further improved.
CCS CONCEPTS
• Security and privacy → Security protocols.
KEYWORDS
DICOM; Fuzzing; PACS; Medical information security
∗Corresponding Author, Biao Liu(PI:EMAIL)
†Corresponding Author, Jianyi Zhang(PI:EMAIL)
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the Owner/Author.
CCS ’19, November 11–15, 2019, London, United Kingdom
© 2019 Association for Computing Machinery.
ACM ISBN 978-1-4503-6747-9/19/11...$15.00
https://doi.org/10.1145/3319535.3363253
1 INTRODUCTION
At present, medical equipment and related information systems
are characterized by intelligence, mobility, and networking. Due
to the lack of safety awareness among medical device manufactur-
ers in the research and development process, the digitization and
informatization of medical devices has brought a large number of
security risks[7].
DICOM (Digital Imaging and Communications in Medicine) is
the international standard for medical images and related informa-
tion (ISO 12052). It is the basis of all medical imaging techniques
and defines a medical image format whose quality can meet clinical
needs and can be used for data exchange. It can be understood
as the format of medical digital image communication. DICOM is
widely used in radiology, including cardiovascular imaging and
diagnostic equipment for radiology (X-ray, CT, MRI, ultrasound,
etc.)[6]. However, since DICOM did not consider communication
security at the beginning of design, the digitization and informati-
zation of medical equipment introduced a large number of security
threats and hidden dangers. Therefore, in the face of increasing
security threats and challenges, it is urgent to conduct research on
the security of medical equipment[4].
The main contributions of this article are as follows:
1. A framework of DICOM vulnerability mining based on Fuzzing
technology is proposed for the first time.
2. The prototype system DICOM-Fuzzer, implemented in this
paper can realize the automatic testing of PACS system and monitor
anomalies in time.
3. Summarize the experimental test results, give the influence
scope and defense suggestions, and analyze the future research
directions.
2 ARCHITECTURE AND DESIGN
The system architecture we designed mainly includes three core
modules: test case construction module, DICOM test module and
abnormal monitoring module, which are described as follows.
PosterCCS ’19, November 11–15, 2019, London, United Kingdom25492.1 System Architecture
The system architecture generally includes six modules, the sys-
tem initialization module, the test case construction module, the
DICOM protocol test module, the abnormality monitoring module,
the abnormality verification module, and the log output module.
The system core architecture is shown in Figure 1.
application security testing. The principle is to send test data of
a specific format error to the target through the Socket API and
monitor the exceptions that occur in the target[1]. Different from
other research fuzzing tests, this paper, a combination of generated
test case construction and artificial construction strategy is adopted,
and automatic generation and testing functions are realized. The
testing process can be roughly divided into five steps. Figure 2
shows the general testing process for Fuzzing.
Figure 1: Architecture of DICOM vulnerability mining sys-
tem.
The system initialization module is responsible for configuring
the environment required for operation. The test case construction
module USES various types of construction strategies to construct
test case data. The DICOM test module sends the constructed DI-
COM files to the DICOM system to be tested. The anomaly moni-
toring module catches and monitors the test process and analyzes
the feedback data concretely. Exception validation module is to
re-validate the monitored exception. The log output module mainly
records the abnormal information that may be generated during
the test.
2.2 Test Case Construction Strategy
The construction strategy adopts the test case construction method
based on Fuzzing technology. Fuzzing technology is an automated
software testing technology that discovers vulnerabilities by in-
putting a large amount of malformed data to the target and monitor-
ing its anomalies. Which is one of the important means of exploiting
vulnerabilities[5]. The test case construction strategy is divided into
three types: automatic random construction based on generation,
analysis structure based on mutation, and artificial structure.
In the absence of effective test cases. Based on the analysis of the
vulnerability of DICOM protocol, this paper chooses the automatic
random construction based on generation (the advantages are low
cost, high degree of automation) and artificial construction strategy
(targeted strong) to construct test cases.
2.3 DICOM Test
PACS is the abbreviation of Picture Archiving and Communication
Systems. The main task is to store various medical images generated
daily in a digital way through various interfaces. When needed, it
can be quickly recalled under certain authorization. At the same
time, add some auxiliary diagnostic management functions.
The purpose of the protocol fuzzing test is to test whether various
network protocols or related applications have security vulnerabil-
ities. The Fuzzing test is a well-known black box technology for
Figure 2: Test program flow chart.
2.4 Abnormal Monitoring
The anomaly monitoring in this paper mainly uses two methods,
including Wireshark monitoring and manual monitoring.
Wireshark is the world’s foremost and widely-used network
protocol analyzer. It lets you see what’s happening on your network
at a microscopic level and is the de facto (and often de jure) standard
across many commercial and non-profit enterprises, government
agencies, and educational institutions.
In addition, we also use manual monitoring to monitor possi-
ble abnormal results. The advantages are high identification and
reliability.
3 EXPERIMENT
This paper selects DCMTK open source library for DICOM vul-
nerability mining test, and introduces methods such as test case
construction, fuzzy test and abnormal monitoring.
3.1 DCMTK Library
DCMTK is a collection of libraries and applications implementing
large parts the DICOM standard. It includes software for examining,
constructing and converting DICOM image files, handling offline
media, sending and receiving images over a network connection,
as well as demonstrative image storage and worklist servers[2]. In
order to verify the validity of the fuzzy analysis method based on
Fuzzing technology proposed in this paper, we choose DCMTK3.5.4–
DICOM open source protocol library for test analysis.
Generation StrategiesSystem InitializationDICOM TESTSystem LogDICOM SystemConfigure Environment VariablesAbnormal MonitoringAcceptance testSend TestAbnormal ValidationMutation StrategiesTest case constructionManual Craft StrategiesArtificial MonitoringWireshark MonitoringNConfigurationSend Test CasesSelect the TargetOutputLog RecordEndAbnormaly(cid:971)Abnormal ValidationContinue(cid:971)YConstruct Test DataPosterCCS ’19, November 11–15, 2019, London, United Kingdom25503.2 DCMTK Test
The test is based on the analysis of the DICOM protocol, in addition
to the basic programming language knowledge of the file read and
write, loop, socket, random number.
In the process of fuzzing, through Socket programming to receive
and send data. So, one computer can accept data of other computers,
and can also send data to other computers. Finally, check that the
SCU successfully sends the DICOM file to the SCP, and the SCP
side successfully receives it. The port selected by the SCU is 104,
and the IP address is selected as 127.0.0.1.
4 RESULTS AND ANALYSIS
After repeated testing and construction of various types of test
cases to test the system, a lot of data packets are generated, there
are valid inputs and many invalid inputs. One of the more typical
input data packets was selected for testing.
Figure 3: Test run results.
As shown in Figure 3, the abnormality of the system error is
successfully detected during the fuzzy test. After the test file is
successfully sent to the server, it is found that the server that has
been opened automatically stops working, the system crashes and
the SCP stops working. In the process of testing and running, the
Wireshark software is used for packet capture and monitoring
analysis.As shown in Figure 4.
Figure 4: Wireshark monitoring.
Through the packet capture analysis, it can be seen that the
DICOM file has been transmitted, the DICOM file has been sent
from the client to the server, and then the server crashes, which
can basically determine the problem caused by the constructed test
case.
The experiment is the first to design and test the Fuzzing vulner-
ability mining framework for DICOM protocol. This experiment
verifies the vulnerability mining framework proposed in Section 2.1.
After sending nearly 1000 carefully constructed test cases, it was
found that when the data in the constructed data packet is larger
than 8070 lines, the system will crash, and Preliminary analysis of
the causes of system crash is the oversize DICOM packet and data
overflow. Developers are advised to check the length of the data
during software development[3]. Avoid problems such as PACS
system denial of service, be attacked, process crash, downtime, etc.
due to vulnerabilities, and improve system robustness.
5 SUMMARY AND FUTURE DIRECTION
The results show that the DICOM protocol has a large potential
security problem. When a large number of users’ personal medical
information is stored, the information confidentiality and integrity
are not well provided, and there is still much room for improvement
in system robustness. In general, the overall framework of this ar-
ticle and the method of exploiting vulnerabilities using Fuzzing
technology are useful attempts to exploit DCIOM protocol vulner-
abilities. In the current situation of network security, especially
the increasingly serious security situation in the medical field, the
results of vulnerability mining of DICOM protocol in this paper
can provide security requirements such as information integrity
and system robustness for medical device developers in system
development. Therefore, strive to reduce the possible security risks
of the DICOM agreement. To improve the security of DICOM pro-
tocol more comprehensively, more vulnerabilities should be found.
In the face of a large amount of data and a cumbersome situation,
the use of artificial intelligence techniques such as generating a
counter-network to help is a problem worth solving.
ACKNOWLEDGMENTS
The authors would also like to thank the anonymous referees for
their valuable comments and helpful suggestions. This research
was financially supported by the National Key Research and Devel-
opment Plan (2018YFB1004101), Key Lab of Information Network
Security, Ministry of Public Security (C19614), Special fund on edu-
cation and teaching reform of Besti (jy201805), the Fundamental
Research Funds for the Central Universities(328201804, 328201910),
key laboratory of network assessment technology of Institute of
Information Engineering, Chinese Academy of Sciences.
REFERENCES
[1] Duggal A. 2017. HL7 2.X Security. In The 8th Annual HITB Security Conference.
[2] Mike Aizatsky, Kostya Serebryany, Oliver Chang, Abhishek Arya, and Mered-
ith Whittaker. 2016. Announcing oss-fuzz: Continuous fuzzing for open source
software. Google Testing Blog (2016).
[3] Chen Chen, Baojiang Cui, Jinxin Ma, Runpu Wu, Jianchao Guo, and Wenqian Liu.
2018. A systematic review of fuzzing techniques. Computers & Security 75 (2018),
118–137.
[4] Akram Farhadi and Maryam Ahmadi. 2013. The Information Security Needs in
Radiological Information Systems—an Insight on State Hospitals of Iran, 2012.
Journal of digital imaging 26, 6 (2013), 1040–1044.
[5] Shuitao Gan, Chao Zhang, Xiaojun Qin, Xuwen Tu, Kang Li, Zhongyu Pei, and
Zuoning Chen. 2018. Collafl: Path sensitive fuzzing. In 2018 IEEE Symposium on
Security and Privacy (SP). IEEE, 679–696.
[6] Eichelberg M Onken M. 2011. Digital Imaging and Communications in Medicine.
Digital Imaging and Communications in Medicine (DICOM).
[7] Food US and Administration Drug. 2013. Content of premarket submissions for
management of cybersecurity in medical devices: draft guidance for industry and
food and drug administration staff. Retrieved May 1 (2013), 2014.
PosterCCS ’19, November 11–15, 2019, London, United Kingdom2551