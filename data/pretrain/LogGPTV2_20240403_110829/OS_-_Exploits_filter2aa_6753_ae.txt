    - [maxpl0it/CVE-2020-1350-DoS](https://github.com/maxpl0it/CVE-2020-1350-DoS)
    - [chompie1337/SIGRed_RCE_PoC](https://github.com/chompie1337/SIGRed_RCE_PoC)
**CVE-2020-16898**
- 相关文章
    - [CVE-2020-16898 Windows tcp/ip远程代码执行漏洞复现](https://mp.weixin.qq.com/s/Z8fSNueOWutMzIV56iUarw)
    - [CVE-2020-16898：Windows TCP/IP远程代码执行复现](https://mp.weixin.qq.com/s/RTdkBbXWdzIBFpExZszQkg)
**CVE-2021-31166**
- 相关文章
    - [漏洞描述|CVE-2021-31166 POC](https://mp.weixin.qq.com/s/YdBjOsXhYcPbF_jMuTl2Xg)
- POC | Payload | exp
    - [0vercl0k/CVE-2021-31166](https://github.com/0vercl0k/CVE-2021-31166) - Proof of concept for CVE-2021-31166, a remote HTTP.sys use-after-free triggered remotely.
**CVE-2022-21907**
- POC | Payload | exp
    - [p0dalirius/CVE-2022-21907-http.sys](https://github.com/p0dalirius/CVE-2022-21907-http.sys)
---
### 域
**Windows Access Token 令牌假冒**
当用户注销后，系统将会使主令牌切换为模拟令牌，不会将令牌清除，只有在重启机器后才会清除。
可以使用多种工具查看目前系统上存在的模拟令牌:
- Incognito
- Powershell - Invoke-TokenManipulation.ps1
- Cobalt Strike - steal_token
- MSF Moudle
    ```
    getsystem
    load incognito meterpreter > list_tokens -u
    impersonate_token "PAYLOADS\\Administrator”
    ```
**MS14-025**
- 相关文章
    - [Exploiting "Group Policy Preferences" AKA MS14-025 in windows environment to gain Admin user password.](https://github.com/incredibleindishell/Windows-AD-environment-related/blob/master/Exploiting-GPP-AKA-MS14_025-vulnerability/README.md)
    - [Hack The Box - Active](https://www.jaiminton.com/HTB/Active/)
    - [MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege: May 13, 2014](https://support.microsoft.com/en-us/help/2962486/ms14-025-vulnerability-in-group-policy-preferences-could-allow-elevati)
**MS14-068 & CVE-2014-6324**
- 简介
    ms14-068 漏洞是 KDC 服务中的 Windows 漏洞，是由 PAC 认证错误引起，导致域内普通用户可以在 Kerberos TGT 中加入伪造的凭据，从域用户提升到域管理员权限。在执行 ms14-068 漏洞之前，需要通过 systeminfo 看目标机器是否打补丁 kb3011780，如果没打就可以尝试使用该方法进行域提权。
- 影响版本
    - Windows 7 SP1
    - Windows 8.1
    - Windows RT 8.1
    - windows vista
    - Windows Server 2003 SP2
    - Windows Server 2008 SP2
    - Windows Server 2008 R2 SP1
    - Windows Server 2012
    - Windows Server 2012 R2
- 相关文章
    - [MS14-068域权限提升漏洞总结](https://xz.aliyun.com/t/218)
- POC | Payload | exp
    - [windows-kernel-exploits/MS14-068/](https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068)
    - [abatchy17/WindowsExploits/blob/master/MS14-068/MS14-068.exe](https://github.com/abatchy17/WindowsExploits/blob/master/MS14-068/MS14-068.exe)
        登录普通域用户 whoami/user 获取 sid
        退出域用户，登录本地用户
        ```bash
        MS14-068.exe -u PI:EMAIL -s S-1-5-21-1218902331-2157346161-1782232778-1124 -d 192.168.1.1 -p Admin123
        # -u 域账号+@+域名称
        # -s 为 ts1 的 SID 值，可以通过 whoami/all 来获取用户的 SID 值
        # -d 为当前域的域控
        # -p 为当前用户的密码，即 ts1 的密码
        ```
        接下来将导出生成一张 kerberos 票据，配合 mimikatz 的 ptt 功能，将票据导入到内存中
        使用 mimikatz 将票据注入到当前内存中，伪造凭证，如果成功则拥有域管理权限，可任意访问域中所有机器
        ```bash
        kerberos::purge                 # 清空当前机器中所有凭证，如果有域成员凭证会影响凭证伪造
        kerberos::list                  # 查看当前机器凭证
        kerberos::ptc [ccachefile]      # 将票据注入到内存中
        可以使用 net use \\域控名\C$ 尝试访问域控
        也能执行 psexec
        PsExec64.exe -accepteula \\域控名 -s cmd /c "whoami /all"
        ```
**CVE-2019-1040 Windows NTLM 篡改漏洞**
- 简介
    使用中继的 LDAP 身份验证，为攻击者帐户授予 DCSync 权限。攻击者帐户使用 DCSync 转储 AD 中的所有密码哈希值。
    也可以将目标服务器的基于资源的约束委派权限授予攻击者控制下的计算机帐户。攻击者作为受害者服务器上的任何用户进行身份验证。
- 相关文章
    - [结合CVE-2019-1040漏洞的两种域提权深度利用分析](https://www.freebuf.com/vuls/207399.html)
    - [Cve 2019 1040 Intranet Killer](https://syst1m.com/post/cve-2019-1040-intranet-killer/)
- POC | Payload | exp
    - [Ridter/CVE-2019-1040: CVE-2019-1040 with Exchange](https://github.com/Ridter/CVE-2019-1040)
    - [fox-it/cve-2019-1040-scanner](https://github.com/fox-it/cve-2019-1040-scanner)
    - [Ridter/CVE-2019-1040-dcpwn](https://github.com/Ridter/CVE-2019-1040-dcpwn)
    - [QAX-A-Team/dcpwn](https://github.com/QAX-A-Team/dcpwn)
**CVE-2020-1472 zerologon**
- 相关文章
    - [Netlogon域控提权(CVE-2020-1472)](https://mp.weixin.qq.com/s/eDbZZFflb0_8ZYhQcudJXg)
    - [CVE-2020-1472 windows域控提权 zerologon从搭建到复现](https://mp.weixin.qq.com/s/G_umJghOS4DXBNEhkDYeWg)
    - [Hijacking a Domain Controller with Netlogon RPC (aka Zerologon: CVE-2020-1472) | Trustwave](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/hijacking-a-domain-controller-with-netlogon-rpc-aka-zerologon-cve-2020-1472/)
    - [林级域环境下复现 CVE-2020-1472](https://0x20h.com/p/9b5.html#%E7%8E%AF%E5%A2%83)
    - [CVE-2020-1472域内提权漏洞利用](https://mp.weixin.qq.com/s/udhDpRK7xNc06cjyY1Xhpw)
    - [ZeroLogon(CVE-2020-1472) 分析与狩猎](https://mp.weixin.qq.com/s/Z0aXYBJiJnIkcr12A_jeuQ)
    - [White Paper: Understanding and Exploiting Zerologon](https://sidb.in/posts/zerologon/)
- 影响版本
    - Windows Server 2008
    - Windows Server 2012
    - Windows Server 2016
    - Windows Server 2019
- POC | Payload | exp
    - [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472) - 漏洞检测
    - [dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472) - 漏洞利用\环境恢复
    - [VoidSec/CVE-2020-1472](https://github.com/VoidSec/CVE-2020-1472)
    - [mimikatz](../../安全工具/mimikatz.md#zerologon)
**CVE-2021-1675 && CVE-2021-34527**
- 描述
    利用该漏洞，攻击者可以使用一个低权限用户（包括匿名共享 guest 账户），对本地网络中的电脑发起攻击，控制存在漏洞的电脑。尤其在企业内部，在域环境中，普通域用户，可以通过该服务，攻击域控服务器，从而控制整个网络。
- 相关文章
    - [CVE-2021-1675](https://mp.weixin.qq.com/s/V0acZgnqXS4NYAVdO2m3Cg)
    - [Windows Print Spooler服务最新漏洞CVE-2021-34527详细分析](https://mp.weixin.qq.com/s/8qDQUu6FNpNjX1tY1KrAoQ)
    - [CVE-2021-1675 漏洞复现](https://mp.weixin.qq.com/s/mdEMyl_w2pEfvDhKDQi99A)
- POC | Payload | exp
    - [cube0x0/CVE-2021-1675](https://github.com/cube0x0/CVE-2021-1675)
    - [afwu/PrintNightmare](https://github.com/afwu/PrintNightmare)
    - [hlldz/CVE-2021-1675-LPE](https://github.com/hlldz/CVE-2021-1675-LPE)
    - [3gstudent/Invoke-BuildAnonymousSMBServer](https://github.com/3gstudent/Invoke-BuildAnonymousSMBServer) - 启匿名 smb
    - [mstxq17/CVE-2021-1675_RDL_LPE](https://github.com/mstxq17/CVE-2021-1675_RDL_LPE) - cs插件
**NoPac && CVE-2021-42287 && CVE-2021-42278**
- 相关文章
    - [CVE-2021-42287/CVE-2021-42278 Weaponisation](https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html)
    - [CVE-2021-42287/CVE-2021-42278 域内翻身做主人](https://mp.weixin.qq.com/s/Z3mI5eEc8-iudqdU7EZ3EQ)
    - [CVE-2021-42287复现](https://mp.weixin.qq.com/s/OI9XiUGe4-1exmFOkV9ZVQ)
    - [“域渗透”NoPac在MAQ=0时的利用](https://mp.weixin.qq.com/s/CWWu0Fs6p2GOyUstdymLrg)
- POC | Payload | exp
    - [cube0x0/noPac](https://github.com/cube0x0/noPac)
        ```
        # 扫描探测
        .\noPac.exe scan -domain test.local -user test -pass 'Abcd1234!@'
        # 直接利用
        .\noPac.exe -domain test.local -user test -pass 'Abcd1234!@' /dc dc.test.local /mAccount test123 /mPassword passW0rd /service cifs /ptt
        ```
    - [WazeHell/sam-the-admin](https://github.com/WazeHell/sam-the-admin)
---
### 其他
**CVE-2018-8420 Msxml 解析器的远程代码执行漏洞**
- POC | Payload | exp
    - [Lz1y/CVE-2018-8420](https://github.com/Lz1y/CVE-2018-8420)
**CVE-2020-0601**
- POC | Payload | exp
    - [ollypwn/CVE-2020-0601](https://github.com/ollypwn/CVE-2020-0601)
    - [kudelskisecurity/chainoffools](https://github.com/kudelskisecurity/chainoffools)
#### 物理接触
**CVE-2020-1398**
- 相关文章
    - [BitLocker Lockscreen bypass](https://secret.club/2021/01/15/bitlocker-bypass.html) - 通过粘贴键+讲述人 bypass windows bitlocker锁屏
#### DOS
**condrv.sys内存损坏漏洞**
- 相关文章
    - [【更新】深信服EDR快速响应支持防护Windows condrv.sys内存损坏漏洞](https://mp.weixin.qq.com/s/QhGYn6wPquSY6obvjgt8VQ)
    - [Windows 10 bug crashes your PC when you access this location](https://www.bleepingcomputer.com/news/security/windows-10-bug-crashes-your-pc-when-you-access-this-location/)
**CVE-2020-16899**
- 相关文章
    - [CVE-2020-16899: Windows TCP/IP拒绝服务漏洞](https://mp.weixin.qq.com/s/gcQZCfO7EI4hKTdXboPTnA)
**CVE-2021-24086**
- POC | Payload | exp
    - [0vercl0k/CVE-2021-24086](https://github.com/0vercl0k/CVE-2021-24086)
---
## FreeBSD
**CVE-2013-2171**
- POC | Payload | exp
    - [FreeBSD 9.0 < 9.1 - 'mmap/ptrace' Local Privilege Escalation - FreeBSD local Exploit](https://www.exploit-db.com/exploits/26368)
---
## OpenBSD
**CVE-2019-19726  OpenBSD 提权**
- 简介
    OpenBSD 是加拿大 OpenBSD 项目组的一套跨平台的、基于 BSD 的类 UNIX 操作系统。
    OpenBSD 6.6 及之前版本中存在安全漏洞。本地攻击者可利用该漏洞将权限提升至 root，进而以该权限执行自己的库代码。
- 影响版本
    - Openbsd:Openbsd:-:*:*:*
    - Openbsd:Openbsd:2.0:*:*:*
    - Openbsd:Openbsd:2.1:*:*:*
    - Openbsd:Openbsd:2.2:*:*:*
    - Openbsd:Openbsd:2.3:*:*:*
- POC | Payload | exp
    - [Local Privilege Escalation in OpenBSD's dynamic loader (CVE-2019-19726)](https://www.qualys.com/2019/12/11/cve-2019-19726/local-privilege-escalation-openbsd-dynamic-loader.txt)
---
## Solaris
**CVE-2020-14724**
- POC | Payload | exp
    - http://www.vapidlabs.com/advisory.php?v=212
    - https://github.com/lcashdol/Exploits/tree/master/ddu-exploit
**CVE-2020-14871**
- 简介
    2018 年底，FireEye 子公司 Mandiant 的 FLARE AdvancedPractices 团队，在追踪 UNC1945 团体的活动时发现该团体在一台 Oracle Solaris 操作系统上安装了一个被称为 SLAPSTICK 的后门，用以捕获连接详细信息和身份凭证。转眼间到了 2020 年中旬，Mandiant 观察到 UNC1945 团体在 Oracle Solaris9 服务器上部署了称为 EVILSUN 的远程利用工具。[2] 通过分析发现该工具利用 Oracle Solaris Pluggable Authentication Module (可插拔身份验证模块，简称 PAM) 的基于堆栈的缓冲区溢出漏洞获取最高系统权限。FLARE 小组的进攻性特遣队（OffensiveTask Force）分析了此漏洞以确定其工作方式，并在不同版本的 Solaris 系统上重现了漏洞，然后将其报告给 Oracle。
- 相关文章
    - [Live off the Land? How About Bringing Your Own Island? An Overview of UNC1945](https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html)
    - [一个被忽视的满分好洞-Solaris SSHD Remote Root Exploit](https://mp.weixin.qq.com/s/K-CYzhuo4n76WBerkEWQ_w)
- MSF 模块
    ```bash
    solaris/ssh/pam_username_bof
    ```