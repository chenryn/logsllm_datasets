achieving an accuracy of 94%. DAI attacks are performed
based on the inferred home configuration.
B. Validation of Attacks
We present the methodology and results for validating the
DAI attacks in the two testbeds.
1) Methodology: To ease the validation, we ask the testbed
members to assist in triggering the automation rules by behav-
ing in controlled patterns. The given instructions incorporate
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:33:31 UTC from IEEE Xplore.  Restrictions apply. 
8292
TABLE II: IoT devices and their connections to platforms in T1 and T2. d-ID: device ID. Acronyms: SmartThings (ST), Philips Hue (PH).
d-ID
Device
–
–
–
–
–
1
2
3 4
5 6
7 - 9
10 11
12 13
14
15 - 19
20
21
22
23
24
25
SmartThings hub
Apple HomePod2
Aqara hub
Philips Hue bridge
Alexa Echo Dot
Aqara Mini switch
First Alert smoke sensor
SmartThings outlet
Wemo smart plug
PH motion sensor
ST multipurpose sensor
Kwikset door lock
VOCOlinc humidifier
Philips Hue bulb
Eve Energy triple outlet3
Garadget door opener
ST water sensor
WeMo smart plug
WeMo smart plug
PH motion sensor
Testbed T1
Connection Path to Platform1
• ⇌ST cloud
• ⇌iCloud
• ⇌Aqara Cloud; • ⇌HomePod
• ⇌PH cloud; • ⇌HomePod
• ⇌Alexa Cloud
• ⇌Aqara hub⇌HomePod
• ⇌ST hub⇌ST cloud; • ⇌ST hub⇌Homebridge⇌HomePod
• ⇌ST hub⇌ST cloud
• ⇌WM cloud⇌Alexa cloud;
• ⇌ST hub⇌ST cloud
• ⇌ST hub⇌ST Cloud; • ⇌ST hub⇌Homebridge⇌HomePod
• ⇌ST hub⇌ST cloud
• ⇌ST hub⇌ST cloud
• ⇌HomePod
• ⇌PH bridge⇌HomePod;
• ⇌PH bridge⇌ST hub⇌ST cloud⇌Alexa cloud
• ⇌HomePod
• ⇌Garadget cloud⇌ST cloud;
• ⇌Garadget cloud⇌ST cloud⇌ST hub⇌Homebridge⇌HomePod
• ⇌ST hub⇌ST cloud
• ⇌HomePod
• ⇌ST hub⇌ST cloud
• ⇌PH bridge⇌HomePod
d-ID
–
–
–
–
1
2
3
4
5 - 7
8
9 - 11
12
13 - 15
15
16
17
18
19
20
21
Testbed T2
Device
SmartThings hub
Philips Hue bridge
Apple HomePod
Alexa Echo Flex
ST presence sensor4
Kwikset door lock
Arlo Essential camera
PH motion sensor
PH motion sensor
PH motion sensor
Philips Hue bulb
WeMo smart plug
WeMo smart plug
WeMo smart plug
VOCOlinc humidifier
WeMo smart plug
First Alert smoke sensor
WeMo smart plug
ST motion sensor
ST multipurpose sensor
4 Carried with a person.
Connection Path to Platform
• ⇌ST cloud
• ⇌PH cloud
• ⇌iCloud
• ⇌Alexa Cloud
• ⇌ST hub⇌ST cloud
• ⇌ST hub⇌ST cloud⇌Alexa cloud
• ⇌Arlo cloud⇌ST cloud
• ⇌ST hub⇌ST Cloud
• ⇌ST hub⇌ST Cloud;
• ⇌ST hub⇌Homebridge⇌HomePod
• ⇌PH bridge⇌HomePod
• ⇌PH bridge⇌ST hub⇌ST Cloud;
• ⇌PH bridge⇌PH cloud⇌Alexa Cloud
• ⇌HomePod
• ⇌ST hub⇌ST cloud; • ⇌HomePod
• ⇌ST hub⇌ST cloud⇌Alexa cloud
• ⇌HomePod
• ⇌ST Hub⇌ST cloud
• ⇌ST hub⇌ST cloud;
• ⇌ST hub⇌Homebridge⇌HomePod
• ⇌HomePod
• ⇌ST hub⇌ST cloud
• ⇌ST hub⇌ST cloud
1 • denotes the device itself. For simplicity, router is omitted in the connection path.
on iCloud.
3 Connected by a smart heater switch 3 , a non-smart microwave and a non-smart oven.
2 HomePod is the hub of HomeKit. HomeKit automations run on HomePod, not
(a) T1
(b) T2
Fig. 11: The floor plans and device placement in the two testbeds,
T1 and T2. For brevity, personal devices (e.g., smartphones, tablets,
laptops) and IoT hubs are not marked in the floor plans.
certain daily activities such as leaving/entering home through
the garage door, entering a specific room, etc. In particular,
when triggering Rules 14, 15 in T1 and Rules 8, 9 in T2, which
are triggered by smoke or water leaks, we ask the testbed
members to physically trigger the smoke and water sensors
in a safe manner. Also, due to the physical restrictions on
installing the water valve and sprinkler in the testbeds, we
use these rules to control smart switches instead of the real
water valve and sprinkler. Although the victim rules are being
triggered by the testbed members, our attack script runs to
attack the victim rules by delaying the actual device events
(e.g., smoke) or commands (see Table IV). To obtain the
ground truth for validating if the attacks are successful, we
repeat the above process for two days. On the first day, we
set the delay period to 0 for all events and commands, i.e.,
no attacks are conducted. On the second day, we perform
DAI attacks by setting some specific time periods to delay
the target event or command of the victim rules. We collect
the event and command logs for analyzing automation results.
The automation result on the first day is used as the ground
truth for comparison. We compare the automation result of
each pair of victim rules on the second day (with attack) with
those from the first day (without attack). If the results are the
same, the rules are not attacked on the second day. Otherwise,
the rules may be attacked. To confirm, we manually check
whether the automation result on the second day is consistent
with the expected attack result; if so, the attack is validated.
that can access and export
Device Logs. Device logs are needed to evaluate the
correctness of
automation. Among the nine platforms
deployed in the testbeds, three of them (i.e., SmartThings,
HomeKit, and Alexa) are used as non-endpoint platforms
which have access to a broader
range of device types.
Alexa does not provide a convenient logging tool. Therefore,
we choose to use the built-in logging functions on the
SmartThings mobile app and on a third-party mobile app,
Home+ 4,
the HomeKit data.
Since the Alexa devices in the two testbeds can be accessed
by SmartThings and/or HomeKit, all device events in the
testbeds can be collected by at least one of the two methods.
Note that we do not collect logs of hub devices since they are
not used in automation rules. For the convenience of analysis,
we convert the raw event logs from the SmartThings and
Home+ 4 apps, denoted as EST , EHK, to a uniform format.
Each element (event) in the reformatted logs is a tuple:
⟨TestbedID, DeviceID, Attribute, Value, Timestamp⟩,
where
of TestbedID, DeviceID,
Attribute and Value uniquely identifies an event type.
For example, a motion active event sent by device 7 in
testbed T1 can be denoted as ⟨1, 7 , motion, active⟩. An event
type may have multiple instances at different Timestamps.
The new event
log is sorted by Timestamp. Note that
the timestamps of events are the time instances when the
platforms receive the events, which may have been delayed
by an attack. This is the reason why we use events on the
first day, in the absence of attacks, as ground truth. Based on
the event logs EST and EHK on both days, we can easily
track the execution of rules as in existing work [26], [51].
combination
the
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:33:31 UTC from IEEE Xplore.  Restrictions apply. 
9293
Testbed RID
T1
T2
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
TABLE III: Installed rules in all testbeds. RID: rule ID.
Rule Description and Device Binding
When 6pm, if motion 7 is active in living room, turn on the ceiling light 16 .
When 6pm, if no motion 7 in living room, toggle ceiling light 16 every 15 minutes to simulate occupancy. Press an app button to stop.
When the hall door 11 is closed, if the home is in away mode, close garage door 21 , turn on outlets 4 5 6 and set to home mode.
When the hall door 11 is closed, if the home is in home mode, open the garage door 21 .
When the button 1 is pressed, set to away mode.
When the user (smartphone as presence sensor) leaves, if the home is in away mode, close the garage door 21 .
When the garage door 21 is closed, if the home is in away mode, lock the front door 12 and hall door 13 .
When kitchen time (12pm, 7pm), if motion 9 is active in the kitchen, turn on the heater switch 3 .
When power 20 exceeds 2500W, if motion 7 - 9 is inactive in all rooms, turn off the outlet 20 .
When the front door 10 is opened, if the home is in away mode, turn on outlets 4 5 6 and set to home mode.
When motion 7 is detected in living room, turn on the humidifier 14 , ceiling lamp 16 and floor lamp 15 .
When motion 8 is detected in bedroom, if luminance 25 is below 15 lux, turn on the ceiling lamp 17 and floor lamp 18 .
When motion 8 is detected in bedroom, turn on the ceiling lamp 17 .
When smoke 2 is detected in kitchen, if the user (smartphone as presence sensor) is off, turn on the sprinkler 24 .
When water leak 22 is detected in kitchen, if no smoke 2 is detected, close the water valve 23 .
When the user (smartphone as presence sensor) leaves, turn off the humidifier 14 , lights 15 16 17 18 19 , and plugs 4 5 6 .
When 11pm, turn off the humidifier 14 .
Say “Alexa, good morning” to turn on light 17 .
Say “Alexa, good night” to turn off the lights 15 16 17 18 19 .
When user 1 arrives, unlock the front door lock 2 .
When the door lock 2 is unlocked, turn on the surveillance camera 3 ; when the lock 2 is locked, turn off the camera 3 .
When luminance 5 exceeds 20 lux, if motion 8 is inactive, turn off the living room light 9 .
When luminance 5 drops below 20 lux, if the user 1 is at home, turn on the living room light 9 .
When front door 21 is opened, if motion 4 is active, turn on outlets 13 14 .
When motion 7 is detected in study room, turn on the humidifier 16 .
When user 1 leaves, close the water valve 17 and lock the door 2 .
When smoke 18 is detected, open the water valve 17 .
When smoke 18 is detected, open the sprinkler 19 .
When 6pm, turn on the heater switch 12 .
When temperature 6 exceeds 75◦F , if the user 1 is at home, open the window 15 .
When motion 20 is detected in bathroom, turn on the bathroom light 10 .
When no motion 20 is detected in bathroom, turn off the bathroom light 10 .
When the user leaves (smartphone as presence sensor), turn off the humidifier 16 and outlets 12 13 14 .
Say “Hey Siri, turn off the heater” to turn off the heater outlet 12 .
Say “Hey Siri, turn off the humidifier” to turn off the humidifier 16 .
Say “Alexa, good night” to turn off the lights 9 10 11 and close the window 15 .
Platform
HomeKit
SmartThings
SmartThings
HomeKit
HomeKit
HomeKit
SmartThings
SmartThings
HomeKit
SmartThings
HomeKit
HomeKit
Philips Hue
SmartThings
HomeKit
HomeKit
HomeKit
Alexa
Alexa
SmartThings
SmartThings
HomeKit
SmartThings
SmartThings
HomeKit
SmartThings
SmartThings
HomeKit