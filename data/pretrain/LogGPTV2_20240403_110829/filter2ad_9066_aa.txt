**作者：安天CERT**  
**来源：[https://www.antiy.cn/research/notice&report/research_report/20190601.html](https://www.antiy.cn/research/notice&report/research_report/20190601.html)**

### **1. 事件背景**

网络空间威胁行为体是发起网络攻击的主要来源，它们具有不同的目的和动机，并且在能力上存在显著差异。根据作业动机、攻击能力和掌控资源等多方面因素，安天将网空威胁行为体划分为七个层级：业余黑客、黑产组织、网络犯罪团伙或黑客组织、网络恐怖组织、一般能力国家/地区行为体、高级能力国家/地区行为体以及超高能力国家/地区行为体（详情见附件一）。其中，超高能力国家/地区行为体拥有严密的规模建制和庞大的支撑工程体系，能够掌控系统化的攻击装备和资源，从而实施极为隐蔽和致命的网络攻击。安天曾将这种高度复杂的网络攻击称为A2PT（即高级的高级可持续性威胁）。

“方程式组织”（Equation Group）是一个典型的超高能力网空威胁行为体。2015年2月，卡巴斯基实验室首次公开披露了该组织的存在。据称，“方程式组织”已活跃近20年，可能是目前最复杂的APT攻击组织之一[1]。自2015年3月以来，安天陆续发布了四篇关于“方程式组织”的分析报告，涵盖了其木马模块组件、基于硬盘固件持久化的机理、加密技巧、全平台覆盖能力以及原子化作业木马的解析[2-5]。然而，这些分析仍局限于恶意代码层面，未能全面揭示其战术和技术细节。对于类似“方程式组织”这样的超高能力网空威胁行为体，包括“震网”[6]、“火焰”[7]和“毒曲”[8]等攻击活动，防御者往往只能通过漏洞原理分析、样本逆向工程及作用机理复盘来进行研究。尽管这些工作复杂且艰巨，但并未能充分揭示此类行为体在战术和过程上的完整图景。这是因为，以“方程式组织”为代表的超高能力网空威胁行为体具备一套完整的作业框架和方法体系，拥有大规模支撑工程体系和制式化装备组合，追求高度隐蔽性和反溯源性，使得其攻击行动难以被察觉。

随着斯诺登的曝光以及2017年影子经纪人的爆料，更多关于超高能力网空威胁行为体的工程体系和装备体系的文献资料得以公开。这些信息不仅为低层级威胁行为体提供了可利用的工具，也成为了安全研究者从整体威胁框架角度深入分析超高能力网空威胁行为体的重要资源。例如，在2017年4月14日，“影子经纪人”曝光了一组名为SWIFT的文件夹，详细记录了“方程式组织”针对SWIFT金融服务提供商及其合作伙伴的两次网络攻击：“JEEPFLEA_MARKET”和“JEEPFLEA_POWDER”。前者于2012年7月至2013年9月期间针对中东最大的SWIFT服务提供商EastNets，成功窃取了其在比利时、约旦、埃及和阿联酋的上千个雇员账户、主机信息、登录凭证及管理员账号；后者则主要针对EastNets在拉美和加勒比地区的合作伙伴BCG，但未成功。

安天CERT结合多年来对“方程式组织”的分析进展与此次曝光的信息线索，还原了“方程式组织”对EastNets网络的攻击过程。这是一起由超高能力网空威胁行为体发起的、针对金融基础设施的高级持续性威胁攻击事件，涉及全球多个区域的预设跳板机进行攻击，利用0Day漏洞直接突破两层网络安全设备并植入持久化后门，获取内部网络拓扑和登录凭证以确定下一步攻击目标，最终通过“永恒”系列0Day漏洞突破内网管理服务器、业务服务器和应用服务器，并植入多个内核级后门，执行SQL脚本窃取关键数据信息。

安天分析小组力求通过态势感知的工作思路，对超高能力网空威胁行为体的攻击活动进行全面解读，为重要信息系统和关键信息基础设施的规划、建设和运维者提供有效的防御体系建设参考依据。

### **2. 被攻击目标资产情况**

#### **2.1 SWIFT介绍**

SWIFT，全称Society for Worldwide Interbank Financial Telecommunications（环球同业银行金融电信协会），成立于1973年5月，总部位于比利时首都布鲁塞尔。该组织运营着世界级的金融报文网络，为各国银行和其他金融机构提供安全、标准化和可信的通道，用于交换金融交易报文。此外，SWIFT还向金融机构销售软件和服务。截至2015年，SWIFT的服务已经覆盖全球200多个国家和地区的11,000多家银行和证券机构、市场基础设施和公司客户，每日处理的报文次数达到1,500万次。

#### **2.2 被攻击的SWIFT服务提供商介绍**

经过认证的SWIFT服务提供商（SWIFT Service Bureau）为客户提供了高效访问完整SWIFT服务的方法，相当于客户的云提供商，目前全球共有74家。此次攻击的目标EastNets是中东地区最大的SWIFT服务提供商。

**EastNets简介**

EastNets总部设在迪拜，是全球领先的金融服务领域合规和支付解决方案提供商，提供多种涉及SWIFT交易的服务，包括合规性、了解客户以及反洗钱等。过去35年来，EastNets利用其专业知识，帮助客户打击金融犯罪，制定和实施标准化及个性化解决方案，并提供风险管理、监控、分析及最先进的咨询服务和客户支持。EastNets专注于端到端支付解决方案，使金融机构能够将传统的支付挑战转化为机遇，并更有效、更具成本效益地运营。超过750家客户依赖EastNets的解决方案和专业服务，其中包括270多家企业和金融机构，依靠EastNets提供外包SWIFT连接和合规软件解决方案。EastNets在全球主要城市设有地区办事处，并由广泛的全球战略合作伙伴网络提供支持[9]。

根据Treasury And Risk的统计[10]，加盟到SWIFT的成员中，有70%会选择SWIFT服务提供商，以避免自建SWIFT带来的高昂投入和后续操作维护费用。SWIFT服务提供商类似于客户的“云”，在客户间发生SWIFT交易及信息交换时，通过Oracle数据库和SWIFT软件进行管理。由于可以访问所有这些银行交易，许多SWIFT服务提供商还能提供合规性、了解客户以及反洗钱服务。

#### **2.3 被攻击资产简况**

通过对此次“方程式组织”攻击行动的分析发现，EastNets的网络环境按照不同功能特性进行了层次和分区设计，包括VPN接入、区域边界、管理服务器、应用服务器和数据库服务器等。各逻辑分区之间设置了基于端口和IP的访问控制策略，部署了企业级防火墙，并在服务器上安装了主流品牌的安全防护软件。尽管具备一定的基础防护能力和防御纵深，但在面对超高能力网空威胁行为体的攻击时，依然被攻陷。

在这次攻击中，EastNets网络遭受攻击的资产包括：

- **网络安全设备和网络设备**：至少10台以上的Cisco和Juniper品牌的设备被攻击或探测，相关信息如表2-1所示。
- **管理服务器**：共2台，内网IP分别为192.168.206.110和192.168.208.10 / 10.255.10.10。
- **应用服务器**：SWIFT业务服务器及其他应用服务器。
- **终端主机信息**：包括登录凭证和安全防护软件与应用软件等。

图2-2展示了被攻击主要资产的拓扑图。

##### **2.3.1 被攻击的网络安全设备及网络设备信息**

表2-1列出了被攻击的企业级防火墙设备的详细信息，包括设备名称、软件版本、开放端口等。

##### **2.3.2 被攻击的管理服务器信息**

被攻击的管理服务器共有2台，内网IP分别为192.168.206.110和192.168.208.10 / 10.255.10.10。