27	
GTVHACKER
CubeRoot	
•  Also patches the exploit, to prevent evil apps 
•  Pulled by Google – get it at GTVHacker.com 
o  Downloaded ## boxes 
o  Rooted ## boxes (Included 1 eng build) 
o  Listed in Google Play store for 6 days  
•  Patched at the beginning of July 
o  Took roughly 2 months  
h#p://DC21.GTVHacker.com	
28	
GTVHACKER
One Root to Rule Them All 
h#p://DC21.GTVHacker.com	
29	
GTVHACKER
Magic USB	
•  Recall our past exploits with file system nodes and block devices? 
o  In the first generation of GoogleTV devices, our original "4 usb 
recovery exploit" leveraged a USB device improperly not mounted 
"nodev" 
o  That was only two very similar devices. 
What about something a bit bigger? 
h#p://DC21.GTVHacker.com	
30	
GTVHACKER
Magic USB	
•  All Google TV's and some other Android devices are vulnerable. 
o  Certain specific Linux boxes too! 
•  vold mounts NTFS partitions without “nodev” 
•  A little known “feature” of NTFS is that it supports  
Linux block / character devices 
h#p://DC21.GTVHacker.com	
31	
GTVHACKER
Magic USB	
•  NTFS Drive + Block Device 
o  Read / Write on any box, any partition. 
•  Easy root, on every single box! 
o  Dump boot.img 
o  Patch init.rc or default.prop to ro.secure=0 
o  Write it back (as a user, no root needed) 
o  Reboot, you are rooted – win! 
o  Sony boxes require an additional step 
h#p://DC21.GTVHacker.com	
32	
GTVHACKER
OOOHHHH YEAH 
h#p://DC21.GTVHacker.com	
33	
GTVHACKER
Hardware Mods / Exploits	
h#p://DC21.GTVHacker.com	
34	
Sony NSZ-GS7 with EMMC->SD and SATA Mods 
GTVHACKER
LG 47/55G2	
h#p://DC21.GTVHacker.com	
35	
•  Dual Core ARM L9 
o  aka LG1152 
•  Signed Everything 
o  Even the splash! 
•  Our “White Whale” 
o  Why spend $1K?
o  Next best thing 
§ 
Power supply and Mobo 
GTVHACKER
LG 47/55G2 Root	
•  Hardware Root! 
o  EMMC Flash 
§ 
EMMC  
§ 
MMC 
§ 
SD 
•  All fall back to SPI mode 
h#p://DC21.GTVHacker.com	
36	
GTVHACKER
LG 47/55G2 Root	
h#p://DC21.GTVHacker.com	
37	
GTVHACKER
LG 47/55G2 Root	
partinfo at  0x100000.  
Take the filename, count 
back 6 bytes and byteswap – 
your location. 
/system is at 122,159,104 
mount -text4 -
o,skip=122159104 /dev/
sdXX /mnt/system 
h#p://DC21.GTVHacker.com	
38	
GTVHACKER
LG 47/55G2 Root	
• 
Root FS is a signed 
squashfs image 
• 
Init script calls: /system/
vendor/bin/
init_forcestripped.sh 
• 
Mount, edit to spawn 
telnet, root shell over uart, 
or over PL2303 USB 
serial adapter. 
• 
Debug agent (dongle 
needed) runs over UART  
h#p://DC21.GTVHacker.com	
39	
GTVHACKER
Sony NSZ-GS7/GS8	
•  Sony also uses an EMMC Flash making interfacing easier 
o  Boot & system are not signed 
•  To gain root we rewrite /boot or /system 
o  However, the RSA signed init scripts check for certain props 
§ 
EX: Check for ro.secure=0, if so, reboot 
o  Since we can modify /boot we can remove the check 
o  Sony also disabled dd, insmod, and some other bits via kernel 
calls 
o  Being able to write /system and /boot you can change most 
restrictions at will! 
h#p://DC21.GTVHacker.com	
40	
GTVHACKER
Sony NSZ-GS7/GS8	
•  SATA HDD 
o  Jumpers / caps over front 
points 
o  Add SATA connector on 
the back 
o  Connect a HDD. Ach, it's 
not being detected! 
But no kernel support for SATA 
h#p://DC21.GTVHacker.com	
41	
GTVHACKER
Now What? 
We've got root but we want more. 
h#p://DC21.GTVHacker.com	
42	
GTVHACKER
Marvell Armada 1500  
Secure Boot Exploit	
•  Armada 1000 = 88de3010 
•  Armada 1500 = 88de3100 
May also work on the Armada 1000 
h#p://DC21.GTVHacker.com	
43	
GTVHACKER
Marvell Armada 1500  
Secure Boot Exploit	
•  Sony NSZ-GS7 
•  Netgear NeoTV Prime 
•  Vizio Co-Star 
•  Hisense Pulse 
•  Asus CUBE 
•  Sony NSZ-GS8 
h#p://DC21.GTVHacker.com	
44	
•  LG U+ IPTV 
•  Google “Berlin” 
•  ZeroDesktop MiiPC 
•  Hisense XT780 TV 
•  Lenovo S31/S61 TV 
•  TCL MoVo 
•  And Others! 
GTVHACKER
Detailed Security Overview	
h#p://DC21.GTVHacker.com	
45	
GTVHACKER
Bootloader Messages	
h#p://DC21.GTVHacker.com	
46	
GTVHACKER
Android Kernel +	
  Marvell Secure Image	
h#p://DC21.GTVHacker.com	
47	
GTVHACKER
Android Kernel Header	
h#p://DC21.GTVHacker.com	
48	
Mkbootimg/bootimg.h 
GTVHACKER
Android Kernel + MV Secure Image	
h#p://DC21.GTVHacker.com	
49	
GTVHACKER
A Second Look	
h#p://DC21.GTVHacker.com	
50	
Red     =   Ramdisk Size 
Black   =   Ramdisk Load Address 
You got your Ramdisk in my Kernel! 
GTVHACKER
Secure Boot Exploit	
•  Note the ramdisk load address 
o  Can be modified without breaking kernel signature 
•  Allows us to load a "ramdisk" anywhere in memory 
o  Ramdisk in this case is a chunk of our own unsigned code 
•  Copies in our "ramdisk" at the address specified, and without any 
additional checks, we can run our own unsigned code 
h#p://DC21.GTVHacker.com	
51	
GTVHACKER
Area Of Attack (Pseudocode)	
h#p://DC21.GTVHacker.com	
52	
GTVHACKER
New Boot Flow / Memory Map	
New Boot Flow / Memory Map	
h#p://DC21.GTVHacker.com	
53	
GTVHACKER
Exploit Process 
•  GTVHacker Custom Recovery on Sony NSZ-GS7 
o 
Sony box has additional security  
o 
Append a tiny secure image that will validate  
o 
Normal signed kernel will do 
•  Add on our custom Recovery + Kernel (w/ ramdisk) 
o 
Change Ramdisk size to match our new "ramdisk” 
•  Set Ramdisk Load Address: 
§ 
0x1008000 – Size of Signed Kernel 
•  Our custom Recovery ends up at 0x1008000, and boots! 
h#p://DC21.GTVHacker.com	
54	
GTVHACKER
Exploit Process 
Exploit Image Placeholder 
h#p://DC21.GTVHacker.com	
55	
GTVHACKER
U-Boot 
•  We can also trigger the 
exploit and run uboot 
•  ASUS was kind enough 
to GPL parts, and with 
some patches, it runs 
•  Load a kernel via TFTP, 
Flash, or USB for 
development 
h#p://DC21.GTVHacker.com	
56	
GTVHACKER
Future Research 
Areas that need more work:  
• 
Unsigned kernels on Gen 1 (Revue) w/ NTFS exploit 
h#p://DC21.GTVHacker.com	
57	
GTVHACKER
Demo 
h#p://DC21.GTVHacker.com	
58	
GTVHACKER
Thank You!	
h#p://DC21.GTVHacker.com	
59	
  Slide Resources can be found at: 
http://DC21.GTVHacker.com 
WIKI: http://www.GTVHacker.com 
FORUM: http://forum.GTVHacker.com 
BLOG: http://blog.GTVHacker.com 
IRC: irc.freenode.net #GTVHacker 
Follow us on Twitter:  
@GTVHacker