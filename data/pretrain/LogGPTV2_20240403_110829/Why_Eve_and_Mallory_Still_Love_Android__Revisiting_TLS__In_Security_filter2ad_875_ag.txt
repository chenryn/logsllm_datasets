[75] OLTROGGE, M., DERR, E., STRANSKY, C., ACAR, Y.,
FAHL, S., ROSSOW, C., PELLEGRINO, G., BUGIEL, S., AND
BACKES, M. The rise of the citizen developer: Assessing
the security impact of online app generators. In 2018 IEEE
Symposium on Security and Privacy (SP), vol. 00, pp. 102–115.
[76] O’NEILL, M., HEIDBRINK, S., RUOTI, S., WHITEHEAD,
J., BUNKER, D., DICKINSON, L., HENDERSHOT, T.,
REYNOLDS, J., SEAMONS, K., AND ZAPPALA, D. Trustbase:
An architecture to repair and strengthen certiﬁcate-based
authentication. In USENIX Security Symposium (2017).
[77] ONWUZURIKE, L., AND DE CRISTOFARO, E. Danger is
my middle name: experimenting with SSL vulnerabilities in
Android apps. In ACM Conference on Security & Privacy in
Wireless and Mobile Networks (WiSec) (2015), ACM, pp. 1–6.
[78] POEPLAU, S., FRATANTONIO, Y., BIANCHI, A., KRUEGEL,
C., AND VIGNA, G. Execute this! analyzing unsafe and mali-
cious dynamic code loading in android applications. In Proc.
21st Annual Network and Distributed System Security Sympo-
sium (NDSS’14) (2014), The Internet Society.
[79] POSSEMATO, A., AND FRATANTONIO, Y. Towards HTTPS
In 29th
everywhere on android: We are not there yet.
USENIX Security Symposium (USENIX Security 20) (Aug.
2020), USENIX Association, pp. 343–360.
[80] RAHAMAN, S., XIAO, Y., AFROSE, S., SHAON, F., TIAN, K.,
FRANTZ, M., KANTARCIOGLU, M., AND YAO, D. D. Cryp-
toguard: High precision detection of cryptographic vulnerabili-
ties in massive-sized java projects. CCS’19, Association for
Computing Machinery, p. 2455–2472.
[81] RAZAGHPANAH, A., NIAKI, A. A., VALLINA-RODRIGUEZ,
N., SUNDARESAN, S., AMANN, J., AND GILL, P. Studying
tls usage in android apps. In Proceedings of the 13th Inter-
national Conference on Emerging Networking EXperiments
and Technologies (New York, NY, USA, 2017), CoNEXT’17,
Association for Computing Machinery, p. 350–362.
4362    30th USENIX Security Symposium
USENIX Association
Table 9: Top 10 domains that were used with pinning.
Apps
29
36
24
23
12
12
12
11
11
9
Domain Value
ayers.com.hk
subaio.com
ﬁnopaymentbank.in
webmobi.com
api.app.olbisoft.de
cmtelematics.com
info.app.olbisoft.de
demo.pay2india.com
gmail.com
app.sociabble.com
Exp
(cid:88)
Leaf
(cid:88)
CA
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
(cid:88)
* We could not ﬁnd the certiﬁcate for the given pinning value.
Table 10: Top 10 Domains with HTTPS upgrade
# Apps
76
76
8
7
4
4
4
4
4
4
Domain Value
cdn.example2.com
example.com
horaires-aeroports.appspot.com
ayers.com.hk
apis.appnxt.net
10.0.2.2
10.0.3.2
http://credu.com
http://el.multicampus.com
http://www.credu.com
[82] RESCORLA, E. The Transport Layer Security (TLS) Protocol
Version 1.3. RFC 8446, Aug. 2018. https://rfc-editor.
org/rfc/rfc8446.txt (visited on 09/22/2020).
[83] RESCORLA, E., AND DIERKS, T. The Transport Layer Se-
curity (TLS) Protocol Version 1.2. RFC 5246, Aug. 2008.
https://rfc-editor.org/rfc/rfc5246.txt (visited on
09/22/2020).
[84] SOUNTHIRARAJ, D., SAHS, J., GREENWOOD, G., LIN, Z.,
AND KHAN, L. Smv-hunter: Large scale, automated detection
of ssl/tls man-in-the-middle vulnerabilities in android apps.
[85] TENDULKAR, V., AND ENCK, W. An Application Package
Conﬁguration Approach to Mitigating Android SSL Vulnerabil-
ities. In Proceedings of the IEEE Mobile Security Technologies
workshop (MoST) (2014), IEEE.
[86] WEIR, C., HERMANN, B., AND FAHL, S. From needs to ac-
tions to secure apps? the effect of requirements and developer
practices on app security. In 29th USENIX Security Sympo-
sium (USENIX Security 20) (Aug. 2020), USENIX Association,
pp. 289–305.
[87] WERMKE, D., HUAMAN, N., ACAR, Y., REAVES, B.,
TRAYNOR, P., AND FAHL, S. A Large Scale Investigation of
Obfuscation Use in Google Play. In Proc. 34th Annual Com-
puter Security Applications Conference (ACSAC’18) (2018),
ACM.
A Appendix
Table 7: Top 10 Root CAs detected in pinning
Apps
44
39
24
22
22
19
17
16
16
16
CAa
CN=Amazon Root CA 1
CN=Go Daddy Root Certiﬁcate Authority - G2
CN=Starﬁeld Services Root Certiﬁcate Authority - G2
CN=DigiCert High Assurance EV Root CA
CN=DigiCert Global Root CA
CN=DigiCert Global Root G2
CN=Entrust Root Certiﬁcation Authority - G2
CN=GlobalSign Root CA
CN=Baltimore CyberTrust Root
CN=COMODO RSA Certiﬁcation Authority
a We use the CAs’ CommonName attribute for brevity here
Table 8: Top 10 Domains with HTTPS downgrade.
# Apps HTTPS Domain Value
11,689
4,290
740
449
392
376
366
366
293
290
127.0.0.1
localhost
10.0.2.2
localdev.cc
amazon-adsystem.com
virenter.com
10.0.3.2
securenetsystems.net
renweb.com
getﬁtivity.com
(cid:88)
(cid:88)
(cid:88)
(cid:88) HTTPS would be possible
Listing 1: Empty TrustManager - Accepts all certiﬁcates
@Override
public void checkServerTrusted ( X509Certificate []
chain , String authType ) throws
CertificateException {
}
USENIX Association
30th USENIX Security Symposium    4363
Table 11: Top custom certiﬁcates for debugging
# Apps
170
65
12
9
9
9
8
8
6
4
Certiﬁcate
/CN=CharlesProxyCustomRootCertificate
/C=RU/L=Novosibirsk/O=CFT/CN=dev-new.bankplus.
ru
/C=DE/O=aktivkonzepte/CN=aktiv-konzepte
/C=SI/ST=Slovenija/L=Ljubljana/O=Omsoftd.
o.o./OU=Primoz/CN=OmsoftCA/emailAddress=
PI:EMAIL
/CN=ng_test_ca_2/C=SI/O=Halcom/OU=NG
/C=SI/L=Ljubljana/O=Halcomd.d./OU=Corporate/
CN=ljvfep3.halcom.local/emailAddress=
PI:EMAIL
/C=SI/O=Halcomd.d./OU=servercertificates/CN=
fep-r3.halcom.local/SN=halcom.local/GN=fep-r3
/C=US/O=GeoTrustInc./CN=RapidSSLSHA256CA
/OU=Createdbyhttp://www.fiddler2.com/O=
DO_NOT_TRUST/CN=DO_NOT_TRUST_FiddlerRoot
/C=CA/ST=PrinceEdwardIsland/L=Charlottetown/O=
silverorangeInc./CN=roble/emailAddress=
PI:EMAIL
* Certiﬁcates for Charles Proxy are generated during setup and include indi-
vidual user and device names. Therefore, we only used the preﬁx for aggre-
gation.
Table 12: Top custom certiﬁcates for production
# Apps
647
379
174
174
89
21
21
16
16
16
Certiﬁcate
/C=US/ST=NY/L=NY/O=NarviiInc./OU=Aminoapps/
CN=https://aminoapps.com//emailAddress=
PI:EMAIL
/CN=console-forum.net
/C=US/ST=CO/L=Denver/O=Zerista/CN=*.zerista.d.
dm7.me/emailAddress=PI:EMAIL
/C=US/ST=CO/L=Denver/O=Zerista/CN=*.zerista.k.
dm7.me/emailAddress=PI:EMAIL
/CN=*.zerista.io
/C=AU/ST=Some-State/O=InternetWidgitsPtyLtd/CN=
*.zerista.d.dm7.me
/C=US/ST=Colorado/L=Denver/O=Zerista,Inc./OU=
Dushyanth/CN=*.zerista.k.dm7.me/emailAddress=
PI:EMAIL
/C=US/O=DigiCertInc/OU=www.digicert.com/CN=
RapidSSLRSACA2018
/CN=CharlesProxyCA(1Jul2019,MacBook-Pro-de-
Toni.local)/OU=https://charlesproxy.com/ssl/O=
XK72Ltd/L=Auckland/ST=Auckland/C=NZ
/CN=CharlesProxyCA(20Nov2019,Marc.local)/OU=
https://charlesproxy.com/ssl/O=XK72Ltd/L=
Auckland/ST=Auckland/C=NZ
Listing 2: Empty HostnameVeriﬁer - Accepts all hostnames
@Override
public boolean verify ( String host , SSLSession
session ) {
return true;
}
Listing 3: NSC permitting HTTP trafﬁc again
...
...
...
Listing 4: Reactivating trust for user-installed CAs
...
...
Listing 5: Insecure NSC Snippet from the Mopub Library
...
/ >
example . com 
cdn . example2 . com 
4364    30th USENIX Security Symposium
USENIX Association