and evaluate RangeAmp attacks.)
In general, we have tried our best to responsibly report the
vulnerabilities and provide mitigation solutions. The related
vendors will have about seven months to implement mitigation
techniques before this paper is published. And they have the
duty to inform their customers about the vulnerabilities.
The responses from CDN vendors are summarized below:
Cloudﬂare appreciated our work and discussed the vulner-
abilities with us in detail. They thought that the SBR attack
relies on constantly triggering a cache-miss and a customer
can add a page rule to ignore query strings. But this does
not solve the problem fundamentally. The malicious customers
and some normal customers will not follow this suggestion.
Unfortunately, they won’t implement our mitigation solutions
because Cloudﬂare does not want to cache partial re-
sponses of certain resources. And they insisted that they are
not deviating away from the speciﬁcations. But Cloudﬂare now
seems to have improved its DDoS detection mechanism.
Huawei Cloud evaluated the issue as a high-risk vulnerabil-
ity. They viewed it as indeed a problem for the CDN industry
and contacted us actively to discuss how to defend against it.
And they have now ﬁxed the related vulnerabilities.
CDN77 thanked us for our research. To defend against the
OBR attack, they have created a detection for overlapping
ranges and such requests will be denied. Besides, they are
now moving to disable the Range header to mitigate the SBR
attack and try implementing slicing of range requests.
G-Core Labs determined that the vulnerabilities exist on
their service and contacted us actively to discuss mitigation
options. To defend against the SBR attack, they eventually
chose to make the “slice” option enabled by default, which
adopts the Laziness policy to handle the Range header.
Tencent Cloud conﬁrmed that
their implementation is
vulnerable to the SBR attack. And they have ﬁxed it now.
Akamai acknowledged that the Azure case of Akamai is
indeed problematic. They said that the Azure conﬁgurations
may override the origin conﬁgurations of Akamai and this
issue should be ﬁxed on the Azure side. Anyway, they claimed
to look into this problem promptly.
CloudFront admitted the methods used to optimize caching
of range requests indeed increase bytes requested from the
origin. They claimed to investigate how to prevent multi-range
requests from increasing any more trafﬁc than single-range
requests. Besides, they claimed that they have safeguards to
prevent excessive back-to-origin requests.
CDNsun claimed that they would mitigate the OBR attack
by limiting the number of ranges or rejecting overlapping
range requests. But they insisted that they don’t have a proper
technical solution to the SBR attack, although we introduced
some mitigation options to them.
Fastly expressed appreciation for our study and informed
us that they are investigating to validate the attack scenarios,
explore the effectiveness of mitigation already available, and
develop new capabilities to manage the risk of this attack.
Azure conﬁrmed that the attack is feasible, but only in cer-
tain circumstances. They insisted that if a customer conﬁgures
the options to ignore query strings then the attack will be
mitigated. But as we discussed with Cloudﬂare, a malicious
customer won’t follow the security best practices. And some
normal customers won’t do so as well.
Alibaba Cloud conﬁrmed that
their implementation is
vulnerable to the SBR attack. They are currently ﬁxing it.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 11:32:57 UTC from IEEE Xplore.  Restrictions apply. 
23
KeyCDN thanked us for our report but claimed that they
have already been aware of this issue.
B. Response from the RFC editor
We also contacted the honored editors of RFC7233 with
email and Roy T. Fielding replied that “it’s the CDN’s re-
sponsibility to manage its back-end behavior regardless of the
protocols used to access it”. But he also said that “I agree
that this kind of attack should be mentioned as a security
consideration” and “we can warn about certain effects and
kinds of attack”. He suggested we discuss this threat on the
mailing list of the HTTP working group.
VIII. RELATED WORK
HTTP Range Security. To the best of our knowledge,
there is no academic literature discussing the security risks
introduced by range requests in a CDN environment. Accord-
ing to the CVE platform, there are about 20 vulnerabilities
related to range requests. All of them are related to improper
implementations but have nothing to do with CDNs. For
instance, CVE-2017-7529 [22] presents an integer overﬂow
caused by Nginx’s incorrect processing with the Range ﬁeld.
And CVE-2011-3192 [13] presents a DoS attack using a
Range header with multiple ranges to exhaust memory on
the Apache server. Our RangeAmp attacks mainly exploit the
asymmetrical trafﬁc consumption in the front-end and back-
end connections of a CDN, which is quite different from these
vulnerabilities.
CDN Security. As an important part of the Internet in-
frastructure, CDN security has been well researched. Due to
the DDoS protection provided by CDNs, attackers are highly
interested in ﬁnding out the origin IP of the target website.
There are some methods based on information leaks to expose
the sensitive information of the origin server [6], [9]. In
comparison, our RangeAmp attacks can directly nullify the
DDoS protection of a vulnerable CDN and abusing the CDN
to attack the origin server. Triukose et al [5] proposed an attack
of exhausting the bandwidth of the origin server by rapidly
dropping the front-end connections. We evaluated this attack
and found that most CDNs can mitigate it. They will break
the corresponding back-end connections when the front-end
connections are abnormally cut off. However, this defense is
invalid under our RangeAmp attacks. Furthermore, CDNs can
also become the victim, and in the forwarding-loop attacks
proposed by Chen et al [3], an attacker can chain CDN nodes
into a loop, causing the malicious request to be processed
repeatedly and reducing CDN’s availability. Differently, our
RangeAmp attacks present a novel method to perform an
ampliﬁcation attack against speciﬁc ingress nodes of CDNs.
Some studies show that the global distribution and massive
nodes of a CDN also facilitate malicious CDN customers
to abuse the CDN [23]–[25]. And CDN’s mappings between
clients and surrogates can also be maneuvered with crafted
DNS records [26]. Compared to previous researches related
to CDNs, we propose a novel class of ampliﬁcation attacks
and conduct a real-world security evaluation with 13 popular
CDNs. Indeed, we provide a complement to existing CDN
security research.
Ampliﬁcation Attacks. Ampliﬁcation attacks have also
long been well studied. Booth et al [27] reveal
that, by
recruiting UDP servers on the Internet as the reﬂectors, a
UDP ampliﬁcation attack can reach an ampliﬁcation factor
of 556. Sieklik et al [28] further analyze the DNSSEC based
ampliﬁcation attack, which leads to an ampliﬁcation factor
of 44. Besides the UDP protocol,
the TCP protocol can
also be abused. Anagnostopoulos et al [29] study the TFTP
ampliﬁcation attack with an ampliﬁcation factor of 60. K¨uhrer
et al [30] gave an in-depth analysis of the TCP reﬂection attack
across famous TCP services, eg, HTTP, MySQL, and POP3
services. Further, K¨uhrer et al [31] also reveals that the NTP
service can lead to an ampliﬁcation factor of 4670. In 2015,
Kr¨amer et al [32] designed a novel honeypot to track and
analyze these types of ampliﬁcation attacks. Compared with
these previous ampliﬁcation attack studies, our RangeAmp
attack can reach a much larger ampliﬁcation factor. More
importantly, when the target website is hosted behind a CDN,
the CDN can defend against all ampliﬁcation attacks of
previous studies. However, a RangeAmp attacker can nullify
the DDoS protection provided by CDNs and achieve severe
ampliﬁcation damage against the CDN-hided website server.
In brief, our study reveals that the Range header can be ex-
ploited to perform a novel class of ampliﬁcation attacks against
the websites hosted on CDNs and the ingress nodes of CDNs.
This attack nulliﬁes the CDN-provided DDoS protections and
poses a severe threat to the Internet security ecosystem.
IX. CONCLUSION
We have presented the principles of the RangeAmp vulner-
ability, along with a comprehensive study of its practicality
in the wild. We ﬁnd that the 13 popular CDNs tested are all
vulnerable. The unclear deﬁnition and security negligence of
the speciﬁcations are the root cause, and the implementation
ﬂaws of CDNs further worsen this vulnerability. We believe
that the RangeAmp attacks will pose severe threats to the
serviceability of CDNs and the availability of websites. We
hope that our study will provide insight into this vulnerability
and help the potentially relevant victims to fully understand
them. In the short term, we suggest that the CDNs and websites
adopt one or more of the mitigation solutions discussed in our
paper. In the longer term, we think that a more speciﬁc limit
of range requests should be deﬁned in a future updated RFC,
especially for the HTTP middle-boxes like CDNs.
ACKNOWLEDGEMENT
Special thanks are expressed to our shepherd Marc Dacier
and the anonymous reviewers for their insightful comments,
which contributed to a great improvement of our paper. We
also thank the RFC7233’s editor Roy T. Fielding and all related
CDN vendors for their valuable feedback. Last but not least,
we gratefully acknowledge the help of our friend Wenchang
Ma, who spent lots of time correcting our grammar mistakes.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 11:32:57 UTC from IEEE Xplore.  Restrictions apply. 
24
[25] R. Guo, J. Chen, B. Liu, J. Zhang, C. Zhang, H. Duan, T. Wan,
J. Jiang, S. Hao, and Y. Jia, “Abusing cdns for fun and proﬁt: Security
issues in cdns’ origin validation,” in 37th IEEE Symposium on Reliable
Distributed Systems, SRDS 2018.
IEEE Computer Society, 2018, pp.
1–10.
[26] S. Hao, Y. Zhang, H. Wang, and A. Stavrou, “End-users get maneuvered:
Empirical analysis of redirection hijacking in content delivery networks,”
in 27th USENIX Security Symposium, USENIX Security 2018. USENIX
Association, 2018, pp. 1129–1145.
[27] T. G. Booth and K. Andersson, “Elimination of dos UDP reﬂection
ampliﬁcation bandwidth attacks, protecting TCP services,” in Future
Network Systems and Security - First International Conference, ser.
Communications in Computer and Information Science, vol. 523.
Springer, 2015, pp. 1–15.
[28] B. Sieklik, R. Macfarlane, and W. J. Buchanan, “Evaluation of TFTP
ddos ampliﬁcation attack,” Comput. Secur., vol. 57, pp. 67–92, 2016.
[29] M. Anagnostopoulos, G. Kambourakis, P. Kopanos, G. Louloudakis,
and S. Gritzalis, “DNS ampliﬁcation attack revisited,” Comput. Secur.,
vol. 39, pp. 475–485, 2013.
[30] M. K¨uhrer, T. Hupperich, C. Rossow, and T. Holz, “Hell of a handshake:
Abusing TCP for reﬂective ampliﬁcation ddos attacks,” in 8th USENIX
Workshop on Offensive Technologies, WOOT ’14. USENIX Association,
2014.
[31] ——, “Exit from hell? reducing the impact of ampliﬁcation ddos
the 23rd USENIX Security Symposium.
attacks,” in Proceedings of
USENIX Association, 2014, pp. 111–125.
[32] L. Kr¨amer, J. Krupp, D. Makita, T. Nishizoe, T. Koide, K. Yoshioka, and
C. Rossow, “Amppot: Monitoring and defending against ampliﬁcation
ddos attacks,” in Research in Attacks, Intrusions, and Defenses - 18th
International Symposium, RAID 2015, ser. Lecture Notes in Computer
Science, vol. 9404. Springer, 2015, pp. 615–636.
REFERENCES
[1] Data Economy,
be
to
“Data
to
economy
need
data-economy-frontline-how-close-you-need-to-be-to-edge-data/,
[Accessed Dec. 2019].
data?”
edge
frontline.
how close
you
https://data-economy.com/
[2] R. T. Fielding, Y. Lafon, and J. F. Reschke, “Hypertext transfer protocol
(HTTP/1.1): range requests,” RFC, vol. 7233, pp. 1–25, 2014.
[3] J. Chen, X. Zheng, H. Duan, J. Liang, J. Jiang, K. Li, T. Wan, and
V. Paxson, “Forwarding-loop attacks in content delivery networks,”
in 23rd Annual Network and Distributed System Security Symposium,
NDSS 2016. The Internet Society, 2016.
[4] J. Chen, J. Jiang, H. Duan, N. Weaver, T. Wan, and V. Paxson, “Host
of troubles: Multiple host ambiguities in HTTP implementations,” in
Proceedings of the 2016 ACM SIGSAC Conference on Computer and
Communications Security. ACM, 2016, pp. 1516–1527.
[5] S. Triukose, Z. Al-Qudah, and M. Rabinovich, “Content delivery net-
works: Protection or threat?” in Computer Security - ESORICS 2009,
14th European Symposium on Research in Computer Security, ser.
Lecture Notes in Computer Science, vol. 5789.
Springer, 2009, pp.
371–389.
[6] T. Vissers, T. van Goethem, W. Joosen, and N. Nikiforakis, “Maneu-
vering around clouds: Bypassing cloud-based security providers,” in
Proceedings of the 22nd ACM SIGSAC Conference on Computer and
Communications Security. ACM, 2015, pp. 1530–1541.
[7] R. T. Fielding, J. Gettys, J. C. Mogul, H. F. Nielsen, L. Masinter, P. J.
Leach, and T. Berners-Lee, “Hypertext transfer protocol - HTTP/1.1,”
RFC, vol. 2616, pp. 1–176, 1999.
[8] M. Belshe, R. Peon, and M. Thomson, “Hypertext transfer protocol
version 2 (HTTP/2),” RFC, vol. 7540, pp. 1–96, 2015.
[9] L. Jin, S. Hao, H. Wang, and C. Cotton, “Your remnant
tells se-
cret: Residual resolution in ddos protection services,” in 48th Annual
IEEE/IFIP International Conference on Dependable Systems and Net-
works, DSN 2018.
IEEE Computer Society, 2018, pp. 362–373.
[10] ——, “Unveil the hidden presence: Characterizing the backend interface
of content delivery networks,” in 27th IEEE International Conference
on Network Protocols, ICNP 2019.
IEEE, 2019, pp. 1–11.
[11] Datanyze, “Content delivery networks market share report,” https://www.
datanyze.com/market-share/cdn/, [Accessed Dec. 2019].
[12] Rapid7, “Apache range header dos (apache killer),” https://www.rapid7.
com/db/modules/auxiliary/dos/http/apache range dos, [Accessed Dec.
2019].
[13] cve.mitre.org, “Cve-2011-3192,” https://cve.mitre.org/cgi-bin/cvename.
cgi?name=CVE-2011-3192, [Accessed Oct. 2019].
[14] R. Guo, W. Li, B. Liu, S. Hao, J. Zhang, H. Duan, K. Shen, J. Chen,
and Y. Liu, “Cdn judo: Breaking the cdn dos protection with itself,”
NDSS’20, 2020.
[15] D. Senecal, “Slow dos on the rise,” https://blogs.akamai.com/2013/09/
slow-dos-on-the-rise.html, [Accessed Oct. 2018].
[16] Cloudﬂare,
“Slowloris
ddos
attack,”
https://www.cloudﬂare.com/
learning/ddos/ddos-low-and-slow-attack, [Accessed Oct. 2018].
[17] CDNPerf, “Cdn calculator - cdncalc - cdnperf,” https://www.cdnperf.
com/tools/cdn-calculator, [Accessed Dec. 2019].
[18] CDNsun, “Best cdn solutions at cheap price — cdn pricing,” https:
//cdnsun.com/pricing, [Accessed Dec. 2019].
[19] Alibaba Cloud, “Cdn (content delivery network) pricing & purchasing
methods - alibaba cloud,” https://www.alibabacloud.com/product/cdn/
pricing?spm=a3c0i.7938564.220486.75.26d62aecnaGFXf,
[Accessed
Dec. 2019].
[20] HUAWEI CLOUD,
“Price
calculator-huawei
huaweicloud.com/en-us/pricing/index.html?tab=detail#/cdn,
Dec. 2019].
cloud,” https://intl.
[Accessed
[21] Tencent Cloud, “Pricing center
-
tencent cloud,” https://intl.cloud.
tencent.com/pricing/cdn, [Accessed Dec. 2019].
[22] M. Dounin,
“Cve-2017-7529,,” http://mailman.nginx.org/pipermail/
nginx-announce/2017/000200.html, [Accessed Oct. 2019].
[23] J. Holowczak and A. Houmansadr, “Cachebrowser: Bypassing chinese
censorship without proxies using cached content,” in Proceedings of
the 22nd ACM SIGSAC Conference on Computer and Communications
Security. ACM, 2015, pp. 70–83.
[24] H. Zolfaghari and A. Houmansadr, “Practical censorship evasion lever-
aging content delivery networks,” in Proceedings of the 2016 ACM
SIGSAC Conference on Computer and Communications Security. ACM,
2016, pp. 1715–1726.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 11:32:57 UTC from IEEE Xplore.  Restrictions apply. 
25