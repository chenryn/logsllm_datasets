Multipot: A More Potent Variant 
of Evil Twin
K. N. Gopinath 
Senior Wireless Security Researcher and 
Senior Engineering Manager 
AirTight Networks 
http://www.airtightnetworks.net 
Email: PI:EMAIL
What is this presentation about?
It is about discovery of a more potent variant of Evil Twin. 
We call it ‘Multipot’.
 Evil Twin recapitulation
 Fundamentals of Multipot
 Technical details about Multipot threat
 Why traditional defenses against Evil Twin threat are 
ineffective against Multipot. 
 Threat scenarios that arise due to Multipot
 A demonstration of Multipot threat
Evil Twin - Recap
 Attacker sets up AP with a spoofed SSID
 Client lured into connecting to attacker’s 
AP
 Attacker becomes man-in-the-middle
 Threat is rampant in hotspots, also 
present in homes and campuses
Known Countermeasures
Established Attack Tools: KARMA, 
delegated, hotspotter, Monkey Jack and 
more…
Evil Twin
SSID = XYZ
WiFi 
Client
Legitimate AP
SSID = XYZ
Attacker 
Laptop
Network
WIPS Sensor 
Session 
Containment 
X
Level 1 Defense: Don’t 
let client to be lured
E.g., watchful user, 
layer 2 mutual 
authentication, 
preprogrammed list 
of legitimate AP 
MACs etc.
Known Countermeasures
Level 2 Defense
Use Wireless 
Intrusion Prevention 
System (WIPS) to 
contain wireless 
session to Evil Twin.
Session containment 
via spoofed deauth 
from sensor is 
prevalent
Not foolproof and not 
always practical
Level 2 Defense
Use Wireless 
Intrusion 
Prevention System 
(WIPS) to break 
wireless 
connection to Evil 
Twin.
MultiPot 
Multiple APs Acting as Evil Twin
 Multiple APs with identical SSID 
feeding data into common endpoint
 If traditional WIPS session 
containment is used on one AP, client 
“hops” to another AP in the Multipot 
and continues its communication
Deauth based session 
containment becomes 
ineffective
WiFi 
Client
Attacker 
Laptop
Network
Multipot
SSID=XYZ
Multipot can be combined with: KARMA, 
delegated, hotspotter, Monkey Jack and 
more…
WIPS 
Sensor 
Session 
Containment 
Level 1 Defense: Don’t 
let client to be lured
E.g., watchful user, 
layer 2 mutual 
authentication, 
preprogrammed list 
of legitimate AP 
MACs etc.
Known Countermeasures
Not foolproof and not 
always practical
Legitimate AP
SSID = XYZ
TCP Connection 1
TCP Connection 2
Multipot:
Client communicates 
without any major 
disruption even with  
session containment
WIPS Sensor
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
00010110
Multipot 
Threat in Action!
Session Containment
Man in 
the middle
Man in 
the middle
Same SSID 
On all APs
Multipot 
Threat Analysis: Sensor Behavior
 WIPS sensor detects and deauths client’s connection to 
any AP after finite delay
 Sensor needs to operate on several 802.11 channels 
to detect unauthorized communication
 802.11 G consists of 14 channels in 2.4 GHz band
 802.11 A consists of about 25 channels in 5.0 GHz band
 Sensors may also need to scan proprietary modes such as 
Atheros Turbo 
 Today’s sensors built using commodity hardware 
cannot receive or transmit on all channels 
simultaneously
 Sensor needs to dwell on each channel for a certain time 
(e.g., 100 ms) in a certain order (e.g., round robin)
 Hence, channel scanning and processing delay in a WIPS 
sensor is unavoidable
 Our observation indicates that channel scanning delay can 
be typically around a second, even up to 10 seconds in 
some systems
Multipot 
Threat Analysis: Client Behavior
- 802.11 client reconnection 101
- After receiving a 802.11 deauthentication packet
- An 802.11 client performs a 802.11 MAC connection handshake with an 
AP
- Handshake involves probe, authentication and association phases
Probe 
Phase
Authentication 
Phase
Association 
Phase
Higher Level 
Authentication/
Data Transfer
ReAssociation
Latency
Deauth 
Packet
- MAC connection handshake scheme is not specified in 802.11 
standard
- Vendors implement different heuristics
- Some vendors use aggressive reconnection scheme
Multipot 
Threat Analysis: Client Behavior (Contd.)
ReAssociation Latency
0
10
20
30
40
50
60
70
0
100
200
300
400
500
600
1000
ReAssociation Latency (ms)
Count %
Cisco
Aironet
350
ReAssociation Latency
0
10
20
30
40
50
60
70
80
0
100
200
300
400
500
600
1000
ReAssociation Latency (ms)
Count %
Centrino
2200
ReAssociation Latency
0
20
40
60
80
100
0
100
200
300
400
500
600
1000
ReAssociation Latency (ms)
Count %
Centrino
3945
ReAssociation Latency
0
20
40
60
80
0
100
200
300
400
500
600
1000
ReAssociation Latency (ms)
Count %
Centrino
2915
Centrino & Cisco 350 reassociate to an AP aggressively
We have frequently observed Centrinos reassociate in 30 ms!
Optimizations such as periodic scanning, scanning selected channels seem to be 
implemented
 ReAssociation latency measurements 
 3 popular models of Centrino & Cisco 350 used as clients
 AP used: Dlink DWL-G730AP
 Raw packet deauth injection and simple scripts for timing analysis
Multipot 
Threat Analysis - Summary
 WIPS sensor gets trapped into a cat and mouse 
game due to the above inherent time disparities 
involved
 Client’s wireless application does not see 
disruption while sensor looses the cat and mouse 
game
WIPS sensor detects 
and deauths client’s 
connection to any AP 
after finite delay
(order of seconds)
Clients such as 
Centrino and Cisco 
Aironet 350 cards 
swiftly connect to 
new APs after being 
disconnnected (order 
of milliseconds)
Multipot 
Prevalent Countermeasure Analysis
 As noted earlier
 deauth based session containment is NOT effective 
for Multipots due to association hopping
 Client side software is NOT enough
 Wire-side prevention (e.g., switch port disabling) will 
NOT work for Multipots
 Multipots may not have a controllable switch port 
associated with them as we talking of clients 
connecting to external APs (and NOT rogue APs
connected to a wired network)
Multipot 
Prevalent Countermeasure Analysis (Contd.)
 Starting session containment concurrently (e.g., round 
robin) on all APs in a Multipot will NOT be sufficient
 Reliable containment requires deauth packets to be 
sent at a certain frequency
 A sensor cannot send packets with required 
frequency on multiple (typically more than 2) 
channels 
 Using N Sensors for session containment will NOT work
 Not scaleable
 An attacker can use N+1 APs
 It is relatively easier for an attacker to set up a Multipot 
with N+1 APs
 Setting up of a Multipot with many APs is possible (e.g., 
using Virtual APs, soft APs)
Additional Technical Details 
Multipot Packet Trace for Ping Traffic
Containment for AP 
on ch. 6 prompts 
the client to hop to 
another AP on ch. 
11 (not seen)
Containment for AP on 
ch. 11 prompts the 
client to return to AP on 
ch. 6. Traffic flows on 
ch. 6 (seen)
Containment for AP on 
ch. 6 prompts the client 
to hop to another AP on 
ch. 11. Traffic flows on 
ch. 11 (not seen)
Additional Technical Details 
Multipot Packet Trace for HTTP Traffic
Containment for AP 
on ch. 6 prompts 
the client to hop to 
another AP on ch. 
11 (not seen)
Containment for AP on 
ch. 11 prompts the 
client to return to AP on 
ch. 6. Traffic flows on 
ch. 6 (seen)
Containment for AP on 
ch. 6 prompts the client 
to hop to another AP on 
ch. 11. Traffic flows on 
ch. 11 (not seen)
Additional Technical Details 
Multipot Packet Trace Showing Association Hopping
Multipot Threat Scenarios 
Scenario 1: Naturally Occurring Habitat
 Enterprise/Campus network scenario
Enterprises/campuses have policies against their clients connecting 
to public APs (e.g., Metro WiFi) or open neighbor APs
Multiple APs with identical SSIDs are naturally present in such 
scenarios creating a Multipot
Traditional WIPS session containment fails to stop non-policy 
compliant connections to such Multipots!
WiFi 
Client
Enterprise AP
SSID=XYZ
Internet
Multipot
SSID=Metro WiFi 
Firewall
Non-Policy Compliant Traffic
Multipot Threat Scenarios 
Scenario 2: Handcrafted Variants
 Public Hotspot scenario
Multipots can be handcrafted with malicious intentions
Attacker can setup a Multipot to lure clients at public hotspots
Once a client connection to Multipot is established, the attacker can 
perform various man-in-the-middle attacks using popular tools 
(KARMA, hotspotter etc.)
Traditional WIPS countermeasure fails to defend against such 
attacker
WiFi 
Client
Hotspot AP
SSID=XYZ
Internet
Multipot
SSID=XYZ 
Attacker 
Laptop
ISP Firewall
Man in the
Middle
Related Works of Other Researchers 
Conjectures on Evading WIPS (Traditional Session 
Containment)
 In his May 2005 paper titled “Weaknesses in Wireless LAN 
Session Containment”, Joshua Wright concluded that: 
“[S]ession containment can be a valuable mechanism to 
augment a secure wireless network deployment. The use of 
session containment does not come without risks however, 
including WLAN IDS fingerprinting and possible evasion.”
 No specific evasion scenario is mentioned
 In this presentation we presented a real life scenario 
which can be naturally occurring or deliberately 
deployed to evade traditional deauth based session 
containment.
 DARPA and Department of Homeland Security funded 
project MAP (Measure, Analyze and Protect), which is aimed 
at developing defenses against wireless based attacks
 One of the motivations for MAP is the fact that wireless 
attackers may use evasive techniques in the future to 
bypass WIPS defense
Related Works of Other Researchers 
Recognition that Wireless Threats in the Future can 
be Evasive 
Demonstration
ACKNOWLEDGEMENTS: Sohail, Amit
Demo Setup 
Testbed
Session 
Containment 
Multipot
SSID=XYZ 
Attacker 
Laptop
Centrino WiFi 
Client
Laptop based 
Sensor
Demo Setup 
What will be Seen?
 Centrino victim client swiftly hopping between APs 
in the Multipot in response to deauth session 
containment 
 Ping progress well when both APs in the Multipot 
are on and sensor is chasing the wireless 
connection to deauth 
ACKNOWLEDGEMENTS
AirTight Team
Hemant, Pravin (Presentation review)
Debu (Presentation graphics)
References
1. 
Joshua Wright, Weaknesses in Wireless LAN Session Containment, 
5/19/2005,  
http://i.cmpnet.com/nc/1612/graphics/SessionContainme 
nt_file.pdf
2. 
Jon Cox, Researchers crafting intelligent scaleable WLAN defense, 
Networkworld, Dec 2006, 
http://www.networkworld.com/news/2006/120706- 
intelligent-scaleable-wlan-defense-darpa.html
3. 
Christopher Null, Beware the “Evil Twin” Wi-Fi Hotspot, 
http://tech.yahoo.com/blogs/null/23163/beware-the-evil- 
twin-wi-fi-hotspot
4. 
CNN, 'Evil twin' threat to Wi-Fi users, 
http://www.cnn.com/2005/TECH/internet/01/20/evil.twin 
s/index.html
5. 
KARMA, http://www.theta44.org/karma/
6. 
Delegated, http://www.delegate.org/delegate/mitm/
7. 
Airsnarf, http://airsnarf.shmoo.com/
8. 
Hotspotter, http://www.remote- 
exploit.org/codes_hotspotter.html
9. 
Monkey jack, http://sourceforge.net/projects/airjack/
Thank You 
PI:EMAIL