### 侠盗猎车——数字钥匙Hacking
#### 演讲人：@Kevin2600, @MonkeyKing
#### 2018

---

#### #Whoami
- **@Kevin2600**
  - 银基安全研究员
  - 专注于无线电和嵌入式系统安全
  - 参与的会议: KCON, XCON, 阿里先知, BESIDES, OZSECON, DEFCON26

---

## 目录
1. 汽车钥匙简史
2. 安米钥匙架构 & 功能
3. 安米钥匙攻击点分析
   - RF 干扰攻击
   - 钥匙共享分析
   - 蓝牙加密破解

---

## 第一部分：汽车钥匙简史
### 汽车钥匙 101
- **机械钥匙**（仍在使用）
- **远程控制**（红外线、固定码、滚动码）
- **RFID**（无线射频车辆身份编码识别）
- **数字钥匙**（手机作为钥匙，未来趋势）

### 经典案例
- 2008年：RKE KeeLoq算法被破解
- 2012年：被动无钥匙进入系统中的中继攻击
- 2012年：Hitag2芯片在60秒内被劫持
- 2015年：Samy的Rolljam攻击
- 2015年：宝马ConnectedDrive远程信息处理系统被黑
- 2016年：三菱Outlander Wi-Fi被PenTestPartners攻破
- 2018年：KeenLab发现宝马联网汽车中的14个漏洞

---

## 第二部分：安米钥匙架构 & 功能
### 数字钥匙 —— 安米
#### 功能
- 无钥匙进入系统
- 无钥匙启动/停止
- 蓝牙低功耗4.0
- 自动锁/解锁功能
- 手机作为钥匙（支持Android和iPhone）
- 远程钥匙共享（最多20个用户）

#### 组件
- **BTLE模块 (CC2640)**：通过2.4GHz与手机APP通信
- **RF模块 (NXP-61X0915)**：向车辆发送解锁/锁定命令。不同车型使用的RF模块可能不同
- **BTLE模块 (SYD8801)**：2.4GHz BTLE SoC，32位ARM Cortex-M0，具体功能未知

#### 传感器
- 振荡器频率：13.560MHz
- 计算：
  - 13.560MHz / 8000 = 1695Hz
  - 13.560MHz * 32 = 433.92MHz
- 使用SDR-HackRF和SDR-GQRX进行测试

#### 安米APP
- 支持多种功能
- 服务器端数据存储

#### 加密
- 1字节加密密钥
- 使用XOR作为加密算法
- 所需参数可通过蓝牙抓包获取

---

## 第三部分：安米钥匙攻击点分析
### RF干扰攻击
- **RF干扰器**：演示如何使用RF干扰器影响安米钥匙的单向通信

### 钥匙共享分析
- **共享功能**：微信共享
- **潜在问题**：
  - 删除账号
  - 账号过期

### 蓝牙加密破解
- **BTLE数据包分析**
- **登录验证**
- **登录算法**
- **登录协议**
- **加密算法**：
  - 1字节加密密钥
  - 使用XOR作为加密算法
  - 所需参数可通过蓝牙抓包获取

#### 演示
- 蓝牙抓包
- 构造数据包

---

## 总结
- **安全性不应依赖于隐蔽性**
- **绝对的安全并不存在**
- **新的技术趋势会带来新的攻击点**
- **持续的安全测试是必要的**

---

谢谢观看！

演讲人：@Kevin2600, @MonkeyKing