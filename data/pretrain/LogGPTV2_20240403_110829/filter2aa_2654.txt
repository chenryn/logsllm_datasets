侠盗猎车——数字钥匙Hacking 
演讲人：@Kevin2600    @MonkeyKing
2 0 1 8
#Whoami
@Kevin2600
 银基安全研究员
专注无线电和嵌入式系统安全
会棍: KCON; XCON; 阿里先知; BESIDES; OZSECON; DEFCON26
PART 01
汽车钥匙简史 101
目录
CONTENTS
PART 02
安米钥匙架构 & 功能
PART 03
安米钥匙攻击点分析
RF 干扰攻击
钥匙共享分析 
蓝牙加密破解
01
02
03
PART 
01
汽车钥匙简史
汽车钥匙 101
•
机械钥匙 (仍在使用)
•
远程控制 (红外线; 固定码; 滚动码)
•
RFID (无线射频车辆身份编码识别）
•
数字钥匙 (手机即为钥匙未来趋势)
新趋势 ?
经典案例
•
RKE KeeLoq algorithm cracked (2008)
•
Passive Keyless entry Keyfob Relay attack (2012) 
•
Gone in 60 seconds -- Hijacking with Hitag2 (2012)
•
Samy's Rolljam -- Drive it like you hacked it (2015) 
•
BMW ConnectedDrive -- Telematics hacked (2015)
•
Mitsubishi Outlander WIFI Hacked -- PenTestPartners (2016)
•
14 vulnerabilities found in BMW connected cars -- KeenLab (2018)
新趋势 新HACK — 2015
新趋势 新HACK — 2016
PART 
02
安米钥匙架构 & 功能
数字钥匙 —— 安米
功能
•
Keyless Entrance System
•
Keyless Engine Start/Stop 
•
Bluetooth Low Energy 4
•
 Auto Lock/Unlock Function
•
Mobile as Key (Android; Iphone)
•
Remote Keys Sharing (20 Users)
安米部件
安米配对
支持车型
安米内部1
安米内部2
安米内部3
•
B T L E - M o d u l e ( C C 2 6 4 0 ) to communicate 
with mobile APP through 2.4ghz
•
RF-Module(NXP-61X0915) Emits unlock/lock cmd to 
the vehicle. RF-module vary from different car models
•
BTLE-Module (SYD8801) sensor. 2.4GHz BTLE SOC 32-
bit ARM Cortex-M0. Functionality unknown ?
神秘的传感器
神秘的传感器
无线模块
Oscillator: 13.560Mhz
Math:
13.560MHz / 8000 = 1695hz
13.560MHz * 32 = 433.92Mhz
SDR-HackRF
SDR-GQRX
蓝牙模块
蓝牙模块
蓝牙模块
安米APP
安米APP
安米APP
安米APP
安米APP
安米APP—Server
毫无隐私可言....
Encryption ?
超级安全？
PART 
03
安米钥匙攻击点—RF 干扰攻击 
RF-干扰器 
RF-干扰器 
安米安全否？
安米单向通讯...
演示:
PART 
04
安米钥匙攻击点—钥匙共享分析
共享功能
共享功能
What could possibly go wrong ?  
微信共享
微信共享
演示：
删除账号 ?  
演示：
账号过期 ?  
演示：
PART 
05
安米钥匙攻击点 —蓝牙加密破解
BTLE—数据包分析
BTLE—数据包分析
BTLE—数据包分析
BTLE -- 1st 尝试
BTLE—登录验证
BTLE—登录算法
BTLE—登录协议
BTLE—登录算法
BTLE—登录算法
BTLE—登录算法
Login—加密算法
•
1-byte of encryption key
•
使用 XOR 作为所谓的加密算法 
•
所需参数均可通过蓝牙抓包获取
Login—蓝牙抓包
Login—蓝牙抓包
Login—Crafting Packets
演示：
漏洞报告？
总结
•
Security by obscurity ???
•
100 % 的绝对安全并不存在
•
新的趋势将会带来新的攻击点
•
安全测试 + 安全测试 + 安全测试
谢谢观看
演讲人： @Kevin2600    @MonkeyKing