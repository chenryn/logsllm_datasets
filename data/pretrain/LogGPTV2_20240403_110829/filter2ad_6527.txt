title:Traffic Classification Using a Statistical Approach
author:Denis Zuev and
Andrew W. Moore
Trafﬁc Classiﬁcation Using a Statistical Approach
Denis Zuev1 and Andrew W. Moore2
1 University of Oxford, Mathematical Institute
PI:EMAIL(cid:1)
2 University of Cambridge, Computer Laboratory
PI:EMAIL(cid:1)(cid:1)
Abstract. Accurate trafﬁc classiﬁcation is the keystone of numerous network
activities. Our work capitalises on hand-classiﬁed network data, used as input to
a supervised Bayes estimator. We illustrate the high level of accuracy achieved
with a supervised Na¨ıveBayes estimator; with the simplest estimator we are able
to achieve better than 83% accuracy on both a per-byte and a per-packet basis.
1
Introduction
Trafﬁc classiﬁcation enables a variety of other applications and topics, including Quality
of Service, security, monitoring, and intrusion-detection that are of use to researchers,
accountants, network operators and end users. Capitalising on network trafﬁc that had
been previously hand-classiﬁed provides us with training and testing data-sets. We use a
supervised Bayes algorithm to demonstrate an accuracy of better than 66% of ﬂows and
better than 83% for packets and bytes. Further, we require only the network protocol
headers of unknown trafﬁc for a successful classiﬁcation stage.
While machine-learning has been used previously for network-trafﬁc/ﬂow classiﬁ-
cation e.g., [1], we consider our work to be the ﬁrst that combines this technique with
the use of accurate test and training data-sets.
2
Experiment
In order to perform analysis of data using the Na¨ıveBayes technique, appropriate in-
put data is needed. To do this, we capitalised on trace-data described and categorised
in [2]. This classiﬁed data was further reduced, and split into 10 equal time intervals
each containing around 25,000–65,000 objects (ﬂows). To evaluate the performance of
the Na¨ıveBayes technique, each dataset was used as a training set in turn and evalu-
ated against the remaining datasets, allowing computation of the average accuracy of
classiﬁcation.
Trafﬁc Categories. Fundamental to classiﬁcation work is the idea of classes of trafﬁc.
Throughout this work we use classes of trafﬁc deﬁned as a common group of user-
centric applications. Other users of classiﬁcation may have both simpler deﬁnitions,
(cid:1) This work was completed when Denis Zuev was employed by Intel Research, Cambridge.
(cid:1)(cid:1) Andrew Moore thanks the Intel Corporation for its generous support of his research fellowship.
C. Dovrolis (Ed.): PAM 2005, LNCS 3431, pp. 321–324, 2005.
c(cid:1) Springer-Verlag Berlin Heidelberg 2005
322
D. Zuev and A.W. Moore
e.g., Normal versus Malicious, or more complex deﬁnitions, e.g., the identiﬁcation of
speciﬁc applications or speciﬁc TCP implementations.
Described further in [2], we consider the following categories of trafﬁc: BULK
(e.g., ftp), DATABASE (i.e., postgres, etc.), INTERACTIVE (ssh, telnet), MAIL (smtp,
etc.), SEVICES (X11, dns), WWW, P2P (e.g., KaZaA, . . . ), ATTACK (virus and worm
attacks), GAMES (Half-Life, . . . ), MULTIMEDIA (Windows Media Player, . . . ).
Importantly, the characteristics of the trafﬁc within each category are not necessarily
unique. For example, the BULK category which is made up of ftp trafﬁc, consists of
both the control channel, which transfers data in both directions, and the data channel
consisting a simplex ﬂow of data for each object transferred. The assignment of categories
to applications is an artiﬁcial grouping that further illustrates that such arbitrary clustering
of only-minimally-related trafﬁc-types is possible with our approach.
Objects and Discriminators. Our central object for classiﬁcation is the ﬂow and for
the work presented in this extended-abstract we have limited our deﬁnition of a ﬂow to
being a complete TCP ﬂow — that is all the packets between two hosts for a speciﬁc
tuple. We restrict ourselves to complete ﬂows, those that start and end validly, e.g., with
the ﬁrst SYN, and the last FIN ACK.
As noted in Section 1, the application of a classiﬁcation scheme requires the parame-
terisation of each object to be classiﬁed. Using these parameters, the classiﬁer allocates
an object to a class, due to their ability to allow discrimination between classes. We
refer to these object-describing parameters as discriminators. In our research we have
used 249 different discriminators to describe trafﬁc ﬂows, these include: ﬂow duration
statistics, TCP Port information, payload size statistics, fourier transform of the packet
interarrival time discriminators — a complete list is given in [3].
3 Method
Machine Learned Classiﬁcation. Here we brieﬂy describe the machine learning (ML)
approach we take, a trained Na¨ıveBayes classiﬁer, along with a number of the reﬁnements
we use. We would direct interested readers to [4] for one of many surveys of all ML
techniques.
Several methods exist for classifying data and all of them fall into two broad classes:
deterministic and probabilistic classiﬁcation. As the name suggests, deterministic clas-
siﬁcation assigns data points to one of a number of mutually-exclusive classes. This is
done by considering some metric that deﬁnes the distance between data points and by
deﬁning the class boundaries. On the other hand, the probabilistic method classiﬁes data
by assigning it with probabilities of belonging to each class of interest.
We believe that probabilistic classiﬁcation of Internet trafﬁc, and our approach in
particular, is more suitable given the need to be robust to measurement error, to allow
for supervised training with pre-classiﬁed trafﬁc, to be able to identify similar character-
istics of ﬂows after their probabilistic class assignment. We believe that the method be
tractable and understood, and be able to cope with the unstable-dynamic nature of Inter-
net trafﬁc and that the method allow identiﬁcation of when the model requires retraining.
Additionally, the method needs to be available in a number of implementations.
Trafﬁc Classiﬁcation Using a Statistical Approach
323
Na¨ıve BayesianClassiﬁer. The main approach that is used in this work is the Na¨ıveBayes
technique described in [5]. Consider a collection of ﬂows x = (x1, . . . , xn), where each
ﬂow xi is described by m discriminators {d(i)
m } that can take either numeric
1 , . . . , d(i)
or discrete values. In the context of the Internet trafﬁc, d(i)
is a discriminant of ﬂow xi,
for example it may represent the mean interarrival time of packets in the ﬂow xi. In this
paper, ﬂows xi belong to exactly one of the mutually-exclusive classes described in Sec-
tion 2. The supervised Bayesian classiﬁcation problem deals with building a statistical
model that describes each class based on some training data, and where each new ﬂow y
receives a probability of getting classiﬁed into a particular class according to the Bayes
rule below,
j
p(cj | y) = p(cj)f(y | cj)
p(cj)f(y | cj)
(cid:1)
cj
(1)
where p(cj) denotes the probability of obtaining class cj independently of the observed
data, f(y | cj) is the distribution function (or the probability of y given cj) and the
denominator acts as a normalising constant.
The Na¨ıveBayes technique that is considered in this paper assumes the independence
of discriminators d1, . . . , dm as well as the simple Gaussian behaviour of them. The
authors understand that these assumptions are not realistic in the context of the Internet
trafﬁc, but [5] suggest that this model sometimes outperforms certain more complex
models.
4 Na¨ıve Bayes Results
Our experiments have shown that the Na¨ıveBayes technique classiﬁed on average 66.71%
of the trafﬁc correctly. Table 1 demonstrates the classiﬁcation accuracy of this techinique
for each class. It can be seen from this table, that SERVICES and BULK are very well
classiﬁed, with around 90% of correctly-predicted ﬂows. In comparision to other re-
sults, it could be concluded that most discriminator distributions are well separated in
the Euclinean space.
Table 1. Average accuracy of classiﬁcation of Na¨ıveBayes technique by class and Probability that
the predictive class is the real class
WWW MAIL BULK SERV DB INT P2P ATT MMEDIA GAMES
Accuracy (%) 65.97 56.85 89.26 91.19 20.20 22.83 45.59 58.08
Probability (%) 98.31 90.69 90.01 35.92 61.78 7.54 4.96 1.10
59.45
32.30
1.39
100.00
At this stage, it is important to note why certain classes performed very poorly.
Classes such as GAMES and INTERACTIVE do not contain enough samples, therefore,
Na¨ıveBayes training on these classes is not accurate or realistic. ATTACK ﬂows were
often confused with the WWW ﬂows, due to the similarity in discriminators.
324
D. Zuev and A.W. Moore
Alongside accuracy we consider it important to deﬁne several other metrics describ-
ing the classiﬁcation technique. Table 1 shows how trafﬁc from different classes gets
classiﬁed — clearly an important measure. However, if a network administrator were
to use our tool they would be interested in ﬁnding out how much trust can be placed in
the classiﬁcation outcome. Table 1 also shows the average probability that the predicted
ﬂow class is in fact the real class, e.g., if ﬂow xi has been classiﬁed as WWW, a measure
of trust gives us a probability that xi is in reality WWW.
A further indication of how well the Na¨ıveBayes technique performs is to analyse the
volume of accurately-classiﬁed bytes and packets. The results obtained are: 83.98% and
83.93% of packets and bytes, respectively, were correctly classiﬁed by the Na¨ıveBayes
technique described above. In contrast port-based classiﬁcation achieved an accuracy
of 71.02% by packet and 69.07% by bytes (from [2]). Comparing results in this way
highlights the signiﬁcant improvement of our Na¨ıveBayes technique over the port-based
classiﬁcation alone.
5 Conclusions and Further Work
We demonstrate that, in its simplest form, our probabilistic-classiﬁcation is capable
of 67% accuracy per-ﬂow or better than 83% accuracy both per-byte and per-packet.
We maintain that access to a full-payload trace, the only deﬁnitive way to characterise
network applications, will be limited due to technical and legal restrictions. We illustrate
how data gathered without those restrictions may be used as training input for a statistical
classiﬁer which in turn can provide accurate, albeit estimated, classiﬁcation of header-
only trace data.
References
1. Anthony McGregor et al.: Flow Clustering Using Machine Learning Techniques. In: Proceed-
ings of the Fifth Passive and Active Measurement Workshop (PAM 2004). (2004)
2. Moore, A.W., Papagiannaki, K.: Toward the accurate identiﬁcation of network applications.
In: Passive & Active Measurement Workshop 2005 (PAM2005), Boston, MA (2005)
3. Moore, A., Zuev, D.: Discriminators for use in ﬂow-based classiﬁcation. Technical Report,
Intel Research, Cambridge (2005)
4. Mitchell, T.: Machine Learning. McGraw Hill (1997)
5. Witten, I.H., Frank, E.: Data Mining. Morgan Kaufmann Publishers (2000)