The JEDI cryptography library is available at https://
github.com/ucbrise/jedi-pairing and our implementa-
tion of the JEDI protocol for bw2 is available at https:
//github.com/ucbrise/jedi-protocol.
Acknowledgments
We thank our anonymous reviewers and our shepherd William
Enck for their invaluable feedback. We would also like to
thank students from the RISE Security Group and BETS Re-
search Group for giving us feedback on early drafts of this pa-
per. This research was supported by Intel/NSF CPS-Security
#1505773 and #20153754, DoE #DE-EE000768, California
Energy Commission #EPC-15-057, NSF CISE Expeditions
#CCF-1730628, NSF GRFP #DGE-1752814, and gifts from
the Sloan Foundation, Hellman Fellows Fund, Alibaba, Ama-
zon, Ant Financial, Arm, Capital One, Ericsson, Facebook,
Google, Intel, Microsoft, Scotiabank, Splunk and VMware.
References
[1] M. Abdalla, E. Kiltz, and G. Neven. Generalized key
delegation for hierarchical identity-based encryption.
Cryptology ePrint Archive, Report 2007/221.
[2] S. G. Akl and P. D. Taylor. Cryptographic solution to a
problem of access control in a hierarchy. TOCS, 1983.
[3] M. P Andersen, G. Fierro, and D. E. Culler. System
design for a synergistic, low power mote/BLE embedded
platform. In IPSN, 2016.
[4] M. P. Andersen, H.-S. Kim, and D. E. Culler. Hamilton -
a cost-effective, low power networked sensor for indoor
environment monitoring. In BuildSys, 2017.
[5] M. P. Andersen, J. Kolb, K. Chen, D. E. Culler, and
R. Katz. Democratizing authority in the built environ-
ment. In BuildSys, 2017.
[6] M. P Andersen, S. Kumar, M. AbdelBaky, G. Fierro,
J. Kolb, H.-S. Kim, D. E. Culler, and R. A. Popa. WAVE:
A decentralized authorization framework with transitive
delegation. In USENIX Security, 2019.
[7] P. Arjunan, N. Batra, H. Choi, A. Singh, P. Singh, and
M. B. Srivastava. SensorAct: A privacy and security
aware federated middleware for building management.
In BuildSys, 2012.
[8] M. J. Atallah, M. Blanton, N. Fazio, and K. B. Frikken.
Dynamic and efﬁcient key management for access hier-
archies. In TISSEC, 2009.
[9] M. J. Atallah, M. Blanton, and K. B. Frikken. Incorpo-
rating temporal capabilities in existing key management
schemes. In ESORICS, 2007.
[10] N. Attrapadung and H. Imai. Conjunctive broadcast and
attribute-based encryption. In ICPBC, 2009.
[11] S. Belguith, S. Cui, M. R. Asghar, and G. Russello. Se-
cure publish and subscribe systems with efﬁcient revo-
cation. In SAC, 2018.
[12] J. Bethencourt, A. Sahai, and B. Waters. Ciphertext-
policy attribute-based encryption. In S&P, 2007.
[13] A. Birgisson, J. G. Politz, Ú. Erlingsson, A. Taly,
M. Vrable, and M. Lentczner. Macaroons: Cookies
with contextual caveats for decentralized authorization
in the cloud. In NDSS, 2014.
[14] M. Blaze, G. Bleumer, and M. Strauss. Divertible pro-
tocols and atomic proxy cryptography. EUROCRYPT,
1998.
[15] A. Boldyreva, V. Goyal, and V. Kumar. Identity-based
encryption with efﬁcient revocation. In CCS, 2008.
[16] D. Boneh and X. Boyen. Efﬁcient selective-ID secure
identity-based encryption without random oracles. In
EUROCRYPT, 2004.
[17] D. Boneh, X. Boyen, and E.-J. Goh. Hierarchical iden-
tity based encryption with constant size ciphertext. In
1534    28th USENIX Security Symposium
USENIX Association
EUROCRYPT and Cryptology ePrint Archive, 2005.
[18] D. Boneh and M. Franklin. Identity-based encryption
from the Weil pairing. In CRYPTO, 2001.
[19] D. Boneh, C. Gentry, and B. Waters. Collusion resistant
broadcast encryption with short ciphertexts and private
keys. In CRYPTO, 2005.
[20] D. Boneh and B. Waters. A fully collusion resistant
broadcast, trace, and revoke system. In CCS, 2006.
[21] D. Boneh, B. Waters, and M. Zhandry. Low over-
head broadcast encryption from multilinear maps. In
CRYPTO, 2014.
[22] D. Boneh and M. Zhandry. Multiparty key exchange, ef-
ﬁcient traitor tracing, and more from indistinguishability
obfuscation. Algorithmica, 2017.
[23] C. Borcea, A. B. D. Gupta, Y. Polyakov, K. Rohloff,
and G. Ryan.
PICADOR: End-to-end encrypted
publish-subscribe information distribution with proxy
re-encryption. FGCS, 2017.
[24] S. Bowe.
BLS12-381: New zk-SNARK elliptic
curve construction, 2018. https://z.cash/blog/new-
snark-curve/.
[25] A. Brandt, J. Hui, R. Kelsey, P. Levis, K. Pister, R. Struik,
J. P. Vasseur, and R. Alexander. RPL: IPv6 routing
protocol for low-power and lossy networks. RFC, RFC
Editor, 2012.
[26] D. Brunelli, I. Minakov, R. Passerone, and M. Rossi.
POVOMON: An ad-hoc wireless sensor network for
indoor environmental monitoring. In EESMS, 2014.
[27] bw2. https://github.com/immesys/bw2.
[28] B. Campbell.
Introducing Hail, 2017.
https://
www.tockos.org/blog/2017/introducing-hail/.
[29] R. Cheng, W. Scott, B. Parno, I. Zhang, A. Krishna-
murthy, and T. Anderson. Talek: A private publish-
subscribe protocol. Technical report, University of
Washington CSE, 2016.
[30] Cisco. The Internet of things reference model. Technical
report, Cisco, 2014.
[31] D. Clarke, J.-E. Elien, C. Ellison, M. Fredette, A. Mor-
cos, and R. L. Rivest. Certiﬁcate chain discovery in
SPKI/SDSI. Journal of Computer Security, 2001.
[32] H. Corrigan-Gibbs, D. Boneh, and D. Mazières. Riposte:
An anonymous messaging system handling millions of
users. In S&P, 2015.
[33] J. Crampton, N. Farley, G. Gutin, M. Jones, and B. Poet-
tering. Cryptographic enforcement of information ﬂow
policies without public information. In ACNS, 2015.
[34] J. Crampton, K. Martin, and P. Wild. On key assignment
for hierarchical access control. In CSFW, 2006.
[35] S. Dawson-Haggerty, X. Jiang, G. Tolle, J. Ortiz, and
D. E. Culler. sMAP: A simple measurement and actua-
tion proﬁle for physical information. In SenSys, 2010.
[36] S. Dawson-Haggerty, A. Krioukov, J. Taneja,
S. Karandikar, G. Fierro, N. Kitaev, and D. E.
Culler. BOSS: Building operating system services. In
NSDI, 2013.
[37] Y. Dodis and N. Fazio. Public key broadcast encryption
for stateless receivers. In DRM, 2002.
[38] P. Dutta, D. E. Culler, and S. Shenker. Procrastination
might lead to a longer and more useful life. In HotNets,
2007.
[39] M. Egorov and M. Wilkison. NuCypher KMS: decen-
tralized key management system. CoRR, 2017.
[40] DigiKey Electronics. Atsamr21e18a-mu microchip tech-
nology. Feb. 8, 2019.
[41] M. C. Feldmeier. Personalized Building Comfort Con-
trol. PhD thesis, MIT, 2009.
[42] G. Fierro and D. E. Culler. XBOS: An extensible build-
ing operating system. Technical report, EECS Depart-
ment, University of California, Berkeley, 2015.
[43] Filecoin. https://filecoin.io. Jan. 19, 2018.
[44] T. Frosch, C. Mainka, C. Bader, F. Bergsma, J. Schwenk,
and T. Holz. How secure is TextSecure? In EuroS&P,
2016.
[45] C. Gentry and S. Halevi. Hierarchical identity based
In TCC,
encryption with polynomially many levels.
2009.
[46] C. Gentry and A. Silverberg. Hierarchical ID-based
cryptography. In ASIACRYPT, 2002.
[47] E.-J. Goh, H. Shacham, N. Modadugu, and D. Boneh.
SiRiUS: Securing remote untrusted storage. In NDSS,
2003.
[48] V. Goyal, O. Pandey, A. Sahai, and B. Waters. Attribute-
based encryption for ﬁne-grained access control of en-
crypted data. In CCS, 2006.
[49] Hamilton IoT. https://hamiltoniot.com/.
[50] Y.-C. Hu, M. Jakobsson, and A. Perrig. Efﬁcient con-
structions for one-way hash chains. In ACNS, 2005.
[51] H.-F. Huang and C.-C. Chang. A new cryptographic key
assignment scheme with time-constraint access control
in a hierarchy. Computer Standards & Interfaces, 2004.
[52] J. Hviid and M. B. Kjaergaard. Activity-tracking service
for building operating systems. In PerCom, 2018.
[53] imix: Low-power IoT research platform, 2017. https:
//github.com/helena-project/imix.
[54] M. Kallahalla, E. Riedel, R. Swaminathan, Q. Wang, and
K. Fu. Plutus: Scalable secure ﬁle sharing on untrusted
storage. In FAST, 2003.
[55] H.-S. Kim, M. P. Andersen, K. Chen, S. Kumar, W. J.
Zhao, K. Ma, and D. E. Culler. System architecture
directions for post-SoC/32-bit networked sensors. In
SenSys, 2018.
[56] A. Krioukov, G. Fierro, N. Kitaev, and D. E. Culler.
USENIX Association
28th USENIX Security Symposium    1535
Building application stack (BAS). In BuildSys, 2012.
[57] S. Kumar, Y. Hu, M. P Andersen, R. A. Popa, and D. E.
Culler. JEDI: Many-to-many end-to-end encryption and
key delegation for IoT. CoRR, 2019.
[58] A. Lewko, A. Sahai, and B. Waters. Revocation systems
with very small private keys. In S&P, 2010.
[59] C. Li, Z. Li, M. Li, F. Meggers, A. Schlueter, and H. B.
Lim. Energy efﬁcient HVAC system with distributed
sensing and control. In ICDCS, 2014.
[60] B. Libert, T. Peters, and M. Yung. Group signatures
with almost-for-free revocation. In CRYPTO, 2012.
[61] B. Libert, T. Peters, and M. Yung. Scalable group signa-
tures with revocation. In EUROCRYPT, 2012.
[62] B. Libert and D. Vergnaud. Adaptive-ID secure revoca-
ble identity-based encryption. In CT-RSA, 2009.
[63] W. Liu, J. Liu, Q. Wu, B. Qin, D. Naccache, and H. Fer-
radi. Compact CCA2-secure hierarchical identity-based
broadcast encryption for fuzzy-entity data sharing. Cryp-
tology ePrint Archive, Report 2016/634.
[64] D. Malkhi, M. Merritt, and O. Rodeh. Secure reliable
multicast protocols in a WAN. Dist. Computing, 2000.
[65] D. Malkhi and M. Reiter. A high-throughput secure
reliable multicast protocol. Computer Security, 1997.
[66] A. Mehanovic, T. H. Rasmussen, and M. B. Kjærgaard.
Brume - a horizontally scalable and fault tolerant build-
ing operating system. In IoTDI, 2018.
[67] D. Naor, M. Naor, and J. Lotspiech. Revocation and
In CRYPTO,
tracing schemes for stateless receivers.
2001.
[68] A. L. M. Neto, A. L. F. Souza, I. Cunha, M. Nogueira,
I. O. Nunes, L. Cotta, N. Gentille, A. A. F. Loureiro,
D. F. Aranha, H. K. Patil, and L. B. Oliveira. AoT: Au-
thentication and access control for the entire IoT device
life-cycle. In SenSys, 2016.
[69] Particle Mesh. https://www.particle.io/mesh. Feb.
2, 2019.
[70] A. Perrig, R. Szewczyk, V. Wen, D. E. Culler, and J. D.
Tygar. SPINS: Security protocols for sensor networks.
In MobiCom, 2001.
[71] J. H. Seo and K. Emura. Efﬁcient delegation of key
generation and revocation functionalities in identity-
based encryption. In CT-RSA, 2013.
[72] J. H Seo and K. Emura. Revocable identity-based en-
cryption revisited: Security model and construction. In
PKC, 2013.
[73] J. H. Seo and K. Emura. Revocable hierarchical identity-
based encryption: History-free update, security against
insiders, and short ciphertexts. In CT-RSA, 2015.
[74] H. Shafagh, L. Burkhalter, S. Duquennoy, A. Hithnawi,
and S. Ratnasamy. Droplet: Decentralized authorization
for IoT data streams. CoRR, 2018.
[75] H. Shafagh, A. Hithnawi, L. Burkhalter, P. Fischli, and
S. Duquennoy. Secure sharing of partially homomorphic
encrypted IoT data. In SenSys, 2017.
[76] Solace cloud. https://solace.com. Jan. 17, 2018.
[77] A. Taly and A. Shankar. Distributed authorization in
Vanadium. In FOSAD VIII, 2016.
[78] M. A. Tariq, B. Koldehofe, and K. Rothermel. Securing
broker-less publish/subscribe systems using identity-
based encryption. TPDS, 2014.
[79] V. Tron, A. Fischer, and N. Johnson. Smash-proof: Au-
ditable storage for Swarm secured by masked audit se-
cret hash. Technical report, Ethersphere, 2016.
[80] W.-G. Tzeng. A time-bound cryptographic key assign-
ment scheme for access control in a hierarchy. TKDE,
2002.
[81] J. van den Hooff, D. Lazar, M. Zaharia, and N. Zeldovich.
Vuvuzela: Scalable private messaging resistant to trafﬁc
analysis. In SOSP, 2015.
[82] VOLTTRON. https://volttron.org/. Jan. 23, 2019.
[83] F. Wang, J. Mickens, N. Zeldovich, and V. Vaikun-
tanathan. Sieve: Cryptographically enforced access
control for user data in untrusted clouds. NSDI, 2016.
[84] G. Wang, Q. Liu, and J. Wu. Hierarchical attribute-
based encryption for ﬁne-grained access control in cloud
storage services. In CCS, 2010.
[85] G. Wang, Q. Liu, J. Wu, and M. Guo. Hierarchical
attribute-based encryption and scalable user revocation
for sharing data in cloud servers. Computers & Security,
2011.
[86] Y. Watanabe, K. Emura, and J. H. Seo. New revoca-
ble IBE in prime-order groups: Adaptively secure, de-
cryption key exposure resistant, and with short public
parameters. In CT-RSA, 2017.
[87] D. J. Wu, A. Taly, A. Shankar, and D. Boneh. Privacy,
discovery, and authentication for the Internet of things.
In ESORICS, 2016.
[88] D. Yao, N. Fazio, Y. Dodis, and A. Lysyanskaya. ID-
based encryption for complex hierarchies with applica-
tions to forward security and broadcast encryption. In
CCS, 2004.
[89] W. Ye, J. Heidemann, and D. Estrin. An energy-efﬁcient
MAC protocol for wireless sensor networks. In INFO-
COM, 2002.
[90] S. Yu, C. Wang, K. Ren, and W. Lou. Achieving secure,
scalable, and ﬁne-grained data access control in cloud
computing. In INFOCOM, 2010.
[91] T. Zachariah, N. Klugman, B. Campbell, J. Adkins,
N. Jackson, and P. Dutta. The Internet of things has
a gateway problem. In HotMobile, 2015.
[92] Zigbee gateway. https://www.zigbee.org/zigbee-
for-developers/zigbee-gateway/. Feb. 13, 2019.
1536    28th USENIX Security Symposium
USENIX Association