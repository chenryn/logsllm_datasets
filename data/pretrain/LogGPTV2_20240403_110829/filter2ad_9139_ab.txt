### 4.2 黑客攻击工具

#### 4.2.1 DDoS僵尸网络木马传播方式
无论是哪种类型的僵尸网络，被感染的设备（即“肉鸡”）都是执行各种攻击的基础。因此，黑客首先需要扩展这些“肉鸡”。以下是几种常见的“肉鸡”扩展方法：

1. **弱口令爆破**：
   通过自动化工具对常见远程服务端口（如22、2222、23、2323、1433、3306、3389端口）进行弱口令爆破，植入木马并执行远程命令。安天捕风蜜网的数据显示，上述端口每天的爆破尝试次数在300万到500万之间。每当新的物联网僵尸网络爆发时，爆破数据都会显著增加，特别是在国外相关的物联网僵尸网络中更为常见。

   | 扫描端口 | 可疑IP |
   |----------|---------|
   | 22       | ...     |
   | 2222     | ...     |
   | 23       | ...     |
   | 2323     | ...     |
   | 1433     | ...     |
   | 3306     | ...     |
   | 3389     | ...     |

2. **漏洞扫描**：
   利用自动化工具扫描和利用系统漏洞来扩展“肉鸡”已成为一种新趋势。Mirai家族的僵尸网络就是一个典型例子。下表列出了Mirai变种利用的部分漏洞及其受影响的设备情况。

   | 漏洞编号 | 影响设备类型 | 描述 |
   |----------|--------------|------|
   | CVE-XXXXX | 路由器        | ...  |
   | CVE-YYYYY | 摄像头        | ...  |
   | ...      | ...          | ...  |

   对于导致德国断网的SOAP漏洞，黑客通过对NTP服务器名称字段进行注入式攻击，在易受攻击的设备上远程执行恶意命令。TR-069协议允许ISP远程管理网络中的设备，而TR-064协议基于HTTP和SOAP，默认端口为TCP 7547。攻击者可以利用这些协议插入恶意代码，改变NTP设置。

   Embedthis公司的GoAhead Web服务器曾爆出远程代码执行漏洞CVE-2017-8225。当与glibc动态链接器结合使用时，攻击者可以通过POST请求发送共享对象的有效载荷，并使用/proc/self/fd/0引用它。GoAhead Web Server是一个开源（商业许可）、轻量级且功能强大的嵌入式Web服务器，支持多种操作系统，包括eCos、Linux、LynxOS、QNX、VxWorks、WinCE、pSOS等。

   磊科后门利用是2014年曝光的一种后门利用方法，目前仍出现在捕获的攻击数据中。CheckPoint披露，IoTroop恶意软件利用了多种漏洞入侵Zyxel、Dlink、Netgear、Linksys路由器以及Goahead摄像头、JAWS摄像头、AVTECH摄像头和Vacron NVR设备。

3. **捆绑下载暗藏后门**：
   通过激活工具或小应用程序捆绑木马进行传播。例如，魔釉DDoS木马就利用小马激活工具进行大规模传播。在非正规的应用网站中，许多“绿色”小应用程序被绑定了木马，随着这些应用程序的扩散，木马也会不断感染更多设备。由于这种传播方式可以有效规避杀毒软件的检测，经过时间积累，往往会形成庞大的“肉鸡”群。

4. **交叉感染**：
   通过已有的僵尸网络传播新木马，实现不同僵尸网络之间的交叉传播。这种方式可以快速部署成型的僵尸网络，因此在常见的DDoS僵尸网络中尤为常见。

#### 4.2.2 全球各DDoS家族僵尸网络威胁情报

根据2017年的样本统计分析，Gafgyt僵尸网络家族的样本最多，达到26083个；其次是Nitol，样本数为10667个。如下图所示：

![全球各DDoS家族僵尸网络捕获的样本数统计](图15)

对全球的DDoS攻击及黑客控制的僵尸网络家族进行统计分析，发现最常用的僵尸网络家族是Xor_Ex家族，该家族发起的DDoS攻击达6500多万次，占所有家族的34.92%；其次是BillGates家族，攻击次数为3400多万次，占比21.87%；排名第三的是Mayday家族，占比19.44%。

![全球DDoS僵尸网络各家族攻击量的情报统计](图16)

以下是对全国DDoS攻击占比排名前六位的僵尸网络家族的攻击行为统计分析：

1. **Xor家族**：
   Xor家族是近两年来全国乃至全球攻击态势最为活跃的DDoS僵尸网络家族。从2016年下半年开始，操作该家族的黑客逐渐将C2服务器向国外转移，以隐藏身份。这些C2服务器通常通过非法渠道获取远程控制权限进行部署，增加了溯源难度。

   ![Xor_Ex家族攻击方式分布统计](图17)
   ![Xor_D家族攻击方式分布统计](图18)

2. **BillGates家族**：
   BillGates家族（又称Setag/Ganiw）的活跃度仅次于Xor家族。其活跃事件主要集中在上半年，攻击类型主要是SYN flood。自7月中旬起，随着虚拟货币价格的上涨，大部分BillGates家族的僵尸网络开始转换为挖矿僵尸网络。

   ![BillGates年度攻击情报时间分布](图19)
   ![BillGates家族攻击方式分布统计](图20)

3. **Mayday家族**：
   Mayday家族的攻击情报走势与BillGates家族类似，但活跃度较低。其主要攻击类型为SYN flood，其次为TCP flood，反射型攻击较少见。

   ![Mayday年度攻击情报时间分布](图21)
   ![Mayday家族攻击方式分布统计](图22)

4. **Nitol家族**：
   Nitol家族是目前Windows系列中最活跃的DDoS僵尸网络之一，已经发展出多个变种。尽管Nitol家族的僵尸网络工具已经扩散到国外，但主要感染设备仍在国内，尤其是在NSA的“永恒之蓝”漏洞和Structs2系列漏洞被曝光后，通过自动化漏洞利用工具批量植入恶意代码的情况增多。最新版本的Nitol集成了多种攻击类型，如SYN flood、TCP flood、DNS flood、C2 flood、UDP flood、HTTP flood、ICMP flood和NTP flood。2017年的数据显示，其主要攻击方式倾向于HTTP flood和C2 flood。

   ![Nitol年度威胁情报时间分布](图23)
   ![Nitol家族攻击方式分布统计](图24)
   ![Nitol家族感染设备系统版本统计](图25)

   监测显示，很多控制Nitol家族僵尸网络的黑客同时控制其他RAT类型的僵尸网络，通过交叉感染方式实现“肉鸡”的互通和共享。随机统计的3万台Nitol家族“肉鸡”设备中，主要感染的是Windows系列的低、中档系统版本，尤其是Win XP SP3（约占79.91%），其次是Win 7 SP1（约占8.27%）。这些设备主要集中在事业单位办公环境和企业工控环境中，初步统计境内每天约有260万台Windows设备受Nitol家族恶意代码感染。

5. **Dofloo家族**：
   Dofloo家族在数据加密算法、攻击模式和平台兼容性方面都较为成熟。该家族使用256位AES加密算法确保数据通信的安全性。除了常见的SYN flood、TCP flood、HTTP flood等攻击类型外，还具备高放大倍数的DNS flood、NTP flood、ICMP flood等反射攻击类型。Dofloo家族的木马能够兼容Windows、Linux以及ARM、MIPS、SIMPLE等物联网系统架构。此外，黑客通过自动化利用工具（如CVE-2017-8225）批量抓取存在漏洞的设备，进一步扩大了“肉鸡”基数。庞大的“肉鸡群”加上高倍数的放大攻击使得Dofloo家族的破坏力远超其他家族的僵尸网络。