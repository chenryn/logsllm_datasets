### 服务副本（静默失败或非静默失败）

#### 基本复制
- **被动复制** 涉及多种可能的策略，对应于以下内置功能：**有状态复制** 和 **基于日志的复制**。在所有情况下，仅有一个 Web 服务（WS）副本来处理输入请求。如果解析器或后处理断言检测到错误，则将请求转发给备用副本来执行操作。在这种情况下，除了执行断言外，连接器还提供路由到备用副本和故障检测（由于节点崩溃、服务崩溃或挂起导致的服务不可达）。这些策略之间的主要区别在于如何管理有状态服务的状态，即触发由 WS 提供的保存/恢复状态操作，或者使用由连接器管理的日志。

### 第 37 届 IEEE/IFIP 国际可依赖系统与网络会议 (DSN'07) 0-7695-2855-4/07 $20.00 © 2007

#### 有状态复制的执行模型
对于**有状态复制**，接收端的连接器在转发请求到 WS 副本之前会保存状态。如果后处理检测到错误，会选择一个新的 WS 副本并更新其状态。对于**基于日志的复制**，连接器提供了启动会话和结束会话的操作来记录目标 WS 的输入请求。当连接器检测到错误时，会重放请求日志以更新新的 WS 副本的状态。

### 主动复制策略
对于**主动复制**（如 ActiveReplication, VotingReplication），连接器会将请求多播到 Web 服务副本（使用适当的协议）。两种配置可用：
1. **无投票机制**：连接器从副本接收响应，并将第一个通过后处理断言的响应发送给客户端。该机制可以容忍节点崩溃、服务崩溃或服务挂起。
2. **带投票机制**：连接器接收来自存活副本的响应，并使用投票算法库中的变体（如平均值、中位数等）进行投票。这种机制可以容忍数据损坏（值故障）。

这些恢复策略可以通过连接器开发者参数化配置，包括副本列表、计时器值、决策函数等。新变体也可以从现有变体派生（如恢复块、N 版本编程等）。

### 执行模型
#### 被动复制
- **无状态服务**：执行模型类似于线性模型。当后处理在连接器中检测到错误或服务或通信异常时，选择一个新的 WS 副本来处理请求。连接器循环直到响应通过后处理验证或所有副本都失败。在这种情况下，向客户端发送 SOAP 异常。
- **有状态服务**：执行模型不同，因为必须触发由 WS 提供者提供的状态恢复操作。在将请求转发给另一个 WS 副本之前，更新 WS 副本的状态。

#### 主动复制
- **无状态服务**：连接器将请求广播到所有副本，并返回第一个通过后处理的有效响应。其他有效响应被忽略。如果所有副本都无法产生有效响应，连接器返回 SOAP 异常给客户端。
- **有状态服务**：必须使用原子多播设施来广播输入请求到所有副本，以确保请求消息的全序。主动复制策略需要在正常操作中维护副本的一致性。

### 实现问题和实验
#### 代码实现
该项目的核心软件约有 55000 行代码，包括 IWSD 平台、DeWel 编译器及其配套工具。IWSD 平台安装在运行 Linux Debian GNU/Linux 的 PC 机架上，Linux 内核版本为 2.4。

#### 实验结果
- **监控连接器的使用**：通过连接器收集的错误信息评估了各种 Web 服务的可用性。图 9 显示了一些结果。例如，在我们的实验中，Google WS 的可用性最低（约 82%），这是由于 1913 个请求中有 352 个通信错误。
- **抽象 Web 服务案例研究**：我们开发了一个能够将请求映射到类似“搜索”Web 服务（如 Google WS 和 MSN WS）的连接器。结果显示，目标抽象 Web 服务具有非常高的可用性比率（见图 10）。
- **有状态 Web 服务案例研究**：我们开发了一个简单的 e-business “银行服务”来测试各种执行模型，并粗略评估了几种恢复策略的响应时间开销。图 11 显示了不同连接器的响应时间开销。

### 结论
这些实验验证了所提出方法的有效性和工具链的可行性。未来的工作将包括在一个实际案例研究中进一步评估该方法的可扩展性。