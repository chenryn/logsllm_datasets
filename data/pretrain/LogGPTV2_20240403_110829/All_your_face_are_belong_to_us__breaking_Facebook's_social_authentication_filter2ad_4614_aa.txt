title:All your face are belong to us: breaking Facebook's social authentication
author:Iasonas Polakis and
Marco Lancini and
Georgios Kontaxis and
Federico Maggi and
Sotiris Ioannidis and
Angelos D. Keromytis and
Stefano Zanero
All Your Face Are Belong to Us:
Breaking Facebook’s Social Authentication
∗
Iasonas Polakis
FORTH-ICS, Greece
PI:EMAIL
Marco Lancini
Politecnico di Milano, Italia
PI:EMAIL
Georgios Kontaxis
Columbia University, USA
PI:EMAIL
Federico Maggi
Politecnico di Milano, Italia
PI:EMAIL
Sotiris Ioannidis
FORTH-ICS, Greece
PI:EMAIL
Angelos D. Keromytis
Columbia University, USA
PI:EMAIL
Stefano Zanero
Politecnico di Milano, Italia
PI:EMAIL
ABSTRACT
Two-factor authentication is widely used by high-value services
to prevent adversaries from compromising accounts using stolen
credentials. Facebook has recently released a two-factor authenti-
cation mechanism, referred to as Social Authentication, which re-
quires users to identify some of their friends in randomly selected
photos. A recent study has provided a formal analysis of social au-
thentication weaknesses against attackers inside the victim’s social
circles.
In this paper, we extend the threat model and study the
attack surface of social authentication in practice, and show how
any attacker can obtain the information needed to solve the chal-
lenges presented by Facebook. We implement a proof-of-concept
system that utilizes widely available face recognition software and
cloud services, and evaluate it using real public data collected from
Facebook. Under the assumptions of Facebook’s threat model, our
results show that an attacker can obtain access to (sensitive) infor-
mation for at least 42% of a user’s friends that Facebook uses to
generate social authentication challenges. By relying solely on pub-
licly accessible information, a casual attacker can solve 22% of the
social authentication tests in an automated fashion, and gain a sig-
niﬁcant advantage for an additional 56% of the tests, as opposed
to just guessing. Additionally, we simulate the scenario of a deter-
mined attacker placing himself inside the victim’s social circle by
employing dummy accounts. In this case, the accuracy of our at-
tack greatly increases and reaches 100% when 120 faces per friend
are accessible by the attacker, even though it is very accurate with
as little as 10 faces.
Categories and Subject Descriptors
K.6.5 [Security and Protection]: Authentication
∗
Iasonas Polakis and Sotiris Ioannidis are also with the University
of Crete
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
ACSAC ’12 Dec 3-7, 2012, Orlando, Florida USA
Copyright 2012 ACM 978-1-4503-1312-4/12/12 ...$15.00.
General Terms
Security
Keywords
Authentication, Face recognition, Online social networks
1.
INTRODUCTION
Online social networks (OSNs) have become some of the fastest
growing Web services with a massive user base and, at the same
time, an appealing target for malicious activities: Facebook reports
over 900 million active users as of March 2012, all the while en-
couraging its users to share more and more information online for a
richer experience. Such accumulated data and the interconnections
between users have made OSNs an attractive target for the Internet
miscreants, which harvest account credentials using both technical
and social-engineering attacks. Studies [22] have shown that tradi-
tional underground economies have shifted their focus from stolen
credit card numbers to compromised social network proﬁles, which
are sold for the highest prices. A recent study [12] reports that the
vast majority of spamming accounts in OSNs are not dummy pro-
ﬁles created by attackers, but legitimate, existing user accounts that
have been compromised. Additionally, new Facebook phishing at-
tacks use compromised accounts to steal personal information [15].
As a standard method for strengthening the security of online
user accounts, high-value services such as online banking, and re-
cently Google services, have adopted two-factor authentication where
users must present two separate pieces of evidence in order to au-
thenticate. The two factors are such that the risk of an adversary
acquiring both is very low. Typically, the two factors consist of
something the user knows (e.g., a password) and something the
user possesses (e.g., a hardware token). Physical tokens, however,
are inconvenient for users, who may not always carry them, and
costly for the service that deploys them.
In 2011 Facebook, in an effort to combat stolen account pass-
words, introduced its so-called Social Authentication (SA), a sec-
ond authentication factor based on user-related social information
that an adversary “half way around the world” supposedly lacks
and cannot easily trick the owners into divulging. Following the
standard password-based authentication, if Facebook deems it nec-
essary, users are presented with photos of 7 of their friends and
are asked to identify them. SA appears to be more user-friendly
and practical as (i) users are required to identify photos of people
399
they know and (ii) they are accustomed to tagging photos of their
friends—thus implicitly providing the necessary labeled dataset for
Facebook.
In this paper we identify the vulnerable nature of SA and em-
pirically conﬁrm a series of weaknesses that enable an adversary to
carry out an effective automated attack against Facebook’s SA. The
key of SA is the knowledge a user has about his online social cir-
cle, whereas an attacker trying to log into the account with stolen
credentials, lacks. Facebook acknowledges that its heuristics and
threat model do not cover the case of friends and family (i.e., any-
one inside a user’s online social circle) hacking into one’s account.
The intuition behind our research is that any stranger who obtains a
user’s password can gain enough data to defeat the SA mechanism.
To this end, we initially conduct a series of experiments to vali-
date our assumptions about the access that an adversary might have
to such information. The core of this paper is the design and im-
plementation of an automated, modular system that defeats Face-
book’s SA mechanism. The general principles of our approach al-
low it to be extended and applied to any photo-based SA system.
Initially, during a preparatory reconnaissance phase we obtain a vic-
tim’s list of friends and the photos accessible from his OSN proﬁle.
This includes crawling the publicly-accessible portion of the vic-
tim’s social graph and (optionally) performing actions that bring us
inside the restricted part of the social circle, such as issuing friend-
ship requests to the victim’s friends. We then process the collected
photos using face detection and recognition software to build each
friend’s facial model. An attacker is highly unlikely to be famil-
iar with the friends of a victim—at least under the threat model
assumed by Facebook—and there lies the security of recognizing
one’s friends as a security mechanism. However, by acquiring ac-
curate facial models of a victim’s friends we are in possession of
the key to solving SA challenges. When the SA test is triggered, we
lookup the identity of the depicted friends and provide an answer.
At a ﬁrst glance, it might seem that our attack only affects Face-
book users that leave their friends list and published photos publicly
accessible. According to Dey R. et al. [9] (2012), 47% percent of
Facebook users leave their friends list accessible by default. How-
ever, an attacker can always attempt to befriend his victims, thus
gaining access to their protected information. Such actions may
achieve up to a 90% success rate [4, 5, 19, 24]. That way, the set
of vulnerable users may reach 84% of the Facebook population. At
the same time, our experiments show that 71% of Facebook users
expose at least one publicly-accessible photo album. Similarly, an
attacker has very good chances of getting access, through online
friendship requests, to proﬁles with private photo albums. More-
over, even if user A’s photos are protected from public view and A
does not accept friend requests from unknown people, user B might
have a photo of A in which A is tagged (i.e., their face framed and
labeled with his real name and Facebook ID). If user B has their
photos public, A’s tags are implicitly exposed to crawling. Overall,
dynamics of OSNs such as Facebook, make it very hard for users to
control their data [18, 23] and thereby increase the attack surface of
threats against SA. We show that anyone can gain access to crucial
information for at least 42% of the tagged friends used to build SA
challenges that will protect a user’s proﬁle.
Under such minimal attack-surface assumptions we manually
verify that our implemented SA breaker, powered by a face recogni-
tion module, solves 22% of the real SA tests presented by Facebook
(28 out of 127 tests), in less than 60 seconds for each test. More-
over, our attack gives a signiﬁcant advantage to an attacker as it
solves 70% of each test (5 out of 7 pages) for 56% of the remain-
der tests (71 out of 99 tests). Note that we obtain this accuracy in
real-world conditions by relying solely on publicly-available infor-
mation, which anyone can access: We do not send friendship re-
quests to the victims or their friends to gain access to more photos.
Furthermore, our simulations demonstrate that within a maximized
attack surface (i.e., if a victim, or one of his friends, accepts be-
friend requests from an attacker, which happens in up to 90% of
the cases), the success rate of our attack increases to 100%, with
as little as 120 faces per victim for training, and takes about 100
seconds per test.
A recent study [17], provided a formal analysis of the social au-
thentication weaknesses against attacker within the victim’s social
circle. We expand the threat model and demonstrate in practice
that any attacker, inside and outside the victim’s social circle, can
carry out automated attacks against the SA mechanism in an efﬁ-
cient manner. Therefore we argue that Facebook should reconsider
its threat model and re-evaluate this security mechanism.
In summary, the key contributions of this work are the following:
• We systematize and expand previous work, which pointed
out (i) the feasibility of recognizing people’s faces using Face-
book photos, and (ii) the theoretical issues with face-based
SA. This systematization allows us to describe an attack that
breaks Facebook’s SA mechanism, while retaining the as-
sumptions of their threat model.
• We present our black-box security analysis of Facebook’s SA
mechanism and point out its weaknesses (and implementa-
tion ﬂaws) when employed as the second factor of a two-
factor authentication scheme.
• We design and implement an automated, modular system that
leverages face detection and recognition to break Facebook’s
SA efﬁciently. We, thus, show the feasibility of such an at-
tack in large-scale.
• We show that publicly-available face recognition services of-
fer a very accessible and precise alternative to building a cus-
tom face recognition system.
• We discuss how Facebook’s SA scheme should be modiﬁed
so that users can trust it as a second authentication factor.
2. SOCIAL AUTHENTICATION
We hereby describe the nature of Facebook’s SA in terms of func-
tionality and heuristics. We go beyond a general description and
evaluate its behavior under real-world conditions. Facebook’s SA
was announced in January 2011 and, to the best of our knowledge,
is the ﬁrst instance of an authentication scheme based on the “who
you know” rationale: A user’s credentials are considered authentic
only if the user can correctly identify his friends.
2.1 How Social Authentication Works
After the standard, password-based authentication, the user is
presented with a sequence of 7 pages featuring authentication chal-
lenges. As shown in Fig. 1, each challenge is comprised of 3 photos
of an online friend; the names of 6 people from the user’s social cir-
cle are listed and he has to select the one depicted. The user is
allowed to fail in 2 challenges, or skip them, but must correctly
identify the people in at least 5 to pass the SA test.
2.2 Requirements for Triggering
Based on our analysis, Facebook activates the SA only for the
fraction of accounts that have enough friends with a sufﬁcient amount
of tagged photos that contain a human face.
Friend list. SA requires that the user to be protected has a rea-
sonable number of friends. From our experiments we have con-
cluded that, in the case of Facebook, a user must have at least 50
400
Figure 1: Example screenshot of the user interface of a Facebook SA page. The screenshot is synthetic due to copyright reasons, but
is an exact replica of a real-world Facebook SA page. Faces have been pixelated for privacy reasons.
friends. To obtain this information, we created 11 distinct dummy
proﬁles and increased the number of friends of these accounts on a
daily basis, until we managed to trigger the SA (detailed in §4.3).
Tagged photos. The user’s friend must be tagged (placed in a
labeled frame) in an adequate number of photos. Keep in mind
that since these are user-submitted tags, Facebook’s dataset can
get easily tainted. People often erroneously tag funny objects as
their friends or publish photos with many friends tagged, several of
whom may not actually be present in the photo.
Faces. SA tests must be solvable by humans within the 5 minute
(circa) time window enforced by Facebook. We argue that Face-
book employs a face detection algorithm to ﬁlter the dataset of
tagged people to select photos with tagged faces. From our manual
inspection of 127 instances of real SA tests (2,667 photos), we have
noticed that Facebook’s selection process is quite precise, despite
some inaccuracies that lead to SA tests where some photos con-
tain no face. Overall, 84% of these 2,667 photos contained at least
one human-recognizable face, and about 80% of them contained at
least one face such that an advanced face detection software can
discern—in this test, we used face.com. To validate our argument
on the use of face detection ﬁltering, we repeated the same man-
ual inspection on a different set of 3,486 photos drawn at random
from our dataset of 16,141,426 photos (detailed in §4.1). We then
cropped these images around the tags; hence, we generated a SA
dataset in the same manner that Facebook would if it naively relied
only on people’s tagging activity. Only 69% (< 84%) of these pho-
tos contain at least one recognizable human face, thus the baseline
number of faces per tag is lower in general than in the photos found
in the real SA tests. This conﬁrms our hypothesis that Facebook
employs ﬁltering procedures to make sure each SA test page shows
the face of the person in question in at least one photo.
Triggering. Facebook triggers the SA when it detects a suspi-
cious login attempt, according to a set of heuristics. Our exper-
iments reveal that this happens when (i) the user logs in from a
different geographical location, or (ii) uses a new device (e.g., com-
puter or smartphone) for the ﬁrst time to access his account.
2.3 Advantages and Shortcomings
The major difference from the traditional two-factor authentica-
tion mechanisms (e.g., conﬁrmation codes sent via text message or
OTP tokens) is that Facebook’s SA is less cumbersome, especially
because users have grown accustomed to tagging friends in photos.
However, as presented recently by Kim et al. [17], designing a us-
able yet secure SA scheme is difﬁcult in tightly-connected social
graphs, not necessarily small in size, such as university networks.
Our evaluation suggests that SA carries additional implementa-
tion drawbacks. First of all, the number of friends can inﬂuence the
applicability and the usability of SA. In particular, users with many