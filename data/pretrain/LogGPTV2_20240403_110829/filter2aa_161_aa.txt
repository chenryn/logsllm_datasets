Hacker'Machine,Interface,
State,of,the,Union,for,SCADA,HMI,Vulnerabili:es,
Copyright,2016,Trend,Micro,Inc.,
2,
Introduc:on,
Copyright,2016,Trend,Micro,Inc.,
3,
Trend,Micro,Zero,Day,Ini:a:ve,
•  Fritz,Sands,',@FritzSands,
–  Security)Researcher)–)Zero)Day)Ini4a4ve)
–  Root)cause)analysis)and)vulnerability)discovery)
–  Focused)on)SCADA)HMI)vulnerability)analysis)
•  Brian,Gorenc,',@maliciousinput,
–  Senior)Manager)?)Zero)Day)Ini4a4ve)
–  Root)cause)analysis)and)vulnerability)discovery)
–  Organizer)of)Pwn2Own)hacking)compe44ons)
Copyright,2016,Trend,Micro,Inc.,
4,
SCADA,Industry,
Copyright,2016,Trend,Micro,Inc.,
5,
Marketplace,Overview,,
•  Focused,on,ICS,equipment,sales,over,soTware,sales,
•  Ac:ve,merger,and,acquisi:on,ac:vity,,
•  Highly,regionalized,,
Copyright,2016,Trend,Micro,Inc.,
6,
What,is,the,Human,Machine,Interface?,
•  Main,hub,for,managing,and,opera:ng,control,systems,
•  Collects,data,from,the,control,systems,
•  Presents,visualiza:on,of,the,system,architecture,
•  Alarms,operator/sends,no:ﬁca:ons,
•  Should,be,operated,on,isolated,and,trusted,networks,
–  …but,it,usually,isn’t!,
Copyright,2016,Trend,Micro,Inc.,
7,
Why,target,the,Human,Machine,Interface?,
•  Control,the,targeted,cri:cal,infrastructure,
•  Harvest,informa:on,about,architecture,
•  Disable,or,deceive,the,alarm,and,no:ﬁca:on,systems,
•  Physically,damage,SCADA,equipment,
Copyright,2016,Trend,Micro,Inc.,
8,
Malware,Targe:ng,HMI,Solu:ons,
•  Stuxnet,
–  First,malware,created,to,target,ICS,environments,
–  Abused,vulnerabili:es,
•  Siemems,SIMATIC,STEP,7,DLL,Hijacking,Vulnerability,(ICSA'12'205'02),
•  Siemens,WinCC,Insecure,SQL,Server,Authen:ca:on,(ICSA'12'205'01),
•  ,BlackEnergy,
–  Ongoing,sophis:cated,malware,campaign,compromising,ICS,environments,
–  Abused,vulnerabili:es,
•  GE,CIMIPCITY,Path,Traversal,Vulnerabili:es,(ICSA'14'023'01),
•  Siemens,WinCC,Remote,Code,Execu:on,Vulnerabili:es,(ICSA'14'329'02D),
•  Advantech,WebAccess,(ICS'ALERT'14'281'01B),
Copyright,2016,Trend,Micro,Inc.,
9,
ICS'CERT,
•  Organiza:on,within,Department,of,Homeland,Security,
•  Focuses,on:,
–  Responding,to,and,analyzing,control,systems'related,incidents,
–  Conduc:ng,vulnerability,and,malware,analysis,
–  Providing,onsite,incident,response,services,
–  Coordina:ng,the,responsible,disclosure,of,vulnerabili:es,and,
associated,mi:ga:ons,
•  For,2015,,ICS'CERT,responded,to,295,incidents,and,handled,
486,vulnerability,disclosures,
Copyright,2016,Trend,Micro,Inc.,
10,
Cri:cal,Infrastructure,Akacks,
Copyright,2016,Trend,Micro,Inc.,
11,
Targe:ng,Water,U:li:es,
•  Compromised,internet'facing,AS/400,system,responsible,for:,
–  Network,rou:ng,
–  Manipula:on,of,Programmable,Logic,Controllers,(PLC),
–  Management,of,customer,PII,and,billing,informa:on,
•  Altered,semngs,related,to,water,ﬂow,and,amount,of,
chemicals,that,went,into,the,water,supply,
•  Four,separate,connec:ons,to,the,AS/400,over,a,60'day,
period,
•  Actors,IP,:ed,to,previous,hack:vist,ac:vi:es,
Copyright,2016,Trend,Micro,Inc.,
12,
Targe:ng,Power,Plants,
•  On,December,24,,2015,,Ukrainian,companies,experienced,
unscheduled,power,outages,impac:ng,225,000+,customers.,
–  Caused,by,external,malicious,actors,
–  Mul:ple,coordinated,akacks,within,30,minutes,of,each,other,
•  Used,remote,administra:on,tools,and/or,remote,industrial,
control,system,(ICS),client,soTware,to,control,breakers.,
•  Used,KillDisk,to,overwrite,Windows'based,human'machine,
interface,system.,
–  Disrupt,restora:on,eﬀorts,
Copyright,2016,Trend,Micro,Inc.,
13,
Targe:ng,Railway,and,Mining,Industry,
•  Malware,similar,to,the,power,incident,found,in,the,akacks,
against,a,Ukrainian,rail,and,a,Ukrainian,mining,company,
–  November,–,December,2015,
•  Overlap,between,the,samples,found,in,the,Ukrainian,power,
incident,and,those,apparently,used,against,the,Ukrainian,
mining,company,
–  Malware,leveraged,(BlackEnergy/KillDisk),
–  Infrastructure,
–  Naming,Conven:ons,
Copyright,2016,Trend,Micro,Inc.,
14,
Prevalent,Vulnerability,Types,
Copyright,2016,Trend,Micro,Inc.,
15,
Current,State,of,HMI,Solu:ons,
•  Not,built,with,security,in,mind,,
•  Seen,no,beneﬁt,of,the,evolu:on,of,the,secure,SDL,
•  Mi:ga:ons,against,advanced,akacks,are,disabled,
–  ASLR,,SafeSEH,,Stack,Cookies,
•  Poor,design/developer,assump:ons,
•  Lack,of,understanding,of,real,opera:ng,environment,
–  Not,on,isolated,or,trusted,networks,
–  Con:nually,being,interconnected,
Copyright,2016,Trend,Micro,Inc.,
16,
Common,Problems,with,HMI,
Memory,Corrup:on,
Creden:al,Management,
Insecure,Defaults,
Authen:ca:on/Authoriza:on,
Injec:on,
Other,
Source:,2015'2016,ICS'CERT,Advisories,,
Copyright,2016,Trend,Micro,Inc.,
17,
Now,let’s,get,down,and,dirty!,
CASE,STUDIES,
Copyright,2016,Trend,Micro,Inc.,
18,
Injec:ons,
•  9%,of,iden:ﬁed,vulnerabili:es,
•  Common,vulnerability,types,
–  SQL,Injec:on,
–  Code,Injec:on,,
–  OS,Command,Injec:on,
–  Command,Injec:on,
•  Zero,Day,Ini:a:ve,case,study,
–  Cogent,DataHub,Gamma,
Command,Injec:on,
Remote,Code,Execu:on,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
19,
,
Cogent,DataHub,Case,Study,
•  ICS'CERT,states:,
–  “allow,an,akacker,to,turn,on,an,insecure,processing,mode,in,the,
web,server,,which,subsequently,allows,the,akacker,to,send,
arbitrary,script,commands,to,the,server”,
•  Iden:ﬁers,
–  CVE'2015'3789,
–  ZDI'15'438,
–  ICSA–15–246–01,
•  CVSS,
–  7.5,
•  Disclosure,Timeline,,
–  2015–06–02,',Reported,to,vendor,,
2015–09–08,–,Coordinated,release,
•  Credit,
–  Discovered,by:,Anonymous,
–  Disclosed,by:,Zero,Day,Ini:a:ve,
Copyright,2016,Trend,Micro,Inc.,
20,
,
Cogent,DataHub,Overview,
Copyright,2016,Trend,Micro,Inc.,
21,
Gamma,Script,Overview,
•  Gamma,is,DataHub’s,scrip:ng,language,
•  Dynamically'typed,interpreted,programming,language,
speciﬁcally,designed,to,allow,rapid,development,of,control,
and,user,interface,applica:ons,
•  Gamma,has,a,syntax,similar,to,C,and,C++,,but,has,a,range,of,
built'in,features,that,make,it,a,far,beker,language,for,
developing,sophis:cated,real':me,systems,
Copyright,2016,Trend,Micro,Inc.,
22,
Akacker'Supplied,Script,Evalua:on,
•  Flaw,exists,within,the,EvalExpression,method,
–  Allows,for,execu:on,of,akacker,controlled,code,
•  Remotely,accessible,through,the,AJAX,facility,
–  Listening,on,TCP,port,80,,
•  Supplying,a,specially,formaked,Gamma,script,allows,for,the,
execu:on,of,arbitrary,OS,commands,
Copyright,2016,Trend,Micro,Inc.,
23,
Vulnerable,Code,
Copyright,2016,Trend,Micro,Inc.,
24,
Exploita:on,Steps,
1.  Send,a,request,to,any,Gamma,script,to,load,necessary,
libraries,
2.  Call,AJAXSupport.AllowExpressions,and,set,
allow_any_expression,to,True,,
3.  Call,AJAXSupport.EvalExpression,method,and,pass,in,the,
script,that,you,want,executed,
Copyright,2016,Trend,Micro,Inc.,
25,
Exploita:on,Demo,
Copyright,2016,Trend,Micro,Inc.,
26,
Patch,Analysis,
Copyright,2016,Trend,Micro,Inc.,
27,
Authen:ca:on/Authoriza:on,
•  12%,of,iden:ﬁed,vulnerabili:es,
•  Common,vulnerability,types,
–  Authen:ca:on,Bypass,Issues,
–  Improper,Access,Control,
–  Improper,Privilege,Management,
–  Improper,Authen:ca:on,
•  Zero,Day,Ini:a:ve,case,study,
–  Advantech,WebAccess,upAdminPg,,
Informa:on,Disclosure,Vulnerability,
Copyright,2016,Trend,Micro,Inc.,
28,
,
Advantech,WebAccess,Case,Study,
•  ICS'CERT,states:,
–  “A,properly,authen:cated,administrator,can,view,passwords,for,
other,administrators.”,
•  Iden:ﬁers,
–  CVE'2016'5810,
–  ZDI'16'429,
–  ICSA'16'173'01,
•  CVSS,
–  6.8,
•  Disclosure,Timeline,,
–  2016–05–11,',Reported,to,vendor,,
2016–07–18,–,Coordinated,release,
•  Credit,
–  Discovered,by:,Zhou,Yu,
–  Disclosed,by:,Zero,Day,Ini:a:ve,
Copyright,2016,Trend,Micro,Inc.,
29,
Update,your,password…and,view,others!,
•  Speciﬁc,ﬂaw,exists,within,upAdminPg.asp,
–  /broadWeb/user/upAdminPg.asp,