[[system-setting]]
== 系统设置
日志易支持在系统设置中修改一些全局的功能配置项。点击"设置-系统设置"打开页面。
目前提供的功能配置包括：
* 外观
** Logo修改
** 界面配色
* 消息提示
** 有新消息时声音提醒
*** 自定义声音文件上传
** 超限通知邮箱
** 告警消息提醒
** 离线任务、下载任务完成消息提醒
*  登录与安全配置：登录安全配置详细说明，请参阅《日志易安全手册》。
** 登录时验证来源IP
** 多点登录
** 首次登录强制修改密码
** 账号锁定时间
** 密码有效时间
** 密码提醒更新时间
** 禁止使用最近密码次数
** 密码长度限制
** 密码弱口令文件
** 仪表盘自动登录
** 自定义自动登录地址
** 密码强度限制 
*** 密码长度限制
*** 数字长度限制
*** 大写字母长度限制
*** 小写字母长度限制
*** 特殊字符长度限制
* 搜索页配置
** 自定义高亮关键字
** 搜索时脱敏规则
** 搜索页加载时自动搜索开关
** 图表配置自动填充开关
** 已存搜索加载时自动搜索开关
** 搜索页时间直方图颜色设置
** 日志展示格式
** 日志等级字段配置
* 时间快捷选项设置
* 报表配置
** 报表趋势图个数限制
** 报表文件类型
** 报表内嵌图片大小
** 报表统一样式
* 交易日功能
** 交易日定义文件上传
** 查看当前定义的交易日
** 交易日时区选择
** 设为默认交易日历
* 邮件服务器设置
** SMTP 端口
** SMTP 地址
** 发送邮箱账号
** 发送邮箱密码
** 发送邮件需要登录开关
** 发送邮件使用加密协议：明文/SSL/TLS
** 发送邮件采用 HTML 格式支持图表开关
* 其他
** 默认首页
** 告警事件展示条数
** 优先展示全名
** 隐藏内置角色
** 优先展示我的收藏
** 监控回溯时间范围限制
** 监控回溯时间点个数限制
[NOTE]
====
除 Logo 和消息提醒设置以外，绝大多数系统配置在日志易平台的 Manager 配置中同样存在。当系统设置未填写时，默认使用日志易 Manager 中的设置。
====
=== 自定义自动登录地址
在仪表盘章节中，已经介绍过最常用的仪表盘自动登录功能。日志易同样支持对其他功能页面的自动登录查看。在系统配置中，勾选"是否支持自定义登录"，并填写下一行的"自定义自动登录的URL"参数即可。输入框只支持日志易内部相对地址。比如搜索页填写'/search/'，监控页填写'/alerts/'等。
配置完成后，可以采用如下 URL 进行自动登录查看。密码加密和签名验证方式，和仪表盘自动登录功能一致：
 http://日志易地址/auth/verify/用户名/加密后密码/签名/
如果设置的自动登录 URL 支持传递 url_args 参数，比如仪表盘可以传参给输入项，搜索页可以传参给搜索语句和时间范围等，在上述 URL 后面继续携带相同的 url_args 参数即可。
比如，想要采用用户名为 test，用户登录密码为 test1234 的账号，自动打开搜索页并发起一次对最近一天的 appname 事件数统计查询，则配置"自定义自动登录的URL"为'/search/'以后，实际采用的最终 URL 是这样的：
 http://日志易地址/auth/verify/test/16d7a4fca7442dda3ad93c9a726597e4/43674cc69063ba073a09ca093796fe29/?query=*%20%7C%20stats%20count()%20by%20appname%09&time_range=-1d%2Cnow&order=desc&size=20&page=1
[NOTE]
====
自动登录功能仅做长期投屏或内嵌使用，并不影响正常的登录使用。系统配置中的"首页"设置，可以和"自动登录URL"分别设置为不同功能页面。
====
=== Logo修改
在系统设置页面，点击外观表单的"去设置"入口，打开“系统设置-外观”页面。日志易支持替换大小两种规格的Logo图片，分别用于左侧边栏收起和展开的状态，以及登录页大图标。点击“替换”，选择png文件上传即可。
[NOTE]
====
* 小Logo尺寸为：16px * 20px；
* 大Logo尺寸为：75px * 30px。
====
=== 界面配色
为了让日志易和您的公司环境最大程度的保持视觉效果的一致性。日志易还支持在系统设置-外观页桑修改外观配色。
日志易目前支持对主色系、悬停效果、一级导航、仪表盘内容背景、图标及占位符辅助色等的颜色设置，基本覆盖了系统所使用的颜色区域。您可以按需选择，如不满意，可以恢复初始值，继续使用日志易默认效果。
日志易提供白天模式、黑夜模式两种主题设置，默认为白天模式，可切换为黑夜模式。仪表盘和自定义应用有独立的主题配色，不受此处的黑夜模式控制。
=== 消息提醒
日志易支持对多种类型进行消息提醒，具体如下。
* 监控告警：新触发告警，点击在搜索页打开告警查询语句并搜索
* 未解析日志：出现logtype:other日志，仅在需要时打开
* 限额超标：最近一个月内日志量限额超标，日志易同时也会发送邮件提醒
* 离线任务：离线任务完成，点击消息可以直接加载离线任务结果到搜索页
* 下载任务：下载任务完成，点击效果可以直接下载结果文件
* 权限变更：用户a在资源列表页把某资源授权给角色r，拥有角色r的用户b在登录系统时，会弹出消息提示如下图：
+
image::images/notice-authored.png[]
+
提示框悬浮2秒，然后自动消失，同时左侧菜单栏里的红亮提示消失，该消息由未读变为已读。点击提示框，跳到相关资源页面。
用户可以在菜单拦看到红亮的消息数目，点击"消息通知"进入消息列表界面，查看更多消息。
image::images/notice_menu.png[]
用户可以设置语音提示消息。具体步骤如下：
. 点击'设置-系统设置'
. 启用'有新消息时声音提醒'（默认关闭）
. 选择'使用系统音'或'自定义声音'，如果选择'自定义声音'，请上传音频文件
image::images/notice_voice_upload.png[]
=== 交易日功能
交易日是指交易发生的日期。针对证券，期货等行业更关注在交易日期间发生的查询监控等，日志易提供自定义交易日功能，用户可以在系统配置中上传并更新交易日文件，查看当前交易日，选择交易日时区。针对不同交易市场的情况，用户还可以上传多份交易日历文件，并设置默认日历。当默认日历被删除时，系统会自动将随后一份交易日历提升为默认日历。
image::images/system-setting-trade.png[]
上传的交易日文件形如下图：
image::images/trade-csv-example.png[]
具体要求为：
* 只支持csv文件。
* 第一列固定为自然日，第二列固定为交易日，其他列不要求。
* 第一行会被忽略，为了方便阅读建议按需加上表头。
* 自然日和交易日格式均为固定八位数（兼容数字与字符串）。
成功上传交易日文件后，可以点击"查看当前交易日"进行交易日预览。
也可以选择"交易日时区"，默认是'Asia/Shanghai'。请保持交易日时区和日志（采集/解析）时区一致，否则会导致时间范围不同，影响查询结果。
也可以在搜索，仪表盘，监控，报表，定时任务，趋势图中适配交易日，还可以使用spl的starttime/endtime指定交易日，具体语法请查询《日志易检索参考》。
=== 搜索时脱敏
搜索时脱敏可以实现和字段提取脱敏类似的效果，但不用占用双倍的磁盘空间。当然，相对而言，搜索时脱敏的查询性能也有一定的下降。日志易在正常查询结果返回之前，对结果数据中的所有内容，包括日志原文、提取字段值、统计和评估字段值等等，全部进行一遍脱敏替换，以确保返回的最终结果不包含敏感数据。由于要逐级展开结果集的 JSON 体，结果越复杂，脱敏过程越慢。强烈建议在授权中，对只能查看脱敏数据的用户，只授予最基础的日志搜索权限即可——即角色功能列表中只勾选"可使用搜索页"一项。
搜索时脱敏的配置方式和字段提取脱敏类似，添加 sed 替换规则即可。效果如下图所示：
image::images/setting-desensity.png[]
此外，日志易提供内置 Grok 正则的方式，方便搜索时脱敏规则的编写。采用 Grok 正则编写脱敏时，替换内容采用 `${name}` 命名捕获而非 `$1` 分组捕获。默认的，系统带有中文姓名、身份证号、手机号三个脱敏规则供使用和参考：
image::images/setting-desensity-default.png[]
注意：默认的姓名脱敏规则假设业务日志中姓氏前应该是行首或特殊分隔符号，而不会藏在大段中文文本中间。
=== 时间快捷选项设置
日志易中时间范围选择器提供了快捷选项，减少用户输入的过程。在系统设置中，还可以自定义快捷选项的内容、顺序、是否展示等：
image::images/system-date-picker.png[]
如果有不同选项设置的实际开始时间和结束时间相等，系统会自动展示为第一个匹配的选项名称。