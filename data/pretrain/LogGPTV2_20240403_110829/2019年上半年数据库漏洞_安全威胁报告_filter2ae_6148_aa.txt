# 2019年上半年数据库漏洞 安全威胁报告
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 一. 报告摘要
北京安华金和科技有限公司（简称安华金和）长期致力于帮助客户应对数据库安全领域的威胁。为了提高数据库用户的安全意识，快速反馈最新数据库漏洞被利用方向，安华金和最新发布《2019年上半年数据库漏洞安全威胁报告》。该报告用于快速跟踪及反馈数据库安全的发展态势。
## 二. 报告正文
###  2019年数据库安全形式综述
**数据安全现状概述**
如今云计算、大数据、移动互联网、物联网、智慧城市正成为我国信息化建设的主要方向，信息化的发展正改变着我们的生活。作为信息化的核心，数据正逐步成为各类企业、政府部门关注的重点。毫无疑问，在信息时代下数据已经成为一种无形的资产。而数据库作为存储核心数据的重要手段，在企业IT架构中的重要性也变得不言而喻。
随着大数据时代的到来，各行业的数据量成TB甚至PB级增长，数据规模不断扩大，数据库的重要性也更加突出。在云计算产业的不断发展下，各类公有云、私有云的数量也在不断增长，随之而来的是，原本在内网环境中使用的数据库管理系统也在云环境下得到广泛使用，数据库的使用场景发生了变化。在《云计算发展三年行动计划（2017-2019年）》的推动下，各类云的数量将持续增长。
系统架构、使用场景、网络环境的变化，导致一些旧的安全体系已不再适用。无论是企业还是客户都必须考虑数据库的安全问题。为了对数据库进行合理有效的安全建设，研究数据库潜在的安全风险并寻找切实可行的应对措施已经迫在眉睫。
**数据库自身的安全缺憾**
凭借能够快速、高效管理数据的特点，数据库成为了信息系统的核心。无论是大数据、云计算还是物联网等热点技术都离不开数据库的身影。从传统内网到云环境，从世界500强公司到各国政府机关，数据库在各式各样的业务系统中扮演了重要的角色，存放了包括财务信息、公民身份信息、银行账户密码、政府机密资料在内的等各类重要数据。核心数据的价值在不断提升，数据库的安全性也更加重要。
随着云计算、大数据时代的到来，全球的数据量呈爆发式增长。为了适应新的用户需求，企业的IT架构也在随之变化，正在从传统的内网环境演变到现在的云平台上。数据库作为管理数据的核心系统，在得到人们广泛使用的同时，也不断遇到新的应用场景，面临着新的安全挑战。
传统环境下，数据库位于企业的内网环境中，封闭的局域网为数据库提供了一个相对安全的使用环境，有效避免了来自外部的黑客攻击。然而从目前的发展情况来看，内外网融合是大势所趋，越来越多的用户在向云上迁移，数据库系统正在脱离保守的内网环境，运行环境正变得更加开放。与之相对的是，数据库的安全机制并没有进一步发展，与产品面对海量数据所表现出的优异性能相比，数据库在安全性方面表现得相对落后。因此，数据库安全所面临的首要问题就是如何加强某些场景下的安全防护能力，避免潜在安全隐患。
###  数据库安全威胁分析
作为一套复杂而周密的软件，其实数据库在设计之初就考虑到了安全问题，有的甚至依据美国国防部的标准而来。应该说当今市场上大部分商用数据库都能满足安全标准，是符合安全要求的。然而即使是符合安全标准的数据库，在实际使用的过程中所表现出的安全性仍会有所欠缺，令人大失所望。根本原因在于技术的发展总是领先于标准的制定。因此，在研究数据库安全时，要更多地从实际情况出发，寻找切实有效的解决办法。
图1 数据库安全威胁分析统计图
根据今年对数据库攻击的统计分析，我们绘制了“数据库安全威胁分析统计图”。从上图中可以看出，在目前的安全形势下，数据库所面临的安全威胁主要有三大类：第三方恶意组件、人为因素和数据库系统安全，三者共占总体的93%。由此可见，这三大威胁的存在严重影响了数据库的安全性。寻找它们的应对之道，是建设数据库安全的必经之路。
**人为因素**
要想全面、透彻的研究安全问题，必然要考虑安全事件中的人为因素。无论是攻击者也好，数据库管理员也罢，从本质上看，安全问题可以归结为人与人之间的博弈。攻击者考虑的是如何利用各种方法绕过用户的防御措施，进而完成攻击；管理员要考虑的是黑客将如何攻击系统，如何进行有效防御。在矛与盾的博弈之下，安全水平在不断提升。因此，研究数据库安全中的人为因素是十分必要的。
提到人为因素就离不开数据库管理员，提到数据库管理员就离不开身份认证和安全配置。对此，本文将以弱口令配置、离线暴力破解、错误配置三个方面为切入点，分析人为因素对数据库安全的影响。
弱口令或默认口令的安全问题
之所以会出现弱口令或默认口令问题，往往与数据库管理员的安全意识不足有关。弱口令问题并不复杂，只要修改默认密码，并满足密码复杂度要求就能轻松解决。然而看似简单的问题如果不及时处理，就可能会演变成更大的隐患。事实上，攻击者希望自己的攻击过程快捷高效，因此大多数情况下会避免执行复杂的操作，而通过正确的口令登录数据库是最为直接有效的方式，因此弱口令攻击成为了攻击者常用的入侵手段。之前就曾出现云端的MySQL服务器大范围遭受勒索攻击的事件，而黑客就是利用了数据库的root用户采用了“1”这个弱口令来完成的攻击。
弱口令问题不容小觑，一旦存在将为攻击者打开通往核心数据的大门。要彻底解决弱口令问题，关键在于管理员如何在“安全”和“方便”之间进行取舍。当因系统测试而需要提供数据库密码时，如何确保密码不会外泄？当用户较多需要长期维护时，能否记得定期修改密码？当数据库安装完毕后，是否会主动调整安全设置？这都是对管理员安全意识的考验。
此外，一般行业内人士都有较为流行、通用的账号密码，这类密码被称为线下弱口令。虽然大部分数据库在身份验证时都进行了加密，但被加密的只是口令，数据库账号仍然以明文的方式存在。因此线下弱口令也是数据库安全的一大隐患。只有定期更换安全的密码，才能有效避免弱口令攻击。因此提高管理员的安全意识，依据安全要求进行系统管理是十分必要的。
离线暴力破解
目前的主流数据库为了保证用户身份验证时的安全性，一般会采用口令加密、密码错误次数限制等手段。为了应对这种安全措施，黑客另辟蹊径采取了离线破解的方法。通过网络抓包的方式捕获含有身份验证信息的数据包，此时会获得加密后的口令。之后再采取暴力破解的方式进行口令爆破，从而绕过数据库安全机制，实现对数据库密码的攻击。
由于早期硬件性能不足，使用CPU进行暴力破解往往会耗费大量的时间。而随着GPU技术的发展，支持大规模并发运算的特性使其成为了暴力破解的新手段，大大减少了破解时间。目前GPU的运算效率非常高，每秒甚至能产生80亿次密码碰撞。
针对暴力破解，最为有效的解决方法仍然是定期修改密码，并且修改后的密码要满足复杂度要求。这样即使黑客成功破解了密码，随着密码的更新，之前的工作都会化为无用功，从而避免数据库被入侵。
错误配置的安全问题
数据库的错误配置问题一般比较隐蔽。从以往的经验来看，数据库的错误配置往往源自默认配置，很多时候与产品的性能、易用性、兼容性等问题有关。一旦被攻击者发现，可能被长期利用，安全威胁十分严重。
以Oracle数据库为例，常见的错误配置是没有对数据库的监听部分设置管理口令，从而引起TNS劫持问题。比如CVE-2012-1675，它能实现远程把同名实例注册到目标TNS，进行数据库劫持攻击。最有效的解决办法就是对目标TNS加设管理密码，防止注册不可信实例。可见对数据库进行正确的安全配置是十分有必要的。
要确保数据库的安全性，有两个方面的相关配置是必须要考虑的，即身份验证和用户权限。
为了提高数据库身份验证过程中的安全性，一般会采取禁止数据库远程访问、禁止数据库采用系统身份认证等措施。禁止远程访问，是为了避免黑客从内网中的其他主机登录数据库，窃取数据。禁止系统身份验证，可以有效避免当黑客入侵了数据库服务器的操作系统时，利用系统身份认证登录数据库。
合理的划分用户权限对提升数据库的安全性是十分重要的，通常会对数据库账号进行降权操作。一方面是降低数据库账号在操作系统中的权限，防止黑客利用数据库对操作系统发起入侵。此类问题在SQL
Server中较为明显，因为SQL
Server安装后的SA账号默认具有系统管理员权限，而利用数据库攻击操作系统的事件已经出现过多次，因此必须做降权处理。另一方面是针对不同角色的用户进行权限划分，防止越权操作。对于数据库账号，建议遵循最小权限原则，以满足用户实际需要为基础，为每一个数据库账号赋予最小特权。比如在进行第三方开发测试期间，要注意账号的权限管理满足测试开发需求即可。在大多数利用Web应用实现的SQL注入攻击中，之所以能攻击成功靠的就是Web访问数据库时的账号权限。因此应谨记最小权限原则，降低数据库被入侵的风险。
经过上述操作，可以保证数据库的最高用户权限不会随着操作系统、局域网被入侵而泄露。除了考虑最基本的身份验证和用户权限以外，影响数据库安全的配置问题还体现在多个方面。