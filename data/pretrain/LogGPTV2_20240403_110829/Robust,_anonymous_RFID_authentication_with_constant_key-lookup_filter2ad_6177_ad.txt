response from a challenge, while mode   0 when con(cid:2)rmation has been received. When in mode = 1,
the tag employs entrapment pseudonyms computed on-the-(cid:3)y by evaluating g(k; qjjIV jjctr). Since there
is only a constant number of such values (eventually they recycle) the tag has to defend itself against (cid:3)y-
by attacks by rogue readers that seek to exhaust these values. The simplest defense is to use a time-delay
mechanism as described in [vLBdM07]. This will extend the recycle time by a few orders and thwart such
attacks, but may fail to deal with entrapment attacks, for which eventually the tag responses will be linked.
However, unlinkability will be restored the moment the tag gets mutually authenticated by the server: on
receiving con(cid:2)rmation from the back-end server the tag will update its seed q.
i ; : : : ; qc
5.3 Protocol Description
We refer to Fig. 2. In the (cid:2)rst pass the tag is challenged by the server with a random c. If the tag received
con(cid:2)rmation in its previous interaction (mode = 0) then it will update its pseudonym ps   r and compute
three values (cid:23)0; (cid:23)1; (cid:23)2 by inputting (k; ps; c) to the PRF g: (cid:23)0 is kept for later use as a pseudonym update;
(cid:23)1 = auth is an authenticator and (cid:23)2 = conf is used for con(cid:2)rmation. The tag responds with psjjauth.
If the tag has not previously received con(cid:2)rmation (mode = 1) then it uses a different pseudonym in its
response, computed on-the-(cid:3)y with seed q.
The server uses the key-lookup database DB to disambiguate ps, and then checks auth. If correct, it
sends conf to the tag. The server then proceeds with pseudonym updates, that have to be synchronized with
those of the tag: ps = rcur corresponds to the case when the tag is not under attack; ps = rold and ps = qj
i ,
i 2 fold; curg, correspond to cases when the tag did not receive con(cid:2)rmation, with the last one indicating
that the tag was (also) previously interrogated by an unauthorized reader (an entrapment attack). In this case
the server will use a new seed q   (cid:23)0 to update the pseudonyms qcur, to support unlinkability between
entrapment attacks.
If the tag receives con(cid:2)rmation then it will update the pseudonym r if in mode = 0, otherwise it updates
the seed q. What distinguishes this protocol from O-FRAP [vLBdM07] is that, at all times in this protocol,
the values r; q stored by the tag in its non-volatile memory are synchronized with those stored by the server
in DB. Consequently, the tag can be identi(cid:2)ed with constant key-lookup.
11
5.4 Security Considerations
The protocol in Fig. 2 addresses disabling attacks by weakening the requirement for unlinkable privacy.
However linkability is restricted to entrapment attacks in which the tag is either physically restricted or
closely tracked. During such attacks it is reasonable to assume that the tag is monitored and therefore, to
some extend, already identi(cid:2)ed or located.
Our protocol is based on O-FRAP [vLBdM07] that is proven secure in the UC framework. From a secu-
rity point of view the main difference with our protocol is its functionality: it uses entrapment pseudonyms
that will eventually recycle. However these pseudonyms remain pseudo-random until they get exhausted.
In the full version of this paper we shall detail of the changes that have to be made to the security proof of
O-FRAP to get a proof. We shall show:
Theorem. Let m be the maximum number of uninterrupted interrogations that the adversary is allowed to
make to a tag.
1. If m is bounded by a constant c then: the protocol in Fig. 2 realizes one-way authentication with
strong privacy in the UC framework and supports constant key-lookup.
2. If m is not constant then: the protocol in Fig. 2 realizes one-way authentication with linkable privacy
in the UC framework and supports constant key-lookup.
5.5 Implementation and extensions
Our protocol requires only the use of a PRF which as pointed out in Section 3.4 can be implemented with
a PRNG. This allows for very ef(cid:2)cient implementations. In particular the protocol can be adapted to con-
form with the EPC Gen2 standards [EPC]. However this protocol does not support forward-secrecy. To
capture this functionality we can adapt it so that as in O-FRAP [vLBdM07] the key is updated whenever the
pseudonym is. The tag will require additional non-volatile memory for key update storage, but otherwise
the same basic circuit can be used. One can also capture key-exchange, by using O-FRAKE [vLBdM07],
which is a key-exchange extension of O-FRAP.
6 Conclusion
In order for RFID systems that support strong security and privacy to become a reality, a well-rounded
practical solution that also considers threats to availability, and which supports scalability, is needed. In this
paper, we have introduced a scalability compiler that transforms a challenge-response RFID authentication
protocol into a similar RFID protocol that shares the same functionality and security as well as provides
scalability for the back-end server (constant lookup time even in the presence of active adversaries).
We have described a particular instantiation of the compiler and illustrated its application to a family
of authentication protocols with strong security features.
In particular, we have shown how to achieve
security and privacy with constant lookup cost within the universally composable security model. The
compiler requires only several hundred additional GEs of circuit area. Moreover, the compiler preserves
other properties, such as suitability for batch authentication with delayed veri(cid:2)cation by the trusted server.
We have also proven that one-way tradoor functions have to be used to obfuscate identi(cid:2)ers, in RFID
authentication protocols that support anonymity with constant lookup cost. Finally by weakening the restric-
tion on unlinkable privacy, we have described a provably secure anonymous RFID authentication protocol
that supports scalable lookup and minimizes the loss of privacy due to linkability.
12
References
[AO05]
Gildas Avoine and Philippe Oechslin. A scalable and provably secure hash-based RFID pro-
In Proc. IEEE Intern. Conf. on Pervasive Computing and Communications (PerCom
tocol.
2005), pages 110(cid:150)114. IEEE Press, 2005.
[BDJR97] M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A concrete security treatment of symmetric
encryption. In Proc. IEEE Symp. on Foundations of Computer Science (FOCS 1997). IEEE
Computer Society Press, 1997.
[Can95]
[BvLdM06] M. Burmester, T. van Le, and B. de Medeiros. Provably secure ubiquitous systems: Universally
composable RFID authentication protocols. In Proceedings of the 2nd IEEE/CreateNet Inter-
national Conference on Security and Privacy in Communication Networks (SECURECOMM
2006). IEEE Press, 2006.
R. Canetti. Studies in Secure Multiparty Computation and Application. PhD thesis, Weizmann
Institute of Science, Rehovot 76100, Israel, June 1995.
R. Canetti. Security and composition of multi-party cryptographic protocols. Journal of Cryp-
tology, 13:1:143(cid:150)202, 2000.
R. Canetti. Universally composable security: A new paradigm for cryptographic protocols. In
Proc. IEEE Symp. on Foundations of Computer Science (FOCS 2001), pages 136(cid:150)145. IEEE
Press, 2001.
[Can01]
[Can00]
[CKM94] D. Coppersmith, H. Krawczyk, and Y. Mansour. The shrinking generator. In Proc. Advances
[Dim05]
[DR02]
[EPC]
in Cryptology (CRYPTO 1993), LNCS, pages 22(cid:150)39. Springer, 1994.
T. Dimitriou. A lightweight RFID protocol to protect against traceability and cloning at-
tacks. In Proc. IEEE Intern. Conf. on Security and Privacy in Communication Networks (SE-
CURECOMM 2005). IEEE Press, 2005.
Joan Daemen and Vincent Rijmen. The design of Rijndael. Springer-Verlag, New York, Inc.,
Secaucus, NJ, USA, 2002.
EPC Global. EPC tag data standards, vs. 1.3.
standards/EPCg
lob al _T ag _D ata _S ta nd ar d_T DS _V %e rs ion _1 .3 .p df .
gl oba li nc .o rg /
http://www.epc
[FDW04] Martin Feldhofer, Sandra Dominikus, and Johannes Wolkerstorfer. Strong authentication for
RFID systems using the AES algorithm. In Proceedings of the Workshop on Cryptographic
Hardware and Embedded Systems (CHES 2004), volume 3156 of LNCS. Springer, 2004.
[FWR05] Martin Feldhofer, Johannes Wolkerstorfer, and Vincent Rijmen. Aes implementation on a grain
of sand. In IEE Proceedings on Information Security, volume 152(1), pages 13(cid:150)20, 2005.
[GGM86] Oded Goldreich, Sha(cid:2) Goldwasser, and Silvio Micali. How to construct pseudorandom func-
tions. Journal of the ACM, 33(4), 1986.
D. Henrici and P. M. M¤uller. Hash-based enhancement of location privacy for radio-frequency
identi(cid:2)cation devices using varying identi(cid:2)ers. Proc. IEEE Intern. Conf. on Pervasive Com-
puting and Communications, pages 149(cid:150)153, 2004.
[HM04]
13
[Jue04]
[LH06]
A. Juels. Minimalist cryptography for low-cost RFID tags. In Proc. Intern. Conf. on Security
in Communication Networks (SCN 2004), volume 3352 of LNCS, pages 149(cid:150)164. Springer,
2004.
HangRok Lee and DoWon Hong. The tag authentication scheme using self-shrinking generator
on r(cid:2)d system. In Transactions on Engineering, Computing, and Technology, volume 18, pages
52(cid:150)57, 2006.
[MSW06] David Molnar, Andrea Soppera, and David Wagner. A scalable, delegatable pseudonym pro-
In Proc. Workshop on Selected Areas in
tocol enabling ownership transfer of RFID tags.
Cryptography (SAC 2005), volume 3897 of LNCS. Springer, 2006.
[MvOV96] A.J. Menezes, P.C. van Oorschot, and S.A. Vanstone. Handbook of Applied Cryptography.
CRC Press, 1996.
[OSK03] M. Ohkubo, K. Suzuki, and S. Kinoshita. Cryptographic approach to (cid:147)privacy-friendly(cid:148) tags.
[Rab79]
[Sha07]
[SWE03]
[Tsu06]
In Proc. RFID Privacy Workshop, 2003.
M. O. Rabin. Digitalized signatures and public-key functions as intractable as factoriza-
tion. Technical Report TR-212, Massachusetts Institute of Technology, Cambridge, MA, USA,
1979.
Adi Shamir. Squash: A new one-way hash function with provable security properties for
highly constrained devices such as RFID tags. In Invited Talk, Internat. Conf. on RFID Security
(RFIDSec’07), 2007.
S. Sharma, S. Weis, and D. Engels. RFID systems and security and privacy implications. In
Proc. Workshop on Cryptographic Hardware and Embedded Systems (CHES 2002), LNCS,
pages 454(cid:150)470. Springer, 2003.
G. Tsudik. YA-TRAP: Yet another trivial RFID authentication protocol. In Proc. IEEE Intern.
Conf. on Pervasive Computing and Communications (PerCom 2006). IEEE Press, 2006.
[vLBdM07] T. van Le, M. Burmester, and B. de Medeiros. Universally composable and forward-secure
RFID authentication and authenticated key exchange. In Proc. of the ACM Symp. on Informa-
tion, Computer, and Communications Security (ASIACCS 2007). ACM Press, 2007.
14