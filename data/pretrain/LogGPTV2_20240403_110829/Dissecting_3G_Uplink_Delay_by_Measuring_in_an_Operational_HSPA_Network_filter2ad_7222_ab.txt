i
r
i
p
m
e
12
8
4
0
0
5
10
delay (ms)
15
20
Fig. 7. Delay Δ1, empirical PDF
Fig. 8. Δ2 over size, log. histogram
UE. The latency contribution of the USB-modem, Δ1 (see Fig. 1), is shown in
Fig. 7. The delay PDF results from timestamps obtained by tracing at the appli-
cation interface and the rising edge of the transmission power at the air interface.
Thereby the packet size varies from 1 to 1500 Bytes. The delay distribution is
concentrated between 5 to 15 ms, where it exhibits uniform character. This can
be explained as a contribution of 5 ms caused by the USB-modem due to data
processing and a random contribution of up to 10 ms while waiting for a trans-
mission window. The start of a transmission can only take place at the beginning
of a TTI, whereas data appears randomly in the transmission queue and hence,
is kept for a random time until the outset of the next TTI. This delay contri-
bution can be removed by designing HSUPA aware software applications. The
small amount of packets yielding a delay below 5 ms are measurement artifacts.
They result from retransmitted packets or control information, misinterpreted
as part of the user data. Increasing the packet inter-arrival time would improve
the situation but, as explained in Section 2.1, this would increase the probability
of switching to normal Dedicated Channel (DCH) operation. Figure 11(a) shows
a histogram of delay and size for Δ1. In contrast to Fig. 7, the falling edge of the
transmission power is used to obtain the timestamps, thus, transmission delay
is included as well. We model the delay contributed by the UE, the queuing and
the transmission as
Δ1 = 5ms + X · 10ms + (cid:2)l/α(cid:3) · 10ms ,
(1)
whereas X is a uniformly distributed random variable between 0 and 1, l is the
payload length of the transmitted packet, α denotes the length-factor, equivalent
to the step hight in Fig. 11(b) (e.g. 800 Bytes) and (cid:2)·(cid:3) is the ceiling operation.
NodeB. In Fig. 8 the reader ﬁnds a logarithmic histogram of delay Δ2 and
packet size, thus, corresponding to the delay introduced by the NodeB. Thereby
the value assigned to diﬀerent colors of the grid corresponds to the natural
logarithm of the number of packets corresponding to one parcel of the grid. The
delays are calculated by subtracting the timestamp of the falling edge of the
Dissecting 3G Uplink Delay by Measuring in an Operational HSPA Network
59
)
e
t
y
B
k
(
e
z
s
t
i
e
k
c
a
p
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
0
2
delay (ms)
4
6
7
6
5
4
3
2
1
0
12
)
e
t
y
B
k
(
e
z
s
t
i
e
k
c
a
p
8
4
0
0
4
3
2
1
40
delay (ms)
80
120
Fig. 9. Delay Δ3 over packet size,
log. histogram
Fig. 10. Δ1 + Δ2 + Δ3 over packet
size, log. histogram
transmission power at the air interface from the last RLC frame transmitted
over the Iub interface. The minimum is 5 ms, whereas up to 7 ms of latency are
experienced depending on the packet size. The contribution of the NodeB can
thus be modeled as
Δ2 = 5ms + (l%α) · 1ms/kByte ,
whereas % denotes the modulo operator and the expression (l%α) introduces
extra delay growing linearly with packet size.
RNC. Figure 9 shows the delay characteristics of the RNC, Δ3 (see Fig. 1).
The delay is the diﬀerence in time of the last RLC packet fragment at the Iub
interface and the last IP packet fragment at the Gn interface.
The minimum latency introduced by the RNC is 1.5 ms. Additionally the
packets experience an extra delay up to 4 ms, depending on the packet size. This
can be modeled in the same way as for the NodeB by
Δ3 = 1.5ms + (l%α) · 2ms/kByte .
(2)
(3)
3.2 Accumulated Delay
Accumulated delay is the delay experienced by the user application. Figure 10
displays this accumulated delay for a large variation of packet sizes. The dashed
lines correspond to the model illustrated below. Furthermore, Fig. 11 shows the
accumulation of the latency throughout the 3G network. In other words those
ﬁgures show the delay contributed by the ﬁrst hop of the communication link.
By combining the Eqn. (1), (2) and (3), we obtain an expression for the accu-
mulated latency,
Δ = 11.5ms + X · 10ms + (cid:2)l/α(cid:3) · 10ms + (l%α) · 3ms/kByte .
(4)
This expression accurately models the regions of high density in Fig. 10 and 11(c).
The parameter α is strongly dependent on a manifold of parameters, such as data
60
M. Laner et al.
1.5
1
)
e
t
y
B
k
(
i
e
z
s
t
e
k
c
a
p
0
0
10
20
30
delay (ms)
40
50
6
5
4
3
2
1
0
1.5
1
)
e
t
y
B
k
(
e
z
s
t
i
e
k
c
a
p
0
0
10
30
20
delay (ms)
40
50
6
5
4
3
2
1
0
(a) Δ1 over size, log. hist.
(b) Δ1 + Δ2 over size, log. hist.
1.5
1
0.5
6
5
4
3
2
1
0
0
10
20
30
delay (ms)
40
50
)
%
(
l
e
d
o
m
h
t
i
w
t
n
e
i
t
s
s
n
o
c
s
t
e
k
c
a
p
100
95
90
85
0
α
α2
α3
1
packet size (kByte)
2
3
)
e
t
y
B
k
(
e
z
s
t
i
e
k
c
a
p
(c) Δ1 + Δ2 + Δ3 over size, log. hist.
(d) Model evaluation
Fig. 11. Accumulated delay
rate and channel quality, and is deﬁned by the HSUPA scheduler. Comparing
Fig. 10 and 11(c) we estimate α as 1800 Byte and 800 Byte respectively, which is
a considerable variation, although in the measurement setup only the mean data
rate changed. All possible values for α are listed in [21], Annex B. Nevertheless,
we expect α not to drop below 200 Bytes for reasonable channel conditions.
The accuracy of the model can be visually evaluated from Fig. 10 and 11(c).
The dashed lines show the lower and upper bounds, within which the model
assumes a uniform distribution. In Fig. 11(d) a numerical evaluation of the ac-
curacy is depicted. Thereby a data set of packet sizes up to 3 kByte is compared
to the model. The result shows that 90 - 95 % of all packets are consistent with
the model.
4 Conclusion and Outlook
In this paper we present measurements, analysis and models of latency compo-
nents of 3G HSUPA communication. We inspected the network elements - user
equipment (UE), base station (NodeB) and network controller (RNC) - in live op-
eration. The average delay value for a 1kByte packet is 30 ms (UE: 66%, NodeB:
Dissecting 3G Uplink Delay by Measuring in an Operational HSPA Network
61
20%, RNC: 14%). Therefore the 3GPP Long Term Evolution (LTE) delay per-
formance target of 5ms makes improvements in the core network mandatory.
Based on the analysis of the results we designed a model for each of the delay
components. It provides an average performance of 95%.
Acknowledgments. We would like to thank Sebastian Caban, Robert Lang-
wieser and Michael Fischer for contributing technical expertise. Furthermore,
we thank A1 Telekom Austria and ftw for technical assistance and the EU FP7
LoLa Project for ﬁnancial support.
References
1. Holma, H., Toskala, A.: Hsdpa/Hsupa For Umts. In: High Speed Radio Access for
Mobile Communications. Wiley, Chichester (2006)
2. LoLa consortium. D2.1 Target Application Scenarios (2010),
http://www.ict-lola.eu/
3. Arlos, P., Fiedler, M.: Inﬂuence of the Packet Size on the One-Way Delay in 3G
Networks. In: Krishnamurthy, A., Plattner, B. (eds.) PAM 2010. LNCS, vol. 6032,
pp. 61–70. Springer, Heidelberg (2010)
4. Fabini, J., Karner, W., Wallentin, L., Baumgartner, T.: The Illusion of Being De-
terministic – Application-Level Considerations on Delay in 3G HSPA Networks.
In: Fratta, L., Schulzrinne, H., Takahashi, Y., Spaniol, O. (eds.) NETWORKING
2009. LNCS, vol. 5550, pp. 301–312. Springer, Heidelberg (2009)
5. Fabini, J., Wallentin, L., Reichl, P.: The importance of being really random:
methodological aspects of IP-layer 2G and 3G network delay assessment. In: ICC
2009, Dresden, Germany (2009)
6. Paxson, V., Almes, G., Mahdavi, J., Mathis, M.: Framework for IP Performance
Metrics (1998), http://www.ietf.org/rfc/rfc2330.txt
7. Liu, J., Tapia, P., Kwok, P., Karimli, Y.: Performance and Capacity of HSUPA in
Lab Environment. In: VTC Spring 2008, Singapore (2008)
8. Vacirca, F., Ricciato, F., Pilz, R.: Large-Scale RTT Measurements from an Oper-
ational UMTS/GPRS Network. In: WICON 2005, Budapest, Hungary (2005)
9. Romirer-Maierhofer, P., Ricciato, F., Coluccia, A.: Explorative analysis of one-way
delays in a mobile 3G network. In: LANMAN 2008, Cluj-Napoca, Romania (2008)
10. Option Wireless Technology, http://www.option.com/
11. LoLa consortium. D 3.2. Network related analysis of M2M and online-gaming traﬃc
in HSPA (2010), http://www.ict-lola.eu/
12. Endace DAG, http://www.endace.com/
13. The Darwin Project, http://userver.ftw.at/~ricciato/darwin/
14. Ricciato, F.: Traﬃc monitoring and analysis for the optimization of a 3G network.
IEEE Wireless Communications 13, 42–49 (2006)
15. 3GPP. TS 25.401, UTRAN overall description, http://www.3gpp.org/
16. Linear Technology, LT5534 - RF Power Detector, http://www.linear.com/
17. SiRF star III GPS Receivers, http://www.csr.com/products/technology/gps
18. libpcap - library for network traﬃc capture, http://www.tcpdump.org/
19. LinuxPPS Project, http://wiki.enneenne.com/index.php/LinuxPPS_support
20. Vienna University of Technology, Institute of Telecommunication - Downloads,
https://www.nt.tuwien.ac.at/downloads/featured-downloads
21. 3GPP. TS 25.321, MAC protocol speciﬁcation, http://www.3gpp.org/