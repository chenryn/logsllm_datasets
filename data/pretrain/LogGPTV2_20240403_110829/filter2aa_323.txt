Beyond Security 
Put something on the internet -  
Get hacked 
1 
Beyond Security 
Agenda 
• About me 
• IoT 
• IoT core problems 
• Software 
• Hardware 
• Vulnerabilities 
• What should I do? 
Beyond Security 
• Been interested in the field of security since 
childhood 
• Doing network analysis, forensics, dark web 
intelligence gathering, social engineering, etc. 
• Served 7 years in the Israeli army  
• Loves extreme sports (motorcycles / hiking / 
diving etc) 
About me – Maor Shwartz 
Beyond Security 
About Beyond Security 
• The company today: 
• SecuriTeam Secure Disclosure - vulnerability acquisition program 
since 2007 
• AVDS  - vulnerability management system 
• beSTORM - a commercial fuzzing tool 
Beyond Security 
IoT - Introduction 
• The Internet of Things (IoT) is the inter-networking of physical devices, vehicles, 
buildings, and other items embedded with electronics, software, sensors, actuators, 
and network connectivity which enable these objects to collect and exchange data 
• The IoT allows objects to be sensed or controlled remotely across existing network 
infrastructure 
Beyond Security 
IoT 
Beyond Security 
And what about security? 
7 
Beyond Security 
Beyond Security 
IoT devices on the internet(1) 
Beyond Security 
IoT devices on the internet(2) 
Beyond Security 
IoT devices on the internet(3) 
Beyond Security 
Why there are so much vulnerabilities? 
Hardware 
Software 
Beyond Security 
Hardware 
Beyond Security 
Software 
• Inexperienced developers 
•
Programming language 
• Outdated kernel 
• Unknown OS 
• Outdated firmware’s 
• Lack of software update mechanism 
• 3rd party services 
Beyond Security 
Vulnerabilities types  
• Path Traversal  
• DHCP 
• MiTM 
• Firmware upgrade 
• Upload arbitrary files 
• Header injection (Global variables) 
• Api Disclosure  
• Hard-coded Credential  
• Command injection 
• Memory Disclosure 
Beyond Security 
Vulnerabilities types (1) 
• Memory Disclosure 
• A memory leak is an unintentional form of memory consumption whereby the 
developer fails to free an allocated block of memory when no longer needed 
• Hard-coded Credential 
• The use of a hard-coded password increases the possibility of password 
guessing tremendously 
Beyond Security 
Vulnerabilities types (2) 
• Command injection 
•
Command injection is an attack in which the goal is execution of arbitrary commands on the 
host operating system via a vulnerable application 
•
Command injection attacks are possible when an application passes unsafe user supplied data 
(forms, cookies, HTTP headers etc.) to a system shell 
•
In this attack, the attacker-supplied operating system commands are usually executed with the 
privileges of the vulnerable application 
•
Command injection attacks are possible largely due to insufficient input validation. 
Beyond Security 
Vulnerabilities types (3) 
• Path Traversal  
• A path traversal attack (also known as directory traversal) aims to access files 
and directories that are stored outside the web root folder 
• By manipulating variables that reference files with “dot-dot-slash (../)” 
sequences and its variations or by using absolute file paths, it may be possible 
to access arbitrary files and directories stored on file system 
Beyond Security 
Vulnerabilities types (4) 
• Man-in-The Middle  
• man-in-the middle attack intercepts a communication between two systems 
Beyond Security 
Example 1 
HiSilicon ASIC chip set firmware  
20 
Beyond Security 
HiSilicon ASIC chip set firmware  
•
HiSilicon provides ASICs and solutions for communication network and digital media. These ASICs 
are widely used in over 100 countries and regions around the world 
•
The HiSilicon ASIC firmware comes with built-in web server - binary file called Sofia. 
•
This binary is vulnerable to Directory path traversal 
Hi3520DV300/200 chipset 
Beyond Security 
Outdated kernel 
Linux 3.10-based SDK 
Beyond Security 
Directory path traversal built-in webserver 
• The built-in web server suffers from a directory path traversal  
• The vulnerability found in the web server binary “Sofia” which is running with root 
privileges 
• The web server do not filter HTTP GET request. 
• To exploit the vulnerability, all you need to do is to craft HTTP GET request with 
"../../etc/passwd HTTP" to read file "/etc/passwd" 
Beyond Security 
Example 2 
Xiaomi Air Purifier 2 
24 
Beyond Security 
Xiaomi Air Purifier 2 
•
Mi Air Purifier is a High performance smart air purifier (IoT)  
      that can be controlled remotely 
•
Xiaomi Air Purifier 2, version 1.2.4_59, does not use a secure 
      connection for its firmware update process 
•
The update process is in plain-text HTTP 
•
A potential attacker can exploit the firmware update process to: 
•
Obtaining the firmware binary for analysis to conduct other attacks 
•
Enables inject modified firmware 
Beyond Security 
Example 3 
GoAhead web server 
26 
Beyond Security 
GoAhead web server (1) 
• The GoAhead web server is present on multiple embedded devices, from IP 
Cameras to Printers and other embedded devices 
• The vulnerability allows a remote unauthenticated attacker to disclose the content 
of the file being accessed 
Beyond Security 
Example 3 – GoAhead web server (2) 
• Request without leading ‘/’ bypasses HTTP basic auth 
GET   /cgi-bin/main 
GET cgi-bin/main 
Beyond Security 
Example 3 – GoAhead web server (3) 
Beyond Security 
Example 3 – GoAhead web server (4) 
• The vulnerability of the “/” less access causing file disclosure dates back to 2004 
• http://aluigi.altervista.org/adv/goahead-adv2.txt 
Beyond Security 
Example 4 
Geneko Routers 
31 
Beyond Security 
Geneko Routers (1) 
• Geneko GWG provides cellular capabilities for fixed and mobile applications  
• GWG supports a variety of radio bands options on 2G, 3G and 4G cellular 
technologies. 
Beyond Security 
Example 4 – Geneko Routers (2) 
• User controlled input is not sufficiently sanitized, and then passed to a function 
responsible for accessing the filesystem  
• By sending the GET request, You get direct access to any file on the router 
http://"+domain+"/../../../../../etc/shadow 
Beyond Security 
Example 5 
Hack2Win and D-Link 850L 
34 
Beyond Security 
Hack2Win (It’s all about the motivation) 
• Hack2Win-Online is a hacking competition where we connect a product to the 
internet and you need to hack it 
• We lunched the first online competition on June 2017 
• Target – D-Link 850L 
• Prizes: 
• First – 5,000$ 
• Second – 2,500$ 
• Third – 1,000$ 
Beyond Security 
Hack2Win results 
• Remote Unauthenticated Command Execution via WAN 
• Remote Unauthenticated Information Disclosure 
• Remote Unauthenticated Command Execution via LAN 
Beyond Security 
Remote Unauthenticated Command 
Execution via WAN 
37 
Beyond Security 
Remote Unauthenticated Command Execution via WAN 
• Combination of 2 different vulnerabilities 
•
Unauthenticated Upload arbitrary files 
•
Execute arbitrary Commands by authenticated user with administrator privileges 
• When changing settings in admin interface, the settings are send in XML format 
to hedwig.cgi which loads and validates the changes 
Beyond Security 
Remote Unauthenticated Command Execution via WAN 
• The hedwig.cgi calls fatlady.php for settings validation 
• Then pigwidgeon.cgi is requested to apply the new settings (if valid) and restart the 
affected services. 
Beyond Security 
Remote Unauthenticated Command Execution via WAN 
• fatlady.php loads service scripts to validate the input 
• However the service name comes directly from received XML and can be used to 
load any file with “.php” extension 
• For example we can use it to list user accounts with their passwords and get access 
to admin interface 
Beyond Security 
Remote Unauthenticated Command Execution via WAN 
Attacker 
Victim 
POST request 
../../../htdocs/webinc/getcfg/DEVICE.AC
COUNT.xml 
hedwig.cgi 
fatlady.php 
Take the “DEVICE.ACCOUNT.xml” 
parameter and parse it as a “.php” file 
Get list of users and passwords  
Beyond Security 
Remote Unauthenticated Command Execution via WAN 
• After we got the Admin password, we can log in and trigger the second vulnerability 
– NTP server shell commands injection 
Beyond Security 
Remote Unauthenticated 
Information Disclosure 
43 
Beyond Security 
Remote Unauthenticated Information Disclosure 
• When an Admin is log-in to D-Link 850L it will trigger the global 
variable: $AUTHORIZED_GROUP >= 1. 
• An attacker can use this global variable to bypass security checks and use it to read 
arbitrary files. 
curl -d "SERVICES=DEVICE.ACCOUNT&amp;x=y%0aAUTHORIZED_GROUP=1" 
"http://IP/getcfg.php" 
Beyond Security 
Remote Unauthenticated Command 
Execution via WAN 
45 
Beyond Security 
Remote Unauthenticated Command Execution via LAN 
• The D-Link 850L runs dnsmasq daemon as root 
• The daemon execute the “host-name” parameter from the DHCP server 
• In order to exploit this vulnerability, we need to be on the same LAN with the victim 
and to set a DHCP server in our control 
• The attacker need to edit the /etc/dhcp/dhclient.conf file and change the host-
name field to the command we want to execute 
Beyond Security 
Example 6 
Flir Thermal/Infrared Camera  
47 
Beyond Security 
Remote Unauthenticated 
Information Disclosure 
48 
Beyond Security 
Remote Unauthenticated Information Disclosure 
• /webroot/js/fns.login.js disclosed some API functionalities 
• /api/xml?file= 
• /api/file/content/var/log/messages 
• /api/server/videosnap?file= 
• Same as /api/xml?file= 
• /page/factory/view/script  
• firmware upload, filename XSS 
• /api/system/config/product 
Beyond Security 
Remote Unauthenticated video 
stream disclosure 
50 
Beyond Security 
Remote Unauthenticated video stream disclosure 
• http://TARGET:8081/graphics/livevideo/stream/stream3.jpg 
• http://TARGET/graphics/livevideo/stream/stream1.jpg 
Beyond Security 
Remote Unauthenticated Code 
Execution 
52 
Beyond Security 
Remote Unauthenticated code execution 
GET 
/maintenance/controllerFlirSy
stem.php?dns%5Bdhcp%5D
=%COMMAND_YOU_WANT
_TO_EXECUTE%60&dns%5
Bserver1%5D=1.2.3.4&dns%
5Bserver2%5D=&_=1491052
263282 HTTP/1.1 
Beyond Security 
Hard-coded Credentials Remote 
Root Access: 
54 
Beyond Security 
Hard-coded Credentials Remote Root Access 
• root:indigo 
• root:video 
• default:video 
• default:[blank] 
• ftp:video 
Beyond Security 
Example 7 
Polycom 
56 
Beyond Security 
Preferences 
Additional 
Preferences  
Language 
Web Utility 
Language  
ADD 
Memory Disclosure 
• Polycom products are vulnerable to memory info leak found in the way the web 
interface handle files 
• By uploading file with NULL characters via 
• An attacker can read the raw memory of the product 
Beyond Security 
Memory Disclosure 
• The Polycom software, when it tries to display an XML file to a user via the 
‘languages’ web interface 
• The function prepares a memory as part of the response it sends 
• Because this memory is not initialized, it contains memory previously used 
• The function that copies the content of the file seeks the first NULL character as an 
indicator on how much to read from the buffer 
Beyond Security 
Hard-coded Credentials Remote Root Access 
• Since a NULL character appears in the buffer being read, this copies NO data into 
the unallocated buffer, which is returned to the user with the raw memory of the 
device. 
Beyond Security 
What should I do? 
60 
Beyond Security 
Path Traversal  
• S 
Beyond Security 
Firmware update (1) 
• Recovery: You can never leave the system in a state where it is stuck or partially 
programmed. Assume your device's power can be pulled at any instant. 
• Recoverability can be provided by keeping a backup copy of the original 
firmware and having a special bootloader that knows to boot into the backup 
firmware if the primary firmware is corrupted 
• Alternatively, the upgrade data and the state of the upgrade process can be 
recorded in nonvolatile memory, and the bootloader can continue the upgrade 
process after the device powers up after an interruption 
Beyond Security 
Firmware update (2) 
• Interaction with device functionality: Ideally, the user of the device will not be able 
to tell the update is occurring. One method to do this is to only apply the update 
when the system is manually restarted, or to prompt for the user to explicitly allow 
the update. 
• Security and integrity: Your device should be able to validate the update is from a 
trusted source and that the data hasn't been tampered will and doesn't have errors. 
This is done with digital signatures, hashes, and checksums. 
Beyond Security 
Firmware update (3) 
• Patching technique: How are you going to update the firmware? Do you download a 
whole new copy? Are you overwriting certain addresses/code? The choice here has 
an impact in the amount of data transfer and memory the update will require.  
• Patching can use a lot less memory, but can be very difficult (compressed data, 
non-position independent code) 
• Having a filesystem that lets you replace individual files helps make updates 
smaller. 
Beyond Security 
Hard-coded users / passwords 
• In most cases vendors implements hard-coded users/passwords for maintenance 
• The developer assume that the Hard-coded user/password wont be a public 
knowledge   
• In reality –  If hard-coded passwords are used, it is almost certain that malicious 
users will gain access through the account in question 
Beyond Security 
DHCP / Header injection / Command injection (1) 
• The most common web application security weakness is the failure to properly 
validate input from the client or environment 
• This weakness leads to almost all of the major vulnerabilities in applications, such 
as locale/Unicode attacks, file system attacks and buffer overflows.  
Beyond Security 
DHCP / Header injection / Command injection (2) 
• Data from the client should never be trusted for the client has every possibility to 
tamper with the data 
• Ensure that the data is strongly typed, correct syntax, within length boundaries, 
contains only permitted characters, or that numbers are correctly signed and within 
range boundaries 
Beyond Security 
MiTM 
• Implementing Certificate-Based Authentication 
• Upgrade to the safer HTTPS protocol through SSL/TLS Certificates 
Beyond Security 
MiTM Memory Disclosure  
• Avoiding memory leaks in applications is difficult for even the most skilled 
developers 
• There are tools with aide in tracking down such memory leaks. One such example 
on the Unix/Linux environment is Valgrind 
•  Valgrind runs the desired program in an environment such that all memory 
allocation and de-allocation routines are checked 
•  At the end of program execution, Valgrind will display the results 
Beyond Security 
From where to start? 
• Scan your network, know what ports in your network are open  
• Identify the vulnerable ones and closed them 
• Update your firmware 
• Don’t buy stuff that are not supported (last firmware update > year) 
• Change the default passwords 
Beyond Security 
http://www.beyondsecurity.com/ssd 
SSD – SecuriTeam Secure Disclosure 
71 
@SecuriTeam_SSD  
@beyondsecurity 
PI:EMAIL 
http://www.securiteam.com/ 
Beyond Security 
Sources (1) 
• DEF CON 22 - Mark Stanislav & Zach Lanier - The Internet of Fails  
• Siime dildo security vulnerabilities 
• 115 batshit stupid things you can put on the internet in as fast as I can go by Dan 
Tentler 
• SSD Advisory – Polycom Memory Disclosure 
• https://blogs.securiteam.com/index.php/archives/3268 
• SSD Advisory – Remote Command Execution in Western Digital with Dropbox App  
• https://blogs.securiteam.com/index.php/archives/3397 
Beyond Security 
Sources (2) 
• SSD Advisory – TerraMaster Operating System (TOS) File Disclosure 
• https://blogs.securiteam.com/index.php/archives/3080 
• SSD Advisory – Cisco DPC3928 Router Arbitrary File Disclosure 
• https://blogs.securiteam.com/index.php/archives/3039 
• SSD Advisory – Xiaomi Air Purifier 2 Firmware Update Process Vulnerability 
• https://blogs.securiteam.com/index.php/archives/3205 
• SSD Advisory – Synology DiskStation Manager Multiple Stored Cross-Site Scripting 
• https://blogs.securiteam.com/index.php/archives/3075 
Beyond Security 
Sources (3) 
• SSD Advisory – KEMP LoadMaster from XSS Pre Authentication to RCE 
• https://blogs.securiteam.com/index.php/archives/3194 
• SSD Advisory – Geneko Routers Unauthenticated Path Traversal 
• https://blogs.securiteam.com/index.php/archives/3317 
• SSD Advisory – Synology Photo Station Unauthenticated Remote Code Execution 
• https://blogs.securiteam.com/index.php/archives/3356 
• SSD Advisory – D-Link 850L Multiple Vulnerabilities (Hack2Win Contest) 
• https://blogs.securiteam.com/index.php/archives/3364 
Beyond Security 
Sources (4) 
• SSD Advisory – Remote Command Execution in Western Digital with Dropbox App 
• https://blogs.securiteam.com/index.php/archives/3397 
• SSD Advisory – HiSilicon Multiple Vulnerabilities 
• https://blogs.securiteam.com/index.php/archives/3025 
• Over 100K IoT Cameras Vulnerable to Source Disclosure 
• https://blogs.securiteam.com/index.php/archives/3043 
• SSD Advisory – Linksys PPPoE Multiple Vulnerabilities 
• https://blogs.securiteam.com/index.php/archives/3102 
Beyond Security 
Sources (5) 
• https://xsses.rocks/ip-cams-from-around-the-world-shodansafari/