Step 1: Make sure the publication server whose node is the parent of the publication
whose replication history you wish to cleanup is running and has been registered in the
xDB Replication Console you are using. See Section 5.2.1 for directions on starting and
registering a publication server.
Step 2: Select the Publication node of the publication for which you want to clean up
replication history.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 438
EDB Postgres Replication Server User’s Guide
Figure 7-53 - Selecting a publication for replication history cleanup
Step 3: From the Publication menu, choose Cleanup Replication History. Alternatively,
click the secondary mouse button on the Publication node and choose Cleanup
Replication History. The Cleanup Replication History confirmation box appears.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 439
EDB Postgres Replication Server User’s Guide
Figure 7-54 - Cleaning up replication history
Step 4: Click the Yes button in the Cleanup Replication History confirmation box.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 440
EDB Postgres Replication Server User’s Guide
Figure 7-55 - Cleanup Replication History confirmation
Step 5: Click the Yes button in response to Replication History Has Been Removed.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 441
EDB Postgres Replication Server User’s Guide
Figure 7-56 - Successful cleanup of replication history
After replication history cleanup, if you click the Replication History tab, no history
records appear.
Figure 7-57 - Replication History tab after replication history cleanup
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 442
EDB Postgres Replication Server User’s Guide
7.5.4 Cleaning Up Event History
Unlike shadow table history (Section 7.5.2) and replication history (Section 7.5.3), event
history is neither viewable nor removable using the xDB Replication Console.
Event history is a recording of various updates to the control schema tables that occur
during xDB Replication Server processing. Hence, the event history content grows
significantly over time.
The tables containing event history, and thus the tables to be cleaned up are the
following:
 xdb_events
 xdb_events_status
In addition, the replication history tables are cleaned up as well. These tables can also be
manually cleaned up as described in Section 7.5.3.
 xdb_pub_replog
 xdb_pub_table_replog
For Oracle, these tables are located in the schema of the publication database user.
For SQL Server and Postgres, these tables are located in schema
_edb_replicator_pub.
The event history and replication history data in the control schema are deleted on a
scheduled, daily basis at 12 AM, thus reducing the number of rows in tables
xdb_events, xdb_events_status, xdb_pub_replog, and
xdb_pub_table_replog.
Publication server configuration option historyCleanupDaysThreshold provides the
capability to designate how old the completed data must reach before its removal. The
default setting is that completed data must be older than seven days before it is deleted
during the daily 12 AM cleanup process.
In order to cleanup all completed event and replication history regardless of its age, set
historyCleanupDaysThreshold to a value of 0, then restart the publication server.
The cleanup occurs during the next scheduled 12 AM cleanup process.
See Section 10.4.1.10 for the historyCleanupDaysThreshold option.
7.6 Managing a Publication
After a publication has been created, certain aspects of the underlying replication system
environment might be subsequently altered for any number of reasons. Attributes that
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 443
EDB Postgres Replication Server User’s Guide
might change include the network location of the publication database server, the
network location of the host running the publication server, database or operating system
user names and passwords, and so forth.
The aforementioned information is saved in the replication system metadata when a
publication is created. Changes to these attributes result in inaccurate replication system
metadata, which in turn may result in errors during subsequent replication attempts or
replication system administration.
This section describes how to update the metadata stored for the publication server, the
publication database definition, and publications in order to keep the information
consistent with the actual replication system environment.
7.6.1 Updating a Publication Server
There are two aspects of metadata related to the publication server that may need to be
updated depending upon the change in the host environment:
 If the network location (IP address or port number), admin user name, or
password of the publication server changes, and if you have saved this
information in the server login file, you need to update the server login file with
the new information.
 If the network location (IP address or port number) of a subscription server
changes, then for each publication server managing a publication associated with
a subscription of the changed subscription server, you must update the publication
server’s metadata with the subscription server’s new network location. This type
of update applies only to single-master replication systems.
The first type of update is discussed in the following section. The second type of update
is discussed in Section 7.6.1.2.
7.6.1.1 Publication Server Login File
When you register a publication server in the xDB Replication Console, you may choose
to save the publication server’s network location, admin user name, and encrypted
password in a server login file on the computer on which you are running the xDB
Replication Console. See Section 4.2 for information on saving the login information.
The steps described in this section show you how to update the publication server’s login
information in the server login file.
It is assumed that the xDB Replication Console is open on your computer and the
publication server whose login information you wish to alter in the server login file,
appears as a Publication Server node in the xDB Replication Console’s replication tree.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 444
EDB Postgres Replication Server User’s Guide
Figure 7-58 - Publication Server node
You can perform the following actions on the server login file:
 Change the publication server’s login information (host IP address, port number,
admin user name, and password) that you last saved in the server login file.
 Delete the publication server’s login information that is currently saved in the
server login file. This is the default action, which will require you to register the
publication server again the next time you open the xDB Replication Console.
 Resave the publication server’s login information in the server login file. Each
time you open the Update Publication Server dialog box, you must choose to save
the login information if you want it recorded in the server login file.
The following steps change only the content of the server login file residing on the host
under the current xDB Replication Console user’s home directory. These changes do not
alter any characteristic of the actual publication server daemon (on Linux) or service (on
Windows). These changes affect only how a publication server is viewed through the
xDB Replication Console on this host by this user.
Step 1: The publication server whose login information you want to save, change, or
delete in the server login file must be running before you can make any changes to the
file. See Step 1 of Section 5.2.1 for directions on starting the publication server.
Step 2: Click the secondary mouse button on the Publication Server node and choose
Update. The Update Publication Server dialog box appears.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 445
EDB Postgres Replication Server User’s Guide
Figure 7-59 - Update Publication Server dialog box
Step 3: Complete the fields in the dialog box according to your purpose for updating the
server login file:
 If the publication server now runs on a host with a different IP address or port
number than what is shown in the dialog box, enter the correct information. You
must also enter the admin user name and password saved in the xDB Replication
Configuration file that resides on the host identified by the IP address you entered
in the Host field. Check the Save Login Information box if you want the new
login information saved in the server login file, otherwise leave the box
unchecked in which case, access to the publication server is available for the
current session, but subsequent sessions will require you to register the
publication server again.
 If you want to delete previously saved login information, make sure the network
location shown in the dialog box is still correct. Re-enter the admin user name and
password saved in the xDB Replication Configuration file that resides on the host
identified by the IP address in the Host field. Leave the Save Login Information
box unchecked. Access to the publication server is available for this session, but
subsequent sessions will require you to register the publication server again.
 If you want to save the current login information shown in the dialog box, make
sure the network location shown in the dialog box is correct. Re-enter the admin
user name and password saved in the xDB Replication Configuration file that
resides on the host identified by the IP address in the Host field. Check the Save
Login Information box.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 446
EDB Postgres Replication Server User’s Guide
Figure 7-60 - Updated publication server location
Step 4: Click the Update button. If the dialog box closes, then the update to the server
login file was successful. Click the Refresh icon in the xDB Replication Console tool bar
to show the updated Publication Server node.
If an error message appears after clicking the Update button, the server login file is not
modified. Investigate and correct the cause of the error. Repeat steps 1 through 4.
7.6.1.2 Subscription Server Network Location
Note: This section applies only to single-master replication systems.
Part of the metadata stored for each publication server is the network location of
subscription servers that manage subscriptions associated with the publication server’s
publications.
This network information enables the publication server to communicate with the
subscription server.
If the network location of a subscription server changes after subscriptions have been
created, the publication server metadata must be updated with the new network location,
otherwise a communication failure occurs between the publication server and the
subscription server that is made apparent by the following message that appears when
you open the xDB Replication Console.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 447
EDB Postgres Replication Server User’s Guide
Figure 7-61 - Subscription server connection failure
The following are the steps to update the subscription server network location within a
publication server’s metadata.
Step 1: The publication server whose metadata you want to change must be running. See
Step 1 of Section 5.2.1 for directions on starting the publication server.
Step 2: Click the secondary mouse button on the Publication Server node and choose
Update Subscription Servers. The Update Subscription Servers dialog box appears.
Note: If the error message box reappears, click the OK button and repeat Step 2.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 448
EDB Postgres Replication Server User’s Guide
Figure 7-62 - Update Subscription Servers dialog box
Step 3: Enter the new network location for each subscription server in the list whose
network location has changed.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 449
EDB Postgres Replication Server User’s Guide
Figure 7-63 - Updated subscription server location
Step 4: Click the Update button. If the dialog box closes, then the update to the
publication server’s metadata was successful.
If an error message appears, investigate and correct the cause of the error. Repeat steps 1
through 4.
Step 5: If the subscription server with the new network location manages subscriptions
associated with publications in other publication servers, repeat steps 1 through 4 for
these other publication servers.
7.6.2 Updating a Publication Database
When you create a publication database definition, you save the publication database
server’s network location (IP address and port number), the database identifier, a
database login user name, and the user’s password in the control schema accessed by the
publication server. This login information is used whenever a session needs to be
established with the publication database. See Section 5.2.2 for information on creating a
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 450
EDB Postgres Replication Server User’s Guide
publication database definition for a single-master replication system. See sections 6.2.2
and 6.3 for a multi-master replication system.
The steps described in this section show you how to update the publication database login
information stored in the control schema should any of these attributes of the actual,
physical database change.
Note: Depending upon the database type (Oracle, SQL Server, or Postgres), certain
attributes must not be changed. You must not change any attribute that alters access to the
schema where the control schema objects were created when you originally added this
publication database definition. See Section 5.2.4 for the location of the control schema
objects.
Attributes you must not change include the following:
 The Oracle login user name of an Oracle publication database as the control
schema objects already reside in this Oracle user’s schema
 The database server network location if the new network location references a
database server that does not access the publication database where the control
schema objects are stored
 The database identifier if the new database identifier references a different
physical database than where the control schema objects are stored
Attributes you may change include the following:
 The login user name’s password to match a changed database user password
 The database server network location if the corresponding location change was
made to the database server that accesses the publication database
 The database identifier such as the Oracle service name, SQL Server database
name, or Postgres database name if the corresponding name change was made on
the database server
Step 1: Make sure the database server that you ultimately wish to save as the publication
database definition is running and accepting client connections.
Step 2: Make sure the publication server whose node is the parent of the publication
database definition you wish to change is running and has been registered in the xDB
Replication Console you are using. See Section 5.2.1 for directions on starting and
registering a publication server.
Step 3: Select the Publication Database node corresponding to the publication database
definition that you wish to update.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 451
EDB Postgres Replication Server User’s Guide
Figure 7-64 - Selecting a publication database definition for update
Step 4: From the Publication menu, choose Publication Database, and then choose
Update Database. Alternatively, click the secondary mouse button on the Publication
Database node and choose Update Database. The Update Database Source dialog box
appears.
Step 5: Enter the desired changes. See Step 3 of Section 5.2.2 for the precise meanings of
the fields for a single-master replication system. See sections 6.2.2 and 6.3 for a multi-
master replication system.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 452
EDB Postgres Replication Server User’s Guide
Figure 7-65 - Update Database Source dialog box for a single-master replication system
Step 6: Click the Test button. If Test Result: Success appears, click the OK button, then
click the Save button.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 453
EDB Postgres Replication Server User’s Guide
Figure 7-66 - Successful publication database test
If an error message appears investigate the cause of the error, correct the problem, and
repeat steps 1 through 6.
Step 7: Restart the publication server. See Section 5.2.1 for directions on restarting the
publication server.
Step 8: Click the Refresh icon in the xDB Replication Console tool bar to show the
updated Publication Database node and any of its publications.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 454
EDB Postgres Replication Server User’s Guide
Figure 7-67 - Updated publication database
7.6.3 Updating a Publication
Existing publications can be updated in the following ways:
 Tables can be added to the publication
 Tables can be removed from the publication
 Filter rules can be updated on publication tables
7.6.3.1 Adding Tables to a Publication
For a single-master replication system, you can add tables to a publication, even while
there are existing subscriptions associated with the publication.
Similarly for a multi-master replication system, you can add tables to a publication while
there are additional master nodes in the replication system.
The following are the steps to add tables to an existing publication.
Step 1: Make sure the publication server whose node is the parent of the publication you
wish to change is running and has been registered in the xDB Replication Console you
are using. See Section 5.2.1 for directions on starting and registering a publication server.
Step 2 (For SMR only): Select the Publication node of the publication to which you
wish to add tables.
Step 2 (For MMR only): Select the Publication node under the Publication Database
node representing the master definition node.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 455
EDB Postgres Replication Server User’s Guide
Figure 7-68 - Selecting a publication to which to add tables
Step 3: Open the Add Tables dialog box in any of the following ways:
 From the Publication menu, choose Update Publication, then Add Tables.
 Click the secondary mouse button on the Publication node, choose Update
Publication, and then choose Add Tables.
 Click the primary mouse button on the Add Publication Tables icon.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 456
EDB Postgres Replication Server User’s Guide
Figure 7-69 - Opening the Add Tables dialog box
Step 4: Fill in the following fields in the Add Tables tab of the Add Tables dialog box:
 Add. Check the boxes next to the table names from the Available Tables list that
are to be added to the publication. If the publication is a snapshot-only
publication, then views would appear in the Available Tables list as well. The
Available Tables list contains only tables and views that are not already members
of other publications under the same Publication Database node. Alternatively or
in addition, click the Use Wildcard Selection button to use wildcard pattern
matching for selecting tables to be added to the publication.
 Select All. Check this box if you want to include all tables and views in the
Available Tables list in the publication.
 Use Wildcard Selection. Click this button to use the wildcard selector to choose
tables for the publication. See Section 7.1 for information on the wildcard
selector.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 457
EDB Postgres Replication Server User’s Guide
Figure 7-70 - Add Tables dialog box
If you wish to omit certain rows of the publication tables or views from being replicated
follow the directions in the next step to create a filter, otherwise go on to Step 6.
Step 5 (Optional): If you want to filter the rows of the publication tables or views, click
the Table Filters tab. Define filter rules by entering a unique, descriptive filter name and
an appropriate SQL WHERE clause in the Filter dialog box to select the rows you want to
replicate.