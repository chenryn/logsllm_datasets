此开始。
可以坚持这样一些规则：如只包含数字而且10位数字必须
放在一起。
可以把电话号码分为3个表单域：一个对应区号：一个对应前3位最后一个
对应后4位
或者可以告诉填写表单的人：电话号码必须遵储（555）636-4652的形式
要由我们来建立规则。
有太多可能的模式了。如何
建立规则来涵盖所有这些模
式呢？
关于电话号码，有一些方面是确定的，我们可以利用这些方面来建
立规则。
首先，电话号码不能以1（长途）或0（接线员）开头。其次，电话
号码应当有10位数。尽管有些人可能有更聪明的办法，可以用字母来
表示他们的电话号码，但电话号码基本上是数字，如果包括区号则
共有10位数字。
568
第10章
---
## Page 605
正则表达式
建立电话号码模式
要超越基本验证，如empty（）和isset（），我们需要确定希望数据与何种模
式匹配。对于电话号码，这说明需要指定一种格式，从表单电话号码域接收
数据时希望能遵循这种格式。一旦确定了电话号码格式/模式，就可以根据它
来完成验证。
以下可能是当今最常见的电话号码格式，至少对于美国国内电话号码来说，
这些是最常见的格式。遵循这种格式意味着，如果用户提交的电话号码数据
与此不匹配，PHP脚本会拒绝表单，并显示一个错误消息。
我们送择的格式是3位数字加一个连字符，
###-＃#＃-＃＃##
接下来又是3位数字，再加一个连字符，以
及最后的4位数字。
636-46521
这里缺少几个数字和一
合法！
个
个连字符，而且这里有
555-636-46521
的连字符看起来位置也
不对。
这里有一个
555-636-4652
多余的数字！
5556364652
这里缺少连
这与我们的模式
字符。
宪全匹配。
thereareng
DumbQuestions
号码吗？
希望的模式，这样完全可以。遗憾的
表示电话号码吗？一个表示区号，第
是，这并不是一个很好的模式，因为
二个有3位数字，第三个文本域中是最
大多数人在填写表单时都不会像这样
后4位数字。这样我就可以使用PHP的
模式，因为它相当标准。不过在设计
把电话号码写在一起。这有些不太标
串函数了。
你自己的表单时，应当选择对你来说
准，这意味着用户会不习惯，相应地
最合适的模式。不过要记住，模式的
可能不愿意遵循这种模式。
认可度越广，用户就越有可能遵循。
网站就是这样做的。不过，能够匹配
模式会提供更大的灵活性。匹配模式
想怎样就怎样，不是吗？
在很多方面都很有用，而不只是确保
个类似##########的模式，然后使用
你的用户输入了模式正确的电话号码，
PHP的串函数来确保数据包含10个数
这一点将在本章后面谈到。
字字符吗？
的用户能有好的体验。否则他们不会
再访问你的网站。
你现在的位置
569
---
## Page 606
引入正则表达式
围正则表达式匹配模式
PHP提供了一种强大的方法创建和匹配文本中的模式。可以创建一些
规则来查找文本串中的模式。这些规则就称为正则表达式，或简写
为regex。正则表达式表示要匹配的一个字符模式。利用正则表达式的
帮助，可以在代码中描述希望串遵循哪些规则来得到一个匹配。
举一个例子，以下是一个正则表达式，要查找一行中的10位数字。这
个模式只匹配由10位数字组成的串。如果串长度大于或小于10个字符，
则不能匹配。如果串包含非数字的其他字符，也不能匹配。下面来详
细分析这个正则表达式。
这部分很容易理解。所有正
则表达式都以斜线开头和
结属。
/$p\p\p\P\P\p\p\p\p\pl/
这个美元衍表示
K
串必须结束。
表示从事的开始处开
始匹配。
\d代表数字。串中的第一
….而且这里的第一个\都表
个字符必须是一个数字.
示同样的含义，即号找另一个
数字，总共有（0个数字。
还可以采用一种更简洁的方法重写这个正则表达式，这里要
用到大括号。大括号用于指示重复：
/^\d{10}/
正则表达式是一
些规则，用于匹
配一个或多个串
这与上面的模式表示同样的含
义。（10是表示（0个数字的一种简写
中的模式。
形式。
570
第10章
---
## Page 607
正则表达式
对，正则表达式相当
“清晰”。简直就像泥巴
一样“清楚”
确实，你的讽刺有一定道理。正则表达式很费解，而且通常很难
读·不过它们确实非常强大。
能力总是有代价的，对于正则表达式，这个代价就是要学习正则
表达式费解的语法。你不可能一夜之间就成为一个正则表达式专
家，不过好在你也不必成为一个正则表达式专家。利用正则表达
式可以做一些极其强大而有用的工作，特别是对于表单域验证，只
需对正则表达式有非常基本的了解就可以完成复杂的验证。另外，
更多地使用正则表达式，更多地练习分解和解析正则表达式，就能
更容易地理解它们。
PDG
你现在的位置
571
---
## Page 608
常用正则表达式元字符
使用元字符构建模式
我们能够使用\d来匹配文本串中的数字，这很不错，不过如果这就是
利用元字符可以
正则表达式所能提供的全部功能，那么它的用途就太有限了。仅仅能
在正则表达式中
匹配数字对于RiskyJobs电话号码验证功能来说还不够，因为我们还希
望能够匹配其他字符，如空格、连字符甚至字母。
描述文本模式。
幸运的是，基于PHP的正则表达式功能，可以使用一组类似\d的特殊
表达式来匹配这些内容。这些表达式称为元字符。下面来看最常使用
的一些正则表达式元字符。
P\
上一页已经看到，这个元字符要查找一个数字。这
\w
会匹配0到9之间的任何数字，\d本身只匹配一位数
查找任何字母数字字符。换句话说，可以是一个字
字，所以如果希望匹配一个两位数，则要使用\d\d
母或者一个数字。它会匹配以下范围内的任意一个
或\d{2}。
字符，包括a-z和A-Z（大写和小写字母），以及0-9
（类似于\d）。
Is
查找空白符。这不只是按下空格键在屏幕上显示的
空格字符；\s还能匹配制表符、换行或回车符。同
上一页上还见过元字符。它会查找一个串的开始
样地，要记住\s一次只匹配一个这样的字符。如果
位置，所以可以用它指示必须从一个文本串的起始
希望匹配一行中的两个空格字符，则需要使用\s\s
位置开始匹配，而不是串中的任何其他位置。例如，
或\s{2）。
正则表达式/^\d（3）/能匹配串“300applications"
但不能匹配“Wereceived300applications”。
点元字符可以匹配除换行符以外的任意一个字
符。它能匹配字母或数字（类似于\w），还可
$
查找串尾。可以结合使用这个$元字符确定匹配
以匹配空格或制表符（类似于\s）。
的范围，指定匹配究竞从哪里开始到哪里结束。例
如，/^\w（5}\s\d{3}$/能匹配“Nanny411"
但不能匹配“Nanny 411is great”或“CallNanny
411”。
这些元字符很棒，但是如果你确实希望正则表达式中有一个
特定字符该怎么做？只需要直接在表达式中使用该字符。
例如，如果希望匹配具体的电话号码“707-827-7000”，可以使
用正则表达式/707-827-7000/。
572
第10章
---
## Page 609
正则表达式
将以下各个不同的电话号码正则表达式与它匹配的电话号码连线。
正则表达式
所匹配的串
5556364652
/\d(3}\s\d(7}$ /
/\d{3}\s\d(3}\s\d{4}$/
5556364652
/\d{3}\d(3}-\d{4)$/
555636-4652
/^\d{3}-\d{3}-\d( 4}$/
555 ME NINJA
/\d(3}\s\w\w\s\w(5)S/
5556364652
/\d{10}s/
555-636-4652
你现在的位置
573
---
## Page 610
whodoeswhat答案
答案
将以下各个不同的电话号码正则表达式与它匹配的电话号码连线。
/\d{3}\s\d(7}$/
5556364652
/^\d(3}\s\d{3)\s\d{4} $ /
5556364652
/\d(3}\d{3)-\d{4}$/
555636-4652
Risky o6s中医
配###一###一####形
式的电话号码就需要这个模式。
/\d{3}-\d{3}-\d{4}$/
555 ME NINJA
/\d(3}\s\w\\s\w{5)S/
5556364652
这个楼式中的w元字符金匹
配宇母。
/\d{10}s/
555-636-4652
AH
这个模式都是数字，所以只匹配不包舍
空格或连字符的电话号码。
574
第10章
---
## Page 611
正则表达式
扮演正则表达式
你的任务是护演正则表达式，可以接受或
拒绝RiskyJobs用户提供的电话号码。如
果你认为是合法的电话号码，请选中相应
的复选框，其他复选框则不要
选中。解释那些号不合法的
原因。
这是电话号码正则表达
式，你要扮演的角色！
/\d{3}-\d{3}-\d{4}/
(555) 935-2659
(555)672-0953
555-343-8263
冲浓可能很危险，特
别是作为一个职业肇
鱼辑！
PDG
555-441-9005
555.903.6386
555-612-8527-8724
你现在的位置
575
---
## Page 612
扮演正则表达式答案
扮演正则表达式答案
你的任务是扮演正则表达式，可以接受或
拒绝RiskyJobs用户提供的电话号码。如
果你认为是合法的电话号码，请选中相应
的复选柜，其他复选柜则不要
选中。解释那些号档不合法的
原因。
这是电话号码正则表达
式，你要扮演的角色！
/\d{3}-\d{3}-\d{4}$/
括号是不元许的
另外不允许有空格。
(555)935-2659
(555)672-0953
555-343-8263
请不要加括号。
哇。
这里有额外
我们的正则表达式
的4个数字。这是
需要连字符，而不是
办公室的分机吗？
点号。
555-441-9005
555.903.6386
555-612-8527-8724
576
第10章
---
## Page 613
正则表达式
有时人们会在电话号码后面增加额外的几
个数字，如最后一个4位数字的分机号。
有没有办法区配达些模式？
可以，不过关键是要指定这样一个模式在正则表达式中是可选的。
如果将正则表达式修改为/^d{3}-\d{3}-\d{4}-d{4}$/，则要求串的在最后必须有一
个4位数字的分机号，这样一来将无法再与类似“555-636-4652”的电话号码匹
配。不过可以使用正则表达式指出串的这一部分是可选的。正则表达式支持一个
称为量词（quantifier）的特性，允许指定字符或元字符在一个模式中出现多少次。
你已经见过以下正则表达式中量词的使用：
/^\d{10}/
这表示“一个数字应当在
一行中出现10次”
在这里，大括号相当于一个量词，指出前面的数字应当出现多少次。下面来看另
外一些常用的量词。
(min,max)
+
如果大括号里有两个数字，并用一个逗号分
前面的字符或元字符必须
隔，这指示了前面的字符或元字符重复次数的
重复1次或多次。
？
范围。{2,4}就是要求应当在一行中出现2、3或
前面的字符或元字符必须
4次。
出现1次或者根本不出现。
★
字符或元字符可以出现1次或
多次.…或者根本不出现。
量词指定了一
个元字符应当
所以，如果希望匹配电话号码最后的这些可选的数字，可以使用以下模式：
出现多少次。
/\d{3}-\d{3}-\d{4}（-\d{4})?/
应用量调的部分用
括号色围。
问号使这个连字符和最后
4位数是可选的。
你现在的位置
577
---
## Page 614
使用字符类
你忘了一件事。美
国的电话不能以0或1
开头。
绝对正确。0会使你连接到接线员，1会拨长途。
我们只想要区号和号码，需要确保第一个数字不是1或0。为
此，需要一个字符类（characterclass）。
利用字符类，可以匹配一个特定值集合中的字符。可以使用
字符类查找一个数字范围，还可以查找一个值集合。另外可
以增加一个查找这个集合以外的所有字符。
要指示一组字符或元字符属于一个字符类，只需要用中括号
将它们包围起来（[]）。下面来看实际使用的几个字符类例
子：
在一个字符类中，
表示“不匹配”
[0-2]
[-q]
这与一个数字范围匹配。它会匹配0、1
在字符类中使用这个时有一个特殊的含义。并
或2。
[A-D]
除以外的所有字符”
这会匹配A，B，C或D。
这会匹配除b，c，d，e或fl外的所有字符。
字符类是一组
匹配单个字符
的规则。
请写出一个匹配国际电话号码的正则表达式：
AH
578
第10章
---
## Page 615
正则表达式
围字符类优化模式
在字符类的帮助下，可以优化电话号码的正则表达式，使它不会匹配不
合法的数字组合。这样一来，如果有人不小心输人了以0或1开头的区号，
就可以抛出一个错误消息。改进后的新正则表达式如下所示：
和S指定正则表达式必须包含所匹