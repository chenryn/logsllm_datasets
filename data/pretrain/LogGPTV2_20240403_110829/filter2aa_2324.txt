Tsung Pei Kan 
PI:EMAIL 
1
Graduated from Central Police University . He likes to study about 
Kernel and Reverse Engineering. He is interested in the subject of 
Computer Forensic. He’s working for National Police Agency now. 
Besides, he is also the docent for Taiwan Network Information Center.  
At the beginning of last year he developed a scanner based on 
behavioral analysis call "NPASCAN", it can detect and exam the 
unknown malware very quickly. The most important thing is you can 
free download from the NPA website. 
Special skills: 
Windows System Programming 
Malicious Software Analysis 
Software Reversing 
Computer Forensics 
Experience  
National Police Agency (NPA) 
 Information Department  
Criminal Investigation Bureau (CIB) 
 High-Tech Crime  Investigation Center 
 Information Department  
2
 Foxy is a Chinese P2P software which is 
popular in Taiwan, China,Hong Kong and 
Macau. 
 It is based on the Gnutella and G2 architecture. 
3
Data leaked 
into Foxy P2P 
network(TW) 
4
Data leaked 
into Foxy P2P 
network(TW) 
5
6
7
8
9
 Although they have different UI, these clients 
join to the same P2P network. 
 Do not think that you did not install foxy, so 
your data will be safe. 
10
11 
11
Adsl dial  
Id/Password 
12
Sharing 
nodes can’t 
be seen in an 
easy way. 
The file will 
be shared 
immediately 
after 
downloading. 
Limited 
software 
function 
Only Foxy 
can join to 
the Foxy 
network  
13
Connect to Foxy  
Search from Foxy 
Download from foxy 
14
GWebCaches  
15
16
 GNUTELLA CONNECT/0.6 
 Listen-IP: 61.57.116.229:24499 
 Remote-IP: 203.185.52.200 
 User-Agent: Foxy 1.8.6.0 
 Accept: application/x-gnutella2 
 X-Ultrapeer: False 
 Accept-Encoding: deflate 
 X-Auth-Challenge: KxElu1Q 
17
 GNUTELLA/0.6 200 OK 
 Listen-IP: 203.185.52.200:7952 
 Remote-IP: 61.57.116.229 
 User-Agent: Foxy 1.9.10.0 
 Content-Type: application/x-gnutella2 
 Accept: application/x-gnutella2 
 X-Ultrapeer: True 
 Accept-Encoding: deflate 
 X-Auth-Response: RhXb6zC5Yss 
 X-Auth-Challenge: 3H5HtDHD 
 X-Try-Hubs: 219.78.62.158:10686 2010-10-
03T15:37Z,111.249.145.101:18218 
18
 GNUTELLA/0.6 200 OK 
 X-Ultrapeer: False 
 Content-Type: application/x-gnutella2 
 Content-Encoding: deflate 
 X-Auth-Response: PLHJxI7zcKU 
Using custom Tiny Encryption Algorithm (TEA) and 
Base64 algorithm. 
Foxy is a closed Gnutella P2P network 
19
20
21
22
Ultrapeer 
Ultrapeer 
Ultrapeer 
Ultrapeer 
23
24
25
26
Now… 
27
Network 
Connected 
28
Input the 
search 
keyword 
29
Sharing 
Nodes 
Resolved host 
Which nodes are 
sharing the file? 
30
Downloading 
31
More information 
32
各结点传输协定 
File part list 
Receving 
33
 Gnutella's distributed search protocol allows 
a set of peers, servents or clients, to perform 
filename searches over other clients without 
the need of an intermediate index server.  
 The Gnutella network topology is a pure Ad-
Hoc topology where clients may join or leave 
the network at any time without affecting the 
rest topology in any sense. 
34
Recall that using the purely decentralized version, packets are flooded 
throughout the network.  
If the v0.6 ultrapeer recommendation is implemented, searching is 
optimized using Query hash tables(QHTs). 
 A QHT is maintained by each node, and describes the 
content it is sharing. 
 An ultrapeer maintains an aggregate of its leaf's QHTs 
and its own QHT.   
 Searches are performed by forwarding a query to an 
ultrapeer, who checks its aggregate QHT for a match.   
▪ If there is a match, the query is forwarded to the appropriate 
leaf, otherwise the query is forwarded to neighbouring 
ultrapeers by “flooding”.    
35
36
37
38
 If we assume that each p is connecting to averagely 5 
other peers (which is usually much higher) and will 
forward a message only in a depth of 7 (i.e. TTL=7), 
which is also typical for a Gnutella client and assuming 
that each peer is using message flooding, which 
means that Mp fake responses will be sent to all of its 
peers we will averagely reach 20,480 other p. 
 The reach is determined by n (# connections to other 
hosts) and TTL : 
 Assumption: nodes all have the same n and TTL. 
TTL
t
t
n
n
1
1) 1.
(
39
 Decentralized, 2-tier. 
 This  architecture is recommended for 
Gnutella in v0.6. 
 New node enters by connecting to a 
known hub (almost identical to 
Gnutella's handshake). 
 Hubs typically accept 300-500 leaves, 
and connect to 5-30 other hubs.    
 Leaves typically connect to 3 hubs. 
40
 Ultrapeers are called “hubs”. 
 Uses a QHT like Gnutella, but if a hub cannot 
match a query to its aggregate QHT, it checks a 
set of caches: 
 Each hub maintains a cached copy of each 
neighbouring hub's aggregate QHT.   
 Upon a search miss, a hub will try to match the query 
against its cached copies of its neighbours QHTs. 
 If the query matches, it will forward the query once, 
and the node that receives the query processes it and 
directly sends the result back to the client. 
 If no match is made, the searching client will continue 
at another untried hub. 
41
Ultrapeer 
Ultrapeer 
Ultrapeer 
Ultrapeer 
42
43
44
 http://evchk.wikia.com/wiki/Foxy 
 http://www.cs.hku.hk/cisc/event/20080827_FoxyPCO/
FoxyPCO_20080827.pdf 
 http://en.wikipedia.org/wiki/Foxy_(P2P) 
 http://alumni.cs.ucr.edu/~csyiazti/courses/cs260-
2/project/gnutella.pdf 
 http://limewire.negatis.com/index.php?title=Dynamic
_Querying 
 http://crawler.trillinux.org/status.html 
 www.scs.carleton.ca/~kranakis/523-
course/Thorpe.ppt 
 http://gnucleus.cvs.sourceforge.net/viewvc/gnucleus/ 
45
PI:EMAIL 
If you have any questions, please contact me at 
46