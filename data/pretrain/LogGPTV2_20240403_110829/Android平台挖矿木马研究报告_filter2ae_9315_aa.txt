# Android平台挖矿木马研究报告
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
## 摘要
  * 手机挖矿木马就是在用户不知情的情况下利用其手机的计算能力来为攻击者获取电子加密货币的应用程序。
  * 电子加密货币是一种匿名性的虚拟货币，由于不受政府控制、相对匿名、难以追踪的特性，电子加密货币常被用来进行非法交易，也成为犯罪工具、或隐匿犯罪所得的工具。
  * 2014年3月首个Android平台挖矿木马被曝光。
  * 从2013年开始至2018年1月，360烽火实验室共捕获Android平台挖矿木马1200余个，其中仅2018年1月Android平台挖矿木马接近400个。
  * 从Android平台挖矿木马伪装应用类型看，工具类（20%）、下载器类（17%）、壁纸类（14%）是最常伪装的应用类型。
  * 从样本来源来看，除了被曝光的在Google play中发现的十多个挖矿木马外，我们在第三方下载站点捕获了300多个挖矿木马，总下载次数高达260万余次。
  * 从网站来看，据Adguard数据显示，2017年近1个月时间内在Alexa排行前十万的网站上，约有220多个网站在用户打开主页时无告知的利用用户计算机进行挖矿，影响人数多达5亿。大多是以视频门户网站，文件分享站，色情网站和新闻媒体站等这类相对访问时间较长的站点。
  * Android平台发现的挖矿木马选择的币种主要有（BitCoin）、莱特币(Litecoin)、狗币(Dogecoin)、卡斯币(Casinocoin) 以及门罗币（Monero）这五种。
  * 挖矿方式有单独挖矿和矿池挖矿两种，Android平台挖矿木马主要采用矿池挖矿。
  * Android平台挖矿木马技术原理从代码上看，主要分为使用开源的矿池代码库进行挖矿和使用浏览器JavaScript脚本挖矿。
  * 挖矿木马的技术手段包括检测设备电量、唤醒状态、充电状态、设置不可见页面以及仿冒应用下载器。
  * 应用盈利模式由广告转向挖矿，门罗币成为挖矿币种首选以及攻击目标向电子货币钱包转移成为Android平台挖矿木马的趋势。
  * 目前挖矿木马的防御措施，PC平台已经具备防御能力，移动平台由于权限控制不能彻底防御。
  * 移动平台挖矿受限于电池容量和处理器能力，但电子加密货币正在快速增长，现有货币增值并出现新的货币币种，挖矿最终会变得更有利可图。
  * 国外这种全新的盈利模式，还处在起步阶段，还需要更多的控制和监管，避免被恶意利用。
**关键词：** 手机挖矿木马、电子货币
## Android平台挖矿木马介绍
  * ###  什么是手机挖矿木马
挖矿（Mining），是获取[比特币](https://zh.wikipedia.org/wiki/%E6%AF%94%E7%89%B9%E5%B8%81)等电子加密货币的勘探方式的昵称。由于其工作原理与开采[矿物](https://zh.wikipedia.org/wiki/%E7%A4%A6%E7%89%A9)十分相似，因而得名。
手机挖矿木马就是在用户不知情的情况下利用其手机的计算能力来为攻击者获取电子加密货币的应用程序。
  * ###  电子加密货币
电子加密货币是一种匿名性的虚拟货币。它不依靠任何法定货币机构发行，更不受央行管控。交易在全球网络中运行，有特殊的隐秘性，加上不必经过第三方金融机构，因此得到越来越广泛的应用。
由于不受政府控制、相对匿名、难以追踪的特性，电子加密货币常被用来进行非法交易，也成为犯罪工具、或隐匿犯罪所得的工具。以WannaCry为代表的勒索软件，都采用比特币为支付工具。
2009年，[比特币](https://zh.wikipedia.org/wiki/%E6%AF%94%E7%89%B9%E5%B8%81)成为第一个[去中心化](https://zh.wikipedia.org/wiki/%E5%8E%BB%E4%B8%AD%E5%BF%83%E5%8C%96)的电子加密货币，也是目前知名度与[市场总值](https://zh.wikipedia.org/wiki/%E5%B8%82%E5%A0%B4%E7%B8%BD%E5%80%BC)最高的加密货币。
比特币在2013年4月~2018年1月价格变化趋势[1]
2017年比特币的价格上涨了1500%，最高时单个比特币价格逼近2万美元。且随着比特币价格的疯狂上涨，挖矿木马的攻击事件也越来越频繁。
  * ###  手机挖矿木马历史演变
挖矿木马最早是2013年在PC平台上被发现，而首个手机挖矿木马CoinKrypt[2]最早被国外安全厂商在2014年3月曝光。手机挖矿木马经过一阵沉寂后，随着电子加密货币价格的一路走高，恶意软件作者又重新将目标转向了挖矿。手机挖矿木马的攻击事件也重回视野，且势必是未来恶意软件的趋势之一。
2014年03月Android.Coinkrypt，Android平台上首个挖矿木马。
2014年04月Android. BadLepricon[3]，在Google Play上发现手机挖矿木马。
2014年05月Android. Widdit[4]，首个使用Android挖矿SDK的挖矿木马。
2017年10月Android.JsMiner[5]，首个加载JavaScript的挖矿木马。
2017年10月Android.CpuMiner[6]，首个使用cpuminer库的挖矿木马。
2017年12月Android.PickBitPocket[7]，伪装成比特币钱包的欺诈程序。
2017年12月Android.Loapi[8]，拥有复杂模块化架构的挖矿木马。
2018年1月Android.Hackword[9]，首个使用Coinhive安卓SDK挖矿的木马。
  * ##  Android平台挖矿木马现状
  * ###  规模和影响
从2013年开始至2018年1月，360烽火实验室共捕获Android平台挖矿木马1200余个，其中仅2018年1月Android平台挖矿木马接近400个，占全部Android平台挖矿类木马近三分之一。
2014年Android挖矿木马经过短暂的爆发后，于2015，2016年逐渐归于平静。主要原因是受到当时移动平台技术等限制，以及电子货币价格影响，木马作者的投入和产出比不高。但随着2017年年底电子货币价格的一路高涨，挖矿技术的成熟，再次得到木马作者的目标，手机挖矿木马在也呈爆发式增长。
Android平台挖矿木马伪装成各类应用软件，统计发现其中工具类（20%）、下载器类（17%）、壁纸类（14%）是最常伪装的应用类型。
从样本来源来看，除了被曝光的在Google
play中发现的十多个挖矿木马外，我们在第三方下载站点捕获了300多个挖矿木马，根据其网页上的标识，估算出这个网站上的APP总下载次数高达260万余次。
第三方下载站点下的挖矿木马
从网站来看，据Adguard数据显示[10]，
2017年近1个月内在Alexa排行前十万的网站上，约有220多个网站在用户打开主页时无告知的利用用户计算机进行挖矿，影响人数多达5亿。
Adguard近一个月的调查数据
这些网站来自美国、印度、俄罗斯、中国、巴西以及中国等多个国家。
主要国家占比
而这部分网站大多是以视频门户网站，文件分享站，色情网站和新闻媒体站等这类相对访问时间较长的站点。
挖矿网站分类情况
  * ###  目标币种
挖矿木马在币种选择上是随着币种的挖掘难度和币种相对价格等因素而变化。目前在Android平台发现的挖矿木马选择的币种主要有（BitCoin）、莱特币(Litecoin)、狗币(Dogecoin)、卡斯币(Casinocoin)
以及门罗币（Monero）这五种。