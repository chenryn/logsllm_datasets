对于防病毒日志，包括事件名、事件时间、事件病毒名称、事件设备名称、事件感染文件、事件对病毒的操作情况、事件源地址、事件源主机名称等。
对于审计类日志，包括用户会话查询的部门、用户名、主账号、源ip、目的端口、登录事由、登录时间、登出时间等
参照具体设备日志记录通常的配置执行。
数据库和中间件类日志
系统类型
主要是指Oracle、SqlServer、MySql等关系型数据库，Redis、Hbase、MongoDB等NoSQL数据库和大数据系统，Websphere、Weblogic、Tomcat、MQ、Kafka、Storm、Apache等应用中间件。
记录内容要求
数据库和中间件类日志，应至少包含下述信息：
系统的启动和关闭事件。
系统错误。数据库和中间件类日志，应至少包含下述信息：
系统的启动和关闭事件。
系统错误。
用户所做的操作及执行状态；包括用户操作时的用户识别符、登录时间、注销时间、事件发生的日期和时间、事件内容、操作结果等。
用户认证信息和访问信息，包括登录名、登录时间、登录状态、主机和客户端IP地址、访问的协议、端口、访问内容。
参照具体系统日志通常的配置执行。
另外，数据库类日志，还应至少包含下述信息：
包括用户登录、注销、数据查询、插入、数据修改、数据删除、修改配置等操作行为日志。
应用系统类日志
系统类型
主要是指纳入日志管理的应用系统，参照公司应用系统基线清单。
应用系统日志功能要求
应用系统的日志，应记录应用程序的运行状况信息、重要事件信息（如增删改用户和用户权限、增删改查重要数据、系统攻击等安全事件）。应用系统的日志，还应记录有利于持续改善用户体验的用户行为、操作记录、位置信息等数据，对这类数据的记录和使用应合法合规。应支持数据查阅审计功能：如按照主题、事件查阅，应用系统应明确用户查阅审计数据的权限。
在意外情况出现时，应有措施保证审计数据的可用性。
普通用户、管理员用户、特权用户、特殊账户等对应用系统访问与使用的监控和留痕。
新建应用系统需具备本地记录日志和SYSLOG日志转发能力。
新建应用系统日志具备分类输出能力，本地日志应按照日期或者固定大小分文件存放，存放到数据库里的日志应按照序号或时间序列保存。
新建应用系统需提供日志格式说明书。
新系统上线前需通过日志记录规范性检查。
生成日志文件名格式应保持不变，如果变化应该保留不通版本的格式要求信息。
日志文件定期或达到指定大小时将日志转存。
日志格式尽量采用单行文本记录方式，一条日志即为一行。
日志必须记录日志级别、调用类型。
应用日志内容不允许输出到系统软件（操作系统和中间件等）日志中。
采用集群、负载均衡、分布式等方式部署的应用系统，记录的日志应包含节点信息。采用集群、负载均衡、分布式等方式部署的应用系统，记录的日志应包含节点信息。
记录内容要求
应用系统类日志，应至少包含下述信息：
应用系统间、系统与子系统间调用必须记录日志。
应用系统内核心模块间调用必须记录日志。
应用系统各模块自身产生的关键消息必须记录日志。例如：错误事件、异常事件、对业务行为产生关键影响的事件。
系统的启动和关闭事件。
必须记录详细的异常和错误信息内容。当这些信息需要向服务或客户发送时，应精简信息，如只发送错误消息ID内容，但可以将这些消息ID映射到具体事件日志得出详细消息内容。
用户所做的人为干预操作及执行状态。
用户认证信息，包括登录名、登录时间、登录状态、主机和客户端IP地址、访问的协议、端口、访问内容。
用户操作时的用户识别符、登录时间、注销时间、事件发生的日期和时间、事件内容、操作结果等。
变更控制内容。应用系统发生变更时，保留所有与变更相关信息的审核日志。如：记录变更人、时间、原因、对象、内容和前后状况等。确保没有记录密码或其他敏感数据，敏感数据应该脱敏处理。
应用系统日志格式
应用系统日志的文件分两类输出，命名规范：
| 日志类型 | 文件名 | 解释 |
|---|---|---|
| 一般信息日志（DEBUG、INFO） |SystemID.SystemEnName.[SubSysCode].yyyy-mm-dd.nnnn.out.log |SystemID：必选，全公司统一应用系统ID SystemEnName:必选，全公司统一的应用系统英文名称 SubSysCode:可选，子系统或模块代码或名称简称 yyyy-mm-dd:可选，用于区分日志产生的日期，不通日期的日志放到不同的文件中 nnnn：可选，循环日志文件序号。当日志文件内容在一天内超过规定的日志文件大小上限时使用。 out：必选，表明是一般信息日志  || 错误信息日志（WARN、ERROR、FATAL） |SystemID.SystemEnName.[SubSysCode].yyyy-mm-dd.nnnn.err.log |SystemID：必选，全公司统一应用系统ID SystemEnName:必选，全公司统一的应用系统英文名称 SubSysCode:可选，子系统或模块代码或名称简称 yyyy-mm-dd:可选，用于区分日志产生的日期，不通日期的日志放到不同的文件中 nnnn：可选，循环日志文件序号。当日志文件内容在一天内超过规定的日志文件大小上限时使用。 err：必选，表明是错误信息日志 |
应用日志内容采用一个或多个key=”value”形式记录，字段与字段之间采用英文分号“;”分割。
字段内容尽量避免使用等号、分号、英文双引号(”)三个特殊符号。字段值的记录格式遵循以下原则：
| 字段值内容 | 取值方式 | 示例 || 字段值内容 | 取值方式 | 示例 |
|---|---|---|
| 通过英文的双引号，包含value的字符串值 |直接记录 |Message=” 保存数据   异常” |
| 暂不考虑转义字符 | | |
必填字段是指在应用和服务的入口和出口，系统调用点，错误异常点，关键步骤点的日志都需要包含相关必填属性。对非必填字段，可以根据需求自定义，并提供日志字段说明。字段格式如下表所示。
| 序号 | 字段名称 | 解释 | 格式 | 必填 | 示例 |
|---|---|---|---|---|---|
| 1 |eventName |事件名称 |字符串 |Y |eventName=”调用S服务超时” |
| 2 |eventTime |日志产生的时间 |yyyy-MM-dd hh:mm:ss.SSS |Y |eventTime=”2017-09-29 09:08:15.012” || 3 |systemID |生成日志的应用系统ID |公司代码+统一系统ID |Y |systemID =”CITIC001” |
| 4 |hostName |生成日志的主机名 |统一规定的机器名 |N |hostName=”ACC-ECS-01” |
| 5 |IP |生成日志的主机IP |具体的IP |Y |deviceAddress=”192.168.1.20” |
| 6 |logLevel |日志级别 1 = DEBUG 2 = INFO 3 = WARN 4 = ERROR 5 = FATAL |代码 |Y |logLevel=”2” |
| 7 |callType |调用类型 1 = 系统与系统间调用 2 = 本系统模块与模块间调用 3 = 模块自身产生的调用 |代码 |Y |callType=”1”，表示系统与系统间的调用产生的日志。 || 18 |reqAckTag |请求应答事件标志，4种类型 CS=客户端/消费者发起请求 CR=客户端/消费者接收到应答 SR=服务端/生产者接收到请求 SS=服务端/生产者发送应答  |代码 |N |requestAckTag=”CS” 表示客户端/消费者发起请求的事件。 |
| 19 |serviceName |接口服务名称 |字符串 |Y |ServiceName=”类名+方法名等信息的服务名” |
| 20 |reqSystemID |请求系统ID |公司代码+统一系统ID |N |reqSystemID =”CS001” 代码由架构分配 |
| 21 |reqModule |请求模块名称 |字符串 |N |reqModule=”AccoutModule” |
| 22 |ackSystemID |应答系统ID |公司代码+统一系统ID |N |ackSystemID =”CS001” || 23 |ackModule |应答模块名称 |字符串 |N |ackModule=”DB” |
| 24 |optObj |操作对象或动作信息 |字符串 |Y |optObj =”更新用户密码” |
| 25 |optResult |操作结果 0成功 1失败 |代码 |Y |optResult =”0 ” |
| 26 |transCode |业务环节代码，用来唯一标识某一种业务环节，在系统中唯一,有业务意义 |代码 |Y |transCode=”1005” 比如代表记账业务 |
| 27 |transId |业务跟踪号，在一个业务完成过程中，该“业务单号”是全局唯一的，跟踪业务的全生命周期记录。核心交易类系统要求记录 |代码 |N |transId=”2000” |
| 28 |subTransSeq |子业务序号，考虑到业务中组合的情况，通常需要业务单号和子业务序号进行组合子业务的识别 |代码 |N |subTransSeq=”10089” || 29 |traceId  |全局跟踪ID，在全局是唯一的。用它来标记从最初的客户请求开始一次完整服务调用。 |代码 |N |traceId=自动生成序号； 例如可以通过节点ip+序列号生成 |
| 30 |spanId |span的id。span的id只要做到一个traceId下唯一就可以。 |代码 |N |关于span的概念，请参考谷歌相关论文和相关的实现案例。 |
| 31 |parentSpanId |父span的id，反应调用有层级关系。如果一个span没有父ID被称为root span |代码 |N |关于span的概念，请参考谷歌相关论文和相关的实现案例。 |
| 32 |errorCode |错误码，在一个系统中唯一。出错时必填。 |代码 |Y |errorCode=”1000” |
| 33 |errorMessage |错误消息，出错时必填。 |字符串 |Y |errorMessage=”更新**密码失败” || 34 |logMessage |日志详细描述信息 |字符串 |Y |logMessage =”进行了更新**密码操作” |
日志格式模板的分离
特殊系统为追求系统性能，减少日志记录的资源开销，应用系统可以把日志格式提取出来作为单独的格式记录规范模板进行管理，只记录日志的数据内容部分。但日志格式模板应保持相对稳定，并记录日志格式版本历史信息，日志服务器可以根据日志模板进行日志解析。
终端类日志
系统类型
包括PC、笔记本、PAD、手机及各种智能终端设备。这些终端的日志主要有两类。第一类是指终端系统本身产生的系统日志和操作日志，第二类是指驻留在终端的应用程序或系统采集的和用户终端相关的设备识别、用户操作、位置记录等信息。
记录内容要求
第一类终端类日志，可参照记录如下信息：
系统的启动和关闭事件。
用户认证信息。至少包括用户操作时的用户识别符、登录、注销、事件发生的日期和时间、事件内容、操作结果等。终端系统错误和告警、系统安全事件。
终端内服务运行的错误和告警事件。
安全更新程序或补丁包的日期和时间。
参照具体操作系统日志记录通常的配置执行。
第二类终端类日志，可参照记录如下信息：
内网IP、公网IP信息。
有特殊要求的，可以记录MAC地址信息、硬盘序列号、计算机名、CPU序列号、硬盘分区等信息。
移动设备的操作系统和版本信息。
有特殊要求的，可以记录移动终端设备的UUID（IOS）、IMEI （Android）、GUID （Windows Phone）等信息。
地理位置LBS信息。
通过第三方工具采集用户行为、设备识别、终端特征等信息。
日志采集规范
通过建立日志系统，规范日志的采集策略，针对不同日志类型的日志采集方式和采集频度。日志采集按法律合规性、必要性、实用性的原则。
具体采集规范要求如下：
| 日志类型 | 设备类型 | 采集方式 | 采集频度 |
|---|---|---|---||---|---|---|---|
| 服务器类日志 |服务器 |Agent主动采集 |默认5分钟，可配置 |
| 服务器类日志 |服务器 |Syslog/rsyslog被动收集 |实时收集 |
| 网络和安全产品类日志 |交换机、路由器 |Syslog方式被动收集 |实时收集 |