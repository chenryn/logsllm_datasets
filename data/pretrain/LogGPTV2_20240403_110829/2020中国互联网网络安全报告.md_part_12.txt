2.5.6 总结
（1）远程办公人员数量的激增，导致信息技术服务业攻击事件急剧上升
2020年由于新冠肺炎疫情原因，许多企业开始远程办公，导致远程办公人员数
量激增。攻击者瞄准了IT相关的各个部分，企业VPN、视频会议软件、内部通信平
82
02 网络安全专题分析
台等都成为了恶意攻击者所关注的重要目标。攻击者通过注册假域名冒充Zoom、
Microsoft Teams 等远程办公软件的官网传播恶意软件。随着RDP 和VPN 等远程访问
技术使用频率的增加，RDP 爆破攻击的数量急剧上升。
（2）工业互联网或成网络安全下一个焦点
工业互联网包含了工业控制系统、工业网络、大数据存储分析、云计算、商业
系统、客户网络等各种网络基础设施。同时融合了云计算、物联网、大数据、5G通
信、边缘计算等新一代信息通信技术，多元技术融合必然会带来多种隐患。工业互
联网打破了传统工业控制系统相对封闭的生产环境，其暴露面大大增加。
工业互联网与普通通信网的一个关键不同点在于其包含对工业控制、生产运营
有直接影响的OT（Operation Technology，操作技术）网络，其中包含较多敏感核心
数据，涉及企业机密乃至国家安全，这些信息是不能进行公开或共享的。
（3）云原生漏洞成为安全研究员和黑色产业链关注重点
前些年，业界关注的云计算漏洞更多是虚拟化底层软件的逃逸，在各类大赛
中，安全研究员展示了对底层技术缺陷的攻击，一次又一次逃逸了各路虚拟机的束
缚。近年来云计算领域又诞生了一个新的概念，即云原生技术，相关漏洞逐渐成为
安全研究员和黑色产业链关注重点。
云原生技术，目的在于进一步利用云弹性大、敏捷、资源化的优势，解决应用在
持续集成方面的困境，实现高度自动化的开发、集成、发布、运行等全生命周期管
控。作为云原生技术的关键，近年来编排系统kubernetes和容器docker漏洞频出；并且
由于这两者配置问题导致的未授权访问漏洞，成为了黑客攻击和挖矿牟利的突破口。
2.6
2020 年勒索病毒专题分析
2.6.1 勒索病毒感染的数据统计分析
（1）勒索病毒家族分析
2020年，勒索病毒攻击事件频发，传统勒索病毒家族的新变种、新的勒索病
毒家族均大量出现。其中，样本数量排在首位的是Phobos家族（占比21.7%），其
83
2020年中国互联网网络安全报告
次是GlobeImposter家族（占比17.5% ）、Crysis家族（占比12.3%）等。样本数量
TOP10的勒索病毒家族占比情况如图2-56所示。
其他，19.4% Phobos，21.7%
CryptoJoker，1.4%
Hermes837，1.5%
Makop，2.2%
MedusaLocker，3.2%
Buran，5.3%
GlobeImposter，17.5%
Stop，6.0%
Sodinokibi，9.5%
Crysis，12.3%
图2-56 2020年TOP10的勒索病毒家族占比情况（来源：上海观安信息技术股份有限公司）
Phobos勒索病毒家族于2019年年初被发现，此后不断出现病毒变种。早期传播方
式主要为远程桌面登录密码爆破。2020年6月出现新的变种，以系统激活工具等软件
为载体，对用户实施钓鱼，诱导用户下载安装后入侵受害者的终端，窃取用户机器
信息，并进一步通过木马控制端服务器下载加密勒索相关程序，实施比特币勒索。
GlobeImposter勒索病毒家族首次出现于2017年5月，随后出现不同系列的变种，
主要传播方式包括远程桌面登录爆破、垃圾邮件等。
Crysis勒索病毒家族从2016年开始进行传播，主要传播方式为远程桌面登录爆破。
CryptoJoker勒索病毒家族于2020年11月开始在我国传播，出现仅两个月就成为
年度感染占比TOP10的勒索病毒。经分析，该病毒家族通过WannaRen投递渠道“匿
影”僵尸网络进行投递，“匿影”僵尸网络近年来持续活跃，感染设备基数较大，
危害严重。
（2）被感染操作系统分析
2020年，从被感染的操作系统来看，Windows10、Windows7和Windows Server 2008
仍然是被感染占比较多的系统。如图2-57所示，其中Windows10占比34.4%居于首位，
Windows7紧随其后，占比32.2%，第3位的为Windows Server 2008，占比17.6%。
84
02 网络安全专题分析
其他，4.2%
Windows XP，2.1%
Windows Server 2012，9.5%
Windows10，34.4%
Windows Server 2008，17.6%
Windows7，32.2%
图2-57 2020年被感染系统占比情况（来源：上海观安信息技术股份有限公司）
被感染的操作系统以桌面操作系统和服务器操作系统区分，桌面操作系统占比
70.0%，居于首位，明显高于服务器操作系统占比，如图2-58所示。
服务器操作系统，30.0%
桌面操作系统，70.0%
图2-58 被感染操作系统类型占比情况（来源：上海观安信息技术股份有限公司）
（3）通用防范措施建议
从主要勒索病毒家族传播方式来看，安全性较差的远程桌面协议（Remote
Desktop Protocol，RDP）是最常见的攻击媒介。其次为利用垃圾邮件、钓鱼邮件、
水坑网站等方式传播，诱导受害者下载运行勒索病毒。
针对主要以远程桌面登录爆破方式传播的勒索病毒，建议防范措施如下：
● 设备登录口令应为强口令（字母+数字+特殊符号的长组合），定期修改口令；
85
2020年中国互联网网络安全报告
● 不同的设备应使用不同的强口令，避免一个口令重复使用的情况；
● 定期进行数据备份并异地保存;
● 关闭或者修改135～139、445等高危端口，关闭服务器之间的文件共享；
● 定期对资产进行安全自查，及时安装漏洞补丁；
● 对内网的安全域进行合理的划分，域之间做好访问控制列表（Access Control Lists，
ACL）限制，尤其是域管理员的计算机，如果其被攻破，会带来整个局域网沦陷的风险；
● 做好全流量日志的记录和监控，定期检查设备是否存在异常情况；
● 安装安全软件，提高服务器的安全性，以防核心数据被加密，造成重大损失。
针对主要以钓鱼等方式传播的勒索病毒，建议防范措施如下：
● 不要下载网络上不明的档案、文件、图片或影片，谨慎对待陌生邮件、短信
中的链接；
● 从正规渠道下载安装软件；
● 注意规范U盘等移动介质的使用，关闭自动播放功能，使用前先进行查杀；
● 定期进行安全培训，提升网络管理员和普通用户的安全意识。
2.6.2 利用无文件攻击技术的新型勒索病毒分析
2020年，主要勒索病毒家族大量采用无文件攻击技术。利用无文件攻击技术的
新型勒索病毒通常运行在被攻击主机内存中，或通过Windows的WMI、PowerShell
脚本等方式运行，隐蔽性较高，普通的文件反病毒引擎和网络扫描引擎难以对该攻
击技术精准识别。
（1）无文件攻击技术
攻击者在利用这种技术实施攻击时，大多不会在目标主机的磁盘上写入任何恶
意PE或者ELF文件，而是通过各种脚本，例如PowerShell、VBS脚本、PHP脚本等实
施攻击，因此得名“无文件攻击”。
无文件攻击通常使用以下几种特定技术。
①恶意文档
无文件攻击并非真正的没有任何文档，而是通过被植入特定威胁代码的Word文
档、PDF文档等恶意文档进行攻击。
②恶意脚本
无文件攻击为绕开二进制检测方法，不将恶意代码编译执行，而是通过脚本运
行，例如 PowerShell脚本、JavaScript脚本、VBS脚本等，利用本地白名单程序，达
86
02 网络安全专题分析
到绕开防病毒检测的目的。
③病毒执行体代码混淆
无文件攻击依赖脚本执行，并利用各种私有的混淆技术进行改造，使安全运维
人员难以回溯其工作方式。
④无须依赖其他组件
无文件攻击利用本地环境的各种组件，例如WMI、regsvr32.exe等白名单工具，
实现持久化脚本、启动脚本、横向移动攻击等。
（2）Sodinokibi家族勒索无文件攻击技术分析
2019年4月，Sodinokibi勒索病毒在国内首次被发现。该病毒主要使用RDP攻击的
方式进行传播感染，被称为GandCrab勒索病毒的接班人。这款勒索病毒使用了多种传
播渠道进行传播扩散，包含利用各种Web漏洞、Flash漏洞、钓鱼邮件、水坑攻击，漏
洞利用工具包下载执行脚本等无文件攻击方式，其主要的攻击流程如图2-59所示。
植入
浏览获取请求
访问请求
注入执行
加密勒索
图2-59 Sodinokibi勒索病毒主要攻击流程（来源：亚信科技（成都）有限公司）
87
2020年中国互联网网络安全报告
①无文件攻击方式分析
Sodinokibi 勒索病毒多个变种样本显示，其利用恶意网站伪装成游戏辅助工具
欺骗用户下载。当用户点击下载辅助工具的链接后，该病毒通过一系列的无文件攻
击手段，最终直接在内存中运行，从而进行传播和勒索。
该病毒利用了无文件攻击中多个特征的技术：
● 内存执行；
● PowerShell脚本、JavaScript脚本、PHP脚本等执行；
● 多层的脚本间接混淆加密真正的病毒执行体。
②Sodinokibi勒索病毒样本分析
一旦用户浏览了植入该恶意病毒的网站，点击特定的链接，就会触发该病毒执
行。该病毒会通过在磁盘中创建白名单文件或者感染白名单文件的无文件攻击方
式，防止被防病毒软件查杀，然后该病毒即将磁盘中的重要文件加密，加密后的文
件扩展名为.qv05z 。
该病毒试图在内存中执行病毒攻击主体或者执行一个多级高模糊PowerShell脚
本，试图规避各种防病毒软件和安全解决方案，并躲避沙箱。此类无文件攻击技术
为基于签名和行为的安全工具都带来了严峻挑战。
根据进程树关系显示，名为WINWORD.EXE的可执行程序打开了名为
“info_17.07.doc”的文件，然后该文档病毒载体启动了攻击点中的PowerShell脚本,
在另一个名为“VolontariDipendenti-addestramento-congiunto8-12Lugli.doc” 的Word
文档中也发现了相同的被植入脚本的攻击行为。
该勒索病毒启动后，通过白名单工具PowerShell执行Base64编码的命令。这是一
种典型的无文件攻击方式，采用各种混淆技术，混淆病毒代码，只有指定的脚本能
够解密代码执行，给反病毒引擎造成了极大的检测困难。
被解码后勒索病毒脚本命令内容不包含直接造成危害的病毒执行体代码，该样
本采用间接的攻击方式，通过另一个混淆和编码命令，释放一个简单的PowerShell代
码。间接解码阶段完成后，样本释放一个简单的PowerShell代码，如图2-60所示。
88
02 网络安全专题分析
图2-60 Sodinokibi勒索病毒经过两层解混淆后的PowerShell代码
（来源：亚信科技（成都）有限公司）
该段脚本代码试图下载并执行一个名为“KiLrd.exe”的文件，该文件来自恶
意URL：“hxxp://fcamylleibrahim[.]top/sywo/fgoow[.]php?l=dxclass2.gxl”。该勒
索病毒下载的可执行文件被保存到用户目录默认文件夹中，该文件夹用环境变量
“$env:userprofile”表示，即“C:\Users\user\user_name”。“KiLrd.exe”进一步尝
试从另一个URL下载其他代码，即URL：“hxxp://185[.]193[.]141[.]248/gs[.]php”。
Sodinokibi勒索病毒KiLrd下载的PHP文件如图2-61所示。
图2-61 Sodinokibi勒索病毒KiLrd下载的PHP文件（来源：亚信科技（成都）有限公司）
至此，经过复杂的多层间接步骤，该勒索病毒终于将病毒攻击代码放到被感染
主机中，此病毒代码首先检查主机的处理器体系结构，以便启动正确的PowerShell
实例（32位或64位）；然后启动PowerShell进程，该进程调用驻留在其他URL中的
代码：“hxxp://pastebin[.]com/raw/CY2EEMJN”。经过深入分析，该代码是一个
Empire 模块，该模块源代码托管在GitHub项目中。
Empire是一个后端开发框架，包括一个纯PowerShell2.0的Windows agent和一个
纯Python 2.6/2.7的Linux/OS X agent，提供了加密安全通信和灵活的体系结构。通过
上述方式，降低了病毒的外部依赖，甚至无须任何外部依赖，就可以完成整个攻击
89