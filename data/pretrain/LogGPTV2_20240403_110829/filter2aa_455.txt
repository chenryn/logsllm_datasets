业务漏洞挖掘
案例与思考分享
微博安全高级工程师 唐茂凡 
现状
01
01 现状
分类
常 规
  注入、XSS、XXE、CSRF、SSRF、文件包含、命令执行、
URL重定向、点击劫持等
其 他
     网络层漏洞、系统层漏洞、
组件套件中间件漏洞等
业 务
  登录认证、业务办理、业务数据、业务流
程逻辑、业务授权访问、业务接口调用、验
证码、输入\输出、回退、密码找回、密码
重置、实名认证、设置个人信息、绑定银行
卡、红包优惠券、订单CURD、充值、支付、
提现......
01 现状
不同
01
04
02
03
漏洞成因
复杂度
场景流
程变化
多端
通用性
风险点
隐蔽
不 同
01 现状
为什么业务安全越来越受重视？
业务安全
越来越被重视
风险
02
02 风险
怎么做
03
03 怎么做
1 、 缺 乏 成 熟 的 标
准 、 工 具 、 服 务
2 、 信 息 不 对 称
3 、 外 部 力 量 有 限
4 、 各 种 难 ：
难 以 接 触 业 务 环 境
难 以 触 发 业 务 场 景
难 以 理 解 业 务 原 理 和
风 险
. . . . . .
03 怎么做
企业不同时期业务与安全的关系
前期
中期
后期
1、以业务需求为主，注重功能实
现
2、业务方安全意识薄弱
3、基础安全为主，不够重视业务
安全
4、风险未集中暴露，不能有效止
损
5、事前缺乏安全评审与安全测试
6、事中缺乏安全监控与风控运营
7、事后缺乏支持难以溯源
缺乏必要的安全评估与测试
只对主要业务进行渗透测试、代码
审计
被动事后响应
基于漏洞类型的自动化扫描检测，
辅以人工测试（传统类型的漏洞为
主）
1、除功能、性能、稳定性，安全
成为业务的一个属性
2、业务方安全意识提高
3、业务安全基础建设、业务安全
价值体现，安全话语权提高
4、风险集中暴露，事件经验迅速
积累
5、防护监控设备
6、网络层，系统层，组件套件层
漏洞难以利用
7、攻击者目标更多转向业务逻辑
层
切入到业务需求评审、 业务设计
基于业务场景的安全测试，以业务
场景、流程为重心，人工测试主导
+自动化漏洞发现
深入了解业务特点和安全需求，根
据业务系统架构，从前/后视角、
业务视角与支撑系统视角划分测试
对象，结合所有信息获取和评估手
段控制风险。
1、业务安全标准化作业
2、业务安全决策影响
3、业务安全咨询，支持创新业务
发展
4、基于业务安全体系建设，保障
业务持续增长，从止损思维到盈利
思维转化
5、业务安全能力对外输出
03 怎么做
重视业务漏洞+ 较为完善的漏洞发现能力
02
03
04
05
06
01
线上业务被动扫描
SDL阶段黑白盒扫描
安全巡检
               SRC等外部反馈
以业务场景流程为重心，
人工挖掘漏洞
风控运营
03 怎么做
不同的业务场景
业 务 场 景
不 同 行 业 业 务 场 景 有 所 不 同
安 全 评 审
高 风 险 业 务 场 景 识 别
相 同 行 业 ， 业 务 场 景 也 不 是
一 成 不 变
03 怎么做
安全测试人员需要哪些能力
03 怎么做
真正理解业务
01
02
03
04
体会&经验&思考
04
04体会&经验&思考
安全
产品
程序员
“天敌”
01
安全意识
培训
02
03
04
安全开发
红线
安全编码
规范
协助解决
问题
04体会&经验&思考