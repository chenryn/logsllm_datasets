User: How to configure Linux firewall to restrict access to IP and port? Please provide an Iptables-based firewall rule configuration scheme.
Assistant: The following is the firewall rule configuration scheme based on Iptables: 1. Prohibit all incoming and outgoing traffic: ```bash iptables -P INPUT DROP iptables -P FORWARD DROP iptables -P OUTPUT DROP ``` 2. Allow loopback interface traffic: ```bash iptables -A INPUT -i lo -j ACCEPT iptables -A OUTPUT -o lo -j ACCEPT ``` 3. Allow established connections to pass through: ```bash iptables -A INPUT -m state --state ESTABLISHED,RELATED - j ACCEPT iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT ``` 4. Allow SSH access: ```bash iptables -A INPUT -p tcp --dport 22 -m state --state NEW, ESTABLISHED -j ACCEPT iptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT ``` 5. Allow HTTP and HTTPS access: ```bash iptables -A INPUT -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT iptables -A OUTPUT -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT iptables -A INPUT -p tcp --dport 443 -m state -- state NEW,ESTABLISHED -j ACCEPT iptables -A OUTPUT -p tcp --sport 443 -m state --state ESTABLISHED -j ACCEPT ``` 6. Allow specified IP access: ```bash iptables -A INPUT -s 192.168. 1.100 -j ACCEPT iptables -A OUTPUT -d 192.168.1.100 -j ACCEPT ``` 7. Allow the specified port to open: ```bash iptables -A INPUT -p tcp --dport 8080 -j ACCEPT iptables -A OUTPUT -p tcp --sport 8080 -j ACCEPT ``` 8. Other common rules: ```bash #Allow ping iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT iptables -A OUTPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT #Allow DNS requests iptables -A INPUT -p udp --dport 53 -j ACCEPT iptables -A OUTPUT -p udp --sport 53 -j ACCEPT ``` The above is based on The firewall rule configuration scheme of Iptables can be customized according to needs.