    ​    if(str[i]='0')
    ​    {
    ​    end[j]=str[i]-22;
    ​    goto LABEL_a;
    ​    }
    ​    if(str[j]='a')
    ​    {
    ​    end[j]=str[i]-61;
    ​    goto LABEL_a;
    ​    }
    ​     if(str[i]='A')
    ​     {
    ​    end[j]=str[i]-65;
    ​    }
    LABEL_a:
    ;
     }
     for(i=0;i=0)
    ​     {
    ​         str[i]=v10[i]+ 65;
    ​         goto LABEL_bb;
    ​     }
    ​     if(v10[i] =26)
    ​     {
    ​         str[i]=v10[i]+ 22;
    ​         goto LABEL_bb;
    ​     }
    ​     if(v10[i] =36)
    ​     {
    ​         str[i]=v10[i]+ 61;
    ​     }
    LABEL_bb:
    ;
      }
      char sigeliu[5]={0x36,0x36,0x36,0x36,0};
      strcat(str,sigeliu);
    }
总之最后累的跟骆驼似的终于还是凑出了这个半成品的注册机。如图24：
图24
该注册机的用法是在00403D5B处，看堆栈得到f1(申请号)= BqwITTcm8kG5lcEk.
把这个值写入密文框内，点击解密就得到其注册码。这时看了看表大概用了110分钟，好险，差点损失15块钱。
### 0×0e discuz!提示问题也是浮云，碰撞V5
字典生成器破解完后，我开始酝酿写这个discuz! 提示问题的碰撞程序。由于php的易用性，我选择用它来写。说白了也就是个穷举的过程。代码如下：
我使用自己保存的100M大字典破解没有成功。后来我把这个脚本放在了一朋友的服务器上，然后用superdic生成了3G的大字典，直接丢在服务器上碰撞吧。
其实我坚信，在8位的字母加数字的大字典中去做碰撞的话肯定会成功的。只是我没有那么大的硬盘，只做了6位字母来测试。
又经过一天后，等我登陆朋友的服务器3389之时，我发现得到了结果如图25：
图25
我敢肯定，ufedys肯定不是这个管理员的答案。于是hash相同，明文却不相同的碰撞终于成功了。我默默在心里说了声：碰撞V5。
剩下的应该比较容易了，登入后台，上传一个带php一句话木马的美女图片。（不要告诉我，你在discuz!
X2后台找不到上传的地方啊）。然后利用类似这样的url：
连接菜刀，就这样彻底拿下了该目标。
既然Webshell都拿到了，删帖子这么简单的事情还用我继续说吗？
### 0×0f 后记
到这里，费时两周的渗透也算是结束了，实战过程中其实还遇到了更多的各种各样问题，只不过本文是后来补写的，很多细节都忘却了，但主要的东西都已经在文章中体现了。
最后我还是想提一提国内的安全现状，不出事不代表你们没有被入侵过，在我工作过的这几年，做了不少安全检测，每次渗透测试拿到shell之时，大都发现有黑客进来的痕迹，这些还都是不知道打扫日志的菜鸟呢。安全圈内流传一句话，只要有毅力没有日不下来的站，我深信之。以我这种菜鸟的水平，在别人给我目标时我都可以保证50%的成功率，还用说国内归隐的各种日站大牛吗？
所以最后要敬告国内的某些大公司，请善待网络安全人才。另外在2012新的一年里祝愿冰点极限的2yue、kindle、小龙猪、老马（Marcos）、lcx、np、孤水绕城、Beach、顺、安静、alex、紫夜、cnbug等好友们婚姻与事业双丰收。