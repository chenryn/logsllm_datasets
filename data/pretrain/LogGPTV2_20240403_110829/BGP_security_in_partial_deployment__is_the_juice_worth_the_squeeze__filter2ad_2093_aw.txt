it will select the direct route to d and never choose a dif-
ferent route thereafter (as this is its most preferred route).
Now, let us assume that for every AS chosen in iterations
1, . . . , r the statement of the lemma holds. Let vi be the
AS chosen at iteration r + 1 of FCR. Consider vi’s BPR set
at that time. By deﬁnition, every route in the BPR set is
perceivable and so must comply with Ex at each and every
“hop” along the route. Notice, that this, combined with the
fact that all routes in vi’s BPR set are customer routes, im-
plies that the suﬃx of every such route is also a perceivable
customer route. Consider an AS vj that is vi’s next-hop on
some route in vi’s BPR set. Notice that vj’s route is ﬁxed at
some iteration in {1, . . . , r} (as vj has a shorter perceivable
customer route than vi). Hence, by the induction hypoth-
esis, at some point in the S*BGP convergence process, vj’s
route converges to Rvj for every such AS vj. Observe that,
from that point in time onward, vi’s best available routes are
precisely those capture by BPR in the r + 1’th iteration of
FCR. Hence, from that moment onwards vi will repeatedly
select the route Rvi according to the tiebreak step TB and
never select a diﬀerent route thereafter.
Lemma B.3. Under S*BGP routing, the route of every
AS added to I in FPeeR is guaranteed to stabilize to the
route Rvi .
Proof. Consider an AS vi chosen at some iteration of
FPeeR. Observe if (vi, vi−1, . . . , d) is a perceivable peer route
then (vi−1, . . . , d) must be a perceivable customer route (to
satisfy the Ex condition). Hence, for every such route in vi’s
BPR set it must be the case that the route of vi’s next-hop on
this route vj was ﬁxed in FCR. By Lemma B.2, at some point
in the S*BGP convergence process, vj’s route converges to
Rvj for every such AS vj. Observe that, from that point in
time onward, vi’s best available routes are precisely those
capture by its BPR set at the iteration of FPeeR in which
vi is chosen. Hence, vi will select the route Rvi according
to the tiebreak step TB and never select a diﬀerent route
thereafter.
Lemma B.4. Under S*BGP routing, the route of every
AS added to I in FPrvR is guaranteed to stabilize to the
route Rvi .
Proof. We prove the lemma by induction on the number
of FPrvR iterations. Consider the ﬁrst iteration. Let vi be
the AS chosen at this iteration, let vj be a next-hop of vi on
some route R in vi’s BPR set, and let Q be the suﬃx of R
at vj. Observe that Q cannot possibly be a provider route,
for otherwise vj would have been chosen in FPrvR before
vi. Hence, Q must be either a customer route or a peer
route, and so vj’s route must have been ﬁxed in either FCR
or FPeeR. Hence, by the previous lemmas, under S*BGP
convergence, every such vj’s route will eventually converge
to Rvj . Observe that once all such ASes’ routes have con-
verged and onwards vi’s best available routes are precisely
those captured by BPR in the r + 1’th iteration of FPrvR.
Hence, vi will select the route Rvi according to the tiebreak
step TB and never select a diﬀerent route thereafter.
Now, let us assume that for every AS chosen in iterations
1, ..., r the statement of the lemma holds. Let vi be the AS
chosen at iteration r + 1 of FPrvR and consider vi’s BPR
set at this time. Let vj again be a next-hop of of vi on
some route R in vi’s BPR set, and let Q be the suﬃx of R
at vj. Observe that if Q is a provider route then vj’s route
must have been ﬁxed in FPrvR at some point in iterations
{1, . . . , r}.
If, however, Q is either a customer route or a
peer route vj’s route must have been ﬁxed in either FCR or
FPeeR. Hence, by the previous lemmas and the induction
hypothesis, under S*BGP convergence, every such vj’s route
will eventually converge to Rvj . From that moment onwards
vi’s best available routes are precisely those captured by
BPR in the r + 1’th iteration of FprvR. Hence, vi will select
the route Rvi according to the tiebreak step TB and never
select a diﬀerent route thereafter.
B.5.2 Correctness of algorithm for security 2nd.
The proof that our algorithm for the security 2nd model
outputs the S*BGP routing outcome in this model follows
from the combination of the lemmas below. Let Rvi be the
route from vi induced by the algorithm’s computed next-
hops.
Lemma B.5. Under S*BGP routing, the route of every
AS added to I in FSCR is guaranteed to stabilize to the
route Rvi .
Proof. The proof is essentially the proof of Lemma B.2
(where now all routes must be secure).
Lemma B.6. Under S*BGP routing, the route of every
AS added to I in FCR is guaranteed to stabilize to the route