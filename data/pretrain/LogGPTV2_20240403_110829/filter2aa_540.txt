Attacking .NET 
Applications at 
Runtime
Jon McCoy - 2010
www.DigitalBodyGuard.com
What will this presentation cover?
How to pWN closed-source .NET 
applications in new and dynamic ways
New tools I am releasing 
Show how incredibly vulnerable .NET 
applications are
What tools will you get?
New Metasploit payload
Tools to do reconnaissance, on the 
structure of .NET programs
Beta - Decompilation Tool targeted at .
NET Applications protected by 
wrappers/shells
What will the hack do?
Gain access to a target application
Compromise the GUI 
Subvert core logic
Instantiate new features
Access the Object structure
Connect to the Target
Inject - Put your code into the target
Infect - Change the target's code
Exploit - Take advantage of a flaw
Attack The Framework - Compromise the 
framework
How the hack works: Overview
1. Connect to the target application
-Connect With Injection 
2. Access targets Object structure 
-Move around with Reflection
3. Modify values and/or Objects
-Modify Objects with Reflection
Normal Runtime Object Structure
GUI
Hacked Object Runtime Structure
GUI
Sample Code: Hack Event
Reflection
DEMO
GUI_Spike
LEET a Program
VIDEO OF DEMO HACKS
NOT LIVE DUE TO TIME
APPLICATION
Live demo 
Data Piggyback
SQL
FIN < NULL
Special Thanks To
Related Works of
James Devlin
www.codingthewheel.com
Sorin Serban
www.sorin.serbans.net/blog
Erez Metula 
paper: .NET reverse engineering 
& .NET Framework Rootkits 
Thanks to assistance of
Lynn Ackler
Thank you for the mentorship and training in forensics.
Daniel DeFreez
Thank you for the help on research and vulnerability analysis
(also the metasploit module) :-)
Andrew Krug
Thank you for the advanced IT support & shinyness.
Adam REDACTED 
Thanks you for the IT Support; specifically hardware.
License
DotNetSpike and This Presentation are Licensed Under 
GNU General Public License - Ver. 3, 29 June 2007
This is an open source presentation presented at Defcon 18
with Tools released at Blackhat 2010
More information at:
http://www.DigitalbodyGuard.com
How is an attack done
Connect to an Object
Move Objects
Change Objects
                                    Hack Events to change logic
            Wrap an Object to replace logic