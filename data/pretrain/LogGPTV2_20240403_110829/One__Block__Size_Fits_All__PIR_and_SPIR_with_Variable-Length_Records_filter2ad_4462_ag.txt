privacy-friendly sales of e-books, music, movies, or smart
phone and tablet apps.
Acknowledgements.. We thank the anonymous reviewers
for their thoughtful and constructive comments. Funding
for this research was provided in part by NSERC, Mprime
NCE (formerly MITACS) and the Ontario Research Fund.
The ﬁrst author is supported by an NSERC Vanier Canada
Graduate Scholarship and a Cheriton Graduate Scholar-
ship.
References
[1] M. H. Au, W. Susilo, and Y. Mu, “Constant-Size Dynamic k-TAA,”
in Proceedings of SCN 2006, ser. LNCS, vol. 4116, Maiori, Italy,
Sept 2006, pp. 111–125.
[2] A. Beimel, Y. Ishai, and T. Malkin, “Reducing the Servers’ Com-
putation in Private Information Retrieval: PIR with Preprocessing,”
Journal of Cryptology, vol. 17, no. 2, pp. 125–151, Mar 2004.
[3] A. Beimel and Y. Stahl, “Robust Information-Theoretic Private
Information Retrieval,” Journal of Cryptology, vol. 20, no. 3, pp.
295–321, Jul 2007.
[4] M. Bellare, J. A. Garay, and T. Rabin, “Fast Batch Veriﬁcation for
Modular Exponentiation and Digital Signatures,” in Proceedings
of EUROCRYPT 1998, ser. LNCS, vol. 1403, Espoo, Finland, Jun
1998, pp. 236–250.
[5] G. R. Blakley and C. Meadows, “Security of Ramp Schemes,” in
Proceedings of CRYPTO 1984, ser. LNCS, vol. 196, Santa Barbara,
California, Aug 1984, pp. 242–268.
[6] D. Boneh and X. Boyen, “Short Signatures Without Random
Oracles,” in Proceedings of EUROCRYPT 2004, ser. LNCS, vol.
3027, Interlaken, Switzerland, May 2004, pp. 56–73.
[7] D. Boneh, X. Boyen, and E.-J. Goh, “Hierarchical Identity Based
Encryption with Constant Size Ciphertext,” in Proceedings of EU-
ROCRYPT 2005, ser. LNCS, vol. 3494, Aarhus, Denmark, May
2005, pp. 440–456.
[8] G. Brassard, C. Crépeau, and J.-M. Robert, “All-or-Nothing Dis-
closure of Secrets,” in Proceedings of CRYPTO 1986, ser. LNCS,
vol. 263, Santa Barbara, California, Aug 1986.
[9] J. Camenisch, M. Dubovitskaya, and G. Neven, “Oblivious Transfer
with Access Control,” in Proceedings of ACM CCS 2009, Chicago,
Illinois, Nov 2009, pp. 131–140.
[10] ——, “Unlinkable Priced Oblivious Transfer with Rechargeable
Wallets,” in Proceedings of FC 2010, ser. LNCS, vol. 6052, Tener-
ife, Canary Islands, Jan 2010, pp. 66–81.
[11] J. Camenisch, M. Dubovitskaya, G. Neven, and G. M. Zaverucha,
“Oblivious Transfer with Hidden Access Control Policies,” in
Proceedings of PKC 2011, ser. LNCS, vol. 6571, Taormina, Italy,
Mar 2011, pp. 192–209.
[12] J. Camenisch, G. Neven, and abhi shelat, “Simulatable Adaptive
Oblivious Transfer,” in Proceedings of EUROCRYPT 2007, ser.
LNCS, vol. 4515, Barcelona, Spain, May 2007, pp. 573–590.
[13] D. Chaum, R. Carback, J. Clark, A. Essex, S. Popoveniuc, R. L.
Rivest, P. Y. A. Ryan, E. Shen, A. T. Sherman, and P. L. Vora,
“Scantegrity II: End-to-End Veriﬁability by Voters of Optical Scan
Elections Through Conﬁrmation Codes,” IEEE Transactions on
Information Forensics and Security, vol. 4, no. 4, pp. 611–627, Dec
2009.
[14] D. Chaum and E. van Heyst, “Group Signatures,” in Proceedings of
EUROCRYPT 1991, ser. LNCS, vol. 547, Brighton, UK, Apr 1991,
pp. 257–265.
[15] B. Chor, N. Gilboa, and M. Naor, “Private Information Retrieval by
Keywords,” Technion, Israel, Technical report TR CS0917, 1997.
[16] B. Chor, E. Kushilevitz, O. Goldreich, and M. Sudan, “Private
Information Retrieval,” Journal of the ACM, vol. 45, no. 6, pp.
965–981, Nov 1998.
[17] H. Cohn and N. Heninger, “Approximate Common Divisors via
Lattices,” in Proceedings of the 10th Algorithmic Number Theory
Symposium — ANTS X, July 2012.
[18] R. Cramer, I. Damgård, and B. Schoenmakers, “Proofs of Partial
Knowledge and Simpliﬁed Design of Witness Hiding Protocols,” in
Proceedings of CRYPTO 1994, ser. LNCS, vol. 839, Santa Barbara,
California, Aug 1994, pp. 174–187.
[19] G. Danezis, R. Dingledine, and N. Mathewson, “Mixminion: Design
of a Type III Anonymous Remailer Protocol,” in Proceedings of
IEEE S&P 2003, Oakland, California, May 2003, pp. 2–15.
[20] C. Devet, I. Goldberg, and N. Heninger, “Optimally Robust Private
Information Retrieval,” in Proceedings of USENIX Security 2012,
Bellevue, Washington, Aug 2012.
[21] R. Dingledine, N. Mathewson, and P. F. Syverson, “Tor: The
Second-Generation Onion Router,” in Proceedings of USENIX
Security 2004, San Diego, California, Aug 2004, pp. 303–320.
[22] A. Fiat and A. Shamir, “How to Prove Yourself: Practical Solu-
tions to Identiﬁcation and Signature Problems,” in Proceedings of
CRYPTO 1986, ser. LNCS, vol. 263, Santa Barbara, California, Aug
1986, pp. 186–194.
[23] Y. Gertner, S. Goldwasser, and T. Malkin, “A Random Server Model
for Private Information Retrieval or How to Achieve Information
Theoretic PIR Avoiding Database Replication,” in Proceedings of
RANDOM 1998, Barcelona, Spain, Oct 1998, pp. 200–217.
[24] Y. Gertner, Y. Ishai, E. Kushilevitz, and T. Malkin, “Protecting Data
Privacy in Private Information Retrieval Schemes,” in Proceedings
of STOC 1998, Dallas, Texas, May 1998, pp. 151–160.
[25] I. Goldberg, “Improving the Robustness of Private Information
Retrieval,” in Proceedings of IEEE S&P 2007, Oakland, California,
May 2007, pp. 131–148.
[26] V. Guruswami and M. Sudan, “Improved Decoding of Reed-
Solomon and Algebraic-Geometry Codes,” IEEE Transactions on
Information Theory, vol. 45, no. 6, pp. 1757–1767, Sept 1999.
[27] R. Henry and I. Goldberg, “Batch Proofs of Partial Knowledge,”
University of Waterloo, Technical report CACR 2012-04, 2012.
[28] R. Henry, F. Olumoﬁn, and I. Goldberg, “Practical PIR for Elec-
tronic Commerce,” in ACM CCS 2011, Chicago, Illinois, Oct 2011,
pp. 677–690.
[29] A. Kate, G. M. Zaverucha, and I. Goldberg, “Constant-Size Com-
mitments to Polynomials and Their Applications,” in Proceedings
of ASIACRYPT 2010, ser. LNCS, vol. 6477, Singapore, Dec 2010,
pp. 177–194.
[30] E. Kushilevitz and R. Ostrovsky, “Replication is Not Needed:
Single Database Computationally-Private Information Retrieval,” in
Proceedings of FOCS 1997, Miami Beach, Florida, Oct 1997, pp.
364–373.
[31] C. A. Melchor and P. Gaborit, “A Lattice-Based Computationally-
Efﬁcient Private Information Retrieval Protocol,” in Proceedings of
WEWORC 2007, Bochum, Germany, Jul 2007.
[32] M. Naor and B. Pinkas, “Oblivious Transfer and Polynomial Evalu-
ation,” in Proceedings of STOC 1999, Atlanta, Georgia, May 1999,
pp. 245–254.
[33] F. G. Olumoﬁn and I. Goldberg, “Privacy-Preserving Queries over
Relational Databases,” in Privacy Enhancing Technologies, ser.
LNCS, vol. 6205, Berlin, Germany, Jul 2010, pp. 75–92.
[34] ——, “Revisiting the Computational Practicality of Private Informa-
tion Retrieval,” in Proceedings of FC 2011, ser. LNCS, vol. 7035,
Gros Islet, St. Lucia, Feb 2011, pp. 158–172.
[35] P. Y. A. Ryan and S. A. Schneider, “Prêt à Voter with Re-encryption
Mixes,” in Proceedings of ESORICS 2006, ser. LNCS, vol. 4189,
Hamburg, Germany, Sept 2006, pp. 313–326.
[36] A. Shamir, “How to Share a Secret,” Communications of the ACM,
vol. 22, no. 11, pp. 612–613, Nov 1979.
[37] R. Sion and B. Carbunar, “On the Practicality of Private Information
Retrieval,” in Proceedings of NDSS 2007, San Diego, California,
Mar 2007.
[38] S. Yekhanin, “New Locally Decodable Codes and Private Informa-
tion Retrieval Schemes,” Electronic Colloquium on Computational
Complexity (ECCC), vol. 13, no. 127, Oct 2006.
Appendix: ZKP from Protocol 4
Let (cid:126)f = (cid:104) f1, . . . , fr(cid:105) be a vector of degree (at most) T =
t + q polynomials in F[x], let PK be public parameters for
degree-T polynomial commitments, let (cid:126)C = (cid:104)C1, . . . ,Cr(cid:105) be
a componentwise vector of polynomial commitments to the
components of (cid:126)f , and let A ⊆ Fq×r be a set of “allowable”
q-by-r matrices over F; in the SPIR setting, each matrix in
A will describe the layout of one of the records the user
may retrieve. The tuple (t,q, (cid:126)C,A, PK) is common input to
both the prover (P) and the veriﬁer (V), but only P knows
(cid:126)f . The following protocol allows P to convince V that
(1)
 f1(1) ···
...
f1(q)
...
···
fr(1)
...
fr(q)
 ∈ A;
M =
i.e., that there exists an allowable matrix A such that, for
all i ∈ [1, . . . ,q], (cid:126)f evaluates componentwise to the ith row
of A on input x = i.
V: Choose (cid:126)a ∈R
P: Choose γ ∈R Z∗
the polynomial F(x) = γ(cid:0)(cid:126)f ·(cid:126)a(cid:1). Compute h(cid:48) = hγ and
(cid:2)0,n− 1(cid:3)1×r and send it to P.
|F| and a generator h ∈R F, then compute
the (polynomial commitment) witnesses ω1, . . . ,ωq to
the evaluations of F(x) at x = 1, . . . ,q, and send the
tuple (h,h(cid:48),ω1, . . . ,ωq) to V.
(cid:2)0,n− 1(cid:3)q×1 and send it to P.
V: Choose (cid:126)c ∈R
P and V: Compute the q-by-r challenge matrix B =(cid:126)c⊗(cid:126)a,
then construct the set of scalars B = {Tr(BAT) | A ∈ A}.
P: Compute and send the commitment C(cid:48) = g∑q
j=1 c j F(α) to
j=1 ωc j
j=1 c j, Ω = ∏q
, and Y = e(C(cid:48) · J, g)/e(Ω, gα).
V: Compute C = (cid:0)∏r
P and V: Compute gT = e(g, g) and engage in the follow-
ing zero-knowledge proof of knowledge to show that
loggT Y ∈ γ B:
PK
(cid:110)(cid:0)γ(cid:1) : C(cid:48) = C γ ∧ h(cid:48) = hγ ∧(cid:0)(cid:87)
B∈B loggT Y = γ B(cid:1)(cid:111)
j=1 ω j c j
(cid:1)∑q
j , J =
i=1Cai
i
∏q
V.
.
j
(cid:3) ≤
This latter proof can be efﬁciently implemented using
Henry and Goldberg’s batch proofs of partial knowl-
edge [27].
(cid:2)0,n − 1(cid:3)r, Pr(cid:2)∃i ∈ [1,m], (cid:126)a·(cid:126)v0 = (cid:126)a·(cid:126)vi
We will show that Pr(cid:2)(cid:126)a·(cid:126)v(cid:48)
Lemma 1: Fix a list (cid:126)v0,(cid:126)v1, . . . ,(cid:126)vm of distinct vectors in Fr.
Then for (cid:126)a ∈R
m/n, where the probability is taken over the random choices
of (cid:126)a.
Proof: Consider
(cid:126)v(cid:48)
1, . . . ,(cid:126)v(cid:48)
statement to be proved then follows from the union bound.
i. Fix an in-
dex j(cid:48) ∈ [1,m] such that vi j(cid:48)
(cid:54) = 0 and deﬁne the sum
Vi j(cid:48) = ∑ j∈[1,m]− j(cid:48) a j vi j. Now, (cid:126)a ·(cid:126)v(cid:48)
to
a j(cid:48) vi j(cid:48) = −Vi j(cid:48); hence, a j(cid:48) = −Vi j(cid:48)/vi j(cid:48). Note that the right-
the list of distinct nonzero vectors
i = (cid:126)vi −(cid:126)v0 for i ∈ [1,m].
(cid:2)0,n− 1(cid:3)r(cid:3) ≤ 1/n; the
Let vi j denote the jth component of (cid:126)v(cid:48)
m obtained by setting (cid:126)v(cid:48)
i = 0 is equivalent
i = 0 | (cid:126)a ∈R
hand side of this equation is independent from a j(cid:48); hence,
because each of the possible values for a j(cid:48) occurs with
equal probability, this happens with probability at most
1/n.
Corollary 2: Fix a matrix M ∈ Fq×r and set of matrices
A ⊆ Fq×r. For randomly chosen vectors (cid:126)a ∈R
and (cid:126)c ∈R
and the set of traces B = {Tr(BAT) | A ∈ A}. Then
(cid:2)0,n− 1(cid:3)1×r
(cid:2)0,n− 1(cid:3)q×1, deﬁne the matrix B = (cid:126)c⊗(cid:126)a ∈ Fq×r
Pr(cid:2)Tr(BMT) ∈ B | M ∈ A(cid:3) = 1, and
Pr(cid:2)Tr(BMT) ∈ B | M (cid:54)∈ A(cid:3) ≤ 2|A|/n,
(2)
(3)
where both probabilities are over the random choices of (cid:126)a
and (cid:126)c.
Proof: Equation (2) is immediate from the deﬁnition of B.
To prove Equation (3), observe that for any A ∈ A∪{M}
we can rewrite Tr(B · AT) = Tr((cid:126)c ·(cid:126)a · AT) = Tr((cid:126)a · AT ·(cid:126)c) =
(cid:126)a· (AT ·(cid:126)c), which is a dot product of two length-r vectors.
We use Lemma 1 to prove
(cid:104)∃A ∈ A, MT ·(cid:126)c = AT ·(cid:126)c
(cid:105) ≤ |A|/n
Pr
(cid:2)0,n− 1(cid:3)q×1; the result then follows from another
(4)
for (cid:126)c ∈R
application of Lemma 1.
Consider a ﬁxed matrix A ∈ A and index j such that
the jth columns of A and M differ in at least one row. It
then follows from Lemma 1 that the jth components of the
vectors AT ·(cid:126)c and MT ·(cid:126)c are different with probability at
least 1/n. Equation (4) then follows from the union bound.
Theorem 3: The above protocol
is a zero-knowledge
proof that Equation (1) holds; i.e., the protocol is com-
plete, sound (with overwhelming probability in lgn), and
simulatable.
Proof: To prove completeness, suppose Equation (1) holds
j=1 c j F( j) ∈ γB. If ω1, . . . ,ωq are
so that γ Tr(BMT) = ∑q
correct witnesses for evaluations of F(x) at x = 1, . . . ,q,
e(ω j, gα /g j)e(g, g)F( j) for j ∈ [1,q]. Thus, since e(C(cid:48), g) =
∏q
∏q
then it is straightforward to verify that e(cid:0)(∏r
j=1 e(cid:0)(∏r
i )γ , g(cid:1)c j and
(cid:0)e(ω j, gα /g j) · e(g, g)F( j)(cid:1)c j
(cid:0)e(ω j, gα)/e(ω j, g j)(cid:1)c j · e(g, g)∑q
(cid:0)e(ω j, gα)/e(ω j
j , g)(cid:1)c j · e(g, g)γ Tr(BMT)
=(cid:0)e(Ω, gα)/e(J, g)(cid:1) · e(g, g)γ Tr(BMT),
i )γ , g(cid:1) =
= ∏q
= ∏q
i=1Cai
i=1Cai
j=1 c j F( j)
j=1
j=1
j=1
= e(C(cid:48) · J, g)/e(Ω, gα); hence,
it follows that gγ Tr(BMT)
completeness follows from the completeness of the ZKP
in the ﬁnal step.
T
Soundness follows from Corollary 2 and the soundness
of the zero-knowledge proof of knowledge in the ﬁnal step.
Given a simulator S for the ZKPoK in the ﬁnal step,
constructing a simulator S(cid:48) for the entire protocol is trivial;
i.e., S(cid:48) chooses C(cid:48),h(cid:48),ω1, . . . ,ωq at random, then invokes
S on these (and the common) inputs.