# 异步编程世界里的错误处理在异步编程的世界里，因为被调用的函数是被放到了另外一个线程里运行，这将导致：-   **无法使用返回码**。因为函数在"被"异步运行中，所谓的返回只是把处理权交给下一条指令，而不是把函数运行完的结果返回。**所以，函数返回的语义完全变了，返回码也没有用了**。-   **无法使用抛异常的方式**。因为除了上述的函数立马返回的原因之外，抛出的异常也在另外一个线程中，不同线程中的栈是完全不一样的，所以主线程的    `catch` 完全看不到另外一个线程中的异常。对此，在异步编程的世界里，我们也会有好几种处理错误的方法，最常用的就是`callback` 方式。在做异步请求的时候，注册几个 `OnSuccess()`、`OnFailure()` 这样的函数，让在另一个线程中运行的异步代码来回调过来。``{=html}
## JavaScript 异步编程的错误处理比如，下面这个 JavaScript 示例：    function successCallback(result) {  console.log("It succeeded with " + result);} function failureCallback(error) {  console.log("It failed with " + error);} doSomething(successCallback, failureCallback);通过注册错误处理的回调函数，让异步执行的函数在出错的时候，调用被注册进来的错误处理函数，这样的方式比较好地解决了程序的错误处理。**而出错的语义从返回码、异常捕捉到了直接耦合错误出处函数的样子**，挺好的。但是，如果我们需要把几个异步函数顺序执行的话（异步程序中，程序执行的顺序是不可预测的、也是不确定的，而有时候，函数被调用的上下文是有相互依赖的，所以，我们希望它们能按一定的顺序处理），就会出现了所谓的Callback Hell 的问题。如下所示：    doSomething(function(result) {  doSomethingElse(result, function(newResult) {    doThirdThing(newResult, function(finalResult) {      console.log('Got the final result: ' + finalResult);    }, failureCallback);  }, failureCallback);}, failureCallback);而这样层层嵌套中需要注册的错误处理函数也有可能是完全不一样的，而且会导致代码非常混乱，难以阅读和维护。所以，一般来说，在异步编程的实践里，我们会用 Promise模式来处理。如下所示（箭头表达式）：    doSomething().then(result => doSomethingElse(result)).then(newResult => doThirdThing(newResult)).then(finalResult => {  console.log(`Got the final result: ${finalResult}`);}).catch(failureCallback);上面代码中的 `then()` 和 `catch()` 方法就是 Promise对象的方法，`then()`方法可以把各个异步的函数给串联起来，而`catch()`方法则是出错的处理。看到上面的那个级联式的调用方式，这就要我们的 `doSomething()` 函数返回Promise 对象，下面是这个函数的相关代码示例：比如：    function doSomething() {let promise = new Promise();let xhr = new XMLHttpRequest();xhr.open('GET', 'http://coolshell.cn/....', true); xhr.onload = function (e) {        if (this.status === 200) {            results = JSON.parse(this.responseText);            promise.resolve(results); // 成功时，调用 resolve() 方法        }    };     xhr.onerror = function (e) {        promise.reject(e); // 失败时，调用 reject() 方法    };     xhr.send();    return promise;}从上面的代码示例中，我们可以看到，如果成功了，要调用\`Promise.resolve()` 方法，这样 Promise 对象会继续调用下一个`then()`。如果出错了就调用 `Promise.reject()` 方法，这样就会忽略后面的`then()` 直到 `catch()` 方法。我们可以看到 `Promise.reject()`就像是抛异常一样。这个编程模式让我们的代码组织方便了很多。另外，多说一句，Promise还可以同时等待两个不同的异步方法。比如下面的代码所展示的方式：    promise1 = doSomething();promise2 = doSomethingElse();Promise.when(promise1, promise2).then( function (result1, result2) {... // 处理 result1 和 result2 的代码}, handleError);在 ECMAScript 2017的标准中，我们可以使用`async`/`await`这两个关键字来取代 Promise对象，这样可以让我们的代码更易读。比如下面的代码示例：    async function foo() {  try {    let result = await doSomething();    let newResult = await doSomethingElse(result);    let finalResult = await doThirdThing(newResult);    console.log(`Got the final result: ${finalResult}`);  } catch(error) {    failureCallback(error);  }}如果在函数定义之前使用了 `async` 关键字，就可以在函数内使用 `await`。当在 `await` 某个 `Promise` 时，函数暂停执行，直至该 `Promise`产生结果，并且暂停不会阻塞主线程。 如果 `Promise` resolve，则会返回值。如果 `Promise` reject，则会抛出拒绝的值。而我们的异步代码完全可以放在一个 `try - catch`语句块内，在有语言支持了以后，我们又可以使用 `try - catch` 语句块了。下面我们来看一下 pipeline 的代码。所谓 pipeline就是把一串函数给编排起来，从而形成更为强大的功能。这个玩法是函数式编程中经常用到的方法。比如，下面这个 pipeline 的代码（注意，其上使用了 `reduce()` 函数）：    [func1, func2].reduce((p, f) => p.then(f), Promise.resolve());其等同于：    Promise.resolve().then(func1).then(func2);我们可以抽象成：    let applyAsync = (acc,val) => acc.then(val);let composeAsync = (...funcs) => x => funcs.reduce(applyAsync, Promise.resolve(x));于是，可以这样使用：    let transformData = composeAsync(func1, asyncFunc1, asyncFunc2, func2);transformData(data);但是，在 ECMAScript 2017 的 `async`/`await`语法糖下，这事儿就变得更简单了。    for (let f of [func1, func2]) {  await f();}
## Java 异步编程的 Promise 模式在 Java 中，在 JDK 1.8 里也引入了类似 JavaScript 的玩法 ------`CompletableFuture`。这个类提供了大量的异步编程中 Promise的各种方式。下面我列举几个。链式处理：    CompletableFuture.supplyAsync(this::findReceiver)                 .thenApply(this::sendMsg)                 .thenAccept(this::notify);上面的这个链式处理和 JavaScript 中的`then()`方法很像，其中的\`supplyAsync()` 表示执行一个异步方法，而 `thenApply()`表示执行成功后再串联另外一个异步方法，最后是 `thenAccept()`来处理最终结果。下面这个例子是要合并两个异步函数的结果：    String result = CompletableFuture.supplyAsync(() -> {         return "hello";     }).thenCombine(CompletableFuture.supplyAsync(() -> {         return "world";     }), (s1, s2) -> s1 + " " + s2).join());System.out.println(result); 接下来，我们再来看一下，Java 这个类相关的异常处理：    CompletableFuture.supplyAsync(Integer::parseInt) // 输入: "ILLEGAL"     .thenApply(r -> r * 2 * Math.PI)     .thenApply(s -> "apply>> " + s)     .exceptionally(ex -> "Error: " + ex.getMessage());我们要注意到上面代码里的 `exceptionally()` 方法，这个和 JavaScriptPromise 中的 `catch()` 方法相似。运行上面的代码，会出现如下输出：    Error: java.lang.NumberFormatException: For input string: "ILLEGAL"也可以这样：    CompletableFuture.supplyAsync(Integer::parseInt) // 输入: "ILLEGAL" .thenApply(r -> r * 2 * Math.PI) .thenApply(s -> "apply>> " + s) .handle((result, ex) -> { if (result != null) { return result; } else { return "Error handling: " + ex.getMessage(); } });上面代码中，你可以看到，其使用了 `handle()`方法来处理最终的结果，其中包含了异步函数中的错误处理。
## Go 语言的 Promise在 Go 语言中，如果你想实现一个简单的 Promise模式，也是可以的。下面的代码纯属示例，只为说明问题。如果你想要更好的代码，可以上GitHub 上搜一下 Go 语言 Promise 的相关代码库。首先，先声明一个结构体。其中有三个成员：第一个 `wg`用于多线程同步；第二个 `res` 用于存放执行结果；第三个 `err`用于存放相关的错误。    type Promise struct {wg  sync.WaitGroupres stringerr error}然后，定义一个初始函数，来初始化 Promise对象。其中可以看到，需要把一个函数 `f` 传进来，然后调用 `wg.Add(1)` 对waitGroup 做加一操作，新开一个 Goroutine 通过异步去执行用户传入的函数`f()` ，然后记录这个函数的成功或错误，并把 waitGroup 做减一操作。    func NewPromise(f func() (string, error)) *Promise {p := &Promise{}p.wg.Add(1)go func() {p.res, p.err = f()p.wg.Done()}()return p}然后，我们需要定义 Promise 的 Then方法。其中需要传入一个函数，以及一个错误处理的函数。并且调用 `wg.Wait()`方法来阻塞（因为之前被`wg.Add(1)`)，一旦上一个方法被调用了`wg.Done()`，这个 Then 方法就会被唤醒。唤醒的第一件事是，检查一下之前的方法有没有错误。如果有，那么就调用错误处理函数。如果之前成功了，就把之前的结果以参数的方式传入到下一个函数中。    func (p *Promise) Then(r func(string), e func(error)) (*Promise){go func() {p.wg.Wait()if p.err != nil {e(p.err)return }r(p.res)}()return p}下面，我们定义一个用于测试的异步方法。这个方面很简单，就是在数数，然后，有一半的机率会出错。    func exampleTicker() (string, error) {for i := 0; i > 1 );  // what the fuck?     y  = * ( float * ) &i;    y  = y * ( threehalfs - ( x2 * y * y ) );  // 1st iteration     // 2nd iteration, this can be removed    // y  = y * ( threehalfs - ( x2 * y * y ) );      return y;}这段代码初读起来，我是完全不知所云，尤其是那个魔数0x5f3759df，根本不知道它是什么意思，所以，注释里也是 What thefuck。今天的这篇文章里，我主要就是想带你来了解一下这个函数中的代码究竟是怎样出来的。``{=html}其实，这个函数的作用是求平方根倒数，即 []{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[[[[x]{#014.html#MathJax-Span-4.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-7.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-8.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}/]{#014.html#MathJax-Span-11.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-10.mrow}]{#014.html#MathJax-Span-9 .texatom}[2]{#014.html#MathJax-Span-12.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-6.mrow}]{#014.html#MathJax-Span-5.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 2.261em; height: 0px;"}]{#014.html#MathJax-Span-3.msubsup}]{#014.html#MathJax-Span-2.mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.273em, 1002.26em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 2.261em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.238em;"}]{#014.html#MathJax-Span-1.mathstyle="width: 2.826em; display: inline-block;"}``{=html}[$x^{- 1/2}$]{.MJX_Assistive_MathMLrole="presentation"}]{#014.html#MathJax-Element-1-Frame .MathJaxtabindex="0" style="position: relative;"mathml="x−1/2"role="presentation"}$$，也就是下面这个算式：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[1]{#014.html#MathJax-Span-16.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.43em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -0.233em;"}[[[x]{#014.html#MathJax-Span-19.mistyle="font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-18.mrow}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0.849em;"}−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: -0.092em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: 0.002em;"}]{style="display: inline-block; position: relative; width: 0.661em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.579em, 1000.66em, 3.908em, -999.998em); top: -4.421em; left: 0.849em;"}[[√]{style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.061em, 1000.85em, 4.332em, -999.998em); top: -3.951em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.508em; height: 0px;"}]{#014.html#MathJax-Span-17.msqrt}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1001.51em, 4.426em, -999.998em); top: -3.292em; left: 50%; margin-left: -0.751em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.649em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1001.65em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.649em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-15.mfrac}]{#014.html#MathJax-Span-14.mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(0.802em, 1001.93em, 3.391em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.232em; border-left: 0px solid; width: 0px; height: 3.003em;"}]{#014.html#MathJax-Span-13.mathstyle="width: 2.449em; display: inline-block;"}``{=html}[$$\frac{1}{\sqrt{x}}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-2-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="1x"role="presentation"}$$$$当然，它算的是近似值。只不过这个近似值的精度很高，而且计算成本比传统的浮点数运算平方根的算法低太多。在以前那个计算资源还不充分的年代，在一些3D游戏场景的计算机图形学中，要求取照明和投影的光照与反射效果，就经常需要计算平方根倒数，而且是大量的计算------对一个曲面上很多的点做平方根倒数的计算。也就是需要用到下面的这个算式，其中的x,y,z 是 3D 坐标上的一个点的三个坐标值。]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[1]{#014.html#MathJax-Span-23.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.43em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -0.233em;"}[[[[[[x]{#014.html#MathJax-Span-27.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[2]{#014.html#MathJax-Span-30.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-29.mrow}]{#014.html#MathJax-Span-28.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.28em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-26.msubsup}[+]{#014.html#MathJax-Span-31 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[y[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-33.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.332em, -999.998em); top: -3.998em; left: 0em;"}[2]{#014.html#MathJax-Span-36.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-35.mrow}]{#014.html#MathJax-Span-34.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.28em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-32.msubsup style="padding-left: 0.238em;"}[+]{#014.html#MathJax-Span-37.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[z[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-39.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[2]{#014.html#MathJax-Span-42.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-41.mrow}]{#014.html#MathJax-Span-40.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.28em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px;"}]{#014.html#MathJax-Span-38.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-25.mrow}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1005.41em, 4.332em, -999.998em); top: -3.998em; left: 0.991em;"}−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: -0.092em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: 4.755em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 0.426em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 0.991em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 1.508em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 2.073em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 2.591em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 3.155em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 3.673em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 4.238em;"}]{style="display: inline-block; position: relative; width: 5.461em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.579em, 1005.46em, 3.908em, -999.998em); top: -4.609em; left: 0.991em;"}[[√]{style="font-family: MathJax_Size1;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.014em, 1001.04em, 4.473em, -999.998em); top: -4.045em; left: 0em;"}]{style="display: inline-block; position: relative; width: 6.449em; height: 0px;"}]{#014.html#MathJax-Span-24.msqrt}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.967em, 1006.45em, 4.473em, -999.998em); top: -3.151em; left: 50%; margin-left: -3.245em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 6.591em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1006.59em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 6.591em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-22.mfrac}]{#014.html#MathJax-Span-21.mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(0.802em, 1006.87em, 3.626em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 6.873em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.526em; border-left: 0px solid; width: 0px; height: 3.238em;"}]{#014.html#MathJax-Span-20.mathstyle="width: 8.614em; display: inline-block;"}``{=html}[$$\frac{1}{\sqrt{x^{2} + y^{2} + z^{2}}}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-3-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="1x2+y2+z2"role="presentation"}$$$$基本上来说，在一个 3D游戏中，我们每秒钟都需要做上百万次平方根倒数运算。而在计算硬件还不成熟的时代，这些计算都需要软件来完成，计算速度非常慢。我们要知道，在上世纪 90年代，多数浮点数操作的速度更是远远滞后于整数操作。所以，这段代码所带来的作用是非常大的。
# 计算机的浮点数表示为了讲清楚这段代码，我们需要先了解一下计算机的浮点数表示法。在 C语言中，计算机的浮点数表示用的是 IEEE 754标准，这个标准的表现形式其实就是把一个 32bits 分成三段。-   第一段占 1bit，表示符号位。代称为 S（sign）。-   第二段占 8bits，表示指数。代称为 E（Exponent）。-   第三段占 23bits，表示尾数。代称为 M（Mantissa）。如下图所示：![](Images/1b7d30923f4a450c418269525c769d7e.png){savepage-src="https://static001.geekbang.org/resource/image/cf/a2/cfb465ac3800ceb3f8a8997fe527c8a2.jpg"}然后呢，一个小数的计算方式是下面这个算式：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[(]{#014.html#MathJax-Span-45 .mostyle="font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-46 .mostyle="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-47 .mnstyle="font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-49 .mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[S[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-52.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-51.mrow}]{#014.html#MathJax-Span-50.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px;"}]{#014.html#MathJax-Span-48.msubsup}[∗]{#014.html#MathJax-Span-53 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[(]{#014.html#MathJax-Span-54.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[1]{#014.html#MathJax-Span-55.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-56 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[M[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#014.html#MathJax-Span-58.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1001.04em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -0.515em;"}[[2]{#014.html#MathJax-Span-60.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-63.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-62.mrow}]{#014.html#MathJax-Span-61.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-59.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.014em, 1001.27em, 4.144em, -999.998em); top: -3.198em; left: 50%; margin-left: -0.656em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.414em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1001.41em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.414em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-57.mfrac style="padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-64 .mostyle="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-65 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-67.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[(]{#014.html#MathJax-Span-70.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-71.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[−]{#014.html#MathJax-Span-72.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[127]{#014.html#MathJax-Span-73.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-74.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-69.mrow}]{#014.html#MathJax-Span-68.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 3.296em; height: 0px;"}]{#014.html#MathJax-Span-66.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-44.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(0.849em, 1012.1em, 3.296em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 12.096em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.826em;"}]{#014.html#MathJax-Span-43.mathstyle="width: 15.155em; display: inline-block;"}``{=html}[$$( - 1)^{S} \ast (1 + \frac{M}{2^{23}}) \ast 2^{(E - 127)}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-4-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(−1)S∗(1+M223)∗2(E−127)"role="presentation"}$$$$但是，这个算式基本上来说，完全就是让人一头雾水，摸不着门路。对于浮点数的解释基本上就是下面这张漫画里表现的样子。![](Images/cd32065c53cd8a6fd2d7a650e754bf8c.png){savepage-src="https://static001.geekbang.org/resource/image/7d/eb/7d607f3f90fe6e8152e2268da18e1feb.png"}下面，让我来试着解释一下浮点数的那三段表示什么意思。-   第一段符号位。对于这一段，我相信应该没有人不能理解。-   第二段指数位。什么叫指数？也就是说，对于任何数 x，其都可以找到一个    []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[n]{#014.html#MathJax-Span-77    .mi    style="font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-76    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.744em, 1000.61em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.614em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 0.709em;"}]{#014.html#MathJax-Span-75    .math    style="width: 0.802em; display: inline-block;"}``{=html}[$n$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-5-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="n"    role="presentation"}$$，使得 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-81    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-84    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-83    .mrow}]{#014.html#MathJax-Span-82    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-80    .msubsup}]{#014.html#MathJax-Span-79    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.99em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-78    .math    style="width: 1.273em; display: inline-block;"}``{=html}[$2^{n}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-6-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n"    role="presentation"}$$\`{=html}[[[[[2]{#014.html#MathJax-Span-88    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-91    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}[+]{#014.html#MathJax-Span-92    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-93    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-90    .mrow}]{#014.html#MathJax-Span-89    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px;"}]{#014.html#MathJax-Span-87    .msubsup}]{#014.html#MathJax-Span-86    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1001.88em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-85    .math    style="width: 2.355em; display: inline-block;"}``{=html}[$2^{n + 1}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-7-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n+1"    role="presentation"}$$。比如：对于 3 来说，因为 2 \`{=html}[[[[[2]{#014.html#MathJax-Span-97    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[(]{#014.html#MathJax-Span-100    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-101    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}[−]{#014.html#MathJax-Span-102    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[127]{#014.html#MathJax-Span-103    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-104    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-99    .mrow}]{#014.html#MathJax-Span-98    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 3.296em; height: 0px;"}]{#014.html#MathJax-Span-96    .msubsup}]{#014.html#MathJax-Span-95    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.226em, 1003.3em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 3.296em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.297em;"}]{#014.html#MathJax-Span-94    .math    style="width: 4.144em; display: inline-block;"}``{=html}[$2^{(E - 127)}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-8-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2(E−127)"    role="presentation"}$$ 这一项了。也就是说，[]{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[n]{#014.html#MathJax-Span-107    .mi    style="font-family: MathJax_Math-italic;"}[=]{#014.html#MathJax-Span-108    .mo    style="font-family: MathJax_Main; padding-left: 0.285em;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-109    .mi    style="font-family: MathJax_Math-italic; padding-left: 0.285em;"}[−]{#014.html#MathJax-Span-110    .mo    style="font-family: MathJax_Main; padding-left: 0.238em;"}[127]{#014.html#MathJax-Span-111    .mn    style="font-family: MathJax_Main; padding-left: 0.238em;"}]{#014.html#MathJax-Span-106    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.555em, 1005.51em, 2.591em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 5.508em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.174em; border-left: 0px solid; width: 0px; height: 1.062em;"}]{#014.html#MathJax-Span-105    .math    style="width: 6.92em; display: inline-block;"}``{=html}[$n = E - 127$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-9-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="n=E−127"    role="presentation"}$$，如果 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[n]{#014.html#MathJax-Span-114    .mi    style="font-family: MathJax_Math-italic;"}[=]{#014.html#MathJax-Span-115    .mo    style="font-family: MathJax_Main; padding-left: 0.285em;"}[1]{#014.html#MathJax-Span-116    .mn    style="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-113    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.555em, 1002.36em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 0.944em;"}]{#014.html#MathJax-Span-112    .math    style="width: 3.061em; display: inline-block;"}``{=html}[$n = 1$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-10-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="n=1"    role="presentation"}$$，那么 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-119    .mi    style="font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-118    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.508em, 1000.8em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.802em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 0.944em;"}]{#014.html#MathJax-Span-117    .math    style="width: 1.038em; display: inline-block;"}``{=html}[$E$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-11-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="E"    role="presentation"}$$ 就是 128 了。-   第三段尾数位。也就是小数位，但是这里叫偏移量可能好一些。这里的取值是从    \[ 0 - []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-123    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-126    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-125    .mrow}]{#014.html#MathJax-Span-124    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-122    .msubsup}]{#014.html#MathJax-Span-121    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1001.27em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-120    .math    style="width: 1.602em; display: inline-block;"}``{=html}[$2^{23}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-12-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="223"    role="presentation"}$$\] 中。你可以认为，我们把一条线分成    []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-130    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-133    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-132    .mrow}]{#014.html#MathJax-Span-131    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-129    .msubsup}]{#014.html#MathJax-Span-128    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1001.27em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-127    .math    style="width: 1.602em; display: inline-block;"}``{=html}[$2^{23}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-13-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="223"    role="presentation"}$$ 个线段，也就是 8388608 个线段。也就是说，把    []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-137    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-140    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-139    .mrow}]{#014.html#MathJax-Span-138    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-136    .msubsup}]{#014.html#MathJax-Span-135    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.99em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-134    .math    style="width: 1.273em; display: inline-block;"}``{=html}[$2^{n}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-14-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n"    role="presentation"}$$ 到 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-144    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-147    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}[+]{#014.html#MathJax-Span-148    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-149    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-146    .mrow}]{#014.html#MathJax-Span-145    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px;"}]{#014.html#MathJax-Span-143    .msubsup}]{#014.html#MathJax-Span-142    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1001.88em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-141    .math    style="width: 2.355em; display: inline-block;"}``{=html}[$2^{n + 1}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-15-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n+1"    role="presentation"}$$ 分成了 8388608 个线段。而存储的 M 值，就是从    []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-153    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[[n]{#014.html#MathJax-Span-154    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-152    .msubsup}]{#014.html#MathJax-Span-151    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.99em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-150    .math    style="width: 1.273em; display: inline-block;"}``{=html}[$2^{n}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-16-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n"    role="presentation"}$$ 到 x    要经过多少个段。这要计算一下，[]{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-158    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-161    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-160    .mrow}]{#014.html#MathJax-Span-159    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-157    .msubsup}]{#014.html#MathJax-Span-156    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.99em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-155    .math    style="width: 1.273em; display: inline-block;"}``{=html}[$2^{n}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-17-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n"    role="presentation"}$$ 到 x 的长度占 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-165    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-168    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-167    .mrow}]{#014.html#MathJax-Span-166    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px;"}]{#014.html#MathJax-Span-164    .msubsup}]{#014.html#MathJax-Span-163    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.99em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.991em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-162    .math    style="width: 1.273em; display: inline-block;"}``{=html}[$2^{n}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-18-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n"    role="presentation"}$$ 到 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-172    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[n]{#014.html#MathJax-Span-175    .mi    style="font-size: 70.7%; font-family: MathJax_Math-italic;"}[+]{#014.html#MathJax-Span-176    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-177    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-174    .mrow}]{#014.html#MathJax-Span-173    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px;"}]{#014.html#MathJax-Span-171    .msubsup}]{#014.html#MathJax-Span-170    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1001.88em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.885em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-169    .math    style="width: 2.355em; display: inline-block;"}``{=html}[$2^{n + 1}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-19-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="2n+1"    role="presentation"}$$ 长度的比例是多少。我估计你对第三段还是有点不懂，那么我们来举一个例子。比如说，对 3.14这个小数。-   是正数。所以，S = 0-   []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-181    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[[1]{#014.html#MathJax-Span-182    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px;"}]{#014.html#MathJax-Span-180    .msubsup}]{#014.html#MathJax-Span-179    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1000.94em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-178    .math    style="width: 1.179em; display: inline-block;"}``{=html}[$2^{1}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-20-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="21"    role="presentation"}$$ \`{=html}[[[[[2]{#014.html#MathJax-Span-186    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[[2]{#014.html#MathJax-Span-187    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px;"}]{#014.html#MathJax-Span-185    .msubsup}]{#014.html#MathJax-Span-184    .mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.32em, 1000.94em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.179em;"}]{#014.html#MathJax-Span-183    .math    style="width: 1.179em; display: inline-block;"}``{=html}[$2^{2}$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-21-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="22"    role="presentation"}$$。所以，n=1， n+127 = 128。所以，E=128。-   (3.14 - 2) / (4 - 2) = 0.57， 而 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[0.57]{#014.html#MathJax-Span-190    .mn    style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-191    .mo    style="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-193    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-196    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-195    .mrow}]{#014.html#MathJax-Span-194    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-192    .msubsup    style="padding-left: 0.238em;"}[=]{#014.html#MathJax-Span-197 .mo    style="font-family: MathJax_Main; padding-left: 0.285em;"}[4781506.56]{#014.html#MathJax-Span-198    .mn    style="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-189    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.367em, 1010.12em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 10.167em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.238em;"}]{#014.html#MathJax-Span-188    .math    style="width: 12.708em; display: inline-block;"}``{=html}[$0.57 \ast 2^{23} = 4781506.56$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-22-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="0.57∗223=4781506.56"    role="presentation"}$$，四舍五入，得到 M =    4781507。因为有四舍五入，所以，产生了浮点数据的精度问题。把 S、E、M 转成二进制，得到 3.14 的二进制表示。![](Images/41c187fe82597aee85a9a73347f1f619.png){savepage-src="https://static001.geekbang.org/resource/image/3f/15/3f99e711a80ebe963bd5ca4139224915.jpg"}我们再用 IEEE 754 的那个算式来算一下：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[[[(]{#014.html#MathJax-Span-204.mo style="font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-205.mo style="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-206.mn style="font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-207.mo style="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-203.mrow}]{#014.html#MathJax-Span-202.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1001.98em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[[0]{#014.html#MathJax-Span-208.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.468em; left: 2.073em;"}]{style="display: inline-block; position: relative; width: 2.496em; height: 0px;"}]{#014.html#MathJax-Span-201.msubsup}[∗]{#014.html#MathJax-Span-209 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[(]{#014.html#MathJax-Span-210.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}1]{#014.html#MathJax-Span-213.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-214.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[4781507]{#014.html#MathJax-Span-216.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1003.49em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -1.739em;"}[[2]{#014.html#MathJax-Span-218.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-221.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-220.mrow}]{#014.html#MathJax-Span-219.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-217.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.014em, 1001.27em, 4.144em, -999.998em); top: -3.198em; left: 50%; margin-left: -0.656em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.626em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1003.63em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 3.626em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-215.mfrac style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-212.mrow}]{#014.html#MathJax-Span-211.texatom}[)]{#014.html#MathJax-Span-222 .mostyle="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-223 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-225.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[(]{#014.html#MathJax-Span-228.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[128]{#014.html#MathJax-Span-229.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-230.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[127]{#014.html#MathJax-Span-231.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-232.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-227.mrow}]{#014.html#MathJax-Span-226.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 3.814em; height: 0px;"}]{#014.html#MathJax-Span-224.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-200.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(0.849em, 1014.68em, 3.296em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 14.685em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.826em;"}]{#014.html#MathJax-Span-199.mathstyle="width: 18.355em; display: inline-block;"}``{=html}[$${( - 1)}^{0} \ast ({1 + \frac{4781507}{2^{23}}}) \ast 2^{(128 - 127)}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-23-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(−1)0∗(1+4781507223)∗2(128−127)"role="presentation"}$$$$]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[1]{#014.html#MathJax-Span-235.mn style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-236.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[(]{#014.html#MathJax-Span-237.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[1]{#014.html#MathJax-Span-238.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-239.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[0.5700000524520874]{#014.html#MathJax-Span-240.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-241.mo style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-242.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-243.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}]{#014.html#MathJax-Span-234.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.461em, 1014.21em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 14.261em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-233.mathstyle="width: 17.838em; display: inline-block;"}``{=html}[$$1 \ast (1 + 0.5700000524520874) \ast 2$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-24-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="1∗(1+0.5700000524520874)∗2"role="presentation"}$$$$\]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[=]{#014.html#MathJax-Span-246.mostyle="font-family: MathJax_Main;"}[3.1400001049041748046875]{#014.html#MathJax-Span-247.mnstyle="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-245.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.555em, 1012.8em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 12.849em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-244.mathstyle="width: 16.096em; display: inline-block;"}``{=html}[$$= 3.1400001049041748046875$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-25-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="=3.1400001049041748046875"role="presentation"}$$$$你看，浮点数的精度问题出现了。我们再来看一个示例，小数 0.015。-   是正数。所以，S = 0。-   []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[[[[2]{#014.html#MathJax-Span-251    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-254    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[7]{#014.html#MathJax-Span-255    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-253    .mrow}]{#014.html#MathJax-Span-252    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.461em; height: 0px;"}]{#014.html#MathJax-Span-250    .msubsup}[\`{=html}[$2^{- 7} 2−70.0152−6"    role="presentation"}$$ 。所以，n=-7， n+127 = 120。所以，E=120。-   []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[(]{#014.html#MathJax-Span-267    .mo    style="font-family: MathJax_Main;"}[0.015]{#014.html#MathJax-Span-268    .mn    style="font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-269    .mo    style="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-271    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-274    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[7]{#014.html#MathJax-Span-275    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-273    .mrow}]{#014.html#MathJax-Span-272    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.461em; height: 0px;"}]{#014.html#MathJax-Span-270    .msubsup    style="padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-276 .mo    style="font-family: MathJax_Main;"}/]{#014.html#MathJax-Span-279    .mo style="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-278    .mrow}]{#014.html#MathJax-Span-277    .texatom}[(]{#014.html#MathJax-Span-280 .mo    style="font-family: MathJax_Main;"}[2]{#014.html#MathJax-Span-282    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-285    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[6]{#014.html#MathJax-Span-286    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-284    .mrow}]{#014.html#MathJax-Span-283    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.461em; height: 0px;"}]{#014.html#MathJax-Span-281    .msubsup}[−]{#014.html#MathJax-Span-287 .mo    style="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-289    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-292    .mo    style="font-size: 70.7%; font-family: MathJax_Main;"}[7]{#014.html#MathJax-Span-293    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-291    .mrow}]{#014.html#MathJax-Span-290    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.461em; height: 0px;"}]{#014.html#MathJax-Span-288    .msubsup    style="padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-294 .mo    style="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-266    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.32em, 1011.15em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 11.249em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.532em;"}]{#014.html#MathJax-Span-265    .math    style="width: 14.073em; display: inline-block;"}``{=html}[$(0.015 - 2^{- 7})/(2^{- 6} - 2^{- 7})$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-27-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="(0.015−2−7)/(2−6−2−7)"    role="presentation"}$$ = []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[0.0071875]{#014.html#MathJax-Span-297    .mn    style="font-family: MathJax_Main;"}/]{#014.html#MathJax-Span-300    .mo style="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-299    .mrow}]{#014.html#MathJax-Span-298    .texatom}[0.0078125]{#014.html#MathJax-Span-301 .mn    style="font-family: MathJax_Main;"}[=]{#014.html#MathJax-Span-302    .mo    style="font-family: MathJax_Main; padding-left: 0.285em;"}[0.92]{#014.html#MathJax-Span-303    .mn    style="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-296    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.461em, 1012.14em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 12.191em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-295    .math    style="width: 15.249em; display: inline-block;"}``{=html}[$0.0071875/0.0078125 = 0.92$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-28-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="0.0071875/0.0078125=0.92"    role="presentation"}$$。而 []{.MathJax_Preview    style="color: inherit; display: none;"}[``{=html}[[0.92]{#014.html#MathJax-Span-306    .mn    style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-307    .mo    style="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-309    .mn    style="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-312    .mn    style="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-311    .mrow}]{#014.html#MathJax-Span-310    .texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-308    .msubsup    style="padding-left: 0.238em;"}[=]{#014.html#MathJax-Span-313 .mo    style="font-family: MathJax_Main; padding-left: 0.285em;"}[7717519.36]{#014.html#MathJax-Span-314    .mn    style="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-305    .mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.367em, 1010.12em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 10.167em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.238em;"}]{#014.html#MathJax-Span-304    .math    style="width: 12.708em; display: inline-block;"}``{=html}[$0.92 \ast 2^{23} = 7717519.36$]{.MJX_Assistive_MathML    role="presentation"}]{#014.html#MathJax-Element-29-Frame .MathJax    tabindex="0" style="position: relative;"    mathml="0.92∗223=7717519.36"    role="presentation"}$$，四舍五入，得到 M = 7717519。于是，我们得到 0.015 的二进制编码：![](Images/dbdaf0bf85f0b283f157049bdd1ab74c.png){savepage-src="https://static001.geekbang.org/resource/image/bd/de/bd3c8cae032d818084f2d1ac0a02acde.jpg"}其中：-   120 的二进制是 01111000-   7717519 的二进制是 11101011100001010001111返回过来算一下：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[(]{#014.html#MathJax-Span-317.mo style="font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-318.mo style="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-319.mn style="font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-321.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[0]{#014.html#MathJax-Span-324.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-323.mrow}]{#014.html#MathJax-Span-322.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 0.802em; height: 0px;"}]{#014.html#MathJax-Span-320.msubsup}[∗]{#014.html#MathJax-Span-325 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[(]{#014.html#MathJax-Span-326.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[1]{#014.html#MathJax-Span-327.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-328.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[7717519]{#014.html#MathJax-Span-330.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1003.44em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -1.739em;"}[[2]{#014.html#MathJax-Span-332.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-335.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-334.mrow}]{#014.html#MathJax-Span-333.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-331.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.014em, 1001.27em, 4.144em, -999.998em); top: -3.198em; left: 50%; margin-left: -0.656em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.626em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1003.63em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 3.626em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-329.mfrac style="padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-336 .mostyle="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-337 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-339.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[(]{#014.html#MathJax-Span-342.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[120]{#014.html#MathJax-Span-343.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-344.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[127]{#014.html#MathJax-Span-345.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-346.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-341.mrow}]{#014.html#MathJax-Span-340.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 3.814em; height: 0px;"}]{#014.html#MathJax-Span-338.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-316.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(0.849em, 1014.68em, 3.296em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 14.685em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.826em;"}]{#014.html#MathJax-Span-315.mathstyle="width: 18.355em; display: inline-block;"}``{=html}[$$( - 1)^{0} \ast (1 + \frac{7717519}{2^{23}}) \ast 2^{(120 - 127)}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-30-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(−1)0∗(1+7717519223)∗2(120−127)"role="presentation"}$$$$]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[(]{#014.html#MathJax-Span-349.mo style="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-350.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-351.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[0.919999957084656]{#014.html#MathJax-Span-352.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-353.mo style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-354.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[0.0078125]{#014.html#MathJax-Span-355.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}]{#014.html#MathJax-Span-348.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.461em, 1016em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 16.049em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-347.mathstyle="width: 20.096em; display: inline-block;"}``{=html}[$$(1 + 0.919999957084656) \ast 0.0078125$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-31-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(1+0.919999957084656)∗0.0078125"role="presentation"}$$$$\]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[=]{#014.html#MathJax-Span-358.mostyle="font-family: MathJax_Main;"}[0.014999999664724]{#014.html#MathJax-Span-359.mnstyle="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-357.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.555em, 1009.32em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 9.367em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-356.mathstyle="width: 11.72em; display: inline-block;"}``{=html}[$$= 0.014999999664724$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-32-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="=0.014999999664724"role="presentation"}$$$$你看，浮点数的精度问题又出现了。我们来用 C 语言验证一下：    int main() {    float x = 3.14;    float y = 0.015;    return 0;}在我的 Mac 上用 lldb 工具 Debug 一下。    (lldb) frame variable(float) x = 3.1400001(float) y = 0.0149999997 (lldb) frame variable -f b(float) x = 0b01000000010010001111010111000011(float) y = 0b00111100011101011100001010001111从结果上，完全验证了我们的方法。好了，不知道你看懂了没有？我相信你应该看懂了。
# 简化浮点数公式因为那个浮点数表示的公式有点复杂，我们简化一下：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[(]{#014.html#MathJax-Span-362.mo style="font-family: MathJax_Main;"}[−]{#014.html#MathJax-Span-363.mo style="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-364.mn style="font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-366.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[S[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-369.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-368.mrow}]{#014.html#MathJax-Span-367.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 0.944em; height: 0px;"}]{#014.html#MathJax-Span-365.msubsup}[∗]{#014.html#MathJax-Span-370 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[(]{#014.html#MathJax-Span-371.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[1]{#014.html#MathJax-Span-372.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-373.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[M[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#014.html#MathJax-Span-375.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1001.04em, 4.144em, -999.998em); top: -4.656em; left: 50%; margin-left: -0.515em;"}[[2]{#014.html#MathJax-Span-377.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-380.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-379.mrow}]{#014.html#MathJax-Span-378.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.374em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-376.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.014em, 1001.27em, 4.144em, -999.998em); top: -3.198em; left: 50%; margin-left: -0.656em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.414em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1001.41em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.414em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-374.mfrac style="padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-381 .mostyle="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-382 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-384.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[(]{#014.html#MathJax-Span-387.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-388.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[−]{#014.html#MathJax-Span-389.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[127]{#014.html#MathJax-Span-390.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[)]{#014.html#MathJax-Span-391.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-386.mrow}]{#014.html#MathJax-Span-385.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 3.296em; height: 0px;"}]{#014.html#MathJax-Span-383.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-361.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(0.849em, 1012.1em, 3.296em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 12.096em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -1.056em; border-left: 0px solid; width: 0px; height: 2.826em;"}]{#014.html#MathJax-Span-360.mathstyle="width: 15.155em; display: inline-block;"}``{=html}[$$( - 1)^{S} \ast (1 + \frac{M}{2^{23}}) \ast 2^{(E - 127)}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-33-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(−1)S∗(1+M223)∗2(E−127)"role="presentation"}$$$$我们令，[]{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[m]{#014.html#MathJax-Span-394.mistyle="font-family: MathJax_Math-italic;"}[=]{#014.html#MathJax-Span-395.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[(]{#014.html#MathJax-Span-396.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[M[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-398.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.75em, 4.144em, -999.998em); top: -4.374em; left: 50%; margin-left: -0.374em;"}[[2]{#014.html#MathJax-Span-400.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.33em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-403.mnstyle="font-size: 50%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-402.mrow}]{#014.html#MathJax-Span-401.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.28em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 0.896em; height: 0px;"}]{#014.html#MathJax-Span-399.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.249em, 1000.9em, 4.144em, -999.998em); top: -3.48em; left: 50%; margin-left: -0.468em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.038em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1001.04em, 1.226em, -999.998em); top: -1.315em; left: 0em;"}]{style="display: inline-block; position: relative; width: 1.038em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-397.mfrac}[)]{#014.html#MathJax-Span-404 .mostyle="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-393.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.32em, 1004.24em, 3.014em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.703em; border-left: 0px solid; width: 0px; height: 1.885em;"}]{#014.html#MathJax-Span-392.mathstyle="width: 5.414em; display: inline-block;"}``{=html}[$m = (\frac{M}{2^{23}})$]{.MJX_Assistive_MathMLrole="presentation"}]{#014.html#MathJax-Element-34-Frame .MathJaxtabindex="0" style="position: relative;"mathml="m=(M223)"role="presentation"}$$，[]{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[e]{#014.html#MathJax-Span-407.mistyle="font-family: MathJax_Math-italic;"}[=]{#014.html#MathJax-Span-408.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[(]{#014.html#MathJax-Span-409.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-410.mistyle="font-family: MathJax_Math-italic;"}[−]{#014.html#MathJax-Span-411.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[127]{#014.html#MathJax-Span-412.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-413.mo style="font-family: MathJax_Main;"}]{#014.html#MathJax-Span-406.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.461em, 1006.03em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 6.12em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-405.mathstyle="width: 7.673em; display: inline-block;"}``{=html}[$e = (E - 127)$]{.MJX_Assistive_MathMLrole="presentation"}]{#014.html#MathJax-Element-35-Frame .MathJaxtabindex="0" style="position: relative;"mathml="e=(E−127)"role="presentation"}$$。因为符号位在 []{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[y[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#014.html#MathJax-Span-416.mistyle="font-family: MathJax_Math-italic;"}[=]{#014.html#MathJax-Span-417.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[x]{#014.html#MathJax-Span-419.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[−]{#014.html#MathJax-Span-422.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-424.mnstyle="font-size: 50%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.532em, 1000.24em, 4.144em, -999.998em); top: -4.327em; left: 50%; margin-left: -0.139em;"}[[2]{#014.html#MathJax-Span-425.mnstyle="font-size: 50%; font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.532em, 1000.24em, 4.144em, -999.998em); top: -3.715em; left: 50%; margin-left: -0.139em;"}[[]{style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.379em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 1.085em;"}]{style="position: absolute; clip: rect(0.896em, 1000.38em, 1.226em, -999.998em); top: -1.221em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.379em; height: 0px; margin-right: 0.144em; margin-left: 0.144em;"}]{#014.html#MathJax-Span-423.mfrac}]{#014.html#MathJax-Span-421 .mrow}]{#014.html#MathJax-Span-420.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.791em; height: 0px;"}]{#014.html#MathJax-Span-418.msubsup style="padding-left: 0.285em;"}]{#014.html#MathJax-Span-415.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.132em, 1003.63em, 2.685em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 3.626em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.291em; border-left: 0px solid; width: 0px; height: 1.709em;"}]{#014.html#MathJax-Span-414.mathstyle="width: 4.567em; display: inline-block;"}``{=html}[$y = x^{- \frac{1}{2}}$]{.MJX_Assistive_MathMLrole="presentation"}]{#014.html#MathJax-Element-36-Frame .MathJaxtabindex="0" style="position: relative;"mathml="y=x−12"role="presentation"}$$ 的两端都是0（正数），也就可以去掉，所以浮点数的算式简化为：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[(]{#014.html#MathJax-Span-428.mo style="font-family: MathJax_Main;"}[1]{#014.html#MathJax-Span-429.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-430.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[m]{#014.html#MathJax-Span-431.mistyle="font-family: MathJax_Math-italic; padding-left: 0.238em;"}[)]{#014.html#MathJax-Span-432.mo style="font-family: MathJax_Main;"}[∗]{#014.html#MathJax-Span-433.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-435.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[e]{#014.html#MathJax-Span-438.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-437.mrow}]{#014.html#MathJax-Span-436.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 0.896em; height: 0px;"}]{#014.html#MathJax-Span-434.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-427.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.461em, 1005.27em, 2.732em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 5.273em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.35em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-426.mathstyle="width: 6.591em; display: inline-block;"}``{=html}[$$(1 + m) \ast 2^{e}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-37-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="(1+m)∗2e"role="presentation"}$$$$上面这个算式是从一个 32bits 二进制计算出一个浮点数。这个 32bits的整型算式是：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[M[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#014.html#MathJax-Span-441.mistyle="font-family: MathJax_Math-italic;"}[+]{#014.html#MathJax-Span-442.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[E[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-443.mistyle="font-family: MathJax_Math-italic; padding-left: 0.238em;"}[∗]{#014.html#MathJax-Span-444.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-446.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-449.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-448.mrow}]{#014.html#MathJax-Span-447.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-445.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-440.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.32em, 1005.37em, 2.591em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 5.367em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.174em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-439.mathstyle="width: 6.732em; display: inline-block;"}``{=html}[$$M + E \ast 2^{23}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-38-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="M+E∗223"role="presentation"}$$$$比如，0.015 的 32bits的二进制是：00111100011101011100001010001111，也就是整型的：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[7717519]{#014.html#MathJax-Span-452.mn style="font-family: MathJax_Main;"}[+]{#014.html#MathJax-Span-453.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[120]{#014.html#MathJax-Span-454.mnstyle="font-family: MathJax_Main; padding-left: 0.238em;"}[∗]{#014.html#MathJax-Span-455.mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[2]{#014.html#MathJax-Span-457.mnstyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.202em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[23]{#014.html#MathJax-Span-460.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#014.html#MathJax-Span-459.mrow}]{#014.html#MathJax-Span-458.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.52em;"}]{style="display: inline-block; position: relative; width: 1.273em; height: 0px;"}]{#014.html#MathJax-Span-456.msubsup style="padding-left: 0.238em;"}]{#014.html#MathJax-Span-451.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.32em, 1008.52em, 2.591em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 8.52em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.174em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#014.html#MathJax-Span-450.mathstyle="width: 10.685em; display: inline-block;"}``{=html}[$$7717519 + 120 \ast 2^{23}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-39-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="7717519+120∗223"role="presentation"}$$$$\]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[=]{#014.html#MathJax-Span-463.mostyle="font-family: MathJax_Main;"}[1014350479]{#014.html#MathJax-Span-464.mnstyle="font-family: MathJax_Main; padding-left: 0.285em;"}]{#014.html#MathJax-Span-462.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.555em, 1006.03em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 6.073em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-461.mathstyle="width: 7.626em; display: inline-block;"}``{=html}[$$= 1014350479$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-40-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="=1014350479"role="presentation"}$$$$\]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[=]{#014.html#MathJax-Span-467.mo style="font-family: MathJax_Main;"}[0]{#014.html#MathJax-Span-468.mnstyle="font-family: MathJax_Main; padding-left: 0.285em;"}[X[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-469.mistyle="font-family: MathJax_Math-italic;"}[3]{#014.html#MathJax-Span-470.mnstyle="font-family: MathJax_Main;"}[C[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-471.mistyle="font-family: MathJax_Math-italic;"}[75]{#014.html#MathJax-Span-472.mnstyle="font-family: MathJax_Main;"}[C[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#014.html#MathJax-Span-473.mistyle="font-family: MathJax_Math-italic;"}[28]{#014.html#MathJax-Span-474.mnstyle="font-family: MathJax_Main;"}[F[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#014.html#MathJax-Span-475.mistyle="font-family: MathJax_Math-italic;"}]{#014.html#MathJax-Span-466.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.508em, 1007.2em, 2.496em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 7.202em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#014.html#MathJax-Span-465.mathstyle="width: 9.038em; display: inline-block;"}``{=html}[$$= 0X3C75C28F$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#014.html#MathJax-Element-41-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="=0X3C75C28F"role="presentation"}$$$$