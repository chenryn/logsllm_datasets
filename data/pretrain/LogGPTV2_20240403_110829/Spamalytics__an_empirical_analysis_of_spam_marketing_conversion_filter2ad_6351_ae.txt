ods to get there (for example, Hotmail rejects most Storm spam at
the MTA-level, while Gmail accepts a signiﬁcant fraction only to
ﬁlter it later as junk).
The number of visits (D) is the number of accesses to our em-
ulated pharmacy and postcard sites, excluding any crawlers as de-
termined using the methods outlined in Section 4.2. We note that
crawler requests came from a small fraction of hosts but accounted
for the majority of all requests to our Web sites. For the pharmacy
site, for instance, of the 11,720 unique IP addresses seen accessing
the site with a valid unique identiﬁer, only 10.2% were blacklisted
as crawlers. In contrast, 55.3% of all unique identiﬁers used in re-
quests originated from these crawlers. For all non-image requests
made to the site, 87.43% were made by blacklisted IP addresses.
The number of conversions (E) is the number of visits to the
purchase page of the pharmacy site, or the number of executions of
the fake self-propagation program.
Our results for Storm spam campaigns show that the spam con-
version rate is quite low. For example, out of 350 million pharmacy
campaign e-mails only 28 conversions resulted (and no crawler ever
completed a purchase so errors in crawler ﬁltering plays no role).
However, a very low conversion rate does not necessary imply low
revenue or proﬁtability. We discuss the implications of the conver-
sion rate on the spam conversion proposition further in Section 8.
5.3 Time to click
The conversion pipeline shows what fraction of spam ultimately
resulted visits to the advertised sites. However, it does not re-
ﬂect the latency between when the spam was sent and when a user
clicked on it. The longer it takes users to act, the longer the scam
hosting infrastructure will need to remain available to extract rev-
enue from the spam [3]. Put another way, how long does a spam-
advertised site need to be available to collect its potential revenue?
Figure 7: Time-to-click distributions for accesses to the phar-
macy site.
Figure 7 shows the cumulative distribution of the “time-to-click”
for accesses to the pharmacy site. The time-to-click is the time
from when spam is sent (when a proxy forwards a spam workload
to a worker bot) to when a user “clicks” on the URL in the spam
(when a host ﬁrst accesses the Web site). The graph shows three
distributions for the accesses by all users, the users who visited the
purchase page (“converters”), and the automated crawlers (14,716
such accesses). Note that we focus on the pharmacy site since,
absent a unique identiﬁer, we do not have a mechanism to link visits
to the self-propagation site to speciﬁc spam messages and their time
of delivery.
The user and crawler distributions show distinctly different be-
havior. Almost 30% of the crawler accesses are within 20 sec-
onds of worker bots sending spam. This behavior suggests that
these crawlers are conﬁgured to scan sites advertised in spam im-
mediately upon delivery. Another 10% of crawler accesses have
a time-to-click of 1 day, suggesting crawlers conﬁgured to access
spam-advertised sites periodically in batches. In contrast, only 10%
of the user population accesses spam URLs immediately, and the
remaining distribution is smooth without any distinct modes. The
distributions for all users and users who “convert” are roughly simi-
lar, suggesting little correlation between time-to-click and whether
a user visiting a site will convert. While most user visits occur
within the ﬁrst 24 hours, 10% of times-to-click are a week to a
month, indicating that advertised sites need to be available for long
durations to capture full revenue potential.
6. EFFECTS OF BLACKLISTING
A major effect on the efﬁcacy of spam delivery is the employ-
ment by numerous ISPs of address-based blacklisting to reject e-
mail from hosts previously reported as sourcing spam. To assess
the impact of blacklisting, during the course of our experiments
we monitored the Composite Blocking List (CBL) [1], a blacklist
source used by the operators of some of our institutions. At any
given time the CBL lists on the order of 4–6 million IP addresses
that have sent e-mail to various spamtraps. We were able to monitor
the CBL from March 21 – April 2, 2008, from the start of the Phar-
macy campaign until the end of the April Fool campaign. Although
the monitoring does not cover the full extent of all campaigns, we
believe our results to be representative of the effects of CBL during
the time frame of our experiments.
1s10s1min10min1h6h1d1w1m00.20.40.60.81Time to clickFraction of clicks  CrawlersUsersConvertersFigure 9: Geographic locations of the hosts that “convert” on spam: the 541 hosts that execute the emulated self-propagation
program (light grey), and the 28 hosts that visit the purchase page of the emulated pharmacy site (black).
Of hosts never appearing on the list, more than 75% never reported
successful delivery of spam, indicating that the reason for their lack
of listing was simply their inability to effectively annoy anyone.
One confounding factor is that the CBL exhibits considerable
ﬂux once an address ﬁrst appears on the blacklist:
the worker
bots typically (median) experience 5 cycles of listing-followed-by-
delisting. Much of this churn comes from a few periods of massive
delistings, which appear to be glitches in maintenance (or propa-
gation) of the blacklist rather than a response to external events.
(If delistings arose due to botmasters using the delisting process to
render their workers more effective for a while, then it might be
possible to monitor the delisting process in order to conduct botnet
counterintelligence, similar to that developed previously for black-
listing lookups [18].) Due to caching of blacklist entries by sites,
we thus face ambiguity regarding whether a given worker is viewed
as blacklisted at a given time. For our preliminary analysis, we sim-
ply consider a worker as blacklisted from the point where it ﬁrst
appears on the CBL onwards.
We would expect that the impact of blacklisting on spam delivery
strongly depends on the domain targeted in a given e-mail, since
some domains incorporate blacklist feeds such as the CBL into
their mailer operations and others do not. To explore this effect,
Figure 8 plots the per-domain delivery rate: the number of spam e-
mails that workers reported as successfully delivered to the domain
divided by number attempted to that domain. The x-axis shows the
delivery rate for spams sent by a worker prior to its appearance in
the CBL, and the y-axis shows the rate after its appearance in the
CBL. We limit the plot to the 10,879 domains to which workers at-
tempted to deliver at least 1,000 spams. We plot delivery rates for
the two different campaigns as separate circles, though the over-
all nature of the plot does not change between them. The radius of
each plotted circle scales in proportion to the number of delivery at-
tempts, the largest corresponding to domains such as hotmail.com,
yahoo.com, and gmail.com.
From the plot we clearly see a range of blacklisting behavior by
different domains. Some employ other effective anti-spam ﬁltering,
indicated by their appearance near the origin — spam did not get
through even prior to appearing on the CBL blacklist. Some make
heavy use of either the CBL or a similar list (y-axis near zero, but
Figure 8: Change in per-domain delivery rates as seen prior
to a worker bot appearing in the blacklist (x-axis) vs. after ap-
pearing (y-axis). Each circle represents a domain targeted by
at least 1,000 analyzable deliveries, with the radius scaled in
proportion to the number of delivery attempts.
We downloaded the current CBL blacklist every half hour, en-
abling us to determine which worker bots in our measurements
were present on the list and how their arrival on the list related
to their botnet activity. Of 40,864 workers that sent delivery re-
ports, fully 81% appeared on the CBL. Of those appearing at some
point on the list, 77% were on the list prior to our observing their
receipt of spamming directives, appearing ﬁrst on the list 4.4 days
(median) earlier. Of those not initially listed but then listed sub-
sequently, the median interval until listing was 1.5 hours, strongly
suggesting that the spamming activity we observed them being in-
structed to conduct quickly led to their detection and blacklisting.
0.00.20.40.60.81.00.00.20.40.60.81.0                                               Delivery Rate Prior to BlacklistingDelivery Rate Post BlacklistinglllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllllFigure 10: Volume of e-mail targeting (x-axis) vs. responses (y-
axis) for the most prominent country-code TLDs. The x and y
axes correspond to Stages A and D in the pipeline (Figure 6),
respectively.
x-axis greater than zero), while others appear insensitive to black-
listing (those lying on the diagonal). Since points lie predominantly
below the diagonal, we see that either blacklisting or some other
effect related to sustained spamming activity (e.g., learning con-
tent signatures) diminishes the delivery rate seen at most domains.
Delisting followed by relisting may account for some of the spread
of points seen here; those few points above the diagonal may sim-
ply be due to statistical ﬂuctuations. Finally, the cloud of points
to the upper right indicates a large number of domains that are not
much targeted individually, but collectively comprise a signiﬁcant
population that appears to employ no effective anti-spam measures.
7. CONVERSION ANALYSIS
We now turn to a preliminary look at possible factors inﬂuenc-
ing response to spam. For the present, we conﬁne our analysis to
coarse-grained effects.
We start by mapping the geographic distribution of the hosts
that “convert” on the spam campaigns we monitored. Figure 9
maps the locations of the 541 hosts that execute the emulated self-
propagation program, and the 28 hosts that visit the purchase page
of the emulated pharmacy site. The map shows that users around
the world respond to spam.
Figure 10 looks at differences in response rates among nations
as determined by prevalent country-code e-mail domain TLDs. To
allow the inclusion of generic TLDs such as .com, for each e-mail
address we consider it a member of the country hosting its mail
server; we remove domains that resolve to multiple countries, cat-
egorizing them as “international” domains. The x-axis shows the
volume of e-mail (log-scaled) targeting a given country, while the
y-axis gives the number of responses recorded at our Web servers
(also log-scaled), corresponding to Stages A and D in the pipeline
(Figure 6), respectively. The solid line reﬂects a response rate of
10−4 and the dashed line a rate of 10−3. Not surprisingly, we
see that the spam campaigns target e-mail addresses in the United
Figure 11: Response rates (stage D in the pipeline) by TLD for
executable download (x-axis) vs. pharmacy visits (y-axis).
States substantially more than any other country. Further, India,
France and the United States dominate responses. In terms of re-
sponse rates, however, India, Pakistan, and Bulgaria have the high-
est response rates than any other countries (furthest away from the
diagonal). The United States, although a dominant target and re-
sponder, has the lowest resulting response rate of any country, fol-
lowed by Japan and Taiwan.
However, the countries with predominant response rates do not
appear to reﬂect a heightened interest in users from those countries
in the speciﬁc spam offerings. Figure 11 plots the rates for the
most prominent countries responding to self-propagation vs. phar-
macy spams. The median ratio between these two rates is 0.38
(diagonal line). We see that India and Pakistan in fact exhibit al-
most exactly this ratio (upper-right corner), and Bulgaria is not far
from it.
Indeed, only a few TLDs exhibit signiﬁcantly different
ratios, including the US and France, the two countries other than
India with a high number of responders; users in the US respond
to the self-propagation spam substantially more than pharmaceuti-
cal spam, and vice-versa with users in France. These results sug-
gest that, for the most part, per-country differences in response rate
are due to structural causes (quality of spam ﬁltering, general user
anti-spam education) rather than differing degrees of cultural or na-
tional interest in the particular promises or products conveyed by
the spam.