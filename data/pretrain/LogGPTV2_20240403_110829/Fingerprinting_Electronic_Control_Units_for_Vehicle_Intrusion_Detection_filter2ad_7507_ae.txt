### 5.3 Defending Against Masquerade Attack

We now evaluate the performance of CIDS in detecting a masquerade attack.

#### CAN Bus Prototype
To evaluate CIDS’s defense against the masquerade attack in the CAN bus prototype, nodes A and B were considered to have been compromised as strong and weak attackers, respectively, as shown in Fig. 2(c). Node A was programmed to mount a masquerade attack on node B, i.e., stop B from transmitting message 0x55 and instead send it through A, once \( T_{\text{masq}} = 250 \) seconds had elapsed. As usual, messages 0x11 and 0x13 were periodically sent by A, and CIDS was run by R.

**Figure 8(a) (left)** shows the Probability Mass Function (PMF) of the intervals of message 0x55 before and after the attack. In contrast to the fabrication attack, since the attacker sent the attack message at its original frequency after masquerading, the distribution did not deviate much from that before the attack. However, at \( T_{\text{masq}} \), there was a slight delay when the transmitter was switched from one node to another, causing the first masquerade attack message to be sent 51.04 ms after its previous transmission, whereas it should have been approximately 50 ms, which is the preset message interval for 0x55. This mistimed masquerade attack resulted in an abnormal deviation in the PMF graph. We will later evaluate a perfectly timed masquerade attack—a more severe case—on a real vehicle and show the efficacy of CIDS in detecting it.

The resulting changes in \( O_{\text{acc}} \), \( L^+ \), and \( L^- \) at R are also shown in **Figure 8(a) (middle and right)**. The change in the ECU transmitting message 0x55 caused the slope (i.e., clock skew) in the \( O_{\text{acc}} \) graph to change after the attack. Since the measurements of \( O_{\text{acc}} \) after \( T_{\text{masq}} \) significantly deviated from their expected values, which are determined by the estimated clock skew, CIDS detected the intrusion.

#### Real Vehicle
To replicate a timed masquerade attack, we programmed R to modify its message acceptance filter from only accepting 0x1B0 to only accepting 0x1A6. Since 0x1B0 and 0x1A6 were observed to be always transmitted nearly at the same time, this setting replicated the timed masquerade attack. During this process, B continuously logged 0x1B0 to provide a reference for circumstances when no attacks are mounted.

**Figure 8(b) (left)** shows the PMF of the message intervals of 0x1B0 before and after the attack. Since the message periodicity remained the same, the distribution of the message intervals did not change. Moreover, since we considered a timed masquerade attack, there were no abnormal message intervals, indicating that state-of-the-art IDSs, which try to find abnormal message frequencies, cannot detect such an attack. However, due to the change in the ECU transmitting 0x1B0 (V2 → V1), the accumulated clock offset exhibited a different trend, i.e., a different clock skew after the attack. The original trend in offset changes was determined by the data obtained from B. As shown in **Figure 8(b) (right)**, CIDS detected a sudden shift in its identification error and thus outputted a high level of CUSUM upper control limit, indicating an intrusion detection.

In conclusion, through its modeling and detection processes, CIDS can detect not only the fabrication attack but also the masquerade attack, thereby providing more comprehensive protection than existing solutions.

### 5.4 Message-pairwise Detection

We evaluate the feasibility and efficiency of message-pairwise detection in CIDS. To validate its practicability in the real world, we first examine whether there exist pairs of messages inside real vehicles with correlated clock offsets—the condition for CIDS to run message-pairwise detection.

**Figure 9(a)** shows two cases of correlated and uncorrelated clock offsets of in-vehicle messages collected from the Honda Accord 2013. **Figure 9(a) (left)** shows that the average clock offsets of messages 0x1B0 and 0x1D0, which were determined to have been sent from the same ECU, showed a high correlation of 0.9213, i.e., a linear relationship. In contrast, as shown in **Figure 9(a) (right)**, the average clock offsets of messages 0x1B0 and 0x1A6, which were determined to have been sent from different ECUs, showed a low correlation of 0.0026, indicating no significant linear relationship.