 It’s LVM and you need to process it for
deleted files – so you need to “unwrap” it.
 Create a Qemu disk
 qemu-img create myimage.img 1G
 Boot in Qemu with Helix
 qemu -L . -cdrom Helix.iso -hdb lvm.dd -hda myimage
  –boot d
DC3 – Data Carving
 Find volume and make active
 Pvscan
PV /dev/hdb  VG VolGroup00  lvm2 [896.00 MB / 32.00 MB
free] Total: 1 [896.00 MB] / in use: 1 [896.00 MB] / in
no VG: 0 ]
 Vgchange –ay VolGroup00
1 logical volume(s) in volume group "VolGroup00" now
active
DC3 – Data Carving
 Make an image
 dd if=/dev/VolGroup00/LogVol00 of=dev/hda
1769472+0 records in
1769472+0 records out
905969664 byes (906 MB) copied 617.905 seconds, 1.5 MB/s
 Now we see it as ext3 filesystem
 2 folders, root and Lost+Found
DC3 – Data Carving
 Root sector (physical sector 4408)
contained:
 020000000c0001022e000000020000000c0002022e2e000
00b000000e80f0a026c6f73742b666f756e6400000c0000
0018000f012e726561646d652e7478742e737770000d000
000bc0f0a01726561646d652e747874742e0e000000a80f
0f012e726561646d652e7478742e73777800
 Sorry – text, please
DC3 – Data Carving
 Root sector (physical sector 4408)
contained our next lead, the names of
deleted files:
 ......................
......lost+found.. ........readme.txt.swp.
   ......readme.txtt..........readme.txt.swx.................
 Running down the wrong path, like I seem
to do often – this is a data carving
challenge – so…
Data carving means Scalpel (foremost),
reading up on magic recovery and FTtimes.
DC3 – Data Carving
 Lots of files – no help, sifting through all
files found with all signatures on.
 Then it hits me!  .readme.txt.swp
 Scour the Internet for the magic of vi/vim
swap files.
 Look high and low for the format of vi/vim
swap files.
DC3 – Data Carving
 No real luck - so I just created one myself!
vi readme.txt
kill `pidof vi`
 Read the file in hex and the magic is:
62 30 56 49 4D 20 36 2E 33
b  0  V  I  M     6  .  3
DC3 – Data Carving
 Not wanting to miss on version, I choose
62 30 56 49 4D (b0VIM)
Got 4 hits!
 Root /home/readme.txt
 Root /etc/mail.helpfile
 Root /test/readme.txt
 Root: /boot/grub/menu.lst
DC3 – Data Carving
 Challenge solved:
 b0VIM
6.3........$.D...$U..root............................
........localhost.localdomain.................../home
/readme.txt....
  .Water is a refreshing beverage!
DC3 Digital Forensic Challenge
 Metadata Extraction
 Examiners must develop and document a
methodology used to recover the contents of several
files. These files will vary in type and the information
will be found in several different metadata standards.
Clues will be given to help participants know what to
look for in each file.
 Total Weighted Points: 200
DC3 – Metadata Extraction
 Metadata
Data about data – information about data.
Yes, you can be data and metadata at the
same time.
 The challenge – 13 files and 23 questions.
 5 .jpg, 1 .gif, 1 .eps, 1 .raw, 1 mp3, 1
.mov, 1 .wav, 1 .ra.
DC3 – Metadata Extraction
DC3 – Metadata Extraction
5.7 mm
Focal Length
F5.7
Aperture Value
F5.5
F-Number
1/500 sec
Exposure Time
© by Caplio Pro G3
Copyright
Datum point
YCbCr Positioning
1/72 inches
Resolution Unit
1/72 inches
Y Resolution
1/72 inches
X Resolution
2003:11:13 15:53:45
Date/Time
Top, left side
Orientation
Caplio Pro G3
Model
RICOH
Make
61 metadata datums found!
WGS-84
GPS Map Datum
True direction
GPS Track Ref
0
GPS Speed
Knots
GPS Speed Ref
Measurement in progress
GPS Status
27,13,10
GPS Satellites
19:59:14 UTC
GPS Time-Stamp
402 meters
GPS Altitude
117:15’51.87
GPS Longitude
W
GPS Longitude Ref
34”9’40.69
GPS Latitude
N
GPS Latitude Ref
2222
GPS Version ID
DC3 – Metadata Extraction
 SA Trent Beckett Googled, Googled, Googled.
Primary types of metadata types located
 ID3 – de facto format for MP3 files.
 EXIF – Exchange Image File Format, a primary
image metadata format
 TIFF – Tagged Image File Format, image
metadata format.
 OLAP – Business Intelligence metadata
 XML – Human readable metadata
DC3 – Metadata Extraction
 We looked at many tools, but found a clear
winner that was able to identify 12 of 13 files.
 EXIF extractor written in perl by Phil Harvey.
http://owl.phy.queensu.ca/~phil/exiftool/
Updated as of 7/6/2007!
Supports EXIF, GPS, IPTX, XMP, JFIF,
GeoTIFF, ICC Profile, Photoshop IRB,
FlashPix, AFCP, ID3 + more.
DC3 – Metadata Extraction
 Remaining file was the .gif file.
 Used ImageMagick’s identify program.
 Sample questions
 Q: test9.mp3 - What are the MS stereo and intensity stereo settings?
 A: MS Stereo = ON, Intensity Stereo = OFF
 Q: test12.wav - What type of encoding is used?
 A: Microsoft PCM (Package Command Manager)
 Q: test1.jpg - What is the dateiname?
 A: Dateiname (German for file name) is: DSCN1767.JPG
DC3 Digital Forensic Challenge
 Secret Bonus
Examiners have an opportunity to discover
the “secret bonus” and be awarded additional
bonus points.  Clue:  “You’ll know it when
you see it”
Total Weighted Points: 300
DC3 – Secret Bonus
 All or nothing, 36% got full points (9 in 25)
AccessData, 0x28 Thieves, Hoya Haxa,
Code Monkeys, Factor / Phaktor, Digital
Lazarus, rm –rf sobriety, nameless, Diverse
Digital Detectives got the 300.
 Top 5 Scoring
 AccessData, 0x28 Thieves, Hoya Haxa got 300
points.
DC3 – Secret Bonus
 “You will know it when you see it”
 We saw it – right away!
DC3 Digital Forensic Challenge
 It’s the binary, of course!
0111001001111010011011100111011001111001001000000111000101110000001100
110010000001100111011101010111011001100110001000000110011001110010
011100000110010101110001011001110010000001101010011000100110010101
1100010011101000100000011101010110100001111010011110100111001001100101
 I like breaking codes, but do not seem to
be very good at it – but this one is really
easy!
DC3 Digital Forensic Challenge
 Binary to ASCII
 "rznvy qp3 guvf frpeqg jbeq: uhzzre" .
 First thought was:
Monoalphabetic = simple substitution.
Based on the 3 and “:” + looks.
DC3 Digital Forensic Challenge
 Tools I like are:
Cryptomx - http://cryptomx.sourceforge.net/
DC3 Digital Forensic Challenge
 CryptoHelper
http://sourceforge.net/projects/cryptohelper/
DC3 Digital Forensic Challenge
CryptoMX did the convert from binary.
 It does a lot more that converting.
 I used it to break the playfair Shmoocon
encryption challenge – after I blew all kinds of time
working it on paper.
CryptoHelper for frequency analysis.
 Confirmed monoalphabetic
 Also has a nice feature – “Run the Alphabet”
 ROT 1-26
DC3 Digital Forensic Challenge
 rznvy qp3 guvf frpeqg jbeq: uhzzre
 dlzhk cb  sghr rdbqcs vnqc  gtlldq
 email dc3  this secrdt word:  hummer
 fnbjm ed  uijt tfdseu xpse  ivnnfs
 gockn fe  vjku ugetfv yqtf  jwoogt
 hpdlo gf  wklv vhfugw zrug  kxpphu
 iqemp hg  xlmw wigvhx asvh  lyqqiv
 jrfnq ih  ymnx xjhwiy btwi  mzrrjw
 Oh, ROT13.
DC3 Digital Forensic Challenge
 Keylog Cracking
 Examiners must develop and document a
methodology used to recover the contents of an
encrypted keylog file. The keylog file can be found in
the Keylog Cracking folder. You will be expected to
develop a method to effectively decrypt and recover
the contents of the keylog files. Points will be
awarded for your proof of analysis by means of your
methodology.
 Total Weighted Points: 250
DC3 – Keylog Cracking
 No team got full points!
 20% got partial points (5 in 25).
4 teams got 200 points of 250 (80%).
1 team got 100 points of 250 (40%).
Top 5 Scoring
 AccessData, 0x28 Thieves, Professionals got 200
points.
DC3 – Keylog Cracking
 Hello Google…
 Search for common key loggers
 Create sample logs using ~10 apps
 Actual Spy logs had striking resemblance to the
challenge logs…lets give it a try
 Substitute the encrypted challenge logs into the
keyloger’s default output path (individually)
 Fire up the application…voila
 Default Settings: encrypt logs w/o password
* Content provided by “The Professionals” (3rd Place Team, Florida State University) *
DC3 – Keylog Cracking
* Content provided by “The Professionals” (3rd Place Team, Florida State University) *
 Screen Capture of “keylog1.dat” once decrypted
DC3 Digital Forensic Challenge
 Image Analysis: Real vs. CG
 Examiners must develop and document a
methodology used to determine whether the images
in the Image Analysis folder are real or computer-
generated (CG). You will be expected to identify the
nature of each picture. Points will be awarded for
each successfully identified picture provided you
supply a detailed methodology of how you derived
your conclusion. Points will not be awarded for
guessing.
 Total Weighted Points: 200
DC3 - Image Analysis: Real vs.
CG
 No team got full points!
 24% got partial points (6 in 25).
 1 team got 170 points of 250 (68%).
 1 team got 150 points of 250 (60%).
 1 team got 140 points of 250 (56%).
 Remaining teams got 80, 70, 55.
 Top 5 Scoring
 Professionals got 150, with a really solid methodology.
 Hacker Factor (Dr. Krawetz) got 80.
 Props to Blue Blood Alpha (Penn State, 22 place)
for the high score!
DC3 - Image Analysis: Introduction
 “Real” - images captured by cameras
 May be altered by digital camera software
 Scanned in from actual film prints
 “CG” - images created or modified by graphics
or photo editing software
 Adobe Photoshop, Autodesk Maya, etc.
Where do we begin…?
Assume all images are innocent (Real)
until proven guilty (CG).
* Content provided by “The Professionals” (3rd Place Team, Florida State University) *
DC3 - Image Analysis: A Challenging Task
 Visual inspection is subjective
 Important part of overall examination process
 Human eye instinctively detects real from fake
 Statistical Tests have an advantage
 Ability to offer unbiased results based on forensically
sound and replicable procedures