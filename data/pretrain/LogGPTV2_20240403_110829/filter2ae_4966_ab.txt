# 5月30日
## Advancing Windows Security
演讲嘉宾:David Weston@Microsoft
Windows的安全性正在不断增强，平台功能正在快速变化。为了更好地应对新式攻击，Windows
也在快速变革。我们的的目标在于跨越不断成长的威胁模型并提供更强大的保障。欢迎研究人员和社区帮我们继续完善。漏洞赏金和征集缓解措施的项目非常重要。我们希望与中国及更多地区的研究人员群体共同努力，更好地了解当前和未来的攻击。
议题PPT下载:[中文版](https://images.seebug.org/archive/Advancing_Windows_Security-CN.pdf "中文版") &
[英文版](https://images.seebug.org/archive/Advancing_Windows_Security-EN.pdf
"英文版")
## Exploring the Maze of Memory Layouts Towards Exploits
演讲嘉宾：Yan Wang & Chao Zhang@Chinese Academy of Sciences & Tsinghua University
漏洞利用生成的障碍之一是内存布局操作。大量的内存损坏漏洞（例如，堆溢出和UAF）只能在特定的内存布局中被利用。在实践中，它需要人力来操纵内存布局。因此，自动内存布局操作是一个有趣的主题，它可以为自动利用生成(AEG)铺平道路。在这次演讲中，我们介绍了我们的解决方案Maze，它能够将PoC样本的不可利用内存布局转换为可利用的布局，并在可能的情况下自动生成各种可用的漏洞。首先，它应用程序分析技术来识别代码片段（表示为内存操作原语），这些代码片段可以执行内存（de）分配操作，并且可以根据需要进行重新输入和调用。然后，它应用一种新的算法Dig
&
Fill，按一定的顺序调用这些内存操作原语来精确地操作内存布局。我们实现了一个基于二进制分析引擎S2E的Maze原型，并在一组带有堆溢出和UAF漏洞的CTF（捕获标志）程序上对其进行了评估。实验结果表明，Maze可以将30个PoC样本的内存布局转换为可利用状态，并成功生成大多数PoC样本的漏洞利用样本。
## Needle in A Haystack: Catch Multiple Zero-Days Using Sandbox
演讲嘉宾：Qi Li & Quan Jin@Qihoo 360
在过去几年中，我们一直在开发沙箱检测技术，以探索如何使用沙箱来检测和过滤样本，并发现高级威胁。在此过程中，我们继续改进自动分析平台，并在过去两年中发现了多个零日漏洞。在本次演讲中，我们介绍了我们的沙箱平台，并描述如何从头开始构建Office零日检测系统，并最终捕获多个与Office相关的零日漏洞。我们还分享了我们在Windows内核和其他漏洞检测中的做法，以及如何使用沙箱自动过滤特殊样本。
议题PPT下载：[中文版](https://images.seebug.org/archive/Catch_Multiple_Zero-Days_Using_Sandbox-CN.pdf "中文版") &
[英文版](https://images.seebug.org/archive/Catch_Multiple_Zero-Days_Using_Sandbox-EN.pdf "英文版")
## How to Find Twelve Kernel Information Disclosure Vulnerabilities in Three
Months
演讲嘉宾：Tanghui Chen@Baidu,Inc
本次演讲分享了一种轻量级、高效的内核信息泄露漏洞的检测方法。有两种方法在业界取得了显著的成果，一种是Mateusz
Jurczyk的BochsPwn，来自Google Project
Zero，另一种是潘剑锋的DigTool。BochsPwn使用CPU指令模拟技术，其性能非常差。DigToolcai采用重量级VT技术。在深入研究内核信息泄露漏洞后，我们发现其本质是内核将一些未初始化的数据复制到用户模式的内存中，导致信息泄露。另外，我们在Windows内核中积累了大量技术。在找出漏洞的原因后，我们提出了一种检测漏洞的新方法。该方法由许多不同的技术实现，如内核nirvana和hook，可以快速检测内核信息泄漏。在过去的三个月中，已经发现了12个Windows内核信息泄露漏洞，这证明了这种方法非常有效。
议题PPT下载：
[中文版](https://images.seebug.org/archive/How_to_Find_Twelve_Kernel_Information_Disclosure_Vulnerabilities_in_Three_Months-CN.pdf "中文版") &
[英文版](https://images.seebug.org/archive/How_to_Find_Twelve_Kernel_Information_Disclosure_Vulnerabilities_in_Three_Months-EN.pdf "英文版")
## Momigari: Overview of the Latest Windows OS Kernel Exploits Found in the
Wild
演讲嘉宾：Boris Larin & Anton Ivanov@Kaspersky Lab
Momigari（红叶狩猎）是日本人在秋天寻找最美丽的树叶的传统。在2018年秋季仅仅一个月的时间里，我们发现了一些针对Microsoft
Windows操作系统的零日攻击。其中两个针对最新且完全更新的Windows 10 RS4，在此之前，Windows 10
RS4还没有已知的内存损坏漏洞。我们还发现了一些漏洞，这些漏洞在安全更新时无意中得到了修复，但在此之前很长一段时间内都没有补丁。这些研究结果表明，漏洞利用编写者将继续寻找可靠地利用不稳定漏洞的新方法，并绕过最安全的操作系统的现代缓解技术。其中最有趣的是，大多数漏洞都是相互关联的。这表明他们背后的策划者并不害怕一次浪费大量的零日漏洞，因为他们的军火库已经满了。在本次演示中，我们研究了多个在野特权提升（EOP）零日漏洞，并揭示了这些漏洞采用的开发框架。这个框架可以带有多个漏洞利用程序（嵌入或从远程资源接收）。每个漏洞利用都提供了可执行内核shellcode的接口。在本次演示中，我们分享以下内容：
\- 深入分析用于零日漏洞利用开发的框架 \- 深入分析攻击者使用的漏洞 \- 用于绕过漏洞利用缓解机制的有趣技术。
议题PPT下载：[中文版](https://images.seebug.org/archive/Overview_of_the_Latest_Windows_OS_Kernel_Exploits_Found_in_the_Wild-CN.pdf "中文版") &
[英文版](https://images.seebug.org/archive/Overview_of_the_Latest_Windows_OS_Kernel_Exploits_Found_in_the_Wild-EN.pdf "英文版")
## New and Effective Methods to Probe Vulnerabilities in Hardware Devices
演讲嘉宾：Shupeng Gao@Baidu,Inc
我们如何才能更有效地探测智能设备的漏洞？虽然智能设备在品牌，外观和功能上有所不同，但它们都具有类似的结构：CPU \ memory \ storage \
input \
output，因此我们可以应用类似的方法来分析和发现它们的漏洞。在本次演讲中，我们展示了几种新的有效漏洞探测技术和工具，包括：使用编程器和焊接设备读写闪存芯片，如SPI闪存/
NAND闪存/ EMMC和EMCP（超过95％的智能设备使用这三种）；获取root shell的各种方法，包括修改U-boot内核参数，通过CPU数据表确定串口以及在线和离线编辑flash；介绍各种网络连接的嗅探和编辑方法，包括WiFi实时解密，挂机模式和GPRS中间人攻击。然后，我们展示了如何组合这些方法，并最终发现控制设备中的高风险漏洞。这些技术非常有效。在过去的三年里，他们帮助我们在中国赢得了六次硬件设备破解比赛(Geekpwn,
Xpwn)。最后，我们提出了有效提高硬件设备安全性的想法和建议。
议题PPT下载：[中文版](https://images.seebug.org/archive/New_and_Effective_Methods_to_Probe_Vulnerabilities_in_Hardware_Devices-CN.pdf "中文版") &
[英文版](https://images.seebug.org/archive/New_and_Effective_Methods_to_Probe_Vulnerabilities_in_Hardware_Devices-EN.pdf "英文版")
## Browser Script Engine Zero Days in 2018
演讲嘉宾：Elliot Cao@Trend Micro
浏览器是进入互联网世界的窗口，脚本使其更加丰富多彩。因为大多数脚本语言都是动态的、弱类型的，并且不需要考虑内存管理，所以人们可以轻松地开发浏览器应用程序。这一切都归功于脚本引擎。但复杂的脚本引擎似乎很脆弱。2018年，我们看到了一些基于这些脚本引擎（例如Flash，VBScript和JScript）的在野零日攻击。本次演讲包含以下内容：首先，我们对2018年的浏览器脚本引擎漏洞进行快速的回顾，主要是在野零日漏洞攻击。其次，介绍我们自主开发的工具VBSEmulator，它可以对vbs混淆的样本进行反混淆处理，并检测GodMode或ROP。最后，快速浏览用于Microsoft
Edge的JavaScript引擎Chakra，并解释如何在Chakra中进行利用。
议题PPT下载：
[中文版](https://images.seebug.org/archive/Browser_Script_Engine_Zero_Days_in_2018-CN.pdf
"中文版") &
[英文版](https://images.seebug.org/archive/Browser_Script_Engine_Zero_Days_in_2018-EN.pdf
"英文版")
## Fighting Malicious Insider Threat with User Profile Based Anomaly Detection
演讲嘉宾：Lei He@Microsoft
心怀不满的恶意内部人员仍然是Microsoft和Office 365的主要威胁之一。成千上万的员工和供应商全天候运营Office
365服务;心怀不满的员工或受损的凭证可能导致未经授权的数据访问和盗窃，且渗透测试人员经常对O365模拟这些威胁。虽然基于渗透测试的监督学习涵盖了已知的模式，但苏州的M365安全团队开发了一种近乎实时的异常检测来覆盖未知的威胁。该模型基于操作员历史活动数据中心概况，在运用了多种实用技术进行细化的情况下，其精度达到了90%。
议题PPT下载： [中文版
](https://images.seebug.org/archive/Fighting_Malicious_Insider_Threat_with_User_Profile_Based_Anomaly_Detection-CN.pdf "中文版 ")&
[英文版](https://images.seebug.org/archive/Fighting_Malicious_Insider_Threat_with_User_Profile_Based_Anomaly_Detection-EN.pdf "英文版")
## Discovering Vulnerabilities with Data-Flow Sensitive Fuzzing
演讲嘉宾：Shuitao Gan & Chao Zhang@State Key Laboratory of Mathematical Engineering
and Advanced Computing & Tsinghua University
我们认为数据流对于探索复杂的代码（例如，校验和和幻数检查）以及发现漏洞非常有用。在本次演讲中，我们介绍了基于数据流控制的fuzzer工具GreyOne。首先，它利用数据流的经典特征——污点——来指导模糊测试，例如，确定要修改的字节以及如何修改。然后，它使用数据流的新特性——约束一致性——来调整模糊的演化方向，例如，有效地满足未触及分支的约束。为了支持这些数据流特性，我们提出了一种轻量级且可靠的模糊驱动污点推断(FTI)来推测变量的污点。评估结果表明，GreyOne在代码覆盖率和漏洞发现方面都优于各种先进的fuzzer(包括AFL、Honggfuzz、VUzzer和CollAFL)。其总共发现了105个新的安全漏洞，其中41个被CVE确认。
* * *