a pre-ﬁltering system, though a more extensive study on a larger
dataset is needed.
Evaluation on the whole dataset. Then we ran Eyeson on all col-
lected HTTP trafﬁc covering 5.4 years (Table 2), a total of 14M
snapshots for 133,527 monitored URLs, with a clean proﬁle built
per monitored URL. In our experiment, we bootstrapped the pro-
ﬁle for each monitored URL with 10 visits (after initial 5 visits,
the follow-up 5 for collecting change rates), and ran Eyeson over
all the snapshots gathered in the order of their dates. The proﬁle
change rate series was reset at the beginning of every calendar year
or whenever a time gap over 3 months was found (due to the miss-
ing data in the archive). We utilized a 95% conﬁdence interval to
scan the collected HTTP trafﬁc based on the timeline of the snap-
shots (from both the archive and the real time visits).
Altogether, Eyeson detected 1.7M snapshots (aka, visits) whose
changes were considered to be signiﬁcant, detailed in Appendix
A and Table 10. These changes corresponded to 2.7M URLs (i.e.
embedded links) hosted on 17.6K FQDNs (not the FQDNs under
monitoring) and 456 static IP addresses.
Eyeson, at its current state, is used as a measurement methodol-
ogy to ﬁnd more watering hole instances but is not ready as a full
blown organizational pre-ﬁlter. That being said, Eyeson does have
the potential to work as a pre-ﬁltering system given the proper mod-
iﬁcations and organization level evaluations. Looking at the toxi-
city levels (i.e. fraction of conﬁrmed alerts), Eyeson outperforms
Evilseed [35] where Eyeson has a 3.4%-7.4% conﬁrmed malicious
domains vs 1.12% by Evilseed. A closer look at Eyeson 2.0 is pro-
vided in Appendix A.
Finding compromised websites. As the system was run on 5.4
years of trafﬁc, a large number of visits were detected as suspi-
cious. Some changes were false positives which is attributed to
either legitimate changes (such as upgrade of website design and
templates), ad related URLs that were not covered by the white
lists (particularly when these scripts were hosted on the monitored
domain itself, e.g. OpenX ad platform) or malformed URLs. Also,
the content related to many of the detected change URLs was miss-
ing from the archives making their legitimacy difﬁcult to verify.
To screen out the outputs for new watering holes, we ﬁrst utilized
a multi-step validation process to conﬁrm that a subset of reported
visits were indeed compromised. This validation process includes
blacklist cross matching, URLs and content scanning with Virus-
Total [62] and lastly automated labeling and manual analysis.
Speciﬁcally, we ﬁrst cross matched the detected changes with a
number of blacklists (Table 2). Since the HTTP trafﬁc we collected
is often related to website snapshots that go back a few years, the
compromises involving those sites may have already been detected
and reported to blacklists. Therefore, to ﬁnd malicious (or com-
promised) domains we collected the history of several blacklists
(covering suspicious sub-domains, IP addresses and URLs) from
the archives whenever available and utilized them to validate de-
tected domains and their snapshots. Also used in our validation
Usage
Monitoring
Type
Source
Archive and real time HTTP trafﬁc Manual
Archive HTTP Trafﬁc
White listing
Ad/tracker Lists
Popular 3rd Party services
Generalized URLs
Result Validation
Sub domains
IP Addresses
Enterprise selected set
EasyList[52]
PGL[1]
MVPS[8]
Enterprise Logs
CleanMX[13]
Malc0de[6]
MalwareDomainsList[7]
MalwareDomainsList[7]
MalwareDomains[3]
HPHosts[5]
Malc0de[6]
MalwareDomainsList[7]
Project HoneyPot[9]
Duration
Jan 1, 2010 - May 9th, 2015
Jan, 2012- Aug, 2014
Aug, 2011 - April, 2015
Feb, 2003 - Feb, 2015
May, 2011 - April, 2015
Jan,2014 - Aug, 2014
1st Jan, 2009 - 25th April,2015
21st Sept, 2010 - 19th March, 2015
21st Sept, 2010 - 19th March, 2015
26th June, 2008 - 15th March, 2015
17th June, 2011- 19th April, 2015
5th Dec, 2009 - 12th Jan, 2015
22nd March, 2011 - 3rd Aug, 2013
8th May, 2010 - 10th April, 2015
22nd Jan, 2014 - 24th April, 2015
Size
FQDN:178 Monitored URLs:57,006
FQDN:61,616 Monitored URLs:76,521
Lists:228
Lists:239
Lists:38
Sub domains: 1982
Total generalized URLs:23,362,239
Total sub domains:1,902,001
Total IP addresses:134,639
Table 2: Eyeson collected data sets which are used for different purposes.
aei.org anthem.com cartercenter.org cfr.org cgdev.org dphk.org vfw.org
forbes.com gokbayrak.com iie.com iphonedevsdk.com jpic.gov.sy thaingo.org
jquery.com kcna.kp peoplepower.hk phonedevsdk.com procommons.org.hk
rsf-chinese.org rsf.org sem.dol.gov spacefoundation.org ned.org adpl.org.hk
princegeorgescountymd.gov rocklandtrust.com ndi.org rferl.org hkgolden.com
Table 3: 29 Reported watering holes. Other reported watering hole attacks did not
name the watering hole website.
was CleanMX virus watch [13], which maintains a large number
of URLs. Many of them are legitimate domains that were com-
promised for short periods of time. To avoid false positives when
using CleanMX lists, we linked the blacklisted URLs to the dates
they were reported to be compromised before using them for cross
matching.
Secondly, we leveraged VirusTotal [62] which provides an API
allowing users to scan either URLs or ﬁles. Over the output of Eye-
son, we scan URLs and ﬁles with VirusTotal with the exception of
cloud related URLs. VirusTotal ﬂags most cloud related URLs as
malicious, based upon the reports of one or two Anti-virus sys-
tems. For example, the URLs https://4sqstatic.s3.amazonaws.com/
....js and s3.amazonaws.com are ﬂagged as malicious regardless of
the content. To avoid false positives in this case, we only used
VirusTotal to validate cloud related URLs when their content was
available and could be scanned.
In order to maximize the chance to ﬁnd new watering hole cases,
we further considered suspicious those unconﬁrmed URLs indicat-
ing the hosting status as currently parked, currently down, using
DDNS or url shortner, cloud related hosting or using static IPs.
After that we clustered the new URLs observed according to their
patterns (i.e., the tokenized sequence including paths, ﬁle names,
other parameters without values). We further cluster the detected
monitored domains by frequency of changes. Finally, we randomly
selected from the clusters suspicious change cases for a manual
analysis.
In our study, we were able to conﬁrm many compromised do-
mains in this way, many of which turned to be watering holes as
explained next. Note that such a manual step is important as water-
ing holes are rarely caught by blacklists and VirusTotal especially
for recent ones (2014 and later).
Finding new watering holes. As a result of this three step valida-
tion process, we generated a set of conﬁrmed compromised visits
corresponding to 3.2K monitored FQDNs, details are shown in Ta-
ble 10.
After such local validation, we get to the point where we have
to answer the most difﬁcult question for our research: how to de-
termine whether any of these conﬁrmed compromises is indeed a
watering hole attack? The question is difﬁcult since we need to ﬁg-
ure out the perpetrator’s intention, which can only be done by com-
paring the compromises with other known cases, looking for the
attackers’ ﬁngerprints, leveraging various cyber intelligence, and
other means not available to the public. Therefore, the only thing
we could do is to forward our ﬁndings to leading industry agen-
cies that have experiences in watering hole analysis for a cross-
agency validation. Note that even for the parties indeed having
this capability, the validation process is complicated, painful and
time consuming, largely depending on individual analysts’ experi-
ences. As a simple example for the complexity of the issue, the site
iphonedevsdk.com was compromised twice, one in 2010 and the
other in 2014. The second one was conﬁrmed to be a watering hole
attack aiming at Apple and Google employees [48], while the ﬁrst
one turns out to be a random opportunistic compromise in which
the attacker placed a Trafﬁc Direction System (TDS) there.
Due to the high cost of this validation process, it is impossible
for us to dump all 3.2K FQDNs to our industry partner (which
is a leader on watering hole analysis). What we did is to hand-
pick a few likely instances from all these conﬁrmed attack cases.
For example, we randomly selected a few compromised domains
conﬁrmed by VirusTotal or the blacklists if the attacks are marked
as “exploit”. Also, from all the manually conﬁrmed domains we
picked out those whose suspicious changes happened recently and
are therefore more likely to be validated using the data available.
In the end, we forwarded 30 FQDNs to our industry partner, which
together with other organizations, has analyzed so far 20 of them
in the past 3 months, and conﬁrmed 7 new watering hole attacks.
Among them is the high proﬁle JSONP attack (Section 4.1), a po-
litically oriented case which was later reported in the media [23,
58, 51, 64].
Furthermore, we searched all the suspicious URLs (for those
3.2K domains), looking for the IoCs of known watering holes (e.g.,
ScanBox), with the hope to ﬁnd new instances of known watering
hole attacks. As a result, we were able to ﬁnd an additional 10 new
unreported watering holes.
4. UNDERSTANDING WATERING HOLES
4.1 Results Overview
Landscape. As a result from the previously described manual
validation and collaborations with our industry partners we have
conﬁrmed 17 new unreported watering holes corresponding to 16
FQDNs, with one domain being strategically compromised twice.
Finding as many as 17 watering hole attacks is considered a big win
in the research on targeted attacks as they are quite infrequent and
stealthy, and therefore rarely found and conﬁrmed. Our new dis-
coveries increase the publicly-available attack instances by 59%.
#
Domain
hsl.gov.in
1
boxun.com*
2
3 peacehall.com
4
ibsahq.org*
5
6 rsf-chinese.org
7 civilhrfront.org
8
9
hnn.hk
Alexa
Rank G/L
450K/50K
35K/7K
225K/-
10M/-
NA
3M/-
NA
Domain
Description
Data
Set
Indian shipyard
Chinese online news service (NGO)
Chinese online news service (NGO)
Enterprise
Manual
Manual
International buddhism sangha association(NGO) Sinkhole
Sinkhole
Chinese reporters without borders association Manual
Manual
Chinese civil human rights front (NGO)
Chinese news agency
(NGO)
cartercenter.org 150K/62K
Human rights organization (NGO)
Manual &
Enterprise
10
iie.com
hkba.org
400K/232K Peterson Institute for International Economics
406K/3K
Hong Kong Bar Association
(NGO)
youpai.org
Manual
11
10M/- Hong Kong pro-democratic organization (NGO) Manual
12 alliance.org.hk
Manual
2M/-
13
Manual
14
5M/-
Manual
15spaceleaders.com 4M/-
16
23M/-
Enterprise
Manual
17 pomail.gov.mm
Mannarino Systems & Software, Inc
and commercial markets worldwide
Myanmar president ofﬁce mail
Infrared supplier to military
Chinese conservative voice
Personal Blog
scdusa.com
mss.ca
-
1
–
–