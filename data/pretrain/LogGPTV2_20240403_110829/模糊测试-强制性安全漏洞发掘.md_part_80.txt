·STUN-通过网络地址解析器（NAT）进行的简单的用户数据报协议（UDP）的传输
·DHCP-动态主机配置协议
beSTORM可以运行在Windows、
UNIX以及Linux平台上，并且具有单独
的测试和监视组件.我们希望在下一
21613
代的商业模糊测试工具中包含目标监视
组件。对于beSTORM而言，其中的监视
组件只是作为一个定制的调试器而创建
的，并且局限于UNIX和Linux平台，图
5
26-1显示了beSTORM的一个屏幕快照。
26.1.2BreakingPoint系统BPS-1000@
作为该领城最新的一个工具，Break-
Point在纯通信的市场中占有明显的统治
图26-1安全性测试工具beSTORM
地位。BPS-1000是一个定制的硬件解决
方案，它能够以每秒钟生成500000个TCP会话的速度生成超过5百万个TCP会话，尽管从传统
意义上来讲它并不是一个模期器，但是BPS-1000能够对所生成的通信进行变异，从面实现检
测错误的目的。
出全安
MROT2
图26-2BreakPoint系统BPS-1000
BPS-1000最有趣的特性之一是前端的AC适配器，其作用是当目标测试设备无法继续进行
测试时，它负责向其提供动力循环。
26.1.3 Codenomicon@
可以证明，Codenomicon提供了最广为人知的软件模糊测试解决方案，Codenomicon最初
来源于PROTOS测试套件，该套件最初是由芬兰Linnanmaa的Oulu大学所发起的一个项目所
开发的。PROTOS首次获得广泛的公开是在2002年后期，当时该项目发布了一个令人惊讶的、
http:/www.beyondsecurity.com/beSTORM_FAQ.pdf
http:/www.breakingpointsystems.com/
③http/www.codenomicon.com/
@ htt:/www.ce.oulu.fi/research/ouspg/protos/
---
## Page 374
第26章展望359
关于在多种不同的SNMPv1实现中的漏洞列表。PROTOS的开发者对SNMPv1协议进行了解析，
并且列举出了针对请求和捕获包的所有可能的变换。然后，他们开发了一个实际的事务集合井
人”。在某些情况下，这些异常元素违反了协议标准，而在其他情形中，它们与协议规范是
一致的但是却包含破坏解析器的内容，PROTOSSNMPv1测试套件的执行结果中保存了非常重
要的信息，因为它们识别出了大量的漏洞，面这将会导致许多受影响的硬件和软件提供商发布
补丁程序。PROTOS项目从此之后就不断地发展，目前它包含针对多种不同的网络协议和文
件格式的测试套件，其中所涉及到的协议如下所示：
·WAP-无线应用协议
·HTTP-超文本传输协议
·LDAPv3-轻量级目录访问协议，版本3
·SNMPv1-简单网络管理协议，版本1
·SIP-会话启动协议
·H.323-视频会议中通常使用的一组协议的集合
·ISAKMP-Internet安全联盟密钥管理协议
·DNS-城名系统
该商业产品内部所使用的测试方法在很大程度上井没有偏离最初的PROTOS。最为特别的
是，该商业测试套件覆盖了大量的网络协议和文件格式，并且还提供了一个友好的GUI界面，
如图26-3所示
E..
图26-3Codenomicon域名服务器测试工具
http:/www.ce.oulu.firesearch/ouspg/protos/testing/c06/snmpv1/index.html#h-ref2
http:/www.cert.org/advisories/CA-2002-03.html
---
## Page 375
360
第四部分展
Codenomicon以溢价为每一个单独的协议提供了一个独立的产品。在撰写本书时，每一个
协议测试产品的零售报价大约是30000美元。这种定价策略表明该公司所面向的是那些只需要
少数几个针对其所研发产品类型的协议测试套件的软件开发者，而不是对测试范围很广的许多
产品和协议都感兴趣的那些纯粹的安全性研究机构。该产品最大的局限就是缺乏目标监视功能。
Codenomicon在测试过程中利用已知的测试用例来获取目标的状态。正如在第24章“智能化错
误检测”中所讨论的，这是一种最基本的监视技术。
26.1.4GLEGProtoVerProfessional
GLEG是一家由于提供了VulnDisco?而建立起来的俄罗斯公司，VulnDisco是一个包含每
月发布新发现的漏洞的服务，而发布的形式是针对Immunity公司的CANVAS可利用框架的开
发模块。后来GLEG将该工具进行了扩展，以包含其自主开发的、被用来发现由VulnDisco产品
所提供的许多漏洞的模糊器。扩展后的产品被称为ProtoVerProfessional，它是采用Python编程
语言来开发的。在编写本书的时候，该模糊器可以支持如下的协议：
·IMAP-Internet消息访问协议
·LDAP-轻量级目录访问协议
·SSL-加密套接字协议层
·NFS-网络文件系统
该测试套件包含多种不同的界面，如命令行、GUI以及基于Web的界面，如图26-4所示。
ProtoVer是由安全问题研究者编写的，并且面向与Codenomicon相同的市场，其目前的定价为
图26-4GLEGProtoVer专业级测试套件的Web界面
htp/www.gleg.net/protover_pro.shtml
ssnpoudnau2a3mmm//.dq
@ http:/www.jimmunitysec.com/products-canvas.shtml
---
## Page 376
第26章展塑
361
4500美元，目的是为所有支持的协议获得一个年度许可。
26.1.5安全性测试工具Mu-40009
MuSecurity所提供的Mu-4000是一个硬件工具，它能够对网络通信进行变异并且可以监
视目标以发现错误。Mu-4000主要被设计为测试其他的网络设备，类似于BreakingPoint解决方
案，它能够为目标设备提供动力循环以从所检测到的错误中进行恢复。Mu-4000的另外一个有
趣的特性是当一个错误被以基于Linux的可执行文件的形式被Mu认为是一个外部漏洞触发器发
现时，Mu4000能够自动生成一个可利用的概念验证工具。Mu声称其设备可以处理任意的基于
IP的协议。图26-5显示了详细描述在一个DHCP实现中所发现异常的一个报告示例。
Fault Detail Report
Mu Securtty
本迎
S.8
图26-5Mu-4000所生成的详细错误报告
强
26.1.6Security Innovation Holodeck
SecurityInnovation的Holodeck是这样一种唯一的软件解决方案，它允许开发者通过模拟非
预期的错误，从而研究针对微软Windows平台所开发的软件中所实现的安全性和错误处理器的
健壮性。这个产品提供了典型的模糊测试功能，如对文件和网络流进行变异的能力。在其所具
备的许多唯一特性中，Holodeck能够触发下列错误：
·当试图访问特定的文件、注册表健和值以及COM对象时所产生的资源错误。
由于受限制的磁盘空间、内存以及网络带宽而引起的系统错误。
Holodeck具有一个比较合理的价格标签，针对单个用户许可为1495美元，并且提供了一个
开放的AP1，允许高级用户在该产品的基础上创建自动化工具和扩展。图26-6显示了Holodeck
主界面的一个屏幕快照。
http://www.musecurity.com/products/mui-4000.html
@htt:/www.securityinnovation.com/bolodeck/
---
## Page 377
362
第四部分展望
 test Holodeck Enterprise Edition
Code CoverageTest Generator.
SressTestGr
D9re
Becord Session
-3
pisk
Reg/aySessios
peanad
YFoit
GN.C
TooSnal
Wrspc
2u图26-6SecurityInnovationHolodeck
上面所列出的公司和产品绝不是所有可用的商业模糊测试解决方案的一个完整的列表。然
而，它表明了在该领城中工业界的发展现状。大多数所列出的解决方案都是相对较新的“第一
个版本”的技术。尽管已经出现了采用模糊测试技术的实际工业应用，但是其发展相对来说还
很不成熟。
26.2发现漏洞的混合方法
我们所讨论的商业模糊器大多提供了适用范围较窄的产品，只关注于发现漏洞的一个特定
的方法。如果我们从对漏洞的研究中得到了一个启发的话，那就是没有任何一个单独的方法是
银弹。所有的方法都具有优点，同时也都具有局限性。
了解了这一点，我们就期望安全性工具的开发要结合多种分析方法。这里所要实现的目标
是要创建这样一个解决方案，即各部分的功能性能之和要大于整体的功能性能。例如，可以考
虑将源代码分析同模糊测试相结合。模糊测试所面临的一个挑战就是要确保足够的代码覆盖。
在一个纯黑盒测试场景中，如何来确保已经对所有可能的输入都进行了模糊测试呢？在第23章
中，我们讨论了将代码覆盖作为一种度量手段以确定模糊测试的完成程度。考虑一下另外一种
可能的方法，即使用混合分析的方法。这种分析方法首先要进行一个自动化的源代码评审。这
种典型的白盒测试方法通常将会发现大量的潜在的漏洞，但是要受到误报的影响，因为它在运
行时不能确认结果的最终形式。这个局限性可以通过下面的方法来解决，即利用静态扫描的结
果来帮助生成模糊测试用例，从而有助于在审核的动态模糊测试阶段中证明或驳厅那些潜在的
漏洞。我们希望模糊测试成为混合型安全保证技术中的一个集成部分。
26.3集成的测试平台
！
安全专家将会一直创建并且接受新的改进的、一次性的以及单机版的模糊器。然而，QA
和开发团队将很少有时间去研究那些复杂的、前沿的安全性工具，因为安全测试总是在扮演一
个辅助的角色，而首先要满足的是开发需求和基线。为了使模糊测试技术在QA和开发团队中
被广泛接受，它必须要面向这些团队已经熟悉并且经常使用的现有平台，我们期望看到模糊测
---
## Page 378
第26章辰里
363
试功能被集成到开发环境中，如微软的VisualStudio和Eclipse。同样，由IBM和Mercury这样的
提供商所提供的主流的QA平台也可以从模糊测试功能中获得好处。这些功能可以由提供商提
供，也可以由这些应用程序的维护者来提供，但最初通常是由第三方所开发并且作为一个应用
程序插件来提供的。尽管SPIDynamics的DevInspect和QAInpect产品不是一个专用的模期器，
但它可以作为此方法的一个早期的例子。
26.4小结
工业界发展的前沿是什么呢？前面已经暗示过，对模糊测试技术更为广泛的接受正处于发
展的起点。我们鼓励这种发展趋势，并且基于许多原因将模糊测试看做是安全领域中唯一的方
法。更为重要的是，其他可选的方法（如二进制逆向过程和深度的源代码分析）都需要具备特
殊的技能，而这对于开发者和QA团队而言是不现实的，另一方面，模糊测试可以被实现为一
个自动化的过程，因此开发者和QA团队都使用这种方法。
尽管独立的安全问题研究者将会持续推动该问题向前发展，并且开发有趣的模糊测试技术，
但主要还是要靠商业提供商的努力以创建第一个易于使用的模糊测试环境，并且能够顺利地集
成到开发环境中。正如第24章所讨论的，其中最重要的一个需求就是错误检测的先进性。调试
技术很少与目前可用的模糊器绑定在一起。即使将调试器与模糊器绑定在一起，那么也并不是
最佳的选择，必须要应用更加先进的技术以实现对所发现的错误进行准确定位和自动化分类。
错误检测工具提供商如第24章所提到的，包括IBM、Compuware、Parasoft和OCSystems，都
具有唯一的目的即扩屁并完善其工具的功能
通过对类似的、但更加成熟的技术的发展历史进行研究，我们可以期望看到一些关键事件
的发生。首先，将会有更多的公司参与到同早期开发模测试工具的公司的竞争中来，提供商
可以从头开发他们自己的工具，但是在许多情况下将需要某些已有的商业技术，有哪些公司可
能会参与到这个竞争中来呢？很难给出确定性的回答，且看一下处于安全性和QA竞争空间中
的软件提供商可以通过接受模糊测试技术，从面利用这个机会使其与竞争者区别开来。
---