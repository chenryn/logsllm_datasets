80 HTTP 902 VMware Server 3784-3785 Ventrilo 9119 MXit
88 Kerberos 989-990 FTP over SSL 4333 mSQL 9800 WebDAV
102 MS Exchange 993 IMAP4 over SSL 4444 Blaster 9898 Dabber
110 POP3 995 POP3 over SSL 4664 Google Desktop 9988 Rbot/Spybot
113 Ident 1025 Microsoft RPC 4672 eMule 9999 Urchin
119 NNTP (Usenet) 1026-1029 Windows Messenger 4899 Radmin 10000 Webmin
123 NTP 1080 SOCKS Proxy 5000 UPnP 10000 BackupExec
135 Microsoft RPC 1080 MyDoom 5001 Slingbox 10113-10116 NetIQ
137-139 NetBIOS 1194 OpenVPN 5001 iperf 11371 OpenPGP
143 IMAP4 1214 Kazaa 5004-5005 RTP 12035-12036 Second Life
161-162 SNMP 1241 Nessus 5050 Yahoo! Messenger 12345 NetBus
177 XDMCP 1311 Dell OpenManage 5060 SIP 13720-13721 NetBackup
179 BGP 1337 WASTE 5190 AIM/ICQ 14567 Battlefield
201 AppleTalk 1433-1434 Microsoft SQL 5222-5223 XMPP/Jabber 15118 Dipnet/Oddbob
264 BGMP 1512 WINS 5432 PostgreSQL 19226 AdminSecure
318 TSP 1589 Cisco VQP 5500 VNC Server 19638 Ensim
381-383 HP Openview 1701 L2TP 5554 Sasser 20000 Usermin
389 LDAP 1723 MS PPTP 5631-5632 pcAnywhere 24800 Synergy
411-412 Direct Connect 1725 Steam 5800 VNC over HTTP 25999 Xfire
443 HTTP over SSL 1741 CiscoWorks 2000 5900+ VNC Server 27015 Half-Life
445 Microsoft DS 1755 MS Media Server 6000-6001 X11 27374 Sub7
464 Kerberos 1812-1813 RADIUS 6112 Battle.net 28960 Call of Duty
465 SMTP over SSL 1863 MSN 6129 DameWare 31337 Back Orifice
497 Retrospect 1985 Cisco HSRP 6257 WinMX 33434+ traceroute
500 ISAKMP 2000 Cisco SCCP 6346-6347 Gnutella Legend
512 rexec 2002 Cisco ACS 6500 GameSpy Arcade Chat
513 rlogin 2049 NFS 6566 SANE Encrypted
514 syslog 2082-2083 cPanel 6588 AnalogX
Gaming
515 LPD/LPR 2100 Oracle XDB 6665-6669 IRC
Malicious
520 RIP 2222 DirectAdmin 6679/6697 IRC over SSL
Peer to Peer
521 RIPng (IPv6) 2302 Halo 6699 Napster
Streaming
540 UUCP 2483-2484 Oracle DB 6881-6999 BitTorrent
IANA port assignments published at http://www.iana.org/assignments/port-numbers
by Jeremy Stretch v1.1
Advanced Operators Number Searching
Advanced Operators Meaning What To Type Into Search Box (& Description of Results) Number Searching Description
site: Search only one website conference site:www.sans.org(Search SANS site for conference info) 1Z9999W99999999999 UPS tracking numbers
[#]…[#] or numrange: Search within a range of numbers plasma television $1000...1500(Search for plasma televisions between $1000 and $1500) 999999999999 FedEx tracking numbers
date: Search only a range of months hockey date: 3(Search for hockey references within past 3 months; 6 and 12-month date- 9999 9999 9999 9999 9999 99 USPS tracking numbers
restrict options also available)
AAAAA999A9AA99999 Vehicle Identification Numbers (VIN)
safesearch: Exclude adult-content safesearch: sex education(Search for sex education material without returning adult sites)
305214274002 UPC codes
link: linked pages link:www.sans.org(Find pages that link to the SANS website)
202 Telephone area codes
info: Info about a page info:www.sans.org(Find information about the SANS website)
patent 5123123 Patent numbers
related: Related pages related:www.stanford.edu(Find websites related to the Stanford website) (Remember to put the word "patent"
before your patent number)
intitle: Searches for strings in the intitle:conference (Find pages with "conference" in the page title)
title of the page n199ua FAA airplane registration numbers
(An airplane's FAA registration number
allintitle: Searches for all strings within allintitle:conference SANS (Find pages with "conference" and "SANS" in the page title. is typically printed on its tail)
the page title Doesn't combine well with other operators)
fcc B4Z-34009-PIR FCC equipment IDs
inurl: Searches for strings in the URL inurl:conference(Find pages with the string "conference" in the URL) (Remember to put the word "fcc"
before the equipment ID)
allinurl: Searches for all strings allinurl:conference SANS(Find pages with “conference” and "SANS" in the URL.
within the URL Doesn't combine well with other operators)
Calculator Operators
filetype:or ext: Searches for files with that filetype:ppt (Find files with the "ppt" file extension.
file extension ".ppt" are MS PowerPoint files.)
Operators Meaning Type Into Search Box
cache: Display the Google cache cache:www.sans.org (Show the cached version of the page without performing the search)
+ addition 45 + 39
of the page
- subtraction 45 – 39
phonebook:or Display all, residential, phonebook:Rick Smith MD (Find all phone book listing for Rick Smith in Maryland.
rphonebook:or business phone listings Cannot combine with other searches)
* multiplication 45 * 39
bphonebook
/ division 45 / 39
author: Searches for the author of a author:Rick (Find all newsgroup postings with "Rick" in the author name or email address.
newsgroup post Must be used with a Google Group search)
% of percentage of 45% of 39
insubject: Search only in the subject of a insubject:Mac OS X (Find all newsgroup postings with "Mac OS X" in the subject of the
^ raise to a power 2^5
newsgroup post post. Must be used with a Google Group search)
(2 to the 5th power)
define: Various definitions of the word define:sarcastic(Get the definition of the word sarcastic)
or phrase
stock: Get information on a stock stock:AAPL (Get the stock information for Apple Computer, Inc.)
abbreviation
Operator Examples Search Parameters
Google
Operator Example Finds Pages Containing Search Value Description of Use in
Hacking and Defense
Parameters Google Search URLs
sailboat chesapeake bay the words sailboat, Chesapeake and Cheat Sheet
Bay q the search term The search term
POCKET REFERENCE GUIDE
sloop ORyawl either the word sloopor the word yawl filter 0 or 1 If filteris set to 0, show
potentially duplicate results.
SANS Stay Sharp Program
“To each his own” the exact phrase to each his own
as_epq a search phrase The value submitted is as an http://www.sans.org
virus -computer the word virusbut NOT the word exact phrase. No need to http://www.sans.org/staysharp
computer surround with quotes.
Purpose
Star Wars Episode +III This movie title, including the roman as_ft i = include The file type indicated by
numeral III e = exclude as_filetypeis included or This document aims to be a quick reference
excluded in the search.
outlining all Google operators, their
~boat loan loan info for both the word boatand its
synonyms: canoe, ferry, etc. as_filetype a file extension The file type is included or meaning, and examples of their usage.
excluded in the search
define:sarcastic definitions of the word sarcasticfrom indicated by as_ft.
the Web What to use this sheet for
as_occt any = anywhere Find the search term
Use this sheet as a handy reference that outlines the
mac * x the words Macand Xseparated by title = page title in the specified location.
exactly one word body = text of page various Google searches that you can perform. It is
url = in the page URL
meant to support you throughout the Google Hacking
I’m Feeling Lucky Takes you directly to first web page links = in links to
(Google link) returned for your query the page and Defense course and can be used as a quick
reference guide and refresher on all Google advanced
as_dt i = include The site or domain indicated
operators used in this course. The student could also
e = exclude by as_sitesearchis included
or excluded in the search. use this sheet as guidance in building innovative
operator combinations and new search techniques.
as_sitesearch site or domain The file type is included or
excluded in the search This sheet is split into these sections:
indicated by as_dt.
• Operator Examples
as_qdr m3 = three months Locate pages updated with in
• Advanced Operators
m6 = six months the specified time frame.
y = past year • Number Searching
• Calculator Operators
• Search Parameters
References:
http://www.google.com/intl/en/help/refinesearch.html
http://johnny.ihackstuff.com
http://www.google.com/intl/en/help/cheatsheet.htm
l
©SANS Institute 2006
SCAPY
packetlife.net
Basic Commands Specifying Addresses and Values
ls()
# Explicit IP address (use quotation marks)
List all available protocols and protocol options
>>> IP(dst="192.0.2.1")
lsc()
List all available scapy command functions # DNS name to be resolved at time of transmission
conf >>> IP(dst="example.com")
Show/set scapy configuration parameters
# IP network (results in a packet template)
Constructing Packets
>>> IP(dst="192.0.2.0/24")
# Setting protocol fields
# Random addresses with RandIP() and RandMAC()
>>> ip=IP(src="10.0.0.1")
>>> IP(dst=RandIP())
>>> ip.dst="10.0.0.2"
>>> Ether(dst=RandMAC())
# Combining layers
# Set a range of numbers to be used (template)
>>> l3=IP()/TCP()
>>> IP(ttl=(1,30))
>>> l2=Ether()/l3
# Random numbers with RandInt() and RandLong()
# Splitting layers apart
>>> IP(id=RandInt())
>>> l2.getlayer(1)
>
Sending Packets
>>> l2.getlayer(2)
 send(pkt, inter=0, loop=0, count=1, iface=N)
Send one or more packets at layer three
Displaying Packets sendp(pkt, inter=0, loop=0, count=1, iface=N)
Send one or more packets at layer two
# Show an entire packet
sendpfast(pkt, pps=N, mbps=N, loop=0, iface=N)
>>> (Ether()/IPv6()).show()
Send packets much faster at layer two using tcpreplay
###[ Ethernet ]###
dst= ff:ff:ff:ff:ff:ff
>>> send(IP(dst="192.0.2.1")/UDP(dport=53))
src= 00:00:00:00:00:00
.
type= 0x86dd
Sent 1 packets.
###[ IPv6 ]###
>>> sendp(Ether()/IP(dst="192.0.2.1")/UDP(dport=53))
version= 6
.
tc= 0
Sent 1 packets.
fl= 0
plen= None
Sending and Receiving Packets
nh= No Next Header
hlim= 64 sr(pkt, filter=N, iface=N), srp(…)
src= ::1 Send packets and receive replies
dst= ::1 sr1(pkt, inter=0, loop=0, count=1, iface=N), srp1(…)
Send packets and return only the first reply
# Show field types with default values
srloop(pkt, timeout=N, count=N), srploop(…)
>>> ls(UDP())
Send packets in a loop and print each reply
sport : ShortEnumField = 1025 (53)
dport : ShortEnumField = 53 (53) >>> srloop(IP(dst="packetlife.net")/ICMP(), count=3)
len : ShortField = None (None) RECV 1: IP / ICMP 174.143.213.184 > 192.168.1.140
chksum : XShortField = None (None) RECV 1: IP / ICMP 174.143.213.184 > 192.168.1.140
RECV 1: IP / ICMP 174.143.213.184 > 192.168.1.140
Fuzzing
Sniffing Packets
# Randomize fields where applicable
sniff(count=0, store=1, timeout=N)
>>> fuzz(ICMP()).show()
Record packets off the wire; returns a list of packets when stopped
###[ ICMP ]###
type= 
# Capture up to 100 packets (or stop with ctrl-c)
code= 227
>>> pkts=sniff(count=100, iface="eth0")
chksum= None
>>> pkts
unused= 
by Jeremy Stretch v1.0
TCPDUMP
packetlife.net
Command Line Options
-A Print frame payload in ASCII -q Quick output
-c  Exit after capturing count packets -r  Read packets from file
-D List available interfaces -s  Capture up to len bytes per packet
-e Print link-level headers -S Print absolute TCP sequence numbers
-F  Use file as the filter expression -t Don't print timestamps
-G  Rotate the dump file every n seconds -v[v[v]] Print more verbose output
-i  Specifies the capture interface -w  Write captured packets to file
-K Don't verify TCP checksums -x Print frame payload in hex
-L List data link types for the interface -X Print frame payload in hex and ASCII
-n Don't convert addresses to names -y  Specify the data link type
-p Don't capture in promiscuous mode -Z  Drop privileges from root to user
Capture Filter Primitives
[src|dst] host  Matches a host as the IP source, destination, or either
ether [src|dst] host  Matches a host as the Ethernet source, destination, or either
gateway host  Matches packets which used host as a gateway
[src|dst] net / Matches packets to or from an endpoint residing in network
[tcp|udp] [src|dst] port  Matches TCP or UDP packets sent to/from port
[tcp|udp] [src|dst] portrange - Matches TCP or UDP packets to/from a port in the given range
less  Matches packets less than or equal to length
greater  Matches packets greater than or equal to length
(ether|ip|ip6) proto  Matches an Ethernet, IPv4, or IPv6 protocol
(ether|ip) broadcast Matches Ethernet or IPv4 broadcasts
(ether|ip|ip6) multicast Matches Ethernet, IPv4, or IPv6 multicasts
type (mgt|ctl|data) [subtype ] Matches 802.11 frames based on type and optional subtype
vlan [] Matches 802.1Q frames, optionally with a VLAN ID of vlan
mpls [] Matches MPLS packets, optionally with a label of label
   Matches packets by an arbitrary expression
Protocols Modifiers Examples
arp ip6 slip ! or not udp dst port not 53 UDP not bound for port 53
ether link tcp && or and host 10.0.0.1 && host 10.0.0.2 Traffic between these hosts
fddi ppp tr || or or tcp dst port 80 or 8080 Packets to either TCP port
icmp radio udp
ICMP Types
ip rarp wlan
icmp-echoreply icmp-routeradvert icmp-tstampreply
TCP Flags icmp-unreach icmp-routersolicit icmp-ireq
tcp-urg tcp-rst icmp-sourcequench icmp-timxceed icmp-ireqreply
tcp-ack tcp-syn icmp-redirect icmp-paramprob icmp-maskreq
tcp-psh tcp-fin icmp-echo icmp-tstamp icmp-maskreply
by Jeremy Stretch v2.0
N A T
ETWORK DDRESS RANSLATION
packetlife.net
Example Topology Address Classification
An actual address assigned to
Inside Local
an inside host
An inside address seen from
Inside Global
the outside
An actual address assigned to
FastEthernet0 FastEthernet1 Outside Global
an outside host
10.0.0.1/16 174.143.212.1/22
An outside address seen from
NAT Inside NAT Outside Outside Local
the inside
NAT Boundary Configuration
Perspective
interface FastEthernet0 Local Global
ip address 10.0.0.1 255.255.0.0
ip nat inside
Inside Inside Local Inside Global noitacoL
!
interface FastEthernet1
ip address 174.143.212.1 255.255.252.0
Outside Outside Local Outside Global
ip nat outside