(other surveys are
similar). We deﬁne addresses with 95% availability or bet-
ter to be very stable addresses, concluding that this data
suggests that 16.4% of responsive addresses in the survey
are very stable and corresponds to the mode of addresses
with availabilities at A > 0.95.
15w
We can next project this estimate to the whole Internet
with two methods. First, we extrapolate from the survey to
the whole-Internet census. Our survey ﬁnds 1.75M respon-
sive addresses in 17.5k responsive /24 blocks, suggesting a
mean of 16.4 stable addresses per responsive block. The cor-
responding census ﬁnds 2.1M responsive blocks, suggesting
an upper bound of 34.4M stable, occupied addresses in the
entire Internet. This estimated upper bound depends on
mapping between survey and census.
Second, we can project directly from our census. Given
103M responsive addresses in our census, we estimate that
16.4% of these, or 16.8M addresses, are potentially very sta-
ble. However, this estimate does not account for the fact
that our survey was biased (by only choosing to survey previ-
ously responsive blocks, and blocks selected from a range of
A, U values), and our survey is much more robust to packet
loss, since each address is probed more than 916 times over
a week-long survey rather than once in the three month cen-
sus. We therefore consider our ﬁrst estimate to be an upper
bound on the size of the visible Internet.
We next list and quantify several potential sources of er-
ror in this estimate. Section 3.2.3 suggested that multipliers
of 1.61 or 1.86 are our best projections from the ICMP-
responsive Internet to Internet accessible computers. Next,
multi-homed hosts or routers represent an overcount of at
most 6% of addresses (Section 3.4). Third, some addresses
were not stable because they were newly occupied mid-way
through our census. We estimated births in survey data
and found it to account for less than 1% of addresses. Sta-
tistical measurement error due to sample size is about 0.4%
(Equation 1). Taken together, these factors suggest an error-
corrected estimated of 52M to 60M very stable addresses on
the public Internet.
Finally, there is a loose relationship between stable ad-
dresses and servers on the Internet; we study hosts that
serve web, MySQL, ftp, and ssh in our technical report [18]
(omitted due to space). That study suggests that, at USC,
58% of stable addresses are not servers (presumably they are
always-on client machines), and that there are about 1.5×
more servers than servers at stable addresses.
(In other
words, half of the servers we found were down more than
5% of the time!) Examination of DNS records suggest that
many of these non-stable servers are simply not traditional
servers—they are either dynamic hosts that happen to be
running web servers, or embedded devices that are turned
oﬀ at night.
5.3 Trends in Internet Address Utilization
Since the IPv4 address space is ﬁnite and limited to 32
bits, the rate of address allocation is important. In fact, con-
cerns about address space exhaustion [15] were the primary
motivation for IPv6 [6] and CIDR [11] as an interim con-
)
s
e
n
i
l
d
i
l
o
s
,
s
n
o
i
l
l
i
m
n
i
(
s
e
s
s
e
r
d
d
A
 3000
 2500
 2000
 1500
 1000
 500
 0
 10
)
s
e
n
i
l
d
e
allocated
acks
nacks
responsive
 5
t
t
o
d
(
s
e
s
s
e
r
d
d
a
.
c
o
2003-01
2003-07
2004-01
2004-07
2005-01
2005-07
2006-01
2006-07
 0
2007-07
2007-01
l
l
a
f
o
%
Census Date
Figure 9: IPv4 address space allocation and utilization over
time. Solid lines indicate absolute values, dashed are per-
centages of allocated addresses. (Data from all censuses.)
servation strategy. They also motivated deployment of Net-
work Address Translation (NAT) devices that allow many
computers to share a single globally routable address [48].
We next consider how eﬀective conservation of address space
allocation has been 20 years after these initial studies.
Figure 9 and Table 1 show trends in address space alloca-
tion and utilization computed over each individual Internet
address. To put these values into context, around 4.3 billion
addresses are possible, after eliminating private and multi-
cast address space, only 2.8 billion public unicast addresses
are allocated. Finally, this evaluation represents the number
of addresses and not actual host computers, since multiple
computers may be hidden behind a single NAT box.
Linear regression shows that allocation is growing at about
106M/year, (about 4%/year since 2004), and the number
of visible addresses grows at 17.2M/year (28% of the 2004
baseline).
Care must be taking in interpreting these results, though,
because address allocation is far from uniform. Many ISPs
give out individual addresses to users, but these addresses
are usually dynamic and change over time. Even users
of “always-on” connections may shift addresses over time.
Businesses and ISPs, on the other hand, are given addresses
in power-of-two blocks, which are rarely ﬁlled.
6. TRENDS IN FIREWALL DEPLOYMENT
Large numbers of Internet hosts lie behind ﬁrewalls, which
are conﬁgured to restrict, block or rate-limit traﬃc accord-
ing to private local policies. Firewalls clearly aﬀect the visi-
bility of hosts to censuses. In this section, we study trends in
the deployment of visible ﬁrewalls over 15 months to begin
to understand their eﬀect on our observations.
Counting hosts behind ﬁrewalls is diﬃcult since the goal
of a ﬁrewall is often to shield hosts from external access.
Measuring ﬁrewalls themselves is also diﬃcult because many
ﬁrewalls simply drop packets, making them invisible to our
probing. Some ﬁrewalls, however, respond to ICMP echo re-
quests with negative acknowledgments, indicating that com-
munication is “administratively prohibited”. We use this in-
formation to estimate the number of ﬁrewalls and ﬁrewalled
addresses.
We begin with some terminology and deﬁnitions. We de-
ﬁne a ﬁrewall as a software or hardware device that inten-
tionally hides from our probes an active network interface
that is otherwise connected to the public Internet and as-
signed a public IP address. (Since our focus is the public
Internet, we do not attempt to count hosts behind NATs
with private IP addresses.) A ﬁrewall intercepts packets be-
fore they reach their destinations. Firewalls include access-
controls in routers, dedicated boxes, and end-host software.
With regard to our probes, silent ﬁrewalls discard the probe
without reply, while visible ﬁrewalls generate a reply that in-
dicates communication is administratively prohibited. Access-
control lists in routers are one implementation of visible ﬁre-
walls. Many host operating systems include a software ﬁre-
wall that protects a single machine. We call these personal
ﬁrewalls, in contrast to block ﬁrewalls which are typically
implemented by routers, PCs or dedicated appliances and
cover a block of addresses. When appropriate, we use the
term ﬁrewall for all these diﬀerent devices and software.
In this section, we use censuses to count the visible ﬁre-
walls in the Internet, both personal and block ﬁrewalls,
and estimate the address space they cover. Because we
miss silent ﬁrewalls, these measurements provide only lower
bounds of all ﬁrewalls. Finally, we analyze trends in ﬁrewall
deployment over a 15-month period covered by censuses IT 7
through IT 15w (all censuses that recorded NACKs).
6.1 Methodology
To count ﬁrewalls we subdivide the negative replies to a
census. We consider responses of type 3, destination un-
reachable, with code 9, 10, and 13, indicating network, host
or communication administratively prohibited.
to indicate
the presence of a visible ﬁrewall. We then compare the
probed address P to the source address of the reply mes-
sage R. When P = R, the host itself replied, and so we
classify P as a personal ﬁrewall. When P (cid:3)= R, we conclude
that a block ﬁrewall with address R replied on P ’s behalf.
We also consider a positive response (echo reply) or a neg-
ative response that is not administrative prohibited, to be
a non-ICMP-ﬁrewalled address. In other cases, we cannot
draw a conclusion about the presence of a ﬁrewall, since
the address may be invisibly ﬁrewalled, the address may be
empty, or the probe may have been lost.
To measure coverage, we examine all probed addresses Pi
with the same reply address R to determine the ﬁrewalled
block covered by ﬁrewall R. A block ﬁrewalled by R is the
largest [l, h] address range such that l and h elicit an ad-
ministratively prohibited reply, and ∀ p ∈ [l, h], replies to
probes to address p are either administratively prohibited
from R, or a positive reply (echo reply, type 0) from p, or
there is no response from p. We also require h − l < 216,
and conﬁrmed that this step avoids degenerate cases. This
deﬁnition of ﬁrewalled blocks tolerates lost probes (by ig-
noring non-responses) and considers the common practice
of allowing a few publicly-visible hosts (often web servers)
in the middle of an otherwise ﬁrewalled range of addresses.
We analyze our censuses to estimate the number of ﬁre-
walled addresses, the number of ﬁrewalled blocks, their dis-
tribution by size and their evolution over time.
6.2 Evaluation
We begin by considering the size of the ﬁrewalled address
space. Figure 10 shows the absolute number of addresses
)
s
n
o
i
l
l
i
m
n
i
(
.
s
r
d
d
a
d
e
t
c
e
t
o
r
p
-
l
l
a
w
e
r
i
f
 80
 70
 60
 50
 40
 30
 20
 10
 0
ratio firewalled:responsive addrs.
firewall-protected addresses
 0.55
 0.5
 0.45
 0.4
 0.35
 0.3
 0.25
 0.2
 0.15
 0.1
 0.05
 0
2007-07
2007-05
i
.
s
r
d
d
a
e
v
s
n
o
p
s
e
r
o
t
d
e
l
l
a
w
e
r
i
f
f
o
o
i
t
a
r
S
e
l
\
s
k
c
o
b
l
f
o
t
n
u
o
c
e
v
i
t
l
a
u
m
u
c
 60000
 50000
 40000
 30000
 20000
 10000
 0
 1
 4
IT17w
IT16w
IT15w
IT14w
IT13w