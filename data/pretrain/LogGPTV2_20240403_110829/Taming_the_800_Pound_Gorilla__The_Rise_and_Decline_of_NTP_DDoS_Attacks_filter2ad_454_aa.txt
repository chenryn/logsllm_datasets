title:Taming the 800 Pound Gorilla: The Rise and Decline of NTP DDoS Attacks
author:Jakub Czyz and
Michael Kallitsis and
Manaf Gharaibeh and
Christos Papadopoulos and
Michael Bailey and
Manish Karir
Taming the 800 Pound Gorilla: The Rise and Decline of
NTP DDoS Attacks
Jakub Czyz
University of Michigan
Christos Papadopoulos
Colorado State University
Michael Kallitsis
Merit Network, Inc.
Michael Bailey
University of Michigan
University of Illinois
Manaf Gharaibeh
Colorado State University
Manish Karir
Merit Network, Inc.
ABSTRACT
Distributed Denial of Service (DDoS) attacks based on Network
Time Protocol (NTP) ampliﬁcation, which became prominent in
December 2013, have received signiﬁcant global attention. We
chronicle how this attack rapidly rose from obscurity to become the
dominant large DDoS vector. Via the lens of ﬁve distinct datasets,
we characterize the advent and evolution of these attacks. Through
a dataset that measures a large fraction of global Internet trafﬁc,
we show a three order of magnitude rise in NTP. Using a large
darknet, we observe a similar rise in global scanning activity, both
malicious and research. We then dissect an active probing dataset,
which reveals that the pool of ampliﬁers totaled 2.2M unique IPs and
includes a small number of “mega ampliﬁers,” servers that replied
to a single tiny probe packet with gigabytes of data. This dataset
also allows us, for the ﬁrst time, to analyze global DDoS attack
victims (including ports attacked) and incidents, where we show
437K unique IPs targeted with at least 3 trillion packets, totaling
more than a petabyte. Finally, ISP datasets shed light on the local
impact of these attacks. In aggregate, we show the magnitude of
this major Internet threat, the community’s response, and the effect
of that response.
Categories and Subject Descriptors
C.2.3 [Computer-Communication Networks]: Network Opera-
tions—Network management, Network monitoring
General Terms
Measurement, Networking, Security
Keywords
DDoS; NTP; Darknet
1.
INTRODUCTION
Though Distributed Denial of Service (DDoS) attacks have be-
come increasingly commonplace, the scope and magnitude of the
ﬁrepower that can now be unleashed on a target is unprecedented. A
Permission to make digital or hard copies of all or part of this work for personal 
or classroom use is granted without fee provided that copies are not made or 
distributed for profit or commercial advantage and that copies bear this notice 
and the full citation on the first page. Copyrights for components of this work 
owned  by  others  than  ACM  must  be  honored.  Abstracting  with  credit  is 
permitted. To copy otherwise, or republish, to post on servers or to redistribute 
to  lists,  requires  prior  specific  permission  and/or  a  fee.  Request  permissions 
from permissions@acm.org. 
IMC’14, November 5–7, 2014, Vancouver, BC, Canada. 
Copyright © 2014 ACM  978-1-4503-3213-2/14/11…$15.00. 
http://dx.doi.org/10.1145/2663716.2663717.
comprehensive recent study described various DDoS ampliﬁcation
attack vectors and their attack potential, predicting the rise of Net-
work Time Protocol (NTP) [23] as one of the most potent [32]. In
the weeks since, data published by efforts such as the OpenNTPPro-
ject.org [2] painted a bleak picture of millions of devices that were
readily available to facilitate these attacks. Indeed, in the ﬁrst quar-
ter of 2014, 85% of DDoS attacks larger than 100 Gbps were using
NTP reﬂection [24]. Used for everything from a gaming edge [18]
to extortion [28], DDoS attacks have been a scourge for years, but
this new attack vector has made them even more powerful.
We study the dramatic rise of NTP-based DDoS attacks, in a
span of just a few months, from a mere trickle to rapidly become
the primary DDoS vector for large attacks. We show who the am-
pliﬁers are, what they are capable of, who they attack, and what
attacks looked like. We present ﬁndings from the vantage points
of ﬁve unique datasets: a global trafﬁc proﬁle and attack dataset
from a large analytics and DDoS mitigation vendor; a global prob-
ing dataset that sheds light on potential ampliﬁers, their victims,
and attacks; a large darknet that observes Internet-scale scanning
activities; and, ﬁnally, two regional Internet service providers that
give us a local perspective on attack mechanics and evolution.
NTP DDoS Mechanics: Much has been written on the general
ideas of reﬂection and ampliﬁcation (e.g., [27], [32]), so, we discuss
attack mechanics only brieﬂy. For these attacks, the ﬁrst step is the
identiﬁcation of vulnerable ampliﬁers, which attackers can accom-
plish via large-scale scanning. An ampliﬁer is simply a host running
a protocol (e.g., NTP, DNS) which, when sent a query packet, re-
sponds with one or more packets whose aggregate size is larger than
the query it received. Once suitable ampliﬁers have been identiﬁed,
an attacker, directly or via intermediate hosts he controls, sends
small UDP packets with the spoofed source address set to the IP of
the intended attack victim and the destination address a vulnerable
ampliﬁer. Such spooﬁng is possible because many networks do not
follow best security practices (e.g., BCP 38/84) [36]. In turn, as is
the goal of these volumetric DDoS attacks, large amounts of trafﬁc
from ampliﬁers may saturate bandwidth at the victim. We say these
attacks are reﬂected as they are executed via an intermediate host
(the ampliﬁer); attacks are ampliﬁed in that more bandwidth is used
at the victim than the attacker (or its bots) need to expend. In the
case of NTP, the protocol feature that has been used in large attacks
is the monlist command. A command intended only for diagnostics,
it returns the last 600 clients of the ampliﬁer, producing a typically
very large, multi-packet reply to a single small query packet—an
ideal ampliﬁcation attack vector.
The rest of our paper and highlighted ﬁndings are as follows. In
§ 2 we describe a rapid rise of NTP trafﬁc to become the most potent
DDoS attack vector. Only constituting 0.001% of trafﬁc four months
earlier, by mid-February NTP had climbed to use up 1% of global
435Internet trafﬁc, surpassing even the ubiquitous DNS. Simultaneously,
the majority of large DDoS attacks observed globally were now
using the NTP vector, one not even on the radar in November. In § 3
we explore the ampliﬁer pool that enabled this rapid rise in trafﬁc
and attacks—a pool of 2.2M vulnerable NTP servers. In this pool
we ﬁnd several surprises: ﬁrst, while a typical server provides just
4x ampliﬁcation, we ﬁnd a subset we term “mega ampliﬁers,” who
respond to a single packet with gigabytes of data; second, we ﬁnd
that a large fraction of ampliﬁers are not infrastructure servers but
end hosts; comically, we also discover that nearly a ﬁfth of NTP
servers do not serve the correct synchronized time.
As for target victims, in § 4 we seek to answer the questions
of who is being DDoSed, when, and how badly. We ﬁnd tens of
thousands of victim IPs across thousands of autonomous systems,
and discover that many appear to be gamers. The 437K unique
victims we saw were hit over ﬁfteen weeks with at least 3 trillion
packets, which is, at median ampliﬁer response, over 1.2 petabytes.
Luckily, things are improving, which we begin to outline in § 5 and
§ 6 where we ﬁrst show a dramatic increase in scanning for NTP
over eight months as attackers scramble to build lists of vulnerable
IPs. Then, we discuss how the pool of NTP monlist ampliﬁers being
scanned for has itself decreased rapidly, especially relative to other
ampliﬁer pools.
Zooming in from the global perspective to the local, in § 7 we
highlight the effect on and mitigation at two regional networks that
actively worked to respond to attacks, including local conﬁrmation
of some of our global dataset ﬁndings and several new insights. Fi-
nally, in § 8 we describe some related work, and in § 9 we summarize
key conclusions and future work.
2. GLOBAL NTP TRAFFIC AND ATTACKS
2.1 Global Internet NTP Trafﬁc
In late 2013 and early 2014, public attack disclosures suggested
that NTP-based DDoS attacks were very large and increasingly
common (e.g., [12], [18], and [30]) . To gauge the global prevalence
of these types of attacks, we obtained trafﬁc statistics from Arbor
Networks, a provider of network analytics and attack mitigation
services [9]. Arbor Networks collects trafﬁc data, via appliances
that export network ﬂow statistics, from a global set of over 300
generally large and typically global network operators, including
tier-1 ISPs, tier-2/regional ISPs, mobile service providers, as well
as two dozen large enterprise customers. Arbor Networks estimates
that their netﬂow trafﬁc dataset represents between a third and a half
of all Internet trafﬁc.
In Figure 1 we show the relative fraction of all measured Internet
trafﬁc that NTP and DNS represent, observed by Arbor over six
months, between November 1st, 2013 and May 1st, 2014. The data
lines are the ratio of each protocol’s daily bits-per-second averages
to all Internet trafﬁc seen. The overall daily average of Internet
trafﬁc represented in this dataset is 71.5 Tbps. As the ﬁgure shows,
NTP starts this period off at a level that constitutes only about
0.001% of daily bits per second transferred. By March 1st, NTP had
grown to use up about 1% of of global Internet trafﬁc, surpassing
even DNS, which hovers at around 0.15% of trafﬁc throughout this
period. The dramatic three order of magnitude rise of NTP trafﬁc in
both absolute and relative terms, translates to noticeable ﬁnancial
impact, even at service providers who host not only victims but the
NTP ampliﬁers used in attacks. It is possible that this impact is
part of the reason for rapid remediation, which we discuss in § 6.
After peaking on February 11th, NTP trafﬁc appears to have begun
a decline and is at around 0.1% of Internet trafﬁc at the beginning
of May, still two orders of magnitude higher than at the start of
November 2013, but a tenth of what it was at peak.
Figure 1: Fraction of Internet trafﬁc that is NTP and DNS for
November 2013 – April 2014. There is a nearly three order of
magnitude growth in the fraction of global trafﬁc that is NTP,
peaking at 1% of all trafﬁc in mid-February, but then dropping,
to around 0.1%.
2.2 Global NTP DDoS Attacks
In addition to the trafﬁc statistics described in § 2.1, the Arbor
Networks devices also collect labeled attack counts, which detail the
types of attacks that are being seen by Arbor Networks’ customers,
including the prevalent protocols used in the attacks (e.g., ICMP
ﬂooding, TCP SYN ﬂooding, bandwidth exhaustion using DNS,
etc.). The exact mechanism for labeling a trafﬁc spike as an attack
is proprietary, and any method is likely to miss some attacks—
especially small ones—but our aim here is merely to show the
relative trend in attack categories.
Figure 2: Fraction of all monthly global DDoS attacks in three
size ranges and overall that are NTP-based. Note that NTP
quickly rises from obscurity to dominate medium and large at-
tacks. Mitigation appears to have had an impact with NTP-
based attacks declining substantially in April.
In Figure 2 we show the attacks seen by Arbor Networks’ cus-
tomers in the six months starting in November 2013. For each
month, we bin attacks into three size categories: Small, consisting of
aggregate bandwidth less than 2 Gbps ; Medium, which are attacks
2013-11-012013-12-012014-01-012014-02-012014-03-012014-04-012014-05-01Date0.000010.00010.0010.010.1Fraction of Internet TrafficDaily Internet traffic sample averages 71.5 Tbps.Global NTP TrafficGlobal DNS Traffic2013-112013-122014-012014-022014-032014-04Month0.00.10.20.30.40.50.60.70.8Fraction of DDoS AttacksThere are ~300k monthly DDoS attacks..00.01.02.12.13.06.00.06.12.51.64.44.00.22.18.63.70.41.00.01.03.17.18.10Frac. of Small (20 Gbps)Frac. of All Attacks436that are between 2 and 20 Gbps; and Large, which are any attacks
larger than 20 Gbps. In the ﬁgure, a different bar represents the
fraction of all DDoS attacks in each category as well as of all attacks
that were NTP-based. We do not show the frequency of attacks in
each category, but there are approximately 300K monthly attacks
seen globally by Arbor Networks, and approximately 90% of them
are Small, 10% Medium, and 1% Large. While the raw number
of attacks was never dominated by NTP, the majority of Medium
and Large DDoS attacks in February and March were, a dramatic
change from just three months earlier, when only 0.07% of attacks
involved NTP. The ﬁrst quarter 2014 attack fractions were conﬁrmed
by Prolexic, who reported NTP used in 17% of attacks [31] (also
see Goodin, [18], who quotes a third DDoS protection vendor that
reported a majority of attacks in January were via NTP). In the ﬁrst
quarter of 2014, 85% of attacks exceeding 100 Gbps were using
NTP reﬂection [24]. Fortunately, as evidence that the community’s
mitigation efforts are starting to pay off, the fraction of attacks us-
ing NTP has started to decline in April and is now below February
levels.
These trafﬁc and attack statistics point to NTP-based DDoS as a
major new vector and as another reminder of the power of reﬂected
ampliﬁcation DDoS attacks. This was a category of attacks that
have been seen for some time but gained notoriety in recent years
when unsecured open DNS resolvers started being used to amplify
attackers’ ability to exhaust targets’ bandwidth. To better understand
the ampliﬁers that miscreants are using to generate the NTP trafﬁc,
we next delve into the vulnerable NTP server population.
3. GLOBAL NTP AMPLIFIERS
The linchpin in NTP-based reﬂected ampliﬁcation attacks is a
large pool of globally-reachable NTP servers that are conﬁgured in
a way that allows them to serve as reﬂectors and ampliﬁers.
3.1 The Ampliﬁer Population
Figure 3: Count of NTP monlist ampliﬁers, including aggrega-
tions at the /24, routed block, and AS level, and subsets of IPs
under Merit and CSU/FRGP address space. Remediation at IP
levels has been swift, though many networks and nearly half of
ASes still have some ampliﬁers.
Since January 10th, 2014, the OpenNTPProject.org [2] has been
conducting weekly Internet-wide scans of the entire IPv4 address
space in an effort to estimate and identify the global population
of NTP servers that are vulnerable to being used as reﬂectors and
ampliﬁers in DDoS attacks. These measurements entail simply
sending a single NTP packet that requests a target server return the
results of a monlist query, as described in § 1, and capturing all
response packets. Since the size of the single query packet is known,
when servers reply with their packets of monlist table data, we are
able to determine if each server can be used for attacks, and we can
measure its ampliﬁcation factor. We analyzed the response data that
the OpenNTPProject.org shared with us (ONP data) in order to learn
about the ampliﬁer population as well as other facets of the NTP
DDoS phenomenon. We report on ﬁfteen weekly measurements
through April 18th 2014, except where noted.
Before continuing, we discuss several limitations of this data.
First, we note that one important source of error in the ONP dataset
has to do with the type of monlist query packet that was issued.
There are several implementations of the NTP service, and they
do not all respond to the same packet format. The Linux ntpdc
tool for example, when used to query a server with the monlist
command, tries each of two implementation types, one at a time,
before failing. The ONP monlist scans in the dataset shared with
us only used one of the two implementation values in the one NTP
packet they send each IP. However, the implementation used appears
to be more commonly present in the attacker scripts and darknet
scanning data we have observed. Further, the raw numbers we report
match those published by an independent scanning effort, reported
in Kührer et al. [20]. Although the same error might affect both
datasets. We also note that Internet-wide scans conducted from a
single source IP, as the ONP scans were, are prone to be affected by
some networks eventually blocking or ﬁltering the scanning IP over
time. The ONP data was not measured for this effect, but in their
study, Kührer found an additional 9% ampliﬁers when scanning
from a secondary network versus repeated scans from their main
network. For these reasons, our numbers likely under-represent
the full population of ampliﬁers. Finally, we note that the data
only speaks to the ampliﬁers that respond to monlist and version
(discussed later) queries, and not other NTP queries. Although
these two are most commonly discussed in literature, there are other