packet based on a special TOS-like ﬁeld that would be ini-
tialized by the client based on its session requirements. The
server is, of course, at liberty to refuse to respond to a client
requesting a long-lived capability. However, a server may
also delay the transmission of a long lived capability, to
minimize its useful validity time at the client.
6 Conclusion
Today’s Internet is susceptible to DDoS ﬂooding and
ﬂash crowds, where network links are saturated upstream
from a victim, causing the victim’s service to become un-
available to its clients. TCP services are particularly vulner-
able to such ﬂooding attacks, as the TCP exponential back-
off mechanism causes a severe reduction in performance
if packet loss is above 5%. These ﬂooding vulnerabilities
are possible in part because of the end-to-end principle, in
which the network is modeled simply as a transit mecha-
nism for packets, and all interpretation of those packets is
meant to take place at the packet’s destination. However,
packet ﬂoods disable the network as they converge on links
upstream of a victim, and there is no “intelligence” in the
network to ﬁlter them out.
Some research has been done into DDoS ﬂooding coun-
termeasures, however these solutions often require per-ﬂow
state on routers, inter-ISP collaboration, an overlay infras-
tructure, or extensive router processing.
In this paper, we present SIFF, a novel design that ad-
dresses the DDoS ﬂooding problem in a future Internet set-
ting, without relying on any of the above assumptions. Us-
ing this design as a basis, we also present a countermea-
sure that may be deployed in the current Internet, assuming
that client and server software is updated. SIFF does not
require any of the above assumptions of previous counter-
measures. In SIFF, all network trafﬁc is separated into priv-
ileged and unprivileged packets, with the goal of protecting
privileged packets from unprivileged packet ﬂooding, and
allowing packet receivers to selectively terminate individual
privileged ﬂows and have their packets be dropped deep in
the network, before arriving near the victim. Those clients
and servers who deploy our protocol will see signiﬁcant im-
munity to packet ﬂooding, provided that their ISP deploys
updated routers with our technology.
We would like to thank Tom Anderson, Hal Burch,
David Maltz, Srini Seshan, Ion Stoica, Hui Zhang and the
anonymous reviewers for their feedback and suggestions
on how to improve this paper. We would especially like
to thank Virgil Gligor and Vern Paxson for their insightful
feedback as shepherds of this paper.
References
[1] Daniel Adkins, Karthik Lakshminarayanan, Adrian
Perrig, and Ion Stoica. Taming IP packet ﬂooding at-
tacks. In Proceedings of Workshop on Hot Topics in
Networks (HotNets-II), November 2003.
[2] Micah Adler. Tradeoffs in probabilistic packet mark-
In Proceedings of 34th ACM
ing for IP traceback.
Symposium on Theory of Computing (STOC), 2002.
[3] D. Scott Alexander, Kostas G. Anagnostakis,
William A. Arbaugh, Angelos D. Keromytis, and
Jonathan M. Smith. The price of safety in an active
network. In SIGCOMM ’99, 1999.
[4] David G. Andersen. Mayday: Distributed ﬁltering for
Internet services. In Proceedings of USITS, 2003.
[5] Tom Anderson, Timothy Roscoe, and David Wether-
all. Preventing Internet denial-of-service with capabil-
ities. In Proceedings of Hotnets-II, November 2003.
[6] S. Bellovin, M. Leech, and T. Taylor. The ICMP trace-
back message. Internet-Draft, draft-ietf-itrace-01.txt,
October 2001.
[7] Robert Braden. Requirements for Internet hosts –
communication layers. Internet Request for Comment
RFC 1122, Internet Engineering Task Force, October
1989.
[8] Hal Burch and Bill Cheswick. Tracing anonymous
packets to their approximate source. Unpublished pa-
per, December 1999.
[9] Caida.
Skitter.
http://www.caida.org/
tools/measurement/skitter/, 2000.
[10] CERT. TCP SYN ﬂooding and IP spooﬁng attacks.
Advisory CA-96.21, September 1996.
[11] CERT.
Increased activity targeting windows shares.
Advisory CA-2003-08, March 2003.
[12] Drew Dean, Matt Franklin, and Adam Stubbleﬁeld.
An algebraic approach to IP traceback. ACM Transac-
tions on Information and System Security, May 2002.
Proceedings of the 2004 IEEE Symposium on Security and Privacy (S&P’04)  
1081-6011/04 $ 20.00 © 2004 IEEE 
12
[13] Sven Dietrich, Neil Long, and David Dittrich. An-
alyzing ditributed denial of service attack tools: The
Shaft case.
In 14th Systems Administration Confer-
ence, LISA 2000, 2000.
[14] Dave Dittrich. Distributed Denial of Service (DDoS)
http://staff.
attacks/tools resource page.
washington.edu/dittrich/misc/ddos/,
2003.
[15] P. Ferguson and D. Senie. Network ingress ﬁltering:
Defeating denial of service attacks which employ IP
source address spooﬁng. RFC 2267, January 1998.
[16] L. Garber. Denial-of-service attacks rip the Internet.
In IEEE Computer, volume 33, April 2000.
[17] Virgil Gligor. On denial of service in computer net-
works. In Proceedings of International Conference on
Data Engineering, pages 608–617, February 1986.
[18] Virgil Gligor. Guaranteeing access in spite of service-
ﬂooding attacks. In Proceedings of the Security Pro-
tocols Workshop, April 2003.
[19] Michael Goodrich. Efﬁcient packet marking for large-
In Proceedings of the 9th ACM
scale IP traceback.
Conference on Computer and Communications Secu-
rity, pages 117–126. ACM Press, 2001.
[20] Christian E. Hopps. Analysis of an equal-cost multi-
path algorithm. Internet Request for Comment RFC
2992, Internet Engineering Task Force, November
2000.
[21] J. Howard. An Analysis of Security Incidents on the
Internet. PhD thesis, Carnegie Mellon University, Au-
gust 1998.
[22] John Ioannidis and Steven M. Bellovin. Implement-
ing pushback: Router-based defense against DDoS
attacks.
In Proceedings of the Symposium on Net-
work and Distributed Systems Security (NDSS 2002),
February 2002.
[23] Hani Jamjoom and Kang G. Shin. Persistent dropping:
An efﬁcient control of trafﬁc aggregates. In Proceed-
ings of ACM SIGCOMM ’03, pages 287–297, August
2003.
[24] Jaeyeon Jung, Balachander Krishnamurthy,
and
Michael Rabinovich. Flash crowds and denial of ser-
vice attacks: Characterization and implications for
CDNs and web sites.
In The Eleventh International
World Wide Web Conference (WWW 11), May 2002.
[25] A. Keromytis, V. Misra, and D. Rubenstein. SOS: Se-
cure Overlay Services. In Proceedings of ACM SIG-
COMM, August 2002.
[26] Heejo Lee and Kihong Park. On the effectiveness of
probabilistic packet marking for IP traceback under
denial of service attack.
In Proceedings IEEE Info-
comm 2001, April 2001.
[27] Ratul Mahajan, Steven M. Bellovin, Sally Floyd, John
Ioannidis, Vern Paxson, and Scott Shenker. Control-
ling high bandwidth aggregates in the network. CCR,
32(3):62–73, July 2002.
[28] A. Mankin, D. Massey, C.L. Wu, S.F. Wu, and
L. Zhang. On design and evaluation of intention-
driven ICMP traceback. In Proceedings of IEEE Inter-
national Conference on Computer Communications
and Networks, October 2001.
[29] Jelena Mirkovic, Gregory Prier, and Peter Reiher. At-
tacking DDoS at the source. In ICNP, 2002.
[30] Jeffrey Mogul and Steve Deering. Path MTU discov-
ery. Internet Request for Comment RFC 1191, Internet
Engineering Task Force, November 1990.
[31] David Moore, Geoffrey Voelker, and Stefan Savage.
Inferring Internet denial of service activity.
In Pro-
ceedings of the 10th USENIX Security Symposium,
Washington, D.C., August 2001. USENIX.
[32] Kihong Park and Heejo Lee. On the effectiveness
of route-based packet ﬁltering for distributed DoS at-
tack prevention in power-law internets. In ACM SIG-
COMM ’01, pages 15–26, 2001.
[33] Vern Paxson. End-to-end routing behavior in the inter-
net. In ACM SIGCOMM Computer Communications
Review, volume 26, pages 25–38, October 1996.
[34] Vern Paxson. An analysis of using reﬂectors for dis-
tributed denial-of-service attacks. Computer Commu-
nication Review, 31(3), July 2001.
[35] Stefan Savage, David Wetherall, Anna Karlin, and
Tom Anderson. Network support for IP traceback.
ACM/IEEE Transactions on Networking, 9(3), June
2001.
[36] Colleen Shannon, David Moore, and K. C. Claffy.
Beyond folklore: observations on fragmented traf-
ﬁc.
IEEE/ACM Transactions on Networking (TON),
10(6), 2002.
[37] Alex C. Snoeren, Craig Partridge, Luis A. Sanchez,
Christine E. Jones, Fabrice Tchakountio, Beverly
Proceedings of the 2004 IEEE Symposium on Security and Privacy (S&P’04)  
1081-6011/04 $ 20.00 © 2004 IEEE 
13
Schwartz, Stephen T. Kent, and W. Timothy Strayer.
Single-packet IP traceback. IEEE/ACM Transactions
on Networking (ToN), 10(6), December 2002.
[38] Dawn Song and Adrian Perrig. Advanced and authen-
ticated marking schemes for IP traceback. In Proceed-
ings IEEE Infocomm 2001, April 2001.
[39] Ion Stoica, Daniel Adkins, Shelley Zhuang, Scott
Shenker, and Sonesh Surana. Internet Indirection In-
frastructure. In Proceedings of ACM SIGCOMM 2002,
pages 10–20, August 2002.
[40] Ion Stoica, Scott Shenker, and Hui Zhang. Core-
stateless fair queueing: A scalable architecture to ap-
proximate fair bandwidth allocations in high speed
networks. In SIGCOMM ’98, 1998.
[41] Ion Stoica and Hui Zhang. Providing guaranteed ser-
vices without per ﬂow management. In Proceedings
of ACM SIGCOMM’99, pages 81–94, 1999.
[42] Robert Stone. CenterTrack: An IP overlay network
for tracking DoS ﬂoods.
In Proceedings of the 9th
USENIX Security Symposium. USENIX, August 2000.
[43] Minho Sung and Jun Xu. IP traceback-based intelli-
gent packet ﬁltering: A novel technique for defending
against internet DDoS attacks. In Proceedings of IEEE
ICNP 2002, November 2002.
[44] R. Teixera, K. Marzullo, S. Savage, and G. Voelker.
Characterizing and measuring path diversity of inter-
net topologies. In SIGMETRICS’03, June 2003.
[45] R. van den Berg and P. Dibowitz. Over-zealous secu-
rity administrators are breaking the Internet. In Pro-
ceedings of 2002 LISA Conference, November 2002.
[46] XiaoFeng Wang and Michael K. Reiter. Defending
against denial-of-service attacks with puzzle auctions.
In Proceedings of IEEE Symposium on Security and
Privacy, May 2003.
[47] Abraham Yaar, Adrian Perrig, and Dawn Song. Pi:
A Path Identiﬁcation mechanism to defend against
DDoS attacks.
In Proceedings of IEEE Symposium
on Security and Privacy, May 2003.
A Fragmentation and the IP Identiﬁcation
Field
Placing a marking in the IP Identiﬁcation ﬁeld of every
packet in the network is incompatible with the current IPv4
fragmentation mechanism (except under very strict network
assumptions such as no packet reordering or loss). De-
spite the fact that fragmented trafﬁc represents only between
0.25% and 0.75% of packets in the Internet [36, 41], we
consider a mechanism to allow packet marking to coexist
with fragmentation.
We offer the solution that routers only mark packets that
will never get fragmented and that are not fragments them-
selves. The latter class is simple to identify, as these pack-
ets will have a non-zero Fragment Offset ﬁeld in their
header or a more fragments ﬂag which is set. Deter-
mining which packets will never get fragmented is more
challenging. The simplest classiﬁcation is those IP pack-
ets that have the Do Not Fragment (DF) bit set in the
Flags ﬁeld of the IP header. This classiﬁcation is ade-
quate for servers with a majority of TCP trafﬁc – as most
modern TCP implementations set the DF bit by default [45],
as speciﬁed by the Path MTU Discovery standard in RFC
1191 [30]. Packets that do not match this predicate are
ineligible for being EXP packets. DTA packets could be
fragmented, provided that all the fragments follow the same
path through the network, and that the fragmenting router
doesn’t reset any of the reserved bits that are normally set
in a DTA packet.
Unfortunately, the DF classiﬁcation is inadequate for
UDP trafﬁc, of which a much smaller percent of trafﬁc has
the DF bit set. Without the DF bit, classifying packets that
will never be fragmented is no longer 100% accurate. An
alternative method would be to only mark UDP trafﬁc that
is smaller than the smallest Maximum Transmission Unit
(MTU) for common Internet trafﬁc links. A widely ac-
cepted value for this is 576 bytes [7], however, lower MTU
links are possible and perhaps likely, with the expected pro-
liferation of web-enabled phones. We show the percent of
markable trafﬁc from a 31 day trace of packets from the
Lawrence Berkeley Lab DMZ in Table 2. In either case,
the networking community will need to agree on a speciﬁc
value for a minimum MTU before we can execute our hand-
shake algorithm over non-DF or UDP speciﬁc services.
Packet Classiﬁcation
TCP with DF
UDP with DF
UDP ≤576b or DF Set
UDP ≤250b or DF Set
UDP ≤100b or DF Set
Percent markable
98.24%
26.69%
87.12%
79.06%
64.75%
Table 2. Percent of packets that can be
marked by classiﬁcation. Average over 31
days of trafﬁc from Lawrence Berkeley Lab
DMZ, May 1-31, 2003.
Proceedings of the 2004 IEEE Symposium on Security and Privacy (S&P’04)  
1081-6011/04 $ 20.00 © 2004 IEEE 
14