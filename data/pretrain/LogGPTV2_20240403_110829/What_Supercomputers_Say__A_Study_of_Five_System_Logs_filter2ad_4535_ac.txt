MessagesAlertsSeverityCount%Count%FATAL855,50118.02348,39899.98FAILURE17140.03620.02SEVERE19,2130.4100ERROR112,3552.3700WARNING23,3570.4900INFO3,735,82378.6800Table5.ThedistributionofseverityﬁeldsforBG/Lamongallmessagesandamongourexpert-taggedalerts.TaggingallFA-TAL/FAILUREseveritymessagesasalertswouldhaveyieldeda59%falsepositiverate.MessagesAlertsSeverityCount%Count%EMERG30.0000ALERT6540.00450.00CRIT1,552,9106.091,550,21798.69ERR2,027,5987.9511,7840.75WARNING2,154,9448.452700.02NOTICE3,759,62014.7400INFO15,722,69561.638,4500.54DEBUG291,7641.1400Table6.ThedistributionofseverityﬁeldsforRedStormsyslogsamongallmessagesandamongourexpert-taggedalerts.ThesesyslogalertsweredominatedbydiskfailuremessageswithCRITseverity.Exceptforthisfailurecase,thesedatasuggestthatsyslogseverityisnotareliablefailureindicator.sarilyrelatetothereliabilityofthesystemsinanymeaning-fulway.Theheuristicsprovidedbytheadministratorswereoftenintheformofregularexpressionsamenableforcon-sumptionbythelogsurferutility[18].Weperformedthetaggingthroughacombinationofregularexpressionmatchingandmanualintervention.Theadministratorswithwhomweconsultedwereresponsiblefortheirrespectivesystemsthroughouttheperiodoflogcollectionandthepub-licationofthiswork.Examplesofalert-identifyingrulesus-ingawksyntaxinclude(fromSpirit,RedStorm,andBG/L,respectively)includethefollowing:/kernel:EXT3-fserror//PANIC_SPWEARETOASTED!/($5˜/KERNEL/&&/kernelpanic/)PreviousworkonBG/Lloganalysisusedsimplealertidentiﬁcationschemessuchastheseverityﬁeldofmessages[9,10,20]oranexternalsourceofinformation[21,25].Becauseourobjectivewasnottosuggestanalertdetectionscheme,butrathertoaccuratelycharacterizethecontentofthelogs,weinsteadusedthetime-consumingmanualpro-cessdescribedabove.Wediscovered,furthermore,thatad-ministratorsforthesemachinesdonotusetheseverityﬁeldasthesingularwaytodetectalerts,andthatmanysystems(Thunderbird,Spirit,andLiberty)didnotevenrecordthisinformation.Table5showsthedistributionofseverityﬁeldsamongmessagesandamongunﬁlteredalerts.IfwehadusedtheseverityﬁeldinsteadoftheexpertrulestotagalertsonBG/L,tagginganymessagewithaseverityofFATALorFAILUREasanalert,wewouldhaveafalsenegativerateof0%butafalsepositiverateof59.34%.OftheSandiasys-tems,onlyRedStormisconﬁguredtostoretheseverityofsyslogmessages(theRedStormTCPlogpathisnotsyslogandhasnoseverityanalog).Table6givestheseveritydis-tribution,whichsuggeststhatsyslogseverityisofdubiousvalueasafailureindicator.Theuseofmessageseveritylev-elsasacriterionforidentifyingfailuresbedoneonlywithconsiderablecaution.3.2.1AlertIdentiﬁcationChallengesAutomaticallyidentifyingalertsinsystemlogsisanopenproblem.Tofacilitateothersintacklingthischallenge,weofferthefollowingaccountofissuesweobservedwhilemanuallytaggingthelogsthatmustbeaddressedbyanau-tomatedscheme:InsufﬁcientContext.Manylogmessagesareambiguouswithoutexternalcontext.Themostsalientpieceofmissinginformationwaswhatwecalloperationalcontext,whichhelpstoaccountforthehumanandotherexternalfactorsthatinﬂuencethesemanticsoflogmessages.Forexample,considerthefollowingambiguousexamplemessagefromBG/L(anonymized):YY-MM-DD-HH:MM:SSNULLRASBGLMASTERFAILUREciodbexitednormallywithexitcode0Thismessagehasaveryhighseverity(FAILURE),butthemessagebodysuggeststhattheprogramexitedcleanly.Ifthesystemadministratorwasdoingmaintenanceonthemachineatthetime,thismessageisaharmlessartifactofhisactions.Ontheotherhand,ifitwasgenerateddur-ingnormalmachineoperation,thismessageindicatesthatallrunningjobsonthesupercomputerwere(undesirably)killed.Thedisparitybetweenthesetwointerpretationsistremendous.Onlywithadditionalinformationsuppliedbythesystemadministratorcouldweconcludethatthismes-sagewaslikelyinnocuous.Inourexperience,operationalcontextisoneofthemostvital,butoftenabsent,factorsindecipheringsystemlogs.AsseeninFigure1,operationalcontextmayindicatewhetherasystemisinengineeringorproductiontime.San-dia,LosAlamos,andLivermoreNationalLaboratoriesarecurrentlyworkingtogethertodeﬁneexactlywhatinforma-tionisneeded,andhowtouseittoquantifyRASperfor-mance[24].Itmaybesufﬁcienttorecordonlyafewbytes37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
Operations TimeUptimeProductionTimeEngineeringTimeDowntimeUnscheduledDowntimeScheduledDowntimeyesnoRepair  Diagnosis  Corrective action  VerificationFacilities RelatedPreventative MaintenanceSystem Software or  Hardware ChangesFacilities RelatedSystem Software,  Hardware, or Process    experiments or    qualificationAvailable? (Ready to perform   intended function)Productionuse?Total TimeIntegrationTimeyesnoInstallationMajor  reconfigurationHardwareOperational?yesnoProduction ComputingFigure1.Operationalcontextexample.Eventsigniﬁcancecanbedisambiguatediftheex-pectedstateofcomponentsisknown.ThisdiagramisthecurrentbasisofRedStormRASmetrics,andisbeingdevelopedbyLANL,LLNL,andSNLtowardsestablishingstandardizedRASperformancemetrics.ofdata:thetimeandcauseofsystemstatechanges.Forex-ample,thecommencementofanOSupgradewouldbeac-companiedbyamessageindicatingthatattimetthesystementeredscheduleddowntimeforasystemsoftwareinstal-lation.Asimilarmessagewouldaccompanythesystem’sreturntoproductiontime.Thelackofcontexthasalsoaffectedthestudyofparallelworkloads.Feitelsonproposedremovingnon-productionjobsfromworkloadtraces(suchasworkloadﬂurriesat-tributabletosystemtesting[5]).Analogously,somealertsmaybeignoredduringascheduleddowntimethatwouldbesigniﬁcantduringproductiontime.AsymmetricReporting.Somefailuresleavenoevidenceinthelogs,andthelogsarefraughtwithmessagesthatin-dicatenothingusefulatall.Moreinsidiously,evensinglefailuretypesmayproducevaryingalertsignaturesinthelog.Forexample,theRedStormDDNsystemgeneratesagreatvarietyofalertpatternsthatallmean“diskfailure”.Nodesalsogeneratedifferinglogsaccordingtotheirfunc-tion.Figure2(b)showsthenumberofmessagesbrokendownbysource.Thechattysourcestendedtobethead-ministrativenodesorthosewithpersistentproblems,whilethereticentsourceswereeithermisconﬁguredorimprop-erlyattributed(theresultofcorruptedmessages).SystemEvolution.Loganalysisisamovingtarget.Overthecourseofasystem’slifetime,anythingfromsoftwareupgradestominorconﬁgurationchangescandrasticallyal-terthemeaningorcharacterofthelogs.Figure2(a)showsdramaticshiftsinbehaviorovertime.Thismakesmachinelearningdifﬁcult:learnedpatternsandbehaviorsmaynotbe!!!!!!!!!!!!!!!!!!!050150Time (2006 Quarters)Source NumberJanAprJulOct!GM_PAR (n=19)GM_LANAI (n=10)Figure3.TworelatedclassesofalertsfromLiberty.NoticethatGMLANAImessagesdonotalwaysfollowGMPARmessages,norviceversa.However,thecorrelationisclear.Currenttaggingandﬁlteringtechniquesdonotadequatelyaddressthissituation.applicableforverylong.Theabilitytodetectphaseshiftsinbehaviorwouldbeavaluabletoolfortriggeringrelearningorforknowingwhichexistingbehavioralmodeltoapply.ImplicitCorrelation.Groupsofmessagesaresometimesfundamentallyrelated,butthereisnoexplicitindicationofthis.SeeFigures3and4.Acommonsuchcorrelationre-sultsfromcascadingfailures.InconsistentStructure.DespitethenobleeffortsoftheBSDsyslogstandardandothers,logmessagesvarygreatlybothwithinandacrosssystems.BG/LandRedStormusecustomdatabasesandformats,andcommoditysyslog-basedsystemsdonotevenrecordﬁeldssuchasseveritybydefault.Ultimately,understandingtheentriesmayre-quireparsingtheunstructuredmessagebodies,therebyre-ducingtheproblemtonaturallanguageprocessingontheshorthandofmultipleprogrammers(considerTable4).Loganonymizationisalsotroublesome,becausesensitiveinfor-mationlikeusernamesisnotrelegatedtodistinctﬁelds[6].Ourlogdataarenotavailableforpublicstudyprimarilybe-causewecannotremoveallsensitiveinformationwithsuf-ﬁcientconﬁdence.Weareworkingtoovercomethischal-lengeandtoreleasethelogs.Corruption.Evenonsupercomputerswithhighlyengi-neeredRASsystems,likeBG/LandRedStorm,logen-triescanbecorrupted.Wesawmessagestruncated,partiallyoverwritten,andincorrectlytimestamped.Forexample,wefoundmanycorruptedvariantsofthefollowingmessageonThunderbird(onlythemessagebodiesareshown):kernel:VIPKL(1):[create_mr]MM_bld_hh_mrfailed(-253:VAPI_EAGAIN)37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
1e+011e+031e+05Time (years)Count (number of logmessages per hour)20052006(a)Thenumberofmessages,bucketedbyhour.Wearetoldthattheﬁrstmajorshift(endofﬁrstquarter,2005)correspondedtoanupgradeintheoperatingsystemafterthemachinewasputintoproductionuse.Thecausesoftheothershiftsarenotwellunderstoodatthistime.0501001502002501e+001e+041e+08Source NumberCount (number of logmessages per source)(b)Thenumberofmessagesbymessagesource,sortedbydecreasingquantity.Themostproliﬁcsourceswereadministrativenodesorthosewithsigniﬁcantproblems.Theclusteratthebottomisfromthesetofmessageswhosesourceﬁeldwascorrupted,thwartingattribution.Figure2.ThenumberofmessagesgeneratedbyLiberty.Somecorruptedversionsofthatlineinclude:kernel:VIPKL(1):[create_mr]MM_bld_hh_mrfailed(-253:VAPI_EAure=nokernel:VIPKL(1):[create_mr]MM_bld_hh_mrfailed(-253:VAPI_EAGAIkernel:VIPKL(1):[create_mr]MM_bld_hh_mrfailed(-253:VAPI_EAGsys/mosal_iobuf.c[126]:dumpiobufat0000010188ee7880:3.3FilteringAsinglefailuremaygeneratealertsacrossmanynodesormanyalertsonasinglenode.Filteringisusedtore-ducearelatedsetofalertstoasingleinitialalertperfailure;thatis,tomaketheratioofalertstofailuresnearlyone.Thissectionmotivatestheneedforeffectiveﬁlteringandthendescribesouralgorithm,whichisbasedonpreviouswork[9,10]withsomeincrementaloptimizations.Brieﬂy,theﬁlteringremovesanalertifanysourcehadgeneratedthatcategoryofalertwithinthelastTseconds,foragiventhresholdT.Twoalertsareinthesamecategoryiftheywerebothtaggedbythesameexpertrule.3.3.1MotivationforFilteringDuringtheﬁrstquarterof2006,Libertysaw2231job-fatalalertsthatwerecausedbyatroublesomesoftwarebuginthePortableBatchSystem(PBS).Thealerts,whichreadpbsmom:taskcheck,cannottmreply,indicatedthattheMPIrank0momdied.Jobsafﬂictedbythisbugcouldnotcompleteandwereeventuallykilled,butnotbeforegeneratingthetaskcheckmessageupto74times.Weestimatethatthisbugkilledasmanyas1336jobsbeforeitwastrackeddownandﬁxed(seeFigure4).BetweenNovember10,2005andJuly10,2006,Thun-derbirdexperienced3,229,194so-called“LocalCatas-trophicErrors”relatedtoVAPI(theexactnatureofmanyofthesealertsisnotwell-understoodbyourexperts).A!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Time (2006 Quarters)JanAprJulOctGM_MAPPBS_CONGM_LANAIGM_PARPBS_BFDPBS_CHK25101994920TotalsFigure4.CategorizedﬁlteredalertsonLib-ertyovertime.ThehorizontalclustersofPBSCHKandPBSBFDmessagesarenotevidenceofpoorﬁltering;theyareactuallyinstancesofindividualfailures.Speciﬁcally,theyarethemanifestationofthePBSbugde-scribedinSection3.3.1.Thesetwotagsareaparticularlyoutstandingexampleofcorre-latedalertsrelegatedtodifferentcategories.singlenodewasresponsiblefor643,925ofthem,ofwhichﬁlteringremovesallbut246.TheSpiritlogswerelargest,despitethesystembe-ingthesecondsmallest.Thiswasduealmostentirelytodisk-relatedalertmessageswhichwererepeatedmillionsoftimes.Forexample,overasix-dayperiodbetweenFebruary28andMarch5,therewasadiskproblemthattriggeredatotalof56,793,797alerts.Thesewereheavilyconcentratedamongahandfulofproblematicnodes.Overthecompleteobservationperiod,nodeidsn373logged89,632,571suchmessages,whichwasmorethanhalfofallSpiritalerts.3.3.2FilteringAlgorithmAtemporalﬁltercoalescesalertswithinTsecondsofeachotheronagivensourceintoasinglealert.Forexample,ifanodereportsaparticularalerteveryTsecondsforaweek,thetemporalﬁlterkeepsonlytheﬁrst.Similarly,aspatialﬁlterremovesanalertifsomeothersourcehadpre-37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
viouslyreportedthatalertwithinTseconds.Forexample,ifknodesreportthesamealertinaround-robinfashion,eachmessagewithinTsecondsofthelast,thenonlytheﬁrstiskept.Previousworkappliedtheseﬁltersserially[9,10].Ourﬁlteringalgorithm,however,performsbothtempo-ralandspatialﬁlteringsimultaneously;analertmessagegeneratedbysourcesisconsideredredundant(andre-moved)ifanysource,includings,hadreportedthatalertcategorywithinTseconds.Thischangereducescompu-tationalcosts(16%fasterontheSpiritlogs),andincreasesconceptualsimplicity.WeappliedthisﬁltertothelogsfromtheﬁvesupercomputersusingT=5secondsincorrespon-dencewithpreviouswork[4,9,10].Thealgorithminpseu-docodeisgivenbelow,whereAisthesequenceofNunﬁl-teredalerts.Alertaihappensattimetiandhascategoryci.Thesequenceissortedbyincreasingtime.ThetableXisusedtostorethelasttimeatwhichaparticularcategoryofalertwasreported.Algorithm3.1:LOGFILTER(A)l←0fori←1toNdoifti−l>Tthenclear(X)l←tiifci∈Xandti−X[ci]<TthenX[ci]←tielse%X[ci]←tioutput(ai)Thisﬁltermayremoveindependentalertsofthesamecategorythat,bycoincidence,happennearthesametimeondifferentnodes.Forexample,nodesn373onSpiritexperi-enceddiskproblemsandoutputtensofmillionsofalertsoverthecourseofseveraldays.Coincidentally,anothernode(sn325)hadanindependentdiskfailureduringthistime.Ourﬁlterremovedthesymptomaticalert,erroneously.Insomecases,serialﬁlteringfailstoremovealertsthatsharearootcause,andwhichahumanwouldconsidertoberedundant.Theproblemariseswhenthetemporalﬁlterremovesmessagesthatthespatialﬁlterwouldhaveusedascuesthatthefailurehadalreadybeenreportedbyanothersource.Alertsremovedbyourﬁlterthatwouldbeleftbyserialﬁlterstendtoindicatefailuresinsharedresourcesthatwerepreviouslynoticedbyanothernode.Themostcom-monsucherrorsinLiberty,Spirit,andThunderbirdwererelatedtothePBSsystem.Atmostonetruepositivewasremovedonanysinglema-chine,whereassometimesdozensoffalsepositiveswereremovedbyusingourﬁlterinsteadoftheserialalgorithm.Limitingfalsepositivestoanoperationally-acceptableratetendstobethecriticalfactorinfaultandintrusiondetectionsystems,soweconsiderthistrade-offtobejustiﬁed.Interarrival Time (seconds)Count050001500002060(a)Interarrival Time(log(seconds))Count2468100102030(b)Figure5.CriticalECCmemoryalertsonThunderbird.Thesedataareﬁltered,butthathadlittleeffectonthedistribution.Both(a)and(b)arethesamedata,viewedindifferentways.Weconcludethattheselow-levelfail-uresarebasicallyindependent.4AnalysisModelingthetimingoffailureeventsisacommonen-deavorinsystemsresearch;thesemodelsarethenusedtostudytheeffectsoffailuresonotheraspectsofthesystem,suchasjobschedulingorcheckpointingperformance.Fre-quently,formathematicalconvenienceandreferencetoba-sicphysicalphenomena,failuresaremodeledasoccurringindependently(exponentialinterarrivaltimes).Forlow-levelfailurestriggeredbysuchphysicalphenomena,thesemodelsareappropriate;wefoundthatECCfailures(mem-oryerrorsthatwerecritical,ratherthansinglebiterrors)be-havedasexpected.Figure5showstheseﬁlteredalertdis-tributionsonThunderbird,wherethedistributionappearsexponentialandisroughlylognormalwithaheavylefttail.Formostotherkindsoffailures,however,thisindepen-denceisnotanappropriateassumption.Failurepredictionbasedontimeinterdependenceofeventshasbeenthesub-jectofmuchresearch[9,11,13,19],andithasbeenshownthatsuchpredictioncanbeapotentresourceforimprovingjobscheduling[17],QoS[16],andcheckpointing[14,15].WeexpectedCPUclockingalerts,forinstance,tobesimilartoECCalerts:drivenbyabasicphysicalprocess.Weweresurprisedtoobserveclearspatialcorrelations,anddiscoveredthatabugintheLinuxSMPkernelspedupthesystemclockunderheavynetworkload.Thus,wheneverasetofnodeswasrunningacommunication-intensivejob,theywouldcollectivelybemorepronetoencounteringthisbug.Weinvestigatedthismessageonlyafternoticingthatitsoccurrencewasspatiallycorrelatedacrossnodes.Throughourattemptstomodelfailuredistributions,weareconvincedthatsupercomputerfailuretypesarediverseintheirproperties.Someclearlyappeartobelognormal(Figure5(a)),mostclearlydonot(Figures6(a)and5(b)).Ineventhebestvisualﬁtcases,heavytailsresultinverypoorstatisticalgoodness-of-ﬁtmetrics.Whilethetempta-37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 