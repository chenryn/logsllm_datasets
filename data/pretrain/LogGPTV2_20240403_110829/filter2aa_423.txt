Golangçº¢é˜Ÿå¼€å‘æŒ‡å—
ç›®å½•
1
2
3
ProjectDiscovery
Golang æ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
Golang C2 Sliver
1. åƒPythonä¸€æ ·ç®€å•ï¼Œä»£ç å¯è¯»æ€§å¥½
2. ç®€å•çš„å¤šæ¶æ„äº¤å‰ç¼–è¯‘æ”¯æŒ
3. è¯­æ³•å±‚é¢çš„å¹¶å‘æ”¯æŒ
4. æ˜“ç”¨çš„åŒ…ç®¡ç† & å¾ˆå¤šçº¢é˜Ÿç”Ÿæ€
å‰è¨€
ä¸ºä»€ä¹ˆæ˜¯Go
Par t1ï¼šProjectDiscover y
åŸŸåæ”¶é›†
Subfinderï¼šé€šè¿‡å„ç§apiæ¥å£è¢«åŠ¨æ”¶é›†å­åŸŸå
Uncoverï¼šæ•´åˆå„ç§ç½‘ç»œç©ºé—´å¼•æ“apiæ¥å£
Dnsxï¼šdnséªŒè¯
èµ„äº§æ¢æµ‹
Httpxï¼šwebä¿¡æ¯æ¢æµ‹
Naabuï¼šç«¯å£æ‰«æ
PoC
Nucleiï¼šPocæ‰¹é‡æ¢æµ‹
é€šçŸ¥
Notifyï¼šæ•´åˆç¬¬ä¸‰æ–¹ç»“æœé€šçŸ¥
ProjectDiscovery
https://github.com/projectdiscovery
HTTPXï¼šWebä¿¡æ¯æ¢æµ‹
https://github.com/projectdiscovery/httpx
Features
HTTPXï¼šWebä¿¡æ¯æ¢æµ‹
1. http/httpsæ¢æµ‹é€»è¾‘
2. Autofdmax
â€¢ github.com/projectdiscovery/fdmax
3. CdnCheck
â€¢ github.com/projectdiscovery/cdncheck
â€¢ æ•´ç†CDNçš„ipæ®µï¼Œåˆ¤æ–­ipæ˜¯å¦åœ¨è¿™äº›ipæ®µä¸­
4. Retryablehttp
â€¢ å¯é‡è¯•httpè¯·æ±‚åº“
â€¢ github.com/projectdiscovery/retryablehttp-go
â€¢ github.com/projectdiscovery/fastdialer/fastdialer
Tricks
HTTPX å¹¶å‘æ§åˆ¶
github.com/projectdiscovery/httpx/blob/master/runner/runner.go#L670
Module: github.com/remeh/sizedwaitgroup
Goå¸¸ç”¨å¹¶å‘æ§åˆ¶
â€¢ sync.WaitGroup
â€¢ github.com/remeh/sizedwaitgroup
â€¢ github.com/uber-go/ratelimit
â€¢ Goroutine work pool
åç¨‹æ± 
ä¾‹å­: å¹¶å‘æ§åˆ¶
Context.WithCancelï¼šç”Ÿæˆä¸€ä¸ªå¯å–æ¶ˆçš„ Contextã€‚
ä¾‹å­ï¼šWEBæŒ‡çº¹è¯†åˆ«
Naabu: ç«¯å£æ‰«æå™¨
https://github.com/projectdiscovery/naabu/blob/master/v2/go.mod
å¿«é€Ÿæ‰«æçš„ç§˜å¯†
â€¢ synæ‰«æåŸºäºç³»ç»Ÿsocketå‘åŒ…ï¼Œlibpcapæ¥æ”¶
â€¢ blackrock:éšæœºåŒ–æ‰«æç®—æ³•
Golang with libpcap
é™æ€ç¼–è¯‘
GOENABLE: 1
CGO_LDFLAGS: "-Wl,-static -L/usr/lib/x86_64-linux-gnu/libpcap.a -lpcap -Wl,-Bdynamic"
ç”¨é€”
DNSçˆ†ç ´ï¼Ÿ(https://github.com/boy-hack/ksubdomain)
Linux Port Knocking?
Golang with libpcap
Subfinderï¼šå­åŸŸåè¢«åŠ¨æœç´¢
https://github.com/projectdiscovery/subfinder
æ’ä»¶ç»„ç»‡
Subfinder é›†æˆ
Nucleiï¼šPoCæ¢æµ‹
https://github.com/projectdiscovery/nuclei-templates
https://github.com/projectdiscovery/nuclei
Nuclei DSL
github.com/Knetic/govaluate
github.com/boy-hack/govaluate
Nucleiï¼šå…¶ä»–
1. è¯·æ±‚åˆå¹¶
â€¢ æ¯”è¾ƒæ¨¡æ¿è¯·æ±‚ä¸­çš„methodï¼Œæœ€å¤§é‡å®šå‘æ•°ï¼Œæ˜¯å¦å…±äº«cookieè¯·æ±‚ï¼Œ
æ˜¯å¦é‡å®šå‘
â€¢ æ¯”è¾ƒè¯·æ±‚çš„path
â€¢ æ¯”è¾ƒè¯·æ±‚çš„header
2. é¡¹ç›®ä¿å­˜
â€¢ projectfileæ˜¯nucleiæä¾›äº†å¯ä»¥ä¿å­˜é¡¹ç›®çš„é€‰é¡¹ã€‚
â€¢ å†…éƒ¨å®ç°æ˜¯é€šè¿‡ä¸€ä¸ªmapä¿å­˜äº†æ‰€æœ‰è¯·æ±‚çš„åŒ…ä»¥åŠè¿”å›ç»“æœï¼Œkey
æ˜¯å¯¹è¯·æ±‚ä½“(request struct)åºåˆ—åŒ–åè¿›è¡Œsha256è¿ç®—ã€‚
Nuclei é›†æˆ
github.com/projectdiscovery/nuclei/v2 v2.6.0
æ¨¡æ¿è§£æ
Nuclei é›†æˆ
github.com/projectdiscovery/nuclei/v2 v2.6.0
æ¨¡æ¿æ‰§è¡Œ
è®¾è®¡æ¨¡å¼:Pipeline
ProjectDiscovery é›†æˆ
Par t2ï¼šGolangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
æ¤å…¥ç«¯ï¼šä»»ä½•æŠ•é€’åˆ°ç›®æ ‡ç¯å¢ƒçš„éƒ½å«æ¤å…¥ç«¯
é¢„ç¼–è¯‘é˜¶æ®µ
åå¤„ç†é˜¶æ®µ
æ‰§è¡Œé˜¶æ®µ
æºç ç”Ÿæˆ
æŠ•é€’
ç¼–è¯‘é˜¶æ®µ
å¯¹æŠ—ç‚¹
é™æ€ç‰¹å¾
è¡Œä¸ºå¯¹æŠ—
å†…å­˜å¯¹æŠ—
é™æ€åˆ†æ
è§£å†³æ–¹æ¡ˆ
æºç æ··æ·†
å»é™¤Goç¬¦å·
Goå…æ€æ¡†æ¶
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
çµæ„Ÿæ¥æº
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
åŸºäºæŠ½è±¡è¯­æ³•æ ‘(AST)  
æºç æ··æ·†
â€¢ é•¿æ–‡æœ¬æ‹†åˆ†
â€¢ å­—ç¬¦ä¸²ã€å¸¸é‡åŠ å¯†
â€¢ è™šå‡åˆ†æ”¯
â€¢ æ§åˆ¶æµæ··æ·†
æ··æ·†å‰
æ··æ·†å
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
é•¿æ–‡æœ¬æ‹†åˆ†
æ··æ·†å‰
æ··æ·†å
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
å­—ç¬¦ä¸²ã€å¸¸é‡åŠ å¯†
æ··æ·†å‰
æ··æ·†å
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
ä¸é€æ˜è°“è¯ï¼šx * (x + 1) % 2 == 0 å¯¹äºä»»æ„æ•´æ•°xï¼Œæ˜¯æ°¸çœŸ
æ¡ä»¶
å¯ä¼˜åŒ–ï¼šä½¿ç”¨APIå¦‚CreateFileçš„è¿”å›å€¼ï¼Œæˆ–å†…ç½®å‡½æ•°çš„é”™
è¯¯è¾“å‡ºä½œä¸ºæ¡ä»¶
_, err := strconv.ParseBool("x\xff")
è™šå‡åˆ†æ”¯
æ··æ·†å‰
æ··æ·†å
é¢„ç¼–è¯‘é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
æ§åˆ¶æµæ··æ·†
æ··æ·†å‰
æ··æ·†å
åå¤„ç†é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
Golangç¬¦å·æ··æ·†
â€¢ https://github.com/0xjiayu/go_parser
â€¢ https://github.com/goretk/redress
https://github.com/goretk/gore
Packages
Extracting types
Estimating source code layout
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
åå¤„ç†é˜¶æ®µ Golangç¬¦å·æ··æ·†æ–¹æ¡ˆ
go-strip
â€¢ github.com/boy-hack/go-strip
â€¢ ç¼–è¯‘è¿‡ç¨‹ä¸­æ··æ·†
â€¢ æ”¯æŒæ¶ˆé™¤/æ··æ·†
â€¢ å‡½æ•°åç§°
â€¢ å‡½æ•°è·¯å¾„
â€¢ Go Struct
â€¢ Type
â€¢ Go Compiler Version
â€¢ Go BuildID
â€¢ Go Root Path
â€¢github.com/unixpickle/gobfuscate
â€¢ Pkgé‡å®šä½ï¼Œgorooté‡å®šä½ï¼Œstringæ··æ·†
â€¢ æºç å±‚é¢æ··æ·†
â€¢github.com/burrowers/garble
â€¢ Replace Many useful identifiiers,package paths 
filename
â€¢ Remote build and module information
â€¢ æ··æ·†å­—ç¬¦ä¸²
â€¢ ç¼–è¯‘è¿‡ç¨‹ä¸­æ··æ·†
åå¤„ç†é˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
å¤„ç†äºŒè¿›åˆ¶
â€¢ github.com/boy-hack/go-strip
æ‰§è¡Œé˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
å…æ€æ¡†æ¶
ScareCrow
https://github.com/optiv/ScareCrow
â€¢ Crypto
â€¢ aes
â€¢ Evasion
â€¢ ntdll .text reload
â€¢ patch etw
â€¢ syscall
â€¢ Loader
â€¢ binary
â€¢ control
â€¢ dll
â€¢ excel
â€¢ msiexec
â€¢ wscript
amber
https://github.com/EgeBalci/amber
Reflective PE packer
â€¢ github.com/EgeBalci/keystone-go
Crypto
â€¢ sgn
â€¢ Delivery
â€¢ bits
â€¢ hta
â€¢ macro
â€¢ AfterProcessing
â€¢ ç­¾å ã€ä¼ªè£…ç™½æ–‡ä»¶ç‰ˆæœ¬ä¿¡æ¯
æ‰§è¡Œé˜¶æ®µ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
å…æ€æ¡†æ¶
æ‰§è¡Œé˜¶æ®µ Go SDKä¸æ–‡æ¡£ç”Ÿæˆ
Golangæ¤å…¥ç«¯å¯¹æŠ—æ–¹æ¡ˆ
Par t3ï¼šGolang C2 Sliver
ğŸ¤–C2:Command & Control Server.
ğŸ¤–æ¨ªè¡Œç§»åŠ¨ã€æ•°æ®è¯»å–.
ğŸ¤–å°†æµé‡éšè—åœ¨æ­£å¸¸åº”ç”¨ä¸­.
ğŸ¤–ä¸åŒçš„è¿æ¥æ–¹å¼: TCP, P2P, DGA.
ä»€ä¹ˆæ˜¯C2ï¼Ÿ
https://github.com/BishopFox/sliver/
é€šé“ï¼šmTLSã€WireGuardã€HTTP(S)ã€DNS
æ¤å…¥ç«¯ï¼šMacOSã€Windowsã€Linux
Sliver
Sliver
-> implant æ¨¡æ¿
-> garble
-> Staged ä¸»è¦æ˜¯è°ƒç”¨msfæ¥ç”Ÿæˆçš„payload
-> ä½¿ç”¨DNSè¯±é¥µåŸŸå å‘ç°è“é˜Ÿ
Sliver
HTTP/HTTPS é€šä¿¡æµç¨‹
1. è¯·æ±‚å…¬é’¥
2. è¿”å›å…¬é’¥
3. ç”ŸæˆAES KEYï¼Œå…¬é’¥åŠ å¯†
4. ç¡®è®¤ï¼Œè¿”å›session idè¡¨ç¤ºæ³¨å†Œ
5. åç»­implantå‘é€æ•°æ®é™„å¸¦sessionid
Sliver
æ²¡æœ‰Sleep? httpé€šé“çš„å®æ—¶å›æ˜¾
CobaltStrike
TeamServer
é—´éš”ä¸€æ®µè¯·æ±‚ï¼Œè·å¾—æŒ‡ä»¤å’Œç»“æœ
Sliver
TeamServer
è¯·æ±‚ï¼Œè‹¥æ²¡æœ‰æ•°æ®ï¼Œteamserveré˜»å¡ç›´è‡³è¶…æ—¶
æœ‰æ•°æ®åˆ™ç«‹åˆ»è¿”å›ï¼Œimplanté‡æ–°å‘èµ·è¯·
æ±‚
Sliver
é‡æ”¾æ£€æµ‹
å‘é€çš„æŒ‡ä»¤
éšæœºç¼–ç +åŠ å¯†+éšæœºå€¼
Sha1è¿ç®—
å…¥åº“
é‡æ”¾
Error Page
Sliver
DNSé€šä¿¡æµç¨‹
DNSåè®®
â€¢ dnsåŸŸåé™åˆ¶ ä¸º253å­—ç¬¦
â€¢ å¯¹æ¯ä¸€çº§åŸŸåé•¿åº¦çš„é™åˆ¶æ˜¯63ä¸ªå­—ç¬¦
â€¢ ä¸€ä¸ªDNS TXT è®°å½•å­—ç¬¦ä¸²æœ€å¤šå¯åŒ…å«255 ä¸ªå­—ç¬¦
é˜²é‡æ”¾æ”»å‡»ï¼šsha1
Sliver
Goæ¤å…¥ç«¯å˜ä¸ºshellcode
server\generate\binaries.go
ç¼–è¯‘ä¸ºdll
Donutè½¬æ¢
go-donut github.com/binject/go-donut/donut 
æ¶æ„å›¾
TeamServer
Operater
å‰ç½®å™¨
â€¢ å‰ç½®å™¨å°†åŸæœ‰TeamServerçš„é€šä¿¡(HTTPã€
DNS)æ‹†å‡ºæ¥å•ç‹¬ä½œä¸ºä¸€ä¸ªæœåŠ¡ã€‚
â€¢ å‰ç½®å™¨èƒ½å¤Ÿä¸€é”®éƒ¨ç½²ä»¥åŠé”€æ¯ï¼Œé˜²æ­¢æº¯æº
â€¢ å‰ç½®å™¨åŸºäºåä»£ä¼ªè£…ä»»æ„ç½‘ç«™ï¼Œæµé‡éšè—
â€¢ IPé™åˆ¶ï¼Œæ‹¦æˆªå®‰å…¨å‚å•†ã€å¸¸è§æ²™ç®±IP
â€¢ è“é˜Ÿå‘ç°é¢„è­¦åŠŸèƒ½
å‰ç½®å™¨ï¼šé˜²æ­¢æº¯æºã€æµé‡éšè—
è‡ªå·±è®¾è®¡C2ï¼Ÿ
åŠŸèƒ½æ’ä»¶åŒ–
åŸºç¡€ beacon
â€¢ filemanager
â€¢ terminal
screenshot
proxy
Sideload
Darwinï¼šDYLD_INSERT_LIBRARIES
Linuxï¼š
Memfd
Windowsï¼š Dll Reflect
https://github.com/moloch--/grumble
çº¯goå®ç° loadlibrary from memory æ”¯æŒ dllã€soã€dyld
https://github.com/pkujhd/goloader
go obj loader
è‡ªå·±è®¾è®¡C2ï¼Ÿ
åŠŸèƒ½
https://github.com/Binject/binjection
ç”¨äºæ„ŸæŸ“ï¼Œç»™peã€elfã€marchoæ–‡ä»¶æ’å…¥shellcode
https://github.com/WireGuard/wireguard-go
vpn goå®ç°
https://github.com/C-Sto/BananaPhone
windows syscallå®ç°
https://github.com/vyrus001/go-mimikatz
goå†™çš„mimikatz
https://github.com/gen0cide/gscript
å†…ç½®javascriptå¼•æ“çš„droppersç”Ÿæˆæ¡†æ¶
https://github.com/liamg/traitor
linux æå–æ¡†æ¶
https://github.com/optiv/Ivy
vbaç”Ÿæˆæ¡†æ¶
https://github.com/wikiZ/RedGuard
ä¸€æ¬¾C2è®¾æ–½å‰ç½®æµé‡æ§åˆ¶å·¥å…·
https://github.com/shadow1ng/fscan
ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚
https://github.com/redcode-labs/Coldfire
provides various methods useful for malware development in Golang
è‡ªå·±è®¾è®¡C2ï¼Ÿ