b
m
u
N
 21
 19
 17
 15
 13
 11
 9
 7
 5
 3
 1
Fraction of spamming IPs
Fraction of spam
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
m
a
p
S
f
o
n
o
i
t
c
a
r
F
 0
 0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
 1
Fraction of IPs
Figure 2: Fraction of spam sent (y(cid:2)
axis), and number of do-
mains targeted (y axis), by spamming IP addresses for a typical
day’s worth of trafﬁc at the email provider’s servers. The IPs
are reverse sorted by number of spam messages produced.
some existing systems collect information from a large number of
distributed domains, few, if any, build reputation based on observed
patterns across domains. Thus, an IP address that distributes spam
evenly across target domains may evade a blacklist entirely: main-
tenance of these lists typically requires explicit reports from a net-
work about a “loud” IP address, so an IP address that is “low and
slow” to any particular domain may be able to escape detection and
blacklisting.
Previous work has shown that many bots that send spam are com-
paratively low-volume if observed at any one domain [30], but each
of these IP addresses must send low volumes of spam to many do-
mains for them to be “useful” to the spammer. Our analysis con-
ﬁrms this conjecture: Figure 2 shows that about half of all spam (y(cid:2)
axis) comes from the top 15% spamming IP addresses (x-axis); this
subset of IPs targets two or more domains (y-axis). Similarly, the
top spamming IPs responsible for up to 35% of spam target three or
more domains. Thus, observing email sending patterns across do-
mains could help expose sending patterns that are responsible for
sending a signiﬁcant amount of spam.
2.2 The Performance of IP-Based Blacklists
After presenting a brief overview of IP-based blacklists and their
most common operating mode (DNS-based blacklists, or “DNS-
BLs”), we brieﬂy survey the performance of currently used DNS-
based blacklists in terms of two metrics:
• Completeness. The fraction of spamming IP addresses (and
fraction of spam from spammers) that is listed in a blacklist
at the time the spam was received.
• Responsiveness. For the IP addresses eventually listed by a
blacklist, the time for a blacklist to eventually list spamming
IP addresses after they ﬁrst send spam to any target domain.
Our results demonstrate that DNSBLs can be both incomplete and
unresponsive in response to dynamism in IP addresses. We present
additional data that suggests that the email sending characteristics
of spammers—in particular, their transience and the low volume
of spam that they send to any single domain—make it difﬁcult for
blacklists to track the IP addresses of some spammers.
2.2.1 Background: DNS-Based Blacklists (DNSBLs)
DNSBLs are a “hack” on the DNS name resolution infrastructure
to allow users to query for blacklisted IP addresses using existing
DNS client and server protocols and utilities. A DNSBL maintainer
keeps blacklisted IP addresses in a zone ﬁle; the server responds to
a query for a listed IP address (encoded in a domain name) with
another IP address (usually an address such as 127.0.0.2 that
Data Source
Trap 1
Trap 2
Spam
384,521
172,143
IPs
129,243
64,386
Spam from unlisted IPs
At Receipt
134,120 (35%)
17,132 (10%)
After 1 Month
79,532 (20%)
14,534 (8.5%)
Table 1: Fraction of spam at two spam traps from IP addresses
that were unlisted in either Spamhaus or SpamCop, both at the
time the message was received, and the fraction of spam from
IPs that remained unlisted after 1 month.
has no meaning in the DNS resolution infrastructure) but returns
an NXDOMAIN for an unlisted address. DNSBLs offer a lightweight
mechanism for querying a list of IP addresses, but the list mem-
bership must be maintained at least semi-manually. Maintenance
entails not only deciding when a particular IP address should be
added to a blacklist, but also when it should be removed. Blacklist
maintainers typically add an IP address to a blacklist based on re-
ports from network operators (which requires the spammer to raise
the attention of an operator) or by sending spam to a particular spam
trap or traps (which may not see the spam in the ﬁrst place, partic-
ularly if spammers know to avoid them). Because reputation infor-
mation about IP addresses can become “stale” (e.g., due to IP ad-
dress dynamism, renumbering, etc.), the blacklist maintainer must
determine how long an IP address should remain listed; this dura-
tion ranges from 30 minutes to more than a year, depending on the
nature of the problem and resolution.
2.2.2 Completeness
We study the completeness of “reactive” blacklists (i.e., those that
only list IPs based on observed spamming activity or user reports as
opposed to policy (e.g., SORBS [34]) lists all dynamic IP addresses
irrespective of whether they were observed spamming or not). We
consider the two most popular reactive blacklists, Spamhaus [37]
(speciﬁcally the XBL and SBL zones) and SpamCop [36]. To assess
the completeness of existing DNSBLs, we ﬁrst examine whether
blacklists identify the spammers that we observe in one month of
spam from two spam traps. We then observe mail received at a
server that hosts email for hundreds of independent domains to de-
termine how much of the mail that this provider accepted could have
been blocked earlier if the provider had more complete blacklists at
its disposal.
Experiment 1: Are emails to spam traps blacklisted? We ﬁrst
studied whether spammers were listed when they sent spam to two
large spam traps during March 2007. The two traps serve indepen-
dent domains and they have no real email addresses, so we can
consider all mail that these domains receive to be spam.2 Both run
the MailAvenger [23] SMTP server, which we have instrumented
to measure whether a sender’s IP address is blacklisted at any of 8
blacklists at the time the email was received.
Trap 1 received 384,521 pieces of spam, of which 134,120 (35%)
were received from IP addresses that were not listed in either
Spamhaus or SpamCop when the spam was received. Trap 2 re-
ceived 172,143 pieces of spam, of which 10% came from IP ad-
dresses that were not blacklisted. The signiﬁcant fraction of spam
coming from unlisted IP addresses suggests that complementary
blacklisting techniques could signiﬁcantly reduce spam. Addition-
ally, blacklists may remain incomplete even one month after each of
these IP addresses sent spam: Unlisted IP addresses that accounted
for 20% of spam at Trap 1, and 8.5% of spam at Trap 2, remained
unlisted in Spamhaus blacklist one month after they were seen in
our spam traps (see Table 1), suggesting that there is still a signiﬁ-
2One of the domains serves eight legitimate users. We exclude this
legitimate mail from our analysis and do not expect the presence
of these addresses to have an effect on the spam received at the
domain.
cant fraction of spam from senders that successfully evade conven-
tional blacklisting techniques.
Experiment 2: Are accepted senders blacklisted later? The sec-
ond set of logs are from an organization that hosts email service
for over 700 domains, about 85 of which were active during March
2007 (our observation period). This provider’s mail servers reject
or accept email based on a combination of techniques, including
multiple blacklist lookups (Spamhaus [37], SORBS [34], etc.) and
a large collection of customized heuristics. This provider blocks up
to twice as much spam as any single blacklist.
Using our daily snapshot of the Spamhaus blacklist as a basis
for comparison, we study the effectiveness of this email provider’s
blocking heuristics by determining the fraction of mail that the
provider accepts. Our results show that even this provider’s ad-
vanced ﬁltering does not ensnare a signiﬁcant collection of spam-
mers: Of the 5,084,771 senders that passed the spam ﬁlters, only
110,542 (2%) became listed in the Spamhaus blacklist during the
following month. This fraction is signiﬁcantly lower than the 15%
quoted by this provider as the fraction of accepted email that is later
reported as spam, which suggests that current blacklists remain in-
complete, even after long periods of time.
2.2.3 Responsiveness
Many DNSBLs do not list an IP address before they receive mul-
tiple end-user reports about a spam sender; some even perform
manual veriﬁcation. Meticulous veriﬁcation can reduce the likeli-
hood of blacklisting “good” senders, but doing so also limits re-
sponsiveness. In this section, we quantify the responsiveness of the
Spamhaus DNSBL by determining, for the IP addresses that were
eventually listed in April 2007, how long those IP addresses were
active before they eventually were blacklisted.
As before, we use snapshots of the Spamhaus blacklist, but we
also use hourly “diffs” of the blacklist to determine when a new IP
address was added. We examine email logs from March 1–31, 2007
and blacklist data from April 1–30, 2007. For each IP address that
was not listed when it ﬁrst sent spam to one of our spam traps but
was eventually listed at some later point in April 2007, we compute
the delay between the ﬁrst occurrence of the IP at our trace to the
ﬁrst time that the IP address became listed in Spamhaus.3
Even when blacklists do list spamming IP addresses, the process
of updating the blacklist may be slow. Figure 3 shows the time-to-
listing for all IPs that were unlisted during the receipt of the email
but eventually appeared at the blacklist in April 2007. In the case
of the spam traps, 10–15% of spam senders that were unlisted at
receipt of spam remained so 30 days after spam was received. The
fraction is a strong indicator of the sluggishness of blacklists, be-
cause sending email to a spam trap automatically labels the sender
as a spammer. In the case of the provider that serves millions of
real customers (“Organization”), almost 20% of senders that were
unlisted when email was received remain unlisted for over 30 days
before eventually appearing in the blacklist.
This analysis indicates that reactive blacklists are sometimes
slow to respond, even for conﬁrmed spammers; this slow re-
sponsiveness, coupled with the ability to continually send spam
from “fresh” IP addresses (Section 2.1.1) represents a signiﬁcant
“window of opportunity” for spammers to send spam from non-
blacklisted IPs. Motivated by this slow responsiveness, the next
section proposes a complementary approach to blacklisting that is
3Because we only have the Spamhaus database for April, we can-
not determine the exact listing time for IP addresses that were in
the database on April 1, 2007; rather, we only know that they were
listed between the time the spam was observed in March and April
1, 2007 (“less than 30 days” in Figure 3). If the IP address was not
listed by April 1, 2007, we assume that whenever the IP becomes
listed in April is the ﬁrst time Spamhaus listed it. This assumption
is reasonable as Spamhaus lists persistent spammers for a minimum
of 30 days [1].
s
P
I
d
e
t
s
i
l
k
c
a
l
B
y
l
l
a
u
t
n
e
v
E
f
o
n
o
i
t
c
a
r
F
e
v
i
t
a
l
u
m
u
C
 1
 0.98
 0.96
 0.94