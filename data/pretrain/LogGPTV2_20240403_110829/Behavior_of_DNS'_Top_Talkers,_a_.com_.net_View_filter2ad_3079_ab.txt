accuracy of a top-talkers list degraded daily if it was not continually updated.
By deﬁnition, the top-talker list initially accounts for 90% of all queries seen
on day 0. As seen in Figure 3(b), if we keep the list ﬁxed, the top-talker list
accounts for only 84% of all queries seen on day 10.
Behavior of DNS’ Top Talkers, a .com/.net View
217
3.4 Query Type Proﬁling
Figure 4(b) shows the distribution of query types over our study period. The ﬁg-
ure shows queries for IPv4 addresses (type A) clearly dominate. IPv6 addresses
(AAAA) are the second most popular type requested and requested more fre-
quently than mail server (MX) records. Other types including DNSSEC record
types[4], service location (SRV) record types, and even obsolete A61 records are
all observed in Figure 4(a), but we can see that they constitute only small por-
tion of the the query traﬃc. Note the type distribution is roughly the same for
top-talkers and the entire set of query sources.
Histogram of Counts of Query Types
s
e
i
r
e
u
Q
#
 1e+07
 1e+06
 100000
 10000
 1000
 100
 10
A A
M
A
T
N
A
C
C
S
D
S
S
P
N
N
D
N
X
S
6
H
N
R
S
P
O
T
A
S
N
A
A
V
F
A
R
P
E
S
A
X
A
Y
T
A
O
M
S
E
T
C
R
K
E
H
I
N
F
O
Y
(a) Full qtype distribution of all qtypes seen (note
log-scale).
(b) Qtype distribution for all sources and
top-talkers.
Fig. 4. Qtype histograms
To help digest the query type behaviors of resolvers, we developed a proﬁling
scheme, seen in Figure 5(a). This ﬁgure shows the proﬁle types and also shows
how both resolvers and total queries distribute across the proﬁles during one
study day (though the distribution on other days is similar). The top node in the
tree shows that we observed 975,391,055 queries from 958,558 distinct addresses.
In the ﬁgure, the line thickness of the node’s border is proportional to the
percent of resolvers that fall into the node. The top node includes all resolvers
and has the thickest line. The leaf node second from the left still accounts for
a substantial percentage of all resolvers and has a proportional thickness. Very
few resolvers fall into the rightmost leaf node and it is proportionally less thick.
Our proﬁle begins by considering whether the resolver sent any A record
queries, the most popular type observed in our study. 94.07% of all resolvers
observed on this day sent at least one query for A records. These 901,762 re-
solvers next split into two nearly equal groups. 55.63% of these resolvers also
sent queries for AAAA records and 44.37% never requested an AAAA record.
Proﬁling resolver behaviors can help one detect unexpected behaviors or at-
tacks, better simulate resolvers, and analyze DNS behaviors. For example, this
distribution has implications for issues such as tracking the IPv6 deployment
1 A6 was an alternate IPv6 address format and moved to experimental status in 2002,
see http://www.ietf.org/mail-archive/web/dnsop/current/msg05437.html
218
E. Osterweil et al.
progress. It is encouraging that over half of resolvers that request IPv4 ad-
dresses also request IPv6. However, this DNS query behavior does not directly
translate to IPv6 usage. For example, many operating systems and versions of
web browsers, automatically request both IPv4 and IPv6 addresses. Thus, these
systems may request both IPv4 and IPv6 addresses in parallel, thus causing the
local resolver resend both. Corresponding behavior is observed in the data; a
query for the IPv4 address of www.somezone.com is followed in close succession
by a query, from the same source, asking for the IPv6 address of the same name.
Interestingly, there were 40,211 resolvers whose DNS queries were for IPv6 AAAAs
only. These 40,211 resolvers sent a combined 122,998 queries and yet never re-
quest a single IPv4 address. Again, note this is the behavior observed from the
TLD and does not deﬁnitively show these resolvers are IPv6 only.
Completing our query type proﬁle, the bottom row of the tree considers
whether a resolver sends queries for MX records. The leftmost leaf node in Figure
5(a) are resolvers that send A, AAAA, and MX queries. For example, one type of
resolver that ﬁts in this group is the resolver for a small or medium company.
The company caching resolver supports users who request both A and AAAA as
well as the company mail server that requests MX records. Note there are also
many other examples of resolvers that can ﬁt this proﬁle. Another resolver that
ﬁts this group may be a mail server that does its own DNS resolution; the MX
records are requested by the mail server and A/AAAA queries are for those servers.
Finally, it has been said that virtually all types of behavior that can occur in
the Internet will occur at some point. The rightmost leaf node would support
this statement. We observe DNS resolvers that do not request any A, AAAA, or MX
records but do query for other types of records. On this day, there were 10,658
such resolvers. Examples of the resolvers here include various DNS monitoring
tools that may solely check for DNS name server (NS) records or DNSSEC records
or other specialized features. The data in Figure 5(a) includes all resolvers, even
resolvers that sent only one query during the day. This one query may happen
to be polling and may happen to request say TXT record. In fact, the low volume
talkers could potentially skew the numbers in any one of the nodes.
Figure 5(b) shows the proﬁle (on the same day) for only the top-talkers. The
restriction to top-talkers still covers 90% of the traﬃc, but reduces the total
number of resolvers from over 900,000 to under 40,000. Note the top-talkers are
more likely to request AAAA records in addition to A. Of all top-talkers, over 80%
of the resolvers who request IPv4 records also request IPv6 records. This can be
partly explained by polling by resolvers. Consider a resolver who has selected a
server other than G as its preferred .com/.net server. Further suppose during
the day that this resolver sends one poll query to G GTLD server. The poll
query is chosen from the existing queries sent by the caching resolver and the
most popular query type is A. If the one poll query is sent during the the day is
an A query, to G it will appear the caching resolver is only requesting A records.
Similarly, if this one query happens to be an AAAA query, to the G GTLD server
it will appear the caching resolver is only requesting AAAA records. Top talkers
Behavior of DNS’ Top Talkers, a .com/.net View
219
send large numbers of queries and their proﬁles are more likely to be an accurate
reﬂection of the resolver type distribution.
(a) Resolver Query Type Proﬁles - Includes All Re-
solvers
(b) Resolver Query Type Proﬁles - Includes Only
Top-Talkers
Fig. 5. Resolver taxonomy
This classiﬁcation scheme proves to be useful. In the case of A6 queries, this
technique can be used to identify speciﬁc types of resolvers.
4 Conclusions and Future Work
In this paper we present what we believe to be the ﬁrst analysis of DNS query
traﬃc at one of the .com/.net TLD server sites. Our analysis includes charac-
terization of the IP addresses of the DNS resolver population, the distribution
of query volume including the top-talkers, and query type proﬁling.
The motivation for our analysis is to deﬁne and understand important features
of normal resolvers. However, this immediately begs the questions: how does one
deﬁne a “normal” resolver (vs. the numerous other sources of DNS traﬃc), and
how important is this distinction? Analysis of query types provides insights on
issues ranging from identifying typical resolver behaviors to the use of IPv6 in
DNS. What we found is that resolvers display an interesting pinning and polling
behavior pattern, the query type distribution highlights just three types as the
220
E. Osterweil et al.
main targets of traﬃc, and that the prominence of A6 queries demonstrates the
old Internet adage that, “nothing ever really dies in the Internet.”
Our results indicate that of all of the hundreds of millions of queries seen
at this one instance of the .com/.net name servers, the bulk of them come
from a relatively small and dynamic group. Under 40,000 resolvers account for
the 90% of the traﬃc and this set of top talkers evolves daily. Based on these
measurements we conclude that when measuring large-scale DNS behaviors, the
top-talkers dominate the observed behavior and serve as a useful low-pass ﬁlter
when trying to characterize typical traﬃc patterns. For example, many clients
were seen to have issued a single query during our measurement period. Indeed,
including the non-top-talkers in analysis of (say) average query rates of caching
resolvers skews the results. The top-talkers allow our results to focus on typical,
well-maintained, and active resolvers when determining the global behaviors.
The dynamism in the list of top-talkers presents several interesting open ques-
tions: how does the top-talker list cutoﬀ of 90% compare with other values (such
as 80%, 95%, 99%, etc.), can the sources that migrate out of the top-talkers list
for G GTLD be seen to pin to another instance, and is there a stable global set
of top-talkers? This is future work that we have already begun to investigate.
References
1. DNS-based Authentication of Named Entites (DANE),
https://datatracker.ietf.org/wg/dane/charter/
2. Electronic Numbering (ENUM), http://tools.ietf.org/wg/enum/
3. Ager, B., M¨uhlbauer, W., Smaragdakis, G., Uhlig, S.: Comparing DNS Resolvers
in the Wild. In: Proceedings of ACM IMC 2010, Melbourne, Australia (November
2010)
4. Arends, R., Austein, R., Larson, M., Massey, D., Rose, S.: Protocol Modiﬁcations
for the DNS Security Extensions. RFC 4035 (March 2005)
5. Brownlee, N., Nemeth, E.: Dns measurements at a root server. In: Proceedings of
IEEE Global Telecommunications Conference, Globecom 2001 (2001)
6. Internet Software Consortium. ISC BIND Features,
http://www.isc.org/software/bind/new-features/11.6/
7. Jung, J., Sit, E., Balakrishnan, H., Morris, R.: DNS Performance and the Eﬀec-
tiveness of Caching. In: Internet Measurement Workshop (2001)
8. Mao, Z.M., Cranor, C.D., Douglis, F., Rabinovich, M., Spatscheck, O., Wang, J.:
A precise and eﬃcient evaluation of the proximity between web clients and their
local dns servers. In: USENIX Annual Technical Conference (2002)
9. Mockapetris, P., Dunlap, K.J.: Development of the domain name system. In: SIG-
COMM 1988 (1988)
10. NLnet Labs. unbound DNS resolver, http://www.unbound.net/documentation/
11. Osterweil, E., Ryan, M., Massey, D., Zhang, L.: Quantifying the operational status
of the dnssec deployment. In: IMC 2008 (2008)
12. Wang, X., Wang, Z., Lee, X.: Analyzing bind dns server selection algorithm. Inter-
national Journal of Innovative Computing, Information and Control (2010)