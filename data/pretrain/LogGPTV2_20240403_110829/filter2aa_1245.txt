#BHUSA @BlackHatEvents
Industroyer2
Sandworm's Cyberwarfare Targets Ukraine's Power Grid Again
Anton Cherepanov
Robert Lipovsky
1. Sandworm (2014-2022)
2. Industroyer (2016)
3. Industroyer2 (2022)
• Attack events
• Technical analysis
4. Co-deployed malware
5. Defense
6. Wrap up
Anton Cherepanov
Senior Malware Researcher
Robert Lipovsky
Principal Threat Intelligence Researcher
@cherepanov74
@Robert_Lipovsky
Sandworm 2014-2022
Sandworm
Telebots
/Voodoo Bear
Sednit
Fancy 
Bear/APT28
The Dukes
Cozy Bear/APT29
InvisiMole
Gamaredon
Buhtrap
Turla
Energetic Bear
Sources:
Sandworm
Telebots
/Voodoo Bear
GRU
Sources:
Militaire Inlichtingen
en Veiligheidsdienst
https://95.143.193.182/Franceaviatelecom8/statmach/aorta.php
https://5.61.38.31/epsiloneridani0/setattr.php
https://144.76.119.48/arrakis02/loadvers/paramctrl.php
https://78.46.40.239/SalusaSecundus2/segments/statinfo.php
https://95.143.193.131/houseatreides94/dirconf/check.php
https://46.165.222.6/BasharoftheSardaukars/tempreports/vercontrol.php
SANDWORM
.143.193.182/Franceaviatelecom8/statmach/aorta.php
61.38.31/epsiloneridani0/setattr.php
4.76.119.48/arrakis02/loadvers/paramctrl.php
.46.40.239/SalusaSecundus2/segments/statinfo.php
.143.193.131/houseatreides94/dirconf/check.php
.165.222.6/BasharoftheSardaukars/tempreports/vercontrol.php
24 Feb 2022
Russian invasion
of Ukraine
Increase in cyberattacks against Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
24 Feb 2022
Russian invasion
of Ukraine
Increase in cyberattacks against Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
23 December 2015
≤6 hours
~230,000
BlackEnergy
First malware-induced blackout
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
Nov 2013
BlackEnergy
attacks intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
013
nergy
s intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
24 Feb 2022
Russian invasion
of Ukraine
Feb 2014
Russian occupation
of Crimea
April 2014
War in Donbas
begins
013
nergy
s intensify
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
24 Feb 2022
Russian invasion
of Ukraine
on
pril 2014
War in Donbas
egins
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
Apr 2018
Exaramel
attack detected in 
Ukraine
Industroyer
Exaramel
24 Feb 2022
Russian invasion
of Ukraine
n
ril 2014
ar in Donbas
gins
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
Apr 2018
Exaramel
attack detected in 
Ukraine
24 Feb 2022
Russian invasion
of Ukraine
015
Energy
k causes blackout in 
ne
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
Apr 2018
Exaramel
attack detected in 
Ukraine
23 Feb 2022
HermeticWiper
attack in Ukraine
HermeticWiper
HermeticWiper
100s 
systems
5+ 
organizations
Dec 28, 2021
compilation timestamp
Hermetic campaign
HermeticWiper
HermeticWizard
HermeticRansom
HermeticRansom
• _/C_/projects/403forBiden/wHiteHousE.baggageGatherings
• _/C_/projects/403forBiden/wHiteHousE.lookUp
• _/C_/projects/403forBiden/wHiteHousE.primaryElectionProcess
• _/C_/projects/403forBiden/wHiteHousE.GoodOffice1
23 Feb 2022
HermeticWiper
attack in Ukraine
24 Feb 2022
Russian invasion
of Ukraine
2014
sian occupation
rimea
April 2014
War in Donbas
begins
fy
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
23 Feb 2022
HermeticWiper
attack in Ukraine
24 Feb 2022
Russian invasion
of Ukraine
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
14 Mar 2022
CaddyWiper
deployed
CaddyWiper
Dozens of 
systems
Targeted
financial sector
Compiled & 
deployed
Mar 14, 2022
23 Feb 2022
HermeticWiper
attack in Ukraine
24 Feb 2022
Russian invasion
of Ukraine
Dec 2015
BlackEnergy
attack causes blackout in 
Ukraine
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
14 Mar 2022
CaddyWiper
deployed
23 Feb 2022
HermeticWiper
attack in Ukraine
24 Feb 2022
Russian invasion
of Ukraine
ackout in 
Dec 2016
Industroyer
attack causes blackout in 
Ukraine
Jun 2017
NotPetya
outbreak
14 Mar 2022
CaddyWiper
deployed
8 Apr 2022
Industroyer2
sabotage attempt
Industroyer 2016
Industroyer’s intended impact
De-energize
power lines
Deny operators
visibility
& control
Industroyer’s intended impact
Deny operators
visibility
& control
ABB PCM600
ABB MicroScada
Signal Cross References
Substation Configuration Language
Substation Configuration Description
Configured IED Description
Industroyer’s intended impact
De-energize
power lines
v
Disable
protection relays
Deny operators
visibility
& control
Industroyer’s intended impact
De-energize
power lines
v
Disable
protection relays
Deny operators
visibility
& control
Industroyer’s intended impact
v
Disable
protection relays
ICS Advisory (ICSA-15-202-01)
Siemens SIPROTEC Denial-of-Service Vulnerability
Deny operators
visibility
& control
Industroyer’s intended impact
De-energize
power lines
v
Disable
protection relays
Deny operators
visibility
& control
Industroyer’s intended impact
De-energize
power lines
Physical damage
Operators 
manually 
re-energize 
power lines
v
Disable
protection relays
Industroyer architecture
executes
Main Backdoor
Additional
Backdoor
Port
Scanner
installs
executes
Launcher
101 Payload
104 Payload
61850 Payload
OPC DA Payload
executes
17. Dec 2016 – 22:27 (UTC)
DOS
Tools
executes
Main Backdoor
Additional
Backdoor
installs
executes
Launcher
101 Payload
104 Payload
61850 Payload
OPC DA Payload
executes
Industroyer architecture
Port
Scanner
DOS
Tools
IEC 60870-5-104
•
Telecontrol protocol in power grids
•
TCP/IP extension of IEC 60870-5-101
•
Port 2404
•
Client-server model
ASDU = Application Service Data Unit
IOA = Information Object Address
104 Payload
104 Payload
Industroyer2
Industroyer2
Code similarity with 
Industroyer
Embedded 
configuration
IEC-104 protocol 
only
Timestamp and compiler information of the Industroyer2 sample
Hardcoded configuration found in Industroyer2 sample
IEC-104 COMMAND PARSED BY WIRESHARK
Double command (C_DC_NA_1)
Single command (C_SC_NA_1)
Circuit breaker failure protection
Source: ABB
Industroyer 2016
Industroyer2 2022
Industroyer 2016
Industroyer2 2022
Co-deployed malware
Sandworm
Electrical substation
Industroyer2
CaddyWiper
ORCSHRED
SOLSHRED
AWFULSHRED
Control
ICS network
Linux and Solaris
network
14:58 UTC: Deployment of CaddyWiper on some Windows machines 
and of Linux and Solaris destructive malware at the energy provider
15:02 UTC: Sandworm operator creates the scheduled task to launch Industroyer2
16:10 UTC: Scheduled execution of Industroyer2 to cut power in a 
Ukrainian region
16:20 UTC: Scheduled execution of CaddyWiper on the same 
machine to erase Industroyer2 traces
2022-04-08
Setting up the cron job to launch the wipers
Defense
Defense
• Suspicious IEC-104 traffic
• Lateral movement via Impacket
• Meterpreter
• Scheduled task via Group Policy
Industroyer2 playground
https://github.com/eset/malware-research/tree/master/industroyer2
Detection opportunities: lateral movement via Impacket
cmd.exe spawned by parent process: WmiPrvSE.exe
Specific command line:
cmd.exe /Q /c cmd /c %COMMAND% 1> \\127.0.0.1\ADMIN$\__%timestamp% 2>&1
Source: SecureAuth
Detection opportunities: Meterpreter
Loader for Meterpreter payloads: 
• reverse_tcp
• reverse_http
Inserted in legitimate binaries via Shellter Pro
Detection opportunities: scheduled task via Group Policy (GPO)
Custom PowerShell script to create immediate scheduled task
MITRE ATT&CK 
T1484.001
IEC104 Client for Metasploit
Wrap up
Further reading
• ESET: Industroyer2: Industroyer reloaded
• Mandiant: INDUSTROYER.V2: Old Malware Learns New Tricks
• Nozomi Networks: Industroyer vs. Industroyer2: Evolution of the IEC 
104 Component
• Joe Slowik/Dragos: CRASHOVERRIDE: Reassessing the 2016 Ukraine 
Electric Power Event as a Protection-Focused Attack
Black Hat sound bytes
• The threat is serious but can be thwarted
• Threat actor “sophistication” lies in knowledge of
protocols and target environment
• Defense should focus on early detection & prevention
@cherepanov74
@Robert_Lipovsky
@ESETResearch
Thank you...