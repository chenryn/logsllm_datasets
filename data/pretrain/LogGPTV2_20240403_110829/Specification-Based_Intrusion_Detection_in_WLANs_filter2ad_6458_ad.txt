### 5.4. Analysis

#### 5.4.1 Attack Detection
The State-Transition-Processor (STP) successfully detected and classified all attacks in Set1 and Set2 by monitoring state changes in the state transition model described in Section 4.1. It also effectively detected policy violations in Set3 by applying site security constraints, demonstrating a low rate of false positives.

In Set1 and Set2, the STP correctly raised the alarm type "Zero" for all flooding attacks and the alarm type "Neg" for instances where there were numerous unsuccessful attempts by the STA to establish an SA with the AP, indicating a DoS attack. A "noSA" alarm was raised whenever a data frame was detected from a MAC address that had not completed its SA. MAC address spoofing attacks (alarm type "Spoofing") were detected whenever a positive state shift followed a negative state shift or a -ve frame. Frames that would not normally be processed by a real STA/AP in a particular state were flagged by raising the "unexpected frame" alarm. The "unexpected frame flood" alarm was raised when a threshold number of unexpected frames was detected.

Some unexpected frame transitions occurred in Set1 and Set2 experiments. For example, in Set1, the EAP-Failure attack led to additional alarms of type "unexpected frame" and "unexpected frame flood." This was due to the STA sending a deauthentication frame to the AP upon receiving an EAP-Failure frame, transitioning the observed state to 0. Consequently, every subsequent EAP-Failure frame generated an "unexpected frame" alarm. However, these unexpected transitions did not affect the successful classification/identification of the actual attack.

In all experiments, the use of indices of suspicion in the STP helped eliminate most sources of false positives and multiple alerts for the same attack, while maintaining a zero false negative rate. In Set3, captures from Sensor3 led to the generation of several false positives, primarily alarms of type "Pos" and "noSA," which are directly related to frame loss. The rate of false positives was proportional to the rate of frame loss, with Sensor3, being the farthest from the AP and the STA, experiencing the most frame losses. No false positives were generated by Sensor1 or Sensor2. By correlating alarms from different sensors, most false positives can be eliminated. All false positives in Set3 were eliminated when results from the three sensors were correlated. In the correlation process, more weight can be placed on alarms generated by sensors located near the AP and the STA.

In Set3, the STP correctly detected violations of the site security policy using the state transition model and related constraints (provided via a configuration file). The IE of the new WLAN did not match the expected IE, and the state transition model did not expect data transfer before state 8. In Open Networks, data transfer can occur after state 4, leading to the generation of "nonCompliantNetwork" and "noSA" alarms.

#### 5.4.2 Comparative Analysis
In the experiments, Snort-Wireless-Default (SWD) only detected authentication and deauthentication flood attacks but failed to detect attacks violating the site security policy. The STP, on the other hand, successfully detected all launched attacks (see Table 3 and Section 5.3).

A significant drawback of SWD is its limited DoS attack detection, which is confined to flooding attacks and further restricted to authentication and deauthentication floods. Additionally, SWD's deauthflood and authflood preprocessors require frames to arrive at a certain rate for successful detection. For instance, SWD did not detect the deauthentication broadcast flood attack in the traffic capture from Sensor3 because the high frame loss caused the capture file to not represent the attack incoming at a high rate (see Table 3). The STP has no such preconditions and can detect flooding attacks without depending on the rate of frame injection.

Besides flooding attacks, the STP can also detect spoofing/MITM/session hijacking attacks by checking for a positive state shift immediately following a negative state shift or a -ve frame. This detection mechanism is more reliable and robust than SWD's method, which relies on detecting gaps in sequence numbers of frames (mac-spoof preprocessor). The STP can even detect stealthy DoS attacks, such as when an attacker passively monitors a legitimate STA and injects a DoS attack frame into the WLAN every time the STA reaches halfway through establishing an SA with the AP. SWD has no means of detecting such attacks. SWD is also incapable of detecting random injection attacks aimed at consuming network bandwidth, such as the injection of data frames with random STA source addresses and injection of random frames, which the STP would detect as anomalous activity.

SWD requires a separate preprocessor for each kind of attack, whereas the STP can detect attacks without requiring additional algorithms or preprocessors. The STP does not need constant code updates/patches to detect new attacks and has a small footprint, making it easily deployable on a large scale without extensive computing power. The authors acknowledge the flexibility provided by the design of SWD, which allows preprocessors to be readily plugged in for enhanced functionality.

### 6. Conclusions and Future Work

This work presents an approach for constructing an IDS for infrastructure WLANs using a specification-based approach. The system implements both attack detection and policy compliance monitoring, a unique contribution. The specification used by the system comprises a state transition model and a set of constraints derived from underlying network protocol specifications (IEEE 802.11, 802.1X, and EAP) and an example security policy.

The IDS, implemented as a Snort-Wireless preprocessor, was evaluated for accuracy and sensitivity. The technique proved capable of passively detecting all known attacks and effectively monitoring for policy compliance. Experimental analysis demonstrated that the technique, combined with the use of indices of suspicion, could detect all intrusions with minimal false positives and no undetected attacks, meeting the requirement of being maintainable. As an anomaly-based approach, the system does not require updates for new or variant attacks. Runtime configuration parameters allow the constraints to be easily updated as the network security policy changes.

Future work aims to evaluate the attack resistance of the approach to confirm its ability to reliably report intrusions in the presence of attackers attempting to exhaust the monitor's resources. We also aim to study more complex algorithms to determine values for indices of suspicion and the effects of tuning these thresholds on false positives and false negatives.