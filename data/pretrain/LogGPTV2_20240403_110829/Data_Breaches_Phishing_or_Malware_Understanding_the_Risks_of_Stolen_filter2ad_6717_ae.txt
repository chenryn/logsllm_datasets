active
365
365
365
365
365
363
352
352
363
363
●●●●●●●●●●0%25%50%75%100%1101001000Unique users of blackhat toolCDF of blackhat tools●KEYLOGGERPHISHING_KITTable 12: Top 10 geolocations associated with the last sign-in
to email accounts receiving stolen credentials.
Phishing Kit Users
Keylogger Users
Geolocation
Nigeria
United States
Morocco
South Africa
United Kingdom
Malaysia
Indonesia
Tunisia
Egypt
Algeria
Other
Popularity
41.5%
11.4%
7.6%
6.4%
3.3%
3.2%
3.1%
2.0%
1.6%
1.3%
18.6%
Geolocation
Nigeria
Brazil
Senegal
United States
Malaysia
India
Philippines
Turkey
Thailand
Egypt
Other
Popularity
11.2%
7.8%
7.3%
6.4%
5.8%
5.7%
4.6%
3.2%
2.8%
2.7%
42.7%
6.3 Location of users
We examine the last login geolocation for all Gmail accounts that re-
ceived stolen credentials to provide a perspective on the geographic
usage of blackhat tools. We note that in the event a single miscre-
ant controls multiple exfiltration points, we may over count their
location. Likewise, we cannot rule out the possibility of proxies ob-
fuscating the true location of miscreants. We provide a breakdown
of the top 10 geolocations for phishing kit users and keylogger
users in Table 12.
We find that 41.5% of exfiltration points for phishing kits were
last accessed in Nigeria, followed in popularity by the United States,
Morocco, and South Africa. This differs significantly from the geolo-
cations of hijackers accessing the accounts of victims as reported
by Bursztein et al. [5] (predominantly China) and by Onaolapo
et al. [31] (predominantly tailored to the victim’s historical geolo-
cation to evade risk detection, or Tor). This suggests that the in-
frastructure that miscreants use to steal credentials is independent
from the devices that hijackers use to access accounts. Compared
to the targets of phishing (discussed previously in Table 7), victims
largely come from North America and Europe, while blackhat users
originate from Africa and South-East Asia.
For keyloggers, we find a much more diverse ecosystem, where
a small fraction of users span every continent. Still, Nigeria takes
the top place, accounting for 11.2% of exfiltration points. We also
observe a coupling between the targets of keyloggers (discussed
previously in Table 7) and the geolocations of miscreants. Brazil,
India, the United States, Turkey, the Philippines, Malaysia, Thailand,
and Nigeria appear in both top 10 lists. Not listed in Table 7, Iran
makes up 2.7% of blackhat users, and Indonesia 1.4%. This coupling
suggests that blackhat users favor local victims.
6.4 Web cloaking
Phishing kits commonly have built-in cloaking capabilities to redi-
rect crawlers or users behind proxies (perceived to be security
analysts) away from deceptive content in order to impede detection.
By manually investigating a random sample of phishing kits, we sur-
face two dominant cloaking implementations. The first, present in
Figure 8: Phishing kit and keylogger daily usage, where us-
age indicates generating at least one message on a given day.
Figure 9: Weekly breakdown of potential stolen credentials
collected by the top 5 phishing kits.
year with the exception of the phishing kit targeting Office 365.
This stability indicates a remarkable lack of external pressure on
blackhat developers to modify their phishing landing pages.
Zooming in on the weekly activity for the top five phishing kits,
we find bursty, campaign-like behavior as shown in Figure 9. This
suggests a handful of actors have an outsized influence in the space.
For example, the second most popular kit (Workspace Webmail)
affected only 2,500 potential victims each week during lulls, but
then jumped to 40,000–69,000 victims per week during periods of
coordinated action. Likewise, the fourth most popular kit (Dropbox)
netted fewer than 100 victims each week until two campaigns
collected over 40,000 credentials each week while active. Indeed, if
we examine the exfiltration points receiving stolen credentials, the
top 50 receive 26% of all credentials. As such, while the blackhat
tools we investigate exhibit year-round activity from hundreds of
actors, just a handful of actors truly drive the market.
●●●●●●●●●●0%25%50%75%100%0100200300Days operationalCDF of blackhat tools●KEYLOGGERPHISHING_KIT●●●●●●●●●●●●0K20K40K60KApr 2016Jul 2016Oct 2016Jan 2017Apr 2017Potential victims per week●kit01kit02kit03kit04kit05652 kits, relies on setting an htaccess policy to deny access to over
500 IP address prefixes, some of which relate to brand and trade-
mark monitoring services. The second technique, present in 182 kits,
relies on a PHP script that checks an embedded blacklist.dat
consisting of over 1,300 IP address prefixes. Based on annotations
embedded in the blacklist file, these addresses belong to cloud
providers including Google, Amazon, and OVH; security crawlers
including PhishTank and other anti-virus brands; and anonymous
proxies like Tor. Other cloaking strategies rely on anti-fraud protec-
tions provided by MaxMind and FraudLabs Pro that detect proxies
or anonymous access—in this case re-purposed to flag inorganic
users accessing phishing pages. Overall, the cloaking strategies of
kits match those reported by Invernizzi et al. as popular among
blackhat search engine optimization [22], indicating a common
core of blackhat technologies.
7 DISCUSSION
Mitigation techniques. The sheer scale of blackmarket activity
surrounding stolen credentials highlights the fragility of authenti-
cation schemes built solely on usernames and passwords. A number
of online services have enhanced their identity services beyond
“something you know” to include approximations of “something
you have,” while avoiding the overhead of requiring a mobile device
or hardware token. As we discussed in Section 5, this can include a
user’s device profiles (e.g., User-Agents or machine identifiers) or a
user’s physical location. As we have shown, these additional factors
are not intractable for attackers to identify, collect, and impersonate.
In the case of geolocation, this means selecting a network proxy in
the vicinity of a hijacking target. Despite these limitations, adapting
authentication schemes to include risk profiles significantly reduces
the danger from having valid passwords exposed in credential leaks,
or bundled and traded absent the full user profile.
Immediate solutions to the shortcomings of risk profiles include
migrating users to unphishable two-factor authentication (2FA) or
password managers that associate credentials with specific domains.
While these schemes are susceptible to malware, our results suggest
that the threat posed by credential leaks and phishing is orders
of magnitude larger than keyloggers at present. Nevertheless, as
Bonneau et al. point out, there are various barriers to adopting 2FA
and password managers with respect to ease-of-use, recovery from
loss, and trusting third parties [3]. Likewise, user knowledge of
these schemes is spotty [1, 23]. Our own results indicate that less
than 3.1% who fall victim to hijacking subsequently enable any
form of two-factor authentication after recovering their account.
As such, user education remains a major initiative for enhancing
account security.
Evolution of blackmarket tools. Compared to the capabilities
of keyloggers and phishing kits dating back to the mid-2000s (Sec-
tion 2), we observe a marked lack of pressure on blackhat developers
to evolve their core technologies. Phishing kits reported nearly a
decade ago still rely on the same PHP skeleton and approach for
reporting stolen credentials. The only modifications have been to
collect new challenge questions and ancillary authentication details.
Likewise, all of the keylogger variants in our study provide identical
capabilities; it is only the interface and customer support that differ.
Our findings illustrate that despite significant research in the space,
Internet users continue to fall victim to the same threats.
8 CONCLUSION
In this work we presented the first longitudinal measurement study
of how miscreants obtain stolen credentials and subsequently by-
pass risk-based authentication schemes to hijack a victim’s account.
In total, we identified 788,000 potential victims of off-the-shelf
keyloggers; 12.4 million potential victims of phishing kits; and 1.9
billion usernames and passwords exposed via data breaches and
traded on blackmarket forums. Through a combination of password
re-use across thousands of online services and targeted collection,
we estimated 7–25% of stolen passwords in our dataset would enable
an attacker to log in to a victim’s Google account and thus take over
their online identity due to transitive trust. However, we showed
how blocking login attempts that fail to match a user’s historical lo-
gin behavior or device profile help mitigate the risk of data breaches
and keyloggers, and to a lesser extent phishing. We are now us-
ing these insights to improve our login defenses for all users. Our
findings illustrate the global reach of the underground economy
surrounding credential theft and the need to educate users about
password managers and unphishable two-factor authentication as
a potential solution.
9 ACKNOWLEDGEMENTS
This work was supported in part by a National Science Foundation
fellowship and by NSF award CNS-1237265. Opinions expressed in
this paper do not necessarily reflect those of the research sponsors.
[2]
[3]
REFERENCES
[1] Lillian Ablon, Paul Heaton, Diana Catherine Lavery, and Sasha Romanosky. Con-
sumer attitudes toward data breach notifications and loss of personal information.
In Proceedings of the Workshop on Economics of Information Security (WEIS), 2016.
Joseph Bonneau. The science of guessing: analyzing an anonymized corpus of 70
million passwords. In Proceedings of the IEEE Symposium on Security and Privacy,
2012.
Joseph Bonneau, Cormac Herley, Paul C Van Oorschot, and Frank Stajano. The
quest to replace passwords: a framework for comparative evaluation of web
authentication schemes. In Proceedings of the IEEE Symposium on Security and
Privacy, 2012.
[4] Tadek Pietraszek Borbala Benko, Elie Bursztein and Mark Risher. Cleaning up
after password dumps. https://security.googleblog.com/2014/09/cleaning-up-aft
er-password-dumps.html, 2014.
[5] Elie Bursztein, Borbala Benko, Daniel Margolis, Tadek Pietraszek, Andy Archer,
Allan Aquino, Andreas Pitsillidis, and Stefan Savage. Handcrafted fraud and
extortion: manual account hijacking in the wild. In Proceedings of the Internet
Measurement Conference, 2014.
[6] Blake Butler, Brad Wardman, and Nate Pratt. REAPER: an automated, scalable
solution for mass credential harvesting and OSINT. In eCrime Researchers Summit,
2016.
[7] Hsien-Cheng Chou, Hung-Chang Lee, Hwan-Jeu Yu, Fei-Pei Lai, Kuo-Hsuan
Huang, and Chih-Wen Hsueh. Password cracking based on learned patterns
from disclosed passwords. IJICIC, 2013.
[8] Marco Cova, Christopher Kruegel, and Giovanni Vigna. There is no free phish: an
analysis of "free" and live phishing kits. In Proceedings of the USENIX Workshop
on Offensive Technologies, 2008.
[9] Anupam Das, Joseph Bonneau, Matthew Caesar, Nikita Borisov, and XiaoFeng
Wang. The tangled web of password reuse.
In Symposium on Network and
Distributed System Security (NDSS), 2014.
[10] Matteo Dell’Amico, Pietro Michiardi, and Yves Roudier. Password strength: an
empirical analysis. In Proceedings of IEEE INFOCOM, 2010.
[11] Serge Egelman, Joseph Bonneau, Sonia Chiasson, David Dittrich, and Stuart
Schechter. It’s not stealing if you need it: a panel on the ethics of performing
research using public data of illicit origin. In International Conference on Financial
Cryptography and Data Security, 2012.
[12] Lorenzo Franceschi-Bicchierai. Hacker tries to sell 427 milllion stolen myspace
passwords for $2,800. https://motherboard.vice.com/en_us/article/427-million
-myspace-passwords-emails-data-breach, 2016.
[13] David Mandell Freeman, Sakshi Jain, Markus Dürmuth, Battista Biggio, and Gior-
gio Giacinto. Who are you? a statistical approach to measuring user authenticity.
In Symposium on Network and Distributed System Security (NDSS), 2016.
[14] Hongyu Gao, Jun Hu, Christo Wilson, Zhichun Li, Yan Chen, and Ben Y Zhao.
Detecting and characterizing social spam campaigns. In Proceedings of the 10th
ACM SIGCOMM conference on Internet measurement. ACM, 2010.
[15] Samuel Gibbs. Dropbox hack leads to leaking of 68m user passwords on the
internet. https://www.theguardian.com/technology/2016/aug/31/dropbox-hac
k-passwords-68m-data-breach, 2016.
[16] Vindu Goel and Nicole Perlroth. Yahoo says 1 billion user accounts were hacked.
https://www.nytimes.com/2016/12/14/technology/yahoo-hack.html, 2016.
[17] Andy Greenberg. Hackers hit macron with huge email leak ahead of french
election. https://www.wired.com/2017/05/macron-email-hack-french-election/,
2017.
[18] Robert Hackett. Linkedin lost 167 million account credentials in data breach.
http://fortune.com/2016/05/18/linkedin-data-breach-email-password/, 2016.
[19] Xiao Han, Nizar Kheir, and Davide Balzarotti. Phisheye: live monitoring of
In Proceedings of the ACM SIGSAC Conference on
sandboxed phishing kits.
Computer and Communications Security, 2016.
[20] Thorsten Holz, Markus Engelberth, and Felix Freiling. Learning more about the
underground economy: a case-study of keyloggers and dropzones. In European
Symposium on Research in Computer Security (ESORICS), 2009.
[21] Mat Honan. How apple and amazon security flaws led to my epic hacking.
https://www.wired.com/2012/08/apple-amazon-mat-honan-hacking/, 2012.
[22] Luca Invernizzi, Kurt Thomas, Alexandros Kapravelos, Oxana Comanescu, Jean-
Michel Picod, and Elie Bursztein. Cloak of visibility: detecting when machines
browse a different web. In Proceedings of the IEEE Symposium on Security and
Privacy, 2016.
Iulia Ion, Rob Reeder, and Sunny Consolvo. ... no one can hack my mind: com-
paring expert and non-expert security practices. In Symposium on Usable Privacy
and Security (SOUPS), 2015.
[24] Patrick Gage Kelley, Saranga Komanduri, Michelle L Mazurek, Richard Shay,
Timothy Vidas, Lujo Bauer, Nicolas Christin, Lorrie Faith Cranor, and Julio Lopez.
Guess again (and again and again): measuring password strength by simulating
password-cracking algorithms. In Proceedings of the IEEE Symposium on Security
and Privacy, 2012.
[25] Brian Krebs. Adobe breach impacted at least 38 million users. https://krebsons
ecurity.com/2013/10/adobe-breach-impacted-at-least-38-million-users/, 2013.
Ap twitter account hacked in market-moving attack.
[26] Edmund Lee.
[23]
https://www.bloomberg.com/news/articles/2013-04-23/dow-jones-drops
-recovers-after-false-report-on-ap-twitter-page, 2013.
[31]
[27] William R Marczak, John Scott-Railton, Morgan Marquis-Boire, and Vern Pax-
son. When governments hack opponents: a look at actors and technology. In
Proceedings of the USENIX Security Symposium, 2014.
[28] Bakuei Matsukawa, David Sancho, Lord Alfred Remorin, Robert McArdle, and
Ryan Flores. Predator pain and limitless when cybercrime turns into cyberspy-
ing. https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/wh
ite-papers/wp-predator-pain-and-limitless.pdf, 2014.
[29] William Melicher, Blase Ur, Sean M Segreti, Saranga Komanduri, Lujo Bauer,
Nicolas Christin, and Lorrie Faith Cranor. Fast, lean and accurate: modeling
password guessability using neural networks.
In Proceedings of the USENIX
Security Symposium, 2016.
[30] Tyler Moore and Richard Clayton. Discovering phishing dropboxes using email
metadata. In eCrime Researchers Summit, 2012.
Jeremiah Onaolapo, Enrico Mariconti, and Gianluca Stringhini. What happens
after you are pwnd: understanding the use of leaked account credentials in the
wild. In Proceedings of the Internet Measurement Conference, 2016.
[32] Nicole Perlroth and Michael D. Shear. Private security group says russia was be-
hind John Podesta’s email hack. https://www.nytimes.com/2016/10/21/us/private
-security-group-says-russia-was-behind-john-podestas-email-hack.html, 2016.
[33] Richard Shay, Iulia Ion, Robert W Reeder, and Sunny Consolvo. "My religious aunt
asked why I was trying to sell her viagra": experiences with account hijacking.
In Proceedings of ACM Conference on Human Factors in Computing Systems, 2014.
[34] Elizabeth Stobert and Robert Biddle. The password life cycle: user behaviour in
managing passwords. In Proc. SOUPS, 2014.
[35] Brett Stone-Gross, Marco Cova, Lorenzo Cavallaro, Bob Gilbert, Martin Szyd-
lowski, Richard Kemmerer, Christopher Kruegel, and Giovanni Vigna. Your
botnet is my botnet: analysis of a botnet takeover. In Proceedings of the ACM
Conference on Computer and Communications Security, 2009.
[36] Kurt Thomas, Frank Li, Chris Grier, and Vern Paxson. Consequences of con-
nectivity: characterizing account hijacking on Twitter.
In Proceedings of the
Conference on Computer and Communications Security, 2014.
[37] Rick Wash, Emilee Rader, Ruthie Berman, and Zac Wellmer. Understanding
password choices: how frequently entered passwords are re-used across websites.
In Symposium on Usable Privacy and Security (SOUPS), 2016.
[38] Matt Weir, Sudhir Aggarwal, Breno De Medeiros, and Bill Glodek. Password
cracking using probabilistic context-free grammars. In Proceedings of the IEEE
Symposium on Security and Privacy, 2009.
[39] Shams Zawoad, Amit Kumar Dutta, Alan Sprague, Ragib Hasan, Jason Britt, and
Gary Warner. Phish-net: investigating phish clusters using drop email addresses.
In eCrime Researchers Summit, 2013.
//www.wired.com/2008/09/group-posts-e-m, 2008.
[40] Kim Zetter. Group posts e-mail hacked from Palin account – update. https: