### 4.3 实验

为了展示如何利用CID测量的敏感性来选择最优操作点（或微调IDS），我们对几种现有的异常检测系统进行了测试，并在不同配置下测量了它们的准确性及CID值。具体来说，我们使用了两种网络入侵检测系统：包头异常检测（PHAD）[13]和负载异常检测（PAYL）[25]。为了比较两种不同的IDS，我们还对比了PAYL与另一个基于签名的开源IDS Snort [22]，以评估它们在相同测试数据集上检测Web攻击的能力。

#### 测试环境

- **PHAD**：专注于包头字段的异常检测。
- **PAYL**：通过分析负载中的字节频率进行异常检测。
- **Snort**：基于签名的IDS，用于对比实验。

#### 数据集

- **PHAD**：使用DARPA 1999测试数据集[16]，第3周数据用于训练，第4、5周数据用于测试。我们仅监控HTTP流量。
- **PAYL**：由于DARPA 1999数据集中难以找到足够的数据进行全面测试，我们使用了GTTrace数据集，该数据集包含大约六小时的HTTP流量，总量约为1GB。我们过滤掉已知攻击，将数据集分为训练集和测试集，并注入了大量的HTTP攻击。

#### 结果分析

图6展示了CID、PPV和NPV在不同参数下的导数绝对值。CID在所有情况下都表现出最高的敏感性。对于实际情况，CID的导数始终高于其他指标。

图7展示了IDS1和IDS2的ROC曲线及其对应的CID曲线。这些图基于Gaffney和Ulvila报告的数据，展示了如何使用CID选择最优操作点。简单的ROC分析可能无法达到同样的阈值。

#### PHAD结果

- **得分计算**：基于每个包头中选定字段计算得分。如果得分超过阈值，则发出入侵警报。调整阈值会产生不同的TP和FP值（见图8(a)）。
- **ROC曲线与CID曲线**：从图8(a)可以看出，CID曲线几乎与ROC曲线一致。这是因为DARPA数据集中，PHAD的假阳性率较低，而假阴性率极高（β ≈ 1）。根据我们的技术报告[8]，当α较小且β较大时，ROC和CID都可以近似为直线，CID的公式可以简化为K(1 - β)/H(X)，其中K是常数。
- **与文献对比**：文献[13]中的作者使用PHAD监控所有类型的流量，训练和测试细节也有所不同。我们配置PHAD报告每个涉及攻击的包，而不是报告攻击实例，因此我们的PHAD具有更高的β值。

#### PAYL结果

- **阈值选择**：用户需要选择一个最优阈值来判断观察到的字节频率是否显著偏离训练模型。例如，阈值为256允许每个字符在一个标准差内变化[25]。
- **结果**：从图8(b)可以看出，在GTTrace数据集中，随着阈值的变化，CID提供了比简单ROC分析更好的度量。CID能够识别出更优的操作点，不会返回比现有度量更差的结果。

通过这些实验，我们展示了CID在选择最优操作点方面的优势，并证明了它在某些情况下优于传统的ROC分析。