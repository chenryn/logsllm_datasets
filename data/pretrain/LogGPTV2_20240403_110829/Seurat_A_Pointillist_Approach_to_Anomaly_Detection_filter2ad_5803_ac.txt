### Clustering Feature Vectors for Anomaly Detection
Each circle in the figure represents a cluster, with the number at the center indicating the total number of clusters. The radius of each circle corresponds to the number of points within the cluster, which is also indicated beside the circle. Squared dots represent new points generated on the day under detection, and new clusters are identified by a thicker circle.

### 4.2 False Negatives
The primary goal of this experiment is to study the false negative rate and detection latency of Seurat as the stealthiness of the attack changes. We simulate attacks by manually updating files on selected host reports, as if they were infected.

#### Attack Aggressiveness and Propagation Speed
We first examine the detection rate of Seurat by varying the degree of attack aggressiveness. We model the attack propagation speed as the number of hosts infected per day (the detection window) and the attack stealthiness as the number of new files installed by the attack. The simulation runs on the same teaching cluster described in Section 4.1. Since the aggregated file update patterns differ each day, we randomly select ten days in February 2004, when no intrusion occurred. On each selected day, we simulate attacks by inserting artificial new files into a number of host reports and use the modified reports as input for the detection algorithm. After removing the modified entries, we repeat the experiments for another day. The detection rate is calculated as the number of days Seurat spots new clusters over the total ten days.

#### Detection Rate Analysis
Figure 9 shows the detection rate of Seurat by varying the number of files inserted on each host and the number of hosts infected. As the number of files inserted on each host increases, the detection rate monotonically increases. This is because the wavelet-based selection picks these new files as feature dimensions, leading to larger distances between the points of infected host state changes and normal host state changes. Consequently, more new files result in a higher detection rate.

As the number of infected hosts increases, the number of points for abnormal host state changes becomes large enough to form an independent new cluster. Therefore, rapidly propagating attacks are more likely to be detected. Conversely, detecting a slowly propagating attack requires a larger detection window, resulting in longer detection latency to accumulate enough infected hosts. This issue is revisited in Section 5.

#### Evaluation on Simulated Linux Worms
We further evaluate the detection rate of Seurat on six Linux worms using simulated attacks. We compile a subset of files modified by each worm based on descriptions from public websites such as Symantec [16] and F-Secure information center [17]. We then manually modify the described files in a number of selected host reports to simulate the corresponding worm attacks. For each worm, we vary the number of infected hosts and run our experiments on the teaching cluster with ten randomly selected days.

Table 10 shows the number of files modified by each worm and the detection rate of Seurat. Generally, the more files modified by a worm, the higher the detection rate. However, the position of a file in the file system directory tree also matters. For example, both Slapper-B and Kork worms insert four new files into a compromised host. Kork worm additionally modifies /etc/passwd to create accounts with root privileges. Because many hosts update /etc/passwd during system reconfiguration events, including such files in the feature vector space reduces the distances from abnormal points to normal points, resulting in higher false negative rates. This is discussed further in Section 5.

### 4.3 Real Attacks
To examine the efficacy of Seurat during a real worm outbreak, we set up an isolated computer cluster where we can launch worms and record file system changes without damaging the real network. This allows us full control over the number of hosts infected and the ability to repeat experiments. Since the isolated cluster has no real users, we merge the data acquired from it with the data collected from the teaching cluster to conduct experiments.

We obtained the binaries and source codes of popular worms from public websites such as whitehats [18] and packetstorm [19]. Extensive testing of Seurat with various real worms in the isolated cluster requires significant effort in setting up each host with the correct versions of vulnerable software. As a first step, we show the results with the Lion worm [20].

#### The Lion Worm
The Lion worm, discovered in early 2001, exploits a vulnerability in BIND 8.2, 8.2-P1, 8.2.1, and 8.2.2-Px. Once a system is infected, it sets up backdoors, leaks confidential information via email, and scans the Internet to recruit vulnerable systems. Lion scans the network by randomly picking the first 16 bits of an IP address and sequentially probing all 2^16 IP addresses in the block. It then selects another address block to continue scanning. As a result, once a host is infected, nearby vulnerable hosts in the same IP address block will be quickly infected. The worm affects the file system by placing related binaries and shell scripts under the /dev/.lib directory, copying itself into the /tmp directory, changing system files under the /etc directory, and attempting to wipe out some log files.

We configured the isolated cluster with three Lion-vulnerable hosts and one additional machine to launch the worm. The vulnerable machines ran RedHat 6.2, including the vulnerable BIND 8.2.2-P5, and used one C class network address block. Each machine was connected to a 100Mbps Ethernet and ran named. The Seurat data collection tool generated a file system update report daily on every machine.

After launching the Lion worm, all three vulnerable hosts in the isolated cluster were quickly infected. We merged the file update reports from each compromised host with a different normal host report generated on February 11, 2004, when there was no anomaly. Figure 11 shows the clustering results for three consecutive days from February 10, 2004, to February 12, 2004, using the merged reports.

On the attack day, 64 files were picked by the wavelet-based selection, and the number of feature dimensions was reduced to 9 after PCA. Seurat successfully detected a new cluster consisting of the three infected hosts. Figure 12 lists the 22 files selected by Seurat as the causes of the alarm, providing enough hints for administrators to confirm the presence of the Lion worm.