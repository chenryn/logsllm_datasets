在采样得到item序列之后，第三步是进行Embedding表示学习，这里对原
●
文的SkipGram模型进行了两处优化：（1）针对超大规模的字典，采用负样本
采样（Negative Sampling）替代Hierarchical Softmax分类器，大幅提高
训练速度；（2）在语言学中，词按照出现频率从大到小排序之后，服从Zipfian
分布（即log-uniform分布），所以SkipGram训练多直接采用Zipfian来计
算负样本采样的概率，而对我们的数据进行分析后，发现item出现的频次与
log-uniform并不完全吻合，不同时间段的数据间也呈现一定的波动趋势，针
对这个现象，我们用边训练边统计每个item的出现频次，维护一个能够按照
item出现频次生成负样本的动态采样器。模型结构如图所示：
新体验  9年双11：互联网技术超级工程
对于行为序列，短时间内的高密度点击更能够反映用户的真实意图，短期的兴
●
趣偏好也更为集中，对比而言，基于用户点击共现的传统CF算法在数据层面
会有更多的噪声。在实践中，准备行为序列数据有两个关键点值得注意：（1）
如何选取行为序列的时间窗口，需要结合业务特点来进行仔细的调节；（2）如
何过滤因为用户误操作而带来的噪声点，我们的实践经验是根据停留时长和类
目不相似度来过滤典型的异常点击
提出并定义了新的转移概率连接图，是为了克服用户真实的session行为中存
●
在的大量节点热点问题，以每个节点为中心，利用其扩散子节点的连接频次及
行为共现频次计算转移概率，构建全网的转移概率连接图，并在此基础上进行
deep walk的随机采样，构造出千亿级别的多阶虚拟样本，用于后续的深度网
络学习
引入宝贝的side-information信息则受到语言模型中sub-word概念的启发，
●
可类比于在word2vector中加入单词的词根、词缀等sub-word信息，认为
某些具有同样词根词缀的单词在某些维度上具有相似的语义，具有同店、同品
牌的宝贝也有一定的相关性。引入side- information后i2i结果的头部精度
得到提高，同店、同品牌的宝贝在排序中更为靠前；同时对于一些没有出现行
为的、新鲜上架的宝贝，根据它的side-information对它进行embedding
表达，有效解决宝贝的冷启动问题。
（3） S3最终版本
在引入side-information和sequence行为序列之后，模型准确性大幅提升，
但仍然面对全网宝贝embedding参数空间太大、训练样本过多的难题（均在千亿
量级以上）。为了解决这一问题，我们根据行为序列天然的转移概率重构全网宝贝的
weighted directed Graph，再将整个网络切分成多个sub-graph，在每个sub-
graph内部进行Graph Embedding训练，不同的sub-graph间并行训练，缩短训
练迭代周期，网络结构如下图所示：
新体验  9年双11：互联网技术超级工程
下面这幅炫酷图对我们的embedding高维向量有一个更直观的解释，我们随机
选取了运动鞋这个一级类目下的宝贝embedding向量降维，不同的颜色代表不同的
叶子类目，每一个点代表一个商品降维后的坐标，可以清晰的看出同一个类目下的宝
贝embedding向量很"自觉"的cluster在一起，说明这种自觉的本质就是graph
embedding的向量是靠谱的。
新体验  9年双11：互联网技术超级工程
在双11之前，我们在这块的工作迭代调优过程历时近两个月，期间分别尝试了
多种不同的网络模型结构，样本选取过滤方式，引入sequential行为信息、转移概
率边的全新构建方法、side information等多方面，多角度调优方法，在日常首页个
性化（AIO）日常场景中uctr对比swing版本i2i提升明显，同时双11在该场景全面
替换线上的最优召回方式。
2.基于XTF的深度排序模型
2.1 XTensorflow简介
2017双十一我们承接了手淘首页流量分发最大的几个首页场景，这几个场景的
特点是流量大、业务规则限制多、同时业务变动频繁，我们需要一个稳定、能支持快
速迭代和实时计算的机器学习平台来支撑我们训练模型以及在线打分。为此，我们参
与了工程团队的共建工作基于Porsche blink的分布式Tensorflow训练及在线打分
平台，首页算法同学基于该平台开发出了若干Rank模型，在相应的业务场景拿到了
不错的效果，我们称该平台为XTensorflow，简称XTF。
在这个深度学习平台上，我们在双十一上线了包括DCN、DeepResNet的深
层高阶特征学习模型，以及更加推广及成熟应用了WDL深度模型，相对于WDL模
型，更为复杂深度模型的尝试也取得了明显的效果。
新体验  9年双11：互联网技术超级工程
征交叉，学习到高阶非线性特征，但是这种交叉是隐性的，交叉阶数无法显示控制，
而且容易"over-generalization"。为了弥补这一点，WDL模型引入了wide侧，显
示记忆一些可解释的特征交叉信息以保证模型的精准性。但是wide侧的引入带来了
大量的特征工程的工作，同时也只能学习2阶（cross-product）浅层的交叉。DCN
引入了cross network，通过网络层数控制特征交叉的阶数，并且它实现高阶特征交
叉需要的参数量远远小于DNN；cross layer的定义比较简单：
这个设计跟ResNet比较像，l+1层的映射函数f实际上是在拟合残差
；cross network最终会和deep network进行jointly learning，完整
的网络结构如下图：
新体验  9年双11：互联网技术超级工程
三、欢迎与我们交流
阿里巴巴推荐算法团队目前主要负责阿里电商平台(包括淘宝、天猫、海外版淘
宝、Lazada等)的商品及feeds流推荐，其中手机淘宝首图个性化、猜你喜欢、购
买链路等场景每天服务数亿用户，涉及流量效率提升、用户体验、提高商家及达人参
与淘宝的积极性，优化商业生态运行机制。
欢迎热爱算法，对业务有好奇心，有合作精神的同学一起工作、成长。简历可投
邮箱：
PI:EMAIL
PI:EMAIL
四、引用
[1] DeepWalk: online learning of social representations. Bryan Perozzi, Rami Al-
Rfou, Steven Skiena. Proceedings of the 20th ACM SIGKDD international
conference on Knowledge discovery and data mining,2014.
[2] node2vec: Scalable Feature Learning for Networks. A. Grover, J. Leskovec. ACM