**作者：heige@知道创宇404实验室  
时间：2021年9月6日**

### 网络空间测绘的核心理念

在KCon2019大会上，我提出了网络空间测绘的两个核心要素：“一是获取更多的数据；二是赋予数据灵魂。”前者是为了“看得清”，而后者则是为了“看得见”。只有当数据被赋予了意义，才能真正实现从数据到知识、再到智慧的升华，最终帮助决策者做出合理的判断。这一过程可以概括为：数据 -> 知识 -> 智慧 -> 决策。

### 数据挖掘与认知视角

网络空间的数据挖掘是一项高度依赖于实施者对数据的认知、理解及思维层次的工作。不同的视角会导致不同的知识结论，这正是古人所说的“以道御器”之道。换句话说，一个人的视野、格局和思维方式决定了其如何解读数据并从中提炼出有价值的信息。

### 3W问题在网络空间测绘中的应用

解决3W问题（即What, Where, Who）是进行网络空间测绘的基础。具体来说，这些问题包括设备是什么、它们分布在哪里以及属于谁。很多时候，前两个问题都是围绕最后一个W展开的，即通过分析设备指纹及其分布情况来确定设备的所有权。然而，“行为测绘”采取了一种相反的方法：首先识别出Who，然后反向追踪What和Where。

### 行为测绘的概念

行为测绘是指根据特定群体的行为特征来进行网络空间测绘的技术。这些行为特征可能体现在设备端口协议中的banner信息上。例如，利用通用组件默认配置作为“行为”来进行识别，虽然这种方法有效但可能会忽略那些进行了自定义配置的目标。本文将重点讨论如何针对这些特殊目标开展行为测绘，并探讨其在威胁情报领域、国家基础设施测绘以及APT/botnet/黑产组织测绘中的广泛应用前景。

### 斩首行动在网络空间的应用

借鉴军事术语中的“斩首行动”，我们可以将其应用于网络安全领域。通过对某些关键安全设备分布情况的分析，我们可以推测出潜在攻击者的防御重点所在。这种策略要求我们不仅关注显而易见的安全措施，还要注意那些看似异常的行为模式，因为它们往往隐藏着重要线索。

### 准确性与异常检测

在网络空间中，存在着各种手段用于干扰探测结果，如蜜罐、防火墙等。如果过于依赖标准探测规则，则容易被误导而忽视真实目标。因此，在设计相关平台时应注重全面展示探测到的所有元数据（包括那些不符合预期的结果），以便更准确地评估风险状况。此外，对于出现偏差的情况也应给予足够重视，因为这可能是对手故意设置的陷阱或有价值的信号。

### 实战案例分析

以Trickbot僵尸网络为例，通过对几个疑似C2服务器地址的访问测试发现，其中部分IP地址返回了相同的HTTP响应头信息，表明它们很可能属于同一个恶意活动的一部分。通过对这些异常行为的研究，我们可以更好地理解和应对复杂的网络威胁。

总之，网络空间测绘不仅仅是关于收集大量原始数据的过程，更重要的是如何有效地处理这些信息并从中提取出有意义的知识。这需要结合先进的技术手段与深刻的战略思考相结合，才能真正实现“以道御器”的理想状态。