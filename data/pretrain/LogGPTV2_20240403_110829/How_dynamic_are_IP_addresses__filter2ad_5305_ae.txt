# 优化后的文本

## 表6: 从UDmap IP和Dynablock IP发送的垃圾邮件
| 电子邮件总数 | 垃圾邮件分类百分比 | Hotmail分类为垃圾邮件的百分比 | 用户报告的垃圾邮件百分比 |
|---------------|---------------------|---------------------------------|----------------------------|
| 27,163,219    | 92.4%               | 40.3%                           | 42.2%                      |
| -             | 92.3%               | 29.3%                           | 30.4%                      |
| -             | 92.2%               | 49.2%                           | 50.7%                      |

## 图10: 邮件服务器IP地址分布
- UDmap IP
- "已识别动态"邮件服务器IP
- "可能静态"邮件服务器IP

## 图11: (a) IP作为邮件服务器使用天数, (b) 每个会话的垃圾邮件比率
- 在两个图中，UDmap IP曲线与“已识别动态”邮件服务器IP曲线重叠。

### 结果分析
仅通过UDmap或Dynablock IP发送垃圾邮件的情况显示，X轴对应垃圾邮件比率（计算方法为每个IP每天接收到的邮件中垃圾邮件的比例），Y轴是会话的累积分数。基于现有Hotmail垃圾邮件过滤器的分类结果，95.6%的UDmap IP会话只发送了垃圾邮件（垃圾邮件比率为100%），97.0%的会话发送了超过90%的垃圾邮件。剩余的3%可能是合法邮件服务器。然而，这3%是我们垃圾邮件检测假阳性率的上限，因为现有的垃圾邮件过滤器可能会遗漏一些垃圾邮件。相比之下，来自可能静态IP地址的高垃圾邮件比率会话比例要小得多：31.4%的会话只发送垃圾邮件，而62.8%的会话垃圾邮件比率低于90%。更重要的是，利用动态IP地址的知识，我们可以过滤掉40.3%未被现有垃圾邮件过滤器检测到但被用户报告为垃圾邮件的邮件（表6的最后一列）。因此，我们预计使用UDmap IP可以进一步减少垃圾邮件过滤的假阴性。

### ASes发送垃圾邮件情况
我们还研究了向Hotmail发送最多垃圾邮件的ASes，结果见表7。需要注意的是，顶级垃圾邮件ASes遍布全球。这一发现与Ramachandran等人[23]的研究结果不同，他们指出大约40%的垃圾邮件源自美国。一个可能的解释是Hotmail的全球用户存在吸引了更广泛的全球垃圾邮件IP地址。表7的第三和第四列展示了这些顶级ASes中动态IP的垃圾邮件行为。特别是，第三列表明，对于大多数顶级ASes来说，超过50%的外发垃圾邮件来自动态IP范围。这表明在大型活跃消费者ASes中，动态IP地址发送的垃圾邮件普遍存在。第四列则传递了一个更强烈的信息：这些（基于动态IP）垃圾邮件源的极高垃圾邮件比率高度表明其中很大一部分是被垃圾邮件发送者利用的僵尸主机。

### 动态IP地址知识的应用潜力
动态IP地址及其使用模式的知识在对抗垃圾邮件方面具有巨大潜力。我们认为系统地研究如何将IP动态知识纳入现有的垃圾邮件检测框架是一个非常重要的未来研究方向。

### 讨论和未来工作
第7节的结果提供了证据，表明IP动态可以成为打击电子邮件垃圾邮件的有效武器。然而仍有改进的空间：可能存在合法邮件服务器使用来自DSL或电缆调制解调器网络的动态IP地址的情况。我们预计这些情况会有不同的邮件发送模式，并正在研究几种可能性作为正在进行的工作。

如第4.5节所述，UDmap可能会误分类某些教学集群（例如大学实验室）和图书馆机器为动态IP。然而，这些机器通常位于.edu域，根据我们的验证结果，它们的数量相对较少（见表4）。为了正确分类这些机器，可以向UDmap提供额外信息——例如，我们可以增强框架以包含诸如OS ID和设备指纹信息[14]等信息，以便更精确地描述IP地址。

输入跟踪的长度也可能影响结果的质量，我们预计较长的跟踪将带来更好的覆盖率。对跟踪长度（持续时间）与IP地址动态之间的关系进行彻底分析是一个有趣的问题，值得重视。

从安全角度来看，垃圾邮件发送者可能希望通过对静态IP使其看起来像动态IP，或者通过使动态僵尸IP看起来像静态IP来规避UDmap的有效性。UDmap对此类攻击具有鲁棒性。除非控制一系列连续的IP，否则无法让静态IP地址看起来像动态IP。另一方面，使动态IP地址看起来像静态IP更加困难，因为无法阻止其他人观察其相邻IP的动态行为。

### 表7: 发送最多垃圾邮件的前10个ASes
| AS编号 | 垃圾邮件数量 | 来自UDmap IP的垃圾邮件百分比 | UDmap IP的垃圾邮件比率 | AS名称 | 国家 |
|--------|--------------|------------------------------|------------------------|--------|------|
| 4134   | 6,349,330,892| 52.92%                       | 93.21%                 | Chinanet-backbone | 中国 |
| 4837   | 5,259,034,812| 42.90%                       | 93.20%                 | China169-backbone | 中国 |
| 4776   | 4,422,195,227| 26.57%                       | 98.70%                 | APNIC ASN block | 澳大利亚 |
| 27699  | 2,359,727,485| 95.61%                       | 91.53%                 | TELECOM DE SAO PAULO | 巴西 |
| 3352   | 2,336,700,524| 84.58%                       | 96.28%                 | Telefonica-Data-Espana | 西班牙 |
| 5617   | 2,234,104,550| 0.54%                        | 97.15%                 | TPNET | 波兰 |
| 19262  | 2,073,172,523| 79.60%                       | 96.19%                 | Verizon Internet services | 美国 |
| 3462   | 1,922,291,974| 86.31%                       | 93.22%                 | HINET | 台湾 |
| 3269   | 1,802,531,410| 88.16%                       | 95.52%                 | TELECOM ITALIA | 意大利 |
| 9121   | 1,760,38,6582| 89.96%                       | 97.78%                 | Turk Telekom | 土耳其 |

### 结论
我们介绍了UDmap，一种简单而强大的方法，可以自动揭示动态IP地址及相关IP波动信息。使用Hotmail用户登录数据，UDmap识别了约1.02亿个跨越5891个AS的动态IP地址，表明互联网中的动态IP地址比例显著。我们的详细大规模IP动态研究表明，大多数识别出的IP地址由各种消费者网络ISP拥有，因此可能用于家庭用户计算机或小型企业主机。我们的发现还表明，IP波动范围从几小时到几天不等。

我们将IP动态信息应用于垃圾邮件过滤作为一个示例应用。使用三个月的Hotmail邮件服务器日志，我们的跟踪研究表明，超过95.6%的使用动态IP地址设置的邮件服务器只发送垃圾邮件，总垃圾邮件量占Hotmail在跟踪期间收到的所有垃圾邮件的42.2%。我们认为这是一个重要且有广泛意义的结果，对垃圾邮件检测领域具有重要意义。

### 参考文献
[略]

---

以上是对原文本的优化，使其更加清晰、连贯和专业。希望对你有所帮助！