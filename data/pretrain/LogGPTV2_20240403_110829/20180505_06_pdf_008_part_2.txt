connections
restrictions)
listener.ora (network postgresql.conf (TCP port, kerberos,
● ●
RDBMS cofiguration...)
restrictions, TCP port)
– Dedicated server only
sqlnet.ora (protocol
●
configuration, kerberos...) ● Shared memory and semaphores are
used for inter process synchronization
– Dedicated server processes
– Connection pooling by other
per client
products
– Multi-threaded server PgBouncer
●
pgpool-II
●
Always used on Windows
●
17.2.2016 PostgreSQL for Oracle DBAs 21
PostgreSQL
Architecture notes The world's most advanced
open source database.
Oracle PostgreSQL
● ●
– Decided that RDBMS – Relies on (believes to)
OS file cache
is right and only place
management
to manage database
buffers – Do not re-implement
features already
– Promotes its ASM to
implemented in OS,
have a direct control
thus it use file system to
on file management
store its data files (no
(ASM is kind of LVM
RAW device support)
dedicated to Oracle)
17.2.2016 PostgreSQL for Oracle DBAs 22
PostgreSQL
Security observations I The world's most advanced
open source database.
Oracle has users and roles
●
– Users and Roles are defined on DB level (not applies for PDB)
– Users and Roles are different entities
Postgres has roles only
●
– Some roles might be granted “with login” permission
Oracle schema consist from a single user objects (schema =
●
user)
– Schema is not an object, so it can't be granted
Postgres schema is a grantable name-space object
●
– Ownership and usage on schema might be granted to roles
– Objects owned by different roles (users) might reside within a single
schema
– Public schema might (and should) be dropped
17.2.2016 PostgreSQL for Oracle DBAs 23
PostgreSQL
Security observations The world's most advanced
open source database.
SW installation:
/oracle/product/12.1.0.2/db_1
OS access control to files
user1
RoleOne
X TableA
Does't work
TableB
user3 TableA RoleTwo FunctionC
Schema:
TableB
user2 user2
FunctionC
Schema:
user3
X - Does't work
17.2.2016 PostgreSQL for Oracle DBAs 24
PostgreSQL
Security observations II The world's most advanced
open source database.
Oracle tablespace always belongs to a database
●
– quotas might be used to limit tablespace usage by users
Postgres tablespace is defined at cluster level
●
– “create” on TS might be granted to a role
– TS ownership to a role might be defined
– There are no space usage quotas on tablespace, check FS free space
Oracle database contains users defined inside DB, there is no
●
database ownership concept
– Grant scope is always within a database (PDB global users exception
exists)
Postgres database might be owned by a specific role
●
– One role might have granted access on objects from multiple databases
– Role attributes possible in scope of database – alter role XXX se
serach_path = YYY,ZZZ in MY_DATABASE
17.2.2016 PostgreSQL for Oracle DBAs 25
PostgreSQL
Security observations III The world's most advanced
open source database.
Oracle distinguish
●
– System privileges (create table..., select any ... )
– Object privileges (grant select on … )
Postgres does not have such strong difference
●
– Login permission is cluster wide kind of “system”
privilege
– Mostly all privileges are related to some objects
including database object itself
Grant connect on database myDB
●
Grant usage on ...
●
Grant create on ...
●
17.2.2016 PostgreSQL for Oracle DBAs 26
PostgreSQL
Security observations IV The world's most advanced
open source database.
Oracle Advanced Security
●
– Transparent Data Encryption
– Kerberos (MS AD integration) is available without
Advanced security as of 12.1 release, applies to older
releases
– Many other security features (VPD, RLS...)
Postgres
●
– SSO available
– Row Security Policies are available with 9.5 release
– TDE is not available
– Encryption is covered by separate module pgcrypto
17.2.2016 PostgreSQL for Oracle DBAs 27
PostgreSQL
Security observations V The world's most advanced
open source database.
Oracle remote access control
●
– IP address level: sqlnet.ora
tcp.validnode_checking = yes
●
tcp.invited_nodes = (hostname1, hostname2)
●
tcp.excluded_nodes = (192.168.10.3)
●
– username password and create session is evaluated as
next step
Postgres
●
– pg_hba.conf File
username/role_membership, database name, source IP address
●
and authentification method is evaluated prior password validation
Password is evaluated as next step
●
17.2.2016 PostgreSQL for Oracle DBAs 28
PostgreSQL
Security observations VI The world's most advanced
open source database.
Oracle [public] synonyms
●
– Synonyms are used to reference another user (schema)
objects
– Might be defined as public – accessible to all users
Postgres
●
– search_path session environment is used to define scope of
visible objects, used similar to PATH in OS
Might be defined at cluster level
●
Users might have specified different search path values in particular
●
databases
ALTER ROLE { role_specification | ALL } [ IN
DATABASE database_name ] SET
configuration_parameter { TO | = } { value |
DEFAULT }
17.2.2016 PostgreSQL for Oracle DBAs 29
PostgreSQL
Security features... The world's most advanced
open source database.
ALL macro in grant commands
●
– Expands to all at time of execution existing objects satisfying
grant scope criteria
Grant execute on ALL functions in schema my_schema to …
●
Alter default privileges
●
– Does not affect existing objects, applied to newly created ones
– Doc: ALTER DEFAULT PRIVILEGES
ALTER DEFAULT PRIVILEGES
[ FOR { ROLE | USER } target_role
[, ...] ]
[ IN SCHEMA schema_name [, ...] ]
abbreviated_grant_or_revoke
17.2.2016 PostgreSQL for Oracle DBAs 30
PostgreSQL
Backup … and recovery The world's most advanced
open source database.
Database [full or partial] dump
●
– Oracle exp/imp, expdp/impdp
– Postgres
pg_dump / pg_restore
●
– “directory” format supports parallel dumps
pg_dumpall (use it for cluster globals only)
●
– Load dump by call to psql
Thanks to MVCC, there is no “ORA-1555” risk during
●
dump
– For sure, the backup is consistent even if the database is used
during the dump
17.2.2016 PostgreSQL for Oracle DBAs 31
PostgreSQL
Binary backups and recovery The world's most advanced
open source database.
Offline! Works for Oracle, Postgres…
●
Online Oracle database backups
●
– Manual
Alter database (tablespace) begin backup, Copy corresponding datafiles, alter
●
database (tablespace) end backup, store archived redologs needed for
recovery
– Or use Oracle RMAN utility
Online Postgres cluster backup
●
– Backup Control Functions
pg_start_backup(), pg_stop_backup(), same as above for Oracle [no TS level
●
available]
– pg_basebackup
Handle calls to backup control functions and might produce copy of postgres
●
cluster or tar archive with the backup. Some features are available like
tablespace mapping for convenient backup procedure/higher flexibility
17.2.2016 PostgreSQL for Oracle DBAs 32
PostgreSQL
Binary backups and recovery The world's most advanced
open source database.
pgBarman
●
– Some features similar to oracle RMAN
Recovery window / # of copies
●
Stores archived WALs together with Barman backups
●
Backup reports
●
Does not use “rman catalog”, backed up files with some barman
●
metadata files are enough
Single backup might be aechived to tape (tape integration is not
●
part of pgBarman) – it disappears from backup reports, once
retrieved from tape, pgBarman can use the backup again
pgBackRest
●
– More complicated configuration than Barman, incremental
backups seems to be implemented slightly better
17.2.2016 PostgreSQL for Oracle DBAs 33
PostgreSQL
HA & DR The world's most advanced
open source database.
OS clusterware (RHEL Pace Maker,
●
PowerHA…)
– Simply works
There is no usable technology like Oracle
●
RAC for PostgreSQL server
– Sharding (Postgres XL) is not about sharing data
files between nodes
– Oracle 12.2 seems to provide some support for
sharding
17.2.2016 PostgreSQL for Oracle DBAs 34
PostgreSQL
Oracle replication The world's most advanced
open source database.
Oracle DataGuard
●
– Log shipping (log_archive_dest_n) by archiver
ARCHIVE_LAG_TARGET
●
– Redo transmit by LGWR
ASYNC
●
SYNC
●
Delayed recovery - DELAY=minutes attribute of the
●
LOG_ARCHIVE_DEST_n
– Logical standby
– Active Data Guard
– Golden Gate
17.2.2016 PostgreSQL for Oracle DBAs 35
PostgreSQL
RDBMS replication The world's most advanced
open source database.
Postgres
●
– Log-Shipping Standby Servers
archive_timeout
●
– Streaming Replication
ASYNC (default)
●
SYNC - Synchronous Replication
●
Standby Server Settings recovery_min_apply_delay available from
●
9.4
– Logical Standby
Slony, Bucardo, logical decoding framework
●
– Hot Standby ( read only accessible standby )
– BDR provides asynchronous multi-master logical replication.
17.2.2016 PostgreSQL for Oracle DBAs 36
PostgreSQL
Others… I The world's most advanced
open source database.
psql command line client
●
– Comfortable interface, but be aware of default
AUTOCOMMIT behavior
CZ fast reference by Pavel Stěhule
●
--data-checksums initdb option
●
– Page check-sums are calculated for all object in all
databases in cluster
– use pgbench to vefiry performance impact
– Checksum is calculated on page read
– Backup operate at file level, checksums are not calculated
during backup
17.2.2016 PostgreSQL for Oracle DBAs 37
PostgreSQL
Others… II The world's most advanced
open source database.
Oracle dual table
●
select function() from dual;
–
– SQL Loader, External tables
– db links
PostgreSQL
●
select function(); select 5/8;
–
– copy command (client side, server side), file_fdw for
CSV files, format compatible with COPY command
required
– Foreign Data Wrappers for many kinds of data sources,
including Oracle database
17.2.2016 PostgreSQL for Oracle DBAs 38
PostgreSQL
Others… III The world's most advanced
open source database.
Porting from Oracle PL/SQL
●
– Oracle / Postgres – often similar, not always the same
ORA: trunc(date_variable, format)
●
PG: date_trunc('field', source)
●
Pipelined functions are not implemented
●
Group by can use column alias in postgreSQL
●
open2300db=> select date_trunc('hour', rec_datetime) as record_time,
round(avg(temp_out), 2) as avg_temp,
max(wind_speed_max) as max_wind_max
from open2300.weather where
rec_datetime > now() - interval '3 hour'
group by record_time
order by record_time desc;
record_time | avg_temp | max_wind_max
------------------------+----------+--------------
2016-02-15 22:00:00+01 | 3.04 | 2.4
2016-02-15 21:00:00+01 | 3.23 | 2.5
2016-02-15 20:00:00+01 | 3.66 | 2.3
2016-02-15 19:00:00+01 | 4.11 | 2.6
17.2.2016 PostgreSQL for Oracle DBAs 39
PostgreSQL
Others… partitioning The world's most advanced
open source database.
Postgres partitioning is implemented on top of
●
inheritance feature
– Declarative partitioning like in Oracle is not available
Some basic development for 9.6
●
Constraint on child tables
●
Trigger on master table
●
– Static IF… requires trigger compilation if new child
partition tables are added
– Trigger builds dynamic SQL – more overhead
No global indexes on partitioned tables
●
17.2.2016 PostgreSQL for Oracle DBAs 40
PostgreSQL
Others… get table filename The world's most advanced
open source database.
Bonus link:
●
How to find out which PostgreSQL table a file on
disk corresponds to
Q & A /* end of slides */
●
17.2.2016 PostgreSQL for Oracle DBAs 41