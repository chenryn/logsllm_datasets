下载器的文件。同月里，FireEye还发现了一起APT34针对一个中东组织发起的攻击。攻击中使用了恶意的.rtf文件(MD5:
63D66D99E46FB93676A4F475A65566D8)。文件利用了CVE-2017-0199，并发出GET请求从以下地址中下载恶意文件:
hxxp://94.23.172.164/dupdatechecker.doc
如图12所示，dupatechecker.doc文件中的脚本尝试从同一服务器下载另一个名为dupatechecker.exe的文件。该文件里还包含了作者留下的话，似乎是对安全研究人员的嘲讽。
图12：dupatechecker.doc中的脚本内容
The dupatechecker.exe 文件 (MD5: C9F16F0BE8C77F0170B9B6CE876ED7FB)
同时释放BONDUPDATER 和POWRUNER。这些文件里的后门与proxychecker[.]pro这个C2服务器通信。
## 四、总结
####
APT34近期的活动表明，他们是一个有能力的组织并且拥有获取发展自身资源的潜在渠道。在过去几个月中，APT34已经能够迅速地将至少两个公开的漏洞（CVE-2017-0199和CVE-2017-11882）结合起来，应用到他们针对中东地区各组织的攻击当中去。同时APT34也在不断努力去更新他们的恶意软件。包括DGA生成C2域名等，表明了该组织也在不断寻求反侦测的策略。
**文件名** **/** **域名** **/ IP** **地址**
|
**MD5 哈希值或相应描述**  
---|---  
CVE-2017-11882 exploit document
|
A0E6933F4E0497269620F44A083B2ED4  
b.txt
|
9267D057C065EA7448ACA1511C6F29C7  
v.txt/v.vbs
|
B2D13A336A3EB7BD27612BE7D4E334DF  
dUpdateCheckers.base
|
4A7290A279E6F2329EDD0615178A11FF  
hUpdateCheckers.base
|
841CE6475F271F86D0B5188E4F8BC6DB  
cUpdateCheckers.bat
|
52CA9A7424B3CC34099AD218623A0979  
dUpdateCheckers.ps1
|
BBDE33F5709CB1452AB941C08ACC775E  
hUpdateCheckers.ps1
|
247B2A9FCBA6E9EC29ED818948939702  
GoogleUpdateschecker.vbs
|
C87B0B711F60132235D7440ADD0360B0  
hxxp://mumbai-m[.]site
|
POWRUNER C2  
hxxp://dns-update[.]club
|
Malware Staging Server  
CVE-2017-0199 exploit document
|
63D66D99E46FB93676A4F475A65566D8  
94.23.172.164:80
|
Malware Staging Server  
dupdatechecker.doc
|
D85818E82A6E64CA185EDFDDBA2D1B76  
dupdatechecker.exe
|
C9F16F0BE8C77F0170B9B6CE876ED7FB  
proxycheker[.]pro
|
C2  
46.105.221.247
|
Has resolved mumbai-m[.]site & hpserver[.]online  
148.251.55.110
|
Has resolved mumbai-m[.]site and dns-update[.]club  
185.15.247.147
|
Has resolved dns-update[.]club  
145.239.33.100
|
Has resolved dns-update[.]club  
82.102.14.219
|
Has resolved ns2.dns-update[.]club & hpserver[.]online & anyportals[.]com  
v7-hpserver.online.hta
|
E6AC6F18256C4DDE5BF06A9191562F82  
dUpdateCheckers.base
|
3C63BFF9EC0A340E0727E5683466F435  
hUpdateCheckers.base
|
EEB0FF0D8841C2EBE643FE328B6D9EF5  
cUpdateCheckers.bat
|
FB464C365B94B03826E67EABE4BF9165  
dUpdateCheckers.ps1
|
635ED85BFCAAB7208A8B5C730D3D0A8C  
hUpdateCheckers.ps1
|
13B338C47C52DE3ED0B68E1CB7876AD2  
googleupdateschecker.vbs
|
DBFEA6154D4F9D7209C1875B2D5D70D5  
hpserver[.]online
|
C2  
v7-anyportals.hta
|
EAF3448808481FB1FDBB675BC5EA24DE  
dUpdateCheckers.base
|
42449DD79EA7D2B5B6482B6F0D493498  
hUpdateCheckers.base
|
A3FCB4D23C3153DD42AC124B112F1BAE  
dUpdateCheckers.ps1
|
EE1C482C41738AAA5964730DCBAB5DFF  
hUpdateCheckers.ps1
|
E516C3A3247AF2F2323291A670086A8F  
anyportals[.]com
|
C2