Kopchak!
!
26!
stagnant!for!extended!periods!of!time.!!The!drive!controller!is!responsible!for!ensuring!even!wear!across!
the!entire!solid!state!drive.!
!
&
Kopchak!
!
27!
Controllers&
!The!heart!of!a!solid!state!drive!is!its!controller.!!This!device!is!responsible!for!all!operational!aspects!
of!a!solid!state!drive.!!The!choice!of!a!controller!and!the!implementation!of!its!firmware!can!have!a!
significant!consequence!on!the!overall!impact!and!performance!of!the!drive!itself.!!There!are!several!
varieties!of!competing!controller!designs!which!implement!features!differently.!!Furthermore,!
manufacturers!frequently!customize!controller!firmware!to!help!distinguish!their!products.!!These!
differences!complicate!the!evaluation!of!solid!state!drives,!since!the!characteristics!of!the!hardware!has!
a!tendency!to!vary!across!manufacturers!and!even!individual!models!of!drives.!!
By!far,!the!slowest!operation!in!a!currentageneration!solid!state!drive!is!the!erasure!of!invalid!flash!
cells!to!restore!them!to!a!refreshed!and!usable!state.!!Since!any!valid!data!must!be!moved!out!of!a!block!
before!it!is!erased,!this!becomes!an!even!more!timeaconsuming!process.!!Early!generation!SSDs!showed!
noticeable!degradation!of!performance!as!they!aged,!due!to!the!lack!of!available!unused!pages!for!
storing!data!as!it!was!written.!!When!no!free!pages!are!available,!the!SSD!controller!must!manipulate!
the!existing!data,!shifting!around!valid!data!to!other!areas!of!the!drive!so!that!entire!blocks!may!be!
erased.!!A!design!goal!of!more!recent!SSDs!is!to!prevent!this!degradation!of!performance!whenever!
possible.!!To!prevent!SSDs!from!incrementally!getting!slower!as!they!are!used,!manufacturers!
implement!a!variety!of!garbage!collection!techniques!to!ensure!a!pool!of!available!pages!are!continually!
ready!for!use.!!!
The!time!periods!where!any!drive!is!actively!reading!or!writing!data!is!generally!a!small!component!
of!the!overall!duration!of!a!drive’s!lifecycle.!!This!means!that!the!drive!spends!a!significant!portion!of!its!
lifetime!sitting!idle,!waiting!for!the!next!I/O!operation!to!occur.!!To!prevent!performance!degradation,!
SSD!controllers!frequently!use!idle!time!for!performing!garbage!collection!and!wear!leveling!operations.!!
By!keeping!an!internal!record!of!invalid!pages!waiting!for!erasure,!a!controller!can!free!up!entire!blocks!
Kopchak!
!
28!
so!that!they!can!be!erased.!!By!doing!this!work!when!the!drive!is!idle,!the!controller!ensures!that!free!
blocks!are!readily!available.!
The!time!period!from!when!data!is!erased!by!the!user!and!ultimately!purged!from!the!drive!by!the!
garbage!collection!mechanism!varies!from!drive!to!drive.!!Some!operating!systems!speed!up!the!process!
by!issuing!the!TRIM!command,!which!notifies!the!SSD!of!deleted!pages.!!On!other!solid!state!drives,!this!
data!will!be!permanently!deleted!very!nearly!immediately.!!On!other!drives,!this!data!may!remain!on!the!
drive!in!a!stagnant!but!undeleted!state!for!a!longer!duration!of!time.!
Wear!leveling!procedures!are!also!managed!by!a!solid!state!drive’s!controller.!!As!previously!
discussed,!flash!memory!cells!have!a!finite!number!of!write!cycles!that!they!can!sustain!before!they!
degrade!and!become!unusable.!!To!compensate!for!the!uneven!wear!patterns!caused!by!general!
operating!system!I/O!patterns,!controllers!will!move!data!to!different!flash!cells.!!Data!that!is!frequently!
rewritten!will!be!moved!to!cells!that!are!fresher,!whereas!more!constant!data!will!be!moved!to!cells!that!
have!seen!a!higher!degree!of!wear.!!The!ultimate!goal!of!this!process!is!to!ensure!a!fairly!uniform!
distribution!of!write!cycles!across!the!entire!set!of!flash!memory!in!a!solid!state!drive.!!The!wear!leveling!
process!is!ongoing!and!constant,!allowing!for!the!longest!drive!lifetime!possible.!
SSD!controllers!also!frequently!perform!a!significant!amount!of!data!processing!to!optimize!it!for!
storage!on!the!flash!media.!!Although!these!processes!vary!according!to!the!type!of!controller!and!
manufacturer's!firmware!implementation,!common!manipulations!include!compression,!deduplication,!
and!striping!of!data!across!flash!chips!for!redundancy.!
At!any!given!point!in!time,!there!is!a!significant!amount!of!work!being!performed!by!a!drive!
controller.!!One!of!the!most!disastrous!side!effects!of!read!and!write!cycles!is!the!concept!of!write!
amplification.!!Frequently,!writing!data!to!flash!requires!much!more!effort!within!the!drive!than!simply!
Kopchak!
!
29!
recording!the!data!to!flash!and!moving!on!to!the!next!task.!!Wear!leveling!and!garbage!collection!
processes!also!require!write!and!erase!cycles!to!accomplish!these!tasks.!!Although!write!amplification!is!
impossible!to!avoid,!manufacturers!seek!to!develop!methods!to!reduce!write!amplification!factors!as!
much!as!possible.!!To!prevent!redundant!writes!of!information!that!already!is!stored,!some!SSD!
controllers!may!analyze!incoming!data!and!temporarily!store!it!on!an!internal!cache,!for!comparison!
with!existing!data.!!In!the!case!of!a!small!modification!of!a!large!file,!it!is!likely!that!a!majority!of!the!file!
will!remain!constant.!!Some!controllers!will!recognize!this,!and!write!out!only!the!changes!to!the!file!as!
opposed!to!the!entire!file.!!This!feature!greatly!reduces!the!amount!of!file!manipulation!that!occurs!
within!the!flash!memory!itself.!!!
Deduplication!seeks!to!avoid!writing!identical!blocks!of!data!to!multiple!locations!on!the!drive.!!A!
controller!that!supports!deduplication!will!analyze!incoming!data!and!compare!its!contents!to!cells!
already!written.!!If!there!is!an!identical!match,!the!controller!will!use!a!single!block!to!represent!both!
blocks.!!In!a!perfect!scenario,!a!drive!containing!multiple!copies!of!the!same!file!will!only!store!a!single!
copy!of!data!within!the!flash!memory.!!Although!data!deduplicated!by!a!solid!state!controller!will!
actually!result!in!more!free!flash!space!being!available!within!the!SSD,!this!space!is!reserved!by!the!drive!
and!not!revealed!to!the!user!as!additional!storage!space.!!!
In!many!respects,!the!SSD!is!much!less!related!to!a!standard!hard!drive!than!is!apparent!to!the!user.!!
The!underlying!hardware!and!software!come!closer!to!emulating!an!enterprise!level!SAN!or!RAID!array!
of!flash!chips!than!a!simple!hard!drive.!
!
&
Kopchak!
!
30!
Evidence&Collection&
Perhaps!the!most!critical!stage!of!any!forensics!case!is!the!evidence!collection!process.!!Any!
mistakes!that!are!made!during!this!stage!can!have!significant!and!devastating!negative!ramifications!on!
the!success!of!the!entire!case.!!In!order!for!evidence!to!be!considered!admissible!in!a!court!of!law,!a!
forensics!investigator!must!be!able!to!demonstrate!that!sound!forensics!techniques!were!utilized!
throughout!the!course!of!the!investigation.!!The!investigator!must!also!be!able!to!demonstrate!the!chain!
of!custody!for!the!evidence,!and!also!be!able!to!ascertain!that!the!evidence!was!never!modified,!altered,!
or!corrupted!as!a!result!of!the!investigation.!
One!of!the!standard!tools!used!to!prevent!contamination!of!evidence!during!a!forensics!
investigation!is!a!write!blocker.!!This!is!a!device!that!allows!for!a!source!drive!to!be!imaged,!while!
prohibiting,!or!blocking,!any!write!operations!from!being!performed!on!the!evidence!drive.!!In!order!for!
evidence!to!be!considered!to!be!admissible!in!court,!the!use!of!a!write!blocker!is!expected.!!!
!
!
!
Kopchak!
!
31!
Methodology&
!
This!work!is!primarily!a!quantitative!study,!but!there!were!also!some!qualitative!methods!
employed!as!well.!!To!begin!with,!a!pool!of!solid!state!drives!was!acquired.!!Initially,!it!was!intended!to!
accomplish!this!by!contacting!drive!manufacturers!and!requesting!loaner!or!demo!models!for!this!
research,!in!order!to!obtain!a!pool!of!various!manufacturer’s!devices!and!controller!chips!to!achieve!a!
sufficient!sample!size.!!The!goal!was!to!obtain!a!large!sample!size,!with!a!contingency!for!conducing!
research!on!any!drives!that!became!available.!!Ultimately,!it!proved!difficult!to!obtain!participation!from!
the!majority!of!manufacturers!that!were!contacted,!either!due!to!the!lack!of!response!or!intellectual!
property!concerns.!!To!prevent!this!setback!from!diluting!the!sample!size,!several!commercially!available!
drives!from!various!manufacturers!were!obtained!for!testing.!!The!drives!used!for!these!tests!represent!
a!sample!of!drives!available!during!the!2012!model!year!from!various!manufacturers.!!For!comparison,!a!
standard!magnetic!hard!drive!was!used!as!a!control!for!all!tests.!
!
All!tests!were!conducted!to!simulate!a!forensics!evidence!capture!process.!!This!primarily!
included!the!imaging!and!recovery!of!deleted!files!from!the!pool!of!drives.!!Various!factors!were!
manipulated,!one!at!a!time,!to!determine!which!activities!might!result!in!a!successful!or!unsuccessful!
recovery!of!files!on!the!drive.!!!
In!order!to!understand!the!exact!differences!between!solid!state!drives!and!physical!hard!drives!
with!respect!to!the!management!of!deleted!evidence!files,!a!series!of!experiments!were!conducted!to!
explore!the!operation!of!the!test!pool!of!drives.!!A!variety!of!test!scenarios!were!designed!to!track!the!
results!of!minor!changes!on!the!contents!of!a!drive.!!These!tests!included!the!deletion!of!an!individual!
file!(using!various!operating!systems!and!interfaces)!and!the!formatting!of!the!drive!(both!quick!and!
full).!!Since!solid!state!drives!can!behave!differently!depending!on!the!amount!of!capacity!in!use!on!the!
drive,!experiments!were!conducted!with!a!nearly!blank!drive!to!simplify!the!analysis!of!the!data!and!to!
Kopchak!
!
32!
reduce!the!number!of!potential!variables.!!In!all!cases,!tests!were!designed!to!build!upon!and!verify!the!
results!of!previous!experiments.!!!!
Throughout!the!research!process,!a!standardized!test!environment!was!used!across!all!tests.!!
Previous!work!has!shown!that!the!operating!system!in!use!can!have!a!significant!impact!on!the!
operation!of!a!solid!state!drive,!especially!if!SSDaspecific!ATA!commands!such!as!TRIM!are!implemented.!!
To!ensure!that!this!property!was!investigated,!operating!systems!that!support!and!allow!TRIM!to!be!
turned!on!and!off!(such!as!Windows!7)!were!used,!as!well!as!legacy!nonaTRIM!supporting!operating!
systems!(such!as!Windows!XP).!!All!analysis!was!performed!using!open!source!or!freelyaavailable!tools.!!
The!majority!of!the!investigation!was!performed!using!data!acquisition!and!file!carving!capabilities!built!
in!to!the!Caine!Forensics!Linux!distribution.!!When!determining!which!tools!to!use!for!each!experiment,!
simplified!approaches!were!preferred!in!order!to!minimize!the!number!of!potential!variables.!
A!dedicated!laptop!was!used!for!creating!all!of!the!“evidence”!drives!used!for!all!of!the!tests.!!All!of!
these!drives!were!used!as!secondary!drives!in!this!machine;!the!operating!system!was!run!on!a!different!
drive.!!This!was!done!to!allow!maximum!control!of!any!data!or!file!operation!on!the!drives!being!
researched,!and!also!to!reduce!the!likelihood!of!any!background!operating!system!behavior!resulting!in!
corrupted!data.!!!!
A!dedicated!desktop!was!used!for!all!of!the!data!acquisition.!All!drive!images!were!made!using!a!
commercial!write!blocker!device,!ensuring!that!all!data!collection!was!conducted!in!a!forensically!sound!
manner.!!After!initial!analysis,!drive!images!were!compressed!and!stored!on!an!external!drive!for!any!
follow!up!research!that!would!be!necessary.!!To!prepare!each!drive!for!subsequent!tests,!an!ATA!Secure!
Erase!command!was!issued!to!the!drive.!!When!properly!implemented,!this!command!resets!the!drive!to!
factory!defaults!and!completely!wipes!clean!all!dataabearing!storage!regions!of!the!drive.!!!
Kopchak!
!
33!
Quantitative!methods!were!generally!used!to!analyze!the!hard!data!generated!as!part!of!the!
research!experiments!described!above.!!!Tests!were!designed!to!generate!information!about!the!viability!
of!forensically!recovering!deleted!files!on!an!SSD.!!!The!primary!contribution!of!this!research!is!the!
generation!of!detailed!discussions!regarding!the!results!and!their!underlying!forensics!implications.!!!
When!evaluating!the!overall!practicality!of!forensics!approaches!using!SSDs,!the!outcomes!of!
the!tests!were!synthesized!with!the!results!of!the!research.!!Some!of!these!conclusions!tended!to!be!
qualitative!in!nature,!and!will!be!presented!as!a!discussion!of!the!major!areas!of!concern!with!respect!to!
SSD!security.!!A!compilation!of!best!practices!for!handling!and!working!with!the!evidence!contained!and!
stored!on!the!drives!will!also!be!included!at!the!conclusion!of!this!paper.!
!
&
Kopchak!
!
34!
Materials&
The!experiments!associated!with!this!research!were!performed!across!a!pool!of!six!solid!state!drives.!!
A!seventh!drive,!which!is!a!traditional!magnetic!device,!was!used!as!a!control!for!all!tests.!!Due!to!a!
failure!of!one!of!the!solid!state!drives!in!the!test!pool,!some!of!the!later!tests!were!conducted!across!five!
drives,!with!the!sixth!being!the!control.!!The!CrystalDiskInfo!utility!was!used!to!capture!the!firmware!
revision!and!version!information!for!each!of!these!drives.!
Control:&Seagate&ST98013ASG,&80GB,&7200&RPM&
The!control!drive!is!a!standard!Seagate!laptop!hard!drive,!with!a!capacity!of!80!GB!and!a!rotational!
speed!of!7200!RPM.!!This!drive!represents!a!typical!laptop!hard!drive!that!might!be!replaced!with!a!
similarly!sized!solid!state!drive.!!The!behavior!of!this!drive!in!a!forensics!investigation!should!model!the!
expected!behavior!of!the!overwhelming!majority!of!traditional!hard!drives.!!
The!firmware!on!this!drive!was!not!upgraded!and!represents!the!code!originally!shipped!when!the!
drive!was!new.!!
!
Figure'1:'Seagate'Drive'Disk'Info'
Kopchak!
!
35!
SSD&#1:&Intel&SSD&320,&120GB&
The!Intel!SSD!320!contains!the!same!controller!as!previous!Intel!SSDs,!but!is!running!improved!
firmware.!!One!of!the!unique!features!of!this!controller!is!native!encryption,!where!all!of!the!data!is!
committed!to!flash!encrypted!using!AESa128.!!According!to!the!manufacturer,!this!allows!for!secure!
erase!operations!to!be!performed!simply!by!changing!the!encryption!key.!!The!controller!in!the!Intel!SSD!
320!offers!TRIM!support.!
The!firmware!revision!in!this!SSD!(4PC10362)!was!released!to!address!a!significant!bug!that!
presented!the!drive!capacity!as!8!megabytes!(MB)!and!prevented!any!data!on!the!drive!from!being!
accessed!or!modified!(Frosty).!!
!
Figure'2:'Intel'SSD'Info'
'