# A Quantitative Analysis of the Insecurity of Embedded Network Devices: Results of a Wide-Area Scan

**Authors:**
Ang Cui and Salvatore J. Stolfo  
Department of Computer Science, Columbia University  
{ang, sal}@cs.columbia.edu

## Abstract
This paper presents a quantitative lower bound on the number of vulnerable embedded network devices globally. Over the past year, we have systematically scanned large portions of the internet to monitor the presence of trivially vulnerable embedded devices. At the time of writing, we have identified over 540,000 publicly accessible embedded devices configured with factory default root passwords, constituting over 13% of all discovered embedded devices. These devices range from enterprise equipment such as firewalls and routers to consumer appliances like VoIP adapters, cable and IPTV boxes, and office equipment such as network printers and video conferencing units. Vulnerable devices were detected in 144 countries, across 17,427 unique private enterprise, ISP, government, educational, satellite provider, and residential network environments. Preliminary results from our longitudinal study tracking over 102,000 vulnerable devices revealed that over 96% of these devices remain vulnerable after a 4-month period. We believe the data presented in this paper provides a conservative lower bound on the actual population of vulnerable devices. By combining the observed vulnerability distributions and their potential root causes, we propose a set of mitigation strategies and hypothesize about their quantitative impact on reducing the global vulnerable embedded device population. We have partnered with Team Cymru to engage key organizations capable of significantly reducing the number of trivially vulnerable embedded devices currently on the internet. As an ongoing longitudinal study, we plan to gather data continuously over the next year to quantify the effectiveness of the community's cumulative effort to mitigate this pervasive threat.

## 1. Introduction
Embedded network devices have become ubiquitous in modern homes, offices, and the global communication infrastructure. Routers, NAS appliances, home entertainment systems, wireless access points, webcams, VoIP devices, print servers, and video conferencing units reside on the same networks as personal computers and enterprise servers, forming our worldwide communication infrastructure. Widely deployed and often misconfigured, embedded network devices constitute highly attractive targets for exploitation.

While it is commonly believed that embedded devices are less secure than general-purpose computers and often trivial to exploit, evidence of such insecurities is mostly anecdotal. To fully appreciate the scope and scale of the embedded threat, we must move beyond individual device analysis and their vulnerabilities. To formulate realistic and effective mitigation strategies against current and future embedded device exploitation, we pose and answer several fundamental questions:

- How have embedded devices been exploited in the past? How feasible is large-scale exploitation of embedded devices? (Section 2)
- How can we quantitatively measure the level of embedded device insecurity on a global scale? (Section 3)
- How can compromised embedded devices be used to benefit malicious attackers? (Section 4)
- How many vulnerable embedded devices are there in the world? What are they? Where are they? (Section 5)
- What are the most efficient methods of securing vulnerable embedded devices? (Section 6)

The purpose of our project is to quantify and trend the level of insecurity of embedded devices currently in use. To this end, we first establish an observed lower bound on the number of trivially vulnerable embedded devices on the internet. We do this by assuming the role of the least sophisticated malicious attacker, who only tries to log into publicly reachable embedded devices using well-known default root credentials. Section 3 describes the default credential scanner we developed using standard tools such as nmap, which positively identified over 540,000 wide-open embedded devices.

Vulnerable devices were detected in 144 countries, across various network environments including enterprise, ISP, government, educational, satellite provider, and residential networks. Military networks were intentionally excluded from our scan, although a collaborative effort is underway to carry out the same scan on US military networks.

| IPs Scanned | Targeted Devices | Vulnerable Devices | Vulnerability Rate |
|-------------|------------------|--------------------|--------------------|
| 3,223,358,720 | 3,912,574 | 540,435 | 13.81% |

### Figure 1: Distribution of Vulnerable Embedded Devices in IPv4 Space
Total Number of Vulnerable Devices Found: 540,435

While the observed quantity and distribution of embedded devices configured with default root passwords demonstrate a global, pervasive phenomenon, we believe the data presented in this paper represents a conservative lower bound on the actual population of vulnerable devices. Evidence suggests that this lower bound can be raised significantly by slightly escalating the level of sophistication of our assumed attacker [11].

#### 1.1 Contributions
We present the first quantitative measurement of embedded device insecurity on a global scale, along with preliminary results from an ongoing longitudinal study. By assuming the role of the least sophisticated attacker, we present an observed lower bound on the distribution of trivially exploitable network embedded devices over functional, spatial, organizational, and temporal domains.

The embedded device default credential scanner created for this experiment is designed to efficiently and safely identify vulnerable embedded devices on the network. It does this by testing whether one can remotely log in to a device using well-known default root credentials. The verification process is designed to use minimal resources on the target embedded device. The scanner currently supports 73 unique embedded device types, including consumer appliances, home networking devices, office appliances, enterprise and carrier networking equipment, data-center power management devices, network security appliances, server lights-out-management controllers, IP camera surveillance systems, VoIP devices, video conferencing appliances, and ISP-issued modems and set-top boxes.

While the embedded security threat has been generally known for some time, the data presented in this paper provides a real-world quantitative assessment of the scale and scope of the embedded threat on a global level. Analysis of our results yields several interesting features within the observed vulnerability distributions. The features presented in Section 5 provide insights into the root causes of the existence of vulnerable embedded devices. By combining the observed vulnerability distributions and their potential root causes, we formulate a set of mitigation strategies and hypothesize about their quantitative impact on reducing the global vulnerable device population.

Many forces will undoubtedly change the observable lower bound of embedded device insecurity over time. For example, the out-of-the-box security of new embedded products may improve. Network operators controlling large homogeneous sets of devices may enhance their security, as may small and medium-sized organizations like private enterprises and educational institutions. The level of malicious exploitation will also indirectly contribute to the overall effort dedicated to improving embedded device security. Lastly, it is our hope that the data and mitigation strategies reported in this paper will generate more awareness of this pervasive threat. To quantify the scope of the embedded device insecurity threat over time and detect such forces at work, we plan to continue our scanning activities to conduct an ongoing longitudinal study over the next year. Section 5.5 discusses the preliminary results of our longitudinal study over the past four months.

#### 1.2 Outline
The remainder of this paper is organized as follows:
- **Section 2**: Surveys recent developments related to embedded device insecurity in white-hat and black-hat communities as well as popular literature.
- **Section 3**: Describes our methodology, emphasizing the steps taken to ensure a safe and ethical experimental protocol.
- **Section 4**: Describes a variety of novel malicious uses of the vulnerable devices discovered by our scanner.
- **Section 5**: Presents the analysis of data gathered from our latest global scan and preliminary results from our ongoing longitudinal study.
- **Section 6**: Presents a set of remediation strategies, along with quantitative estimates of their potential effect on the global vulnerable device population.
- **Section 7**: Concludes with a summary of our contributions.

## 2. Related Works
Evidence of embedded device insecurity and exploitation has been presented in both white-hat and black-hat venues for quite some time. The creation and propagation characteristics of hypothetical malnets exploiting vulnerable wireless routers have been described by several researchers [10, 19]. For example, Traynor et al. showed that an adversary could potentially compromise over 24,000 routers in Manhattan in less than two hours [19]. Our scan data indicates that trivially exploitable embedded devices exist in sufficient quantity and concentration for such hypothetical attacks to be feasible. Our data also corroborates that phishing attacks using compromised consumer electronics such as home routers [20] can be carried out on a large scale by technically unsophisticated attackers.

Existing evidence clearly reinforces the common wisdom that embedded devices are generally less secure than general-purpose computers and are often trivial to exploit. However, the available literature tends to focus on specific vulnerabilities or vulnerable devices. For example, a recent Wired.com article [9] announced a vulnerability found on the administrative interface of the SMC8014 series cable modem, potentially affecting 65,000 Time Warner customers. Numerous research projects [18, 11] targeting specific device types have demonstrated that large numbers of vulnerabilities exist within ubiquitous embedded device types. According to Bojinov et al., an audit of common embedded administrative interfaces from 16 major manufacturers yielded significant vulnerabilities in all 21 devices considered [11].

The evolution of embedded device exploitation tools and techniques demonstrates an accelerating maturation of malicious attacks against embedded devices. While proof-of-concept Cisco IOS exploits and shellcode have been publicly available since 2003 [13, 16], recent evidence suggests that attackers are scanning for and exploiting consumer routers to build modest-size botnets, mainly for DDoS purposes. The appearance of tutorials [5] and simple-to-use tools to find and control specific consumer routers indicate that embedded device exploitation techniques are beginning to diffuse out of research circles and into the general black-hat community.

To the best of our knowledge, the first consumer router botnet, psyb0t, was reported by Dronebl.org in 2008 [6]. While no detailed analysis of the bot was published, we know that it primarily targeted mipsel OpenWRT and DD-WRT devices using default passwords. It is suspected that the psyb0t botnet observed in 2008 was a proof-of-concept test of the technology [7], as the botnet was quickly shut down by its operators following Dronebl.org’s public announcement of its existence.

The current generation of embedded device malcode may be related to existing Unix tools like Kaiten.c [1]. A survey of black-hat literature circa 2008 shows at least one document describing the process of compromising similar consumer routers using password guessing and existing Unix IRC bots [5]. This may help explain why the majority of victim embedded devices exploited thus far have been Unix-based consumer routers. For example, psyb0t targeted only home routers and heavily leveraged the Unix-like operating environment found on its victim devices. Specifically, psyb0t used commands like wget and chmod to download its payload onto victim devices and used iptables to block all administrative interfaces to protect the device from other attackers.

### 2.1 Next Generation Embedded Malcode
Existing embedded device malcode, such as psyb0t, depends heavily on its victim devices' similarity to traditional Unix systems. While development of such malcode is relatively straightforward, it constrains the vulnerable population to low-end consumer appliances running Unix-like operating systems. For example, enterprise networking devices like Cisco routers and switches run on proprietary operating systems like IOS, which do not resemble traditional Unix architecture. However, recent advancements in exploitation and rootkitting techniques for proprietary operating systems like Cisco IOS [17, 14] could allow attackers to compromise high-end enterprise devices like backbone routers and firewalls. It is highly likely that the next generation of embedded device malcode will have greater ability to compromise heterogeneous device types, stealthier and more sophisticated command and control channels, as well as other malicious capabilities beyond DDoS.

Furthermore, as data presented in Section 5 suggest, the current population of trivially vulnerable embedded devices is quite high. Therefore, the next generation of malcode capable of compromising heterogeneous device types will easily be able to infect significantly more devices than psyb0t and Kaiten.c in their current state.

## 3. Experimental Methodology
The default credential scanner is designed to quickly sweep large portions of the internet. Each scan takes approximately four weeks and involves two or three sweeps of the entire monitored IP space (Section 3.4 discusses how the monitored IP ranges are selected).

Multiple sweeps across the same IP space are desirable for two reasons. First, embedded devices on residential networks have unpredictable availability. Therefore, multiple sweeps increase the scanner’s probability of observing a vulnerable device when it is connected to the network. Second, multiple sweeps across the same address space over months and years allow us to conduct a longitudinal study on the vulnerability rates of embedded devices around the world. In Section 5, we present the results of our latest scan, containing over 540,000 observed vulnerable devices, as well as analysis of preliminary data gathered by tracking approximately 102,000 vulnerable embedded devices over a span of four months. This is an ongoing study, and we plan to publish the results of a detailed longitudinal study over the next year when the data becomes available.

### 3.1 Threat Model
For the sake of establishing a lower bound on the state of embedded device insecurity in the wild, we assume the role of the least sophisticated malicious attacker. The attacker has unrestricted access to the internet but is unable to exploit any vulnerabilities found on any devices. Instead, the attacker has access to the network scanner nmap and a list of well-known factory default root credentials for popular network embedded devices.

For the remainder of the paper, we define a vulnerable device as any device that is reachable on the internet and allows the attacker to gain root privileges by using factory default credentials.

### 3.2 Default Credential Scanner: A Three-Phase Process
The default credential scan process is straightforward and consists of three phases: discovery, authentication, and logging. During the discovery phase, the scanner identifies active devices on the network. In the authentication phase, the scanner attempts to log in to each device using a list of well-known default credentials. Finally, in the logging phase, the scanner records the details of successful logins, including the device type, IP address, and the default credentials used.