1 − s−α+1
1 − N−α+1 = 1.
(∗∗)
For α = 1 (Zipf distribution) M(s) = ln s/ ln N.
We derive an approximate solution to F (s) + M(s) = 1, or F (s) = 1 −
f, M(s) = f, by dropping N−α from F (cid:4)s denominator. Zipf’s 80/20 split is at
N ≈ 3000 (e8), s ≈ 5 (e1.6) and 90/10 at N = 1010, s = 10. The 80/20 rule may
thus have its origin in the Zipf distribution with a ratio of 3000 from highest to
lowest value. It may well resemble the bitrate consumption disparity found in
most ISPs; only a few of them oﬀer a wider range of bitrates (for example, 3.5
orders covers DSL at 512 Kbps to OC-48 at 2.5 Gbps).
When α > 1, Equation (**) reduces to sα = s + 1 for large N; for α = 2 this
again produces a golden section split of 62/38. In general, as α grows, the split
evens out since large sizes become less likely.
√
More extreme splits than 90/10 only occur for Zipf when N exceeds the
current typical traﬃc range (e.g., 95/5 requires N = 1026), but Pareto with
α outside the conventional interval α ≥ 1 ([18]) can produce these splits for
moderate sizes of N. For α = 0.5, for example, Equation (**) holds whenever
N, resulting in a 90/10 split at N ≈ 6600(e8.8), s ≈ 90, and 95/5 at
s =
N ≈ 133, 000(e11.8), s ≈ 365. Section 4 conﬁrms these results.
4 Also known as golden ratio or divine proportion [17].
118
A. Broido et al.
Table 1. Bulk sizes of OC-48 and OC-12 datasets
Day Start Dur
Dir Src.IP Dst.IP
Set Bb Date
Flows Packets Bytes
D04N 1 2002-08-14 Wed 09:00 8 h Nbd (0) 2124 K 4074 K 106.6 M 2144 M 1269 G
D04S 1 2002-08-14 Wed 09:00 8 h Sbd (1) 1122 K 12661 K 193.8 M 3308 M 2140 G
D05I U 2002-08-14 Wed 08:22 13 h Inbd (1) 961 K 11183 K 37.6 M 538 M 326 G
D05O U 2002-08-14 Wed 08:20 16 h Obd (0) 25.6 K 1412 K 22.0 M 549 M 249 G
D08N 1 2003-05-07 Wed 00:00 48 h Nbd (0) 3902 K 8035 K 275.5 M 4241 M 2295 G
D09N 2 2003-05-07 Wed 10:00 2 h Nbd (1) 904 K 2992 K 56.7 M 930.4 M 603 G
D09S 2 2003-05-07 Wed 10:00 2 h Sbd (0) 466 K 2527 K 47.3 M 624.2 M 340 G
Table 2. Rates and size ratios for OC-48/OC-12 datasets. New sources, destinations
and ﬂows per second are bulk averages over the whole trace (in units of 1000/sec).
Trace Sr/s Ds/s Fl/s kpps Mbps Ut.%
74
14.2
D04N
39
D04S
23.9
9.2
D05I
21
5.6
D05O 0.44
D08N
23
4.3
D09N 126
26.9
D09S
65
15.2
141 3700
74
440 6730 115
12
245 821
25 381
10
47 1594
25
415 7881 129
351 6566
87
352
594
57
35
106
671
378
Fl/Sr Fl/Ds Pk/Fl Pk/Ds Bt/Fl Bt/Pk
592
647
605
454
541
649
545
526 11906
261 11041
48 8668
389 11347
528 8331
311 10635
247 7193
50
173
39
857
71
63
101
26
15
3
16
34
19
19
20
17
14
25
15
16
13
4 Diversity and Disparity in High-Speed Traﬃc
Data sources. We use four longest datasets from our Backbone Traﬃc Data Kit
(Tab. 1): D04, D05, D08 and D09.
The data in D04, D08, D09 was collected by OC-48 monitors using DAG 4
cards from U.Waikato/Endace [7] on Linux platform. D04 contains 8 hours of
OC-48 traﬃc at up to 28.5% utilization (over 1 sec intervals)) taken at Tier 1
Backbone 1 (BB1) in August 2002. D08 and D09 were captured in May 2003.
D08 covers 48 hours of Backbone 1 traﬃc from the same link as D04, albeit at
lower utilization. (Only the northbound direction was captured.) D09 contains
2 hours (overlapping with D08) at up to 30.6% OC-48 utilization taken in Tier
1 Backbone 2 (BB2). Backbone links connect San Jose in the south to Seattle
in the north. BB1 and BB2 use Packet over Sonet (POS). BB2 also prepends
80% packets with 4-byte MPLS headers (fewer than 50 distinct labels used on
each direction; always one label in a stack.) Both encapsulations result in a small
reduction of available Sonet payload.5
D05 was collected on an OC-12 (622 Mbps) ATM link that carries traﬃc
between a university and the Internet. We label link directions by prevalence
of inbound (I) and outbound (O) traﬃc, although due to multihoming each
direction carries both. D05 is taken on the same day as D04. All traces are
5 The reduction depends on average packet size and the extent of HDLC byte stuﬃng
[19]. Knowing these factors is essential for precise bitrate estimates. Utilizations here
and in Table 2 give IP packet volume divided by Sonet raw bitrate of 2488.32 Mbps.
Their Share: Diversity and Disparity in IP Traﬃc
119
d
-
s
k
,
l
f
k
1000
,
s
p
p
k
,
s
p
b
M
100
1000
100
d
-
s
k
,
l
f
k
1000
9
10
11
12
13
14
15
16
17
10
10.5
11
11.5
12
,
s
p
p
k
,
s
p
b
M
100
1000
100
Mbps
kfl/64s
ks-d/64
kpps
9
10
11
13
12
14
Time, hours PDT
15
16
17
10
10.5
11
11.5
12
Time, hours PDT
Fig. 2. Traﬃc rates (64 sec intervals) D04N (left), D09N (right). Byte and packet
counts are expressed in Mbps, kpps respectively as per-second averages.
captured in the middle of the week around noon. We used CoralReef [13] and
other CAIDA programs for data processing.
The raw diversity of our data is high. Traces diﬀer by utilization, traﬃc
symmetry, and temporal dependencies. In Figure 2 each panel shows the number
of bytes, ﬂows, source-destination pairs and packets. The remarkable stationarity
of the traces with respect to baselines (major bursts are rare) means that volume
distributions of these traces are convincing from a stochastic viewpoint.
An interesting property of traces D04 and D09 is equality between orders of
magnitude for bitrate (Mbps) and the number of ﬂows active per (64-sec) interval
(a ﬂow over 64 sec translates to 1 kbps of average bitrate). The maximum value
of ﬂows/second is 48702 for D04S and 20778 for (similarly utilized) D09N (the
discrepancy is due to attacks in D04, see below). The maximum number of
source-destination pairs is 24310 for D04S (no major attack at this second) and
15531 for D09N. For 64s intervals the maximum numbers of ﬂows is 1.71M for
D04S (peak of 220K IP pairs) and 719K ﬂows (peak of 435K IP pairs) for D09N.
In addition, D08 and D05 have diurnal variation with a factor of 2-6X.
Another interesting property of our datasets is the almost constant average
bytes/ﬂow. Table 2 consistently shows it at around 10 kbytes. Packets/ﬂow,
packets/destination, and bytes/packet are also of the same order of magnitude
for most traces. The only exception is the inbound university trace D05I, skewed
by backscatter [20], scans and other traﬃc debris attracted to a large address
block.6 We plan to report in future whether and to what extent these ratios are
invariant in high-speed IP traﬃc.
Preﬁx/AS diversity. The diversity of preﬁxes and ASes in our data is also
high. Taken together, sources and destinations on both directions of each link
cover 30-55% of RouteViews (semiglobal [22]) preﬁxes and 42-62% ASes. How-
ever, disparity of coverage between directions can be high, e.g., in D09 the
northern side of the link has only data from/to 1.5-4% of preﬁxes and ASes.
6 Our full analysis [21] skips all traﬃc directed to that block.
120
A. Broido et al.
Fig. 3. a) Bursts in destination arrival rates, D04 b) Flows, packet and byte densities
in duration space for two timeouts
Another interesting property is the symmetry in coverage disparity. The number
of sources on one direction of a link is of the same order of magnitude as the
number of destinations on the other, even though these sources and destinations
do not necessarily match each other.
Extreme disparity. Packet ﬂoods, DDoS attacks and IP address and port
scan are usually viewed as traﬃc anomalies. However, each trace in our study
(indeed, almost any wide-area Internet trace) contains examples of all these
phenomena. This observation renders ‘anomalies’ normal in highly multiplexed
traﬃc (cf. similar observations for backscatter data [20]). We view them as cases
of extreme size disparity at particular aggregation levels.
In particular, ﬂoods are typically aimed at overwhelming the capabilities of
the receiving machine at the other end, e.g. OS interrupt processing. To reach
that goal, lots of small packets are sent. As a result, packet rate increases without
proportional growth in utilization; cf. curve in the upper left plate of Figure 2.
DDoS attacks represent a particular type of ﬂood; two such attacks appear
present on southbound D04 (Figure 2 lower left). The source addresses sweep
the whole /16 address blocks of an academic network in Asia; the destination
addresses point to hosts on consumer networks in US and Turkey. Note that
the excursions at the ﬂow aggregation level are missing on the level of source-
destination pairs (because of the restriction to /16s), while more aggressive ad-
dress spooﬁng would transpire to that level as well. These attacks also change
packet rates (bottom curve), but to a much smaller extent.
Another type of disparity derives from IP address and port scans done
(among others) by viruses and hackers. This activity appears as a large number
of source-destination pairs (address scans) or ﬂows (port and address scans).
Figure 3 shows multiple bursts in new source-destination pairs per minute due
to repetitive scans going north. Scans may be present in the D09, Fig.2 (right).
Figure 5 (upper left) indicates a large number of destination IP addresses with
small (40-200 bytes) traﬃc volume, concentrated at a few small packet sizes, 40,
40+40, 3*48 bytes, many of which reﬂect SYN probes from scanning tools. Half of
Their Share: Diversity and Disparity in IP Traﬃc
121
1
0.1
)
f
d
c
c
(
s
e
S
A
%
0.01
0.001
Backbone 1 2002-08-14, northbound
dst, exp(-(x/3e7)^0.28)
src, 400 x^-0.5
1
0.1
)
f