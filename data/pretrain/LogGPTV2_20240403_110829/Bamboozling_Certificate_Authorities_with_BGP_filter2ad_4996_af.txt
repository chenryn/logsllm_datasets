and Management of Publicly-Trusted Certiﬁcates, v.1.5.4, Oct
2017.
[19] COWIE, J. China’s 18-minute mystery — Dyn blog. https://
dyn.com/blog/chinas-18-minute-mystery/, Nov 2010.
[20] DURUMERIC, Z., KASTEN, J., BAILEY, M., AND HALDER-
MAN, J. A. Analysis of the HTTPS certiﬁcate ecosystem.
In
Internet Measurement Conference (New York, NY, USA, 2013),
IMC ’13, ACM, pp. 291–304.
846    27th USENIX Security Symposium
USENIX Association
[21] GAO, L., AND REXFORD, J. Stable Internet routing without
IEEE/ACM Transactions on Networking
global coordination.
(TON) 9, 6 (2001), 681–692.
[40] SCHLINKER, B., ZARIFIS, K., CUNHA, I., FEAMSTER, N.,
AND KATZ-BASSETT, E. Peering: An AS for us. In ACM Work-
shop on Hot Topics in Networks (2014), ACM, p. 18.
[22] GAVRICHENKOV, A. Breaking HTTPS with BGP hijacking.
Black Hat USA Brieﬁngs (2015).
[23] GILAD, Y., COHEN, A., HERZBERG, A., SCHAPIRA, M., AND
SHULMAN, H. Are we there yet? on RPKI’s deployment and
security.
[24] GREENBERG, A. How an unprecedented heist hijacked a bank’s
entire online operation. https://www.wired.com/2017/04/
hackers-hijacked-banks-entire-online-operation/,
Jun 2017.
[25] HOFFMAN, P., AND SCHLYTER, J. The DNS-based authenti-
cation of named entities (DANE) transport layer security (TLS)
protocol: TLSA. RFC 6698, RFC Editor, August 2012. http:
//www.rfc-editor.org/rfc/rfc6698.txt.
[26] HU, X., AND MAO, Z. M. Accurate real-time identiﬁcation of
IP preﬁx hijacking. In IEEE Symposium on Security and Privacy
(SP) (May 2007), pp. 3–17.
[27] HUSTON, G. Nopeer community for border gateway protocol
(BGP) route scope control. RFC 3765, RFC Editor, April 2004.
[28] KARLIN, J., FORREST, S., AND REXFORD, J. Autonomous
security for autonomous systems. Computer Networks 52, 15
(2008), 2908–2923.
[41] SERMPEZIS, P., KOTRONIS, V., DAINOTTI, A., AND DIM-
ITROPOULOS, X. A survey among network operators on BGP
preﬁx hijacking. SIGCOMM Comput. Commun. Rev. 48, 1 (Apr.
2018), 64–69.
[42] SHI, X., XIANG, Y., WANG, Z., YIN, X., AND WU, J. De-
tecting preﬁx hijackings in the Internet with Argus. In Internet
Measurement Conference (New York, NY, USA, 2012), IMC ’12,
ACM, pp. 15–28.
[43] SUN, Y., EDMUNDSON, A., FEAMSTER, N., CHIANG, M.,
AND MITTAL, P. Counter-raptor: Safeguarding tor against ac-
tive routing attacks. In IEEE Symposium on Security and Privacy
(SP) (May 2017), pp. 977–992.
[44] SUN, Y., EDMUNDSON, A., VANBEVER, L., LI, O., REXFORD,
J., CHIANG, M., AND MITTAL, P. Raptor: Routing attacks on
privacy in Tor. In USENIX Security Symposium (2015), pp. 271–
286.
[45] TODOROVIC, B. BGP spooﬁng in the episode: Stealing your
(cc)TLD. NANOG-45, Santo Domingo, January (2009).
[46] TRAMMELL, B. RAINS (Another Internet Naming Service) Pro-
tocol Speciﬁcation. Internet-Draft draft-trammell-rains-protocol-
03, Internet Engineering Task Force, Sept. 2017. Work in
Progress.
[29] KRUEGEL, C., MUTZ, D., ROBERTSON, W., AND VALEUR,
F. Topology-based detection of anomalous BGP messages. In
Symposium on Recent Advances in Intrusion Detection (RAID)
(2003), pp. 17–35.
[47] WENDLANDT, D., ANDERSEN, D. G., AND PERRIG, A. Per-
spectives: Improving ssh-style host authentication with multi-
path probing. In USENIX Annual Technical Conference (2008),
vol. 8, pp. 321–334.
[30] LAD, M., MASSEY, D., PEI, D., WU, Y., ZHANG, B., AND
In USENIX
ZHANG, L. PHAS: A preﬁx hijack alert system.
Security Symposium (2006), vol. 1, p. 3.
[31] LAD, M., OLIVEIRA, R., ZHANG, B., AND ZHANG, L. Un-
derstanding resiliency of Internet topology against preﬁx hijack
attacks. In IEEE/IFIP Conference on Dependable Systems and
Networks (2007), IEEE, pp. 368–377.
[32] LANGLEY, A., KASPER, E., AND LAURIE, B. Certiﬁcate Trans-
parency. RFC 6962, RFC Editor, June 2013.
[33] LEPINSKI, M., AND SRIRAM, K. BGPsec protocol speciﬁcation.
RFC 8205, RFC Editor, September 2017.
[34] LONE, Q., LUCKIE, M., KORCZY ´NSKI, M., AND VAN EETEN,
M. Using loops observed in traceroute to infer the ability to
In International Conference on Passive and Active Net-
spoof.
work Measurement (2017), Springer, pp. 229–241.
[35] LYCHEV, R., GOLDBERG, S., AND SCHAPIRA, M. BGP secu-
In
rity in partial deployment: Is the juice worth the squeeze?
ACM SIGCOMM (New York, NY, USA, 2013), pp. 171–182.
[36] MADORY, D.
Use protection if peering promiscuously.
https://dyn.com/blog/use-protection-if-peering-
promiscuously/, Nov 2014.
[37] MCCARNEY, D. Validating challenges from multiple network
https://community.letsencrypt.org/
vantage points.
t/validating-challenges-from-multiple-network-
vantage-points/40955, Aug 2017.
[38] ORSINI, C., KING, A., GIORDANO, D., GIOTSAS, V., AND
DAINOTTI, A. BGPStream: A software framework for live and
historical BGP data analysis. In ACM on Internet Measurement
Conference (2016), ACM, pp. 429–444.
[39] PILOSOV, A., AND KAPELA, T. Stealing the Internet: An
Internet-scale man in the middle attack. NANOG-44, Los An-
geles, October (2008), 12–15.
[48] ZHANG, X., HSIAO, H. C., HASKER, G., CHAN, H., PERRIG,
A., AND ANDERSEN, D. G. Scion: Scalability, control, and
In IEEE Symposium on
isolation on next-generation networks.
Security and Privacy (SP) (May 2011), pp. 212–227.
[49] ZHAO, X., PEI, D., WANG, L., MASSEY, D., MANKIN, A.,
WU, S. F., AND ZHANG, L. An analysis of BGP multiple origin
AS (MOAS) conﬂicts. In ACM SIGCOMM Workshop on Inter-
net Measurement (New York, NY, USA, 2001), IMW ’01, ACM,
pp. 31–35.
A Appendix: Additional Attacks
Below are attacks we were unable to perform on the PKI
but could still be used by certain strategically positioned
adversaries to gain bogus certiﬁcates with a high degree
of stealthiness.
Intentional Route Leak
A.1
An attack that follows naturally from Table 1 is the in-
tentional route leak, where the adversary prepends the
AS path to the victim (as in the AS path poisoning at-
tack) and announces equally-speciﬁc preﬁx. This attack
is very stealthy because the adversary is in effect only
improperly propagating a legitimate announcement it has
heard from one of its neighbors. Such route leaks are rel-
atively common because of misconﬁgurations [36] [7].
However, while seemingly innocuous, a route leak can
route vital trafﬁc through an adversary that could be used
to gain a bogus certiﬁcate.
USENIX Association
27th USENIX Security Symposium    847
Intentional route leaks are not viable in many situa-
tions even when several CAs can be targeted. The ad-
versary’s route announcement must have the entire route
to the victim prepended and is for the same preﬁx an-
nounced by the victim. Thus, many ASes will prefer
the victim’s original announcement to the adversary’s an-
nouncement due to the long AS path in the adversary’s
announcement. However, these attacks are effective at
capturing trafﬁc in a localized portion of the Internet
topology, and if an adversary is very topologically close
to a CA (or happens to have favorable business relations)
the attack is viable.
The viability of this attack increases signiﬁcantly if we
assume an adversary has complete administrative con-
trol of an AS (as opposed to only the technical ability
to make announcements). If so, an adversary could real-
istically approach a victim’s ISP and request to become
peers with that ISP. In this way, the adversary has favor-
ably changed the Internet topology to make the attack
more viable. To illustrate this, let us consider ViaWest
(Let’s Encrypt’s ISP). Peers of ViaWest are in a prime po-
sition to launch an intentional route leak. ViaWest would
likely prefer a route from a peer over a provider route
even if the AS path was longer in the peer route allowing
these peers to launch an intentional route leak.
In ad-
dition, this route leak would not be globally visible and
would only inﬂuence ViaWest and its clients. While only
24 ASes are currently seen peering with ViaWest (peer-
ing links are also the hardest BGP relations to detect so
24 may be an underestimate), ViaWest has a Point Of
Presence (POP) at the Seattle Internet Exchange (SIX)
and is colocated with 283 other ASes. ViaWest also has
an open peering policy, meaning that proposals to estab-
lish peering sessions with ViaWest are welcome and eas-
ily accepted. From this point of view, all 283 ASes at
the Seattle Internet Exchange are in a good position to
launch an intentional route leak. This trend is commonly
seen with several top CAs that operate out of large data
centers. Data centers often have open peering policies
and POPs at many Internet exchanges to reduce latency
and transit costs. However, this makes data centers prime
targets for such topology manipulation. We believe this
creation of peering links to change the Internet topology
in an adversary’s favor merits further study that uses both
network analysis and studies of business practices to un-
derstand and counter this vulnerability.
We were not able to launch an intentional route leak
because of guidelines imposed by the peering framework
on the number ASes that can be prepended to an an-
nouncement. In addition, without administrative control
of the peering framework we were not able to establish
additional peering links that might make such an attack
possible.
A.2 Limited Propagation Attack
Limiting the propagation of a malicious BGP announce-
ment by announcing only to a peer AS as opposed to a
provider can help an adversary to maintain as much con-
nectivity as possible and reduce the control plane notice-
ability. To perform this attack we launched a sub-preﬁx
hijack attack from the mux at the Amsterdam Internet
Exchange but made the announcement only to the peer
Hurricane Electric.9
We then ran our own non-trusted CA in a network that
was a customer of Hurricane Electric. Using the NTT
looking glass and our mux in the Los Nettos Regional
Network, we conﬁrmed that the adversary’s announce-
ment had not propagated globally (e.g.
to NTT’s net-
work) and instead had only propagated to the customers
of Hurricane Electric (e.g. the Los Nettos Regional Net-
work). We requested a certiﬁcate from our non-trusted
CA and obtained one without modifying the victim’s
server. We repeated a similar variation of this experiment
but announced the route to peer AS 8075 (Microsoft) as
opposed to Hurricane Electric (we also moved our CA
into AS 8075 so it would not be affected by the hijack).
While using Microsoft instead of Hurricane Electric is
not a signiﬁcant difference from a BGP perspective, it
makes the attack signiﬁcantly more stealthy for an ad-
versary. While Hurricane Electric has many client ASes
that could easily detect the attack, Microsoft has only 10
customer ASes that are all under Microsoft’s administra-
tive control. Thus, this announcement to Microsoft has
such limited propagation that a vantage point within Mi-
crosoft’s network is needed for the attack to be detected.
While we used a non-trusted CA for this experiment,
it would still be reasonable for an adversary to launch
this attack against a trusted CA given: 1) a broader se-
lection of CAs than we explored and 2) the ability of an
adversary to construct peering connections with poten-
tial target ASes. In the version of this experiment using
Hurricane Electric, it would have been reasonable to ﬁnd
a CA with Hurricane Electric as a provider. While we
did not ﬁnd any CAs located in Microsoft data centers,
we did ﬁnd a CA that used Amazon’s data centers. Had
Amazon instead of Microsoft been a peer available for us
to make an announcement, we would have been able to
gain a trusted certiﬁcate while only propagating a route
to a single organization.
A variant of this attack we did not perform is the use of
BGP communities to limit propagation. It is already un-
derstood that well-known communities such as no-peer
9In order for this experiment to work we moved the victims an-
nouncement from the mux at Los Nettos Regional Network to the mux
in the Greek Research and Technology Network because Hurricane
Electric would prefer the announcement from the Los Nettos Regional
Network (a customer route) over the adversary’s announcement from
the Amsterdam Internet Exchange (a peer route).
848    27th USENIX Security Symposium
USENIX Association
In this way, the domain owner has the impression of
only receiving one email from the CA, but in fact an arbi-
trarily large number of vantage points were used to send
the email.
and no-export can make BGP attacks harder to detect
by limiting propagation [27]. However, in the case of
the PKI, these mechanisms for limiting propagation are
more relevant as an adversary’s choice of CA increases
the likelihood that the CA will be topologically close to
the adversary. Thus, methods for limiting propagation
are more likely to be applicable in such situations.
Similar to the intentional route leak, an adversary
could reasonably perform a limited propagation attack
given the ability to establish peering links with target
ASes.
B Appendix:
Using Multiple Vantage
Points for Email
The aforementioned multiple vantage point veriﬁcation
works well for HTTP veriﬁcation and DNS TXT veriﬁ-
cation that rely on checking the existence of given data in
a domain’s infrastructure. However, some CAs also use
email veriﬁcation, which is based on proving that a user
can read data sent to a domain.
Challenges in email veriﬁcation. A naive imple-
mentation of the multiple vantage point veriﬁcation for
emails would be to have multiple locations on the Inter-
net send emails and have the users prove that they re-
ceived all of the emails. However, this is a manual form
of domain control veriﬁcation where a real human user
is expected to read the emails from the CA and take ac-
tions accordingly. Having the users read and respond to
multiple identical emails from the vantage points is not
practical.
Our proposed email veriﬁcation. To address the
above concern, we propose a system where a single email
can be sent from multiple locations on the Internet. We
assume the CA has set up secure VPN tunnels with the
vantage points. The steps are as follows.
1. The CA breaks up the secret information that needs
the domain owner’s action (e.g. veriﬁcation URL)
into several pieces so that there is at least one piece
for each vantage point.
2. The CA’s mail server sends the ﬁrst piece of the se-
cret via email to the domain’s mail server.
3. Upon receiving the TCP ACKs from the domain’s
mail server, the CA reconﬁgures its routing pol-
icy to route the email trafﬁc through the ﬁrst van-
tage point via the VPN tunnel, and sends the second
piece of the secret to this vantage point.
4. Upon receiving the TCP ACKs via the ﬁrst vantage
point, the CA repeats the above step using the next
vantage point, etc., until all the pieces of secret have
been sent.
USENIX Association
27th USENIX Security Symposium    849