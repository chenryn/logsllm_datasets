TLP:CLEAR
INCIDENT RESPONSE METHODOLOGY
IRM #9
MALWARE ON
SMARTPHONE
How to handle a suspicious
smartphone
IRM Author: CERT SG
Contributor: CERT aDvens
IRM version: 2.0
E-Mail: PI:EMAIL
Web: https://cert.societegenerale.com
Twitter: @CertSG
TLP:CLEAR
TLP:CLEAR
ABSTRACT
This Incident Response Methodology is a cheat sheet dedicated to handlers investigating on a
precisesecurityissue.
WHOSHOULDUSEIRMSHEETS?
 Administrators
 SecurityOperationCenter
 CISOsanddeputies
 CERTs(ComputerEmergencyResponseTeam)
Remember: If you face an incident, follow IRM, take notes. Keep calm and contact your
businessline’sIncidentResponseteamorCERTimmediatelyifneeded.
→IRMCERTSG:https://github.com/certsocietegenerale/IRM
→IRMCERTaDvens(Frenchversion):https://github.com/cert-advens/IRM
IRM #9 MALWARE ON SMARTPHONE
2
TLP:CLEAR
TLP:CLEAR
INCIDENT HANDLING STEPS
6 STEPS ARE DEFINED TO HANDLE SECURITY INCIDENTS
1. Preparation: get ready to handle the incident
2. Identification: detect the incident
3. Containment: limit the impact of the incident
4. Remediation: remove the threat
5. Recovery: recover to a normal stage
6. Lessons learned: draw up and improve the process
IRM provides detailed information for each stepof the incident response process.The steps
come from NIST Computer Security Incident Handling Guide.
IRM #9 MALWARE ON SMARTPHONE
3
TLP:CLEAR
TLP:CLEAR
PREPARATION
OBJECTIVE: ESTABLISH CONTACTS, DEFINE PROCEDURES, GATHER INFORMATION TO SAVE
TIMEDURINGANINCIDENT.
Mobile helpdesk must have a defined process in case of a suspected malware infection: replace the
smartphone of the user with a new one and isolate the suspicious device for analysis by the forensic
investigator.
Agoodknowledgeoftheusualactivityofthesmartphoneisappreciated(defaultandextratoolsrunning
onit).Asmartphonesupportexpertcanbehelpfultoassisttheforensicinvestigator.
Itisrecommendedto:
▪ Enablelogging(MDM,applicationslistorelse)
▪ InstallAntivirus/Securityappsoversmartphone
▪ ConfigureaVPNtoanalyzenetworkactivity
ForForensic:
▪ ForAndroid:
o ActivateDeveloperoptionswithUSBDebugging(becarefulitcouldbearisk,publicUSBcharging
facilitiesforexample)orhaveaprocesstoactivateit
o UnlockOEMoptionsifpossible
▪ Testyourextractionroutinesinadvancetomakesuretheyarecompatiblewithyourevidence
IRM #9 MALWARE ON SMARTPHONE
4
TLP:CLEAR
TLP:CLEAR
IDENTIFICATION
OBJECTIVE: DETECT THE INCIDENT, DETERMINE ITS SCOPE, AND INVOLVE THE
APPROPRIATEPARTIES.
Mainpointsofnotificationforsuspicioussmartphone:
▪ Antivirus/Securityappsraisealerts
▪ Checkforanomalousrightsgrantedtoapplications
▪ Anomaloussystemactivity,unusuallyslowfunctioning
▪ Anomalousnetworkactivity,slowInternetconnection
▪ Thesystemrebootsorshutdownswithoutreason
▪ Applicationscrashunexpectedly
▪ User receives one or multiple messages, containing unusual characters (SMS, MMS, Bluetooth
messages,etc.)
▪ Increaseinphonebillorwebactivity
▪ Callstounknownphonenumbersoratunusualhours/days
▪ Amonitoringshouldbedonetocheckunusualuserbillornetworkactivity
Ask the user about his/her usual activity on the smartphone: which websites usually
visited,whichexternalapplicationsareinstalled.
IRM #9 MALWARE ON SMARTPHONE
5
TLP:CLEAR
TLP:CLEAR
CONTAINMENT
OBJECTIVE: MITIGATE THE ATTACK’S IMPACTS ON THE TARGETED ENVIRONMENT.
Asktheusertoprovidehis/hercredentialstoaccessthesmartphoneincluding:
▪ SIMcardPINcode
▪ Smartphonepassword
▪ iCloudlogin/password
▪ GooglePlaycredentials,
▪ backuppassword…
▪ Ensuretheuserisprovidedwithareplacementdevicetouseduringtheinvestigation.
▪ Backupthesmartphonedatabycreatingaphysicalfilesystem,logicalbackupormanualacquisition.
▪ Putthephoneinafaradaybagifavailable.
Afteracquisition,removethebattery(iffeasible)orputthephoneintheairplanemodeto
blockallactivity(WiFi,Bluetooth,etc).
Additionalactions:
▪ RemovetheSIMtoperformadditionalanalysisoutsidethesmartphone.
▪ Performanantivirusorsecurityscanofthebackuporacquiredfilesonadedicatedforensicstation.
▪ Performapplicableforensicroutinebaseonyourusecase.
Specific tools should be used by your incident response team tolead forensic investigation on
thesmartphone.
Use a dedicated forensic solution to analyze the captured data or the smartphone
(Cellebrite,XRY,Oxygen,Axiom,Andriller,etc.)
IRM #9 MALWARE ON SMARTPHONE
6
TLP:CLEAR
TLP:CLEAR
REMEDIATION
OBJECTIVE:TAKEACTIONSTOREMOVETHETHREATANDAVOIDFUTUREINCIDENTS.
▪ Removetheidentifiedthreatfromthesmartphone.
Or
▪ WipetheinfectedsmartphoneandHard/Softresetittofactorysettingswithapristinefirmware.
▪ ReinserttheSIMcardbackintothesmartphone.
Signal all identified malicious applications still available through marketplaces for
removal.
IRM #9 MALWARE ON SMARTPHONE
7
TLP:CLEAR
TLP:CLEAR
RECOVERY
OBJECTIVE: RESTORE THE SYSTEM TO NORMAL OPERATIONS.
▪ Selectivelyreinstallsaveddataandappsfromthebackup.
You may consider retaining the device for an additional quarantine period to perform
appropriatesecuritychecks.
Formoredetailsonauthenticationandinfrastructurerecovery,checktheLarge-scalemalwarecompromiseIRMXXX
IRM #9 MALWARE ON SMARTPHONE
8
TLP:CLEAR
TLP:CLEAR
LESSONS LEARNED
OBJECTIVE: DOCUMENT THE INCIDENT’S DETAILS, DISCUSS LESSONS LEARNED, AND
ADJUSTPLANSANDDEFENSES.
Report
Anincidentreportshouldbewrittenandmadeavailabletoalloftheactorsoftheincident.
Followingthemesshouldbedescribed:
▪ Initialdetection
▪ Actionsandtimelines
▪ Whatwentright
▪ Whatwentwrong
▪ Incidentcost
▪ Indicatorsofcompromise
Capitalize
Actionstoimprovethesmartphonepolicyshouldbedefinedtocapitalizeonthisexperience.
Debrieftheincidentwithusertoimprovehis/herawareness.
IRM #9 MALWARE ON SMARTPHONE
9
TLP:CLEAR