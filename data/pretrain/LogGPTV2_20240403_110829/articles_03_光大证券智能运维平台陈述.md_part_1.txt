### 基于机器学习与大数据的智能运维平台
**作者：孙伟**

#### 项目背景与历程
随着业务创新的快速发展，技术系统需要快速响应更高的需求。然而，频繁的系统升级和日益复杂的系统交互关系给系统的安全稳定运行带来了巨大挑战。2016年，Gartner提出了AIOps（智能运维）的概念，即结合机器学习算法和运维大数据来解决这些问题。

#### 项目启动
2017年，我们升级了监管控运维工具和大数据平台，并启动了智能运维平台的建设。鉴于证券行业对系统可用性和连续性的极高要求，结合光大证券现有的运维系统建设情况，我们选择了异常发现、故障定位以及故障处置作为智能运维建设的主要路径。

#### 项目落地
2018年至2019年间，光大证券运维专家团队与清华大学NetMan实验室及日志易团队合作，取得了显著成果，包括：
- 荣获上交所优秀论文奖
- 获得IDC最佳创新案例奖
- 赢得云鹰最高成就奖

#### 项目目标
1. **赋能监管控运维体系**：提升运维效率和系统可用性，改善恢复时间目标（RTO），降低平均修复时间（MTTR），从而提高用户体验。
2. **持续建设**：引入成熟可控的开源组件和技术，降低运维系统的建设成本，深化故障定位场景，完善智能运维体系。
3. **探索可复制的智能运维体系建设实施路径**：为金融行业提供可以落地、可复制的智能运维体系建设方法。

#### 建设场景综述
智能运维平台融合了多源异构的海量监控数据，如关键性能指标（KPI）、日志、调用链、告警等。通过机器学习算法对这些数据进行关联分析和异常检测，实现异常的及时发现和快速定位。

##### 异常检测
- **响应率低**
- **应用报错**
- **通讯失败**
- **版本BUG**
- **网络问题**
- **主机问题**
- **根源系统**
- **根源机器**
- **响应变慢**
- **后台问题**
- **组件问题**

##### 多维定位
- **业务指标**
- **应用日志**
- **错误码**
- **客户端版本**
- **网段**
- **主机IP**

##### 数据处理
- **异常检测**
- **多维定位**
- **调用链分析**

#### 运维图谱与数据工厂
- **数据库**
- **网络**
- **主机**
- **存储**
- **事件**
- **指标**
- **日志**
- **告警**
- **工单**

##### 具体问题示例
- **活跃会话数高**
- **PING不通**
- **CPU负载高**
- **IOPS速率异常**
- **变更**
- **表空间不足**
- **端口闪断**
- **内存即将打满**
- **关键字报错**
- **重启**
- **数据库宕机**
- **网络流量异常**
- **主机HANG**
- **...**

#### 业务指标异常检测
- **专注于关键业务指标**：衡量业务系统的健康状态，如成功率、响应率、响应时间和调用次数等。
- **无监督学习算法**：无需人工标注，自动识别数据特征并选择最适合的检测算法，基于历史数据进行模型训练，实现实时异常检测。

#### 日志异常检测
- **自然语言处理技术**：实现原始日志的智能化模板提取和变量解析，进而对日志数据进行异常检测。
- **模板识别**：将非结构化日志转换为结构化模板，通过算法学习和规则调整，生成告警信息。
- **生产应用**：已接入业务日志、应用模块运行日志、数据库与操作系统日志，每天处理约500G的日志量。

#### 业务明细多维定位
- **问题定义**：当某个关键业务系统的黄金指标出现异常时，从交易明细中快速准确定位到导致指标异常的交易维度。
- **多维组合**：通过蒙特卡洛树搜索等算法，基于嫌疑程度进行层次化的异常检测。

通过以上措施，我们的智能运维平台能够有效提升系统的可用性和稳定性，为业务创新提供坚实的技术支持。