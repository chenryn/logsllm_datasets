# Malware in IEEE 802.11 Wireless Networks

## 4.1 Impact of Malware on Network Performance

During the observed attacks, nearly 50% of all packets were retransmissions. As clients followed the ARF (Automatic Rate Fallback) procedure and reduced their transmission rates, the channel became even more congested due to longer transmission times. These characteristics significantly impacted TCP delay, as MAC layer delays and losses were misinterpreted as end-to-end congestion, leading to TCP transmission timeouts and a reduction in the congestion window.

### TCP SYN Flood Attack
Another notable attack was a TCP SYN flood directed at an external server on Port 80, involving over 6,000 connection requests. The attacker emitted three bursts of traffic starting at 12:59:57 on Thursday, with up to 109 packets per second for 30 seconds.

**Figure 5** illustrates several measurement metrics during this 30-second attack. The peaks in data packet numbers correspond to the attack periods. While the aggregate channel utilization for the access point was elevated, it did not reach bottleneck limits (Figure 5(c)). The most significant impact was on the data retry rate, which peaked during the attack, indicating higher contention and collisions at the MAC layer due to the rapid transmission of single SYN packets. This resulted in an increase in overall end-to-end latency. During the attack, the average Round-Trip Time (RTT) increased by more than 33%, with 16% of all frames being MAC layer retransmissions. At the peak, more than 30% of all frames were data retransmissions.

Additionally, the number of probe requests and responses to and from all access points increased during the initial attack (Figures 5(b) and 5(d)), suggesting that the attacker may have exacerbated existing hidden terminal problems, causing more collisions and data retries. This behavior triggered nearby clients to start probing for other access points with better connectivity. Although these effects were not catastrophic, the number of probe responses and data retries more than doubled compared to regular traffic intervals. Similar to the ICMP ping flood, the number of probe responses more than doubled immediately after the attack, responding to partially blocked probe requests during the attack interval.

## 4.2 Effects of Malicious Flows on Wireless Performance

Our findings indicate that active malware in a congested wireless network harms performance by reducing client transmission rates and increasing data retries. The end-to-end delay for TCP connections increases with slower data rates and more packet collisions, which can significantly impact real-time applications. Under heavy utilization, access point management frames can be obstructed, increasing the delay in client handoffs, authentications, and associations, further degrading performance.

By comparing the NetBIOS attack with the TCP SYN flood, we determined that faster sending rates and larger packets have a more significant effect on the wireless medium, as the channel is busy for longer periods. The 802.11 CSMA protocol effectively prevented small TCP SYN packets from dominating the channel during malicious traffic flows.

## 5 Conclusion

The study of malware in wireless systems is becoming increasingly important as more devices communicate openly over-the-air. We analyzed the effects of malware-driven attacks on 802.11 performance, with the most severe consequence being an increase in RTTs, which can hinder real-time communication. Ensuring wireless quality of service requires mechanisms to reduce unwanted link layer contention.

Our results are from single attackers' outgoing malware attacks. If left unchecked, the prevalence of malware will lead to a higher concentration of attackers, potentially denying service to legitimate users. Protecting connected machines is a critical objective for wireless network operators. As worms and botnets become more sophisticated, we expect that the exploitation of wireless networks for mining sensitive information from unencrypted transmissions will become routine. Malware will also adapt to preserve its anonymity by spoofing the source of attacks. The effects of multiple compromised machines on a single wireless access point will become more significant as malware evolves to exploit the wireless medium. Therefore, a lightweight solution is essential to ensure optimal network performance and protect users' sensitive data.

## References

1. Balachandran, A., Voelker, G.M., Bahl, P., Rangan, P.V.: Characterizing User Behavior and Network Performance in a Public Wireless LAN. In: Proc. of ACM SIGMETRICS, Marina Del Rey, CA, June 2002, pp. 195–205 (2002)
2. Chandra, R., Padmanabhan, V., Zhang, M.: WiFiProﬁler: Cooperative Diagnosis in Wireless LANs. In: Proc. of MobiSys, Uppsala, Sweden (June 2006)
3. Chen, Z., Gao, L., Kwiat, K.: Modeling the Spread of Active Worms. In: Proc. of IEEE INFOCOM, San Francisco, CA (April 2003)
4. Cheng, Y., Afanasyev, M., Verkaik, P., Benko, P., Chiang, J., Snoeren, A., Savage, S., Voelker, G., Kwiat, K.: Automating Cross-Layer Diagnosis of Enterprise Wireless Networks. In: Proc. of ACM SIGCOMM, Kyoto, Japan (August 2007)
5. Gu, G., Porras, P., Yegneswaran, V., Fong, M., Lee, W.: BotHunter: Detecting Malware Infection Through IDS-Driven Dialog Correlation. In: Proc. of Usenix Security Symposium, Boston, MA (August 2007)
6. Heusse, M., Rousseau, F., Berger-Sabbatel, G., Duda, A.: Performance Anomaly of 802.11b. In: Proc. of IEEE INFOCOM, San Francisco, CA (March 2003)
7. Jardosh, A., Ramachandran, K., Almeroth, K., Belding-Royer, E.: Understanding Congestion in IEEE 802.11b Wireless Networks. In: Proc. of Internet Measurement Conference, Berkeley, CA (October 2005)
8. Kirda, E., Kruegel, C., Banks, G., Vigna, G., Kemmerer, R.: Behavior-based Spyware Detection. In: Proc. of Usenix Security Symposium, Vancouver, Canada (August 2006)
9. Kotz, D., Essien, K.: Analysis of a Campus-wide Wireless Network. In: Proc. of ACM MOBICOM, Atlanta, GA (September 2002)
10. Meng, X., Wong, S., Yuan, Y., Lu, S.: Characterizing Flows in Large Wireless Data Networks. In: Proc. of ACM MOBICOM, Philadelphia, PA (September 2004)
11. Moore, D., Voelker, G.M., Savage, S.: Inferring Internet Denial-of-Service Activity. In: Proc. of Usenix Security Symposium, Washington D.C (August 2001)
12. Rodrig, M., Reis, C., Mahajan, R., Wetherall, D., Zahorjan, J.: Measurement-based Characterization of 802.11 in a Hotspot Setting. In: Proc. of ACM SIGCOMM Workshop on Experimental Approaches to Wireless Network Design and Analysis (E-WIND), Philadelphia, PA (August 2005)
13. Schwab, D., Bunt, R.: Characterizing the Use of a Campus Wireless Network. In: Proc. of IEEE INFOCOM, Hong Kong, China (March 2004)