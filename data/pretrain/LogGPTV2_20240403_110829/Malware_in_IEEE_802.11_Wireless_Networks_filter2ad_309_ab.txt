r
t
e
R
a
t
a
D
1
0.8
0.6
0.4
0.2
s
p
b
M
4
5
−
8
4
s
v
s
p
b
M
8
1
−
1
1
0
16:53
16:59
17:05
17:11
17:17
17:23
0
16:53
16:59
17:05
17:11
17:17
17:23
(a) Data Retries
(b) 11-18Mbps vs 48-54Mbps
100
80
60
40
20
)
%
(
n
o
i
t
a
z
i
l
i
t
U
l
e
n
n
a
h
C
250
200
150
100
50
s
e
s
n
o
p
s
e
R
e
b
o
r
P
0
16:53
16:59
17:05
17:11
17:17
17:23
0
16:53
16:59
17:05
17:11
17:17
17:23
(c) Channel Utilization
(d) Probe Responses
Fig. 4. ICMP Flood and NetBIOS exploit eﬀects on the wireless medium
Malware in IEEE 802.11 Wireless Networks
229
almost 50% of all packets were retransmissions. In addition, as clients following
the ARF procedure reduced their transmission rates, the channel became even
more congested as transmissions took longer to complete. These characteristics
had a signiﬁcant impact on TCP delay due to the fact that these MAC layer
delays and losses were assumed to be caused by end-to-end congestion. Hence
TCP transmission timeouts occurred, which reduced the congestion window.
TCP SYN Flood. Another one of the more obvious attacks that we observed
was a TCP SYN ﬂood directed at an external server on Port 80 involving over
6,000 connection requests. The attacker in question emitted three bursts of at-
tack traﬃc that began Thursday afternoon at 12:59:57 and numbered up to 109
packets per second for 30 seconds.
Figure 5 combines several of these measurement metrics during the initial
attack, which lasted for only 30 seconds. The peaks in the numbers of data
packets correspond to periods of attack. As shown in Figure 5(c), the aggregate
channel utilization for this particular access point, while elevated, was not near
bottleneck limits. What was most impacted by the SYN ﬂood was the data retry
rate, which peaked in the midst of the attack. This result indicated a higher
rate of contention and collisions at the MAC layer due to the attacker’s rapid
transmission of single SYN packets. The result was an increase in the overall end-
to-end latency as the MAC layer struggled to reliably deliver packets. During
this attack, the average RTT increased by more than 33% with 16% of all frames
consisting of MAC layer retransmissions. At the peak of the attack, more than
30% of all frames were data retransmissions.
Additionally, the aggregate number of probe requests and probe responses
to and from all access points increased during the initial attack as illustrated
in Figures 5(b) and 5(d). This result indicates that the attacker may have ag-
gravated existing hidden terminal problems, thereby causing collisions and data
retries. This behavior then triggered nearby clients that were connected to the
same access point to begin probing for other access points oﬀering better con-
nectivity. While these eﬀects do not appear catastrophic, it is evident that the
probe responses and data retries increased by more than twice their averages
over regular traﬃc intervals. Analogous to the ICMP ping ﬂood, the number of
probe responses more than doubled immediately after the attack. This behav-
ior occurred in response to the outstanding probe requests that were partially
blocked during the attack interval.
4.2 Eﬀects of Malicious Flows on Wireless Performance
Our ﬁndings show that the presence of active malware in a congested wireless
network harms performance by reducing client transmission rates and increasing
data retries. The results also demonstrate that the end-to-end delay for TCP
connections rise commensurately with slower data rates and greater numbers of
packet collisions. These eﬀects would likely have a signiﬁcant impact on real-
time applications. Under heavy utilization, access point management frames can
be obstructed and increase the delay in client handoﬀs, authentications, and
230
B. Stone-Gross et al.
250
200
150
100
50
s
e
i
r
t
e
R
a
t
a
D
50
40
30
20
10
s
t
s
e
u
q
e
R
e
b
o
r
P
0
12:59:45
13:00:00
13:00:15
13:00:30
13:00:45
0
12:59:45
13:00:00
13:00:15
13:00:30
13:00:45
(a) Data Retries
(b) Probe Requests
90
85
80
75
70
65
60
)
%
(
n
o
i
t
a
z
i
l
i
t
U
l
e
n
n
a
h
C
140
120
100
80
60
40
20
s
e
s
n
o
p
s
e
R
e
b
o
r
P
55
12:59:45
13:00:00
13:00:15
13:00:30
13:00:45
0
12:59:45
13:00:00
13:00:15
13:00:30
13:00:45
(c) Channel Utilization
(d) Probe Responses
Fig. 5. TCP SYN ﬂood eﬀects on the wireless medium
associations, further degrading performance. By comparing the eﬀects of the
NetBIOS attack with the TCP SYN ﬂood, we can determine that faster sending
rates and larger packets have a more signiﬁcant eﬀect on the wireless medium
since the channel is busy for longer periods of time. In addition, the 802.11 CSMA
protocol worked well in preventing small TCP SYN packets from dominating the
channel during malicious traﬃc ﬂows.
5 Conclusion
The study of malware on wireless systems is becoming increasingly important
as more devices communicate openly over-the-air. In this paper, we analyzed
the eﬀects that malware-driven attacks can have on 802.11 performance. The
most severe consequence is an increase in RTTs, which can hinder real-time
communication. Wireless quality of service is also virtually impossible without
developing mechanisms to reduce unwanted link layer contention.
The results that we present are from single attackers’ outgoing malware at-
tacks. Left unabated, the prevalence of malware will lead to a higher concentra-
tion of attackers and potentially deny service to legitimate users. This makes the
protection of connected machines an especially pertinent objective for wireless
network operators. In addition, as worms and botnets become more sophisti-
cated, we believe that the exploitation of wireless networks by mining sensitive
Malware in IEEE 802.11 Wireless Networks
231
information from unencrypted transmissions will become routine. Malware will
also adapt to preserve its own anonymity by spooﬁng the source of attacks.
Consequently, the eﬀects of multiple compromised machines on a single wireless
access point will become more signiﬁcant as malware evolves to speciﬁcally ex-
ploit the wireless medium. Therefore, a lightweight solution will be essential to
ensure optimal network performance and protect users’ sensitive data.
References
1. Balachandran, A., Voelker, G.M., Bahl, P., Rangan, P.V.: Characterizing User
Behavior and Network Performance in a Public Wireless LAN. In: Proc. of ACM
SIGMETRICS, Marina Del Rey, CA, June 2002, pp. 195–205 (2002)
2. Chandra, R., Padmanabhan, V., Zhang, M.: WiFiProﬁler: Cooperative Diagnosis
in Wireless LANs. In: Proc. of MobiSys, Uppsala, Sweden (June 2006)
3. Chen, Z., Gao, L., Kwiat, K.: Modeling the Spread of Active Worms. In: Proc. of
IEEE INFOCOM, San Francisco, CA (April 2003)
4. Cheng, Y., Afanasyev, M., Verkaik, P., Benko, P., Chiang, J., Snoeren, A., Sav-
age, S., Voelker, G., Kwiat, K.: Automating Cross-Layer Diagnosis of Enterprise
Wireless Networks. In: Proc. of ACM SIGCOMM, Kyoto, Japan (August 2007)
5. Gu, G., Porras, P., Yegneswaran, V., Fong, M., Lee, W.: BotHunter: Detecting
Malware Infection Through IDS-Driven Dialog Correlation. In: Proc. of Usenix
Security Symposium, Boston, MA (August 2007)
6. Heusse, M., Rousseau, F., Berger-Sabbatel, G., Duda, A.: Performance Anomaly
of 802.11b. In: Proc. of IEEE INFOCOM, San Francisco, CA (March 2003)
7. Jardosh, A., Ramachandran, K., Almeroth, K., Belding-Royer, E.: Understanding
Congestion in IEEE 802.11b wireless networks. In: Proc. of Internet Measurement
Conference, Berkeley, CA (October 2005)
8. Kirda, E., Kruegel, C., Banks, G., Vigna, G., Kemmerer, R.: Behavior-based Spy-
ware Detection. In: Proc. of Usenix Security Symposium, Vancouver, Canada (Au-
gust 2006)
9. Kotz, D., Essien, K.: Analysis of a Campus-wide Wireless Network. In: Proc. of
ACM MOBICOM, Atlanta, GA (September 2002)
10. Meng, X., Wong, S., Yuan, Y., Lu, S.: Characterizing Flows in Large Wireless Data
Networks. In: Proc. of ACM MOBICOM, Philadelphia, PA (September 2004)
11. Moore, D., Voelker, G.M., Savage, S.: Inferring Internet Denial-of-Service Activity.
In: Proc. of Usenix Security Symposium, Washington D.C (August 2001)
12. Rodrig, M., Reis, C., Mahajan, R., Wetherall, D., Zahorjan, J.: Measurement-based
Characterization of 802.11 in a Hotspot Setting. In: Proc. of ACM SIGCOMM
Workshop on Experimental Approaches to Wireless Network Design and Analysis
(E-WIND), Philadelphia, PA (August 2005)
13. Schwab, D., Bunt, R.: Characterizing the Use of a Campus Wireless Network. In:
Proc. of IEEE INFOCOM, Hong Kong, China (March 2004)