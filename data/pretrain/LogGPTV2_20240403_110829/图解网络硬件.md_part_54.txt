在进行无线LAN认证（参见后文）时，关联需在无线LAN通过认证后才能进行。
关联过程使用的MAC数据帧如图6-8所示。
---
## Page 321
06.04无线LAN搭载的各种功能307
图68IEEE802.11中使用的MAC数据帧
Frame
Duration
Address 1(6)Address2（6）
Address3(6）
Sequence
Address4（6）
Body
FCS(4)
Control
/D（2）
Control(2)
（0~2312）
(2)
（）内单位为octet
Protocol
Type(2）SubType(4)
WEP：值为1则表示WEP的
Version
8
6
数据帧体加密
(2)
一
一
（）内单位为bit
IEEE802.11的MAC数据顿类型分为3类。
①管理数据帧（ManagedFrame）
①-1传递无线信息的灯塔（Beacon）数据帧：默认时每100毫秒由接入点广播。
①-2认证使用的认证数据帧：接入点和客户端之间进行信息交互时使用的关联数据帧。
②控制数据帧（ControlFrame）
③
纯数据帧（DataFrame）：管理数据帧中使用“Address1”表示目的地地址，“Address2”表示发送源
地址，“Address3”表示BSSID信息
IEEE802.11MAC帧的数据域
表6-7汇总了图6-8中各MAC帧的数据域相关说明。
表6-7IEEE802.11MAC帧的数据域
数据域
说明
ProtocolVersion（协议版本）
表明使用IEEE802.11协议的版本。接收终端根据该信息判断是否支持接收数据帧的协
议版本
Type（类型）
表示数据帧的功能。有控制（control）数据（data）管理（management）三种
Subtype（子类型）
每个数据帧类型均有若干个子类型，用于执行某类型下特定的功能
ToDS与FromDS
DS是指分布式系统（DistributedSystem），一般只用在与接入点关联的终端之间传输
的数据帧类型。“1”表示发送源为信号基站，“0”表示发送源为终端
More Frag
在将上层分组碎片（fragment）后进行发送时使用。“1”表示后续存在碎片数据帧，“0
表示当前数据帧为最后的碎片数据帧或不存在碎片数据帧
Retry
“1”表示再次发送数据帧，“0”表示不再发送该数据帧
More Data
表示是否存在等待后续发送的分组。“1”表示存在后续分组
WEP
表示是否进行WEP加密。“1”表示进行加密
Order
“1”表示数据帧严格按照strictlyordered（发送接收顺序无法替换）的标准进行发送
06.04.02接入点的接入控制
通过对接人点的设置，无线客户端就能接人互联网。
但是，由于无线电波肉眼不可见，因此会造成外来陌生用户在未经允许时，擅自使用接人点
---
## Page 322
308第6章高速普及的无线LAN及其基础知识
的情况发生。只要在无线信号能够到达的范围内并知道SSID，客户端都能够与接入点进行关联。
为了防止不明第三者使用接人点，可以使用ESSID隐身（ESS-IDstealth）功能以及MAC地址过
滤功能。
ESSID隐身
SSID信息是由来自接人点的灯塔信号定期进行广播发送的。
一般而言，客户端使用灯塔信号来确认同哪个SSID进行连接。
但是，由于无线信号能够到达的地方，无论是谁都能够通过灯塔信号，使用对应的客户端搜
索到SSID信息并连接。
为了遇制这类风险，就可以使用不发出灯塔信号的ESSID隐身功能。客户端需要通过其他
途径获得SSID信息，并设置自身终端，从而完成隐蔽的网络连接。该方法也可以称为“SSID广
播无效化”或“拒绝Any”
但是，由于SSID在无线网络上的传播并不采取加密措施，当某个无线客户端使用SSID同
接人点进行关联时，还是可以通过无线监控（窃听）工具获取该无线网络的SSID，因此ESSID
隐身不能说是非常完备的安全对策。
图6-9ESSID隐身的结构
如果不设置ESSID隐身功能，接入点
就会定期广播SSID信息
SSID="abcde
SSID="abcde
无线LAN终端
连接上
网络
无线LAN终端
未连接上
无线LAN的接入点
SSID=?
如果ESSID隐身功能生效，则无法
有效地获取SSID信息
MAC地址过滤
在接人点中事先设置允许关联的MAC地址列表，能够防止设置以外的无线客户端接人AP
使用无线网络的情况发生，该方法称为MAC地址过滤或MAC地址认证（图6-10）。
除了设置接人点之外，还可以通过RADIUS服务器设置允许访问接入的MAC地址信息，在
认证的同时完成MAC地址过滤。但是，MAC地址同样能够通过工具伪装和冒充，对能够接人
无线LAN的MAC地址进行监听，就能够得到具体的MAC地址信息，因此该方式也同样不能
称为完备的安全对策。
---
## Page 323
06.04无线LAN搭载的各种功能309
图6-10MAC地址过滤的结构
注册的MAC地址
MAC地址
00:11:22:33:44:55
00:11:22:33:44:55
11:22:33:44:55:66
00:00:11:aa:bb:cc
无线LAN终端
连接上
网络
X
无线LAN终端
未连接上
无线LAN接入点
MAC地址
aa:bb:cc:11:22:33
06.04.03接入点的认证
在接入点上使用ESSID隐身以及MAC地址过滤功能均不能完全防止第三者恶意访问的情
况，因此为了彻底防止不明意图的用户访问接人点，需要执行认证行为。
IEEE802.11作为最初的LAN标准提供了名为“开放系统认证”和“共享密钥认证”两种认
证方式。
开放系统认证
开放系统认证（OpenSystemAuthentication）属于无线LAN认证方式中的一种，该方式无需
客户端输人用户名以及密码等认证信息就能向接人点发出认证请求。
无线LAN接入点能够容纳所有接人认证请求，这也就意味着无论是谁都能够同接人点进行
关联。
开放系统认证一般用于公共无线LAN中。无论是谁都能够完成接人甚至是无加密地接人
LAN，因此在使用中还需要配合IPsecVPN或SSLVPN技术来完成用户最终访问网络的需求。
共享密钥认证
共享密钥认证（SharedKeyAuthentication）在接人点和客户端之间进行无线加密通信时使
用。使用WEP或WPA加密标准时，对接入点以及客户端预先设置同样的口令，通过该口令就
可以建立二者间的无线通信链路。
关联。
---
## Page 324
310|第6章高速普及的无线LAN及其基础知识
TEEE802.1X
IEEE802.1X是用户认证与访问控制协议，不仅仅适用于无线LAN，有线LAN也同样适用。
IEEE802.1X认证如图6-11所示，由认证请求方、认证者、认证服务器3部分组成。请求
认证的终端（或终端上运行的请求认证的软件）称为认证请求方（Supplicant）同终端相连的
接人点、交换机以及其他网络设备称为认证者（Authenticator）。认证方式采用EAP（Extensible
AuthenticationProtocol，扩展认证协议），认证者将来自认证请求方的EAP消息封装成RADIUS
数据顿中继给认证服务器，当认证服务器完成认证工作后，认证者会通知认证请求方并同时将认
证请求方视为通过认证的终端，以后从该终端发来的MAC数据帧均能够转发至LAN上的其他
终端或互联网上。
认证信息使用用户名、口令、数字证书等任意一种方式即可，对应的认证协议有EAP-MD5、
EAP-TLS、EAP-TTLS等各种类型。关于IEEE802.1X认证的详细内容可以参考本书02.08.09节
“基于端口认证”的相关内容。
图6-11IEEE802.1X中的用户认证
LAN
认证请求方
认证者
LAN认证服务器
（无线LAN终端）
（无线LAN的接入点）
(RADIUS)
EAP
802.1X认证
06.04.04无线LAN通信的加密
空气中传输的无线电波只要在覆盖范围内就能被第三方接收到，再加上无线LAN数据解析
工具的存在，恶意用户能够相当轻松地窃听他人的无线通信内容。
为了防止无线通信被窃听以及篡改，必须在无线通信过程中对信息进行加密处理。无线
LAN加密一般有WEP、WPA、WPA2等这些标准。
随着计算机能力的提高，加密技术也迅速发展，因此尽可能使用最新的加密标准比较好。下
面本书将会对各类无线LAN加密标准逐一介绍。
WEP
WEP（WiredEquivalentPrivacy，有线等效保密）是1999年作为IEEE802.11b标准安全系统
---
## Page 325
06.04无线LAN搭载的各种功能|311
采用的无线加密技术，通过使用基于RC4算法的密钥加密形式完成无线LAN数据的加密（图
6-12）。该加密方式的密钥称为WEPkey。
WEP一共有3种加密方式：40bit长度的密钥同24bit长度的初始向量（IV，Initialization
Vector）值组成64bit长的加密方式，104bit长度的密钥同24bit长度的初始向量值组成128bit的
加密方式，以及128bit长度的密钥同24bit长度的初始向量值组成152bit的加密方式。
WEP属于最早的无线安全标准，密钥长度越短，破解花费的时间也越短，因此目前主流的
加密通信最短也会采用128bit的总密钥长度，甚至有的还采用了尚未通过标准化的、由128bit长
度的密钥和24bit的初始向量值组成152bit的WEP加密方式进行通信。
图6-12WEP的无线通信加密技术
WEP密钥“abc12”
设置WEP密钥=“abc12
无线LAN终端
加密后连接、不会被窃听
网络
X
无线LAN终端
无法连接
无线LAN接入点
WEP密钥=“xyz98”
表6-8WEP密钥的种类
ASCII设置
16进制设置
能够使用的字符
数字a-z、A-Z、0-9
A-F、0-9
40bit（60bit）的WEPkey
5字符
10位数
104bit（128bit）的WEPkey
13字符
26位数
128bit（152bit）的WEPkey
16字符
32位数
WPA
WEP存在较明显的脆弱性，为了弥补该缺陷而制定的无线LAN安全标准就是WPA（Wi-Fi
ProtectedAccess，Wi-Fi保护接人）。
WPA是由Wi-Fi联盟于2002年10月发布的Wi-Fi安全性标准。该标准将SSID与WEP密
钥一同加密，并且使用了能够定期自动更新用户认证功能和密钥的TKIP（TemporalKeyIntegrity
Protocol，临时密钥完整性协议）。
WPA原本属于2004年制定的IEEE802.11i中加密标准的一部分，但为了使实现了IEEE
802.11a/b等早期标准的硬件设备也能够使用WPA，因此该加密标准先于IEEE802.11i进行了公布。
---
## Page 326
312|第6章高速普及的无线LAN及其基础知识
WPA提供了用于小规模的个人模式（PersonalMode）和用于企业的企业模式（Enterprise
Mode）两种模式。
在个人模式中的WPA也称为WPA-PSK，同接人点之间连接的客户端使用所有密钥都相同
的预共享密钥（PSK，Pre-sharedKey）方式。
企业模式的WPA主要用于企业网络，在PSK的基础上增加了IEEE802.1X认证服务器，使
得不同用户能够使用不同的用户名和密码连接至接人点。
表6-9WEP与TKIP的比较
WEP
TKIP
密钥长度
40bit或104bit
128bit
初始向量
24bit
48bit
密钥更新
无
有
加密算法
RC4
RC4
防篡改
无
通过MIC机制防篡改
WPA2
WPA2是Wi-Fi联盟于2004年9月发表的新版WPA标准，采用AES作为加密算法。AES
多用于IPsec以及SSL等协议中，同WEP、WPA所使用的RC4相比，加密的安全性更高（表
6-10）。AES支持长度为128bit、196bit、256bit的密钥，WPA2使用其中的128bit长度类型。
WPA2兼容前一代WPA，支持WPA2的硬件设备和只支持WPA的设备也能够进行通信。AES
证码的意思。
接人点的加密设置可以选择WPA-PSK（TKIP）、WPA-PSK（AES）、WPA2-PSK（TKIP）或
WPA2-PSK(AES)
IEEE802.11i
IEEE802.11i是由IEEE在2004年完成标准化的无线LAN安全标准。虽然之前无线LAN有
WEP加密标准，但其安全性尚不足以保障高安全的通信过程。
因此，IEEE802.11i成为了新版无线LAN安全性标准。在该标准的标准化工作完成之前，
Wi-Fi联盟使用了其中的部分内容作为WPA加密标准进行了发布。
IEEE802.11i加密通信标准几乎包括WPA、WPA2的所有内容，另外还添加了IEEE802.1X
与EAP作为用户认证的标准。
---
## Page 327
06.04无线LAN搭载的各种功能|313
表6-10
WEP/WPAWPA2的比较
WEP