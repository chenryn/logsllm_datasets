### 3. 数据集

在本研究中，我们依赖于从多个观测点收集的测量数据。

#### 1. 互联网交换点 (IXPs)
我们在两个互联网交换点（IXPs）收集了包采样跟踪数据。这些数据使我们能够研究跨域环境中的后台流量，涉及数百个网络 [6]。
- **L-IXP**：一个大型IXP，约有500个成员。
- **M-IXP**：一个中型IXP，约有100个成员。
- **采集方法**：sFlow记录 [51]，采样率为1/16K，捕获每个采样以太网帧的前128字节，提供完整的网络层和传输层头部及部分载荷，支持深度包检测（DPI）。

#### 2. 互联网服务提供商 (ISP)
我们从一个大型欧洲Tier-1 ISP的两条跨大西洋骨干链路上收集匿名包采样跟踪数据。这些链路主要承载过境流量。
- **采集方法**：随机包采样率1/1K。
- **补充数据**：在一个拥有约20,000终端用户的住宅网络中收集未采样的匿名包转储。

#### 3. 内容分发网络 (CDN)
我们从一个大型商业CDN的多个服务器的日志中获取数据。这些日志提供了CDN内部生成的后台流量的详细视图。
- **日志内容**：每个条目包含TCP摘要统计信息，包括端点IP、传输字节数和初始TCP握手往返延迟。此外，我们还收到了CDN基础设施使用的所有IP地址的完整列表。

#### 4. 主动测量
我们使用ZMap项目 [25] 的主动测量数据。该数据集包含在2013年10月至2014年1月期间响应HTTP (80端口) 和HTTPS (443端口) GET请求的IP地址列表。
- **补充数据**：结合[18, 56]作者公开的Google基础设施使用的IP地址集合，以便更全面地分析。

### 4. 识别后台流量

基于上述后台Web流量的特征，我们接下来描述如何在数据集中识别大部分此类流量。我们的方法包括三个步骤：
1. 根据是否参与任何Web活动对所有IP进行分类。
2. 将其活动分类为Web客户端、Web服务器或两者兼具。
3. 在客户端中识别拍卖者和爬虫，在服务器中识别竞标者，并在同时作为客户端和服务器的主机中识别Web代理。

#### 4.1 Web服务器端点
我们仅关注在跟踪中看到Web活动（即HTTP或HTTPS活动）的IP。为此，我们依赖于已知的签名来检测任意TCP端口上的HTTP请求（GET、POST）和响应（HTTP/1.{0,1}）。对于HTTPS，我们使用签名匹配端口443上的SSL/TLS握手消息（即Client Hello和Server Hello消息 [15]）。
- **结果**：一组Web服务器端点，即包含IP地址和对应端口号的元组。我们将发送到/来自这些Web端点的所有数据包视为Web流量。
- **表1**显示了不同数据集中Web流量的百分比。如预期，Web流量占TCP流量的很大一部分，范围从64%到95%。

#### 4.2 IP的角色分类
在识别出Web服务器端点后，我们进一步将IP地址的Web活动分类为客户端唯一、服务器端唯一或两者兼具（称为双重行为）。
- **服务器端唯一**：如果某个IP的所有流量都与其已识别的服务器端点相关（通常在80端口）。
- **客户端唯一**：如果某个IP只发送请求并从其他服务器端点接收响应。
- **双重行为**：如果某个IP既作为客户端又作为服务器，即在特定端口上运行服务器但同时也向其他服务器发出请求。

由于观测点的限制，可能无法看到主机参与的所有Web活动。例如，代理服务器在互联网核心中可能只表现出客户端活动，在接入网络中则只表现出服务器活动。为了解决这一限制，我们结合被动和主动测量来发现更多具有双重行为的IP：
- **方法**：通过DPI从跟踪中获取客户端IP列表，然后使用ZMap数据集检查这些IP是否响应HTTP(S)查询。
- **表2**展示了仅依赖DPI以及结合ZMap数据集后的IP分类结果。

### 注意事项
- **动态分配IP地址**：可能导致双重主机的过度计数。如果一个双重主机在不同时间被分配不同的IP地址，则每个IP地址可能都被分类为双重主机。
- **复杂情况**：我们的方法可能无法检测到更复杂的双重行为，例如服务器具有多个接口，从多个IP地址发送/接收流量，每个IP地址只作为客户端或服务器。

通过以上方法，我们可以更准确地识别和分类Web流量中的后台活动。