42
   2020年12月 第 12 期（第33卷 总第280期）月刊
2020 年 第 12 期
电信工程技术与标准化   中国移动网络与信息安全专题
基于IPv6的资产管理系统概要设计与实现
李江1，李肖肖1，安宝宇2，付俊1，何申1
(1 中国移动通信有限公司研究院，北京 100053；2 中国移动通信集团公司信息安全管理
与运行中心，北京 100053)
摘 要 IPv6具备海量的地址空间，地址生成随机性强，对IPv6网络空间中的资产进行管理将面临许多新的挑战。本
文吸取了业界IPv6存活地址快速发现理论的核心思想，结合现在的网络特点，设计开发出基于IPv6的资产管
理系统，用于辅助对IPv6资产进行管理。
关键词 IPv6；资产管理；扫描
中图分类号  TN918       文献标识码  A       文章编号  1008-5599（2020）12-0042-06
收稿日期 ：2020-11-07
随着 5G 网络及物联网应用的迅速发展，海量终端
设备、系统平台的部署及应用也为 IPv6 网络空间下的
资产管理提出了挑战。IPv6 网络空间下地址长度扩展
到 128 bit，传统的对于 IPv4 的资产管理方式无法满足
IPv6 资产管理的需要。如何对 IPv6 网络空间中的资产
进行管理将面临许多新的挑战。
1  研究目标和现状
IPv6 资产管理的核心难点在于如何利用有限资源，
在可接受的时间范围内准确地掌握资产状态的变化，并
对其进行有效监控。然而在 IPv6 资产管理技术上，存
在多重挑战。
（1）IPv6 可用地址空间更大。因为 IPv6 的地址长
度已由原 IPv4 的 32 bit 扩展到 128 bit，可表示的地址
数量成指数倍增长。原有应对 IPv4 网络内资产管理的
大部分方式方法均不太适用 IPv6 的网络空间。
（2）IPv6 地址生成随机性强。IPv6 网络支持设备
通过多种方式来获取 IPv6 地址。尤其是无状态地址生
成方式（SLAAC），该地址生成方式会产生大量随机强
的 IPv6 地址，因考虑到隐私安全问题，很难进行反向
推测，并且该方法已大量应用到实际场景中。
（3）IPv6 常用子网划分方法造成子网空间巨大。
IPv6 网络在实际使用中的子网划分过程中经常会按照 / 
64 大小的网段来划分供单个局域网来使用。在现实场
景下，当网络由多个类似 /64 大小的子网构成时，由
于这种网络中可用地址空间异常庞大，导致无法通过
常规手段来方便快速地收集该网络中现有存活的 IPv6
资产。
因此利用有限的时间和空间来更便捷的管理 IPv6
DOI:10.13992/j.cnki.tetas.2020.12.009
43
中国移动网络与信息安全专题   电信工程技术与标准化
                                      2020年12月 第 12 期（第33卷 总第280期）月刊
2020 年 第 12 期
网络中的资产是一个非常棘手的问题。在技术上，使用
单一方式对 IPv6 资产进行有效管理是难以实现的。目
前业界已经提出过多个针对 IPv6 资产发现的技术与方
法，典型的包括探针密集采集法、DNS 反向查询法、网
络流量分析法和编址规则推测法。这 4 种方法在某些特
定场景中可以辅助对 IPv6 的资产进行管理，但是一种
方法仅适用于有限的场景。
本文吸取了上述已公开的 IPv6 存活地址快速发现
理论的核心思想，通过对大量文献进行研究，再依托探
测 IPv6 地址的常见算法，设计开发出基于 IPv6 的资产
管理系统。由一个或多个已知的支持 IPv6 的域名触发，
综合多种 IPv6 地址探测算法，逐步挖掘更多存活 IPv6
地址。通过在实际网络环境中对该系统工具的初步应用，
收集到了一批 IPv6 资产数据，在一定程度上补足了当
前对 IPv6 暴露面管理缺乏有效工具的短板，形成了对
应的能力储备。
2  系统设计与实现
2.1 概要设计
IPv6 资产管理系统由 6 个模块构成，分别为 IPv6
地址初始收集模块、IPv6 地址扩容收集模块、关联地址
探测扫描模块、编址规则扫描模块、随机地址探测扫描
模块和基于日志的存活地址收集模块。
上述 6 个模块协同工作，最终收集到大量有效的
IPv6 存活地址。系统示意如图 1 所示。
2.2 IPv6 地址初始收集模块
本功能模块完成 IPv6 地址的初始收集。对当前提
供 IPv6 服务的域名集合进行反向 DNS 查询，获取到与
域名对应的 IPv6 地址信息，并汇总生成 IPv6 地址集。
如果当前尚无可用的域名集合，也可通过网络爬虫的大
规模的爬取来形成域名集合。具体实现方法如下。
（1）通过域名查询工具或指令对具体的域名网址进
行域名反查，得出 IPv6 地址，此步骤可以获取到一批
初始的 IPv6 地址。
（2）通过域名查询工具或指令中指定 DNS 服务器
参数的功能，指定多个不同服务商或地区的 DNS 服
务器，并再次进行域名反查 IPv6 地址的操作，以增
加获取到不同地址信息的可能性。以 nslookup 指令
为例，可以指定多个 DNS 服务器进行域名反查，针
对多次查询结果去重汇总，从而获取到更丰富的 IPv6
地址信息。
（3）针对本功能模块中搜集到的全部 IPv6 地址
去 重 后， 生 成 该 部 分 的 IPv6 存 活 地 址 集 Address-
Pool-1，并汇入到总的 IPv6 存活地址集中。
IPv6 地址初始收集模块工作示意如图 2 所示。
2.3 IPv6 地址扩容收集模块
本功能模块以 IPv6 地址初始收集模块中获取到的
地址集合为输入，对其中所有地址进行网络路径遍历的
操作处理，从而获取网络路径上存活的 IPv6 地址集合，
并将该地址集合作为本功能模块的输出。具体实现方法
如下。
（1）对输入地址集合中的每一个具体的 IPv6 地址
信息进行路由路径遍历操作，获取返回记录并分析提取
其中的每一条具体的 IPv6 地址信息。
（2）针对本步骤中搜集到的 IPv6 地址进行去重后，
生成该部分的 IPv6 存活地址集合 Address-Pool-2，并
汇入到总的 IPv6 存活地址集中。
IPv6 地址扩容收集模块工作示意如图 3 所示。
图1  系统示意图
44
   2020年12月 第 12 期（第33卷 总第280期）月刊
2020 年 第 12 期
电信工程技术与标准化   中国移动网络与信息安全专题
2.4 关联地址探测扫描模块
通常网络中一个 IPv6 地址被占用，则其临近的
IPv6 地址被占用的概率较高。本功能模块基于此规律，
对已经收集到的 IPv6 存活地址，进行一定范围的地址
浮动偏移，扩充生成对应的地址段，并对地址段
进行快速扫描，来探测其临近的 IPv6 地址存活
情况。具体实现方法如下。
（1）对已收集到的 IPv6 存活地址集中的每
一个具体地址进行末位地址字段前后一定范围的
地址偏移浮动操作。例如某一存活的 IPv6 地址
为 2001:DB8::64，对其进行末位地址字段一定
范围的地址偏移浮动操作后，可以固定 128 bit
地 址 的 前 120 bit， 遍 历 后 8 bit, 生 成 对 应 的
IPv6 地址段信息 2001:DB8::0/120, 网段中包
含 2001:DB8::1-2001:DB8::ff 共计 256 个可用
IPv6 地址。从而将单个 IPv6 地址信息扩充成其
对应的 IPv6 地址段信息。
（2）对第 1 步的 IPv6 地址段进行去
重处理，通过快速扫描探测地址段中的存
活地址。
（3）对探测到存活的地址进行汇总去