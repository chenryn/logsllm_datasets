Impossible Differential Cryptanalysis
−20 and 2
−12 , 2
−4, 2
6.3.4 Other Attacks
According to the results by Suzaki et al. in [39], after 19
rounds, there is no useful integral distinguisher either. We
also considered other attacks, and we expect that none of
them works signiﬁcantly better than the previously men-
tioned attacks.
6.4 Recommended Number of Rounds
As for SPACE, we recommend to choose the number of
rounds such that the basic white-box compression attack of
Section 6.2.2 covers at most half of the rounds at the level of
(T /4, 128)-space hardness and the best black-box property
in Section 6.3 covers at most half of the rounds. For the
instantiation of 4-SPACE at hand, following this guideline
gives 512 rounds. A less conservative claim for the space
hardness may be acceptable for many users resulting in a
signiﬁcantly lower number of rounds.
For the recommended number R = 512 of rounds, the
claimed white-box security for 4-SPACE is (T /4, 128)-space
hardness, see also Table 5. The claimed black-box security is
that of a 128-bit block cipher with a 128-bit key. We do not
claim any security against combined black- and white-box
attackers.
Figure 7: Ciphers with variable space: N-SPACE
8 (x), F r
16(x), F r
functions F r
32(x) to implement
by table look-ups. We deﬁne four implementation variants:
• 4-SPACE-(R)-32 : All four functions are implemen-
24(x) and F r
tation by table look-ups.
• 4-SPACE-(R)-24 : F
′
8(x), F
plemented by table look-ups.
′
16(x) and F
′
24(x) are im-
• 4-SPACE-(R)-16 : F
′
8(x) and F
′
16(x) are implemented
by table look-ups.
• 4-SPACE-(R)-8 : Only F
′
8(x) is implemented by table
look-ups.
The other respective F-functions are implemented by block
cipher calls with the corresponding keys. 4-SPACE-(R) re-
quires four 128-bit keys: K1, K2, K3 and K4. One can
derive those from a 128-bit master key K using a generic
key derivation function [24, 29].
6.2 Security in the White Box
6.2.1 Key Extraction
As for SPACE, it is hard to extract the key from the table
for an F-function as long as the underlying block cipher EK
is secure against key recovery. In 4-SPACE-(R)-24, -16 and
-8, the attacker can directly observe K4, (K3, K4) and (K2,
K3, K4) from the white-box implementation. However, (K3,
K2, K1), (K2, K1) and K1 are hard to extract, respectively.
6.2.2 Code Lifting
Since the attacker is unable to compute the F-function
without knowing of its key Ki, it is infeasible to ﬁnd a com-
pact representation of any of the variants, as at least one
F-function is implemented by table look-ups.
Let us mount a white-box compression attack and con-
sider the case where i entries of the largest table are isolated
by the attacker. In each implementation variant, it is the
x0r-1x1r-1x2r-1x3r-1xl-1r-1x0r+3x1r+3x2r+3x3r+3xl-1r+3x4r-1x5r-1x4r+3Fr-1F r+1F rF r+2n/ln/l2n/l3n/l4n/l1067Table 5: Performance and table sizes for the four 4-
SPACE implementation variants and recommended
round number: All of them oﬀer exactly the same
functionality
4-SPACE-(512)-8
4-SPACE-(512)-16
128 L1-TL+384 BC
128(L1-TL+L3-TL)+
3.84 KB
918 KB
Performance
T
4-SPACE-(512)-24
4-SPACE-(512)-32
256 BC
128(L1-TL+L3-TL)+ 218 MB
128 RAM-TL+128 BC
128(L1-TL+L3-TL)+ 51.5 GB
128(RAM-TL+HDD-TL)
6.5 Implementation Issues
Table 5 demonstrates the performance and table sizes for
each of the four implementation variants for 4-SPACE. The
sizes of 4-SPACE-(R)-8, -16, -24 and -32 are suited for
L1/L2 cache, L3 cache, RAM and HDD, respectively. All
implementation variants oﬀer exactly the same functional-
ity.
Under the rough assumption that a table access to L1/L2
cache, L3 cache, RAM and HDD costs 5, 30, 100, and 1000
cycles, respectively, and that an AES-128 encryption with
AES-NI takes 16 cycles (in a parallel mode of operation),
the performance of 4-SPACE-(512)-8, -16, -24 and -32 is
approximately evaluated as 424, 536, 1208 and 9080 cycles
per byte.
In the black box, implementations without tables are pos-
sible by decomposing the tables. The performance is then
estimated by the number of block function calls. A combi-
nation of F-functions implemented with table look-ups and
AES-NI is beneﬁcial.
7. CONCLUSIONS
We have opened up a new direction for white-box cryp-
tography, by introducing the idea that white-box security
can rely on key recovery problems for well-analyzed block
ciphers in the standard black-box setting and by propos-
ing the new security notion of (M, Z)-space hardness. This
enables us to demonstrate security against key extraction,
table decomposition and code lifting attacks in the white-
box environment, which have been the crucial limitation of
the published techniques.
As an example, we design the family of block ciphers
SPACE. It includes four variants with diﬀerent but ﬁxed
code sizes, and a variant N-SPACE with variable code sizes
while keeping the cipher itself unchanged.
Acknowledgments
We would like to thank Bart Preneel for his highly valu-
able and constructive feedback, which helped us to improve
the technical and editorial quality of the paper. Moreover,
we would like to thank the anonymous referees for their in-
sightful comments. Among others, we are grateful to the
referee who proposed the secret-sharing based construction
described in Section 5.8.
8. REFERENCES
[1] Martin R. Albrecht, Benedikt Driessen, Elif Bilge
Kavun, Gregor Leander, Christof Paar, and Tolga
Yal¸cin. Block Ciphers - Focus on the Linear Layer
(feat. PRIDE). In Advances in Cryptology - CRYPTO
2014, LNCS, Vol. 8616, pages 57–76, 2014.
[2] Ray Beaulieu, Douglas Shors, Jason Smith, Stefan
Treatman-Clark, Bryan Weeks, and Louis Wingers.
Simon and Speck: Block Ciphers for Internet of
Things. NIST Lightweight Cryptography Workshop
2015, 2015.
[3] Olivier Billet, Henri Gilbert, and Charaf Ech-Chatbi.
Cryptanalysis of a White Box AES Implementation.
In Selected Areas in Cryptography - SAC 2004, LNCS,
Vol. 3357, pages 227–240, 2004.
[4] Alex Biryukov, Charles Bouillaguet, and Dmitry
Khovratovich. Cryptographic Schemes Based on the
ASASA Structure: Black-Box, White-Box, and
Public-Key (Extended Abstract). In Advances in
Cryptology - ASIACRYPT 2014, LNCS, Vol. 8873,
pages 63–84, 2014.
[5] Alex Biryukov, Daniel Dinu, and Dmitry
Khovratovich. Fast and Tradeoﬀ-Resilient
Memory-Hard Functions for Cryptocurrencies and
Password Hashing. Cryptology ePrint Archive, Report
2015/430, 2015.
[6] Alex Biryukov and Dmitry Khovratovich.
Decomposition attack on SASASASAS. Cryptology
ePrint Archive, Report 2015/646, 2015.
[7] Alex Biryukov and Adi Shamir. Structural
Cryptanalysis of SASAS. J. Cryptology, Vol. 23(4),
pages 505–518, 2010.
[8] C´eline Blondeau, Andrey Bogdanov, and Gregor
Leander. Bounds in Shallows and in Miseries. In
Advances in Cryptology - CRYPTO 2013, LNCS, Vol.
8042, pages 204–221, 2013.
[9] Andrey Bogdanov, Dmitry Khovratovich, and
Christian Rechberger. Biclique Cryptanalysis of the
Full AES. In Advances in Cryptology - ASIACRYPT
2011, LNCS, Vol. 7073, pages 344–371, 2011.
[10] Andrey Bogdanov, Florian Mendel, Francesco
Regazzoni, Vincent Rijmen, and Elmar Tischhauser.
ALE: AES-Based Lightweight Authenticated
Encryption. In Fast Software Encryption - FSE 2013,
LNCS, Vol. 8424, pages 447–466, 2013.
[11] Julia Borghoﬀ, Lars R. Knudsen, Gregor Leander, and
Søren S. Thomsen. Slender-Set Diﬀerential
Cryptanalysis. J. Cryptology, Vol. 26(1), pages 11–38,
2013.
[12] Julien Bringer, Herv´e Chabanne, and Emmanuelle
Dottax. White Box Cryptography: Another Attempt.
IACR Cryptology ePrint Archive, 2006:468, 2006.
[13] Stanley Chow, Philip A. Eisen, Harold Johnson, and
Paul C. van Oorschot. A White-Box DES
Implementation for DRM Applications. In Security
and Privacy in Digital Rights Management, ACM
CCS-9 Workshop, pages 1–15, 2002.
[14] Stanley Chow, Philip A. Eisen, Harold Johnson, and
Paul C. van Oorschot. White-Box Cryptography and
an AES Implementation. In Selected Areas in
Cryptography - SAC 2002, LNCS, Vol. 2595, pages
250–270, 2002.
1068[15] Joan Daemen and Vincent Rijmen. The Design of
[30] Wil Michiels. Opportunities in White-Box
Rijndael: AES - The Advanced Encryption Standard.
Information Security and Cryptography. Springer,
2002.
Cryptography. IEEE Security & Privacy, vol. 8(1),
pages 64–67, 2010.
[31] Wil Michiels, Paul Gorissen, and Henk D. L.
[16] Joan Daemen and Vincent Rijmen. Probability
distributions of correlation and diﬀerentials in block
ciphers. J. Mathematical Cryptology, Vol. 1(3), pages
221–242, 2007.
Hollmann. Cryptanalysis of a Generic Class of
White-Box Implementations. In Selected Areas in
Cryptography - SAC 2008, LNCS, Vol. 7707, pages
414–428, 2008.
[17] Patrick Derbez, Pierre-Alain Fouque, and J´er´emy
[32] Brice Minaud, Patrick Derbez, Pierre-Alain Fouque,
Jean. Improved Key Recovery Attacks on
Reduced-Round AES in the Single-Key Setting. In
Advances in Cryptology - EUROCRYPT 2013, LNCS,
Vol. 7881, pages 371–387, 2013.
[18] Daniel Dinu, Yann Le Corre, Dmitry Khovratovich,
Leo Perrin, Johann Grosschadl, and Alex Biryukov.
Triathlon of Lightweight Block Ciphers for the
Internet of Things. NIST Lightweight Cryptography
Workshop 2015, 2015.
[19] Itai Dinur, Orr Dunkelman, Thorsten Kranz, and
Gregor Leander. Decomposing the ASASA Block
Cipher Construction. Cryptology ePrint Archive,
Report 2015/507, 2015.
[20] Orr Dunkelman, Nathan Keller, and Adi Shamir.
Improved Single-Key Attacks on 8-Round AES-192
and AES-256. J. Cryptology, Vol. 28(3), pages
397–422, 2015.
[21] Christian Forler, Stefan Lucks, and Jakob Wenzel.
Memory-Demanding Password Scrambling. In
Advances in Cryptology - ASIACRYPT 2014, LNCS,
Vol. 8874, pages 289–305, 2014.
[22] Henri Gilbert, J´erˆome Plˆut, and Joana Treger.
Key-Recovery Attack on the ASASA Cryptosystem
with Expanding S-Boxes. In Advances in Cryptology -
CRYPTO 2015, LNCS, Vol. 9215, pages 475–490,
2015.
[23] Mohamed Karroumi. Protecting White-Box AES with
Dual Ciphers. In Information Security and Cryptology
- ICISC 2010, LNCS, Vol. 6829, pages 278–291, 2010.
[24] Hugo Krawczyk. Cryptographic extraction and key
derivation: The HKDF scheme. In Advances in
Cryptology - CRYPTO 2010, LNCS, Vol. 6223, pages
631–648, 2010.
[25] Tancr`ede Lepoint, Matthieu Rivain, Yoni De Mulder,
Peter Roelse, and Bart Preneel. Two Attacks on a
White-Box AES Implementation. In Selected Areas in
Cryptography - SAC 2013, LNCS, Vol. 8282, pages
265–285, 2013.
[26] Hamilton E. Link and William D. Neumann.
Clarifying Obfuscation: Improving the Security of
White-Box DES. In International Symposium on
Information Technology: Coding and Computing -
ITCC 2005, IEEE Computer Society, Vol. 1, pages
679–684, 2005.
[27] Marlin Developer Community. Marlin architecture
overview. http://www.marlin-community.com, 2011.
[28] NIST Special Publication 800-38B. Recommendation
for Block Cipher Modes of Operation: The CMAC
Mode for Authentication. 2005.
[29] NIST Special Publication (SP) 800-108.
Recommendation for Key Derivation Using
Pseudorandom Functions. 2009.
and Pierre Karpman. Key-Recovery Attacks on
ASASA. Cryptology ePrint Archive, Report 2015/516,
2015.
[33] Yoni De Mulder. White-Box Cryptography: Analysis
of White-Box AES Implementations. PhD thesis, KU
Leuven, 2014.
[34] Yoni De Mulder, Peter Roelse, and Bart Preneel.
Cryptanalysis of the Xiao - Lai White-Box AES
Implementation. In Selected Areas in Cryptography -
SAC 2012, LNCS, Vol. 7707, pages 34–49, 2012.
[35] Yoni De Mulder, Brecht Wyseur, and Bart Preneel.
Cryptanalysis of a Perturbated White-Box AES
Implementation. In Progress in Cryptology -
INDOCRYPT 2010, LNCS, Vol. 6498, pages 292–310,
2010.
[36] Jacques Patarin, Val´erie Nachef, and Cˆome Berbain.
Generic Attacks on Unbalanced Feistel Schemes with
Expanding Functions. In Advances in Cryptology -
ASIACRYPT 2007, LNCS, Vol. 4833, pages 325–341,
2007.
[37] Colin Percival. Stronger Key Derivation via Sequential
Memory-Hard Functions. presented at BSDCan’09,
2009.
[38] Bruce Schneier and John Kelsey. Unbalanced Feistel
Networks and Block Cipher Design. In Fast Software
Encryption - FSE 1996, LNCS, Vol. 1039, pages
121–144, 1996.
[39] Tomoyasu Suzaki and Kazuhiko Minematsu.
Improving the Generalized Feistel. In Fast Software
Encryption - FSE 2010, LNCS, Vol. 6147, pages
19–39, 2010.
[40] Tyge Tiessen, Lars R. Knudsen, Stefan Kolbl, and
Martin M. Lauridsen. Security of AES with a Secret
S-box . In the preproceedings of FSE 2015, 2015.
[41] Emmanuel Volte, Val´erie Nachef, and Jacques Patarin.
Improved Generic Attacks on Unbalanced Feistel
Schemes with Expanding Functions. In Advances in
Cryptology - ASIACRYPT 2010, LNCS, Vol. 6477,
pages 94–111, 2010.
[42] Brecht Wyseur. White-Box Cryptography. PhD thesis,
KU Leuven, 2009.
[43] Brecht Wyseur, Wil Michiels, Paul Gorissen, and Bart
Preneel. Cryptanalysis of White-Box DES
Implementations with Arbitrary External Encodings.
In Selected Areas in Cryptography - SAC 2007, LNCS,
Vol. 4876, pages 264–277, 2007.
[44] Yaying Xiao and Xuejia Lai. A Secure Implementation
of White-box AES. In 2nd International Conference
on Computer Science and its Applications - CSA
2009, pages 1–6, 2009.
1069