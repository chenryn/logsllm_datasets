1.合同中指纹获取：
使用手机拍带有指纹印的合同等，即可提取可用的指纹纹路信息，便于后续假指纹制作等。
图21 手机拍下的某份带有指纹印章的合同
如下是用手机拍摄的这枚指纹进行预处理、图像增强、细化后的结果：
图22 对指纹印章进行预处理、图像增强、细化后的结果
总之，只要是提取到了指纹纹路图像，就可以对图像进行进一步优化处理了。由于后续步骤一样，以下只展示提取原始指纹灰度图像部分。
2.相机拍摄的图片中指纹获取：
图 23 普通相机拍下的带有手指的照片
图 24 对手指进行二值化获取到的指纹纹路
3.手机后壳上的指纹获取（可以清晰的看到，换一种角度/一种光照，这些指纹就可以变得很明显了）
图 25 用手机拍摄的某手机背面，在灯光斜射下指纹清晰展现
图 26 手机背面指纹二值化后的图像
顺便说一句，其实指纹图像获取会有很多方法、扩展。例如我也是个摄影爱好者，曾经成功的用佳能70-200镜头获取到了10米外的笔记本电脑屏幕上的指纹，也算是一种远程打击了吧。
同时，这里必须指出，指纹图像的获取是在破解指纹验证中至关重要的一环，可以说 **只要获取到了指纹图像，就成功了一大半了**
。因为图像里面已经包含了指纹的全部原始信息，后面要做的无非就是拿着图像或者图像对应的特征，让传感器正常感应/感光，同时绕过各种活体检测拦路虎，完成对传感器的欺骗。
##### 3.3 第二步：假指纹的制作
我们已经成功获取到目标的指纹图像了，那如何重制出高精度的假指纹呢？我们测试了包括高精度3D打印、针式打印机成型、导电墨水打印机多层打印、激光雕刻等多种技术方案，这些方案有个共同的特点：由机械进行传动成像成型。由于机械部件之间往复运动会存在一定的旷量，位置传感器、电机通常也有一定的误差，最终导致分辨率有限，现有这些设备均无法满足指纹细小纹路的精度要求，成型模型细看上去会呈一定程度的非线性（当然，我们猜测几十万+的工业级设备例如超高精度3D打印可以完成这个工作，但是成本太大）。
既然这些激光头、打印头无法满足精度需求，我们又把目光放到了腐蚀成像这种不依靠机械，而是依靠光学or化学进行成型的方案，例如光敏成型、化学腐蚀成型。这种方案的特点是：只要原像清晰，由于是对原像进行投影成像，最终成像会无限接近原像，肉眼一般无法分辨。考虑到精度、成本、速度等因素，最终选用了一种光敏成型方案，灵感来自于光敏刻章方法，下面简单介绍下这种技术。
光敏印章是上个世纪九十年代初由日本发明的，它使用了一种超微泡材料完成成型，其表面的微孔孔径非常小。这种材料在受到强光照射的时候，见光部分会瞬间吸收大量的光能，温度迅速上升并达到熔点，使材料表面发生光氧化及热交联作用，最终效果是迅速收缩塌陷，而不受光射部分保持之前的状态。
根据光敏材料的这种特性，人们在材料表面覆盖了一张用黑白激光打印机打印出的印章图像（最好使用硫酸纸这种透明纸），在受到强光照射时，白色透光部分就会收缩塌陷，而黑色部分保持原平面高度，最终形成一个具有凹凸不平表面的印章图像，速度和精度比原始的刻章快了好多。
图 27 指纹印章制作过程
受到光敏印章的启发和指纹识别的成像原理（光学和电容指纹，都需要有凹凸不平的表面），我们想到如果把打印的印章图像换成指纹纹路图像，是不是也可以成型出凹凸不平的指纹纹路呢？经过大量测试发现，只要调整指纹纹路的粗细和强光的功率，完全可以满足假指纹制作的精度要求。
我们以图21中的指纹图像作为样本，尝试制作指纹印章。具体的细节出于安全目的本文就不详述了。我们可以看到，使用这种方法生成的指纹印章如果再沾上些印泥，印出来的指纹图像可以和实际用手指印生成的指纹图像相比十分相似，甚至很难做区分，存在很高的合同欺诈等风险。如图28所示（如果不告诉大家，大家会发现左边的那个指纹是用印章印出来的吗？）
图 28 用指纹印章伪造真实指纹图像
指纹印章的测试证明了光敏方法可以生成精度较好的指纹模型，可以得到了和原指纹纹理一样的具有凹凸不平的假指纹模型。
这种方案的优点如下：
  * 成型快，瞬间成型（小于一秒），优于紫外线腐蚀照射等长时间等待
  * 精度高，完全满足指纹识别需求
  * 成本低（耗材一次成本不超过5角，辅助设备生活中常见：激光打印机、普通闪光灯、透明纸、玻璃板）
经测试，制作出来的假指纹可以顺利解锁智能门锁、考勤、门禁等光学指纹模块，但对电容指纹模块似乎没有效果。回想之前我们通过滴蜡模具做的假指纹，是可以通过电容模块的，同时具备导电的特性。所以我们光敏成型的假指纹如果需要通过电容模块，必须具备导电性，也就是需要在凹凸不平的整个表面覆盖一层导电材料，同时不影响本身纹理。这种材料可能是一种粉末、或是液体状的。
我们首先想到的是铅笔粉，容易获取到同时具有导电特性。经测试，如我们所料，在抹上一层均匀的铅笔粉末后，假指纹模型可以顺利的通过验证。但是这种方法的成功率较低（与无法均匀覆盖有关），同时发现测试两次以后，由于粉末掉落，导致失去导电性。但是这种方式证明了我们的方向是正确的，后续又测试了几种材料，最终发现一种导电液体可以很好的在表层形成均匀的导电膜，而且晾干后会一直覆盖在表面不易脱落。其成本也很低廉。
#### 4 假指纹问题受影响统计
至此，我们完成了在已有目标指纹图像的前提下，顺利的解锁了目标设备（包括光学、电容传感器）。为了证明指纹生物特征安全风险的严重性、广泛性，我们做了一系列测试和统计，统计结果显示
**市面主流的指纹识别方案均受假指纹问题的影响**
。我们希望通过对主流手机假指纹风险进行测试，并基于这些较为全面的测试结果，让传感器生产商、手机厂商直观的看到这种安全风险广泛的受影响面，以及当前每种识别方案存在的具体问题。
如下是统计详情：
##### 4.1 手机常见指纹识别方案
我们对常见的手机指纹识别方案进行了调研，发现市面上主要有：
  * AuthenTec方案（苹果已经收购该公司，主要提供给I系列手机使用）
  * FPC方案（主流方案，早期Android手机大量采用，当前出货量级依然top2）
  * 汇顶方案（汇顶科技是近来新起之秀，国内多款畅销、旗舰手机均有使用）
表格 手机常见指纹识别方案
##### 4.2 假指纹问题统计结果
我们针对每一种方案，均挑选了几款代表机型进行测试验证。得益于兄弟团队移动安全部门的设备支持，所测试手机基本覆盖了国内能买到的各家旗舰/最新款。
统计目标：测试统计各手机厂商旗舰型号、广泛使用型号手机，使用假指纹能通过指纹验证的情况。
步骤：
  * 首先制备出目标手指（假定右手食指）的假指纹模型（这里我们直接选取传感器间接获取指纹图像的方法），同时进行导电处理，待用
  * 取各厂家型号手机，分别仅注册录入一枚固定手指作为屏幕解锁认证。确认真实手指可以顺利解锁
  * 分别测试在锁屏状态下，使用假指纹模型解锁的情况
表格 受影响品牌统计结果
注：FPC是著名指纹设备和解决方案提供商FingerPrint Cards 公司的系列产品名称，广泛嵌入在各家Android手机的指纹解锁模块中。
演示视频：