### 优化后的文本

#### 图3: 2003年8月17日的数据集结果
- **图(a)** 显示了估计误差的比较。
- **图(b)至(d)** 展示了在不同路由优化方案下的最大网络利用率。注意，(b)至(d) 的 y 轴都按相同的比例缩放，使得 InvCap 权重的最大利用率 (MMU) 为 100。

#### 不同路由优化方法的说明
- **InvCap 权重**: 在没有其他网络信息的情况下进行的一种合理的优化尝试。
- **MPLS 和 MPLS* 优化**: 都是针对给定流量矩阵最优地最小化最大利用率。
- **真实流量矩阵**: 将上述优化算法应用于真实的流量矩阵元素。

**图3(c)** 展示了每小时的最大利用率，在不同的路由方案下：
- '×' 表示最佳可能的路由，即应用 MPLS 优化器到真实流量的结果。
- '+' 表示使用真实流量矩阵进行 OSPF 优化的结果。
- 方块表示使用逆容量 OSPF 权重的结果。
- 圆圈表示使用 OSPF 优化估计流量矩阵（通过 tomogravity 方法）得到的权重应用于真实流量矩阵的结果。

从图3(c)中可以看出，OSPF 优化算法 ('+' 标记) 在大多数情况下非常接近于最佳可能解决方案 ('×' 标记)，并且始终显著优于默认的 InvCap 权重。此外，从估计流量矩阵找到的权重 ('o' 标记) 仅略逊于从真实流量矩阵找到的权重。事实上，如表1所示，即使 OSPF 优化器应用于 tomogravity 估计的流量矩阵，也能达到最优解的 11-12% 以内。这清楚地表明，从我们的特定流量工程角度来看，tomogravity 估计的流量矩阵中的误差并不重要，且可以使用 SNMP 链路统计来估计有用的流量矩阵。

另一个有趣的点是，尽管优化后的路由通常跟随平均流量的发展（如图3(a) 中的 '+' 标记），但 InvCap 路由则不如此。这表明流量不仅在一天内上下波动，还以影响 InvCap 的方式移动，而这些变化可以通过优化器适应。

#### 进一步的优点
我们注意到许多上述结果与 [7, 12] 报告的结果相似，但主要区别在于权重优化是基于估计的流量矩阵进行的，而在真实流量矩阵上进行测量，从而为我们提供了关于估计流量矩阵操作价值的反馈。

与之前所有关于 OSPF 优化的工作相比，另一个非常重要的区别是我们的结果基于实际运营网络的测量数据。最接近这一点的是 [7] 中使用 AT&T WorldNet 主干网和预测需求的工作。直到最近，大规模流量矩阵的测量才变得可能。因此，本文的一个次要优点是用真实数据证实了之前的权重优化工作。

### 实际考虑
虽然上述结果显示 OSPF 优化与 tomogravity 估计一起工作得很好，但在任何方法被认为是实用之前，仍有许多需要考虑的问题。本节将讨论其中的一些问题。

#### 更快的 OSPF 优化
OSPF 优化算法相当快速——在当前网络上运行大约需要 330 秒（对于图3中的 5000 次迭代，在 Sun 900 MHz Ultrasparc-III Copper 处理器上）。然而，当应用于真实数据时，该优化算法的大部分好处在早期就已经显现 [7, 12]。值得测试的是，当使用估计的流量矩阵时是否也是如此。确实如此，如图4所示，该图展示了经过 5000 次迭代和 1000 次迭代后权重的结果。由于迭代次数减少五倍，最大利用率的相对增加始终低于 5%。相比之下，1000 次迭代的时间仅为 5000 次迭代时间的约五分之一。

**图3(d)** 显示了相同的最优和 InvCap 结果，但将其与使用估计数据的 MPLS 和 MPLS* 优化进行了比较。需要注意的是，在一种情况下，使用 MPLS 优化的结果比图表所能显示的糟糕得多。根据表1，它偏离了 400 倍，并且更详细的调查显示这是由于环路造成的（参见 §2.1）。MPLS* 优化器避免了这个问题，但给定 tomogravity 估计，它仍然比 OSPF 优化器远离真实最优值两倍。因此，我们有一个强有力的反例，反驳了我们简单的假设：在给定真实流量时表现最好的优化方法在估计数据上也会表现最好。

#### 全局优化
频繁更改 OSPF 链路权重是非常不理想的。除了对网络管理复杂性的增加外，每次更改后 OSPF 路由至少需要几秒钟才能重新收敛。虽然这看起来很短，但在一个每天承载数百太字节流量的大规模网络中，每小时更改 OSPF 路由可能会导致每天损失 100 GB 或更多的流量。

然而，可以使用上述优化方法计算出一整天 24 个一小时流量矩阵的最佳路由。更具体地说，在 [12] 中描述了一种技术，该技术寻求一组适用于多个需求矩阵的全局权重设置，从而为所有需求矩阵获得良好的最大利用率。我们将此技术作为黑盒应用。这提供了另一个有趣的测试，以了解流量矩阵估计的效果如何。我们从一天的 tomogravity 估计流量矩阵中计算出这样一组权重，然后确定这些权重在使用真实流量矩阵时每小时的表现。图5展示了这些结果。

**图5** 显示了 24 小时期间的全局优化。再次，十字架代表每个一小时数据集的最佳解决方案，方块代表逆容量权重。点和菱形分别代表从真实和估计流量矩阵集合中计算出的全局最优权重，应用于每个一小时流量矩阵。

该图还给出了 24 小时内真实流量矩阵的优化结果以及每小时的最优值。估计和真实流量矩阵的结果非常好，甚至与每小时的最优值相比也是如此。与后者相比是不公平的，因为优化单个小时比全天更容易。我们使用它们而不是全局最优 MPLS 解决方案，因为全局最优 MPLS 解决方案的计算成本非常高（涉及数千万变量和数亿约束）。另一方面，OSPF 优化算法仍然相当快速。当优化 24 个流量矩阵时，速度会显著减慢，运行 5000 次迭代大约需要 6500 秒，但这实际上比单独优化每小时的速度要好，减少了整个计算量。

**表2** 总结了结果，并与前一节的结果进行了比较。我们可以看到，全局解决方案在性能上非常接近个体解决方案。

#### 预测性优化
如 §6.2 所述，频繁更改链路权重是高度不理想的。在前一节中，我们展示了可以导出一组适用于一整天流量矩阵的权重。问题来了：“需要多久更改一次这些权重？”显然，答案是不超过一天一次。然而，如果希望更改频率更低，我们必须关心今天的权重在未来的表现，即优化权重的预测强度。

这是一个比我们迄今为止考虑的问题更难的问题，因为任何大型运营网络都在不断变化：新的链路被添加，旧链路被重新安置或退役。请注意，在我们的数据集中，我们每隔 24 小时获取一次路由和拓扑信息，因此在前面的例子中，网络在 24 小时期间看似不变，但实际上可能已经发生变化。因此，即使是 24 小时全局优化，估计的权重也必须对网络变化具有鲁棒性。

显然，在一个完整的网络路由优化系统中，会对新链路的权重给予仔细考虑，并在网络拓扑发生变化时进行某种调整。然而，我们将考虑一个非常简单的情况，即为新链路分配最大的可能权重（使其成本最大化），从而只在先前存在的网络上进行路由。这显然是次优的，但我们将会展示，权重优化算法仍然表现良好。

**图6(a)** 显示了将 2002 年 7 月 1 日估计流量矩阵的全局优化权重应用于 2002 年 7 月 1 日至 8 日一系列天的真实流量的结果。我们选择这个时间段是因为直到 8 日才有主干网变化，当时发生了一个大的链路变化。为了比较，**图6(b)** 使用相同的 y 轴比例显示了逆容量加权的结果。

结果显示，该方法一致且显著优于逆容量加权，尽管使用了为不同日期优化的权重。尽管流量矩阵发生了变化，这种变化通常表现出强烈的周变化和日变化。最值得注意的是，在周六 7 日午夜至凌晨 1 点之间，流量行为发生了突然变化，导致逆容量加权下的最大利用率很高（图6(b) 中的第一个十字架）。尽管发生了这种突然的变化，该方法仍然表现得非常好，将最大利用率降低了近 50%。

结果还显示，逆容量加权的性能在一周内变化很大。由于我们知道在网络在 8 日之前没有变化，这些变化必定是由流量矩阵的变化引起的。例如，由于流量的每周周期，或者可能是由于边界网关协议 (BGP) 政策的变化，控制了边缘的大部分路由。