## 冷启动 {#06.html#-}我想，你已经想到了，推荐系统冷启动问题可以用 Bandit 算法来解决一部分。大致思路如下：1.  用分类或者 Topic    来表示每个用户兴趣，我们可以通过几次试验，来刻画出新用户心目中对每个    Topic 的感兴趣概率。2.  这里，如果用户对某个 Topic    感兴趣，就表示我们得到了收益，如果推给了它不感兴趣的    Topic，推荐系统就表示很遗憾 (regret) 了。3.  当一个新用户来了，针对这个用户，我们用汤普森采样为每一个 Topic    采样一个随机数，排序后，输出采样值 Top N 的推荐    Item。注意，这里一次选择了 Top N 个候选臂。4.  等着获取用户的反馈，没有反馈则更新对应 Topic 的 b    值，点击了则更新对应 Topic 的 a 值。
## 总结 {#06.html#-}今天给你介绍了一种走一步看一步的推荐算法，叫做 Bandit 算法。Bandit算法把每个用户看成一个多变的环境，待推荐的物品就如同赌场里老虎机的摇臂，如果推荐了符合用户心目中喜欢的，就好比是从一台老虎机中摇出了金币一样。今天重点介绍的 Bandit 算法有汤普森采样，UCB 算法，Epsilon贪婪，并且用模拟的方式对比了它们的效果，汤普森采样以实现简单和效果显著而被人民群众爱戴，你需要时不妨首先试试它。同时，这里留下一个问题给你，今天讲到的 Bandit算法有哪些不足？欢迎留言和我一起讨论。![](Images/d3b48a2755db0a3707ef37007c2179c8.png){savepage-src="https://static001.geekbang.org/resource/image/87/b0/873b086966136189db14874181823fb0.jpg"}
# 【MAB问题】结合上下文信息的Bandit算法上一篇文章我说到，Bandit算法用的是一种走一步看一步的思路，这一点看上去非常佛系，似乎一点都不如机器学习深度学习那样厚德载物，但是且慢下结论，先看看我在前面介绍的那几个Bandit 算法。
## UCB 回顾 {#07.html#ucb-}这些 Bandit算法，都有一个特点：完全没有使用候选臂的特征信息。特征可是机器学习的核心要素，也是机器学习泛化推广的依赖要素。没有使用特征信息的 Bandit算法，问题就在于只能对当前已有的这些候选臂进行选择，对于新加入的候选只能从0 开始积累数据，而不能借助已有的候选泛化作用。举个例子，假如有一个用户是鹿晗的粉丝，通过 Bandit算法有两个鹿晗的广告得到展示，并得到了较好的收益。那么对于一个新的广告，如果具有鹿晗这个特征，直觉上前两个鹿晗广告的收益信息可以泛化到当前新广告上，新广告就不是完全从0 开始积累数据，而是有了一定的基础，这样的收敛会更快。UCB 和汤普森采样这两个 Bandit 算法在实际中表现很好。于是，前辈们就决定送UCB 去深造一下，让它能够从候选臂的特征信息中学到一些知识。UCB 就是置信上边界的简称，所以 UCB这个名字就反映了它的全部思想。置信区间可以简单直观地理解为不确定性的程度，区间越宽，越不确定，反之就很确定。1.  每个候选的回报均值都有个置信区间，随着试验次数增加，置信区间会变窄，相当于逐渐确定了到底回报丰厚还是可怜。2.  每次选择前，都根据已经试验的结果重新估计每个候选的均值及置信区间。3.  选择置信区间上界最大的那个候选。"选择置信区间上界最大的那个候选"，这句话反映了几个意思：1.  如果候选的收益置信区间很宽，相当于被选次数很少，还不确定，那么它会倾向于被多次选择，这个是算法冒风险的部分；2.  如果候选的置信区间很窄，相当于被选次数很多，比较确定其好坏了，那么均值大的倾向于被多次选择，这个是算法保守稳妥的部分；3.  UCB    是一种乐观冒险的算法，它每次选择前根据置信区间上界排序，反之如果是悲观保守的做法，可以选择置信区间下界排序。
## LinUCB {#07.html#linucb}"Yahoo!"的科学家们在 2010 年基于 UCB 提出了 LinUCB 算法，它和传统的 UCB算法相比，最大的改进就是加入了特征信息，每次估算每个候选的置信区间，不再仅仅是根据实验，而是根据特征信息来估算，这一点就非常的"机器学习"了。在广告推荐领域，每一个选择的样本，由用户和物品一起构成，用户特征，物品特征，其他上下文特征共同表示出这个选择，把这些特征用来估计这个选择的预期收益和预期收益的置信区间，就是LinUCB 要做的事情。LinUCB算法做了一个假设：一个物品被选择后推送给一个用户，其收益和特征之间呈线性关系。在具体原理上，LinUCB有一个简单版本以及一个高级版本。简单版本其实就是让每一个候选臂之间完全互相无关，参数不共享。高级版本就是候选臂之间共享一部分参数。先从简单版本讲起。还是举个例子，假设现在两个用户，用户有一个特征就是性别，性别特征有两个维度，男，女。现在有四个商品要推荐给这两个用户，示意如下。![](Images/2edd6861fb5b278607b9c095e3a8408a.png){savepage-src="https://static001.geekbang.org/resource/image/ea/4b/eae9254fef3cdfc681247f58fa740b4b.png"}两个用户就是 Bandit 算法要面对的上下文，表示成特征就是下面的样子。![](Images/698cbbe98a667efd3c54eb8a2738c25d.png){savepage-src="https://static001.geekbang.org/resource/image/d4/ae/d47f7f976d7a0fd651f8f4be67f8aeae.png"}每一次推荐时，用特征和每一个候选臂的参数去预估它的预期收益和置信区间。]{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[[[[x]{#07.html#MathJax-Span-4.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[i]{#07.html#MathJax-Span-7.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-6.mrow}]{#07.html#MathJax-Span-5.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 0.896em; height: 0px;"}]{#07.html#MathJax-Span-3.msubsup}[×]{#07.html#MathJax-Span-8 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[θ]{#07.html#MathJax-Span-10.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[j]{#07.html#MathJax-Span-13.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-12.mrow}]{#07.html#MathJax-Span-11.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.473em;"}]{style="display: inline-block; position: relative; width: 0.849em; height: 0px;"}]{#07.html#MathJax-Span-9.msubsup style="padding-left: 0.238em;"}]{#07.html#MathJax-Span-2.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.508em, 1003.01em, 2.779em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 3.014em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.409em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#07.html#MathJax-Span-1.mathstyle="width: 3.767em; display: inline-block;"}``{=html}[$x_{i} \times \theta_{j}$]{.MJX_Assistive_MathMLrole="presentation"}]{#07.html#MathJax-Element-1-Frame .MathJaxtabindex="0" style="position: relative;"mathml="xi×θj"role="presentation"}$$，这就是给男性用户推荐剃须刀，给女性用户推荐口红，即使是新用户，也可以作出比随机猜测好的推荐，再观察用户是否会点击，用点击信息去更新那个被推荐了的候选臂的参数。这里的例子还简化了一个地方，就是没有计算置信区间，这是 UCB的精髓。下面来补上。假如 D 是候选臂是候选臂在 m 次被选择中积累的特征，相当于就是 m条样本，特征维度是 d，所以 D 是一个矩阵，维度是 m x d。这 m 次被选择，每次得到用户的点击或者没点击，把这个反馈信息记录为一个 mx 1 的向量，叫做 C。所以这个候选臂对应的参数就是 d x 1 的向量，d就是特征维度数，记录为一个戴帽子的西塔，[]{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[[[[[[θ]{#07.html#MathJax-Span-19.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0.002em;"}[[\^]{#07.html#MathJax-Span-20.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0.096em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px;"}]{#07.html#MathJax-Span-18.munderover}]{#07.html#MathJax-Span-17 .mrow}]{#07.html#MathJax-Span-16.texatom}]{#07.html#MathJax-Span-15.mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.179em, 1000.47em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.356em;"}]{#07.html#MathJax-Span-14.mathstyle="width: 0.708em; display: inline-block;"}``{=html}[$\hat{\theta}$]{.MJX_Assistive_MathMLrole="presentation"}]{#07.html#MathJax-Element-2-Frame .MathJaxtabindex="0" style="position: relative;"mathml="θ^"role="presentation"}$$。按照 LinUCB 认为，参数和特征之间线性相乘就应该得到收益：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[D]{#07.html#MathJax-Span-24.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-27.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-28.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-29.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-26.mrow}]{#07.html#MathJax-Span-25.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-23.msubsup}[×]{#07.html#MathJax-Span-30 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[[[[[[θ]{#07.html#MathJax-Span-35.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-38.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-39.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-40.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-37.mrow}]{#07.html#MathJax-Span-36.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.473em;"}]{style="display: inline-block; position: relative; width: 1.838em; height: 0px;"}]{#07.html#MathJax-Span-34.msubsup}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1001.84em, 4.285em, -999.998em); top: -3.998em; left: 0em;"}[[\^]{#07.html#MathJax-Span-41.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0.661em;"}]{style="display: inline-block; position: relative; width: 1.838em; height: 0px;"}]{#07.html#MathJax-Span-33.munderover}]{#07.html#MathJax-Span-32 .mrow}]{#07.html#MathJax-Span-31.texatom style="padding-left: 0.238em;"}[=]{#07.html#MathJax-Span-42 .mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[C[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#07.html#MathJax-Span-44.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.75em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-47.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-48.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-49.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-46.mrow}]{#07.html#MathJax-Span-45.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.708em;"}]{style="display: inline-block; position: relative; width: 2.308em; height: 0px;"}]{#07.html#MathJax-Span-43.msubsup style="padding-left: 0.285em;"}]{#07.html#MathJax-Span-22.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.226em, 1009.18em, 2.638em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 9.179em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.232em; border-left: 0px solid; width: 0px; height: 1.532em;"}]{#07.html#MathJax-Span-21.mathstyle="width: 11.485em; display: inline-block;"}``{=html}[$$D_{m \times d} \times \hat{\theta_{d \times 1}} = C_{m \times 1}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#07.html#MathJax-Element-3-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="Dm×d×θd×1^=Cm×1"role="presentation"}$$$$ 你看 D 也知道，C 也知道，要求 []{.MathJax_Previewstyle="color: inherit; display: none;"}[``{=html}[[θ]{#07.html#MathJax-Span-52.mi style="font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-51.mrow}[]{style="display: inline-block; width: 0px; height: 2.308em;"}]{style="position: absolute; clip: rect(1.461em, 1000.47em, 2.449em, -999.998em); top: -2.304em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.056em; border-left: 0px solid; width: 0px; height: 1.003em;"}]{#07.html#MathJax-Span-50.mathstyle="width: 0.614em; display: inline-block;"}``{=html}[$\theta$]{.MJX_Assistive_MathMLrole="presentation"}]{#07.html#MathJax-Element-4-Frame .MathJaxtabindex="0" style="position: relative;"mathml="θ"role="presentation"}$$ ，这就很简单了。]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[[[[[[θ]{#07.html#MathJax-Span-59.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0.002em;"}[[\^]{#07.html#MathJax-Span-60.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0.096em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px;"}]{#07.html#MathJax-Span-58.munderover}]{#07.html#MathJax-Span-57 .mrow}]{#07.html#MathJax-Span-56.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.873em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-63.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-64.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-65.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-62.mrow}]{#07.html#MathJax-Span-61.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-55.msubsup}[=]{#07.html#MathJax-Span-66 .mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[(]{#07.html#MathJax-Span-67.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[D]{#07.html#MathJax-Span-69.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-72.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-71.mrow}]{#07.html#MathJax-Span-70.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.849em;"}[m]{#07.html#MathJax-Span-75.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-76.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-77.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-74.mrow}]{#07.html#MathJax-Span-73.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.6em, 4.144em, -999.998em); top: -3.668em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-68.msubsup}[)]{#07.html#MathJax-Span-79 .mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[−]{#07.html#MathJax-Span-82.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-83.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-81.mrow}]{#07.html#MathJax-Span-80.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 1.367em; height: 0px;"}]{#07.html#MathJax-Span-78.msubsup}[C[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#07.html#MathJax-Span-85.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.75em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-88.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-89.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-90.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-87.mrow}]{#07.html#MathJax-Span-86.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.708em;"}]{style="display: inline-block; position: relative; width: 2.308em; height: 0px;"}]{#07.html#MathJax-Span-84.msubsup}]{#07.html#MathJax-Span-54.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.226em, 1009.79em, 2.826em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 9.791em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.468em; border-left: 0px solid; width: 0px; height: 1.768em;"}]{#07.html#MathJax-Span-53.mathstyle="width: 12.238em; display: inline-block;"}``{=html}[$${\hat{\theta}}_{d \times 1} = (D_{m \times d}^{T})^{- 1}C_{m \times 1}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#07.html#MathJax-Element-5-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="θ^d×1=(Dm×dT)−1Cm×1"role="presentation"}$$$$但是由于数据稀疏，实际上求参数西塔时不会这样简单粗暴，而是采用岭回归的方法，给原始特征矩阵加上一个单位对角矩阵后再参与计算：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[[[[[[θ]{#07.html#MathJax-Span-97.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0.002em;"}[[\^]{#07.html#MathJax-Span-98.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0.096em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px;"}]{#07.html#MathJax-Span-96.munderover}]{#07.html#MathJax-Span-95 .mrow}]{#07.html#MathJax-Span-94.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.873em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-101.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-102.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-103.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-100.mrow}]{#07.html#MathJax-Span-99.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-93.msubsup}[=]{#07.html#MathJax-Span-104 .mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[(]{#07.html#MathJax-Span-105.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[D]{#07.html#MathJax-Span-107.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-110.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-109.mrow}]{#07.html#MathJax-Span-108.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.849em;"}[m]{#07.html#MathJax-Span-113.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-114.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-115.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-112.mrow}]{#07.html#MathJax-Span-111.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.6em, 4.144em, -999.998em); top: -3.668em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-106.msubsup}[D]{#07.html#MathJax-Span-117 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-120.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-121.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-122.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-119.mrow}]{#07.html#MathJax-Span-118.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-116.msubsup}[+]{#07.html#MathJax-Span-123 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[I[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#07.html#MathJax-Span-125.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-128.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-129.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-130.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-127.mrow}]{#07.html#MathJax-Span-126.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.426em;"}]{style="display: inline-block; position: relative; width: 1.791em; height: 0px;"}]{#07.html#MathJax-Span-124.msubsup style="padding-left: 0.238em;"}[)]{#07.html#MathJax-Span-132.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[−]{#07.html#MathJax-Span-135.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-136.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-134.mrow}]{#07.html#MathJax-Span-133.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 1.367em; height: 0px;"}]{#07.html#MathJax-Span-131.msubsup}[D]{#07.html#MathJax-Span-138 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-141.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-140.mrow}]{#07.html#MathJax-Span-139.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.849em;"}[m]{#07.html#MathJax-Span-144.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-145.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-146.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-143.mrow}]{#07.html#MathJax-Span-142.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.6em, 4.144em, -999.998em); top: -3.668em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-137.msubsup}[C[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#07.html#MathJax-Span-148.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.75em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-151.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-152.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-153.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-150.mrow}]{#07.html#MathJax-Span-149.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.708em;"}]{style="display: inline-block; position: relative; width: 2.308em; height: 0px;"}]{#07.html#MathJax-Span-147.msubsup}]{#07.html#MathJax-Span-92.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.226em, 1017.74em, 2.826em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 17.744em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.468em; border-left: 0px solid; width: 0px; height: 1.768em;"}]{#07.html#MathJax-Span-91.mathstyle="width: 22.214em; display: inline-block;"}``{=html}[$${\hat{\theta}}_{d \times 1} = (D_{m \times d}^{T}D_{m \times d} + I_{d \times d})^{- 1}D_{m \times d}^{T}C_{m \times 1}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#07.html#MathJax-Element-6-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="θ^d×1=(Dm×dTDm×d+Id×d)−1Dm×dTCm×1"role="presentation"}$$$$每一个候选臂都像这样去更新它的参数，同时，得到参数后，在真正做选择时，用面对上下文的特征和候选臂的参数一起。除了估算期望收益，还要计算置信区间的上边界，如果 x是上下文特征，则期望收益和置信上边界的计算方法分别是下面的样子。期望收益：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[[[r]{#07.html#MathJax-Span-159.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.43em, 4.144em, -999.998em); top: -3.998em; left: 0.049em;"}[[\^]{#07.html#MathJax-Span-160.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.045em; left: 0.049em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px;"}]{#07.html#MathJax-Span-158.munderover}]{#07.html#MathJax-Span-157.mrow}]{#07.html#MathJax-Span-156 .texatom}[=]{#07.html#MathJax-Span-161.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[x]{#07.html#MathJax-Span-163.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-166.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-165.mrow}]{#07.html#MathJax-Span-164.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.567em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-169.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-170.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-171.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-168.mrow}]{#07.html#MathJax-Span-167.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.37em, 4.144em, -999.998em); top: -3.668em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-162.msubsupstyle="padding-left: 0.285em;"}[[[[[[θ]{#07.html#MathJax-Span-176 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0.002em;"}[[\^]{#07.html#MathJax-Span-177.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0.096em;"}]{style="display: inline-block; position: relative; width: 0.567em; height: 0px;"}]{#07.html#MathJax-Span-175.munderover}]{#07.html#MathJax-Span-174.mrow}]{#07.html#MathJax-Span-173.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.873em, 1000.47em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-180.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-181.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-182.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-179.mrow}]{#07.html#MathJax-Span-178.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-172.msubsup}]{#07.html#MathJax-Span-155.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.226em, 1005.79em, 2.826em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 5.791em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.468em; border-left: 0px solid; width: 0px; height: 1.768em;"}]{#07.html#MathJax-Span-154.mathstyle="width: 7.249em; display: inline-block;"}``{=html}[$$\hat{r} = x_{d \times 1}^{T}{\hat{\theta}}_{d \times 1}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#07.html#MathJax-Element-7-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="r^=xd×1Tθ^d×1"role="presentation"}$$$$置信区间上边界：]{.MathJax_Preview style="color: inherit; display: none;"} {.MathJax_Display style="text-align: center;"}``{=html}[[[[[[[b]{#07.html#MathJax-Span-188.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.43em, 4.144em, -999.998em); top: -3.998em; left: 0.049em;"}[[\^]{#07.html#MathJax-Span-189.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.38em, 3.626em, -999.998em); top: -4.28em; left: 0em;"}]{style="display: inline-block; position: relative; width: 0.52em; height: 0px;"}]{#07.html#MathJax-Span-187.munderover}]{#07.html#MathJax-Span-186.mrow}]{#07.html#MathJax-Span-185 .texatom}[=]{#07.html#MathJax-Span-190.mostyle="font-family: MathJax_Main; padding-left: 0.285em;"}[α]{#07.html#MathJax-Span-191.mistyle="font-family: MathJax_Math-italic; padding-left: 0.285em;"}[[[[[x]{#07.html#MathJax-Span-195.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-198.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-197.mrow}]{#07.html#MathJax-Span-196.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.567em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-201.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-202.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-203.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-200.mrow}]{#07.html#MathJax-Span-199.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.37em, 4.144em, -999.998em); top: -3.668em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-194.msubsup}[(]{#07.html#MathJax-Span-204 .mostyle="font-family: MathJax_Main;"}[D]{#07.html#MathJax-Span-206 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[T[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.096em;"}]{#07.html#MathJax-Span-209.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-208.mrow}]{#07.html#MathJax-Span-207.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1000.57em, 4.144em, -999.998em); top: -4.327em; left: 0.849em;"}[m]{#07.html#MathJax-Span-212.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-213.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-214.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-211.mrow}]{#07.html#MathJax-Span-210.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.391em, 1001.6em, 4.144em, -999.998em); top: -3.668em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-205.msubsup}[D]{#07.html#MathJax-Span-216 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.8em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[m]{#07.html#MathJax-Span-219.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-220.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-221.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-218.mrow}]{#07.html#MathJax-Span-217.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.849em;"}]{style="display: inline-block; position: relative; width: 2.449em; height: 0px;"}]{#07.html#MathJax-Span-215.msubsup}[+]{#07.html#MathJax-Span-222 .mostyle="font-family: MathJax_Main; padding-left: 0.238em;"}[I[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.049em;"}]{#07.html#MathJax-Span-224.mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.155em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-227.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-228.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-229.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}]{#07.html#MathJax-Span-226.mrow}]{#07.html#MathJax-Span-225.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.426em;"}]{style="display: inline-block; position: relative; width: 1.791em; height: 0px;"}]{#07.html#MathJax-Span-223.msubsup style="padding-left: 0.238em;"}[)]{#07.html#MathJax-Span-231.mostyle="font-family: MathJax_Main;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.108em, 1000.28em, 4.379em, -999.998em); top: -3.998em; left: 0em;"}[−]{#07.html#MathJax-Span-234.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-235.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-233.mrow}]{#07.html#MathJax-Span-232.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -4.421em; left: 0.379em;"}]{style="display: inline-block; position: relative; width: 1.367em; height: 0px;"}]{#07.html#MathJax-Span-230.msubsup}[x]{#07.html#MathJax-Span-237 .mistyle="font-family: MathJax_Math-italic;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.438em, 1000.52em, 4.144em, -999.998em); top: -3.998em; left: 0em;"}[d[]{style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"}]{#07.html#MathJax-Span-240.mistyle="font-size: 70.7%; font-family: MathJax_Math-italic;"}[×]{#07.html#MathJax-Span-241.mostyle="font-size: 70.7%; font-family: MathJax_Main;"}[1]{#07.html#MathJax-Span-242.mnstyle="font-size: 70.7%; font-family: MathJax_Main;"}]{#07.html#MathJax-Span-239.mrow}]{#07.html#MathJax-Span-238.texatom}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; top: -3.856em; left: 0.567em;"}]{style="display: inline-block; position: relative; width: 1.932em; height: 0px;"}]{#07.html#MathJax-Span-236.msubsup}]{#07.html#MathJax-Span-193.mrow}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.967em, 1013.55em, 4.473em, -999.998em); top: -3.998em; left: 0.991em;"}−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: -0.092em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; font-family: MathJax_Main; top: -3.998em; left: 12.896em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 0.426em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 0.991em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 1.508em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 2.073em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 2.591em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 3.155em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 3.673em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 4.238em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 4.755em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 5.32em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 5.838em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 6.402em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 6.92em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 7.485em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 8.002em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 8.567em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 9.085em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 9.649em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 10.167em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 10.732em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 11.249em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 11.814em;"}[−[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="font-family: MathJax_Main; position: absolute; top: -3.998em; left: 12.332em;"}]{style="display: inline-block; position: relative; width: 13.555em; height: 0px;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(3.579em, 1013.55em, 3.908em, -999.998em); top: -4.845em; left: 0.991em;"}[[√]{style="font-family: MathJax_Size2;"}[]{style="display: inline-block; width: 0px; height: 4.002em;"}]{style="position: absolute; clip: rect(2.732em, 1001.04em, 4.802em, -999.998em); top: -3.998em; left: 0em;"}]{style="display: inline-block; position: relative; width: 14.591em; height: 0px;"}]{#07.html#MathJax-Span-192.msqrt}]{#07.html#MathJax-Span-184.mrow}[]{style="display: inline-block; width: 0px; height: 2.355em;"}]{style="position: absolute; clip: rect(1.085em, 1017.09em, 3.155em, -999.998em); top: -2.351em; left: 0em;"}]{style="display: inline-block; position: relative; width: 17.085em; height: 0px; font-size: 125%;"}[]{style="display: inline-block; overflow: hidden; vertical-align: -0.879em; border-left: 0px solid; width: 0px; height: 2.356em;"}]{#07.html#MathJax-Span-183.mathstyle="width: 21.367em; display: inline-block;"}``{=html}[$$\hat{b} = \alpha\sqrt{x_{d \times 1}^{T}(D_{m \times d}^{T}D_{m \times d} + I_{d \times d})^{- 1}x_{d \times 1}}$$]{.MJX_Assistive_MathML.MJX_Assistive_MathML_Blockrole="presentation"}]{#07.html#MathJax-Element-8-Frame .MathJaxtabindex="0" style="text-align: center; position: relative;"mathml="b^=αxd×1T(Dm×dTDm×d+Id×d)−1xd×1"role="presentation"}$$$$这两个计算结果都是标量数值。置信区间计算公式虽然看起来复杂，实际上反应的思想也很直观，随着被选择次数的增加，也就是m 增加，这个置信上边界是越来越小的。每一次选择时给每一个候选臂都计算这两个值，相加之后选择最大那个候选臂输出，就是LinUCB 了。刚才说到了岭回归（ridgeregression），这里多说一句，岭回归主要用于当样本数小于特征数时，对回归参数进行修正。对于加了特征的Bandit 问题，正好符合这个特点：试验次数（样本）少于特征数。信息量有点大，我在这里再一次列出 LinUCB 的重点。1.  LinUCB    不再是上下文无关地，像盲人摸象一样从候选臂中去选择了，而是要考虑上下文因素，比如是用户特征、物品特征和场景特征一起考虑。2.  每一个候选臂针对这些特征各自维护一个参数向量，各自更新，互不干扰。3.  每次选择时用各自的参数去计算期望收益和置信区间，然后按照置信区间上边界最大的输出结果。4.  观察用户的反馈，简单说就是"是否点击"，将观察的结果返回，结合对应的特征，按照刚才给出的公式，去重新计算这个候选臂的参数。当 LinUCB 的特征向量始终取 1，每个候选臂的参数是收益均值的时候，LinUCB就是 UCB。说完简单版的 LinUCB，再看看高级版的LinUCB。与简单版的相比，就是认为有一部分特征对应的参数是在所有候选臂之间共享的，所谓共享，也就是无论是哪个候选臂被选中，都会去更新这部分参数。``{=html}