提效阶段：基于 的线上协同运维⽀支持实时信息同步，解决系统和⼈人员快速膨胀导致复杂度指数级增⻓长的 问题。
起步阶段：通过告警模板快速构建预警能⼒力力 爆发阶段：通过告警集成管理理多种告警源 提效阶段：通过 ChatOps 实现“应急协同”
消息堆积量量超过 5w，持续时
间 2分钟，可能影响 xxxxxx
告警集成管理理
告警模板
通知 接⼿手 转交 修复 扩容
值班
主管 ChatOps 协同运维 已接⼿手，处理理中
升级
已扩容恢复
⾯面向业务场景的应⽤用可观测技术拓拓展
•
如何向上赋能业务，更更好的解决业务稳定性问题？
•
以业务场景为中⼼心的染⾊色链路路
•
⾯面向业务视⻆角的⾃自定义监控⼤大盘
•
保障业务安全的运⾏行行时⻛风险识别
以业务场景为中⼼心的染⾊色链路路
•
⽆无侵⼊入业务染⾊色
• RPC
将 流量量打上业务标签，染出不不同场景的业务链路路。
•
染⾊色规则动态下发、即时⽣生效，⽆无需修改代码或重启应⽤用。
•
Tail-based Sampling
•
逆向采样保证上游链路路完整性。
染⾊色规则
染⾊色标记 染⾊色标记
应⽤用1 应⽤用2 应⽤用3 应⽤用4 应⽤用5
逆向采样
采样决策点
⾃自定义监控⼤大盘
双⼗十⼀一实时监控⼤大盘
交易易笔数 w/s 各区域性能监控 Top 业务错误码
错误码 00:10 00:09 00:08
地域 耗时 成功率
Prometheus + Grafana = See what you want !
266 387 419
张家⼝口 496ms 99.9% 库存不不⾜足
上海海 488ms 99.9% 优惠失效 23 26 32 • Metrics 格式统⼀一，⽀支持 PromQL 语法
杭州 492ms 99.9% 下单超时 22 24 28
• 业务指标来源：⽀支持 Prometheus ⾃自定义 Exporter；APM 染⾊色链路路数据等。
⽀支付笔数 w/s
北北京 486ms 99.9% 下单失败 16 18 21
• 应⽤用指标来源：APM 探针，包括 HTTP/RPC/DB/Cache/MQ/JVM 等。
深圳 495ms 99.9% ⽀支付失败 2 0 4
⻘青岛 712ms 82.1% ⽀支付超时 1 0 2 • 中间件指标来源：Prometheus 云产品监控。
• 基础设施监控：Prometheus 容器器监控。
• Grafana ⾃自定义⼤大盘
核⼼心应⽤用A 核⼼心应⽤用B 核⼼心应⽤用C 核⼼心应⽤用D
限流 w/s 耗时 成功率 限流 w/s 耗时 成功率 限流 w/s 耗时 成功率 限流 w/s 耗时 成功率 • ⽀支持多种数据源，灵活定义监控⼤大盘。
中间件 & 基础设施监控
慢SQL 缓存命中率 消息堆积 配置推送时延 ⽹网络重传率 ……
保障业务安全的运⾏行行时⻛风险识别
“ ” DevSecOps
很多性能问题只是表象，背后其实是业务安全问题。⽐比如机器器被⼊入侵后执⾏行行 挖矿任务 ，处理理此类⻛风险的同学其实是同⼀一拨⼈人，承担了了 的职责。
RASP Runtime Application Self-Protection
⽬目前⽐比较流⾏行行的 （ ） 技术，可以实现应⽤用程序运⾏行行时攻击检测与⾃自我保护，是可观测探针技术在安全领域的延展。
功能强⼤大 性能优异 便便捷安全
0day CPU < 1%
防御 开销 代码⽆无侵⼊入
< 30M
攻击溯源 内存开销 软熔断逃⽣生
RT < 1ms
危险组件探测 观察模式
代码审计
IDC()
APPs Running Anywhere
漏漏洞洞定位分析
云原⽣生时代可观测技术的趋势与技术选型
•
基础软件架构
•
分布式云、混合云
• DevOps
容器器化、微服务、 成为主流
•
可观测技术趋势
•
标准逐渐成型
• OpenTelemetry Prometheus
技术栈逐渐收敛（ 、 ）
•
⾃自动诊断成为可能
•
监控逐渐⽴立体化
• eBPF
⽆无侵⼊入可观测技术逐渐成熟（ ）
•
去中⼼心化趋势
• Observability Federation
数据去中⼼心化（ ）
• ChatOps
协同去中⼼心化（ ）
容器器场景下的全景监控能⼒力力
•
多源数据接⼊入：覆盖从基础设施到应⽤用的全链路路数据
Prometheus Loki eBPF APM RUM
（ 、 、 、 、 、拨测等）
• 2D/3D
全⽅方位数据可视：⽀支持 拓拓扑全景展示，⽀支持端到端链路路
下钻分析。
•
快速问题发现：定时检查集群的资源状态，问题节点⾃自动上报。
THANKS
/
感谢聆听
-------- Q&A Section --------
StabilityGuide
GitHub
稳定性领域知识库： ，欢迎⼤大家参与共建！
1 0 1
附录 ：从 到 建设可观测体系
1. 异构应⽤用全链路路上下⽂文透传 2. 冷热数据按需存储，⼤大幅降低成本 3. 开源格式统⼀一，免费开箱即⽤用 4. 最佳实践沉淀，灵活扩展
前端 统⼀一监控
ARMS Trace Framework
CDN 探针 Grafana 统⼀一展示⼤大盘
TraceCtx
预置图表 ⾃自定义图表
Metrics 指标数据
全球部署
（K8S容器器/应⽤用基础指标免费）
Go 应⽤用
全托管免运维
采集上报
开源 SDK
统⼀一告警
TraceCtx
PromQL ⾃自定义告警
数据加⼯工
Nginx ⽹网关
告警模板 ChatOps
开源 SDK
Traces 链路路数据
开源标准
格式统⼀一 （调⽤用链基础采样免费）
热存储
⼆二次开发
TraceCtx 30分钟
Java 应⽤用 Java 应⽤用
开源数据标准，存储开放
TraceCtx
Java Agent
Java Agent
OpenAPI 数据投递
冷存储
30天
错慢精准采样
Logs ⽇日志数据
（⽇日志限额免费） 根因定位
冷热数据，按需存储，成本下降 3~10倍！
Application Insights ⾃自动诊断
Arthas 微服务/
单机诊断
数据库治理理
云组件（DB、Cache、MQ等）
2 ARMS APM
附录 ：阿⾥里里云 全球领先、国内第⼀一
2021 Magic Quadrant
Gartner APM
⼊入选 象限，国内唯⼀一云⼚厂商
Gartner APM
评价阿⾥里里云 ：
•
中国影响⼒力力最强：阿⾥里里云是中国最⼤大的云服务提供商，阿⾥里里云⽤用户可以使⽤用
云上监控⼯工具来满⾜足其可观测需求。
• Prometheus
开源集成：阿⾥里里云⾮非常重视将开源标准和产品（例例如 ）集成到其
平台中。
• APM APM
成本优势：与在阿⾥里里云上使⽤用第三⽅方 产品相⽐比，阿⾥里里云 产品具有
更更⾼高的成本收益。