Are We Really Safe? 
HACKING ACCESS CONTROL SYSTEMS 
Dennis Maldonado 
u  Security Consultant @ KLC Consulting 
u  Twitter: @DennisMald 
u  Houston Locksport Co-founder 
http://www.meetup.com/Houston-Locksport/ 
u  Rebooting HAHA! (Houston Area Hackers Anonymous) 
Agenda 
u  Physical Access Control System 
u  Linear Commercial Access Control Systems 
u  Attacks 
u  Local 
u  Remote 
u  Demo/Tools 
u  Device Enumeration Techniques 
u  Recommendations 
Physical Access Control Systems 
Physical Access Control 
What do they do? 
Limiting access to physical location/resource 
u  Secure areas using: 
u  Doors 
u  Gates 
u  Elevators floors 
u  Barrier Arms 
u  Access control systems 
u  Keypad Entry (Entry/Directory codes) 
u  Telephone entry 
u  Radio receivers for remotes 
u  Proximity cards (RFID) 
u  Swipe cards 
u  Sensors 
Physical Access Control 
How do they work? 
Where are they used? 
u  Use cases: 
u  Gated Communities 
u  Parking Garages 
u  Office Buildings 
u  Apartments 
u  Hotels/Motels 
u  Commercial Buildings 
u  Recreational Facilities 
u  Medical Facilities 
Doorking	
Chamberlain	
Sentex	
Li4Master	
Nortek	
  Security	
  &	
  Control/Linear	
  Controllers	
Linear Commercial Access Control 
Nortek	
  Security	
  &	
  Control/Linear	
  Controllers	
AE1000Plus	
AE2000Plus	
AM3Plus	
Linear Controller 
u  Commercial Telephone Entry 
System 
u  Utilizes a telephone line 
u  Supports thousands of users 
u  Networked with other controllers 
u  Can be configured/controlled 
through a PC 
u  Serial Connection 
Linear – TCP/IP Kit 
u  AM-SEK Kit (Serial-to-TCP) 
u  Converts Serial to Ethernet 
u  Allows Management over TCP/IP 
network 
u  Allows for remote management 
(over the internet) 
Linear – Typical Installation 
Serial  
Cable 
Ethernet 
Cable 
Management PC 
192.168.0.40 
AE1000Plus 
Controller 
Ethernet 
Cable 
Router/Switch 
192.168.0.0/24 
Software - AccessBase2000 
u  Add/remove users 
u  Entry codes 
u  Directory codes 
u  Cards 
u  Transmitters 
u  Manually toggle relays 
u  View log reports 
u  Communicates through serial 
u  Requires a password to 
authenticate 
PC to Controller Communication 
u  Request 
u  5AA5000A1105010008000000CB97 
u  Response 
u  Acknowledged:
5AA50004110C4625 
u  Not Acknowledged: 
5AA50005110D024C23 
u  Invalid Checksum: 
5AA50005110D017EB8 
u  No response (not authenticated) 
5AA5000A11013635343332319A71 
5AA50005110D024C23 
5AA5000A11013635343332319A71 
Packet 
Header 
Minimum 
Data Length 
Maximum 
Data Length 
Data 
(Hex) 
Checksum 
Net 
Node 
Command 
{ 
    Password    = 01 
    Poll Status = 02 
    Poll Log    = 03 
    Command     = 04 
    Time        = 05 
    Put Flash   = 06 
    … 
} 
String is Hex Encoded 
Attacks 
LOCAL AND REMOTE ATTACKS 
So how do we target these 
controllers? 
u  Physical Access 
u  Local Programming 
u  Serial port inside the controller 
Local Attacks 
AE-500 – Default Password 
u  Hold 0 and 2 on the keypad 
u  Type the default password: 
123456# 
u  Input the commands to add a 
new entry code 
u  31#9999#9999#99# 
u  Type in your new code (9999) 
u  Access Granted! 
123456#31#9999#9999#99# 
Enter 
Programming 
Mode 
Enter Entry 
Code  
Confirm 
New Entry 
Code 
Exit 
Programming 
Mode 
New Entry Code 
Master Key 
u  Same key for all AE1000plus, 
AM3plus controllers 
u  Purchase them from a supplier or 
on eBay 
u  Or just pick the lock 
u  Full access to the device 
Physical Access 
u  Manual Relay Latch buttons 
u  Toggle Relay 
u  Lock their state 
Physical Access 
u  Manual Relay Latch buttons 
u  Toggle Relay 
u  Lock their state 
u  Programming buttons 
u  Program device locally 
u  Erase Memory 
u  Active Phone Line 
u  Serial connection to the controller 
Tamper Monitoring? 
u  Magnetic tamper switch inside 
enclosure 
u  No active alerts 
u  Can be bypassed by placing a 
magnet on the outside of the 
enclosure 
So how do we target these 
controllers? 
u  Physical Access 
u  Local Programming 
u  Serial port inside the controller 
So how do we target these 
controllers? 
u  Physical Access 
u  Local Programming 
u  Serial port inside the controller 
u  Internal Network Access 
u 
IP of Serial to TCP device 
u  TCP Port 4660 
u  External Network Access 
u  IP of Serial to TCP device 
u  TCP Port 4660 open to the internet 
5AA5000A11013635343332319A71 
5AA50005110D024C23 
Bad Guy 
5AA5000A11013635343332319A71 
5AA50005110D024C23 
192.168.0.32:4660 
74.12.x.x:4660 
Remote Attacks 
Demo 
Brute-force attack 
u  No rate limiting 
u  No password lockout 
u  Small key space 
u  Exactly 6 characters 
u  Numeric only 
u  Scriptable 
Demo 
No Password Necessary 
u  Authentication not enforced! 
u  Send unauthenticated commands 
u  Any commands will execute 
u  May not get any confirmation 
data 
Hacker 
Raw Connection 
AE1000Plus 
Controller 
Open Doors Remotely 
u  Send one simple command 
u 
5AA5000A1105010000080000E88D 
u  Triggers a relay for 2 seconds thus 
opening a door or gate 
u  Great for movie style scenes 
5AA5000A1105010000080000E88D 
Hacker 
Raw Connection 
AE1000Plus 
Controller 
Door 1 
Access 
Granted 
Lock Doors Open/Closed 
u  Keeps Doors/Gates open 
or closed 
u  Will not respond to user 
input (RFID cards, remotes, 
etc) 
u  Persist until manually 
unlocked or rebooted 
Delete Logs From The Controller 
u  Controller keeps logs of events 
u  Downloading logs deletes them 
from the controller 
u  Hide evidence of entry or 
tampering 
Change the Password 
u  Upload configuration settings 
u  Change password without 
needing the previous password 
u  Normal functionality remains 
u  Upload other configuration 
changes 
Denial of Service 
u  Fake database update will disable 
controller connected to or 
rebooted 
u  Overwrite device firmware 
u  Lock relays to prevent access 
ACAT – Access Control Attack Tool 
Demo 
Locating Controllers 
Device Enumeration Techniques 
u  Scan the network 
u  Look for any COM port redirectors 
u  Default port = TCP 4660 
u  Send broadcast packet to UDP 55954 
u  Devices will respond 
u  Send a password request string to port 
4660 
u  5AA5000A11013635343332319A71 
u  5AA50004110C4625 
u  5AA50005110D024C23 
5AA5000A11013635343332319A71 
5AA50005110D024C23 
UDP Broadcast 
Broadcast 
Response 
Client 
Response 
Demo 
Recommendations 
u  Always change the default password 
u  Change physical locks 
u  Use a direct serial connection 
u  If networked, utilize authentication 
u  Resist opening the controller to the 
internet 
Final Thoughts 
u  Other vendors 
u  Ongoing research 
u  Tool – More work is needed 
u  Tool located on https://github.com/linuz/Access-Control-Attack-Tool 
u  It’s currently just a prototype 
u  Continue updating it/take it out of “PoC mode” 
u  Working on an Nmap script 
u  Slides uploaded to SlideShare  
 www.slideshare.net/DennisMaldonado5 
Questions? 
u  If you have any questions, you can: 
u  Twitter: @DennisMald 
u  Find me here at DEFCON23 
u  Email me at: PI:EMAIL