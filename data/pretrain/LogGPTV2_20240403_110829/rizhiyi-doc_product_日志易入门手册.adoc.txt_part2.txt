==== 高级搜索
日志易的高级搜索模式与普通搜索可以通过查看是否包含管道符“|”来区分。主要功能为实现较复杂的关联分析，建立新字段，对字段进行数值运算等。一般应用在“统计菜单视图”内置的模式选择和参数配置无法满足用户需求时。如下语句：
[source,bash]
* AND appname:logsample AND tag:demo | stats count() by apache.status
管道符“|”后stats为统计指令，其后跟的“count（）”为stats的统计函数，用来返回对象字段出现的次数。此句中表示返回apache.status出现的次数。
更多关于高级搜索的资料可以参考《搜索指令参考》与《搜索实例手册》。
== 查询结果的保存
保存按钮（对应图中序号7），提供三种保存格式，分别为：已存搜索，离线任务，监控。针对不同的保存类型，我们以下将逐类讲解下不同类型的保存配置及用处。
=== 已存搜索
若您认为当前的查询语句在日后将会经常用到，为了节省时间，减少反复输入的次数，可在此处“新建搜索”，下次调用即可直接通过单击右侧的“已存搜索”按钮，在“已存搜索列表”的弹框界面，查找到上次保存好的查询语句。
=== 离线任务
对于未能在短时间完成的流式任务，可存为“离线任务”。查看保存过的离线任务可通过左侧导航栏的“设置”，进入“数据管理”下的“离线任务”。更多详细内容参考《日志易使用手册》的“3.2.1离线任务”章节。
=== 监控
针对以上样例，假设一种场景：您非常关注是否有网页被永久移动到新位置的情况，并希望有该情况时可以快速获悉。由于这种情况下服务器会返回一类响应，对应的状态码为301，因此您可以在搜索页面搜索当状态码（状态码字段名为apache.status）为301的日志信息后，将搜索语句存为监控的查询语句，来实现该场景的需求。
在搜索框以下命令：
[source,bash]
* AND appname:logsample AND tag:demo AND apache.status:301
点击“新建监控”将会使页面跳转到监控的新建配置界面，并自动把原页面的查询语句粘贴到“搜索内容”一栏里。根据您对情况的判断，设定执行频率和触发报警的条件。
如下图配置参数，此处我们在选择监控方式时采用的较简单的“事件数监控”，即基于搜索结果的数量的监控。该搜索语句于每分钟执行一次（统计一次状态码为301的日志数量）。当1分钟内搜索结果计数超过了10时触发高级告警，当数量在6-10的范围内时触发中级告警，当数量在2-5的范围内时触发低级告警。
image::images/apache-alert-example.png[]
关于其他监控类型的讲解请参考《日志易监控告警手册》的“监控类型”章节。
== 统计
上一节的监控解决了用户获得信息的及时性后，您可能还想获得更直观的数据分析，也就涉及到将结果用统计视图和报表的形式展示出来的功能，此时应跳至“统计”界面（对应序号8）。
=== 统计视图
在日志易中，统计视图分为两种：统计菜单视图和高级搜索视图。
==== 统计菜单视图
例如，用户想直观的了解到状态码为301的日志占其他所有状态码的日志的比重，仍然可以使用最初查询样例文件的命令行，具体步骤如下：
1. 输入命令行查询日志 `* AND appname:logsample AND tag:demo`
2. 点击“统计”，即可切换到统计视图的配置界面
3. 从最左侧栏选择图表格式为“字段值分类”
4. “字段”选择用户想了解的状态码，也就是选择字段“apache.ua”
5. “展示方式”选择“饼图”为视图类型
6. “top”可直接用默认值5，表示最多展示由大到小排序后的前5个对象
7. 结果如下图所示：
+
image::images/visualize-top.png[]
8. 若有保存记录的需要，点击“保存为”按钮，具体操作见后续章节。
另外10种类型的统计功能视图可参考《使用手册》的“4.1统计菜单视图”。
==== 高级搜索视图
与以上统计菜单视图相比，构建可视化图表更有效率的方法是：在输入查询语句时，使用带有管道符“|”等的高级查询语句，如下：
[source,bash]
* AND appname:logsample AND tag:demo | stats count() by apache.status
日志易可区分高级搜索与普通搜索，输入以上命令点击回车以后，页面会直接切换到统计页面的默认视图，也就是以二维表格的形式展示查询结果。若用户仍然想看到饼图的可视化图形，则选择“类型”后在“维度”一栏里找到饼图的对应项，并自动生成图表。
对于自动生成的图表有时需要用户打开“设置”里再次确认，关于更多对多种可视化形态的支持请参照《使用手册》的“4.2 高级搜索视图”。
image::images/apache-stats-pie.png[]
=== 保存
在最后，可视化图像形成时可以选择三种保存方式，分别是“趋势图”，“定时任务”，和“图片”。
image::images/apache-stats-pie-action.png[]
==== 趋势图
保存后的趋势图主要应用在两个地方：“仪表盘”和“报表”。当用户想将以上视图与其他需求的统计图表放在同一界面方便查看时，可以用到“仪表盘”模块来实现；当用户想定时的接收到关于该内容的报表，并且通过更方便方式查看日志信息，比如以邮件的形式查看时，可以用“报表”模块来制作报表，并按时发送至指定邮箱。
在日志易中，趋势图既可以作为仪表盘内的某一特定图表，也是一种报表元素。保存为趋势图后，仪表盘和报表对趋势图的引用在下文有详细的讲解，配置与应用方式请参考下文的第六章与第七章。
==== 定时任务
若您不希望一直收到告警提示，但又想知道一段时间内状态码为301的情况变化，可以通过存为“定时任务”来实现。关于“定时任务”的相关操作如下：
* 保存为定时任务
在日志易中，可以存为定时任务的环境包括两种。一种是我们提到的高级搜索保存为定时任务，输入我们上文使用到的搜索语句：
[source,bash]
* AND appname:logsample AND tag:demo | stats count() by apache.status
点击“搜索”按钮后跳转到统计表格界面如下：
image::images/apache-stats-table-action.png[]
点击定时任务后同上，定义名称，标签，以及执行频率和开始时间，可以看到此时定时任务将搜索框的高级搜索语句直接调用作搜索内容，如下图所示.
image::images/apache-schedule-new.png[]
另一种是我们在“5.1统计菜单视图”讲到的，在一般的统计菜单视图内，手动完成可视化图表的参数配置后，单击“保存为”按钮，并选择定时任务。可以在保存流程中看到，日志易在存储过程中会自动形成一段高级搜索的语句，用在之后定时的执行过程中。用户再定义好名称，标签，还有执行频率后，单击“保存”，即完成了此定时任务的保存。
image::images/apache-schedule-quick.png[]
* 查看定时任务
首先点击页面上方导航栏内的“定时任务“进入定时任务页面，打开定时任务列表。
定时任务总数量较多时，可以借助标签和关键词查询来定位已保存的定时任务；若不再需要定时任务，除了删除，还可通过最左侧的开关按钮，暂时禁用定时运行搜索内容的功能，如下图：
image::images/apache-schedule-list.png[]
* 查看任务执行记录
在列表页单击任务名称，可以查看所有执行过的任务记录。点击“查看”，对正常运行结果，可以在搜索页打开对应的结果记录。对异常运行结果，在记录页会展示后台异常报错。
==== 图片
若您只是想把最终的图表保存下来，并不需要后期应用或者改动，可直接通过此选项，以图片的格式保存到本地，
== 仪表盘
继上文对仪表盘的描述，主要目的是为了方便用户查看日志的统计情况。
=== 新建仪表盘
下面我们详细描述了新建仪表盘以及标签页，并插入趋势图的步骤：
1. 趋势图保存：在保存时选择“趋势图”为存储类型，在配置框中命名为“status_pie”并添加对应标签。
+
image::images/apache-trend-new.png[]
2. 进入仪表盘列表页面：通过页面上方导航栏内的“仪表盘”
3. 新建仪表盘：点击右上角的“新建”按钮，为新建的仪表盘命名并添加标签。
+
image::images/dashboard-new.png[]
4. 添加标签页：在仪表盘的首页面搜索新建好的仪表盘，单击仪表盘的名称，进入仪表盘的编辑页面。若是首次进入仪表盘，会跳出弹框“新建标签页”，提醒您为新标签页命名。设置好后您就可在新建的标签页内添加视图啦。
+
image::images/dashboard-tab-new-tag.png[]
+
若需添加多个标签页，在靠近顶部的标签栏有添加按钮，点击按钮跳出弹框同上图，产生一个新的仪表盘标签页。
5. 新建图表：点击添加按钮，选择“添加图表”项后会跳出趋势图的选择列表。通过右侧删除按钮可以将趋势图从系统中删除。当趋势图较多时，可直接根据标签或关键字来过滤查询。
+
“添加过滤项”属于相对复杂的操作，就不在《入门手册》更多赘述，详情请见《使用手册》中的“8.2.2添加过滤项”。（因为不同仪表盘可能会使用重复的图表，所以建议用户在图表内的设置项内命名明确的标题。）
+
image::images/dashboard-add-trend.png[]
6. 点击“确定”按钮后，趋势图就会成功添加到仪表盘界面。如下图：
+
image::images/apache-dashboard.png[]
=== 修改仪表盘
* 时间控制：
1)  用户可通过过滤按钮来控制标签页内所有图表的时间范围，做统一处理。
image::images/dashboard-global-timerange.png[]
2)  您也可以单独指定某个图表的查询时间范围，图表框内附带的工具栏提供针对该图表时间控制功能， 如下图：
image::images/dashboard-widget-timerange-setting.png[]
* 图表配置：仪表盘还通过各图表内部的设置按钮，对数据查询指令与可视化图表的类型及配置参数进行修改，如下图。关于钻取配置请参考《使用手册》的“8.2.3 钻取配置”。
image::images/apache-dashboard-widget-setting.png[]
“仪表盘”界面的其他功能介绍，可参见《使用手册》的第8章“仪表盘”。
== 报表
报表元素即趋势图，关于报表页面内趋势图的应用可参见以下步骤：
1. 趋势图保存：同仪表盘中趋势图的保存。
2. 新建报表：同样也是从导航栏的“报表”标签进入报表的列表页面，并点击右上角的“新建”按钮。
3. 报表配置：依次配置好报表参数。如下图所示，注意邮件主题按照提示格式填写，并在“执行计划”处填入参数，对邮件的发送频率进行配置。
+
image::images/report-edit.png[]
4. 添加趋势图：点击下一步，选择加入报表的趋势图。如果报表是PDF类型，还可以选择每页内容的趋势图布局安排。
+
image::images/report-buju.png[]
5. 保存报表：点击保存，即完成报表制作。该邮箱会在设定时间收到日志易发送的报表邮件，报表会以PDF格式加在附件中。
6. 查看已生成报表：日志易支持界面查询完整的报表生成历史，点击右上角按钮“已生成报表”打开记录页面。点击文件名，还可以下载单次报表生成的PDF结果到本地。
7. 报表列表：在列表页，您不仅可以更改设置信息，也可以直接删除报表。若您不想要再接受相关邮件，可在列表页将对应报表开关关闭即可。
若想了解更多关于“报表”的配置内容，请参考《使用手册》的“7.报表”。