title:Prefix Top Lists: Gaining Insights with Prefixes from Domain-based
Top Lists on DNS Deployment
author:Johannes Naab and
Patrick Sattler and
Jonas Jelten and
Oliver Gasser and
Georg Carle
Prefix Top Lists: Gaining Insights with Prefixes from
Domain-based Top Lists on DNS Deployment
Johannes Naab
Technical University of Munich
PI:EMAIL
Patrick Sattler
Technical University of Munich
PI:EMAIL
Jonas Jelten
Technical University of Munich
PI:EMAIL
Oliver Gasser
Technical University of Munich
PI:EMAIL
Georg Carle
Technical University of Munich
PI:EMAIL
ABSTRACT
Domain-based top lists such as the Alexa Top 1M strive to portray
the popularity of web domains. Even though their shortcomings
(e.g., instability, no aggregation, lack of weights) have been pointed
out, domain-based top lists still are an important element of Internet
measurement studies.
In this paper we present the concept of prefix top lists, which
ameliorate some of the shortcomings, while providing insights into
the importance of addresses of domain-based top lists. With prefix
top lists we aggregate domain-based top lists into network prefixes
and apply a Zipf distribution to assign weights to each prefix. In
our analysis we find that different domain-based top lists provide
differentiated views on Internet prefixes. In addition, we observe
very small weight changes over time. We leverage prefix top lists
to conduct an evaluation of the DNS to classify the deployment
quality of domains. We show that popular domains adhere to name
server recommendations for IPv4, but IPv6 compliance is still lack-
ing. Finally, we provide these enhanced and more stable prefix
top lists to fellow researchers which can use them to obtain more
representative measurement results.
CCS CONCEPTS
• Networks → Network measurement.
KEYWORDS
Prefix Top Lists, Prefix Ranking, Internet Top Lists, Internet Mea-
surement
ACM Reference Format:
Johannes Naab, Patrick Sattler, Jonas Jelten, Oliver Gasser, and Georg Carle.
2019. Prefix Top Lists: Gaining Insights with Prefixes from Domain-based
Top Lists on DNS Deployment. In IMC ’19: ACM Internet Measurement
Conference, October 21–23, 2019, Amsterdam, Netherlands. ACM, New York,
NY, USA, 7 pages. https://doi.org/10.1145/3355369.3355598
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
© 2019 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-6948-0/19/10...$15.00
https://doi.org/10.1145/3355369.3355598
1 INTRODUCTION
An important step before conducting any Internet measurements
is the process of target selection. Examples of selected targets can
be the complete Internet (which is not feasible in IPv6 [11, 12]), a
subset of targets based on random sampling, or use of domain-based
top lists to gather suitable targets. The latter method is used by
many Internet measurement research papers, which leverage the
Alexa Top 1M [2] and other top lists like Majestic [17] or Umbrella
[8] in order to obtain a representative sample of the hosts in the
Internet. Previous research has shown that top lists are notoriously
unstable [21]. In addition, domain-based top lists lack any form of
aggregation in terms of the underlying infrastructure or service,
i.e., google.com and google.co.uk are separate top list entries
although providing the same service by the same company. Another
issue with current top lists is the lack of weighting for each entry,
i.e., it is not clear how much more popular entry #11 is compared
to entry #12 [3].
In this paper we propose a new technique to associate IP prefixes
with a weight which represents the importance of each prefix.
As the name suggests, prefix top lists consist of network prefixes
instead of domains. This allows using prefix top lists in measure-
ment studies which go beyond the scope of domain-based top lists.
We create prefix top lists by using domain-based top lists as the
initial data source, mapping the domains to IP addresses and subse-
quently aggregating these IP addresses to prefixes. We apply a Zipf
popularity distribution to each domain of the top lists to provide
weights for each address, subsequently aggregating the weights for
each prefix, and finally ranking the prefixes.
Prefix top lists can be leveraged in many different types of In-
ternet measurement studies, e.g., finding the top CDN networks,
evaluating the Internet’s infrastructure, or analyzing dependencies
of important core Internet routers. In this paper we present an
analysis of the DNS name server deployment using prefix top lists.
To further foster the use of prefix top lists we make them available
to fellow researchers at https://prefixtoplists.net.in.tum.de/.
Outline: The paper is structured as follows: In Section 2 we present
our idea of creating prefix top lists and provide details on the process
involved. We analyze churn and temporal stability of prefix top
lists and compare them to domain-based top lists in Section 3. In
Section 4 we apply prefix top lists to DNS analysis by evaluating
DNS server characteristics based on their weight in prefix top lists.
Section 5 lays out our key findings and discusses their implications.
We compare our study to related work in Section 6 and conclude
our paper in Section 7.
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Naab, Sattler, Jelten, Gasser, and Carle
Rank Domain
Weight Top Rank Bottom Rank
google.com
1
0.0703
youtube.com
2
0.0351
tmall.com
0.0226
4
baidu.com
4
0.0184
qq.com
6
0.0134
sohu.com
8
0.0120
8
facebook.com
0.0099
taobao.com
0.0092
9
10
login.tmall.com 0.0077
0.0069
11
1
2
3
4
5
6
7
8
9
10 wikipedia.org
1
2
3
3
5
5
7
6
8
9
Table 1: Top 10 Domains for August 1, 2019 with 7-day rolling
window based on the Alexa List.
2 PREFIX TOP LIST
In this section we present our approach of prefix top lists. First, we
elaborate on existing domain top lists. Then we provide details of
our DNS address resolution approach. Finally, we present a top list
aggregation based on IP prefixes.
2.1 Domain Top List
Existing top lists rank their entries based on some proprietary
metric. The applied process and raw data sources are not publicly
available. They also exhibit—often weekly—fluctuations [21].
Previous work [15] suggests merging multiple existing top lists
to create more stable top lists. This can be done by averaging each
top list over multiple days, creating a more stable version of the
same list. As popularity in the Internet has been known to follow a
Zipf distribution [1, 6, 13, 14], differently ranked input lists can be
combined by aggregating their Zipf weight. The Zipf weight w for
rank k in a total of N elements is calculated as follows:
N
1/ks
n=1 1/ns
w =
The parameter s determines the slope of the distribution, larger
values for s increase the weight for the top-ranking elements, while
reducing the weight for low-ranking elements. The specific param-
eters which contribute to the ranking of domains in the underlying
lists are not universally available. Based on previous work [15], we
use a parameter of s = 1.
We extend this approach by not only using the Zipf distribution
to assign the rank in the combined top list, but also to transfer the
weight to the resulting top list for further analysis. The different
input top lists are joined based on domain names, and the average
weight is calculated. If a domain name does not appear in an input
list, it is implicitly assigned a weight of 0.
Our Zipf-weighted input list is created by averaging the input
top lists’ Zipf weights over the previous week. This approach was
chosen to mitigate weekly fluctuations.
This weighted list is called a domain top list. The domain top
list for August 1, 2019, based on the Alexa list, is shown in Table 1.
We analyze the stability of those lists in Section 3.
2.2 Address Resolution
In order to create prefix and AS based top lists, the domain names
need to be resolved.
For collecting a rich DNS data set as part of this process, we
deploy a custom DNS resolver. This full resolver discovers the zone
setup by help of QNAME minimization (cf. RFC 7816 [7]). To get a
complete picture of the DNS deployment, our full resolver queries
all available authoritative name servers for each query. The name
servers for each zone are discovered by (1) name in the delegation
from the parent zone, (2) trustworthy (in bailiwick) glue records in
the delegation, and (3) additional NS records in the zone apex (also
called root domain or naked domain). The individual name server
names are resolved by the same process. The executed queries
against the authoritative name servers and the individual zone
setups are saved including their metadata.
Compared to traditional resolvers, this allows for in-depth inves-
tigation of the zone setup and name servers.
All domains of the daily domain top list are resolved every day
in a randomized order. For fault isolation, the resolution process
is split into multiple shards. The domains are resolved over the
course of 24 hours in order to avoid high load spikes on shared
authoritative name servers.
The following shards are scanned and later merged into a single
Backfill: −6
data set:
Umbrella t0: the Umbrella top list for today
Alexa t0 ∪ Majestic t0: the deduplicated union of the Alexa and
Majestic top list for today
n=−1 Alexa tn, Majestic tn, Umbrella tn \ (Alexa t0 ∪
Majestic t0 ∪ Umbrella t0): the set of domains which were
contained within the top lists over the last week but are
currently no longer included in the top lists.
After the zones and domain names have been resolved, the IP
addresses are extracted. If a domain points to multiple IP addresses,
we extract all of them. This can occur for two reasons: An author-
itative name server can return multiple IP addresses as target or
different authoritative name server can return distinct IP addresses.
For the rest of this work, these addresses are treated equally. Since
the domain lists are only resolved from a single vantage point, this
resolution process represents a local view and is susceptible to
DNS-based load balancing. We discuss DNS-based load balancing
and its effects on prefix top lists in Section 5.
2.3 Prefix-based Top Lists
For the generation of prefix-based top lists, different aggregation
levels can be chosen: ASes, BGP announced prefixes, and normal-
ized prefixes. Normalized prefixes are /24 prefixes (/48 for IPv6
resp.), as they represent the smallest generally propagated BGP
announcements. The aggregation levels are hierarchical, with each
normalized prefix belonging to one BGP announced prefix, and
each BGP announced prefix belonging to one AS. For the assign-
ment of BGP prefixes and their respective origin AS, a localized
BGP dump is used. When the prefix has multiple origin ASes, we
take the lower AS number from the possible paths.
For the aggregation and ranking on different levels, the weight
of an input domain is transferred based on the resolved mappings.
In case multiple objects are reached (i.e., a domain resolves to
Prefix Top Lists
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Rank
1
16
175
30
127
1
2
3
4
6
9
1
2
3
6
5
7
4
9
10
25
18
216.58.207.0/24
216.58.205.0/24
5
7
10
28