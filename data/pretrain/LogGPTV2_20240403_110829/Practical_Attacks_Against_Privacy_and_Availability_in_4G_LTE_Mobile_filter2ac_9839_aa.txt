# Practical Attacks Against Privacy and Availability in 4G/LTE Mobile Communication Systems

**Authors:**
- Altaf Shaik
- Jean-Pierre Seifert
- Ravishankar Borgaonkar
- N. Asokan
- Valtteri Niemi

**Affiliations:**
- **Altaf Shaik, Jean-Pierre Seifert:** Technische Universität Berlin and Telekom Innovation Laboratories
  - Email: (altaf329, jpseifert) @sec.t-labs.tu-berlin.de
- **Ravishankar Borgaonkar:** Aalto University
  - Email: ravishankar.borgaonkar@aalto.fi
- **N. Asokan:** Aalto University and University of Helsinki
  - Email: [PI:EMAIL]
- **Valtteri Niemi:** University of Helsinki
  - Email: valtteri.niemi@helsinki.fi

## Abstract
Mobile communication systems are now an essential part of life globally. The fourth generation "Long Term Evolution" (LTE) mobile communication networks are being widely deployed. The LTE suite of specifications is considered to be significantly better than its predecessors in terms of functionality, security, and privacy for subscribers. We conducted a detailed analysis of the LTE access network protocol specifications and uncovered several vulnerabilities. Using commercial LTE devices in real LTE networks, we demonstrate inexpensive and practical attacks exploiting these vulnerabilities.

Our first class of attacks consists of three different methods to make an LTE device leak its location. In our experiments, a semi-passive attacker can locate an LTE device within a 2 km² area in a city, while an active attacker can precisely locate an LTE device using GPS coordinates or trilateration via cell-tower signal strength information. Our second class of attacks can persistently deny some or all services to a target LTE device. To the best of our knowledge, our work constitutes the first publicly reported practical attacks against LTE access network protocols.

We present several countermeasures to resist these specific attacks and discuss possible trade-off considerations that may explain why these vulnerabilities exist. We argue that the justifications for these trade-offs may no longer be valid and recommend that future specifications should incorporate greater agility to accommodate subsequent changes in the trade-off equilibrium.

## Introduction
Over the past two decades, mobile devices such as smartphones have become ubiquitous. The reach of mobile communication systems, starting from the second generation Global System for Mobile Communications (2G/GSM) and the third generation Universal Mobile Telecommunication Systems (3G/UMTS), has extended to every corner of the world. Mobile communication is an important cornerstone in the lives of the vast majority of people and societies on this planet. The latest generation, 4G/LTE, is being widely deployed. By the end of 2015, the worldwide LTE subscriber base was expected to be around 1.37 billion.

Early 2G systems were known to have several vulnerabilities. For example, the lack of mutual authentication between mobile users and the network made it possible for attackers to set up fake base stations and convince legitimate mobile devices to connect to them. To minimize the exposure of user identifiers (IMSI) in over-the-air signaling messages, 2G systems introduced temporary mobile subscriber identifiers. However, in the absence of mutual authentication, fake base stations were used as "IMSI catchers" to harvest IMSIs and track user movements.

The evolution of mobile communication systems, specified by the Third Generation Partnership Project (3GPP), has not only incorporated improvements in functionality but also strengthened security. 3G specifications introduced mutual authentication and the use of stronger, well-analyzed cryptographic algorithms. LTE specifications further strengthened signaling protocols by requiring authentication and encryption in more situations than previously required. Consequently, there is a general belief that LTE specifications provide strong privacy and availability guarantees to mobile users. Previously known attacks, such as the ability to track user movement, were thought to be difficult in LTE.

In this paper, we demonstrate the first practical attacks against LTE access network protocols. Our attacks are based on vulnerabilities we discovered during a careful analysis of LTE access network protocol specifications. They fall into two classes: location leaks and denial of service. In the first class, we describe three different attacks that can force an LTE device (User Equipment or UE in 3GPP terminology) to reveal its location. The first two allow a passive or semi-passive attacker to localize the target user within about a 2 km² area in an urban setting, which is a much finer granularity than previously reported location leak attacks against 2G devices, while still using similar techniques. Notably, we show how popular social network messaging applications (e.g., Facebook Messenger and WhatsApp) can be used in such attacks. Our third attack allows an active attacker to exploit vulnerabilities in the specification and implementation of the LTE Radio Resource Control (RRC) protocol to accurately pinpoint the target user via GPS coordinates or trilateration using base station signal strengths as observed by that UE. We believe that all LTE devices in the market are vulnerable to this attack.

In the second class, we describe three further attacks where an active attacker can cause persistent denial of service against a target UE. In the first, the target UE will be forced to use 2G or 3G networks rather than LTE networks, making it possible to mount 2G/3G-specific attacks against that UE. In the second, the target UE will be denied access to all networks. In the last attack, the attacker can selectively limit a UE to certain types of services (e.g., no voice calls). The attacks are persistent and silent: devices require explicit user action (such as rebooting the device) to recover.

We have implemented all our attacks (except one) and confirmed their effectiveness using commercial LTE devices from several vendors and real LTE networks of several carriers. The equipment needed for the attacks is inexpensive and readily available. We reported our attacks to the manufacturers, carriers, and the standardization body (3GPP). Remedial actions are underway.

Specifying a large system like LTE is a complex endeavor involving many trade-offs among conflicting requirements. Rather than merely reporting on LTE vulnerabilities and attacks, we also discuss possible considerations that may have led to the vulnerabilities. Based on this, we suggest some general guidelines for future standardization and specific fixes for our attacks.

### Contributions
- **Fine-grained location leaks:** New passive and active techniques to link users' real identities to LTE temporary identities assigned to them and to track user locations and movements to much higher levels of granularity than previously thought possible. (Section V)
- **Denial-of-Service (DoS) Attacks:** New active DoS attacks that can silently and persistently downgrade LTE devices by preventing their access to LTE networks (limiting them to less secure 2G/3G networks or denying network access altogether) or limiting them to a subset of LTE services. (Section VI)
- **Implementation & Evaluation:** An inexpensive software and hardware framework to implement the attacks based on srsLTE, OpenLTE, and Universal Software Radio Peripherals (USRP), and evaluation of the attacks using commercially available LTE phones in real networks. (Sections V–VII)
- **Security Analysis:** Discussion outlining possible underlying reasons for the vulnerabilities, including perceived or actual trade-offs between security/privacy and other criteria like availability, performance, and functionality, as well as recommending fixes. (Section VIII)

## II. Overview of LTE Architecture
We briefly describe the LTE infrastructure, as well as the security and paging mechanisms, to assist readers in understanding the vulnerabilities and attacks presented in this paper.

### A. LTE Infrastructure
We consider a simplified LTE architecture involving components required to set up access network protocols between a base station and mobile devices. Figure 1 depicts this simplified architecture, which contains three main components: User Equipment (UE), Evolved Universal Terrestrial Radio Access Network (E-UTRAN), and Evolved Packet Core (EPC). All three components are collectively referred to as the Evolved Packet System (EPS) according to 3GPP terminology. Throughout this paper, we refer to the whole system as LTE. The three components are described below:

- **User Equipment (UE):** The UE refers to the actual communication device, such as a smartphone. A UE contains a USIM (Universal Subscriber Identity Module), which represents the IMSI and stores the corresponding authentication credentials. The IMSI is used to uniquely identify an LTE user (referred to as a "subscriber" in 3GPP terminology). The USIM participates in the LTE subscriber authentication protocol and generates cryptographic keys that form the basis for the key hierarchy used to protect signaling and user data communication between the UE and base stations over the radio interface.
- **E-UTRAN:** E-UTRAN consists of base stations. It manages the radio communication with the UE and facilitates communication between the UE and EPC. In LTE, a base station is technically referred to as an "evolved NodeB (eNodeB)." The eNodeB uses a set of access network protocols, called Access Stratum (AS), for exchanging signaling messages with its UEs. These AS messages include Radio Resource Control (RRC) protocol messages. Other functions of the eNodeB include paging UEs, over-the-air security, physical layer data connectivity, and handovers. Each eNodeB is connected to the EPC through an interface named S1.
- **MME in EPC:** EPC provides core network functionalities through a new all-IP mobile core network designed for LTE systems. It consists of several new elements, but for our work, we focus on the Mobility Management Entity (MME). The MME is responsible for authenticating and allocating resources (data connectivity) to UEs when they connect to the network. Other important functions of the MME involve security (setting up integrity and encryption for signaling) and tracking the UE's location at a macro level. The set of protocols run between the UE and MME are referred to as Non-Access Stratum (NAS).

A service area of a mobile operator is geographically divided into several regions known as Tracking Areas (TAs). TAs are similar to Location Areas in GSM networks and are managed by the MME. Each TA contains a group of "cells," each controlled by an eNodeB. The eNodeB broadcasts operator-specific information such as Tracking Area Code (TAC), Mobile Country Code (MCC), Mobile Network Code (MNC), and cell ID via System Information Block (SIB) messages. This allows UEs to identify their serving network operator and initiate a connection to the network. A UE attaches to the network by initiating the Attach procedure. Upon successful acceptance, the UE receives access to services based on its subscription. The UE uses the Tracking Area Update (TAU) procedure to inform the network about its mobility in the serving area.

### B. Security in LTE
To minimize the transmission of the IMSI in over-the-air radio communication for security and privacy reasons, LTE specifications use a Globally Unique Temporary Identifier (GUTI) to identify subscribers during radio communication. The GUTI is assigned to UEs during the Attach procedure and may be periodically changed to provide temporal unlinkability of traffic to/from the same UE. An Authentication and Key Agreement (AKA) protocol is used for mutual authentication between the UE and the network and to agree on session keys that provide integrity and confidentiality protection for subsequent NAS and AS messages. Both NAS and AS security are collectively referred to as EPS security. It is established between a UE and a serving network domain (eNodeB and MME) during EPS Mobility Management (EMM) procedures and includes agreeing on session keys, preferred cryptographic algorithms, and other values as defined in the relevant LTE specifications.

### C. Paging in LTE
Paging refers to the process used when the MME needs to locate a UE in a particular area and deliver a network service, such as an incoming call. Since the MME may not know the exact eNodeB to which the UE is connected, it generates a paging message and forwards it to all eNodeBs in a TA. Simultaneously, the MME starts a paging timer (T3413) and expects a response from the UE before this timer expires. Thus, all eNodeBs present in the paged TA broadcast an RRC paging message to locate the UE. Paging messages contain identities of UEs such as S-TMSI(s) or IMSI(s). S-TMSI is a temporary identifier (SAE-Temporary Mobile Subscriber Identity) and is part of a GUTI. For simplicity, we consistently use the term GUTI throughout the rest of this paper even when referring to S-TMSI. The UE in IDLE state decodes RRC paging messages. If it detects its IMSI, it initiates a new Attach procedure to receive a GUTI. If the UE detects its GUTI, it responds to the paging message.