# 新型恶意软件根据计算机配置决定挖矿或部署勒索软件
#### 译文声明
本文为翻译文章，原文来源：thehackernews.com
具体内容和含义请以原文为准。
安全研究人员发现了一种新型恶意软件，它能够根据受感染计算机的配置情况来选择是进行加密货币挖矿还是部署勒索软件。这种策略旨在最大化攻击者的经济收益。

### 恶意软件概述
- **勒索软件**：通过锁定用户的计算机并阻止其访问已加密的数据，直到用户支付赎金以换取解密密钥。
- **加密货币挖矿**：利用被感染系统的计算资源来挖掘数字货币。

尽管这两种攻击手段都是当前主要的网络安全威胁，并且都涉及使用受害者的设备获取非法收入，但它们的具体运作方式有所不同。由于勒索软件并不总是能成功获得赎金，因此近年来黑客们越来越倾向于采用加密货币挖矿作为替代方案。

### Rakhni恶意软件的新变种
俄罗斯的安全研究机构卡巴斯基实验室最近发现了Rakhni家族的一个新版本，该版本增加了加密货币挖矿功能。此恶意软件用Delphi语言编写，通常通过带有附件（.docx文件）的鱼叉式钓鱼邮件传播。一旦受害者打开文档并启用编辑权限，恶意程序便会开始执行。

### 感染过程
在尝试感染目标系统之前，Rakhni会先进行一系列反虚拟机及反沙箱检测，确保自身不会被安全软件轻易发现。如果所有条件均满足，则继续执行以下步骤：

1. **安装勒索软件** - 当目标计算机的AppData目录下存在“比特币”文件夹时。
   - 使用RSA-1024算法对文件进行加密前，恶意软件会终止与预定义列表中的应用程序相关的所有进程。
   - 加密完成后，通过文本文件向受害者展示赎金信息。
   
2. **启动加密货币矿工** - 如果没有找到上述文件夹并且机器拥有两个以上的逻辑处理器核心。
   - 利用MinerGate工具在后台挖掘Monero (XMR)、Monero Original (XMO) 和 Dashcoin (DSH) 等加密货币。
   - 此外，还会安装假冒由微软公司或Adobe Systems发布的根证书，试图让挖矿活动看起来像是合法操作。
   
3. **激活蠕虫模块** - 在既无“比特币”文件夹又只有一个逻辑处理器的情况下。
   - 该组件允许恶意软件通过局域网内的共享资源自我复制到其他计算机上。
   - 对于每台可访问的主机，特洛伊木马都会检查是否有可供利用的共享文件夹，并将自身拷贝至这些位置。

无论采取哪种行动路径，Rakhni都会首先检查是否已有防病毒程序正在运行。如果没有，则会尝试通过命令行禁用Windows Defender等内置防护机制。

### 额外特性
值得注意的是，这个新版Rakhni还具备一定的间谍软件功能——它可以收集有关受害者设备的信息，包括正在运行的进程列表以及屏幕截图，并将其发送给攻击者。据统计，此类攻击主要针对俄罗斯地区的用户（占比95.5%），同时也影响到了哈萨克斯坦、乌克兰、德国和印度等地的小部分人群。

### 防护建议
- 不要随意点击来自不明来源的电子邮件链接或下载附件。
- 定期备份重要数据并保持操作系统及安全软件处于最新状态。
  
审核人：yiwang 编辑：边边