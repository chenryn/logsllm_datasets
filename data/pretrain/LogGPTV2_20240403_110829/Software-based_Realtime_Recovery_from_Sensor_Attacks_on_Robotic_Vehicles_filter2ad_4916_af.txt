Especially, secure state estimation [19,38,48] was introduced
to handle sensor attacks. However, it mostly utilizes the re-
maining benign sensors or sensor redundancy to securely
estimate system states in the presence of signiﬁcant noises
or attacks. They restrict attackers to corrupt only a subset of
sensors in which case the estimation needs to rely only on
the benign sensors. In comparison, our approach uses soft-
ware sensor based on system modeling regardless of the set
of sensors under attack, which is practical and generic.
System identiﬁcation [32] is used to detect attacks [5] and
debug RV failures [56]. Similar to our method, they build
models for RVs with SI. However, they only detect extreme
deviations and cannot provide accurate feedback to the control
loop after detection. In addition, we precisely model individ-
ual sensor readings while they cannot.
7 Conclusion
We propose a novel sensor attack recovery technique for multi-
sensor RVs. The technique uses generic state-space model
based software sensors as a safe backup of the physical sen-
sors. Software sensors can precisely predict physical sensor
readings while they are largely isolated from the (malicious)
environment. Evaluation with real RVs demonstrates our tech-
nique can recover from single and multi-sensor attacks.
Acknowledgements
We thank the anonymous reviewers for their valuable com-
ments and suggestions. This work was supported, in part,
by ONR under Grant N00014-17-1-2045. Any opinions and
conclusions in this paper are those of the authors and do not
necessarily reﬂect the views of the ONR.
References
[1] Drone - 3DR Solo, 2017. https://www.3dr.com.
[2] ArduPilot :: Home, 2010. http://ardupilot.org/.
[3] Brian Bradie. A friendly introduction to numerical anal-
ysis. Pearson Education India, 2006.
[4] Richard R Brooks and Sundararaja S Iyengar. Multi-
sensor fusion: fundamentals and applications with soft-
ware. Prentice-Hall, Inc., 1998.
[5] Hongjun Choi, Wen-Chuan Lee, Yousra Aafer, Fan Fei,
Zhan Tu, Xiangyu Zhang, Dongyan Xu, and Xinyan
Xinyan. Detecting attacks against robotic vehicles: A
control invariant approach. In Proceedings of the ACM
CCS, pages 801–816. ACM, 2018.
[6] Self-driving cars now legal in California, 2012. https:
//cnn.it/2ZJDnEN.
[7] Crispan Cowan, Calton Pu, Dave Maier, Jonathan
Walpole, Peat Bakke, Steve Beattie, Aaron Grier, Perry
Wagle, Qian Zhang, and Heather Hinton. Stackguard:
Automatic adaptive detection and prevention of buffer-
overﬂow attacks. In USENIX Security, 1998.
[8] Drew Davidson, Hao Wu, Robert Jellinek, Vikas Singh,
and Thomas Ristenpart. Controlling uavs with sensor
input spooﬁng attacks. In WOOT, 2016.
[9] Case study1: Multiple gyroscope sensor (1,2,3) recovery.
https://youtu.be/SQ1liFlncB4.
[10] Case study2: GPS sensor attack. https://youtu.be/
e8J6ixvtXqQ.
[11] Gyroscope sensor attack and crash. https://youtu.
be/_bOLxzvyu5c.
[12] Multiple gyroscope sensor (1,2,3) recovery. https:
//youtu.be/1MidmMlDEMo.
[13] Rover controlled GPS attack. https://youtu.be/
gu1NVssiJls.
362    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
[14] Rover random GPS attack.
S04iL8diRh8.
https://youtu.be/
[15] Case study2: GPS sensor recovery, 2019. https://
youtu.be/oC3SOGT_XDY.
[16] W Elmenreich. Sensor fusion in time-triggered systems
phd thesis. Institut fur Technische Informatik, Technis-
chen Universitat Wien, 2002.
[17] Alexander Eriksson and Neville A Stanton. Takeover
time in highly automated vehicles: noncritical transi-
tions to and from manual control. Human factors,
59(4):689–705, 2017.
[18] Rover Home — Rover documentation, 2016. http:
//erlerobotics.com/blog/erle-rover/.
[19] Hamza Fawzi, Paulo Tabuada, and Suhas Diggavi. Se-
cure estimation and control for cyber-physical systems
under adversarial attacks. IEEE Transactions on Auto-
matic control, 59(6):1454–1467, 2014.
[20] Paul M Frank. Fault diagnosis in dynamic systems
using analytical and knowledge-based redundancy: A
survey and some new results. automatica, 26(3):459–
474, 1990.
[21] Gene F Franklin, J David Powell, Abbas Emami-Naeini,
and J David Powell. Feedback control of dynamic sys-
tems, volume 3. Addison-Wesley Reading, MA, 1994.
[22] Wei Gao and Thomas H Morris. On cyber attacks and
signature based intrusion detection for modbus based
industrial control systems. The Journal of Digital Foren-
sics, Security and Law: JDFSL, 9(1):37, 2014.
[23] Christian Gold, Daniel Damböck, Lutz Lorenz, and
Klaus Bengler. “take over!” how long does it take to get
the driver back into the loop? In Proceedings of the Hu-
man Factors and Ergonomics Society Annual Meeting,
volume 57, pages 1938–1942. SAGE, 2013.
[24] Jingqing Han. From pid to active disturbance rejection
control. IEEE transactions on Industrial Electronics,
56(3):900–906, 2009.
[25] Pavel Holoborodko. Smooth noise robust differentiators.
[26] Khurum Nazir Junejo and Jonathan Goh. Behaviour-
based attack detection and classiﬁcation in cyber physi-
cal systems using machine learning. In Proceedings of
the 2nd ACM International Workshop on Cyber-Physical
System Security, pages 34–43. ACM, 2016.
[27] Rudolf Emil Kalman et al. Contributions to the theory
of optimal control. Bol. soc. mat. mexicana, 5(2), 1960.
[28] Sanmeet Kaur and Maninder Singh. Automatic attack
signature generation systems: A review. IEEE Security
& Privacy, 11(6):54–61, 2013.
[29] Israel Koren and C Mani Krishna. Fault-tolerant sys-
tems. Elsevier, 2010.
[30] Denis Foo Kune, John Backes, Shane S Clark, Daniel
Kramer, Matthew Reynolds, Kevin Fu, Yongdae Kim,
and Wenyuan Xu. Ghost talk: Mitigating emi signal
injection attacks against analog sensors. pages 145–159,
2013.
[31] Leslie Lamport, Robert Shostak, and Marshall Pease.
The byzantine generals problem. ACM Transactions
on Programming Languages and Systems (TOPLAS),
4(3):382–401, 1982.
[32] L Ljung. System identiﬁcation-theory for the user, pren-
tice hall, upper saddle river n. System identiﬁcation:
Theory for the user. 2nd ed. Prentice Hall, Upper Saddle
River, NJ., 1999.
[33] Kevin M.. Lynch and Frank Chongwoo Park. Mod-
ern Robotics: Mechanics, Planning, and Control. Cam-
bridge University Press, 2017.
[34] System Identiﬁcation Toolbox - MATLAB, 2017.
https://www.mathworks.com/products/sysid.
html.
[35] Micro Air Vehicle Communication Protocol, 2017.
http://qgroundcontrol.org/mavlink/start.
[36] Robert Mitchell and Ray Chen. Adaptive intrusion detec-
tion of malicious unmanned air vehicles using behavior
rule speciﬁcations. IEEE Transactions on Systems, Man,
and Cybernetics: Systems, 44(5):593–604, 2014.
[37] Robert Mitchell and Ray Chen. Behavior rule speciﬁca-
tion based intrusion detection for safety critical medical
cyber physical systems. IEEE Transactions on Depend-
able and Secure Computing, 12(1):16–30, 2015.
[38] Yilin Mo and Bruno Sinopoli. Secure estimation in the
IEEE Transactions on
presence of integrity attacks.
Automatic Control, 60(4):1145–1151, 2015.
[39] Katsuhiko Ogata and Yanjuan Yang. Modern control
engineering, volume 4. Prentice hall India, 2002.
[40] Tom O’Haver. A pragmatic introduction to signal pro-
cessing. University of Maryland at College Park, 1997.
[41] Young-Seok Park, Yunmok Son, Hocheol Shin, Dohyun
Kim, and Yongdae Kim. This ain’t your dose: Sensor
spooﬁng attack on medical infusion pump. In WOOT,
2016.
[42] Jonathan Petit, Bas Stottelaar, Michael Feiri, and Frank
Kargl. Remote attacks on automated vehicles sensors:
Experiments on camera and lidar. Black Hat Europe.
[43] Lee Pike, Pat Hickey, Trevor Elliott, Eric Mertens, and
Aaron Tomb. Trackos: A security-aware real-time oper-
ating system. In International Conference on Runtime
Veriﬁcation, pages 302–317. Springer, 2016.
[44] Pixhawk, 2019. https://pixhawk.org/.
[45] Hiroaki Sakoe and Seibi Chiba. Dynamic programming
algorithm optimization for spoken word recognition.
IEEE transactions on acoustics, speech, and signal pro-
cessing, 26(1):43–49, 1978.
USENIX Association
23rd International Symposium on Research in Attacks, Intrusions and Defenses    363
[46] Qikun Shen, Bin Jiang, Peng Shi, and Cheng-Chew
Lim. Novel neural networks-based fault tolerant con-
IEEE transactions on
trol scheme with fault alarm.
cybernetics, 44(11):2190–2201, 2014.
[47] Yasser Shoukry, Paul Martin, Paulo Tabuada, and Mani
Srivastava. Non-invasive spooﬁng attacks for anti-lock
braking systems. In International Workshop on Crypto-
graphic Hardware and Embedded Systems, pages 55–72.
Springer, 2013.
[48] Yasser Shoukry, Pierluigi Nuzzo, Alberto Puggelli, Al-
berto L Sangiovanni-Vincentelli, Sanjit A Seshia, and
Paulo Tabuada.
Secure state estimation for cyber-
physical systems under sensor attacks: A satisﬁability
modulo theory approach. IEEE Transactions on Auto-
matic Control, 62(10):4917–4932, 2017.
[49] Yunmok Son, Hocheol Shin, Dongkwan Kim, Young-
Seok Park, Juhwan Noh, Kibum Choi, Jungwoo Choi,
Yongdae Kim, et al. Rocking drones with intentional
sound noise on gyroscopic sensors. In USENIX Security,
pages 881–896, 2015.
[50] First passenger drone makes its debut at CES, 2016.
https://bit.ly/2O0zYft.
[51] Nils Ole Tippenhauer, Christina Pöpper, Kasper Bonne
Rasmussen, and Srdjan Capkun. On the requirements
for successful gps spooﬁng attacks. In Proceedings of
the 18th ACM CCS, pages 75–86. ACM, 2011.
[52] Timothy Trippel, Oﬁr Weisse, Wenyuan Xu, Peter Hon-
eyman, and Kevin Fu. Walnut: Waging doubt on the
integrity of mems accelerometers with acoustic injection
attacks. In EuroS&P, pages 3–18. IEEE, 2017.
[53] Zhengbo Wang et al. SONIC GUN TO SMART DE-
VICES. 2017.
[54] Jon S Warner and Roger G Johnston. A simple demon-
stration that the global positioning system (gps) is vul-
nerable to spooﬁng. Journal of Security Administration,
25(2):19–27, 2002.
[55] Bin Yao and Chang Jiang. Advanced motion control:
from classical pid to nonlinear adaptive robust control.
In AMC, pages 815–829. IEEE, 2010.
[56] Enyan Huang Qixin Wang Yu Pei Haidong Yuan Zhi-
jian He, Yao Chen. A system identiﬁcation based oracle
for control-cps software fault localization. In Proceed-
ings of ICSE. ACM, 2019.
[57] Christopher Zimmer, Balasubramanya Bhat, Frank
Mueller, and Sibin Mohan. Time-based intrusion de-
tection in cyber-physical systems. In Proceedings of
ICCPS, pages 109–118. ACM, 2010.
Appendix
A Quadrotor Model and Frames
The Figure 19 shows a quadrotor with two frames: inertia and
body frame. The linear position of the quadrotor is deﬁned in
Figure 19: Inertial and body frame
the inertial frame with ξ (x, y, z). The attitude (i.e., angular
position) is deﬁned in the inertial frame with η (φ,θ,ψ). The
roll(φ), pitch(θ), yaw (ψ) angle (i.e., Euler angle) determine
the rotational angles around the x, y, z axis, respectively. The
origin of the body frame is deﬁned in the center of mass of the
quadcopter. The linear velocities in the body frame is deﬁned
with VB and angular velocities determined by ω (p,q,r). The
rotation matrix R from the body frame to the inertial frame is
denoted as:
CψCθ CψSθSφ − SφCφ CψSθCφ + SψSφ
SψSθcφ −CψSφ
SψSθSφ +CψCφ
R =
(8)
CθSφ
CθCφ
SψCθ
−Sθ
where Sx = sin(x) , Cx = cos(x). R is orthogonal thus R−1 =
RT . The RT is for rotation from the inertial frame to body
frame. The transformation matrix Wη for angular velocities
from the inertial frame ˙η to the body frame ω is:
(9)
(10)
q
r
 =
p
1
 =
0
0
 ˙φ
˙θ
˙ψ
1
0
Cφ
−Sθ
CθSφ
0
0 −Sφ CφCθ
SφTθ
CφTθ
−Sφ
Cφ
Sφ/Cθ Cφ/Cθ
˙θ
˙ψ
 ˙φ
p
 ,
q
r
ω = Wη ˙η,
˙η = W−1
η ω,
Also, the Euler angular velocity is then
B Supplementary Compensation.
We present an example of the supplementary compensation
approach that estimates angle status from the accelerometer
and magnetometer. Note that angle status is typically mea-
sured by gyro. The conversion equation is the following.
φacc = atan2(yacc,
acc,z2
x2
acc)
θacc = atan2(xacc,
ψmag = atan2(−ymag · cosφ + zmag · sinφ,
y2
acc,z2
acc)
xmag · cosθ + ymag · sinθ· sinφ + zmag · sinθ· cosφ)
(11)
(cid:113)
(cid:113)
The conversion errors and the real sensor errors (e.g. sensor
noise, bias) cause ﬂuctuations in the equations’ output. We use
low-pass ﬁlter to smooth the outputs. Combining the outputs
from Eq. (11) and our software sensor (using weighted sum),
we acquire more accurate measurements.
364    23rd International Symposium on Research in Attacks, Intrusions and Defenses
USENIX Association
zyxyBzBxBnosetailyawpitchrollR