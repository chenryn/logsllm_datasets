 Location:Amsterdam, Netherlands
 Result: EVIL 
IP: 66.74.x.x
 Rating: 95
 Tor:False
 ISP:Time Warner Cable Internet Llc
 Location:Berwyn, IL, USA
 Result: EVIL 
IP: 192.168.x.x
 Rating: 50
 Tor:False
 ISP:Private Ip Address Lan
 Location:-, -, -
 Result: GOOD 
IP: 66.249.x.x
 Rating: 50
 Tor:False
 ISP:Google Inc.
 Location:Mountain View, CA, USA
 Result: GOOD 
IP: 132.206.x.x
 Rating: 50
 Tor:False
 ISP:Mcgill University
 Location:Montreal, Quebec, Canada
 Result: GOOD 
IP: 41.70.152.59  Rating: 85
 Tor:False
 ISP:Movicel Telecomunicacoes Lda
 Location:Luanda, Luanda, Angola
 Result: EVIL 
IP: 192.168.x.x
 Rating: 50
 Tor:False
 ISP:Private Ip Address Lan
 Location:-, -, -
 Result: GOOD 
# cat access.log | fgrep 41.70.152.59 
41.70.152.59 - - [13/Oct/2013:12:43:00 -0400] "A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. 
Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A cat is fine too. Desudesudesu~A c" 414 456 "-" "-" 
29 
Top Talkers Example (cont) 
•  Read logs 
–  Look for patterns for Fail2Ban or whatever blocking 
system you have in place 
–  Block User Agents 
–  Block IPs 
•  Use sniffer + wireshark 
–  Beware of SSL 
•  Using RSA? 
•  Have private key? 
–  Snort/F5/Surricata/etc 
•  Identify unique characteristics to block on 
•  Often more time intensive, but traffic never reaches the 
webserver 
30 
Reacting to an Attack (cont) 
31 
Sniffer + Wireshark Example 
•  If attack was effective, why? 
–  Talk to various teams in your organization 
•  Brainstorm! 
–  Deploy defenses discussed here (if not already) 
–  Test network against a similar attack until defenses are effective 
•  Hack back? 
–  SX Forum users have hacked DDoSers with some success 
– 
“Is it more risky to continue the same methods of cyber defense (stand in the ring with multiple opponents 
just bobbing and weaving never throwing a punch) or more risky to start fighting back with jabs, 
combinations, head and body blows?” – Jeff Bardin, Treadstone71 
–  Probably not a good idea in general 
– 
“If a company can’t do defense correctly, why do you think they can do offense right? … If you can easily 
and positively attribute, they shouldn’t have breached your defenses. You have no business attacking them 
when you were negligent on defense 101.” – Brian “Jericho” Martin, attrition.org 
•  Shame? 
–  Identifying and shaming DDoSers has been effective for SX 
32 
Reacting to an Attack (Aftermath) 
Best Practices 
•  Limit connections with something like mod_evasion 
•  Have some way(s) to intelligently block bad traffic  
–  Snort inline/Fail2ban/etc 
•  Have sniffer(s) in place to have quick access to traffic 
•  Tune webserver, database, etc for performance 
–  This includes log tuning 
•  Configure webserver to log Client IP AND X-Forwarded-For 
•  Don’t log small static content to reduce log load (css, js, txt, etc) 
•  Remove/limit search function if not needed 
–  Could replace with google search or at least require users to login 
to site to perform searches 
•  Avoid hosting public large files when possible 
–  Many DDoS attacks have involved hitting large PDF files 
•  Have a monitoring service such as RoboAmp running 
•  Share information with similar companies/individuals 
33 
34 
Story Time 
•  VB 
-  VB DDoS’d SX and took it down for 5 minutes 
-  The Fixer got VB’s IP from the forums 
-  VB’s ISP used mikrotik routers (where TheFixer used to work) 
-  Remote pcap and lulz ensued 
•  BenOwns 
-  Defrauded SX VIP and was called out for it 
-  Proceeded to DDoS the site 
-  Dox were dropped, Ben vanished 
•  Others 
-  Many a pizza has been ordered at the 
   expense of DDoS skids 
-  Sc0rpion 
-  egihosting 
-  plex0r 
•  Anonymous network technicians that answered 
questions about various DDoS they have encountered 
•  RaT, Amp, The Fixer, lattera, spender, sn4ggl3, Shinobi, 
Kohelet, EverestX, Jericho, Jeff Bardin, Rhapsody, and 
the entire soldierx.com community (to include 
irc.soldierx.com #soldierx) 
•  DDoS skids for all of the entertaining nights of laughing 
at your packets (especially Desu attack) 
35 
Thanks 
References and Resources 
36 
https://www.soldierx.com 
http://rules.emergingthreats.net 
http://www.techstacks.com/howto/log-client-ip-and-xforwardedfor-ip-in-apache.html 
http://www.rocchi.us/2012/08/mitigate-ddos-with-iptables-and-ipt_recent/ 
http://gr8idea.info/os/tutorials/security/iptables8.html 
http://www.brianhare.com/wordpress/2011/03/02/block-tor-exit-nodes-using-bash-script/ 
http://www.zdziarski.com/blog/?page_id=442 
http://systembash.com/content/how-to-stop-an-apache-ddos-attack-with-mod_evasive/ 
https://www.owasp.org/images/0/04/Roberto_Suggi_Liverani_OWASPNZDAY2010-Defending_against_application_DoS.pdf 
http://www.csoonline.com/article/2136485/security-leadership/caution--not-executing-offensive-actions-against-our-adversaries-is-high-risk.html 
http://webdesignfromscratch.com/javascript/human-form-validation-check-trick/ 
http://www.rocchi.us/2012/08/mitigate-ddos-with-iptables-and-ipt_recent/ 
http://www.sans.org/reading-room/whitepapers/hackers/user-agent-field-analyzing-detecting-abnormal-malicious-organization-33874 
https://media.blackhat.com/us-13/US-13-Nixon-Denying-Service-to-DDOS-Protection-Services-WP.pdf 
http://www.dedmeet.com/software-projects-mainmenu-12/fail2ban-to-limit-ddos-attacks-on-webserver.html 
https://jerichoattrition.wordpress.com/2013/08/12/putting-an-end-to-strike-back-active-defense-debate/ 
https://rtcamp.com/tutorials/nginx/fail2ban/ 
https://www.drupal.org/project/boost 
https://grsecurity.net 
http://www.penny-arcade.com/comic/2004/03/19 
http://www.blyon.com/using-squid-proxy-to-fight-ddos/ 
https://www.snort.org 
http://a-infosec.com/2013/11/11/layer-7-ddos-attack-a-web-architect-perspective/ 
https://learn.adafruit.com/drive-a-16x2-lcd-directly-with-a-raspberry-pi/overview 
http://resources.infosecinstitute.com/ssl-decryption/ 
http://www.attrition.org 
http://www.squidblacklist.org 
Q/A 
•  Questions? 
Also reach out to us on 
 irc.soldierx.com #soldierx and email:  
PI:EMAIL and PI:EMAIL 
Content is at https://www.soldierx.com/defcon22/ 
37