-dosynchronize pubname -repsvrfile pubsvrfile -repgrouptype m
Note (For SMR only): The dosynchronize command can be used on a subscription
without first having to perform a snapshot using the dosnapshot command. The
dosynchronize command automatically performs the first required snapshot.
Note (For MMR only): Be sure an initial snapshot replication has been performed from
the master definition node to every other master node in the multi-master replication
system. If a newly added master node did not undergo an initial snapshot, any subsequent
synchronization replication may fail to apply the transactions to that master node. The
initial snapshot could be taken when the master node is first added (see Section 6.3 or
Section 8.3.6) or by performing an on demand snapshot (see Section 6.5.1 or Section
8.3.41).
See Section 5.4.2 for additional information on performing synchronization replication
for a single-master replication system. See Section 6.5.2 for a multi-master replication
system.
Parameters
subname
For SMR only: The name of the subscription for which synchronization
replication is to be performed.
pubname
For MMR only: The name of the publication for which synchronization
replication is to be performed.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 589
EDB Postgres Replication Server User’s Guide
subsvrfile
For SMR only: The file containing the subscription server login information.
pubsvrfile
For MMR only: The file containing the publication server login information.
-repgrouptype
Specify s if this command applies to a single-master replication system. Specify m
if this command applies to a multi-master replication system. If omitted, the
default is s.
Examples
In the following example, synchronization replication is performed on subscription
dept_emp_sub of a single-master replication system.
$ java -jar edb-repcli.jar -dosynchronize dept_emp_sub \
> -repsvrfile ~/subsvrfile.prop
Performing synchronize...
Synchronize done successfully.
In the following example, synchronization replication is performed on publication
emp_pub of a multi-master replication system. Note that the -repgrouptype m
parameter is required in this case.
$ java -jar edb-repcli.jar -dosynchronize emp_pub \
> -repsvrfile ~/pubsvrfile.prop -repgrouptype m
Performing synchronize...
Publication synchronized successfully.
8.3.43 Configuring a Single-Master Schedule (confschedule)
For SMR only: The confschedule command creates a schedule as to when recurring
replications are to be initiated for a single-master replication system.
Synopsis
-confschedule subname –repsvrfile subsvrfile
{ -remove | -jobtype { s | t }
{ -realtime no_of_sec |
-daily hour minute |
-weekly day_of_week hour minute |
-monthly month day_of_month hour minute |
-cronexpr "cron_expression"
}
}
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 590
EDB Postgres Replication Server User’s Guide
If the remove parameter is specified, then the schedule is deleted from the subscription.
No other parameters other than subname and repsvrfile can be specified in this case.
If the remove parameter is omitted, then the jobtype parameter and one of parameters
realtime, daily, weekly, monthly, or cronexpr must be specified along with the
subname and repsvrfile parameters. If there is an existing schedule for subscription
subname, it will be replaced by the new schedule.
See Section 7.2 for additional information on creating a schedule.
Parameters
subname
The name of the subscription for which a replication schedule is to be created.
subsvrfile
The file containing the subscription server login information.
-remove
If the remove parameter is specified, then any existing schedule is removed from
the subscription. If the remove parameter is not specified, then a schedule is
created for the subscription.
-jobtype
Specify s if the scheduled replication is to be done by snapshot. Specify t if the
scheduled replication is to be done by synchronization. If the associated
publication is a snapshot-only publication, then -jobtype s must be used.
no_of_sec
The number of seconds between scheduled replications. This can be any integer
greater than 0.
hour
The hour of the day based on a 24-hour clock. This can be any integer from 0 to
23.
minute
The minute of the hour. This can be any integer from 0 to 59.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 591
EDB Postgres Replication Server User’s Guide
day_of_week
The day of the week. This can be any of the following values: SUN, MON, TUE,
WED, THU, FRI, or SAT. This value is case insensitive so Sun and sun will work
as well as SUN.
month
The month of the year. This can be any of the following values: JAN, FEB, MAR,
APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, or DEC. This value is case insensitive
so Jan and jan will work as well as JAN.
day_of_month
The day of the month. This can be any integer greater than or equal to 1, and less
than or equal to the number of days in month.
cron_expression
A cron expression. See appendix Section 10.4.3 for information on writing a cron
expression.
Examples
In the following example, a schedule is created to perform synchronization replication on
subscription dept_emp_sub once every 5 minutes.
$ java -jar edb-repcli.jar -confschedule dept_emp_sub \
> -repsvrfile ~/subsvrfile.prop \
> -jobtype t \
> -realtime 300
Configuring scheduler ...
Job is successfully scheduled.
In the following example, the schedule is removed from subscription dept_emp_sub.
$ java -jar edb-repcli.jar -confschedule dept_emp_sub \
> -repsvrfile ~/subsvrfile.prop \
> -remove
Configuring scheduler ...
Scheduled job is removed.
8.3.44 Configuring a Multi-Master Schedule (confschedulemmr)
For MMR only: The confschedulemmr command creates a schedule as to when
recurring replications are to be initiated for a multi-master replication system.
Note: Be sure an initial snapshot replication has been performed from the master
definition node to every other master node in the multi-master replication system. If a
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 592
EDB Postgres Replication Server User’s Guide
newly added master node did not undergo an initial snapshot, any subsequent
synchronization replication initiated by a schedule may fail to apply the transactions to
that master node. The initial snapshot could be taken when the master node is first added
(see Section 6.3 or Section 8.3.6) or by performing an on demand snapshot (see Section
6.5.1 or Section 8.3.41).
Synopsis
-confschedulemmr pubdbid -pubname pubname
–repsvrfile pubsvrfile
{ -remove |
{ -realtime no_of_sec |
-daily hour minute |
-weekly day_of_week hour minute |
-monthly month day_of_month hour minute |
-cronexpr "cron_expression"
}
}
If the remove parameter is specified, then the schedule is deleted from the publication.
No other parameters other than pubdbid, pubname, and repsvrfile can be specified
in this case.
If the remove parameter is omitted, then one of parameters realtime, daily, weekly,
monthly, or cronexpr must be specified along with the pubdbid, pubname, and
repsvrfile parameters. If there is an existing schedule for publication pubname, it will
be replaced by the new schedule.
See Section 7.2 for additional information on creating a schedule.
Parameters
pubdbid
The publication database ID of the publication database definition representing
the master definition node on which to configure the schedule.
pubname
The name of the publication for which a replication schedule is to be created.
pubsvrfile
The file containing the publication server login information.
-remove
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 593
EDB Postgres Replication Server User’s Guide
If the remove parameter is specified, then any existing schedule is removed from
the publication. If the remove parameter is not specified, then a schedule is
created for the publication.
no_of_sec
The number of seconds between scheduled replications. This can be any integer
greater than 0.
hour
The hour of the day based on a 24-hour clock. This can be any integer from 0 to
23.
minute
The minute of the hour. This can be any integer from 0 to 59.
day_of_week
The day of the week. This can be any of the following values: SUN, MON, TUE,
WED, THU, FRI, or SAT. This value is case insensitive so Sun and sun will work
as well as SUN.
month
The month of the year. This can be any of the following values: JAN, FEB, MAR,
APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, or DEC. This value is case insensitive
so Jan and jan will work as well as JAN.
day_of_month
The day of the month. This can be any integer greater than or equal to 1, and less
than or equal to the number of days in month.
cron_expression
A cron expression. See appendix Section 10.4.3 for information on writing a cron
expression.
Examples
In the following example, a schedule is created to perform synchronization replication on
publication emp_pub subordinate to the master definition node whose publication
database ID is 6. Replication is to occur daily at 8:00 AM.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 594
EDB Postgres Replication Server User’s Guide
$ java -jar edb-repcli.jar -confschedulemmr 6 -pubname emp_pub \
> -repsvrfile ~/pubsvrfile.prop \
> -daily 8 00
Configuring scheduler ...
Job is successfully scheduled.
In the following example, the schedule is removed from publication emp_pub.
$ java -jar edb-repcli.jar -confschedulemmr 6 -pubname emp_pub \
> -repsvrfile ~/pubsvrfile.prop \
> -remove
Configuring scheduler ...
Scheduled job is removed.
8.3.45 Print Schedule (printschedule)
The printschedule command prints a recurring replication schedule.
Synopsis
-printschedule { subname | pubname }
-repsvrfile { subsvrfile | pubsvrfile }
[ -repgrouptype { s | m } ]
For a single-master replication system use:
-printschedule subname –repsvrfile subsvrfile
For a multi-master replication system use:
-printschedule pubname -repsvrfile pubsvrfile -repgrouptype m
Parameters
subname
For SMR only: The name of the subscription for which the schedule is to be
printed.
pubname
For MMR only: The name of the publication for which the schedule is to be
printed.
subsvrfile
For SMR only: The file containing the subscription server login information.
pubsvrfile
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 595
EDB Postgres Replication Server User’s Guide
For MMR only: The file containing the publication server login information.
-repgrouptype
Specify s if this command applies to a single-master replication system. Specify m
if this command applies to a multi-master replication system. If omitted, the
default is s.
Examples
In the following example the schedule is printed for a subscription in a single-master
replication system.
$ java -jar edb-repcli.jar -printschedule dept_emp_sub \
> -repsvrfile ~/subsvrfile.prop
Printing subscription schedule ...
Job type Synchronize
Scheduled time 2012-06-19 13:27:20
Previous fire time 2012-06-19 13:27:20
Next fire time 2012-06-19 13:32:20
In the following example the schedule is printed for a publication in a multi-master
replication system. Note that the -repgrouptype m parameter is required in this case.
$ java -jar edb-repcli.jar -printschedule emp_pub \
> -repsvrfile ~/pubsvrfile.prop \
> -repgrouptype m
Printing subscription schedule ...
Job type Synchronize
Scheduled time 2012-06-19 13:27:55
Previous fire time Not available
Next fire time 2012-06-20 08:00:00
Cron expression 0 0 8 * * ?
8.3.46 Updating a Subscription (updatesub)
For SMR only: The updatesub command allows you to update certain metadata of a
given subscription. This metadata allows the subscription server to find the host running
the publication server that manages the publication associated with the subscription.
Synopsis
-updatesub subname
-subsvrfile subsvrfile
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 596
EDB Postgres Replication Server User’s Guide
-pubsvrfile pubsvrfile
-host newpubsvr_ipaddress
-port newpubsvr_port
The updatesub command allows you to update the subscription metadata consisting of
the IP address and port number identifying the publication server that is the parent of the
publication associated with the subscription.
This metadata is essential to the proper operation of the replication system since it is the
means by which subscription server locates the publication server whenever a replication
needs to be performed on a given subscription. The replication process is always carried
out by the publication server that manages the publication associated with the
subscription.
You would use the updatesub command in the scenario where you have built your
replication system using IP addresses that are valid at that point in time. At some later
point, the IP address assigned to the host running the publication server has changed.
You use the host and port parameters of the updatesub command to supply the new
network address identifying the publication server.
See Section 5.5.3 for additional information on updating a subscription.
Parameters
subname
The name of the subscription whose metadata is to be updated.
subsvrfile
The file containing the subscription server login information for the subscription
server in which subscription subname was created.
pubsvrfile
The file containing publication server login information for the publication server
that manages the publication associated with subscription subname. Note that the
values that you supply for newpubsvr_ipaddress and newpubsvc_port must
be the same as the values set in fields host and port in file pubsvrfile.
newpubsvr_ipaddress
The new IP address for the publication server that manages the publication
associated with subscription subname. This value must be the same as the IP
address specified for field host in file pubsvrfile.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 597
EDB Postgres Replication Server User’s Guide
newpubsvr_port
The new port number for the publication server that manages the publication
associated with subscription subname. This value must be the same as the port
number specified for field port in file pubsvrfile.
Examples
If the publication server host IP address has been changed to 192.168.2.7, then make
sure the publication server login information in file pubsvrfile.prop contains the new
IP address as shown by the following:
host=192.168.2.7
port=9051
user=enterprisedb
# Password is in encrypted form.
password=ygJ9AxoJEX854elcVIJPTw==
To update the metadata for subscription dept_emp_sub so that its subscription server
can find the new publication server host, run the following command:
$ java -jar edb-repcli.jar -updatesub dept_emp_sub \
> -subsvrfile ~/subsvrfile.prop \
> -pubsvrfile ~/pubsvrfile.prop \
> -host 192.168.2.7 \
> -port 9051
Updating subscription dept_emp_sub...
Subscription is updated successfully
8.3.47 Removing a Subscription (removesub)
For SMR only: The removesub command removes a subscription.