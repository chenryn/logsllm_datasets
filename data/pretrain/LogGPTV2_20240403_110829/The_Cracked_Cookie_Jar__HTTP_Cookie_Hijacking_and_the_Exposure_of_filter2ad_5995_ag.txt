Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:10:26 UTC from IEEE Xplore.  Restrictions apply. 
[18] N. Heninger, Z. Durumeric, E. Wustrow, and J. A. Halderman, “Mining
Your Ps and Qs: Detection of Widespread Weak Keys in Network
Devices,” in Proceedings of the 21st USENIX Security Symposium, Aug.
2012.
[19] Y. Zhou and D. Evans, “Why Arent HTTP-only Cookies More Widely
Deployed?” in Proceedings of the Web 2.0 Security and Privacy 2010
workshop, ser. W2SP ’10, 2010.
[20] S. Fogie, J. Grossman, R. Hansen, A. Rager, and P. D. Petkov, XSS
Attacks: Cross Site Scripting Exploits and Defense. Syngress, 2011.
[21] Randy Westergren. (2016) Widespread XSS Vulnerabilities in Ad Net-
work Code Affecting Top Tier Publishers. http://randywestergren.com/
widespread-xss-vulnerabilities-ad-network-code-affecting-top-tier-
publishers-retailers.
[22] N. Perlroth, J. Larson, and S. Shane. (2013, Sep.) The New York Times
- N.S.A. Able to Foil Basic Safeguards of Privacy on Web. http://www.
nytimes.com/2013/09/06/us/nsa-foils-much-internet-encryption.html.
[23] R. Gallagher. (2015, Sep.) The Intercept - From Radio to Porn, British
Spies Track Web Users Online Identities. https://theintercept.com/2015/
09/25/gchq-radio-porn-spies-track-web-users-online-identities/.
[24] A. Soltani, A. Peterson, and B. Gellman. (2013, Dec.) The Wash-
ington Post
targets for
hacking. https://www.washingtonpost.com/news/the-switch/wp/2013/12/
10/nsa-uses-google-cookies-to-pinpoint-targets-for-hacking/.
- NSA uses Google cookies to pinpoint
[25] BBC News. (2014, Jul.) NSA ’targets’ Tor web servers and users. http:
//www.bbc.com/news/technology-28162273.
[26] R. Gross and A. Acquisti, “Information Revelation and Privacy in Online
Social Networks,” in Proceedings of the 2005 ACM Workshop on Privacy
in the Electronic Society, ser. WPES ’05, 2005.
[27] I. Polakis, G. Argyros, T. Petsios, S. Sivakorn, and A. D. Keromytis,
“Where’s wally? precise user discovery attacks in location proximity
services,” in CCS ’15, 2015, pp. 817–828.
[28] A. Hannak, P. Sapiezynski, A. Molavi Kakhki, B. Krishnamurthy,
D. Lazer, A. Mislove, and C. Wilson, “Measuring Personalization of
Web Search,” in Proceedings of the 22nd International Conference on
World Wide Web, ser. WWW ’13, 2013.
[29] X. Xing, W. Meng, D. Doozan, A. C. Snoeren, N. Feamster, and W. Lee,
“Take This Personally: Pollution Attacks on Personalized Services,” in
Proceedings of the 22nd USENIX Security Symposium, 2013.
[30] A. Chaabane, G. Acs, and M. A. Kaafar, “You Are What You Like!
Information Leakage Through Users Interests,” in Proceedings of the
Network and Distributed System Security Symposium, ser. NDSS ’12,
2012.
[31] comScore.
Aug.)
July
2015
Desktop
http://www.comscore.com/
U.S.
Search
Insights/Market-Rankings/comScore-Releases-July-2015-U.S.
-Desktop-Search-Engine-Rankings?
Rankings.
(2015,
Engine
[32] A. Acquisti, R. Gross, and F. Stutzman, “Faces of facebook: Privacy in
the age of augmented reality,” BlackHat, 2011.
[33] I. Polakis, G. Kontaxis, S. Antonatos, E. Gessiou, T. Petsas, and E. P.
Markatos, “Using Social Networks to Harvest Email Addresses,” in
Proceedings of
the 9th Annual ACM Workshop on Privacy in the
Electronic Society, ser. WPES ’10, 2010.
[34] F. M. Harper, D. Raban, S. Rafaeli, and J. A. Konstan, “Predictors
of Answer Quality in Online Q&Amp;A Sites,” in Proceedings of the
SIGCHI Conference on Human Factors in Computing Systems, ser. CHI
’08, 2008.
[35] D. Pelleg, E. Yom-Tov, and Y. Maarek, “Can You Believe an Anonymous
Contributor? On Truthfulness in Yahoo! Answers,” in SOCIALCOM-
PASSAT ’12, 2012.
[36] J. A. Calandrino, A. Kilzer, A. Narayanan, E. W. Felten, and
V. Shmatikov, “You Might Also LIke: Privacy Risks of Collaborative
Filtering,” in Proceedings of the 2011 IEEE Symposium on Security and
Privacy, 2011.
[37] J. Y. Tsai, S. Egelman, L. Cranor, and A. Acquisti, “The Effect of Online
Privacy Information on Purchasing Behavior: An Experimental Study,”
Info. Sys. Research, vol. 22, no. 2, 2011.
[38] N. Christin, S. S. Yanagihara, and K. Kamataki, “Dissecting One Click
Frauds,” in Proceedings of the 17th ACM Conference on Computer and
Communications Security, 2010.
[39] U. Chareca, “Inferring user demographics from reading habits,” Master’s
thesis, Link¨oping University, 2014.
[40] J. R. Mayer and J. C. Mitchell, “Third-Party Web Tracking: Policy and
Technology,” in Proceedings of the 2012 IEEE Symposium on Security
and Privacy, 2012.
[41] F. Roesner, T. Kohno, and D. Wetherall, “Detecting and Defending
Against Third-party Tracking on the Web,” in Proceedings of the 9th
USENIX Conference on Networked Systems Design and Implementation,
ser. NSDI ’12, 2012.
[42] P. Gill, V. Erramilli, A. Chaintreau, B. Krishnamurthy, K. Papagiannaki,
and P. Rodriguez, “Follow the Money: Understanding Economics of
Online Aggregation and Advertising,” in Proceedings of
the 2013
Conference on Internet Measurement Conference, ser. IMC ’13, 2013.
[43] P. Barford, I. Canadi, D. Krushevskaja, Q. Ma, and S. Muthukrishnan,
“Adscape: Harvesting and Analyzing Online Display Ads,” in Proceed-
ings of the 23rd International Conference on World Wide Web, ser.
WWW ’14, 2014.
[44] A. Datta, M. C. Tschantz, and A. Datta, “Automated Experiments on
Ad Privacy Settings: ATale of Opacity, Choice, and Discrimination,”
Proceedings on Privacy Enhancing Technologies, vol. 2015, no. 1, 2015.
[45] M. L´ecuyer, G. Ducoffe, F. Lan, A. Papancea, T. Petsios, R. Spahn,
A. Chaintreau, and R. Geambasu, “XRay: Enhancing the Web’s Trans-
parency with Differential Correlation,” in Proceedings of
the 23rd
USENIX Security Symposium, 2014.
[46] A. Korolova, “Privacy violations using microtargeted ads: A case study,”
in Proceedings of the 2010 IEEE International Conference on Data
Mining Workshops, ser. ICDMW ’10, 2010.
[47] A. Kapravelos, C. Grier, N. Chachra, C. Kruegel, G. Vigna, and
V. Paxson, “Hulk: Eliciting Malicious Behavior in Browser Extensions,”
in Proceedings of the 23rd USENIX Security Symposium, 2014.
[48] Cisco. (2015, May) Visual Networking Index, Global Trafﬁc Forecast.
https://www.cisco.com/c/en/us/solutions/collateral/service-provider/
ip-ngn-ip-next-generation-network/white paper c11-481360.html.
[49] PurpleWiFi.
use WiFi
latest-survey-people-use-wiﬁ-public-places/.
Jun.) Our
public
latest
places?
(2014,
in
survey: how do people
http://www.purplewiﬁ.net/
[50] R. Dingledine, N. Mathewson, and P. Syverson, “Tor: The Second-
generation Onion Router,” in Proceedings of the 13th USENIX Security
Symposium, ser. SSYM ’04, 2004.
[51] EFF. HTTPS Everywhere. https://www.eff.org/https-Everywhere.
[52] X. Zheng, J. Jiang, J. Liang, H. Duan, S. Chen, T. Wan, and N. Weaver,
“Cookies Lack Integrity: Real-World Implications,” in Proceedings of
the 24th USENIX Security Symposium, 2015.
[53] A. P. Felt, A. Ainslie, R. W. Reeder, S. Consolvo, S. Thyagaraja,
A. Bettes, H. Harris, and J. Grimes, “Improving SSL Warnings: Compre-
hension and Adherence,” in Proceedings of the Conference on Human
Factors and Computing Systems, 2015.
[54] B. Potter, “Wireless Hotspots: Petri Dish of Wireless Security,” Commun.
ACM, vol. 49, no. 6, Jun. 2006.
[55] A. Bortz, A. Barth, and A. Czeskis, “Origin cookies: Session integrity for
web applications,” in Proceedings of the Web 2.0 Security and Privacy
2011 workshop, ser. W2SP ’11, 2011.
[56] R. Wang, S. Chen, and X. Wang, “Signing Me onto Your Accounts
through Facebook and Google: a Trafﬁc-Guided Security Study of
Commercially Deployed Single-Sign-On Web Services,” in Proceedings
of the 2012 IEEE Symposium on Security and Privacy, 2012.
[57] C. Karlof, U. Shankar, J. D. Tygar, and D. Wagner, “Dynamic Pharm-
ing Attacks and Locked Same-origin Policies for Web Browsers,” in
Proceedings of the 14th ACM Conference on Computer and Communi-
cations Security, 2007.
[58] S. Lekies, B. Stock, M. Wentzel, and M. Johns, “The Unexpected
Dangers of Dynamic JavaScript,” in Proceedings of the 24th USENIX
Security Symposium, 2015.
[59] A. Barth, C. Jackson, and J. C. Mitchell, “Robust Defenses for Cross-
Site Request Forgery,” in Proceedings of the 15th ACM Conference on
Computer and Communications Security, 2008.
[60] N. Nikiforakis, W. Meert, Y. Younan, M. Johns, and W. Joosen,
“SessionShield: Lightweight Protection against Session Hijacking,” in
Engineering Secure Software and Systems, ser. ESSoS ’11, 2011.
[61] P. De Ryck, L. Desmet, F. Piessens, and W. Joosen, “SecSess: Keeping
Your Session Tucked Away in Your Browser,” in Proceedings of the 30th
Annual ACM Symposium on Applied Computing, ser. SAC ’15, 2015.
[62] M. Johns, “SessionSafe: Implementing XSS Immune Session Handling,”
in Proceedings of the 11th European conference on Research in Com-
puter Security, ser. ESORICS’ 06, 2006.
[63] C. Jackson and A. Barth, “ForceHTTPS: Protecting high-security web
sites from network attacks,” in Proceedings of the 17th International
World Wide Web Conference, ser. WWW ’08, 2008.
740740
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:10:26 UTC from IEEE Xplore.  Restrictions apply. 
[64] J. Selvi, “Bypassing HTTP Strict Transport Security,” BlackHat-EU,
2014.
[65] K. Bhargavan, A. Delignat-Lavaud, C. Fournet, , A. Pironti, and P.-Y.
Strub, “Triple Handshakes and Cookie Cutters: Breaking and Fixing
Authentication over TLS,” in Proceedings of the 2014 IEEE Symposium
on Security and Privacy, 2014.
[66] S. Sivakorn, I. Polakis, and A. D. Keromytis, “I am robot: (deep) learning
to break semantic image captchas,” in IEEE European Symposium on
Security and Privacy (EuroS&P) 2016.
[67] E. Toch, Y. Wang, and L. Cranor, “Personalization and privacy: a survey
of privacy risks and remedies in personalization-based systems,” User
Modeling and User-Adapted Interaction, vol. 22, no. 1-2, 2012.
[68] P. Chen, N. Nikiforakis, C. Huygens, and L. Desmet, “A dangerous mix:
Large-scale analysis of mixed-content websites,” in Proceedings of the
16th Information Security Conference, 2013.
[69] J. Clark and P. C. van Oorschot, “SoK: SSL and HTTPS: Revisiting
Past Challenges and Evaluating Certiﬁcate Trust Model Enhancements,”
in Proceedings of the 2013 IEEE Symposium on Security and Privacy.
[70] S. Chen, Z. Mao, Y.-M. Wang, and M. Zhang, “Pretty-bad-proxy: An
overlooked adversary in browsers’ https deployments,” in Proceedings
of the 2009 IEEE Symposium on Security and Privacy, 2009.
[71] Z. Durumeric, J. Kasten, D. Adrian, J. A. Halderman, M. Bailey, F. Li,
N. Weaver, J. Amann, J. Beekman, M. Payer, and V. Paxson, “The Matter
of Heartbleed,” in Proceedings of the 2014 Conference on Internet
Measurement Conference, ser. IMC ’14, 2014, pp. 475–488.
[72] D. Adrian, K. Bhargavan, Z. Durumeric, P. Gaudry, M. Green, J. A.
Halderman, N. Heninger, D. Springall, E. Thom´e, L. Valenta, B. Vander-
Sloot, E. Wustrow, S. Zanella-B´eguelin, and P. Zimmermann, “Imperfect
Forward Secrecy: How Difﬁe-Hellman Fails in Practice,” in Proceedings
of the 22nd ACM Conference on Computer and Communications Secu-
rity, 2015.
[73] S. Fahl, M. Harbach, T. Muders, L. Baumg¨artner, B. Freisleben, and
M. Smith, “Why Eve and Mallory Love Android: An Analysis of
Android SSL (in)Security,” in Proceedings of the 2012 ACM Conference
on Computer and Communications Security, 2012.
[74] S. Fahl, M. Harbach, H. Perl, M. Koetter, and M. Smith, “Rethinking
SSL Development in an Appiﬁed World,” in Proceedings of the 2013
ACM SIGSAC Conference on Computer and Communications Security,
2013.
[75] M. Huber, M. Mulazzani, and E. Weippl, “Tor http usage and informa-
tion leakage,” in Communications and Multimedia Security, 2010.
[76] S. Chakravarty, G. Portokalidis, M. Polychronakis, and A. D. Keromytis,
“Detecting Trafﬁc Snooping in Tor Using Decoys,” in Recent Advances
in Intrusion Detection, 2011.
[77] P. Winter, R. K¨ower, M. Mulazzani, M. Huber, S. Schrittwieser, S. Lind-
skog, and E. Weippl, “Spoiled Onions: Exposing Malicious Tor Exit
Relays,” in Privacy Enhancing Technologies Symposium, 2014.
A. Information Leakage
APPENDIX
Here we provide some details or information on certain
services that were omitted from Section III.
Doubleclick. Figure 6 contains screenshots of our experi-
ment that demonstrates how ad networks can reveal parts of a
user’s browsing history.
CNN. Almost the entire website runs over HTTP, including
the login page, which can be exploited by active adversaries
to modify or inject content. The credentials, however, are
sent over HTTPS, preventing eavesdroppers from hijacking
the user’s session. Nonetheless, the HTTP cookie allows the
attacker to view and edit the user’s proﬁle, which includes ﬁrst
and last name, postal address, email and phone number, proﬁle
picture and link to the user’s Facebook account. Furthermore,
the attacker can write or delete article comments, and also
obtain the recently viewed or created reports on iReport,
CNN’s citizen journalism portal6.
6http://ireport.cnn.com/
(a) Browsed page
(b) Attacker
browsed page.
receives ads exposing
Fig. 6. Side-channel leak of user’s browsing history by the Doubleclick ad
network.
New York Times. The HTTP cookie allows the adversary
to obtain or change the user’s proﬁle photo, name and last
name, a link pointing to a personal homepage, and a short
personal description (bio). The adversary can also obtain and
edit the list of articles that the user has saved.
The Guardian. Stolen HTTP cookies provide access to the
user’s public proﬁle sections, which includes a proﬁle picture
and username, a short bio, the user’s interests, and previous
comments on articles. The adversary can also post comments
as the user.
Hufﬁngton Post. Similar to CNN, almost the entire website
runs overs unencrypted connections, and the HTTP cookie
allows read and edit access to the user’s proﬁle, article
subscriptions, comments, fans and followings. The proﬁle
includes the user’s login name, proﬁle photo, email address,
biography, postal code, city and state. The attacker can also
change the user’s password, or delete the account.
{"User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS
9_0_2 like Mac OS X) AppleWebKit/601.1.46
(KHTML, like Gecko) Mobile/13A452",
"cookie_name": "amzn-app-ctxt",
"cookie_value": "1.4%20
{"os":"iOS"
"ov":"9.0.2"
"an":"Amazon"
"av":"5.3.0"
"dm":{"w":"640" "h":"960" "ld":"2.000000"}
"uiv":5 "nal":1
"cp":8xxxxx
"xv":"1.11"
"di":{"ca":"AT&T"
"ct":"Wifi"
"mf":"Apple"
"pr":"iPhone"
"md":"iPhone"
"v":"4S"
"dti":"A287xxxxxxxxxx"
}}"
}
Listing 2. User information disclosed in the value attribute of Walmart’s
HTTP customer cookie (values have been changed for privacy).
Amazon. the adversary can obtain information regarding
previously purchased items either through the recommendation
page (Figure 7(a)) or through product pages (Figure 7(b)). The
iOS versions of the Amazon app also exposes information
about the user’s mobile device, as shown in Listing 2.
Ebay. Apart from the login and checkout pages, the re-
maining Ebay website runs over HTTP. As a result, the stolen
741741
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:10:26 UTC from IEEE Xplore.  Restrictions apply. 
arbitrary items. The attacker can also deploy the two afore-
mentioned extortion scams.
{"domain": ".walmart.com",
"name": "customer",
"path": "/",
"secure": false,
"httpOnly": false,
"value": "%7B%22firstName%22%3A%22JANE%22%2C%22
lastName%22%3A%22DOE%22%2C%22
emailAddress%22%3A%22janedoe%40example.com%22%2C%22
isMigrated%22%3Atrue%2C%22
omsCustomerId%22%3A%22xxxxxxx9%22%2C%22
ReviewUser%22%3A%7B%22isValid%22%3Atrue%2C%22
AdditionalFieldsOrder%22%xxxxxxxx%2C%22
Avatar%22%3A%7B%7D%2C%22
UserNickname%22%3A%22xxxxxxxxx%22%2C%22
Photos%22%3A%5B%5D%2C%22
ContextDataValues%22%xxxxxxxx%2C%22
Videos%22%3A%5B%5D%2C%22
ContextDataValuesOrder%22%3A%xxxxxxxxxC%22
SubmissionId%22%3Axxxxx%2C%22
ContributorRank%22%3A%22xxxx%22%2C%22
StoryIds%22%xxxxxxxxC%22
AnswerIds%22%xxxxxx%2C%22
QuestionIds%22xxxxxxD%2C%22
BadgesOrder%22xxxxxx%2C%22
Badges%22%xxxxxxxxx2C%22
Location%22%3Axxxxx%2C%22
SecondaryRatingsOrder%22xxxxxx%2C%22
ProductRecommendationIds%22%3A%xxxxxxxxx2C%22
AdditionalFields%22%3A%7B%7D%2C%22
SubmissionTime%22%3A%2220xx-xx-xxxxxxxxxxxxx%22%2C%22
ModerationStatus%22%3A%22APPROVED%22%2C%22
ReviewIds%22%3xxxxxxx%2C%22
ThirdPartyIds%22%xxxxxxxxxxC%22
Id%22%3A%22ff79xxxxxxxxxxxxxx509dc5%22%2C%22
CommentIds%22%3A%5B%5D%2C%22
SecondaryRatings%22%3Axxxxx%2C%22
LastModeratedTime%22%3A%2220xxxxxxxxxxxxxxxx%22%2C%22
reviewStatus%22%3A%7B%22
hasReview%22%3Axxxxx%7D%7D%7D"
}
Listing 3. User information disclosed in the value attribute of Walmart’s
HTTP customer cookie (values have been changed for privacy).
(a) Recommendations Page
(b) Product Page
Fig. 7. Obtaining information about previously purchased items from user’s
Amazon account.
HTTP cookie gives the adversary access to both personal
information and account functionality.
Personal information. The site always reveals the user’s ﬁrst
name. Also, depending on what the victim uses for logging
in (username or email address) is also exposed. By forging a
cookie with the same value but a different scope (domain and
path), we are also able to obtain the user’s delivery address.
The HTTP cookies can also access the user’s messages, which
are normally served over HTTPS.
History. The cookie provides access to the functionality that
exposes the victim’s purchase history, and also allows us to
view and edit the items in the victim’s watch and wish-lists.
We can also see which items have been bought or bid upon
in the past, and all the items being sold by the. victim.
Cart. Similarly to the other e-commerce websites we tested,
the HTTP cookie enables access to the cart,. for viewing items
already in it, or adding/removing items.
the website will reveal
Walmart. If the adversary appends the stolen cookies when
connecting,
the user’s ﬁrst name,
postcode, and also allow editing of the cart. However, upon
inspection, we found that the customer HTTP cookie ac-
tually contains 34 ﬁelds of information about the user within
its value attribute. Apart from the subset that can be seen
in Listing 3, which includes the user’s ﬁrst and last name and
email address, the cookie also contains ID information that
points to the user’s reviews and comments, and a tracking ID
for third parties.
Target. As with most e-commerce sites, the stolen cookie
reveals the user’s ﬁrst name, email address, and the ability to
view and edit the cart, and the user’s wish-list. Furthermore,
it also reveals items recently viewed by the user.
Vendor-assisted attacks. The cookie exposes function-
ality that can be leveraged for deploying spam, simi-
larly to Amazon. The attacker can either add items in
the cart and send an email about
those items (sent by
PI:EMAIL), or create and send a
wish-list (sent by PI:EMAIL). In
both cases, the emails explicitly contain the user’s full name
(thus, making the last name obtainable to the attacker). While
the attacker cannot include any text, which would facilitate
deploying spam or phishing campaigns, one could promote
742742
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:10:26 UTC from IEEE Xplore.  Restrictions apply.