As ğœğ‘’ â‰¤ 2 ğ‘›âˆ’ğ‘˜
2
, we obtain
2 Â· ğœğ‘’(ğœğ‘’ âˆ’ 1)
2ğ‘›âˆ’ğ‘˜
ğ‘–
2ğ‘›âˆ’ğ‘˜ = 1 âˆ’ 1
(cid:21)
.
(27)
Pr
AğºIdeal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
â‰¥ 1
2 .
Recall that in the real world, ğ‘Šğ‘— = [ğœ‹(ğ‘âˆ¥ğ¾âˆ¥ğ‘–âˆ¥ğ‘)]ğ¾-. Thus, if
ğ‘Šğ‘— â‰  ğ‘Šğ‘—â€², then the two corresponding calls to the underlying ideal
permutation are distinct. As ğ‘Šğ‘— â‰  ğ‘Šğ‘—â€² for all ğ‘— â‰  ğ‘—â€², the adversary
outputs 1 only if it makes ğœğ‘’ distinct calls to the underlying ideal
permutation that doesnâ€™t collide on the first ğ‘› âˆ’ ğ‘˜ bit with the
previous queries,
(cid:20)
(cid:18)
ğœğ‘’âˆ’1
ğ‘–=0
ğœğ‘’âˆ’1âˆ‘ï¸
ğ‘–=0
(cid:19)
(cid:20)
Pr
=
AğºReal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
=
(cid:32) 2ğ‘› âˆ’ ğ‘– Â· 2ğ‘˜
(cid:33)
2ğ‘› âˆ’ ğ‘–
ğœğ‘’âˆ’1
ğ‘–=0
=
= Pr
AğºIdeal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
ğ‘–=0
Moreover, as (2ğ‘› âˆ’ ğ‘–) Â· (2ğ‘› + ğ‘–) â‰¤ 22ğ‘›, then
(cid:19)
(cid:21)
(cid:18)
ğ‘–=0
1 âˆ’ ğ‘–
2ğ‘›âˆ’ğ‘˜
Â·
ğœğ‘’âˆ’1
(cid:32)
(cid:33)
1 âˆ’ ğ‘–(2ğ‘˜ âˆ’ 1)
(cid:18) 2ğ‘›
(cid:19)
ğœğ‘’âˆ’1
2ğ‘› âˆ’ ğ‘–
(cid:18) 2ğ‘›
(cid:19)
ğœğ‘’âˆ’1
(cid:19)
(cid:18)
ğœğ‘’âˆ’1
2ğ‘› âˆ’ ğ‘–
(cid:19)
ğ‘–=0
Â·
.
1 + ğ‘–
2ğ‘›
.
=
ğ‘–=0
2ğ‘› âˆ’ ğ‘–
ğ‘–=0
(cid:20)
ğœğ‘’âˆ’1
(cid:20)
ğœğ‘’âˆ’1
ğœğ‘’âˆ’1
(cid:20)
(cid:20)
ğ‘–=0
Pr
(cid:21)
(cid:18) 2ğ‘› + ğ‘–
ğœğ‘’âˆ’1âˆ‘ï¸
(cid:21)
2ğ‘›
ğ‘–
(cid:19)
(cid:19)
(cid:18) 2ğ‘›
(cid:18)
2ğ‘› âˆ’ ğ‘–
1 + ğ‘–
2ğ‘›
ğœğ‘’âˆ’1
ğ‘–=0
â‰¥
â‰¥ 1 +
Using Weierstrass product inequality,
ğ‘–=0
AğºReal-muAE
ğ‘–=0
ChaCha20-Poly1305[ğœ‹] â‡’ 1
Thus, Pr
AğºIdeal-muAE
ChaCha20-Poly1305[ğœ‹] â‡’ 1
.
2ğ‘› = 1 + ğœğ‘’(ğœğ‘’ âˆ’ 1)
2ğ‘›+1
(cid:19)
(cid:18)
(cid:21)
is greater or equal to
1 + ğœğ‘’(ğœğ‘’ âˆ’ 1)
Â·
2ğ‘›+1
.
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea2002hence 2âˆ’ğ‘ğ‘‘. Throwing up to ğ‘ balls means there are at most(cid:0) ğ‘
(cid:1)
ğ‘‘+1
sets of ğ‘‘ + 1 balls. So, by the union bound,
Pr(cid:104)B sets bad in ğºIdeal-muAE
(cid:105) â‰¤
ğ›± [ğœ‹]
(cid:19)
(cid:18) ğ‘
ğ‘‘ + 1
We can now apply Case 4 of Lemma A.1 with ğ‘š = ğ‘‘+1, ğ‘„ = ğ‘, ğµ =
2âˆ’ğ‘,(cid:101)ğ‘š = ğ›¿ğ‘, and ğ‘¡ = 2, to upper-bound the bad-event probability
that any bin contains ğ‘š = ğ‘‘ + 1 or more balls at ğ‘¡âˆ’(cid:101)ğ‘š = 2âˆ’ğ›¿ğ‘ as
claimed. For ğ‘ â‰¤ 2ğ‘ Â· (ğ›¿+1)Â·ğ‘
Â· 2âˆ’ğ‘ğ‘‘ .
(cid:24)
3
, we obtain
(ğ›¿ + 1) Â· ğ‘
max(1, ğ‘ âˆ’ log2(ğ‘))
(cid:25)
âˆ’ 1. â–¡
ğ‘‘ = ğ‘š âˆ’ 1 =
(cid:21)
Therefore,
ChaCha20-Poly1305[ğœ‹](A) â‰¥
muAE
ğœğ‘’(ğœğ‘’ âˆ’ 1)
Adv
ChaCha20-Poly1305[ğœ‹] â‡’ 1
The final bound is obtained by applying (27) to this inequality.
AğºIdeal-muAE
2ğ‘›+1
Â· Pr
.
D PROOF FOR NONCE RANDOMIZATION (XN
TRANSFORM)
The proof follows the same strategy as for [15, Theorem 4.2], but
then applies our generalized bound from Lemma A.1. The ğ‘‘-repeat-
ing reduction B samples nonce randomizer values ğ½ğ‘– for each user ğ‘–,
used to derive the effective nonce ğ‘âˆ— = ğ‘ âŠ• ğ½ in encryption and
verification queries forwarded to its multi-user AE game. It keeps a
counter for any used nonce value ğ‘âˆ— in encryption queries, count-
ing the number of users for which B queried this effective nonce
to its encryption oracles. When any such counter reaches ğ‘‘ + 1, B
sets a bad flag bad, stops immediately, and outputs 1 (ensuring that
B is ğ‘‘-repeating4); otherwise, B relays the bit output by A.
In the real world,
(cid:20)
(cid:20)
(cid:20)
(cid:21)
Pr
BğºReal-muAE
ğ›± [ğœ‹] â‡’ 1
â‰¥ Pr
AğºReal-muAE
ğ›±âˆ— [ğœ‹] â‡’ 1
,
(cid:21)
Pr
(cid:21)
(cid:20)
muAE
ğ›± [ğœ‹]
ğ›± [ğœ‹]
(cid:105),
AğºIdeal-muAE
BğºIdeal-muAE
ğ›± [ğœ‹] â‡’ 1
ğ›±âˆ— [ğœ‹] â‡’ 1
as B either outputs 1 or repeats Aâ€™s output. Furthermore, B simu-
lates the ideal world for A perfectly until the bad flag is set, by the
identical-until-bad lemma [3],
â‰¤ Pr
(cid:20)
(cid:21)
+ Pr(cid:104)B sets bad in ğºIdeal-muAE
(cid:105) .
ğ›±âˆ—[ğœ‹](A) âˆ’ Pr(cid:104)B sets bad in ğºIdeal-muAE
Overall, this yields
ğ›± [ğœ‹] (B) â‰¥ Adv
muAE
In ğºIdeal-muAE
Adv
so it remains to bound the probability of B setting bad in the ideal
world game.
, the oracles answer independently of the queried
ğ›± [ğœ‹]
effective nonces and Bâ€™s randomizer values ğ½ğ‘–. The bad flag is set
when across all encryption (and, for the strongly ğ‘‘-repeating case,
also verification) queries, an effective nonce derived by B is used
across ğ‘‘ + 1 users. We can view each effective nonce ğ‘âˆ— queried
to a user ğ‘–, as throwing a ball ğ‘– into one of 2ğ‘ bins, where the bin
represents the nonce queried. In total, we throw at most ğ‘ balls,
where ğ‘ = ğ‘ğ‘’ for the ğ‘‘-repeating case and ğ‘ = ğ‘ğ‘’ + ğ‘ğ‘£ for the
strongly ğ‘‘-repeating case. With this perspective, if the flag bad
is set, then there exist a set of ğ‘‘ + 1 balls corresponding to ğ‘‘ + 1
distinct user in the same bin. Thus we can bound the probability
that bad is set by the probability that there exist a set of ğ‘‘ + 1 balls
corresponding to ğ‘‘ + 1 distinct user in the same bin.
For distinct users, the ball throws are independent and uniformly
random distributed through the randomizer values ğ½ğ‘–. The proba-
bility for any set of ğ‘‘ + 1 balls of distinct users to hit the same bin is
4For the strongly ğ‘‘-repeating case, B counts the number of users using a particular
effective nonce ğ‘ âˆ— across both its encryption and verification queries. Aborting when
a counter reaches ğ‘‘ + 1 then ensures B is strongly ğ‘‘-repeating.
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea2003