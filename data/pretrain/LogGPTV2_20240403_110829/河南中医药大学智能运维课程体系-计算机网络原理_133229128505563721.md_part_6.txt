不超过65535字节一
有效
IPv6数据报-
项功能。
取消了选项字段，而用扩展首部来实现选
取消了检验和字段；
取消了协议字段，改用下一个首部字段；
把TTL字段改称为跳数限制字段；
数据部分
载
荷
般形
5.1 IPv6 的基本首部
5.1 IPv6的基本首部
130
129
9
---
## Page 66
5. IPv6
5. IPv6
版本通信量类
版本
通信量类
40字节长的IPv6基本首部
有效载荷（扩展首部／数据）
40字节长的IPv6基本首部
有效载荷（扩展首部／数据）
目的地址
目的地
流标号
跳数限制
跳数限制
就要将此数据报丢弃。
的值减1。当跳数限制的值为零时，
数据报发出时即设定跳数限制。路
跳数限制(hop limit)：8位。源站存
当于 IPv4 的协议字段或可选字段。
效载荷之内）
位。指明 IPv6 数据报除基本首部以
有效载荷长度(payload length):16 
同样的流标号。
的一系列数据报，
是互联网络上从特定源点到特定终点
流标号(flow label)：20 位。
性能的实验。
先级。目前正在进行不同的通信量类
通信量类(traffic class):：8 位。为了
版本(version)：4 位。指明了协议的
下
在转发数据报时将跳数限制字段中
所有属于同一
个流的数据报都具有
5.1 IPv6 的基本首部
“流”所经过的路
5.1IPv6的基本首部
“流”
132
131
中
苗
在
相
9
---
## Page 67
口IPv6把原来IPv4 首部中选项的功能都放在扩展首部中，并将扩展首部留
5. IPv6
5. IPv6
口
口
在RFC 2460中定义了六种扩展首部：
即逐跳选项扩展首部），极大提高了路由器的处理效率。
数据报途中经过的路由器都不处理这些扩展首部（只有一个首部例外，
给路径两端的源站和目的站的主机来处理。
■分片
■路由选择
■逐跳选项
版本
有效
通信量类
业
40字节长的IPv6基本首部
有效载荷（扩展首部／数据）
目的地址
■封装安全有效载荷
■鉴别
目的站选项
流标号
跳数限制
站的IP 地址。
目的地址：128位。是数据报的接收
的IP 地址。
源地址：128位。是数据报的发送站
5.2IPv6的扩展首部
5.1IPv6的基本首部
134
133
6
---
## Page 68
口IPv6 地址是分配给节点上接口的。
口
口 IPv6 将实现 IPv6 的主机和路由器均称为节点。
5. IPv6
口IPv6 数据报的目的地址可以是以下三种基本类型地址之一：
5. IPv6
一个节点可能有多个与链路相连的接口。
■其中的任何一个地址都可以当作到达该节点的目的地址。
■一个具有多个接口的节点可以有多个单播地址。
■任播(anycast):
■多播(multicast)：
■单播(unicast)：
一点对多点的通信。
口传统的点对点通信
口通常是按照路由算法得出的距离最近的一个。
口任播的目的站是一组计算机，但数据报在交付时只交付其中的一个。
口这是 IPv6 增加的一种类型。
5.3 IPv6 地址
5.3IPv6地址
136
135
8
---
## Page 69
5. IPv6
口冒号十六进制记法
5. IPv6
■十六进制记法中，
■每个16位的值用十六进制值表示，各值之间用冒号分隔。例如：
■在IPv6 中，每个地址占128 位，地址空间大于3.4×1038。
略，写成1个0。例如：
notation,简写为 colon hex)。
为了使地址再稍简洁些，IPv6 使用冒号十六进制记法(colon hexadecimal 
68E6:8C64:FFF:FF:0:1180:960A:FFFF
 68E6:8C64:FFFF:FFFF:0000:1180:960A:FFFF
零压缩
，允许把数字前面的0省略。例如把 0000中的前三个0 省
冒号十六进制法的两个技术
点汾十进制
的
5.3 IPv6 地址
5.3IPv6地址
138
137
9
---
## Page 70
口点分十进制记法的后缀
5. IPv6
口零压缩
5. IPv6
■CIDR的斜线表示法仍然可用，但取消了子网掩码。
■注意：在任一地址中只能使用一次零压缩。
IPv6的转换阶段特别有用。
口例如：FFO5:0:0:0:0:0:0:B3可压缩为 FFO5:B3
可以为一对冒号所取代。
口或记为：
口或记为：1
口可记为：12AB:0000:0000:CD30:0000:0000:0000:0000/60
口例如：60位的前缀12AB00000000CD3
口使用零压缩即可得出：::128.10.2.1
口例如：0:0:0:0:0:0:128.10.2.1
0:0:0:0:0:0:0:0（未指明地址）
0:0:0:0:0:0:0:1（环回地址）
FF01:0:0:0:0:0:0:101（多播地址）
1080:0:0:0:8:800:200C:417A
0:0:0:0:0:0:128.10.2.1
12AB:0:0:CD30:/60
12AB::CD30:0:0:0:0/60
+
(零压缩)
（零压缩）
：:
三
FF01:101
1080:8:800:200C:417A
:128.10.2.1
南中医药大学信息技
5.3 IPv6 地址
5.3IPv6地址
140
139
---
## Page 71
口IPv6 地址分类
5. IPv6
5. IPv6
■环回地址
■未指明地址
全球单播地址
本地链路单播地址
多播地址
环回地址
未指明地址
口作用和IPv4 的环回地址一样。
口即0:0:0:0:0:0:0:1（记为::1）。
口这类地址仅此一个。
口这个地址只能为还没有配置到一个标准的IP 地址的主机当作源地址使用。
口这是16字节的全0地址，可缩写为两个冒号""。
口
这类地址也是仅此一个。
地址类型
除上述四种外，所有其他的二进制前缀
11111111（8位），功能和IPv4的一样
00...1（128位），仅此一个
0...0（128位），仅此一个
IPv6地址分类
二进制前缀
FF00:/8
:1/128
:/128
IPv6记法
5.3 IPv6 地址
5.3IPv6地址
142
141
L
---
## Page 72
口IPv6 地址分类
5. IPv6
口IPv6 地址分类
5. IPv6
■全球单播地址
■本地链路单播地址(Link-Local Unicast Address)
■多播地址
口曾提出过多种方案来进一步划分这128 位的单播地址。
口 IPv6 的这一类单播地址是使用得最多的一类。
口连接在这样的网络上的主机都可以使用这种本地地址进行通信，
口有些单位的网络使用 TCP/IP协议，但并没有连接到互联网上。
口这类地址占IPv6地址总数的1/256。
口功能和 IPv4的一样。
口
口
这类地址占 IPv6 地址总数的1/1024。
全球路由选择前缀（n bit)
子网前缀(nbit)
IPv6单播地址的几种划分方法
子网标识符(m bit)
结点地址(128bit)
接口标识符（128-n）bit
接口标识符(128-n-m）bit
，但不能和互联网
5.3 IPv6 地址
5.3IPv6地址
144
143
---
## Page 73
口双协议栈
5. IPv6
口两种向IPv6过渡的策略：
口向 IPv6 过渡只能采用逐步演进的办法，还必须使新安装的 IPv6 系统能 
5. IPv6
■根据DNS返回的地址类型可以确定使用IPv4 地址还是IPv6 地址。
■双协议栈主机在和IPv6主机通信时是采用IPv6 地址，而和 IPv4主机通信时
■双协议栈(dual stack)是指在完全过渡到 IPv6 之前，使一部分主机(或路由
■使用隧道技术
■使用双协议栈
■能够为IPv4分组选择路由。
■IPv6系统必须能够接收和转发IPv4分组。
够向后兼容：
■
双协议栈的主机（或路由器）记为IPv6/IPv4，表明它同时具有两种IP地址:
个 IPv6 地址和一个
5.4 从 IPv4 向 IPv6 过渡
5.4从IPv4向IPv6过渡
146
145
3
---
## Page 74
5. IPv6
口双协议栈
5. IPv6
IPv6
IPv6 PDU
数据部分
到IPv4系统
使用双协议栈进行从IPv4到IPv6的过渡
双协议栈
IPv6/IPv4双协议栈主机（或路由器）
链路层和以
IPv4数据报
数据部分
运输层
应用层
IPv4
X
IPv4
IPv4网络
IPv4 网络
I→
IPv4
源地址：
IPv4数据报
数据部分
IPv6 
到IPv6系统
IPv6 PDU
数据部分
"x
IPve
5.4从IPv4向IPv6过渡
5.4从IPv4向IPv6过渡
148
147
L
---
## Page 75
5. IPv6
口隧道技术
5. IPv6
当IPV4 数据报离开IPV4 网络中的隧道时，再把数据部分（即原来的IPV6 数
整个的IPV6数据报变成了IPV4数据报的数据部分。
Pv6
A
IPv6 PDU
数据部分
使用隧道技术进行从IPv4到IPv6的过渡
IPv4数据报
地址：F
▼
IPv4
IPv4网络
IPv4 网络
I→
_把IPv6数据报封装成为IPv4数据报,
源地址：AF
IPv4数据报
IPv6 PDU
数据部分
"x
IPve
5.4从IPv4向IPv6过渡
5.4从IPv4向IPv6过渡
149
15
---
## Page 77
 ICMPv6 
5. IPv6
 ICMPv6
5. IPv6
■ICMPv6 还增加了几个定义报文的功能及含义的其他协议。
■ICMPv6 是面向报文的协议，它利用报文来报告差错，获取信息，探测邻站
■地址解析协议 ARP和网际组管理协议IGMP协议的功能都已被合并到
■IPv6 也需要使用ICMP 来反馈一些差错信息，新的版本称为 ICMPv6。
■IPv6 也不保证数据报的可靠交付，互联网中的路由器可能会丢弃数据报。
或管理多播通信。
ICMPv6 中。
差错报文
ICMPIGMP
版本4中的网络层
信息报文
IPv4
ICMPv6报文
新旧版本中的网络层的比较
ICMPv6报文的分类
ARP
邻站发现报文
ND协议
ICMPv6
版本6中的网络层
组成员关系报文
IPv6
MLD协议
5.5ICMPv6
5.5ICMPv6
154
153
7
---
## Page 78
口路由与桥接对比的主要区别在于：
路由（Routing）是把信息从源节点通过网络传送到目的节点的行为。
6.路由选择协议
口路由功能是一种数据报分组交换路径选择行为，
口网络层的主要功能是将分组从源节点路由到目的节点，
6.路由选择协议
■桥接发生在数据链路层，连接的是同一网络或同一子网的不同网段。
■简单的讲：路由就是指网络层设备从一个接口上收到数据包，根据数据包的
■路由选择就是综合考虑多种因素，例如线路长度、信道带宽、线路稳定性等。
■路由功能和日常旅行时选择最佳路线的道理是相通的。
能。
（Hop）才能到达目的地。
算机网络中，
■路由发生在网络层，连接的是不同网络或不同子网。
目的地址进行定向，并转发到另一个接口的过程。
，采用的是数据报分组交换方式，数据报分组需要经过多跳
，是网络层的一种基本功
6.1有关路由选择的基本概念
，而且在大多数计
6.1有关路由选择的基本概念
156
155
78
---
## Page 79
口静态路由：
6.路由选择协议
口从路由算法的自适应性考虑：
口路由功能的实现是依靠路由器或路由交换机中的路由表进行的。
6.路由选择协议
■静态路由的特点是：
■静态路由的配置和管理都比较简单。
■静态路由是手动配置的路由，主要应用在小型局域网中。
■动态路由选择策略一
■静态路由选择策略-
的变化，但实现起来较为复杂，
口静态路由（Static Routing）
不能及时适应网络状态的变化。
口单向性：静态路由仅为数据提供沿着下一跳的方向进行路由，不提供反向路由。
口不可通告性：静态路由信息是私有的，不会通告给其他路由器。
口路由路径固定不变：静态路由不会随着网络的拓扑结构或链路的状态变化而变化，
口手动配置：静态路由需要管理员手动进行逐条配置。
口动态路由（Dynamic Routing)
是静态固定的。
一即自适应路由选择，其特点是能较好地适应网络状态