  Madness	
  Pro,	
  phishing,	
Pony	
  panel	
•  Serve	
  all	
  types	
  of	
  Zeus	
  urls:	
  conﬁg,	
  binary	
  and	
  drop	
  zones	
•  .ru,	
  .su,	
  .com	
  most	
  abused	
  TLDs	
•  Bots	
  concentrated	
  in	
  Russia,	
  Ukraine	
•  Targeted	
  vicNms	
  concentrated	
  in	
  the	
  US	
DNS	
  style	
Catching	
  Malware	
  IP	
  style	
Catching	
  Malware	
  IP	
  style	
Sub-­‐allocated	
  ranges	
ASN	
  graph	
  topology	
Use	
  case	
  #1	
Malicious	
  sub-­‐allocated	
  ranges	
IP	
  style	
InvesNgaNon	
  Process	
Monitor	
  domains	
  &	
IPs	
  from	
  traﬃc	
  and	
blacklist	
Study	
  sub-­‐allocated	
IP	
  ranges	
  &	
ﬁngerprints	
Study	
  bad	
  actors’	
TTP	
  in	
  their	
  choice	
of	
  infrastructure	
  &	
Lming	
PredicLvely	
  block	
IPs	
  desLned	
  for	
avacks	
Generalize	
predicLons	
Study	
  shiG	
  in	
  bad	
actors’	
  TTP	
IP	
  style	
OVH	
Canada	
Ukraine	
Russia	
•  Same	
  customer	
  reserving	
  IPs	
•  IPs	
  exclusively	
  used	
  for	
  avacks	
•  Bring	
  IPs	
  online	
  in	
  bulk	
•  Customer	
  Unknown	
•  Bring	
  conLguous	
  IPs	
  online	
1	
  at	
  a	
  Lme	
  or	
  random	
•  Customer	
  Unknown	
•  Bring	
  conLguous	
  IPs	
  online	
1	
  at	
  a	
  Lme	
  or	
  random	
7	
  days	
7	
  days	
Name	
  servers	
  always	
  stayed	
on	
  OVH	
  IP	
  ranges	
Months	
•  Same	
  customer	
  reserving	
  IPs	
•  Using	
  recycled	
  IPs	
  for	
  avacks	
IP	
  style	
Malicious	
  sub-­‐allocated	
  ranges	
IP	
  style	
Malicious	
  sub-­‐allocated	
  ranges	
• 
hvp://labs.umbrella.com/2014/02/14/when-­‐ips-­‐go-­‐nuclear/	
• 
Take	
  down	
  operaLons	
  of	
  domains	
IP	
  style	
PredicNng	
  malicious	
  domains	
  IP	
  infrastructure	
IP	
  style	
Tracking	
  OVH	
  reserved	
  ranges	
IP	
  style	
Time	
  period	
Nb.	
  ranges	
   Nb.	
  IPs	
   Nb.	
  IPs	
  used	
   Usage	
Dec	
  1st	
  -­‐31st	
  2013	
28	
  ranges	
136	
  IPs	
   86	
  used	
63%	
  malicious	
Jan	
  1st	
  -­‐	
  31st	
  2014	
11	
  ranges	
80	
  IPs	
33	
  used	
41%	
  malicious	
Feb	
  1st	
  -­‐	
  28th	
  2014	
   4	
  ranges	
28	
  IPs	
26	
  used	
92%	
  malicious	
Mar	
  1st	
  -­‐	
  20th	
  2014	
   43	
  ranges	
364	
  IPs	
   215	
  used	
59%	
  malicious	
• 
Used	
  for	
  Nuclear	
  EK	
  domains,	
  Nuclear	
  domains’	
  name	
  servers,	
  and	
  browlock	
Tracking	
  OVH	
  reserved	
  ranges	
• 
86	
  ranges	
  are	
  all	
  in	
  these	
  preﬁxes	
  388	
  198.50.128.0/17	
  128	
  192.95.0.0/18	
  80	
  198.27.64.0/18	
  12	
  142.4.192.0/19	
IP	
  style	
IP	
  style	
31.41.221.131	
  -­‐	
  31.41.221.143	
22/tcp	
  open	
  ssh	
  OpenSSH	
  5.5p1	
  Debian	
  6+squeeze4	
  (protocol	
  2.0)	
80/tcp	
  open	
  hpp	
  nginx	
  web	
  server	
  0.7.67	
111/tcp	
  open	
  rpcbind	
5.101.173.1	
  -­‐	
  5.101.173.10	
22/tcp	
  open	
  ssh	
  OpenSSH	
  6.0p1	
  Debian	
  4	
  (protocol	
  2.0)	
80/tcp	
  open	
  hpp	
  nginx	
  web	
  server	
  1.2.1	
111/tcp	
  open	
  rpcbind	
FingerprinLng	
  malicious	
  ranges	
FingerprinNng	
  malicious	
  ranges	
IP	
  style	
198.50.143.64	
  -­‐	
  198.50.143.79	
22/tcp	
  open	
  ssh	
  OpenSSH	
  5.5p1	
  Debian	
  6+squeeze4	
  (protocol	
  2.0)	
80/tcp	
  open	
  hpp	
  nginx	
  web	
  server	
  0.7.67	
445/tcp	
  ﬁltered	
  microsos-­‐ds	
•  Combine	
  indicators	
  and	
  generalize	
  to	
  other	
  threats	
-­‐>	
  Block/quaranNne	
  IPs	
  before	
  they	
  start	
  hosNng	
  domains	
DetecNng	
  Malicious	
  Subdomains	
  under	
Compromised	
  domains	
IP	
  style	
InvesNgaNon	
  Process	
Detect	
  subdomains	
injected	
  under	
compromised	
domains	
Collect	
  subdomains,	
domains	
  and	
hosLng	
  IPs	
Track	
  most	
  abused	
ASNs	
Track	
  most	
  abused	
hosters	
Study	
  evoluLon	
  of	
bad	
  actors’	
  TTP	
over	
  Lme	
Analyze	
  subdomain	
labels	
IP	
  style	
Malicious	
  subdomains	
  under	
  compromised	
  domains	
• 
Detect	
  malicious	
  subdomains	
  injected	
  under	
  compromised	
domains,	
  most	
  notably	
  GoDaddy	
  domains	
• 
Subdomains	
  serving	
  Exploit	
  kits	
  (e.g.	
  Nuclear,	
  Angler,	
  FlashPack),	
browlock,	
  malverLsing	
• 
Various	
  payloads	
  dropped	
  (e.g.	
  zbot	
  variants,	
  kuluoz)	
• 
Monitoring	
  paverns	
  for	
  5+	
  months	
  (Feb	
  2014-­‐present)	
IP	
  style	
Malicious	
  subdomains	
  under	
  compromised	
  domains	
• 
Sample	
  of	
  several	
  hundred	
  IPs	
  hosLng	
  malicious	
  subdomains	
• 
Top	
  5	
  abused	
  ASNs	
§  16276	
  OVH	
  SAS	
  (18%	
  of	
  total	
  collected	
  malicious	
  IPs)	
§  24961	
  myLoc	
  managed	
  IT	
  AG	
§  15003	
  Nobis	
  Technology	
  Group,	
  LLC	
§  41853	
  LLC	
  NTCOM	
§  20473	
  Choopa,	
  LLC	
IP	
  style	
Before	
Now	
Abuse	
  ccTLDs	
  (e.g.	
  .pw,	
  .in.net,	
  .ru,	
etc)	
  using	
  rogue/vicLm	
  resellers/
registrars	
Supplement	
  with	
  abusing	
compromised	
  domains	
Use	
  reserved	
  IPs	
  exclusively	
  for	
Exploit	
  kit,	
  browlock	
  avacks	
Supplement	
  with	
  using	
  recycled	
IPs	
  that	
  hosted	
  legit	
  content	
  in	
  the	
past	
Bring	
  avack	
  IPs	
  online	
  in	
conNguous	
  chunks	
Supplement	
  with	
  bringing	
  IPs	
  up	
  in	
randomized	
  sets	
  or	
  one	
  at	
  a	
  Nme	
Abuse	
  OVH	
  Canada:	
  possible	
  to	
predicLvely	
  correlate	
  rogue	
customers	
  with	
  avack	
  IPs	
  through	
ARIN	
  rwhois	
Abuse	
  OVH	
  Europe	
  spanning	
numerous	
  countries’	
  IP	
  pools	
  (e.g.	
FRA,	
  BEL,	
  ITA,	
  UK,	
  IRE,	
  ESP,	
  POR,	
GER,	
  NED,	
  FIN,	
  CZE,	
  RUS)	
IP	
  style	
Small	
  abused	
  or	
  rogue	
  hosNng	
  providers	
• 
hvp://king-­‐servers.com/en/	
  hosted	
  Angler,	
  Styx,	
  porn,	
  pharma	
• 
Described	
  on	
  WOT	
  “oﬀers	
  bulletproof	
  hosLng	
  for	
  Russian-­‐Ukrainian	
criminals”	
IP	
  style	
Small	
  abused	
  or	
  rogue	
  hosNng	
  providers	
• 
hvp://evrohoster.ru/en/	
  hosted	
  browlock	
  through	
  redirecLons	
  from	
porn	
  sites	
IP	
  style	
Small	
  abused	
  or	
  rogue	
  hosNng	
  providers	
• 
hvp://www.qhoster.bg/	
  hosted	
  Nuclear	
IP	
  style	
Small	
  abused	
  or	
  rogue	
  hosNng	
  providers	
• 
hvp://www.electrickiven.com/web-­‐hosLng/	
IP	
  style	
Small	
  abused	
  or	
  rogue	
  hosNng	
  providers	
• 
hvp://www.xlhost.com/	
  hosted	
  Angler	
  EK	
  domains	
• 
hvps://www.ubiquityhosLng.com/	
  hosted	
  browlock.	
• 
hvp://www.codero.com/	
• 
hvp://hosLnk.ru/	
IP	
  style	
String	
  Analysis	
  of	
  injected	
  subdomains	
• 
Sample	
  of	
  19,000+	
  malicious	
  subdomains	
  injected	
  under	
  4,200+	
  compromised	
GoDaddy	
  domains	
• 
12,000+	
  diﬀerent	
  labels	
• 
Top	
  5	
  used	
  labels:	
§  police	
§  alertpolice	
§  css	
§  windowsmoviemaker	
§  solidﬁleslzsr	
IP	
  style	
String	
  Analysis	
  of	
  injected	
  subdomains	
IP	
  style	
Catching	
  Malware	
  IP	
  style	
ASN	
  graph	
  topology	
Sub-­‐allocated	
  ranges	
INTERNET	
  101	
  &	
  BGP	
IP	
  style	
INTERNET	
  101	
  &	
  BGP	
IP	
  style	
MEET	
  THE	
  INTERNET	
Network	
  of	
  Networks,	
  it’s	
  a	
  Graph!	
Each	
  organizaLons	
  on	
  the	
  Internet	
is	
  called	
  an	
  Autonomous	
  system.	
Each	
  dot	
  represents	
  an	
Autonomous	
  system	
  (AS).	
AS	
  is	
  idenLﬁed	
  by	
  a	
  number.	
OpenDNS	
  is	
  36692,	
  Google	
  is	
15169.	
Each	
  AS	
  has	
  one	
  or	
  more	
  Preﬁxes.	
36692	
  has	
  56	
  (ipv4	
  and	
  IPv6)	
network	
  preﬁxes.	
BGP	
  is	
  the	
  glue	
  that	
  makes	
  this	
work!	
IP	
  style	
AS	
  graph	
• 
BGP	
  rouLng	
  tables	
• 
Valuable	
  data	
  sources	
• 
Routeviews	
• 
Cidr-­‐report	
• 
Hurricane	
  Electric	
  database	
• 
510,000+	
  BGP	
  preﬁxes	
• 
48,000+	
  ASNs	
IP	
  style	
AS	
  graph	
•  Route	
  Views	
  hvp://archive.routeviews.org/bgpdata/	
IP	
  style	
AS	
  graph	
•  Cidr	
  Report	
  hvp://www.cidr-­‐report.org/as2.0/	
IP	
  style	
AS	
  graph	
•  Hurricane	
  Electric	
  database	
  hvp://bgp.he.net/	
IP	
  style	
AS	
  graph	
• 
Build	
  AS	
  graph	
• 
Directed	
  graph:	
  node=ASN,	
  a	
  directed	
  edge	
  from	
  an	
  ASN	
to	
  an	
  upstream	
  ASN	
• 
TABLE_DUMP2|1392422403|B|96.4.0.55|11686|67.215.94.0/24|
11686	
  4436	
  2914	
  36692|IGP|96.4.0.55|0|0||NAG||	
IP	
  style	
AS	
  graph	