### 问题概述
您提到有黑客通过在用户的公共目录中找到旧脚本并上传Base64编码的文件，利用这些文件通过cPanel服务器（使用Exim MTA和Dovecot）发送大量垃圾邮件。您希望在不阻止正常PHP脚本发送合法邮件的情况下，如何在服务器或Exim配置层面阻止这种行为。

### 解决方案

#### 1. 更新和修补软件
这种情况很可能是由于用户使用了过时的软件或应用程序。为了防止此类攻击，建议定期更新和修补这些软件或应用程序。如果黑客使用的是未知的0-day漏洞，则需要更高级的安全措施。

- **步骤**:
  - 审查所有安装的应用程序和脚本，确保它们都是最新版本。
  - 检查是否有可用的安全补丁，并及时应用。

#### 2. 确定入侵点
通过分析Web服务器的日志文件，确定恶意脚本的上传入口点。一旦找到，通知相关用户修补其软件或应用程序。

- **步骤**:
  - 查看Web服务器日志文件（如Apache或Nginx日志），寻找异常的请求和响应。
  - 识别出可疑的IP地址、URL和时间戳。
  - 通知受影响的用户，并提供修补建议。

#### 3. 配置Exim和服务器安全
虽然直接在SMTP级别进行拦截并不是最佳解决方案，但可以通过以下方式增强服务器安全性：

- **Exim配置**:
  - 启用Exim的限制策略，例如设置每小时的最大邮件发送数量。
  - 使用`ratelimit`指令来限制每个IP地址或用户的邮件发送速率。
  - 启用SPF (Sender Policy Framework) 和DKIM (DomainKeys Identified Mail) 来验证发件人身份。

- **服务器安全**:
  - 禁用不必要的服务和端口。
  - 启用防火墙规则，限制对敏感目录的访问。
  - 使用入侵检测系统（IDS）和入侵防御系统（IPS）来监控和阻止可疑活动。

#### 4. 深入调查
进行全面的安全审查，以确定服务器被攻破的程度。如果发现严重的问题，可能需要从头开始重建服务器。

- **步骤**:
  - 分析系统日志，查找任何异常行为。
  - 检查文件完整性，确认没有其他恶意文件存在。
  - 如果怀疑服务器已被完全攻破，考虑重装操作系统并重新部署应用程序。

### 示例代码分析
提供的示例代码链接指向一个Base64编码的PHP脚本。该脚本很可能用于发送垃圾邮件。您可以解码该脚本并进一步分析其功能，以更好地了解攻击者的意图。

- **解码和分析**:
  - 使用Base64解码工具将脚本解码为可读形式。
  - 仔细检查解码后的脚本，找出其具体功能和潜在危害。
  - 根据分析结果，采取相应的防护措施。

### 总结
通过更新和修补软件、确定入侵点、加强Exim和服务器安全配置以及深入调查，可以有效阻止黑客通过上传恶意脚本发送垃圾邮件的行为。同时，保持系统的持续更新和监控是防止未来攻击的关键。