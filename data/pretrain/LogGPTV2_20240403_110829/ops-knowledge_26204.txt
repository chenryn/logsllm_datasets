User: 请解答这个和日志有关的问题PHP hack base64 code uploaded and sending mass emails cPanel server with Exim MTA and Dovecot. Some hacker is finding old scripts at different users public directory, and uploading base64 encoded files then using it to send massive spam.
How do I block it at the server or Exim config itself, without disabling normal PHP scripts sending legitimate email?

Example of that code http://pastebin.ca/3039339

Assistant: This most likely means you or your users are using outdated software / applications. The only way to prevent this, is to regularly update and patch this software / applications unless the hacker is using a 0-day exploit that's currently unknown.

Try determining the entry point where this script is uploaded from the web server log files. Once found, inform your user(s) to patch their software / application(s).

If you think you should block this at the "SMTP level", I think you are wrong. When hackers are able to upload and execute malicious PHP files, your server may be (partially) compromised. Try determining the root cause instead of fixing it somewhere else.

I suggest to investigate how much of the server is compromised by means of log files. Worst case, I'd suggest to start from scratch.