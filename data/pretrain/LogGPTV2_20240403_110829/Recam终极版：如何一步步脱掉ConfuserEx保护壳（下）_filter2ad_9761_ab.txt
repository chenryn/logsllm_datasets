0x89（case 8）：关闭网络套接字，释放互斥量，调用WSACleanup，结束进程。
## 总结
恶意软件是个不断变化的目标，会在恶意软件作者及安全研究人员的军备竞赛中不断发展。本文介绍了攻击者为了规避检测而采用的一些复杂技术。
混淆本身就是一门技术。这个技术的覆盖范围非常广泛，包括经常变化的加壳工具以及恶意软件中使用的多种技术。当反混淆工具或报告公之于众后，恶意软件作者通常会去修改他们使用的加壳工具。在很多情况下，他们只需要少量修改混淆工具，就能对抗反混淆工具。因此，恶意软件研究者不能依赖这些工具，在必要时候必须手动来解开混淆代码的真面目。
我们需要了解攻击者用来规避检测及分析的具体方法，这对保护系统免受恶意软件威胁而言至关重要。从本文分析的这个案例中，我们了解到有些工具（如[AMP](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)以及[Threatgrid](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)）能够在高级恶意软件分析中发挥重要作用。
## IOC
**恶意Word文档**
    C3b1a98c6bc9709f964ded39b288aff66abc5c39b9662fdd28ddfcc178152d67
**释放器程序**
    99371d8da86e964cc52bd719fd85f1f0015e4c60a9705747bb9b8ac52fd29b4a
**攻击载荷（Recam）**
    1fd8520246c75702c000f4fac3f209d611c21bfdb81df054c9558d5e002a85ce
**命令控制服务器**
    185.140.53.212
**命令控制服务器域名**
    U811696.nvpn.so
**域名所有者**
    PI:EMAIL
**目录及文件**
    %AppData%mozilla firefoxfirefox.exe
    %AppData%mozilla firefox.Identifier
    %Temp%Update.txt
**注册表项**
    表项：HKEY_CURRENT_USERSoftwareMicrosoftWindowsCurrentVersionRunUpdate
    键值：cmd /c type C:UsersdexAppDataLocalTempUpdate.txt | cmd
**相关文件**
_释放器相关文件_
    006583023242bf4a8dcd0190aef32500dcacfacf1dda7b24409133dfccbfd186
    0086bb92bd34b41e180bec90dd15d4b0d0eb9c7384a68b66354d603ad8e14706
    01226da791e32f8cc907f88b2b672068b78b86b1a0d154bd22274234a7d9b5e6
    031046538b60f9b243aa74bdec2a13ab2aee4b941a136daca12de78c3419dd6e
    038aa33ab7363ea484efe9c79c718de500acf766266166b6a70e69b0a67c3984
    03fe0caa0f3e21f1975bdceaa5e38e00d725879322c8815e7b3b60b1c0cfec20
    13010c16d07c00d22ffebd78c7e00ee40678088f3f46292d3fc7e7b299296361
    14d341bd2c2b7ea90b3b15fcb8154caa036b629156199d955047fb081de6669d
    237ed26f6d9b19ddd2fc368ba871c1df651bf20e21f0f2cf2f1a0d9a885fdfab
    2442515adb2cbc03f54b4edce7762e3b4ce0763ad073666cfec5743ff1bc62e2
    264ba90eb6e5e38905bb8333830ea0ef86126d06d68a8609efbe18068d0861e8
    26a6f02efcda37e1c0d1a66ce57ccfe0fb95bf1ddf9b20106e0d90407cb89d0c
    289ab18d2c67c1c2f92829e11761ba3ec3a9088f36993031a002a0dbe7ab08d5
    2a1a0356d96f97a4710511a5e023d43124e7e97261154b5e82d6047fd6dc85e1
    2b3fe2be93456173aa1d998764284c687ce68db9c5bfc5175ccf475b090809c1
    2fbd846efe0cbf9aa0e51da044403f7d96f159ab655bf44ed697062888fd4fbd
    30c0f9250fbe8b8eccbf9b195a4803d33b320d20da4252763cd91b5a8c261872
    31442c2ed9a803eba0e162616c16907985487f3bfddcfbc4e30e699fc58847e6
    3e7aaa364e5d15d974fab62f828a7ab1f14f5c79ceca7e3dd8560f9a863517ad
    3fa46682f660e7f0136544ec995657150bd42dd33ef4362bb0c002d25c9327c2
    490183ce7288fe6b35f2ad05514cbdc8d212121c661edf570530980634983276
    550db43b5965301a33d2bf71760c4e17c7ae249bcbb1f6b0c9173d76774623c4
    61788dbc231ec56f115607e6d7b3cfe2962ecdc112bfbd0a8f2ef1e3f145b25b
    6ac23f995572bd1b9caf860384abf62921cf6d572e679872314f67038bc076ab
    6b965cc215758d529edaff3a2913226823848c47146121855a482059a6e8ee38
    6e74c3a1f5bc17f38da7305068f9203943090067b2dfa67fb9361fa1821a674b
    7960bc0d2d9422df90216d1b81fb4420c04607c374289ffe10eb9a80e18990cf
    7c127f9f22a346d4369405f540c4e467abac02bcf4589dbd6d3e97f18fbe0f98
    7dedf655e19430f538faab5638ec76383d651abf5c24ed799e101abb7c9f40b8
    99371d8da86e964cc52bd719fd85f1f0015e4c60a9705747bb9b8ac52fd29b4a
    9d0671ee5279abd7973a426c60f44723503fd09d4d771092e2453ac4a3e9334c
    9dfee20b6e5c57387968da91ec6efd4e0ac8abce219c437a2cd4b5df36f2a79e
    a9b4e5cf351bbb3f20fcdcd7cf0b2c03df788c4d0c0d59a31cbab09cccc335d1
    c064c70d887ea1ccf37e3edd19dc717b53f2c0513424416fc783654ab9f61134
    c13d2ce1b561ed02c02c9a2899a7d7e9c97400ef8f81eb48d6ba02a90d76c689
    c2fef90a5ad97a030712b9245fccffb26f226370bd6f67c989bbf95e02ca03b8
    c8d98b7f1cf8811c3e75b0ec8c1011d0ed4c3951420f04e3b743da564869e02b
    cdd98208665360ca7745a1e5577e1e9607c49ac8790ffde2edd93e2c64ead8a1
    d7d94b3aea52f0a9bda593806d56f962c09f4d389820cd9016ceed73767feb55
    df46d34c0ff71d994f157cfe158ae7dba9dbf16ffb021a10e401bc9afb2f4e8d
    e20c3b8e3460f719219cb4ddac61231db047c125818a391d34d87dab1726f070
    e3704aa7bfb90e8e7f96aa529cbd96319696157cda076d92bab9eae07cfe977e
    e8a4a890d34b328857389d48d837fcf4b9ab4774a29bcc582b4cdf05ac3a49db
    f7ac275c2971820fb311f41049c5e460251486625696caa0fc60d0ffc683fb70
    fc0bd596957f70e87954ef42acc0bfe0123c11be6879c7c910a4a7e434e36c46
_RTF文档相关文件_
    27bf1851e64f5e6d6e33b2b3bc89b82dda2da2fd9a747c847c148909dda028d3
    7a63150ebd09fd4f8c8f1b7485a0139108f22aea043c9759239d9976948b5c75
    a27ebd73ac836d659512befe4fee57f9343eca992448242b1ab40730506a747c
    ac2e9c83c7e23514c196b14e49f93345bfed2ed8fc10343c21d358ec3e809928
    6f3a8557e2c95a717cb48080042293045011e74f2a4c79aaeffbfcc86456eb37
    5a234b3e389a22b70da242b1c93d65f358d60f1347b03101f7613fa1db032645
    660a6197a032cd2baf35df713575f16b71ebdcda67b89deb1afc45f2b986490a
    7c7d00e12273fe924a9dc945add40c91692b8e468682240cf241a418d3ce198f
    1d604531fd15a7476296612cbfcfa4761148a61d54f44351d97b5feb1bb293e4
    46907300ed93309f083181489bf68ef8f357b1a583bda501b3ab5249f55778ad
    6fed760b5eefd70dddef34daaf678f3d999a91c0f638c8afbe844dd8097c4bc8
    f231bca66d0d8b241dfbd49630602405297c18cbe108b609f420ff6e9c987e7e
    d3de3093b173746fd5cf892e32caafabb898616766953ccad2b6a303930731d4
    662f7b3816dd59c5f1988c9d7b5b62b61b94028fa513ddfe0c00e21a79367883
    b9d38a08e7b888940ad0bafb6032dfe45d4b6cab2f09a734f46d05d718eda57e
    1fd682146e278a76b216215ba9bc8040f9fc4e817f0676ccbfd46ccc13ca95d4
    135db94b1b75fbeccf2e28abf568e3384e14dc452e5f638cdb1cb533794d2bca
    51e1da451e38159e73bf185f627fedf63aca03734e95f88dfbf85536eb6bef9a
    18ba9d4175c48148d4dfa7d022a687e4c63da18337fd86a3f48efd5afa5cfcde
    4f6dd728633bba78841da6fce1ce9a3e8673830588bd51e2bfd283e2afcb0ecb
    6943484dad1a3246a82b1a9444811e0f4c561770291dd936a1f1a5314e13fda9
    53c325566fc88c8355478e001445da54debb009c60581e2e6c3345f10c4f65f0
    a546965c6a46e9f19c374b1195ba0924c0a6d462a9d37210527d1f2801719932
    2752ed543f880807557ba9556838e4ef6a1582ea50351fc2723e4d63f4f57ad9