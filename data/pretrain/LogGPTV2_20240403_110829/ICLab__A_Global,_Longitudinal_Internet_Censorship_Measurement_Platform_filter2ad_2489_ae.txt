Our detector for block pages (§IV-C) flagged a cluster of
TCP payloads observed only in South Korea. Upon manual
inspection, these pages contained a script that would fingerprint
the client and then load the originally intended page. We
observed injections of this script over a five-month period from
Oct. 2016 through Feb. 2017, from vantage points within three
major Korean ISPs, into 5–30% of all our test page loads,
with no correlation with the content of the affected page. By
contrast, censorship in South Korea affects less than 1% of our
tests and is focused on pornography, illegal file sharing, and
North Korean propaganda.
These scripts could be injected by the VPN service, the ISPs,
or one or more of their transit providers. The phenomenon
resembles techniques used by ad networks for recording profiles
of individual web users [2]. This demonstrates the importance
of manual checking for false positives in censorship detection.
All of the detection heuristics described in Sections IV-B
and IV-C triggered on these scripts, but they are not censorship.
C. Cryptocurrency Mining Injection
Our block page detector also flagged a set of suspicious
responses observed only in Brazil. The originally intended
page would load, but it would contain malware causing the
web browser to mine cryptocurrency. (As of mid-2018, this is a
popular way to earn money with malware [53].) We were able
to identify the malware as originating with a botnet infecting
MikroTik routers (exploiting CVE-2018-14847), initially seen
only in Brazil [49] but now reported to affect more than
200,000 routers worldwide [31]. Infected routers inject the
mining malware into HTTP responses passing through them.
The malware appears in ICLab’s records as early as July 21st,
2018—ten days before the earliest public report on the MikroTik
botnet that we know of. If ICLab’s continuous monitoring
were coupled with continuous analysis and alerting (which is
planned) it could also have detected this botnet prior to the
public report. This highlights the importance of continuously
monitoring network interference in general.
VII. Comparison with other Platforms
Other censorship measurement platforms active, at
the
time of writing, include Encore [17], Satellite-Iris [66], [72],
Quack [79], and OONI [37]. Table V shows the high-level
features provided by each of these platforms, and a comparison
of their country, AS, and URL coverage for the two-month
period of August and September 2018. (August 1, 2018 is
the earliest date for which data from Quack and Satellite-Iris
has been published.) All platforms suffer some variation from
day to day in coverage, so we report both a weekly average
and the maximum number of covered countries, ASes, and
URLs. While many of the platforms described in Table V have
chosen to emphasize breadth of country and AS coverage at the
expense of detail. ICLab takes the opposite approach, collecting
detailed information from a smaller number of vantage points.
A. Quack
Quack relies on public echo servers to measure censorship.
It requires at least 15 echo servers within the same country
for robust measurements [79]. Currently, these are available to
Quack from 75 countries. 95 more countries have at least one
echo server, which can still provide some measurements.
Quack aims to detect censorship of websites, but it does not
send or receive well-formed HTTP messages. Instead it sends
packets that mimic HTTP requests, which the echo server will
reflect back to the client. It expects the censor to react to this
reflection in the same way that it would to a real HTTP message.
The designers of Quack acknowledge the possibility of false
negatives when the censor only looks for HTTP traffic on the
usual ports (80 and 443). More seriously, manual inspection
of the Quack data set reveals that in 32.6% of the tests marked
as blocked, the client did not successfully transmit a mimic
request in the first place. We have reported this apparent bug
to the Quack team.
B. Satellite-Iris
Satellite-Iris [19] combines Satellite [72] and Iris [66]. It
focuses on DNS manipulation, measuring from open DNS
resolvers. It compares the responses received from these vantage
points with responses observed from a control node. It also
retrieves corresponding TLS certificates from the Censys [30]
data set and checks whether they are valid. It applies several
heuristics to each response, all of which must be satisfied for
the response to be judged as censorship. We now highlight two
cases where their heuristics lead to false negatives.
If Satellite-Iris can retrieve a TLS certificate from any of the
IP addresses in the open resolver’s response, and that certificate
is valid for any domain name, it considers the response not
to be censored. This means Satellite-Iris will not detect any
case where the censor supplies the address of a server for a
High-level comparison of ICLab with five other censorship monitoring platforms.
Table V
Platform
Packet
Capture
Vantage Point Types
VODs
VPNs ORsa
DNS
Detection Capabilities
TCP
Blockpage
Encore [17]
Satellite-Iris [66], [72]
Quack [79]
OONI [37]
ICLab
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
✓
◯c
✓
✓
Countries
Unknownb
174 / 179
75 / 76
113 / 156
42 / 50
Coverage (avg/max)
ASes
Unknown
3,261 / 3,617
3,528 / 4,135
670 / 2,015
48 / 62
URLs
23
2,094 / 2,423
2,157 / 2,484
13,582 / 20,258
16.964 / 23,992
aOpen Relays: Internet hosts that will relay a censorship probe from researchers’ computers without any prior arrangement.
bDue to privacy concerns, Encore does not record this information.
cThe OONI client can optionally collect packet traces. However, OONI’s servers do not record traces, due to privacy concerns.
subsample on each run, in order to limit the time and bandwidth
consumed by the test. 62% of the measurements for the August
and September 2018 period tested fewer than 80 URLs. Figure 8
shows the distribution of countries covered by OONI. 86% of
all observations originate from the 23 countries named in this
figure, and 48% are from just two countries—Russia and the
USA. For another 4% of the observations, no location could be
identified. Comparing Figure 8 to Figure 2 shows that OONI
does not achieve better coverage of “partly free” and “not free”
countries than ICLab does. Volunteers whose Internet access
is unreliable or misconfigured may submit inaccurate results.
Indeed, more than 100,000 of the observations are tagged
inconclusive due to local network errors (e.g., disconnection
during the test).
Because OONI’s testing application runs without any special
privileges, it normally cannot record packet traces. OONI’s
detection heuristics are rudimentary, leading to a high level
of false positives. OONI’s DNS consistency test will flag any
disagreement between the client’s local recursive resolver and
a public DNS utility as censorship [62]. OONI’s block page
detector relies on the “30% shorter than uncensored page”
heuristic proposed by Jones et al. [48], but innocuous server
errors are also short compared to normal page.
Yadav et al. [89] reported very high levels of inaccuracy in
OONI’s results for India, with an 80% false positive rate and
a 11.6% false negative rate. We confirm a high false positive
rate for OONI’s block page detector: of the 12,506 unique
anomalous HTTP responses reported by OONI’s volunteers
in August and September 2018, our block-page detector only
classifies 3,201 of them as censorship, for a 74.4% false positive
rate. The most common cause of false positives is a response
with an empty HTML body, which can occur for a wide variety
of innocuous reasons as well as censorship [4], [57], [77].
VIII. Related Work
China’s censorship practices have been studied in detail [23],
[35], [64], [86], [88] due to the worldwide reputation of the
“Great Firewall” and the relative ease of gaining access to van-
tage points within the country. Other countries receiving case
studies include Iran [6], [10], India [89], Pakistan [51], [60],
Syria [20], and Egypt and Libya [25]. Whenever researchers
have had access to more than one vantage point within a country,
Fig. 8. Distribution of OONI observations by country in August and September
of 2018, grouped by Freedom House classification.
different domain in forged DNS responses. In Satellite-Iris’s
published data set, 0.01% of the measurements are affected
by this. Specifically, measurements from China and Turkey
show domains belonging to the BBC, Google, Tor and others
resolving to an IP address belonging to Facebook’s server pool.
Despite the design bias toward false negatives, we also find
that 83.8% of the DNS responses considered censored by
Satellite-Iris may be false positives. Satellite-Iris depends on
the Censys data set to distinguish DNS poisoning from normal
IP variation (e.g., due to geotargeting and load balancing by
CDNs). When Censys information is unavailable, it falls back
on a comparison to a single control resolver, which is inadequate
to rule out normal variation, as discussed in §IV-A.
C. OONI
OONI [37] relies on volunteers who run a testing application
manually. The application is available on all major desktop
and mobile operating systems except Windows. In August and
September of 2018, OONI’s volunteers conducted 14,000,000
measurements from 156 countries, and reported 29,982 unique
URL-country pairs as blocked.
OONI’s reliance on volunteers, and on manual operation of
the testing application, means that its coverage is not evenly
distributed over websites or countries. Their “primary web
connectivity” test suite also tests ATL and CLBL-G, but the
mobile phone version of the application only tests a short
Cumulative % of all observations0%20%40%60%80%100%2,700,0001,000,000750,000340,000320,000270,000250,000180,000150,000130,000120,000700,000United StatesIrelandGermanyFranceCanadaItalyUnited KingdomNetherlandsAustriaAustraliaSwitzerland40 other countries270,000260,000180,000180,000150,000140,000110,000520,000MalaysiaIndiaSouth KoreaBrazilGreeceUgandaMexico62 other countries4,200,000180,000170,000110,000210,000RussiaVenezuelaPakistanIran22 other countries510,000Unknown locationFreePartly FreeNot Freethey have found that the policy is not consistently enforced.
There is always region-to-region and ISP-to-ISP variation.
Broader studies divide into two lines of research. One
group of studies investigate worldwide variation in censorship:
for instance, whether censorship mainly interferes with DNS
lookups [66] or subsequent TCP connections, and whether the
end-user is informed of censorship [44], [80]. In some cases, it
has been possible to identify the specific software in use [26],
[48]. Another line of work aims to understand what is censored
and why [1], [16], [84], how that changes over time [7], [43],
how people react to censorship [52], [87], and how the censor
might react to being monitored [16].
We described the difficulties with relying on volunteers in §I
and §III. Several groups of researchers have sought alternatives.
CensMon [73] used Planet Lab nodes, Anderson et al. [7] used
RIPE Atlas nodes, Pearce et al. [66] use open DNS resolvers
and VanderSloot et al. [79] use open echo servers. Darer et al.
[28] took advantage of the fact that the Chinese Great Firewall
will inject forged replies to hosts located outside the country.
Burnett and Feamster [17], Ensafi et al. [33], and Pearce et al.
[65] all propose variations on the theme of using existing hosts
as reflectors for censorship probes, without the knowledge of
their operators, at different levels of the protocol stack.
Only a few studies have lasted more than a month. Five
prominent exceptions are Encore [17], IRIS [66], OONI
[37], Quack[79], and Satellite [72], all of which share goals
similar to ICLab. Section VII provides a detailed comparison
between ICLab and these projects. Herdict [45] has also
been active for years, but simply aggregates user reports of
inaccessible websites. It does not test or report why the sites
are inaccessible.
IX. Limitations
In this section, we discuss ICLab’s limitations and how we
have addressed them.
Discrimination against VPN users. Some websites may block
access from VPN users [57], [72]. We sometimes observe
this discrimination against our VPN clients (see §VI-A for an
example), and are careful not to confuse it for censorship.
Malicious VPN Providers. Some VPN providers engage in
surveillance and traffic manipulation, for instance to monetize
their service by injecting advertisements into users’ traffic [50].
We avoid using VPN providers that are known to do this. Our
block page detectors are designed not to confuse dynamic
content (e.g., advertisements, localization) with censorship,
as described in §IV-C. In §VI-B and VI-C we describe
surveillance and malware injections that required manual
inspection to distinguish from censorship.
VPN providers are also known to falsely advertise the
location of their VPN servers [85]. We verify all server
locations using the technique described in Appendix B.
Bias in Test Lists. ATL suffers from sampling bias and
churn [71]. CLBL-G and CLBL-C may suffer from selection
bias, since they are manually curated by activists. We have
plans to revise the test lists and add more URLs as needed.
CLBL-G and CLBL-C are updated slowly. It is not unusual
for more than half of the sites on a country-specific list to
no longer exist [84]. This is not as much of a limitation as
it might seem, because censors also update their lists slowly.
Several previous studies found that long-gone websites may
still be blocked [1], [60], [89].
Coverage of “Not Free” Countries. As discussed in Sec-
tion §III-B, the risks involved with setting up many vantage
points in certain sensitive (“not free”) countries prevent us
from claiming we can obtain complete coverage at all times.
However, the set of countries ICLab covers gives us a good, if
imperfect, longitudinal overview of worldwide censorship.
Evading Censorship Detection. Censors are known to try to
conceal some of their actions (“covert” censorship). ICLab can
detect some covert censorship, as discussed in §IV, but not all
of it. The “uncertain” and “probably censored” cases of TCP
packet injection (Figure 4 in §IV-B) are priorities for further
investigation. Censors could further conceal their actions by
disabling filtering for IP addresses that appear to be testing for
censorship. Comparing results for vantage points in the same
country gives us no reason to believe any country does this
today.
X. Conclusions
We presented ICLab, a global censorship measurement
platform that is able to measure a wide range of network
interference and Internet censorship techniques.
By using VPN-based vantage points, ICLab provides flex-
ibility and control over measurements, while reducing risks
in measuring Internet censorship at a global scale. Between
January 2017 and September 2018, ICLab has conducted
53,906,532 measurements over 45,565 URLs in 62 countries.
ICLab is able to detect a variety of censorship mechanisms as
well as other forms of network interference. Other longitudinal
measurement platforms may have more vantage points and
accumulated data than ICLab, but also more errors, and/or they
only focus on a specific type of censorship. Our platform
can more reliably distinguish normal network errors from
covert censorship, and our clustering techniques discovered 48
previously unknown block pages.
As we continue to operate ICLab and interact with relevant
political science and civil society organizations, ICLab will not
only make new technical observations, but also place qualitative
work in this area on a firm empirical footing.
Acknowledgements
Nick Feamster, Sathyanarayanan Gunasekaran, Ben Jones,
Mose Karanja, Anke Li,
the
Small Media Foundation, and the Citizen Lab, especially
Masashi Crete-Nishihata, Jakub Dalek, and Adam Senft, have
all provided invaluable assistance with the implementation,
testing, and deployment of ICLab.
the Berkman Klein Center,
We would like to thank our shepherd, Leyla Bilge, and all of
the anonymous reviewers for their feedback on this paper. We
also thank Behtash Banihashemi, Arun Dunna, Pamela Griffith,
Steve Matsumoto, Rishab Nithyanad, Pinar Ozisik, Vyas Sekar,
Mahmood Sharif, Rachee Singh, Kyle Soska, Janos Szurdi,
Xiao Hui Tai, and Nicholas Weaver for helpful comments and
suggestions.
This research was financially supported by the Ministry of
Science and ICT, Korea, under award IITP-2019-H8601-15-
1011; by the National Science Foundation, United States, under
awards CNS-1350720, CNS-1651784, CNS-1700657, CNS-
1740895, and CNS-1814817; by a Google Faculty Research
Award; and by the Open Technology Fund under an Information
Controls Fellowship. The opinions in this paper are those of