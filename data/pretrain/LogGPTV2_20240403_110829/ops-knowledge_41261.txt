### 服务器高 CPU 负载问题 (Cpanel + CentOS 5)

**问题描述：**
我们的服务器今天出现了高 CPU 负载，有时甚至达到 560。我们已经更新了最新的 Cpanel/WHM 和内核。当前的负载平均值如下：

- 1分钟平均负载: 39.05
- 5分钟平均负载: 75.01
- 15分钟平均负载: 45.33

**Apache 日志信息：**

- 当前时间: 2011年1月30日 01:50:13 EST
- 重启时间: 2011年1月29日 21:51:20 EST
- 父服务器生成: 2
- 服务器运行时间: 3小时58分钟53秒
- 总访问次数: 149,493 - 总流量: 2.4 GB
- CPU 使用情况: 用户态 9.17s, 系统态 10.66s, 子进程用户态 42.82s, 子进程系统态 0s - 0.437% CPU 负载
- 请求速率: 10.4 次/秒 - 流量速率: 174.6 KB/秒 - 平均请求大小: 16.7 KB
- 当前处理中的请求数: 121, 空闲工作线程数: 42
- 工作线程状态:
  ```
  W_WWW.__W_..W.W_W_WCWW..W...W.WWW.WWWW.WW.C_W_.W.WW.WC..W.WW._WW
  .W_.W.W..__._WWWW.._.WW.CC.C.._W.WC.WW_WW._W....W.WWW.W.WWW.W..W
  WW.....WW.W_WWWWW..WCRW..WWCW.WWW____.WWWWCW_W._._WW_W.._.W._..W
  _W..W.._WW.W.._.._W..._WW.W._WWW..__W.WWW._WWW_....WW_._C._..W._
  ```

- 状态板键：
  - `_` 等待连接
  - `S` 启动中
  - `R` 读取请求
  - `W` 发送响应
  - `K` 保持活动（读取）
  - `D` DNS 查找
  - `C` 关闭连接
  - `L` 记录日志
  - `G` 优雅地结束
  - `I` 空闲清理
  - `.` 空闲插槽，无当前进程

**问题分析：**
尽管 Apache 的 CPU 负载看起来正常，MySQL 进程也正常，但在停止邮件、HTTP 和 MySQL 服务后，CPU 负载仍然很高。

**建议的排查步骤：**

1. **查看 Apache 访问和错误日志文件**：没有日志的情况下很难确定具体原因。
2. **使用监控系统**：如果安装了 Cacti、Zabbix 等监控系统，请查看性能图表。
3. **安装 Nginx 前端**：Nginx 可以作为反向代理，减轻 Apache 的压力。
4. **检查统计信息**：
   - `top`：实时查看 CPU 使用情况
   - `ps`：查看进程状态
   - `iostat`：查看磁盘 I/O 统计
   - `vmstat`：查看虚拟内存统计
   - `iotop`：查看 I/O 使用情况
5. **阅读系统日志文件**：
   - `/var/log/kernel.log`
   - `/var/log/syslog`

通过以上步骤，您可以更全面地了解服务器的运行状况，并找出导致高 CPU 负载的原因。