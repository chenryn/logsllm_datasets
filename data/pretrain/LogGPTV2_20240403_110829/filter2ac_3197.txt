title:blackhat:eu-22 Bridging the Gap Between Research and Practice in Intelligently Bypassing WAF
AI-enabled cyber attack is fast becoming a prevalent topic. One of the representative topics is to utilize AI to learn how to bypass web application firewalls (WAFs). The general workflow includes three steps. First, build the original payload dataset that may be blocked by WAF, and collect the mutation operation set such as case substitution and adding comments in SQL injection. Second, use heuristic algorithm or reinforcement learning (RL) to explore a combination of operations to bypass the WAF. Finally, the mutated payloads that can bypass WAF are obtained.This workflow has laid a solid foundation for the intelligentization of cyber attacks, but we encounter two key problems in practice. 1) The payloads used in practice are diverse, and their bypass methods are also different. It is difficult for one algorithm to cover all types. 2) Different payloads have different degrees of difficulty to bypass. It is challenging to balance during the search process.Regarding the first problem, we propose to utilize Transformer Layer as feature extractor of the RL agent. We leverage RL to efficiently explore mutation combination, and leverage Transformer to model sequence features of different payloads. As for the second problem, we introduce a new sampling and exploration algorithm, which can focus on the hard samples during training, making hard samples to be adequately explored. To demonstrate the effectiveness of our method in practice, we conduct extensive experiments on 4 mainstream commercial WAFs with a rich real-world payload dataset. Our method achieves over 95% attack success rate against all the WAFs. All the bypass samples have been submitted to the corresponding vendors. Comprehensive experimental results indicate that our method is effective for the two problems mentioned above. More importantly, our method is not limited to web security and can be widely used in various fields.