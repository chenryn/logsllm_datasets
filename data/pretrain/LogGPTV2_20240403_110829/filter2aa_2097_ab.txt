[+] Host: x.x.x.x is up (Guess probability: 100%)
[+] Target: x.x.x.x is alive
[+] Primary guess:
[+] Host x.x.x.x Running OS: "Sun Solaris 5 (SunOS 2.5)" (Guess probability: 100%)
[+] Other guesses:
[+] Host x.x.x.x Running OS: "Sun Solaris 6 (SunOS 2.6)" (Guess probability: 100%)
[+] Host x.x.x.x Running OS: "Sun Solaris 7 (SunOS 2.7)" (Guess probability: 100%)
[+] Host x.x.x.x Running OS: "Sun Solaris 8 (SunOS 2.8)" (Guess probability: 100%)
[+] Host x.x.x.x Running OS: "Sun Solaris 9 (SunOS 2.9)" (Guess probability: 100%)
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
22
No Changes Are Made To the TCP/IP Stacks Of New 
Versions Of Operating Systems
[root@angelfire NG]# /usr/local/bin/nmap -sT -O x.x.x.x
Starting nmap 3.28 ( www.insecure.org/nmap/ ) at 2003-06-18 19:14 IDT
Interesting ports on x.x.x.x:
(The 1628 ports scanned but not shown below are in state: closed)
Port       State       Service
21/tcp     filtered    ftp
22/tcp     filtered    ssh
25/tcp     open        smtp
80/tcp     open        http
135/tcp    open        loc-srv
139/tcp    open        netbios-ssn
443/tcp    open        https
465/tcp    open        smtps
1029/tcp   open        ms-lsa
1433/tcp   open        ms-sql-s
2301/tcp   open        compaqdiag
5555/tcp   open        freeciv
5800/tcp   open        vnc-http
5900/tcp   open        vnc
6000/tcp   filtered    X11
Remote operating system guess: Windows NT 3.51 SP5, NT4 or 95/98/98SE
Nmap run completed -- 1 IP address (1 host up) scanned in 3.334 seconds
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
23
The Inability to Determine the Exact Software Service 
Pack 
 Traditional active operating system fingerprinting 
tools are usually unable to identify the installation of 
software service packs on a targeted machine
 For example, they will identify a target machine runs 
Microsoft Windows 2000, but will not be able to 
determine which service pack version is installed (if 
any at all)
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
24
Some Fingerprinting Tests May Have Bigger Impact on 
the Overall Results 
 Some fingerprinting tests may have bigger impact on 
the overall accuracy of the test results compared to 
other fingerprinting tests used
 If these tests fail, for some reason, the quality of the 
produced results will be lowered significantly, 
especially with tools using strict signature matching
 The affect of a failure of a mark key test on the results 
a tool using a fuzzy logic approach produces will be 
less significant, although it might take its toll as well
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
25
Some Fingerprinting Tests May Have Bigger Impact on 
the Overall Results
spanion:~ # xprobe2 -v x.x.x.x
XProbe2 v.0.1 Copyright (c) 2002-2003 PI:EMAIL,    
PI:EMAIL, PI:EMAIL
[+] Target is x.x.x.x
[+] Loading modules.
[+] Following modules are loaded:
...
[+] 7 modules registered
[+] Initializing scan engine
[+] Running scan engine
[+] Host: x.x.x.x is up (Guess probability: 100%)
[+] Target: x.x.x.x is alive
[+] Primary guess:
[+] Host x.x.x.x Running OS: "Microsoft Windows XP Professional / XP 
Professional SP1" (Guess probability: 100%)
[+] Other guesses:
[+] Host x.x.x.x Running OS: "Microsoft Windows 
2000/2000SP1/2000SP2/2000SP3" (Guess probability: 100%)
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
26
Some Fingerprinting Tests May Have Bigger Impact on 
the Overall Results
spanion:~ # xprobe2 -v -D 1 -D 2 -D 3 x.x.x.x
XProbe2 v.0.1 Copyright (c) 2002-2003 PI:EMAIL,
PI:EMAIL, PI:EMAIL
[+] Target is x.x.x.x
[+] Loading modules.
[+] Following modules are loaded:
[x][1] ICMP Timestamp
[x][2] ICMP Address
[x][3] ICMP Info Request
[x][4] ICMP port unreach
[+] 4 modules registered
[+] Initializing scan engine
[+] Running scan engine
[+] All alive tests disabled
[+] Target: x.x.x.x is alive
[+] Primary guess:
[+] Host x.x.x.x Running OS: "Microsoft Windows XP Professional /
XP Professional SP1" (Guess probability: 100%)
[+] Other guesses:
[+] Host x.x.x.x Running OS: "Microsoft Windows
2000/2000SP1/2000SP2/2000SP3" (Guess probability: 100%)
[+] Host x.x.x.x Running OS: "Microsoft Windows ME" (Guess probability: 
100%)
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
27
Different Networking Devices May Alter A Packet‟s Field 
Value 
Firewall
Probed System
R
(1) a probe is sent
Prober
(3) FW alters field values with the reply
(2) a reply is sent
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
28
A Firewalled Target Systems
Firewall
Probed System
R
Prober
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
29
A Firewalled Target Systems 
 Probed systems might be firewalled
 If a remote active operating system fingerprinting tool 
relies on sending and/or receiving of particular packet 
types and those packets are dropped by a firewall 
protecting the target system(s) chances are that the 
quality of the results would be degraded to the point 
false results or no results at all will be produced
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
30
The Use of Malformed Packets 
 If malformed packets are used, a filtering device may 
drop the packets, if the filtering device analyzes 
packets for non-legitimate content
 Therefore the quality of the results produced by 
utilizing a fingerprinting tests relying on malformed 
packets will be degraded and in some cases even fail
 Malformed packets may have another affect, they 
might cause some TCP/IP stacks to crash
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
31
A TCP/IP Stack‟s Behavior Might Be Altered 
 Some characteristics of a TCP/IP stack‟s behavior can be 
altered by a machine‟s system administrator:
–
Tunable parameters of the TCP/IP stack might be changed e.g. the sysctl
command on the various *BSDs, the ndd command on Sun Solaris, etc.
–
Numerous patches exist for some open source operating system’s kernels 
that alter the way the particular operating system’s TCP/IP stack responses 
to certain packets
 If a remote active operating system fingerprinting tool is 
using some of the TCP/IP based parameters that can be 
altered as part of its fingerprinting test, the quality of the 
results would be affected and questionable when these 
parameter values will be altered
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
32
The Quality of the Signature Database 
 The quality of the results produced by an active 
operating system fingerprinting tool is not only a 
factor of programming and terrain
 It is much affected from the way the signature 
database of the tool was and is built
 If signatures submitted to the database were and are 
obtained in a wrongfully manner than the signature 
database should be regarded as corrupt
 The results produced by the tool will not be accurate
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
33
The Quality of the Signature Database
 One can find false information quite easily in signature 
databases of some tools
 For example: nmap has a TCP “EOL” in the middle of a 
TCP Options list of some fingerprints
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
34
The Inability to Identify the Underlying Architecture 
Platform 
 Usually, active operating system fingerprinting tools 
will identify the operating system of a network node, 
but not its underlying platform
 The knowledge about the underlying platform is 
extremely important for tools performing vulnerability 
assessment, network inventory, etc., which rely on the 
results of the active operating system fingerprinting 
tool (i.e. nessus)
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
35
The Inability to Scale 
 An active operating system fingerprinting tool should 
have the ability to scan large networks
 Must not use many packets to do so
 For any router and switch there is an upper limit to the 
number of packets per second it can process. Beyond 
that limit, some packets will be dropped, but more 
important, the router/switch might suffer from a denial 
of service condition
 Therefore it is very important to balance the scan rate
with the network and network elements abilities
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
36
Inability to Control the Fingerprinting Modules to Be 
Executed 
 The intent of the OS fingerprinting attempt is important
–
If the intent of the scan is malicious, than it might be more beneficial for the 
malicious attacker to use minimum packets to achieve maximum results
–
If the reason is not malicious, usually, there is less importance for being 
stealth, still needing to achieve maximum results. Although we would still like 
to send minimum packets to probe each targeted system, eliminating the 
possibility of overwhelming the network and affecting its performance, we 
can use whatever fingerprinting tests we have for our disposal
 One needs to control the fingerprinting tests a certain tool 
has to offer according to her/his needs
 Furthermore, we would like an active OS fingerprinting tool 
to be able to detect certain scanning conditions and to 
react, by switching scanning tactics
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
37
Inability to Control the Fingerprinting Modules to Be 
Used
Firewall
Probed System
R
(3) a reply is sent
(1) a probe is blocked
Prober
(2) a different probe is used and is successful
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
38
The Remedy I
Added Functionality to Xprobe2
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
39
The Use of Best of Breed TCP/IP Stack Fingerprinting 
Techniques
 Searched for a TCP-based fingerprinting test with 
maximum impact on the overall fingerprinting results
 A test which will use as much parameters as possible
and provide with a real added value
 We have decided on adding a TCP module based on 
the TCP 3-way handshake
O F I R   A R K I N,   F O U N D E R,   T H E   S Y S – S E C U R I T Y   G R O U P
© 2 0 0 0 – 2 0 0 3     T H E   S Y S – S E C U R I T Y   G R O U P
40
The Use of Best of Breed TCP/IP Stack Fingerprinting 
Techniques
 The parameters with the SYN request resembles the 
parameters used with a Linux telnet request 
 Unlike other tools, which use a similar module, 
Xprobe2 examines parameters found in the IP and TCP
layers
Prober