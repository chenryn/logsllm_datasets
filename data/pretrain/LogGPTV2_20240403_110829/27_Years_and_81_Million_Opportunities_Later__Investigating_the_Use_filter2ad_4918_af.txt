university’s technical support during the pandemic. Similarly,
about one-third fewer certiﬁcates were issued to users in 2020
compared to the previous year (cf. Figure 10).
16cf. https://www.reuters.com/article/us-signal-users-idUSKBN29I27U
Key Management Challenges. We identiﬁed multiple key
management challenges. While we found limited use of email
encryption in general,
the use of multiple clients posed
additional challenges for S/MIME users in our dataset (cf.
Section V-C) – single client S/MIME users signed more than
60% while users with two clients only signed 1.58% of their
emails, which might be caused by a lack of tool support
for transferring S/MIME setups between clients. Similarly,
we identiﬁed challenges for long-term key and certiﬁcate
management. 42 out of 364 certiﬁcate rollovers occurred
months after the certiﬁcates’ expiration dates, which made it
impossible to produce valid signatures in the meantime. Better
tool support for easier key rollovers could contribute to earlier
certiﬁcate updates for a broader set of users. However, we also
identiﬁed a positive aspect of key management. Only three
emails had private keys attached, all of which were sent to
the users’ own mailboxes. Hence, in no case was private key
material leaked to unauthorized users. Overall, while our data
implies that key management needs to be improved, private
key leakage through email attachments was not an issue for
our users.
Missed Opportunities. In addition to the key management
issues above, we identiﬁed the initial distribution and use of
keys and certiﬁcates to be challenging for users. In particular,
using already exchanged public keys between users for further
email encryption was a surprising issue we found. While we
identiﬁed mutual public S/MIME key exchanges between 374
users, they only encrypted 13.95% of their future emails. Over-
all, 318,214 emails in our dataset could have been encrypted
between these users without any additional key exchange.
Here, our data illustrates that an automated mechanism for
more efﬁcient opportunistic encryption similar to Autocrypt
could potentially to help to increase the number of encrypted
emails.
VII. CONCLUSION
In this work, we presented the ﬁrst analysis of a large corpus
of longitudinal email data for thousands of users at a large
German university. We were able to conﬁrm common beliefs
and results from previous work in the security community:
Only few users used email encryption to secure only a small
fraction of their emails. We identiﬁed key management to be
challenging in particular in the context of multiple clients, key
rollovers and key exchange. Based on our evaluation, we make
suggestions for improving email encryption adoption. Overall,
we hope our investigation provides a data driven motivation
for future work to improve both the security and usability of
email encryption solutions.
ACKNOWLEDGMENT
The authors would like to thank the staff at the Leibniz
University IT Services at Leibniz University Hannover.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
872
REFERENCES
[1] R. Abu-Salma, E. M. Redmiles, B. Ur, and M. Wei, “Exploring User
Mental Models of End-to-End Encrypted Communication Tools,” in 8th
USENIX Workshop on Free and Open Communications on the Internet
(FOCI 18). Baltimore, MD: USENIX Association, 2018.
[2] R. Abu-Salma, M. A. Sasse, J. Bonneau, A. Danilova, A. Naiakshina,
and M. Smith, “Obstacles to the Adoption of Secure Communication
Tools,” in 2017 IEEE Symposium on Security and Privacy, SP 2017,
San Jose, CA, USA, May 22-26, 2017, 2017, pp. 137–153.
[3] O. Akgul, W. Bai, S. Das, and M. L. Mazurek, “Evaluating In-Workﬂow
Messages for Improving Mental Models of End-to-End Encryption,” in
30th USENIX Security Symposium (USENIX Security 21). USENIX
Association, Aug. 2021, pp. 447–464.
[Online]. Available: https:
//www.usenix.org/conference/usenixsecurity21/presentation/akgul
[4] T. Alrashed, A. H. Awadallah, and S. Dumais, “The Lifetime of Email
Messages: A Large-Scale Analysis of Email Revisitation,” in Proc. 2018
Conference on Human Information Interaction & Retrieval, ser. CHIIR
’18. New York, NY, USA: Association for Computing Machinery,
2018, p. 120–129.
[5] E. Atwater, C. Bocovich, U. Hengartner, E. Lank, and I. Goldberg,
“Leading Johnny to Water: Designing for Usability and Trust,” in
Eleventh Symposium On Usable Privacy and Security (SOUPS 2015).
Ottawa: USENIX Association, Jul. 2015, pp. 69–88.
[6] Autocrypt
team, “Autocrypt Level 1: Enabling encryption, avoiding
annoyances,” https://autocrypt.org/level1.html.
[7] N. Avigdor-Elgrabli, R. Gelbhart, I. Grabovitch-Zuyev, and A. Raviv,
“More than Threads: Identifying Related Email Messages,” in Pro-
ceedings of the 27th ACM International Conference on Information
and Knowledge Management, ser. CIKM ’18. New York, NY, USA:
Association for Computing Machinery, 2018, p. 1711–1714.
[8] W. Bai, D. Kim, M. Namara, Y. Qian, P. G. Kelley, and M. L. Mazurek,
“Balancing Security and Usability in Encrypted Email,” IEEE Internet
Computing, vol. 21, no. 3, pp. 30–38, 2017.
[9] W. Bai, M. Namara, Y. Qian, P. G. Kelley, M. L. Mazurek, and D. Kim,
“An Inconvenient Trust: User Attitudes toward Security and Usability
Tradeoffs for Key-Directory Encryption Systems,” in Twelfth Symposium
on Usable Privacy and Security (SOUPS 2016). Denver, CO: USENIX
Association, Jun. 2016, pp. 113–130.
[10] J. Callas, L. Donnerhacke, H. Finney, D. Shaw, and R. Thayer,
“OpenPGP message format (RFC 4880),” 2007.
[11] J. Clark, P. C. van Oorschot, S. Ruoti, K. E. Seamons, and
[Online]. Available:
D. Zappala, “Securing Email,” CoRR, 2018.
http://arxiv.org/abs/1804.07706
[12] D. Davis, “Compliance Defects in Public Key Cryptography,” in Pro-
ceedings of the 6th USENIX Security Symposium, San Jose, CA, USA,
July 22-25, 1996. USENIX Association, 1996.
[13] Z. Durumeric, D. Adrian, A. Mirian,
J. Kasten, E. Bursztein,
N. Lidzborski, K. Thomas, V. Eranti, M. Bailey, and J. A. Halderman,
“Neither Snow Nor Rain Nor MITM...: An Empirical Analysis of Email
Delivery Security,” in Proceedings of the 2015 Internet Measurement
Conference, ser. IMC ’15.
New York, NY, USA: Association for
Computing Machinery, 2015, p. 27–39.
[14] S. Dusse, P. Hoffman, B. Ramsdell, L. Lundblade, and L. Repka,
“RFC2311: S/MIME Version 2 Message Speciﬁcation,” 1998.
[15] M. Elkins, D. D. Torto, R. Levien, and T. Roessler, “RFC3156: MIME
Security with OpenPGP,” 2001.
[16] S. Fahl, M. Harbach, T. Muders, M. Smith, and U. Sander, “Helping
Johnny 2.0 to Encrypt His Facebook Conversations,” in Proc. 8th
Symposium on Usable Privacy and Security (SOUPS’12). ACM, 2012.
[17] D. Fisher, A. J. Brush, E. Gleave, and M. A. Smith, “Revisiting
Whittaker & Sidner’s ”Email Overload” Ten Years Later,” in Proceed-
ings of the 2006 20th Anniversary Conference on Computer Supported
Cooperative Work, ser. CSCW ’06. New York, NY, USA: Association
for Computing Machinery, 2006, p. 309–312.
[18] I. D. Foster, J. Larson, M. Masich, A. C. Snoeren, S. Savage, and
K. Levchenko, “Security by Any Other Name: On the Effectiveness
of Provider Based Email Security,” in Proceedings of the 22nd ACM
SIGSAC Conference on Computer and Communications Security, ser.
CCS ’15. New York, NY, USA: Association for Computing Machinery,
2015, p. 450–464.
[19] S. L. Garﬁnkel, D. Margrave, J. I. Schiller, E. Nordlander, and R. C.
Miller, “How to Make Secure Email Easier to Use,” in Proceedings of
the SIGCHI Conference on Human Factors in Computing Systems, ser.
CHI ’05. New York, NY, USA: Association for Computing Machinery,
2005, p. 701–710.
[20] S. L. Garﬁnkel and R. C. Miller, “Johnny 2: a user test of key
continuity management with S/MIME and Outlook Express,” in Proc.
1st Symposium on Usable Privacy and Security (SOUPS’05). ACM,
2005.
[21] S. L. Garﬁnkel, J. I. Schiller, E. Nordlander, D. Margrave, and R. C.
Miller, “Views, Reactions and Impact of Digitally-Signed Mail in e-
Commerce,” in Financial Cryptography and Data Security, A. S. Patrick
and M. Yung, Eds. Berlin, Heidelberg: Springer Berlin Heidelberg,
2005, pp. 188–202.
[22] S. Gaw, E. W. Felten, and P. Fernandez-Kelly, “Secrecy, Flagging, and
Paranoia: Adoption Criteria in Encrypted Email,” in Proceedings of the
SIGCHI Conference on Human Factors in Computing Systems, ser. CHI
’06. New York, NY, USA: Association for Computing Machinery,
2006, p. 591–600.
[23] G. Greenwald and E. MacAskill, “NSA Prism program taps into user
data of Apple, Google and others,” The Guardian, vol. 7, no. 6, pp.
1–43, 2013.
[24] G. Greenwald, E. MacAskill, and L. Poitras, “Edward Snowden: the
whistleblower behind the NSA surveillance revelations,” The Guardian,
vol. 9, no. 6, p. 2, 2013.
[25] A. Lerner, E. Zeng, and F. Roesner, “Conﬁdante: Usable Encrypted
Email: A Case Study with Lawyers and Journalists,” in 2017 IEEE
European Symposium on Security and Privacy (EuroS&P).
Los
Alamitos, CA, USA: IEEE Computer Society, apr 2017, pp. 385–400.
[26] J. R. P. Mauri´es, K. Krol, S. Parkin, R. Abu-Salma, and M. A. Sasse,
“Dead on Arrival: Recovering from Fatal Flaws in Email Encryption
Tools,” in The LASER Workshop: Learning from Authoritative Security
Experiment Results (LASER 2017). USENIX Association, Oct. 2017,
pp. 49–57.
[27] S. E. McGregor, E. A. Watkins, M. N. Al-Ameen, K. Caine, and
F. Roesner, “When the Weakest Link is Strong: Secure Collaboration in
the Case of the Panama Papers,” in 26th USENIX Security Symposium
(USENIX Security 17). Vancouver, BC: USENIX Association, Aug.
2017, pp. 505–522.
about
[28] A. Peterson, “Edward Snowden sent Glenn Greenwald this video
journalists. Greenwald ignored it.”
guide
https://www.washingtonpost.com/news/the-switch/wp/2014/05/14/
edward-snowden-sent-glenn-greenwald-this-video-guide-about-
encryption-for-journalists-greenwald-ignored-it/, 2014.
encryption for
[29] V. Roth, T. Straub, and K. Richter, “Security and usability engineering
with particular attention to electronic mail,” International Journal of
Human-Computer Studies, vol. 63, no. 1, pp. 51–73, 2005.
[30] S. Ruoti and K. Seamons, “Johnny’s Journey Toward Usable Secure
Email,” IEEE Security & Privacy, vol. 17, no. 6, pp. 72–76, 2019.
[31] S. Ruoti, J. Andersen, S. Heidbrink, M. O’Neill, E. Vaziripour, J. Wu,
D. Zappala, and K. Seamons, “”We’re on the Same Page” A Usability
Study of Secure Email Using Pairs of Novice Users,” in Proc. CHI
Conference on Human Factors in Computing Systems (CHI’16), 2016.
[32] S. Ruoti, J. Andersen, T. Hendershot, D. Zappala, and K. E. Sea-
mons, “Private Webmail 2.0: Simple and Easy-to-Use Secure Email,”
in Proceedings of
the 29th Annual Symposium on User Interface
Software and Technology, UIST 2016, Tokyo, Japan, October 16-19,
2016, J. Rekimoto, T. Igarashi, J. O. Wobbrock, and D. Avrahami, Eds.
ACM, 2016, pp. 461–472.
[33] S. Ruoti, J. Andersen, T. Monson, D. Zappala, and K. Seamons, “A
Comparative Usability Study of Key Management in Secure Email,” in
Proceedings of the Fourteenth USENIX Conference on Usable Privacy
and Security, ser. SOUPS ’18. USA: USENIX Association, 2018, p.
375–394.
[34] S. Ruoti, J. Andersen, D. Zappala, and K. E. Seamons, “Why Johnny
Still, Still Can’t Encrypt: Evaluating the Usability of a Modern
PGP Client,” CoRR, vol. abs/1510.08555, 2015. [Online]. Available:
http://arxiv.org/abs/1510.08555
[35] S. Ruoti, N. Kim, B. Burgon, T. W. van der Horst, and K. E. Seamons,
“Confused Johnny: when automatic encryption leads to confusion and
mistakes,” in Symposium On Usable Privacy and Security, SOUPS ’13,
Newcastle, United Kingdom, July 24-26, 2013, 2013, pp. 5:1–5:12.
[36] S. Sheng, L. Broderick, C. A. Koranda, and J. J. Hyland, “Why
Johnny Still Can’t Encrypt: Evaluating the Usability of Email Encryption
Software,” in Proc. 2nd Symposium on Usable Privacy and Security
(SOUPS’06). ACM, 2006.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
873
[37] Signal,
“Signal Support
-
Is
it
private? Can
I
trust
it?”
https://support.signal.org/hc/en-us/articles/360007320391-Is-it-private-
Can-I-trust-it-, visited 02/01/2021.
[38] C. Stransky, D. Wermke, J. Schrader, N. Huaman, Y. Acar, A. L.
Fehlhaber, M. Wei, B. Ur, and S. Fahl, “On the Limited Impact of
Visualizing Encryption: Perceptions of E2E Messaging Security,” in
Seventeenth Symposium on Usable Privacy and Security (SOUPS 2021).
USENIX Association, Aug. 2021, pp. 437–454. [Online]. Available:
https://www.usenix.org/conference/soups2021/presentation/stransky
[39] C. Stransky, O. Wiese, V. Roth, Y. Acar, and S. Fahl, “Companion
Website - EMail Paper,” https://publications.teamusec.de/2022-oakland-
email/, 2021.
[40] O. Tange, “GNU Parallel - The Command-Line Power Tool,” ;login:
The USENIX Magazine, vol. 36, no. 1, pp. 42–47, Feb 2011. [Online].
Available: http://www.gnu.org/s/parallel
[41] H. Tankovska, “Statista - Number of e-mail users worldwide from
2017 to 2024,” https://www.statista.com/statistics/255080/number-of-e-
mail-users-worldwide/, 2021.
[42] A. Ulrich, R. Holz, P. Hauck, and G. Carle, “Investigating the OpenPGP
Web of Trust,” in European Symposium on Research in Computer
Security. Springer, 2011, pp. 489–507.
[43] WhatsApp
LLC,
“end-to-end
encryption
https://blog.whatsapp.com/end-to-end-encryption/?lang=en,
02/01/2021.
- WhatsApp,”
visited
[44] S. Whittaker and C. Sidner, “Email overload: exploring personal infor-
mation management of email,” in Proceedings of the SIGCHI conference
on Human factors in computing systems, 1996.
[45] A. Whitten and J. D. Tygar, “Why Johnny Can’t Encrypt: A Usability
Evaluation of PGP 5.0,” in Proc. 8th Usenix Security Symposium
(SEC’99). USENIX Association, 1999.
[46] P. Zimmermann, “PGP Version 2.6.2 User’s Guide,” https://web.pa.msu.
edu/reference/pgpdoc2.html, Oct. 1994.
APPENDIX
A. S/MIME and PGP Parsing Errors
During the parsing of the mails, we encountered parsing
errors for 0.09% of all emails.
While the error rate for S/MIME is consistently low (cf.
Fig. 9), the error rate for PGP is higher (cf. Fig. 8). Overall, we
encountered parsing errors for up to 1.17% of the S/MIME and
22.09% of the PGP emails per year. While we cannot provide
in-depth insights into the parsing errors due to ethics and data
protection concerns, Figures 8 and 9 show that most of the
parsing errors for both S/MIME and PGP were caused by the
ﬁve most active users of the respective years. For example,
we saw most parsing errors for S/MIME in 2005 and PGP in
2004 where our data set included 1,367 S/MIME emails and
47 users and 1,521 PGP emails and 129 users. In this year, the
three most active S/MIME users contributed all parsing errors
for S/MIME and the ﬁve most active PGP users contributed
306 parsing errors (88.26% of all PGP parsing errors). Even
more extreme is the peak for PGP email related parsing errors
in 2004 which were mostly caused by a single KMail 17 user.
While parsing errors in general are disappointing since they
add noise to our results, the fact that the vast majority of errors
was caused by a small group of or even single users alleviates
their negative effects. Our evaluation focuses on a per-user and
not a per-email view. A small number of users whose emails
could not be parsed, for example, only has a low impact on
the overall data concerning the use of multiple email clients.
17cf. https://apps.kde.org/kmail2/
Fig. 8. PGP parsing errors over the years. The marked area is the parsing
errors of the top 5 users of the year.
Fig. 9. S/MIME parsing errors over the years. The marked area is the parsing
errors of the top 5 users of the year.
B. Pseudonymization Table
Table IV illustrates the pseudonymization we applied to the
data.
C. Certiﬁcates issued for our university
Figure 10 shows the certiﬁcates that were issued by the DFN
PKI in each year up until February 19, 2021.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
874
Header-Data
Message ID
User
User group
Sender
Receivers
CC list
BCC list
Date
Client
Folder
S/MIME-Data
Serial Number
Not Valid Before and After
Issuer Info
Signature Algo
Key size
Key type
Format
SHA-256 with salt
SHA-256 with salt
Categorized
SHA-256 with salt
SHA-256 with salt
SHA-256 with salt
SHA-256 with salt
Bracketed into week
Raw value
Categorized
Format
SHA-256 with salt1
Bracketed into weeks1
Raw value
Raw value
Raw value
Raw value
PGP-Data2
KeyID
Creation date
Expiration date
Type of key
Length
Key Algo
Digest Algo
1 Applied to the leaf certiﬁcate
2 Applied to both primary and sub key info
Format
SHA-256 with salt
Bracketed into week
Bracketed into week
Raw value
Raw value
Raw value
Raw value
TABLE IV
COLLECTED METADATA FOR ALL EMAILS INCLUDING THE STORAGE
FORMAT. FOR DATA PROTECTION REASONS AND IN CONSULTATION WITH
OUR UNIVERSITY’S DATA PROTECTION OFFICER AND THE IT STAFF, WE
CHOSE TO PSEUDONYMIZE SOME VALUES USING A HASH FUNCTION OR
CATEGORIES.
Fig. 10. X.509 certiﬁcates issued by the DFN PKI for our university from
2005 to 2020 using two different root certiﬁcates G1 and G2. G1 expired in
2019. Includes certiﬁcates issued until February 19, 2021.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
875