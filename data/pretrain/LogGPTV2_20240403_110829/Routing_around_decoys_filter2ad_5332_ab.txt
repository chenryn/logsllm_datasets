r
n
u
s
e
S
A
f
o
n
o
i
t
c
a
r
F
CN
AU
IR
SY
FR
VE
0
2
0
.
5
1
0
.
0
1
0
.
5
0
0
.
0
0
0
.
0.00
0.02
0.04
0.06
0.08
0.10
l
e
b
a
h
c
a
e
r
n
u
.
y
o
p
e
d
n
o
n
l
s
e
S
A
f
o
n
o
i
t
c
a
r
F
0
2
0
.
5
1
0
.
0
1
0
.
5
0
0
.
0
0
0
.
CN
AU
IR
SY
FR
VE
l
e
b
a
h
c
a
e
r
n
u
s
e
S
A
f
o
n
o
i
t
c
a
r
F
2
1
.
0
8
0
.
0
4
0
.
0
0
0
.
0
CN
AU
IR
SY
FR
VE
CN
AU
IR
SY
FR
VE
l
e
b
a
h
c
a
e
r
n
u
s
e
S
A
f
o
n
o
i
t
c
a
r
F
0
.
1
8
.
0
6
.
0
4
.
0
2
.
0
0
.
0
0.00
0.02
0.04
0.06
0.08
0.10
0
20
40
60
80
100
0
20
40
60
80
100
Fraction of ASes deploying DRs
Fraction of ASes deploying DRs
Index of position in as rank
Number of largest ASes deploying
(a) All ASes
(b) Non Participating
(c) Single Largest Deploy
(d) Combined Largest Deploy
Figure 2: Fraction of all ASes unreachable for all wardens via at least one clean path when faced with deployments of decoy routers to
random ASes. Both the fraction not reachable including those deploying decoy routers and the fraction of non-decoy router deploying ASes
which are unreachable is shown.
l
e
b
a
h
c
a
e
r
n
u
s
e
S
A
f
o
n
o
i
t
c
a
r
F
0
0
.
1
8
9
.
0
6
9
.
0
4
9
.
0
2
9
.
0
0
9
.
0
CN
AU
IR
SY
FR
VE
0
1000
2000
3000
4000
Number of largest ASes deploying
Figure 1: Fraction of ASes deploying decoy routers (chosen at ran-
dom for various deployment sizes) that a warden can detect.
the perspective of the warden, this means that the later ASes on
the pruned candidate path are “shadowed” by the ﬁrst AS—any
attempt to reach them goes through a tainted AS. To the warden, it
then does not matter if they are clean or tainted.
To evaluate this and other attacks, we implemented a routing
simulator based on CAIDA’s [2] inferred 2011 AS level topology.
We ran our experiments for Australia, China, France, Iran, Syria,
and Venezuela, considering each as a warden consisting of a coali-
tion of all their member ASes, as covered in Section 3. Paths be-
tween ASes were generated by running BGP using common rout-
ing practices, speciﬁcally valley-free routing [13]. After the rout-
ing topology converged, we then deployed decoy routers randomly
to ASes for various deployment sizes, and measured what fraction
of participating ASes each warden could detect using the method
explained above. We found that all wardens had roughly equal suc-
cess across all deployment sizes, and that they were able to detect
over 90% of participating ASes for deployments as large as 4000
ASes. At such large random deployments, it is likely that most of
the undetectable decoy routers were simply in the shadow of an-
other decoy.
Since the warden must effectively mark all shadowed ASes as
tainted, one goal of a decoy routing deployment would be to max-
imize the shadow produced by all participating ASes. However, as
we explore in the following section, this is more difﬁcult than it
might appear.
4.2 Routing Around the Routers
As stated previously, the goal of decoy router deployment is to
pick ASes such that all hosts in the warden’s jurisdiction have at
least one path that crosses a decoy router. Of all previous work, Cir-
ripede covers how to select ASes for deployment of decoy routers
in the most detail. Houmansadr et al. cover two deployment sce-
narios: random and Tier-1. In the random scenario, they claim that
only a small fraction of randomly chosen ASes, roughly 0.4% to
1.0% of all ASes according to their results, need to be selected.
Alternatively, in the Tier-1 scenario, they claim that as few as two
or three Tier-1 ASes are needed, since these large transit ASes will
have a vast number of paths that travel through them, including
many to popular destinations, making these paths easy to locate
and use.
The problem with these evaluations is that wardens, especially
large ones such as China, have a large collection of diverse paths for
the majority of destinations. This means that when decoy routers
are deployed to a handful of large ASes, all a warden needs to do
is select paths to destinations that do not utilize these ASes. Es-
sentially, routing adversaries redeﬁne the concept of availability
for decoy routers. Instead of needing a single path to a destina-
tion with a decoy router on it, all paths to a destination need decoy
routers deployed along them. The reason for this is simple. If the
warden has a collection of paths to a destination (some with decoy
routers and some without), then all the warden needs to do is alter
its routing policy to prefer routes that do not contain decoy routers.
Of course, if all paths to a destination have decoy routers then
the warden is left with several options: refuse to send informa-
tion to that network, launch detection attacks against hosts sending
data to those networks, or middlebox a subset of TLS connections
bound for those networks. China, the most interesting example of
a warden, has shown a willingness in the past to cut itself off from
parts of the Internet that take actions counter to their policies, but
conceivably would be unwilling to apply one of those solutions to
a large portion of the Internet. Egypt, during the Arab Spring of
2011, fully disconnected itself from the rest of the Internet tem-
porarily, and Iran has recently raised the threat of building home-
grown versions of popular websites and doing the same. In essence,
the decoy routing availability problem boils down to ﬁnding sufﬁ-
cient ASes to deploy decoy routers such that it will be too costly
for the warden to handle.
Using our simulator and our reconstructed Internet topology, we
explored how large of a deployment is needed to successfully dis-
connect a warden from a large fraction of the Internet. We deployed
decoy routers using a variety of deployment strategies and mea-
88sured the number of destinations to which each warden had at least
one path that did not encounter a single decoy router, henceforth
referred to as a clean path.
We start by considering Houmansadr et al.’s [18] “random ASes”
scenario. Figure 2 shows the average fraction of destinations to
which each warden fails to have a single clean path over 50 test
deployments. This value represents the fraction of the Internet that
each warden must cut itself off from in order to prevent use of the
decoy routing system. We see that if deploying decoy routers to
between 0.4% and 1.0% of all ASes, the wardens need only dis-
connect themselves from between 0.85% and 3.04% of the Internet.
Essentially, these countries need only disconnect themselves from
the ASes deploying decoy routers and an insigniﬁcantly sized “cus-
tomer cone.”1 Figure 2 also shows exactly what fraction of non-
participating ASes (i.e. those that are not deploying decoy routers)
are disconnected. As can be seen there, even if 10% of the Inter-
net deploys decoy routers, they only disconnect the wardens from
a mere 7-9% of the rest of the Internet on average.
We also consider the “Tier-1 only” deployment scenario. Fig-