time of the different malware distribution networks) are
beyond the scope of this paper and are a subject of our
future investigation.
4 Prevalence of Drive-by Downloads
We provide an estimate of the prevalence of web-
malware based on data collected over a period of ten
months (Jan 007 - Oct 007). During that period, we
subjected over 0 million URLs for in-depth processing
through our veriﬁcation system. Overall, we detected
more than 3 million malicious URLs hosted on more than
180 thousand landing sites. Overall, we observed more
than 9 thousand different distribution sites. The ﬁndings
are summarized in Table 1. Overall, these results show
the scope of the problem, but do not necessarily reﬂect
the exposure of end-users to drive-by downloads. In what
follows, we attempt to address this question by estimat-
ing the overall impact of the malicious web sites.
Data collection period
Total URLs checked in-depth
Unique suspicious landing URLs
Unique malicious landing URLs
Unique malicious landing sites
Unique distribution sites
Jan - Oct 007
66, 534, 330
3, 385, 889
3, 417, 590
181, 699
9, 340
Table 1: Summary of collected data.
To study the potential impact of malicious web sites
on the end-users, we ﬁrst examine the fraction of incom-
ing search queries to Google’s search engine that return
at least one URL labeled as malicious in the results page.
Figure  provides a running average of this fraction. The
graph shows an increasing trend in the search queries that
return at least one malicious result, with an average ap-
proaching 1.3% of the overall incoming search queries.
This ﬁnding is troubling as it shows that a signiﬁcant
fraction of search queries return results that may expose
the end-user to exploitation attempts.
To further understand the importance of this ﬁnding,
we inspect the prevalence of malicious sites among the
links that appear most often in Google search results.
From the top one million URLs appearing in the search
engine results, about 6, 000 belong to sites that have been
veriﬁed as malicious at some point during our data col-
lection. Upon closer inspection, we found that these sites
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
)
%
(
s
u
o
c
i
i
l
a
m
s
a
l
d
e
e
b
a
l
s
t
l
u
s
e
r
h
t
i
w
s
e
i
r
e
u
q
h
c
r
a
e
S
0
Apr-2007 May-2007 Jun-2007 Jul-2007 Aug-2007 Sep-2007 Oct-2007 Nov-2007 Dec-2007 Dec-2007 Jan-2008
Date
Figure : Percentage of search queries that resulted in at
least one URL labeled as malicious; 7-day running avg.
appear at uniformly distributed ranks within the top mil-
lion web sites—with the most popular landing page hav-
ing a rank of 1, 588. These results further highlight the
signiﬁcance of the web malware threat as they show the
extent of the malware problem; in essence, about 0.6%
of the top million URLs that appeared most frequently
in Google’s search results led to exposure to malicious
activity at some point.
An additional interesting result is the geographic lo-
cality of web based malware. Table  shows the ge-
ographic breakdown of IP addresses of the top  mal-
ware distribution sites and the landing sites. The results
show that a signiﬁcant number of Chinese-based sites
contribute to the drive-by problem. Overall, 67% of the
malware distribution sites and 64.6% of the landing sites
are hosted in China. These ﬁndings provide more evi-
dence [1] of poor security practices by web site admin-
istrators, e.g., running out-dated and unpatched versions
of the web server software.
dist. site
hosting country
% of all
dist. sites
landing site
% of all
hosting country
landing sites
China
United States
Russia
Malaysia
Korea
7.0%
1.0%
.0%
.%
.0%
China
United States
Russia
Korea
Germany
.%
1.%
.%
.0%
.0%
Table : Top  Hosting countries
Upon closer inspection of the geographic locality of
the web-malware distribution networks as a whole (i.e.,
the correlation between the location of a distribution site
and the landing sites pointing to it), we see that the mal-
ware distribution networks are highly localized within
common geographical boundaries. This locality varies
USENIX Association  
17th USENIX Security Symposium 


across different countries, and is most evident in China,
with 96% of the landing sites in China pointing to mal-
ware distribution servers hosted in that country.
4.1 Impact of browsing habits
In order to examine the impact of users’ browsing habits
on their exposure to exploitation via drive-by downloads,
we measure the prevalence of malicious websites across
the different website functional categories based on the
DMOZ classiﬁcation [1]. Using a large random sample
of about 7.2 million URLs , we ﬁrst map each URL to
its corresponding DMOZ category. We were able to ﬁnd
the corresponding DMOZ categories for about 0% of
these URLs . We further inspect each URL through our
indepth veriﬁcation system then measure the percentage
of malicious URLs in each functional category. Figure 
shows the prevalence of detected malicious and suspi-
cious websites in each top level DMOZ category.
As the graph illustrates, website categories associ-
ated with “gray content” (e.g., adult websites) show a
stronger connection to malicious content. For instance,
about 0.% of the URLs in the Adult category exhibited
drive-by download activity upon visiting these websites.
These results suggest that users who browse such web-
sites will likely be more exposed to exploitation com-
pared to users who browse websites from the other func-
tional categories. However, an important observation
from the same ﬁgure is that the distribution of malicious
websites is not signiﬁcantly skewed toward pages that
serve gray content. In fact, the distribution shows that
malicious websites are generally present in all website
categories we observed. Overall, these results show that
while “safe browsing” habits may limit users’ exposure
to drive-by downloads it does not provide an effective
safeguard against exploitation.
5 Malicious Content Injection
In Section , we showed that exposure to web-malware
is not strongly tied to a particular browsing habit. Our as-
sertion is that this is due, in part, to the fact that drive-by
downloads are triggered by visiting staging sites that are
not necessarily of malicious intent but have content that
lures the visitor into the malware distribution network.
In this section, we validate this conjecture by study-
ing the properties of the web sites that participate in the
malware delivery trees. As discussed in Section , at-
tackers use a number of techniques to control the con-
tent of benign web sites and turn them into nodes in the
malware distribution networks. These techniques can be
divided into two categories: web server compromise and
third party contributed content (e.g., blog posts). Unfor-
tunately, it is generally difﬁcult to determine the exact
contribution of either category.
In fact, in some cases
even manual inspection of the content of each web site
may not lead to conclusive evidence regarding the man-
ner in which the malicious content was injected into the
web site. Therefore, in this section we provide insights
into some features of these web sites that may explain
their presence in the malware delivery trees. We only fo-
cus on the features that we can determine in an automated
fashion. Speciﬁcally, where possible, we ﬁrst inspect
the version of the software running on the web server
for each landing site. Additionally, we explore one im-
portant angle that we discovered which contributes sig-
niﬁcantly to the distribution of web malware—namely,
drive-by downloads via Ads.
5.1 Web Server Software
y
r
o
g
e
t
a
c
n
i
s
L
R
U
s
u
o
c
i
i
l
a
m
f
o
e
c
n
a
a
v
e
r
P
l
0.8%
0.7%
0.6%
0.5%
0.4%
0.3%
0.2%
0.1%
0.0%
A
d
Fin
G
In
d
a
a
m
u
ult
n
c
e
s
e/In
s
O
B
E
U
C
u
nlin
strie
e 
s
nte
sin
n
o
k
m
e
n
rtain
o
s
s
w
n
C
o
m
T
p
Inte
ele
r
n
et
ute
r
s/
R
S
e
o
al 
c
o
E
m
Life
ciety
state
nic
u
m
Ele
u
r
a
n
c
e
m
m
u
e
nt
nitie
s
ctr
o
atio
nic
s
n
s
Figure : Prevalence of suspicious and malicious pages.
Suspicious
Malware
H
B
S
A
H
T
r
a
style
v
el
s
e
e
h
a
o
alth
uty/
L
o
o
p
uto
pin
e
r
s
g
P
m
m
e/
otiv
e
G
a
r