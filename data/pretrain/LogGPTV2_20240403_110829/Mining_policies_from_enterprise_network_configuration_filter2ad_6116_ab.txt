reach exactly the same set of destination addresses. Thus, each rect-
angle is the reachability set for a contiguous sequence of IP ad-
2In practice, we may end up using many more rules to represent
these sets; however, we employ ACL optimization techniques [1, 6]
to result in ACLs with the fewest number of non-overlapping rules.
3Our current implementation optimizes the ACLs ﬁrst to improve
the run-time and space requirements of this heuristic.
138EXTRACTPOLICYUNITS (SRSMatrix )
// Assume each SRS is represented using an ACL
for each rule rule ∈ srs
1 Initiate lists srcticks and dstticks to empty.
2 for each subnet-level reachability set srs ∈ SRSmatrix
3
4
5
6
7
Populate srcticks with start and end source IP address in rule.
Order the addresses in srcticks in ascending numeric order.
Populate dstticks with start and end destination IP address in rule.
Order the addresses in srcticks in ascending numeric order.
// Create subunitmatrix from the src and dst ticks.
// Initially, the matrix is empty.
8 subunitmatrix ← MATRIX(ksrcticks kbykdstticksk)
9 for each element (si , dj ) in subunitmatrix
10
Set a 1 if there is a rule in any SRS such that the space of packets it permits...
... supersedes the space of packets in (si , si+1 ) × (dj , dj +1 ).
// All subunits in a bucket have identical reachability and
// can be coalesced together into a policy unit
11 for each si ∈ the ﬁrst dimension of subunitmatrix
12
13
14 Coalesce all subunits in a bucket into a policy unit.
keystring ← HASH(dj ’s for which (si , dj ) = 1 ).
Insert the subunit into a hashtable using keystring .
Figure 3: Pseudocode for extracting policy units from subnet
reachability matrix, assuming each SRS is represented using an
ACL.
dresses within a source subnet that have identical reachability to the
rest of the network. Examples of the rectangles are shown in Fig-
ure 4.
Figure 4: The rectangles and policy subunits after the subnet-
level reachability sets have been decomposed.
We refer to the projections of the rectangles unto the x-axis (i.e.,
the source subnets) as “policy subunits”, also shown in Figure 4. In
other words, each policy subunit is a maximal contiguous sequence
of addresses in the source subnet — all of which can reach the same
portions of the destination subnets. In Figure 3, the source IP ad-
dress ranges extracted at lines 4 and 5 make up the network’s policy
subunits.
This decomposition step increases the number of columns (and
rows) in the SRS matrix transforming it into a subunitmatrix. In
this subunitmatrix, each column corresponds to a policy subunit
within a subnet. For instance, from three columns in Figure 2, we
reach a decomposed subunitmatrix with 7 columns shown in Fig-
ure 4. The single column corresponding to source subnet B in Fig-
ure 2 is now decomposed into four columns4. We show how the
subunitmatrix is created in lines 8–10 of Figure 3.
4Our heuristic may cause the number of rows to also increase; this
Figure 5: The ﬁnal policy units
To extract the policy units from the decomposed version of the
SRS matrix, we simply coalesce the policy subunits that have the
same reachability proﬁle to the rest of the network, i.e.
they can
reach the same set of destination addresses. This is speciﬁed more
formally in lines 11–14 in Figure 3.
In Figure 5, we see that the ﬁrst policy subunit within source sub-
net A, the ﬁrst policy subunit within source subnet B and the only
policy subunit for source subnet C all have the same proﬁle and
hence get coalesced into a single policy unit. Upon applying the
above approach to the example in Figure 2, we see that the network
has four policy units; policy unit 1 is shown at the bottom in Fig-
ure 5.
3. EMPIRICAL STUDY
In this section, we apply our technique for mining policy units to
router conﬁguration data obtained from ﬁve production networks.
We study two private corporate networks (which we call Enet-1 and
Enet-2) and three university networks (Univ-1, Univ-2, and Univ-
3). In all ﬁve networks, communication between hosts is restricted
using a mix of control and data plane mechanisms, implemented
at both layer-3 and layer-4. Three networks employed VLANs.
The goals of this study are: (1) to validate policy units can be au-
tomatically extracted from network conﬁgurations: (2) that policy
units reveal useful information about the policies a network imple-
ments, and (3) to catalog patterns employed by enterprise networks
in deﬁning their network-wide policy. Our observations also indi-
cate how operators can use policy units when reasoning about net-
work conﬁguration.
High-level properties of networks and their policies. Table 1
summarizes the properties of the networks we examined. The net-
works differ signiﬁcantly in the number of routers they use, the
number of allocated subnets, and the number of IP addresses. Ab-
sent more accurate information from operators, we use the number
of IP addresses as an admitedly rough indication of the number of
hosts in the network.
The table also shows the number of policy units that our frame-
work identiﬁed in each network. Several important observations
can be made from this. First, the number of policy units is much
less than the number of subnets, indicating that policy units are able
to concisely summarize the reachability policies of the network.
Second, there is no obvious correlation between the number of
policy units and the network size, in terms of the number of end-
depends on how the rules representing each SRS partition the space
of destination addresses, or the composition of dstticks in Figure 3
139Name
Univ-1
Univ-2
Univ-3
Enet-1
Enet-2
# Routers
12
24
24
7
83
# Subnets
942
869
617
98
142
# Policy units
2
2
15
1
40
# Addresses
100K
130K
100K
20K
24K
Table 1: Properties of the 5 networks studied, including the
number of policy units found in each.
 Univ−1
Univ−2
Univ−3
Enet−1
Enet−2
1
 Univ−1
Univ−2
Univ−3
Enet−1
Enet−2
0.2
0.4
0.6
0.8
Fraction of devices in the network
1
s
t
i
n
u
y
c
i
l
o
p
f
o
0.8
0.6
0.4
0.2
0
0
1
s
t
i
n
u
y
c
i
l
o
p
f
o
0.8
0.6
0.4
0.2
n
o
i
t
u
b
i
r
t
s
i
d
e
v
i
t
a
l
u
m
u
C
n
o
i
t
u
b
i
r
t
s
i
d
e
v
i
t
a
l
u
m
u
C
0
0
0.2
0.4
Cumulative distribution of end−points in the network
0.6
0.8
1
(a)
(b)
Figure 6: Structure of policies in the networks studied. Figure
(a) is a CDF of policy units as a fraction of the network devices
spanned. Figure (b) shows the cumulative fraction of end-points
in policy units (as a CDF).
points or subnets. In particular, the largest network in terms of the
number of end-points (Univ-2) has just two policy units, and one of
the smallest networks (Enet-2) has 40 policy units. This indicates
the diversity of reachability policies that modern enterprise employ
and that reachability policy is driven by network mission, not size.
Classes of Networks. From Table 1, we see that the networks
cluster into two groups: policy-lite networks (Univ-1, Univ-2, Enet-
1) that implement 1 or 2 policy units and policy-heavy networks
(Univ-3, Enet-2) that implement 14 and 40 policy units respectively.
We delve deeper into the policies in these networks below.
Structure of policies. In Figure 6, we examine the structure of
policy units inside each network. We study how many end-points
participate in each policy unit and how the end-points in each unit
are spread across the network.
We say a policy unit “spans” a router if any of the end-points that
are part of the policy unit are connected directly to that router. We
observe from Figure 6(a) that in the policy-lite networks, each pol-
icy unit spans over 50% of the routers in the network. We also notice
e
r
a
t
a
h
t
s
t
e
n
b
u
s
f
o
n
o
i
t
c
a
r
F
t
i
n
u
y
c
i
l
o
p
m
o
r
f
e
l
b
a
h
c
a
e
r
1
0.8
0.6
0.4
0.2
0
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0
s
t
s
o
h
f
o
n
o
i
t
c
a