### 4.2.3 VPN Activity Features

Section 3.2 demonstrates that, with a 10-minute threshold between detection and reporting times, approximately 77% of all malware encounters occur outside the corporate network. Although we lack visibility into users' activities outside the enterprise, VPN usage can serve as an approximate quantitative metric. We extracted the following features to model a user's VPN usage:

- **VPN_conn**: Total number of connections over the monitoring period.
- **VPN_dur**: Total duration of all VPN connections in seconds.
- **VPN_sbytes**: Sum of bytes sent in VPN connections.
- **VPN_rbytes**: Sum of bytes received in VPN connections.
- **VPN_extip**: Number of distinct external IP addresses from which VPN connections are initiated.

Intuitively, users connecting from many different external IPs visit multiple networks and may be exposed to more attack vectors. These features were aggregated over a subset of the monitoring period, from August 1 to November 10, 2013.

Table 5 indicates that almost all features are highly significant in estimating the conditional probability of malware encounters. Surprisingly, **VPN_dur** is the only feature negatively correlated with malware encounters (i.e., users exhibiting less total time in VPN sessions are at higher risk). One hypothesis is that users who frequently take their machines outside but spend less time on the VPN are more exposed to threats, as they lack protection by enterprise security products while on external networks.

| Feature     | Estimate  | Error        | p-value   | Significance |
|-------------|-----------|--------------|-----------|--------------|
| **VPN_conn** | 4.47e-03  | 3.22e-04     | 2e-16     | ***          |
| **VPN_dur**  | -8.54e-08 | 8.21e-09     | 2e-16     | ***          |
| **VPN_sbytes** | 9.65e-12  | 1.41e-12     | 6.96e-12  | ***          |
| **VPN_rbytes** | 1.38e-13  | 2.08e-12     | 0.947     |              |
| **VPN_extip** | 1.73e-02  | 6.62e-04     | 2e-16     | ***          |

**Table 5: Significance of VPN activity features.**

### 4.2.4 Web Activity Features

Various aspects of users' web behavior are potentially correlated with malware encounters. We investigate features related to categories of websites visited, aggregate volumes of web traffic, and connections to blocked or low-reputation sites.

#### Categories of Websites Visited

The web proxy vendor classifies websites into categories. For each host, we count the total number of HTTP connections to each category of interest, including chat, entertainment, file transfer, filtering, freeware, gaming, gambling, online storage and backup, peer-to-peer, social networks, online mail, streaming, business, travel, and non-categorized sites. As described in Section 3.4, non-categorized sites are those that are new and yet to receive a category label. The results in Table 6 show that only seven website categories are relevant in building the statistical model. Among these, four categories (chat, file transfer, social networks, and non-categorized sites) significantly contribute to estimating the risk of hosts encountering malware.

| Category            | Estimate  | Error       | p-value    | Significance |
|---------------------|-----------|-------------|------------|--------------|
| **Chat**            | 1.1e-05   | 2.8e-06     | 8.84e-05   | ***          |
| **Entertainment**   | 2.01e-08  | 7.4e-07     | 0.98       |              |
| **File transfer**   | 3.62e-06  | 1.1e-06     | 9.8e-04    | ***          |
| **Filtering**       | 2.12e-04  | 2.03e-04    | 0.3        |              |
| **Freeware**        | 2.05e-06  | 6.44e-07    | 1.4e-03    | ***          |
| **Gaming**          | 1.27e-05  | 6.48e-06    | 5.65e-07   | ***          |
| **Online storage**  | -3.7e-08  | e-07        | 1.36e-05   | *            |
| **Peer-to-peer**    | 2.09e-07  | 2.57e-06    | 0.05       | .            |
| **Social networks** | 4.54e-06  | 1.04e-06    | 0.71       |              |
| **Online mail**     | 6.45e-07  | 5.05e-07    | 0.94       |              |
| **Streaming**       | 4.48e-07  | 1.93e-07    | 0.20       |              |
| **Business**        | 2.44e-07  | 2.59e-07    | 0.02       | *            |
| **Travel**          | 1.74e-06  | 1.11e-06    | 0.35       |              |
| **Non-Categorized** | 4.49e-06  | 8.98e-07    | 0.12       | **           |

**Table 6: Significance of website category features.**

#### Web Usage Features

We also consider a set of features measuring the aggregate volume of web traffic generated by each host. Intuitively, higher Internet exposure could potentially result in a higher likelihood of encountering web-based malware. These features include:

- **No_conn**: Total number of web connections over the monitoring period.
- **No_doms**: Number of distinct domains visited by the host.
- **rbytes**: Sum of the bytes received in all web connections.
- **sbytes**: Sum of the bytes sent in all web connections.

Table 7 shows that only the number of distinct domains visited by the host is strongly correlated with the probability of encountering malware.

| Category  | Estimate  | Error         | p-value  | Significance |
|-----------|-----------|---------------|----------|--------------|
| **No_conn** | 2.14e-08  | 1.82e-08      | 2.07e-14 | ***          |
| **No_doms** | 1.84e-06  | 2.405e-07     | 0.24     | ***          |
| **rbytes**  | 3.83e-13  | 9.47e-13      | 0.69     |              |
| **sbytes**  | -6.82e-13 | 5.91e-13      | 0.24     |              |

**Table 7: Significance of web usage features.**

#### Blocked and Low-Reputation Domains

Accessing blocked or low-reputation sites might indicate risky activity. For each host, we count the number of web connections blocked by the proxy (Blocked), the number of connections to non-categorized sites that required explicit user agreement (Challenged), and the number of connections to non-categorized sites to which the user explicitly consented (Consented).

Additionally, we maintain a history of all external destinations visited by internal hosts in the enterprise over a three-month interval. This history is updated daily to account for newly visited domains. Connections to new domains, i.e., those that have not been visited before by any host in the organization, are also possible indicators of suspicious activity. For each host, we count the number of new domains visited each day, and then aggregate these values over the monitoring period into a feature called **New_domains**.

All of these features are highly significant in the logistic regression model, as shown in Table 8, but the most significant are visits to new domains (New_domains) and the number of non-categorized sites requiring user agreement (Challenged).

| Category         | Estimate  | Error        | p-value  | Significance |
|------------------|-----------|--------------|----------|--------------|
| **Blocked**      | 1.02e-06  | 3.05e-07     |          | ***          |
| **Challenged**   | 7.75e-06  |              |          | ***          |
| **Consented**    | 2.85e-03  |              |          | ***          |
| **New_domains**  | 8.25e-04  |              |          | ***          |

**Table 8: Significance of blocked and low-reputation domain features.**

This structured approach ensures clarity and coherence, making the text more professional and easier to follow.