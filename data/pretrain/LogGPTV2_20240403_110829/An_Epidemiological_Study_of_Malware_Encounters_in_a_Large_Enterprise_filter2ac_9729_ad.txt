0.37
-1.64
1.02
0.87
-0.23
0.52
0.19
0.57
0.62
-0.24
-0.02
0.52
0.15
0.08
Error
0.04
0.04
0.13
0.13
0.1
0.12
0.13
0.13
0.1
0.11
0.13
0.14
0.18
0.13
0.15
0.20
0.14
0.14
0.15
0.17
0.12
0.09
0.10
0.01
0.02
p-value
1.35e-09
2e-16
6.82e-15
1.36e-12
0.67
2e-16
0.07
0.08
2e-16
0.03
0.48
0.01
2e-16
0.26
3e-04
0.18
e-04
2e-04
0.047
0.79
2e-16
7e-04
2.29e-14
5.02e-09
3.23e-07
Signif.
***
***
***
***
***
.
.
***
*
**
***
***
***
***
***
***
*
***
***
***
Table 4: Signiﬁcance of demographic features.
4.2.3 VPN Activity Features
Section 3.2 shows that, with a threshold of 10 minutes between
detection and reporting times, around 77% of all malware encoun-
ters occurred outside the corporate network. While we have no
visibility into users’ activities outside the enterprise, VPN usage
is an approximate quantitative metric. We extracted the following
features to model a user’s VPN usage: VPN_conn (total number of
connections over the monitoring period), VPN_dur (total duration
of all VPN connections in seconds), VPN_sbytes (sum of bytes
sent in VPN connections), VPN_rbytes (sum of bytes received in
VPN connections), and VPN_extip (number of distinct external IP
addresses from which VPN connections are initiated). Intuitively,
7https://raw.github.com/Bemmu/gender-from-name
8For categorical features Gender and Country, values Female and
Australia, respectively, were chosen as the reference values by the
glm function (and as such are not explicitly included in the table).
1124users connecting from many different external IPs visit multiple
networks, and can be exposed to more attack vectors. These fea-
tures were aggregated over a subset of the monitoring period, from
August 1 to November 10, 2013.
Table 5 shows that almost all features are highly signiﬁcant in
estimating the conditional probability of malware encounters. Sur-
prisingly, VPN_dur is the only feature negatively correlated with
malware encounters (i.e., users exhibiting less total time in VPN
sessions are at higher risk). One conjecture is that users who bring
their machines outside often, but spend less time on VPN, are more
exposed to threats since they lack protection by enterprise security
products while on those external networks.
Feature
VPN_conn
VPN_dur
VPN_sbytes
VPN_rbytes
VPN_extip
Est.
4.47e-03
-8.54e-08
9.65e-12
1.38e-13
1.73e-02
Error
3.22e-04
8.21e-09
1.41e-12
2.08e-12
6.62e-04
p-value
2e-16
2e-16
6.96e-12
0.947
2e-16
Signif.
***
***
***
***
Table 5: Signiﬁcance of VPN activity features.
4.2.4 Web Activity Features
Various aspects of users’ web behavior are potentially correlated
with malware encounters. We investigate features related to cate-
gories of web sites visited, aggregate volumes of web trafﬁc, and
connections to blocked or low-reputation sites.
Categories of web sites visited. The web proxy vendor classiﬁes
web sites into categories. For each host, we count the total number
of HTTP connections to each category of interest, including chat,
entertainment, ﬁle transfer, ﬁltering, freeware, gaming, gambling,
online storage and backup, peer-to-peer, social networks, online
mail, streaming, business, travel and non-categorized sites. As de-
scribed in Section 3.4, non-categorized sites are those that are new
and yet to receive a category label. The results in Table 6 show
that only seven website categories are relevant in building the sta-
tistical model. Among these, four categories in particular (chat,
ﬁle transfer, social networks and non-categorized sites) contribute
signiﬁcantly to estimating the risk of hosts encountering malware.
Category
Chat
Entertainment
File transfer
Filtering
Freeware
Gaming
Online storage
Peer-to-peer
Social networks
Online mail
Streaming
Business
Travel
Non-Categorized
Est.
1.1e-05
2.01e-08
3.62e-06
2.12e-04
2.05e-06
1.27e-05
-3.7e-08
2.09e-07
4.54e-06
6.45e-07
4.48e-07
2.44e-07
1.74e-06
4.49e-06
Error
2.8e-06
7.4e-07
1.1e-06
2.03e-04
6.44e-07
6.48e-06
e-07
2.57e-06
1.04e-06
5.05e-07
1.93e-07
2.59e-07
1.11e-06
8.98e-07
p-value
8.84e-05
0.98
9.8e-04
0.3
1.4e-03
5.65e-07
1.36e-05
0.05
0.71
0.94
0.20
0.02
0.35
0.12
Signif.
***
***
**
.
***
*
***
Table 6: Signiﬁcance of website category features.
Web usage features. We also consider a set of features measuring
the aggregate volume of web trafﬁc generated by each host. Intu-
itively, higher Internet exposure could potentially result in higher
likelihood of encountering web-based malware. These features in-
clude: No_conn (total number of web connections over the mon-
itoring period), No_doms (number of distinct domains visited by
the host), rbytes (sum of the bytes received in all web connections),
and sbytes (sum of the bytes sent in all web connections). Table 7
shows that only the number of distinct domains visited by the host
is strongly correlated with the probability of encountering malware.
Category
No_conn
No_doms
rbytes
sbytes
Est.
2.14e-08
1.84e-06
3.83e-13
-6.82e-13
Error
p-value
Signif.
1.82e-08
2.405e-07
9.47e-13
5.91e-13
2.07e-14
0.24
0.69
0.24
***
Table 7: Signiﬁcance of web usage features.
Blocked and low-reputation domains. Accessing blocked or low-
reputation sites might be indicative of risky activity. For each host,
we count the number of web connections blocked by the proxy
(Blocked), the number of connections to non-categorized sites that
required explicit user agreement (Challenged), and the number of
connections to non-categorized sites to which the user explicitly
consented (Consented).
In addition, we maintain a history of all external destinations
visited by internal hosts in the enterprise over an interval of three
months. This history is updated daily to account for newly vis-
ited domains. Connections to new domains, i.e., that have not been
visited before by any host in the organization, are also possible in-
dicators of suspicious activity. For each host, we count the number
of new domains visited each day, and then aggregate these values
over the monitoring period into a feature called New_domains.
All of these features are highly signiﬁcant in the logistic regres-
sion model, as shown in Table 8, but the most signiﬁcant are visits
to new domains (New_domains) and number of non-categorized
sites requiring user agreement (Challenged).
Category
Blocked
Challenged
Consented
New_domains
Est.
1.02e-06
7.75e-06
2.85e-03
8.25e-04
Error
3.05e-07