189
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:03 UTC from IEEE Xplore.  Restrictions apply. 
weexplainthevariouspossibleeventsthattakeplaceintheSTEMcell,andtheassociatedrecoverymechanismthatisusedincaseofanerror.ItemployseitherasinglecycleorthreecyclefastlocalrecoverybasedonthevaluesofERRORandPANICsignals,showninFigure2.Table2:PossibleErrorScenariosCASER1R2R3ERRORPANICRECOVERYINENENE00NoRecoveryIISENENE10LoadR3intoR1,R2IIINESENE10LoadR3intoR1,R2IVNENESE01LoadR2intoR3VTENENE10LoadR3intoR1,R2VITESENE10LoadR3intoR1,R2•CASEI:Noerrorcase.Bothsignals,ERRORandPANIC,staylow.Systemoperationisnotinterrupted.•CASEII,III,V,VI:ThisrepresentsacasewhereoneoftheregistersR1orR2iscorrupted.Inthiscase,ERROR=1andPANIC=0.InthisscenarioR3isnotupdated,andthesystemrecoversbyloadingR3intoR1andR2triggeringre-computation.Athreecycleglobalrecoveryprocessisinitiated,whichincludes:onecyclestallforloadingdatabackintotheregistersR1andR2,usingLBKUPsignal,andtwocyclesforre-computation.Thistwocyclere-computationisre-quired,astheerrormighthaveoccurredbecauseofoverclocking,andthiserrorwillrepeatinR1,ifsuf-ﬁcienttimeisnotgivenforre-computation.Thispre-ventsrecurrentsystemfailures.•CASEIV:OnlyR3iscorrupted.Inthiscase,ERROR=0andPANIC=1.Nore-computationisre-quired.However,itisnecessarytoﬂushtheerroneousdatafromR3,tofacilitateerrorrecoveryinsubsequentcycles.AsdatainonlyR3iscorrupted,“golden”datapresentinR2isloadedintoR3.Thisrequiresasinglecyclesystemstall,duringwhichallSTEMcellsper-formalocalcorrection,usingLPANICsignal.FAULTTOLERANCEANALYSIS:Asisseen,theSTEMtechniquedetectsandrecoversfromallpossiblesoftandtimingerrorscenarios,whereinthesofterrorisonlyoftypeSET.Also,thecasewhereERROR=1andPANIC=1neverhappensbydesign.Ourtechniqueleadstosilentdatacorruption,ifanSEUhappensinR3.However,sinceregisterR3isonlyusedasacheckpointingregister,acorruptedR3valuemayleadtofailure,onlyifanerroroccursinR1orR2inthenextcycle.Consequently,thepossibilityofasystemfailurebecauseofaSEUinR3isheavilymitigated.ForCaseVI,weexpectthataTEorSEaffectsseveralSTEMcells,andthepossibilityofallcellshavingaTEinR1andSEinR2isinsigniﬁcant.Hence,wehopeoneoftheSTEMcellswillhavetheerrorsignaltriggered,preventingR3ofallSTEMcellsfrombeingloaded.IfERROR=1,thenwedonotlookatPANICsignal.ThefaultcoverageissimilartothatoftheSEMtechnique,exceptthatincaseoffalsepositives,westillneedtotakeappropriatecorrectiveaction.IncaseoftheSEMscheme,thisvaluewillbeover-written,asR3isusedonlyforerrordetection.However,theSTEMtechniqueallowsreliableoverclocking,achievinghigherperformancethanthosesystemsincorporatedwithSEMcells.4.PipelineDesignThebasicstepinusingSEMorSTEMcellsinapipelineistoreplaceallpipelineregisterswitheitheroneofthem.Inputclocksaretobeconstrainedinaway,soastoprovidefaulttolerancecapabilitiestothepipelinefromsofterror,aswellas,timingerrorwhenSTEMisthecellofchoice.Inthissection,ourdiscussionisbasedontheuseofSTEMcellsinplaceofpipelineregisters.UsingSEMcellsfollowstraightforward.Figure3illustrateshowSTEMcellsareintegratedintoaprocessorpipeline.Theﬁguredepictsthedataandcontrolﬂowforaﬁve-stagepipelineprocessor.Tothelaststageofthepipeline,whichiswriteback(WB),anextrawritebuffer,isadded.Thisistoensurethatdatawrittentotheregisterﬁleormemoryisalwaysfreefromtimingerrors.EverypipelinestageregisterisreplacedwithSTEMcells,exceptforthewritebufferregisters.AllerrorsignalsfromapipelinestagearelogicallyOR-edtogeneratethestageerrorforthatpipelinestage.Globalerrorsignal,GERROR,isgeneratedfromallpipelinestageerrorsignals,bycom-biningthemusinganother”OR”function.Similarly,globalLPANICsignalisgeneratedfromindividualPANICsignalfromallSTEMcells.Timingerrorsmayoccuroncetheoperatingfrequencyexceedstheworst-casefrequencyesti-mate.Asexplainedintheprevioussection,ourdatalatch-ingschemeofSTEMcellguaranteessufﬁcienttimebe-forelatchingvaluesinregistersR2andR3.However,datalatchedinallthreeregistersaresusceptibletosofterrorsthatareuniformlydistributedintimeandspace.Here,weexplainthepipelineoperationforERROR=1andPANIC=0(CaseII,III,V,VI),asthisisthemostcomplicatedcase.Onceanerrorisdetectedinanyoneofthepipelinestages,theglobalerrorsignalisasserted,andineverystageofthepipeline,registersR3oftheSTEMcellsarenotupdatedwiththeincomingdata.Inthenextclockcycle,theloadbackupsignal,LBKUP,isasserted,andineachSTEMcell,thecontentofregisterR3isloadedintocorrespondingR1andR2registers.Afterthis,theclocktothepipelineisstalledfortwocycles,completingtheerrorrecoveryprocess.ERRORRECOVERY:Inthefollowingdiscussion,wepresenttheerrorrecoveryschemeindetailforapipelineusingSTEMcells.Variouseventsinvolvedintherecov-eryprocessareillustaredwiththehelpofatimingdiagram.Figure4showshowourglobalerrorrecoveryschemeres-cuesasystemwhenanerrorhappens.Theﬁgurealsode-978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
190
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:03 UTC from IEEE Xplore.  Restrictions apply. 
PCIF/IDID/EXEIFIDEXEMEMEXE/MEMMEM/WBWBBUFFERCLOCKCONTROLERRORCLK1PCLK1GCLK2GCLK3GCLK2PCLK3PLBKUPCLOCKGENERATORERRORRATEERRORERRORERRORLPANICGERRORFigure3:PipelineDesignwithSTEMCellspictsthetimingrelationshipbetweenvariouscontrolsig-nals.Asmentioned,theglobalrecoverytakesthreeclockcyclesandthefollowingdescriptionexplainstheeventsthattakeplaceduringthewholeprocess.CLK1GGERRORLBKUPPIPELINEPIPELINEPIPELINEINST 0INST 1INST 2INST 3INST 2INST 3INST 0INST 1INST 2INST 1INST 2INST 3INST 0INST 1INST 0INST 1INST 212345678N-1NN+1CLK1PFROM LCMTO PIPELINEERRORNCLKCLK3PCLK2PCLK3GCLK2GCLKSTALL12CLKSTALL3Figure4:TimingDiagramsFigure4showsasetofclocksignals,CLK1G,CLK2GandCLK3G,thataregeneratedfromthemainclocksignal,CLK,usingaLCM.Next,itshowsasetofclocksignals,CLK1P,CLK2PandCLK3P,thatareroutedtothepipeline.Theseclocksignals,whicharegatedversionsofCLK1G,CLK2GandCLK3Grespectively,arestalledinamannerthatenablesthepipelinetorecoverfromdifferenterrorsce-narios.SignalERRORNindicatesanerrorhappeninginthepipelinestageN.ErrorsignalsfromallthepipelinestagesareOR-edtogethertogeneratetheglobalerrorsig-nal,GERROR,whichislatchedintheclockcontrolunit.Onceanerrorisdetected,theverynextclockedgeofclocksignalCLK3Gisgatedandinthenextcycle,LBKUPsig-nalisassertedhighforoneclockcycle.Inthesameclockcycle,usingCLK1PandCLK2P,recoverydatafromregis-terR3isloadedbackintoregistersR1andR2.Duringthenextcycle,allclocksignals,CLK1G,CLK2GandCLK3G,areclockgatedtogivethepipelinesufﬁcienttimeforre-computation.Clockgatingisachievedthroughcontrolsig-nalsCLKSTALL12andCLKSTALL3,whicharegeneratedbytheclockcontrolunit.Toillustrateourerrorrecoverymechanism,anerroroc-currenceishighlightedinCycle3.TheerroroccursduringtheexecutionofINST1ofpipelinestageN.ThiseventtriggerstheerrorrecoverymechanismthatspansfromCy-cle4toCycle6.DuringCycle4,dataisloadedintoregis-terR1andR2fromthecorrespondingstagegoldenregisterR3.Pipelineisallowedtoperformthecomputationdur-ingCycles5and6.ResultsareagaincheckedattheendofCycle6.Sincenoerrorisdetectedinthiscycle,normalpipelineoperationresumes.Fromthewaveforms,wecanseethatonanerrordetection,theentirepipelinegoesbackbyoneinstruction.Similarrecoveryactionsareperformedforapanicsituationanditinvolvesstallingtheclocksin-galsCLK1GandCLK2Gforjustonecycle.Inthiscase,thepipelinedoesnotrollbackandjustthecorrespondingstageR3registerisupdated.DYNAMICFREQUENCYSCALING:Inthefollowingdiscussion,wederivethelimitsoffrequencyscalingwithinwhichasystemintegratedwithSTEMcellsoperatesreli-ably.Pipelinestartsexecutionwithaminimalphaseshiftre-quiredbetweentheclocks,andtheclockfrequencyisgrad-uallyincreased,whilesatisfyingtheerrorrateconstraint.Tosupportreliabledynamicoverclocking,certaingoverningconditionsneedtobemetatalltimes,duringpipelineoper-ation.Letusassumethatthepipelineoperatesreliablybe-tweentheclockfrequencies,FMINandFMAX,governedbytimeperiods,TMAXandTMINrespectively.TMAXisestimatedbytheworst-casedesignsettings,andisequaltoworst-caseclockperiod,TWC.ThefollowingclockingconstraintsdecideTMIN.Underoverclockingconditions,thefollowingconstraintsmustbesatisﬁedforpropererrordetectionandrecovery.LetD1representthephaseshiftthatneedstobepro-videdforCLK2,withrespecttoCLK1,forsoftandtimingerrormitigation,whenthesystemisclockedwithclockpe-riodTMIN.LetD2representthephaseshiftthatneedstobeprovidedforCLK3,withrespecttoCLK1,forpropererrorrecovery,whenthesystemisclockedwithclockpe-riodTMIN.ValueofTMIN,satisfyingEquation(6),cor-respondstothemaximumfrequencyatwhichasystemcanpossiblyrecover,afteratimingerroroccurs.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
191
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:38:03 UTC from IEEE Xplore.  Restrictions apply. 
T1T2TPWTMAX…..TWCD1T3TPWT1T2TMINTWCT3TPWD2CLK1CLKCLK3CLK2FMINFMAXFigure5:DynamicFrequencyScalingTMIN+D1≥TPD(6)D2−D1≥TPW(7)TCD≥D2(8)CLOCKCONTROL:Clockcontrolmonitorstheerrorrateofthepipelineandcommunicatesthiserrorrateinfor-mationwiththeclockgeneratorforfrequencytuning.Clockgeneratorisconnectedtothepipelineinafeedbackloop.Itchecksthepipelineerrorratewithasettargetrate,whichisprogrammable.Processofgeneratingnewfrequencytakesupto10us,dependinguponthespeedatwhichthephaselockedloop(PLL)generatesthenewstableclocksignal.Dependingontheclockcontrolschemeanderrorratesam-plingschemechosen,clockfrequencyisadjustedtoallowthepipelinetooperatebelowasettargeterrorrate.Oncethenewclockisgenerated,themainclocksignal,CLK,isswitchedtothatfrequencyandotherclocksignalsCLK1G,CLK2G,CLK3GaregeneratedbyprovidingthenecessaryphaseshiftstoCLK.4.1.PerformanceAnalysisAkeyfactorthatlimitsfrequencyscalingiserrorrate.Asfrequencyisscaledhigher,thenumberofinputcom-binationsthatresultindelaysgreaterthanthenewclockperiodalsoincreases.Theimpactoferrorrateonfrequencyscalingisanalyzedasfollows:Lettwcdenotetheworst-caseclockperiod.Lettovde-notetheclockperiodafteroverclockingthecircuit.Letnbethenumberofcyclesneededtorecoverfromanerror.LetusassumethataparticularapplicationtakesNclockcyclestoexecute,undernormalconditions.Lettdiffbethetimedifferencebetweentheoriginalclockperiodandthenewclockperiod.Thenthetotalexecutiontimeisreducedbytdiff×N,ifthereisnoerror.Letusassumethattheappli-cationrunsattheoverclockedfrequencyofperiodtovwithanerrorrateofk%.Toachieveanyperformanceimprove-mentatthisfrequency,Equation(9)mustbesatisﬁed.Itstatesthatevenafteraccountingforerrorrecoverypenalty,executiontimerequiredisstilllessthanthatrequiredforworst-casefrequencyoperation.N×tov+n×N×k×tov<N×twc(9)k<(twc−tov)n×tov(10)FortheSTEMtechnique,anerrorcanhappeninﬁvedif-ferentscenarios,asmentionedinTable2,andalsotheerrorrecoverypenaltypaidisnotthesameforallthecases.Ifweassumethatalltheseerrorscenariosareequallylikely,thentheaverageerrorpenaltyincyclesis:n=4×3+1×15=2.6.AccordingtoEquation(10),forafrequencyincreaseof15%,theerrorratemustnotbehigherthan5.76%,fortheSTEMtechniquetoyieldnoperformanceimprovement.Forerrorrateslessthan1%,afrequencyincreaseof2.6%isenoughfortheSTEMschemetohaveaperformanceim-provementovernonfaulttolerantdesigns.OVERHEADS:Oneofthemainoverheadsincurredbyourschemesisﬁxingthecircuitcontaminationdelaytoarequiredvalue.Increasingthisdelayinvolvesrapidin-creaseinsiliconarea,asbuffersneedtobeinsertedintheshortcircuitdelaypaths.Thisproblemhastobeaddressedfromdifferentdesignperspectivesthatincludedevelopingnewsynthesisalgorithmsanddelaybufferdesignwithmin-imalareaconsumption.BothSEMandSTEMcellsrequiremetastabilitymitigationcircuits,asﬂip-ﬂopsmayenterametastablestatewhenoverclocked,orwhenasofterrorreachestheregistersduringthelatchingwindow.Ween-visagetheincorporationofametastabilitydetectioncircuit,similartotheonedevelopedin[7].5LocalClockGenerationReliabledynamicoverclockingtechniquehasbeenpro-posedearlier,in[16],toimprovesystemperformancebytuningtheclockfrequencybeyondtheconservativeworst-caseclockperiod.Itrequiresadynamicphaseshift(DPS)betweentheclocksignalstosupportaggressivedynamicclocktuning.Athigherfrequencies,controllingthephaseshiftpreciselyisachallengeandthisoftenrestrictsthepos-sibleoperatingfrequencyconﬁgurations.Toavoiddynamicphaseshiftbetweentheclocksignals,weincorporateacon-stantphaseshift(CPS)betweentheclocksthatareconﬁg-uredtorunbetweenfrequenciescorrespondingtothetimeperiods,TMAXandTMIN.LetusconsideracasewhereTMAX=10ns,TMIN=6nsandTCD=4ns.Consideringadynamicphaseshiftbetweentheclocksignals,whenwescalethesystemclockperioddownto8ns,thenweneedtoprovideaphaseshiftof2ns.Similarlyaphaseshiftof3nsisrequiredfora7nsclockperiod.Sincethecircuitcontaminationdelayisin-creasedto4nstoaggressivelyclockthesystem,computeddatawillremainstablefor(T+4)ns,whereTisthecur-rentoperatingfrequencyofthesystem.Insteadofrequiringadynamicphaseshiftalongwithfrequencyscaling,wepro-videaconstantphaseshiftofatmostTCDatalltimes.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE