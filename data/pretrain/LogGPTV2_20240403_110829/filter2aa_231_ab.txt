goto
out ;
p r i n t f ("\ nEncoded WSM (%lu
bytes ) : \ n" ,
count ) ;
i n t
i ;
f o r
( i = 0;
i < count ;
i++)
p r i n t f ("%02x " ,
bytes [ i ] ) ;
size_t
parsed_index = 0 ;
parsed = wsmp_wsm_decode( bytes , &parsed_index ,
count , &err , WSMP_STRICT) ;
i f
( e r r )
goto
out ;
size_t
parsed_count = 0 ;
uint8_t ⇤ parsed_bytes = wsmp_wsm_encode( parsed , &parsed_count , &err , WSMP_STRICT) ;
i f
( e r r )
goto
out ;
/⇤
Equality
check
⇤/
f o r
( i = 0;
i < count ;
i++)
i f
( bytes [ i ]
!= parsed_bytes [ i ] )
goto
out ;
p r i n t f ("\n\nRecovered
Encoding (%lu
bytes ) : \ n" ,
parsed_index ) ;
f o r
( i = 0;
i < parsed_count ;
i++)
p r i n t f ("%02x " ,
parsed_bytes [ i ] ) ;
p r i n t f ("\n " ) ;
out :
free_wsm (msg ) ;
free_wsm ( parsed ) ;
return
e r r ;
}
Output
7
BEGIN WSM
subtype :
0
version :
3
tpid :
0
use_n_iex :
1
n_iex :
BEGIN IEX
count :
3
chan :
172
data
rate :
3
tx_pow :
30
psc . len :
0
psc . data :
ip :
00000000000000000000000000000000
port :
0000
mac
000000000000
rcpi_thres :
0
count_thres :
0
count_thres_int :
0
edca . ac_be :
00000000
edca . ac_bk :
00000000
edca . ac_vi :
00000000
edca . ac_vo :
00000000
chan_access :
0
repeat_rate :
0
loc_2d . l a t i t u d e :
00000000
loc_2d . longitude :
00000000
loc_3d . l a t i t u d e :
00000000
loc_3d . longitude :
00000000
loc_3d . e l e v a t i o n :
0000
advert_id . len :
0
sec_dns :
00000000000000000000000000000000
gateway_mac :
000000000000
raw_count :
0
raw :
in_use :
(0 ,
0)
(1 ,
0)
(2 ,
0)
(3 ,
0)
(4 ,
1)
(5 ,
0)
(6 ,
0)
(7 ,
0)
(8 ,
0)
(9 ,
0)
(10 ,
0)
(11 ,
0)
(12 ,
0)
(13 ,
0)
(14 ,
0)
(15 ,
1)
(16 ,
1)
(17 ,
0)
(18 ,
0)
(19 ,
0)
(20 ,
0)
(21 ,
0)
(22 ,
0)
(23 ,
0)
END IEX
psid :
00004385
ports . s r c :
8543
ports . dst :
0000
use_t_iex :
0
length :
13
data :
8
48 65 6c 6c 6 f
20 77 6 f
72 6c 64 21 00
END WSM
Encoded WSM (29
bytes ) :
0b 03 04 01 1e 0 f
01 ac 10 01 03 00 c0 03 05 0d 48 65 6c 6c 6 f
20 77 6 f
72 6c 64 21 00
Recovered
Encoding
(29
bytes ) :
0b 03 04 01 1e 0 f
01 ac 10 01 03 00 c0 03 05 0d 48 65 6c 6c 6 f
20 77 6 f
72 6c 64 21 00
References
[1] IEEE Std 802.11-2012 IEEE Standard for Information Technology – Telecommunications and
information exchange between systems – Local and metropolitan area networks–Speciﬁc re-
quirements – Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer
(PHY) Speciﬁcations
[2] IEEE Std 1609.0-2013 IEEE Guide for Wireless Access in Vehicular Environments (WAVE) –
Architecture
[3] IEEE Std 1609.2-2016 IEEE Standard for Wireless Access in Vehicular Environments – Secu-
rity Services for Applications and Management Messages
[4] IEEE Std 1609.3-2016 IEEE Standard for Wireless Access in Vehicular Environments (WAVE)
– Networking Services
[5] IEEE Std 1609.4-2016 IEEE Standard for Wireless Access in Vehicular Environments (WAVE)
– Multi-channel Operation
[6] IEEE Std 1609.11-2010 IEEE Standard for Wireless Access in Vehicular Environments
(WAVE) – Over-the-Air Electronic Payment Data Exchange Protocol for Intelligent Trans-
portation Systems (ITS)
[7] IEEE Std 1609.12-2016 IEEE Standard for Wireless Access in Vehicular Environments
(WAVE) – Identiﬁer Allocations
[8] ETSI EN 302 636-4-1 V1.2.1 (2014-05), Intelligent Transport Systems (ITS); Vehicular Com-
munications; GeoNetworking; Part 4: Geographical addressing and forwarding for point-to-
point and point-to-multipoint communications; Sub-part 1: Media-Independent Functionality.
[9] ISO 29281-1, Intelligent transport systems — Communications access for land mobiles
(CALM) — Non-IP networking—Part 1: Fast networking & transport layer protocol (FNTP).
[10] E. Donato, E. Madeira and L. Villas, "Impact of desynchronization problem in 1609.4/WAVE
multi-channel operation," 2015 7th International Conference on New Technologies, Mobility
and Security (NTMS), Paris, 2015, pp. 1-5.
[11] C. Valasek, C. Miller, "Remote Exploitation of an Unaltered Passenger Vehicle," 2015
[12] William Whyte, Jonathan Petit, Virendra Kumar, John Moring and Richard Roy, "Threat
and Countermeasures Analysis for WAVE Service Advertisement," IEEE 18th International
Conference on Intelligent Transportation Systems, 2015
[13] SAE J 2735-2016 Dedicated Short Range Communications (DSRC) Message Set Dictionary
9