# G0014: Night Dragon
## Description
[Night Dragon](https://attack.mitre.org/groups/G0014) is a campaign name for activities conducted by a threat group primarily originating from China. (Citation: McAfee Night Dragon)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Windows, macOS, Linux, Office 365, SaaS | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Spearphishing Link](https://attack.mitre.org/techniques/T1192/) | Night Dragon sent spearphishing emails containing links to compromised websites where malware was downloaded. | Packet capture, Web proxy, Email gateway, Detonation chamber, SSL/TLS inspection, DNS records, Mail server |
| Linux, Windows, macOS, AWS, GCP, Azure | [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190/) | Night Dragon performed SQL injection attacks on extranet web servers to gain access. | Azure activity logs, AWS CloudTrail logs, Stackdriver logs, Packet capture, Web logs, Web application firewall logs, Application logs |
| Windows | [Lateral Movement](https://attack.mitre.org/tactics/lateral-movement/) | [Pass the Hash](https://attack.mitre.org/techniques/T1075/) | Night Dragon used pass-the-hash tools to obtain usernames and passwords. | Authentication logs |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Standard Application Layer Protocol](https://attack.mitre.org/techniques/T1071/) | Night Dragon used HTTP for command and control (C2). | Packet capture, Netflow/Enclave netflow, Process use of network, Malware reverse engineering, Process monitoring |
| Windows, Linux, macOS | [Credential Access](https://attack.mitre.org/tactics/credential-access/) | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | Night Dragon dumped account hashes using Carbanak and cracked them with Cain & Abel. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Linux, Windows, macOS | [Execution](https://attack.mitre.org/tactics/execution/) | [User Execution](https://attack.mitre.org/techniques/T1204/) | Night Dragon enticed users to click on links in spearphishing emails to download malware. | Anti-virus, Process command-line parameters, Process monitoring |
| Linux, Windows, macOS | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Remote Access Tools](https://attack.mitre.org/techniques/T1219/) | Night Dragon used several remote administration tools as persistent infiltration channels. | Network intrusion detection system, Network protocol analysis, Process use of network, Process monitoring |
| Linux, macOS, Windows | [Command and Control](https://attack.mitre.org/tactics/command-and-control/) | [Commonly Used Port](https://attack.mitre.org/techniques/T1043/) | Night Dragon used ports 25 and 80 for C2 communications. | Packet capture, Netflow/Enclave netflow, Process use of network, Process monitoring |
| Windows | [Persistence](https://attack.mitre.org/tactics/persistence/), [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [External Remote Services](https://attack.mitre.org/techniques/T1133/) | Night Dragon used compromised VPN accounts to gain access to victim systems. | Authentication logs |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/), [Persistence](https://attack.mitre.org/tactics/persistence/), [Privilege Escalation](https://attack.mitre.org/tactics/privilege-escalation/), [Initial Access](https://attack.mitre.org/tactics/initial-access/) | [Valid Accounts](https://attack.mitre.org/techniques/T1078/) | Night Dragon used compromised VPN accounts to gain access to victim systems. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Disabling Security Tools](https://attack.mitre.org/techniques/T1089/) | Night Dragon disabled anti-virus and anti-spyware tools and proxy settings on victim machines to allow direct communication to the Internet. | API monitoring, File monitoring, Services, Windows Registry, Process command-line parameters, Anti-virus |
| Linux, macOS, Windows, AWS, GCP, Azure | [Collection](https://attack.mitre.org/tactics/collection/) | [Data Staged](https://attack.mitre.org/techniques/T1074/) | Night Dragon copied files to company web servers and subsequently downloaded them. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | A Night Dragon DLL included an XOR-encoded section. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Windows, macOS | [Defense Evasion](https://attack.mitre.org/tactics/defense-evasion/) | [Software Packing](https://attack.mitre.org/techniques/T1045/) | Night Dragon used software packing in its tools. | Binary file metadata |
|  | [Establish and Maintain Infrastructure](https://attack.mitre.org/tactics/establish-&-maintain-infrastructure/) | [Acquire and/or Use 3rd Party Software Services](https://attack.mitre.org/techniques/T1330/) | Night Dragon used third-party hosting services in the U.S. to hide their operations. |  |
|  | [Adversary OPSEC](https://attack.mitre.org/tactics/adversary-opsec/) | [Acquire and/or Use 3rd Party Infrastructure Services](https://attack.mitre.org/techniques/T1307/) | Night Dragon used servers in China, the U.S., and the Netherlands to hide their operations. |  |
|  | [Build Capabilities](https://attack.mitre.org/tactics/build-capabilities/) | [Remote Access Tool Development](https://attack.mitre.org/techniques/T1351/) | Night Dragon used privately developed and customized remote access tools. |  |

This table provides a comprehensive overview of the tactics, techniques, and procedures (TTPs) employed by the Night Dragon threat group, along with the relevant data sources for detection and mitigation.