29 
29 
31 
31 
29 
29 
29 
29 
29 
31 
31 
6 
29 
7 
31 
3 
35 
33 
5 
136  4 
4 
31 
29 
2 
VEP 
Alarm. & Compl. Det. to Part. Alarm. & Compl. Det. 
28 
1 
all_uniexp.c 
3 
28 
decodecheck.pl 
6 
decodexecute.pl 
29 
30 
iisenc.zip 
3 
130  6 
iis_nsiislog_post.pm 
11 
iis_zang.c 
Lala.c 
9 
Alarm. & Compl. Det. to Quiet & Compl. Det. 
execiis.c 
iis_escape_test 
iisex.c 
iisrules.pl 
iisrulessh.pl 
unicodecheck.pl 
unicodexecute2.pl 
Part. Alarm. & Compl Det. to Quit & Compl Det. 
iisuni.c 
6 
Part. Alarm. & Compl. Det. 
iis_source_dumper.pm 
2 
Alarm. (Failed Only) to Part. Alarm. (Failed Only) 
apache chunked win32.pm  0 
0 
ddk-iis.c 
0 
iis40_htr.pm 
linux-wb.c 
0 
xnuser.c 
0 
Alarm. (Failed Only) to Quiet (Failed Only) 
fpse2000ex.c 
wd.pl 
iis_printer.bof.c 
iis_w3who_overflow.pm 
iis5.0_ssl.c 
iis5hack.pl 
windows_ssl_pct.pm 
msadc.pl 
rs_iis.c 
0 
38 
0 
16 
0 
38 
0 
70 
0 
38 
38 
0 
152  0 
31 
0 
9 
26 
Table 3. Bro enhancement over Snort2 
0 
38 
0 
16 
0 
38 
0 
70 
0 
38 
38 
0 
152  0 
31 
0 
0 
35 
45 
30 
136  16 
23 
15 
34 
4 
11 
27 
75 
0 
152  0 
0 
38 
38 
0 
0 
38 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
0 
23  10 
30 
3 
35  99 
134  0 
6 
2 
detect that all or some attacks have failed based on the two 
enhancements previously discussed. Table 3 presents these 
results.  However,  some  of  these  enhancements  prevented 
Bro  from  detecting  successful  attacks  generated  by  five 
VEP in the data set. For instance, the attack scenarios from 
sol2k.c,  iis50_printer_overflow.pm,  iiswebexplt.pl,  and 
jill.c  evade  Bro  detection.  The  enhanced  version  of  this 
rule  by  Bro  requires  no  error  message  from  the  server 
when  the  server  is  IIS.  However,  in  the  case  of  this 
particular  group  of  attacks,  no  information  is  provided  by 
the server to identify it as IIS when the attack is successful. 
Thus,  the  rule  is  never  triggered  and  we  have  false 
negatives when the attacks are successful  
m00-apache-w00t.c  also  evades  detection  when  Bro  is 
used,  but  for  a  different  reason.  Once  again  the  enhanced 
version  of  the  rule  for  detecting  this  attack  requires  no 
error  message  as  a  reply  by  the  server.  In  this  particular 
case, it is the type of error message given by the server that 
represents  the  exploitation  of  this  vulnerability.  This VEP 
is used to find the name of users allowed on the server. If a 
request  is  made  with  a  particular  user  name,  the  error 
message  403  Forbidden  Access  specifies  to  the  VEP  that 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006this user name is valid on this server. Bro once again failed 
to detect successful attempts of this attack. 
provide  a  fair  analysis,  only  the  results  of  IDS  evasion 
techniques  that  are  applied  to  successful  attacks  that  have 
been detected by both IDS are presented.  
5.5  Snort Enhancement Group 
Snort  also  provides  a  mechanism  to  compare  server 
responses with the client requests. This mechanism can be 
achieved using the flowbits plug-ins. The s2b tool was not 
able  to  translate  flowbits.  This  enhancement  by  Snort  is 
also effective because 6 of the results for the VEP used to 
generate attacks have partially moved from being classified 
as  false  positives  for  Bro  to  true  negative  for  Snort. 
Moreover, for four VEP, Snort provides better results than 
Bro because it was not possible to translate, even by hand, 
the  corresponding  Snort  rules  into  Bro  language.  Even  if 
Snort  is  able  to  detect  that  a  small  number  of  attacks 
generated  by  the  VEP  have  failed  (only  against  Windows 
NT)  the  number  of  false  positives  is  still  large.  Table  4 
presents these results for the flowbits enhancement. As we 
can  see,  the  flowbit  enhancement  is  minimal  compared  to 
Bro enhancement. 
5.6  IDS Evasion Results 
The  EvaSet  is  used  to  test  the  accuracy  of  IDS  in  the 
case  of  attacks  hidden  using  standard  IDS  evasion 
techniques.  The  objective  is  not  to  develop  new  IDS 
evasion  techniques,  but  to  show  that  our  virtual  network 
infrastructure is able to automatically produce attack traces 
used in combination with IDS evasion techniques. 
The  list  of  papers  related  to  IDS  evasion  techniques 
described in Section 2, refers to a variety of tools [39–42] 
that  can  be  used  to  manipulate  attacks  to  evade  detection 
by  IDS.  These  tools  provide  an  explosion  of  possible 
mutations  when  applied 
to  every  successful  attack 
scenarios  in  our  standard  data.  The  EvaSet  contains  two 
groups  of  IDS  evasion  techniques:  packet  fragmentation 
Snort 2.3.2 
Bro 0.9a9 
TP  TN  FP  TP  TN  FP 
VEP 
Part. Alarm. & Compl. Det. to Alarm & Compl. Det. 
0x82-dcomrpc usemgret.c 
0 
0 
30.07.03.dcom.c 
0 
dcom.c 
0 
ms03-039-linux 
0 
oc192-dcom.c 
rpcexec.c 
0 
45 
185 
113 
25 
23 
32 
Table 4. Snort enhancement over Bro2 
45 
5 
12  173  13 
105  13 
8 
23 
2 
21 
2 
2 
30 
45 
13 
13 
0 
13 
4 
40 
0 
13 
4 
[40].  These 
[19]  and HTTP evasion techniques  [14, 15, 18].  They are 
respectively implemented using Fragroute [42] and a proxy 
version  of  Whisker 
tools  are  proxy 
applications,  meaning  that  attack  traffic  is  captured  by 
these  tools  and  manipulated  to  apply  an  IDS  evasion 
technique. They provide an efficient way for launching the 
same attacks from the original data set while applying IDS 
evasion techniques. Table 5 provides a summary of results 
from  the  analysis  of  Snort  and  Bro  against  EvaSet.  To 
In  both  cases,  the  IDS  were  able  to  detect  the  attacks 
even with the IDS evasion techniques, except for Unicode 
URI,  Unicode  URI  (no  /)  and  Null  Method  in  the  case  of 
Bro.  Bro  does  not  detect  both  Unicode  URI  encoding 
methods  since  it  does  not  have  a  Unicode  decoder  for 
HTTP URI. In the case of Null Method, Bro seems unable 
to  properly  decode  the  mutated  URI  as  opposed  to  the 
targeted  server.  It  is  interesting  to  note  that  some  VEP 
were  not  successful  when  they  were  used  with  some  IDS 
evasion  techniques.  This  provides another  way to test and 
evaluate  the  detection  accuracy  of  IDS  in  the  case  of 
successful  and  failed  attack  attempts.  The  results  that  are 
classified as true negative in the case of Bro are related to 
enhancements provided by Bro over the Snort rules. In this 
case,  when  the  mutated  attack  failed  it  is  able,  in  some 
situations, 
is  
Quiet/Partially  Alarmist  for  this  data  set.  The  packet 
fragmentation  problem  seems  to  be  properly  handled  by 
both  IDS  even  in  the  case  of  the  newer  (frag-7-unix)  and 
older 
[42]. 
However,  for  both  IDS  even  when  fragments  are 
overlapping and the attack only affects a Windows system 
that favors older fragments over newer fragments, the IDS 
still raise an alarm. The IDS are able to properly detect the 
attack  but  are  not  able  to  know  the  technique  used  to 
reassemble  the fragments by the  targeted  systems. Even if 
the  IDS  are  able  to  properly  decode  the  modifications 
made  by  the  IDS  evasion  techniques,  many  of  the  results 
provided  by  Snort  and  Bro  are  again 
the 
Alarmist/Partially Alarmist group for this set. 