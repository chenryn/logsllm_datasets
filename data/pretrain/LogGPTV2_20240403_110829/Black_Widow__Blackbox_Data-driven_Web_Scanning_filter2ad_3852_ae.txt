C
t
o
H
P
R
C
t
o
H
l
a
p
u
r
D
s
s
e
r
P
d
r
o
W
o
k
c
i
P
o
k
c
a
W
Figure 2. Each bar compares our scanner to one other scanner on a web application. The bars show three fractions: unique lines we ﬁnd, lines both ﬁnd
and lines uniquely found by the other scanner.
of unique lines of code that were executed on the server.
Black Widow has the highest coverage on 9 out of the 10
web applications.
Using Wget as a baseline Table I illustrates that Black
Widow increases the coverage by almost 500% in SCARF.
Similarly with modern production software, like PrestaShop,
we can see an increase of 256% in coverage compared
to Wget. Even when comparing to state-of-the-art crawlers
like j ¨Ak and Enemy of the State we have more than 100%
increase on SCARF and 320% on modern applications like
PrestaShop. There is, however, a case where Enemy of
the State has the highest coverage on Drupal. This case is
discussed in more detail in Section V-A.
While it would be beneﬁcial to know how far we are
from perfect coverage, we avoid calculating a ground truth
on the total number of lines of code for the applications as
it is difﬁcult to do in a meaningful way. Simply aggregating
the number of lines in the source code will misrepresent
dynamic code, e.g. eval, and count dead code, e.g. instal-
lation code.
We also compare Black Widow to the combined efforts
of the other scanners to better understand how we improve
the state-of-the-art. Table II has three columns containing the
number of lines of code that Black Widow ﬁnds which none
of the others ﬁnd, the combined coverage of the others and
ﬁnally our improvement in coverage. In large applications,
like PrestaShop, Black Widow was able to ﬁnd 53 266
lines of code that none of the others found. For smaller
applications, like phpBB, we see an improvement of up to
46.7% compared to the current state-of-the-art.
To get a better understanding of which parts of the
UNIQUE LINES OUR SCANNER FINDS (A \ U ) COMPARED TO THE UNION
Table II
OF ALL OTHER SCANNERS (U ).
Application
Drupal
HotCRP
Joomla
osCommerce
phpBB
PrestaShop
SCARF
Vanilla
WackoPicko
WordPress
Our scanner
A \ U
4 378
1 597
5 134
2 624
2 743
95 139
176
2 626
50
3 591
Other scanners
U
80 213
18 326
42 443
9 216
5 877
153 452
464
14 234
742
58 131
Improvement
|A \ U|/|U|
+5.5%
+8.7%
+12.1%
+28.5%
+46.7%
+62.0%
+37.9%
+18.4%
+6.7%
+6.2%
application the scanners are exploring, we further compare
the overlap in the lines of code between the scanners.
the number of unique lines of
In Table III we present
Table III
COMPARISON OF UNIQUE LINES OF CODE FOUND BY OUR SCANNER
(A \ B) AND THE OTHER SCANNERS (B \ A). IMPROVEMENT IS NEW
LINES FOUND BY OUR SCANNER DIVIDED BY THE OTHER’S TOTAL.
Crawler
Arachni
Enemy
j ¨Ak
Skipﬁsh
w3af
Wget
ZAP
Our scanner
A \ B
179 477
267 372
242 066
239 064
249 881
289 698
226 088
Other scanners
B \ A
71 489
25 268
9 216
8 206
7 328
1 405
5 560
Other’s total
B
283 664
149 548
158 802
160 794
149 099
103 359
171 124
Improvement
|A \ B|/|B|
+63.3%
+178.8%
+152.4%
+148.7%
+167.6%
+280.3%
+132.1%
Authorized licensed use limited to: Tsinghua University. Downloaded on February 25,2022 at 12:14:17 UTC from IEEE Xplore.  Restrictions apply. 
1133
code Black Widow ﬁnd compared to another crawler. The
improvement is calculated as the number of unique lines we
ﬁnd divided by the total number of lines the other crawlers
ﬁnd.
We plot the comparison for all scanners on all platforms
in Figure 2. In this ﬁgure, each bar represents the fraction
of lines of code attributed to each crawler. At the bottom is
the fraction found only by the other crawlers, in the middle
the lines found by both and on top are the results found
by Black Widow. The bars are sorted by the difference of
unique lines found by Black Widow and the other crawlers.
Black Widow ﬁnds the highest number of unique lines of
code in all cases except the rightmost, in which Enemy of
the State performed better on Drupal. The exact number can
be found in Table I.
NUMBER OF REPORTED XSS INJECTIONS BY THE SCANNERS AND THE
CLASSIFICATION OF THE INJECTION AS EITHER REFLECTED OR STORED.
Table IV
Crawler
Type
Drupal
HotCRP
Joomla
osCommerce
phpBB
PrestaShop
SCARF
Vanilla
WackoPicko
WordPress
Arachni
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
31
-
2
3
1
-
-
Enemy
S
R
-
-
-
-
-
8
-
-
-
-
-
-
-
-
-
-
2
1
-
-
j ¨Ak
R
-
-
-
-
-
-
-
-
13
-
S
-
-
-
-
-
-
-
-
-
-
Skipﬁsh
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
1
1
-
-
w3af
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
1
-
-
1
-
-
-
Widow
S
R
-
-
1
-
-
-
1
1
32
-
-
2
5
3
2
1
3
2
1
1
ZAP
S
R
-
-
-
-
-
-
-
9
-
-
-
-
-
-
-
-
-
-
-
-
NUMBER OF UNIQUE AND CORRECT XSS INJECTIONS BY THE
Table V
SCANNERS AND THE CLASSIFICATION OF THE INJECTION AS EITHER
REFLECTED OR STORED.
Crawler
Type
Drupal
HotCRP
Joomla
osCommerce
phpBB
PrestaShop
SCARF
Vanilla
WackoPicko
WordPress
Arachni
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
3
-
-
1
3
-
-
Enemy
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
1
2
-
-
j ¨Ak
R
-
-
-
-
-
-
-
-
1
-
S
-
-
-
-
-
-
-
-
-
-
Skipﬁsh
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
1
-
-
w3af
S
R
-
-
-
-
-
-
-
-
-
-
-
-
-
1
-
-
-
1
-
-
Widow
S
R
-
-
-
1
-
-
1
1
3
-
1
-
5
3
2
1
2
3