a
i
r
a
v
e
h
t
o
t
e
c
n
e
r
e
ﬀ
d
i
)
%
(
a
t
a
d
l
o
r
t
n
o
c
f
o
t
e
s
h
c
a
e
100
10
1
0.1
0.01
0.001
Vehicle 
Speed
0-180
[km/h]
Engine 
Speed
0-4000
[rpm]
Steering
angle
±612
[deg]
AP
Variable 
range
RMS of 
estimated 
diﬀerence
Note: Variable ranges are estimates based on traﬃc data.
0-100
[%]
0.18
3.87
0.14
4.16
74.9
E-
Torque
0-140
[Nm]
Accele
ration
±3
[m/s2]
Y-rate
±30
[deg/s]
B-
torque
±210
[Nm]
1e-4
0.76
50.0
Fig. 5.  Estimation accuracy
6-2  Detection performance
The proposed system was evaluated as to its spoofing 
message  detection  performance  along  with  two  types  of 
conventional  systems.  Of  these  two  types,  one  monitored 
message  reception  intervals,  while  the  other  monitored 
time-series  variation  of  the  monitored  control  data.  The 
latter  conventional  system  used  the  previously  received 
normal data to estimate the current value of the monitored 
control data and if the difference between the current value 
and the estimate exceeded the allowable range, determined 
the received message to be a spoofing message.
The evaluation indices used were sensitivity and true 
negative rate*3 expressed by Eqs. 1 and 2, respectively. The 
sensitivity value of 1 indicates that every inserted spoofing 
message was detected. The true negative rate of 1 implies 
that the system recognized every normal message correctly 
and made no error detecting it as a spoofing message. True 
positive and false positive in these equations represent the 
number of correctly identified spoofing messages and the 
number  of  erroneously  identified  spoofing  messages, 
respectively.  Likewise,  true  negative  and  false  negative 
represent  the  number  of  correctly  identified  normal 
messages and the number of erroneously identified normal 
messages, respectively.
                                                            .................  Eq. 1
                                                                          ...  Eq. 2
The  test  used  the  attack  model  illustrated  in  Fig.  6. 
While  vehicle  speed  data  (approx.  60  km/h)  was  sent 
repeatedly,  the  attacker  ECU  sent  spoofing  messages 
repeatedly  by  two  attack  methods  to  tamper  with  the 
vehicle speed to 81 km/h. One attack method was a straight 
attack. The tampered speed of 81 km/h was repeatedly sent, 
as shown in Fig. 7 (a). The other attack method was a jab 
attack. The attacker ECU sent tampered data 14 times, each 
time raising the speed gradually from the normal data of 60 
km/h to the target tampered speed of 81 km/h at 1.5 km/h 
intervals,  followed  by  repeated  transmission  of  tampered 
data of 81 km/h. Figure 8 represents all the speed data used 
for  the  jab  attack, with  the  samples  thinned for  visibility. 
Figure 8 (A) indicates the duration in which the jab attack 
took  place.  The  early  part  of  this  duration  is  enlarged  in 
Fig. 7 (b). All the speed data subjected to the straight attack 
was similar to the jab attack except for the tampered data 
used at the beginning of the attack.
Figure  9  gives  the  evaluation  results.  The  conven-
tional  system  monitoring  the  message  reception  cycles 
Legitimate
ECU
receive
Legitimate
ECU
(transmit
Normal
CAN message
Spooﬁng
CAN message
Inserts spoofing messages 
when normal CAN 
messages are transmitted
Attacker
ECU
Fig. 6.  Attack model
Tempered data
Normal data
Tempered data
Normal data
(a) Straight attack
(b) Jab attack
Note:  The label on the horizontal axis from “T4-1” to “T4-11” in 
above two charts indicates a transmit time of a vehicle speed 
between T4 (s) and T5 (s) in Fig.8.
Fig. 7.  Types of attacks
Tempered data
Normal data
(A)
Note: The label on the horizontal axis from “T1” to “T7” indicates a 
transmit time of a vehicle speed instead of an actual value.
Monitoring 
System
Conventional 
System
receiving 
interval
Fig. 8.  All speed data subjected to jab attack
Fig. 9.  Detection performance
SEI TECHNICAL REVIEW  ·  NUMBER 88  ·  APRIL  2019  ·  79
exhibited a sensitivity value of 1 for both the straight and 
jab attacks. However, its true negative rate was low at 0.7. 
When receiving normal and spoofing messages within the 
allowable  range  of  message  reception  intervals,  this 
conventional  system  failed  to  distinguish  between  these 
messages  and  determined  both  normal  and  spoofing 
messages  to  be  spoofing  messages.  In  the  test,  the  true 
negative  rate  of  this  conventional  system  was  low  in  the 
duration indicated by Fig. 8 (A) in which normal messages 
were received among spoofing messages.
When  subjected  to  straight  attacks,  the  conventional 
system  that  monitored  the  time-series  variation  of  the 
monitored  control  data  exhibited  a  sensitivity  and  true 
negative rate of 1. However, its detection performance was 
substantially  low  against  jab  attacks,  with  its  sensitivity 
and true negative rate decreasing to 0 and 0.5, respectively. 
When the jab attack commenced, which tampered with the 
normal data repeatedly and raised the speed gradually from 
approximately 60 km/h to the target tampered speed of 81 
km/h at 1.5 km/h intervals, estimation of the current speed 
based  on  the  speed  data  previously  determined  to  be 
normal  resulted  in  a  difference  between  the  estimate  and 
the tampered data falling in the allowable range. Therefore, 
received  spoofing  messages  were  all  erroneously  deter-
mined  to  be  normal.  Moreover,  once  the  tampered  speed 
data  reached  81  km/h,  estimation  of  the  current  speed 
based  on  the  tampered  data  previously  determined  to  be 
normal  resulted  in  a  difference  between  the  estimate  and 
the normal data of approximately 60 km/h, exceeding the 
allowable range. Consequently, all normal messages were 
erroneously determined to be spoofing messages. These are 
the causes of the low detection performance.
The  proposed  system  exhibited  higher  detection 
performance than the conventional systems in both types of 
attacks. Subjected to straight attacks, its sensitivity and true 
negative rate were both 1. Against jab attacks, the proposed 
system  exhibited  a  sensitivity  and  true  negative  rate  of 
0.99.  The  miniscule  erroneous  determination  under  jab 
attacks  occurred  once,  immediately  after  the  commence-
ment of the attack. The reason for this was that the value of 
the  tampered  data  inserted  as  a  spoofing  message  was 
below the difference estimated by the vehicle data model. 
Nonetheless,  the  value  of  tampered  data  inserted  as  a 
spoofing message increased gradually at 1.5 km/h intervals 
up to 81 km/h. In the test, the tampered data of the second 
1
0.8
0.6
0.4
0.2
0
Attack
Sensitivity
True negative rate
Straight
Conventional
System
time-series
Jab
Proposed 
system
Conventional 
system
receiving 
interval
Conventional 
system
time-series
Proposed 
system
Technical Terms
 Correlation  analysis:  The  correlation  between  two 
variables (x, y) is determined by the formula of Pearson’s 
product-moment  correlation  coefficient  expressed  by  
Eq. 3. In this equation, γ is a cross-correlation coefficient, 
x is the value of monitored control data, y is the value of 
other  control  data;  μx  and  μy  are  mean  values  of  the 
monitored  control  data  and  the  other  data,  respectively, 
and n is the sample size. The cross-correlation coefficient 
varies within a range between 0 and ±1.0. The correlation 
between two variables is stronger when their values are 
closer to 1.0 or −1.0. There is a cross-correlation between 
two variables when the values are either 0.4 or greater or 
−0.4 or smaller.
                                               ..............................  Eq. 3
＊2 
＊3 
 Regression model: A relational expression between a 
target variable and explanatory variable calculated by 
a  statistical  method.  In  this  report,  the  monitored 
control  data  is  the  target  variable  and  other  control 
data correlated with the monitored control data is the 
explanatory variable.
 True negative rate: An evaluation index for detection 
performance.  The  true  negative  rate  indicates  how 
much normal messages have been correctly identified. 
The ideal value for the true negative rate is 1.
(1) 
(2) 
(3) 
(4) 
(5) 
(6) 
(7) 
(8) 
(9) 
References
 Miller,  C.,  and  Valasek,  C.,  “Remote  Exploitation  of  an  Unaltered 
Passenger Vehicle,” presented at DEF CON 23, August 2015.
 International  Organization  for  Standardization,  “Road  vehicles- 
Controller area network (CAN) - Part 1: Data link layer and physical 
signaling,” ISO11898-1, Rev. 2003.
 International  Organization  for  Standardization,  “Road  vehicles- 
Controller area network (CAN) - Part 1: Data link layer and physical 
signaling,” ISO11898-1, Rev. 2015.
 Koscher,  K.,  Czeskis, A.,  Roesner,  F.,  Patel,  S.  et  al.,  “Experimental 
Security Analysis  of  a  Modern Automobile,”  2010  IEEE  Symposium 
on Security and Privacy, 2010.
 Hamada, Y., Inoue, M, Ueda, H., Miyashita, Y, et. al., “Anomaly-Based 
Intrusion Detection Using the Density Estimation of Reception Cycle 
Periods  for  In-Vehicle  Networks,”  SAE  International  Journal  of 
Transportation Cybersecurity and Privacy, Vol1, 2018.
 Müter,  M.,  and  Asaj,  N.,  “Entropy-Based  Anomaly  Detection  for 
In-Vehicle Networks,” 2011 IEEE Intelligent Vehicle Symposium (IV), 
2011.
 Hamada, Y., Inoue, M., Tateishi, H., Adachi, N., et. al., “Virtual Sensing 
Anomaly  Detection  for  In-Vehicle  Network,”  2018  Symposium  on 
Cryptography and Information Security, January, 2018.
 Tibshirani,  R.,  “Regression  shrinkage  and  selection  via  the  lasso,” 
Journal of the Royal Statistical Society. Series B (Methodological), pp. 
267–288, 1996.
 Breiman, L., Friedman, J., Stone, C.J., and Olshen, R.A., “Classification 
and  Regression  Trees,”  Boca  Raton:  Chapman  and  Hall/CRC, 
Monterey, CA, 1984.
and following spoofing messages exceeded the difference 
estimated  by  the  vehicle  data  model.  Consequently,  these 
were  all  detected  as  spoofing  messages.  The  proposed 
system monitors the target control data indirectly, based on 
groups of correlated control data via a vehicle data model. 
Therefore,  in  the  test,  it  proved  itself  to  be  capable  of 
detecting even jab attacks as well as straight attacks.
＊1 
7. Conclusion
An anomaly-based IDS CDEC for in-vehicle networks 
was  proposed.  The  proposed  system  monitors  sensor-based 
control  data  by  comparison  of  estimates  produced  via  a 
vehicle data model based on groups of correlated control data.
In  a  test,  the  proposed  system  was  applied  to  eight 
types  of  sensor-based  control  data  that  represented  the  
vehicle’s driving characteristics. It proved itself to be capable 
of learning traffic data in every aspect for the vehicle data 
model. Accuracy estimates of the vehicle data model were 
below 3% for seven types of data. Furthermore, the proposed 
system was compared with two types of conventional systems 
as  to  their  capability  of  detecting  spoofing  messages.  The 
results showed that the detection performance of the proposed 
system  was  the  highest  and  the  proposed  system  detected 
inserted spoofing messages, distinguishing them from normal 
messages.
Using  the  proposed  system,  it  is  possible  to  identify 
spoofing messages inserted in an in-vehicle network by a 
cyber  attacker.  Consequently,  the  proposed  system  facili-
tates identification of the attacked subject, thereby reducing 
the time taken before implementing concrete countermea-
sures  and  delimiting  the  scope  of  the  countermeasures. 
Using  the  proposed  system  and  the  conventional  systems 
used  in  the  comparison,  the  IDS  being  developed  by 
Sumitomo  Electric  configures  three  monitoring  levels  for 
in-vehicle  networks  to  detect  unknown  cyberattacks  on 
long-product-life vehicles in an on-board environment.
80  ·  Intrusion Detection System for In-Vehicle Networks
Contributors  The lead author is indicated by an asterisk (*).
Y. HAMADA*
•   Assistant General Manager, Cyber-security R&D 
Office
M. INOUE
•   Assistant Senior Manager, AutoNetworks 
Technologies, Ltd.
N. ADACHI
•   AutoNetworks Technologies, Ltd.
H. UEDA
•   Manager, AutoNetworks Technologies, Ltd.
Y. MIYASHITA
•   Senior Manager, AutoNetworks Technologies, Ltd.
Y. HATA
•   General Manager, Cyber-security R&D Office
SEI TECHNICAL REVIEW  ·  NUMBER 88  ·  APRIL  2019  ·  81