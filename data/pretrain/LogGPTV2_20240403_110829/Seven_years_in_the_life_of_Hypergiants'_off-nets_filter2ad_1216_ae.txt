provider. To estimate this, we need to assign to each AS that hosts
at least one of the top-4 HGs its market share in the country where
it operates. For this, we use the APNIC dataset [65] that has been
used in past studies [46, 60] to characterize ASes based on their
Internet user population market share.
APNIC conducts measurement campaigns [66] and publishes
the related results on a daily basis. These datasets can be used to
estimate the Internet user population percentages per AS, both IPv4
and IPv6, at a country level. We download daily snapshots and we
keep only the ASes that have been present in the dataset for at
least 25% of each month (one week) to avoid mis-inferences. This
filtering reduces the total number of ASes in the dataset from 26k to
almost 9k, reducing the coverage of the ASes present in our study
to less than 80%. However, by applying such filters we choose to err
on the side of accuracy, considering our results as lower bounds of
user population percentages. We store monthly snapshots of these
data since October 2017.
To estimate the Internet user population coverage that has access
to HG servers hosted in its network provider, we add the market
share of all the ASes that host HGs and operate in the country
and we assign it as a percentage for this country. Figure 7 plots
the Internet user percentage per country that has access to off-net
HG servers for Google, Netflix, and Akamai in April 2021 using
the Rapid7 dataset. For these top HGs, the Internet user coverage
per country has not changed dramatically from 2017 to 2021. A
closer investigation shows that, in all three cases, the HGs were
already hosted by large eyeball networks and by other network
providers with high market share in 2017. These observations are
inline with our analysis in Section 6.3 regarding the demographics
of off-net footprint growth. Although the number of ASes that host
(a) Asia
(b) Europe
(c) South America
(d) North America
(e) Africa
(f) Oceania
Figure 6: Growth of top-4 HGs per continent over time.
or as a separate region, depending on the source. For these cases,
we manually investigate the geographical origin of prefixes, e.g., by
utilizing BGP geo-tagged communities [47]. In Figure 6 we plot the
growth per continent for the top-4 HGs. In Figures 6a, 6b, and 6c,
we present the regions with the highest growth, Asia, Europe, and
South America. In 2013, Google had already established a substantial
off-net footprint [22], so its growth is linear in both Europe and Asia.
Nevertheless, it expands its footprint by 400-600 ASes in each region
between 2013 and 2021. Netflix’s off-net footprint growth aligns well
with the offer of Netflix streaming services in the various regions.
Facebook has an aggressive expansion in all regions since the launch
of it’s CDN. Akamai seems to increase its off-net foorprint in all
three regions at similar paces between 2013-2017, before contracting
somewhat starting around 2018.
What is really striking is the exponential growth of Google,
Netflix, and Facebook in South America. These HGs expand their
off-net footprints in more than 800 (and in the case of Google 1,200)
ASes from 2013 to 2021. The growth of the other HGs is slower,
524
2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0401002003004005006007008009001000Total number of ASesGoogleAkamaiNetflixFacebookAlibaba2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0401002003004005006007008009002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-040200400600800100012001400Total number of ASes2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-0401002003004005002013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-04020406080100120140160180200220Total number of ASes2013-102014-042014-102015-042015-102016-042016-102017-042017-102018-042018-102019-042019-102020-042020-102021-04010203040506070SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
P. Gigis et al.
(a) Google
(c) Akamai
Figure 7: Percentage of a country’s Internet users in ASes hosting off-net servers of a HG (April 2021).
(b) Netflix
Figure 8: Percentage of a country’s Internet
users within the customer cones of ASes host-
ing Google off-net servers (April 2021).
(a)
(b)
Figure 9: Percentage of a country’s Internet users in ASes hosting Facebook’s off-net servers,
10/2017 vs. 04/2021.
Akamai declines, its Internet population coverage does not seem to
be affected, as Akamai is still present in networks with large end
user population. The top HGs’ Internet population coverage varies
across regions. For example, Google has strong presence in Africa,
and Akamai has high Internet population coverage in Asia. We also
verified that the number of countries in which Google claims to
have edge caches [52] agrees with our results.
A HG can potentially serve even more of the Internet population
by using an off-net to serve not just the users within the AS hosting
an off-net but also the users within the customer cone of the AS.
Previous studies show that this is the case for Google [22, 28]. In
Figure 8 we plot the potential Internet user coverage of Google’s off-
net footprint, if customer cone users are served by Google servers
hosted by their providers. In this case, Google covers more than
50% of the user population in 201 countries, as worldwide coverage
increase from 57.8% to 68.2%. User coverage in Europe increases
from 58.8% to 77.5%, i.e., an increase of 31.8%, and North America
increases by 43.9%, from 49% to 70.6%. Countries with the highest
increase are Turkey (from 39.1% to 99%), Colombia (from 48.9% to
98.2%) and Russia (from 54.7% to 94.7%). For Facebook, Netflix and
Akamai refer to Appendix A.6.
The Internet population coverage of Facebook’s off-net footprint
increased significantly between 2017-2021. Figure 9 plots its cover-
age per country in Oct. 2017 and in Apr. 2021. Facebook’s off-net
footprint has expanded aggressively to large, medium and small
ASes around the globe. As we discussed in Section 6.4, Facebook’s
footprint growth in absolute number of ASes was especially appar-
ent in South America, Asia, and Africa. Smaller increases are also
visible in Europe and Asia.
Due to the varying landscape of the telecommunications sector
across the world, the growth of Facebook’s off-net footprint in
various regions yields different increases in the percent of users
that can be served. For example, in Africa an increase of the off-net
footprint by about 99 ASes yields an increase of more than 115%
in user population coverage, from 34.7% to 74.8%. In Europe the
increase of the off-net footprint of 206 ASes yields an increase of
user population coverage of 136%, from 16.9% to 39.8%. In contrast,
in South America, the increase in user coverage was only 32% (from
51.6% to 68%), although the increase of the Facebook’s off-net foot-
print was more than 739 ASes. Facebook has also announced that
it had plans to expand in Africa and other developing regions [92].
Our results show that, indeed, there is a significant expansion of
Facebook there. The increased coverage by Facebook is also related
to the expansion strategy of its CDN in the last two years, discussed
in Section 6.4.
Our results show that some regions remain under-covered, al-
though the specifics vary across HGs. The reasons may vary, includ-
ing politics and business, and we prefer not to speculate on the root
causes. However, our analysis can provide insights on the potential
increase of user population coverage. For example, Facebook could
significantly increase coverage in the US from 33.9% to 61.8%, by de-
ploying off-net servers in only following 5 ASes (AS7018, AS21928,
AS20115, AS20057, and AS22394).
6.6 Network Providers’ Hosting Strategies
We next turn our attention to the network providers’ strategies for
hosting HGs. Our results show that, in terms of which networks
host HG off-nets, the footprints of HGs overlap, especially those
of the four largest HGs. We also demonstrate that a network that
already hosts one large HG is likely to later host more.
For all ASes that are part of at least one of the four largest off-net
footprints, those of Google, Netflix, Facebook, and Akamai, Fig-
ure 10b plots the distribution (across time) of the number of those
four HGs that they hosted. The number of such ASes has almost
tripled between 2013 and 2020. A striking observation is that the
majority of the ASes that host HGs (more than 97%, see percentages
in the plot), host at least one of the top-4 HGs. Thus, there is only a
tiny percentage of ASes that host only HGs outside the top-4. The
525
020406080100020406080100020406080100020406080100020406080100020406080100Seven Years in the Life of Hypergiants’ Off-Nets
SIGCOMM ’21, August 23–27, 2021, Virtual Event, USA
servers in different networks, it appears like CloudFlare has off-nets
there. To mitigate this issue, we have to manually identify and re-
move these certificates in our study. We noticed that CloudFlare in-
cludes an additional entry in the TLS dNSNames field of their free cus-
tomer certificates (matching (ssl|sni)[0-9]*.cloudflaressl.com),
enabling us to filter on it. Although this process filters out the vast
majority of Cloudflare customer certificates, additional manual
investigation is required, as CloudFlare offers a paid service for
dedicated certificates, and it also allows enterprise and business
Tier customers to upload their own custom TLS certificates.
Anycast. In the case of IP anycast, the same IP address (belonging to
the HG AS) is used to serve content from all sites. From discussions
with two operators, we learned that their anycast deployments
include off-nets, which additionally use the BGP no-export com-
munity to keep the announcement local. The use of this same IP
address will make all sites appear to belong to the HG’s AS. How-
ever, we learned it is common also assign each off-net a unicast
IP address belonging to the hosting AS, to help with debugging.
While these IP addresses are generally not given out by the HG’s
authoritative DNS to serve production traffic, they do respond in
the same way as the production anycast IP. Our approach will dis-
cover these unicast IP addresses correctly, but there is no guarantee
that operators will configure their networks in this way.
Reverse Proxies and Cache Misses. There are instances in our
HTTP(S) scans dataset where the edge site terminating the client’s
TCP connection belongs to a third-party HG but the request gets
forwarded to a backend server in a different HG. This forwarding
behavior is usually the result of a CDN cache miss going to the
origin or split TCP [27, 83] to an application server. In these cases,
the response received by the client will include both the origin HG
and edge HG headers. This can confuse our inference confirmation
with headers, but in practice we observe this only in 4% of mea-
surements. Of these, 99% are Akamai (64%) and Cloudflare (35%)
edges with origins primarily deployed in Amazon S3. This insight
allows us to prioritize third-party CDN headers, like Akamai and
Cloudflare, as the edge site in the presence of a conflict.
Missing Headers. Some networks, such as Netflix and Hulu, only
include debug or headers when serving logged-in users. These are
missing from our input datasets and prevent us from performing
header confirmation for these HGs.
In-Rotation Servers. Because our datasets “skip” the DNS control-
plane of HG content delivery, we cannot currently distinguish if a
particular IP address is actively in-use by the HG for serving content.
A given IP may be drained [9] but responsive or may belong to a
testing environment that always responds when queried.
8 DISCUSSION
An Increasingly Private Internet. Our study shows that many
HGs have already installed substantial serving infrastructure deep
inside networks, especially eyeball networks. This can be a blessing
if these installations can improve end user performance. For exam-
ple, it has been reported that round trip times between end-users
and these servers can be even less than a millisecond [86, 104]. Such
low delays are a step towards addressing the future requirements
and a way for Hypergiants like Google and Facebook to play an
(a)
(b)
Figure 10: # ASes that host at least one top-4 HGs (Google, Netflix,
Facebook, Akamai) in (a) every snapshot and (b) more than one
snapshot.
top-4 HGs have increasingly similar footprints, being present in
the same networks. In 2020, more than 70% of ASes that host an
off-net host 2-4 top-4 HGs, compared to less than 30% of these ASes
in 2013.
We also investigate if networks that have already hosted top-4
HGs are willing to host more. We focus on networks that throughout
2013-2021 hosted at least one top-4 HGs. In total, there are 1,002
such networks. In Figure 10a we plot the distribution of top-4 HGs
these networks host. In 2013, there were only 450 ASes that hosted
2 or more top-4 HGs. In 2021, this number increased to more than
800. Moreover, although none of these networks hosted all top-4
HGs in 2013, more than 250 of them host all top-4 HGs in 2021. We
provide additional results for networks that start hosting HGs later
than 2013 in Appendix A.8, but the conclusions are consistent with
these observations. We conclude that networks that host top-4 HGs
are, typically, willing to host more as time passes.
7 LIMITATIONS
SNI. The main dataset (Rapid7) that we use for our longitudinal
study reports only the default certificate of an IP address running on
port 443 using the HTTPS protocol. A server may host multiple sites
on the same IP, but it reports only the default certificate if no SNI
value is present in client requests. This practice is widely adopted
and used by HGs to provide service to their customers [42, 80].
Certificates in IPv6 addresses. The corpuses of available certifi-
cate datasets are for the IPv4 address space, but there are a very
small number of IPv6-only mobile operators for which our approach
will not work. We plan to investigate this as part of future work.
While our inference approach is IP protocol-agnostic, we lack IPv6
data to conduct longitudinal analysis, and achieving broad coverage
in scans of the enormous IPv6 space brings new challenges.
HGs’ Operational Practices. Although our methodology is generic,
there are some unusual operational practices by some HGs that com-
plicate our approach. For example, CloudFlare offers a proxy service
in front of customers and issues a certificate that enables secure com-
munication between the customer server and CloudFlare’s middle-
ware [75]. When these certificates are hosted by customers’ backend
526