have to simulate the game where gx of the initiator and
gy of the responder are replaced with the challenges from
the DDH game. Now, the simulator might have to calculate
hy (for some group element h) and derive keys from it,
if the responder received h in its ﬁrst message. This is
impossible with just the DDH assumption as the simulator
neither knows y nor has an oracle to compute hy, i.e., he
cannot simulate the game faithfully.
To ﬁx this problem both in the original paper and in
our setting, one can use stronger assumptions. For example,
one could use the PRF-ODH assumption [5], [6], where the
adversary additionally gets access to an oracle for calculating
keys derived from hy (where y is one of the secret exponents
and h is provided by the adversary). As mentioned earlier,
we leave a formulation of Fcrypto based on the PRF-ODH
assumption for future work. An alternative ﬁx for this
problem (again for both settings) is to have gx signed as
well, i.e., signing (gx, gy) as in the SIGMA protocol. This
895
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:26:54 UTC from IEEE Xplore.  Restrictions apply. 
allows for an analysis using the DDH assumption, as now
the signature guarantees that the responder paired gy with
gx only. The following theorem states that this variant is a
secure universally composable unilaterally authenticated key
exchange.
Theorem 5. Let MI and MR be machines modeling the
variant of the 1-RTT non-static mode of OPTLS that signs
both gx and gy. Let Fcrypto and F(cid:2)
crypto be two versions of the
ideal crypto functionality with the same parameters, and let
F UA
key-use be the ideal functionality for unilaterally authenti-
cated key exchanges with parameter tkey = unauthenc-key.
Then the following holds true:
MI | MR |Fcrypto ≤R F MA
key-use |F(cid:2)
crypto.
The proof of this theorem can be found in our technical
report [24]. Again,
it does not need any reductions or
probabilistic reasoning. As before, we can again replace
Fcrypto by its realization Pcrypto.
let Fcrypto,
Corollary 3. Let MI,MR as deﬁned above,
Pcrypto, and F∗ as in Theorem 2, in particular, we have
that Pcrypto ≤R Fcrypto and F∗ enforces well-behaved envi-
ronments. Then the following holds true:
F∗ | MI | MR |Pcrypto ≤R F∗ |F MA
key-use |Fcrypto.
VII. DISCUSSION AND RELATED WORK
There are several different approaches
for analyz-
ing security protocols, mainly symbolic, game-based,
implementation-based, and universal composability ap-
proaches. All of these approaches have different advantages
and shortcomings; there is no silver bullet, as can be seen,
for example, by the fact that real-world protocols, such as
TLS, have been studied in the literature using all of these
approaches (often computer-aided), taking different views
and making use of the speciﬁc merits thereof (see, e.g., [1]–
[9]).
- Symbolic (Dolev-Yao-style) approaches abstract from low
level cryptographic details in order to offer a very high
degree of automation (see, e.g., [33]–[35]).
- Implementation-based analysis captures details of the
actual implementations of protocols, which is very desir-
able, but of course also makes the analysis more involved
(see, e.g., [36]–[39]).
- Game-based models are very expressive and ﬂexible in
deﬁning security properties of a protocol (see, e.g., [40]–
[42] and [43], [44] for tools). While they do not enjoy
built in modularity, efforts have been made to improve
the modularity provided by these models (see, e.g., [13],
[14]).
- Universal composability approaches come with modular-
ity built in and allow one to show that protocols are secure
in arbitrary (polynomially bounded) environments (see,
e.g. [15]–[18]). But due to the commitment problem, they
can be more limited in their corruption modeling. In some
cases, instead of allowing for full adaptive corruption,
one might have to model corruption in a more restricted,
but still reasonable way (see also the discussions in
Sections V and VI).
Our framework adds the feature of avoiding or limiting
the need for tedious and error-prone reductions, while at
the same time allowing to establish universally composable
security guarantees. In particular, proofs are simpliﬁed and
results can easily be re-used and built upon.
In the remainder of this section, we discuss closely
related work in more detail. The works [11], [19] have been
discussed in detail before already.
In [45], Canetti and Gajek abstract Difﬁe-Hellman key
exchange via an ideal key encapsulation functionality. There
are two key differences to our framework. First, unlike
Fcrypto and our key usability functionalities, the ideal key
encapsulation functionality does not allow a user/higher-
level protocol to use the exchanged key in an idealized way
or to use it with other primitives, which entails reductions
proofs. Second, a large class of protocols cannot be analyzed
with their key encapsulation functionality: in order to prove
the realization, they impose a very strong restriction on the
environment/higher-level protocols, namely, an initiator may
use her secret exponent a only with DH shares gb that have
been honestly generated by a responder. Many protocols, in-
cluding all case studies considered in this paper, do not fulﬁll
this requirement: If, for example, the responder is corrupted,
then the environment may sign arbitrary DH shares that were
not honestly generated. These DH shares will be accepted
by the initiator, which violates the requirement.
Our case studies have not yet been faithfully analyzed
in a universal composability setting (see [23], [41], [46]
for game-based analyses). Variants of the ISO 9798-3 and
SIGMA protocols have been analyzed in the UC model in
[30], [45], [46]. These variants assume that protocol partic-
ipants have already established a global, unique SID prior
to running the actual protocol, and then either use different
signing keys for every new session (which is unrealistic) or,
if they re-use the same key across different sessions, preﬁx
all signed messages with the SID. The latter is a so-called
joint-state realization, which, however, results in a protocol
that differs from the actual protocol. As illustrated in [11],
such modiﬁcations can potentially create a secure protocol
from an insecure one.
Moreover, the analysis of the (variant of the) SIGMA
protocol in [46] needed a modiﬁed version of the ideal
key exchange functionality Fke where initiators and respon-
ders cannot specify their intended peers. Our functionality
F MA
key-use is the ﬁrst that allows for proving security of the
SIGMA protocol in a setting where the initiator and the
responder can specify their intended peers.
896
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:26:54 UTC from IEEE Xplore.  Restrictions apply. 
VIII. CONCLUSION
In this paper, we have proposed an ideal functionality
Fcrypto that models various cryptographic primitives which
can be combined with each other and can be used in an
idealized way. Importantly, Fcrypto supports Difﬁe-Hellman
key exchange, a widely and extensively used primitive in
real-world protocols. We also provided new functionalities,
key-use and F UA
F MA
key-use, for ideal mutual and unilateral authen-
ticated key exchange which lift the properties of Fcrypto to
the next protocol level. Notably, these functionalities allow
for analyzing a wider range of key exchange protocols than
traditional formulations of ideal key exchange functionali-
ties.
Altogether, our approach gets rid of reductions and hy-
brid arguments for primitives that are supported by Fcrypto.
Instead, proofs rely on simpler information theoretic argu-
ments only, which facilitates proofs and makes it easier to
uncover subtle problems that otherwise might get lost in
sequences of reductions. At the same time, our approach
offers very high modularity and strong universal composable
security guarantees.
We have illustrated the usefulness of our framework in
three case studies. In the case of OPTLS, we uncovered a
subtle problem in the original reduction due to the simplicity
of Fcrypto, which makes very explicit in which cases security
can be guaranteed.
In future work, we will apply our framework to other
real world protocols and extend the framework to further
facilitate their cryptographic analysis.
IX. ACKNOWLEDGMENT
his project was in part funded by the Deutsche Forschungs-
gemeinschaft (DFG) through Grant KU 1434/9-1.
REFERENCES
[1] C. Cremers, M. Horvat, S. Scott, and T. van der Merwe,
“Automated Analysis and Veriﬁcation of TLS 1.3: 0-RTT, Re-
sumption and Delayed Authentication,” in IEEE Symposium
on Security and Privacy, SP 2016, San Jose, CA, USA, May
22-26, 2016.
IEEE Computer Society, 2016, pp. 470–485.
[2] B. Beurdouche, K. Bhargavan, A. Delignat-Lavaud, C. Four-
net, M. Kohlweiss, A. Pironti, P. Strub, and J. K. Zinzindo-
houe, “A Messy State of the Union: Taming the Composite
State Machines of TLS,” in 2015 IEEE Symposium on Secu-
rity and Privacy, SP 2015, San Jose, CA, USA, May 17-21,
2015.
IEEE Computer Society, 2015, pp. 535–552.
[3] K. Bhargavan, C. Fournet, M. Kohlweiss, A. Pironti, P. Strub,
and S. Z. B´eguelin, “Proving the TLS Handshake Secure (As
It Is),” in Advances in Cryptology - CRYPTO 2014 - 34th
Annual Cryptology Conference, Santa Barbara, CA, USA,
August 17-21, 2014, Proceedings, Part II, ser. Lecture Notes
in Computer Science, vol. 8617.
Springer, 2014, pp. 235–
255.
[4] K. Bhargavan, C. Fournet, M. Kohlweiss, A. Pironti, and P.-
Y. Strub, “Implementing TLS with Veriﬁed Cryptographic
Security,” in IEEE Symposium on Security and Privacy (S&P
2013).
IEEE Computer Society, 2013.
[5] H. Krawczyk, K. G. Paterson, and H. Wee, “On the Security
of the TLS Protocol: A Systematic Analysis,” in Advances
in Cryptology - CRYPTO 2013 - 33rd Annual Cryptology
Conference, Proceedings, ser. Lecture Notes in Computer
Science, vol. 8042. Springer, 2013, pp. 429–448.
[6] T. Jager, F. Kohlar, S. Sch¨age, and J. Schwenk, “On the
Security of TLS-DHE in the Standard Model,” in Advances
in Cryptology - CRYPTO 2012 - 32nd Annual Cryptology
Conference, Proceedings, ser. Lecture Notems in Computer
Science, R. Safavi-Naini and R. Canetti, Eds., vol. 7417.
Springer, 2012, pp. 273–293.
[7] B. Dowling, M. Fischlin, F. G¨unther, and D. Stebila, “A
Cryptographic Analysis of the TLS 1.3 Handshake Protocol
Candidates,” in Proceedings of the 22nd ACM SIGSAC Con-
ference on Computer and Communications Security, Denver,
CO, USA, October 12-6, 2015. ACM, 2015, pp. 1197–1210.
[8] C. Badertscher, C. Matt, U. Maurer, P. Rogaway, and B. Tack-
mann, “Augmented Secure Channels and the Goal of the TLS
1.3 Record Layer,” in Provable Security - 9th International
Conference, ProvSec 2015, Kanazawa, Japan, November 24-
26, 2015, Proceedings, ser. Lecture Notes in Computer Sci-
ence, vol. 9451. Springer, 2015, pp. 85–104.
[9] M. Kohlweiss, U. Maurer, C. Onete, B. Tackmann, and
D. Venturi, “(De-)Constructing TLS 1.3,” in Progress in Cryp-
tology - INDOCRYPT 2015 - 16th International Conference
on Cryptology in India, Bangalore, India, December 6-9,
2015, Proceedings, ser. Lecture Notes in Computer Science,
vol. 9462. Springer, 2015, pp. 85–102.
[10] S. C. Williams, “Analysis of the SSH Key Exchange Proto-
col,” in 13th IMA International Conference of Cryptography
and Coding (IMACC 2011), ser. Lecture Notes in Computer
Science, L. Chen, Ed., vol. 7089. Springer, 2011, pp. 356–
374.
[11] R. K¨usters and M. Tuengerthal, “Composition Theorems
Without Pre-Established Session Identiﬁers,” in Proceedings
of
the 18th ACM Conference on Computer and Commu-
nications Security (CCS 2011), Y. Chen, G. Danezis, and
V. Shmatikov, Eds. ACM, 2011, pp. 41–50.
[12] K. Cohn-Gordon, C. Cremers, B. Dowling, L. Garratt, and
D. Stebila, “A Formal Security Analysis of the Signal Mes-
saging Protocol,” IACR Cryptology ePrint Archive, vol. 2016,
p. 1013, 2016.
[13] C. Brzuska, M. Fischlin, N. P. Smart, B. Warinschi, and S. C.
Williams, “Less is more: relaxed yet composable security
notions for key exchange,” Int. J. Inf. Sec., vol. 12, no. 4,
pp. 267–297, 2013.
[14] C. Brzuska, M. Fischlin, B. Warinschi, and S. C. Williams,
“Composability of Bellare-Rogaway Key Exchange Protocol,”
in Proceedings of the 18th ACM Conference on Computer
and Communications Security (CCS 2011). ACM, 2011, pp.
51–62.
897
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:26:54 UTC from IEEE Xplore.  Restrictions apply. 
[15] R. Canetti, “Universally Composable Security: A New
Paradigm for Cryptographic Protocols,” in Proceedings of the
42nd Annual Symposium on Foundations of Computer Science
(FOCS 2001).
IEEE Computer Society, 2001, pp. 136–145.
[16] R. K¨usters, “Simulation-Based Security with Inexhaustible
Interactive Turing Machines,” in Proceedings of
the 19th
IEEE Computer Security Foundations Workshop (CSFW-19
2006).
IEEE Computer Society, 2006, pp. 309–320, see
http://eprint.iacr.org/2013/025/ for a full and revised version.
[17] D. Hofheinz and V. Shoup, “GNUC: A New Universal
Composability Framework,” J. Cryptology, vol. 28, no. 3, pp.
423–508, 2015.
[18] U. Maurer, “Constructive Cryptography - A New Paradigm
for Security Deﬁnitions and Proofs,” in Theory of Security and
Applications - Joint Workshop, TOSCA 2011, Saarbr¨ucken,
Germany, March 31 - April 1, 2011, Revised Selected Papers,
ser. Lecture Notes in Computer Science, vol. 6993. Springer,
2011, pp. 33–56.
[19] R. K¨usters and M. Tuengerthal, “Ideal Key Derivation and
Encryption in Simulation-based Security,” in Topics in Cryp-
tology – CT-RSA 2011, The Cryptographers’ Track at the
RSA Conference 2011, Proceedings, ser. Lecture Notes in
Computer Science, A. Kiayias, Ed., vol. 6558.
Springer,
2011, pp. 161–179.
[20] J. Camenisch, R. R. Enderlein, S. Krenn, R. K¨usters, and
D. Rausch, “Universal Composition with Responsive Envi-
ronments,” in Advances in Cryptology - ASIACRYPT 2016 -
22nd International Conference on the Theory and Application
of Cryptology and Information Security, ser. Lecture Notes
in Computer Science, J. H. Cheon and T. Takagi, Eds., vol.
10032. Springer, 2016, pp. 807–840.
[21] “ISO/IEC IS 9798-3, Entity authentication mechanisms —
Part 3: Entity authentication using assymetric techniques,”
1993.
[22] H. Krawczyk, “SIGMA: The ’SIGn-and-MAc’ Approach
to Authenticated Difﬁe-Hellman and Its Use in the IKE-
Protocols,” in Advances in Cryptology - CRYPTO 2003, 23rd
Annual International Cryptology Conference, ser. Lecture
Notes in Computer Science, D. Boneh, Ed., vol. 2729.
Springer, 2003, pp. 400–425.
[23] H. Krawczyk and H. Wee, “The OPTLS Protocol and TLS
1.3,” in IEEE European Symposium on Security and Privacy,
EuroS&P 2016, Saarbr¨ucken, Germany, March 21-24, 2016,
2016, pp. 81–96.
[24] R. K¨usters and D. Rausch, “A Framework for Univer-
sally Composable Difﬁe-Hellman Key Exchange,” Cryptology
ePrint Archive, Tech. Rep. 2017/256, 2017, available at
http://eprint.iacr.org/2017/256.
[25] R. K¨usters and M. Tuengerthal, “The IITM Model: a Simple
and Expressive Model for Universal Composability,” Cryp-
tology ePrint Archive, Tech. Rep. 2013/025, 2013, available
at http://eprint.iacr.org/2013/025.
[26] U. M. Maurer and S. Wolf, “Difﬁe-Hellman Oracles,” in
Advances in Cryptology - CRYPTO ’96, 16th Annual Inter-
national Cryptology Conference, Santa Barbara, California,