Step 2:  Set up logs for DHCP service
You can log DHCP activity and errors to help you monitor requests and identify 
problems with your server.
DHCP service records diagnostic messages in the system log file. To keep this file from 
growing too large, you can suppress most messages by changing your log settings in 
the Logging pane of the DHCP service settings. For more information on setting up 
logs for DHCP service, see “Setting the Log Detail Level for DHCP Service” on page 15.
Step 3:  Start DHCP service
See “Starting and Stopping DHCP Service” on page 10.
Managing DHCP Service
This section describes how to set up and manage DHCP service on Mac OS X Server. It 
includes starting service, creating subnets, and setting optional settings like LDAP or 
DNS for a subnet.
Starting and Stopping DHCP Service
Follow these steps when starting or stopping DHCP. You must have at least one subnet 
created and enabled.
To start or stop DHCP service:
1
In Server Admin, choose DHCP from the Computers & Services list.
2
Make sure at least one subnet and network interface is configured and selected.
3
Click Start Service or Stop Service.
When the service is turned on, the Stop Service button is available.
Creating Subnets in DHCP Service
Subnets are groupings of client computers on the same network that may be 
organized by location (different floors of a building, for example) or by usage (all 
eighth-grade students, for example). Each subnet has at least one range of IP addresses 
assigned to it.
To create a new subnet:
1
In Server Admin, choose DHCP from the Computers & Services list.
2
Click Settings.
3
Select the Subnets tab.
4
Click Add, or double-click an existing subnet.
5
Select the General tab.
6
Enter a descriptive name for the new subnet. (Optional)
LL2351.Book  Page 10  Monday, September 8, 2003  2:47 PM
Chapter 1    DHCP Service
11
7 Enter a starting and ending IP address for this subnet range.
Addresses must be contiguous, and they can’t overlap with other subnets’ ranges.
8 Enter the subnet mask for the network address range.
9 Choose the Network Interface from the pop-up menu.
10 Enter the IP address of the router for this subnet.
If the server you’re configuring now is the router for the subnet, enter this server’s 
internal LAN IP address as the router’s address.
11 Define a lease time in hours, days, weeks, or months.
12 If you wish to set DNS, LDAP, or WINS information for this subnet, enter these now.
See “Setting the DNS Server for a DHCP Subnet” on page 12, “Setting LDAP Options for 
a Subnet” on page 13, and “Setting WINS Options for a Subnet” on page 13 for more 
information.
13 Click Save.
Changing Subnet Settings in DHCP Service
Use Server Admin to make changes to existing DHCP subnet settings. You can change 
IP address range, subnet mask, network interface, router, or lease time.
To change subnet settings:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Select a subnet.
5 Click Edit.
6 Make the changes you want.
These changes can include adding DNS, LDAP, or WINS information. You can also 
redefine address ranges or redirect the network interface that responds to DHCP 
requests.
7 Click Save.
LL2351.Book  Page 11  Monday, September 8, 2003  2:47 PM
12
Chapter 1    DHCP Service
Deleting Subnets From DHCP Service
You can delete subnets and subnet IP address ranges when they will no longer be 
distributed to clients.
To delete subnets or address ranges:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select a subnet.
4 Click Delete.
5 Click Save to confirm the deletion.
Changing IP Address Lease Times for a Subnet
You can change how long IP addresses in a subnet are available to client computers.
To change the lease time for a subnet address range:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Select a subnet range and click Edit.
5 Select the General tab.
6 Select a time scale from the Lease Time pop-up menu (hours, days, weeks, or months).
7 Enter a number in the Lease Time field.
8 Click Save.
Setting the DNS Server for a DHCP Subnet
You can decide which DNS servers and default domain name a subnet should use. 
DHCP service provides this information to the client computers in the subnet.
To set DNS options for a subnet:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Select a subnet and click Edit.
5 Select the DNS tab.
6 Enter the default domain of the subnet.
7 Enter the primary and secondary name server IP addresses you want DHCP clients to 
use.
8 Click Save.
LL2351.Book  Page 12  Monday, September 8, 2003  2:47 PM
Chapter 1    DHCP Service
13
Setting LDAP Options for a Subnet
You can use DHCP to provide your clients with LDAP server information rather than 
manually configuring each client’s LDAP information. The order in which the LDAP 
servers appear in the list determines their search order in the automatic Open Directory 
search policy.
If you have are using this Mac OS X Server as an LDAP master, the LDAP options will be 
pre-populated with the necessary configuration information. If your LDAP master 
server is another machine, you’ll need to know the domain name or IP address of the 
LDAP database you want to use. You also will need to know the LDAP search base.
To set LDAP options for a subnet:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Select a subnet and click Edit.
5 Click the LDAP tab.
6 Enter the domain name or IP address of the LDAP server for this subnet.
7 Enter the search base for LDAP searches.
8 Enter the LDAP port number, if you’re using a non-standard port.
9 Select LDAP over SSL, if necessary.
10 Click Save.
Setting WINS Options for a Subnet
You can give additional information to client computers running Windows in a subnet 
by adding the Windows-specific settings to the DHCP supplied network configuration 
data. These Windows-specific settings allow Windows clients to browse their Network 
Neighborhood.
You must know the domain name or IP address of the WINS/NBNS primary and 
secondary servers (this is usually the IP address of the DHCP server itself), and the NBT 
node type (which is usually “broadcast”). The NBDD Server and the NetBIOS Scope ID 
are typically not used, but you may need to use them, depending on your Windows 
clients’ configuration, and Windows network infrastructure.
LL2351.Book  Page 13  Monday, September 8, 2003  2:47 PM
14
Chapter 1    DHCP Service
To set WINS options for a subnet:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Select a subnet and click Edit.
5 Click the WINS tab.
6 Enter the domain name or IP address of the WINS/NBNS primary and secondary servers 
for this subnet.
7 Enter the domain name or IP address of the NBDD server for this subnet.
8 Choose the NBT node type from the pop-up menu.
9 Enter the NetBIOS Scope ID.
10 Click Save.
Disabling Subnets Temporarily
You can temporarily shut down a subnet without losing all its settings. This means no 
IP addresses from the subnet’s range will be distributed on the selected interface to 
any client.
To disable a subnet:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Subnets tab.
4 Deselect “Enable” next to the subnet you want to disable.
Monitoring DHCP Service
You’ll need to monitor DHCP service. There are two main ways to monitor DHCP 
service. First, you can view the client list; second, you can monitor the log files 
generated by the service. You can use the service logs to help troubleshoot network 
problems. The following sections discuss these aspects of monitoring DHCP service. 
Viewing the DHCP Status Overview
The status overview shows a simple summary of the DHCP service. It shows whether or 
not the service is running, how many clients it has, and when service was started. It 
also shows how many IP addresses are statically assigned from your subnets and the 
last time the client database was updated.
To see the overview:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click the Overview button.
LL2351.Book  Page 14  Monday, September 8, 2003  2:47 PM
Chapter 1    DHCP Service
15
Setting the Log Detail Level for DHCP Service
You can choose the level of detail you want to log for DHCP service.
• “Low (errors only)” will indicate conditions for which you need to take immediate 
action (for example, if the DHCP server can’t start up). This level corresponds to 
bootpd reporting in “quiet” mode, with the “-q” flag.
• “Medium (errors and warnings)” can alert you to conditions in which data is 
inconsistent, but the DHCP server is still able to operate. This level corresponds to 
default bootpd reporting.
• “High (all events)” will record all activity by the DHCP service, including routine 
functions. This level corresponds to bootpd reporting in “verbose” mode, with the “-v” 
flag.
To set up the log detail level:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Settings.
3 Select the Logging tab.
4 Choose the logging option you want.
5 Click Save.
Viewing DHCP Log Entries
If you’ve enabled logging for DHCP service, you can check the system log for DHCP 
errors.
To see DHCP log entries:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Log.
Viewing the DHCP Client List
The DHCP Clients window gives the following information for each client:
• The IP address served to the client.
• The number of days of lease time left, until the time is less than 24 hours; then the 
number of hours and minutes.
• The DHCP client ID. This is usually, but not always, the same as the hardware address.
• The computer name.
• The Ethernet ID.
To view the DHCP client list:
1 In Server Admin, choose DHCP from the Computers & Services list.
2 Click Clients.
Click any column heading to sort the list by different criteria.
LL2351.Book  Page 15  Monday, September 8, 2003  2:47 PM
16
Chapter 1    DHCP Service
Where to Find More Information
Request for Comments (RFC) documents provide an overview of a protocol or service 
and details about how the protocol should behave. If you’re a novice server 
administrator, you’ll probably find some of the background information in an RFC 
helpful. If you’re an experienced server administrator, you can find all the technical 
details about a protocol in its RFC document. You can search for RFC documents by 
number at www.faqs.org/rfcs.
For details about DHCP, see RFC 2131.
For more information on bootpd and its advanced configuration options, see bootpd’s 
man page.
LL2351.Book  Page 16  Monday, September 8, 2003  2:47 PM
2
17
2 DNS Service
When your clients want to connect to a network resource such as a web or file server, 
they typically request it by its domain name (such as www.example.com) rather than 
by its IP address (such as 192.168.12.12). The Domain Name System (DNS) is a distributed 
database that maps IP addresses to domain names so your clients can find the 
resources by name rather than by numerical address.
A DNS server keeps a list of domain names and the IP addresses associated with each 
name. When a computer needs to find the IP address for a name, it sends a message to 
the DNS server (also known as a name server). The name server looks up the IP address 
and sends it back to the computer. If the name server doesn’t have the IP address 
locally, it sends messages to other name servers on the Internet until the IP address is 
found.
Setting up and maintaining a DNS server is a complex process. Therefore many 
administrators rely on their Internet Service Provider (ISP) for DNS services. In this case, 
you only have to configure your network preferences with the name server IP address 
provided by your ISP.
If you don’t have an ISP to handle DNS requests for your network and any of the 
following is true, you need to set up DNS service:
• You don’t have the option to use DNS from your ISP or other source.
• You plan on making frequent changes to the namespace and want to maintain it 
yourself.
• You have a mail server on your network and you have difficulties coordinating with 
the ISP that maintains your domain.
Mac OS X Server uses Berkeley Internet Name Domain (BIND v.9.2.2) for its 
implementation of DNS protocols. BIND is an open-source implementation and is used 
by the majority of name servers on the Internet.
LL2351.Book  Page 17  Monday, September 8, 2003  2:47 PM
18
Chapter 2    DNS Service
Before You Set Up DNS Service
This section contains information you should consider before setting up DNS on your 
network. The issues involved with DNS administration are complex and numerous. You 
should only set up DNS service on your network if you’re an experienced DNS 
administrator.
You should consider creating a mail account called “hostmaster” that receives mail and 
delivers it to the person that runs the DNS server at your site. This allows users and 
other DNS administrators to contact you regarding DNS problems.
DNS and BIND
You should have a thorough understanding of DNS before you attempt to set up your 
own DNS server. A good source of information about DNS is DNS and BIND, 4th edition, 
by Paul Albitz and Cricket Liu (O’Reilly and Associates, 2001).
Note:  Apple can help you locate a network consultant to implement your DNS service. 
You can contact Apple Professional Services and Apple Consultants Network on the 
web at www.apple.com/services/ or www.apple.com/consultants.
Setting Up Multiple Name Servers
You should set up at least one primary and one secondary name server. That way, if the 
primary name server unexpectedly shuts down, the secondary name server can 
continue to provide service to your users. A secondary server gets its information from 
the primary server by periodically copying all the domain information from the primary 
server.
Once a name server learns a name/address pair of a host in another domain (outside 
the domain it serves), the information is cached, which ensures that IP addresses for 
recently resolved names are stored for later use. DNS information is usually cached on 
your name server for a set time, referred to as a time-to-live (TTL) value. When the TTL 
for a domain name/IP address pair has expired, the entry is deleted from the name 
server’s cache and your server will request the information again as needed.
Setting Up DNS Service for the First Time
If you’re using an external DNS name server and you entered its IP address in the Setup 
Assistant, you don’t need to do anything else. If you’re setting up your own DNS server, 
follow the steps in this section.
Step 1:  Register your domain name
Domain name registration is managed by a central organization, the Internet Assigned 
Numbers Authority (IANA). IANA registration makes sure domain names are unique 
across the Internet. (See www.iana.org for more information.) If you don’t register your 
domain name, your network won’t be able to communicate over the Internet. 
LL2351.Book  Page 18  Monday, September 8, 2003  2:47 PM
Chapter 2    DNS Service
19
Once you register a domain name, you can create subdomains within it as long as you 
set up a DNS server on your network to keep track of the subdomain names and IP 
addresses.
For example, if you register the domain name “example.com,” you could create 
subdomains such as “host1.example.com,” “mail.example.com,” or “www.example.com.” 
A server in a subdomain could be named “primary.www.example.com,” or 
“backup.www.example.com.” The DNS server for example.com keeps track of 
information for its subdomains, such as host (or computer) names, static IP addresses, 
aliases, and mail exchangers. If your ISP handles your DNS service, you’ll need to inform 
them of any changes you make to your namespace, including adding subdomains.
The range of IP addresses for use with a given domain must be clearly defined before 
setup. These addresses are used exclusively for one specific domain (never by another 
domain or subdomain). The range of addresses should be coordinated with your 
network administrator or ISP.
Step 2:  Learn and plan
If you’re new to working with DNS, learn and understand DNS concepts, tools, and 
features of Mac OS X Server and BIND. See “Where to Find More Information” on 
page 41.
Then plan your Domain Name System Service. You may consider the following 
questions when planning:
• Do you even need a local DNS server? Does your ISP provide DNS service? Could you 
use Rendezvous names instead?
• How many servers will you need for anticipated load? How many servers will you 
need for backup purposes? For example, you should designate a second or even 
third computer for backup DNS service.
• What is your security strategy to deal with unauthorized use?
• How often should you schedule periodic inspections or tests of the DNS records to 
verify data integrity?
• How many services or devices (like an intranet website or a network printer) are 
there that will need a name?
• What method should you use to configure DNS? 
There are two ways to configure DNS service on Mac OS X Server. First, and 
recommended, you can use Server Admin to set up DNS service. For more information, 
see “Managing DNS Service” on page 21 for instructions.
The second way to configure DNS is by editing the BIND configuration file. BIND is the 
set of programs used by Mac OS X Server that implements DNS. One of those programs 
is the name daemon, or named. To set up and configure BIND, you need to modify the 
configuration file and the zone file.
LL2351.Book  Page 19  Monday, September 8, 2003  2:47 PM
20
Chapter 2    DNS Service
The configuration file is located in this file:
/etc/named.conf
The zone file name is based on the name of the zone. For example, the zone file 
“example.com” is located in this file:
/var/named/example.com.zone
See “Configuring BIND Using the Command Line” on page 37 for more information.
Step 3:  Configure basic DNS settings
See “Managing DNS Service” on page 21 for more information.
Step 4:  Create a DNS Zone
Use Server Admin to set up DNS zones. See “Managing Zones” on page 22 for 
instructions. After adding a master zone, Server Admin automatically creates an NS 
record with the same name as the Source of Authority (SOA).
Step 5:  Add Address and additional records to the zone.
Use Server Admin to add additional records to your Zone. Create an Address record for 