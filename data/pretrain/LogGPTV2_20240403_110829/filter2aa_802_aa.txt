# Home Invasion 2.0: Attacking Network-Connected Embedded Devices

## Abstract
This study evaluates the security of several network-connected embedded devices marketed for home use. While network connectivity is already common for personal computers, mobile devices, and digital storage units, a growing number of non-traditional network-connected devices are emerging. These devices, which can control aspects of the physical world, pose unique risks. We selected our research targets based on their capabilities, availability, and cost, focusing on devices that might be found in a modern home in 2013. Our analysis revealed exploitable flaws in nearly every device, many of which were easily exploitable. We present exploitation techniques and assess the associated risks. The study concludes with an overall assessment of the current state of security in these devices and discusses the implications of vulnerabilities in this class of technology.

## 1. Introduction
The initial release of any new technology often lacks maturity, particularly in terms of security. Security is often not a primary functional requirement, leading to its neglect in favor of product development and release. This study suggests that this trend holds true for non-traditional network-connected devices, such as smart door locks, electrical switches, and even toilets. Given that these devices can control aspects of the physical world, their compromise can have serious real-world consequences. Our research aims to determine the level of security in these devices and provide guidance for those adopting them into their homes and businesses.

## 2. Methodology for Devices Evaluated
### 2.1 Belkin WeMo Switch
The WeMo switch was evaluated through black-box testing and by eavesdropping on traffic generated by the associated iPhone application.

### 2.2 MiCasaVerde VeraLite
The VeraLite was evaluated using black-box testing, analysis of the extracted squashfs firmware package, and review of the source code of various applications on the device.

### 2.3 INSTEON Hub
The INSTEON Hub was evaluated through black-box testing.

### 2.4 Karotz Smart Rabbit
The Karotz was evaluated using a combination of black-box testing, source code audit of the setup package, and documentation review.

### 2.5 Linksys Media Adapter
The Linksys Media Adapter was evaluated through analysis of a ROM dump, as the device was not directly available.

### 2.6 Lixil Satis Smart Toilet
The Satis was evaluated by reverse engineering its associated Android application, as the device was not directly available due to its high cost and limited availability in the United States.

### 2.7 Radio Thermostat
The Radio Thermostat was evaluated through a study of its API documentation.

### 2.8 Sonos Bridge
The Sonos Bridge was evaluated using black-box testing techniques and documentation review.

## 3. Results
### 3.1 Belkin WeMo Switch
**Description:**
The Belkin WeMo switch is a device that plugs into an electrical outlet and has its own built-in outlet. It connects to an 802.11 network and can control the power supply to the connected device via a physical button or a UPnP service.

#### 3.1.1 Vulnerable libupnp Version
Portable SDK for UPnP version 1.6.17 and earlier are vulnerable to remote buffer overflow attacks. The Belkin WeMo uses Portable SDK for UPnP version 1.6.6.

#### 3.1.2 Unauthenticated UPnP Actions
UPnP is a protocol for automated network configuration, typically without authentication. The Belkin WeMo switch allows unauthenticated UPnP actions for configuration and control.

##### 3.1.2.1 SetBinaryState
The "basicevent" service has a UPnP action named "SetBinaryState," which changes the unit's state to "on" or "off." There is no rate limiting, allowing rapid state changes.

##### 3.1.2.2 SetFriendlyName
The "basicevent" service has a UPnP action named "SetFriendlyName," which changes the name displayed in the control application.

##### 3.1.2.3 UpdateFirmware
The "firmwareupdate" service has a UPnP action named "UpdateFirmware," which allows new firmware to be applied. While the firmware is signed, it is possible to push old versions with known vulnerabilities.

### 3.2 MiCasaVerde VeraLite
**Description:**
The MiCasaVerde VeraLite is a low-cost home automation control unit that manages various network-connected devices via Z-Wave, INSTEON, X10, and other protocols. It controls lights, electrical outlets, door locks, alarm systems, window blinds, and more.

#### 3.2.1 Lack of Authentication on Web Console by Default
The web console does not require authentication by default, allowing unauthorized access.

#### 3.2.2 Lack of Authentication on UPnP Daemon
The UPnP daemon also lacks authentication, enabling unauthenticated control.

#### 3.2.3 Path Traversal
Path traversal vulnerabilities exist, allowing access to sensitive files.

#### 3.2.4 Insufficient Authorization Checks
##### 3.2.4.1 Firmware Update
Insufficient authorization checks allow unauthorized firmware updates.

##### 3.2.4.2 Settings Backup
Settings backups can be performed without proper authorization.

##### 3.2.4.3 Test Lua Code
Lua code can be tested without proper authorization.

#### 3.2.5 Server-Side Request Forgery (SSRF)
The device is vulnerable to SSRF, allowing attackers to make requests to internal networks.

#### 3.2.6 Cross-Site Request Forgery (CSRF)
The device is vulnerable to CSRF, allowing unauthorized actions to be performed.

#### 3.2.7 Unconfirmed Authentication Bypass
There are indications of potential authentication bypass vulnerabilities.

#### 3.2.8 Vulnerable libupnp Version
The device uses a vulnerable version of the libupnp library, similar to the Belkin WeMo switch.

### 3.3 INSTEON Hub
**Description:**
The INSTEON Hub lacks authentication, allowing unauthenticated access to its services.

### 3.4 Karotz Smart Rabbit
**Description:**
The Karotz Smart Rabbit exposes Wi-Fi network credentials unencrypted to the Karotz server, allows Python module hijack during Wi-Fi setup, and makes unencrypted remote API calls.

### 3.5 Linksys Media Adapter
**Description:**
The Linksys Media Adapter allows unauthenticated UPnP actions, similar to the Belkin WeMo switch.

### 3.6 LIXIL Satis Smart Toilet
**Description:**
The LIXIL Satis Smart Toilet has a default Bluetooth PIN, allowing unauthorized access.

### 3.7 Radio Thermostat
**Description:**
The Radio Thermostat has an unauthenticated API and discloses Wi-Fi passphrases in older firmware versions.

### 3.8 Sonos Bridge
**Description:**
The Sonos Bridge discloses support console information, potentially exposing sensitive data.

## 4. Discussion
The results of our evaluation highlight significant security vulnerabilities in a wide range of network-connected embedded devices. These vulnerabilities, ranging from unauthenticated access to buffer overflows, pose serious risks to users. The lack of robust security measures in these devices underscores the need for manufacturers to prioritize security in their design and development processes. Users and organizations should be aware of these risks and take appropriate precautions when integrating these devices into their environments. Future work should focus on developing and implementing more secure standards and practices for these types of devices.