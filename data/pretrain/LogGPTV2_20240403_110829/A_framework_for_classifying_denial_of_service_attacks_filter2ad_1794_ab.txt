LA-MAE
Geniuty
Cogent
Verio
Los Nettos Network
Trace Machine
Figure 3: The trace machine monitors two of the four peering
links at Los Nettos.
tant characteristic is that it capture the trend in frequency distri-
bution of the spectra. Our results are insensitive to the particular
choice of quantile as examined in detail in Section 7.
5. EVALUATION
In this section we present our trace collection infrastructure and
our experimental analysis based on attack captured at Los Nettos.
Validation of these results is presented the next section.
5.1 Attack Detection
We tested the framework described in Section 4 using attacks
captured at Los Nettos, a moderate size ISP located in Los Ange-
les [20]. We captured 80 large-scale attacks over a period of ﬁve
months, from July 2002 to November 2003.
Los Nettos has four major peering links with commercial ISP
providers. Due to lack of available mirroring capacity, we were
able to monitor only two links, as shown in Figure 3. Los Nettos has
a diverse clientele including academic and commercial customers.
The trace machine is an off-the-shelf Intel P4 1.8GHz, with 1GB
of RAM running FreeBSD 4.5. We use a Netgear GA620 1000BT-
SX NIC, and modiﬁed the driver to support partial packet transfer
from the NIC to the kernel. Typical daytime load is 140Mb/s with
a mean of 38Kpackets/s. Measurement drops (as reported by tcp-
dump) are usually below 0.04% during normal operation, rising to
0.6% during attacks that increase packet rates to 100Kpackets/s.
We continuously capture packet headers using tcpdump, creating
a trace ﬁle every two minutes. Each trace is then post-processed and
ﬂagged as containing a potential attack if either of two thresholds
are reached: (a) the number sources that connect to the same desti-
nation within one second exceeds 60, or (b) the trafﬁc rate exceeds
40Kpackets/s. These thresholds were determined by observing the
trafﬁc seen at the observation point. Traces that are not ﬂagged
as an attack are discarded. We identify and ignore known servers
that would trigger these thresholds through normal trafﬁc. Finally,
we manually verify each ﬂagged trace to conﬁrm the presence of
an attack. The automated thresholding works reasonably well, but
provides a false positive rate of 25–35%. Ongoing attacks that do
not meet the thresholds are not identiﬁed. We thus miss many small
DoS attacks, including some attacks that would incapacitate a dial-
up line.
We monitor both inbound and outbound trafﬁc. Since we mon-
itor the two busiest peering links, we believe we capture most of
the attack trafﬁc for attacks terminating within Los Nettos, missing
only portions from the peering links we do not monitor and from
attackers within Los Nettos. For attacks transiting through Los Net-
tos, our monitoring point may not be exposed to the full intensity
of the attack since there may be attackers outside Los Nettos and
we do not monitor all external links of Los Nettos. The distinction
between transient and terminating attacks becomes important when
projecting numbers of attacks in Section 8.3.
Attack Class
Single-source
Multi-source
Reﬂected
Unclassiﬁed
# Attacks Range (packets/s) Range (kbits/s)
2700–93000
17000–100000
3000–33000
12000-66000
350–82500
300–98000
340–13000
400–68500
37
10
20
13
Table 1: Number of attacks in each class based on header anal-
ysis
Protocol
Packet Type
TCP
ICMP
UDP
Other
SYN
ACK
SYN-ACK
no ﬂags
unusual
state exploit
echo request
echo reply
invalid
all
ip-proto 0
ip-proto 255
fragmented
Attack Class
M
3 (2)
2 (2)
-
1 (1)
1
-
-
-
-
-
-
3
-
R
-
-
4
-
-
-
-
16 (3)
-
-
-
-
-
U
7 (5)
3 (2)
-
-
-
-
-
-
1 (1)
5 (4)
-
-
3 (3)
S
2
5
9
15
5
2
5
1
-
6 (1)
5
-
1
Table 2: Detailed analysis of packet headers. S indicates single-
source, M indicates multi-source, R indicates distributed re-
ﬂectors, and U indicates unclassiﬁed attacks. The number in
parenthesis indicates attacks terminating within our ISP while
the ﬁrst number indicates total attacks.
5.2 Packet Headers Analysis
First we classify attacks based on packet header information alone.
As shown in Table 1, we classiﬁed 67 attacks (all but 13) using this
method. Table 2 shows a more detailed breakdown of attacks based
on manual analysis with tcpdump. The packet type categories listed
in Table 2 are not mutually exclusive since some attack streams
carry multiple packet types.
From header analysis we can make several observations about
the prevalence of attack techniques in the wild. First, 87% of the
zombie attacks use illegal packet formats or randomize ﬁelds, indi-
cating the presence of root access on the zombies. Use of TCP pro-
tocol was most common, with reﬂection attacks typically exploiting
web servers (port 80) and FTP servers (port 21). In Table 2, TCP
no ﬂags refers to pure data packets with no ﬂags set, while unusual
refers to attacks that use non-standard (but not always invalid) com-
binations of TCP ﬂags, such as setting all the ﬂags. State exploit
refers to attacks that exhaust OS data-structures based on the TCP-
state diagram, (such as ESTABLISHED or FIN-WAIT1 states) [1].
Even though TCP-SYN attacks belong to this class, we list them
separately since they are common.
ICMP is the next protocol of choice. The echo reply attack was
the most popular reﬂector attack, since most Internet hosts respond
to an echo request packet allowing the attacker to choose from the
large number of possible reﬂectors. The remaining ICMP attacks
use echo request packet or an invalid ICMP code. UDP and unde-
ﬁned protocols were less frequently used in the attacks. Finally, we
detected ﬁve attacks that use a combination of protocols, such as
TCP, ICMP, UDP, and IP proto-0.
5.3 Arrival Rate Analysis
This section investigates the relation between attack rate and at-
tacker population. We captured attacks with peak rates ranging
 100000
 10000
 1000
)
s
p
p
(
s
e
t
a
r
k
c
a
t
t
A
 100
 100
Single-source
Reflected
Multi-source
Unclassified
 1000
 10000
 100000
Attack rates (Kbps)
(a) Attack intensity in packets/s and Kbits/s
105
104
)
s
p
p
(
s
e
t
a
r
k
c
a
t
t
A
103
102
Single−source
Multi−source
Reflected
(b) Attack intensity in packets/s for each class
Figure 4: Correlation of attack rates and attack class
from 300packets/s to 98Kpackets/s. Figure 4 shows the correlation
between the attack classes and attack rate. In Figure 4(a) we plot
the peak attack rates in Kbits/s on the x-axis against packets/s on the
y-axis in logarithmic scale for each attack. Not surprisingly, single-
source attacks are clustered toward lower packet rates whereas di-
rect multi-source attacks exhibit higher rates, most likely due to
aggregation of trafﬁc from multiple zombies. In reﬂection attacks,
many reﬂectors are typically employed to generate high attack ag-
gregates without overloading the reﬂectors. The captured reﬂection
attacks have a much lower intensity than direct multi-source attacks
since the observation point might not be exposed to the complete
intensity of the attack.
To statistically conﬁrm attack rates of single-, multi-source, and
reﬂected attacks have different means, we performed Kruskal-Wallis
one-way ANOVA test [5]. We consider the null hypothesis, H0;
there is no relation between the attack rates and attack class. The
alternative hypothesis, Ha states there is a relation between attack
rate and class. If H0 is true, the variance estimate based on within-
class variability should be approximately the same as the variance
due to between-class variability. This test deﬁnes a F ratio that
evaluates the two variance estimates; if the F ratio is signiﬁcantly
greater than 1, the test is statistically signiﬁcant, and we can con-
clude that the means for the three classes are different from each
other and reject H0. It also deﬁnes a p-value, the probability of
observing the sample result assuming H0 true. Hence a smaller
p-value provides higher conﬁdence in rejecting H0. For the data
5
)
s
p
p
K
(
s
e
t
a
r
k
c
a
t
t
A
 100
 90
 80
 70
 60
 50
 40
 30
 20
 10
 0
 0
 10
 20
 30
 40
 50
 60
 70
Time (seconds)
)
s
p
p
K
(
s
e
t
a
r
k
c
a
t
t
A
 60
 50
 40
 30
 20
 10
 0
 0
 10
 20
 30
 40
 50
 60
 70
Time (seconds)
(a) Multiple source ad-
dresses observed in at-
tack
Subnet
(b)
source addresses
spoofed
Figure 5: Due to lack of synchronization among the zombies,
multi-source attacks exhibit initial ramp-up behavior
in Figure 4(a), the F ratio is 37, indicating a strong relation be-
tween the attack rates and the attack classes. Further, the p-value is
1.7× 10−11, indicating a very low probability of H0 being correct.
The box plot in Figure 4(b) provides graphical representation of
the means of different classes. The lower and upper lines of the box
indicate the 25th and 75th percentiles of attack rates making the
distance between the top and bottom of the box is the interquartile
range The line in the middle of the box is the median attack rate for
the attack class. The “whiskers” (lines extending above and below
the box) show the range of the attack rate, except for the outliers
indicated by a “+” marker. Single-source attacks have the lowest
median while the median and range of the multi-source attacks is
signiﬁcantly higher than single-source and reﬂected attacks.
5.4 Ramp-up Behavior Analysis
To identify the presence of multiple sources when the header is
forged we measure the attack’s ramp-up behavior (changes in the
trafﬁc volume of the attack as a function of time). Of the attacks
we observed, single-source attacks typically exhibit no ramp-up,
while all multi-source attacks showed ramp-up behavior, ranging
from 200ms to 14s.
Figure 5 illustrates the attack ramp-up for two observed attacks.
Figure 5(a) shows an attack where packet headers were not forged,
and thus the attacker population was visible. The graph shows a
three second ramp-up at about 27s as the number of attackers grad-
ually increase to six. The attack reaches a peak rate of 78Kpack-
ets/s with 14 active sources. We observe a total of 40 unique IP
addresses during the attack. Figure 5(b) shows an attack where
the last eight bits of the source address are forged. The attack is
classiﬁed as a multi-source attack since it exhibits a ramp-up, ris-
ing from 6Kpackets/s to 52Kpackets/s in 14 seconds. In this attack
the source addresses and ID ﬁeld is spoofed, and all packets have
the same TTL value, making it difﬁcult to classify the attack based
on header content. The presence of transient ramp-up behavior in
the ﬁrst few seconds of the attack strongly suggests the presence
of multiple sources. We also veriﬁed it is a multi-source attack via
spectral analysis.
5.5 Spectral Content Analysis
In this section we demonstrate that spectral analysis of the at-
tack time-series (described in Section 4.3) can distinguish between
single- and multi-source attacks, even if all headers are spoofed.
Because the trafﬁc spectrum is inﬂuenced by OS and network be-
havior we argue that it will be difﬁcult for attackers to easily con-
ceal their spectrum without reducing attack effectiveness. We re-
view this claim more carefully Sections 6 and 7, for now we present
example spectra to illustrate the technique.
 1.8
 1.6
 1.4
 1.2
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
 0.8
 0.6
 0.4
 0.2
)
f
(
S
)
f
(