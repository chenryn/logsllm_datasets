ally, 14 445 ﬂows (1.14 % of all the ﬂows), accounting for 0.28 GB (0.78 %) of data
Is Our Ground-Truth for Traﬃc Classiﬁcation Reliable?
103
volume, could be identiﬁed based on the HTTP content-type ﬁeld extracted from
the packets. Therefore, we were able to successfully establish the ground truth
for 535 438 ﬂows (42.43 % of all the ﬂows), accounting for 32.61 GB (91.37 %)
of data volume. The remaining ﬂows are unlabeled due to their short lifetime
(below ∼1 s), which made VBS incapable to reliably establish the corresponding
sockets. Only these successfully classiﬁed ﬂows will be taken into account dur-
ing the evaluation of the classiﬁers. However, all the ﬂows are included in the
publicly available traces. This ensures data integrity and the proper work of the
classiﬁers, which may rely on coexistence of diﬀerent ﬂows. We isolated several
application classes based on the information stored in the database (e.g., appli-
cation labels, HTTP content-type ﬁeld). The classes together with the number
of ﬂows and the data volume are shown in Table 2. We have published this la-
beled dataset with full packet payloads in [12]. Therefore, it can be used by the
research community as a reference benchmark for the validation and comparison
of network traﬃc classiﬁers.
3 Performance Comparison
This section provides a detailed insight into the classiﬁcation results of diﬀerent
types of traﬃc by each of the classiﬁers. All these results are summarized in
Table 3, where the ratio of correctly classiﬁed ﬂows (i.e., precision or true posi-
tives), incorrectly classiﬁed ﬂows (i.e., errors or false positives) and unclassiﬁed
ﬂows (i.e., unknowns) are respectively presented. The complete confusion matrix
can be found in our technical report [15].
Regarding the classiﬁcation of P2P traﬃc, Edonkey is the ﬁrst application
studied. Only PACE, and especially Libprotoident, can properly classify it (pre-
cision over 94 %). NDPI and OpenDPI (that use the same pattern), as well as
NBAR, can classify almost no Edonkey traﬃc (precision below 1 %). L7-ﬁlter
classiﬁes 1/3 of the ﬂows, but it also produces many false positives by classifying
more than 13 % of the ﬂows as Skype, NTP, and ﬁnger. The wrongly classiﬁed
ﬂows in NDPI were labeled as Skype, RTP and RTCP, and in NBAR as Skype.
The classiﬁcation of BitTorrent traﬃc, the second P2P application studied, is not
completely achieved by any of the classiﬁers. PACE and Libprotoident achieve
again the highest precision (over 77 %). The rest of the classiﬁers present se-
vere problems to identify this type of traﬃc. When misclassiﬁed, the BitTorrent
traﬃc is usually classiﬁed as Skype.
The performance of most DPI tools with more traditional applications is sig-
niﬁcantly higher. FTP traﬃc is usually correctly classiﬁed. Only L7-ﬁlter and
NBAR present problems to label it. The false positives produced by L7-ﬁlter are
because the traﬃc is classiﬁed as SOCKS. Table 3 also shows that all the clas-
siﬁers can properly classify DNS traﬃc. Similar results are obtained for NTP,
which almost all the classiﬁers can correctly classify it. However, NBAR com-
pletely miss the classiﬁcation of this traﬃc. SSH was evaluated in its Linux
version. Table 3 shows that NBAR almost classiﬁed all the ﬂows while the rest
of classiﬁers labeled more than 95 % of them.
104
V. Carela-Español, T. Bujlow, and P. Barlet-Ros
Similar performance is also obtained with RDP, usually employed by VoIP
applications, as shown in Table 3. Again, L7-ﬁlter and NBAR can not classify
this application at all. The false positives for L7-ﬁlter, Libprotoident, and NBAR
are mainly due to Skype, RTMP, and H323, respectively.
Unlike previous applications, the results for NETBIOS are quite diﬀerent.
Surprisingly, NBAR and NDPI are the only classiﬁers that correctly label NET-
BIOS traﬃc. PACE can classify 2/3 of this traﬃc and OpenDPI only 1/4. On
the other hand, the patterns from L7-ﬁlter and Libprotoident do not properly
detect this traﬃc. The wrongly classiﬁed ﬂows in Libprotoident are labeled as
RTP and Skype, and in L7-ﬁlter as Edonkey, NTP, and RTP.
We also evaluated RTMP traﬃc, a common protocol used by browsers and
plugins for playing FLASH content. It is important to note that only Libpro-
toident has a speciﬁc pattern for RTMP. Because of that, we have also counted
as correct the RTMP traﬃc classiﬁed as FLASH although that classiﬁcation is
not as precise as the one obtained by Libprotoident. L7-ﬁlter and NBAR can not
classify this type of traﬃc. The rest of the classiﬁers achieve a similar precision,
around 80 %. The surprising amount of false positives by NDPI is because some
traﬃc is classiﬁed as H323. L7-ﬁlter errors are due to wrongly classiﬁed traﬃc
as Skype and TSP.
Table 3 also presents the results regarding the HTTP protocol. All of them
but L7-ﬁlter can properly classify most of the HTTP traﬃc. L7-ﬁlter labels
all the traﬃc as ﬁnger or Skype. NDPI classiﬁes some HTTP traﬃc as iMes-
sage_Facetime. The amount of errors from PACE is surprising, as this tool is
usually characterized by very low false positive ratio. All the wrong classiﬁca-
tions are labeled as Meebo traﬃc. The older Meebo pattern available in OpenDPI
and the newer from NDPI seems not to have this problem.
Most incorrect classiﬁcations for all the tools are due to patterns that easily
match random traﬃc. This problem especially aﬀects L7-ﬁlter and, in particular,
with the patterns used to match Skype, ﬁnger and ntp traﬃc. The deactivation
of those patterns would considerably decrease the false positive ratio but it
would disable the classiﬁcation of those applications. In [4], the authors use a
tailor-made conﬁguration and post-processing of the L7-ﬁlter output in order to
minimize this overmatching problem.
3.1 Sub-classiﬁcation of HTTP Traﬃc
Our dataset also allows the study of HTTP traﬃc at diﬀerent granularity (e.g.,
identify diﬀerent services running over HTTP). However, only NDPI can sub-
classify some applications at this granularity (e.g., Youtube, Facebook). Newer
versions of PACE also provide this feature but we had no access to it for this
study. Table 4 presents the results for four applications running over HTTP
identiﬁed by NDPI. Unlike the rest of tools that basically classify this traﬃc
as HTTP, NDPI can correctly give the speciﬁc label with precision higher than
97 %. Furthermore, the classiﬁcation errors are caused by traﬃc that NDPI clas-
siﬁes as HTTP without providing the lower level label.
Is Our Ground-Truth for Traﬃc Classiﬁcation Reliable?
105
Table 3. DPI evaluation
Application Classiﬁer % correct % wrong % uncl.
Application Classiﬁer % correct % wrong % uncl.
Libprotoident
Libprotoident
Libprotoident
Libprotoident
Libprotoident
Libprotoident
Libprotoident
Libprotoident
Edonkey
BitTorrent
FTP
DNS
NTP
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
94.80
0.45
34.21
0.45
98.39
0.38
81.44
27.23
42.17
56.00
77.24
27.44
95.92
96.15
6.11
95.69
95.58
40.59
99.97
99.97
98.95
99.88
99.97
99.97
100.00
100.00
99.83
100.00
100.00
0.40
0.02
0.00
13.70
6.72
0.00
10.81
0.01
0.00
8.78
0.43
0.06
1.49
0.00
0.00
93.31
0.45
0.00
0.00
0.00
0.00
0.13
0.09
0.00
0.02
0.00
0.00
0.15
0.00
0.00
0.00
5.18
99.55
52.09
92.83
1.60
88.81
18.54
72.77
49.05
43.58
22.71
71.07
4.08
3.85
0.57
3.85
4.42
59.41
0.03
0.03
0.92
0.03
0.04
0.02
0.00
0.00
0.02
0.00
0.00
99.60
SSH
RDP
NETBIOS
RTMP
HTTP
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
NBAR
PACE
OpenDPI
L7-ﬁlter
NDPI
95.57
95.59
95.71
95.59
95.71
99.24
99.04
99.07
0.00
99.05
98.83
0.00
66.66