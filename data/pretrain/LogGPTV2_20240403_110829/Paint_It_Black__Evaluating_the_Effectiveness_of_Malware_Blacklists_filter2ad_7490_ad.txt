210
42
9
417
145
7
47
87.6
2.1
0.0
6.3
0.0
51.7
4.3
0.0
11.1
0.0
56.6
0.0
51.1
89.3
2.1
17.7
18.9
0.0
58.6
21.0
9.5
11.1
1.2
57.9
0.0
53.2
Family # Dom. SC&C SM al
SAV
SBD SM A
Table 5. Coverage of malware domains
Citadel
Dirtjumper
FakeRean
Gamarue
Gbot
Palevo
Ponyloader
Pushdo
Rodecap
Sality
SpyEye
Tedroo
ZeuS
Three of the blacklists op-
erated by AV vendors perform
signiﬁcantly better. Looking at
the union of the blacklists, at
least 70% of the domains per
family are detected. More than
90% of the domains were listed
for seven of the 13 families. We
also look at the breakdown of
SAV ,
i.e., how well the indi-
vidual blacklists perform. Ta-
ble 5 includes the two blacklists
that perform best: SBD is oper-
ated by Bitdefender and SMA
by McAfee. Surprisingly, these
blacklists have a non-negligible separation—combining them signiﬁcantly in-
creases the overall coverage for many families. We do not list the remaining two
blacklists due to space constraints, however, note that Norton performs similar
to Bitdefender and McAfee while Browserdefender fails to detect any domain
for the majority of families and covers only 2 - 7% of the domains for the other
malware families.
96.0
80.9
73.5
86.6
100.0
93.1
95.7
92.9
100.0
82.3
83.4
85.7
95.7
79.1
40.4
58.8
47.2
100.0
89.7
65.7
78.6
44.4
27.3
61.4
28.6
61.7
57.3
63.8
50.0
62.2
77.3
63.8
71.4
64.3
66.7
73.4
26.9
57.1
51.1
5.3 Reaction Time
For the domains seen in Sandnet which are also covered by SMal, we addi-
tionally estimate the reaction time of the blacklists. That is, we measure how
long it takes to blacklist the domains once they were seen in Sandnet. As
the domains could have been performing malicious activities before we observed
them in Sandnet, the presented reaction times are lower bounds. We therefore
obtained pDNS records and VirusTotal [34] analysis results to investigate the
history of each domain. In total, we could aggregate pDNS records for 81.3% of
all domains and obtained information from VirusTotal for 98% of the domains.
We determined the reaction times for each combination of public blacklist and
malware family. Yet, for reasons of brevity we focus on a few interesting com-
binations only. Figure 1 illustrates a CDF of the reaction times of four black-
lists, respectively, blacklist combinations. The y-axis shows the reaction time
per blacklist entry in days and the x-axis depicts the ratio of domains with this
reaction time. Negative y-values indicate that the domain was ﬁrst seen in the
blacklists and then observed in Sandnet, pDNS, or VirusTotal. Positive y-values
Paint It Black: Evaluating the Eﬀectiveness of Malware Blacklists
15
denote that a blacklist lagged behind. The y-values of blacklisted domains that
are not found in pDNS or VirusTotal are set to the negative inﬁnity.
The black solid line represents the reaction time of the blacklists provided by
Abuse.ch (Palevo, SpyEye, and ZeuS ) and the corresponding domains as seen in
Sandnet. About 23.3% of the domains were listed by the blacklists before they
appeared in Sandnet, respectively, 76.7% of the domains were seen in Sand-
net ﬁrst. As depicted by the black dotted line, we ﬁnd 37.9% of the domains
to be blacklisted before appearing in VirusTotal. Approximately 64.7% of the
domains were seen in Sandnet and added to the blacklists on the same day. The
reaction time of Abuse.ch was less than a week for 80.2% of the Sandnet do-
mains and the blacklists included already 96.6% of the domains within 30 days.
The results show an adequate reaction time for the Abuse.ch blacklists, although
the completeness is not ideal (cf. Section 5.2). The black dashed line illustrates
the results obtained for the Abuse.ch blacklists and pDNS. We could not obtain
pDNS records for 27.6% of the domains, i.e., these domains, although monitored
in multiple sandbox environments, were never seen in the DNS DB database.
Another 3.4% of the domains were blacklisted before the domains appeared in
pDNS, while 10.4% of the domains were blacklisted and seen in pDNS on the
same day. The remaining 58.6% of the domains were seen in pDNS on average
334 days before appearing in the blacklists. These domains either performed ma-
licious activities before becoming blacklisted or—more likely—performed benign
actions before turning malicious.
150
120
0
90
60
30
UrlBlacklist / SANDNET (all families)
Cybercrime / SANDNET (all families)
MW-Domains / SANDNET (all families)
Abuse.ch Trackers / pDNS (Palevo, SpyEye, ZeuS)
)
s
y
a
d
n
i
(
e
m
i
t
n
o
i
t
c
a
e
R
Abuse.ch Trackers / SANDNET (Palevo, SpyEye, ZeuS)
Abuse.ch Trackers / VirusTotal (Palevo, SpyEye, ZeuS)
We observe dif-
ferent results for the
reaction times of the
other
three black-
lists shown in the
graph. The reaction
time of UrlBlacklist
was higher than a
month for 53.5% of
the domains. Sim-
ilarly, the blacklist
MW-Domains has a
reaction time of at
least 30 days
for
the do-
39.7% of
mains. After
four
months, the cover-
age of all three blacklists was still below 90%. In general, the low number of
domains that appeared in Sandnet after they were blacklisted (negative y-
values) indicates that our ground truth dataset is up-to-date.
Fig. 1. Reaction times of selected blacklists
Ratio (in %)
70
80
90
30
60
10
20
30
40
50
60
16
M. K¨uhrer, C. Rossow, and T. Holz
5.4 DGA-Based Domains
Malware that employs DGAs to dynamically create domains—typically derived
from the current date—imposes additional diﬃculties to blacklist operators.
First, DGA-based domains are valid for a limited time span, thus often change.
Ideally, blacklists would include these domains before they become valid. Second,
most of the domains are never registered or seen active, e.g., when dynamically
analyzing malware samples. Yet, DGA-based malware is on the rise [3], hence
networks protected by blacklists would beneﬁt from DGA-based listings.
We evaluate the coverage of DGA-based domains in the blacklists for ﬁve
prevalent malware families. We implemented the DGAs for these families after
obtaining the algorithms from partners or using reverse engineering. Four fami-
lies generate domains every day, whereas the ZeuS P2P domains are valid for 7
days. We again measure the completeness and determine the reaction time for
each family, i.e., how many days it takes to blacklist a domain once it becomes
valid. We further estimate the rate of registered domains in SMal by leveraging
the recorded DNS data (i.e., we check if the domains resolved to IP addresses at
the time the domains were valid). As the dataset SMal contains all the domains
that were listed by any of the 15 public blacklists at some point in time since
2012, it should also include DGA-based domains that were valid in the past.
SM al
Ratio (%)
SAV
Ratio (%)
-1
1
71
13
1
104
50,500
5
10,000
1,000
75.0
94.3
50.0
4.8
0.0 100.0
1.7
4.5
97.9
99.5
84,136
7,354,415
4,045
8,089,752
131,000
21.9
1.6
18.0
11.7
0.2
15.3
0.2 0.004
0.2
28.9
Bamital