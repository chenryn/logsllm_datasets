### 数据分析

#### 事件数量（单位：千）
- 证明存储增长
- **PrvThings**:
- 响应时间（毫秒）
- (c) 证明查询性能
- **PrvFull**
- **PrvSave**

节点的平均响应时间和查询时间如下：
- 节点的平均响应时间为5毫秒。
- 每个节点生成的活动量较大，导致查询时间较长。
- 查询时间在9毫秒到14毫秒之间。

我们观察到类似的结果，这些结果表明PrvThings能够快速响应取证查询，并且能够在实时环境中检测恶意行为。查询性能受到数据库大小的影响。例如，在一个包含417,380个节点的小数据集中，查询时间为8毫秒；而在较大的数据集中，查询时间分别为14毫秒和PrvFull为14毫秒。

### 用户场景

在本节中，我们将说明PrvThings如何部署并服务于具有不同技术水平的三类用户：
1. **专业人士**：如智能家居平台开发者，调查其客户家庭中的异常行为，制定政策以保护智能家居，并帮助客户排查问题。
2. **技术爱好者**：创建自定义策略的专业人士。
3. **普通消费者**：希望了解并应对智能家居中发生的特殊事件的用户。

#### A. 专业人士

物联网专业人士可以将其部署在其平台内，为客户提供服务。我们将他们进一步分为以下几类：
- **平台开发者**：通过PrvThings调查客户报告的问题，并帮助客户排查异常行为。
- **技术支持人员**：使用PrvThings解决客户报告的问题，并帮助客户排查异常行为。

##### 示例场景

在这个场景中，智能家居客户Alice安装了几个应用，包括“当所有人都离开时”、“离开时锁定”。然而，她发现家中的一些物品被盗。她向管理员报告此事并请求调查。

安装的应用之一包含了恶意载荷（详见附录B）。该应用等待所有人离开后执行攻击命令。经过调查，管理员使用PrvThings来追踪门锁的解锁活动。通过反向查询方法，管理员找到了触发解锁命令的动态函数调用，并发现了攻击者的恶意行为。

管理员还注意到另一个动态函数调用从不受信任的来源获取了状态命令值。基于这些信息，管理员创建了一个新的策略（如图10所示），规定如果某个函数调用使用了外部HTTP输入，则系统将通知管理员。

### 技术支持人员

我们还研究了SmartThings社区论坛中的情况，发现技术支持人员可以使用PrvThings来调试和诊断客户报告的问题。这有助于他们更有效地解决问题。