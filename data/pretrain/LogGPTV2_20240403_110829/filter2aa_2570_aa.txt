**反间谍计划：自建基站与数据嗅探方法论**  
**百度安全实验室 小灰灰**  

### 关于我  
**百度安全实验室 高级安全研究员**  
研究领域：IoT安全/AI安全/无人车安全  
多次破解硬件设备  
**之前负责：**  
- BSRC、应急处置、0day分析  
- 百度产品安全评估  
- 百度安全监控体系建设  

---

### 大纲  
- 联网IOT设备测试目的、测试方法  
- 如何实现自动附着、MITM流量劫持  
- 如何搭建LTE测试基站  
- 漏洞实例介绍  
- 其他测试方法  

---

### 目的及守则  
**目的：**  
- 了解GSM的安全风险  
- 通过搭建测试基站，辅助IOT设备安全漏洞挖掘  
- 增强产品安全性  

**测试守则：**  
- 严格遵守相关法律，不影响正常信道通信  
  - 屏蔽器中/封闭地下室操作  
  - 如条件限制，需调低功率或通过衰减器直连  

---

### 测试目的  
- **控制流量**  
  - 获取流量（敏感数据、接口分析、固件分析、远控&升级分析）  
  - 修改流量（MITM中间人、DNS欺骗）  
  - 访问运营商侧接口（存在漏洞的端口）  
- **控制短信**  
  - 短信下发指令（场景较少）  

---

### 漏洞挖掘方法  
- **获取云端接口**  
  - 攻击云端Web漏洞（注入、升级FTP）  
  - Client重放、越权  
- **获取通讯数据**  
  - 辅助理解流程  
  - 加密信道：分析获取加密密钥，获得加解密能力  
  - 获取密码、Token、Session等关键Key  
  - 获取固件更新链接  
- **修改数据**  
  - 修改配置参数、替换固件  
  - 注入恶意代码（如浏览器RCE）  
- **访问监听端口**  
  - 自身提供管理服务（如Telnet、ADB、SSH）  
  - 分析监听Bin，协议模拟/命令注入/溢出攻击  
- **协议、基带Fuzz**  

---

### 两种测试基站需求场景  
1. **攻击前**  
   - 仅需目标Client连接测试基站  
   - 实现：搭建GSM/LTE基站，通过特殊SIM卡认证  
2. **攻击中**  
   - 强制任意Client从现网切换到攻击基站  
   - GSM网络存在认证问题，可实现  
   - 实现：搭建GSM攻击基站，强制小区重选  

---

### 技术演进与安全问题  
- **G（Generation）发展**  
  - 1G（模拟信号）→ 2G（GSM/CDMA）→ 3G（WCDMA/CDMA2000）→ 4G（LTE）→ 5G  
- **GSM安全缺陷**  
  - 单向鉴权（仅网络验证用户）  
  - 伪造基站可能（伪基站利用此缺陷）  

---

### 伪基站原理  
- **组成**  
  - 收发板（SDR软件无线电）  
  - 放大器、双工器、电源  
  - 外部笔记本+软件（如OpenBTS 2.8）  
- **攻击流程**  
  1. 设置伪基站参数（MCC/MNC与现网一致，LAC不同）  
  2. 触发手机重选小区并发起位置更新请求  
  3. 伪基站获取IMSI后发送伪造短信  
  4. 踢出手机并执行后续攻击（钓鱼、植入木马等）  

---

### 合法测试需求  
- **核心目标**  
  - 不干扰现网通信  
  - 无需大功率设备  
  - 实现小区切换与自动附着