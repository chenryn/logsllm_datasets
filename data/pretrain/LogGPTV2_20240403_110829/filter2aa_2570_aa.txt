反间谍计划： 
⾃自建基站与数据嗅探⽅方法论 
百度安全实验室 ⼩小灰灰 
关于我 
百度安全实验室  ⾼高级安全研究员  
研究领域：IoT安全/AI安全/⽆无⼈人⻋车
安全 
多次破解硬件设备 
之前负责： 
• 
BSRC、应急处置、0day分析 
• 
百度产品 安全评估 
• 
百度安全监控体系建设 
⼤大纲 
•  联⽹网IOT设备测试⽬目的、测试⽅方法 
•  如何实现⾃自动附着、MITM流量量 
•  如何搭建LTE测试基站 
•  漏漏洞洞实例例介绍 
•  其他测试⽅方法 
⽬目的及守则 
•  ⽬目的： 
–  了了解GSM的安全⻛风险 
–  通过搭建测试基站，辅助IOT设备安全漏漏
洞洞挖掘 
–  增强产品安全性 
•  测试守则： 
–  严格遵守相关法律律，不不影响正常信道通信 
•  屏蔽器器中/封闭地下室操作 
•  如实在条件限制，需调低功率/衰减器器直连 
测试⽬目的 
•  控制流量量 
–  获取流量量（敏敏感数据、接⼝口分析、固件分析、远控&升
级分析） 
–  修改流量量（MITM中间⼈人、DNS欺骗） 
–  访问（运营商侧interface访问设备 存在漏漏洞洞的端⼝口） 
•  控制短信 
–  短信下发指令（场景很少） 
漏漏洞洞挖掘⽅方法 
• 
获取云端接⼝口 
– 
攻击云端web漏漏洞洞（注⼊入、升级FTP） 
– 
client重放、越权 
• 
获取通讯数据 
– 
辅助理理解流程 
– 
加密信道：辅助分析获取加密密钥，获得加解密能⼒力力 
– 
获取密码、token、session等关键key 
– 
获取固件更更新链接 
• 
修改数据 
– 
修改配置参数、替换固件 
– 
注⼊入恶意代码，例例如浏览器器RCE 
• 
访问监听端⼝口 
– 
⾃自身提供管理理服务，例例如telnet、adb、ssh 
– 
分析监听bin，协议模拟/命令注⼊入/溢出攻击 
• 
协议、基带Fuzz 
有时是攻击前 
有时在攻击中 
两种测试基站需求场景 
•  攻击前 
–  不不需要任意client⾃自动连⼊入我们的攻击基站 
–  只需要⽬目标client能够连⼊入 
–  实现： 搭建GSM和LTE测试基站，特殊sim卡写卡实现认证 
•  攻击中 
–  需要任意client⾃自动从现⽹网切换到我们的攻击基站 
–  GSM⽹网络存在认证问题，可能实现 
–  实现：搭建GSM攻击基站，通过强制⼩小区重选 连接到攻击
基站 
我们先来实现难的-攻击中基站 
•  ⾃自动连⼊入攻击基站，并且控制流量量 
•  看下腾讯KEEN LAB 攻击宝⻢马⻋车机系统的case 
G -- Generation 
•  1G 模拟信号 ⼤大哥⼤大 
•  2G GSM/CDMA 
•  3G  3GPP  WCDMA/CDMA2000 
•  4G  LTE 
•  5G  ⾼高速率 低延迟 切⽚片 万物互联   
时代进步 -- > 技术升级 
•  部分标准在设计之初没有考虑安全问题 
–  模拟已经不不存在，不不考虑 
–  GSM存在问题，但部分地区已退⽹网不不⽀支持2G 
•  问题已解决？ 
•  No 
–  所有⼿手机都⽀支持2G 
–  ⼤大部分物联⽹网设备通讯模块都⼯工作在2G下（不不要求⾼高速数据） 
GSM安全问题 
• 
2G GSM⽹网络，在设计之初就存在安全问题 
–  单向鉴权⽽而⾮非双向，即只有⽹网络鉴定⽤用户是否合法 
–  导致伪造基站的可能 
伪基站应运⽽而⽣生 
Just给你发了一个发送号码
和内容可以自定义的短信%
伪基站内部探究 
•  收发板（SDR软件⽆无线电） 
•  放⼤大器器（功率） 
•  双⼯工器器、电源 
•  外部笔记本+软件（Openbts 
2.8） 
通过软件模拟+收发
设备实现GSM基站
系统 
伪基站都做了了什什么 
• 
⽤用⼯工程机 找个弱频点，设置MCC、MNC等参数和周围⼀一样 LAC不不⼀一样 
• 
⼿手机获知⼴广播消息，C1C2还很⼤大，呀！这得重选⼩小区到这个伪基站。发
现LAC变了了！这得位置更更新请求 
• 
⼿手机傻乎乎的给鉴权信息，伪基站看也不不看，来者不不拒 
• 
⼿手机在伪基站中，伪基站看IMSI（位置更更新时获取的），嗯，刚刚没发
过短信，发⼀一条 
• 
伪基站利利⽤用完⼿手机了了，然后踢掉它 
• 
开始其他环节（钓⻥鱼、种⻢马、洗卡、售卖） 
•  Just给你发了了⼀一个发送号码和内容可以⾃自定义的短信 
我们需要什什么 
•  不不可以滥发短信，不不需要⼤大功率，不不可以⼲干扰周
边 
•  只需要实现⼩小区切换、⾃自动附着 