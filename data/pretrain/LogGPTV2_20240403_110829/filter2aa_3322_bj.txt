1）主动诱捕：通过实时流量牵引，将指向诱饵的流量牵引到集中
式诱饵资源。
2）多设备仿真：结合云端大数据收集的数百种协议的设备指纹
（banner）库，可模仿几千种网络设备或服务。针对攻击者的一些自
动化的工具探测（如Nmap的端口扫描），可以进行较好的欺骗。
3）资产高仿：一是采用多种手段尽可能与真实资产接近，二是基
于流量数据、资产数据尽可能使仿真的资产与真实资产接近。
4）溯源取证：基于攻击特点将流量分发到对应的蜜罐，并采用主
动跟踪机制对攻击链溯源。通过情报跟踪和攻击者信息汇总跟踪机
制，形成完整的攻击画像图谱。
5）主动反制：对于步入欺骗诱捕平台的攻击者，对其进行一定程
度的反制，包括但不限于通过JSONP来反制、文件下载欺骗反制、
MySQL反制、RDP反制等。攻击反制获取的信息，包括但不限于攻击者
的浏览器隐私数据、主机账号、主机IP及端口开放情况、个人应用账
号及身份ID等。
2. 产品在实战中的应用
1）高仿资产的自动生成。仿真环境或者诱饵的仿真性直接影响蜜
罐系统的成效。在蜜罐部署期需要对业务系统进行调研，根据业务系
统重要性、仿真的工作量、必要性等维度挑选出需要仿真的系统，然
后投入人力对需要仿真的系统进行定制。可以对业务系统进行自动爬
取，并且系统还可以利用流量数据自动化构建服务。
2）协同防御。攻击诱捕系统是企业纵深防御、协同防御中极其重
要的环节，传统蜜罐非常依赖于罐内行为的审计能力，容易游离在企
业的防御体系之外，如果长时间没有明显的诱捕效果，极有可能在企
业的安全体系中被边缘化。攻击诱捕系统可以与未知威胁感知系统的
流量传感器和分析平台进行联动，实现整体的协同，提升蜜罐诱捕的
效果。
蜜罐系统基于SDN技术的网络编排和流量分析系统实时威胁检测能
力，将链路中指定威胁流量牵引至目标蜜罐及蜜网。流量牵引工作在
网络层，不破坏攻击IP与受害IP间的联网结构（见图9-2）。
图9-2 蜜罐系统在实战中的部署位置
攻击IP在扫描或渗透真实受害IP过程中，系统检测到威胁行为
后，会触发SDN联动，实时牵引后续威胁流量至指定蜜罐及蜜网。网络
牵引过程攻击者难以察觉，有效地解决了直接暴露蜜罐给攻击者而导
致的欺骗能力不足的问题。
9.4 终端防护设备
9.4.1 终端安全响应系统
终端安全响应系统（Endpoint Detection and Response，EDR）
是传统终端安全产品在高级威胁检测和响应方面的扩展与补充，它通
过威胁情报、攻防对抗、机器学习等方式，从主机、网络、用户、文
件等维度来评估企业网络中存在的未知风险，并以行为引擎为核心，
利用威胁情报，缩短威胁从发现到处置的时间，有效降低业务损失，
增强可见性，提高整体安全能力。
1. 设备应具备的核心功能
1）提供对终端行为的全面监控与数据采集，包括终端进程、IP访
问、DNS访问、IM传输、邮件传输、U盘传输、浏览器下载、文件操
作、注册表变更、账户变更等。
2）针对不同阶段的攻击路径，提供深度自动化异常检测能力，包
括对PowerShell、wmic等常被利用系统的进程检测以及常用的渗透工
具检测。
3）高可视化溯源分析展示，对可疑进程行为的攻击链路进行完整
溯源，包括所有的危害动作及影响面。
4）支持威胁情报IOC导入，提供IOC检测告警能力，对利用漏洞攻
击行为提供关联CVE信息，并关联受影响终端情况。
5）支持根据自身业务场景需求自行创建自定义异常行为检测条件
来触发告警。
6）支持威胁追踪和迹象数据搜索，例如对IM文件传输、邮件日
志、DNS访问审计、证书、操作系统信息、终端进程信息、IP访问审
计、U盘记录、驱动信息、安装的软件列表等迹象数据的搜索。
7）管理平台界面可对十万级以上客户端进行统一集中管理，包括
但不限于对所有终端的配置策略、威胁事件管理、执行处置操作等。
2. 产品在实战中的应用
通过对用户终端中的安全数据进行采集和检测，所有终端安全数
据经过压缩、加密后保存于大数据平台，结合云端威胁情报与本地分
析平台中的终端行为数据进行对接，从而发现已经感染高级威胁的终
端，对终端快速定位并进行全面的安全评估，发现终端威胁的根本原
因，触发告警从而自动进行响应，斩断威胁的链条。
在终端部署终端安全响应系统的Agent客户端，对数据进行采集和
响应。在服务器端部署终端安全响应系统控制中心（默认控制中心和
采集平台是一体的）；对采集数据进行加密，同时对终端Agent进行采
集策略的制定、告警通知、威胁追踪等。在内网部署大数据分析平
台，实时存储终端的安全数据，对数据与外网威胁情报进行主动检
测，以发现沦陷终端。
9.4.2 服务器安全管理系统
服务器安全管理系统是一种服务器安全产品，通过兼容多种虚拟
化架构和操作系统，帮助企业高效实现混合数据中心架构下的服务器
安全。系统通过服务器端轻量级Agent代理、安全加固服务器系统及应
用WAF探针、RASP探针、内核加固探针，实时、有效地检测与抵御已知
和未知的恶意代码与黑客攻击；通过融合资产管理、微隔离、攻击溯
源、自动化运维、基线检查等功能，高效、安全地运维服务器。
1. 设备应具备的核心功能
1）资产清点：细粒度清点主机、网站、账户、端口、应用等服务
器信息资产，并关联对应的安全风险和漏洞，进行事前防御，缩小攻
击面。
2）基线检查：内置CIS安全检查、等级保护、系统配置核查等多
维度安全基线，并支持自定义设置，进行高效安全自检，及时发现业
务风险和合规风险。
3）安全加固：通过内核探针对服务器进行安全加固，实现禁止非
法提权、禁止恶意代码执行、禁止加载没有数字签名的驱动、文件防
篡改等驱动级安全防护。
4）网络攻击防御：通过Web中间件流量过滤探针，高效检测恶意
网络流量，有效抵御CC攻击、SQL注入、XSS跨站等常规网络攻击；基
于脚本虚拟机（沙箱）的无签名Webshell检测技术，有效检测各种加
密Webshell、变形Webshell等未知安全威胁。
5）运行时应用自我防护：通过RASP技术对应用系统的流量、上下
文、行为进行持续监控，有效检测并防御任意文件读写、命令执行、
文件上传、反序列化、Struts2漏洞、变形Webshell等已知和未知安全
威胁。
6）流可视化与微隔离：流可视化技术能可视化展现业务系统数据
流向，帮助安全运维人员实时、准确把握内网服务器的访问关系（端
口、应用、访问频率）。微隔离技术基于服务器分布式防火墙技术，
可以自定义基于角色、标签的服务器访问控制策略，防止攻击者入侵
内部业务网络后的东西向移动。
7）攻击溯源：基于内核探针和应用探针准确定位攻击者入侵轨
迹，将安全日志聚合，及时发现服务异常登录、应用漏洞、未知
Webshell等多种类型的安全事件，并提供详细的图形化IOC，包含攻击
者IP、攻击目标、操作手段、落地文件等信息，帮助参演单位快速定
位黑客入侵点。
2. 产品在实战中的应用
1）服务器异常行为分析：采用服务行为识别和分析技术，通过关
联主要服务名称（路径）和端口号对服务器的网络外连、命令执行、
文件创建等行为进行监控与学习，并形成行为基线白名单策略。当服
务器存在漏洞并被攻击者利用，产生非白名单范围内的网络外连、命
令执行、文件创建等行为（偏离行为基线）时，系统可进行阻断或告
警。
2）应用动态防护（Runtime application self-protection，
RASP）：对Web应用的文件读写、命令执行、数据库操作、网络连接等
行为进行监控，当发生异常行为时，通过对Web请求的上下文进行分
析，实现对威胁行为的检测及处置。
服务器安全管理系统为软件形态，采用Agent、管理控制中心结合
的方式，为用户解决私有云、公有云和单机主机环境中可能遇到的服
务器管理问题、安全问题、合规问题。
9.4.3 虚拟化安全管理系统
虚拟化安全管理系统是面向云计算或虚拟化环境的一站式安全产
品。产品支持vSphere、XEN、KVM、Hyper-V等虚拟化环境，OpenStack
等云计算平台，提供Hypervisor防护、云主机系统加固、恶意软件防
护、应用程序管控等功能，并支持异构虚拟化平台统一管理，为参演
单位的云数据中心保驾护航。
1. 设备应具备的心功能
1）恶意软件防护：虚拟化安全管理系统防恶意软件模块可提供恶
意软件防护，通过实时扫描、预设扫描及手动扫描，对恶意软件（包
括勒索软件、病毒、蠕虫、木马后门等）采取清除、删除、拒绝访问
或隔离等处理措施。检测到恶意软件时，可以生成警报日志。
2）虚拟防火墙：虚拟化安全管理系统防火墙模块具有企业级、双
向性和状态型特点，可用于启用正确的服务器运行所必需的端口和协
议上的通信，并阻止其他所有端口和协议，降低对服务器进行未授权
访问的风险。
3）入侵防御：虚拟化安全管理系统入侵防御模块能够对暴力破
解、缓冲溢出、漏洞利用等网络攻击行为进行检测和拦截。同时，依
托全球众测网络和威胁预警平台，紧急情况下可对新发现的漏洞攻击
方式提供小时级响应，无须重新启动系统即可在数分钟内将这些规则
应用到数以千计的服务器上，实现虚拟补丁的功能。
4）安全基线：虚拟化安全管理系统对宿主机及虚拟机通过设定预
置检查基线的方式，对目标系统展开安全检查，找出不符合的项目，
选择和实施安全措施来控制安全风险，并通过对历史数据的分析获得
业务系统安全状态和变化趋势，保障云环境的安全。
5）Webshell检测：虚拟化安全管理系统集成了自研的Webshell扫
描引擎，可对各种Webshell后门文件进行扫描与隔离，有效对主机进
行安全加固，抵御来自外来Web漏洞利用的攻击。