lifetimes in Table 4(a). We observe that US has the longest mean
lifetime of 511 weeks by a large margin (China is ranked second at
55.8 weeks), showing a much higher persistence of reported mal-
activity in the US than any other country. Brazil, Canada and the
UK are the next most persistent countries with the longest average
lifetime of 54.8, 37.8 and 37.7 weeks, respectively. At an AS-level,
the most persistent reported AS is “China Telecom Backbone” with
147.0 weeks.
Figure 7b and Table 4(b) suggest that while most IP addresses
have a mean deathtime longer than 100 weeks indicating a low
participation, the “long head” indicates that only a few IPs are
recurring participants. Again with a focus on the AS and country
level, we observed that most ASes and countries are repeat offenders
from the perspective of blacklist reporting. At the country level,
in terms of resiliency (low deathtime), US is ranked first with no
deathtime, followed by Germany (1.50) and British Virgin Islands
(1.60).
For the rate of arrival, we calculate the reciprocal of mean du-
ration and rank the countries accordingly. Table 4(c) shows that
the top 5 countries in terms of arrival rates are Colombia, Panama,
Bahamas, Norway, and Mexico, and constitute the most recurrent
countries to be reported in mal-activity involvement.
We also analyze the churn with respect to mal-activity classes.
From Figure 8a, we can observe that exploits tend to have reports
with the lowest mean lifetime (one week), while the rest of the
mal-activity classes are similar to each other with a heavier concen-
tration at longer weekly durations. In terms of resiliency, phishing
has the lowest deathtime (highest resiliency) as shown in Figure
8b. Due to lower mean deathtime, phishing also has the highest
mean rate of arrival indicated in Figure 8c, implying highly frequent
on-off reporting cycles, i.e., reported (in)active behavior.
Lessons Learned. The analysis shows that a small number of hosts
exhibit high renewal of mal-activities, indicating their presence on
a blacklist has not deterred their activities. The most recurrent IP
has an average report activity cycle of 5.5 weeks. Had this host
been blocked by blacklists, it would have been removed from said
lists in less than 5.5 weeks from the first reports. Thus blacklists
can consider longer durations prior to delisting a malicious host.
Phishing has been observed with the highest resiliency to periods
of no reporting (on average 54 weeks less than all mal-activities
combined), again suggesting delisting or their ability to circumvent
blacklist-based blocking. A overwhelming majority (97.7%) of IP
reports cease activities in 2 weeks, with average cycles of 185 weeks,
the blacklist provider must tradeoff between potential false positives
of hosts which had only been momentarily infected, or curbing the
minority of recurrent hosts.
4.3 Magnitude of Reported Malicious Activities
We define a “severity” metric to quantify the magnitude of the
reported activity during active periods of malicious hosts in the
blacklists. Formally, severity is defined as the average number of
reports of mal-activities per active cycle as per Figure 6. For host i,
let Ki,c denote the total number of reports within the cth period of
𝐿𝐿𝑖𝑖,𝑐𝑐+1𝐿𝐿𝑖𝑖,𝑐𝑐𝐷𝐷𝑖𝑖,𝑐𝑐𝑍𝑍𝑖𝑖(𝑡𝑡)𝑡𝑡𝐾𝐾𝑖𝑖,𝑐𝑐Session 3A: Web Attack MeasurementsAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand201Table 4: Churn Analysis: Top 5 IPs, ASes, and Countries (CC) of Lifetime, Deathtime, and Rate of Arrival.
(a) Average Lifetime - LT (Most Persistent)
IP LT ASN Organization
LT CC LT
4134 CHINANET-BACKBONE, CN 147 US 511
209.85.200.132 62
74.125.201.132 52
39 CN 56
4837 CHINA169-Backbone, CN
38 BR 55
209.85.234.132 48
9800 UNICOM, CN
74.125.70.132 38 32613 IWEB-AS, CA
28 CA 38
74.125.202.132 37 28753 LEASEWEB-DE-FRA-10, DE
26 GB 38
(b) Average Deathtime - DT (Most Resilient)
(c) Rate of Arrival - RoA (Most Frequently Active)
IP DT ASN Organization
103.224.212.222 3.0 36351 SOFTLAYER, US
69.172.201.153 3.1 26496 GO-DADDY, US
DT CC DT
1.5769 US
0
1.6087 DE 1.5
204.11.56.48 3.7 40034 CONFLUENCE-NET., US 1.6122 VG 1.6
1.6780 FR 1.8
213.186.33.19 3.9 13335 CloudFlare, Inc. VG
208.73.211.70 4.2 14618 AMAZON-AES, US
1.8298 NA 2.0
IP RoA ASN Organization
RoA CC RoA
69.172.201.153 0.183 8001 NET-ACCESS-CORP, US 0.177 CO 0.156
0.175 PA 0.148
103.224.212.222 0.176 9931 CAT-AP, TH
0.173 BS 0.142
0.173 NO 0.138
0.169 MX 0.138
208.73.211.70 0.164 46636 NATCOWEB, US
213.186.33.19 0.150 13649 ASN-VINS, US
213.186.33.2 0.146 31103 KEWWEB AG, DE
(a)
(b)
(c)
Figure 7: Churn Analysis: CDFs of IPs, ASes, and Countries (CC) of Lifetime, Deathtime, and Rate of Arrival.
(a)
(b)
Figure 8: Churn Analysis: CDFs of Rate of Arrival (Reciprocal of mean duration), mean Lifetime, and mean Deathtime for mal-activities.
activity5 and as before let Li,c denote the active period (in weeks).
equal to one indicating a unique malicious report per week. The
Then severity of host i, is defined as the average of Ki,c/Li,c over
CDF in Figure 10b indicates that only a few hosts are participating
in a plethora of mal-activities with as little as 200 IP addresses
all cycles of the host i in the dataset. A high severity value indi-
reported to be involved in more than 10K malicious activities per
cates that whenever a host is active (reported in the blacklists) it is
week. Figure 10c shows the CDF of the mean severity values for
accompanied by a large volume of reported mal-activities. Severity
allows us to distinguish between long-living persistent reporting
each of the mal-activity classes. We observe that fraudulent services
are reported in the “low severity” range when compared to the rest
of threats and short-living but denser reporting mal-activities.
of the categories.
We report the results of magnitude analysis in Figure 9. Observe
that 27.4% of ASes and 9.45% of countries have a severity value
(c)
5Care has been taken to remove duplicate reports, i.e., same (time, IP, URL) tuple, from
Blacklist-07-17. In any case, potential duplicates in the 2M reports from Blacklist-07-17
dwarf in comparison to the 49M unique reports obtained from VT.
Table (a) of Figure 9 lists IP addresses, ASes, and countries with
high values of severity. US has the highest severity of 82,558 re-
ports per week. Distant second are countries like China, Germany,
France, and ukraine with severity values of 377, 212, 149, and 80,
Session 3A: Web Attack MeasurementsAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand202Figure 9: Magnitude analysis of top 5 IPs, ASes, and Countries.
ASN Organization
7276
6762
16509 AMAZON-02
35994 AKAMAI-AS
53684
US
UNIVERSITY-OF-HOUSTON 2206
2153
SEABONE-NET, IT
CN
1817 DE
1707
FR
1607
UA
Mag. CC Mag.
82558
377
212
149
80
FLASHPOINT-SC-AS
(a) Top AS, Countries (CC) magnitude offenders
(b) Hosts
(c) Mal-Activities
respectively. This is likely due to the fact that the majority of host-
ing services and Internet users originate from the US. Interestingly
we observe AS7276 (UNIVERSITY-OF-HOUSTON) with 2206 mal-
activities per week as the AS with the highest severity. They were
reported to have participated in all categories of mal-activities ex-
cept Spammers, with 59785 reports in the dataset.
We can observe a large portion of the reported mal-activities
originate from potentially misusing cloud provider services (e.g.,
Amazon Cloud) as these providers are unlikely to be intentionally
propagating their own mal-activity. This inference is consistent
with observations made in previous work [58].
Lessons Learned. Our analysis shows that malware has been the
largest component of reports (90.9%), see Table 2, but when con-
sidering the severity of reports, Malware on average produces 30.8
reports per week, phishing has the next largest severity, with 9.3
reports per week, despite only consisting of 4.74% of our dataset.
On average, malware is approximately 3 times as severe as phishing,
despite there being 19 times more malware reports than there is
Phishing reports. It would be advisable for enforcement agencies
to focus on the primary attack vector that is malware, as disabling
a malware source would yield the largest reduction of reports per
week. Not to discount the impact of shutting down a phishing host,
it too receives a third of the reports as the most severe mal-activity.
5 RELATED WORK
A number of studies have characterized and measured mal-activities,
in addition to proposing detection and/or prevention techniques.
Researchers have also proposed general approaches that rely either
on fundamental characteristics of botnet traffic or by correlating
meta-datasets. For example, several works detect botnets-based
mal-activities by investigating their traffic [34] or typical behav-
ior [40, 51, 60, 64]. Others have investigated multiple datasets includ-
ing web resources from suspicious domains [43] host and network
information [56, 63], honeypots [54] or DNS traffic [61]. Kuhrer
et al. [47] analyze the performance of blacklists, with a forwards-
facing collection of data by archiving it for a duration of two years.
In this paper, we revisit the blacklists utilized by them and with
additional sources, collect a backwards-facing dataset, which is
collected post-factum, covering 10 years prior. Our analysis of the
resulting dataset diverges as we perform the retrospective charac-
terization and measurement of (different classes of) mal-activities.
Using regional Internet registry (RIR) dataset spanning over a
period of 12 years, Dhamdhere et al., [38] define two metrics (at-
tractiveness and repulsiveness) to describe the relationship among
ASes. Compared to our work, Dhamdhere et al., do not focus on
mal-activity reporting, instead focusing on the AS ecosystem as a
whole. Antonakakis et al. [33] study the behavior of Mirai Botnet
activity with a dataset collected in 2016 by industrial partners, to ob-
serve the resilience of Mirai botnet against reverse engineering and
takedowns. Unfortunately this dataset, is not available for further
research, and only focuses on a specific type of mal-activity, whilst
our analysis covers six different classes. Leita et al., [48] propose
“HARMUR” a system that leverages historical archives of malicious
URLs collected by Symantec to detect mal-activities. In conjunc-
tion with publicly available blacklists, DNS reports of malicious
domains, and Symantec’s proprietary malware scanning service to
resolve false-positives, for the collection of malicious URLs. Their
proposal retains a large-scale analysis of the collected dataset as
future work, however there has been no mention of this dataset
to date. It should be noted that HARMUR leverages the historical
information for the purpose of classifying newly observed URLs,
and thus is considered forwards-facing.
By analyzing logs generated by dynamic analysis of malware
samples spanning over a period of 5 years, Lever et al. [49] inves-
tigate the evolution and behavior of the malware and PUP cate-
gories of mal-activities. In contrast, our study retrieves static data
sources that span over 10 years and consists of broader categories
of mal-activities in six classes, with an analysis of infrastructure,
geo-location and behavior over time.
6 CONCLUSION
Researchers and the industry alike find themselves in a continual
arms race to fight against major instances of malicious activity on
the internet. Although longitudinal datasets like ours do exist, they
are mostly proprietary since industries are unable to share it due
to reasons of privacy and to maintain a competitive advantage. In
this paper, we addressed this gap, with a novel methodology that
combined imperfect historical records with machine learning to
produce a decade long mal-activity dataset. To assist the research
community, we have released our dataset into the public domain
for further research:
Session 3A: Web Attack MeasurementsAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand203https://internetmaliciousactivity.github.io/
With our unique dataset, we reflected on the behavior of mal-
activity reporting over the last decade in order to gain insights into
the continuing presence of malicious activity. Our analysis, charac-
terized host behavior among other aspects, recurrent periods, and
severity of mal-activity reporting in a P2P inspired churn model.
Our analysis suggests that tracking the heavy mal-activity contrib-
utors should be an absolute priority for law-enforcement agencies
and major network providers and cloud operators. We found a con-
sistent minority of heavy offenders (i.e., IPs, ASes, and countries)
that contribute a majority of mal-activity reports, posing a severe
threat to the status-quo of our online ecosystem. We observed a
number of hosts with a short renewal cycle of “(in)activity”. Their
presence on a blacklist has not deterred their activities. Had the host
been effectively blocked by blacklists, the renewal of their activity
indicates the removal of the host from said blacklists suggesting a
need to consider longer durations prior to delisting a malicious host.
Detecting and quickly reacting to the emergence of such heavy
mal-activity contributors would arguably significantly reduce the
damage inflicted by them.
REFERENCES
[1] 360mirascanner dataset. http://data.netlab.360.com/mirai-scanner/.
[2] Android Malware Tracker. https://amtrckr.info.
[3] AS Rank: AS Ranking - CAIDA. http://as-rank.caida.org.
[4] CIPB - Allocation of IP addresses by Country. https://www.countryipblocks.net/
allocation-of-ip-addresses-by-country.php.
[5] CruzIT.com Server Blocklist. http://www.cruzit.com/wbl.php.
[6] Cybercrime blacklist. http://cybercrime-tracker.net/.
[7] Dshield list. https://www.dshield.org/suspicious_domains.html.
[8] Feodo botnet tracker. https://feodotracker.abuse.ch/.
[9] Financial Cyber Threats in 2013. Part 1: Phishing. https://securelist.com/
financial-cyber-threats-in-2013-part-1-phishing/59411/.
[10] GeoIP Products–MaxMind Developer Site. http://dev.maxmind.com/geoip/.
[11] h3x – Malware Corpus Tracker. https://tracker.h3x.eu.
[12] hphosts lists. https://www.hosts-file.net/.
[13] Internet archive: Wayback machine. https://archive.org/web/.
[14] malc0de blacklist. http://malc0de.com/database/.
[15] Malware domain list. https://www.malwaredomainlist.com/.
[16] MalwareBlackList. http://www.malwareblacklist.com/showMDL.php.
[17] Malwareurl dataset. https://www.malwareurl.com/. The dataset is no longer
publicly available, access via wayback machine.
[18] Openphish dataset. https://openphish.com/.
[19] Palevotracker dataset. https://web.archive.org/web/*/http://palevotracker.abuse.
ch/. Currently discontinued, pre-2017 access through Wayback Machine.
[20] Phishtank: Out of the net, into the tank. https://www.phishtank.com/.
[21] Potaroo: BGP Reports. http://bgp.potaroo.net/as1221/.
[22] Ransomeware tracker list. https://ransomwaretracker.abuse.ch/.
[23] Route views project. http://www.routeviews.org/.
[24] Sambreel is Still Injecting Ads. Video Advertisers, Beware. http://spider.io/blog/
2013/08/sambreel-is-still-injecting-ads-video-advertisers-beware.
[25] Shodan. https://www.shodan.io.
[26] Spamhaus feeds. https://www.spamhaus.org/.
[27] Spyeye dataset. https://web.archive.org/web/*/https://spyeyetracker.abuse.ch/.