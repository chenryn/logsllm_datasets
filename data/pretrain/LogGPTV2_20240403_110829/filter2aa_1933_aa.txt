Bluesnarﬁng @ CeBIT 2004
Detecting and Attacking bluetooth-enabled Cellphones at the
Hannover Fairground
Dipl.-Ing.(FH) Martin Herfurt
Salzburg Research Forschungsgesellschaft mbH, Austria
PI:EMAIL
March 30, 2004
Abstract
A big shock went through the community when it became public, that some
bluetooth-enabled handsets are disclosing personal information. The informa-
tion posted on [1] introduces three basic ways to attack bluetooth-enabled de-
vices. This report brieﬂy describes the SNARF exploit for the recently discov-
ered bluetooth security loophole that is not requiring any kind of preparation
or prior manipulation of the devices.
1
Introduction
SNARF and bluesnarﬁng are words that have been spooking through the Internet
during the last months. These words relate to a recently discovered security ﬂaw in
bluetooth-enabled devices. This report is about a ﬁeld-trial that has evaluated this
security loophole at the CeBIT 2004 in Hannover.
1.1
Bluetooth Security Issues
End of November 2003 Adam and Ben Laurie (A.L. Digital Ltd.) published a doc-
ument [1] on the Internet stating that some bluetooth-enabled phones are having
serious security ﬂaws. These ﬂaws allow attackers to connect to the device without
permission (no pairing) and carry out a so-called SNARF attack.
In the beginning of February 2004, the fact that some bluetooth-enabled handsets
are having security issues made it into many news-tickers around the globe. Most
of the news-sites pretended that exploit-tools were available in the Internet. But
even extensive research in the Internet did not bring up the location where these
1
tools were available.
As described in [1], the SNARF attack enables access to restricted portions of the
device. SNARF is a word coming from computer-hacker jargon. To snarf something
means “to grab a large document or ﬁle and use it without the author’s permission”[2].
So it is possible to, for example read out the affected devices’ phone books. These
phone books contain numbers and associated names of persons that are either stored
in the device phone-book, on the SIM card or in the lists of missed, received or di-
aled contacts. It is also possible to retrieve and send SMS messages from the affected
phone or to initiate phone calls to any existing number (this feature is of special in-
terest if you are the running a premium service number yourself ;-).
In theory, all supported AT-commands could be issued to the respective device, but
according to statements of the manufacturers some of the commands are not per-
mitted by means of this disallowed connection. But there would be no reason of
preventing commands from a connection that the ﬁrmware discloses by accident.
1.2
CeBIT 2004
The CeBIT is one of the events, where people go that are into computers and new
technologies. Compared to other groups this group of people tends to use their de-
vices differently. It is more likely that these people are active bluetooth users. So
at the CeBIT fairground optimal preconditions for the evaluation of these devices’
security are given.
The CeBIT is Europe’s biggest IT-exposition and takes place every year at the Han-
nover fairground in the north of Germany. As in the years 2002 and 2003, Salzburg
Research together with the Salzburg University of Applied Sciences and Technolo-
gies had a booth at the CeBIT 2004 located in Hall 11. There, in the so-called future
park, all research and education companies and institutes are located. Favorably,
the Salzburg Research booth was located close to the public restrooms, where more
people tend to pass by than at other places in this hall. At this location, an envi-
ronment for the discovery and the attacking of bluetooth-enabled devices was set
up.
2
The Bluesnarf Field Trial
The environment was build up by open-source software ran on a laptop computer.
2.1
The Environment Setup
The hardware used for this trial was a COMPAQ Evo N600c with two low-cost MSI
bluetooth USB-dongles. The software used with this hardware was linux-2.6.2
2
together with Qualcomm’s bluetooth stack implementation Bluez (bluez-libs-2-
.5,bluez-utils-2.4 and bluez-sdp-1.5). The actual application was imple-
mented in PERL and C. For better data-mining capabilities, an enterprise-level SQL-
DBMS (postgresql-7.4.1) has been used in order to store and access the col-
lected device-information.
2.2
Collected Data Samples and Results
In total, 1269 different devices have been discovered in the period from March 18th
to 21st March 2004 at the place described above. Due to the limited range of about
ten meters, not all of the bluetooth-enabled devices at this place could have been
detected. But still, the number of discovered devices is very high.
2.2.1
Discovered Device Vendors
Figure 1 shows a diagram that represents the distribution of manufacturers. The
determination of the vendor is done by means of the bluetooth address. Similar
to the hardware-address (MAC address) of Ethernet network interface cards, also
the bluetooth address refers to the manufacturer of the bluetooth chip-set. Table 1
shows the vendor and the three ﬁrst bytes of the bluetooth addresses that are asso-
ciated with the respective vendor. Also a value expressing the distribution among
the vendors is provided in this table.
The 70 percent of discovered Nokia handsets clearly represent Nokia’s market-
Nokia
SonyEricsson
Siemens
Unrecognized
Other
Figure 1: Device Vendor Distribution
leadership in Europe. Interestingly, many companies use the Nokia 6310i as a com-
pany phone. One possible reason for this could be the compatibility to the Nokia
car-kits that have been installed over years in many company cars.
3
Vendor
Address-Bytes
Percentage
Nokia
00:02:EE , 00:60:57 , 00:E0:03
70
SonyEricsson
00:0A:D9
11.35
Siemens
00:01:E3
8.2
Unknown
miscellaneous
8.1
Other
miscellaneous
2.1
Table 1: Device Vendors
2.2.2
Discovered Models
It cannot be determined from the device’s bluetooth address which model of the
respective vendor this is. Therefore, the bluetooth name that on many devices de-
faults to the model number has been used to identify the model of the discovered
device. The bluetooth name of the devices can be set by the user and is therefore not
itself a reliable information to determine the model number. It is worth mentioning
that many people use their full name as an identiﬁcation for their device.
The tables 2, 3 and 4 show the numbers of models that could have been uniquely
determined by their names. So, this graph is not totally correct, but gives a coarse
idea on the vendor/model distribution.
The graph displayed in ﬁgure 2 supports the assumption that has been made before,
that obviously many companies are using the Nokia 6310i phone for their employ-
ees.
The high popularity of the T610 phone is reﬂected by the diagram presented in
Unrecognized
6310/6310i
6600
3650
7650
Figure 2: Nokia Model Distribution
ﬁgure 3. Also the current top-of-the-line model (the P900) has been discovered com-
parably often.
4
Device
Number
Percentage
Unrecognized
669
75.1
Nokia 6310/6310i
135
15.2
Nokia 6600
48
5.4
Nokia 3650
28
3.1
Nokia 7650
11
1.2
Table 2: Recognized Nokia Models
Characteristic for the German/European market was the relatively high presence
Unrecognized
T610
P900
P800
Figure 3: SonyEricsson Model Distribution
Device
Number
Percentage
Unrecognized
106
72.1
SonyEricsson T610
33
22.5
SonyEricsson P900
7
4.8
SonyEricsson P800
1
0.6
Table 3: Recognized SonyEricsson Models
of Siemens phones. At the moment, only the phones belonging to the 55 series and
the new SX1 are supporting bluetooth.
5
Unrecognized
S55/SL55
SX1
Figure 4: Siemens Model Distribution
Device
Number
Percentage
Unrecognized
69
66.3
Siemens S55/SL55