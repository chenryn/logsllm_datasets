            0xEC68D02B, 0x4A1FDB9F, 0x7BF7C102, 0xDD80CAB6,
            0x1827F438, 0xBE50FF8C, 0x8FB8E511, 0x29CFEEA5,
            0xDF879E4C, 0x79F095F8, 0x48188F65, 0xEE6F84D1,
            0x2BC8BA5F, 0x8DBFB1EB, 0xBC57AB76, 0x1A20A0C2,
            0x8816EAF2, 0x2E61E146, 0x1F89FBDB, 0xB9FEF06F,
            0x7C59CEE1, 0xDA2EC555, 0xEBC6DFC8, 0x4DB1D47C,
            0xBBF9A495, 0x1D8EAF21, 0x2C66B5BC, 0x8A11BE08,
            0x4FB68086, 0xE9C18B32, 0xD82991AF, 0x7E5E9A1B,
            0xEFC8763C, 0x49BF7D88, 0x78576715, 0xDE206CA1,
            0x1B87522F, 0xBDF0599B, 0x8C184306, 0x2A6F48B2,
            0xDC27385B, 0x7A5033EF, 0x4BB82972, 0xEDCF22C6,
            0x28681C48, 0x8E1F17FC, 0xBFF70D61, 0x198006D5,
            0x47ABD36E, 0xE1DCD8DA, 0xD034C247, 0x7643C9F3,
            0xB3E4F77D, 0x1593FCC9, 0x247BE654, 0x820CEDE0,
            0x74449D09, 0xD23396BD, 0xE3DB8C20, 0x45AC8794,
            0x800BB91A, 0x267CB2AE, 0x1794A833, 0xB1E3A387,
            0x20754FA0, 0x86024414, 0xB7EA5E89, 0x119D553D,
            0xD43A6BB3, 0x724D6007, 0x43A57A9A, 0xE5D2712E,
            0x139A01C7, 0xB5ED0A73, 0x840510EE, 0x22721B5A,
            0xE7D525D4, 0x41A22E60, 0x704A34FD, 0xD63D3F49,
            0xCC1D9F8B, 0x6A6A943F, 0x5B828EA2, 0xFDF58516,
            0x3852BB98, 0x9E25B02C, 0xAFCDAAB1, 0x09BAA105,
            0xFFF2D1EC, 0x5985DA58, 0x686DC0C5, 0xCE1ACB71,
            0x0BBDF5FF, 0xADCAFE4B, 0x9C22E4D6, 0x3A55EF62,
            0xABC30345, 0x0DB408F1, 0x3C5C126C, 0x9A2B19D8,
            0x5F8C2756, 0xF9FB2CE2, 0xC813367F, 0x6E643DCB,
            0x982C4D22, 0x3E5B4696, 0x0FB35C0B, 0xA9C457BF,
            0x6C636931, 0xCA146285, 0xFBFC7818, 0x5D8B73AC,
            0x03A0A617, 0xA5D7ADA3, 0x943FB73E, 0x3248BC8A,
            0xF7EF8204, 0x519889B0, 0x6070932D, 0xC6079899,
            0x304FE870, 0x9638E3C4, 0xA7D0F959, 0x01A7F2ED,
            0xC400CC63, 0x6277C7D7, 0x539FDD4A, 0xF5E8D6FE,
            0x647E3AD9, 0xC209316D, 0xF3E12BF0, 0x55962044,
            0x90311ECA, 0x3646157E, 0x07AE0FE3, 0xA1D90457,
            0x579174BE, 0xF1E67F0A, 0xC00E6597, 0x66796E23,
            0xA3DE50AD, 0x05A95B19, 0x34414184, 0x92364A30
        }, {
            0x00000000, 0xCCAA009E, 0x4225077D, 0x8E8F07E3,
            0x844A0EFA, 0x48E00E64, 0xC66F0987, 0x0AC50919,
            0xD3E51BB5, 0x1F4F1B2B, 0x91C01CC8, 0x5D6A1C56,
            0x57AF154F, 0x9B0515D1, 0x158A1232, 0xD92012AC,
            0x7CBB312B, 0xB01131B5, 0x3E9E3656, 0xF23436C8,
            0xF8F13FD1, 0x345B3F4F, 0xBAD438AC, 0x767E3832,
            0xAF5E2A9E, 0x63F42A00, 0xED7B2DE3, 0x21D12D7D,
            0x2B142464, 0xE7BE24FA, 0x69312319, 0xA59B2387,
            0xF9766256, 0x35DC62C8, 0xBB53652B, 0x77F965B5,
            0x7D3C6CAC, 0xB1966C32, 0x3F196BD1, 0xF3B36B4F,
            0x2A9379E3, 0xE639797D, 0x68B67E9E, 0xA41C7E00,
            0xAED97719, 0x62737787, 0xECFC7064, 0x205670FA,
            0x85CD537D, 0x496753E3, 0xC7E85400, 0x0B42549E,
            0x01875D87, 0xCD2D5D19, 0x43A25AFA, 0x8F085A64,
            0x562848C8, 0x9A824856, 0x140D4FB5, 0xD8A74F2B,
            0xD2624632, 0x1EC846AC, 0x9047414F, 0x5CED41D1,
            0x299DC2ED, 0xE537C273, 0x6BB8C590, 0xA712C50E,
            0xADD7CC17, 0x617DCC89, 0xEFF2CB6A, 0x2358CBF4,
            0xFA78D958, 0x36D2D9C6, 0xB85DDE25, 0x74F7DEBB,
            0x7E32D7A2, 0xB298D73C, 0x3C17D0DF, 0xF0BDD041,
            0x5526F3C6, 0x998CF358, 0x1703F4BB, 0xDBA9F425,
            0xD16CFD3C, 0x1DC6FDA2, 0x9349FA41, 0x5FE3FADF,
            0x86C3E873, 0x4A69E8ED, 0xC4E6EF0E, 0x084CEF90,
            0x0289E689, 0xCE23E617, 0x40ACE1F4, 0x8C06E16A,
            0xD0EBA0BB, 0x1C41A025, 0x92CEA7C6, 0x5E64A758,
            0x54A1AE41, 0x980BAEDF, 0x1684A93C, 0xDA2EA9A2,
            0x030EBB0E, 0xCFA4BB90, 0x412BBC73, 0x8D81BCED,
            0x8744B5F4, 0x4BEEB56A, 0xC561B289, 0x09CBB217,
            0xAC509190, 0x60FA910E, 0xEE7596ED, 0x22DF9673,
            0x281A9F6A, 0xE4B09FF4, 0x6A3F9817, 0xA6959889,
            0x7FB58A25, 0xB31F8ABB, 0x3D908D58, 0xF13A8DC6,
            0xFBFF84DF, 0x37558441, 0xB9DA83A2, 0x7570833C,
            0x533B85DA, 0x9F918544, 0x111E82A7, 0xDDB48239,
            0xD7718B20, 0x1BDB8BBE, 0x95548C5D, 0x59FE8CC3,
            0x80DE9E6F, 0x4C749EF1, 0xC2FB9912, 0x0E51998C,
            0x04949095, 0xC83E900B, 0x46B197E8, 0x8A1B9776,
            0x2F80B4F1, 0xE32AB46F, 0x6DA5B38C, 0xA10FB312,
            0xABCABA0B, 0x6760BA95, 0xE9EFBD76, 0x2545BDE8,
            0xFC65AF44, 0x30CFAFDA, 0xBE40A839, 0x72EAA8A7,
            0x782FA1BE, 0xB485A120, 0x3A0AA6C3, 0xF6A0A65D,
            0xAA4DE78C, 0x66E7E712, 0xE868E0F1, 0x24C2E06F,
            0x2E07E976, 0xE2ADE9E8, 0x6C22EE0B, 0xA088EE95,
            0x79A8FC39, 0xB502FCA7, 0x3B8DFB44, 0xF727FBDA,
            0xFDE2F2C3, 0x3148F25D, 0xBFC7F5BE, 0x736DF520,
            0xD6F6D6A7, 0x1A5CD639, 0x94D3D1DA, 0x5879D144,
            0x52BCD85D, 0x9E16D8C3, 0x1099DF20, 0xDC33DFBE,
            0x0513CD12, 0xC9B9CD8C, 0x4736CA6F, 0x8B9CCAF1,
            0x8159C3E8, 0x4DF3C376, 0xC37CC495, 0x0FD6C40B,
            0x7AA64737, 0xB60C47A9, 0x3883404A, 0xF42940D4,
            0xFEEC49CD, 0x32464953, 0xBCC94EB0, 0x70634E2E,
            0xA9435C82, 0x65E95C1C, 0xEB665BFF, 0x27CC5B61,
            0x2D095278, 0xE1A352E6, 0x6F2C5505, 0xA386559B,
            0x061D761C, 0xCAB77682, 0x44387161, 0x889271FF,
            0x825778E6, 0x4EFD7878, 0xC0727F9B, 0x0CD87F05,
            0xD5F86DA9, 0x19526D37, 0x97DD6AD4, 0x5B776A4A,
            0x51B26353, 0x9D1863CD, 0x1397642E, 0xDF3D64B0,
            0x83D02561, 0x4F7A25FF, 0xC1F5221C, 0x0D5F2282,
            0x079A2B9B, 0xCB302B05, 0x45BF2CE6, 0x89152C78,
            0x50353ED4, 0x9C9F3E4A, 0x121039A9, 0xDEBA3937,
            0xD47F302E, 0x18D530B0, 0x965A3753, 0x5AF037CD,
            0xFF6B144A, 0x33C114D4, 0xBD4E1337, 0x71E413A9,
            0x7B211AB0, 0xB78B1A2E, 0x39041DCD, 0xF5AE1D53,
            0x2C8E0FFF, 0xE0240F61, 0x6EAB0882, 0xA201081C,
            0xA8C40105, 0x646E019B, 0xEAE10678, 0x264B06E6
        }
    };
crc_macros.h
    #ifdef WORDS_BIGENDIAN
    #   define A(x) ((x) >> 24)
    #   define B(x) (((x) >> 16) & 0xFF)
    #   define C(x) (((x) >> 8) & 0xFF)
    #   define D(x) ((x) & 0xFF)
    #   define S8(x) ((x) > 24)
    #   define B(x) (((x) >> 16) & 0xFF)
    #   define C(x) (((x) >> 8) & 0xFF)
    #   define D(x) ((x) & 0xFF)
    #   define S8(x) ((x) << 8)
    #   define S32(x) ((x) << 32)
    #endif
stream_flags_common.c
    const uint8_t lzma_header_magic[6] = { 品牌字符串 };
重新编译xz
    cd xz-5.6.2
    ./configure
    make
下载squashfs-tools源码，对源码中的./suqashfs文件夹下的squashfs_fs.h文件SQUASHFS_MAGIC值做如下修改
    #define SQUASHFS_MAGIC          0x6563696e
    #define SQUASHFS_MAGIC_SWAP     0x6e696365
重新./make编译squashfs-tools源码，得到unsquashfs程序，
并执行以下命令
    export LD_PRELOAD=/usr/local/lib/liblzma.so
    ./unsquashfs xxx_fs.bin 
可以成功解出文件系统
## 总结
某T路由器固件的解压逻辑即将解压逻辑写入linux内核中，在内核系统启动过程中，会将要更新的文件系统解压出来，解压过程有自修改后的文件系统头和xxx_crc32_le等函数校验过程，所以想要直接使用binwalk之类的工具提取固件中的文件系统会失败，要想解压出文件系统需要绕过crc校验函数或者对xz工具中的crc32_fast.c中lzma_crc32函数进行修改。
* * *