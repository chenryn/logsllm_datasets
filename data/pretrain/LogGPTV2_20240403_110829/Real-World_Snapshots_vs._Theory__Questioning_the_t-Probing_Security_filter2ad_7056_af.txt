share implementation, it took 24 hours to capture snapshots
of all registers in 12 clock cycles, see Section VI-D. The
time fraction for a single LAB (16 registers) is 2.67 min. Note
that autofocus and drift correction signiﬁcantly contribute to
that time. However, the LLSI scan, which creates the actual
snapshot of the registers, takes only around 65 s. Therefore,
using a more stable optical setup, the acquisition time could
potentially be reduced by up to 60%. Furthermore, the registers
on the used FPGA are spread over the device with much
space in between. On an ASIC implementation, the registers
are potentially placed closer together, and thus, a smaller area
needs to be imaged by LLSI. Nevertheless, we consider the
measurement time of our setup not as a hurdle for an attacker,
© 2020 IEEE
12
it
because the measurements are fully automated and hence
can run unsupervised without the presence of an operator.
Therefore, we think that – concerning measurement time –
our approach is practically feasible in a real scenario.
While laser scanning microscopes are not as cheap as typical
oscilloscopes for power/EM analysis, they are common FA
equipment. They can be rented for about $300/h including an
operator from different FA labs. Therefore, depending on the
attack scenario, one can estimate the cost of such attacks based
on the number of shares and the size of the die. For instance,
the estimated cost to perform LLSI for the known layout of
3-share and 5-share masked AES implementations would be
$325 (65 min.) and $540 (108 min.), respectively. Naturally,
the cost for an unknown layout would increase, since several
snapshots from the entire die have to be taken. However, the
cost would increase only linearly by the number of registers
on the chip. The estimated cost to mount LLSI attack against
an unknown layout with 2-share masked AES implementation
would be $7200 (24 hours).
4) Optical resolution and register size:
In the FA com-
munity, optical probing has been shown to be applicable
even to the 10 nm technology node by using a Solid Immer-
sion Lens (SIL), leading to an optical resolution of around
200 nm [40], [76]. For smaller technology nodes, a higher
resolution can be achieved in the visible light regime [77],
[78]. For our experiments, we did not use an SIL; hence, the
resolution is ≈ 1 µm due to the wavelength of the laser. This
resolution might seem low for the DUT manufactured in a
60 nm technology. However, unlike IC failure analysis, the
security evaluation of ICs does not have to rely on targeting a
single transistor; therefore, optical resolution requirements can
be relaxed to a certain extent. The comparison of technology
size and optical resolution often misleads to the assumption
that optical probing is not possible for small technology sizes.
This has already been shown wrong in [48], where extracting
the bitstream from a 28 nm FPGA was demonstrated.
The size of the area which we used to extract the logic state
of one register from, has a dimension of about 7 µm× 9 µm
for our DUT manufactured in a 60 nm technology. This area
contains multiple transistors. For traditional optical probing
techniques, like EOP, the distance between transistors is crit-
ical for being able to extract the waveform from exactly one
transistor and not a mixture of different signals. However,
for LLSI,
is not crucial whether the laser spot covers
multiple transistors at a time or not. As long as different
signatures for different logic states can be observed in the LLSI
measurements, the stored data can be extracted successfully.
5) Chip preparation and silicon access: For our attack, we
had to depackage the target chip and mount it upside-down on
a customized PCB to establish access to the silicon backside.
This makes the attack semi-invasive, and one might argue that
the effort for chip preparation puts a too high hurdle on the
attacker. However, note that modern chips are increasingly
manufactured in ﬂip-chip packages, due to performance, size,
cost, and environmental compatibility reasons [79]. Here the
silicon backside is directly exposed to the attacker, and no
chip preparation is necessary. Therefore, depending on the chip
packaging, our attack can also be non-invasive, cf. [48].
B. Theory vs. Practice
It is tempting to claim that our results rule out the ap-
plication of the t-probing model as presented in [5]. In this
regard, we highlight two main points. First, our attack falls
only partially within that framework as it requires that the
t probes should not move within a time period. Second, but
more interestingly, our results demonstrate that some of the
assumptions made in [5] do not always hold in reality. More
concretely, in [5] and its follow-up studies, the measure of the
cost of a probing attack is associated with the value t, which
is shown to be ineffective for our attack. For this purpose, for
a practically feasible, yet more powerful adversary mounting
our proposed attack, the spatial coverage and/or the resolution
of the probe play a much more vital role. Moreover, it is
claimed in [5] that, even in the presence of a fully adaptive
adversary moving the probes within a clock cycle, the security
is guaranteed as long as the total number of probes in each
clock cycle does not exceed t. Conversely, we present a
powerful new attacker, who is not limited by the number of
probes as long as she can manipulate the usual functionality
of the clock, which is very likely as explained above and also
practically demonstrated by us. To sum this up, the existence
of such powerful attackers suggests that the model presented
in [5] should be revisited. Of course, the cost for such powerful
attackers is higher than that for a classical SCA attack, and
there is certainly a trade-off between the cost and the gain
depending on the value of the secrets stored in the device.
C. Potential Countermeasures
Our attack consists of four main steps, namely i) accessing
the IC backside, ii) modulating the power supply, iii) scanning
with a thermal laser, and iv) localizing the key/state registers.
Possible countermeasures can be designed and integrated into
the chip to prevent each step.
1) Package-level countermeasures: The optical access to
the backside of the chip can be prevented after the fabrication
and during the packaging of the die. For instance, active back-
side coatings [80] can make the backside of the chip opaque
to the laser scanning microscopy. Since these coatings interact
with the transistors, they can detect any tampering attempt.
Unfortunately, passive coating layers are not effective since
they can be removed mechanically without any consequences.
2) Device-level countermeasures: To take a snapshot from
the hardware, the core voltage of the device needs to be mod-
ulated with a speciﬁc frequency during the laser irradiation on
the transistors. For preventing the modulation of the supply
voltage, internal voltage regulators can be integrated into the
circuit to isolate the supply voltage of secure cores from the
outside of the device and keep the core voltage constant. Such
regulators have already been proposed to defeat power and EM
SCAs [81]. As a side note, supplying a voltage regulator by a
low voltage (close to its predeﬁned output level) can lead to an
unstable output or a transparency between input and output.
© 2020 IEEE
13
While the former case already might be sufﬁcient for LLSI,
in the latter case, the adversary becomes able to modulate
the internal supply voltage at her will. Moreover, distributed
temperature sensors can be deployed on the die to detect local
temperature variations resulting from the laser beam. However,
it should be noted that such temperature sensors have to
operate independently from the main system clock; otherwise,
they will also be deactivated by halting the clock. Since the
wavelength of the thermal lasers is larger than the bandgap
of the silicon, no electron-hole pairs are generated upon the
incident of photons, and therefore, conventional silicon-based
light sensors do not trigger. Temperature sensors can be either
realized by timing-sensitive circuits (e.g., ring-oscillators [82])
or speciﬁc materials with longer bandgap wavelengths.
3) Circuit-level countermeasures: A possible way to defeat
our proposed attack is to change the location of registers
dynamically. It cannot be done physically, but it seems to be
possible logically. Suppose that every single bit is allowed
to be stored in a set of k registers. Having n bits, k × n
register cells are required. In addition to this overhead, a
mechanism is required to assign one of such k register cells to
a single-bit value, dynamically selected at every clock cycle,
and independent of other single-bit values. Indeed, we need
to randomize the location of registers, independent of any
masking scheme integrated to defeat classical SCA attacks.
Realizing this might be possible by a form of reconﬁgurability.
To the best of our knowledge, there is no such a scheme known
to the hardware security community, and therefore, it is among
our planned future works.
VIII. CONCLUSION
Masking is the most effective protection for cryptographic
implementations against (passive) SCA attacks. The mathe-
matical proof of the probing security models, however, as-
sumes a limited number of probes available to the attacker.
This assumption holds for virtually all practically feasible SCA
attacks reported so far. We introduced a new optical attack ap-
proach that can capture hardware snapshots of the IC’s entire
logic state. It is a single-trace technique offering a number
of probes that is only bounded by the number of transistors
on the chip. We showed that extracting the keys from 2-, 3-
and 5-share AES-128 implementations is practically feasible,
even when the exact register locations are not known to the
attacker. Due to the practically unlimited number of probes in
our attack, implementations with higher protection orders (i.e.,
with a high number of shares) are vulnerable as well. The com-
plexity of the attack depends on the design architecture, the
number of shares, and the knowledge of the adversary about
the underlying implementation. The results conﬁrm (again)
that cryptography should not rely on complexity of physical
attacks. Moreover, assumptions made in theoretical models
can be invalidated through more advanced FA techniques, and
hence, one should not underestimate them. We believe that
the integration of countermeasures to defeat our attack is not a
trivial task. Nevertheless, we gave an overview of the potential
countermeasures at different levels of abstraction.
ACKNOWLEDGMENT
The work described in this paper has been supported
in part by the Einstein Foundation in form of an Einstein
professorship - EP-2018-480, and in part by the Deutsche
Forschungsgemeinschaft (DFG, German Research Foundation)
under Germany’s Excellence Strategy - EXC 2092 CASA
- 390781972. The authors would also like to acknowledge
Hamamatsu Photonics K.K. Japan and Germany for their help
and support on the PHEMOS system. The authors declare no
other ﬁnancial and non-ﬁnancial competing interests.
REFERENCES
[1] P. C. Kocher, “Timing Attacks on Implementations of Difﬁe-Hellman,
RSA, DSS, and Other Systems,” in CRYPTO ’96, ser. LNCS, vol. 1109.
Springer, 1996, pp. 104–113.
[2] P. C. Kocher, J. Jaffe, and B. Jun, “Differential Power Analysis,” in
CRYPTO ’99, ser. LNCS, vol. 1666. Springer, 1999, pp. 388–397.
[3] D. Agrawal, B. Archambeault, J. R. Rao, and P. Rohatgi, “The EM Side-
Channel(s),” in CHES 2002, ser. LNCS, vol. 2523. Springer, 2002, pp.
29–45.
[4] J. Ferrigno and M. Hlav´ac, “When AES blinks: introducing optical side
channel,” IET Information Security, vol. 2, no. 3, pp. 94–98, 2008.
[5] Y. Ishai, A. Sahai, and D. A. Wagner, “Private Circuits: Securing
Hardware against Probing Attacks,” in CRYPTO 2003, ser. LNCS.
Springer, 2003, vol. 2729, pp. 463–481.
[6] Kleindiek Nanotechnik GmbH. (2020) Prober Shuttle (PS8). [Online].
Available: https://www.nanotechnik.com/ps8.html
[7] R. Specht, V. Immler, F. Unterstein, J. Heyszl, and G. Sigl, “Dividing the
threshold: Multi-probe localized EM analysis on threshold implementa-
tions,” in HOST 2018.
IEEE Computer Society, 2018, pp. 33–40.
[8] A. Duc, S. Dziembowski, and S. Faust, “Unifying Leakage Models:
From Probing Attacks to Noisy Leakage,” J. Cryptology, vol. 32, no. 1,
pp. 151–177, 2019.
[9] E. Prouff, M. Rivain, and R. Bevan, “Statistical Analysis of Second
Order Differential Power Analysis,” IEEE Trans. Computers, vol. 58,
no. 6, pp. 799–811, 2009.
[10] E. Carmon, J.-P. Seifert, and A. Wool, “Photonic Side Channel Attacks
Against RSA,” in 2017 IEEE International Symposium on Hardware
Oriented Security and Trust (HOST).
IEEE, 2017, pp. 74–78.
[11] R. Primas, P. Pessl, and S. Mangard, “Single-Trace Side-Channel Attacks
on Masked Lattice-Based Encryption,” in CHES 2017, ser. LNCS, vol.
10529. Springer, 2017, pp. 513–533.
[12] K. J¨arvinen and J. Balasch, “Single-Trace Side-Channel Attacks on
Scalar Multiplications with Precomputations,” in CARDIS 2016, ser.
LNCS, vol. 10146. Springer, 2016, pp. 137–155.
[13] M. Alam, H. A. Khan, M. Dey, N. Sinha, R. L. Callan, A. G. Zajic,
and M. Prvulovic, “One&done: A single-decryption em-based attack
on openssl’s constant-time blinded RSA,” in USENIX Security 2018.
USENIX Association, 2018, pp. 585–602.
[14] L. Lerman, R. Poussier, G. Bontempi, O. Markowitch, and F. Standaert,
“Template Attacks vs. Machine Learning Revisited (and the Curse
of Dimensionality in Side-Channel Analysis),” in COSADE 2015, ser.
LNCS, vol. 9064. Springer, 2015, pp. 20–33.
[15] S. Chari, C. S. Jutla, J. R. Rao, and P. Rohatgi, “Towards Sound
Approaches to Counteract Power-Analysis Attacks,” in CRYPTO ’99,
ser. LNCS, vol. 1666. Springer, 1999, pp. 398–412.
[16] B. Barak, O. Goldreich, R. Impagliazzo, S. Rudich, A. Sahai, S. P.
Vadhan, and K. Yang, “On the (Im)possibility of Obfuscating Programs,”
in CRYPTO 2001, ser. LNCS, vol. 2139. Springer, 2001, pp. 1–18.
[17] A. Duc, S. Dziembowski, and S. Faust, “Unifying Leakage Models:
From Probing Attacks to Noisy Leakage,” in EUROCRYPT 2014, ser.
LNCS, vol. 8441. Springer, 2014, pp. 423–440.
[18] S. Nikova, V. Rijmen, and M. Schl¨affer, “Secure Hardware Implementa-
tion of Nonlinear Functions in the Presence of Glitches,” J. Cryptology,
vol. 24, no. 2, pp. 292–321, 2011.
[19] B. Bilgin, B. Gierlichs, S. Nikova, V. Nikov, and V. Rijmen, “Higher-
Order Threshold Implementations,” in ASIACRYPT 2014, ser. LNCS,
vol. 8874. Springer, 2014, pp. 326–343.
[20] O. Reparaz, B. Bilgin, S. Nikova, B. Gierlichs, and I. Verbauwhede,
“Consolidating Masking Schemes,” in CRYPTO 2015, ser. LNCS, vol.
9215. Springer, 2015, pp. 764–783.
[21] J. Balasch, S. Faust, and B. Gierlichs, “Inner Product Masking Revis-
Springer, 2015,
ited,” in EUROCRYPT 2015, ser. LNCS, vol. 9056.
pp. 486–510.
[22] H. Groß and S. Mangard, “A uniﬁed masking approach,” J. Crypto-
graphic Engineering, vol. 8, no. 2, pp. 109–124, 2018.
[23] H. Groß, R. Iusupov, and R. Bloem, “Generic Low-Latency Masking
in Hardware,” IACR Trans. Cryptogr. Hardw. Embed. Syst., vol. 2018,
no. 2, pp. 1–21, 2018.
[24] A. Duc, S. Faust, and F. Standaert, “Making Masking Security Proofs
Concrete - Or How to Evaluate the Security of Any Leaking Device,”
in EUROCRYPT 2015, ser. LNCS, vol. 9056. Springer, 2015, pp. 401–
429.
[25] S. Dziembowski, S. Faust, and M. Skorski, “Noisy Leakage Revisited,”
in EUROCRYPT 2015, ser. LNCS, vol. 9057. Springer, 2015, pp. 159–
188.
[26] G. Barthe, F. Dupressoir, S. Faust, B. Gr´egoire, F. Standaert, and
Implementations of Masking Schemes and the
P. Strub, “Parallel
Bounded Moment Leakage Model,” in EUROCRYPT 2017, ser. LNCS,
vol. 10210, 2017, pp. 535–566.
[27] O. Bronchain, J. M. Hendrickx, C. Massart, A. Olshevsky, and F. Stan-
daert, “Leakage Certiﬁcation Revisited: Bounding Model Errors in Side-
Channel Security Evaluations,” in CRYPTO 2019, ser. LNCS, vol. 11692.
Springer, 2019, pp. 713–737.
[28] G. Barthe, S. Bela¨ıd, F. Dupressoir, P. Fouque, B. Gr´egoire, and P. Strub,
“Veriﬁed Proofs of Higher-Order Masking,” in EUROCRYPT 2015, ser.
LNCS, vol. 9056. Springer, 2015, pp. 457–485.
[29] G. Barthe, S. Bela¨ıd, F. Dupressoir, P. Fouque, B. Gr´egoire, P. Strub, and
R. Zucchini, “Strong Non-Interference and Type-Directed Higher-Order
Masking,” in CCS 2016. ACM, 2016, pp. 116–129.
[30] R. Bloem, H. Groß, R. Iusupov, B. K¨onighofer, S. Mangard, and
J. Winter, “Formal Veriﬁcation of Masked Hardware Implementations
in the Presence of Glitches,” in EUROCRYPT 2018, ser. LNCS, vol.
10821. Springer, 2018, pp. 321–353.
Masked Implementations,” in ICECS 2018.
[31] V. Arribas, S. Nikova, and V. Rijmen, “VerMI: Veriﬁcation Tool for
IEEE, 2018, pp. 381–384.
[32] G. Barthe, S. Bela¨ıd, G. Cassiers, P. Fouque, B. Gr´egoire, and F. Stan-
daert, “maskVerif: Automated Veriﬁcation of Higher-Order Masking in
Presence of Physical Defaults,” in ESORICS 2019, ser. LNCS, vol.
11735. Springer, 2019, pp. 300–318.
[33] T. D. Cnudde, O. Reparaz, B. Bilgin, S. Nikova, V. Nikov, and
V. Rijmen, “Masking AES with d+1 Shares in Hardware,” in CHES
2016, ser. LNCS, vol. 9813. Springer, 2016, pp. 194–212.
[34] B. Bilgin, B. Gierlichs, S. Nikova, V. Nikov, and V. Rijmen, “Trade-
Offs for Threshold Implementations Illustrated on AES,” IEEE Trans.
on CAD of Integrated Circuits and Systems, vol. 34, no. 7, pp. 1188–
1200, 2015.
[35] F. Wegener and A. Moradi, “A First-Order SCA Resistant AES With-
out Fresh Randomness,” in COSADE 2018, ser. LNCS, vol. 10815.
Springer, 2018, pp. 245–262.
[36] L. De Meyer, A. Moradi, and F. Wegener, “Spin Me Right Round
Rotational Symmetry for FPGA-Speciﬁc AES,” IACR Trans. Cryptogr.
Hardw. Embed. Syst., vol. 2018, no. 3, pp. 596–626, 2018.
[37] A. Poschmann, A. Moradi, K. Khoo, C. Lim, H. Wang, and S. Ling,
“Side-Channel Resistant Crypto for Less than 2,300 GE,” J. Cryptology,
vol. 24, no. 2, pp. 322–345, 2011.
[38] A. Moradi, A. Poschmann, S. Ling, C. Paar, and H. Wang, “Pushing the
Limits: A Very Compact and a Threshold Implementation of AES,” in
EUROCRYPT 2011, ser. LNCS, vol. 6632. Springer, 2011, pp. 69–88.
[39] H. Groß, S. Mangard, and T. Korak, “An Efﬁcient Side-Channel Pro-
tected AES Implementation with Arbitrary Protection Order,” in CT-RSA
2017, ser. LNCS, vol. 10159. Springer, 2017, pp. 95–112.
[40] C. Boit, S. Tajik, P. Scholz, E. Amini, A. Beyreuther, H. Lohrke,
and J.-P. Seifert, “From IC Debug to Hardware Security Risk: The
Power of Backside Access and Optical Interaction,” in 2016 IEEE
23rd International Symposium on the Physical and Failure Analysis of
Integrated Circuits (IPFA).
IEEE, 2016, pp. 365–369.