sebastian porst.pdf, 2010.
[27] T. Ptacek and T. Newsham.
Insertion, evasion, and
denial of service: Eluding network intrusion detection,
1998.
[28] T. Scholte, D. Balzarotti, and E. Kirda. Quo vadis? A
study of the evolution of input validation vulnerabilities
in Web applications. In FC, 2011.
[29] C. Sheehan. Pimp my PE: Parsing malicious and mal-
formed executables. http://research.sunbelt-software.
com/ViperSDK/Pimp%20My%20PE.ppt, 2007.
[30] IE content-type logic.
http://blogs.msdn.com/b/ie/
archive/2005/02/01/364581.aspx, 2005.
[31] P. Sz¨or and P. Ferrie.
Hunting for metamor-
http://www.symantec.com/avcenter/reference/
phic.
hunting.for.metamorphic.pdf.
[32] Virus Total. http://www.virustotal.com.
[33] VX Heavens. http://vx.netlux.org/vl.php.
[34] R. Watson. Exploiting concurrency vulnerabilities in
system call wrappers. In WOOT, 2007.
[35] J. Weinberger, P. Saxena, D. Akhawe, M. Finifter,
R. Shin, and D. Song. A systematic analysis of
XSS sanitization in Web application frameworks.
In
ESORICS, 2011.
[36] A. Wheeler and N. Mehta.
0wning antivirus.
http://www.blackhat.com/presentations/bh-europe-
05/bh-eu-05-wheeler-mehta-up.pdf, 2005.
[37] F. Xue. Attacking antivirus. http://www.blackhat.com/
presentations/bh-europe-08/Feng-Xue/Whitepaper/bh-
eu-08-xue-WP.pdf, 2008.
[38] Anti-virus software may not properly scan malformed
http://www.kb.cert.org/vuls/id/968818,
zip archives.
2005.
[39] Musing on information security. http://blog.zoller.lu/
search/label/Advisory, 2009.
APPENDIX
93
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:47:44 UTC from IEEE Xplore.  Restrictions apply. 
EXAMPLES OF CLAMAV’S FIXED-OFFSET “MAGIC STRINGS” IN THE ORDER THEY ARE CHECKED.
Table XIII
Magic content
5b 61 6c 69 61 73 65 73 5d
Order
25
Offset
0
Length
5
File type
EVS mail
Order
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
Offset
0
257
0
0
8
6
6
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
Length
9
5
5
14
4
4
4
3
3
8
8
4
4
4
14
13
6
2
8
11
9
11
15
17
File type
mirc.ini
TAR-
POSIX
RTF
SIP log
SIS
JPEG
JPEG
MP3
JPEG
OLE2
container
CryptFF
PNG
ELF
7573746172
7b5c727466
5349502d48495420285349502f48
19040010
4a464946
45786966
fffb90
ffd8ff
d0cf11e0a1b11ae1
b6b9acaefeffffff
89504e47
7f454c46
TNEF
789f3e22
VPOP3
(DOS)
VPOP3
(UNIX)
UUencoded
ARJ
Mail
Symantec
Mail
Mail
Mail
Mail
763a0d0a52656365697665643a20
763a0a52656365697665643a20
626567696e20
60ea
582d5549444c3a20
582d53796d616e7465632d
582d53696576653a20
582d5265616c2d546f3a20
582d4f726967696e616c2d546f3a20
582d456e76656c6f70652d46
726f6d3a20
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
17
4
9
4
13
13
10
4
4
4
8
4
4
12
12
2
4
4
3
26
3
6
5
Magic content
582d455653
582d4170706172656e746c792d
546f3a20
546f3a20
5375626a6563743a20
535a4444
52657475726e2d706174683a20
52657475726e2d506174683a20
52656365697665643a20
52617221
52494658
52494646
504b3030504b0304
504b0304
4f676753
4d6573736167652d49643a20
4d6573736167652d49443a20
Mail
Mail
Mail
compress.
exed
Maildir
Maildir
Raw mail
RAR
RIFX
RIFF
ZIP
ZIP
Ogg
Stream
Mail
Mail
4d5a
MS-EXE
MS CAB
4d534346
MS CHM 49545346
MP3
Qmail
bounce
GIF
Exim
mail
46726f6d3a20
494433
48692e205468697320697320746865
20716d61696c2d73656e64
474946
MBox
46726f6d20
“MAGIC STRINGS” FOR FILE TYPES NOT SUPPORTED BY CLAMAV (SOURCE: [17]). MULTIPLE OFFSETS SEPARATED BY ”,” INDICATE THAT THE
MAGIC CONTENT CAN APPEAR AT ANY OF THEM.
Table XIV
Offset
0
0
0
0
0
2
0
526
29,152
30
0
0
4
0,30
32769, 34817, 36865
Length
8
2
2
8
4
3
6
5
6
6
4
4
8
23
5
File type
MS Ofﬁce ﬁles
TAR.Z (LZW)
TAR.Z (LZH)
AR, MS Coff
PACK
LZA,LZH
7Zip
PKZIP SFX
WinZip
PKLITE
PKZIP
Zoo
Quicktime MOV
EPS
ISO
Magic content
D0 CF 11 E0 A1 B1 1A E1
1F 9D
1F A0
21 3C 61 72 63 68 3E 0A
50 41 43 4B
2D 6C 68
37 7A BC AF 27 1C
50 4B 53 70 58
57 69 6E 5A 69 70
50 4B 4C 49 54 45
50 4B 03 04
5A 4F 4F 20
6D 6F 6F 76
25 21 50 53 2D 41 64 6F 62 65 2D 33 2E 30 20 45 50 53 46 2D 33 20 30
43 44 30 30 31
94
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 11:47:44 UTC from IEEE Xplore.  Restrictions apply.