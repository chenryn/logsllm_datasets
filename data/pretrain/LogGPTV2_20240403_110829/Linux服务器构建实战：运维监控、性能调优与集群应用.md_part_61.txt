Extended
System
Linux
Linux
Linux
Linux
Extended
System
Linux
Linux
Linux
System
OracleRAC集群
.com
x swap/ Solaris
L
371
PDG
---
## Page 387
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
文件，修改后的内容如下：
配置方式。因此在CentOS5版本中配置RAW的方法有以下两种：
/usr/bin/raw变为/bin/raw，这使CentOS在安全方面有了不少的改进，但是仍然兼容之前的
RAW设备，而在CentOS5以后，RAW设备必须通过udev来管理，并且raw命令的位置从
以前版本中，可以通过/etc/sysconfig/rawdevices和/etc/init.d/rawdevices文件来创建和配置
372第5
crw-r--r--1 oracle oinstall 162,
[root@node-rac1/]#11/dev/raw/raw*
接着验证一下RAW设备是否生成：
Starting udev:
[root@node-rac1 /]# start_udev
然后启动udev服务生成RAW设备：
KERNEL=="raw10",
KERNBL=="raw9",
KERNEL=="raw8",
KERNEL=="raw7",
KERNBL=="raw6",
KERNEL=="raw5",
KERNBL=="raw3",
KERNEL=="raw2",（
KERNBL=="raw1",
ACTION=="add*,KERNEL=="sdc9",RUN+="/bin/raw
ACTION=="add",KERNEL=="gdc7",RUN+="/bin/raw
ACTION=-"add*,KERNEL=="sdc6",RUN+="/bin/raw
ACTION=="add*,KERNEL=="gdc5",RUN+="/bin/raw
ACTION=="add*,KERNEL=="sdb9",RUN+="/bin/raw
ACTION=="add",KERNEL=="sdb8",RUN+="/bin/raw
ACTION=="add*,KERNEL=="sdb7",RUN+="/bin/raw
ACTION=="add",KERNEL=="sdb6",RUN+="/bin/raw
ACTION=="add*,KBRNEL=="sdb5",RUN+="/bin/raw
这里采用第二种方式来建立和配置RAW设备。首先修改/etc/udev/rules.d/60-raw.rules
口通过udev来管理RAW设备，添加RAW设备对应的配置文件为/etc/udev/rules.d/60-
口手动建立/etc/sysconfig/rawdevices文件，然后从其他操作系统上复制/etc/init.d/
raw.rules。
关于RAW设备的使用，从CentOS4版本到CentOS5发生了很大变化，在CentOS
3.建立和配置RAW设备
全部操作执行完毕后重启RAC数据库的两个节点。
以通过/etc/init.d/rawdevices来启动和关闭RAW文件了。
rawdevices文件到本机，修改/etc/init.d/rawdevices文件中raw命令的路径，然后就可
WWW.L
OWNER="oracle",
OWNER="oracle"
OWNER="oracle"
OWNER="oracle"
OWNER="oracle"
OWNER="oracle"
OWNER="oracle",
OWNER="oracle",
OWNER="oracle",
OWNER="oracle",
Linuxidc.com
GROUP="oinstall"，
GROUP="oinstall",
GROUP="oinstall",
GROUP="oinstall",
GROUP="oinstal1"
GROup="oinstall"
GROUP="oinsta11",
GROUP="oinstall"
GROUP="oinstal1",
GROUP="oinstal1",
1 Aug 27 00:13/dev/raw/raw1
/dev/raw/raw8
/dev/raw/raw7
/dev/raw/raw4
/dev/raw/raw3
/dev/raw/raw2
/dev/raw/raw1
/dev/raw/raw6
/dev/raw/raw5
MODE="660*
MODE="660"
MODE="660"
MODE="660"
MODE="660”
MODE="660"
MODE="660"
MODB="644 "
MODE="644"
MODE="660"
PDG
---
## Page 388
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
装。
如下：
13.4.13
接着就会弹出图形安装向导界面，如图13-4所示。
以oracle用户登录Linux图形界面，然后执行安装脚本：
以oracle身份登录系统，执行如下命令：
在开始安装之前，可以使用Oracle自己的一个检测脚本验证系统环境是否可以进行安
（3）验证安装环境
在节点node-rac1安装完成后，继续在node-rac2进行补丁安装。
解压完成，安装补丁包。操作如下：
（2）安装补丁包
[rootenode-racl rac]#ls
这里假定数据库所有软件放在/rac目录下，首先需要解压Oracle的两个软件包。操作
oracleanode-raclclusterware]$./runInstaller
[oracle@node-racl-]$ cd/rac/clusterware/
（4）开始安装
[root@node-racl rac]#/rac/clusterware/rpm
[root@node-racl rac]#unzip linux_1lgR1_database_1013.zip
[root@node-racl rac]#unzip linux_x86_11gR1_clusterware.zip
（1）解压软件包
从输出可以看出，RAW设备已经生成，并且相关权限也自动加载。
crw-rw-
crw-rw-
crW-rW--.-
crw-rw----
crw-rW---
crw-rw-
crw-r--r--
racl,node-rac2-verbose
安装OracleClusterware
www.Linuxidc.com
1oracle oinstall
1 oracle oinsta11 162,10 Aug 27 00:13 /dev/raw/raw10
oracle oinstall
oracle oinstall
oracle oinstall
oracle
oinstall
162
162
162
162
162
162,
62
1inux_x86_11gR1_clusterware.zip
3 Aug 2700:13 /dev/raw/raw
2Aug 2700:13/dev/raw/rawz
Aug 2700:13/dev/raw/raw
Aug
Aug
Aug
Auo
27.00:13
2700:13
27
27
00:13
00:13
00:13
/dev/raw/raw
/dev/raw/raw
/dev/raw/rawe
/dev/raw/raw
集群373
PDG
---
## Page 389
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
入权限。单击“Next”按钮进入下一步，如图13-6所示。
这里将安装清单目录指定到/app下，务必确认oracle用户拥有对/app目录的读取和写
单击“Next”按钮进人下一步，如图13-5所示。
SpecifyInventory directoryandcredentials
Welcome
are
your
rArs
图13-5设置安装清单目录
图13-4Oracle安装向导
qu
ides
ORACLE118
OG
---
## Page 390
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
后，单击“Next”按钮进入下一步，如图13-8所示。
按照配置的节点信息，将集群的两个节点添加进来，填写相应节点信息即可。填写完成
输人CRS的名称和安装路径，单击“Next”按钮进入下一步，如图13-7所示。
www.Linuxidc.com
SpecifyClusterConfiguration
ame
Destination
SpecifyHome Details
Tor theclusterarldselecttheno
图13-7修改集群节点信息
图13-6指定安装主目录信息
ORACLE118
DATABASE
PDG
---
## Page 391
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
按照预先设定好的存储方式，指定OCR的存储位置，如图13-10所示。
单击“Edit”按钮，将公网eth0网段设为“Public”，然后单击“OK"按钮，如图13-9所示。
www.Linuxidc.com
ethl
Interte
rihere
Specify Network Interface Usage
SpecifyNetwork Interface Usage
erface Nam etho
Puble
Suonet:
图13-9指定网络接口eth0为公用网络
TYPE
192.168.12
Edit private interconnect type
图13-8指定网络接口类型
10.0.0.0
192.168.12.0
OK
Cante
ORACLE118
ORACLE118
,orDoNot
he
PDG
---
## Page 392
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
图13-12是安装信息预览，单击“install”按钮开始安装ClusterWare，如图13-13所示。
设置表决磁盘使用RAW设备，并添加对应的设备标识，如图13-11所示。
www.Linuxidc.com
SpecifyVoting Disk Location
SpecifyOracle ClusterRegistry(OCR)Location
TCR
lerRe
图13-11指定表决磁盘的位置
图13-10指定OCR的位置
---
## Page 393
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
378
ClusterWare的安装非常快，在等待了几分钟后，安装就完成了，如图13-14所示。
第5篇
www.Linuxidc.com
OracleClusterware11.1.0.6.0
Summary
st
/ Required 649MB (ncludes 47MB temporary Avsilable 8.94GB
Cluster Node
Oracle
-Source: frac/clusterware/stage/products.xml
/app/oracrs/product/11.0.6/crs (OraCrs11g_home)
图13-13开始安装ClusterWare
图13-12安装信息预览
DATABASE
ORACLE118
ORACLE118
1
PDG
---
## Page 394
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
一个节点一个节点地执行。在node-rac1上执行root.sh时的信息如下：
Nowformattingvoting device:/dev/raw/raw3
Operation successful.
Creating ocR keys for user ‘root',privgrp
node 2:node-rac2 node-priv2 node-rac2
ode
Using ports:
The
Oracle Cluster Registry configuration upgraded successfully
Setting up Network socket directories
Setting the permissions on ocR backup directory
/etc/oracle does not exist.Creating it now.
WARNING:directory
WARNING:directory
NARNING:
WARNING:directory
[root@node-racl crs]#./root.sh
根据安装向导提示，以root用户身份在所有节点上分别执行图13-14中的两个脚本，要
Now formatting voting device:
1:node-racl node-privl node-racl
directory
directory
www.Linuxidc.com
2
In:
CSS=49895 CRS=49896
Nte:Donotrun the scrpts smneouslyonthe listed nodes.
Number Scrpt Locaton
Stripis to be execued
app/oracrs'
'/app'isnot owned by root
'/app/oracrs'isnotowned byroot
'/app/oracrs/product'
Heip
i8 not owned by root. Changing owner to root
Execute Configuration scripts
/dev/raw/raw
图13-14安装完成
EVMC=
needto
is not
49898 and EVMR=49897.
be
is not owned by root
EXE
'root'..
configured
Changing owmer to root
PDG
---
## Page 395
Linux公社（www.LinuxIDC.com）是专业的Linux系统门户网站，实时发布最新Linux资讯。
380
Oracle CRS stack installed and running under init(1M)
Waiting for the Oracle CRSD and EVMD to start
Cluster Synchronization Services is active on all the nodes.
Cluster Synchronization Services is active on these nodes