@EyalItkin
Fixed by the vendor
ZigBee 
(Radio)
Attacker
ZigBee 
Factory 
Reset
Attacker 
Controlled
WiFi
Ethernet
ZigBee 
(Radio)
Attacker
ZigBee 
Factory 
Reset
Attacker 
Controlled
WiFi
Ethernet
ZigBee 
(Radio)
Attacker
ZigBee 
Factory 
Reset
Attacker 
Controlled
WiFi
Ethernet
Malicious 
OTA Update
ZigBee 
Exploit
WiFi
Ethernet
Attacker 
Controlled
Attacker
ZigBee 
Exploit
WiFi
Ethernet
Attacker 
Controlled
Attacker
Physical (PHY) layer – 2.4 GHz Radio
Medium Access Control (MAC)
Network (NWK) Layer
Application Sublayer (APS)
ZigBee Device
Profile (ZDP)
Some Application
ZigBee Cluster 
Library (ZCL)
Levels 1-2
IEEE 802.15.4
Levels 3
Levels 4
Levels 5+
Main CPU
QCA4531-BL3A
ZigBee “Modem”
ATSAMR21E18E
Serial Debug
“… (the bridge) Is 
using a single 
huge process that 
does everything”
E_ZCL_BOOL (0x10)
E_ZCL_UINT8 (0x20)
E_ZCL_UINT32 (0x23)
E_ZCL_ARRAY (0x48)
Yup, this firmware 
contains symbols!
github.com/CheckPointSW/Cyber-Research/tree/master/Vulnerability/Smart_Lightbulbs
Goal: Confuse malloc() to “allocate” a buffer at an 
arbitrary address
@EyalItkin