SSD	
  Data	
  Evapora+on	
DEF	
  CON	
  21	
August	
  2,	
  2013	
Bio	
Data	
  Remanence	
Deleted	
  Data	
•  On	
  magne+c	
  hard	
disks,	
  data	
  remains	
+ll	
  it	
  is	
  overwriEen	
• 
Image	
  from	
www.howstuﬀworks.com	
DEMO	
  on	
  Windows	
•  Observing	
  data	
  on	
  a	
  magne+c	
  hard	
  disk	
  aMer	
– Moving	
  to	
  Recycle	
  Bin	
– Emptying	
  Recycle	
  Bin	
– FormaOng	
  Drive	
  (Quick)	
– FormaOng	
  Drive	
  (Slow)	
Forensics	
  &	
  Data	
  Recovery	
•  We	
  can	
  recover	
  deleted	
  data	
•  Find	
  evidence	
  of	
  crimes	
•  Even	
  aMer	
  a	
  format	
•  Very	
  few	
  criminals	
  know	
  enough	
  to	
  use	
encryp+on	
  or	
  forensic	
  erasure	
Useful	
  Free	
  Data	
  Recovery	
  Tools	
•  Recuva	
  for	
  PC	
•  Disk	
  Drill	
  for	
  Mac	
SSDs	
• 
From	
  hEp://www.isuppli.com/Abstract/P28276_20130322152341.pdf	
How	
  SSDs	
  Work	
•  Data	
  can	
  be	
  read	
  and	
wriEen	
  one	
  page	
  at	
  a	
+me,	
  but	
  can	
  only	
  be	
erased	
  a	
  block	
  at	
  a	
+me	
•  Each	
  erasure	
  degrades	
the	
  ﬂash—it	
  fails	
around	
  10,000	
erasures	
• 
From	
  hEp://www.anandtech.com/
show/2738/5	
Garbage	
  Collec+on	
•  SSD	
  controller	
  erases	
  pages	
  all	
  by	
  itself,	
  when	
it	
  knows	
  they	
  are	
  empty	
•  The	
  TRIM	
  command	
  is	
  sent	
  to	
  the	
  SSD	
  when	
  a	
ﬁle	
  is	
  deleted	
– But	
  only	
  if	
  you	
  use	
  a	
  the	
  correct	
  OS,	
  Par++on	
  type,	
and	
  BIOS	
  seOngs	
•  Yuri	
  Gubanov	
  calls	
  this	
  “Self-­‐Corrosion”	
  –	
  I	
  call	
it	
  Data	
  Evapora;on	
Demo	
  on	
  Mac:	
  Disk	
  Drill	
•  Deleted	
  ﬁles	
from	
  desktop	
evaporate	
  in	
30-­‐60	
  min	
Demo	
  on	
  PC	
•  Save	
  data	
  on	
  an	
  SSD	
•  Watch	
  it	
  evaporate!	
•  How	
  to	
  test	
  TRIM	
– fsu;l	
  behavior	
  query	
  DisableDeleteNo;fy	
– Zero	
  =	
  TRIM	
  enabled	
When	
  Does	
  TRIM	
  Work?	
•  BIOS:	
  Drive	
  must	
  be	
  SATA	
  in	
  AHCI	
  mode,	
  not	
in	
  IDE	
  emula+on	
  mode	
•  SSD	
  must	
  be	
  new	
  (Intel:	
  34	
  nm	
  only)	
•  Windows	
  7	
  or	
  later	
– NTFS	
  volumes,	
  not	
  FAT	
•  Mac	
  OS	
  X	
  10.6.8	
  or	
  later	
– Must	
  be	
  Apple-­‐branded	
  SSD	
When	
  Does	
  TRIM	
  Work?	
•  External	
  Drives	
  must	
  use	
  SATA	
  or	
  SCSI,	
  not	
USB	
•  PCI-­‐Express	
  &	
  RAID	
  does	
  not	
  support	
  TRIM	
• 
From	
  hEp://forensic.belkasoM.com/en/why-­‐ssd-­‐destroy-­‐court-­‐evidence	
Expert	
  Witness	
  Tes+mony	
Experience	
•  In	
  court,	
  an	
  expert	
  witness	
  can	
  state	
  an	
opinion	
•  Must	
  be	
  based	
  on	
  personal	
  experience	
– “I	
  read	
  it	
  in	
  a	
  book”	
  NO	
– “A	
  teacher	
  said	
  it	
  in	
  a	
  class”	
  NO	
– “I	
  know	
  this	
  because	
  I	
  tested	
  it”	
  YES	
•  So	
  forensic	
  examiners	
  do	
  a	
  lot	
  of	
  tes+ng	
Summary	
•  SSDs	
  retain	
  deleted	
  data	
  some+mes	
•  Other	
  +mes	
  they	
  don’t	
•  It	
  depends	
  on	
– Manufacturer	
– OS	
– BIOS	
– Interface	
– Who	
  knows	
  what	
  else	
The	
  evap	
  Tool	
For	
  Mac	
  OS	
  X	
  Only	
Intro	
Evapora+on	
  on	
  JHFS+	
No	
  Evapora+on	
  on	
  HFS+	
More	
  Info	
•  Slides,	
  instruc+ons	
  for	
  the	
  aEacks,	
  &	
  more	
  at	
•  Samsclass.info