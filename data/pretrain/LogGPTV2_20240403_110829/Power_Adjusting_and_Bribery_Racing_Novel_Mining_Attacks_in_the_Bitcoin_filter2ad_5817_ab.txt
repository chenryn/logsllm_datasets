mining attacks, such as selfish mining [1, 9], BWH attacks
[7, 9, 16], FAW attacks [13], and bribery attacks [2, 15].
1. We normalize the total computational power of the
Bitcoin system as 1 [7, 9, 13, 16]. The computational power
of each miner/pool is a fraction of this total, which should
be less than or equal to 0.5 to avoid â€œ51% attacksâ€ [3].
2. No unintentional forks in the Bitcoin system. This as-
sumption is reasonable since the probability of unintentional
forks is negligible, about 0.41% [10] (this assumption is also
made in [13]). Therefore, the expected reward of a miner
equals to the probability of finding a valid block in each
round. Since the time of a miner finds a valid block has an
exponential distribution with mean inversely to his compu-
tational power [8], the probability of a miner finding a valid
block equals to his normalized computational power.
3. Miners are selfish but honest except the attackers. Hon-
est miners can choose their best strategy (i.e. mining on
which branch) to get a higher reward, but will not launch
any attacks [7, 9, 13, 16]. The assumption of profit-driven
miners is also made in [7, 9]. It is acceptable since mining on
different branches brings no different rewards for followers
(discussed in Section 4.2).
4. We normalize the reward of finding a valid block to
1 instead of 12.5 BTC. The reward in our analysis is the
expected reward [13, 16].
5. When a pool manager earns a reward (via propagating a
valid block from an FPoW), he distributes the reward to pool
miners based on the number of submitted shares (FPoWs
and PPoWs) in this round [7, 13, 16].
4 OBSERVATION AND MOTIVATION
4.1 FAW Reward
In FAW attacks, an attackerâ€™s innocent mining power will
help the attacker to win a whole profit. The infiltration
mining power will help to share the reward from the victim
poolâ€™s profit. As a result, after an FPoW is discovered, the
infiltration mining power only contributes to earning a share
(via submitting PPoWs). Therefore, when the mining pool
is relatively large and the poolâ€™s (attackerâ€™s) branch has less
chance to be chosen as the main chain, the infiltration mining
reward (shared profit) is â€œless attractiveâ€ to the attacker after
an FPoW is found. Allocating more power to innocent mining,
which is the â€œmore attractiveâ€ part with higher reward, would
be more profitable.
Note that power adjusting does not always mean shifting
infiltration power to innocent power. Shifting reversely is
also acceptable when winning a share is more attractive (in a
smaller pool with better chance to win in forks). We discuss
Figure 1: â€œ0-leadâ€ racing. The blockchain is forked by two
branches of the same length (caused by the attacker ğ‘ and
some other miners ğ‘œ).
the detailed power shifting strategies under different scenarios
in Section 5.
4.2 â€œ0-leadâ€ Racing
â€œ0-leadâ€ racing indicates two branches of the same length race
on the blockchain, as depicted in Fig. 1. This situation can
occur in selfish mining [9], stubborn mining [22], and FAW
attacks [13], when the attacker withholds block ğ‘–â€² till another
miner finds block ğ‘–. In this situation, the attacker (ğ‘) will
continue mining on block ğ‘–â€² and the miners which find blocks
on block ğ‘–â€™s branch (ğ‘œ) will continue mining on block ğ‘–. For
other miners (ğ‘), they can choose to mine on block ğ‘– or ğ‘–â€²,
since it has no difference which branch is extended (normally
they choose to mine on the firstly received block). When any
branch is extended by ğ‘, ğ‘ can get one profit, and no profit
for other cases.
Now consider the attacker lures ğ‘ to mine on block ğ‘–â€² with
bribery attacks (containing bribery transactions in block ğ‘–â€²).
The racing will become unfair (bribery racing) since choosing
to mine on block ğ‘–â€² branch becomes more profitable for ğ‘
than on block ğ‘– branch, The best strategy for miners in ğ‘ is
to extend attackerâ€™s branch. Moreover, since the attackerâ€™s
reward increases with the probability of her branch selected
as the main chain in some mining attacks (e.g. selfish mining),
the attacker can get more rewards than not adopting bribery
racing when choosing a proper bribing fee.
5 POWER ADJUSTING
WITHHOLDING
5.1 Overview
We introduce novel power adjusting withholding (PAW) at-
tacks against mining pools which combines power adjusting
strategy and FAW attacks. In our observation in FAW attacks
(Section 4.1), we point out FAW adopts fixed power split-
ting strategy, which may result in wasting too much mining
power on the less attractive reward. The key insight behind
our new PAW attacks is allowing the attacker dynamically
adjust the mining power between innocent and infiltration
mining. Therefore, the attacker can always increase her re-
ward by allocating more power on the more attractive reward
(whole profit or a share). Besides, PAW can also preserve the
advantage of FAW to avoid the â€œminerâ€™s dilemmaâ€.
In one victim pool scenario, the attacker first splits her
computational power into innocent mining and infiltration
mining, and mines both solely (via innocent mining) and in-
pool (via infiltration mining). There are four possible cases
when a valid block (FPoW) is found:
Case 1. Found by innocent mining. The attacker propa-
gates it and earns a legitimate profit.
Case 2. Found by other miners not in the victim pool. The
attacker accepts the block and continues mining the next
block. No profit will be earned by the attacker.
Case 3. Found by other victim pool miners. The attacker
earns a shared profit from the pool.
Case 4. Found by infiltration mining. When the infiltration
mining finds an FPoW, the attacker withholds the FPoW
and reallocates her computational power. There are further
three subcases when a new block/FPoW is found.
Case 4-1. Found by innocent mining. The attacker dis-
cards the withheld FPoW and propagates the new one.
Case 4-2. Found by other miners not in the victim pool.
The attacker immediately submits the withheld FPoW to the
victim pool manager. A fork can be generated in the Bitcoin
network when the manager propagates her FPoW.
Case 4-3. Found by other victim pool miners. The attacker
discards the withheld FPoW and earns a share.
In summary, the strategies of PAW attacks are similar to
FAW attacks. The difference is that an attacker will reallo-
cate her computational power after an FPoW is found by
infiltration mining in PAW attacks, while in FAW attacks,
an attacker never adjusts her computational power. Clearly,
PAW attacks can earn as much reward as FAW attacks (when
not adjusting computational power). Besides, we also show
that PAW attacks can be more profitable than FAW attacks
when the computational power is adjusted properly in the
Section 5.2 and 5.3.
In multiple victim pools scenario, PAW attacks adjust
the power allocation every time when an FPoW is found by
innocent mining, and submit all ğ‘˜ withheld FPoWs when
other miners not in the victim pools find a valid block to
cause a fork with (ğ‘˜ + 1) branches (1 (cid:54) ğ‘˜ (cid:54) ğ‘› when targeting
at ğ‘› pools). Since ğ‘˜ branches are generated by infiltration
mining, the probability of the attacker winning a shared
profit via infiltration mining increases.
5.2 PAW Against One Pool
Theoretical analysis. Refereing to the cases in Section 5.1,
we use the following parameters to analyze PAW attacks:
ğ›¼: Total computational power of the attacker;
ğ›½: Computational power of the victim pool;
ğœ1: Attackerâ€™s original infiltration mining power as a
proportion of ğ›¼ before Case 4;
ğœ2: Attackerâ€™s reallocated infiltration mining power as a
proportion of ğ›¼ after Case 4;
as the main chain in Case 4-2.
Â¯ğœ : Attackerâ€™s average portion of computational power
allocated to infiltration mining in a mining process;
ğ‘: Probability of the attackerâ€™s FPoW will be selected
The attacker allocates (1 âˆ’ ğœ1)ğ›¼ computational power for
innocent mining and ğœ1ğ›¼ for infiltration mining before Case 4;
and will use (1 âˆ’ ğœ2)ğ›¼ and ğœ2ğ›¼ for innocent mining and infil-
tration mining respectively after Case 4. The computational
power of the victim pool (ğ›½) does not include the infiltration
mining power (ğœ1ğ›¼ or ğœ2ğ›¼). ğ‘ is a coefficient related to at-
tackerâ€™s network capability and the Bitcoin network topology
[19]. The calculation of ğ‘ can be referred to [13]. Attacker
can also get an extra reward even when ğ‘ is unknown (e.g.
by setting ğ‘ = 0 or ğ‘ = ğ›¼ + ğ›½ for an honest/rational pool
manager, which is same as the strategies in FAW attacks
[13]).
miners  (o s) branchattacker s (a s) branchblock iblock i k   0  blocks  public chainAttackerâ€™s reward. Based on our analysis in Section 4.1, the
attacker has (1âˆ’ ğœ1)ğ›¼ probability to fall in Case 1; (1âˆ’ ğ›¼âˆ’ ğ›½)
probability for Case 2; ğ›½ probability for Case 3; and ğœ1ğ›¼
for Case 4. The total probability of these four cases is 1
as expected. In Case 4, after adjusting the computational
power, the total mining power will become (1âˆ’ ğœ2)ğ›¼ since the
infiltration mining will not propagate any FPoWs. Therefore,
the attacker has ğœ1ğ›¼ Â· (1âˆ’ğœ2)ğ›¼
1âˆ’ğœ2ğ›¼ probability to fall in Case 4-1;
ğœ1ğ›¼Â· 1âˆ’ğ›¼âˆ’ğ›½
1âˆ’ğœ2ğ›¼ probability
in Case 4-3. As expected, the sum of the probability in Case
4-1, 4-2, and 4-3 is ğœ1ğ›¼ (same as Case 4). We can further
derive the reward of a PAW attacker ğ‘…ğ‘ƒ
ğ‘ (ğœ1, ğœ2) as follows:
1âˆ’ğœ2ğ›¼ probability in Case 4-2; and ğœ1ğ›¼Â·
ğ›½
ğ‘ (ğœ1, ğœ2) = (1 âˆ’ ğœ1)ğ›¼ + ğ›½ Â·
ğ‘…ğ‘ƒ
ğœ1ğ›¼
ğ›½ + ğœ1ğ›¼
+
(ï¸‚ (1âˆ’ğœ2)ğ›¼
1 âˆ’ ğœ2ğ›¼
ğœ1ğ›¼Â·
+(ğ‘Â· 1âˆ’ğ›¼âˆ’ğ›½
1 âˆ’ ğœ2ğ›¼
+
ğ›½
1âˆ’ğœ2ğ›¼
)Â·
Â¯ğœ ğ›¼
ğ›½ + Â¯ğœ ğ›¼
.
(1)
)ï¸‚
Â¯ğœ can be regarded as a function related to ğœ1 and ğœ2. We
discuss the calculation of Â¯ğœ in Theorem 5.1.
Equation (1) is derived by separating the attackerâ€™s re-
ward into innocent mining reward and infiltration mining
reward. We have two cases for innocent mining reward: Case
1 and Case 4-1. The innocent mining reward is (1 âˆ’ ğœ1)ğ›¼ +
ğœ1ğ›¼ (1âˆ’ğœ2)ğ›¼
1âˆ’ğœ2ğ›¼ . For infiltration mining reward, we have three
cases: Case 3, Case 4-2, and Case 4-3. Since the attacker will
share the profit with other miners in pool, the reward will
be ğ›½ Â·
ğ›½+Â¯ğœ ğ›¼
in the three cases respectively. Therefore, we can derive the
attackerâ€™s reward in Equation (1).
ğ›½+ğœ1ğ›¼ , ğ‘ğœ1ğ›¼ Â· 1âˆ’ğ›¼âˆ’ğ›½
1âˆ’ğœ2ğ›¼ Â·
ğ›½+Â¯ğœ ğ›¼ , and ğœ1ğ›¼ Â·
1âˆ’ğœ2ğ›¼ Â·
ğœ1ğ›¼
Â¯ğœ ğ›¼
Â¯ğœ ğ›¼
ğ›½
Clearly, PAW downgrades to FAW when ğœ1 = ğœ2.
Theorem 5.1. The average portion of computational power
1,Â·Â·Â· ,ğ‘˜, ğ‘˜ (cid:62) 2):
for infiltration mining in ğ‘–-th pool, Poolğ‘–, is (Â¯ğœ (ğ‘–)
ğ‘— + ğœ (ğ‘–)
ğ‘˜ ğ›¼)âˆ‘ï¸€ğ‘˜âˆ’1
ğ‘–âˆˆğ’« ğœ (ğ‘–)
ğ‘—=1 ğœ (ğ‘–)
ğ‘˜
Â¯ğœ (ğ‘–)
1,Â·Â·Â· ,ğ‘˜ =
ğ‘–âˆˆğ’« ğœ (ğ‘–)
ğ‘˜ ğ›¼)(ğ‘˜ âˆ’ 1) + 1
,
(1 âˆ’âˆ‘ï¸€
(1 âˆ’âˆ‘ï¸€
ğ‘—
where ğœ (ğ‘–)
is the infiltration mining power in Poolğ‘– as a
portion of ğ›¼ between (ğ‘— âˆ’ 1)-th and ğ‘—-th FPoWs are found.
ğ’« is the victim pool set.
Specifically, in one victim scenario, when ğ‘˜ = 2, Â¯ğœ = Â¯ğœ (1)
1,2 ,
ğœ1 = ğœ (1)
1 , and ğœ2 = ğœ (1)
Â¯ğœ = Â¯ğœ (1)
1,2 =
2 , we have:
ğœ1 + ğœ2 âˆ’ ğœ1ğœ2ğ›¼
2 âˆ’ ğœ2ğ›¼
.
(2)
Proof of Theorem 5.1 is presented in Appendix-A.
How to adjust mining power? Based on Equation (1), we
formalize the best power adjusting strategy by finding the
optimal portion of attackerâ€™s computational power (Ì‚ï¸€ğœ1 and
Ì‚ï¸€ğœ2) to maximize the expected reward (ğ‘…ğ‘ƒ
ğ‘ (ğœ1, ğœ2)):
s.t.
ğ‘…ğ‘ƒ
arg max
0 (cid:54) ğœ1 (cid:54) 1,
ğœ1,ğœ2
ğ‘ (ğœ1, ğœ2),
0 (cid:54) ğœ2 (cid:54) 1.
(3)
Equation (3) can be solved by using Lagrange multipliers
(presented in Appendix-B). Besides, the maximized reward
withÌ‚ï¸€ğœ1 andÌ‚ï¸€ğœ2 satisfies the following theorem.
Theorem 5.2. A PAW attacker can always earn more
rewards than honest mining. The reward of a PAW attack
has a lower bound defined by the reward of an FAW attack.
Proof. Previous research [13] has shown that the reward
of an FAW attack is always greater than that of honest mining
(a) ğ‘…ğ¸ğ‘…ğ‘ƒ,ğ»
.
ğ‘
(b) ğ‘…ğ¸ğ‘…ğ‘ƒ,ğ»
.
ğ‘
Figure 2: A PAW attack against one pool. RERs of an attacker
and the victim pool, according to the size of victim pool ğ›½ and
coefficient ğ‘ when the attacker has 0.2 computational power
ğ›¼ = 0.2.
(ğ›¼) when a proper ğœ1 is chosen. Suppose the optimal ğœ1 for
an FAW attack is Ë™ğœ1. The reward of the FAW attack under
Ë™ğœ1 equals to the reward of a PAW attack when ğœ1 = ğœ2 = Ë™ğœ1.
Now considering a ğœ1-preset PAW attack with fixed ğœ1 = Ë™ğœ1,
and adjusting ğœ2 = Â¨ğœ2 to maximize the reward in Case-4. The
total reward of this ğœ1-preset PAW attack should be greater
than or equal to the FAW attack. Furthermore, considering
a regular PAW attack that adjusts ğœ1 and ğœ2 simultaneously
to maximize the reward atÌ‚ï¸€ğœ1 andÌ‚ï¸€ğœ2, the reward should at
least equal to the ğœ1-preset PAW attack. Therefore, we have:
ğ›¼ < ğ‘…ğ¹
ğ‘ ( Ë™ğœ1) = ğ‘…ğ‘ƒ
ğ‘ ( Ë™ğœ1, Ë™ğœ1) (cid:54) ğ‘…ğ‘ƒ
ğ‘ ( Ë™ğœ1, Â¨ğœ2) (cid:54) ğ‘…ğ‘ƒ
ğ‘ (Ì‚ï¸€ğœ1,Ì‚ï¸€ğœ2),
where ğ‘…ğ¹
attacker at Ë™ğœ1.
ğ‘ ( Ë™ğœ1) represents the maximized reward of an FAW
(cid:3)
Quantitative analysis and simulation. We use a spe-
cific case to show the additional reward of an attacker who
launches PAW attacks against one pool. Referring to [13], we
also use the expected relative extra reward (RER) to show
the performance of PAW attacks. The expected RER can be
expressed as
ğ‘…ğ¸ğ‘…ğ‘†1,ğ‘†2
ğ‘¥