DefCon 13
Shmoo-Fu: Hacker Goo, 
Goofs, and Gear with the 
Shmoo
The Shmoo Group
www.shmoo.com
DefCon 13
What's up Shmoo?
● Howdy & introductions...
● Our festivities will include:
– IDN Fallout & Homograph Attacks 
for Personal Identities
– Super Spy Stuff
– Revving Up Rainbow Tables
– Rogue Squadron & EAP Peeking
– Shooting Your Security Wad
– Don't Try This at Home
– And MORE!
DefCon 13
Stickers anyone?
DefCon 13
IDN Fallout
● At ShmooCon 2005, Eric 
Johansen dropped the browser 
bomb regarding IDN issues.
● The press ran with it a bit.
● The folks responsible for IDN 
ranted for a bit.
● But did anything concrete occur?
● And where are we now?
DefCon 13
1337 Personal Identities
● So Ericj is now 3ricj, BTW.
● Oh snap.  That rhymes.
● Where does the system break 
down when your name doesn't 
quite conform?
● Does 3ricj get more fan mail?
● Can the man keep your 1337 
identity down?
DefCon 13
And now...
Pablos.
DefCon 13
Super Spy Stuff
● Robots got boring, so Pablos 
starting hanging out with models 
after his chic hacker photo shoot 
in FHM.
● The result was nothing short of 
spectacular, as the fashionable 
cell-phone stowaway strifes hot 
women face were finally 
addressed.
DefCon 13
While Pablos discusses 
the alien technology 
inner workings of his 
secret ninja lair, you can 
stare at this...
DefCon 13
DefCon 13
Dan Moniz goes crazy...
DefCon 13
rainbowtables.shmoo.com
● We think rainbow tables are neat.
● Just for fun, we started hosting 
rainbow tables that we had  
generated.
– LanMan
– Via Bittorrent
– FREE
● Some people liked that.  Yay!
● Some people didn't...
DefCon 13
---------- Forwarded message ----------
From: Zhu Shuanglei 
Date: Mar 10, 2005 12:42 AM
Subject: About your shmoo site
To: PI:EMAIL
Hi, 
I am Zhu Shuanglei, the author of RainbowCrack software. I notice you are 
offering free BitTorrent links on your website for the rainbow tables. For 
those guys selling the table without permission from me, they are not welcome. 
But you are worse. 
As you may know, I develop the rainbowcrack tool and release it the the public 
for free. I just want to introduce the technique to the world and those need it 
can benifit from this software. If I sell the tables, I am only making some 
money for my work and for the fee of hosting my website and for my computing 
resource. This should be quite reasonable. I am not a business man, if I am 
there will not be the source code or table generation tool free on the net and I 
can make a lot of money. 
Are you feeling you are cool "Because knowing all passwords is cooler than 
trying to crack one. ;)". All over the world there will be a lot of guys can do 
what you do, they aren't. Do you know why? To show off prove neither your 
ability nor your knowledge. 
If possible, please keep honour of my intellectual property of this software, 
and let those need the tables to generate by themself. If everyone act like you 
there will be no reason for me to develop this software further or develop 
other useful software. Or I will never release anything useful to the public. 
Don't be crazy any more! 
Best Regards, 
Zhu Shuanglei 
DefCon 13
Revving Up Rainbow 
Tables
● So, badass LanMan tables are 
online now via Bittorrent, and 
still for FREE.
● Sorry for the delay!
● Meanwhile, Dan decided to “be 
crazy” a bit more.
● We don't need your stinkin' code, 
Zhu!
● And Snax says, “FUCK OFF!”
DefCon 13
New Wi-Fi kung-fu from 
Beetle...
DefCon 13
Why oh why do we Wi-Fi?
● Who here has an open wireless 
network at home?  At work?
● Crap!  My Tivo can't do WPA.  
Neither can my PSP.  Ummm... 
does it matter?
● When and where should we Wi-
Fi?
– Coffee Shops?  Airports?  Hospitals?  
Banks?  Ummm... Nuclear Power 
Plants?
DefCon 13
Where did we go wrong?
Where are we going?
● Technology of convenience versus 
the inconvenience of securing it.
● The poor, poor users were left out 
in the authentication cold.
● Half-ass security standards pass 
the buck and / or provide defacto 
insecure options.
● Security acronyms have taken 
precedence over proper 
implementation.
DefCon 13
DefCon 13
DefCon 13
How the FUCK does the 
user know?!
DefCon 13
Access Point
SSID: “goodguy”
SSID: “badguy”
Stronger or Closer
Access Point
“ANY”
Wi-Fi Card
SSID:
“goodguy”
“badguy”
DefCon 13
Rogue AP Attacks
Normal 
Gear @ 
25mW
(14dBm)
Cisco Gear @ 
100mW
(20dBm)
Senao Gear @ 
200mW
(23dBm)
Use a 15dBd 
antenna with a 
Senao for 
38dBd total...
6 WATTS!
VS 25mW?
BAD GUY 
WINS!  NO 
CONTEST!
Choose your Wi-Fi
weapon...
DefCon 13
DefCon 13
DefCon 13
DefCon 13
Rogue RADIUS
● Who says rogue APs can't be used 
against corporate wireless 
networks?
● There are plenty of ways to screw 
up EAP.
● FreeRADIUS provides a simple & 
easy way to accept EAP 
credentials
– Integrates nicely with hostapd.
● Can allow for “EAP Peeking”...
DefCon 13
EAP
Authentication
Server
Supplicant
Wireless
Wired
Authenticator
EAPOL-Start
EAP-Request / Identity
EAP-Response / Identity
EAP-Response / Identity
EAP-Request
EAP-Request
EAP-Response
EAP-Request
EAP-Success
EAP-Success & Key
EAP-Key
DefCon 13
EAP-TLS
Authentication Server
w/ Certificate
Supplicant 
w/ Certificate
Wireless
Wired
Authenticator
EAP-Success
EAP-Success & Key
EAP-Key
802.11 Authentication &
Association
802.1x EAP Protocol Exchange
802.1x EAP-TLS Protocol Exchange
DefCon 13
EAP-TTLS
Authentication Server
w/ Certificate
Supplicant
Wireless
Wired
Authenticator
EAP-Success
EAP-Success & Key
EAP-Key
802.11 Authentication &
Association
802.1x EAP Protocol Exchange
802.1x EAP-TTLS Protocol Exchange
Secure Tunnel Established
User Credentials Exchanged
DefCon 13
EAP-TTLS Weakness
Authentication Server
w/ Certificate
Supplicant
Authenticator
802.1x EAP Protocol Exchange
802.1x EAP-TTLS Protocol Exchange
Secure Tunnel Established w/o Remote Certificate Check?
User Credentials Given Up?
Previous EAP-TTLS
Authentication Established
Rogue AP +  
RADIUS
DISASSOCIATED!
802.11 Authentication &
Association
DefCon 13
2. Learn username & 
password.
EAP-TTLS w/ 
PAP
Attack?
RADIUS
Server
Windows XP 
w/ SP2
Wireless
Wired
EAP-TTLS w/ PAP 
over TLS
Rogue AP w/
Rogue RADIUS
Server
1. Disassociate users.
3. Disassociate, copy creds 
to local EAP config.
4. Impersonate victim with 
legit username & password 
whenever.
DefCon 13
All Your PAP... Google for 
targets, if you like. ;)
DefCon 13
All Your CAs... The “All or 
None” Vulnerability
DefCon 13
2. Learn DOMAIN and 
username w/ rogue AP.
PEAP Attack?
RADIUS
Server
Windows XP SP2
Wireless
Wired
PEAP w/ 
MSCHAPv2 
over TLS
Rogue AP w/
Rogue RADIUS
Server
1. Disassociate users.
3. Disassociate, seed 
local password file.
5. Repeat #3.  
Authentication success 
= correct password 
guessed!
4. User continuously 
attempts to re-
authenticate.
DefCon 13
EAP Peeking Attack Demo
DefCon 13
Wireless Weaponry for 
Windows
● But rogue AP attacks require a 
“sophisticated hacker”, right?  
Wrong.
● SoftAP + TreeWalk + Apache + 
ActivePerl = Airsnarf for 
Windows
– http://airsnarf.shmoo.com/airsnarf4win.html
– “Evil Twin Access Points for Dummies”
● But why only run one rogue AP, 
when you can run two... or three?
DefCon 13
Windows Rogue AP Attack 
Demo
DefCon 13
Rogue Squadron Demo
DefCon 13
Heeeeeeere's Rodney!
DefCon 13
Shooting Your Security Wad
(Never let Beetle title your slides)
DefCon 13
Why is Rodney ranting 
now?
● Been doing product reviews 
(public and private)
● Keep seeing some incredibly lame 
product “features”
● There’s a risk of FPGS (Ford 
Pinto Gastank Syndrome)
DefCon 13
Three Hard Questions?
● Does your product produce an 
external log?
● Do you have a security incident 
report mechanism?
● Does your product store it’s key 
material securely?
      Why are these hard questions in 2005?
DefCon 13
Don’t make things worse
● Text t.b.d.
DefCon 13
Stupid Vendor Tricks
● (things you can’t believe a 
security vendor would try to sell 
to a security customer.)
DefCon 13
Attacks you should try
● (Things you already knew that 
you should try on your security 
infrastructure)
DefCon 13
How you can make things 
better
● (We’re not the bad guys.  We’re 
trying to be educated consumers.  
Here’s some things you can do to 
help make things better.)
● If you show how one of these 
possible flaws can be broke, 
submit to present it at shmoocon 
2006)
DefCon 13
Did you want more gear?
Okey dokey.
CowboyM, show 'em what 
you got.
DefCon 13
New Gear Demo
DefCon 13
And Bruce gets to rant, 
too!
DefCon 13
Bluetooth Security
● Things have gotten worse, not better
– Millions more radios than last year
– Several high profile vulnerabilities
– Near zero focus from enterprises
• Trifinite.org’s work
– Blooover quite the uber tool
DefCon 13
Bluetooth Security
● Several other attacks via AT 
commands
– Dialing, getting data, etc… not good 
things to do without authentication
• Pairing attacks, known for years, are 
now being coded and used
• WIDS still seems to equal 802.11 
tho…
– Gonna be a bad year for IT security
DefCon 13
Defending Wireless 
Networks
● We seemed to have covered a lot of 
ground on the Offensive.. What about 
Defense *boom boom* Defense!
● First there was Host Spot Defense 
Kit (HSDK)
– Released BH Fed 03
– Looked for directed rogue AP attacks 
against your client
– OS X, Linux, and Windows code
DefCon 13
Defending Wireless 
Networks
● At the time of HSDK, there was NO 
capability for rogue detection in 
commercially avail software
● Today, we’re still not much better
– AirDefense Mobile, some other small stuff
– Rogues are THE BIGGEST threat against 
enterprise networks
• So, while the industry is still finding 
their whatnot with both hands, we’re 
making…
DefCon 13
Hot Spot Defense Kit v2
● Enterprise wireless IDS systems look 
for any attack, not just one directed 
at a particular client
● When you are on the road (or don’t 
have the “luxury” of an enterprise 
WIDS) you need the same kind of 
protection
DefCon 13
Hot Spot Defense Kit v2
● HSDK v 2 aims to be an 
environmental monitor of sorts
– Looks  for any zip in the wire, not just 
ones directly effecting the client
– If you’re in downtown Baltimore, and 
someone starts shooting, you tend to 
freak out even if they’re not shooting at 
you… wireless shouldn’t be any different
DefCon 13
HSDK v2
● Still under development
● Looking for:
– Mass auth/deauth/assoc attacks
– Fake AP signatures
– Reinjection attacks (hard)
– The standard rogue detection stuff from 
v1
• If something is detected, the green 
ball turns red (step away from the 
computer)
– If security software isn’t usable, it’s 
useless
DefCon 13
Speaking of…
● As security professionals, we sure 
haven’t learned much
– Security needs to be usable by the users
● Users need hueristic decisions made for them 
and presented in red or green balls
– Security admins need to act like 
professionals and have a real 
understanding of their operations
IT Security Professional
Normal Users
IDS
IDS
Knowledge really needed by user
A real 
Enterprise
View
Host and Enterprise
INTEGRITY Monitoring
DefCon 13
Potter’s Pyramid of IT 
Security Needs
IDS
Patch Mgt
Op. Procedures
Firewalls
Auth / Auth
Software ACLs
Sec
Honeypots
Sophistication and Operational Cost
DefCon 13
Links
DefCon 13
Another Shmoo 
Announcement Goes Here
DefCon 13
Thanks!  Questions?