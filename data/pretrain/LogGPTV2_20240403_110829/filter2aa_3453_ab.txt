03e39fb27eb26a6526964222c122c16d
2018-08-11 13:25
2019-08-03 07:37
TCP
8291
97.36
2
f047b5467b1dfeaf08c1924b9bf54a99
2018-08-19 03:09
2019-04-26 02:50
TCP
7547
94.83
5
6eecae4387d119ea3f5a0174f11872cc
2018-08-22 12:19
2018-11-29 12:45
TCP
9000
99.80
2
d2f3ae69fc94c21089fa215e674a73be
2018-11-12 20:06
2019-02-26 00:25
TCP
49152
99.64
1
e49e2b772796feae1d42d805e48bc454
2019-01-01 05:36
2019-08-19 11:02
TCP
60001
97.89
11
eb3111d9525e38decf1e97cb1d2d5071
2019-06-24 06:58
2019-07-31 05:44
TCP
34567
96.38
2
a5f8eb80f9c8421707a407c8d0ebed98
IoT端口被蠕虫式扫描
Exploits
IoT Product
Port
Reference
Mallware Family
TR069- WAN Side Remote Command Injection
Zyxel Router
TCP/7547
TCP/5555
https://www.exploit-db.com/exploits/40740
Mirai DGA
ASUS Router infosvr UDP Broadcast root Command Execution
ASUS Router
UDP/9999
https://github.com/jduck/asus-cmd
TheMoon
Mirai
MCTP SetPppoeAttr RCE
EnGenius EnShare IoT Gigabit Cloud Service 1.4.11 - Remote Code 
Execution
Swann, Lorex, Night Owl, Zmodo, URMET, kguard 
security, etc
EnGenius EnShare Router
TCP/9000
http://console-cowboys.blogspot.com/2013/01/swann-song-dvr-
insecurity.html
https://www.exploit-db.com/exploits/42114
Hajime
Mirai
Netcore/Netis Routers - UDP Backdoor Access
Netcore/Netis Routers
UDP/53413
https://www.exploit-db.com/exploits/43387
Gafgyt
Mirai
D-Link Devices - UPnP SOAP Command Execution
D-Link Router UPnP SOAP interface
TCP/49152
https://www.exploit-db.com/exploits/27044
Mirai
Realtek SDK - Miniigd UPnP SOAP Command Execution
Realtek SDK UPnP SOAP interface
TCP/52869
https://www.exploit-db.com/exploits/37169
Mirai
MiCasa VeraLite Remote Code Execution
MiCasa VeraLite Controller
TCP/49451
https://www.exploit-db.com/exploits/1188
Mirai
Huawei Router HG532 - Arbitrary Command Execution
Huawei Router HG532
TCP/37215
https://www.exploit-db.com/exploits/43414
Satori
Dahua DVR 2.608.0000.0/2.608.GV00.0 - Authentication Bypass
Dahua Camera
TCP/37777
https://www.exploit-db.com/exploits/29673
Mirai
QNAP Transcode Server - Command Execution (CVE-2017-13067)
QNAP NAS
TCP/9251
https://www.exploit-db.com/exploits/42587
CoinMiner
XiongMai DVRIP Remote Code Execution
XiongMai DVR
TCP/34567
https://twitter.com/zom3y3/status/1100667242159558656
Fbot
JAWS DVR Remote Code Execution
Mvpower 8 Channel Security DVR
TCP/60001
https://www.pentestpartners.com/security-blog/pwning-cctv-cameras/
Mirai
Google Android ADB Debug Server - Remote Payload Execution
Google Android ADB Debug Server
TCP/5555
https://www.exploit-db.com/exploits/39328
Fbot
MikroTik RouterOS Winbox & Webfig 
MikroTik RouterOS Winbox & Webfig
TCP/8291
TCP/80
https://wikileaks.org/ciav7p1/cms/page_16384604.html
ChimayRed
15个IoT特殊端口被恶意软件利用
如何发现Fbot Botnet使用DVRIP 0day漏洞传播
1.
最开始只看到HTTP端口扫描上升
2.
通过Anglergish蜜罐不断地Fuzz testing，
即使没有完整交互，也能获得Fbot样本
3.
中间人转发Fbot扫描流量到真实设备，获
取到DVRIP 协议关键Exploit
0-day Exploit
InstallDesc File Created: December 8, 2018 at 05:39 (UTC+8)
更多内容：https://blog.netlab.360.com/the-new-developments-of-the-fbot/
Sofia OPSystemUpgrade  0-day漏洞分析
更多内容：https://twitter.com/zom3y3/status/1100667242159558656
PART 
04
如何去挖掘未知的IoT Botnet样本
样本来源：Anglerfish Honeypot，VirosTotal，360Netlab其它样本源
样本类型：ELF Executable（x86，x86-64，arm，mips）
Unknown Botnet：VT 0/1识别，Bot 样本，有C2
技术组件：特征库，聚类，沙箱，代码相似性，人肉分析（IDA）
概览
推文：#unknown_botnet
Blog报告：Linux.Ngioweb，Godlua
特殊发现：某IoT特马，未公开
更多内容：https://twitter.com/search?q=#unknown_botnet
VirusTotal Intelligence: Search
positives:0 tag:"elf" not tag:"contains-elf" not tag:"shared-lib" not tag:"coredump" not tag:"relocatable" size:10MB-
使用VT Intelligence Search API获取ELF样本列表，然后使用360内部样本下载接口下载样本
更多内容：https://support.virustotal.com/hc/en-us/articles/360001387057
筛选未知ELF样本流程
自动化流程：
样本源
ESET 
NOD32
CPU架构
ELF Type
Vaild ELF
Yara
SSDC聚类
可疑样本
人肉流程：
可疑样本
函数相似
性
Detux 
Sandbox
人肉分析
未知威胁
样本过滤器
Total File
Code Section
Symbol Section
String Section
Disassembly Function Code
数据源：样本静态信息
聚类，过滤同类样本 （ SSDC）
特征库，过滤已识别样本 （ESET NOD32）
开源小工具：https://github.com/zom3y3/ssdc
Detux Sandbox Modified
Operating System：SandboxOS
Network: iptables， mitmproxy，fakedns
Malawre Analysis: ESET NOD32， Yara，VirusTotal
Packet Analysis：DNS，HTTP
Strace Analysis：Stracer
开源小工具：https://github.com/zom3y3/stracer
函数相似性
IDA FLIRT
fn_fuzzy
Karta
idenLib
Diaphora
BinDiff
Intezer Analyze
https://github.com/TakahiroHaruyama/ida_haru/tree/master/fn_fuzzy
PART 
05
总结
IoT 安全防御能力不足
IoT Botnet 攻击能力不断升级
IoT 设备已经成为APT攻击目标
欢迎关注Twitter/WeChat：@zom3y3
获取前沿安全资讯，Botnet内幕
谢谢!