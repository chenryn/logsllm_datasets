如图1所示，该架构中的故障隔离交换机一般为二层交换机，两台
2.3 互联网下一代防火墙 故障隔离交换机可以采用堆叠或Trunk方式互联，其作用是在上
为满足网络安全等级保护和安全防御的基本要求，如图1所示， 下联的安全设备自身发生故障或因线路故障导致接口为down时，
金融企业的互联网边界网络安全纵深防御体系架构应具备防火墙 隔离故障的传导，确保安全设备HA切换后网络的连通性。随着
功能，支持透明、路由等多种模式灵活部署。随着防火墙技术的发 网络安全纵深防御架构功能的扩展，该故障隔离交换机上可以用于
展，下一代防火墙普遍集成了四层防火墙、IPS、应用控制、防病毒、 统一接入其他的各类网络安全设备，如SSLVPN、零信任SDP网
URL过滤和安全沙箱等多项安全功能，并基于性能考虑，采用专 关以及IP封禁网关（常用于日常安全运营或安全重保期间）等，
用ASIC芯片进行相关安全功能的处理。当前，下一代防火墙已成 为互联网的前端网络接入提供可扩展的、丰富的安全控制措施。
为金融企业互联网边界纵深防御体系架构中的重要组成部分。下一
代防火墙在互联网边界实现入站和出站两个方向五元组的L4层访 2.6 网关交换机
问控制，以及入侵防御、应用控制、防病毒、URL过滤和安全沙 如图1所示，该架构中网关交换机主要包括DMZ区服务器网关交
箱等多种L7层应用安全功能，相比传统的L4层防火墙，具有更 换机和中台数据库（DB）服务器网关交换机，均为三层交换机，
深入、更细颗粒度的应用层攻击检测和防御能力，满足等保2.0标 支持IPv4/IPv6双栈协议和IP路由转发功能，实现DMZ区应用
准的基本要求。 服务器和中台区数据库DB服务器的IP路由网关功能，每对堆叠
的网关交换机与区域边界防火墙通过VLAN的三层SVI接口互联。
2.4 下一代WAF 为确保设备高可用，推荐网关交换机采用堆叠方式部署，服务器的
为满足等级保护和Web应用安全防御的基本要求，如图1所示， 两个网卡与两台交换机分别上联（双上联）。
金融企业的网络安全边界纵深防御体系架构应具备Web安全防护
功能，支持透明代理、透明桥、路由代理和反向代理等多种模式 2.7 区域边界防火墙
灵活部署，且设备接口支持断电bypass功能。下一代WAF设备 如图1所示，该架构中的区域边界防火墙，部署于数据中心每个
为互联网边界同时提供基于攻击特征及攻击行为的Web攻击防护 安全区域的边界，采用防火墙管理平台进行集中统一的运行管理和
能力，为DMZ区所有Web服务提供统一的Web攻击防护功能， 安全策略下发，实现各安全区域间的精细化网络安全访问控制，是
能够支持0day漏洞防护能力，实现Web攻击告警和拦截，支持 内网安全不可或缺的安全控制措施。为确保防火墙的高可用和安全
186 187
行
业 金融企业网络安全边界纵深防御体系及其演进
专
刊
性，该架构中每个区域边界防火墙推荐采用双机部署，如主备HA 四、网络安全纵深防御体系的演进
方式，并根据金融行业最佳实践，采用和互联网下一代防火墙异构
的品牌，进一步提高安全性。 在网络空间安全运营的视角下，仅有网络边界的纵深防御能力是远
远不够的，网络攻击者的攻击手段层出不穷，不能寄希望于网络边
2.8 数据中心骨干网 界防御所有可能的攻击。网络空间的安全防护位置必须覆盖到终
如图1所示，该架构中的数据中心骨干网采用传统的“核心+汇 端、网络、边界和服务端/云端等各网络流量所经过的各环节，作
聚+接入”三层架构，数据中心核心层与各区域的汇聚层之间通 为网络安全边界纵深防御架构的演进，构建较为完善的网络安全纵
过OSPF动态路由协议交换与更新各安全区域的IP路由信息，所 深防御体系，金融企业还需要在以下几个方面进一步完善和增强。
有网络设备均采用双机部署，核心层和与各区域汇聚层之间通过
OSPF路由协议ECMP机制实现网络设备和链路的动态双活，确 在安全技术层面，除了在网络边界部署纵深防御措施外，服务器和
保数据中心骨干网络高性能高吞吐的流量转发。各区域汇聚层和接 终端（含PC和移动终端），作为最主要的计算端点，通常承载着
入层之间嵌入区域边界防火墙，接入层交换机为本区域内服务器提 金融企业的核心数据，是网络攻击的目标靶点。作为系统的最后一
供高可用网络接入。 道防线，需要在终端部署网络准入、桌面终端安全管控和防病毒软
件，在服务端部署安全基线、防病毒软件、端点检测与响应（EDR）
三、网络安全边界纵深防御体系的优势与价值 软件、微隔离等安全措施。在服务端还有必要部署网络安全威胁感
知系统、安全运营中心（SOC）与态势感知系统、威胁情报中心、
在“云+零信任”时代，虽然网络边界已经日渐复杂和模糊，但 APT攻击检测系统、蜜罐蜜网与溯源分析系统、堡垒机与特权账
网络边界仍是金融企业网络安全防护的重要阵地。网络安全防护主 号管理、文件沙箱检测系统、数据防泄漏（DLP）系统、数据库安
要作用是拒绝网络非授权访问、实现对内外部网络攻击的主动防御 全与审计系统、用户行为审计系统、应用数据及API安全风险监
阻断，筑起网络安全纵深防御的第一道防线。如图1所示，该架 测系统等。上述列举的多数安全系统可以和防火墙、WAF等安全
构虽为经典的传统数据中心网络安全边界防御体系架构，其通过较 网关设备联动，实现安全编排与自动化响应（SOAR）功能，达成
为合理的安全区域划分和精细化、多维度的安全检测，为数据中心 网络攻击发现和阻断的全自动化目标。
的网络访问提供较为完善的边界安全纵深防御体系，网络入侵者必
须突破层层堡垒才能接触到安全区域内的核心数据资产，攻击方的 在组织管理层面，网络安全纵深防御的技术体系真正发挥作用，最
入侵难度和入侵成本将大幅度提高。当下行之有效的网络安全边界 终都离不开人的使用，网络安全纵深防御体系最后也是最重要的一
纵深防御体系仍然是金融企业线上业务运行所必须的基本网络安 道防线，即网络安全组织体系建设。网络攻与防的较量归根结底是
全防御手段，能有效降低金融企业内外部网络攻击带来的风险和损 人的较量，金融企业应依托网络安全组织体系建立较为完善的网络
失。 安全运营机制，实现企业范围内网络安全管理和运营的全流程覆
188 189
行
业 金融企业网络安全边界纵深防御体系及其演进
专
刊
盖。此外，金融企业的员工安全意识教育和网络安全攻防演习也是 深防御体系是否健壮，促进纵深防御体系的持续改进，快速提升安
网络安全运营中的关键环节。虽然网络攻击手段层出不穷，但基于 全人员的安全能力；此外，通过以攻击方视角执行的实战攻防，能
人的社会工程学攻击在网络攻击体系中仍占据重要地位，安全意识 够帮助金融企业找到防守方视角的缺失，进而全方位的提升企业网
教育仍是提升员工安全意识最有效的手段。同时，在组织管理上， 络安全能力，尤其是当攻击方是国家级背景的黑客组织时，对方会
金融企业还需要注重打造一支协调有力、反应迅速、处置得当的网 不断改变攻击技术与战术，只有经过实战检验才能筑牢金融企业的
络安全团队，能在日常的渗透测试、安全攻防实战演习、安全事件 网络安全纵深防御体系。
应急处置等工作中，打磨并形成一整套适合企业自身的行之有效的
网络安全运营机制，持续提高企业的网络安全运营水平。
五、小结
网络安全纵深防御体系在本质上是多层次、多维度的安全防御体
系，金融企业在构建网络安全纵深防御体系后，针对安全威胁的检
测深度和广度将得到全面提升，发现安全威胁的精确度和时效性也
将得到显著提高，同时，网络攻击者的入侵难度和成本将大幅度提
高，这就使得金融企业能有充足的时间进行应急响应和处置。
随着数字经济的不断发展，云计算、大数据、人工智能、区块链等
新兴技术迅速发展，网络空间和现实物理空间的边界进一步消融，
安全攻防双方的技术能力也在交叠上升，网络攻击、数据泄露、安
全漏洞等安全问题呈现新的变化。为应对不断演变的网络安全问
题，金融企业的网络安全纵深防御体系将亟待进一步演进：一方
面，正所谓未知攻焉知防，随着安全攻击新手段和新场景的出现， 作者介绍 SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN
新的网络安全防御技术及工具也将不断涌现，这些都将持续充实与
宋士明，高级工程师，负责公司网络与信息安全体系规划、建设与管理，擅长企业网
完善现有纵深防御体系，但再高级的纵深防御技术体系只有配合网 络与信息安全架构、安全与IT风险管理，近10年网络安全从业经历，专注于甲方企
业网络与信息安全、持有CISSP/CISM/CISA/CRISC/PMP/CISP等10余项专业
络安全专家和持续改进的安全运营流程才能发挥最大的作用；另一
认证，工作发表期刊论文4篇，发明专利2项（已过初审），曾荣获深圳证券交易所
方面，网络安全的本质是人与人的对抗，经过实战攻防对抗来精准
先进个人、南京市劳动模范等荣誉称号。兼任诸子云南京分会会长，(ISC)2南京分
挖掘网络安全纵深防御体系存在的潜在漏洞及威胁，能有效验证纵 会秘书长。
SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN SEC-UN
190 191
证券行业应用安全架构设计实践
某证券公司 江旺 庄飞
行
业
专
刊
摘 要：当前金融行业面临前所未有的威胁挑战，而大量的应用层
安全漏洞暴露出安全开发实践方面的欠缺。为了降低漏洞修复成
本，安全“左移”是一个趋势。本文将从证券机构金融APP的实际
案例入手，讲解如何通过轻量级威胁建模，进行应用安全架构设计，
系统性地降低应用系统安全风险。
关键词：安全架构设计 轻量级威胁建模 自动化威胁建模
01 前言
根据Freebuf《2020-2021金融行业网络安全研究报告》显示，
随着越来越多的金融机构进行数字化转型，信息化、网络化已成为
现代金融行业的重要特征。与此同时，金融行业的网络安全风险不
断累积，金融安全防护面临前所未有的威胁挑战。Web安全漏洞
依旧是最主流的漏洞类型，热门漏洞有XSS、SQL注入、敏感信
193
行
业 证券行业应用安全架构设计实践
专
刊
息泄露、未授权访问、弱口令、远程代码执行、任意文件读取、逻 为了尽早发现安全风险，降低漏洞修复成本，安全左移是一个趋势。
辑漏洞等，暴露出应用系统在安全开发实践方面的欠缺。应用系统 在项目早期阶段进行安全架构设计，是一个系统性解决安全风险的
上线后漏洞修复往往要耗费较长时间和较高的成本。 有效方法。本文将从金融APP的实际案例入手，探讨如何通过轻
量级威胁建模进行应用安全架构设计。