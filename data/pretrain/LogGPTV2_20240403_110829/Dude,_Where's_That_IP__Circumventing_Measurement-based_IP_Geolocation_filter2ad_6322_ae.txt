X
P
[
 0
100
101
undns-attack (EU+NA)
no attack (undns)
hop-adding (EU+NA)
no attack
103
102
105
localization region size (km2)
104
106
107
Figure 16: CDF of change in direction for the topology-
based and undns extension.
Figure 17: CDF of region size before and after the
topology-based attack and undns extension.
be geolocated to a similar location regardless of where
the target location was originally located.
We next conﬁrm that the adversary is able to move in
her chosen direction. Figure 16 shows the difference be-
tween the direction the adversary tried to move the target
and the direction the target was actually moved (θ in the
delay-adding attack). For the general topology-based at-
tack, the adversary is within 36 degrees of her intended
direction 75% of the time and within 69 degrees 90% of
the time. This improves with the undns extension where
the adversary is within 3 degrees of their intended direc-
tion 95% of the time. When the target attempts to move
from Europe to North America, they always move very
close to their chosen direction. The adversary always is
within 10 degrees of her chosen direction. The smaller
change in direction for European nodes stems from the
longer distance between the target and the forged loca-
tion. This causes a smaller change in direction to be ob-
served for similar error values compared to a target that
is closer to the forged location.
5.3.2 Attack detectability
We have observed that an adversary executing the
topology-based attack and the undns extension to the at-
tack can accurately relocate the geolocation target. We
next consider whether the victim would be able to detect
these attacks and reduce their impacts on geolocation re-
sults.
Figure 17 shows the region sizes for topology-aware
geolocation and undns geolocation before and after the
attacks are executed (for both North America and Eu-
ropean targets). Unlike the delay-adding attack, the ad-
versary that adds hops to the traceroutes of the victim
has region sizes similar to the original algorithms and,
in some cases, even smaller region sizes. For topology-
aware geolocation, we observe median region sizes of
102,273 km2 before and 50,441 km2 after the attack. For
the undns extension, we observe median region sizes of
4,448 km2 before and 790 km2 after the attack. These re-
sults indicate that region size is a poor metric for ruling
out attacks that add hops to the end of traceroute paths.
Another metric that may be used to rule out geoloca-
tion results that have been modiﬁed by an adversary is
path circuitousness. We deﬁne circuitousness of a tracer-
oute path between landmark, Li, and the target as fol-
lows, where r = (λr, φr) is the location returned by the
geolocation algorithm, and hj = (λj , φj) is the location
of intermediate hop j as computed by the geolocation al-
gorithm:
C =
dih0 + Σn
j=1dhj−1hj + dhnr
dir
(6)
Figure 18 shows the distribution of circuitousness for
paths between each landmark and the target for topology-
aware geolocation before and after the topology-based
attack is executed3. We observe that when the topology-
based attack is executed the circuitousness per landmark
increases. One criterion a geolocation algorithm can
use for discarding results from the topology-based at-
tack would be to discard results from landmarks where
the circuitousness is abnormally high. If a geolocation
framework that assigns weights to constraints, such as
Octant, is used, constraints from landmarks with high
circuitousness could be given a lower weight to limit the
adversary’s effectiveness. We note that a clever adver-
sary could design her network to use more direct paths,
making it more difﬁcult to detect the attack by observing
circuitousness.
]
x
<
X
P
[
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
 1
no attack
hop-adding (EU)
hop-adding
 5
 25
 125
 625
circuitousness per landmark
Figure 18: CDF of circuitousness for each landmark be-
fore and after the topology-based attack.
6 Related work
While there have been many related works on developing
and evaluating geolocation algorithms (e.g., [12, 14, 26,
30]), there has been limited study of IP geolocation given
a non-benign target [5, 18].
consider
Castelluccia et al.
the application of
CBG [12] to the problem of geolocating hidden servers
hosting illegal content within a botnet [5]. The technique
used to hide these servers is referred to as “fast-ﬂux”,
where a constantly changing set of machines infected by
a botnet is used to proxy HTTP messages for a hidden
server. Geolocating these servers is important to enable
the appropriate authorities to take action against them.
Castelluccia et al. leverage the fact that the hidden server
is behind a layer of proxies to factor out the portion of
the observed RTT caused by the proxy layer. They use
HTTP connections to measure RTTs (because the hidden
servers are unlikely to respond to ping ) and factor out
additional delay caused by the layer of proxies to geolo-
cate hidden servers with a median error of 100 km using
PlanetLab nodes as ground truth hidden servers.
Muir and Oorschot survey a variety of geolocation
techniques and their applicability in the presence of an
adversarial target [18]. Their work is similar to but dis-
tinct from ours. Speciﬁcally, they emphasize geolocation
techniques that leverage secondary sources of informa-
tion, such as whois registries based on domain, IP and
AS; DNS LOC [8]; application data from HTTP head-
ers, and data inferred from routing information. They
consider delay-based geolocation but do not specify or
evaluate any attacks on measurement-based geolocation.
Muir and Oorschot discuss the limitations of IP geolo-
cation when an adversary attempts to conceal her IP ad-
dress through the use of an anonymization proxy and ex-
amine how a Web page embedding a Java applet can dis-
cover a client’s true identity using Java’s socket class to
connect back to the server. They demonstrate this strat-
egy for identifying clients using the Tor [28] anonymiza-
tion network.
These previous works begin to consider the perfor-
mance of geolocation algorithms when the target of ge-
olocation may have incentive to be adversarial. However,
they generally focus on the issue of geolocating hosts that
attempt to deceive geolocation using proxies.
In con-
trast, we develop and evaluate attacks on two classes of
measurement-based geolocation techniques by manipu-
lating the network properties on which the techniques
rely.
We observe that the problem of geolocating an adver-
sarial target is similar to the problem of secure position-
ing [4] in the domain of wireless networks. Unlike wire-
less signals, network delay is subject to additive noise
as a result of congestion and queuing along the network
path as well as circuitous routes. Multiple hops along
network paths on the Internet and the existence of large
organizational WANs also enable new adversarial mod-
els in the domain of IP geolocation.
7 Conclusions
Many applications of geolocation beneﬁt from security
guarantees when confronted with an adversarial target.
These include popular applications, such as limiting me-
dia distribution to a speciﬁc region, fraud detection, and
newer applications, such as ensuring regional regulatory
compliance when using an infrastructure as a service
provider. This paper considered two models of an adver-
sary trying to mislead measurement-based geolocation
techniques that leverage end-to-end delays and topology
information. To this end, we developed and evaluated
two attacks against delay-based and topology-aware ge-
olocation.
To avoid detection, adversaries can leverage inherent
variability in network delay and circuitousness of net-
work paths on the Internet to hide their tampering. Since
these properties are measured and used by various geolo-
cation techniques, they serve as good attack vectors by
which the adversary can inﬂuence the geolocation result.
Our most surprising ﬁnding is that the more advanced
and accurate topology-aware geolocation techniques are
more susceptible to covert tampering than the simpler
delay-based techniques. For geolocation algorithms that
leverage delay, we observed how a simple adversary that
only adds delay to probes could alter the results of ge-
olocation. However, this adversary has limited precision
when attempting to forge a speciﬁc location. We also
observed a clear trade-off between the amount of delay
an adversary added and her detectability, using the re-
gion size returned by CBG [12] as a metric for discarding
anomalous results.
Compared to delay-based geolocation,
topology-
aware geolocation fares no better against a simple adver-
sary and worse against a sophisticated one. Topology-
aware geolocation uses more information sources, such
as traceroute and undns , to achieve higher accuracy than
delay-based geolocation. Unfortunately, this advantage
becomes a weakness against an adversary able to corrupt
these sources. A sophisticated adversary that can lever-
age multiple network entry points (e.g., an infrastructure
as a service provider) can cause the geolocation system to
return a result as accurate as the best case simple adver-
sary without increasing the resultant region size. When
undns entries are corrupted, the adversary is able to forge
locations with high accuracy without increasing the re-
gion sizes – in some cases, even decreasing them.
Our work reveals limitations of current measurement-
based geolocation techniques given an adversarial target.
To provide secure geolocation, these algorithms must ac-
count for the presence of untrustworthy measurements.
This may be in the form of heuristics to discount mea-
surements deemed untrustworthy or through the use of
secure measurement protocols. We intend to explore
these directions in future work.
Acknowledgements
The authors would like to thank the anonymous review-
ers and our shepherd, Steven Gribble, for their feed-
back, which has helped to improve this paper. This work
was supported by the Natural Sciences and Engineering
Research Council (NSERC) ISSNet and NSERC-CGS
funding.
References
[8] DAVIS, C., VIXIE, P., GOODWIN, T., AND DICKINSON, I. A
means for expressing location information in the domain name
system. RFC 1876, IETF, Jan. 1996.
[9] ERIKSSON, B., BARFORD, P., SOMMERS, J., AND NOWAK, R.
A learning-based approach for IP geolocation. In Proceedings of
the Passive and Active Measurement Workshop (April 2010).
[10] GARFINKEL, T., PFAFF, B., CHOW, J., ROSENBLUM, M., AND
BONEH, D. Terra: A virtual machine-based platform for trusted
computing. In Proceedings of the 19th ACM Symposium on Op-
erating Systems Principles (SOSP) (October 2003).
[11] GILL, P., ARLITT, M., LI, Z., AND MAHANTI, A. The ﬂat-
tening Internet topology: Natural evolution, unsightly barnacles
or contrived collapse? In Proceedings of the Passive and Active
Measurement Workshop (April 2008).
[12] GUEYE, B., ZIVIANI, A., CROVELLA, M., AND FDIDA,
IEEE/ACM
S. Constraint-based geolocation of Internet hosts.
Transactions on Networking 14, 6 (December 2006).
[13] Hulu - watch your favorites. anytime. for free., 2010. http:
//www.hulu.com/.
[14] KATZ-BASSET, E.,
JOHN,
J., KRISHNAMURTHY, A.,
WETHERALL, D., ANDERSON, T., AND CHAWATHE, Y.
Towards IP geolocation using delay and topology mesurements.
In Proceedings of the ACM SIGCOMM Internet Measurement
Conference (October 2006).
[15] KUROSE, J., AND ROSS, K. Computer Networking: A top-down
approach featuring the Internet. Addison-Wesley, 2005.
[16] Maxmind - geolocation and online fraud prevention, 2010.
http://www.maxmind.com.
[17] M.CASADO, AND FREEDMAN, M. Peering through the shroud:
The effect of edge opacity on IP-based client identiﬁcation.
In
Proceedings of the 4th Symposium on Networked Systems Design
and Implementation (NSDI) (Cambridge, MA, April 2007).
[18] MUIR, J., AND VAN OORSCHOT, P. Internet geolocation: Eva-
sion and counterevasion. ACM Computing Surveys 42, 1 (Decem-
ber 2009).
[19] PADMANABHAN, V., AND SUBRAMANIAN, L. An investigation
of geographic mapping techniques for Internet hosts. In Proceed-
ings of ACM SIGCOMM (August 2001).
[20] Pandora Internet radio, 2010. http://www.pandora.com.
[21] Planetlab, 2010. http://www.planet-lab.org.
[22] Quova – IP geolocation experts, 2010. http://www.quova.
[1] Amazon EC2, 2010. http://aws.amazon.com/ec2/.
com.
[2] ANDERSON, M., BANSAL, A., DOCTOR, B., HADJIYIAN-
NIC, G., HERRINGSHAW, C., KARPLUS, E., AND MUNIZ, D.
Method and apparatus for estimating a geographic location of a
networked entity, June 2004. US Patent number: 6684250.
[3] American Registry for Internet numbers (ARIN), 2010. http:
//www.arin.net.
[4] CAPKUN, S., AND HUBAUX, J. Secure positioning of wireless
devices with application to sensor networks. In Proceedings of
IEEE INFOCOM Conference (March 2005).
[5] CASTELLUCCIA, C., KAAFAR, M., MANILS, P., AND PERITO,
D. Geolocalization of proxied services and its application to fast-
ﬂux hidden servers. In Proceedings of the ACM SIGCOMM In-
ternet Measurement Conference (November 2009).
[6] CBC. USA Patriot Act comes under ﬁre in B.C. report, October
2004. http://www.cbc.ca/canada/story/2004/10/
29/patriotact_bc041029.html.
[7] CROVELLA, M., AND KRISHNAMURTHY, B. Internet Measure-
John Wiley &
ment: Infrastructure, Trafﬁc and Applications.
sons, 2006.
[23] Reseaux IP Europeens (RIPE), 2010. http://www.ripe.
net.
[24] RISTENPART, T., TROMER, E., SHACHAM, H., AND SAVAGE,
S. Hey, you, get off my cloud! exploring information leakage
in third-party compute clouds. In Proceedings of the 16th ACM
Conference on Computer and Communications Security (CCS
2009) (November 2009).
[25] SANTOS, N., GUMMADI, K. P., AND RODRIGUES, R. Towards
trusted cloud computing. In Proceedings of the 1st Workshop in
Hot Topics in Cloud Computing (HotCloud) (June 2009).
[26] SIWPERSAD, S., GUEYE, B., AND UHLIG, S. Assessing the
geographic resolution of exhaustive tabulation. In Proceedings of
the Passive and Active Measurement Workshop (April 2008).
[27] SPRING, N., MAHAJAN, R., AND WETHERALL, D. Measuring
In Proceedings of ACM SIG-
ISP topologies with Rocketfuel.
COMM (August 2002).
[28] THE TOR PROJECT. Tor: Overview, 2010. http://www.
torproject.org/overview.html.en.
[29] TRANCREDI, P., AND MCCLUNG, K. Use case: Restrict
access to online bettors, August 2009. http://www.quova.
com/Uses/UseCaseDetail/09-08-31/Restrict_
Access_to_Online_Bettors.aspx.
[30] WONG, B., STOYANOV, I., AND SIRER, E. G. Octant: A com-
prehensive framework for the geolocalization of Internet hosts. In
Proceedings of the 4th Symposium on Networked Systems Design
and Implementation (NSDI) (Cambridge, MA, April 2007).
[31] YOUNG, I., MARK, B., AND RICHARDS, D. Statistical geolo-
cation of Internet hosts. In Proceedings of the 18th International
Conference on Computer Communications and Networks (Au-
gust 2009).
Notes
1In reality, the consumer of geolocation information will likely con-
tract out geolocation services from a third party geolocation provider
that will maintain landmarks. Given the common goals of these two
entities we model them as a single party.
2The adversary can assume that the gateway routers are geolocated
to their true locations.
3We make similar observations for the undns attack extension.