CamCard | 6.5.1.9544-6.5.1  
BirthdayBash | 1.2-1.0  
好吃吗 | 2.0.7-2.0  
伊索寓言故事 | 1.0-1.0  
ComingCall | 1.52-1.52  
Superstar2 | 1.0-1.0  
ScramblingSnakes | 1.1.1  
财富 | 2.0  
梦幻战神 | 10.2.2-10.2.2  
都都宝 | 1.2.2.1-1.2.2  
JewelsQuest | 3.8-3.8  
YaYa药师 | 1.1.1-1.1.1  
JewelsQuest2 | 3.39-3.39  
YaYa | 6.4.3-6.4  
WO+创富 | 2.0.6-2.0.4  
2345浏览器 | 4.0.1-4.0.1  
Albums | 292-2.9.2  
豆腐做法大全 | 1.0.0-1.0.0  
PonySalon | 1.0-1.0  
MusicFestivalSalon | 1.0-1.1  
银耳汤做法 | 1.0.0-1.0.0  
财达同花顺 | 2.4.2-2.4.2  
花椒 | 2627-1.3  
舌尖上的美味 | 2.0.1-2.0.0  
鲫鱼做法大全 | 1.0.0-1.0.0  
挖掘机大师3D | 1.0.5.0-1.0.5  
BoatTripSalon | 1.0-1.0  
特色西餐 | 1.0-1.0  
Juniorchefmaster | 1.0-1.1  
炒饭做法大全 | 1.0.0-1.0.0  
心脏病防治 | 1.0.1-1.0.0  
Empireoftheocean | 2.7.1-2.7  
MagicKing | 2.0-2.0  
炒股入门 | 1.0-1.0.3  
星派送 | 1.0-1.0  
智慧树 | 3.9-3.9  
CollectBoys | 1.0-1.0.0  
懒人私房菜 | 2.0.1-2.0.0  
PrincessMakeover | 1.0-1.1  
美味奶茶DIY | 1.0.0-1.0.0  
营养早餐 | 1.0-1.0  
申万宏源 | 1-1.1.6  
一品粥 | 1.0-1.0  
素菜大全 | 1.0-1.0  
公交来了 | 20150715-1.3  
KneeDoctor | 1.0.1.1-1.0.1  
黄瓜做法大全 | 1.0.0  
微调查 | 1432-3.4.5  
中药方剂辞典 | 2.0.0  
ChinessChess | 618-2.6.18  
土豆做法大全 | 1.0.0  
鱼的做法 | 1.0  
冰品饮品DIY | 1.0  
面包做法大全 | 1.0-1.0  
仁和珠宝 | 1.02-1.0  
一日三餐 | 1.0.1-1.0.0  
风云三国2 | 1.0.1  
汽车之友 | 2.0.12-1.40  
AutoWorld | 261-3.1.3  
财新周刊 | 3041-3.0.4  
PDFReaderFree | 2.7.6-2.7.1  
悦耳 | 2.3.2-2.3.2  
AngelFuel | 4.3.0.2-4.3.0  
EFParents | 106-2.0.0  
中搜搜悦 | 5.0.0-5.0.0  
YOHO!有货 | 3.4.0.1508240001-3.4.0  
GNum | 2.3.100000459  
WallPapersHD* | 9.3.5-9.3.5  
TurboInvoice | 2.3.1-2.3  
MyChevy | 1422767631-3.1  
PetCatchiOS | 1.3.7.3-1.3.7  
问他作业 | 33-4.2.0  
航海大时代 | 2.5.1-2.5  
语玩 | 240-0.6.4  
PaoPaoTang | 12000-1200  
牵牛 | 1.5.3-1.5.2  
卡曼 | 2.7-2.7  
琅琊榜 | 2.9.2-2.9  
造梦西游OL | 4.6.0-4.6.0  
集享卡 | 1.5.3-1.5.3  
58同城 | 6.1.8.1-6.1.8  
nvshen | 975-2.5.6  
暗黑战神 | 1.13.2-1.13.2  
耍大牌 | 4.5.1-4.5.1  
漫画帮 | 19-4.3.2  
猫团动漫 | 5.5.2-5.5  
海玩 | 2.1-3.0  
Golf | 2.4.2.0-2.4.2  
摩擦 | 45-2.4.9  
百度财富 | 9825-2.2.2  
言情小说吧 | 3.3.3-3.3  
BlackWhiteTiles4 | 9.4.5  
康康在线 | 5.6.0  
加拿大订餐 | 4.0.1  
YingYue | 1.6-1.5  
eHome | 1.26.4  
幸福相馆 | 2.1.3-2.1.3  
支付通QPOS | 3-2.1.2  
平安易贷 | 2.9.0-2.9.0  
你我贷 | 4.2.0.9626-4.2.0  
穷游 | 6.4.1-6.4  
CuteCUT | 1715-1.7  
同花顺 | 9.26.03-9.26.01  
Perfect365 | 4.6.16  
电话归属地助手 | 1-3.6.3  
OPlayerLite | 21051-2105  
H3C易查通 | 2.3-2.2  
百度音乐 | 5.2.7.3-5.2.7  
动卡空间 | 3.4.4.1-3.4.4  
CamCard | 6.3.2.9095-6.3.2  
UA电影票 | 24-2.9.2  
MTP管理微学 | 1.0.0-2.0.1  
YddHotelPro | 14-2.5.2  
美丽家 | 204-2.2.1  
3D动物陆地版 | 3.0.2-3.0  
工银融e联 | 1.1.3.3-1.1.3  
安心理财 | 2.3.8.3-2.3.8  
妈妈值得买 | 6.0.11-6.0  
Research | 1.8-1.8  
MonsterGirlsMakeover | 1.0-1.4  
零钱包 | 4.0.1.0-4.0.1  
南京银行HD | 1.2-3.0.3  
Hugo | 1507031050-2.8.0  
北京工行Style | 1.1.1-1.1  
卓创短讯 | 2.0  
途游德州扑克 | 2-3.375  
钱宝网 | 3.1.3-3.1.3  
WinZip | 4.2-4.2  
口语100 | 314-3.1.2  
富通贷 | 1.2.3-1.1.1  
留学僧 | 199-1.8  
fishsagaiOS | 2.1.2.3-2.1.2  
鱼说 | 202-3.8.0  
西部信天游 | 2.21.011-2.21.011  
LoveStar | 1.0-1.1  
Ps互动教程 | 3.2.1-3.2  
fishinghappyiOS | 1.1.5.2-1.1.5  
Tennis | 43-2.1.0  
途游欢乐牛牛 | 2-3.37  
银泰掌如e.1.3 |  
联趣斗地主 | 1.8.3-1.8.0  
快秀 | 1.4.1.1-1.4.1  
博客下载-For新浪 | 59-1.58  
重庆银行 | 1.0-2.9  
金税通查验 | 309-3.0.9  
恒泰金玉管家 | 1.4  
Tennis | 43-2.1.0  
健康交行 | 3.25  
**二、攻击方式及来源**
通过向IDE中植入恶意代码,进而通过IDE向其编译、生成的应用中插入恶意代码。
恶意程序的主要来源:百度网盘、迅雷等第三方平台。
**三、问题描述**
从第三方源下载的 Xcode(苹果平台IDE) 被植入恶意代码,使用受感染的 Xcode 编译、生成的应用中会被植入后门。
间接影响 Xcode 支持的所有平台,包括:iOS,iPhone 模拟器,Mac OS X,目前受影响最大的是 iOS 平台。
被植入恶意代码的 iOS 应用会向 C&C 服务器上传信息,
具体信息包括:时间、应用名字、应用标识ID、设备名字与类型、系统区域及语言、设备唯一标识UUID、网络类型。
**四、xcode样本分析**
xcode样本下载 (提取码:39e0)
正常的xcode目录结构中SDKs目录下没有Library目录
被种植恶意木马的Xcode中包含了恶意的CoreService库文件,目录结构如下:
Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/Library/Frame
works/CoreServices.framework/CoreService
恶意xcode影响范围
从样本上分析,影响 Xcode v6.1 ~ v6.4。
但是理论上可以影响 Xcode 的所有版本。
影响平台ios,ios模拟器,macox X86 或者x86_64位多版本
**五、苹果官方appstore微信6.2.5样本分析**
微信 6.25 样本  (提取码:b7b3)
抓包查看如下:
抓包查看如下:
逆向分析connection函数发送的网站地址
****
**六、越狱平台微信抢红包插件分析**
插件样本  (提取码:e6d7)
在上次分析过红包插件盗取22万icloud信息的插件后发现在此插件上还隐藏着另一个后门,盗号插件也中了xcode木马,红包插件名称为iwexin.dylib
MD5 :137fdaa6f32658e1a7315f74957e22a0
使用别篡改的XCode会加载coresevice库文件,在编译出的APP或dylib包含了如下头文件的头文件,所有的恶意函数隐藏其中
通过分析使用恶意XCode编译的iwexin.dylib启动时执行如下类中的函数进行收集信息并发送,如下为发送消息至服务器的.h文件和类
通过反编译查看恶意代码收集信息分别为:
国家,语言,设备信息,系统版本,时间戳,app的bundleID
以下为收集设备信息的.h文件和类
以下是ida中查看的获取设备等信息的关键代码
在ida中查看到主要恶意代码关键部分如下,随着程序启动开始执行,获取设备信息发送信息至init.icloud-analysis.com
**七、检测方法**
如果 Xcode 中存在如下文件与目录,即可认为受感染:
1Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/Library/Frameworks/CoreServices.framework/CoreService,针对
iOS
2Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/Library/PrivateFrameworks/IDEBundleInjection.framework,针对
iOS
3Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/Library/Frameworks/CoreServices.framework/CoreService,针对
iPhone 模拟器
4Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/Library/PrivateFrameworks/IDEBundleInjection.framework,针对
iPhone 模拟器
5Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/Library/Frameworks/CoreServices.framework/CoreService,针对
Mac OS X
6Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/Library/PrivateFrameworks/IDEBundleInjection.framework,针对
Mac OS X 7
**八、解决方案**
1、高优先级检测所有编译服务器、自动发布服务器中的 Xcode 是否被感染。
2、开发者需要检查系统中所有版本的 Xcode 是否被感染。
3、如果受感染,首先删除受感染的 Xcode,然后从 Mac AppStore 或者从开发者中心下载 Xcode。
4、如果线上的应用是用受感染的 Xcode 发布的过,请使用官方的 Xcode 清理、重新编译应用,然后上传 AppStore,尽量向苹果说明情况,从而走
AppStore 的紧急上线流程