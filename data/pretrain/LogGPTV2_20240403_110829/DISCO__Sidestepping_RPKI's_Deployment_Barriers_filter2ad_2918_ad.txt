VII. EVALUATION
We evaluate DISCO in two respects. First, we evaluate
DISCO’s compatibility with today’s Internet (§VII-A). We
perform this evaluation by deploying DISCO and advertising
a preﬁx with its attribute through the PEERING platform [52],
[53]. Second, we evaluate DISCO’s security using simulations
of different types of attacks on an empirically derived dataset
of the Internet AS-level topology (§VII-B). The code for our
simulations and measurement analysis is available online [30].
A. Compatibility with today’s Internet
DISCO’s strategy for distributing public keys through
optional transitive attributes aims to be compatible with today’s
Internet. Routers need not understand these (optional) at-
tributes but are still expected to forward them onwards to other
networks (transitive); hence they provide a useful mechanism
for extending BGP [48]. In practice, however, BGP imple-
mentations might violate the protocol’s speciﬁcation and ﬁlter
unknown optional transitive attributes (as indeed happened
during the standardization of BGP large communities [55]). We
describe below how we evaluate the propagation of DISCO’s
new public key BGP attribute and provide evidence that such
a new BGP attribute would reliably propagate to the global
Internet.
1) Experiment setup: We performed two experiments to
quantify the propagation of BGP announcements carrying
DISCO’s attribute from the PEERING platform [52], [53].
We shared our experiment proposal with a few operators for
feedback to make sure it had community support and was
seen as safe and useful, integrating their feedback into the
experiment design. We then submitted the proposal to the
PEERING operations team, who approved it. PEERING did
not previously support the ability to use such attributes. We
extended the platform to support per-experiment capabilities,
such that our approved experiment could use an optional
transitive BGP attribute but other experiments could not, in
keeping with the principle of least privilege. We announced a
“DISCO” preﬁx with an optional transitive attribute carrying
DISCO’s 32-byte owner’s public key. We used attribute 0xFF,
which is reserved by the BGP speciﬁcation for experimental
use. We also announced a “control” preﬁx without unknown
attributes to track the routes ASes use to reach PEERING in
normal circumstances.
The ﬁrst experiment announced the preﬁxes from PEER-
ING’s point of presence at UFMG, Brazil, and the second
announced the preﬁxes from PEERING’s point of presence at
the University of Washington (UW), USA. We limited the
duration of the announcements to 15 minutes each.
DISCO’s BGP announcements conform with the speciﬁ-
cation but are unusual compared to the BGP announcements
that typically propagate the Internet. We attempted to limit the
potential adverse impact on the global routing system in the
case that a BGP implementation does not comply with the BGP
RFCs, or contains a bug triggered by our BGP announcements.
We disseminated the experiment plan on the NANOG operator
mailing lists (which was then forwarded to other operator mail-
ing lists), giving advance notice of the experiment schedule.
We gave operators ample time between the experiments to
identify and report any issues. Finally, we tested successful
propagation of our announcements in controlled environments
using Cisco IOS-based routers running versions 12.2(33)SRA
and 15.3(1)S, Quagga 0.99.23.1 and 1.1.1, as well as BIRD
1.4.5 and 1.6.3.
2) Measuring DISCO’s effect on reachability: We ﬁrst
evaluate whether the presence of the attribute on the DISCO
preﬁx announcement impacts whether Internet destinations can
reach the preﬁx. That would be the case if many routers ﬁltered
announcements with unusual attributes, leaving destinations
“behind” them without a route to the preﬁx. During our
experiments, we used zmap [17] to send ICMP Echo Requests
to a destination hitlist built from ISI’s Internet census data from
Nov. 2018 [18]. We target a list of 5,651,501 IP addresses
which includes the IP addresses with the highest response rate
in responsive /24 preﬁxes during ISI’s census measurements
(we ignore /24 preﬁxes without any IP address with at least a
10% response rate in ISI’s census). We identify the set of ASes
responding to pings from the DISCO and control preﬁxes
(denoted ADISCO and Acontrol) by mapping responding targets
to their ASes. We consider an AS as responsive if at least one
address in the AS responded.
Table III presents results indicating that the DISCO and
control preﬁxes have equivalent (global) reachability. The
average AS-level response rate during the UFMG and UW
experiments is around 47% and 66%, respectively. This low
response rate is a result of scattering probes across a large set
of targets which may have gone ofﬂine, turned unreachable,
or stopped responding since ISI’s Internet census [18]. The in-
crease in response rate from the UFMG to the UW experiment
is explained by zmap overloading our VMs during the UFMG
experiment and dropping response packets; we reconﬁgured
the VMs for the UW experiment.
Although the overall response rate is low, it is similar for
the DISCO and control preﬁxes. The number of ASes that
responded only to the DISCO preﬁx is roughly equal to the
number that responded to the control preﬁx only (the exclusive
ASes columns). Two factors outside attribute propagation can
cause responsiveness to one preﬁx and not another. First, zmap
probes in a random order, which can combine with delayed
8
UFMG announcements
AS Response Rate Responding ASes
UW announcements
Exclusive ASes AS Response Rate Responding ASes
7727
7671
64.65%
66.80%
38150
39418
Exclusive ASes
7542
8810
DISCO pings
Control pings
TABLE III.
47.10%
47.01%
27794
27738
SUMMARY OF ZMAP PING MEASUREMENTS DURING PEERING EXPERIMENTS. Exclusive ASes INDICATES THE NUMBER OF ASES THAT
RESPONDED TO PINGS FROM THE DISCO PREFIX BUT NOT THE CONTROL PREFIX, OR VICE VERSA.
(a) UFMG Experiment
(b) UW Experiment
Fig. 4. Comparison of reachability of test DISCO preﬁx vs control preﬁx
as a function of the number of targets. Most of the ASes that respond to one
preﬁx but not the other host few destinations and are thus more susceptible
to measurement errors.
route convergence to cause a target to be probed from one
preﬁx before the route converges and from the other preﬁx after
the route converges. Second, the measured responsiveness of
an individual destination can vary due to ICMP rate limiting
and packet loss. Finally, the BGP session used to announce
the DISCO preﬁx during the UW experiment was temporarily
down due to a ﬂap of the OpenVPN tunnel used to connect
to the PEERING router. This temporary disconnection and the
subsequent BGP session reset may have negatively impacted
propagation of announcements for the DISCO preﬁx and data
plane reachability. This may explain (at least part of) why
reachability on the DISCO preﬁx during the UW experiment
is 2.15% lower than on the control preﬁx.
In Figure 4 we present our reachability results as a function
of the number of target destinations in each AS in our dataset
as further support to the conclusion that the DISCO and
control preﬁxes are similarly reachable. The “all ASes” line
in Figure 4 shows the distribution of the number of targets
probed in all ASes with responsive destinations. Most ASes
own only a small number of /24 preﬁxes and thus host only
a few destinations in our hit list, but some ASes own tens
or hundreds of /24s and host a large number of destinations.
The ﬁgure compares this line against the distributions of the
number of targets probed in ASes where we observe responses
on only one of the preﬁxes (i.e., ASes in the exclusive ASes
sets). We notice that these distributions are heavily skewed to
the left, indicating that, usually, the AS sets differ in ASes
where the number of targets for our probes was low. A low
number of targets implies a higher probability for measurement
errors (e.g., when a target does not respond to an ICMP Echo
Reply probe or a packet is lost) due to convergence delay
(e.g., when a target is probed from one of the preﬁxes before
convergence has completed). Such errors lead to responses for
one preﬁx but not the other, even when both DISCO and
control preﬁxes are utlimately reachable from the AS.
1)
3) Identifying ﬁltering on the control plane: We check
the propagation and attributes of routes used to reach the
control and DISCO preﬁxes by downloading BGP updates
from routers around the world collected by the RouteViews
and RIPE RIS projects. We compare routes toward the control
preﬁx and the DISCO preﬁx to identify sets of candidate ASes
that could be ﬁltering the announcement of the DISCO preﬁx
(denoted F) or discarding DISCO’s attribute and forwarding
the announcement without it (denoted D). We apply the follow-
ing rules, in order, to estimate F and D for each experiment:4
For each router R that exports a route toward the
control preﬁx to a BGP collector, we add to A all
ASes in R’s route toward the control preﬁx. These
represent the set of ASes we might expect to see in
routes to the DISCO preﬁx. We initialize F to this
full set A, and the following rules remove the ASes
we do see in routes to the DISCO preﬁx, leaving
candidates that may be ﬁltering.
For each router R that exports a route toward the
DISCO preﬁx without the DISCO attribute to a BGP
collector, we add to D all ASes in R’s route toward
the DISCO preﬁx. We do not remove ASes from F
as we cannot know if ASes after the one discarding
the attribute would have ﬁltered the announcement.
For each router R that exports a route toward the
DISCO preﬁx with the DISCO attribute, we remove
from D and F all ASes in R’s route toward the
DISCO preﬁx.
2)
3)
Although route convergence in the Internet’s control plane
usually takes on the order of 3 minutes, some cases can take
more than 15 minutes to converge [34]. To avoid considering
transient routes observed during route convergence, we require
that a route remains stable for 5 minutes during the execution
of the experiment. If a router exports two routes that satisfy
this condition during an experiment, we consider both routes.
For ASes in the converged routes to the control preﬁx
(step 1), we check whether we observe them in any route to
the DISCO preﬁx (steps 2 and 3). If we observe an AS on a
route (transient or otherwise) to the DISCO preﬁx, it is proof
that the AS does not ﬁlter the preﬁx. And if we observe an AS
on a route to the DISCO preﬁx with the DISCO attribute, it
is proof that the AS does not discard the attribute.
The columns under “BGP updates” in Table IV summarize
our results. We show |F| and |D|, and the number of routers
that export paths to the DISCO and control preﬁxes. The re-
sults indicate that the great majority of ASes receive DISCO’s
preﬁx with its attribute. If we observe an AS in a route with
the attribute in one experiment, it indicates that the AS does
4The rules assume that all routers in an AS behave uniformly. Although
this is not always true for routing decisions [43], we expect ﬁltering to be
more uniform across an AS.
9
100101102Number of Destinations Probed in ASN0.00.20.40.60.81.0Cumulative Fraction of ASNsAll ASes (DISCO  Control)Exclusive ControlExclusive DISCO100101102Number of Destinations Probed in ASN0.00.20.40.60.81.0Cumulative Fraction of ASNsAll ASes (DISCO  Control)Exclusive ControlExclusive DISCOAnnouncement
Locations
UFMG
UW
Joined
|A|
control
295
292
—
|F|
4
5
3
TABLE IV.
|A|
control
1656
1684
—
Traceroute (§VII-A4)
|F|
number of traces
DISCO control
1198
1196
1196
1196
—
—
(cid:54)= paths
172
58
—
BGP updates (§VII-A3)
|D|
number of routes
DISCO control
(cid:54)= paths
359
328
—
2
2
2
EVALUATION OF FILTERING RESULTS DURING PEERING EXPERIMENTS.
14–24
8–27
3–3
364
330
—
36
8
—
not ﬁlter on the attribute, even if we did not observe the AS
in the other experiment.
A single AS exports routes toward the DISCO preﬁx
without DISCO’s attribute. This route traversed 2 ASes that
are candidates for having discarded the attribute (i.e., D =
{AS16150, AS48285}). As other routes never traverse these 2
ASes, we cannot identify which one is discarding the DISCO