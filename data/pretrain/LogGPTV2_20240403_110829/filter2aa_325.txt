802.11 Massive Monitoring 
Andrés Blanco - Andrés Gazzoli 
Outline 
• Introduction 
• Approaches 
• The USB Dilemma 
• Distributed System 
• WiWo 
• Questions 
Introduction [ Who is this talk for? ] 
Introduction [ Who is this talk for? ] 
Introduction [ Who is this talk for? ] 
Introduction [ Who is this talk for? ] 
Introduction [ Who is this talk for? ] 
Introduction [ goals ] 
• Monitor 
• Channel hopping traffic (such as WiFi-Direct) 
• Access Points with auto channel selection 
• Multiple Access Points on different channels 
• Stations 
• Multiple locations at the same time 
• Inject frames on multiple channels 
Introduction [ 802.11 channels ] 
Channel 
Frequency 
1 
2412 
2 
2417 
3 
2422 
4 
2427 
5 
2432 
6 
2437 
7 
2442 
8 
2447 
9 
2452 
10 
2457 
11 
2462 
12 
2467 
13 
2472 
14 
2484 
Channel 
Frequency 
131 
3657.5 
132 
3660.0 - 3662.5 
133 
3665.0 - 3667.5 
134 
3670.0 - 3672.5 
135 
3675.0 - 3677.5 
136 
3680.0 - 3682.5 
137 
3685.0 - 3687.5 
138 
3690.0 - 3692.5 
2.4 GHz (802.11b/g/n) 
3.6 GHz (802.11y) 
Channel 
Frequency 
36 
5180 
40 
5200 
44 
5220 
48 
5240 
52 
5260 
56 
5280 
60 
5300 
64 
5320 
100 
5500 
104 
5520 
108 
5540 
112 
5560 
Channel 
Frequency 
116 
5580 
120 
5600 
124 
5620 
128 
5640 
132 
5660 
136 
5680 
140 
5700 
149 
5745 
153 
5765 
157 
5785 
161 
5805 
165 
5825 
5 GHz (802.11a/h/j/n/ac) 
Approaches [ first approach ] 
Approaches [ second approach ] 
Approaches [ wireshark ] 
Wireless Interface 
DHCP 
DNS 
HTTP 
Probe Request 
Wireless Interface 
DHCP 
DNS 
HTTP 
Probe Request 
Approaches [ station profiler ] 
… 
Profiler 
Demo [ second approach ] 
Wireless Network Traffic could be displayed during the demo. 
Please disable Wi-Fi if you don’t want to be part of it. 
The USB Dilemma [ scalability ] 
The USB Dilemma [ scalability ] 
The USB Dilemma [ bus saturation ] 
Demo [ bus saturation ] 
Wireless Network Traffic could be displayed during the demo. 
Please disable Wi-Fi if you don’t want to be part of it. 
Wireless 
Interface 
USB Bus 
Filter 
Kernel 
User Space 
The USB Dilemma [ bus saturation ] 
Firmware 
The USB Dilemma [ bus saturation ] 
The USB Dilemma [ bus saturation ] 
The USB Dilemma [ non-removable devices ] 
Bluetooth 
Webcam 
The USB Dilemma [ non-removable devices ] 
The USB Dilemma [ available buses ] 
USB Port 1 
The USB Dilemma [ available buses ] 
USB Port 2 
The USB Dilemma [ available buses ] 
USB Port 3 
The USB Dilemma [ power issues ] 
USB Bus 
Filter 
Kernel 
User Space 
The USB Dilemma [ the option? ] 
Wireless 
Interface 
Firmware 
Worker 
Ethernet 
Filter 
Manager 
Distributed System [ scalability ] 
Distributed System [ scalability ] 
Distributed System [ scalability ] 
WiWo is a distributed 802.11 monitoring and 
injecting system that was designed to be simple and 
scalable, in which all workers (nodes) can be 
managed by a Python framework. 
WiWo [ introduction ] 
WiWo [ workers ] 
CPU 
Atheros AR7240@400MHz 
RAM 
32MiB  
Flash 
4MiB  
Network 
1 x 100MBit 
TP-Link TL-MR3020 
WiWo [ workers ] 
CPU 
Atheros AR9344 @ 560 MHz 
RAM 
128MiB  
Flash 
8MiB  
Network 
4 x 1000MBit 
TP-Link TL-WDR3600 
WiWo [ workers ] 
CPU 
Atheros AR7240 @ 400MHz  
RAM 
32MiB  
Flash 
4MiB  
Network 
1 x 100MBit 
TP-Link TL-MR3040 
WiWo [ features ] 
Manager 
Look for workers 
Get worker’s wireless interface information 
Set worker’s wireless interface channel 
Start monitoring  on a worker’s wireless interface 
Inject frame on a worker’s wireless interface 
WiWo [ manager architecture overview ] 
Manager 
Manager 
Service 
Data Frame 
Handler 
Management Frame 
Handler 
WiWo [ ethernet ] 
• Plug n’ Play 
• Silence on the wire 
• Avoid overhead to keep fragmentation low 
WiWo [ scalable ] 
WiWo [ scalable ] 
WiWo [ usage ideas ] 
• IDS/IPS 
• Traffic analysis 
• Device Tracking 
• Protocol analysis 
WiWo [ hardware PoC ] 
Demo [ WiWo ] 
Wireless Network Traffic could be displayed during the demo. 
Please disable Wi-Fi if you don’t want to be part of it. 
 Future Work  
• IP support 
• Build more OpenWRT firmware’s 
• Code more examples 
• Interaction with other tools 
 Questions? 
https://github.com/CoreSecurity/wiwo 
https://twitter.com/6e726d 
PI:EMAIL 
PI:EMAIL 
https://twitter.com/rcpota