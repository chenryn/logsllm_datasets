DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
Review Basic
Review Basic
S CREEN S CRAPER 
S CREEN S CRAPER 
THEOR
THEORY 
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
Define what 
Define what 
Constitutes a 
“DIFFICULT CAS E” 
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
Demo some
Demo some
““S CREEN S CRAPER 
S CREEN S CRAPER 
TRICKS ”
TRICKS ”
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
Look at ideas for
Look at ideas for
LARGE-S CALE
LARGE-S CALE
DEPLOYMENT
DEPLOYMENT
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
S hare a
S hare a
HEARTWARMING
HEARTWARMING
MOMENT
MOMENT
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Agenda
TODAY'S
AGENDA
S hare a
S hare a
HEARTWARMING
HEARTWARMING
MOMENT
MOMENT
Featuring 
CAPTCHAs!
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Goals of this Talk
Gain an understanding of some unusual (useful) 
web scraping techniques
Your not going to walk away form here with 
ready-made solutions
The goal is to expose you to some new ideas 
that you can apply to your specific situation
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Goals of this Talk
Gain an understanding of some unusual (useful) 
web scraping techniques
Your not going to walk away form here with 
ready-made solutions
The goal is to expose you to some new ideas 
that you can apply to your specific situation
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Goals of this Talk
Gain an understanding of some unusual (useful) 
web scraping techniques
Your not going to walk away form here with 
ready-made solutions
The goal is to expose you to some new ideas 
that you can apply to your specific situation
 DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
 Screen Scraper Tricks: Difficult cases                 PI:EMAIL
● For the purposes of this discussion, 
    the solutions have to meet three criteria:
Technologies & Tools Discussed
 DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
 Screen Scraper Tricks: Difficult cases                 PI:EMAIL
● For the purposes of this discussion, 
    the solutions have to meet three criteria:
#1. Completely customizable (hackable)
Technologies & Tools Discussed
 DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
 Screen Scraper Tricks: Difficult cases                 PI:EMAIL
● For the purposes of this discussion, 
    the solutions have to meet three criteria:
#1. Completely customizable (hackable)
#2. Free (or Open Source)
Technologies & Tools Discussed
 DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
 Screen Scraper Tricks: Difficult cases                 PI:EMAIL
● For the purposes of this discussion, 
    the solutions have to meet three criteria:
#1. Completely customizable (hackable)
#2. Free (or Open Source)
#3. Platform independent
Technologies & Tools Discussed
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
Michael Schrenk
● Minneapolis-based bot writer, consultant & author
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
Michael Schrenk
● Minneapolis-based bot writer, consultant & author
● (Soon to be) Las Vegas-based
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
Michael Schrenk
● Minneapolis-based bot writer, consultant & author
● (Soon to be) Las Vegas-based
● Work for clients in North America, Asia & Europe
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
Michael Schrenk
● Minneapolis-based bot writer, consultant & author
● (Soon to be) Las Vegas-based
● Work for clients in North America, Asia & Europe
● Active in my local DEFCON group DC612
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
My DEFCON History
1
2
3
4
6 7
9 10 11
8
12
13 14 15 16 17
5
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
1
2
3
4
5
6 7
9 10 11
8
12
14 15 16 17
13
Talk:
Introduction to Writing Spiders & Agents
1
2
3
4
6 7
9 10 11
8
12
13 14 15 16 17
5
My DEFCON History
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
1
2
3
4
5
6 7
9 10 11
8
12
14 15 16 17
13
Talk:
Online Corporate Intelligence
1
2
3
4
6 7
9 10 11
8
12
13 14 15 16 17
5
My DEFCON History
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
1
2
3
4
5
6 7
9 10 11
8
12
14 15 16 17
13
Talk:
The 
Fabulous 
Executable
Image 
Exploit
1
2
3
4
6 7
9 10 11
8
12
13 14 15 16 17
5
My DEFCON History
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
BIO:
1
2
3
4
5
6 7
9 10 11
8
12
14 15 16 17
13
Today's Talk:
Screen Scraper Tricks
Difficult Cases
1
2
3
4
6 7
9 10 11
8
12
13 14 15 16 17
5
My DEFCON History
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
My book
2007, No Starch Press
San Francisco
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Traditional strategies not obsolete
● Downloading, Parsing, Form submission
● Authentication, Stealth, Fault tolerance, etc.
I won't spend a lot of time discussing these things
Supplement traditional 
approaches with 
what you learn today
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Why are Screen Scrapers Important?
Browsers (alone) are deficient
Browsers are manual, error prone &  time consuming tools
Browsers do not make decisions for you
Browsers are not proactive
You won't excel by just doing what everyone else 
does
Webbots & Screen scrapers offer competitive 
advantages
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Why are Screen Scrapers Important?
Browsers (alone) are deficient
Browsers are manual, error prone &  time consuming tools
Browsers do not make decisions for you
Browsers are not proactive
You won't excel by just doing what everyone else 
does
Webbots & Screen scrapers offer competitive 
advantages
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Why are Screen Scrapers Important?
Browsers (alone) are deficient
Browsers are manual, error prone &  time consuming tools
Browsers do not make decisions for you
Browsers are not proactive
You won't excel by just doing what everyone else 
does
Webbots & Screen scrapers offer competitive 
advantages
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Why are Screen Scrapers Important?
Browsers (alone) are deficient
Browsers are manual, error prone &  time consuming tools
Browsers do not make decisions for you
Browsers are not proactive
You won't excel by just doing what everyone else 
does
Webbots & Screen scrapers offer competitive 
advantages
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Why are Screen Scrapers Important?
Browsers (alone) are deficient
Browsers are manual, error prone &  time consuming tools
Browsers do not make decisions for you
Browsers are not proactive
You won't excel by just doing what everyone else 
does
Webbots & Screen scrapers offer competitive advantages
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
● Handle server redirection
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
● Handle server redirection
● Hide your identity with proxies & 
random timing
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
● Handle server redirection
● Hide your identity with proxies & 
random timing
● Emulate form submission
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
● Handle server redirection
● Hide your identity with proxies & 
random timing
● Emulate form submission
● Parse information from web 
pages & take action
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Review of traditional 
screen scraping 
● Download a web page
● Manage cookies
● Facilitate (SSL) encryption
● Handle server redirection
● Hide your identity with proxies & 
random timing
● Emulate form submission
● Parse information from web 
pages & take action
These tasks (except proxy functions)
can be coded with the free 
PHP code libraries from my book
http://www.schrenk.com/nostarch/webbots/DSP_download.php
FREE DOWNLOAD
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
What constitutes a difficult case?
Either by design—or by accident, web pages 
have become harder for webbots and screen 
scrapers to use.
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
What constitutes a difficult case?
Interstitial web pages
● Commonly used by travel sites when there is 
a long delay between a database query and a 
result set.
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
JavaScript
● When used to dynamically modify forms 
before submission
● Usually solved with my book's online form 
analyzer.
www.schrenk.com/nostarch/webbots/form_analyzer.php
What constitutes a difficult case?
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
JavaScript
● AJAX used to populate pages
Example: 
You cannot do a “view source” 
after first page of search 
results
What constitutes a difficult case?
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Flash
● When used as a navigation technique.
DHTML
● When used as a navigation technique
Elaborate cookie behavior
● Sequence dependent cookies
● Strange JavaScript scripts
What constitutes a difficult case?
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
Randomly generated form element names
What constitutes a difficult case?
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
FACT: We're still tied 
to the browser 
Sometimes you can fool a server into 
delivering simpler data formats by pretending 
to be a mobile device.
Often you need to find a way to emulate 
browser capability while maintaining full 
control
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada
Screen Scraper Tricks: Difficult cases                 PI:EMAIL
FACT: We're still tied 
to the browser 
Sometimes you can fool a server into 
delivering simpler data formats by pretending 
to be a mobile device.
Often you need to find a way to emulate 
browser capability while maintaining full 
control
DEFCON XVII July 31-Aug 2, 2009
  Las Vegas,  Nevada