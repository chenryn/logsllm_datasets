proxied at the crumple zone except for the PS traffic. The 
PSQ flow is changed further. With the addition of the four 
PSQ servers in the four quads, a PSQ request first goes to 
the AP (Access Proxy), which checks whether the traffic 
belongs to an existing session by consulting the DC. If so, 
the request is forwarded to the PSQ server, which checks 
for signatures, and whether the client is authorized to send 
the request. If both succeed, the request is disseminated to 
the  other  quads.  Each  quad  processes  the  request  and 
sends  a  signed  ACK  or  response  back  to  the  client.  The 
client  completes  the  request  if  it  sees  enough  signed  re-
sponses,  otherwise  keeps  resending  indefinitely.  If  the 
PSQ request is a publication, the IO (Information Object) 
is escrowed. When the escrow period is over, the IO is re-
leased for circulation. 
5 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:05:31 UTC from IEEE Xplore.  Restrictions apply. 
4  Evaluating the Defense 
We  have  taken  a  multi-pronged  approach  to  evaluate 
the  effectiveness  of  the  survivability  architecture.  Team-
members  not  involved  in  the  design  and  development  of 
the  architecture  evaluated  the  design  and  the  defense-
enabled  system  using  an  Integrated  Survivability  Valida-
tion  methodology.  The  validation  process  and  results  are 
described in detail in [14]. Based on the attack trees and 
minimal  attacks  considered,  they  found  that  the  defense-
enabled system put up multiple independent layers of de-
fense  in  front  of  the  attacker.  In  particular,  none  of  the 
high  level  goals  (such  as  corrupting  an  IO  (Information 
object),  stealing  an  IO,  or  making  the  PSQ  service  un-
available) they considered had a minimal attack consisting 
of only a single step.  
The defense-enabled system was subjected to numerous 
fault  and  intrusion  injection  test  runs  where  failures  and 
attack effects were simulated or caused by hand in various 
parts  of  the  system  to  see  how  the  system  reacted,  and 
whether  mission  operations  could  still  continue.  Apart 
from the external Red Team exercise (which constituted of 
multiple runs of the mission during which the Red Team 
was attacking the  system  with fairly unrestricted rules of 
engagement), the defense-enabled system was subjected to 
several internal Red Team experiments as well.  
The  findings  from  these  evaluation  activities  showed 
that  the  survivability  architecture  significantly  improves 
the  survivability  of  the  undefended  system,  even  though 
several  weak  points  of  the  architecture  were  discovered. 
Causing LOI or LOC was found to be very difficult. LOA 
of the PSQ service in the JBI core is also found to be very 
hard to cause, but the communication infrastructure, espe-
cially the communication between the LANs and the pub-
lic network was found to be vulnerable to DoS attacks.   
In  this  section  we  show  the  value  of  the  survivability 
architecture by summarizing a subset of fault/intrusion in-
jection test cases, and attack steps that the defense-enabled 
system was subjected to. The official results of the exter-
nal Red Team exercise will be forthcoming from the inde-
pendent White Team, thus this paper we will only mention 
some of the attack steps and  the Blue Team’s interpreta-
tion of events. 
The sequence of attacker locations indicated by callouts 
in Figure 4 can be thought of as steps in a sustained attack, 
where the attacker starts from the public network (location 
1) and progresses deeper into the Core zone.  For each at-
tack  location,  a  description  of  attack  step  or  the  injected 
failure condition/attack effect, and how the system defends 
against that is described in a table format. 
Public Network (location 1) 
Executive Zone
Executive Zone
5
5
Operations Zone
Operations Zone
4
4
QUAD 1
QUAD 1
Q1SM
Q1SM
Q1PS
Q1PS
Q1CORR
Q1CORR
Q1PSQ
Q1PSQ
Q1DC
Q1DC
Q1NIDS
Q1NIDS
QUAD 2
QUAD 2
QUAD 3
QUAD 3
QUAD 4
QUAD 4
Q2SM
Q2SM
Q2PS
Q2PS
Q2CORR
Q2CORR
Q2PSQ
Q2PSQ
Q2DC
Q2DC
Q2NIDS
Q2NIDS
Q3SM
Q3SM
Q3PS
Q3PS
Q3CORR
Q3CORR
Q3PSQ
Q3PSQ
Q3DC
Q3DC
Q3NIDS
Q3NIDS
Q4SM
Q4SM
Q4PS
Q4PS
Q4CORR
Q4CORR
Q4PSQ
Q4PSQ
Q4DC
Q4DC
Q4NIDS
Q4NIDS
Crumple Zone
Crumple Zone
Q1AP
Q1AP
3
3
Q2AP
Q2AP
Q3AP
Q3AP
Q4AP
Q4AP
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
VPN Router
Layer 3 Switch
Layer 3 Switch
VPN Router
VPN Router
1
1
N
N
Attacker’s 
Attacker’s 
location
location
NIDS
NIDS
2
2
Client 1
Client 1
Client N
Client N
Client LAN 1..4
Client LAN 1..4
Figure 4 Attack Locations
In  the  first  set  of  attacks,  the  attacker  is  connected  to 
the Layer 3 switch via a Switched Port Analyzer (SPAN) 
port,  a  VLAN  port,  and  an  unaddressed  port  (which  de-
faults  to  being  a  Trunk  port4).  Since  the  layer-3  switch 
emulates  a  public  network  like  the  SIPRNet  in  the  de-
fense-enabled system, this level of access  means that  the 
attacker has a high level of presence in the public network 
and can observe all traffic in it. Attempts to get inside the 
client  or  quad  LANs,  or  observing  application  traffic  are 
faced with 2 layers of VPN (VPN routers and the ADF en-
forced  VPGs).  The  VPN  routers  and  the  ADF  NICs  are 
also  key  to  stopping  flood  traffic  from  getting  inside  the 
LANs. However, we observed that the NIDSes do not pick 
up attack traffic that is discarded by the VPN routers be-
cause of their position behind the VPN routers. Also, since 
the VPN routers were a single point in the communication 
path from a LAN to the emulated public network, and they 
lacked diversity, exploitation of an implementation or con-
figuration flaw in the VPN router proved to be fatal.    
Attack Action 
Send traffic to a client VPN 
router  to  decrease  system 
availability5. 
Sniff network traffic6.   
Defensive Action 
VPN  Router’s 
firewall 
drops  non-valid  VPN  traf-
fic. No reply sent back. 
VPN traffic is encrypted so 
the  attacker  can  only  tell 
4 Trunk ports are used to connect routers, using Direct 
Trunk Protocol (DTP), which makes it a highly privileged 
port.  
5  This  occurred  in  internal  Red  Team  experiments  as 
well as the external Red Team exercise. 
6 This occurred during the external Red Team exercise. 
4.1 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
6 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:05:31 UTC from IEEE Xplore.  Restrictions apply. 
(2-2)  Install  own  copy  of 
the kill command into /tmp. 
After  (2-2),  issue  a  kill 
command for all three LCs. 
Publish  an  IO  (Information 
Object) that the client is not 
authorized  to  do  so  to  dis-
rupt the JBI mission. 
Publish  an  authorized  IO 
but increase the  size of the 
IO. 
Publish  an  authorized  IO 
multiple times. 
prohibits  him  from  install-
ing. As a second line of de-
fense,  the  LC  would  re-
move this file if the attacker 
manages to install it. 
None. The LC does not re-
move  this  since  the  LC 
does not protect /tmp. 
LCs  die9  and  stop  sending 
heartbeat  messages.  SMs 
display  a 
lost  heartbeat 
message to the security op-
erators.  One of the security 
operators  notices  this  and 
detaches the client. 
Request  is  denied  by  the 
authorization check. 
The AP in the crumple zone 
performs size checking and 
drops this IO. Or if the size 
were not big enough for the 
AP, Guardian  would notice 
that  the  size  is  too  big  and 
send  an  alert  to  the  SM 
(System Manager). 
Guardian  notices  that  too 
many  of  the  IO  is  coming 
in.  Sends alerts to the SM 
and  the  SM  displays  the 
alert  to  the  security  opera-
tor.  The  SM  operator  re-
calls the repeated IOs. 
4.3  Crumple Zone – AP Host (location 3) 
In this set of attacks, the attacker has made it into the 
Core, and now is on the Q1AP host as the root user. The 
protection  domain  policies,  adaptive  responses  mounted 
by the LC disrupt the attacker’s attempt to become a man-
in-the-middle  using  Q1AP.  The  policy  violation  reports 
and NIDS alerts provide visibility of attack action. Weak 
assumption based design of the PSQ (Publish, Subscribe, 
Query)  protocol  tolerates  delay  and  corruption  caused  at 
this  AP by retransmitting to  other quads. Cross checking 
among PSQ servers and end-to-end signature checking are 
also used.   
Attack Action 
Defensive Action 
9 This assumes that the attacker compromises the pro-
tection  domain  policy  enforcement  mechanism  at  this 
point.  Otherwise,  root  does  not  have  the  privilege  to  kill 
DPASA processes. 
that  traffic  is  passing  be-
tween LANs but cannot de-
cipher the data. 
 VPN  router  drops  some 
traffic,  but  very  high  level 
of  flood  causes  heartbeat 
and  other 
to  be 
dropped.    SM  operator  no-
tices this.  
All  inter-LAN  communica-
tion is lost. 
traffic 
Flood  VPN  router  using 
valid  replay  traffic  to  dis-
rupt  the  flow  of  heartbeat 
messages and  IOs7. 
Disrupt  VPN  tunnels  by 
becoming  a  man-in-the-
middle in the VPN connec-
tion8. 
4.2  Client Host (location 2) 
In  this  second  set  of  attacks,  we  assume  that  the  at-
tacker  has  physical  access  to  a  client  host  running 
SELinux, and has the root password. He is now inside the 
VPN and can interact with the members of the VPGs that 
the client host is part of. The attacker attempts to disrupt 
the  mission  by  corrupting  the  IO  flow.  Defense  against 
this type of attack included the adaptive response mounted 
by  the  LCs  (Local  Controllers)  running  on  the  client’s 
host, modular isolation imposed by the protection domains 
policies, and application level security checks. 
Attack Action 
Open  an  ssh  session  to  an 
AP  (Access  Proxy)  host 
which  the  VPG  and  VPN 
policies  allow  the  client  to 
communicate with.  
(2-1)Use  an  existing  cmd 
line  window  and  perform 
ps  to  get  a  list  of  running 
LCs. 
After  (2-1),  issue  a  kill 
command for all three LCs. 
Defensive Action 
One of the LCs running on 
the  client  host  notices  this 
and  destroys  the  ssh  ses-
sion. 
Protection  domain  policies 
severely limit what the root 
user can do. This operation 
fails. 
The  host  has  been  hard-
ened, thus the kill command 
has been removed from the 
system.  There  is  a  special 
kill  command  that  the  LCs 
can  use,  but  the  protection 
domain  policies  prevent 
root to use. 
SELinux  policy  (part  of 
system  protection  domain) 
Install own copy of the kill 
command into /usr/bin. 
7 This attack was successful in causing an impact at the 
external  Red  Team  exercise  but  the  architecture  did  not 
provide any visibility of success for the attacker, so they 
moved on to another attack.   
8 In the external Red Team exercise a zero-day attack 
of this type was executed, which killed the mission. This 
attack required the trunk port on the layer-3 switch. 
Proceedings of the 21st Annual Computer Security Applications Conference (ACSAC 2005) 
1063-9527/05 $20.00 © 2005 IEEE 
7 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:05:31 UTC from IEEE Xplore.  Restrictions apply. 
(3-1)  Take  over  a  PSQ 
Proxy  by  killing  the  run-
ning  PSQ  proxy,  installing 
his own version of the PSQ 