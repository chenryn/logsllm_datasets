a natural next question is how click-spam may evolve. Given
the insight in Section 4 that click-spammers must have higher
ROI than ethical publishers, the core Viceroi approach (of
comparing publisher revenue per user distributions against
a benchmark set of ethical publishers) we believe will still
be sound, but the ﬁner details like the sensitivity to the
(at-present auto-tuned) τ threshold may increase as click-
spammers accept lower revenues so they can play within the
margins.
Sybil Publishers. To avoid detection by Viceroi, one way
to reduce (apparent) revenue per user is for a publisher to
appear as multiple publishers (Sybils) each making a frac-
tion of the original revenue. Indeed such attempts have been
reported [4]. If the Sybils share the same bank-account to
receive ad network payments, they can be trivially recom-
bined. Acquiring multiple bank-accounts to receive pay-
ments is a high-overhead (and high-risk) task [16].
Sybil Users. Another way to reduce (apparent) revenue
per user is for the click-spammer to make each user he con-
trols appear as multiple users. Note that this approach
does not apply to click-spam mechanisms where the click-
spammer does not have the ability to run arbitrary code
Figure 9: Impact of a click-spammer ethically acquiring traﬃc.
Viceroi catches the click-spammer as long as more than half the
traﬃc is click-spam.
Impact of click-spammer growing botnet size.
Figure 10:
Viceroi continues to catch the click-spammer up to two orders
of magnitude increase in botnet size.
from the user’s device (e.g., arbitrage, parked domains, and
in-network search hijacking). Even when the click-spammer
can run arbitrary code, whether he can successfully inﬂate
the user count depends on how the ad network counts users.
Certain user identiﬁers like IP addresses are hard to fake10.
Collusion. One way to play within the margins is for the
click-spammer to collude with an ethical publisher. The idea
is for the click-spammer to add ethically-acquired cover traf-
ﬁc to avoid detection. We simulate such an arrangement by
pairing a click-spammer from our dataset with a randomly
chosen ethical publisher from the dataset with roughly the
same number of users. We perform a parameter sweep where
the click-spammer replaces x% of his users with users ac-
quires from the (now no-longer) ethical publisher with x
ranging from 0% to 100%. At x = 0 the simulated publisher
is identical to the original click-spammer and Viceroi ﬂags
it. At x = 100 the simulated publisher is identical to the
original ethical publisher, and Viceroi doesn’t ﬂag it. We are
interesting in learning at what point the transition occurs.
Figure 9 shows the position of the simulated publisher
relative to the auto-tuned value of τ — positions to the
left of τ are ﬂagged by Viceroi as click-spam, and positions
to the right of τ are not. We ﬁnd that as the simulated
publisher gradually adds more ethically acquired users, his
position drifts closer to the τ threshold, falling right on the
boundary when the simulated publisher has a roughly 50-50
split between ethical clicks and click-spam. As the fraction
of ethical clicks starts dominating, Viceroi stops ﬂagging the
publisher.
We believe this behavior is desirable for the ad network
since it creates a positive incentive for click-spammers to
reform their ways. Where a click-spammer would make no
revenue from click-spam if he were to operate in the shaded
region, if he were to grow his users in line with how an
ethical publisher acquires users, he would exit the shaded
region and start making money (ethically). Over time the
10Note IP spooﬁng is not an option since all communica-
tion between the user device and the ad network goes over
HTTP, which requires the user device to be able to receive
and respond to inbound TCP packets from the ad network.
threshold may be moved farther to the right to further incent
good behavior.
Brute Force. Another way to play within the margins is
for the click-spammer to dramatically increase the size of
the botnet while making the bots click less. This has the
overall eﬀect of increasing ﬁxed-costs while holding revenue
constant, in essence decreasing the revenue per user, which
is necessary for the click-spammer to exit the shaded region
in Figure 2 to avoid getting ﬂagged. To determine how much
larger a botnet the click-spammer needs, we simulate bot-
nets up to 2 orders of magnitude larger than click-spammers
ﬂagged by Viceroi. We are interested in learning how much
head-room is present in Viceroi’s current choice of threshold
τ .
Figure 10 shows the position of the simulated click-spammer
relative to the auto-tuned value of τ . The click-spammer’s
current botnet size (labeled as 1x) is comfortably in the re-
gion ﬂagged by Viceroi. As we increase it by an order of
magnitude, the simulated click-spammer moves closer to the
τ thresholds. With two orders of magnitude larger a bot-
net, the click-spammer is on the borderline. Beyond this
Viceroi’s current choice of τ does not ﬂag the spammer. Note
that in the process the click-spammer’s ﬁxed-costs increases
commensurately by two orders of magnitude while holding
revenue constant; i.e., the click-spammer’s proﬁts drop up to
by 99% in the process. We cannot answer, however, whether
click-spam through botnets will remain economically viable
even after a two orders of magnitude drop in proﬁts. Nev-
ertheless, we believe that the learned threshold τ has suﬃ-
cient head-room when dealing with signiﬁcantly larger bot-
nets than today.
8. SUMMARY
In this paper we present Viceroi, a general approach to
catching click-spam. It is designed around the invariant that
click-spam is a business (for click-spammers) that needs to
deliver high ROI to oﬀset the risk of getting caught. We eval-
uate our approach on a large real-world ad-network dataset
and ﬁnd six diﬀerent classes of click-spam linked to con-
version fraud, ad injection, search hijacking, malware, arbi-
trage, and parked domains. We additionally ﬁnd evidence
of many sub-classes of these types including automated and
semi-automated conversion fraud, hijacking through DNS
interception, and ﬁnd multiple publishers beneﬁting from
each of these models. The Viceroi approach ﬂags click-spam
through all these mechanisms without any tuning knobs, has
good performance on ROC and precision-recall curves, and
is resilient against click-spammers using larger botnets over
time. Furthermore, our approach is ranked among the best
existing ﬁlters deployed by the ad-network today while be-
ing far more general. We additionally present the novel bluﬀ
form technique for catching conversion fraud.
Acknowledgements
We’d like to thank the anonymous reviewers and our shep-
herd, Vyas Sekar for their comments. We’d also like to ac-
knowledge Geoﬀ Voelker for his feedback on the paper. The
paper is much improved because of their inputs and sugges-
tions. Additionally, we are greatly indebted to Jigar Mody,
Dennis Minium, Shiva Nagabhushanswamy, Tommy Blizard
and Nikola Livic, without whose help and inputs, this work
would not have been possible.
9. REFERENCES
[1] Alrwais, S. A., Gerber, A., Dunn, C. W.,
Spatscheck, O., Gupta, M., and Osterweil, E.
Dissecting Ghost Clicks: Ad Fraud Via Misdirected
Human Clicks. In Proceedings of the 28th Annual
Computer Security Applications Conference (ACSAC)
(Orlando, FL, 2012), pp. 21–30.
[2] Blizard, T., and Livic, N. Click-fraud monetizing
malware: A survey and case study. In Proceedings of
the 7th International Conference on Malicious and
Unwanted Software (MALWARE) (Fajardo, PR, Oct.
2012), pp. 67–72.
[3] Caballero, J., Grier, C., Kreibich, C., and
Paxson, V. Measuring Pay-per-Install: The
Commoditization of Malware Distribution. In
Proceedings of the 20th USENIX Security Symposium
(San Francisco, CA, Aug. 2011).
[4] Dave, V., Guha, S., and Zhang, Y. Measuring and
Fingerprinting Click-Spam in Ad Networks. In
Proceedings of the Annual Conference of the ACM
Special Interest Group on Data Communication
(SIGCOMM) (Helsinki, Finland, Aug. 2012),
pp. 175–186.
[5] FBI. Operation Ghost Click: International Cyber
Ring That Infected Millions of Computers Dismantled.
Federal Bureau of Investigation Press Releases (Sept.
2011). http://1.usa.gov/12c8Vhr.
[6] Google Inc. About smart pricing. AdWords Help
(Apr. 2013). http://bit.ly/XObpxY.
[7] Google Inc. buzzdock. Google Search (May 2013).
http://bit.ly/17MoGPq.
[8] Google Inc. How Google uses conversion data.
AdWords Help (Mar. 2013). http://bit.ly/YJHUnF.
[9] Google Inc. Payment Options and Minimum
Payment Amounts. Google AdWords (May 2013).
http://bit.ly/XZhRmH.
[10] Haddadi, H. Fighting Online Click-Fraud Using Bluﬀ
Ads. Computer Communication Review (CCR) 40, 2
(Apr. 2010), 21–25.
[11] Ipeirotis, P. Uncovering an advertising fraud
scheme. Or “the Internet is for porn”. Blog: A
Computer Scientist in a Business School (Mar. 2011).
http://bit.ly/LqYyTs.
[12] Jesdanun, A. Ad Targeting Based on ISP Tracking
Now in Doubt. Associated Press (Sept. 2008).
[13] Juels, A., Stamm, S., and Jakobsson, M.
Combating Click Fraud via Premium Clicks. In
Proceedings of the 16th USENIX Security Symposium
(Boston, MA, Aug. 2007), pp. 1–10.
[14] Kanich, C., Kreibich, C., Levchenko, K.,
Enright, B., Voelker, G. M., Paxson, V., and
Savage, S. Spamalytics: An Empirical Analysis of
Spam Marketing Conversion. In Proceedings of the
15th ACM Conference on Computer and
Communications Security (CCS) (Alexandria, VA,
Oct. 2008), pp. 3–14.
[15] Lattin, P. Cost Per Download or Cost Per Install
Marketing. Performance Marketing Insider (Sept.
2011). http://bit.ly/Xdq85I.
[16] Levchenko, K., Pitsillidis, A., Chachra, N.,
Enright, B., F´elegyh´azi, M., Grier, C.,
Halvorson, T., Kanich, C., Kreibich, C., Liu, H.,
McCoy, D., Weaver, N., Paxson, V., Voelker,
G. M., and Savage, S. Click Trajectories:
End-to-End Analysis of the Spam Value Chain. In
Proceedings of the 32nd IEEE Symposium on Security
and Privacy (Oakland) (Oakland, CA, May 2011),
pp. 431–446.
[17] McCoy, D., Pitsillidis, A., Jordan, G., Weaver,
N., Kreibich, C., Krebs, B., Voelker, G. M.,
Savage, S., and Levchenko, K. PharmaLeaks:
Understanding the Business of Online Pharmaceutical
Aﬃliate Programs. In Proceedings of the 21st USENIX
Security Symposium (Bellevue, WA, Aug. 2012).
[18] Metwally, A., Agrawal, D., and El Abbadi, A.
DETECTIVES: DETEcting Coalition hiT Inﬂation
attacks in adVertising nEtworks Streams. In
Proceedings of the 16th International World Wide
Web Conference (WWW) (Banﬀ, Canada, May 2007),
pp. 241–250.
[19] Metwally, A., Emek¸ci, F., Agrawal, D., and El
Abbadi, A. SLEUTH: Single-pubLisher attack
dEtection Using correlaTion Hunting. Proceedings of
the VLDB Endowment (PVLDB) 1, 2 (Aug. 2008),
1217–1228.
[20] Miller, B., Pearce, P., Grier, C., Kreibich, C.,
and Paxson, V. What’s Clicking What? Techniques
and Innovations of Today’s Clickbots. In Proceedings
of the Conference on Detection of Intrusions and
Malware & Vulnerability Assessment (DIMVA)
(Amsterdam, Netherlands, July 2011), pp. 164–183.
[21] Moore, T., Leontiadis, N., and Christin, N.
Fashion Crimes: Trending-Term Exploitation on the
Web. In Proceedings of the 18th ACM Conference on
Computer and Communications Security (CCS)
(Chicago, IL, Oct. 2011), pp. 455–466.
[22] Ollmann, G. Want to rent an 80-120k DDoS Botnet?
Blog: Damballa (Aug. 2009). http://bit.ly/W9Hh2x.
[23] PandaLabs. Panda Labs Security Report. Panda
Security Press Center (Apr. 2011).
http://bit.ly/150bmHw.
[24] Parker, P. IAB & PwC: Search Still Tops Online Ad
Revenues, And Share Grew In 2011. Blog: Search
Engine Land (Apr. 2012). http://selnd.com/12WlgoH.
[25] Roesner, F., Kohno, T., Moshchuk, A., Parno,
B., Wang, H. J., and Cowan, C. User-Driven
Access Control: Rethinking Permission Granting in
Modern Operating Systems. In Proceedings of the 33rd
IEEE Symposium on Security and Privacy (Oakland)
(San Francisco, CA, May 2012), pp. 224–238.
[26] Rose, D. E., and Levinson, D. Understanding User
Goals in Web Search. In Proceedings of the 13th
International World Wide Web Conference (WWW)
(New York, NY, May 2004), pp. 13–19.
Networks. In Proceedings of the 22nd USENIX
Security Symposium (Washington, DC, Aug. 2013).
[29] Tuzhilin, A. The Lane’s Gift v. Google Report.
Google Oﬃcial Blog (July 2006).
http://bit.ly/13ABxSZ.
[30] Wyke, J. Sophos Technical Paper: ZeroAccess Botnet
– Mining and Fraud for Massive Financial Gain.
Sophos Labs (Sept. 2012). http://bit.ly/12ftRai.
[31] Yu, F., Xie, Y., and Ke, Q. SBotMiner: large scale
search bot detection. In Proceedings of the ACM
International Conference on Web Search and Data
Mining (WSDM) (New York City, NY, Feb. 2010),
pp. 421–430.
[27] Sinclair, L. Click fraud rampant in online ads, says
[32] Zhang, Q., Ristenpart, T., Savage, S., and
Bing. The Australian (May 2011).
http://bit.ly/LqYval.
[28] Springborn, K., and Barford, P. Impression
Fraud in Online Advertising via Pay-Per-View
Voelker, G. M. Got Traﬃc? An Evaluation of Click
Traﬃc Providers. In Proceedings of Joint
WICOW/AIRWeb Workshop on Web Quality
(Hyderabad, India, Mar. 2011), pp. 19–26.