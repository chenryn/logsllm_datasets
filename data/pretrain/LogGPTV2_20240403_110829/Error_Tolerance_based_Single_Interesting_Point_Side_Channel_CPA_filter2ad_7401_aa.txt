title:Error Tolerance based Single Interesting Point Side Channel CPA
Distinguisher
author:Changhai Ou and
Zhu Wang and
Juan Ai and
Xinping Zhou and
Degang Sun and
Victor E. DeBrunner
Error Tolerance based Single Interesting Point Side
Channel CPA Distinguisher
Academy of Sciences, Beijing
Academy of Sciences, Beijing
Academy of Sciences, Beijing
Juan Ai
Institute of Information
Engineering, Chinese
100093,China
University of Chinese
Academy of Sciences,Beijing
100049,China
PI:EMAIL
Victor DeBrunner
University,FL32310,USA
Florida State
PI:EMAIL
Changhai Ou
Institute of Information
Engineering, Chinese
100093,China
University of Chinese
Academy of Sciences,Beijing
PI:EMAIL
100049,China
Zhu Wang
Institute of Information
Engineering, Chinese
100093,China
PI:EMAIL
Xinping Zhou
Institute of Information
Engineering, Chinese
Academy of Sciences, Beijing
100093,China
University of Chinese
Academy of Sciences,Beijing
PI:EMAIL
100049,China
Degang Sun
Institute of Information
Engineering, Chinese
Academy of Sciences, Beijing
PI:EMAIL
100093,China
ABSTRACT
The eﬃciency can be signiﬁcantly improved if the attacker
uses interesting points to perform Correlation Power Anal-
ysis (CPA). The prerequisite for this is that the attacker
knows the positions of interesting points. However, it is
diﬃcult for the attacker to accurately ﬁnd the locations of
interesting points if he only has a small number of power
traces. In this paper, we propose a Frequency based Inter-
esting Points Selection algorithm (FIPS) to select interest-
ing points under the condition that the attacker only has
a very small number of power traces. Moreover, an error
tolerant Single Interesting Point based CPA (SIP-CPA) is
proposed. Experiments on AES algorithm implemented on
an AT 89S52 single chip and power trace set of DPA contest
v1 of DES algorithm implemented on the Side Channel At-
tack Standard Evaluation Board (SASEBO) show that, our
SIP-CPA can signiﬁcantly improve the eﬃciency of CPA.
Keywords
SIP-CPA, interesting point selection, FIPS, side channel,
DPA contest V1, error tolerance
1.
INTRODUCTION
Correlation Power Analysis (CPA) was ﬁrstly proposed
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for prof t or commercial advantage and that copies bear this notice and the full cita-
tion on the f rst page. Copyrights for components of this work owned by others than
ACM must be honored. Abstracting with credit is permitted. To copy otherwise, or re-
publish, to post on servers or to redistribute to lists, requires prior specif c permission
and/or a fee. Request permissions from Permissions@acm.org.
ASIA CCS ’16, May 30-June 03, 2016, Xi’an, China
c(cid:13) 2016 ACM. ISBN 978-1-4503-4233-9/16/05. . . $15.00
DOI: http://dx.doi.org/10.1145/2897845.2897902
in [2], which is considered as one of the most powerful side
channel attacks. One advantage of CPA is that, the at-
tacker doesn’t need to have the prior knowledge of the cryp-
tographic device and the speciﬁc implementation of crypto-
graphic algorithm. The attacker recovers the key used in
the cryptographic device by calculating the correlation co-
eﬃcients of the assumed power consumption and the real
power consumption. The maximum correlation coeﬃcient
corresponds to the correct key.
1.1 Related Works
In order to improve the eﬃciency of CPA, signal process-
ing [7] and some accurate power leakage models [8] [12] have
been proposed. Signal processing such as power traces align-
ment [15],de-noise [5] [17] etc, can signiﬁcantly improve the
eﬃciency of CPA. A new signal preprocessing named biasing
power traces [6] [10] with high Signal to Noise Ratio (SN R)
can also improve the eﬃciency of CPA.
Interesting points are often taken into consideration in
Template Attack [11] [13]. According to [13], interesting
points are time samples providing the most information for
side channel attacks(i.e. Template Attack). The attacker
can proﬁle the templates accurately and make the attack
more eﬀective by using interesting points. For example, Y.
Oren et al. used interesting points in regions of interest to
enhance Template Attack [11]. However, interesting points
selection is not necessarily taken into consideration when
performing CPA, since the attacker doesn’t need to know
the locations of interesting points.
CPA can also be considered as a powerful distinguisher, or
a method of interesting points selection. For example, Zheng
et al. proposed that not only distinguishers like CPA but
also distinguishers like Mutual Information Analysis (MIA)
[4] and KS-test based Analysis (KSA) [16] can be used to
select interesting points [18]. If interesting points selection
819is taken into consideration, the eﬃciency of CPA can be
signiﬁcantly improved.
The prerequisite for using interesting points to carry out
highly eﬃcient side channel analysis is that the attacker has
enough power traces. Thus, he can ﬁnd the accurate loca-
tions of interesting points. However, if the attacker only has
a very small number of power traces, he is likely to fail to
directly use these power traces to perform CPA. In this case,
it is very diﬃcult for him to ﬁnd the accurate locations of
interesting points to improve the eﬃciency of CPA.
1.2 Our Contributions
The main contributions of this paper are as follows:
- we propose a Frequency based Interesting Points Selec-
tion algorithm (FIPS) to accurately select interesting
points under the condition that the attacker only has
a small number of power traces.
- Moreover, an error tolerant Single Interesting Points
based CPA (SIP-CPA) combined with Frequency based
Interesting Points Selection algorithm (FIPS) is pro-
posed to enhance CPA. Both experimental results on
AES implemented on an AT 89S52 single chip and DES
implemented on the Side Channel Attack Standard
Evaluation Board (SASEBO) show that our SIP-CPA
can signiﬁcantly improve the eﬃciency of CPA.
1.3 Organizations
This paper is organized as follows. In order to select in-
teresting points to perform SIP-CPA, we introduce our Fre-
quency based Interesting Points Selection algorithm (FIPS)
in section 2. The feasibility of our error tolerant Single In-
teresting Point based CPA (SIP-CPA) and the correspond-
ing speciﬁc attack procedures are demonstrated in section
3. Then, in section 4, experiments are performed on an
AT89S52 single chip and the power trace set of DPA con-
test V1 to compare the eﬃciency of our SIP-CPA with CPA.
Finally, we conclude this paper in section 5.
2. CHOOSING INTERESTING POINTS
For CPA, the attacker generally does not need to know
the locations of interesting points. All he needs to do is just
calculating the correlation coeﬃcients of the assumed power
consumption and the real power consumption. The maxi-
mum one in the correlation coeﬃcient matrix corresponds
to the correct key.
In the actual attack scenario, the attacker can extract one
or several interesting points to enhance CPA. Diﬀering from
performing CPA by using the regions of interest proposed in
[11], this attack can get more accurate power consumption
caused by the operation of intermediate state, making the
correlation coeﬃcients of the correct key higher, so as to
improve the eﬃciency of CPA.
We consider how to improve the success rate by selecting
interesting points in a small number of power traces in this
paper. Suppose that we can obtain a success rate of κ by
using traditional CPA when m power traces are used. We
can achieve a success rate of κ
(≥ κ) by using our SIP-CPA
introduced in section 3.
′
In this paper, we assume that the attacker does not know
the locations of interesting points, and he only has a small
number of power traces.
If he directly used all of these
power traces to perform CPA, the success rate is less than
1 (i.e. 0.8).
In order to enhance his attack ability, one
of methods is to perform CPA by using interesting points.
The prerequisite for this is that, he can be able to extract
interesting points from these power traces. We will introduce
our Frequency based Interesting Points Selection algorithm
(FIPS) to select interesting points from a small number of
power traces in section 2.1.
2.1 Frequency based Interesting Points
Selection Algorithm
Suppose that IPi is a set of selected interesting points
most relevant to the intermediate state, the matrix
plain [1 · · · m] contains m plain-texts, and m power traces
are acquired and saved to a matrix Tm×N . Let k
and k
denote the time sample threshold and correlation coeﬃcient
threshold respectively. The attack ﬂow of our Frequency
based Interesting Points Selection algorithm (FIPS) is shown
in Algorithm 1.
′
Algorithm 1 Frequency based Interesting Points Selection
algorithm (FIPS).
Input: The power trace set T with m power traces and the
corresponding m plaintexts P ; The time sample thresh-
old k
used in each repetition; The correlation coeﬃcient
threshold k.
′
Output: The locations Location [1, · · · , k] of the k inter-
esting points to be chosen.
′
′
] ← CPA (T1, P1)
if Loc [i, 1 · · · k
] is equal to corr key then
t1 = random (m, t)
T1 ← SelectTraces(T, t1)
P1 ← SelectPlaintext(P, t1)
Loc[gkey, 1 · · · k
Count1 [1, gkey] ←Count1 [1, gkey] + 1
1: t = m ∗ a
2: for i = 1, 2, · · · , run do
3:
4:
5:
6:
7:
8: end for
9: corr key ← argmax( Count1 [0, · · · , 2L − 1])
10: for i = 1, 2, · · · , run do
11:
12:
13:
14:
end if
15: end for
16: for i = 1, 2, · · · , count do
17:
do
18:
19:
20: end for
21: Location [1 · · · k] ← chooseMax(Location1, k)
22: return Location [1, · · · , k]
count ← count + 1
IP hcount, 1 · · · k
′i ← Lochi, 1 · · · k
′i
for j = 1, 2, · · · , k
′
end for
Location1[1, IP [i, j]] = Location1 [1, IP [i, j]] + 1
In order to select interesting points from a small number of
power traces, we only use a% of m power traces to perform
traditional CPA (step 1 of Algorithm 1). The value of a
can’t be too big, and it can’t be too small, either. If a is
too big, the same power traces may be repeatedly selected
in our experiments. If the value a is too small, the success
rate is too low and too many repetitions is needed. This
value empirically ranges from 30 to 60 in our experiments.
Suppose that the experiment is repeated run times, and t
power traces are randomly selected from a total number of
820m. A key gkey corresponding to the maximum correlation
coeﬃcient is returned in each repetition, which is regarded
as the correct key. Moreover, an error tolerance interest-
ing point set Loc hgkey, 1 · · · k
interesting points
having max correlation coeﬃcients is returned, too.
′i with k
′
Actually, the key gkey is not necessarily the correct one.
If the bit length of guessing key corresponding to an inter-
mediate state is L, then there will be 2L possible keys. In
statistical, the probability of each key is
P r [key = i] =
1
2L
(1)
However, the probability corresponding to the correct key
will be greater than 1
2L . For example, the statistical success
rate of ω power traces is 20%. If the experiment is repeated
640 times, the average frequency of each wrong guessing key
in set Count1 (cid:2)0 · · · 2L − 1(cid:3) is about 2 times, and about 128
times for the correct key. The array Location1 is used to
record the frequency of each key. We repeat steps 3-7 of
Algorithm 1 run times and count the frequency of each key.
The key with highest frequency corresponds to the correct
one((step 9 of Algorithm 1)).
However, if the error rate is high, a time sample with high
correlation coeﬃcient is not necessarily a good or right in-
teresting point. So, we select multiple interesting points in
each repetition. The higher frequency of a time sample, the
greater possibility of an interesting one. We sort the cor-
relation coeﬃcients corresponding to this key in descending
order. Suppose that we select k
interesting points, then the
interesting points with max correlation
locations of these k
coeﬃcients will be returned.
′
′
The higher frequency of an interesting point, the better
one it will be. The lower frequency of a time sample in the
matrix Location1, the smaller probability of an interesting
one it will be. We add the interesting points to a new matrix
IP (steps 10-15 of Algorithm 1). Then, we calculate the fre-
quencies of interesting points in the matrix IP (steps 16-20
of Algorithm 1). The frequency of each interesting point will
be saved in the array Location1. Then, k interesting points
with maximum frequencies are chosen from Location1 using
function chooseM ax() (step 21 of Algorithm 1). Speciﬁ-
cally, we sort the time samples in descending order accord-
ing to their correlation coeﬃcients. We ﬁnd the k interesting
points with highest correlation coeﬃcients and save them to
an array Location [1 · · · k] (step 22 of Algorithm 1).
2.2 Frequency based Interesting Points
Selection Algorithm Using Time Sample
Window
For a complete cryptographic algorithm, there are usually
too many time samples if the sampling rate is high. It will
consume a lot of memory and time if we perform CPA using
all time samples. For example, we use the power trace set
of DP A contest V 1 in our experiment. The number of time
samples on each power trace is 20003. We don’t know the
location of the output of the ﬁrst S-box in the last round of
DES algorithm. It’s clear that using all 20003 time points
to perform CPA isn’t a good choice.
Y. Oren et al. suggested that only time sample regions
with high correlation coeﬃcients are taken into considera-
tion when performing CPA [11]. However, in that paper,
there is a strong assumption that the attacker has enough
power traces and the locations of high correlation coeﬃcients
regions have been known. In this paper, we propose an al-
gorithm to search interesting points based on time sample
window.
We deﬁne a threshold that the frequency of a key keyi
is signiﬁcantly greater than these of all other keys. In our
experiments, this value is greater than 10. The deﬁnition is
as follow.
Deﬁnition 1. ∀j ∈ (cid:8)0 · · · 2L − 1(cid:9) \ {i}, if equation
F req [keyi] ≥ 10 ∗ F req [keyj ]
(2)
is satisﬁed, then the frequency of keyi is signiﬁcantly greater
than that of keyj .
Suppose that the size of time sample window is n, and
the total number of time samples is N . The time window
algorithm is shown as Algorithm 2.
Algorithm 2 Frequency based Interesting Points Selection
Algorithm (FIPS) using time sample window.
Input: The power trace set T with m power traces and the
corresponding m plaintexts P ; The time sample thresh-
old k
used in each repetition; The correlation coeﬃcient
threshold k.
′
Output: The locations Location [1, · · · , k] of the k inter-
esting points to be chosen.
Tm×n ← TimeWindow (i, Tm×N )
p ← CPA (Tm×n, P )
Count1 [1, p] ← Count1 [1, p] + 1
1: start = 1
2: for i=1:n:N do
3:
4:
5:
6: end for
7: cor key ← argmax (cid:0)Count1 (cid:2)1, 0 · · · 2L − 1(cid:3)(cid:1)
8: if cor key > other keys singnif icnatly then
9:
10: else
11:
12: end if
13: Tm×n ← Tm×[i···i+n−1]
14: Location [1 · · · k] = FIPS (cid:16)Tm×n, k, k
go to step 2
start = i
, P(cid:17)
′
As shown in Algorithm 2, the interesting points are searched
by n each step using a function named T imeW indow() (step
3 of Algorithm 2). Each traditional CPA returns a key corre-
sponding to the max correlation coeﬃcient (this key may be
not the correct one). The correct key corresponds to the one
with highest frequency in the array Count1 (step 7 of Algo-
rithm 2). If the frequency of the correct key is signiﬁcantly
higher than these of the wrong guessing keys, then there
exist interesting points in the current time window, which
indicates that the operation of intermediate value (i.e. the
output of S-box) appears in the current time window (steps
8-9 of Algorithm 2). Then, start = i. Otherwise, we think
that there are no interesting points (or no good interest-
ing points) in the current time window, we will move the
time window to the next n time samples and continue our
searching.
2.3 The Thresholds k
′ and k
The thresholds k
′
in Algorithm 1 and Algorithm 2. If k
and k are very important parameters
and k are too small,
′
821the interesting points with highest correlation coeﬃcients
may be located in the outside of the time sample window.
If k is too large, too many time samples will appear in the
window, which may be not interesting points. Thus, the
accuracy of interesting points selection is greatly impacted.
So, reasonable error tolerant time sample threshold k
and
correlation coeﬃcient threshold k are particular important
for the attacker to enhance the eﬃciency of CPA.
′
′
We just make k
equal to the number of time samples
in each repetition. In order to determine the threshold k,
a good method is that, the attacker repeatedly performs
CPA many times. He sets a number of correlation coeﬃ-
cient thresholds. Then, he caculates the average number of
sample points for each threshold. He then chooses a reason-
able value from the means as a threshold.
3. SINGLE INTERESTING POINT BASED
CPA
3.1 Basic Theory
Power consumption of an interesting point can be approx-
imated by a normal distribution [9]. For a software crypto-
graphic algorithm implementation, Hamming weight model
is usually applied to proﬁle the assumed power consump-
tion of intermediate state. The power consumption can be
modeled as
Ptotal = a ∗ HW (cid:16)value
′(cid:17) + Pother.
(3)
′
The symbols value and value
denote the values of the same
register at two diﬀerent times, HW denotes the Hamming
weight function. The value a is a constant, and Pother rep-
resents the other power consumption components. The for-
mula shows that the power consumption is in linear relation-
ship with the Hamming weight of intermediate value. The
time samples having greater correlation coeﬃcients are more
relevant to the operation of intermediate data.
number of power traces N is inﬁnitely large, and the correct
key value is i, then,
lim
N→∞
ρ (HDi, Ptotal) = 1.
(8)
That’s to say, the ρ corresponding to the correct guessing
key is close to 1. If the guessing key is not the correct one, ρ
will be close to 0. Thus, the correct key can be distinguished
from the wrong ones. Although we can not acquire power
traces without noise, and the power consumption model may
be not accurately enough to proﬁle the power consumption
of the chip, if enough power traces are used, the max cor-
relation coeﬃcient corresponding to the correct key will be
larger than these corresponding to the wrong keys. This also
illustrates that an ideal interesting point is able to accom-
plish the task of traditional CPA.
3.2 Performing A Single Interesting Point
Based CPA
For traditional CPA, the correct key has one or several
high correlation coeﬃcients. So, the correct key can be dis-
tinguished from the wrong ones. If the guessing key is cor-
rect, there is strong correlation between the assumed power
consumption and the real power consumption.
In some
cases, the correlation coeﬃcients corresponding to some wrong
keys are even greater than these of the correct one. The suc-
cess rate of CPA is seriously aﬀected.
When interesting points have been selected by using Algo-
rithm 1 and Algorithm 2, the single interesting point based
CPA (SIP-CPA) can be performed as follows.
(a). The attacker selects the interesting point located in