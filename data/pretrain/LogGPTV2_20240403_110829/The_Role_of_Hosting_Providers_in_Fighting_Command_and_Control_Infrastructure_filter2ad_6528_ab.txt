relation between C&C abuse and structural characteristics
of providers. In the next section, we examine the ‘average
C&C uptime’ as a proxy for the security eﬀort of providers.
We categorize the variables characterizing structural prop-
erties of providers into those that capture size, regulatory
aspects of the country in which providers operate and those
that capture providers’ business model characteristics. A
summary of these variables is provided in Table 2.
4.1 Structural Characteristics of Providers
Size
4.1.1
Allocated IP space is the size of the IP address net-
block(s) assigned to a hosting provider according to WHOIS
data provided by Regional Internet Registries (RIR). We
use this information as an indicator of the attack surface of
a provider, assuming that the address range is a proxy for
the amount of server infrastructure the provider is operat-
ing and that any machine in that infrastructure has a certain
probability to be abused by miscreants – i.e., more servers
means a higher count of C&C. This variable ranges from
one IP address to many thousands of allocated addresses,
suggesting a large heterogeneity in the market for hosting
services, in terms of attack surface but also business models
of providers.
Webhosting IP space is the number of IP addresses
hosting a domain name. To collect information on this
variable we make use of passive DNS data. We calculate
this variable by summing up all the IP addresses associated
with domains per provider that have been observed in our
DNSDB passive DNS data. The combination of the allo-
cated IP space and web hosting IP space not only indicate
the size of a provider’s infrastructure, but also reﬂect the
kind of business a hosting provider is running. For instance,
providers who use a large part of their allocated IP space
for hosting domain names have a business model more fo-
cused on web hosting and are diﬀerent from providers who
use their allocated IP space for other services such as pro-
viding virtual private servers (VPS), collocation, or access
services.
Domain name space is the number of domains hosted
by a particular provider. Again we use passive DNS data
to collect information on this variable. It is calculated by
summing up the number of second-level domains hosted on
the IP addresses of provider in the passive DNS. Note that
due to the large variance and skewed distribution of the
ﬁrst three variables, we use a log-transformation of these
variables (Log10).
Proportion of shared hosting measures the ratio of
domains that are hosted on shared IP addresses divided by
the total size of domain name space. We consider an IP
address shared if it hosts more than 10 domain names [39,
42]. This variable not only conveys information about the
size of the shared hosting infrastructure of a provider, but
also about the provider’s business model, i.e., the degree to
which a provider’s business relies on low-cost shared hosting
services.
4.1.2 Regulation
Rule of law is an index that we use as a proxy for law
enforcement against illegal activity within a country. It is a
well-established indicator relying on a large number of peri-
578Table 2: Descriptive summary of variables in our model
variables
Allocated IP space size (log10)
Webhosting IP space size (log10)
Domain name space size (log10)
Portion of shared hosting (%)
Rule of law
Best price (USD)
Popularity index
Time in business (years)
Vulnerable software ratio
n
45, 363
45, 363
45, 363
45, 363
46, 269
235
90
150
86
min
0
0
0
0
−1.89
0
0
2
0.01
mean
median
max
sd
3.08
1.78
1.98
50.99
1.05
20.89
8, 328.34
14.01
0.19
3.19
1.66
1.83
58.99
1.62
6.95
1, 279.29
14.19
0.16
8.35
6.24
7.64
100
2.12
419
187, 454.30
30
0.48
1.16
0.76
0.88
37.13
0.95
47.34
26, 828.03
4.43
0.11
odic surveys to measure how the rule of law is experienced
in practical, everyday situations by the general public. The
index is provided by the World Justice Project, a non-proﬁt
organization working to advance the rule of law around the
globe and is based on indicators such as constraints on gov-
ernment powers, absence of corruption, order and security,
civil and criminal justice, open government, fundamental
rights, regulatory enforcement and justice experienced by or-
dinary people from 99 countries around the globe [7]. Lower
index values represent a stronger rule of law.
4.1.3 Business Model
Most of the business model variables in this section cannot
easily be collected at scale for the total population of hosting
providers. While collecting price information requires man-
ual inspection of the provider’s webpage, collecting some
other variables in scale such as vulnerable software infor-
mation can perhaps even be considered unethical since it
imposes a cost on the scanned network. Therefore, we col-
lect information for variables in the business model category
for only a sample of the providers.
Popularity index proxies the online popularity of a host-
ing provider. We use Alexa’s one million top-ranked do-
mains to calculate the popularity index. We assume a provider
is more popular when more top-1M domains are on the list of
domains that it hosts and speculate that more popular pro-
viders are exploited more often for setting up C&C domains.
In order to reduce the bias towards the very large hosting
providers, the index is calculated by summing up the base-
10 logarithm of the reverse Alexa rank of all domains. The
score communicates information about both website popu-
larity (i.e., customers) and the density of popular domains
in a hosting provider.
Time in business is a proxy for capturing the extent
to which a provider can be exploited, given the amount of
years it is operating in the hosting business. The expectation
is for more experienced providers to be exploited less due
to learning eﬀects. The data for this variable is collected
by querying the WHOIS databse for the registration date of
the provider’s website. We have cross-checked the results
with the Internet Archive database [34] for all data points.
Almost all domains in our sample were captured by Web-
archive a couple of months after they were registered.
Best Price is basically the least expensive hosting plan
on oﬀer by the hosting provider. Our hypothesis is that
providers with less expensive hosting plans are more popu-
lar to host C&C domains, not only for the case of malicious
registrations but also in the case of compromised domains.
The intuition being that providers with cheaper plans most
probably dedicate less resources to the security of their ser-
vices. All prices are converted to US dollars by taking the
2015 average exchange rate.
Vulnerable software ratio is the proportion of domains
operating on vulnerable software installations hosted by the
providers in our study. Previous research shows that popu-
lar software such as Content Management Systems (CMS),
increase the chance of getting compromised [42]. We use
Wordpress installations as a proxy for common vulnerable
software. To scan for such installations, we use WPScan –
a Wordpress vulnerability scanner developed and supported
by Sucuri– to collect data for a random sample of 2% of
a provider’s hosted domains [4]. The ‘vulnerable software
ratio’ is calculated by dividing the number of scanned do-
mains with Wordpress installations by all scanned domains
excluding those that we were unable to scan.
4.2 Effect of Providers’ Structural Character-
istics
To disentangle the eﬀects of the various structural char-
acteristics of hosting providers which we have outlined pre-
viously on the concentration of C&Cs, we use a general-
ized linear model (GLM) with log-linear link-function of the
form:
ln(λi) = β1iAllocatedIP Size + β2iW ebhostingIP Size
+ β3iDomainSize + β4iSharedHosting
+ β5iRuleof Law,
where the dependent variable – count of C&C domains –
follows a Poisson distribution with parameter λ ≥ 0 and βs
are the estimated coeﬃcients for the explanatory variables
collected for all the hosting providers. Subscript i refers to
measurements in diﬀerent hosting providers.
We construct several models using the variables in the
equation above, for the whole population of hosting provi-
ders. Our goal is both to maximize the amount of overall
explained variance of the model and to ﬁnd out which of
these variables inﬂuence the concentration of C&C abuse in
providers the most. The result of our regression models are
displayed in Table 3.
It is important to note that the reason for building more
than one model is to be able to compare goodness of ﬁt val-
ues while adding new variables to each model. Hence, to
asses how the models are performing in absolute terms and
relative to the other models, we use the Log-likelihood, AIC
579Table 3: Generalized Linear Regression Model (GLM) for the Population of Hosting Providers
Allocated IP space size
Webhosting IP space size
Domain name space size
Portion of Shared hosting business
Rule of Law
Constant
Observations
Log Likelihood
Akaike Inf. Crit.
Dispersion
Pseudo R2
Note:
Response Variable: Count of C&C domains
Poisson with Log Link Function
(1)
(2)
−0.991∗∗∗
(0.019)
2.725∗∗∗
(0.020)
(3)
−0.356∗∗∗
(0.020)
0.711∗∗∗
(0.027)
1.465∗∗∗
(0.014)
(4)
−0.358∗∗∗
(0.020)
0.868∗∗∗
(0.031)
1.301∗∗∗
(0.020)
0.009∗∗∗
(0.001)
−1.380∗∗∗
(0.009)
−5.058∗∗∗
(0.039)
−6.834∗∗∗
(0.049)
−7.319∗∗∗
(0.066)
(5)
−0.398∗∗∗
(0.020)
0.931∗∗∗
(0.032)
1.300∗∗∗
(0.021)
0.009∗∗∗
(0.001)
−0.213∗∗∗
(0.013)
−7.130∗∗∗
(0.068)
46,455
−50,777.110
101,556.200
45,358
−21,665.390
43,336.780
45,358
−15,485.920
30,979.840
45,358
−15,418.070
30,846.140
45,166
−15,253.920
30,519.850
46.62
11.049
0.587
9.296
0.717
9.641
0.719
10.328
0.722
∗p1. The pseudo R-squared [17] is likewise calculated for
our Poisson model given the dispersion parameter φ, using
the following formula :
R2 = 1 − D(y, ˆλ) + k · ˆφ
D(y, ¯Y )
,
(1)
where D(y, ˆλ) is the deviance of the ﬁtted model, D(y, ¯Y )
is the deviance of the intercept-only model, ˆφ is the esti-
mated dispersion parameter and k is the number of covari-
ates ﬁtted, (excluding intercept). By building several mod-
els, we aim to maximize the value of the pseudo R-squared
hence maximizing the amount of variance explain in C&C
abuse counts by the dependent variables.
By inspecting Table 3, model 1 is the intercept-only model
with count of C&C domains as dependent variables and no
dependent variable. In Model 2, we take into account the
size variables –‘Allocated IP space size’ and ‘Webhosting
IP space size’. The model indicates a signiﬁcant negative
relation between the variable ‘Allocated IP space size’ and
C&C abuse counts, while ‘Webhosting IP space size’ corre-
lates positively with C&C abuse counts. This is very much
expected as pointed out earlier in the paper, these two vari-
ables together determine to what extent the provider is using
its allocated IP space for web hosting services. In addition,
our manual inspection of the hosting data shows providers
with very large allocated IP space are normally not pure
hosting providers but rather broadband providers who use
a small portion of their IP space for hosting. Moreover,
the value of our goodness-of-ﬁt criteria shows that only by
adding these two size variables, we have substantially re-
duced the log-likelihood, AIC and dispersion values and are
able to explain approximately 58% of the variance in abuse
counts.
We build on model 2 by including additional variables,
namely ‘Size of the domain names space’ along with the
extent to which a provider is hosting its domains on shared
hosting services. Model 4 displays the estimated coeﬃcients.
The results indicate more domains in general and speciﬁcally
shared hosting domains relate signiﬁcantly with more C&C
abuse. To put the value of the coeﬃcients in perspective,
by holding all other values constant in the model, a unit
increase in the value of ‘Size of the domain names space’,
multiplies the number of C&Cs by e(1.300) = 3.7.
In addition to size variables analyzed in Models 1 to 4,