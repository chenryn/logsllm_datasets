we suggest to select the instantiation based on the output the
client needs and the classiﬁer information the server agrees to
reveal. If the client wants a ﬁne-grained output to analyze the
distribution of the different classes, then he may request to get
access not to the plurality-vote class, but to the selected class
of each tree. However, this will leak more information about
the underlying random forest model than disclosing only the
plurality-vote class.
IX. RELATED WORK
We ﬁrst summarize the two most closely related papers,
which report about the risk of identiﬁcation of DNA methy-
lation data. The ﬁrst (short) paper studying this risk shows
that part of the genotype (around 1,000 positions), as well
as alcohol consumption and smoking, can be inferred from
certain methylation data [43]. They warn that such genotype
inference could represent personally identifying information
but do not study further how genotypes could be matched
to methylation proﬁles, neither do they quantify with what
success such an attack could be carried out, and under which
conditions. Besides also identifying CpGs correlated with
genomic variants, Dyke et al. propose high-level guidelines
for methylation data disclosure that preserves privacy [9]. They
notably mention the restriction of access to methylation data
that are highly correlated with the genotype. Again, a concrete
970
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:20:45 UTC from IEEE Xplore.  Restrictions apply. 
scenario is missing in order to evaluate the extent of the threat
as well as the protection provided by their countermeasure.
In a similar vein as our approach, Schadt et al. propose
a Bayesian method to predict from and match genotypes to
RNA-expression proﬁles [44]. By using 1,000 eQTLs (ex-
pression quantitative trait locus), they were able to correctly
match RNA expression proﬁles and genotypes of more than
300 individuals. Furthermore, they simulated dataset of 300
million individuals and showed that the matching accuracy was
still as high as 97%. Franzosa et al. study whether individuals
possess microbial patterns that could be used to uniquely
identify them [45]. Their results demonstrate that more than
80% of individuals can still be uniquely identiﬁed among a
population of hundreds of individuals, up to one year later in
the case of the gut microbiome. Backes et al. also study how
microRNA expression proﬁles can be tracked over time [46].
They demonstrate that such data can be linked with a success
rate of 90%, and that success rates remain constant up to one-
year time shift between two proﬁles. They further propose
two countermeasures: one based on hiding part of microRNA
expressions, and the other based on probabilistic sanitization
of the microRNA expression proﬁles. Backes et al. further
show that microRNA-based datasets are prone to membership
inference attacks by relying on the average statistics of their
microRNA expression values [47].
Gymrek et al. show that genotypes can be re-identiﬁed by
querying genetic genealogy databases (containing surnames)
with short tandem repeats on the Y chromosome [21]. By
combining the inferred surnames with other types of metadata,
such as age and state, they are able to trace back with high suc-
cess the identitites of multiple contributors in public databases.
Humbert et al. show that single nucleotide polymorphisms
(SNPs), which are more commonly available online, can be
also exploited to infer various phenotypic traits, such as eye
color or blood type, in order to further re-identify anonymous
genotypes, by typically using side channels such as online
social networks [22]. Both these works clearly illustrate that,
once the genotype corresponding to a DNA methylation proﬁle
has been identiﬁed, it becomes relatively simple to recover the
real identity of the owner of this methylation proﬁle.
Finally, there have been several works on privacy-preserving
disease prediction by relying on encrypted genomic data.
Bost et al. develop three main private classiﬁcation protocols
(including decision trees) that protect both the patients’ data
and the classiﬁer model [23]. They prove their protocols to
be secure in the honest-but-curious adversarial model, and
evaluate its performance on real medical datasets. We build
upon their constructions for our own private random forest
classiﬁer. Duverle et al. propose a new protocol that enables to
privately compute statistical tests on patients’ data by relying
on exact logistic regression [48]. Their performance evaluation
shows that they can perform statistical tests with more than
600 SNPs across thousands of patients in several hours.
Ayday et al. have developed schemes for private disease
susceptibility tests by using homomorphic encryption and
proxy-encryption [24], [49]. The considered tests are based
on linear combinations of the SNPs (and other environmental
and clinial factors in [49]) contributing to a given disease, and
do not involve complex machine-learning classiﬁers. Danezis
and De Cristofaro improve upon the protocol of [24] by
using an alternative SNP encoding and make the patient-side
computation more efﬁcient [26]. McLaren et al. use a similar
security architecture as the one initially proposed by Ayday
et al. to develop a practical privacy-preserving scheme of
genome-based prediction of HIV-related outcomes [25]. All
these papers assume an honest-but-curious adversary, which
is considered as realistic in the healthcare environment.
X. CONCLUSION
In this work, we have ﬁrst demonstrated that DNA methy-
lation datasets can be re-identiﬁed by having access to an
auxiliary database of genotypes. Following a Bayesian ap-
proach, we have shown that we could reach an accuracy of
97.5% to 100% depending on the attack scenario, with a
few hundreds of methylation regions and genotype positions.
Then, by using a statistical test upon our matching outcomes,
we have empirically demonstrated that the very few wrongly
matched pairs could be correctly identiﬁed and rejected,
yielding a false-positive rate of 0 and true-positive rate of 1
for appropriate statistical thresholds. We have further shown
that our identiﬁcation attack was very robust to a decrease
of methylation-meQTL pairs. When matching 52 methylation
proﬁles with 75 genotypes, we could reach a full accuracy
with only 13 meQTLs and methylation regions. We have also
observed that, especially when the targeted genotype is present
in the genotype dataset, the very few wrongly matched pairs
contain the genotype of the relative (in more than 90% of the
cases). Finally, we have shown that our attack was robust to
an increase of the database size to more than 2500 genotypes.
Facing this severe threat to epigenetic privacy, we have
proposed a novel cryptographic scheme for privately classify-
ing tumors based on methylation data. Our protocol relies on
random forests and homomorphic encryption, and it is proven
secure in the honest-but-curious adversarial model. We have
implemented our private classiﬁer in C++ and evaluated its
performance on real data. We have shown that it can accurately
classify brain tumors in nine classes of tumor subtypes based
on 900 methylation levels in less than an hour. This consti-
tutes an acceptable computational overhead in the considered
clinical setting at hand. As a meta-consequence, we highly
recommend to remove DNA methylation proﬁles from public
databases as these are extremely prone to re-identiﬁcation,
especially given that genotypes are also increasingly available
online, sometimes with their owners’ identiﬁers [11].
As future work, we plan to study if the identiﬁcation
attack is as successful when meQTL-methylation pairs are
learned from a different tissue’s data. At the defense side,
we would like to study other machine-learning algorithms,
and to propose private schemes for those that are efﬁcient
in classiﬁcation with methylation data. Differentially private
approaches could also be studied, although differential privacy
may degrade utility too much for typical medical needs [50].
971
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:20:45 UTC from IEEE Xplore.  Restrictions apply. 
ACKNOWLEDGEMENTS
We would like to thank Jonas Schneider for his helpful
feedback on the security proofs. This work was supported
by the German Federal Ministry of Education and Research
(BMBF) through funding for the Center for IT-Security, Pri-
vacy and Accountability (CISPA) (FKZ: 16KIS0656) and by
the German Research Foundation (DFG) via the collaborative
research center Methods and Tools for Understanding and
Controlling Privacy (SFB 1223), project A5.
REFERENCES
precision
[1] “President
obama’s
medicine
https://www.whitehouse.gov/the-press-ofﬁce/2015/01/30/
fact-sheet-president-obama-s-precision-medicine-initiative,
2016-10-14.
initiative,”
accessed:
[2] Y. Erlich and A. Narayanan, “Routes for breaching and protecting
genetic privacy,” Nature Reviews Genetics, vol. 15, pp. 409–421, 2014.
[3] M. Humbert, E. Ayday, J.-P. Hubaux, and A. Telenti, “Addressing the
concerns of the Lacks family: quantiﬁcation of kin genomic privacy,”
in Proceedings of the 2013 ACM SIGSAC Conference on Computer and
Communications Security (CCS), 2013, pp. 1141–1152.
[4] “The growth of the gene expression omnibus,” https://plot.ly/∼sambucas/
34/the-growth-of-the-gene-expression-omnibus/, accessed: 2016-10-14.
[5] M. Esteller and J. G. Herman, “Cancer as an epigenetic disease: DNA
methylation and chromatin alterations in human tumours,” The Journal
of Pathology, vol. 196, no. 1, pp. 1–7, jan 2002.
[6] P. M. Das and R. Singal, “DNA methylation and cancer,” Journal of
clinical oncology, vol. 22, no. 22, pp. 4632–4642, 2004.
[7] B. Vogelstein, N. Papadopoulos, V. E. Velculescu, S. Zhou, L. A. Diaz,
and K. W. Kinzler, “Cancer genome landscapes,” Science, vol. 339, no.
6127, pp. 1546–1558, 2013.
[8] M. A. Rothstein, Y. Cai, and G. E. Marchant, “The ghost in our genes:
legal and ethical implications of epigenetics,” Health matrix (Cleveland,
Ohio: 1991), vol. 19, p. 1, 2009.
[9] S. O. Dyke, W. A. Cheung, Y. Joly, O. Ammerpohl, P. Lutsik, M. A.
Rothstein, M. Caron, S. Busche, G. Bourque, L. R¨onnblom et al.,
“Epigenome data release: a participant-centered approach to privacy
protection,” Genome biology, vol. 16, pp. 1–12, 2015.
[10] J. L. McClay, A. A. Shabalin, M. G. Dozmorov, D. E. Adkins, G. Kumar,
S. Nerella, S. L. Clark, S. E. Bergen, C. M. Hultman, P. K. E.
Magnusson, P. F. Sullivan, K. A. Aberg, and E. J. C. G. van den
Oord, “High density methylation QTL analysis in human blood via
next-generation sequencing of the methylated genomic DNA fraction,”
Genome Biology, vol. 16, no. 1, p. 291, 2015.
[11] “openSNP,” https://opensnp.org, accessed: 2016-11-05.
[12] P. a. Jones, “Functions of DNA methylation: islands, start sites, gene
bodies and beyond.” Nature reviews. Genetics, vol. 13, no. 7, pp. 484–
92, jul 2012.
[13] D. Sch¨ubeler, “Function and information content of DNA methylation,”
Nature, vol. 517, no. 7534, pp. 321–326, jan 2015.
[14] K. L. Sheaffer, R. Kim, R. Aoki, E. N. Elliott, J. Schug, L. Burger,
D. Schubeler, and K. H. Kaestner, “DNA methylation is required for
the control of stem cell differentiation in the small intestine,” Genes &
Development, vol. 28, no. 6, pp. 652–664, mar 2014.
[15] T. Bauer, S. Trump, N. Ishaque, L. Thu rmann, L. Gu, M. Bauer,
M. Bieg, Z. Gu, D. Weichenhan, J.-P. Mallm, S. Ro der, G. Herberth,
E. Takada, O. Mu cke, M. Winter, K. M. Junge, K. Gru tzmann, U. Rolle-
Kampczyk, Q. Wang, C. Lawerenz, M. Borte, T. Polte, M. Schlesner,
M. Schanne, S. Wiemann, C. Geo rg, H. G. Stunnenberg, C. Plass,
K. Rippe, J. Mizuguchi, C. Herrmann, R. Eils, and I. Lehmann,
“Environment-induced epigenetic reprogramming in genomic regulatory
elements in smoking mothers and their children,” Molecular Systems
Biology, vol. 12, no. 3, pp. 861–861, mar 2016.
[16] S. Trump, M. Bieg, Z. Gu, L. Th¨urmann, T. Bauer, M. Bauer, N. Ishaque,
S. R¨oder, L. Gu, G. Herberth, C. Lawerenz, M. Borte, M. Schlesner,
C. Plass, N. Diessl, M. Eszlinger, O. M¨ucke, H.-D. Elvers, D. K.
Wissenbach, M. von Bergen, C. Herrmann, D. Weichenhan, R. J. Wright,
I. Lehmann, and R. Eils, “Prenatal maternal stress and wheeze in
children: novel insights into epigenetic regulation,” Scientiﬁc Reports,
vol. 6, p. 28616, jun 2016.
[17] J. van Dongen, M. G. Nivard, G. Willemsen, J.-J. Hottenga, Q. Helmer,
C. V. Dolan, E. A. Ehli, G. E. Davies, M. van Iterson, C. E. Breeze,
S. Beck, P. A. Hoen, R. Pool, M. M. van Greevenbroek, C. D. Stehouwer,
C. J. van der Kallen, C. G. Schalkwijk, C. Wijmenga, S. Zhernakova,
E. F. Tigchelaar, M. Beekman, J. Deelen, D. van Heemst, J. H. Veldink,
L. H. van den Berg, C. M. van Duijn, B. A. Hofman, A. G. Uitterlinden,
P. M. Jhamai, M. Verbiest, M. Verkerk, R. van der Breggen, J. van Rooij,
N. Lakenberg, H. Mei, J. Bot, D. V. Zhernakova, P. van’t Hof, P. Deelen,
I. Nooren, M. Moed, M. Vermaat, R. Luijk, M. J. Bonder, F. van Dijk,
M. van Galen, W. Arindrarto, S. M. Kielbasa, M. A. Swertz, E. W.
van Zwet, A. Isaacs, L. Franke, H. E. Suchiman, R. Jansen, J. B. van
Meurs, B. T. Heijmans, P. E. Slagboom, and D. I. Boomsma, “Genetic
and environmental inﬂuences interact with age and sex in shaping the
human methylome,” Nature Communications, vol. 7, p. 11115, 2016.
[18] L. G. Tsaprouni, T.-P. Yang, J. Bell, K. J. Dick, S. Kanoni, J. Nisbet,
A. Vi˜nuela, E. Grundberg, C. P. Nelson, E. Meduri, A. Buil, F. Cambien,
C. Hengstenberg, J. Erdmann, H. Schunkert, A. H. Goodall, W. H.
Ouwehand, E. Dermitzakis, T. D. Spector, N. J. Samani, and P. Deloukas,
“Cigarette smoking reduces DNA methylation levels at multiple genomic
loci but the effect is partially reversible upon cessation,” Epigenetics, no.
December, pp. 00–00, oct 2014.
[19] A. L. Teh, H. Pan, L. Chen, M. L. Ong, S. Dogra, J. Wong, J. L.
MacIsaac, S. M. Mah, L. M. McEwen, S. M. Saw, K. M. Godfrey,
Y. S. Chong, K. Kwek, C. K. Kwoh, S. E. Soh, M. F. F. Chong,
S. Barton, N. Karnani, C. Y. Cheong, J. P. Buschdorf, W. St??nkel,
M. S. Kobor, M. J. Meaney, P. D. Gluckman, and J. D. Holbrook, “The
effect of genotype and in utero environment on interindividual variation
in neonate DNA methylomes,” Genome Research, vol. 24, no. 7, pp.
1064–1074, 2014.
[20] T. R. Gaunt, H. A. Shihab, G. Hemani, J. L. Min, G. Woodward,
O. Lyttleton, J. Zheng, A. Duggirala, W. L. McArdle, K. Ho, S. M.
Ring, D. M. Evans, G. Davey Smith, and C. L. Relton, “Systematic
identiﬁcation of genetic inﬂuences on methylation across the human
life course,” Genome Biology, vol. 17, no. 1, p. 61, 2016.
[21] M. Gymrek, A. L. McGuire, D. Golan, E. Halperin, and Y. Erlich,
“Identifying personal genomes by surname inference,” Science, vol. 339,
pp. 321–324, 2013.
[22] M. Humbert, K. Huguenin, J. Hugonot, E. Ayday, and J.-P. Hubaux, “De-
anonymizing genomic databases using phenotypic traits,” Proceedings
on Privacy Enhancing Technologies (PoPETs), 2015.
[23] R. Bost, R. A. Popa, S. Tu, and S. Goldwasser, “Machine learning
classiﬁcation over encrypted data,” in 22nd Network and Distributed
System Security Symposium (NDSS’ 15), 2015.
[24] E. Ayday, J. L. Raisaro, J.-P. Hubaux, and J. Rougemont, “Protecting and
evaluating genomic privacy in medical tests and personalized medicine,”
in Proceedings of the 12th ACM workshop on Workshop on privacy in
the electronic society. ACM, 2013, pp. 95–106.
[25] P. J. McLaren, J. L. Raisaro, M. Aouri, M. Rotger, E. Ayday, I. Bartha,
M. B. Delgado, Y. Vallet, H. F. G¨unthard, M. Cavassini et al., “Privacy-
preserving genomic testing in the clinic: a model using HIV treatment,”
Genetics in Medicine, 2016.
[26] G. Danezis and E. De Cristofaro, “Fast and private genomic testing for
disease susceptibility,” in Proceedings of the 13th Workshop on Privacy
in the Electronic Society. ACM, 2014, pp. 31–34.
[27] J. Edmonds, “Paths, trees, and ﬂowers,” Canadian Journal of Mathe-
matics, vol. 17, no. 3, pp. 449–467, 1965.
[28] Y. Liu, K. D. Siegmund, P. W. Laird, and B. P. Berman, “Bis-SNP:
Combined DNA methylation and SNP calling for Bisulﬁte-seq data,”
Genome Biology, vol. 13, no. 7, p. R61, 2012. [Online]. Available:
http://genomebiology.com/2012/13/7/R61
[29] C. Spearman, “The proof and measurement of association between two
things,” The American journal of psychology, vol. 15, no. 1, pp. 72–101,
1904.
[30] Y. Benjamini and Y. Hochberg, “Controlling the false discovery rate:
a practical and powerful approach to multiple testing,” Journal of the
royal statistical society. Series B (Methodological), pp. 289–300, 1995.
resource,” http://www.
international genome
[31] “Igsr: The
sample
internationalgenome.org/data, accessed: 2016-11-05.
[32] T. K. Ho, “Random decision forests,” in Document Analysis and
Recognition, 1995., Proceedings of the Third International Conference
on, vol. 1.
IEEE, 1995, pp. 278–282.
[33] J. Friedman, T. Hastie, and R. Tibshirani, The elements of statistical
learning. Springer series in statistics Springer, Berlin, 2001, vol. 1.
972
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:20:45 UTC from IEEE Xplore.  Restrictions apply. 
05.
[34] A. Danielsson, S. Nemes, M. Tisell, B. Lannering, C. Nordborg,
M. Sabel, and H. Car´en, “MethPed: a DNA methylation classiﬁer tool for
the identiﬁcation of pediatric brain tumor subtypes,” Clinical epigenetics,
vol. 7, no. 1, p. 1, 2015.
[35] “Sophia Genetics,” http://www.sophiagenetics.com/, accessed: 2016-11-
[36] S. Goldwasser and S. Micali, “Probabilistic encryption and how to play
mental poker keeping secret all private information,” in Proceedings 14th
ACM Symposium on the Theory of Computing, 1982.
[37] P. Paillier, “Public-key cryptosystems based on composite degree resid-
uosity classes,” in International Conference on the Theory and Applica-
tions of Cryptographic Techniques. Springer, 1999, pp. 223–238.
[38] Z. Brakerski, C. Gentry, and V. Vaikuntanathan, “Fully homomorphic
encryption without bootstrapping,” Cryptology ePrint Archive, Report