1
Attacking BaseStations
Hendrik Schmidt 
Brian Butterly 
2
Who we are
o
Old-school network geeks,
working as security researchers for
o
Germany based ERNW GmbH
o
Independent
o
Deep technical knowledge
o
Structured (assessment) approach
o
Business reasonable recommendations
o
We understand corporate
o
Blog: www.insinuator.net 
o
Conference: www.troopers.de
3
Motivation
o
The 4G standard introduces a lot of new technologies 
providing modern services to the customer.
o
This includes features as VoLTE, SON, ………..Trust 
and optional controls
o
BaseStations are the big (and small) antennas in the 
field
o
With our research we want to bring visibility to
o
How the environment works
o
What providers do
o
What vendors do
4
Introduction
From 2G to 4G Telecommunication Networks
5
4G Core
eUTRAN
UE
eNodeB
MME
PDN-GW
Serv-GW
HSS
IMS
S1-MME
S1-U
OSS
S1-MME
IP Network
6
Typical 
Environment?
Source: 
worldlte.blogspot.com
7
Typical 
Environment?
8
BaseStation Physical Setup
o Usually a closed/outdoor rack
o
Baseband Unit (BBU) (or multiple)
o
Power Distribution Unit (PDU)
o
Power Supply Unit (PSU)
o
Ventialation
o
Temperatur/ Humidity Sensors
o
Alarm Sensors
o Extra box with power connections
9
The Idea
1. Understand BaseStation Setup
2. Purchase an old BaseStation out of the field
3. Get BS running in an emulated environment
4. Perform an evaluation of configuration & 
security
10
What we need:
Basestation Physical Setup
o Base Band Unit (BBU)
o
Usually standing on the ground
o Remote Radio Head/Unit (RRH/RRU)
o
May be placed on the cell mast or on the ground
o Antenna
o
Come in various shapes and sizes
o
Nowadays often vector antennas
o All active parts are interconnected
o
BBU, RRU, sensors, power supply, vents
11
o Components run on -48V
o
Not +-48V (96V differential)
o
Basically just 48V connected 
the other way round
o Basically receives raw RF 
signals via Fiber and sends 
them out via Copper
o
Towards the antenna
o Usually capable of serving a 
specific frequency band
Power Supply
RRU
12
o Frame for holding power unit 
and functional blades
o Sometimes have a backplane 
for interconnection between 
components
o
Arbitrary PCB connectors
o
Multiple interfaces (LAN, 
UART, Arbitrary, CAN)
o
Functional blades decide the 
network type
o
Ericsson: DUL/DUW/DUG -> Digitial
Unit LTE/WCDMA/GSM
o
Slots for multiple blades
o
Single BBU could serve GSM and 
WCDMA
o
Depends highly on specific BBU and 
blade combination
o
Single blade can serve multiple 
cells
o
Using sector antennas a single mast 
could i.e. serve 4 cells in 4 different 
directions
Most important Unit: the BBU
13
Variants of an eNodeB
o Come in different shapes and sizes.
o
Rack, “Small-Boxes“, Portable
o Different types for different size cells.
o
Macro (>100m), Micro (100m), Pico (20-50m), 
HeNB (10-20m)
o
(WiFi/WiMax)
o Termination Point for Encryption
o
RF channel encryption
o
Backend channel encryption
14
Implementing a Lab
Just a Quick HowTo
15
How to Start…
o Purchasing a BTS is not easy, you have to be
aware of the architecture
o Searching for „eNodeB“ is not working very well
because every vendor has its own architecture, 
boards, and naming
o Some helpful words:
o
Nokia - FlexiBTS
o
Huawei – BBU + LMPT/UMPT
o
Ericsson – RBS + DUL
o
ALU – MBS
16
Ebay 
17
Lab Setup – What You Need
o A Basestation
o
The RRU is optional if you just want to play with 
the BTS itself
o Power Supply
o
-48V ~ 5A will be sufficient
o Power Connectors
o
Good luck ;-)
o
The devices sometimes have strange plugs, so 
you might need some time to find or make 
them
18
Lab Setup – What You Need
o Proper switch
o
Depending on the model and configuration the 
backhaul interface will be using multiple 
VLANs (signaling, configuration)
o Stack of network cables
o A Box/VM
o
Be prepared to set up multiple IP addresses
o
Virtual interfaces with VLANs
o
NTP server
19
20
Our Lab 
21
o
GPS
o
For timing or positioning (during setup)
o
EC
o
Connection to power unit
o
AUX
o
For clustering multiple units
o
LMT A
o
Local maintenance terminal A
o
LMT B
o
Local maintenance terminal B
o
TN A
o
Backhaul Access – S1
o IDL
o
Currently unknown
o TN B
o
Backhaul Access – S1
o A, B, C, D, E, F
o
Interfaces towards RRU
Ericsson RBS6601 - DUL
RJ-45 & Gbic Interfaces
22
The First Sniff 
23
Let‘s get Started!
o We had to emulate Signalling and O&M 
Connection
o
Vlan 3: Signalling
o
Vlan 2: O&M
o You see a lot of traffic, the eNB is designed to
operate almost as standalone
 Not that many modifications needed
24
The Second Sniff
25
The Transport Interface
Build Your Own Provider Network
26
S1-Interface
o After the host 10.27.99.169 on VLAN 2 
becomes available the eNodeB activates 
communication over the S1-Interface
o Using SCTP it tried to reach 7 different hosts 
by SCTP INIT request to establish a 
connection
27
S1-Interface
o S1 interface is divided into two parts