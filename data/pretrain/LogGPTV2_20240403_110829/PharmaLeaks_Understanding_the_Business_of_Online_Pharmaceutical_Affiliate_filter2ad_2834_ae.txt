RX-Promotion and GlavMed/SpamIt. Overall, the net
revenue for this period—the proﬁt returned to the afﬁl-
iate program owners—is just 16.3% of gross revenue.
This value is not uniform from month to month, how-
ever. For example, during the period when processing
for controlled drugs was lost, RX-Promotion simultane-
ously lost revenue, incurred large ﬁnes, and had to pay
greater average commissions (since the commissions for
controlled drugs were discounted 10%) leading to a net
13
loss for at least one month. By contrast, during the very
best month (September) net revenue exceeds 30%.
We do not have equivalent
indirect cost data for
GlavMed or SpamIt, but we are able to infer a subset
of these overheads. The operators used a special afﬁliate
(affiliate id value 20) to manage the working capital
of each. The Afﬁliate 20 account received referral com-
missions from all afﬁliates who did not have a referring
afﬁliate designated explicitly. During the measurement
period, Afﬁliate 20 earned $2.7M. Operating expendi-
tures, as well as some afﬁliate payouts, were deducted
from this account.
Starting May 2009, the comment ﬁeld of each pay-
out began including a short description of the payment.
A payment for a banner advertisement (recruiting afﬁli-
ates), for example, would be listed as described as “ban-
ner GM - gofuckbiz.com”. Although free-form, the com-
ment text typically used a small number of phrases. Us-
ing a manually generated list of regular expressions, we
identiﬁed several indirect costs during the period from
May 2009 to April 2010. These costs include marketing
($153K, 0.2% of revenue), domain purchasing ($511K,
0.8% of revenue) and servers/hosting ($247K, 0.4% of
revenue). Interestingly, it appears that marketing and
servers/hosting are similar costs between the two pro-
grams (suggesting they are largely ﬁxed costs) but do-
main purchasing appears to track revenue (presumably
since greater advertising volume requires more domain
turnover due to blacklisting).
Finally, we also have anecdotal data in the form of
chat logs between the lead operator and the owner of
GlavMed/SpamIt. These logs state that overall net rev-
enue ﬂuctuated between 10% and 20%, agreeing struc-
turally with the RX-Promotion data.
Thus, we believe that 10–20% is likely to reﬂect a typ-
ical net revenue for successful pharmaceutical programs.
While this is smaller on an earnings-per-sale basis than
the commissions awarded to individual afﬁliates, it is
a more proﬁtable enterprise when the afﬁliate program
is successful. For example, the largest SpamIt afﬁliate
might make $2M in a year, but in that same year the pro-
gram itself is likely to clear over $10M in proﬁt.
5.3.3 Markup
After commissions, supply costs for the programs are
one of the largest expenses. Using the categories from
Figure 2, ED contains by far the most popular products
purchased, and also has the highest markups of more than
15 to 20 times the supply cost. The average markup of
Viagra in GlavMed and SpamIt, for instance, translates
to a customer price 25 times cost. Markups in the Abuse
and Chronic categories are considerably smaller, ranging
between 5–8 times supply cost. Interestingly, the ship-
ping cost is a loss leader for GlavMed/SpamIt since they
charge a ﬂat fee per order (orders with more than one
item result in supplier shipping costs higher than col-
lected shipping fees) and offer free shipping for orders
over $200. In fact, for the orders for which we have ﬁne-
grained product and shipping cost data, the supplier costs
of delivering the drugs (8.5M) actually exceeded the costs
of the drugs delivered.
5.4 Payment Processing
Finally, afﬁliate programs must arrange for reliable pro-
cessing of customer payments. In a sense, obtaining re-
liable payment processing services may be the most im-
portant function of the afﬁliate program, since it is the
only mechanism by which all other efforts can be mone-
tized. Previously, our group identiﬁed that a small num-
ber of banks were critical to virtually all online pharma-
ceutical sales [14]. However, the means by which those
banks were accessed has never been well documented.
In fact, in the “high-risk” payment market, merchant
processing is frequently handled by independent Pay-
ment Service Providers (PSPs) who manage the rela-
tionships with acquiring banks and provide Web-based
payment gateway services to clients.17 While users of
these services may have a contractual relationship with
the bank, in other cases PSPs may “front” their own
merchant accounts on behalf of their clients (a form of
identity laundering called “factoring” and typically dis-
allowed by card association rules). Merchants in turn can
mitigate some of their own risk by working with multi-
ple providers; this strategy not only provides redundancy,
but each provider may place limits on transaction vol-
umes (e.g., to ﬁt within the underwriting risk limits on
their overall merchant portfolio) and may have different
services they are willing to offer (e.g., MC, Visa, Amex,
eCheck, etc.) for different product categories (e.g., herbal
vs. prescription vs. controlled drugs).
In the case of RX-Promotion the afﬁliate program en-
joyed a partnership with a large ISO/PSP and thus this
entity handled virtually all of their processing needs.
GlavMed and SpamIt, by contrast, did not work with
any single provider, but no less that twenty-one distinct
providers over the lifetime of our data sets. However,
these providers differ considerably in what services they
are used for, the volume of transactions they are able to
handle and how long-lived they are. In fact, almost half
of these providers are never used to process signiﬁcant
transaction volumes (mostly likely due to risk controls).
Illustrating this point, Figure 10 graphs the transaction
volume of GlavMed/SpamIt handled by different pay-
ment service providers over time. The y-axis identiﬁes
17We use the term “payment service provider” here in a generic
sense, and the organizations involved may be some combination of
proper PSPs, account brokers, merchant servicers, ISO/MSPs with
third-party servicers, etc.
14
also reﬂects a supply issue as well. For reasons not en-
tirely clear, it has traditionally been far easier for online
pharmaceutical programs to obtain payment processing
services for Visa than for MasterCard or Amex. Indeed,
we ﬁnd that during periods in which MasterCard pro-
cessing was available, Visa/MasterCard revenue percent-
ages stabilized at around 63%/30%, respectively, for both
GlavMed and SpamIt.
Second, a relatively small number of payment service
providers dominate the transaction volume (in particu-
lar GL, LT and LV). Together these three providers are
responsible for 84% of all revenue for GlavMed and
SpamIt. Many of the other providers are active for very
short lifetimes, and with very low volumes, before they
are either abandoned or, more typically, they are unwill-
ing to continue business with the program operators.
Finally, there are also clear patterns indicative of prob-
lems with particular providers over time. For example,
for each terminal a sudden drop in volume and rise in
declines is typically a precursor to that terminal being
abandoned. Some of these cases clearly reﬂect changes
in long-term business relationships: in March of 2008,
for instance, there is a clear transition moving the largest
volume of Visa processing between LV and LT; similarly,
American Express processing moves from AFF to SN
during the same period. In the last ﬁve months of 2010
it appears that GlavMed/SpamIt experienced signiﬁcant
setbacks in processing capability, with LT processing
only minor volumes (forcing them to push a higher vol-
ume of transactions through GL). These ﬁndings provide
additional support and context for our previous ﬁndings
that the ﬁnancial aspect of the counterfeit pharmaceutical
ecosystem is among the most fragile components [14].
6 Conclusion
This paper provides an unprecedented view inside the
economics of modern pharmaceutical afﬁliate programs:
an enterprise that ultimately capitalizes a wide array
of infrastructure services including botnets, malware,
bullet-proof hosting and so on. Among the results of
this work, we have shown that the customer market
is large and far from fully tapped, with repeat orders
playing a key role in mature programs. We have also
seen that a small number of big afﬁliates can dominate
the revenue equation and that disrupting these partic-
ular afﬁliates would have disproportionate damage on
the whole program. Finally, even very large programs
such as GlavMed/SpamIt depend on a handful of pay-
ment service providers to reliably monetize their activ-
ities, reinforcing the observation that ﬁnancial services
are a “weak point” in the value chain. Surprisingly, while
afﬁliate programs can drive substantial sales, their costs
are signiﬁcant and ultimately net revenues are modest,
15
Figure 10: Payment transactions over time by payment service
provider. The colored volume of each circle corresponds to the
transaction volume in a month for a particular terminal (color
being used to indicate payment method). Terminals are grouped
by providers and the grey penumbra around each circle is pro-
portional to the number of declined transactions for that termi-
nal in the same period.
the top nine providers (using a designator taken directly
from the database or an abbreviation thereof) while the
remaining providers are aggregated together under the
ellipsis. Each circle in the graph represents the number
of transactions processed via a particular terminal in a
month, with terminals belonging to a particular provider
grouped together based on time of ﬁrst use.18 In any
given circle, the color red indicates MasterCard transac-
tions, blue is for Visa, yellow for other credit cards (pri-
marily Amex), and green for eCheck. Finally, the volume
of the grey penumbra around each circle indicates the
number of transactions that were declined on a terminal.
There are a number of striking observations one can
draw from this ﬁgure. First is the clear dominance of
Visa processing. Aggregating across both GlavMed and
SpamIt, Visa transactions represent almost 67% of all
revenue, followed by MasterCard with 23% and Amer-
ican Express with 6% (with the remainder concentrated
in eCheck transactions through the ACH system). While
part of this discrepancy is likely due to demand—Visa
is the most popular payment card brand—this difference
18A terminal is effectively an interface point for sending payment
transactions, corresponding to a particular merchant account. Note that
while some terminals are for general purpose use, others service a par-
ticular function such as providing a compatible base currency (e.g., the
terminal named “lt-euro-visa” provides European Visa transactions) or
handling rebills (e.g., “gl-rebill-m”).
typically under just 20% of sales. This ﬁnding again sug-
gests that such organizations are fragile to economic dis-
ruptions of even a modest scale.
Acknowledgments
We would like to thank the various anonymous providers
of our data sets, without which there would have been
no paper. We have also beneﬁted heavily from the many
members of the cyber-investigations community who
have provided us valuable insight as we have tried to
map data onto meaning. Closer to home, we would like
to thank Erin Kenneally for her ongoing legal guidance
and ethical oversight, as well as the technical support of
Brian Kantor and Cindy Moore who have managed our
systems and storage needs.
This work was supported in part by National Sci-
ence Foundation grants NSF-0433668, NSF-0433702,
NSF-0831138 and CNS-0905631, by the Ofﬁce of Naval
Research MURI grant N000140911081, and by gener-
ous research, operational and/or in-kind support from
Google, Microsoft, Yahoo, Cisco, HP and the UCSD
Center for Networked Systems (CNS).
References
[1] D. S. Anderson, C. Fleizach, S. Savage, and G. M.
Spamscatter: Characterizing Internet Scam
In Proc. of 16th USENIX Secu-
Voelker.
Hosting Infrastructure.
rity, 2007.
[2] Behind Online Pharma. From Mumbai to Riga to New
York: Our Investigative Class Follows the Trail of Illegal
Pharma. http://behindonlinepharma.com, 2009.
[3] J. Caballero, C. Grier, C. Kreibich, and V. Paxson. Mea-
suring Pay-per-Install: The Commoditization of Malware
Distribution. In Proc. of 20th USENIX Security, 2011.
[4] C. Grier, K. Thomas, V. Paxson, and M. Zhang. @spam:
The Underground on 140 Characters or Less. In Proc. of
17th ACM CCS, 2010.
[5] C. Herley and D. Florˆencio. Nobody Sells Gold for the
Price of Silver: Dishonesty, Uncertainty and the Under-
ground Economy. In Proc. of 8th WEIS, 2009.
[6] J. P. John, A. Moshchuk, S. D. Gribble, and A. Krishna-
murthy. Studying Spamming Botnets Using Botlab. In
Proc. of 6th NSDI, 2009.
[7] J. P. John, F. Yu, Y. Xie, A. Krishnamurthy, and M. Abadi.
deSEO: Combating Search-Result Poisoning. In Proc. of
20th USENIX Security, 2011.
[8] C. Kanich, C. Kreibich, K. Levchenko, B. Enright, G. M.
Voelker, V. Paxson, and S. Savage. Spamalytics: An Em-
pirical Analysis of Spam Marketing Conversion. In Proc.
of 15th ACM CCS, 2008.
[9] C. Kanich, N. Weaver, D. McCoy, T. Halvorson,
C. Kreibich, K. Levchenko, V. Paxson, G. M. Voelker, and
S. Savage. Show Me the Money: Characterizing Spam-
advertised Revenue. In Proc. of 20th USENIX Security,
2011.
16
[10] B. Krebs.
Exposed.
krebsonsecurity.com/category/pharma-wars/,
2011.
SpamIt, Glavmed Pharmacy Networks
Krebs on Security Blog, http://www.
[11] LegitScript and KnujOn. No Prescription Required:
http://www.
Bing.com Prescription Drug Ads.
legitscript.com/download/BingRxReport.pdf,
2009.
[12] LegitScript and KnujOn.
Yahoo!
Internet Phar-
http://www.legitscript.
macy Advertisements.
com/download/YahooRxAnalysis.pdf, 2009.
[13] N. Leontiadis, T. Moore, and N. Christin. Measuring and
Analyzing Search-Redirection Attacks in the Illicit On-
line Prescription Drug Trade. In Proc. 20th USENIX Se-
curity, 2011.
[14] K. Levchenko, N. Chachra, B. Enright, M. Felegyhazi,
C. Grier, T. Halvorson, C. Kanich, C. Kreibich, H. Liu,
D. McCoy, A. Pitsillidis, N. Weaver, V. Paxson, G. M.
Voelker, and S. Savage. Click Trajectories: End-to-End
Analysis of the Spam Value Chain. In Proc. of 32nd IEEE
Security and Privacy, 2011.
[15] H. Liu, K. Levchenko, M. F´elegyh´azi, C. Kreibich,
G. Maier, G. M. Voelker, and S. Savage. On the Effects
of Registrar-level Intervention. In Proc. of 4th USENIX
LEET, 2011.
[16] B. S. McWilliams.
Spam Kings: The Real Story Be-
hind the High-Rolling Hucksters Pushing Porn, Pills and
@*#?% Enlargements. O’Reilly Media, Sept. 2004.
[17] A. Ramachandran and N. Feamster. Understanding the
In Proceedings
Network-Level Behavior of Spammers.
of ACM SIGCOMM, Pisa, Italy, Sept. 2006.
[18] D. Samosseiko. The Partnerka — What is it, and why
should you care? In Proc. of Virus Bulletin Conference,
2009.
[19] Y. Shin, M. Gupta, and S. Myers. The Nuts and Bolts of a
Forum Spam Automator. In Proc. of 4th USENIX LEET,
2011.
[20] B. Stone-Gross, R. Abman, R. Kemmerer, C. Kruegel,
D. Steigerwald, and G. Vigna. The Underground Econ-
omy of Fake Antivirus Software. In Proc. of 10th WEIS,
2011.
[21] Symantec. MessageLabs June 2010 Intelligence Re-
port. http://www.symanteccloud.com/mlireport/
MLI_2010_06_June_FINAL.pdf.
[22] K. Thomas, C. Grier, V. Paxson, and D. Song. Suspended
Accounts In Retrospect: An Analysis of Twitter Spam. In
Proc. of 11th IMC, 2011.
[23] D. Wang, S. Savage, and G. M. Voelker. Cloak and Dag-
ger: Dynamics of Web Search Cloaking. In Proc. of 18th
CCS, 2011.
[24] Y.-M. Wang, M. Ma, Y. Niu, and H. Chen. Spam Double-
Funnel: Connecting Web Spammers with Advertisers. In
Proc. of 16th WWW, 2007.
[25] G. Wondracek, T. Holz, C. Platzer, E. Kirda, and
C. Kruegel. Is the Internet for Porn? An Insight into the
Online Adult Industry. In Proc. of 9th WEIS, 2010.