own if the forwarder is unable to satisfy the request. 
A name server using a forwarder in exclusive mode does the following when attempting to resolve a 
name: 
1. Checks its local cache. 
2. Checks its zone files. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 230 
3. Sends a recursive query to a forwarder. 
Caching-Only Name Servers 
Although all DNS servers cache queries that they have resolved, caching-only servers are DNS servers 
that only perform queries, cache the answers, and return the results. Caching-only servers are not 
authoritative for any domains and contain only the information that they have cached while attempting 
to resolve queries.  
When caching-only servers are started, they do not perform any zone transfers because they have no 
zones and no entries exist in their caches. Initially, the caching-only server must forward queries until 
the cache has been built up to a point where it can service commonly used queries by just using its 
cache entries. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 231 
Resource Records and Zones  
If your organization is connected to the Internet, in many cases you do not need to maintain a DNS 
infrastructure. For small networks, DNS name resolution is simpler and more efficient by having the 
DNS client query a DNS server that is maintained by an ISP. Most ISPs will maintain domain 
information for a fee. If your organization wants to have control over its domain or not incur the costs of 
using an ISP, you can set up your organization's own DNS servers.  
In both cases, either going through an ISP or setting up separate DNS servers, the IANA must be 
informed of the domain name of the organization and the IP addresses of at least two DNS servers on 
the Internet that service the domain. An organization can also set up DNS servers within itself 
independent of the Internet.  
At least two computers as DNS servers are recommended for reliability and redundancy—a primary 
and a secondary name server. The primary name server maintains the database of information, which 
is then replicated from the primary name server to the secondary name server. This replication allows 
name queries to be serviced even if one of the name servers is unavailable. Replication is scheduled 
based on how often names change in the domain. Replication should be frequent enough so that 
changes are reflected on both servers. However, excessive replication can have a negative impact on 
the performance of the network and name servers. 
Resource Record Format 
Resource records have the following format: 
owner TTL 
type 
class 
RDATA 
owner  The domain name of the resource record. 
TTL (Time to Live) The length of time in seconds that a DNS resolver should wait before it removes 
from its cache an entry that corresponds to the resource record. 
type  The type of resource record. 
class  The protocol family in use, which is typically IN for the Internet class. 
RDATA  The resource data for the resource record type. For example, for an address (A) resource 
record, RDATA is the 32-bit IPv4 address that corresponds to the FQDN in the owner field. 
Resource records are represented in binary form in DNS request and response messages. In text-
based DNS database files, most resource records are represented as a single line of text. For 
readability, blank lines and comments are often inserted in the database files and are ignored by the 
DNS server. Comments always start with a semicolon (;) and end with a carriage return.  
The following is an example A resource record stored in a DNS database file: 
srv1.dev.microsoft.com.   3600   A    IN    157.60.221.205 
Each resource record starts with the owner in the first column (srv1.dev.microsoft.com.). If the first 
column is blank, then it is assumed that the owner for this record is the owner of the previous record. 
The owner is followed by the TTL (3600 seconds = 1 hour), type (A = Address record), class (IN = 
Internet), and then the RDATA (Resource Data = 157.60.221.205). If the TTL value is not present, the 
DNS server sets the value to the TTL specified in the SOA (Start of Authority) record of the zone. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 232 
Resource Record Types 
The DNS standards define many types of resource records. The most commonly used resource records 
are the following:  
SOA  Identifies the start of a zone of authority. Every zone contains an SOA resource record at the 
beginning of the zone file, which stores information about the zone, configures replication behavior, and 
sets the default TTL for names in the zone. 
A  Maps an FQDN to an IPv4 address. 
AAAA  Maps an FQDN to an IPv6 address. 
NS  Indicates the servers that are authoritative for a zone. NS records indicate primary and secondary 
servers for the zone specified in the SOA resource record, and they indicate the servers for any 
delegated zones. Every zone must contain at least one NS record at the zone root. 
PTR  Maps an IP address to an FQDN for reverse lookups. 
CNAME  Specifies an alias (synonymous name). 
MX  Specifies a mail exchange server for a DNS domain name. A mail exchange server is a host that 
receives mail for the DNS domain name. 
SRV  Specifies the IP addresses of servers for a specific service, protocol, and DNS domain. 
RFCs 1035, 1034, 1183, and others define less frequently used resource records. The DNS Server 
service in Windows Server 2008 and Windows Server 2003 is fully compliant with RFCs 1034, 1035, 
and 1183. 
The DNS Server service in Windows Server 2008 and Windows Server 2003 also supports the 
following resource record types that are Microsoft-specific:  
WINS  Indicates the IPv4 address of a Windows Internet Name Service (WINS) server for WINS 
forward lookup. The DNS Server service in Windows Server 2003 can use a WINS server for looking up 
the host portion of a DNS name. 
WINS-R  Indicates the use of WINS reverse lookup, in which a DNS server uses a NetBIOS Adapter 
Status message to find the host portion of the DNS name given its IPv4 address. 
For detailed information about the structure and contents of various types of DNS resource records, see 
Help and Support for Windows Server 2008 and Windows Server 2003. 
Delegation and Glue Records 
You add delegation and glue records to a zone file to indicate the delegation of a subdomain to a 
separate zone. For example, in Figure 8-2, the DNS server that is authoritative for the microsoft.com 
zone must be configured so that, when resolving names for the dev.microsoft.com, the DNS server can 
determine the following: 
That a separate zone for that domain exists. 
A delegation is an NS record in the parent zone that lists the name server that is authoritative for 
the delegated zone. 
Where the zone for that domain resides. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 233 
A glue record is an A record for the name server that is authoritative for the delegated zone.  
For example, in Figure 8-2, the name server for the microsoft.com. domain has delegated authority for 
the dev.microsoft.com zone to the name server devdns.dev.microsoft.com at the IPv4 address of 
157.60.41.59. In the zone file for the microsoft.com. zone, the following records must be added: 
dev.microsoft.com.          IN      NS   devdns.dev.microsoft.com. 
devdns.dev.microsoft.com.   IN      A    157.60.41.59 
Without the delegation record for dev.microsoft.com, queries for all names ending in dev.microsoft.com 
would fail. Glue records are needed when the name of the name server that is authoritative for the 
delegated zone is in the domain of the name server attempting name resolution. In the example above, 
we need the A record for devdns.dev.microsoft.com. because that FQDN is within the microsoft.com. 
portion of the DNS namespace. Without this A record, the microsoft.com. DNS server would be unable 
to locate the name server for the dev.microsoft.com. zone, and all name resolutions for names in the 
dev.microsoft.com domain would fail. A glue record is not needed when the name of the authoritative 
name server for the delegated zone is in a domain that is different than the domain of the zone file. In 
this case, the DNS server would use normal iterative queries to resolve the name to an IP address. 
The DNS Server service in Windows Server 2008 and Windows Server 2003 automatically adds 
delegation and glue records when you delegate a subdomain. 
The Root Hints File 
The root hints file, also known as the cache file, contains the names and addresses of root name 
servers. For resolving domain names on the Internet, the default file provided with the DNS Server 
service in Windows Server 2008 and Windows Server 2003 has the records for the root servers of the 
Internet. For installations not connected to the Internet, the file should be replaced to contain the name 
servers authoritative for the root of the private network. This file is named Cache.dns and is stored in 
the systemroot/System32/Dns folder. 
For the current Internet cache file, see the FTP site for InterNIC. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 234 
Zone Transfers 
Secondary name servers obtain zone files from a master name server using a zone transfer. The zone 
transfer replicates the set of records in the zone file from the master server to the secondary server. 
Zone transfers occur for all zones for which a DNS server is a secondary name server upon startup and 
on an ongoing basis to ensure that the most current information about the zone is reflected in the local 
zone file. The two types of zone transfers are full and incremental. 
Full Zone Transfer 
The original DNS RFCs defined zone transfers as a transfer of the entire zone file, regardless of how 
the file has changed since the last time it was transferred. In a full zone transfer, the following process 
occurs: 
1. The secondary server waits until the next refresh time (as specified in the SOA resource record) and 
then queries the master server for the SOA resource record for the zone.  
2. The master server responds with the SOA resource record.  
3. The secondary server checks the Serial Number field of the returned SOA resource record. If the 
serial number in the SOA resource record is higher than the serial number of the SOA resource 
record of the locally stored zone file, then there have been changes to the zone file on the master 
server and a zone transfer is needed. Whenever a resource record is changed on the master name 
server, the serial number in the SOA resource record is updated. 
The secondary server sends an AXFR request (a request for a full zone transfer) to the master 
server. 
4. The secondary server initiates a TCP connection with the master server and requests all of the 
records in the zone database. After the zone transfer, the Serial Number field in the SOA record of 
the local zone file matches the Serial Number field in the SOA record of the master server. 
Figure 8-7 shows a full zone transfer. 
Figure 8-7  A full zone transfer 
If the secondary server does not receive a response to the SOA query, it retries SOA queries using a 
retry time interval specified in the SOA resource record in the local zone file. The secondary server 
continues to retry until the time elapsed since attempting to perform a zone transfer reaches an 
expiration time specified in the SOA resource record in the local zone file. After the expiration time, the 
secondary server closes the zone file and does not use it to answer subsequent queries. The 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 235 
secondary server keeps attempting to perform the zone transfer. When the zone transfer succeeds, the 
local zone file is opened and used for subsequent queries. 
Incremental Zone Transfer 
In a full zone transfer, the entire zone file is transferred. This can consume a substantial portion of 
processing resources and network bandwidth when the zone files are large and when zone records are 
frequently changed. To minimize the amount of information that is sent in a zone transfer for changes to 
zone records, RFC 1995 specifies a standard method of performing incremental zone transfers. In an 
incremental zone transfer, only the resource records that have changed (been added, deleted, or 
modified) are sent during the zone transfer. 
In an incremental zone transfer, the secondary server performs the same query for the SOA record of 
the master server and comparison of the Serial Number field. If changes exist, the secondary server 
sends an IXFR request (a request for an incremental zone transfer) to the master server. The master 
server sends the records that have changed, and the secondary server builds a new zone file from the 
records that have not changed and the records in the incremental zone transfer. 
Figure 8-8 shows an incremental zone transfer. 
Figure 8-8  An incremental zone transfer 
For the master server to determine the records that have changed, it must maintain a history database 
of changes made to its zone files. The zone file changes are linked to a serial number so that the 
master server can determine which changes were made to the zone past the serial number indicated in 
the IXFR request from the secondary server. 
The DNS Server service in Windows Server 2008 and Windows Server 2003 supports incremental 
zone transfer. 
DNS Notify 
For both full and incremental zone transfers, the secondary server always initiates the zone transfer 
based on periodically querying the master server for its SOA record. The original DNS RFCs do not 
define a notification mechanism if the master server wanted to immediately propagate a large number 
of changes to its secondary servers. 
To improve the consistency of data among secondary servers, RFC 1996 specifies DNS Notify, an 
extension of DNS that allows master servers to send notifications to secondary servers that a zone 
transfer might be needed. Upon receipt of a DNS notification, secondary servers request the SOA 
record of their master server and initiate a full or incremental zone transfer as needed. 
Figure 8-9 shows the DNS notify process. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 236 
Figure 8-9  The DNS notify process 
To determine the secondary servers to which notifications should be sent, the master server maintains 
a notify list (a list of IP addresses) for each zone. The master server sends notifications to only the 
servers in the notify list when the zone is updated. 
The DNS Server service in Windows Server 2008 and Windows Server 2003 supports the configuration 
of a notify list (a list of IPv4 addresses) for each zone. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 237 
DNS Dynamic Update 
DNS was originally defined as a name resolution scheme for relatively static names and addresses; 
DNS records contained information about servers, whose name and address configuration did not 
change often. Therefore, the manual administration of resource records in zone files was manageable. 
These original assumptions work well for an environment that is based on server and client computers 
that are statically configured, in which the client computers communicate only with the server 
computers and address configuration does not change. With the advent of peer-to-peer 
communications and applications and the Dynamic Host Configuration Protocol (DHCP), both of the 
assumptions of static DNS are challenged. In a Windows-based environment, client computers often 
communicate directly with each other and are automatically configured using DHCP. To communicate 
with each other, client computers must be able to resolve each other's names; therefore they must have 
corresponding DNS resource records. With DHCP, the address configuration of client computers could 
change every time they start. Manually administering DNS records for this environment is obviously 
impractical. 
Therefore, RFC 2136 defines DNS dynamic update to provide an automated method to populate the 
DNS namespace with the current names and addresses for client and server computers by dynamically 
updating zone data on a zone's primary server. With DNS dynamic update, DNS records are 
automatically created, modified, and removed by either host computers or DHCP servers on their 
behalf. For example, a client computer that supports DNS dynamic update sends UPDATE messages 
to its DNS server to automatically add A, AAAA, and PTR records. The DNS server, which must also 
support DNS dynamic update, verifies that the sender is permitted to make the updates and then 
updates its local zone files. 
The DNS Client service in Windows Vista, Windows XP, Windows Server 2008, and Windows Server 
2003 and the DNS Server service in Windows Server 2008 and Windows Server 2003 support DNS 
dynamic update. 
Chapter 8 – Domain Name System Overview 
TCP/IP Fundamentals for Microsoft Windows  
Page: 238 
Chapter Summary 
The chapter includes the following pieces of key information: 
DNS is a namespace and a protocol for replicating databases and resolving FQDNs used on the 
Internet and intranets. DNS consists of the domain namespace, name servers that store resource 
records, and DNS resolvers. 
A domain is a branch of the DNS namespace beginning at its root node. All of the resource records in a 
domain are stored in zones on DNS servers. A zone is a contiguous portion of a DNS domain whose 
information is stored in a file on a DNS server. 
On the Internet, DNS consists of the root domain, top-level domains, and second-level domains. IANA 
manages the names and DNS servers of the root domain and the top-level domains. Individual 
organizations are responsible for managing the names in their second-level domains. 
DNS resolvers use either recursive or iterative queries. A recursive query is used to request definitive 
information about a name, and DNS clients typically use them for FQDN resolution. An iterative query is 
used to request best-effort information about a name, and DNS servers typically use them to query 
other DNS servers.  
Forward lookups provide an IP address based on an FQDN. Reverse lookups provide an FQDN based 
on an IP address. 
DNS servers can have the role of a primary server (in which the records are modified by the DNS 
administrator) or a secondary server (in which the records are obtained from another server) for each 
zone for which they are authoritative. A master server is a server from which a secondary server 
obtains a zone transfer. 
DNS defines many types of resource records, the most common of which are SOA, A, AAAA, NS, PTR, 
CNAME, MX, and SRV.  
Zone transfers can transfer either the entire zone file (known as a full zone transfer) or just the records 
that have changed (known as an incremental zone transfer). DNS Notify is a standard mechanism by 
which a master name server notifies secondary name servers to check for changes in zone files. 
DNS dynamic update is a standard method for hosts, or DHCP servers on behalf of hosts, to 
automatically update the zones of primary DNS servers with resource records that correspond to 