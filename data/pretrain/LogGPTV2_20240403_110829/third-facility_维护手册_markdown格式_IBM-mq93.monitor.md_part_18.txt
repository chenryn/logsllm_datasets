1.Visit “Queue accounting message data” on page 167 for an explanation of the attributes
“ApplicationName” on page 169 and “ConnectionId” on page 168 as you selected accounting for
the Type parameter in the amqsmon command.
In each case, look for the attribute Identifier.
The Identifier for ApplicationName is MQCACF_APPL_NAME, and for ConnectionId is
MQBACF_CONNECTION_ID
2.Search for the identifiers you found in Step “1” on page 152.
Go to the Constants section and scroll down until you find the MQCACF_* (Command format Character
Parameter Types) list. Locate MQCACF_APPL_NAME and you see the value 3024.
Similarly, find the MQBACF_* (Command format Byte Parameter Types)list. Locate
MQBACF_CONNECTION_ID and you see the value 7006.
Finding the mapping for AvgTimeOnQ (703) and QmaxDepth (739)
Use this topic to explain how the variables used in the example are found for monitoring statistics data.
Summary:
• 703 means MQIAMO64_AVG_Q_TIME which is the AvgTimeOnQ
• 739 means MQIAMO_Q_MAX_DEPTH which is the QMaxDepth
To find out the mapping you need to carry out two procedures:
1.Visit “Queue statistics message data” on page 190 for an explanation of the attributes “AvgTimeOnQ”
on page 193 and “QMaxDepth” on page 193 as you selected statistics for the Type parameter in the
amqsmon command.
In each case, look for the attribute Identifier.
The Identifier for AvgTimeOnQ is MQIAMO64_AVG_Q_TIME and for . QMaxDepth is
MQIAMO_Q_MAX_DEPTH.
2.Search for the identifiers you found in Step “1” on page 152.
Go to the Constants section and scroll down until you find the MQIAMO_* (Command format Integer
Monitoring Parameter Types) list. Locate MQIAMO_Q_MAX_DEPTH and you see the value 739.
Similarly, find the MQIAMO64_* (Command format 64-bit Integer Monitoring Parameter Types) list.
Locate MQIAMO64_AVG_Q_TIME and you see the value 703.
Accounting and statistics message reference
Use this page to obtain an overview of the format of accounting and statistics messages and the
information returned in these messages
Accounting and statistics message messages are standard IBM MQ messages containing a message
descriptor and message data. The message data contains information about the MQI operations
performed by IBM MQ applications, or information about the activities occurring in an IBM MQ system.
152 Monitoring and Performance for IBM MQ
Message descriptor
• An MQMD structure
Message data
• A PCF header (MQCFH)
• Accounting or statistics message data that is always returned
• Accounting or statistics message data that is returned if available
IBM MQ Monitoring and performance 153
Accounting and statistics message format
Use this page as an example of the structure of an MQI accounting message
Table 23. MQI accounting message structure
MQMD structure Accounting message header MQI accounting message data 1
MQCFH structure
Structure identifier Structure type Queue manager
Structure version Structure length Interval start date
Report options Structure version Interval start time
Message type Command identifier Interval end date
Expiration time Message sequence number Interval end time
Feedback code Control options Command level
Encoding Completion code Connection identifier
Coded character set ID Reason code Sequence number
Message format Parameter count Application name
Message priority Application process identifier
Persistence Application thread identifier
Message identifier User identifier
Correlation identifier Connection date
Backout count Connection time
Reply-to queue Connection name
Reply-to queue manager Channel name
User identifier Disconnect date
Accounting token Disconnect time
Application identity data Disconnect type
Application type Open count
Application name Open fail count
Put date Close count
Put time Close fail count
Application origin data Put count
Group identifier Put fail count
Message sequence number Put1 count
Offset Put1 fail count
Message flags Put bytes
Original length Get count
Get fail count
Get bytes
Browse count
Browse fail count
Browse bytes
Commit count
Commit fail count
Backout count
Inquire count
Inquire fail count
Set count
Set fail count
Note:
1.The parameters shown are those returned for an MQI accounting message. The actual accounting or
statistics message data depends on the message category.
154 Monitoring and Performance for IBM MQ
Accounting and statistics message MQMD (message descriptor)
Use this page to understand the differences between the message descriptor of accounting and statistics
messages and the message descriptor of event messages
The parameters and values in the message descriptor of accounting and statistics message are the same
as in the message descriptor of event messages, with the following exception:
Format
Description: Format name of message data.
Data type: MQCHAR8.
Value: MQFMT_ADMIN
Admin message.
Some of the parameters contained in the message descriptor of accounting and statistics message
contain fixed data supplied by the queue manager that generated the message.
The MQMD also specifies the name of the queue manager (truncated to 28 characters) that put the
message, and the date and time when the message was put on the accounting, or statistics, queue.
Message data in accounting and statistics messages
The message data in accounting and statistics messages is based on the programmable command format
(PCF), which is used in PCF command inquiries and responses. The message data in accounting and
statistics messages consists of a PCF header (MQCFH) and an accounting or statistics report.
Accounting and statistics message MQCFH (PCF header)
The message header of accounting and statistics messages is an MQCFH structure. The parameters and
values in the message header of accounting and statistics message are the same as in the message
header of event messages, with the following exceptions:
Command
Description: Command identifier. This identifies the accounting or statistics message
category.
Data type: MQLONG.
Values: MQCMD_ACCOUNTING_MQI
MQI accounting message.
MQCMD_ACCOUNTING_Q
Queue accounting message.
MQCMD_STATISTICS_MQI
MQI statistics message.
MQCMD_STATISTICS_Q
Queue statistics message.
MQCMD_STATISTICS_CHANNEL
Channel statistics message.
Version
Description: Structure version number.
Data type: MQLONG.
Value: MQCFH_VERSION_3
Version-3 for accounting and statistics messages.
IBM MQ Monitoring and performance 155
Accounting and statistics message data
The content of accounting and statistics message data is dependent on the category of the accounting or
statistics message, as follows:
MQI accounting message
MQI accounting message data consists of a number of PCF parameters, but no PCF groups.
Queue accounting message
Queue accounting message data consists of a number of PCF parameters, and in the range 1 through
100 QAccountingData PCF groups.
MQI statistics message
MQI statistics message data consists of a number of PCF parameters, but no PCF groups.
Queue statistics message
Queue statistics message data consists of a number of PCF parameters, and in the range 1 through
100 QStatisticsData PCF groups.
Channel statistics message
Channel statistics message data consists of a number of PCF parameters, and in the range 1 through
100 ChlStatisticsData PCF groups.
MQI accounting message data
Use this page to view the structure of an MQI accounting message
Message name: MQI accounting message.
Platforms: All, except IBM MQ for z/OS.
System queue: SYSTEM.ADMIN.ACCOUNTING.QUEUE.
QueueManager
Description: The name of the queue manager
Identifier: MQCA_Q_MGR_NAME
Data type: MQCFST
Maximum length: MQ_Q_MGR_NAME_LENGTH
Returned: Always
IntervalStartDate
Description: The date of the start of the monitoring period
Identifier: MQCAMO_START_DATE
Data type: MQCFST
Maximum length: MQ_DATE_LENGTH
Returned: Always
IntervalStartTime
Description: The time of the start of the monitoring period
Identifier: MQCAMO_START_TIME
Data type: MQCFST
Maximum length: MQ_TIME_LENGTH
Returned: Always
156 Monitoring and Performance for IBM MQ
IntervalEndDate
Description: The date of the end of the monitoring period
Identifier: MQCAMO_END_DATE
Data type: MQCFST
Maximum length: MQ_DATE_LENGTH
Returned: Always
IntervalEndTime
Description: The time of the end of the monitoring period
Identifier: MQCAMO_END_TIME
Data type: MQCFST
Maximum length: MQ_TIME_LENGTH
Returned: Always
CommandLevel
Description: The queue manager command level
Identifier: MQIA_COMMAND_LEVEL
Data type: MQCFIN
Returned: Always
ConnectionId
Description: The connection identifier for the IBM MQ connection
Identifier: MQBACF_CONNECTION_ID
Data type: MQCFBS
Maximum length: MQ_CONNECTION_ID_LENGTH
Returned: Always
SeqNumber
Description: The sequence number. This value is incremented for each subsequent record for
long running connections.
Identifier: MQIACF_SEQUENCE_NUMBER
Data type: MQCFIN
Returned: Always
ApplicationName
Description: The name of the application. The contents of this field are equivalent to the
contents of the PutApplName field in the message descriptor.
Identifier: MQCACF_APPL_NAME
Data type: MQCFST
Maximum length: MQ_APPL_NAME_LENGTH
Returned: Always
IBM MQ Monitoring and performance 157
ApplicationPid
Description: The operating system process identifier of the application
Identifier: MQIACF_PROCESS_ID
Data type: MQCFIN
Returned: Always
ApplicationTid
Description: The IBM MQ thread identifier of the connection in the application
Identifier: MQIACF_THREAD_ID
Data type: MQCFIN
Returned: Always
UserId
Description: The user identifier context of the application
Identifier: MQCACF_USER_IDENTIFIER
Data type: MQCFST
Maximum length: MQ_USER_ID_LENGTH
Returned: Always
ConnDate
Description: Date of MQCONN operation
Identifier: MQCAMO_CONN_DATE
Data type: MQCFST
Maximum length: MQ_TIME_LENGTH
Returned: When available
ConnTime
Description: Time of MQCONN operation
Identifier: MQCAMO_CONN_TIME
Data type: MQCFST
Maximum length: MQ_TIME_LENGTH
Returned: When available
ConnName
Description: Connection name for client connection
Identifier: MQCACH_CONNECTION_NAME
Data type: MQCFST
Maximum length: MQ_CONN_NAME_LENGTH
Returned: When available
158 Monitoring and Performance for IBM MQ
ChannelName
Description: Channel name for client connection
Identifier: MQCACH_CHANNEL_NAME
Data type: MQCFST
Maximum length: MQ_CHANNEL_NAME_LENGTH
Returned: When available
RemoteProduct
Description: Remote product identifier for client connection as displayed in the RPRODUCT
field of DISPLAY CHSATUS
Identifier: MQCACH_REMOTE_PRODUCT
Data type: MQCFST
Maximum length: MQ_REMOTE_PRODUCT_LENGTH
Returned: When available
RemoteVersion
Description: Remote product version for client connection as displayed in the RVERSION
field of DISPLAY CHSTATUS
Identifier: MQCACH_REMOTE_VERSION
Data type: MQCFST
Maximum length: MQ_REMOTE_VERSION_LENGTH
Returned: When available
DiscDate
Description: Date of MQDISC operation
Identifier: MQCAMO_DISC_DATE
Data type: MQCFST
Maximum length: MQ_DATE_LENGTH
Returned: When available
DiscTime
Description: Time of MQDISC operation
Identifier: MQCAMO_DISC_TIME
Data type: MQCFST
Maximum length: MQ_TIME_LENGTH
Returned: When available
DiscType
Description: Type of disconnect
Identifier: MQIAMO_DISC_TYPE
Data type: MQCFIN
IBM MQ Monitoring and performance 159
Values: The possible values are:
MQDISCONNECT_NORMAL
Requested by application
MQDISCONNECT_IMPLICIT
Abnormal application termination
MQDISCONNECT_Q_MGR
Connection broken by queue manager
Returned: When available
OpenCount
Description: The number of objects successfully opened, either by directly issuing a call to
MQOPEN or by using the MQPUT1 verb. This parameter is an integer list indexed
by object type, see Reference note 1.
Identifier: MQIAMO_OPENS
Data type: MQCFIL
Returned: When available
OpenFailCount
Description: The number of unsuccessful attempts to open an object. This parameter is an
integer list indexed by object type, see Reference note 1.
Identifier: MQIAMO_OPENS_FAILED
Data type: MQCFIL
Returned: When available
CloseCount
Description: The number of objects closed. This parameter is an integer list indexed by
object type, see Reference note 1.
Identifier: MQIAMO_CLOSES
Data type: MQCFIL
Returned: When available
CloseFailCount
Description: The number of unsuccessful attempts to close an object. This parameter is an
integer list indexed by object type, see Reference note 1.
Identifier: MQIAMO_CLOSES_FAILED
Data type: MQCFIL
Returned: When available
PutCount
Description: The number persistent and nonpersistent messages successfully put to a queue,
with the exception of messages put using the MQPUT1 call. This parameter is an
integer list indexed by persistence value, see Reference note 2.
Identifier: MQIAMO_PUTS
Data type: MQCFIL
160 Monitoring and Performance for IBM MQ
Returned: When available
PutFailCount
Description: The number of unsuccessful attempts to put a message
Identifier: MQIAMO_PUTS_FAILED
Data type: MQCFIN
Returned: When available
Put1Count
Description: The number of persistent and nonpersistent messages successfully put to
the queue using MQPUT1 calls. This parameter is an integer list indexed by
persistence value, see Reference note 2.
Identifier: MQIAMO_PUT1S
Data type: MQCFIL
Included in PCF QAccountingData
group:
Returned: When available
Put1FailCount
Description: The number of unsuccessful attempts to put a message using MQPUT1 calls
Identifier: MQIAMO_PUT1S_FAILED
Data type: MQCFIN
Included in PCF QAccountingData
group:
Returned: When available
PutBytes
Description: The number bytes written using put calls for persistent and nonpersistent
messages. This parameter is an integer list indexed by persistence value, see
Reference note 2.
Identifier: MQIAMO64_PUT_BYTES
Data type: MQCFIL64
Returned: When available
GetCount
Description: The number of successful destructive MQGET calls for persistent and
nonpersistent messages. This parameter is an integer list indexed by
persistence value, see Reference note 2.
Identifier: MQIAMO_GETS
Data type: MQCFIL