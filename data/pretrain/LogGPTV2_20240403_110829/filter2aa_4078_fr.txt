基线通常在有限的时间内建立起来， 例如一个星期。 如果网络被修改， 基线需要更新。 否则，
入侵检测系统可能会提醒存在异常活动 ， 但其实是正常的。 一些产品继续监测网络， 以 了解更多 的
正 常活动 ， 并且会根据监测更新基线 。
503
504
CISSP 官方学 习 指南(第 7 版)
基于行为的入侵检测系统使用基线 、 活动数据、 启发式评估技术将当前活动同先前活动进行比
较 ， 以检测潜在恶意事件。 许多可以执行状态包分析， 这类似于通过状态检测防火墙(第 1 1 章中有
相关介绍)检测基于网络流量的状态。
正常的分析能够使入侵检测系统识别下列情况， 并作出相应反应。 具体情况有: 流量及活动的
激增 ， 多 次失败的登录尝试， 在正常工作时间 以外的登录或程序活动， 或突然增加的错误或失败信
息 。 所有这些都代表发生 了 以知 识为基础 的检测系统所无法识别 的攻击。
基于行为的入侵检测系统可以被认为是专家系统或伪人工智能系统， 因为它可以学习井对事件
做出假设。 换言之， 入侵检测系统可以像人类专家一样， 能够通过己知事件对当前事件进行评估。
基于行为的入侵检测系统的正常活动和事件的信息越多 ， 检测到异常情况的概率就会越高。 不同于
基于签名 的检测， 基于行为的入侵检测系统的一个明显好处是可以不使用签名 ， 便能检测到新的
攻击。
基于行为的入侵检测系统的主要缺点是， 往往会发起大量的假警报， 也被称为虚假警报或误报。
在正常操作过程中 ， 用户和系统活动的模式可能会有很大的不同， 使得难以准确地定义正常和异常
活动的边界。
@ 真实场景
虚假警报
许多 入侵检测 系 统管理员 面临的一个挑战是在入侵检测 系统发送的牵制吴警报或警报的数量之间
找到一个平衡点 ， 以确保入侵检测报告的真实性。 在我们所了 解的一个组织 中 ， 其入侵检测 系 统在
几天内发出 了 一系列警告， 调查后发现是虚假警报。 管理员 对 系统失去信心， 后悔在这些虚假警报
上浪费 了 时 间 。
之后， 入侵检测 系统在发生真实攻击时发送了 报告。 然而， 管理员 正在积极解决另 一个他们认
为是真实攻击的 问题， 所以并没有花时间去检查他们认为 的假警报。 管理员 只是简单地驳回 了 入侵
检测 系 统的警报， 直到 几天之后 才发现攻击发生 了 。
2. IOS 晌应
虽然基于知识和基于行为的入侵检测系统使用的方法不同 ， 但是它们都使用警报系统。 当入侵
检测系统检测到事件时 ， 便会触发报警。 然后， 可 以使用被动或主动的方法做出响应。 被动响应是
指系统记录事件并发送通知。主动响应是指系统通过改变环境来阻止活动而不是做记录和发送通知。
注意 :
在某些情况下 ， 可以在防火墙的前后各放直一个被动式入侵检测 系 统， 以检查防火墙的有效性。
通过检查两个 IDS 警报， 使能确定被防火墙阻挡的攻击类型 而 不是仅仅确定正在进行的攻击类型。
被动响应 系统能够通过电子邮件、 文本、 寻呼消息或弹出消息的方式将信息发送给管理员 。
在某些情况下 ， 如有必要， 警报可以生成一份报告， 详细说明事件和 日 志活动 ， 可 为管理员提供更
多的信息。 许多 24 小时的网络运营中心(NOC)都有中央监控屏幕， 主要支持中心的所有人员都能看
到 。 例如， 一面墙上有多个大屏幕 ， 实时监测井显示 NOC 中 的不同网络元素数据。 IDS 警报会显
示在一个屏幕上， 以确保工作人员及时了解事件。 这些即时通知帮助管理员'快速有效地对未知行为
第 1 7 章 事件预防和晌应
做出响应 。
主动响应 主动响应可以使用几种不同的方法来修改环境。 典型的一些回应有通过修改 ACL
以 阻止基于端 口 、 协议和源地址的流量输出 ， 甚至可以禁用某段电缆上的所有通信。 例如， 如果 IDS
检测到来自某- IP 地址的 SYN 泛洪攻击， IDS 可 以通过改变 ACL 以阻止来自该 E 地址的所有流
量输入。 同样， 如果 IDS 检测到来 自 多个E地址的 pmg泛洪攻击，可以改变 ACL 以阻止所有的 IC扎。
流量输入。 入侵检测系统也可以阻止可疑或非法用户 的资源访问。 安全管理员事先对这些活动配置
合适的响应方式， 并可 以根据环境的变化做出调整。
注意 :
使用 主动响应方式的 IDS， 通常被称为 IPS(入侵防种系 统)。 在某些情况下， 这样说是准确的 。
然而， IPS(在本节后面介绍)应与 系 统流量相一致。 如果某个主动 IDS 与 系 统流量相一致， 它就是 IPS。
如果不一致， 就不能称之为 IPS， 因 为 它只有在进程中检测到攻击之后才能做出反应 。 NIST SP 800-94
建议将所有主动 IDS 与 系 统一起安装， 以使它们 能发挥 IPS 功能。
3 主机型和网络型 IDS
IDS 一般根据信息来源进行分类。 目 前主要有两类 IDS: 主机型与网络型。 主机型 IDS(HIDS)
监视单个计算机或主机上的可疑活动， 网络型 IDS例IDS)则监视在网络介质上进行的可疑活动。
基于应用程序的入侵检测系统很少使用 ， 它是一种特定类型的基于网络的入侵检测系统。 它监
视两个或多个服务器之间 的特定应用程序流量。 例如， 基于应用程序的入侵检测系统可以监视 Web
服务器和数据库服务器之间 的流量， 以寻找可疑活动 。
主机型 IDS HIDS 监视单个计算机上的活动 ， 包括过程调用和 日 志， 这些 日 志记录在系统、
应用 、 安全和基于主机的防火墙中 。 它检测的事件比 NIDS 更详细， 并且可以在攻击中找到特定的
文件， 同 时还可以跟踪攻击者采用 的进程 。
HIDS 优于 NIDS， 是因为它可以检测到主机系统上的异常。 例如， 回DS 能够检测到攻击者进
入系统并进行远程监控的感染点。 你可能会注意到， 这听起来类似于电脑上的反恶意软件， 确实是
这样。 许多 皿DS 都拥有反恶意软件的能力 。
虽然很多厂商建议在所有系统中安装基于主机的 IDS， 但该行为仍不常见， 因 为 HIDS 也有缺
点 。 相反， 许多组织选择在关键的服务器上安装 HIDS 作为附加保护。 HIDS 的缺点是费用和相关的
可用性。 HIDS 比 NIDS 更昂贵， 因 为它们需要对每个系统进行监视， 而 NIDS 通常支持集中式管理。
HIDS 不能检测到其他系统的网络攻击。 此外， 它还将消耗大量的系统资源， 降低主机系统的性能。
虽然限制 团DS 所使用的系统资源也是可以做到的 ， 但这样通常会导致对一次活跃攻击的遗漏检测。
此外 ， 四DS 更容易被攻击者发现， 并且 日 志将会保存在系统中， 这更方便入侵者修 改 日 志 。
网络型IDS NIDS监测井评估网络活动来检测攻击事件或异常。 它不能检测加密流量的内容，
但可以监测其他数据包的信息。 NIDS系统通过使用远程传感器来收集关键网络位置的数据， 以监测
大型网络。 在关键网络位置能够将数据发送到中央管理控制台， 这些传感器可以监视路由器、 防火
墙 、 支持端 口 镜像的网络交换机和其他类型的网络端口流量 。
提示 :
交换机JÆ.常手阳有于阻止恶意嗅探。 如果 IDS 被连接到 交换机上一个正常的端 口 ， 它将只捕获网
络流量的一小部分， 这样就不会产生太大作用 。 相反， 交换斗M皮配直到能够监测 IDS 上特定端 口 的
505
506
CISSP 官方学 习指南(第 7 版)
所有流量(通常被称为端 口 镜像)。 在忠、科交换机上 ， 用 于端 口 镜像的端 口 被称为 交换端 口 分析器
(Switched Port Analyzer， SPAN)端 口 。
中 央控制台通常被安装在单一用途的计算机上， 以防止攻击。 这减少了 NlDS 漏洞， 并可以让
它的运行透明， 使得攻击者难以发现井做出 攻击。 网络型入侵检测系统对网络整体性能的负面影响
很小， 当它被安装在单一的系统上时， 不会对其他任何计算机的性能产生不利影响。 在犬流量的网
络中， NIDS 可能无法跟上数据流量， 但可 以 添加额外的系统以平衡负载。
通常情况下， 网络型入侵检测系统可以通过反向地址解析协议攻击源(瓦忧的或反向域名系统
(DNS)查找攻击源。 然而， 攻击者往往使用虚拟 E 地址或僵尸网络发起攻击， 这需要做更深入的调
查 以确定攻击源。 该过程很困难， 并且己经超出 了 入侵检测系统的检测范围。 然而， 可 以通过一些
调查手段找到虚假 IP 源 。
警告 :
对入侵者发起反击或试图反黑客入侵是不道德的 ， 也是有风险的 。 相反， 可以依靠 日 志记录和
嗅探收集功 能 ， 来收集足够的数据以起诉 罪 犯或 改善环境安全。
NlDS 通常能够检测到攻击或将要进行的攻击， 但它们往往不能提供有关攻击成功的信息。 如
果攻击感染了特定的系统、 用户账户 、 文件或应用程序， NIDS 就不会检测到。 例如， NlDS 可能会
发现通过网络发迭的缓冲区溢出攻击， 但不一定了解该攻击是否成功感染了系统。 然而， 管理员 收
到警报后， 他们会检查相关的系统。 此外， 调查人员可以将 NlDS 日 志作为审计线索的一部分以 了
解入侵 防御系统中发生的攻击。
4. 入侵防御系统
入侵防御系统(IPS)是一种特殊类型的主动入侵检测系统， 能够在攻击到达目 标系统之前进行检
测并阻止攻击， 有时也被称为入侵检测和防御系统(IDPS)。 两者之间最主要的区别就是 IPS 同流量
保持一致， 如 图 1 7.4 所示。 换句话说， 所有流量必须通过 IPS， IPS 可 以在分析之后选择将流量通
过或阻止。 这使得 IPS 能够阻止攻击到达 目 标。
互31一才 品 | 内 部
网络
相反， 与流量不一致的 IDS 只 有在攻击到达 目标之后才能检测到。 主动 IDS 能够在攻击开始之
后采取措施阻止攻击 ， 但不能预防攻击。
就像其他的 IDS 一样， IPS 可 以使用基于知识的检测矛W或基于行为的检测。 此外 ， 可 以记录活
动 ， 并像 IDS 一样给管理员发 出 警报 。
5. 理解黑暗网络
在入侵检测环境中 ， 黑暗网络使用 己分配的、 不使用 的 E 地址网络空间 的一部分， 包括一台 己
配置的、 为捕获所有进入黑暗网络的流量的设备 。 由于 E 地址没有被使用 ， 黑暗网络没有任何其他
主机并且也应该根本没有任何流量。 但是， 如果正在探测网络的攻击者或恶意软件正在试图扩散，
那么黑暗网络中 的主机将会探测和捕捉到这项活动。 这样的好处是很少有误报信息。 合法流量不会
第 1 7 章 事件预防军日响应
出 现在黑暗 网络中， 除非有网络配置错误， 否 则 出 现在黑暗网络中 的流量是不合法的 。
1 7.2.4 特殊的防御措施
虽然入侵检测和防御系统对于保护网络需要走很长的路， 但是管理员通常可以使用额外的安全
控制措施来保护他们的网络。 以 下部分描述了其中几个额外的预防措施。
1 . 蜜罐/蜜网
蜜罐通过创建独立的计算机作为陷阱来捕获入侵者。 可通过两个或多个联网蜜罐一起来模拟网
络。 它们看起来像是合法的系统， 但它们对于攻击者不存放任何真实的有价值的数据。 管理员通常
配置带有漏洞的蜜罐 ， 诱使入侵者攻击他们。 它们可能是未打的补丁或管理员有意打开的安全漏洞。
目 标是抓住入侵者的注意力， 井使入侵者远离保存有价值资源的合法网络。 合法用户 无法访 问蜜罐，
因 此对蜜罐的任何访 问 都很可能是未授权的入侵者。
除了使攻击者远离生产环境之外， 蜜罐也为管理员提供 了机会， 使他们在不破坏真实环境的情