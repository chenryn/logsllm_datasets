式：不提交表单、需要手工确认、使用默认值自动填写三种方式。 不提交表单的含义是
抓取时候不提交表单数据，这个非常好理解；需要手工确认是指当抓取表单时，弹出界
面，让渗透测试人员自己手工确认表单数据；使用默认值自动填写是对表单的内容，使
用下方的各个配置项进行匹配（匹配时可以使用完全匹配和正则表达式匹配两种方式其
一），默认填写这些值，然后自动进行提交。其界面如下图所示：
58
第六章 如何使用Burp Spider
从上图我们可以看出，对于表单的输入域我们可以添加和修改以满足实际情况的需要，
如果还有其他的属性输入域我们不想每一个都录入，可以勾选“设置不匹配的属性值”，统
一指定输入的值。如图中的PI:EMAIL
应用登陆（Application Login） 此选择项主要用来控制抓取时，登陆页面的处理方式。
选择项依次是：不提交登陆信
息、手工确认登陆信息、作为普通表单处理（如果选择此项，则把登陆表单的form当作
其他表单一样处理，对于登陆表单将使用"表单提交设置" 中的具体配置）、自动提交登
陆（选择此项，需要在下方的输入框中指定用户名和密码）
蜘蛛引擎设置（Spider Engine)和HTTP 消息头设置（Requests Header）
59
第六章 如何使用Burp Spider
其中蜘蛛引擎设置主要是用来控制蜘蛛抓取的线程数、网络失败时重试的次数、重试暂
停间隙等，而HTTP 消息头设置是用来设置Http请求的消息头自定义，比如说，我们可以
编辑消息头信息，可以指定请求为移动设备，或者不同的手机型号，或者指定为Safari浏
览器，指定HTTP协议版本为1.1、使用referer等。
60
第七章 如何使用Burp Scanner
第七章 如何使用Burp Scanner
Burp Scanner的功能主要是用来自动检测web系统的各种漏洞，我们可以使用Burp Scanner
代替我们手工去对系统进行普通漏洞类型的渗透测试，从而能使得我们把更多的精力放在那
些必须要人工去验证的漏洞上。
在使用Burp Scanner之前，我们除了要正确配置Burp Proxy并设置浏览器代理外，还需要在
Burp Target的站点地图中存在需要扫描的域和URL模块路径。如下图所示：
当Burp Target的站点地图中存在这些域或URL路径时，我们才能对指定的域或者URL进行全
扫描或者分支扫描。下面我们就来整体的学习一下，一次完整的Burp Scanner使用大概需要
哪些步骤。
本章的主要内容有：
Burp Scanner基本使用步骤
Burp Scanner扫描方式
Burp Scanner扫描报告
Burp Scanner扫描控制
Burp Scanner可选项设置
Burp Scanner基本使用步骤
Burp Scanner基本使用主要分为以下15个步骤，在实际使用中可能会有所改变，但大体的环
节主要就是下面的这些。 1.确认Burp Suite正常启动并完成浏览器代理的配置。 2.进入Burp
Proxy，关闭代理拦截功能，快速的浏览需要扫描的域或者URL模块。 3.当我们浏览时，默认
情况下，Burp Scanner会扫描通过代理服务的请求，并对请求的消息进行分析来辨别是非存
在系统漏洞。同时，当我们打开Burp Target时，也会在站点地图中显示请求的URL树。
61
第七章 如何使用Burp Scanner
Burp Scanner基本使用主要分为以下15个步骤，在实际使用中可能会有所改变，但大体的环
节主要就是下面的这些。 1.确认Burp Suite正常启动并完成浏览器代理的配置。 2.进入Burp
Proxy，关闭代理拦截功能，快速的浏览需要扫描的域或者URL模块。 3.当我们浏览时，默认
情况下，Burp Scanner会扫描通过代理服务的请求，并对请求的消息进行分析来辨别是非存
在系统漏洞。同时，当我们打开Burp Target时，也会在站点地图中显示请求的URL树。
62
第七章 如何使用Burp Scanner
4.我们可以有针对性的选择Burp Target站点地图下的某个节点上链接URL上，弹出右击菜
单，进行Active Scan。然后在弹出的确认框中，点击【YES】即进行扫描整个域。
6.这时，我们打开Burp Scanner 选项卡，在队列子选项卡中，会看到当前扫描的进度。如果
我们双击URL，则弹出扫描结果的提示信息。
7.如果我们在Burp Target站点地图下选择某个子目录进行扫描，则会弹出更优化的扫描选
项，我们可以对选项进行设置，指定哪些类型的文件不再扫描范围之内。
63
第七章 如何使用Burp Scanner
8.当我们再次返回到Burp Scanner 选项卡界面时，选择的子目录已经开始在扫描中，其扫描
的进度依赖于需要扫描内容的多少。 9.如果我们没有定义了目标作用域（Target Scope），
最简单的方式就是在Burp Target站点地图上右击弹出菜单中添加到作用域，然后自动进行扫
描。
10.然后进入Burp Scanner的Live scanning子选项卡，在Live Active Scanning控制块中，选择
Use suite scope，这样，Burp Scanner将自动扫描经过Burp Proxy的交互信息。
11.当我们再次使用浏览器对需要测试的系统进行浏览时，Burp Scanner不会发送额外的请求
信息，自动在浏览的交互信息的基础上，完成对请求消息的漏洞分析。 12.此时，当我再返回
64
第七章 如何使用Burp Scanner
到Burp Target站点地图界面，将提示系统可能存在的漏洞情况，以及处理这些漏洞的建议。
13.同时，我们也可以在漏洞提示的请求信息上，将消息发送到Burp Repeater模块，对漏洞进
行分析和验证。
14.随着Burp Scanner扫描的进度，在Burp Target站点地图界面上的issues模块中的漏洞信息
也会不断的更新。 15.当Burp Scanner扫描完成之后，我们在Burp Target站点地图的选择链
接右击，依次选择issues-->report issues for this host 即可导出漏洞报告。
65
第七章 如何使用Burp Scanner
Burp Scanner扫描方式
通过以上的操作步骤我们可以学习到，Burp Scanner扫描方式主要有两种：主动扫描和被动
扫描
主动扫描（Active Scanning）
当使用主动扫描模式时，Burp 会向应用发送新的请求并通过payload验证漏洞。这种模式下的
操作，会产生大量的请求和应答数据，直接影响系统的性能，通常使用在非生产环境。它对
下列的两类漏洞有很好的扫描效果：
1. 客户端的漏洞，像XSS、Http头注入、操作重定向；
2. 服务端的漏洞，像SQL注入、命令行注入、文件遍历。
对于第一类漏洞，Burp在检测时，会提交一下input域，然后根据应答的数据进行解析。在检
测过程中，Burp会对基础的请求信息进行修改，即根据漏洞的特征对参数进行修改，模拟人
的行为，以达到检测漏洞的目的。 对于第二类漏洞，一般来说检测比较困难，因为是发生在
服务器侧。比如说SQL注入，有可能是返回数据库错误提示信息，也有可能是什么也不反
馈。Burp在检测过程中，采用各个技术来验证漏洞是否存在，比如诱导时间延迟、强制修改
Boolean值，与模糊测试的结果进行比较，已达到高准确性的漏洞扫描报告。
被动扫描（Passive Scanning）
66
第七章 如何使用Burp Scanner
当使用被动扫描模式时，Burp不会重新发送新的请求，它只是对已经存在的请求和应答进行
分析，这对系统的检测比较安全，尤其在你授权访问的许可下进行的，通常适用于生成环境
的检测。一般来说，下列这些漏洞在被动模式中容易被检测出来：
1. 提交的密码为未加密的明文。
2. 不安全的Cookie的属性，比如缺少的HttpOnly和安全标志。
3. cookie的范围缺失。
4. 跨域脚本包含和站点引用泄漏。
5. 表单值自动填充，尤其是密码。
6. SSL保护的内容缓存。
7. 目录列表。
8. 提交密码后应答延迟。
9. session令牌的不安全传输。
10. 敏感信息泄露，像内部IP地址，电子邮件地址，堆栈跟踪等信息泄漏。
11. 不安全的ViewState的配置。
12. 错误或者不规范的Content-type指令。
虽然被动扫描模式相比于主动模式有很多的不足，但同时也具有主动模式不具备的优点，除
了前文说的对系统的检测在我们授权的范围内比较安全外，当某种业务场景的测试，每测试
一次都会导致业务的某方面问题时，我们也可以使用被动扫描模式，去验证问题是否存在，
减少测试的风险。
Burp Scanner扫描报告
当我们对一个系统进行扫描完毕后，通常需要生成扫描报告，Burp Scanner支持的报告类型
有HTML和XML两种格式。无法何种格式的扫描报告，其内容基本一致，主要由以下部分组
成。报告样例可以点击Burp Scanner report查看.
除了头部的综述和目录外，每一个漏洞的章节通常包含： 1.序号 表示漏洞的序号，如果有多
个同样的漏洞，报告中只会有一个序号。 2.漏洞的类型，可以近似地理解与OWASP的类型相
对应。 3.漏洞名称，具体可参考 Issue Definitions子选项卡。 4.漏洞路径，漏洞对应的多个
URL链接。 5.漏洞的发生点，通常为参数名。 6.问题的描述（Issue background） 描述漏洞
发生的成因 7.解决建议（Remediation background）提供解决的思路和建议 8.请求消息和应
答消息的详细信息。
如果我们想对某次的扫描结果进行保存，需要Burp Target 的站点地图子选项卡的问题面板
（Issue）上右击，在弹出的菜单中选择report Issues进行设置并保存即可。（注意，如果想
导出所有的漏洞，需要选中所有的问题列表） 具体导出漏洞报告的步骤如下： 1.选中需要保
存的漏洞，右击弹出菜单，如下图：
67
第七章 如何使用Burp Scanner
2.在弹出的对话框中选择需要保存的漏洞报告格式。
3.选择漏
洞明细包含内容。
68
第七章 如何使用Burp Scanner
4.请求消
息和应答消息设置。
5.选择报
告包含的哪些漏洞。
69
第七章 如何使用Burp Scanner
6.最后，
指定报告存放位置、报告名称等属性。
Burp Scanner扫描控制
70
第七章 如何使用Burp Scanner
在对系统做主动扫描时，当我们激活Burp Scanner，扫描控制的相关设置也同时开始了。如
下图所示，当我们在Burp Target 的站点地图上的某个URL执行Actively scan this host时，会
自动弹出过滤设置。
在这里，我们可以设置扫描时过滤多媒体类型的应答、过滤js、css、图片等静态资源文件。
当我们点击【next】按钮，进入扫描路径分支的选择界面。如下图：
71
第七章 如何使用Burp Scanner
以上是Burp Scanner开始扫描前的控制，当我们设置完这些之后，将正式进入扫描阶段。此
时，在Scan queue队列界面，会显示扫描的进度、问题总数、请求数和错误统计等信息。
在此界面上，我们可以选中某个记录，在右击的弹出菜单中，对扫描进行控制。比如取消扫
描、暂停扫描、恢复扫描、转发其他Burp组件等。如下图：
同时，在Results界面，自动显示队列中已经扫描完成的漏洞明细。
72
第七章 如何使用Burp Scanner
在每一个漏洞的条目上，我们可以选中漏洞。在弹出的右击菜单中，依次选择Set severity，
对漏洞的等级进行标识。也可以选择Set confidence，对漏洞是否存在或误报进行标注。
73
第七章 如何使用Burp Scanner
另外，在Live Scanning选项卡中，我们也可以对请求的域、路径、IP地址、端口、文件类型
进行控制，如下图：
如果你选中了Use suite Scope，则指定条件与你在Burp Target中的Scope配置完全一致，如
果你选择了Use customs scope，则可以自己定义Scope，对于Scope的详细配置，请参考
Burp Target中的Scope配置相关章节。