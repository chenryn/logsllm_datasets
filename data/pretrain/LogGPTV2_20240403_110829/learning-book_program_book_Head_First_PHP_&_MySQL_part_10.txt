会把这些串合并起来形成一个串，然后再把这个串输出标记，知道要把其中的代码作为PHIP代码运行，而这些
到浏览器。
标记以外的所有代码都直接作为HTML传递到浏览器。
文本吗？
为HTML/CSS代码的。到底是怎么回事？
量必须包含串才能完成连接。所以假设一个变量包含一
连接。
echo命令就是PHP能够动态生成HTML/CSS代码的关
键所在。通过连接文本串与PHP变量，你可以实时构造
HTML代码。然后使用echo将其作为结果Web页面的
一部分输出到浏览器。在Owen的report.php脚本中，
对此有一个很好的例子，标记加在一段文本的
PHP代码。PHP代码在服务器上运行，并转换为HTML
代码发送到浏览器。所以浏览器完全不知道PHP的存
在，Web页面会作为纯HTML和CSS到达。
42第1章
---
## Page 79
为静态页面赋予生命
确认Web页面对用户很有帮助
但是对我并没有任何好处。我还
是需要表单数据能通过一个eail
发送给我。
PHP脚本仍然需要通过email把表单数据发送给Owen。
确实，report.php脚本从Report anAbduction表单获取数据，并为用户
生成了一个HTML确认页面。不过这还是没有解决原先的问题，即表单提
交时需要通过email向Owen发送一个消息。他只是希望收到一个简短的文
本email消息，与下类似：
Alf Nader was abducted last November and was gone for
11 hours.
Number of aliens: dozens
类似于确认We6页面，这
个email消息由静态文本结
Alien description: 1ittle green men
合表单数据构成。
What they did: asked me about UFO regulations
Fang spotted: no
Other comments: Please vote for me.
这个email消息可以由PHP代码集成一个串来生成，即把诸如”Other
请写出如何结合静态文本和PHP变量合成一个email消息串
你现在的位置
43
---
## Page 80
利用PHP创建消息体
利用PHP创建email消息体
你已经看到PHP代码中可以使用一个点号将多个文本串连接构成一个串。
现在需要再次使用连接来构建一个email消息串，将变量分布在静态文
本中。
即使你没有加入换行（回
变量和静态文本使用点号连接构
车），大多数文本编辑器
成一个email消息串。
也会自动将代码换行。
$msg =$name
was abducted'.$when_it_happened.
'and was gone for'.$how_long.'.
'Number of aliens:'.Show_many.'Alien description:'.$alien_description.'What they did:'
要记住，每个变量包含从
Repont anAbduction表单获取
构建这样一个长串存在一个问题，它需要一个很长的PHP代码行，这将
的一个文本串。
很难阅读也很难理解。可以把PHP代码分为多行，以便于阅读。不过要
确保只是在间隔不会造成影响的位置划分代码，如两个连接串之间，而
不是一个串的中间。然后在最后一行代码的末尾放置一个分号来结束这
个PHP语句。
这实际上只是一个相它长的代码行，被划分到
多行上。
K
$msg =$name.'was abducted'.Swhen_it_happened.'and was gone for'.$how_long.'.'
'Number of aliens:'.$how_many
'Alien description:'.Salien_description.
'What they did:'.$what_they_did.
这行代码经过精心划分，而
不至于在一个事的中间分开。
'Fang spotted:'.Sfang_spotted.
'Other comments:'.$other;
一行PHP代码有意划分为多行时，习惯
还必须用一个分号结束整个语句。
上金缩进第一行之后的各行，来帮助
你查看代码中哪些行属于同一行代码。
只要谨慎安排如何划分代码，一个
很长的PHP代码行可以跨多行。
44
第1章
---
## Page 81
为静态页面赋予生命
这个PHP代码确实好最些了。不过暖
然没有格式，难道eail消息不会涯
亲在一起吗？
O
没错。只是很好地组织PHP代码并不意味着它的输出自动地会看上去很好。
组织PHP代码，从而能更好地理解它，这与格式化用户将看到的PHP代码的
输出完全是两码事。你通常会使用HTML标记来格式化PHP代码的输出，因
为在大多数情况下，PHP都用于自动生成一个Web页面。但是这里并非如此。
在这里我们要生成一个email消息，这是纯文本而非HTML。现在消息看上去
如下所示，我们需要解决这个问题：
Alf Nader was abducted last November and was gone for 11 hours.
Number of aliens: dozensAlien description: little green menWhat
they did: asked me about UFO regulationsFang spotted: noOther
comments: Please vote for me.
喷呀：这可不是Owen心里所想
的Abduction Report email消岛。
theregareno
DumbQuestions
格式化？
BRAIN
WPOWER
容类型首部。首部和内容类型有些超出这里讨论的范围，
如何对纯文本email消息重新
所以我们一直坚持使用纯文本email消息作为Owen的email
格式化使之更易于阅读？
响应。第6章中你会了解更多有关首部的内容，所以后面
再次谈到HTMLemail时你会有更多了解。
你现在的位置
45
---
## Page 82
利用PHP格式化文本
纯文本也能格式化····但只能一点点
由于Owen要发送没有任何HTML格式化的纯文本email消息，他不能简
PHP中的转义字
单地通过增加标记在内容汇集的位置增加换行。不过他可以
符以一个反斜线
使用换行符号，转义为\n。所以只要email文本中出现\n，就会插人一
（）开头。
个换行，使得在它之后的所有内容都从另一行开始。以下是增加了换
行符的新的email消息代码：
\x用于在整个email消息
中放置换行符。
$msg=$name.'was abducted
Svhen_it_happened.'and was gone for '.Show_long.'.\n'
'Number of aliens:'.$how_many
\n'
'Alien description:'.$alien_descriRtion.'\n'
'what they did:'.$what_they_did.'\n'
'Fang spotted:'.$fang_spotted.'\n'
'other comments:'.$other;
换行听起来想法不错
不过藉糕的是代码不能正
常工作。
D
Alf Nader was abducted last November and was gone for 11 hours.
nNumber of aliens:dozensnAlien description:littc green men
nWhat they did: asked me about UFO regulationfnFang spotted:
nonOther comments: Please vote for me.
n作为正常文本出现，而不是
thereareng
作为换行符…·这可不太好。
DumbQuestions
答：
转义字符就是一个很难键入的字符，或者是可能导致
PHP代码出现混乱的字符。你可能对HTML中的转义字符很
熟悉，在HTML中转义字符的编码稍有不同，如代表版权符号
的&#169；或&COPY;。PHP有一个很小的转义字符集，用来
转义可能导致与PHP语言本身符号产生混清的内容，如单引号
（\）、双引号（\"），当然还有换行（\n）。
46
---
## Page 83
为静态页面赋予生命
换行需要双引号串
Owen代码的问题在于，PHP会以不同的方式处理串，这取决于串是用单
引号包围还是双引号包围。更确切地讲，换行符（\n）只能在双引号串
中转义。所以AbductionReportemail消息必须使用双引号串来构造才能
保证换行符起作用。
不过单引号和双引号的问题还不止这一点，单引号串被认为是原始文
本，而PHP处理双引号串时会寻找变量。在一个双引号串中遇到变量
时，PHP会在串中插入该变量的值，就好像连接串一样。所以双引号串
不再需要连接，因为变量可以
不仅是保证换行符在email消息中正常工作的必要前提，它还使我们能够
在一个双引号串中直接引用。
简化代码，只需在串中直接插入变量。
$msg = "$name was abducted Swhen_it_happened and was gone for $how_long.\n"
"Number of aliens: $how_many\n",
"Alien description: $alien_description\n",
换行符现在金得到正确的解释
"Fang spotted:$fang_spotted\n".
这要归功于双引号串。
"other comments:$other";
但是我们还需要把消息分为多
不
个相互连接的事，让代码跨多
最后不再需要换行符，因为这是
行以便于阅读。
email消息的最后一行。
thereareno
DumbQuestions
都使用单引号串呢？
号事内部使用单引号，只需将它转义为\·，类似'He\'s
1ost！。这同样适用于双引号串中的双引号一只需使用\
对于只包含纯文本而没有任何嵌入变量的串来说非常理想。可以直接写作："He's1ost!”。
所以本书中我们还会继续使用单引号串，除非有绝对必要
的原因要求使用双引号串。关于串两边使用单引号还是双
引号、最重要的一点是要努力保证尽可能一致。
引号之间可以使用哪些转义字符呢？
比如说'He'slost！'，该怎么做呢？
符都只能用于双引号串中。
你现在的位置》
47
---
## Page 84
组装Owen的email
为Owen组装email消息
email的消息体已经生成为一个串，可以继续为Owen组装email的余下部
分。email消息不只有一个消息体，还有很多不同部分。尽管有些是可选
的，但以下几部分信息在所有email中都要用到：
已经究成！
这里可以是你希望的任何主题，
①消息体
它金在Owen的收件箱中作为email
主题出现。
②消息主题
用户的email地址。
③发送者email地址（消息来自哪里：from）
Owen的emailt地址。
4接收者email地址（消息由谁接收：to）
这才是有人提交外星人劫持报告时Owen希望接收到的email消息。
这是Owen的emailt地址，
这是用户的emailt地
这可以是静态串。
也可以是一个静态串。
址.已经存储在Semail
变量中。
000
AliensAbr
tedM
From:8
PI:EMAIL
Subject:Aliens Abducted Me-Abduction Report
2
Dale:
October1,2008 12:07:20 PM CDT
To:PI:EMAIL
Alf Nader was abducted last November and was gone for 11 hours
Number of aliens: dozens
Alien description: little green men
What theydid:asked me about UFOregulations
Fang spotted: no
Other comments: Please vote for me.
我们已经为email消息体构造了
个事，存储在Smss变量中。
这个示例email显示出内容大部分都在消息的体中，这部分你已经完成。
剩下的就是提供消息主题、发送者email地址（“from”）和接收者email
地址（“to”）…·当然，还要使用PHP以某种方式具体发送消息！
48
第1章
---
## Page 85
为静态页面赋予生命
变量存储email各部分信息
我们已经将消息体存储在$msg中，但是还缺少消息主题以及“from”
和“to”email地址。主题和“to”email地址可以作为静态文本设置在新
变量中，而“from”
email地址已经由本章前面编写的表单处理代码存储
在Semail变量中。
$to='PI:EMAIL';
$email-$_POST['email'];
Abduction Report
Inbox
000
From;PI:EMAIL
3
②
Aliens Abducted Me - Abduction Report
Date:
October1,2008 12:07:20 PM CDT
To:PI:EMAIL
Alf Nader was abducted last November and was gone for 11 hours.
Number of aliens: dozens
Alien description:litle green men
What they did:asked me about UFO regulations
Fang spotted:no
Other comments: Please vote for me.
1
1
$subject -'Aliens Abducted Me - Abduction Report';
$msg ="$name was abducted Swhen_it_happened and was gone for $how_long.\n"
"Number of aliens: $how_many\n"
"Alien description: Salien_description\n"
"What they did: $what_they_did\n"
"Fang spotted: $fang_spotted\n"
"Other comments:$other";
1消息体
email的所有信
息都已经收集并
②消息主题
准备就续！
③发送者email地址（消息来自哪里：from）
4接收者email地址（消息由谁接收：to）
你现在的位置
49
---
## Page 86
利用PHP发送email
利用PHP发送email消息
现在准备编写PHP代码向Owen具体发送email消息。这需要用到
PHPmail(函数
PHP内置mail（）函数，它会基于你提供的信息发送一个消息。
可以从脚本发送
一个email消息。
"to”emailt地t址
消息主题
mail($to，$subject，$msg）;
个
消息体
这3部分信息是mai1（）函数的必要参数，所以必须提供这些信
息。“from”email地址不是必要的，但包含这部分信息是一个不错
的想法。要在调用mai1（）函数时指定“from”域，还需要一个额外
指定email发送者的地址时必
须将文本From：追加在
的函数参数，另外要完成一些串连接。
email地址前。
mail($to,$subject，$msg，
'From:'
$email);
点号可以再一次方便地连
接‘From：和Owen的emailt地址。
therepareno
DumbQuestions
"Alien descriptions
“Fang spotted: $fang_spot
定其他内容作为email消息的一部分？
7
email消息的各部分信
送者同样的方式指定“copy（抄
乌都由一个变量提供给
送）和“blindcopy”
（密送）接收
mailO）函数。
者一只是要使用Cc：或BCC：而不
是'From：'。如果希望同时指定“from”发
送者和“copy”接收者，必须用一个回
这里没有错，确实是两
车换行符组合（\r\n）将其分开，如下：
个转义字得放在一起！
7
"From:".$from."\r\nCc:".$cc
这里必须使用双引号，因为我们使用
T
了“\：”和\n”转义字符。
50
第1章
---
## Page 87
为静态页面赋予生命
那么到底怎么使围
mall0&数呢？
O
只需要把调用mai1（）的代码增加到脚本中。
要发送email消息，所需要的只是调用mai1（)函数的代码行。确保这个代
码出现在脚本中创建email变量的相应代码的后面，这样就可以了。以下
是Owen的report.php脚本的完整代码，其中包括有mail（)函数调用。
从LS_POST数组获取所有
Aliens Abducted Me - Report an Abduction
表单数据，并分别存储
在各个变量中。
<?php
-$_POST['firstname′].'.$_POST['lastname′];
Swhen_it_happened - S_PosT[*whenithappened′];
Sname
Show_many = S_POST(*howmany′];
$alien_description = s_Post['aliendescription'1;
$what_they_did - $_POST['whattheydid′];
一定要把这个email地址
$fang_spotted = S_PosT['fangspotted′};
$emai1 = S_POST['emai1′1;
改为你自己的地址来测
$other = S_PosT['other'];
试这个脚本。
$to -'owen8aliensabductedme.com';
K