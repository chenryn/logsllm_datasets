strategic road map, 6 TFTP (Trivial FTP) server
strcpy function, 366–367, 422 downloading file with, 187–188
string, generating with Perl script, 372 fuzzing program, 424–426
strong passwords, 198 packet, 435
structured exception handler (SEH) packet format, 423
overwrites, 401–419 writing to file, 438
choosing payload, 418–419 Thawte (certificate authority), 171
exploits, 403–407 theHarvester (Python tool), 118–119
finding attack string in memory, then statement, in Bash scripts, 78
408–411 third-party software, exploiting buffer
replacing with POP POP RET, 414, 415 overflow in, 190–191
SafeSEH, 412–416 third-party web applications,
short jump assembly instruction, exploitation, 191–193
416–417 threat-modeling phase of penetration
structured exception handler, passing testing, 2, 4
control to, 407–408 TikiWiki CMS software, 191–192
su command, 59–60 TKIP (Temporal Key Integrity
sudo command, 59 Protocol), 350
sudoers file, 59 TLS (Transport Layer Security)
superuser (root) prompt, 16 encryption, 181
switches, and traffic capture, 156 /tmp/run file (Linux), adding code to,
SYN scan, 125–127 290–291
Syskey utility, encryption key for, token impersonation, 300–301
189, 205 touch command, 60
system() command (PHP), 186 tr utility (Linux), 267
system password hashes, 194 training employees, about social
system privileges, session running engineering, 244
with, 297 Transport Layer Security (TLS)
encryption, 181
T Trivial FTP server. See TFTP (Trivial
FTP) server
Tabnabbing Attack Method, 251
trojans, 258–259
target virtual machines, 28–29. See also
MD5 hash to check for, 260
Windows 7 target machine,
TrustedSec, Social-Engineer
Windows XP target machine,
Toolkit, 244
Ubuntu 8.10 target machine
two-factor authentication, 198
TCP connection
creating socket, 82
U
Netcat tool for, 69–72
three-way handshake, 125 UAC (user account control), 285–287
TCP scan, 127 Ubuntu 8.10 target machine, 28. See
TCP stream, Wireshark for also Linux
following, 159 setup, 48
technical report, 6 udev (device manager for Linux), 288
Temporal Key Integrity Protocol UDP scans, 128–130, 295
(TKIP), 350 UDP socket, setting up, 435
Tenable Security, Nessus, 17, 134–142 uname command, 287
testing window, 3 unstructured supplementary service
text data (USSD), 456–457
adding to file, 61 upload command (Meterpreter), 279
searching for, 63, 65 uploading, Msfvenom payload,
text messages, mobile hacking with, 446 183–185
text segment of memory, 362 URIPATH option, 221
492 Index
user account control (UAC), 285–287 Windows 7 target machine, 48–54
user accounts Windows XP target machine,
adding, 58–59 29–40
adding, persistence and, 309 Virtual Machine Settings dialog, 15
adding to sudoers file, 59 virtual machines
creating in Windows, 35, 48–49 configuring network for, 13–17
in Linux, 58 connecting to network, 16–17
for logging in to FTP, 165 to delay booting, 207
switching, 59–60 target, 28–29
user lists, 199 virtual networks, and traffic
user password. See passwords capture, 156
user privileges, 58–61 VirtualAlloc injection method, 271
USER32.dll, 429–430 VirusTotal, 262–263
usernames results for encoded binary, 265
finding, 118 VMware, installing, 9–10
finding valid, 153 VMware Fusion (Mac OS), 10, 16, 31–32
guessing with Hydra, 202–203 installing VMware Tools for, 36
users. See also social engineering VMware Player (Windows), 9–10,
downloading payload by, 105 14–15, 35–36
enticing to download and install installing Windows XP on, 29–31
Android agent, 460 VMware Tools
listing all local, 294 installing on Windows XP target
logging keystrokes by, 292 machine, 35–36
sending messages to contacts, 465 installing on Windows 7 target
/usr/share/exploitdb/platforms/linux/ machine, 48, 50
local/8572.c exploit, 288–289 VMware Workstation, 10
/usr/share/metasploit-framework/modules/ .vmx configuration file, 207
post/windows/gather/ VRFY SMTP command, 153
credentials module, 292 Vsftpd (Very Secure FTP) 2.3.4,
USSD (unstructured supplementary 133–134, 193–194, 258
service data), 456–457 vulnerabilities, 133–153
in Java, 230–233
V manual analysis, 151–153
researching, 142
variables, in Python, 82
searching for known, in War-FTP,
Veil-Evasion, 270–274
380–382
available payloads, 272
web application scanning, 148–151
installing, 21
vulnerability analysis phase of
Python VirtualAlloc in, 273
penetration testing, 2, 4
VeriSign (certificate authority), 171
vulnerability repository, 149
version scan, 127–128
vulnerability scanners
Very Secure FTP (Vsftpd) 2.3.4,
Nessus Home, 17
133–134, 193–194, 258
reasons to use, 141
vi (file editor), 62
vulnerable software, installing, 40–47
editing file, 63
virtual lab setup, 9–54
W
installing VMware, 9–10
installing vulnerable software, w3af (Web Application Attack and
40–47 Audit Framework), 335–337
Kali Linux setup, 10–28 War-FTP
target virtual machines, 28–29 crashing, 397–398, 403
Ubuntu 8.10 target machine, 48 downloading and installing, 46
Python exploit to crash, 383
Index 493
War-FTP (continued) Winamp
searching for known vulnerability installing, 52
in, 380–382 replacing configuration file for,
USER buffer overflow, 439 237–239
warning, for PDF embedded Windows
executable, 229 APIs, Railgun for accessing, 283
Warning: system() [function.system]: clipboard, stealing data from, 334
Cannot execute a blank firewall
command in... message, 187 and response to ping, 51
WCE (Windows Credential Editor), turning off, 37
213–214 Security Accounts Manager
Web Application Attack and Audit (SAM) file
Framework (w3af), 335–337 downloading, 189
web application testing, 313–337 recovering password hashes
with Burp Proxy, 314–319 from, 204–206
command execution, 327–329 Service Control Manager, remote
cross-site request forgery, 335 procedure call (RPC), 296
cross-site scripting (XSS), 329–335 Syskey utility, 189
local file inclusion, 324–327 VMware Player, 9–10, 14–15
remote file inclusion, 327 Windows 7 target machine, 48–54
scanning with w3af, 335–337 adding second network interface, 52
signing up for account, 317–318 bypassing UAC on, 285–287
SQL injection, 319–322 creating user account, 48–49
XPath injection, 323–324 dumping hashes with physical
web applications attack, 206–207
access to server-side source installing additional software,
code, 326 52–54
third-party, exploitation, 191–193 opting out of automatic updates, 50
vulnerability scanning, 148–151 Powershell in, 329
web browsers. See browsers turning off real-time protection, 53
web server Windows 2000, LM hashes storage, 211
copying app to, 451 Windows Credential Editor (WCE),
running script on target, 183 213–214
web server software, system privileges Windows XP target machine, 28
and, 185 activating, 34
WebDAV (Web Distributed Authoring creating, 29–40
and Versioning) installing, 32–35
software, 150 LM hashes storage, 211
exploiting default credentials, local privilege escalation, 284–285
182–183 Nessus detection of
WebEx, Java for, 241 vulnerabilities, 139
WebKit package, attacking, 454–456 setup to behave as member of
websites, for wordlists, 200 Windows domain, 39–40
WEP. See wired equivalent windows/local/bypassuac exploit, 286
privacy (WEP) windows/meterpreter/bind_tcp payload, 307
wget command, 289 windows/meterpreter/reverse_tcp payload,
whoami command, 71, 291 247, 265, 273–274
whois lookups, 115–116 windows/smb/ms08_067_netapi
Wi-Fi protected access (WPA), 350 module, 306
Wi-Fi Protected Setup (WPS), 356–357 WinSCP, 292–294
Wifite tool, 350, 356 downloading and installing, 46
494 Index
wired equivalent privacy (WEP), X
343–350
x/16xw $esp command (GDB), 369
challenges, 350
XAMPP
cracking keys with Aircrack-ng,
Apache, default install location, 186
347–350
attacking, 149–150
weaknesses, 346
default credentials, 150–151
wireless attacks, 339–357
default login credentials for
capturing packets, 342–343
WebDav, 182
scanning for access points, 341
installing, 43–45
setup, 339–341
starting control panel, 43
viewing available interfaces,
XML
340–341
attacks on, 323–324
Wi-Fi protected access, 350
usernames and passwords in, 326
Wi-Fi Protected Setup (WPS),
Xpath, 320
356–357
injection, 323–324
wired equivalent privacy (WEP),
xp_cmdshell() function, 188
343–350
xp_cmdshell stored procedure, 322
WPA2, 351–356
xphashes.txt file, 210
wireless network
XSS (cross-site scripting), 329–335
monitor mode, 341–342
checking for reflective
open, 343
vulnerability, 330
Wireshark, 156–160
leveraging with BeEF, 331–335
capturing traffic, 156–158
dissecting packets, 160
Z
filtering traffic, 158–159
following TCP stream, 159 zero-day vulnerability, 220, 240
for viewing WPA2 handshake, 355 Zervit server, 40–41
wordlists for passwords, 199–201 crashes from Nmap scan, 130, 131
Workgroup settings, for Windows XP, 33 zone transfers, DNS, 117–118
WPA (Wi-Fi protected access), 350
WPA2, 351–356
cracking keys, 353–356
dictionary attack against, 356
enterprise connection process, 351
four-way handshake, 352–353
personal connection process, 351
WPS (Wi-Fi Protected Setup), 356–357
write (w) permissions, 62
Index 495
Penetration Testing is set in New Baskerville, TheSansMono Condensed,
Futura, and Dogma. The book was printed and bound by Sheridan Books,
Inc. in Chelsea, Michigan. The paper is 60# Finch Offset, which is certified
by the Forest Stewardship Council (FSC).
The book uses a layflat binding, in which the pages are bound together
with a cold-set, flexible glue and the first and last pages of the resulting
book block are attached to the cover. The cover is not actually glued to the
book’s spine, and when open, the book lies flat and the spine doesn’t crack.
Updates
Visit http://nostarch.com/pentesting/ for updates, errata, and other
information.
More no-nonsense books from no starcH press
android secUrity internals tHe practice of network practical Malware analysis
an in-depth Guide to android’s secUrity MonitorinG the Hands-on Guide to dissecting
security architecture Understanding incident detection Malicious software
by nikolay elenkov and response by michael sikorski and
september 2014, 384 pp., $49.95 by richard bejtlich andrew honig
isbn 978-1-59327-581-5 july 2013, 376 pp., $49.95 february 2012, 800 pp., $59.95
isbn 978-1-59327-509-9 isbn 978-1-59327-290-6
Metasploit practical packet analysis, HackinG, 2nd edition
the penetration tester’s Guide 2nd edition the art of exploitation
by david kennedy, jim o’gorman, Using wireshark to solve by jon erickson
devon kearns, and mati aharoni real-world network problems february 2008, 488 pp. w/cd, $49.95
july 2011, 328 pp., $49.95 by chris sanders isbn 978-1-59327-144-2
isbn 978-1-59327-288-3 july 2011, 280 pp., $49.95
isbn 978-1-59327-266-1
phone: email:
800.420.7240 or PI:EMAIL
415.863.9900 web:
www.nostarch.com
Downloading the Software to Build Your Virtual Lab
You’ll find links for the resources used in this book at http://www.nostarch.com/
pentesting/, including the custom web application, the Ubuntu target, and
the Kali Linux virtual machine. Use the password 1stPentestBook?! to open the
7-Zip archive containing the book’s resources.
You can find 7-Zip programs for Windows and Linux platforms at http://
www.7-zip.org/download.html. Mac users can use Ez7z from http://ez7z .en.softonic
.com/mac/.
If you’re unable to download the files or you’d just like them delivered
to your doorstep, we’ll send you a DVD containing the files for US $10.
Visit http://www.nostarch.com/pentesting/ for details.
You’ll find additional resources at Georgia Weidman’s website: http://
bulbsecurity.com/.