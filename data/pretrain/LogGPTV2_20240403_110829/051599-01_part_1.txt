第 3 课
Linux 文件系统
人们对程序的使用即为对文件的使用，因此对系统的使用主要表
现在对文件的使用。系统是一个中介，提供了对文件的操作方法。
本课将主要讲解Linux文件系统的内容，包括文件系统的工作原
理、文件类型、文件目录和文件权限等。既有通过界面对文件的使用，
也有通过命令对文件系统的管理。
本课学习目标：
 了解Linux文件系统的组织方式
 了解Linux文件系统的工作原理
 掌握文件系统的挂载和卸载
 了解Linux文件系统文件类型
 掌握Linux文件查阅
 掌握Linux文件属性和权限管理
 理解Linux目录配置
 掌握Linux目录操作
 掌握硬链接的含义及其创建
 掌握软链接的含义及其创建
 理解软链接与硬链接的区别
Linux 课堂实录
3.1
Linux 文件系统
文件系统（file system）表示存储在计算机上文件和目录的数据结构，
也可以用于存储文件的分区或磁盘。操作系统可以通过文件系统方便地查寻和访问其中所包含的磁
盘块。
3.1.1 Linux 文件系统概述
在Linux系统中，每个分区都是一个文件系 制，节省硬盘空间。由于删除文件要在
统，都有自己的目录层次结构。Linux最重要的 同一个索引节点属于惟一的连接时才能
特征之一就是支持多种文件系统这样它更加灵 成功，因此可以防止不必要的误删除。
活，并可以和其他种操作系统共存。由于系统已  符号连接 用ln -s命令建立文件的符号
经将Linux文件系统的所有细节进行了转换，所 连接。符号连接是 Linux 特殊文件的一
以Linux核心的其他部分及系统中运行的程序将 种，作为一个文件，它的数据是它所连
看到统一的文件系统。 接文件的路径名。类似于Windows下的
1．文件记录形式 快捷方式，可以删除原有的文件而保存
Linux 文件系统使用索引节点（inode）来 连接文件，没有防止误删除功能。
记录文件信息，索引节点的作用类似于 2．文件系统类型
Windows 操作系统中文件分配表。索引节点是 文件系统具有不同的格式，它们决定了信息
一种数据结构，它包含了一个文件的长度、创建 如何被存储为文件和目录，这些格式就被称为文
及修改时间、权限、所属关系、磁盘中的位置等 件系统类型（file system types）。随着Linux的
信息。 不断发展，它所支持的文件系统格式也在迅速扩
一个文件系统维护了一个索引节点的数组， 充，特别是Linux 2.4内核正式推出后，出现了
每个文件或目录都与索引节点数组中的惟一一 大量新的文件系统，其中包括日志文件系统
个元素对应。系统给每个索引节点分配了一个号 ext3、ReiserFS、XFSJFS和其他文件系统，到
码，也就是该节点在数组中的索引号，称为索引 目前最新版本内核的Linux支持更多文件系统，
节点号。 常见的有如下所示：
Linux文件系统将文件索引节点号和文件名  ext2 早期Linux中常用的文件系统。
同时保存在目录中。所以，目录只是将文件的名  ext3 ext2 的升级版，带日志功能，是
称和它的索引节点号结合在一起的一张表，目录 当前Linux系统默认的文件系统类型。
中的每一对文件名称和索引节点号称为一个连  RAMFS 内存文件系统，速度很快。
接。对于一个文件来说，有一个索引节点号与之  NFS 网络文件系统，由SUN发明，主
对应、而对于一个索引节点号，却可以对应多个 要用于远程文件共享。
文件名。因此在磁盘上的同一个文件可以通过不  MSDOS ms-dos文件系统。
同的路径去访问它，这就引入了连接的概念。ln  VFAT Windows95/98 操作系统采用的
命令可以对一个已经存在的文件再建立一个新 文件系统。
的连接，而不用复制文件的内容。连接有软连接  FAT Windows XP 操作系统采用的文
和硬连接之分，其中软连接又叫符号连接。 件系统。
 硬连接 原文件名和连接文件名都指向  NTFS Windows NT/XP 操作系统采用
相同的物理地址。目录不能有硬连接， 的文件系统。
硬连接不能跨越文件系统（不能跨越不  HPFS OS/2 操作系统采用的文件
同的分区），文件在磁盘中只有一个复 系统。
38
SPSS 第3课 Linux文件系统
 PROC 虚拟的进程文件系统。 间的差异，为用户命令、函数调用和内核其他部
 ISO9660 大部分光盘所用的文件系统。 分提供访问文件和设备的统一接口，使得不同的
 ufsSun OS所用的文件系统。 逻辑文件系统按照同样的模式呈现在使用者面
 HFS Macintosh机采用的文件系统。 前。就用户使用角度而言，觉察不到逻辑文件系
统的差异，可以使用同样的命令或操作来管理不
 NCPFS Novell 服务器所采用的文件
同逻辑文件系统下的文件，如图3-1演示了VFS
系统。
的层次结构。
 SMBFS Samba的共享文件系统。
 XFS 由 SGI 开发先进的日志文件系
统，支持超大容量文件。
 JFS IBM的AIX使用的日志文件系统。
 ReiserFS 基于平衡树结构的文件系统。
3．VFS
上面介绍了Linux支持的多种文件系统，其
中ex3是当前Linux版本默认的文件系统。Linux
支持的所有文件系统称为逻辑文件系统，而
Linux在传统的逻辑文件系统的基础上增加了一
个虚拟文件系统（Virtual File System，VFS）
的接口层。
虚拟文件系统（VFS）位于文件系统的最上
图3-1 虚拟文件系统
层，管理各种逻辑文件系统，并可以屏蔽它们之
3.1.2 Linux 文件系统组织方式
不同的系统对文件的组织方式也不同，所支 D:\My Documents\My Pictures
持的文件系统数量和种类也不同。操作系统中文
在 Linux 操作系统中使用“/”间隔根目录
件的组织方式都是采用类似树状的目录结构。
和子目录。在Linux操作系统中没有驱动器盘符，
Linux文件系统也是树状结构，与Windows
它将所有的文件放在文件系统中进行统一管理。
操作系统类似。但它们表示路径的方式不同，在 其中除了本地文件，还包括网络文件、CD-ROM
Windows操作系统中，文件路径如下所示： 文件和移动设备等。
3.1.3 Linux 文件系统工作原理
Linux文件系统通过为每个文件分配文件块 略。磁盘上的文件根据需要分配给文件，这种方
的方式把数据存储在存储设备中，这样就要维护 式可以避免存储空间的浪费。当一个文件不断扩
每一个文件所有文件块的分配信息，而分配信息 充的时候，就可能会造成文件中文件块不连续，
本身也要存储在磁盘上，不同的文件系统用不同 从而导致了过多的磁盘寻道时间。当读取一个文
的方式分配和读取文件块。Linux下常见的文件 件时，可能要随机读取而非连续，所以读取文件
系统分配策略为块分配（block allocation）和扩 效率会降低。
展分配（extent allocation）。 可以通过优化文件块分配策略（尽可能为文
1．块分配（block allocation） 件分配连续的块）来避免文件块的随机分配。通
传统的Unix文件系统使用了块分配机制， 过使用块分配策略，可以实现块的连续分配，便
该机制提供了一个灵活而高效的文件块分配策 能减少磁盘的寻道时间。但是当整个文件系统块
39
Linux 课堂实录
分配形成碎片时，就再也不能进行连续分配了。 已分配文件块大小时，就不用写入meta-data直
每一次文件扩展的时候，块分配算法就要写 到需要再分配文件块的时候。
入一些关于新分配块所在位置的信息。如果每一 扩展分配可以优化磁盘寻道的方式，可以成
次文件扩展的时候只增加一个块，那么就需要很 组地分配块，有利于一次写入一大批数据到存储
多额外的磁盘I/O用来写入文件块的结构信息。 设备中，从而减少了SCSI设备写数据的时间。
文件块结构信息也就是meta-data（元信息：和 基于扩展分配的文件系统在读取顺序文件
文件有关的信息，例如权限、所有者以及创建、 时具有较好性能，因为文件块都是成组连续分配
访问或更改时间等）。meta-data 总是与文件一 的。但如果 IO 操作是随机的，则基于扩展分配
起写入存储设备，这就意味着改变文件大小的操 的文件系统的优势就非常有限了。例如当连续地
作要等到所有 meta-data 的操作都完成之后才 读取一个基于扩展分配文件的时候，只要读取起
能进行。因此，meta-data的操作会明显降低整 始块号和文件长度，然后就可以连续地读取所有
个文件系统的性能。 的文件块，这样在顺序读取文件的时候，读取
2．扩展分配（extent allocation） meta-data的开销就最小；反之，如果随机地读
对块分配而言，每一次文件增大时都要为该 取文件，则先要查找每一个所需要块的块地址，
文件分配磁盘空间，而扩展分配则是当某个文件 然后读取块中的内容，这样就和块分配很类似了。
的磁盘空间不足时，一次性分配一连串连续的 文件块的组或块簇（block cluster）的大小
块。当文件被创建时，很多文件块同时被分配， 是在编译时确定的。簇的大小对文件系统的性能
当文件扩展时，也一次分配很多块。meta-data 确实有很大影响，而且簇的大小也是文件系统设
在文件创建时写入，当文件的大小没有超过所有 计时需要考虑的一个很重要的因素。
3.1.4 文件系统挂载和卸载
硬件上的软件系统在经过挂载之后才能访 NTFS。挂载前还需要了解相关的知识，包括挂
问存储设备上的文件。在Windows操作系统中， 载时使用的命令。
挂载通常是指给磁盘分区（包括被虚拟出来的磁 在shell命令环境中使用命令，首先需要打
盘分区）分配一个盘符。 开系统终端，打开方法同时按下 Ctrl 按钮、Alt
在Linux操作系统中，挂载是指将一个设备 按钮和T按钮，如图3-2所示。图中的背景色和
挂接到一个已存在的目录上。我们要访问存储设 字体颜色是可以更改的，本文以白底黑字为例。
备中的文件，必须将文件所在的分区挂载到一个
已存在的目录上，然后通过访问这个目录来访问
存储设备。
Linux 系统的挂载需要执行挂载（mount）
命令，即在shell命令环境中使用mount挂载文
件系统。
在 Linux 中所有的内容都是以目录来组织
图3-2 系统终端
的，所谓的挂载可以将光盘、软盘或其他文件系
统当作一个目录来访问，这个目录就是挂载点。 图3-2中打开的即为系统终端，接收并执行
挂载点可以不为空，但挂载后这个目录下以 用户的命令。系统的命令有很多，其格式基本相
前的内容将不可用，对于其他操作系统建立文件 同，如下所示：
系统的挂载也是相同的。但是需要理解的是光
命令 [选项] [参数]…
盘、软盘、其他操作系统使用的文件系统的格式
与Linux使用的文件系统格式是不一样的。光盘 根据Linux系统中的挂载和卸载过程，有以
是 ISO 9660，Windows XP是 fat16、fat32、 下几点内容。
40
SPSS 第3课 Linux文件系统
1．mount命令 2．确定设备名
mount命令的作用是加载文件系统，它的使 在挂载文件系统时，被挂载的文件系统一定
用权限是root用户或/etc/fstab中允许的使用者， 是 Linux 操作系统支持的文件系统，否则使用
该命令的功能非常强大，因此用户需要好好掌 mount命令挂载时会报错。用户在挂载文件系统
握。命令格式如下所示： 之前，一定要手动创建挂载点，因为 mount 命
令无法自动创建挂载点。
mount [选项] [挂载设备] [挂载点]
Linux 系统中设备名称通常都保存在/dev
mount命令中的选项如下所示：
中，这些设备名称的命名都按照一定的规则，例
 -h 显示辅助信息。 如/dev/disk是指硬盘，fd是Floppy Device（或
 -v 显示信息，通常和-f 一起使用来排 是Floppy Disk），a代表第一个设备，通常IDE
队错误。 接口可以接上 4 个 IDE 设备，所以识别硬盘的
 -a 将所有文件系统挂载。 方法是hda、hdb、hdc和hdd。如果hda1中的
 -F 这个命令通常和-a 一起使用，会为 “1”表示第一个分区，hda2表示第二个主分区，
每一个 mount 动作产生一个执行线程， 第一个逻辑分区从hda5开始。
在系统需要挂载大量NFS文件系统时可
3．挂载系统
以加快挂载速度。
在挂载系统之前，首先要确定挂载点是否存
 -f 通常用于除错，会使用 mount 不执 在，如果不存在一定要创建挂载点。在根目录下
行实际挂载动作，而是模拟整个挂载过 创建一个mymount目录，在该目录下创始子目
程，通常会和-v一起使用。 录/mymount/cdrom用于挂载光盘驱动器，执行
 -t 显示被加载文件系统的类型。 命令如下所示：
 -n mount 在挂载后会在/etc/mtab 中写
mount –t iso9660/mymount/cdrom
入资料，在系统中没有可写入文件系统
的情况下，可以用这个选项取消该动作。 目前市场上多种 Linux 发行版本，如红旗
 -o 指定挂载系统时的选项。 Linux、中软Linux、Mandrake Linux都可以自
在 Linux 系统终端使用 mount 命令，显示 动挂载文件系统。
系统中挂载的文件系统，如图3-3所示。将系统
试 一 试
中的所有文件系统挂载，只能通过root才能进行。
在 ubuntu 系统下可以挂载 windows 系统分区，其
挂载方式与其他文件系统的挂载方式一样。
4．卸载文件系统
unmount 命令的作用与 mount命令正好相
反，主要用于卸载一个文件系统。它的使用权限
也是root用户或/etc/fstab中允许的使用者。
命令格式如下所示：
unmount –[参数] [挂载的设备] [挂载点]