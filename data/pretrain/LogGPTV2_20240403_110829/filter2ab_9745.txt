titleblackhat:us-21 Chip Chop - Smashing the Mobile Phone Secure Chip for Fun and Digital Forensics
Hardware security modules in the form of Embedded Secure Element (eSE) hardware have been introduced in mobile phones, with a view towards increasing the security of critical system features and encrypted user data. On Android, this concept goes under names like "strongbox" and "tamper resistant hardware" (TRH).The eSE is designed to remain secure even if the rest of the system is compromised, and to withstand both logical and physical attacks, including side channel attacks.We present how we adapted current state-of-the-art attacks to the eSE platform and present a remote attack on a Common Criteria EAL 5+ (AVA_VAN.5) certified eSE by Samsung, S3K250AF, introduced in their premium mobile models with the Exynos chipset (Galaxy S20 and Note 20). We show how we discovered a critical 0-day vulnerability that can be exploited, leading to a complete compromise of all the eSE security goals and a full loss of future eSE trust, as mitigation of our attack in already fielded devices is challenging, as we exposed the embedded AES key used for encrypted FW updates.Our eSE attack is performed using the eSE logical APDU communication and can be performed remotely by an attacker with root access in the Rich Execution Environment (REE). Current research is ongoing, to remove this rooted REE constraint, e.g. by doing a chip-off/on attack on the eSE and performing brute force using a Rubber Ducky or similar.The ultimate result of our research facilitates digital forensic acquisition of affected devices in before-first-unlock (BFU) state, and we demonstrate how to conduct off-device brute force of user screen lock credentials.Our attack exposes the gap between intended/promoted and achieved security, undermining the needed trust in certifications.The vulnerability is patched (CVE-2020-28341 / SVE-2020-18632).