些数据可以是用户的账号和密码，可以是一些商用机密数据等。这些噢探器很容易被入侵者完
成入侵以后种植在受害者服务器当中，有的只是简单的用来捕捉用户名和密码，有的则非常强
大，可记录所有的网络数据流。Linux操作系统下有很多这样的优秀工具，下面，我们来具体
看看。
(1)tcpdump
软件下载地址为htp:/www.tcpdump.org/。
这是一个专业的网络管理工具，而且这个工具也留下了不少网络攻击故事。它能把匹配规
则的数据包的包头显示出来，使用TCPDump去查找网络问题或者去监视网络上的状况。
tcpdump的安装十分简单，一般有两种安装方式。一种是以rpm包的形式来进行安装，另外一
种是以源程序的形式安装。以rpim包的形式安装是最简单的安装方法，通过rpm命令可以直接
安装。以超级用户登录后，使用命令#rpm-ivhtcpdump.rpm，就可以顺利安装了。
Tepdump采用命令行的方式使用，它的命令格式为：
tcpdump（-adef1nopqStvx]1-c数量1[-F文件名]
[-1网络接口][-r文件名][-8snaplen]
-T类型][W文件名1[表达式]
在收到指定的包的数目后，tcpdump就会停止：“-F”表示从指定的文件中读取表达式，忽略
“中，
示将监听到的包直接解释为指定类型的报文，常见的类型有运程过程调用和snmp简单网络管
理协议。
tcpdump的表达式是一个正则表达式，tcpdump利用它作为过滤报文的条件，如果一个报
文满足表达式的条件，则这个报文将会被捕获。如果没有给出任何条件，网络上所有的信息包
将会被截获。在表达式中一般有如下几种类型的关键字，一种是关于类型的关键字，主要包括
host、net、port 等。第二种是确定传输方向的关键字，主要包括 src、dst、dstorsrc、dst and src
等，这些关键字指明了传输的方向。第三种是协议的关键字，主要包括fdi、ip、arp、rarp、
tcp、udp等类型。除了这三种类型的关键字之外，其他重要的关键字如下：gateway、broadcast、
less、greater，还有3种逻辑运算“或、非、与”，这些关键字可以形成强大的组合条件来满
足人们的需要。例如，想要截获所有210.27.48.1的主机收到的和发出的所有的数据包：
ftcpdump host 210.27.48.1
想要获取主机210.27.48.1除了和主机210.27.48.2之外所有主机通信的IP包，使用命令：
tcpdump ip host210.27.48.1and:210.27.48.2
384
---
## Page 390
第8章.掌握实用的Linux安全工具
如果想要获取主机210.27.48.1接收或发出的telnet包，使用如下命令：
tcpdump tcp port 23host 210.27.48.1
下面我们介绍几种典型的tcpdump命令的输出信息。比如，使用如下命令：
tcpdunp--e host ice
其中，ice是一台装有Limux的主机，其MAC地址是2E:19:24:28:AF:1A。H219是一台装
有Solaric的Sun工作站，它的MAC地址是8:0:20:79:5B:46；上一条命令的输出结果如下所示：
ice.telnet 0:0(0) ack 22535 win 8760 (DF)
分析：21:50:12是显示的时间，847509是ID号，eth0表示从网络接口设备发送数据包，8:0:20:79:5b:46是主机H219的MAC地址，它表明是
从源地址H219发来的数据包。2E：19:24:28:AF:1A是主机ICE的MAC地址，表示该数据包的
目的地址是ICE。ip是表明该数据包是IP数据包，60是数据包的长度，h219.33357>ice.telnet
表明该数据包是从主机H219的33357端口发往主机ICE的Telnet（23）端口。ack22535表明对
序列号是222535的包进行响应。win8760表明发送窗口的大小是8760。
再比如，使用命令：
ttcpdunp arp
得到的输出结果是：
22:32:42.802902eth0ay-a1uutt111e（2E:19:24:28:aF:1A）
（28:19:24:28:AF:1A）
分析：22:32:42是时间截，802509是ID号，eth0>表明从主机发出该数据包，arp表明是
ARP请求包，who-hasroute tellice表明是主机ICE请求主机ROUTE的MAC地址。
2E:19:24:28:AF:1A是主机ICE的MAC地址。此外，这个软件还可以分析UDP等数据包，结
合Linux环境熟练使用后，我们就可以充分发挥它的威力。
(2)Hunt
软件下载地址为 http:/lin.fsid.cvut.cz/kra/index.htmwhunt。
Hunt具有直观的命令追踪和会话录制功能，它以tar.gz的格式发布，文件下载后，首先需
要解压缩。运行Hunt后，将启动一个很直观的菜单，界面显示内容如下：
---Main Menu---rcvpkt 0.free/al1oc 63/64------
1/w/z)list/watch/reset connections
a)arp/sinple hijack (avoids ack stormif arp used)
s)simplehijack
d) daemons rst/arp/aniff/mac
o) options
x）exit
0)192.168.0.1[1049]-->192.168.0.2[23]
---
## Page 391
网络安全进阶笔记
choose conn>0
dump [s]rc/[d]st/[b]oth tb]>b
注：上面的输入指示hunt来记录0号连接，并输出源和目的信息，则hunt将活动信息发
送到终端屏幕上。可以看到，hunt的输出非常直观明了，易于阅读。humt还提供有以下工具：
允许指定任意一个感兴趣的连接，而不是记录所有的东西：允许指定任意一个连接，面不仅仅
是以SYN刚刚开始的连接：提供活动会话劫持。
(3)Linsniffer
软件下载地址为http://www.mecworks.com/software/，
Linsniffer是一个简单实用的噢探器。它主要的功能是捕提用户名和密码。
软件下载后，使用下面的命令来编译和运行Linsniffer：
Scclinsniffer.c-o linsniffer
slinsniffer
启动以后Linsnifer将创建一个空文件tcp.log来存储噢探结果。在测试中创建了一个名为
cndes的用户，密码为123456。然后使用该用户来登录Linux服务器，并进行一些常见的用户
操作。这是一个典型的用户操作过程。下面，我们看看Linsnifer产生的噢探结果：
gnss =>1inux.test.net [21]
USER cndes
PASS 123456
SYST
PORT 172,16,0,1.4.192
LIST
-al
PORT172,16.0.1.4.193
LIST
PORT 172,16,0,1,4.194
LIST-P
CWD1g
PORT172,16,0,1,4,195
LIST-F
输出内容十分直观。我们可以分析如下：首先，它记录到Linux主机的FTP连接：gnss=>
linux.test.net [21]。然后，Linsniffer 捕获了用户名和密码，最后，Linsniffer 记录了cndes 使用
的每一个命令。输出结果非常清楚，非常适合窃听密码及记录常见的活动，不过，这个软件不
太适合进行更加复杂的分析。
(4)Linux-sniff
软件下载地址为htp://www.zone-h.org/files/52/linux-sniff.c
linux_sniffer提供相对更复杂的探测结果。首先，使用如下命令编译linux_sniffer：
Scc linux_sniffer.c-o linuxsniff
下面是被linux_sniffer记录的一次Telnet会话过程：
GNSS 2telnet192.168.0.1
Connected to 192.168.0.1.
-login:cndes
386
---
## Page 392
第8章掌握实用的Linux安全工具
password:
[cndeselinux2 cndes]$
19:55:29up58 min,4users,1oadaverage:0.00,0.00.0.00
USRR TTY FROM LOGIN9 IDLE JCPU PCPU WHAT
roottty17:44pm27.00s 0.17s 0.06s-bash
root tty2 7:46pm 1:56 0.24s 0.01s 1inuxsniff
root tty37:44pm 10:43 0.17s 0.07s -bash
cndesttyp0 gnss7:55pm1.00s 0.26s0.04s
[cndeselinux2 cndes]$ who
root tty1 May 20 19:44
root tty2May 20 19:46
root tty3May 20 19:44
cndes ttyp0 May 2019:55 （gmss)
[cndes8linux2 cndes]s finger-1
Login:root Name:root
Directory:/root Shell:/bin/bash
Onsince Thu May 20 19:44 （PDT) on tty1 35 seconds idle
On since Thu May 20 19:44 （PDT）on tty3 10 minutes 51 seconds idle
No mail.
No Plan.
Login: cndes Name: Caldera OpenLinux User
Directory:/home/cndes Shell:/bin/bash
Onsince Thu May20 19:55（PDT)on ttyp0 from gnss
No mail.
No Plan.
(5)Ettercap
软件下载地址为http://ettercap.sourceforge.net/。
Etercap是一款局域网环境下的网络监视、拦截和记录工具，支持多种主动或被动的协议
分析，有数据插入、过滤、保持连接同步等功能，还有一个能支持多种噢探模式套件，能够检
查网络环境是否是交换局域网，并且能使用主动或被动的操作系统指纹识别技术，让本地攻击
者充分了解当前局域网的情况。
(6)DSniff
软件下载地址为http://naughty.monkey.org/~dugsong/dsnifF。
DSniff是由DugSong开发的一个网络审计、测试和噢探软件套件，其中，dsniff、filesnarf、
mailsnarf、msgsnarf、rlsnarf和 webspy可以用于监视网络上我们感兴趣的数据，如口令、E-mail、
文件等。arpspoof、dnsspoof和macof则可以很容易地载取到攻击者通常难以获取的网络信息，
如二层交换数据。
(7)Ethereal
软件下载地址为http/www.ethereal.com/。
Ethereal是一款免费的网络协议分析程序，支持Unix、Windows。借助于这个程序，我们
可以直接从网络上抓取数据进行分析，也可以对其他噢探器抓取的数据进行分析，查看每一个
数据包的摘要和详细信息。Ethereal有多种强大的特征，如支持几乎所有的协议、丰富的过滤
387
---
## Page 393
网络安全进阶笔记
语言、易于查看TCP会话经重构后的数据流等。
(8)sniffit
软件下载地址为 http://reptile.rug.ac.be/coder/sniffit/sniffit.html
sniffit是一个TCP/IP/ICMP协议数据报监听器，它能给出这些协议数据报的详细技术信息
及符合监听条件的数据报的各种不同的格式。snifft可以进行方便的配置，实现对接入的数据
报进行过滤。而配置文件允许非常确定地指定需要处理的数据报。默认情况下，sniffit可以处
理以太和PPP设备，也可以用在其他的设备上。
由于Linux系统下噢探器的优秀功能和强大的杀伤力，因此，新的软件层出不穷，而各个
优秀软件的改进版本或增强版也不断涌现，读者可以在实际使用中多多收集。
3.入侵检测系统攻击及口令破解
(1)Crack
Crack是破解软件中的开山员祖，是破解Unix口令的著名工具，现在已经成为检查网络口
令弱点的工业标准。它由AlecD.E.Muffeu编写，工作原理十分简单，我们知道加密口令是不
会被解开的，这是因为加密算法是不可逆的。所以，一般的口令入侵是通过生成口令进行加密
去匹配原口令密码，或直接从网上截获明文口令。Crack程序中包含了儿个很大的字典库，进
行破解时它会按照一定的规则将字词进行组合，然后对之进行加密，再与要破解的加密口令匹
配。在使用中，如果口令文件很小，时间和资源都不成问题，但是如果口令文件比较大，则要
花费很长的时间和耗费相当多的资源。
(2)Fragroute