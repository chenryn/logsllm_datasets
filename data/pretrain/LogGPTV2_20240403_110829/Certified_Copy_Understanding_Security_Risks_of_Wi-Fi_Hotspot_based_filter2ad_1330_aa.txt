title:Certified Copy? Understanding Security Risks of Wi-Fi Hotspot based
Android Data Clone Services
author:Siqi Ma and
Hehao Li and
Wenbo Yang and
Juanru Li and
Surya Nepal and
Elisa Bertino
Certified Copy? Understanding Security Risks of Wi-Fi Hotspot
based Android Data Clone Services
Siqi Ma
Hehao Li, Wenbo Yang, Juanru Li1
The University of Queensland
Australia
PI:EMAIL
Shanghai Jiao Tong University
China
@sjtu.edu.cn
Surya Nepal
CSIRO
Australia
PI:EMAIL
Elisa Bertino
Purdue University
USA
PI:EMAIL
ABSTRACT
Wi-Fi hotspot-based data clone services are increasingly used by An-
droid users to transfer their user data and preferred configurations
while upgrading obsolete phones to new models. Unfortunately,
since the data clone services need to manipulate sensitive informa-
tion protected by the Android system, vulnerabilities in the design
or implementation of these services may result in data privacy
breaches. In this paper we present an empirical security analysis of
eight widely used Wi-Fi hotspot-based data clone services deployed
to millions of Android phones. Our study evaluates those services
with respect to data export/import, data transmission, and Wi-Fi
configuration with respect to security requirements that the data
clone procedure should satisfy. Since data clone services are closed
source, we design Poirot, an analysis system to recover workflows
of the data clone services and detect potential flaws. Our study
reveals a series of critical security issues in the data clone services.
We demonstrate two types of attacks that exploit the data clone
service as a new attack surface. A vulnerable data clone service
allows attackers to retrieve sensitive user data without permissions,
and even inject malicious contents to compromise the system.
KEYWORDS
Data clone service, Platform app, Proprietary protocol, Android
diversification
ACM Reference Format:
Siqi Ma, Hehao Li, Wenbo Yang, Juanru Li1, Surya Nepal, and Elisa Bertino.
2020. Certified Copy? Understanding Security Risks of Wi-Fi Hotspot based
Android Data Clone Services. In Annual Computer Security Applications
Conference (ACSAC 2020), December 7–11, 2020, Austin, USA. ACM, New
York, NY, USA, 12 pages. https://doi.org/10.1145/3427228.3427263
1 INTRODUCTION
Mobile phones nowadays store large amounts of sensitive user data
such as personal e-mails and account passwords. To protect against
security threats such as data theft and malware, mobile phones
and their operating systems (OSes) have introduced a number of
security protection mechanisms such as full disk encryption and
app data isolation to prevent unauthorized access. However, when
a user wants to transfer her data from an obsolete mobile phone
to a new one, the transfer process suffers from both usability and
1Juanru Li is the corresponding author.
privacy issues. With respect to usability, official data backup/restore
mechanisms of Android and iOS systems require either a cloud
drive (e.g., Google Drive and iCloud) or a desktop computer as an
auxiliary medium. Although users do not frequently replace their
mobile phone, 55.56% of them update to a new phone every 12
or 24 months. Such data backup/restore mechanisms are not only
inefficient but also inconvenient. With respect to privacy, exporting
sensitive user data to either a cloud drive or a hard disk raises
concerns of data abuse or data leakage.
To ensure a secure and smooth data migration, many Android
phone manufacturers developed a new cross-device data migration
solution — Wi-Fi hotspot-based data clone. By establishing a
private and temporary Wi-Fi network connection between two
mobile phones, user data are transferred between these two phones
directly. This approach achieves a high data transmission speed
without requiring the transferred user data to be stored at a third-
party medium. More importantly, system privileges are granted to
these data clone services so that they are allowed to access sensitive
user data (e.g., app login credentials stored at app sandboxes). Hence,
a large number of manufacturers embed the data clone service as a
default service in their mobile phones. Table 1 lists the number of
devices produced by the well-known manufacturers that would be
affected by the vulnerabilities we have identified.
Nonetheless, designing a secure data clone service is challeng-
ing because developers are not security experts and they focus
more on the usability of the software [36] instead of its security
complied with the Android security model [24]. Although most
data clone services claim to have addressed security issues, their
implementations are closed source and often lack a comprehensive
assessment. In response, we conducted a systematic study against
the popular Wi-Fi hotspot-based data clone services published by
the eight mainstream Android manufacturers. To the best of our
knowledge, we are the first to analyze this application scenario.
Our target is to examine whether the analyzed data clone services
satisfy essential security goals such as confidentiality and integrity
checks for transferred data, and authentication of connected mo-
bile phones. In order to carry out our analyses, we build Poirot,
an analysis system to recover the undocumented workflows and
proprietary data transmission protocols. Poirot statically analyzes
executables of each data clone service and dynamically inspects its
behavior (including code execution and relevant network traffic).
The data clone services are analyzed in three perspectives: data
320ACSAC 2020, December 7–11, 2020, Austin, USA
Siqi Ma, Hehao Li, Wenbo Yang, Juanru Li1, Surya Nepal, and Elisa Bertino
Table 1: Estimated number of devices affected by vulnerabil-
ities in Wi-Fi hotspot-based data clone
Figure 1: Internal architecture of a Wi-Fi hotspot based data
clone service
export and import, data transmission, and Wi-Fi configuration. The
results show that those data clone services contain many serious
design flaws that have never been reported. To protect end-users,
we have contacted the relevant manufacturers and reported the
identified flaws. We expect our study becomes a guide to revising
similar functions as well as developing new services securely.
To prove that those flaws can lead to actual attacks, we designed
two types of attacks. The attacks can either be launched remotely
through wireless communication or locally via a malicious app
on either the old phone or the new one. We found that seven out
of eight investigated services suffer from at least one attack, and
since those data clone services are implemented as pre-installed sys-
tem components, we could estimate the number of mobile phones
affected according to the sales data released by each manufacturer.
The rest of the paper is organized as follows. Section 2 introduces
relevant background on Wi-Fi hotspot-based data clone. Section 3
introduces our security analysis approach and describes Poirot. It
also describes in details the different features we analyze for each
data clone service. Section 4 reports the results of our analysis and
introduces the attacks we have designed to exploit some of the
flaws identified by our analysis. Finally Section 5 discusses related
works and Section 6 outlines a few conclusions.
2 WI-FI HOTSPOT-BASED DATA CLONE
The Wi-Fi hotspot-based data clone is a data migration proce-
dure between two Android mobile phones, in which a temporary,
private Wi-Fi network is built connecting the phones. In compari-
son to data clone solutions relying on a USB cable (e.g., Android’s
ADB backup and restore), this wireless data clone procedure is
convenient. Unlike a cloud-based data clone, which uses a remote
cloud server (e.g., Google Drive) as the intermediate data storage,
such a Wi-Fi hotspot-based data migration is fast – around 10MB/s
relying on a private Wi-Fi network between two involved phones,
and is not much affected by the Internet connection. In addition it
does not “consume” any mobile data.
Figure 1 shows the internal architecture of a Wi-Fi hotspot-
based data clone. A data clone service typically consists of a data
clone app and several supporting components implemented as
either system libraries or system processes. Specifically, a data clone
procedure between two phones consists of four steps:
1) Wi-Fi Setup: The private Wi-Fi hotspot is started by the data
clone app on the old mobile phone1. The app sets up the Wi-Fi
network and then encodes the Wi-Fi information (i.e., SSID and
password) into an QR code. The QR code might include a connection
port, which is allocated either randomly or it is fixed. The new
mobile phone can join the WLAN by using the camera to scan the
QR code.
2) Data Export: According to the permissions granted to the data
clone app, the app on the old mobile phone lists all the exportable
data for users to select. The app then packs the selected data into
different files with customized transfer formats. Note that the large
size data, such as photos and videos, are compressed when their
size exceeds a certain limit.
3) Data Transmission: To transfer the packed files between two
mobile phones, most manufacturers customize the private applica-
tion protocols based on TCP. Others rely on some existing protocols
such as FTP and HTTP. During the actual transfer, files are usually
transferred through multiple threads. Data clone services adopt mul-
tiple strategies to protect the transferred data. First, the privately
built Wi-Fi network is protected by a security standard protocol
(e.g., WPA2 protocol) and excludes unauthorized devices. Second,
data clone services rely on a secure protocol (e.g., TLS) to avoid
potential attacks (e.g., eavesdropping) from third parties. Finally,
many data clone services deploy proprietary data encoding and
encryption schemes to further guarantee the confidentiality and
integrity of the transferred data.
4) Data Import: When all packed files are transferred to the new
mobile phone, its data clone app first unpacks the data and then
restores each to the specific directory. Obviously, permissions to
operate on these data are required.
In the following, we detail the four types of user data that can
be migrated.
2.1 Cloneable User Data
User data are stored at different places in the mobile phone, such
as SD cards and system databases. With respect to their purposes,
storage locations, and access permissions, we can classify the trans-
ferred user data into four categories: SD card data, communica-
tion records, system settings, and app related data.
1In fact, the Wi-Fi hotspot can be set up by either the old mobile phone or the new
mobile phone.
CertifiedCopy?UnderstandingSecurityRisksofWi-FiHotspotbasedAndroidDataCloneServicesSiqiMaTheUniversityofQueenslandAustraliaslivia.ma@uq.edu.auHaoheLi,WenboYang,PI:EMAIL@data61.csiro.auElisaBertinoPurdueUniversityUSAbertino@purdue.eduABSTRACTWi-Fihotspot-baseddatacloneservicesareincreasinglyusedbyAn-droiduserstotransfertheiruserdataandpreferredconfigurationswhileupgradingobsoletephonestonewmodels.Unfortunately,sincethedatacloneservicesneedtomanipulatesensitiveinforma-tionprotectedbytheAndroidsystem,vulnerabilitiesinthedesignorimplementationoftheseservicesmayresultindataprivacybreaches.InthispaperwepresentanempiricalsecurityanalysisofeightwidelyusedWi-Fihotspot-baseddatacloneservicesdeployedtomillionsofAndroidphones.Ourstudyevaluatesthoseserviceswithrespecttodataexport/import,datatransmission,andWi-Ficonfigurationwithrespecttosecurityrequirementsthatthedatacloneprocedureshouldsatisfy.Sincedatacloneservicesareclosedsource,wedesignPoirot,ananalysissystemtorecoverworkflowsofthedatacloneservicesanddetectpotentialflaws.Ourstudyrevealsaseriesofcriticalsecurityissuesinthedatacloneservices.Wedemonstratetwotypesofattacksthatexploitthedatacloneserviceasanewattacksurface.Avulnerabledatacloneserviceallowsattackerstoretrievesensitiveuserdatawithoutpermissions,andeveninjectmaliciouscontentstocompromisethesystem.KEYWORDSDatacloneservice,Platformapp,Proprietaryprotocol,Androiddiversification1INTRODUCTIONMobilephonesnowadaysstorelargeamountsofsensitiveuserdatasuchaspersonale-mailsandaccountpasswords.Toprotectagainstsecuritythreatssuchasdatatheftandmalware,mobilephonesandtheiroperatingsystems(OSes)haveintroducedanumberofsecurityprotectionmechanismssuchasfulldiskencryptionandappdataisolationtopreventunauthorizedaccess.However,whenauserwantstotransferherdatafromanobsoletemobilephonetoanewone,thetransferprocesssuffersfrombothusabilityandprivacyissues.Withrespecttousability,officialdatabackup/restoremechanismsofAndroidandiOSsystemsrequireeitheraclouddrive(e.g.,GoogleDriveandiCloud)oradesktopcomputerasanauxiliarymedium.Althoughusersdonotfrequentlyreplacetheirmobilephone,55.56%ofthemupdatetoanewphoneevery12or24months.Suchdatabackup/restoremechanismsarenotonly1JuanruLiisthecorrespondingauthor.Table1:Estimatednumberofdevicesaffectedbyvulnerabil-itiesinWi-Fihotspot-baseddatacloneDataCloneServiceNumberofvulnerabledevicesHuaweiPhoneClone≥100millionOPPOBackupAndRestore≥70millionVivoEasyShare≥70millionXiaomiBackup≥50millionGioneeGdataGhost≥15millionOnePlusBackupRestore≥4millionMotorolaMigrate≥1millionIntherestofthispaperwerefertoeachdatacloneservicebythenameofthecompanyprovidingit(e.g.,HuaweiPhoneCloneisreferredtoasHuawei)inefficientbutalsoinconvenient.Withrespecttoprivacy,exportingsensitiveuserdatatoeitheraclouddriveoraharddiskraisesconcernsofdataabuseordataleakage.Toensureasecureandsmoothdatamigration,manyAndroidphonemanufacturersdevelopedanewcross-devicedatamigrationsolution—Wi-Fihotspot-baseddataclone.ByestablishingaprivateandtemporaryWi-Finetworkconnectionbetweentwomobilephones,userdataaretransferredbetweenthesetwophonesdirectly.Thisapproachachievesahighdatatransmissionspeedwithoutrequiringthetransferreduserdatatobestoredatathird-partymedium.Moreimportantly,systemprivilegesaregrantedtothesedatacloneservicessothattheyareallowedtoaccesssensitiveuserdata(e.g.,applogincredentialsstoredatappsandboxes).Hence,alargenumberofmanufacturersembedthedatacloneserviceasadefaultserviceintheirmobilephones.Table1liststhenumberofdevicesproducedbythewell-knownmanufacturersthatwouldbeaffectedbythevulnerabilitieswehaveidentified.Nonetheless,designingasecuredatacloneserviceischalleng-ingbecausedevelopersarenotsecurityexpertsandtheyfocusmoreontheusabilityofthesoftware[36]insteadofitssecuritycompliedwiththeAndroidsecuritymodel[24].Althoughmostdatacloneservicesclaimtohaveaddressedsecurityissues,theirimplementationsareclosedsourceandoftenlackacomprehensiveassessment.Inresponse,weconductedasystematicstudyagainstthepopularWi-Fihotspot-baseddatacloneservicespublishedbytheeightmainstreamAndroidmanufacturers.Tothebestofourknowledge,wearethefirsttoanalyzethisapplicationscenario.OurtargetistoexaminewhethertheanalyzeddatacloneservicessatisfyessentialsecuritygoalssuchasconfidentialityandintegritySupporting ComponentsSystem APIsSystem ProcessesUser DataApp LayerAPK & app dataCommunication recordsSD card filesSystem settingsData Clone AppSupporting ComponentsSystem APIsSystem ProcessesUser DataApp LayerAPK & app dataCommunication recordsSD card filesSystem settingsData Clone App321Certified Copy? Understanding Security Risks of Wi-Fi Hotspot based Android Data Clone Services
ACSAC 2020, December 7–11, 2020, Austin, USA
SD card data. The Android system supports SD cards to
2.1.1
expand the storage of the phone. The specific user data (e.g., photos)
are stored in the partition of the SD card, i.e., /sdcard2. The SD