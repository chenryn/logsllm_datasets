lution for the dual problem.
• Dual.Setup (Σ, [T ]2): Call MRQED.Setup (Σ, [T ]4),
and output the public key PK, and master key SK.
• Dual.Encrypt (PK, [x1, x2] × [y1, y2], Msg): To
encrypt a message Msg under the range [x1, x2] ×
[y1, y2]
in 2 dimensions,
call MRQED.Encrypt
(PK, (x1, x2, y1, y2), Msg).
Observe that here a
range [x1, x2] × [y1, y2] in [T ]2 is mapped to a point
(x1, x2, y1, y2) in [T ]4.
• Dual.DeriveKey (PK, SK, (x, y)):
To generate
the point (x, y) ∈ [T ]2,
a decryption key for
call MRQED.DeriveKey (PK, SK, [1, x] × [x, T ] ×
[1, y] × [y, T ]).
• Dual.QueryDecrypt (PK, DK, C): To try to de-
crypt a ciphertext C using the decryption key DK, call
MRQED.QueryDecrypt (PK, DK, C).
In essence, the above construction maps a range [x1, x2]×
[y1, y2] ⊆ [T ]2 to a point (x1, x2, y1, y2) ∈ [T ]4, and test-
ing if a point (x, y) is within the range [x1, x2] × [y1, y2]
is equivalent to testing whether (x1, x2, y1, y2) ∈ [1, x] ×
[x, T ] × [1, y] × [y, T ]. It is easy to verify that the security
of the MRQED scheme guarantees a similar notion of secu-
rity for the dual construction, i.e., if a decryption key fails to
decrypt a certain ciphertext entry, then a probablistic polyno-
mial adversary cannot learn any additional information about
that entry.
8.2 Adaptive Security
Our scheme is provably secure in the selective-ID model.
A stronger notion of security is adaptive-ID security (also
known as full security), i.e., the adversary does not have to
commit ahead of time which point in the lattice to attack. We
present the formal deﬁnition for MRQED adaptive-ID secu-
rity in the online technical report version [43]. Previous re-
search has shown that IBE schemes secure in the selective-ID
sense can be converted to schemes fully secure [6, 18, 46, 36]
with some loss in security. In particular, Boneh and Boyen
prove the following theorem:
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:54:17 UTC from IEEE Xplore.  Restrictions apply. 
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007Example Query
sip = 207.44.178.∗,
dip = 216.187.103.169,
sip∈ [207.44.178.123, 207.44.182.247],
prot = TCP
port = 22,
time =∗,
dip =∗,
port = 22,
time∈ [5pm 10/31, 9am 11/5],
prot∈{TCP, UDP, ICMP}
sip∈ [207.44.178.123, 207.60.177.15],
dip∈ [207.44.178.123, 207.60.177.15],
port∈ [3024, 35792],
time∈ [10/31/2006, 10/31/2020],
prot∈{TCP, UDP, ICMP}
Nsip Ndip Nport Ntime Nprot
1
10
1
1
1
1
1
7
20
20
15
17
1
3
3
Pairing Worst-case Worst-case
Dec. Time
Time Mult. Time
65ms
< 0.1ms
65ms
286ms
1.2ms
287ms
0.98s
1.64s
2.62s
Table 4. Decryption times resulting from decryption keys of various sizes.
Theorem 8.1 ([6]). A (t, q, )-selective identity secure IBE
system (IND-sID-CPA) that admits N distinct identities is
also a (t, q, N )-fully secure IBE (IND-ID-CPA).
This technique can be applied to our case to achieve full
conﬁdentiality and anonymity. In our case, the scheme admits
N = T D identities and hence that would be the loss factor in
security.
9 Conclusion
We design an encryption scheme that allows us to encrypt
an arbitrary message and a set of attributes. An authority
holding a master key can issue a search capability to an autho-
rized party, allowing it to decrypt data entries whose attributes
fall within speciﬁc ranges; while the privacy of other data en-
tries is preserved. We prove the security of our scheme under
the D-BDH and the D-Linear assumptions in certain bilinear
groups. We also study the practical performance of our con-
struction in network audit log applications. Apart from net-
work audit logs, MRQED can be useful in various other ap-
plications such as ﬁnancial audit logs, untrusted email servers
and medical privacy.
In particular, we show that the dual
problem can be useful for investors who wish to trade stocks
through a broker in a privacy-preserving manner.
10 Acknowledgments
We would especially like to thank Brent Waters, Dan
Boneh, Matthew Wachs, and Eno Thereska for their valuable
suggestions on how to improve the paper. We also thank the
anonymous reviewers for their insightful comments.
References
[1] Michel Abdalla, Mihir Bellare, Dario Catalano, Eike Kiltz,
Tadayoshi Kohno, Tanja Lange, John Malone-Lee, Gregory
Neven, Pascal Paillier, and Haixia Shi. Searchable encryption
revisited: Consistency properties, relation to anonymous IBE,
and extensions. In Advances in Cryptology - Proceedings of
CRYPTO ’05, pages 205–222. Springer-Verlag, August 2005.
[2] Rakesh Agrawal, Jerry Kiernan, Ramakrishnan Srikant, and
Yirong Xu. Order preserving encryption for numeric data. In
SIGMOD ’04: Proceedings of the 2004 ACM SIGMOD inter-
national conference on Management of data, pages 563–574,
2004.
[3] Giuseppe Ateniese, Marina Blanton, and Jonathan Kirsch. Se-
cret handshakes with dynamic and fuzzy matching. In Network
and Distributed System Security Symposium, 2007.
[4] Mihir Bellare, Alexandra Boldyreva, Anand Desai, and David
Pointcheval. Key-privacy in public-key encryption.
In ASI-
ACRYPT ’01: Proceedings of the 7th International Conference
on the Theory and Application of Cryptology and Information
Security, pages 566–582, 2001.
[5] John Bethencourt, Dawn Song, and Brent Waters. New con-
structions and practical applications for private stream search-
ing (extended abstract). In SP ’06: Proceedings of the 2006
IEEE Symposium on Security and Privacy (S&P’06), pages
132–139, 2006.
[6] Dan Boneh and Xavier Boyen. Efﬁcient selective-id secure
identity-based encryption without random oracles. In EURO-
CRYPT, pages 223–238, 2004.
[7] Dan Boneh and Xavier Boyen. Secure identity based encryp-
In CRYPTO, pages 443–459,
tion without random oracles.
2004.
[8] Dan Boneh, Xavier Boyen, and Eu-Jin Goh. Hierarchical
identity based encryption with constant size ciphertext.
In
Ronald Cramer, editor, Proceedings of Eurocrypt 2005, LNCS.
Springer, 2005.
[9] Dan Boneh, Xavier Boyen, and Hovav Shacham. Short group
signatures. In CRYPTO, pages 41–55, 2004.
[10] Dan Boneh, Giovanni Di Crescenzo, Rafail Ostrovsky, and
Public key encryption with keyword
Giuseppe Persiano.
search. In EUROCRYPT, pages 506–522, 2004.
[11] Dan Boneh and Matthew Franklin. Identity-based encryption
from the weil pairing. SIAM J. Comput., 32(3):586–615, 2003.
[12] Dan Boneh, Amit Sahai, and Brent Waters. Fully collusion
resistant traitor tracing with short ciphertexts and private keys.
In EUROCRYPT, 2006.
[13] Dan Boneh and Brent Waters. Conjunctive, subset, and range
queries on encrypted data. To appear in the Theory of Cryp-
tography Conference (TCC), 2007.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:54:17 UTC from IEEE Xplore.  Restrictions apply. 
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007[14] Dan Boneh and Brent Waters. A fully collusion resistant
broadcast, trace and revoke system. In CCS, 2006.
[15] Xavier Boyen and Brent Waters. Anonymous hierarchi-
In
cal identity-based encryption (without random oracles).
CRYPTO, 2006.
[16] Ran Canetti, Shai Halevi, and Jonathan Katz. A forward-
secure public-key encryption scheme. In EUROCRYPT, pages
255–271, 2003.
[17] Ran Canetti, Shai Halevi, and Jonathan Katz.
Chosen-
ciphertext security from identity-based encryption. In EURO-
CRYPT, pages 207–222, 2004.
[18] Sanjit Chatterjee and Palash Sarkar. Trading time for space:
Towards an efﬁcient IBE scheme with short(er) public param-
eters in the standard model. In Proceedings of ICISC, 2004.
[19] The Elliptic Semiconductor CLP-17 high performance elliptic
curve cryptography point multiplier core: Product brief.
http://www.ellipticsemi.com/pdf/
CLP-17 60102.pdf.
[20] Clifford Cocks. An identity based encryption scheme based on
quadratic residues. In IMA Int. Conf., pages 360–363, 2001.
[21] Reza Curtmola, Juan Garay, Seny Kamara, and Rafail Ostro-
vsky. Searchable symmetric encryption: Improved deﬁnitions
and efﬁcient constructions. In CCS, 2006.
[22] Ernesto Damiani, S. De Capitani Vimercati, Sushil Jajodia,
Stefano Paraboschi, and Pierangela Samarati. Balancing conﬁ-
dentiality and efﬁciency in untrusted relational dbmss. In CCS
’03: Proceedings of the 10th ACM conference on Computer
and communications security, pages 93–102, 2003.
[23] D. Davis, F. Monrose, and M. K. Reiter. Time-scoped search-
ing of encrypted audit logs.
In Proceeding of the Interna-
tional Conference on Information and Communications Secu-
rity (ICICS), 2004.
[24] Symantec deepsight threat management system technology
brief. https://tms.symantec.com.
[25] The dshield project. http://www.dshield.org.
[26] Craig Gentry and Alice Silverberg. Hierarchical ID-based
cryptography.
In ASIACRYPT ’02: Proceedings of the 8th
International Conference on the Theory and Application of
Cryptology and Information Security, pages 548–566, London,
UK, 2002. Springer-Verlag.
[27] Oded Goldreich. Secure multi-party computation. Volume 2,
Foundations of Cryptography, 1998.
[28] Oded Goldreich and Rafail Ostrovsky. Software protection and
simulation on oblivious rams. J. ACM, 43(3):431–473, 1996.
[29] Vipul Goyal, Omkant Pandey, Amit Sahai, and Brent Waters.
Attribute-based encryption for ﬁne-grained access control of
encrypted data.
In CCS ’06: Proceedings of the 13th ACM
conference on Computer and communications security, pages
89–98, 2006.
[30] Hakan Hacigumus, Bala Iyer, Chen Li, and Sharad Mehro-
tra. Executing sql over encrypted data in the database-service-
provider model.
In SIGMOD ’02: Proceedings of the 2002
ACM SIGMOD international conference on Management of
data, pages 216–227, 2002.
[31] Jeremy Horwitz and Ben Lynn. Toward hierarchical identity-
based encryption.
In EUROCRYPT ’02: Proceedings of
the International Conference on the Theory and Applications
of Cryptographic Techniques, pages 466–481, London, UK,
2002. Springer-Verlag.
[32] Antoine Joux. A one round protocol for tripartite Difﬁe-
Hellman.
In ANTS-IV: Proceedings of the 4th International
Symposium on Algorithmic Number Theory, pages 385–394,
London, UK, 2000. Springer-Verlag.
[33] Patrick Lincoln, Phillip A. Porras, and Vitaly Shmatikov.
Privacy-preserving sharing and correlation of security alerts.
In USENIX Security Symposium, pages 239–254, 2004.
[34] Ben Lynn. The Pairing-Based Cryptography (PBC) library.
http://crypto.stanford.edu/pbc.
[35] The mynetwatchman
project.
http://www.
mynetwatchman.com.
[36] David Naccache. Secure and practical identity-based encryp-
tion. Cryptology ePrint Archive, Report 2005/369, 2005.
http://eprint.iacr.org/.
[37] Rafail Ostrovsky. Software protection and simulation on obliv-
ious RAMs. Ph.D. thesis, MIT, 1992. Preliminary version in
STOC 1990.
[38] Rafail Ostrovsky and William E. Skeith III. Private searching
on streaming data. In CRYPTO, pages 223–240, 2005.
[39] Vern Paxson. Bro: A system for detecting network intruders
in real-time. In USENIX Security Symposium, 1998.
[40] P. Porras and P. Neumann. EMERALD: Event monitoring en-
abling responses to anomalous live disturbances. In National
Information Systems Security Conference, 1997.
[41] Amit Sahai and Brent Waters. Fuzzy identity-based encryp-
tion. In EUROCRYPT, pages 457–473, 2005.
[42] Adi Shamir.
Identity-based cryptosystems and signature
schemes. In Proceedings of CRYPTO 84 on Advances in cryp-
tology, pages 47–53, New York, NY, USA, 1985. Springer-
Verlag New York, Inc.
[43] Elaine Shi, John Bethencourt, T-H. Hubert Chan, Dawn
Song, and Adrian Perrig. Multi-dimension range query
over encrypted data.
Technical Report CMU-CS-06-
135, May, 2006, http://sparrow.ece.cmu.edu/
∼elaine/docs/rangequery.ps.
[44] The Snort open source network intrusion detection system.
http://www.snort.org.
[45] Dawn Xiaodong Song, David Wagner, and Adrian Perrig.
Practical techniques for searches on encrypted data. In SP ’00:
Proceedings of the 2000 IEEE Symposium on Security and Pri-
vacy, page 44, Washington, DC, USA, 2000. IEEE Computer
Society.
[46] Brent Waters. Efﬁcient identity-based encryption without ran-
dom oracles. In Proceedings of Eurocrypt, 2005.
[47] Brent R. Waters, Dirk Balfanz, Glenn Durfee, and D. K. Smet-
ters. Building an encrypted and searchable audit log. In Pro-
ceedings of Network and Distributed System Security Sympo-
sium (NDSS), San Diego, CA, February 2004.
[48] Danfeng Yao, Nelly Fazio, Yevgeniy Dodis, and Anna Lysyan-
skaya. ID-based encryption for complex hierarchies with ap-
plications to forward security and broadcast encryption.
In
CCS ’04: Proceedings of the 11th ACM conference on Com-
puter and communications security, pages 354–363, New
York, NY, USA, 2004. ACM Press.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:54:17 UTC from IEEE Xplore.  Restrictions apply. 
2007 IEEE Symposium on Security and Privacy(SP'07)0-7695-2848-1/07 $20.00  © 2007