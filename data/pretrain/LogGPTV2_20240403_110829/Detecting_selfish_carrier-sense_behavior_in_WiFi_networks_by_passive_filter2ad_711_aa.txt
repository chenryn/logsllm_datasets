title:Detecting selfish carrier-sense behavior in WiFi networks by passive
monitoring
author:Utpal Paul and
Samir R. Das and
Ritesh Maheshwari
201O IEEEIIFIP 
International 
Conference 
on Dependable 
Systems & Networks (DSN) 
Detecting 
Selfish Carrier-Sense 
Behavior in WiFi Networks 
by Passive Monitoring 
Utpal Paul, Samir R. Das 
Ritesh Maheshwari 
Computer Science Department 
Stony Brook University 
Stony Brook, NY  11794-4400, USA 
{upaul, samir }@cs.sunysb.edu 
Akamai Technologies 
8 Cambridge Center 
Cambridge, MA 02142, USA 
rmaheshw@akamai 
.com 
Abstract 
With the advent of programmability 
in radios, 
it is be­
any asymmetry in carrier-sense  behavior  between 
Our approach is based on de­
nodes to cheat to obtain 
In this work we study 
a solution 
where a node raises 
for carrier­
threshold 
to 
(possibly 
ran­
network 
assessment) 
selfish carrier-sensing 
behavior 
or simply does not sense carrier 
coming easier for wireless 
an unfair share of the bandwidth. 
the widely used 802.11 protocol and present 
detect 
the CCA (clear channel 
sensing, 
domly to avoid detection). 
tecting 
node pairs andfinding multiple 
fidence. The approach is completely 
deploying 
wireless  traffic 
traces. 
using a machine learning 
relationships 
real testbed 
excellent 
estimate 
of selfishness 
detection 
selfish behavior 
observed. 
as well as ns2 simulation 
between network 
multiple 
closely 
ability. 
matches 
such witnesses 
passive. 
to raise con­
It requires 
sniffers across the network to capture 
These traces are then analyzed 
by 
approach to infer carrier-sense 
nodes. Evaluations 
using a 
studies 
demonstrate 
The metric of selfishness 
used to 
with actual degree 
Keywords: 802.11 protocol, 
layer misbehavior. 
Hidden Markov Model, MAC 
1 Introduction 
different 
With the advent 
of programmable 
radios, 
can be manipulated 
MAC 
in various 
ways to 
used 802.11 networks. 
wireless 
parameters 
share of the available 
and corresponding 
protocol 
gain an unfair 
The case in point is widely 
radio interfaces 
able that let the user choose the clear channel 
(CCA) threshold 
seting 
bandwidth 
denial 
advantage 
attack. 
anyone of these appropriately 
size [17]. Re­
can deliver 
a 
For example, a 
higher 
of service 
to a selfish 
drivers 
the backoff window 
device 
and/or 
node [17] or even launch 
are avail­
CCA thresh-
an unfair 
Several 
bandwidth. 
assessment 
force the other transmitters 
carrier 
disable 
in 
may 
sensing. 
and thereby 
Thus, the selfish 
opportunities. 
This can also 
node itself 
will be shorter 
carrier­
to backoff. 
a collision, 
While the selfish 
period 
the backoff 
its backoff counter 
with disabled 
old can effectively 
node gains more transmission 
cause collisions 
the vicinity 
also undergo 
as it will not freeze 
sensing. 
experiments 
how a selfish 
can gain a significant 
port layer protocol. 
node is able to gain at least 5Mbps throughput 
its fair share [17]. Similarly, 
smaller 
shorter 
gain from 
the backoff 
by backing 
setting 
advantage 
provides 
interval 
in [17] demonstrate 
throughput 
They also show that this kind of selfish 
window 
off for a 
The  authors 
for different 
Trans­
node with higher 
with extensive 
CCA threshold 
an unfair 
benefit 
The situation 
on average. 
is expected 
only to get worse with use of 
where any 
radios), 
manipulated 
or entirely 
software 
advantage. 
This 
techniques 
so 
While there are 
rules for use 
spectrum 
not enough 
that all radio de­
(e.g., 
efforts 
community 
can be easily 
the research 
etiquette 
fallow 
are used to gain bandwidth 
to develop 
can be detected. 
spectrum 
more sophisticated radios 
part of the protocol 
new protocols 
behooves 
that such selfish 
several 
by unlicensed 
such as DTV whitespace, 
e.g.), 
effort to 'police' 
the spectrum 
vices follow 
[23] (for accessing 
there are nearly 
to ensure 
or rule. 
of 'policing' 
behavior 
to develop 
devices 
a prescribed 
solution 
commodity hardware 
behavior 
problem 
scope of this paper. We specifically 
works, where available 
easily 
goal here is to detect 
itoring. 
mesh networks, 
and can 
detect 
be it a client 
Looking 
is equally 
regardless 
misbehavior 
point (AP). 
or access 
at the literature, 
as mentioned 
behaviors 
applicable 
allow for selfish 
The approach 
A general 
such selfish 
protocol 
of the topology 
on the part of any network 
node, 
and software 
Our 
before. 
via passive 
mon­
to WLANs and 
or architecture 
is outside 
the 
focus on 802.11 net­
bust approaches 
mechanism 
that can detect 
we find that there are several 
ro­
manipulation 
in 
of the backoff 
(see, e.g., DOMINO [21] and the discussions 
978-1-4244-7501-8/10/$26.
00 ©201O IEEE 
11 
DSN 2010: Paul et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:06:44 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEEIIFIP 
International 
Conference 
on Dependable 
Systems & Networks (DSN) 
asymmetric  carrier-sensing 
(Section 
of the CCA threshold 
2». However, detecting 
or completely 
is a much harder 
problem. 
In our knowl­
has been been addressed 
in only one recent 
disabling 
work section 
the related 
manipulation 
carrier 
sensing 
edge, the latter 
paper [l7] that provides 
work we only address 
a limited 
solution. 
Thus, in this 
the carrier 
sensing 
is as follows. 
issue. 
A distributed 
from the live network. 
set 
traces 
network 
collect 
to determine 
approach 
traffic 
making the 
are then 
learn­
any packets 
The traffic 
traces 
do not transmit 
using a machine 
be­
nodes. This  means 
Our general 
of 'sniffers' 
These sniffers 
method completely 
unobtrusive. 
merged [25, 16, 8] and  analyzed 
ing technique 
havior between 
a given pair of nodes, 
one is sensing 
rier, but not vice versa. Our general 
significant  asymmetry 
sists long-term 
-points to selfish behavior
metry may be very unusual 
nel/interface 
effects. 
behavior 
tect selfish 
network. 
While the 
background 
by multiple 
other nodes 
. This is because 
such asym­
due to normal wireless 
chan­
and can 
nodes in the 
it can run on the 
behavior. 
Our technique is 
general 
on the part of multiple 
technique is 
off-line, 
selfish 
the other node's 
car­
is that 
assumption 
-when witnessed 
de­
in favor of a specific node that  per­
that between 
passive, 
network 
it is dependent 
for ana­
traffic 
in this 
case is 
The challenge 
of little 
even (i) in presence 
nature, 
or (ii) 
probabilistic 
that exhibit 
identification 
of unknown and arbitrary 
Since the approach is 
to detect 
periodically 
completely 
of the available 
and traffic 
behavior. 
carrier-sense 
on the sufficiency 
lyzing 
to make accurate 
traffic, 
for selfish 
behaviors 
issues 
the merged traces 
nique to a varying degree. 
However, 
issues 
not have chance to address 
node implementations 
to avoid detection. 
to the location 
that will impact 
and have been discussed 
these issues 
related 
There are indeed many other 
and fidelity 
of the sniffers 
of 
the accuracy 
of the tech­
these are independent 
in related 
literature. 
paper. 
We will 
in the current 
as follows. 
We will 
The rest of the paper is organized 
work in Section 
II and the broad approach 
discuss  related 
III. The details 
in Section 
will be covered 
in Section 
mental 
in Section 
VI. 
and simulation-based 
of the HMM-based 
IV. Sections 
evaluations. 
V has the experi­
We will conclude 
formulation 
2 Related Work 
2.1 Detecting MAC-Layer Misbehavior in 
802.11 
a 
et al. [5] de­
Cagalj 
the sender 
approach 
to a Pareto­
Konoroski 
buted protocol 
the deviation 
from being selfish. 
[13] also proposes 
using a game theoretic 
Nash equillibrium. 
from the ideal backoff 
mech­
a technique 
Ratio Test (SPRT) to identify 
All these above mentioned 
to restrict 
velop a distri 
that leads the selfish nodes in the network 
optimal 
scheme to detect 
anism. Radosavac 
[19] uses 
tial Probability 
of misbehavior. 
with the selfishness 
ulation. 
which can detect 
DOMINO can detect 
the bandwidth 
smaller 
ing oversized 
riod of time. It also can detect 
greedy nodes. But DOMINO cannot 
ior by 
the carrier 
say whether 
'scrambled 
sending 
from greedy 
nodes that try to get larger 
stations. 
share of 
frames,' or using a 
DATA packets, 
NAV to have the medium idle for a longer 
by the 
by sending 
before 
based on Sequen­
the same kind 
only deal 
manip­
DOMINO 
studies 
of a node doing only by backoff 
and implement 
backoff manipulation 
any misbehav­
that is, it cannot 
a node is overhearing 
Raya et al. [21] propose 
misbehaviors 
a node regarding 
DIFS period 
or us­
pe­
certain 
detect 
The above approaches 
detect 
sensing, 
the carrier 
mani pulation 
intentionally. 
of the backoff 
to our work. Detect­
behavior, 
however, 
may be hard. In our knowledge, 
The authors 
recognize 
harder 
effects. 
this issue. 
behavior 
Thus, identi­
For example, 
problem. The 
reason 
that a node may simply 
in the neighborhood 
They can be complementary 
of the carrier-sense 
that the selfish 
is unlikely 
from the AP as legitimate 
node that has in­
to correctly 
pack­
is 
for this is that it 
fail to detect 
ongo­
due to normal wire­
power may 
behavior. 
ing manipulation 
a considerably 
is quite possible 
ing transmissions 
the received 
less channel 
simply be below the normal CCA threshold. 
fying abnormal 
only one paper [17] has addressed 
here make the assumption 
creased 
its CCA threshold 
low power transmissions 
ets. Thus, by sending 
tentially 
detect 
assumption 
CCA threshold 
as noise. 
However, 
ply changing 
packet 
ter the transmission.
transceiver 
packet 
dependent 
radio implementation, 
carrier 
all together 
to avoid detection. 
passive. 
may interfere 
In addition 
transmission of 
is designed, 
of the CCA threshold. 
carrier 
the proposed 
back to the normal threshold 
right af­
! Also, depending 
reception 
on how the radio 
success 
For example, 
node may simply 
as such packets 
can avoid detection 
such nodes. This technique 
the AP can po­
makes a 
probes 
traffic. 
that packet reception 
the CCA threshold 
with normal network 
with power lower than 
low power probes, 
is not possible, 
and reverting 
the attacker 
only when 
It requires 
the selfish 
or senses 
sensing 
strong 
may not be 
by sim­
turn off 
are treated 
in a software 
it transmits 
a 
probabilistically 
technique 
is not 
by the APs. This 
Much ofthe work in literature 
of the backoff behavior 
manipulation 
marize 
them in the following. 
only attempts 
to detect 
the 
in 802.11. We sum­
Kyasanur 
the receiver 
and Vaidya [14] propose 
directly 
a mechanism 
value to the sender 
the backoff 
specify 
where 
issue that can slow down the selfish 
For example, 
a register 
write to the 
iThere may indeed be a latency 
node if such changes are frequent. 
interface 
made, etc. But we do not consider 
the increasing 
serious 
is implemented 
efficiency 
in a software radio platform. 
card must happen, or a call to the firmware using an API must be 
of the radio hardware 
the latency 
this to be an fundamental 
issue. With 
may not be any 
issue. Also, there is no reason for any latency 
if the MAC protocol 
978-1-4244-7501-8/10/$26.00 
©201O IEEE 
12 
DSN 2010: Paul et al. 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:06:44 UTC from IEEE Xplore.  Restrictions apply. 
2010 IEEEIIFIP 
International 
Conference 
on Dependable 
Systems & Networks (DSN) 
2.2 Use of Distributed Sniffers 
Previous 
studies 
a range of measurements 
have also used distributed 
sniffers 
over live networks 
to 
to 
in a hotspot 
properties 
setting 
conduct 
learn various 
behavior 
system also uses 
and security 
pear in Section 
technique 
unlike 
unified trace. 
focus is on identifying 
selfish 
network 
using the merged trace. 
[2]. More details 
However, 
similar 
such as congestion 
[10], protocol 
[22, 8, 16], etc. The DAIR 
such an approach 
for troubleshooting 
on similar 
related 
[1] 
works ap­
II-B of [11]. In this paper, 
we employ a 
into a 
traces 
to [25] to merge individual 
our 
studies, 
sense behavior 
in the 
all the previous 
carrier 
cause deferral 
consideration 
multi­
however, 
For example, 
may actually 
Also, in reality 
more 
enough power to cause deferral, 
be quite powerful 
packet 
may still 
transmissions 
pairwise 
However, 
interference). 
in practice. 
generate 
ple such concurrent 
(physical 
can still 
transmissions 
be 
than two concurrent 
rare even when there are many simultaneous 
active 
flows 
in the network. 
during 
showed that only 
transmission. 
relationships 
nodes. 
tal to our basic technique. 
albeit 
ence. 
the SIGCOMM 2004 conference, 
actually 
order 