# OCR Output
## Page 1
TURING
SE
图灵程序
设计丛书
SQL进阶教程
[日]MICK/著吴炎昌/译
DB2
Oraele
进阶中级实用指南
MySQL
挖掘SQL常见技术的新用法
PostgresQL
基于标准SQL编写
示例程序均可下载
SQL ServeY
中国工信出版集团
人民邮电出版社
POSTS & TELECOM PRESS
---
## Page 2
1101010101010010
D101010010101
00001010101
0010101000
10110101
01010001
10010100
0001010
数字版权声明
1101010
0010101
010101
1010101010011
000010
1010010101100
101101
01010001111101
010010100101001001
010100
1001010
010100101010010
0001010
101010101011001000
图灵社区的电子书没有采用专有客
11010101010100101010010
户端，您可以在任意设备上，用自
010101001010101010109
0000101
0100101
1011010
0001
已喜欢的浏览器和PDF阅读器进行
010100010
1001
阅读。
010
1001010001
1010
0001010101010101011001
1100
11010101010100101010010100
但您购买的电子书仅供您个人使用
01010100101010101010011001
0000101010101001010110010
未经授权，不得进行传播。
10110101101010001111101110
0101000101002
1001010001010
我们愿意相信读者具有这样的良知
0001010101010101011001000
11010101010100101010010100
和觉悟，与我们共同保护知识产权。
01010100101010101010011001
0000101010101001010
M010010
1011010110101000111
0101000101001010010100
100-0100010100
如果购买者有侵权行为，我们可能
0001010101010101011001000
1101010101010010101001010
对该用户实施包括但不限于关闭该
0010100
010101001010101010100110
帐号等维权措施，并可能追究法律
00001010101010010101100
1011010110101000111
责任。
111010
01010001010010100
11010010
10010100010100101010010
01010010
000101010101010101100 000
G01010010
11010101010100101010010100
1001001011
0101010010101010101001100110
000010101010
001010
100:0111
101010101010
1011010110
10100011
1011101110
10101011010101
0101000
0001001
01001010100001010010101
10010
01001010
001
10111110011000000001010
010101010
1000101
00101001010010
0101001010
01010010
0100100100100
---
## Page 3
MICK
日本知名数据库工程师，就职于SI企
业，致力于数据仓率和商业智能的开发。
日常除了在其个人主页“关系数据库的世
界”中分享数据库和SOL的相关技术信息
外, 还为§CodeZine ( http://codezine.(p )
及IT技术杂志WEB+DBPRESS撰写相关
技术文章。同时还是Joe Celko《SOL解
感（第2版）》和《SQL权威指南（第4
版）》日文版的译者。
吴炎昌
毕业于西北工业大学软件工程专业。
曾供职于日本多家软件公司，从事系统开
发工作。2015年回国后加人美团点评，
现任系统研发工程师。爱好旅行、电影，
以及品尝各种美食，有一位志趣相投的
伴侣。
---
## Page 4
TURING
圆灵程序
设计丛书
SQL进阶教程
[日]MICK/著吴炎昌/译
DB2
Oraele
MysoL
postgresal.
SQLServer
人民邮电出版社
北京
---
## Page 5
图书在版编目（CIP）数据
SQL进阶教程/（日）MICK著：吴炎昌译.--北京：
人民邮电出版社，2017.11
（图灵程序设计丛书）
ISBN 978-7-115-47052-2
1.①SII.①M②吴III.①关系数据库系统
数材IV.①TP311.138
中国版本图书馆CIP数据核字（2017）第253141号
内客提要
本书是《SQL基础教程》作者MICK为志在向中级进阶的数据库工程师编写的一本SQL技能提升指南。
全书可分为两部分，第一部分介绍了SQL语言不同寻常的使用技巧，带领读者从SQL常见技术，比如
CASE表达式、自连接、HAVING子句、外连接、关联子查询、EXISTS-去探索新发现。这部分不仅穿插
讲解了这些技巧背后的逻辑和相关知识，而且辅以丰富的示例程序，旨在帮助读者提升编程水平：第二部
分着重介绍关系数据库的发展史，把实践与理论结合起来，旨在帮助读者加深对关系数据库和SQL语言的
理解。此外，每节末尾均设置有练习题，并在书末提供了解答，方便读者检验自已对书中知识点的拿握程度。
著
[日]MICK
译
吴炎昌
责任编辑杜晓静
执行编辑
高宇涵
侯秀娟
责任印制彭志环
人民邮电出版社出版发行
北京市丰台区成寿寺路11号
邮编100164
电子邮件PI:EMAIL
北京
印刷
开本：800×10091/16
印张：19.5
字数：455千字
2017年11月第1版
印数： 1-4 000 册
2017年11月北京第1次印刷
著作权合同登记号图字：01-2016-4463号
定价：79.00元
读者服务热线：（010)51095186转600印装质量热线：(010)81055316
反盗版热线：(010)81055315
广告经营许可证：京东工商广登字20170147号
---
## Page 6
译者序
我曾在日本从事多年软件开发工作，工作中经常会跟各种数据库打交道，编写SQL代码也是常
有的事情。但是对于SQL语言，当时也只是通过大学里的一门讲投数据库系统的课程了解了基本的
语法，在工作中积累了一些实用的经验而己，并没有进行过非常深入的研究。于是我使打算找一本
深入一些的书，最好是面向有一定编程经验的读者的，系统地学习一下。
后来我在书店遇见了MICK先生的这本书，翻看前言，尝试了他提出的检验读者水平的若干
问题。非常遗撼，我只能回答出很少的几个，于是我使认为这本书正是我需要的，当场决定买下了。
几年过去，我由于个人原因回国了，工作中也不再使用日语，使想着借着业余时间翻译一些优
秀的日语技术书，当图灵公司的老师问我是否有意向翻译这本书时，我立刻就答应了。当初回国时
为了缩减行李，我只保留了几本日语原版的技术书，这本就是其中之一。这样一本多年前结缘、至
今仍骗在我书架上的好书，当有机会将它翻译成中文欣时，我实在没有什么理由放并掉。
这本书，我认为是作者的用心之作。书中大部分内容都来自作者记录自己实践总结和日常思考
的个人博客，最大的特点是理论与实践相结合，除了讲述应该怎么做，还解释了其背后的原理。全
书包含两部分内容，第一部分介绍了SQL在使用方面的一些技巧，第二部分介绍了关系数据库相关
的内容。第一部分在介绍SQL的技巧时，作者并没有上来就展示各种酯炫的招式，而是先以简单的
间题或者例题引出将要讨论的内容，在讲解之后进一步扩展，由点及面地引出史深的话题或者背后
的原理。这种由浅入深的讲述方式，符合一般的学习习惯，读者能在轻松愉悦的阅读过程中，跟着
作者一起思考，自然而然地掌握相应的思考方式。第二部分在介绍关系数据库时，作者先介绍了关
系数据库诞生的历史背景及其解决的问题。关系数据库已经诞生了儿十年，为了让现在的读者理解
当初的间题和背景，作者大量引用了关系数据库之父E.F.Codd和关系数据库领域权成专家C.J.Date
的文献和言论，并按自已的理解给出了分析与解释，力图使读者体会到伟大人物们在革新技术之际
的心路历程。除此之外，第二部分中作者还从逻辑学和集合论的角度讲述了SQL和关系模型的理论
基础。该部分内容作者充分发挥了自已在相关领域的深厚积累，以深入浅出的方式进行了闸述，我
认为非常精彩。
书中引用了许多经典的图书和文献，都在脚注和书末参考文献中给出了详细的出处，方便有需
要的读者进一步研读。更加可贵的是，在大多数小节的末尾作者都提出了两三个精心设计的小问题，
---
## Page 7
详者汽
这些问题是正文内容的扩展和延伸，非常利于读者巩固相应的知识点。而且，针对这些间题，作者
也给出了详细的解答，并指出了读者容易犯的错误。
本书推荐数据库工程师、经常需要和数据库打交道的软件工程师，以及所有希望提升SQL水
平的读者阅读。在翻译过程中，我尽力表达出原著的意图，但是由于水平有限，难免存在间题，欢
迎读者批评指正。读者在阅读中有任何间题，都可以通过电子邮件和我取得联系（ensho_go@
hotmail.com)。
2017年9月
于北京
图灵社区会员非洲铜（PI:EMAIL）专享尊重版权
---
## Page 8
前言
编写本书的目的在于架起两座桥梁：一是让数据库工程师从初级向中级进阶的桥梁，旨在帮助
初级工程师提升自己：二是理论（原理）和实践之间的桥梁。这里所说的“初级”，具体是指已经掌
握了SQL的基础知识和技能，具有半年到一年左右的使用经验这种水平。
我们来做一个测试，帮助大家了解一下自己处于何种水平。下面有10个问题，请回答Yes或No。
1.没有在聚合函数中使用过CASE表达式。
2.想象不出自连接是如何工作的。
3.感觉HAVING 子句不是很常用。
4.感觉IN比 EXISTS 好用，所以更喜欢用IN
5.听到布尔类型，脑海里浮现出的只有true 和false。
6.设计表的时候不加NOTNULL的约束。
7.SQL全部用大写字母或全部用小写字母来写。
8.不能用一句话说出 GROUPBY和PARTITION BY的区别。
9.不知道SQL里的高阶函数的名字。
10.试着读过JoeCelko的《SQL权威指南》和《SQL解惑（第2版）》，但是感觉太难而没能读
完（或者压根儿没有读过）。
大家的回答如何呢？如果全部都回答了No，那很好，不要担心什么，请合上本书，立刻踏上成为
一名高级工程师的道路吧（也许只有本书3-2节“参考文献”值得略读一下）。相反，如果一半以上都
回答了Yes，那么本书将照亮大家的前进之路一—这正是编写本书的目的，相信大家读后一定会有收获。
但是，接下来要说的内容可能会让大家觉得有点前后矛盾。因为，这本书即将介绍的技术绝不
是多么新潮的东西，而是遵循标准SQL的非常普通的技术。关于这一点，相信扫一眼目录你就会明白。
CASE表达式、自连接、HAVING子句、外连接、关联子查询、EXISTS"这些都是数据库工程师日
常工作中经常用到的技术。
①原书名为 Joe Celko's SQL for Smartiex: Aahvanced SQL Programming。本书其有五版。国内引进了第 4版,
书名为《SQL权威指南（第4版），朱魏等译，人民邮电出版社，2013年。——编者注
2末全喜译，人民邮电出版社，2008年4月。——编者注
---
## Page 9
编写本书的目的就是从新的角度把光照向这些“并没有什么特别的、谁都知道的技术”，照亮它
们迄今都没有被看到的一面。相信大家读完本书时，会从那个一直以来都被认为平淡无奇的关系数
据库的世界里，看到一些不一样的光辉。
下面，就让我们立刻前往博大精深的关系数据库的世界，开始探险之旅吧。
声明
亲本书中的URL等信息可能会有变化。
亲本书出版之际，我们力求准确闸述，但是翔泳社、原书作者、人民邮电出版社和译者均不对内客作任何保