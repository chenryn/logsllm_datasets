## Page 425
网络安全进阶笔记
9.1举一反三学习编程语言
现实中，可能经常有人会问你，你知道××语言吗？如果你不知道，千万不要感到郁闷。
因为，人的价值不在于你知不知道，面是你知道后，做些什么。把现有的实用的语言掌握好，
研究深入一些比什么都重要。对于网络安全读者来说，完全可以选择一门语言，循序渐进地提
高这方面的技能。结合日常的网络安全管理工作，利用这些语言来解决比较常见的问题。实用
才是硬道理，这里首先选择了Microsof公司推出的VisualStudioNET开发平台进行讲解。
Visual StudioNET是套家族产品，包含了Visual Basic.NET、Visual C++NET、Visual C#NET
和VisualJNET，它们全都使用相同的集成开发环境（IDE），该环境允许它们共享工具并有助
于创建混合语言解决方案。
作为VisualStudio.NET的经典组件之一，VisualBasic.NET（以下简称为VB.NET）是
Microsoft 的下一代Visual Basic 语言。Visual BasicNET将Visual Basic 的性能和效率又向前推
进了一大步，它能够快速生成.NET应用程序，包括Windows应用程序和ASP.NET Web应用
程序。最重要的是，VB.NET还是一种真正的面向对象开发语言，更偏重于快速开发，在继承、
接口和重载等方面功能更加强大，这些都使VBNET成为功能强大的面向对象的编程语言。
这里选择Visual Basic.NET2005版，它具有高效、卓越的性能，直观的界面，使得非专业开
发人员和编程初学者易于上手。
9.1.1了解语言的框架
兴趣是最好的老师。由于以前版本不完全支持面向对象的环境，使得VisualBasic应用受
到一定限制。随着Visual Studio.NET的推出，VB.NET简单易学、开发效率高和开发周期短
等优势进一步发挥出来，这也使它深受广大软件开发人员的喜爱。如今，它已经成为一个真正
的面向对象的语言，具有了支持继承、派生、重载等一切面向对象的特性。
1.读懂.NET的框架结构
.NET是一个多语言开发环境和运行环境，用来开发、发布以及运行Web服务和应用程
序。.NET的最终目的就是让用户在任何地方、任何时间，以及利用任何设备都能访间所需的
信息、文件和程序。用户不需要知道这些文件放在什么地方，只需要发出请求，然后只管接收
就可以了。面所有后台的复杂操作是完全屏蔽起来的，.NET框架是VB.NET存在的前提和基
础，也是.NETFramework是用于生成、部署和运行XMLWebServices与应用程序的多语言环
境。NET框架主要由3个部分组成，分别是公共语言运行库、NET框架类库和用户层，如图
9.1所示，
(1）公共语言运行环境（CommonLanguageRuntime，CLR)。CLR是为了解决各种不同编
程语言之间相互调用的问题而设计的。该层提供.NET所需要的基本服务，如内存管理、垃圾
收集、结构化异常处理和多线程。CLR是.NET框架之中一切内容的基础，它同时也是.NET框
架的第二个核心部分—.NET框架类库的基础。
420
---
## Page 426
三
第9章举一反三学语言：以.NET为例
公共语言运行环境（CLR）
NET框架基础类库（BCL）
WT8服务
ASP.NET
ASPNET智体
Windows窗体
XML
图9.1.NET框架的整体结构
在NET框架中，不管使用何种语言编写的托管代码，首先都会被编译成微软中间语言
（IntermediateLanguage，IL)。然后，IL会被编译为目标平台的机器代码。不过，在某种程度上，
CLR就相当于Java语言的虚拟机。有了CLR，即使开发者使用不同的语言，也可以很方便地
进行存取，如图9.2所示。
在不网的CPU上运行
第二次编译
CLR
微款中间言
（MSIL）程/序（EXE）
第一次编泽
BCL
ASPNETR
应用程序
VB.NET
VC++NETVC#NETVJ#NET
图9.2.NET框架的工作原理
(2）.NET框架基础类库（BaseClassLibrary，BCL）。BCL提供了一套统一的、面向对象的、
分层的和可扩展的类库，给不同编程语言之间的相互调用提供了方便。该层是.NET框架的一
部分，它定义了所有的基本数据类型，如System.Object（它是.NET对象层次结构中的基类型）
数值类型、日期类型、字符串类型、数组和集合.BCL还包含了一些类，用来管理.NET核心
功能，如文件输入/输出、线程、序列化和安全性，BCL由命名空间组成，每个命名空间都包
含可在程序中使用的类型，如类、结构、枚举、委托和接口。
（3）用户层。基于.NET的程序开发主要分为Windows应用程序和ASP.NETWeb应用程
序两部分。在Windows应用程序开发中，窗体和控件是建立应用程序的基本元素。窗体就是
应用程序的界面，有了界面之后，还要在窗体上放置控件，如在使用Windows过程中常见的
按钮、单选框和复选框等。界面建立好之后，还需要添加相应的代码来实现某些功能，从而建
立一个完整的Windows应用程序。ASPNET包括可用于封装通用HTML用户界面元素（如文
本框、按钮和列表框）的一组控件，这些控件在Web服务器上运行后，会以HTML的形式显示
在浏览器中。
总之，Visual Stadio.NET把VB.NET、VC++NET和VC#都集成在一起，启动的都是
个程序。所有基于这些语言的编程都可以使用VisualStudioNET所提供的工具和功能，如集
421
---
## Page 427
网络安全进阶笔记
成开发环境(Integrated Development Environment，IDE)的所有设计器、工具窗口以及集成帮助
系统。
2.熟悉最常用语言的特点
VB.NET之所以受到很多用户的青，在于其丰富而实用的诸多特点。
（1）方便直观的IDE开发环境与更加严格的面向对象特性。VB.NET采用与VC++.NET、
VCWNET相同的集成开发环境，整体界面更加直观，操作更加方便。同时，在.NET框架的基
础上，VB.NET引入了更严格的面向对象特性，如封装、继承、多态性和可重载性等，真正实
现了面向对象的程序设计。
(2）数据类型更丰富，类型转换更安全。依靠.NET框架的支持，VB.NET程序儿乎可以
获取Windows提供的所有功能。VB.NET将数据类型定义成类，数据类型本身也具备了数据
处理的能力.同时，在变量的类型转换上，VB.NET非常灵活，它能自动将数值转换成字符串
打印出来，并且还有很多类似的功能。
（3）为应用程序访间Intemet提供了分层的、可扩展的以及受管辖的网络服务。VB.NET
名字空间System.Net和 System.Net.Sockets 包含了丰富的类，可以开发多种网络应用程序。例
如，在.NET框架的System.NET.Sockets命名空间里包含了NetworkStream类，专门提供用于
网络访问的基础数据流、TcpClient类则专为客户端设计，它为TCP网络服务提供客户端连接，
创建连接时，只要选用TepClient类的构造函数即可。
（4）支持全面的Web应用程序开发。VisualStudio.NET提供了一个全新的网页设计器
(VisualWebDeveloper)，其中包含了许多用于创建和编辑ASP.NET网页和HTML页的增强功
能。该设计器提供了比在Visual Studio.NET2003中更简单、更迅速的Web窗体页创建方法。
因此，基于.NET框架的VBNET在动态页面开发方面也更加得心应手。
（5）数据访问更加便捷。所请数据访问，狭义而通俗地说就是访问数据库的技术和手段。
在VB.NET中，使用的数据访问技术为ADO.NET。在ADO.NET中，使用Connection对象
建立与特定数据源的连接，使用Command对象提供对数据源执行命令的访问，DataSet（数据集）
类则是从数据源中检索到的数据在内存中的缓存，即可以保存所查询到的数据记录。
（6）更加规范化的错误处理方法。在VB.NET中，用Try、Catch和EndTry等关键字，
替代OnErrorGoto语句.在Try和Catch之间的代码段将会被保护。如果有错误出现了，Catch
代码段会立即运行：在Catch代码段运行结束后，模块内的代码就做错误处理结束后的清除和
收尾工作。
（7）更容易编辑XML和创建XML架构.XML可扩展标记语言（eXtensibleMarkup
Language，XML）是一种类似于HTML的用来描述数据的标记语言，它提供了描述结构数据的
方法。VisualStudio.NET依赖于XML来通过Web保存、发送和接收数据，并且在应用程序
之间通信。万维网联合会（W3C）定义了XML标准以使结构化数据保持统一并独立于应用程序。
（8）更加实用的自由线程。线程是一个复杂的概念，可理解为程序能在同一时间段内敬两
件以上的事情。VB.NET能以一种相对简单的形式提供以上服务。这样，VB.NET在创建具有
高度扩展性服务端程序的时候很实用，并且利用线程编写交互性用户界面也十分容易。
（9）更加高效的团队开发。VisualStudio2005TeamSystem是一个高效、集成且可扩展的
软件开发生命周期工具平台，可以帮助软件团队提高整个软件开发过程中的通信和协作能力。
422
---
## Page 428
第9章举一反三学语言：以.NET为例
同时，所有的Visual Studio语言都共用同样的IDE、同样的窗体引、同样的异常处理机制，
对于提高工作效率有很大的帮助。
（10）更加方便的My命名空间。My是一个极为出色的设计，可以帮助开发人员快速利
用.NETFramework中的各种功能进行开发。通过My命名空间，它将.NETFramework中最常
用的功能挑出来，然后按照最容易理解的逻辑结构存放在一起，大大提高了开发效率。
当然，这里只是列举了一些常见的新功能，实际应用中，VB.NET新颖简单的开发界面、
强大实用的数据功能，以及高效全面的过程管理等，都是获得用户选择的重要原因。
9.1.2熟悉安装和配置过程
许多开发工具的安装大同小异。VB.NET的安装和配置包含在整个Visual StudioNET的
安装和配置中。在安装VisualBasic.NET之前，必须先检查计算机是否满足系统要求，并阅读
安装盘根目录下的readme.htm自述文件。VisualStudio.NET集成开发环境集成了设计、编辑、
编译和调试等多种功能，并支持VisualStudio语言（VB、C++、C#、Jm），使用十分方便。如果
程序比较简短，也可以利用记事本等文本编辑器创建部分或者全部的.NET应用程序，然后通
过命令提示窗口调用合适的编译器来编译应用程序。
1.进入和退出开发环境
要进入VB.NET集成开发环境，首先要启动整个VisualStudio开发环境，执行Windows任
务栏上“开始”“程序”“Microsof Visual Studio 2005”“Microsoft Visual Studio 2005"
命令，即可打开“选择默认环境设置”对话框，如图9.3所示。
Visual Studio2o
图9.3选择默认环境设置
对话框的参数如下。
·TeamTest设置：从列表中选择一个设置集合。
VisualBasic开发环境：此设置集合包含对窗口布局、命令菜单和键盘快捷键的自定
义，使得对常用Visual Basic命令的访问更加容易。
·VisualC开发设置：对环境进行自定义，可将代码编辑器的屏幕最大化，并改善特定
---
## Page 429
网络安全进阶笔记
C=命令的可见性。
·常规开发环境：配置与VisualStudio.NET2003类似的环境，给用户提供熟悉的工作
方式。如果使用多种语言开发，可以选择此设置集合。
考虑大多数用户的使用习惯，这里选择“常规开发环境”选项，单击“启动VisualStudio”
按钮，即可打开“起始页”窗口，如图9.4所示。作为IDE的默认测览器主页，在“起始页”
标题新闻”等栏目。在“最近的项目”中，显示有最近修改的项目的名称。通过打开现有项目
或创建新项目即可进入VB.NET集成开发环境。
Seppliciet-HierettVind Stee
VisualStuc
图9.4Visual Studio起始页
退出VB.NET集成开发环境，首先要保存当前文档，然后单击VB.NET窗口右上角的“关
闭窗口”按钮，或者直接选择“文件”“退出”命令。
2.VB.NET集成开发环境构成
MicrosofVisual Studio是以项目为单位开发的，通常一个项目对应一个应用程序。要新建
一个VB.NET的Windows应用程序，首先要进入VB.NET集成开发环境。启动VisualStudio
该对话框中，选择项目类型为“VisualBasic项目”，选择模板为“Windows应用程序”，然
钮后，即可新建一个项目，如图9.5所示。
在VBNET集成开发环境中主要有标题栏、菜单栏、工具栏、解决方案资源管理器、类
视图、窗体设计器、代码编辑窗口、工具箱和属性窗口等，如图9.6所示，这些都是集成开发
环境的重要组成部分，下面分别进行介绍。
（1）标题栏。标题栏左边的标题为WindowsApplicationl-Microsof Visual Studio，其中
钮和“关闭”按钮。
（2）菜单栏。VB.NET的菜单栏主要提供软件使用的所有命令及设置，包含“文件”、“编
424
---