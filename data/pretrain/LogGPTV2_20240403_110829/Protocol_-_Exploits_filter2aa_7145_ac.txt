    nmap -p 25 --script smtp-enum-users.nse xxx.xxx.xxx.xxx
    ```
**邮件伪造**
- 相关文章
    - [关于伪造邮件的简单研究](https://hex.moe/p/4878b295/)
- SPF邮件伪造
    SPF 是 Sender PolicyFramework 的缩写，一种以 IP 地址认证电子邮件发件人身份的技术。接收邮件方会首先检查域名的 SPF 记录，来确定发件人的 IP 地址是否被包含在 SPF 记录里面，如果在，就认为是一封正确的邮件，否则会认为是一封伪造的邮件进行退回。SPF 可以防止别人伪造你来发邮件，是为了防范垃圾邮件而提出来的一种 DNS 记录，它是一种 TXT 类型的记录。
    由于 SMTP 邮件服务商互相发送邮件是不需要认证的，邮件伪造也是利用这个特性来实现伪造任意发件人。
- 简单方法
    ```
    telnet xxx.xxx.xxx.xxx 25
    HELO xxxx.com   # 向邮件服务器提供连接的域名,也就是邮件将从哪台服务器发来.
    MAIL FROM:PI:EMAIL  # 伪造管理员身份来发邮件
    RCPT TO:PI:EMAIL # 验证邮件地址是否存在.如果查询的是一个真实的 Email 地址,邮件服务器就会返回250状态码.验证邮箱存在的话,还可以给这个接受者邮箱发送邮件.
    DATA    # 使用DATA命令来伪造邮箱内容,客户端告诉服务器自己准备发送邮件正文
    354 go ahead, end data with CRLF.CRLF   # 服务器返回354,表示自己已经作好接受邮件的准备
    "这是一个邮件伪造测试"  # 用英文状态的双引号来修饰正文,正文结束后,发送结束符.表明正文的结束.
    .
    QUIT
    ```
- **swaks**
    Swaks 的全称是 Swiss Army Knife SMTP(SMTP 界的瑞士军刀),用于测试 SMTP 协议的各种操作.
    kali 自带
    ```bash
    swaks
    ```
    配合 https://support.smtp2go.com/hc/en-gb
    ```bash
    swaks --to 目标@qq.com --from PI:EMAIL\
    --header-X-Mailer SMTP  --ehlo PI:EMAIL --body 'test'\
    --server mail.smtp2go.com -p 2525 -au 账号 -ap 密码 \
    --attach /shell.docx --header "Subject:test" \
    --h-From: 'test'
    ```
---
## SNMP
**相关文章**
- [SNMP 协议攻击](https://xz.aliyun.com/t/1562)
- [渗透测试中如何收集利用 SNMP 协议数据](https://www.freebuf.com/articles/network/104522.html)
**相关工具**
- [trailofbits/onesixtyone](https://github.com/trailofbits/onesixtyone) - SNMP 扫描器是一个程序，它向多个 IP 地址发送 SNMP 请求，尝试不同的团体字符串并等待回复。
- [dark-lbp/snmp_fuzzer](https://github.com/dark-lbp/snmp_fuzzer) - 检测工控设备 SNMP 问题的工具
- [hatlord/snmpwn](https://github.com/hatlord/snmpwn) - An SNMPv3 User Enumerator and Attack tool
**snmp 弱口令**
- 相关文章
    - [烂泥:使用 snmpwalk 采集设备的 OID 信息](https://www.ilanni.com/?p=8408)
    - [snmp 弱口令引起的信息泄漏](http://drops.xmd5.com/static/drops/tips-409.html)
- 利用
    安装 `yum -y install net-snmp-utils`
    Usage
    ```bash
    snmpwalk -v 2c -c public 192.168.xxx.xxx
    snmp-check 192.168.xxx.xxx -c public -v 2c
    ```
---
## SSH
**相关文章**
- [SSH Pentesting Guide](https://community.turgensec.com/ssh-hacking-guide/)
**相关工具**
- [arthepsy/ssh-audit](https://github.com/arthepsy/ssh-audit) - SSH服务器审计（banner、密钥交换、加密、mac、压缩、兼容性、安全性等）
**版本扫描**
```bash
use auxiliary/fuzzers/ssh/ssh_version_2
set RHOSTS [ip]
run
```
**libSSH**
- **CVE-2018-10933 libSSH 认证绕过漏洞**
    - 概述
        libssh版本0.6及更高版本在服务端代码中具有身份验证绕过漏洞。 通过向服务端提供SSH2_MSG_USERAUTH_SUCCESS消息来代替服务端期望启动身份验证的 SSH2_MSG_USERAUTH_REQUEST消息，攻击者可以在没有任何凭据的情况下成功进行身份验证。 进而可以进行一些恶意操作。
    - 相关文章
        - [libSSH 认证绕过漏洞(CVE-2018-10933)分析](https://paper.seebug.org/720/)
        - [libssh CVE-2018-10933 身份验证绕过漏洞分析报告](https://www.anquanke.com/post/id/162225)
    - POC | Payload | exp
        - [blacknbunny/CVE-2018-10933](https://github.com/blacknbunny/CVE-2018-10933)
        - [leapsecurity/libssh-scanner](https://github.com/leapsecurity/libssh-scanner)
**OpenSSH**
OpenSSH（OpenBSD Secure Shell）是 OpenBSD 计划组的一套用于安全访问远程计算机的连接工具。该工具是 SSH 协议的开源实现，支持对所有的传输进行加密，可有效阻止窃听、连接劫持以及其他网络级的攻击。
- **CVE-2015-5600 Openssh MaxAuthTries限制绕过漏洞**
    - 概述
        OpenSSH 6.9 及之前版本的 sshd 中的 auth2-chall.c 文件中的‘kbdint_next_device’函数存在安全漏洞，该漏洞源于程序没有正确限制处理单链接中的 keyboard-interactive 设备。远程攻击者可借助 ssh -oKbdInteractiveDevices 选项中较长且重复的列表利用该漏洞实施暴力破解攻击，或造成拒绝服务。
    - 相关文章
        - [Openssh MaxAuthTries限制绕过漏洞(CVE-2015-5600)的研究与验证](http://tinyfisher.github.io/security/2016/06/06/CVE_2015_5600)
- **CVE-2018-15473 OpenSSH 用户枚举漏洞**
    - 概述
        OpenSSH 7.7 及之前版本中存在信息泄露漏洞。该漏洞源于网络系统或产品在运行过程中存在配置等错误。未授权的攻击者可利用漏洞获取受影响组件敏感信息。
    - 影响范围
        - OpenSSH 7.7及其以前版本
    - 相关文章
        - [OpenSSH用户枚举漏洞(CVE-2018-15473)分析](https://www.anquanke.com/post/id/157607)
        - [SSH用户枚举漏洞(CVE-2018-15473)原理学习](https://www.cnblogs.com/KevinGeorge/p/9530835.html)
    - POC | Payload | exp
        - [trimstray/massh-enum](https://github.com/trimstray/massh-enum)
        - [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)
    - MSF 模块
        ```bash
        use auxiliary/scanner/ssh/ssh_enumusers
        set rhosts [ip]
        set USER_FILE [aaa.txt]
        run
        ```
- **CVE-2020-15778 OpenSSH命令注入漏洞**
    - 概述
        该漏洞编号 CVE-2020-15778。OpenSSH 的 8.3p1 及之前版本中的 scp 允许在 scp.c 远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数 linux 系统受影响。
    - 相关文章
        - [CVE-2020-15778：OpenSSH命令注入漏洞复现](https://mp.weixin.qq.com/s/6HUPL19bSr2Ccco0qd5tQw)
        - [CVE-2020-15778：鸡肋的高危](https://www.tr0y.wang/2020/08/07/CVE-2020-15778/)
**SunSSH**
- **CVE-2020-14871 Oracle System Solaris PAM 组件缓冲区溢出漏洞**
    - 影响范围
        Oracle Solaris 11
        Oracle Solaris10
        Oracle Solaris 9(已不支持,2014年已终止)
    - 扫描
        - https://github.com/arthepsy/ssh-audit
            ```
            ssh-audit 
            关键字  "Sun_SSH"
            ```
    - MSF 模块
        ```
        solaris/ssh/pam_username_bof
        ```
### HASSH
- https://github.com/salesforce/hassh
**相关文章**
- [Open Sourcing HASSH](https://engineering.salesforce.com/open-sourcing-hassh-abed3ae5044c/)
---
## SSL & TLS
**关于 TLS**
- [TLS](../../../Integrated/Network/会话层/TLS.md)
**相关文章**
- [SSL＆TLS 安全性测试](https://www.mottoin.com/detail/1214.html)
- [Security/Server Side TLS](https://wiki.mozilla.org/Security/Server_Side_TLS)
- [TLS指纹分析研究（上）](https://mp.weixin.qq.com/s/BSXTGEgePA8tb3Vd-MNpCA)
- [TLS指纹分析研究（下）](https://mp.weixin.qq.com/s/OesoCE2Jv4ttEp-9jV1ZQQ)
**相关工具**
- [MassBleed](https://github.com/1N3/MassBleed) - SSL 漏洞扫描器
- [sslscan](https://github.com/rbsec/sslscan) - 测试启用SSL/TLS的服务，以发现支持的密码套件。
- [testssl](https://github.com/drwetter/testssl.sh) - 在任何端口的任何地方测试 TLS/SSL 加密
- [coroner/cryptolyzer](https://gitlab.com/coroner/cryptolyzer) - 适用于 Python 2.7/3.4 以上的服务器加密（TLS/SSL）设置分析库
**CVE-2014-0160 Heartbleed**
- 简介
    OpenSSL 是 OpenSSL 团队开发的一个开源的能够实现安全套接层（SSL v2/v3）和安全传输层（TLS v1）协议的通用加密库，它支持多种加密算法，包括对称密码、哈希算法、安全散列算法等。
    OpenSSL 的 TLS 和 DTLS 实现过程中的 d1_both.c 和 t1_lib.c 文件中存在安全漏洞，该漏洞源于当处理 Heartbeat Extension 数据包时，缺少边界检查。远程攻击者可借助特制的数据包利用该漏洞读取服务器内存中的敏感信息(如用户名、密码、Cookie、私钥等)。以下版本的 OpenSSL 受到影响：1.0.1，1.0.1：beta1，1.0.1：beta2，1.0.1：beta3，1.0.1a，1.0.1b，1.0.1c，1.0.1d，1.0.1e，1.0.1f。
- 相关文章
    - [心脏滴血 HeartBleed 漏洞研究及其 POC](https://www.cnblogs.com/KevinGeorge/p/8029947.html)
    - [OpenSSL 心脏出血漏洞全回顾](https://www.freebuf.com/articles/network/32171.html)
    - [Heartbleed 实战:一个影响无数网站的缓冲区溢出漏洞](https://onebitbug.me/reproduced/2014/04/09/heartbleed-poc/)
    - [Heartbleed 漏洞的复现与利用](https://blog.csdn.net/biziwaiwai/article/details/79323334)
    - [Heartbleed 心脏出血漏洞靶场搭建](https://blog.csdn.net/yaofeino1/article/details/54377537)
- POC | Payload | exp
    - [OpenSSL TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure](https://www.exploit-db.com/exploits/32745)
    - 单行命令批量检测
        ```
        cat list.txt | while read line ; do echo "QUIT" | openssl s_client -connect $line:443 2>&1 | grep 'server extension "heartbeat" (id=15)' || echo $line: safe; done
        ```
- MSF 模块
    ```
    use auxiliary/scanner/ssl/openssl_heartbleed
    ```
**CVE-2014-3566 SSL 3.0 POODLE 攻击信息泄露漏洞**
- 简介
    OpenSSL 1.0.1i 及之前版本中使用的 SSL protocol 3.0 版本中存在安全漏洞，该漏洞源于程序使用非确定性的 CBC 填充。攻击者可借助 padding-oracle 攻击利用该漏洞实施中间人攻击，获取明文数据。
- 相关文章
    - [CVE-2014-3566 SSLv3 POODLE 原理分析](http://drops.xmd5.com/static/drops/papers-3194.html)
- POC | Payload | exp
    - [mpgn/poodle-PoC](https://github.com/mpgn/poodle-PoC)
- MSF 模块
    ```
    use auxiliary/scanner/http/ssl_version
    ```
**CVE-2021-3449**
- 简介
    OpenSSL TLSv1.2 重新协商选项（默认开启）中存在一处空指针解引用，并导致拒绝服务。
- 影响范围
    - 所有OpenSSL 1.1.1版本
- POC | Payload | exp
    - [terorie/cve-2021-3449](https://github.com/terorie/cve-2021-3449)
**CVE-2022-0778 OpenSSL 拒绝服务漏洞**
- 相关文章
    - [OpenSSL CVE-2022-0778漏洞问题复现与非法证书构造](https://catbro666.github.io/posts/83951100/)
- POC | Payload | exp
    - [drago-96/CVE-2022-0778](https://github.com/drago-96/CVE-2022-0778) - Proof of concept for CVE-2022-0778, which triggers an infinite loop in parsing X.509 certificates due to a bug in BN_mod_sqrt
**CVE-2022-3602**
- POC | Payload | exp
    - [colmmacc/CVE-2022-3602](https://github.com/colmmacc/CVE-2022-3602)
### ja3(s)
- https://github.com/salesforce/ja3