group element) [34] or schemes which sample two orthogonal vectors [43]. However, this seems to be more
a limitation of what can be tested with PPEs rather than a limitation of this particular tool.
(4) Unbounded PPEs. Fourth, our scheme considers only constructions with concrete numbers of elements
and parameters. One might consider extending this to the unbounded setting, as was done for the generic
group assumption setting by Ambrona et al. [10].
(5) On Relaxing PPE Testability. Our automation outputs unknown on the Dodis VRF [26], which might
seem surprising, since one might predict that the PPEs of the VRF veriﬁcation algorithm would form a PPE
testing set. In the case of this VRF, it does not appear to be PPE testable, even though its veriﬁcation
scheme is correct. Our Rule 1 does not apply because the PRF output F ∈ G1 being veriﬁed must be
2 ∈ G2 (as opposed to just g2) to be compared against other established values
paired with an element ga
such as an A ∈ GT , i.e., an equation is checked of the form e(F, ga
2 ) = A. The problem is that if a = 0 and
A = 1, then e(F, ga
2 ) = A for any value of F , thus verifying nothing about F . In the scheme, a is chosen at
random by a trusted party and thus it will be zero with only negligible probability, making this a non-issue
for scheme security. However, our current formulation of PPE challenges and testability, in Deﬁnitions 3.2
and 3.3 respectively, requires that a testing set outputs the correct response for all challenges – which for
18
this scheme would include ones where a = 0, but in this case the VRF’s veriﬁcation equations do not appear
to be suﬃcient. An interesting open direction could be to consider ways to relax our PPE testability notion
to capture schemes such as Dodis [26], where one may be able to test most, but not all possible inputs.
(6) PPE Circuits. Lastly, and perhaps of most surprise to us, we look at what we learned from the
Boyen-Waters anonymous IBE [24] example. This one again falls into a gray area – where we aren’t actually
sure if it is PPE testable or not. However, we found evidence leading us to believe that this scheme is: (a)
not PPE testable under Deﬁnition 3.3, but is (b) potentially testable under a broader deﬁnition that would
encompass outputting a “PPE circuit” rather than a conjunction of PPEs.
Let’s dig in further. In an anonymous IBE system, the anonymity requirement is that the ciphertext does
not reveal the identity of the recipient. Thus, there does not seem be anything inherent in such a system
(unlike with dual system encryption) that would make the private key not be PPE testable. The AutoPPE
tool outputs unknown for this case, and it quickly rejects it by ﬁnding that it cannot apply Rule2.
In Deﬁnition 3.3, we deﬁne testing sets to be a conjunction of PPEs. As a result, we needed to restrict
the applicability of Rule2 only to polynomials of the form f (·) = f1(·) · ud + f2(·), where f1 is a non-zero
constant. In case f1 is a non-constant polynomial on ﬁxed variables, the untrusted polynomial f could be
veriﬁed and moved to the trusted set, if we include conditional logic such as (F1 = I) =⇒ (F = F2) in the
testing set. Here, F is the formal challenge variable corresponding to the untrusted polynomial f , I is an
identity element, F1 and F2 are expressions on formal variables corresponding to trusted polynomials which
evaluate to gf1
α respectively for an appropriate group identiﬁer α. Essentially, the rule states that in
case f1 evaluates to 0 for the given challenge, then f should evaluate to the value of f2. In order to include
such a rule, we will need to modify the deﬁnition of testing set to be a propositional logic on PPEs (or PPE
circuit, rather than conjunction of PPEs). Extending the notion of PPE testability would appear to make
the Boyen-Waters IBE scheme [24] PPE Testable, as its private key contains two polynomials of the form
f1(·) · ui + f2(·), where ui is an unﬁxed variable and f1 is a polynomial on ﬁxed variables. After both of
these ui variables are ﬁxed (via some extended Rule2), all variables are ﬁxed, and it seems feasible to test
the remaining polynomials with respect to the trusted set. Developing the theory and logic for PPE Circuits
is an exciting future direction.
α and gf2
6 Conclusion
The ability to verify the well-formedness of a group of pairing elements (e.g., a private key) with respect
to a set of trusted (e.g., public) parameters, by applying a set of pairing product equations, has numerous
cryptographic applications. These include the design of basic and structure-preserving signature schemes,
building oblivious transfer schemes from “blind” IBE, ﬁnding new veriﬁable random functions and keeping
the IBE or ABE authority “accountable” to the user.
In this work, we provided original observations demonstrating that it is not always easy for a human to
determine whether or not a public-private parameter pair can be veriﬁed using a set of PPEs. Many IBE
schemes (e.g., [22, 29, 20, 45]) have PPE-testable parameters, but some IBE schemes in the literature, such
as those based on dual-system encryption [47], provably do not.
To aid humans wishing to use PPE testability in their cryptographic design, we devised a set of rules for
how to systematically search for a PPE testing set. We proved the correctness of this algorithm in Section 4.3
and provided an implementation of it, as AutoPPE, in Section 5. Tested on over two dozen schemes, the
correctness and performance of the tool were solid. This allows researchers to move the discovery of PPE
testing equations into the growing realm of cryptographic design tasks that can now be automated. This is
one more important step in the larger goal of improving the speed and accuracy of the cryptographic design
process via computer automation.
19
Acknowledgments
The authors are grateful to Brent Waters for valuable technical discussions and also to the anonymous
reviewers of CCS 2019 for helpful feedback, especially for pointing out the connection to the automated
analysis of structured-preserving signatures in [14].
References
[1] Masayuki Abe, Melissa Chase, Bernardo David, Markulf Kohlweiss, Ryo Nishimaki, and Miyako
Ohkubo. Constant-size structure-preserving signatures: Generic constructions and simple assumptions.
Cryptology ePrint Archive, Report 2012/285, 2012. https://eprint.iacr.org/2012/285.
[2] Masayuki Abe, Jens Groth, Miyako Ohkubo, and Takeya Tango. Converting cryptographic schemes
from symmetric to asymmetric bilinear groups. In Advances in Cryptology - CRYPTO, pages 241–260.
Springer, 2014.
[3] Masayuki Abe, Fumitaka Hoshino, and Miyako Ohkubo. Design in type-i, run in type-iii: Fast and
scalable bilinear-type conversion using integer programming. In Advances in Cryptology - CRYPTO,
pages 387–415. Springer, 2016.
[4] Joseph A. Akinyele, Gilles Barthe, Benjamin Gr´egoire, Benedikt Schmidt, and Pierre-Yves Strub. Cer-
tiﬁed synthesis of eﬃcient batch veriﬁers. In IEEE 27th Computer Security Foundations Symposium,
pages 153–165. IEEE Computer Society, 2014.
[5] Joseph A. Akinyele, Christina Garman, and Susan Hohenberger. Automating fast and secure trans-
In ACM SIGSAC Conference on Computer and
lations from Type-I to Type-III pairing schemes.
Communications Security, pages 1370–1381. ACM, 2015.
[6] Joseph A. Akinyele, Matthew Green, and Susan Hohenberger. Using SMT solvers to automate design
tasks for encryption and signature schemes. In ACM SIGSAC Conference on Computer and Commu-
nications Security, pages 399–410. ACM, 2013.
[7] Joseph A. Akinyele, Matthew Green, Susan Hohenberger, and Matthew W. Pagano. Machine-generated
In the ACM
algorithms, proofs and software for the batch veriﬁcation of digital signature schemes.
Conference on Computer and Communications Security, pages 474–487. ACM, 2012.
[8] Joseph A. Akinyele, Matthew Green, Susan Hohenberger, and Matthew W. Pagano. Machine-generated
algorithms, proofs and software for the batch veriﬁcation of digital signature schemes. Journal of
Computer Security, 22(6):867–912, 2014.
[9] Miguel Ambrona, Gilles Barthe, Romain Gay, and Hoeteck Wee. Attribute-based encryption in the
In Proceedings of the 2017 ACM
generic group model: Automated proofs and new constructions.
SIGSAC Conference on Computer and Communications Security, pages 647–664. ACM, 2017.
[10] Miguel Ambrona, Gilles Barthe, and Benedikt Schmidt. Automated unbounded analysis of crypto-
graphic constructions in the generic group model. In Advances in Cryptology - EUROCRYPT, pages
822–851. Springer, 2016.
[11] Gilles Barthe, Juan Manuel Crespo, Yassine Lakhnech, and Benedikt Schmidt. Mind the gap: Modular
In Advances in Cryptology - EURO-
machine-checked proofs of one-round key exchange protocols.
CRYPT, pages 689–718. Springer, 2015.
[12] Gilles Barthe, Francois Dupressoir, Benjamin Gregoire, Alley Stoughton, and Pierre-Yves Strub. Easy-
crypt: Computer-aided cryptographic proofs, 2018. https://www.easycrypt.info/trac/.
20
[13] Gilles Barthe, Edvard Fagerholm, Dario Fiore, John C. Mitchell, Andre Scedrov, and Benedikt Schmidt.
Automated analysis of cryptographic assumptions in generic group models. In Advances in Cryptology
- CRYPTO, pages 95–112. Springer, 2014.
[14] Gilles Barthe, Edvard Fagerholm, Dario Fiore, Andre Scedrov, Benedikt Schmidt, and Mehdi Tibouchi.
Strongly-optimal structure preserving signatures from type II pairings: Synthesis and lower bounds. In
Public-Key Cryptography - PKC 2015, pages 355–376, 2015.
[15] Gilles Barthe, Xiong Fan, Joshua Gancher, Benjamin Gr´egoire, Charlie Jacomme, and Elaine Shi.
Symbolic proofs for lattice-based cryptography. In Proceedings of the 2018 ACM SIGSAC Conference
on Computer and Communications Security, CCS, pages 538–555. ACM, 2018.
[16] Gilles Barthe, Benjamin Gr´egoire, and Santiago Zanella B´eguelin. Formal certiﬁcation of code-based
cryptographic proofs. In Proceedings of the 36th ACM SIGPLAN-SIGACT Symposium on Principles
of Programming Languages, pages 90–101. ACM, 2009.
[17] Gilles Barthe, Benjamin Gr´egoire, and Benedikt Schmidt. Automated proofs of pairing-based cryp-
tography. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications
Security, pages 1156–1168. ACM, 2015.
[18] Bruno Blanchet. A computationally sound mechanized prover for security protocols. In 2006 IEEE
Symposium on Security and Privacy, pages 140–154. IEEE Computer Society, 2006.
[19] Dan Boneh and Xavier Boyen. Eﬃcient selective-id secure identity-based encryption without random
oracles. In Advances in Cryptology - EUROCRYPT, pages 223–238. Springer, 2004.
[20] Dan Boneh and Xavier Boyen. Secure identity based encryption without random oracles. In CRYPTO,
pages 443–459. Springer, 2004.
[21] Dan Boneh, Xavier Boyen, and Eu-Jin Goh. Hierarchical identity based encryption with constant size
ciphertext. In Advances in Cryptology - EUROCRYPT 2005, pages 440–456, 2005.
[22] Dan Boneh and Matthew K. Franklin. Identity-based encryption from the weil pairing. In Advances in
Cryptology - CRYPTO, pages 213–229. Springer, 2001.
[23] Dan Boneh, Ben Lynn, and Hovav Shacham. Short signatures from the weil pairing. In ASIACRYPT,
pages 514–532. Springer, 2001.
[24] Xavier Boyen and Brent Waters. Anonymous hierarchical identity-based encryption (without random
oracles). In Advances in Cryptology - CRYPTO, pages 290–307. Springer, 2006.
[25] Jan Camenisch and Anna Lysyanskaya. Signature schemes and anonymous credentials from bilinear
maps. In Advances in Cryptology - CRYPTO, pages 56–72. Springer, 2004.
[26] Yevgeniy Dodis. Eﬃcient construction of (distributed) veriﬁable random functions.
In Public Key
Cryptography - PKC, pages 1–17. Springer, 2003.
[27] Francois Le Gall. Powers of tensors and fast matrix multiplication. CoRR, abs/1401.7714, 2014.
[28] Craig Gentry. Practical identity-based encryption without random oracles. In Advances in Cryptology
- EUROCRYPT, pages 445–464. Springer, 2006.
[29] Craig Gentry and Alice Silverberg. Hierarchical id-based cryptography. In Advances in Cryptology -
ASIACRYPT, pages 548–566. Springer, 2002.
[30] Vipul Goyal. Reducing trust in the PKG in identity based cryptosystems. In Advances in Cryptology -
CRYPTO, pages 430–447. Springer, 2007.
21
[31] Vipul Goyal, Steve Lu, Amit Sahai, and Brent Waters. Black-box accountable authority identity-based
encryption. In Proceedings of the 2008 ACM Conference on Computer and Communications Security,
pages 427–436. ACM, 2008.
[32] Matthew Green and Susan Hohenberger. Blind identity-based encryption and simulatable oblivious
transfer. In Advances in Cryptology - ASIACRYPT, pages 265–282. Springer, 2007.
[33] Jens Groth and Amit Sahai. Eﬃcient non-interactive proof systems for bilinear groups.
In EURO-
CRYPT, pages 415–432. Springer, 2008.
[34] Florian Hess. Eﬃcient identity based signature schemes based on pairings. In Selected Areas in Cryp-
tography, pages 310–324. Springer, 2002.
[35] Viet Tung Hoang, Jonathan Katz, and Alex J. Malozemoﬀ. Automated analysis and synthesis of
authenticated encryption schemes. In Proceedings of the 22nd ACM SIGSAC Conference on Computer
and Communications Security, pages 84–95. ACM, 2015.
[36] Susan Hohenberger and Brent Waters. Constructing veriﬁable random functions with large input spaces.
In EUROCRYPT, pages 656–672. Springer, 2010.
[37] Tibor Jager. Veriﬁable random functions from weaker assumptions. In Theory of Cryptography - 12th
Theory of Cryptography Conference, TCC, pages 121–143. Springer, 2015.
[38] Allison B. Lewko and Brent Waters. Unbounded HIBE and attribute-based encryption. In Advances in
Cryptology - EUROCRYPT 2011, pages 547–567. Springer, 2011.
[39] Allison B. Lewko and Brent Waters. New proof methods for attribute-based encryption: Achieving full
security through selective techniques. In CRYPTO, pages 180–198. Springer, 2012.
[40] Anna Lysyanskaya. Unique signatures and veriﬁable random functions from the DH-DDH separation.
In Advances in Cryptology - CRYPTO, pages 597–612. Springer, 2002.
[41] Alex J. Malozemoﬀ, Jonathan Katz, and Matthew D. Green. Automated analysis and synthesis of block-
cipher modes of operation. In IEEE 27th Computer Security Foundations Symposium, pages 140–152.
IEEE Computer Society, 2014.
[42] David Naccache. Secure and Practical identity-based encryption. IACR Cryptology ePrint Archive,
2005.
[43] Tatsuaki Okamoto and Katsuyuki Takashima. Fully secure unbounded inner-product and attribute-
based encryption. In Advances in Cryptology - ASIACRYPT, pages 349–366. Springer, 2012.
[44] Yannis Rouselakis and Brent Waters. Practical constructions and new proof methods for large universe
In 2013 ACM SIGSAC Conference on Computer and Communications
attribute-based encryption.
Security, CCS, pages 463–474. ACM, 2013.
[45] Brent Waters. Eﬃcient identity-based encryption without random oracles. In EUROCRYPT, pages
114–127. Springer, 2005.
[46] Brent Waters. Dual system encryption: Realizing fully secure ibe and hibe under simple assumptions.
In CRYPTO, pages 619–636. Springer, 2009.
[47] Brent Waters. Dual system encryption: Realizing fully secure ibe and hibe under simple assumptions.
In CRYPTO, pages 619–636. Springer, 2009.
22
A Waters05 IBE Scheme
In this section, we recall the public parameters and the private keys from the Waters05 IBE scheme with
Naccache’s optimization [45, 42]. A part of the text has been taken verbatim from [42]. Let G1 be a group
of prime order p, and g be a group generator for G1. Let e be an admissible bilinear map e : G1 ∗ G1 → GT .
Identities will be represented as n dimensional vectors v = (v1, . . . , vn) where each vi is an l-bit integer. The
integers n and l are parameters unrelated to p, and n(cid:48) = n· l is the output length of a collision-resistant hash
function H : {0, 1}∗ → {0, 1}n(cid:48)
Setup(1λ): Sample α, β, u and each element of an n-dimensional vector U = (ui) uniformly at random
from Zp. Set g1 = gα, g2 = gβ, z = gu and zi = gui for each i ∈ [n]. The public parameters pk are
g, g1, g2, z,{zi : i ∈ [n]}. The master secret key msk is gα
2 .
KeyGen(msk, v): Let v = (v1, . . . , vn) ∈ ({0, 1}l)n be an identity. Sample r be uniformly at random in
Zp. The private key skv for identity v is constructed as
.
(cid:16)
2 ·(cid:16)
z · n(cid:89)
gα
zvi
i