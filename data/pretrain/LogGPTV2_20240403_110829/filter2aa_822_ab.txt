# KCon 黑客大会演讲摘要

## 探索一切、攻破一切
**[ Hacker@KCon ]**
9/6/2016 3:01:54 PM

### Part. 03 - GSM MITM攻击的实现

#### 1. 搭建GSM MITM测试环境
- **硬件需求**：
  1. 个人电脑（PC）
  2. USRP B200mini + 天线
  3. Motorola C118 + CP2102 USB串口转换器
  4. Nokia路测手机
- **软件需求**：
  1. Linux操作系统
  2. OpenBSC
  3. OsmocomBB

#### 低成本方案
- **硬件需求**：
  1. 个人电脑（PC）
  2. Motorola C118 + CP2102 USB串口转换器
  3. Nokia路测手机
- **软件需求**：
  1. Linux操作系统
  2. OpenBSC
  3. OsmocomBB

### GSM伪基站的工作原理
- **基站验证机制**：在GSM网络中，基站验证手机，但手机并不验证基站，这使得手机容易信任任何广播信息。
- **驻留策略**：开机时，手机会优先选择SIM卡允许的运营商网络里信号最强的基站。因此，伪基站通过增强信号强度来吸引手机连接。
- **位置更新**：比开关机更频繁的是Location Update流程，伪基站利用这一过程诱导手机驻留。

### 伪基站的具体操作
- **IMSI与IMEI获取**：通过Identity Request向移动设备请求提交IMSI，某些情况下还会请求IMEI。这些信息可用于识别目标用户。
- **快速切换**：为了减少对目标用户的干扰，一旦达到目的，伪基站会迅速将手机重新定向回原网络。

### Location Update详解
- 当移动用户发现当前所在位置与之前不同区域时，会执行Location Update以保持网络连接。此过程中包含鉴权步骤确保通信安全。

### Mobile Terminated Services
- **短信接收流程**：当有短信或电话需要传递给某用户时，网络启动Mobile Terminated Services流程，通过Paging Request等消息完成数据传输。

### GSM MITM攻击原理
- 在运营商基站和目标手机之间插入一台伪基站及一部攻击手机，从而控制两者之间的所有通信流量，实现拦截、修改甚至伪造信息的目的。

### 实施GSM MITM攻击
- **前期准备**：收集目标手机号码并确定其所在位置。
- **现场部署**：接近目标地点后开启伪基站，并仅接受特定IMSI设备的连接。
- **身份劫持**：使用攻击手机模仿目标身份进行注册，进而接管其账户访问权限。

### 成本效益分析
- 通过简单的硬件配置即可构建有效的MITM攻击平台，所需总成本低廉。

### 安全防护建议
- **双因素认证**：推荐采用更加安全的身份验证方法代替传统的短信验证码机制。
- **合作共享资源**：对于无法独立实施高级安全措施的企业来说，可以考虑与其他具备相应能力的服务提供商合作。

**[ Hacker@KCon ]**
9/6/2016 3:01:54 PM

---

希望以上内容能够帮助您更好地理解GSM MITM攻击及其防御措施。如果有任何问题，请随时提问！

**[ Hacker@KCon ]**
THANKS