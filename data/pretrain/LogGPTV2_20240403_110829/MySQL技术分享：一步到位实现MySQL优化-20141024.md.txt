一步到位实现MySQL优化
----从硬件、系统、配置、设计等多角度优化MySQL
叶金荣
QQ群： 373900864 、125572178、272675472
weibo：@yejinrong，http://imysql.com， 微信公众号：MySQL中文网
2014.10
About Me
• 叶金荣，网络常用ID：yejr
• Oracle ACE(MySQL)
• 2006年创办国内首个MySQL专业技术网站 http://imysql.com
• 精通MySQL数据库，10年+MySQL相关工作经验，擅长MySQL优化、架构设
计、故障处理
About Me
MySQL经历
• MySQl 3.32.48 ~ now(5.7)
• 2000 ~ now
• 2012, ORACLE ACE(MySQL)
Linux经历
• 蓝点Linux 2.0、TurboLinux、FreeBSD、Debian、Ubuntu、Fedora、CentOS、RHEL
About Me
联系方式
• http://imysql.com（国内首个MySQL技术博客站，From 2006）
• QQ群： 373900864 、125572178、272675472
• QQ：4700963
• Weibo: @叶金荣
• 微信公众号：MySQL中文网
• PI:EMAIL
MySQL的特点
 Not ORACLE，Not SQL Server，Not PostgreSQL
 Not Excel, Not Access
 Not File Storage
 Not Calculator
 Not Seach Engin
 Not ...
 MySQL is MySQL
MySQL的特点
CPU的利用特点
•  ? AND key_part2 =? -- 只能用到部分索引
• SELECT … WHERE key_col + ? = ? -- 无法使用索引
设计优化 – 常见杀手级SQL
SELECT a.x ...
FROM a
ORDER BY a.y LIMIT 11910298, 20;
采用子查询进行优化 =>
SELECT a.x ...
FROM a
WHERE a.pkid > (SELECT pkid FROM a WHERE pkid >= 11910298 ORDER BY a.y) LIMIT 20;
设计优化 - 架构设计
• 减少物理I/O，让MySQL闲下来
• 转变随机I/O为顺序I/O
• 减小活跃数据
• 分库分表
• 读写分离
• OLTP、OLAP分离
优化工具
• pt-ioprofile
• mysqldumpslow
• pt-query-digest + Box Anemometer/Query-Digest-UI
常见优化误区
• 分配内存越多越好，可能导致OS Swap
• session级内存分配过大，导致OOM
• 索引越多越好，可能导致更多IO
• Qcache设置过大，实际效果差
• 认为MyISAM的只读效率远高于InnoDB
• 人云亦云，不自己动手实践
• 过度优化，反而带来成本的上升
谢谢关注！
若本次分享对您有帮助，请转发扩散，谢谢！
在 http://imysql.com 中获取更多内容