title:Composability of bellare-rogaway key exchange protocols
author:Christina Brzuska and
Marc Fischlin and
Bogdan Warinschi and
Stephen C. Williams
Composability of Bellare-Rogaway
Key Exchange Protocols∗
Christina Brzuska
Marc Fischlin
Darmstadt University & CASED
Bogdan Warinschi
Stephen C. Williams
University of Bristol
ABSTRACT
In this paper we examine composability properties for the
fundamental task of key exchange. Roughly speaking, we
show that key exchange protocols secure in the prevalent
model of Bellare and Rogaway can be composed with arbi-
trary protocols that require symmetrically distributed keys.
This composition theorem holds if the key exchange protocol
satisﬁes an additional technical requirement that our analy-
sis brings to light: it should be possible to determine which
sessions derive equal keys given only the publicly available
information.
What distinguishes our results from virtually all existing
work is that we do not rely, neither directly nor indirectly,
on the simulation paradigm. Instead, our security notions
and composition theorems exclusively use a game-based for-
malism. We thus avoid several undesirable consequences of
simulation-based security notions and support applicability
to a broader class of protocols. In particular, we oﬀer an ab-
stract formalization of game-based security that should be
of independent interest in other investigations using game-
based formalisms.
Categories and Subject Descriptors
F.0 [Theory of Computation]: General
General Terms
Security, Theory
Keywords
key exchange, Bellare-Rogaway, composition
∗
A full version of this paper, including all proofs, is available at
http://www.eprint.iacr.org/2011/. This work has been supported
in part by the European Commission through the ICT Programme
under Contract ICT-2007-216676 ECRYPT II. The ﬁrst two authors
were supported by grant 50021949 of the German Academic Exchange
Service (DAAD). The second author was also supported by grants Fi
940/2-1 and Fi 940/3-1 of the German Research Foundation (DFG).
This work was supported by CASED.
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’11, October 17–21, 2011, Chicago, Illinois, USA.
Copyright 2011 ACM 978-1-4503-0948-6/11/10 ...$10.00.
1.
INTRODUCTION
1.1 Background
Typical security proofs of modern-day cryptography in-
volve sophisticated reductions based on probabilistic argu-
ments that are error prone and often diﬃcult to verify. One
of the few available approaches to make the analysis of com-
plex systems even remotely possible is compositional design
and analysis. Here, one concludes the security of a larger
system from the security of individual components via gen-
eral composition principles. This paper is a contribution to
this line of research. Our work is focused on the compos-
ability of one of the most fundamental cryptographic tasks,
secure key exchange.
There are two main approaches to capture security of
protocols. One is based on the simulation paradigm such
as the universal composition (UC) framework and related
models [7, 2, 15]. The other approach uses games to model
security. Simulation-based security oﬀers structured, intu-
itively appealing means for deﬁning security, and often allow
to conclude security of composed protocols automatically.
At the same time, the resulting frameworks can be com-
plex and involve hard to grasp subtleties. Additionally, the
strong security requirements imposed by simulation prevent
eﬃcient secure realisations for many important tasks. Fur-
thermore, and in some sense this is the main motivation for
the present work, simulation frameworks (e.g. [9]) are of-
ten simply not suitable for the analysis of existing protocols
of practical importance, mainly because such protocols do
not meet the highly stringent requirements that simulation-
based security demands. The only remaining alternative is
to then use game-based formalisms (e.g. [5, 6, 3, 8, 17]).
Their requirements are less onerous, yet the level of security
for the keys that are derived is usually quite high: they are
indistinguishable from random keys. Unfortunately, while
we have a good understanding of the level of security that
standard game-based models entail for key-exchange proto-
cols when these are executed stand-alone, there are no rig-
orously demonstrated —or even deﬁned!— guarantees for
their composition with other tasks. Our work ﬁlls this gap.
In this paper we study composability of key exchange pro-
tocols with arbitrary tasks that use symmetric keys. A typi-
cal application example is the use of a key exchange protocol
to establish symmetric keys used later in a secure channel
protocol. The security deﬁnitions that we consider, for both
stand alone and composed protocol are within the tradi-
tional game-based setting. Our main result is a theorem
that allows composition of key exchange with arbitrary pro-
51tocols that use symmetrically shared keys. Perhaps surpris-
ingly, the main requirement on the key exchange is a mild
reﬁnement of the original security deﬁnition by Bellare and
Rogaway [4] (BR model). We note that one can, for instance,
easily incorporate the eCK derivative [17] of the BR model
into our framework by adapting the corresponding stronger
corruption type accordingly. An additional requirement for
our composition result is a technical condition on matching
sessions which we show to be (in a formal sense) necessary.
1.2 Summary of results
Abstract framework for games. We ﬁrst develop a
framework for specifying cryptographic games (for two-party
protocols). Our formalization reﬂects standard deﬁnitional
ideas in cryptography that originate in the work of Bellare
and Rogaway [4]. Here, an adversary controls all communi-
cation between the participating parties and interacts with
the algorithms that deﬁne the protocol, through an interface
oﬀered by the cryptographic game. The goal of the adver-
sary is to trigger a speciﬁc event that the game considers
“bad”. We model this goal as a predicate on the complete
state of the execution. This abstract way of deﬁning secu-
rity is suﬃciently ﬂexible to generalize most, if not all, ex-
isting game-based security deﬁnitions. Our abstract model
for games should be of independent interest.
Security of key exchange protocols.
Interestingly,
the crucial security notion we demand from the key exchange
protocol is based on the original proposal of Bellare and Ro-
gaway [4], as reﬁned by Blake-Wilson et al. [6] for the public-
key setting. Recall, their model ensures that an adversary
cannot distinguish keys derived via the protocol from ran-
dom strings (selected from the key space). Additionally,
they identify the two local “partner” sessions involved in an
execution of the protocol via the concept of matching con-
versations. They demand that at most two sessions can
have the same matching conversation. As a stepping stone
towards our result we show how to cast the BR security def-
inition in our abstract framework. Our formulation main-
tains the key-indistinguishability requirement. However, we
pair local sessions via the more general concept of session
identiﬁers as introduced by Bellare, Pointcheval and Rog-
away [3]. These identiﬁers are generated on the ﬂy during
protocol execution and match more closely how real world
protocols deﬁne their partners. For example the TLS [13]
and SSH protocols [19] both have session identiﬁers set dur-
ing the course of execution. We demand that at most two
local sessions agree on the same (global) session identiﬁer.
Public session matching. In the above deﬁnition we match
sessions via session identiﬁers that are locally computed on
the ﬂy. Thus, they may be unknown to third parties, in par-
ticular to the adversary. However, we were only able to prove
general composability for key exchange protocols which sat-
isfy an additional technical requirement, namely the exis-
tence of a public session matching algorithm. Roughly, such
an algorithm is able to determine which sessions have de-
rived equal session identiﬁers, only using public information.
Note this is not as restrictive as it may seem: protocols
where sessions are deﬁned via matching conversations [4]
fall into this class. Therefore, session matching is more of a
functional requirement than a security requirement.
Defining composition. We compose key exchange proto-
cols with arbitrary two-party symmetric key protocols, i.e.,
protocols, whose execution relies on a shared secret key.
Given a game Gke deﬁning the security of the key exchange
protocol, ke, and given the game Gπ deﬁning the security
of the symmetric key protocol, π, we generically deﬁne the
execution of the composed protocol, and a game Gke;π, cap-
turing its security. In the composed protocol, each session
ﬁrst runs an instance of the key exchange protocol and then
uses the derived key to execute the symmetric key protocol
while not using any other information from the key exchange
stage. The game Gke;π allows the adversary to interact with
ke and π simultaneously: at any given point some sessions
may be in the key exchange stage, while others are in the
symmetric key protocol stage. The security requirement on
the composition is inherited from Gπ: the adversary wins
against the composition if it breaks the symmetric key pro-
tocol. The game Gke;π does not place any explicit security
requirement on the key exchange protocol.
Composition theorem. Our main result is that BR-secure
key exchange protocols, for which a session matching algo-
rithm exists, can be securely composed with arbitrary sym-
metric key protocols. In practice, assume you want to run
a key exchange protocol to use the keys for a secure chan-
nel. To conclude security of the entire protocol, one would
usually analyse the protocol as a whole. Instead, with our
theorem, one can now analyse the two components seper-
ately, and more importantly, if one uses an existing prov-
able secure key exchange protocol (i.e. BR-secure), one can
simply re-use the existing security analysis without further
investigation; and the same applies to secure channels.
We notice that secure channel protocols usually fall into
the class of so-called single session reducible protocols, a
notion we introduce in this paper. For protocols in this
class, it suﬃces to analyse a single session of the protocol
and security for concurrent execution follows automatically.
Overall, in the case of a composed protocol consisting of
a key exchange part and a secure channel part, the analysis
boils down to a single session analysis of the secure channel
protocol and a (possibly existing) BR-analysis of the key
exchange part. For clarity, we emphasise that single session
reducibility is not a requirement of our framework, but a
useful tool to shorten a complex analysis if applicable.
We now take a closer look at the public session matching
we assume to exist: one might think that this requirement is
a necessary artifact for our proof to work. However, this is
(provably) not the case. In the full version, we show that if a
key exchange protocol is composable with arbitrary symmet-
ric key protocols and security is shown via a speciﬁc kind of
black-box reduction, then (a weak form of) a session match-
ing algorithm exists. We emphasize that the public session
matching is only on the key exchange protocol, and not on
the subsequent uses of the key; hence, it does not impact
the protocol with which the key exchange is composed.
We ﬁnally note that it may look impossible to provide se-
cure composition of key exchange protocols with arbitrary
symmetric key protocols. The seemingly intuitive counter
argument is that, if the symmetric key protocol “misbehaves”
in the sense that it duplicates some steps of the key ex-
change protocol in a bad way, then the composition would
easily become insecure. As an example assume that the
key exchange somehow involves (in a secure way) a step
in which a nonce is encrypted under the new session key,
and that the ﬁrst step of the subsequent protocol is that
52a party, exceptionally receiving such an encrypted message,
would immediately disclose the session key. Then replaying
the previous message from the key exchange phase should
violate the security of the overall protocol. This line of rea-
soning, however, is incorrect. Key indistinguishability of a
key exchange protocol essentially says that one can replace
the actual key by an independent random key, more or less
decoupling the two phases. This is even true in presence
of key leakage in the symmetric key protocol, as such leak-
age can be already captured in the Bellare-Rogaway model
through special key reveals the adversary can enforce. This
implies that the “misbehaving” symmetric key protocol ei-
ther contradicts the indistinguishability of the key exchange
protocol, or that the duplication of steps is harmless because
the derived key is independent of the information ﬂow in the
key exchange phase. Carrying out this argument formally
requires some care, especially with the session matching, but
our theorem shows that general composition indeed holds.
1.3 Related work
The work of Canetti and Krawczyk on session-key (SK)
security [8, 9] is probably closest in spirit and motivation
with ours. They spell out why game based techniques may
sometime be preferable to simulation based ones. Their for-
malization of SK security uses game-based techniques (ex-
plicitly avoiding the simulation paradigm) and provides a
limited form of composition: SK-secure protocols can be
composed with secure channels. Notice that this result is
speciﬁc to secure channels and does not apply to other tasks.
In follow-up work Canetti and Krawczyk obtain more gen-
eral composability properties for the SK-security notion [9].
The approach is however not direct: they show that proto-
cols that satisfy a variant of SK-security implement, in a UC
sense an ideal functionality for key exchange. They therefore
conclude that SK-security is composable. The crucial diﬀer-
ence between this composition result and ours is the compos-
ability properties that SK-security enjoys are still obtained
(indirectly) via a simulation-based framework (and thus in-
herit the associated problems). Furthermore, the equiva-
lence with UC key exchange functionality is imperfect. One
either requires that protocols conform to a particular form
(requirement not met by practical protocols), or equivalence
is proven with respect to a weaker version of UC.
Shoup presents a security framework for key exchange
which resembles the BR model, even though it is cast as
a simulation-based approach [18]. Shoup takes into account
protocol interference of the subsequent symmetric key pro-
tocol with the key exchange protocol. That is, his notion of
a secure key exchange protocol requires key indistinguisha-
bility in presence of arbitrary applications using the keys.
Still, his model does not allow to reason about the secu-
rity of the composed protocol, i.e., when the symmetric key
protocol uses keys derived from the key exchange protocol.
The work of Datta et al. [11] is also aimed at compositional
analysis of protocols. They use the logical framework called
Protocol Compositional Logic [12]. One can regard this line
of research as an eﬀort to add some structure to a game-
based formalism. In this case, the structure is in the form of
an additional layer of logical formalism: formulas in the logic
express security properties speciﬁed in a game-based frame-
work. By working directly within the game-based framework