3.鉴别
报文×
）可简称为：
·所得到的扩展报文：不可伪造，不可否认。
A
D运算
采用公钥系统
"A用自己的私钥进行签名，B用A的公钥进行
使用已签名的报文鉴别码MAC对报文鉴别
如何分发共享密钥K?
田
MAC报文X
互联网
不安全信道
MAC报文X
B
3.1报文鉴别
45
---
## Page 24
口最简单的实体鉴别过程
3.鉴别
口
口
3.鉴别
■使用共享的对称密钥KAB 实现实体鉴别。
实体鉴别：
报文鉴别：
实体鉴别与报文鉴别不同。
■存在明显漏洞：
■在系统接入的全部持续时间内，
■对每一个收到的报文都要鉴别报文的发送者。
口重放攻击 (replay attack)：
B 就会向伪装成 A 的 C 发送许多本来应当发给 A 的报文。
入侵者C 不需要破译报文，而是直接把由 A 加密的报文发送给 B，使 B误认为C 就是 A。
不能抵抗重放攻击。
KAB
A,口令
，对和自己通信的对方实体只需验证一次。
B
3.2实体鉴别
3.2实体鉴别
48
---
## Page 25
口
3.鉴别
3.鉴别
使用不重数进行实体鉴别。
使用公钥体制进行不重数鉴别。
A
RB, KABRA
Re, KABRA
KAB RB
KAB  RB
A, RA
A, RA
使用公钥核实签名。
不重数进行签名鉴别。
在使用公钥密码体制时，可以对
用所截获的不重数。
由于不重数不能重复使用，所以
数”
复使用的大随机数，即“一次-
不重数（nonce）：是一个不重
在进行重放攻击时无法重复使
3.2实体鉴别
3.2实体鉴别
50
---
## Page 26
口假冒攻击
3.鉴别
口假冒攻击
3.鉴别
■C 冒充是A，发送报文给B，说：
■
■
■
C 把自己的公钥 PKC 冒充是 A 的公钥发送给 B。
B 向 A 发送报文,
C 用自己的私钥 SKC 冒充是A的私钥，对RB 加密，
·B 选择一个不重数 RB，发送给A，但被C 截获了。
B
相信通信的对方是A，接着就向A发送许多敏感数据，但都被C截获了。
用收到的公钥 PKC 对收到的加密的 RB 进行解密，
公钥的分配以及认证公钥的真实性是一个非常重要的问题
PKA DATA
请把公钥发过来
SKARB
PKA
我是A
RB
，要求对方把解密用的公钥发送过来，
假冒的中间人C
“我是 A"。
PKc DATA
请把公钥发过来
SKcRB
PKc
RB
我是A
其结果当然正确。
并发送给 B。
，但这报文也被C 截获
3.2实体鉴别
3.2实体鉴别
于是
52
---
## Page 27
口常用方式：设立密钥分配中心KDC (Key Distribution Center)。
4.密钥分配
密钥分配的基本概念
4.密钥分配
■主密钥可简称为密钥。
■KDC任务：
■密钥必须通过最安全的通路进行分配。
■密钥分配是密钥管理中最大的问题。
■密钥管理包括：
■安全性：
口密钥的产生、分配、注入、验证和使用。
口完全基于密钥的安全保护上。
口用户A和B 都是KDC 的登记用户，并已经在KDC 的服务器上安装了各自和
（）
口网内分配方式：密钥自动分配。
KDC 进行通信的主密钥（master key）KA和KB。
4.1对称密钥的分配
 54
忆
---
## Page 28
4.密钥分配
4.密钥分配
时间
KDC分配给用户的密
注意：在网络上传送密钥
KaB, Ke A B, Ka
KAB, KB A, B, KAB
KDC
钥
KDC 对会话密钥KAB的分配
KDC对会话密钥KAB的分配
还
和
B.Kp
票据
(ticke
解密
用的
在网
上传送
4.1对称密钥的分配
4.1对称密钥的分配
56
55
28
---
## Page 29
工作原理
Kerberos
4.密钥分配
口对称密钥分配协议：Kerberos
4.密钥分配
■只用于客户与服务器之间的鉴别，不用于人对人的鉴别。
■使用两个服务器：
■
■
■目前最出名的是KerberosV5。
使用比 DES 更加安全的高级加密标准AES 进行加密。
既是鉴别协议，同时也是KDC，是互联网建议标准。
口票据授予服务器 TGS(Ticket-Granting Server)。
口鉴别服务器 AS(Authentication Server)
1
4.1对称密钥的分配
4.1对称密钥的分配
58
---
## Page 30
工作原理
Kerberos
工作原理
Kerberos
4.密钥分配
4.密钥分配
A
KA Ks, Krc
Ka Ks, Kkc A,
Ks T,B, KrG A, Ks
B, KAB
D
T
KAB
,B, KG A, 
KAB
D
K
KB A, KAB
1H11
!
松散的同步：
同步。
须在时钟上进行松散的
这
KA。
用适当的算法生成密钥
A 需键入正确口令，利
A并不保存密钥KA
个口令随即被
4.1对称密钥的分配
4.1对称密钥的分配
防止重放
击
60
59
---
## Page 31
认证中心 CA (Certification Authority)
4.密钥分配
口但不能随意公布用户的公钥，因为：
口在公钥密码体制中，如果每个用户都具有其他用户的公钥，就可实现安
4.密钥分配
■借助可信任的第三方机构。
方法：
全通信。
■使用者也无法确定公钥的真正拥有者。
■无法防止假冒和欺骗。
SHECA（上海CA)为首的UCA协卡认证体系
国家外贸部EDI中心建立的国富安CA安全认证中心
每关认证中心
中国电信认证中心（CTCA）
中国人民银行联合12家银行建立的金融CFCA安全认证中心
广东电
字证书
一般由政府
4.2公钥的分配
4.2公钥的分配
62
3
---
## Page 32
口数字证书（digital certificate)
4.密钥分配
口数字证书(digital certificate)
4.密钥分配
■数字证书是公开的，不需要加密。
■任何用户都可从可信任的地方（如代表政府的报纸）获得认证中心CA的公
■是对公钥与其对应的实体(人或机器)进行绑定的一个证明，因此它常称为公
■有时也简称为证书。
钥，以验证证书的真伪。
口证书被CA进行了数字签名，是不可伪造的。
口把CA的数字签名和未签名的B 的证书放在一起，就最后构成了已签名的B的数
钥证书。
口更重要的是：证书中有CA使用自己私钥的数字签名。
字证书。
4.2公钥的分配
4.2公钥的分配
64
63
---
## Page 33
4.密钥分配
4.密钥分配
口
X.509 数字证书
■X.509称为互联网公钥基础结构
■IETF采用X.509V3作为互联网
■数字证书的格式必须标准化。
A拿到B的数字证书后，使用数字证书上给出的CA的公钥，对数字证书中CA的数字签名进行E运算，得出一个数值。
核实：
■
再对B的数字证书（CA数字签名除外的部分）进行散列运算，又得出一个数值。比较这两个数值。
 PKI (Public Key Infrastructure)。
的建议标准。
描述证书的结构。
ITU-T制定了 X.509 协议标准,
证书签发者：CA
未签名的B的数字证书
散列运算
固定长度散列
H(X)
已签名的B的数字证书的产生过程
CA 的数字签名
认证机构签名
扩展域
主体ID
发行者ID
公钥
主体名(或主题名)
有效期
发行者
签名算法
序列号
版本号
用CA私钥对证书签名
扩充信息
任选，唯一，
任选，唯一，标识发行者
数字证书拥有者的公钥和使用算法的标识符
公钥和数字证书拥有者的唯一标识符
包括起始时间和终止时间
签发者的唯一标识符
签署证书所使用的算法和参数
CA 发放，唯一
区分X.509不同版本
证书签发者：CA
已签名的B的数字证书
CA的数字签名
，标识证书持有者
4.2公钥的分配
4.2公钥的分配
66
65
3
---