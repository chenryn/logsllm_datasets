# Mobile Content Hosting Infrastructure in China: A View from a Cellular ISP

**Authors:**  
Zhenyu Li<sup>1,2</sup>, Donghui Yang<sup>1,2</sup>, Zhenhua Li<sup>3</sup>, Chunjing Han<sup>1,2</sup>, and Gaogang Xie<sup>1,2</sup>

- **Institute of Computing Technology, Chinese Academy of Sciences, Beijing, China**  
  {zyli, yangdonghui, hcj, xie}@ict.ac.cn
- **University of Chinese Academy of Sciences, Beijing, China**
- **Tsinghua University, Beijing, China**

**Abstract:**
With the increasing reliance on mobile devices for content access, the hosting and delivery of this content are managed by either third-party infrastructures (e.g., CDNs and clouds) or the content providers' own networks, or both. China, with the largest mobile internet user base globally, has unique local regulations and network policies, such as stringent content censorship. This results in a distinct content delivery ecosystem compared to Western countries. However, there is limited visibility into the content hosting infrastructure within Chinese cellular networks. This study aims to address this gap by analyzing a passive DNS trace consisting of 55 billion DNS logs collected from a national-scale cellular ISP. Our detailed investigation of the content-related features of major ASes reveals that popular domain content is deeply replicated within the examined cellular ISP. Conversely, approximately 20% of tracking traffic, primarily generated by US-based trackers, exits China. These findings provide valuable insights for cellular ISPs, CDNs, and internet policymakers.

## 1. Introduction
The growing popularity of smart devices has significantly increased the demand for content in cellular networks. It is projected that mobile data traffic will increase sevenfold in the coming years [5]. This immense demand not only challenges the cellular network infrastructure but also the content hosting infrastructure that delivers content to millions of users. Typical content hosting infrastructures include third-party services (e.g., CDNs, clouds), the content providers' own delivery networks, and hybrid models. These infrastructures have a substantial impact on ISPs' traffic management and the quality of experience for end-users. For example, centralized infrastructures require high-bandwidth peering with ISPs, while distributed infrastructures aim to deploy servers as close to users as possible for faster content access.

Content hosting infrastructures are influenced by costs, network policies, and local regulations. This paper examines the mobile content hosting infrastructure in China, which has the largest mobile internet population and unique local regulations. For instance, Internet Content Provider (ICP) licenses are mandatory for sites delivering content within mainland China, preventing popular CDNs like Akamai from deploying their servers in China [17].

These factors lead to significant differences in the content hosting infrastructure in China compared to Western countries. Despite some recent studies on content hosting in Western countries, our knowledge of the infrastructure in China remains limited. Triukose et al. [16] measured Akamai's performance benefits from distributed deployment, while Pujol et al. [15] studied the hosting infrastructure for advertisement trackers in DSL web users. Using DNS replies, which map end-users to specific servers, can help infer where content is hosted. The web content cartography introduced in [7] was the first to use DNS replies for this purpose, but it focused on a small number of domains in wireline networks. Xue et al. [17] used active DNS measurements to study the server selection policies of CDNs in China.

This paper analyzes all domains requested by mobile users through cellular networks. We analyzed 55 billion DNS replies collected from all recursive resolvers of a cellular ISP. The extensive coverage of the data provides a comprehensive view of the content hosting infrastructure. We use content-related metrics from [7] to characterize the features of the ASes responsible for the majority of DNS queries. We also propose a clustering algorithm to identify content hosting providers and examine the features of major providers. Additionally, we investigate the hosting infrastructure of tracking domains, which are prevalent in mobile websites and apps [13]. Our key contributions are:

- **Hosting Infrastructure Concentration:** We find that the cellular content infrastructure is concentrated in a few ISP ASes rather than CDN ASes, due to deep replication of popular domain content within ISPs. Non-popular domains, however, tend to outsource hosting to third-party clouds that rarely deploy caches in ISP networks.
- **Hosting Provider Identification:** We propose a clustering algorithm to identify hosting providers from passive DNS replies of numerous domains. Specifically, we apply spectral clustering on a bipartite graph formed by domains and IP /24 subnets, showing evidence that major providers segment their infrastructures to host different types of services.
- **Tracker Hosting Infrastructure:** We reveal that while the examined ISP handles the majority of tracking queries, over 20% of these queries are still mapped to foreign ASes. Surprisingly, up to 60% of tracking servers and 52 ASes are exclusively used for tracking services.

## 2. Data and Metrics

### 2.1 Data: Passive DNS Replies
We collected DNS data from the recursive resolvers of a cellular ISP in China. When mobile devices connect to the cellular network, they are automatically assigned a recursive resolver operated by the ISP. The recursive resolver receives hostname resolution requests from client hosts and iteratively interacts with the hierarchical naming system to translate names into IP addresses. The final step involves contacting authoritative servers, which map the queried names to the nearest domain hosting servers.

The ISP maintains a record for each DNS query at its recursive resolvers. Each record includes the recursive resolver's identifier, timestamp, requested domain name, IP lists in the response, and the return code. The records do not contain specific information about client hosts to protect privacy.

We obtained 55,412,725,137 records from all recursive resolvers of the examined cellular ISP over a 2-day period in 2015. The records are of A (IPv4) queries, with no AAAA (IPv6) queries observed. The resolution success rate (i.e., the ratio of records with "NOERROR") was 96.76%. Over half of the hostnames map to multiple IP addresses, but our analysis uses the first IP address, as it is typically used for subsequent connections [9].

**Data Pre-processing:**
To simplify the analysis of this large dataset, we mapped DNS FQDNs (Fully Qualified Domain Names) to their second-level domains (SLDs) using the public suffix library [2]. This simplification yielded 1,410,727 SLDs, following a power-law distribution where less than 1% of the domains account for 80% of the queries. We then mapped IP addresses to their AS numbers (ASNs) using Team Cymru [3] and aggregated the IP addresses in DNS responses into /24 subnetworks to examine the network footprints of domains. This aggregation granularity accounts for the fact that server clusters are often deployed for content hosting to achieve resilience and load balancing [7].

**Ethical Considerations:**
The DNS dataset contains no information about individual users, and we were unable to link queries to specific users. Such datasets are routinely gathered by DNS servers for security and operational purposes.

### 2.2 Content-Related Metrics
We use two metrics to characterize the content-related features of ASes:

1. **Content Delivery Potential (CDP):** This metric gauges the amount of content that an AS can potentially serve. Given a set of SLDs \( R \) (e.g., \( |R| \)), the CDP of AS \( i \) is \( \text{CDP}_i = \frac{|S_i|}{|R|} \), where \( S_i \subseteq R \) is the set of domains that the AS can serve.

2. **Content Monopoly Index (CMI):** This metric measures the extent to which an AS hosts content that others do not have. Let \( R \) be the set of SLDs under consideration, \( S_i \subseteq R \) the set of SLDs hosted by AS \( i \), and \( m_j \) the number of ASes that host SLD \( j \in S_i \). The CMI of AS \( i \) is \( \text{CMI}_i = \frac{1}{|S_i|} \sum_{j \in S_i} \frac{1}{m_j} \). A high CMI indicates that some content is exclusively available in the AS.

## 3. On Hosting Infrastructure

### 3.1 Content Potential of ASes
Table 1 lists the top 20 ASes in terms of the volume of successfully resolved DNS queries. These ASes account for over 90% of the DNS queries.

| Rank | AS Name<sup>a</sup> | Volume (%) | CMI<sub>top</sub> | CMI<sub>all</sub> |
|------|---------------------|-------------|--------------------|--------------------|
| 1    | ISP-AS1             | 40.99       | 0.03               | 0.09               |
| 2    | ISP-AS2             | 24.59       | 0.09               | 0.11               |
| 3    | Alibaba             | 6.32        | 0.83               | 0.07               |
| 4    | Apple               | 4.88        | 0.07               | 0.22               |
| 5    | Chinanet-BJ         | 3.91        | 0.06               | 0.06               |
| 6    | ISP-AS3             | 2.19        | 0.09               | 0.09               |
| 7    | China169-back       | 1.38        | 0.06               | 0.06               |
| 8    | ISP-AS4             | 1.33        | 0.06               | 0.06               |
| 9    | ISP-AS5             | 1.05        | 0.06               | 0.06               |
| 10   | Chinanet-back       | 0.94        | 0.06               | 0.06               |
| 11   | Akamai-ASN1         | 0.81        | 0.06               | 0.06               |
| 12   | Akamai-AS           | 0.79        | 0.06               | 0.06               |
| 13   | Chinacache          | 0.76        | 0.06               | 0.06               |
| 14   | CNIX                | 0.67        | 0.06               | 0.06               |
| 15   | Chinanet-SN         | 0.56        | 0.06               | 0.06               |
| 16   | China169-BJ         | 0.54        | 0.06               | 0.06               |
| 17   | Yahoo-SG            | 0.54        | 0.06               | 0.06               |
| 18   | Tencent             | 0.52        | 0.06               | 0.06               |
| 19   | Google              | 0.50        | 0.06               | 0.06               |
| 20   | -                   | 0.40        | 0.06               | 0.06               |

<sup>a</sup> Due to business considerations, the name of the examined ISP is anonymized and denoted as ISP.

Most queries are resolved to ISPs rather than third-party content hosting providers like Akamai. An AS appearing in the top list is either because it hosts very popular domains or a large quantity of domains. The content delivery potential (CDP) of ASes, shown in Figure 1, answers this question. In Figure 1a, only the top 10,000 popular domains are considered when computing CDP, while Figure 1b considers all domains.

[Figure 1: Content Delivery Potential of ASes]

- **Figure 1a: Top 10,000 Popular Domains**
- **Figure 1b: All Domains**

This analysis provides a clear picture of the content hosting infrastructure in China and highlights the concentration of content within a few ISP ASes, the segmentation of hosting services by major providers, and the significant role of tracking services.