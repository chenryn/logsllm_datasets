title:Mobile Content Hosting Infrastructure in China: A View from a Cellular
ISP
author:Zhenyu Li and
Donghui Yang and
Zhenhua Li and
Chunjing Han and
Gaogang Xie
Mobile Content Hosting Infrastructure
in China: A View from a Cellular ISP
Zhenyu Li1,2(B), Donghui Yang1,2, Zhenhua Li3, Chunjing Han1,2,
and Gaogang Xie1,2
1 Institute of Computing Technology, Chinese Academy of Sciences, Beijing, China
{zyli,yangdonghui,hcj,xie}@ict.ac.cn
2 University of Chinese Academy of Sciences, Beijing, China
3 Tsinghua University, Beijing, China
PI:EMAIL
Abstract. Internet users are heavily relying on mobile terminals for
content access, where the content is hosted and delivered by either third-
party infrastructures (e.g., CDNs and clouds) or the content providers’
own delivery networks, or both. China has the largest mobile Internet
population in a single country, and also has unique local regulations and
network policies (e.g. heavy content censorship). The content delivery
ecosystem in China, as such, may show great disparity from the western
one. Yet, there is little visibility into the content hosting infrastructure
in Chinese cellular networks. This paper makes the ﬁrst step toward
ﬁlling this gap by analyzing a passive DNS trace that consists of 55
billion DNS logs collected from a national-scale cellular ISP. Our in-depth
investigation of the content-related features of major ASes reveals that
content objects of popular domains are replicated deep into the examined
cellular ISP. On the other hand, as much as 20% of tracking traﬃc, which
is mainly generated by trackers owned US-based companies, goes out of
China. Our ﬁndings cast useful insights for cellular ISPs, CDNs and
Internet policy makers.
1 Introduction
The ever-growing popularity of smart devices greatly promotes the content
demand in cellular networks. It was projected that the mobile data traﬃc will
grow 7-fold in the upcoming years [5]. Such an enormous demand challenges
not only cellular network itself, but also the content hosting infrastructure
that delivers content to massive users. Typical content hosting infrastructure
includes third-party infrastructures (e.g., CDNs, clouds), the content providers’
own delivery networks, and a mixture of the two. Content hosting infrastructures
have a signiﬁcant impact on ISPs’ traﬃc engineering, and quality of experience
perceived by end users. For instance, a centralized infrastructure needs to peer
its data centers with ISPs for high bandwidth [12], while a distributed one needs
to deploy its servers as close to users as possible for fast content access.
Content hosting infrastructures is largely shaped by the cost, network policies
as well as local regulations where they are deployed. This paper examines the
c(cid:2) Springer International Publishing AG, part of Springer Nature 2018
R. Beverly et al. (Eds.): PAM 2018, LNCS 10771, pp. 100–113, 2018.
https://doi.org/10.1007/978-3-319-76481-8_8
Mobile Content Hosting Infrastructure in China: A View from a Cellular ISP
101
mobile content hosting infrastructures in China. China has the largest mobile
Internet population in a single country, and, perhaps more interestingly, has
unique local regulations and network policies. For instance, Internet Content
Provider (ICP) licenses are mandatory for the sites that aim at delivering content
within mainland China. This regulation prevents popular CDNs (like Akamai)
from deploying their replica servers in China [17].
The above factors may lead to great disparity of the content hosting infras-
tructures in China than the western countries. Unfortunately, we have very lim-
ited knowledge of the infrastructures in China, despite some recent studies on
that in western countries. Triukose et al. [16] measured Akamai, and examined
the performance beneﬁt of using distributed deployment. Pujol et al. [15] on the
other hand studied the hosting infrastructure for advertisement trackers of DSL
web users. Since DNS maps end users to speciﬁc servers [10], using DNS replies
can infer what content is hosted in which locations. The web content cartog-
raphy introduced in [7] was the ﬁrst step to use DNS replies for this purpose.
However, they focused only on a small amount of domains in wireline networks.
Xue et al. [17] also use active DNS measurements of a few top domains to study
the server selection policies used by CDNs in China.
This paper considers all domains requested by mobile users through cellu-
lar networks. We analyzed 55 billion DNS replies collected from all recursive
resolvers of a cellular ISP. The large user coverage of the data enables us to
have a comprehensive view of the content hosting infrastructure. We borrow
the content-related metrics in [7] to characterize the features of the ASes that
accounts for majority of the DNS queries. We further propose a clustering algo-
rithm to identify content hosting providers, and examined the features of the
major providers. Finally, this paper examines the hosting infrastructure of track-
ing domains, which are present in mobile webs and more prominently in mobile
apps [13]. We have also discussed the implications of our major ﬁndings from
diﬀerent aspects. To sum up, we make the following main contributions.
• Hosting Infrastructure Concentration: We ﬁnd that cellular content infras-
tructure is concentrated in a few ISP ASes, rather than CDN ASes. This
stems from the fact that content objects of popular domains have been deeply
replicated into ISPs. On the contrary, there is a trend that non-popular
domains outsource the hosting services to third-party clouds that currently
rarely deploy caches into ISP networks.
• Hosting Provider Identiﬁcation: We propose a clustering algorithm for identi-
fying hosting providers from passive DNS replies of massive domains. Specif-
ically, we apply spectral clustering on the bipartite graph formed by domains
and IP /24 subnets. We show the evidence that major providers slice up their
infrastructures to host diﬀerent kinds of services.
• Tracker Hosting Infrastructure: We reveal that while the examined ISP
account for the largest amount of tracking queries, over 20% of the track-
ing queries are still mapped to foreign ASes. Besides, we surprisingly observe
that as many as 60% of the tracking servers (i.e., servers used to deliver
tracking content) and 52 ASes are exclusively used for tracking service.
102
Z. Li et al.
2 Data and Metrics
2.1 Data: Passive DNS Replies
We collected our DNS data from the recursive resolvers of a cellular ISP in China.
Once connected to the cellular network, mobile terminals will be automatically
assigned a recursive resolver that the ISP operates. A recursive resolver receives
hostname resolution requests from client hosts, and iteratively interacts with
the hierarchical naming system to translate the names to IP addresses. The
last step of this iterating process involves contacting the authoritative servers
that maintain the mapping of the queried names to addresses. The authoritative
servers often map the names to the domain hosting servers that are as proximate
as possible to the recursive resolvers, in the hope that the hosting servers are
also close to client hosts [10].
The examined ISP keeps a record for each DNS query at its recursive
resolvers. A record consists of the recursive resolver’s identiﬁer, the timestamp,
the requested domain name, the IP lists in the response, and ﬁnally the return
code in the response. The records contain no speciﬁc information of client hosts
for privacy concerns.
In total, we obtained 55,412,725,137 records from all the recursive resolvers
of the examined cellular ISP for a duration of 2 days in 2015. The records are
of A (IPv4) queries, i.e., no AAAA (IPv6) queries were seen. By looking at the
return (error) code, we observe a resolution successful ratio (i.e., the ratio of
records with “NOERROR”) of 96.76%. Besides, over half of the hostnames map
to more than one IP address. Our analysis, however, takes the ﬁrst IP address
as the one that the hostname is mapped to. This is reasonable because, in most
cases, the ﬁrst IP address is used for the following connection [9].
Data pre-processing: To simplify the analysis of such a huge dataset, we map
the DNS FQDNs (Fully Qualiﬁed Domain Names) to their second level domains
(SLDs) using the public suﬃx library [2]. The simpliﬁcation yields 1,410,727
SLDs. The popularity of SLDs follows a power-law distribution, where less than
1% of the domains account for 80% of the queries. We further map IP addresses
to their AS number (ASN) by querying Team Cymru [3]. We further aggregate
the IP addresses in DNS responses into /24 subnetworks for the examination of
the network footprints of domains. This aggregation granularity takes the fact
that server clusters are often deployed for content hosting to achieve resilience
and load balancing [7].
Ethical issue: The DNS dataset contains no information of individual users,
and we were unable to link queries to users. It is also noteworthy that such
datasets are routinely gathered by DNS servers in form of logs for security and
operational purposes.
2.2 Content-Related Metrics
We use two metrics to characterize the content-related features of ASes. The
ﬁrst one is content delivery potential (CDP) [7], which gauges the amount of
Mobile Content Hosting Infrastructure in China: A View from a Cellular ISP
103
content that can be potentially served by an AS. Given a set of SLDs R (e.g.,
|R| , where Si ⊆ R is the set of
|Si|
tracking domains), the AS i’s CDP is CDPi =
domains that the AS can serve.
The second metric is content monopoly index (CMI) [7], which measures the
extent to which an AS hosts content that others do not have. Let R denote
the set of SLDs under consideration, Si ⊆ R the set of SLDs hosted by AS i,
and mj the number of ASes that host the SLD j ∈ Si. The CMI of AS i is
CM Ii = 1|Si|
mj . A high CMI means some content is exclusively available
in the AS.
j∈Si
(cid:2)
1
3 On Hosting Infrastructure
3.1 Content Potential of ASes
Table 1 lists the top 20 ASes in terms of the volume of DNS queries that are
resolved successfully. These ASes account for over 90% of the DNS queries.
Table 1. Top 20 ASes ranked by the volume of queries.
0.11
0.65
Rank AS namea
1
ISP-AS1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
ISP-AS2
Alibaba
Apple
Chinanet-BJ
ISP-AS3
China169-back
ISP-AS4
ISP-AS5
ISP-AS6
Chinanet-back
Akamai-ASN1
Akamai-AS
Chinacache
CNIX
Chinanet-SN
China169-BJ
Yahoo-SG
Tencent
0.91
0.12
0.19
0.05
0.63
0.37
0.18
0.12
0.52
0.26
0.26
0.10
0.57
0.23
0.13
0.09
vol. (%) CM Itop CM Iall
40.99
24.59
6.32
4.88
3.91
2.19
1.38
1.33
1.05
0.94
0.81
0.79
0.76
0.67
0.56
0.54
0.54
0.52
0.50
0.40
0.03
0.09
0.11
0.83
0.07
0.22
0.06
0.09
0.56
0.65
0.13
0.06
0.75
0.35
0.05
0.06
0.34
0.23
0.09
0.73
Google
20
a Due to business considerations, we cannot reveal
the name of the examined ISP. Rather, we use
ISP to denote it.
0.05
0.53
104
Z. Li et al.
Besides, most of the queries are resolved to ISPs, rather than third-party con-
tent hosting providers, like Akamai. An AS appearing in the top list is because
of either hosting either very popular domains, or hosting a large quantity of
domains. The content delivery potential (CDP) of ASes in Fig. 1 exactly answers
this question, where in Fig. 1a only the top 10,000 popular domains are consid-
ered when computing CDP, while Fig. 1b considers all domains.
l
a
i
t
n
e
t
o
p
1
0.8
0.6
0.4