The blue bar shown in Figure 19 shows the ground truth of
when the person was inside the house during this hour. The
attacker’s identiﬁcation toolkit runs once every 10 seconds,
and the red bar shows the time durations during which the
tracking toolkit
thinks the person was present. The bars
perfectly match except for immediately prior to minute 10,
where the toolkit falsely detects the presence of the target for
50 seconds, even though it had not yet actually returned.
VI. COUNTERMEASURES
BLE location tracking based on hardware impairments can-
not be defended against by simple software/ﬁrmware update
mechanisms. These manufacturing variation based properties
are baked into the RF signal chain.
One possible defense against
this attack requires us to
rethink the design of a BLE chipset’s signal chain. We envision
adding a random time-varying extra frequency offset
the
crystal oscillator. This would cause the CFO measured at the
receiver to also be time-varying and unpredictable. Fortunately,
since BLE has a large CFO tolerance (150 kHz [30]), an extra
frequency shift will not impact packet decoding.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:35:12 UTC from IEEE Xplore.  Restrictions apply. 
0%2%4%6%8%10%FNR0%2%4%6%8%10%12%14%FPR1234567891011121314151617050100150200250300Time(Seconds)2810593161211361411741517DeviceLabelFig. 18: Number of unique MAC addresses observed over time
while tracking the target.
Fig. 19: The blue bar represents the time that the target was
present, the red bar represents the time that our tracking toolkit
detected the presence of the target.
We also envision another defense that does not require
hardware modiﬁcation. In Section IV-B we observed that CFO
changes signiﬁcantly when a device’s internal components heat
up and cool down. Internal component temperature depends on
the workload running on the phone: a time-varying workload
can result in a time-varying CFO. We envision a defense in
which a background process runs a computation, and keeps
randomly changing the computation in line with the MAC ad-
dress changes. Unfortunately, a constantly changing workload
can result in a constantly changing battery consumption. Worse
still, if the device temperature remains constantly elevated, the
battery life also decreases over time [20].
VII. RELATED WORK
BLE MAC-Layer Fingerprinting
At its most basic level, BLE’s design frustrates MAC-layer
ﬁngerprinting. Although BLE advertisements contain a full 6-
byte MAC address that is unique to the advertising device,
the BLE protocol also has built-in cryptographic MAC ran-
domization. Fortunately, prior work found (and we conﬁrmed)
that mobile devices are properly implementing BLE’s MAC
address randomization [5], [26]. Namely, they found devices
are following the BLE speciﬁcation and periodically (every
10–15 minutes) randomizing their MAC addresses [6].
However, several papers have performed privacy attacks
by deriving identiﬁers from the packet contents of beacons
that were not reset properly after the MAC was randomized,
for both WiFi [15], [26] and BLE [32], [33], [5], [25], [11]
radios. However, all of these attacks fall short as they either
require the receiver to continuously listen to beacons from
the target devices, or fundamentally rely on identiﬁers that
can easily be removed through simple software updates. This
limits the attacker’s ability as they must persistently follow
a target to track it. Thus, link layer techniques don’t provide
persistent identiﬁers that can be utilized for long term tracking
of devices.
Physical-layer Fingerprinting
RF ﬁngerprinting using hardware impairments is a well
studied ﬁeld. Researchers have analyzed various hardware
impairment based signal properties such as CFO, I/Q off-
set/imbalance, signal transients and others [9], [39], [17], [23],
[35], [24], [4], and leveraged various statistical methods, and
in recent times deep learning approaches [16], [42], [27] to
ﬁngerprint these properties. For instance, the transient portion
of the signal has been proposed as a unique signature to
classify different wireless devices [38], [13] even Bluetooth
signals [18]. However,
the transient portion of BLE and
Bluetooth signals is only about 2 microseconds and con-
tains insufﬁcient information to uniquely identify a device
among tens of devices. Modulation-shape features have also
been explored for RF ﬁngerprinting devices such as RFID
transponders [14]. However, the Gaussian shape in GFSK
modulation of BLE signals is generated digitally in most
personal electronic devices such as phones, and thus, cannot
be used as a unique ﬁngerprint. In the WiFi literature, CFO
and I/Q imperfections (I/Q origin offset and I/Q imbalance)
are two well recognized features which have been shown to
be the most separable features for WiFi ﬁngerprinting [9].
BLE hardware in mobile devices are similar in architecture
and suffer from the same hardware impairments as WiFi
radios. Despite that, other than a few efforts at coarse CFO
extraction utilizing specialized hardware (CC2400) [34], [40],
there exists limited work in RF ﬁngerprinting of these BLE
chipsets. This is primarily because the techniques to extract
these properties rely upon the presence of long known se-
quence of bits and pilots, a convenience not provided in simple
BLE transmissions. Even if the WiFi techniques were utilized
for BLE signals, they would yield coarse estimates of these
persistent identiﬁers, which are not particularly useful when
ﬁngerprinting a large amount of devices. Furthermore, to be
able to utilize any RF ﬁngerprinting technique as a privacy
attack, we need to have evidence that it works in real world
settings. Unfortunately, all prior work in RF ﬁngerprinting has
been performed in controlled environmental settings with a
deﬁned set of devices. We design a technique to extract the
hardware impairments such as CFO and I/Q offset from BLE
signals at a ﬁne granularity. We were then able to collect a
massive dataset of BLE devices in the wild and analyze their
RF ﬁngerprints to evaluate the potentials and limitations of
the physical-layer ﬁngerprinting privacy attack in the wild.
We also demonstrated the feasibility of a location privacy
(tracking) attack utilizing these physical-layer parameters in
a realistic scenario.
1702
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:35:12 UTC from IEEE Xplore.  Restrictions apply. 
0102030405060Time(Minutes)253035#ofdevices0102030405060Time(Minutes)DetectedGroundtruthVIII. CONCLUSION
In this work, we evaluated the feasibility of physical-layer
tracking attacks on BLE-enabled mobile devices. We found
that many popular mobile devices are essentially operating as
tracking beacons for their users, transmitting hundreds of BLE
beacons per second. We discovered that it is indeed feasible
to get ﬁngerprints of the transmitters of BLE devices, even
though their signal modulation does not allow for discovering
of these imperfections at decoding time. We developed a tool
that automates recovering these features in transmitted packets.
Then, we used this tool to determine what challenges an
attacker would face in using BLE to track a target in the wild.
We found that attackers can use low-cost SDRs to capture
physical-layer ﬁngerprints, but those identities may not be
easy to capture due to differences in devices’ transmission
power, they may not be stable due to temperate variations, and
they may be similar to other devices of the same make and
model. Or, they may not even have certain identifying features
if they are developed with low power radio architectures.
By evaluating the practicality of this attack in the ﬁeld,
particularly in busy settings such as coffee shops, we found
that certain devices have unique ﬁngerprints, and therefore
are particularly vulnerable to tracking attacks, others have
common ﬁngerprints, they will often be misidentiﬁed. Overall,
we found that BLE does present a location tracking threat
for mobile devices. However, an attackers ability to track a
particular target is essentially a matter of luck.
IX. ACKNOWLEDGEMENTS
We would like to thank our shepherd and the anonymous
reviewers from IEEE S&P 2022 for their insightful comments.
We also thank the reviewers from MobiSys 2021 and USENIX
Security 2020 whose feedback lead to this manuscript. Also,
thanks to Stefan Savage for his helpful comments. This work
was supported by in part by Qualcomm’s Innovation Fellow-
ship, and a gift from Amateur Radio Digital Communications.
REFERENCES
[1] Apple Inc. Use Continuity to connect your Mac, iPhone, iPad, iPod
Touch, and Apple Watch. https://support.apple.com/en-us/HT204681.
[2] Apple Inc. / Google Inc. Exposure Notiﬁcation - Bluetooth
[4] M. Azarmehr, A. Mehta, and R. Rashidzadeh. Wireless Device
Identiﬁcation using Oscillator Control Voltage as RF Fingerprint. In
2017 IEEE 30th Canadian Conference on Electrical and Computer
Engineering (CCECE), pages 1–4, April 2017.
[5] J. K. Becker, D. Li, and D. Starobinski. Tracking Anonymized
Bluetooth Devices. Proceedings on Privacy Enhancing Technologies,
2019(3):50 – 65, 2019.
[6] Bluetooth SIG. Bluetooth Technology Protecting Your Privacy.
https://www.bluetooth.com/blog/bluetooth-technology-protecting-your-
privacy/, Apr. 2015.
[7] Bluetooth SIG. Bluetooth Technology Protecting Your Privacy.
https://www.bluetooth.com/blog/bluetooth-technology-protecting-your-
privacy/, Apr. 2015.
[8] K. Bonne Rasmussen and S. Capkun. Implications of Radio
Fingerprinting on the Security of Sensor Networks. In 2007 Third
International Conference on Security and Privacy in Communications
Networks and the Workshops - SecureComm 2007, pages 331–340,
2007.
[3] Apple Inc. / Google Inc. Exposure Notiﬁcation - Frequently Asked
Speciﬁcation, Apr. 2020. v1.2.
Questions, Sept. 2020. v1.2.
[9] V. Brik, S. Banerjee, M. Gruteser, and S. Oh. Wireless Device
Identiﬁcation with Radiometric Signatures. In Proceedings of the 14th
ACM International Conference on Mobile Computing and Networking,
MobiCom ’08, page 116–127, New York, NY, USA, 2008. Association
for Computing Machinery.
[10] California Health Care Foundation. Preliminary Research suggests
COVID-19 Warning App has slowed Transmission of the Virus.
https://www.chcf.org/blog/preliminary-research-suggests-covid-19-
warning-app-slowed-transmission-virus/.
[11] G. Celosia and M. Cunche. Discontinued Privacy: Personal Data Leaks
in Apple Bluetooth-Low-Energy Continuity Protocols. Proceedings on
Privacy Enhancing Technologies, 2020(1):26–46, 2020.
[12] CTS Corporation. Crystal Basics. https://www.ctscorp.com/wp-
content/uploads/Appnote-Crystal-Basics.pdf.
[13] B. Danev and S. Capkun. Transient-based Identiﬁcation of Wireless
Sensor Nodes. In 2009 International Conference on Information
Processing in Sensor Networks, pages 25–36, April 2009.
[14] B. Danev, T. S. Heydt-Benjamin, and S. ˇCapkun. Physical-Layer
Identiﬁcation of RFID Devices. In Proceedings of the 18th Conference
on USENIX Security Symposium, SSYM’09, page 199–214, USA,
2009. USENIX Association.
[15] J. Freudiger. How Talkative is your Mobile Device?: An Experimental
Study of Wi-Fi Probe Requests. In Proceedings of the 8th ACM
Conference on Security & Privacy in Wireless and Mobile Networks,
WiSec ’15, pages 8:1–8:6, New York, NY, USA, 2015. ACM.
[16] S. Gopalakrishnan, M. Cekic, and U. Madhow. Robust Wireless
Fingerprinting via Complex-Valued Neural Networks. arXiv preprint
arXiv:1905.09388, 2019.
[17] J. Hall, M. Barbeau, and E. Kranakis. Enhancing Intrusion Detection
in Wireless Networks using Radio Frequency Fingerprinting. In
Communications, internet, and information technology, pages
201–206, 2004.
[18] J. Hall, M. Barbeau, and E. Kranakis. Detecting Rogue Devices in
Bluetooth Networks using Radio Frequency Fingerprinting. In In
IASTED International Conference on Communications and Computer
Networks. Citeseer, 2006.
[19] T. Jian, B. C. Rendon, E. Ojuba, N. Soltani, Z. Wang, K. Sankhe,
A. Gritsenko, J. Dy, K. Chowdhury, and S. Ioannidis. Deep Learning
for RF Fingerprinting: A Massive Experimental Study. IEEE Internet
of Things Magazine, 3(1):50–57, 2020.
[20] S. Kang, H. Choi, S. Park, C. Park, J. Lee, U. Lee, and S.-J. Lee. Fire
in Your Hands: Understanding Thermal Behavior of Smartphones. In
The 25th Annual International Conference on Mobile Computing and
Networking, MobiCom ’19, New York, NY, USA, 2019. Association
for Computing Machinery.
[21] I. O. Kennedy, P. Scanlon, and M. M. Buddhikot. Passive Steady State
RF Fingerprinting: A Cognitive Technique for Scalable Deployment of
Co-Channel Femtocell Underlays. In 2008 3rd IEEE Symposium on
New Frontiers in Dynamic Spectrum Access Networks, pages 1–12,
Oct 2008.
[22] M. Khazraee, Y. Guddeti, S. Crow, A. C. Snoeren, K. Levchenko,
D. Bharadia, and A. Schulman. Sparsdr: Sparsity-proportional
backhaul and compute for sdrs. In Proceedings of the 17th Annual
International Conference on Mobile Systems, Applications, and
Services, MobiSys ’19, page 391–403, New York, NY, USA, 2019.
Association for Computing Machinery.
[23] M. Köse, S. Ta¸scio˘glu, and Z. Telatar. Wireless Device Identiﬁcation
using Descriptive Statistics. Communications Fac. Sci. Univ. of Ankara
Series A2-A3, 57(1):1–10, 2015.
[24] P. Liu, P. Yang, W. Song, Y. Yan, and X. Li. Real-time Identiﬁcation
of Rogue WiFi Connections using Environment-Independent Physical
Features. In IEEE INFOCOM 2019 - IEEE Conference on Computer
Communications, pages 190–198, April 2019.
[25] J. Martin, D. Alpuche, K. Bodeman, L. Brown, E. Fenske, L. Foppe,
T. Mayberry, E. Rye, B. Sipes, and S. Teplov. Handoff All Your
Privacy – A Review of Apple’s Bluetooth Low Energy Continuity
Protocol. Proceedings on Privacy Enhancing Technologies, 2019.
[26] J. Martin, T. Mayberry, C. Donahue, L. Foppe, L. Brown, C. Riggins,
E. C. Rye, and D. Brown. A Study of MAC Address Randomization
in Mobile Devices and When it Fails. Proceedings on Privacy
Enhancing Technologies, 2017(4):365–383, 2017.
[27] K. Merchant, S. Revay, G. Stantchev, and B. Nousain. Deep Learning
for RF Device Fingerprinting in Cognitive Communication Networks.
IEEE Journal of Selected Topics in Signal Processing, 12(1):160–167,
Feb 2018.
[28] A. Nicolussi, S. Tanner, and R. Wattenhofer. Aircraft Fingerprinting
1703
Using Deep Learning. In 2020 28th European Signal Processing
Conference (EUSIPCO), pages 740–744, 2021.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:35:12 UTC from IEEE Xplore.  Restrictions apply. 
Bluetooth SIG, July 2021.
[31] P. Robyns, E. Marin, W. Lamotte, P. Quax, D. Singelée, and
[29] A. C. Polak, S. Dolatshahi, and D. L. Goeckel. Identifying Wireless
Users via Transmitter Imperfections. IEEE Journal on Selected Areas
in Communications, 29(7):1469–1479, August 2011.
[30] Y. Rekhter and T. Li. Core Speciﬁcation 5.3. Technical report,
B. Preneel. Physical-Layer Fingerprinting of LoRa Devices Using
Supervised and Zero-Shot Learning. In Proceedings of the 10th ACM
Conference on Security and Privacy in Wireless and Mobile Networks,
WiSec ’17, page 58–63, New York, NY, USA, 2017. Association for
Computing Machinery.
[32] M. Ryan. Bluetooth: With Low Energy Comes Low Security. In
Presented as part of the 7th USENIX Workshop on Offensive
Technologies, Washington, D.C., 2013. USENIX.
[33] D. Spill and A. Bittau. Bluesniff: Eve meets Alice and Bluetooth. In
Proceedings of the ﬁrst USENIX workshop on Offensive Technologies,
page 5. USENIX Association, 2007.
[34] W. Sun, J. Paek, and S. Choi. CV-Track: Leveraging Carrier
Frequency Offset Variation for BLE Signal Detection. In Proceedings
of the 4th ACM Workshop on Hot Topics in Wireless, HotWireless ’17,
page 1–5, New York, NY, USA, 2017. Association for Computing
Machinery.
[35] W. C. Suski II, M. A. Temple, M. J. Mendenhall, and R. F. Mills.
Using Spectral Fingerprints to Improve Wireless Network Security. In
IEEE GLOBECOM 2008 - 2008 IEEE Global Telecommunications
Conference, pages 1–5, Nov 2008.
[36] TechInsights. Texas Instruments CC2640R2F SimpleLink Bluetooth
Low Energy Wireless MCU RF Architecture Report. Technical report,
TechInsights, 02 2018.
[37] C. Troncoso, M. Payer, J.-P. Hubaux, M. Salathé, J. Larus,
E. Bugnion, W. Lueks, T. Stadler, A. Pyrgelis, D. Antonioli,
L. Barman, S. Chatel, K. Paterson, S. ˇCapkun, D. Basin, J. Beutel,
D. Jackson, M. Roeschlin, P. Leu, B. Preneel, N. Smart, A. Abidin,
S. Gürses, M. Veale, C. Cremers, M. Backes, N. O. Tippenhauer,
R. Binns, C. Cattuto, A. Barrat, D. Fiore, M. Barbosa, R. Oliveira, and
J. Pereira. Decentralized Privacy-Preserving Proximity Tracing, 2020.
[38] S. Ur Rehman, K. Sowerby, and C. Coghill. Rf Fingerprint Extraction
from the Energy Envelope of an Instantaneous Transient Signal. In
2012 Australian Communications Theory Workshop (AusCTW), pages
90–95, Jan 2012.
[39] T. D. Vo-Huu, T. D. Vo-Huu, and G. Noubir. Fingerprinting Wi-Fi
Devices Using Software Deﬁned Radios. In Proceedings of the 9th
ACM Conference on Security &#38; Privacy in Wireless and Mobile
Networks, WiSec ’16, pages 3–14, New York, NY, USA, 2016. ACM.
[40] J. Wu, Y. Nan, V. Kumar, M. Payer, and D. Xu. BlueShield: Detecting
Spooﬁng Attacks in Bluetooth Low Energy Networks. In 23rd
International Symposium on Research in Attacks, Intrusions and
Defenses (RAID 2020), pages 397–411, San Sebastian, Oct. 2020.
USENIX Association.
[41] F. Xiong and M. Andro. The Effect of Doppler Frequency Shift,
Frequency Offset of the Local Oscillators, and Phase Noise on the
Performance of Coherent OFDM Receivers. Technical report, NASA,
2001.
[42] J. Yu, A. Hu, F. Zhou, Y. Xing, Y. Yu, G. Li, and L. Peng. Radio
Frequency Fingerprint Identiﬁcation based on Denoising Autoencoders.
In 2019 International Conference on Wireless and Mobile Computing,
Networking and Communications (WiMob), pages 1–6, Oct 2019.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:35:12 UTC from IEEE Xplore.  Restrictions apply. 
1704