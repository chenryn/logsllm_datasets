nessus-download-agreement），并下载其针对Debian6的安装包。然后，通过dpkg
指令安装这个软件包：
dpkg -i Nessus-x.y.z-debian6_i386.deb
在这个指令里，x.y.2代表Nessus 的版本号。请根据下载文件的
接下来，根据Nessus安装程序在屏募上的提示进行相应配置。
1.您可通过下述指令启动Nessus 的服务端程序。
/etc/init.d/nessusd start
2.使用浏览器访问网址https：//1ocalhost：8834。浏览器会提示Nessus 所用的
SSL证书无效。您需要检查SSL证书并为这个网站设置例外规则。处理过SSL证书
润题之后，您将看到Nessus 的页面内容，如图1.35所示。
3.上图1.35所示的界面会引导您设置Nessus 的管理员账号。而后，它要求您输入Nessus
扫描程序的激活码。您可在官方网站（http：//www.nessus，org/register/）
进行注册，从而获取启动程序所需的激活码（见图1.36）。
---
## Page 55
第1章Kali Linux入门37
G
Welcome to Nessus? 5
Thank you for installing Nessus, the world leader in vulnerablity scanners. Nessus will allow you to perform
• High-speed vulnerabilly discovery o determine wtich hosts are running wtich services
• Scan scheduing, to automacally run scans a the feutncyyou select
uap nof fogod fgnras au ol saraupe
. And more:
nof saisfias pue xunoooe angensusupe ue ageaao oi fuofi aue am 'sdais pau a Buunc
oad. You will need an Activation Code before you can use
: Nessus; I you do not hawe an Activa
ner wfth a Plugin Feed
mou au f o Jsfajosnsauwtq  06 aeagd peaqe ape
Get started >
图 1.35
Registering..
Successfuly registered the scanner with Tenable.
Successfully created the user
Next: Download plugins ≥
图1.36
4.您只有在成功注册之后才能下载并使用最新的Nessus组件。下载程序组件的时间会
比较长，您可以充分利用这个时间做些其他事情。
1.9.2安装Cisco密码破解工具
在第二个实例里，我们将安装一个名为cisco_crack的密码破解工具。它主要用来
破解Cisco配置文件中的type7类型密码。我们可以在官方网站下载它的源代码，该网站网
址是http:// insecure. org/sploits/cisco.passwords.html。
---
## Page 56
38Kali Linux渗透测试的艺术
Cisco 配置文件中的type7类型密码，其加密强度相当弱，所以应
当避免使用这种类型的密码。虽然此类密码已经很少见了，但是还是有
些设备在使用这种密码，在这种情况下，CiscoCrack这类工具将会派得
上用场，
下载了源代码之后，下一个步骤就是编译源代码。在开始编译它之前，您需要在原文
件里添加两条include语句：
#include 
+include 
现在，这个源代码文件应该有4条include语句。
我们使用下述命令编译程序的源代码。
gcc cisco_crack.c -o cisco_crack
如果编译成功，将会产生一个名为cisco_crack的可执行文件。我们可以通过下述
指令查看它的帮助信息。
#./cisco_crack -h
./cisco_crack  
1.10本章总结
本章带您步入KaliLinux的奇妙世界。您可以在实地的渗透测试工作中直接使用其独到
的Live DVD系统。Kali的前身是BackTrack——一个非常著名的主攻渗透测试的Linux发
行版。
本章首先介绍了KaliLinux的简史，然后介绍了它的主要功能。最新版本的KaliLinux
自带有很多可用于渗透测试的软件工具。除了渗透功能之外，KaliLinux还可用于电子取证、
无线安全研究、逆向工程和硬件破解。
在此基础上，本章介绍了安装KaliLinux的多种方法。虽然无需安装KaliLinux系统就
可以把它直接当作LiveDVD使用，但是我们也可以把它安装到硬盘上，甚至是USB闪存
里。当我们把它安装到USB闪存的时候，它就成为了portableKaliLinux，
---
## Page 57
第1章Kali Linux入门39
在使用KaliLinux开始做渗透测试之前，您还需要设置好或有线或无线的网络连接。我
们还介绍了VirtualBox虚拟机系统的一些特性，包括安装虚拟机客户端功能增强包，设置文
件夹共享，导出虚拟机和快照备份。
因为KaliLinux整合了操作系统以外的一些软件，所以在必要的时候需要进行系统更
新。我们可以单独更新应用程序，也可以连同Linux内核一并更薪。
您可能需要进行一些渗透测试方面的练习。但是在多数国家里，未经许可就渗透他人
的服务器是违法行为，为了满足教学的需要，人们刻意单独研发出了多种脆弱系统
种含有很多漏洞的虚拟主机。您可以在虚拟机里安装脆弱系统，以进行渗透测试的练习。
本文推荐的脆弱系统是Rapid7推出的Metasploitable 2。
KaliLinux系统自带有多种网络应用服务，我们选取了HTTP、MySQL和 SSH进行介
绍。具体来讲，相关内容都由简介和管理服务（例如启动和停止服务的方法）的篇幅
组成。
在本章的最后，我们演示了安装Nessus 网络扫描程序和Cisco密码破解工具的过程，
介绍了如何安装没有被KaliLinux收录的信息安全工具。
在下一章，我们将探讨渗透测试的方法学理论。
---
## Page 59
第2章
渗透测试方法论
渗透测试（penetration testing：pentest）是实施安全评估（即审计）的具体手段。方法论
是在制定、实施信息安全审计方案时，需要遵循的规则、惯例和过程。人们在评估网络、应
用、系统或三者组合的安全状况时，不断摸索各种务实的理念和成熟的做法，并总结出了一
套理论一—测试方法论。本章简要介绍了渗透测试方法论的各关键要点，涉及的主题包括：
·两种广为认知的渗透测试类型—黑盒测试和白盒测试：
·漏洞评估和渗透测试的区别：
·业界普遍采纳的安全测试方法论，以及其核心功能、特征和优势：
·典型的渗透测试所涉及的10个阶段；
·安全测试的道德准则。
渗透测试可能是单独进行的一项工作，也可能是常规研发生命周期（例如，Microsoft
SDLC）里IT安全风险管理的一个组成部分。产品的安全性并不完全取决于IT方面的技术
因素，还会受到与该产品有关的最佳安全实践的影响。具体而言，增强产品安全性的工作
涉及安全需求分析、风险分析、威胁建模、代码审查和运营安全。
通常认为，渗透测试是安全评估最终的也是最具侵犯性的形式，它必须由符合资质的专业
人士实施。在进行评估之前，有关人员可能了解也可能不了解目标的具体情况。渗透测试可用
于评估所有的IT基础设施，包括应用程序、网络设备、操作系统、通信设备、物理安全和人类
心理学。渗透测试的工作成果就是一份漆透测试报告。这种报告分为多个部分南述在当前的目
标系统里找到的安全弱点，并且会讨论可行的对抗措施和其他改进建议。充分应用渗透测试方
法论，有助于测试人员在渗透测试的各个阶段深入理解并透彻分析当前存在的防御措施。
2.1渗透测试的种类
虽然渗透测试各种各样，但是业内普意将其划分为两类：日盒测试和黑盒测试
---
## Page 60
42KaliLinux渗透测试的艺术
2.1.1黑盒测试
在进行黑盒测试时，安全审计员在不清楚被被测单位的内部技术构造的情况下，从外
部评估网络基础设施的安全性。在渗透测试的各个阶段，黑盒测试借助真实世界的黑客技
术，暴露出目标的安全间题，甚至可以揭露尚未被他人利用的安全弱点。渗透测试人员应
能理解安全弱点，将之分类并按照风险级别（高、中、低）对其排序。通常来说，风险级
别取决于相关弱点可能形成的危害的大小。老练的渗透测试专家应能确定可引发安全事故
的所有攻击模式。当测试人员完成黑盒测试的所有测试工作之后，他们会把与测试对象安
全状况有关的必要信息进行整理，并使用业务的语言描述这些被识别出来的风险，继而将
之汇总为书面报告。黑盒测试的市场报价通常会高于白盒测试，
2.1.2白盒测试
白盒测试的审计员可以获取被测单位的各种内部资料甚至不公开资料，所以渗透测试
人员的视野更为开阔。若以白盒测试的方法评估安全漏洞，测试人员可以以最小的工作量
达到最高的评估精确度。白盒测试从被测系统环境自身出发，全面消除内部安全问题，从
而增加了从单位外部渗透系统的难度。黑盒测试起不到这样的作用。白盒测试所需的步骤
数目与黑盒测试不相上下。另外，若能将白盒测试与常规的研发生命周期相结合，就可以
在入侵者发现甚至利用安全弱点之前，尽可能最早地消除全部安全隐患。这使得白盒测试
的时间、成本，以及发现、解决安全弱点的技术门槛都全面低于黑盒测试。
2.2脆弱性评估与渗透测试
正确地理解和使用安全评估领域的技术术语十分必要。在您的职业生涯中，您可
能时常会遇到那些不了解行业术语，却需要从这些专用名词里选一个进行采购的人。
其实商业公司和非商业机构里大有这样的人在。至少您应该明白这些类型的测试各是
什么。
脆弱性评估通过分析企业资产面临威胁的情况和程度，评估内部和外部的安全控制的
安全性。这种技术上的信息系统评估，不仅要揭露现有防范措施里存在的风险，而且要提
出多重备选的补救策略，并将这些策略进行比较。内部的脆弱性评估可保证内部系统的安
全性，而外部的脆弱性评估则用于验证边界防护（perimeter defenses）的有效性。无论进行
内部脆弱性评估还是进行外部脆弱性评估，评估人员都会米用各种攻击模式严格测试网络
资产的安全性，从面验证信息系统处理安全威胁的能力，进而确定应对措施的有效性。不
同类型的舱弱性评估需要的测试流程、测试工具和自动化测试技术也不相同。这可以通过
---
## Page 61
第2章渗透测试方法论43
一体化的安全弱点管控（vulnerability management）平台来实现。现在的安全弱点管控平台
带有可自动更新的漏洞数据库，能够测试不同类型的网络设备，而且不会影响配置管理和
变更管理的完整性。
脆弱性评估和渗透测试两者最大的区别就是：渗透测试不仅要识别目标的弱点，它还
涉及在目标系统上进行漏润利用、权限提升和访问维护。换句话说，脆弱性评估虽然可以
充分发现系统里的缺陷，但是不会考虑去衡量这些缺陷对系统造成的危害。另外，相比脆
弱性评估，渗透测试更倾向于入侵，会刻意使用各种技术手段利用安全漏润：所以渗透测
试可能对生产环境带来实际的破坏性影响。面脆弱性评估则是以非入侵性的方式，定性、
定量地识别已知安全弱点。
为何需要渗透测试？
如果不能确定防火墙、IDS、文件完整性监控等风险减缓控制的实
际效果，那么就应当进行渗透测试，虽然漏洞扫描（腕弱性评估）能够
发现各个漏润，但是渗透测试则会验证这些漏润在实际环境里被利用的
可能性，
有些观点认为，这两种类型的安全评估重复性很高，只是同文词而已。这种观点绝对
有误。合格的安全顾问会根据客户的商务需求，选择一种最合适的安全评估向顾客推荐，
绝对不会把不同类型的安全评估混为一谈。然而，仔细核实安全评估项目的内容和做出最
终决定确实是顾客的责任。
渗透测试的价格比脆弱性评估的价格要高。
2.3安全测试方法论
为满足安全评估的相应需求，人们已经总结出了多种开源方法论。无论被评估目标的
规模有多大，复杂性有多高，只要应用这些安全评估的方法论，就可以策略性地完成各种
时间要求苛刻、富有挑战性的安全评估任务。某些方法论专注于安全测试的技术方面，有
些则关注管理领域。只有极少数的方法论能够同时兼顾技术因素和管理因素。在评估工作
中实践这些方法论，基本上都是按部就班地执行各种测试，以精确地判断被测试系统的安
全状况。
---
## Page 62
44Kali Linux渗透测试的艺术
本书再次向您推荐几种著名的安全评估方法论。本章将重点突出这些方法论的关键特征和
优势，希望它们能够帮助您拓宽网络安全和应用安全评估的视野。
·开源安全测试方法论
·信息系统安全评估框架
·开放式Web应用安全项目
·Web应用安全联合威胁分类
·渗透测试执行标准
上述这些测试框架和方法论，都能够指导安全人士针对客户需求制定最得当的策略。
其中，前两个方法论所提供的通用原则和方法，几乎可以指导面向任何类型资产的安全测
试。由OWASP（Open WebApplication SecurityProject）推出的测试框架主要面向应用安
全的安全评估。PTES（PenetrationTestingExecutionStandard）能够指导所有类型的渗透
测试工作。然面需要注意的是，安全状态本身是一个持续变化的过程，而渗透测试只能够
获取目标系统在被测试的那一时刻的安全状态，在测试的过程中，哪怕被测的信息系统发
生了细微的变化，都可能影响安全测试的全局工作，从面导致最终的测试结果不正确。此
外，单一的测试方法论并不一定能够涵盖风险评估工作的所有方面。而拟定适合目标网络
和应用环境的最佳测试策略，确实是安全审计人员的职责。
安全测试的方法论有很多。要选取最佳的指导理论，就需要综合考虑成本和效果的因
素。所以，评估策略的筛选工作受到多种因素的制约。这些因素包括与目标系统有关的技
术细节和各种资源、渗透人员的知识结构、业务目标以及法规问题。以业务的角度看，效
果和成本控制至关重要。本文介绍的这几种方法论，在官方网站上都有非常正规的详细说
明文件。在此，我们对它们进行简要总结。如需了解详细的工作流程，您需要亲自访间相
关网站，仔细研究各种文件和实施细则。
2.3.1开源安全测试方法论（OSSTMM）
开源安全测试方法论（Open Source Security Testing Methodology Manual，OSSTMM）（官方
网站是http://www,isecom，org/research/osstmm.html）是由Pete Herzog 创建，继
而由ISECOM发展的测试方法论。它是国际公认的安全测试和安全分析标准。很多企业正
在他们的日常评估工作中应用这一标准。以技术的角度看，这一方法论把安全评估工作划