2.8 %
2.4 %
2.1 %
2.0 %
2.0 %
1.8 %
1.5 %
COM
11.5 %
9.4 %
5.6 %
3.9 %
1.5 %
1.5 %
1.2 %
1.3 %
1.3 %
1.2 %
TABLE III.
DETECTED JS LIBRARIES: TOP 10 MARKET SHARE.
SORTED BY ALEXA; DATA OMITTED FOR HOSTS NOT PART OF THE TOP 10.
Hostname
ajax.googleapis.com
code.jquery.com
static.hugedomains.com
static.parastorage.com
img.sedoparking.com
cdnjs.cloudflare.com
ak2.imgaft.com
img4.wsimg.com
static.squarespace.com
s0.2mdn.net
ad.turn.com
ivid-cdn.adhigh.net
cdn2.editmysite.com
maxcdn.bootstrapcdn.com
cdn10.trafficjunky.net
netdna.bootstrapcdn.com
ajax.aspnetcdn.com
COM
13.3 %
4.0 %
4.0 %
3.1 %
2.2 %
1.3 %
2.0 %
2.0 %
1.9 %
1.1 %
ALEXA
16.7 %
3.3 %
2.0 %
1.4 %
1.4 %
1.1 %
0.9 %
0.4 %
0.4 %
0.3 %
at least one external script, which is consistent with the 88.5 %
Nikiforakis et al. found for the Alexa Top 10 k [22]. The
median number of internal scripts is 4 per site in ALEXA (0 in
COM) and the maximum is 224 (134). Externally-hosted script
appears more prevalent with a median of 9 in ALEXA (max:
202) and 2 in COM (max: 172); about 5 % of sites in both
crawls include more than 29 external scripts. However, we note
that we likely underestimate the fraction of internal scripts
because our domain name-based heuristic cannot infer that two
domains may be under the same administrative control when
one is not a subdomain of the other. In both crawls, the median
inclusion depth of an internal script node is 1, i.e., directly
included by the main document, whereas the median depth of
an external script node is 2, suggesting indirect inclusions.
Each site includes scripts from a median of 5 external hosts
in ALEXA (2 in COM) with a maximum of 50 (45). Table II
lists the hostnames most frequently included by 
tags (counting each hostname at most once per site to reduce
bias through multiple inclusions). At least 7 of the Top 10
in ALEXA are related to advertising, especially Google’s ad
platforms. This agrees with prior work that has found Google’s
Web advertising presence to be nearly ubiquitous ([10], [7]).
C. General Library Statistics
Next, we narrow our analysis to focus just on JavaScript
libraries from our catalogue. Overall, we detect at least one
9
TABLE IV.
INCLUSION TYPES OF DETECTED LIBRARIES: LOADED FROM
INLINE/INTERNAL/EXTERNAL SCRIPT & INCLUSIONS (OF ANY TYPE) DUE
TO AD/TRACKER/WIDGET CODE. GREYED OUT IF  tag
directly embedded in HTML, or when a script is generated by
evaluating a string. For instance, we observe that a version of
Dojo loads additional components by making an asynchronous
request and passing the response to eval(). We detect internal
and external inclusions in 63.2 % and 43.1 % of all sites with
an overall median of two different libraries per site in ALEXA
(COM: internal libraries on 22 % of sites, external on 49.5 %,
with a median of one library per site).
Table III contains the most frequent hosts serving detected
JavaScript libraries. Unsurprisingly, JavaScript CDNs are well
represented (ﬁve in the Top 10 of ALEXA and three in the
Top 10 of COM); they were all used to build our catalogue
of library reference ﬁles. Between 13 % and 16 % of all non-
inline JavaScript library inclusions are loaded from Google’s
CDN. Perhaps illustrating the “long tail” nature of the COM
crawl, we observe that several web hosting and domain parking
companies are represented in the Top 10 library sources of
COM (note that we did not group subdomains; e.g., there are
multiple other subdomains of wsimg.com below the Top 10).
Table IV lists the percentage of inline, internal, and external
inclusions for a selection of detected libraries. While the
majority of inclusions in ALEXA come from internally-hosted
sources (i.e., the website’s own domain), most inclusions are
external in COM. About 10.2 % of all sites in ALEXA (16.6 %
in COM) contain at least one library inclusion that is causally
Fig. 9.
Fraction of websites with detected vulnerable inclusions in the
ALEXA Top x, and fraction of websites with at least one detected library for
comparison. Vulnerable libraries can be found on 26 % of Top 500 websites.
Fig. 10. Box plot of each website’s maximum lag behind the newest release
of each detected library, broken down into site categories and a random sample
of 10,000 websites (ALEXA). Governmental sites are longest behind.
related to ad, tracker or widget code; SWFObject, Ember, and
YUI 3 are relatively often included by such code.
D. Vulnerable Libraries
We now move on to answering our research questions,
starting with how many websites become potentially vulnerable
due to including a library version with known vulnerabilities.
Figure 5 shows the distribution of total and vulnerable
libraries per ALEXA website. Overall, we ﬁnd that 37.8 %
of sites use at least one library version that we know to be
vulnerable, and 9.7 % use two or more different vulnerable
library versions (COM in Figure 8: 37.4 % and 4.1 %).
To better understand how website popularity is correlated
with vulnerable libraries, we plot in Figure 9 the percentage
of vulnerable ALEXA websites according to their Alexa ranks.
Highly-ranked websites tend to be less likely to include
vulnerable libraries, but they are also less likely to include
any detected library at all. Towards the lower ranks, both
curves increase at a similar pace until they stabilise. While
only 21 % of the Top 100 websites use a known vulnerable
library, this percentage increases to 32.2 % in the Top 1 k
before it stabilises in the Top 5 k and remains around the
overall average of 37.8 % for all 75 k websites. This indicates
that even relatively large websites (albeit not the largest ones)
have a vulnerability rate comparable to the average of the COM
dataset, which is dominated by smaller sites.
When grouping ALEXA according to the McAfee Smart-
Filter web categorisation [19], we ﬁnd that ﬁnancial and
governmental websites rank last with 52 % and 50 % vulnerable
sites, respectively. Malicious websites (e.g., spam) have the
same proportion as the full dataset, while parked and adult
sites are the least vulnerable with 24 % and 19 %, respectively.
Table V shows the percentage of vulnerable copies for 5 out
of the 11 JavaScript libraries in our catalogue with vulnerability
data. In ALEXA, 36.7 % of jQuery inclusions are known
vulnerable, when at most one inclusion of a speciﬁc library
version is counted per site. Angular has 40.1 % vulnerable
inclusions, Handlebars has 86.6 %, and YUI 3 has 87.3 % (it
is not maintained any more). These numbers illustrate that
inclusions of known vulnerable versions can make up even a
majority of all inclusions of a library. However, we caution
that these numbers are not suitable for comparing the relative
vulnerabilities of different libraries (see Section III-A5).
E. Risk Factors for Vulnerability
So far, we have examined whether sites are potentially
vulnerable, that is, whether they include one or more known
vulnerable libraries. In the following, we turn to how libraries
are included by sites and whether we can identify any factors
indicating a higher fraction of vulnerable inclusions.
When we look at how the library is being hosted, inline
inclusions of jQuery have a clearly higher fraction of vulnerable
versions than internally or externally hosted copies. The
situation is similar when focusing on the parent node of a
library, that is, the document or script that caused the library
to be included. For most libraries, direct inclusions by the
main document are less likely to be vulnerable than indirect
inclusions such as through an intermediate script or in a frame.
As an example for web applications, we brieﬂy survey
library use related to WordPress. We consider a library to be
used by WordPress if the URL of either the library or its
next parent in the causality tree contains /wp-content/;
an inclusion is unrelated if neither condition holds. For all
libraries, WordPress-related inclusions appear to be slightly
more up-to-date than unrelated inclusions.
On the other hand, library inclusions by ad, widget or tracker
code appear to be more vulnerable than unrelated inclusions.
While the difference is relatively small for jQuery in ALEXA,
the vulnerability rate of jQuery associated with ad, widget
or tracker code in COM—89 %—is almost double the rate of
unrelated inclusions. We speculate that this may be due to the
use of less reputable ad networks or widgets on the smaller
sites in COM as opposed to the larger sites in ALEXA.
We note that the factors above are relatively coarse and
the effects are sometimes opposite for different libraries. We
suggest further investigation into the underlying causes.
10
01000020000300004000050000Top x sites0.00.10.20.30.40.50.60.70.80.9Fraction of sites in Top x020040060080010000.00.20.40.60.8At least one libraryVulnerableGovernm.FinancialMaliciousParkedAdultRandom0500100015002000250030003500Days behind newest release (max.)TABLE V.
VULNERABLE FRACTION OF INCLUSIONS PER LIBRARY, COUNTING AT MOST ONE LIBRARY-VERSION PAIR PER SITE. CONFIGURATIONS WITH
LESS THAN 100 VULNERABLE INCLUSIONS GRAYED OUT; OMITTED IF LESS THAN 10 TOTAL INCLUSIONS AFTER FILTER.
(a) ALEXA
Inclusion Filter
jQuery
jQ-UI
Angular Handlebars
All Inclusions
Internal
External
Inline
Internal Parent
External Parent
Inline Parent
Direct Incl. in Root
Indirect Inclusion
WordPress
Non-WordPress
Ad/Widget/Tracker
No Ad/Widget/Tracker
36.7 %
38.1 %
34.8 %
54.8 %
37.1 %
32.6 %
47.6 %
36.4 %
41.0 %
29.2 %
36.8 %
38.1 %
36.7 %
33.7 %
33.0 %
35.5 %
30.7 %