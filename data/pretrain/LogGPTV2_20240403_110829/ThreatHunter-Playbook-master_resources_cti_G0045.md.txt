# G0045: menuPass
## Description
menuPass, also known as APT10, is a threat group that appears to originate from China and has been active since approximately 2009. The group has targeted various sectors, including healthcare, defense, aerospace, and government, with a particular focus on Japanese victims since at least 2014. In 2016 and 2017, the group expanded its operations to target managed IT service providers, manufacturing and mining companies, and a university. (Citations: Palo Alto Networks, Crowdstrike, FireEye, PwC, DOJ)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | Collection, Credential Access | Input Capture | menuPass has used keyloggers to steal usernames and passwords. | Windows Registry, Kernel drivers, Process monitoring, API monitoring |
| Linux, macOS, Windows, GCP, AWS, Azure | Collection | Data from Local System | menuPass has collected various files from compromised computers. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Exfiltration | Data Encrypted | menuPass has encrypted files and information before exfiltration. | File monitoring, Process monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows | Defense Evasion | Masquerading | menuPass has renamed malicious files to appear legitimate, such as renaming `certutil` and moving it to different locations. They have also used `esentutl` to change file extensions to avoid detection. | File monitoring, Process monitoring, Binary file metadata |
| Linux, macOS, Windows | Defense Evasion | Obfuscated Files or Information | menuPass has encoded strings in its malware using base64 and simple XOR obfuscation. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows | Defense Evasion, Execution | Scripting | menuPass has used malicious macros embedded in Office documents to execute files. | Process monitoring, File monitoring, Process command-line parameters |
| Windows | Defense Evasion | Process Hollowing | menuPass has used process hollowing in `iexplore.exe` to load the RedLeaves implant. | Process monitoring, API monitoring |
| Windows | Defense Evasion | Deobfuscate/Decode Files or Information | menuPass has used `certutil` in a macro to decode base64-encoded content and drop UPPERCUT. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion | File Deletion | menuPass macros delete files after decoding and decompressing them. | File monitoring, Process command-line parameters, Binary file metadata |
| Linux, Windows, macOS, AWS, GCP, Azure, SaaS | Initial Access | Trusted Relationship | menuPass has exploited legitimate access granted to Managed Service Providers to access victims. | Azure activity logs, Stackdriver logs, AWS CloudTrail logs, Application logs, Authentication logs, Third-party application logs |
| Linux, Windows, macOS | Execution | User Execution | menuPass has attempted to get victims to open malicious files, such as .lnk shortcuts and Office documents, via spearphishing emails. | Anti-virus, Process command-line parameters, Process monitoring |
| Windows, macOS, Linux | Initial Access | Spearphishing Attachment | menuPass has sent malicious Office documents and executables disguised as documents via email. | File monitoring, Packet capture, Network intrusion detection system, Detonation chamber, Email gateway, Mail server |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | Defense Evasion, Persistence, Privilege Escalation, Initial Access | Valid Accounts | menuPass has used valid accounts shared between Managed Service Providers and clients to move between environments. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Linux, macOS, Windows | Discovery | System Network Configuration Discovery | menuPass has used tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | Discovery | System Network Connections Discovery | menuPass has used `net use` to conduct connectivity checks to machines. | Process monitoring, Process command-line parameters |
| Windows | Execution | Windows Management Instrumentation | menuPass uses a modified version of the pentesting script `wmiexec.vbs` to log into remote machines using WMI. | Authentication logs, Netflow/Enclave netflow, Process monitoring, Process command-line parameters |
| Windows | Lateral Movement | Remote Desktop Protocol | menuPass has used RDP connections to move across victim networks. | Authentication logs, Netflow/Enclave netflow, Process monitoring |
| Linux, macOS, Windows | Collection | Data from Network Shared Drive | menuPass has collected data from remote systems by mounting network shares with `net use` and using Robocopy. | File monitoring, Process monitoring, Process command-line parameters |
| Windows | Execution | PowerShell | menuPass uses PowerSploit to inject shellcode into PowerShell. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Linux, Windows, macOS | Exfiltration | Data Compressed | menuPass has compressed files before exfiltration using TAR and RAR. | Binary file metadata, File monitoring, Process command-line parameters, Process monitoring |
| Windows | Execution, Persistence, Privilege Escalation | Scheduled Task | menuPass has used a script (`atexec.py`) to execute commands on a target machine via Task Scheduler. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows, Office 365, Azure AD | Discovery | Account Discovery | menuPass has used `csvde.exe` to export Active Directory data. | Azure activity logs, Office 365 account logs, API monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control, Defense Evasion | Connection Proxy | menuPass has used a global service provider's IP as a proxy for C2 traffic. | Process use of network, Process monitoring, Netflow/Enclave netflow, Packet capture |
| Linux, macOS, Windows | Execution | Command-Line Interface | menuPass executes commands using a command-line interface and reverse shell, including a modified version of `wmiexec.vbs`. | Process monitoring, Process command-line parameters |
| Windows, Linux, macOS | Credential Access | Credential Dumping | menuPass has used modified versions of `wmiexec.vbs` and `secretsdump.py` to dump credentials. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | Collection | Data Staged | menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Lateral Movement | Remote Services | menuPass has used Putty Secure Copy Client (PSCP) to transfer data. | Authentication logs |
| Windows | Defense Evasion | DLL Side-Loading | menuPass has used DLL side-loading to launch Mimikatz, PwDump6, and UPPERCUT. | Process use of network, Process monitoring, Loaded DLLs |
| Windows | Persistence, Privilege Escalation, Defense Evasion | DLL Search Order Hijacking | menuPass has used DLL search order hijacking. | File monitoring, DLL monitoring, Process monitoring, Process command-line parameters |
| Linux, Windows, macOS, AWS, GCP, Azure | Discovery | Network Service Scanning | menuPass has used `tcping.exe` to probe port status on systems of interest. | Netflow/Enclave netflow, Network protocol analysis, Packet capture, Process command-line parameters, Process use of network |
| Linux, macOS, Windows, GCP, Azure, AWS | Discovery | Remote System Discovery | menuPass uses scripts to enumerate IP ranges on the victim network and has issued `net view /domain` to a PlugX implant to gather information about remote systems. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |
| Linux, macOS, Windows | Command and Control, Lateral Movement | Remote File Copy | menuPass has installed updates and new malware on victims. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |

This revised version provides a more structured and professional presentation of the information, with improved clarity and coherence.