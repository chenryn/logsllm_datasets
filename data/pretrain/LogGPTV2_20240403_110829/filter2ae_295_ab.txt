协议与车内其它ECU进行交互，是车内网络的数据交互枢纽。
## 0X02车联网漏洞攻击面
#### 2020车联网信息安全十大风险
参考中汽数据梳理总结的2020车联网信息安全十大风险如下图所示：
相较于2019车联网安全风险TOP来说，不安全的生态接口问题仍然占据第一位置，总占比约25%，系统固件可被提取及逆向问题由2019年年的第六名，提升到了今年的第五名，总占比约10%，已知漏洞的组件问题
在排名由第七名上升到第六名，总占比约9%，车载网络未做安全隔离问题由第五名下降到第七名，总占比约7%。
智能网联汽车（ICV，intelligent connected vehicle）安全已经引起了大量研究人员的关注，他们已在相关方面取得了显著成果。
如Enev利用机器学习算法，对汽车控制器局域网络（CAN， controller area
network）总线数据进行特征提取，实现对汽车驾驶员的身份识别，证明了用户隐私存在被泄露的风险。
腾讯科恩安全实验室研究员远程入侵了特斯拉汽车的网关、车身控制模块（BCM）和自动驾驶控制单元，证明了汽车中存在很多安全隐患。
Zeng等使用便携式GPS欺骗器实现了非法篡改车辆的GPS路线，严重威胁了车载GPS安全。
Miller等在DEFCON会议中指出，ICV中存在大量可被利用的攻击面，如远程无钥匙进入（RKE，remote keyless entry）、蓝牙、Wi-Fi、车载资讯系统、互联网、APP等，都有可能使用户隐私泄露，甚至导致车辆被远程控制。
## 汽车的攻击面
APP和云平台风险方面可以归为常规性安全风险，目前测试体系较为完善，不再一一赘述，仅对部分零部件作为简单介绍。
### T-BOX
1、固件逆向，攻击者通过逆向分析 T-BOX 固件，获取加密算法和密钥，解密通信协议，重放篡改指令
2、利用调试口访问无身份校验漏洞，通过焊接的方式连接调试线，车载T-BOX可深度读取汽车Can总线数据和私有协议，从硬件层获取shell，导致信息泄露问题。
3、固件后门：TBox的固件刷写功能是由IVI提供，在TBox刷入固件首先要在整体升级包中分离出TBox的固件包，并将后门文件写入到固件包中。
4、网络劫持：TBox通常会支持2G/3G/4G，所以基于GSM或LTE的伪基站都可以劫持TBox的网络连接，劫持T-BOX会话，通过伪造
协议实施对车身控制域、汽车动力总成域等的远程控制。
### IVI
1、硬件调试接口：观察主板的MCU型号及引脚信息，可以通过焊接连接调试线，从硬件层获取shell。
2、通过内置浏览器访问恶意页面，安装任意应用程序。
3、拒绝服务攻击:利用恶意程序大量耗费系统内存，使其无法正常提供服务。
4、刷入后门：如果获取了刷写系统固件的权限，可以直接将后门程序通过刷写固件的方式写入系统中，如开机启动脚本、dropbear、msf后门等。
### OTA风险
1、升级包中间人攻击：OTA升级功能，测试过程中可以通过拦截或者抓取流量包，修改后重新发送。
2、欺骗攻击，同第一个类似，类似于伪造升级包发送给车端。
### 无线电测试风险
这个类似于常规的无线电测试，指对汽车智能无线钥匙、蓝牙、WIFI、GPS和胎压监测单元等车载无线电组件进行的渗透包括但不限于干扰测试，一般包括信号屏蔽、信号篡改、中间人攻击、蓝牙劫持、蓝牙嗅探、信号截取、重放攻击等技术手段。
### CAN风险
**1、CAN报文重放**
利用录制的CAN报文进行重放，在未接触并操作车辆实际物理操作界面的情况下，实现对车辆的相关控制与操作。
**2、CAN 模糊测试**
利用CAN报文模糊测试并暴力破解数据位控制指令，通过得到的数据位控制指令进行车辆控制及操作。
（1）报文过滤绕过：CAN总线会针对TBox发送的报文进行过滤操作，通常是基于CAN ID及CAN Data的头部字节，测试时可以针对相关字段进行模糊测试。
（2）绕过状态检查：CAN总线中的ECU在执行指令之前会进行状态检查，如车辆是否在行驶中档位设置等，绕过检查并执行恶意报文会产生更大的破坏，漏洞也更严重。
（3）拒绝服务：测试工具通过随机生成大量数据，将数据发送给车辆，可以通过发送大量伪造报文来进行拒绝服务攻击。
## 小结
总体来说，本文虽然查阅了很多资料，但本身对智能网联汽车安全方面的积累太少，很多地方精彩的地方只能粗略的一笔带过，同时可能部分地方知识点存在错误，烦请大佬斧正。
## 参考致谢
    https://zhuanlan.zhihu.com/p/48700348
    https://mp.weixin.qq.com/s/Z8MHFHu-tgN6rIepEjm3tg
    http://www.infocomm-journal.com/wlw/article/2019/2096-3750/2096-3750-3-4-00072.shtml
    https://mp.weixin.qq.com/s/Pbru2pe-KeptQ909w4pk9w
    https://zhuanlan.zhihu.com/p/24217391
    https://mp.weixin.qq.com/s/BYsJaGNtJTLMBsNmciOxTA
    http://m.elecfans.com/article/1137205.html
    https://www.sohu.com/a/331837371_476857
    http://www.infocomm-journal.com/wlw/article/2019/2096-3750/2096-3750-3-4-00072.shtml
    https://mp.weixin.qq.com/s/IjZ4HmCDMjnj2z5zcVBxWg
## 关于我们
Tide安全团队正式成立于2019年1月，是新潮信息旗下以互联网攻防技术研究为目标的安全团队，团队致力于分享高质量原创文章、开源安全工具、交流安全技术，研究方向覆盖网络攻防、系统安全、Web安全、移动终端、安全开发、物联网/工控安全/AI安全等多个领域。
团队作为“省级等保关键技术实验室”先后与哈工大、齐鲁银行、聊城大学、交通学院等多个高校名企建立联合技术实验室，近三年来在网络安全技术方面开展研发项目60余项，获得各类自主知识产权30余项，省市级科技项目立项20余项，研究成果应用于产品核心技术研究、国家重点科技项目攻关、专业安全服务等。对安全感兴趣的小伙伴可以加入或关注我们。