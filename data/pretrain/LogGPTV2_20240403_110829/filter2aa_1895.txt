Outsmarting the Smart City
DISCOVERING AND ATTACKING THE TECHNOLOGY THAT RUNS 
MODERN CITIES
&
2
Page
Researcher Bios
• Daniel Crowley
• Research Baron at IBM X-Force Red
• Pen tester since 2004
• Locksport enthusiast and past competition winner
• Actually holds the title of Baron (in Sealand)
3
Page
Researcher Bios
• Jennifer Savage
• Security Researcher at Threatcare
• Black Hat review board member
• Experience includes: 
̶
development 
̶
vulnerability assessment 
̶
vulnerability management 
̶
penetration testing 
̶
security research
4
Page
Researcher Bios
• Mauro Paredes
• Managing Consultant at IBM X-Force Red
• Passion for security flaws and their corrections
• Formerly developer, net/server admin, security architect
• Pen tester for many years
• 20+ years infosec experience in multiple industries
5
Page
What kind of tech makes a city “smart”?
• Industrial Internet of Things
• Urban Automation
• Public Safety / Emergency Management
• Intelligent Transportation Systems
• Metropolitan Area Networks
6
Page
Limited citizen privacy and risk management options
• You don’t have to buy an Alexa
• You can buy a non-smart TV
• You can buy a feature phone (or forego a cell phone)
• You can buy an ancient car
• Can you move to a city that isn’t “smart”?
7
Page
V2I, V2V, OBD-III and DSRC
Connected vehicles communicate with each other, and with city infrastructure, as travel occurs.
While DSRC allows unique identification, the proposed OBD-III standard is much more powerful.
8
Page
Hangzhou “City Brain”
“In China, people have less concern with privacy, which allows us to move faster”
- Xian-Sheng Hua, manager of AI at Alibaba at World Summit AI in 2017
9
Page
Smart streetlights with cameras
GE’s Bill Ruh says it’s up to each city to set policies around the data
collected by the sensors and how it can be used.
10
Page
Facial recognition
In 2017 the former head of Singapore’s civil service Peter Ong said Singapore
wants to deploy facial recognition technology to all 110,000 lampposts in the country.
11
Page
Dubai robotic police force
“By 2030, we will have the first smart police station which won’t require human employees” -
Brigadier Khalid Nasser Al Razouqi, Dubai Police’s general director of the Smart Services Department
Reconnaissance
13
Page
Traditional port scanning
• IANA assigned ranges
• masscan, unicornscan
• Internet scan projects
̶
SHODAN
̶
Censys
̶
etc
14
Page
Physical
• Visual observation
• Wireless recon
̶
WiFi
̶
900mhz one-offs
̶
Zigbee
̶
LoRaWAN
• Log off and go outside
15
Page
Search engines
• City contracts public by law
̶
Google: “purchase order” “smart device” site:gov
• Available on the Internet
• Customer case studies
16
Page
Search engines
17
Page
Open Source Application Development Portal (OSADP)
Case Study: Austin, TX
19
Page
From port scans
20
Page
From Internet scan data
21
Page
From physical recon
22
Page
From physical recon
23
Page
From Google dorking
Devices and Vulnerabilities
Echelon i.LON SmartServer and 
i.LON 600
26
Page
i.LON: What it does
• IP to ICS gateway
̶ LonTalk
̶ P-852
̶ Modbus RTU
̶ Modbus / IP
̶ M-Bus
̶ SOAP/XML Web services 
̶ BACnet / IP
27
Page
Probably not OSHA-approved
28
Page
i.LON SmartServer and i.LON 600
Default Web credentials
Default FTP credentials
Unauthenticated API calls (SmartServer only)
Plaintext communications
Authentication bypass
Cleartext password file on FTP
Replace binaries via FTP to execute code
Fiddle with ICS gear
Change IP address of i.LON
Gain access
Do bad things
29
Page
Authentication Bypass
30
Page
Authentication Bypass
31
Page
Authentication Bypass
• SmartServer vs 600
̶
Security Access Mode
32
Page
Leaked exploit from August 2015
Battelle V2I Hub
34
Page
V2I Hub: What it does
• Manages Vehicle to Infrastructure comms
• Modular infrastructure
• Mostly SPaT (signal phase and timing) related
35
Page
V2I Hub v2.5.1
Hard-coded admin account
Various API key issues
XSS
SQLi in API
Missing authentication
Track vehicles
Send false safety messages
Create traffic
…or just power it down
Gain access
Do bad things
36
Page
Unauthenticated shutdown script
37
Page
API Authentication
38
Page
PHP strcmp() weirdness
39
Page
PHP strcmp() weirdness
40
Page
PHP strcmp() weirdness
41
Page
PHP strcmp() weirdness
42
Page
PHP strcmp() weirdness
43
Page
V2I Hub v3.0 SQL Injection
Libelium Meshlium
45
Page
Libelium Meshlium
Missing authentication
Shell command injection
Create false sensor data
Hide real sensor data
Gain access
Do bad things
46
Page
Pre-auth shell command injection
DEMONSTRATION
Implications
49
Page
Surveillance of connected vehicles
50
Page
Traffic manipulation
51
Page
Sabotage disaster warning systems
52
Page
Sabotage of industrial equipment and gateway
QUESTIONS?
PI:EMAIL – PI:EMAIL – PI:EMAIL
ibm.com/security
securityintelligence.com
xforce.ibmcloud.com
@ibmsecurity
youtube/user/ibmsecuritysolutions
©  C o p y rig h t IB M  C o rp o ra tio n  2 0 1 8 . A ll rig h ts  re s e rv e d . T h e  in fo rm a tio n  c o n ta in e d  in  th e s e  m a te ria ls  is  p ro v id e d  fo r in fo rm a tio n a l p u rp o s e s  o n ly , a n d  is  p ro v id e d  A S  IS  w ith o u t w a rra n ty  o f a n y  k in d , e x p re s s  o r im p lie d .  A n y  
s ta te m e n t o f d ire c tio n  re p re s e n ts  IB M 's  c u rre n t in te n t, is  s u b je c t to  c h a n g e  o r w ith d ra w a l, a n d  re p re s e n t o n ly  g o a ls  a n d  o b je c tiv e s .  IB M , th e  IB M  lo g o , a n d  o th e r IB M  p ro d u c ts  a n d  s e rv ic e s  a re  tra d e m a rk s  o f th e  In te rn a tio n a l 
B u s in e s s  M a c h in e s  C o rp o ra tio n , in  th e  U n ite d  S ta te s , o th e r c o u n trie s  o r b o th . O th e r c o m p a n y , p ro d u c t, o r s e rv ic e  n a m e s  m a y  b e tra d e m a rk s  o r s e rv ic e  m a rk s  o f o th e rs .
S ta te m e n t o f G o o d  S e c u rity  P ra c tic e s : IT  s y s te m  s e c u rity  in v o lv e s  p ro te c tin g  s y s te m s  a n d  in fo rm a tio n  th ro u g h  p re v e n tio n , d e te c tio n  a n d  re s p o n s e  to  im p ro p e r a c c e s s  fro m  w ith in  a n d  o u ts id e  y o u r e n te rp ris e . Im p ro p e r 
a c c e s s  c a n  re s u lt in  in fo rm a tio n  b e in g  a lte re d , d e s tro y e d , m is a p p ro p ria te d  o r m is u s e d  o r c a n  re s u lt in  d a m a g e  to  o r m is u s e  o f y o u r s y s te m s , in c lu d in g  fo r u s e  in  a tta c k s  o n  o th e rs . N o  IT  s y s te m  o r p ro d u c t  s h o u ld  b e  
c o n s id e re d  c o m p le te ly  s e c u re  a n d  n o  s in g le  p ro d u c t, s e rv ic e  o r s e c u rity  m e a s u re  c a n  b e  c o m p le te ly  e ffe c tiv e  in  p re v e n tin g  im p ro p e r u s e  o r a c c e s s . IB M  s y s te m s , p ro d u c ts  a n d  s e rv ic e s  a re  d e s ig n e d  to  b e  p a rt o f a  la w fu l, 
c o m p re h e n s iv e  s e c u rity  a p p ro a c h , w h ic h  w ill n e c e s s a rily  in v o lv e  a d d itio n a l o p e ra tio n a l p ro c e d u re s , a n d  m a y  re q u ire  o th e r s y s te m s , p ro d u c ts  o r s e rv ic e s  to  b e  m o s t e ffe c tiv e . IB M  d o e s  n o t w a rra n t th a t a n y  s y s te m s , 
p ro d u c ts  o r s e rv ic e s  a re  im m u n e  fro m , o r w ill m a k e  y o u r e n te rp ris e  im m u n e  fro m , th e  m a lic io u s  o r ille g a l c o n d u c t o f a n y  p a rty .
FOLLOW US ON:
THANK YOU
&