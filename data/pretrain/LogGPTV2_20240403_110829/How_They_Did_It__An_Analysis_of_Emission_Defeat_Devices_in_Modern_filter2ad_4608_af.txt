computed as above is applied as a third input to the ≥ 1 gates
that lead into the ﬂip-ﬂops corresponding to each proﬁle.
238
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:25:49 UTC from IEEE Xplore.  Restrictions apply. 
“Berechnung zus¨atzlicher (kundenspeziﬁscher) Korrekturen f¨ur
die Voreinspritzungen” (Calculation of additional (customer-
speciﬁc) corrections for the pilot injections.).
C. The Volkswagen Device: Effect on EGR
As noted earlier, Exhaust Gas Recirculation (EGR) is a very
effective means of reducing NOx levels in the exhaust gas.
Unfortunately, the beneﬁcial effect on NOx has the opposite
effect on particulate matter: decreasing NOx emissions by
increasing the amount of exhaust gas recirculated increases
the amount of soot in the exhaust. This, in turn, increases
load on the Diesel Particulate Filter (DPF) used to reduce
soot emissions. The acoustic condition can also be used to
alter the amount of exhaust gas recirculated (see Figure 11
in the Appendix). The logic block shown in the ﬁgure is
used to compute mDesVal1Cor, a correction value to the total
desired air mass. The correction may be applied additively or
multiplicatively, based on a conﬁgurable parameter, to the base
amount to arrive at the desired air mass value (this calculation
is not shown in the ﬁgure).
D. The Fiat 500X Device
that
they are undergoing a bench test
The Volkswagen emission scandal brought attention not
only to Volkswagen itself, but also to other automakers of
diesel vehicles. Among them was Fiat Chrysler Automobiles
(FCA), which on February 2, 2016 issued a press release
stating: “FCA diesel vehicles do not have a mechanism to
either detect
in a
laboratory or to activate a function to operate emission controls
only under laboratory testing. [...] [W]hen tested following
the only testing cycle prescribed by European law (NEDC)
[FCA diesel vehicles] perform within the regulatory limits and
comply with the relevant regulatory requirements.” [11]. On
February 9, 2016, a week after FCA issued the press release, it
was accused by German environmental protection organization
Deutsche Umwelthilfe (DUH) of exceeding emission limits on
their Fiat 500X cross-over SUV equipped with a 2-liter Fiat
MultiJet II diesel engine. DUH used a chassis dynamometer
for testing. As of this writing, FCA has not acknowledged that
its car has a defeat device.
Like other vehicles in this study, the diesel engine of the Fiat
500X uses the Bosch EDC17 ECU. Its exhaust after-treatment
system includes an NOx Storage Catalyst (NSC) and a Diesel
Particulate Filter (DPF). To investigate the claim, we obtained
a Fiat 500X function sheet (EDC17C69 P 1264) and ﬁrmware
image (55265162). We examined both for the presence of the
Volkswagen defeat device, but found neither mention of the
acoustic condition in the function sheet nor any evidence of
curve-checking logic in the ﬁrmware image.
However, we found that Fiat 500X contained what amounts
to a defeat device in the logic governing NSC regeneration.
Unlike the Volkswagen defeat device, the FCA mechanism
relies on time only, reducing the frequency of NSC regener-
ations 26 minutes 40 seconds after engine start. Recall that
the primary role of the NSC (Section II-A) is to reduce NOx
emissions by trapping NO2 in the catalyst during the loading
239
Fig. 4: Acoustic condition (signal InjCrv stNsCharCor) used to modify
the desired injection quantity correction qCor. From the EDC17C54 P 874
function sheet. Copyright Robert Bosch GmbH.
If the sophisticated test cycle detection logic encoded above
sets the acoustic condition to one, a number of behavior
changes take place in the vehicle. These changes are ef-
fected by using the value of the acoustic condition variable
stNsCharCor to switch between conﬁgurable variables or
parameters, allowing the vehicle to operate with one set of
calibration values in the normal driving mode and using
another set in testing mode, as if two distinct personalities
took turns controlling the vehicle. Next, we describe the two
contrasting personalities that emerge depending on the state
of the acoustic condition.
B. The Volkswagen Device: Effect on Injection
As described in Section II-A, the operation of a diesel
engine is controlled through fuel injection timing. The start
and duration of injections not only affects engine power output
but also exhaust emissions. Based on its naming and ﬁrst use,
the acoustic condition was introduced to alter engine injection
behavior [15]. We identiﬁed several points in the ﬁrmware we
analyzed manually where the acoustic condition can modify
fuel injection behavior. Here, we describe how the acoustic
condition can be used to adjust the quantity of injection.
Figure 4 shows how the fuel injection quantity (additive)
correction (qCor) is modiﬁed by the acoustic condition. If
the acoustic condition is true (under test), qCor is modi-
ﬁed by adding a constant (InjCrv qNsPiI1AddCor{1,2} C
or InjCrv qNsPiI2AddCor C). Otherwise, qCor is mod-
iﬁed by adding a value computed based on engine speed
(Epm nEng). The function sheet describes this logic block as
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:25:49 UTC from IEEE Xplore.  Restrictions apply. 

K

-


2
E
@
N
-





1


+
4
8

-


1

E
+
H
L

I
J

I
+
D
=
H
+

H
5
6
5
;
5

5
6
4
6
,


-
2
G
+

H
2
1

E
+
H
L

G

I
2
E
1
)
@
@
+

H

+
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6
G
+

H
2
1

E
+
H
L

G

I
2
E
1
)
@
@
+

H

+
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6
G
+

H
G
+

H
2
E
E

1


+
H
L

G

I
2
E
1
)
@
@
+

H


)
2
2
E
E
2
E
E
2
E
E
!
1


+
H
L

G

I
2
E
1
)
@
@
+

H


)
2
1


+
H
L

I
J
1


+
D
=
H
)
?
J
8
=


1


+
4
8

2
1
1




2
2
2
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6