### Computed Value Application
The computed value, as described above, serves as the third input to the ≥1 gates that feed into the flip-flops corresponding to each profile.

---

### Calculation of Additional (Customer-Specific) Corrections for Pilot Injections
"Berechnung zusätzlicher (kundenspezifischer) Korrekturen für die Voreinspritzungen" translates to "Calculation of additional (customer-specific) corrections for the pilot injections."

### C. The Volkswagen Device: Effect on EGR
As previously mentioned, Exhaust Gas Recirculation (EGR) is an effective method for reducing NOx levels in exhaust gases. However, this reduction in NOx emissions comes at the cost of increased particulate matter (soot) in the exhaust. This increase in soot places a greater load on the Diesel Particulate Filter (DPF), which is used to reduce soot emissions. The acoustic condition can also be used to modify the amount of exhaust gas recirculated (see Figure 11 in the Appendix). The logic block shown in the figure calculates `mDesVal1Cor`, a correction value for the total desired air mass. This correction can be applied either additively or multiplicatively, based on a configurable parameter, to the base amount to determine the final desired air mass value (this calculation is not shown in the figure).

### D. The Fiat 500X Device
The Volkswagen emission scandal not only brought attention to Volkswagen but also to other automakers of diesel vehicles, including Fiat Chrysler Automobiles (FCA). On February 2, 2016, FCA issued a press release stating: "FCA diesel vehicles do not have a mechanism to detect laboratory conditions or to activate a function to operate emission controls only under laboratory testing. When tested following the only testing cycle prescribed by European law (NEDC), FCA diesel vehicles perform within regulatory limits and comply with relevant regulatory requirements." [11]. However, on February 9, 2016, FCA was accused by the German environmental protection organization Deutsche Umwelthilfe (DUH) of exceeding emission limits on their Fiat 500X crossover SUV, equipped with a 2-liter Fiat MultiJet II diesel engine. DUH used a chassis dynamometer for testing. As of the time of writing, FCA has not acknowledged the presence of a defeat device in its vehicles.

The diesel engine of the Fiat 500X uses the Bosch EDC17 ECU, and its exhaust after-treatment system includes an NOx Storage Catalyst (NSC) and a Diesel Particulate Filter (DPF). To investigate the claims, we obtained a Fiat 500X function sheet (EDC17C69 P 1264) and firmware image (55265162). We examined both for the presence of the Volkswagen defeat device but found no mention of the acoustic condition in the function sheet or any evidence of curve-checking logic in the firmware image.

However, we discovered that the Fiat 500X contains what amounts to a defeat device in the logic governing NSC regeneration. Unlike the Volkswagen defeat device, the FCA mechanism relies solely on time, reducing the frequency of NSC regenerations 26 minutes and 40 seconds after engine start. Recall that the primary role of the NSC (Section II-A) is to reduce NOx emissions by trapping NO2 in the catalyst during the loading phase.

### Acoustic Condition and Injection Quantity Correction
If the sophisticated test cycle detection logic sets the acoustic condition to one, several behavior changes occur in the vehicle. These changes are implemented by using the value of the acoustic condition variable `stNsCharCor` to switch between configurable variables or parameters, allowing the vehicle to operate with one set of calibration values in normal driving mode and another set in testing mode, as if two distinct personalities took turns controlling the vehicle. 

### B. The Volkswagen Device: Effect on Injection
As described in Section II-A, the operation of a diesel engine is controlled through fuel injection timing. The start and duration of injections affect both engine power output and exhaust emissions. The acoustic condition was introduced to alter engine injection behavior. We identified several points in the firmware where the acoustic condition can modify fuel injection behavior. Specifically, the acoustic condition can be used to adjust the quantity of injection.

Figure 4 illustrates how the fuel injection quantity (additive) correction (`qCor`) is modified by the acoustic condition. If the acoustic condition is true (under test), `qCor` is modified by adding a constant (either `InjCrv qNsPiI1AddCor{1,2} C` or `InjCrv qNsPiI2AddCor C`). Otherwise, `qCor` is modified by adding a value computed based on engine speed (`Epm nEng`). The function sheet describes this logic block as follows:

```
K
-


2
E
@
N
-





1


+
4
8

-


1

E
+
H
L

I
J

I
+
D
=
H
+

H
5
6
5
;
5

5
6
4
6
,


-
2
G
+

H
2
1

E
+
H
L

G

I
2
E
1
)
@
@
+

H

+
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6
G
+

H
2
1

E
+
H
L

G

I
2
E
1
)
@
@
+

H

+
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6
G
+

H
G
+

H
2
E
E

1


+
H
L

G

I
2
E
1
)
@
@
+

H


)
2
2
E
E
2
E
E
2
E
E
!
1


+
H
L

G

I
2
E
1
)
@
@
+

H


)
2
1


+
H
L

I
J
1


+
D
=
H
)
?
J
8
=


1


+
4
8

2
1
1




2
2
2
-
F



-

C
1


5
;
5


-
)
,
2
)
4
5
-
6
```

This logic block ensures that the vehicle operates with different injection settings depending on whether it is in a testing environment or normal driving conditions.