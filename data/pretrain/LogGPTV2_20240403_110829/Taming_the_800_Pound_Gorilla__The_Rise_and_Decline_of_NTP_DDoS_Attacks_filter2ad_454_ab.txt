commands. Those others have typically lower ampliﬁcation than
monlist, however.
In Figure 3 we show the number of global NTP monlist ampliﬁers,
and include aggregation at network levels, which underlines the
global dispersion and varying remediation rates. The ﬁgure also
shows ampliﬁer count lines labeled Merit and CSU(FRGP), which
we will elaborate on later. As can be seen, the global Ampliﬁer
population starts at approximately 1.4M in the ﬁrst half of January
and, as the Internet community begins to patch servers and block
certain NTP requests, the population begins a mostly steady decline
through mid-March, when it levels off at around 110K ampliﬁers.
We discuss operator mitigation and ampliﬁer remediation in § 6.
We were next interested in measuring the churn in the ampliﬁer
population. Over the course of the 15-week measurement period,
we learn 2,166,097 unique ampliﬁer IPs. We found that the ﬁrst
weekly sample only sees about 60% of these unique IPs seen, and
that some new ampliﬁers are discovered on every scan conducted.
About half of the ampliﬁers are only seen during one of the ﬁfteen
weekly scans, which is partly due to the rapid remediation of the
ampliﬁer population. A second factor is that a non-trivial fraction
(13% – 35%) of these NTP servers are running on end-user (i.e.,
residential) machines and, thus, may be subject to DHCP churn.
The left half of Table 1 shows the percentage of each sample’s IPs
that are “end hosts” according to the Spamhaus Policy Block List
(PBL) [34], taken on April 18th, 2014. The PBL identiﬁes end-user
IP addresses, and there is independent evidence that PBL-labeled IPs
are, indeed, residential [7]. Finally, we calculate the average number
of IPs per routed block, which starts at a peak of 22 and declines
toward 4. This tells us that, initially, the pool of vulnerable servers
included many large groups of closely-addressed (and, thus, likely
managed together) server machines, whereas the population left in
01-1001-1701-2401-3102-0702-1402-2102-2803-0703-1403-2103-2804-0404-1104-18Sample Date1101001K10K100K1M10MAmplifiersGlobal IPsGlobal /24 netsGlobal routed netsGlobal ASesMerit IPsFRGP IPs437(a) Bytes returned by monlist ampliﬁers
(b) BAF of monlist ampliﬁers
(c) BAF of version ampliﬁers
Figure 4: (a) Average on-wire bytes returned by monlist and version ampliﬁers. Boxplots of the resultant bandwidth ampliﬁcation
factors (BAF) for monlist (b) and version (c). Boxplots show the minimum, ﬁrst quartile, median, third quartile, and maximum BAF.
There are a small number of very large outliers in both types.
Table 1: For both ampliﬁers and victims seen in the ﬁfteen weeks of ONP data, the IP counts, unique routed blocks, unique origin
AS numbers, percentage of IPs that are end hosts, and number of IPs per routed block.
Date
2014-01-10
2014-01-17
2014-01-24
2014-01-31
2014-02-07
2014-02-14
2014-02-21
2014-02-28
2014-03-07
2014-03-14
2014-03-21
2014-03-28
2014-04-04
2014-04-11
2014-04-18
IPs
1405186
1276639
677112
438722
365724
235370
176931
159629
123673
121507
110565
108385
112131
108636
106445
Blocks
63499
61070
58519
56376
52229
42719
36411
32376
29159
27849
27590
27003
26947
26514
25976
ASNs
15131
14671
14339
13903
13095
10961
9335
8241
7403
7115
7036
6997
7000
6925
6751
Global Ampliﬁers
End Hosts
260252
207647
90889
74781
70053
63164
54578
51551
43531
40934
38870
37808
37880
36493
35683
End Host % IPs per Block
22.13
20.90
11.57
7.78
7.00
5.51
4.86
4.93
4.24
4.36
4.01
4.01
4.16
4.10
4.10
18.5
16.3
13.4
17.1
19.1
26.8
30.9
32.3
35.2
33.7
35.2
34.9
33.8
33.6
33.5
IPs
49979
59937
66373
68319
81284
94125
121362
156643
153541
169573
167578
160191
143422
108756
107459
Blocks
16233
18722
19690
20561
23062
25302
28235
31802
31111
32533
32748
31485
28656
24425
23264
ASNs
4797
5373
5334
5351
5624
6154
6261
6702
6435
6585
6700
6512
5975
5272
5009
Global Victims
End Hosts
15571
19321
25504
28614
36765
42070
60866
83178
81684
88840
87550
82881
69340
52371
53233
End Host % IPs per Block
3.08
3.20
3.37
3.32
3.52
3.72
4.30
4.93
4.94
5.21
5.12
5.09
5.00
4.45
4.62
31.2
32.2
38.4
41.9
45.2
44.7
50.1
53.1
53.2
52.4
52.2
51.7
48.4
48.1
49.5
April tends to be sparse, helping explain remediation slow-down,
perhaps.
3.2 NTP monlist Ampliﬁer Power
To begin to characterize the threat that this ampliﬁer pool posed,
we ﬁrst aggregated the on-wire bytes of all monlist responses from
each queried ampliﬁer over the course of the ONP data collection
weeks. As shown in Figure 4a, which plots the average per-sample
on-wire bytes (i.e., packet bytes plus all Ethernet framing and over-
head), there is a large range of data returned for the single monlist
query packet. We ﬁnd a median of 942 bytes for monlist responses,
and maximum sizes for a given sample were typically in the tens to
a hundred megabytes. Surprisingly, however, a small fraction of am-
pliﬁers responded with much more data than the monlist command
should ever return; in one case, this was as high as 136 Gigabytes.
We discuss these “mega ampliﬁers” in § 3.4. The ﬁgure also shows
the response sizes to the version command, discussed in § 3.3.
A key feature of a good candidate service for use in ampliﬁcation
attacks is that it has a high asymmetry of responses to queries, (i.e.,
a high packet- or bandwidth ampliﬁcation factor (BAF)). Thus, the
servers that return the most packets or bytes for every packet or
byte sent are the most powerful weapons for attacks. For simplicity,
we focus just on bandwidth ampliﬁcation in our analyses. We also
caution that attackers may “prime” their ampliﬁers by ﬁrst making
connections from various IPs in order to make sure that the monlist
table returns the maximum number of entries (600) when later
sending trafﬁc to victims. Thus, actual effects on victims may be
larger when attackers make this effort.
To measure this relative power of the global population of vul-
nerable ampliﬁers over time, we calculated the aggregate on-wire
bytes from each ampliﬁer in the ONP data and divided that by the