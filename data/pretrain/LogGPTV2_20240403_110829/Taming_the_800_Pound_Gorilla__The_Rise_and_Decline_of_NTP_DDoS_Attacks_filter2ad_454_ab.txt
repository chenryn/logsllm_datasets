### NTP Monlist Amplifiers and Their Characteristics

#### 1. Global Dispersion and Remediation Rates

In Figure 3, we present the number of global NTP monlist amplifiers, including network-level aggregation, which highlights the global dispersion and varying remediation rates. The figure also includes lines labeled "Merit" and "CSU(FRGP)"—we will elaborate on these later. Initially, the global amplifier population is approximately 1.4 million in the first half of January. As the internet community begins to patch servers and block certain NTP requests, the population steadily declines until mid-March, when it stabilizes at around 110,000 amplifiers. We will discuss operator mitigation and amplifier remediation in Section 6.

#### 2. Churn in the Amplifier Population

Next, we examined the churn in the amplifier population over a 15-week measurement period. During this time, we identified 2,166,097 unique amplifier IPs. The first weekly sample captured only about 60% of these unique IPs, and new amplifiers were discovered in every scan. Approximately half of the amplifiers were seen in only one of the fifteen weekly scans, partly due to the rapid remediation of the amplifier population. Another factor is that a significant fraction (13%–35%) of these NTP servers are running on end-user (i.e., residential) machines, which may be subject to DHCP churn.

The left half of Table 1 shows the percentage of each sample's IPs that are "end hosts" according to the Spamhaus Policy Block List (PBL) [34], taken on April 18th, 2014. The PBL identifies end-user IP addresses, and there is independent evidence that PBL-labeled IPs are indeed residential [7]. Additionally, we calculated the average number of IPs per routed block, which starts at a peak of 22 and declines toward 4. This indicates that initially, the pool of vulnerable servers included many large groups of closely-addressed (and thus likely managed together) server machines. Over time, the remaining population became more dispersed.

#### 3. NTP Monlist Amplifier Power

To characterize the threat posed by this amplifier pool, we aggregated the on-wire bytes of all monlist responses from each queried amplifier over the course of the ONP data collection weeks. As shown in Figure 4a, which plots the average per-sample on-wire bytes (i.e., packet bytes plus all Ethernet framing and overhead), there is a wide range of data returned for a single monlist query packet. The median response size for monlist queries is 942 bytes, with maximum sizes typically in the tens to hundreds of megabytes. Surprisingly, a small fraction of amplifiers responded with much more data than expected; in one case, this was as high as 136 gigabytes. We will discuss these "mega amplifiers" in Section 3.4. The figure also shows the response sizes to the version command, discussed in Section 3.3.

A key feature of a good candidate service for use in amplification attacks is a high asymmetry of responses to queries, i.e., a high packet- or bandwidth amplification factor (BAF). Servers that return the most packets or bytes for every packet or byte sent are the most powerful weapons for attacks. For simplicity, we focus on bandwidth amplification in our analyses. We also caution that attackers may "prime" their amplifiers by first making connections from various IPs to ensure that the monlist table returns the maximum number of entries (600) when later sending traffic to victims. Thus, actual effects on victims may be larger when attackers make this effort.

To measure the relative power of the global population of vulnerable amplifiers over time, we calculated the aggregate on-wire bytes from each amplifier in the ONP data and divided that by the input query size. This provided us with the BAF, which is crucial for understanding the potential impact of these amplifiers in DDoS attacks.