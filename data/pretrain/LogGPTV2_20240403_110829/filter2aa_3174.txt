# Breaking Bluetooth by Being Bored
## JP Dunning
### DefCon 2010
© Shadow Cave LLC

**JP Dunning**
- **Position:** Graduate Student, Computer Science, Virginia Tech
- **Research Focus:** Wireless and Portable Security
- **Website:** [www.hackfromacave.com](http://www.hackfromacave.com)
- © Shadow Cave LLC

## Overview of Bluetooth
- **Standard:** IEEE 802.15.1
- **Characteristics:**
  - Low Power
  - Short Range
  - Ad-Hoc (Piconet)
- **Deployment:** Over 1 billion devices worldwide

## Obfuscation and Reconnaissance
© Shadow Cave LLC

### Cloning/Spoofing Profile
- **Bluetooth Profile Components:**
  - Device Address
  - Device Class
  - Device Name
- **Bluetooth Profile Cloning:**
  - Modify the host Bluetooth Adapter profile to match another device's profile.
  - Can be done manually using `hciconfig` and `bdaddr`.
- **Bluetooth Profile Spoofing:**
  - Create a misleading profile for the host Bluetooth Adapter.

## SpoofTooph
- **Purpose:** Automate and simplify the Bluetooth profile modification process.
- **Use Cases:**
  - Obfuscation
  - Impersonation
  - Observation
- **Modes:**
  1. **Scan and Clone:**
     - Command: `spooftooph -i hci0 -s -d scan.log`
     - Function: Scan local area for devices, save a list of found devices, and select a device to clone.
  2. **Random Generation:**
     - Command: `spooftooph -i hci0 -r`
     - Function: Generate a random Bluetooth profile.
     - **Details:**
       - Device Class: Random valid class
       - Device Name: One of the 100 most popular American names + device type
       - Device Address: Random MAC address
  3. **Specify Details:**
     - Command: `spooftooph -i hci0 -n new_name -a 00:11:22:33:44:55 -c 0x4a010c`
     - Function: Manually specify the name, class, and address.
  4. **Clone from Log:**
     - Command: `spooftooph -i hci0 -l scan.log`
     - Function: Read a previously logged scan and select a device to clone.
  5. **Incognito Mode:**
     - Command: `spooftooph -i hci0 -t 10`
     - Function: Scan for devices every X seconds and clone the first profile on the list.

## Bluetooth Profiling Project
- **Objective:** Collect Device Name, Device Address, and Device Class from as many devices as possible.
- **Comparison:** Similar to Josh Wright's Bnap, but focuses on collecting device profiles.
- **Data Collected:** Over 1,500 device profiles so far.
- **Uses of Data:**
  - Mapping the address range of Bluetooth
  - Improving Redfang discovery scans
  - Matching address ranges with device models
  - Research
  - Discovering information disclosure

### Information Disclosure
- **Device Address:**
  - The first 24 bits are Organizationally Unique Identifiers (OUI), registered to specific entities.
  - Often, a subset of these address ranges is used for specific device models.
  - Reverse engineering can be used to guess the address based on the device model.
- **Device Name:**
  - **First Name:** Presumably the first name of the device owner.
  - **Last Name:** Presumably the last name of the device owner.
  - **Nickname/Handle:** User name or handle.
  - **Location:** Information that can determine the location of the device.
  - **Device Model:** Identifying information that can lead to profiling the device as a specific model.

### Sensitive Information Disclosure
- **Percentage of Device Names Disclosing Sensitive Information (out of 1,500 profiles):**
  - First Name: 28.17%
  - Last Name: 18.76%
  - Location: 1.30%
  - Device Model: 70.54%
  - Nickname/Handle: 1.51%

## Mall Nibbling
- **Definition:** Collecting information on Bluetooth devices at a local mall.
- **Things to Know:**
  - Use a Class 1 Bluetooth dongle (optional cantenna attachment recommended).
  - Obfuscate your Bluetooth interface.
  - Plan on spending at least 1 minute per location for each scan, as getting the device name requires a follow-up request.

## Offensive Tools
© Shadow Cave LLC

### vCardBlaster
- **vCard:** "Virtual Business Card" used to exchange personal information.
- **Capabilities:**
  - Send a constant stream of vCards over Bluetooth.
  - Users can select a single target or attack all devices in range.
  - vCards can be specified or generated by vCardBlaster.
- **DoS Attack:**
  - Some devices automatically add received vCards to the local contact list.
  - Sending a flood of vCards can fill up the contact list with false contacts.

### Blueper
- **Capabilities:**
  - Send a constant stream of files over Bluetooth.
  - Users can select a single target or attack all devices in range.
  - Files can be specified or generated.
  - Users can specify file size.
- **DoS Attack:**
  - Some devices cache files sent over Bluetooth OBEX before prompting the user to accept or reject the transfer.
  - Sending files over extended periods can fill up the disk, potentially causing a system crash.

### Pwntooth
- **Description:** Suite of Bluetooth attack tools designed to automate multiple attacks against multiple targets.
- **Bundled Tools:**
  - Bluetooth Stack Smasher
  - BT_AUDIT
  - Bluesnrf
  - Blueper
  - vCardBlaster
- **Configuration:**
  - Uses a user-defined config file as an attack script.
  - Config file uses `*` as a wildcard character for device addresses.
- **Example Command:**
  - `pwntooth -l logfile.txt -s 10`: Scan an area 10 times and save output to `logfile.txt` using the default config.

## Project Pages
- **SpoofTooph:** [http://www.hackfromacave.com/projects/spooftooph.html](http://www.hackfromacave.com/projects/spooftooph.html)
- **Bluetooth Profiling Project:** [http://www.hackfromacave.com/projects/bpp.html](http://www.hackfromacave.com/projects/bpp.html)
- **vCardBlaster:** [http://www.hackfromacave.com/vcardblaster.html](http://www.hackfromacave.com/vcardblaster.html)
- **Blueper:** [http://www.hackfromacave.com/blueper.html](http://www.hackfromacave.com/blueper.html)
- **Pwntooth:** [http://www.hackfromacave.com/pwntooth.html](http://www.hackfromacave.com/pwntooth.html)

© Shadow Cave LLC