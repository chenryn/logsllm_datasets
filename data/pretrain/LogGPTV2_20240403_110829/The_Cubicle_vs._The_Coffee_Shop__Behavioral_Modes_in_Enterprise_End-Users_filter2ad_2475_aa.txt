title:The Cubicle vs. The Coffee Shop: Behavioral Modes in Enterprise End-Users
author:Fr&apos;ed&apos;eric Giroire and
Jaideep Chandrashekar and
Gianluca Iannaccone and
Konstantina Papagiannaki and
Eve M. Schooler and
Nina Taft
The Cubicle vs. The Coﬀee Shop: Behavioral
Modes in Enterprise End-Users
Fr´ed´eric Giroire1, Jaideep Chandrashekar2, Gianluca Iannaccone2,
Konstantina Papagiannaki2, Eve M. Schooler2, and Nina Taft2
1 INRIA, France
PI:EMAIL
2 Intel Research
PI:EMAIL
Abstract. Traditionally, user traﬃc proﬁling is performed by analyz-
ing traﬃc traces collected on behalf of the user at aggregation points
located in the middle of the network. However, the modern enterprise
network has a highly mobile population that frequently moves in and
out of its physical perimeter. Thus an in-the-network monitor is unlikely
to capture full user activity traces when users move outside the enter-
prise perimeter. The distinct environments, such as the cubicle and the
coﬀee shop (among others), that users visit, may each pose diﬀerent con-
straints and lead to varied behavioral modes. It is thus important to ask:
is the proﬁle of a user constructed in one environment representative of
the same user in another environment?
In this paper, we answer in the negative for the mobile population of
an enterprise. Using real corporate traces collected at nearly 400 end-
hosts for approximately 5 weeks, we study how end-host usage diﬀers
across three environments: inside the enterprise, outside the enterprise
but using a VPN, and entirely outside the enterprise network. Within
these environments, we examine three types of features: (i) environment
lifetimes, (ii) relative usage statistics of network services, and (iii) outlier
detection thresholds as used for anomaly detection. We ﬁnd signiﬁcant
diversity in end-host behavior across environments for many features,
thus indicating that proﬁles computed for a user in one environment yield
inaccurate representations of the same user in a diﬀerent environment.
1 Introduction
Traditional studies of end-user behavior in a network typically have employed
traﬃc traces collected from network aggregation points (routers, switches, ﬁre-
walls, etc.). In modern enterprise networks, a large sub-population is mobile;
laptop users move seamlessly in and out of the corporate oﬃce daily. When out-
side, the end-hosts are used in a number of places such as homes, airport lounges,
coﬀee shops, etc. The VPN infrastructure of the enterprise ensures that users
are never really cut-oﬀ from the resources on the corporate LAN. In fact, with
the growing trend to support ﬂexible telecommuting policies, and the ubiquity
M. Claypool and S. Uhlig (Eds.): PAM 2008, LNCS 4979, pp. 202–211, 2008.
c(cid:2) Springer-Verlag Berlin Heidelberg 2008
The Cubicle vs. The Coﬀee Shop: Behavioral Modes in Enterprise End-Users
203
of network connectivity while outside the corporate network, users spend fewer
hours physically within the oﬃce cubicle, or at least within a single work locale.
Usage models are quite diﬀerent inside and outside the oﬃce for a variety of
reasons. Infrastructure services (email, directory, and print services) may sim-
ply be unavailable when users are outside the enterprise. Furthermore, locations
outside the enterprise often have noticeable resource limitations (less bandwidth,
less security, et cetera). Thus, users may be hampered from listening to stream-
ing music, or may be wary of checking bank accounts when in a coﬀee shop.
Conversely, the corporate acceptable usage policy may prohibit peer-to-peer ﬁle
sharing applications on the corporate LAN, whereas it may be a staple applica-
tion at home.
Previous work on building user-based proﬁles, such as in [1,2,3,4,5], does not
consider the modality of the end-host when it is outside the enterprise. We argue
that the growing trend to work outside the oﬃce and the distinct “usage-models”
across the diﬀerent environments, renders the single-view proﬁle of the end-
host (like the one generated from enterprise measurements alone) incomplete.
In this paper, we explore the hypothesis that a single (static) proﬁle for an
end-host is inconsistent and/or incomplete. This has important consequences
across the domains of enterprise security, network design, capacity planning and
provisioning.
We analyze detailed traﬃc traces from a real corporate enterprise, where the
traces were collected on the end-hosts themselves. This is in stark contrast to
previous enterprise studies based on aggregate traﬃc, such as in [6,7]. With
these traces, we quantify the diﬀerences in behavior of the individual end-hosts
across three diﬀerent environments in which they operate: (i) inside the corpo-
rate enterprise, (ii) outside but connected through the corporate VPN, and (iii)
outside, meaning disconnected from the enterprise altogether. To the best of our
knowledge, this dataset is the ﬁrst to capture traﬃc at end-hosts themselves. By
collecting traces in-situ, rather than in network, we are able to correctly track a
host’s traﬃc even when its address, location, and/or network interface changes -
avoiding the diﬃculties posed by DHCP address changes and host mobility that
can thwart the accuracy of in-network traﬃc traces.
In this initial exploration of the “environment diversity” hypothesis, we fo-
cus on three distinct types of features. These are (i) the median duration of a
user’s presence in each environment, (ii) the relative usage of network services
(destination IP ports) per environment for end-hosts, and (iii) outlier detection
thresholds (the 95th percentile) for TCP/UDP/ICMP connection counts as used
by anomaly detection.
The contributions in this paper improve and clarify our understanding of end-
host user proﬁles. Although our central hypothesis, i.e., that proﬁles need to
change across environments, seems obvious, there has been no previous research
quantifying such a hypothesis. This is most likely due to lack of availability of
the right kind of data for such a study. This paper aims to explore this gap in
end-host traﬃc characterization.
204
F. Giroire et al.
2 Data Description
Our dataset consists of packet traces collected at nearly 400 enterprise end-
hosts (5% desktops and the rest, laptops) spanning approximately 5 weeks. A
novel aspect to these traces is that they were collected on the individual end-
hosts; this provides visibility into the end-host’s traﬃc even as it leaves the
oﬃce environment. Participants in our data trace collection were geographically
distributed; 73% of the users were from the United States, 13% from Asia, 11%
from Europe, less than 1% in each of Israel, Ireland and Latin America. All but
a few users were based out of large oﬃces in metropolitan areas. All the hosts in
the study ran a corporate standard build of Windows XP. We solicited employees
to sign up on a voluntary basis for the trace collection via organizational mailing
lists, newsletters, and so forth. Cash prizes were oﬀered as an added incentive to
participate. Participants explicitly downloaded and installed the data collection
software on their personal machines, thereby giving consent. We estimate that
approximately 4000 employees were solicited, out of which approximately 1 in 10
installed the software. Overall, the data collection eﬀort yielded approximately
400 GB of traces.
The collection software was written as a wrapper around the windump tool that
logs packets in the well-known pcap format. The wrapper tracked changes in IP
address, interface, or environment; upon such a change, windump was restarted
and a new traceﬁle created. Importantly, every trace ﬁle was annotated with
ﬂags indicating the active network interface, the environment and if the logical
VPN interface was active. Once installed, the software ran continuously (when
the machine was on) for 5 weeks. For some users, it ran a few days less as they
did not install the software immediately. Corporate policy strongly discourages
the use of P2P applications, and hence our set of users is unlikely to be using
any such software, even when outside the corporate environment.
To mitigate privacy concerns, we only collected the ﬁrst 150 bytes of each
packet. We did this simply to be able to infer the actual external destination
when the packets went through the corporate proxy server. After identifying
the actual destination, the payloads were discarded and only the packet headers
retained. The post processing was carried out on a central server where traces
were periodically uploaded. Moreover, all naming information regarding the user
identity or machine identity was discarded upon upload of the traces. All solic-
itation emails contained a complete description of the data to be collected, the
anonymizing procedures, and a disclosure of how the data was intended to be
used. Because of this anonymization, we cannot know which traces came from
engineers, managers, executives, etc.
Importantly, all the end-hosts in the study were personally issued, i.e., there
is a single user per host. This is because in our corporation, each employee is
given one laptop as their primary computer. Some employees, as needed, are
additionally issued desktops; these are primarily used for running tests, simula-
tions, etc. Most employees take their laptops home with them in the evening.
Based on anecdotal evidence, employees generally shy away from allowing family
members or others to use their computers. Hence we expect that the majority of
The Cubicle vs. The Coﬀee Shop: Behavioral Modes in Enterprise End-Users
205
our end-hosts have a single user, even when outside the corporate environment.
Although a single user may use multiple machines, our intent here is not to char-
acterize all aspects of the user at all times. Instead the focus is on all aspects
of how a user uses a particular machine. This is what impacts whether or not a
single machine should switch proﬁles as it, together with a user, moves between
environments. In that sense, it does not matter what the user does with other
machines.
3 Diversity Across Environments
Users move between three diﬀerent environments– that we call inside, vpn, and
outside. In the ﬁrst, inside (the corporate network), the end-host is plugged
into the oﬃce LAN almost always with a wired ethernet connection (on occa-
sion connecting to the wireless LAN). In our enterprise, employees use laptops
as their primary computer system, and while at work, these move between a
docking station (at their desk), meeting rooms, corporate cafeterias, etc. In the
vpn environment, users launch a VPN client that “logically” connects them into
the oﬃce LAN. Note that here, users could be outside the oﬃce (the common
case), or inside where they are on an unsecured wireless network, which exists
solely as a gateway to the VPN, and cannot be used to reach the outside. Finally,
when outside, the user is physically outside the enterprise network, and does
not have any access to any of the enterprise infrastructure services (email, ﬁle &
print server, etc.).
As an initial glance into our data, we show the movements of two users between
these environments. In Fig. 1, we show a three week timeline. Here, the width of
the contiguous blocks denote occupancy in that environment. First, we observe
that both users actually use all three distinct environments. Although not shown
here, due to lack of space, this is true for the vast majority of users (there were
very few exceptions). Second, we note that these two users have very diﬀerent
behaviors in terms of how much time they spend in each environment, and how
frequently they switch between environments. The user on the right is primarily
in vpn, indicating that he may travel considerably or work from home. This user
also tends to leave his VPN connection open during much of the weekend. This
could indicate one of two things, either our user is someone who wants to be able
to respond quickly when email arrives, or someone who perceives (as is common)
that his computer is safer when the VPN is active. In contrast, the user on the
left seems to have a more traditional work and leisure time pattern, using the
inside mode during daytime on weekdays, the vpn mode in the evening on
weekdays, and the outside mode on weekends. Clearly the outside mode for
this user is likely to capture non-oﬃce related activities.
What is obvious here is that diﬀerent users have diﬀerent needs, at diﬀerent
times, to access the resources on the enterprise network. Aside from diversity
across users, it is also natural to expect that a single user carries out diﬀerent
activities in the diﬀerent modes. We now explore such behavior for a variety of
measures.
206
F. Giroire et al.
Fig. 1. A Tale of Two Users: time-line of two end-hosts over a 3 week window in the
trace collection period
3.1 Environment Lifetimes
Motivated by Fig. 1, we ﬁrst ask how much time a user spends in each environ-
ment. We deﬁne environment lifetime as the duration of contiguous time a user
spends in a particular environment before changing it, restarting the machine
or making it hibernate. Studying this statistic is key to solving many network
design and planning problems. For instance, if one could model the time spent
by users logged onto the VPN, the network operators could provision the VPN
lines eﬃciently.
Fig. 2 is a set of scatter plots: each of these plots the median environment
lifetime for individual users for two environments. In ﬁgure 2(a), each (x, y)
point corresponds to a single user: the x value is the median time for inside,
and y corresponds to outside. Similarly, Fig. 2(b) compares the lifetimes over
outside and vpn, and ﬁnally, Fig. 2(c) compares vpn with inside. From these
ﬁgures, it is quite clear that there is a marked diﬀerence in how long, in a
single sittting, a user stays in each of these environments. Not surprisingly, for
the most part, users spend more time inside as compared to the other two
modes. It is interesting to see how short the environment lifetimes typically are
for the outside mode. The lifetime spent outside can be anywhere from half
to 10 times less than the typical lifetime for either the inside or vpn modes.
An intuitive explanation for this could be that (i) the natural workday itself
constitutes a window in which the employee is likely to stay in a single mode,
and in addition (ii) when outside of work, the user’s attention span (and time)
is likely to be partitioned across mornings, evening, weekends, and interrupted
by other domestic activities (meals, kids, etc.) which lead to shorter durations
spent contiguously in the outside mode.
In comparing the environment lifetimes of inside mode versus vpn mode, we