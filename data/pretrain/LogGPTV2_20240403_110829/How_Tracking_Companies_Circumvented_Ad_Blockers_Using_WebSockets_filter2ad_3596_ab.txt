Initiator
facebook
espncdn
h-cdn
doubleclick
slither
google
youtube
cloudﬂare
addthis
hotjar
cloudfront
googlesyndication
adnxs
googleapis
sharethis
# Receivers
Total
A&A
11
35
0
35
0
30
9
29
0
25
11
23
18
8
1
15
8
14
6
13
4
13
6
10
8
3
0
7
6
4
Socket Count
441
92
39
250
33
381
129
873
101
2407
4039
71
31
157
20
Receiver
intercom
33across
zopim
realtime
smartsupp
feedjit
inspectlet
hotjar
disqus
freshrelevance
lockerdome
pusher
velaro
inside-graph
simpleheatmaps
# Initiators
Total
156
57
44
41
26
25
25
17
17
10
10
5
4
2
1
A&A
15
19
12
27
4
10
6
11
13
2
8
3
3
2
1
Socket Count
5534
1381
19820
1612
670
3017
836
2255
4802
404
471
22
62
28
93
Socket Count
TABLE IV: Top 15 initiator/receiver
pairs communicating via WebSockets.
A&A domains are in bold.
Receiver
visitors
realtime
pusher
freshrelevance
zopim
feedjit
intercom
smartsupp
intercom
zopim
intercom
intercom
intercom
intercom
pusher
Initiator
cloudfront
webspectator
cloudfront
cloudfront
google
blogger
hotjar
cdn77
acenterforrecovery
facebook
vatit
plymouthart
welchllp
biozone
getambassador
3304
1285
298
281
172
158
144
122
114
112
110
108
105
101
101
A&A domain to itself
41,056
that of non-A&A sockets. This demonstrates that WebSocket
usage, especially A&A sockets, is widespread amongst top
publishers.
Before and After.
Chrome rolled out the patch for WRB in
version 58 on April 19, 2017. To understand if the release of
the patch affected the usage of WebSockets, we can compare
the statistics in Table I from our crawls before and after this
date. Although we see that there has been a signiﬁcant drop
in the number of unique A&A domains initiating WebSockets
over time (column 4), the fraction of A&A-initiated sockets
has essentially remained the same (column 3). In total, 57
A&A initiators disappeared between our ﬁrst and last crawl,
including Google, Facebook, and AddThis. It is unclear why
these major advertising companies abandoned WebSockets.
With respect to A&A socket receivers, Table I shows that
there has been essentially no change over time (column 6).
As we show in § IV-B, many of the A&A receivers provide
services that are dependent on WebSockets (e.g., real-time
commenting and chat), thus it is not surprising that these
companies have not altered their software.
B. Initiators and Receivers
Next, we take a deeper look into the domains that ini-
tiate and receive WebSockets. Table II shows the top 15
domains whose resources initiate WebSockets; A&A domains
are shown in bold. We observe that scripts from some of
the largest players in the online advertising ecosystem (e.g.,
Google, Facebook, and AppNexus) create WebSockets to
multiple other A&A domains. This demonstrates that major
ad exchanges have embraced WebSockets, although as noted
above, some have discontinued this practice.
Table III shows A&A domains that we observe receiving
WebSocket connections. Only 2.5% of the initiators that create
WebSockets to these domains are A&A domains, meaning
many of the incoming connections are initiated by benign
domains, or even ﬁrst-party publishers. These WebSockets
are particularly problematic with respect to the WRB: since
the scripts that initiated the WebSockets were not blocked
by AdBlock Plus, the only way to stop these connections
would be to block the WebSockets themselves, which was
not possible prior to Chrome 58.
In contrast to the initiators in Table II, the A&A receivers
are less well-known companies that provide a variety of
services. The most recognizable company, Disqus, provides
user comment boards as a service to publishers; it is also
an ad network that enables publishers to monetize their
comment boards by displaying targeted ads. 33across and
Lockerdome are advertising platforms. Inspectlet, Hotjar, and
SimpleHeatmaps are session replay services that track user
interactions within websites to generate detailed analytical
heatmaps of mouse movements, click, and keystrokes [13].
Zopim, Velaro, Smartsupp, and Intercom provide customer
service live-chat widgets.
The variety of business models offered by the receivers in
Table II reveals an important point: WebSockets are being used
to serve advertisements and to track users. The former was
4
 0 0.2 0.4 0.6 0.8 1 1 10 100 1000 10000 100000CDFCount (# sockets)Non A&A IA&A INon A&A RA&A R 0 0.2 0.4 0.6 0.8 1 0 20 40 60 80 100 120 140 160CDFNumber of partiesNon A&A IA&A INon A&A RA&A R 0 0.005 0.01 0.015 0.02 0.025 0.03 0.0350200k400k600k800k1MFraction of SocketsAlexa Site Rank (bins of 10,000)A&ANon A&ATABLE V: Items being sent by and received by A&A domains
via WebSockets and HTTP/S.
Sent Item
User Agent
Cookie
IP
User ID
Screen
Device
Browser
Viewport
Scroll Position
Orientation
First Seen
Resolution
Language
DOM
Binary
No data
Received Item
HTML
JSON
JavaScript
Image
Binary
No data
WebSockets
%
100.0
70.11
6.16
4.25
3.43
3.43
3.43
3.42
3.42
3.42
3.42
3.42
1.81
1.46
1.00
17.92
%
47.57
12.47
0.89
0.31
0.25
21.49
Count
39,893
27,968
2,458
1,694
1,370
1,370
1,368
1,366
1,366
1,366
1,366
1,366
722
581
397
7,150
Count
18,976
4,976
356
125
100
8,575
HTTP/S
Count
99,942,662
22,752,063
896,162
1,116,111
104,794
177,101
89,614
336,704
291
71
8,148
132,742
914,628
8,587
6,267
-
Count
11,599,601
1,633,849
27,027,458
21,324,840
496,929
-
%
100.0
22.77
0.90
1.12
0.10
0.18
0.09
0.34
0.00