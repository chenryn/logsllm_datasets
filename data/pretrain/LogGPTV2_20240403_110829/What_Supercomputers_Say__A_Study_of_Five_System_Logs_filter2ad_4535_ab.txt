WhatSupercomputersSay:AStudyofFiveSystemLogsAdamOliner1StanfordUniversityDepartmentofComputerSciencePaloAlto,CA94305USAoliner@cs.stanford.eduJonStearley2SandiaNationalLaboratoriesAlbuquerque,NM87111USAjrstear@sandia.govAbstractIfwehopetoautomaticallydetectanddiagnosefail-uresinlarge-scalecomputersystems,wemuststudyrealdeployedsystemsandthedatatheygenerate.Progresshasbeenhamperedbytheinaccessibilityofempiricaldata.Thispaperaddressesthatdearthbyexaminingsystemlogsfromﬁvesupercomputers,withtheaimofprovidinguse-fulinsightanddirectionforfutureresearchintotheuseofsuchlogs.Wepresentdetailsaboutthesystems,methodsoflogcollection,andhowalertswereidentiﬁed;proposeasimplerandmoreeffectiveﬁlteringalgorithm;andde-ﬁneoperationalcontexttoencompassthecrucialinforma-tionthatwefoundtobecurrentlymissingfrommostlogs.Themachinesweconsider(andthenumberofprocessors)are:BlueGene/L(131072),RedStorm(10880),Thunder-bird(9024),Spirit(1028),andLiberty(512).Thisistheﬁrststudyofrawsystemlogsfrommultiplesupercomputers.1IntroductionThereliabilityandperformancechallengesofsupercom-putingsystemscannotbeadequatelyaddresseduntilthebe-haviorofthemachinesisbetterunderstood.Inthispaper,westudysystemlogsfromﬁveoftheworld’smostpow-erfulsupercomputers:BlueGene/L(BG/L),Thunderbird,RedStorm,Spirit,andLiberty.Theanalysisencompassesmorethan111.67GBofdatacontaining178,081,459alertmessagesin77categories.Thesystemlogsaretheﬁrstplacesystemadministratorsgowhentheyarealertedtoaproblem,andareoneofthefewmechanismsavailabletothemforgainingvisibilityintothebehaviorofthemachine.Particularlyassystemsgrowinsizeandcomplexity,there1WorkwasdoneatSandiaNationalLaboratories,fundedbytheU.S.DepartmentofEnergyHighPerformanceComputerScienceFellowship.2SandiaisamultiprogramlaboratoryoperatedbySandiaCorporation,aLockheedMartinCompany,fortheUnitedStatesDepartmentofEnergyunderContractDE-AC04-94AL85000.isapressingneedforbettertechniquesforprocessing,un-derstanding,andapplyingthesedata.Wedeﬁneanalerttobeamessageinthesystemlogsthatmeritstheattentionofthesystemadministrator,eitherbecauseimmediateactionmustbetakenorbecausethereisanindicationofanunderlyingproblem.Manyalertsmaybesymptomaticofthesamefailure.Failuresmaybeanythingfromamajorﬁlesystemmalfunctiontoatransientconnec-tionlossthatkillsajob.Usingresultsfromtheanalysis,wegiverecommenda-tionsforfutureresearchinthisarea.Mostimportantly,wediscussthefollowingissues:•Logsdonotcurrentlycontainsufﬁcientinformationtodoautomaticdetectionoffailures,norrootcausedi-agnosis,withacceptableconﬁdence.Althoughiden-tifyingcandidatealertsistractable,disambiguationinmanycasesrequiresexternalcontextthatisnotavail-able.Themostsalientmissingdataisoperationalcon-text,whichcapturesthesystem’sexpectedbehavior.•Thereisachaoticeffectinthesesystems,wheresmalleventsorchangescandramaticallyimpactthelogs.Forinstance,anOSupgradeonLibertyinstan-taneouslyincreasedtheaveragemessagetrafﬁc.OnSpirit,asinglenodeexperiencingdiskfailurepro-ducedthemajorityofalllogmessages.•Differentcategoriesoffailureshavedifferentpredic-tivesignatures(ifany).Eventpredictioneffortsshouldproduceanensembleofpredictors,eachspecializinginoneormorecategories.•Alongwiththeissuesabove,automaticidentiﬁcationofalertsmustdealwith:corruptedmessages,incon-sistentmessagestructureandlogformats,asymmetricalertreporting,andtheevolutionofsystemsovertime.Section3describestheﬁvesupercomputers,thelogcol-lectionpaths,andthelogsthemselves.Section3.2explainsthealerttaggingprocessandnoteswhatchallengeswillbe37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
facedbythosehopingtodosuchtagging(ordetection)au-tomatically.Section4containsgraphicalandtextualex-amplesofthedataandadiscussionoftheimplicationsforﬁlteringandmodeling.Finally,Section5summarizesthecontributionsandourrecommendations.Thepurposeofthispaperisnottoargueforaparticularreliability,availability,andserviceability(RAS)architec-ture,nortocomparethereliabilityofthesupercomputers.Thesystemswestudyarereal,andthelogsareintheformusedby(andfamiliarto)systemadministrators.Ourinten-tionistoelucidatethepracticalchallengesofloganalysisforsupercomputers,andtosuggestfruitfulresearchdirec-tionsforworkindatamining,ﬁltering,rootcauseanalysis,andcriticaleventprediction.Thisistheﬁrstpaper,toourknowledge,thathasconsideredrawlogsfrommultiplesu-percomputingsystems.2RelatedWorkWorkonloganalysisandlarge-systemsreliabilityhasbeenhinderedbyalackofdataabouttheirbehavior.RecentworkbySchroeder[21]studiedfailuresinasetofclustersystemsatLosAlamosNationalLab(LANL)usingtheen-triesinaremedydatabase.Thisdatabasewasdesignedtoaccountforallnodedowntimeinthesesystems,andwaspopulatedviaacombinationofautomaticproceduresandtheextensiveeffortofafull-timeLANLemployee,whosejobwastoaccountforthesefailuresandtoassignthemacausewithinashortperiodoftimeaftertheyhappened.Schroederalsoexaminedcustomer-generateddiskreplace-mentdatabases[22],buttherewasnoinvestigationintohowthesereplacementsweremanifestedinthesystemlogs.Al-thoughsimilarderiveddatabasesexistforthesupercomput-ersconsideredinthispaper,ourgoalwastodescribethebehaviorofthesystemsratherthanhumaninterpretations.ThereisaseriesofpapersonlogscollectedfromBlueGene/L(BG/L)systems.Liang,etal[10]studiedthesta-tisticalpropertiesoflogsfroman8-rackprototypesystem,andexploredtheeffectsofspatio-temporalﬁlteringalgo-rithms.Subsequently,theystudiedpredictionmodels[9]forlogscollectedfromBG/LafteritsdeploymentatLawrenceLivermoreNationalLabs(LLNL).Thelogsfromthatstudyareasubsetofthoseusedinthispaper.Furthermore,theyidentiﬁedalertsaccordingtotheseverityﬁeldofmessages.Althoughitistruethatthereexistsacorrelationbetweenthevalueoftheseverityﬁeldofthemessageandtheactualseverity,wefoundmanymessageswithlowseveritythatindicateacriticalproblemandviceversa.Section3.2elab-oratesonthisclaimanddetailsthemoreintensiveprocessweemployedtoidentifyalerts.Systemlogsforsmallersystemshavebeenstudiedfordecades,focusingonstatisticalmodelingandfailurepre-diction.Tsaodevelopedatupleconceptfordataorganiza-tionandtodealwithmultiplereportsofsingleevents[26].EarlyworkatStanford[13]observedthatfailurestendtobeprecededbyanincreasedrateofnon-fatalerrors.UsingrealsystemdatafromtwoDECVAX-clustermulticomputersystems,Iyerfoundthatalertstendtobecorrelated,andthatthishasasigniﬁcantimpactonthebehaviorandmod-elingofthesesystems[25].LeeandIyer[8]presentedastudyofsoftwarefaultsinsystemsrunningthefault-tolerantGUARDIAN90operatingsystem.Thetaskofautomati-callydiscoveringalertsinlogdatahasbeenexploredfromapattern-learningperspective[7].Therehavealsobeenef-fortsatapplyingdataminingtechniquestodiscovertrendsandcorrelations[12,23,27,28].Inordertosolvethereliabilityandperformancechal-lengesfacingsupercomputerinstallations,wemuststudythemachinesasartifacts,characterizingandmodelingwhattheydoratherthanwhatweexpectthemtodo.Bynumberofprocessorhours(∼774million),thisisthemostexten-sivesystemlogstudytodate.3SupercomputerLogsThebroadrangeofsupercomputersconsideredinthisstudyaresummarizedinTable1.AllﬁvesystemsarerankedontheTop500SupercomputersListasofJune2006[2],spanningarangefrom#1to#445.Theyvarybytwoordersofmagnitudeinthenumberofprocessorsandbyoneorderofmagnitudeintheamountofmainmemory.TheinterconnectsincludeMyrinet,Inﬁniband,GigEthernet,andcustomormixedsolutions.Thevariousmachinesarepro-ducedbyIBM,Dell,Cray,andHP.AllsystemsareinstalledatSandiaNationalLabs(SNL)inAlbuquerque,NM,withtheexceptionofBG/L,whichisatLawrenceLivermoreNa-tionalLabs(LLNL)inLivermore,California.3.1LogCollectionItisstandardpracticetologmessagesandeventsinasupercomputingsystem;nospecialinstrumentationnormonitoringwasaddedforthisstudy.Table2presentsanoverviewofthelogs.Theremainderofthissectionfocusesontheinfrastructurethatgeneratedthem.OnThunderbird,Spirit,andLiberty,logsaregeneratedoneachlocalmachinebysyslog-ngandbothstoredto/var/log/andsenttoaloggingserver.Theloggingservers(tbird-admin1onThunderbird,sadmin2onSpirit,andladmin2onLiberty)processtheﬁleswithsyslog-ngandplacetheminadirectorystructureac-cordingtothesourcenode.Wecollectedthelogsfromthatdirectory.Asisstandardsyslogpractice,theUDPprotocolisusedfortransmission,resultinginsomemessagesbeinglostduringnetworkcontention.37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
SystemOwnerVendorTop500RankProcsMemory(GB)InterconnectBlueGene/LLLNLIBM113107232768CustomThunderbirdSNLDell6902427072InﬁnibandRedStormSNLCray91088032640CustomSpirit(ICC2)SNLHP20210281024GigEthernetLibertySNLHP445512944MyrinetTable1.Systemcharacteristicsatthetimeofcollection.Externalsystemnamesareindicatedinparentheses.SomeinformationwasobtainedfromtheTop500Supercomputerlist[2].Themachinesarerepresentativeofthedesignchoicesandscalesseenincurrentsupercomputers.SystemStartDateDaysSize(GB)CompressedRate(bytes/sec)MessagesAlertsCategoriesBlueGene/L2005-06-032151.2070.11864.9764,747,963348,46041Thunderbird2005-11-0924427.3675.7211298.146211,212,1923,248,23910RedStorm2006-03-1910429.9901.2153337.562219,096,1681,665,74412Spirit(ICC2)2005-01-0155830.2891.678628.257272,298,969172,816,5648Liberty2004-12-1231522.8200.622835.824265,569,2312,4526Table2.Logcharacteristics.Morealertsdoesnotimplyalessreliablesystem-italsoreﬂectstheredundancyofthereportingandthepreferencesofthesystemadministrators.Alertsweretaggedintocategoriesaccordingtotheheuristicssuppliedbytheadministratorsfortherespectivesystems,asdescribedinSection3.2.Twoalertsareinthesamecategoryiftheyweretaggedbythesameexpertrule;thecategoriescolumnindicatesthenumberofcategoriesthatwereactuallyobservedineachlog.CompressionwasdoneusingtheUnixutilitygzip.RedStormhasseveralloggingpaths[1].DiskandRAIDcontrollermessagesintheDDNsubsystempassthrougha100MegabitnetworktoaDDN-speciﬁcRASmachine,wheretheyareprocessedbysyslog-ngandstored.Sim-ilarly,allLinuxnodes(login,LustreI/O,andmanagementnodes)transmitsyslogmessagestoadifferentsyslog-ngcollectornodeforstorage.Allothercomponents(com-putenodes,SeaStarNICs,andhierarchicalmanagementnodes)generatemessagesandeventswhicharetransmittedthroughtheRASnetwork(usingthereliableTCPprotocol)totheSystemManagementWorkstation(SMW)forauto-matedresponseandstorage.Ourstudyincludesalloftheselogs.OnBG/L,loggingismanagedbytheMachineManage-mentControlSystem(MMCS),whichrunsontheservicenode,ofwhichtherearetwoperrack[3].Computechipsstoreerrorslocallyuntiltheyarepolled,atwhichpointthemessagesarecollectedviatheJTAG-mailboxproto-col.Thepollingfrequencyforourlogswassetataroundonemillisecond.TheservicenodeMMCSprocessthenre-laysthemessagestoacentralizedDB2database.ThatRASdatabasewasthesourceofourdata,andincludeshardwareandsoftwareerrorsatalllevels,fromchipSRAMparityerrorstofanfailures.EventsinBG/LoftensetvariousRASﬂags,whichappearasseparatelinesinthelog.ThetimegranularityforBG/Llogsisdowntothemicrosecond,unliketheone-secondgranularityoftypicalsyslogs.ThisstudydoesnotincludesyslogsfromBG/L’sLustreI/Oclus-terandshareddisksubsystem.RawFilteredTypeCount%Count%Hardware174,586,51698.041,99918.78Software144,8990.086,81464.01Indeterminate3,350,0441.881,83217.21Table3.Hardwarewasthemostcommontypeofalert,butnotthemostcommontypeoffailure(asestimatedbytheﬁlteredre-sults).Filteringdramaticallychangesthedis-tributionofalerttypes.3.2IdentifyingAlertsForeachofthesystems,weworkedinconsultationwiththerespectivesystemadministratorstodeterminethesubsetoflogentriesthattheywouldtagasbeingalerts.Thus,thealertsweidentifyinthelogsarecertainlyalertsbyourdef-inition,butthesetis(necessarily)notexhaustive.Inall,weidentiﬁed178,081,459alertsacrossthelogs;seeTable2forthebreakdownbysystemandTable4forthealerts,them-selves.Alertswereassignedtypesbasedontheirostensiblesubsystemoforigin(hardware,software,orindeterminate);thisisbasedoneachadministrator’sbestunderstandingofthealert,andmaynotnecessarilyberootcause.Table3presentsthedistributionoftypesbothbeforeandafterﬁl-tering(describedinSection3.3).Notethatmanyofthesealertsweremultiplyreportedbyoneormorenodes(sometimesmillionsoftimes),requiringﬁlteringofthekinddiscussedinSection3.3.Furthermore,itmeansthatthenumberofalertswereportdoesnotneces-37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 
AlertType/Cat.RawFilteredExampleMessageBody(Anonymized)BG/L348,4601202H/KERNDTLB152,73437dataTLBerrorinterruptH/KERNSTOR63,4918datastorageinterruptS/APPSEV49,651138ciod:ErrorreadingmessageprefixafterLOGINMESSAGEonCioStream[...]S/KERNMNTF31,531105LustremountFAILED:bglio11:blockid:locationS/KERNTERM23,33899rts:kernelterminatedforreason1004rts:badmessageheader:[...]S/KERNREC61459Errorreceivingpacketontreenetwork,expectingtype57insteadof[...]S/APPREAD598311ciod:failedtoreadmessageprefixoncontrolstream[...]S/KERNRTSP3983260rtspanic!-stoppingexecutionS/APPRES237013ciod:ErrorreadingmessageprefixafterLOADMESSAGEonCioStream[...]I/APPUNAV20483ciod:Errorcreatingnodemapfromfile[...]I/31Others7186519machinecheckinterruptThunderbird3,248,2392088I/VAPI3,229,194276kernel:[KERNELIB][...](Fatalerror(LocalCatastrophicError))S/PBSCON531816pbsmom:Connectionrefused(111)inopendemux,opendemux:cannot[...]I/MPT4583157kernel:mptscsih:ioc0:attemptingtaskabort!(sc=00000101bddee480)H/EXTFS4022778kernel:EXT3-fserror(devicesda5):[...]DetectedabortedjournalS/CPU2741367kernel:Losingsometicks...checkingifCPUfrequencychanged.H/SCSI2186317kernel:scsi0(0:0):rejectingI/OtoofflinedeviceH/ECC146143ServerAdministrator:InstrumentationServiceEventID:1404Memorydevice[...]S/PBSBFD2828pbsmom:Badfiledescriptor(9)intmrequest,job[job]notrunningH/CHKDSK132check-disks:[node:time],FaultStatusassert[...]I/NMI84kernel:Uhhuh.NMIreceived.Dazedandconfused,buttryingtocontinueRedStorm1,665,7441430H/BUSPAR1,550,2175DMTHINTWarning:VerifyHost2busparityerror:0200Tier:5LUN:4[...]I/HBEAT94,784266echeartbeatstop|src:::[node]|svc:::[node]warn|nodeheartbeatfault|[...]I/PTLEXP11,047421kernel:LustreError:[...]@@@timeout(sentat[time],300sago)[...]H/ADDRERR67631DMT102AddresserrorLUN:0command:28address:f000000length:1Anonymous[...]H/CMDABORT1686497DMT310CommandAborted:SCSIcmd:2ALUN2DMT310Lane:3T:299a:[...]I/PTLERR63154kernel:LustreError:[...]@@@type==[...]I/TOAST1869ecconsolelog|src:::[node]|svc:::[node]|PANICSPWEARETOASTED!I/EW16358kernel:Lustre:[...]Expiredwatchdogforpid[job]disabledafter[#]sI/WT10745kernel:Lustre:[...]Watchdogtriggeredforpid[job]:itwasinactivefor[#]msI/RBB10519kernel:LustreError:[...]Allmdscraykernnalrequestbuffersbusy(0usidle)H/DSKFAIL5454DMTDINTFailingDisk2AI/OST11kernel:LustreError:[...]FailuretocommitOSTtransaction(-5)?Spirit172,816,5644875H/EXTCCISS103,818,91029kernel:cciss:cmd0000010000a60000hasCHECKCONDITION,sensekey=0x3H/EXTFS68,986,08414kernel:EXT3-fserror(device[device])inext3reserveinodewrite:IOfailureS/PBSCHK83884119pbsmom:taskcheck,cannottmreplyto[job]task1S/GMLANAI1256117kernel:GM:LANaiisnotrunning.Allowingport=0openfordebuggingS/PBSCON81725pbsmom:Connectionrefused(111)inopendemux,opendemux:connect[IP:port]S/GMMAP596180gmmapper[[#]]:assertionfailed.[path]/lxmapper.c:2112(m->root)S/PBSBFD346296pbsmom:Badfiledescriptor(9)intmrequest,job[job]notrunningH/GMPAR16695kernel:GM:TheNICISRisreportinganSRAMparityerror.Liberty24521050S/PBSCHK2231920pbsmom:taskcheck,cannottmreplyto[job]task1S/PBSBFD11594pbsmom:Badfiledescriptor(9)intmrequest,job[job]notrunningS/PBSCON475pbsmom:Connectionrefused(111)inopendemux,opendemux:connect[IP:port]H/GMPAR4419kernel:GM:LANAI[0]:PANIC:[path]/gmparity.c:115:parityint():firmwareS/GMLANAI1310kernel:GM:LANaiisnotrunning.Allowingport=0openfordebuggingS/GMMAP22gmmapper[736]:assertionfailed.[path]/mi.c:541(r==GMSUCCESS)Table4.Examplealertmessagesfromthesupercomputers.Systemnamesarelistedwiththetotalnumberalertsbeforeandafterﬁltering.“Cat.”isthealertcategory.TypesareH(Hardware),S(Soft-ware),andI(Indeterminate).Indeterminatealertscanoriginatefrombothhardwareandsoftware,orhaveunknowncause.Duetospace,welistonlythemostcommonofthe41BG/Lalertcategories.Bracketedtextindicatesinformationthatisomitted;abracketedellipsisindicatessundrytext.Alertcategoriesvaryamongmachinesasafunctionofsystemconﬁgurations,loggingmechanisms,andwhateachsystem’sadministratorsdeemimportant.37th Annual IEEE/IFIP International Conference on Dependable Systems and Networks (DSN'07)0-7695-2855-4/07 $20.00  © 2007Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 12:48:03 UTC from IEEE Xplore.  Restrictions apply. 