子元素
• IInncclluuddee
• EExxcclluuddee
有关 include/exclude 的允许属性和子元素，请参阅 include/exclude 的一一般般说说明明((第第221188页页))。此处仅包含与该 EntitySet 类相关的
include/exclude 的特定信息。
PortSets 的 Include/Exclude 的特殊属性：
可将端口的各种其他属性用于 include/exclude 功能测试。这些测试将某个值与端口的属性值作比较；请注意各种属性的平台支持―在平
台（或甚至平台修订版）间并非所有属性均可用，因此在 include/exclude 标记中使用这些测试是受限制的。功能测试支持带有通配符 *
和 ? 的 Unix 全局样式，且不存在规范化的路径分隔符或其他字符—是与属性值的简单匹配。
PPaatthh
检查与端口的路径属性的通配符匹配。以下示例将监控由运行主 IIS 二进制文件的进程拥有的端口：
PPrroocceessss
检查与端口的进程属性的通配符匹配。以下示例将监控由在 svchost.exe 或 outlook.* 二进制文件中运行的任何内容拥有的端口：
UUsseerr
检查与端口的用户属性的通配符匹配。以下示例将监控 Unix 系统上由超级用户（root 用户）拥有的端口：
235
亚信安全服务器深度安全防护系统 9.6 管理员指南 PortSet
236
亚信安全服务器深度安全防护系统 9.6 管理员指南 ProcessSet
ProcessSet
代表一组进程。
标记属性
相对于完整性监控规则所监控的实体的属性，以下属性是标记本身的 XML 属性。
属属性性 描描述述 必必需需 缺缺省省值值 允允许许值值
onChange 将受实时监控 否 false true、false
实体集属性
以下是可由完整性监控规则监控的实体的属性。
• CCoommmmaannddLLiinnee::由 "ps -f" (Unix)、"ps w" (Linux) 或 Process Explorer (Windows) 显示的完整命令行。
• GGrroouupp：：在之下运行进程的组。在 Unix 下，该属性指进程的“有效”组 ID，可以随时间更改（如果进程丢弃权限或者切换
其有效组凭证）。在 Windows 上，该属性是由 Win32 API GetTokenInformation（带有 TokenPrimaryGroup 的
TokenInformationClass）返回的进程的当前主组。这是新创建的对象的缺省主组 SID。除主组之外，进程通常具有一个或多
个组凭证与之关联。客户端不监控这些附加的组凭证 — 可以在 Process Explorer 的 process 属性的“安全”选项卡上查看
这些凭证。
• PPaarreenntt：：创建此进程的进程的 PID。
• PPaatthh：：进程的二进制文件的完整路径。在 Solaris 8 和 9 或 HP-UX 上不可用。在 Windows 上，该路径来自
GetModuleFileNameEx() API。在 Linux 和 Solaris 10 上，它来自分别读取符号链接 /proc/{pid}/exe 或
/proc/{pid}/path/a.out。
• PPrroocceessss：：进程二进制文件的简短名称（无路径）。例如，对于 "c:\windows\notepad.exe"，该属性为 "notepad.exe"，对于
"/usr/local/bin/httpd"，为 "httpd"。
• TThhrreeaaddss：：当前在进程中执行的线程数。在 HP-UX 上不可用。
• UUsseerr：：在之下运行进程的用户。在 Unix 下，该属性指进程的“有效”用户 ID，可以随时间更改（如果进程丢弃权限或者切换
其有效用户凭证）。
速记属性
• SSTTAANNDDAARRDD：：CommandLine、Group、Parent、Path（如果可用）、Process User
"Key" 的含义
Key 是 "Process" 属性（可执行文件的简短名称）和 PID 的组合。将 PID 附加到中间带有路径分隔符的名称，例如，Windows 上的
notepad.exe\1234 和 Unix 上的 httpd/1234。使用路径分隔符是为了使 key="abc/*" 的 include/exclude 匹配能够按预期工作。
子元素
• IInncclluuddee
• EExxcclluuddee
237
亚信安全服务器深度安全防护系统 9.6 管理员指南 ProcessSet
请参阅 include 的概概述述((第第221188页页))，了解其允许的属性和子元素。此处仅包含与该 EntitySet 类相关的 include/exclude 的特定信
息。
ProcessSets 的 Include/Exclude 的特殊属性：
以下示例将监控正在运行的进程集是否具有 notepad.exe（不论 PID. 如何）：
可将进程的各种其他属性用于 include/exclude 功能测试。功能测试支持带有通配符 * 和 ? 的 Unix 全局样式，且不存在规范化的路径
分隔符或其他字符 — 它是与属性值的简单全局样式匹配。
CCoommmmaannddLLiinnee
检查与进程的 commandLine 属性的通配符匹配。以下示例将监控命令行匹配 "*httpd *" 的所有进程：
GGrroouupp
检查与进程的 group 属性的通配符匹配。使用组名的文本版本，而不是数字形式：使用 "daemon" 而不是 "2" 来测试 Linux 上的 daemon
组。以下示例将监控以组 root、daemon 或 lp 身份之一运行的所有进程：
PPaatthh
检查与进程的 path 属性的通配符匹配。path 属性在某些平台上不可用。以下示例将监控二进制文件位于 System32 下的所有进程：
UUsseerr
检查与进程的 user 属性的通配符匹配。使用用户名的文本版本，而不是数字形式：使用 "root" 而不是 "0"（零）来测试 Unix 上的
超级用户。以下示例将监控以内置系统用户身份（例如，NT AUTHORITY\SYSTEM、NT AUTHORITY\LOCAL SERVICE、NT AUTHORITY\NETWORK
SERVICE）之一运行的所有进程：
238
亚信安全服务器深度安全防护系统 9.6 管理员指南 RegistryKeySet
RegistryKeySet
RegistryKeySet 标记描述了注册表中的一组项（仅限 Windows）。
标记属性
相对于完整性监控规则所监控的实体的属性，以下属性是标记本身的 XML 属性。
属属 必必 缺缺省省
描描述述 允允许许值值
性性 需需 值值
设置 RegistryKeySet 的基本项。该标记中的所有其他内容都与此项有关。基本项必须以下列注册表分
支名称之一开头：
HKEY_CLASSES_ROOT（或 HKCR）、 解析为语法上有效的注册表项路径的
base 是 N/A
HKEY_LOCAL_MACHINE（或 HKLM）、 字符串值
HKEY_USERS（或 HKU）、
HKEY_CURRENT_CONFIG（或 HKCC）
实体集属性
以下是可由完整性监控规则监控的实体的属性。
• OOwwnneerr
• GGrroouupp
• PPeerrmmiissssiioonnss
• LLaassttMMooddiiffiieedd（Windows 注册表术语中的 "LastWriteTime"）
• CCllaassss
• SSeeccuurriittyyDDeessccrriippttoorrSSiizzee
速记属性
• SSTTAANNDDAARRDD：：Group、Owner、Permissions、LastModified
"Key" 的含义
注册表项以层次结构形式存储在注册表中，与文件系统中的目录非常相似。就该语言而言，某项的“项路径”可理解为相当于目录的路
径。例如，客户端的“亚信安全服务器深度安全防护系统客户端”项的“项路径”为：
HKEY_LOCAL_MACHINE\SOFTWARE\AsiaInfo Security\Deep Security Agent
RegistryValueSet 的 include/exclude "key" 值与项路径匹配。这是一种层次结构模式，其中由 "/" 分隔的模式部分与由 "\" 分隔的
项路径部分相匹配。
子元素
• IInncclluuddee
• EExxcclluuddee
239
亚信安全服务器深度安全防护系统 9.6 管理员指南 RegistryKeySet
请参阅 include 的概概述述((第第 221188页页))，了解其允许的属性和子元素。
240
亚信安全服务器深度安全防护系统 9.6 管理员指南 RegistryValueSet
RegistryValueSet
一组注册表值（仅限 Windows）。
标记属性
相对于完整性监控规则所监控的实体的属性，以下属性是标记本身的 XML 属性。
属属 必必 缺缺省省
描描述述 允允许许值值
性性 需需 值值
设置 RegistryValueSet 的基本项。该标记中的所有其他内容都与此项有关。基本项必须以下列注册表分
支名称之一开头：
HKEY_CLASSES_ROOT（或 HKCR）、 解析为语法上有效的注册表项的字
base 是 N/A
HKEY_LOCAL_MACHINE（或 HKLM）、 符串值
HKEY_USERS（或 HKU）、
HKEY_CURRENT_CONFIG（或 HKCC）
实体集属性
以下为可由完整性监控规则监控的实体的属性：
• Size
• Type
• Sha1
• Sha256
• Md5
速记属性
• CCOONNTTEENNTTSS：：解析为在策策略略//计计算算机机编编辑辑器器 >> 完完整整性性监监控控 >> 高高级级中设置的内容哈希算法。
• SSTTAANNDDAARRDD：：Size、Type、Contents
"Key" 的含义
注册表值是存储在注册表项下的名称/值对。存储注册表值的项可能会存储在其他项下，与文件系统中的文件和目录非常相似。就该语言
而言，某值的“项路径”可理解为相当于文件的路径。例如，客户端的 InstallationFolder 值的“项路径”为：
HKEY_LOCAL_MACHINE\SOFTWARE\AsiaInfo Security\Deep Security Agent\InstallationFolder
RegistryValueSet 的 include/exclude "key" 值与项路径匹配。这是一种层次结构模式，其中由 "/" 分隔的模式部分与由 "\" 分隔的
项路径部分相匹配
缺省值
每个注册表项都具有未命名值或缺省值。
以下适用于旧版支持：http://blogs.msdn.com/oldnewthing/archive/2008/01/18/7145021.aspx
241
亚信安全服务器深度安全防护系统 9.6 管理员指南 RegistryValueSet
可通过在模式中使用尾随的 "/" 明确为 inclusion/exclusion 指定此值。例如，"**/" 将匹配所有下级未命名值，"*Agent/**/" 将匹配
与 "*Agent" 匹配的项下的所有未命名值。
注意： 注册表值名称可包含任意可打印字符，包括引号、反斜线、"@" 符号等。
客户端将实体项名称中的反斜线作为转义符，但仅转义反斜线本身。这样，客户端即可区分包含反斜线的值名称和作为注册表路径一部分
出现的反斜线之间的差异。这表示，以反斜线字符结尾的值名称将与旨在匹配缺省/未命名值的规则相匹配。
有关示例注册表值名称和生成的实体项，请参阅下表。
值值 转转义义格格式式 示示例例
Hello Hello HKLM\Software\Sample\Hello