We collected RTT data for 50 calls, 25 of which experienced
rerouting. To determine if the two groups are statistically
different, we performed a power analysis on the data. This
analysis tells us whether or not there exists a statistically
signiﬁcant difference between regular and attack calls. With
a p <0. 001, we calculated a power of 1.0 and a sample size
of 10 per class. Accordingly, we were easily able to reject the
577
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:30:21 UTC from IEEE Xplore.  Restrictions apply. 
Fig. 13: Distribution curves for normal and real SS7 redirection
attack impacted calls. The curve is a plot of probability density
versus standard deviations. The critical-t value is the point
at which the null hypothesis can be rejected. Our statistical
tests not only demonstrate that our sample is more than large
enough, but also that normal and attack trafﬁc exhibit RTTs
that differ in a statistically signiﬁcant way.
null hypothesis. Figure 13 shows the clear distinction between
normal and attack trafﬁc.
The results of real SS7 rerouting attacks differ from our
attack emulations. On average, an actual SS7 rerouting attack
to San Francisco added an additional second to the average
legitimate call RTT. This is higher than the average time
introduced by rerouting to Moscow, Tokyo, or Tel Aviv in
our testbed. The reason that the time introduced by actual
SS7 rerouting is signiﬁcantly higher than our testbed is due to
additional in-network processing that calls must go through.
Actual SS7 rerouting attacks require the call audio to traverse
additional hardware such as service switching points, signal
transfer points, and service control points. These add latency
to the call before it researches its true destination. Geographic
and technological concerns prevent us from determining the
exact time introduced by additional SS7 hardware and audio
stacks at the network level.
This is the ﬁrst research paper to observe the effects of SS7
rerouting attacks and propose a possible end-to-end solution.
Our emulation is a conservative estimate of actual SS7 rerout-
ing attacks in terms of RTT and because of such, evaluates
our system on a more challenging criteria than what would be
seen with actual SS7 rerouting attacks.
A. Limitations
IX. DISCUSSION
Under certain conditions, detection may have increased
difﬁculty. If an adversary hijacks an SS7 node that is close
to the path a legitimate call would take, Sonar may have
difﬁculty detecting the attack. The RTT increase introduced by
the additional distance the call audio travels will be minimal
in this scenario, however, the time added by the additional
audio stacks and processing at the SS7 node will still remain
the same. In this case, we believe at the worst, Sonar would
perform similarly to the way it did in our emulations. Addi-
tionally, as mentioned in section V, Sonar requires both parties
to actively participate in the protocol for rerouting detection to
occur. This is analogous to traditional distance bounding [4].
Fig. 14: Variation in recorded audio RTTs between our lab
and Boston, MA evenly spaced across a two day period. These
experiments, taken from a Sunday night to a Monday evening,
show only little variation between tests at different times.
and variations in routing paths. Extensive work has been
done in the network measurement communities to characterize
such variations in both traditional and cellular data networks.
However, to our knowledge, a similar public longitudinal study
across telephony voice networks has not been conducted.
We conducted a very small scale study to determine whether
measurements in this space are subject to wide variation. We
are not arguing that this is a comprehensive study, but rather
that our results are a reasonable approximation of normal
network conditions in systems with circuit switched or circuit-
switched-like behavior. Figure 14 is a box plot representing
three sets of audio latency tests collected over a two day span.
These tests were conducted between Cellular devices in our lab
and Boston, MA, and represent collection during a Sunday
evening, Monday morning and Monday evening. This small
study conﬁrms that very little variation was seen during our
testing. We intend to perform such a study in future work.
C. Localizing Callers
Our results showed that RTT was sufﬁcient to determine
that a call is likely rerouted, but that RTT was insufﬁcient to
actually determine the location of the other party. While our
current threat model assumes mutually trusted parties, phone
calls are often used among parties that may not initially trust
each other [29], and having accurate location measurement
would allow us to relax Sonar’s trust assumptions.9
Determining location is hindered by a number of factors, one
of which is that RTT is a scalar value that can only resolve
distance, not position. As a result, accurate and reliable RTT
measurements from multiple positions on the globe would be
necessary to triangulate caller position. Such triangulation is
not possible with a single call. One possibility would be for a
group of mutually trusting collaborators to sequentially call a
proving party to provide triangulation measurements. However,
because an adversary with the ability to redirect calls can
simply choose to not delay some of the triangulation calls, the
adversary has a signiﬁcant amount of power to inﬂuence the
B. Varying Network Conditions
Variations in RTTs occur regularly in networks. These
differences are generally the result of network trafﬁc conditions
9Although we note that Sonar assumes both call parties trust each other,
the Sonar protocol is actually designed such that a prover cannot reduce RTT
because responses depend on a challenge only known to a prover. Note also
that an adversarial prover could still add delay, just not reduce it.
578
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:30:21 UTC from IEEE Xplore.  Restrictions apply. 
measurement. A second issue is that distance bounding only
guarantees a lower bound, not an upper bound; a dishonest
prover could add delay to change their triangulation.
An appealing option might be to leverage conference calls so
that all triangulating parties are on the same call concurrently.
Unfortunately, in most telephone systems conference calls are
implemented using a hub-and-spoke model, where either all
calls are placed to a central bridge or a single call party acts as
the meeting point for all other callers. This means that a group
could conceivably bound the distance to the conference bridge,
but only if that bridge responded honestly to all veriﬁers.
It may be possible to use other features besides RTT to
localize a caller. For example, it may be possible to use sys-
tems that learn noise characteristics of phone calls in various
locations [30] to locate a caller with reasonable accuracy.
However, such techniques would require exhaustive global
characterization, making them impractical at scale. While
delay is unlikely to be useful for localization, future work may
lead to other techniques for call localization.
X. RELATED WORK
SS7 has been known to be vulnerable to compromise for
some time [31], [32]. To date, attack research has detailed how
mobile users may be tracked [6], service may be denied [33],
and how attackers can redirect calls and text messages [33],
[7]. Current defenses against SS7 attacks focus mainly on
network layer ﬁltering [7], [34], [35] and several research
groups have measured the extent of this ﬁltering from a
network perspective [36], [34]. However, this ﬁltering has a
number of problems [34]: it does not address every attack,
not all network equipment supports ﬁltering, when ﬁltering is
implemented it increases load on an already strained network,
and customers of networks that ﬁlter are not protected when
they roam on non-ﬁltering networks. The SnoopSnitch app [37]
offers a mechanism to detect messages sent to a mobile device
indicative of SS7 tracking. However, it relies on capabilities
provided by debug interfaces only available to a select set of
mobile devices, and this detection mechanism is simply not
available for most devices. It is important to note that the
anticipated successor for SS7, Diameter, is also vulnerable to
redirection attacks [35]. Sonar is the ﬁrst system to protect
any type of phone against redirection attacks in any telephone
network – especially those that do not create messages during
interception. Sonar is also the ﬁrst system to be tested against
real SS7 rerouting attack data.
SS7 is not
the only mechanism that can redirect calls
— the Border Gateway Protocol can be exploited to redi-
rect Internet trafﬁc (including VoIP calls). Similar to SS7,
BGP was developed and deployed without mechanisms for
authentication, authorization, or accountability [13]. BGP is
also vulnerable to malicious entities fabricating or modifying
messages. These include announcing fraudulent ownership of
or short routes to targeted IP address blocks. These attacks
redirect ﬂows from the victim IP addresses to the network
controlled by the attacker. It is important to note that while
end-to-end encryption is possible with VoIP calls [38], certain
conﬁgurations are still vulnerable to content recovery [39].
Because Sonar is agnostic to the underlying network topology,
it can also detect redirected VoIP calls.
Sonar builds on prior work in distance bounding protocols.
Though there are many such protocols[40], [41], [21], [42],
[43], [44], none were directly appropriate for our application.
Speciﬁcally, such protocols have been used primarily in short
ranged applications[41], [45], [46], [47], especially with ultra-
wide band (UWB) frequencies[41]. Because of the large dis-
tance range of our application and the variation in signal path
in each phone call, our distance bounding method needed to
accommodate these constraints. Our work is also reminiscent
of research on Internet tomography [48], [49], [50]; however,
the point-to-point nature of phone calls makes such techniques
inappropriate for addressing this particular attack.
Finally,
telephony security has received much attention
over the past few years. This includes taxonomizing [51],
[52] and detecting network-based fraud such as Interconnect
Bypass [53] and OTT bypass [54]. Other work has focused
on problems affecting the end-user, including robocalls [55],
abusive calls [56], [57], and how such calls can support other
types of crime [58], [59]. Efforts to address these problems
has focused either on both detection [60], [61], [62], [30]
and mechanisms to authenticate caller identity [38], [63],
[22], [64]. Additionally, signiﬁcant efforts have identiﬁed ﬂaws
particular to cellular networks [65], [66], [67], [19], [18]
including problems in GSM [68], [69], UMTS [70], [71], [72],
[73], [74], and LTE [75], [76], [77], [78], [79], [80] standards
and the encryption algorithms they use [81], [82].
XI. CONCLUSION
SS7 redirection attacks threaten the conﬁdentiality of all
calls passing through the PSTN. While the ability to redirect
calls is a legitimate feature (e.g., call forwarding), the number
of parties with the ability to perform such an action without
explicit authorization is now large. We design and implement
Sonar as a means of detecting such attacks, which characteristi-
cally increase the latency of call audio what they are executed.
As such, Sonar develops the Rapid Audio Exchange protocol
and a model for correlating distance and RTT. Using calls in
real networks and our own redirection testbed, we demonstrate
the ability to detect such redirections with high accuracy - as
much as 97.0% (0.03% FP) when they leave North America.
We also executed real SS7 attacks and were able to detect them
all. We believe that Sonar can easily be included in future
handset hardware, and represents the best means of reliably
detecting such attacks in the short and medium terms.
ACKNOWLEDGMENTS
This work was supported in part by the US National Science
Foundation under grant numbers CNS-1617474, CNS-1464088
and CNS-1540217. Any opinions, ﬁndings, and conclusions
or recommendations expressed in this material are those of
the authors and do not necessarily reﬂect the views of the
National Science Foundation. We would also like to thank
Assaf Klinger and Vaulto (www.vaulto.co), Amir Houmansadr,
and our anonymous reviewers for their assistance.
579
Authorized licensed use limited to: IEEE Xplore. Downloaded on March 18,2021 at 12:30:21 UTC from IEEE Xplore.  Restrictions apply. 
REFERENCES
[1] The 104th Congress of the United States, “The Telecommunications Act
of 1996,” http://www.fcc.gov/Reports/tcom1996.txt, 1996, Pub. LA. No.
104-104.
[2] S. Alfonsi, “Hacking your phone,” CBS News: 60 Minutes, April 2016.
[3] D.
Bank
Ars
https://arstechnica.com/security/2017/05/
thieves-drain-2fa-protected-bank-accounts-by-abusing-ss7-routing-protocol/,
2017.
“Thieves
Abusing
Accounts
Technica
Goodin,
by
2FA-Protected
Protocol,”
Routing
Drain
SS7
-
[4] G. P. Hancke and M. G. Kuhn, “An RFID Distance Bounding Protocol,”
in First International Conference on Security and Privacy for Emerging
Areas in Communications Networks (SECURECOMM’05), Sep. 2005,
pp. 67–73.
[5] S.
“Congressman
Gallagher,
ﬂaw
phone
Ars
network
https://arstechnica.com/security/2016/08/
Technica
congressman-to-fcc-ﬁx-phone-network-ﬂaw-that-allows-eavesdropping/,
2016.
[6] Tobias Engel, “Tracking Mobile Phones,” http://berlin.ccc.de/∼tobias/
FCC:
Fix
eavesdropping,”
allows
that
to
-
25c3-locating-mobile-phones.pdf, Berlin, 2008.
[8]
[7] Karsten Nohl, “SS7 Attack Update and Phone Phreaking,” https://www.
Cox,
youtube.com/watch?v=BbPLscWQ1Bw, 2016.
J.
answers
ants
senator-demands-answers-from-telecom-giants-on-phone-spying,
sep 2017.
from telecom gi-
https://www.thedailybeast.com/
demands
spying,”
“Senator