trative difﬁculties. Third, we emphasize that we did not manually
investigate all domains – we will thus publish the data sets where
certiﬁcates were different so others can investigate them, too.
Certiﬁcate Issuers. We were interested to see which issuers
occur most commonly, since the corresponding CAs are attack
targets of higher value, due to the higher value of the customer
database. We therefore determined the most common issuers for
certiﬁcates in the data set TUM-Apr2011 (distinct certiﬁcates).
There were 30,487 issuers in total.
Then, we concentrated on issuers that were found in at least
2,000 certiﬁcates.
In total, these issuers accounted for 135,011
certiﬁcates – this is more than half of all distinct certiﬁcates. Fig-
ure 15 presents the top ten. Note, however, that there are close to
200 Root Certiﬁcates in the Firefox Root Store, and several CAs
have actually more than one Root Certiﬁcate in there. Where pos-
sible, we thus identiﬁed issuers as companies with subsidiaries not
grouped together. Obviously, two entries are not companies: as
was explained before, ‘plesk’ as the issuer is an indication of virtu-
alization, and localhost or similar entries were always issuers in
self-signed certiﬁcates.
Further Parameters. We inspected the serial numbers in valid
certiﬁcates and looked for duplicates by the same issuing CA. We
did not ﬁnd any in the last three scans, TUM-Apr2011, TUM-
Nov2010 and TUM-Sep2010. This is a good ﬁnding, as a certiﬁ-
cate’s serial number is intended to be a unique identiﬁer (in fact,
blacklisting of certiﬁcates in so-called revocation lists is done via
the serial numbers).
We also investigated a certiﬁcate property that is not security-
relevant, but interesting nonetheless: X.509 Version 1 is outdated,
and there is no reason to use it anymore. The current version
is X.509 Version 3. We investigated data sets Tue-Nov2009 and
TUM-Apr2011 in this regard. In November 2009, 86.01% of cer-
tiﬁcates were Version 3, 13.99% were Version 1. In April 2011,
85.72% were Version 3 and 14.27% Version 1.
Although our ﬁrst guess was that this is an artifact of measure-
ment, we found that 33,000 certiﬁcates with Version 1 had not been
seen in any previous scan. None of them had valid certiﬁcation
chains, however, and 31,000 of them were self-signed. Of the oth-
ers, the biggest issuer was a Russia-based company. We investi-
438the percentages of absolutely valid certiﬁcates have increased since
2009, but then again only very slightly. Recall that these numbers
refer to the top 1 million hosts – the percentage of certiﬁcates where
the chains are correct is lower for the full IPv4 space than for the
top sites, as we found by examining the EFF data set.
Moreover, many certiﬁcation chains showed more than one er-
ror. Expired certiﬁcates were common, and so were certiﬁcates for
which no Root Certiﬁcate could be found. A further problematic
ﬁnding is that all our data sets reveal a high number of certiﬁcates
that are shared between a large number of hosts. This is even the
case for high-proﬁle Web hosters – and often, the host names do
not match the certiﬁcates there, either. Although offered by several
CAs, Extended Validation certiﬁcates do no seem to be in wide use.
This truly seems a sorry state, and it does not come as a surprise
that users just click away warnings, thus adding to the general inse-
curity of the WWW. As few CAs are responsible for more than half
of the distinct certiﬁcates, one should think the situation should be
better or at least easier to clean up.
There are some more positive tendencies that should be men-
tioned, however. Our evaluation shows that the more popular a
given site is, the more likely it supports TLS/SSL at all, and the
more likely it shows an absolutely valid certiﬁcate. On the whole,
key lengths seem not to constitute a major problem. The same is
true for signature algorithms. Keys with short bit lengths are be-
coming fewer, and the weak MD5 algorithm is clearly being phased
out, too. Over the past 1.5 years, we also found an increase in
the use of intermediate certiﬁcates while chain lengths remained
remarkably short. This is a good development, as end-host cer-
tiﬁcates should not be issued by a Root Certiﬁcate that is used in
online operations. However, use of intermediate certiﬁcates can be
overdone and sometimes is. The latter will add to the already com-
plex certiﬁcation infrastructure that we have encountered, with a
high number of distinct certiﬁcation chains.
Concerning our passive monitoring, the data we obtained al-
lowed us to evaluate negotiated properties of TLS/SSL associa-
tions, which cannot be obtained by active scans. We were able
to determine the negotiated ciphers and digest mechanisms. Our
observations lead us to conclude that most connections use secure
ciphers with acceptable key lengths, and that key lengths are even
increasing over time, with a good security margin. This is in line
with the corresponding trends in certiﬁcate keys. However, MD5
is still commonly used to compute Message Authentication Codes
(MACs). This is not really dramatic at the moment – even now,
collision attacks take at least some seconds, and preimage attacks
much longer. An attacker’s time window is likely too short for a
useful on-the-ﬂy attack at this time (note that TLS/SSL uses a re-
play protection for the payload, too). However, we cannot see a
compelling reason to continue using MD5 for MACs (except pos-
sibly for some very old legacy clients). We feel it should be dis-
couraged and phased out.
With the above mentioned problems in certiﬁcates, however, we
have to conclude that the positive movements do not address the
most pressing problem, which is the certiﬁcation structure itself.
Unfortunately, the general state seems to persist as made evident
by the fact that several critical factors like validity of certiﬁcation
chains, correct host names in certiﬁcates, or plainly the number of
hosts that offer TLS/SSL do not seem to change. As this work has
focused on the top 1 million hosts (scans) and the PKI as accessed
by users (monitoring), this seems to indicate a pressing need.
7. ACKNOWLEDGEMENTS
We thank Nathan Evans and the Leibniz-Rechenzentrum (LRZ)
in Munich for assisting us with obtaining the data. We especially
Figure 16: Certiﬁcate quality in relation to Alexa rank.
gated all issuers that had issued more than 2 certiﬁcates and found
that all of them seemed to employ a PKI of their own, but without
Root Certiﬁcates in Firefox. The reasons for this use of Version 1
are unknown to us, but plausible causes are software default set-
tings or an arbitrary choice to use the simpler format of Version 1.
Certiﬁcate Quality: A Summarizing View.
We conclude our analysis with a summarizing view of certiﬁcate
quality. Figure 16 reveals that the share of valid certiﬁcates (=to-
tal height of the bars) is negatively correlated with the Alexa rank.
This does not come as a surprise, since operators of high-proﬁle
sites with a higher Alexa rank can be expected to invest more re-
sources into a working HTTPs infrastructure. What is surprising,
however, is that even in the top 512 or 1,024 – i.e., truly high-
ranking sites – only just above 40% of certiﬁcates are absolutely
valid. The ﬁgure also shows a classiﬁcation of the certiﬁcates in
three categories, which we have termed ‘good’, ‘acceptable’ and
‘valid but bad’. Good certiﬁcates have correct chains, correct host
names, a chain length of 2 at most, do not use MD5 as a signature
algorithm, use non-weak keys that are either DSA keys or RSA
keys of more than 1024 bit, and have a validity of at most 13 months
(a year plus a grace period). For acceptable keys, we require the
same but allow a chain length of 3 and validity is allowed to be up
to 25 months. Valid but bad keys represent the remainder of keys
(with correct chains and host names, but that otherwise fail our cri-
teria). Interestingly, although high-proﬁle sites are more likely to
deliver valid certiﬁcates, the share of bad certiﬁcates among their
valid certiﬁcates is much higher (about two thirds) when compared
to that of all sites (about half). The conclusion we have to draw
here is that even among the absolutely valid certiﬁcates the number
of certiﬁcates with strong properties is disappointingly low.
6. DISCUSSION AND CONCLUSION
By combining and evaluating several actively and passively ob-
tained data sets, which were in part also obtained over 1.5 years,
we were able to derive a very comprehensive picture of the X.509
infrastructure as used with TLS/SSL. Our analysis supports with
hard facts what has long been believed: that the X.509 certiﬁcation
infrastructure is, in great part, in a sorry state.
The most sobering result is probably the percentage of certiﬁ-
cates that a client using the Mozilla Root Store would accept with-
out a warning: just 18%. This can be traced to both incorrect cer-
tiﬁcation chains (40% of all certiﬁcates exhibit this problem), but
even more so to incorrect or missing host names in the subject or
subject alternative name. With self-signed certiﬁcates, where con-
scientious operators would have an incentive to use the correct host
name, the situation was much worse. The only positive point is that
439thank Helmut Reiser of LRZ for his valuable feedback. This work
has been partially funded by the European Union within the EU
FP7 project ResumeNet (FP7-224619).
8. REFERENCES
[1] D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley,
and W. Polk, “Internet X.509 public key infrastructure
certiﬁcate and certiﬁcate revocation list (CRL) proﬁle,” RFC
5280 (Proposed Standard), May 2008.
[17] L. Braun, G. Münz, and G. Carle, “Packet sampling for
worm and botnet detection in TCP connections,” in Proc.
IEEE/IFIP Network Operations and Management
Symposium (NOMS), Apr. 2010.
[18] S. Kornexl, V. Paxson, H. Dreger, A. Feldmann, and
R. Sommer, “Building a time machine for efﬁcient recording
and retrieval of high-volume network trafﬁc,” in Proc. 5th
ACM SIGCOMM Conference on Internet Measurement
(IMC), Berkeley, CA, USA, Oct. 2005.
[2] T. Dierks and E. Rescorla, “The transport layer security
[19] L. Braun, A. Didebulidze, N. Kammenhuber, and G. Carle,
(TLS) protocol version 1.2,” RFC 5246 (Proposed Standard),
Aug. 2008, updated by RFCs 5746, 5878, 6176.
[3] J. Appelbaum, “Detecting certiﬁcate authority compromises
and Web browser collusion,” Blog entry:
https://blog.torproject.org/blog/detecting-certiﬁcate-
authority-compromises-and-web-browser-collusion, 2011,
[online; last retrieved in May 2011].
[4] Mozilla Security Blog, “DigiNotar removal follow up,”
https://blog.mozilla.com/security/2011/09/02/diginotar-
removal-follow-up/ [online; last retrieved in September
2011], 2011.
[5] C. Herley, “So long, and no thanks for the externalities: the
rational rejection of security advice by users,” in Proc. 2009
Workshop on New Security Paradigms. New York, NY,
USA: ACM, 2009.
[6] C. Ellison and B. Schneier, “Ten risks of PKI: What you’re
not being told about public key infrastructure,” Computer
Security Journal, vol. 16, no. 1, 2000.
[7] P. Gutmann, “PKI: It’s not dead, just resting,” IEEE
Computer, vol. 35, no. 8, August 2002.
[8] P. Eckersley and J. Burns, “An observatory for the
SSLiverse,” Talk at Defcon 18., July 2010, [last retrieved in
May 2011]. [Online]. Available:
https://www.eff.org/ﬁles/DefconSSLiverse.pdf
[9] P. Eckersley and J. Burns, “Is the SSLiverse a safe place?”
Talk at 27C3. Slides from
https://www.eff.org/ﬁles/ccc2010.pdf [online; last retrieved
in May 2011], 2010.
[10] I. Ristic, “Internet SSL Survey 2010,” Talk at BlackHat
2010. Slides from https://media.blackhat.com/bh-us-
10/presentations/Ristic/BlackHat-USA-2010-Ristic-Qualys-
SSL-Survey-HTTP-Rating-Guide-slides.pdf, 2010, [online;
last retrieved in May 2011].
[11] I. Ristic, “State of SSL,” Talk at InfoSec World 2011. Slides
from http://blog.ivanristic.com/Qualys_SSL_Labs-
State_of_SSL_InfoSec_World_April_2011.pdf, 2011,
[online; last retrieved in May 2011].
[12] Alexa Internet Inc., “Top 1,000,000 sites (updated daily),”
http://s3.amazonaws.com/alexa-static/top-1m.csv.zip,
2009–2011, [online; last retrieved in May 2011].
[13] H. K. Lee, T. Malkin, and E. Nahum, “Cryptographic
strength of SSL/TLS servers: Current and recent practices,”
in Proc. 7th ACM SIGCOMM Conference on Internet
Measurement (IMC), San Diego, CA, USA, October 2007.
[14] S. Yilek, E. Rescorla, H. Shacham, B. Enright, and
S. Savage, “When private keys are public – results from the
2008 Debian OpenSSL vulnerability,” in Proc. 9th ACM
SIGCOMM Conference on Internet Measurement (IMC),
Chicago, Illinois, USA, Nov. 2009.
[15] Data sets of active scans, http://pki.net.in.tum.de, 2011.
[16] A. Croll and S. Power, Complete Web Monitoring. O’Reilly
Media, 2009.
“Comparing and improving current packet capturing
solutions based on commodity hardware,” in Proc. 10th ACM
SIGCOMM Conference on Internet Measurement (IMC),
Nov 2010.
[20] F. Fusco and L. Deri, “High speed network trafﬁc analysis
with commodity multi-core systems,” in Proc. 10th ACM
SIGCOMM Conference on Internet Measurement (IMC),
Nov 2010.
[21] V. Paxson, “Bro: a system for detecting network intruders in
real-time,” Computer networks, vol. 31, no. 23-24, 1999.
[22] H. Dreger, A. Feldmann, M. Mai, V. Paxson, and R. Sommer,
“Dynamic Application-Layer Protocol Analysis for Network
Intrusion Detection,” in Proc. USENIX Security Symposium,
Apr. 2006.
[23] Planet Lab, “Planet Lab Web site,”
https://www.planet-lab.org [online; last retrieved in May
2011].
[24] The International Grid Trust Federation, “IGTF Web site,”
http://www.igtf.net/ [online; last retrieved in May 2011].
[25] A. Klein, “Attacks on the RC4 stream cipher,” Designs,
Codes and Cryptography, vol. 48, 2008.
[26] E. Rescorla, “HTTP over TLS,” RFC 2818 (Informational),
2000.
[27] CA/Browser Forum, “EV SSL certiﬁcate guidelines version
1.3,” http://www.cabforum.org/Guidelines_v1_3.pdf, 2010,
[online; last retrieved in May 2011].
[28] M. Stevens, A. Lenstra, and B. de Weger, “Chosen-preﬁx
collisions for MD5 and colliding X.509 certiﬁcates for
different identities,” in Advances in Cryptology –
EUROCRYPT 2007, ser. LNCS. Springer Berlin /
Heidelberg, 2007, vol. 4515.
[29] NIST, “Approved Algorithms,”
http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html,
2006, [online; last retrieved in May 2011].
[30] A. Sotirov, M. Stevens, J. Appelbaum, A. Lenstra,
D. Molnar, D. A. Osvik, and B. de Weger, “MD5 considered
harmful today,”
http://dl.packetstormsecurity.net/papers/attack/md5-
considered-harmful.pdf, 2008, [online; last retrieved in May
2011].
[31] T. Kleinjung, K. Aoki, J. Franke, A. Lenstra, E. Thomé,
J. Bos, P. Gaudry, A. Kruppa, P. Montgomery, D. Osvik,
H. te Riele, A. Timofeev, and P. Zimmermann,
“Factorization of a 768-bit RSA modulus,” in Advances in
Cryptology – CRYPTO 2010, ser. Lecture Notes in Computer
Science. Springer Berlin / Heidelberg, 2010, vol. 6223.