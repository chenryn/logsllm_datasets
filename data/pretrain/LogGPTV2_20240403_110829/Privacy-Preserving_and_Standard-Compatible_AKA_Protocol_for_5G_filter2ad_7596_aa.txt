title:Privacy-Preserving and Standard-Compatible AKA Protocol for 5G
author:Yuchen Wang and
Zhenfeng Zhang and
Yongquan Xie
Privacy-Preserving and Standard-Compatible 
AKA Protocol for 5G
Yuchen Wang, TCA of State Key Laboratory of Computer Science, Institute of 
Software, Chinese Academy of Sciences & Alibaba Group; Zhenfeng Zhang, 
TCA of State Key Laboratory of Computer Science, Institute of Software, 
Chinese Academy of Sciences; Yongquan Xie, Commercial Cryptography 
Testing Center of State Cryptography Administration
https://www.usenix.org/conference/usenixsecurity21/presentation/wang-yuchen
This paper is included in the Proceedings of the 30th USENIX Security Symposium.August 11–13, 2021978-1-939133-24-3Open access to the Proceedings of the 30th USENIX Security Symposium is sponsored by USENIX.Privacy-Preserving and Standard-Compatible AKA Protocol for 5G
Yuchen Wang1,2
PI:EMAIL
Zhenfeng Zhang1,†
PI:EMAIL
Yongquan Xie3,†
PI:EMAIL
1TCA of State Key Laboratory of Computer Science, Institute of Software, Chinese Academy of Sciences
3Commercial Cryptography Testing Center of State Cryptography Administration
2Alibaba Group
Abstract
The 3GPP consortium has published the Authentication and
Key Agreement protocol for the 5th generation (5G) mobile
communication system (i.e., 5G-AKA) by Technical Speci-
ﬁcation (TS) 33.501. It introduces public key encryption to
conceal the so-called SUPIs so as to enhance mobile users’
privacy. However, 5G-AKA is only privacy-preserving at the
presence of passive attackers, and is still vulnerable to the
linkability attacks from active attackers. An active attacker
can track target mobile phones via performing these attacks,
which puts the privacy of users at risk.
In this paper, we propose a privacy-preserving solution for
the AKA protocol of 5G system denoted by 5G-AKA(cid:48). It is
resistant to linkability attacks performed by active attackers,
and is compatible with the SIM cards and currently deployed
Serving Networks (SNs). In particular, we ﬁrst conduct an
analysis on the known linkability attacks in 5G-AKA, and
ﬁnd out a root cause of all attacks. Then, we design a counter-
measure with the inherent key encapsulation mechanism of
ECIES (i.e., ECIES-KEM), and use the shared key established
by ECIES-KEM to encrypt the challenges sent by a Home
Network (HN). With this measure, a target User Equipment
(UE) who receives a message replayed from its previously
attended sessions behaves as non-target UEs, which prevents
the attacker from distinguishing the UE by linking it with its
previous sessions. Moreover, 5G-AKA(cid:48) does not raise addi-
tional bandwidth cost, and only introduces limited additional
time costs from 0.02% to 0.03%. Finally, we use a state-
of-the-art formal veriﬁcation tool, Tamarin prover, to prove
that 5G-AKA(cid:48) achieves the desired security goals of privacy,
authentication and secrecy.
1 Introduction
Nowadays, the mobile communication system has become an
integral part of daily activities. According to the investigation
report published by GSM Association (GSMA) [54], over
†The corresponding authors.
5 billion people have subscribed to mobile services by the
end of 2018, which accounts for 67% of global population. It
is also expected that the scale of the mobile communication
system will keep increasing in the next 5 years with the global
deployment of mobile network infrastructures and Internet-
of-Things (IoT) devices.
In Technical Speciﬁcation (TS) 33.501 [20], 3GPP de-
scribes new versions of Authentication and Key Agreement
(AKA) protocols for 5G (i.e., 5G-AKA), which enables an
User Equipment (UE) and a Home Network (HN) to authen-
ticate each other and establish key materials (a.k.a., anchor
keys) for subsequent 5G procedures. 5G-AKA inherits many
of the design characteristics from the AKA protocols for 3G
and 4G, including the usage of a challenge-response proce-
dure and the employment of sequence numbers.
Compared with the AKA protocols for 3G and 4G, 5G-
AKA makes progress on protecting the privacy of users by
disallowing the unsecure plaintext transmission of permanent
identiﬁers of subscribers (i.e., SUPIs). TS 33.501 states that
an SUPI must be concealed (i.e., encrypted) by the Elliptic
Curve Integrated Encryption Scheme (ECIES) [3] algorithm
with HN’s public key when it is sent over the radio, which
prevents the notorious IMSI-catching attack [53]. With this
measure, a passive attacker who can only monitor the wireless
trafﬁc will neither access the SUPI in plaintext, nor trace a
UE across its 5G-AKA sessions via SUPI.
However, recent research [24,26,43] also ﬁnd that 5G-AKA
is still vulnerable to a series of attacks on privacy performed
by active attackers. Compared with a passive attacker, an
active attacker can furthermore emit radio signals actively
(e.g., using rogue base stations). In particular, these attacks
enable the attacker to distinguish a target UE from a set of
UEs via replaying the messages from its previously attended
AKA sessions, and are also known as linkability attacks since
the attacker can link the target UE with its previous AKA
sessions. With these attacks, the attacker can monitor or track
the target UE and even infer an user’s real-world identity from
the mobile activity pattern of its UE [37].
Moreover, these attacks can also be exploited to track the
USENIX Association
30th USENIX Security Symposium    3595
SUPI
Link the user’s 3G/4G and 5G sessions
3G/4G
5G
Figure 1: Tracing a high-value target user’s UE across 3G/4G-
AKA and 5G-AKA sessions via linkability attacks.
target UE across mobile communication protocols of different
generations (e.g., 4G and 5G), as they also exist in 3G and
4G AKA protocols [22, 27, 35]. In particular, the attacker can
link the target UE in 5G with its 3G or 4G AKA sessions,
on the premise that its SIM card1 remains unchanged. Cur-
rently, many major mobile providers (e.g., China Mobile [6],
Three [10] and Vodafone [14]) have announced that their 5G
services will not require mobile users to change legacy 4G
SIM cards, which makes the premise realistic. To be more
speciﬁc, we also present the cross-protocol linkability attack
in Figure 1: First, the attacker captures a 3G or 4G AKA
session of the target UE, which includes its identiﬁer SUPI,
and then designs an elaborate attack vector with the recorded
messages. Next, in 5G network, the attacker uses the vector
to launch linkability attacks on all UEs in the attack area, and
distinguishes the target UE with its unique response. Such
threat scenario does not only enable the attacker to track high-
value target users (such as spy on embassy ofﬁcials and jour-
nalists [26]), but also leaks the SUPI of a 5G-AKA session,
which breaks the purpose of SUPI concealment.
Currently, active attackers have been regarded as realistic
threats for most 5G use cases [24,26,50] with the rapid devel-
opment of open-source solutions of 5G communication [7–9].
Thus, it is reasonable to assume that a real-world attacker can
mount active attacks with acceptable cost in the 5G era as in
4G [36, 44, 51] upon the completion of 5G standards, which
makes the improvement of 5G-AKA important and urgent.
However, improving the privacy of 5G-AKA is not a trivial
task, as: 1) There exists several kinds of linkability attacks.
A satisfying solution must ﬁx all of them “in one shot”. 2)
The proposed ﬁx should be compatible with 3GPP’s current
speciﬁcations for 5G network (e.g., the SIM card commands
deﬁned by TS 31.102 [12]). Except for the effort to modify
all involved standards, a non-compatible proposal would also
require the communication provider to change the SIM card
1In this paper, we use SIM card to refer to the 3G, 4G and 5G USIM
applications and the physical smart card that carries them.
for all users, and all SNs to modify their implementations
accordingly, which makes it cumbersome to be deployed in
practice due to the high migration cost.
1.1 Our Contributions
In this paper, we propose 5G-AKA(cid:48) as a privacy-preserving
solution for the AKA protocol of 5G system. It is able to
prevent the linkability attacks mounted by active attackers,
and is compatible with the standard AUTHENTICATE SIM card
command [12] and the speciﬁcations of 5G network [15, 16,
18, 20], and thus can be deployed by reusing the current SIM
cards and SNs’ implementations. The contributions of this
paper are listed as follows:
• An In-Depth Analysis on Known Linkability Attacks. We
ﬁrst conduct an in-depth analysis on all known linkability
attacks, and surprisingly ﬁnd that all these attacks can be
ascribed to the same root cause. In a nutshell, these attacks
are all raised by the two-step check that a UE performs on
the HN’s challenge. The attacker can thus use the target
UE’s previous session to elaborate an attack vector which
includes a replayed message. The replayed message can
pass the target UE’s ﬁrst check on the Message Authentica-
tion Code (MAC) of the challenge, as the message contains
a valid MAC value calculated with the key shared by the
target UE and HN, but cannot pass the other UEs’ checks
as the MACs are incorrect, which makes them behave dif-
ferently (i.e., respond with different messages).
• Fix the Privacy Issues in 5G-AKA. To ﬁx this issue, we
propose a countermeasure of encrypting the challenge sent
by HN with a temporary shared key established from the
key encapsulation mechanism inherent in ECIES. This key
varies in different sessions, and enables the UE to check the
message’s validity and freshness simultaneously via check-
ing its MAC. A replayed message fails target UE’s check on
MAC as non-target UEs, as a replayed challenge encrypted
under the key in a previous session will be decrypted by
the UE with a new key in current session and result in a
different challenge from the original one.
We integrate this countermeasure to 5G-AKA, and denote
the ﬁxed protocol by 5G-AKA(cid:48). It can protect users’ pri-
vacy against the aforementioned linkability attacks, with the
following subtleties: 1) It does not introduce new primitive
to 5G system, as the ECIES algorithm have been included
in TS 33.501 [20]. 2) It is compatible with the standard
AUTHENTICATE SIM command without modiﬁcation. This
command has been provided by legacy 3G and 4G SIM
cards, which enables 5G-AKA(cid:48) to be deployed in a way of
reusing SIM cards. This feature will be useful in the migra-
tion to 5G, as swapping all SIM cards is commonly con-
sidered as a costly and cumbersome operation for mobile
communication providers. 3) It is compatible with 3GPP’s
speciﬁcations for 5G networks (e.g., TS 23.502 [15] and
3596    30th USENIX Security Symposium
USENIX Association
Abbreviations
& Notations
HN
UE
SN
KEM
DEM
SUPI
SUCI
k
Kseaf
kUE
kHN
Meaning
Home Network
User Equipment
Serving Network
Key Encapsulation Mechanism
Data Encapsulation Mechanism
SUbscriber Permanent Identiﬁer
SUbscriber Concealed Identiﬁer
The permanent key shared between a UE and HN
The anchor key derived from 5G-AKA
The UE’s shared key established by ECIES-KEM
The HN’s shared key established by ECIES-KEM
(PKHN ,skHN )
The HN’s ECIES public-private key pair
SQNUE
SQNHN
RAND
The UE’s sequence number
The HN’s sequence number
The HN’s challenge message
Table 1: A summary of abbreviations and notations
TS 24.301 [17]), and can be developed on the top of current
implements of SNs. 4) It provides the desired properties of
authentication and secrecy as deﬁned by TS 33.501 [20]. 5)
Compared with 5G-AKA, it does not raise additional band-
width cost, and only raise additional computation costs from
0.02% to 0.03%.
• Formal Veriﬁcation on 5G-AKA(cid:48). We formally analyze
5G-AKA(cid:48) in the symbolic model with Tamarin Prover. In
particular, we ﬁrst prove that 5G-AKA(cid:48) satisﬁes the goals of
authentication and secrecy, based on the script proposed by
Basin et al. [24]. Then, we implement a new script that cap-
tures the desired privacy goal and prove that 5G-AKA(cid:48) is
privacy-preserving against active attackers. Our formal anal-
ysis models ECIES abstractly, which makes the results also
ﬁt for the variants of 5G-AKA(cid:48) that use the other asymmet-
ric encryption schemes following the KEM/DEM paradigm
(e.g., post-quantum KEMs [21, 28]).
1.2 Organization
In Section 2, we brieﬂy review the related works and com-
pare our result with the previous works which also focus
on linkability attacks of 5G-AKA. In Section 3, we present
the ECIES algorithm, 5G-AKA protocol and the details of
known linkability attacks. In Section 4, we give the threat
model and security goals that we consider throughout this
work. In Section 5, we present the analyze on linkability at-
tacks, the corresponding countermeasure, and give the detail
of 5G-AKA(cid:48) with a performance evaluation. We describe the
formal veriﬁcation in Section 6, and conclude in Section 7.
2 Related Work
In this section, we ﬁrst review the works which analyze 5G-
AKA with formal methods, and then present the works that
try to ﬁx the weakness of linkability attacks for 5G-AKA. We
summarize the proposals that improve the privacy of 5G-AKA
in Table 2, and compare them with 5G-AKA(cid:48).
Formal veriﬁcation on 5G-AKA. Formal methods have
been widely accepted for evaluating the security of 3GPP
AKA protocols and their variants for 3G and 4G systems [1,
22, 55]. In [24], Basin et al. formally reﬁne the security and
privacy properties required by 5G-AKA from 3GPP’s spec-
iﬁcations [5, 19, 20] and evaluate 5G-AKA with Tamarin
Prover [47]. They provide missing security assumptions
which are necessary for achieving the desired security goals,
such as key conﬁrmation and channel binding, and prove the
existence of Failure Message Linkability Attack in 5G-AKA.
In a concurrent work by Cremers et al. [31], a ﬁne-grained
analysis is performed. It points out an attack raised by the po-
tential race condition between the components residing within
an HN, and also discusses various compromising scenarios
and trust assumptions in 5G-AKA.
Improving the privacy of 5G-AKA. To improve the pri-
vacy of mobile subscribers, a series of pseudonym mecha-
nisms have been designed and suggested as proposals for
5G-AKA [41, 42, 55]. These schemes protect the conﬁdential-
ity of user identities via using changing pseudonym identiﬁers
instead of the persistent ones (i.e., SUPIs), but can not com-
pletely ﬁx the privacy issues of 5G-AKA as the linkability
attacks performed by active attackers can not be prevented.
Arapinis et al. [22] suggest encrypting the reason of failure
so as to avoid the failure message linkability attack. But the
proposed scheme involves the trouble of changing all SNs,
as an SN must decrypt the failure message ﬁrst. Borgaonkar
et al. [26] ﬁnd a variant of failure message linkability attack
and denote it by sequence number inference attack. To avoid