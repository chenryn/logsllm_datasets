I recently ran into an issue whereby curve_fit was failing to fit a function,
even though the guesses were reasonable. The warning reported by Scipy was
"/usr/local/depot/Python-3.5.1/lib/python3.5/site-
packages/scipy/optimize/minpack.py:690: OptimizeWarning: Covariance of the
parameters could not be estimated".
After hours of searching, I discovered that the problem was that I was using
np.float32 arrays for the x and y data. Simply using x.astype(np.float64)
resolved the issue. Though the warning provided no help or hints as to the
source of the problem.
This is similar to what was reported in this (rather old) email thread:
http://scipy-user.scipy.narkive.com/wSafjCiz/curve-fit-with-float32-values,
which proved to be very difficult to find. It would be useful to warn in the
curve_fit documentation (and other minimisation functions) about using float32
inputs, particularly as the problem only manifests itself with certain data
sets.