### Analyzing Web Server Logs for Malicious External Requests

Analyzing web server logs for malicious external requests is less robust, as only a very small portion of the websites in our dataset employs this method. However, it does confirm the findings of Han et al. [17] and Cova et al. [9], who also observed that a negligible portion of phishing kits load resources from the target organization. These authors studied attacker behavior on honeypot domains, based on the assumption that attackers hijack domains for phishing. Although our measurement methodology is not perfectly suited to identify such hijacked domains—since these domains often already have TLS certificates—we did find 18 of them. All of these domains include the full FQDN of the target organization as subdomains and have an average uptime of 72 hours.

### Evasion Techniques

As explained in Section 4, some phishing kits deploy evasion techniques to prevent detection by anti-phishing services such as APWG [14] and Google SafeBrowsing [20]. These techniques, often referred to as cloaking, allow phishers to show different pages to potential victims and to crawlers [21, 53]. Although our methodology focuses on detecting specific phishing kits rather than identifying cloaking, we observed such evasion techniques frequently. In fact, 946 (69%) of the detected phishing domains returned a blank screen—and no favicon—to our crawler when visited, indicating that the phishing website detected us and deployed cloaking techniques. Nevertheless, our phishing kit detection was still possible because these websites returned a successful response for the files included in the fingerprint. The uAdmin kit was responsible for most of these cloaking activities, combining both server-side and client-side cloaking. On the server-side, it checked the IP address against a block list and created a random path for each visitor. On the client-side, it used a simple JavaScript timeout to evade non-JavaScript crawlers. The combination of both techniques is shown in Listing 1.

### External Validation

To benchmark and validate our methodology, we compared our results with data from the APWG eCrime Exchange (eCX) [15], which contains phishing activity from around the world, including many Dutch phishing domains. Our comparison showed that our methodology covers a much broader spectrum of phishing domains, capturing known differentiations in the phishing landscape. Only 77 phishing domains detected using our methodology overlap with the APWG database, meaning that 1,286 domains are not listed in their repository. By comparing the initial detection date of a phishing domain by our crawler with the submission date to the eCX, we found that our method identified phishing domains much faster. In 76 out of 77 cases (99%), our crawler detected the phishing domains earlier, with a median time difference of 11.3 hours (almost half a day). Interestingly, the overlapping domains had more bank names in their domain names: 61 of the 77 domains (79%) contained a reference to a bank, whereas only 44% of the complete dataset had this characteristic.

This external validation demonstrates that our methodology can detect phishing websites very swiftly, potentially saving unsuspecting individuals from fraud.

### Throwing Out the Bait

In the previous sections, we unraveled the characteristics of every step in the end-to-end life cycle of a phishing campaign, except for the final step: sending out the text messages, emails, or social media posts, known as the "bait." Although our measurement system does not contain the necessary input data to thoroughly analyze this step, the authors, being part of the target population, regularly receive such bait themselves. During our data collection period, we collected these messages and examined those containing links to domains in our dataset, allowing us to present the complete timeline of events in a phishing campaign life cycle. An example is discussed in the following section.

**Verify Your Identity**

Within the first two weeks of our research, we received a text message seemingly originating from DigiD, the official Dutch digital identity service. The message, shown in Figure 14, stated that a suspicious login was detected and that immediate action was necessary to prevent account cancellation. This is a prime example of scarcity and consistency luring techniques, as described in Section 2.1. The link directed victims to https://deblokkeren-digid.xyz, a type IV domain made with a phishing kit belonging to the uAdmin family. This website was registered six hours before the message was received and became fully operational three hours later. On the website, potential victims were asked to verify their identity by logging into their online bank account. Multiple options were displayed on the decoy page (Figure 13a), allowing the victim to choose their preferred bank. Upon clicking one of the buttons, the victim was redirected to another phishing page (Figure 13b), mimicking the chosen bank's login screen, eventually capturing the login credentials. The use of the DigiD decoy page is a prime example of the technique depicted in Figure 1. Within a day, just 12 hours later, the domain was taken offline.

### Related Work

Earlier work on phishing encompasses various perspectives and subjects, ranging from creating robust domain detection methods [5, 12, 13, 27, 32, 45], phishing kit analysis [9, 17, 38], evasion techniques [21, 53], to research focused on victim behavior [49]. Much effort has been devoted to developing robust detection techniques, but less is known about the lifecycle, ecosystem, and actors behind such attacks. Only a limited number of researchers have investigated this aspect of phishing [35, 39], which is essential for fully understanding the ecosystem and creating effective countermeasures.

**Analysis of Phishing Kits**

Early work on phishing kits by Cova et al. [9] in 2008 focused on the analysis of 'free' phishing kits. They noticed that packages containing easy-to-deploy phishing websites often contained backdoors that exfiltrated gathered information to third parties, and that 100% of the investigated kits were written in PHP. In their PhishEye study, Han et al. [17] provided insights into live phishing websites created by deploying phishing kits on honeypot domains. Using a sandboxed approach, they lured phishers into installing phishing kits on their honeypot servers, closely monitoring the behavior. The authors analyzed both phisher and victim actions, showing that phishing kits are active for less than 10 days after installation and that most victims share the same country of origin. During their five-month analysis period (Sep 2015 – Jan 2016), they collected 643 unique phishing kits, with 74% correctly installed by 471 distinct attackers. Additionally, they discovered that only 10 phishing kits loaded resources directly from the targeted organization's website.

**Measurements on Live Phishing Domains**

In recent work, Oest et al. [38] analyzed .htaccess files—commonly used on Apache web servers—to capture the evasive behavior of phishers. These files allow phishers to protect themselves against anti-phishing or search engine crawlers. Their paper states that deny IP and User-Agent filters are the most prevalent blacklisting technologies, while the allow IP filter type is often used to target specific countries. They proposed a new high-level classification scheme for phishing URLs, building upon the work of Garera et al. [12]. This taxonomy categorizes phishing URLs into five categories with different hiding and lure strategies. We used this taxonomy to classify the URLs detected by our measurements in Section 5.1.

The work closest to ours is by the same authors, who continued their research by investigating the end-to-end lifecycle of phishing attacks in 2020. This work relied on the observation that a substantial proportion of phishing pages make requests for web resources to the websites that the attackers impersonate [39]. A unique collaboration with a large payment provider enabled them to link such web requests to the phishing websites they originated from, providing an in-depth look into phishing campaigns from the moment the attacker installs the phishing page to the moment victims disclose their credentials. They found that the average phishing attack spans 21 hours and that modern web browsers display a warning for a detected domain after 16 hours. Oest et al. [39] called the gap between the launch of the attack and detection by anti-phishing bodies the 'golden hours' of phishing, during which attackers gather 38% of their phished credentials. Our work shares similar goals and findings, such as the extensive use of server-side cloaking, victim-specific paths, and the presence of MITM-proxies in phishing kits. However, there are notable differences. Their work focused on a single organization and included both HTTP and HTTPS traffic, whereas our work focuses on the entire Dutch financial sector, limited to domains served over HTTPS. Furthermore, they assumed that phishing domains load resources directly from the target website, whereas we found that only a negligible portion of domains in our analysis did so.

### Discussion

**Limitations**

Analyzing a phenomenon like phishing inherently comes with limitations. As with other studies, our methodology captures only part of the phishing landscape. We identify the following limitations:

- **HTTPS-only Phishing Domains:** Our methodology is limited to phishing domains secured by HTTPS connections. However, 78% of all phishing in 2020 was delivered through HTTPS according to the APWG [16], and Oest et al. [39] concluded that phishing served over HTTPS was three times more effective. Our approach results in the ability to identify type III and IV phishing domains, missing the other types.
- **Known Phishing Kits:** We are limited to identifying known phishing kits. Phishing domains that do not match any of our predefined fingerprints are not marked as phishing. Phishers could change file names or structure, rendering our detection less effective. However, the main advantage of phishing kits is their ease of deployment, and we do not expect phishers to make numerous changes each time they deploy a new phishing website.
- **Detection Advantage for Cloaking Strategies:** Our fingerprinting methodology has a detection advantage for websites that deploy certain cloaking strategies. Some phishing websites ban IP ranges or User-Agents known to be used by anti-phishing services through PHP scripts on the homepage, or show different landing pages depending on the country of origin. Searching for known files—our fingerprints—on such domains bypasses these evasion methods and results in robust detection of a phishing kit.
- **Missed Domains and Keywords:** We started our crawling infrastructure three months before data collection, allowing us to carefully examine missed domains. We created fingerprints based on source code from live phishing websites missed by our crawler, enabling robust fingerprint creation even without obtaining the actual phishing kit. However, many domain names do not contain references to bank names, using only common words. Before data collection, we added 78 such words to our suspicious keywords list, but we may have missed some. These domains did not reach the threshold set in our domain detector and remain undetected. The validation with eCrime Exchange data in Section 7 showed that such domains are less prevalent in this anti-phishing repository, making it important to include such words. Validating with only one data source is also a limitation, and we leave validation with more datasets for future work.

**Public Policy Takeaways**

Taking decisive action on phishing is complex. The standardized notice-and-takedown (NTD) procedure, generally outsourced by banks to the security industry, has resulted in a game of whack-a-mole, leaving law enforcement agencies (LEA) often empty-handed. As concluded by Moore & Clayton [35] in 2017, website removal is only part of the solution, but not fast enough to completely mitigate the problem. If and when phishing campaigns are reported to LEAs, the domains are often already taken down, making attribution of the actors behind phishing campaigns nearly impossible. Implementing a system like the one presented in this paper would be highly beneficial for LEA investigations.

With WhatsApp and text messages being popular delivery mechanisms [37], the interaction with victims has sped up, highlighting the need for early-stage detection even more. Our methodology leverages the increasing use of phishing kits and TLS certificates in the phishing scene to enable early-stage detection. This opens a window where phishers have their phishing gear ready but have not yet thrown out the bait. Our findings pinpoint clear choke points in using phishing kits in campaigns, which LEAs might exploit for disruption before a takedown occurs. Our measurements of the lifecycle of campaigns using phishing kits show a persistent time gap between domain registration, deployment, and sending out the bait. This window of opportunity can be used to take preventive action before the campaign makes any victims. Leveraging our methodology, kit fingerprints can automate the detection of domains where a kit is ready to be deployed. We show that the use of these kits is widespread in the Dutch phishing landscape and have found that distinct families of kits exist, with certain common characteristics likely evolving from one kit to the next. When these characteristics relate to a vulnerability—such as a standard admin password of 'password' and a control panel accessible via a typical subdomain—this presents novel opportunities for automated exploitation for LEA purposes towards attribution rather than disruption. Having a clear picture of the popularity of phishing kits could assist LEAs in prioritizing their anti-phishing efforts to dominant kits. Interventions, such as exploiting a vulnerability, on these kits would immediately impact a large portion of campaigns. Additionally, these shared traits can be used to track the phishing landscape. For instance, uAdmin allows multiple domains to contact the same control panel, enabling in-depth analysis to find new, related campaigns or actors.

A system like ours could complement the threat intelligence process of many organizations, especially financial institutions, by providing timely and accurate detection of phishing threats.