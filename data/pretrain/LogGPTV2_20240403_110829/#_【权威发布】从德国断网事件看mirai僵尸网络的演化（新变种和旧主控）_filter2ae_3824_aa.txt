# 【权威发布】从德国断网事件看Mirai僵尸网络的演化（新变种和旧主控）

## 译文声明
本文是翻译文章，原文来自360网络安全研究院。译文仅供参考，具体内容及含义以原文为准。

**作者：** 360网络安全研究院  
**投稿方式：** 发送邮件至linwei#360.cn，或登录网页版在线投稿

### 德国电信断网事件 (2016-11-28)
2016年11月28日前后，德国电信遭遇了一次大规模的网络故障。在这次故障中，约90万个路由器（占固定网络用户的4.5%）受到影响，导致大面积网络访问受限。许多媒体发布了网络受限的示意图。

德国电信确认问题是由路由设备维护界面暴露在互联网上，并且互联网上正在进行针对性攻击所致。公司连夜与设备供应商合作生成了新的升级包，并建议受影响用户重启路由器，通过自动或手动升级来减轻问题。此外，德国电信还采取了一系列过滤措施，以确保升级过程不受攻击影响。德国电信对该事件进行了详细描述。

根据360网络安全研究院对此次事件和Mirai僵尸网络的理解，时间线如下（以下均为北京时间）：
- **2016-11-07**: Kenzo发布了一个针对7547端口上路由器等设备的TR-069/TR-064相关安全公告。
- **2016-11-26 21:27:23**: 360网络安全研究院首次探测到Mirai僵尸网络发起了针对7547端口的扫描。
- **2016-11-26 至 2016-11-28**: 7547端口上的Mirai僵尸网络规模积累到足以影响大面积网络。
- **2016-11-28 左右**: 约90万个路由器被Mirai僵尸网络的扫描过程打宕，网络大面积受影响。
- **2016-11-28 至今**: 德国电信在其网络范围内采取措施遏制Mirai僵尸网络的扫描过程。

### 前言
众所周知，Mirai源码于2016年9月30日左右在北京时间泄漏，并托管在GitHub上。自那以后，无论是黑帽子还是白帽子都对Mirai源码进行了大量深入分析。随着时间推移，越来越多的新玩家进入这一领域。我们已经发现了若干Mirai的新变种，例如新的主控域名、登录界面语言的变化（从俄文变为英文/中文），以及一些明显处于摸索阶段的设定（如将主控域名设为8.8.8.8或baidu.com）。基于这些变化，我们推测Mirai家族对网络安全的威胁将持续存在，周期可能长达数年。

### 新变种分析
#### 11月26日21点27分
一个新的变种引起了我们的注意。之前的Mirai变种主要进行小改动，核心内容是扫描23和2223端口上的弱口令。然而，这个新变种开始扫描TCP端口7547，利用最近公布的安全公告中的远程命令执行漏洞。该变种仍然会扫描传统的23/2323端口，但使用的弱口令进一步精简到三组精心挑选的密码。这种变化表明，Mirai泄漏源码已逐渐成为成熟的开发包，一旦发现新的设备弱口令，很快就会被Mirai家族感染。扫描端口7547而非23和2323、利用远程命令执行漏洞而非弱口令种植木马，这些行为与以往的Mirai显著不同。

尽管这个新变种有若干变化，它仍然重用了Mirai的部分代码，继承了其中的缺陷，并与现有Mirai僵尸网络共享控制端基础设施。

#### 11月27日17点04分
我们监测到另一个新变种，这次出现了扫描TCP端口5555的行为。根据统计数据，这两个变种异常活跃，从国外合作伙伴的数据来看，它们的扫描范围造成了全球范围的影响，每天记录的活跃扫描源数量达到百万级别。

鉴于Mirai源码已公开，结合上述两个变种的行为，我们深感担忧，Mirai可能会成为一个DDoS攻击库的母体，通过模块化更新源代码部分内容，随时增加对新漏洞的支持。

### 数据更新
我们在[data.netlab.360.com](http://data.netlab.360.com/mirai-scanner)上提供了Mirai感染设备的各种统计和数据下载供研究者使用。根据新观察到的数据，我们更新了监控页面，并将对应样本的MD5和域名附录在文末。对于已经使用API访问我们提供bot列表的合作者，请重新下载2016-11-26及以后的数据以获得7547及5555端口数据的更新。

### 新Mirai变种的僵尸网络能力评估
目前所有已知版本的Mirai（包括在7547和5555端口上的新变种）由于编码手法问题，可以精确定位和标识来自Mirai的扫描行为。我们在2016-11-26首次观察到7547端口上的新变种，一天后的2016-11-27首次观察到5555端口上的新变种。

#### 各端口首次发现扫描时间对比
- **7547端口**: 2016-11-26
- **5555端口**: 2016-11-27

#### 每日bot规模增长情况
- **7547端口**: 当前增速远超23/2323端口，总量超过3万。
- **5555端口**: 增速较快。

根据安全社区合作伙伴提供的信息，全网潜在可感染设备总数在300万至500万之间。这也是促使我们撰写本博客的原因之一。

#### 7547端口上的Bot增速曲线
![7547端口Bot增速曲线](https://example.com/7547-bot-growth-curve.png)

上图显示，Bot的增速迅速达到高峰，并稳定在较高水平。在整个互联网视角下，7547端口的扫描在2016-11-26日晚间急剧上升。

#### 地理分布
在新变种的感染Bot地理分布方面，巴西依然遥遥领先，与既有Mirai僵尸网络的地理分布保持一致。

### 新变种共享既有Mirai僵尸网络主控的基础设施
通过分析和网络追踪，我们获得了7547端口上的Mirai变种样本。进一步分析发现，样本中的主控有两组，如下所示。值得注意的是，这两组主控都是之前已发现并跟踪的Mirai僵尸主控。我们最早在2016-11-09就在其他样本中发现了同时出现两组主控的情况，而这两组主控正是本次新变种涉及的这两组。也就是说，这次利用7547漏洞的新变种和之前的Mirai最初使用者是一组人。

- ***.securityupdates.us**
- ***.timeserver.host**

**我们可以断言以下四组主控背后的控制者是同一组人**：

1. 在本次发现的样本（以及最早在2016-11-09发现的样本）中，一个样本中同时出现了securityupdates.us和timeserver.host两组C&C控制服务器。
2. 上述四组域名大量共享IP地址，特别是5.188.232.1/24这个C类段，几乎所有IP地址都有完全相同的扫描banner。
3. 我们内部的数据可视化图形也显示，securityupdates.us和timeserver.host这两个主控下的感染Bot有较高的重合度，进一步验证了这两个主控之间的关系。