User: 请回答以下安全问题攻击后如何发现我的服务器的漏洞？几天前，我公司的服务器遭到黑客的攻击，他们擦除了/var/lib/mysql/文件夹中的整个数据库。
幸运的是，我能够从备份中恢复所有内容，但我无法找到安全漏洞的位置。
我在/var/lib/mysql/文件夹中发现了一堆.exe文件，我认为这些文件绝对不应该存在。黑客攻击发生在11月29日，所以我认为负责的文件以“exp.exe”和“401hk.exe”结尾，打开后包含以下行：
http://104.223.17.73:4568/401hk.exe
黑客是否有可能将可执行文件写入/tmp文件夹，并将这些文件移动到/var/lib/mysql，在那里他们远程执行了攻击？
发现漏洞以防止此类攻击的发生对我来说至关重要。
到目前为止，我检查了所有的访问日志，运行了LYNIS安全审计-没有发现任何关键的，运行了rootkit检查-没有发现什么。
也许有人经历过类似的袭击？

Assistant: 我强烈建议您对磁盘进行成像，然后安全地擦拭磁盘，然后重新构建服务器。确保受损服务器立即断开与网络的连接，以阻止任何危害传播。如果您想检查泄露的可能来源和范围，请处理磁盘映像，而不是泄露的服务器。
不要依靠恢复数据来覆盖病毒或后门——你需要安全地擦除磁盘并重建服务器。在使用备份之前，还要对其进行扫描和检查。
大概你在服务器上运行了防病毒软件？如果你有，那么要么它没有定期更新，要么是零日病毒，要么是直接黑客入侵，获得了某种程度的交互式登录。如果你还没有安装并扫描映像/磁盘，它可能会告诉你发生了什么。也扫描所有备份。
如果有人恶意访问了你的服务器，那么只要有足够的权限，他们就可以将文件移动到任何他们想移动的地方。需要进行全面的取证调查，以找出你的危害原因和程度。
您可以从检查交互式登录的访问日志开始——将最近的登录访问与特定帐户联系起来，并与帐户所有者核实以折扣这些登录——或者不！
你不能信任文件上的时间戳，它们可以很容易地更改。您有任何带有文件完整性检查的入侵检测系统吗？该系统对更改的文件和日期有何说明？
要想追踪这一点，需要采取很多步骤，但如果你没有为违规行为做好准备，那么你很可能根本找不到问题的根源。
还要考虑数据库中的敏感度和机密性数据。这种妥协可能泄露了你数据库中的部分或全部数据——如果有人能擦除它，他们几乎可以肯定地将数据传输出网络（取决于你的防火墙出口规则）。
最后，不要忘记检查该服务器也可以访问的所有服务器和设备，即可以从该服务器上的服务或帐户连接到的服务器和设备——这种危害可能已经蔓延。
关于如何调查违规行为以找到可能的原因以及如何清理，网上有很多信息——如果你不确切地知道违规行为是如何发生的以及发生了什么损害/变化，不要只是恢复一些数据并抱着最好的希望。