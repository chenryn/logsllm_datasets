The Risks and Vulnerabilities Associated with Wireless Hotspots
Michael Sutton 
Pedram Amini 
Hacking The Invisible Network
iDEFENSE
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Purpose
•
Study security from two points 
of view
– Providers
– End users
•
A variety of implementations
– Cafés
– Hotels
•
Tools
– Laptops, Dell Axim
– Hermes and Prism chipsets
– Various software tools
– Tolerant bladder
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
WISPs
Wireless Internet Service Providers
–
aka Hotspots
What are they?
•
Where are they?
–
Airports
–
Hotels
–
Retail stores
–
Coffee Shops
•
Why go wireless?
–
Cost
–
Convenience
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Industry
• Startups
– Boingo
– WayPort
– NetNearU
– HotSpotzz
– Airpath Wireless
– Surf and Sip
– HereUAre
– Deep Blue Wireless
– Joltage (defunct)
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Industry (cont’d)
• Telecomm
– T-Mobile
– AT&T (Cometa)
– Sprint (Boingo)
• Hardware
– Intel (Cometa)
– IBM (Cometa)
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Provider Risks
• Business risks
– Financial loss
– Launch pad for anonymous attacks
• Network level attacks
– Privacy
– Confidentiality
– Data integrity
• Denial of service attacks
– Availability
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
End User Risks
•
Node vs. Network level security
–
“Crunchy on the outside, Chewy on the inside”
•
Untrusted networks
–
Intranet safe services
–
Information leakage
–
Spoof attacks
•
End user awareness
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Security Implementations
•
Access control
–
Firewall restricts connectivity
–
Web requests redirected to login screen
–
Authentication takes place over SSL
–
Internet access is granted
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Security Implementations (cont’d)
Internet
Access
Point
User 1
User 2
Web Server
Internet
Access
Point
User 1
User 2
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Security Implementations (cont’d)
• IP address filtering
– Everyone
• MAC address filtering
– T-Mobile
• IPSec VPN 
– Deep Blue Wireless
– Optional
• DHCP lease expiration
– ?
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Revenue Loss
•
Tunneling data through unfiltered protocols
–
Bypassing access controls
•
Connection hijacking
–
Stealing legitimate connections
•
Connection sharing
–
Multiple unauthorized connections piped through 
one legitimate connection
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Tunneling
Internet
Loki
Server
Firewall
Gateway
Access
Point
External
Sites
Loki
Client
ICMP Traffic
IP Traffic
IP Traffic
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Internet
Access
Point
Target
IP  Y.Y.Y.Y
MAC  Y:Y:Y:Y:Y:Y
Permitted
Attack
IP  Y.Y.Y.Y
MAC  Y:Y:Y:Y:Y:Y
Blocked
Internet
Access
Point
Target
IP  Y.Y.Y.Y
MAC  Y:Y:Y:Y:Y:Y
Permitted
Attack
IP  Y.Y.Y.Y
MAC  Y:Y:Y:Y:Y:Y
Permitted
Internet
Access
Point
Target
IP  Y.Y.Y.Y
MAC  Y:Y:Y:Y:Y:Y
Blocked
Attack
IP  X.X.X.X
MAC  X:X:X:X:X:X
Permitted
Connection Hijacking
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Connection Sharing
Internet
Access
Point
Share 1
Share 2
Router
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Network Level Attacks
•
Traffic monitoring
–
Passive attack
•
DNS Hijacking
–
Active attack
•
Man in the middle 
attacks
•
Auto update 
hijacking
•Public IP addresses
– WayPort
– Remote attack
•ARP Spoofing
– Active attack
•Network crossover 
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
WayPort Layout
Internet
64.134.81.168
Linux
Wayport
Wayport
64.134.81.129
Gateway
Access Points
64.134.81.169
Windows
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Denial of Service Attacks
•
Physical layer (1)
–
Interference
•
Data layer (2)
–
ARP spoofing
•
Network layer (3)
–
AirJack
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
End User Countermeasures
•
VPN
•
Encryption w/ validation
•
O/S hardening
•
Node level firewall/IDS
•
Dedicated travel hardware
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Improved WISP Security
•
Non Internet addressable IPs
–
Network Address Translation (NAT)
•
Filter all protocols
•
802.1x
•
Intrusion Detection System (IDS)
–
Spoof detection (ARP, IP, DNS, …)
•
Intrusion Prevention System (IPS)
Copyright © 2003 iDEFENSE Inc.
iDEFENSE 
Questions?