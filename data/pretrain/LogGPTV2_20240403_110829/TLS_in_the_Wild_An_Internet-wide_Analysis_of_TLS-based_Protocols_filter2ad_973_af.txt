ranking for botnet and malicious activity.
Common name
Occurrences
SMTP†
localhost/emailAddress=webaster@localhost
*.bizmw.com
localhost(*)
localhost/emailAddress=webaster@localhost
localhost/emailAddress=webaster@localhost
localhost(*)
plesk/emailAddress=PI:EMAIL
localhost/emailAddress=webaster@localhost
localhost(*)
localhost/emailAddress=webaster@localhost
IMAPS
*.securesites.com
*.sslcert35.com
localhost/emailAddress=webaster@localhost
localhost/emailAddress=webaster@localhost
*.he.net
www.update.microsoft.com
*.securesites.net
*.cbeyondhosting2.com
*.hostingterra.com
plesk/emailAddress=PI:EMAIL
XMPP, C2S†
onex
s2548.pbxtra.fonality.com
k66.ru/emailAddress=PI:EMAIL
hub.clickmyheart.net
John Doe
java2go
localhost
nt-home.ipworldcom
mail.visn.net/emailAddress=PI:EMAIL
cic-la-plata
35k
34k
17k
16k
6k
5k
5k
5k
4k
4k
88k
31k
27k
21k
19k
19k
11k
11k
11k
6k
2k
2k
500
400
400
300
200
200
200
200
and comparing the subjects in the received certiﬁcates with
the expected domain name. However, we only scanned by IP
addresses. Reverse DNS lookups could theoretically produce
domain names to compare against; however, due to the way
that servers are operated today, there is a risk that the reverse
lookup yields hostname aliases different from the actual domain
name by which the server is typically addressed.
Some interesting ﬁndings for SMTP on port 25 are as
follows. The certiﬁcates for *.bizmw contain the string ‘NTT
Communications Corporation’ in the ‘Organisation’ part of the
subject, a hint in which organisation these invalid certiﬁcates
are used. The certiﬁcates for ‘localhost’ that are marked with
an asterisk all contain the string ‘Qmail Toaster Server’, thus
indicating that the responsible SMTP server was the popular
Qmail by djb. Presumably, the operators had never bothered
to install proper certiﬁcates. The ‘webaster’ certiﬁcate had
already made an appearance in the Web PKI study [24] and
is most likely due to a certiﬁcate creation software with a
spelling weakness. Plesk is the company behind the Parallels
visualisation product.
For IMAPS, we also ﬁnd the popular ‘webaster’ certiﬁcate.
Furthermore we ﬁnd certiﬁcates of several hosting companies
and also of Hurricane Electric. The certiﬁcates for Microsoft
were a surprise as they seemed to contain a Web address for
the Windows Update service. There were 18,193 occurrences
11
AS number
3257
3731
4250
4436
6762
11346
13030
14618
16509
18779
21321
23352
26642
41095
54500
TELECOM ITALIA
Registration information
TINET-BACKBONE Tinet SpA, DE
AFNCA-ASN - AFNCA Inc., US
ALENT-ASN-1 - Alentus Corporation, US
AS-GTT-4436 - nLayer Communications, Inc.,
US
SEABONE-NET
SPARKLE S.p.A., IT
CIAS - Critical Issue Inc., US
INIT7 Init7 (Switzerland) Ltd., CH
Amazon.com Inc., US
Amazon.com Inc., US
EGIHOSTING - EGIHosting, US
ARETI-AS Areti Internet Ltd.,GB
SERVERCENTRAL - Server Central Net-
work, US
AFAS - AnchorFree Inc., US
IPTP IPTP LTD, NL
18779 - EGIHosting, US
CIRCL rank
9532
4804
9180
10,730
11,887
557
6255
4139
3143
4712
2828
11,135
–
6330
–
of this single end-host certiﬁcate. No intermediate or root
certiﬁcates were sent. The respective hosts were distributed
across 15 Autonomous Systems, which we looked up using
the Team Cymru ASN Database19.
TABLE VII shows the results of the lookups. None of the
ASes were registered to Microsoft; they were predominantly
assigned to hosters. We checked the BGP ranking of these
ASes with CIRCL’s web site, which as of 12 August 2015
contained 12,339 ASes ranked for known botnet and malicious
activity. Only two of the ASes were not on that list. Manual
inspection of the certiﬁcate did not yield anything out of the
ordinary, however. We contacted Microsoft repeatedly (directly
and via CIRCL), but never received a response why such a
certiﬁcate should occur on an email port.
Analyzing XMPP certiﬁcates also yielded some interesting
results. OneX is an XMPP server by Avaya, a communications
company—this seems to be a default certiﬁcate. Fonality is a
provider of uniﬁed messaging. The certiﬁcates for k66.ru
contained a string referring to a product called ‘CommuniGate’.
It also appeared in the certiﬁcates for visn.net. We were
unable to determine the exact nature of clickmyheart, but
the Web site shows a login portal, so we presume some forum.
The certiﬁcates also contained the name Zimbra Collaboration
server. ‘John Doe’ is used in the certiﬁcates by Jive Software.
Java2go seems to be an SMS product.
Beyond the strange Microsoft Update certiﬁcate, our results
suggest that a number of default keys and certiﬁcates are used
in production. This is a negative ﬁnding as it means that other
parties may have access to the private cryptographic material.
Some vendors, meanwhile, seem to choose their own, private
CA instead of working with a commercial one.
F. Poor CA practice
In our data set, we were still able to ﬁnd certiﬁcates that
were issued directly from a root CA without any intermediate
certiﬁcate. The industry has moved away from this practice and
discourages it today [3]. To issue such certiﬁcates, the CA’s
19https://asn.cymru.com/cgi-bin/whois.cgi
TABLE VIII: Authentication mechanisms offered by servers
on SUBMISSION port.
TABLE X: Combinations of authentication mechanisms offered
by servers on SUBMISSION port.
Mechanism
PLAIN
LOGIN
CRAM-MD5
DIGEST-MD5
OTP
GSSAPI
NTLM
XOAUTH2
PLAIN-CLIENTTOKEN
XOAUTH
Other 591 mechanisms found
Advertised
2,764,157
2,760,100
431,634
230,152
19,850
16,555
13,663
3118
1642
1641
5329
Servers
99.27%
99.15%
15.50%
8.26%
0.71%
0.59%
0.49%
0.11%
0.05%
0.05%
0.19%
Mechanism
PLAIN, LOGIN
LOGIN, PLAIN
LOGIN, CRAM-MD5, PLAIN
LOGIN, PLAIN, CRAM-MD5
DIGEST-MD5, CRAM-MD5, PLAIN, LOGIN
CRAM-MD5, PLAIN, LOGIN
PLAIN, LOGIN, CRAM-MD5
CRAM-MD5, DIGEST-MD5, LOGIN, PLAIN
PLAIN
Other 1234 combinations found
Advertised
2,092,594
224,197
96,322
45,477
36,416
29,046
24,914
19,877
17,079
326,392
Servers
75.15%
8.51%
3.45%
1.63%
1.30%
1.04%
0.89%
0.71%
0.61%
7.11%
TABLE IX: Authentication mechanisms offered by servers on
IMAPS port.
TABLE XI: Combinations of authentication mechanisms offered
by servers on IMAPS port.
Mechanism
PLAIN
LOGIN
CRAM-MD5
CRAM-SHA1
CRAM-SHA256
DIGEST-MD5
GSSAPI
NTLM
X-ZIMBRA
MSN
Other 61 mechanisms found
Advertised
3,753,658
2,430,559
467,460
186,355
185,427
160,893
18,851
17,106
7582
4181
6773
Servers
96.66%
62.59%
12.04%
4.80%
4.77%
4.14%
0.49%
0.44%
0.20%
0.11%
0.17%
Mechanism
PLAIN, LOGIN
PLAIN
CRAM-MD5, CRAM-SHA1, CRAM-SHA256,
PLAIN
CRAM-MD5, PLAIN
PLAIN, LOGIN, DIGEST-MD5, CRAM-MD5
LOGIN
CRAM-MD5, PLAIN, LOGIN, DIGEST-MD5
PLAIN, LOGIN, CRAM-MD5
CRAM-MD5, PLAIN, LOGIN, DIGEST-MD5,
NTLM
PLAIN, X-ZIMBRA
Other 1039 combinations found
Advertised
2,222,721
982,386
183,813
Servers
60.16%
26.59%
4.97%
90,341
78,061
21,842
16,660
10,731
9105
7569
71,685
2.45%
2.11%
0.59%
0.45%
0.29%
0.25%
0.20%
1.94%
root certiﬁcate needs to be kept online, a serious attack vector.
A root certiﬁcate compromise would necessitate an update of
all clients that include it. We expect the number of certiﬁcates
that are directly issued from a root certiﬁcate to shrink further.
Indeed, there were very few cases already in our scan.
For SMTP, for instance, we found only 794 cases, or 0.07%
of veriﬁable chains. The percentages for SUBMISSION was
0.08%. Interestingly, it was 0.5% for SMTPS. SMTPS is
deprecated—it is not implausible that operators who still enable
SMTPS have simply never upgraded to new, intermediate-issued
certiﬁcates. For good measure, we also tested this property for
the two IRC protocols (only one case for IRCS), the two XMPP
client-to-server variants (two for STARTTLS, 14 for XMPPS),
and the two XMPP server-to-server variants (one case each).
G. Authentication methods
We analysed the authentication mechanisms supported and
advertised by servers to clients when sending mails using
SUBMISSION or retrieving mails with IMAPS. In our active
measurements, we queried the servers for authentication ca-
pabilities using the EHLO command for SUBMISSION and
the CAPABILITIES command for IMAPS. Capabilities were
always queried after TLS session establishment. We show the
most common authentication mechanisms in Tables VIII and IX.
The results obtained for both SUBMISSION and IMAPS
show poor support for strong authentication mechanisms. Mech-
anisms transmitting credentials in plaintext (PLAIN and LO-
GIN) are supported by more than 99% of the SUBMISSION
and 90% of the IMAPS servers. On the other hand, less than
16% of the SUBMISSION and 12.04% of the IMAPS servers
support much stronger mechanisms such as CRAM.
This is made worse by the fact that the vast majority
of SUBMISSION (84.86%) and IMAPS (87.43%) servers
support only PLAIN and LOGIN. The ordering of authentication
mechanisms is not particularly encouraging, either: clients
obeying the ordering suggested by many servers will use a
plaintext mechanism for SUBMISSION (resp. IMAPS) in at
least 96.19% (resp. 89.35%) of the cases (Tables X and XI)
In addition, as part of our passive data collection, we also
measured which authentication methods servers offered. In
contrast to our active measurement, we can only record the au-
thentication methods offered before encryption starts, not those
after encryption has started. Table XII shows the percentage of
servers that offer a certain authentication mechanism as well as
the percentage of connections in which a certain authentication
mechanism was offered. Table XIII shows the combination of
authentication mechanisms offered that we observed.
The results here are not encouraging—while, according to
Table XIII, only 68.88% of servers offer authentication before
STARTTLS, 39.87% of all servers offer only authentication
based on PLAIN and LOGIN. When looking at the number of
connections, this picture is even more pronounced with only
4.94% of connections containing information about authentica-
tion mechanisms before STARTTLS, but 3.51% of all observed
connections containing only plaintext authentication mecha-
12
TABLE XII: Authentication mechanisms observed in connec-
tions on SUBMISSION port.
interest of reliability, many clients and servers will fall back to
non-encrypted connections should STARTTLS not be offered.
Mechanism
PLAIN
LOGIN
CRAM-MD5
DIGEST-MD5
XAOL-UAS-MB
GSSAPI
NTLM