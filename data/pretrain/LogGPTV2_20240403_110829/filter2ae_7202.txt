# 智胜空天·安全护航 | 无人机系统安全问题和防护技术
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
本文为《智胜空天·安全护航》无人机现状观察及安全分析报告解读系列的第二篇。无人机安全既是保障产业高质量发展的基础，又是未来领域能力建设的刚性要求，为此报告着眼于无人机系统的安全性，梳理无人机国内外安全研究动态，并对无人机所面临的安全威胁进行阐述和分析，提出相应的加固或防护建议。
## 一、无人机系统
无人机系统主要由三大部分组成，包含无人机机体、地面站以及传输信息的通信链路。地面控制系统负责接收地面站的控制命令，并将命令发送给无人机，以控制无人机的飞行。无人机接收到地面控制系统的控制命令后，通过飞行控制系统对电机和舵机进行控制，从而实现飞行。同时，无人机的传感器负责收集无人机的运动状态信息，并将信息传递给地面控制系统。地面控制系统接收到无人机的运动状态信息后，将信息传递给地面站，地面站则根据无人机的运动状态信息，进行相应的处理，并向地面控制系统发送新的控制命令，以指导无人机的飞行。这样，无人机系统就能够通过地面站对无人机进行远程控制，实现无人机的飞行。
## 二、国内外安全研究动态
01 无人机劫持攻击
2022年，BlackHat欧洲大会上，某研究员展示了对无人机的劫持攻击。通过研究无人机的信号，分析出无人机的跳频规律以及无线协议格式，实现了一个伪造的地面控制器来劫持空中飞行的无人机。
02 针对无人机的模糊测试
2020年8月，某大学的研究人员针对消费级无人机使用模糊测试方法进行网络安全评估，在其研究成果中作者探讨了一个新的无人机漏洞，并给出了相应的安全保护措施。作者使用模糊测试的方法发送变异数据到无人机的FTP端口，并向无人机的其他端口也发送了大量数据报文。在测试中，持续监测无人机相关性能，以确定特定故障的模式和漏洞影响。这个模型被应用于ParrotBebop2，在测试过程中，ParrotBebop2的GPS性能下降、视频速度、无人机对地面站的响应速度、无人机传感器数据的准确性均受到相应影响。
03 无人机渗透测试框架
2019年，BlackHat欧洲大会上展示了一款针对无人机的渗透测试工具“DroneSploit”，这是为无人机黑客量身定制的一个类似Metasploit的框架。据介绍，DroneSploit只针对Wi-Fi控制的无人机（例如ARDrone、DJITello、MavicMini），但不支持基于射频（RF）的无人机（如DJIPhantom4、MavicPro等）。该工具旨在帮助发现无人机安全漏洞。
04 无人机攻击家用智能设备
2019年，Defcon大会上，某安全研究员展示了如何利用无人机攻击现代智能电视。在其公布的一段视频中，他使用DJI四轴飞行器悬挂一个配备有软件装置的无线电信号放大器，靠近邻居房屋顶部的电视接收天线，由于无人机携带的设备信号压制了智能电视原有的合法信号，很快，邻居家的电视屏幕上出现了Defcon字样的画面。很显然，无人机接管了邻居家的智能电视。
## 三、无人机系统攻击面
01 固件
**攻击面分析**
1.无人机序列号和重要部件编号是否存在未授权修改，特别是序列号，修改序列号可导致伪造其他用户的无人机，造成安全问题。
2.固件升级过程中存在恶意修改固件升级包的可能性，进而给无人机引入漏洞或后门。
**安全加固建议**
1、通过Anti-rollback机制防止无人机回滚到有漏洞的版本；
2、对固件本身进行保护，用数字签名技术来验证固件的真实性，通过加密技术来保护其中的数据；
3、限制硬件调试接口SWD、JTAG的滥用，服务、端口最小化。
02 软件服务
**攻击面分析**
软件服务方面，以下四类可能是关键的目标：飞行关键服务（如无人机飞行控制程序）、飞行支撑服务（FTP、RTP）、调试服务（ADB、TELNET、SSH）、网络服务（DHCP、mDNS）。
**安全加固建议**
1、开源组件尽量使用最新版本以缓解Nday漏洞的利用；
2、关键端口服务尽量不直接对外暴露，特别是调试类服务；
3、核心飞行服务进程可考虑使用内存安全语言进行重写。
03 无线通信
**攻击面分析**
1、 无线信号干扰、嗅探、欺骗；
2、 Wi-Fi协议栈漏洞、Wi-Fi Deauth攻击、Wi-Fi密码可预测；
3、 GPS欺骗。
**安全加固建议**
1、使用长度较长的跳频序列；在上层设计更加安全的传输协议，包括使用数据加密以及签名技术；分别从信号处理层面、信息处理层面检测欺骗，从协议设计上防止无线信号被简单的重放。
2、厂商做好漏洞管理，及时推送补丁对射频芯片以及无人机本身进行缓解；使用增强型WPA或WPA2加密；将Wi-Fi密码的设置权交给用户，并保证密码的强度。
3、使用多种不同的定位技术校验GPS信号的准确性；将依靠无人机自身传感器确定位置的自主定位技术作为备用措施；当系统发现GPS信号存在异常时，自动切换到备用定位方式。
04 应用协议
**攻击面分析**
Mavlink是一种非常轻量级的消息传输协议，用于地面站与无人机（以及机载无人机组件之间）进行通信，在各种消费级无人机中应用非常广泛。但是MavLink在协议设计之初就没有实现安全访问功能，MavLink的安全性依赖于底层协议，例如Wi-Fi安全，无线跳频通信等。攻击者只要攻破了底层协议的安全性，那么Mavlink协议就毫无安全性可言。
**安全加固建议**
在开源的Mavlink基础上，加入协议加密、数据签名、访问认证的部分。即使攻击者能攻破物理层协议，由于上层协议是加密签名的，依然可以保证无人机系统的通信安全。
05 传感器
**攻击面分析**
干扰陀螺仪、雷达传感器、超声波传感器、摄像头
**安全加固建议**
1、减少传感器对外部信号的暴露；
2、在不影响正常信号的情况下衰减恶意信号；
3、增加传感器的随机性；
4、改进组件质量；
5、融合多个或多种传感器在不同空间、时间或频率上的测量结果。
## 四、无人机产品安全通用建议
01 代码加固
1.为了提高代码的安全性，需要增强安全开发意识，遵守代码安全编写规范，严格杜绝危险函数的使用。
2.无人机产品的很多安全问题是由于引入了过时依赖库引起的，例如老旧版本的OpenSSL库、FTP库等，因此建议在保证兼容性的情况下，使用最新版本的依赖库以及操作系统。
02 安全测试
在无人机产品开发过程中，建议加入安全测试流程，帮助开发人员发现产品中潜在的安全性问题。也可借助开源的模糊测试工具测试协议栈、解析库等代码的健壮性。
03 漏洞管理
建议建立并完善漏洞收集机制和流程，有助于厂商及时发现缺陷，推送固件或软件更新。
## 五、未来发展
01 无人机技术发展
**电池技术**
电池是直接制约无人机发展与应用的关键因素，因此亟待大幅度提高电池的能量和功率密度以及安全性。
**通信系统**
公共无线电通信链路，抗干扰能力弱，尤其是同频干扰无法避免。民用无人机尤其消费级无人机受影响最大。
**定位导航**
无人机的定位功能是无人机自主导航的前提。未来有更多应用场景需要高精度、高可靠性、高抗干扰性的无人机，多种导航技术结合将是未来发展的方向。
**避障技术**
避障技术对确保公共安全至关重要，现有的解决方案仍处于探索阶段。主流的无人机避障技术有：超声波避障、红外避障、视觉避障和激光避障。
**自动飞行**
该技术的发展将在矿场采集、管道运输监控和建筑相关的场景中发挥极大作用。
**AI算法应用**
使用基于AI的路径规划和机器视觉技术，使无人机更加智能。
**网联无人机**
网联无人机采用多无人机协同工作的方式，能够实现更加高效和精确的作业。
02 反无人机技术
**反无人机解决方案和措施**
1\.
反无人机解决方案可分为三种类型：检测、非交互措施和拦截。检测：使用声学、热学、雷达、视觉等传感器或无线电频率(RF)发现无人机；非交互措施：发出警报、关闭Wi-Fi、干扰无人机摄像头等；拦截：激光、捕捉网、射频/GNSS干扰等；
**发展方向展望**
2\. 更具有针对性：对特定型号的无人机进行有针对性的信号压制及欺骗；更加智能化：自动化发现、识别、跟踪无人机目标。
03 无人机防护技术
**隐身化**
隐身化是目前无人机发展的重要方向之一,是高端无人机的重要技术瓶颈之一。隐身技术是对目标特征信号进行有效控制和抑制的技术，主要包括雷达隐身、红外隐身等。
**防破解**
防破解是目前无人机尤其消费级无人机防护的重点之一。遭破解后的无人机可绕过厂商本身的各种限制，尤其是绕过禁飞区限制。因此需要厂商及时对软件、固件存在的已知问题进行更新，并在未来从硬件层面使用诸如安全芯片等技术来保证无人机的安全。