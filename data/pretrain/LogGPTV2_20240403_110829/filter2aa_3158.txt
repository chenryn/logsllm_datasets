Submitted to DefCon16
Autoimmunity  
Disorder in 
Wireless LANs
By
Md Sohail Ahmad
J V R Murthy, Amit Vartak
AirTight Networks
Submitted to DefCon16
Disclaimer & About Us
We are no medical doctors – our only 
competency is coffee drinking. The last year 
we brought to you ‘Café Latte with free 
topping of cracked WEP’.
This year we’d like to share with you rather 
interesting observations about Wireless LAN 
behavior – some of which have an interesting 
parallel with a previously known disorder in 
medical science.
Submitted to DefCon16
What has Autoimmunity disorder got 
to do with Wireless LANs?
1
Submitted to DefCon16
Autoimmunity Disorder
An autoimmune disorder is a 
condition that occurs when 
the immune system
mistakenly attacks and 
destroys healthy body cell.
Submitted to DefCon16
Why it Caught Our Attention?
An autoimmune disorder is a 
condition that occurs when 
the immune system
mistakenly attacks and 
destroys healthy body cell 
(or client).
Submitted to DefCon16
Over many late night coding and 
debugging sessions, we spotted ..
An autoimmune disorder is a 
condition that occurs when 
an Access Point mistakenly 
attacks and destroys 
authorized body cell (or 
client).
Not just one.. we spotted 
many instances of this 
interesting, self-destructive 
behavior!
Submitted to DefCon16
So What?
Our findings suggest that new 
avenues for launching DoS attacks 
are possible. Majority of 
vulnerabilities reported here are 
implementation dependent and are 
found to exist in select open 
source AP and commercial Access 
Point S/W.
MFP(11w) is also vulnerable 
to DoS attacks!
Submitted to DefCon16
Background
2
Submitted to DefCon16
What’s Well Known -- DoS from an 
External Source
It is well known that by sending spoofed De-authentication or Dis-
association packets it is possible to break AP to client connections.
A De-authentication packet spoofed with source address = AP MAC 
address causes disconnection in client’s state machine.
Likewise, a De-authentication packet spoofed with source address = 
Client MAC address causes disconnection in AP’s state machine.
AP
Client
DoS
DoS
Attacker
Submitted to DefCon16
What’s New – Self DoS Triggered by 
an External Stimulus
 There exist mal-formed packets whose injection can 
turn an AP into a connection killing machine.
 We’ll demonstrate 8 examples of this behavior
AP
Client
Stimulus
DoS
Attacker
Submitted to DefCon16
Why Does Self DoS Happen? 
 Standard Protocol specs are often 
unclear about how an AP should 
respond to malformed frames. Different 
AP implementations behave differently. 
Some survive, some crash and some 
turn themselves into killing machines.
Submitted to DefCon16
An Example from madwifi-0.9.4
Attacker
Client
AP
After three 
slides we’ll 
show why this 
triggers a self 
DoS
Submitted to DefCon16
Let the game begin
3
Submitted to DefCon16
WLAN Test Lab
Autoimmunity Disorder Test Requirements
 A Raw Frame Injection Tool (e.g. wireshark-inject )
 Wireless LAN card (preferable .11abg) connected to BackTrack 2 (Linux 
box which supports raw wireless frame injection) box
 An operational wireless LAN (with at least one AP and couple of clients)
AP
Clinet2
Clinet1
Submitted to DefCon16
Stimulus for Autoimmunity Disorder 
Test
WLAN Frame
Association Request/Response
Re-association Request/Response
Authentication
WLAN Address Fields
Address1, Address2, Address3, Address4
Modified Information Elements (IE)
AP MAC 
ADDR
Client 
MAC 
ADDR
BSSID 
MAC 
ADDR
Client/Broad
cast MAC 
address
AP
MAC 
address
BSSID
MAC
ADDR
Submitted to DefCon16
Stimulus #1
Use of Broadcast MAC address in Address 2 Field
 Send Broadcast MAC address (FF:FF:FF:FF:FF:FF) as source MAC address 
(Address 2 in WLAN Frame Header) in any class 2 or 3 (e.g. TO DS DATA) 
frame.
 Since FF:FF:FF:FF:FF:FF is a special type address and is not present in Access Point 
association table, AP is likely to send Deauthentication Notification frame with Reason 
Code “Class 3 frame received from nonassociated station”
 Associated STAs honor the Broadcast Disconnection frame and disconnect from 
associated AP
Submitted to DefCon16
Stimulus #2
Use of Multicast MAC address in Address 2 Field
 Send Multicast MAC address (01:XX:XX:XX:XX:XX) as Source MAC address in 
any class 2 or 3 frame (e.g. TODS DATA frame).
 Since 01:XX:XX:XX:XX:XX is a multicast address, It does not appear in the AP’s 
association table. 
 On reception of DATA frame with Multicast MAC address as source address, Access 
Point is likely to send Disconnection Notification frame with Reason Code “Class 3 
frame received from nonassociated station”
 All associated node honors the Multicast Disconnection Notification frame and 
disconnects from associated AP
Submitted to DefCon16
Stimulus #3
Use of 4 MAC address WLAN Frame
 Send 4-MAC address WDS DATA frame with victim’s STA MAC as source MAC 
address (Address 2 in WLAN Frame header) in WDS DATA frame.
 Access Point not capable to handle 4MAC address DATA frame, likely to send 
disconnection notification to that Client
Submitted to DefCon16
Stimulus #4
 An Association Request with spoofed Capabilities Field sent to an 
Access Point can potentially drops client’s connection at AP and likely to 
trigger a response with Status Code 10 (Cannot support all requested 
capabilities in the Capability Information field)
Submitted to DefCon16
Stimulus #5
 A Reassociation Request with spoofed Current AP Address field sent 
to an Access Point can potentially disconnect an associated client and 
can trigger a response with Status Code 11 (Reassociation denied due 
to inability to confirm that association exists)
Submitted to DefCon16
Stimulus #6
 An Authentication frame with invalid Authentication Algorithm sent 
to an Access Point can potentially disconnect an associated client and 
can trigger a response with Status Code 13 (Responding station does 
not support the specified authentication algorithm)
Submitted to DefCon16
Stimulus #7
 An Authentication frame with invalid Authentication Transaction 
Sequence Number sent to an Access Point can potentially disconnect 
an associated client and can trigger a response with Status Code 14
(Received an Authentication frame with authentication transaction
sequence number out of expected sequence)
Submitted to DefCon16
Stimulus #8
 An Association Request frame with invalid BSS BasicRateSet 
parameter sent to an Access Point can potentially disconnect an 
associated client and can trigger a response with Status Code 18
(Association denied due to requesting station not supporting all of the 
data rates in the BSS BasicRateSet parameter)
Submitted to DefCon16
Autoimmunity Disorder Report
Yes
No
Yes
Yes
No
Yes
Spoofed 
Associati
on 
Request 
Frame
Yes
Yes
Cisco Model 
No AIR-
AP1230A-A-
K9 Firmware 
Ver
12.3(2)JA2
Yes
Yes
Buffalo 
Model No-
WZR-
AG300NH, 
Firmware 
ver 1.48
Yes
Yes
Yes
Yes
Spoofed 
ReAssoci
ation
Request 
Frame
Yes
Yes
Yes
Yes
Spoofed 
Authentic
ation 
Frame
Madwifi-
0.9.4 driver 
with Cisco 
Aironet
a/b/g Card
Cisco Model 
No AIR-
AP1232AG-A-
K9 Firmware 
Ver
12.3(8)JEA3
Linksys
Model No 
WRT350N, 
Firmware Ver
1.0.3.7
DLink, Model 
No DIR-655, 
Firmware 
Ver 1.1
Attack 
Type
Submitted to DefCon16
Autoimmunity Disorder Report
Yes
Yes
No
No
No
Yes
Use of 
Multicast 
MAC as a 
Source 
MAC
No
No
Cisco Model 
No AIR-
AP1230A-A-
K9 Firmware 
Ver
12.3(2)JA2
Yes
Yes
Buffalo 
Model No-
WZR-
AG300NH, 
Firmware 
ver 1.48
Yes
No
No
No
Use of 
WDS 
DATA 
Frame
Yes
No
No
Yes
Use of 
Broadcast 
MAC as 
Source 
MAC
Madwifi-
0.9.4 driver 
with Cisco 
Aironet
a/b/g Card
Cisco Model 
No AIR-
AP1232AG-A-
K9 Firmware 
Ver
12.3(8)JEA3
Linksys
Model No 
WRT350N, 
Firmware Ver
1.0.3.7
DLink, Model 
No DIR-655, 
Firmware 
Ver 1.1
Attack 
Type
Submitted to DefCon16
Does Cisco MFP also suffer from 
Autoimmunity disorder?
4
Submitted to DefCon16
MFP Background
The root cause of disconnection based DoS vulnerability in 802.11 
is that management frames used for connection establishment and 
termination are not protected. Hence, a connection can easily be
terminated by spoofing these frames.
Management Frame Protection MFP (or 802.11w) aims to solve 
this problem by protecting connection termination frames.
MFP Enabled
AP
MFP Enabled
Client
Stimulus Spoofed 
Disconnection Frame to AP
AP and Client are
in associated state. 
Data port Open for
client
Attacker
Stimulus Spoofed 
Disconnection Frame to CL
Unprotected, 
Disconnection 
Frame 
Discarded By 
AP
Unprotected, 
Disconnection 
Frame 
Discarded By 
Client
Submitted to DefCon16
Autoimmunity Disorder in MFP 
Infrastructure WLANs
 Autoimmunity Disorder in MFP (L)APs
Details will be provided during 
presentation !!!
Submitted to DefCon16
Autoimmunity Disorder in MFP 
Infrastructure WLANs
 Autoimmunity Disorder in MFP Clients
Details will be provided during 
presentation !!!
Submitted to DefCon16
Autoimmunity Disorder Report of 
MFP Protocol
Details will be provided during 
presentation !!!
Submitted to DefCon16
The key take away
5
Submitted to DefCon16
The Key Point
Without MFP protection
New avenues for launching DoS
attacks are possible. Majority of 
vulnerabilities reported here are 
implementation dependent and are 
found to exist in select open 
source AP and commercial Access 
Point S/W.
With MFP protection
DoS vulnerabilities could not be 
completely eliminated. Even MFP 
was found vulnerable!
Submitted to DefCon16
Food for Thought
 A fix for MFP vulnerability has already 
been attempted in the latest 11w draft. 
Future revisions of 11w draft will continue 
to raise the bar & try to make 802.11 DoS
attack proof.
Will the dream of attack proof 802.11 be 
ever realized?
Submitted to DefCon16
References
www.cs.ucsd.edu/users/savage/papers/UsenixSec03.pdf
http://en.wikipedia.org/wiki/IEEE_802.11w
http://www.cisco.com/en/US/tech/tk722/tk809/technologies_configur
ation_example09186a008080dc8c.shtml
Submitted to DefCon16
Contact Us
Md Sohail Ahmad
PI:EMAIL
Amit Vartak
PI:EMAIL
J V R Murthy
PI:EMAIL