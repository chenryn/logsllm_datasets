title:DeepPower: Non-intrusive and Deep Learning-based Detection of IoT
Malware Using Power Side Channels
author:Fei Ding and
Hongda Li and
Feng Luo and
Hongxin Hu and
Long Cheng and
Hai Xiao and
Rong Ge
DeepPower: Non-intrusive and Deep Learning-based Detection
of IoT Malware Using Power Side Channels
Fei Ding, Hongda Li, Feng Luo, Hongxin Hu, Long Cheng, Hai Xiao and Rong Ge
Clemson University
{feid, hongdal, luofeng, hongxih, lcheng2, haix, rge}@clemson.edu
ABSTRACT
The vulnerability of Internet of Things (IoT) devices to malware
attacks poses huge challenges to current Internet security. The IoT
malware attacks are usually composed of three stages: intrusion,
infection and monetization. Existing approaches for IoT malware
detection cannot effectively identify the executed malicious activ-
ities at intrusion and infection stages, and thus cannot help stop
potential attacks timely. In this paper, we present DeepPower, a
non-intrusive approach to infer malicious activities of IoT mal-
ware via analyzing power side-channel signals using deep learning.
DeepPower first filters raw power signals of IoT devices to obtain
suspicious signals, and then performs a fine-grained analysis on
these signals to infer corresponding executed activities inside the
devices. DeepPower determines whether there exists an ongoing
malware infection by conducting a correlation analysis on these
identified activities. We implement a prototype of DeepPower lever-
aging low-cost sensors and devices and evaluate the effectiveness
of DeepPower against real-world IoT malware using commodity IoT
devices. Our experimental results demonstrate that DeepPower is
able to detect infection activities of different IoT malware with a
high accuracy without any changes to the monitored devices.
CCS CONCEPTS
• Security and privacy → Malware and its mitigation; • Com-
puter systems organization → Embedded hardware; • Comput-
ing methodologies → Neural networks.
KEYWORDS
IoT; malware detection; non-intrusive; power side channels; deep
learning
ACM Reference Format:
Fei Ding, Hongda Li, Feng Luo, Hongxin Hu, Long Cheng, Hai Xiao and Rong
Ge. 2020. DeepPower: Non-intrusive and Deep Learning-based Detection
of IoT Malware Using Power Side Channels. In Proceedings of the 15th ACM
Asia Conference on Computer and Communications Security (ASIA CCS ’20),
October 5–9, 2020, Taipei, Taiwan. ACM, New York, NY, USA, 14 pages.
https://doi.org/10.1145/3320269.3384727
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
ASIA CCS ’20, October 5–9, 2020, Taipei, Taiwan
© 2020 Association for Computing Machinery.
ACM ISBN 978-1-4503-6750-9/20/10...$15.00
https://doi.org/10.1145/3320269.3384727
1 INTRODUCTION
As Internet of Things (IoT) has become an integral part of our
lives, these devices provide great convenience and efficiency while
also introduce unexpected risks and new threats. There have been
lots of high-profile attacks against IoT devices being reported re-
cently [3, 4, 47]. These compromised IoT devices can be leveraged
to launch Distributed Denial of Service (DDoS) attacks [3] or Per-
manent Denial of Service (PDoS) attacks [47]. Existing research
divides the IoT malware attacks into three stages: intrusion, infec-
tion, and monetization [44, 46]. Through an in-depth analysis of IoT
malware, we find that there exist several common activities in many
IoT malware attacks, such as usage exploitation, malware down-
loading, permission change, and binary execution. These activities
are the most basic activities to launch IoT malware attacks, and
even unknown malware variants need to perform these activities.
In order to minimize the loss caused by IoT malware, it is important
to identify these malicious activities as early as possible.
In general, malware detection approaches can be divided into
two categories: network-based and host-based approaches. The
network traffic analysis [19, 42] has be commonly used for protect-
ing IoT systems. When malicious traffic patterns are detected in
IoT networks, warnings are generated. However, such a solution
cannot examine the details of activities that are executed in IoT
devices, which are important to enable fine-grained detection of
IoT malware. Another possible solution is to detect these activities
by host-based security mechanisms [2, 51]. Unfortunately, IoT de-
vices are usually resource-constrained and always hard to support
full-fledged detection solution. Even worse, these devices are de-
signed based on different principles and mechanisms, which make
it difficult to apply one general detection approach to all kinds
of devices. Therefore, it is not practical to directly leverage tradi-
tional host-based security solutions (e.g., antivirus) to secure IoT
devices [61]. A feasible detection solution for IoT malware should
be able to effectively monitor the infection activities while require
minimal changes to the software or hardware of IoT devices. Intu-
itively, the non-intrusive monitoring (i.e., side-channel analysis) of
a system’s runtime activities is such an ideal host-based method
for the detection of IoT malware.
Non-intrusive power side-channel approaches have been re-
cently developed to distinguish malicious and legitimate activities
based on the power signals (i.e., power consumption measurements)
of embedded devices [9, 33, 60]. For example, WattsUpDoc [9] is
an anomaly-based detection method to identify malware on medi-
cal devices. However, existing detection methods based on normal
and abnormal patterns cannot be directly used for effective detec-
tion of IoT malware. Usually, they only consider deviations from
normal baselines as abnormal but ignore the internal details of
these anomalous behaviors. That said, they cannot differentiate
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan33specific malicious activities and attack stages. Simply categorizing
anomalous activities as an attack without considering different
stages of attacks could inevitably cause a large number of false pos-
itives. Therefore, it is necessary to design a fine-grained approach
to further identify executed activities (i.e., commands) from these
anomalous cases, and achieve an effective detection of IoT malware.
The IoT malware detection based on fine-grained power side-
channel analysis requires us to address several critical technical
challenges. First, there is a lack of in-depth analysis of activities
of IoT malware due to the lack of relevant malware samples. A
systematic analysis of IoT malware is important to identify their
common activities. Second, though power signals provide a promis-
ing solution, they are notoriously noisy due to the fact that most
IoT devices rely on the alternating current. It is unclear whether the
power signals associated with different activities in IoT devices are
distinguishable. It is even challenging to detect multiple consecutive
activities as there are no clear boundaries in their corresponding
power signals. Third, even if we can accurately infer activities from
power signals, it is non-trivial to determine whether these activities
are belonging to IoT malware attacks or benign usage.
In this paper, we address the above challenges and present Deep-
Power, a novel framework for non-intrusive detection of IoT mal-
ware based fine-grained power signals analysis. First, we identify
common activity patterns of IoT malware from a set of known
open-source malware and reverse engineering reports. Second,
DeepPower performs an effective data preprocessing to tackle the
problem of noisy power signals. By using deep learning techniques,
DeepPower infers executed activities from corresponding power
signals. Third, DeepPower performs a correlation analysis of these
activities to determine whether there exist malware infections in
IoT devices.
We make the following contributions in this paper:
• We perform a study of IoT malware infection process based
on open-source IoT malware and reverse engineering reports.
We categorize the malicious activities of IoT malware into
one intrusion and five infection states, and identify common
activities of IoT malware in the process of infecting devices.
• We develop effective data preprocessing methods to min-
imize the influence of noise in power signals, including a
wavelet denoising method to remove background noise, and
a feature extraction method to obtain unique signal patterns.
These methods collectively improve the performance of the
following malware detection task.
• We propose a new framework, DeepPower, for the non-intrusive
detection of infection activities of IoT malware using power
signals based on deep learning. DeepPower begins with a fast
signal detection to identify suspicious activities, and then
utilizes an attention-based Seq2Seq model to achieve a fine-
grained analysis of these suspicious signals. After inferring
these activities, DeepPower conducts a correlation analysis
between activities and infection states, and outputs the final
detection results.
• We implement the DeepPower system by using low-cost
sensors and devices, and evaluate its effectiveness for non-
intrusive detection based on real-world IoT malware using
commodity IoT devices. Our experiment results show that
Figure 1: The power signals collected on a D-Link IP Camera
during the infection process of IoT malware Mirai [41]. The
red boxes (a), (b) and (c) indicate three different infection
activities: login attempts, environment preparation and file
downloading.
DeepPower can detect the infection activities of different
IoT malware with high accuracy (90.4% detection rate on
average) without any changes to IoT devices.
Roadmap. Section 2 describes the threat model and deployment
scenarios. Section 3 presents our study of intrusion and infection
process of IoT malware. Section 4 describes our DeepPower design.
Implementation and evaluation details are discussed in Section 5.
Section 6 reviews related work and Section 7 concludes this paper.
2 THREAT MODEL AND DEPLOYMENT
SCENARIOS
Due to the software and hardware constraints in IoT devices, it still
lacks an effective security mechanism to protect these devices. Many
devices with known and unknown vulnerabilities (e.g., default/weak
passwords, unpatched bugs) are still being exploited. It is highly
desirable for these resource-constrained devices to detect malware
activities in a non-intrusive manner. The power side-channel anal-
ysis is one of ideal choices. Previous research shows that power
signal analysis can achieve high detection rates of anomalous be-
haviors [9], but it inevitably results in some false positives due
to noisy power signals. A traditional anomaly detection solution,
however, doesn’t further analyze these abnormal behaviors and
thus only provides a coarse-grained detection.
Taking the IoT malware Mirai [41] as an example, as shown in
Figure 1, during its infection process on a D-Link IP Camera, there
exist at least three different waveforms (a), (b) and (c), which indi-
cate three different infection activities: login attempt, environment
preparation, and file downloading. The traditional anomaly detec-
tion method can only categorize these three different waveforms
as abnormal cases, but cannot tell us what activities behind these
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan34is also possible to extend Smart Plug products to monitor multiple
IoT devices at the same time. As shown in Figure 2 (c) for the third
deployment scenario, IoT device vendors could integrate power
sensors into some IoT devices, which means that it would be much
easier to monitor the power consumption of those devices. Actually,
internal power sensors have already been integrated into today’s
smartphones. Previous studies have shown the possibility to use
the power consumption for detecting malware in smartphones [40].
3 IDENTIFYING INTRUSION AND INFECTION
ACTIVITIES OF IOT MALWARE
In this work, we collect and analyze open-source IoT malware in-
cluding Mirai [41], Linux.wifatch [58], and Lightaidra [16], and
reverse engineering reports from security researchers [3, 23]. We
observe that there exist two typical stages when IoT malware at-
tempts to compromise a device. The first stage is intrusion process,
at which attackers try to log into IoT devices. The second one is
infection process, at which several activities are executed to prepare
the environment, and download and execute malware binary files to
infect the devices. Through the infection process, several activities
are used to infect vulnerable devices.
3.1 Intrusion Process of IoT Malware
After the intrusion process, the attacker is able to get a remote shell
and execute several commands to infect devices or cause a severe
damage. Usually, IoT devices are exposed to a number of security
attacks, including weak/default passwords, lack of encryption, back-
door, and zero-day vulnerabilities. As listed in Table 1, we categorize
the intrusion process into two types: vulnerable authentication, and
unpatched or zero-day vulnerabilities.
Vulnerable Authentication: Authentication plays an essential
role in IoT security solutions. A poor authentication mechanism can
lead to a device to be compromised easily and thus attackers can get
its remote shell. For example, most of IoT malware compromise and
infect devices through weak/default passwords on Telnet, and hijack
them to launch DDoS attacks. An increasingly popular cyber-attack,
Permanent Denial of Service (PDoS) attack, also uses the same
security flaws as Mirai [47] to compromise the victim’s hardware.
Unpatched or Zero-day Vulnerabilities: Another category
of intrusion is based on exploiting unpatched or new vulnera-
bilities, which can also be used to launch DDoS attacks, such as
OKIRU/SATORI [7] and Amnesia [59]. IoTroop [8] is a new type
of IoT botnet that is designed to scan device’s vulnerabilities in-
stead of brute forcing passwords. BASHLITE is a malware which
infects Linux-based IoT devices by exploiting the GNU Bash vul-
nerability known as ShellShock (CVE-2014-6271) [30]. It allows
attackers to execute malicious code via a crafted environment [12].
TheMoon [32] is a worm, which was firstly discovered in 2014 by
exploiting a vulnerability (CVE-2014-9853) in ASUS routers. It al-
lows attackers to bypass the authentication process and execute
malicious commands via a NET_CMD_ID_MANU_CMD packet to
UDP port 9999 [13].
Table 1 also lists several top security threats, such as buffer over-
flow and backdoor. For example, Linux.Darlloz [15] is a worm by
utilizing the PHP ‘php-cgi’ Information Disclosure Vulnerability
Figure 2: Three deployment scenarios of our proposed detec-
tion solution: (a) implementing it as an independent moni-
tor; (b) integrating it into the Smart Plug; and (c) adding a
power sensor to an IoT device.
suspicious signals. In fact, it is obvious that these three power wave-
forms are different. Thus, it is desirable to perform a fine-grained
analysis of these waveforms, and identify corresponding activities
that cause these abnormal waveforms.
2.1 Threat Model
In this paper, we focus on Linux-based IoT devices, which are the
main target of IoT malware [3, 10]. Remote attackers may exploit
different vulnerabilities [61] (such as device firmware flaws, un-
protected authentication, and vulnerable applications) for compro-
mising IoT devices. In the intrusion process, the attacker can get
a remote shell and execute several commands to infect devices
or cause a severe system damage. The infection process has sev-
eral states/steps for preparing the environment, and downloading
and executing the malware binary. We don’t consider the situation
where multiple attackers attack the same device simultaneously
and execute their own infection activities in parallel. We aim at
the detection of IoT malware attacks, which perform malicious or
destructive behaviors on devices by injecting commands. Although
most of the IoT malware targets the Linux-based devices running
BusyBox [29], which combines many common UNIX utilities into a
single executable, our design is not limited to these Linux-based IoT
devices running BusyBox, and generally applicable to any Linux-
based devices.
2.2 Deployment Scenarios
Our research goal is to design a low cost and non-intrusive IoT
malware detection solution, which can support various flexible
deployment scenarios. It has a strong advantage of being inexpen-
sively deployable for critical IoT devices, i.e., IP cameras, rather
than for every IoT device. There are several feasible deployment
solutions in real world as shown in Figure 2. Figure 2 (a) demon-
strates a deployment scenario where our detection solution can
be implemented as an independent monitoring system, which is
provided by third-party vendors. Such a plugin system is placed
between an IoT device that needs to be protected and an AC-power
adaptor. For the second deployment scenario shown in Figure 2 (b),
since there are already Smart Plug products on the market that can
monitor the energy consumption of devices [5], it would be easy
to integrate our solution into such Smart Plug products. In fact, it
Session 1: IoT Security and Privacy ASIA CCS '20, October 5–9, 2020, Taipei, Taiwan35Table 1: The intrusion summary of reported IoT malware.
Intrusion Type Attack Type
DDoS attacks
Vulnerable
Authentication
PDoS attacks
Brute force attacks
DDoS attacks
Crypto-currency mining
Buffer overflow attacks
Backdoor attacks
Unpatched
Vulnerabilities
Security Issue
Weak/default passwords or bypass
Weak/default passwords
Not limit password attempts
CVE-2017-17215,RCE, Shellshock
PHP Vulnerability (CVE-2012-1823)
Insecure HANP Protocol
Pre-auth RCE vulnerability of IP Camera Affect 1250+ models [27]
IoT Malware Attacks
Mirai [4], Remaiten [35]
BrickerBot [47]
Linux/NyaDrop [39], LuaBot [39]
Amnesia [59], IoTroop [8]
Linux.Darlloz [4]
DSP-W215 Smart Plug [14]
malware and become active. As shown in Table 2, most of the IoT
malware take advantage of these three commands to compromise
vulnerable devices. The rm command and kill or killall command
also appear often in our collection. The former one is used to delete
all malicious files when they are successfully executed. The latter
one may be used to terminate the telnet, SSH, and HTTP services
to prevent victim’s device to be compromised again.
Take the IoT Mirai malware for example, the infection log shows
that it will execute several commands after successful login. The
first step is to check and customize the environment. It executes
“/bin/busybox ps;” command to display the processes running on
the system, and tries to find a folder with the write and execute
permissions to download malware files by using “/bin/busybox cat
/proc/mounts;” command. When it successfully executes echo, cat,
and rm commands, a suitable folder is found to save the malware