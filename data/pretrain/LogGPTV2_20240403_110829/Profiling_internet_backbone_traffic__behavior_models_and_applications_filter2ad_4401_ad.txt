### Cluster Reappearance Analysis

For the clusters that appear at least twice (2443 and 4639 srcIP clusters from links L1 and L2, respectively), we investigate whether they tend to reappear in the same Behavior Class (BC) or different BCs. Our findings indicate that a significant majority (approximately 95% on L1 and 96% on L2) of these clusters reappear within the same BC. Only a small number (117 clusters on L1 and 337 on L2) are observed in more than one BC. For example, out of the 117 clusters on L1, 104 appear in 2 BCs, 11 in 3 BCs, and 1 in 5 BCs. We refer to these clusters as "multi-BC" clusters.

We have conducted an in-depth analysis of the "behavior transitions" of these multi-BC clusters using their RU vectors (RUVs). The detailed analysis can be found in [25]. Our results show that most behavior transitions (i.e., a cluster moving from one BC to another) occur between "neighboring" or "akin" BCs (e.g., from BC7 to BC8). This is largely due to the choice of \(\epsilon\) in Eq.(3), rather than any significant behavioral changes. Only a very few clusters (e.g., only 28 out of the 117 multi-BC clusters on L1) exhibit large "deviant" behavior transitions (e.g., from a BC to a "non-akin" BC) due to significant traffic pattern changes, indicating instability.

### Temporal Properties of Behavior Classes

Our observations and results regarding the temporal properties of behavior classes and the behavior dynamics of individual clusters are consistent across the srcIP clusters extracted from L1 and other dimensions and links we studied. These results are detailed in [25]. In summary, our results demonstrate that the behavior classes defined by our RU-based classification scheme exhibit distinct temporal characteristics, as captured by frequency, populousness, and volatility metrics. Generally, clusters (especially frequent ones) display consistent behaviors over time, with only a very few occasionally showing unstable behaviors. In essence, our RU-based classification scheme captures certain behavior similarities among significant clusters, measured by how varied (e.g., random or deterministic) the flows in a cluster assume feature values in the other three free dimensions. The resulting behavior classification is consistent and robust over time, capturing clusters with similar temporal characteristics.

### Structural Models

#### Dominant State Analysis

In this section, we introduce the dominant state analysis technique for modeling and characterizing the interaction of features within a cluster. We also examine additional features, such as average flow sizes of clusters and their variabilities, to further characterize similarities and dissimilarities among behavior classes and individual clusters. The dominant state analysis and additional feature inspection together provide a plausible interpretation of cluster behavior.

Our dominant state analysis draws inspiration from structural modeling and reconstructability analysis in system theory ([26, 27, 28]) and recent graphical models in statistical learning theory [29]. The intuition behind our dominant state analysis is as follows: given a cluster, such as a srcIP cluster, all flows in the cluster can be represented as a 4-tuple (ignoring the protocol field) \((u, x_i, y_i, z_i)\), where the srcIP has a fixed value \(u\), while the srcPrt (X dimension), dstPrt (Y dimension), and dstIP (Z dimension) may take any legitimate values. Each flow in the cluster imposes a "constraint" on the three "free" dimensions X, Y, and Z. Treating each dimension as a random variable, the flows in the cluster constrain how the random variables X, Y, and Z "interact" or "depend" on each other via the induced joint probability distribution \(P(X, Y, Z)\). The objective of dominant state analysis is to explore the interaction or dependence among the free dimensions by identifying "simpler" subsets of values or constraints (called structural models in the literature [26]) to represent or approximate the original data in their probability distribution. We refer to these subsets as dominant states of a cluster. Given the information about the dominant states, we can reproduce the original distribution with reasonable accuracy.

To illustrate the basic ideas and usefulness of dominant state analysis, consider a srcIP cluster consisting mostly of scans (with a fixed srcPrt 220) to a large number of random destinations on dstPrt 6129. The values in the srcPrt, dstPrt, and dstIP dimensions these flows take are of the form \((220, 6129, *)\), where \(*\) (wildcard) indicates random or arbitrary values. Clearly, this cluster belongs to srcIP BC2 \([0,0,2]\), and the cluster is dominated by the flows of the form \((220, 6129, *)\). Therefore, the dominant state of the cluster is \((220, 6129, *)\), which approximately represents the nature of the flows in the cluster, even though there might be a small fraction of flows with other states.

Due to space constraints, we do not provide a formal treatment of the dominant state analysis in this paper. Instead, we depict the general procedure used to extract dominant states from a cluster in Fig. 6. Let \(\{A, B, C\}\) be a re-ordering of the three free dimensions X, Y, Z of the cluster based on their RU values: A is the free dimension with the lowest RU, B the second lowest, and C the highest; in case of a tie, X always precedes Y or Z, and Y precedes Z. The dominant state analysis procedure starts by finding substantial values in the dimension A (step 1). A specific value \(a\) in the dimension A is substantial if the marginal probability \(p(a) := \sum_b \sum_c p(a, b, c) \geq \delta\), where \(\delta\) is a threshold for selecting substantial values. If no such substantial value exists, the process continues to the next step.

#### Example of Dominant States

Table 3 provides examples of dominant states for srcIP clusters on L1 in a 1-hour period, with \(\delta = 0.2\). The table lists the BCs, the number of clusters, and the corresponding structural models. For instance, BC2 \([0, 0, 2]\) has 119 clusters, and the dominant state is \((\text{srcPrt}(220), \text{dstPrt}(6129), \text{dstIP}(*))\), representing the nature of the flows in the cluster.

The dominant state analysis and additional feature inspection together provide a comprehensive understanding of cluster behavior, enabling us to model and characterize the interactions of features within a cluster effectively.