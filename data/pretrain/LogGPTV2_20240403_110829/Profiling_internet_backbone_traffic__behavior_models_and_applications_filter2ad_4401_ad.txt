Next, for those clusters that appear at least twice (2443
and 4639 srcIP clusters from link L1 and L2, respectively),
we investigate whether they tend to re-appear in the same
BC or diﬀerent BC’s. We ﬁnd that a predominant majority
(nearly 95% on L1 and 96% on L2) stay in the same BC
when they re-appear. Only a few (117 clusters on L1 and
337 on L2) appear in more than 1 BC. For instance, out
of the 117 clusters on L1, 104 appear in 2 BC’s, 11 in 3
BC’s and 1 in 5 BC’s. We refer to these clusters as “multi-
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
l
y
t
i
r
a
u
p
o
P
0
0
2
6 7 8
1112
Behavior classes
181920
24 26
i
e
z
s
e
g
a
r
e
v
A
25
20
15
10
5
0
2
6 7 8
Behavior classes
181920
y
t
i
l
i
t
l
a
o
v
i
p
h
s
r
e
b
m
e
M
0.5
0.45
0.4
0.35
0.3
0.25
0.2
0.15
0.1
0.05
0
BC2
BC6
BC7
BC8
BC18
BC19
BC20
2000
1800
1600
1400
1200
1000
800
600
400
200
s
r
e
l
t
s
u
c
e
u
q
n
u
i
f
o
m
u
s
g
n
i
t
l
a
u
m
u
c
c
A
2
6 7 8
Behavior classes
181920
0
0
50
100
150
Time
200
250
300
(a) Popularity (Π)
(b) Average size (Σ)
(c) Volatility (Ψ)
(d) Ui(t) over time
Figure 4: Temporal properties of srcIP BCs using srcIP clusters on L1 over a 24-hour period.
BC” clusters. We have performed an in-depth analysis on
the “behavior transitions” of these “multi-BC” clusters in
terms of their RU vectors (RUVs), the detail of which can be
found in [25]. We ﬁnd that most of the behavior transitions
(i.e., a cluster from one BC to another BC) are between
“neighboring” or “akin” BC’s (e.g., from BC7 to BC8), more
a consequence of the choice of  in Eq.(3), rather than any
signiﬁcant behavioral changes. Only a very few (e.g., only
28 out of the 117 “multi-BC” clusters on L1) exhibit large
“deviant” behavior transitions (e.g., from a BC to a “non-
akin” BC) that are due to signiﬁcant traﬃc pattern changes,
and thus can be regarded as unstable clusters.
We conclude this section by commenting that our obser-
vations and results regarding the temporal properties of be-
havior classes and behavior dynamics of individual clusters
hold not only for the srcIP clusters extracted on L1 but
also on other dimensions and links we studied. Such results
are included in [25]. In summary, our results demonstrate
that the behavior classes deﬁned by our RU-based behavior
classiﬁcation scheme manifest distinct temporal characteris-
tics, as captured by the frequency, populousness and volatil-
ity metrics. In addition, clusters (especially those frequent
ones) in general evince consistent behaviors over time, with
only a very few occasionally displaying unstable behaviors.
In a nutshell, our RU-based behavior classiﬁcation scheme
inherently captures certain behavior similarity among (sig-
niﬁcant) clusters. This similarity is in essence measured by
how varied (e.g., random or deterministic) the ﬂows in a
cluster assume feature values in the other three free dimen-
sions. The resulting behavior classiﬁcation is consistent and
robust over time, capturing clusters with similar temporal
characteristics.
5. STRUCTURAL MODELS
In this section we introduce the dominant state analysis
technique for modeling and characterizing the interaction
of features within a cluster. We also investigate additional
features, such as average ﬂow sizes of clusters and their vari-
abilities for further characterizing similarities/dissimilarities
among behavior classes and individual clusters. The dom-
inant state analysis and additional feature inspection to-
gether provide plausible interpretation of cluster behavior.
5.1 Dominant State Analysis
Our dominant state analysis borrows ideas from struc-
tural modeling or reconstructability analysis in system the-
ory ([26, 27, 28]) as well as more recent graphical models
in statistical learning theory [29]. The intuition behind our
dominant state analysis is described below. Given a cluster,
say a srcIP cluster, all ﬂows in the cluster can be repre-
sented as a 4-tuple (ignoring the protocol ﬁeld) (cid:15)u, xi, yi, zi(cid:16),
where the srcIP has a ﬁxed value u, while the srcPrt (X
dimension), dsrPrt (Y dimension) and dstIP (Z dimension)
may take any legitimate values. Hence each ﬂow in the clus-
ter imposes a “constraint” on the three “free” dimensions
X, Y and Z. Treating each dimension as a random variable,
the ﬂows in the cluster constrain how the random variables
X, Y and Z “interact” or “depend” on each other, via the
(induced) joint probability distribution P(X, Y, Z). The ob-
jective of dominant state analysis is to explore the interac-
tion or dependence among the free dimensions by identifying
“simpler” subsets of values or constraints (called structural
models in the literature [26]) to represent or approximate the
original data in their probability distribution. We refer to
these subsets as dominant states of a cluster. Hence given
the information about the dominant states, we can repro-
duce the original distribution with reasonable accuracy.
We use some examples to illustrate the basic ideas and
usefulness of dominant state analysis. Suppose we have a
srcIP cluster consisting mostly of scans (with a ﬁxed srcPrt
220) to a large number of random destinations on dstPrt
6129. Then the values in the srcPrt, dstPrt and dstIP
dimensions these ﬂows take are of the form (cid:15)220, 6129,∗(cid:16),
where ∗ (wildcard) indicates random or arbitrary values.
Clearly this cluster belongs to srcIP BC2 [0,0,2], and the
cluster is dominated by the ﬂows of the form (cid:15)220, 6129,∗(cid:16).
Hence the dominant state of the cluster is (cid:15)220, 6129,∗(cid:16),
which approximately represents the nature of the ﬂows in
the cluster, even though there might be a small fraction of
ﬂows with other states.
For want of space, in this paper we do not provide a formal
treatment of the dominant state analysis. Instead in Fig. 6
we depict the general procedure we use to extract dominant
states from a cluster. Let {A, B, C} be a re-ordering of the
three free dimensions X, Y, Z of the cluster based on their
RU values: A is the free dimension with the lowest RU,
B the second lowest, and C the highest; in case of a tie,
X always precedes Y or Z, and Y precedes Z. The dom-
inant state analysis procedure starts by ﬁnding substantial
values in the dimension A (step 1). A speciﬁc value a in
the dimension A is substantial if the marginal probability
p(a) := b c p(a, b, c) ≥ δ, where δ is a threshold for se-
lecting substantial values. If no such substantial value exists,
Table 3: Dominant states for srcIP clusters on L1 in a 1-hour period: δ = 0.2.
srcIP
BC’s
BC2
[0, 0, 2]
BC6
[0, 2, 0]
BC7
[0, 2, 1]
BC8
[0, 2, 2]
BC18
[2, 0, 0]
BC19
[2, 0, 1]
BC20
[2, 0, 2]
BC24
[2, 2, 0]
No. of
Clusters
119
114
1
1
3
16
2
5
7
2
19
2
17
7
7
10
3
7
6
2
3
1
58
44
1
2
2
1
2
3
1
1
1
1
1
Structural Models
srcPrt(·)→dstPrt(·)→dstIP(*)
srcPrt(0)→dstPrt(0)→dstIP(*)[>99%]
srcPrt(1026)→dstPrt(137)→dstIP(*)[100%]
srcPrt(1153)→dstPrt(1434)→dstIP(*)[>98%]
srcPrt(220)→dstPrt(6129)→dstIP(*)[100%]
srcPrt(·)→dstIP(· · · )→dstPrt(*)
srcPrt(25)→dstIP(· · · )→dstPrt(*)
srcPrt(53)→dstIP(· · · )→dstPrt(*)
srcPrt(80)→dstIP(· · · )→dstPrt(*)
srcPrt(443)→dstIP(· · · )→dstPrt(*)
srcPrt(·)→dstIP(· · · )→ dstPrt(*)
srcPrt(25)→dstIP→dstPrt(*)
srcPrt(80)→dstIP→dstPrt(*)
srcPrt(.)→(dstPrt(*),dstIP(*))
srcPrt(80)→(dstPrt(*),dstIP(*))
dstPrt(·)→(·)dstIP→srcPrt(*)
dstPrt(53)→dstIP→srcPrt(*)
dstPrt(80)→dstIP→srcPrt(*)
dstPrt(·)→dstIP(*)→srcPrt(*)
dstPrt(53)→dstIP(*)→srcPrt(*)
dstPrt(80)→dstIP(*)→srcPrt(*)
dstPrt(7070)→dstIP(*)→srcPrt(*)
dstPrt(·)→(srcPrt(*),dstIP(*))
dstPrt(135)→(srcPrt(*),dstIP(*))
dstPrt(137)→(srcPrt(*),dstIP(*))
dstPrt(139)→(srcPrt(*),dstIP(*))
dstPrt(445)→(srcPrt(*),dstIP(*))
dstPrt(593)→(srcPrt(*),dstIP(*))
dstPrt(901)→(srcPrt(*),dstIP(*))
dstPrt(3127)→(srcPrt(*),dstIP(*))
dstPrt(6129)→(srcPrt(*),dstIP(*))
dstPrt(17300)→(srcPrt(*),dstIP(*))
dstPrt(34816)→(srcPrt(*),dstIP(*))
dstIP(.)→srcPrt(*)→dstPrt(*)
dstIP(.)→srcPrt(*)→dstPrt(*)
Range of
µ(P KT )
small
Range of
CV (P KT )
low
Range of
µ(BT )
small
Range of
CV (BT )
low
[1,2]
1
1
[1,2]
large
[0,1.6]
0
0
[0, 1.2]
high
[72,92]
78
404
[40,80]
large
[0,8.9]
0
0
[0,2.6]
high
[10,15]
[1,5]
[3,31]
[3,12]
large
[14,35]
[4,26]
large
[4,27]
medium
[2,5]
[3,18]
medium
[2,6]
[4,16]
3
small
[8.6,78]
[1041,2217]
[460,1.2 ∗ 104]
[320,1.5 ∗ 104]
[120,750]
[160,380]
[195,1.2 ∗ 105]
[2166,1.1 ∗ 105]
high
large
[1129,1381]]
[210,9146]
high
[2498,3167]]
[671,1.0 ∗ 104]
large
[1282,1.1 ∗ 104]
[740, 1.5 ∗ 104]
high
medium
[32,1.5 ∗ 105]
[26,6869]
high
[28,875]