0
2
/
4
2
8
/
0
1
0
2
/
5
2
8
/
0
1
0
2
/
6
2
8
/
0
1
0
2
/
7
2
8
/
0
1
0
2
/
8
2
8
/
0
1
0
2
/
9
2
8
/
0
1
0
2
/
0
3
8
/
Date of Return
Figure 4. For cookie IDs observed on the ﬁrst day of the month, the cumulative distribution of
the date that old and new cookies appear again in our dataset.
Cookie Set Cookie Accessed
Public
Private
Private
Private
Firefox
No
Private
Same private session
Yes
Different private session No
No
Public
Safari
Yes
Yes
No
No
Chrome
No
Yes
No
No
IE
No
Yes
No
No
Table 4. Accessibility of cookies in different browsing modes.
four of the most popular browsers in use today: Firefox
(version 3.6.11), Safari (version 5.0.2), Chrome (version
7.0.517.41), and Internet Explorer (version 8.0). Table 4
shows, for the browsing mode under which a cookie is
set (the ﬁrst column), whether the same cookie can be
accessed under another browsing mode (the second col-
umn). In all cases, a cookie set in private mode can be
accessed repeatedly in the same private browsing ses-
sion, but not across different private browsing sessions.
No cookies set in private mode can be accessed in pub-
lic mode. Safari is the only browser that allows private
mode to access cookies set in public mode.
In the next subsection, we perform ﬁne-grained clas-
siﬁcation to quantify the above possible causes of cookie
churn and characterize the corresponding users.
4.3 Understanding Cookie Churn
Applying the host-tracking results, we analyze
cookie churn by identifying cookies that are associated
with the same client host.
In Section 3.1, we show
that the host-tracking graph GUID derived from user lo-
gin IDs (with HostTracker) achieved over 92% precision
and recall in tracking clients, which are represented by
hardware IDs from the Validation dataset. Thus we use
the hosts deﬁned in GUID to serve as ground truth for
studying cookie churn. By overlapping GUID with the
Search dataset, we consider cookies whose query events
fall into binding windows associated with the same host
as corresponding to the same user (since user activity
roughly approximates host activity).
We focus on studying new cookie churn, as it is more
signiﬁcant than that of old cookies (see Figure 4). We
refer to the set of “one-time” cookie IDs (CIDs) that
are born on the ﬁrst day but do not return again in our
dataset as the churned new cookie IDs. In total, there
are 437,914 users (or hosts) that overlap with 847,196
churned new CIDs in the Search data. The number of
hosts is only about half of the number of churned cook-
ies IDs. We investigate the four cases that result in new
cookie churn, as illustrated in Figure 5, where the break-
down of users belonging to each category is shown in
Table 5. We elaborate on each of these cases separately
below.
4.3.1 Case 1: Non-Returning Users
If a CID overlaps with one of host h’s binding windows
at time t, but no other CIDs overlap h’s bindings from
time t onwards, we consider this as corresponding to a
user who does not return to the service (Figure 5(a)).
Number of users
Percentage of users (%)
Number of churned new CIDs
Percentage of churned new CIDs (%)
Case 3
67,310
Case 2
77,120
Case 4
Case 1
101,427
192,057
23.16% 17.61% 15.37% 43.86%
77,147
101,427
544,865
11.97%
9.12% 14.60% 64.31%
123,757
Table 5. Breakdown of the churned new cookie IDs into four categories of users.
(a) Case 1: User left the service.
(b) Case 2: User clears cookies.
)
%
(
s
e
i
r
e
u
q
f
o
e
g
a
t
n
e
c
r
e
P
100
80
60
40
20
0
1
d
8
h
r
2
4
a
y
h
r
m
i
n
−
1
h
r
(c) Case 3: Private browsing mode (one UA).
Case 4: Multiple browsers (multiple UAs).
Figure 5. Four cases of cookie churn. C1
is the churned new cookie ID. Horizontal
bars denote binding windows for a “host”
deﬁned by user IDs.
We ﬁnd that this case accounts for only 11.97% of the
churned new CIDs. Thus, despite the high cookie churn
rate, the majority (88.03%) of the churned new cookie
IDs correspond to returning users who might still be
tracked. The behaviors of the non-returning users are
examined in detail in Appendix B.
4.3.2 Case 2: Users that Clear Cookies
Cookie churn can also result from users intentionally re-
moving cookies. In this case, a host h’s bindings should
overlap with CIDs generated consecutively in time (Fig-
ure 5(b)). Each CID may be associated with multiple
queries that typically belong to a session. Among hosts
with new cookie churn, we ﬁnd 77,120 (17.61%) in
this category. Since we observe only cookies issued by
the Bing search engine, we cannot distinguish between
users who clear all cookies and those who selectively
clear cookies from certain domains.
To ﬁnd whether users clear cookies on exiting
browsers, we examine the time intervals between con-
secutive queries associated with the same CID, and com-
pare with those between consecutive queries associated
Figure 6. Distributions of query intervals.
with different CIDs. Figure 6 shows that the former is
distinctly smaller, with 75% of them below 10 minutes
and hence likely to belong to one session. By contrast,
90% of the query intervals between different CIDs are
larger than 8 hours. This suggests that most users clear
cookies per session, e.g., when they close the browser
window.
We also ﬁnd a small fraction (3.85%) of users whose
cookies are cleared per query, i.e., each of their queries
is associated with a different CID. These might be users
who take extreme measures to clear cookies for each
query to preserve privacy. However, such patterns can
become a distinctive feature that makes tracking easier,
despite the user’s intention of remaining anonymous.
4.3.3 Case 3: Users with In-Private Browsing Mode
Another reason for cookie churn is the use of the
browser’s private browsing mode. As illustrated in Fig-
ure 5(c), upon entering private mode, the old cookie (C2)
set under public mode is replaced by a new cookie (C3).
Upon exiting the private mode, the old cookie (C2) will
continue to be used by the same user.
We focus on the hosts whose cookies appear inter-
leaved in their binding windows, where an old cookie
continues to appear after the user submit queries with
a newer cookie. Since entering private browsing mode
does not change the browser used by the host, we iden-
tify those associated with a single UA string as users
who utilize private browsing mode, and 15.37% of users
belong to this category.
Together with case 2, there are in total around 33%—
a non-trivial fraction—of users who would like to pre-
serve privacy by either clearing cookies or entering pri-
vate browsing mode. These users may still be tracked
when service providers combine the host-tracking re-
sults from other identiﬁers (e.g., login IDs) with cookie
data.
4.3.4 Case 4: Users with Multiple Browsers
For the remaining users, we observe multiple cookies
co-existing (as in Section 4.3.3), though they are as-
sociated with different UA strings. Upon examining
these users more closely, we ﬁnd around 67% associated
with only two or three UAs. This observation suggests
that these cases correspond to single hosts with multiple
browsers or small home NATs. While it is more difﬁcult
to track hosts behind NATs, we note that the anonymity
sets tend to be too small in such cases to protect user
privacy.
A small fraction of these cases (3%) are associated
with a large number of UA strings, which suggests that
they are large proxies or NATs. Routing trafﬁc through
proxies thus provides better means for users who do not
wish to be tracked.
Summary We study the cookie-churn phenomenon
where privacy-aware users may clear cookies or switch
to private browsing. We show that by applying host-
tracking results with other identiﬁers, service providers
may still be able to identify a large fraction (88%) of the
“one-time”, churned new cookie IDs as corresponding
to users who return to the service.
5 Application: Host Mobility Study
In addition to switching between IP addresses within
the same network (for instance, because of DHCP), a
host may also travel across different IP ranges. This can
occur if the host is a mobile device, or when a virtual
private network (VPN) is used. Above, we track hosts
within each IP preﬁx range separately, though it is also
desirable to study clients that travel across domains, e.g.,
for trafﬁc engineering or network management. More
importantly, host mobility patterns can beneﬁt security
as well. We demonstrate this point by applying our host-
tracking results to detect abnormal and malicious activi-
ties.
To understand the mobile behavior of hosts at a large
scale, we make use of cookie IDs, since they are more
closely tied to speciﬁc devices than other identiﬁers we
studied in Section 3. We use the Search dataset for our
study. Among cookie IDs in this dataset, 7.9 million
appeared at more than one domain. While the major-
ity of these cross-domain activities are associated with
normal user travel patterns, there also exist unusual or
suspicious activities, for example, cookie forwarding of
the kind supported by CookieCooker [1].
In this section, we focus on detecting the following
two abnormal host mobility patterns:
• Some cookie IDs move quickly between multiple
domains, suggesting that they may not correspond
to hosts who travel physically.
In particular, we
study those cookies that may be associated with
anonymous routing, such as Tor routing [37].
• During an investigation into suspicious user email
trafﬁc that do not conform to the general host mo-
bility proﬁle, we uncover a stealthy type of mali-
cious cookie-forwarding activity.
In the following, we ﬁrst study patterns corresponding to
users traveling across domains in general. We then use
those patterns as baseline to identify abnormal activities.
5.1 Host Mobility Patterns
Our analysis yields a few key observations on general
host mobility patterns. First, as shown in Table 6, ASes
associated with cellular networks, i.e., Verizon Wire-
less and Carphone Warehouse Broadband Services, are
ranked among the top domains with the largest number
of traveling cookies. This fact reﬂects the proliferation
of smart phones with mobile Internet access. In total, we
ﬁnd around 20% of the cookies among the top 500 AS
pairs to be associated with cellular networks (Verizon
Wireless, AT&T Wireless, Vodafone, Sprint, etc.).
AS pair
AS 17557, 45595
AS 6167, 22394
AS 13285, 43234
AS 4134, 4837
AS 8228, 15557
# Cookies Afﬁliations
152871
Pakistan Telecom (PK)
70941 Verizon Wireless (US)
56600 Opal Telecom, Carphone
Warehouse Broadband (GB)
ChinaNet (CN)
52520
36812 Neuf Cegetel (FR)
Table 6. Top ﬁve AS pairs associated with
traveling cookies.
Second, we ﬁnd traveling hosts to exhibit strong geo-
graphic locality. 83% of the cookies move between net-
works within the same country, and this number is even
higher for the U.S. (95.44%). The strong geographic lo-
cality pattern can also be observed among cookies that
travel across countries. Figure 7 shows the topology of
international host travel, also drawn from the top 500
AS pairs. The node “EU” in the ﬁgure represents multi-
regional networks in the European Union, which are not
exclusively part of any European country. The size of
each node in the ﬁgure is proportional to the number
of cookies that originated from that country or region.
The edges indicate the direction of travel. The ﬁgure
shows that host mobility is largely bi-directional, and
is commonly localized within the same general region
(e.g., Europe).
BE
EU
GT
AE
HN
FR
PT NO