### EDB Postgres Replication Server User’s Guide

**Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved.**

#### 634
For single-master replication systems, as described in Sections 5.2.1 and 5.3.1, you need to update the port numbers stored in the control schema from the old port numbers to 9051 and 9052. Follow these steps:
1. Perform the procedure outlined in Section 7.6.1.2.
2. Then, perform the procedure detailed in Section 5.5.3.

After making these changes, click the "Refresh" button in the xDB Replication Console. The replication tree in the xDB Replication Console should now display the complete set of nodes for the replication systems.

#### 10.3 Resolving Problems
This section provides tips for locating and correcting various issues that may arise.

##### 10.3.1 Error Messages
The following table lists common error messages that can appear in the xDB Replication Console. These messages are organized alphabetically based on the first word after "a," "an," or "the."

When an error message is displayed, it may be followed by a specific reason, such as:
```
Authentication failed. Reason: Invalid user name/password.
```

The table includes only messages that typically involve initial configuration operations requiring additional information for resolution. Messages related to simpler operations are not listed here.

**Table 10-3: xDB Replication Server Error Messages and Resolutions**

| **Error Message** | **Resolution** |
|-------------------|----------------|
| **Authentication failed. Reason: Invalid user name/password.** | This occurs when registering a publication server or subscription server. Verify that the user name and password match the admin credentials in the xDB Replication Configuration file on the host running the publication or subscription server. See Section 2.3.1.3. |
| **Cannot register database because it is already registered by a publication service.** | Only one publication database definition can be created for any given database. (Oracle is an exception, where more than one publication database definition can be created for the same Oracle database if different Oracle user names are specified in each definition.) |
| **The connection could not be established with the server. Verify that the server is running and accepting connections. Reason: Connection refused to host: xxx.xxx.xx.xxx; nested exception is: java.net.ConnectException: Connection refused** | This occurs when a Java RMI connection cannot be made to the publication server, subscription server, or database server. Verify the correct host IP address and port number. Ensure the server is running (see Section 10.3.4.2). If the server is running on Linux, verify that the /etc/hosts file maps the host name to the correct network IP address, which should match the IP address returned by the `ifconfig` command and the IP address entered in the Host field of the dialog box. Alternatively, set the `java.rmi.server.hostname` configuration option to the IP address of the server (see Section 10.4.1.7). Do not use the loopback address 127.x.x.x. |
| **Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.** | This occurs when attempting to save a publication database definition. The publication server cannot connect to the database server. Verify the correct IP address and port for the database server. Ensure the database server is running and accessible from the host running the publication server. |
| **Could not connect to the database server. Reason: FATAL: number of requested standby connections exceeds max_wal_senders (currently n)** | This occurs when attempting a snapshot replication from a publication database configured with log-based synchronization (WAL-based logical replication) and the number of concurrent connections exceeds the `max_wal_senders` setting in the `postgresql.conf` file. Increase the value of `max_wal_senders` and restart the database server. See Section 2.2.10. |
| **Currently no publication exists on the publication server. Please create at least one publication on the server and then retry.** | This occurs when attempting to create a subscription without any publications on the specified publication server. Create at least one publication on the server. |
| **The database cannot be registered because a partial schema already exists. A manual cleanup is required to proceed. For help with manual cleanup, please check our product documentation.** | The metadata database objects from a prior publication already exist in the schema. Perform the operation described in Section 10.3.4.3. |
| **Database cannot be removed. Reason: Publication database connection cannot be removed as one or more publications are defined against it.** | Ensure all publications subordinate to the publication database definition have been removed. If the error persists, there may be a problem with the control schema objects. Perform the operation described in Section 10.3.4.3. |
| **Database cannot be removed. Reason: Publication service failed to clean up replication control schema tables.** | The control schema objects under the Oracle publication database user schema or under the Postgres or SQL Server schemas `_edb_replicator_pub`, `_edb_replicator_sub`, or `_edb_scheduler` cannot be deleted by the publication server. The control schema objects or schemas may have already been deleted. Use the procedure in Section 10.3.4.3. |
| **Database cannot be removed. Reason: The target publication database is currently set as the Controller database and is being referenced by one or more dependent nodes.** | Select another publication database to be used as the controller database. Use the "Set As Controller" option in the publication databases’ context menu to set this database as the controller. You can then remove the original publication database. See Section 7.7. |
| **Database cannot be set as controller. Reason: Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.** | Verify the correct IP address and port in the publication database definition. Ensure the database server is running and accessible from the host running the publication server. |
| **Database connection cannot be added. Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.** | This occurs when attempting to save a subscription database definition. The subscription server cannot connect to the database server. Verify the correct IP address and port for the database server. Ensure the database server is running and accessible from the host running the subscription server. |
| **Database connection cannot be added. FATAL: no pg_hba.conf entry for host "xxx.xxx.xx.xxx", user "user_name", database "db_name", SSL off** | Verify the database host IP address, port number, database user name, password, and database identifier. Ensure there is an entry in the `pg_hba.conf` file permitting access to the database by the given user name originating from the IP address where the subscription server is running. |
| **Database connection cannot be added. Controller database is not initialized yet.** | Verify that the xDB Replication Configuration file on the host running the subscription server contains an entry for a valid controller database. Ensure a publication database has been defined under the publication server as the controller database and its connection information is recorded in the xDB Replication Configuration file. See Section 2.3.1.3. |
| **The database type for the selected database is different than that of the MDN database. Each database should be of the same type in a MMR cluster.** | All database servers in a multi-master replication system must be of the same type. This error message is displayed when attempting to add a master node and the database server type differs from the database server type of the master definition node. See Section 10.1.3.3. |
| **An error occurred while removing tables from other Master node(s). Please refer to the user manual for instructions on how to remove shadow tables and triggers from Master node(s).** | When a master node of a multi-master replication system is deleted, the control schema objects that were created in the master node are also dropped. These include schemas `_edb_replicator_pub`, `_edb_replicator_sub`, and `_edb_scheduler`. For the log-based method of synchronization replication, there are shadow tables and triggers on the publication tables as well. If any of these control schema objects fail to be dropped, this error message is displayed. See Section 10.3.4.3 for directions on how to remove these control schema objects. |
| **FATAL: no pg_hba.conf entry for host "xxx.xxx.xx.xxx", user "user_name", database "db_name", SSL off** | Verify the database host IP address, port number, database user name, password, and database identifier. Ensure there is an entry in the `pg_hba.conf` file permitting access to the database by the given user name originating from the IP address where the publication server is running. |
| **Filter cannot be defined for Binary data type column(s) e.g. BYTEA, BLOB, RAW.** | Filter rules are not permitted on columns with binary data types in a publication table. See Section 2.2.12.3. |
| **Filter with same name/clause already exists on table/view: schema.table_name** | When adding a filter rule on a publication table, the same filter name or the same filter clause (WHERE clause) cannot be used more than once on a given table. Modify the duplicate filter name or filter clause so it is unique for the table. |
| **The initial snapshot is not performed for this subscription. Please take the snapshot first and then proceed with the synchronize operation.** | A snapshot replication must be performed before the first synchronization replication. Perform an on-demand snapshot replication. |
| **It is recommended to use a network IP address, the loopback address may result in connectivity issues.** | This warning is given when localhost or 127.0.0.1 is specified as the host address of a replication system component. It is strongly recommended that all replication system components are identified by their specific IP address on the network. |
| **The log triggers creation failed for one or more publication tables. Make sure the database is in a valid state and the user is granted the required privileges.** | Either the user does not have the trigger creation privilege or there is a database server problem. The database server message is displayed as part of the error. |
| **The MMR mode is currently not supported for database_type database.** | A database server of type `database_type` cannot be used in a multi-master replication system. Only Advanced Server or PostgreSQL database servers may be used as master nodes in a multi-master replication system. |
| **Multiple filters of the same table are not allowed.** | When creating a subscription in a single-master replication system or creating a master node other than the master definition node in a multi-master replication system, only one filter may be selected for a given table. Uncheck the additional boxes in the Apply column under the Filter Rules tab if more than one box is selected. |
| **No JDBC Client driver is configured for the Oracle data source.** | Copy the Oracle JDBC driver file `ojdbcx.jar` to the `lib/jdbc` subdirectory of where the publication server or subscription server is installed on the host running the publication server or subscription server. Restart the publication server or subscription server. |
| **No Publication found on MDN node, additional Master node cannot join MMR cluster.** | This occurs when attempting to add a second master node to a multi-master replication system, but no publication has been defined under the master definition node. Create a publication under the master definition node, then add the additional master nodes. See Section 6.2.3. |
| **None of the target master/subscription databases is accessible, hence the replication process failed to complete.** | Synchronization replication failed due to the unavailability of a target database. See the publication server log file for details. See Section 10.3.2. |
| **One or more master database node(s) are defined against this publication. Removing the publication will invalidate the MDN.** | Master nodes are still defined in a multi-master replication system in which an attempt is being made to delete the publication from the master definition node. All master nodes (other than the master definition node) must be deleted first before deleting the publication from the master definition node. Perform this deletion process with the xDB Replication Console or xDB Replication Server CLI. |
| **One or more subscriptions are defined against this publication. Removing the publication will invalidate the subscription. Do you want to continue?** | Warning issued when you attempt to remove a publication with subscriptions associated with it. You can remove the publication, but the subscriptions are no longer usable and should be removed as well. |
| **Multiple Publications creation is currently not supported.** | Only one publication is supported in a multi-master replication system and only one such multi-master replication system can exist for an xDB Replication Server installation. |
| **Only subscription which has subscribed against a publication with transactional replication type, can be synchronized.** | You cannot perform synchronization replication on a snapshot-only publication. Perform snapshot replication instead. |
| **The Oracle/MS SQL Server cannot be registered if the active Controller database is a non-PG/PPAS database.** | This occurs when creating an Oracle or SQL Server publication database definition and the current controller database is not a Postgres database. In order to create an Oracle or SQL Server publication database, create and designate a Postgres publication database as the controller database. See Section 7.7. |
| **Parent table table_name is not selected when its child tables are part of the publication list.** | Table selected for a publication has a foreign key referencing a parent table that has not been chosen for the publication. This is only a warning that the parent table will not be part of the subscription. |
| **Problem occurred in publish process. Reason: Connection refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.** | This occurs when attempting synchronization replication and the controller database is not accessible by the publication server. Verify the correct IP address and port in the publication database definition of the controller database. Ensure the database server is running and accessible from the host running the publication server. |
| **Problem occurred in publish process. Reason: ERROR: permission denied for schema _edb_replicator_pub** | For a Postgres publication, verify that the publication database user has `CREATE ON DATABASE` privilege on the publication database, or the database user is a superuser. |
| **Publication cannot be created. One or more tables have no attributes defined and cannot be published. Unselect the specific tables and retry.** | In Postgres, it is possible to create a table with no columns. A publication is not allowed to include a Postgres table with no columns since the corresponding subscription table cannot be created in Oracle. |
| **Publication cannot be created. Publication publication_name already exists on the publisher server. Please choose a different name and then proceed.** | Publication names must be unique within a publication server. Enter a different publication name. |
| **Publication cannot be created. Table schema.table_name replica identity is set to replica_identity_setting. To define a Filter, the table replica identity should be set to FULL.** | This occurs when a table filter is attempted to be defined on a publication table used in a log-based replication system. Use the `ALTER TABLE` statement to change `REPLICA IDENTITY` to `FULL`. See Section 2.2.12.3. |
| **Publication cannot be created. Table table_name does not contain a primary key. Transactional replication is not supported for a non-pk table.** | All tables used for synchronization replication must have primary keys. Create a primary key on the table or add the table to a snapshot-only publication. |
| **Publication cannot be created. The publication creation process timed out as one or more tables may be locked by another session. Please retry later.** | For a Postgres publication that is not for snapshot-only, the publication database user must be able to create triggers on the publication tables. The publication database user must have the privilege to execute the `ALTER TABLE` statement on the publication tables and the `CREATE` and `USAGE` privileges on the schema containing the publication tables. Verify that one of the following is true: 1) All the tables in the publication are owned by the publication database user and the user has `CREATE` and `USAGE` privileges on the publication tables’ schemas, or 2) the publication database user is a superuser. |
| **Publication cannot be removed. Reason: Publication publication_name cannot be removed. Reason: Error: cannot drop table _edb_replicator_pub.rrst_schema_table_name because other objects depend on it.** | PL/pgSQL custom conflict handler functions may exist in the master definition node that are dependent upon the publication’s shadow tables. Drop the custom conflict handler functions before deleting the publication. |
| **Publication cannot be updated. Reason: The parent table schema.table_name is selected for removal while it has one or more child tables in the publication list. Make sure that parent-child dependency holds in the publication tables.** | Choose the child tables for removal as well as the parent table. |
| **Publication defined in MMR cluster cannot be subscribed in SMR cluster.** | A given publication cannot be used in both a multi-master replication system and a single-master replication system. |
| **Publication does not exist on the publication server. It might have been removed.** | The publication does not exist for a given subscription. The subscription is no longer usable and must be removed. |
| **Publication having subscription against it, cannot be updated by removing tables from it.** | Remove the subscription, remove tables from the publication, then add the subscription. |
| **The publication schema cannot be created. Reason: ERROR: Permission denied for database db_name.** | This occurs when attempting to create the publication database definition and the specified publication database user does not have the privilege to create a schema in the database. Grant the `CREATE` privilege on the database to the publication database user. |
| **Publication Service connection failure.** | Verify that the publication server is running. See Section 10.3.4.2. Ensure the database server hosting the controller database specified in the xDB Replication Configuration file is running and the publication server is connected to it. See Section 2.3.1.3. |
| **The replication process could not be completed due to a database failure. Check the database state and retry.** | This may be caused by characters in the publication data that are illegal for the character set of the subscription database. Check the snapshot replication failure log file or the database server log file. See Section 10.4.1.2. |
| **Replication server does not support Oracle to Oracle replication.** | See Section 10.1.3 for supported database server configurations. Use Oracle products for Oracle to Oracle replication. |
| **A replication slot is not available on the target database server. Please configure the max_replication_slots GUC on the database server.** | This occurs when attempting to add a publication database definition with the log-based method of synchronization replication, and the `max_replication_slots` configuration parameter in the `postgresql.conf` file is not set to a large enough value to accommodate the additional database. Increase the value of the `max_replication_slots` parameter and restart the database server. See Section 2.2.10 for additional information. |
| **Subscription subscription_name already exists on the subscriber server. Please choose a different name and then proceed.** | Subscription names must be unique within a subscription server. Enter a different subscription name. |

**Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved.**

**EDB Postgres Replication Server User’s Guide**

**639-640**