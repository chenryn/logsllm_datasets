[tips](https://www.peerlyst.com/tags/tips) to defend against Linux
attacks
## References and Further Reading:
-   Advanced Infrastructure [Penetration
    Testing](https://www.peerlyst.com/tags/penetration-testing) - Packt
    Publishing : Chiheb chebbi
-   Linux Users and Groups :
> [[https://www.linode.com/docs/tools-reference/linux-users-and-groups/]{.underline}](https://www.linode.com/docs/tools-reference/linux-users-and-groups/)
-   Schedule Tasks on Linux Using Crontab
    [[https://kvz.io/blog/2007/07/29/schedule-tasks-on-linux-using-crontab/]{.underline}](https://kvz.io/blog/2007/07/29/schedule-tasks-on-linux-using-crontab/)
-   LinEnum
    [[https://github.com/rebootuser/LinEnum]{.underline}](https://github.com/rebootuser/LinEnum)
> Chapter 14
>
> **ATTACKING ICS/SCADA**
>
> Contributor: MIKE ART REBULTAN
>
> **INTRODUCTION**
Just like any other organization, ICS/SCADA is not
[free](https://www.peerlyst.com/tags/free) from
[cybersecurity](https://www.peerlyst.com/tags/cybersecurity) attacks. In
fact, this is the most dangerous among other compared to others. It does
not just damage the organization\'s
[reputation](https://www.peerlyst.com/tags/reputation) or implicates
[financial](https://www.peerlyst.com/tags/financial) impact but lives --
Cyber Kinetic. This attack concerns the lives of any living things like
plants, Animals, and human.
This article will tackle [security
attacks](https://www.peerlyst.com/tags/security-attacks) on general
ICS/SCADA environment -- [power
grid](https://www.peerlyst.com/tags/power-grid), waste and water
[management](https://www.peerlyst.com/tags/management), petrochemical,
[data center](https://www.peerlyst.com/tags/data-center),
[nuclear](https://www.peerlyst.com/tags/nuclear) power plants, and
[transportation](https://www.peerlyst.com/tags/transportation)
[systems](https://www.peerlyst.com/tags/systems) (*air, maritime and
railway*) and will focus on the most neglected attack surfaces; physical
and system (*OS and firmware*).
## ATTACKING PHYSICAL SECURITY
[Social engineering](https://www.peerlyst.com/tags/social-engineering)
has never been changed since day one.
[Impersonation](https://www.peerlyst.com/tags/impersonation) is still
one of the most common ways that adversaries can get through and inside
the facilities and execute their
[malicious](https://www.peerlyst.com/tags/malicious) motives. Pretending
to be someone will always be their way; [IT
guy](https://www.peerlyst.com/tags/it-guy), janitor, delivery man,
inspector, [business
partner](https://www.peerlyst.com/tags/business-partner),
[vendor](https://www.peerlyst.com/tags/vendor), client, or simply by
just [tailgating](https://www.peerlyst.com/tags/tailgating) with the
legit employee while entering the premises. Sounds like a "Mission
Impossible" movie, yes it is!
The most epic story in the ICS/OT is the insider threat. This is where
the vendor plug-in their [USB](https://www.peerlyst.com/tags/usb) drive
loaded with [payload](https://www.peerlyst.com/tags/payload) or
[Malware](https://www.peerlyst.com/tags/malware)
[infections](https://www.peerlyst.com/tags/infections) without the
control [engineering](https://www.peerlyst.com/tags/engineering) guy
[scanning](https://www.peerlyst.com/tags/scanning) it before connecting
to the HMI or [workstation](https://www.peerlyst.com/tags/workstation)
inside the ICS. This always happened even with the presence of the
[company policy](https://www.peerlyst.com/tags/company-policy)
especially when the vendor and the employee already had built their
relationship as point-of-contact inside the organization.
So even "air-gapped" [devices](https://www.peerlyst.com/tags/devices)
are not exempted on this [attack](https://www.peerlyst.com/tags/attack)
when the [adversary](https://www.peerlyst.com/tags/adversary) is already
inside [ICS](https://www.peerlyst.com/tags/ics) and just waiting for the
perfect timing to accomplish their mission without anyone noticing the
action until an accident occurs.
## Signaling Communication Devices
When was the last time you visited an
[e-commerce](https://www.peerlyst.com/tags/e-commerce) site and checked
the price of a [gps jamming](https://www.peerlyst.com/tags/gps-jamming)
device? It is not that expensive. This device can also be used for
spoofing. What do you think an autopilot plane or maritime and others
use for navigation?
## Communication Channel
[GSM](https://www.peerlyst.com/tags/gsm) or
[LTE](https://www.peerlyst.com/tags/lte)
[spoofing](https://www.peerlyst.com/tags/spoofing) the circle line
tunnel interferes with the signaling communication between the train and
the track. The same happens with the
[aircraft](https://www.peerlyst.com/tags/aircraft) between the
[tower](https://www.peerlyst.com/tags/tower) controller and the others.
## Wi-Fi
This is the same with the communication channel where it can be
[spoofed](https://www.peerlyst.com/tags/spoofed), hijacked, or jammed to
interfere with the signaling communication. Wardriving is very popular
with [wi-fi](https://www.peerlyst.com/tags/wi-fi)
[hacking](https://www.peerlyst.com/tags/hacking) using so many [open
source](https://www.peerlyst.com/tags/open-source) tools.
## CCTV
Changing the direction of the camera within the premises using an FM
[radio](https://www.peerlyst.com/tags/radio) jammer combined with
Samurai [Linux distro](https://www.peerlyst.com/tags/linux-distro) would
accomplish an adversaries easy way in to manipulate
[operations](https://www.peerlyst.com/tags/operations) through the HMI,
[RTU](https://www.peerlyst.com/tags/rtu), or MTU and do damage on the
ICS/SCADA.
## ![](media/image165.jpeg)ATTACKING LOGICAL SECURITY
In the current generation of the ICS/OT (*4th Gen*), air-gap has been
evolved into a connected network and even accessible from the
[Internet](https://www.peerlyst.com/tags/internet) to make the life of
the [administrators](https://www.peerlyst.com/tags/administrators)
easier. This also made the life of the
[hackers](https://www.peerlyst.com/tags/hackers) simpler in attacking
their target.
### Reconnaissance
In the [cyber kill
chain](https://www.peerlyst.com/tags/cyber-kill-chain) either using
either [Mandiant](https://www.peerlyst.com/tags/mandiant) or
[Lockheed](https://www.peerlyst.com/tags/lockheed) Martin's model, this
is the very first stage where an adversary plans the attack. For
ICS/SCADA, using [Shodan](https://www.peerlyst.com/tags/shodan) and
[Google](https://www.peerlyst.com/tags/google-dorking)
[Dorking](https://www.peerlyst.com/tags/google-dorking) are the most
common [methodologies](https://www.peerlyst.com/tags/methodologies) to
find their target.
Searching for a random [victim](https://www.peerlyst.com/tags/victim) is
not that complicated as much as the
[hacker](https://www.peerlyst.com/tags/hacker) knows the
[CIP](https://www.peerlyst.com/tags/cip) and
[ports](https://www.peerlyst.com/tags/ports) where the
[services](https://www.peerlyst.com/tags/services) are running from
different vendors.
1.  **SHODAN** -- these are the most common search filters that can be
    used to find a target from Shodan portal.
    -   [Modbus](https://www.peerlyst.com/tags/modbus) - this is the
        most commonly used ICS/SCADA protocol with fewer security
        [features](https://www.peerlyst.com/tags/features) like the
        absence of
        [authentication](https://www.peerlyst.com/tags/authentication)
        and also no
        [encryption](https://www.peerlyst.com/tags/encryption) during
        message transmission across the network.
    -   [Port](https://www.peerlyst.com/tags/port-27018):502 - the port
        number used by Modbus protocol.
    -   BACnet - this is the protocol used for the Building Automation
        System (*BAS*[) for HVAC](https://www.peerlyst.com/tags/hvac)
        application.
    -   Port:10 or Port:530 - the port that BACnet protocol used.
    -   S7 (*by Siemens*) - this is the
        [service](https://www.peerlyst.com/tags/service) that Siemens
        devices are most commonly using.
    -   Port:502 Country:XX (*where XX are the country code*) - a
        combination of search filters in Shodan to locate both port and
        country at the same time.
    -   Net:1.2.3.0/8 - search filter to identify network segment range.
    -   ClearSCADA - this is the application used by Schneider Electric
        on their devices.
    -   ![](media/image166.jpeg)[Domain](https://www.peerlyst.com/tags/domain):xyz.com -
        to specify a targeted domain, this filter can be used with
        Shodan search.
2.  **DORK** -- [Google](https://www.peerlyst.com/tags/google-2)
    > searching with ICS/SCADA target is the same with the IT.
    -   intitle:\"Miniweb Start Page\" - this is an HMI panel for
        Simatic [web](https://www.peerlyst.com/tags/web) interface.
    -   inurl:\"Portal/Portal.mwsl\" - Siemens S7 series of
        [PLC](https://www.peerlyst.com/tags/plc) controllers.
    -   inurl:\"ProficyPortal/default.asp\" - General Electric device
        web [portal](https://www.peerlyst.com/tags/portal)
    -   ![](media/image167.jpeg)intitle:"ClearSCADA Home" - Schneider
        Electric device web portal
3.  **MALTEGO CE** -- this
    [community](https://www.peerlyst.com/tags/community) edition of
    [Maltego](https://www.peerlyst.com/tags/maltego) can be a good
    [tool](https://www.peerlyst.com/tags/tool) for
    [automated](https://www.peerlyst.com/tags/automated) tasks on both
    Shodan and Google searches. This is readily available in
    [Kali](https://www.peerlyst.com/tags/kali) and other security
    [Linux](https://www.peerlyst.com/tags/linux) distros.
![](media/image168.jpeg)This stage is crucial for the adversaries as
they [leverage](https://www.peerlyst.com/tags/leverage) the effort in
looking for
[vulnerabilities](https://www.peerlyst.com/tags/vulnerabilities),
appliance types, [firmware](https://www.peerlyst.com/tags/firmware)
version, and apps configurations they found from Shodan, which they can
use for a [watering hole
attack](https://www.peerlyst.com/tags/watering-hole-attack) in a later
stage or in parallel with a [Spear
Phishing](https://www.peerlyst.com/tags/spear-phishing) attack.
### Phishing or Spear Phishing
After finding a target company from the
[reconnaissance](https://www.peerlyst.com/tags/reconnaissance) stage,
[Phishing](https://www.peerlyst.com/tags/phishing) is the most common
and yet effective [strategy](https://www.peerlyst.com/tags/strategy) to
[compromise](https://www.peerlyst.com/tags/compromise) a potential
privileged [AD](https://www.peerlyst.com/tags/ad) account and perform [a
lateral](https://www.peerlyst.com/tags/lateral-movement)
[movement](https://www.peerlyst.com/tags/lateral-movement) from the IT
[network](https://www.peerlyst.com/tags/network) to the OT environment.
This happens when there is no
[network](https://www.peerlyst.com/tags/network-segmentation)
[segmentation](https://www.peerlyst.com/tags/network-segmentation)
between them.
## ![](media/image169.jpeg)Summary
While there is another [attack
surface](https://www.peerlyst.com/tags/attack-surface) that an adversary
can utilize to attack the ICS/SCADA environment, methodologies mentioned
here are the easiest amongst them.
To [mitigate](https://www.peerlyst.com/tags/mitigate) the
[risk](https://www.peerlyst.com/tags/risk) of these
[attacks](https://www.peerlyst.com/tags/attacks) and to implement
[defense-in-depth](https://www.peerlyst.com/tags/defense-in-depth-1),
this has been shared in author\'s recorded talk during the [HITB-GSEC
Singapore 2018](https://www.youtube.com/watch?v=2EoA13t2e7E).
### ABBREVIATIONS
[CCTV](https://www.peerlyst.com/tags/cctv): Closed-Circuit Television
HMI: [Human](https://www.peerlyst.com/tags/human-1) Machine
[Interface](https://www.peerlyst.com/tags/interface)
HVAC: Heating, Ventilating, and Air Conditioning Control ICS:
[Industrial Control](https://www.peerlyst.com/tags/industrial-control)
System
IT: [Information
Technology](https://www.peerlyst.com/tags/information-technology) MTU:
Master Terminal Unit
RTU: Remote Terminal Unit
[SCADA](https://www.peerlyst.com/tags/scada): [Supervisory Control and
Data
Acquisition](https://www.peerlyst.com/tags/supervisory-control-and-data-acquisition)
OT: Operational Technology
[WIFI](https://www.peerlyst.com/tags/wifi): IEEE 802.11x
## References and Further Reading
-   [Attacking MODBUS Protocol](https://github.com/enddo/smod)
-   [ICS Computer Emergency Response Team - Daily
    News](https://ics-cert.us-cert.gov/)
-   [ICS-CERT\'s Top 20 Cybersecurity Attack Against
    ICS](https://ics-cert.us-cert.gov/sites/default/files/ICSJWG-Archive/QNL_DEC_17/Waterfall_top-20-attacks-article-d2%20-%20Article_S508NC.pdf)
-   [Cyber Kill
    Chain](https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html)
-   [Google Dork
    Database](https://www.exploit-db.com/google-hacking-database/)
-   [Shodan Search
    Guide](https://help.shodan.io/the-basics/search-query-fundamentals)
-   [Maltego Community
    Edition](https://www.paterva.com/web7/buy/maltego-clients/maltego-ce.php)
-   [Samurai Linux
    Framework](https://sourceforge.net/projects/samurai/files/)
-   [Brutal Tool for Phishing](https://github.com/Screetsec/Brutal)
> Chapter 15
>
> **Privilege Escalation**
>
> Contributor: Haythem Arfaoui
>
> **Introduction**
No matter how hard security experts try to keep hackers out of their
network they always seem to find a way to steal its data. One of the
used techniques is known as Privilege Escalation. A successful Privilege
Escalation attack grant hackers privileges that end users don't normally
have. Attackers move up the privilege ladder by granting themselves
permissions usually reserved for senior level administrators.
In most Privilege Escalation attacks the hacker first logs in with a
normal end-user account then searches for flaws in the system that they
can be exploited to elevate their privileges in order to gain access to
sensitive data they can steal. The consequences of Privilege Escalation
can be extreme from loss of these pieces of information to create
backdoors or introduce undesirable programs such as malware for future
actions and long lasting damage to the organization's reputation.
There are two categories of Privilege Escalation techniques:
-   **Horizontal Privilege Escalation** occurs when the attacker, having
    gained access to a normal low access level account, seeks to gain
    access to other similar low-level access accounts.
-   **Vertical Privilege Escalation** occurs when the attacker attempts
    to access resources and functions that belong to a user with higher
    privileges, such as application or site administrators.
In this section, we are going to talk in detail about the security
issues that could prompt an effective Privilege Escalation attack on
both Linux and Windows OS. We are going also to discuss how an attacker
can use the known techniques to successfully elevate his privileges.
## Privilege escalation Techniques
I.  **LINUX Privilege Escalation**
These are the most common techniques in Linux environment for Privilege
Escalation:
-   Kernel exploits
-   Programs running as root
-   Installed software
-   Weak/reused/plaintext passwords
-   Inside service
-   Suid misconfiguration
-   Abusing sudo-rights
-   World writable scripts invoked by root
-   Bad path configuration
-   Cronjobs
-   Unmounted filesystems
## Kernel Exploits
> [**Dirty Cow Exploit**](https://dirtycow.ninja/)
This exploit, initially obtained through an HTTP packet capture,
leverages a race condition vulnerability to force the Linux kernel to
write arbitrary data to restricted system files.
The race condition vulnerability exists because of a flaw in the way the
"Linux kernel's memory subsystem handles the copy-on-write (COW)
function of private readonly memory mappings" (Oester, 2016).
Because of the security implications, the Dirty COW exploit was declared
"the most serious Linux local privilege escalation exploit ever\" by Dan
Rosenberg, a senior researcher at Azimuth
Security (Goodin, 2016). Rosenberg's assessment stems from the fact that
the Dirty COW vulnerability exists in virtually every distribution of