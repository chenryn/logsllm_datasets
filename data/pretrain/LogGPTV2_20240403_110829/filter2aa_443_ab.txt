 A Strict Signature Matching based Tool
– Would search for a 100% match between the received
results and a tool’s signature database
– If a 100% match is not found, than there are no results
– Extremely sensitive to environmental affects on the probed
target, and on the network which the probed target resides
on
35
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Way Probe Results Are Being
Matched
 Statistical based algorithms (the best match)
– Using statistical based algorithms a tool is able to provide
with better resistance against environmental affects which
might take their toll on a target system and on probe packets
– Some fingerprinting tests may have bigger impact over the
overall accuracy of the test results compared with other
tests used. Their failure may or may not harm with the
ability to provide with granular results (i.e. not grouped)
– Remark: Xprobe2 was the first open source tool to
implement a statistical analysis based mathematical
algorithm (‘fuzzy logic’) to provide with a best effort match
between probe results to a signature database
36
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Use of a Fixed Number of
Fingerprinting Tests
 A fixed number of fingerprinting tests are used
 A fixed number of parameters are examined
 In theory:
Possible matches = the number of tests X number of
parameters examines X parameter’s permutations
 Although the overall number of possible matches is
currently much higher than the number of the current
available network elements, certain test classes
cannot deliver the expected results and to provide
with a clear distinction between different OSs
37
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Use of a Fixed Number of
Fingerprinting Tests
A better tool for active OS fingerprinting would be required to
utilize fingerprinting tests, which would examine many
parameter values with a probe’s reply
These parameter values would need to be different among
many TCP/IP stack implementations
Therefore a number of those tests are needed in order to
achieve a broader distinction between different TCP/IP stack
implementations
It suggests that the usage of more parameter rich fingerprinting
tests with an active operating fingerprinting tool will provide
better overall results
An active operating system fingerprinting tool must, therefore,
reserve the ability to be able to support new fingerprinting
methods as they are published
38
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Some Fingerprinting Tests May Have
Bigger Impact on the Overall Results
 Some fingerprinting tests have bigger impact over
the overall accuracy of the test results compared
with other tests used
 If these tests fail, for some reason, the quality of the
produced results will be significantly lowered
39
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
No Changes Are Made To the TCP/IP Stacks Of
New Versions Of Operating Systems
 The behavior of the TCP/IP stack of newly released
operating systems hardly changes compared to an
older version of the same operating system, or
 Changes made to a newly released operating
system’s TCP/IP stack might affect a certain protocol
behavior only
 The result? Inability of some active operating system
fingerprinting tools which rely on a certain
fingerprinting niche to distinguish between different
versions of the same operating system or even
between a class of the same operating system family
40
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Inability to Determine the Exact
Windows OS Service Pack
 Traditional active operating system fingerprinting
tools are usually unable to identify the installation of
software service packs on a targeted machine
 For example, traditional active operating system
fingerprinting tools will identify a targeted machine
runs Microsoft Windows 2000, but will not be able to
determine which OS service pack version is installed
(if any at all)
41
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Inability to Identify the Underlying
Architecture Platform
 Usually, active operating system fingerprinting tools
will identify the operating system of a network node,
but not its underlying platform
 The knowledge about the underlying platform is
important for tools performing vulnerability
assessment, network inventory, etc., which rely on
the results of the active operating system
fingerprinting tool (i.e. nessus)
42
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Inability to Scale
 An active operating system fingerprinting tool should
have the ability to scan large networks
 Must not use many packets to do so
 For any router and switch there is an upper limit to
the number of packets per second it can process
 Beyond that limit, some packets will be dropped, but
more important, the router/switch might suffer from a
denial of service condition
 Therefore it is very important to balance the scan
rate with the network and network elements abilities
43
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Inability to Control the Fingerprinting
Modules to Be Executed
 When scanning different machines on different
topologies some tests would be proved useless
 Controlling which tests to use would result with
better accuracy and less chance of being detected
 One needs to control the fingerprinting tests a
certain tool has to offer according to her/his needs
 Furthermore, we would like an active OS
fingerprinting tool to be able to detect certain
scanning conditions and to react, by switching
scanning tactics
44
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Weaknesses
Summary
45
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Weaknesses - Summary
 The OS fingerprinting methods a certain remote
active OS fingerprinting tool uses requires that the
scanning conditions would meet several conditions
in order to produce with a successful identification of
the underlying operating system of a remote machine
 Some of those conditions cannot be met under
several scanning terrains
 One good example would be a web server behind a
well fortified firewall
46
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Weaknesses - Summary
 Since some of the OS fingerprinting tests a remote
active OS fingerprinting tool would use may fail, the
accuracy of the tool will be degraded when optimal
scanning conditions would not be met
 If the OS fingerprinting tests which would fail, would
be those with the bigger impact on the accuracy of
the tool’s result, the result the tool would produce
would be poor at best
47
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Weaknesses - Summary
 The currently used TCP/IP-based OS fingerprinting
test are not granular enough with their results (i.e.
Microsoft Windows based OSs)
48
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Other approaches and their
limitations
49
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Other approaches and their
limitations
 Some researchers suggested to use a certain OS
fingerprinting niche to fingerprint the underlying
operating systems of remote machines in light of
Internet conditions
 The suggested tests would use an opened TCP port,
and only would examine the TCP stack
implementation of the remote machine
 Some of those tests requires specific data to be
exchanged between the scanning system to its
target element, and a great number of packets to be
exchanged
50
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Other approaches and their
limitations
 The main problem of this approach is that this
approach is ok to use when you wish to identify
families of operating systems and not an exact
operating system version
 Another issue with this approach is that some other
tests, which are currently available with open source
remote active OS fingerprinting tools, produces the
same quality of results when run against an opened
TCP port with a single packet…
51
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Needed Solution
52
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Needed Solution
 Intelligence in scanning must be introduced
 Understanding of the terrain a tool operates in is
crucial
 An active OS fingerprinting tool must understand the
quality of the results received
 More tests needs to be evaluated in order to find
more OS fingerprinting tests which will have
significance in the OS fingerprinting process
53
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Needed Solution
 An integration between Stack-based OS
fingerprinting tests and application layer based
fingerprinting tests tailored towards the services
found opened on a targeted system(s) and/or a
service commonly found with the operating system
family in question, must be created
54
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Needed Solution
55
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Xprobe2
56
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The Xprobe2 Project
 An open source remote active OS fingerprinting tool,
which presents an alternative to other remote active
OS fingerprinting tools
 Developers
– Fyodor Yarochkin
– Ofir Arkin
– Meder Kydyraliev
 The project represents our take, beliefs and ideas,
and we hope it contributes to the community at large
 Voted one of the top 75 security tools (at the top 50)
57
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Xprobe2 - Project History
58
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Xprobe2
The OS Fingerprinting Modules
59
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The OS Fingerprinting Modules
60
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
The OS Fingerprinting Modules
 What is usually needed?
– Opened TCP port
– Closed TCP port
– Closed UDP port
– ICMP echo reply
– ICMP timestamp reply
– Address Mask reply
61
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Introducing
Xprobe2 v0.3
62
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Featured added to Xprobe2 v0.3
 Application-based OS fingerprinting modules
– SMB
– SNMP
 New signatures
– Mac OS X 10.2.x, 10.3.x, 10.4.x
– Linux Kernels 2.4.29, 2.4.30, 2.6.11, 2.6.12
– FreeBSD 4.11, 5.4
– OpenBSD 3.7
 Bug fixes
 Available for download from:
http://www.sys-security.com
63
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Xprobe2
v0.3 Demo
64
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Xprobe2 v0.3 Demo
65
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Remote Active OS Fingerprinting
Future Directions
66
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Future Directions
 Automating the active OS fingerprinting scan to
understand the terrain
 Switch scanning tactics according to the terrain
 Evaluate the quality of the results received
 Determine if the results received are good enough to
be presented
 Present results
67
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Questions?
68
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Resources
 Ofir Arkin’s Web Site:
http://www.sys-security.com
 Arkin Ofir, “ICMP Usage in Scanning” version 3.0,
June 2001
 Arkin Ofir & Fyodor Yarochkin, “X – Remote ICMP
based OS fingerprinting Techniques”, August 2001.
 Arkin Ofir & Fyodor Yarochkin, “ICMP based remote
OS TCP/IP stack fingerprinting techniques”, Phrack
Magazine, Volume 11, Issue 57, File 7 of 12,
Published August 11, 2001.
69
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Resources
 Arkin Ofir & Fyodor Yarochkin, “Xprobe2 - A ‘Fuzzy’
Approach to Remote Active Operating System
Fingerprinting”, August 2002.
 Arkin Ofir, Fyodor Yarochkin, Meder Kydyraliev, “The
Present & Future of Xprobe2 – Next Generation
Active Operating System Fingerprinting ”, July 2003.
70
    © Ofir Arkin, 2000-2005
Ofir Arkin, On the Current State of Remote Active OS Fingerprinting Tools
Thanks!