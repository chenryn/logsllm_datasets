title:Conditioned-safe Ceremonies and a User Study of an Application to
Web Authentication
author:Chris Karlof and
J. Doug Tygar and
David A. Wagner
Conditioned-safe Ceremonies and a User Study of an Application to Web
Authentication
Chris Karlof
J.D. Tygar
David Wagner
{ckarlof, tygar, daw}@cs.berkeley.edu
University of California, Berkeley
Abstract
We introduce the notion of a conditioned-safe ceremony.
A “ceremony” is similar to the conventional notion of a pro-
tocol, except that a ceremony explicitly includes human par-
ticipants. Our formulation of a conditioned-safe ceremony
draws on several ideas and lessons learned from the human
factors and human reliability community: forcing functions,
defense in depth, and the use of human tendencies, such as
rule-based decision making. We propose design principles
for building conditioned-safe ceremonies and apply these
principles to develop a registration ceremony for machine
authentication based on email. We evaluated our email reg-
istration ceremony with a user study of 200 participants. We
designed our study to be as ecologically valid as possible:
we employed deception, did not use a laboratory environ-
ment, and attempted to create an experience of risk. We
simulated attacks against the users and found that email
registration was signiﬁcantly more secure than challenge
question based registration. We also found evidence that
conditioning helped email registration users resist attacks,
but contributed towards making challenge question users
more vulnerable.
1 Introduction
We live in a complicated environment, and like many an-
imals, we tend to develop automatic responses to situations
we encounter more than once. Our brains tend to classify
stimuli according to a few key features, and if one or more
features match stimuli we have encountered in the past, we
often respond mindlessly with the action that we learned
was most appropriate. Psychologist Robert Cialdini calls
these click-whirr responses [9]. Cialdini compares these
automatic responses to pre-recorded tapes in our head, and
uses “click-whirr” to evoke the sound a tape machine makes
after pressing “play”. As the world becomes more intricate
and variable, we increasingly rely on click-whirr responses.
Without click-whirr responses, we would spend most of our
time appraising and analyzing mundane situations in our
daily lives. Philosopher Alfred North Whitehead recog-
nized this when he asserted “civilization advances by the
extending the number of operations we can perform with-
out thinking about them [55].”
As we become more dependent on click-whirr responses
to navigate our daily lives, some have learned to exploit this
behavior. Salesman, fund raisers, and con men can create
situations containing the stimuli necessary to trigger the de-
sired click-whirr response, even though less visible features
may differ substantially from past situations. For example,
people tend to obey a person in a uniform, regardless of
whether that person has any real authority.
The designers of many current Web authentication mech-
anisms, such as passwords, have all but ignored this funda-
mental psychological phenomenon. Social engineering at-
tacks on the Internet, such as phishing, have largely been
successful because the Web is fertile ground for mimicry,
and password authentication can condition users to fall for
these attacks. Many users have developed a click-whirr re-
sponse to login forms and will automatically enter their lo-
gin credentials on any Web page that mimics a trusted site
and on the surface, appears legitimate.
In response to these social engineering threats, many in-
stitutions use machine authentication, which authenticates
a user’s computer, in addition to password authentication,
which authenticates the user herself. Since a user may use
more than one computer, machine authentication systems
must have a registration procedure to authorize and set au-
thentication cookies on multiple machines. Many machine
authentication systems currently deployed by ﬁnancial Web
sites use challenge question based registration [7, 27, 49].
A challenge question is a user-speciﬁc question to which
an adversary is unlikely to be able to guess an answer,
e.g., “What is the name of your favorite teacher?” [18, 32].
Registration based on challenge questions is vulnerable to
man-in-the-middle (MITM) attacks [46, 61]. Since these at-
tacks exploit similar click-whirr responses as attacks against
passwords, the security beneﬁts of challenge questions over
passwords alone may be minimal.
Group Registration method
Attack
1
2
3
4
5
Challenge questions
Solicit answers
Email
Email
Email
Email
Forwarding
Forwarding
Cut and paste
Cut and paste
Warnings
in email?
Attack
Size
successful
N.A.
X
X
41
40
39
40
40
92.7% (38)
40.0% (16)
30.8% (12)
47.5% (19)
47.5% (19)
Table 1. Success rates of our simulated attacks against registration procedures in our user study.
Users in groups 2 and 4 received contextual warnings in registration emails against our simulated
attacks, but users in groups 3 and 5 did not.
1.1 Contributions
Since human click-whirr responses seem to be an un-
avoidable fact of life, we argue that authentication mecha-
nisms for humans should be designed such that click-whirr
responses reinforce their security. Towards realizing this
goal, we make two contributions:
Conditioned-safe ceremonies. A ceremony is similar to
the conventional notion of a network protocol, except that a
ceremony explicitly includes human participants as nodes
in the network, distinct from the computers and devices
they use [17].1
In this paper, we introduce the notion of
a conditioned-safe ceremony. A conditioned-safe ceremony
is one that deliberately conditions users to reﬂexively act
in ways that protect them from attacks. Our formulation
of a conditioned-safe ceremony draws on several ideas and
lessons learned from the human factors and human relia-
bility community: forcing functions, defense in depth, and
the use of human tendencies, such as rule-based decision
making.
In Section 4, we propose design principles for
conditioned-safe ceremonies.
A user study of an email based registration ceremony.
We apply our design principles for conditioned-safe cere-
monies to develop a registration ceremony for machine au-
thentication based on email (Section 5). To evaluate our
email based registration ceremony, we conducted a user
study with 200 participants to compare the security of email
registration to the security of registration based on chal-
lenge questions (Section 6). We simulated social engineer-
ing attacks against the users and found email based reg-
istration was signiﬁcantly more secure against our attacks
(Table 1). Our simulated attacks succeeded against 93% of
1The term ceremony was ﬁrst coined for this purpose by Jesse
Walker [17]. Communications between human nodes and other nodes in
the ceremony are usually not via network connections, but instead through
user interfaces, face-to-face interactions, or peripheral devices. Exam-
ples of ceremonies include password authentication and registration pro-
cedures.
challenge question users, but succeeded against only 41%
of email users. We also found evidence that conditioning
helped email registration users resist our simulated attacks,
but contributed towards making challenge question users
more vulnerable. We asked users to complete an exit sur-
vey after they ﬁnished the study, and we analyze the results
in Sections 7 and 8.
2 Why users are vulnerable
Over the last decade, the success of phishing and other
social engineering attacks has created a multi-million dollar
underground economy [20, 47]. Although it is tempting to
blame the success of these attacks on the ignorance of users,
researchers have offered an alternative explanation: com-
puter security mechanisms such as passwords and browser
security indicators are poorly suited for human use. Psy-
chologists and security researchers have identiﬁed several
ways in which many security mechanisms and ceremonies
disregard human tendencies and condition users to make in-
secure decisions [1, 12, 13, 14, 24, 44, 53]:
Click-whirr responses and rule-based decision making
are exploitable. Click-whirr responses are an example
of more general human tendency to vastly prefer rule-
based decision making over more tedious analytical ap-
proaches [40, 41]. The theory of rule-based decision mak-
ing is based on psychological studies that suggest humans
tend to learn and aggressively apply problem-solving rules
of the form “if (situation) then (action)” for frequently en-
countered situations. When a user encounters a problem in
a task, she matches the most prominent cues in the environ-
ment with the calling conditions of previously learned rules
to ﬁnd most appropriate one to apply.
Although rule-based decision making helps us navigate
the minutia of our daily lives and reserve our time and en-
ergy for tasks requiring more detailed analysis, adversaries
can exploit rule-based decision making in social engineer-
ing attacks [9]. Human reliability expert James Reason ob-
served that frequently used rules, i.e., strong rules, may
be “misapplied in environment conditions that share some
common features with the appropriate states, but also pos-
sess elements demanding a different set of actions [41].” In
other words, a rule which has been frequently useful in the
past can become a strong-but-wrong rule when the situa-
tional cues change subtly. This helps explains why phishing
attacks have been so successful. Since a wide range of Web
sites require a user to log in before she can do something
interesting, many users have developed a rule of the form
“if (login form) then (enter username/password)” and will
aggressively apply it when they encounter login prompts on
Web pages which on the surface appear familiar, legitimate,
or trustworthy.
Browser security mechanisms condition users to satis-
ﬁce. A frequently recommended defense against phishing
attacks is for a user to verify a Web page’s domain and SSL
certiﬁcate before entering her password on that page; oth-
erwise, she might inadvertently reveal her credentials to an
attacker. However, research has shown that users often omit
these checks [13, 14, 26, 29, 44, 54, 58]. Although some
users ignore these indicators because they do not understand
them, a more fundamental problem is that browser security
indicators condition users to satisﬁce.
Satisﬁcing is a decision-making strategy which means
“to accept a choice or judgment as one that is good enough”,
i.e., one that both satisﬁes and sufﬁces [42]. Checking se-
curity indicators is easy to skip because it distracts the user
from her primary focus, and there are rarely any immediate
visible consequences for skipping these checks or rewards
for making them. Since the vast majority of a user’s lo-
gin attempts are probably not under attack (or at least do
not obviously appear to be under attack), routinely skipping
security checks and ignoring warnings seems deceivingly
acceptable. Over time, users learn to quickly and instinc-
tively perform a security task’s required actions (e.g., enter-
ing their passwords) and optimize out the optional actions
(e.g., checking security indicators, responding to security
warnings). Once a user has become conditioned into a sat-
isﬁced behavior, psychologists have found it is difﬁcult for
her to change it, even if she recognizes overwhelming evi-
dence that her behavior is wrong [9].
Users are not good at recognizing attacks. Accidents
and successful social engineering attacks share similar key
characteristics: they have a similar precondition, i.e., a risky
situation, and similar trigger, i.e., human error. A recur-
ring theme in the ﬁeld of human reliability and error is that
users often have difﬁculty in recognizing risky or danger-
ous situations, and as a result, users may be less vigilant of
their choices in these situations than they should. For ex-
ample, in a review of 100 maritime shipping accidents, Wa-
genaar and Groeneweg concluded: “Accidents do not occur
because people gamble and lose, they occur because people
do not believe that the accident that is about to occur is at all
possible [50].” Also, decades of buggy software have condi-
tioned users to expect errors, failures, and other incompre-
hensible system behavior, particularly with hastily devel-
oped and continually updated Web applications. Users rou-
tinely encounter warnings and errors messages, but rarely
experience any immediate negative consequences for dis-
missing them, even during a real attack. This creates the
(accurate) impression that false positives are the norm, and
actual attacks are rare. These tendencies suggest that we
cannot rely on users’ abilities to detect social engineering
attacks and respond appropriately, and we must design de-
fenses accordingly.
3 Machine authentication to the rescue?
In response to the precipitous rise in social engineering
attacks on the Internet, many institutions have implemented
authentication ceremonies that supplement password based
authentication with machine authentication, which authen-
ticates a user’s computer as opposed to the user herself.
For example, one widely used approach for machine au-
thentication is to set a persistent cookie; since the user’s
browser will send that cookie every time the user returns to
the Web site from that computer, the Web site can recognize
the user’s computer. To successfully log in, the user must
provide her password and the user’s browser must present a
valid cookie. The intention is to take the human “out of the
loop” and reduce the system’s dependency on humans’ abil-
ities to detect attacks. Web sites currently using machine au-
thentication include Bank of America [7], ING Direct [27]
and Vanguard [49].
The registration problem. Since users may use more
than one computer, machine authentication systems must
have a registration ceremony to authorize and set authen-
tication cookies on multiple machines. Unfortunately, this
additional functionality brings the human back “in the loop”
and exposes machine authentication systems to an alterna-
tive attack vector. Instead of trying to steal authentication
cookies directly from a user’s machine, an attacker can try
to subvert the registration ceremony in a way that grants the
attacker a valid cookie for the user’s account. Consequently,
registration ceremonies must resist these kinds of bootstrap-
ping attacks; otherwise, the security beneﬁts of machine au-
thentication may be minimal.
Challenge questions. Many machine authentication sys-
tems currently deployed by ﬁnancial Web sites use chal-
lenge questions in their registration ceremony [7, 27, 49].
When a user creates her account, she provides the answers
to one or more challenge questions, and when she attempts
to log in from an unregistered computer, the site prompts
her to answer these questions. If the answers are correct,
then the site sets a persistent authentication cookie on the
user’s computer. For future logins from that computer, the
user only needs to enter her password.
Challenge questions are vulnerable to an active man-in-
the-middle (MITM) attacker spooﬁng the login page of the
target Web site [46, 61]. When the user attempts to login
via the spoofed page, the attacker forwards the user’s login
credentials to the legitimate Web site. Since the attacker is
indistinguishable from the actual user logging from an un-
registered machine, the Web site responds with challenge
questions for the user. The attacker displays these questions
to the user. After the user provides her answers, the attacker
forwards them to the Web site and receives an authentica-
tion cookie for the user’s account.
Challenge question based registration is vulnerable be-
cause, like password authentication, it disregards human
tendencies and conditions users to fall for attacks. A user
is most likely to resist an attack against her challenge ques-
tions if she recognizes the threat and refrains from the click-
whirr response of providing her answers. However, since
the attacker’s registration request is indistinguishable from
the Web site’s legitimate registration requests, detecting at-
tacks is non-trivial for many users. Users must actively and
carefully check browser security indicators, e.g., the URL
bar and SSL certiﬁcate, to detect spooﬁng attacks. Many
users misinterpret these indicators, and satisﬁcing users of-
ten ignore them.
Registration based on challenge questions threatens to
undermine the promise of machine authentication. Since
users who are vulnerable to phishing attacks against their
passwords will probably also be vulnerable to phishing at-
tacks against their challenge questions, a registration cere-