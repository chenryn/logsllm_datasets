### 3.2 Cluster Merging and Filtering

If the Jaccard similarity \(J(C_i, C_j)\) between two clusters \(C_i\) and \(C_j\) exceeds a threshold \(\tau\), we merge these clusters. Given that pairwise similarity computation is resource-intensive, we utilize minhashing on the set of users in each cluster. A grid search, similar to the one illustrated in Figure 3, is performed to identify the optimal parameters. We ultimately choose \(k = 2\) for a Jaccard similarity threshold of \(\tau = 0.5\). This configuration, determined through manual analysis, effectively captures evolving groups of spam accounts controlled by a single entity without merging benign clusters with spam campaigns or combining distinct memes.

After merging clusters with identical user minhashes, we filter out those with fewer than 2,000 unique users. This step results in our final dataset, comprising 16,206 clusters, 254,366,938 tweets, and 35,869,312 users.

### 3.3 Classification

To differentiate legitimate memes from infections or spam generated by fraudulent accounts, we developed a multi-class classifier based on retroactive actions taken by Twitter and its users, as shown in Figure 1 (). As discussed in Section 2, existing classifiers do not scale well and struggle to accurately distinguish between compromised and fraudulent accounts, necessitating the development of a new technique.

Our classifier leverages the observation that compromised users—or Twitter acting on their behalf—often delete spam tweets posted via their accounts once they recognize that their credentials have been hijacked. Similarly, Twitter proactively suspends abusive accounts that disseminate spam or form an excessive number of relationships [28].

To capture these behaviors, we randomly sampled 1,000 tweets and 1,000 users from each cluster in our dataset and queried Twitter’s `users/show` and `statuses/show` APIs. The response codes returned by Twitter allow us to label users and tweets as valid, deleted, suspended, or now private. To account for delays in actions, we waited one month after the final day of data collection (October 21, 2013) before querying the API endpoints.

To validate the effectiveness of these features, we manually analyzed a sample of 1,699 clusters, labeling them as either memes (1,038 samples), infections (265 samples), or spam from fraudulent accounts (365 samples). We plotted each labeled cluster as a function of the percentage of suspended users versus the percentage of deleted tweets, as shown in Figure 4. The three non-overlapping clusters indicate that our retroactive feature set provides a strong basis for segmenting the three classes of clusters.

### 3.3.1 Training

To determine the optimal hyperplane that separates our three classes, we trained a multi-class logistic regression model using 10-fold cross-validation, seeded with our manually labeled dataset of 1,699 clusters. Each cluster is represented by a vector of features, and the model is trained to classify clusters into the three categories: memes, infections, and spam from fraudulent accounts.