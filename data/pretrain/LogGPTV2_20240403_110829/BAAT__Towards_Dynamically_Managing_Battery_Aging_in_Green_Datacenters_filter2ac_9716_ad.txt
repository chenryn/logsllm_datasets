battery  node,  which  has  a  minimal  weighted  aging  value  of 
NAT, CF and PC similar to the aging hiding technique. If the 
VM cannot be migrated due to resource constrains elsewhere in 
the datacenter (e.g., CPU/Memory/Disk), we perform DVFS on 
servers  to  reduce  power  demand  and  promote  the  chances  of  
battery  charging  to  a  higher  SoC  when  the  intermittent  power 
supply becomes sufficient again. As DVFS may cause degraded 
performance,  we  preferentially  use  VM  migration  to  reduce 
performance penalty. The details of our slowdown aging policy 
is depicted in Figure 9. 
D.  Planned Aging: Aging Rate Management 
The  speed  of  battery  aging  and  datacenter  infrastructure 
aging are different. The average aging rate of battery is usually 
faster  than  servers  and  other  IT  equipment.  Consequently, 
datacenter  operators  will  end  up  with  discarding  servers  or 
batteries  before 
this  case, 
significant  performance  may  be  wasted  if  slowing  down  the 
battery aging rate is excessively emphasized.  If we know when 
the  batteries  will  be  discarded,  we  can  use  BAAT  to  “shift” 
some  performance  from  the  unused  portion  of  the  battery’s 
lifetime to the used time, which refers to planned aging. 
 In  Figure  10  we  show  the  cycle  life  data  from  different 
manufacturers  (Hoppecke  Battery,  Trojan  Battery  and  UPG 
Battery). It shows that the battery cycle life decreases by 50% if 
it is frequently discharged at a DoD above 50%. If we want to 
discard the battery after a certain life cycle, our goal is to apply 
planned aging techniques so that the battery is aggressively used 
before  being  discarded.  Since  different  battery  DoD  implies 
different  lifecycles,  we  can  regulate  the  battery  DoD  to  plan 
battery  aging  rate.  We  leverage  the  battery  Ah-throughput 
their  expected  end-of-life.  In 
312312
(cid:20)
(cid:21)
(cid:22)
(cid:23)
(cid:24)
(cid:25)
(cid:26)
(cid:27)
(cid:28)
(cid:20)(cid:19)
Server Rack
Solar Panels
Battery array 
(7) 
Sensor devices 
(5)(9) 
(8) 
Control server 
Twelve 12V 35Ah sealed lead-acid batteries 
Shielded connector block (NI BNC-2110[34]) for sensor 
signal transmitting from front sensors to sensor data 
acquisition card (NI PCI-6221[35]) 
Front sensors for batteries for collecting battery voltage, 
current and temperature [36] 
A customized low power intel i7 server for collecting 
monitored batteries/servers information and sending 
control commands to computing servers 
Power Switcher 
(3) 
(2) 
(4) 
Computing nodes 
(6) 
Display 
 (1) 
(10) 
IPDU[37], power monitor for computing servers 
Power switch controller included some PLC, relays and 
DC-AC inverter to switch the power sources among utility, 
renewable power or battery power 
Three IBM X series 330 and three HP ProLiant servers 
Displayed information includes data captured by sensors, 
system log trace, and various aging metrics calculated by 
the control server in real time 
Fig. 11. A full-system implementation of BAAT and six major function 
modules of the prototype system 
The power switcher can dynamically switch the power sources 
among utility, battery power and renewable energy (we tap into 
one  solar  power  line  from  the  PV  panel  on  the  roof  of  the 
building to our prototype system) to power servers and it also 
can  switch  the  utility  or  renewable  power  to  charge  batteries. 
The  switch  module  is  controlled  by  control  server  via  SNMP 
commands over the Ethernet. 
5)  Compute  Nodes  and  Display  Module.  We  use  three 
IBM  servers  and  three  HP  servers.  The  display  module  can 
visualize  the  data  captured  by  sensors  via  LabVIEW  and  the 
aging impact factors calculated by control server in real time. 
B.  Workload Deployment 
We  deploy  six  datacenter  workloads.  Three  of  them  come 
from  Hibench  [39]:  Nutch  Indexing;  K-Means  Clustering,  and 
Word  Count.  These  workloads  represents  today’s  large-scale 
search  indexing  application,  machine  learning  application,  and 
MapReduce jobs. We also select three popular cloud workloads 
from the CloudSuite [40]: Software  Testing, Web  Serving, and 
Data  Analytic.  For  example,  Software  Testing  is  a  resource-
hungry and time-consuming application that allows us to stress 
our servers and distributed batteries.  
313313
TABLE IV.  THE COMPARISON OF FOUR BATTERY MANAGEMENT POLICIES 
Schemes 
e-Buff 
BAAT-s 
BAAT-h 
BAAT 
Method Description 
Aggressively use battery as the green energy 
buffer to manage supply/load power variability 
Only use aging-aware CPU frequency throttling 
to slow down battery aging 
Only use aging-aware VM migration technique to 
hide battery aging variation 
Coordinate hiding and slowing down techniques 
to dynamically manage battery aging 
  We  deploy  Xen  4.1.2  hypervisor  as  the  virtual  machine 
monitor (VMM) in our system prototype. All the workloads are 
hosted  in  virtual  machines  (VMs)  and  the  workloads  can  be 
easily  managed  by  performing  VM  spawning,  pausing  and 
migration among server nodes. Through software driver, we can 
dynamically set the frequency of processors.  
The  operating  condition  of  our  system  is  affected  by  the 
available solar energy. Normally we turn on the first server at 
8:30AM  and  all  servers  are  shut  down  usually  after  6:30PM. 
When solar power budget is temporarily unavailable, our system 
can make checkpoint and all VM states are saved. Our controller 
can  precisely  control  the  battery  charger  so  that  the  stored 
energy reflects the actual solar power supply on our prototype.  
VI.  EVALUATION RESULTS 
In  this  section,  we  evaluate  the  impact  of  various  power 
management  schemes  on  battery  aging.  We  first  compare  the 
BAAT  with  three  baseline  power  management  policies  as 
shown  in  Table  4.  Among  those,  e-Buff  represents  the  power 
design  approaches  similar  to  previous  work  [4,  7],  which 
aggressively  employs  battery  energy 
to  manage  power 
mismatch between  supply and demand. BAAT-s and BAAT-h 
are two simplified versions of our BAAT scheme. BAAT-s only 
focuses  on  slowing  down  the  battery  aging  processes,  while 
BAAT-h mainly emphasizes battery aging hiding.  
A.  System Runtime Profiling 
We  first  profile  the  system  runtime  of  our  prototype  across 
different solar generation scenarios by analyzing the generated 
logs  and  collected  system  runtime  traces.  As  expected,  due  to 
the intermittent solar power budget and different server power 
demands,  the  usage  frequency  of  the  six  battery  pack  varies 
significantly, as shown in Figure 12-(a), which leads to different 
battery aging rates.  
To quantify the aging processes, we present the variation of 
several aging-related metrics of one battery node, as shown in 
Figures 12(e) to 12(k). We present the values of NAT, CF, and 
PC under different weather conditions, as shown in Figures 12(b) 
to 12(d), The total energy budget for Sunny, Cloudy, and Rainy 
is 8 kWh, 6kWh, and 3kWh, respectively.  
It is clear that the battery nodes yield less Ah-throughput in 
sunny  day  than  the  other  two  weather  conditions.  This  is 
because the solar energy can afford most server power demands 
and the batteries are rarely used. The CF in sunny day is higher 
than cloudy and rainy days, which implies that the battery node 
has been recharged more frequently. The PC value in sunny day 
reflects the fact that battery node stays in high SoC region. We 
can  see  that  the  battery  node  stays  high  SoC  at  most  time  in 
sunny day. Therefore, on the cloudy and rainy days, the battery 
node has more aging decay by exhibiting high Ah-throughput, 
low CF and low PC. 
P(KW)
Sunny
P(KW)
Cloudy
P(KW)
Rainy
1.5
1.0
0.5
2.0
1.5
1.0
0.5
Solar power
Servers/Rack
1.5
1.0
0.5
2.0
1.5
1.0
0.5
80%
30%
75%
15%
90%
31%
9
12
18
Sunny day solar generation log
6
(b)
Ah-throughput(x102Ah)
15
Sunny
(hours)
Start aging slowdown 
6
(c)
9
18
Cloudy day solar generation log
15
12
(hours)
Ah-throughput(x102Ah)
Cloudy
9
Rainy day solar generation log
15
18
12
6
(d)
Ah-throughput(x102Ah)
(hours)
Start aging slowdown 
Start aging slowdown 
Rainy
Ah-throughput 
threshold
6
(e)
9
12
15
18
(hours)
Aging management in sunny day
9
12
15
18
(hours)
Aging management in cloudy day
6
(g)
12
9
Aging management in rainy day
15
18
(hours)
1.5
1.0
0.5
2.0
1.5
1.0
0.5
6
(f)
CF
1.5
1.2
0.9
0.6
0.3
0
Sunny
Cloudy
Rainy
(h)
Charge factor (1-day) under 
three weather conditions
60%
45%
30%
15%
0%
(i)
High 
SoC
Sunny 
Cloudy 
Medium SoC
60%
45%
30%
15%
Rainy 
Low 
SoC
60%
45%
30%
15%
0%
Batteries(SoC %)
(a)
Each battery is used 
differently and lead to 
distinct aging variation
0%
PC(A)  PC(B)  PC(C)  PC(D)
PC(A)  PC(B)  PC(C)  PC(D)
Bat. stays at low SoC
Bat. stays at high SoC 
 for over 30% duration
for over 40% duration
Note: PC(A): SoC>80%, PC(B): 80%>=SoC>60%, PC(C): 60%>=SoC>40%, PC(D): SoC=<40%
PC(A)  PC(B)  PC(C)  PC(D)
Bat. stays at medium 
SoC for 60% duration
(k)
(j)
Fig. 12. The variation of different aging metrics collected from our solar energy powered green datacenter prototype under different weather conditions 
With  the  quantized  aging  process,  our  system  has  the 
knowledge  of  all  the  battery  aging  processes  under  different 
weather  conditions.  Therefore,  the  aging-aware  operations  can 
be timely performed. Take Ah-throughput for example, we start 
to  slow  down  battery  aging  when  the  accumulative  Ah-
throughput  of  the  battery  reaches  to  the  pre-defined  threshold. 
The slowdown  time varies in different weathers, as  marked in 
Figures  12(e)  to  12(g).  Based  on  the  logs  of  different  aging 
metrics, our BAAT power management framework can combine 
load power profiling information and weighted aging ranking to 
effectively hide and slow down battery aging. 
B.  Aging Progress Comparison 
In this subsection, we present the impact of different power 
management  schemes  on  battery  aging  progresses  by  com-
paring different aging metrics. Specially, we compare our aging- 
aware power management algorithm BAAT with three baseline 
algorithms. We select two typical weather conditions (sunny and 
cloudy  day)  and  “young”  and  “old”  battery  aging  stages  (new 
and aged batteries) to evaluate the four management algorithms.  
In April, after the setup of our prototype system, we start by 
using the new  batteries to conduct our aging  experiments. We 
deploy  and  iteratively  run  the  workloads  hosted  in  virtual 