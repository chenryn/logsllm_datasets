### 7. Operational Experiences

In this section, we share the practical insights and lessons learned from our work on GQ. Our focus is on the development of containment policies and the overall scalability of the system.

#### 7.1 Insights from Containment

Developing containment policies can often feel like a tedious task, but it is crucial for understanding the behavior of the malware under study. Here are some key insights we gained during the process:

**Absence of Activity:**
During our operation of GQ as a worm-capturing honeyfarm in early 2006, we captured 66 distinct worms belonging to 14 different malware families, as classified by Symantec’s anti-virus products at the time. Table 1 summarizes these captures. Notably, nine infection classes required more than three minutes on average for propagation. This highlights the importance of long-duration execution to observe the desired behavior, even in infections that are known to act quickly.

**Unexpected Visitors:**
In 2008, while infiltrating the Storm botnet [13, 18, 19], we developed a comprehensive understanding of this malware family, leading to a natural containment policy. For the C&C-relaying proxy bots in the middle of the Storm hierarchy, we maintained their outside reachability (a requirement for them to become relay agents rather than spam-sourcing drones) and redirected all outgoing activity, except for the HTTP-borne C&C protocol, to our standard sink server. In June, however, we observed unexpected FTP connection attempts at our sink server. Further investigation revealed that an upstream botmaster was attempting to use the bots’ ability to receive and process SOCKS [15] message headers to initiate FTP connections to specific hosts, authenticate with known credentials, download a specific HTML file, and re-upload it with a malicious iframe tag inserted. At the time, articles on Storm frequently stated that its proxy bots did not engage in malicious activity, and a less stringent containment policy would have allowed these attacks to proceed unchecked.

**Mysterious Blacklisting:**
In June 2009, while deploying spambots of the Waledac family [27], we were surprised to find that the Composite Blocking List (CBL) [6] had listed our deployed bots, indicating a possible containment failure. The only external interaction we had permitted was a single test SMTP message sent to a GMail server. Redirection to our default SMTP sink caused the bots to cease further activity due to the lack of the Google SMTP banner response. Subsequent independent testing revealed that the bots used a recognizable HELO greeting string ("wergvan"), which Google detected and reported to blacklist providers. This led to the blacklisting of the IP addresses of SMTP speakers using this greeting.

### Table 1: Summary of Captured Worms

| Worm Name          | Executable     | Events/Conns | Incubation Period (S) |
|--------------------|----------------|--------------|-----------------------|
| W32.Zotob.E        | a####.exe      | 4 / 3        | 29.0                  |
| W32.Zotob.H        | a####.exe      | 9 / 3        | 25.2                  |
| Backdoor.Sdbot     | cpufanctrl.exe | 1 / 3        | 223.2                 |
| W32.Welchia.Worm   | chkdisk32.exe  | 297 / 4 or 6 | 111.2                 |
| W32.Blaster.F.Worm | dllhost.exe    | 1 / 3        | 28.9                  |
| W32.Balster.Worm   | enbiei.exe     | 1 / 3        | 43.8                  |
| W32.Poxdar         | msblast.exe    | 11 / 8       | 32.4                  |
| W32.Spybot.Worm    | lsd            | 3 / 3        | 237.5                 |
| W32.Spybot.Worm    | NeroFil.EXE    | 1 / 5        | 79.6                  |
| W32.Spybot.Worm    | sysmsn.exe     | 2 / 5        | 57.0                  |
| W32.Spybot.Worm    | MsUpdaters.exe | 1 / 5        | 95.4                  |
| W32.Spybot.Worm    | ReaIPlayer.exe | 1 / 5        | 178.4                 |
| W32.Spybot.Worm    | WinTemp.exe    | 2 / 5        | 118.2                 |
| W32.Spybot.Worm    | wins.exe       | 1 / 5        | 189.4                 |
| W32.Spybot.Worm    | msnet.exe      | 1 / 5        | 125.3                 |
| W32.Spybot.Worm    | msgupdates.exe | 1 / 5        | 459.4                 |
| W32.Spybot.Worm    | ntsf.exe       | 1 / 5        | 46.2                  |
| W32.Spybot.Worm    | scardsvr32.exe | 1 / 5        | 66.5                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 96.6                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 179.6                 |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 49.3                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 41.4                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 41.1                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 32.2                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 54.8                  |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 180.8                 |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 6.6                   |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 9.5                   |
| W32.Spybot.Worm    | x.exe          | 1 / 5        | 6.0                   |

These insights underscore the importance of rigorous containment policies and the need for continuous monitoring and adaptation in the face of evolving threats.