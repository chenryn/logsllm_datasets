tions, which we cover in the next section) of blacklisting speaks for
the quality of our containment policies.
7. OPERATIONAL EXPERIENCES
We now report on experiences gained over the course of our work
on GQ. In particular, we focus on practical lessons learned while
developing containment policies, and on insights on the general
scalability of the system.
7.1 Containment-derived insights
While containment policy development can easily feel like a
chore, we have found that developing tight containment often forms
a key step for understanding the behavior of a sample under study.
Examples of such insights learned during containment develop-
ment include:
Absence of activity. During our operation of GQ as a worm-
capturing honeyfarm at the beginning of 2006, we captured 66 dis-
tinct worms belonging to 14 different malware families (according
to classiﬁcation by Symantec’s anti-virus products at the time). Ta-
ble 1 summarizes the captures. Note the high variation in incuba-
tion times: nine infection classes required more than three minutes
on average for a propagation. This illustrates the importance of
long-duration execution to observe the desired behavior, even in
infections that supposedly act quickly.
Unexpected visitors. During our inﬁltration of the Storm bot-
net in 2008 [13, 18, 19] we developed sufﬁciently complete under-
standing of this particular malware family that a containment pol-
icy seemed to follow naturally. For the C&C-relaying proxy bots
in the middle of the Storm hierarchy, we preserved outside reacha-
bility of the bots (the requirement for their becoming relay agents
as opposed to spam-sourcing drones) and redirected all outgoing
activity other than the HTTP-borne C&C protocol to our standard
sink server. In June, however, we noticed apparent FTP connection
attempts arriving at our sink server. Closer investigation revealed
the attempted use of our Storm bots for iframe injection. An up-
stream botmaster attempted to use the bots’ ability to receive and
process SOCKS [15] message headers to initiate FTP connections
to speciﬁc hosts, authenticate and log in with known credentials,
download a speciﬁc HTML ﬁle and re-upload it with a malicious
iframe tag inserted. At the time, articles on Storm frequently stated
that its proxy bots did not themselves engage in malicious activ-
ity, and a correspondingly loose containment policy would have
allowed these attacks to proceed unhindered.
Mysterious blacklisting. While deploying spambots of the
Waledac family [27] in June 2009, we noticed to our surprise
that the Composite Blocking List (CBL) [6] listed our inmates—
a strong indication of a possible containment failure. However, the
only outside interaction we had permitted was a single test SMTP
message, sent to a GMail server, because redirection to our default
SMTP sink caused the bots to cease further activity due to the lack
of their receiving the Google SMTP banner in response to their
attempts. Subsequent independent testing revealed that the bots
themselves used a recognizable HELO greeting string (wergvan),
that Google detected its presence, and that they informed black-
list providers of the IP addresses of SMTP speakers employing the
405EXECUTABLE
a####.exe
a####.exe
a####.exe
cpufanctrl.exe
chkdisk32.exe
dllhost.exe
enbiei.exe
msblast.exe
lsd
NeroFil.EXE
sysmsn.exe
MsUpdaters.exe
ReaIPlayer.exe
WinTemp.exe
wins.exe
msnet.exe
msgupdates.exe
ntsf.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
scardsvr32.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
x.exe
xxxx...x
xxxx...x
xxxx...x
xxxx...x
xxxx...x
n/a
n/a
n/a
n/a
n/a
n/a
n/a
n/a
n/a
multiple
multiple
multiple
WORM NAME
W32.Zotob.E
W32.Zotob.H
—
Backdoor.Sdbot
—
# EVENTS/
# CONNS
4 / 3
9 / 3
1 / 3
1 / 4
1 / 4
W32.Welchia.Worm 297 / 4 or 6
1 / 3
W32.Blaster.F.Worm
1 / 3
W32.Balster.Worm
W32.Poxdar
11 / 8
1 / 5
W32.Spybot.Worm
3 / 3
W32.Spybot.Worm
1 / 5
W32.Spybot.Worm
2 / 5
W32.Spybot.Worm
1 / 5
W32.Spybot.Worm
W32.Spybot.Worm
1 / 5
1 / 7
W32.Spybot.Worm
2 / 5
W32.Spybot.Worm
1 / 5
—
4 / 3
W32.Femot.Worm
1 / 3
W32.Femot.Worm
W32.Femot.Worm
55 / 3
2 / 3
W32.Femot.Worm
1 / 5
W32.Femot.Worm
4 / 3
W32.Femot.Worm
1 / 3
W32.Femot.Worm
1 / 5
W32.Valla.2048
—
1 / 7
1 / 3
W32.Pinﬁ
17 / 2
W32.Korgo.Q
7 / 2
W32.Korgo.T
102 / 2
W32.Korgo.V
31 / 2
W32.Korgo.W
20 / 2
W32.Korgo.Z
W32.Korgo.S
169 / 2
15 / 2
W32.Korgo.S
2 / 2
W32.Korgo.V
2 / 2
W32.Licum
3 / 2
W32.Korgo.S
1 / 2
W32.Pinﬁ
W32.Korgo.V
6 / 2
5 / 2
W32.Pinﬁ
5 / 2
W32.Pinﬁ
2 / 2
W32.Pinﬁ
1 / 2
W32.Korgo.V
1 / 2
W32.Pinﬁ
W32.Korgo.W
1 / 2
1 / 2
W32.Korgo.S
1 / 2
W32.Pinﬁ
1 / 2
W32.Korgo.S
844 / 2
Backdoor.Berbew.N
34 / 2
W32.Info.A
685 / 3
Trojan.Dropper
W32.Pinﬁ
1 / 3
3 / 2
W32.Pinﬁ
3 / 2
W32.Korgo.C
1 / 2
W32.Korgo.L
8 / 2
W32.Korgo.G
2 / 2
W32.Korgo.N
W32.Korgo.G
3 / 2
1 / 2
W32.Korgo.E
1 / 2
W32.Korgo.gen
15 / 2
W32.Korgo.I
1 / 2
W32.Korgo.I
2 / 7
W32.Muma.A
W32.Muma.B
2 / 7
1 / 72
BAT.Boohoo.Worm
INCUBATION
PERIOD (S)
29.0
25.2
223.2
111.2
134.7
24.5
28.9
43.8
32.4
237.5
79.6
57.0
95.4
178.4
118.2
189.4
125.3
459.4
46.2
66.5
96.6
179.6
49.3
41.4
41.1
32.2
54.8
180.8
6.6
9.5
6.0