![](media/image1.png)
**国家电网公司信息系统**
**统一日志中心设计规划专题报告**
**信息系统行为安全审计顶层设计组**
**二○一六年三月**
**目录**1 日志产品与技术现状 [3](#日志产品与技术现状)
> 1.1 主要产品 [3](#主要产品)
>
> 1.2 主要技术 [4](#主要技术)
2 统一日志管理需求分析 [10](#统一日志管理需求分析)
> 2.1 全面的日志采集需求 [10](#全面的日志采集需求)
>
> 2.2 运维可用性监控及应用性能监控需求
> [11](#运维可用性监控及应用性能监控需求)
>
> 2.3 安全信息与事件管理需求 [11](#安全信息与事件管理需求)
>
> 2.4 事件关联分析需求 [11](#事件关联分析需求)
>
> 2.5 在线业务统计分析需求 [12](#在线业务统计分析需求)
>
> 2.6 日志快速检索需求 [12](#日志快速检索需求)
>
> 2.7 日志统一存储需求 [12](#日志统一存储需求)
>
> 2.8 符合标准政策规定内控需求 [13](#符合标准政策规定内控需求)
>
> 2.9 业务审计需求 [13](#业务审计需求)
>
> 2.10 其他数据分析支撑需求 [13](#其他数据分析支撑需求)
3 总体架构 [13](#总体架构)
4 技术构架 [16](#技术构架)
> 4.1 日志采集技术 [16](#日志采集技术)
>
> 4.2 日志存储技术 [18](#日志存储技术)
>
> 4.3 集群资源同步与管理 [19](#集群资源同步与管理)
>
> 4.4 日志分析与计算 [20](#日志分析与计算)
>
> 4.5 搜索引擎技术 [21](#搜索引擎技术)
>
> 4.6 前端服务 [21](#前端服务)
5 安全保障技术 [22](#安全保障技术)
> 5.1 访问控制 [23](#访问控制)
>
> 5.2 网络隔离技术 [23](#网络隔离技术)
>
> 5.3 加密技术 [24](#加密技术)
>
> 5.4 防火墙技术 [24](#防火墙技术)
>
> 5.5 采用入侵检测系统 [24](#采用入侵检测系统)
>
> 5.6 网络安全管理规范 [24](#网络安全管理规范)
6 非功能性相关设计 [25](#非功能性相关设计)
> 6.1 性能 [25](#性能)
>
> 6.2 安全 [25](#安全)
>
> 6.3 易用性 [26](#易用性)
>
> 6.4 可维护性 [29](#可维护性)
>
> 6.5 权限 [30](#权限)
# 日志产品与技术现状
## 主要产品
**1、splunk**
Splunk 是一款商业化的顶级日志分析软件，使用 Splunk
可收集、索引和利用所有应用程序、服务器和设备（物理、虚拟和云中）生成的快速移动型计算机数据
。从一个位置搜索并分析所有实时和历史数据。
但Splunk收费昂贵，并且国内缺少足够的技术支持团队。
**2、日志易**
日志易是一个配置简单、容易使用的商业化日志管理工具，它对日志进行集中采集和实时索引，提供搜索、分析、可视化和监控告警等功能，但在日志的关联分析和深入挖掘方面存在欠缺，并且缺少对核心资产信息的管理。
**3、ELK**
elasticsearch+logstash+kibana（ELK）是一套开源的日志管理方案。通过搜集、过滤、传输、储存，对海量系统和组件日志进行集中管理和准实时搜索、分析，使用搜索、监控、事件消息和报表等简单易用的功能。由于是开源框架，很多功能都需要二次开发实现，并且在进行二次开发时会受到底层基础框架的限制和制约，很难达到我们预期效果。
## 主要技术
**（1）监测管理技术**
**OpenTSDB**：OpenTSDB是一个架构在Hbase系统之上的实时监控信息收集和展示平台。
**Ambari**
：作为Hadoop生态系统的一部分，这个Apache项目提供了基于Web的直观界面，可用于配置、管理和监控Hadoop集群。有些开发人员想把Ambari的功能整合到自己的应用程序当中，Ambari也为他们提供了充分利用REST（代表性状态传输协议）的API。
**（2）基准测试技术**
**YCSB**：是 Yahoo
公司的一个用来对云服务进行基础测试的工具。目标是促进新一代云数据服务系统的性能比较。
**GridMix**：是Hadoop的集群基准测试组件。
**（3）数据摄取技术**
**Flume**：Flume可以从其他应用程序收集日志数据，然后将这些数据送入到**Hadoop**：官方网站声称："它功能强大、具有容错性，还拥有可以调整优化的可靠性机制和许多故障切换及恢复机制。"
**Sqoop**：企业经常需要在关系数据库与Hadoop之间传输数据，而Sqoop就是能完成这项任务的一款工具。它可以将数据导入到Hive或HBase，并从Hadoop导出到关系数据库管理系统（RDBMS）。
**Kafka**
：Kafka是一种高吞吐量的分布式发布订阅消息系统，它可以处理消费者规模的网站中的所有动作流数据。
**（4）序列化技术**
**Avpro**：这个Apache项目提供了数据序列化系统，拥有丰富的数据结构和紧凑格式。模式用JSON来定义，它很容易与动态语言整合起来。
**Protocol Buffers**：Protocol Buffers
是一种轻便高效的结构化数据存储格式，可以用于结构化数据串行化，很适合做数据存储或
RPC
数据交换格式。它可用于通讯协议、数据存储等领域的语言无关、平台无关、可扩展的序列化结构数据格式。
**（5）ETL（萃取、转换）技术**
**Crunsh**：Crunch 是一个用 Go 语言开发的基于 Hadoop 的 ETL
和特性抽取工具，特点是速度快。
**Apache Falcon**：Apache
Falcon是一个面向Hadoop的、新的数据处理和管理平台，设计用于数据移动、数据管道协调、生命周期管理和数据发现。它使终端用户可以快速地将他们的数据及其相关的处理和管理任务"上载（onboard）"到Hadoop集群。
**Cascading**：Cascading是一款基于Hadoop的应用程序开发平台。提供商业支持和培训服务。
**Oozie**：这种工作流程调度工具是为了管理Hadoop任务而专门设计的。它能够按照时间或按照数据可用情况触发任务，并与MapReduce、Pig、Hive、Sqoop及其他许多相关工具整合起来。
**（6）元数据技术**
**HCatalog**：Hcatalog是apache开源的对于表和底层数据管理统一服务平台。
分析工具
**Pig**：Apache Pig是一种面向分布式大数据分析的平台。它依赖一种名为Pig
Latin的编程语言，拥有简化的并行编程、优化和可扩展性等优点。
**Hive**：Apache
Hive是面向Hadoop生态系统的数据仓库。它让用户可以使用HiveQL查询和管理大数据，这是一种类似SQL的语言。
**Phoenix**：这是一个Java中间层，可以让开发者在Apache
HBase上执行SQL查询。Phoenix完全使用Java编写，代码位于GitHub上，并且提供了一个客户端可嵌入的JDBC驱动。
**（7）分析类库**
**MLib**：MLlib
是Spark对常用的机器学习算法的实现库,同时包括相关的测试和数据生成器。
**SparkR**：SparkR是一个R语言包,它提供了轻量级的方式使得可以在R语言中使用Apache
Spark。
**Mathout**：Mahout 是 Apache Software Foundation（ASF）
旗下的一个开源项目，提供一些可扩展的机器学习领域经典算法的实现，旨在帮助开发人员更加方便快捷地创建智能应用程序。Mahout包含许多实现，包括聚类、分类、推荐过滤、频繁子项挖掘。此外，通过使用
Apache Hadoop 库，Mahout 可以有效地扩展到云中。
**（8）交互式技术**
**Dremel**：Dremel 是Google
的"交互式"数据分析系统。可以组建成规模上千的集群，处理PB级别的数据。
**Drill**：Apache Drill 在基于 SQL 的数据分析和商业智能（BI）上引入了
JSON
文件模型，这使得用户能查询固定架构，演化架构，以及各种格式和数据存储中的模式无关（schema-free）数据。该体系架构中关系查询引擎和数据库的构建是有先决条件的，即假设所有数据都有一个简单的静态架构。
**Tez**：Tez建立在Apache Hadoop
YARN的基础上，这是"一种应用程序框架，允许为任务构建一种复杂的有向无环图，以便处理数据。"它让Hive和Pig可以简化复杂的任务，而这些任务原本需要多个步骤才能完成。
**Impala**：Impala是Cloudera公司主导开发的新型查询系统，它提供SQL语义，能查询存储在Hadoop的HDFS和HBase中的PB级大数据。已有的Hive系统虽然也提供了SQL语义，但由于Hive底层执行使用的是MapReduce引擎，仍然是一个批处理过程，难以满足查询的交互性。相比之下，Impala的最大特点也是最大卖点就是它的快速。
**Shark**：Shark即Hive on
Spark，本质上是通过Hive的HQL解析，把HQL翻译成Spark上的RDD操作，然后通过Hive的metadata获取数据库里的表信息，实际HDFS上的数据和文件，会由Shark获取并放到Spark上运算。
**Presto**：Presto是一个开源的分布式SQL查询引擎，适用于交互式分析查询，数据量支持GB到PB字节。
**BlinkDB**：BlinkDB 是一个用于在海量数据上运行交互式 SQL
查询的大规模并行查询引擎。它允许用户通过权衡数据精度来提升查询响应时间，其数据的精度被控制在允许的误差范围内。
**Dryad**：Dryad是微软分布式并行计算基础平台，使程序员可以利用数据中心的服务器集群对数据进行并行处理。Dryad程序员在操作数千台机器时，无需关心并行处理的细节。
**（9）流式技术**
**Storm**：Storm现在是一个Apache项目，它提供了实时处理大数据的功能（不像Hadoop只提供批任务处理）。其用户包括推特、美国天气频道、WebMD、阿里巴巴、Yelp、雅虎日本、Spotify、Group、Flipboard及其他许多公司。