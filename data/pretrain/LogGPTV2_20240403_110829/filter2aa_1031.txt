### 公司介绍

**宜信**成立于2006年，是一家专注于普惠金融和财富管理的金融科技企业。公司在支付、网贷、众筹、机器人投顾、智能保险、区块链等前沿领域积极布局，并通过业务孵化和产业投资参与全球金融科技创新。自成立以来，宜信始终坚持以理念创新、模式创新和技术创新驱动发展，致力于服务中国高成长性人群、大众富裕阶层和高净值人士，真正让金融更美好。

**愿景：宜人宜己，美好生活**

### 部门介绍

**宜信安全部**隶属于宜信总公司，负责总部及所有子公司的安全需求，为公司业务提供安全保障。自部门成立四年以来，我们弥补了公司在安全基础设施建设上的不足，逐步构建了一个覆盖网络、应用、主机、终端和数据的安全架构。每一步都承载着保护亿万用户信息和财产安全的责任。

- **2018年技术升级**：我们在传统安全架构上引入了人工智能与大数据技术，将资产、漏洞、风控和管理有机结合，构建用户画像，为实现安全态势感知与威胁情报预警奠定了基础。
- **开源贡献**：我们自主研发的【洞察】漏洞管理平台已在GitHub上开源，帮助更多金融科技行业的伙伴完成自动化风险全生命周期管理，并实现风险量化，共同建设互联网金融行业的安全生态。

### 问题和痛点

- **工具种类繁多**：学习和切换成本较高
- **人工操作繁琐**：使用工具获取资产数据和处理结果耗时费力
- **功能单一且无法协同**：安全工具功能单一，无法协同使用
- **运维成本高**：安全产品的学习和运维成本高
- **网络环境多样化**：IDC（多IDC）、办公网、公网等复杂环境下的单一扫描节点难以满足需求

### 解决思路

#### 0x01 分布式扫描

**基于任务队列的分布式扫描**
- **挑战**：
  1. 扫描功能解耦困难
  2. 结果聚合实现繁琐
  3. 调用接口不统一
- **优势**：
  1. 易于任务数据分片和结果聚合
  2. 调用链简单
  3. P2P方式传输数据，效率高

**示例**：子域名扫描 -> 端口扫描 -> 弱口令扫描
- 域名列表：域名1, 域名2, ..., 域名n
- 子域名扫描：IP1, IP2, ..., IPm
- 端口扫描：端口1, 端口2, ..., 端口o
- 弱口令扫描
- 结果聚合

#### 0x02 功能可扩展

**插件开发**
- **简化开发过程**：抽象重复工作并封装，例如安全通信、任务监控、数据传输等
- **支持多种执行粒度**：协程、线程、进程
- **自动依赖检测**：Python依赖自动检测并安装
- **结果保存**：以JSON格式保存结果，便于后续使用

**示例**：HelloWorld插件
- **任务状态**：CRON表达式、任务参数、执行次数、执行时间、优先级等信息
- **Blade扫描器与分布式平台**：单机/集群模式，便于开发和测试
- **响应方式**：平台响应、邮件响应、第三方即时通讯接口响应

#### 0x03 架构可扩展

**分布式架构**
- **Web层**：Nginx + Flask APP
- **调度层**：Scheduler + Redis (消息队列)
- **通信层**：ZMQ + IOLoop (异步高并发)
- **数据库层**：SQLite (读写分离)

**架构扩展**
- **负载均衡**：Gunicorn
- **前后端分离**：JWT认证和鉴权
- **定时任务**：Python原生实现
- **集群部署**：Redis Cluster + Broker

#### 0x04 节点可扩展

**节点部署**
- **一键安装**：pip install blade.whl
- **配置启动**：配置Scheduler Server地址并启动
- **自动化运维**：支持配置文件，方便自动化分发部署
- **Docker支持**：提供Dockerfile生成

**节点授权与通信**
- **TCP+JSON通信**：自定义协议
- **Scheduler授权**：Token认证
- **超时重传机制**：支持单向通信，网络故障时保存数据尝试重连，超时时间可配置

#### 0x05 展望

- **失效转移**：提高系统容错能力
- **阻塞方式的数据转发**：实现分布式同步请求服务

希望以上内容能为您提供清晰、连贯和专业的参考。如有更多需求，请随时告知。