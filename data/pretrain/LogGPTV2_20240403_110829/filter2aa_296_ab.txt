the shadow files, while reading unchanged data from the shared system image. The 
shadow files are re-created at boot time, so any changes made by the user to his or her 
startup volume are lost at restart.
For example, if a user saves a document to the startup volume, after a restart that 
document will be gone. This behavior preserves the condition of the environment the 
administrator set up. Therefore it is recommended that users have accounts on a file 
server on the network to save their documents.
Balancing the Shadow File Load
NetBoot creates an AFP share point on each server volume you specify (see “Choosing 
Where Shadow Files Are Stored” on page 35) and distributes client shadow files across 
them as a way of balancing the load for NetBoot clients. There is no performance gain 
if the volumes are partitions on the same disk. See “Distributing Shadow Files” on 
page 47.
Warning:  Don’t rename a NetBoot share point or the volume on which it resides. 
Don’t use Workgroup Manager to stop sharing for a NetBoot share point unless you 
first deselect the share point for images and shadow files in Server Admin.
LL2348.Book  Page 9  Thursday, August 21, 2003  10:58 AM
10
Chapter 1    About System Image Administration
Allocation of Shadow Files for Mac OS X NetBoot Clients
When a client computer starts up from a Mac OS X boot image, it creates its shadow 
files on a server NetBootClientsn share point or, if no share point is available, on a drive 
local to the client. For information about changing this behavior, see “Changing How 
Mac OS X NetBoot Clients Allocate Shadow Files” on page 24.
NetBoot Image Folders
A NetBoot image folder contains the startup image file, a boot file that the firmware 
uses to begin the startup process, and other files required to start up a client computer 
over the network. The name of a NetBoot image folder has the suffix “.nbi.”
An NBI folder for Mac OS 9 is slightly different from an NBI folder for Mac OS X since the 
components required for startup are different. 
Mac OS X NetBoot image folder
You use Network Image Utility to set up Mac OS X NBI folders. The utility lets you:
• Name the image
• Choose the image type (NetBoot or Network Install)
• Provide an image ID
• Choose the default language
• Specify a default user name and password
• Enable automatic installation for install images
• Add additional package or preinstalled applications
See “Creating a Mac OS X Boot Image” on page 19.
Mac OS 9 NetBoot image folder
File
Description
booter
Boot file
mach.macosx
UNIX kernel
mach.macosx.mkext
Drivers
System.dmg
Startup image file (may include application software)
NBImageInfo.plist
Property list file
File or folder
Description
Mac OS ROM
Boot file
NetBoot HD.img
System startup image file
Application HD.img
Application image file
NBImageInfo.plist
Property list file
Backup
Folder created by NetBoot Desktop Admin (while it is running) for 
the backup image
LL2348.Book  Page 10  Thursday, August 21, 2003  10:58 AM
Chapter 1    About System Image Administration
11
You use NetBoot Desktop Admin to modify the Mac OS 9 NBI folder. This utility lets you 
change the image file (NetBoot HD.img), change the name of the image, adjust the size 
of the image, and add software to the application image.
Property List File
The property list file (NBImageInfo.plist) stores image properties. The property lists for 
Mac OS 9 and Mac OS X are described in the following tables. Initial values in the 
NBImageInfo.plist are set by the tools you use to work with the image files—NetBoot 
Desktop Admin (for Mac OS 9 images) and Network Image Utility (for Mac OS X 
images)—and you usually don’t need to change the property list file directly. Some 
values are set by Server Admin. If you need to edit a property list file, however, you can 
use TextEdit or Property List Editor, which you can find in the Utilities folder on the 
Mac OS X Server Administration Tools CD.
Mac OS 9 property list
Property
Type
Description
BootFile
String
Name of boot ROM file:  
Mac OS ROM.
Index
Integer
1–4095 indicates a local image 
unique to the server.
4096–65535 is a duplicate, 
identical image stored on 
multiple servers for load 
balancing.
IsDefault
Boolean
True specifies this image file as 
the default boot image on the 
subnet. 
IsEnabled
Boolean
Sets whether the image is 
available to NetBoot (or Network 
Image) clients.
IsInstall
Boolean
True specifies a Network Install 
image; False specifies a NetBoot 
image.
Name
String
Name of the image as it appears 
in the Startup Disk control panel 
(Mac OS 9) or Preferences pane 
(Mac OS X).
Type
String
Classic.
SupportsDiskless
Boolean
True directs the NetBoot server 
to allocate space for the shadow 
files needed by diskless clients.
LL2348.Book  Page 11  Thursday, August 21, 2003  10:58 AM
12
Chapter 1    About System Image Administration
Mac OS X property list
Property
Type
Description
BootFile
String
Name of boot ROM file:  booter.
Index
Integer
1–4095 indicates a local image 
unique to the server.
4096–65535 is a duplicate, 
identical image stored on 
multiple servers for load 
balancing.
IsDefault
Boolean
True specifies this image file as 
the default boot image on the 
subnet. 
IsEnabled
Boolean
Sets whether the image is 
available to NetBoot (or Network 
Image) clients.
IsInstall
Boolean
True specifies a Network Install 
image; False specifies a NetBoot 
image.
Name
String
Name of the image as it appears 
in the Startup Disk control panel 
(Mac OS 9) or Preferences pane 
(Mac OS X).
RootPath
String
Specifies path to disk image on 
server, or the path to an image 
on another server. See “Using 
Images Stored on Other Servers” 
on page 13.
Type
String
NFS or HTTP.
SupportsDiskless
Boolean
True directs the NetBoot server 
to allocate space for the shadow 
files needed by diskless clients.
Description
String
Arbitrary text describing the 
image.
Language
String
A code specifying the language 
to be used while booted from 
the image.
LL2348.Book  Page 12  Thursday, August 21, 2003  10:58 AM
Chapter 1    About System Image Administration
13
Boot Server Discovery Protocol (BSDP)
NetBoot uses an Apple-developed protocol based on DHCP called Boot Server 
Discovery Protocol (BSDP). This protocol provides a way of discovering NetBoot servers 
on a network. NetBoot clients obtain their IP information from a DHCP server and their 
NetBoot information from BSDP. BSDP offers built-in support for load balancing. See 
“Performance and Load Balancing” on page 45.
BootP Server
NetBoot uses a BootP server (bootpd) to provide necessary information to client 
computers when they try to boot from an image on the server.
If you have BootP clients on your network, they might request an IP address from the 
NetBoot BootP server, and this request will fail because the NetBoot BootP server 
doesn’t have addresses to offer. To prevent the NetBoot BootP server from responding 
to requests for IP addresses, use NetInfo Manager to open the NetBoot server’s local 
NetInfo directory and add a key named bootp_enabled with no value to the directory 
/config/dhcp.
TFTP and the Boot Files
NetBoot uses the Trivial File Transfer Protocol (TFTP) to send boot files from the server 
to the client.
The boot files are set up by Network Image Utility when you create an image, and are 
stored on the server in /Library/NetBoot/NetBootSPn/image.nbi (where n is the volume 
number and image is the name of the image). For Mac OS 9 there is a single file named 
Mac OS ROM. For Mac OS X images, there are three files:  booter, mach.macosx, and 
mach.macosx.mkext. The NetBootSPn directory is automatically set up on your server’s 
boot volume if you enable NetBoot when you install Mac OS X Server. Otherwise, 
NetBootSPn share points are set up on each volume you choose for storing images in 
the NetBoot settings in Server Admin.
Using Images Stored on Other Servers
You can store Mac OS X boot or install images on NFS servers other than the NetBoot 
server itself. For more information, see “Using Images Stored on Other NFS Servers” on 
page 36.
Security
You can restrict access to NetBoot service on a case-by-case basis by listing the 
hardware (also called the Ethernet or MAC) addresses of computers that you want to 
allow or deny access. A client computer’s hardware address is automatically added to 
the NetBoot Filtering list when the client starts up using NetBoot and is, by default, 
enabled to use NetBoot. You can specify others. See “Restricting NetBoot Clients by 
Filtering Addresses” on page 38.
LL2348.Book  Page 13  Thursday, August 21, 2003  10:58 AM
14
Chapter 1    About System Image Administration
Before You Set Up NetBoot
Before you set up a NetBoot server, review the following considerations and 
requirements.
What You Need to Know
To set up NetBoot on your server, you should be familiar with your network 
configuration, including the DHCP services it provides. Be sure you meet the following 
requirements: 
• You’re the server administrator.
• You’re familiar with network setup.
• You know the DHCP configuration.
You might also need to work with your networking staff to change network topologies, 
switches, routers, and other network settings.
Client Computer Requirements
Most Macintosh computers that can run Mac OS 9.2.2 or later can use NetBoot to start 
up from a Mac OS X disk image on a server. At the time of this publication, this includes 
the following Macintosh computers:
• Slot-loading G3 iMac (tray-loading iMacs are not supported)
• G4 iMac
• iBook
• eMac
• Power Mac G5
• Power Mac G4
• Power Mac G4 Cube
• PowerBook G3 (FireWire)
• PowerBook G4
• Xserve
You should install the latest firmware updates on all client computers. Firmware 
updates are available from the Apple support website:  www.apple.com/support/.
Power Mac G5 clients can’t boot from images prepared for Power Mac G4 or earlier 
processors, nor can Power Mac G4 or earlier processors boot from images prepared for 
Power Mac G5 processors. If you have both types of clients, you must set up two 
separate images.
Older Macintosh computers—tray-loading iMac computers and Power Macintosh G3 
(blue and white) computers—need older versions of firmware that require version 1.0 
of the NetBoot software, and are no longer supported. Mac OS X Server version 10.3 
supports only NetBoot version 2.0.
LL2348.Book  Page 14  Thursday, August 21, 2003  10:58 AM
Chapter 1    About System Image Administration
15
Client Computer RAM Requirements
The following are the minimum RAM requirements for a client computer starting up 
from a Mac OS 9 or Mac OS X boot image.
• Start up from Mac OS 9 disk image:  64 MB
• Start up from Mac OS X disk image:  128 MB
Client computers using Network Install must also have 128 MB of RAM.
Software Updates for NetBoot System Disk Images
You should use the latest system software when creating NetBoot disk images. 
New Macintosh computers require updates of system software, so if you have new 
Macintosh clients you’ll need to update your boot images.
To update a Mac OS X disk image, see “Adding an OS Update Package to a Mac OS X 
Boot Image” on page 22.
To update a Mac OS 9 disk image, see “Modifying a Mac OS 9 Boot Image” on page 25.
Ethernet Support on Client Computers
NetBoot is supported only over the built-in Ethernet connection. Multiple Ethernet 
ports are not supported on client computers. Clients should have at least 100 Mbit 
Ethernet adapters.
Network Hardware Requirements
The type of network connections you should use depends on the number of clients 
you expect to boot over the network:
• 100 Mb Ethernet (for booting fewer than 10 clients)
• 100 Mb switched Ethernet (for booting 10–50 clients)
• Gigabit Ethernet (for booting more than 50 clients)
These are estimates for the number of clients supported. See “Capacity Planning” on 
page 16 for a more detailed discussion of the optimal system and network 
configurations to support the number of clients you have.
Network Service Requirements
Depending on the types of clients you want to boot or install, your NetBoot server 
must also provide the following supporting services.
Service provided by 
NetBoot Server
For booting Mac OS X 
computers with hard 
disks
For booting Mac OS X 
computers without 
hard disks
For booting Mac OS 9 
computers
DHCP
optional
optional
optional
NFS
required if no HTTP
required if no HTTP
AFP
required
required
HTTP
required if no NFS
required if no NFS
TFTP
required
required
required
LL2348.Book  Page 15  Thursday, August 21, 2003  10:58 AM
16
Chapter 1    About System Image Administration
Note:  DHCP service is listed as optional because, although it is required for NetBoot, it 
can be provided by a server other than the NetBoot server. Services marked “required” 
must be running on the NetBoot server.
NetBoot and AirPort
The use of AirPort wireless technology to NetBoot clients is not supported by Apple 
and is discouraged.