gesting that spammers have automated tools at their disposal
to facilitate the creation of new email templates and automate
the registration of new domains used for disposable “one-time
URL’s”.
Figure 9(7) shows a graph visualization of one of the large-
scale campaigns that involved multiple hijacked IP preﬁxes,
which illustrates the typical modus operandi of agile spammers
operating such stealthy campaigns. In this particular example,
we can observe the following key points:
•
•
•
over 662 spam emails have been sent from 12 different
hijacked IP preﬁxes (yellow nodes), each of them
used in turn by spammers to distribute spam using
a bunch of one-time URL’s, most of them including
domain names (blue nodes) registered at ENOM (large
pink node) using privacy-protected email addresses
provided by whoisprivacyprotect.com (red nodes);
spam advertised content (domain URL’s) share the
same server IP addresses (lightgrey nodes);
the campaign has a lifetime of 84 days, yet only 24
active days (purple nodes laid out in a clockwise fash-
ion), during which spammers are hopping from one
hijacked IP preﬁx to another, which is an effective way
of circumventing IP-based spam ﬁlters and reputation
systems.
To the best of our knowledge, these results are completely
novel and shed a new light on the behavior of agile BGP
hijacking spammers. First, we observe that stealthy spam
campaigns can be performed by exploiting multiple hijacked
IP address blocks. Secondly, we observe that the same invalid
direct upstream providers were involved in all these hijacks,
which already gives some indication of possible counter-
measures. Finally, all URL’s advertised in spam emails are
sharing a common hosting infrastructure and were registered
in a similar way – suggesting that whois registration data can
also be leveraged in prevention systems. The key take-away of
this root cause analysis is that it enables us to link together
different hijacked preﬁxes showing they are used by the same
spamming actors for a long period of time in a very stealthy
way.
E. Summary
Finding 1: We uncovered two types of hijack phenomena:
long-lived and short-lived. Long-lived hijacks can last from a
week to several months, whereas short-lived hijacks last from
a few minutes to several days.
Finding 2: Attackers were found to stealthily hijack prop-
erly registered but unannounced IP address space by using two
different hijacking techniques (as deﬁned in Section IV-C on
page 6): preﬁx hijacking and AS hijacking. In preﬁx hijacking,
the attacker announced an IP address block using an invalid
BGP origin AS via a valid direct upstream provider (ﬁrst hop)
AS. In AS hijacking, the attacker announced an IP address
block using its valid BGP origin AS but via an invalid direct
upstream provider (ﬁrst hop) AS.
Finding 3: In the 2,454 preﬁx hijacks we found only six
different invalid BGP origin ASes. In the 201 AS hijacks we
found, for 195 different valid BGP origin ASes, only three
different invalid upstream provider ASes. One AS, involved
in the hijack of 793 IP address blocks over 16 months, was
observed ﬁrst as an invalid upstream provider AS, and then
as an invalid BGP origin AS. These 793 hijacks were later
conﬁrmed by the ISP providing transit to that AS, who con-
sequently terminated the contract with this customer abusing
the routing infrastructure.
Finding 4: Spamming using hijacked IP preﬁxes appears
to be an effective technique for defeating known protections,