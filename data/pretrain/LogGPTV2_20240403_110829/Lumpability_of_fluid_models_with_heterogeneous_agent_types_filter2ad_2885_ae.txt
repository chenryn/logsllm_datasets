To this aim, let us consider the ODE system
˙x1 = −α1x1,
˙x2 = −α2x2,
(23)
and the aggregation matrix M deﬁned as M = (1, 1), with
right inverse ¯M = (a, 1 − a)(cid:62), a ∈ [0, 1]. The ODE which
describes the aggregated system is therefore
˙y = −(α1a + α2(1 − a))y .
(24)
By making use of Theorem 3 we can immediately infer that
the lumping cannot be exact if α1 (cid:54)= α2. Suppose now that
α1 (cid:54)= α2, and let us try to estimate the lumping error by ε-
lumpability. Here it is easy to show the vector ﬁeld is Lipschitz
in the parameters. Furthermore, condition (12) holds with ε1 =
(1− a)(α2− α1) and ε2 = a(α1− α2). With these, the system
(24) is the exactly lumped ODE by M of
1 = −(α1 + ε1)xε
˙xε
1,
2 = −(α2 + ε2)xε
˙xε
2 .
(25)
Perturbation theory considers the case when ε1 and ε2 are
small and one can approximate the solution of the perturbed
system (25) as a power-series expansion, e.g.,
xε
1(t) = A1(t, α) + B1(t, α)ε1 + O(ε2
xε
2(t) = A2(t, α) + B2(t, α)ε2 + O(ε2
1),
2),
(26)
where A1, A2, B1, B2 are functions to be determined. Sub-
stituting these two approximations into (25), ordering the
Fig. 4. Comparison of a-posteriori errors for two choices of the generalized
inverse matrix for K = 4, as a function of ∆ and of the initial conditions for
the ODE.
Figure 4 shows the results for two different choices of
the generalized inverse matrix, corresponding to the minimizer
and the maximizer of the a-priori error bound (cf. Figure 1).
Comparing the two plots shows that the error statistics are
visually indistinguishable. Indeed, for all values of ∆ they
were found to be equal up to the sixth decimal digit, indicating
excellent insensitivity on the actual choice of the inverse matrix
in practice. The ﬁgures also demonstrate the robustness to the
initial ODE conditions, with all error statistics being of the
same order of magnitude. We notice that the maximum error
attained in this cases, i.e., 1.36E-5, is very satisfactory (being
four orders of magnitude smaller than the values of the initial
conditions), despite the high degree of heterogeneity in the
system with ∆ = 20.0.
To summarize this section, these ﬁndings support the hy-
pothesis that ODE systems and aggregation matrices enjoying
ε-lumpability behave very well a posteriori, with errors that
are negligible for all practical purposes, even for sensibly large
perturbations of the model parameters.
VI. RELATED WORK
In performance modeling,
the notion of lumpability is
well understood for Markov chains, with results dating as far
back as the Sixties with the work of Kemeny and Snell [11],
and further researched by others [25], [23], [4]. Approximate
lumpability has also been studied with aggregation errors that
can be bounded [4], [7].
For dynamical systems, lumpability has been extensively
studied for linear systems (e.g., [31], [13]). In this paragraph,
we focus our attention on results concerning nonlinear systems,
since these are the typical kind of models that well describe
computing systems; speciﬁcally, the three case studies consid-
ered in this paper are all in this form.
Less is known for nonlinear systems in general, therefore
methods have been developed for special classes. Two model-
reduction approaches are based on empirical gramians (e.g.,
[15], [10]) and on proper orthogonal composition, e.g., [22],
[5]. Both techniques, however, require the availability of empir-
ical data of the original model (for instance by simulation or by
experimentation). Therefore, unlike our approach, an a-priori
bound cannot be obtained. A-priori and a-posteriori bounds
are provided in [32], which considers nonlinear systems with
dynamics expressible by means of kernel expansions. However,
such a form cannot encode some models of interest for
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:45:27 UTC from IEEE Xplore.  Restrictions apply. 
0510152000.20.40.60.811.21.4x 10−5∆A−posteriori errorBound minimizer  minavgmax0510152000.20.40.60.811.21.4x 10−5∆A−posteriori errorBound maximizer  minavgmaxterms for increasing powers of ε1 and ε2 and equalizing the
coefﬁcients of the same power, we obtain the following ODE
system for the unknowns A1, A2, B1, B2.
˙A1(t, α) = −α1A1(t, α),
˙A2(t, α) = −α2A2(t, α),
˙B1(t, α) = −A1(t, α) − α1B1(t, α),
˙B2(t, α) = −A2(t, α) − α2B2(t, α).
We remark that the functions A1, A2 correspond to the solution
of the original ODE system (23).
The lumping error can then be expressed as
|y(t) − (x1(t) + x2(t))| = |y(t) − (x1(t) + x2(t)) + xε
2(t))|
1(t)
2(t) − x1(t) + x2(t)|,
where we have used that y(t) − (xε
2(t)) = 0. If the
error was evaluated by using the perturbation-theory approxi-
mation (26), instead of Theorem 4, we would obtain
+ xε
1(t) + xε
2(t) − (xε
1(t) + xε
1(t) + xε
= |xε
|(xε
1(t) + xε
2(t)) − (x1(t) + x2(t))| =
= |ε1B1(t, α) + ε2B2(t, α) + O((cid:107)ε(cid:107)2)| .
However, here we notice that the error estimate depends on the
solution of an ODE system of size equal to the original one. In
this case, attempting to bound the functions B1 and B2 appears
more difﬁcult than with Theorem 4, because, for example, the
sufﬁcient conditions of Proposition 1 do not apply here.
VII. CONCLUSION
The presence of various types of agents in models of
computer and communication systems is not uncommon. Such
a situation may arise, for instance, when users are connected
to a network with links of different capacity, or when certain
jobs have different priorities/requirements on a server. Un-
fortunately, explicitly incorporating heterogeneity in a model
comes with an increased computational cost. In the context of
large-scale systems analyzed by ﬂuid techniques, this paper has
studied a class of models for which, essentially, distinct agent
types are structurally similar but their dynamics is associated
with rates that can be different. For such a class, model
reduction may be achieved by homogenizing different types of
agents by a perturbation of the rates. By collapsing their related
variables onto a single macro-variable, an approximation error
is incurred that is (in the worst case) linear with the degree of
heterogeneity. That is, the more different the rates of the agent
types, the more error is introduced when aggregating them.
The numerical tests presented in this paper are encour-
aging as to the practical usability of ε-lumpability. Under a
variety of different conditions we found that the aggregation
is very robust in all cases, yielding a-posteriori errors that
are negligible for all practical purposes. In this respect, we
feel that our most important contribution resides in having
characterized sufﬁcient conditions on the vector ﬁeld and on
the aggregation scheme for which such a robustness with
respect of the degree of heterogeneity of the original model
does exist. We wish to point out that the conditions to be
veriﬁed for ε-lumpability never require the solution of the
original system, but are essentially based on the structure of
its vector ﬁeld. In particular, we remark that the veriﬁcation of
our fundamental condition in (12) can in some cases be easily
automated. Speciﬁcally, models with dynamics such as multi-
class mass-action laws for epidemic spread and generalized
processor sharing lead to a system of linear equations to be
solved for ε, which can be straightforwardly implemented, for
instance on a computer algebra system.
ACKNOWLEDGEMENT
This work was supported by the EU project ASCENS,
257414, and by the DFG project FEMPA. The authors wish
to thank Max Tschaikowski for discussions, and the Leibniz-
Rechenzentrum for the computing facilities.
REFERENCES
[1]
J. Anselmi and I. M. Verloop. Energy-aware capacity scaling in
virtualized environments with performance guarantees. Performance
Evaluation, 68(11):1207–1221, 2011.
[2] A. Antoulas. Approximation of Large-Scale Dynamical Systems. Ad-
vances in Design and Control. SIAM, 2005.
[3] P. Auger, R. de la Parra, J. Poggiale, E. S´anchez, and T. Nguyen-Huu.
Aggregation of variables and applications to population dynamics. In
Structured Population Models in Biology and Epidemiology, volume
1936 of Lecture Notes in Mathematics, pages 209–263. Springer, 2008.
[4] P. Buchholz. Exact and Ordinary Lumpability in Finite Markov Chains.
Journal of Applied Probability, 31(1):59–75, 1994.
[5] Y. Chu, M. Serpas, and J. Hahn. State-preserving nonlinear model
reduction procedure. Chemical Engineering Science, 66(17):3907–
3913, 2011.
[6] D. Degenring, C. Froemel, G. Dikta, and R. Takors. Sensitivity analysis
for the reduction of complex metabolism models. Journal of Process
Control, 14(7):729–745, 2004.
[7] G. Franceschinis and R. R. Muntz. Bounds for quasi-lumpable Markov
chains. Perform. Eval., 20(1-3):223 – 243, 1994.
J. J. Gart. The mathematical analysis of an epidemic with two kinds of
susceptibles. Biometrics, 24(3):557–566, 1968.
[8]
[10]
[9] N. Gast and B. Gaujal. A Mean Field Model of Work Stealing in
Large-Scale Systems. ACM SIGMETRICS, pages 13–24, 2010.
J. Hahn and T. F. Edgar. An improved method for nonlinear model re-
duction using balancing of empirical gramians. Computers & Chemical
Engineering, 26(10):1379–1397, 2002.
J. Kemeny and J. Snell. Finite Markov Chains. Van Nostrand, 1960.
[11]
[12] W. O. Kermack and A. G. McKendrick. A contribution to the
mathematical theory of epidemics. Proceedings of the Royal Society
of London. Series A., 115(772):700–721, 1927.
J. C. W. Kuo and J. Wei. Lumping analysis in monomolecular reaction
Industrial &
systems. analysis of approximately lumpable system.
Engineering Chemistry Fundamentals, 8(1):124–133, 1969.
[13]
[14] T. G. Kurtz. Solutions of ordinary differential equations as limits of
pure Markov processes. J. Appl. Prob., 7(1):49–58, April 1970.
[15] S. Lall, J. E. Marsden, and S. Glavaˇski. A subspace approach to
balanced truncation for model reduction of nonlinear control systems.
International Journal of Robust and Nonlinear Control, 12(6):519–535,
2002.
[16] W.-C. Liao, F. Papadopoulos, and K. Psounis. Performance analysis
of BitTorrent-like systems with heterogeneous users. Performance
Evaluation, 64(9–12):876–891, 2007.
[17] F. Lo Piccolo and G. Neglia. The effect of heterogeneous link capacities
in BitTorrent-like ﬁle sharing systems. In International Workshop on
Hot Topics in Peer-to-Peer Systems, pages 40–47, 2004.
J. A. Murdock. Perturbations: Theory and Methods. Society for
Industrial and Applied Mathematics, 1999.
[18]
[19] M. S. Okino and M. L. Mavrovouniotis. Simpliﬁcation of mathematical
models of chemical reaction systems. Chemical Reviews, 2(98):391–
408, 1998.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:45:27 UTC from IEEE Xplore.  Restrictions apply. 
[20] T. P. Prescott and A. Papachristodoulou. Guaranteed error bounds for
structured complexity reduction of biochemical networks. Journal of
Theoretical Biology, 304:172–182, 2012.
[21] D. Qiu and R. Srikant. Modeling and performance analysis of
In Proceedings of ACM SIG-
BitTorrent-like peer-to-peer networks.
COMM 2004, pages 367–378, 2004.
[22] M. Rathinam and L. R. Petzold. A new look at proper orthogonal
decomposition. SIAM J. Numer. Anal., 41(5):1893–1925, 2003.
[23] P. J. Schweitzer. Aggregation Methods for Large Markov Chains. In
Proceedings of the International Workshop on Computer Performance
and Reliability, pages 275–286, Amsterdam, The Netherlands, The
Netherlands, 1984. North-Holland Publishing Co.
[24] G. Sharma, A. Ganesh, and P. Key. Performance analysis of contention
based medium access control protocols. IEEE Transactions on Infor-
mation Theory, 55(4):1665–1682, 2009.
[25] U. Sumita and M. Rieders. Lumpability and time reversibility in the
aggregation-disaggregation method for large Markov chains. Commun.
Statist. - Stoch. Models, 5, 1989.
[27]
[26] P. Tabuada, A. D. Ames, A. Julius, and G. J. Pappas. Approximate
reduction of dynamic systems. Systems & Control Letters, 57(7):538–
545, 2008.
J. Toth, G. Li, H. Rabitz, and A. S. Tomlin. The effect of lumping and
expanding on kinetic differential equations. SIAM Journal on Applied
Mathematics, 57(6):1531–1556, 1997.
[28] M. Tschaikowski and M. Tribastone.
Markovian process algebra.
Concurrency Theory, LNCS, pages 380–394, September 2012.
Exact ﬂuid lumpability for
In 23rd International Conference on
[29] B. Van Houdt and L. Bortolussi. Fluid limit of an asynchronous optical
packet switch with shared per link full range wavelength conversion.
In SIGMETRICS, pages 113–124, 2012.
[30] R. K. Watson. On an epidemic in a stratiﬁed population. Journal of
Applied Probability, 9(3):pp. 659–666, 1972.
J. Wei and J. C. W. Kuo.
Lumping analysis in monomolecular
reaction systems. analysis of the exactly lumpable system. Industrial
& Engineering Chemistry Fundamentals, 8(1):114–123, 1969.
[31]
[32] D. Wirtz and B. Haasdonk. Efﬁcient a-posteriori error estimation for
nonlinear kernel-based reduced systems. Systems & Control Letters,
61(1):203–211, 2012.
[33] X. Zhang, G. Neglia, J. Kurose, and D. Towsley. Performance modeling
of epidemic routing. Computer Networks, 51(10):2867 – 2891, 2007.
[34] X. Zhou, S. Ioannidis, and L. Massoulie. On the stability and optimality
of universal swarms. In SIGMETRICS, pages 341–352. ACM, 2011.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 07:45:27 UTC from IEEE Xplore.  Restrictions apply.