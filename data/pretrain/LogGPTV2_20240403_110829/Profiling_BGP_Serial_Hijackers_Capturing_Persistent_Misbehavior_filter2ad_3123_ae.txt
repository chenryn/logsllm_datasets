new RIPE RIR entries appeared, listing AS19529 as origin of IPv4
blocks owned by a different institution and registered in the ARIN
region. At the same time, the legitimate owner of these prefixes
raised complaints in a RIPE forum, stating that such RIPE RIR
records were incorrect and that the respective address blocks were
hijacked [20]. The complaints continued until April 2018 and the
result, as of today, is unclear. In our data, we see AS19529 stopping
to originate prefixes in July 2018: in its last 9 months of activity, it
originates a total of 63 different prefixes, 20 of which are MOAS.
●dateunique originated prefixes201420152016201720182019050010001500●dateunique originated prefixes201420152016201720182019020406080●dateunique originated prefixes201420152016201720182019050100150Profiling BGP Serial Hijackers
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
8.3 An Ongoing Potential Hijacker
We see AS134190, for the first time in our data on July 14, 2016,
originating only a single prefix for about a month, after which it
disappears from the global routing table. In early 2017, AS134190
starts repeatedly originating different prefixes for very short time
periods (about a day). Starting in July 2017, AS134190 originates
a few prefixes on and off—the small dots in Figure 8c—with some
burst of activity reaching over 30 prefixes being simultaneously
originated. In this period, AS134190 averages almost 10 changes per
day in terms of originated prefixes. In November 2018, BGPmon, a
widely known BGP hijack detection system [2], detected a potential
hijack from AS134190 and 10 additional potential hijacks in early
2019. As of today, we have not found further evidence in the form of
public complaints about potential hijacks carried out by AS134190.
9 DISCUSSION
Our study was motivated by repeated complaints in the operational
community about reiterated, even persistent, prefix hijacking activi-
ties carried out by certain ASes. On the one hand, BGP’s native lack
of validation mechanisms exposes it not just to one-off or stealthy
attacks but also to routinely executed, in-the-open, forms of abuse.
On the other hand, BGP’s inherent transparency, combined with
the availability of pervasive and “public” BGP measurement infras-
tructure (e.g., RouteViews, RIPE RIS) provides the opportunity to
uncover systematic malicious behavior, also through the application
of automated methods.
In this work, we analyzed the origination behavior of a small set
of manually identified serial hijacker ASes, finding that they show
distinct origination patterns, separating them from most benign
ASes. We further showed that, in spite of limited ground truth and
severe class imbalance, it is possible to train a machine-learning
classifier that effectively narrows our focus to a set of networks
exhibiting similar behavior to serial hijackers: this set accounts for
5.5% (≈ 900) of the examined ASes, 1.4% of all ASes visible in IPv4
BGP. Our analysis also reveals clear potential and specific directions
to further reduce this set, to the point that fully automated detection
approaches and scoring systems can be envisioned in the future.
Practical relevance: To the best of our knowledge, this is the first
work that examines the BGP origination behavior of serial hijackers,
a category of networks that has received surprisingly little attention
in terms of broad and detailed empirical assessment. We argue that
serial hijacking behavior needs attention from both operators and
the broader research community to allow for faster mitigation or
even prevention of hijacking events.
While, as expected, not all ASes flagged by our classifier are
serial hijackers, we note that all such networks do show a highly
distinctive origination pattern. Scrutinizing these networks, we
found widespread indications of malicious behavior, with flagged
ASes being more likely to be in blacklists associated with malicious
behavior, as well as different indicators of misconfiguration. Since
our system is orthogonal to commonly deployed reputation systems
(e.g., event-based hijack detection), and works out-of-the-box using
readily available public BGP data, we believe that, after refinement,
the output of our classifier might be used to provide additional
scoring data, e.g., in scoring-based reputation systems.
Even after disclosure, hijack reports and discussions on mailing
lists typically focus on isolated incidents (i.e., usually the prefixes
of the network operator issuing the complaint), and the case of Bit-
canal shows that it took years to effectively cap hijacking activity
and disconnect Bitcanal. Our metrics can compactly, and yet com-
prehensively, capture the dominant origination characteristics of
misbehaving networks. Thus, even after initial disclosure on mail-
ing lists, our metrics and analysis provide an instant picture of the
Internet-wide “state-of-affairs” of the networks in question, which
can help operators to readily assess the full extent of hijacking
activity, and thus inform the process of coordinated mitigation.
Limitations: We note that our classifier is solely based on the rout-
ing activity of ASes. We focus on identifying routing characteristics
of serial hijackers, which present one particular case of hijacking
activity. Our detection mechanism does, naturally, not cover the
space of hijacking activity exhaustively. While we find that serial
hijackers do show distinct announcement patterns, our classifier
does falsely tag some legitimate ASes as having BGP behavior sim-
ilar to serial hijackers, as reflected in the precision of our classifier
of ≈ 80%. We hence want to stress that our classifier, while effective
in narrowing down the set of flagged ASes to ≈ 900 ASes, can and
should not be deployed, as is, to generate, e.g., filtering rules. Fur-
thermore, if deployed at any point in the future, there is a potential
risk that hijackers could craft their BGP announcements to not
exhibit the characteristics captured by our classifier and thus evade
detection. Another limitation of our work is that we focus solely
on distinct features of the BGP origination patterns of networks
and therefore on BGP origin hijacks. Hijacks which modify the AS
path leaving the legitimate origin AS unaltered are therefore not
captured in our data. Our work constitutes an initial view into the
properties of serial hijackers with much future work to be done.
Future work: In the future, we plan to extend the features we lever-
age for classification. Potential additional features include more
BGP-derived properties, such as AS-path characteristics of hijacked
prefixes, as well as sub- and super-MOAS events. We believe that
such features could not only further improve separation of ASes,
but also shed light on topological properties of hijackers, e.g., up-
stream networks and peering facilities leveraged by serial hijackers.
We further plan to cross-evaluate our findings with other external
datasets. In a first step, we correlated our identified ASes against
blacklists, finding indications of persistent malicious behavior.
Our work is based on 5 years of historic BGP routing data, and
we point out that some of the dominant characteristics of serial
hijackers only become visible when studying routing data at longer
timescales. We note, however, that our features to capture advertise-
ment volatility are in fact computed over much shorter timescales
i.e., bins of weeks and months, and our address space features might
well yield distinctive results when applied to shorter timescales.
This suggests that early detection of systematic misbehavior might
be indeed possible. We plan to further study the time-sensitivity of
our approach to assess closer-to-real-time detection possibilities.
Acknowledgments
We thank our shepherd Olaf Maennel and the anonymous reviewers
for their thoughtful feedback. We are also thankful for the feed-
back provided by the members of the Shadow PCs. This work was
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Testart et al.
partially supported by the MIT Internet Policy Research Initiative,
William and Flora Hewlett Foundation grant 2014-1601. We ac-
knowledge funding support from the NSF Grants CNS 1423659,
OAC 1848641, CNS 1705024, and OAC 1724853. This material is
based on research sponsored by Air Force Research Laboratory
under agreement number FA8750-18-2-0049. The U.S. Government
is authorized to reproduce and distribute reprints for Governmen-
tal purposes notwithstanding any copyright notation thereon. The
views and conclusions in this paper are those of the authors and do
not necessarily reflect the opinions of a sponsor, Air Force Research
Laboratory or the U.S. Government.
REFERENCES
[1] American Registry for Internet Numbers ARIN WHOIS. http://whois.arin.net/ui/.
[2] BGPmon Network Solutions Inc. https://bgpmon.net/.
[3] BitCanal hijack factory, courtesy of Cogent, GTT, and Level3. https://seclists.
org/nanog/2018/Jun/370.
[4] CAIDA - AS Rank. http://as-rank.caida.org.
[5] Mutually Agreed Norms for Routing Security (MANRS). https://www.manrs.org/.
[6] NANOG mailing list and archives. https://www.nanog.org/list/archives.
[7] Bahaa Al-Musawi, Philip Branch, and Grenville Armitage. BGP Anomaly Detec-
tion Techniques: A Survey. IEEE Communications Surveys & Tutorials, 19(1):377–
396, 2017.
[8] Andre Altmann, Laura Tolosi, Oliver Sander, and Thomas Lengauer. Permutation
importance: a corrected feature importance measure. Bioinformatics, 26(10):1340–
1347, May 2010.
[9] Maria Apostolaki, Aviv Zohar, and Laurent Vanbever. Hijacking Bitcoin: Routing
Attacks on Cryptocurrencies. In 2017 IEEE Symposium on Security and Privacy
(SP), pages 375–392, San Jose, CA, USA, May 2017. IEEE.
[10] Hitesh Ballani, Paul Francis, and Xinyang Zhang. A study of prefix hijacking
and interception in the Internet. In ACM SIGCOMM Computer Communication
Review, volume 37, pages 265–276. ACM, 2007.
[11] Leo Breiman. Out-Of-Bag Estimation. Technical report, Dec 1996.
[12] Randy Bush and Rob Austein. The Resource Public Key Infrastructure (RPKI) to
Router Protocol, Version 1. RFC 8210, IETF, Sep 2017.
[13] Kevin Butler, Toni R. Farley, Patrick McDaniel, and Jennifer Rexford. A Survey
of BGP Security Issues and Solutions. Proceedings of the IEEE, 98(1):100–122, Jan
2010.
[14] RIPE Network Coordination Centre. YouTube Hijacking: A RIPE NCC RIS case
study. https://www.ripe.net/publications/news/industry-developments/youtube-
hijacking-a-ripe-ncc-ris-case-study, Mar 2008.
[15] Shinyoung Cho, Romain Fontugne, Kenjiro Cho, Alberto Dainotti, and Phillipa
Gill. BGP hijacking classification. In Network Traffic Measurement and Analysis
Conference (TMA), 2019.
[16] National Institute for Stantards and Technology. RPKI Deployment Monitor.
[17] Pierre Geurts, Damien Ernst, and Louis Wehenkel. Extremely Randomized Trees.
https://rpki-monitor.antd.nist.gov/.
Mach. Learn., 63(1):3–42, Apr 2006.
[20] Ronald
[18] Yossi Gilad, Tomas Hlavacek, Amir Herzberg, Michael Schapira, and Haya Shul-
man. Perfect is the Enemy of Good: Setting Realistic Goals for BGP Security. In
Proceedings of the 17th ACM Workshop on Hot Topics in Networks - HotNets ’18,
pages 57–63, Redmond, WA, USA, 2018. ACM Press.
[19] Baptiste Gregorutti, Bertrand Michel, and Philippe Saint-Pierre. Correlation and
variable importance in random forests. Statistics and Computing, 27(3):659–678,
May 2017. arXiv: 1310.5726.
Guilmette.
Forum.
www.ripe.net/participate/mail/forum/anti-abuse-wg/
PDU2ODUzLjE1MzM4NTk2NzhAc2VnZmF1bHQudHJpc3RhdGVsb2dpYy5jb20+,
Aug 2018.
https://
RIPE
[21] Trevor Hastie, Robert Tibshirani, and J. H. Friedman. The elements of statistical
learning: data mining, inference, and prediction. Springer series in statistics.
Springer, New York, NY, 2nd ed edition, 2009.
[22] Xin Hu and Z. Morley Mao. Accurate Real-time Identification of IP Prefix Hi-
jacking. In 2007 IEEE Symposium on Security and Privacy (SP ’07), pages 3–17,
May 2007.
[23] Mattijs Jonker, Anna Sperotto, Roland van Rijswijk-Deij, Ramin Sadre, and Aiko
Pras. Measuring the Adoption of DDoS Protection Services. In ACM IMC, 2016.
[24] Thomas King. We Care About Data Quality at IXPs. https://ripe75.ripe.net/
presentations/54-20171016-TKJS-RIPE-We_Care_About_Data_Quality_at_
IXPs.pdf, Oct 2017.
[25] Maria Konte, Roberto Perdisci, and Nick Feamster. ASwatch: An AS Reputation
System to Expose Bulletproof Hosting ASes. In ACM SIGCOMM, 2015.
Jul 2013.
[26] Krebs on Security. Notorious ‘Hijack Factory’ Shunned from Web. https://
krebsonsecurity.com/tag/bitcanal/.
[27] Mohit Lad, Dan Massey, Dan Pei, Yiguo Wu, Beichuan Zhang, and Lixia Zhang.
PHAS: A Prefix Hijack Alert System. In Proceedings of the 15th Conference on
USENIX Security Symposium - Volume 15, USENIX-SS’06, Berkeley, CA, USA, 2006.
USENIX Association.
[28] Mohit Lad, Ricardo Oliveira, Beichuan Zhang, and Lixia Zhang. Understanding
Resiliency of Internet Topology against Prefix Hijack Attacks. In 37th Annual
IEEE/IFIP International Conference on Dependable Systems and Networks (DSN’07),
pages 368–377, Jun 2007.
[29] Matt Lepinski, Richard Barnes, and Stephen Kent. RFC 6480: An Infrastructure
to Support Secure Internet Routing, Feb 2012.
[30] Matt Lepinski, Derrick Kong, and Stephen Kent. RFC 6482: A Profile for Route
Origin Authorizations (ROAs), Feb 2012.
[31] Matthew Luckie, Bradley Huffaker, Amogh Dhamdhere, Vasileios Giotsas, and
kc claffy. AS Relationships, Customers Cones, and Validations. In ACM IMC,
2013.
[32] Doug Madory. Sprint, Windstream: Latest ISPs to hijack foreign networks | Dyn
Blog. https://dyn.com/blog/latest-isps-to-hijack/, Sep 2014.
[33] Doug Madory. The Vast World of Fraudulent Routing | Dyn Blog. https://dyn.
com/blog/vast-world-of-fraudulent-routing/, Jan 2015.
[34] Doug Madory. Shutting down the BGP Hijack Factory | Dyn Blog. https://dyn.
com/blog/shutting-down-the-bgp-hijack-factory/, Jul 2018.
[35] Jon Mitchell. RFC 6996: Autonomous System (AS) Reservation for Private Use,
[36] Asya Mitseva, Andriy Panchenko, and Thomas Engel. The state of affairs in BGP
security: A survey of attacks and defenses. Computer Communications, 124:45–60,
Jun 2018.
[37] Martin O. Nicholes and Biswanath Mukherjee. A survey of security techniques
for the border gateway protocol (BGP). IEEE Communications Surveys Tutorials,
11(1):52–65, 2009.
[38] Pierluigi Paganini. BGP hijacking - Traffic for Google, Apple, Facebook, Microsoft
and other tech giants routed through Russia. https://securityaffairs.co/wordpress/
66838/hacking/bgp-hijacking-russia.html, Dec 2017.
[39] Terence Parr, Kerem Turgutlu, Christopher Csiszar, and Jeremy Howard. Beware
Default Random Forest Importances. http://explained.ai/decision-tree-viz/index.
html, Mar 2018.
[40] Fabian Pedregosa, Gaël Varoquaux, Alexandre Gramfort, Vincent Michel,
Bertrand Thirion, Olivier Grisel, Mathieu Blondel, Peter Prettenhofer, Ron
Weiss, Vincent Dubourg, Jake Vanderplas, Alexandre Passos, David Courna-
peau, Matthieu Brucher, Matthieu Perrot, and Édouard Duchesnay. Scikit-learn:
Machine learning in python. J. Mach. Learn. Res., 12:2825–2830, Nov 2011.
[41] The Spamhaus Project. DROP - Don’t Route or Peer lists - The Spamhaus Project.
https://www.spamhaus.org/drop/.
[42] Jian Qiu and Lixin Gao. Hi-BGP: A Lightweight Hijack-proof Inter-domain
Routing Protocol. Technical report, 2006.
[43] Tongqing Qiu, Lusheng Ji, Dan Pei, Jia Wang, Jun Xu, and Hitesh Ballani. Locating
Prefix Hijackers Using LOCK. In Proceedings of the 18th Conference on USENIX
Security Symposium, SSYM’09, pages 135–150, Berkeley, CA, USA, 2009. USENIX
Association.
[44] B. Quoitin, C. Pelsser, L. Swinnen, O. Bonaventure, and S. Uhlig. Interdomain
traffic engineering with bgp. Comm. Mag., 41(5):122–128, May 2003.
[45] Anirudh Ramachandran and Nick Feamster. Understanding the network-level
behavior of spammers. In ACM SIGCOMM Computer Communication Review,
volume 36, pages 291–302. ACM, 2006.
[46] Johann Schlamp, Ralph Holz, Quentin Jacquemart, Georg Carle, and Ernst W.
Biersack. HEAP: Reliable Assessment of BGP Hijacking Attacks. IEEE Journal on
Selected Areas in Communications, 34(6):1849–1861, Jun 2016.
[47] John Scudder, Randy Bush, Pradosh Mohapatra, David Ward, and Rob Austein.
RFC 6811: BGP Prefix Origin Validation, Jan 2013.
[48] Pavlos Sermpezis, Vasileios Kotronis, Alberto Dainotti, and Xenofontas Dim-
itropoulos. A Survey among Network Operators on BGP Prefix Hijacking. ACM
SIGCOMM Computer Communication Review, 48(1):64–69, Apr 2018.
[49] Pavlos Sermpezis, Vasileios Kotronis, Petros Gigis, Xenofontas Dimitropoulos,
Danilo Cicalese, Alistair King, and Alberto Dainotti. ARTEMIS: Neutralizing BGP
Hijacking within a Minute. arXiv:1801.01085 [cs], Jan 2018. arXiv: 1801.01085.
[50] Xingang Shi, Yang Xiang, Zhiliang Wang, Xia Yin, and Jianping Wu. Detecting
Prefix Hijackings in the Internet with Argus. In ACM IMC, 2012.
[51] Craig A. Shue, Andrew J. Kalafut, and Minaxi Gupta. Abnormally Malicious
Autonomous Systems and Their Internet Connectivity. IEEE/ACM Transactions
on Networking, 20(1):220–230, Feb 2012.
[52] Muhammad S. Siddiqui, Diego Montero, Rene Serral-Gracia, Xavi Masip-Bruin,
and Marcelo Yannuzzi. A survey on the recent efforts of the Internet Standard-
ization Body for securing inter-domain routing. Computer Networks, 80:1–26,
Apr 2015.
[53] Carolin Strobl, Anne-Laure Boulesteix, Achim Zeileis, and Torsten Hothorn.
Bias in random forest variable importance measures: Illustrations, sources and a
Profiling BGP Serial Hijackers
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
[54] Yanmin Sun, Andrew K. C. Wong, and Mohamed S. Kamel. CLASSIFICATION OF
IMBALANCED DATA: A REVIEW. International Journal of Pattern Recognition
and Artificial Intelligence, 23(04):687–719, Jun 2009.
[55] UCEPROTECT. Blacklist Policy LEVEL 2. http://www.uceprotect.net/en/index.
solution. BMC Bioinformatics, 8(1):25, Jan 2007.
php?m=3&s=4.
[56] Pierre-Antoine Vervier, Olivier Thonnard, and Marc Dacier. Mind Your Blocks:
On the Stealthiness of Malicious BGP Hijacks. In Proceedings 2015 Network and
Distributed System Security Symposium, San Diego, CA, 2015. Internet Society.
[57] Z. Zhang, Y. Zhang, Y. C. Hu, Z. M. Mao, and R. Bush. iSPY: Detecting IP Prefix
Hijacking on My Own. IEEE/ACM Transactions on Networking, 18(6):1815–1828,
Dec 2010.