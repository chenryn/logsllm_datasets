### Corporate Network and Process Control Automation Reference Architecture

**Components:**
- **PLC (Programmable Logic Controller)**
- **HMI (Human-Machine Interface)**
- **Engineering Station**
- **Historian**
- **Publishing Server**
- **DMZ (Demilitarized Zone)**
- **DCS (Distributed Control System) Servers**
- **Application Servers**

**Figure 7.6: Process Control Automation Reference Architecture**

### DVCP as Part of the Distributed Control Infrastructure

In this section, we describe one of our early research projects where we connected a TE (Tennessee Eastman) model to a control system consisting of a PLC and an HMI. The objective was to study attacks on the PLC and explore intrusion detection possibilities using a network IDS (Intrusion Detection System).

#### Attacks on Situational Awareness

Industrial processes are continuously monitored by operators via an HMI console. Upon detecting undesired process behavior, the operator takes corrective actions to restore the process to its steady state. If the operator attributes the disturbances to unnatural causes, they can initiate an immediate incident investigation. Given these considerations, an attacker might aim to hide real field data from the operator, as seen in the Stuxnet attack [32].

For instance, if the attacker's goal is to raise the reactor pressure to an unsafe limit without the operator's awareness, they could record steady-state process data and replay it during the attack. This would impede process observability, causing the operator to lose situational awareness. Such an attack is particularly dangerous. If the attacker also manipulates the safety limit value or disrupts the safety systems' communication link, the reactor could explode, potentially injuring personnel [5].

### Experimental Environment for Attack Modeling and Detection

To model and detect such attacks, we implemented a hybrid process control environment (real hardware, simulated process) as shown in Figure 7.7. The setup uses Siemens SIMATIC S7-1200+KTP400 Starter Kit hardware and the Modbus/TCP industrial protocol. We used the libmodbus library [37] to enable communication between the simulated process and the HMI. The PLC polls selected PV (Process Variables) to display them on the HMI and forwards setpoints to the process.

**Figure 7.7: Testbed and IDS Architecture**

Modbus protocol operates on a Client-Server model, requiring both a Modbus Server and Client on the PLC (Figure 7.8). We implemented attacks on process variable observability by manipulating the PLC code. During the initial stage, the PLC records process measurements during normal operations. When the attack begins, the PLC sends stored data to the HMI, while the real field data remains undisclosed.

**Figure 7.8: Modbus Client on the PLC**

To detect such attacks, we developed an experimental IDS engine. We monitor data flows between the process and the PLC, and between the PLC and the HMI. Any discrepancy in the process values between these data flows indicates an attack on data consistency. We query the output registers of the PLC for the data displayed on the HMI and capture the traffic between the process and the PLC. If an inconsistency beyond a certain threshold is detected (Figure 7.9), an alarm is generated by the Alarm Manager.

**Figure 7.9: Data Inconsistency Detection**

Although this experimental environment does not represent typical distributed control systems, it is sufficient for researching a wide range of security problems and is affordable for small research groups. More advanced setups, as described in [52], require significant financial and manpower investments. In [17], the testbed operators presented the influence of networking parameters on attacks on the Tennessee Eastman process. It is also possible to attach process models to affordable network simulators (e.g., ns-2, OMNeT++) to study networking attacks on physical processes.

### General Research Capabilities

In general, any piece of equipment and any protocol can be attached to the process model to research the impact of cyber vulnerabilities on the physical process. This includes various types of attacks such as MITM (Man-in-the-Middle), session hijacking, DoS (Denial of Service), spoofing, replay, packet injection, PLC exploits, vulnerabilities in switches and mobile applications for ICS, database vulnerabilities (especially historians), and blinding the operator. Similarly, the effect of defensive solutions, such as intrusion detection approaches, hardening of protocols and equipment, and network monitoring, can be evaluated.

### DVCP as a Standalone Testbed

Working with a combination of control equipment and physical processes can be laborious. Once a cyber-vulnerability is understood, it is easier to abstract its potential impact and apply it directly to the model. For example, in [34], Jason presented algorithms for sensor signal spoofing and how they can be coded into a rootkit for sensor firmware. Marina applied these algorithms to spoof sensor signals from the TE process model and developed a process-aware approach to detect such spoofed signals [30]. By abstracting from real sensor microcontrollers, we could focus on factors that make spoofing challenging at the process level, such as sensor noise, sampling frequency, and types of dynamic process behavior.

Similarly, in [31], we demonstrated the susceptibility of physical processes to "stale data" caused by DoS attacks on communication links between the controller and the process. We first identified vulnerabilities in control equipment that allow DoS attacks or cause the equipment to operate on stale data. Then, we demonstrated how these vulnerabilities can be exploited and studied the impact of different process parameters on the success of the attacks.

Since process models contain controllers, they allow for the implementation of networking attacks (e.g., MITM) or attacks on controllers and control algorithms directly in the Simulink model. One such attack scenario, not discussed in this paper, is maladaptive malicious control, where the attacker tries to destabilize the control loop, making it uncontrollable by maximizing the error in the control output. The algorithm learns the behavior of the PID controller and then compensates for its control efforts, resulting in a situation where everything the controller does makes things worse.

Alternatively, simulated process data can be saved as .csv files and used for testing malicious exploitation algorithms, PLC exploits, anomaly detection algorithms, etc.

### Research Questions and Applications

Below are examples of research questions and existing works that can be studied using DVCP:

- **Risk Assessment:** Existing processes and control strategies were not designed with security in mind. By studying process performance and reaction under malicious manipulations, defenders can better understand the bottlenecks in process infrastructure and weaknesses in control configuration. For example, in [19], the authors examined the influence of networking parameters on remotely executed attacks directed at control valves. They showed that process control tuning, such as PLC task scheduling and valve speed, plays a crucial role in process reaction and can be configured to make remote exploitation harder or even impossible. In [31], we showed that the impact of DoS attacks on the controller output is less dangerous than attacks on sensor signals. Additionally, we identified parts of the process that are more sensitive to such attacks.

- **Process-Aware Security Controls:** While the research community is still investigating ways to defend cyber-physical systems from targeted attacks, there are novel approaches to securing processes at the physical and control layers. For example, in [45], the authors propose a control-theoretic method called physical watermarking to authenticate the correct operation of a control system. By injecting a known noisy input, the effect of this input can be found in the measurement of the true output. If an attacker is unaware of this physical watermark, the system cannot be adequately emulated because the attacker cannot consistently generate the component of the output associated with the known noisy input.

- **Security-Aware Control Strategies:** The design of any control system starts with requirements. A viable control strategy not only satisfies operational and economic goals but is also able to absorb the greatest anticipated disturbance. Although disturbances are often unpredictable, long process operation history has provided substantial experience about possible operational disruptions. It is often necessary to develop alternative control strategies to compensate for the weaknesses of other control configurations. One widely applied technique is the use of override controllers, which can take command of a manipulated variable away from another controller when the process would exceed some constraint. Such selective control keeps the equipment running, although sometimes at a suboptimal level. In [3], the authors propose a design for a causal feedback controller to minimize the impact of DoS attacks on the communication between the controller and the process.

- **Intrusion Detection:** Intrusion detection plays a crucial role in the early identification of ongoing attacks. The challenge is that well-designed cyber-physical attacks are not easily distinguishable from natural disturbances and accidents. Telling the difference between disturbances and attacks is an interesting research problem. Intrusion detection can occur at any layer of the cyber-physical system and at the interactions between the layers. In [30], we proposed a process-aware approach to detecting spoofed process measurements. The detection involves calculating correlation entropy in a cluster of related sensors. In [42], the authors detect attacks hidden in sensor signal noise using proxy measurements. In another work, the same authors [43] propose an approach for identifying malicious activity using a path authentication mechanism in combination with state estimation for anomaly detection.

- **Financial Impact:** Operational targets and security requirements may conflict and need to be considered together. For example, for the TE process, the optimal operating steady state condition for reactor pressure is as close as possible to the upper shutdown limit of 3000 kPa. In this case, an attacker could quickly bring the system into an unsafe state. To ensure secure operations, it would be desirable to maintain a sufficient safety margin. However, maintaining a safety margin for reactor pressure of at least 100 kPa is equivalent to a 5% increase in operating costs [49]. This is a useful optimization problem to solve.

- **Human Response:** The requirement for better human responses to abnormal situations is a recognized industrial problem. Many safety accidents occur due to non-identification or late identification of process degradation, as well as wrong corrective actions. Operators could be trained to recognize abnormalities that might be caused by intentional manipulations and to divert irregularities away from production- or safety-critical variables. Cognitive scientists can study the perception and reaction of process operators to abnormal situations and come up with better monitoring and reacting procedures. The models can also be used for testing HMI design decisions in conjunction with optimal presentations of security metrics to the process operators.

- **Safety Measures:** Safety systems have the critical function of detecting dangerous or hazardous conditions and taking actions to prevent catastrophic consequences. Process Hazards Analysis (PHA) or Hazard and Operability (HAZOP) studies seek to identify malfunctions that might harm people, the process, or the environment. Quantitative and Qualitative Risk Analysis (QRA) is used to evaluate the actual risk to measurable criteria like financial exposure or the probability of failure. In today’s cybersecurity threat environment, it is essential to add cybersecurity considerations to hazards analysis. In [50], the authors propose a safety-securing approach to security zoning for Industrial Control Systems using detectability and reachability matrices.

- **Cyber-Physical Forensics:** While cyber-physical forensics is closely related to anomaly detection, there are specific aspects that require additional solutions. For example, sensors for collecting forensic evidence: what kind of sensors (physical, networking) at which locations are needed? Studying the attacker's activities allows us to understand what they need to do and why. Look for attackers where they must go: historical data, operator screens, PLC logic. Analyze anomalies in process data and logs. Data stream synchronization and sensor signal sampling and filtering play a crucial role in event correlations. Two correlated measurements may become uncorrelated if their respective sensor signals are sampled and processed differently. Data trustworthiness (or veracity) is another issue. If forensic data cannot be trusted, investigators may draw wrong conclusions about the nature and causes of the accident, complicating attack attribution and liability assignment. Verification of data can take the form of plausibility and consistency checks.

- **Process Control Security Properties:** There is an ongoing debate in the security community about the security requirements for industrial control systems. In traditional IT, the CIA (Confidentiality, Integrity, Availability) model is well-known. It has been suggested that reversing the order (Availability, Integrity, Confidentiality) might be suitable for control systems, emphasizing that the plant should be up and running. However, the question remains whether a running but uncontrollable plant is truly available. The CIA model focuses on information security properties, which do not fully encompass the required security requirements for process control. In Section 5, we presented controllability and observability as the pillar terms of process control. Ensuring controllability and observability is the goal of secure process control. These two security properties should be accompanied by operability, which determines the ability of the process to achieve acceptable operations. The relationship between process security properties is illustrated in Figures 7.11 and 7.12.

**Figure 7.11: Security Properties of Process Control**

- **Operability**
- **Controllability**
- **Observability**

**Figure 7.12: Description of Security Properties**

Controllability, Observability, and Operability (CO2) are useful terms to start thinking about process control security. Sensor miscalibration violates the process observability property, affecting the overall security of the system.