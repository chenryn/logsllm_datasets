Corporate network
PLC
PLC
PLC
HMI
Engineering 
station
Historian
Publishing 
server
DMZ
DCS 
servers
Application 
servers
Figure 7.6: Process control automation reference architecture
DVCP as part of the (distributed) control infrastructure
In this section we describe one of our early research projects in which we connected TE model to
a control system consisting of a PLC and an HMI to study attacks on the PLC and intrusion detection
possibilities with the network IDS.
Attacks on situational awareness. Industrial process dynamic is monitored by operators via a
Human Machine Interface (HMI) console around the clock. Upon observing an undesired process
behavior, an operator takes corrective measures to bring the process back into its steady state.
Moreover, if the operator attributes the disturbances as being of unnatural causes, she can initiate an
immediate incident investigation. Out of this considerations the attacker might prefer to hide the real
ﬁeld data from the operator (see section 6.5). This type of attack was realized in Stuxnet [32].
Let the attacker’s goal be to raise the pressure in the reactor to an unsafe limit without operator’s
awareness. One of the possibilities to achieve this is to record steady state process data and replay
them to the operator during the attack. By that the attacker would impede process observability
resulting in the operator losing situational awareness.This is one of the most dangerous attacks
on process control. If the attacker manages also to manipulate the safety limit value or suppress
6Here physical layer refers to the Layer 0 of the process automation reference architecture [22]
40
Chapter 7. Damn Vulnerable Chemical Process
IP: 192.168.0.2
PV
Modbus
Libmodbus
HMI
PROFINET
TIA Portal V.11
Engineering station
IP: 192.168.0.5
IP: 192.168.0.6
Process simulation
SP
Modbus
IDS
Data 
Processing 
Unit
Data 
Monitor
Alarm 
Manager
IP: 192.168.0.1
PROFINET
PLC
PROFINET
Linux host
Figure 7.7: Testbed and IDS architecture
the safety systems communication link, the reactor can actually explode and injure personnel in its
vicinity [5].
To model and to detect such type of attacks we have implemented an experimental environment
in a form of a hybrid process control environment (real hardware, simulated process) as depicted in
Fig. 7.7. It is based on the Siemens SIMATIC S7-1200+KTP400 Starter Kit hardware and industrial
protocol Modbus/TCP. We used the libmodbus library [37] to enable communication between the
simulated process and the HMI7. The Programmable Logic Controller (PLC) polls selected PV
to display them in the HMI and forwards the setpoints to the process. Modbus protocol utilizes
Client-Server communication model. Therefore it is required to install Modbus Server and Client on
the PLC (Fig. 7.8).
We implemented attacks on process variable observability through manipulation of the PLC code.
During the initial stage of the attack, the PLC records process measurements during normal plant
operations. When the attack begins, the PLC sends stored data to the HMI whereas the real ﬁeld
data remains undisclosed. To detect this we implemented an experimental IDS engine. We monitor
data ﬂows between the process and the PLC and between the PLC and the HMI. Any discrepancy
in the process value between indicated data ﬂows will indicate an attack on data consistency. To
watch over the speciﬁed data ﬂows on one hand we query the output registers of the PLC for the
data which should be displayed on the HMI. On the other hand we capture the trafﬁc between the
process and the PLC. If the inconsistency in data beyond a certain threshold is detected as shown in
Fig. 7.9, an alarm is generated by the Alarm Manager. This is certainly a relatively straight forward
both attack scenario and detection approach.
Although the experimental environment described above does not represent the typical distributed
7Modbus connectivity libraries are available in different languages, e.g. we also used Jamod (Java) [56]
7.3 Potential applications
41
Figure 7.8: Modbus client on the PLC
 2770
 2780
 2790
 2800
 2810
 2820
 2830
00:10
00:20
00:30
00:40
00:50
01:00
01:10
Pressure (kPa)
Time (h:min)
Real Value
PLC Value
Figure 7.9: Data inconsistency detection
nature of the industrial control systems it is still sufﬁcient for researching a wide variety of security
problems and is affordable to small research groups. It is possible to set up a more vigorous control
infrastructure as described e.g. in [52], but such environments require signiﬁcant ﬁnancial and
manpower investments. In [17] the operators of the testbed has presented the inﬂuence of the
networking parameters on the effects of attacks on Tennessee Eastman process. It is worthwhile
mentioning, that process models can be also attached to the affordable network simulators (e.g. ns-2,
OMNeT++) to study networking attacks on the physical processes.
42
Chapter 7. Damn Vulnerable Chemical Process
In general, it is possible to attach any peace of equipment to the process model, with
any protocol and research into impact of the cyber vulnerabilities on the physical process
(think of MITM, hijacking sessions, DoS, spooﬁng, replay, packet injection, PLC exploits,
vulnerabilities in switches and mobile applications for ICS, DB vulns (especially historians),
blinding operator, etc.). Hack anything you want at the control infrastructure layer and
demonstrate effect of your attack at the physical layer! In the same way it is possible
to evaluate effect of the defensive solutions (all kinds of intrusion detection approaches,
hardening of the protocols and equipment, network monitoring, etc.).
DVCP as standalone testbed
Working with the combination control equipment/physical process can be laborious. Once the
cyber-vulnerability is understood it is easier to abstract its potential impact and to apply it directly to
the model. For example in [34] Jason has presented algorithms for sensor signal spooﬁng and how
they can be coded into a rootkit for sensor’s ﬁrmware. In turn, Marina has applied those algorithms
to spooﬁng sensor signals from TE process model and developed a process-aware approach to
detecting such spoofed signals [30]. What is important is that by abstracting from the real sensor
microcontrollers we could concentrate on the factors which make spooﬁng challenging at the process
level8, e.g. sensor signals parameters (sensor noise, sampling frequency, types of dynamic process
behavior, etc.). Similarly in [31] we demonstrated susceptibility of physical processes to “stale data”
brought about by DoS attacks on communication links between the controller and the process. We
ﬁrst presented vulnerabilities of control equipment which would allow to launch DoS attacks or
make control equipment operate on stale data. After that we demonstrated how those vulnerabilities
can be made exploitable and studied in depth the impact of different process parameters on the
attacks’ success.
Since process models contain controllers, the models allow to implement networking attacks
(e.g. MITM) or attacks on controllers and control algorithms directly in the Simulink model (e.g. for
feasibility study). One of such attacks scenarios not discusses in this paper is maladaptive malicious
control in which the attacker is trying to destabilize control loop and making it uncontrollable. This
is achieved by maximize the error in control output. The algorithm learns the behavior of PID
controller and then compensates for its control efforts. As a result, everything the controller does
makes things worse. Alternatively, simulated process data can be saved as .cvs ﬁle and used for
testing malicious exploitation algorithms, exploits on the PLC, anomaly detection algorithms, etc.
Research questions and applications
Below we present examples of the research questions (with the examples of existing works)
which can be studied using DVCP.
• Risk assessment. Existing processes and control strategies were not designed and built with
security in mind. By studying process performance and reaction under unknown conditions
brought about by malicious manipulations defender can better understand the bottlenecks
in process infrastructure and weaknesses in control conﬁguration. E.g. in [19] the authors
8In contrast to ﬁrmware rootkitting challenges
7.3 Potential applications
43
examined the inﬂuence of the networking parameters on the remotely executed attack directed
at control valves (to bring valves into a certain position). It was shown that process control
tuning such as PLC task scheduling and valve speed play important role in process reaction
and can be conﬁgured accordingly to make remote exploitation harder and even impossible. In
[31] we have shown that the impact of the DoS attacks on the controller output are much less
dangerous than the attacks on sensor signals. Additionally we identiﬁed parts of the process
which are more sensitive to such attacks than another. The defenders can develop approaches
for the assessment of process resilience to the attacks and to categorize sensors and control
loops based on their impact on plant economy and safety. Those that entail safety compromise
in minutes or having substantial impact on plant stability could be more closely monitored
and tightly controlled.
• Process-aware security controls. While the research community is still investigating the
opportunities to defend cyber-physical systems from targeted attacks, there are already novel
approaches to securing processes at the physical and control layers. E.g in [45] authors
proposes a control-theoretic method, called physical watermarking, to authenticate the correct
operation of a control system. Its utility lies in its ability to allow physical authentication of
physical components. By injecting a known noisy input to a physical system, it is expected
that the effect of this input can be found in the measurement of the true output. If an attacker
is unaware of this physical watermark, the system cannot be adequately emulated because the
attacker is unable to consistently generate the component of the output associated with this
known noisy input. Consequently, the watermark acts as a physical nonce, forcing an attacker
to generate outputs unique to the given inputs at a chosen time.
• Security aware control strategies. The design of any control system (as of any engineering
system) starts with the requirements. A viable control strategy not only satisﬁes operational
and economic goals but is ideally also able to absorb the greatest anticipated disturbance. Al-
though disturbances are “acts of God”events, long process operation history has accumulated
substantial experience about the types of possible operational disruptions. In practice, it is
hardly possible to design a single control structure capable of accommodating all operational
objectives. Therefore often one or more alternative control strategies are developed in parallel
to compensate for the weaknesses of the other control conﬁgurations (dynamic controlabil-
ity). One of the widely applied techniques for alternative control is the usage of override
controllers [38] which can take command of a manipulated variable away from another con-
troller when otherwise the process would exceed some process or equipment constraint. Such
selective control keeps the equipment running although sometimes at a suboptimal level. Most
of the developed control structures for TE process are modiﬁed with overrides to deal with
certain types of disturbances [49, 40]. The approach of using overrides can be similarly
applied to compensate for the process impairments caused by the cyber-attacks. In [3] the
authors propose a design for causal feedback controller to minimize the impact of the DoS
attacks on the communication between controller and the process. In general, the requirements
related to the security aspects of plant operations should be determined upfront and included
among the set of the control goals.
• Intrusion detection. Intrusion detection plays important role in early identiﬁcation of the
ongoing attack. The challenge is that well-designed cyber physical attacks are not easily
44
Chapter 7. Damn Vulnerable Chemical Process
distinguishable from natural disturbances and accidents. Telling up disturbances and attacks is
an interesting research problem. Intrusion detection can take at any layer of cyber-physical
system (Fig. 7.10) as well as at the interactions between the layers. In [30] we have proposed
process-aware approach to detecting spoofed process measurements. The detection takes form
of the correlation entropy in a cluster of related sensors (process layer). In [42] the authors
detect attacks hidden in the sensors signals noise using proxy measurements (process layer). In
another work the same authors [43] propose an approach for identifying malicious activity that
involves the use of a path authentication mechanism in combination with state estimation for
anomaly detection. The approach reasons conjointly over computational structures, and opera-
tions and physical states. Attack detection at the control layer are described e.g. in [7] and [44].
Figure 7.10: Layers of cyber-physical system
• Financial impact. Operational targets and security requirements may conﬂict and have to
be considered in conjunction. In many processes the optimal reaction rate is achieved when
the reactor is operated at a high pressure. For instance, for TE process it was shown that the
optimal operating steady state condition for reactor pressure Preac is as close as possible to the
upper shutdown limit of 3000kPa and for reactor level Lreac to its lower bound [47]. In this
case the attacker will be able to bring the system into an unsafe state quickly. To ensure secure
operations it would be desirable to maintain a sufﬁcient safety margin. However, maintaining a
safety margin for Preac of at least 100 kPa is equivalent to a 5% increase in operating costs [49].
This is a useful optimization problem to solve. The requirements to safety margins will also
depend on how fast process operators and control system can detect and resolve the potentially
unsafe situation.
• Human response. Requirement for better human responses to abnormal situations is a recog-
nized industrial problem [1]. Many safety accidents happen because of the non-identiﬁcation
or late identiﬁcation of process degradation as well as because of wrong corrective actions.
Operators could be trained to recognize abnormalities which might be caused by intentional
manipulations (in contrast to natural events) and to e.g. divert irregularities away from
production- or safety-critical to non critical variables. For those who are interested in cognitive
sciences can study perception and reaction of the process operators to abnormal situations
and hopefully come up with better monitoring and reacting procedures. Similarly, the models
can be used for testing HMI design decisions in conjunction with optimal presentations of the
7.3 Potential applications
45
security metrics to the process operators.
• Safety measures. Safety systems have the critical function of detecting dangerous or haz-
ardous conditions and taking actions to prevent catastrophic consequences on the users and
the environment. Process Hazards Analysis (PHA) or Hazard and Operability (HAZOP)
studies of processes seek to identify malfunctions that might harm the people, process, or the
environment. Quantitative and Qualitative Risk Analysis (QRA) is used to evaluate the actual
risk to measurable criteria like ﬁnancial exposure or the probability of failure. The industrial
control community has substantial experience in identifying and addressing potential hazards
and operational problems in terms of plant design and human error. In today’s cyber security
threat environment, it becomes essential to add cyber security considerations to the hazards
analysis. In [50] authors propose safety securing approach to security zoning for Industrial
Control Systems using detectability and reachability matrices.
• Cyber-physical forensics. While in its essence cyber-physical forensics is closely related to
anomaly detection, there are several speciﬁc aspects which need additional solutions. E.g.
sensors for collection forensic evidence: what kind of sensors (physical, networking) at which
locations are needed? Studying the hard work of the attacker allows to understand what she
needs to do and why. Look for the attackers where they must go: historical data, operator’s
screens, PLC logic. Look at the anomalies in process data and logs. Data streams synchroniza-
tion and sensor signals sampling and ﬁltering are playing crucial role in event correlations.
Thus two correlated measurements may become uncorrelated if their respective sensor signals
sampled and processed differently. Data trustworthiness (or veracity) is another issue. If the
forensics data cannot be trusted, the investigators may draw wrong conclusions about nature
and causes of the accident. This in turn will complicate attack attribution and assignment of
liabilities. There are several ways how data veracity can be violated. The veriﬁcation of data
can take the form of plausibility and consistency checks.
• Process control security properties. There is a ruthless civil war happening in the security
community about security requirements for industrial control systems. In traditional IT domain
it is a well-known CIA model. It was suggested that reversing the order shall be good enough
to describe security requirements for control systems. The availability was put on top to
emphasize that ﬁrst and for most the plant should be up and running. The counter question
would be whether running but uncontrollable plant is available or not? The problem with the
CIA is that those are information security properties. By deﬁnition they cannot describe and
encompass all required security requirements for process control. In Section 5 we presented
controlability and observability – the pillar terms of process control which are atomic in their
essence. Ensuring controlability and observability is the goal of secure process control. These
two security properties shall be accompanied by operability which determines the ability of
the process to achieve acceptable operations. What substitutes acceptable operations depends
on the speciﬁc state of the process (e.g in the presence of disturbance the process operate
at suboptimal level). The relationship between process security processes is illustrated in
Fig. 7.11 and their description is given in Fig. 7.12.
Controllability, Observability and Operability (CO2) are useful terms to start thinking about
process control security. Sensor miscalibration violates process observability property (process
46
Chapter 7. Damn Vulnerable Chemical Process
Figure 7.11: Security properties of process control
Operability
Controllability