# 以太坊区块链中投毒攻击的威胁分析
|
##### 译文声明
本文是翻译文章，文章原作者 Teppei Sato, Mitsuyoshi Imamura, Kazumasa Omote
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
近年来，区块链技术在应用于加密资产（cryptocurrency）方面已取得了显着发展，考虑了智能合约的扩展和匿名性的提高。以太坊是一个具有智能合约功能的区块链，在区块链上有一个数据空间可以自由存储程序。但是，这种数据空间的污染会危害以太坊。
在这项研究中分析了以太坊数据空间中存储的恶意文件，并讨论了以相对较低的成本嵌入恶意数据而严重污染区块链的区块链投毒攻击(blockchain
poisoning attack)。
## 0x01 Introduction
区块链是一种分布式账本，尽管该技术被称为加密资产（cryptocurrency）的基本技术，但它不仅充当存储价值的功能，而且还扩展到工业领域。该技术具有一些优势。它提供一定程度的匿名性，确保网络不关闭，并且对网络上的数据具有抗操作性。但是，区块链技术面临某些安全问题和挑战，例如大多数攻击（51％攻击）、双花和加密劫持，以及如下图的投毒攻击。
通过将恶意或非法文件嵌入到区块链的数据空间中，可以攻击区块链[。将这种类型的攻击定义为投毒攻击。此类攻击被认为比针对公共数据库的传统投毒攻击（例如DNS缓存中毒）更具恶意性，因为由于区块链的功能（无法在区块链中进行交易）而没有硬分叉来修复中毒的区块链，被修改或取消是不可行的。此外，由于区块链中包含的数据由每个节点同步，因此攻击者可以通过将节点嵌入到区块链中来迫使节点下载任何恶意文件。
智能合约最早由Szabo提出，它是一种计算机协议，旨在在没有任何可信任第三方的情况下以数字方式促进、验证或强制进行交易的谈判。以太坊被公认为是智能合约的一种实现，该合约是完整的。
与比特币区块链不同，以太坊拥有一个合法且灵活的空间，其中包含智能合约的字节码。任何人都可以正式将任何数据嵌入以太坊区块链。不幸的是，这表明此功能还为攻击者提供了灵活性。因此，针对以太坊（以及具有灵活空间的区块链）的投毒更加容易。
## 0x02 Background
###  1）以太坊
以太坊是一个运行智能合约的去中心化平台：以完全编程的方式运行的应用程序，不会出现停机、审查、欺诈或第三方干扰的可能性。
**两种类型的帐户：** 以太坊有两种类型的账户，外部账户（EOA）和合约账户。
EOA用于将以太币发送到另一个帐户，签订合约并执行合约，它由私钥控制。相反，合约代表以太坊本身的智能合约账户。换句话说，EOA将交易发送到合约帐户以执行合约。
**以太坊上的智能合约和灵活空间：**
以太坊上的智能合约以字节码（称为EVM代码）编写，并在名为以太坊虚拟机（EVM）的虚拟机上执行，该虚拟机在以太坊网络中的一个节点上运行。以太坊交易具有用于智能合约的空间：初始化和数据区域。初始化区域包含EVM代码，用于部署智能合约。相反，数据区域用于调用合约的功能并为该功能提供参数。无论智能合约如何，都可以自由使用该区域。
因为初始化和数据区域都是无限字节的数组），所以数据大小没有理论上限。但是，由于交易费不能超过矿工投票确定的块费限制，因此数据大小有实际的上限。另外，作为以太坊的官方Go实现的Go
Ethereum还有另一个限制。带有注释“Heuristic limit, reject transactions over 32 KB to
prevent DOS attacks”，在应用程序中添加了一个过滤器，以拒绝其init/data区域中包含超过32
kB数据的事务。从v1.6.6版本开始已添加此限制。
根据ethernodes.org（其中包含有关以太坊网络中节点的信息）的说法，Go
Ethereum在以太坊网络中所有节点的大约50％上运行。其他以太坊客户端应用程序中的数据大小没有限制。
**METAMASK：**
这是一个以太坊钱包，实现为网络浏览器的扩展：Chrome，Firefox和Opera。它不仅支持连接以太坊主网而且还支持专用网，并支持传输ERC20令牌  
资源管理器。这是一个Web服务，可通过Web浏览器提供有关区块链的信息，而无需特殊软件或运行区块链节点。服务对于区块链的透明性至关重要。
Etherscan是以太坊的知名探测器。它提供与以太坊区块链相关的信息，例如合约的源代码，初始和数据区域中的数据，区块哈希和交易哈希。
###  2）如何在以太坊上使用智能合约
可以通过以下两个步骤在以太坊上使用智能合约:
部署合约：使用高级编程语言定义合约。
Solidity6是定义以太坊合约的一种著名语言，它看起来像JavaScript。合约被编译为字节代码，称为EVM代码。
接下来，将EVM代码部署在以太坊网络上以使用该合约。在没有集成开发环境（IDE）的情况下，编译器将输入的EVM代码作为输出返回给新事务的init，该事务的接收者地址设置为null。此时，尚未生成与合约关联的合约帐户。使用以太坊钱包发送交易后，交易在网络中广播，以太坊网络中的矿工将交易放入新区块中以生成下一个区块。在挖掘过程中，将生成合约帐户。
执行合约：要执行合约，必须进行交易。输入字节数组以指定要调用的函数，并将该函数的参数提供给数据区以进行新事务。
然后将交易从EOA发送到合约帐户。在挖掘过程中，合约执行的结果反映在区块链中。此外，为了发送包含EVM代码的交易，某些以太坊钱包应用程序具有接收十六进制字符串中的数据并将其写入交易的功能。
## 0x03 Blockchain Poisoning Attack
区块链投毒攻击是通过将恶意或非法文件嵌入到区块链的灵活空间中来对区块链的攻击。攻击者可以强迫区块链网络中的节点下载文件，这导致针对区块链的DoS攻击。攻击目标可以是区块链及其用户。攻击者按以下方式进行攻击：
1.攻击者准备了恶意或非法文件；
2.攻击者将文件嵌入到灵活的交易空间中，并在区块链网络中广播交易；
3.恶意文件通过挖掘过程嵌入到区块链中，然后在网络参与者之间共享；
用于区块链中毒攻击的文件可以是隐私信息，恶意软件和任何非法内容。攻击成功原因如下：
–区块链在区块链P2P网络的参与者之间共享；
–包含在区块链中的交易很难被修改或取消。
在区块链系统中，每个完整节点都需要存储由P2P网络同步的块数据。这意味着攻击者通过将节点嵌入到区块链中来迫使节点下载和存储恶意或非法文件。当然，未存储完整区块链数据的节点（例如网络中的SPV节点）不会像完整节点那样受到直接攻击。但是，由于区块链网络主要由完整节点支持，因此攻击会间接影响区块链的所有用户。
不变性是区块链的重要特征之一。由于此功能，包含在区块链中的交易很难被修改或取消。因此，针对公共数据库，区块链投毒攻击被认为比常规的投中毒攻击（例如DNS缓存投毒）更具持久性，因为不使用硬分叉来修复投毒的区块链是不可行的。相反，一旦支付了交易费，就很容易发送带有恶意数据的交易。这意味着区块链受到攻击的严重破坏，而攻击者可以在低难度下进行攻击。
## 0x04 Application of Blockchain Poisoning
使用区块链进行C＆C：在区块链系统中，每个节点都需要存储由P2P网络同步的块数据。任何人都可以通过连接到网络来访问区块链数据。这些功能可用于C＆C。
A在这种技术中，僵尸程序是通过修改比特币节点软件（免费提供）来实现的，并且僵尸程序连接到比特币P2P网络并将该网络用于C＆C。恶意软件通过区块链从Bot
Master获取命令的方法：
–从受害者节点上的区块链获取命令；
–访问资源管理器网站以获取命令。
仅当受害者服务器作为区块链网络的节点运行时，才能使用第一个。因为每个节点都同步了区块链，并且区块链数据存储在其自身上，所以恶意软件可以通过读取存储在服务器上的数据（由bot
master嵌入到区块链中）轻松访问命令。使用此技术，恶意软件可以将其C＆C通信隐藏在区块链网络的P2P通信中。例如，恶意软件针对加密资产的节点窃取其私钥，然后可以在不与Bot
Master和C＆C服务器直接通信的情况下获取命令。
在第二种方法中，恶意软件访问资源管理器网站以接收命令。由于大多数公司都允许HTTP /
HTTPS协议并且HTTPS通信的内容被加密，因此很难检测和阻止这种攻击技术。
**区块链的算力下降/加密资产的价格操纵：**
在执行区块链投毒后，发布诸如“区块链包含非法文件！”之类的信息。会对使用区块链的用户产生负面印象，他们可能会离开系统。这是针对区块链的DoS攻击，因为网络的算力对于区块链系统的安全性非常重要。
如果加密资产遇到上述攻击，则其价格可能会下降。因此，攻击者可以降低价格，并从攻击前后的价格差中受益。
## 0x05 Evaluation of Flexible Space
调查了以太坊主网络上的可编程空间（块高度从0到6,988,614）（2015年7月30日至2018年12月31日UTC）。
###  1）方法
使用file
carving方法检测到交易嵌入文件。此方法用于从存储的未分配空间中恢复文件，例如，在数字取证中。它可以通过诸如搜索文件头和使用文件结构的技术来识别嵌入未知二进制数据中的文件[。在此评估中使用了Foremost，因为它在通用和开源程序中使用。调查程序如下：