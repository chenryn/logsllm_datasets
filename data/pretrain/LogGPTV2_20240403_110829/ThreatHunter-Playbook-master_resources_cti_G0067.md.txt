# G0067: APT37
## Description
APT37, also known as [APT37](https://attack.mitre.org/groups/G0067), is a North Korean cyber espionage group that has been active since at least 2012. The group primarily targets victims in South Korea but has also conducted operations in Japan, Vietnam, Russia, Nepal, China, India, Romania, Kuwait, and other parts of the Middle East. Between 2016 and 2018, APT37 was linked to several campaigns, including Operation Daybreak, Operation Erebus, Golden Time, Evil New Year, Are you Happy?, FreeMilk, Northern Korean Human Rights, and Evil New Year 2018. (Citations: FireEye APT37 Feb 2018, Securelist ScarCruft Jun 2016, Talos Group123)

There is significant overlap in the definitions of North Korean threat groups, and the name Lazarus Group is often used broadly to encompass a wide range of activities attributed to North Korea. Some organizations use the term Lazarus Group to refer to any activity linked to North Korea. (Citation: US-CERT HIDDEN COBRA June 2017) Other organizations, however, track specific clusters or groups such as Bluenoroff, APT37, and APT38 separately, while some may still refer to these groups under the umbrella term Lazarus Group. (Citation: Kaspersky Lazarus Under The Hood Blog 2017)

## Tactics, Techniques, and Procedures (TTPs)
| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | Impact | System Shutdown/Reboot | APT37 uses malware to issue the command `shutdown /r /t 1` to reboot a system after wiping its MBR. | Windows event logs, Process command-line parameters, Process monitoring |
| Windows | Defense Evasion, Privilege Escalation | Bypass User Account Control | APT37 includes a function in the initial dropper to bypass Windows UAC and execute the next payload with elevated privileges. | System calls, Process monitoring, Authentication logs, Process command-line parameters |
| Windows, macOS | Discovery | Peripheral Device Discovery | APT37 uses a Bluetooth device harvester, which leverages Windows Bluetooth APIs to gather information on connected Bluetooth devices. | PowerShell logs, API monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Discovery | System Owner/User Discovery | APT37 identifies the victim's username. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Discovery | Process Discovery | APT37's Freenki malware lists running processes using the Microsoft Windows API. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion, Execution | Scripting | APT37 executes shellcode and scripts to decode Base64 strings. | Process monitoring, File monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | Discovery | System Information Discovery | APT37 collects the computer name, BIOS model, and execution path. | Azure activity logs, Stackdriver logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | Standard Application Layer Protocol | APT37 uses HTTPS to conceal C2 communications. | Packet capture, Netflow/Enclave netflow, Process use of network, Malware reverse engineering, Process monitoring |
| Linux, macOS, Windows | Defense Evasion, Privilege Escalation | Process Injection | APT37 injects its ROKRAT malware variant into the `cmd.exe` process. | API monitoring, Windows Registry, File monitoring, DLL monitoring, Process monitoring, Named Pipes |
| Windows | Execution | Execution through API | APT37 leverages Windows API calls such as `VirtualAlloc()`, `WriteProcessMemory()`, and `CreateRemoteThread()` for process injection. | API monitoring, Process monitoring |
| Linux, macOS, Windows | Defense Evasion | Obfuscated Files or Information | APT37 sends images embedded with shellcode and obfuscates strings and payloads, including through steganography. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows, GCP, AWS, Azure | Collection | Data from Local System | APT37 collects data from victims' local systems. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, Windows, macOS | Execution | User Execution | APT37 sends spearphishing attachments to entice users to open them. | Anti-virus, Process command-line parameters, Process monitoring |
| Windows, Linux, macOS | Credential Access | Credential Dumping | APT37 uses a credential stealer called ZUMKONG to harvest usernames and passwords stored in browsers. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Linux, macOS, Windows | Command and Control | Custom Command and Control Protocol | APT37's ZUMKONG credential stealer emails credentials from the victim using HTTP POST requests. | Packet capture, Netflow/Enclave netflow, Process use of network, Process monitoring, Host network interface, Network intrusion detection system, Network protocol analysis |
| Windows, macOS, Linux | Initial Access | Spearphishing Attachment | APT37 delivers malware via spearphishing emails with malicious HWP attachments. | File monitoring, Packet capture, Network intrusion detection system, Detonation chamber, Email gateway, Mail server |
| Linux, macOS, Windows | Execution | Command-Line Interface | APT37 uses the command-line interface. | Process monitoring, Process command-line parameters |
| Linux, Windows, macOS | Execution | Exploitation for Client Execution | APT37 exploits Flash Player (CVE-2016-4117, CVE-2018-4878) and Word (CVE-2017-0199) for execution. | Anti-virus, System calls, Process monitoring |
| Linux, macOS, Windows | Collection | Audio Capture | APT37 uses an audio capturing utility called SOUNDWAVE to capture microphone input. | API monitoring, Process monitoring, File monitoring |
| Windows | Persistence | Registry Run Keys / Startup Folder | APT37 adds persistence via the Registry key `HKCU\Software\Microsoft\CurrentVersion\Run`. | Windows Registry, File monitoring |
| Linux, macOS, Windows | Command and Control, Defense Evasion | Web Service | APT37 leverages social networking sites and cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, and Box) for C2. | Host network interface, Netflow/Enclave netflow, Network protocol analysis, Packet capture, SSL/TLS inspection |
| Linux, macOS, Windows | Command and Control, Lateral Movement | Remote File Copy | APT37 downloads second-stage malware from compromised websites. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |
| Windows, Linux, macOS, SaaS | Initial Access | Drive-by Compromise | APT37 uses strategic web compromises, particularly of South Korean websites, to distribute malware. The group also uses torrent file-sharing sites to disseminate malware more widely. They use a JavaScript-based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly. | Packet capture, Network device logs, Process use of network, Web proxy, Network intrusion detection system, SSL/TLS inspection |
| Windows, macOS, Linux | Impact | Disk Structure Wipe | APT37 has access to destructive malware capable of overwriting a machine's Master Boot Record (MBR). | Kernel drivers, MBR |
| macOS, Windows | Defense Evasion | Code Signing | APT37 signs its malware with an invalid digital certificate listed as "Tencent Technology (Shenzhen) Company Limited." | Binary file metadata |
| Windows | Execution | Dynamic Data Exchange | APT37 uses Windows DDE for executing commands and a malicious VBS. | API monitoring, DLL monitoring, Process monitoring, Windows Registry, Windows event logs |
| Linux, macOS, Windows | Command and Control | Commonly Used Port | APT37 uses port 8080 for C2. | Packet capture, Netflow/Enclave netflow, Process use of network, Process monitoring |

This optimized version enhances readability and coherence by improving sentence structure, clarifying complex ideas, and ensuring consistent formatting.