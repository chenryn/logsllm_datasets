复杂系统的挽歌
麦基·迪克森，赖耶 阿莱夫（前美国数字服务员工）
  2018年3月19日:加州帕索罗伯斯农庄汽车旅馆。由于这场暴雨对摩托车来说太凶猛了，我们被耽搁了，在南下的路上失去了一天。只剩下18个小时，才能到220英里外的下一个落脚点。计划没有什么意义，因为没什么是按计划的。
六年前，我是谷歌负责 SRE 的中层经理。我参与了谷歌存储技术方面重新实现自己的 MySQL（这个庞大且几乎没有必要）的项目。而大约三年后，我开发的最后两个推广应用程序还没有被任何人关注过。在人力资源部门喜欢使用的措辞中，我是“在马鞍上松弛的”。   让我真正摆脱这种状态的是一种高能激励，因为奥巴马总统要求我对 healthcare.gov 进行所谓最后的营救，因为所谓的“联邦便捷市场”有瘫痪的风险，无法支撑起平价医疗法案的运作。通过它，全民医疗保健的概念会影响下一代人的生活。healthcare.gov 的紧急升级工作由几十名 SRE 工程师昼夜努力，他们大部分来自湾区。今天，他们中的大多数人都有同感，因为他们都十分珍视这段经验，而且他们永远不会希望其他人有类似的经历。 这个项目后来又发展成为一个新的政府实体，也就是美国数字服务公司。我们对美国政府最顽固的 IT 问题进行了简化的处理，大多数问题一开始都是试图用另一个新系统来取代一个大型而复杂的老系统。
第一个重大挑战的是理念上的：现在还有谁在用 IT 这个词？嗯，只有那些巨大的、恢宏的“企业”工业综合体。仅联邦政府每年就花费超过800亿美元在所谓的 IT 上。IT 这个行当大约在二战后开始产生，其理念是用计算机版本取代所有大型官僚机构的纸张和模拟流程。表格变成了屏幕，文件柜变成了数据库，备忘录变成了电子邮件。效率的极大提高得以实现，然后随着基础设施的老化和自身发展出全新的问题而逐渐被遗忘。IT 行业有自己的词汇，比如职称（“CIO”，“企业架构师”)和技术（大型机和个人电脑）的僵化，已经不适应互联网的发展（而互联网已经受到很多人的排斥，被广泛认为是一个坏的趋势）。2010年代，我们这些在谷歌或 Facebook 上的人其实属于另一个国家，也就是所谓的技术国家，开始有新的流行语和新的技术时尚。在文化上，人们开始不关心职称、等级制度或时尚；虽然这些说法都不是特别值得大书特书，但它们对于了解技术人员来说非常重要。
技术国家的人将来自 IT 时代的任何事物称为“历史”。IT 将技术人士的任何行为都称为“艺术”。两种文化的冲突凸显了一个核心问题：阻碍两方面互相理解的最大问题并没有改变：我们更善于建立新的复杂性，而不是管理复杂性。
在经历了谷歌、美国国税局、医疗保险、国防部、联邦调查局、电子医疗记录项目和其他十几个项目或公司之后，我确信所有足够复杂的系统都有许多共同特点。计算机和人类系统无法分离
1967年梅尔康威断言“所有试图设计解决方案的组织机构，最终设计的方案其实就反映了该机构的通讯机制。”似乎自1967年以来所有的机构都认定“康威定律”是一种冒犯，并试图超越它。
他们很少成功。我说很少的意思其实是“从来没有”，只是我懒得证明这个结论。软件组件最终按照人工流程一样组织，这是有充分理由的。在这两种情况下，除非仔细定义组件之间的接口并缓慢更改，否则大型系统将无法运行。无论它们怎么调用，它们都是一种契约，让每一方都依赖于一个抽象接口，告诉他们从别的部门那里能得到什么。
当一个系统陷入慢性功能障碍时，技术问题和人的问题必然是同时发生的。只要有任何两个无法互操作的软件组件，我就能找到背后的两个互不交流的团队。一周前，我采访了一个大型团队中的人员，他们的项目的基本要求是在大型机上的 DB2 数据库上执行事务。两年来，没有人能够做到这一点。虽然有些困难，但我们还是找到了维护数据库的承包开发者。结果他迟到了大约10分钟，他解释说这是因为他花了一段时间才找到会议室，因为之前从没来过大楼的这一边。如果你被要求诊断一个系统，因为没有一个清晰的问题或找不到“根本问题”，而是似乎到处卡壳，似乎任何地方都有点不太对劲。那么一个很好的开始方法是绘制两张图表，一张组织结构图和一张系统流程图，看看两张图的分歧有多严重。请记住，它们都是可变的，并且解决方案可能来自任一更改中的一个。
消除一致性和级联失败
  任何规模的任何系统都可能会出现一个简单的错误，例如对保险索赔做出错误的决定，或者为客户提供错误的帐单地址。但只有庞大的分布式系统才能与自己产生分歧。系统无法呈现任何答案的特殊故障模式在量子领域称为退相干。
和之前一样，人类和软件中有很多例子。任何处理分布式存储的人都习惯于多个副本、数据块服务器或分区服务器无法同步的问题。在这种情况下，查询的答案就会因服务器而异，而这就违反了设计人员尝试创建的理想模型。通常，解决方案是某种投票机制，其中一个版本的数据获胜，少数的意见被遗忘，不再影响整个系统。在论文中，通常认为多数意见是“正确的”。人类的例子更容易找到。在撰写本文时，美国法律制度无法回答"大麻是否合法"的问题。答案同时是肯定和否定的，这取决于你问哪个法庭。根据退伍军人协会及其计算机系统的记录，成千上万的退伍军人都是活死人。选民登记记录中的错误无处不在，而且错误五花八门。
  退相干，它还有一个众所周知的近亲，被称为级联失败。当系统紧密耦合时，一个组件中的故障往往会导致其他组件出现故障。如今，一大乐趣来自于“联系”这个词可能有许多令人惊讶的定义。可能你知道的是软件组件如何根据体系结构图交换数据。你知道哪些机器在同一台机器上运行吗？或是共享一个网络交换机？或是配电单元？或是BIOS版本？如果你对一个大型系统负责的时间足够长，你肯定会体会到的。
当调试由复杂系统呈现的错误结果时，请始终记住，寻找“根本原因”是不够的，因为它往往向老鼠一样是时隐时现的，可能还会一边吱吱叫，一边动胡子。你可能需要通过错误校正算法的来帮助你，这些算法可保护系统免受与自身的分歧。这些算法有时就是故意为此而设计的。始终处于部分故障状态
在你维护的系统中，通过对级联故障进行问题回溯，你会意识到系统的许多部分在灾难发生之前已经失败。大型系统始终处于部分故障状态。这是  平均故障间隔时间（MTBF）和平均修复时间（MTTR）之间相互作用的不可避免的事实。
运营组通常试图为大型项目增加 MTBF 并减少 MTTR，且通常是在硬件组件级别，因为这是可以有效测量“任何事物的平均时间”的唯一级别。
对于一个团队来说，在这样的“问责领域”内进行优化当然是值得的。即便如此，当你查看整个系统时，“勉强可以接受”的容错提升往往会立即会被另一层毁掉。
假设您有一个分布式存储系统，该系统已部署为容忍阵列中的三块磁盘同时发生故障。于是硬件团队充满了希望，希望得到奖励，并采取巧妙的测量方式来“保证”阵列永远不会有一个以上的磁盘坏掉。一年过后，你会发现该应用程序已被重新优化，现在只能容忍一块磁盘坏掉。为什么会这样？统计分析显示，随便怎么筹划，到头来都将会“恰恰”足够好。右手给五元，左手拿光光。
大量的团队（系统组件也是同理）活动将展示许多这种互有得失的例子。因为人类的责任心总是难以持久的，于是真正会有效的往往是进化率。正如在生物学中一样，进化不会产生最佳的解决方案，它只能产生一个恰恰好的解决方案。这种系统的自然状态是“尽可能远离灾难”，但其实往往就是一步之遥。
对于   哥伦比亚号和挑战者号宇航飞船的事故后调查，可以很好地说明安全边界是如何不断在构建后消耗的，以及如何不断因为“导致灾难的小过错”被忽略而错失最后的挽回机会。要知道，复杂工程因为严格的管理流程，导致其中每个组件都是留有设计的安全余量，以确保令人难以置信的可靠性。目前为止，航天飞机系统的在两次灾难之间的最高安全记录是135次飞行。
在启动新应用程序之前，如果你有幸查看其设计文档，请留意基础结构组件的设计将如何达成已发布的服务级别协议 （SLA）。这样做会降低基础层的安全余量。至少，尝试为历史记录中测量和记录的性能进行设计。优先级倒置的新尝试
 之前我们已经两次提到工程师的晋升了，这并不是为了吸引眼球。由于人的系统和计算机系统是同构的，因此个人  激励机制是推动计算机系统演化的无形之手。硬件维护人员追求更短的 MTTR 的愿望是很正常的，因为这关系到他们的绩效。存储运营商则希望提高安全程度并降低成本，这同样也是正常的，因为这会给他们带来好评。
作为一个曾经为数十个项目负责的人，我在招聘的时候是非常有使命感的，因为这些项目关系着成千上万的人生与死。使命感将带来长期的专注，当你的项目预算不高的时候，使命感对项目非常有帮助。总有一天，倦怠会袭来，即使是最纯洁的人也难以抵御，而且生活上的顾虑也会导致情绪低落。
科技领域的价值观到底是怎样的？显然，一个成功的工程师手头的任务肯定不会越来越少。这导致科技人士对“生活质量”的追求如同金钱一样。这不是一种被大众接受的理念，但它是科技领域特有的价值观。相比之下，金钱和管理层、奖励机制和晋升程序紧密相关。因此，那些因素都决定了你的公司和你管理的每个系统的长期行为。到底什么是优秀的？别听信公司说什么有价值；相反，看看是谁被提升？与这些人相关的行为将得到推崇。剩下那些人的行为不会得到重视。这种提升压力将超越公司领导者的任何明确意图。