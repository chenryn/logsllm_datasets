title:Encore: Lightweight Measurement of Web Censorship with Cross-Origin
Requests
author:Sam Burnett and
Nick Feamster
Statement from the SIGCOMM 2015 Program Committee: The SIGCOMM 2015 PC appreciated the technical contributions made in
this paper, but found the paper controversial because some of the experiments the authors conducted raise ethical concerns. The controversy
arose in large part because the networking research community does not yet have widely accepted guidelines or rules for the ethics of
experiments that measure online censorship. In accordance with the published submission guidelines for SIGCOMM 2015, had the authors
not engaged with their Institutional Review Boards (IRBs) or had their IRBs determined that their research was unethical, the PC would
have rejected the paper without review. But the authors did engage with their IRBs, which did not ﬂag the research as unethical. The PC
hopes that discussion of the ethical concerns these experiments raise will advance the development of ethical guidelines in this area. It is the
PC’s view that future guidelines should include as a core principle that researchers should not engage in experiments that subject users to an
appreciable risk of substantial harm absent informed consent. The PC endorses neither the use of the experimental techniques this paper
describes nor the experiments the authors conducted.
Encore: Lightweight Measurement of
Web Censorship with Cross-Origin Requests
Sam Burnett
Nick Feamster
School of Computer Science, Georgia Tech
PI:EMAIL
Department of Computer Science, Princeton
PI:EMAIL
Abstract
Despite the pervasiveness of Internet censorship, we have
scant data on its extent, mechanisms, and evolution. Mea-
suring censorship is challenging: it requires continual mea-
surement of reachability to many target sites from diverse
vantage points. Amassing suitable vantage points for longitu-
dinal measurement is difﬁcult; existing systems have achieved
only small, short-lived deployments. We observe, however,
that most Internet users access content via Web browsers,
and the very nature of Web site design allows browsers to
make requests to domains with different origins than the main
Web page. We present Encore, a system that harnesses cross-
origin requests to measure Web ﬁltering from a diverse set
of vantage points without requiring users to install custom
software, enabling longitudinal measurements from many
vantage points. We explain how Encore induces Web clients
to perform cross-origin requests that measure Web ﬁltering,
design a distributed platform for scheduling and collecting
these measurements, show the feasibility of a global-scale
deployment with a pilot study and an analysis of potentially
censored Web content, identify several cases of ﬁltering in six
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are not
made or distributed for proﬁt or commercial advantage and that copies bear
this notice and the full citation on the ﬁrst page. Copyrights for components
of this work owned by others than the author(s) must be honored. Abstracting
with credit is permitted. To copy otherwise, or republish, to post on servers
or to redistribute to lists, requires prior speciﬁc permission and/or a fee.
Request permissions from permissions@acm.org.
SIGCOMM ’15, August 17–21, 2015, London, United Kingdom
Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM 978-1-4503-3542-3/15/08 ...$15.00
DOI: http://dx.doi.org/10.1145/2785956.2787485
months of measurements, and discuss ethical concerns that
would arise with widespread deployment.
Categories and Subject Descriptors
• Networks → Network measurement; Web protocol se-
curity • Social and professional topics → Technology and
censorship
Keywords
Web censorship; Network measurement; Web security
1
Internet censorship is pervasive: by some estimates, nearly 60
countries restrict Internet communication in some way [35].
As more citizens in countries with historically repressive gov-
ernments gain Internet access, government controls are likely
to increase. Collecting pervasive, longitudinal measurements
that capture the evolving nature and extent of Internet censor-
ship is more important than ever.
Introduction
Researchers, activists, and citizens aim to understand what,
where, when, and how governments and organizations imple-
ment Internet censorship. This knowledge can shed light on
government censorship policies and guide the development
of new circumvention techniques. Although drastic actions
such as introducing country-wide outages (as has occurred in
Libya, Syria, and Egypt) are eminently observable, the most
common forms of Internet censorship are more subtle and
challenging to measure. Censorship typically targets speciﬁc
domains, URLs, keywords, or content; varies over time in
response to changing social or political conditions (e.g., a
national election); and can be indistinguishable from appli-
cation errors or poor performance (e.g., high delay or packet
653loss). Detecting more nuanced forms of censorship requires
frequent measurement from many varied vantage points.
Unfortunately, consistently and reliably gathering these
types of measurements is extremely difﬁcult. Perhaps the
biggest obstacle entails obtaining access to a diverse, globally
distributed set of vantage points, particularly in the regions
most likely to experience censorship. Achieving widespread
deployment in these locations often requires surmounting
language and cultural barriers and convincing users to install
measurement software. Although researchers have begun to
develop custom tools to measure ﬁltering (e.g., OONI [15,38],
Centinel [8]), widespread deployment remains a challenge.
Instead, researchers have resorted to informal data collection
(e.g., user reports [23]) or collection from a small number of
non-representative vantage points (e.g., PlanetLab nodes [42],
hosts on virtual private networks, or even one-off deployments
of single vantage points) that might not observe the same
ﬁltering that typical users experience.
This paper takes an alternate approach: rather than ask
each user to deploy custom censorship measurement software,
we use existing features of the Web to induce unmodiﬁed
browsers to measure Web censorship. Many users access the
Internet with a Web browser, so inducing these browsers to
perform censorship measurements will enable us to collect
data from a larger, more diverse, and more representative set
of vantage points than is possible with custom censorship
measurement tools.
Our system, Encore, uses Web browsers on nearly every
Internet-connected device as potential vantage points for col-
lecting data about what, where, and when Web ﬁltering occurs.
Encore relies on a relatively small number of Web site opera-
tors (webmasters) to install a one-line embedded script that
attempts to retrieve content from third-party Web sites using
cross-origin requests [6, 40]. The Encore script induces every
visitor of these modiﬁed pages to request an object from a
URL that Encore wishes to test for ﬁltering. Although same-
origin policies in browsers prohibit many kinds of requests
(e.g., to thwart cross-site request forgery), we demonstrate
that the cross-origin requests that browsers do allow are sufﬁ-
cient to collect information and draw conclusions about Web
ﬁltering. A major contribution of our work is to show that
meaningful conclusions about Web ﬁltering can be drawn
from the side channels that exist in cross-origin requests.
Encore’s simplicity comes at the cost of signiﬁcant limi-
tations on the types of measurements it can collect and the
conclusions we can draw from its measurements. First, En-
core’s measurements must operate within the constraints of
the cross-origin requests that Web browsers permit. For ex-
ample, the img HTML directive yields the most conclusive
feedback about whether an object fails to load, but it can only
be used to test images, not general URLs. This limitation
means that while it may be useful for detecting (say) the ﬁlter-
ing of an entire DNS domain, it cannot test the reachability of
speciﬁc (non-image) URLs. Encore’s design must recognize
which cross-origin requests browsers permit and use com-
binations of these requests to draw inferences with higher
conﬁdence. Second, because Encore requires webmasters
to augment their existing Web pages, Encore must be easy
to install and incur minimal performance overhead on the
Web sites where it is deployed. Finally, great care is required
when measuring censorship because accessing sensitive sites
may endanger users in repressive countries. Our research
focuses on Encore’s design and implementation, and is not a
measurement study per se.
Encore can detect whether certain URLs are ﬁltered, but
it cannot determine how they are ﬁltered. Subtle forms of
ﬁltering (e.g., degrading performance by introducing latency
or packet loss) are difﬁcult to detect, and detecting content
manipulation (e.g., replacing a Web page with a block page,
or substituting content) using Encore is nearly impossible.
Thus, Encore may complement other censorship measure-
ment systems, which can perform detailed analysis but face
much higher deployment hurdles. Ultimately, neither En-
core nor other censorship analysis tools can determine human
motivations behind ﬁltering, or even whether ﬁltering was in-
tentional; they only provide data to policy experts who make
such judgments.
2 Related Work
We summarize existing censorship measurement techniques
and previous studies of Internet censorship; other policy re-
ports of Internet censorship (which can ultimately seed our
measurements); and other efforts to perform measurements
from clients using advertisements or embedded images. Al-
though we broadly survey Internet censorship practices, En-
core focuses on Web ﬁltering.
Censorship measurement tools. The prevailing mode for
measuring Internet censorship is to develop custom measure-
ment software and identify users who are willing to either
install the software or otherwise host a measurement device
that runs the software. Existing measurement tools include
OONI [15], Centinel [8], and CensMon [42]. Both OONI and
Centinel can be deployed on end hosts. These tools perform
much more detailed analysis of how censors implement block-
ing, but to date both have seen only limited deployment, likely
because they require recruitment of users who are willing to
install and maintain the measurement software. CensMon
was only deployed for a brief period on PlanetLab, a global
network of servers hosted in academic networks; such mea-
surements are unlikely to be representative, as residential and
mobile broadband networks can face much different censor-
ship practices than academic and research networks [32, 46].
At this point, we are not aware of any censorship measure-
ment system that continuously collects measurements from a
global set of vantage points; this is the gap that Encore aims
to ﬁll.
Censorship measurement studies. Several researchers have
performed “ﬁrst look” studies of censorship in various coun-
tries such as Pakistan [32], Iran [1], and China [10, 11, 47].
Zittrain et al.’s study of censorship in China [47] performed
654Web requests to hundreds of thousands of sites, but did so
from only a handful of dialup modems that the authors de-
ployed. Crandall [11], Clayton [10], and Ensaﬁ [14] exploit
symmetric behavior of the Chinese ﬁrewall to measure it from
clients outside China; such measurements are easier to collect
than Encore, but the technique does not work in all countries.
The studies of censorship in Iran and Pakistan were more
limited: the Iran study apparently performed measurements
from a single vantage point for only two months [1], and the
Pakistan study performed measurements from only ﬁve test
networks over about two months [32]. Each of these studies
offers a useful snapshot into a country’s ﬁltering practices
at a particular point in time, but data collection is neither
widespread nor continuous. The OpenNet Initiative has con-
ducted the only long-term study to date, but its data collection
is sporadic, making it difﬁcult to compare ﬁltering practices
across countries and time [35].
Sources of block lists. Some policy organizations publish
reports concerning censorship practices around the world.
For example, the Open Network Initiative routinely publishes
qualitative reports based on measurements from a limited
number of vantage points, with scant insight into how censor-
ship evolves over short timescales or what exactly is being
ﬁltered [36, 37]. Other projects such as Herdict [23], Great-
Fire [19], and Filbaan [16] maintain lists of domains that
may be blocked. Herdict compiles reports from users about
domains that are blocked from a certain location; such reports
lack independent veriﬁcation. GreatFire monitors reachability
of domains and services from a site behind China’s censor-
ship ﬁrewall; it also maintains historical measurement results.
Each tool offers limited information driven by user-initiated
reporting or measurements, yet these services and reports can
serve as initial lists of URLs to test using Encore.
Cross-origin requests for client measurement. Bortz et
al. use timing information from cross-site requests to in-
fer various information, such as whether a user is logged
into a particular site or whether a user has previously vis-
ited a Web page [5]. Karir et al. use embedded Javascript
with cross-origin requests to measure IPv6 reachability and
performance from large numbers of clients [29]; the use of
embedded cross-origin requests to obtain large number of
clients is similar to Encore’s design. Other systems have
used cross-origin requests to third parties to determine infor-
mation such as network latency between a client and some
other Internet destination [20, 33]. In particular, Casado and
Freedman quantiﬁed the prevalence of clients behind NATs
and proxies by delivering measurement code to clients in a
manner very similar to Encore [7]. Puppetnets exploits weak-
nesses in browser security to coerce browsers to unwittingly
participate in denial-of-service attacks [30]. These tools use
similar techniques as Encore, but they primarily aim to mea-
sure network performance or past user behavior based on the
timing of successful cross-origin requests. They do not infer
reachability of domains, IP addresses, or URLs based on the
success (or lack thereof) of cross-origin requests.
3 Background
We discuss Web ﬁltering and threats that may interfere with
attempts to measure it. We also explain cross-origin requests.
3.1 Threat Model
To implement Web ﬁltering, smaller countries often have cen-
tralized trafﬁc ﬁlters on a national backbone; larger countries
require each ISP to implement a censorship policy; some
countries, like China, do both [46]. Web ﬁltering typically
takes place when the client performs an initial DNS lookup
(at which point the DNS request may result in blocking or
redirection), when the client attempts to establish a TCP con-
nection to the Web server hosting the content (at which point
packets may be dropped or the connection may be reset), or
in response to a speciﬁc HTTP request or response (at which
point the censor may reset the TCP connection, drop HTTP
requests, or redirect the client to a block page).
Our goal is to observe instances of Web ﬁltering and report
them to a central authority (e.g., researchers) for analysis. We
assume an adversary that can reject, block, or modify any
stage of a Web connection in order to ﬁlter Web access for
subsets of clients, although we assume the adversary uses a
blacklist and is unwilling to ﬁlter all Web trafﬁc, or even sig-
niﬁcant fractions of all Web trafﬁc. This adversary inﬂuences
Encore’s design in three ways: (1) the main goal of Encore
is to measure this adversary’s Web ﬁltering behavior; (2) the
adversary may attempt to ﬁlter clients’ access to Encore it-
self, thereby preventing them from collecting or contributing
measurements; and (3) the adversary may attempt to distort
Encore’s ﬁltering measurements by allowing measurement
trafﬁc but denying other access to the same site. This paper
considers all three aspects of the adversary.
3.2 Cross-Origin Requests
Web browsers’ same-origin policies restrict how a Web page
from one origin can interact with resources from another;
an origin is deﬁned as the protocol, port, and DNS domain
(“host”) [40]. In general, sites can send information to an-
other origin using links, redirects, and form submissions, but
they cannot receive data from another origin; in particular,
browsers restrict cross-origin reads from scripts to prevent
attacks such as cross-site request forgery. However, cross-
origin embedding is typically allowed and can leak some read
access. The cornerstone of Encore’s design is to use informa-
tion leaked by cross-origin embedding to determine whether
a client can successfully load objects from another origin.
Various mechanisms allow Web pages to embed remote re-
sources using HTTP requests across origins; some forms
of cross-origin embedding are not subject to the same
types of security checks as other cross-origin reads. Ex-