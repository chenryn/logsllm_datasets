Cool stuff learned from the
Department of Defense
Cyber Crime Digital Forensic
Challenge (2006)
David C. Smith, CISSP CISM
Georgetown University
with contributions from Mike McDonanld, The
Professionals” (3rd Place Team, Florida State
University)
A little bit about me..
 Information Security Professional, in
IT over 18 years, mostly as a
consultant in some capacity.
 Work at GU, have a small
consulting company – HCP
Forensic Services
http://www.hcp-fs.com
 B.S. Computer Science, working
toward my masters in IA.
Team Hoya Haxa!
 DC3 limits the teams to 4.
 Mickey Lasky, Sr. Security Analyst
 Trent Beckett, Security Analyst
 Jon Hesson, Security Intern
 David Smith
 Almost all off-hours, team lunches on me.
 Most of us have 2+ years of digital forensic
work & investigations.
 We thought it would be cool to learn
something new & develop existing skillz.
 Hoya Haxa?
DC3 Challenge
 DC3 = Department of Defense Cyber Crime
Center
 Defense Cyber Crime Institute
 Defense Computer Forensics Laboratory
 Defense Cyber Investigations Training Academy
 RDT&E – Research, Development, Testing, and
Evaluation.
 This challenge – Cheap R&D?
 We heard about this challenge from a Slashdot
article and a follow-up in Network World.
DC3 Challenge (now called the
2006 Challenge)
 Quick breakdown of the competitors
 Academic, 61 entries.
 Civilian, 25 entries.
 Commercial, 21 entries.
 Government, 7 entries.
 Military, 6 entries.
 Countries represented
 US, Australia, Canada, France, India.
 Total teams 140
 Prize is all expense paid trip to DC3
Conference + bragging rights!
DC3 Challenge
 01 August 2006: Registration Began.
 01 September 2006: Challenges Sent.
 01 December 2006: Last Day to Submit.
 15 December 2006: Winning Team Announced.
 21-26 January 2007:  DoD Cyber Crime
Conference (Prize).
 So, basically we got 3 months to knock these
challenges out!
Rules of Engagement
 After the challenge registrations ballooned
to 140, DC3 changes the rules to the first
100 submitted solutions are eligible to win.
 Must submit solutions in DC3 report
format to receive credit.
 You do not have complete all challenges,
submit what you have completed.
 Commercial tools can be used, copies of
created tools must be submitted (exe).
 Secret Bonus is out there, somewhere.
Challenges
 10 Challenges, plus secret challenge.
 Media Recovery
 CD in 2 pieces (1000), floppy disk in 2 pieces (300).
 Data Carving on a Linux LVM (250).
 Data Acquisition, Boot a DD image (250).
 Data Acquisition, Boot a split DD image (500).
 Image Analysis, Real or CG (200).
 Keylog cracking (250).
 Password cracking (250).
 Steganography using S-tools (200).
 Audio Steganography (250).
DC3 Digital Forensic Challenge
 Media Recovery: Compact-disc
 Examiners must develop and document a
methodology used to recover data from a damaged
compact-disc. You will be expected to recover a
piece of known data from the CD. Points will be
awarded for successfully extracting data from the
compact-disc.
 Total Weighted Points: 1000
DC3 – Damaged Media CD
 44%  got full points (11 in 25).
Top 11 teams got 100 points.
 No partial points given or available.
Top 5 Scoring
 AccessData, 0x28 Thieves, Professionals, Hoya
Haxa, Hacker Factor, SRS, CodeMonkeys,
NUCIA, DFAT, Backbone Security, Pirate
DC3 – Damaged Media CD
 1st challenge to fall - on the first day!
 We split CDs and tested, tested, tested.
DC3 – Damaged Media CD
 SA Mickey Lasky discovered D-Skins.
http://www.d-skin.com/
 Snap It On:
 Leave It On:
DC3 – Damaged Media CD
 A little tape – and ready to be read.
This looks beat up – but it looked better when we started.
DC3 – Damaged Media CD
 We read the disk to 11MB (the split).
DC3 Digital Forensic Challenge
 Media Recovery: Floppy Diskette
 Examiners must develop and document a
methodology used to recover data from a damaged
floppy diskette. You will be expected to recover a
piece of known data from the floppy. Points will be
awarded for successfully extracting data from floppy
diskette.
 Total Weighted Points: 300
DC3 – Damaged Media Floppy
 20%  got full points (5 in 25).
Top 4 teams, plus the 6th place finisher got
300.
 No partial points given or available.
Top 5 Scoring
 AccessData, 0x28 Thieves, Professionals, Hoya
Haxa,
DC3 – Damaged Media Floppy
 Similar work-up as CD.  We carefully
examined the evidence floppy and started
testing.
DC3 – Damaged Media Floppy
 We must have tried 20+ methods:
Tape
 One side / both sides [small pics of tape]
 Thin strips.
 Only on the edges.
Superglue
 Carefully smooth the superglue on the cut.
Nail Polish
 Carefully applied.
DC3 – Damaged Media Floppy
 Our best results were with very thin strips
of film splicing tape on one side.
 Also, we found it best to open the new
media container a little as possible.
DC3 – Damaged Media Floppy
 Our old friend:
 dd -if=/dev/hdc -of=dc3floppy.img conv=noerror, sync
 Secret message was "Jack Bauer is my
hero!".
DC3 Digital Forensic Challenge
 Data Acquisition - Boot a DD Image
 Examiners must develop and document a
methodology for booting a dd image without
reconstructing the media with normal
conventions. A dd image can be found in the dd
Image folder. You will be expected to develop a
method to conduct a live analysis of a dd image by
booting the dd image as if it was the local partition
housing the bootable operating system. Points will
be awarded for your proof of analysis by means of
your methodology.
 Total Weighted Points: 250
DC3 - Boot a DD Image
 16%  got full points (4 in 25).
First, fourth, fifth, and 19th place scored 250
points.
 20% got partial points (5 in 25).
5 teams got 125 points of 250 (50%).
Top 5 Scoring
 AccessData, Hoya Haxa, and Hacker Factor (Dr.
Krawetz) got the full points.
DC3 - Boot a DD Image
 Initial analysis show the image to be a
partition image, ext3, linux kernel 2.6.
 Understanding the challenge means
booting in a VM.
 Identified issues:
Partition image needs to be converted to disk
image.
Partition image does not have MBR / boot
manager and can not boot.
DC3 - Boot a DD Image
 First things first
Create an image to become our “disk” image.
 qemu-img create disk.img 1G
Boot up small linux and partition it
 qemu –L . –hda linux.bin –hdb disk.img
 fdisk /dev/hdb
n (new), p (primary), 1, [first], [last], w (write)
DC3 - Boot a DD Image
 Boot and migrate from partition to disk
 qemu –L . –hda linux.bin –hdb disk.img
–hdc image.dd (challenge dd)
 dd from partition to disk
 dd if=/dev/hdc of=/dev/hdb1
 Now we have a disk image that is ready to
be booted!
DC3 - Boot a DD Image
 Now I boot to my small version of CentOS
that contains GRUB as my 1st disk and our
new “disk image”
 qemu –L . –hda linux-boot –hdb disk.img
DC3 - Boot a DD Image
 From the GRUB prompt, force the boot to
our “disk image”
 c for grub command line.
 root (hd1,0) #1st hd, part 0
 kernel /boot/vmlinuz-2.6.9-1.667
root=/dev/hdb1
 initrd /boot/initrd-2.6.9-1.667.img
 boot
DC3 - Boot a DD Image
DC3 - Boot a DD Image
DC3 Digital Forensic Challenge
 Data Acquisition: Boot a Split dd Image
 Examiners must develop and document a
methodology for booting a split dd image without
reconstructing the media with normal
conventions. A split dd image can be found in the
Split dd Image folder. You will be expected to
develop a method to conduct a live analysis of a
split dd image by booting the split dd image as if
it was the local partition housing the bootable
operating system. You may not concatenate the
slices of the dd image into one piece. Points will
be awarded for your proof of analysis by means of
your methodology.
 Total Weighted Points: 500
DC3 – Split DD
 4%  got full points (1 in 25).
First place finisher scored 500 points.
 12% got partial points (3 in 25).
3 teams got 250 points of 500 (50%).
Top 5 Scoring
 AccessData got the 500 points
 0x28 Thieves, Professionals, and Hacker Factor
(Dr. Krawetz) got 250 points.
DC3 – Split DD
 We did not get any points for this based
on my screw-up of the challenge write-up.
 Hoping to get partial points
Boot would be similar to boot DD.
 Combine files in some sort of VM disk
configuration file
DC3 – Split DD
#####################
### "Boot split DD" ####
####################
# Extent description
 RW 63 FLAT "mbr.img" 0
 RW 614400 FLAT "image.dd_aa" 0
 RW 614400 FLAT "image.dd_ab" 0
 RW 602560 FLAT "image.dd_ac" 0
 RW 409600 FLAT "buffer.img" 0
 # The Disk Data Base (DDB)
 ddb.adapterType = "ide"
 ddb.geometry.sectors = "32"
 ddb.geometry.heads = "128"
 ddb.geometry.cylinders = "537"
 ddb.geometry.biosSectors = "32"
 ddb.geometry.biosHeads = "128"
 ddb.geometry.biosCylinders = "537"
 ddb.virtualHWVersion = "3"
 ddb.toolsVersion = "0"
* Content provided by “The Professionals” (3rd Place Team, Florida State University) *
 Use VMware VMDK
format to combine images
into a single virtual drive
 Run fdisk to repartition the
new disk using evidence
gathered from system files
 /root/anaconda-ks.cfg
 /etc/fstab
 /etc/mtab
 /boot/grub.conf
DC3 Digital Forensic Challenge
 Data Carving: Linux LVM Interpretation
 Examiners must develop and document a
methodology used to interpret a Logical Volume
Management (LVM) partition. An image of an LVM
partition can be found in the LVM folder. You will be
expected to develop a method to effectively analyze
and recover a deleted file from an LVM partition.
Points will be awarded for your proof of analysis by
means of your methodology.
 Total Weighted Points: 250
DC3 – Data Carving
 20%  got full points (5 in 25).
Top 4 and 6th place finishers got 250 points.
 8% got partial points (2 in 25).
2 teams got 25 points of 250 (10%).
Top 5 Scoring
 AccessData, 0x28 Thieves, Professionals, Hoya
Haxa, SRS (Action Front) all got the full points.
DC3 – Data Carving
 Initial analysis shows that it is indeed an LVM
volume.
Importing into our forensic viewers (FTK,
Autopsy, Encase, WinHex) gave us no OS
interpretation.
 Issues identified were
 Converting a Logical Volume Management
partition into a carve-able filesystem.
How do we find the files to carve?
DC3 – Data Carving