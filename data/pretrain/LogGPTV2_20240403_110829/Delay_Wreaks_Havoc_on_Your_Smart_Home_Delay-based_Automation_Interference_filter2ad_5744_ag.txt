and P. McDaniel, “Iotsan: fortifying the safety of iot systems,” in ACM
CoNEXT, 2018.
[8] Z. B. Celik, G. Tan, and P. McDaniel, “IoTGuard: Dynamic enforcement
of security and safety policy in commodity iot,” in NDSS, 2019.
[9] Q. Wang, P. Datta, W. Yang, S. Liu, A. Bates, and C. A. Gunter,
“Charting the attack surface of trigger-action iot platforms,” in ACM
CCS, 2019.
[10] K.-H. Hsu, Y.-H. Chiang, and H.-C. Hsiao, “Safechain: Securing trigger-
action programming from attack chains,” IEEE Transactions on Infor-
mation Forensics and Security, 2019.
[11] Z. Chen, F. Zeng, T. Lu, and W. Shu, “Multi-platform application
interaction extraction for iot devices,” in IEEE International Conference
on Parallel and Distributed Systems (ICPADS), 2019.
[12] M. Balliu, M. Merro, and M. Pasqua, “Securing cross-app interactions
in iot platforms,” in IEEE CSF, 2019.
[13] M. Alhanahnah, C. Stevens, and H. Bagheri, “Scalable analysis of
interaction threats in iot systems,” in ACM SIGSOFT International
Symposium on Software Testing and Analysis, 2020.
[14] “A comprehensive guide to smart home device compatibility,” https:
//www.adt.com/resources/smart-home-device-compatibility, 2021.
[15] “Fragmentation in IoT – one roadblock in IoT deployment,” https://www.
cleantech.com/fragmentation-in-iot-one-roadblock-in-iot-deployment/,
2017.
[16] C. Fu, Q. Zeng, H. Chi, X. Du, and S. L. Valluru, “Iot phantom-delay
attacks: Demystifying and exploiting iot timeout behaviors,” in Technical
Report, 2021.
IoT,”
https://docs.aws.amazon.com/iot/latest/developerguide/
[17] “AWS
what-is-aws-iot.html, 2021.
[18] L. Yu, B. Luo, J. Ma, Z. Zhou, and Q. Liu, “You are what you broadcast:
Identification of mobile and iot devices from (public) wifi,” in USENIX
Security Symposium, 2020.
[19] M. Miettinen, S. Marchal, I. Hafeez, N. Asokan, A.-R. Sadeghi, and
S. Tarkoma, “Iot sentinel: Automated device-type identification for
security enforcement in iot,” in IEEE ICDCS, 2017.
[20] B. Bezawada, M. Bachani, J. Peterson, H. Shirazi, I. Ray, and I. Ray,
“Iotsense: Behavioral fingerprinting of iot devices,” arXiv preprint
arXiv:1804.03852, 2018.
[21] A. K. Dalai and S. K. Jena, “Wdtf: A technique for wireless device type
fingerprinting,” Wireless Personal Communications, vol. 97, no. 2, pp.
1911–1928, 2017.
[22] Y. Meidan, M. Bohadana, A. Shabtai, M. Ochoa, N. O. Tippenhauer,
J. D. Guarnizo, and Y. Elovici, “Detection of unauthorized iot devices
using machine learning techniques,” arXiv preprint arXiv:1709.04647,
2017.
[23] M. R. Shahid, G. Blanc, Z. Zhang, and H. Debar, “Iot devices recogni-
tion through network traffic analysis,” in IEEE International Conference
on Big Data (Big Data), 2018.
[24] K. Yang, Q. Li, and L. Sun, “Towards automatic fingerprinting of iot
devices in the cyberspace,” Computer Networks, vol. 148, pp. 318–327,
2019.
[25] N. Apthorpe, D. Reisman, S. Sundaresan, A. Narayanan, and N. Feam-
ster, “Spying on the smart home: Privacy attacks and defenses on
encrypted iot traffic,” arXiv preprint arXiv:1708.05044, 2017.
[26] W. Zhang, Y. Meng, Y. Liu, X. Zhang, Y. Zhang, and H. Zhu, “Homonit:
Monitoring smart home apps from encrypted traffic,” in ACM CCS, 2018.
[27] A. Acar, H. Fereidooni, T. Abera, A. K. Sikder, M. Miettinen, H. Aksu,
M. Conti, A.-R. Sadeghi, and S. Uluagac, “Peek-a-boo: I see your smart
home activities, even encrypted!” in ACM Conference on Security and
Privacy in Wireless and Mobile Networks, 2020.
[28] T. Gu, Z. Fang, A. Abhishek, H. Fu, P. Hu, and P. Mohapatra,
“Iotgaze: Iot security enforcement via wireless context analysis,” in
IEEE INFOCOM, 2020.
[29] R. Trimananda, J. Varmarken, A. Markopoulou, and B. Demsky,
“Packet-level signatures for smart home devices,” NDSS, 2020.
[30] T. Gu, Z. Fang, A. Abhishek, and P. Mohapatra, “Iotspy: Uncovering
human privacy leakage in iot networks via mining wireless context,” in
IEEE International Symposium on Personal, Indoor and Mobile Radio
Communications, 2020.
[31] A. Subahi and G. Theodorakopoulos, “Detecting iot user behavior and
sensitive information in encrypted iot-app traffic,” Sensors, vol. 19,
no. 21, p. 4777, 2019.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:33:31 UTC from IEEE Xplore.  Restrictions apply. 
14298
[32] Y. Luo, L. Cheng, H. Hu, G. Peng, and D. Yao, “Context-rich privacy
leakage analysis through inferring apps in smart home iot,” IEEE
Internet of Things Journal, 2020.
[33] “ARP spoofing,” https://www.veracode.com/security/arp-spoofing, 2021.
[34] S. Whalen, “An introduction to arp spoofing,” Node99 [Online Docu-
ment], April, 2001.
[35] M. Antonakakis, T. April, M. Bailey, M. Bernhard, E. Bursztein,
J. Cochran, Z. Durumeric, J. A. Halderman, L. Invernizzi, M. Kallitsis
et al., “Understanding the mirai botnet,” in USENIX Security Symposium,
2017.
[36] “The Mirai IoT botnet holds strong in 2020,” https://searchsecurity.
techtarget.com/feature/The-Mirai-IoT-botnet-holds-strong-in-2020,
2020.
[37] “The Transport Layer Security (TLS) Protocol Version 1.3,” https://tools.
ietf.org/html/rfc8446, 2018.
[38] Y. J. Jia, Q. A. Chen, S. Wang, A. Rahmati, E. Fernandes, Z. M. Mao,
and A. Prakash, “Contexiot: Towards providing contextual integrity to
appified iot platforms,” in NDSS, 2017.
[39] Q. Wang, W. U. Hassan, A. Bates, and C. Gunter, “Fear and logging in
the internet of things,” in Proceedings of The Network and Distributed
System Security Symposium, 2018.
[40] W. Ding and H. Hu, “On the safety of iot device physical interaction
control,” in ACM CCS, 2018.
[41] R. Lanotte and M. Merro, “A calculus of cyber-physical systems,” in
Springer International Conference on Language and Automata Theory
and Applications, 2017.
[42] M. Hennessy and T. Regan, “A process algebra for timed systems,”
Information and computation, vol. 117, no. 2, pp. 221–239, 1995.
[43] “ADT security systems,” https://www.adt.com/, 2021.
[44] M. Surbatovich, J. Aljuraidan, L. Bauer, A. Das, and L. Jia, “Some
recipes can do more than spoil your appetite: Analyzing the security
and privacy risks of ifttt recipes,” in International Conference on World
Wide Web, 2017.
[45] M. Palekar, E. Fernandes, and F. Roesner, “Analysis of the susceptibility
of smart home programming interfaces to end user error,” in IEEE
Security and Privacy Workshops, 2019.
[46] “Atomi
smart
tower
heater,”
https://atomismart.com/product/
smart-black-tower-heater/, 2021.
[47] W. Ding, H. Hu, and L. Cheng, “IoTSafe: Enforcing safety and security
policy with real iot physical interaction discovery,” in NDSS, 2021.
[48] “Smartthings
public
github
repository,”
SmartThingsCommunity/SmartThingsPublic, 2020.
https://github.com/
[49] “IoTBench test suite,” https://github.com/IoTBench/IoTBench-test-suite,
2019.
[50] “IoT Inspector,” https://iotinspector.org/, 2021.
[51] H. Chi, Q. Zeng, X. Du, and L. Luo, “PFirewall: Semantics-aware
customizable data flow control for smart home privacy protection,” in
NDSS, 2021.
[52] “Homekit
accessory protocol,” https://developer.apple.com/support/
homekit-accessory-protocol/, 2020.
[53] R. Ogen, K. Zvi, O. Shwartz, and Y. Oren, “Sensorless, permissionless
information exfiltration with wi-fi micro-jamming,” in 12th USENIX
Workshop on Offensive Technologies (WOOT), 2018.
[54] M. Vanhoef and F. Piessens, “Advanced wi-fi attacks using commodity
[55] “Advanced wi-fi attacks using commodity hardware,” https://github.com/
hardware,” in ACSAC, 2014.
vanhoefm/modwifi, 2020.
[56] D. P. Reed and R. K. Kanodia, “Synchronization with eventcounts and
sequencers,” Communications of the ACM, vol. 22, no. 2, pp. 115–123,
1979.
[57] R. Strom and S. Yemini, “Optimistic recovery in distributed systems,”
ACM Transactions on Computer Systems (TOCS), vol. 3, no. 3, pp. 204–
226, 1985.
[58] O. Simeone, U. Spagnolini, Y. Bar-Ness, and S. H. Strogatz, “Distributed
synchronization in wireless networks,” IEEE Signal Processing Maga-
zine, vol. 25, no. 5, pp. 81–97, 2008.
[59] W. Zhou, Y. Jia, Y. Yao, L. Zhu, L. Guan, Y. Mao, P. Liu, and Y. Zhang,
“Discovering and understanding the security hazards in the interactions
between iot devices, mobile apps, and clouds on smart home platforms,”
in USENIX Security Symposium, 2019.
[60] T. OConnor, W. Enck, and B. Reaves, “Blinded and confused: uncov-
ering systemic flaws in device telemetry for smart-home internet of
things,” in ACM WiSec, 2019.
[61] E. Fernandes, J. Jung, and A. Prakash, “Security analysis of emerging
smart home applications,” in IEEE Symposium on Security and Privacy
(SP), 2016.
[62] X. Mi, F. Qian, Y. Zhang, and X. Wang, “An empirical characterization
of ifttt: ecosystem, usage, and performance,” in Internet Measurement
Conference, 2017.
[63] L. Luo, Q. Zeng, B. Yang, F. Zuo, and J. Wang, “Westworld: Fuzzing-
assisted remote dynamic symbolic execution of smart apps on iot
cloud platforms,” in Annual Computer Security Applications Conference
(ACSAC), 2021.
[64] I. Bastys, M. Balliu, and A. Sabelfeld, “If this then what?: Controlling
flows in iot apps,” in ACM CCS, 2018.
[65] Z. B. Celik, L. Babun, A. K. Sikder, H. Aksu, G. Tan, P. McDaniel,
and A. S. Uluagac, “Sensitive information tracking in commodity iot,”
in USENIX Security Symposium, 2018.
[66] X. Li, F. Yan, F. Zuo, Q. Zeng, and L. Luo, “Touch well before use:
Intuitive and secure authentication for iot devices,” in ACM MobiCom,
2019.
[67] X. Li, Q. Zeng, L. Luo, and T. Luo, “T2pair: Secure and usable pairing
for heterogeneous iot devices,” in ACM CCS, 2020.
[68] S. Lee, J. Choi, J. Kim, B. Cho, S. Lee, H. Kim, and J. Kim,
“Fact: Functionality-centric access control system for iot programming
frameworks,” in Proceedings of the 22nd ACM on Symposium on Access
Control Models and Technologies. ACM, 2017, pp. 43–54.
[69] S. Demetriou, N. Zhang, Y. Lee, X. Wang, C. A. Gunter, X. Zhou,
and M. Grace, “Hanguard: Sdn-driven protection of smart home wifi
devices from malicious mobile apps,” in ACM Conference on Security
and Privacy in Wireless and Mobile Networks, 2017.
[70] J. Choi, H. Jeoung, J. Kim, Y. Ko, W. Jung, H. Kim, and J. Kim,
“Detecting and identifying faulty iot devices in smart home with context
extraction,” in IEEE/IFIP International Conference on Dependable
Systems and Networks (DSN), 2018.
[71] S. Birnbach, S. Eberz, and I. Martinovic, “Peeves: Physical event
verification in smart homes,” in ACM SIGSAC Conference on Computer
and Communications Security (CCS), 2019.
[72] C. Fu, Q. Zeng, and X. Du, “HAWatcher: Semantics-aware anomaly
detection for appified smart homes,” in USENIX Security Symposium,
2021.
[73] R. Xu, Q. Zeng, L. Zhu, H. Chi, X. Du, and M. Guizani, “Privacy
leakage in smart homes and its mitigation: Ifttt as a case study,” IEEE
Access, vol. 7, pp. 63 457–63 471, 2019.
[74] X. Liu, Q. Zeng, X. Du, S. L. Valluru, C. Fu, X. Fu, and B. Luo,
“Sniffmislead: Non-intrusive privacy protection against wireless packet
sniffers in smart homes,” in 24th International Symposium on Research
in Attacks, Intrusions and Defenses, 2021, pp. 33–47.
[75] E. Fernandes, J. Paupore, A. Rahmati, D. Simionato, M. Conti, and
A. Prakash, “Flowfence: Practical data protection for emerging iot
application frameworks.” in USENIX Security Symposium, 2016, pp.
531–548.
[76] B. Yuan, Y. Jia, L. Xing, D. Zhao, X. Wang, D. Zou, H. Jin, and
Y. Zhang, “Shattered chain of trust: Understanding security risks in
cross-cloud iot access delegation,” in USENIX Security Symposium,
2020.
[77] J. L. Newcomb, S. Chandra, J.-B. Jeannin, C. Schlesinger, and M. Srid-
haran, “IoTA: a calculus for internet of things automation,” in ACM
SIGPLAN International Symposium on New Ideas, New Paradigms, and
Reflections on Programming and Software, 2017.
[78] R. Focardi and F. Martinelli, “A uniform approach for the definition
of security properties,” in Springer International Symposium on Formal
Methods, 1999.
[79] R. Milner, Communicating and mobile systems: the pi calculus. Cam-
bridge university press, 1999.
APPENDIX
A. Online Study on Statistics of Smart Home Deployments
We conduct an online user study on Amazon Mechanical
Turk to investigate the pervasiveness of different smart home
deployment categories in the wild, including single-platform
single-path (SPSP), single-platform multi-path (SPMP) and
multi-platform (MP) ones. In this study, we follow the ac-
ceptable use policy of Amazon Mechanical Turk.
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 12:33:31 UTC from IEEE Xplore.  Restrictions apply. 
15299
Methodology. We design a survey asking people who have
experience with IoT devices and automation to provide infor-
mation of their own deployments. Specifically, we ask them
to answer simple questions such as the number of devices
and mobile/web companion apps in their home, and more
complex questions by writing down the list of their devices,
companion apps, and automation rules. The survey questions
and responses are made publicly available at
https://github.com/HaotianChi/SH-survey.git
Results. We receive 85 responses from the survey participants.
Through a qualitative analysis on the collected information
of devices, companion apps and automation rules, we rebuild
the deployment of each participant’s home. The result shows
that the number of SPSP, SPMP and MP deployments are
15 (17.6%), 17 (20.0%) and 53 (62.4%), respectively. Among
the 53 MP deployments, 36 use two platforms, 11 use three,
5 use four and 1 uses five. A total of 82.4% deployments in
the survey are SPMP or MP deployments. The results show
that the testbed setup in Section V is realistic.
B. Formal Modeling of Smart Home Systems
We use the process calculus [41] to formally model multi-
path multi-platform smart home systems and delay-based at-
tacks. The process calculus extends the timed process calculus
[42] with two action prefixes: reading sensor values and
writing values to actuators.
Physical Environment. Let ˆF ⊂ F be a set of physical
features (e.g., temperature), ˆS ⊂ S a set of sensors, ˆA ⊂ A
a set of actuators. Note that in this paper, each actuatable
device (e.g., a lock) is conceptually split into an actuator that
executes commands and a sensor that measures the device
state. For a set of names N , we define RN as the set
of functions that assign a real value (broadly, integers and
Booleans are replaceable with reals) to each name in N . A
physical environment E is a 5-tuple ⟨ξf , ξa, evol, ξs, meas⟩:
− ξf ∈ R ˆF∪ ˆA is the state (i.e., physical features or actuator
− ξa ∈ R ˆA is the actuator function that returns the current
− evol : R ˆF∪ ˆA × R ˆA → R ˆF∪ ˆA is the evolution function,
which returns the next state function upon changes of
actuators;
− meas : R ˆF∪ ˆA → R ˆS is the measurement function that
values) function that returns the value of the state;
value of an actuator;
returns the reading of a sensor.
In addition to physical features, we include actuators in the
state function to model the dependence between actuators. For
example, a smart microwave, even turned on, cannot function
if its power cable is connected to a smart plug that is OFF. It
is not the focus of this paper to precisely model the physical
evolution laws. For the simplicity of analysis, we assume
that the evolution function evol only takes as input the state
function ξf and actuator function ξa to determine a new state
function.4 Also, we assume the sensors S measures physical
features (i.e., the meas function) without errors. Local hub
devices are omitted since they only forward messages.
IoT Processes. Processes are defined in the following syntax:
P, Q ::= nil | idle.P | π.P | P\c | P ∥ Q |
π1.P + π2.Q | if (b) {P} else {Q} | H⟨ ˜w⟩
π, π1, π2 ::= snd ¯c⟨v⟩ | rcv c(x) | read s(x) |
read a(x) | wrt ¯a(v) | τ
Terminated process is written as nil. The process idle.P
continues as P after sleeping for one time unit. Action prefixes
(ranged over π, π1, and π2) contain six actions: sending
values to channels (snd ¯c⟨v⟩), receiving values from channels
(rcv c(x)), reading new sensor measurements (read s(x)),
reading new actuator states (read a(x)), and writing values
on actuators (wrt ¯a(v)) and unobservable action (τ). P\c
behaves as P but the channel name c is restricted to P and can
only be used for communications between components within
P . We use P{v/x} to denote the substitution of the variable
x with the value v in P . The process π1.P + π2.Q is called
summations (or sums) and can enact either π1.P or π2.Q. The
process P ∥ Q denotes the parallel composition of concurrent
processes P and Q. The process if (b) {P} else {Q}
is a standard conditional statement. H⟨w1,··· , wk⟩ denotes
a recursive process and can be considered as an invocation,
with actual parameters w1,··· , wk, of the process definition
H(x1,··· , xk) = P .
Each platform L has access to a subset of all sensors ˜S ⊂ ˆS
and actuators ˜A ⊂ ˆA. The database on the platform maintains
s ∈ R ˜S that returns the current state of each sensor.
a function ξ′
For convenience, we define two database primitives: a function
value in db that returns the values of specified devices ˜x and
a meta-process update db that updates the value of a sensor:
− value in db(˜x) = {ξ′
− update db(x, v) → ξ′
Example. We use an automation rule (when the homeowner
arrives, unlock the door) on platform A and another one (when
the user says “I am home”, if the door is unlocked, lock it)
on platform B as a running example to concretize a system.
A presence sensor PS and a smart lock LK connect with a
platform A that runs R1, and a smart speaker SP and the smart
lock LK connect with platform B running R2. For the sake
of brevity, we omit all components (e.g., IoT hubs, routers,
endpoint clouds) that only forward messages. Thus, the smart
home is Sys = E (cid:49) P where the physical environment E =
⟨ξf , ξa, evol, ξs, meas⟩ is defined as
− ξf ∈ R{presence,voice,LK}, ξ0
− ξa ∈ R{LK}, ξ0