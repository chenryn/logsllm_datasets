#修改文件插入如下一行内容
#检查文件系统的挂载情况
---
## Page 79
Ivcreate。创建完成后可以分别使用pvdisplay、vgdisplay、Ivdisplay查看效果。
pvcreate，将物理卷组合为卷组的命令是vgcreate，从卷组中提取容量创建逻辑卷的命令是
例子：
用法：vgcreate[选项] 卷组名称 物理设备路径[物理设备路径..]
描述：创建卷组。
2.vgcreate
例子：
用法：
描述：使用LVM对磁盘或分区进行初始化。
通过对以上概念的了解，接下来要说明具体使用到的命令。将分区转换为物理卷的命令是
1.pvcreate
图2-5给出了是LVM整体概念的示意图。
[root@centos6~]#pvcreate/dev/sdb{1,2,3}
[root@centos6~]#pvcreate/dev/sdc4/dev/sde
pvcreate[选项]物理卷[物理卷..]
LV1
/文件系统
LVM概念示意图
PV
图2-5
PV
/home文件系统
LV2
第2章命令工具
8
---
## Page 80
test_web、test_data.
个名称为 test_vg 的卷组，最后从该卷组中创建出两个大小为120GB 的逻辑卷，名称分别为
Linux运维之道
2.4.4
9
这里我们使用sdb这块500GB的硬盘创建四个100GB的分区，并使用这四个分区创建一
[root@centos6 ~]# fdisk-cu/dev/sdb
1.使用fdisk创建分区
[root@centos6~]# 1vcreate-1 200
[root@centos6 ~]#lvcreate -L 2G -n test_lv1 test_vg1
例子：
选项：
用法：
描述：在已存在的卷组中创建逻辑卷。
3.
Last sector, +sectors or+size{K,M,G) (2048-1048575999, default 1048575999):+100G
Usingdefault value2048
First sector (2048-1048575999,default 2048):
Command action
Command （m for help):n
[root@centos6~]#vgcreate test_vg2-s 16M/dev/sdc5/dev/sdc6
[root@centos6~]# vgcreate test_vg1 /dev/sdb5 /dev/sdb6
Partitionnumber(1-4):1
lvcreate
D
创建 LVM 分区实例
：lvcreate[选项]卷组名称或路径[物理卷路径]
-n
-L直接指定逻辑卷的容量大小，单位可以是b（B)、s（S）、k（K）、m（M）、g（G)、
-1指定使用多少个卷组中的PE创建逻辑卷，PE的容量在创建卷组时已经指定。
primary partition (1-4)
extended
指定逻辑卷名称。
t（T)、p（P）或e（E)。
#指定PE大小为16MB
#使用200个PE创建逻辑卷，前面定义PE大小为16MB
-n test lv2 test_vg2
---
## Page 81
1048575999):+100G
1048575999)：
1048575999)：
+100G
..中间部分省略..
Command (m for help):P
（其他四个分区做相同的操作）
Command （m for help):t
Last
Using defaultvalue629149696
First sector (629149696-1048575999, default 629149696):
Using default value1048575999
Last
Usingdefaultvalue629147648
First sector (629147648-1048575999,
Selectedpartition4
D
Command action
Command
Last
Using default value 419432448
First sector (419432448-1048575999,
Command action
Last sector,+sectors or +size(K,M,G) (209717248-1048575999,default 1048575999):
Command
Partition number
Command action
Command
D
a
sector,
sector,
sector,
primary partition (1-4)
extended
extended
primary
primarypartition
extended
(mfor
（mfor
+100G
+sectors or +size{K,M,G}
+sectors or +size{K,M,G}
+sectors or+size{K,M,G}
partition
help):n
help):
help):
（1-4）:2
(1-4)
(1-4)
defau1t629147648):
default
defau1t209717248):
(629149696-1048575999,
(629147648-1048575999, default
(419432448-1048575999,
419432448):
#修改分区标签为LVM
#指定分区编号
第2章
default
default
命令工具
---
## Page 82
Linux运维之道
[root@centos6 ~]#vgcreate test_vg /dev/sdb(1,2,3,5}
2.使用pvcreate 创建物理卷并使用pvdisplay查看结果
[root@centos6~]#pvdisplay
[root@centos6~]#pvcreate /dev/sdb{1,2,3,5}
OpenLV
CurLV
MAX LV
VG Status
Metadata SequenceNo
Format
VG Name
..其他物理卷信息省略.
Allocated
"/dev/sdb1" is a new physical volume of "100.00 GiB"
Syncing disks.
Command（m forhelp):
System ID
PVUUID
---NEW Physical
/dev/sdb5
/dev/sdb4
/dev/sdb3
/dev/sdb2
/dev/sdb1
Device Boot
VG Access
MetadataAreas
使用vgcreate创建卷组并使用vgdisplay查看结果
FreePE
TotalPE
PE Size
Allocatable
PV
VG
PVName
Size
Name
PE
629149696
629147648
419432448
209717248
volume---
Start
2048
0
0
0
resizable
read/write
1vm2
test_vg
MEO4oH-He1C-QGeX-JR3W-Pn00-iaKo-inQmwG
0
O
0
100.00GiB
/dev/sdb1
4
1048575999
209717247
838864895
629147647
419432447
/dev/sdb
End
104857600
Blocks
104857600
209714176
104857600
104857600
#卷组名称
#物理卷大小
#物理卷名称
Id
8e
System
5
Linux LVM
Linux LVM
Extended
Linux LVM
Linux LVM
---
## Page 83
[root@centos6
>/dev/test_vg/test_web
5
4.使用Ivcreate创建逻辑卷并使用Ivdisplay查看结果
[root@centos6
EOF
[root@centos6
root@centos6
root@centos6
[root@centos6
[root@centos6
[root@centos6
[root@centos6
/dev/test_vg/test_data
格式化并挂载
Block device
Read ahead sectors
Allocation
Segments
Current
LV Size
LV Status
2
LV
LV
VGUUID
Free
Alloc PE
Total PE
PE Size
VG Size
ActPV
Cur
Max
currentlysetto
Creation host,
Write Access
UUID
Name
Name
Path
Logical
PV
PE
LE
/size
/Size
~]#mount
~]#
~]#
~]#
~]#mkfs.ext4
volume
~]#
~]#
~]#
~]#cat>>
mkfs.ext4
df-h
1vdisplay
lvcreate -n
lvcreate-n
time centos6.example.com,
rKFfkh-pcLn-18BK-7NFK-c0Yd-5rzT-t9ftpU
102396
4.00MiB
399.98GiB
available
DGR3d9-K9WS-iDRg-Z90X-CsWV-Acx7-1zQ6Ek
/dev/test_vg/test_web
102396/ 399.98GiB
inherit
2
30720
120.00GiB
test_vg
253:2
test_web
read/write
0/0
-a
/test/web
256
auto
/test/data
/etc/fstab<<EOF
/dev/test_vg/test_web
ext4
ext4
defaults0
defaults
2012-12-31 13:27:54+0800
#逻辑卷大小
#卷组名称
#剩余容量
#
#
#PE大小
#卷组大小
逻
逻辑卷路径
辑卷名
#查看文件系统挂载状态
称
第2章命令工具
9
---
## Page 84
下面我们再次扩展逻辑卷test_data的存储空间至360GB。
通过vgextend 将新的物理卷追加至现有的卷组空间中，最后使用Ivextend 调整逻辑卷的容量。
大小的，这时需要使用fdisk创建一个新的分区，并使用pvcreate命令转换为物理卷格式，接着
命令调整完逻辑卷大小后，还需要使用resize2fs命令更新文件系统的大小，具体方法如下：
以我们可以直接使用lvextend命令调整逻辑卷大小。但Ivextend仅调整逻辑卷大小，使用该
本节继续2.4.4节的案例，由于test_vg这个卷组还有足够的剩余空间可以划分给逻辑卷，所
我们需要将存储容量增大至240GB时，LVM随时可以帮助我们动态调整文件系统的大小。
Linux运维之道
1048575999)：
2.4.5
8
此外，当我们的卷组没有足够的空间划分给逻辑卷时，LVM的卷组也是可以动态调整容量
随着时间的推移，逻辑卷test_data现有的存储空间已经不能满足企业大业务量的需要，
[root@centos6 ~]# 1vextend -L 360G/dev/test_vg/test_data
（以上输出信息部分内容省略）
[root@centos6~]# fdisk-cu /dev/sdb
[root@centos6 Desktop]#
[root@centos6 Desktop]#
Usingdefault value1048575999
[root@centos6~]# df -h
[root@centos6~]#1vextend -L +120G /dev/test_vg/test_data
FreePE/Size
Command
Changed system type of partition 6 to 8e(Linux LVM)