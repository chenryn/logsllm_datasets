 40
 30
 20
 10
d
e
g
n
a
h
C
s
a
z
n
a
S
t
f
o
#
h
t
n
o
m
r
e
p
)
s
d
o
m
,
l
e
d
,
d
d
A
(
 0
 0
vlan
Mgmt
L1
Sec
L2
QoS
CTRL
L3
ACL
d
e
g
n
a
h
C
s
a
z
n
a
S
t
f
o
#
h
t
n
o
m
r
e
p
)
s
d
o
m
,
l
e
d
,
d
d
A
(
 35
 30
 25
 20
 15
 10
 5
 0
vlan
Mgmt
L1
Sec
L2
QoS
CTRL
L3
ACL
 5
 10
 15
 20
 25
 30
 0
 5
 10
 15
 20
 25
 30
Device ID (top 30)
(a) GT
Device ID (top 30)
(b) UW
Figure 6: Number of changes to each router per month for the GT and UW networks.
at the core router. This characteristic is apparent in the UW network
as well, as shown in Figure 6b. Devices aligned on the left of the
ﬁgure (device 0-5) are the core routers, which are identiﬁed by their
device names. The number of changes per month for these routers
are signiﬁcantly larger than other non-core routers. The changes
are concentrated on l1 and vlan stanzas.
This analysis shows that, depending on the function of the router
and its placement in the network, the changes to its conﬁguration
may differ signiﬁcantly. Different design and operational practices
in two networks result in distinct change patterns in routers.
4.2.2 Longitudinal analysis
Network expansion causes steady increase in conﬁguration size.
Figures 7a and 7d show how the number of lines changes, for each
router function. The ﬁgures account for all routers that were de-
ployed in the network at a single time epoch. There is a gradual
increase in overall number of lines in UW routers while it is quite
steady for the GT routers. This growth appears to be caused by de-
vices being added to the network, as shown in Figures 7c and 7f.
The number of GT routers has grown relatively slowly over the past
ﬁve years, while the UW network has added many routers over the
time period. In 2007, there are 7 cores, 10 nodes, and 6 devices
playing miscellaneous roles. By 2010, however, there are 9 cores,
12 nodes, 4 radial and hot spares, 1 VPN router, and several access
routers. There is one considerable period of growth in routers in the
GT campus network around July 2008 (Figure 7c), which caused a
signiﬁcant increase in l2, as shown in Figure 7a. This growth in
routers corresponded to the expansion of the “resnet” network in
GT.
Adding features, modifying existing commands and provision-
ing new customers using VLANs cause a lot of changes. We
now examine the evolution of a typical router conﬁguration. We
calculate the median number of lines of each function among all
505s
e
n
i
l
f
o
r
e
b
m
u
N
s
e
n
i
l
f
o
r
e
b
m
u
N
 25000
 20000
 15000
 10000
 5000
 0
 20000
 18000
 16000
 14000
 12000
 10000
 8000
 6000
 4000
 2000
 0
s
e
n
i
l
f
o
r
e
b
m
u
N
 400
 350
 300
 250
 200
 150
 100
 50
 0
Jan/06
Jan/07
Jan/08
Jan/09
Jan/10
Jan/06
Jan/07
Jan/08
Jan/09
Jan/10
Time
vlan
l3
acl
mgt
l1
l2
(a) All devices - GT
sec
cflt
qos
Time
vlan
l3
acl
mgt
l1
l2
(b) Median - GT
sec
cflt
qos
s
e
n
i
l
f
o
r
e
b
m
u
N
 500
 450
 400
 350
 300
 250
 200
 150
 100
 50
 0
Jan/06
Jan/07
Jan/08
Jan/09
Jan/10
Jan/06
Jan/07
Jan/08
Jan/09
Jan/10
Time
vlan
l3
acl
mgt
l1
l2
sec
cflt
qos
(d) All devices - UW
Time
vlan
l3
acl
mgt
l1
l2
(e) Median - UW
sec
cflt
qos
i
s
e
c
v
e
d
f
o
r
e
b
m
u
N
i
s
e
c
v
e
d
f
o
r
e
b
m
u
N
 20
 15
 10
 5
 0
 50
 45
 40
 35
 30
 25
 20
 15
 10
 5
 0
Jan/06 Jan/07 Jan/08 Jan/09 Jan/10
Time
(c) Number of devices - GT
Jan/06 Jan/07 Jan/08 Jan/09 Jan/10
Time
(f) Number of devices - UW
Figure 7: Longitudinal analysis of routers over ﬁve years. The graphs show the total number of lines of conﬁguration for all devices, the median
number of lines of conﬁguration per device, and the total number of devices over time.
routers at every time epoch. Results are shown in Figure 7b and 7e.
For the GT network, l1 is increasing over time, while l3 stays rela-
tively steady. The sudden increase of l1 seems to be caused by new
routers added to the network, again around July 2008. This is un-
derstandable, as new router devices would have a bulk of ports de-
ﬁned and opened when ﬁrst deployed. A sudden drop in acl around
January 2008 was caused by a major conﬁguration clean-up: sev-
eral core routers purged hundreds lines of access control lists, and
disabled AppleTalk routing and related instances. Several subnets
were removed from the network at this point, causing hundreds of
acl to be obsolete. For the UW network, the number of vlan and l3
lines for the median device generally decreases over time as new
devices are added, mainly because the newly added devices have
far fewer lines with these functionalities. The exception to this is
the period from from Jan 2008 to Jun 2008, where there is growth
in the conﬁguration constructs for these two functions. There are
two reasons for this: ﬁrst, the median device remains the same over
this period; as more VLANs are added, there is a steady growth in
vlan statements; and second, the introduction of multicast related
conﬁguration and new ﬁlters acl result in a sharp jump in l3 and acl
conﬁguration lines.
On the whole, we ﬁnd that a variety of network-wide factors
contribute to conﬁguration changes: network expansion, addition
of new features or modiﬁcation of existing ones, and provisioning
of new customers. No one factor appears to be the dominant reason
for conﬁguration changes, although the impact of the ﬁrst two fac-
tors, and the conﬁguration changes that result from them, appear
less often.
UW
Correlated Stanzas
l1, vlan
l1, l2, l3
l1, l3
acl, l1, l2, l3
acl, l1
GT
% Correlated stanzas
35% l1, vlan
13% l1, l2
14% acl, l1
7% l1, l3
5% l1, l3, acl
%
26%
18%
10%
9 %
5%
Table 6: Correlated stanza changes for routers.
4.2.3 Correlation analysis
We ﬁrst examine the extent to which changes to certain conﬁg-
uration constructs are correlated with others. To perform a cer-
tain high-level operational task, an operator has to change (add,
delete, or modify) many different stanzas simultaneously. Indeed,
we found that a fraction of changes—13% and 10% of all change
events in UW and GT, respectively—are indeed performed in a cor-
related fashion, involving two or more stanza types. Such correla-
tion has implications for the design of conﬁguration management
and debugging tools, as we discuss in Section 5.
Table 6 enumerates the ﬁve most common types of correlated
stanza changes. The two campuses agree in three of the ﬁve: (1) l1
and vlan: Although routers provide routing capabilities, they also
have to control reachability (i.e., offer basic connectivity between,
as well as ensure separation of, multiple subnets), which is often
achieved through the use of VLANs. Thus, a considerable amount
of change to l1 and vlan occurs; (2) l1 and acl: These change
together because adding, deleting, or modifying networks (an l1
change) often causes access control lists corresponding to the net-
works to be added, deleted, or modiﬁed to ensure consistency; and
506(3) l1 and l3: These correlated changes occur because modifying
interfaces and subnets in the routing stanzas permits redistribution
of reachability information.
Correlated l1 and l2 changes (the second most common in the
GT network) occur when deﬁning interfaces and setting a spanning-
tree protocol for that interface for which each port has a variety of
options. Similarly, correlated l1, l2 and l3 changes in UW occur
when interfaces are added, the spanning tree is modiﬁed for the
interfaces, and the routing protocol is changed to include the subnet
or to setup routing protocol/peering adjacency over the interface.
4.3 Firewalls
A ﬁrewall’s main function is to perform access control. As ex-
pected, we ﬁnd that conﬁguration changes are concentrated on acl
statements (Figures 8c and 8d). Therefore, we focus most of our
analysis instead on how ﬁrewalls are used in the respective cam-
puses and the similarities and differences in how they are used. We
ﬁnd that, despite the highly specialized nature of ﬁrewalls, their
usage across the two campuses is similar (see Figures 8 and10).
4.3.1
Snapshot and change analysis
The change characteristics are similar between two campuses.
Figures 8a and 8b show the static analysis of the latest ﬁrewall con-
ﬁguration snapshot. As expected, most of the conﬁguration is dedi-
cated to access control (note that graphs are in log scale). This char-
acteristic holds for changes as well, as shown in Figure 8c and 8d.
Most changes are dedicated to access control while other types are
mostly insigniﬁcant. High similarity in snapshot and change anal-
ysis between two different campus networks is intriguing. These
similarities also appear in the longitudinal analysis shown in Fig-
ure 10. This similarity seems to result from the fact that devices
like ﬁrewalls are designed to provide speciﬁc functionality to the
network. Most changes involve acl for both campus networks. The
actual content of commands will still differs, since network policies
from two distinct networks are far from similar.
Deployment location matters. Figure 9 shows the top 30 ﬁrewall
devices sorted in terms of number of stanza changes per month.
Again, the graph shows that changes are heavily concentrated on
acl stanzas. The number of changes per ﬁrewall is skewed, with a
few ﬁrewalls experiencing many more changes and a large set of re-
maining ﬁrewalls experiencing minimal changes per month. Upon
closer examination, we ﬁnd that the top ﬁrewalls in the GT net-
work (Figure 9a) are close to the border, and are physical devices
where multiple virtual ﬁrewall instances actually spawn from. All
changes to the virtual ﬁrewalls are reﬂected on these border ﬁre-
walls, hence showing a lot of changes compared to others. This is
true for the UW network as well. We also found a practice in the