reﬁne our matching and eliminate classes of frequently-
appearing commands, we applied our heuristic to dis-
card additional matches that passed the regular expres-
sion. This heuristic eliminated an additional 2.4% of all
processed lines and brought the total unique AT command
count down from 4,654 to 3,500, a 24.8% reduction. With
less invalid commands matched, our analytics were not
skewed and our AT command testing was faster.
Due to how the heuristic is implemented, it only has
memory of ﬁrmware image ﬁle score across a single ven-
dor. Also, it is possible for invalid commands to avoid
this check by appearing early in a ﬁle without a score or in
a ﬁle with a good score. This is a limitation and could be
improved by additional feature checking, multiple passes,
and blacklisting. In our work we found the heuristic de-
veloped to be sufﬁcient for our purposes. Additionally,
we spot-checked the spurious commands and their corre-
sponding at score to make sure that large amounts of valid
commands were not being discarded. Overall, we pur-
posefully avoided any manual ﬁltering to make importing
new datasets fast and less labor intensive.
A.3 Android Firmware Acquisition
Vendors such as Google and ASUS list all of their fac-
tory images for download on their ofﬁcial websites. A
combination of URL extraction from the HTML page
plus wget allows us to efﬁciently gather and download
each image. Other vendors do not provide their Android
ﬁrmware downloading directly. In these cases, we refer to
third-party websites (e.g., AndroidMTK.com) which col-
lect Android ﬁrmware images from various vendors.
288    27th USENIX Security Symposium
USENIX Association
not started rolling out their updates by the time of writing.
Vendor
ASUS
Google
HTC
Huawei
Lenovo
LG
LineageOS
Motorola
Samsung
Sony
ZTE
Download URL
https://www.asus.com/support
https://developers.google.com/android/
images
http://www.htc.com/us/support/rom-
downloads.html
http://www.htc.com/us/support/updates.aspx
https://androidmtk.com/download-huawei-
stock-rom-for-all-models
https://androidmtk.com/download-lenovo-
stock-rom-models
http://devtester.ro/projects/lg-firmwares/
https://download.lineageos.org/
https://firmware.center/firmware/Motorola/
https://androidmtk.com/download-samsung-
stock-rom
http://www.firmwaremobile.com/index.php/
xperiadownload/
https://freeandroidroot.com/download-zte-
stock-rom-firmware/
Table 12: A list of online resources from which we down-
loaded Android stock ﬁrmware.
Aggregation
(2018)
AT+CLCC
(2011)
AT+CHLD
(2011)
AT+VTS
(2010)
AT+COPS
(2007)
AT+CCWA
(2007)
AT+CMEE
(2005)
AT+CGSN
(1996)
AT+CMGS
(1969)
AT+CFUN
(1968)
AT+CMGW
(1967)
Google (447)
AT+CGEREP
(447)
AT+CSQ (447)
AT+CGDCON
T (447)
AT+CHLD
(447)
AT+COPS
(447)
AT+CGREG
(447)
AT+CGACT
(447)
AT+CMUT
(447)
AT+CGSN
(447)
AT+CSMS
(447)
Samsung
(373)
AT+COPS
(373)
AT+CLCC
(373)
AT+CGSN
(373)
AT+CCWA
(373)
AT+CHLD
(373)
AT+VTS (373)
AT+CMEE
(373)
AT+DEVCON
INFO (370)
AT+PROF
(368)
AT+SYNCML
(367)
LG (150)
AT+WNAM
(150)
AT%GYRO
(150)
AT%FUSG
(150)
AT%NCM
(150)
AT%LGATSE
RVICE (150)
AT%SIMID
(150)
AT%MLT
(150)
AT+BTRH
(150)
AT%MMCFO
RMAT (150)
AT%MDMLO
G (150)
Table 13: Top 10 ATcmds (frequency#) in Aggregation,
Google, Samsung, and LG.
Figure 7: Android Version Distribution.
For these third-parties, the actual download URL is
usually found after jumping through multiple site redirec-
tions, clicking JavaScript buttons, avoiding rogue down-
load buttons, and passing Turing tests. Images themselves
are usually hosted by cloud storage services such as Me-
diaFire or AndroidFileHost. Effectively, all of the images
we have gathered are publicly available with some effort
on categorizing and collecting valid URLs for download.
Factory/stock ﬁrmware is available on the ofﬁcial ven-
dor sites for ASUS, Google, and HTC. For all other ven-
dors, we rely on third-party sites that collect ﬁrmware im-
ages, among which we choose sites that claim to host only
stock ﬁrmware. We download ﬁrmware from sources
listed in Table 12.
Firmware Version Distribution. The Android version
distribution across all collected factory images is pre-
sented in Figure 7. Versions 4.x, 5.x, 6.x, and 7.x make
up the largest percentage of all images, with over 200 im-
ages of Versions 4.4, 6.0, and 7.1. We do not prioritize
speciﬁc versions during the image crawling process. The
version distribution of our dataset appears to reﬂect main-
stream Android devices that are still in use, e.g., Google
Nexus series (4.x and 5.x), LG G series (6.x), and the lat-
est Samsung Galaxy series (7.x). Note that Android 8.x
(Oreo) is intentionally excluded since most vendors had
USENIX Association
27th USENIX Security Symposium    289
Vendor
Lines Processed Matched
Invalid
Spurious
ZTE
HTC
Sony
LineageOS
Motorola
Huawei
Google
LG
ASUS
Lenovo
Samsung
Total
25,105
25,690
34,390
41,739
70,356
78,432
133,003
171,578
201,996
204,310
406,272
1,392,871
76.3%
24.1%
45.8%
62.9%
50.0%
79.7%
42.1%
41.1%
62.4%
81.6%
76.9%
64.4%
21.4%
72.5%
50.2%
36.0%
44.8%
16.5%
51.9%
57.1%
35.2%
16.8%
21.9%
33.2%
2.3%
3.3%
4.0%
1.2%
5.3%
3.8%
6.0%
1.9%
2.4%
1.6%
1.2%
2.4%
Table 15: The results of ﬁltering the lines retrieved by
grep (Lines Processed) using the AT regular expression
in Figure 4 (Matched vs. Invalid) and through applying
the at score heuristic (Spurious).
Command
ATI
AT%IMEI
AT%SYSCAT
AT%PROCCAT
AT+BATGETLEVEL?
AT+CGMM
Action
Manufacturer, model,
revision, SVN, IMEI
IMEI information
Read and return data
from /sys/*
Read and return data
from /proc/*
Battery information
Phone model
AT+CGSN
Serial number
AT+DEVCONINFO
AT+GMR
AT+GSN
AT+GSNR
AT+GSNW
AT+IMEINUM
AT+SERIALNO
AT+SIZECHECK
AT+SVCIFPGM
AT+SWVER
AT+GMM
AT+CGMI
AT+CGMR
AT+GMI
AT+VERSNAME
ATˆGSN
ATˆHWVER
ATˆMEID
ATˆSYSINFO
AT+CLAC
AT+LIST
AT+ICCID
AT$QCCLAC
AT%SWOV
AT%SWV
AT+CGSVN
AT+XGENDATA
Phone model, serial
number, IMEI, and etc.
Phone model
Serial number
Serial number
Serial number
IMEI number
Serial number
Filesystem partition
information
Partition information
and etc.
Software version
Phone model
Manufacturer
identiﬁcation
Revision identiﬁcation
Manufacturer
identiﬁcation
Android version
Serial number
Hardware version
Serial number
System information
List all supported AT
commands
List supported AT
commands
Sim card ICCID
List all supported AT
commands
(Qualcomm-speciﬁc)
Software version
Software version
IMEI information
Software version
Tested Phones
G4/S8+/Nexus5
ZenPhone2
G3/G4
G3/G4
G3/G4
Note2/S7Edge/S8+
G3/Note2/S8+/
Nexus5/ZenPhone2
Note2/ZenPhone2/
ZenPad
Note2/S7Edge/S8+
G3/G4/Note2
S8+/ZenPhone2
G4/Note2/S7Edge/S8+/
ZenPhone2/ZenPad
Note2/S7Edge/S8+
Note2/S7Edge/S8+
Note2/S7Edge/S8+
Note2/S7Edge/S8+
Note2/S7Edge/S8+
Note2/S7Edge/S8+
Note2/S7Edge/S8+
G3/G4/S7Edge/S8+/
ZenPhone2
G3/S7Edge/S8+/
Nexus5/ZenPhone2
G3/S7Edge/S8+/
ZenPhone2
G3/G4/S8+/ZenPhone2
S7Edge/S8+
G4/S8+/Nexus 5
G3/G4/S8+/Nexus5
S8+/Nexus5
S8+/Nexus5
G3/G4/S7Edge/Nexus5/
ZenPad/ZenPhone2
Nexus5
G3/G4/Nexus5
S8+/G4/Nexus5
G3
G3
ZenPhone2
ZenPhone2
Table 14: A selection of commands that leak sensitive in-
formation about the device.
290    27th USENIX Security Symposium
USENIX Association