### Refinement of Matching and Elimination of Frequent Commands

To refine our matching process and eliminate frequently-occurring commands, we applied a heuristic to discard additional matches that passed the regular expression. This heuristic eliminated an additional 2.4% of all processed lines, reducing the total unique AT command count from 4,654 to 3,500, a 24.8% reduction. By filtering out more invalid commands, our analytics became more accurate, and our AT command testing was faster.

#### Limitations of the Heuristic
The heuristic is designed to have memory of firmware image file scores only within a single vendor. As a result, invalid commands can bypass this check if they appear early in a file without a score or in a file with a good score. This limitation could be improved by implementing additional feature checking, multiple passes, and blacklisting. In our work, we found the developed heuristic to be sufficient for our needs. We also spot-checked the spurious commands and their corresponding at scores to ensure that large amounts of valid commands were not being discarded. To make importing new datasets fast and less labor-intensive, we deliberately avoided any manual filtering.

### Android Firmware Acquisition

Vendors such as Google and ASUS provide factory images for download on their official websites. We efficiently gather and download these images using a combination of URL extraction from the HTML page and `wget`. Other vendors do not offer direct downloads of their Android firmware. In these cases, we refer to third-party websites (e.g., AndroidMTK.com) that collect Android firmware images from various vendors.

#### Download URLs for Vendors
| Vendor | Download URL |
|--------|--------------|
| ASUS | https://www.asus.com/support |
| Google | https://developers.google.com/android/images |
| HTC | http://www.htc.com/us/support/rom-downloads.html, http://www.htc.com/us/support/updates.aspx |
| Huawei | https://androidmtk.com/download-huawei-stock-rom-for-all-models |
| Lenovo | https://androidmtk.com/download-lenovo-stock-rom-models |
| LG | http://devtester.ro/projects/lg-firmwares/ |
| LineageOS | https://download.lineageos.org/ |
| Motorola | https://firmware.center/firmware/Motorola/ |
| Samsung | https://androidmtk.com/download-samsung-stock-rom |
| Sony | http://www.firmwaremobile.com/index.php/xperiadownload/ |
| ZTE | https://freeandroidroot.com/download-zte-stock-rom-firmware/ |

**Table 12: Online resources for downloading Android stock firmware.**

#### Challenges with Third-Party Downloads
For third-party sites, the actual download URL is often found after navigating through multiple site redirects, clicking JavaScript buttons, avoiding rogue download buttons, and passing Turing tests. The images are usually hosted by cloud storage services like MediaFire or AndroidFileHost. All gathered images are publicly available, but some effort is required to categorize and collect valid URLs for download.

#### Firmware Version Distribution
The Android version distribution across all collected factory images is shown in Figure 7. Versions 4.x, 5.x, 6.x, and 7.x make up the largest percentage of all images, with over 200 images for versions 4.4, 6.0, and 7.1. We do not prioritize specific versions during the image crawling process. The version distribution of our dataset reflects mainstream Android devices still in use, such as the Google Nexus series (4.x and 5.x), LG G series (6.x), and the latest Samsung Galaxy series (7.x). Note that Android 8.x (Oreo) is excluded since most vendors had not started rolling out updates by the time of writing.

**Figure 7: Android Version Distribution.**

### Filtering Results

The results of filtering the lines retrieved by `grep` (Lines Processed) using the AT regular expression (Matched vs. Invalid) and through applying the at score heuristic (Spurious) are summarized in Table 15.

| Vendor | Lines Processed | Matched (%) | Invalid (%) | Spurious (%) |
|--------|-----------------|-------------|-------------|--------------|
| ZTE | 25,105 | 76.3% | 21.4% | 2.3% |
| HTC | 25,690 | 24.1% | 72.5% | 3.3% |
| Sony | 34,390 | 45.8% | 50.2% | 4.0% |
| LineageOS | 41,739 | 62.9% | 36.0% | 1.2% |
| Motorola | 70,356 | 50.0% | 44.8% | 5.3% |
| Huawei | 78,432 | 79.7% | 16.5% | 3.8% |
| Google | 133,003 | 42.1% | 51.9% | 6.0% |
| LG | 171,578 | 41.1% | 57.1% | 1.9% |
| ASUS | 201,996 | 62.4% | 35.2% | 2.4% |
| Lenovo | 204,310 | 81.6% | 16.8% | 1.6% |
| Samsung | 406,272 | 76.9% | 21.9% | 1.2% |
| Total | 1,392,871 | 64.4% | 33.2% | 2.4% |

**Table 15: Results of filtering lines using the AT regular expression and at score heuristic.**

### Commands Leaking Sensitive Information

A selection of commands that leak sensitive information about the device is provided in Table 14.

| Command | Action | Tested Phones |
|---------|--------|---------------|
| ATI | Manufacturer, model, revision, SVN, IMEI | G4/S8+/Nexus5, ZenPhone2, G3/G4, G3/G4, G3/G4, Note2/S7Edge/S8+ |
| AT%IMEI | IMEI information | G3/Note2/S8+/Nexus5/ZenPhone2, Note2/ZenPhone2/ZenPad, Note2/S7Edge/S8+ |
| AT%SYSCAT | Read and return data from /sys/* | G3/G4, G3/G4, G3/G4, S8+/ZenPhone2, G4/Note2/S7Edge/S8+/ZenPhone2/ZenPad, Note2/S7Edge/S8+ |
| AT%PROCCAT | Read and return data from /proc/* | Note2/S7Edge/S8+, G3/S7Edge/S8+/Nexus5/ZenPhone2, G3/S7Edge/S8+/ZenPhone2, G3/G4/S8+/ZenPhone2, S7Edge/S8+ |
| AT+BATGETLEVEL? | Battery information | G4/S8+/Nexus 5, G3/G4/S8+/Nexus5, S8+/Nexus5, S8+/Nexus5, G3/G4/S7Edge/Nexus5/ZenPad/ZenPhone2, Nexus5, G3/G4/Nexus5, S8+/G4/Nexus5, G3, G3, ZenPhone2, ZenPhone2 |
| AT+CGMM | Phone model | Note2/S7Edge/S8+, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G3/Note2, G