Microsoft Windows NT诊断工具（Winmsd.exe）的更新版本。
1）系统信息工具
在命令行中输入【msinfo32】命令，打开【系统信息】窗口，如图 2.1.1 所示，
可以显示出本地计算机的硬件资源、组件和软件环境的信息。除了各方面的概述信息，
还可以对正在运行任务、服务、系统驱动程序、加载的模块、启动程序等进行排查。
图2.1.1 【系统信息】窗口
第2章
网络安全应急响应工程师基础技能
2）正在运行任务
在【系统信息】窗口中，单击【软件环境】中的【正在运行任务】选项，可
查看正在运行任务的名称、路径、进程ID等详细信息，如图2.1.2所示。
图2.1.2 查看【正在运行任务】
3）服务
在【系统信息】窗口中，单击【软件环境】中的【服务】选项，可查看服务
的名称、状态、路径等详细信息，如图2.1.3所示。
图2.1.3 查看【服务】
9
网络安全应急响应技术实战指南
4）系统驱动程序
在【系统信息】窗口中，单击【软件环境】中的【系统驱动程序】选项，可
查看系统驱动程序的名称、描述、文件等详细信息，如图2.1.4所示。
图2.1.4 查看【系统驱动程序】
5）加载的模块
在【系统信息】窗口中，单击【软件环境】中的【加载的模块】选项，可查
看加载的模块的名称、路径等详细信息，如图2.1.5所示。
图2.1.5 查看【加载的模块】
6）启动程序
在【系统信息】窗口中，单击【软件环境】中的【启动程序】选项，可查看
10
第2章
网络安全应急响应工程师基础技能
启动程序的命令、用户名、位置等详细信息，如图2.1.6所示。
图2.1.6 查看【启动程序】
如果只是简单了解系统信息，还可以通过在命令行中输入【systeminfo】命令
实现，如图2.1.7所示，可查看主机名、操作系统版本等详细信息。
图2.1.7 输入【systeminfo】命令显示系统信息
2．Linux系统
对于Linux系统的主机排查，可以使用相关命令查看CPU（中央处理器）信
息、操作系统信息及模块信息等，初步了解主机情况。
1）CPU信息
在命令行中输入【lscpu】命令，可查看CPU相关信息，包括型号、主频、内
核等信息，如图2.1.8所示。
11
网络安全应急响应技术实战指南
图2.1.8 CPU相关信息
2）操作系统信息
在命令行中输入【uname -a】命令，可查看当前操作系统信息，如图 2.1.9
所示。
图2.1.9 当前操作系统信息
或在命令行中输入【cat /proc/version】命令，可查看当前操作系统版本信息，
如图2.1.10所示。
图2.1.10 当前操作系统版本信息
3）模块信息
在命令行中输入【lsmod】命令，可查看所有已载入系统的模块信息，如
图 2.1.11所示。
12
第2章
网络安全应急响应工程师基础技能
图2.1.11 所有已载入系统的模块信息
2.1.2 用户信息
在服务器被入侵后，攻击者可能会建立相关账户（有时是隐藏或克隆账户），
方便进行远程控制。攻击者会采用的方法主要有如下几种：第 1 种是最明目张胆
的，即直接建立一个新的账户（有时是为了混淆视听，账户名称与系统常用名称
相似）；第2种是激活一个系统中的默认账户，但这个账户是不经常使用的；第3
种是建立一个隐藏账户（在Windows系统中，一般在账户名称最后加$）。无论攻
击者采用哪种方法，都会在获取账户后，使用工具或是利用相关漏洞将这个账户
提升到管理员权限，然后通过这个账户任意控制计算机。
1．Windows系统
对于Windows系统中的恶意账户排查，主要有以下4种方法。
1）命令行方法
在命令行中输入【net user】命令，可直接收集用户账户信息（注意，此方法
看不到以$结尾的隐藏账户），若需查看某个账户的详细信息，可在命令行中输入
【net user username】命令（username为具体的用户名）。使用【net user k8h3d】命
13
网络安全应急响应技术实战指南
令，查看k8h3d账户的详细信息，如图2.1.12所示。（注意：本书文中使用“账户”
的正确写法，截图中仍保留“帐户”。）
图2.1.12 查看k8h3d账户的详细信息
2）图形界面方法
打开【计算机管理】窗口，单击【本地用户和组】中的【用户】选项，可查
看隐藏账户，名称以$结尾的为隐藏账户。图2.1.13中的“admin$”就是一个隐藏
账户。也可以在命令行中输入【lusrmgr.msc】命令，直接打开图形界面，查看是
否有新增/可疑的账户。
图2.1.13 查看用户信息
14
第2章
网络安全应急响应工程师基础技能
3）注册表方法
打开【注册表编辑器】窗口，选择【HKEY_LOCAL_MACHINE】下的【SAM】
选项，为该项添加【允许父项的继承权限传播到该对象和所有子对象。包括那些
在此明确定义的项目】和【用在此显示的可以应用到子对象的项目替代所有子对
象的权限项目】权限，使当前用户拥有SAM的读取权限，如图2.1.14所示。
图2.1.14 设置SAM权限
添加权限完成后按【F5】键，刷新后即可访问子项并查看用户信息，如图2.1.15
所示。
图2.1.15 查看用户信息
15
网络安全应急响应技术实战指南
同时，在此项下导出所有以00000开头的项，将所有导出的项与000001F4（该
项对应Administrator用户）导出内容做比较，若其中的F值相同，则表示可能为
克隆账户。000001F4的F值如图2.1.16所示，000001F5的F值如图2.1.17所示。
图2.1.16 000001F4的F值
图2.1.17 000001F5的F值
对导出的 F 值进行比较，发现相同，说明系统中存在克隆账户，如图 2.1.18
所示。
16
第2章
网络安全应急响应工程师基础技能
图2.1.18 对导出的F值进行比较
4）wmic方法
wmic扩展WM（I Windows Management Instrumentation，Windows管理工具），
提供从命令行接口和批命令脚本执行系统管理支持。在命令行中输入【wmic
useraccount get name，SID】命令，可以查看系统中的用户信息，如图2.1.19所示。
图2.1.19 查看系统中的用户信息
2．Linux系统
1）查看系统所有用户信息
查看系统所有用户信息可以在命令行中输入【cat /etc/passwd】命令，后续各
项由冒号隔开，分别表示“用户名”“密码加密”“用户ID”“用户组ID”“注释”
“用户主目录”“默认登录 shell”，如图 2.1.20 所示。查询的用户信息中，最后显
示“bin/bash”的，表示账户状态为可登录；显示“sbin/nologin”的，表示账户状
态为不可登录。（注意：本书截图中的部分敏感信息已进行隐藏处理。）
2）分析超级权限账户
在命令行中输入【awk -F: '{if($3==0)print $1}' /etc/passwd】命令，可查询可
登录账户UID为0的账户，如图2.1.21所示。root是UID为0的可登录账户，如
果出现其他为0的账户，就要重点排查。
17
网络安全应急响应技术实战指南
图2.1.20 查看系统所有用户信息
图2.1.21 分析超级权限账户
3）查看可登录的账户
在命令行中输入【cat /etc/passwd | grep '/bin/bash'】命令，可查看可登录的账
户，如图2.1.22所示，账户root和exam是可登录的账户。
图2.1.22 查看可登录的账户
4）查看用户错误的登录信息
在命令行中输入【lastb】命令，可查看显示用户错误的登录列表，包括错误
的登录方法、IP地址、时间等，如图2.1.23所示。
18
第2章
网络安全应急响应工程师基础技能
图2.1.23 查看用户错误的登录信息
5）查看所有用户最后的登录信息
在命令行中输入【lastlog】命令，可查看系统中所有用户最后的登录信息，
如图2.1.24所示。
图2.1.24 查看所有用户最后的登录信息
19
网络安全应急响应技术实战指南
6）查看用户最近登录信息
在命令行中输入【last】命令，可查看用户最近登录信息（数据源为/var/log/
wtmp、/var/log/btmp、/var/log/utmp），如图2.1.25所示。其中，wtmp存储登录成
功的信息、btmp存储登录失败的信息、utmp存储当前正在登录的信息。
图2.1.25 查看用户最近登录信息
7）查看当前用户登录系统情况
在命令行中输入【who】命令，可查看当前用户登录系统情况，如图 2.1.26
所示。
图2.1.26 查看当前用户登录系统情况
8）查看空口令账户
在命令行中输入【awk -F: 'length($2)==0 {print $1}' /etc/shadow】命令，可查
看是否存在空口令账户，如图2.1.27所示，admin用户未设置登录口令。
图2.1.27 查看空口令账户
2.1.3 启动项
启动项是开机时系统在前台或者后台运行的程序。操作系统在启动时，通常
20
第2章
网络安全应急响应工程师基础技能
会自动加载很多程序。启动项是病毒后门等实现持久化驻留的一种常用方法，在
应急响应中也是排查的必要项目。
1．Windows系统
Windows系统中的自启动文件是按照2个文件夹和5个核心注册表子键来自
动加载程序的。除了通过相关的工具查看，还可以通过以下两种方法进行查看。
1）通过【系统配置】对话框查看
在命令行中输入【msconfig】命令，打开Windows系统中的【系统配置】对
话框，单击【启动】选项卡，可查看启动项的详细信息，如图2.1.28所示。
图2.1.28 【系统配置】对话框