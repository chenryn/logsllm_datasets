title:Private Set Intersection: Are Garbled Circuits Better than Custom
Protocols?
author:Yan Huang and
David Evans and
Jonathan Katz
Private	
  Set	
Intersec.on:	
Are	
  Garbled	
  Circuits	
  Be9er	
than	
  Custom	
  Protocols?	
Yan	
  Huang,	
  David	
  Evans,	
  Jonathan	
  Katz	
University	
  of	
  Virginia,	
  University	
  of	
  Maryland	
www.MightBeEvil.org	
Mo0va0on	
  -­‐-­‐-­‐	
  Common	
  Acquaintances	
h;p://www.mightbeevil.com/mobile/	
Financial	
  Crypto	
  2010	
CRYPTO	
  2005	
8	
EUROCRYPT	
  2004	
C	
  2
C
T
0
0
Custom	
  Protocols	
Generic	
  Protocols	
Designed	
  around	
  speciﬁc	
  crypto	
assump.ons	
  and	
  primi.ves	
Uses	
  generic	
  and	
  ﬂexible	
cryptographic	
  primi0ves	
Cannot	
  be	
  easily	
  composed	
  with	
other	
  secure	
  computa0ons	
Can	
  securely	
  compute	
  arbitrary	
func0on	
New	
  Design	
  and	
  security	
proofs	
  need	
  to	
  be	
  done	
  for	
every	
  individual	
  scheme.	
Security	
  proofs	
automa0cally	
  derived	
from	
  the	
  generic	
  proof.	
e.g.,	
  Garbled	
Circuit	
Protocols	
Garbled	
  Circuits	
  &	
  Oblivious	
  Transfers	
a0 
a1 
b0 
b1 
AND	
x0 
AND	
x1 
Or	
  Gate	
  2	
Encx00, x11(x21) 
Encx01,x11(x21) 
Encx01,x10(x21) 
Encx00,x10(x20) 
OR	
x2 
…	
And	
  Gate	
  1	
Enca10, b11(x10) 
Enca11,b11(x11) 
Enca11,b10(x10) 
Enca10,b10(x10) 
Andrew	
  Yao,	
  1982/1986	
Free-­‐XOR	
  technique,	
  Kolesnikov	
  and	
  Shneider,	
  2008	
Alice	
Bob	
Oblivious	
  Transfer	
Protocol	
Rabin,	
  1981;	
  Even,	
  Goldreich,	
  and	
  Lempel,	
  1985;	
Naor	
  and	
  Pinkas	
  2001,	
  Ishai	
  et	
  al.,	
  2003	
Y.	
  Huang,	
  D.	
  Evans,	
  J.	
  Katz,	
  L.	
  Malka,	
  Faster	
  Secure	
  Computa0on	
  Using	
  Garbled	
  Circuits,	
  USENIX	
  Security	
  2011.	
Threat	
  Model	
Semi-­‐Honest	
  Adversary:	
  follows	
  the	
  protocol	
  as	
  speciﬁed,	
  but	
tries	
  to	
  learn	
  more	
  from	
  the	
  protocol	
  execu0on	
  transcript	
Generic	
  PSI	
  Protocols	
  Overview	
Protocols	
Bitwise-­‐AND	
(BWA)	
Cost	
  in	
  non-­‐
XOR	
  gates	
Best	
  for	
Small	
  element	
  space	
Pairwise-­‐Comparison	
(PWC)	
Sort-­‐Compare-­‐Shuﬄe-­‐WN	
(SCS-­‐WN)	
Large	
  element	
  space	
Generic	
  PSI	
  Protocols	
  Overview	
Protocols	
Bitwise-­‐AND	
(BWA)	
Cost	
  in	
  non-­‐
XOR	
  gates	
Best	
  for	
Small	
  element	
  space	
Pairwise-­‐Comparison	
(PWC)	
Sort-­‐Compare-­‐Shuﬄe-­‐WN	
(SCS-­‐WN)	
Large	
  element	
  space	
PSI:	
  Needn’t	
  be	
  Complex	
Recessive	
  genes:	
{	
  5283423,	
  1425236,	
  839523,	
  …	
  }	
Recessive	
  genes:	
{	
  5823527,	
  839523,	
  169325,	
  …	
  }	
Encode	
  set	
  elements	
  as	
  bit	
  vectors	
[	
  PAH,	
  PKU,	
  CF,	
  …	
  ]	
[	
  0,	
  0,	
  1,	
  0,	
  0,	
  0,	
  1,	
  0,	
  1,	
  1,	
  0]	
[	
  0,	
  0,	
  1,	
  0,	
  0,	
  0,	
  0,	
  0,	
  1,	
  0,	
  0]	
.	
  .	
  .	
AND	
AND	
AND	
.	
  .	
  .	
Bitwise-­‐AND	
BWA	
  Performance	
What	
  if	
  the	
  element	
  space	
  is	
  large?	
OT	
Circuit	
)
s
d
n
o
c
e
s
(
e
m
T
i
3	
2.5	
2	
1.5	
1	
0.5	
0	
8	
9	
10	
11	
12	
13	
14	
15	
16	
σ	
e
ﬄ
u
h
S
-­‐
e
r
a
p
m
o
C
-­‐
t
r
o
S
Sort:	
  Take	
advantage	
  of	
total	
  order	
  of	
elements	
Compare	
adjacent	
elements	
Shuﬄe	
  to	
  hide	
posi0ons	
e
ﬄ
u
h
S
-­‐
e
r
a
p
m
o
C
-­‐
t
r
o
S
Sort:	
  Take	
advantage	
  of	
total	
  order	
  of	
elements	
Compare	
adjacent	
elements	
Shuﬄe	
  to	
  hide	
posi0ons	
g
n
0
r
o
S
c
i
n
o
t
i
B
1	
4	
9	
7	
5	
4	
3	
2	
1	
4	
5	
4	
3	
2	
9	
7	
1	
3	
5	
9	
2	
4	
4	
7	
1	
2	
3	
4	
4	
5	
7	
9	
1	
2	
3	
4	
4	
5	
7	
9	
Sor0ng	
  Networks	
  and	
  their	
  Applica0ons,	
  Ken	
  Batcher,	
  1968	
CMP	
Filter	
CMP	
Filter	
CMP	
Filter	
   …	
CMP3	
Filter	
CMP3	
Filter	
CMP3	
Filter	
Can’t	
  reveal	
  results	
  yet!	
  Posi0on	
  leaks	
  informa0on.	
Journal	
  of	
  the	
  ACM,	
  January	
  1968	
Waksman	
  Network	
Same	
  circuit	
  can	
  generate	
  any	
  permuta0on:	
select	
  a	
  random	
  permuta0on,	
  and	
  pick	
  swaps	
gates	
Private	
  Set	
Intersec.on	
  Protocol	
Gates	
  to	
  generate	
  and	
  evaluate	
Free	
SCS-­‐WN	
  Protocol	
  Results	
Theore0cal	
  Projec0on	
Experimental	
  Observa0on	
s
d
n
o
c
e
S
1000	
100	
10	
1	
128	
256	
512	
1024	
2048	
Set	
  Size	
  (each	
  set)	
32-­‐bit	
  values	
4096	
8192	
Rela0ng	
  Performance	
  to	
  Security	
)
s
d
n
o
c
e
s
(
e
m
T
i
2000	
1800	
1600	
1400	
1200	
1000	
800	
600	
400	
200	
0	
[DT10]	
  One-­‐more-­‐DL-­‐based	
SCS-­‐WN	
  (σ=160)	
SCS-­‐WN	
  (σ=32)	
1972.0	
10.9	
51.5	
10.5	
62.4	
57.1	
11.8	
126.0	
61.5	
12.4	
97.3	
18.6	
122.7	
22.7	
369.0	
DL	
  Key-­‐sizes:	
Symmetric:	
ultra-­‐short	
(1024,	
  160)	
80	
short	
medium	
long	
ultra-­‐long	
(2048,	
  224)	
(3072,	
  256)	
(7680,	
  384)	
(15360,	
  512)	
112	
128	
192	
256	
Conclusion	
Generic	
  protocols	
  oﬀer	
  many	
  advantages	
Composability	
Flexibility	
  on	
  hardness	
  assump0ons	
Design	
  cost	
Performance	
Q	
  &	
  A?