Versions
Table
App Discovery / App Guessing
Want a small set 
of files with at 
least one present 
in every release
19
{'path': „/includes/js/dtree/img/frontpage.gif“‟,  'versions': 29}
{'path': '/images/banners/osmbanner2.png',  'versions': 33}
{'path': '/media/system/js/mootools.js',  'versions': 18}
{'path': „/includes/js/wz_tooltip.js ',  'versions': 29}
Indicator Files
It’s some version 
of Joomla
404
200 OK
App Discovery / App Guessing
20
Supporting a New App
• Gather every version you can find, dump them in a 
directory
• [Optional] Supply a regex to exclude directories/files from 
fingerprinting 
• (eg .php files, protected admin directory, .htaccess, etc)
• Use BlindElephant to build the datafiles
• Fingerprint!
• …Profit?
21
Does it work?
$./BlindElephant.py http://laws.qualys.com movabletype
Loaded movabletype with 96 versions, 2229 differentiating paths, and 209 version groups.
Starting BlindElephant fingerprint for version of movabletype at http://laws.qualys.com
Hit http://laws.qualys.com/mt-static/mt.js
Possible versions based on result: 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 4.22-en, 4.22-en, 4.22-
en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-COM
Hit http://laws.qualys.com/mt-static/js/tc/client.js
Possible versions based on result: 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 4.22-en, 4.22-en, 4.22-
en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-COM
Hit http://laws.qualys.com/mt-static/css/main.css
Possible versions based on result: 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 4.22-en, 4.22-en, 4.22-
en-COM, 4.23-en, 4.23-en, 4.23-en-COM
Hit http://laws.qualys.com/tools/run-periodic-tasks
File produced no match. Error: Error code: 404 (Not Found)
22
Does it work?
Hit http://laws.qualys.com/mt-static/js/tc/tagcomplete.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Hit http://laws.qualys.com/mt-static/js/edit.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Hit http://laws.qualys.com/mt-static/js/tc/mixer/display.js
Possible versions based on result: 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 4.22-en, 4.22-en, 4.22-
en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-COM
Hit http://laws.qualys.com/mt-static/js/archetype_editor.js
Possible versions based on result: 4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-
COM, 4.24-en, 4.24-en, 4.24-en-COM
23
Does it work?
Hit http://laws.qualys.com/mt-static/js/tc/mixer.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Hit http://laws.qualys.com/mt-static/js/tc/tableselect.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Hit http://laws.qualys.com/mt-static/js/tc/focus.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Hit http://laws.qualys.com/mt-static/js/tc.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
24
This is what 
matters!
2.0.1, 2.0.2…
3.0.4-RC4,
3.0.4
2.5.1, 2.3.16…
3.0.4-RC4,
3.0.4
3.0.4-RC4,
3.0.4, 3.5
3.0.4-RC4,
3.0.4, 3.5.1
Interlude
25
Does it work?
Hit http://laws.qualys.com/mt-static/css/simple.css
Possible versions based on result: 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 4.22-en, 4.22-en, 4.22-
en-COM, 4.23-en, 4.23-en, 4.23-en-COM
Hit http://laws.qualys.com/mt-static/mt_ja.js
Possible versions based on result: 4.2-en, 4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-
en-COM, 4.23-en-OS, 4.24-en, 4.24-en, 4.24-en-COM
Hit http://laws.qualys.com/mt-static/js/tc/gestalt.js
Possible versions based on result: 4.1-en, 4.1-en-CS, 4.2-en, 4.21-en, 4.21-en, 4.21-en-COM, 
4.22-en, 4.22-en, 4.22-en-COM, 4.23-en, 4.23-en, 4.23-en-COM, 4.24-en, 4.24-en, 4.24-en-
COM
Fingerprinting resulted in:
4.22-en, 4.22-en-COM, 4.23-en, 4.23-en-COM
Best Guess: 4.23-en-COM
26
Lets Pick on the Security Bloggers Network
$./BlindElephant.py http://www.andrewhay.ca/ wordpress
Loaded wordpress with 159 versions, 599 differentiating paths, and 226 version groups.
Starting BlindElephant fingerprint for version of wordpress at http://www.andrewhay.ca
Fingerprinting resulted in:
3.0-RC1
3.0-RC1-IIS
Best Guess: 3.0-RC1
27
BTW: It Does Plugins Too
$ ./BlindElephant.py -s -p guess http://example.com drupal
Possible plugins: 
['admin_menu', 'cck', 'date', 'google_analytics', 'imce', 'imce_swfupload', 
'pathauto', 'print', 'spamicide', 'tagadelic', 'token', 'views„]
$./BlindElephant.py -s -p imce http://example.com drupal
Fingerprinting resulted in:
6.x-1.3
28
New Toy! Lets Play
• App ID & Fingerprinting on 1,084,152 hosts
• 34k targeted scans for bug shakeout and calibration
• Shodan = Really, really useful (kinda expensive though)
• Is John here? I owe him a beer.
• Slightly biased sample (skews to default installs, s‟okay though)
• 50k and ~1M host random sample of 87M .com domains
• Stats on accuracy and net-wide webapp population are from these
29
On To the Results…
30
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
v1.0
v1.5
v2.0
Version Distribution: SomeApp
Graphing Sets of Possibilities
• Host1 Possible Versions: v1.0, v1.5, v2.0
• .33 to three version columns
• Host2 Possible Versions: v1.5, v2.0
• .5 to two version columns
• Host3 Possible Versions: v1.5
• 1.0 to v1.5
31
Graphing Sets of Possibilities
32
0
0.5
1
1.5
2
v1.0
v1.5
v2.0
“Weighted” # of Apps Running Each Release
Releases
Version Distribution: Some App
(6/18/10)
Host1
Host2
Host3
Drupal
C O N F I D E N T I A L
33
0
100
200
300
400
500
600
700
4.5.2
4.5.5
4.6.0
4.6.3
4.6.6
4.6.9
4.6.x-dev
4.7.2
4.7.5
4.7.8
4.7.11
5.1
5.4
5.7
5.10
5.13
5.16
5.19
5.22
6.1
6.4
6.7
6.10
6.13
6.16
7.0-alpha1
7.0-alpha5
# Hosts
Version Distribution: Drupal
(June 18, 2010)
Affected by A Critical Vulnerability: 70%
Joomla
C O N F I D E N T I A L
34
0
1000
2000
3000
4000
5000
6000
7000
1.0.4
1.0.6
1.0.8
1.0.9
1.0.10
1.0.11
1.0.12
1.0.13
1.0.14
1.0.15
1.5.0
1.5.1
1.5.3
1.5.4
1.5.5
1.5.6
1.5.7
1.5.8
1.5.9
1.5.10
1.5.11
1.5.12
1.5.14
1.5.15
1.5.17
1.5.18
1.6
1.6.0
# Hosts
Version Distribution: Joomla
(June 18 2010)
Affected by A “High” Vulnerability: 92%
Liferay
C O N F I D E N T I A L
35
0
2
4
6
8
10
12
14
16
4.3.0
4.4.1
4.4.2
5.1.2
5.2.1
5.2.3
# Hosts
Version Distribution: Liferay
(June 18, 2010)
Mediawiki
C O N F I D E N T I A L
36
0
20
40
60
80
100
120
140
160
180
200
1.3.11
1.3.13
1.3.18
1.5.5
1.5.8
1.6.10
1.6.12
1.7.3
1.8.4
1.9.3
1.10.1
1.10.3
1.11.0
1.11.2
1.12.1
1.12.3
1.13.0
1.13.2
1.13.4
1.14.0
1.15.0
1.15.2
1.15.4
1.16.0beta2
# Hosts
Version Distribution: Mediawiki
(June 18, 2010)
Affected by a Serious Vulnerability: 95%
Moodle
C O N F I D E N T I A L
37
0
2
4
6
8
10
12
14
16
18
1.5.4
1.6
1.6.1
1.6.2
1.6.3
1.6.4
1.6.5
1.6.6
1.6.7
1.6.8
1.6.9
1.8
1.8.3
1.8.4
1.8.6
1.8.8
1.8.11
1.9
1.9.1
1.9.2
1.9.3
1.9.4
1.9.5
1.9.6
1.9.7
1.9.8
1.9.9
# Hosts
Version Distribution: Moodle
(June 18, 2010)
Affected by a Major Vulnerability: 74%
Movabletype
C O N F I D E N T I A L
38
0
10
20
30
40