2012: [Dec 14-17]
L,S,T
L,!!
L
L
L
L
L,S
L,S
L
L
L,!
L
R,t
R,t
R,t
R,t
R,t
R,t
R,t
R,t
R,t
R,t
R,t
R
R
R
R,t
R,t
R
R,S
R,t
R,t
X,t
X,t
X,t
Aggregate statistics
Attack
Local Attempts
machines machines
74.68
133
98.50
140
293.30
113
52.50
257
12
9.00
48.50
109
16.01
22
5.60
5
38.80
44
1,494
90.80
140.60
98
33.93
158
999.70
18,815
2325.57
29,924
9,300
713.05
69.05
5,380
260.59
3,881
40.45
7,520
153.23
1,621
388.25
2,556
9,465
315.12
444.16
6,516
33.07
3,279
273.80
3,446
829.68
10,467
961
1099.85
20,844
53,219
20.84
1,912
72.30
1,971
5.27
19,639
493
38.36
133.00
344
2,846.44
63,015
591.34
19,158
45,738
1,490.26
431
286
969
378
88
185
1,097
1,734
3,496
7,445
581
377
78
130
72
33
32
108
30
20
45
48
22
31
181
258
2
10
6
190
3
3
17
67
13
Per remote avg. hourly characteristics
Per-Local
attempts
1.33
1.79
7.00
1.28
3.57
1.26
1.99
1.50
1.80
2.70
3.09
1.34
1.33
1.22
1.36
1.14
1.34
1.48
2.02
1.18
2.41
2.18
2.02
1.02
1.03
1.02
1.06
1.23
1.59
1.06
2.99
1.93
1.61
6.76
1.04
Locals
contacted
56.10
54.80
41.70
40.70
2.53
38.38
8.04
3.70
21.50
34.50
45.47
25.25
118.91
117.97
67.47
60.72
43.11
27.21
19.70
38.13
21.66
17.60
16.40
20.08
18.31
14.00
11,749
14.38
13.05
4.97
12.22
68.80
1,761.69
87.41
1,430.67
Table 4: Characteristics of the detected coordinated attack campaigns. In Appearances, numbers in parentheses reﬂect how many attack epochs occurred
during the given interval. Attrs. summarizes different attributes of the activity: L = coordination glue was set of local machines, R = coordination glue was
username “root”, X = no discernible coordination glue, S = stealthy, T = targeted, t = possibly targeted but no corroborating evidence, ! = successful, !! =
successful and apparently undetected by the site.
failing to authenticate is well-described using a beta-binomial dis-
tribution. This model enables us tune the detector to trade off an
expected level of false positives versus time-to-detection.
Using the detector we studied the prevalence of distributed brute-
forcing, which we ﬁnd occurs fairly often: for eight years of data
NATLAB
HONEY
.
o
N
t
p
m
e
t
t
A
0
0
0
0
1
0
0
0
5
0
0e+00
1e+05
2e+05
3e+05
4e+05
5e+05
6e+05
7e+05
Number of seconds elapsed since Oct 28 16:16:37 PDT 2009
Figure 10: Timing of login attempts at HONEY machine and LBNL sites
during part of attack number 8 (Oct 2009 - Nov 2009). The plot is based on
data for only one of the machines targeted during the attack at LBNL.
collected at a US National Lab, we identify 35 attack campaigns in
which the participating attack hosts would have evaded detection
by a pointwise host detector. Many of these campaigns targeted
a wide range of machines and could possibly have been detected
using a detector with a site-wide view, but we also ﬁnd instances
of stealthy attacks that would have proven very difﬁcult to detect
other than in aggregate. We correlated attacks found at the site
with data from other sites and found many of them appear at multi-
ple sites simultaneously, indicating indiscriminant global probing.
However, we also ﬁnd a number of attacks that lack such global
corroboration, at least one of which clearly targeted only the local
site. Some campaigns in addition have extensive persistence, last-
ing multiple months. Finally, we also ﬁnd that such detection can
have signiﬁcant positive beneﬁts: users indeed sometimes choose
weak passwords, enabling brute-forcers to occasionally succeed.
Acknowledgments
Our thanks to Mark Allman, Peter Hansteen, and Robin Sommer
for facilitating access to the different datasets required for this
work. Our special thanks to Aashish Sharma for running down
94various puzzles and to Partha Bannerjee and James Welcher for
providing crucial support for the processing of the LBNL dataset.
This work was supported by the U.S. Army Research Ofﬁce un-
der MURI grant W911NF-09-1-0553, and by the National Science
Foundation under grants 0831535, 1161799, and 1237265. Any
opinions, ﬁndings, and conclusions or recommendations expressed
in this material are those of the authors and do not necessarily re-
ﬂect the views of the sponsors.
8. REFERENCES
[1] BlockHosts.
http://www.aczoom.com/blockhosts/.
[2] DenyHosts.
http://denyhosts.sourceforge.net/.
[3] sshguard. http://www.sshguard.net/.
[4] The Hail Mary Cloud Data - Data collected by Peter N. M.
Hansteen (PI:EMAIL).
http://www.bsdly.net/~peter/hailmary/.
[5] ICS-ALERT-12-034-01 — SSH Scanning Activity Targets
Control Systems.
http://www.us-cert.gov/control_systems/
pdf/ICS-ALERT-12-034-01.pdf, Feburary, 2012.
[6] R. Bezut and V. Bernet-Rollande. Study of Dictionary
Attacks on SSH. Technical report, University of Technology
of Compiegne, http://files.xdec.net/TX_EN_
Bezut_Bernet-Rollande_BruteForce_SSH.pdf,
2010.
[7] D. Brook and D. A. Evans. An approach to the probability
distribution of CUSUM run length. In Biometrika,
volume 59, pages 539–549, 1972.
[8] C. Gates. Coordinated scan detection. In 16th Annual
Network and Distributed System Security Symposium, 2009.
[9] D. Gerzo. BruteForceBlocker. http://danger.rulez.
sk/projects/bruteforceblocker.
[10] D. M. Hawkins and D. H. Olwell. Cumulative sum charts
and charting for quality improvement. Springer, 1998.
[11] L. Hellemons. Flow-based Detection of SSH Intrusion
Attempts. In 16th Twente Student Conference on IT.
University of Twente, January 2012.
[12] C. Jacquier. Fail2Ban. http://www.fail2ban.org.
[13] M. Kumagai, Y. Musashi, D. Arturo, L. Romana,
K. Takemori, S. Kubota, and K. Sugitani. SSH Dictionary
Attack and DNS Reverse Resolution Trafﬁc in Campus
Network. In 3rd International Conference on Intelligent
Networks and Intelligent Systems, pages 645–648, 2010.
[14] E. L. Malecot, Y. Hori, K. Sakurai, J. Ryou, and H. Lee.
(Visually) Tracking Distributed SSH BruteForce Attacks? In
3rd International Joint Workshop on Information Security
and Its Applications, pages 1–8, Feburary, 2008.
[15] J. Owens and J. Matthews. A Study of Passwords and
Methods Used in Brute-Force SSH Attacks. In USENIX
Workshop on Large-Scale Exploits and Emergent Threats
(LEET), 2008.
[16] A. V. Siris and F. Papagalou. Application of anomaly
detection algorithms for detecting SYN ﬂooding attacks. In
IEEE GLOBECOM, pages 2050–2054. IEEE, 2004.
[17] S. Staniford, J. A. Hoagland, and J. M. McAlerney. Practical
automated detection of stealthy portscans. In 7th ACM
Conference on Computer and Communications Security,
Athens, Greece, 2000.
[18] J. Vykopal, T. Plesnik, and P. Minarik. Network-based
Dictionary Attack Detection. In International Conference on
Future Networks, 2009.
[19] H. Wang, D. Zhang, and S. K. Detecting SYN ﬂooding
attacks. In 21st Joint Conference IEEE Computer and
Communication Societies (IEEE INFOCOM), pages
1530–1539, 2002.
[20] C. M. Zhang and V. Paxson. Detecting and Analyzing
Automated Activity on Twitter. In Passive and Active
Measurement. Springer, 2011.
95