### Optimized Text

**Customer Announcement and Route Advertisement:**
A customer (AS14751) incorrectly readvertised routes learned from its provider AS2828 to another provider, AS6395. If alternative paths exist for the destination prefix, this route should not be used.

**Prefix Deaggregation:**
On May 2, 2002, within a 15-minute period, an additional 5,000 routes originating from AS705 entered the global view. The RouteNormalizer detected this by observing a sudden increase in the number of prefixes advertised by AS705, without a corresponding increase in the number of actual IP addresses. Most of these newly announced prefixes were /24s and were contained within larger /8 and /11 address blocks. If permitted by policy, the RouteNormalizer can drop these announcements to prevent the local router’s routing tables from being overwhelmed.

**AS Loop:**
The RouteNormalizer identified 12 instances of AS-level routing loops in BGP data, but there were no corresponding email complaints on the NANOG mailing list.

**Address Hijacking:**
On November 9, 2006, 86 prefixes such as 12.0.0.0/7, 121.0.0.0/8, and 15.0.0.0/8 were announced by AS29449 instead of their usual origin ASes, such as AS7018, for over 10 minutes. The cause of this event remains unknown. Using three months of historical data, the RouteNormalizer detected this by noting that these prefixes had never used AS29449 as their origin AS. Consequently, the RouteNormalizer raised alarms for suspected address hijacking.

**Instability:**
On October 5, 2005, Level3 Communications Inc. (AS3356) terminated its peering relationship with Cogent Communications Inc. (AS174). This depeering event caused reachability problems in many locations on the Internet, particularly for customers who were singly homed to either Level3 or Cogent. Using Level3’s AS3356 BGP feed, the RouteNormalizer observed explicit withdrawals for 98.7% or 2,936 distinct prefixes, which originally had an AS path containing AS174. Among these withdrawn prefixes, 1,063 distinct prefixes originated from AS174, accounting for all such prefixes. Examining the number of distinct IP addresses instead of IP prefixes, we detected withdrawals of 99.3% or 26,482,692 IPs going through AS174, and 100% or 20,541,927 IPs originated from AS174. This occurred over a period of 289 minutes. Using data from RouteView’s Cogent AS174 feed, the RouteNormalizer detected similar routing dynamics. The RouteNormalizer also detected the restoration of the peering two days later on October 7, 2005, when all previously withdrawn prefixes were re-announced.

**Identifying Events Impacting Large Numbers of Prefixes:**
When identifying events impacting a large number of prefixes, the RouteNormalizer marks these routes as anomalous. If the local router has alternate routes for these destinations, the RouteNormalizer will conservatively suggest continuing to use the alternate routes, even when the anomalous routes are re-announced due to instability concerns.

### Security Considerations
As a firewall for routers, the RouteNormalizer can be subject to various attacks, such as resource overload attacks mentioned in traffic normalizers [23]. For example, malicious peers can continuously reset the BGP session. Our strategy is to assign a penalty value per peer related to session resets to identify repeatedly flapping sessions. The penalty increases with each session reset and decreases over time, similar to route flap damping [44]. Another potential attack involves generating updates with abnormally long AS paths, which can target the most time-consuming functionalities, such as checking for AS relationship violations. The RouteNormalizer needs to search the relationship between each consecutive AS pair in the AS path. Receiving many such paths can decrease throughput. Our strategy is to calculate the actual AS path length, ignoring AS prepending, and set a threshold for the AS path length. Whenever a peer sends a significantly large number of updates with long AS paths, we raise an alarm. Additionally, we can optimize relationship checking by storing examined AS paths in memory to reduce the number of comparisons. Another optimization is to focus on relationship violations that directly impact the local AS, reducing the number of checks needed. For protection, the RouteNormalizer uses private addresses, making it inaccessible to external users.

### Related Work
It is well-known that Internet routing is vulnerable to various misconfigurations and attacks [11]. Recent studies [47, 29, 42] have focused on identifying routing anomalies using BGP data. Several protocol enhancements [40, 35, 42, 19] have been proposed to secure routing protocols, but they are either incomplete or require modifications to the routing protocol, leading to slow adoption. Complementary approaches exist without modifying BGP to identify configuration errors. IRV [20] defines a service to mitigate malicious or faulty routing information by relying on collaboration among several networks. Feamster et al. [17] applied statistical analysis to find faults in BGP configurations. Caesar et al. [12] proposed a centralized routing control platform (RCP) to facilitate configuration and route selection inside an AS. Karlin et al. [26] proposed an enhancement to BGP to slow the propagation of anomalous routes, similar to our design. Karpilovsky and Rexford [27] recently proposed an algorithm to reduce router memory usage by discarding alternate routes and refreshing on demand. Our work differs from these in that the RouteNormalizer operates online, actively identifies and corrects routing updates, and influences routing decisions without affecting reachability. The RouteNormalizer can directly use the RCP platform to take advantage of data from multiple vantage points for performing route normalization.

Parallel to our approach, Handley et al. [23] designed a data traffic normalizer for network intrusion detection. Protocol scrubbers [31, 46] have also been proposed for removing network attacks at both transport and application layers. Wang et al. [45] proposed Shield, a lightweight network filter in end-systems to protect against known vulnerabilities.

### Conclusion
In this paper, we presented the detailed design of the RouteNormalizer, which helps protect against external routing misbehavior observed at a local router by identifying and correcting malicious and misconfigured routing updates. The deployment of such a platform requires little to no changes in router configurations and no protocol modifications. Using a prototype implementation evaluated in a commercial router testbed, we showed that it can achieve good performance and scalability to support current BGP traffic rates. More importantly, we validated the benefits of real-time routing anomaly detection by analyzing empirical BGP data. The results, correlated with routing-related complaints on the NANOG mailing list, indicate that the RouteNormalizer can identify most of the known routing events impacting user performance.

### References
[References section remains unchanged]

This optimized text is more structured, clear, and professional, making it easier to understand and follow.