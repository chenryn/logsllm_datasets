the announcement from its customer (AS14751), which incor-
rectly readvertised routes learned from its provider AS2828 to
its other provider AS6395. If alternate paths exist for the des-
tination preﬁx, this route should not be used.
Preﬁx deaggregation: On May 2, 2002, within 15 minutes
an additional 5,000 routes originated from AS705 entered the
global view. The RouteNormalizer detected this by observ-
ing a sudden increase in the number of preﬁxes advertised by
AS705; however, there is no increase in the number actual IP
addresses. Most of these newly announced preﬁxes are /24s
and were contained in larger /8 and /11 address blocks. If per-
mitted by the policy, the RouteNormalizer can simply drop
these announcements to ensure that the local router’s routing
tables are not overwhelmed.
AS loop: The RouteNormalizer found 12 events of AS-level
routing loops in BGP data but there are no corresponding
email complaints posted on NANOG mailing list.
Address hijacking: On November 9 2006, 86 preﬁxes such
as 12.0.0.0/7, 121.0.0.0/8, 15.0.0.0/8 were announced by
AS29449 instead of its usual origin ASes such as AS7018,
lasting for over 10 minutes. The reason of this event is still
unknown. Using three months of history data, the RouteNor-
malizer detects this by observing that these preﬁxes never
used AS29449 as its origin AS. Consequently, the RouteNor-
malizer raises suspected address hijacking alarms.
Instability: On October 5, 2005, Level3 Communications
Inc.
(AS3356) terminated its peering relation with Cogent
Communications Inc. (AS174). This depeering event causes
8
Category
Private address
AS relationship
Preﬁx deaggregation
Address hijacking
Routing instability
Normalizer
functionality
Number of detected events
Detection ratio (total)
violation
Private IP
Export policy
Routing instability
Anomaly detection
Routing instability
address detection
violation detection
mitigation
6
5
7
in attributes
2
mitigation
15
100%(6)
83%(6)
60%(25)
Table 3. Identiﬁed NANOG routing related problems (RouteViews: Oct 2004–Nov 2006).
28.6%(7)
70%(10)
reachability problems in many locations on the Internet,
mostly for customers who are singly homed to Level3 or Co-
gent. Using Level3’s AS3356 BGP feed, the RouteNormal-
izer observes explicit withdrawals for 98.7% or 2,936 distinct
preﬁxes which originally had an AS path containing AS174.
Among these withdrawn preﬁxes, 1,063 distinct preﬁxes were
originated from AS174, accounting for all such preﬁxes. Ex-
amining the number of distinct IP addresses instead of IP pre-
ﬁxes, we detect withdrawals of 99.3% or 26,482,692 IPs go-
ing through AS174, and 100% or 20,541,927 IPs originated
from AS174. This occurred over the time period of 289 min-
utes. Using the data from RouteView’s Cogent AS174 feed,
the RouteNormalizer detects similar routing dynamics. The
RouteNormalzer also detects the restoration of the peering
two days later on October 7, 2005. All preﬁxes previously
withdrawn were re-announced.
Identifying events impact-
ing a large number of preﬁxes, the RouteNormalizer marks
these routes as anomalous. If the local router has alternate
routes for these destinations, the RouteNormalizer will con-
servatively suggest to continue using the alternate routes even
when these anomalous routes are re-announced due to insta-
bility concerns.
6 Security Considerations
As a ﬁrewall for routers, the RouteNormalizer can be at-
tacked in various ways, e.g., resource overload attacks men-
tioned in trafﬁc normalizer [23]. Our emulation of the grace-
ful restart feature is one such example. Malicious peers can
continuously reset the BGP session. Our strategy is to assign
a penalty value per peer related to session reset to identify re-
peatedly ﬂapping sessions. The penalty increases with each
session reset and decreases over time, similar to route ﬂap
damping [44]. Another example is that attackers may focus
on the most time-consuming functionalities such as check-
ing for AS relationship violation by generating updates with
abnormally long AS paths. The RouteNormalizer needs to
search the relationship between each consecutive AS pairs in
the AS path. Receiving many such paths may result in de-
creasing throughput. Our strategy is to calculate the actual AS
path length ignoring AS prepending and set a threshold for the
AS path length. Whenever a peer sends a signiﬁcantly large
number of updates with long AS paths, we raise an alarm.
Moreover, we can optimize the relationship checking by stor-
ing examined AS path in the memory to reduce the number
of comparisons. Another optimization is to focus on the rela-
tionship violations that directly impact the local AS, reducing
the number of checks needed. For protection, the RouteNor-
malizer is numbered with private addresses, so that external
users cannot directly send packets to it.
9
7 Related Work
It has been well-known that the Internet routing is vul-
nerable to various misconﬁgurations and attacks [11]. Re-
cent studies [47, 29, 42] have focused on identifying rout-
ing anomalies using BGP data. Several protocol enhance-
ments [40, 35, 42, 19] have been proposed to secure routing
protocols. However, they are either incomplete or requires
modiﬁcation of the routing protocol leading to slow adoption.
Complementary approaches exist without modifying BGP to
identify conﬁguration errors. IRV [20] deﬁnes such a service
to mitigate malicious or faulty routing information by relying
on collaboration among several networks. Feamster et al. [17]
applied statical analysis to ﬁnd faults in BGP conﬁgurations.
Caesar et al. [12] proposed a centralized routing control plat-
form (RCP) to facilitate conﬁguration and route selection in-
side an AS. Karlin et al. [26] proposed an enhancement to
BGP to slow the propagation of anomalous routes, similar to
our design. Karpilovsky and Rexford [27] recently proposed
an algorithm to reduce router memory usage by discarding
alternate routes and refreshing on demand. Our work mainly
differs from these work in that the RouteNormalizer operates
online and actively identiﬁes and correct routing updates, as
well as inﬂuence routing decisions without affecting reacha-
bility. RouteNormalizer can directly use the RCP platform to
take advantage of data from multiple vantage points for per-
forming route normalization.
Parallel to our approach, instead of normalizing routing
updates, Handley et al. [23] designed a data trafﬁc normalizer
for network intrusion detection. Protocol scrubbers [31, 46]
have also been proposed for removing network attacks at both
transport and application layers. Wang et al. [45] proposed
shield – a lightweight network ﬁlter in end-system to protect
against known vulnerability.
8 Conclusion
In this paper, we presented the detailed design of the
RouteNormalizer which helps protect against external rout-
ing misbehavior observed at a local router by identifying and
correcting malicious and misconﬁgured routing updates. The
deployment of such a platform requires little to no changes
in router conﬁgurations and no protocol modiﬁcations. Using
a prototype implementation evaluated in a commercial router
testbed, we showed that it can achieve good performance and
scalability to support current BGP trafﬁc rate. More impor-
tantly, we validated the beneﬁt of routing anomaly detec-
tion in real time by analyzing empirical BGP data. The re-
sults from correlating with routing related complaints on the
NANOG mailing list indicate that the RouteNormalizer can
identify most of the known routing events impacting user per-
formance.
References
[25] C. S. Inc. BGP Restart Session After Max-Preﬁx Limit. .
[26] J. Karlin, S. Forrest, and J. Rexford. Pretty Good BGP: Im-
proving BGP by cautiously adopting routes. In Proc. Interna-
tional Conference on Network Protocols, 2006.
[27] E. Karpilovsky and J. Rexford. Using forgetful routing to con-
[1] Distributed Intrusion Detection System.
http://www.
dshield.org/.
[2] GNU Zebra – routing software. http://www.zebra.org.
[3] NANOG Mailing List Information. http://www.nanog.
org/mailinglist.html.
[4] NANOG Maling List Information. http://www.nanog.
org/mailinglist.html.
[5] Spam Archive, Donate Your Spam to Science. http://www.
spamarchive.org/.
[6] University of Oregon Route Views Archive Project. www.
routeviews.org.
[7] Cisco Security Advisory: Cisco IOS BGP Attribute Corruption
Vulnerability, 2001.
[8] G. Battista, M. Patrignani, and M. Pizzonia. Computing the
Types of the Relationships Between Autonomous Systems. In
Proc. IEEE INFOCOM, March 2003.
[9] S. Bellovin. Where the Wild Things are: BGP Threats. Nanog
28 Talk, Jun 2003.
[10] V. J. Bono. 7007 Explanation and Apology. NANOG 97-04.
[11] K. Butler, T. Farley, P. McDaniel, and J. Rexfod. A Survey of
BGP Security Issues and Solutions. Technical Report Technical
Report TD-5UGJ33, AT&T Labs - Research, 2004.
[12] M. Caesar, D. Caldwell, N. Feamster, J. Rexford, A. Shaikh,
and J. van der Merwe. Design and Implementation of a Rout-
ing Control Platform. In Proc. 2nd Symposium on Networked
Systems Design and Implementation (NSDI), 2005.
[13] D. Chang, R. Govindan, and J. Heidemann. An Empirical
Study of Router Response to Large BGP Routing Table Load.
In Proc. ACM SIGCOMM Internet Measurement Workshop,
2002.
[14] S. Chavali, V. Radoaca, M. Miri, L. Fang, and S. Hares. draft-
chavali-bgp-preﬁxlimit-02.txt: Peer Preﬁx Limits Exchange in
BGP, April 2004.
[15] S. Convery and M. Franz. BGP Vulnerability Testing: Sepa-
rating Fact from FUD. Nanog 28, June 2003.
[16] J. Cowie, A. T. Ogielski, B. Premore, and Y. Yuan.
Internet
Worms and Global Routing Instabilities. In Proc. SPIE, 2002.
[17] N. Feamster and H. Balakrishnan. Detecting BGP Conﬁgura-
tion Faults with Static Analysis. In Proc. 2nd Symposium on
Networked Systems Design and Implementation (NSDI), May
2005.
[18] L. Gao. On Inferring Autonomous System Relationships in the
Internet. In Proc. IEEE Global Internet Symposium, 2000.
[19] V. Gill, J. Heasly, and D. Meyer. The BGP TTL Security Hack.
NANOG 0302.
[20] G. Goodell, W. Aiello, T. Grifﬁn, J. Ioanmidis, P. McDaniel,
and A. Rubin. Working around BGP: an Incremental Approach
to Improving Security and Accuracy in Interdomain Routing.
In Proc. NDSS, 2003.
[21] T. G. Grifﬁn and G. Wilfong. On the Correctness of iBGP
Conﬁguration. In Proc. ACM SIGCOMM, August 2002.
[22] S. Halabi and D. McPherson. Internet Routing Architectures.
Cisco Press, Indianapolis, Indiana, second edition, 2000.
[23] M. Handley, C. Kreibich, and V. Paxson. Network Intrusion
Detection: Evasion, Trafﬁc Normalization, and End-to-End
Protocol Semantics.
In Proc. USENIX Security Symposium,
2001.
[24] J. W. S. III. BGP4 Inter-Domain Routing in the Internet.
Addison-Wesley, 1999.
10
trol BGP table size. In Proc. CoNext, 2006.
[28] C. Labovitz, A. Ahuja, A. Bose, and F. Jahanian. Delayed In-
ternet Routing Convergence. In Proc. ACM SIGCOMM, 2000.
[29] R. Mahajan, D. Wetherall, and T. Anderson. Understanding
In Proc. ACM SIGCOMM, August
BGP misconﬁgurations.
2002.
[30] F. Majstor. Attack on the Routing Protocols. RSA 2002. Cisco
System Inc.
[31] G. R. Malan, D. Watson, F. Jahanian, and P. Howell. Trans-
In Proc. IEEE IN-
port and Application Protocol Scrubbing.
FOCOM, 2000.
[32] D. McGrath. Passive Internet Health Monitoring With BGP.
Nanog 0310.
[33] D. Meyer and A. Partan. S-BGP/soBGP Panel: What Do We
Really Need and How Do We Architect a Compromise to Get
It? NANOG 0306, June 2003.
[34] S. Murphy. BGP Vulnerabilities Analysis.
IETF draft June
[35] J. Ng. Extensions to BGP to Support Secure Origin BGP
IETF Draft: draft-ng-sobgp-bgp-extensions-01.txt,
2003.
(soBGP).
November 2002.
[36] C. Panigl, J. Schmitz, P. Smith, and C. Vistoli. RIPE Routing-
WG Recommendations for Coordinated Route-ﬂap Damping
Parameters, October 2001. Document ID: ripe-229.
[37] Y. Rekhter and T. Li. A Border Gateway Protocol. RFC 1771,
March 1995.
[38] J. Rexford, J. Wang, Z. Xiao, and Y. Zhang. BGP Routing
In Proc. ACM SIGCOMM
Stability of Popular Destinations.
Internet Measurement Workshop, November 2002.
[39] S. R. Sangli, Y. Rekhter, R. Fernando, J. G. Scudder, and
E. Chen. Graceful Restart Mechanism for BGP. IETF Inter-
net Draft, June 2004.
[40] Stephen Kent and Charles Lynn and Karen Seo. Secure Border
IEEE J. Selected Areas in
Gateway Protocol (Secure-BGP).
Communications, 2000.
[41] L. Subramanian, S. Agarwal, J. Rexford, and R. H. Katz. Char-
acterizing the Internet hierarchy from multiple vantage points.
In Proc. IEEE INFOCOM, 2002.
[42] L. Subramanian, V. Roth, I. Stoica, S. Shenker, and R. H. Katz.
Listen and Whisper: Security Mechanisms for BGP. In Proc.
ﬁrst Symposium on Networked Systems Design and Implemen-
tation (NSDI), 2004.
[43] US-CERT. Multiple Denial-of-Service Vulnerabilities in Cisco
IOS.
[44] C. Villamizar, R. Chandra, and R. Govindan. BGP Route Flap
Damping. RFC 2439, 1998.
[45] H. J. Wang, C. Guo, D. R. Simon, and A. Zugenmaier. Shield:
Vulnerability-Driven Network Filters for Preventing Known
Vulnerability Exploits. In Proc. ACM SIGCOMM, 2004.
[46] D. Watson, M. Smart, G. R. Malan, and F. Jahanian. Protocol
Scrubbing: Network Security Through Transparent Flow Mod-
iﬁcation. IEEE/ACM Transactions on Networking, 2004.
[47] X. Zhao, D. Pei, L. Wang, D. Massey, A. Mankin, S. F. Wu, and
L. Zhang. An Analysis of BGP Multiple Origin AS (MOAS)
Conﬂicts.
In Proc. ACM SIGCOMM Internet Measurement
Workshop, November 2001.