These strong assumptions of previous attacks have given the
false impression about their applicability and as a result,
leakage-abuse attacks have been characterized in the past
as “of theoretical interest”. The power and the generality of
our reconstruction techniques, which overcome these strong
assumptions, lie in the synergetic analysis of both the access-
pattern and the search-pattern leakage. Experimental results
demonstrate that an attacker can achieve accurate reconstruction
under a wide variety of skewed query distributions and under
various database densities without parametrizing the algorithms
and without access to any auxiliary information.
VIII. ACKNOWLEDGMENTS
This work was done while the ﬁrst author was afﬁliated
with Brown University and was supported in part by the U.S.
National Science Foundation and by NIST.
REFERENCES
[1] G. Asharov, M. Naor, G. Segev, and I. Shahaf, “Searchable Symmetric
Encryption: Optimal Locality in Linear Space via Two-dimensional
Balanced Allocations,” in Proc. of the 48th ACM STOC, 2016, pp. 1101–
1114.
[2] G. Asharov, G. Segev, and I. Shahaf, “Tight Tradeoffs in Searchable
Symmetric Encryption,” in Proc. of the 38th CRYPTO, 2018, pp. 407–436.
[3] T. Batu, L. Fortnow, R. Rubinfeld, W. D. Smith, and P. White, “Testing
that Distributions are Close,” in Proc. of the 41st IEEE FOCS, 2000, pp.
259–269.
[4] R. Bost, “
oϕoς: Forward Secure Searchable encryption,” in Proc. of
(cid:4)
the 23rd ACM CCS, 2016, pp. 1143–1154.
[5] J. Bunge and M. Fitzpatrick, “Estimating the Number of Species: A
Review,” Journal of the American Statistical Association, vol. 88, no.
421, pp. 364–373, 1993.
[6] K. P. Burnham and W. S. Overton, “Estimation of the Size of a Closed
Population when Capture Probabilities vary Among Animals,” Biometrika,
vol. 65, no. 3, pp. 625–633, 1978.
[7] ——, “Robust Estimation of Population Size When Capture Probabilities
Vary Among Animals,” Ecology, vol. 60, no. 5, pp. 927–936, 1979.
[8] D. Cash, P. Grubbs, J. Perry, and T. Ristenpart, “Leakage-Abuse Attacks
Against Searchable Encryption,” in Proc. of the 22nd ACM CCS, 2015,
pp. 668–679.
[9] D. Cash, J. Jaeger, S. Jarecki, C. S. Jutla, H. Krawczyk, M. Rosu, and
M. Steiner, “Dynamic Searchable Encryption in Very-Large Databases:
Data Structures and Implementation,” in Proc. of the 21st NDSS, 2014.
[10] D. Cash and S. Tessaro, “The Locality of Searchable Symmetric
Encryption,” in Proc. of the 33rd EUROCRYPT, 2014, pp. 351–368.
[11] J. G. Chamani, D. Papadopoulos, C. Papamanthou, and R. Jalili, “New
Constructions for Forward and Backward Private Symmetric Searchable
Encryption,” in Proc. of the 25th ACM CCS, 2018, pp. 1038–1055.
[12] A. Chao and C.-H. Chiu, Species Richness: Estimation and Comparison.
American Cancer Society, 2016, pp. 1–26.
[13] M. Chase and S. Kamara, “Structured encryption and controlled
disclosure,” in Proc. of the 16th ASIACRYPT, 2010.
[14] H. Chen, I. Chillotti, Y. Dong, O. Poburinnaya, I. Razenshteyn, and M. S.
Riazi, “SANNS: Scaling Up Secure Approximate k-Nearest Neighbors
Search,” Cryptology ePrint Archive, Report 2019/359, 2019, https://
eprint.iacr.org/2019/359.
[15] R. Curtmola, J. A. Garay, S. Kamara, and R. Ostrovsky, “Searchable
Symmetric Encryption: Improved Deﬁnitions and Efﬁcient Constructions,”
in Proc. of the 13th ACM CCS, 2006, pp. 79–88.
[16] I. Demertzis, D. Papadopoulos, and C. Papamanthou, “Searchable en-
cryption with optimal locality: Achieving sublogarithmic read efﬁciency,”
in Proc. of the 38th CRYPTO, 2018, pp. 371–406.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 22,2021 at 04:12:16 UTC from IEEE Xplore.  Restrictions apply. 
1236
[17] I. Demertzis, S. Papadopoulos, O. Papapetrou, A. Deligiannakis, and
M. Garofalakis, “Practical Private Range Search Revisited,” in Proc. of
ACM SIGMOD, 2016, pp. 185–198.
[18] I. Demertzis and C. Papamanthou, “Fast Searchable Encryption With
Tunable Locality,” in Proc. of ACM SIGMOD, 2017, pp. 1053–1067.
[19] I. Diakonikolas, T. Gouleakis, J. Peebles, and E. Price, “Collision-
based Testers are Optimal for Uniformity and Closeness,” Electronic
Colloquium on Computational Complexity (ECCC), vol. 23, p. 178, 2016.
[20] F. B. Durak, T. M. DuBuisson, and D. Cash, “What Else is Revealed by
Order-Revealing Encryption?” in Proc. of the 23rd ACM CCS, 2016, pp.
1155–1166.
[21] B. Efron and R. Thisted, “Estimating the Number of Unseen Species:
How Many Words Did Shakespeare Know?” Biometrika, vol. 63, no. 3,
pp. 435–447, 1976.
[22] S. Faber, S. Jarecki, H. Krawczyk, Q. Nguyen, M. Rosu, and M. Steiner,
“Rich Queries on Encrypted Data: Beyond Exact Matches,” in Proc. of
the 20th ESORICS, 2015, pp. 123–145.
[23] B. Fuller, M. Varia, A. Yerukhimovich, E. Shen, A. Hamlin, V. Gadepally,
R. Shay, J. D. Mitchell, and R. K. Cunningham, “SoK: Cryptographically
Protected Database Search,” in Proc. of the 38th IEEE S&P, 2017, pp.
172–191.
[24] A. Gandolﬁ and C. C. A. Sastri, “Nonparametric estimations about species
not observed in a random sample,” Milan Journal of Mathematics, vol. 72,
no. 1, pp. 81–105, Oct 2004.
[25] O. Goldreich, Introduction to Property Testing. Cambridge University
Press, 2017.
[26] O. Goldreich and D. Ron, “On Testing Expansion in Bounded-Degree
Graphs,” Electronic Colloquium on Computational Complexity (ECCC),
vol. 7, no. 20, 2000.
[27] P. Grubbs, M. Lacharit´e, B. Minaud, and K. G. Paterson, “Learning
to Reconstruct: Statistical Learning Theory and Encrypted Database
Attacks,” in Proc. of the 40th IEEE S&P, 2019, pp. 496–512.
[28] P. Grubbs, K. Sekniqi, V. Bindschaedler, M. Naveed, and T. Ristenpart,
“Leakage-Abuse Attacks against Order-Revealing Encryption,” in Proc.
of the 38th IEEE S&P, 2017, pp. 655–672.
[29] B. Harris, “Statistical Inference in the Classical Occupancy Problem
Unbiased Estimation of the Number of Classes,” Journal of the American
Statistical Association, vol. 63, no. 323, pp. 837–847, 1968.
[30] M. S. Islam, M. Kuzu, and M. Kantarcioglu, “Access Pattern Disclosure
on Searchable Encryption: Ramiﬁcation, Attack and Mitigation,” in Proc.
of the 19th NDSS, 2012.
[31] S. Kamara, C. Papamanthou, and T. Roeder, “Dynamic Searchable
Symmetric Encryption,” in Proc. of the 19th ACM CCS, 2012, pp. 965–
976.
[32] G. Kellaris, G. Kollios, K. Nissim, and A. O’Neill, “Generic Attacks on
Secure Outsourced Databases,” in Proc. of the 23rd ACM CCS, 2016,
pp. 1329–1340.
[33] E. M. Kornaropoulos, C. Papamanthou, and R. Tamassia, “Data Recovery
on Encrypted Databases With k-Nearest Neighbor Query Leakage,” in
Proc. of the 40th IEEE S&P, 2019.
[34] M. S. Lacharit´e, B. Minaud, and K. G. Paterson, “Improved reconstruction
attacks on encrypted data using range query leakage,” in Proc. of the
39th IEEE S&P, 2018, pp. 1–18.
[35] M. Lacharit´e and K. Paterson, “Frequency-Smoothing Encryption:
Preventing Snapshot Attacks on Deterministically Encrypted Data,” IACR
Transactions on Symmetric Cryptology, vol. 2018, no. 1, pp. 277–313,
Mar. 2018.
[36] R. C. Lewontin and T. Prout, “Estimation of the Number of Different
Classes in a Population,” Biometrics, vol. 12, no. 2, pp. 211–223, 1956.
[37] E. A. Markatou and R. Tamassia, “Full Database Reconstruction with
Access and Search Pattern Leakage,” in Proc. of the 22nd ISC, 2019.
[38] M. Naveed, S. Kamara, and C. V. Wright, “Inference Attacks on Property-
Preserving Encrypted Databases,” in Proc. of the 22nd ACM CCS, 2015,
pp. 644–655.
[39] R. A. Popa, C. M. S. Redﬁeld, N. Zeldovich, and H. Balakrishnan,
“CryptDB: Protecting Conﬁdentiality with Encrypted Query Processing,”
in Proc. of the 23rd ACM SOSP, 2011, pp. 85–100.
[40] M. H. Quenouille, “Approximate Tests of Correlation in Time-Series,”
Journal of the Royal Statistical Society. Series B (Methodological), vol. 11,
no. 1, pp. 68–84, 1949.
[41] D. X. Song, D. A. Wagner, and A. Perrig, “Practical Techniques for
Searches on Encrypted Data,” in Proc. of the 21st IEEE S&P, 2000, pp.
44–55.
⎡⎢⎢⎣
M =
⎤⎥⎥⎦
[42] A. Stam, “Statistical Problems in Ancient Numismatics,” Statistica
Neerlandica, vol. 41, no. 3, pp. 151–174.
[43] E. Stefanov, C. Papamanthou, and E. Shi, “Practical Dynamic Searchable
Encryption with Small Leakage,” in Proc. of the 21st NDSS, 2014.
[44] G. Valiant and P. Valiant, “Estimating the Unseen: Improved Estimators
for Entropy and Other Properties,” J. ACM, vol. 64, no. 6, pp. 37:1–37:41,
Oct. 2017.
[45] Y. Zhang, J. Katz, and C. Papamanthou, “All Your Queries Are Belong
to Us: The Power of File-Injection Attacks on Searchable Encryption,”
in Proc. of the 25th USENIX Security, 2016, pp. 707–720.
IX. APPENDIX
Proof of Theorem 2: We ﬁrst show that the function in
equation (3) is convex. Notice that the inner functions, i.e. (xi +
xj−log((cid:9)Li,j)), can be interpreted as convex functions, i.e. strict
with the quadratic function, i.e. (xi + xj − log((cid:9)Li,j))2, output a
equality in the deﬁnition of convexity, and their composition
convex function. Furthermore it is known that the non-negative
weighted sum of convex function preserves convexity which
means that the function of (3) is convex. Due to convexity of (3)
every local minima is global. The next step is to show that there
exists a unique solution. Notice that the following matrix of
coefﬁcients M derived from the partial derivatives, also appears
in Line 8 of Algorithm Agnostic-Reconstruction-Range, and
is symmetric.
(cid:2)
(cid:2)
j(cid:4)=0 2w0,j
2w0,1
. . .
2w0,n
2w0,1
j(cid:4)=1 2w1,j
. . .
2w1,n
. . .
. . .
. . .
. . .
2w0,n
2w1,n
. . .
(cid:2)
j(cid:4)=n 2wj,n
(cid:12)yT ·
(cid:18)(cid:2)
(cid:24)
y0
If we show that (cid:12)yT M (cid:12)y > 0 for all vectors (cid:12)y (cid:6)= 0, then the
matrix is positive deﬁnite which implies that there is a unique
solution. We want to show (cid:12)yT M y > 0. Thus:
⎡⎢⎢⎣
(cid:2)
(cid:12)yT M y > 0 ⇒ 2(cid:12)yT 1
(cid:2)
2
w0,1
j(cid:4)=1
. . .
w1,n
j(cid:4)=0
w0,1
. . .
w0,n
w0,j
M y > 0 ⇒ (cid:12)yT 1
2
w0,n
(cid:2)
w1,n
. . .
j(cid:4)=n wj,n
. . .
. . .
. . .
. . .
w1,j
M y > 0 ⇒
⎤⎥⎥⎦ · (cid:12)y > 0 ⇒
j(cid:4)=0
w0,j
j(cid:4)=0
yjw0,j
. . .
yn
· (cid:12)y > 0 ⇒
(cid:18)(cid:2)
(cid:2)
+
(cid:19)
(cid:2)
(cid:18)
(cid:2)n
(cid:10)
(cid:2)
(cid:2)
y2
i
i=0
+
(cid:25)
(cid:19)
j(cid:4)=n wj,n
(cid:2)
(cid:19)
(cid:18)(cid:2)
(cid:2)
0≤i 0 ⇒
j(cid:4)=n yjwj,n
> 0 ⇒
j(cid:4)=i yjwi,j
(cid:2)
(cid:11)
> 0 ⇒
(cid:19)
(cid:11)
(cid:10)
j(cid:4)=i wi,j
+ yi
0≤i 0
, which is true since wi, j is always positive.
On the derivation of the Jackknife Estimators. Let m
be the number of queries, k be the order of the jackknife
estimator, d be the number of observed distinct queries, and
F = (f1, . . . , fm) be the ﬁngerprint of sample D of queries.
The formulation of the bias corrected jackknife estimator (cid:9)NJ(k)
of order k is given by:
λm−j = d −(cid:10)
(cid:18)
(cid:2)k
j=1(−1)j
(cid:11)−1(cid:2)j
(cid:10)
mkd +
m
j
k!
(cid:9)NJ(k) = 1
t=1
(cid:11)
k
j
(cid:10)
ft,
m−t
j−t
(m − j)kλm−j
(cid:19)
.
(cid:11)
Authorized licensed use limited to: Tsinghua University. Downloaded on March 22,2021 at 04:12:16 UTC from IEEE Xplore.  Restrictions apply. 
1237
Proof of Lemma 2. We replace every Li with the term
Li + δi so as to consider the distortion variables δ0, . . . , δn−k
we get: ξ0 − δ0 ≤ L0
Lower Boundary Constraint: Using Lemma 5 from [33]:
α < v0 ⇒ α ≤ b0,k − ξ0 ⇒ ξ0 ≤ b0,k − α
⇒ ξ0 ≤ Len({id0, . . . , idk−1}) ⇒ ξ0 ≤ L0
Upper Boundary Constraint:
+(−1)
(cid:6)(n−1)/k−1(cid:7)
2(−1)j+(cid:6)(n−1)/k(cid:7) ·
(cid:6)(n−1)/k(cid:7)(cid:4)
+
j=2
(−1)
(α +
(n−1) mod k(cid:4)
(cid:6)(n−1)/k−1(cid:7)ξ(n−1) mod k+
⎛⎜⎜⎝((n−1) mod k)
+(j−1)k(cid:4)
(Lm + δm)
j=0
m=0
j=2
m=0
Proof of Lemma 1: The proof is derived from Lemma 8
in [33] by substituting Li with (Li + δi) for i ∈ [0, n − k].
vn−1 < β ⇒
δj+
(Lj + δj) +
⎞⎟⎟⎠ < β ⇒
(cid:6)(n−1)/k−1(cid:7) (n−1) mod k(cid:4)
⎞⎟⎟⎠
⎛⎜⎜⎝((n−1) mod k)
+(j−1)k(cid:4)
(cid:6)(n−1)/k−1(cid:7) (n−1) mod k(cid:4)
⎞⎟⎟⎠
⎛⎜⎜⎝((n−1) mod k)
+(j−1)k(cid:4)
Lm
m=0
δm
Lj
j=0
j=0
(−1)
(cid:6)(n−1)/k−1(cid:7)ξ(n−1) mod k + (−1)
(cid:6)(n−1)/k(cid:7)(cid:4)
+
j=2
2(−1)j+(cid:6)(n−1)/k(cid:7) ·
< β − (−1)
(cid:6)(n−1)/k−1(cid:7)α − (−1)
(cid:6)(n−1)/k(cid:7)(cid:4)
−
2(−1)j+(cid:6)(n−1)/k(cid:7) ·
The upper boundary constraint is vn−1 < β.
• if k ≤ n − 1 < 2k: Using Lemma 5 from [33] we get,
vn−1 = b(n−1) mod k,(n−1) mod k+k + ξ(n−1) mod k ⇒
vn−1 = b(n−1) mod k,n−1 + ξ(n−1) mod k ⇒
⎞⎠ + ξ(n−1) mod k ⇒
n−k−1(cid:4)
n−k−1(cid:4)
j=0