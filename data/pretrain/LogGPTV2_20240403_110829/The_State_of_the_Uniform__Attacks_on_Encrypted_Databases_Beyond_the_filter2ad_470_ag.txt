### Optimized Text

#### Main Content
Previous studies on leakage-abuse attacks have often made strong assumptions, leading to a misperception of their practical applicability. As a result, these attacks have been historically characterized as being of "theoretical interest" only. Our research, however, demonstrates the power and generality of new reconstruction techniques that overcome these restrictive assumptions. The key to our approach lies in the synergistic analysis of both access-pattern and search-pattern leakages. Experimental results show that an attacker can achieve accurate data reconstruction across a wide range of skewed query distributions and database densities, without needing to parameterize the algorithms or rely on any auxiliary information.

#### Acknowledgments
This work was conducted while the first author was affiliated with Brown University and was supported in part by the U.S. National Science Foundation and the National Institute of Standards and Technology (NIST).

#### References
1. G. Asharov, M. Naor, G. Segev, and I. Shahaf, “Searchable Symmetric Encryption: Optimal Locality in Linear Space via Two-dimensional Balanced Allocations,” in *Proc. of the 48th ACM STOC*, 2016, pp. 1101–1114.
2. G. Asharov, G. Segev, and I. Shahaf, “Tight Tradeoffs in Searchable Symmetric Encryption,” in *Proc. of the 38th CRYPTO*, 2018, pp. 407–436.
3. T. Batu, L. Fortnow, R. Rubinfeld, W. D. Smith, and P. White, “Testing that Distributions are Close,” in *Proc. of the 41st IEEE FOCS*, 2000, pp. 259–269.
4. R. Bost, “οϕος: Forward Secure Searchable Encryption,” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1143–1154.
5. J. Bunge and M. Fitzpatrick, “Estimating the Number of Species: A Review,” *Journal of the American Statistical Association*, vol. 88, no. 421, pp. 364–373, 1993.
6. K. P. Burnham and W. S. Overton, “Estimation of the Size of a Closed Population when Capture Probabilities vary Among Animals,” *Biometrika*, vol. 65, no. 3, pp. 625–633, 1978.
7. ——, “Robust Estimation of Population Size When Capture Probabilities Vary Among Animals,” *Ecology*, vol. 60, no. 5, pp. 927–936, 1979.
8. D. Cash, P. Grubbs, J. Perry, and T. Ristenpart, “Leakage-Abuse Attacks Against Searchable Encryption,” in *Proc. of the 22nd ACM CCS*, 2015, pp. 668–679.
9. D. Cash, J. Jaeger, S. Jarecki, C. S. Jutla, H. Krawczyk, M. Rosu, and M. Steiner, “Dynamic Searchable Encryption in Very-Large Databases: Data Structures and Implementation,” in *Proc. of the 21st NDSS*, 2014.
10. D. Cash and S. Tessaro, “The Locality of Searchable Symmetric Encryption,” in *Proc. of the 33rd EUROCRYPT*, 2014, pp. 351–368.
11. J. G. Chamani, D. Papadopoulos, C. Papamanthou, and R. Jalili, “New Constructions for Forward and Backward Private Symmetric Searchable Encryption,” in *Proc. of the 25th ACM CCS*, 2018, pp. 1038–1055.
12. A. Chao and C.-H. Chiu, *Species Richness: Estimation and Comparison*. American Cancer Society, 2016, pp. 1–26.
13. M. Chase and S. Kamara, “Structured encryption and controlled disclosure,” in *Proc. of the 16th ASIACRYPT*, 2010.
14. H. Chen, I. Chillotti, Y. Dong, O. Poburinnaya, I. Razenshteyn, and M. S. Riazi, “SANNS: Scaling Up Secure Approximate k-Nearest Neighbors Search,” *Cryptology ePrint Archive*, Report 2019/359, 2019, https://eprint.iacr.org/2019/359.
15. R. Curtmola, J. A. Garay, S. Kamara, and R. Ostrovsky, “Searchable Symmetric Encryption: Improved Definitions and Efficient Constructions,” in *Proc. of the 13th ACM CCS*, 2006, pp. 79–88.
16. I. Demertzis, D. Papadopoulos, and C. Papamanthou, “Searchable Encryption with Optimal Locality: Achieving Sublogarithmic Read Efficiency,” in *Proc. of the 38th CRYPTO*, 2018, pp. 371–406.
17. I. Demertzis, S. Papadopoulos, O. Papapetrou, A. Deligiannakis, and M. Garofalakis, “Practical Private Range Search Revisited,” in *Proc. of ACM SIGMOD*, 2016, pp. 185–198.
18. I. Demertzis and C. Papamanthou, “Fast Searchable Encryption With Tunable Locality,” in *Proc. of ACM SIGMOD*, 2017, pp. 1053–1067.
19. I. Diakonikolas, T. Gouleakis, J. Peebles, and E. Price, “Collision-based Testers are Optimal for Uniformity and Closeness,” *Electronic Colloquium on Computational Complexity (ECCC)*, vol. 23, p. 178, 2016.
20. F. B. Durak, T. M. DuBuisson, and D. Cash, “What Else is Revealed by Order-Revealing Encryption?” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1155–1166.
21. B. Efron and R. Thisted, “Estimating the Number of Unseen Species: How Many Words Did Shakespeare Know?” *Biometrika*, vol. 63, no. 3, pp. 435–447, 1976.
22. S. Faber, S. Jarecki, H. Krawczyk, Q. Nguyen, M. Rosu, and M. Steiner, “Rich Queries on Encrypted Data: Beyond Exact Matches,” in *Proc. of the 20th ESORICS*, 2015, pp. 123–145.
23. B. Fuller, M. Varia, A. Yerukhimovich, E. Shen, A. Hamlin, V. Gadepally, R. Shay, J. D. Mitchell, and R. K. Cunningham, “SoK: Cryptographically Protected Database Search,” in *Proc. of the 38th IEEE S&P*, 2017, pp. 172–191.
24. A. Gandolfo and C. C. A. Sastri, “Nonparametric estimations about species not observed in a random sample,” *Milan Journal of Mathematics*, vol. 72, no. 1, pp. 81–105, Oct 2004.
25. O. Goldreich, *Introduction to Property Testing*. Cambridge University Press, 2017.
26. O. Goldreich and D. Ron, “On Testing Expansion in Bounded-Degree Graphs,” *Electronic Colloquium on Computational Complexity (ECCC)*, vol. 7, no. 20, 2000.
27. P. Grubbs, M. Lacharité, B. Minaud, and K. G. Paterson, “Learning to Reconstruct: Statistical Learning Theory and Encrypted Database Attacks,” in *Proc. of the 40th IEEE S&P*, 2019, pp. 496–512.
28. P. Grubbs, K. Sekniqi, V. Bindschaedler, M. Naveed, and T. Ristenpart, “Leakage-Abuse Attacks against Order-Revealing Encryption,” in *Proc. of the 38th IEEE S&P*, 2017, pp. 655–672.
29. B. Harris, “Statistical Inference in the Classical Occupancy Problem: Unbiased Estimation of the Number of Classes,” *Journal of the American Statistical Association*, vol. 63, no. 323, pp. 837–847, 1968.
30. M. S. Islam, M. Kuzu, and M. Kantarcioglu, “Access Pattern Disclosure on Searchable Encryption: Ramification, Attack and Mitigation,” in *Proc. of the 19th NDSS*, 2012.
31. S. Kamara, C. Papamanthou, and T. Roeder, “Dynamic Searchable Symmetric Encryption,” in *Proc. of the 19th ACM CCS*, 2012, pp. 965–976.
32. G. Kellaris, G. Kollios, K. Nissim, and A. O’Neill, “Generic Attacks on Secure Outsourced Databases,” in *Proc. of the 23rd ACM CCS*, 2016, pp. 1329–1340.
33. E. M. Kornaropoulos, C. Papamanthou, and R. Tamassia, “Data Recovery on Encrypted Databases With k-Nearest Neighbor Query Leakage,” in *Proc. of the 40th IEEE S&P*, 2019.
34. M. S. Lacharité, B. Minaud, and K. G. Paterson, “Improved Reconstruction Attacks on Encrypted Data Using Range Query Leakage,” in *Proc. of the 39th IEEE S&P*, 2018, pp. 1–18.
35. M. Lacharité and K. Paterson, “Frequency-Smoothing Encryption: Preventing Snapshot Attacks on Deterministically Encrypted Data,” *IACR Transactions on Symmetric Cryptology*, vol. 2018, no. 1, pp. 277–313, Mar. 2018.
36. R. C. Lewontin and T. Prout, “Estimation of the Number of Different Classes in a Population,” *Biometrics*, vol. 12, no. 2, pp. 211–223, 1956.
37. E. A. Markatou and R. Tamassia, “Full Database Reconstruction with Access and Search Pattern Leakage,” in *Proc. of the 22nd ISC*, 2019.
38. M. Naveed, S. Kamara, and C. V. Wright, “Inference Attacks on Property-Preserving Encrypted Databases,” in *Proc. of the 22nd ACM CCS*, 2015, pp. 644–655.
39. R. A. Popa, C. M. S. Redfield, N. Zeldovich, and H. Balakrishnan, “CryptDB: Protecting Confidentiality with Encrypted Query Processing,” in *Proc. of the 23rd ACM SOSP*, 2011, pp. 85–100.
40. M. H. Quenouille, “Approximate Tests of Correlation in Time-Series,” *Journal of the Royal Statistical Society. Series B (Methodological)*, vol. 11, no. 1, pp. 68–84, 1949.
41. D. X. Song, D. A. Wagner, and A. Perrig, “Practical Techniques for Searches on Encrypted Data,” in *Proc. of the 21st IEEE S&P*, 2000, pp. 44–55.
42. A. Stam, “Statistical Problems in Ancient Numismatics,” *Statistica Neerlandica*, vol. 41, no. 3, pp. 151–174.
43. E. Stefanov, C. Papamanthou, and E. Shi, “Practical Dynamic Searchable Encryption with Small Leakage,” in *Proc. of the 21st NDSS*, 2014.
44. G. Valiant and P. Valiant, “Estimating the Unseen: Improved Estimators for Entropy and Other Properties,” *J. ACM*, vol. 64, no. 6, pp. 37:1–37:41, Oct. 2017.
45. Y. Zhang, J. Katz, and C. Papamanthou, “All Your Queries Are Belong to Us: The Power of File-Injection Attacks on Searchable Encryption,” in *Proc. of the 25th USENIX Security*, 2016, pp. 707–720.

#### Appendix
**Proof of Theorem 2:**
We first show that the function in equation (3) is convex. Notice that the inner functions, i.e., \(x_i + x_j - \log(\mathcal{L}_{i,j})\), can be interpreted as convex functions. Specifically, the quadratic function \((x_i + x_j - \log(\mathcal{L}_{i,j}))^2\) is convex. Furthermore, it is known that the non-negative weighted sum of convex functions preserves convexity, which means that the function in equation (3) is convex. Due to the convexity of (3), every local minimum is a global minimum.

The next step is to show that there exists a unique solution. Consider the matrix of coefficients \(M\) derived from the partial derivatives, which also appears in Line 8 of Algorithm Agnostic-Reconstruction-Range, and is symmetric:
\[
M = \begin{pmatrix}
2w_{0,0} & 2w_{0,1} & \cdots & 2w_{0,n} \\
2w_{1,0} & 2w_{1,1} & \cdots & 2w_{1,n} \\
\vdots & \vdots & \ddots & \vdots \\
2w_{n,0} & 2w_{n,1} & \cdots & 2w_{n,n}
\end{pmatrix}
\]

If we show that \(\mathbf{y}^T M \mathbf{y} > 0\) for all vectors \(\mathbf{y} \neq 0\), then the matrix is positive definite, which implies that there is a unique solution. We want to show \(\mathbf{y}^T M \mathbf{y} > 0\). Thus:
\[
\mathbf{y}^T M \mathbf{y} = \sum_{i=0}^{n} \sum_{j=0}^{n} 2w_{i,j} y_i y_j = 2 \sum_{i=0}^{n} \sum_{j=0}^{n} w_{i,j} y_i y_j
\]
Since \(w_{i,j}\) is always positive, \(\mathbf{y}^T M \mathbf{y} > 0\) for all \(\mathbf{y} \neq 0\), which confirms that \(M\) is positive definite and there is a unique solution.

**On the Derivation of the Jackknife Estimators:**
Let \(m\) be the number of queries, \(k\) be the order of the jackknife estimator, \(d\) be the number of observed distinct queries, and \(F = (f_1, \ldots, f_m)\) be the fingerprint of sample \(D\) of queries. The formulation of the bias-corrected jackknife estimator \(\hat{N}_J(k)\) of order \(k\) is given by:
\[
\lambda_{m-j} = d - \sum_{t=1}^{m} \left( \frac{m-t}{m-j} \right)^k f_t
\]
\[
\hat{N}_J(k) = \frac{1}{k!} \sum_{j=1}^{k} (-1)^{j+1} \binom{k}{j} \lambda_{m-j}
\]

**Proof of Lemma 2:**
We replace every \(L_i\) with the term \(L_i + \delta_i\) to consider the distortion variables \(\delta_0, \ldots, \delta_{n-k}\). We get:
\[
\xi_0 - \delta_0 \leq L_0
\]

**Lower Boundary Constraint:**
Using Lemma 5 from [33]:
\[
\alpha < v_0 \Rightarrow \alpha \leq b_{0,k} - \xi_0 \Rightarrow \xi_0 \leq b_{0,k} - \alpha \Rightarrow \xi_0 \leq \text{Len}(\{id_0, \ldots, id_{k-1}\}) \Rightarrow \xi_0 \leq L_0
\]

**Upper Boundary Constraint:**
\[
v_{n-1} < \beta \Rightarrow \sum_{j=0}^{(n-1) \mod k} \left( L_j + \delta_j \right) + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} (L_m + \delta_m) < \beta
\]
\[
\Rightarrow \sum_{j=0}^{(n-1) \mod k} L_j + \sum_{j=0}^{(n-1) \mod k} \delta_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} L_m + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} \delta_m < \beta
\]
\[
\Rightarrow \sum_{j=0}^{(n-1) \mod k} L_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} L_m + \sum_{j=0}^{(n-1) \mod k} \delta_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} \delta_m < \beta
\]
\[
\Rightarrow \sum_{j=0}^{(n-1) \mod k} L_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} L_m + \sum_{j=0}^{(n-1) \mod k} \delta_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} \delta_m < \beta
\]

The upper boundary constraint is \(v_{n-1} < \beta\).

**• if \(k \leq n-1 < 2k\):**
Using Lemma 5 from [33], we get:
\[
v_{n-1} = b_{(n-1) \mod k, (n-1) \mod k + k} + \xi_{(n-1) \mod k} \Rightarrow v_{n-1} = b_{(n-1) \mod k, n-1} + \xi_{(n-1) \mod k}
\]
\[
\Rightarrow v_{n-1} = \sum_{j=0}^{n-k-1} \left( L_j + \delta_j \right) + \xi_{(n-1) \mod k}
\]
\[
\Rightarrow \sum_{j=0}^{n-k-1} L_j + \sum_{j=0}^{n-k-1} \delta_j + \xi_{(n-1) \mod k} < \beta
\]
\[
\Rightarrow \sum_{j=0}^{n-k-1} L_j + \sum_{j=0}^{n-k-1} \delta_j + \xi_{(n-1) \mod k} < \beta
\]

The upper boundary constraint is \(v_{n-1} < \beta\).

**Proof of Lemma 1:**
The proof is derived from Lemma 8 in [33] by substituting \(L_i\) with \((L_i + \delta_i)\) for \(i \in [0, n-k]\).
\[
v_{n-1} < \beta \Rightarrow \sum_{j=0}^{(n-1) \mod k} (L_j + \delta_j) + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} (L_m + \delta_m) < \beta
\]
\[
\Rightarrow \sum_{j=0}^{(n-1) \mod k} L_j + \sum_{j=0}^{(n-1) \mod k} \delta_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} L_m + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} \delta_m < \beta
\]
\[
\Rightarrow \sum_{j=0}^{(n-1) \mod k} L_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} L_m + \sum_{j=0}^{(n-1) \mod k} \delta_j + \sum_{j=2}^{\lfloor (n-1)/k \rfloor} (-1)^{j+1} \cdot \sum_{m=0}^{(n-1) \mod k + (j-1)k} \delta_m < \beta
\]

The upper boundary constraint is \(v_{n-1} < \beta\).