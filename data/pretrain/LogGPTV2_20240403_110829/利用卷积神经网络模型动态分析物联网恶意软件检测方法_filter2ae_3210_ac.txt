### 通过通道化过程创建特征图像

在通道化过程中，我们将内存特征数据、综合行为特征数据和行为频率表数字化，并将它们分别匹配到红色通道、绿色通道和蓝色通道。每个通道的特征数据尺寸被减小并整合成一个单一的RGB图像，其大小为512×512像素。图5展示了特征预处理阶段完成后，训练和测试数据集的结果。

**图5. 特征预处理后的良性和恶意软件图像**

### 特征选择与分类

表3列出了本文用于训练和构建物联网恶意软件检测模型的ZFNet层名、张量大小及参数。

**表3. 用于构建物联网恶意软件检测模型的ZFNet结构**

DAIMD模型通过对840张特征图像进行训练，利用ZFNet模型来检测物联网恶意软件。该模型在IoT恶意软件检测上的准确率为99.87%，实际数据与模型输出数据之间的差异仅为0.0047。

为了验证DAIMD模型在检测物联网恶意软件方面的准确性，我们使用了包含561个文件的测试数据集，结果表明其检测准确率为99.28%。

### 效果评估

为验证DAIMD是否能够有效分析和检测已知及新变种的物联网恶意软件，我们进行了性能评估。所采用的评估指标包括假阳性率（FPR）、假阴性率（FNR）以及准确率（ACY）。

- **FPR**：指将恶意软件误判为良性文件的比例。
- **FNR**：指将良性文件误判为恶意软件的比例。
- **ACY**：指正确分类恶意软件和良性文件的比例。

**图6** 展示了DAIMD模型训练精度和损失值的变化情况。在基于最优向量大小训练物联网恶意软件检测ZFNet模型时，采用了Adam优化器算法，且外延时间设定为40。从图6(a)可以看出，随着外延时间增加，精度逐渐提高；而当向量大小为224×224时，其准确率相对较低。图6(b)则显示了不同向量大小下的损失值变化趋势，其中512×512大小的向量表现出较为平缓的下降曲线。

### 模型验证

我们使用了训练数据集中10%（即84条记录）的数据对DAIMD模型进行了验证。如图7所示，在不同向量大小下，模型的验证精度随纪元增加而逐步提升，尤其是512×512大小的向量表现最佳。然而，对于224×224和256×256大小的向量，在某些部分出现了过拟合现象。此外，图7(b)还展示了不同向量大小下的验证损失值变化情况，进一步证实了上述结论。

### 测试结果比较

当使用512×512大小的特征向量对DAIMD模型进行测试时，其准确率达到99.28%，明显优于其他向量大小的情况。同时，该模型在FPR值方面也表现出色，显著低于其他设置。尽管当向量大小为448×448时，FNR略低，但考虑到FPR是衡量物联网恶意软件检测模型性能的关键指标之一，因此本研究更关注于降低FPR值。

**表4. 不同向量大小下的测试精度、FPR和FNR对比**

### 与其他模型的比较

**表5** 对比了DAIMD与其他几种恶意软件检测模型的性能。结果显示，虽然所有模型都能实现超过95%的高准确度，但DAIMD不仅拥有最高的准确率(99.28%)，而且其FPR值最低(0.63%)，这表明它能够更加可靠地识别出威胁物联网设备的安全隐患。

### 结论

针对嵌入式Linux环境下配置的各种架构和库的物联网设备易受攻击的问题，本文提出了一种基于动态分析的物联网恶意软件检测方案——DAIMD。该方法能够在云端虚拟环境中高效地分析并分类物联网恶意软件，无需依赖人为干预即可准确识别新型或变异版本的恶意代码。未来的研究方向将集中在如何结合静态与动态分析技术以进一步提高检测效果。