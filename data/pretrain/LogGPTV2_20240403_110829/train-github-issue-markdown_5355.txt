### Describe your issue.
This comes from failures seen in SymPy CI:  
sympy/sympy#23847
The release of Cython 0.29.31 means that building SciPy from source with pip
fails both with the latest release SciPy 1.8.1 and also the main branch.
It looks like pyproject.toml on the 1.8.x branch needs to have a better upper
bound for the Cython version since it only requires `=2.4.3,=0.29.18, [102 lines of output]
          Running scipy/special/_generate_pyx.py
          Running scipy/stats/_generate_pyx.py
          Running scipy/linalg/_generate_pyx.py
          Processing scipy/special/_ufuncs.pyx
          Processing scipy/special/_test_round.pyx
          Processing scipy/special/_ufuncs_cxx.pyx
          Processing scipy/special/_ellip_harm_2.pyx
          Processing scipy/special/cython_special.pyx
          Processing scipy/special/_comb.pyx
          Processing scipy/spatial/_voronoi.pyx
          Processing scipy/spatial/_hausdorff.pyx
          Processing scipy/spatial/_qhull.pyx
          Processing scipy/spatial/_ckdtree.pyx
          Processing scipy/spatial/transform/_rotation.pyx
          Processing scipy/interpolate/_ppoly.pyx
          Processing scipy/interpolate/_bspl.pyx
          Processing scipy/interpolate/interpnd.pyx
          Processing scipy/cluster/_vq.pyx
          Processing scipy/cluster/_hierarchy.pyx
          Processing scipy/cluster/_optimal_leaf_ordering.pyx
          Processing scipy/_lib/messagestream.pyx
          Processing scipy/_lib/_test_deprecation_call.pyx
          Processing scipy/_lib/_test_deprecation_def.pyx
          Processing scipy/_lib/_ccallback_c.pyx
          Processing scipy/signal/_upfirdn_apply.pyx
          Processing scipy/signal/_max_len_seq_inner.pyx
          Processing scipy/signal/_sosfilt.pyx
          Processing scipy/signal/_spectral.pyx
          Processing scipy/signal/_peak_finding_utils.pyx
          Processing scipy/io/matlab/_streams.pyx
          Processing scipy/io/matlab/_mio5_utils.pyx
          Processing scipy/io/matlab/_mio_utils.pyx
          Processing scipy/stats/_stats.pyx
          Processing scipy/stats/_qmc_cy.pyx
          Processing scipy/stats/_biasedurn.pyx
          Processing scipy/stats/_sobol.pyx
          Processing scipy/stats/_boost/src/nbinom_ufunc.pyx
          Processing scipy/stats/_boost/src/beta_ufunc.pyx
          Error compiling Cython file:
          ------------------------------------------------------------
          ...
              return np.array(result, dtype=np.int64)
          @cython.wraparound(False)
          @cython.boundscheck(False)
          def _weightedrankedtau(ordered[:] x, ordered[:] y, intp_t[:] rank, weigher, bool additive):
          ^
          ------------------------------------------------------------
          _stats.pyx:173:0: Referring to a memoryview typed argument directly in a nested closure function is not supported in Cython 0.x. Either upgrade to Cython 3, or assign the argument to a local variable and use that in the nested function.
          Processing scipy/stats/_boost/src/binom_ufunc.pyx
          Traceback (most recent call last):
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 317, in 
              main()
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 313, in main
              find_process_files(root_dir)
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 302, in find_process_files
              for result in pool.imap_unordered(lambda args: process(*args), jobs):
            File "/usr/lib/python3.8/multiprocessing/pool.py", line 868, in next
              raise value
            File "/usr/lib/python3.8/multiprocessing/pool.py", line 125, in worker
              result = (True, func(*args, **kwds))
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 302, in 
              for result in pool.imap_unordered(lambda args: process(*args), jobs):
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 236, in process
              processor_function(fromfile, tofile, cwd=path)
            File "/tmp/pip-install-wnazhy0r/scipy_3ee8a876e4f54aa7bfa3d9fdba592754/tools/cythonize.py", line 102, in process_pyx
              raise Exception('Cython failed')
          Exception: Cython failed
          setup.py:486: UserWarning: Unrecognized setuptools command ('dist_info --egg-base /tmp/pip-modern-metadata-tcs7khbn'), proceeding with generating Cython sources and expanding templates
            warnings.warn("Unrecognized setuptools command ('{}'), proceeding with "
          Running from SciPy source directory.
          Cythonizing sources
          Traceback (most recent call last):
            File "setup.py", line 350, in generate_cython
              import pip
          ModuleNotFoundError: No module named 'pip'
          During handling of the above exception, another exception occurred:
          Traceback (most recent call last):
            File "/home/oscar/current/sympy/sympy.git/tmpvenv/lib/python3.8/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 363, in 
              main()
            File "/home/oscar/current/sympy/sympy.git/tmpvenv/lib/python3.8/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 345, in main
              json_out['return_val'] = hook(**hook_input['kwargs'])
            File "/home/oscar/current/sympy/sympy.git/tmpvenv/lib/python3.8/site-packages/pip/_vendor/pep517/in_process/_in_process.py", line 164, in prepare_metadata_for_build_wheel
              return hook(metadata_directory, config_settings)
            File "/tmp/pip-build-env-nvuzm8iv/overlay/lib/python3.8/site-packages/setuptools/build_meta.py", line 174, in prepare_metadata_for_build_wheel
              self.run_setup()
            File "/tmp/pip-build-env-nvuzm8iv/overlay/lib/python3.8/site-packages/setuptools/build_meta.py", line 267, in run_setup
              super(_BuildMetaLegacyBackend,
            File "/tmp/pip-build-env-nvuzm8iv/overlay/lib/python3.8/site-packages/setuptools/build_meta.py", line 158, in run_setup
              exec(compile(code, __file__, 'exec'), locals())
            File "setup.py", line 628, in 
              setup_package()
            File "setup.py", line 612, in setup_package
              generate_cython()
            File "setup.py", line 352, in generate_cython
              raise RuntimeError("Running cythonize failed!")
          RuntimeError: Running cythonize failed!
          [end of output]
      note: This error originates from a subprocess, and is likely not a problem with pip.
    error: metadata-generation-failed
    × Encountered error while generating package metadata.
    ╰─> See above for output.
    note: This is an issue with the package mentioned above, not pip.
    hint: See above for details.
### SciPy/NumPy/Python version information
SciPy 1.8.1 and current main, numpy 1.23.1, Any version of Python or PyPy (I
think), Cython 0.29.31