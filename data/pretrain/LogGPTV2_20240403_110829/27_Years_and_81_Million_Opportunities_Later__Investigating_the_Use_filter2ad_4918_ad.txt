2,452
2,918
7
131
8,658
37,547
66,786
23,069
24,849
7
167
322
24,236
37,547
115,388
49,111
7,153
4,903
428
6,825
52
0
1,408
74
1
16
161
8
3
2,167
1,918
2,589
4,191
1,841
8
110
2
1,974
1,918
7,796
3,864
436
536
1
8,206,215
3,102,760
4
?1
26,224
6,066
29,065
2,573
?1
5,296
2,572,631
2,708,758
7,150,676
799,179
340,599
695
84,744
2,378,940
3,196,689
2,708,758
11,776,198
3,265,602
970,160
393,685
72,256
11,875,969
7,785,073
1,259,208
2,268,757
70,482
141,263
447,775
21,640
723,482
8,364
9,715,649
30,634,653
10,679,520
1,457,578
3,057,579
726,209
120,115
2,425,629
15,851,032
30,634,653
39,504,464
17,560,401
4,960,051
2,703,240
224,159
>= 5%
> 4%
> 3.5%
> 3%
> 2.5%
> 2%
> 1.5%
> 1%
> 0.5%
<= 0.5%
Total
Client
Thunderbird
Outlook
Ticketsystem
AppleMail
Evolution
Mutt/NeoMutt
Outlook-Express
Claws Mail
iPhone/iPad-Mail
MailMate
Other
No Useragent
Operating System2
Windows
Linux
Mac
iOS
Android
Webmail
Unknown
No Useragent
Usergroup
Scientiﬁc
Staff
NX Internal
Student
External
Affected emails
1 AppleMail and the iOS mail client miss the X-Mailer header in the sent folder. Hence, we identify their client as ”No Useragent“.
2 Not all clients store the operating system as part of the Useragent/X-Mailer ﬁeld. If not available, we identify them as ”Unknown“.
TOP 10 CLIENTS OF S/MIME AND PGP USERS AT OUR UNIVERSITY.
TABLE I
identiﬁed 495 root CAs. 274 of them were only the root of
one certiﬁcate. The Deutsche Telekom was the root CA of
6,342 (64.95%) certiﬁcates. In contrast, 1,150 (11.78%) were
self-signed and not linked to a CA.
Fig. 3. Distribution of primary PGP keys over time.
PGP Keys. PGP keys can be split into primary and sub keys.
Each primary key can have multiple sub keys. Below, we focus
on primary keys. We found 3,741 primary and 3,840 sub keys.
Primary keys had on average 1.03 sub keys with a maximum
of 10.
Most PGP keys used RSA (3,169; 84.71%) and 2048 bits
(928; 24.81% keys) or 4096 bits (2,015; 53.86% keys) keys,
followed by DSA (323; 8.63%) with mostly short key sizes
<= 1024 bit (290; 7.75%) for signatures and Elgamal sub
keys for encryption.
PGP key expiration dates can be set and extended by the
user themselves. We saw this in 219 (5.85%) cases with
a maximum of 4 extensions. 1,234 (32.99%) keys had no
expiration date, while 1,344 (35.93%) keys were expired. The
average validity period for PGP keys was 4.67 years (sd 3.39)
ranging from zero weeks to 85.82 years.
The majority (276; 85.45%) of DSA keys were created
before or in 2010 and used 1024 bit keys. 278 (86.07%) had
no expiration date set. The last two DSA keys were created
in 2019 with 3072 bit keys.
928 (24.81%) of the RSA keys used 2048, 2,015 (53.86%)
4096 bits. Only 6 (0.16%) had 1024 bit keys. 2048 bit was
the most widely used key size (60-70% per year) between
2010 and 2013. 4096 bit was most dominantly used from 2014
and peaking in 2017 with 86.18%. Interestingly, in 2018 the
picture changes again and 2048 and 3072 bit keys appeared
more frequently again with 2048 bits taking back the lead in
2020, although the amount of RSA keys is starting to decline in
favor of EdDSA. We attribute this phenomenon to the release
of Autocrypt in 2018 which uses RSA 2048 bit keys by default
to avoid the 10kB header limit. [6].
Authorized licensed use limited to: Tsinghua University. Downloaded on August 07,2022 at 13:02:55 UTC from IEEE Xplore.  Restrictions apply. 
868
# S/MIME
# PGP
Primary
3,741
-
6
928
208
2,015
5
1
290
17
15
-
-
-
-
-
-
-
249
4.67
3.39
4.99
0.00
85.82
1,234
Sub
3,840
-
6
950
226
2,078
2
-
1
2
2
1
61
186
13
53
-
247
2
4.62
3.68
4.99
0.00
85.82
1,240
9,765
6
237
8,942
32
541
5
-
-
-
-
-
-
-
-
-
1
-
-
3.13
2.70
2.99
4.00
99.99
-
512
1024
2048
3072
4096
8192
768
1024
2048
3072
768
1024
2048
3072
4096
521
256
256
(years)
(years)
(years)
(weeks)
(years)
-
RSA
DSA
ElGamal
1
s
m
h
t
i
r
o
g
l
A
c
i
h
p
a
r
g
o
t
p
y
r
C
d
o
i
r
e
P
EC
ECDH
EdDSA
mean
std. dev.
median
min
max
unlimited
1 Key sizes in bits
y
t
i
d
i
l
a
V
DETAILS FOR S/MIME CERTIFICATES AND PGP KEYS IN OUR DATASET
TABLE II
We found the ﬁrst four EdDSA keys in 2017, followed by
nine in 2018, 31 in 2019 and 193 in 2020, almost reaching
the number of RSA keys (207). 53 (21.29%) of the EdDSA
keys did not have an expiration date set.
Until 2000, all 33 PGP mails were hashed with MD5.
Between 2004 and 2015, SHA1 was most widely used in
62,273 (80.96%) PGP mails.
We found the ﬁrst use of SHA2-256 in 2006 with a
steady increase until 2016 when it became the most widely
used algorithm with a total of 125,973 mails (68.54% since
2016; 50.22% overall). SHA2-512 ﬁrst appeared in 2008, has
constantly been growing since, and has been the second most
used hash algorithm since 2016 (44,859; 25.94% since 2016;
20.26% overall). The remaining hash algorithms SHA-224 (7;
<0.01%) and RIPE-MD160 (132; 0.05%) were almost non-
existent in our dataset.
Key Insights: S/MIME and PGP.
• RSA is the most widely used key algorithm.
• A key size of 2048 bits was used most often with S/MIME.
• PGP keys used 4096 bits most often, although newer PGP keys used
less secure 2048 bits.
• About one third of the PGP keys did not have an expiration date set.
• The Deutsche Telekom was root CA for 64.95% of all S/MIME
certiﬁcates.
C. User Interaction with S/MIME and PGP
Overall, we identiﬁed 37,463 unique user accounts includ-
ing 374 accounts with no emails at all and 18,302 users who
never sent an email. Below, we focus our analysis on the
remaining 19,161 active email users who have sent at least
one email. Active users sent 688.93 emails (ranging from 1
to 182,379 emails) and received 3,249.81 (ranging from 0 to
2,881,904 emails) on average.
Based on the subdomain of user accounts’ postboxes we
assigned user accounts to the groups scientiﬁc, staff, students,
external and NX internal. We assigned administrative staff of
a research group to scientiﬁc, assigned subdomains that were
no longer available when we collected and analyzed the data
to NX internal and external to accounts that are hosted by