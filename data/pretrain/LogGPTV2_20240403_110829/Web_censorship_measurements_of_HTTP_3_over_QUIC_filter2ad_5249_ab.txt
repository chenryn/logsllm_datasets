Virtual Private Servers (VPSs): When using a VPS, the applica-
tion is executed on a virtual machine. This way, various countries
can be accessed through OONI and its partners. Some countries,
e.g., Costa Rica, Cambodia, and Tunisia, were excluded from our
evaluation, because the VPS measurements again showed less inter-
ference than expected, similar to our initial VPN measurements. In
China, India, and Iran, we used one VPS each in AS45090, AS14061,
and AS62442. We expect these VPSs to be affected by the same
amount of censorship as traditional measurements on personal de-
vices. We have come to this conclusion after initial measurements
which resembled user experience in the respective countries. Be-
cause VPS measurements can be taken frequently and continuously,
they are crucial to collect a significant number of samples.
4.3 Country-specific Host Lists
To gather meaningful results, the tested websites have to be relevant
in the context of internet censorship and also support HTTP/3. To
check both criteria, we first created a list of relevant domains, then
excluded the ones that did not support QUIC. As mentioned in
Section 2, some domain categories were also excluded (e.g., sites
with pornographic content). Our starting list of relevant domains
includes commonly accessed international domains, websites with
controversial topics or country-specific restricted content, and also
sites that have been reported as censored in the past. The main
source for these domains are the censorship test lists of the Citizen
Lab Project3, often used in the literature [8, 15, 21]. These lists
include 1400 mostly English-speaking websites as well as multiple
country-specific websites. Additionally, we added to our base list
the first 4000 entries of the Tranco Top 1 Million list4, which ranks
the most frequently accessed domains on the web. The so created
base list is then filtered by making a QUIC request with cURL5
and dropping all domains that did not support QUIC. This reduced
the final host list significantly. Only about 5% of relevant domains
passed. Because some hosts appear to have very unstable QUIC
support, we checked all remaining domains one more time in the
post-processing step (c.f., Section 4.4).
The composition of each country-specific host list is presented
in Figure 2. It has to be noted that the data set contains a signifi-
cant amount of .com top-level domains. QUIC is currently mainly
deployed by large internet companies, e.g., Google, and therefore
3https://github.com/citizenlab/test-lists
4https://tranco-list.eu/
5https://curl.se/
ACM IMC 2021, November 2–4, 2021, Virtual Event
Kathrin Elmenhorst, Bertram Schütz, Nils Aschenbruck, and Simone Basso
*The DNS step is done via Google DoH from an uncensored network.
Figure 1: Three-step workflow of the conducted censorship measurements
For each request pair, two measurements are performed sequen-
tially, first using TCP, than using QUIC. There is no wait time
between the two measurements. A single measurement is done
by running the URLGetter experiment on the OONI client with
the aforementioned prepared input. The returned report data is
then sent to the OONI backend, where it is published via the OONI
Explorer API6.
3. Post Processing & Validation: The post-processing step is nec-
essary, because the QUIC support of some hosts is not stable. Some-
times, random handshake timeout error occur, which are unfortu-
nately not directly distinguishable from timeout errors caused by
censorship. To solve this issue, we tested each failed request one
more time from an uncensored network before adding the result to
the final data set.
If the request fails again, a malfunction at the destination host
is assumed and the measurement pair is discarded, including the
corresponding QUIC request as well as the TCP request.
5 EVALUATION
This section evaluates the state of QUIC blocking by presenting
the measurement results from vantage points in India, China, Iran,
and Kazakhstan. We use the HTTPS measurements as a baseline
in order to investigate whether the censor blocks both HTTPS and
HTTP/3 connections alike. The tangible measurement results are
network failures observed at each connection attempt, e.g. TLS-hs-
to. We use the failure types to derive the most probable failure cause.
In case of censorship, the type of the failure can help identify the
applied blocking method, e.g. black holing with SNI-based traffic
identification.
An overview of our results is shown in Table 1. Notice that
the final sample size can be smaller than number of hosts times
replications, because invalid requests were filtered out during the
validation step.
The very low failure rates of HTTP/3 in AS9198 (Kazakhstan),
AS14061, and AS38266 (India) indicate the absence of QUIC cen-
sorship at those vantage points. In contrast, the measurements in
China, Iran, and India indicate HTTP/3 censorship in the inves-
tigated networks. However, we have found that not all domains
that are unavailable over TCP, are also unavailable over QUIC. This
difference is most prominent is AS45090 (China), where TCP hosts
cannot be accessed in 37.3% of cases, whereas only 27.1% of QUIC
6https://explorer.ooni.org/
279
Figure 2: Distribution of top-level domains (first horizon-
tal bar) and sources (second horizontal bar) within each
country-specific host list.
predominantly used by globally popular hosts. Due to this bias, we
expect to generally see more censorship in countries that largely
censor global targets, e.g. China.
4.4 Data Collection Process
As depicted in Figure 1, the final measurement process itself consists
of three consecutive phases: input preparation, data collection, and
post-processing.
1. Input Preparation: The objective of this step is to obtain a set
of request pairs. Each pair consists of two HTTP requests to the
same target host, one via TCP with TLS and one over QUIC. Such
a request pair shares the same configuration parameters, i.e., the
content of the TLS extension Server Name Indication (SNI), the
pre-resolved IP address of the target host, and the address of a
public DoH resolver. The latter DNS configurations ensure that the
measurements are not biased by DNS manipulation. The requests
are saved as JSON objects and used as input for OONI Probe.
2. Data Collection: All measurements were conducted between
January 15th and March 30th 2021 at the vantage points described
in Section 4.2. At each VPS vantage point, the entire input list was
processed in 8 hours intervals. But due to load variance at the VPSs
and temporary server downtime, these intervals shifted sometimes
a bit. Table 1 denotes the number of replications and final sample
size for each tested AS.
Yespossible hostmalfunction: discardmeasurement pairtranslate domainnames *run URLGetter over TCPhost list configuration (DNS resolver,SNI)run URLGetter overTCP/QUIC fromuncensored networkhostavailable?Input PreparationNoNoYesValidationData Collectionrun URLGetter over QUIChost listhost listcountry specific host listTCPQUICQUICTCPhost listhost listhost listfinal dataset:measurementpairsURLGettercommand pairsmeasurement pairshostavailable?filter out critical contentcategoriesfilter hosts byQUIC support(cURL)   n replications   % of test domainsCN(102)IR(120)IN(133)KZ(82)Country codes (# domains)comothersorgcncomothersorgcnnetircomothersorgcnnetirincomothersorgcnnetirinTrancoCitizenlab GlobalCountry-specificWeb Censorship Measurements of HTTP/3 over QUIC
ACM IMC 2021, November 2–4, 2021, Virtual Event
Table 1: Failure rates and error types of connection attempts
via HTTPS over TCP and HTTP/3 over QUIC.
Table 2: Decision chart to determine the censor’s most likely
traffic identification method for a tested domain.
Country,
(ASN)
Vantage
Type,
Hosts
China
(45090)
Iran
(62442)
India
(55836)
India
(14061)
India
(38266)
Kazakhstan
(9198)
VPS,
102
VPS,
120
PD,
133
VPS,
133
PD,
133
VPN,
82
Repli-
cations,
Sample
Size*
l
l
a
r
e
v
o
TCP
o
t
-
s
h
-
P
C
T
Failed Attempts
QUIC
o
t
-
s
h
-
S
L
T
r
r
e
-
e
t
u
o
r
t
e
s
e
r
-
n
n
o
c
o
t
-
s
h
-
C
U
Q
I
l
l
a
r
e
v
o
69,
6706
36,
3887
2,
266
60,
7531
1,
133
22,
1764
37.3% 25.9% 2.7% -
8.6% 27.1% 27.0%
34.4% -
33.4% -
-
16.2% 15.1%
15.0% 7.5% -
4.5% 3.0% 12.0% 12.0%
16.3% -
12.8% -
3.2% -
-
-
-
-
16.3% 0.2% 0.1%
12.8% -
-
3.2% -
-
1.1% 1.1%
* final sample size of all replications after validation step filtering (c.f., Figure 1)
hosts are unavailable. Similarly, in the Iranian network AS62442, the
failure rate drops from 34.4% to 16.2% when using QUIC instead of
TCP. QUIC blocking was also observed in the network of AS55836
in India where 15% of TCP/TLS connections fail and 12% of the
HTTP/3 requests. Across all probed networks, the only detected
QUIC error type was QUIC-hs-to, which suggests the likely use of
black holing as an interference method.
Figure 3 breaks down the observed failure types and depicts
how the connection response of each tested host changes when
using QUIC (right-hand side) instead of TCP. Subsections 5.1 and
5.2 further explain this Figure, and provide a more detailed analysis
of the results.
5.1 IP-based Blocking
IP blocking is one of the most common censorship methods. Since
traffic is blocked depending on the destination IP, it affects QUIC
and TCP traffic alike. From our measurements, we derive the pres-
ence of IP-based blocking in AS45090 (China) and AS55836 (India).
The corresponding pieces of evidence are listed in Table 2 and will
be explained in the following.
Due to the larger sample size and temporal consistency, this
section focuses especially on the AS45090 (China) data set. There,
three different types of network errors were measured: TCP-hs-to,
TLS-hs-to, and conn-reset errors (c.f., Table 1). All hosts, that raised
an HTTPS connection reset error are still available via HTTP/3 over
QUIC. Similar, in the case of TLS handshake errors over HTTPS, the
corresponding HTTP/3 attempt nearly always succeeds. These find-
ings indicate that HTTP/3 over QUIC traffic is less censored than
traditional HTTPS via TCP, in AS45090. However, if the HTTPS re-
quest times out during the TCP handshake (TCP-hs-to), an HTTP/3
request also fails before the QUIC handshake completes.
In such scenarios in AS45090, it is most likely that the destination
IP addresses is blocked: Because neither handshake is completed,
Response
success
TCP-hs-to,
route-err
TLS-hs-to,
conn-reset