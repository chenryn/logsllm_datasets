transactions List of transactions
Size
Value always 0xD9B4BEF9
4 bytes
Number of bytes following up to end of block 4 bytes
80 bytes
1-9 bytes
variable
Table 4: Structure of Bitcoin block
Each block is identified by a hash which is generated by run-
ning the SHA256 cryptographic hash algorithm twice on the block
Session 6B: Applied CryptographyAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand536being placed at the end of block as specified by segregated wit-
ness (SegWit).4 This way, our result inherits all the advantages of
SegWitness, besides enjoying a more compact witness.
When a miner finds a solution nonce (that is inserted into the
block header) such that the block header hash is less than the target,
the miner transmits the candidate block to all its peers immediately.
By the consensus mechanism of Bitcoin, every node independently
validates the new block before propagating it to its peers, which
ensures that only valid blocks are propagated on the network. In-
stead of individually validating all the transactions within the block,
with our modifications, each node only needs to simply verify one
aggregate signature with algorithm AддV eri f y( ˆT , ˆA, z), as follows.
• Note that both ˆT and ˆA are ordered. In order to ensure the
elements within are distinct, just traverse the lists ˆT and ˆA
to confirm that every two adjacent elements are different
and are monotonically incremented.
• If the elements are not distinct in the above step, abort and
output RE J ECT . Otherwise, continue with the next proce-
dure.
• Execute the aggregate signature validation, and output ACCEPT
if the verification is successful. Otherwise, output RE J ECT .
7 CONCLUSION AND FUTURE WORK
In this work, we present the first aggregate signature (AS) scheme
from general elliptic curve groups without bilinear maps. Compared
to a list of individual signatures (on potentially pairwise distinct
messages), the storage volume of signatures reduces about 49.8%
and the signature verification time can even reduce about 72% with
the proposed AS scheme. Its provable security is based on a new as-
sumption, named non-malleable discrete logarithm (NMDL), which
is proved in the generic group and random oracle model (and is also
implied by the DL assumption and a weaker non-black-box assump-
tion). We suggest the NMDL assumption should be of independent
interest. Finally, we specify in detail the application of the proposed
AS scheme to Bitcoin, with the goal of maximizing performance
and compatibility. Towards that, we adopt a Merkle-Patricia tree
based implementation of our AS scheme. Besides security inherited
from Bitcoin, the AS-aided system is also more friendly to segre-
gated witness, and provides better protection against transaction
malleability attacks.
Though using both generic group model and random oracle
model is not rare (particularly for arguing security of practical
cryptographic schemes, e.g. [13, 15, 62, 64]), it is interesting to in-
vestigate whether practical AS schemes from general groups can
be built with provable security only in the random oracle model.
Note that our aggregate signature only about halves the bandwidth
or storage volume of signatures. Studying the (im)possibility of
constant-size AS from general groups is an important question for
future research, on which we are inclined to a theoretical impossi-
bility result (at least for the case of black-box security reduction).
4Segregated witness is an architectural change to Bitcoin, which aims to move the
witness data from the field of scriptSig (unlocking script) in a transaction into a separate
witness data structure.
ACKNOWLEDGMENTS
We are grateful to Xing Chang, Leixiao Cheng, Boru Gong, Xingzhong
Huang, Bao Li, Wei Yu and Andrew C. Yao for many helpful discus-
sions and assistance.
This work is supported in part by National Key Research and
Development Program of China under Grant No. 2017YFB0802000,
National Natural Science Foundation of China under Grant Nos.
61472084 and U1536205, Shanghai Innovation Action Project un-
der Grant No. 16DZ1100200, Shanghai Science and Technology
Development Funds under Grant No. 16JC1400801, and Shandong
Provincial Key Research and Development Program of China under
Grant Nos. 2017CXG0701 and 2018CXGC0701.
REFERENCES
[1] M. Abe and S. Fehr. Perfect NIZK with Adaptive Soundness. TCC 2007: 118-136.
[2] A. M.
at
Antonopoulos.
Mastering
Available
Bitcoin.
https://github.com/bitcoinbook/bitcoinbook
[3] A. M. Antonopoulos. Mastering Bitcoin. Section: Base58. Available at
https://github.com/bitcoinbook/bitcoinbook
[4] A. Bagherzandi, J.H. Cheon, and S. Jarecki. Multisignatures Secure Under the Dis-
crete Logarithm Assumption and a Generalized Forking Lemma. ACM Conference
on Computer and Communications Security 2008: 449–458.
[5] B. Barak. How to Go Beyond the Black-Box Simulation Barrier. FOCS 2001:
106-115.
[6] R. Barbulescu and S. Duquesne. Updating key size estimations for pairings.
Journal of Cryptology, 2018: 1-39.
[7] Base58Check Encoding. Available at https://en.bitcoin.it/wiki/Base58Check_encoding
[8] M. Bellare, C. Namprempre and G. Neven. Unrestricted Aggregate Signatures.
[12] M. Bellare and P. Rogaway. Random Oracles Are Practical: A Paradigm for
[13] Bethencourt, J., Sahai, A., Waters, B. Ciphertext-Policy Attribute-Based Encryp-
[11] M. Bellare and A. Palacio. The Knowledge-of-Exponent Assumptions and 3-
ICALP 2007: 411-422.
[9] M. Bellare and G. Neven. Multi-Signatures in the Plain Public-Key Model and
a General Forking Lemma. ACM Conference on Computer and Communications
Security 2006: 390-399.
[10] M. Bellare and A. Palacio. Towards Plaintext-Aware Public-Key Encryption
without Random Oracles. ASIACRYPT 2004: 48-62.
Round Zero-Knowledge Protocols. CRYPTO 2004: 273-289.
Designing Efficient Protocols. ACM CCS 1993: 62–73.
tion. IEEE Symposium on Security and Privacy (S&P) 2007, 321-334.
[14] A. Boldyreva. Threshold Signatures, Multisignatures and Blind Signatures Based
on the Gap-Diffie-Hellman-Group Signature Scheme. PKC 2003, LNCS 2567,
Springer-Verlag.
[15] A. Boldyreva, C. Gentry, A. O’Neill and D. H. Yum. Ordered Multisignatures
and Identity-Based Sequential Aggregate Signatures, with Applications to Secure
Routing. CCS 2007: 276-285.
[16] N. Bitansky, R. Canetti, A. Chiesa, and E. Tromer. From Extractable Collision
Resistance to Succinct Non-Interactive Arguments of Knowledge, and Back Again.
ITCS 2012: 326-349.
Blockchains. ASIACRYPT 2018, to appear.
crypted Signatures from Bilinear Maps. EUROCRYPT 2003: 416-432.
ASIACRYPT 2001: 514-532.
[20] D. Bradbury. What the ‘Bitcoin Bug’ Means: A Guide to Transaction Mal-
leability. Available at https://www.coindesk.com/bitcoin-bug-guide-transaction-
malleability
[18] D. Boneh, C. Gentry, B. Lynn and H. Shacham. Aggregate and Verifiably En-
[19] D. Boneh, B. Lynn and H. Shacham. Short Signatures from the Weil Pairing.
[17] D. Boneh, M. Drijvers, and G. Neven. Compact Multi-Signatures for Smaller
(2) 2008: 449-460.
[21] R. Canetti and R. R. Dakdouk. Extractable Perfectly One-Way Functions. ICALP
[22] R. Canetti and R. R. Dakdouk. Towards a Theory of Extractable Functions. TCC
[23] C. Research. SEC 2: Recommended Elliptic Curve Domain Parameters 2010.
2009: 595-613.
Available at http://www.secg.org/sec2-v2.pdf
[24] I. Damgård. Towards Practical Public Key Systems Secure Against Chosen
[25] I. Damgård, S. Faust and C. Hazay. Secure Two-Party Computation with Low
[26] A. W. Dent. The Cramer-Shoup Encryption Scheme is Plaintext Aware in the
Ciphertext Attacks. CRYPTO 1991: 445-456.
Communication. TCC 2012: 54-74.
Standard Model. EUROCRYPT 2006: 289-307.
for Multiexponentiations. IEEE Trans. Computers (2) 2000: 141-147.
[27] V. S. Dimitrov, G. A. Jullien, and W. C. Miller. Complexity and Fast Algorithms
Session 6B: Applied CryptographyAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand537[28] A. Fiat and A. Shamir. How to Prove Yourself: Practical Solutions to Identification
[29] R. Gennaro, H. Krawczyk, and T. Rabin. Okamoto-Tanaka Revisited: Fully Au-
and Signature Problems. CRYPTO 1986: 186-194.
thenticated Diffie-Hellman with Minimal Overhead. ACNS 2010: 309-328.
[30] S. Goldwasser, H. Lin, and A. Rubinstein. Delegation of Computation without
Rejection Problem from Designated Verifier CS-Proofs. IACR Cryptology ePrint
Archive 2011: 456.
[31] D. M. Gordon. A Survey of Fast Exponentiation Methods. J. Algorithms 27(1)
1998: 129-146.
[32] J. Groth. Short Pairing-Based Non-Interactive Zero-Knowledge Arguments.
[33] S. Hada and T. Tanaka. On the Existence of 3-Round Zero-Knowledge Protocols.
[34] D. Hankerson, A. Menezes and S. Vanstone. Guide to Elliptic Curve Cryptography.
ASIACRYPT 2010: 321-340.
CRYPTO 1998: 408-423.
Springer 2004.
Assumption. EUROCRYPT 2018: 197-229.
Multisignatures. NEC Research & Development, 71:1–8, 1983.
2008: 200-209.
[35] S. Hohenberger, B. Waters. Synchronized Aggregate Signatures from the RSA
[36] K. Itakura and K. Nakamura. A Public-Key Cryptosystem Suitable for Digital
[37] T. Jager and J. Schwenk. On the Equivalence of Generic Group Models. ProvSec
[38] D. Johnson, A. Menezes and S. Vanstone. The Elliptic Curve Digital Signature
[39] H. Krawczyk. HMQV: A High-Performance Secure Diffie-Hellman Protocol.
Algorithm (EC-DSA). Int. J. Inf. Sec 1(1) 2001: 36-63.
CRYPTO 2005: 546-566.
[40] C.M. Li, T. Hwang, and N.Y. Lee. Threshold Multisignature Schemes where
Suspected Forgery Implies Traceability of Adversarial Shareholders. EUROCRYPT
1994, LNCS 950, Springer-Verlag.
[41] S. Lu, R. Ostrovsky, A. Sahai, H. Shacham, and B. Waters. Sequential Aggregate
Signatures and Multisignatures without Random Oracles. EUROCRYPT 2006,
LNCS 4004, Springer-Verlag.
[42] A. Lysyanskaya, S. Micali, L. Reyzin, and H. Shacham. Sequential Aggregate
Signatures from Trapdoor Permutations. EUROCRYPT 2004, LNCS 3027, Springer-
Verlag.
[43] C. Ma, J. Weng, Y. Li and R. H. Deng. Efficient Discrete Logarithm Based Multi-
Signature Scheme in the Plain Public Key Model. Codes Cryptography 54(2) 2010:
121-133.
[44] W. Mao. Modern Cryptography: Theory and Practice. CRC 2004.
[45] U. Maurer. Abstract Models of Computation in Cryptography. IMA Cryptography
[46] U. Maurer and S. Wolf. Lower Bounds on Generic Algorithms in Groups. EURO-
[47] G. Maxwell.
Signature Aggregation for Improved Scalablity. Available at
and Coding 2005: 1-12.
CRYPT 1998: 72-84.
https://bitcointalk.org/index.php?topic=1377298.0
[48] G. Maxwell, A. Poelstra, Y. Seurin and P. Wuille. Simple Schnorr Multi-Signatures
[49] S. Micali, K. Ohta, and L. Reyzin. Accountable-Subgroup Multisignatures. ACM
with Applications to Bitcoin. IACR Cryptology ePrint Archive 2018: 68.
CCS 2001, ACM Press.
[50] T. Mie. Polylogarithmic Two-Round Argument Systems. J. Mathematical Cryp-
[51] S. Nakamoto. Bitcoin: A Peer-to-Peer Electronic Cash System. 2008 Available at
tology 2(4) 2008: 343-363.
http://bitcoin.org/bitcoin.pdf
[52] K. Ohta and T. Okamoto. A Ddigital Multisignature Scheme Based on the Fiat-
Shamir Scheme. ASIACRYPT 1991, LNCS 739, Springer-Verlag.
[53] L. Parker. Bitcoin ‘Spam Attack’ Stressed Network for at least 18 Months, Claims
Software Developer. Available at https://bravenewcoin.com/news/bitcoin-spam-
attack-stressed-network-for-at-least-18-months-claims-software-developer/
[54] Patricia Tree. Available at https://github.com/ethereum/wiki/wiki/Patricia-Tree
[55] D. Pointcheval and J. Stern. Security Arguments for Digital Signatures and Blind
[56] M. D. Raimondo and R. Gennaro. New Approaches for Deniable Authentication.
Signatures. Journal of Cryptology, 13(2) 2000: 36-396.
ACM Conference on Computer and Communications Security 2005: 112-121.
[57] M. D. Raimondo, R. Gennaro, and H. Krawczyk. Deniable Authentication and
Key Exchange. ACM Conference on Computer and Communications Security 2006:
400-409.
[58] T. Ristenpart and S. Yilek. The Power of Proofs-of-Possession: Securing Multiparty
Signatures against Rogue-Key Attacks. EUROCRYPT 2007: 228-245.
[59] E. B. Sasson, A. Chiesay, C. Garmanz, M. Greenz, I. Miersz, E. Tromerx and
M. Virza. Zerocash: Decentralized Anonymous Payments from Bitcoin. IEEE
Symposium on Security and Privacy 2014: 459-474.
[60] E. B. Sasson, A. Chiesa, E. Tromer and M. Virz. Succinct Non-Interactive Zero
Knowledge for a Von Neumann Architecture. USENIX Security 2014: 781-796.
[61] C. P. Schnorr. Efficient Identification and Signatures for Smart Cards. CRYPTO
1989: 239-252.
[62] C. P. Schnorr. Security of Blind Discrete Log Signatures against Interactive
Attacks. ICICS 2001: 1-12.
mation processing Letters 79(2): 93-98, 2001.
2000: 73-89.
[63] C. P. Schnorr. Small Generic Hardcore Subsets for the Discrete Logarithm. Infor-
[64] C. P. Schnorr, M. Jakobsson. Security of Signed ElGamal Encryption. ASIACRYPT
[65] J. T. Schwartz. Fast Probabilistic Algorithms for Verifications of Polynomial
Identities. Journal of the ACM, 27(3): 701-717, 1980.
[66] V. Shoup. Lower Bounds for Discrete Logarithms and Related Problems. EURO-
CRYPT 1997: 256-266.
[67] A. V. Wirdum. Scriptless Scripts: How Bitcoin Can Support Smart Contracts With-
out Smart Contracts. Available at https://bitcoinmagazine.com/articles/scriptless-
scripts-how-bitcoin-can-support-smart-contracts-without-smart-contracts/
[68] A. C.-C. Yao and Y. Zhao. Deniable Internet Key Exchange. ACNS 2010: 329-348.
[69] A. C.-C. Yao and Y. Zhao. OAKE: A New Family of Implicitly Authenticated
Diffie-Hellman Protocols. ACMCCS 2013: 1113-1128. Full version available at
https://eprint.iacr.org/2011/035
[70] A. C.-C. Yao and Y. Zhao. Online/Offline Signatures for Low-Power Devices. IEEE
[71] A. C.-C. Yao and Y. Zhao. Privacy-Preserving Authenticated Key-Exchange Over
Trans Information Forensics and Security 8(2) 2013: 283-294.
Internet. IEEE Trans Information Forensics and Security 9(1) 2014: 125-140.
Session 6B: Applied CryptographyAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand538