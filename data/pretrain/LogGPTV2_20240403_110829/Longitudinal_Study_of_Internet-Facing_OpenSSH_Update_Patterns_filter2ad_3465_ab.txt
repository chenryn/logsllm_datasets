servers running Ubuntu Linux.
3.3 Do Cloud-Hosted Servers Update Faster?
We next consider whether large cloud providers exhibit diﬀerent updating behav-
ior compared to the rest of the Internet. We consider three major hosting
providers, Amazon Web Services (speciﬁcally EC2), Azure Cloud, and Google
Cloud. We map their IP addresses based on the publicly announced netblocks
each share.
Figure 3b uses OpenSSH patch superseded dates on Ubuntu to compare cloud
providers and the remainder of the Internet. Overall, we see that all three cloud
providers have relatively similar patch level distributions and that the remainder
of the Internet lags behind. These cloud providers collectively account for around
680
J. C. West and T. Moore
Fig. 2. Coverage of OpenSSH by operating system over time.
one third of all hosted Ubuntu OpenSSH servers, so their improved performance
does make a diﬀerence overall.
4 How Vulnerable is Outdated Software?
Now that the software patch level of OpenSSH can be more accurately deduced,
we look at the distribution of CVEs for OpenSSH over time to test if CVEs
inﬂuence patch speed. We have collected additional snapshots from Censys which
range from late 2015 through 2020 on a nearly weekly basis and contain SSH
banners for the entire IPv4 address space collected by Censys. We parse every
SSH banner and map to a backported patch version where applicable.
We examined CVEs announced between August 2015 and the end of 2019.
For each of these 27 CVEs, we create a mapping of which backported patches are
aﬀected by which CVEs. For this mapping, we start by checking which upstream
versions are aﬀected by each CVE from the National Vulnerability Database [8].
If the upstream OpenSSH version of a given security patch is not aﬀected by a
CVE, then that patch version is not considered to be aﬀected either. For security
patches where the upstream version is aﬀected by a given CVE, we inspect the
changelog text for that patch, available on Launchpad [7], to see whether either
that patch or a previous patch in its tree claim to ﬁx that CVE.
Table 2 reports the CVEs with initial publish dates, the earliest upstream
patch date, and earliest Ubuntu backport patch date (if one is available). We
also compute the lag between when a given CVE was announced and when it
was patched in the upstream or backported ﬁx. In the cases where the lag for
the OpenSSH ﬁx is negative, the CVE aﬀected older versions but not the most
recent one released at that time. In the few cases where the Ubuntu backport
lag is negative, the CVE appeared as ﬁxed in the changelog before the oﬃcial
publish date on the NVD website.
Longitudinal Study of Internet-Facing OpenSSH Update Patterns
681
Fig. 3. (a) Comparison of days superseded for OpenSSH servers overall, on Ubuntu
(upstream version) and Ubuntu (backport version). (b) Days superseded for OpenSSH
Ubuntu servers running on major cloud service providers using backport information.
We note that 7 of the 27 CVEs are not ﬁxed in any backports, so the only way
to eliminate these vulnerabilities is to manually update the OpenSSH software to
a newer upstream version. One CVE (2016-8858) was disputed in the community
whether it was even a vulnerability. No backport was issued.
We utilize the mapping of CVEs to vulnerable Ubuntu backports in order to
compute the number OpenSSH servers that are vulnerable and not vulnerable
to each CVE for each Censys snapshot within 2015 and 2019. We then combine
these over time to show the total number of IPs which are and are not vulnerable
to a given CVE over time. An example of this for CVE-2016-10009 is shown
in Fig. 4. For this ﬁgure, the blue line represents the number of IP addresses
which are vulnerable to CVE-2016-10009 over time, while the orange line is
the number of IPs which are not vulnerable. The sum of the orange and blue
lines at a given point on the x-axis is equal to the number of servers on that
Censys snapshot which are running OpenSSH on Ubuntu with a security patch
available on Launchpad. The noise in the table is related to the number of IP
addresses Censys scanned at each point in time. The number of Ubuntu servers
that Censys scans generally increases over time, aside from the sharp drop in
early 2016 which might be attributed to large providers opting out of Censys
scanning [3]. The gaps in the lines show where no scan data was available from
Censys. Several snapshots between 2016 and 2018 contain signiﬁcantly fewer IP
addresses than adjacent snapshots, but we chose not to omit these scans from
the plots because they accurately reﬂect variations in how much scanning Censys
completed at those points in time. These dips should be ignored when drawing
conclusions.
682
J. C. West and T. Moore
Table 2. OpenSSH CVEs released during period of study
CVE
ID
CVSS Date
OpenSSH Fixed Ubuntu Backport
Date
Lag Date
Lag
4.3
2015-5352
8.5
2015-5600
1.9
2015-6563
6.9
2015-6564
7.2
2015-6565
7.2
2015-8325
4
2016-0777
4.6
2016-0778
5
2016-1907
7.5
2016-1908
5.5
2016-3115
4.3
2016-6210
7.8
2016-6515
7.8
2016-8858
2016-10009 7.5
2016-10010 6.9
2016-10011 2.1
2016-10012 7.2
2016-10708 5
2017-15906 5
2018-15473 5
2018-15919 5
2018-20685 2.6
4
2019-6109
4
2019-6110
2019-6111
5.8
2019-16905 7.8
2016-05-09 48
2015-08-14 12
2015-08-14 12
2015-08-02 2017-07-01 699
2015-08-02 2015-08-11 9
2015-08-24 2015-08-11 −13
2015-08-24 2015-08-11 −13
2015-08-24 2015-08-11 −13
2016-04-15 −15
2016-04-30 2016-08-01 93
2016-01-14 2016-01-14 0
2016-01-14 0
2016-01-14 2016-01-14 0
2016-01-14 0
2016-01-19 2016-01-14 −5
2016-05-09 111
2017-04-11 2016-02-29 −407 2016-05-09 −337
2016-03-22 2016-03-10 −12
2017-02-13 2016-08-01 −196 2016-08-15 −182
2016-08-07 2016-08-01 −6
2016-08-15 8
2016-12-09 2016-12-19 10
(disputed)
2017-01-04 2016-12-19 −16
2018-01-22 383
2017-01-04 2016-12-19 −16
2018-01-22 383
2017-01-04 2016-12-19 −16
2018-01-22 383
2017-01-04 2016-12-19 −16
2018-01-22 383
2018-01-21 2016-12-19 −398 2018-11-06 289
2017-10-25 2017-10-03 −22
2018-01-22 89
2018-08-17 2018-08-24 7
2018-11-06 81
2018-08-28 2018-10-19 52
2019-01-10 2019-04-17 97
2019-01-31 2019-04-17 76
2019-01-31 2019-04-17 76
2019-01-31 2019-04-17 76
2019-10-09 2019-10-09 0
−5
2019-01-22 12
2019-02-07 7
2019-02-07 7
Median
12
We observe that the near simultaneous publication of the CVE and upstream
patch has very little impact on the deployment of vulnerable servers. The steady
increase in vulnerable OpenSSH servers continues for slightly more than one
year until the Ubuntu backport is published, at which point the patch is rapidly
applied to more than one million machines, followed by a steady linear increase in
the subsequent months and years. From this one example, at least, it appears that
the availability of backports is by far the dominant factor in applying updates
to eliminate software vulnerabilities.
Longitudinal Study of Internet-Facing OpenSSH Update Patterns
683
Fig. 4. Number of IP addresses that are aﬀected by CVE-2016-10009 over time
We analyzed the plots of all 27 CVEs (available in Appendix A) to see if the
same trend held true. We see that many IP addresses patch very quickly as soon
as a backported patch for a CVE is released, although some never patch. For the
CVEs that do not have a security backport (with the darker backgrounds), the
results are less predictable. Often, the number of vulnerable servers naturally
goes down over time as users update their software for other reasons (e.g., CVE-
2015-6563). In other cases, the number of vulnerable servers continues to increase
well after the CVE was published (e.g., CVE-2018-15919).
Another consistent ﬁnding from inspecting the graphs is that the publication
of the CVE and upstream patch is not the catalyst for updates. Rather, it is
consistently the backport that sparks an uptick in patches to plug vulnerabilities.
We now collapse back down from the 27 individual plots in Appendix A
that capture exposure to individual CVEs to a single, aggregated view of the
presence of vulnerabilities in OpenSSH over time. Ultimately, what matters from
a security perspective is whether systems have any unpatched vulnerabilities
present.
We start by calculating the fraction of Ubuntu OpenSSH servers throughout
the Internet which are aﬀected by at least one published CVE. We see in Fig. 5a