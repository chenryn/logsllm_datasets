# 基于浏览器的密码管理器安全性评估
##### 译文声明
本文是翻译文章，文章原作者 Sean Oesch，Scott Ruoti，文章来源：usenix.org
原文地址：
译文仅供参考，具体内容表达以及含义原文为准。
密码管理器可以帮助用户更有效地管理其密码，并解决围绕基于密码的身份验证的许多问题。先前的研究已经发现了现有密码管理器中的重大漏洞，特别是在基于浏览器的密码管理器中，本文评估了十三种流行的密码管理器，并考虑了密码管理器生命周期的所有三个阶段（密码生成，存储和自动填充）。本文的评估是对密码管理器中密码生成的首次分析，它发现了几种非随机字符分布，并确定了所生成的密码容易受到在线和离线猜测攻击的实例。对于密码存储和自动填充，密码管理器在过去的十年中有所改进，但仍然存在很多问题。这些问题包括未加密的元数据，不安全的默认值以及点击劫持攻击的漏洞。根据结果确定了需要避免使用的密码管理器，并提供有关如何改进现有密码管理器的建议。
## 0x01 Abstract
尽管基于密码的身份验证面临着公认的问题，但它仍然是Web上使用的主要身份验证形式。由于攻击者难以猜出的密码也很难被用户记住，因此用户通常会创建较弱的密码以避免回想它们的认知负担。实际上，随着用户需要存储的密码数量的增加，他们经常在网站之间重复使用密码。
密码管理器可以帮助用户更有效地管理其密码。它们通过生成强密码，存储这些密码，然后在访问站点时填写适当的密码来减轻用户的认知负担。用户现在可以遵循有关密码的最新安全建议，而不会给自己造成很大的认知负担。但是密码管理器并非不受攻击。
之前在LastPass和RoboForm等主要密码管理器中发现了重大漏洞，由于基于浏览器的密码管理器的密码自动填充功能，容易遭受跨站点脚本攻击（XSS）和网络注入攻击。
部分研究已经过去了五年或五年以上，因此尚不清楚密码管理器是否仍然易受攻击，或者现在是否准备好被广泛采用。为了回答这个问题，本研究更新并扩展了以前的结果，并提供了对十三种流行密码管理器的全面，最新的安全性评估，包括五个浏览器插件和六个直接集成到浏览器中的密码管理器。
在评估中，考虑了完整的密码管理器生命周期-密码生成，存储和自动填充。对于密码生成，评估了由研究过的密码管理器生成的1.47亿个密码的语料库，以确定它们是否表现出攻击者可以利用的任何非随机性。结果发现了生成密码的几个问题，最严重的是，一小部分较短的生成密码难以抵抗在线和离线攻击（分别少于10个字符和18个字符）。
结果发现，尽管密码管理器在过去五年中得到了改进，但仍然存在重大的安全隐患。在本文的结尾提出了一些建议，包括如何改进现有的密码管理器以及确定将来可以显着提高密码管理器的安全性和可用性的未来工作。
## 0x02 Password Managers
从最基本的意义上讲，密码管理器是一种存储用户凭据（即用户名和密码）的工具，可减轻与用户记住许多唯一登录凭据有关的认知负担。这种密码存储库通常称为密码库。理想情况下，保管库本身以加密形式存储，其中加密密钥最常见地是从用户选择的密码（称为主密码）派生的。密码库可以在线存储，从而使其可以在多个设备之间同步。
除了存储用户选择的密码外，大多数现代密码管理器还可以帮助用户生成密码。密码生成将所需密码的长度，所需字符集以及密码应显示的任何特殊属性作为输入（例如，至少一位数字和一个符号，不难识别的字符）。密码生成器输出符合输入标准的随机生成的密码。
许多密码管理器还可以通过自动选择并填写（即自动填写）适当的用户名和密码来帮助用户对网站进行身份验证。如果用户在网站上拥有多个帐户，则密码管理器将允许用户选择他们希望用于自动填充的帐户。如果正确实施和使用，密码管理器将为用户带来许多明显的好处：
1.它减轻了记住用户名和密码的认知负担。
2.为每个网站分配不同的密码很容易，解决了密码重用的问题。
3.易于生成可抵抗在线和离线猜测攻击的密码。
## 0x03 Analysis
在本文中分析了13种不同的密码管理器，可以根据它们与浏览器的集成程度将其分类：应用程序，扩展程序和浏览器。本文专注于浏览器中的密码管理器，但包括两个桌面客户端进行比较，应用程序是未与浏览器集成的桌面客户端。基于扩展的密码管理器被部署为浏览器插件，并且不依赖于桌面应用程序。基于浏览器的密码管理器是作为浏览器一部分实现的本机组件。
上表给出了分析后的密码管理器按这些类别细分的情况。该表还报告了与实用程序和可用性相关的功能-支持密码生成和自动填充，支持使用云同步扩展设置和密码库，使用密码的功能。命令行界面的密码管理器以及安全性-该工具是否支持多因素身份验证（MFA），是否可以锁定密码库，是否必须在其自己的选项卡或应用程序上输入该库的主密码（为防止此对话框的欺骗），密码管理器是否提供了一种工具来评估存储的帐户和密码的安全性，密码复制后管理器是否从剪贴板中清除了密码以及该工具是否开放源代码。
###  1）基于应用
分析了基于应用程序的密码管理器，倾向于手动同步以提高安全性。
KeePassX（v2.0.3）：KeePass是基于应用程序的密码管理器，最初是使用.NET平台构建的，并且旨在在Windows上使用。
KeePassX是KeePass的跨平台端口，用QTframework替代了.NET平台。
KeePassXC（v2.3.4）：KeePassXC是KeePassXintended的一个分支，旨在提供更频繁的更新和KeePass或KeePassX中找不到的其他功能（例如，用于密码生成的更多选项，命令行界面）。KeePassXC还提供了一个与应用程序接口的浏览器扩展程序，以在浏览器中自动填充密码。总体而言，KeePass系列应用程序估计有2000万用户。
###  2）基于插件
扩展程序缺少清除剪贴板的权限，基于扩展程序的密码管理器的sonone支持此功能，从而使用户密码容易受到无限期访问剪贴板的任何应用程序的攻击。分析的所有扩展都不支持该扩展本身的同步设置，要求用户记住正确更新这些设置以匹配其设置的每个新设备的安全性首选项。这些扩展设置包括对安全至关重要的选项，例如是否在关闭浏览器时注销，是否使用自动填充以及是否在填写不安全的表单之前发出警告。每个基于扩展的密码管理器的用户体验基本相似。
1Password
X（v1.14.1）：1Password估计有1500万用户，1Password提供基于应用程序的客户端（1Password）和基于扩展的客户端（1Password
X）；在本文中评估了基于扩展的客户端，因为如果需要与浏览器集成（推荐大多数用户都希望这样做），它是推荐的工具。虽然两个系统的安全性相似，但还是有一些小的区别—例如，从应用程序中的剪贴板中清除了密码，但未从扩展中清除。
要最初从云下载密码库，必须输入在用户生成帐户时提供给用户的128位密钥，从而为基于云的密码库提供了额外的安全性。
Bitwarden（v1.38.0）：在分析的基于扩展的密码管理器中，Bitwarden是独一无二的，因为它的所有功能都可用于非付费帐户，而其他密码管理器则需要订阅才能访问某些功能。
Dashlane（v6.1908.3）：
Dashlane估计有1000万用户。除了存储每个网站的用户名和密码外，Dashlane还在每个站点上跟踪和同步以下三个设置：“always log me
in”，“always require [the master password]”，和 “Use [password] for this
subdomain only.” 与不同步任何扩展设置的其他基于扩展的密码管理器相比，此功能提供了一点优势。
LastPass（v4.24.0）：LastPass估计有1650万用户，是所有商业密码管理器中最多的。
RoboForm（v8.5.6.6）：
RoboForm估计有600万用户。像1Password一样，RoboForm同时提供基于应用程序的客户端和基于扩展的客户端。在本文中，出于与使用1Password
X采取此方法相同的原因，评估了基于扩展的客户端。
###  3）基于浏览器
与基于应用程序的密码管理器和基于扩展的密码管理器相比，基于浏览器的密码管理器缺少许多功能。虽然所有基于浏览器的密码管理器都允许使用多因素身份验证来保护存储密码库的云帐户，但除了Firefox之外，其他任何人都可以锁定该库，而无需从浏览器中删除该帐户。
Firefox提供了使用主密码来限制对密码库的访问的选项。由于这些密码管理器没有同步设置，也永远不会将密码复制到剪贴板，因此这些功能不适用。
Chrome（v71.0）：Chrome支持生成密码。它检测用户何时可能需要密码，并提供要为该用户生成密码的信息。与其他任何密码管理器不同，Chrome具有基本功能来尝试检测密码策略。
Edge（v42.17134）、Firefox（v64.0）、 Internet
Explorer（v11.523）、Opera（v58.0.3135）：这些密码管理器在高级功能上都相似。
Safari（v12.0）：Safari与iCloud钥匙串集成时可以生成密码，尽管这些密码始终为“ xxx-xxx-xxx-xxx”形式。