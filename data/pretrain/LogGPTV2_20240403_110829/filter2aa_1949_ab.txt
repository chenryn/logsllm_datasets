The IEEE 802.11b uses a 48-bit address to identify the link-layer network
interface [12]. The address is set by the hardware manufacturer or can be con-
ﬁgured from the operating system if the device driver allows it.
The MAC address of the device is used to identify the contaminated devices.
The ﬁrst 24 bits of the address indicate Organizationally Unique Identiﬁer (OUI),
which is assigned by the IEEE. The rest of the bits are determined by the
particular vendor organization.
The manufacturer can use, for example, the 8 bits after the OUI to indicate
a contaminated device. Thus, a packet capture software can easily be extended
to spot contaminated devices from an area covered by the radio device.
The operating system is modiﬁed as follows. The secret key (Ks) of a secure
communication protocol is encoded with information on e.g. what type of key it
is, what actual session or user it refers to and other necessary information. This
information is encrypted with an encryption scheme and a global key known
only by the attacker. The “encryption” scheme can be simply protocol and the
ﬁrst applicable bits of the MAC address are operands in XOR operation, and
the result is the network interface identiﬁer of an IPv6 address. The XOR oper-
ation hides the key from outsiders that do not know the encoding scheme. The
operation is illustrated below.
Ks ⊕ MAC address = interface id
Agents of the vendor have a database of the contaminated devices on their
laptops. The laptops automatically recognize the contaminated devices when
scanning the WLAN radio frequencies. When they recognize the contamined
devices, the laptops start to record the IP and above level communications and
record the IPv6 addresses. The IPv6 address contains the secret key, which can
be used to decrypt the encrypted communication. For secret keys larger than
the 64 bits, we may use a similar encoding scheme presented in next section.
This requires naturally multiple stateless address autoconﬁguration procedures
that are nevertheless likely to be used for trying to protect the privacy of the
user. However, depending on the key length and the used encoding scheme, only
single address can be enough, and the remaining bits of the key can be revealed
with brute force attack.
The above scenario can naturally be exploited with rootkit malware, received
from an email message, for example. The malware checks out the MAC address of
IPv6 is Bad for Your Privacy
5
the particular device and contaminates the operating system. The MAC address
is sent to the attackers computer. Thus, the attacker can now easily track the
correct traﬃc in the radio network. However, this additional scenario requires
the sending of the MAC address, and thus, can be more easily noticed compared
to the exploitation by the hardware manufacturer.
3
Conclusions
The IPv6 Stateless Address Autoconﬁguration can be considered inherently
harmful for the privacy of the user. It either 1. introduces the risk that all
the traﬃc originating from the host in diﬀerent places can be linked to the user
or 2. introduces a way to divulge sensitive information about the user or even
the secret keys of encrypted communication.
The IPv6 address as a covert channel is a major threat since it exists in
every packet even though the payload is protected by IPsec ESP. If the traﬃc
is protected with IPsec ESP, the covert channels of e.g. TCP are not visible for
outsiders. Also, we can assume that most computers do not have sophisticated
intrusion detection systems and even if they do, most users cannot use them. But,
the networks where the users reside, may have intrusion detection systems that
monitor the traﬃc. Thus, e.g. opening a new connection to divulge sensitive
information or secret keys is likely to be noticed, but not the covert channel
scheme in IPv6 addresses.
A straightforward countermeasure to the covert channel attack is not to allow
stateless address autoconﬁguration. The use of stateful server-based assignment
such as DHCPv6 [5] mitigates the problem eﬀectively. However, this is not pos-
sible e.g. for ad hoc networks and, thus, the applicability of the mitigation is
limited. Also, the DHCPv6 may introduce administrative burden that otherwise
would be relieved with the IPv6 Stateless Address Autoconﬁguration mechanism.
SEcure Neighbor Discovery (SEND) [3] protocol has been proposed to replace
the Neighbor Discovery protocol. SEND uses Cryptographically Generated Ad-
dresses (CGA) [4] which mitigate many attacks against Neighbor Discovery and
stateless address autoconﬁguration. The idea behing CGA is that the interface
identiﬁer is actually a host identiﬁer. The host has a public/private key pair
and a hash of the public key is used in the IPv6 address interface identiﬁer. It
might seem that CGA eﬀectively mitigates the possibility to use the addresses
as covert channels because every bit has meaning. If the address does not match
the has of public key used in SEND, it is trivial to deduce something is wrong.
However, the attacked needs just to pre-create key pairs that hash to a wanted
string that can be used as the address ﬁeld.
References
1. K. Ahsan and D. Kundur. Practical Data Hiding in TCP/IP. In Proceedings of
the Multimedia and Security Workshop at ACM Multimedia, Dec. 2002.
6
Janne Lindqvist
2. R. Anderson. Security Engineering: A Guide to Building Dependable Distributed
Systems. John Wiley & Sons, Inc., 2001.
3. J. Arkko, J. Kempf, B. Zill, and P. Nikander. RFC 3971: SEcure Neighbor Discovery
(SEND), Mar. 2005. Status: Proposed Standard.
4. T. Aura. RFC 3972: Cryptographically Generated Addresses (CGA), Mar. 2005.
Status: Proposed Standard.
5. J. Bound, B. Volz, T. Lemon, C. E. Perkins, and M. Carney. RFC 3315: Dynamic
Host Conﬁguration Protocol for IPv6 (DHCPv6), July 2003.
Status: Proposed
Standard.
6. S. Cabuk, C. E. Brodley, and C. Shields. IP covert timing channels: design and
detection. In Proceedings of the 11th ACM conference on Computer and commu-
nications security, pages 178–187, 2004.
7. A. Conta and S. Deering. RFC 2463: Internet Control Message Protocol (ICMPv6)
for the Internet Protocol Version 6 (IPv6) Speciﬁcation, Dec. 1998. Status: Draft
Standard.
8. S. Deering and R. Hinden. RFC 2460: Internet Protocol, Version 6 (IPv6) Speci-
ﬁcation, Dec. 1998. Status: Draft Standard.
9. A. Escudero-Pascual. Privacy in the next generation Internet: Data protection in
the context of European Union policy. PhD thesis, Royal Institute of Technology,
2002.
10. R. Hinden and S. Deering.
RFC 4291: IP Version 6 Addressing Architecture,
February 2006. Status: Draft Standard.
11. C. Huitema and B. Carpenter. RFC 3879: Deprecating Site Local Addresses, Sept.
2004. Status: Proposed Standard.
12. IEEE. IEEE Std 802-1990, IEEE Standards for Local and Metropolitan Area Net-
works: Overview and Architecture. The Institute of Electrical and Electronics En-
gineers, Inc., 1990. ISBN: 1-55937-052-1.
13. IEEE.
Std 802.11b-1999, Supplement to IEEE Standard for Information Tech-
nology – Telecommunications and information exchange between systems – Local
and metropolitan area networks – Speciﬁc requirements – Part 11: Wireless LAN
Medium Access Control (MAC) and Physical Layer (PHY) Speciﬁcations: Higher-
Speed Physical Layer Extension in the 2.4 GHz band. The Institute of Electrical
and Electronics Engineers, Inc., 1999.
14. J. Lindqvist. IPv6 Stateless Address Autoconﬁguration Considered Harmful. In
Proceedings of the Military Communications Conference - MILCOM 2006, Oct.
2006.
15. N. B. Lucena, G. Lewandowski, and S. J. Chapin. Covert Channels in IPv6. In
PET 2005, LNCS 3856, June 2006.
16. N. Moore. RFC 4429: Optimistic Duplicate Address Detection (DAD) for IPv6,
April 2006. Status: Proposed Standard.
17. S. J. Murdoch and S. Lewis. Embedding covert channels into TCP/IP. In 7th
Information Hiding Workshop, June 2005.
18. T. Narten and R. Draves. RFC 3041: Privacy Extensions for Stateless Address
Autoconﬁguration in IPv6, Jan. 2001. Status: Proposed Standard.
19. T. Narten, R. Draves, and S. Krishnan. Privacy Extensions for Stateless Address
Autoconﬁguration in IPv6: draft-ietf-ipv6-privacy-addrs-v2-04.
Internet draft,
IETF, May 2005. Work in progress. Expired Nov. 2005.
20. T. Narten, E. Nordmark, and W. Simpson. RFC 2461: Neighbor Discovery for IP
Version 6 (IPv6), Dec. 1998. Status: Draft Standard.
IPv6 is Bad for Your Privacy
7
21. R. Pereira and R. Adams. RFC 2451: The ESP CBC-Mode Cipher Algorithms,
Nov. 1998. Status: Proposed Standard.
22. S. Thomson and T. Narten. RFC 2462: IPv6 Stateless Address Autoconﬁguration,
Dec. 1998. Status: Draft Standard.