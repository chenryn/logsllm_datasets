   ->  Merge Join  (cost=355800197.59..378300206.45 rows=1000000248 width=0)  
         Merge Cond: (bbb0.order_id = aaa0.order_id)  
         ->  Sort  (cost=177900158.19..180400160.45 rows=1000000904 width=8)  
               Sort Key: bbb0.order_id  
               ->  Append  (cost=0.00..20405431.56 rows=1000000904 width=8)  
                     ->  Seq Scan on bbb0  (cost=0.00..641834.24 rows=41662924 width=8)  
                     ->  Seq Scan on bbb1  (cost=0.00..641805.76 rows=41661076 width=8)  
                     ->  Seq Scan on bbb2  (cost=0.00..641899.80 rows=41667180 width=8)  
                     ->  Seq Scan on bbb3  (cost=0.00..641919.76 rows=41668476 width=8)  
                     ->  Seq Scan on bbb4  (cost=0.00..641896.96 rows=41666996 width=8)  
                     ->  Seq Scan on bbb5  (cost=0.00..641854.20 rows=41664220 width=8)  
                     ->  Seq Scan on bbb6  (cost=0.00..641839.96 rows=41663296 width=8)  
                     ->  Seq Scan on bbb7  (cost=0.00..641894.08 rows=41666808 width=8)  
                     ->  Seq Scan on bbb8  (cost=0.00..641723.12 rows=41655712 width=8)  
                     ->  Seq Scan on bbb9  (cost=0.00..641754.88 rows=41657688 width=8)  
                     ->  Seq Scan on bbb10  (cost=0.00..641848.48 rows=41663848 width=8)  
                     ->  Seq Scan on bbb11  (cost=0.00..641771.56 rows=41658856 width=8)  
                     ->  Seq Scan on bbb12  (cost=0.00..642119.24 rows=41681424 width=8)  
                     ->  Seq Scan on bbb13  (cost=0.00..642059.68 rows=41677368 width=8)  
                     ->  Seq Scan on bbb14  (cost=0.00..641765.84 rows=41658484 width=8)  
                     ->  Seq Scan on bbb15  (cost=0.00..641703.16 rows=41654416 width=8)  
                     ->  Seq Scan on bbb16  (cost=0.00..641794.36 rows=41660336 width=8)  
                     ->  Seq Scan on bbb17  (cost=0.00..641842.80 rows=41663480 width=8)  
                     ->  Seq Scan on bbb18  (cost=0.00..642127.80 rows=41681980 width=8)  
                     ->  Seq Scan on bbb19  (cost=0.00..642048.00 rows=41676800 width=8)  
                     ->  Seq Scan on bbb20  (cost=0.00..641999.56 rows=41673656 width=8)  
                     ->  Seq Scan on bbb21  (cost=0.00..641971.04 rows=41671804 width=8)  
                     ->  Seq Scan on bbb22  (cost=0.00..641976.00 rows=41671900 width=8)  
                     ->  Seq Scan on bbb23  (cost=0.00..641976.76 rows=41672176 width=8)  
         ->  Materialize  (cost=177900039.40..182900040.64 rows=1000000248 width=8)  
               ->  Sort  (cost=177900039.40..180400040.02 rows=1000000248 width=8)  
                     Sort Key: aaa0.order_id  
                     ->  Append  (cost=0.00..20405421.72 rows=1000000248 width=8)  
                           ->  Seq Scan on aaa0  (cost=0.00..641834.24 rows=41662924 width=8)  
                           ->  Seq Scan on aaa1  (cost=0.00..641805.76 rows=41661076 width=8)  
                           ->  Seq Scan on aaa2  (cost=0.00..641899.80 rows=41667180 width=8)  
                           ->  Seq Scan on aaa3  (cost=0.00..641919.76 rows=41668476 width=8)  
                           ->  Seq Scan on aaa4  (cost=0.00..641896.96 rows=41666996 width=8)  
                           ->  Seq Scan on aaa5  (cost=0.00..641854.20 rows=41664220 width=8)  
                           ->  Seq Scan on aaa6  (cost=0.00..641839.96 rows=41663296 width=8)  
                           ->  Seq Scan on aaa7  (cost=0.00..641894.08 rows=41666808 width=8)  
                           ->  Seq Scan on aaa8  (cost=0.00..641723.12 rows=41655712 width=8)  
                           ->  Seq Scan on aaa9  (cost=0.00..641757.28 rows=41657928 width=8)  
                           ->  Seq Scan on aaa10  (cost=0.00..641848.48 rows=41663848 width=8)  
                           ->  Seq Scan on aaa11  (cost=0.00..641771.56 rows=41658856 width=8)  
                           ->  Seq Scan on aaa12  (cost=0.00..642119.24 rows=41681424 width=8)  
                           ->  Seq Scan on aaa13  (cost=0.00..642065.12 rows=41677912 width=8)  
                           ->  Seq Scan on aaa14  (cost=0.00..641757.00 rows=41657600 width=8)  
                           ->  Seq Scan on aaa15  (cost=0.00..641703.16 rows=41654416 width=8)  
                           ->  Seq Scan on aaa16  (cost=0.00..641794.36 rows=41660336 width=8)  
                           ->  Seq Scan on aaa17  (cost=0.00..641842.80 rows=41663480 width=8)  
                           ->  Seq Scan on aaa18  (cost=0.00..642127.80 rows=41681980 width=8)  
                           ->  Seq Scan on aaa19  (cost=0.00..642048.00 rows=41676800 width=8)  
                           ->  Seq Scan on aaa20  (cost=0.00..641999.56 rows=41673656 width=8)  
                           ->  Seq Scan on aaa21  (cost=0.00..641959.04 rows=41670604 width=8)  
                           ->  Seq Scan on aaa22  (cost=0.00..641982.44 rows=41672544 width=8)  
                           ->  Seq Scan on aaa23  (cost=0.00..641976.76 rows=41672176 width=8)  
(58 rows)  
postgres=# select count(*) from aaa join bbb using (order_id);  
   count      
------------  
 1000000000  
(1 row)  
Time: 1005965.972 ms (16:45.966)  
```                
### 2、开启并行，耗时： 76 秒。                               
```     
postgres=# set max_parallel_workers_per_gather =24;  
postgres=# set enable_parallel_append =off;  
postgres=# set enable_partitionwise_join =on;  
postgres=# explain select count(*) from aaa join bbb using (order_id);  
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=12494865.77..12494865.78 rows=1 width=8)
   ->  Gather  (cost=520571.51..12494864.33 rows=576 width=8)
         Workers Planned: 24
         ->  Append  (cost=520571.51..12494864.33 rows=24 width=8)
               ->  Partial Aggregate  (cost=520571.51..520571.52 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264263.99..516231.63 rows=1735955 width=0)
                           Hash Cond: (aaa0.order_id = bbb0.order_id)
                           ->  Parallel Seq Scan on aaa0  (cost=0.00..242564.55 rows=1735955 width=8)
                           ->  Parallel Hash  (cost=242564.55..242564.55 rows=1735955 width=8)
                                 ->  Parallel Seq Scan on bbb0  (cost=0.00..242564.55 rows=1735955 width=8)
               ->  Partial Aggregate  (cost=520548.40..520548.41 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264252.26..516208.71 rows=1735878 width=0)
                           Hash Cond: (aaa1.order_id = bbb1.order_id)
                           ->  Parallel Seq Scan on aaa1  (cost=0.00..242553.78 rows=1735878 width=8)
                           ->  Parallel Hash  (cost=242553.78..242553.78 rows=1735878 width=8)
                                 ->  Parallel Seq Scan on bbb1  (cost=0.00..242553.78 rows=1735878 width=8)
               ->  Partial Aggregate  (cost=520624.68..520624.69 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264290.98..516284.35 rows=1736132 width=0)
                           Hash Cond: (aaa2.order_id = bbb2.order_id)
                           ->  Parallel Seq Scan on aaa2  (cost=0.00..242589.33 rows=1736132 width=8)
                           ->  Parallel Hash  (cost=242589.33..242589.33 rows=1736132 width=8)
                                 ->  Parallel Seq Scan on bbb2  (cost=0.00..242589.33 rows=1736132 width=8)
               ->  Partial Aggregate  (cost=520640.86..520640.87 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264299.19..516300.40 rows=1736186 width=0)
                           Hash Cond: (aaa3.order_id = bbb3.order_id)
                           ->  Parallel Seq Scan on aaa3  (cost=0.00..242596.86 rows=1736186 width=8)
                           ->  Parallel Hash  (cost=242596.86..242596.86 rows=1736186 width=8)
                                 ->  Parallel Seq Scan on bbb3  (cost=0.00..242596.86 rows=1736186 width=8)
               ->  Partial Aggregate  (cost=520622.39..520622.40 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264289.81..516282.07 rows=1736125 width=0)
                           Hash Cond: (aaa4.order_id = bbb4.order_id)
                           ->  Parallel Seq Scan on aaa4  (cost=0.00..242588.25 rows=1736125 width=8)
                           ->  Parallel Hash  (cost=242588.25..242588.25 rows=1736125 width=8)
                                 ->  Parallel Seq Scan on bbb4  (cost=0.00..242588.25 rows=1736125 width=8)
               ->  Partial Aggregate  (cost=520587.70..520587.71 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264272.20..516247.68 rows=1736009 width=0)
                           Hash Cond: (aaa5.order_id = bbb5.order_id)
                           ->  Parallel Seq Scan on aaa5  (cost=0.00..242572.09 rows=1736009 width=8)
                           ->  Parallel Hash  (cost=242572.09..242572.09 rows=1736009 width=8)
                                 ->  Parallel Seq Scan on bbb5  (cost=0.00..242572.09 rows=1736009 width=8)
               ->  Partial Aggregate  (cost=520576.15..520576.16 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264266.34..516236.23 rows=1735971 width=0)
                           Hash Cond: (aaa6.order_id = bbb6.order_id)
                           ->  Parallel Seq Scan on aaa6  (cost=0.00..242566.71 rows=1735971 width=8)
                           ->  Parallel Hash  (cost=242566.71..242566.71 rows=1735971 width=8)
                                 ->  Parallel Seq Scan on bbb6  (cost=0.00..242566.71 rows=1735971 width=8)
               ->  Partial Aggregate  (cost=520620.06..520620.07 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264288.63..516279.77 rows=1736117 width=0)
                           Hash Cond: (aaa7.order_id = bbb7.order_id)
                           ->  Parallel Seq Scan on aaa7  (cost=0.00..242587.17 rows=1736117 width=8)
                           ->  Parallel Hash  (cost=242587.17..242587.17 rows=1736117 width=8)
                                 ->  Parallel Seq Scan on bbb7  (cost=0.00..242587.17 rows=1736117 width=8)
               ->  Partial Aggregate  (cost=520481.38..520481.39 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264218.23..516142.25 rows=1735655 width=0)
                           Hash Cond: (aaa8.order_id = bbb8.order_id)
                           ->  Parallel Seq Scan on aaa8  (cost=0.00..242522.55 rows=1735655 width=8)
                           ->  Parallel Hash  (cost=242522.55..242522.55 rows=1735655 width=8)
                                 ->  Parallel Seq Scan on bbb8  (cost=0.00..242522.55 rows=1735655 width=8)
               ->  Partial Aggregate  (cost=520508.85..520508.86 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264232.08..516169.51 rows=1735737 width=0)
                           Hash Cond: (aaa9.order_id = bbb9.order_id)
                           ->  Parallel Seq Scan on aaa9  (cost=0.00..242535.47 rows=1735747 width=8)
                           ->  Parallel Hash  (cost=242535.37..242535.37 rows=1735737 width=8)
                                 ->  Parallel Seq Scan on bbb9  (cost=0.00..242535.37 rows=1735737 width=8)
               ->  Partial Aggregate  (cost=520583.08..520583.09 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264269.86..516243.10 rows=1735994 width=0)
                           Hash Cond: (aaa10.order_id = bbb10.order_id)
                           ->  Parallel Seq Scan on aaa10  (cost=0.00..242569.94 rows=1735994 width=8)
                           ->  Parallel Hash  (cost=242569.94..242569.94 rows=1735994 width=8)
                                 ->  Parallel Seq Scan on bbb10  (cost=0.00..242569.94 rows=1735994 width=8)
               ->  Partial Aggregate  (cost=520520.67..520520.68 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264238.18..516181.21 rows=1735786 width=0)
                           Hash Cond: (aaa11.order_id = bbb11.order_id)
                           ->  Parallel Seq Scan on aaa11  (cost=0.00..242540.86 rows=1735786 width=8)
                           ->  Parallel Hash  (cost=242540.86..242540.86 rows=1735786 width=8)
                                 ->  Parallel Seq Scan on bbb11  (cost=0.00..242540.86 rows=1735786 width=8)
               ->  Partial Aggregate  (cost=520802.68..520802.69 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264381.34..516460.87 rows=1736726 width=0)
                           Hash Cond: (aaa12.order_id = bbb12.order_id)
                           ->  Parallel Seq Scan on aaa12  (cost=0.00..242672.26 rows=1736726 width=8)
                           ->  Parallel Hash  (cost=242672.26..242672.26 rows=1736726 width=8)
                                 ->  Parallel Seq Scan on bbb12  (cost=0.00..242672.26 rows=1736726 width=8)
               ->  Partial Aggregate  (cost=520758.19..520758.20 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264358.53..516416.80 rows=1736557 width=0)
                           Hash Cond: (aaa13.order_id = bbb13.order_id)
                           ->  Parallel Seq Scan on aaa13  (cost=0.00..242651.80 rows=1736580 width=8)
                           ->  Parallel Hash  (cost=242651.57..242651.57 rows=1736557 width=8)
                                 ->  Parallel Seq Scan on bbb13  (cost=0.00..242651.57 rows=1736557 width=8)
               ->  Partial Aggregate  (cost=520515.10..520515.11 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264235.00..516175.77 rows=1735733 width=0)
                           Hash Cond: (bbb14.order_id = aaa14.order_id)
                           ->  Parallel Seq Scan on bbb14  (cost=0.00..242538.70 rows=1735770 width=8)
                           ->  Parallel Hash  (cost=242538.33..242538.33 rows=1735733 width=8)
                                 ->  Parallel Seq Scan on aaa14  (cost=0.00..242538.33 rows=1735733 width=8)
               ->  Partial Aggregate  (cost=520465.20..520465.21 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264210.02..516126.20 rows=1735601 width=0)
                           Hash Cond: (aaa15.order_id = bbb15.order_id)
                           ->  Parallel Seq Scan on aaa15  (cost=0.00..242515.01 rows=1735601 width=8)
                           ->  Parallel Hash  (cost=242515.01..242515.01 rows=1735601 width=8)
                                 ->  Parallel Seq Scan on bbb15  (cost=0.00..242515.01 rows=1735601 width=8)
               ->  Partial Aggregate  (cost=520539.16..520539.17 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264247.56..516199.54 rows=1735847 width=0)
                           Hash Cond: (aaa16.order_id = bbb16.order_id)
                           ->  Parallel Seq Scan on aaa16  (cost=0.00..242549.47 rows=1735847 width=8)
                           ->  Parallel Hash  (cost=242549.47..242549.47 rows=1735847 width=8)
                                 ->  Parallel Seq Scan on bbb16  (cost=0.00..242549.47 rows=1735847 width=8)
               ->  Partial Aggregate  (cost=520578.45..520578.46 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264267.51..516238.50 rows=1735978 width=0)
                           Hash Cond: (aaa17.order_id = bbb17.order_id)
                           ->  Parallel Seq Scan on aaa17  (cost=0.00..242567.78 rows=1735978 width=8)
                           ->  Parallel Hash  (cost=242567.78..242567.78 rows=1735978 width=8)
                                 ->  Parallel Seq Scan on bbb17  (cost=0.00..242567.78 rows=1735978 width=8)
               ->  Partial Aggregate  (cost=520809.61..520809.62 rows=1 width=8)
                     ->  Parallel Hash Join  (cost=264384.85..516467.74 rows=1736749 width=0)
                           Hash Cond: (aaa18.order_id = bbb18.order_id)