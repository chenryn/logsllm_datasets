follow the directions to install each of the packages listed here.
Zervit 0.4
Download Zervit version 0.4 from http://www.exploit-db.com/exploits/12582/.
(Click the Vulnerable App option to download the files.) Unzip the down-
loaded archive and double-click the Zervit program to open and run it.
Then enter port number 3232 in the console when the software starts.
Answer Y to allowing directory listing, as shown in Figure 1-37. Zervit will
not automatically restart when you reboot Windows XP, so you will need to
restart it if you reboot.
40 Chapter 1
Figure 1-37: Starting Zervit 0.4
SLMail 5.5
Download and run SLMail version 5.5 from http://www.exploit-db.com/
exploits/638/, using the default options when prompted. Just click Next for
all of the options and don’t change anything. If you get a warning about a
domain name, just ignore it and click OK. We don’t really need to deliver
any email here.
Once SLMail is installed, restart your virtual machine. Then open
Start4All Programs4SL Products4SLMail4SLMail Configuration.
In the Users tab (default), right-click the SLMail Configuration window
and choose New4User, as shown in Figure 1-38.
Figure 1-38: Adding a user in SLMail
Setting Up Your Virtual Lab 41
Click the newly created user icon, enter username georgia, and fill in
the information for the user, as shown in Figure 1-39. The mailbox name
should be georgia with password password. Keep the defaults and press OK
once you’ve finished.
Figure 1-39: Setting the user information in SLMail
3Com TFTP 2.0.1
Next, download 3Com TFTP version 2.0.1 as a zipped file from http://www
.exploit-db.com/exploits/3388/. Extract the files and copy 3CTftpSvcCtrl and
3CTftpSvc to the directory C:\Windows, as shown in Figure 1-40.
Figure 1-40: Copying 3Com TFTP to C:\Windows
42 Chapter 1
Then open 3CTftpSvcCtrl (the blue 3 icon) and click Install Service, as
shown in Figure 1-41.
Figure 1-41: Installing 3Com TFTP
Click Start Service to start 3Com TFTP for the first time. From now on, it
will automatically start when you boot up the computer. Press Quit to exit.
XaMPP 1.7.2
Now we’ll install an older version of the XAMPP software, version 1.7.2, from
http://www.oldapps.com/xampp.php?old_xampp=45/. (The older version of
Internet Explorer on Windows XP seems to have some trouble opening this
page. If you have trouble, download the software from your host system and
copy it onto Windows XP’s desktop.)
1. Run the installer and accept the default options as they’re presented to
you. When installation is finished, choose option 1. start XAMPP Control
Panel, as shown in Figure 1-42.
Figure 1-42: Starting XAMPP Control Panel
Setting Up Your Virtual Lab 43
2. In the XAMPP Control Panel, install the Apache, MySQL, and FileZilla
services (select the Svc checkbox to the left of the service name). Then
click the Start button for each service. Your screen should look like the
one shown in Figure 1-43.
Figure 1-43: Installing and starting XAMPP services
3. Click the Admin button for FileZilla in the XAMPP Control Panel. The
Admin panel is shown in Figure 1-44.
Figure 1-44: FileZilla Admin panel
4. Go to Edit4Users to open the Users dialog, shown in Figure 1-45.
5. Click the Add button on the right of the dialog box.
6. In the Add User Account dialog box, enter georgia and press OK.
44 Chapter 1
Figure 1-45: Adding an FTP user
7. With georgia highlighted, check the Password box under Account
Settings and enter password.
Click OK. When prompted to share a folder, browse to the georgia’s
Documents folder on Windows and select it to share it, as shown in Figure 1-46.
Leave the defaults for all other checkboxes, as shown in the figure. Click
OK once you’ve finished and exit the various open windows.
Figure 1-46: Sharing a folder via FTP
Setting Up Your Virtual Lab 45
adobe acrobat Reader
Now we’ll install Adobe Acrobat Reader version 8.1.2 from http://www.oldapps
.com/adobe_reader.php?old_adobe=17/. Follow the default prompts to install it.
Click Finish once you’re done. (Here again you may need to download the
file to your host system and copy it to Windows XP’s desktop.)
War-FTP
Next, download and install War-FTP version 1.65 from http://www.exploit-db
.com/exploits/3570/. Download the executable from exploit-db.com to georgia’s
desktop and run the downloaded executable to install. You do not need to
start the FTP service; we will turn it on when we discuss exploit develop-
ment in Chapters 16 through 19.
WinSCP
Download and install the latest version of WinSCP from http://winscp.net/.
Choose the Typical Installation option. You can uncheck the additional
add-ons. Click Finish once you’re done.
Installing Immunity Debugger and Mona
Now we’ll finish up the Windows XP virtual machine by installing a debug-
ger, a tool that helps detect errors in computer programs. We’ll be using
the debugger in the exploit development chapters. Visit the Immunity
Debugger registration page at http://debugger.immunityinc.com/ID_register.py.
Complete the registration and then press the Download button. Run the
installer.
When asked if you want to install Python, click Yes. Accept the license
agreement and follow the default installation prompts. When you close the
installer, the Python installation will automatically run. Use the default
installation values.
Once Immunity Debugger and Python have been installed, download
mona.py from http://redmine.corelan.be/projects/mona/repository/raw/mona.py/.
Copy mona.py to C:\Program Files\Immunity Inc\Immunity Debugger\PyCommands,
as shown in Figure 1-47.
Open Immunity Debugger, and at the command prompt at the bottom
of the window, enter !mona config -set workingfolder c:\logs\%p, as shown in
Figure 1-48. This command tells mona to log its output to C:\logs\, where  is the program Immunity Debugger is cur-
rently debugging.
Now our Windows XP target is set up and ready to go.
46 Chapter 1
Figure 1-47: Installing Mona
Figure 1-48: Setting up Mona’s logs
Setting Up Your Virtual Lab 47
setting up the ubuntu 8.10 target
Because Linux is open source, you can simply download the Linux vir-
tual machine as part of the torrent for this book. Unzip the 7-Zip archive
BookUbuntu.7zip and use the password 1stPentestBook?! to open the archive.
Open the .vmx file in VMware. If you are prompted with a message that
says the virtual machine appears to be in use, click Take Ownership and,
as with Kali, select I copied it. The username and password for the virtual
machine itself are georgia:password.
Once you have the Ubuntu virtual machine loaded, make sure the net-
work interface is set to Bridged in VMware and click the networking icon
(two computers) at the top right of the screen to attach the virtual machine
to the network. Do not install any updates if prompted. As with Windows XP,
we will exploit out-of-date software on this system. Now this virtual machine
is all set up. (I’ll show you how to set a static IP address in Linux in Chapter 2.)
Creating the windows 7 target
As with Windows XP, you’ll need to install a copy of Windows 7 SP1 in
VMware by loading your image or DVD. A 30-day trial version of 32-bit
Windows 7 Professional SP1 will work fine, but you’ll need to activate it after
30 days if you wish to continue using it. To find a legal version of Windows 7
SP1, try one of the following:
• Visit http://www.softpedia.com/get/System/OS-Enhancements/Windows-7.shtml.
• Visit http://technet.microsoft.com/en-us/evalcenter/dn407368.
note Your school or workplace may have access to programs like DreamSpark or BizSpark
that give you access to Windows operating systems. You can also check my website
(http://www.bulbsecurity.com/) for more resources.
Creating a User Account
After installing Windows 7 Professional SP1, opt out of security updates and
create user Georgia Weidman as an administrator with a password of pass-
word, as shown in Figures 1-49 and 1-50.
Again opt out of automatic updates. When prompted, set the comput-
er’s current location to a work network. Once the installation has finished,
log in to the account Georgia Weidman. Leave the Windows Firewall enabled.
VMware will reboot Windows 7 a few times as it installs everything.
Now tell VMware to install VMware Tools, as you did in the Windows XP
section. After instructing VMware to install VMware Tools in the virtual
machine, if the installer does not automatically run, go to My Computer
and run the VMware Tools installer from the virtual machine’s DVD drive,
as shown in Figure 1-51.
48 Chapter 1
Figure 1-49: Setting a username
Figure 1-50: Setting a password for the user Georgia Weidman
Setting Up Your Virtual Lab 49
Figure 1-51: Installing VMware Tools
Opting Out of Automatic Updates
Though our attacks on Windows 7 will largely rely on flaws in third-party
software rather than missing Windows patches, let’s once again opt out of
Windows updates for this virtual machine. To do this, go to Start4Control
Panel4System and Security. Then under Windows Update, click Turn
Automatic Updating On or Off. Set Important updates to Never check for
updates (not recommended) as shown in Figure 1-52. Click OK.
Figure 1-52: Opting out of automatic updates
50 Chapter 1
Setting a Static IP Address
Set a static IP address by choosing Start4Control Panel4Network and
Internet4Network and Sharing Center4Change Adapter Settings4Local
Area Network. Now right-click and choose Properties4Internet Protocol
Version 4 (TCP/IPv4)4Properties. Set these values as you did for Windows
XP (discussed in “Setting a Static IP Address” on page 38), but use a dif-
ferent value for the Windows 7 IP address, as shown in Figure 1-53. If asked
whether to configure this network as Home, Work, or Public, choose Work.
(Be sure that your virtual machine network setting is configured to use a
bridged adapter.)
Figure 1-53: Setting a static IP address
Because the Windows firewall is turned on, Windows 7 won’t respond
to a ping from our Kali system. Therefore, we’ll ping our Kali system
from Windows 7. Start your Kali Linux virtual machine, and from your
Windows 7 virtual machine, click the Start button. Then enter cmd in the
Run dialog to open a Windows command prompt. At the prompt, enter
the following.
ping 
If everything is working, you should see replies to the ping request as in
“Setting a Static IP Address” on page 38.
Setting Up Your Virtual Lab 51
Adding a Second Network Interface
Now shut down your Windows 7 virtual machine. We’re going to add a
second network interface to the Windows 7 virtual machine that will allow
the Windows 7 system to be part of two networks. We’ll use this setup dur-
ing post exploitation to simulate attacking additional systems on a second
network.
In VMware Player on Microsoft Windows, choose Player4Manage4
Virtual Machine Settings4Add, select Network Adapter, and press Next.
This adapter will be Network Adapter 2. In VMware Fusion on Mac OS,
go to Virtual Machine Settings, select Add a Device, and select a network
adapter. Set this new adapter to the Host Only network. Press OK, and the
virtual machine should restart. (We do not need to set a static IP address
for Network Adapter 2.) When the virtual machine restarts, open Virtual
Machine Settings again, and you should see the two network adapters
listed. Both should be connected when your computer powers on.
Installing Additional Software
Now install the following software in your Windows 7 virtual machine,
using default settings across the board:
• Java 7 Update 6, an out-of-date version of Java, from http://www.oldapps
.com/java.php?old_java=8120/.
• Winamp version 5.55 from http://www.oldapps.com/winamp.php?old_
winamp=247/. (Uncheck the changes to your search engine and
so on.)
• The latest version of Mozilla Firefox from http://www.mozilla.org/.
• Microsoft Security Essentials from http://windows.microsoft.com/en-us/
windows/security-essentials-download/. (Download the latest antivirus sig-
natures, making sure to download the correct version for your 32-bit
Windows install. Don’t turn on automatic sample submission or scan on
install. Also, disable real-time protection for now. We will enable this
feature when we study bypassing antivirus software in Chapter 12. This
setting can be found on the Settings tab under Real-time Protection.
Uncheck Turn on real-time protection (recommended), as shown in
Figure 1-54. Click Save changes.)
52 Chapter 1
Figure 1-54: Turning off real-time protection
Finally, install the BookApp custom web application found in the torrent
for this book. (1stPentestBook?! is the password for the archive.) Drag and
drop the BookApp folder on the Windows 7 virtual machine. Then follow
the instructions in InstallApp.pdf detailing how to install BookApp. Here is
a high-level overview of the instructions.
1. Run Step1-install-iis.bat as an administrator by right-clicking the .bat file
and choosing Run as administrator. (Once install finishes, you can close
any DOS windows that are still up.)
2. Navigate to the SQL folder and run SQLEXPRWT_x86_ENU.EXE. Detailed
instructions with screenshots are included in the InstallApp PDF.
3. Install Service Pack 3 by running SQLServer2008SP3-KB2546951-x86-ENU
.exe. When warned that program has known compatibility issues, click
OK to run it and complete the install. Choose to accept any changes.
4. Using SQL Server Configuration Manager, enable Named Pipes.
Setting Up Your Virtual Lab 53
5. Navigate back to the main app folder and run Step2-Modify-FW.bat as an
administrator.
6. Install XML support for MS SQL with sqlxml_x86-v4.exe from the SQL
folder.
7. Run Step3-Install-App.bat as an administrator from the main app folder.
8. Use MS SQL Management Studio to run db.sql from the SQL folder, as
described in detail in the InstallApp PDF.
9. Finally, change the user permissions on the AuthInfo.xml file in the book
app folder to give full permissions to IIS_USERS.
summary
We set up our virtual environment, downloaded and customized Kali Linux
for attacks, configured our virtual network, and configured our target oper-
ating systems—Windows XP, Windows 7, and Ubuntu.
In the next chapter, we will get used to working with the Linux command
line, and we’ll be on our way to learning how to use the many pentesting
tools and techniques in this book.
54 Chapter 1
2
using k ali linux
You will use Kali Linux as the attack platform through-
out this book. Kali, the successor to the popular
BackTrack Linux, is a Debian-based distribution that
comes with a plethora of penetration testing tools
preinstalled and preconfigured. Anyone who’s ever
tried to set up a pentesting box from scratch the day
before a big engagement knows that getting everything working correctly
can be a real pain. Having everything preconfigured in Kali can save a lot
of time and headaches. Kali Linux works just like the standard Debian
GNU/Linux distribution, with a lot of extra tools.
Rather than point and click your way through Kali, you’ll use the Linux
command line because that’s where the real power lies. In this chapter we’ll
look at how to perform some common Linux tasks from the command line.
If you’re already a Linux expert, you can skip this chapter and move on to
Chapter 3; if not, take some time and dive in.
Linux Command Line
The Linux command line looks like this:
root@kali:~#
Like a DOS prompt or the Mac OS terminal, the Linux command
line gives you access to a command processor called Bash that allows you
to control the system by entering text-based instructions. When you open
the command line you’ll see the prompt root@kali#. Root is the superuser