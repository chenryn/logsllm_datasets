220
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
GeneratortoutputVrefsetpointoutputControllerFigure2.Automaticvoltageregulator(AVR).anormalnon-replicatedﬁrewall,thepercentageoffailedtimevariedfromabout90%withmiftof1000hours,to100%withmiftof1hour.ForITCIS,thenumbersweresimilarbutlower:wentfrom70%to100%.ForITCIS-PRandITCIS-PRRwitharecoveryperiodof10minutes,whichistheoneofthecurrentprototype,thepercentageoffailedtimeisalmostzero,forallvaluesofmift.Anotheraspectthatweevaluatedistheoverheadintro-ducedbytheCIS,i.e.,thedelayitintroducesinthecommu-nication(see[5]).Innormalconditions,allinstantiationsoftheCISintroducedadelayfrom0.5msto2ms.Wealsoemulatedwhatwouldhappenunderadenialofserviceat-tackbygeneratingDoStrafﬁcwithiperf.Until70Mbpsoftrafﬁc,thedelayremainedbelow4ms.With100Mbpsthedelayincreasedto14ms.3.APowerGenerationScenarioThescenarioweconsiderisaremotelycontrolledelec-tricitygenerationsystem.Apowersystemhastoregulateseveralvariables,likevoltage,frequency,andactiveandre-activepowers.However,tosimplifythefollowingdiscus-sion,wewillconcentrateonregulatingasinglevariable,thevoltage,andtheobjectiveistomaintainacorrectvoltagedespitecyber-attacks.ProjectCRUTIALpresentedasetofpowercontrolsce-narios[7].Onescenariothatisalreadyinuseinsomecountriescomprisesahierarchicalvoltageregulation.Thesystemissupposedtohaveanationaldimensionanditin-cludesfourmaincomponents:(1)NationalVoltageRegu-lator(NVR):collectsdatafromtheﬁeldanddecideswhicharethevoltagestobeachievedbyeachnodeofthepowergridtoattainaglobaloptimalvoltagepattern.(2)RegionalVoltageRegulator(RVR):deﬁnesthereactivepowerforeachpowerplantinitsregion.(3)ReactivePowerRegulator(PQR):basedonthereactivepowerdeﬁnedbyitsRVR,thePQRdeﬁneswhicharethevoltagelevelsthatmustbegen-eratedbyeachoneofitsautomaticvoltageregulators.(4)AutomaticVoltageRegulator(AVR):automaticcontrollerCommandProtectionDeviceCommandRVRAVRMonitoring DataGeneratorAttkAttackerFigure3.Attacktothepowerregulation.attachedtothegenerator,whichimplementsacontrolruletodrivethegeneratortowardsasetpointdeﬁnedbyitsPQR.Forsimplicity,weconsideronlyoneRVRcontrollingoneAVR(wedisregardtheNVR,andsincethereisasin-gleAVR,wealsoignorethePQR).TheRVRdeﬁnesthevoltagelevelsetpointsandtheAVRdrivesthegeneratortowardsthesesetpoints.Thecontrolledvariableisthegeneratoroutputvoltage.Fig.2detailsthestructureofanAVRandthegenerator,togetherrepresentingaclassicalPI(Proportional-Integral)controlloop.Theinputisthevolt-agesetpointVrefsetbytheRVR.AttackScenarioTheglobalattackscenarioisdepictedinFig.3.TheRVRisinsomeplaceoutsidethepowerplantandaccessestheAVRusinganetworkconnection.ThecommunicationbetweentheRVRandtheAVRconsistses-sentiallyintwokindsofmessages:theRVRsendssetpointcommandstochangetheoutputvoltageofthegenerator,andgetsperiodicmonitoringinformationandvoltagelevelsfromtheAVR.TheLANwheretheAVRislocatedisse-curedfromoutsidethreatsusingaprotectiondevice,whichcanbeeitheratraditionalﬁrewalloroneoftheCISdesigns.Theattackerattemptstodisruptthecorrectbehaviorofthegeneratorbybypassingtheprotectiondevice.Aﬁrstkindofvulnerabilitiesthatconcernusarethosethatallowtheattackertocompromisetheprotectiondeviceitself.Atypicalcaseconsistsinﬁndingabufferoverﬂowvulnerabilityintheprotectiondevice,thenexecutingthatattackgainingaccesstothemachine,andﬁnallymodify-ingitsbehavior(e.g.,switchingofftheprotectionorsend-ingdirectlypacketstothecontroller).Thislaststagecaninvolvedoingaprivilegeescalationattack,butthatisusu-allysimplerthangainingaccesstothemachine.Overtheyearsseveraltypesofremotelyexploitablevulnerabilitieshavebeendiscovered.OneexampleistheSymantecNor-tonFirewallBufferOverﬂow(BugtraqID5237-2002)thatlets“theattackertoexecutecodeillegitimately”intheﬁre-wallcomputer.Anotherkindofvulnerabilitiesthatconcernusarethosethatallowtheattackertobypasstheprotectionmechanism.OneexampleistheFreeBSDIPFWFilteringEvasionVulnerability(BugtraqID2293-2001)that“allowsanattackertopossiblysendillegitimatepacketstoapro-tectedhost”.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
221
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
Ifatsomepointintime,anattackerisabletocommuni-catewiththecontroller,he/shecandooneoftwothings:•Deﬁnetargetsetpointsarbitrarily.•Attackthecontrollerhosttryingtoexplorevulnerabil-itiesinitssoftware.Oncethecontrolleriscompro-mised,theattackercanchangemostofthecontrolpa-rameters(e.g.,Kp,KωfromFig.2)atwill.Inbothcases,theattackercanaffectthecontrollabilityofthegeneratorandpotentiallyprovokesomephysicaldam-ageonitanddisturbthepowergrid.4.TheDemonstrationThedemonstrationusesthescenariodescribedintheprevioussectiontogiveevidenceoftheexpectedresilienceoffourprotectiondevicesthatcanbedeployedoncriticalinfrastructures:traditionalﬁrewallandthe3CISversions.ThesetupofthedemonstrationisdepictedinFig.4.Itinvolves7computersand2switches/hubs.Thecomputersrepresentthefollowingentities:anemulatoroftheRVRandtheattacker(1computereach),atraditionalﬁrewallortheCIS(1to4computers),andanemulatoroftheAVRandgenerator(1computer).Thedisplaysfromvarioussoft-wareapplicationsareusedtoshowthevoltagelevelsde-ﬁnedandperceivedbytheRVR,theoutputvoltageoftheAVR/generator,andtheinternalstateoftheprotectionde-vice(e.g.,intrusioninreplicaIIandreplicaIVrecovering).Thedemonstrationhasfourphases,eachoneforadiffer-entprotectiondevice.Everyphaseillustratesbasicallytwothings:(a)thedeviceeffectivelyprotectingtheAVR;(b)anexampleofhowtheprotectiondevicecanfailandhowthisaffectstheAVR.TraditionalﬁrewallIntheﬁrstphase,theprotectionde-viceisaﬁrewall.Firsttheattackerconsole(bottomleftofFig.4)isusedtoemulatetheattackerissuingsomemali-ciouscommands,buttheﬁrewalldropsthesepacketsbe-causetheydonotsatisfytheaccesscontrolpolicyoftheinfrastructure,asexpressedbytheﬁrewallrules.TheinputvoltageleveloftheemulatoroftheAVR/generator(righthandsideofFig.4)isnotaffectedandtheoutputvoltagestaysstable.Then,weexplainhowtheﬁrewallcanfailduetoavulnerability(basicallythediscussionmadeinSection3),andhowthismightallowtheattackertoexecutecom-mandsthataffecttheAVR,suchasdeﬁningadangerousvoltagesetpoint.Forthispurpose,thetwoabovementionedvulnerabilities(BugtraqID5237-2002and2293-2001)areexplainedandanattackerthatperformstheseattacksisem-ulated,oncemoreusingtheattackerconsole.InbothcasestheattackerendsupbeingabletosendpacketstotheAVRandweshowhowhe/sheisabletomodifythevoltagelevelintheemulatoroftheAVR/generator.MonitorRVRProtection VIa display that shows the internal state of the protection devicethe display shows thevoltage level definedby the RVRswitchswitchAVR / generatorAttackerAttackerthe buttons allow the Protection device (firewall or CIS)1 to 4 computersgthe display shows the output voltageattacker to perform different attacksFigure4.Thesetupofthedemonstration,in-cludingsomeexampledisplays.ITCISInthesecondphase,theprotectiondeviceisanITCISwith3replicas(tolerates1intrusion,i.e.,1faultyreplica).First,weillustratetheapplicationworkingnor-mallylikebefore(stableinputandoutputvoltageevenifattackerssendcommandsthatarediscardedbytheCIS).Next,weusetheattackerconsoletoemulateanintrusioninoneofthereplicas,thenusethispositiontosendcommandstotheAVR.ThedemonstrationshowsthattheAVRdoesnotacceptthesecommandsbecausethefaultyCISreplicaisunabletosignthemessagewithavalidMAC(itdoesnothaveaccesstothesecretkeyK).Finally,weemulateasuccessfulattacktoanotherCISreplica,showingthatthecontrolofamajorityofreplicasallowstheattackertopro-ducevalidMACs,thussendcontrolcommandstotheAVRandsetupthevoltagelevelshe/shewants.ITCIS-PRInthethirdphase,theprotectiondeviceisaITCIS-PRwithfourreplicas.Thisconﬁgurationsustainsoneintrusionevery10minutes,andtoensuretheavailabil-ityoftheCIS,atmostonereplicacanberejuvenatedateachmoment.Theintervalof10minutescomesfromthetimeneededtorecoverareplica,whichis2.5minutesinourprototype(withSATAdisksand1.7GByteLinuxsys-temimages).Thiswindowofvulnerabilitycouldbere-ducedsubstantiallywithamoreoptimizedsetup,forexam-ple,withsolidstatedisksandsmallersystemimages(lessthan500MBytes).Inthisphase,weshowthattheITCIS-PRpreventstheadversaryfromcontrollingtheAVR,evenifhe/sheman-agestocompromisetworeplicas,aslongastheintrusionshappenindifferentrejuvenationintervals(i.e.,atmostev-ery10minutes).TheattacksareperformedidenticallyasforITCIS.Thedisplaywiththeinternalstateofthepro-tectiondevice(toprightofFig.4)isquiteusefulforthisdemonstrationbecauseitallowsustowatchwhenreplicasarerecoveringorhaveintrusions.Thisphaseﬁnisheswithafaultyreplicaexecutingavulnerabilityscanagainstthe978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
222
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
AVRbetweenrecoveries(oncemorethisrequestisissuedintheattacker’sconsole).ITCIS-PRRThefourthphaseusestheITCIS-PRR,whichissimilartotheITCIS-PR,buttheCISreplicasalsomonitoreachotherbehaviorandforceareactiverecoverywhenareplicasendserroneouspackets.ThedemonstrationissimilartotheoneofITCIS-PRbutalsoshowsthatwhenafaultyreplicastartstoperformanetworkscan,itisal-mostimmediatelyforcedtorejuvenate,sothenetworkscanattackstopsalmostafteritstarts.5.ConclusionsandDiscussionThedemonstrationdescribedinthispaperillustratesthekindsofattacksthatcancompromisepowersystemfacil-itiesprotectedbytraditionalﬁrewalls,andpresentsafam-ilyofmechanismsthatcanbeemployedtomakeaprotec-tiondeviceincrementallymoreresilient(ITCIS,ITCIS-PR,ITCIS-PRR).Furthermore,itshowsthattheCISisadevicethatoffersamorecompleteandsecureprotectionforcriticalsystemsthanﬁrewalls.Withthemostresilientoftheself-healingintrusion-tolerantdevices–ITCIS-PRR–inplace,theattackerisseriouslyconstrained.Afterconsiderableef-fort,he/shemayeventuallybeabletocompromiseoneofthereplicas,butthisreplicawouldsoonberejuvenated,andifinthemeantimehe/shetriestoattacktheprotectedinfras-tructure,thereplicawouldberecoveredimmediately.Interestingquestionsarethecost,challengesandprac-ticalityofadoptingtheCISinarealcriticalinfrastructure.Inarealenvironment,aCISshouldbeplacedinthesamelocationsasﬁrewalls[11,14],i.e.,atleastinnetworkinter-connections(e.g.,intheinterconnectionbetweenasubsta-tionandtheutilitynetwork).Therefore,addingaCIStoaCIisaspracticalasputtingaﬁrewall.Themainchallengeisalsosimilar:deﬁningaccesscontrolpoliciesthateffectivelyprotecttheCI.ThecostofindividualCISisclearlyhigherthanthecostofoneﬁrewallduetotheneedofreplication.However,thesystemdesignersoradministratorscanchoosebetweendoingthereplicationwithphysicalmachinesorin-sideasinglemachineusingvirtualization(butloosingtheabilitytotoleratehardwarefaults)[2,3].Nevertheless,pro-tectingaCIisnotaluxurybutaneed,anditscosthastobebalancedwiththeimpactthatasecuritycompromisemighthavetosociety(e.g.,havingageneratordestroyedorablackoutinacertainregion).References[1]S.M.Bellovin.Distributedﬁrewalls.;login:,Nov.1999.[2]A.N.Bessani,P.Sousa,M.Correia,N.F.Neves,andP.Verissimo.Intrusion-tolerantprotectionforcriticalinfras-tructures.DI/FCULTR07–8,DepartmentofInformatics,UniversityofLisbon,April2007.[3]A.N.Bessani,P.Sousa,M.Correia,N.F.Neves,andP.Verissimo.TheCRUTIALwayofcriticalinfrastruc-tureprotection.IEEESecurity&Privacy,pages44–51,Nov./Dec.2008.[4]G.Devarajan.UnravelingSCADAprotocols:UsingSulleyfuzzer.presentationatDEFCON-15,Aug.2007.[5]S.Donatellietal.Experimentalvalidationofarchitecturalsolutions.ProjectCRUTIALECIST-FP6-STREP027513DeliverableD20,Mar.2009.[6]D.Dzung,M.Naedele,T.P.V.Hoff,andM.Crevatin.Se-curityforindustrialcommunicationsystems.ProceedingsoftheIEEE,93(6):1152–1177,June2005.[7]F.Garroneetal.Analysisofnewcontrolapplications.ProjectCRUTIALECIST-FP6-STREP027513DeliverableD2,Jan.2007.[8]V.M.Igure,S.A.Laughter,andR.D.Williams.SecurityissuesinSCADAnetworks.Computers&Security,25:498–506,2006.[9]A.E.Kalam,Y.Deswarte,A.Baina,andM.Kaaniche.Ac-cesscontrolforcollaborativesystems:Awebservicesbasedapproach.InProceedingsoftheIEEEInternationalConfer-enceonWebServices,pages1064–1071,2007.[10]S.Kamara,S.Fahmy,E.Schultz,F.Kerschbaum,andM.Frantzen.AnalysisofvulnerabilitiesinInternetﬁrewalls.ComputersandSecurity,22(3):214–232,Apr.2003.[11]President’sCriticalInfrastructureProtectionBoardandOf-ﬁceofEnergyAssuranceU.S.DepartmentofEnergy.21StepstoImproveCyberSecurityofSCADANetworks.U.S.DepartmentofEnergy,2002.[12]R.Schainker,J.Douglas,andT.Kropp.Electricutilityre-sponsestogridsecurityissues.IEEEPower&EnergyMag-azine,Mar./Apr.2006.[13]P.Sousa,A.N.Bessani,M.Correia,N.F.Neves,andP.Verissimo.Resilientintrusiontolerancethroughproac-tiveandreactiverecovery.InProceedingsofthe13thIEEEPaciﬁcRimDependableComputingConference,pages373–380,Dec.2007.[14]K.Stouffer,J.Falco,andK.Kent.Guidetosupervisorycontrolanddataacquisition(SCADA)andindustrialcontrolsystemssecurity.RecommendationsoftheNationalInstituteofStandardsandTechnology.SpecialPublication800-82,NIST,Sept.2006.InitialPublicDraft.[15]P.Verissimo.Travellingthroughwormholes:Anewlookatdistributedsystemsmodels.SIGACTNews,37(1):66–81,2006.[16]P.Verissimo,A.N.Bessani,M.Correia,N.F.Neves,andP.Sousa.Designingmodularandredundantcyberarchitec-turesforprocesscontrol:Lessonslearned.InProceedingsofthe42ndAnnualHawaiiInternationalConferenceonSys-temSciences,Jan.2009.[17]P.Verissimo,N.F.Neves,andM.Correia.TheCRUTIALreferencecriticalinformationinfrastructurearchitecture:ablueprint.InternationalJournalofSystemofSystemsEngi-neering,1(1/2):78–95,2008.[18]J.Xu,Z.Kalbarczyk,andR.K.Iyer.Transparentruntimerandomizationforsecurity.InProceedingsofthe22ndIEEESymposiumonReliableDistributedSystems,pages260–269,Oct.2003.