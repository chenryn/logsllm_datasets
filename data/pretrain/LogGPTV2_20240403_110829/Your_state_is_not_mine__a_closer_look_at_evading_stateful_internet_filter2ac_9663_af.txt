VPNs [30, 33]. They include DPI, IP address blocking, bandwidth
throttling, etc. In November 2016, we set up an openvpn server in
China, and used one node in America as a client. As per our experi-
mental results, a preliminary version of INTANG helped openvpn
over TCP evade censorship, while openvpn without INTANG was
disconnected due to the client receiving a reset packet from the
GFW during the handshake phase (the GFW seemingly used DPI).
Unfortunately, we could not replay such experiments recently via
either the PPTP protocol or with the openvpn protocol. Both proto-
cols did not experience disconnections because of the GFW, nor did
they suffer from rate limits imposed by the GFW. Unfortunately,
we do not yet know what caused this change in behavior and we
plan to continue monitoring the potential opportunity of applying
INTANG to improve VPN stability.
8 DISCUSSION
GFW Countermeasures. Our work is based on the latest devel-
opments of the GFW. It is certainly possible that GFW may undergo
additional improvements to defeat our evasion strategies, and we
acknowledge that it is an arms race. For instance, we demonstrate
that GFW is more liberal in accepting RST packets than normal
servers. It is possible that the censor may perform additional checks
on the RST packets (e.g., checksum and MD5 option fields) as a de-
fense. But that may open up a new evasion attack on the GFW (e.g.,
when the server does not check MD5 option fields). One can also
leverage GFW’s agnostic nature to network topology. For example,
we can measure the exact TTL value to bypass the GFW while
not to reach the server (although it is also a challenge to achieve
accuracy and efficiency simultaneously).
Another potential improvement the GFW can make is to trust
the data packet sent by the client only after seeing the server’s ACK
packet acknowledging the appropriate sequence number. However,
this will greatly complicates the GFW’s design and implementation.
In summary, we believe this is an arms race. As GFW evolves,
so can the evasion strategies. We believe that the cost of rolling
out new GFW models is quite high and such evolution will happen
at the timescale of months (if not years), which leaves enough
time for evasion strategy development (especially when tools like
INTANG are leveraged). For instance, as soon as the GFW evolves,
a new GFW model will be derived and subjected to the “ignore
path” analysis, which can lead to the generation of new evasion
strategies.
Complexity and (sometimes) inconsistency of the GFW. Dur-
ing our long-term study of the GFW since 2015, we have observed
that type-1 and type-2 resets sometimes occur individually. For
example, on certain days, from a vantage point in CERNET Beijing
we could observe only type-1 resets, while on other days, both types
were seen. Our observations indicate that the two types of GFW
devices are usually deployed together, and sometimes one is down.
Also, we found there were some rather intricate effects when the
two types were working together. During a measurement in May
2016, we found the type-1 GFW devices also have a subsequent
90-second blocking period (which it normally does not) as the type-
2 devices does, after we using our new strategy to evade type-2
devices. And when we used no strategies, only the type-2 reset can
be observed (i.e., type-1 devices are not enforcing the 90-second
blocking period). It looked like the type-2 reset suppressed type-1
reset. This rare behavior is not observed during other measure-
ments. Furthermore, in May 2016 and May 2017, we have observed
that RST packets sometimes were unable to tear down the TCB
on the GFW, with different pairs of controlled clients and servers.
This inconsistent behavior could be due to load balancing among
different versions of the GFW, or some intricate effects caused by
several GFW devices deployed together. However, we have no way
to obtain the ground truth. We acknowledge our measurements
are largely limited by being agnostic to the interference among
different versions of GFW devices (or even middleboxes) and to the
way how they are deployed, in addition to the blackbox nature of
the GFW device itself. We are interested in further exploring this
complexity and inconsistency in our future work.
Combination of Strategies. The GFW is heterogeneous with
different co-existing versions. As a result, as we did in this paper, it
is necessary to combine strategies that are effective against different
versions of the GFW. This is normally not an issue as long as the
strategies are not in conflict with each other. However, it is likely
that the “Failure 1” rate will increase when a plurality of strategies
are employed. This is because of the increase in insertion packets,
which increases the likelihood of middlebox interference or side-
effects on the server.
Ethical Considerations. All our experiments are carefully de-
signed so as to not cause disruption to normal network operations.
All connections are established from machines that we rent or con-
trol directly. The additional insertion packets are simply regular
TCP packets (sometimes with incorrect field values) and may sim-
ply be discarded by the server. We control the traffic to each website
to be low to avoid any unintended denial-of-service.
Note that INTANG doesn’t guarentee unobservability for all its
strategies. It is the user’s discretion as to whether to use INTANG
within the censor’s jurisdiction. However, in China, due to heavy
censorship [16], “crossing the wall” and accessing websites such
as Google, Facebook, etc. has become a prevalent need. The censor
usually punishes those who provide censorship circumvention ser-
vices to the masses (e.g., proxy/VPN providers) instead of punishing
the users of the service. A client-side only tool like INTANG will
be harder for the censor to trace and thwart.
9 RELATED WORK
We have already alluded to various related efforts throughout the
paper (especially in § 2). They all focus on evaluating the censor-
ship techniques or anti-censorship techniques aided by additional
facilities, like VPN.
Clayton et al., propose to ignore the RST packets sent by the
GFW [10]. This requires cooperation from the server-side, and is
thus impractical (all servers will need to install a patch to do that).
It does not prevent the censor from monitoring user traffic. Thus,
we do not explicitly consider this in our work. As discussed earlier,
IMC ’17, November 1–3, 2017, London, UK
Ptacek et al. [23], develop a deep understanding of the vulnera-
bilities of current NIDS, which has largely influenced later efforts
(including ours) on TCP reset attack evasion. The West Chamber
Project [25] is a censorship-circumvention tool that implemented
the Ptacek et al.’s theory. However, it just uses two kinds of crafted
packets to teardown the TCB on the GFW from both directions,
and has now become ineffective.
Khattak et al.’s research [17] is the most relevant work to ours.
Their strategies, and the problems thereof were already discussed
in § 3. In addition, our measurement utilizes multiple vantage points
instead of one vantage point as in [17]. Our measurement study
leads to the discovery of the differences in deployment and features
of the GFW from what was presented in that work. Li et al. [18]
tested known TCP/IP insertion packets against censorship firewalls
and DPI boxes in three countries and evaluated their effectiveness.
In contrast, our work focuses on understanding and uncovering
the latest development (new state machine) of the largest and most
complex censorship system, which allows us to devise new evasion
strategies.
10 CONCLUSION
In this paper we undertake, arguably, the most in depth measure-
ment study of stateful (TCP-level) Internet censorship evasion on
the GFW of China. Our work is divided into multiple stages. First,
we perform extensive measurements of prior approaches and find
that they are no longer effective. We attribute the reasons for this to
two primary causes: (a) the GFW has evolved to imbibe new behav-
iors and, (b) the presence of middleboxes on the path between the
client and the server that can interfere with the evasion strategies.
Second, based on the knowledge gained, we hypothesize about
new GFW behaviors and design new strategies that can possibly
evade GFW today. We also build a novel, measurement driven tool
INTANG that can converge on the right evasion strategy for a given
client server pair. In the final stage, we perform extensive measure-
ments of our new strategies and INTANG, and demonstrate that
they provide near-to-perfect evasion rates when combined, thereby
validating our new understanding of the GFW’s stateful censorship
model of today.
ACKNOWLEDGMENTS
This work was supported by Army Research Office under Grant
No. 62954CSREP and the National Science Foundation under Grant
No. 1464410, 1652954, and 1652954. We thank our shepherd Prof.
Alan Mislove and the anonymous reviewers for their constructive
comments towards improving the paper.
REFERENCES
[1] Giuseppe Aceto and Antonio Pescapé. 2015. Internet Censorship detection: A
survey. Computer Networks 83, C, 381–421. https://doi.org/10.1016/j.comnet.2015.
03.008
[2] Daniel Anderson. 2012. Splinternet Behind the Great Firewall of China. Queue
10, 11, Article 40, 10 pages. https://doi.org/10.1145/2390756.2405036
[3] Anonymous. 2009. Evaluation and Problems of Intrusion Detection System. (2009).
Retrieved August 7, 2017 from http://www.chinagfw.org/2009/09/gfw_21.html
[4] Anonymous. 2012. The Collateral Damage of Internet Censorship by DNS
Injection. ACM SIGCOMM Computer Communication Review 42, 3, 21–27.
https://doi.org/10.1145/2317307.2317311
[5] Anonymous. 2014. Towards a Comprehensive Picture of the Great Firewall’s
DNS Censorship. In 4th USENIX Workshop on Free and Open Communications on
IMC ’17, November 1–3, 2017, London, UK
Zhongjie Wang et al.
the Internet (FOCI ’14). USENIX Association, San Diego, CA. https://www.usenix.
org/conference/foci14/workshop-program/presentation/anonymous
[6] Pablo Neira Ayuso. [n. d.]. Netfilter Queue Project. ([n. d.]). Retrieved August 7,
2017 from http://www.netfilter.org/projects/libnetfilter_queue/
[7] Yue Cao, Zhiyun Qian, Zhongjie Wang, Tuan Dao, Srikanth V. Krishnamurthy,
and Lisa M. Marvel. 2016. Off-Path TCP Exploits: Global Rate Limit Consid-
ered Dangerous. In 25th USENIX Security Symposium (USENIX Security 16).
USENIX Association, Austin, TX, 209–225. https://www.usenix.org/conference/
usenixsecurity16/technical-sessions/presentation/cao
[8] Qi Alfred Chen, Zhiyun Qian, Yunhan Jack Jia, Yuru Shao, and Zhuoqing Morley
Mao. 2015. Static Detection of Packet Injection Vulnerabilities: A Case for Identi-
fying Attacker-controlled Implicit Information Leaks. In Proceedings of the 22Nd
ACM SIGSAC Conference on Computer and Communications Security (CCS ’15).
ACM, New York, NY, USA, 388–400. https://doi.org/10.1145/2810103.2813643
[9] Vitaly Chipounov, Volodymyr Kuznetsov, and George Candea. 2012. The S2E Plat-
form: Design, Implementation, and Applications. ACM Transactions on Computer
Systems (TOCS) 30, 1, Article 2, 49 pages. https://doi.org/10.1145/2110356.2110358
[10] Richard Clayton, Steven J. Murdoch, and Robert N. M. Watson. 2006. Ignoring
the Great Firewall of China. In Proceedings of the 6th International Conference on
Privacy Enhancing Technologies (PET ’06). Springer-Verlag, Berlin, Heidelberg,
20–35. https://doi.org/10.1007/11957454_2
[11] Jedidiah R. Crandall, Daniel Zinn, Michael Byrd, Earl Barr, and Rich East. 2007.
ConceptDoppler: A Weather Tracker for Internet Censorship. In Proceedings of
the 14th ACM Conference on Computer and Communications Security (CCS ’07).
ACM, New York, NY, USA, 352–365. https://doi.org/10.1145/1315245.1315290
[12] Haixin Duan, Nicholas Weaver, Zongxu Zhao, Meng Hu, Jinjin Liang, Jian Jiang,
Kang Li, and Vern Paxson. 2012. Hold-on: Protecting against on-path DNS
poisoning. In Workshop on Securing and Trusting Internet Names (SATIN).
[13] Roya Ensafi, David Fifield, Philipp Winter, Nick Feamster, Nicholas Weaver, and
Vern Paxson. 2015. Examining How the Great Firewall Discovers Hidden Circum-
vention Servers. In Proceedings of the 2015 Internet Measurement Conference (IMC
’15). ACM, New York, NY, USA, 445–458. https://doi.org/10.1145/2815675.2815690
[14] Phillipa Gill, Masashi Crete-Nishihata, Jakub Dalek, Sharon Goldberg, Adam
Senft, and Greg Wiseman. 2015. Characterizing Web Censorship Worldwide:
Another Look at the OpenNet Initiative Data. ACM Transactions on the Web
(TWEB) 9, 1, Article 4, 29 pages. https://doi.org/10.1145/2700339
[15] Andy Heffernan. 1998. Protection of BGP Sessions via the TCP MD5 Signature
Option. RFC 2385. https://tools.ietf.org/html/rfc2385
[16] OpenNet Initiative. 2012. China | ONI Country Profile. (2012). Retrieved August
7, 2017 from https://opennet.net/research/profiles/china
[17] Sheharbano Khattak, Mobin Javed, Philip D. Anderson, and Vern Paxson. 2013.
Towards Illuminating a Censorship Monitor’s Model to Facilitate Evasion. In
Presented as part of the 3rd USENIX Workshop on Free and Open Communications
on the Internet (FOCI ’13). USENIX, Washington, D.C. https://www.usenix.org/
conference/foci13/workshop-program/presentation/Khattak
[18] Fangfan Li, Abbas Razaghpanah, Arash Molavi Kakhki, Arian Akhavan Niaki,
David Choffnes, Phillipa Gill, and Alan Mislove. 2017. lib•erate,(n): A library for
exposing (traffic-classification) rules and avoiding them efficiently. In Proceedings
of the 2017 Internet Measurement Conference (IMC ’17). ACM, London, UK. https:
//doi.org/10.1145/3131365.3131376
[19] Graham Lowe, Patrick Winters, and Michael L Marcus. 2007. The Great DNS Wall
of China. Technical Report. https://censorbib.nymity.ch/pdf/Lowe2007a.pdf
[20] Jong Chun Park and Jedidiah R. Crandall. 2010. Empirical Study of a National-
Scale Distributed Intrusion Detection System: Backbone-Level Filtering of HTML
Responses in China. In Proceedings of the 2010 IEEE 30th International Conference
on Distributed Computing Systems (ICDCS ’10). IEEE Computer Society, Washing-
ton, DC, USA, 315–326. https://doi.org/10.1109/ICDCS.2010.46
[21] Jon Postel. 1981. Transmission Control Protocol. RFC 793. https://tools.ietf.org/
[22] The Tor Project. [n. d.]. The Tor Project. ([n. d.]). Retrieved August 7, 2017 from
html/rfc793
https://www.torproject.org
[23] Thomas H. Ptacek and Timothy N. Newsham. 1998.
Insertion, Envasion, and
Denial of Service: Eluding Network Intrusion Detection. Technical Report. http:
//www.icir.org/vern/Ptacek-Newsham-Evasion-98.ps
[24] Redis. [n. d.]. The Redis Project.
([n. d.]). Retrieved August 7, 2017 from
http://redis.io/
[25] scholarzhang. 2010. West Chamber Project. (2010). Retrieved August 7, 2017
from https://code.google.com/p/scholarzhang/
[26] Zain Shamsi, Ankur Nandwani, Derek Leonard, and Dmitri Loguinov. 2014. Her-
shel: Single-packet Os Fingerprinting. In The 2014 ACM International Conference
on Measurement and Modeling of Computer Systems (SIGMETRICS ’14). ACM, New
York, NY, USA, 195–206. https://doi.org/10.1145/2591971.2591972
[27] Michael Carl Tschantz, Sadia Afroz, David Fifield, and Vern Paxson. 2016. SoK:
Towards Grounding Censorship Circumvention in Empiricism. In 2016 IEEE
Symposium on Security and Privacy (SP). 914–933. https://doi.org/10.1109/SP.2016.
59
[28] twilde. 2012.
[29] John-Paul Verkamp and Minaxi Gupta. 2012.
Knock Knock Knockin’ on Bridges’ Doors.
2012).
knock-knock-knockin-bridges-doors
(January
Retrieved August 7, 2017 from https://blog.torproject.org/blog/
Inferring Mechanics of Web
Censorship Around the World. In Presented as part of the 2nd USENIX Work-
shop on Free and Open Communications on the Internet (FOCI ’12). USENIX,
Bellevue, WA. https://www.usenix.org/conference/foci12/workshop-program/
presentation/Verkamp
[30] VPNanswers.com. 2015. Bypass The Great Firewall And Hide Your OpenVPN
In China. (2015). Retrieved August 7, 2017 from https://www.vpnanswers.com/
bypass-great-firewall-hide-openvpn-in-china-2015/
[31] Philipp Winter and Stefan Lindskog. 2012. How the Great Firewall of China
is Blocking Tor. In Presented as part of the 2nd USENIX Workshop on Free and
Open Communications on the Internet (FOCI ’12). USENIX, Bellevue, WA. https:
//www.usenix.org/conference/foci12/workshop-program/presentation/Winter
[32] Eric Wustrow, Scott Wolchok, Ian Goldberg, and J. Alex Halderman. 2011. Telex:
Anticensorship in the Network Infrastructure. In Proceedings of the 20th USENIX
Conference on Security (SEC ’11). USENIX Association, Berkeley, CA, USA, 30–30.
http://dl.acm.org/citation.cfm?id=2028067.2028097
[33] Eva Xiao. 2016. Behind The Scenes: Here’s Why Your VPN Is Done In
(2016). Retrieved August 7, 2017 from http://technode.com/2016/03/
China.
17/behind-scenes-heres-vpn/
[34] Xueyang Xu, Z. Morley Mao, and J. Alex Halderman. 2011. Internet Censorship in
China: Where Does the Filtering Occur?. In Proceedings of the 12th International
Conference on Passive and Active Measurement (PAM ’11). Springer-Verlag, Berlin,
Heidelberg, 133–142. http://dl.acm.org/citation.cfm?id=1987510.1987524