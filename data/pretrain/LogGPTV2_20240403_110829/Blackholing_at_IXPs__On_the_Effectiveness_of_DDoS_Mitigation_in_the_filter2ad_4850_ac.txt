13
1.3
]
0
1
g
o
l
[
d
n
o
c
e
s
r
e
p
t
i
b
m
Dec 15
Jan 01
Jan 15
date
Feb 01
Feb 15
Mar 01
6:15
6:30
6:42
time
6:56
7:15
mbits
max mbits
blackholing traffic
regular traffic
(a) Blackholed trafﬁc for 3 month period.
(b) Trafﬁc volumes for Case Study I.
Fig. 5. Traﬃc volumes over time.
Case Study I: Fig. 5(b) is an example where the blackholed preﬁxes are in the
range /19 – /29. This AS (AS k in Figs. 3(b) and 4(a)) announced 415 preﬁxes for
blackholing — all at the same time. Overall, the blackhole was active for roughly
10 min (dashed vertical line). Figure 5(b) shows the traﬃc volume as received by
the AS for all these blackholed preﬁxes for 60 minutes, namely, ∼30 min before
the ﬁrst blackhole announcement, during the blackhole, and ∼20 min afterwards.
In addition, we show the traﬃc for the same preﬁxes that is discarded, as well
as the times when the blackhole announcements are made (vertical line). Right
after the blackhole is announced the traﬃc that the AS receives drops by roughly
a factor of 100. The blackholed traﬃc (dotted lines) is smaller than the “missing”
traﬃc due to the reasons mentioned above. After the blackhole is deactivated
the traﬃc volume rises to a level that is close to the previous one. The diﬀerence
is roughly 300 Mbit/s. We also conclude that the objective of the blackhole was
achieved as there were no further blackhole announcements for these preﬁxes by
this AS.
One could expect that the amount of traﬃc that is blackholed is the same
as the reduction of the regular traﬃc. This is not the case and explanations are:
(i) Depending on the BGP router conﬁguration, it cannot be guaranteed that a
particular peer accepts more speciﬁc preﬁxes than /24. (ii) The AS under attack
may take other corrective actions besides blackholing at IXPs. For instance,
blackholing at upstreams, moving traﬃc from peering to transit, or activating
DDoS traﬃc ﬁltering services (e.g., CloudFlare or Prolexic). (iii) If the black-
holed traﬃc contains a large fraction of TCP traﬃc and these TCP connections
are broken by the blackhole, this can reduce the data traﬃc drastically.
Case Study II: Fig. 6(a) shows the same data but for another AS for a six day
period from 26th of July 2015 onwards. We picked this case study as it involved
substantial amounts of traﬃc, an interesting application (port) mix, and a single
IP — a /32 preﬁx (to bh/32 and to /32 legend in Fig. 6(a)). In addition, the plot
328
C. Dietzel et al.
contains the traﬃc to the covering /16 preﬁx (to /16) as well as the overall traﬃc
for this AS (to AS).
g
v
a
y
l
r
u
o
h
n
o
d
n
o
c
e
s
r
e
p
t
i
b
m
15000
10000
5000
0
Jul 26
Jul 27
Jul 28
Jul 29
date
Jul 30
Jul 31
Aug 01
to bh /32
to AS
to /32
to /16
(a) Trafﬁc over time for different subsets.
(b) Distribution of dst ports over time.
Fig. 6. Traﬃc and port mix for Case Study II.
Notice the radical increase in traﬃc shortly before the blackhole announce-
ment. The traﬃc to the AS spikes from roughly 6 Gbit/s to 17.6 for an AS with
an aggregated port capacity of 20 Gbit/s. The plot highlights that the root cause
is in the non-blackholed /16 and in particular in the /32 that is then blackholed.
The blackhole announcement for this /32 is highly eﬀective as the regular traﬃc
for the IP as well as for the /16 and the AS drops signiﬁcantly immediately after
the announcement. Note, that we can still see traﬃc to the /32 because not nec-
essarily all peers accept more speciﬁc announcements than /24. We also notice
the peak in the blackholed traﬃc for the /32, which increases to 3.2 Gbit/s.
Thus, the blackhole reduces the traﬃc to the AS and the preﬁxes by about one
third. Over the next days the traﬃc to the IP gradually decreases while the non-
blackholed traﬃc to the /16 and /32 shows clear daily patterns. We captured
several updates for the blackholed preﬁx. The blackhole is not revoked, but just
updated with diﬀerent communities which are not honored by the IXP’s route
server.
To understand why the blackhole is eﬀective, we plot in Fig. 6(b) the relative
transport TCP/UDP port distribution for the traﬃc to the AS. Over the whole
period port 80 (http), 1194 (OpenVPN), 443 (https), 5055, 6969 (BitTorrent)
are the most prominent ports. Accordingly, the plot is a stacked barplot with
these ports and other ports at the bottom.
Initially, the traﬃc share of http is ∼ 30 %. But with the blackhole trigger
event the OpenVPN traﬃc drastically increases. Indeed, it constitutes about
50 % of all traﬃc to this AS. As time passes and the blackhole takes eﬀect the port
mix slowly converges to the initial distribution. The dominance of OpenVPN is
also reﬂected in the blackholed traﬃc for the blackholed IP. 99.9 % of the traﬃc
Blackholing at IXPs: On the Eﬀectiveness of DDoS Mitigation in the Wild
329
is UDP and involves port 1194. Thus, this change of ports is also reﬂected in the
distribution of transport protocols.
We ﬁnd that blackholing is eﬀective in numerous situations. However, the
observed volumes of traﬃc depend on numerous factors, e.g., preﬁx length,
announcement duration, general traﬃc utilization, attack pattern, and/or pol-
icy control settings. We also highlight that the traﬃc mix can vary signiﬁcantly
between non-blackholed and blackholed traﬃc.
6 Related Work
While this work focuses on blackholing, a network-based reactive measure to
diminish massive DDoS attacks in the core of the Internet, this section summa-
rizes other reactive DDoS defense mechanisms and highlights other measurement
studies.
Source-based defense techniques are deployed near the source of an attack
and aim to impede service of intermediate and destination networks. Common
mechanisms are IP source address ﬁltering and heuristics on ingress/egress traﬃc
ﬂows [1,10,22].
Alternatively, destination-based DDoS mitigation attempts to combat
attacks near the victim-end of the Internet. Common places for their deploy-
ment are edge routers or access routers of the destined AS. Proposed mecha-
nisms include adaptive rate limiting [16,21], network reconﬁguration [3,4,35],
and traceback [2,34]. Additionally, a multitude of ﬁltering techniques such as
time-based [14], history-based [29], and hop count-based [17] have been intro-
duced.
Whereas source-based DDoS defense often suﬀers from its limited scope
and the lack of a representative fraction of the attack traﬃc to be eﬃcient,
destination-based approaches come in too late on the path through the Inter-
net. Thus, they jeopardize the destination AS or even intermediate networks.
Network-based approaches seek to overcome these drawbacks and are deployed
inside intermediate networks. They mainly incorporate distributed or trust-based
detection and already presented reconﬁguration or ﬁltering mechanisms, e.g.,
[11,24,28].
Despite the large body of available approaches, eﬀective reactive techniques
that are deployed in practice are rare. Thus, there is a demand for defense
techniques which are eﬃcient, easy and quick to apply, and which ensure the
continuing availability of the services, system, or network. However, none of the
mentioned taxonomies for DDoS defense techniques [18,23,37] takes blackholing
into consideration.
Although blackholing has not been examined to date, other recent mea-
surement studies focus on attack ampliﬁcation potential [7,20,32,33,38] and on
progress towards diminishing their impact [19].
330
C. Dietzel et al.
7 Summary and Future Work
In this paper, we perform a ﬁrst study on the usage of blackholing at an IXP in
the wild. We ﬁnd that not only is blackholing frequently used with about 23, 000
announced blackholes over our measured period of 3 months, but also that they
have a considerable preﬁx size — up to /18. While short-lived blackholes are
prevalent, we also spot others that lasted for months. Moreover, we observe an
apparently stable number of active blackholing announcements (about 1200).
The frequent usage of blackholing on the control plane correlates with signif-
icant amounts of blackholed traﬃc on the data plane. Using two case studies we
show that blackholing successfully reduces the amount of traﬃc. This empha-
sises that blackholing at IXPs can be a very useful tool to diminish massive
DDoS attacks. Indeed, our analysis of the application (port) mix of one of the
blackhole incidents indicates that blackholing is successful in reducing unusual
OpenVPN traﬃc, likely a DDoS attack.
In general, IXPs are great locations for countering DDoS attacks via black-
holing, as the IXP infrastructure is a multiplication factor. Still, blackholing is
a relatively new feature and there is room for increased eﬃcacy, e.g., eﬀective
monitoring and reporting, partially retracting blackholing, as well as common
operation practices at the ASes (acceptance of more speciﬁc than /24 preﬁxes),
and transitive blackholing. Moreover, the blackholed data can be used to better
mitigate attacks in the Internet.
Acknowledgments. We thank all our colleagues for their feedback, and the review-
ers for their suggestions. This work is supported by European Unions Horizon 2020
research and innovation programme under the ENDEAVOUR project (grant agree-
ment 644960) and by the German Federal Ministry of Education and Research (BMBF
Grant 01IS14009D BDSec).
References
1. Abdelsayed, S., Glimsholt, D., Leckie, C., Ryan, S., Shami, S.: An eﬃcient ﬁlter
for denial-of-service bandwidth attacks. In: GOLBECOM (2003)
2. Adler, M.: Trade-oﬀs in probabilistic packet marking for IP traceback. JACM
52(2), 217–244 (2005)
3. Agarwal, S., Dawson, T., Tryfonas, C.: DDoS Mitigation via Regional Cleaning
Centers. Technical report, Sprint ATL Research Report (2003)
4. Andersen, D., Balakrishnan, H., Kaashoek, F., Morris, R.: Resilient overlay net-
works. In: ACM SOSP (2001)
5. Battles, T., McPherson, D., Morrow, C.: Customer-triggered real-time blackholes.
In: NANOG 30 (2004)
6. Chatzis, N., Smaragdakis, G., B¨ottger, J., Krenc, T., Feldmann, A.: On the beneﬁts
of using a large IXP as an internet vantage point. In: ACM IMC (2013)
7. Czyz, J., Kallitsis, M., Gharaibeh, M., Papadopoulos, C., Bailey, M., Karir, M.:
Taming the 800 pound gorilla: the rise and decline of NTP DDoS attacks. In: ACM
IMC (2014)
Blackholing at IXPs: On the Eﬀectiveness of DDoS Mitigation in the Wild
331
8. DE-CIX: DE-CIX Blackholing Support. www.de-cix.net/products-services/de-cix-
frankfurt/blackholing/
9. Deutsche Telekom: AS3320 BGP Communities, August 2005. www.onesc.net/
communities/as3320/AS3320 BGP Communities v1.1.pdf
10. Gil, T.M., Poletto, M.: MULTOPS: A data-structure for bandwidth attack detec-
tion. In: USENIX Security Symposium (2001)
11. Gonzalez, J.M., Anwar, M., Joshi, J.: A trust-based approach against ip-spooﬁng
attacks. In: IEEE PST (2011)
12. Greene, B.R.: Remote triggering black hole ﬁltering. Cisco Systems (2002)
13. Greene, B.R., Smith, P.: Cisco ISP Essentials. Cisco Press, Indianapolis (2002)
14. Hu, Y., Choi, H., Choi, H.-A.: Packet ﬁltering to defend ﬂooding-based DDoS
attacks. In: Advances in Wired and Wireless Communication (2004)
15. Hurricane Electric: Customer Blackhole Community (2006). www.he.net/adm/
blackhole.html
16. Ioannidis, J., Bellovin, S.M.: Implementing Pushback: Router-Based Defense
Against DDoS Attacks. Columbia University Academic Commons (2002)
17. Jin, C., Wang, H., Shin, K.G.: Hop-count ﬁltering: an eﬀective defense against
spoofed DDoS traﬃc. In: ACM CCS (2003)
18. Keshariya, A., Foukia, N.: DDoS defense mechanisms: a new taxonomy. In:
Garcia-Alfaro, J., Navarro-Arribas, G., Cuppens-Boulahia, N., Roudier, Y. (eds.)
DPM 2009. LNCS, vol. 5939, pp. 222–236. Springer, Heidelberg (2010)
19. K¨uhrer, M., Hupperich, T., Rossow, C., Holz, T.: Exit from hell? reducing the
impact of ampliﬁcation DDoS attacks. In: USENIX Security Symposium (2001)
20. MacFarland, D.C., Shue, C.A., Kalafut, A.J.: Characterizing optimal DNS ampli-
ﬁcation attacks and eﬀective mitigation. In: Mirkovic, J., Liu, Y. (eds.) PAM 2015.
LNCS, vol. 8995, pp. 15–27. Springer, Heidelberg (2015)
21. Mahajan, R., Bellovin, S.M., Floyd, S., Ioannidis, J., Paxson, V., Shenker, S.:
Controlling high bandwidth aggregates in the network. ACM SIGCOMM CCR
(2002)
22. Mirkovic, J., Prier, G., Reiher, P.: Source-end DDoS defense. In: IEEE NCA (2003)
23. Mirkovic, J., Reiher, P.: A taxonomy of DDoS attack and DDoS defense mecha-
nisms. In: ACM SIGCOMM CCR (2004)
24. Mizrak, A.T., Savage, S., Marzullo, K.: Detecting compromised routers via packet
forwarding behavior. IEEE Netw. 22(2), 34–39 (2008)
25. MSK-IX: Protection against DDoS-attacks by blackholing. www.msk-ix.ru/eng/
routeserver.html#blackhole
26. NETIX: Blackholing. www.netix.net/services/14/NetIX-Blackholing
27. NTT Communications: Terms and conditions for use of global IP network services,
August 2007. http://www.ntt.net/english/library/pdf/terms.pdf
28. Park, K., Lee, H.: On the eﬀectiveness of route-based packet ﬁltering for distributed
DoS attack prevention in power-law internets. In: ACM SIGCOMM CCR (2001)
29. Peng, T., Leckie, C., Ramamohanarao, K.: Protection from distributed denial of
service attacks using history-based IP ﬁltering. In: IEEE ICC (2003)
30. Prince, M.: The DDoS that almost broke the internet, March 2013. www.blog.
cloudﬂare.com/the-ddos-that-almost-broke-the-internet/
31. Richter, P., Smaragdakis, G., Feldmann, A., Chatzis, N., Boettger, J., Willinger,
W.: Peering at peerings: on the role of IXP route servers. In: ACM IMC (2014)
32. Rossow, C.: Ampliﬁcation hell: revisiting network protocols for DDoS abuse. In:
NDSS (2014)
332
C. Dietzel et al.
33. Ryba, F., Orlinski, M., W¨ahlisch, M., Rossow, C., Schmidt, T.: Ampliﬁcation and
DRDoS Attack Defense - A Survey and New Perspectives. arXiv preprint (2015).
arxiv:1505.07892
34. Savage, S., Wetherall, D., Karlin, A., Anderson, T.: Network support for IP trace-
back. IEEE/ACM Trans. Netw. 9(3), 226–237 (2001)
35. Shi, E., Stoica, I., Andersen, D.G., Perrig, A.: OverDoSe: A Generic DDoS Pro-
tection Service Using an Overlay Network. Computer Science Department (2006)
36. Sipgate: The Sipgate DDoS Story, October 2014. https://medium.com/@sipgate/
ddos-attacke-auf-sipgate-a7d18bf08c03
37. Specht, S.M., Lee, R.B.: Distributed denial of service: taxonomies of attacks, tools,
and countermeasures. In: ISCA PDCS, pp. 543–550 (2004)
38. van Rijswijk-Deij, R., Sperotto, A., Pras, A.: DNSSEC and its potential for DDoS
attacks: a comprehensive measurement study. In: ACM IMC (2014)
39. Zargar, S.T., Joshi, J., Tipper, D.: A survey of defense mechanisms against distrib-
uted denial of service (DDoS) ﬂooding attacks. IEEE Com. Surv. Tutorials 15(4),
2046–2069 (2013)