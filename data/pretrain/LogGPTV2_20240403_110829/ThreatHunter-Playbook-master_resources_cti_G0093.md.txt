# G0093: Soft Cell

## Description
Operation Soft Cell (G0093) is a threat group reportedly affiliated with China and likely state-sponsored. The group has been active since at least 2012 and has targeted high-profile telecommunications networks. (Citation: Cybereason Soft Cell June 2019)

## Tactics, Techniques, and Procedures (TTPs)

| Platform | Tactic | Technique | Description | Data Sources |
| --- | --- | --- | --- | --- |
| Linux, macOS, Windows | Exfiltration | [Exfiltration Over Command and Control Channel](https://attack.mitre.org/techniques/T1041/) | Soft Cell used Web shells and HTRAN for C2 and data exfiltration. | User interface, Process monitoring |
| Linux, macOS, Windows | Defense Evasion | [Indicator Removal from Tools](https://attack.mitre.org/techniques/T1066/) | Soft Cell ensured each payload had a unique hash by using different types of packers. | Process use of network, Process monitoring, Process command-line parameters, Anti-virus, Binary file metadata |
| Windows | Lateral Movement | [Pass the Hash](https://attack.mitre.org/techniques/T1075/) | Soft Cell used dumped hashes to authenticate to other machines via pass-the-hash. | Authentication logs |
| Linux, macOS, Windows, GCP, AWS, Azure | Collection | [Data from Local System](https://attack.mitre.org/techniques/T1005/) | Soft Cell collected data from the victim's local system, including password hashes from the SAM hive in the Registry. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, GCP, Azure, AWS | Discovery | [Remote System Discovery](https://attack.mitre.org/techniques/T1018/) | Soft Cell used a modified version of nbtscan to identify available NetBIOS name servers over the network and ping to identify remote systems. | Network protocol analysis, Process monitoring, Process use of network, Process command-line parameters |
| Windows | Persistence, Initial Access | [External Remote Services](https://attack.mitre.org/techniques/T1133/) | Soft Cell established VPN access into victim environments. | Authentication logs |
| Linux, Windows, macOS | Exfiltration | [Data Compressed](https://attack.mitre.org/techniques/T1002/) | Soft Cell used winrar to compress and encrypt stolen data prior to exfiltration. | Binary file metadata, File monitoring, Process command-line parameters, Process monitoring |
| Linux, macOS, Windows | Exfiltration | [Data Encrypted](https://attack.mitre.org/techniques/T1022/) | Soft Cell used winrar to compress and encrypt stolen data prior to exfiltration. | File monitoring, Process monitoring, Process command-line parameters, Binary file metadata |
| Linux, macOS, Windows, AWS, GCP, Azure | Collection | [Data Staged](https://attack.mitre.org/techniques/T1074/) | Soft Cell compressed and staged files in multi-part archives in the Recycle Bin prior to exfiltration. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Defense Evasion | [Obfuscated Files or Information](https://attack.mitre.org/techniques/T1027/) | Soft Cell used a modified version of HTRAN to obfuscate strings such as debug messages to evade detection. | Network protocol analysis, Process use of network, File monitoring, Malware reverse engineering, Binary file metadata, Process command-line parameters, Environment variable, Process monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection |
| Linux, macOS, Windows | Command and Control, Defense Evasion | [Connection Proxy](https://attack.mitre.org/techniques/T1090/) | Soft Cell used a modified version of HTRAN to redirect connections between networks. | Process use of network, Process monitoring, Netflow/Enclave netflow, Packet capture |
| Windows, macOS | Defense Evasion | [Software Packing](https://attack.mitre.org/techniques/T1045/) | Soft Cell packed some payloads using different types of packers, both known and custom. | Binary file metadata |
| Windows | Execution, Persistence, Privilege Escalation | [Scheduled Task](https://attack.mitre.org/techniques/T1053/) | Soft Cell established persistence for PoisonIvy by creating a scheduled task. | File monitoring, Process monitoring, Process command-line parameters, Windows event logs |
| Linux, macOS, Windows | Defense Evasion | [Masquerading](https://attack.mitre.org/techniques/T1036/) | Soft Cell used a renamed cmd.exe file to evade detection. | File monitoring, Process monitoring, Binary file metadata |
| Linux, macOS, Windows | Command and Control, Lateral Movement | [Remote File Copy](https://attack.mitre.org/techniques/T1105/) | Soft Cell dropped additional tools to victims during their operation, including portqry.exe, a renamed cmd.exe file, winrar, and HTRAN. | File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring |
| Linux, macOS, Windows | Discovery | [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033/) | Soft Cell used whoami and query user to obtain information about the victim user. | File monitoring, Process monitoring, Process command-line parameters |
| Linux, macOS, Windows, AWS, GCP, Azure | Discovery | [System Network Connections Discovery](https://attack.mitre.org/techniques/T1049/) | Soft Cell used netstat -oan to obtain information about the victim network connections. | Process monitoring, Process command-line parameters |
| Linux, macOS, Windows | Discovery | [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1016/) | Soft Cell used ipconfig /all to obtain information about the victim network configuration. They also ran a modified version of nbtscan to identify available NetBIOS name servers. | Process monitoring, Process command-line parameters |
| Windows, Linux, macOS | Credential Access | [Credential Dumping](https://attack.mitre.org/techniques/T1003/) | Soft Cell used a modified version of Mimikatz along with a PowerShell-based Mimikatz to dump credentials on the victim machines. | API monitoring, Process monitoring, PowerShell logs, Process command-line parameters |
| Windows | Credential Access | [Credentials in Registry](https://attack.mitre.org/techniques/T1214/) | Soft Cell used reg commands to dump specific hives from the Windows Registry, such as the SAM hive, and obtain password hashes. | Windows Registry, Process command-line parameters, Process monitoring |
| Linux, macOS, Windows | Execution | [Command-Line Interface](https://attack.mitre.org/techniques/T1059/) | Soft Cell used the Windows command shell to execute commands. | Process monitoring, Process command-line parameters |
| Windows | Execution | [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047/) | Soft Cell used WMI for execution to assist in lateral movement and install tools across multiple assets. | Authentication logs, Netflow/Enclave netflow, Process monitoring, Process command-line parameters |
| Windows | Execution | [PowerShell](https://attack.mitre.org/techniques/T1086/) | Soft Cell used PowerShell for execution to assist in lateral movement and dump credentials stored on compromised machines. | PowerShell logs, Loaded DLLs, DLL monitoring, Windows Registry, File monitoring, Process monitoring, Process command-line parameters |
| Linux, Windows, macOS | Persistence, Privilege Escalation | [Web Shell](https://attack.mitre.org/techniques/T1100/) | Soft Cell used Web shells to persist in victim environments and assist in execution and exfiltration. | Anti-virus, Authentication logs, File monitoring, Netflow/Enclave netflow, Process monitoring |
| Linux, macOS, Windows, AWS, GCP, Azure AD, Azure, Office 365 | Persistence | [Create Account](https://attack.mitre.org/techniques/T1136/) | Soft Cell created rogue, high-privileged domain user accounts to maintain access across waves of a compromise. | Office 365 account logs, Azure activity logs, AWS CloudTrail logs, Process monitoring, Process command-line parameters, Authentication logs, Windows event logs |
| Linux, macOS, Windows, AWS, GCP, Azure, SaaS, Office 365 | Defense Evasion, Persistence, Privilege Escalation, Initial Access | [Valid Accounts](https://attack.mitre.org/techniques/T1078/) | Soft Cell leveraged valid accounts to maintain access to a victim network. | AWS CloudTrail logs, Stackdriver logs, Authentication logs, Process monitoring |
| Windows | Defense Evasion | [DLL Side-Loading](https://attack.mitre.org/techniques/T1073/) | Soft Cell used DLL side-loading to covertly load PoisonIvy into memory on the victim machine. | Process use of network, Process monitoring, Loaded DLLs |
| Linux, Windows, macOS, AWS, GCP, Azure | Initial Access | [Exploit Public-Facing Application](https://attack.mitre.org/techniques/T1190/) | Soft Cell exploited a publicly-facing server to gain access to the network. | Azure activity logs, AWS CloudTrail logs, Stackdriver logs, Packet capture, Web logs, Web application firewall logs, Application logs |

This table provides a comprehensive overview of the tactics, techniques, and procedures (TTPs) employed by the Soft Cell threat group, along with the relevant data sources for detection and mitigation.