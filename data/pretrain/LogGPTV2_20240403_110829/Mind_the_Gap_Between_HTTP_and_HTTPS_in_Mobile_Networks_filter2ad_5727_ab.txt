# Mind the Gap Between HTTP and HTTPS in Mobile Networks

## 5. Device Type and Traffic Volume Analysis

### 5.1 Relationship Between Device Type and Consumed Volume
We investigate the relationship between device type and consumed volume. Figure 5 (left) presents boxplots (showing the 5th, 25th, 50th, 75th, and 95th percentiles) of the absolute volume consumption per vendor. The y-axis is on a logarithmic scale for better visibility. We only report on vendors with at least 1% of users, grouping the remaining vendors as "other." The figure shows that Apple devices consume 3.6× and 1.6× more traffic (median values) than Microsoft and Android devices, respectively.

If we focus on the fraction of HTTPS traffic (Figure 5, right), we observe that the share of HTTPS is inversely proportional to the absolute volume. For example, 50% of Microsoft devices consume about 2 MB, with 90% of this being HTTPS traffic.

### 5.2 HTTPS Traffic Generated by Microsoft Devices
Further investigation into the HTTPS traffic generated by Microsoft devices reveals that, on average, 60% of their traffic is directed to Windows services such as *.bing.* and *.live.*. A similar pattern is observed for Motorola devices, with Google services replacing Microsoft ones. This suggests that most of this HTTPS traffic consists of "background noise," i.e., communications generated by the operating system and apps but not strictly triggered by user activity. However, confirming this hypothesis with precise data is challenging based on the available information.

### 5.3 Second Level Domain Analysis
To understand the visibility of HTTPS services, we process the transaction hostnames. Recall that for HTTPS, the hostname corresponds to the SNI communicated in the TLS handshake. We remove the Top Level Domain (TLD) using the Mozilla Public Suffix list [7]. For each Second Level Domain (SLD) found, we compute the total number of bytes and the associated share of HTTP and HTTPS. Overall, we find 1.6M SLDs, with 92% and 15% used in HTTP and HTTPS transactions, respectively.

The heatmaps in Figure 6 show the top-50 (left) and top-1000 (right) SLDs, which account for 79.5% and 93.8% of the volume in the whole day. SLDs mostly coincide with CDN providers; however, in some cases, they accurately identify actual services (e.g., streaming – googlevideo, spotify; social network – facebook, instagram, twitter, snapchat, whatsapp; gaming – applifier, etc.).

### 5.4 Takeaways
We observed and quantified a "traffic gap" between HTTP and HTTPS. This gap originates from the different mix of services behind each protocol and the OS (and device vendors). Focusing on either one of the two protocols for traffic-based analysis introduces a substantial bias, not only on the overall volume but also in capturing device type diversity and accessed services. A proper characterization of these aspects is key for mobile operators.

## 6. Spatial and Temporal Analysis

Mobile operators are interested in understanding where, how, and when their customers consume data while moving across the network. This is crucial for driving investments (e.g., tower deployment/upgrade) and supporting novel services such as geofencing and Self Organizing Networks (SON). Call Data Records (CDRs) have been widely used to study human mobility [14], but recent studies [9] show that User Data Records (UDRs) offer a richer vision. We argue that web-logs enable even finer-grained spatial-temporal analysis than UDRs, as UDRs aggregate activities in large time windows and associate them with coarse spatial information. Unfortunately, our dataset does not include UDRs, so we cannot further quantify this intuition.

### 6.1 Traffic Discontinuity
For each user, we group HTTP and HTTPS transactions into 10-minute bins, with each bin having a binary value depending on whether at least one transaction was found. Figure 7 shows the bitmaps for 30,000 random users. Notice that HTTP traffic (left plot) is more "discontinued" than HTTPS (right plot), indicating that HTTP activity is more occasional and sparse throughout the day.

Figure 9 provides a more detailed quantification of traffic variation across the day, partitioned into 6-hour bins starting from midnight. Within each bin, we compute the percentage of users having 0%, >50%, or >80% of volume over HTTP(S). HTTP better captures user activity during daily hours, whereas at night (00:00–05:00), 50% of users do not generate any HTTP traffic. This suggests that HTTP traffic better captures real user activity rather than automatic background services.

### 6.2 Cell Tower Perspective
We investigate how HTTP and HTTPS are consumed from a cell tower perspective. Figure 8 reports the CDF of the number of distinct towers each device connects to during the day. Focusing on HTTP traffic only underestimates the set of towers contacted by a device. Specifically, only 6% of devices contact more than 10 towers, while this value doubles when focusing on HTTPS traffic. The HTTPS curve matches well with the "all traffic" curve, suggesting that HTTPS is a good proxy for overall activity.

Next, we quantify how traffic is distributed among towers to identify per-user "hot spots," i.e., which towers carry most of the traffic for each user. We use the number of transactions rather than volume due to the presence of undetectable persistent connections in HTTPS. For HTTP, 93% of users consume at least 80% of their HTTP traffic in just 5 hot spots, reducing to 80% for HTTPS. In terms of hot spot similarity, 70% of users have 7 out of 10 HTTP hot spots also as HTTPS hot spots, indicating that HTTP traffic alone captures important locations well.

### 6.3 Mass Centers
To further corroborate the previous results, we analyze the spatial distribution of HTTP and HTTPS traffic. For each user, we compute mass centers representing where HTTP, HTTPS, and the whole traffic is consumed. A mass center is computed as the average of towers' coordinates weighted by their number of transactions, denoted as mass-HTTP, mass-HTTPS, and mass-ALL, respectively. We then compute the Euclidean distance between (mass-ALL, mass-HTTP) and (mass-ALL, mass-HTTPS) for each user. Figure 10 (left) shows the CDF of the obtained distances, indicating that HTTP content tends to be consumed further away than the majority of the traffic. This result is independent of user activity.

To quantify the "spatial gap" between HTTP and HTTPS, we normalize the Euclidean distances with respect to the user's radius of gyration, computed considering the whole traffic activity. The gyration radius is a well-established metric to characterize user mobility [9,14], capturing the average distance between a point (the mass center) and another set of points (all towers' locations). Figure 10 (right) reports the CDFs of the normalized Euclidean distances. The figure shows that HTTPS captures user mobility very well, with 97% of users having a normalized Euclidean distance <0.5. The mobility observed from HTTP is close to the overall one, and the normalized Euclidean distance tends to decrease for heavy HTTP users.

### 6.4 Conjecture
We conjecture that the latter result derives from the human component of the mobility problem. Users do not explicitly choose to use HTTP or HTTPS; the presence of a traffic type is an "artifact" of the device and applications used. However, a user chooses the location to visit, and as long as some traffic is consumed, it is enough to characterize her mobility pattern.

### 6.5 Takeaways
The "time gap" between HTTP and HTTPS is substantial, with each protocol being the most popular at different times of the day. Conversely, the "spatial gap" between HTTP and HTTPS is limited, and both protocols are quite good at approximating user mobility.

## 7. Conclusions

In this work, we presented the first comparative study between HTTP and HTTPS traffic for mobile networks. Our dataset included HTTP and HTTPS traffic, radio-layer information, and device information from a 10M-subscriber European mobile operator. Our analysis highlighted three different "gaps" between HTTP and HTTPS: a "traffic gap" related to how different services and OS/vendors use HTTP and HTTPS, a "time gap" due to protocols being more used at different times of the day, and a surprisingly small "spatial gap," possibly motivated by the human component of mobility.

From an operator perspective, logging non-HTTP traffic requires additional investments. Based on our dataset, we estimate that for a mid/large mobile operator, such logging requires a few additional terabytes of storage each day, which is an affordable investment compared to the potential need to upgrade the processing cluster and monitoring solution. The extensive adoption of persistent connections also poses challenges for monitoring network metrics that accurately reflect service performance. We argue that state-of-the-art monitoring solutions are not yet ready to properly characterize HTTPS traffic. We hope that our results will quantify the importance of monitoring HTTPS and stimulate the research community to develop better monitoring systems.

## References
1. CAIDA: As rank. http://as-rank.caida.org
2. Casas, P., Fiadino, P., Bär, A.: Understanding HTTP traffic and CDN behavior from the eyes of a mobile ISP. In: Faloutsos, M., Kuzmanovic, A. (eds.) PAM 2014. LNCS, vol. 8362, pp. 268–271. Springer, Cham (2014). doi:10.1007/978-3-319-04918-2_28
3. Erman, J., Ramakrishnan, K.: Understanding the super-sized traffic of the Super Bowl. In: Proceedings of the ACM Internet Measurement Conference (IMC), October 2013
4. Erman, J.E., Gerber, A., Hajiaghayi, M., Pei, D.: To cache or not to cache: The 3G case. IEEE Internet Comput. 15(2), 27–34 (2011)
5. Falaki, H., Lymberopoulos, D., Mahajan, R., Kandula, S., Estrin, D.: A first look at traffic on smartphones. In: Proceedings of the ACM Internet Measurement Conference (IMC), November 2010
6. Keralapura, R., Nucci, A., Zhang, Z.L., Gao, L.: Profiling users in a 3G network using hourglass co-clustering. In: Proceedings of the ACM MobiCom, September 2010
7. Mozilla: Public suffix list. http://publicsuffix.org/
8. Mucelli, E., Oliveira, R., Carneiro, A.V., Naveen, K.P., Sarraute, C.: Measurement-driven mobile data traffic modeling in a large metropolitan area. In: Proceedings of the IEEE Conference on Pervasive Computing and Communications (PerCom), St. Louis, March 2015
9. Ranjan, G., Zang, H., Zhang, Z.L., Bolot, J.: Are call detail records biased for sampling human mobility? ACM SIGCOMM Mob. Comput. Commun. Rev. 16(3), 33–44 (2012)
10. Sandvine, Global Internet Phenomena: Spotlight: encrypted internet traffic. https://www.sandvine.com/trends/encryption.html
11. Shafiq, M.Z., Ji, L., Liu, A.X., Pang, J., Venkataraman, S., Wang, J.: A first look at cellular network performance during crowded events. In: Proceedings of the ACM SIGMETRICS, June 2013
12. Trestian, I., Ranjan, S., Kuzmanovic, A., Nucci, A.: Measuring serendipity: connecting people, locations, and interests in a mobile 3G network. In: Proceedings of the ACM Internet Measurement Conference (IMC), November 2009
13. Vallina-Rodriguez, N., Sundaresan, S., Kreibich, C., Weaver, N., Paxson, V.: Beyond the radio: illuminating the higher layers of mobile networks. In: Proceedings of the ACM MobiSys, November 2015
14. Blondel, V.D., Adeline Decuyper, G.K.: A survey of results on mobile phone datasets analysis. CoRR arXiv arXiv:1502.03406 (2015)
15. Vni, C.: The Zettabyte Era: Trends and analysis. http://www.cisco.com/c/en/us/solutions/collateral/service-provider/visual-networking-index-vni/vni-hyperconnectivity-wp.html
16. Xu, Q., Erman, J., Gerber, A., Mao, Z., Pang, J., Venkataraman, S.: Identifying diverse usage behaviors of smartphone apps. In: Proceedings of the ACM Internet Measurement Conference (IMC), November 2011