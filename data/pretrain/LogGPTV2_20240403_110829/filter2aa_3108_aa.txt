All your family secrets belong to us -
Worrisome security issues in tracker apps
Siegfried Rasthofer | Fraunhofer SIT, Germany
Stephan Huber | Fraunhofer SIT, Germany 
DefCon26, August 11th 2018
Who are we?
§ Head of department Secure Software 
Engineering
§ PhD, M.Sc., B.Sc. in computer science 
§ Static and dynamic code analysis
§ Founder of @TeamSIK and @CodeInspect
§ Security researcher @Testlab Mobile 
Security
§ Code analysis tool development 
§ IOT stuff
§ Founder of @TeamSIK
Siegfried
Stephan
2
Who are we?
Siegfried
Stephan
(creds to: Alex, Daniel, Julien, Julius, Michael, Philipp, Steven, Kevin, Sebald, Ben)
3
§ Head of department Secure Software 
Engineering
§ PhD, M.Sc., B.Sc. in computer science 
§ Static and dynamic code analysis
§ Founder of @TeamSIK and @CodeInspect
§ Security researcher @Testlab Mobile 
Security
§ Code analysis tool development 
§ IOT stuff
§ Founder of @TeamSIK
Beer Announcement
4
Agenda
§ Motivation
§ Background Information
§ Client-Side Authorization
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
5
Agenda
§ Motivation
§ Background Information
§ Client-Side Authorization
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
6
Surveillance - Then
1960: Radio receiver inside pipe
1970: Microphone inside a dragonfly
* Source: http://www.businessinsider.com/
1960: Camera inside a pack of cigarettes
7
Surveillance - Now
Spyware/RAT
8
Surveillance - Now
Benign Reasons?
Spyware/RAT
9
Surveillance - Now
Benign Reasons?
Family
Couple
Friends
10
Good vs. Bad
Family
Couple
Friends
Spyware/RAT
11
Surveillance - Apps
*Android Security Report 2017
Google Play Store
12
How well is the collected data protected?
13
App Name
Google Play Store Installations
Couple Tracker App
5-10 m
My Family GPS Tracker
KidControll GPS Tracker
Rastrear Celular Por el Numero
Phone Tracker By Number
Couple Vow
Real Time GPS Tracker
Ilocatemobile
1-5m
Family Locator (GPS)
Free Cell Tracker
Rastreador de Novia
Phone Tracker Free
Phone Tracker Pro
Rastreador de Celular Avanzado
100-500k
Rastreador de Novia
Localiser un Portable avec son Numero
50-100k
Handy Orten per Handynr
10-50k
Track My Family
1k
14
App Name
Google Play Store Installations
Couple Tracker App
5-10 m
My Family GPS Tracker
KidControll GPS Tracker
Rastrear Celular Por el Numero
Phone Tracker By Number
Couple Vow
Real Time GPS Tracker
Ilocatemobile
1-5m
Family Locator (GPS)
Free Cell Tracker
Rastreador de Novia
Phone Tracker Free
Phone Tracker Pro
Rastreador de Celular Avanzado
100-500k
Rastreador de Novia
Localiser un Portable avec son Numero
50-100k
Handy Orten per Handynr
10-50k
Track My Family
1k
15
Takeaways
It is very easy to…
§ Enable premium features without paying
§ Access highly sensitive data of a person
§ Perform mass surveillance in real-time
16
Agenda
§ Motivation
§ Background Information
§ Client-Side Authorization
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
17
How does it work? – Very simple
push
Observer
Monitored Person
pull
Tracking Provider
(back-end/cloud)
18
What kind of data?
push
Observer
Monitored Person
pull
TEXT
19
What kind of data?
push
Observer
Monitored Person
pull
TEXT
20
Attack Vectors
push
Observer
Monitored Person
pull
21
Attack Vectors
push
Observer
Monitored Person
pull
22
Attack Vectors
push
Observer
Monitored Person
pull
23
Agenda
§ Motivation
§ Background Information
§ Client-Side Authorization
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
24
101
1. Authentication Process
2. Authorization Process
Observer
25
WTF?
1. Authentication Process
Observer
26
WTF?
1. Authentication Process
2. Client-Side Authorization
Observer
27
WTF 1/4 – Enable Premium Features
28
WTF 1/4 – Enable Premium Features
boolean removeAd = SharedPref.getBoolean("l_ads", false)
if(removeAd) {
this.setVisibility(View.GONE);
} else {
...
}
29
WTF 1/4 – Enable Premium Features
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
boolean removeAd = SharedPref.getBoolean("l_ads", false)
if(removeAd) {
this.setVisibility(View.GONE);
} else {
...
}
30
SharedPreferences Backup/Restore
§ Rooted device:
1.
copy loveMonitoring.xml from app folder to pc
2.
modify file, set false to true
3.
copy back and overwrite orig. file with modified file
§ Unrooted device:
adb backup
adb restore
convert *
modify file
*https://github.com/nelenkov/android-backup-extractor
adb tool
31
WTF 1/4 – Enable Premium Features
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
32
WTF 1/4 – Enable Premium Features
/data/data/com.bettertomorrowapps.spyyourlovefree/
shared_prefs/loveMonitoring.xml
33
WTF 1/4 – Enable Premium Features
1. Give me all text messages
Observer
34
WTF 1/4 – Enable Premium Features
1. Give me all text messages
2. Ok: msg1, msg2, msg3, …
Observer
35
WTF 1/4 – Enable Premium Features
1. Give me all text messages
if(getBoolean(“l_sms_full”) == false) {
String[] msgs = getAllMsgs();
…
singleMsg
= msgs[i].substring(0, 50);
}
else {
//return complete text messages
}
2. Ok: msg1, msg2, msg3, …
Observer
36
3. Client “Authorization” Check
WTF 1/4 – Enable Premium Features
1. Give me all text messages
if(getBoolean(“l_sms_full”) == false) {
String[] msgs = getAllMsgs();
…
singleMsg
= msgs[i].substring(0, 50);
}
else {
//return complete text messages
}
2. Ok: msg1, msg2, msg3, …
Observer
37
3. Client “Authorization” Check
WTF 2/4 – Admin Privileges
• App supports two modes:
• parent (controller/administration) 
• children (monitored)
• Administrator can create new Administrators
• Administrator can monitor all children
38
WTF 2/4 – Admin Privileges
• App supports two modes:
• parent (controller/administration) 
• children (monitored)
• Administrator can create new Administrators
• Administrator can monitor all children
????
39
WTF 2/4 – Admin Privileges
• App supports two modes:
• parent (controller/administration) 
• children (monitored)
• Administrator can create new Administrators
• Administrator can monitor all children
40
WTF 3/4 - Remove Lockscreen
41
WTF 3/4 - Remove Lockscreen
§ After app start the lock screen asks for pin
????
42
Remove Lockscreen
§ After app start the lock screen asks for pin
§ To remove the lock screen, change SharedPreference value from true to
false
43
WTF 4/4 – Authentication Bypass
§ Same works with login, no password required
44
Do not use SharedPreferences for 
authorization checks!!
45
Agenda
§ Motivation
§ Background Information
§ Client-Side Authorization
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
46
Mitm Attack
user/app
tracking provider
(back-end/cloud)
DATA
DATA
47
Mitm Attack
user/app
tracking provider
(back-end/cloud)
DATA
DATA
48
Mitm Attack
user/app
tracking provider
(back-end/cloud)
DATA
DATA
49
Mitm Attack
user/app
tracking provider
(back-end/cloud)
DATA
DATA
50
Mitm + Bad Crypto + Obfuscation
??
51
Mitm + Bad Crypto + Obfuscation
??
PI:EMAIL
secure123
52
Mitm + Bad Crypto + Obfuscation
GET /login/?aaa=Bi9srqo&nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A HTTP/1.1
http://s9.***********.com/login/?aaa...
53
Mitm + Bad Crypto + Obfuscation
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
1.
PI:EMAIL
secure123
54
Mitm + Bad Crypto + Obfuscation
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
1.
2.
PI:EMAIL
secure123
55
Mitm + Bad Crypto + Obfuscation
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
tnd=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
GET /login/?
ssp=CFF1CxQoaQcoLWoRaQ%3D%3D%0A& 
eml=4hBWVqJg4D& 
mix=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A
HTTP/1.1
GET /login/?
psw=-ZI-WQe&
amr=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&
rma=CFF1CxQoaQcoLWoRaQ%3D%3D%0A 
HTTP/1.1
1.
2.
3.
PI:EMAIL
secure123
56
Mitm + Bad Crypto + Obfuscation
GET /login/?
aaa=Bi9srqo&
nch=DzttDRMbYQcAPmUfAGQZHDxOJRMbclZeKQ%3D%3D%0A&