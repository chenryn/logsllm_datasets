the BGPWeekly dataset.
RIR: This dataset contains the (extended—if available) delegation
files from AFRINIC [3], APNIC [5], ARIN [6], LACNIC [36], and
RIPENCC [54] for all days in the BGPMonthly dataset.
Data sanitation. Before analyzing our BGP data, we remove well-
known artifacts. First, we remove bogon routes, i.e., routes that
lead only to reserved address space [65] or routes that contain ASes
currently reserved by IANA [33]. Similarly, we remove all routes
to prefixes less specific than /8. This step ensures that we only
analyze default-free routing information.3 We further remove all
routes for which the path contains a loop. The sanitation, up to
this point, removed ~3.36M (0.7 %) routes and reduced the number
of prefixes from ~1.29M to ~932k (-28 %) using the last snapshot
of the BGPWeekly dataset as reference (we find similar values for
other snapshots). To avoid making false inferences due to lack of
visibility, we only analyze prefixes visible by at least one-third of
the BGP monitors set on the corresponding date. When analyzing
how many monitors see each prefix, we find a clear separation
between locally and globally visible prefixes regardless of the exact
year (in Appendix § B we report more details). Notably, the last
step reduced the number of unique prefixes to ~803k.
4 TRENDS IN THE USE OF ASPP
Previously reported metrics about ASPP differ across studies, with
the most recent results being from 2016 [11, 25, 27, 67]. To under-
stand ASPP utilization better, we analyze its trends over the last
decade using the BGPMonthly dataset. We note our numbers repre-
sent lower bounds of the actual ASPP utilization, as (i) the visibility
of route collectors is limited [16, 29, 47]; (ii) prepended paths tend
to be less attractive than non-prepended ones; (iii) we sanitize our
data (see § 3).
One-third of all ASes use origin-prepending. Figure 2 shows
the fraction of ASes using ASPP (for IPv4) separated by prepending
type (recall § 2): origin-prepending or intermediate-prepending. First,
we see that the fraction of ASes using ASPP has increased slightly,
from ~28% (9.4k) on January 15th, 2010 to ~31.4% (21.6k) on April
15th, 2020, with most ASes using origin-prepending. Similarly, we
observe a small increase in intermediate prepending—from 4.7%
(1.6k) on January 15th, 2010, to 5.5% (3.8k) on April 15th, 2020. 4
3As opposed to cases in which an AS uses the default route (i.e., 0.0.0.0/0) to send
traffic to some/all destinations.
4The spike on the fraction of ASes applying intermediate prepending corresponds to
the period in which a set of experiments [62] involving the use of BGP communities
to manipulate ASPP was taking place.
We also see a very small fraction ( 0;
(iii) binary: visible routes either have prepend size M or N , where
M, N ≥ 0 and M (cid:44) N ; (iv) diverse: the number of different prepend
sizes in the visible routes exceeds two.
ASes tend to stick with a (per-prefix) policy over time. Our
first focus is on policy consistency—how often does an AS change a
prefix prepending policy? For this analysis, we use the BGPContinuous
dataset, in which we identify roughly 2.3 million unique prefix-
origin pairs. For each pair, we define as its primary policy the one we
observe more often throughout the full month (among no-prepend,
uniform, binary and diverse). We examine the stability of the pri-
mary policy for a prefix-origin pair with respect to its visibility
period. Figure 4 shows a heatmap, where colors indicate the number
of pairs in each cell. We observe a concentration in the top right
section of the plot, which corresponds to 54% of prefix-origin pairs,
indicating that they are visible all the time and never change their
primary policy. We repeated the analysis for another month (Sep.
2019) and found similar primary policy stability, which allows us
to adopt weekly (BGPWeekly ) or monthly (BGPMonthly ) snapshots
without any loss in the subsequent analyses.
The use of policies has been stable, with binary policy be-
ing more common. Using the BGPWeekly dataset, we examine the
use of prepending policies for prefix-origin pairs between January
1st, 2018, and May 4th, 2020. In Figure 5, we see that the most com-
mon prepending policy is binary, followed by diverse and uniform
policies. Their popularity remains largely stable, if considering the
proportion to the full set of pairs: diverse increased from 4.5% (30k)
to 6.1% (50k), binary decreased from 17.2% (114k) to 15.9% (131k),
while uniform remained at 3.6% (24.4k to 29.4k)7. We note that
the trend regarding the use of more fine-grained policies might be
related to the increasing connectivity level of ASes (e.g., connect-
ing to more IXPs). For the sake of comparison, we looked at the
use of uniform prepending back in January 2010, and it was 2.7%
(8.2k). The consistent presence of uniform policy through time is
surprising since, in theory, it should not influence any remote BGP
decisions. We take a closer look at this phenomenon in § 5.3.
More prepending during COVID-19 lockdown. We also note
that between February and April of 2020, the number of prefix-
origin pairs with ASPP reached approximately 30% (4% increase).
Such a peak is likely related to the lockdown measures due to
COVID-19, which resulted in people staying more time at home [28,
71, 72]. In this period there have been reports of traffic increases [4,
20, 44], which also resulted in content providers such as Netflix and
Youtube stopping streaming in 4k to save bandwidth [31].
We believe that the higher use of ASPP during this period was
necessary for network operators to handle the increasing demands
of traffic while upgrading their links (as ASPP use has decreased
in May). When we discussed this with network operators, some of
them mentioned that they were observing more use of ASPP, espe-
cially during large live events streamed on Youtube [42], and that
some of their transit customers were requesting capacity upgrades.
7In May 4th, 2020, all types of prepending combined represented 25.6% of all prefix-
origin pairs, corroborating findings in § 4.
AS-Path Prepending: there is no rose without a thorn
IMC ’20, October 27–29, 2020, Virtual Event, USA
5:
Prefix-origin:
Figure
Fractions
through time of visible prefixes per
ASPP policy.
5.2 ASPP policies: ASes
We now change the perspective of our policy analysis to ASes. We
differentiate per-AS ASPP policies as follows. When an AS employs
a single policy for all prefixes it originates, we say it adopts one
of the four policies already defined: no-prepend, uniform, binary or
diverse. Otherwise, we say an AS employs a mixed set of policies.
Most ASes that prepend use multiple policies. Using the
BGPWeekly dataset, we analyze the use of AS prepending policies
between January 1st, 2018, and May 4th, 2020. We observe that
more than 30.8% (20.8k) of the ASes prepend at least one prefix
they originate (consistently with § 4), and most ASes use mixed
prepending policies on May 4th, 2020. Among those using a single
policy, the most common case is the binarypolicy, followed by
uniform and diverse, respectively. Over time the fractions of different
policies are substantially stable, with only a slight increase in all
but binary policies. (In May 4th, 2020 we observe the following
percentages: uniform 2.5%, diverse 1.4%, mixed 16.4%, and binary
10.4%). Once again, we note an increase in fine-grained prepending
policies, which may be associated with a general increase in AS
connectivity. We consider conceptually more straightforward for
an AS to employ a single policy. Nevertheless, ITE may require
the AS to use mixed policies, such as binary for some prefixes and
no-prepend for others.
ASes with mixed policies mainly use binary policies. Next,
we focus on ASes using a mixed set of policies and analyze the
fraction of prefixes using each of the prepending policies. We group
these few ASes according to the number of originated prefixes,
in four “bins”: 1 − 10, 11 − 100, 101 − 1000, 1000+ prefixes. For
each AS in a bin, we calculate the fraction of prefixes for each
policy and present it as a boxplot in Figure 6 for May 4th, 2020 (we
observe similar behavior for other snapshots). The plot shows only
ASes that employ a mixed set of policies8, and we observe that for
these ASes, the most common is the binary policy (in all bins). We
also find, confirming our intuition, that the fraction of the diverse
8The same plot for different dates, namely all snapshots of the BGPWeekly dataset
showed similar results.
Figure 6: Mixed policy ASes grouped by
# of prefixes.
Figure 7: Fractions of prepending poli-
cies through time for a fixed set of
uniform-prepend prefixes.
policy increases with the number of prefixes an AS originates (more
pronounced for the two larger bins). Conversely, we see the fraction
of uniformly prepended prefixes decreasing (with AS size).
5.3 Uniform prepending
Uniform prepending is widespread. There is no apparent rea-
son for an AS to use the same prepending size for all its neigh-
bors when originating a prefix, as it implies no differentiation
among them. Nevertheless, on May 4th, 2020, we observe more
than 29k (3.6%) uniformly prepended prefix-origin pairs originated
by 5.8k (8%) ASes, out of which 1.7k (2.5%) ASes prepend all their
prefixes uniformly.
Some prefixes use the uniform policy consistently. The use
of uniform policy might be the result of temporary events. To de-
termine whether this is a common case, we pick all the (25.8k)
uniformly-prepended prefix-origin pairs on a specific date (Decem-
ber 31st, 2018), and use the BGPWeekly dataset to show the fractions
of policy type change for these prefixes in the preceding/following
months. Figure 7 shows that the total number of prefixes decreases
both sides, as up to 20% prefixes were not visible earlier or stop being
visible afterward. We observe that both before and after December
31st, 2018 the fractions of no-prepend, binary, and diverse (for this
fixed set of prefix-origin pairs) increase while uniform decreases.
In other words, for some of these prefixes, uniform prepending was
temporary. On the other hand, for the entire period, we see at least