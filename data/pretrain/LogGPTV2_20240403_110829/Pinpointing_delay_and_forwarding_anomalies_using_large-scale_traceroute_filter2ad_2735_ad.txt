next hops are diﬀerent from those observed in the past.
Further, an anomalous pattern can be caused by just
a few aberrant next hops. We devise a metric to iden-
tify hops that are responsible for forwarding pattern
changes. Let F = {pi|i ∈ [1, n]} be an anomalous
pattern and ¯F = {¯pi|i ∈ [1, n]} the computed normal
reference. Then we quantify the responsibility of the
(cid:80)n
next hop i to the pattern change as:
pi − ¯pi
j=1 |pj − ¯pj| .
ri = −ρF, ¯F
(9)
The responsibility metric ri ranges in [−1, 1]. Values
close to zero mean that the next hop i received an usual
number of packets thus it is likely not responsible for
the pattern change. On the other hand, values deviating
from 0 indicate anomalous next hops. Positive values
stand for hops that are newly observed, while negative
values represent hops with an unusually low number of
packets.
For example, assume Figure 4a depicts ¯F R, the com-
puted normal reference for router R, and Figure 4b il-
lustrates F R, the latest forwarding pattern observed.
The correlation coeﬃcient for these patterns, ρF R, ¯F R =
−0.6, is lower than the threshold τ , thus F R is reported
as anomalous. The responsibility scores for A, B, C, and
Z are, respectively, 0,−0.28, 0.25, and 0.07; suggesting
that packets are ordinarily transmitted to A and Z, but,
the number of packets to B is abnormally low while the
count to C is exceptionally high. In other words traf-
ﬁc usually forwarded to B is now going through C. In
the case of a next hop dropping a signiﬁcant number
of packets, the responsibility score of this hop will be
negative while the score of Z will be large.
6. DETECTION OF MAJOR EVENTS
The proposed delay analysis method (§ 4) and packet
forwarding model (§ 5) are both designed to report
anomalies found in large-scale traceroute measurements.
With RIPE Atlas these methods allow us to monitor
hundreds of thousands links and potentially obtain a
large number of alarms (i.e. either delay changes or
forwarding anomalies). Investigating each alarm can be
very tedious and time consuming.
In this section we
introduce a simple technique to aggregate alarms and
report only signiﬁcant network disruptions.
Alarm aggregation. Major network disruptions are
characterized by either a large-scale alteration of nu-
merous links or exceptional connectivity issues at a one
or more locations. We wish to emphasize both by aggre-
gating alarms based on their temporal and spatial char-
acteristics. The temporal grouping of alarms allows us
to highlight large-scale events impacting many routers
at the same time. Similarly, collecting alarms that are
topologically close allows us to emphasize network dis-
ruptions bound to a particular entity. In early experi-
ments we have tried several spatial aggregations, includ-
ing geographical ones, and found that grouping alarms
per AS is relevant because most signiﬁcant events are
contained within one or a few ASs.
Consequently, we group delay change alarms by the
reported IP pair and forwarding anomalies by the next
hops’ IP addresses. The IP to AS mapping is done using
longest preﬁx match, and alarms with IP addresses from
diﬀerent ASs are assigned to multiple groups.
Alarms from each AS are then processed to com-
pute two time series representing the severity of re-
ported anomalies, thus the AS’s condition. The severity
of anomalies is measured diﬀerently for delay change
and packet forwarding alarms. For delay changes the
severity is measured by the deviation from the normal
reference, d(∆) (Equation 6). Severity of forwarding
anomalies is given by ri, the responsibility score of the
reported next hop i (Equation 9). Thereby, AS network
conditions are represented by two time series, one is the
sum of d(∆) over time and the other the sum of ri over
time. In the case of forwarding anomalies, ri values are
negative if a hop from the AS is devalued and positive
otherwise. Consequently, if traﬃc usually goes through
a router i but is suddenly rerouted to router j, and both
i and j are assigned to the same AS, then the negative
ri and positive rj values cancel out, thus the anomaly
was mitigated at the AS level.
Event detection. Finding major network disruptions
in an AS is done by identifying peaks in either of the
two time series described above. We implement a simple
outlier detection mechanism to identify these peaks.
Let X = {xt|t ∈ N} be a time series representing
delay changes or forwarding anomalies for a certain AS
and mag(X) be the magnitude of the AS network al-
teration deﬁned as:
X − median(X)
1 + 1.4826 MAD(X)
mag(X) =
(10)
where median and MAD are the one-week sliding me-
dian and median absolute deviation [49]. In the follow-
8
(a) Complementary cumulative
distribution function for the de-
lay change magnitude. Promi-
nent changes are on the right
hand side.
of
Cumulative
the
(b)
distribution
function
forwarding
anomaly magnitude. Prominent
anomalies are on the left hand
side.
Figure 5: Distribution of hourly magnitude for
all ASs. Arrows point to prominent anomalies
presented in the three study cases.
ing sections we report magnitude scores found with our
dataset and investigate corresponding network disrup-
tions.
7. RESULTS
Using the Internet-wide traceroutes from RIPE Atlas
(§ 2), we report delay changes and forwarding anoma-
lies from eight months in 2015 and 1060 ASs. In the
following we present aggregate results of the identiﬁed
delay changes and forwarding anomalies. Then, we dive
into case studies showing the relevance of the proposed
methods to detect and locate network disruptions of
diﬀerent types (§ 7.1, 7.2, and 7.3).
Delay changes.
In our experiments we monitored
delays for 262k IPv4 links (42k IPv6 links). On average
links are observed by 147 IPv4 probes (133 IPv6 probes)
and 33% of the links were reported to have at least one
abnormal delay change.
We computed the hourly delay change magnitude for
each monitored ASs, Figure 5a depicts the distribution
of all these values. 97% of the time we observe a mag-
nitude lower than 1, meaning that ASs are usually free
of large transient delay changes. The heavy tail of the
distribution, however, indicates that delay changes can
have a very detrimental impact on Internet delays. We
manually inspected the most prominent delay changes
but found that validating such results is particularly
hard as public reports are rarely available and Internet
service providers are reluctant to disclose troubles that
occurred in their networks. In Section 7.1, we detail a
DDoS attack that generated congestion in several ASs
and accounts for 5 of the top 23 delay changes reported
in our dataset (Fig. 5a).
Furthermore,
in accordance with the central limit
theorem, we observe a narrower conﬁdence interval for
links visited by numerous probes; hence a better diﬀer-
ential RTT estimation and the ability to detect smaller
delay changes.
Forwarding anomalies. Using RIPE Atlas tracer-
9
Figure 6: Delay change magnitude for AS25152
reveals the two DDoS against the K-root server.
outes, we also computed packet forwarding models for
170k IPv4 router IPs (87k IPv6 router IPs). These are
the number of router IP addresses found in traceroutes;
to resolve these to routers IP alias resolution techniques
should be deployed [26]. On average forwarding models
contain four diﬀerent next hops over the eight months
of data.
We computed the hourly forwarding anomaly mag-
nitude for each AS, Figure 5b illustrates the distri-
bution of these values. This distribution features a
heavy left tail representing a few signiﬁcant forward-
ing anomalies due to important packet loss or traﬃc
redirection. Namely, forwarding anomaly magnitude is
lower than −10 for only 0.001% of the time. Similarly to
the delay changes, validating these results is challeng-
ing. In Section 7.2 and 7.3 we investigate two signiﬁcant
events from the top 20 forwarding anomalies found in
our dataset (Fig. 5b). These events are already publicly
documented but the proposed method provides further
insights on their location and impact.
7.1 DDoS attack on DNS root servers
Our ﬁrst case-study shows the impact of a large dis-
tributed denial-of-service (DDoS) attack on network in-
frastructure. The simplest form of DDoS attack con-
sists of sending a huge number of requests to a targeted
service, overwhelming the service and leaving little or
no resources for legitimate use. The extremely large
amount of traﬃc generated by this type of attack is not
only detrimental to the victim but also routers in its
proximity.
We investigate network disruptions caused by two
DDoS attacks against DNS root servers. These attacks
have been brieﬂy documented by root server operators
[39, 48]. The ﬁrst attack was on November 30th from
06:50 to 09:30 UTC, the second on December 1st from
05:10 until 06:10 UTC. As the source IP addresses for
both attacks were spoofed, it is unclear from reports
[48] where the traﬃc originated.
Thanks to the K-root operators, we were able to care-
fully validate our results for the attack toward the K
name server and the corresponding AS (AS25152).
Event detection. Monitoring the delay change mag-
nitude for AS25152 clearly shows the two attacks against
the K-root infrastructure (Fig. 6). The two peaks on
November 30th and December 1st highlight important
Nov 17 2015Nov 24 2015Dec 01 2015Dec 08 2015Dec 15 2015−500005000100001500020000250003000035000Magnitude (delay change)AS25152,  RIPE NCC K-Root Operations(a)
(c)
(e)
(b)
(d)
(f)
Figure 7: Examples of delay change alarms reported during the DDoS attacks against DNS root
servers. The attacks have diﬀerently impacted the connectivity of K-root server instances.
the network. Reported delay changes contain one IP
address for each end of the link. Delay changes detected
on the last hop to the K-root server are identiﬁed by the
server IP address (193.0.14.129) and the router in front
of it. Since K-root is anycast, the actual location of a
reported server instance must be revealed by locating
the adjacent router. For example, Figure 7a depicts the
diﬀerential RTT for an IP pair composed of the K-root
IP address and a router located in Kansas City; hence
this link represents the last hop to the K-root instance
in Kansas City.
During the two attacks we saw alarms from 23 unique
IP pairs containing the K-root server address. Diﬀer-
ent instances were impacted diﬀerently by the attacks.
First, we found instances aﬀected by both attacks, for
example the one in Kansas City (Fig. 7a) is reported
during the entire period of time documented by server
operators. Second, we also observed instances impacted
by only one attack, see Figure 7c. The most reported in-
stance during that period is the one deployed in St. Pe-
tersburg (Fig. 7d). For this instance abnormal delays
are observed for 14 consecutive hours. A possible ex-
planation for this is that hosts topologically close to
this instance caused anomalous network conditions for
a longer period of time than other reported DDoS in-
tervals. Finally, thanks to anycast, for some instances
we did not record anomalous network conditions. Fig-
ure 7b illustrates the diﬀerential RTT for an instance
in Poland that exhibits very stable delays. The corre-
sponding normal reference is exceptionally narrow and
constant even during the attacks.
Figure 8: Alarms reported on November 30th
at 08:00 UTC and related to the K-root server.
Each node represent an IPv4 address, edges
stand for reported alarms. Rectangular nodes
represent anycast addresses, hence distributed
infrastructure. Circular node colors represent
IP addresses related to certain IXPs.
disruptions of an unprecedented level. The ﬁrst peak
spans from 07:00 to 09:00 UTC and the second from
05:00 to 06:00 UTC, which correspond to the intervals
reported by many server operators.
The highest forwarding anomaly magnitude for AS25152
is recorded on November 30th at 08:00 and is negative
(mag(X) = −0.5), meaning that only a few packets
have been dropped in ASs hosting root servers. These
observations match the server operators’ reports and
emphasize the strength of anycast in mitigating such
attacks.
In-depth analysis: K-root. A key advantage of our
method is reporting delay changes per link, allowing
us to precisely locate the eﬀects of the two attacks in
10
Nov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 2015−4−2024681012Differential RTT (ms)193.0.14.129 (K-root) - 74.208.6.124 (1&1, Kansas City)Median Diff. RTTNormal ReferenceDetected AnomaliesNov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 2015−0.04−0.020.000.020.040.060.080.100.120.14Differential RTT (ms)193.0.14.129 (K-root) - 212.191.229.90 (Poznan, PL)Nov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 2015−20−15−10−505Differential RTT (ms)193.0.14.129 (K-root) - 80.81.192.154 (RIPE NCC @ DE-CIX)Nov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 2015−6−5−4−3−2−101Differential RTT (ms)188.93.16.77 (Selectel, St. Petersburg) - 193.0.14.129 (K-root)Nov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 2015−10−5051015202530Differential RTT (ms)72.52.92.14 (HE, Frankfurt) - 80.81.192.154 (RIPE NCC @ DE-CIX)Nov 26 2015Nov 27 2015Nov 28 2015Nov 29 2015Nov 30 2015Dec 01 20152345678910Differential RTT (ms)188.93.16.77 (Selectel, St. Petersburg) - 95.213.189.0 (Selectel, Moscow)Not only are the last hops to K-root instances de-
tected by our method; we also observe other links with
important delay changes. Figure 7e depicts a link in the
Deutscher Commercial Internet Exchange (DE-CIX) which
is upstream of the K-root instance in Frankfurt (Fig. 7c).
This link between Hurricane-Electric (AS6939) and the
K-root AS exhibits a 15ms delay change (diﬀerence be-
tween the median diﬀerential RTT and the reference
median) during the ﬁrst attack. The upstream link of
the instance in St.Petersburg (Fig. 7f) is also signiﬁ-