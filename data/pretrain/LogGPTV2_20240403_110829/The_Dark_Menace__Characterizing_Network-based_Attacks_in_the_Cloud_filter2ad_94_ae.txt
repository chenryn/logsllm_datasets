bound attacks are against services in big clouds. Most of these at-
tacks are SQL injection and TDS attacks. Small ISPs and customer
networks face 25% and 13% of the outbound attacks (Figure 15a),
but individual ASes do not generate many attacks (less than 0.01%
of the total outbound attacks per AS) (Figure 15b). Small ISPs and
customer networks are the major target for brute-force attacks and
spam. This is probably because these networks often lack strong se-
Figure 16: Top Internet applications under outbound attacks.
curity support. For example, 23.6% of the outbound DNS reﬂection
attack packets are sent to an ISP in France. It is therefore important
to coordinate security measures across the cloud infrastructure and
these networks to protect against these attacks.
There are only a few brute-force attacks against mobile networks
(1.4%). This may be because mobile devices are often behind a
NAT preventing them from unsolicited connections, which makes
it harder for attacks to get through.
Internet applications under attack: To understand the Internet
applications under attacks, we investigate the destination port of
outbound trafﬁc coming from the VIPs generating outbound attacks
(Figure 16). We ﬁnd that most of the outbound attacks target web
services (HTTP/HTTPS together form 64.5% of the attack VIPs in-
volved with outbound attacks). For example, 69% of the outbound
UDP ﬂoods use port 80 as the destination port targeting HTTP ser-
vices. The other popular target services are SQL, SMTP, and SSH.
Geolocation distribution of outbound attacks: Outbound attack
targets are mainly spread across places in Europe and North Amer-
ica (Figure 14b). There are less outbound attack targets than in-
bound attack sources in Eastern Asia. The same AS in Spain we
discussed in inbound attacks also receives more than 35% of out-
bound attacks (mainly with brute-force, TDS, and SQL attacks).
7. EXISTING SECURITY PRACTICES
In this section we discuss how existing cloud security solutions
handle the types of attacks observed in our study.
Inbound TCP SYN, UDP, ICMP ﬂoods, DNS reﬂection attacks:
Cloud VMs are only accessible through virtual IPs (VIPs). Trafﬁc
towards VIPs is routed through a load-balancing infrastructure [42].
At the infrastructure, the cloud can monitor, detect and mitigate
ﬂood attacks (e.g., using SYN cookies, rate limiting, and connec-
tion limits) to help ensure that such attacks do not impact cus-
tomer VM instances [7]. The tenants can also leverage scale-out
(e.g., adding more VMs on demand) or scale-up (e.g., deploying
resource-rich VMs) techniques to raise the bar for attacks [4].
There are multiple in-built mechanisms in cloud systems to safe-
guard tenants. For example, the hypervisor that hosts guest VMs in
the cloud is neither directly addressable internally by other tenants
nor it is externally addressable. Additional ﬁlters are put in place
to block broadcast and multicast trafﬁc, with the exception of what
is needed to maintain DHCP leases. Inside the VMs, tenants can
further enable web server add-ons that protect against certain DoS
attacks [41]. For example, for TCP SYN ﬂooding attacks, a security
rule can be speciﬁed to track signiﬁcant deviations from the norm
in terms of the number of half-open TCP sessions, and then drop
any further TCP SYN packets from speciﬁed sources [5].
 0 5 10 15 20 25 30 35 40 45BigCloudSmallCloudMobileLargeISPSmallISPCustomerEDUIXPNICPercentage(%) 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7BigCloudSmallCloudMobileLargeISPSmallISPCustomerEDUIXPNICPercentage (%) 0 100 200 300 400 500 600 700 800 900 1000 1100HTTPHTTPSSQLSMTPSSHRDPVNC#VIPs180Port scan: Unauthorized port scans are often viewed as a violation
of cloud use policy and they are blocked by the cloud provider [3].
Port scans are likely to have limited effectiveness because, by de-
fault, all the inbound ports on VMs are closed except the ones
opened by tenants; a tenant can author a service deﬁnition ﬁle that
contains the internal endpoints that should be opened in service
VMs and what roles can communicate with them [8]. Tenants can
also use security groups or ﬁrewalls to further block unauthorized
trafﬁc [41].
Other inbound attacks: Some cloud providers choose not to ac-
tively block network trafﬁc affecting individual tenants because the
infrastructure does not interpret the expected behavior of customer
applications. Instead, these cloud systems allow tenants to use ﬁre-
wall proxy devices such as Web Application Firewalls (WAFs) that
terminate and forward trafﬁc to endpoints running in a VM. Ten-
ants can also use network ACLs or VLANs to prevent packets from
certain IP addresses from reaching VMs [7].
Cloud providers can also leverage high-level signals emitted from
workloads running on the cloud from customer accounts. One such
signal is the number of open ports. Legitimate customers aim to
minimize the susceptibility of their applications running in the cloud
to any external attacks, and hence deploy services usually with a
limited number of open ports (e.g., HTTP port 80). However, com-
promised accounts or VMs may perform a variety of anomalous
activities such as running a Botnet controller or torrent services on
multiple open ports. The cloud security team monitors such activi-
ties and aggressively shuts down any misbehaving tenant VMs.
Outbound attacks: To mitigate outbound attacks, the most impor-
tant step is to identify fraudulent VMs when a tenant sets up a sub-
scription. In the cloud, several anti-fraud techniques are used such
as credit card validation, computing the estimated geographical dis-
tance from the IP address used for login to the billing address and
ensuring it is within reasonable bounds, and determining whether
the email address of the purchaser is from a free email provider.
Note that attackers can also exploit vulnerabilities in VMs of le-
gitimate customers.
If an attack is successful, the compromised
VMs can then be used by attackers for malicious activity e.g., to
send large amounts of unsolicited mail (spam). The cloud provider
can enforce limits on how many emails a VM can send as well as
prevent SMTP open relay, which can be used to spread spam [5].
8. RELATED WORK
This paper presented one of the ﬁrst large-scale studies to inves-
tigate the prevalence of network-based attacks in the cloud. We
compare our work with related work on detecting and understand-
ing Internet-based attacks.
Attack detection methods: Previous works have used NetFlow
logs to understand DDoS attacks and trafﬁc anomalies [38, 22, 36,
35] in ISP networks. Our work takes a similar approach to under-
stand a broader set of attacks in the cloud. Most previous stud-
ies on application-level attacks leverage analysis of the application
content (e.g., spam [15, 25], SQL injection [18], SSH [32]). Our
work shows that it is possible to detect some of these attacks by
leveraging network-level signatures such as volumes, spread, TCP
ﬂags, and communication patterns. In fact, previous works have
also shown that application-level attacks (e.g., spam) have strong
network-level signatures [46]. We validate our network-based de-
tection by comparing the detected attacks against the security ap-
pliance alerts and incident reports. Although network-based de-
tection may not capture all types of application-level attacks (e.g.,
malware), they are more pragmatic to implement in today’s cloud
monitoring infrastructure.
Attack characterization: There is a large body of work on char-
acterizing Internet-based attacks. Most prior efforts (e.g., [10, 13,
17, 40, 46, 51]) focus on one or a few types of attacks in the In-
ternet. Given the importance of cloud services in today’s Internet,
understanding the attacks from/to the cloud is critical. Our study in-
vestigates a wide diversity of inbound and outbound attacks in the
cloud. We differentiate DDoS attacks based on their protocols (TCP
SYN, UDP, DNS reﬂection), and show that other types of attacks
(e.g., brute-force, port scans, and TDS) also need cloud operator’s
attention. Moreover, we show the detailed characteristics of attacks
in the cloud such as the cloud services affected by the attacks, the
Internet origins and targets, and the intensity and frequency of these
attacks. These results can provide guidelines for future design of at-
tack detection and mitigation systems for the cloud.
9. CONCLUSION
We investigated the prevalence of network-based attacks both on
and off the cloud. We performed the ﬁrst measurement study of
the characteristics of a wide range of cloud attacks that vary in
complexity, intensity, duration and distribution. Our study shows
a strong evidence of increasing scale, attack volume, and sophisti-
cation of these attacks. Our results have been leveraged by the cloud
security team towards identifying correlations and improving miti-
gations for different attack types. We hope that this study motivates
future research towards designing attack detection and mitigation
systems for the cloud. In future work, we plan to extend our mea-
surement study to analyze application level attacks, compare across
attack categories and leverage packet traces for deeper analysis.
Acknowledgment
We thank Ramesh Govindan, Cormac Herley, Jelena Mirkovic, Vivek
Narassaya, Jitu Padhye, Jay Stokes, Alec Wolman, and the anony-
mous reviewers for their insightful feedback and suggestions. This
work is supported in part by the NSF grants CNS-1423505, CNS-
1413972, and DHS-D15PC00184.
10. REFERENCES
[1] http:
//www.everestgrp.com/2015-04-40-billion-
global-cloud-services-market-expected-
to-grow-27-percent-per-annum-for-next-3-
years-press-release-17218.html.
[2] Amazon web services. http://aws.amazon.com/.
[3] Amazon Web Services: Overview of Security Processes.
https://d0.awsstatic.com/whitepapers/
Security/AWS%20Security%20Whitepaper.pdf.
[4] AWS Best Practices for DDoS Resiliency.
https://d0.awsstatic.com/whitepapers/
DDoS_White_Paper_June2015.pdf.
[5] AWS Security Best Practices.
https://d0.awsstatic.com/whitepapers/
aws-security-best-practices.pdf.
[6] http://nmap.org/book/man-port-scanning-techniques.html.
[7] Microsoft Azure Network Security Whitepaper.
http://blogs.msdn.com/b/azuresecurity/
archive/2015/03/03/microsoft-azure-
network-security-whitepaper-version-3-
is-now-available.aspx.
[8] https://msdn.microsoft.com/en-us/
library/azure/ee758711.aspx.
[9] juno.c. http://goo.gl/i1Qodc, 2013.
181[10] Q4 2013 global ddos attack report.
http://goo.gl/lIyRmK, 2013.
[11] Quova. http://www.quova.com, 2013.
[12] S. Ali, I. U. Haq, S. Rizvi, N. Rasheed, U. Sarfraz, S. A.
Khayam, and F. Mirza. On Mitigating Sampling-induced
Accuracy Loss in Trafﬁc Anomaly Detection Systems. ACM
SIGCOMM Computer Communication Review 2010.
[13] M. Allman, V. Paxson, and J. Terrell. A Brief History of
Scanning. In IMC, 2007.
[14] Andrew Marshall, Michael Howard, Grant Bugher, Brian
Harden. Security Best Practices For Developing Windows
Azure Applications. http://download.microsoft.
com/documents/uk/enterprise/88_security_
best_practices_for_developing_windows_
azure_applicat.pdf.
[15] I. Androutsopoulos, J. Koutsias, K. V. Chandrinos,
G. Paliouras, and C. D. Spyropoulos. An Evaluation of Naive
Bayesian Anti-Spam Filtering. Proceedings of the workshop
on Machine Learning in the New Information Age, 11th
European Conference on Machine Learning, 2000.
[16] C. Anley. Advanced SQL Injection in SQL Server
Applications. In Next Generation Security Software Ltd,
2002.
[17] Arbor Networks. Insight into the global threat landscape.
http://goo.gl/15oOx3, February 2013.
[18] S. Bandhakavi, P. Bisht, P. Madhusudan, and V. N.
Venkatakrishnan. CANDID: Preventing SQL injection
attacks using dynamic candidate evaluations. ACM CCS,
2007.
[19] M. Basseville and I. Nikiforov. Detection of Abrupt Changes:
Theory and Application. Prentice Hall Englewood Cliffs,
1993.
[20] Bloomberg. Sony Network Breach Shows Amazon Clould’s
Appeal for Hackers. http://goo.gl/3WiAaj, 2011.
[21] G. Booth, A. Soknacki, and A. Somayaji. Cloud Security:
Attacks and Current Defenses. In ASIA, 2013.
[22] D. Brauckhoff, B. Tellenbach, A. Wagner, M. May, and
A. Lakhina. Impact of packet sampling on anomaly detection
metrics. In IMC, 2006.
[23] J. Caballero, C. Grier, C. Kreibich, and V. Paxson. Measuring
pay-per-install: The commoditization of malware
distribution. In USENIX Conference on Security, 2011.
[24] E. Cambiaso, G. Papaleo, and M. Aiello. Taxonomy of Slow
DoS Attacks to Web Applications. In TCNDSS. Springer,
2012.
[25] X. Carreras and L. Marquez. Boosting Trees for Anti-Spam
Email Filtering. Proceedings of RANLP, 2001.
[26] R. Chaiken, B. Jenkins, P.-A. Larson, B. Ramsey, D. Shakib,
S. Weaver, and J. Zhou. SCOPE: Easy and Efﬁcient Parallel
Processing of Massive Data Sets. VLDB’08.
[27] X. Dimitropoulos, D. Krioukov, G. Riley, and k. claffy.
Revealing the Autonomous System Taxonomy: The Machine
Learning Approach. In Passive and Active Network
Measurement Workshop (PAM), 2006.
[28] N. R. Draper, H. Smith, and E. Pownell. Applied regression
analysis. Wiley New York, 1966.
[29] Google. Malware Distribution by Autonomous System.
http://goo.gl/mZQeG4, 2013.
[30] C. Grier, L. Ballard, et al. Manufacturing Compromise: The
Emergence of Exploit-As-A-Service. In CCS, 2012.
[31] L. Hellemons. Flow-based detection of ssh intrusion
attempts. Scanning, 2012.
[32] M. Javed and V. Paxson. Detecting Stealthy, Distributed SSH
Brute-forcing. CCS, 2013.
[33] C. Kanich, N. Weaver, D. McCoy, T. Halvorson, C. Kreibich,
K. Levchenko, V. Paxson, G. M. Voelker, and S. Savage.
Show Me the Money: Characterizing Spam-Advertised
Revenue. In USENIX SEC, 2011.
[34] R. Kawahara, K. Ishibashi, T. Mori, N. Kamiyama,
S. Harada, and S. Asano. Detection accuracy of network
anomalies using sampled ﬂow statistics. In GLOBECOM ’07.
IEEE.
[35] A. Lakhina, M. Crovella, and C. Diot. Diagnosing
network-wide trafﬁc anomalies. In SIGCOMM, 2004.
[36] A. Lakhina, M. Crovella, and C. Diot. Mining anomalies
using trafﬁc feature distributions. In SIGCOMM, 2005.
[37] Z. Li, S. Alrwais, Y. Xie, F. Yu, and X. Wang. Finding the
Linchpins of the Dark Web: A Study on Topologically
Dedicated Hosts on Malicious Web Infrastructures. In
Security and Privacy (SP), IEEE Symposium on, 2013.
[38] Z. M. Mao, V. Sekar, O. Spatscheck, J. van der Merwe, and
R. Vasudevan. Analyzing large DDoS attacks using multiple
data sources. In SIGCOMM Workshop on Large-scale Attack
Defense, 2006.
[39] J. Mirkovic and P. Reiher. A Taxonomy of DDoS Attack and
DDoS Defense Mechanisms. SIGCOMM CCR, 2004.
[40] D. Moore, C. Shannon, D. J. Brown, G. M. Voelker, and
S. Savage. Inferring Internet Denial-Of-Service Activity.
ACM Transactions on Computer Systems, 2006.
[41] C. Nelson. Best practices to protect your azure deployment
against “cloud drive-by” attacks.
http://blogs.msdn.com/b/azuresecurity/
archive/2015/07/05/best-practices-to-
protect-your-azure-deployment-against-
cloud-drive-by-attacks.aspx.
[42] P. Patel, D. Bansal, L. Yuan, A. Murthy, A. Greenberg, D. A.
Maltz, R. Kern, H. Kumar, M. Zikos, H. Wu, et al. Ananta:
Cloud Scale Load Balancing. In ACM SIGCOMM, 2013.
[43] V. Paxson, G. Almes, J. Mahdavi, and M. Mathis. Framework
for IP performance metrics. In RFC 2330, 1998.
[44] A. Pitsillidis, C. Kanich, et al. Taster’s Choice: A
Comparative Analysis of Spam Feeds. In IMC, 2012.
[45] R. Potharaju, N. Jain, and C. Nita-Rotaru. Juggling the
jigsaw: Towards automated problem inference from network
trouble tickets. In NSDI’13.
[46] A. Ramachandran and N. Feamster. Understanding the
network-level behavior of spammers. In SIGCOMM, 2006.
[47] B. Ridgway. Security best practices for windows azure
solutions. Azure Manual, 2014.
[48] V. Sekar, N. G. Dufﬁeld, O. Spatscheck, J. E. van der Merwe,
and H. Zhang. LADS: Large-scale automated DDoS
detection system. In USENIX ATC, 2006.
[49] B. Stone-Gross, T. Holz, G. Stringhini, and G. Vigna. The
underground economy of spam: A botmaster’s perspective of
coordinating large-scale spam campaigns. USENIX Workshop
on Large-Scale Exploits and Emergent Threats (LEET), 2011.
[50] V. Yegneswaran, P. Barford, and S. Jha. Global intrusion
detection in the domino overlay system. In NDSS, 2004.
[51] V. Yegneswaran, P. Barford, and J. Ullrich. Internet
intrusions: Global characteristics and prevalence. In ACM
SIGMETRICS 2003.
182