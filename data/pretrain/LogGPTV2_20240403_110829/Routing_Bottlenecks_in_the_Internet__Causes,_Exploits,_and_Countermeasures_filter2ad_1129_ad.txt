tack tra(cid:14)c appreciably.
5. COUNTERMEASURES
Defenses against attacks exploiting routing bottlenecks
range from some intuitive but na(cid:127)(cid:16)ve approaches, which will
not work well, to some which will, namely structural coun-
termeasures and operational countermeasures. We summa-
rize these countermeasures, discuss their deployment chal-
lenges, and brie(cid:13)y evaluate their e(cid:11)ectiveness. Naturally,
defense mechanisms for server-(cid:13)ooding attacks (viz., [16])
are irrelevant to this disussion.
5.1 Naïve Approaches
The na(cid:127)(cid:16)ve approaches presented here are the most proba-
ble responses that the current networks would perform once
the degradation attacks hit the routing bottleneck of any
target region.
Local rerouting: Targeted networks can reactively change
routes crossing (cid:13)ooded links so that the (cid:13)ooding tra(cid:14)c (in-
cluding both legitimate and attack (cid:13)ows that are indistin-
guishable form legitimete (cid:13)ows) is distributed over multiple
other local links. However, this might cause more collateral
damage on the other local links after all.
Tra(cid:14)c-intensity based (cid:13)ow (cid:12)ltering: Typical miti-
gations for volumetric DDoS attacks detect and (cid:12)lter long-
lived large (cid:13)ows only because otherwise they cannot run in
real-time in large networks [26]. This countermeasure can-
not detect nor (cid:12)lter attack (cid:13)ows in bottleneck links because
these could be low-rate and thus indistinguishable from le-
gitimate.
Using backup links: Typical backbone links are pro-
tected by the backup links, such that whenever links are
cut, the backup links seamlessly continue to convey tra(cid:14)c.
However, backup links cannot counter link-(cid:13)ooding attacks
because they could be (cid:13)ooded too.
5.2 Structural Countermeasures
Structural countermeasures range from changes of physi-
cal Internet topology to those of inter-AS relationships. Al-
though this type of countermeasures might have practical
(e.g., business or legal) limitations, it could widen routing
bottlenecks signi(cid:12)cantly. For example, if a country is con-
nected to the rest of the world via only a handful of market-
dominating ISPs, no matter how well routes are distributed,
the country would inevitably experience routing bottlenecks.
To widen these bottlenecks, the country would have to in-
crease its route diversity to the outside world.
Fig. 12 illustrates the proposition that structural changes
could be a fundamental solution to the routing bottleneck
problem. The x-axis is the metric called AS-level route di-
versity and it is calculated as
fnumber of intermediate ASesg
faverage AS hops from Tier-1 ASes to target regiong ;
(4)
8
Number of Links to Flood, (|B|)Degradation Ratio (δ(S,D)(B))Legend:10305000.20.40.60.81Country15α=2.3610305000.20.40.60.81Country14α=2.3210305000.20.40.60.81Country13α=2.3110305000.20.40.60.81Country12α=1.8610305000.20.40.60.81Country11α=1.8510305000.20.40.60.81Country10α=1.8210305000.20.40.60.81Country9α=1.7610305000.20.40.60.81Country8α=1.6010305000.20.40.60.81Country7α=1.4810305000.20.40.60.81Country6α=1.4010305000.20.40.60.81Country5α=1.3810305000.20.40.60.81Country4α=1.3610305000.20.40.60.81Country3α=1.3310305000.20.40.60.81Country2α=1.3210305000.20.40.60.81Country1α=1.31  CalculatedDegradationRatioCDF ofZipf−Mandelbrot(β = 7.8)Intra-domain load balancing
tiple AS-level route with di(cid:11)erent next-hop ASes [55]. The
speci(cid:12)c design of such mechanisms is beyond the scope of
this paper.
5.3.2
Intra-domain load balancing can be an e(cid:11)ective counter-
measure because any balanced link cannot be the bottle-
neck.18 Today’s networks (especially, large ISPs) deploy
intra-domain load-balancing mechanisms, such as Equal-Cost
Multi-Path (ECMP) algorithm [20] and thus approximately
40% of Internet routes experience load balancing [6].
However, contrary to our expectation, we found that about
30% of the bottleneck links are located within Tier-1 or Tier-
2 networks; viz., Section 2.4.1. This insu(cid:14)cient load balanc-
ing is caused by the inherent limitation of ECMP. That is,
ECMP cannot balance all links in the network because it
would be impossible to assign link weights in such a way
that all routes have at least one alternate equal-cost route.
Thus, ECMP alone cannot completely remove the potential
bottleneck links in the networks.
To prevent the degradation attacks from targeting their
internal links, large ISPs should identify commonly used but
not load-balanced links and dynamically recon(cid:12)gure their
networks (e.g., by updating link weights) so that the identi-
(cid:12)ed links are load-balanced with other links.
5.3.3 Automated intra-domain trafﬁc engineering
One of the most widely used tra(cid:14)c engineering mecha-
nisms is MPLS. As of 2013, at least 30% of Internet routes
travel through MPLS tunnels [10] and they are mostly de-
ployed in the large ISPs. Unlike the local rerouting solution
discussed in Section 5.1, MPLS recon(cid:12)guration can perform
(cid:12)ne-grained tra(cid:14)c steering to avoid collateral damage on the
other links.
However, the widely used o(cid:15)ine MPLS recon(cid:12)guration
cannot be very e(cid:11)ective since it can recon(cid:12)gure tunnels only
on a time scale ranging from tens of minutes to hours and
days [13, 52]. Worse yet, the online MPLS recon(cid:12)gura-
tion, called the auto-bandwidth mechanism [36], which au-
tomatically allocates required bandwidth to each tunnel and
change routes, is susceptible to sustained congestion since it
cannot detect congestion directly but only via reduced traf-
(cid:12)c rates caused by congestion. Thus, even auto-bandwidth
mechanism would require human intervention to detect link-
(cid:13)ooding attacks [44] thereby slowing reaction time consid-
erably. Therefore, large ISPs need an automated control
system that monitors link congestion and quickly recon(cid:12)g-
ures the related MPLS tunnels to be steered through other
underutilized links.
5.3.4 Effectiveness of operational countermeasures
We evaluate the reduction of degradation ratios due to the
following four defense strategies using the operational coun-
termeasures: (1) inter-domain load balancing at all inter-AS
links, (2) intra-domain load-balancing and tra(cid:14)c engineer-
ing at all intra-AS links, (3) all operational countermeasures
at all Tier-1 ASes, and (4) all operational countermeasures
at all Tier-1 and Tier-2 ASes. Fig. 13 shows the reduc-
tion of degradation ratios in percentage for 15 countries.19
It shows that the defense strategies that protect a speci(cid:12)c
18Notice that we remove any load-balanced links from our
traceroute dataset for this reason (viz., Section 2.1).
19We do not (cid:13)ood a link when its link type is not determined.
9
Figure 12: Correlation between power-law expo-
nent and AS-level route diversity in 15 countries.
(Legend: number i = Countryi, for i = 1;(cid:1)(cid:1)(cid:1) ; 15)
where the intermediate ASes are the ASes that connect the
Tier-1 ASes with ASes located within each target region.17
Ratio (4) is a good proxy for measuring the AS-level route
diversity because it represents the average number of possi-
ble ASes at every AS hop from the Tier-1 ASes to the target
region. The y-axis is the power-law exponent (cid:11) obtained in
Section 4.2. We see the clear correlation between the AS-
level route diversity and the power-law exponent for the 15
countries, which supports our claim that the more AS-route
diversity, the lower the power-law exponent. Moreover, we
(cid:12)nd the average AS-level route diversity of the seven Euro-
pean countries (i.e., 15.9) is more than two times larger than
that of the rest of the countries (i.e., 7.7). We believe that
this is because the market for ISPs in Europe is more com-
petitive and thus providing more ISP choices for the Internet
connectivity [14].
There exist various non-technical ways to increase the AS-
level route diversity for a target region; e.g., regional regula-
tory authorities could encourage market entry by new ISPs;
addition of new peerings to promote competition, or intro-
duce new regulatory regimes that promote route diversity.
5.3 Operational Countermeasures
Operational countermeasures could improve the manage-
ment plane of various routing protocols (e.g., BGP or OSPF)
to either decrease the skew of link-occurrence distribution or
better react to the exploits. Since this type of countermea-
sures does not change the network structure, it can be much
easily implemented in practice.
5.3.1 Inter-domain load balancing
As seen in Section 2.4.1, about 30% of the bottleneck links
are inter-AS links. When an inter-AS link is being (cid:13)ooded,
at least one of the ASes should be able to quickly redirect
the (cid:13)ooding tra(cid:14)c to relieve the severe congestion. However,
a typical inter-AS inbound tra(cid:14)c engineering via tweaking
BGP announcement [22] would be too slow due to the long
BGP convergence time (e.g., 30 minutes [31]). Moreover,
the outbound inter-AS level redirection can only be man-
ually con(cid:12)gured because inter-AS links are selected by the
coupling of BGP and IGP (e.g., OSPF) protocols [47]. This
coupling is (re)con(cid:12)gured by human operators when it be-
comes necessary to di(cid:11)use (cid:13)ooding tra(cid:14)c [50].
In principle, an automated mechanism is needed to adap-
tively utilize multiple parallel inter-AS links [50] and/or mul-
17The list of ASes within a target region are obtained from
http://www.nirsoft.net/countryip/.
5101520251.21.41.61.822.22.4941321156710138151412AS−level route diversityPower−law exponent (α)Faloutsos et al. analyzed a massive amount of tracer-
oute data and concluded that the node degree of the routers
and ASes have power-law distribution [11]. Albert et al.
con(cid:12)rmed the power-law behavior of the node-degree dis-
tribution and concluded that the Internet su(cid:11)ers from an
‘Achilles’ heel’ problem; i.e., targeted removal attacks against
the small number of hub nodes with high node degree will
break up the entire Internet into small isolated pieces [4].
The Achilles’ heel argument has triggered several counter-
arguments. Some (cid:12)nd that node-removal attacks are unre-
alistic because the number of required nodes to be removed
is impractically high [28, 53]. Li et al. argue that the power-
law behavior in node-degree distribution does not necessarily
imply the existence of hub nodes in the Internet by showing
that power-law node-degree distribution can be generated
without hub nodes [27].
Our routing-bottleneck study discovers a new power-law
distribution in the Internet. However, this power-law is com-
pletely di(cid:11)erent from that of the above-mentioned work for
two reasons. First, we measure a power law for the link
usage in Internet routes whereas the above-mentioned work
(cid:12)nds power laws in the node-degree distribution. Second,
the scope of out our power-law analysis is di(cid:11)erent; i.e., it is
focused on, and limited to, a chosen route-destination region
whereas the above-mentioned work analyzes the power-law
characteristics of the entire Internet.
6.3 Bandwidth Bottleneck Studies
In the networking research, the term ‘bottleneck’ has been
traditionally used to represent the link with the smallest
available bandwidth on a route, i.e., the link that deter-
mines the end-to-end route throughput. To distinguish it
from a routing bottleneck, we call this link the bandwidth
bottleneck. Several attempts have been made to measure
bandwidth bottlenecks in the Internet; viz., BFind [3] and
PathNeck [21].
In contrast, routing bottlenecks are unrelated to the avail-
able bandwidth or provisioned link capacity, but closely re-
lated to the number of routes served by each link. In fact,
the (cid:13)ooding attacks described in Section 4 turn routing bot-
tleneck links into the bandwidth bottleneck links. In other
words, the routing bottlenecks are latent bandwidth bottle-
necks since they can always be exploited by an adversary
and converted into bandwidth bottlenecks.
6.4 Control-Plane and Link-Flooding Attacks
Attacks that cause instability of the control plane in In-
ternet routing [40] and link-(cid:13)ooding attacks [46, 24] have
been recently proposed and launched in real life already [7].
Closest to our work, the Cross(cid:12)re attack [24] presents the
speci(cid:12)c strategy to identify and (cid:13)ood a few targeted links for
eight selected target areas in the US. In contrast to Cross-
(cid:12)re, where the authors focus on the feasibility of (cid:13)ooding a
small set of critical links, our study explores a fundamental
vulnerability of today’s Internet, namely, pervasive routing
bottlenecks that can be exploited by any (cid:13)ooding attack. We
show the ubiquity of routing bottlenecks in various countries
and cities around the world via extensive measurements, and
identify their basic cause. We also explore the characteris-
tics of bottleneck links; e.g., link type and distance to tar-
gets. Lastly, we provide several practical countermeasures
against bottleneck-link exploits, which also address all cur-
rent attacks.
Figure 13: Reduction of degradation ratios due to
four defense strategies when 20 bottleneck links are
(cid:13)ooded for each of the 15 country.
type of links (i.e., strategy (1) and (2)) are not very e(cid:11)ec-
tive in general (approximately 20% reduction on average)
because adversaries can still (cid:12)nd bottleneck links from the
other types of links. However, the defense strategies de-
ployed by Tier-1 and/or Tier-2 ASes (i.e., strategy (3) and
(4)) show much higher e(cid:11)ectiveness: when all Tier-1 ASes
implement all the operational countermeasures, the degra-
dation ratio is reduced by 40%; and when all Tier-2 ASes
also join the defense, 72% of reduction is achieved on the
average. This con(cid:12)rms our previous observation that the
large Tier-1 and Tier-2 ASes are mainly responsible for the
routing bottlenecks.
5.4 Application Server Distribution
One might distribute application servers in di(cid:11)erent ge-
ographic locations (possibly using content distribution net-
works, e.g., Akamai [37]) to distribute routes. The appli-
cation servers have to be distributed in such a way that
inherent route diversity is fully utilized; i.e., analysis must
show that no routing bottleneck arise. However, this might
not be practical for some domains such as industrial process
systems, (cid:12)nancial services, or defense services where con-
strained geography may restrict application distributions.
These constraints may also limit the use of overlay networks
[5] and services [25].
6. RELATED WORK
6.1 Internet Topology Studies
A large volume of research investigates the topology of