title:Your Smart Home Can't Keep a Secret: Towards Automated Fingerprinting
of IoT Traffic
author:Shuaike Dong and
Zhou Li and
Di Tang and
Jiongyi Chen and
Menghan Sun and
Kehuan Zhang
Your Smart Home Can’t Keep a Secret:
Towards Automated Fingerprinting of IoT Traffic with Neural
Networks
Zhou Li
PI:EMAIL
University of California, Irvine
Di Tang
PI:EMAIL
The Chinese University of Hong Kong
Menghan Sun
PI:EMAIL
Kehuan Zhang
PI:EMAIL
The Chinese University of Hong Kong
The Chinese University of Hong Kong
KEYWORDS
IoT Security, Privacy, Neural Networks
ACM Reference Format:
Shuaike Dong, Zhou Li, Di Tang, Jiongyi Chen, Menghan Sun, and Kehuan
Zhang. 2019. Your Smart Home Can’t Keep a Secret: Towards Automated
Fingerprinting of IoT Traffic with Neural Networks. In Proceedings of ACM
Conference (Conference’17). ACM, New York, NY, USA, 12 pages. https:
//doi.org/10.1145/nnnnnnn.nnnnnnn
1 INTRODUCTION
The Internet of Things (IoT) have been gaining popularity increas-
ingly in recent years, and continue to expand in areas such as smart
homes, smart cities, industrial systems, connected health products,
and so on. According to reports from Forbes, the global IoT market
will grow from 157 billion US dollars in 2016 to 457 billion US dol-
lars by 2020, attaining a Compound Annual Growth Rate (CAGR)
of 28.5% [1].
Smart home is a prominent use case of IoT, where multiple IoT
devices work together to facilitate all kinds of user activities by
sensing surroundings, interpreting human commands and provid-
ing feedback. However, smart home can introduce new threats
to residents’ privacy. Since network packets between IoT device
and remote server can be eavesdropped, a motivated attacker can
leverage such data to infer private information about the residents,
like what IoT devices are installed and whether they are active.
Leaking such information would cause grave consequences to the
residents: e.g., a theft can break into the home when no one is inside
by learning the status of the installed smart switch.
This paper aims to assess the privacy threat to smart home
residents by evaluating different traffic-analysis approaches on
datasets carrying real IoT traffic. Though a few recent works also
investigated the privacy issues related to IoT network communica-
tions [9, 11, 37], those works all assume a local adversary (only the
traffic between IoT device and gateway can be sniffed) or relatively
simple network environment (e.g., traffic from devices can be easily
separated). Whether traffic analysis is effective under a remote ad-
versary or more complex network is not yet assessed. In particular,
we assume that the the gateway may enable configurations that are
common but hamper traffic analysis, like Virtual Private Network
(VPN) and Network Address and Port Translation (NAPT). Under
those settings, traffic flows belonging to different IoT devices could
be merged to a single flow and the valuable information from fields
9
1
0
2
g
u
A
1
3
]
R
C
.
s
c
[
1
v
4
0
1
0
0
.
9
0
9
1
:
v
i
X
r
a
Shuaike Dong
PI:EMAIL
The Chinese University of Hong Kong
Jiongyi Chen
PI:EMAIL
The Chinese University of Hong Kong
ABSTRACT
The IoT (Internet of Things) technology has been widely adopted
in recent years and has profoundly changed the people’s daily lives.
However, in the meantime, such a fast-growing technology has also
introduced new privacy issues, which need to be better understood
and measured.
In this work, we look into how private information can be leaked
from network traffic generated in the smart home network. Al-
though researchers have proposed techniques to infer IoT device
types or user behaviors under clean experiment setup, the effec-
tiveness of such approaches become questionable in the complex
but realistic network environment, where common techniques like
Network Address and Port Translation (NAPT) and Virtual Private
Network (VPN) are enabled. Traffic analysis using traditional meth-
ods (e.g., through classical machine-learning models) is much less
effective under those settings, as the features picked manually are
not distinctive any more.
In this work, we propose a traffic analysis framework based on
sequence-learning techniques like LSTM and leveraged the tempo-
ral relations between packets for the attack of device identification.
We evaluated it under different environment settings (e.g., pure-IoT
and noisy environment with multiple non-IoT devices). The results
showed our framework was able to differentiate device types with
a high accuracy. This result suggests IoT network communications
pose prominent challenges to users’ privacy, even when they are
protected by encryption and morphed by the network gateway. As
such, new privacy protection methods on IoT traffic need to be
developed towards mitigating this new issue.
CCS CONCEPTS
• Security and Privacy → Traffic Analysis.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
Conference’17, July 2017, Washington, DC, USA
© 2019 Association for Computing Machinery.
ACM ISBN 978-x-xxxx-xxxx-x/YY/MM...$15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn
Conference’17, July 2017, Washington, DC, USA
Shuaike Dong, Zhou Li, Di Tang, Jiongyi Chen, Menghan Sun, and Kehuan Zhang
like destination ports could be erased. Still, our study shows by
exploiting the temporal relations between packets of an individual
device, the device can be reliably identified.
More specifically, we found such temporal relations can be mod-
eled by sequence model LSTM-RNN when grouping consecutive
packets into a traffic window. We carefully designed the structure
of both models and evaluated on two datasets filled with traffic
generated from off-the-shelf IoT devices and non-IoT devices. The
evaluation results show our models can achieve better accuracy
comparing to the models widely used by existing works, like Ran-
dom Forest. To highlight a few, our bidirectional LSTM model can
achieve an accuracy of 99.2% and 97.7% on IoT devices in NAPT and
VPN configuration. Even when a large-amount of non-IoT traffic
are generated at the same time, it can still achieve 92.1% and 81.0%
accuracy in these two configurations.
Contributions. We summarize the technical contributions made
by this work as below.
(1) We present a traffic-analysis system, HomeMole, to automat-
ically infer the IoT devices behind a smart home network
even when traffic fusion like NAPT and VPN are enabled.
We designed a basic LSTM model and a bidirectional LSTM
model that are able to identify IoT devices based on the
sniffed packets.
(2) We evaluated our system under two network configurations
(NAPT and VPN) and two scenarios (pure-IoT and noisy
environment). The results indicate that our framework could
achieve high accuracy under those settings. Our models
outperform the baseline model, Random Forest, due to the
ability of modeling the temporal relations between packets.
To facilitate the research in this domain, we will release our
datasets, together with models we built. We believe by releasing
datasets and models, we could help other researchers to investigate
new traffic-analysis methods and IoT community to build better
defense.
Paper organization. The paper is organized as follows: Section 2
presents the background about the relevant previous work, smart
home network, our adversary model and neural networks used
in our paper. Section 3 describes the insights into IoT traffic, and
the design of our framework. Section 4 presents the experimental
results of our framework in different scenarios. Section 5 discusses
the limitations of this work. In the end, we conclude this study in
Section 6.
2 BACKGROUND
2.1 Related Work
Network traffic classification. Network traffic analysis has been
shown reasonably effective when applied on anomaly detection [25,
46], software identification [10, 33, 34], individual user fingerprint-
ing [43, 44] and etc. At a high level, the techniques used in existing
applications fall into the following two directions: deep packet
inspection and side-channel inference.
Deep packet inspection(DPI) is effective for packet classification
and intrusion detection when the network traffic is unencrypted.
Bujlow et al. [14] conducted a comparison among 6 well-known
DPI tools and found that the commercial DPI tool achieves very
good performance in traffic classification. However, DPI-based ap-
proaches become ineffective when it applied on encrypted traffic.
A lot of works have been proposed to analyze such traffic [13, 17,
27, 40, 45] by utilizing the side-channel information and metadata,
like source and destination IP address, port and packet size. Apart
from that, previous works like [38] also show other side-channel
information, such as wireless signal strength and timing, can be
leveraged to infer user activities. Machine learning based tech-
niques have shown many successes for traffic classifications. For
example, Taylor et al. [42] proposed an identification framework
for smartphone apps called AppScanner, which extracts statistical
features from network flows for classification tasks. Trained by
different learning algorithms, AppScanner can reach a highest ac-
curacy of 99.8% on 110 Apps. Chen et al. [15] proposed an online
traffic classification framework which utilizes kernel methods and
deep neural networks. They tested their tool on 5 different pro-
tocols and 5 mobile applications and achieved 99.84% and 88.43%
correspondingly. However, those two approaches only works on
relatively simple network environment where none of NAT or VPN
is enabled.
Traffic classification in IoT domain. Following the rapid devel-
opment of the IoT ecosystem, how to characterize and fingerprint
of IoT devices has become a trending topic. There have been some
works on IoT traffic analysis [11, 12, 29, 30, 35, 37] proposed in
recent years. Siby et al. [35] captured radio signals emitted from
IoT devices and created a system to store and visualize the traffic.
Recently, Apthorpe et al. [11] performed case studies on four IoT
devices, and show they exhibit distinctive traffic features, which
could enable device identification and behavior inference. Marcus
et al. [30] extracted 23 features from raw packets including network
protocols from Link layer to Application layer, IP options, IP ad-
dresses and ports. However, part of their features are inaccessible in
our settings due to the adversary capabilities and complex network
configurations (NAPT, VPN). For example, ARP and LLC are only
capturable in local area network environment, SSDP and MDNS
protocols account for only small amount of traffic that cannot holis-
tically describe the network status. Compared with them, our model
only takes advantage of 10 features extracted from packet metadata
which are illustrated elaborately in Section 3. Sivanathan et al. [37]
collected network traces of more than 20 IoT devices in a campus
environment over 3 weeks and characterized the profiles of those
IoT devices according to their traffic patterns. It also relies on an
extensive feature engineering to select the salient features and some
of them become vain when a complex network setting is applied,
like NAPT and VPN.
2.2 Smart Home Network
We assume the network communication within a smart home in-
volves four parties: IoT device, service provider, gateway and the
user. The communication schema is illustrated in Figure 1. Below
we briefly overview their communication schema.
• The first type of IoT device senses the surrounding environ-
ment and sends notifications to its associated listeners, either
periodically or immediately when the event takes place. For
example, Samsung ST Motion Sensor detects when a person
approaches in proximity [8] and notifies other IoT devices.
Your Smart Home Can’t Keep a Secret:
Towards Automated Fingerprinting of IoT Traffic with Neural Networks
Conference’17, July 2017, Washington, DC, USA
Figure 1: Network structure of a typical smart home.
Another type of IoT device is IoT hub, which acts as the
“brain” (centroid controller) for other IoT devices (or IoT kits)
in the close range. IoT hub is necessary in order to control
IoT devices that use low-power protocols like BLE. Both
regular IoT device and IoT hub can be controlled by user’s
commands sent remotely or locally.
• The IoT device interacts with the service provider operated
by its manufacturer through Internet communications. The
service provider is responsible for request handling and re-
source relaying. To reduce the operational cost, many device
vendors have moved their services to the public cloud in-
frastructure and leverage the cloud analytics, like AWS IoT
Core [2], to process massive amount of IoT data.
• A gateway is a bridge between in-home IoT devices and the
remote service provider. A typical gateway (e.g., router) sup-
plies two types of interfaces for in-home devices, WLAN and