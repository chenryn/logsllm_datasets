Registrar
GoDaddy
Internet.bs
Enom
Total
New Renaming Idiom
EMPTY.AS112.ARPA
NOTAPLACETO.BE
DELETE-REGISTRATION.COM
NS
13,988
563
459
15,010
Domains
28,750
1,330
1,121
31,201
Table 6: Domains protected due to renaming idiom changes
as of September 2021.
7.1 Remediation of Existing Affected Domains
As we have explained, once renamed outside an EPP repository, a
host object cannot be subsequently modified (Section 2.4). Conse-
quently, existing sacrificial nameservers cannot simply be renamed
by registrars to fix vulnerable domains in a centralized fashion.
Instead, any fix requires individual actions for each hijackable do-
main (either by their registrars or registrants). To facilitate such
remediation, we notified the top ten registrars with the most af-
fected domains. Additionally, given the long tail of registrars with
affected domains, we collated per-registrar lists of the 54K hijack-
able domains and made them available, in November 2020, to the
registrar community via the DNS Abuse Working Group. At least
12 additional registrars availed themselves of the collated lists from
the working group. Since remediation of any form is a cost, we
were uncertain how such remediation would play out.
Since we were unable to get concrete communication from any
of the 22 registrars on their plan for tackling the affected domains,
we had to rely on indirect measures to ascertain impact. As one
measure of impact, Table 5 shows the change in number of affected
nameservers (down 9K from 36K) and domains (down 13K from
54K) roughly five months (Sep 2020 to Feb 2021) after we started no-
tifications to registrars.13 We cannot attribute all of these changes
to registrar actions since domains will expire naturally and some
domain holders may change their delegations organically. To ac-
count for this confound, we calculated the baseline rate of “organic”
expiration over the equivalent time period a year prior (Sept 2019
to Feb 2020). During that time, we saw the disappearance of 4K
sacrificial nameservers and 11K affected domains.
The significant relative improvement in remediation of hijack-
able sacrificial nameservers (i.e., 9K compared to 4K) is primarily
a result of action from GoDaddy. GoDaddy appears to have up-
dated delegations for hijackable domains that they controlled —
domains for which they are the current registrar — from their old
hijackable renaming to their new renaming idiom. Nearly 60% of
the domains remediated (7,877 out of 13,392) and 70% of hijackable
nameservers remediated (6,932 out of 9,757) were a result of such
actions from GoDaddy. Another notable, albeit smaller, remedi-
ation effort was from MarkMonitor who successfully remediated
roughly 200 domains (domains with significant brand names).
Interestingly, the smaller relative change in the number of af-
fected domains (13K compared to 11K) suggests that there is a
long tail of sacrificial nameservers affecting a few domains whose
remediation does not have much overall impact on the situation.
13Note that a sacrificial nameserver “disappears” when it loses all of its delegated
domains.
684
7.2 Preventing New Exposure
Of the six registrars that used a hijackable renaming idiom, we
were able to successfully notify the three with the largest impact:
GoDaddy, Enom, and Internet.bs. In response to our notifications,
all three registrars committed to adopting a non-hijackable domain
for their future renaming actions. Internet.bs chose a dedicated sink
domain notaplaceto.be for creating new sacrificial nameservers
going forward, as did Enom (using delete-registration.com for
this purpose). Finally, rather than designating a dedicated sink
domain, GoDaddy chose to create sacrificial nameservers under
empty.as112.arpa, originally envisioned as an anycast sink for
queries [1].14
Table 6 shows the breakdown of sacrificial nameservers created
under these new renaming idioms and the domains protected as a
result. As of September 2021, these modifications have prevented
the creation of roughly 15K hijackable sacrificial nameservers, thus
protecting over 31K domains.
7.3 Robust Long-term Fixes
The ubiquitous use of sink domains is a good short term fix. How-
ever, it is also inherently fragile as it relies on existing registrars to
maintain these special domains in perpetuity (as well as depending
on new registrars to adopt similar measures). Given the dynamism
in the registrar market it seems difficult to count on perfection
and, indeed, we have past evidence of registrars abandoning sink
domains in the past (Section 4). Moreover, because sink domains
concentrate dangling delegations, if one such domain is not re-
newed it could allow an attacker to control tens of thousands of
domains with a single registration.
As such, a more permanent solution to this problem likely re-
quires a change to the EPP standard. One potential change to the
EPP standard would be to require the use of a reserved TLD for re-
naming. The IETF-reserved .invalid TLD, first reserved in 1999 [9]
with additional guidance on its use published in 2013 [19], fits this
scenario perfectly. The use of .invalid is a promising solution as
it eliminates the non-renewal problem. In fact, the idea of creating
sacrificial nameservers under a reserved label motivated the use of
empty.as112.arpa by GoDaddy. However, because the as112.arpa
domain is anycast, it introduces some new risks. In particular, an at-
tacker controlling an AS112 anycast server could hijack all requests
in its vicinity and resolve all such delegations.15
14While this solution avoids the use of a sink domain it may introduce other risks
(Section 7.3).
15To
risk one could use DNSSEC to sign the
empty.as112.arpa zone, or use a new signed sibling zone in as112.arpa.
partially mitigate this
Risky BIZness
IMC ’21, November 2–4, 2021, Virtual Event, USA
A more ambitious approach would combine protocol and op-
erational changes to remove the underlying “garbage collection”
problem for deleted nameserver domains. In particular, by changing
the deletion rules in EPP — so that deletion of a domain also removes
all references (i.e., nameserver delegations) to any subordinate host
objects — would prevent the creation of new dangling delegations
inside an EPP repository. However, fully addressing inter-registry
links across EPP repositories (e.g., a nameserver domain in .com
that is used by domains in .org) would require a new mechanism
to report such domain deletions among registries so that they too
could automate the removal of links to deleted nameservers.
Based on our findings, the ICANN Security and Stability Ad-
visory Committee (SSAC) is considering the launch of a multi-
stakeholder effort to consider tradeoffs among proposed solutions
and, ultimately, to publish an advisory of recommended practice.
8 ETHICAL CONSIDERATIONS
We carefully designed our study to identify and address potential
ethical risks up front, evaluating potential harms through a conse-
quentialist lens. We believe that our work introduces no new harm
and, in fact, reduces the potential harm that would have existed
without our research.
First, this work primarily relied on publicly available datasets and
data that is implicitly public by virtue of how the DNS works (i.e., the
current resolution of a DNS name). Where we identified concrete
risks or harms (i.e., of domain hijacking) we reached out to affected
registrars and registries. Moreover, we worked with these commu-
nities not only to aid in mitigating currently exposed domains but
also to prevent future exposures via changes in operational practice.
Finally, we chose not to highlight currently vulnerable names in
this paper to avoid facilitating their exploitation.
Second, we designed our controlled experiment (Section 6.1) to
have zero impact on the .edu domain name in question. We selected
this particular domain because it did not have any operational
authoritative nameservers. Thus, the domain neither resolved nor
was used by the institution.16 To further reduce potential for impact,
we configured the sacrificial nameserver (under our control) to
return an A record if and only if the request originated from our
client IP address during a short testing window. All other queries
received no response (as they always had before). Thus, only in
our restricted environment did the sacrificial nameserver in our
control return a response. Given that we did not respond, the only
information that could have been revealed was the identity of the
recursive resolver trying to look up one of the associated domains.
While we believe such a risk is low, we further mitigated that
concern by deleting all log data (and hence any record of who looked
up the domain). We balanced this minimal residual risk against
the value in conducting this experiment, which we conducted to
validate our understanding of the problem, and that there were no
mechanisms that would prevent hijacking from succeeding.
Finally, because our Institutional Review Board (IRB) is focused
squarely on overseeing human subjects research (which this work
is not), they were in no position to give us independent oversight.
For this reason, we conferred with campus general counsel — whose
remit is broader than simply human subjects research — and re-
ceived their approval for our experimental design and its controls,
before any active measurements were conducted.
9 CONCLUSION
Our primary technical discovery in this work is how an unfore-
seen interaction between registrar operational practices and the
constraints of registry provisioning systems have made at least
a half million domains vulnerable to hijacking. This risk arises
from a long-standing undocumented registrar operational practice
that bypasses restrictions on domain deletion by first renaming
nameservers slated for removal. Moreover, these nameservers are
commonly renamed to point to domains in different TLDs in which
the registrar does not have interest or control. As a result of the
process, a simple re-registration of the deleted domain does not
address the vulnerability. This subtlety, combined with the fact that
affected domain owner’s nameserver records are modified with-
out their knowledge, make this vulnerability particularly insidious.
While most of the domains placed at risk in this manner are either
unpopular or moribund, some include sites where the names carry
reputation even if they do not receive much traffic (e.g., law en-
forcement, law offices, public health departments, and even parked
domains for popular brands in alternate TLDs).17 Our work pro-
vides a comprehensive picture of this long-standing vulnerability
and also describes how our outreach has led to changes in oper-
ational practices at registrars that should significantly minimize
these risks going forward.
10 ACKNOWLEDGMENTS
We thank our anonymous shepherd and reviewers for their insight-
ful and constructive suggestions and feedback. This work would
not have been possible without help from many individuals and or-
ganizations. We are indebted to Ian Foster for his help with CAIDA-
DZDB/DNS Coffee, and also thank Sean McNee, Jackie Abrams,
Ariella Robinson, and Susan Prosser from DomainTools for help
with additional data. At UCSD we thank Cindy Moore, Alistair King,
Bradley Huffaker, Daniel Andersen, and Paul Biglete for supporting
the software and hardware infrastructure for this project, and we
thank Daniel Park for his legal guidance.
We are also very appreciative of the thoughtful help and feedback
we have received from many sectors of the registrar and registry
community. We are particularly grateful to Brian Dickson for his
wisdom and insight with DNS arcana, Reg Levy for facilitating
remediation with registrars, and Duane Wessels and Joe Abley for
their insights from the registry perspective. We also are thankful to
Steven DeJong, Dave Knight, Volker Greimann, Elliot Noss, Owen
Smigelski, Tim April, Patrik Fältström, James Galvin, Mattijs Jonker,
Warren Kumari, Raffaele Sommese, and the ICANN Security and
Stability Advisory Committee for their help and feedback.
This work was supported in part by National Science Founda-
tion grants CNS-1629973, CNS-1705050, OAC-1724853, and OIA-
1937165, the Irwin Mark and Joan Klein Jacobs Chair in Information
and Computer Science, and generous support from Google.
However, this approach would require consensus in the AS112 and DNSOP community,
including IANA, and a revision of RFC 7534.
16The institution uses a related .com domain to host their content.
17Moreover, the accidental deletion of Namecheap nameservers affecting 1.6M do-
mains highlights that the risk is not limited to inexperienced domain owners.
685
IMC ’21, November 2–4, 2021, Virtual Event, USA
Akiwate, Savage, Voelker, and Claffy
REFERENCES
[1] J. Abley, B. Dickson, W. Kumari, and G. Michaelson. 2015. AS112 Redirection
Using DNAME. RFC 7535. https://rfc-editor.org/rfc/rfc7535.txt.
[2] Gautam Akiwate, Mattijs Jonker, Raffaele Sommese, Ian Foster, Geoffrey M.
Voelker, Stefan Savage, and KC Claffy. 2020. Unresolved Issues: Prevalence,
Persistence, and Perils of Lame Delegations. In Proceedings of the ACM Internet
Measurement Conference (IMC). Virtual Event.
[3] Eihal Alowaisheq, Siyuan Tang, Zhihao Wang, Fatemah Alharbi, Xiaojing Liao,
and XiaoFeng Wang. 2020. Zombie Awakening: Stealthy Hijacking of Active
Domains through DNS Hosting Referral. In Proceedings of the ACM SIGSAC
Conference on Computer and Communications Security (CCS). Virtual Event.
[4] Matthew Bryant. 2017. The .io Error – Taking Control of All .io Domains With
a Targeted Registration – The Hacker Blog. https://thehackerblog.com/the-io-
error-taking-control-of-all-io- domains-with-a-targeted-registration/.
[5] CAIDA and Ian Foster. 2020. CAIDA-DNS Zone Database (DZDB).
https:
//dzdb.caida.org.
[6] David Dagon. 2008. DNS Poisoning: Developments, Attacks and Research Direc-
tions. USENIX Security 2008, DNS Panel Talk. https://www.usenix.org/legacy/
events/sec08/tech/slides/dagon_slides.pdf.
[7] Department of Homeland Security. 2019. Emergency Directive 19-01: Mitigate
DNS Infrastructure Tampering. https://cyber.dhs.gov/ed/19-01/.
[8] DomainTools. 2020. Whois History. https://research.domaintools.com/research/
whois-history/.
[9] D. Eastlake and A. Panitz. 1999. Reserved Top Level DNS Names. RFC 2606.
[10] Let’s Encrypt. 2020. Challenge Types – DNS-01 Challenge. https://letsencrypt.
https://rfc-editor.org/rfc/rfc2606.txt.
org/docs/challenge-types/.
[11] S. Hollenbeck. 2009. Extensible Provisioning Protocol (EPP). RFC 5730. https:
//rfc-editor.org/rfc/rfc5730.txt.
[12] S. Hollenbeck. 2009. Extensible Provisioning Protocol (EPP) Domain Name
Mapping. RFC 5731. https://rfc-editor.org/rfc/rfc5731.txt.
[13] S. Hollenbeck. 2009. Extensible Provisioning Protocol (EPP) Host Mapping. RFC
5732. https://rfc-editor.org/rfc/rfc5732.txt.
[14] ICANN. 2020. Centralized Zone Data Service. https://czds.icann.org.
[15] Krebs on Security. 2019. A Deep Dive on the Recent Widespread DNS Hijack-
ing Attacks. https://krebsonsecurity.com/2019/02/a-deep-dive-on-the-recent-
widespread-dns- hijacking-attacks/.
[16] Daiping Liu, Shuai Hao, and Haining Wang. 2016. All Your DNS Records Point to
Us: Understanding the Security Threats of Dangling DNS Records. In Proceedings
of the ACM SIGSAC Conference on Computer and Communications Security (CCS).
ACM, Vienna, Austria, 1414–1425. https://doi.org/10.1145/2976749.2978387
[17] P. Mockapetris. 1987. Domain Names – Concepts and Facilities. RFC 1034.
https://rfc-editor.org/rfc/rfc1034.txt.
[18] P. Mockapetris. 1987. Domain Names – Implementation and Specification. RFC
1035. https://rfc-editor.org/rfc/rfc1035.txt.
[19] S. Cheshire and M. Krochmal. 2013. Special-Use Domain Names. RFC 6761.
https://rfc-editor.org/rfc/rfc6761.txt.
[20] Sooel Son and Vitaly Shmatikov. 2010. The Hitchhiker’s Guide to DNS Cache
Poisoning. In Proceedings of the 6th International ICST Conference (SecureComm).
Singapore, 466–483.
[21] Thomas Vissers, Timothy Barron, Tom Van Goethem, Wouter Joosen, and Nick
Nikiforakis. 2017. The Wolf of Name Street: Hijacking Domains Through Their
Nameservers. In Proceedings of the ACM SIGSAC Conference on Computer and
Communications Security (CCS). ACM, Dallas, TX, 957–970. https://doi.org/10.
1145/3133956.3133988
686