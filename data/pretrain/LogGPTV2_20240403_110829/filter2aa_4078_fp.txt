攻击者 受害者
图 1 7.2 SYN 泛洪攻击
三个不完整的会话并不会引 发 问题。 但是， 攻击者会给受害者发送数百11l(;数千个 SYN 数据包。
每一个不完整的会话都会消耗资源， 然后， 在某一点， 受害者变得不堪重负， 无法回应合法请求。
攻击可 以消 耗可用 的 内存和处理能力 ， 导致受害系统变慢甚至崩溃 。
对于攻击者来说伪造源地址很简单， 每个 SYN 数据包都具有不同 的源地址。 正是因为这样，
阻止攻击者使用源 IP 地址很困难。 攻击者还会协调 ， 对同一受害者同时发起攻击， 这就是 DDoS
第 1 7 章 事件预防和晌应
攻击。 限制允许开放的会话的数量并不能有效加 以防御， 因 为一旦系统达到了 限制， 就会阻止合法
用户 的会话请求。 增加服务器上所允许会话的数量 ， 会导致攻击消耗更多的系统资源， 服务器的 内
存和处理能力也是有限的。
使用 SYN Cookie 是阻断这类攻击的一种方法。 这些小记录消耗小部分系统资源。 当系统接
收到 ACK 应答时， 检查 SYN Cookie 并建立会话。 防火墙通常能够通过检测和防御系统检测 SYN
攻击。
阻断这种攻击的另一种方法是降低 TCP 重置攻击， 服务器通常会等待一段时间 以接收 ACK 应
答。 默认时 间是三分钟， 但在正常操作中合法系统发送 ACK 应答并不需要这么长时间。 通过减少
时间， 半开放的会话在系统 内存中 的刷新会更快。
TCP 重置攻击
另 一种通过操纵 TCP会话的攻击方式叫作 TCP 重直攻击， 会话通常由 F时(完成)或 RST(复位)
数据包终止。 攻击者可以在 RST 包中伪造源 E 地址并断开活动会话。 两个系统之间 则需要重新建
立会话。 这对系统来说是一个很大的威胁， 系统之间 需要持续 的会话以保持数据。 当 会话重建时 ，
系 统就需要重建数据 ， 所以这不仅仅是来回友送三个数据包以建立会话 的 问题。
2. smurf 和 fraggle 攻击
smurf和 fi'aggle 攻击都属于 DoS 攻击。 smurf攻击是另一种类型的泛洪攻击， 但使用 网络控制
消息协议(ICMP)回应数据包而不是 TCP SYN 数据包来攻击其他系统。 更具体地说， 是使用受害者
的 IP 地址作为源 IP 地址的伪造广播 ping。
pmg 使用 ICMP 检查与远程系统的连接。 通常情况下， pillg 发送一个回包请求到单一的系统，
该系统用 回包做出响应。 然而， 在 smurf攻击中 ， 攻击者将回应请求作为广播发给网上的所有系统，
并伪造 E 地址。 所有系统通过响应回包到伪 E 地址做出 回应， 这样就阻碍 了受害者网络的流畅性。
sm町f攻击利用放大网络(也称为 smmf放大器)， 通过路由器发送定向广播。 然后， 放大网络上
的所有系统对受害者发起攻击。 然而， 在 1 999 年发行的 RFC 2644 改变了路由器的标准 ， 路由器不
能转发定向广播。 当管理员使用 盯C 264 正确配置路由器之后 ， 网络便不能被放大 。 这给 smurf攻
击单一网络带来了限制。 此外 ， 在 防火墙上禁用 ICMP 的情况越来越普遍， 甚至许多服务器能
够防止利用 ICMP 的任何类型的攻击。 在使用标准安全的措施之后， 现如今， smurf攻击已经很少
见 了 。
企aggle 攻击类似于 smurf攻击。 然而， fraggle 攻击使用 UDP 端口 7 和 1 9 而不是 ICMP。 企aggle
攻击能够使用伪造的 E 地址将 UDP 数据包发送给受害者。 所有的系统就都会将其转发给受害者，
这类似于 smurf攻击。
3. ping 泛洪攻击
pillg 泛洪攻击通过给受害者发送洪水般的请求来达到攻击 目 的， 在 DDoS 攻击中给僵尸 网络发
送僵尸信息的效果很明显。 如果成千上万的系统同时给一个系统发送 ping 请求， 该系统将在试图 回
应 ping 请求时发生混乱。 受害者便没有时间来回应合法请求。 今天常见的一种处理方式就是阻断
ICMP 流量。 主动入侵检测系统能检测到 pillg 泛洪攻击， 然后通过修改系统环境来阻断 ICMP流量。
497
CISSP 官方学 习指南(第 7 版)
4. 僵尸 网络
今天僵尸 网络相当普遍。 僵尸网络中 的计算机就像机器人(通常称为僵尸)， 并将会按照攻击者
的要求执行命令。 僵尸牧人通常是指通过一个或多个命令控制所有计算机和服务器的罪犯。 僵尸牧
人在服务器中输入命令， 僵尸定期执行命令并控制服务器接收指令。 僵尸牧人通常使用僵尸 网络中
的计算机来发起大范 围攻击 ， 发送垃圾邮件和钓鱼邮件 ， 或向其他罪犯租用僵尸 网络。
计算机通常在被一些恶意代码或恶意软件感染后 ， 加入僵尸 网络。 计算机一旦被感染， 就往往
能够让僵尸牧人远程访问系统或使得额外的恶意软件得以安装。 在某些情况下， 僵尸安装恶意软件，
这些软件能够为攻击者搜索他们需要的密码或信息。 有时， 这些恶意软件含有键盘记录器， 能够记
录用 户 击键信息。
僵尸 网络感染 4 万台计算机很常见， 并且在过去， 僵尸 网络控制数以百万计的系统也很常见。
有些僵尸牧人控制 多 个僵尸 网络。
防止计算机加入僵尸 网络最好的办法， 就是确保反恶意软件的正常运行和定期更新。 因为恶意
软件往往利用操作系统和应用手里芋未打补丁的漏洞， 所以保持系统定期更新补丁， 有助于对系统的
保护 。
许多恶意软件基于浏览器感染系统， 用户在上网时， 系统就会被感染。 保持浏览器及插件的更
新是极其重要的。 此外， 大多数的浏览器安全性较强， 这些功能不应被禁用 。 例如， 大多数浏览器
支持 Web 应用程序沙箱隔离， 但一些浏览器能够禁用该功能。 禁用可能会改善浏览器的性能， 但同
时 也具有较大风险。
@ 真实场景
近期的一些僵尸 网络
不法分子利用 Gameover Zeus 僵尸 网络(GOZ)收集财务系统的凭证并进行银行诈骗。 他们还用
GOZ 来分发 CryptoLocker 勒索软件。 C可ptoL∞ker 加 密用 户 数据， 然后要求用 户 支付一定金额以获
得解密密钥。 在 2014年6 月 份， GOZ 感染 了 50 万到 100 万个 系 统。 Operation Tovar(几个执法机构
之间 的 国 际合作机构)能够暂时切断 GOZ 命令和控制服务器之间 的通信线路。 然而， 犯罪分子 已经
开始使用 不 同 的 战术 ， 且 GOZ 感染的数量还在不 断增长。
Sim也 是另 一个僵尸 网络， 罪犯能够用 它窃取银行认证并安装额外的恶意软件。 在 2015 年 4 月 ，
一名 来自国 际联合会的执法人员 将其破解时， Simda 已经控制 了 超过 770 000 台 电脑。 这是个相对
较新的僵 尸 网 络， 但在 6 个月 中 ， 每个月 感染 了 约 1 28 000 台新电脑 。
498
Esthost 僵尸 网络(也称为 DNSChanger)感染 了 约 400 万 台计算机。 它操纵 DNS 设直以使用僵尸
牧人控制的 DNS 服务器， 还操纵广告。 该僵尸 网络造成了至少 1400 万美元的非法支付， 并阻止用
户 更新反恶意软件或操作系统。 在这种情况下， 无法史新 系统是很严 重的 问题， 但许多 用 户 都忽略
了 。 执法人员 在 201 1 年手工破解该 网 络。
这些都是一些著名 的 大型僵尸 网络， 但这个名单肯定是不完整的 。 没有人知道有多少小型僵尸
网 络正在运行， 但也有控制着 几万台主机的较为 活跃的僵尸 网 络清单。
第 1 7 章 事件预防和响应
5. 死亡 ping
死亡 ping 攻击采用一个超大的 plllg 数据包。 ping 数据包通常是 32 或 64 字节， 但不同 的操作
系统可以使用 其他的大小 。 死亡 ping 攻击将 pmg 数据包的大小改到超过 64KB， 这比许多系统可以
处理的大小都要大。 当系统收到的 pmg 数据包大于 64KB 时， 就会出现问题。 在某些情况下 ， 系统
就会崩愤。 在其他情况下， 将导致缓冲区溢出错误。 现今， 死亡 pmg 攻击很少能够成功， 因为补丁
和更新改善 了系统的脆弱性。
注意 :
尽管现今死亡 ping 攻击 已经构不成威胁， 但才良多 其他类型的攻击也能够造成缓冲 区溢出错误(在
第 2 1 章中讨论)。 当 供应 商发现可能导致缓冲 区溢出 的牵制吴时， 他们会发布修补程序来修复它们 。
对任何缓冲 区溢出攻击的最好的保护手段之一是保持系 统更新 当 前最新补丁。 此外， 生产 系统不应
该 包括未测试的代码 ， 也不能九许 系 统或根级权限的使用 。
6. 泪滴攻击
在泪滴攻击中 ， 攻击者阻碍传输， 系统无法将数据包一起发回 。 大数据包通常被分成较小的碎
片 ， 当它们被发送到网络上时， 接收系统把数据包碎片还原到原来的状态。 然而， 泪滴以一种系统
无法将文件还原在一起的方式分割数据包。 旧 的系统无法处理这种情况， 并且会崩渍， 但补丁解决
了 这个问题。 目 前的系统不容易受到泪滴攻击， 但需要强调保持系统更新的重要性。 此外， 入侵检
测系统可 以检查畸形数据包。
7. land 攻击
1and 攻击是指攻击者使用受害者 的 E 地址作为源 E 地址和目的 E 地址， 并发送伪造的 SYN
数据包给受害者。 这使系统不断地对 自 己做出应答， 并最终可能会冻结、 崩溃或重新启动。 这种攻
击在 1997 年被第一次发现， 它几次攻击不同的端口。 保持系统更新并使用过滤和检测相同的源和 目
的 IP 地址 的流量， 有助于防止 1and 攻击的发生 。
8. 零日攻击
零 日攻击是指利用他人未知的系统漏洞对系统发起攻击。 然而， 安全专业人员在不同 的情况下
使用该术语， 并且在本书中也有一些小差异 。 这里有一些例子:
攻击者首先发现了一个漏洞 当攻击者发现一个漏洞时， 他可 以很容易地利用它， 因为攻击者
是唯一意识到漏洞的人。 在这一点上， 供应商是不知惰的， 所 以并没有开发或发布补丁。 这是零日
漏洞的常见定义。
供应商了解漏洞的存在 供应商了解漏洞的存在， 他们会对威胁进行评估， 并优先发布补丁。
软件补丁很复杂， 需要大量测试， 以确保补丁不会引起其他问题。 供应商可能会在几天内开发和发
布高危漏洞补丁， 而他们可能需要几个月 的时间来开发和发布小漏洞补丁。 在这个时候， 利用该漏
洞的攻击通常被称为 零 日 漏洞 ， 因 为公众不知道 该漏洞 。
供应商发布补丁 一旦补丁被开发和发布， 修补过的系统就不再容易受到攻击。 然而， 在安装
补丁之前， 组织往往需要时间来评估和测试， 从而导致在供应商发布补丁和管理员应用补丁之间有
一定的时间差。 微软通常在每个月 的第二个星期二发布补丁， 通常被称为 "补丁星期二"， 攻击者往
往使用逆 向工程来破解补丁， 然后在第二天利用它们 ， 通常被称为 "漏洞星期三"。 一些人把在供应
499
CISSP 官方学 习指南(第 7 版)
商发布补丁第二天进行攻击的行为称为零 日 攻击。 然而， 这种用法并不常见。 相反， 许多安全专家
认为这是对未安装补丁系统的攻击。
注意 :
如果组织没有一个有效的补丁管理系统， 他们的 系统就很容易受到 己知漏洞的威胁。 如果在供
应商发布补丁之后的几个星期或几个月 后发生 了 系 统攻击， 这不叫做零日 漏洞。 相反， 这是对未安
装补丁 系 统的 攻击 。
用于保护系统免受零日 漏洞的方法包括许多基本的预防措施。 确保系统不运行不需要的服务和
协议可以减少系统的攻击面， 使基于网络和基于主机的防火墙能够限制潜在的恶意流量， 并使用入
侵检测和防御系统检测和阻止潜在的攻击。 此外， 蜜罐和填充单元使得管理员有机会观察攻击并可