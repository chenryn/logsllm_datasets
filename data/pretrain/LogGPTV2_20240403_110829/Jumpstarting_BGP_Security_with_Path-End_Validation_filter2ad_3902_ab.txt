to disclose the identities of their neighbors (more speciﬁ-
cally, customers) for fear of competitors, our design supports
a “privacy-preserving mode”, where an ISP deploys the path-
end ﬁlters, but does not register its neighbors in the database.
This protects privacy-concerned ISPs from falling victim to
next-AS attacks against others, without compromising pri-
vacy (and increases protection for the other ASes).
We point out, however, that: (1) Over 85% of ASes are
not ISPs. In particular, a large fraction of Internet trafﬁc is
Figure 1: Partial deployment example
originated at and destined for ASes with no customers like
Google, Netﬂix, etc. (We present in Section 4 the security
beneﬁts of path-end validation for large content providers.)
While some non-ISPs might be interested in keeping the iden-
tities of the neighbors private, the vast majority do not have
a business interest in keeping this information secret (see,
e.g., PeeringDB [43]). (2) Even if an ISP does not reveal
the identity of a customer, that customer can choose to re-
veal its connection to this ISP so as to protect itself. (3) As
our results in the following sections indicate, validating the
last 1-hop sufﬁx of an AS path is sufﬁcient to provide signiﬁ-
cant security guarantees, and so non-ISPs can achieve a high
level of protection even without ISPs’ cooperation. (4) A lot
of information about the list of neighbors of an AS can easily
be deduced from examining BGP advertisements from mul-
tiple (publicly available) vantage points. Hence, even an ISP
concerned about the privacy of its list of neighbors might, in
practice, not enjoy substantial privacy.
3. PREREQUISITES
As shown in [33], beyond BGPsec’s meagre security ben-
eﬁts in partial adoption, it does not satisfy what we view
as two natural prerequisites for the adoption of any inter-
domain routing security mechanism: (1) never to destabilize
the routing system, and (2) never to worsen security, i.e., an
attacker’s ability to attract trafﬁc should never improve as
more ASes adopt the security mechanism. We refer to the
latter prerequisite as security monotonicity.
We prove below that path-end validation, unlike BGPsec,
satisﬁes these requirements in any deployment scenario. We
show in Section 4 that path-end validation also signiﬁcantly
outperforms BGPsec in terms of security beneﬁts in partial
adoption.
3.1 Model
We brieﬂy overview the standard model for reasoning about
BGP dynamics, namely, the Gao-Rexford model [17], and
then present the threat model as well as path-end validation
deployment model. We then present our results for stability
and security-monotonicity within these models.
The network. The network is modeled as an undirected
graph G = (V, E), where the vertices represent the ASes, la-
beled by the corresponding AS numbers, and the edges rep-
resent the communication links between them. A route in
our model is a sequence of vertices in V that ends with the
344
destination preﬁx π. Each link in E is annotated with one of
the following two business relationships: customer-provider
(directed from customer to provider), indicating that the cus-
tomer pays the provider for connectivity, or peer-to-peer,
where two neighboring ASes agree to transit each other’s
customer trafﬁc at no cost.
The Gao-Rexford conditions. A network where each vertex
runs the BGP protocol to select a route to each destination IP
preﬁx belonging to another AS is called a BGP system. We
refer the reader to [17] for a detailed exposition of the BGP
routing process model. We assume that the three following
so called “Gao-Rexford conditions” hold:
• Topology Condition: No customer-provider cycles ex-
ist in the AS-level graph.
• Preference Condition: Prefer customer-learned routes
to peer- and provider-learned routes.
• Export condition: Only export provider and peer-learned
routes to customers.
Gao and Rexford prove that the combination of these three
conditions is sufﬁcient to guarantee the convergence of the
BGP system to a stable routing conﬁguration [17].
Threat model. We model attackers as a set Adv ⊂ V . An
attacker must advertise a single, “ﬁxed” route to a preﬁx π
to each of its neighbors, yet may announce different routes
to different neighbors. As an attacker cannot lie about its
identity, i.e., AS number, to its neighbors, each route an-
nounced by an attacker must begin with the attacker’s vertex
(AS number). The attacker can, however, present himself
as the owner of a preﬁx (preﬁx/subpreﬁx hijack), a direct
neighbor of the victim (next-AS attack), launch a 2-hop at-
tack, etc..
Path-end validation in partial adoption. To model a BGP
system in which path-end validation is partially (or fully)
adopted we include in our model the set Adpt ⊆ V , of ver-
tices that perform path-end ﬁltering. Recall that path-end
validation is deployed on top of RPKI and so adopters are
protected from both preﬁx and subpreﬁx hijacking (by RPKI)
and next-AS attacks (by path-end validation). Hence, if a
vertex d ∈ V registered a path-end record, any vertex v ∈
Adpt discards routes to π that do not end with d − π or
n − d − π, where the preﬁx π is owned by d and n is an
authorized neighbor of d.
3.2 Stability
In [32] Lychev et al. show that, under the Gao-Rexford
conditions, BGP is not only guaranteed to converge to a sta-
ble state, but this is so even in the presence of ﬁxed-route at-
tackers [32]. Hence, misconﬁgurations/attacks such as preﬁx
hijacks and next-AS attacks cannot destabilize BGP routing.
We show that this statement holds true also in any deploy-
ment scenario of path-end validation. We point out that this
should be contrasted with the risk of routing instabilities re-
sulting from inconsistent BGPsec route selection across dif-
ferent ASes, even when not under attack (see [33] for de-
tails).
THEOREM 1. Under the Gao-Rexford conditions, a BGP
system where any set of vertices Adpt adopts path-end vali-
dation is guaranteed to converge to a stable routing conﬁgu-
ration even in the presence any set Adv of ﬁxed-route attack-
ers.
Our proof, which extends the proof in [32], is omitted due
to space constraints.
3.3 Security-Monotonicity
Informally, an interdomain routing security mechanism is
security monotone if an attacker’s ability to attract trafﬁc to
its network is never enhanced as more and more ASes adopt
the mechanism. We show that this indeed holds in the con-
text of path-end validation.
THEOREM 2. Under the Gao-Rexford conditions, for any
BGP system, attacker AS a, and victim AS v, if trafﬁc from
some source-AS x destined for v does not reach a when the
set of adopters is Adpt ⊆ V then this also holds for any set
of adopters that is a super-set of Adpt.
Again, the proof is omitted due to space constraints.
4. PATH-END VALIDATION VS. BGPSEC
In this section we assume that RPKI is globally adopted
and compare the level of security provided by path-end val-
idation and BGPsec in partial deployment. We show that
even under very limited adoption, path-end validation pro-
vides security beneﬁts close to those of BGPsec in full de-
ployment, whereas, as already discovered in [33], BGPsec
provides meagre beneﬁts in partial deployment. We later
show (Section 5) how path-end validation fares when RPKI
is also only partially deployed.
4.1 Methodology
Simulation framework. We evaluate different attack strate-
gies and quantify the attacker’s success by the fraction of
ASes he is able to attract, as in [18, 33]. Our simulations ap-
ply the BGP route-computation framework presented in [18,
19, 23] to the empirically-derived CAIDA AS-level graph [8]
from January 2016 (links are annotated with inferred bilat-
eral business relationships and contain previously hidden peer-
ing links within IXPs [20]1). Our simulations, similarly to [18,
19, 23], compute the BGP routing outcome reached when
each AS selects BGP paths to other ASes according the fol-
lowing simple routing policy:
1. Local preferences over routes: Prefer routes in which
the next-hop AS is a customer over routes in which the
1For example, in the induced AS-graph, Google has 1325
peers, and each of the 5 largest content providers (speciﬁed
in [33]) has over 850 peers. We point out that while many
peering links might still remain hidden, this new CAIDA
dataset contains over many more peering connections than
datasets used in past studies.
345
(a) Global security evaluation
(b) Protection of top content providers
Figure 2: Attacker success rate for different strategies as function of adopters.
next-hop is a peer. Prefer routes in which the next-
hop AS is a peer over routes in which the next-hop is a
provider.
2. AS-path length: Prefer shorter routes (in terms of AS-
hop count) over longer routes.
3. Tie break: Break ties between routes based on the
number of the next-hop AS on the BGP path. (Since
our simulation framework treats an AS as an atomic en-
tity, as in [18, 19, 23], this step substitutes tie-breaking
based on intradomain routing considerations.)
4. Export: If the selected route is learned from a cus-
tomer AS, advertise the route to all neighboring ASes.
Otherwise, the route is exported to customers only.
When an AS adopts path-end validation, the following
route-ﬁltering step is added before the above-speciﬁed steps
in its BGP decision process (as with today’s origin authenti-
cation via RPKI).
• Security: When a BGP advertisement from a neighbor
is incompatible with the path-end records in the RPKI,
discard the advertisement.
We averaged our measurements over 106 combinations of
attacker-victim ASes, where the method for selecting the at-
tacker and victim pairs depends on the particular scenario we
investigate below.
Who are the best adopters? Ideally, our security evalua-
tion results would quantify the maximum security beneﬁts
from path-end validation achievable from any given number
of adopters. We prove, however, that identifying the “best”
set of adopters of a given size k > 0 is computationally hard.
We consider the “Max-k-Security” problem from [33], adapted
to our context: Given an AS graph, a speciﬁc attacker-victim
pair (a, v), and a parameter k > 0, ﬁnd a set S of size k of
path-end validation adopters that minimizes the total number
of ASes whose paths reach the attacker. We show that, as in
the case of BGPsec [33], this is computationally hard.
THEOREM 3. Max-k-Security is NP-hard.
346
The proof, which resembles that in [33], is omitted due to
space constraints. To quantify the security beneﬁts of path-
end validation in partial deployment we must apply reason-
able heuristics for identifying “good” adopters (from a global
security perspective). Speciﬁcally, our experiments evaluate
the security beneﬁts from adoption of path-end validation by
the top ISPs, i.e., the ASes with largest numbers of AS cus-
tomers. Our results demonstrate that this can indeed yield
signiﬁcant security beneﬁts even when very few large ISPs
adopt. We validate this result with robustness tests.
4.2 Security Evaluation
Consider the graphs in Figure 2. The x-axis describes 11
deployment scenarios corresponding to adoption of path-end
validation by the set of 0, 10, . . . , 100 largest ISPs. The y-
axis is the average fraction of ASes on the Internet whose
trafﬁc the attacker is able to attract to his network. Since de-
ployment of RPKI implies that ASes can detect and block
preﬁx and subpreﬁx hijack attempts, we consider two re-
maining path-manipulation strategies for the attacker when
the victim registers a path-end record: the next-AS attack,
and the 2-hop attack (we later show that other path-manipulation
attacks provide lower success rates). Path-end validation im-
plies that adopters can always detect and ignore the ﬁrst at-
tack (on other adopters), while the second attack goes un-
noticed by the defense. BGPsec, on the other hand, only
allows adopters to validate a path where all ASes on the path
are adopters (regardless of its length, see discussion in Sec-
tion 2).
The graphs also present two dashed reference lines: (1) the
attacker’s success rate when RPKI is fully deployed, when
launching the next-AS attack (which RPKI does not block),
and (2) the attacker’s success rate when BGPsec is fully de-
ployed, but legacy BGP is not deprecated and so the attacker
can launch “protocol downgrade attacks” by advertising legacy
BGP paths, as studied in [33] (our simulations also conﬁrm
the simulation results in [33]).
Figure 2a compares the Internet-wide security beneﬁts of
the different mechanisms for uniformly-selected attacker-victim
pairs. We show later that the results for speciﬁc choices
of attacker and victims (e.g., victim CDNs, attacker-victim
pairs from past incidents) exhibit the same trends. As shown
in the ﬁgure, path-end validation is remarkably effective at
00.10.20.30.40.5020406080100Attacker’s Success RateDeployment (top ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)00.050.10.150.2020406080100Attacker’s Success RateDeployment (top ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)(a) Attacker is a large ISP, victim is a stub
(b) Attacker is a stub, victim is a large ISP
Figure 3: Attacker success rate for different victim/attacker classes
thwarting the next-AS attack, in contrast to the meagre im-
provement that BGPsec achieves over RPKI under the same
partial deployment scenario (compare lines 1 and 2 in the
ﬁgure). Even with only 20 adopters, the attacker is better off
resorting to the 2-hop attack to avoid detection, resulting in
success rate of 13.7% (see line 3)—a big improvement over
RPKI in full deployment (28.5% success rate, see line 4) and
not far from BGPsec in full deployment (roughly 10% suc-
cess rate, see line 5). In fact, with 100 adopters performing
path-end validation the next-AS attack vector is almost com-
pletely blocked as the attacker’s success rate goes below 3%,
while the mirror image for BGPsec is 28.2% (a mere 0.3%
improvement over RPKI, see line 2).
Protection for content providers. Figure 2b describes the
protection that path-end validation provides to large content
providers (Google, Amazon, Netﬂix, etc. (list taken from [33]),
as these generate a signiﬁcant fraction of data trafﬁc on the
Internet. We evaluated, for each victim content provider, the