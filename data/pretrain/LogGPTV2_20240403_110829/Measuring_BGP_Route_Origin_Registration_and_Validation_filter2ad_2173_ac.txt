valid, so the monitor can reach 10.1.2.0/24 anyway exploiting the covering
valid announcement)
– The invalid preﬁx is completely down-covered by other valid preﬁxes
(Example: announcement of 10.1.0.0/16 is invalid, but 10.1.0.0/17 and
10.1.128.0/17 are also announced and valid)
– The invalid preﬁx is up-covered by a “ROA not found” preﬁx (Example:
announcement of 10.1.2.0/24 is invalid, but 10.1.0.0/16 is also announced and
there is no covering ROA for the latter)
So we can ﬁnally say that a given preﬁx is reachable if it is “ROA not
found”, “valid only”, “valid and invalid” or “invalid only” covered as in one of
the three cases above. Instead, when a preﬁx is “invalid only” and there is no
coverage by another valid or “ROA not found”, we mark it as unreachable. The
right-side bars of Fig. 2 show the reachability of preﬁxes considering coverage.
Table 2 list of few of the key values in columns 7–9. We note that around 80 %
of invalid preﬁxes are in fact reachable. They are “rescued” by another valid or
a “ROA not found” covering preﬁx.
36
D. Iamartino et al.
3.4 The Eﬀect of Monitors
Up to now we considered the data from the LINX monitor because it has a
lot of peering links. This monitor is interesting because it receives a lot of het-
erogeneous announcements. Here we aim to see if our observations are highly
dependent on that monitor. For that purpose, we consider 4 additional route-
views collection points: ISC (Palo Alto CA, USA), SAOPAULO (Sao Paulo,
Brazil), SYDNEY (Sydney, Australia), WIDE (Tokyo, Japan). The main dif-
ference between monitors is that they do not receive routes for the same amount
of preﬁxes (see Table 3). However, the percentage of RPKI-covered preﬁxes seen
is very similar. We think that in order to detect speciﬁc events, it might be better
to combine the data from all monitors, but for the purpose of our measurements
it’s enough to consider one of the biggest. The percentage of unreachable preﬁxes
due to an invalid origin is almost the same at any of the 5 locations considered.
3.5 The Causes Behind Invalids
What are the reasons behind failed route origin validations? For every “invalid
only” or “valid and invalid” preﬁx, we look at the reason why the ROA record(s)
present in the longest-preﬁx matching node of the radix tree does not match the
advertisement under validation. We analyze all invalid preﬁxes, discarding their
potential coverage by other preﬁxes, contrary to Sect. 3.3. We divide the failed
validations into three categories:
– Invalid maximum preﬁx length: For example, the monitor receives an
announcement for 10.1.2.0/24 but the ROA record covers only 10.1.0.0/16-16.
– Invalid origin AS number: The monitor receives an announcement by
AS666 for 10.1.2.0/24 but the ROA record authorize 10.1.2.0/24 only from
AS42.
Fig. 3. Breakdown of invalid preﬁxes, by failing cause, as seen by LINX monitor
Measuring BGP Route Origin Registration and Validation
37
Table 4. Percentage of invalid preﬁxes, divided by failing reason: MaxLength/ASN/
both. Data from LINX monitor of route-views project.
Date
Preﬁxes invalid
Preﬁxes invalid due to
due to MaxLength due to wrong ASN MaxLength and ASN
Preﬁxes invalid
2012/06/01 989 (61.01 %)
387 (23.87 %)
245 (15.11 %)
2012/11/28 1053 (49.30 %)
644 (30.15 %)
439 (20.55 %)
2014/06/21 1661 (55.61 %)
462 (15.47 %)
864 (28.93 %)
2014/07/21 1690 (57.60 %)
411 (14.01 %)
833 (28.39 %)
2014/08/20 1736 (54.51 %)
584 (18.34 %)
865 (27.16 %)
– Both maximum length and AS number: At least two ROAs are found
in the longest-preﬁx matching node for the preﬁx, one or more of them failing
on AS number, the other(s) failing on MaxLength; or there is a single ROA
failing for both reasons. This may cover a lot of diﬀerent causes and we don’t
have enough information to classify them.
In Fig. 3 we can see that mismatched maximum length is the most widespread
cause for invalids (see Table 4 for some numbers relative to the ﬁgure). There
are less invalids due to non-matching origin ASs.
We can further subdivide the class of “invalid origin AS number” and “both
maximum length and AS number” errors by looking for the valid AS within
the AS path. This indicates that the up-stream provider registered the covering
preﬁx but did not do their job and create a ROA for their customer’s sub-
allocation. For example, the service provider (ISP) registers (preﬁx 10.0.0.0/16,
AS42) and allocates 10.0.1.0/24 to its multi-homed customer AS666. The mon-
itor receives the AS path 100 200 42 666. The announcement of the customer is
invalid because only AS42 is authorized by the ROA. However AS42 is present
in the AS path. We took invalid preﬁxes of the last RIB dump of August 2014,
and for each of them we check whether at least one of the announcements of that
preﬁx contains a correct AS in the AS path. Results are that 57.36 % of “invalid
origin AS number” invalid preﬁxes and 83.23 % of “both maximum length and
AS number” invalid preﬁxes contains the correct AS on the AS path.
Summing the percentages, when we see an announcement coming from the
wrong origin AS, in %72 of the cases we can ﬁnd the correct AS in one of the AS
paths of that preﬁx. As the customer (AS666 in the example) is multi-homed,
there are likely one or more other AS Paths also starting from AS666 but not
having the allocating up-stream in the path. However, the 54.51 % percentage
of MaxLength problems alone is still the overwhelming invalid cause, and could
be easily ﬁxed by submission of correct ROA records by organizations.
This study highlights the need for operators to monitor the status of their
preﬁxes with regard to what is registered in the RPKI. In addition, customers
should make sure that their provider registers the preﬁxes they have been allo-
cated or should perform the registration themselves. Most invalids today are
38
D. Iamartino et al.
Fig. 4. Percentage of bytes or packets coming or going to an IP address of an RPKI-
covered preﬁx
probably a result from operators learning a new technology and have not yet
developed good procedures. By monitoring the validity of their preﬁxes they
should be able to learn from their mistakes and ﬁx them. RIRs and researchers
could also publish these problems and notify those who should ﬁx them.
3.6 Eﬀect on Traﬃc in a Real Network
BGP announcement data can give us an idea about the deployment of origin-
validation on the global Internet. However, most of the common traﬃc on the
Internet is usually directed to just few destinations. For this reason, we gath-
ered data about how many “RPKI-protected” packets/bytes are passing across
a real router within a large research network. We say that a packet/byte is
‘RPKI-protected’, if the packet/byte was received from an IP address part of an
RPKI-covered preﬁx or sent to such an IP destination. We observe in Fig. 4 that
very little traﬃc is RPKI-covered, likely because this is an American research
network whose preﬁxes ARIN will not certify. The embedded ﬁgure shows the
percentages of bytes/packets with invalid source or destination that cross the
router. Traﬃc from/to invalid origins is negligible in this case. This ﬁnding is
consistent with [10,13].
4 Related Work
The closest works to ours are [13] and [10]. They provide snapshots of route val-
idation in speciﬁc deployments. Here we go further as we study route validation
over an extended period of time. In addition, we provide statistics regarding the
RPKI infrastructure, and the registration of resources and events caused by the
operation of the infrastructure.
Measuring BGP Route Origin Registration and Validation
39
In [18], W¨ahlisch et al. aim to distinguish misconﬁguration from intentional
hijacks. For this purpose they rely on route origin validation. On the other hand,
PHAS [14] oﬀers a real-time hijacking detection service. PHAS monitors the set
of origin ASs observed in public data. It notiﬁes operators that register to the
system of changes in observed origin ASs. In the RPKI, publication points can
remove resources from the distributed database with the adverse eﬀect that
advertisements from some preﬁxes may not be validated anymore. The work
of Heilam et al. [12] aims to prevent publication points from removing resources
from the system without the consent of the owner(s) of the resources. The objec-
tive of [11] is to measure the eﬀect of attacks on the traﬃc. The authors observe
that even with secure routing mechanisms, it is possible to attract a large amount
of traﬃc by advertising routes along valid paths but infringing the BGP policies
for targeted preﬁxes.
5 Conclusion
In this paper, we studied the extend of RPKI deployment. We observed that
Europe and Latin America are leading today, with many ROAs registered.
Regarding the RIRs RPKI infrastructure, there were serious problems. The entire
dataset became unavailable for extended periods of time for a couple of RIRs.
We then quantiﬁed the state of origin-validation deployment. It is about 5 %,
and increasing. Among the invalid BGP announcements, the number of invalid
preﬁxes due to the MaxLength error alone are the majority, and they could be
easily ﬁxed by just correct ROA submissions. We also discovered that many
invalid preﬁxes are due to coverage by a ROA of a service provider. This shows
that organizations that are still not planning to deploy RPKI should care about
what their service provider is doing.
While we found several invalid BGP announcements of preﬁxes, most of them
are “rescued” by another valid or “ROA not found” covering preﬁx. This means
that, today, ﬁltering invalid preﬁxes could leave few unreachable preﬁxes, but
not as many as one would think. When looking at the actual eﬀect on the traﬃc
crossing a router, we ﬁnd that dropping invalids leads to negligible amount of
traﬃc being dropped, and hence is safe to do.
Acknowledgments. We thank the operator of the large American research network
for setting up the collection of the traﬃc statistics. Rob Austein was a great help toward
understanding the mechanics of the RPKI infrastructure and the diﬀerent events we
observed.
References
1. IPv4 Address Space in ROAs (/24s). http://certiﬁcation-stats.ripe.net/?type=
roa-v4
2. IPv4 Preﬁxes Delegated by AfriNIC. ftp://ftp.afrinic.net/stats/afrinic/delegated-
afrinic-extended-latest
40
D. Iamartino et al.
3. IPv4 Preﬁxes Delegated by APNIC. ftp://ftp.apnic.net/pub/apnic/stats/apnic/del
egated-apnic-extended-latest
4. IPv4 Preﬁxes Delegated by ARIN. ftp://ftp.arin.net/pub/stats/arin/delegated-
arin-extended-latest
5. IPv4 Preﬁxes Delegated by LACNIC. ftp://ftp.lacnic.net/pub/stats/lacnic/dele
gated-lacnic-extended-latest
6. IPv4 Preﬁxes Delegated by RIPE NCC. ftp://ftp.ripe.net/ripe/stats/delegated-
ripencc-extended-latest
7. rcynic RPKI validator. http://rpki.net/wiki/doc/RPKI/RP/rcynic
8. University of oregon route views project. http://www.routeviews.org
9. YouTube Hijacking: A RIPE NCC RIS case study, March 2008. http://www.
ripe.net/internet-coordination/news/industry-developments/youtube-hijacking-a-
ripe-ncc-ris-case-study
10. Fincham, M.: RPKI, NZNOG 2014, February 2014. http://hotplate.co.nz/archive/
nznog/2014/rpki/
11. Goldberg, S., Shapira, M., Hummon, P., Rexford, J.: How secure are secure inter-
domain routing protocols? Comput. Netw. 70, 260–287 (2014)
12. Heilman, E., Cooper, D., Reyzin, L., Goldberg, S.: From the consent of the routed:
improving the transparency of the RPKI. In: Sigcomm 2014 (2014)
13. Kloots, J.: RPKI Routing Policy Decision-Making, A SURFNET Perspective,
February 2014. https://blog.surfnet.nl/?p=3159
14. Lad, M., Massey, D., Pei, D., Wu, Y., Zhang, B., Zhang, L.: PHAS: a preﬁx hijack
alert system. In: Proceedings of USENIX Security Symposium (2006)
15. Lepinski, M., Kent, S.: An Infrastructure to Support Secure Internet Routing, RFC
6480, February 2012
16. Litke, P., Stewart, J.: BGP Hijacking for Cryptocurrency Proﬁt, August 2014.
http://www.secureworks.com/cyber-threat-intelligence/threats/bgp-hijacking-for-
cryptocurrency-proﬁt/
17. Toonk, A.: Hijack Event Today by Indosat, April 2014. http://www.bgpmon.net/
hijack-event-today-by-indosat/
18. W¨ahlisch, M., Maennel, O., Schmidt, T.C.: Towards detecting BGP route hijacking
using the RPKI. In: Sigcomm 2012 (Poster) (2012)
19. Zmijewski, E.: Indonesia Hijacks the World, April 2014. http://www.renesys.com/
2014/04/indonesia-hijacks-world/