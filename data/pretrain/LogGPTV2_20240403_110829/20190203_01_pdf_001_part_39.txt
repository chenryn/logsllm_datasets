For a single-master replication system, see Section 5.2.3 for information on defining table
filters on a publication table.
For a multi-master replication system, see Section 6.2.3.
Step 6 (For SMR only): Click the Add Tables button. If Publication Updated
Successfully appears, click the OK button, otherwise investigate the error and make the
necessary corrections.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 458
EDB Postgres Replication Server User’s Guide
Figure 7-71 - Successfully added tables to publication
Step 6 (For MMR only): Click the Add Tables button. The Data Sync Check dialog box
appears warning you that synchronization replication is performed before the table is
added.
If you wish to perform synchronization at some later point in time then add the table,
click the No button.
If you wish to proceed, click the Yes button. If Publication Updated Successfully appears,
click the OK button, otherwise investigate the error and make the necessary corrections.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 459
EDB Postgres Replication Server User’s Guide
Figure 7-72 - Data Sync Check dialog box
Step 7: The replication tree appears as follows with the newly added table under the
Publication node. Click the Refresh icon. The newly added table appears under the
Subscription nodes of a single-master replication system or the additional master nodes of
a multi-master replication system.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 460
EDB Postgres Replication Server User’s Guide
Figure 7-73 - Publication and subscription with added table
Step 8 (For MMR only): If you want to modify or see the default conflict resolution
options assigned to the newly added table, follow the directions in Section 6.8.
Step 9 (Optional): If you defined table filters on the newly added table, and you wish to
use these filters on any subscriptions or master nodes, you must enable the filters on the
table within the desired subscriptions or master nodes.
For a single-master replication system, see Section 5.5.4 for directions on enabling table
filters on a subscription.
For a multi-master replication system, see Section 6.9 for directions on enabling table
filters on a master node.
7.6.3.2 Removing Tables from a Publication
You can remove one or more tables from a publication, but only if the following
condition is true:
 The tables to be removed are not parent tables referenced by foreign key
constraints of child tables that are not selected for removal as well.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 461
EDB Postgres Replication Server User’s Guide
Figure 7-74 - Entity relationship diagram of tables with foreign key constraints
In the preceding entity relationship diagram, the emp table has a foreign key constraint
referencing the dept table, and the jobhist table has two foreign key constraints. One
constraint references the emp table and the other references the dept table.
If all three tables are in the publication, then you can remove the following combinations
of tables:
 Remove the jobhist table only.
 Remove both the jobhist table and the emp table.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 462
EDB Postgres Replication Server User’s Guide
Step 1: Make sure the publication server whose node is the parent of the publication you
wish to change is running and has been registered in the xDB Replication Console you
are using. See Section 5.2.1 for directions on starting and registering a publication server.
Step 2 (For SMR only): Select the Publication node of the publication from which you
wish to remove tables.
Step 2 (For MMR only): Select the Publication node under the Publication Database
node representing the master definition node.
Figure 7-75 - Selecting a publication from which to remove tables
Step 3: Open the Remove Tables dialog box in any of the following ways:
 From the Publication menu, choose Update Publication, then Remove Tables.
 Click the secondary mouse button on the Publication node, choose Update
Publication, and then choose Remove Tables.
 Click the primary mouse button on the Remove Publication Tables icon.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 463
EDB Postgres Replication Server User’s Guide
Figure 7-76 - Opening the Remove Tables dialog box by clicking the toolbar icon
Step 4: Use the Remove Tables dialog box as follows:
 Remove. Check the boxes next to the table names from the Available Tables list
that are to be removed from the publication. If the publication is a snapshot-only
publication, then views would appear in the Available Tables list as well.
Alternatively or in addition, click the Use Wildcard Selection button to use
wildcard pattern matching for selecting tables to be removed from the publication.
 Use Wildcard Selection. Click this button to use the wildcard selector to choose
tables to remove from the publication. See Section 7.1 for information on the
wildcard selector.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 464
EDB Postgres Replication Server User’s Guide
Figure 7-77 - Remove Tables dialog box
Step 5: Click the Remove button, then click the Yes button of the confirmation box.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 465
EDB Postgres Replication Server User’s Guide
Figure 7-78 - Remove Tables confirmation
Step 6: Click the OK button in response to Tables Removed Successfully.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 466
EDB Postgres Replication Server User’s Guide
Figure 7-79 - Successfully removed tables from publication
The replication tree appears as follows without the removed table under the Publication
node.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 467
EDB Postgres Replication Server User’s Guide
Figure 7-80 - Publication minus removed table
7.6.4 Updating the Set of Available Table Filters in a Publication
Once a set of available table filters has been defined in the publication of a single-master
replication system or a multi-master replication system, the set can subsequently be
updated by adding new filter rules, removing existing filter rules, or modifying existing
filter rules.
Note: See Section 2.2.12.3 for table setup requirements for a log-based replication
system as well as general restrictions on the use of table filters.
See Section 5.2.3 for information on using table filters in a single-master replication
system and Section 6.2.3 for a multi-master replication system.
Updating the set of available table filters in a publication has the following implications:
 After you have added new filter rules to a publication, you must then enable these
newly added filter rules on the subscriptions or master nodes on which you want
these filter rules to have an effect. See Section 5.5.4 for directions on enabling
filter rules on a subscription. See Section 6.9 for enabling filter rules on a master
node.
 After you have removed existing filter rules from a publication, the removed filter
rules are automatically deleted from any associated subscription or master node
on which they had been enabled. That is, you do not need to modify the
subscriptions or master nodes to disable the filter rules once they have been
removed from the publication.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 468
EDB Postgres Replication Server User’s Guide
 After you have modified existing filter rules (that is, changed the filter name or
filter clause), the modifications are automatically applied to any subscriptions or
master nodes on which the filter rules had been enabled. That is, you do not need
to make any changes in the associated subscriptions or master nodes.
After your updates to the set of available table filters in the publication have been
completed, and the filter rules have been enabled or disabled on the target
subscriptions or master nodes, a snapshot replication should be performed on any
subscription or master node affected by an updated filter rule to ensure that the
content of the targeted subscription tables or master node tables is consistent with
the current set of filter rules enabled on those tables.
The following are the steps to update the set of available filter rules in a publication.
Step 1: Make sure the publication server whose node is the parent of the publication you
wish to change is running and has been registered in the xDB Replication Console you
are using. See Section 5.2.1 for directions on starting and registering a publication server.
Step 2 (For SMR only): Select the Publication node of the publication in which you
wish to update the set of available table filters.
Step 2 (For MMR only): Select the Publication node under the Publication Database
node representing the master definition node.
Figure 7-81 - Selecting a publication in which to update the set of available table filters
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 469
EDB Postgres Replication Server User’s Guide
Step 3: Open the Update Filters dialog box in any of the following ways:
 From the Publication menu, choose Update Publication, then Update Filters.
 Click the secondary mouse button on the Publication node, choose Update
Publication, and then choose Update Filters.
Figure 7-82 - Opening the Update Filters dialog box
Step 4: The set of all available filter rules defined in the publication are listed under the
Table Filters tab.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 470
EDB Postgres Replication Server User’s Guide
Figure 7-83 - Set of all available filter rules
To add a new filter rule, from the Table/View drop-down list select the table or view for
which you wish to add a filter and click the Add Filter button. Fill in the information in
the dialog box that appears. (See Section 5.2.3 for more details on adding individual filter
rules in a single-master replication system. See Section 6.2.3 for a multi-master
replication system.)
To remove a filter rule, click the primary mouse button on the filter rule you wish to
remove so the entry is highlighted and click the Remove Filter button.
You may also modify the filter name or filter clause of a filter rule listed in the Table
Filters tab by double-clicking on the cell of the filter name or filter clause you wish to
change. When the cursor appears in the cell, enter the text for the desired change.
When you are satisfied with the updated set of available table filters, click the Update
button.
Step 5: A confirmation box appears presenting a warning message and a
recommendation to perform a snapshot replication to any subscription or master node on
which you intend to enable the change in filtering criteria.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 471
EDB Postgres Replication Server User’s Guide
Click the Ok button in the confirmation box to proceed with the update to the filter rules.
Click the Cancel button to return to the Filter Rules tab if you wish to modify your filter
rule updates.
Figure 7-84 - Change filter rule confirmation
Step 6: You may selectively enable any new filter rules to the corresponding tables of the
associated subscriptions or master nodes. See Section 5.5.4 for information on enabling
table filters on a subscription. See Section 6.9 for enabling table filters on a master node.
7.6.5 Validating a Publication
Once a publication is created, do not directly change the definitions of the tables
belonging to the publication. Doing so may cause a failure during the replication
process. Examples of table definitions that must not be altered include:
 Adding or removing columns to a table
 Renaming columns
 Changing the data types of columns
 Changing the lengths of columns
 Changing a not nullable column to nullable or a nullable column to not nullable
 Adding or removing uniqueness constraints
 Adding or removing check constraints
In a single-master replication system, xDB Replication Server does not propagate table
definition changes to the subscription tables once the subscription tables are created.
Rows that may be allowed in an altered publication table may be illegal in the unaltered
subscription table and will cause an error during replication.
Similarly, in a multi-master replication system, table definition changes are not
propagated from one master node to another except when a new master node is added,
and you choose to replicate the schema definition from the master definition node.
In addition, for synchronization replication with the trigger-based method, triggers are
generated on the publication tables that use certain attributes of these tables. If the table
definition is changed, the trigger may no longer function properly.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 472
EDB Postgres Replication Server User’s Guide
Note: Do not change the triggers generated by xDB Replication Server. If it becomes
necessary to regenerate the triggers, you must remove the associated publication and then
recreate the publication.
Note: Certain table definition changes can be made and propagated by xDB
Replication Server by using the DDL change replication feature. See Section 7.8 for
information on the DDL change replication feature.
If you do not use the DDL change replication feature, then the following general steps
must be taken if table definition changes are made.
In a single-master replication system, if changes were made to the definitions of one or
more publication tables, the resolution to the problem must be handled on a case by case
basis as it depends upon the type of changes that were made. In the worst case scenario,
the subscription and publication must be removed and recreated as follows:
 Remove the subscription that is associated with the publication. See Section 5.5.5
for directions to remove a subscription.
 Remove the subscription tables from the subscription database. This is done with
SQL DROP TABLE statements in the database system.
 Remove the publication. See Section 7.6.6 for directions to remove a publication.
 Re-add the publication. See Section 5.2.3 for directions to add a publication.
 Re-add the subscription. See Section 5.3.3 for directions to add a subscription.
In a multi-master replication system, if changes were made to the definitions of one or
more publication tables on one or more master nodes, the resolution to the problem
involves:
 Making sure the table definitions are updated on all master nodes so that they are
identical, or updating the table definition on the master definition node so it can
be replicated to the other master nodes.
 Recreating the publication database definitions of the master nodes.
The general steps are the following:
 Remove the publication database definitions of all master nodes except for the
master definition node. See Section 7.6.7 for directions to remove a publication
database definition.
 Remove the publication. See Section 7.6.6 for directions to remove a publication.
 Remove the publication database definition of the master definition node. See
Section 7.6.7 for directions to remove a publication database definition.
 At this point all of the triggers, shadow tables, and metadata have been removed
from the master nodes.
 With respect to the publication table definitions, you can either: 1) update the
table definitions on all master nodes so that they are identical, or 2) assume the
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 473
EDB Postgres Replication Server User’s Guide
table definitions on the master definition node are up-to-date, and delete the out-
of-date table definitions on all other master nodes.
 Re-add the publication database definition for the master definition node. See
Section 6.2.2 for directions to add the master definition node.
 Re-add the publication. See Section 6.2.3 for directions to add a publication.
 Re-add additional master nodes. See Section 6.3 for directions to add an
additional master node. When creating a master node, uncheck the Replicate
Publication Schema check box if you have already created the table definitions on
all master nodes. Check the Replicate Publication Schema check box if you want
to propagate the table definitions from the master definition node to all other
master nodes. A snapshot reloads the master node tables from the master
definition node.
7.6.5.1 Validating a Single Publication
xDB Replication Server provides a way to verify that certain characteristics of
publication tables have not been altered since the publication was created.
Note: This validation feature is only available for publications using the trigger-based
method of synchronization replication. This validation feature is not available for
publications using the log-based method of synchronization replication.
The validation operation described here and in Section 7.6.5.2 can check for the
following types of table modifications:
 Addition of columns to a table
 Removal of columns from a table
 Renaming of columns
Note: In a multi-master replication system, publication tables in only the master
definition node are validated. The validation operation does not check if table definitions
have changed in other master nodes.
The following steps show how to validate a single publication:
Step 1: Make sure the publication server whose node is the parent of the publication you
wish to validate is running and has been registered in the xDB Replication Console you
are using. See Section 5.2.1 for directions on starting and registering a publication server.
Step 2 (For SMR only): Select the Publication node of the publication you want to
validate.
Step 2 (For MMR only): Select the Publication node under the Publication Database
node representing the master definition node.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 474
EDB Postgres Replication Server User’s Guide
Step 3: From the Publication menu, choose Validate Publication. Alternatively, click the
secondary mouse button on the Publication node and choose Validate Publication.
Figure 7-85 - Validating a selected publication
Step 4: If All Schema of Published Tables in Publication 'publication_name' Are Up-
To-Date appears, click the OK button. If an error appears, determine which tables were
changed and what changes were made to the table definitions. These issues need to be
resolved on a case by case basis as discussed earlier in this section.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 475
EDB Postgres Replication Server User’s Guide
Figure 7-86 - Successful validation of all tables in the selected publication
7.6.5.2 Validating All Publications
All publications under a single Publication Database node can be validated in one
operation.
Note: This validation feature is only available for publications using the trigger-based
method of synchronization replication. This validation feature is not available for
publications using the log-based method of synchronization replication.
Note: In a multi-master replication system, publication tables in only the master
definition node are validated. The validation operation does not check if table definitions
have changed in other master nodes.
Step 1: Make sure the publication server whose node is the parent of the publications you
wish to validate is running and has been registered in the xDB Replication Console you
are using. See Section 5.2.1 for directions on starting and registering a publication server.
Step 2 (For SMR only): Select the Publication Database node under which you want to
validate all publications.
Step 2 (For MMR only): Select the Publication Database node representing the master
definition node.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 476
EDB Postgres Replication Server User’s Guide
Step 3: From the Publication menu, choose Validate All Publications. Alternatively, click
the secondary mouse button on the Publication Database node and choose Validate All
Publications.
Figure 7-87 - Validating all publications subordinate to a selected publication database
Step 4: If there were no modified tables, click the OK button.
Copyright © 2010 - 2018 EnterpriseDB Corporation. All rights reserved. 477
EDB Postgres Replication Server User’s Guide
Figure 7-88 - Successful validation of all tables in all publications subordinate to a selected
publication database
If there were modified tables, a list of publications that contain the modified tables is
displayed. Determine which tables were changed and what changes were made to the