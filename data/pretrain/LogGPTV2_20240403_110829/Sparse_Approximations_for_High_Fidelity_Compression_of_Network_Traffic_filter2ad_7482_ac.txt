0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
s
t
r
o
p
f
o
n
o
i
t
c
a
r
F
0
0
0.02
F+H
F+S
F+H+S
0.08
0.1
0.04
0.06
Relative Error
Figure 6: CDFs of relative error for TCP ports (incoming
ﬂows) with 30 coefﬁcients for different dictionaries
1
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
s
t
r
o
p
f
o
n
o
i
t
c
a
r
F
0
0
0.02
F+H
F+S
F+H+S
0.08
0.1
0.04
0.06
Relative Error
Figure 7: CDFs of relative error for UDP ports (incoming
ﬂows) with 30 coefﬁcients for different dictionaries
stopping criteria for obtaining compressed representations.
6.3 Analysis of Selected Modes
We proceed to analyze the set of dictionary components
that are chosen in the compressed representation using the
redundant dictionaries for different ports, along different
spatial and temporal dimensions. First, we are interested
to see if there is substantial similarity in the set of dictio-
nary components selected in the compressed representation
across different ports. Second, we want to observe the tem-
poral properties of compression; i.e., for a ﬁxed trafﬁc di-
mension, how does one week differ from another in terms
of the components selected from the redundant dictionary?
Third, we want to identify possible sources of correlation
across the different trafﬁc aggregates (ﬂows, packets, bytes,
both to and from) on a particular port of interest. Such anal-
ysis not only helps us to understand the nature of the un-
derlying constituent components that make up each trafﬁc
260
Internet Measurement Conference 2005
USENIX Association
Table 1: Compression error with 30 coefﬁcient representation for selected TCP ports (Legend: F = Fourier, W = Ortho-
normal db4 wavelets, H = Fully-translational Haar wavelets, S = Spikes)
Port Type
Port Number
High Volume
P2P
Scan
Random
25
80
1214
6346
135
9898
5190
114
Relative error with different dictionaries
DF
0.0005
0.0052
0.0003
0.0009
0.0016
0.0066
0.0023
0.5517
DW
0.0026
0.0256
0.0036
0.0056
0.0216
0.0143
0.0280
0.1704
DS
0.8446
0.7704
0.0007
0.8193
0.7746
0.7800
0.7916
0.0428
DH
0.0007
0.0074
0.8410
0.0013
0.0049
0.0036
0.0040
0.0218
DF +S DF +H DF +H+S DH+S
0.0007
0.0004
0.0052
0.0073
0.0007
0.0003
0.0013
0.0009
0.0049
0.0015
0.0063
0.0036
0.0039
0.0023
0.0097
0.0068
0.0004
0.0018
0.0001
0.0005
0.0008
0.0032
0.0010
0.0068
0.0004
0.0018
0.0001
0.0005
0.0008
0.0032
0.0010
0.0218
0.18
0.16
0.14
0.12
0.1
0.08
0.06
0.04
0.02
r
o
r
r
E
e
v
i
t
l
a
e
R
0
5
10
15
F+H
F+S
F+H+S
0.5
0.45
0.4
0.35
0.3
0.25
0.2
0.15
0.1
0.05
r
o
r
r
E
e
v
i
t
l
a
e
R
40
45
50
0
5
10
15
F+H
F+S
F+H+S
40
45
50
20
25
30
35
Number of coefficients
20
25
30
Number of coefficients
35
Figure 8: 95th percentile of relative error vs. number of
coefﬁcients selected for TCP ports (incoming ﬂows)
Figure 9: 95th percentile of relative error vs. number of
coefﬁcients selected for UDP ports (incoming ﬂows)
time series but also enables us to identify possible sources
of joint compression, to further reduce the storage require-
ments. For the discussion presented in this section, we use
the dictionary DF +S (Fourier + Spike) as the redundant
dictionary for our analysis.
6.3.1 Spatial Analysis Across Ports
We observe that the majority of selected dictionary com-
ponents are restricted to a small number of ports—this
is expected as these modes capture the minor variations
across different ports, and also represent trafﬁc spikes that
may be isolated incidents speciﬁc to each port. We also
observe that there are a few components that are consis-
tently selected across almost all the ports. These compo-
nents that are present across all the ports under consider-
ation include the mean (zero-th Fourier component), the
diurnal/off-diurnal periodic components, and a few other
periodic components which were found to be the high-
est energy components in the Fourier analysis presented in
Section 6.1.
6.3.2 Temporal Analysis Across Multiple Weeks
We also analyze, for speciﬁc instances of ports as deﬁned
by our four categories, the temporal stability of the set of
components that are selected across different weeks over
the 20 week data set, using 30 modes per week. As before,
we use DF +S as the redundant dictionary for compres-
sion. For each dictionary component (periodic component
or spike) that is selected in the compressed representation
over the 20 week period, we count the number of weeks in
which it is selected. We show in Figure 10 the number of
components that have an occurrence count more than x, as
a function of x. We observe that the majority of the compo-
nents are selected only for 1-2 weeks, which indicates that
these captured subtle trafﬁc variations from week to week.
To further understand the stability of the components, we
divide them into 3 categories: components that occur every
week, components that occurred greater than 50% of the
time (i.e, were selected 10-20 times over the 20 week pe-
riod), and components that occurred fewer than 50% of the
time (i.e., fewer than 10 times). Table 2 presents the break-
USENIX Association
Internet Measurement Conference 2005  
261
150
100
50
x
>
t
n
u
o
c
e
c
n
e
r
u
c
c
o
h
t
i
w
s
e
d
o
m
f
o
r
e
b
m
u
N
0
0
2
4
Port 25: SMTP
Port 80: HTTP
Port 110: POP3
200
180
160
140
120
100
80
60
40
20
x
>
t
n
u
o
c
e
c
n
e
r
u
c
c
o
h
t
i
w
s
e
d
o
m
f
o
r
e
b
m
u
N
16
18
20
0
0
2
4
6
14
Occurence count  over 20 weeks
10
12
8
Port 135: Blaster?
Port 9898: Dabber?
Port 139: NetBIOS
160
140
120
100
80
60
40
20
x
>
t
n
u
o
c
e
c
n
e
r
u
c
c
o
h
t
i
w
s
e
d
o
m
f
o
r
e
b
m
u
N
Port 1214: Kazaa
Port 4662: Edonkey
Port 6346: Gnutella
200
180
160
140
120
100
80
60
40
20
x
>
t
n
u
o
c
e
c
n
e
r
u
c
c
o
h
t
i
w
s
e
d
o
m
f
o
r
e
b
m
u
N
6
14
Occurence count  over 20 weeks
10
12
8
16
18
20
0
0
2
4
6
14
Occurence count  over 20 weeks
10
12
8
16
18
20
0
0
2
4
Port 1162
Port 43276
Port 65506
16
18
20
6
14