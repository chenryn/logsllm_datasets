ing that the results do not change signiﬁcantly when exten-
sions are sent, or when a SSLv2 compatibility ClientHello
is used.
Yet, there are still many servers that do not use
TLSv1.0 and choose the obsolete SSLv3. Even if
the situation is better with trusted and EV hosts,
such conﬁgurations should be avoided. For the SSL2+
stimulus, this represents 32,000 servers amongst the 4 mil-
lion trusted servers, and about 1,000 servers amongst the
140,000 EV hosts.
The other stimuli are more diﬃcult to interpret. Indeed,
as table 3 shows, the results obtained for DHE, EC, SSL2
and TLS12 stimuli correspond to fewer TLS answers.
It
shows that some servers refuse to negotiate some protocol
versions or some ciphersuites. Among these servers, some
will emit an alert, in compliance with the standards. Others
will not answer or return inconsistent TLS messages: we
call this intolerance to particular versions/suites. Section 6
discusses this matter further.
5.2 Ciphersuites
Table 5 shows the distribution of ciphersuites chosen by
servers for each campaign and each subset. The ciphersuites
ClassPath.
10The term transvalid was ﬁrst used by the EFF to describe
such chains.
are grouped into categories: S (strong), A (acceptable), W
(weak)11 and N represents suites that were not proposed by
the client.
TLS
Trusted
EV
NoExt1
NoExt2
EFF-2
EFF-1
DHE(cid:2)
S
A
S
A
S
A
S
A
S
A
N
S
A
S
N
SSL2(cid:2) W
N
SSL2+ S
A
W
S
N
EC(cid:2)
FF
TLS12(cid:2)
65 %
35 %
64 %
36 %
64 %
36 %
73 %
27 %
95 %
2.5 %
2.5 %
73 %
27 %
83 %
17 %
99.9 %
0.1 %
71 %
29 %
0.1 %
98.8 %
1.2 %
S
A
S
A
S
A
S
A
S
A
S
A
S
N
W
S
A
S
59 %
41 %
62 %
38 %
61 %
39 %
68 %
32 %
98.6 %
1.4 %
S
A
S
A
S
A
S
A
S
A
S
68 %
A
32 %
S
99.2 %
0.8 %
N
100 % W
67 %
33 %
S
A
59 %
41 %
54 %
46 %
56 %
44 %
80 %
20 %
98.9 %
1.1 %
80 %
20 %
98.9 %
1.1 %
100 %
80 %
20 %
100 % S
100 %
Table 5: Distribution of the ciphersuites chosen by
the servers for each campaign and each subset. Per-
centages below 0.1 % are ignored.
For the ﬁrst three campaigns (NoExt1, EFF-1 and EFF-2),
around 65 % of the answers contain strong suites. For
trusted or EV subsets, this proportion is smaller. This dis-
crepancy is explained by the fact that the A category con-
tains the popular TLS_RSA_WITH_RC4_128_MD5 suite. While
we consider this suite only acceptable12, it is commonly con-
sidered the most eﬃcient one. For the NoExt2, FF and
SSL2+ campaigns from July 2011, proportions are roughly
the same: 72 % for TLS hosts, 68 % for trusted hosts and
80 % for EV hosts, which indicates a minor improvement in
the suite choices, especially for EV hosts.
We did not expect servers to answer with ciphersuites not
proposed in ClientHello, as it is not compliant with the
speciﬁcations. This phenomenon is signiﬁcant in the DHE
and EC campaigns, when the servers faced a limited choice.
We also witness this behaviour with TLS12 stimulus, essen-
tially because we chose not to propose the popular RC4_MD5
ciphersuite13. This is a manifestation of server intolerance
to DHE/EC/TLSv1.2.
Another way to look at the ciphersuites chosen by servers
is to compute the proportion of them that provide Perfect
Forward Secrecy (PFS). Such suites do not allow the de-
cryption of past sessions if the server private key is com-
promised14. Results are presented in table 6. We did not
11Such suites were only proposed in the SSL2 and SSL2+
ClientHello.
12On one hand, statistical vulnerabilities on RC4 limit the
quantity of data that should be protected without refreshing
the keys. On the other hand, it is strongly discouraged to
use MD5 nowadays.
13However, other classical non-DHE non-EC suites were pro-
posed in TLS12 ClientHello.
14With TLS ciphersuites, this property is obtained with
16
NoExt1
EFF-1
EFF-2
2010-07
2010-08
2010-12
TLS Trusted
41 %
43 %
41 %
44 %
46 %
42 %
NoExt2/FF
SSL2+
TLS12
2011-07
37 %
39 %
2011-07
0 %
0 %
EV
20 %
19 %
19 %
11 %
0 %
Table 6: Proportion of the ciphersuites chosen by
the servers that provide Perfect Forward Secrecy.
The percentage is computed over the total number
of compatible answers.
include the DHE and EC campaigns (since all the proposed
suites oﬀers PFS) nor the SL2 stimulus (since none of the
suites proposed oﬀers PFS).
If we look at the ﬁrst four lines, corresponding to four
diﬀerent dates, around 40 % of TLS hosts chose PFS suites.
The corresponding trusted hosts ﬁgures are a little higher,
whereas the proportions drops with EV hosts, especially in
July 2011 where only 11 % of the servers chose PFS.
The result for the TLS12 stimulus can be explained by
the fact that the PFS suites proposed in this case were all
compatible with TLSv1.2 only, leaving no choice to non-
TLSv1.2 implementations but not to oﬀer PFS.
For a standard stimulus, about two thirds of TLS
hosts choose strong ciphersuites. Recently, the pro-
portion seems to have grown to 80 % for EV hosts.
However, only 40 % of TLS hosts, and less than
20 % of EV hosts choose a suite oﬀering the Perfect
Forward Secrecy.
5.3 Secure renegotiation
As discussed in section 4.2, we expect servers to implement
RFC 5746 for secure TLS renegotiations. However, only
three out of the ten stimuli studied proposed this extension
(FF, SSL2+15 and TLS12), all sent in July 2011. As a result,
we can not assess the evolution in time of this parameter.
If we now consider only those three stimuli proposing the
extension, we have the same results: 53 % of the TLS hosts
accept RFC 5746 extension, which becomes 65 % when we
focus on trusted hosts. For EV hosts, the proportion is even
better: 80 %. However, 20 % of EV hosts (around 28,000
servers) still do not support secure renegotiation as of July
2011.
It is important to notice that servers are only vulnerable if
they do not support the extension and if they accept to rene-
gotiate. As we did not pursue the connection, nor tried to
renegotiate, we are not able to reliably tell how many servers
are indeed vulnerable. Yet, from the client’s perspective, the
only way to be sure that the server is not vulnerable is if it
supports the secure renegotiation extension.
As of July 2011, one third of the trusted hosts and
20 % of EV hosts do not support secure renegotia-
tion.
ephemeral Diﬃe-Hellman key exchanges, as opposed to the
RSA encrypted key exchange.
15The SSL2+ ClientHello did not propose the extension
per se, but rather used a dedicated ciphersuite to signal the
support of secure renegotiation.
6. ANALYSIS OF SERVER BEHAVIOUR
Using the collected data, we tried to compare the answer
types for a given IP in diﬀerent campaigns. However, we
found out that such a comparison was irrelevant when we
compared data collected at diﬀerent times.
6.1 When comparison really makes sense
We compared the list of IPs from the TLS subset between
our measure of July 2010 and the EFF measure of August
2010: 7.5 million IPs are present in both sets but 2 million
were only seen by our trace, and nearly 4 million were only
present in the EFF trace. So a vast proportion of TLS hosts
do not have a stable IP over a month or a year.
This fact is even more visible when comparing our mea-
sures in 2010 and 2011 (using the NoExt2 measure): 5.5 mil-
lion IPs correspond to TLS hosts in both cases, but about
4 million (resp. 6 million) IPs are present only in the 2010
(resp. 2011) trace.
It is thus clear we can only do per-IP
comparisons between measures that were made at the same
time.
This basic comparison sheds light on the surprising ﬁgures
obtained in EFF-2 campaign: between the EFF experiments
conducted in August and December, 7.5 million IPs repre-
sent TLS hosts both times, about 4 million have disappeared
in EFF-2 whereas only 60,000 IPs are new in EFF-2. This
can be explained by the fact that the EFF did not launch
the ﬁrst phase (enumerating IP with TCP/443 open) again
in December and reused the list of IPs from August 2010.
6.2 Error margin for July 2011 campaigns
We now focus on the seven measures of July 2011 that
were conducted simultaneously16 on the same address pool
to understand server answers against diﬀerent stimuli. We
need to check that the servers we contacted were the same
during all the communications. Let’s ﬁrst compare the IPs
corresponding to a TLS answer between two similar cam-
paigns: NoExt2 and FF. Over 99.6 % of IPs corresponding
to a TLS host in one measure also do in the other. The
correlation is even better if we focus on trusted or EV hosts.
To conﬁrm that, we also compare the server certiﬁcates
returned by the servers. Considering the set of IPs that
answered at least once with a server certiﬁcate, we count
for each IP the number of diﬀerent server certiﬁcates re-
ceived over the seven communications. More than 99.6 % of
them presented the same server certiﬁcate each time they
answered with a valid ServerHello.
If we compute the
same statistics using the list of IPs presenting at least once
a trusted certiﬁcate (resp. an EV certiﬁcate), the error mar-
gin is even better, since 99.9 % served only one certiﬁcate.
The hosts that do not consistently send the same server cer-
tiﬁcate (0.4 %) deﬁne our error margin.
6.3 Understanding hosts with multiple stimuli
We can now reﬁne the statistics about DHE/EC/TLSv1.2
intolerance. Let us focus on the servers that correctly an-
swered with a compatible ServerHello to the NoExt2, FF
and SSL2+ stimuli. We thus obtain a list of apparently
valid IPs for each subset: 11.2 million TLS hosts, 4.0 mil-
lion trusted hosts and 141,972 EV hosts. Tables 7, 8, 9
present the answers of this sample groups to the DHE, EC
16For a given IP, all ClientHello messages were sent within
a 10 minute-timeframe.
17
and TLS12 stimuli. The answers are partitioned into the
categories deﬁned in section 3.4.
Compatible Handshake
Alert
Intolerant servers
Non-TLS answer
Incompatible Handshake
Trusted
42 %
28 %
EV
TLS
13 %
39 %
38 %
71 %
23 % 30 % 16 %
22 %
16 %
0 %
1 %
30 %
0 %
Table 7: Answers to the DHE stimulus.
Compatible Handshake
Alert
Intolerant servers
Non-TLS answer
Incompatible Handshake
Trusted
10 %
68 %
EV
TLS
5 %
6 %
76 %
82 %
18 % 22 % 13 %
13 %
17 %
1 %
0 %
22 %
0 %
Table 8: Answers to the EC stimulus.
Compatible Handshake
Alert
Intolerant servers
Non-TLS answer
Incompatible Handshake
Trusted
74 %
5 %
EV
TLS
86 %
76 %
2 %
7 %
17 % 21 % 12 %