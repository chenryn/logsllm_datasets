  
 
 


Consumer
Content


"




"



"

"



#

"






"


$


#


#


#


#


#


"


#


!

!

#



#

#





#




$




$




$



(a) Origin and transit growth
(b) Ratio change
Figure 3: Changes in Comcast inter-domain traÔ¨Éc patterns between July 2007 and July 2009. The Ô¨Årst graph
shows weighted average percentage of inter-domain traÔ¨Éc originating / terminating and transiting Comcast
ASNs. The second graphs shows the change in Comcast In / Out peering ratio over the two year period.



















	





Rank Provider
1
2
3
4
5
6
7
8
9
10
Google
ISP A
LimeLight
Akamai
Microsoft
Carpathia Hosting
ISP G
LeaseWeb
ISP C
ISP B
Percentage
5.03
1.78
1.52
1.16
0.94
0.82
0.77
0.74
0.73
0.70





  
     


	

Table 3: Top ten origin ASNs as an average weighted
percentage of all inter-domain traÔ¨Éc in July 2009.
Figure 4: Graph shows the cumulative distribution
of inter-domain traÔ¨Éc contributed by origin ASNs
by weighted average percentage of all inter-domain
traÔ¨Éc throughout the months of July 2007 and July
2009.
average 5% of all inter-domain traÔ¨Éc followed by ISP A‚Äôs
enterprise / CDN business at 1.7% and LimeLight at 1.52%.
CDNs comprise one of the largest categories of consolidat-
ing traÔ¨Éc sources in Figure 4. As a grouping, we estimate
CDNs contribute a weighted average percentage of approx-
imately 10% of all Internet inter-domain traÔ¨Éc as of July
2009. We further observe that our estimates may signiÔ¨Å-
cantly underestimate CDN contribution as we cannot easily
distinguish CDN traÔ¨Éc from other sources of data within
providers, e.g., between CDN, transit, hosting, etc. We also
note that our inter-domain analysis excludes Akamai CDN
traÔ¨Éc since most Akamai content is served from caches co-
located within provider infrastructure and IP address space.
Finally, we observe these large sources of inter-domain
traÔ¨Éc are also increasingly highly interconnected with other
providers and each other. We analyze the percentage of
anonymous providers in our study utilizing a direct peering
adjacency with each large content ASN in Table 3. We fo-
cus only on adjacencies representing the majority of traÔ¨Éc
between the anonymous study provider and content ASN
(i.e., we exclude backup and secondary BGP paths). We
Ô¨Ånd that as of July 2009, the majority (65%) of study par-
ticipants use a direct adjacency with Google. Similarly, 52%
maintained a direct peering relationship with Microsoft, 49%
with Limelight and 49% with Yahoo.
4. APPLICATION TRAFFIC ANALYSIS
In this section we explore changes in Internet inter-domain
application traÔ¨Éc patterns between July 2007 and 2009. We
examine both protocols and grouped TCP / UDP per port
breakdowns of inter-domain traÔ¨Éc across diÔ¨Äerent provider
groupings.
We Ô¨Årst provide some additional methodology. The com-
mercial appliances used in this study classify applications by
protocol and TCP/UDP port in the Ô¨Çow record. Since each
Ô¨Çow record may contain multiple port numbers, the appli-
ances follow heuristics (such as preferring a well-known port
over an unassigned port and preferring a port less than 1024
to a higher port) to select a single probable application.
Unfortunately, port numbers alone provide a severely lim-
ited mechanism for classifying applications [33].
In par-
ticular, port-based heuristics could not identify a probable
application in more than 25% of all observed inter-domain
traÔ¨Éc in our study. The unclassiÔ¨Åed traÔ¨Éc includes ap-
plications using either non-standard ports, ephemeral port
numbers, or otherwise unrecognized protocols. For example,
port-based classiÔ¨Åcation only classiÔ¨Åes the control traÔ¨Éc as-
sociated with protocols like FTP and not the semi-random
80ports used by subsequent data transfer (the bulk of the traf-
Ô¨Åc). Port heuristics also do not identify tunneled applica-
tions such as video or other protocols running over HTTP,
nor applications like P2P using encryption or random port
numbers.
Given the limitations of port-based application classi-
Ô¨Åcation, we augment our study dataset with a smaller
set of application statistics based on payload classiÔ¨Åcation
(i.e., DPI). SpeciÔ¨Åcally, we leverage data from inline appli-
ances deployed across the consumer edge of Ô¨Åve cooperating
provider deployments in Asia, Europe and North America
[34]. These Ô¨Åve deployments include traÔ¨Éc representing sev-
eral million cable and DSL subscribers.
The inline probe appliances use a combination of propri-
etary rule-based payload signatures and behavioral heuris-
tics to classify applications. Based on third-party testing
and provider commercial evaluation, these inline probes ach-
ieve a high rate of classiÔ¨Åcation accuracy and represent the
best available ‚Äúground-truth‚Äù with respect to the classiÔ¨Åca-
tion of inter-domain application traÔ¨Éc within these deploy-
ments.
While the payload dataset is not large enough to pro-
vide meaningful extrapolation to all inter-domain traÔ¨Éc,
the dataset does provide additional validation and insight
into our port / protocol application analysis in this Section.
However, given the nature of the inline deployments we be-
lieve the data likely includes a bias towards consumer appli-
cations and P2P since many of the providers purchased the
payload inspection appliances in part based on a perceived
need to manage P2P traÔ¨Éc.
4.1 Largest Applications by TrafÔ¨Åc Volume
In Table 4, we show the ten largest applications by a
weighted average percent of all inter-domain traÔ¨Éc as of
July 2009. Table 4a shows data from port / protocol classi-
Ô¨Åcation of applications and Table 4b displays statistics from
the Ô¨Åve inline / port span payload deployments.
We calculate the rankings in Table 4a using weighted av-
erage percentage of all inter-domain traÔ¨Éc using each well-
known port and protocol. For purposes of highlighting In-
ternet traÔ¨Éc trends, Table 4 groups multiple well-known
ports and protocols into high level application categories.
We observe that many application groupings include dozens
of associated ports / protocols (e.g., P2P).
From Table 4a, we see the majority of inter-domain traÔ¨Éc
in 2009 consists of web as a category at 52% (SSL and other
ports besides TCP port 80 account for less than 5% of this
number). Video as a category represents the second largest
application group at 2.64% and VPN protocols rank third at
1.41% followed by email at 1.38%. Overall, our Ô¨Åndings are
consistent with other recent consumer traÔ¨Éc studies [18].
All other protocols including games, ftp, and news ac-
count for fractions of one percent of inter-domain traÔ¨Éc. As
noted earlier, ports and protocols alone provide a limited
view of Internet application usage and Table 4a includes
a sizable 46% and 37% percentage of unclassiÔ¨Åed traÔ¨Éc in
2007 and 2009, respectively. Since port-based classiÔ¨Åcation
only discovers the control traÔ¨Éc for many Ô¨Åle transfer and
multimedia protocols, we believe Table 4a signiÔ¨Åcantly un-
der represents traÔ¨Éc for video, P2P and Ô¨Åle transfers.
We next look at payload based traÔ¨Éc breakdowns from
the Ô¨Åve consumer deployments in Table 4b. All values rep-
resent the average percentage of subscriber traÔ¨Éc attributed
















	
	











         
	
	
Figure 5: Cumulative distribution of the weighted
average percentage of
inter-domain traÔ¨Éc con-
tributed by well-known ports and protocols for July
2007 and July 2009.
to each application group. We note that the conÔ¨Ågured ap-
plication classiÔ¨Åcations used by the inline commercial appli-
ances diÔ¨Äer from the categories in Table 4a, including the
lack of an explicit matching category for SSH and FTP. The
‚ÄúOther‚Äù category in Table 4b includes dozens of less common
enterprise, database and consumer applications.
Overall, the application breakdowns correspond closely
between the two tables with the notable exception of P2P.
Both Table 4a and Table 4b show Web contributing 52%
of Internet traÔ¨Éc and similarly close percentages for games
and email. VPN and News shows a slightly larger variance
between the two tables likely due to the consumer bias of
the Ô¨Åve inline deployments.
Data from the inline deployments also suggest that HTTP
video may account for 25-40% of all HTTP traÔ¨Éc. In partic-
ular, one of the largest video sites, YouTube, uses progressive
HTTP download. Payload analysis also suggests encrypted
P2P / other ports represent another 10-15% of uncatego-
rized traÔ¨Éc in Table 4a and other video / audio streaming
protocols make up 3-5% of uncategorized traÔ¨Éc. Finally,
the payload statistics show the remaining traÔ¨Éc consists of
a heavy-tailed distribution across hundreds of less common
applications.
4.2 Application TrafÔ¨Åc Changes
In the remainder of this Section, we explore longitudinal
changes in inter-domain application traÔ¨Éc patterns. We ex-
amine both changes in the relative traÔ¨Éc contribution of
application categories as well as speciÔ¨Åc ports and proto-
cols. As with earlier analysis, we use the weighted average
percentage of inter-domain traÔ¨Éc across all providers. We
again observe that growth in this dataset equates to ‚Äúmar-
ket share,‚Äù where a growing application gains traÔ¨Éc at the
expense of other applications.
Not unexpectedly, our analysis Ô¨Ånds TCP and UDP com-
bined account for more than 95% of all inter-domain traÔ¨Éc.
VPN protocols including IPSEC‚Äôs AH and ESP contribute
another 3% and tunneled IPv6 (protocol 41) adds a frac-
tion of one percent. The remaining percentage of protocol
traÔ¨Éc populates a heavy-tailed distribution across the entire
possible protocol number range and likely represents conÔ¨Åg-
urations errors and denial of service attacks.
Figure 5 shows the cumulative distribution of the average
81Rank Application
1
2
3
4
5
6
7
8
9
10
Web
Video
VPN
Email
News
P2P
Games
SSH
DNS
FTP
Other
UnclassiÔ¨Åed
2007
41.68
1.58
1.04
1.41
1.75
2.96
0.38
0.19
0.20
0.21
2.56
46.03
2009 Change
52.00 +10.31
+1.05
+0.38
-0.03
-0.78
-2.11
+0.12
-0.08
-0.04
-0.07
+0.11
-9.03
2.64
1.41
1.38
0.97
0.85
0.49
0.28
0.17
0.14
2.67
37.00
(a) Port / Protocol
Average Percentage
Web
Video
Email
VPN
News
P2P
Games
SSH
DNS
FTP
Other
UnclassiÔ¨Åed
52.12
0.98
1.54
0.24
0.07
18.32
0.52
N/A
N/A
0.16
20.54
5.51
(b) Payload Matching
Table 4: Top application categories. The Ô¨Årst table shows top applications by weighted average percent of
inter-domain traÔ¨Éc in July 2007 and 2009 based on port / protocol classiÔ¨Åcation. The second table shows
average application breakdowns in July 2009 across Ô¨Åve consumer providers using proprietary payload and
application behavioral classiÔ¨Åcation heuristics.
weighted percentage of inter-domain traÔ¨Éc per each TCP
/ UDP port and other protocols over the two year study
period. In July 2007, 52 ports contributed 60% of the traÔ¨Éc.