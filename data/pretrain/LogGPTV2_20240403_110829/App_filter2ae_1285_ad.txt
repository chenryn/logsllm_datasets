**2）比特币地址发现：**
在接收到由用户身份推断模块发送的IP地址，用户身份后，比特币地址发现模块将首先验证该IP地址是否属于SPV客户端，然后发现所有使用的比特币地址由SPV客户端。通过分析截获的数据包，很容易判断IP地址是否属于SPV客户端，因为所有比特币消息均未加密。进一步利用漏洞V1，以低误报率获取受害者的多个过滤器。因此，通过给定的SPV客户端IP地址，此模块将输出一个四元组。
**实施攻击:** 1）准确地拦截受害者的Wi-Fi呼叫数据包，并识别其带有时间戳的呼叫事件和受害者设备的IP地址。例如，可以确定Wi-Fi呼叫用户使用IP地址192.168.1.5在上午10:50:10拨打电话，并在上午10:50:16结束呼出电话。此外，应用了多种计算机视觉技术来通过脸部识别及其带有时间戳的呼叫动作来发现用户的用户身份。这包括两个步骤。首先，对SVM（支持向量机）模型进行了训练，以检测用户的拨号/通话动作。为SVM提供了错误和正常的训练视频。对于每个训练视频，假定可以在人员边界框中识别该人员，并提取其相应的HOG（定向梯度直方图）描述符。使用VLFeat6提取HOG描述符并训练SVM。其次，一旦SVM检测到用户的拨号/通话动作，就会在视频帧中识别出用户身份。将MatConvNet和Tensorflow和DR-GAN模块（Disentangled Representation learning-Generative Adversarial
Network）的深度学习库用作微人脸检测器（即在视频帧中发现人脸）。注意，实际上，攻击者还可以利用一些在线逆向图像搜索引擎（例如*ocialcatfish）来发现人脸对应的身份。
通过关联Wi-Fi推断和视频推断的呼叫事件的时间戳，用户身份推断模块可以将用户身份与IP地址相关联。结果被发送到比特币地址发现模块。
2）对受害设备发起了Wi-Fi取消身份验证攻击，并获得了来自不同nTweaks的多个过滤器。首先，将Aircrack-ng部署在Linux计算机上，并将无线网络适配器卡更改为监视模式，该卡允许该卡发现附近的Wi-Fi路由器及其MAC地址和SSID（Wi-Fi的服务集标识符）路由器，例如“Starbucks WiFi”）。其次，执行命令“ airplay-ng –deauth 0 -c
XX：XX：XX：EC：3B：30 -a XX：XX：XX：36：92：10 wlp3s0mon”，其中EC：3B：30和36：
92:10是用户设备和WiFi路由器的MAC地址的最后三个字节，而wlp3s0mon是无线网络适配器卡。第三，经过5秒的攻击期后，停止了攻击。断开连接的受害设备将在不到10秒的时间内重新连接到Wi-Fi路由器，并传输由新的nTweak生成的filterload消息。通过重复步骤2和3，攻击者可以获得多个filterload消息并标识SPV客户端使用的比特币地址。
**攻击评估：**
首先，邀请了四个学生（U1，U2，U3，U4）参加此评估实验。所有参与者都提供了他们的正面人脸（作为训练数据）和用户身份（例如姓名）。其次，参与者进入安装了监控摄像头和经过测试的Wi-Fi路由器的房间。然后，他们从装有四台经过测试的智能手机的盒子中随机选择了一部手机（所有经过测试的手机均具有相同的型号和相同的颜色）。在经过测试的手机上，激活了Wi-Fi呼叫服务并预安装了比特币钱包应用程序比特币钱包。第三，要求所有参与者拨打至少一个Wi-Fi呼叫并进行比特币交易，该交易在10分钟内将随机数量的BTC转移到一个比特币地址中，进行了五轮试验。
1）结果表明，基于Wi-Fi呼叫的用户身份推断模块可以识别五个实验运行中四个参与者的用户身份（如上表所示）。但是，还观察到呼叫开始/结束时间的平均误差约为1.5秒（即，基于视频的估计时间与Wi-Fi呼叫推断时间之间的误差）。这意味着如果多个用户拨打并结束其通话，以1.5秒的间隔通话，当前的模型可能无法准确识别用户身份。然而，可以通过向用户身份推断模块提供更多的呼叫统计信息（例如，用户在呼叫中保持沉默多长时间）来解决该问题。
2）在收到推断的用户身份和用户的IP地址后，该模块通过上述Wi-Fi取消身份验证攻击获得两个过滤器，应用这两个过滤器来发现SPV客户端使用的所有比特币地址（Bitcoinwallet应用程序），并检索所有相关的比特币交易。上图说明了该模块如何在一次实验运行中对与参与者U1使用的比特币钱包相关的所有比特币地址和比特币交易进行匿名处理。图左、中和右分别显示（1）使用不同nTweaks生成的两个filterload消息，（2）成功通过两个过滤器的比特币地址，（3）所有比特币分别与发现的比特币地址有关的交易。参与者U1完成了最后一笔比特币交易（No.
41），目的是在此次实验运行期间将0.0003 BTC转移到比特币地址之一；参与者U1确认了这个结果。
这种攻击的关键结果是多维用户隐私泄漏，它不仅使比特币钱包智能手机用户的所有比特币地址和交易匿名，而且还基于受害者独特应用层的基于比特币钱包的指纹，为攻击者提供可靠的用户跟踪机制（即受害者比特币钱包应用程序使用的比特币地址）
。
SPV客户端使用的比特币地址可以被视为其唯一的钱包指纹，这有两个原因。首先，比特币地址冲突（即，不同钱包使用的比特币地址）仅在下一个千年中发生。其次，本文攻击可以准确地发现SPV客户端使用的所有比特币地址，因为攻击者可以将攻击中的误报率（攻击者错误地标识比特币地址的概率）自由地降低到10^(-5K)，其中K为已发起的Wi-Fi取消身份验证攻击的数量。实际上，由于隐私问题，用户可能会增加默认的误报率。但是，此攻击仍然可以容纳较高的默认识别率。例如，如果将比率设置为50％，则攻击者可以通过发起10次攻击来将比率显着降低到0.097％。
这种攻击可能不切实际，因为它要求攻击者部署监视摄像头和Wi-Fi网络以监视智能手机用户的活动。尽管攻击者在某些公共场所发起这种攻击并在特定时间段（例如几个小时）内监视移动用户并不是很困难。但是，如果受监视的用户在攻击时间内未访问任何Wi-Fi呼叫服务，则攻击者无法将比特币钱包应用程序所有者的身份匿名化，也无法将身份与比特币钱包指纹（即使用的比特币地址）相关联。因此，攻击者没有动力大规模发起这种攻击，因此这种攻击在现实世界中的影响是有限的。
由于三个原因，情况并非如此。首先，根据最近的报告/研究，比特币是犯罪分子用来绕过货币和执法机构监督以欺诈用户、勒索赎金的方法。为了有效防止犯罪分子破坏金融秩序和阻止网络攻击，监管者有动机去发现比特币钱包用户的真实身份。第二，如今，为了公共安全起见，在日常生活中观察监视摄像机并不罕见。例如，在伦敦（英国）和北京（中国）分别部署了约627,000和1,150,000闭路电视摄像机。此外，在某些国家/地区，例如中国，美国（芝加哥，底特律），政府已应用面部识别技术和部署的监视摄像机来追踪罪犯。第三，在万物互联的时代，一些城市（例如，纽约，莫斯科，香港，汉城，巴黎）和国家（例如，英国，瑞士，新加坡，丹麦）已为其居民部署了公共Wi-Fi热点。最新的报告预测，全球公共Wi-Fi热点的数量将从2018年的1.69亿个热点增加到2023年的6.28亿个，增长了四倍，约有71％的移动通信流向Wi-Fi，这导致Wi-Fi通话市场的需求上升。为了抵御非法金融交易/交易，监管者有动机发起比特币去匿名攻击。但是，这并不意味着无论出于何种原因都可以损害比特币钱包App用户的隐私。
###  B.反射和放大比特币垃圾信息攻击
该攻击旨在利用良性的比特币全节点客户端向受害者引入持续的、不必要的比特币流量（例如14-20 MB
/小时），这会导致蜂窝网络数据账单增加和功耗增加96％。通过利用V2，攻击者可以执行比特币钱包应用程序，以从连接的比特币FNC连续下载不需要的比特币交易。
**攻击者的假设：** 攻击者可以拦截和修改受害者与受害者连接的比特币FNC之间传输的比特币消息。
**攻击设计：** 此攻击的工作方式如下，首先拦截由比特币钱包应用程序（例如，Bitcoin
Wallet）发送到连接的比特币FNC的filterload消息。其次，攻击者可以通过将字段Data和nFlags分别更改为0xFF..FF和0来修改拦截的filterload消息，因为该消息不支持加密和完整性保护。这些修改用于告知比特币全节点客户端，即用户对所有比特币交易都感兴趣。攻击者进一步将该欺骗信息发送给比特币FNC。
**实施攻击：**
通过在Trudy之上开发一个BitCoinTrudy服务器来实施此攻击。在受害者和比特币FNC之间部署了BitCoinTrudy服务器，这帮助攻击者识别并拦截了filterload消息，修改了Data和nFlag字段，相应地更新了Bitcoin消息的校验和和TCP校验和，并将欺骗性的filterload消息传递给了连接的比特币FNC。
攻击评估：用两个指标评估了垃圾信息攻击的危害，（1）垃圾信息流量和（2）受害者手机的功耗。评价实验如下进行。首先在使用Android
8.1.0的两台Google Pixel
XL手机上安装了经过测试的比特币钱包应用程序（即，比特币钱包）。其次，通过比特币钱包创建了两个比特币账户。第三，启动了比特币钱包和电池消耗监视工具（即Batterystats），该工具连续监视两台经过测试的智能手机上的电池使用情况。记录了两个经过测试的智能手机的比特币流量和功耗。第四，使用开发的BitCoinTrudy对一台经过测试的智能手机发起了设计好的比特币垃圾信息攻击。当受害者的电池电量耗尽时，实验停止。
**1）垃圾信息流量：** 上图a-c分别绘制了每小时比特币垃圾信息流量，累积的比特币垃圾信息流量以及在受害者身上观察到的放大系数。有三个观察结果。首先，受到攻击的手机每小时将接收14-20
MB的比特币流量，而不受攻击的手机每小时将仅接收1-2 MB的比特币流量。其次，在10小时的实验中，受害者的手机接收到约164