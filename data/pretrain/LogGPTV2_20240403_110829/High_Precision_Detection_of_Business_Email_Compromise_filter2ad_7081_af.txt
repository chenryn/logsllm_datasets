compromise by modeling employee behavior, and detecting
anomalies in outbound emails. Once an anomaly is detected,
the employee is asked to re-authenticate with two-factor au-
thentication. However, their technique suffers from very high
false positive rates (1%-8%, compared with 1 in millions of
emails in BEC-Guard), and the analysis is based on a small
corpus of emails.
Another contemporaneous study done at Barracuda Net-
works by Ho et al. [18,19] examines the behavior of attackers
using compromised accounts and possible ways to detect ac-
count takeover incidents. The techniques presented in this
paper are complimentary with the other study, and focus on a
different type of attack.
Finally, there is a large body of work on adverserial learn-
ing in the context of spam detection [3, 4, 8, 21, 31, 32, 37, 50]
that is relevant to our work. In the future, we plan to incorpo-
rate some of the evasion techniques introduced in past work,
including randomization and the use of honey pots to trick
adversaries.
9 Conclusions
BEC is a signiﬁcant cyber security threat that results in bil-
lions of dollars of losses a year. We present the ﬁrst system
that detects a wide variety of BEC attacks at a high precision
and false positives, and is used by thousands of organizations.
BEC-Guard prevents these attacks in real-time using a novel
API-based architecture combined with supervised learning.
One of the main lessons we have learned in developing
and deploying BEC-Guard, is that attackers constantly adapt
their tactics and approaches. While our supervised learning
approach does require continuously retraining our classiﬁers,
and is not fully generalizable, we have found the general
approach of using historical email patterns via an API-based
architecture has been very useful in quickly developing new
classiﬁers for evolving threats. We have employed a similar
approach to the one described in this paper in other contexts,
such as detecting brand impersonation, generic sender names
and account takeover.
Acknowledgments
We thank Grant Ho, our shepherd, Devdatta Akhawe, and the
anonymous reviewers for their thoughtful feedback.
References
[1] R Anglen.
First-time
phoenix homebuyer
scam, 2017.
duped out of $73k in real-estate
https://www.azcentral.com/story/news/local/
arizona-investigations/2017/12/05/first-
time-phoenix-homebuyer-duped-out-73-k-
real-estate-scam/667391001/.
[2] Manos Antonakakis, Roberto Perdisci, David Dagon,
Wenke Lee, and Nick Feamster. Building a dynamic
reputation system for DNS. In Proceedings of the 19th
USENIX Conference on Security, USENIX Security’10,
pages 18–18, Berkeley, CA, USA, 2010. USENIX As-
sociation.
[3] Marco Barreno, Blaine Nelson, Anthony D. Joseph, and
J. D. Tygar. The security of machine learning. Machine
Learning, 81(2):121–148, Nov 2010.
1304    28th USENIX Security Symposium
USENIX Association
[4] Marco Barreno, Blaine Nelson, Russell Sears, An-
thony D. Joseph, and J. D. Tygar. Can machine learning
be secure? In Proceedings of the 2006 ACM Symposium
on Information, Computer and Communications Secu-
rity, ASIACCS ’06, pages 16–25, New York, NY, USA,
2006. ACM.
[5] Leo Breiman. Random forests. Machine Learning,
45(1):5–32, Oct 2001.
[6] Nitesh V. Chawla, Kevin W. Bowyer, Lawrence O. Hall,
and W. Philip Kegelmeyer. Smote: Synthetic minority
over-sampling technique. J. Artif. Int. Res., 16(1):321–
357, June 2002.
[7] A. Cidon.
Threat
spotlight:
Spear phish-
hooking a big one., 2017.
ing for mortgages.
https://blog.barracuda.com/2017/07/31/
threat-spotlight-spear-phishing-for-
mortgages-hooking-a-big-one/.
Sotiris Ioannidis, editors, Research in Attacks, Intrusions,
and Defenses, pages 69–91, Cham, 2018. Springer In-
ternational Publishing.
[15] John A Hartigan and Manchek A Wong. Algorithm AS
136: A k-means clustering algorithm. Journal of the
Royal Statistical Society. Series C (Applied Statistics),
28(1):100–108, 1979.
[16] Alex Hern. Unicode trick lets hackers hide phishing
URLs, 2017.
https://www.theguardian.com/
technology/2017/apr/19/phishing-url-trick-
hackers.
[17] L Hernandez. Homebuyers lose life savings during wire
fraud transaction, sue Wells Fargo, realtor and title com-
pany, 2017. https://www.thedenverchannel.com/
money/consumer/homebuyers-lose-life-
savings-during-wire-fraud-transaction-
sue-wells-fargo-realtor-title-company.
[8] Nilesh Dalvi, Pedro Domingos, Mausam, Sumit Sang-
hai, and Deepak Verma. Adversarial classiﬁcation. In
Proceedings of the Tenth ACM SIGKDD International
Conference on Knowledge Discovery and Data Mining,
KDD ’04, pages 99–108, New York, NY, USA, 2004.
ACM.
[18] Grant Ho, Asaf Cidon, Lior Gavish, Marco
Schweighauser, Vern Paxson, Stefan Savage, Ge-
offrey M. Voelker, and David Wagner. Detecting and
characterizing lateral phishing at scale. In 26th USENIX
Security Symposium (USENIX Security 19). USENIX
Association, 2019.
[9] Pedro Domingos. Metacost: A general method for mak-
ing classiﬁers cost-sensitive. In Proceedings of the ﬁfth
ACM SIGKDD international conference on Knowledge
discovery and data mining, pages 155–164. ACM, 1999.
[10] Sevtap Duman, Kubra Kalkan-Cakmakci, Manuel Egele,
William Robertson, and Engin Kirda. EmailProﬁler:
Spearphishing ﬁltering with header and stylometric fea-
tures of emails. In Computer Software and Applications
Conference (COMPSAC), 2016 IEEE 40th Annual, vol-
ume 1, pages 408–416. IEEE, 2016.
[11] Luca Invernizzi Elie Bursztein, Kylie McRoberts.
payments
Tracking
end to end.
Black Hat USA 2017, 2017.
https://www.elie.net/talk/tracking-desktop-
ransomware-payments-end-to-end.
ransomware
desktop
[12] FBI. Cyber-enabled ﬁnancial fraud on the rise glob-
https://www.fbi.gov/news/stories/
ally, 2017.
business-e-mail-compromise-on-the-rise.
[13] FBI. Business email compromise, the 12 billion dol-
lar scam, 2018. https://www.ic3.gov/media/2018/
180712.aspx.
[14] Hugo Gascon, Steffen Ullrich, Benjamin Stritter, and
Konrad Rieck. Reading between the lines: Content-
agnostic detection of spear-phishing emails. In Michael
Bailey, Thorsten Holz, Manolis Stamatogiannakis, and
[19] Grant Ho, Asaf Cidon, Lior Gavish, Marco
Schweighauser, Vern Paxson, Stefan Savage, Ge-
offrey M. Voelker, and David Wagner. Detecting and
Characterizing Lateral Phishing at Scale (Extended
Report). In arxiv, 2019.
[20] Grant Ho, Aashish Sharma, Mobin Javed, Vern Paxson,
and David Wagner. Detecting credential spearphishing
in enterprise settings. In 26th USENIX Security Sympo-
sium (USENIX Security 17), pages 469–485, Vancouver,
BC, 2017. USENIX Association.
[21] Ling Huang, Anthony D. Joseph, Blaine Nelson, Ben-
jamin I. P. Rubinstein, and J. Doug Tygar. Adversarial
machine learning. In AISec, 2011.
[22] Infosec Institute.
Phishing data – attack statistics,
2016. http://resources.infosecinstitute.com/
category/enterprise/phishing/the-phishing-
landscape/phishing-data-attack-statistics/.
[23] SANS Institute.
From the trenches: Sans 2016
survey on security and risk in the ﬁnancial sector,
2016.
https://www.sans.org/reading-room/
whitepapers/analyst/trenches-2016-survey-
security-risk-financial-sector-37337.
[24] Nathalie Japkowicz. The class imbalance problem: Sig-
niﬁcance and strategies. In Proc. of the Int‘l Conf. on
Artiﬁcial Intelligence, 2000.
USENIX Association
28th USENIX Security Symposium    1305
[25] M. Korolov. Report: Only 6% of businesses use
DMARC email authentication, and only 1.5% enforce
it, 2016.
https://www.csoonline.com/article/
3145712/security/.
[26] Miroslav Kubat, Robert C Holte, and Stan Matwin. Ma-
chine learning for the detection of oil spills in satel-
lite radar images. Machine learning, 30(2-3):195–215,
1998.
[27] Miroslav Kubat, Stan Matwin, et al. Addressing the
curse of imbalanced training sets: one-sided selection.
In ICML, volume 97, pages 179–186. Nashville, USA,
1997.
[28] M. Lan, C. L. Tan, J. Su, and Y. Lu. Supervised and
traditional term weighting methods for automatic text
categorization. IEEE Transactions on Pattern Analysis
and Machine Intelligence, 31(4):721–735, April 2009.
[29] David D Lewis and Jason Catlett. Heterogeneous uncer-
tainty sampling for supervised learning. In Proceedings
of the eleventh international conference on machine
learning, pages 148–156, 1994.
[30] Charles X Ling and Chenghui Li. Data mining for direct
marketing: Problems and solutions. In KDD, volume 98,
pages 73–79, 1998.
[31] Daniel Lowd. Good word attacks on statistical spam
In Proceedings of the Second Conference on
ﬁlters.
Email and Anti-Spam (CEAS, 2005.
[32] Daniel Lowd and Christopher Meek. Adversarial learn-
In Proceedings of the Eleventh ACM SIGKDD
ing.
International Conference on Knowledge Discovery in
Data Mining, KDD ’05, pages 641–647, New York, NY,
USA, 2005. ACM.
[33] Microsoft. Anti-spooﬁng protection in Ofﬁce 365,
2019.
https://docs.microsoft.com/en-us/
office365/securitycompliance/anti-spoofing-
protection.
[34] Tomas Mikolov, Ilya Sutskever, Kai Chen, Greg S Cor-
rado, and Jeff Dean. Distributed representations of
words and phrases and their compositionality. In C. J. C.
Burges, L. Bottou, M. Welling, Z. Ghahramani, and K. Q.
Weinberger, editors, Advances in Neural Information
Processing Systems 26, pages 3111–3119. Curran Asso-
ciates, Inc., 2013.
[35] Yoav Nathaniel.
ZeroFont phishing: Manipu-
lating font size to get past Ofﬁce 365 secu-
rity, 2018.
https://www.avanan.com/resources/
zerofont-phishing-attack.
[36] C Northern. Nickname and diminutive names lookup,
https://github.com/carltonnorthern/
2017.
nickname-and-diminutive-names-lookup.
[37] N. Papernot, P. McDaniel, S. Jha, M. Fredrikson, Z. B.
Celik, and A. Swami. The limitations of deep learning
in adversarial settings. In 2016 IEEE European Sympo-
sium on Security and Privacy (EuroS P), pages 372–387,
March 2016.
[38] Michael Pazzani, Christopher Merz, Patrick Murphy, Ka-
mal Ali, Timothy Hume, and Clifford Brunk. Reducing
misclassiﬁcation costs. In Proceedings of the Eleventh
International Conference on Machine Learning, pages
217–225, 1994.
[39] N. Perlroth.
Hackers are targeting nuclear fa-
say,
https://www.nytimes.com/2017/07/06/
cilities, Homeland Security Dept. and F.B.I.
2017.
technology/nuclear-plant-hack-report.html.
[40] J. Ross Quinlan. C4.5: Programs for Machine Learning.
Morgan Kaufmann Publishers Inc., San Francisco, CA,
USA, 1993.
[41] J.J. Roberts. Facebook and Google were victims of
$100m payment scam, 2017. http://fortune.com/
2017/04/27/facebook-google-rimasauskas/.
[42] G. Salton and M. J. Mcgill. Introduction to Modern
Information Retrieval. McGraw-Hill, Inc., New York,
NY, USA, 1986.
[43] Z. Song and N. Roussopoulos. K-nearest neighbor
search for moving query point. pages 79–96, 2001.
[44] United States Securities and Exchange Commission.
Form 8-k, 2015. https://www.sec.gov/Archives/
edgar/data/1511737/000157104915006288/
t1501817_8k.htm.
[45] Gianluca Stringhini and Olivier Thonnard. That ain’t
you: Blocking spearphishing through behavioral mod-
In International Conference on Detection of
elling.
Intrusions and Malware, and Vulnerability Assessment,
pages 78–97. Springer, 2015.
[46] Andrew Trask, Phil Michalak, and John Liu. sense2vec
- A fast and accurate method for word sense disambigua-
tion in neural word embeddings. CoRR, abs/1511.06388,
2015.
[47] Gary M Weiss and Haym Hirsh. Learning to predict
rare events in event sequences. In KDD, pages 359–363,
1998.
[48] Colin Whittaker, Brian Ryner, and Marria Nazif. Large-
In
scale automatic classiﬁcation of phishing pages.
NDSS ’10, 2010.
1306    28th USENIX Security Symposium
USENIX Association
[49] C. Willems, T. Holz, and F. Freiling. Toward automated
dynamic malware analysis using CWSandbox. IEEE
Security Privacy, 5(2):32–39, March 2007.
[50] Gregory L. Wittel and S. Felix Wu. On attacking statis-
tical spam ﬁlters. In Proceedings of the Conference on
Email and Anti-Spam (CEAS), 2004.
[51] Gang Wu and Edward Y Chang. Class-boundary align-
ment for imbalanced dataset learning. In ICML 2003
workshop on learning from imbalanced data sets II,
Washington, DC, pages 49–56, 2003.
USENIX Association
28th USENIX Security Symposium    1307