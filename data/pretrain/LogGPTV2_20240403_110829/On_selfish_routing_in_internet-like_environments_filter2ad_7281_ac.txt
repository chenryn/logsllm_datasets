### 自私源路由：不同网络拓扑下的最大链路利用率和网络成本比较

**Figure 6: 自私源路由：使用M/M/1链路延迟在不同网络拓扑下比较最大链路利用率和网络成本。**

- **(a) 最大链路利用率 (%)**
- **(b) 网络成本**

#### 6.3 总结
在本节中，我们使用实际的网络拓扑和流量需求对比了不同路由方案的性能。结果显示，与理论上的最坏情况不同，四个曲线（源路由、优化合规的OSPF权重下的覆盖源路由、基于跳数的覆盖源路由）几乎重合。这表明无论是基于跳数还是优化合规权重的路由约束对用户延迟或系统整体成本的影响都很小。这一结果出乎意料，因为我们的初步假设是路由约束会降低性能。

相比之下，当网络级路由使用随机权重时，我们观察到更高的延迟和链路利用率。为了理解这一结果，我们在下面引入了一个称为直接链路最短 (DLS) 的概念。

**图7: 自私源路由：不同延迟函数下的最大链路利用率和网络成本比较。**

- **(a) 最大链路利用率 (%)**
- **(b) 网络成本**

自私源路由在类似互联网的环境中非常有效地选择最短路径，并且平均延迟接近最优。然而，这也常常导致最短路径上的链路过载。这表明自私路由可能对流量工程产生负面影响。我们将在第9节进一步探讨这个问题。

### 自私自覆盖路由

前面的评估考虑了自私源路由。然而，正如我们在第1节中讨论的那样，在实践中，终端用户往往没有完全的路由控制权。我们最初预计减少路由灵活性会增加延迟和链路利用率，因为用户失去了对路由的细粒度控制。然而，如我们将看到的，这并不总是如此。

#### 7.1 当每个节点都在覆盖层中时，自私覆盖路由表现如何？

首先，我们考虑一个包含所有网络节点的覆盖层。请注意，即使覆盖层包括所有网络节点，覆盖层上的路由仍然不同于物理网络上的路由，后者可以访问所有网络资源，而前者则不一定。例如，网络级路由可以通过将路由矩阵中的相应列设置为0来阻止任何覆盖层流量使用特定链路（在OSPF中，这可以通过给链路分配一个很大的权重来实现）。因此，某些物理路由无法通过任何覆盖层路由方案实现。

在我们的评估中，我们使用与之前相同的网络设置，只是覆盖层节点之间的路由不再由终端用户决定，而是由网络级路由决定。我们采用OSPF进行网络级路由，并使用第3节中描述的三种OSPF权重分配方法。

**图8: 自私自覆盖路由：ISP拓扑下的用户延迟和最大链路利用率比较。**

- **(a) 延迟**
- **(b) 最大链路利用率**

**定义1 (直接链路最短, DLS): 如果对于任何物理相邻的节点A和B，所有从A到B的流量都通过直接链路AB而不涉及其他链路，则我们认为该网络级路由方案是直接链路最短 (DLS)。例如，基于跳数的OSPF是一个DLS路由方案。**

关于DLS路由方案的关键观察如下：在一个覆盖所有网络节点并满足DLS的覆盖层中，覆盖层上的路由具有与直接在底层物理网络上路由相同的灵活性。这是因为根据DLS的定义，覆盖层可以通过指定具有相同节点序列的覆盖路径N1 → ... → Nk来强制流量遵循任何给定的物理路径N1N2...Nk，其中节点Ni和Ni+1是物理相邻的。鉴于此观察，由于基于跳数的OSPF满足DLS，其表现与源路由一样好。至于优化合规的OSPF权重，我们的验证显示这种权重在很大程度上也满足DLS，因此其表现也很好。

上述观察的一个含义是，只有在网络级路由方案违反DLS时，才能影响给定链路AB上的自私覆盖流量。在OSPF的背景下，这只能通过选择权重使得从节点A到B的替代路径的总权重低于或等于AB的OSPF权重来实现。当替代路径的总权重较低时，AB实际上被从网络中剪除，因为没有任何覆盖层流量可以使用它。当存在平局时，可以实现一定程度的负载均衡。然而，这样的平局在我们的实验中非常罕见。因此，违反DLS实际上减少了可供自私覆盖使用的网络资源，从而可能导致更高的延迟和链路利用率。

使用随机OSPF权重时，违反DLS的情况很常见，因此可供覆盖层使用的网络资源显著减少。这解释了为什么我们看到随机OSPF权重下的延迟和最大链路利用率显著更高。

我们将在第9节中展示，自私覆盖路由与OSPF优化器的交互效果差的原因与此相同。

我们通过使用不同的网络拓扑进一步验证了上述观察。结果如图9所示。与之前一样，随机OSPF权重继续导致显著更高的延迟和最大链路利用率，而其他三种方法的表现相近。这证实了我们之前的发现。在比较不同路由方案的性能时，我们观察到自私路由继续导致接近最优的平均延迟。此外，在大多数情况下，它的延迟明显低于合规路由。然而，这种低延迟通常伴随着更高的最大链路利用率。

**图9: 不同网络拓扑下的自私覆盖路由性能比较。**

- **(a) 延迟**
- **(b) 最大链路利用率**

**负载比例因子 = 1**

- **平均延迟 (秒)**
- **路由方案**

希望这些改进使文本更加清晰、连贯和专业。