 0
 0
 50  100  150  200  250  300  350  400  450  500
a. Verified Protocol (Density=3, directional density = 9.7)   b. Strict Protocol (Density = 3, directional density = 9.7) 
x (meters)
x (meters)
Figure  9.    Impact  on  Connectivity.    Circular  nodes  establish  all  possible  links; 
triangular nodes establish some links, but are unable to establish at least one possible 
link; solid square nodes are unable to establish any links. 
disconnected nodes rates are 58% and 5.3% respectively.   
For a more typical network density of 10 neighbors (32.4 
neighbors  within  the  directional  transmission  distance), 
less  than  0.5%  of  links  are  lost  and  no  nodes  are 
disconnected in verified neighbor discovery protocol, and 
40% of links are lost and 0.03% nodes are disconnected in 
strict neighbor discovery protocol.   
The closer nodes are to each other, the more likely they 
are find a verifier and establish a link. Figure 10 shows the 
impact  of  the  distance  between  two  nodes  on  their 
likelihood of establishing a link.    For a reasonably dense 
network  (omnidirectional  density  >  10),  nearly  all  links 
are  kept  when  the  distance  of  nodes  is  within  r  in  the 
verified protocol or within 0.6r in the strict protocol.   
Few  nodes  are  completely  disconnected  with  either 
protocol, but the lost links can affect routing performance.   
Figure 11 shows the impact of our protocols on network 
o
i
t
a
R
d
e
t
c
e
n
n
o
C
s
k
n
L
i
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
 0
Verified Protocol (Density=10)
Verified Protocol (Density=3)
Strict Protocol (Density=10)
Strict Protocol (Density=3)
 0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
 1
Figure 10.    Node distance and connectivity.   
Node Distance (r)
routing.    We use the shortest path routing to evaluate our 
protocol, and measure average route path length when the 
network density changes from 4 to 20.    The results show 
that using the verified protocol for routing has virtually no 
impact  on  the  path  length:  the  path  length  is  almost 
identical.    The strict protocol will increase the path length 
around  20%  when  the  network  is  reasonably  dense 
(omnidirectional density > 10). 
7. Directional Errors 
So far, we have assumed nodes always hear each other 
in directly opposite directions (e.g., if node A hears node B 
in zone 1, node B hears node A in zone 4).    In a typical 
deployment, this is often not the case.    If nodes are near 
Directional Transmission
Verified Protocol
Strict Protocol
 10
 9
 8
 7
 6
 5
 4
 3
 2
 1
h
t
g
n
e
L
h
t
a
P
e
g
a
r
e
v
A
 0
 4
 6
 10
 8
 16
Omnidirectional Node Density
 12
 14
 18
 20
Figure 11. Impact on routing path length. 
o
i
t
a
R
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
Lost Links, Strict Protocol
Lost Links, Verified Protocol
Disconnected Nodes, Strict Protocol
Disconnected Nodes, Verified Protocol
Lost Links, Strict Protocol
Lost Links, Verified Protocol
Disconnected Nodes, Strict Protocol
Disconnected Nodes, Verified Protocol
 20
 10
 50
Maximum Directional Error Degree
 0
 60
a. Density = 3 (9.7 directional density)  
 30
 40
 20
 10
 50
Maximum Directional Error Degree
 0
b. Density = 10 (32.4 directional density) 
 30
 40
 60
Figure 12.    Impact of directional errors. 
o
i
t
a
R
 1
 0.9
 0.8
 0.7
 0.6
 0.5
 0.4
 0.3
 0.2
 0.1
 0
the transition point between two zones, small differences 
in  node  orientation,  antenna  alignment  and  gain,  and 
transmission  irregularities  will  lead  to  legitimate  nodes 
appearing to be in the wrong zone.    As result, some links 
between legitimate neighbors will be lost. 
Figure  12  shows  the  impact  of  directional  errors  on 
network connectivity.    We assume directional errors can 
be modeled by disorienting nodes by a random angle that 
is ± the maximum directional error.    Hence, for maximum 
directional  error  of  60  degrees,  the  average  node  is 
misoriented by ½ zone.    The fraction of links lost because 
of directional errors increases linearly with the directional 
error.    For  a  reasonably  dense  network,  even  as  the 
directional  error  reaches  60  degrees  fewer  than  0.1%  of 
nodes are fully disconnected. 
Another  approach  to  directional  errors  would  be  to 
accept  communications  from  directions  that  are  not 
directly opposite the reception direction, but rather in an 
adjacent  zone.    This  would  eliminate  most  of  the  links 
lost to directional errors, but would substantially weaken 
the security of the protocol. 
8. Conclusion 
Wormhole  attacks  are  a  powerful  attack  that  can  be 
conducted  without  requiring  any  cryptographic  breaks.   
An attacker who conducts a successful wormhole attack is 
in  a  position  to  disrupt  routing,  deny  service  to  large 
segments  of  a  network,  and  use  selective  forwarding  to 
tamper  with  network  applications.    Directional  antennas 
offer  a  promising  approach  to  preventing  wormhole 
attacks.    They are less expensive than many mechanisms 
proposed  for  localization,  and  offer  other  advantages  in 
addition to security including more efficient use of energy 
and  better  spatial  use  of  bandwidth.    The  protocols  we 
propose  reduce  the  threat  of  wormhole  attacks  with 
minimal loss of network connectivity.    Given the lack of 
availability  of  other  suitable  defenses  and  the  potential 
damage  a  successful  wormhole  attack  can  inflict,  this 
tradeoff is desirable for many applications. 
Acknowledgements 
This  work  was  supported  by  the  National  Science 
Foundation  through  CAREER  (CCR-0092945)  and  ITR 
(EIA-0205327)  awards.    Chalermpong  Worawannotai 
discovered the “Worawannotai attack” and suggested the 
solution.     
References 
[1]  N. Bulusu, J. Heidemann and D. Estrin. GPS-less Low Cost 
Outdoor  Localization  for  Very  Small  Devices.  IEEE 
Personal Communications Magazine, October 2000. 
[2]  S. Bandyopadhyay, K. Hausike, S. Horisawa and S. Tawara. 
An Adaptive MAC and Directional Routing Protocol for Ad 
Hoc  Wireless  Networks  Using  ESPAR  Anenna. 
ACM/SIGMOBILE MobiHoc October 2001. 
[3]  H.  Chan,  A.  Perrig  and  D.  Song.  Random  Key 
for  Sensor  Networks.  IEEE 
Predistribution  Schemes 
Symposium on Security and Privacy 2003. 
[4]  R.  Choudhury,  X.  Yang,  R.  Ramanathan  and  N.  Vaidya. 
Using Directional Antennas for Medium Access Control for 
Ad Hoc Network. ACM MobiCom 2002, September 2002. 
[5]  R.  Choudhury  and  N.  Vaidya.  Ad  Hoc  Routing  Using 
Directional  Antennas.  University  of  Illinois,  Coordinated 
Science Laboratory, Technical Report, August 2002. 
[6]  L. Eschenauer and V. Gligor. A Key-Management Scheme 
for  Distributed  Sensor  Networks.  ACM  Conference  on 
Computer and Communication Security, November 2002. 
[7]  Y. Hu, D. Johnson, and A. Perrig. SEAD: Secure efficient 
distance vector routing for mobile wireless ad hoc networks. 
IEEE  Workshop  on  Mobile  Computing  Systems  and 
Applications, June 2002. 
[25] R.  Ramanathan.  On  the  Performance  of  Beamforming 
Antennas  in  Ad  Hoc  Network.  MobiHoc  2001,  October 
2001. 
[26] R.  Ramanathan,  Redi,  Santivanez,  Wiggins  and  Polit.  Ad 
Hoc  Networking  with  Directional  Antennas:  A  Complete 
Solution. BBN Technical Report, 2003. 
[27] C.  Santivanez  and  J.  Redi.  On  The  Use  of  Directional 
Antennas  for  Sensor  Networks.  Military  Communications 
Conference (MILCOM 2003), October 2003. 
[28] N.  Sastry,  U.  Shankar,  and  D.  Wagner.    Secure 
Verification of Location Claims.    ACM Workshop on 
Wireless Security (WiSe 2003), September 19, 2003. 
[29] B. Wellenhoff, H. Lichtenegger and J. Collins. Global 
Positions  System:  Theory  and  Practice,  Fourth 
Edition. Springer Verlag, 1997. 
[8]  Y.  Hu,  A.  Perrig  and  D.  Johnson.  Ariadne:  A  Secure 
On-Demand Routing Protocol for Ad Hoc Networks. ACM 
MobiCom 2002, September 2002. 
[9]  Y.  Hu,  A.  Perrig,  and  D.  Johnson.  Packet  Leashes:  A 
Defense  against  Wormhole  Attacks  in  Wireless  Ad  Hoc 
Networks. INFOCOM 2003, April 2003. 
[10] T. He, C. Huang, B. Blum, J. Stankovic and T. Abdelzaher. 
Range-Free  Localization  Schemes  for  Large  Scale  Sensor 
Networks. ACM MobiCom 2003, September 2003. 
[11] D. Johnson, D. Maltz, and J. Broch. The Dynamic Source 
Routing Protocol for Multihop Wireless Ad Hoc Networks. 
In  Ad  Hoc  Networking,  C.  Perkins,  Ed.  Addison-Wesley, 
2001. 
[12] T. Korakis, G. Jakllari and L. Tassiulas. A MAC protocol for 
full exploitation of Directional Antennas in Ad-hoc Wireless 
Networks. MobiHoc 2003. 
[13] C. Karlof, Y. Li, J. Polastre. ARREVE: Algorithm for Robust 
in  Volatile  Environments.  Technical  Report 
Routing 
UCB//CSD-03-1233, March 2003. 
[14] Y. Ko, V. Shankarkumar and N. H. Vaidya. Medium access 
control  protocols  using  directional  antennas  in  ad  hoc 
networks. IEEE INFOCOM, 2000. 
[15] C.  Karlof  and  D.  Wagner.  Secure  Routing  in  Sensor 
Networks:  Attacks  and  Countermeasures.  First  IEEE 
International Workshop on Sensor Network Protocols and 
Applications, May, 2003.   
[16] S.  Marti,  T.  J.  Giuli,  K.  Lai,  and  M.  Baker.  Mitigating 
routing misbehavior in mobile ad hoc networks. ACM/IEEE 
International  Conference  on  Mobile  Computing  and 
Networking, 2000. 
[17] A. Nasipuri, J. Mandava, H. Manchala and R. E. Hiromoto. 
On Demand Routing Using Directional Antennas in Mobile 
Ad  Hoc  Networks.  IEEE  Wireless  Communications  and 
Networking Conference (WCNC), September 2000. 
[18] D. Niculescu and B. Nath. Ad Hoc Positioning System (APS) 
using AoA. INFOCOM 2003. 
[19] R. Nagpal, H. Shrobe and J. Bachrach. Organizing a Global 
 Coordinate System from Local Information on an Ad Hoc 
Sensor  Network.  2nd 
International  Workshop  on 
Information  Processing  in  Sensor  Networks  (IPSN  '03), 
April, 2003. 
[20] A. Nasipuri, S. Ye, J. You, R.E. Hiromoto. A MAC protocol 
for  mobile  ad-hoc  networks  using  directional  antennas. 
IEEE  Wireless  Communications 
and  Networking 
Conference, September 2000. 
[21] C.  E.  Perkins  and  P.  Bhagwat.  Highly  dynamic 
destination-sequenced  distance-vector  routing  (DSDV)  for 
mobile  computers.  ACM  SIGCOMM  Conference  on 
Communications Architectures, Protocols and Applications, 
1994. 
[22] A. Perrig, R. Szewczyk, V. Wen, D. Culler and D. Tygar. 
SPINS:  Security  Protocols  for  Sensor  Networks.  Wireless 
Networks Journal, September 2002. 
[23] P. Papadimitratos and Z. Haas. Secure routing for mobile ad 
hoc  networks.  SCS  Communication  Networks  and 
Distributed Systems Modeling and Simulation Conference, 
January 2002. 
[24] C.  Perkins  and  E.  Royer.  Ad-Hoc  On-Demand  Distance 
Vector  Routing.  IEEE  Workshop  on  Mobile  Computing 
Systems and Applications, February 1999.