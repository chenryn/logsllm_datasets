performs excellently.
It is below OPT but consistently overlaps
Previous-OPT, which is an upper bound for schemes that track the
channel and do not predict the future. ESNR is accurate on 75% of
packets, with the expected 10% target over-selection.
Figure 10 shows the effects of mobility on SISO channels. Each
Figure 9: OPT and ESNR SISO performance in human-speed
mobility.
Figure 10: OPT and ESNR SISO performance in fast mobile
channels.
line plots the average rate as a function of the speed at which we
play the trace. We cover a large range of speeds to show trends,
in doubling increments from 1× (walking speed, ≈3 mph) to 128×
(>300 mph). All schemes fall off with increased speed, and the gap
between OPT and Previous-OPT grows from 20% at human speeds
to 1/3 at the fastest speeds. However, even in these mobile channels,
ESNR holds up very well and tracks Previous-OPT within 10%.
Note that packet SNR was observed to fare quite poorly [28] in
mobile channels, but since effective SNR reﬂects actual link quality
its estimates are more accurate (§5) and stable (2–3× less variance).
SISO Comparison. Next, we compare ESNR with SampleRate
and SoftRate in Figure 11 and Figure 12. While it is hard to sep-
arate the lines on the graph, at 1× speed, ESNR slightly outper-
forms SampleRate which slightly outperforms SoftRate. These re-
sults surprised us: SampleRate performs better than we expected,
and SoftRate performs less well.
SampleRate’s lagging channel estimate makes it degrade fastest
with increasing mobility. However, it maintains a 10–25% mar-
gin with ESNR, still performing well even with large speedups. In
deeper analysis, we discovered that dropping rate on retry is an im-
portant factor that gives it short-term adaptability. Without this rate
fallback (the “SampleRate ﬁxed” line), it loses 25–50% of its per-
formance.
SoftRate has among the slowest falloff with mobility speedup
because it directly and accurately measures the channel, and per-
forms the best at maximum speed. However, at slow speeds it is
slightly slower on average than SampleRate, though it easily beats
a SampleRate without fallback that was the basis for earlier com-
parisons.8 We do not believe this gap is fundamental, as SoftRate’s
post-decoding BER estimate should match or even slightly improve
on ESNR. Further tuning will likely improve SoftRate. Note that
the task for SoftRate is harder in our setting than in the original
8M. Vutukuru, personal communication, and code inspection.
 0 10 20 30 40 50 60 70 0 50 100 150 200 250Avg. delivered rate (Mbps)Packet trace index (x100)OPTPrevious-OPTESNR 0 5 10 15 20 25 30 35 401248163264128Avg. delivered rate (Mbps)Number of interpolated packetsOPTPrevious-OPTESNR168Figure 11: ESNR, SampleRate, and SoftRate SISO perfor-
mance in human-speed mobility.
Figure 13: OPT and ESNR MIMO performance in human-
speed mobility.
Figure 12: OPT, ESNR, SampleRate, and SoftRate SISO per-
formance in fast mobile channels.
evaluation. We have added QAM-64 and other coding rates, so it
must now chose among 8 SISO rates.
Finally, while the performance differences between schemes are
signiﬁcant, they are always less than a factor of two (ignoring OPT).
To put this in perspective, note that other evaluations have reported
throughput based on TCP trafﬁc, which will magnify performance
gaps by reacting to packet loss.
MIMO Performance. To show the generality of our model, Fig-
ures 13 and 14 show the performance of an unmodiﬁed ESNR al-
gorithm running for 802.11n MIMO rates. These results do not in-
clude SampleRate or SoftRate as they are SISO schemes. Instead,
we use OPT as our benchmark. These ﬁgures are in the same form
as for SISO, except the range of rates has grown by a factor of 3 to
support up to 195 Mbps.
The trends in these graphs are similar to those in the SISO graphs:
at human mobility speeds, ESNR tracks Previous-OPT and delivers
excellent performance, with 80% accuracy and 10% over-selection.
In faster mobile channels, there is a slightly larger gap with Previous-
OPT for MIMO than for SISO, likely because ESNR must now
choose between 24 rates instead of 8. It is more likely to choose
rates under the highest rate that would have worked.
Finally, note that with 3 antennas there are only four two- and
three-stream rates over 117 Mbps (130, 156, 175.5 and 195 Mbps).
The visible gap between indices 25–50 in Figure 13 reﬂects only
the difference between 1 or 2 rates of potentially different antenna
modes. Taken together, these results imply that ESNR’s MIMO
performance is highly competitive.
Enhancements. One strength of our model is that it can accommo-
date choices other than rates. This lets us add other functionality to
ESNR without increasing complexity. We demonstrated an exam-
ple enhancement to trim excess transmit power in §5.
A second enhancement is to select the best transmit antenna when
there are spare antennas. An 802.11n AP can select antennas to use
to send packets to a legacy 802.11a/g client (plus use all antennas
Figure 14: OPT and ESNR MIMO performance in faster mo-
bile channels.
to receive packets). With three antennas to choose from, the ex-
pected gain in SNR is a little over 2.5 dB [8]. This is often enough
to advance to a higher rate.
We ran a version of SISO ESNR that chose the antenna with the
highest ESNR for the next transmission. This gave a gain in the av-
erage rate of 5%. For comparison, OPT achieved a 10% increase by
always knowing which antenna was best. No other rate adaptation
schemes directly support these enhancements.
7. RELATED WORK
Understanding real 802.11 wireless channels. A number of stud-
ies investigate the performance characteristics of 802.11.
Initial
studies of 802.11b [3, 22] found RSSI to be a weak predictor of
packet delivery that improved when receivers were calibrated for
thermal conditions and manufacturing variability. Today’s NICs
have intense calibration procedures that mostly eliminate these is-
sues. However, the variation across links with 802.11a/g/n OFDM
comes from frequency-selective fading [13, 27], which does not af-
fect spread-spectrum modulations in 802.11b.
Theoretical analysis. Much theoretical work on OFDM with con-
volutional coding starts with effective BER or SNR [18] and adds
simulated faded channels to build closed-form expressions for er-
ror rates under coding [4, 19, 26]. Effective SNR has also been
extended to MIMO-OFDM [15, 16]. Our model is related, but sim-
pler: we eschew simulating complex, implementation-dependent
coding effects in favor of using ﬁxed, per-rate thresholds. We con-
vert CSI to effective SNR in a way that better matches the equal
modulation and power allocation used by 802.11n and offer a better
API for practical use. Most importantly, we experimentally evalu-
ate our model for 802.11 NICs and real RF channels; we are not
aware of other work on 802.11 that uses effective SNR measures
outside of simulation or analysis.
Rate adaptation. Many rate adaptation algorithms have been pro-
posed that use packet delivery statistics [5, 29], RSSI-based packet
 0 10 20 30 40 50 60 70 0 50 100 150 200 250Avg. delivered rate (Mbps)Packet trace index (x100)ESNRSampleRateSoftRateSampleRate fixed 0 5 10 15 20 25 30 35 401248163264128Avg. delivered rate (Mbps)Number of interpolated packetsOPTESNRSampleRateSoftRateSampleRate fixed 0 50 100 150 200 0 50 100 150 200Avg. delivered rate (Mbps)Packet trace index (x400)OPTPrevious-OPTESNR 0 50 100 150 2001248163264128256Avg. delivered rate (Mbps)Number of interpolated packetsOPTPrevious-OPTESNR169SNR [6, 10], or symbol-level details of packet reception [23, 28] to
adapt to varying channel conditions. Some proposals require cus-
tom hardware [6] and may drastically change the fundamentals of
the communication [20]. These methods do not extend to 802.11n
and do not address related factors, e.g., transmit power.
Compared to SoftRate’s [28] use of BER estimates, our effec-
tive SNR metric is more general. With a single CSI measurement,
we can extrapolate performance in a wide space of rates, spatial
streams, antenna selections, channel widths, and transmit power
levels. We have also shown that effective SNR can be implemented
on commodity NICs and evaluated it over real wireless channels
with mobile and ﬁxed clients. Like RRAA [29] and SoftRate, ef-
fective SNR helps to distinguish collisions from channel induced
packet loss; with accurate predictions of interference-free packet
delivery there is no need to adapt rate in response to loss.
Finally, effective SNR could inform and improve schemes that
combine transmission with more efﬁcient channel-dependent cod-
ing [14] or partially-correct ARQ schemes [9]. Our deeper under-
standing of fading should also aid attempts to use the faster OFDM
rates in challenging outdoor mobile environments [7].
Transmit power control. Existing proposals for transmit power
control require complex probing and adaptation mechanisms [17,
21, 25]. Our example in §5 suggests that, with a good predictive
model, we can directly and conﬁdently select a reduced transmit
power without degrading link performance.
8. CONCLUSION
Wireless links are easy to understand in theory, but difﬁcult to
operate in practice, thus search is used to ﬁnd the best rates, power
levels, or other parameter of interest. We have presented a practi-
cal 802.11 packet delivery model that greatly simpliﬁes this situa-
tion. Our model takes as input the RF channel (measured as 802.11
Channel State Information) and predicts whether the link will de-
liver packets for a wide range of NIC conﬁgurations. It uses the
notion of effective SNR to handle OFDM over faded links, works
for MIMO conﬁgurations, and needs no calibration of target links.
We evaluated our model experimentally with Intel 802.11a/g/n
NICs. We show that, for the ﬁrst time, measurements taken by
commodity NICs can accurately predict whether links will work
over a wide range of rates, transmit power, spatial streams, and an-
tennas settings that have not previously been tested.
In contrast,
predictions based on RSSI often confuse from two to ﬁve rates as
the potential best rate to use.
Our model is simple, involving only computation on channel
measurements. It is easy to deploy, working with measurements
from 802.11n NICs. And it is general, working for 802.11n (MIMO)
systems as well as 802.11a/g (SISO) ones. As one application, we
use it to predict the highest transmit rate for a link. Simulations
driven by real channel measurements show that our scheme is as
good as the best 802.11a/g rate adaptation schemes, and extends
good performance to 802.11n. We hope our model will prove use-
ful for many tasks ranging from antenna and channel selection to
rate and transmit power control.
Acknowledgments
We thank our shepherd, Patrick Thiran, and the rest of the anony-
mous reviewers for their helpful feedback. Tom Anderson, Shyam-
nath Gollakota, and Ratul Mahajan also provided insightful com-
ments on this work. We are grateful to Mythili Vutukuru for ac-
cess to the SoftRate source code. This work was supported in part
by an Intel Foundation Ph.D. Fellowship and by NSF grants CNS-
0435065 and CNS-0722004.
9. REFERENCES
[1] IEEE Std. 802.11n-2009: Enhancements for higher throughput.
[2] Intel Wireless WiFi Link drivers for Linux.
http://intellinuxwireless.org.
[3] D. Aguayo et al. Link-level measurements from an 802.11b mesh
network. In ACM SIGCOMM, 2004.
[4] O. Awoniyi and F. A. Tobagi. Packet error rate in OFDM-based
wireless LANs operating in frequency selective channels. IEEE
INFOCOM, 2006.
[5] J. C. Bicket. Bit-rate selection in wireless networks. Master’s thesis,
MIT, 2005.
[6] J. Camp and E. Knightly. Modulation rate adaptation in urban and
vehicular environments: cross-layer implementation and
experimental evaluation. In ACM MobiCom, 2008.
[7] J. Eriksson, H. Balakrishnan, and S. Madden. Cabernet: Vehicular
content delivery using WiFi. In ACM MobiCom, 2008.
[8] A. Goldsmith. Wireless Communications. Cambridge University
Press, 2005.
[9] K. Jamieson and H. Balakrishnan. PPR: Partial packet recovery for
wireless networks. In ACM SIGCOMM, 2007.
[10] G. Judd, X. Wang, and P. Steenkiste. Efﬁcient channel-aware rate
adaptation in dynamic environments. In ACM MobiSys, 2008.
[11] S. Kant and T. L. Jensen. Fast link adaptation for IEEE 802.11n.
Master’s thesis, Aalborg University, 2007.
[12] W. Kim et al. An experimental evaluation of rate adaptation for
multi-antenna systems. In IEEE INFOCOM, 2009.
[13] M. Lampe et al. Misunderstandings about link adaptation for
frequency selective fading channels. In IEEE PIMRC, 2002.
[14] K. C.-J. Lin, N. Kushman, and D. Katabi. ZipTx: Harnessing partial
packets in 802.11 networks. In ACM MobiCom, 2008.
[15] H. Liu, L. Cai, H. Yang, and D. Li. EESM based link error prediction
for adaptive MIMO-OFDM system. In IEEE VTC, 2007.
[16] G. Martorell, F. Riera-Palou, and G. Femenias. Cross-layer link
adaptation for IEEE 802.11n. In Cross Layer Design (IWCLD), 2009.
[17] J. P. Monks, V. Bharghavan, and W. M. W. Hwu. A power controlled
multiple access protocol for wireless packet networks. In IEEE
INFOCOM, 2001.
[18] S. Nanda and K. M. Rege. Frame error rates for convolutional codes
on fading channels and the concept of effective Eb/N0. In IEEE
VTC, 1998.
[19] Nortel Networks. Effective SIR computation for OFDM system-level
simulations. 3GPP TSG RAN WG1 #35, R1-031370, 2003.
[20] H. Rahul, F. Edalat, D. Katabi, and C. Sodini. Frequency-aware rate
adaptation and MAC protocols. In ACM MobiCom, 2009.
[21] K. Ramachandran, R. Kokku, H. Zhang, and M. Gruteser. Symphony:
synchronous two-phase rate and power control in 802.11 WLANs. In
ACM MobiSys, 2008.
[22] C. Reis, R. Mahajan, M. Rodrig, D. Wetherall, and J. Zahorjan.
Measurement-based models of delivery and interference in static
wireless networks. In ACM SIGCOMM, 2006.
[23] S. Sen, N. Santhapuri, R. R. Choudhury, and S. Nelakuditi.
AccuRate: Constellation based rate estimation in wireless networks.
In USENIX NSDI, 2010.
[24] D. Smithies and F. Fietkau. minstrel: MadWiFi and Linux kernel rate
selection algorithm, 2005.
[25] D. Son, B. Krishnamachari, and J. Heidemann. Experimental study of
the effects of transmission power control and blacklisting in wireless
sensor networks. In IEEE SECON, 2004.
[26] V. Tralli. Efﬁcient simulation of frame and bit error rate in wireless
systems with convolutional codes and correlated fading channels.
IEEE WCNC, 1999.
[27] D. Tse and P. Viswanath. Fundamentals of Wireless Communication.
Cambridge University Press, 2005.
[28] M. Vutukuru, H. Balakrishnan, and K. Jamieson. Cross-layer wireless
bit rate adaptation. In ACM SIGCOMM, 2009.
[29] S. H. Y. Wong, H. Yang, S. Lu, and V. Bharghavan. Robust rate
adaptation for 802.11 wireless networks. In ACM MobiCom, 2006.
[30] J. Zhang et al. A practical SNR-guided rate adaptation. In IEEE
INFOCOM, 2008.
[31] J. Zhao and R. Govindan. Understanding packet delivery performance
in dense wireless sensor networks. In ACM SenSys, 2003.
170