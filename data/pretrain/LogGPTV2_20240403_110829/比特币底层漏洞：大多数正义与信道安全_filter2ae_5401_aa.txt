# 比特币底层漏洞：大多数正义与信道安全

##### 译文声明
本文为翻译文章，仅供参考。具体内容及含义以原文为准。

几乎所有关于加密货币和区块链的讨论都源自中本聪的白皮书《比特币：一种点对点的电子现金系统》（Satoshi Nakamoto, 2008）。2008年11月1日，一个密码学邮件组收到了这份白皮书。2009年1月3日，中本聪在其个人电脑上挖出了50个比特币，并在创世区块中留下了一条不可更改的信息：“The Times 03/Jan/2009 Chancellor on brink of second bailout for banks”（2009年1月3日，财政大臣正处于实施第二轮银行紧急援助的边缘）。这条信息引用了当天泰晤士报的头版标题，记录了当时英国财政大臣达林考虑第二次救助银行的时刻。通过区块链的时间戳服务和存在证明，第一个区块链产生的时间及其相关事件被永久保留了下来。

2009年10月5日，最早的比特币汇率为1美元兑换1309.03比特币。十年后，比特币的价格已经超过8000美元，按2017年的最高价20000美元计算，2100万枚比特币的市值达到4200亿美元。加上各种山寨币和分叉币，加密货币总规模已经突破万亿美元。

比特币的最大冲击在于它证明了哈耶克的设想是可行的——技术可以超越现有政府框架，实现“非国家化的货币”并开始流通。在币值飞涨的时代，很少有人再去翻阅中本聪的白皮书。这篇仅九页的技术方案探讨了一个“币”的实现。然而，我们更应关注一些本质问题：比特币的“去中心化”是否彻底？它是否真正成为一个权力分散且完全自治的系统？白皮书中是否存在某些缺陷，这些缺陷是中本聪默认忽略但实际存在的假性前提？

## 算力垄断 ≠ 51% 攻击

目前对比特币的信仰建立在全网51%算力难以企及的基础上。然而，最近人们越来越担心掌握大规模ASIC矿机的矿场已经垄断了51%的算力。根据《麻省理工科技评论》2018年1月18日发布的研究报告，比特币和以太坊都属于开放的区块链系统，理论上任何人都可以成为矿工。但由于这种架构特性，自然形成了集中的挖矿资源。基于每周一次的统计，排名前四名的比特币挖掘活动占整个系统挖掘活动的53%；而以太坊挖掘活动的集中度更高，前三大的矿机占整体系统每周平均挖掘活动高达61%。那么，算力垄断是否已经动摇了比特币的“去中心化”特性？

答案是否定的。**51%攻击不会来自比特币生态系统内部。**

尽管矿场巨头们集中控制了大量算力，但他们也投入了巨额硬件投资和电费。如果发动51%攻击，整个系统的价值将崩溃，攻击者获得的比特币也将变得毫无意义。因此，51%攻击必然来自体系外。

## 去中心化 = 大多数人的正义

[白皮书摘要]：
`本文提出了一种完全通过点对点技术实现的电子现金系统，使得在线支付能够直接由一方发起并支付给另一方，中间不需要通过任何金融机构。虽然数字签名部分解决了这个问题，但如果仍然需要第三方支持才能防止双重支付，那么这种系统也就失去了存在的价值。`

我们在此提出一种解决方案，使现金系统在点对点环境下运行，并防止双重支付问题。该网络通过随机散列对所有交易加上时间戳，并将其合并到一个不断延伸的工作量证明链条中作为交易记录。除非重新完成全部的工作量证明，否则已形成的交易记录将不可更改。最长的链条不仅作为观察到的事件序列的证明，还被视为包含最大计算工作量的链。只要绝大多数CPU计算能力没有意图合作攻击全网，诚实节点将生成最长的、超过攻击者的链条。这个系统本身所需的基础设施非常少。信息只需尽最大努力在全网传播即可，节点可以随时离开和重新加入网络，并将最长的工作量证明链条作为离线期间发生的交易的证明。

细读比特币白皮书，你会发现中本聪的“去中心化”背后的潜台词是“大多数人的正义”。共识机制是比特币的核心理念。用密码原理和工作量证明（PoW）代替中心化权威信用。每当产生一条新的交易记录时，总是有先后顺序，即使是双花也有先后顺序，同一用户不可能同时创造两笔交易。比特币引入了基于时间戳的随机散列，使其形成前后相关的序列，这就是为什么称为区块链的原因。

要避免双花，只需要证明其中一条链有效，并将其记录到交易链条上，其他交易则无效。要证明一条链的有效性而不允许中心化存在，唯一的方法是让所有人参与这项活动，进行“多数人的正义”。PoW共识算法正是为了解决谁是大多数的问题，“大多数”的决定表达为最长的链。新区块进行节点广播，一旦有节点收到区块广播，会按照“当且仅当包含在该区块中的所有交易都是有效的且之前未存在过的，其他节点才认同该区块的有效性”的规则进行验证。验证通过后，该节点不会再接受其他节点的相同区块，并终止自己正在进行的包含相同交易的区块计算。节点在这个区块基础上启动新的交易区块计算，如此往复，形成链条。

由于网络延迟，如果有几个节点同时收到交易区块并记录同样的链条（分叉），僵局的打破要等到下一个工作量证明发现。经过一段时间运行，总有一条区块链时序最长，成为最终被认可的链条。比特币区块链就是在不断的分叉、抛弃、再分叉、再合并的过程中形成的。

共识机制替代中介信任，那么我们探讨一下极端情况下可能会出现什么问题？

`2018年某一天下午15:30，中国的海底光纤突然出现故障，国际出口被阻断。整个比特币网络仍旧正常运转：国内的矿池、矿场继续挖币；国外的矿场、交易所继续正常挖币和交易。`

只是不知不觉间，**中国的比特币网络和国际比特币网络被撕裂为两个子网。**

**在故障期间，中国境内的算力形成一个链，境外的算力形成另外一条链。按照共识机制，哪条链更长，较短的链就会被淘汰，即被淘汰的支链上产生的所有交易需要重新核算，同时记账奖励将被作废。**

`17点40，故障后2个小时，光纤故障排除，国际出口复通。`

由于中国国内的算力占比高达70%，国外链毫无意外会被淘汰。在故障发生的两个多小时里，境外矿场的算力成果被销毁，海外所有的比特币交易面临重新核算，整个比特币上的商业活动陷入瘫痪。

大规模通信中断会将比特币网络撕裂为算力悬殊的两个分支，最优策略是在故障发生时立即停摆整个比特币网络，直到故障修复。否则，如果保持隔离状态继续运行，在复通合并时会出现更棘手的瘫痪问题。

比特币对此也有一些防御措施。为了防止支链干扰造成的损失，比特币一笔交易至少需要6个区块的确认，一个区块时间是10分钟，6个区块就是一小时。假如故障导致的网络隔断超过一小时，就会给交易带来冲击，隔断时间越长，冲击越大。

**人们对比特币容灾能力的讨论更多地关注于分布式的多节点存储备份，忽略了共识机制本身造成的隔离和吞没效应。**

这样的想法并非不可能。就在2018年3月30日，非洲国家毛里塔尼亚因海底电缆被切断，导致全国范围内彻底断网长达2天。