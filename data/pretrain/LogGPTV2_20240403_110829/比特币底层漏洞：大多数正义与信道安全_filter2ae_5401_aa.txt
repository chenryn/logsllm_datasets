# 比特币底层漏洞：大多数正义与信道安全
##### 译文声明
本文是翻译文章
译文仅供参考，具体内容表达以及含义原文为准。
几乎所有关于加密货币和区块链的讨论都源于中本聪的白皮书：《比特币：一种点对点的电子现金系统》Bitcoin: A Peer-to-Peer
Electronic Cash System （Satoshi Nakamoto）。
2008 年11月1日，一个密码学邮件组收到了 [PI:EMAIL](mailto:PI:EMAIL)
邮箱发出的这份白皮书，2009年1月3日，中本聪的个人电脑里挖出了50个比特币，并在创世区块里留下一句永不可修改的话：
`“The Times 03/Jan/2009 Chancellor on brink of second bailout for
banks（2009年1月3日，财政大臣正处于实施第二轮银行紧急援助的边缘）。”`
当时正是英国的财政大臣达林被迫考虑第二次出手纾解银行危机的时刻，这句话是泰晤士报当天的头版文章标题。区块链的时间戳服务和存在证明，让第一个区块链产生的时间和当时正发生的事件被永久性的保留了下来。
2009年10月5日出现了最早的交易所汇率：1美元＝1309.03比特币。十年后比特币的价格已经超过8000美元，按照2017年峰值的最高价20000美元一枚计算，2100万枚比特币的市值达4200亿美元，外加各种山寨币、分叉币，加密货币总规模已经突破万亿美元。
比特币带给我们最大的冲击是原来 **哈耶克的创想可行，技术可以超越现有政府的框架实现“非国家化的货币”并开始流通。**
在币值飞涨的疯狂年代，已经很少人再去翻看中本聪的白皮书。仅有九页的白皮书只是一套技术方案，所有的篇幅都是为了探讨一个“币”的实现，超越软件技术本身，我们去细加审视更本质的问题：比特币的“去中心化”是否彻底？是否真正成为了一个权力分散且完全自治的系统？白皮书中是否还有哪些缺陷，是中本聪默认忽略又事实存在的假性前提？
## 算力垄断≠51%攻击
目前对比特币的信仰建立在全网51%算力难以企及上，然而最近人们越来越多开始担忧，掌握大规模ASIC矿机的矿场早已垄断了51%算力。
《麻省理工科技评论》在2018年1月18日发布的最新研究表明，比特币和以太坊都属于开放区块链系统，即原则上任何人都可以成为矿工，但因为这样的架构特性，自然形成了相应的组织集中挖矿资源。
基于每周一次的统计，排名前四名的比特币挖掘活动就占整个系统挖掘活动的 53%；而以太坊挖掘活动的中心化程度甚至更加稳固，前 3
大矿机占整体系统每周平均挖掘活动高达 61%。算力垄断是否已经动摇了比特币“去中心化”的特性？
答案是否定的。 **51%攻击不会来自比特币生态内。**
这是因为矿场巨头们虽然集中控制了算力，但他们按照游戏规则，付出了大量硬件投资和电费消耗。如果发动51%攻击，整个系统的价值就会崩溃，那么攻击获得的比特币将没有任何意义。
51%攻击必然来自于体系外。
## 去中心化=大多数人正义
[白皮书摘要]：
`本文提出了一种完全通过点对点技术实现的电子现金系统，它使得在线支付能够直接由一方发起并支付给另外一方，中间不需要通过任何的金融机构。虽然数字签名（Digital
signatures）部分解决了这个问题，但是如果仍然需要第三方的支持才能防止双重支付（double-spending）的话，那么这种系统也就失去了存在的价值。`
我们在此提出一种解决方案，使现金系统在点对点的环境下运行，并防止双重支付问题。该网络通过随机散列（hashing）对全部交易加上时间戳（timestamps），将它们合并入一个不断延伸的基于随机散列的工作量证明（proof-of-work）的链条作为交易记录，除非重新完成全部的工作量证明，否者已经形成的交易记录将不可更改。
最长的链条不仅将作为被观察到的事件序列（sequence）的证明，而且被看做是包含CPU最大计算工作量的链。只要绝大多数的CPU计算能力都没有打算合作起来对全网进行攻击，那么诚实的节点将会生成最长的、超过攻击者的链条。这个系统本身需要的基础设施非常少。
信息尽最大努力在全网传播即可，节点(nodes)可以随时离开和重新加入网络，并将最长的工作量证明链条作为在该节点离线期间发生的交易的证明。
细读比特币白皮书，你会发现中本聪的 **“去中心化”背后的潜台词是“大多数人正义”** ，共识机制是比特币的核心理念。
用密码原理和工作量证明(Pow)代替中心化权威信用。而产生一条新的交易记录时永远有先后顺序，即便是双花也总有先后顺序，同一用户不可能同时创造两笔交易。比特币首先引入了基于时间戳的随机散列，让其形成前后相关的序列，比特币的交易记录就是一个时间序列的链条。这就是为什么称之为区块链的原因。
要避免双花，我们只需要证明其中一条链有效即可，并且将其记录到交易链条上，其他的交易就是无效的了。要证明其中一条是有效又不允许中心化从存在，只有一个办法：发动所有人参与这项活动，进行“多数人的正义”。
PoW共识算法正是为了解决谁是大多数的问题，“大多数”的决定表达为最长的链。新区块进行节点广播，一旦有节点收到了这个区块的广播，会按照“当且仅当包含在该区块中的所有交易都是有效的且之前未存在过的，其他节点才认同该区块的有效性”的规则进行验证。
验证通过后，这个节点就不会再接受别的节点的同样区块了。同时这个节点会终止自己正在进行的包含同样交易的区块计算，也就说不会在进行无用功了，节点在这个区块基础上启动新的交易区块计算，如此往复，形成链条。
由于网络延迟，如果同时有几个节点互相收到交易区块，记录同样的链条（分叉），该僵局的打破要等到下一个工作量证明发现。通过一段时间运行，总有一条区块链时序最长，作为最终被认可的链条。比特币区块链就是在不停的分叉、抛弃、又分叉、又合并的过程。
共识机制替代中介信任，那么我们探讨一下极端情况下可能会出现什么问题？
`2018年某一天下午15：30，中国的海底光纤突然出现故障，国际出口被阻断。整个比特币网络仍旧正常运转：国内的矿池、矿场币照样挖；国外的矿场、交易所继续正常挖币和交易。`
只是不知不觉间， **中国的比特币网络和国际比特币网络被撕裂为两个子网。**
**在故障期间，中国境内的算力形成一个链，境外的算力形成另外一条链。按照共识机制，就看哪条链的长度更长，而长度较短的另一链会被淘汰，即这条被淘汰的支链上产生的所有交易需要重新核算，同时记账奖励将被作废。**
`17点40，故障后2个小时，光纤故障排除，国际出口复通。`
由于中国国内的算力占比高达70%，国外链毫无意外会被淘汰，在故障发生的两个多小时，境外矿场的算力成果被销毁了，海外所有的比特币交易面临重新核算，整个比特币上的商业活动被瘫痪。
大规模通讯中断会将比特币网络撕裂为算力悬殊的两个分支，那么最优的策略是故障发生那刻起，整个比特币网络立即停摆，直到故障修复。否则如果保持隔离状态继续运行，复通合并时就会出现更棘手的瘫痪。
比特币对此也有一些防御措施，为防止支链的干扰造成损失，比特币一笔交易至少需要6个区块的确认，一个区块时间是10分钟，6个区块就是一小时。假如故障导致的网络隔断超过一小时，就会给交易带来冲击，隔断时间越长冲击越大。
**人们对比特币容灾能力的讨论，更多地关注于分布式的多节点存储备份，忽略了共识机制本身造成的隔离和吞没效应。**
这样的想法并非是不可能的，就在 `2018年3 月30日，非洲国家毛里塔尼亚由于海底电缆被切断，造成全国范围内彻底断网时间长达 2