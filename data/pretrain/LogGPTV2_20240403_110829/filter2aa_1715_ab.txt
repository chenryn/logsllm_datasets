[17.294]  9D:65:CB:58:4D  0040006E52                                      // keepalive, 110ms interval
[17.294]  9D:65:CB:58:4D  00104D0014000000008F                            // ACK payload; requesting HID++ version
[17.302]  9D:65:CB:58:4D  00514D00140405000000000000000000000000000045    // response (HID++ 4.5)
[17.302]  9D:65:CB:58:4D                                                  // ACK
[17.387]  9D:65:CB:58:4D  0040006E52                                      // keepalive, 110ms interval
[17.387]  9D:65:CB:58:4D                                                  // ACK 
Logitech Unifying Dynamic Keepalives
●
Keepalives are used to detect poor channel conditions
●
Missed a keepalive? Change channels
●
Mouse/keyboard dynamically sets keepalive interval
●
Short interval when active, long interval when idle 
Logitech Unifying Keepalives - Example
[20.173]  4C:29:9D:C6:09  00:C2:00:00:01:00:00:00:00:3D // mouse movement (implicitly sets keepalive interval to 8ms)
[20.181]  4C:29:9D:C6:09  00:4F:00:00:6E:00:00:00:00:43 // no movement after 8ms, set keepalive interval to 110ms
[20.189]  4C:29:9D:C6:09  00:C2:00:00:01:00:00:00:00:3D
[20.196]  4C:29:9D:C6:09  00:C2:00:00:01:00:00:00:00:3D
...
[20.282]  4C:29:9D:C6:09  00:C2:00:00:00:E0:FF:00:00:5F
[20.289]  4C:29:9D:C6:09  00:C2:00:00:00:F0:FF:00:00:4F
[20.297]  4C:29:9D:C6:09  00:4F:00:00:6E:00:00:00:00:43 // no movement after 8ms, set keepalive interval to 110ms
[20.305]  4C:29:9D:C6:09  00:40:00:6E:52                // keepalive at 110ms interval
[20.390]  4C:29:9D:C6:09  00:40:00:6E:52               
[20.483]  4C:29:9D:C6:09  00:40:00:6E:52               
...
[25.377]  4C:29:9D:C6:09  00:40:00:6E:52               
[25.470]  4C:29:9D:C6:09  00:40:00:6E:52               
[25.563]  4C:29:9D:C6:09  00:4F:00:04:B0:00:00:00:00:FD // after 5 seconds idle, increase keepalive interval to 1200ms
[25.571]  4C:29:9D:C6:09  00:40:04:B0:0C                // keepalive at 1200ms interval
[26.533]  4C:29:9D:C6:09  00:40:04:B0:0C
[27.486]  4C:29:9D:C6:09  00:40:04:B0:0C
[28.439]  4C:29:9D:C6:09  00:40:04:B0:0C
[29.392]  4C:29:9D:C6:09  00:40:04:B0:0C
[30.345]  4C:29:9D:C6:09  00:40:04:B0:0C
Logitech Unifying Pairing
1.
Unifying software tells the dongle to 
enter pairing mode 
2.
Dongle listens to pairing requests on 
address BB:0A:DC:A5:75
3.
Dongle times out if pairing doesn’t 
happen in 30-60 seconds
4.
Device type and properties are sent 
during pairing 
Logitech Unifying Device Power-on Behavior
Vulnerabilities
Encrypted 
Protocols
Unencrypted
Injection
Unencrypted Injection Targeting Keyboard
(Logitech Unifying, Dell KM714)
Forced Pairing
(Logitech Unifying, Dell KM714)
Disguise Mouse as Keyboard
(Logitech Unifying, Dell KM714)
Logitech Response, Round 1
●
Vendor notified on 11-24-2015
●
Public disclosure on 02-23-2016
●
Firmware update released on 02-23-2016
○
Fixed forced pairing
○
Partially fixed unencrypted keystroke injection
○
Also applies to Dell KM714 
Logitech Response, Round 2a
●
Vendor notified on 04-27-2016
●
Public disclosure on 07-26-2016
●
Firmware update released on 07-26-2016
○
Fixed unencrypted keystroke injection
○
Also applies to Dell KM714 
Logitech G900 Chaos Spectrum
●
“Professional Grade Wireless” gaming mouse ($150!!!)
○
Tuned (and power hungry) version of Unifying 
○
Shorter ACK timeouts 
○
8 channels vs. 24 with Unifying
○
No pairing support 
○
USB connection to charge or use as a wired mouse 
○
TI-CC2544/TI-CC2543 offers more TX power than nRF24L 
○
Vulnerable to unencrypted keystroke injection!
Logitech G900 
Macros
●
Keystroke macros are 
programmed into the mouse
●
Macros can be programmed 
wirelessly, by an attacker 
●
Timing delays can be 
inserted between 
keystrokes
Logitech Response, Round 2b
●
Vendor notified on 04-27-2016
●
Public disclosure on 07-26-2016
●
Firmware update released on 07-26-2016
○
Fixed unencrypted keystroke injection (G900 gaming mouse)
Unencrypted Injection Targeting Mouse
(AmazonBasics, Dell KM632, Lenovo 500, Microsoft)
Microsoft Sculpt Ergonomic Mouse
Amazon response, round 1
●
Unencrypted keystroke injection into mouse dongle
●
Vendor notified on 11-24-2015
●
Public disclosure on 02-23-2016
●
No vendor response
Dell response, round 1
●
Unencrypted keystroke injection into mouse dongle
●
Vendor notified on 11-24-2015
●
Public disclosure on 02-23-2016
●
Dell fixed the firmware and sent an updated version to test, 
but firmware updates are not possible on existing devices
Lenovo response, round 1
●
Unencrypted keystroke injection into mouse dongle
●
Vendor notified on 11-24-2015
●
Public disclosure on 02-23-2016
●
Lenovo fixed the firmware and sent an updated version to test, 
but firmware updates are not possible on existing devices
Microsoft response
●
Unencrypted keystroke injection into mouse dongle
●
Vendor notified on 11-24-2015
●
Public disclosure on 02-23-2016
●
Microsoft released Windows update on 04-22-2016
○
Works on client versions of Windows (no server support)
○
Addresses mice, but not mouse/beyboard sets 
○
No fix for Linux or OSX
○
No firmware update support
DDoS: Dongle Denial of Service
(Lenovo Ultraslim, Ultraslim Plus, N700)
Encrypted 
Protocols
Encrypted
Injection
Counter Mode AES
Repeated Counters? Give ‘em here!
Encrypted Keystroke Packets
USB HID Key Up Ciphertext
Encrypted Keystroke Injection Devices
●
Logitech Unifying keyboards (including Dell KM714)
●
Dell KM632
●
Lenovo Ultraslim 
●
AmazonBasics Wireless Keyboard
●
HP Wireless Elite V2 Keyboard
Encrypted Keystroke Injection Responses
●
Vendor notified on 04-27-2016
●
Public disclosure on 07-26-2016
●
Logitech is working on a fix
●
Lenovo is working on a fix
●
Dell updated the firmware and set us a fixed unit to verify, 
but firmware updates are not possible in the field
●
No response from Amazon
●
No acknowledgement of the vulnerability from HP
Unencrypted 
Protocols
Unencrypted Transceivers (KeySniffer)
●
MOSART Semiconductor (undocumented)
○
1Mbps or 375kbps GFSK
○
Single channel
○
No encryption
●
Signia SGN6210 (sparsely documented)
○
1Mbps GFSK
○
Frequency hopping
○
No encryption
●
GE/Jasco mystery transceiver (no idea what this thing is)
○
500kbps GFSK
○
Frequency hopping
○
No encryption
Unencrypted Devices - MOSART
●
Anker Ultra Slim 2.4GHz Wireless Compact Keyboard 
●
EagleTec K104 / KS04 2.4 GHz Wireless Combo keyboard 
●
HP Wireless Classic Desktop wireless keyboard
●
Insignia Wireless Keyboard NS-PNC5011
●
Kensington Pro Fit Wireless Keyboard
●
RadioShack Slim 2.4GHz Wireless Keyboard
●
ShhhMouse Wireless Silent Mouse (injection only)
●
HDE Slim Wireless Optical Mouse (injection only)
Unencrypted Devices - non-MOSART
●
GE/Jasco 98614 Wireless Keyboard and Mouse
●
Gigabyte K7600 Wireless Keyboard and Mouse
●
Toshiba PA3871U-1ETB Wireless Keyboard
Dongle Sync Packets
Building Device Discovery
Sniffing Multiple Keyboards
KeySniffer Vendor Responses
●
Anker will exchange vulnerable keyboards for Bluetooth models 
through 08-30-2016
●
Kensington claims to have a new AES encrypted version of the 
Pro Fit wireless keyboard
○
I have not seen or tested this device 
○
FCC docs don’t show any new keyboards
●
Insignia told reporters that its keyboards are encrypted, 
however the vulnerable model is unencrypted
●
GE/Jasco is no longer making wireless keyboards/mice
White-label Hardware, 
White-Label Vulnerabilities
Vendor vs OEM: Hewlett-Packard / ACROX
HP Wireless Classic Desktop 
●
Added HP logo
●
Modified side button style
ACROX KBJ+G1G
●
OEM keyboard
Vendor vs OEM: AmazonBasics / Chicony
AmazonBasics Wireless Keyboard/Mouse
●
Added AmazonBasics logos
●
Dell KM632 (made by Chicony) has 
the same vulns as AmazonBasics
Chicony WUG1213
●
OEM keyboard/mouse set
Vendor vs OEM: RadioShack / Siliten
RadioShack Wireless Keyboard
●
Added RadioShack logo
●
Small styling changes
Siliten DK/M-9091RL
●
OEM keyboard
Attack Hardware
CrazyRadio PA and Open Sourced Firmware
●
nRF24LU1+ w/ LNA/PA
●
225 meter injection w/ yagi
●
Open source hardware
●
Part of Crazyflie project
●
Bastille Research firmware:
●
https://github.com/BastilleResearch/mousejack/
Research Firmware on Logitech Dongles
●
Unifying dongles support firmware updates
○
Logitech bootloader doesn’t do signature validation 
○
Any firmware image that passes CRC is accepted 
●
Flash the Bastille Research firmware onto a Logitech dongle:
○
sudo make logitech_install
●
Cheap and available 
○
~$10 vs ~$30 for the CrazyRadio PA
○
CrazyRadio PA harder to find after MouseJack release 
○
Unifying dongles are widely available 
Android App 
●
Device discovery and classification 
○
Logitech devices
○
Microsoft devices
●
Dongle firmware flashing support
○
CrazyRadio dongles
○
Logitech dongles
Demo Time!
Questions?
Marc Newlin
PI:EMAIL
@marcnewlin