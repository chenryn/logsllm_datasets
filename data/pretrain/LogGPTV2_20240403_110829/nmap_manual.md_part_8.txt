### 生成MAC地址字符串
Nmap通过`nmap-mac-prefixes`查找厂商名称（区分大小写）。如果找到匹配项，Nmap将使用该厂商的OUI（3字节前缀），并随机填充剩余的3个字节。有效的 `--spoof-mac` 参数包括：Apple、0、01:02:03:04:05:06、deadbeefcafe、0020F2 和 Cisco。

## 输出
任何安全工具的价值在于其输出结果的质量。如果没有以组织良好且易于理解的方式呈现，复杂的测试和算法几乎毫无意义。Nmap提供了多种输出格式，以满足不同用户的需求。这些格式包括方便直接查看的交互式输出和便于软件处理的XML格式。

除了提供多种输出格式外，Nmap还提供了控制输出细节和调试信息的选项。输出内容可以发送到标准输出或指定文件，并可以选择追加或覆盖现有内容。此外，输出文件还可以用于继续中断的扫描。

### Nmap提供的五种输出格式
1. **Interactive Output (默认)**
   - 发送到标准输出（stdout）。
   
2. **Normal Output**
   - 类似于交互式输出，但显示较少的运行时间和警告信息，适用于扫描结束后进行分析。

3. **XML Output**
   - 最重要的输出类型，可转换为HTML，便于程序处理，如用于Nmap图形用户界面或导入数据库。
   - 使用 `-oX` 选项将XML输出写入指定文件。
   - Nmap包含一个文档类型定义（DTD），帮助XML解析器有效处理输出。最新的DTD版本可在 [http://www.insecure.org/nmap/data/nmap.dtd](http://www.insecure.org/nmap/data/nmap.dtd) 获取。
   - XML输出引用了一个XSL样式表，用于格式化输出结果，类似于HTML。最便捷的方法是将XML输出加载到Web浏览器中，如Firefox或IE。由于 `nmap.xsl` 文件的绝对路径，通常只能在运行Nmap的机器上工作（或类似配置的机器）。使用 `--stylesheet` 选项可以创建可移植的XML文件。

4. **ScRipT KIdd\|3 oUTpuT**
   - 一种类似于交互式输出的事后处理格式，适合于“l33t HaXXorZ”，因为Nmap输出全都是大写。这个选项是对脚本小子的一种调侃，表面上是为了“帮助他们”。

5. **Grepable Output**
   - 简单格式，每行一个主机，可通过UNIX工具（如grep、awk、cut、sed、diff）和Perl方便地查找和分解。常用于命令行上的一次性测试。
   - 每行由六个标记域组成，由制表符及冒号分隔。这些域包括主机、端口、协议、忽略状态、操作系统、序列号、IPID和状态。
   - 最重要的域是“Ports”，它提供了所关注端口的详细信息，每个端口项由逗号分隔，子域由斜杠分隔。这些子域包括端口号、状态、协议、拥有者、服务、SunRPCinfo和版本信息。
   - 更详细的Grepable输出格式信息可查阅 [http://www.unspecific.com/nmap-oG-output](http://www.unspecific.com/nmap-oG-output)。

6. **Output to All Formats**
   - 使用 `-oA` 选项可以一次性将扫描结果输出为标准格式、XML格式和Grepable格式，分别存放在 `.nmap`、`.xml` 和 `.gnmap` 文件中。也可以在文件名前指定目录名，如在UNIX中使用 `~/nmaplogs/foocorp/`，在Windows中使用 `c:\hacking\sco`。

### 细节和调试选项
- **-v (提高输出信息的详细度)**
  - 通过提高详细度，Nmap可以输出更多关于扫描过程的信息。例如，发现打开的端口以及估计的结束时间。使用两次 `-v` 选项会提供更多详细信息，超过两次则不起作用。大部分变化仅影响交互式输出，但对标准和脚本小子输出也有一定影响。

- **-d [level] (提高或设置调试级别)**
  - 当详细模式不足以提供所需数据时，使用调试选项可以获得更多信息。多次使用 `-d` 可提高调试级别，也可以在 `-d` 后面指定具体的调试级别。例如，`-d9` 设置调试级别为9，这是最高级别，会产生大量输出。
  - 调试输出对于解决Nmap因Bug挂起的问题或了解Nmap的工作原理非常有用。主要是开发人员使用此选项，调试行不具备自我解释的特点。

- **--packet-trace (跟踪发送和接收的报文)**
  - 要求Nmap打印发送和接收的每个报文的摘要，有助于新用户更好地理解Nmap的工作方式。可以通过限制扫描的端口数来减少输出行数，如 `-p20-30`。如果只需进行版本检测，使用 `--version-trace`。

- **--iflist (列举接口和路由)**
  - 输出Nmap检测到的接口列表和系统路由，用于调试路由问题或设备描述失误。

### 其他输出选项
- **--append-output (在输出文件中添加)**
  - 当使用文件作为输出格式时（如 `-oX` 或 `-oN`），默认情况下文件会被覆盖。如果希望保留现有内容并将结果添加到文件末尾，使用 `--append-output` 选项。所有指定的输出文件都将被添加。但对于XML输出（-oX），建议避免追加操作，以防止文件损坏。