 20
 40
 60
 80
Time (s)
 100  120  140
Figure 12: Bohatei enables rapid response and re-
stores throughput of legitimate trafﬁc.
The key takeaway is that Bohatei can help networks
respond rapidly (within one minute) to diverse attacks
and restore the performance of legitimate ﬂows. We re-
peated the experiments with UDP as the benign trafﬁc.
In this case, the recovery time was even shorter, as the
throughput does not suffer from the congestion control
mechanism of TCP.
Hardware cost: We measure the total number of VMs
needed to handle a given attack volume and compare two
cases: (1) monolithic VMs embedding the entire defense
logic for an attack, and (2) using Bohatei’s ﬁne-grained
modular scaling. Table 3 shows the number of VMs
required to handle different types of 100 Gbps attacks.
Fine-grained scaling gives a 2.1–5.4× reduction in hard-
ware cost vs. monolithic VMs. Assuming a commodity
server costs $3,000 and can run 40VMs in Bohatei (as
we did), we see that it takes a total hardware cost of less
than about $32,000 to handle a 100 Gbps attack across
Table 3. This is in contrast to the total server cost of
about $160,000 for the same scenario if we use mono-
lithic VMs. Moreover, since Bohatei is horizontally scal-
able by construction, dealing with larger attacks simply
entails a linearly scale up of the number of VMs.
Routing efﬁciency: To quantify how Bohatei addresses
the routing inefﬁciency of existing solutions (§2.2), we
ran the following experiment. For each topology, we
measured the end-to-end latency in two equivalently pro-
visioned scenarios:
(1) the location of the DDoS de-
fense appliance is the node with the highest between-
ness value8, and (2) Bohatei. As a baseline, we consider
8Betweenness is a measure of a node’s centrality, which is the frac-
tion of the network’s all-pairs shortest paths that pass through that node.
200
100
400
Attack traffic volume (Gbps)
300
500
Figure 11: Number of switch forwarding rules in Bo-
hatei vs. today’s ﬂow-based forwarding.
GB RAM. To put the number of ﬂows in context, 200K
ﬂows roughly corresponds to a 1 Gbps attack. Note that a
typical upper bound for switch ﬂow set-up time is on the
order of a few milliseconds [59]. We see that Bohatei in-
curs zero rule setup latency, while the reactive approach
deteriorates rapidly as the attack volume increases.
Number of forwarding rules: Figure 11 shows the
maximum number of rules required on a switch across
different topologies for the SYN ﬂood attack. Using to-
day’s ﬂow-based forwarding, each new ﬂow will require
a rule. Using tag-based forwarding, the number of rules
depends on the number of VM instances, which reduces
the switch rule space by four orders of magnitude. For
other attack types, we observed consistent results (not
shown). To put this in context, the typical capacity of an
SDN switch is 3K-4K rules (shared across various net-
work management tasks). This means that per-ﬂow rules
will not sufﬁce for attacks beyond 10Gbps. In contrast,
Bohatei can handle hundreds of Gbps of attack trafﬁc;
e.g., a 1 Tbps attack will require < 1K rules on a switch.
Beneﬁt of scale-out load balancing: We measured the
resources that would be consumed by a dedicated load
balancing solution. Across different types of attacks with
a ﬁxed rate of 10Gbps, we observed that a dedicated load
balancer design requires between 220–300 VMs for load
balancing alone. By delegating the load balancing task
to the VMs, our design obviates the need for these extra
load balancers (not shown).
8.2 Bohatei end-to-end effectiveness
We evaluated the effectiveness of Bohatei under four dif-
ferent types of DDoS attacks. We launch the attack traf-
ﬁc of the corresponding type at 10th second; the attack
is sustained for the duration of the experiment. In each
scenario, we choose the attack volume such that it is ca-
pable of bringing the throughput of the benign trafﬁc to
zero. Figure 12 shows the impact of attack trafﬁc on the
throughput of benign trafﬁc. The Y axis for each sce-
nario shows the network-wide throughput for TCP traf-
ﬁc (a total of 10Gbps if there is no attack). The results
shown in this ﬁgure are based on Cogent, the largest
topology with 196 switches; the results for other topolo-
gies were consistent and are not shown. While we do see
828  24th USENIX Security Symposium 
USENIX Association
)
%
e
s
a
e
r
c
n
i
h
t
g
n
e
l
h
t
a
P
(
h
t
a
p
t
s
e
t
r
o
h
s
.
t
.
r
.
w
 100
 80
 60
 40
 20
 0
Fixed defense facility
Bohatei
)
6
e t (
n
a
H e
)
5
2
E G l o
U n i C (
Topology (#nodes)
O T
9
(
e
b
2
)
C o
e
g
)
6
9
1
n t (
Figure 13: Routing efﬁciency in Bohatei.
r
e
b
m
u
n
.
t
.
r
.
w
t
e
r
g
e
R
)
%
(
s
M
V
f
o
 100
 80
 60
 40
 20
 0
Uniform
PrevEpoch
Bohatei
r
g
d I n
n
s
n
s
e
R a
A tt a
d
k
c
R a
d H y
n
b
ri d
S t e
y
d
a
R a
F li p
(a) Regret w.r.t. defense resource consumption.
h
c
o
p
E
v
e
P r
l
e
m
u
o
v
.
t
.
r
.
w
t
e
r
g
e
R
)
%
(
s
k
c
a
t
t
a
l
u
f
s
s
e
c
c
u
s
f
o
 60
 50
 40
 30
 20
 10
 0
Uniform
PrevEpoch
Bohatei
r
g
d I n
n
s
e
s
R a
A tt a
d
n
c
k
R a
d H y
n