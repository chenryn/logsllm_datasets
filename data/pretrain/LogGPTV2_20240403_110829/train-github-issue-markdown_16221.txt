The current implementation is frankly embarrassing.