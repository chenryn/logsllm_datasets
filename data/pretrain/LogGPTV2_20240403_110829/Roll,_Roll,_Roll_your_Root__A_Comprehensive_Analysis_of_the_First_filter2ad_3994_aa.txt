title:Roll, Roll, Roll your Root: A Comprehensive Analysis of the First
Ever DNSSEC Root KSK Rollover
author:Moritz M&quot;uller and
Matthew Thomas and
Duane Wessels and
Wes Hardaker and
Taejoong Chung and
Willem Toorop and
Roland van Rijswijk-Deij
Roll, Roll, Roll your Root: A Comprehensive Analysis of the First
Ever DNSSEC Root KSK Rollover
Moritz Müller
University of Twente and SIDN Labs
Wes Hardaker
USC/Information Sciences Institute
Matthew Thomas
Verisign
Taejoong Chung
Rochester Institute of Technology
Roland van Rijswijk-Deij
University of Twente and NLnet Labs
Duane Wessels
Verisign
Willem Toorop
NLnet Labs
ABSTRACT
The DNS Security Extensions (DNSSEC) add authenticity and in-
tegrity to the naming system of the Internet. Resolvers that validate
information in the DNS need to know the cryptographic public key
used to sign the root zone of the DNS. Eight years after its intro-
duction and one year after the originally scheduled date, this key
was replaced by ICANN for the first time in October 2018. ICANN
considered this event, called a rollover, “an overwhelming success”
and during the rollover they detected “no significant outages”.
In this paper, we independently follow the process of the rollover
starting from the events that led to its postponement in 2017 until
the removal of the old key in 2019. We collected data from multiple
vantage points in the DNS ecosystem for the entire duration of the
rollover process. Using this data, we study key events of the rollover.
These events include telemetry signals that led to the rollover being
postponed, a near real-time view of the actual rollover in resolvers
and a significant increase in queries to the root of the DNS once
the old key was revoked. Our analysis contributes significantly to
identifying the causes of challenges observed during the rollover.
We show that while from an end-user perspective, the roll indeed
passed without major problems, there are many opportunities for
improvement and important lessons to be learned from events
that occurred over the entire duration of the rollover. Based on
these lessons, we propose improvements to the process for future
rollovers.
ACM Reference Format:
Moritz Müller, Matthew Thomas, Duane Wessels, Wes Hardaker, Taejoong
Chung, Willem Toorop, and Roland van Rijswijk-Deij. 2019. Roll, Roll, Roll
your Root: A Comprehensive Analysis of the First Ever DNSSEC Root
KSK Rollover. In Internet Measurement Conference (IMC ’19), October 21–
23, 2019, Amsterdam, Netherlands. ACM, New York, NY, USA, 14 pages.
https://doi.org/10.1145/3355369.3355570
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
© 2019 Copyright held by the owner/author(s). Publication rights licensed to ACM.
ACM ISBN 978-1-4503-6948-0/19/10...$15.00
https://doi.org/10.1145/3355369.3355570
1 INTRODUCTION
The Domain Name System (DNS) is the naming system of the In-
ternet. Since 2010, the root of the DNS is secured with the DNS
Security Extensions (DNSSEC), adding a layer of authenticity and
integrity. DNSSEC uses public-key cryptography to sign the con-
tent in the DNS and enables recursive resolvers1 to validate that
the information they receive is authentic. The sequence of crypto-
graphic keys signing other cryptographic keys is called a chain of
trust. The public key at the beginning of this chain of trust is called
a trust anchor. Validators have a list of trust anchors, which they
trust implicitly. The Root Key Signing Key (KSK) acts as the trust
anchor for DNSSEC and this cryptographic key was added to the
root zone in July 2010. Eight years later, and after a one year delay,
the KSK was replaced for the very first time, following established
policy that requires regular rollovers of the Root KSK [1]. This
event, usually referred to as the Root KSK Rollover (hereafter “the
rollover”), required years of preparation and was considered risky.
Stakeholders expected, in the worst case, millions of Internet users
(up to 13%) to become unable to resolve a domain name [2].
The Internet Corporation for Assigned Names and Numbers
(ICANN), the organization responsible for coordinating and rolling
the key, collected feedback from the community before the rollover.
Two risks were most feared: (i) resolvers that would not update their
local copy of the key [2] and (ii) resolvers that could not retrieve
the key material from the root because it might exceed a packet
size that cannot be safely handled by some networks (we explain
these two risks in more detail in Section 2.2.1).
Leading up to the initially scheduled date of the rollover in Octo-
ber 2017, ICANN and its stakeholders carried out measurements to
estimate the potential impact of both risks and considered the for-
mer acceptable. The actual impact of the former, however, was still
hard to estimate. One of the reasons was the introduction of a new
protocol that enabled resolvers to signal their configured key to
the root server operators (RFC 8145 [3], we explain the protocol in
more detail in Section 3.1). This protocol signaled that a significant
number of resolvers only had the old key configured and this led to
the decision to postpone the rollover [4]. Rescheduling the rollover
gave researchers the opportunity to understand which resolvers
sent this signal and estimations were that only a few users would
be negatively affected by the rollover [5]. This gave ICANN the
1Today most, but not all, DNSSEC validation happens in recursive resolvers. For
convenience we use the term “resolvers” in this paper, but the discussion applies
equally well to validation that occurs elsewhere (e.g. in applications).
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Müller et al.
confidence to move forward with the rollover. The actual rollover
was carried out on October 11th, 2018. In their March 2019 review
of the rollover, ICANN concluded that “there were no significant
outages” and that the rollover “was an overwhelming success” [6].
In this paper we provide a comprehensive analysis of the rollover,
starting from the publication of the new key in July 2017 until the
removal of the old key in March 2019. We use data that was actively
and passively collected at key points in the DNS ecosystem over
the entire duration of the rollover. We, as members of the DNS
community, actively supported the rollover process with timely data
analyses. This provides us with a unique perspective that covers
multiple vantage points of the rollover. The main contributions of
this paper are that we:
(i) Provide the first in-depth analysis of the root KSK rollover,
a unique event with an impact on the global Internet;
(ii) Cover the event from multiple perspectives, that of root
operators, of resolver operators, and end users;
(iii) Validate ICANN’s conclusion that the event was a success
and show that, while this conclusion generally holds for end
users, there are observable challenges at all stages of the
rollover;
(iv) Perform an in-depth analysis of the causes of the challenges
seen at all stages of the rollover;
(v) Give recommendations for improving telemetry, processes
for root key management and future rollovers.
In the remainder of the paper, we outline the basics of DNS
and DNSSEC, as well as the stages of the root rollover and the
risks involved (Section 2). Next, we introduce our measurement
methods and data (Section 3). Then, we split the analysis of the
rollover into three sections, before, during and after the rollover
(Section 4). In Section 5 we discuss related work and in Section 6
we provide recommendations for better telemetry and rollover
process improvements based on our analysis. We conclude the
paper in Section 7.
2 BACKGROUND
This section explains the basics of DNS and DNSSEC, followed by
a discussion of the Root KSK Rollover and its risks.
2.1 DNS and DNSSEC
The DNS uses resource records (RRs) to map domain names, such as
example.com, to values. For example, an A record maps a domain
name to an IPv4 address and an NS record maps a domain name
to the authoritative name server for a domain. These records are
stored in a zone and made available at the domain’s authoritative
name servers. End users usually employ recursive caching resolvers
to query for records in the DNS. The DNS is a hierarchical naming
system and at the top of the hierarchy sits the root. Assuming an
empty cache, a recursive resolver that queries for the A record of
example.com sends its first query to the authoritative name servers
of the root, which refer the resolver further to the authoritative
name servers of .com that finally refer it to the name servers of
example.com. Each RR also has a Time-To-Live (TTL) field that
defines how long a resolver may cache the RR. Until the TTL of the
RR has expired, the resolver generally will not send another query
for example.com but respond with the record from its cache.
Figure 1: DNSSEC chain of trust, starting at the root.
DNSSEC allows a recursive resolver to validate that the response
it receives from an authoritative name server has not been tampered
with. Operators sign their records using public-key cryptography
and publish the public key — in a DNSKEY RR — together with the
signatures — in an RRSIG RR — in the zone file. Often, operators
create two keys, a Zone-Signing-Key (ZSK) used to sign most RRs
and a Key-Signing-Key (KSK) to sign only the DNSKEY RRset. This
is also the case for the root zone of the DNS.
DNSSEC adds one central point of trust to the DNS at the root
zone — a so called trust anchor (see Fig. 1). Validating recursive
resolvers, or “validators,” only need to trust the KSK of the root to
validate signatures in the DNS. Because the root signs a hash (DS)
of the .com KSK and publishes it in its zone, and because .com also
signs and publishes a hash of the example.com KSK in its zone, a
chain of trust between the different domains is created. Generally,
DNSSEC validation leads to one of three results: the secure state,
meaning the validator successfully verified the authenticity and
integrity of the response, the bogus state, meaning the validator
concluded the signatures in the response are invalid, or the insecure
state, meaning the response was not signed or there is no chain
of trust that allows validation. If a validator concludes a response
is secure, it sets the Authenticated Data (AD) flag in its response
to a client. If a response is bogus, the validator sends an error
to the client with the SERVFAIL response code. If a response is
insecure, the validator returns the response as-is, like a ‘classical’
DNS response.
2.2 The Root KSK Rollover
It is considered good operational practice that operators of zones
signed with DNSSEC be able to periodically change, or “roll,” the
zone’s cryptographic keys. A rollover might be necessary in case
of a security breach, in case operators want to upgrade to a new
algorithm, or because they follow a key management policy [7].
The root zone’s ZSKs are rolled every calendar quarter [8]. When
the root zone was first signed in 2010, it was generally accepted
that the KSK would be rolled after a period of 5 years [1]. The
parties involved in operating the root zone began discussing and
planning a KSK rollover in 2013, but this work was put on hold
when the NTIA announced its intention to transition oversight of
the IANA functions to the Internet community [9]. Work on the
rollover resumed in 2015, culminating in a 2016 Rollover Design
Team report [2]. ICANN and Verisign, in their respective roles as
the IANA Functions Operator and Root Zone Maintainer, used the
design team report to develop a final set of operational plans [10].
KSKZSKDSDNSKEY setsignssignsroot zone.com zoneexample.com zoneKSKZSKDSDNSKEY setsignssignsKSKZSKRRsDNSKEY setsignssignshash ofhash of“www”RRsRRscontainscontainscontainstrustanchorRoll, Roll, Roll your Root
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Figure 2: Time-line of the Root KSK rollover
These plans describe the process for replacing the old KSK, further
referred to as KSK-2010, with a new KSK, now referred to as KSK-
2017. Fig. 2 shows a timeline of each of the phases of the rollover
as described in the operational plan. We have highlighted six key
events in red labeled I – VI. These six events are the focus of this
paper. In the rest of this section, we explain the risks as identified in
the design team report and specific considerations that stem from
the special role of the root’s KSK as a trust anchor.
2.2.1 Risks during the Rollover. The design team report [2] identi-
fies two major risks: validating resolvers that are unable to configure
the new KSK as a trust anchor, and the increase in response size of
the DNSKEY RRset at certain stages of the rollover process.
DNSKEY RRset Changes. Resolvers need a copy or a hash of
the root KSK, and to configure it as a trust anchor. Some modern
resolvers, e.g. BIND, ship with the current root KSK configured as
a trust anchor. Thus, resolvers shipped with only KSK-2010 need a
mechanism to fetch KSK-2017 before the rollover. If this does not
occur, these resolvers fail validation as soon as they need to validate
a signature signed with KSK-2017, when the root zone is published
with its DNSKEY RRset signed by KSK-2017 (IV in Fig. 2).
Resolvers that receive a DNSKEY RRset without a key that matches
their trust anchor may start sending extra DNSKEY queries to the
root. There are two reasons for this: First, some resolver implemen-
tations are designed to retry failures, including validation failures,
at some or all of the available authoritative name servers. Second, re-
solvers typically cache such a failure for a short time only (so-called
negative caching). Once the cached failure expires, the process starts