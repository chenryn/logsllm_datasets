key compromise for 0.5% of HTTPS-enabled Internet hosts [20].
In a different study on remediation of hijacked websites, Li et al.
reported that browser interstitials and search engine warnings cor-
related with faster remediation compared to private notification
via WHOIS contact alone [29].
Figure 1: Overview of Spoofer project architecture, consist-
ing of client software, a server to coordinate measurements,
and a series of receivers to collect packets sent by clients.
Project re-launched.
May 2015
Client allows user to share test results publicly.
Feb 2016
May 2016 New client released, with GUI and automated
probing via daemon.
May 2016 Begin sending private notifications.
Oct 2016
Dec 2016
Mar 2017
Oct 2017
Apr 2018
Present at North American Network Operators’
Group (NANOG) meeting.
Probing speed improvements in client.
Begin testing SAV inbound to client.
Begin testing granularity of IPv6 SAV filters.
Begin testing location of IPv6 SAV filters.
Begin monthly geo-scoped emails to network
operator groups.
Release OpenWRT client.
Deploy new NAT testing mode.
Jun 2018
Sep 2018
Dec 2018 Halt private notifications.
Table 1: Timeline of Spoofer project since re-launch.
3 SYSTEM ARCHITECTURE
The Spoofer system consists of client software, a set of vantage
points for receiving spoofed packets sent by the client, and a server
for coordinating measurements and sending spoofed packets to the
clients, illustrated in figure 1. Measurements collected prior to 2016
were sparse across both time and space (topology) [6]. Because users
had to manually run a program requiring root access, many prefixes
and ASes had only a single test run from them. Since August 2015,
we undertook development efforts to reduce or remove barriers
to operating the measurement client and obtaining measurement
data, and outreach efforts to promote both testing and deployment
of SAV. Table 1 summarizes the major improvements we made, and
some of the outreach to network operators at industry meetings.
First, the client now has a digitally signed install package avail-
able for all major desktop operating systems (Windows, MacOS,
and Linux) as well as OpenWRT, and is also provided as open source.
The client includes a GUI to present results in English, communi-
cates extensibly and securely to our server using protobuf and TLS,
and has the ability to automatically update itself. Ideally the project
would provide a Spoofer App for Android or iOS, but neither plat-
form provides the ability to construct packets with spoofed source
addresses unless the device is jailbroken.
Second, instead of requiring a user to manually initiate tests, the
client is now a daemon that runs tests automatically, periodically
testing at most weekly by default, and also whenever the client
attaches to a network it has not tested previously. The daemon
increases not only the spatial coverage of the data, but also the
temporal coverage, allowing richer and more confident inferences
(§5). The client performs a handshake to receive a list of work items
to do, such as send spoofed packets to a set of cooperating addresses,
conduct traceroutes towards those addresses, and listen for spoofed
packets with specific source IP addresses that the server sends to
the client to test filtering of packets inbound to the client network.
SpooferserverSpooferclientSpooferreceiverscontrol connection inboundto clientoutboundfrom clientAS64498192.0.2.0/24InternetR0R1R3R2Figure 2: Growth in coverage of IP prefixes and ASes measured by the Spoofer project over time, from the beginning of the
project in 2005 until August 2019. The gaps are due to hardware failures. The vertical line at May 2016 indicates when the new
daemonized client was released.
Country
United States
Brazil
Netherlands
Great Britain
Russia
Canada
Germany
India
Australia
Bangladesh
Other:
Total:
1316
494
255
217
202
171
167
155
148
131
2409
25.4%
9.5%
4.9%
4.2%
3.9%
3.3%
3.2%
3.0%
2.9%
2.5%
46.5%
IPv4 and IPv6 ASes
Tested
Spoofable
27.6%
55.1%
29.4%
29.5%
19.3%
29.2%
28.1%
27.1%
25.0%
23.7%
28.8%
31.5%
5178
Figure 3: Fraction of Spoofer project tests with the daemo-
nized client per day with sharing restrictions, over time. The
daemonized client was released in May 2016. The Bézier
curve shows the trend that the percentage of private tests
grew from 5.2% of tests in June 2017, to 10.9% in May 2019.
Third, we expanded the testing capabilities of the client software.
The handshake allows the server to determine if the client is operat-
ing from behind a Network Address Translation (NAT) router, and
our system includes novel tests to evaluate SAV limitations in NAT
implementations (§6.1). The client software now tests both IPv4
and IPv6 on all platforms, including SAV granularity and location
in the network (§6.2). Our system also tests filtering of spoofed
packets inbound to the client’s network, using packets from the
Spoofer server with a source address from the client’s network –
192.0.2.0/24 in figure 1. The presence of a NAT prevents our testing
of the client’s ability to receive spoofed packets because the NAT
device cannot know to forward these packets to the client system.
Finally, to promote SAV deployment, the project now publicly
shares test results with anonymized IP addresses on the project
website, and privately shares unanonymized IP addresses with
Table 2: Number of ASes with prefixes geolocated to a given
country between May 2016 and August 2019 in our data. We
show the percentage of ASes geolocated to each country, and
the percentage of those ASes that were spoofable.
operators who require unanonymized IP addresses to identify spe-
cific equipment without SAV deployed, provided the user does not
opt-out of doing so. The Spoofer client prompts the user for their
sharing preferences when it is first launched. For public reporting,
we anonymize IP addresses by concealing at least the last eight bits
of the address – i.e., for IPv4 addresses we publicly provide the first
24 bits of the address. For IPv6 addresses, we publicly provide the
first 40 bits, as ISP operators may use DHCP prefix delegation to del-
egate prefixes between 48 and 64 bits to individual subscribers [40].
Beginning April 2018, we sent geographically-scoped public emails
to regional network operator group mailing lists to encourage re-
mediation when we had tests from ASes in the geographic region
showing SAV had not been deployed in at least some networks in
the region. To mitigate privacy concerns that might hinder adoption
and use of the Spoofer client, client reports to the Spoofer system
do not include any unique identifier.
ASes(d) Unique per−month(c) CumulativeNew PhaseIPv6/40IPv6/40Slashdot(a) Cumulative(b) Unique per−monthNew PhaseASesIPv4/24IPv4/24ASesASesIPv4/24IPv6/40300250200150100500’18Jan’16Jan’14Jan’12Jan’10Jan’08Jan’06Jan7006005004003002001000ASesIPv6/40ASesIPv4/247K6K5K4K3K2K1K080K60K40K20K01.2K0.8K0.4K0’18Jan01K2K3K4K5K00.2K0.4K0.6K0.8K1.0K’16Jan’14Jan’12Jan’10Jan’08Jan’06Jan7K6K5K4K3K2K1K0ASesASes4.9%5.2%10.9%(b) Privately Share Unanonymized IP AddressesFraction of Sessions Declining to(a) Publicly Share Anonymized IP Addresses11.5% 0 0.3 0Jul’16Jan’17Jul’17Jan’18Jul’18Jan’19Jul’19 0.1 0.2 0.3 0.4 0.2 0.1 0.4The project’s efforts to lower barriers to running the test have
had a measurable impact on coverage of Spoofer measurements (fig-
ure 2). Prior to the release of the probing daemon in May 2016, the
project collected approximately 23k successful test sessions across
11 years, an average of 174 sessions per month. In the following
39 months ending August 2019, the project collected more than
414k sessions, averaging 10,639 sessions per month, i.e., two orders
of magnitude more sessions per month than before the probing
daemon was released, resulting in the project acquiring 17.75 times
more data in 29.5% of the time. Measurement coverage of the global
Internet topology has similarly increased, from 3410 IPv4 ASes
to 6938 – 10.6% of the globally routed ASes as of August 2019 –
with 3528 ASes newly observed since May 2016. IPv6 coverage has
increased from 211 ASes to 980 – 6.3% of globally routed IPv6 ASes
as of August 2019 – with 769 ASes newly observed since May 2016.
Figure 3 shows that 5-10% of users opt-out of publicly sharing their
test results, or privately sharing IP addresses with operators. The
growth in private tests beginning in April 2018 is correlated with
when the Spoofer project began sending geographically-scoped
public emails to regional network operator group mailing lists,
suggesting these public emails prompted operators to use the tool
themselves, but that they did not want their results to be public.
The Spoofer system annotates each test by geolocating the client’s
IP address at collection time using NetAcuity Edge. Table 2 shows
the top 10 countries by number of ASes represented in our data,
where each AS had an IPv4 or IPv6 prefix geolocated to the country
that a client tested since the probing daemon was released in May
2016. Overall, we have tested at least one prefix in 5,178 ASes, with
31.5% of these ASes having at least one prefix that was spoofable.
34.9% of ASes were geolocated to one of two countries: the U.S.,
with 25.4% of the tested ASes, and Brazil with 9.5%. More than half
of the ASes tested within Brazil did not block spoofed packets in
at least one test, making Brazil an outlier in our data. We discuss
remediation activity within the U.S. and Brazil in §7.
4 OVERVIEW
Figure 4 provides an overview of our findings on SAV deployment,
for packets both outbound from and inbound to the measured net-
work, for the year ending 1 August 2019. We present deployment
statistics by IPv4/24 and IPv6/40 prefixes, and by AS. An AS with
partial deployment originates some prefixes from which the Spoofer
system did not receive spoofed packets, and originates other pre-
fixes from which the Spoofer system did.
This data indicates that while most networks block packets with
spoofed source IP addresses, deployment is far from universal. In
particular, 25.2% and 32.1% of tested IPv4 and IPv6 ASes, respec-
tively, had at least one prefix where operators had not deployed SAV
to block outbound spoofed packets to the Internet (first and last
bars in figure 4b). The comparatively small fraction of prefixes from
which we received spoofed IPv4 packets (figure 4a) is primarily due
to the presence of Network Address Translation (NAT) routers that
rewrite spoofed packets with the router’s publicly routable address.
When a NAT router was not present, 14.9% of IPv4 prefixes had no
filtering; filtering was better deployed at prefix-level granularity in
IPv6, with 12.3% of tested prefixes not filtering.
Figure 4: Summary statistics for Spoofer Project for the year
ending August 2019. Percent values to right of barplot indi-
cate the fraction of networks with problematic SAV deploy-
ments, either no filtering or partial filtering of spoofed pack-
ets (red plus orange segments).
The lower panels of figure 4 (c and d) summarize the observed
state of filtering of packets inbound to the client’s network, claiming
to be from within the same subnet as the client. This test sends a
packet to the client with a source address that is inside the same
subnet as the client. For IPv4 we toggle the last (31st) bit of the
address, and for IPv6 we toggle the 120th bit. Surprisingly, inbound
filtering of spoofed packets is even less deployed than outbound fil-
tering, despite these packets being a threat to the receiving network.
Deploying this type of filtering is incentive-compatible because in-
ternal hosts are often more trusted than external hosts [46]. In our
data, 67.0% and 74.2% of IPv4 and IPv6 ASes, respectively, had at
least one prefix where they were not filtering inbound packets.
We compare the IPv4 tests we received for the year ending Au-
gust 2019 where the client was not behind a NAT, to the same class
of tests 1 May 2006 to 7 May 2006, during which the project received
1057 tests, triggered by an article on Slashdot encouraging readers
to run the original Spoofer test [61] (lower left panel of figure 2).
For the first week of May 2006, 18.3% of IPv4/24 prefixes and 20.4%
of ASes tested did not block spoofed-source packets from leaving
their networks. Figure 4 shows that for the year ending August
2019, 14.9% of IPv4/24 prefixes and 30.5% of ASes tested did not
block spoofed-source packets, implying that SAV deployment has
not generally improved.
We reinforce this result by considering the influence of a prefix’s
age – defined as how long it has been observable in the global
BGP routing table – on the probability that it performs source ad-
dress validation. One hypothesis is that older networks are more
Outbound from Client (AS)Inbound to Client (prefix)Inbound to Client (AS)Outbound from Client (prefix) 80 100IPv4IPv4 NATIPv4 No−NATIPv6IPv4IPv4 NATIPv4 No−NatIPv6IPv4IPv6IPv4IPv6 0 20 40 60 80 1007.3%6.4%14.9%12.3%11.9−25.2%22.0%21.1−30.5%24.5−32.1%42.6%62.2%59.2−67.0%68.6−74.2%(a)(c)(d)Percentage with Classification 0BlockedRewrittenPartial(b)No Filtering 20 40 60Figure 5: For Spoofer tests collected between May 2016 and
August 2019, we found no correlation between prefix age
(measured as first appearance in the global BGP routing ta-
ble) and its probability of SAV deployment (as measured by
a client in that prefix performing a test).
mature and hence have better hygiene. However, newer networks
may have newer equipment, less configuration inertia, and better
awareness of network security. The increasing prevalence of ad-
dress transfers post-IPv4-exhaustion adds additional noise to this
already speculative exercise.
We generate a radix trie of prefix ages by iterating over monthly
snapshots of Routeviews [1] and RIPE RIS from January 2000 to
August 2019. The meta-data in the radix trie for each prefix is the
date it first appeared in our snapshots. Note that prefix aggregation