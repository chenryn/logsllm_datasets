 0 200 400 600 800 1000 10000 12000 14000 16000 18000Number of infected devicesSimulation time (second)Figure4.Infectioncurvesfor20sampleruns 5 5.5 6 6.5 7 7.5 8 8.5 9 2 3 4 5Detection delay  (measurement windows)αTD,κ=1TD,κ=4TSD,κ=1TSD,κ=4-0.1 0 0.1 0.2 0.3 0.4 0.5 0.6 2 3 4 5Fraction of infected devices  when worm detectedαTD,κ=1TD,κ=4TSD,κ=1TSD,κ=4(1)Detectiondelay(2)FractionofinfectivesFigure5.Detectionperformance(randomwaypointmodel,TD:temporaldetection,TSD:temporal-spatialdetection)thedetectiondelaysofthetemporal-spatialdetectionschemearecomparabletothoseofthetemporaldetec-tionscheme,althoughsomefalsealarmsareraised.6.2UrbanPedestrianMobilityModelInanothersetofexperiments,wesimulatemobiledevicescarriedbypedestriansmovingintheChicagodowntownareawiththeUDelmodel[22],whichisa3-levelparameterizedmodel:atop-levelmodelthatcharacterizeshigh-levelhumanactivitiessuchaswork-ing,shoppingandathomebasedonsurveysfromUSDepartmentofBureauofLabor,amiddle-leveltaskmodelthatdeterminesspeciﬁctasksassociatedwitheachactivity,andalow-levelagentmodelthatdecideshowapersonmovesbetweendiﬀerentlocations.Wesimulatearound1,500pedestrians,eachofwhomcarriesaBluetoothdevice,intheChicagodowntownareafrom9:00amto12:00pm.Someofthesepeoplemaycometothisareafromtheoutsideorleavethisareaduringthethreehourperiod.Thewalkingspeedissetbetween1.57and4.0milesperhour.WegenerateonemobilitytracetodecidewheretoputBluetoothmonitors.Thisisdoneasfollows.Weﬁrstdividethewhole3-dimensionspaceinto1×1m3cubes,eachofwhichhasacounterinitializedto0.Fromthetrainingmobilitytrace,wetakeasnapshotofeachpedestrian’slocationevery10seconds,andforeachpedestrianinasnapshot,weincreasebyonethecounterofeachcubewhosecenteriswithin10meterrangeofthepedestrian.Afterupdatingthecountersoverallsnapshots,weusethekmlocalk-meansclusteringsoftware[16]toclusterallthecubesinto100pointsin3-dimensionspace.WethenplaceaBluetoothmonitor,whichcollectsdataevery10minutes,ateachofthese100points.Inourexperiments,weusetwodiﬀerentproceduresprovidedbythesoftwaretogettwosetsofmonitorlocations.Inthissetofexperiments,eachBluetoothdevicegeneratesthesametypeofnormaltraﬃcasinthosewiththerandomwaypointmobilitymodel.Also,weusethesamebehavioralmodelofBluetoothworms.Weuse10mobilitytracestosimulatescenarioswith- 0 50 100 150 200 250 300 350 0 4000 8000 12000Number of infected devicesSimulation time (seconds)Figure6.InfectioncurvesofsamplerunsunderUDelmobilitymodel 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 2 2.5 3 3.5 4 4.5 5False alarm rateακ=1κ=2κ=3κ=4Figure7.Falsealarmrates(UDelmobilitymodel,temporal-spatial)outworms,and5otherswithworms.Foreachmobilityscenariowithworms,wesimulate5caseswithdiﬀerentinitialinfecteddevices.ConsideringthattherearetwodiﬀerentsetsofBluetoothmonitorlocations,wesimu-late20caseswithoutwormsand50caseswithworms.Figure6depictstheinfectioncurvesofsomesam-plerunsundertheUDelmobilitymodel.Itisnotedthatthewormpropagationspeedvariessigniﬁcantly.LetHsdenotethesetofcaseswithwormsinwhichatleastsdeviceshavebeeninfectedwhenthesimula-tionﬁnishes.Amongall50caseswithwormpropaga-tion,wehave|H10|=39and|H50|=19.Clearly,theBluetoothwormspreadsmuchmoreslowlyundertheUDelmobilitymodelthanitundertherandomway-pointmodel,becausedevicesinitaremixedtoamuchlesserdegree.Detectionperformance.Toevaluatefalsealarmrates,foreverycasewithoutworms,weusetheremain-ing19onesfortrainingandthenuseitfortesting;toevaluatedetectionrates,weuseeachofthe50caseswithwormsfortestingandthe20caseswithoutwormsfortraining.(1)Temporaldetection.Wesettheparametersinthesamewayaspreviouslyintheexperimentsun-dertherandomwaypointmobilitymodel.Wevaryκamong1,2,3,and4,andαamong2,3,4,and5.Thetemporaldetectionschemedoesnotraiseanyfalsealarms,regardlessofκandα.Figures8(1)and8(2)de-978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
325
 0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 2 2.5 3 3.5 4 4.5 5Detection ratioακ=1κ=2κ=3κ=4 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 2 2.5 3 3.5 4 4.5 5Detection ratioακ=1κ=2κ=3κ=4(1)Detectionrate(H10)(2)Detectionrate(H50)Figure8.Detectionperformance(UDelmobil-itymodel,temporaldetection)pictthefractionofcasesinwhichthetemporalschemesuccessfullydetectsthewormsamongthosethathaveatleast10and50devicesinfectedwhenthesimulationﬁnishes,respectively.Obviously,thetemporaldetec-tionschemeperformspoorlyonwormdetection:evenwiththebestcombinationofparametersκandα,theschemecandetectonlyabout25%ofthecasesinH10and50%ofthecasesinH50.Suchlowdetectionratesattributetotheslowwormpropagationinmostcasesundertheurbanpedestrianmobilitymodel,whichthusdoesnotleadtoabruptincreaseoftheaveragepagingrateovertheentirearea.(2)Temporal-spatialdetection.Similartotheex-perimentsfortherandomwaypointmobilitymodel,wesetμ1(Y(j))bemin{βμ0(Y(j)),Cminpr},whereCminprisonepagingattemptpermeasurementwindow.Also,weletηbe2andrbe100inAlgorithms1and2.ThefalsealarmratesunderdiﬀerentcombinationsofκandαvaluesareshowninFigure7.Wenotethattheimpactofκonthefalsealarmrateissmall,butαaﬀectsthefalsealarmratesigniﬁcantly.ThisstillresultsfromthefactthatthresholdhinEq.(12)islinearwithαandthesquarerootofκ.Moreover,whenαissmall(i.e.,2),thefalsealarmratecanbeashighas70%,whichmakesitimpracticalforreal-worlddeployment.Thissuggeststhatifwewanttoreducethenumberoffalsealertstriggered,weshouldusearelativelylargeα.Ontheotherhand,increasingparameterαleadstolowerdetectionrates.ThisisconﬁrmedinFigures9(1)and9(2),whichshowthedetectionratesamongthecasesinH10andH50,respectively.Wenotethatthedetectionratedecreaseswiththegrowthofparam-eterα.Hence,tostrikeabalancebetweenfalsealarmratesanddetectionrates,parameterαshouldbenei-thertoolargenortoosmall.Agoodoperatingpoint,forinstance,canbe:α=4andκ=2.Underthissetting,thefalsealarmrateis0,andthedetectionra-tiosforthecasesinH10andH50are67%and90%,respectively.Thissuggeststhatifthereareafairnum-berofdevicesinfected,thewormcanbedetectedbythetemporal-spatialdetectionschemewithaveryhigh 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 2 2.5 3 3.5 4 4.5 5Detection ratioακ = 1κ = 2κ = 3κ = 4 0.4 0.5 0.6 0.7 0.8 0.9 1 2 2.5 3 3.5 4 4.5 5Detection ratioακ = 1κ = 2κ = 3κ = 4(1)Detectionrate(H10)(2)Detectionrate(H50) 3 3.5 4 4.5 5 5.5 6 6.5 2 2.5 3 3.5 4 4.5 5Detection delay  in measurement windowsακ = 1κ = 2κ = 3κ = 4 0.02 0.03 0.04 0.05 0.06 0.07 0.08 2 2.5 3 3.5 4 4.5 5Fraction of infectives  when worm detectedακ = 1κ = 2κ = 3κ = 4(3)Detectiondelay(4)FractionofinfectivesFigure9.Detectionperformance(UDelmobil-itymodel,temporal-spatialdetection)probability.Figures9(3)and9(4)furtherdepictthedetectiondelayinmeasurementwindowsandthefractionofin-fecteddeviceswhenthewormisdetected,respectively.Generallyspeaking,thetemporal-spatialdetectionschemeisquiteeﬀectivebecausewhenthewormisdetected,lessthan8%ofthedevicesareinfected,regardlessofparametersκandα.Undertheaforementionedoperat-ingpoint(i.e.,α=4andκ=2),theaveragedetectiondelayis6measurementwindows,whichisaboutonehour,andwhenthewormisdetected,slightlyfewerthan5%ofthedeviceshavebeeninfected.Suchalowinfectionratiowhenthewormisdetectedmakesthetemporal-spatialschemeaviablesolutioninpractice.6.3HybriddetectionItisnotedthatwhenweusetherandomwaypointmobilitymodelunderwhichthewormspreadsveryfast,boththetemporalandtemporal-spatialdetec-tionschemesleadto100%detectionratewithoutfalsealarms,buttheformeroutperformsthelatterduetoitssmalldetectiondelay;incontrast,whentheurbanpedestrianmobilitymodelisused,thetemporal-spatialdetectionschemeachievesmuchhigherdetectionrates.Inahybridmode,Blue-Watchdogusesbothmethodssimultaneously:Ifeitherofthemﬂagsanalert,awormpropagationwarningisraised.Withthishybridap-proach,Blue-Watchdogachieveshighdetectionrateswithoutfalsealarmsunderbothmobilitypatterns.AlthoughwedonothaverigorousresultsregardingthecomputationalcostofBlue-Watchdog,weobservefromourexperimentsthattheoverheadisinsigniﬁcant:theexecutiontimeofeachschemeisignorablerelativetothelengthofeachmeasurementwindow,andthe978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
326
memoryfootprintsunderbothschemesareverylowonthecommodityPCsweusedfortheexperiments.7ConclusionsandFutureWorkMalwarethatspreadonmobiledeviceshavebeenontheriserecently.Inthiswork,weproposeanar-chitecturecalledBlue-Watchdogtodetectmobilemal-warethatexploitBluetoothforpropagation.Blue-WatchdogdetectsBluetoothwormpropagationfrombothtemporalandtemporal-spatialperspectives.Ex-perimentalresultswithbothrandomwaypointmobil-itymodelandamorerealisticurbanpedestrianmobil-itymodelshowthatBlue-Watchdog,whenoperatingunderahybridmode,caneﬀectivelydetectBluetoothwormpropagationwithoutfalsealarms.InBlue-Watchdog,weappliedtheCUSUM-GLRal-gorithmtodetectBluetoothwormpropagationfrombothtemporalandtemporal-spatialperspectives.Toderiveitsparameters,wemakeassumptionssuchasnormaldistributionsforbothXiinEq.(2)andY(j)iinEq.(13)tosimplifyanalysis.Duetolackofreal-worldBluetoothtraces,wecouldnotvalidatethefeasibilityofsuchassumptionsrigorously.Iftheseassumptionscannotbeveriﬁedbyfuturemeasurementresults,wecaninsteadusethenon-parametric,butusuallylesseﬃcient,versionoftheCUSUMalgorithm,whichdoesnotrequireaprioriknowledgeofthedistributions[27].Moreover,duetothehighcomputationalcostofBlue-toothwormsimulation,inthisstudywecannoteval-uatetheeﬀectivenessofBlue-Watchdogcomprehen-sivelyunderdiverseparametersettings.Weplantoexplorethisfurtherinourfuturework.Admittedly,Blue-WatchdogcannotdetectallBlue-toothworms,especiallythosethatintelligentlycon-straintheirpagingattemptstoevadedetection.Suchshortcomingsaregenerallysharedbydetectionschemesbasedonstatisticalanomalydetection.Inthefuture,weplantodevelopothercomplementarytechniques,suchasBluetoothpacketinspectionandbehavioralanalysis,tofurtherimprovedetectionaccuracy.References[1]http://www.isi.edu/nsnam/ns/index.html.[2]http://www.ececs.uc.edu/~cdmc/ucbt/ucbt.html.[3]M.H.G.AnthonyandN.Biggs.ComputationalLearn-ingTheory.CambridgeUniversityPress,1997.[4]A.Bose,X.Hu,K.Shin,andT.Park.Behavioralde-tectionofmalwareonmobilehandsets.InProceedingsofMobiSys,June2008.[5]A.BoseandK.G.Shin.Onmobilevirusesexploitingmessagingandbluetoothservices.InProceedingsofSecureComm,2006.[6]B.E.BrodskyandB.S.Darkhovsky.NonparametricMethodsinChangePointProblems.KluwerAcademicPublishers,1993.[7]J.Cheng,S.Wong,H.Yang,andS.Lu.Smartsiren:Virusdetectionandalertforsmartphones.InProceed-ingsofACMMobiSys,2007.[8]http://www.f-secure.com/v-descs/commwarrior.shtml.[9]C.Fleizach,M.Liljenstam,P.Johansson,G.M.Voelker,andA.Mehes.Canyouinfectmenow?:mal-warepropagationinmobilephonenetworks.InPro-ceedingsofACMWORM’07,2007.[10]http://www.theregister.co.uk/2006/03/30/ﬂexispy.[11]http://www.f-secure.com/v-descs/cabir.shtml.[12]P.GuptaandP.R.Kumar.Internetinthesky:Capac-ityof3-dwirelessnetworks.InProceedingsofCDC’02.[13]G.HuandD.Venugopal.Amalwaresignatureextrac-tionanddetectionmethodappliedtomobilenetworks.InProceedingsofIPCCC,April2007.[14]http://www.f-secure.com/v-descs/inqtanaa.shtml.[15]H.Kim,J..Smith,andK.Shin.Detectingenergy-greedyanomaliesandmobilemalwarevariants.InProceedingsofMobiSys,June2008.[16]http://www.cs.umd.edu/~mount/Projects/KMeans/.[17]J.W.MickensandB.D.Noble.Modelingepidemicspreadinginmobileenvironments.InProceedingsofACMWiSe’05,2005.[18]V.PaxsonandS.Floyd.Wide-areatraﬃc:thefailureofpoissonmodeling.SIGCOMMComput.Commun.Rev.,24(4):257–268,1994.[19]R.Racic,D.Ma,andH.Chen.Exploitingmmsvulner-abilitiestostealthilyexhaustmobilephone’sbattery.InProceedingsofSecureComm,August2006.[20]J.Su,K.K.Chan,A.G.Miklas,K.Po,A.Akhavan,S.Saroiu,E.D.Lara,andA.Goel.Apreliminaryinvestigationofworminfectionsinabluetoothenvi-ronment.InProceedingsofACMWORM’06,2006.[21]http://www.commsdesign.com/design_corner/OEG20020313S0049,2002.[22]http://udelmodels.eecis.udel.edu.[23]H.Wang,D.Zhang,andK.G.Shin.DetectingSYNﬂoodingattacks.InProceedingsofINFOCOM’02.[24]G.Yan,L.Cuellar,S.Eidenbenz,H.D.Flores,N.Hen-gartner,andV.Vu.Bluetoothwormpropagation:mo-bilitypatternmatters!InProceedingsofASIACCS’07.[25]G.YanandS.Eidenbenz.Bluetoothworms:Models,dynamics,anddefenseimplications.InProceedingsofACSAC’06.[26]G.YanandS.Eidenbenz.Modelingpropagationdynamicsofbluetoothworms.InProceedingsofICDCS’07,2007.[27]G.Yan,Z.Xiao,andS.Eidenbenz.Catchinginstantmessagingwormswithchange-pointdetectiontech-niques.InProceedingsofLEET’08.