Hacking Web Apps
Def Con 11 version
Copyright 2002-2003 - David Rhoades
slide 2
Warning – Hazards to your Freedom
• Unauthorized access to 
systems & data is illegal in 
most places.
– Get permission in writing before 
performing scans, audits, 
assessments, etc!
– For details see 
http://www.lightlink.com/
spacenka/fors/
Copyright 2002-2003 - David Rhoades
slide 3
This is not a Drill
• True Stories
– The vulnerabilities you are about to see 
are real, only the names have been 
changed to protect the vulnerable.
– Discovered over the past several years 
by the author during AUTHORIZED 
security assessments of customers 
• consumer banking, credit cards, travel 
reservations, B2B banking, 401K, stock 
broker, project collaboration & document 
sharing
Copyright 2002-2003 - David Rhoades
slide 4
Course Purpose
• We will cover…
– various web application 
weaknesses
– tools & methods to find and 
exploit them
• We will not cover…
– comprehensive audit/assessment 
methodologies
– all tools/techniques
– solutions for holes seen
Copyright 2002-2003 - David Rhoades
slide 5
About the Instructor/Author
• David Rhoades
– PSU - B.S. Computer Engineering
– Info Sec since 1996
– PI:EMAIL
• Maven Security
Consulting, Inc.
– www.MavenSecurity.com
(I’m the one on the right.)
Copyright 2002-2003 - David Rhoades
slide 6
Course Agenda
• The Problem
• Tools of the Trade 
(i.e. warez)
• Points of Attack 
– live demos
• Further Resources
Copyright 2002-2003 - David Rhoades
slide 7
The Problem 
(Can’t we all just get along? …No!)
•
Web sites are hacked for various reasons:
–
political, revenge, fame, fortune, fun (genetic?, vitamin 
deficiency?)
•
Not just web “sites” - applications too
–
Hotmail, CD Universe, shopping carts
–
See for the latest casualties 
http://www.securitytracker.com/archives/category/4.html
•
SANS/FBI – The Twenty Most Critical Internet 
Security Vulnerabilities 
–
Web servers are at the top of the list, see 
http://www.sans.org/top20/
–
Vulnerability stats
http://www.securitytracker.com/learn/statistics.html
•
The results: 
www.zone-h.org/en/defacements
–
bad press => lost customer confidence => lost revenue & 
legal consequences
Copyright 2002-2003 - David Rhoades
slide 8
Tools of the Trade Overview
• Some essential techniques
– Intercept & manipulate raw HTTP
– Mirror web sites
– Automate fake browser requests 
(a.k.a. brute force)
– Decompile Java Applets
HTTP – Hyper Text 
Transfer Protocol
HTML – Hyper Text 
Markup Language
• The Problem
 Tools
• Points of Attack
• Resources
Copyright 2002-2003 - David Rhoades
slide 9
Technique – Traffic Interception & 
Manipulation
• Purpose: Manipulate Input
– Bypass client-side size restrictions
• HTML’s MAXLENGTH
• Client-side JavaScript filters
– Violate the protocol (i.e. HTTP)
– Insert alternate choices into lists and 
pull down menus
– Change cookies, hidden elements, 
everything & anything
• Other purpose
– Record HTTP/HTML for analysis (e.g. 
code comments, custom headers)
Copyright 2002-2003 - David Rhoades
slide 10
Interception Tool – Achilles Intro
• (Old news) World’s first 
publicly released general 
purpose web application 
security assessment tool
– Concept: David Rhoades 
(with apologies to web app developers everywhere)
– Code: Robert Cardona
• http://achilles.MavenSecurity.com
– Released Oct 2000
Copyright 2002-2003 - David Rhoades
slide 11
Achilles – Matrix-style Web Proxy
• Simple web proxy
– Win32 GUI or UNIX via WINE
– Notepad with an attitude
• Freeze traffic mid-stream and 
modify
– outbound and inbound browser traffic
– SSL and non-SSL
– Change any HTTP header, cookie, form 
element
• Body length automatically recalculated for 
POST statements
– Log all traffic to a text file
Copyright 2002-2003 - David Rhoades
slide 12
Achilles – HTTP Exposed
•
SSL does not
protect your 
web app, it 
protects traffic 
in transit
– Provides
server/client 
auth too
Copyright 2002-2003 - David Rhoades
slide 13
Web Server
Web Browser
Achilles
Achilles – Architecture for SSL Sites
SSL 1
SSL 2
Achilles looks like a web server 
to the browser
Achilles looks like a web 
browser to the remote site
Copyright 2002-2003 - David Rhoades
slide 14
DEMO – Achilles
• Capture outbound web 
request
• Capture inbound reply
I see 
everything
Copyright 2002-2003 - David Rhoades
slide 15
Achilles – Stupid Party Tricks: 
Modify Inbound Traffic Too
Copyright 2002-2003 - David Rhoades
slide 16
Tools – Intercept & Modify Proxies
• WebProxy v1 (freeware)
– http://www.astalavista.com/tools/auditing
/network/http-server/
– Java (Windows/UNIX)
– Auto hack feature (i.e. fuzz)
• WebProxy v2+ (Commercial)
– http://www.atstake.com/webproxy
• Spike Proxy
– Python script (Window/UNIX)
– Auto hack feature (i.e. fuzz)
– www.immunitysec.com/spikeproxy.html
Several ‘intercept 
and modify’ proxies 
are now 
available…much 
better than Achilles
Copyright 2002-2003 - David Rhoades
slide 17
Tools – More Intercept & Modify Proxies
•
Tool: Odysseus
–
http://www.wastelands.gen.nz/index.php?page=odysseus
–
Win32 EXE
–
GUI/SSL/Proxy based
•
Tool: Paros v2.2 Free Edition 
–
http://www.proofsecure.com
–
Win32 EXE
–
GUI/SSL/Proxy based
–
HTTP 1.1
–
spider function
–
XSS testing
•
Tool: PenProxy 
–
http://shh.thathost.com/pub-java/html/PenProxy.html
–
Java (Windows/UNIX)
–
No SSL/TLS support
•
Tool: HTTPush 
–
http://sourceforge.net/projects/httpush
–
Client interface thru browser
–
Open Source Project
–
XML plugins (e.g. whois)
–
SSL and non-SSL
–
This tools is not actively being developed.
Copyright 2002-2003 - David Rhoades
slide 18
Tools – Browsers/Browser Extensions
• These are browser-like, or 
browser extensions useful for 
manipulating web traffic
– All IE-based
• Form Scalpel 
– http://www.ugc-
labs.co.uk/tools/formscalpel/
• IE Booster 
– www.paessler.com/products/ieb/index.
html
Copyright 2002-2003 - David Rhoades
slide 19
Tool – General Purpose Tool Kits 
for Web App Testing
•
Web Sleth
–
http://www.geocities.co
m/dzzie/sleuth/
•
Platform: Win32 GUI
•
Purpose: All-in-one 
web app security 
audit tool set.
–
Parses web pages to 
catalog forms, cookies, 
HTML comments, etc…
–
Modify form elements 
manually
–
Modify form elements 
automatically (via 
plugin)
•
Supports SSL
•
Free, open-source 
version
•
Commercial version
•
Web Scarab
–
www.owasp.org/websc
arab/
•
Java based
•
“…a true ‘Open 
Source’ web 
application security 
assessment tool. The 
tool will be able to 
examine a complete 
web site or individual 
applications running 
within a web site for 
security issues.”
•
Status: Beta now 
available.  More 
coming…
Copyright 2002-2003 - David Rhoades
slide 20
A closer look at WebProxy – Features
• Works with HTTPS 
(SSL/TLS).
• Fuzzing – permutations of 
user selected traffic 
components
– text file defines input (fuzzstrings)
– text file defines signature to look 
for in server’s output 
(errorstrings)
• Automatic, on-the-fly, find-
and-replace of HTTP traffic
Copyright 2002-2003 - David Rhoades
slide 21
WebProxy – Administration Interface
• Interface via browser
– change browser’s proxy settings
• Surf to http://webproxy
Copyright 2002-2003 - David Rhoades
slide 22
WebProxy – Terminal Window Monitor
• A command 
prompt 
window will 
display client 
requests and 
server 
responses
• Beware of 
“Select”  
mode
Copyright 2002-2003 - David Rhoades
slide 23
WebProxy –
Intercepting Browser Requests
Copyright 2002-2003 - David Rhoades
slide 24
WebProxy – “Un”documented Features
• Official FAQ states…
– “Are there any undocumented features in 
WebProxy? Yes.”
• Transparent proxy
• Add to .webproxyrc file
– addproxy transhttp 5113  
8080 127.0.0.1
– Transparent proxy now running on 127.0.0.1 
port 5113
– Remote proxy on port 8080 will think it is the 
only proxy
• Now you can daisy chain with a 
normal proxy.
• Normal proxy will not see WebProxy 
(i.e. transparent)
Copyright 2002-2003 - David Rhoades
slide 25
Tool – IE Booster Intro
•
Web Browser 
Extensions for IE 5/6
–
Extended context menu 
(left click) 
–
Show all forms and 
applets of a web page
–
See and edit hidden 
form elements ☺
•
Version 1.4 
(Freeware)
•
www.filelibrary.com:
8080/cgi-bin/
freedownload/
New_Files/n/150/
ieboostr.zip
•
Version 2.x 
(Shareware – 30 day 
trial)
•
www.paessler.com/ie
booster
Copyright 2002-2003 - David Rhoades
slide 26
Technique – Brute Force Authentication
• Brutus
– www.hoobie.net/brutus
/index.html
• Platform: Win32 GUI
• Purpose: Brute force web logins
(both kinds –
Country & Western)
– HTTP Basic Authentication
– Form-based Authentication
• GET or POST
– Brute forces other protocols too
• FTP, telnet, POP3, SMB…
Copyright 2002-2003 - David Rhoades
slide 27
Brute Force Tool – Brutus Features
• Brute force 
many types of 
auth
– web forms and 
Basic auth
– POP, telnet, FTP, 
SMTP
• Exhaustive word 
list generation
– all lower case 
character strings 6 
to 8 characters 
long
• HTML form 
viewer 
– to assist in form 
based brute force
• Built in script 
maker 
– to learn new 
protocol for brute 
forcing
• Word list 
permutations
– password -> 
pa55w0rd
Copyright 2002-2003 - David Rhoades
slide 28
Other Brute Force Tools for Web Apps
•
Win32: wwwhack
–
http://packetstormsecurity.org/Crackers/wwwhack.zip
•
UNIX: Authforce  
–
kapheine.hypa.net/authforce/index.php
•
Win32: Brutus 
–
http://www.hoobie.net/brutus/index.html
•
UNIX: THC Hydra
–
www.thc.org/releases.php
•
Nessus (specific plugin)
–
“Unknown CGIs arguments torture” 
–
Brute forces CGI parameters in general, not just 
authentication
–
http://cgi.nessus.org/plugins/dump.php3?id=10672
•
Screaming Cobra cobra.lucidx.com
–
no SSL; not being updated; but nice proof-of-concept 
(crawl and fuzz)
Copyright 2002-2003 - David Rhoades
slide 29
Other Brute Force References
• Word Lists
– www.packetstormsecurity.nl/
Crackers/wordlists/
• Build word variations 
– sourceforge.net/projects/variation
s/
Copyright 2002-2003 - David Rhoades
slide 30
Technique – Decompiling Java Applets
• Compiled into byte-code, 
but can be decompiled
• Java Applets from…
– Client-side code
– Stolen from server
– Lots of apps (WebProxy) are Java
• May contain sensitive info
– username / password
– “secret” URLs
– undocumented features
Copyright 2002-2003 - David Rhoades
slide 31
Tools – Java Decompiling
• JAD
– http://www.geocities.com/zz_
xu/jad.html
• Mocha 
– http://www.brouhaha.com/~
eric/computers/mocha.html
• Sourcetech
– http://www.srctec.com/decompile
r/index.htm
Copyright 2002-2003 - David Rhoades
slide 32
Technique –Mirror/Crawl Web Site
• Automated Mirror
– Use web mirroring software (AKA.  robots, 
crawlers, spiders, offline browsers) to download 
the site onto your hard drive.
– Search the captured files for…
• HTML and script comments
• Inappropriate use of the GET method (versus 
POST)
• GENERATOR tags (e.g. FrontPage)
– Try to capture HTTP headers for more info…