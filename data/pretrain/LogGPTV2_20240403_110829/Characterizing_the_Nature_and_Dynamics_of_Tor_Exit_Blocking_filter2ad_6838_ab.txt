26th USENIX Security Symposium    327
Exit Family
# Exits % Tor Trafﬁc
Email Dates
# Complaints Top Complaint
Torservers.net
apx
TorLand1
jahjah
Our exits
10–20
3
1
1
10
7.05% 2010/06–2016/04
1.94% 2014/11–2016/05
0.75% 2011/12–2016/10
0.17%
2016/1–2017/1
2016/9–2017/2
3.14%
2,987,017 DMCA Violation (99.74%)
293 Automated Scan (38.49%)
307 Malicious Trafﬁc (16.99%)
75 Unauthorized Login Attempts (34.15%)
650 Network Attack (48.68%)
Table 2: Email complaints sent to the exit operators
jahjah exit was started in 2015 but the operator was only
able to provide complaints received from 2016 onwards.
4.2 Analysis
We extract the nature of abuse, the time of complaint, and
the associated exit IP addresses. 99.7% of the complaints
received by Torservers.net related to Digital Millennium
Copyright Act (DMCA) violations, with over 1 million
of the complaints sent by one IP address. These emails
use a template, enabling parsing of email text with regu-
lar expressions. The majority of the non-DMCA emails
also follow a template, but the structure varied across a
large number of senders. To extract the relevant abuse
information from non-DMCA complaint emails, we ﬁrst
applied KMeans clustering to identify similar emails. We
manually crafted regular expressions for each cluster. We
used these regular expressions to assign high conﬁdence
labels to emails. Not all emails matched such a tem-
plate regular expression—e.g., one-off complaints sent
by individuals. We classiﬁed these emails by looking
for keywords related to types of abuse. We iteratively
reﬁned this process until manually labeled random sam-
ples showed the approach to be quite accurate, with only
2% cases of misidentiﬁcation.
99.99% of all DMCA violation complaints were
against the Torservers’ exits. The other exits collec-
tively received only 12 such complaints. Over 99% of
DMCA complaints mentioned the usage of BitTorrent for
infringement; the rest highlighted the use of eDonkey.
We categorized the Non-DMCA complaints into ﬁve
broad categories enumerated in Table 3. Network abuse
is the most frequent category of non-DMCA complaints.
≈15% of the complaints related to network abuse came
from Icecat [24], a publisher of e-commerce statistics
and product content. Icecat’s emails complain about ex-
cessive connection attempts from the jahjah exit and 13
exit IP addresses hosted by Torservers. These emails
were received from November 2011 until December
2012. Other exit operators also received similar com-
plaints during the same time frame [25]. We checked a
recent Tor consensus in November 2016 and found eight
exits that avoided exiting to the Icecat IP address.
The second most common non-DMCA complaints are
about automated scans and bruteforce login attacks on
Wordpress. Automated scanning, speciﬁcally port and
vulnerability scanning, accounts for 13.6% of the non-
DMCA complaints across the entire time range of our
dataset.
Instances of Wordpress bruteforce login at-
tacks lasted for a comparatively shorter period, Septem-
ber 2015 until May 2016, but constitute 12.1% of non-
DMCA complaints. All of the exits in our dataset re-
ceived complaints about bruteforce login attempts from
Wordpress except our own exits, probably because we
started our exits after the attack stopped.
Email, comment, and forum spam constitutes 9.01%
of non-DMCA complaints. Note that all of the exits
in question have the SMTP port 25 blocked. Our data
shows a spike in the number of abuse complaints regard-
ing referrer spam from Semalt’s bots [26] towards the
end 2016. 1.05% of the non-DMCA emails complain
about harassment. Over 11% of the non-DMCA emails
do not fall under the mentioned categories. These emails
include encrypted emails and emails unrelated to abuse.
4.3 Consequences of Undesired Trafﬁc
Along with the complaints, some emails mention the
steps the sender will
take to minimize abuse from
Tor. 34.3% of the emails mentioned temporary block-
ing (19.8%), permanent blocking (0.2%), blacklisting
(9.8%) or other types of blocking (4.6%). The rest of
the emails notify the exit operators about the abuse. For
the most frequent form of blocking, temporary blocking,
the emails threaten durations ranging from 10 minutes to
a week. Some companies (e.g., Webiron) maintain dif-
ferent blacklists depending on the severity of the abuse.
The majority of the blacklists mentioned in the emails
are either temporary or unspeciﬁed. Only 18 emails men-
tioned permanently blocking the offending IP address. A
small fraction (less than 1%) of the emails ask exit oper-
ators to change the exit policy to disallow exiting to the
corresponding website.
We did not ﬁnd any complaint emails from known
Tor discriminators, such as Cloudﬂare and Akamai.
Among the websites we crawled to quantify discrimina-
tion against Tor, we found complaints from Expedia and
328    26th USENIX Security Symposium
USENIX Association
Category
Includes
Network abuse
Unauthorized access
Automated scan
Spam
Harassment
Other
DDoS, botnet, compromised machines
Failed login attempts, brute-force attacks, exploits for gaining access
Port scans, vulnerability scans, automated crawling
Email, comment, and forum spam
Threats, obscenity
(unreadable encrypted emails, emails not reporting abuse)
Percent
38.03%
26.45%
14.15%
9.01%
1.05%
11.31%
Table 3: Categories of the Non-DMCA Email Complaints (Total 8,370 emails)
Zillow. Expedia complained about an unauthorized and
excessive search of Expedia websites and asked exit op-
erators to disallow exiting to the Expedia website. Zil-
low’s complaint was less speciﬁc, about experiencing
trafﬁc in violation of their terms and conditions.
Exit Family Avg. users Avg. complaints
apx
TorLand1
jahjah
Our exits
23,082.08
59,284.54
1,206.30
3,050.81
0.53
0.17
0.19
5.55
Table 4: Avg. simultaneous users and complaints per day
compare it with the total amount of abuse going through
the exits. Our goal is to understand how many Tor users
will be affected if we block an exit because of abuse com-
plaints. To do this, we collect the estimation of simulta-
neous Tor users per day from Tor Metrics [27]. Then
we collect the historical Tor consensus to compute how
much trafﬁc went through an exit per day.
If an exit
A handles e% of the total Tor bandwidth on day d and
the number of simultaneous users of Tor on d is u, then
approximately eu
100 of the users used A on day d.2 We
estimate users for each exit in Table 2 from September
2011 (the beginning of the Tor metrics data). We ex-
clude the Torservers exits because tracing the Torservers
exits in the historical consensuses is difﬁcult as those ex-
its changed IP addresses and exit ﬁngerprints more than
once.
Compared to the average number of Tor users, the
amount of abuse is insigniﬁcant (Table 4). However,
we are considering one abuse email as one instance of
abuse, but in practice one email can correspond of many
instances of abuse, for example, one brute-force attack
can consist of thousands of visits to a website.
5
IP Address Blacklisting
We analyze how popular commercial IP blacklists treat
Tor relays. IP blacklisting can be in response to mali-
cious trafﬁc originating from the IP, which we call re-
active blacklisting. We also observed proactive black-
2Even though the bandwidth is one of the main factors for selecting
an exit, the other factors such as the exit policy might affect which exits
will be selected. For our estimation, we do not consider the effect of
exit policies.
Figure 1: The cumulative number of complaints aver-
aged over our exits sharing the same bandwidth and pol-
icy. Solid lines represent default policy exits and dashed
lines represent RR policy exits.
4.4 Exit Properties and Complaints
We investigate the effects of two exit properties on the
number of corresponding abuse complaints received:
policy and bandwidth. For this analysis, we counted the
number of email complaints that explicitly mention the
IP address of our exits. We ﬁnd that higher-bandwidth
exits received more complaints (Figure 1). This cor-
relation is statistically signiﬁcant (Pearson’s product-
moment correlation = 0.98, p-value = 0.0016). However,
exit policy did not have any statistically signiﬁcant cor-
relation with the number of complaints. We also did not
notice any signiﬁcant differences between the types of
complaints that exits received.
4.5 Comparison with Average Tor Trafﬁc
We estimate the average number of simultaneous Tor
users per day through the exits getting complaints and
USENIX Association
26th USENIX Security Symposium    329
050100150Oct−2016Nov−2016Dec−2016Jan−2017Feb−2017TimeNumber of ComplaintsLargeMediumSmallEffect of Exit Policy and Bandwidthlisting, blacklisting based upon a network’s pre-existing
reputation or the online service’s policy (e.g., the video-
on-demand service, Hulu, blocks access to all VPN end-
points). After discussing our data sources, we describe
how we classify blacklist entries into proactive black-
listing of Tor simply due a policy decision to deny ac-
cess from Tor, versus reactive blacklisting in response to
abuse. We then look at the amount of blacklisting of Tor
and compare it to VPN IP address spaces and the IP ad-
dress space of a large university in the USA. We analyze
the impact of relay uptime, consensus weight, and exit
policy on blacklisting behaviour.
5.1 Data Sources
For our study we were given access to a system that gath-
ers commercial IP threat intelligence, including black-
lists, from large Web companies. Facebook’s ThreatEx-
change [28] platform is a major contributor to the system.
This system has gathered roughly 2TB of data from 110
sources since July 25, 2015. We have anonymized the
names of some IP blacklists in our results.
Along with the hourly Tor consensus data, we use ad-
ditional methods to gather the set of Tor exit IP addresses
seen by servers. While the Tor consensus provides the
IP addresses used to reach exit relays (their “onion rout-
ing” IP addresses), a signiﬁcant fraction of all exit relays
(6% to 10%) use a different IP address for connecting
to servers. To capture these IP addresses, we also asso-
ciate with each relay its exit IP address provided by Tor
DNSEL [29]. Tor DNSEL gathers the IP address used by
a relay for exiting trafﬁc based on active testing.
5.2 Classifying Blacklist Entries
Given Tor’s reputation of transiting undesired trafﬁc,
some blacklists proactively include Tor relay IP ad-
dresses. Since we are interested in the rate and impact of
undesired trafﬁc Tor is currently producing, we must sep-
arate proactive blacklisting based upon historical events
from reactive blacklisting based upon current events.
We use several methods to classify blacklist entries
into proactive and reactive ones. In the simplest case,
the blacklist provides the reason behind inclusion, either
on an entry or on a list-wide basis. In some cases of reac-
tive listing, the blacklist even provides information about
the undesired trafﬁc leading to blacklisting.
For those entries on lists that do not provide reasons
for inclusion, we look at the behavior of the list overall
to infer its reason for blacklisting. We infer that lists in-
cluding a large percentage of Tor IP addresses soon after
they appear in the consensus data likely reﬂect proac-
tive listing of the addresses.
If more than 30% of Tor
relay addresses have been enlisted on a blacklist within
24 hours of them appearing in the consensus, we con-
sider that blacklist proactive. We consider the remaining
lists to be reactive. We discuss the details of deciding the
threshold of 30% in Section A of the Appendix.
Figures 2a and 2b compare the rate of blacklisting by
a proactive and a reactive blacklist. These graphs show
the rate of blocking Tor exit IP addresses and of non-exit
Tor IP addresses, whose blocking may be superﬂuous.
In a small number of cases, the time until blacklisting
is negative since the address was blacklisted before ap-
pearing in the consensus data, presumably from the IP
address’s prior use or the blacklisting of whole blocks
of addresses. Under our analysis, the blacklist Paid Ag-
gregator, a large paid provider of threat intelligence, is
a proactive blacklist since 76.6% of Tor IPs enlisted on
it were added within 24 hours of them ﬁrst appearing in
the consensus (Fig. 2a). The distributions show that the
majority of the listed IP addresses get listed within a few
hours of them becoming Tor relays. We classify Con-
tributed Blacklist 12, a data source that contributes threat
intelligence to a community aggregation project, as reac-
tive since only 0.06% of all Tor IP addresses were added
within the ﬁrst 24 hours of their appearance in the con-
sensus or the DNSEL (Fig. 2b).
Using both methods of classifying lists, we found 84
lists that either include Tor exits proactively or reactively.
Using the lists’ labels and names, we classiﬁed 4 black-
lists as proactive. We additionally classify 2 blacklists as
proactive based on the time taken by them to enlist Tor
IP addresses.
Identifying the proactive blacklisting of Tor exits also
sheds light on the nature of Tor blocking employed by
servers today. Proactive blacklisting implies that Tor
users share fate not only with other users of their exits but
also with all Tor users, including the ones in the distant
past. We ﬁnd that 6 out of 84 (7%) large commercially
deployed blacklists proactively block Tor IP addresses.
5.3 Amount of Blacklisting
Figure 3 depicts the fraction of exit/non-exit relay IP ad-
dresses blacklisted by various lists during the observation
time frame. From 110 blacklists that the IP reputation
system gathers, 84 list Tor IP addresses in the observa-
tion time frame. For legibility, Figure 3 shows only the
lists that included more than 1% of either Tor non-exit
relays, Tor exit relay, or a VPN’s IP addresses.
We observe that a few blacklists list a large number of
Tor IP addresses, including non-exit relay IP addresses.
In particular, Paid Aggregator (the proactive list shown
in Fig. 2a) listed not only 48% of Tor exit addresses, but
also 35% of entry and middle relay IP addresses. Black-
listing non-exit relays is surprising, since non-exit relays
are not responsible for exiting trafﬁc from the Tor net-
330    26th USENIX Security Symposium
USENIX Association
(a) Paid Aggregator (proactive)
(b) Contributed Blacklist 12 (reactive)
(c) Fraction of IPs blacklisted
Figure 2: (a) and (b) provide the time (in hours) between ﬁrst seeing a relay IP address in the consensus until the given
blacklist enlists the IP address. Negative values indicate cases where the IP address was blacklisted before appearing in
the consensus. Figure (c) compares the fraction of public IP addresses of different types of networks that are currently
in any tracked blacklist.
work. Some relays have historically, at different points
in time, been both exit and non-exit relays in the Tor con-
sensus. In our analysis, we consider a relay an exit if it
had the Exit ﬂag at any point in its lifetime. Doing so pro-