title:Viden: Attacker Identification on In-Vehicle Networks
author:Kyong-Tak Cho and
Kang G. Shin
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/LCOMM.2019.2937097, IEEE
Communications Letters
1
Attacker Identiﬁcation and Intrusion Detection for
In-vehicle Networks
Jing Ning, Student Member, IEEE, Jiadai Wang, Student Member, IEEE, Jiajia Liu, Senior Member, IEEE,
and Nei Kato, Fellow, IEEE
Abstract—As the most wide-spread in-vehicle data bus pro-
tocol, CAN (Controller Area Network) has attracted more and
more attention due to its lack of security protection mechanism. A
variety of attacks against CAN bus have emerged, posing serious
threat to vehicle safety. Accordingly, some methods have been
proposed to detect CAN bus attacks, however, they have certain
shortcomings such as additional computing burden and obvious
false detection rate. Therefore, using the physical characteristics
of voltage signal on CAN bus, we propose an LOF (Local Outlier
Factor)-based intrusion detection method, which can greatly
reduce the false detection rate as well as improve the detection
accuracy. The modiﬁcation of CAN protocol and the additional
computation burden can also be avoided. In addition, to the best
of our knowledge, we are the ﬁrst to implement bus-off intrusion
detection on real vehicles.
I. INTRODUCTION
With the ﬂourishing development of modern vehicle indus-
try, great attention has been paid to the safe and comfortable
driving experience, resulting in a myriad of advanced vehicle
applications such as infotainment systems, on-board diagnos-
tics and Advanced Driver Assistance Systems (ADASs) [1].
While these complex auxiliary functions built upon wired
electronics and ECUs (Electronic Control Units) facilitate the
driving process, they can also give rise to lots of hidden
dangers [2]. As the most wide-spread in-vehicle data bus and
the cornerstone of vehicle applications, CAN (Controller Area
Network) bus is vulnerable due to its lack of encryption,
authentication, access control, or even message veriﬁcation
mechanism. A variety of attack methods against CAN bus
have emerged, whether to study its defects or perform other
malicious attempts [3] [4]. These attacks have shown serious
adverse impacts on vehicle safety, as well as posed great
threats to the lives and properties of passengers. Therefore, the
security of CAN bus appeared to be particularly important. The
intrusion detection and attacker identiﬁcation of CAN-based
in-vehicle network is also worthy to be investigated.
There have been a number of pioneer research works toward
CAN bus prevention and attack detection. Many researchers
modiﬁed the CAN protocol to achieve better security, however,
this may lead to unnecessary computing load on the bus.
J. Ning, J. Wang are with the State Key Laboratory of Integrated Services
Networks, School of Cyber Engineering, Xidian University, Xi’an 710071,
China.
J. Liu is with the School of Cybersecurity, Northwestern Polytechni-
cal University, Xian 710072, China. (Corresponding author e-mail: liujiaji-
PI:EMAIL).
N. Kato is with the Graduate School of
Information Sciences, To-
hoku University, Aobayama 6-3-09, Sendai, 980-8579, Japan (e-mail: ka-
PI:EMAIL).
In order to avoid the additional computing burdens, physical
characteristics of CAN bus have attracted lots of attention.
Through ACK (ACKnowledge character) learning, whether
the measured voltage signal was from a real sender can be
recognized [5]. Groza et al. and Song et al. also proposed
clock-based anomaly detection system for intrusion detection,
nevertheless, the abnormal ECUs cannot be located [6] [7].
To solve this problem, Kneib et al. designed an intrusion
detection system named Scission to identify the legitimate
ECU using ﬁngerprint extraction of CAN frame and achieved
relatively high identiﬁcation rate [8]. This system still exists
false detection probability that cannot be neglected.
To meet the essential need for attacker identiﬁcation in
CAN-based in-vehicle networks and solve the problems that
exist in the above methods, we propose an intrusion detection
method carried out on real vehicles to realize accurate sender
identiﬁcation. Due to the hardware characteristics of the ECU
circuit, the data packets to be transmitted can generate unique
voltage waveform on CAN bus. Using this physical property,
we adopt the LOF algorithm to distinguish voltage waveforms
and detect the external malicious intrusion device. When ECUs
occur failure or anomaly, external intrusion detection can still
be achieved. Moreover, three attack models are constructed
to verify the effectiveness of our method. Compared with the
existing related works, the proposed method does not need to
modify the CAN protocol or impose additional computational
burden on the CAN bus, and can greatly reduce the false
detection rate as well as improve the detection rate. To the
best of our knowledge, we are the ﬁrst to implement bus-off
intrusion detection on real vehicles.
The remainder of this paper is organized as follows: We
present an overview of the CAN protocol and threat models
in Section II. Our attack detection scheme based on LOF is
proposed in Section III. Then, we discuss the experimental
process and results in Section IV and conclude the whole paper
in Section V.
II. CONTROLLER AREA NETWORK AND THREAT MODELS
A. CAN Protocol and Voltage Characteristics
CAN bus is currently the most commonly used broadcast in-
vehicle data bus, which connects ECUs as nodes for exchang-
ing messages to control the operation of vehicle modules. CAN
adopts two lines i.e., CAN-H (CAN-High) and CAN-L (CAN-
Low) that own the opposite potentials to prevent external
electromagnetic interference and radiation. The voltage of
CAN-H ranges from 2.5V to 3.5V, while CAN-L from 1.5V
1089-7798 (c) 2019 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information.
This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/LCOMM.2019.2937097, IEEE
Communications Letters
2
Fig. 1: CAN data frame.
to 2.5V. In our experiments, we use the differential voltage of
these two lines to avoid noise error.
Frames transmitted on CAN bus can be divided into four
types: data frame, remote frame, error frame, and overload
frame. Thereinto, the remote frame is sent to request the
data from speciﬁc ECU, the error frame is used to inform
other nodes of the occurred error, and the overload frame is
used to inform that the source node cannot receive data. The
data frame is mainly composed of ID (IDentity) ﬁeld which
represents the meaning and priority of the frame, DLC (Data
Length Code) ﬁeld includes the maximum data length, data
content and some check bits. In addition, the CRC (Cyclic
Redundancy Check) ﬁeld performs data error detection, and
the ACK ﬁeld is used to conﬁrm the correct data transmission.
Fig.1 is an illustration of the data frame format.
B. Spooﬁng Attack
CAN bus is vulnerable to attack due to its lack of encryp-
tion, authentication, access control and message veriﬁcation
scheme. To spoof and manipulate the vehicle, attackers can
ﬁrstly analyze CAN messages, then master the instructions
contained in CAN frames, and ﬁnally send messages repeat-
edly through ﬂood attacks [4]. In addition, they can easily
connect to CAN bus through the interface of the on-board
infotainment systems. Remote cellular communication devices
also have vulnerabilities through which CAN bus can be
accessed [9]. Therefore, when the in-vehicle module is under
attack, we need to quickly locate the abnormal ECUs. To
resist malicious attacks, researchers have found that the voltage
waveform on CAN bus is inherently difﬁcult for adversaries
to fake. Due to the hardware difference of various modules,
the messages sent by different ECUs have their unique voltage
waveforms. With this feature, we can detect external senders.
C. Bus-off Attack
Bus-off attack is a recently discovered new DoS attack as
shown in Fig.2. It uses the error handling scheme of in-vehicle
network to periodically inject attack messages, deceives nor-
mal ECU into thinking it has a problem, and even forces
whole network to shut down [10]. Simultaneous transmission
of different bits i.e., dominant bit (0) and recessive bit (1) in
ID ﬁeld can be seen as the arbitration process to determine
the priority of CAN frames. When two kinds of bits are
transferred at
the same time in ﬁelds other than the ID
ﬁeld, the fault-conﬁnement mechanism of CAN protocol will
consider that there is an error and increase the Transmit Error
Counter (TEC) accordingly. If continuous error causes the
TEC to exceed 255, the vehicle can automatically enter the
bus-off state. The consequence of bus-off attack is extremely
serious, it will make the corresponding ECU and even the
Fig. 2: Illustration of bus-off attack.
whole in-vehicle network shut down and no longer accept or
send data [10].
III. LOF-BASED INTRUSION DETECTION SCHEME
In this section, we introduce our vehicle intrusion detection
method. After feature extraction and dimension reduction,
LOF algorithm is adopted to realize the vehicle intrusion
detection.
A. Data Preprocessing and Feature Extraction
We use the physical characteristics of CAN bus to achieve
ECU identiﬁcation and intrusion detection. Firstly, we take the
signals whose differential voltages are continuously greater
than 0.1V as our samples. Secondly, in order to accurately
describe the sample features and distinguish voltages of differ-
ent ECUs, we divide each waveform into three parts, namely
rising edge, falling edge and stationary segment, in which the
rising and falling edges contain more feature information as
can be seen in Fig.3. Finally, the three-stage FFT (Fast Fourier
Transformation) can be obtained separately, and the parameters
of the response curve can also be obtained in the time domain
and the frequency domain.
B. Dimension Reduction
Dimension reduction can remove redundant features, retain
representative features, and reduce computational complexity.
We calculate the pearson correlation coefﬁcients for each
feature and rank them by relevance. Then, we determine
the dimensions of the reserved features. Note that more
dimensions do not mean better results because redundant
data may cause unnecessary errors. Through practical testing
and computational complexity considerations, we use eight
features for subsequent experiments.
where Xi(cid:0)X
and standard deviations for the Xi samples, respectively.
, X and (cid:27)X are standard scores, mean values
(cid:27)X
(1)
The correlation coefﬁcient r is expressed as:
Yi (cid:0) Y
(cid:27)Y
Xi (cid:0) X
(cid:27)X