1
4. Start  positioning  system  to  get  the  current  location 
information L. 
5. The User sends L, Tags, uid to the Server. 
4.4 Location tags comparation 
When the Server receives L, Tags, uid sent by the User, 
the verifying process is as follows: 
1. Read the timestamp from database to check whether 
the User’s request is out of time. If the request is out 
of time, abandon the request. 
2. Use the User’s uid, timestamp and nonce to reproduce 
signature S. 
3. Using the position L submitted by the user to search 
the WIFI and base station information centering in the 
position  L  within  a  range  radius  R  from  database, 
which stores the locations and identities of APs and 
base stations collected by the service provider. Then 
(cid:96)nf
we will get the signal set 
(cid:3)
(cid:96)m
w
f
(cid:94)
ww
1
2
(cid:94)
f
1(cid:32)
,...,
...,
).(cid:3) (cid:3)
(cid:32)
f
f
f
f
,
,
,
,
(
2
3
4
i
4. Using  the  every  signal  frame 
kw   in  the  signal  set 
  and  the  user’s  signature  S  to  join  together  to 
nf
generate a record
T
k
(cid:32)
(cid:94)
w
k
|
BSSID
(cid:96)S
.
5. Using  the  hash  function  set 
setH   to  compute  the 
kT   in the Tags. If the value of Tags 
position loc of 
kT   is 
in the position loc equals "1", it indicates that 
in the Tags and the user is in the signal coverage of
kw ,  sn  (proximity  of  tags  user  submitted  and 
kT
database data) plus 1; otherwise it indicates that 
is  not  in  the  Tags  and  the  user  is  not  in  the  signal 
coverage of w, sn does not change. 
kT
(
)
isExsit
(cid:3) (cid:3) (4)(cid:3)
sn
(cid:32)
m
(cid:166)
k
(cid:32)
0
kT   is in 
isExist ( ) is a function checking whether 
kT   is in the Tags, otherwise 
the Tags, it return 1 if 
(cid:119)(cid:33)sn
( (cid:119) is the minimum proximity 
it return 0. If 
number),  we  regard  as  the  user's  location  is  true, 
otherwise 
the  user 
submitted is false. 
information 
location 
the 
5    Systems Analysis 
5.1 Location Tags Generation 
With the development of technology, the hotspots of WIFI 
(AP, or wireless router) become more and more common. 
We  can  receive  at  least  three  AP  signal  in  almost  every 
corner  of  urban  areas.  As  long  as  the  AP  is  live,  it  will 
broadcast signals to the surroundings whatever the signal 
is encrypted. Hence, if the user’s device supports WIFI, it 
can  scan  the  nearby  signals  information.  Because  of  the 
wireless signal contains the only global ID of the hot spots, 
and the AP rarely changes position, so the AP can provide 
proof for the user's current location information. The base 
station also has a unique ID and fixed position, it can be 
used  as  proof  of  location  information  as  the  same. 
Therefore taking the wireless signal as the authentication 
of location is feasible. And, with the popularity of smart 
phones,  the  smart  phones  with  WIFI  function  are  very 
common. So it is feasible for users to collect the wireless 
signals to generate location tags. 
the 
(GSM,  LTE,  etc.).  Verifying 
For the social network service provider, the information of 
base station is the public information which can be easily 
gotten from local telecom department, so it is feasible to 
verify the authenticity of the location based on base station 
signal 
location 
authenticity  of  the  wireless  network  signals  such  as  the 
WIFI is relatively complex, there are two ways to achieve 
the goal: 1. the social network services provider can collect 
the  WIFI  signals  around  and  save  them  to  the  database. 
Take the Skyhook for example, it cooperate with the taxi 
company,  providing  GPS  navigation  devices  which  has 
WIFI acquisition module freely. When the taxies run the 
every  corner  of  the  city,  they  collect  most  WIFI 
information of the city for Sky-hook. But this approach has 
higher  complexity,  and  the  investment  is  too  large.  2. 
(cid:3)
through the third party service providers. At present, the 
location  technology  based  on  WIFI  begins  to  raise,  the 
map  service  providers  such  as:  Baidu,  Google,  GaoDe 
provide position parsing based on WIFI. User can get the 
current location information by providing the WIFI BSSID 
and  signal  strength  to  the  map  service  providers.  It  is 
feasible for the social network service provider to get the 
WIFI  information  of  the  location  through  the  reverse 
parsing  geographic  information  database  of  the  map 
service providers (such as Baidu). 
5.2 Security Analysis 
Prevention  of  forging  and  tampering  attack.  The  Bloom 
filter actually is a m-bit binary array generated by the hash 
functions, it has the irreversible characteristics of the hash 
table.  Generating  a  Bloom  filter  array  must  have 
parameters  such  as  the  collected  signals  and  the  Hash 
functions.  Although  a  malicious  user  can  obtain  the 
wireless signals easily, he has a great difficulty in getting 
all  the  hash  functions.  So  it  is  very  difficult  for  him  to 
forge or tamper the location tags. 
Prevention  of  replay  attack  and  collusion  attack.  Some 
malicious user may capture location tag information and 
then replay it to social network server later or send it to 
other  users  to  help  them  realizing  location  cheating.  To 
prevent replay attacks and collusion attack, we ask users 
to  send  location  request  to  social  network  server  before 
submitting location information. When the server receives 
the  request,  it  will  verify  the  user's  identity  first,  if  the 
verification  is  correct,  the  social  network  server  will 
generate a signature with the timestamp, the user identity 
and the nonce, and then send the signature to the user. 
When the user submits the location tags to the server, the 
server will check the timestamp firstly, if the timestamp 
lost  freshness,  the  server  will  consider  the  location 
information  the  user  submitted  invalid  and  drop  it. 
Through  this  method,  our  scheme  can  prevent  replay 
attacks effectively. In additional, the server will check the 
user's  identity  in signature and  the submitted  identity, if 
they are not the same, the server will consider the location 
information the user submitted invalid and drop it. So this 
method can prevent collusion attack effectively. 
6    Experiments And Evaluation 
In our experiment, we just use 802.11g wireless signals as 
an example to test our scheme. We use two Legend K860 
mobile phones as user terminal device and a HP 6005 PC 
as social network service server.   
In the experiment, we set the number of signals collected 
by the mobile terminal 10, the length of the Bloom filter 
size 128, the number of Bloom filter hash functions 8. We 
first  collect  the  APs’  location  and  BSSID  in  Shanghai 
University  and  store  it  in  the  data-base.  Then  we  walk 
around the campus with mobile phones and test whether 
our scheme is effective or not. At each place we measure 
two time, one is the total time required to send a location 
(cid:3)
request and location information respectively to the server, 
which does not include the time of generating location tags. 
The other is similar to the former total time but includes 
the time of generating location tags. And we also record 
the time cost by generating location tags. We got the result 
in “Table 1": 
search
radius 
(meter)
R = 200
R = 500
(accuracy 5~50 
(accuracy 10~500 
GPS 
meter) 
20 
20 
Location type
WIFI 
meter) 
20 
20 
Base station 
(accuracy 
200~1000 meter)
0 
11 
From  the  above  experimental  results,  we  can  see  our 
scheme have  little  effect on user’s  experience. The  time 
required to generate location tags is very short, only 7.31 
milliseconds.  The  difference  between  a  re-quest  time 
including the time cost of generating location tags and that 
excluding the time cost of generating location tags is little. 
Most of time in a request is cost by getting the latitude and 
longitude of current location, and the rest time is cost by 
communication. 
Table 1. The total time required to send a location request 
and location information respectively to the server. 
The total time 
required to send a 
location request 
and location 
information 
respectively to the 
server   
(including the 
time of generating 
location tags) 
The time of 
generating 
Location 
Tags 
The total time   
required to send a 
location request 
and location 
information 
respectively to the 
server   
(excluding the 
time of generating 
location tags) 
7    Conclusion 
In this paper, we propose a location verification scheme 
based  on  proximity  test  of  location  tags.  We  aim  at 
proposing a verification scheme to verify the authenticity 
of the location information users submitted. By collecting 
the signal information around the user current location and 
storing by bloom filter, we generate location tags and use 
proximity  test  to  verify  the  authenticity  of  the  user's 
location.  Though  security  and  performance  analysis,  we 
show that the scheme is safe and feasible. At present, we 
just use 802.11g signals as experimental subjects. In the 
future, we will use base station signals as an extension in 
our experiment to improve the scalability and efficiency. 
8    Acknowledgments 
This  work  is  supported  by  Innovation  Program  of 
Shanghai  Municipal  Education  Commission  under  grant 
No:13YZ013. 
Measuring 
items 
The time 
cost
(cid:708)ms(cid:709)
1475.67 
7.31 
1437.33 
References 
The  main  factors  affecting  experimental  result  are  the 
accuracy of location type, the searching radius R and the 
minimum  threshold  of  the  similarity (cid:119) .  Considering  the 
number of AP signals collected in one place in Shanghai 
University, we set  (cid:119)   to 3. In the experiment we use three 
locating methods with different accuracy. (the accuracy of 
GPS locating is 5~50 meter; the accuracy of WIFI locating 
is 10~500 meter and the accuracy of Base station locating 
is  200~1000  meter)  and  three  different  radius  R  (100 
meters,  200  meters,  500  meters).We  carried  out  20 
experiments  with  different  location  methods  and  radius 
respectively, 
location 
authentication are as follows: 
the  number  of 
successful 
As shown in Table 2, if a user’s current position accuracy 
of latitude and longitude is low, the result is unsatisfactory, 
but with the user’s current position accuracy improving, 
the result gets better. And with expending the search radius 
R, the result gets better. When using locating methods with 
high  positioning  accuracy,  and  within  a  medium  radius, 
our scheme has a good performance. 
Table 2. The number of successful location authentication 
search
radius 
(meter)
GPS 
meter) 
R = 100 
12 
Location type
WIFI 
meter) 
14 
Base station 
(accuracy 
200~1000 meter)
0 
(accuracy 5~50 
(accuracy 10~500 
[1]
[2]
[3]
[4]
[5]
[6]
Wenbo He, Xue Liu, Nai Ren l, "(cid:3)Location 
Cheating:    A Security Challenge to Location-
based Social Network Services," 31st 
International Conference on Distributed 
Computing System, 20-24,pp: 740 - 749 
Nashad A. Safa, Saikat Sarkar, Reihaneh Safavi-
Naini, and Majid Ghaderi. “Secure Localization 
Using Dynamic Verifiers”. 16th European 
Symposium on Research in Computer Security, 
pp: 1-20.   
Petros Maniatis, Devdatta Akhawe, Kevin Fall, 
Elaine Shi, Stephen McCamant and Dawn Song.   
(2011): ‘Do You Know Where Your Data Are? 
Secure Data Capsules for Deployable Data 
Protection’ HotOS'13 Proceedings of the 13th 
USENIX conference on Hot topics in operating 
systems, pp:22-22 
Yao Zheng, Ming Li, Wenjing Lou and Y.Thomas 
Hou. (2012): ‘SHARP: Private Proximity Test and 
Secure Handshake with Cheat-Proof Location 
Tags’. 17th European Symposium on Research in 
Computer Security, pp: 361-378. 
Stefan Saroiu, Alec Wolman. (2009) ‘Enabling 
New Mobile Applacations with Location Proofs’. 
HotMobile. 
Ragib Hasan, Randal Burns. (2011): ‘Where Have 
You Been? Secure Location Provenance for 
Mobile Devices’. Ragib Hasan, Randal 
(cid:3)
[11]
[12]
Burns arXiv. pp.1107.1821. 
Timothy Vidas, Daniel Votipka, Nicolas Christin. 
All Your Droid Are Belong To Us: A Survey of 
Current Android Attacks [C] USENIX 
Association Berkeley, CA, USA ©2011 
Jack Brassil, Ravi Netravali, Stuart Haber. 
Authenticating a Mobile Device’s Location Using 
Voice Signatures [C]. 2012 IEEE 8th International 
Conference on Wireless and Mobile Computing, 
Networking and Communications (WiMob), 2012 
L.-Y. Wei, W. -C. Peng, and W. -C. Lee, 
Exploring Pattern-Aware Travel Routes for 
Trajectory Search, ACM Transactions on 
Intelligent Systems and Technology 
K. -P. Chang, L. -Y. We i, M. -Y. Yeh and W. -C. 
[7]
[8]
[9]
[10]
(cid:3)
Peng. (2011): ‘Discovering Personalized Routes 
from Trajectories, Proceedings of the third 
International Workshop on Location-based Social 
Networks (in conjection with ACM   
SIGSPATIAL GIS 2011), Chicago, Illinois, USA, 
Nov. 1-4,   
Narayanan, A., Thiagarajan, N., Lakhani, M., 
Hamburg, M., Boneh, D. (2011): ‘Location 
privacy via private proximity testing’. In: Proc. 
18th Annual Network & Distributed System 
Security Symposium   
Zhu, Z., Cao, G. (2011): Applaus: A privacy-
preserving location proof updating system for 
location-based services. In: Proc. 30th IEEE 
International Conference on Computer 
Communications (2011)