**译者：知道创宇404实验室翻译组  
原文链接：**
“瞒天过海”策略来源于《三十六计》第一章，这是中国著名的战术和技巧集，适用于政治、战争和人民生活。它的意思就是“隐藏在显而易见的地方”或者“掩盖你真正的目标”。
安卓银行木马黑客已经牢记这一策略，并且多年来一直非常习惯了新的谷歌应用商店对他们的运营的限制。这些限制包括对某些(危险的)应用程序权限的使用设置限制，这些权限常常用于分发或自动化恶意软件策略。
在这个博客中，我们将讨论最近通过 Google Play (MITRE T1475)传播 Android
银行木马所使用的技术，这些技术给目标银行造成了巨大的财务损失。我们还将讨论该技术造成的后果，即银行木马程序收集联系人和按键而导致的严重数据泄露。
## 攻击者使用的战术
从自动化(沙盒)和机器学习的角度来看，这些 Google Play 分发活动很难被发现，因为dropper应用程序的恶意足迹很小。它的内存占用很小是由
Google Play 强制执行的许可限制造成的。
一个很好的例子是2021年11月13日谷歌引入的修改，它限制了无障碍服务的使用，因为在早期，这个服务常常被自动化和安装应用程序的攻击利用，但并没有经过用户的同意。
谷歌的这种监管方式就迫使攻击者另寻他法，大幅度减少dropper 应用程序的占用空间。除了恶意软件代码进一步改进，Google Play
的分发活动也比以前的攻击更加精细。例如，通过在 Google Play 中引入精心策划的小型恶意代码更新，以及使用dropper
c2后端来完全匹配dropper应用程序的主题(例如，一个针对健身的应用程序Fitness 的正常运行的网站)。
为了让木马更难被发现，这些dropper应用程序背后的攻击者只是手动激活被感染设备上的银行木马安装，以控制他们在某个特定地区的受害者数量。这使得安全组织的自动检测策略效用大大降低。
VirusTotal 并没有展示反病毒产品检测的演变，但是几乎所有的活动在 VirusTotal 上都有或者曾有0/62 FUD
评分，这证实了用最小的内存占用检测dropper应用程序的难度。
## 组织和数据
在下面的段落中，我们概述了最近通过 Google Play 分发的每个团伙的作案手法(MO)。这些组织都有自己的银行应用程序目标列表（见附录）。
## Anatsa 攻击活动
在不同恶意软件家族分布技术的研究过程中，我们的分析师发现了大量位于 Google Play 中的dropper应用程序，专门用来分布银行木马
Anatsa。ThreatFabric在2021年1月发现了 Anasta。
Anatsa 是一个相当高级的 Android 银行木马，具有 RAT 和半 ats
功能。它还可以执行经典的覆盖攻击，以窃取凭证、可访问性日志(捕获用户屏幕上显示的所有内容)和键盘记录。此前，ThreatFabric曾报道过
Anatsa与Cabassous一起在欧洲各地的短信诈骗活动的[案例](https://www.threatfabric.com/blogs/smishing-campaign-in-nl-spreading-cabassous-and-anatsa.html)。我们的最新调查结果显示，Anatsa现在使用的是
Google Play dropper应用程序。
**成千上万的受害者**
2021年6月，我们发现了第一个伪装成扫描文档应用程序的dropper。自2021年6月以来，ThreatFabric 分析师总共能够识别出6个发布在
Google Play 上的 Anatsa 软件漏洞。
这些应用包括 QR 码扫描器、 PDF 扫描器和加密货币应用程序。有一个dropper应用程序被安装了超过 **5万**
次，所有dropper的安装总数超过 **10万** 次。
![QR
Scanner](https://images.seebug.org/content/images/2021/12/07/1638844907000-5bxtig.png-w331s)
感染 Anatsa 的过程是这样的: 从 Google Play
开始安装时，用户被迫更新应用程序以便继续使用该应用程序。此时，Anatsa有效载荷从C2服务器下载，并安装在毫无戒备的受害者的设备上。
背后的攻击者努力让他们的应用程序看起来合法且有用。它们的评论区有大量的正面评价，安装的次数和评论可能会诱使 Android
用户安装这个应用程序。此外，这些应用程序确实拥有所声称的功能，安装后它们确实正常运行，这进一步说服受害者它们的合法性。
尽管安装了大量的设备，但并不是每一个安装了这些dropper的设备都会接收到
Anatsa，因为攻击者只针对他们感兴趣的地区用户。我们将在下一节讨论这个和其他技术细节。
**技术细节**
所有 Anatsa dropper 在代码级别上看起来很相似。在应用程序启动时，会启动一个服务来检查是否安装了“更新”。dropper向
c2发送关于设备的信息，包括设备 ID、设备名、地区、国家、 Android SDK 版本。
![C2
communication](https://images.seebug.org/content/images/2021/12/07/1638844909000-6amnev.png-w331s)
正如前面提到的，并不是每个设备都会收到“更新”。此时，C2后端根据设备信息决定是否提供 Anatsa
有效载荷，同时，根据C2的响应，dropper将决定是否下载 Anatsa。
这种方法使攻击者能够针对特定区域的设备，还可以轻松地将重点转移到另一个区域。这种行为与Anatsa
从一个地区转移到另一个地区，不断更新其目标金融机构名单的行为是一致的。此外，过滤允许网络犯罪分子在 Google Play
上发布应用程序时，阻止dropper在评估过程中下载“更新”。
我们的分析师已经确认， Anatsa dropper最初在 Google Play
上发布的第一个版本中没有恶意功能，但是在后来的版本中修改了他们的行为，增加了植入功能，并且需要更多的权限。
当所有条件都满足并且有效负载准备就绪时，系统将提示用户下载并安装它。
![Update
process](https://images.seebug.org/content/images/2021/12/07/1638844914000-9hnmho.png-w331s)
成功下载“更新”后，用户将被要求安装来自未知来源的应用程序的权限。用户确信更新是应用程序正常工作所必需的，然后授予许可。安装完成后，Anatsa
在设备上运行，并立即请求受害者授予可访问性服务特权。
启用可访问性服务后，Anatsa可以完全控制设备，并可以代表受害者执行操作。与此同时，dropper应用程序也作为合法应用程序运行和运行，但受害者可能仍然毫无戒心。
## Hydra 和 Ermac 活动
**Brunhilda : Valkyrie 的回归**
ThreatFabric识别了Brunhilda 组织团伙植入的多个恶意软件案例，与之前的活动一致，它由木马程序化的应用程序组成。
在第一个案例中，我们发现Brunhilda伪装成二维码编码创建应用程序，Brunhilda在已有的软件系列，比如 [Hydra
](https://www.threatfabric.com/blogs/bianlian_from_rags_to_riches_the_malware_dropper_that_had_a_dream.html)以及新奇的软件系列，比如
[Ermac ](https://www.threatfabric.com/blogs/ermac-another-cerberus-reborn.html)中置入样本。
![Brunhilda  dropping Hydra and Ermac on
GP](https://images.seebug.org/content/images/2021/12/07/1638844917000-11fstqq.png-w331s)
这次Brunhilda
攻击中放置的应用程序与我们在2021年观察到的旧版本的应用程序在功能上没有太大的不同。正如它在之前的迭代中所做的那样，Brunhilda 使用 gRPC
协议向其 C2发送注册请求。成功注册后，在传递更多关于设备的详细信息之后，C2指示dropper下载并安装有效载荷包。
![Brunhilda
installation](https://images.seebug.org/content/images/2021/12/07/1638844919000-12gaogd.png-w331s)
在过去的几个月里，两个木马都非常活跃，甚至冒险进入以前没有开发过的市场，比如美国。这种新的恶意软件浪潮始于2021年8月，其中也包括像 Gustuff 和
Anatsa 这样的恶意软件。
![US
campaigns](https://images.seebug.org/content/images/2021/12/07/1638844920000-13nozjt.png-w331s)
## Alien 攻击活动
正如前面提到的，ThreatFabric发现，Brunhilda提供不同的恶意软件家族。一些样本有超过5万次的安装，并且置入了安卓木马[Alien
](https://www.threatfabric.com/blogs/alien_the_story_of_cerberus_demise.html)。
![Brunhilda dropping Alien on
GP](https://images.seebug.org/content/images/2021/12/07/1638844922000-14jmcry.png-w331s)
在这种情况下，正如[Vultur ](https://www.threatfabric.com/blogs/vultur-v-for-vnc.html)的部署一样，这些应用软件在从商店下架之前达到了数千次下载。这些样本取得了非常显著的效果，从5前多次到5万多次的下载量足以见得。考虑到这个数字，可以肯定地说，这个dropper家族可能在运行期间感染了成千上万的受害者。
**Gymdrop**
2021年11月，ThreatFabric分析师在 Google Play 中发现了另一个dropper。它伪装成一个健身的应用程序，有10.000次安装。
这个dropper，我们称之为“
Gymdrop”，背后的黑客试图说服受害者和检测系统他们的应用程序是合法的。这个应用程序网站的设计初看起来是正常的，然而，它只是一个健身网站的模板，没有任何有用的信息，甚至在它的页面上仍然包含着“
Lorem Ipsum”占位符文本。
![Developer
website](https://images.seebug.org/content/images/2021/12/07/1638844926000-16glouk.png-w331s)
开发者的网站也是 Gymdrop 的
C2。就像之前观察到的一样，这个dropper试图说服受害者安装一个虚假的更新。然而，在这种情况下，它是以一种更具创造性的方式完成的:
有效载荷是按照应用程序的要求，作为一个新的锻炼练习资源。当用户单击“ OK”后，dropper将请求所需的权限。
![Gymdrop update