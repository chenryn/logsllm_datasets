**译者：知道创宇404实验室翻译组  
原文链接：**

“瞒天过海”策略源自《三十六计》的第一章，这是一部著名的中国战术和技巧集，广泛应用于政治、军事和日常生活。该策略的核心思想是“隐藏在显而易见的地方”或“掩盖真实意图”。

安卓银行木马的黑客们已经将这一策略铭记于心，并且多年来一直在适应谷歌应用商店对他们的限制。这些限制包括对某些（危险）应用程序权限的使用加以限制，这些权限常被用于分发或自动化恶意软件。

在这篇文章中，我们将探讨最近通过Google Play（MITRE T1475）传播Android银行木马所采用的技术，这些技术给目标银行带来了巨大的财务损失。我们还将讨论由此引发的数据泄露问题，特别是由于银行木马程序收集联系人信息和按键记录而导致的严重数据泄露。

## 攻击者使用的战术

从自动化（沙盒）和机器学习的角度来看，这些通过Google Play进行的分发活动很难被发现，因为dropper应用程序的恶意足迹非常小。其内存占用量较小的原因在于Google Play强制执行的许可限制。

例如，2021年11月13日，谷歌引入了一项修改，限制了无障碍服务的使用。此前，这个服务常常被攻击者利用来自动安装应用程序，但并未获得用户同意。这种监管迫使攻击者寻找其他方法，大幅减少dropper应用程序的内存占用。除了进一步改进恶意代码外，Google Play上的分发活动也变得更加精细。例如，通过在Google Play上发布精心策划的小型恶意代码更新，并使用与dropper应用程序主题相匹配的C2后端（如一个针对健身应用Fitness的正常运行网站）。

为了使木马更难被发现，攻击者仅手动激活受感染设备上的银行木马安装，以控制特定地区的受害者数量。这大大降低了安全组织的自动检测策略的有效性。VirusTotal并未展示反病毒产品检测能力的演变，但几乎所有活动在VirusTotal上的评分为0/62 FUD，这证实了用最小内存占用检测dropper应用程序的难度。

## 组织和数据

在接下来的部分中，我们将概述近期通过Google Play分发的每个团伙的作案手法（MO）。这些组织都有自己的目标银行应用程序列表（见附录）。

## Anatsa 攻击活动

在研究不同恶意软件家族的分发技术过程中，我们的分析师发现了大量位于Google Play中的dropper应用程序，专门用于分发Anatsa银行木马。ThreatFabric于2021年1月首次发现了Anatsa。

Anatsa是一款较为高级的Android银行木马，具备RAT和半ATS功能。它还可以执行经典的覆盖攻击，窃取凭证、可访问性日志（捕获用户屏幕上显示的所有内容）和键盘记录。此前，ThreatFabric曾报道过Anatsa与Cabassous一起在欧洲各地参与短信诈骗活动。最新的调查结果显示，Anatsa现在使用Google Play dropper应用程序。

### 成千上万的受害者

2021年6月，我们发现了第一个伪装成扫描文档应用程序的dropper。自2021年6月以来，ThreatFabric分析师总共识别出6个发布在Google Play上的Anatsa漏洞。这些应用包括QR码扫描器、PDF扫描器和加密货币应用程序。其中一个dropper应用程序被安装超过5万次，所有dropper的总安装次数超过10万次。

感染Anatsa的过程如下：从Google Play开始安装时，用户被迫更新应用程序以继续使用。此时，Anatsa有效载荷从C2服务器下载并安装在毫无戒备的受害者的设备上。

背后的攻击者努力使他们的应用程序看起来合法且有用。评论区有大量的正面评价，安装次数和评论可能会诱使Android用户安装这些应用程序。此外，这些应用程序确实具有其所声称的功能，安装后确实能正常运行，这进一步增强了其合法性。

尽管安装了大量的设备，但并不是每个安装了这些dropper的设备都会接收到Anatsa，因为攻击者只针对他们感兴趣的地区用户。我们将在下一节讨论这一点以及其他技术细节。

### 技术细节

所有Anatsa dropper在代码级别上看起来很相似。应用程序启动时，会启动一个服务来检查是否需要安装“更新”。dropper向C2发送设备信息，包括设备ID、设备名称、地区、国家和Android SDK版本。

正如前面提到的，并不是每个设备都会收到“更新”。此时，C2后端根据设备信息决定是否提供Anatsa有效载荷。根据C2的响应，dropper将决定是否下载Anatsa。

这种方法使攻击者能够针对特定区域的设备，并可以轻松地将重点转移到另一个区域。这种行为与Anatsa从一个地区转移到另一个地区，不断更新其目标金融机构名单的行为一致。此外，过滤允许网络犯罪分子在Google Play上发布应用程序时，阻止dropper在评估过程中下载“更新”。

我们的分析师已经确认，Anatsa dropper最初在Google Play上发布的第一个版本中没有恶意功能，但在后来的版本中修改了行为，增加了植入功能，并需要更多的权限。

当所有条件都满足并且有效载荷准备就绪时，系统将提示用户下载并安装它。成功下载“更新”后，用户将被要求授予来自未知来源的应用程序的安装权限。用户确信更新是应用程序正常工作所必需的，然后授予许可。安装完成后，Anatsa在设备上运行，并立即请求受害者授予可访问性服务特权。

启用可访问性服务后，Anatsa可以完全控制设备，并代表受害者执行操作。与此同时，dropper应用程序仍然作为合法应用程序运行，但受害者可能仍然毫无戒心。

## Hydra 和 Ermac 活动

### Brunhilda: Valkyrie 的回归

ThreatFabric识别了多个由Brunhilda组织植入的恶意软件案例，与之前的活动一致，这些案例由木马化的应用程序组成。

在第一个案例中，我们发现Brunhilda伪装成二维码编码创建应用程序，并在已有的软件系列（如Hydra）以及新的软件系列（如Ermac）中置入样本。

这次Brunhilda攻击中放置的应用程序与我们在2021年观察到的旧版本在功能上没有太大区别。如同之前的迭代，Brunhilda使用gRPC协议向其C2发送注册请求。成功注册后，在传递更多关于设备的详细信息之后，C2指示dropper下载并安装有效载荷包。

在过去几个月里，这两个木马都非常活跃，甚至冒险进入以前未曾开发过的市场，如美国。这种新的恶意软件浪潮始于2021年8月，其中包括Gustuff和Anatsa等恶意软件。

## Alien 攻击活动

正如前面提到的，ThreatFabric发现Brunhilda提供了不同的恶意软件家族。一些样本的安装次数超过5万，并且置入了Android木马Alien。

在这种情况下，就像Vultur的部署一样，这些应用程序在从商店下架之前达到了数千次下载。这些样本取得了显著的效果，从几千次到5万多次的下载量足以证明。考虑到这个数字，可以肯定地说，这个dropper家族在运行期间可能感染了成千上万的受害者。

### Gymdrop

2021年11月，ThreatFabric分析师在Google Play中发现了另一个dropper。它伪装成一个健身应用程序，有1万次安装。

这个被称为“Gymdrop”的dropper背后的黑客试图说服受害者和检测系统他们的应用程序是合法的。该应用程序的网站设计初看似乎是正常的，但实际上只是一个健身网站的模板，没有任何有用的信息，甚至在其页面上仍然包含“Lorem Ipsum”占位符文本。

开发者的网站也是Gymdrop的C2。与之前观察到的一样，这个dropper试图说服受害者安装一个虚假的更新。然而，在这种情况下，它是以一种更具创造性的方式完成的：有效载荷作为一个新的锻炼练习资源被要求下载。当用户点击“OK”后，dropper将请求所需的权限。