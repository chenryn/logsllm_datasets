Switches Get Stitches: Episode 3 
Then there were three of them. 
Who are we? 
Last episode on switches get stitches… 
Scalance X-Family   00000960 
C0A80065 
00001A21 
C0A80065 
000049A6 
C0A80065 
00005F31 
C0A80065   
OpenGear CSRF 
Robert 
Ideal Layout of a Generic ICS Network 
Typical Layout 
Challenges in ICS environments 
• Legacy equipment 
• Who owns the problem? 
• Unmanaged infrastructure 
• Who has time? 
• Vendor support 
• Regulations 
NSM in an ICS 
Pre-HAVEX 
Post-HAVEX 
•
NSM and Asset Identification is all about: 
–
Knowing your network topologies 
–
Monitoring for changes 
–
Building off the basics 
•
It does have challenges: 
–
Isn’t a fix all solution 
–
Requires people and processes 
–
Toughest part is buy-in and prep 
•
It does bring value: 
–
Identify threats 
–
Identify misconfigured/failing devices 
–
Better situational awareness 
–
Fits into larger defense strategy 
•
Why it excels in ICS: 
–
Static environments 
–
Less users than an Enterprise 
–
Less assets than IT networks 
–
No patches? At least monitor! 
Safely Capturing Data 
• Logging enabled and centralized 
• Network and Memory data are king 
• Test/lab environment first 
– Taps/hubs that fail open 
– Install on scheduled down times 
• Work with vendors to have managed network 
infrastructure 
• Be mindful of network bandwidth usage 
• At least sample environment manually  
– Mirrored port, hubs, taps, etc. 
Easy to Use Starter Kit 
• 101 matters 
– It’s not sexy but it works 
– Adversaries are “efficient” 
and you must kill noise 
• SecurityOnion 
• Tcpdump to capture 
• Flowbat/SiLK to analyse 
flows 
• Xplico for FTP 
• NetworkMiner/Foremost 
– Pull out exe’s, project 
files, etc.  
• Wireshark to analyse 
– Endpoints 
– I/O Data 
– Unusual function codes 
Wireshark I/O Data 
Pre-HAVEX 
Post-HAVEX 
Firmware Modification in I/O Data 
Pre-Firmware Modification 
During-Firmware Modification 
Key Things to Focus on 
• Identify the top talkers 
• Identify biggest bandwidth users 
• Identify encrypted communications 
• Identify critical assets and normalized traffic 
• Identify network anomalies 
– Firmware updates not during scheduled down time 
– HMI 1 talking to HMI 2 
– Odd data flows, spikes in protocol historical data, new 
connections in the ICS, PLCs talking to iran.com 
This could be us 
But you playing 
We are the love-children of IT and OT 
• IT and OT integration is unavoidable 
• Work together and have a plan 
• Lots of defender narratives exist 
• Include the vendors 
– Force the discussions 
– Write it into the contract 
– Know who owns what 
– Ensure responsibility 
• Now back to breaking shit 
– Stage booze? I’ll take an 
Old Fashioned please 
I am ashamed 
We are ashamed 
We want you to 
be ashamed 
Ancient Rome left us roads and concrete. 
Han Dynasty China gave us paper and printing. 
Edwardian Britain gave us steam engines. 
America gave us the internet. 
Will we leave our ancestors insecure networks? 
Legacy used to mean something different. 
It used to mean a gift left to the next generation. 
Now legacy system means old and insecure. 
Reclaim the word legacy. 
Be ashamed to die until 
you provide secure 
industrial infrastructure 
to the next generation