titleblackhat:asia-21 Disappeared Coins: Steal Hashrate in Stratum Secretly
Most cryptocurrencies with high value are based on proof-of-work (PoW), including Bitcoin, Litecoin, and Ether. The process to "produce" them is usually called "mining", and the people involved are called "miners". The mining process is one of the most important infrastructures in the PoW based blockchain system. As the number of miners increases, mining becomes more and more difficult. Many miners decided to establish mining pools for cooperation so that miners who join the mining pools can share the profit according to the computing power they contributed to the pool. Stratum is the mainstream communication protocol between miners and mining pools. Its security is very important to the participants. In our work, we propose two novel man-in-the-middle (MITM) attack schemes towards Stratum, which means attackers can steal miners' computing power to any mining pool on the basis that TCP connections can be hijacked. Compared with existing attack schemes, our work is more secretive, more suitable for the real environment, and more harmful. The proof-of-concept (PoC) shows that our work works perfectly on most mining softwares and pools. Since the ISPs are hijacking traffic for advertisement all over the world, our work whistles to blockchain miners for a more hidden and profitable potential attack scheme.