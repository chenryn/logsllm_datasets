内存管理和异常机制。11.11节～11.13节详细介绍英特尔GPU的调试设
施，包括断点支持、单步机制以及GT调试器。
11.1 演进简史
英特尔在20世纪90年代末加入到显卡领域的竞争，20多年里，其产
品形态经历了三个主要阶段。最初是AGP总线接口的独立显卡，然后是
集成在芯片组中的集成显卡，再后来是与CPU集成在同一个芯片中的
GPU。
11.1.1 i740
1998年，英特尔公司推出它的第一款显卡产品，名为英特尔740，
简称i740。与当时的其他显卡相比，i740的最大特色是使用了专门为显
卡设计的AGP总线。AGP的全称是“加速图形端口”（Accelerated
Graphics Port），是专门为显卡设备量身定制的总线接口。当时的主流
显卡大多用的是PCI总线。PCI总线的特点是供系统中的多个设备共用，
而AGP总线仅供显卡专用。
因为英特尔在PC产业的独特地位，所以它的显卡产品一推出，便
广受关注。作者还记得，当年不少玩家抱怨i740的驱动程序很难装。这
个容易被忽视的细节或许反映了英特尔显卡一直都有的大问题。
 老雷评点 
此处用隐笔。
11.1.2 集成显卡
虽然备受瞩目，但是i740的实际表现不如预期的那样好。1999年，
第一款集成了显卡功能的英特尔芯片组问世，名为i810。从此，英特尔
把显卡产品的重心放在集成显卡上，集成显卡的时代开始了。英特尔第
一次在独立显卡方面的努力以i740的昙花一现而结束。
当年的芯片组是经典的南北桥双芯片架构，南桥负责容纳和连接各
种低速设备，称为ICH（I/O Controller Hub）。北桥负责连接内存和高
速设备，本来称为MCH（Memory Controller Hub），集成了显卡后改称
为GMCH。
考虑到市场需求的不同，对于某一代芯片组，有的产品可能带有集
成显卡，有的可能不带。在英特尔的芯片组产品命名规则中，对于带有
集成显卡的芯片组，其产品代号末尾会有字母G，比如815G。这种命名
方法从2000年起开始使用，持续了很多年。2007年左右，开始使用类似
82GME965这样的命名方法，其中的G也代表包含集成显卡，M代表针
对移动平台（笔记本电脑）设计。
从82810开始的英特尔集成显卡一直延续着一些基本的特征，同
时，也在不断加入新的功能，一代代地向前发展。大约从2005年开始，
这一系列显卡有了一个统一的名字，叫GenX。其中Gen为 Generation的
缩写，X表示版本号。最早使用这种称呼的是2005年发布的82915G芯片
组（简称915）。直到今天，包含在Linux内核源代码包中的英特尔显卡
开源驱动程序仍使用着它的名字（drivers\gpu\drm\i915）。915称为
Gen3，向前追随，第一代集成显卡i810称为Gen0。表11-1归纳了集成在
芯片组中的Gen系列显卡的主要产品。
表11-1 集成在芯片组中的Gen系列显卡
架构
名
代  号
主 要 产 品
发布年
份
说  明
Gen0
Whitney 和Solano
82810/82815G
1999
—
Gen1
Almador
82830GM
2001
—
Gen1.5 Montara
82852GM和
82855GM
2004
针对移动平台的产品
Gen2
Brookdale
82845G
2002
—
Gen2.5 Springdale
82865G
2003
—
Gen3
Grantsdale 和
Alviso
82915G和
82915GM
2004
引入了像素着色器和双独立
显示器
Gen3.5 Lakeport 和
Calistoga
82945G和
82945GM
2005
—
Gen4
Broadwater 和
Crestline
82G965和
GME965
2006
引入可编程核心和顶点着色
器支持
在表11-1中，有多个单元格中都包含两项，这是因为在研发某一代
产品时，要把一套核心设计应用在多个目标市场，比如Gen3中，
Grantsdale是针对桌面平台的，而Alviso是针对移动平台的。另外表格中
的数据主要来自维基百科[1]，个别产品的发布时间可能和英特尔产品官
网上的时间略有差别。
11.1.3 G965
表11-1中所列的82G965（简称G965）集成显卡值得特别介绍。它
最关键的特征是引入了通用的可编程执行单元（Execution Unit，
EU），代表着英特尔GPU历史中的一个重要里程碑。G965的发布时间
为2006年6月，同年7月英特尔发布了一份白皮书，介绍新的图形架构，
书名为《英特尔下一代集成图形架构——英特尔图形和媒体加速器
X3000和3000》（Intel’s Next Generation Integrated Graphics Architecture
—Intel® Graphics Media Accelerator X3000 and 3000），副书名是G965图
形技术的正式产品名称——GMA X3000和GMA 3000。准确地说，G965
是芯片组的名字，GMA 3000是其中的图形（集成显卡）部分。不过，
人们习惯了用G965这个名字来称呼它内部的集成显卡。
图11-1是来自G965白皮书的插图，用于描述G965引入的新集成显
卡架构，其中间部分画出了8个通用执行单元，其两侧的部分代表固定
功能单元（Fixed Function Unit，FFU），这种EU + FFU的混合设计在今
天看来已经很普通，但是在当时是很新颖的。值得强调的是，Nvidia
G80也是同一年发布的，正式发布时间为2006年11月8日。二者比较，
G965的推出时间还比Nvidia的G80早5个月。因此，英特尔在白皮书的副
书名中将G965称为“突破性的混合架构”（Ground breaking hybrid
architecture），也是当之无愧的。可以推测，G965和G80的研发时间大
体在相同的时候，二者的基本设计思想也有很多相同的地方，发布时间
也在同一年。令人唏嘘的是，二者的“命运”有天壤之别。G80地位显
赫，而G965渐渐不为人所知。
图11-1 G965引入的INTEL图形架构[2]
11.1.4 Larabee
在2008年的SIGGRAPH大会上，英特尔首次公开了正在研发中的独
立GPU架构，也就是著名的Larabee项目。该项目的目标是与Nvidia和
AMD竞争独立显卡的市场。这是英特尔在i740产品发布10年后第二次尝
试进入独立显卡领域，很多人都对其充满期待。可惜一年后，人们等到
的不是Larabee的发布，而是项目的取消。与之相伴的另一个坏消息是
IA架构的一位灵魂人物Pat Gelsinger离开英特尔。在英特尔，广泛流传
着Pat的励志故事。他18岁便从宾夕法尼亚州的一所两年制技术学校毕
业，到英特尔工厂工作。他最初的职位是生产线上的技术工人
（technician）。年轻的Pat一边工作，一边学习本科课程，一心想成为
一名工程师，后来他参与了IA历史上多个重要产品的研发工作，并成为
英特尔的CTO。2009年，可能因为与Larabee项目有关的问题，他离开
了英特尔。Pat是IA平台的经典图书《80386编程》（《Programming the
80386》）的作者之一。著名的英特尔开发者大会（IDF）也由Pat创
立。
 老雷评点 
2010年的IDF上，曾有参会观众问：“Where is Pat?”IDF于
2017年停办，想来让人一叹。
11.1.5 GPU
2010年1月，在一年一度的消费电子展上，英特尔发布了包含集成
显卡（GPU）的处理器芯片。这款芯片内部实际上封装了两块晶片，一
块是Westmere微架构的CPU，另一块是代号为Ironlake的GPU和内存控
制器。从此，传统的CPU + MCH + ICH的三芯片架构演变成了CPU +
PCH的双芯片架构。传统的北桥芯片消失了，它的大部分功能向上移入
到CPU当中，小部分功能向下移入到南桥中，新的南桥也有了一个新的
名字，叫PCH，全称为平台控制器中继器（Platform Controller Hub）。
在市场方面，集成到CPU中的新“显卡”也有了一个新的名字——
Intel HD Graphics，其中HD是High Definition的缩写。在英特尔内部，通
常把新的图形部分叫处理器图形（单元）（Processor Graphics），简称
pGraphics，或者pGfx。
图11-2是Sky Lake处理器（酷睿i7 6700K）的芯片快照[3]，中间是4
个CPU内核，左侧是集成的内存控制器、显示控制器和I/O接口，右侧
便是处理器GPU。可以看到，GPU所占的芯片面积在2/5左右，这反映
了GPU的重要性。
图11-2 Sky Lake处理器（酷睿i7 6700K）的芯片快照[3]
乔迁之后，GEN架构的GPU开始了新的发展历程，表11-2归纳了这
一阶段的Gen架构GPU概况。
表11-2 GEN架构的GPU
架 构 名
代  号
发 布 年 份
说  明
Gen5
Ironlake
2010
集成到CPU中的第一代GEN GPU
Gen6
Sandy Bridge
2011
—
Gen7
Ivy Bridge
2012
—
Gen7.5
Haswell
2013
—
Gen8
Broadwell
2014
—
Gen8LP
Cherryview和Braswell
2015
低功耗设计
Gen9
Sky Lake
2015
—
Gen9LP
Apollo Lake
2016
低功耗设计
Gen9.5