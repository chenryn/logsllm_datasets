title:Achieving Flexibility for ABE with Outsourcing via Proxy Re-Encryption
author:Zuoxia Yu and
Man Ho Au and
Rupeng Yang and
Junzuo Lai and
Qiuliang Xu
Achieving Flexibility for ABE with Outsourcing via Proxy
Re-Encryption
Zuoxia Yu
Department of Computing,
The Hong Kong Polytechnic
University
Hong Kong, China
PI:EMAIL
Man Ho Au∗
Department of Computing,
The Hong Kong Polytechnic
University
Hong Kong, China
PI:EMAIL
Rupeng Yang
School of Computer Science and
Technology, Shandong University;
Department of Computing,
The Hong Kong Polytechnic
University
Jinan, China
PI:EMAIL
Junzuo Lai
College of Information Science and
Technology, Jinan University,
Guangzhou, China;
State Key Laboratory of Cryptology,
Beijing, China
PI:EMAIL
Qiuliang Xu
School of Computer Science and
Technology,
Shandong University
Jinan, China
PI:EMAIL
ABSTRACT
Outsourcing the decryption of attribute-based encryption (ABE)
ciphertext is a promising way to tackle the question of how users
can perform decryption efficiently. However, existing solutions re-
quire the type of the target ciphertext to be determined at the setup
of the outsourcing scheme. As such, making the target cryptosys-
tems (or the clients) to be versatile becomes an issue that warrants
investigations. In this paper, the problem we wish to tackle is to
transform an ABE ciphertext to any client who is using the same,
or possibly different, public-key encryption (PKE) system with the
sender. The problem is of practical interest since it is hard to require
all clients to use the same PKE, especially in the case of remote and
cross-system data sharing. In addition, we also consider whether
robust client-side decryption scheme can be adopted. This feature
is not supported in the existing ABE with outsourcing.
We introduce cross-system proxy re-encryptions (CS-PRE), a
new re-encryption paradigm in which a semi-trusted proxy con-
verts a ciphertext of a source cryptosystem (Π0) into a ciphertext
for a target cryptosystem (Π). We formalize CS-PRE and present
a construction that performs well in the following aspects. (1)Ver-
satility: Π0 can be any attribute-based encryption (ABE) within
Attrapadung’s pair encoding framework. Π can be any public-key
encryption. Furthermore, the keys and public parameters can be
∗Corresponding Author
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than the
author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or
republish, to post on servers or to redistribute to lists, requires prior specific permission
and/or a fee. Request permissions from permissions@acm.org.
ASIA CCS ’18, June 4–8, 2018, Incheon, Republic of Korea
© 2018 Copyright held by the owner/author(s). Publication rights licensed to the
Association for Computing Machinery.
ACM ISBN 978-1-4503-5576-6/18/06...$15.00
https://doi.org/10.1145/3196494.3196557
generated independently. (2) Compatibility: CS-PRE does not mod-
ify the public parameters and keys of Π0 and Π. Besides, input
for the conversion is an ordinary ciphertext of Π0. (3) Efficiency:
The computational cost for re-encryption and decryption of the
re-encrypted ciphertext are roughly the same as a decryption in Π0
and Π respectively.
We prove that our construction is fully secure assuming Π0
is secure in Attrapadung’s framework and Π is IND-CPA secure.
Furthermore, it remains secure when there are multiple target cryp-
tosystems. As with other proxy re-encryption, CS-PRE enables
flexible sharing of cloud data, as the owner can instruct the cloud
server to re-encrypt his ciphertext to those for the intended re-
cipient. In addition, it allows lightweight devices to enjoy access
to remote data encrypted under powerful but possibly costly en-
cryption, such as functional encryption, by utilizing the server’s
power in converting the ciphertext to a simpler encryption, such
as RSA-OAEP. Finally, instances of CS-PRE can be viewed as new
proxy re-encryption schemes, such as a PRE supporting ABE for
regular language to Hierarchical IBE or Doubly Spatial Encryption
to lattice-based encryptions (e.g. NTRUCCA).
KEYWORDS
proxy re-encryption; cross-system; attribute-based encryption; public-
key encryption; pair encoding
ACM Reference Format:
Zuoxia Yu, Man Ho Au, Rupeng Yang, Junzuo Lai, and Qiuliang Xu. 2018.
Achieving Flexibility for ABE with Outsourcing via Proxy Re-Encryption. In
ASIA CCS ’18: 2018 ACM Asia Conference on Computer and Communications
Security, June 4–8, 2018, Incheon, Republic of Korea. ACM, New York, NY,
USA, 14 pages. https://doi.org/10.1145/3196494.3196557
1 INTRODUCTION
With the advent of cloud computing, online data storage and shar-
ing have been very popular. Users are gradually transforming their
Session 16: Applied Crypto 2ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea659prime storage media from local hard disk to the cloud. When shar-
ing data with others, they often choose to send the data from their
cloud to the receiver’s cloud; and for those data shared or delivered
by the others, they usually leave the data in the cloud and access
them when needed. This allows them to access the data anytime,
anywhere, on any device. However, the data stored in the cloud,
which may contain sensitive information about the user, are vulner-
able to snooping by the cloud provider. Hence, encryption before
being transferred is preferable. ABE is widely applied because it
can also provide fine-grained access control over the encrypted
data. However, convenience of the cloud decreases greatly since it
is much harder to perform useful operations on encrypted data. In
practice, decryption operations in ABE schemes are quite expen-
sive. This may prevent the users from accessing the data via those
resource-constrained portable devices, e.g. smartphones, tablets, etc.
For example, Alice is a staff at a university, where an ABE scheme is
used to guarantee secure information transmitting in a fine-grained
manner. Sometimes, Alice needs to read these university messages
at her mobile phone, whose computation capability may be too
limited for the decryption of the ABE ciphertext. As a result, she
has to wait for a long time to get the messages, and the battery
consumption of her phone is very fast.
Outsourcing the decryption of ABE ciphertext appears to be a
feasible way to tackle the aforementioned energy issue. This idea
is first introduced by Green et al. [21]. Specifically, they proposed a
mechanism which allows a proxy to transform ABE ciphertext to a
short Elgamal ciphertext which supports efficient decryption.
However, in the aforementioned ABE with outsourcing, the type
of the target ciphertext is determined at the setup of the outsourcing
scheme. This leads to several problems. To demonstrate this, we
recall the example of Alice mentioned above. After she uses a server
to help her partially decrypt the ABE ciphertext, she can read the
message instantly and does not need to wait for a long time to
decrypt. However, two issues remain.
• Firstly, the mechanism is not friendly for data sharing. For ex-
ample, the university often provides daily information such
as the notification of the Christmas party. Alice wants to for-
ward them to her friend, but she does not want to complete
the encryption operation on her mobile phone and hopes to
outsource this task to her server on the original encrypted
email. However, current outsourcing schemes cannot trans-
form ciphertext into the one encrypted under other’s public
key.
• Secondly, the mobile phone may be infected with malware
or suffered from side channel attacks. Part of the secret key
embedded inside the phone may be stolen or tampered with.
To guarantee data confidentiality, a robust client side decryp-
tion scheme should be used. Ideally, the target cryptosystem
should offer resistance against side channel and related-key
attacks. However, current outsourcing schemes do not sup-
port this.
To solve these problems, we revisit the task of ABE with out-
sourcing and observe that proxy re-encryption (PRE) may help.
The concept of PRE was introduced by Blaze et.al. in [6] to support
delegation of decryption rights from one party to another with the
help of a semi-trusted proxy holding a re-encryption key. In this
way, ciphertexts of the delegator can be transformed to ciphertexts
of the delegatee by a proxy without the involvement of the former.
Security of the PRE schemes requires that neither the proxy nor
the delegatee alone could learn any information from ciphertexts
of the delegator. This primitive has extensive pivotal applications,
especially for efficient data storing and sharing [1, 33, 50] in cloud
computing and social networks [24]. Especially, it was deployed
by a company AtCipher in their product to enable secure cloud
storage and data sharing.
Now, with the help of PRE schemes, we can transform the ci-
phertext into the one of a specific type of encryption scheme as
well as encrypted under another public key. For example, in order
to access data encrypted under ABE schemes, Alice could send a re-
encryption key to the cloud, which can ask the cloud to transform
the ABE ciphertext to a lightweight one, say, RSA ciphertext when
needed; or ask the cloud to transform the ciphertext into the one
encrypted under Bob’s public key. Unfortunately, current existing
constructions of PRE schemes cannot satisfy our requirement. Es-
pecially, there is no PRE scheme supporting flexible target scheme
previously. We give a more detailed discussion on this in Section
1.2.
1.1 Our Contributions
In this paper, we introduce and formalize the notion of cross-system
proxy re-encryption (CS-PRE) which allows a semi-trusted proxy
to convert ciphertext from the source cryptosystem to those in the
target cryptosystem. Our construction of CS-PRE is versatile, sup-
porting a large class of attribute-based encryptions for the source
cryptosystem and does not impose any restriction on the target
cryptosystem except that it must be IND-CPA secure. We prove
that our proposal is fully secure in the standard model under static
assumptions. The architecture of our system is illustrated in Fig-
ure 1.
The Techniques. The basic idea of our construction is similar to
that in [20, 30]. However, to support the cross-system property and
to avoid the chain collusion attack, we encrypt the randomness
used for hiding the secret key of the original encryption scheme
with another CPA-secure encryption scheme. To prove the secu-
rity of the scheme, we devise an alternative proof sequence for
re-encryption key queries for attributes matching the challenge
ciphertext. Looking ahead, we make use of the subgroup decision
assumptions and the IND-CPA security of the target encryption
scheme to hide those keys computationally.
Two Application Scenarios. Here we also propose two applica-
tions of our cross-system proxy re-encryption schemes.
• For the case of efficiency, our constructed CS-PRE can be
used to transform the ABE ciphertext into the ciphertexts of
some lightweight public-key encryption schemes suitable for
the portable devices. This case is very similar to outsourcing
the decryption of ABE ciphertext. The architecture for this
case is illustrated in Figure 2, where a cloud user may want
to ask the cloud to help transform the ABE ciphertext put in
the cloud to a lightweight public-key ciphertext.
Session 16: Applied Crypto 2ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea660Source Crypto-System
C
ABE within [2]
Proxy
Target Crypto-Systems (Any CPA-PKE)
PKE (e.g. Elgamal [17], RSA [39],
NTRUCCA [42])
IBE(e.g., [26, 46]), ABE (e.g., [25])
HIBE (e.g., [9, 19]), DFA-ABE (e.g., [48]),
IPE (e.g., [38])
Figure 1: Workflow of our construction.The rectangle on the right means the set of all attribute-based schemes. ABE within [2] means those
ABE schemes within the framework presented in [2]. PKE means the set of the original public-key encryption schemes. DFA-ABE means
deterministic finite automata-based ABE for regular language.
Figure 2: Use Case 1 of our CS-PRE.
“ABE-CT” denotes the ABE ciphertext, “rk” is the abbreviation for re-encryption key, and “r-CT” denotes the re-encryption ciphertext.
• For the consideration of enhanced functionality, our con-
structed scheme can also be used to transform the ABE ci-
phertext into many different ciphertexts. The targeted ci-
phertexts can be of the same type of public-key encryption
scheme but encrypted under different public keys, or of dif-
ferent types of public-key encryption schemes. This kind
of transformation is done via the help of the different re-
encryption keys. The architecture for this case is illustrated
in Figure 3.
1.2 Related Works
Related Works about Proxy Re-Encryption Schemes. Early PRE [6,
11, 34] considers bidirectional delegation, which allows the proxy to
transform ciphertexts of the delegator to that of the delegatee and
vice versa. This property, however, is not desirable in many scenar-
ios, including our cloud storage settings, since the delegatee may
not want to delegate his decryption rights to the delegator. Thus,
another line of works [1, 20, 32, 40] which considers unidirectional
delegation has attracted more attentions recently.
A PRE scheme is multi-hop if the proxy can perform multiple
consecutive re-encryptions on a ciphertext. Examples include [11,
20, 34]. Otherwise, it is a single-hop PRE [1, 20, 23, 32, 40]. At a
first glance, multi-hop PRE schemes appear to be more powerful
and may even imply the later. However, the chain collusion attack
presented by Shao and Cao [40] illustrated that a secure multi-hop
PRE scheme may not remain secure in the single-hop setting. In
practice, either single-hop or multi-hop PRE may be desirable and
thus both types of PRE are being studied.
While a variety of PRE schemes have already been proposed, we
observe that, as summarized in Figure 4, they fail in fulfilling those
requirements. Even worse, some of them have some security issues
preventing them from being deployed in practice. In particular, they
face one or several of the following problems.
• Not Supporting Cross-System. Only few works attempt to
construct PRE schemes supporting cross-system, and none
of them supports “arbitrary target system”.
• Poor Functionality. Many works only focus on ABE schemes
with simple functionality, e.g. identity-based encryption
(IBE) schemes, and ABE schemes supporting more advanced
Source CryptosystemTarget CryptosystemsProxy1. ABE-CT2. rk3. r-CTSession 16: Applied Crypto 2ASIACCS’18, June 4–8, 2018, Incheon, Republic of Korea661Figure 3: Use Case 2 of our CS-PRE.
“ABE-CT” denotes the ABE ciphertext, “rk” is the abbreviation for re-encryption key, and “r-CT” denotes the re-encryption ciphertext. “CS”
is the short for cryptosystem.
rity level, namely, selective security.
access control, e.g. doubly spatial encryption (DSE), have
not been considered.
• Low Security Level. Some works only achieve a weak secu-
• Insecurity. Some schemes are broken by particular attacks.
For instance, Scheme 1 in [20], and schemes in [18, 29, 30]
can be compromised by the chain collusion attack presented
in [40], which is effective for many single-hop PRE schemes.
The main idea of this attack is as follows. In a single-hop
PRE scheme, let A be the target of the adversary, and B, C
P1−→ B,
be any two users, and consider the delegation from A
P2−→ C, then the adversary corrupts proxy P1, P2 and user
B
C. Next, the adversary attempts to recover the secret key of
A from secret keys of parties he just corrupted. Note that
this corruption behaviour is allowed in the security model of
the single-hop PRE as it will not trivially break the security
goal. Many schemes which apply a similar technique applied
in designing multi-hop PRE schemes, e.g. those schemes we
just mentioned, are vulnerable to this attack.
• Strong Assumptions. Some schemes establish their security
in the random oracle model, which is quite controversial [10],
and some schemes need to involve a trusted central party to
help generate the re-encryption key.
Construction of adaptively secure ABE. The difficulty of construct-
ing adaptively secure ABEs in standard model was overcame by dual
system methodology[47]. Based on that, different adaptively secure
ABEs, such as identity-based encryption (IBE)[26, 27], attribute-
based encryption (ABE) [25, 28], inner-product encryption(IPE)
[4, 37], spatial encryption (SE)[4, 22], are constructed. Observing
that those dual system encryption schemes share similar idea,
two general frameworks [2, 49] are presented. This also makes
it possible to achieve some general results regarding dual system
based constructions [7, 51]. However, those two general frame-
works only work in the composite-order bilinear groups, which
may make schemes hard to implement. To solve this problem,
prime-order group based instantiations of those frameworks are
presented [3, 12]. However, they only realize the essential property
of the framework, hence the constructed schemes are less flexible
and it is quite difficult to enhance those schemes with more features.
1.3 Organization of this paper
The rest of the paper is organized as follows. In Section 2, we
give some basic notations and definitions. The syntax and security
notions of CS-PRE are presented in Section 3. We introduce our
construction of CS-PRE in Section 4. In Section 5, we also give
some discussion about the construction of CS-PRE in prime-order
groups.
2 PRELIMINARIES
$← R the fact that r is picked ran-
Notation. We denote by r
domly and uniformly from finite set R. We use [n] to denote the set
{1, 2,· · · , n}. We use lowercase (resp. uppercase) letters in boldface
to denote vectors (resp. matrices). Note that we treat all vectors in
this paper as row vectors. Let G be a group, and д ∈ G is a group
element. For д ∈ G and ⃗k = (k1, k2, · · · , kn ) ∈ Z n
⃗k denotes (дk1,
дk2, · · · , дkn ). We use × to denote dot product operation of vectors,
and use · to denote component-wise multiplication of vectors.
, д
N
2.1 Composite-Order Bilinear Groups and
Assumptions
We review the definition of composite-order group [8]. Let (G, GT)
denote bilinear groups of composite order N = p1p2p3, where p1, p2
and p3 are distinct primes, with an efficiently computable bilinear
map e : G × G → GT satisfying the following properties.