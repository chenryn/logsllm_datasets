Space
NSE
脚本
引擎
设备发现工具-Zmap 
 ZMap – Internet Wide 
Scanner 
密歇根大学团队在2013年开发完成 
发布于22届USENIX会议上 
千兆以太网条件下，45分钟完成全网
存活探测，是Nmap的1300倍 
C语言开发，开源网络扫描工具，密
西根大学的多个博士生一直维护 
https://github.com/zmap/zmap 
设备发现技术领域里程碑式的工具 
Zmap架构 
Durumeric, Z., Wustrow, E., & Halderman, J. A. (2013, August). ZMap: Fast Internet-wide 
Scanning and Its Security Applications. In Usenix Security(Vol. 2013). 
快速扫描技术 
 设备扫描 
主机存活 
–
做主机存活扫描，
得到设备候选集 
收集应用层数据 
–
对设备进行协议
探测，抓取标语
信息 
标识 
–
对设备进行标识 
数据整合存储 
–
整合数据存储数
据到数据库 
存活的
主机IP
地址 
应用层
协议标
语信息 
基于协
议特征
的标识 
数据整
合 
2016年9月2日星期五2时21分19
秒 
Part. 04 
Saw—看看你是谁 
20 
设备指纹识别技术 
 什么指纹？ 
人的指纹：灵长类手指末端指腹上由
凹凸的皮肤所形成的纹路，也可指这
些纹路在物体上印下的印痕。(Wiki) 
数据指纹：从一段数据中提取出的可
以唯一确定该数据的特征 
设备指纹：从远程设备中采集的用于
确定该设备的信息 
OS指纹 
设备硬件指纹 
设备指纹识别技术 
Nmap系统指纹 
SinFP系统指纹 
西门子指纹 
智能电表 
服务器指
纹 
智能开关 
OS
指
纹
协
议
指
纹
2016年9月2日星期五2时21分26
秒 
Part. 06 
Our work 
23 
全球分布态势图 
全国分布态势图 
搜索结果 
工厂 
加气站 
施耐德设备 
DCS系统 
供热控制
系统 
应用示范 
看世界 
《速度与激情7》中设计出一种超级黑客程序“天眼”系统，这个程序
可以整合全球所有的数据采集、监控设备，可以通过手机音频、监控摄
像头等手段大量采集数 据，再使用大数据和人脸识别等技术，短时间内
把要找的人找出来。 
点我“看”世界 
2016年9月2日星期五2时21分26
秒 
Part. 07 
工控篇 
29 
工控设备快速搜索技术 
 问题与目标 
 快速发现设备，并且对这些设备进行标识建立
档案 
 技术要点 
 快速筛选 
•
无状态连接、单包、跳过内核直接从网卡发送数
据包、特定端口等方式获得工控设备候选集合 
 精准探测 
•
通过贪心准则筛选最优探测数据包载荷 
 建立档案 
•
结合多维度（时间、空间、设备）的特征，建立
设备档案 
Filtering
Identifying Candidates
Modbus protocol
Probing
S7 protocol
Particular Port
Stateless
One packet
Internet Space
工控协议指纹库 
指纹库 
研究和提取了包括西门子、施耐德、浙大中控、和利时
等知名品牌设备的指纹 
Siemens等17种工控协议特征 
搜索到的西门子S7 PLC 
搜索到的施耐德BMX PLC 
全球工控设备态势分析 
 动态性 
 工控设备大部分IP为静态，一个月内变化小，三个月会有
1/3发生变化 
 与综合国力相关 
 发达国家的工控设备较多，但一般不在最发达的城市 
 工控设备的分布显示长尾效应 
我国工控系统的安全现状 
应**省对工控系统进行调研 
 全国渗透了70多个工控系统 
 涵盖了能源、电力、水利等要害行业 
12 
3 
12 
2 
3 
2 
10 
2 
10 
0 
2 
4 
6 
8 
10 
12 
14 
能源 
制造 
水利 
楼宇 
电力 
环保 
生活 
安防 
监测 
搜索目标
44%
获取权限
19%
get shell
8%
sql注入拖库
11%
路径遍历
10%
弱密钥
8%
工控渗透总结
0
5
10
15
20
25
搜索目标
获取权限
get shell
sql注入脱裤
路径遍历
弱密钥
搜索目标
23
获取权限
10
get shell
4
sql注入脱裤
6
路径遍历
5
弱密钥
4
工控攻击统计
智能硬件的展望 
智能电视 
Sony电视 
关键词：“Bravia TV” 
智能开关 
TP-LINK开关 
关键词： Basic 
realm=“Web Smart 
Switch” 
智能电表 
IBM Tivoli WebSEAL 
Smart Meter 
T
H
A
N
K
S 
[ PI:EMAIL]