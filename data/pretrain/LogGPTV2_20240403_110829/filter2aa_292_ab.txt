# 空间与网络扫描工具

## NSE (Nmap Scripting Engine)
NSE 是 Nmap 的脚本引擎，用于编写自定义的网络扫描脚本。

## ZMap - 全网扫描工具
ZMap 是由密歇根大学团队在2013年开发的一种快速全网扫描工具。该工具在第22届USENIX安全会议上发布，并且能够在千兆以太网条件下，45分钟内完成全网存活探测，速度是Nmap的1300倍。ZMap使用C语言编写，是一款开源网络扫描工具，目前由密歇根大学的多名博士生维护。其GitHub地址为：[https://github.com/zmap/zmap](https://github.com/zmap/zmap)。

### ZMap 架构
- **Durumeric, Z., Wustrow, E., & Halderman, J. A. (2013, August). ZMap: Fast Internet-wide Scanning and Its Security Applications. In Usenix Security(Vol. 2013).**
- **快速扫描技术**：通过设备发现、主机存活检测、应用层数据收集和标识等步骤，实现高效的数据整合与存储。
- **设备扫描**：进行主机存活扫描，生成设备候选集。
- **应用层协议标语信息**：对设备进行协议探测，抓取标语信息。
- **基于协议特征的标识**：对设备进行标识。
- **数据整合存储**：将存活的主机IP地址、应用层协议标语信息等数据整合存储到数据库中。

## 设备指纹识别技术
### 指纹类型
- **人的指纹**：灵长类手指末端指腹上由凹凸皮肤形成的纹路。
- **数据指纹**：从一段数据中提取出的可以唯一确定该数据的特征。
- **设备指纹**：从远程设备中采集的用于确定该设备的信息。

### 常见的设备指纹
- **OS指纹**：操作系统指纹。
- **设备硬件指纹**：硬件配置信息。
- **系统指纹**：如Nmap系统指纹、SinFP系统指纹等。
- **工业控制系统指纹**：如西门子指纹、施耐德指纹等。

## 工控设备快速搜索技术
### 问题与目标
- 快速发现并标识工控设备，建立档案。

### 技术要点
- **快速筛选**：采用无状态连接、单包发送、跳过内核直接从网卡发送数据包、特定端口等方式筛选候选设备。
- **精准探测**：通过贪心准则选择最优探测数据包载荷。
- **建立档案**：结合时间、空间、设备等多维度特征建立设备档案。

### 工控协议指纹库
- 研究并提取了包括西门子、施耐德、浙大中控、和利时等知名品牌设备的指纹。
- 包含Siemens等17种工控协议特征。

### 全球工控设备态势分析
- **动态性**：大部分工控设备的IP为静态，一个月内变化较小，三个月内约有三分之一会发生变化。
- **与综合国力相关**：发达国家的工控设备较多，但通常不在最发达的城市。
- **分布显示长尾效应**：我国工控系统的安全现状调查显示，全国渗透了70多个工控系统，涵盖能源、电力、水利等关键行业。

### 工控渗透总结
- **搜索目标**：44%
- **获取权限**：19%
- **get shell**：8%
- **SQL注入拖库**：11%
- **路径遍历**：10%
- **弱密钥**：8%

### 工控攻击统计
- **搜索目标**：23
- **获取权限**：10
- **get shell**：4
- **SQL注入脱裤**：6
- **路径遍历**：5
- **弱密钥**：4

## 智能硬件的展望
- **智能电视**：例如Sony Bravia TV。
- **智能开关**：例如TP-LINK Basic realm=“Web Smart Switch”。
- **智能电表**：例如IBM Tivoli WebSEAL Smart Meter。

感谢阅读！  
[PI:EMAIL]