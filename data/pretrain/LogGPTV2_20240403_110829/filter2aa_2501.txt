HITCON 2013 : CYBERWAR, IN  HACK WE TRUST
JUL. 19-20, 2013
How can I have 100 0-day for just 1-day
Version : Draft
Speak by R3d4l3rt
1
HITCON 2013
Introduction
I.
How can I found bug easily?
III.
Project Overview
II.
How can I have about one hundred vulnerability for just 1 days
IV.
Outline
•
Introduction of speaker
•
I just want to find a lot of vulnerability
•
Think it easier and Change one’s way of thinking
•
How can we found vulnerabilities
•
About ActiveX
•
APT Attacks via Active-X (Cases Study)
•
Introduction Automatic sample collections tool (Demo) 
Introduction Auto Install sample tool (Demo)
•
Introductions Fuzzer
•
Introductions Exploit
•
Result of Tested
•
Examples (Active X Vulnerability)
2
HITCON 2013
Introduction
I.
How can I found bug easily?
III.
Project Overview
II.
How can I have about one hundred vulnerability for just 1 days
IV.
Outline
•
Introduction of speaker
•
I just want to find a lot of vulnerability
•
Think it easier and Change one’s way of thinking
•
How can we found vulnerabilities
•
About ActiveX
•
APT Attacks via Active-X (Cases Study)
•
Introduction Automatic sample collections tool (Demo) 
Introduction Auto Install sample tool (Demo)
•
Introductions Fuzzer
•
Introductions Exploit
•
Result of Tested
•
Examples (Active X Vulnerability)
3
HITCON 2013
Introduction
Who…
Speaker
Introduction
Louis Hur is corporate president and Chief Executive Officer (CEO) of NSHC Corporation. He co-
founded NSHC with four Hackers in 2003 while studying at the University, and was the first CEO until
now Mr. Louis brings more than 15 years of field-proven experience security and
bug hunting
businesses that help clients reduce their enterprise-wide IT security risk. Prior to starting NSHC, He is
a frequent speaker on Internet security issues and has appeared as an expert on various media
outlets, including HK TV and MBC, KBS.
•Experience (2010 ~ 2013)
- 2013 Vulnerability Analysis of NSHC’s R3d4l3rt Teams.
(Discovered 0-day many times. )
- 2011 Black-Hat Abu Dhabi Speaker
- 2010 CSO Conference Speaker
He is working the new vulnerability analysis and bug hunting, mobile security research in NSHC Red
Alert Team. Also He is currently serving for Security Response Center at NSHC Company and
responsible for malicious code analysis and anti-virus products.
He is a frequent speaker on Internet security issues and has appeared as an expert on various media
outlets, including MBC, KBS, JTBC.
•Experience (2010 ~ 2013)
- 2013 Vulnerability Analysis of NSHC’s R3d4l3rt Teams.
(Discovered 0-day many times. )
- 2012 CSO Conference Speaker in KOREA
- 2011 Army Investigation Division served as an instructor
4
HITCON 2013
Introduction
I.
How can I found bug easily?
III.
Project Overview
II.
How can I have about one hundred vulnerability for just 1 days
IV.
Outline
•
Introduction of speaker
•
I just want to find a lot of vulnerability
•
Think it easier and Change one’s way of thinking
•
How can we found vulnerabilities
•
About ActiveX
•
APT Attacks via Active-X (Cases Study)
•
Introduction Automatic sample collections tool (Demo) 
Introduction Auto Install sample tool (Demo)
•
Introductions Fuzzer
•
Introductions Exploit
•
Result of Tested
•
Examples (Active X Vulnerability)
5
HITCON 2013
Project Overview
I just want to find a lot of vulnerability
• I just want to find a lot of vulnerability. 
But, It’s hard to find vulnerabilities.
• What is the Vulnerability ?
Vulnerability is Weakness, Flaw From Hardware or software of computer
Weakness, Flaw
There are key to our Red Alert Project.
Again and Again Remember
This Key Word is
Weakness, Flaw
6
HITCON 2013
Project Overview
Think it easier and Change one’s way of thinking
•
In a short time, it's hard to find many vulnerabilities in just one applications. 
7
HITCON 2013
Project Overview
Think it easier and Change one’s way of thinking
•
In a short time, it's hard to find many vulnerabilities in just one applications.
•
But, If there are many target software … 
8
HITCON 2013
Project Overview
Think it easier and Change one’s way of thinking
•
In a short time, it's hard to find many vulnerabilities in just one applications.
•
If you can fuzz many applications? - The net of the sleeper catches fish
Change one’s way 
of thinking
9
HITCON 2013
Project Overview
How can we find vulnerabilities
•
One of Answers this question, It’s Fuzzing
•
Throw random bits at the program and see if it handles them 
•
Popular robust testing mechanism for software
•
Fast and effective, easy to implement
•
I think that there are best solution which can found many vulnerability in the short 
time.
10
HITCON 2013
Project Overview
How can we find vulnerabilities
•
Almost all of the software is intended to find vulnerabilities.
 File Format
 Network Protocol
 ActiveX
 Browser
 Etc
 Each module’s size is Small
 Easy to collect ActiveX
 There are exist so many vulnerability
 The extend of damage is huge
Why did we 
decide to fuzz 
Active-X?
11
HITCON 2013
Project Overview
About Active X
Microsoft technology introduced in 1996 and based on the Component Object Model
(COM) and Object Linking and Embedding (OLE) technologies.
The intention of COM has been to create easily reusable pieces of code by creating
objects that oﬀer interfaces which can be called by other COM objects or programs.
But ActiveX controls, like any other browser plugin, provide a ripe attack surface for the
malicious. Finding an exploitable flaw in a popular control gets MSRC attention at
Microsoft, and similar attention at other large companies.
Client
Function calls 
to object 
interfaces
Object
Object
Component
Server
12
HITCON 2013
Project Overview
About Active X
ActiveX controls are typically native code (e.g. C++) compiled binaries registered with the Windows
operating system.
Through a registration process the ActiveX control is considered scriptable,
meaning that Internet Explorer can load the control and HTML or JavaScript can interact with it.
Because ActiveX controls run native code in the browser, they can serve as an extension to the
browser. This can lead to numerous security threats not the least of which being that the control
can bypass Internet Explorer’s most precious security defenses
Security issues seems to be a constant problem with ActiveX controls. In fact, it seems most
vulnerabilities in Windows nowadays are actually due to poorly written third-party controls which
allow malicious websites to exploit buﬀer overﬂows or abuse command injection vulnerabilities.
Quite often these controls make the impression of their authors not having realized their code can
be instantiated from a remote website. The following chapters will describe methods to ﬁnd,
analyze, and exploit bugs in ActiveX controls will be presented to the reader.
13
HITCON 2013
Project Overview
APT Attacks via Active X(3.20 Cyber Terror from Active-X)
2013.03.20 large-scale cyber attacks occurred
in the Republic of Korea.
Target for the financial institutions and the media,
they suffered a lot of damage.
North Korea has a cyber terrorist attacks and
ActiveX vulnerability was used.
Attack is prepared a long period of time and
we think that attacks of similar form will continue
to occur.
14
HITCON 2013
How can I found bug easily?
III.
Outline
•
Introduction Automatic sample collections tool (Demo) 
Introduction Auto Install sample tool (Demo)
•
Introductions Fuzzer
•
Introductions Exploit
Introduction
I.
•
Introduction of speaker
Project Overview
II.
•
I just want to find a lot of vulnerability
•
Think it easier and Change one’s way of thinking
•
How can we found vulnerabilities
•
About ActiveX
•
APT Attacks via Active-X (Cases Study)
How can I have about one hundred vulnerability for just 1 days
IV.
•
Result of Tested
•
Examples (Active X Vulnerability)
15
HITCON 2013
Active X install 
Information
Gathering and 
Install Script 
Generation 
Proxy IP 
Address 
Gathering
Separation of 
Install Script for 
easily
automatic 
installation 
Setup for
Automatic 
Install
Fuzzing Test
Make 
a Exploit Code
Exploitable 
?
Normal 
Program
No
YES
How can I found bug easily?
16
HITCON 2013
Active X install 
Information
Gathering and 
Install Script 
Generation 
Proxy IP 
Address 
Gathering
Separation of 
Install Script for 
easily
automatic 
installation 
Setup for
Automatic 
Install
Fuzzing Test
Make 
a Exploit Code
Exploitable ?
Normal 
Program
No
YES
How can I found bug easily?
STEP 1-1
STEP 1-2
17
HITCON 2013
Introduction Automatic sample collections tool
STEP 1-1 :
For collect the active-x applications, Our tools gets on the internet and search the site that include
active-x application. at this moment, Our Search Engine uses to many kind of IP Address to evasion
auto detect search engine.
How can I found bug easily?
Proxy Grabber
For collect proxy ip address list, We can use ‘Proxy
Grabber’. This program can help you scan any range of
addresses on present Proxy list. This tool made by
Hidemyass and this is python script language.
‘Proxy Grabber’ is also open source, so everyone can use
that. We can collect many ip address via Proxy Grabber”
Proxy IP Address  list
18
HITCON 2013
Introduction Automatic sample collections tool
STEP 1-2 :
In this step, We can gather information of active-x. for example download link and CLSID,
application name in HTML Source Code, So target applications are chose at random through Web
search Engine.
How can I found bug easily?
ActiveX_Parser.py
‘ActiveX_Parser.py’
is
the
python
script
for
gathering the active-x information via web search
engine. This script used to many ip address from
step 1-1
As a result, we can
have 3 kinds of file
first is download
information.
And 2nd files is CLSID
Info. Last is Install
Script for fuzzing.
Result of ActiveX_Parser.py
19
HITCON 2013
Introduction Automatic sample collections tool
How can I found bug easily?
DEMO
20
HITCON 2013
Active X install 
Information
Gathering and 
Install Script 
Generation 
Proxy IP 
Address 
Gathering
Separation of 
Install Script for 
easily
automatic 
installation 
Setup for
Automatic 
Install
Fuzzing Test
Make 
a Exploit Code
Exploitable ?
Normal 
Program
No
YES
How can I found bug easily?
STEP 2-1
STEP 2-2
STEP 2-3
21
HITCON 2013
Introduction Auto Install sample tool
STEP 2-1 :
By Step 1-2, we’re able to make individual install script from united script.
How can I found bug easily?
`
ActiveX_List_Div.py
‘ActiveX_List_Div.py’ are able to separate 
the install script from united script via step 
1-2. It makes individual install script for 
quick and easy.
22
HITCON 2013
Introduction Auto Install sample tool
STEP 2-2 :
Before you perform a auto installation, Change a few options Internet Browser.
How can I found bug easily?
ActiveX_Option_Setting.bat
ActiveX_Option_Setting.bat’is a batch file. 
This file’s change the internet explorer 
options for easily instatlled. It include that  
allow active-x execute without warring, 
allow the any certification for using active x, 
allow the download active-x without 
signning. 
Change of 
explorer  
options
23
HITCON 2013
Introduction Auto Install sample tool
STEP 2-3 :
In this case, Our batch file’s run individual script for install.
How can I found bug easily?
AxInstallRun.bat
‘AxInstallRun.bat’ is batch file. It runs 
individual script files for automatic install. 
Installed active-x list
24
HITCON 2013
Introduction Auto Install sample tool
How can I found bug easily?
DEMO
25
HITCON 2013
Active X install 
Information
Gathering and 
Install Script 
Generation 
Proxy IP 
Address 
Gathering
Separation of 
Install Script for 
easily
automatic 
installation 
Setup for
Automatic 
Install
Fuzzing Test
Make 
a Exploit Code
Exploitable ?
Normal 
Program
No
YES
How can I found bug easily?
STEP 3-1
26
HITCON 2013
Introduction Fuzzer
STEP 3-1 :
It’s test the target application by fuzzing. So all of installed applications tested by Our fuzzer.
Result of Fuzzing, we can know that how many crash occurred during fuzzing. 
How can I found bug easily?
AxFuzzer.py
‘Red_Alert_AxFuzzer.py’ is our active-x 
fuzzing tool. It refer the dranzer what is 
open source project. Dranzer is active-x 
vulnerability discovery tool. It developed by 
CERT in USA. 
Collected 
POC List
27
HITCON 2013
Introduction Fuzzer
How can I found bug easily?
DEMO
28
HITCON 2013
Active X install 
Information
Gathering and 
Install Script 
Generation 
Proxy IP 
Address 
Gathering
Separation of 
Install Script for 
easily
automatic 
installation 
Setup for
Automatic 
Install
Fuzzing Test
Make 
a Exploit Code
Exploitable ?
Normal 
Program
No
YES
How can I found bug easily?
STEP 4-1
STEP 4-2
STEP 4-2
29
HITCON 2013
Introduction Exploit
STEP 4-1 :
Selection crashed Active-X Information for Exploit in the result of fuzzing.
How can I found bug easily?
Exploitable PoC
This PoC information inform that EIP Register address is overwrite “41414141”. So It can change the 
exploit very easy and there is no need to spend a time for weaponizing. 
30
HITCON 2013
Introduction Exploit
STEP 4-1 :
To Seek what is the vulnerable Value in the PoC Data’s values.
How can I found bug easily?
look for value for crash
To Seek what is the 
vulnerable Value in the 
PoC Data’s values.
31
HITCON 2013
Outline
Introduction
I.
•
Introduction of speaker
Project Overview
II.
•
I just want to find a lot of vulnerability
•
Think it easier and Change one’s way of thinking
•
How can we found vulnerabilities
•
About ActiveX
•
APT Attacks via Active-X (Cases Study)
How can I found bug easily?
III.
•
Introduction Automatic sample collections tool (Demo) 
Introduction Auto Install sample tool (Demo)
•
Introductions Fuzzer
•
Introductions Exploit
How can I have about one hundred vulnerability for just 1 days
IV.
•
Result of Tested
•
Examples (Active X Vulnerability)
32
HITCON 2013
How many Zero-Day vulnerability to find a day?
Result of Tested (just tested simply BoF Vulnerability)
(            ) 
How many active-X vulnerability use to ATP Attack?
•
Vulnerability
possible
attack
now
of
Discovered ActiveX vulnerability confirmed 24
count. North Korea has often used ActiveX
When carry out a large-scale cyber attacks. We
estimate that North Korea finished the pre-
survey and ready to use cyber terrorism
33
HITCON 2013
How many Zero-Day vulnerability to find a day?
Examples (Active X Vulnerability)
Malicious Web page
ActiveX Install
Important info send to attacker
Safe
yes
no
Victim
Malicious Web page access
Attacker
[Use to Active X 0-Day for APT Attack]
DB Server
1
2
3
Gaining control of the EIP register
It will be easier and faster to handle.