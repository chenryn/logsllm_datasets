ğ‘˜ âˆˆN*
ğ‘…
+
[2]
2 (Case 4) + ğ‘…
[2]
2 (Case 7)
1 âˆ’ ğ‘„( Â¯ğ‘“
[2]
1,1,2, Â¯ğ‘“
[1]
1,2,2)
ğ‘…
+
[2]
2 (Case 5) + ğ‘…
[2]
2 (Case 8)
1 âˆ’ ğ‘„( Â¯ğ‘“
[2]
1,2,2, Â¯ğ‘“
[1]
1,1,2)
;
.
Notice that the calculation of shared reward of Pool1 when
Pool2 first finds an FPoW is exactly same as the calculation
of shared reward of Pool2 when Pool1 first finds an FPoW
ğ‘› ). We can derive the reward of Poolğ‘– in a two-pool
(âˆ‘ï¸€ ğ‘…[2]
PAW game:
âˆ‘ï¸
ğ‘›âˆˆN*
âˆ‘ï¸
âˆ‘ï¸
ğ‘›=2ğ‘˜+1
ğ‘˜ âˆˆ N
ğ‘›=2ğ‘˜
ğ‘˜ âˆˆN*
ğ‘…[ğ‘–] =
ğ‘…[ğ‘–]
ğ‘› =
ğ‘…[ğ‘–]
ğ‘› +
ğ‘…[ğ‘–]
ğ‘› .
1,2, Â¯ğ‘“ [ğ‘–]
Â¯ğ‘“ [ğ‘–]
1,1,2, and Â¯ğ‘“ [ğ‘–]
1,2,2 can be calculated as:
ğ‘“ [ğ‘–]
1 + ğ‘“ [ğ‘–]
1 ğ‘“ [ğ‘–]
2
;
2 âˆ’ ğ‘“ [ğ‘–]
2 âˆ’ ğ‘“ [ğ‘–]
1 (1 âˆ’ ğ‘“ [1]
3 âˆ’ 2(ğ‘“ [1]
2
2ğ‘“ [ğ‘–]
(ğ‘“ [ğ‘–]
1 + ğ‘“ [ğ‘–]
;
2
2 âˆ’ ğ‘“ [2]
2 ) + ğ‘“ [ğ‘–]
2 + ğ‘“ [2]
2 )
2 )(1 âˆ’ ğ‘“ [1]
2 âˆ’ ğ‘“ [2]
3 âˆ’ 2(ğ‘“ [1]
2 + ğ‘“ [2]
2 )
Â¯ğ‘“ [ğ‘–]
1,2 =
Â¯ğ‘“ [ğ‘–]
1,1,2 =
Â¯ğ‘“ [ğ‘–]
1,2,2 =
2 ) + ğ‘“ [ğ‘–]
2
.
Detailed proof can refer to Theorem 5.1 and Appendix-A.
E PROOF OF THE NASH
EQUILIBRIUM (THEOREM 5.3)
Proof. To prove that there exists a Nash equilibrium, it
suffices to show âˆ‡ğ‘“ [1] (âˆ‡ğ‘“ [1] ğ‘…[1]) < 0 and âˆ‡ğ‘“ [2] (âˆ‡ğ‘“ [2] ğ‘…[2]) <
0 under the following conditions:
Therefore, there exists a unique Nash equilibrium point
since ğ‘…[1] and ğ‘…[2] are convex functions with ğ‘“ [1] and ğ‘“ [2]
respectively [36].
0 , ğ‘“ [2]
Furthermore, we use Best-response dynamics to find the
Nash equilibrium point. Specifically, we let Pool1 and Pool2
start at (ğ‘“ [1]
0 ) = ((0, 0), (0, 0)), and adjust ğ‘“ [1] and ğ‘“ [2]
to maximize ğ‘…[1] and ğ‘…[2] respectively, till ğ‘“ [1] and ğ‘“ [2]
converge. For instance, we first update ğ‘“ [1]
to maximize ğ‘…[1],
1
and then update ğ‘“ [2]
to maximize ğ‘…[2]. After that, we repeat
1
2 and ğ‘…[2] with ğ‘“ [2]
the procedures to maximize ğ‘…[1] with ğ‘“ [1]
2 ,
and so on. At ğ‘˜-th step, ğ‘“ [1]
ğ‘˜ can be represented by:
ğ‘…[1](ğ‘“ [1], ğ‘“ [2]
ğ‘˜ = arg max
ğ‘˜ and ğ‘“ [2]
ğ‘“ [2]
ğ‘˜âˆ’1),
ğ‘˜ = arg max
ğ‘˜ , ğ‘“ [2]),
ğ‘…[2](ğ‘“ [1]
ğ‘“ [1]
ğ‘“ [1]
ğ‘“ [2]
which is under the constraints in Equation (21).
The Nash equilibrium point will be found when ğ‘“ [1] and
ğ‘“ [2] converge as ğ‘˜ approaches infinity, which either satisfies
âˆ‡ğ‘“ [1] ğ‘…[1] = 0 and âˆ‡ğ‘“ [2] ğ‘…[2] = 0, or a point on a borderline
in Equation (21) which maximizes ğ‘…[1] with ğ‘“ [1] and ğ‘…[2]
(cid:3)
with ğ‘“ [2].
F BRIBERY RACING GAME
In our previous analysis, we regard the attacker races with an
â€œhonestâ€ opponent. Now we consider the opponent also carry
out bribery racing to avoid a loss. Suppose two miners ğ‘1 and
ğ‘2 fall into the â€œ0-leadâ€ racing situation. When ğ‘2 is aware of
bribes ğœ€1, he will broadcast a transaction ğ‘‡ ğ´2
ğµ which transfer
ğœ€2 from his mining reward address ğ´2 to an â€œanyone-can-
claimâ€ address ğµ as bribes. In such scenarios, bribery racing
will become a bribery racing game, and targets (venal miners)
will choose to work on a more profitable branch. Thus, the
probability of all other miners (including targets) follows ğ‘ğ‘–â€™s
branch ğ›¾ğ‘– will be an increasing function with ğœ€ğ‘– (more bribes
will bring more targets).
Now we analyze the Nash equilibrium of a bribery racing
game. Since we consider common â€œ0-leadâ€ racing scenarios,
we use the reward of the â€œforkedâ€ block as our objective
function (different from BSM or Bribery PAW which should
use the attackerâ€™s reward as the objective function). The
probability of extending ğ‘ğ‘–â€™s branch is ğ›¼ğ‘– + ğ›¾ğ‘–(1 âˆ’ ğ›¼1 âˆ’ ğ›¼2).
Therefore, ğ‘ğ‘–â€™s reward is:
ğ‘…ğ‘ğ‘– = (1 âˆ’ ğœ€ğ‘–)(ğ›¼ğ‘– + ğ›¾ğ‘–(1 âˆ’ ğ›¼1 âˆ’ ğ›¼2)),
ğ‘– âˆˆ {1, 2}.
We then use Best-response dynamics to find the Nash
equilibrium point. Let ğ‘1 and ğ‘2 start at (ğœ€1,0, ğœ€1,0) = (0, 0).
ğ‘ğ‘– will adjust ğœ€ğ‘– to maximize ğ‘…ğ‘ğ‘– as the best response to
the opponent, till ğ‘…ğ‘1 and ğ‘…ğ‘2 converge. For example, we
first update ğœ€1,1 to maximize ğ‘…ğ‘1 , and then update ğœ€2,1
to maximize ğ‘…ğ‘2 . After that, we repeat the procedures to
maximize ğ‘…ğ‘1 with ğœ€1,2 and ğ‘…ğ‘2 with ğœ€2,2, and so on. At
ğ‘˜-th step, ğœ€1,ğ‘˜ and ğœ€2,ğ‘˜ can be represented by:
ğœ€1,ğ‘˜ = arg max
ğœ€1
ğ‘…ğ‘1 (ğœ€1, ğœ€2,ğ‘˜âˆ’1),
ğœ€2,ğ‘˜ = arg max
ğœ€2
ğ‘…ğ‘2 (ğœ€1,ğ‘˜, ğœ€2).
(cid:54) ğ›¼[1] (cid:54) 1;
(cid:54) ğ›¼[2] (cid:54) 1;
2
2
1 , ğ‘“ [1]
1 , ğ‘“ [2]
0 (cid:54) ğ‘“ [1]
0 (cid:54) ğ‘“ [2]
ğ›¼[1] + ğ›¼[2] (cid:54) 1;
(cid:54) 1;
0 (cid:54) ğ‘[1]
0 (cid:54) ğ‘[1]
(cid:54) 1.
1 , ğ‘[2]
2 + ğ‘[2]
1
2
(21)
Moreover, a bribery racing game can become more inter-
esting when also considering ğ‘ğ‘– as venal miners: ğ‘ğ‘– can even
be rewarded when working on the opponentâ€™s branch. For
instance, when ğ‘1 and ğ‘2 pay too much for bribes, they will
consider working on the opponentâ€™s branch when claiming the
bribes becomes more profitable. We can use similar methods
above to analysis this situation and get the same conclusion
in most scenarios.
G BRIBERY FAW/PAW
We discuss strategies to combine bribery racing with FAW/-
PAW attacks.
Out-of-band payment. An attacker first launches FAW/-
PAW against victim pools. When â€œ0-leadâ€ racing occurs (case
4-2 in Section 5.1), the attacker directly pays the owners of
mining capacity (other miners or â€œcloud miningâ€ services
[25, 28, 32]) to work on the attackerâ€™s branch. The payment
can be made in Bitcoin or any outside (state) currency. Fur-
thermore, bribing through smart contracts [17] can also be
applied to make bribery less visible and difficult to be de-
tected (out-of-band payment can also be used to bribe pool
managers in in-band payment, which will be discussed latter).
Negative-fee mining pool. Negative-fee mining pools
provide pool miners higher rewards than honest mining to
lure miners (bribes) join in the pool [2]. When combined with
FAW attacks, an attacker works as a negative-fee mining
pool manager and announces a higher reward to encourage
miners to join in (i.e., bribing other miners). Meanwhile, the
attacker uses her loyal mining power [7] as infiltration mining
in a victim pool (different from the negative-fee mining pool).
When â€œ0-leadâ€ racing occurs (case 4-2 in Section 5.1), the
attacker can force negative-fee pool miners working on her
branch since she is the pool manager.
In-band payment. We discuss two strategies: bribing
pool manager and Eclipse attacks [11] to launch B-FAW/B-
PAW attacks via in-band payment.
First, an attacker can bribe the pool manager to choose
ğ‘‡ ğ´
ğµ . When the manager is profit-driven (only cares about the
profit of himself), he may accept the bribes and make all pool
miners encapsulate ğ‘‡ ğ´
ğµ . Since the bribery can be done via out-
of-band payment, bribing manager can be hardly detected.
However, victim pool miners can listen to the transactions
and count the number of ğ‘‡ ğ´
ğ´â€² are
received to identify the corrupted manager. Moreover, for
an honest manager, they can reject the bribes and expel the
attacker.
ğµ when both ğ‘‡ ğ´
ğµ and ğ‘‡ ğ´
Second, an attacker can launch Eclipse attacks to block
the global view of the victim pool manager [11]. With Eclipse
attacks, the attacker can filter out ğ‘‡ ğ´
ğ´â€² to ensure the pool man-
ager only sees ğ‘‡ ğ´
ğµ . However, successfully launching Eclipse
attacks against the victim pool requires a non-trivial cost.
Suppose the victim pool manager chooses to record ğ‘‡ ğ´
ğµ
instead of ğ‘‡ ğ´
ğ´â€² in B-FAW/B-PAW. An attacker will firstly en-
capsulate the bribery transaction ğ‘‡ ğ´
ğµ when calculating shares
in her infiltration mining power since â€œ0-leadâ€ racing can only
be caused by the withheld FPoWs. Second, after discovering
an FPoW, the attacker withholds the FPoW, broadcasts ğ‘‡ ğ´
ğ´â€²
in the network, and sends ğ‘‡ ğ´
ğµ to the (corrupted/eclipsed)
victim pool manager. Third, when other miners find a block,
the attacker immediately submits the withheld FPoW to the
pool manager to cause a fork. Notice that when the next
FPoW is also found by the infiltration mining, the attacker
should submit immediately to the manager immediately to
win in forks as with selfish mining. Therefore, the second
round of infiltration mining does not need to contain bribes.
Letâ€™s first consider â€œ0-leadâ€ racing in B-PAW. We first con-
sider the attacker races with other miners. When the target
accepts the bribes, the attackerâ€™s branch can be extended by
herself, victim pool miners, the target, or ğ›¾ portion of other
miners. Second, when the attacker races with the target, her
branch can be extended by herself, victim pool miners, or
ğ›¾ portion of other miners. In either scenario, the attacker
needs to pay one block of bribes. For other cases (not â€œ0-leadâ€
racing), the attackerâ€™s reward is the same as the PAW reward.
Therefore, we can derive the attackerâ€™s reward in â€œ0-leadâ€
racing.
We compare the attackerâ€™s reward with FAW, PAW, and
B-PAW (target accepting bribes) in a specific case, where the
attacker, victim pool, and target with computational power
0.1, 0.2, 0.2 respectively. The attacker will set ğœ€ = 0.02 as
bribes. We show attackerâ€™s RERs in terms of ğ›¾ in Fig. 16.
When the attacker chooses a proper ğœ€, the B-PAW reward
will be higher than both PAW and FAW reward.
Figure 16: Attackerâ€™s RERs against one pool with FAW, PAW,
and B-PAW, according to ğ›¾ when the attacker, victim pool,
and target with computational power 0.1, 0.2, 0.2 respec-
tively.
H ORIENTED BRIBERY ATTACKS
The original bribery attacks adopt transactions with scripts
allowing anyone to claim the bribes. It may result in many
targets race to claim the funds. A large pool may not willing
to compete with other solo miners for the bribes. Besides,
original bribery attacks cannot control the size of target
pools. To overcome these limitations, we suggest that the
attacker create transactions (ğ‘‡ ğ´
ğµğ‘– ) to specific targets (ğµğ‘–) in
her private chain and spend the bribes on the public chain.
Since creating a transaction only needs the public key of the
receiver (i.e., hash of ğµğ‘–â€™s public key), ğ‘‡ ğ´
ğµğ‘– can be created
without the confirmation of ğµğ‘–. The targets will get the
bribes automatically when the attackerâ€™s branch is selected
as the main chain (without competing with other miners). To
obtain the public key, the attacker can join in the target pool
or just check out the previously mined blocks by the target
(the hash of the public key is included in the transaction
to claim the system reward, and is accessible for anyone).
Attackers can also use the oriented bribery attacks to lure
better targets with higher bribes.
00.10.20.30.40.50.60.70.80.910.511.522.53Extra Relative Revenue (%)B-PAWPAWFAW