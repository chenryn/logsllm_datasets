# 浅析ASN在信息收集中的作用

## 0x0 前言
自治系统号（ASN）是网络通信中的一个重要概念，尽管很多人在大学期间可能接触过这个术语，但对其具体应用和重要性了解不多。本文旨在深入浅出地介绍ASN及其在信息收集方面的用途。

## 0x1 什么是ASN
### 定义
自治系统编号（Autonomous System Number, ASN）是一个全球唯一的标识符，允许其自治系统与其他系统交换路由信息。
- 格式：由16位组成（2字节），范围为1-65535。
- 分配机构：由区域互联网注册机构（RIRs）管理和分配。
- 全球共有五个RIRs：
  - ARIN（北美、南极洲及部分加勒比地区）
  - RIPE NCC（欧洲、中东和中亚）
  - APNIC（亚洲和太平洋地区）
  - LACNIC（拉丁美洲及部分加勒比地区）
  - AfriNIC（非洲）

### 申请条件
原则上任何人都可以向这些组织申请ASN，但实际上需要满足一定的条件。例如，在亚太地区，APNIC有详细的申请要求。

## 0x2 什么是自治系统？
自治系统（Autonomous System, AS）是由统一路由策略管理的大型网络或网络群组。每个AS控制一组特定的IP地址空间，并通过边界网关协议（BGP）与其他AS进行通信。

### 自治系统的连接方式
- **BGP**：主要用于互联网AS之间的互联，主要功能在于控制路由的传播和选择最佳路径。
- **BGP线路**：通过BGP协议，提前将用户切换到最优线路，从而提高访问速度。例如，电信、联通等运营商提供的多线BGP服务。

## 0x3 信息收集与ASN
### ASN与IP的关系
- IP与ASN之间存在多对多关系，一个IP可能属于多个ASN。
- 查询方法：可以通过相关地区的注册机构官网查询，如APNIC的公共搜索库。

### 实例分析
以腾讯服务器为例，通过SPYSE查询IP 111.2x0.1x7.xx...的信息，发现其属于ASN 45090，归属于深圳腾讯计算机系统有限公司。

### ASN与目标的关联关系
- 如果目标使用的是云厂商的IP，则可能没有独立的ASN编号。
- 通过ASN进行大范围探测时，如果目标拥有自己的ASN编号和外网IP地址，效果会更好。
- 对于中小型企业，通常将其服务器托管给第三方云服务商，此时直接聚合子域名IP做C段查询更为有效。

## 0x4 实践应用
### 示例
假设有一个支持IP访问的站点，根据该IP查询相应的ASN。例如，某组织的一个站点IP对应的ASN为4134，统计出的CIDR块为61.164.192.0/20。可以通过工具如httpx进行进一步探测：

```bash
cidr 61.164.192.0/20 | httpx --title --status-code --threads 200
```

### 结果
通过这种探测方法，可以发现一些相关的站点和端口信息，有助于进一步的信息收集。

## 0x5 总结
本文介绍了ASN的基本概念及其在信息收集中的应用。虽然ASN的应用场景有限，但对于某些特定情况下的信息收集非常有用。希望读者能结合实际情况，灵活运用这些知识。

## 0x6 参考链接
- [BGP (1) 注册 ASN & 获取 IPV6 地址](https://blog.yuzu.im/marchives/132)

希望这篇文章能帮助大家更好地理解ASN及其在信息收集中的作用。欢迎各位同行提出宝贵意见。