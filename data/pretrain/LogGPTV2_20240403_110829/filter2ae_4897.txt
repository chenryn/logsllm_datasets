### 项目背景与起因
此次项目的启动较为简单，主要是出于对内网渗透技术的练习需求。简而言之，可以概括为“闲得慌”。

### 目标定位与初步探索
为了快速找到合适的目标，我使用了fofa工具批量搜索WebLogic服务器，并迅速锁定了一个目标。通过初步查看该机器环境，发现其具备出网能力、未安装主流杀毒软件（后发现存在一款小众防火墙，但不拦截Powershell），且处于内网环境中。

### 初步入侵尝试
鉴于上述条件，决定采用Cobalt Strike自带的Scripted Web Delivery模块来创建web服务，用于自动下载并执行Powershell脚本。成功运行生成的Powershell代码后，Cobalt Strike控制台显示已成功上线。

#### 系统信息获取
- **操作系统**：Windows Server 2012
- **内网IP段**：192.168.200.x

### 内网探测
利用Ladon工具扫描整个内网环境，发现少量主机及域控环境的存在。进一步检测表明，该内网拥有多个网段，并且其中一台主机开启了Web服务。

#### 用户凭证提取
- 使用mimikatz读取到单一用户的加密密码。
- 通过CMD5在线平台解密该密码。

### MS17-010漏洞利用尝试
在确认部分主机可能存在MS17-010漏洞后，计划使用Metasploit框架进行攻击。但由于最初选择的香港服务器带宽过低（仅1M），导致CS自带Socks代理无法正常使用。因此，临时启用了一台按需付费的高带宽服务器，并借助EarthWorm (EW) 工具重新搭建隧道连接以绕过网络限制。

### 内网横向移动
尽管尝试了多种方法包括弱口令注入等均未能取得突破，最终通过对共享文件夹的访问找到了突破口——一台名为veeam backup的备份服务器。在其D盘中发现了Veeam® Backup & Replication软件创建的多台机器备份文件。

### 攻击策略调整
考虑到这台备份服务器可能存储着重要数据，决定采取以下步骤：
1. 在本地安装Veeam® Backup & Replication软件。
2. 将目标DC的全量备份压缩并通过Web路径下载至本地。
3. 恢复成虚拟机形式，在PE环境下修改系统命令行权限。
4. 通过PTH技术获取域内用户HASH值，进而接管线上DC。

### 结论
经过一系列复杂操作后，最终成功实现了对目标系统的完全控制。尽管过程中遇到了诸多挑战如低带宽限制、防火墙干扰等问题，但通过灵活运用各种技术和工具，最终达成了预期目标。此案例充分展示了网络安全领域中攻防双方博弈的激烈程度以及不断学习新技术的重要性。