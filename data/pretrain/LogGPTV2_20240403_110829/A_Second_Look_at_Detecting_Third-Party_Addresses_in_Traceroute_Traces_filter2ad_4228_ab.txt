TCP-ack, and UDP probes (in that order) to maximize our potential to infer
pt2pt links. We use this ordering because in previous cross-validation eﬀorts, we
found this order to produce the most accurate inferences [13]. We believe our
pt2pt inferences are robust because other researchers have previously validated
IPID-based alias inferences [19,5,10].
Table 1 lists the eight CAIDA Archipelago (Ark) vantage points (VPs) we
use for our study. We chose the eight VPs that were operational on 2 Septem-
ber 2013 that also provide a complete BGP view publicly. We chose these VPs
because we could also evaluate traceroute-inferred and BGP-observed AS path
50
M. Luckie and k. claﬀy
Table 1. To support future study of traceroute and BGP incongruities, we chose for
our measurement study 8 Ark VPs that also provide a complete BGP view publicly
Ark VP Hosting Network (AS)
ams3-nl RIPE NCC (3333)
gva-ch IP-Max SA (25091)
nrt-jp APAN (7660)
per-au AARnet (7575)
sin-sg DCS1 Pte Ltd (37989)
syd-au AARnet (7575)
sql-us
zrh2-ch Kantonsschule Zug (34288) RIPE rrc12 (80.81.194.119)
Public BGP view (peer IP)
RIPE rrc00 (193.0.0.56)
RIPE rrc04 (192.65.185.244)
Routeviews 2 (203.181.248.168)
Routeviews ISC (198.32.176.177)
RIPE rrc00 (203.123.48.6)
Routeviews ISC (198.32.176.177)
RIPE rrc14 (198.32.176.3)
ISC (1280)
incongruities on pt2pt links, shedding further light on how incongruities from
on-path addresses arise in practice. We leave this analysis for future work and
invite the research community to study this problem further using these VPs.
From each VP, we randomly chose 10,000 destinations that quoted a probe’s
IP options in an ICMP destination unreachable message; these destinations were
useful because they quote the IP options (step 1 in ﬁgure 1). Each VP randomly
selected a diﬀerent set of destinations to probe. To maximize our chances of
selecting useful destinations, we selected the 2.5M of the 14.5M addresses in
the ISI hitlist [1] with a score of at least 80 (where 99 represents an address
that has always responded to ISI’s ICMP echo probes [8]). Despite selecting
destinations that were generally responsive to ping, we found that only 15.1% to
18.8% (depending on the VP) responded and echoed the pre-speciﬁed timestamp
option; i.e. we tried between 53K and 66K addresses to obtain 10,000 useful
destinations. Of the destinations that were not useful because we did not receive
a response with a quote of the IP options, only 3.5% to 5.9% did not quote the
timestamp option; another 94.1% to 96.5% of them did not respond at all. When
we probed the same destinations without the timestamp option, 36.4% to 36.8%
responded, implying that including a timestamp option in a UDP probe reduced
the fraction of responsive destinations by at least half.
Overall, we obtained 80,004 traces containing 150,188 IP addresses, inferring
197,335 IP-level links between 7,401 ASes. Many IP interfaces are observed from
multiple VPs; in our dataset, we observed 28.0% of interfaces (IP addresses) from
at least two VPs even though we only used eight VPs total. We received responses
to ICMP B|BBBB probes from 119,594 interfaces. For the 30,594 (25.6%) inter-
faces for which we received responses to ICMP B|BBBB probes from more than
one VP, all VPs observed the same timestamp behavior except for 538 interfaces
(1.8%). 324 of these (60.2%) were in one AS, suggesting routers in our data
behaved the same regardless of probing location for ICMP B|BBBB probes. For
each VP, the technique from [14] classiﬁed between 42.5% and 47.3% of inter-
faces in our data as appearing as on-path or oﬀ-path because they responded
with 1-3 timestamps when we probed them with ICMP B|BBBB packets. In
total, 77,348 of the 150,188 (51.5%) interfaces observed in our data embedded
1-3 timestamps when we probed them with ICMP B|BBBB probes.
A Second Look at Detecting Third-Party Addresses in Traceroute Traces
51
F
D
C
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
prefixscan N=86152
pairwise N=81315
50%: 42
50%: 75
 10
IP−ID difference (log scale)
 100
 1000
Fig. 2. IPID diﬀerences between inferred aliases A and A
. The smaller the diﬀerence,
the more likely the alias inference is reliable. In our pairwise measurements, we rejected
4,837 initial pt2pt link inferences because either the IPIDs did not monotonically in-
crease, or the counters increased too fast to reliably infer aliases. Of the 81K links
remaining, 33% of the IPID values were strictly incremented between alias pairs.
(cid:2)
We resolved the IP-level links to AS-level links using the longest matching
preﬁx observed by peers at RouteViews; 31K (15.8%) have addresses that map
to two diﬀerent ASes (are inter-AS links), 153K (77.8%) have addresses that map
to a single AS (are links internal to an AS), and 13K (6.4%) have addresses that
are either not announced publicly, or whose longest matching preﬁx is originated
by multiple ASes. In total, we infer 10,175 AS-level links from these traces. Of
the 197,335 IP-level links, we inferred a /30 or /31 link for 86,152 links with
an initial preﬁxscan; our followup pairwise measurements discarded 5K links
because the returned IPID sequence did not meet our requirements, leaving us
with 81,315 pt2pt links. Figure 2 shows the IPID diﬀerences where aliases were
(cid:3)
. The solid line corresponds to the initial preﬁxscan
inferred between A and A
(cid:3)
as an alias of A; we plotted
measurement that inferred a /30 or /31 mate A
the maximum IPID diﬀerence between any two samples in the sequence of ﬁve
probes. 50% of the samples had a maximum diﬀerence of 75. The dashed line
corresponds to the subsequent pairwise measurements; for each inferred alias, we
plotted the minimum IPID diﬀerence between responses from the same probed
address; i.e. the alias’ IPID had to ﬁt within the two IPID values. 50% of the
samples had a minimum diﬀerence of 42, and 33.2% had a minimum diﬀerence of
2; in these latter cases the IPID of the alias fell immediately between a monotonic
sequence. We therefore believe most of our pt2pt inferences are robust.
3 Results
In this section, we focus on addresses in traceroute paths that we inferred to be
the address of the in-bound interface on a router and visited across a pt2pt link
(i.e. were on-path). Of the 197,335 IP-level links, we inferred 81,315 (41.2%) to
be pt2pt. Figure 3 plots the distribution of the fraction of in-bound interfaces in
traceroutes observed by each VP. In our data, we inferred that more than half
52
M. Luckie and k. claﬀy
d
n
u
o
b
n
i
f
o
n
o
i
t
c
a
r
F
s
h
t
a
p
n
i
s
e
c
a
f
r
e
t
n
i
 1
 0.8
 0.6
 0.4
 0.2
 0
ams3−nl gva−ch
nrt−jp
per−au
sin−sg
sql−us
syd−au zrh2−ch
Ark VP
Fig. 3. Distribution of the fraction of in-bound interfaces observed by each VP at the
2nd, 25th, 50th, 75th, and 98th percentiles. For 7 of the 8 VPs, more than half of the
interfaces in paths represent the in-bound interface for at least half of their traceroutes.
Table 2. Consistency of timestamps embedded by interfaces that we infer to be the in-
bound interface on a pt2pt link. Between 70.9% and 74.6% of interfaces do not insert
a timestamp despite being on-path. Between 1.0% and 1.5% of interfaces behaved
diﬀerently depending on the destination probed (mixed column).
VP
1-3 TS
(on-path)
Zero TS
(oﬀ-path)
4 TS
mixed
(juniper)
ams3-nl 1631 (26.1%) 4550 (72.8%) 1 (0%) 64 (1.0%)
gva-ch 1678 (26.4%) 4600 (72.3%) 0 (0%) 83 (1.3%)
nrt-jp
1543 (27.6%) 3958 (70.9%) 1 (0%) 84 (1.5%)
per-au 1547 (24.8%) 4610 (73.8%) 2 (0%) 89 (1.4%)
sin-sg
1649 (25.8%) 4657 (72.9%) 0 (0%) 80 (1.3%)
sql-us
1583 (24.8%) 4698 (73.7%) 1 (0%) 90 (1.4%)
syd-au 1524 (24.0%) 4731 (74.6%) 0 (0%) 91 (1.4%)