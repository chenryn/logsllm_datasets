(rank 22) likewise requires greater expense due to paying in advance
for multi-year terms. Verisign charges a $7.85 annual fee to registrars
for each .com domain registration [58]. Miscreants can get low prices
close to this amount from registrars afﬁliated with scam activities
(e.g., ABSystems [50]) or registrars offering cheap prices/discounts.
If miscreants switch to the largest registrar GoDaddy, with an annual
price of $12.99 [17]; register in small batches without taking any
bulk discount; and commit to a 2-year registration term then the price
$7.85 × 2 ≈ 3.3 times of the price that miscreants
per domain rises $12.99
originally pay.
Evading by decreasing volume. Evading some of the PREDATOR
features constrains the volume of names that miscreants can easily
register. In an attempt to evade the life-cycle proportion features
(rank 14–16), miscreants may mix different life-cycle types of do-
mains in the same registration batch. However, this will require
incorporating multiple methods to generate domain names, increasing
management effort. Moreover, we observe that spammer domains pos-
sess a lower brand-new proportion (66%) than non-spammer domains
(77%). Given the same quantity of generated brand-new names, mis-
creants need to reduce re-registration domains to mimic the life-cycle
proportions of general domains. We have
100%−A% = 77%. Solv-
ing for A, this yields that miscreants must alter 14% of their domain
registrations to simulate benign behaviors. Note that this estimate
demonstrates the impact to evade a single feature. To change other
behaviors, such as the aforementioned lexical or registrar features,
miscreants may have to further cut their domain registrations to small
volumes. Another feature is the dormancy period for re-registration
domains (rank 9). Domains re-registered by miscreants are often
66%
False positive (%)0102030405060708090100True positive (%)0102030405060708090100All featuresExclude all nameserver-related featuresExclude all nameserver-related & lexical featuresExclude all nameserver-related & lexical & batch featuresOnly registrar feature00.511.522.533.544.55020406080100those that expired more recently, presumably because miscreants
actively mine expired domains. Evading the dormancy period feature
forces miscreants to wait longer to register expired domains, which in
turn limits the domains miscreants can use over a given period.
In general terms, evasion attempts considerably increase economic
and management costs for attackers; PREDATOR raises the bar for
miscreants to acquire and proﬁtably use the domains. The combina-
tion of the features is effective to detect malicious domains. Altering
one or two features will not signiﬁcantly aid miscreants to ﬂy under
the radar.
8. DISCUSSION
In this section, we discuss possible deployment scenarios, as well
as some limitations of our work.
Deployment scenarios. Network operators and security practition-
ers can beneﬁt from PREDATOR in the following ways. (1) Network
operators can take appropriate actions to protect their networks and
users. For example, email servers can greylist [34] (i.e., temporarily
reject) emails that PREDATOR predicts as suspicious and request
the originating servers to try again after a period. Legitimate senders
are expected to resend the emails, while spammers usually do not
properly handle retries [36]. Meanwhile, network operators can
collect more evidence before retry attempts to make ﬁnal decisions,
such as examining the Web content on the domain. (2) Registries
or registrars can require more strict documentation or veriﬁcation
(e.g., validation of payment instruments or inquiring the domain
purpose), before they approve registrations of domains with low
reputation scores. Mitigating domain abuse is consistent with the
registrars’ responsibilities under the ICANN’s Registrar Accreditation
Agreement [26] (some registrars have taken important roles [8, 21]),
and it can also help to identify and deter the illegal registrations
with stolen credit cards [11, 14] (which cause loss from registrars,
including refunds and chargeback fees). (3) Law enforcement and
cyber-security professionals can prioritize their investigations (for
time/resource-consuming analysis, e.g., crawling the page content or
repeated manual investigation by an analyst) and proactively monitor
low-reputation domains, since the domains selected by PREDA-
TOR are more likely to prove malicious. (4) Operators could also
incorporate PREDATOR into other detection systems (e.g., spam
ﬁlters, botnet detection systems) by using it to provide an additional
“conﬁdence score” of registration to help them determine whether a
particular domain appears malicious.
Limitations and future work. Given that domain registrations
under a single zone provide centralized observation opportunities,
miscreants may register domains across different TLDs, especially
with the expansion of large numbers of new TLDs [27]. Thus, one
direction for future work is incorporating cross-zone features into the
classiﬁcation model. Although PREDATOR is somewhat resistant
to evasion, designing a more robust system against the attackers’
continual attempts to mislead or evade the classiﬁer is a promising
area for future work. While our approach achieves good accuracy,
for higher detection rates the false positive rates increase as well.
Another area for improvement is combining post-registration detection
techniques, such as DNS monitoring or Web crawling, to develop
hierarchical decision-making mechanisms for higher accuracy.
9. RELATED WORK
We compare previous work on analyzing and detecting domains
and URLs that are used in illicit online activities.
DNS-based detection. Most previous DNS-based detection studies
focused on analyzing lookup trafﬁc. Notos [3] and EXPOSURE [5]
leverage trafﬁc from local recursive DNS servers to establish domain
reputations. Gao et al. used temporal correlation in DNS queries
to detect malicious domain groups [16]. Various previous work has
analyzed DNS trafﬁc to detect fast-ﬂux domains [24, 44], or malware
domains exploiting resource records (e.g., TXT records) as the com-
munication channels [9, 31, 66]. Other work inspects DNS trafﬁc
close to top-level domain servers to detect abnormal activity [4, 19].
In contrast, PREDATOR derives domain reputation using registration
features to enable early detection, without monitoring DNS trafﬁc.
Registration and domain market. Recent research has paid atten-
tion to the registrars, registries, and the domain market, including
domain-name speculation, typosquatting, and domain parking [1, 2, 7,
54, 61]. Liu et al. found that registry policy changes and registrar-level
takedown had at least temporary effects in deterring spam-advertised
domains [37]. Felegyhazi et al. investigated registration information
to extrapolate malicious domains from speciﬁc instances of known-
bad domains, primarily relying on the properties of DNS servers [13].
Hao et al. measured and modeled domain registrations of spammer
domains [20]. While their work only presents preliminary measure-
ment results and does not examine how to leverage the ﬁndings for
detection, it hints at the potential of building a registration-based
reputation system. We designed PREDATOR just for that purpose, to
accurately detect spammer domains at time-of-registration, and our
work studied signiﬁcantly more features.
Website and URL detection. A conventional technique to detect
malicious Web pages is through automatic URL crawling tools. The
detection can be based on the page content [43, 57], the presence of
cloaking and redirection [35, 62], or the link structure leading to the
pages [64]. Thomas et al. built a large-scale system to crawl URLs
in email and Twitter feeds to detect malicious messages [55]. Our
study is orthogonal to Web crawling methods, and does not require
page visits. The output of PREDATOR can help with prioritizing
what suspect sites to crawl and inspect. A related approach is to use
various lexical and host-based features of the URL for detection, but
exclude Web page content [38, 39, 65]. These detection methods
require waiting until miscreants use the URLs for attacks. Our work,
on the other hand, provides proactive detection of domains before
malicious URLs propagate on the Internet.
10. CONCLUSION
Because determining the reputation of DNS domains can signiﬁ-
cantly aid in defending against many Internet attacks, establishing
DNS domain name reputation as quickly as possible provides major
beneﬁts. Whereas existing DNS reputation systems establish do-
main reputation based on features evident after the domain is in use,
PREDATOR can accurately establish domain reputation at the time
of domain registration, before domains ever see use in attacks. Our
results show that PREDATOR can provide more accurate and earlier
detection compared to existing blacklists, and signiﬁcantly reduce the
number of suspicious domains requiring more resource-intensive or
time-consuming inspection.
Acknowledgments
We thank the anonymous reviewers for their valuable comments.
We also thank Christopher Kruegel, Kevin Borgolte, and Jennifer
Rexford for many helpful suggestions and discussions to improve
the paper. This work was supported in part by the National Science
Foundation awards CNS-1237265, CNS-1535796, CNS-1540066,
and by a gift from Google. Any opinions, ﬁndings, and conclusions or
recommendations expressed in this material are those of the authors
and do not necessarily reﬂect the views of the sponsors.
References
[1] P. Agten, W. Joosen, F. Piessens, and N. Nikiforakis. Seven Months’ Worth of
Mistakes: A Longitudinal Study of Typosquatting Abuse. In Network and
Distributed System Security Symposium (NDSS), Feb. 2015.
[2] S. Alrwais, K. Yuan, E. Alowaisheq, Z. Li, and X. Wang. Understanding the
Dark Side of Domain Parking. In 23rd USENIX Security Symposium, Aug.
2014.
[3] M. Antonakakis, R. Perdisci, D. Dagon, W. Lee, and N. Feamster. Building a
Dynamic Reputation System for DNS. In 19th USENIX Security Symposium,
Aug. 2010.
[4] M. Antonakakis, R. Perdisci, W. Lee, N. Vasiloglou, and D. Dagon. Detecting
Malware Domains at the Upper DNS Hierarchy. In 20th USENIX Security
Symposium, Aug. 2011.
[5] L. Bilge, E. Kirda, C. Kruegel, and M. Balduzzi. EXPOSURE: Finding
Malicious Domains Using Passive DNS Analysis. In Network and Distributed
System Security Symposium (NDSS), Feb. 2011.
[6] R. Braden. Requirements for Internet Hosts – Application and Support. Internet
Engineering Task Force, Oct. 1989. RFC 1123.
[7] S. E. Coull, A. M. White, T.-F. Yen, F. Monrose, and M. K. Reiter.
Understanding Domain Registration Abuses. In 25th International Information
Security Conference, Sept. 2010.
[8] Demand Media. eNom and LegitScript LLC Announce Agreement to Identify
Customers Operating Illegal Online Pharmacies.
http://www.businesswire.com/news/home/20100921005657/en/, 2010.
[9] C. J. Dietrich, C. Rossow, F. C. Freiling, H. Bos, M. van Steen, and
N. Pohlmann. On Botnets that use DNS for Command and Control. In
European Conference on Computer Network Defense, Sept. 2011.
[10] DomainTools. http://www.domaintools.com, 2015.
[11] S. Ellis. Business Email Compromise Scams on the Rise.
http://www.markmonitor.com/mmblog/business-email-compromise-scams/,
2015. MarkMonitor Blog.
[12] R. Fan, K. Chang, C. Hsieh, X. Wang, and Lin. LIBLINEAR : A Library for
Large Linear Classiﬁcation. The Journal of Machine Learning Research,
9(2008):1871–1874, 2008.
[13] M. Felegyhazi, C. Kreibich, and V. Paxson. On the Potential of Proactive
Domain Blacklisting. In 3rd USENIX Workshop on Large-Scale Exploits and
Emergent Threats (LEET), Apr. 2010.
[14] P. Festa. Identity Thieves Strike eBay.
http://www.cnet.com/news/identity-thieves-strike-ebay/, 2012. CNET.
[15] I. Fette, N. Sadeh, and A. Tomasic. Learning to Detect Phishing Emails. In
16th International Conference on World Wide Web (WWW), May 2007.
[16] H. Gao, V. Yegneswaran, Y. Chen, P. Porras, S. Ghosh, J. Jiang, and H. Duan.
An Empirical Reexamination of Global DNS Behavior. In ACM SIGCOMM,
Aug. 2013.
[17] Godaddy Bulk Registration Prices.
http://www.godaddy.com/domains/searchbulk.aspx, 2014.
[18] C. Grier, K. Thomas, V. Paxson, and M. Zhang. @spam: The Underground on
140 Characters or Less. In 17th ACM Conference on Computer and
Communications Security (CCS), Oct. 2010.
[19] S. Hao, N. Feamster, and R. Pandrangi. Monitoring the Initial DNS Behavior of
Malicious Domains. In ACM Internet Measurement Conference (IMC), Nov.
2011.
[20] S. Hao, M. Thomas, V. Paxson, N. Feamster, C. Kreibich, C. Grier, and
S. Hollenbeck. Understanding the Domain Registration Behavior of Spammers.
In ACM Internet Measurement Conference (IMC), Oct. 2013.
[21] K. J. Higgins. Google, GoDaddy Help Form Group To Fight Fake Online
Pharmacies. http://www.darkreading.com/d/d-id/1134946, 2010. Dark
Reading.
[22] S. Hollenbeck. VeriSign Registry Registrar Protocol Version 2.0.0. Internet
Engineering Task Force, Nov. 2003. RFC 3632.
[23] S. Hollenbeck. Extensible Provisioning Protocol. Internet Engineering Task
Force, Aug. 2009. RFC 5730.
[24] T. Holz, C. Gorecki, K. Rieck, and F. C. Freiling. Measureing and Detecting
Fast-Flux Service Networks. In Network and Distributed System Security
Symposium (NDSS), Feb. 2008.
[25] IANA. Root Zone Database. http://www.iana.org/domains/root/db, 2016.
[26] ICANN. Registrar Accreditation Agreement (Section 3.18).
https://www.icann.org/resources/pages/approved-with-specs-2013-09-17-en,
2013.
[27] ICANN. Delegated Strings of New TLDs.
http://newgtlds.icann.org/en/program-status/delegated-strings, 2015.
[28] Internet Archive. http://archive.org, 2015.
[29] iPlane. http://iplane.cs.washington.edu/data/data.html, 2015.
[30] A. Kantchelian, M. C. Tschantz, P. L. B. Ling Huang, A. D. Joseph, and J. D.
Tygar. Large-Margin Convex Polytope Machine. In Neural Information
Processing Systems (NIPS), Dec. 2014.
[31] A. M. Kara, H. Binsalleeh, M. Mannan, A. Youssef, and M. Debbabi. Detection
of Malicious Payload Distribution Channels in DNS. In Communication and
Information Systems Security Symposium, June 2014.
[32] J. Klensin. Internationalized Domain Names for Applications (IDNA):
Deﬁnitions and Document Framework. Internet Engineering Task Force, Aug.
2010. RFC 5890.
[33] C. Kreibich, C. Kanich, K. Levchenko, B. Enright, G. M. Voelker, V. Paxson,
and S. Savage. Spamcraft: An Inside Look At Spam Campaign Orchestration.
In 2nd USENIX Workshop on Large-Scale Exploits and Emergent Threats
(LEET), Apr. 2009.
[34] M. Kucherawy and D. Crocker. Email Greylisting: An Applicability Statement
for SMTP. Internet Engineering Task Force, June 2012. RFC 6647.
[35] N. Leontiadis, T. Moore, and N. Christin. Measuring and Analyzing
Search-Redirection Attacks in the Illicit Online Prescription Drug Trade. In
20th USENIX Security Symposium, Aug. 2011.
[36] P. Lieven, B. Scheuermann, M. Stini, and M. Mauve. Filtering Spam Email
Based on Retry Patterns. In IEEE International Conference on
Communications (ICC), June 2007.
[37] H. Liu, K. Levchenko, M. Felegyhazi, C. Kreibich, G. Maier, G. M. Voelker,
and S. Savage. On the Effects of Registrar-level Intervention. In 4th USENIX
Workshop on Large-Scale Exploits and Emergent Threats (LEET), Mar. 2011.
[38] J. Ma, L. K. Saul, S. Savage, and G. M. Voelker. Beyond Blacklists: Learning
to Detect Malicious Web Sites from Suspicious URLs. In 15th ACM SIGKDD
International Conference on Knowledge Discovery and Data Mining (KDD),
June 2009.
[39] J. Ma, L. K. Saul, S. Savage, and G. M. Voelker. Identifying Suspicious URLs:
An Application of Large-Scale Online Learning. In 26th International
Conference on Machine Learning (ICML), June 2009.
[40] P. V. Mockapetris. Domain Names - Concepts and Facilities. Internet
Engineering Task Force, Nov. 1987. RFC 1034.
[41] Moniker Bulk Registration Discounts.
http://www.moniker.com/service/discounts, 2014.
[42] NameJet Domain Name Aftermarket.
http://www.namejet.com/pages/downloads.aspx, 2015.
[43] A. Ntoulas, M. Najork, M. Manasse, and D. Fetterly. Detecting Spam Web
Pages through Content Analysis. In 15th International Conference on World
Wide Web (WWW), May 2006.
[44] R. Perdisci, I. Corona, D. Dagon, and W. Lee. Detecting Malicious Flux
Service Networks through Passive Analysis of Recursive DNS Traces. In 25th
Annual Computer Security Applications Conference (ACSAC), Dec. 2009.
[45] Annual Price $8.49 for .com at INTERNET.bs. http://internetbs.net/, 2015.
[46] Annual Price $24.95 for .com at DomainPeople.
http://www.domainpeople.com/domain-names/pricing.html, 2015.
[47] S. Shalev-Shwartz, Y. Singer, and N. Srebro. Pegasos: Primal Estimated
sub-GrAdient SOlver for SVM. In 24th International Conference on Machine
Learning (ICML), June 2007.
[48] McAfee SiteAdvisor. https://www.siteadvisor.com/.
[49] Spamhaus. http://www.spamhaus.org/.
[50] Spamhaus. ABSystems Domain Registrar De-accredited.
http://www.spamhaus.org/rokso/evidence/ROK10342/, 2013.
[51] Spamhaus. Can Registrars Suspend Domains for Spam and Abuse?
https://www.spamhaus.org/faq/section/Generic%20Questions#127, 2015.
[52] B. Stone-Gross, R. Abman, R. Kemmerer, C. Kruegel, D. Steigerwald, and
G. Vigna. The Underground Economy of Fake Antivirus Software. In 10th
Workshop on Economics of Information Security (WEIS), June 2011.
[53] Symantec. Rise in URL Spam.
http://www.symantec.com/connect/blogs/rise-url-spam, 2013.
[54] J. Szurdi, B. Kocso, G. Cseh, J. Spring, M. Felegyhazi, and C. Kanich. The
Long “Taile” of Typosquatting Domain Names. In 23rd USENIX Security
Symposium, Aug. 2014.
[55] K. Thomas, C. Grier, J. Ma, V. Paxson, and D. Song. Design and Evaluation of
a Real-Time URL Spam Filtering Service. In 32rd IEEE Symposium on
Security and Privacy, May 2011.
[56] URIBL. http://www.uribl.com/.
[57] T. Urvoy, E. Chauveau, P. Filoche, and T. Lavergne. Tracking Web Spam with
HTML Style Similarities. ACM Transactions on the Web, 2(1):3:1–3:28, 2008.
[58] Verisign. Verisign Announces Increase in .com/.net Domain Name Fees.
https://investor.verisign.com/releasedetail.cfm?releaseid=591560, 2011.
[59] Verisign Domain Countdown. http://domaincountdown.verisignlabs.com, 2011.
[60] Verisign. The Domain Name Industry Brief.
http://www.verisign.com/assets/domain-name-brief-dec2012.pdf, 2012.
[61] T. Vissers, W. Joosen, and N. Nikiforakis. Parking Sensors: Analyzing and
Detecting Parked Domains. In Network and Distributed System Security
Symposium (NDSS), Feb. 2015.
[62] D. Y. Wang, S. Savage, and G. M. Voelker. Cloak and Dagger: Dynamics of
Web Search Cloaking. In 18th ACM Conference on Computer and
Communications Security (CCS), Oct. 2011.
[63] Who.is. http://who.is/domain-history, 2015.
[64] B. Wu and B. D. Davison. Identifying Link Farm Spam Pages. In 14th
International Conference on World Wide Web (WWW), May 2005.
[65] Y. Xie, F. Yu, K. Achan, R. Panigrahy, G. Hulten, and I. Osipko. Spamming
Botnets: Signatures and Characteristics. In ACM SIGCOMM, Aug. 2008.
[66] K. Xu, P. Butler, and D. Yao. DNS for Massive-Scale Command and Control.
IEEE Transactions on Dependable and Secure Computing (TDSC),
10(3):143–153, 2013.