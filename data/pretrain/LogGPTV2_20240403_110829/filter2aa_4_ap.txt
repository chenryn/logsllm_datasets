To add to Professor Caildini's six principles of persuasion, when you are crafting a social engineering campaign, there are six human truths I have learned over the past 20 years. These have helped me social engineer both professionally and personally.
Most people want to be helpful.
Humans want instant gratification.
Never use the words “obviously” and “but.”
The brain wants ease and order and dislikes change.
Most people, including my students, have a limited attention span.
Humans respond to beauty and emotion.
Men have dominated my cybersecurity classes over the past 20 years. I have not kept up with the numbers, but in my personal experience, I'm lucky to have one female in up to 20 men in a technical class. Men dominate the ranks of developers, administrators, researchers, and hackers. Chris Hadnagy of Social‐Engineer.org and one of my favorite authors says, “Unfortunately, there is a chauvinist consensus that females don't get security. The truth is, as social engineers, women do better. We've seen hacktivists like Anonymous and LulzSec use females as part of their attacks.”
David Kennedy, founder of TrustedSec and DerbyCon, says because of this attitude in our culture, women aren't thought to be technical or disingenuous. He also says it is helpful to have a Southern accent. A Southern accent is synonymous with warmth and hospitality, whereas a New York accent can be fast and harsh. It is my goal one day to participate in the Social Engineering CTF in Vegas. As a technically adequate female who was born and raised in Louisiana, I feel that I have a bit of an advantage, especially if I ask for help. I have had the doors held for me in a secure location because I had my arms full of books, ignoring the RFID badge reader and the mantrap.
Humans want instant gratification. We are hardwired to want what we want without any delay or denial. It's evolutionary. Humans survive when they take the smaller reward but skip the bigger yet delayed reward. If you have children, experiment with them. They can have this one marshmallow now, but if they can wait 5 minutes, they can have two. Mine never wait for two.
I met Deidre Diamond about a year ago when she gave the keynote at EC Councils Hacker Halter conference in Atlanta. In her keynote, she said we have to choose our words with care. There was a list of several words you ought not to use, but the two that burned into my brain are “obviously” and “but.” Try using “obviously” in a sentence and not sound condescending. If you are attempting a role that is arrogant or patronizing, by all means it might work for you. She also suggested using “and” instead of “but.” No one hears anything past “but.” “I love this idea, but can we do this instead?” That sentence sounds a lot different than “I love this idea, and what do you think about this instead?” “But” will start an argument or stop the conversation. “And” will engage.
The brain wants ease and order and dislikes change. I think this becomes even more pronounced the older we get. If you are attempting a social engineering campaign, you have to build it around something that is believable and not out of the ordinary.
Most people, including my students, have a limited attention span. When I was studying for my CompTIA Certified Technical Trainer certification, my instructor told the class that we had 20 minutes to engage students with a lecture before they started thinking about what was for dinner or what movie they were going to this weekend. If you need someone's attention for more than 20 minutes, you will have to change the delivery. In training, we can show a video or give a hands‐on exercise. In penetration testing, you don't normally want a long personal engagement. You want to get in, do what you need to do, and get out.
Humans respond to beauty and emotion. I believe this is self‐explanatory. People are attracted to what they find beautiful or what makes them feel great emotion. The movie Oceans 8 made me chuckle when Rhianna social‐engineered the video security engineer with a compromised site about the Wheaten breed of dogs. I'm not sure I could drop a Meterpreter shell as fast as she did in the movie and turn on his webcam, but yes, that's exactly how it's done. Appeal to your targets’ interests, what they feel is beautiful, and you have a great start to a campaign.
Human Attacks
Before I talk about different type of social engineering attacks, I would like to take a quote from Chris Hadnagy’s book, The Science of Human Hacking. He says, “A professional social engineer's goal is to educate and assist rather than humiliate to win.” The whole purpose of this chapter is for you to understand the way most people make decisions and how to help organizations educate their end users how to recognize if someone is trying to take advantage of them for gain. Education and training is one of the most important things you can do to secure your organization, but unfortunately, one of the first things to get cut out of a budget.
If you are doing any social engineering campaign, just like any penetration test, it must be documented and permission must be given. You also have to be careful with any type of impersonation. I had a student take my Metasploit class as a result of a decision he made to internally phish his organization and impersonate a three‐letter agency. The campaign was discovered because the comptroller of the company he worked for was married to an agent for this three‐letter agency. She made a phone call to ask him if the agency was indeed being audited.
Phishing is one of the most popular ways to gain access into an organization. Through open‐source intelligence (OSINT), you know who works for the organization and the positions they are in. You know from different press releases what the company is excited about. Sometimes penetration testers use phishing for knowledge and sometimes for gain. If we are able to compromise a system with stolen credentials from a phish because we successfully extracted information from an end user, we can attempt to elevate those privileges to administrative levels, just like a bad actor would. The purpose of this type of phishing test is to leverage what we can find into what else we can find. Phishing will often take advantage of things going on either within the organization or other popular current events or disasters.
Vishing (voice phishing) is still popular, which surprises me. I never answer the phone. In fact, most people will text me if they are about to call me. Vishers use the telephone to gain access to personal or financial information. One vish I have seen in the news lately targets older people with college‐age grandchildren. With enough OSINT, criminals know enough to impersonate the grandchild and call the grandparent because they've gotten into trouble and need them to send money. If the grandchild is off to school, odds are the parents are not in constant contact. Smishing (social media phishing) sends a text message to a mobile phone to attempt to gain access to personal information with the same intention as phishing or vishing.
Education
Criminals are familiar with human nature. They will use whatever is in their arsenal to attack your organization and the people who work with you. No one who interacts with others is immune. You must educate your end users to
Be very suspicious of any phone calls, visits, or email messages that they did not initiate. If you get requests for information about other employees, try to verify the identity of the requesters. If it's legitimate, they will provide credentials. If they have malicious intent, they will usually give up and try to find easier prey.
Do not ever reveal personal or financial information in email, and do not respond to email solicitations requesting this information. This includes clicking the links sent in an email. Banks will never ask for your PIN. The IRS will never call you.
Pay close attention to the URL of a website linked in the email or SMS message. Malicious websites may look very similar to a legitimate site. If you know the URL of the site they want you to visit, type it in yourself. Do not click the link.
If you are unsure whether an email request is legitimate, forward it to your IT incident and response team. Do not use contact information provided on a website connected to the request.
Install and maintain antivirus software, firewalls, and email filters.
Block ads and pop‐ups whenever possible. When you click an ad, you are susceptible to a number of attacks like downloading malware or clickjacking.
Another of my favorite resources is Lance Spitzner, director of SANS Security Awareness. He says, “People are not the weakest link today, they are the most common attack vector.” One of the biggest takeaways that SANS offers to everyone are its OUCH! newsletters. If you have not subscribed, then I highly recommend you put this book down long enough to Google SANS OUCH! OUCH! is a free security‐awareness newsletter designed for everyone, not just IT professionals. These newsletters are published every month in multiple languages and are scrupulously reviewed by other SANS instructors. You can go back several years or search for a specific category.
A couple years back, I was tasked with coming up with some security awareness training for a software security company I worked for. I would print out the SANS OUCH! newsletters and put them above the coffee pot in the breakroom, on the mirror between the sinks in the bathroom, or above the copier. I put them wherever I knew people congregated or were a captive audience. Every other month, I would have a contest that would involve some of the information in the newsletter, and the reward could be a day off or some type of recognition. People started paying attention. When IT periodically phished our internal employees, they recognized the telltale signs and were able to send that phishing to the proper authorities at the company.
If you think you've been a victim of a social engineering campaign and have revealed sensitive information, report it to the right people—including network administrators. They have tools and can be on the alert for any suspicious behavior. If you believe you have financial accounts that have been compromised, contact that organization immediately. Close that account and watch for anything unexplainable. Watch your credit reports for any accounts that are opened that you did not authorize. I have my credit and my children's credit accounts locked down. Unfortunately, I was a victim a few years ago in the U.S. Office of Personnel Management hack, and in my clearance paperwork was all the personally identifiable information about my family.
Lastly, password hygiene is a fiercely debated topic in IT. If you think you're compromised, immediately change any passwords you might have revealed. If you use the same password on multiple sites for different accounts, change those as well, and don't ever use that password again. Some sites require the password to be a certain length with uppercase, lowercase, and special characters. Some people swear by using password managers like LastPass, Keeper, and Dashlane. A password manager is a tool that does the work of creating and remembering all the passwords for your accounts. For me, it sounds great but is a single point of failure.
To make accounts safer, you should make sure your passwords are
Long and complicated. Ideally, your password should be totally randomized with uppercase and lowercase letters, making it very difficult to remember. Try to create a long password out of one of your favorite books—for example, Wh0i$J0hnG@1t!
Do not write them down or use birthdays.
Always use multifactor authentication, whenever possible.
Don't be too terribly social on social media. Nearly 90 million Facebook accounts had their profile information shared by researchers using a third‐party quiz app. If you aren't paying for it, you are the product. Nothing is ever truly private on social media.
Lastly, if you have chosen to create your passwords yourself, you do have another option. A friend of mine, Michael Hawkins of Wantegrity, has a site he built especially for his customers but has made it available to anyone who would like to play with it. If you visit www.wantegrity.com/passwords.php, you can use your regular‐sized normal password as the master key and the account you are using it on as the site key. As you see in Figure 13.1, you enter your password and account and generate a unique complicated password for that credential pair. If you're concerned about password‐harvesting, right‐click and review the code. What's typed on the page stays on the page.
Figure 13.1: Creating unique credentials for web accounts
The Social Engineer Toolkit
According to the global statistics provided by gs.statcounter.com (see Figure 13.2), 70.22 percent of all global desktop users are using Windows—more than 50 percent of those users are on Windows 10, and interestingly enough, 2.22 percent are on Windows XP. According to this graph, there are more global users of Windows XP than Linux, statistically speaking. I have done my best to show you mainly tools of the Windows persuasion. However, we've gotten to a tool that only runs on Linux and macOS. But I may have a few tricks.
Figure 13.2: 70.22 percent of the planet runs Microsoft Windows.
Windows 10 has an interesting tool called the Windows Subsystem for Linux (WSL). It is a compatibility layer for running a Linux‐compatible kernel interface that can then run GNU on top of it. GNU is actually not an acronym—it is an antelope this project was named after. GNU is an operating system composed wholly of free software like Ubuntu, openSUSE, Debian, or Kali Linux. This type of user space will allow you to use a bash shell or programming languages like Ruby or Python.
There are pros and cons for everything, and there are times and places for tools. WSL has its benefits as well as drawbacks. A lot of great tools have been developed for Linux that are free, and WSL supports a wide variety of Linux distributions. WSL is easy to install, and it takes about 5 minutes (not counting the reboot). While WSL is running, you can access your local machines filesystem from the subsystem. The flip side of this is that WSL is almost like a Linux lite. It was not engineered for heavy‐duty production loads, and it might be more efficient and faster to run a full‐fledged virtual machine. WSL is command line only. There is no GUI, so that can be a drawback for some. As a friend of mine, Josh Franz, a security consultant at Rapid7, told me, “It can just be buggy.” He's right. The earlier iterations had limitations with what networking commands worked. Like any security tool we use, WSL will continue to evolve.
The Social Engineer Toolkit was written by David Kennedy and with a lot of help from the security community has evolved into a tool specifically used against people and their weaknesses. The attacks that are built into this toolkit are reminiscent of Metasploit; however, instead of focusing on network or application attacks, it assists penetration testers to target a person or organization.
Before you can install the Social Engineer Toolkit (SET), you have to turn on WSL in Windows 10 and reboot the machine. Go to your Control Panel, open Programs And Features, and find the option to Turn Windows Features On Or Off. Scroll down toward the bottom until you find Windows Subsystem For Linux; then check that box and click OK, as you see in Figure 13.3. The system should prompt you to reboot the computer so this feature can be available.
Figure 13.3: Turning on the Windows feature of the Windows subsystem for Linux
Once your machine has rebooted, go to your Start menu, and it is time to go shopping at the Microsoft Store. Open the Microsoft Store and look for the magnifying glass in the upper right. In the Search field in the upper right, look for Ubuntu. There are several flavors for you to choose from. Open Ubuntu 18.04 LTS. As you see in Figure 13.4, this version of Ubuntu 18.04 on Windows will let you run an Ubuntu Terminal and run the Ubuntu command‐line utilities, including bash, ssh, apt, and many more.
Figure 13.4: Finding Ubuntu 18.04 on Windows WSL
If you click the More hyperlink above the word Free, you're reminded that this tool is used through a command prompt so you need to turn that feature on. As you see in Figure 13.5, it also contains a link to Windows help documents, but there are also help documents on www.ubuntu.com.
Figure 13.5: Details of Ubuntu 18.04 LTS
In Lab 13.1, you'll install Ubuntu 18.04 on a Windows machine.
LAB 13.1: INSTALLING THE LINUX OS UBUNTU 18.04 ON A WINDOWS MACHINE
On a Windows machine, use the search tool for Windows Features. As you saw earlier in Figure 13.3, check the box for Windows Subsystem for Linux. Reboot the system. Now open the Start menu, pull up the Microsoft Store, and search for Ubuntu.
Open the dialog box for Ubuntu 18.04 LTS and click the Get button. This will download the file you need to complete this installation. The Install button will light up in the upper right. If you are asked to sign into your Microsoft account, click Not Now.
The install will take over, and then you will see the Launch button in the upper right of the window, as shown in Figure 13.6. Click Launch.
Figure 13.6: Ubuntu 18.04 successfully installed
The first time you launch your Ubuntu install, you have a little housekeeping to do. As you see in Figure 13.7, you will have to wait a few minutes for the install to complete, and then you will need to create a UNIX username and password. After you have completed the installation successfully, launch a new Ubuntu command prompt screen.
Figure 13.7: Creating credentials on Ubuntu 18.04
We all have our heroes. Linus Torvalds is one of mine. His philosophy is “Intelligence is the ability to avoid doing work, yet getting the work done.” At 10 years old, he was not happy with the MS‐DOS and decided to create his own operating system based on UNIX. In 1991, he posted a message that he was ready to share what would become Linux. The original code and Linux kernel version 1.0 was released in 1994, and it has been the operating system of choice of geeks everywhere. In addition to being free, it rarely crashed and can be modified by anyone. Not only is Torvalds father of Linux, he also created Git.
Git is what we call a distributed version‐control system. What this means to developers is that if you clone a Git project, you have the entire project history. You can develop all you want on your local machine with no need of server interaction. GitHub also stores a copy of your project. You designate the project's central library or repository, and developers can push and pull all they want. Git is the system; GitHub is the service. I explained it because you're about to install it.
In Lab 13.2, you'll install the Social Engineer Toolkit in the WSL.
LAB 13.2: INSTALLING SET IN WSL
From the command prompt in the new Ubuntu 18.04 asset you just installed from the Microsoft Store, type in sudo apt‐get install git.
Next, git SET and put it in the set folder by entering the following command:git clone https://github.com/trustedsec/social-engineer-toolkit/ set/
As you see in Figure 13.8, this will start cloning the toolkit to your machine. You want to make sure all objects, deltas, and files are at 100 percent.
Figure 13.8: Cloning SET to your set folder
When Git has completed installation and you are back at a command prompt, change the directory by typing in cd set.
Your command prompt will change. You are now in the set directory. Type the following command to use Python to build and install all modules in one run:python setup.py install
When the install completes, you can type in sudo setoolkit and see something similar to Figure 13.9. This is the welcome page to SET.
Figure 13.9: SET welcome screen
NOTE
Like Metasploit Framework, HD and David have a quirky sense of humor, and the welcome page changes each time you log in.
From the menu at the bottom, shown in Figure 13.10, choose 1) Social Engineering Attacks. Then press Enter. From the Social Engineering Attacks menu, choose 5) Mass Mailer Attack.
Figure 13.10: Social engineering attacks
Once you have selected Mass Mailer Attack, you are ready to use all the quirks of human nature combined with the art of persuasion to develop the content of your phishing campaign. As you see in Figure 13.11, you have a choice of either spear phishing one person or casting a wider net by importing a list of email addresses in the Social Engineer Toolkit Mass E‐Mailer. Choose option 1, E‐mail Attack Single Email Address, and SET will guide you through the creation and delivery of a phishing campaign. Happy phishing!
Figure 13.11: Phishing with SAT
CHAPTER 14Kali Linux
WHAT YOU WILL LEARN IN THIS CHAPTER:
Virtualization
Kali Linux
Optimizing Kali Linux
Using Kali Linux Tools
Most of what I teach is done virtually with customers over teleconferencing. The most difficult thing to do with virtual training is to engage the student. They don't see me, and I don't see them. I do not have the ability to read body language. I cannot see the crinkle between their eyes when they're confused. I also can't see when they have gotten up to get more coffee or are sidetracked by emails and phone calls, so student engagement is key. One of our conversations in the Nexpose Vulnerability Management class centers around the cybersecurity philosophy of viewing you and your ecosystem as an attacker would. I ask the question, “What do new pen testers or hackers download as their operating system of choice?” I'm surprised by how many blue‐teamers have never heard of Kali Linux. I've been playing Kali since before it was Kali and was called Backtrack.
Kali Linux debuted in 2013 as a total rewrite of the free Linux distribution called BackTrack. BackTrack was based on the Knoppix Linux OS, whereas now Kali Linux is based on the Debian Linux OS and is funded and maintained by Offensive Security. Kali Linux still remains free and contains more than 600 penetration tools with a wide range of wireless device support. BackTrack was started as an answer to Mati Aharoni's need for a tool to take on an engagement where he could not bring any hardware except a laptop, which would be taken from him at the end of the engagement. Mati is the founder and core developer of the Kali Linux and is the CTO at Offensive Security. Interestingly enough, Kali is the Hindu goddess who brings the death of the ego. I think this software is aptly named.
We have examined many tools throughout this book, and now we've reached one of my favorites. Some of the tools in Kali Linux have entire chapters devoted to them in this book, such as Metasploit Framework, Nmap, Wireshark, and Burp. The best way to master any skill or tool is hands‐on practice. One method you could take is to load these tools on your computer and use them to examine your personal systems. That is a great introduction, but it doesn't scale very well. Most of us don't have many systems in our own private network and may not be able to fully realize the usefulness of these tools. You could use these tools to examine Google or Yahoo! or some other production system out on the Web, but the major problem with doing that is that you don't have permission to do it. It could get you into a lot of legal trouble. Another alternative, and the one I use the most, is to use virtualization.
Virtualization
Virtualization is a technology that system administrators have been using in our datacenters for years, and it is at the heart of cloud computing infrastructure. It is a technology that allows the physical resources of a computer (CPU, RAM, hard disk, graphics card, etc.) to be shared by virtual machines (VMs). Consider the old days when a single physical hardware platform—the server—was dedicated to a single‐server application like being a web server. It turns out that a typical web server application didn't utilize much of the underlying hardware resources available to it on the server. For purposes of this discussion, let's assume that a web application running on one of our physical servers utilized 30 percent of the hardware resources. That meant that 70 percent of the physical resources were going unused; thus, the server was being underutilized.
With virtualization, we could now install three web servers by using VMs each utilizing 30 percent of the physical hardware resources of the server. Now we are utilizing 90 percent of the physical hardware resources of the server, which is a much better return on our investment in the server. We will be using this technology to help us master the tools discussed in this chapter. By installing virtualization software on your computer, you can create VMs that can be used to work with the tools discussed. The rest of this chapter is concerned with doing just that.
Let's first define some of the proper vocabulary:
A hypervisor is the software that is installed on a computer that supports virtualization. It can be implemented as firmware, which is specialized hardware that has permanent software programmed into it. It could also be hardware with installed software. It is within the hypervisor that the VMs will be created. The hypervisor allocates the underlying hardware resources to the VMs. Examples of hypervisor software are VMware's Workstation and Oracle's VM VirtualBox. There are free versions of each of these hypervisors that you can download and use as we did in Lab 10.4 in Chapter 10, “Metasploit.”
There are two types of hypervisors. Type 1 hypervisor runs directly on the bare metal of a system. Type 2 hypervisor runs on a host operating system that provides virtualization services. In our lab, you will be setting up a Type 2 hypervisor in the first lab of this chapter.
A virtual machine is a machine that is created on the hypervisor. It will have its own operating system and be allocated physical hardware resources such as CPU, RAM, hard disk, etc. Various network resources can also be allocated to each VM.
The host operating system is the operating system of the computer the hypervisor is being installed on.
The guest operating system is the operating system of the VM that resides within the hypervisor.
For example, I have a tower computer with an Intel i7 processor, 32 GB of RAM, and multiterabytes of hard disk space running Windows 10 Pro as the host operating system. I also have VMware Workstation Pro as my hypervisor with multiple VMs loaded in it, like Kali Linux and Metasploitable2. Linux is the guest operating system of both these instances.
Before you start this process, you need to make sure that the computer you plan to use for virtualization can support the VMs you intend to load on it as well as its host operating system. Table 14.1 lists the requirements for Windows 10, Ubuntu Linux, and Kali Linux.
   Table 14.1: Resource requirements for Windows 10, Ubuntu, and Kali Linux 
RESOURCE
WINDOWS 10
UBUNTU LINUX
KALI LINUX
Processor
1 GHz or faster
2 GHz dual‐core processor
CPU supported by at least one of the AMD64, i386, armel, armhf, or arm64 architectures
RAM
1 GB for 32 bit 2 GB for 64 bit
2 GB
2 GB
Hard drive space
16 GB for 32 bit 32 GB for 64 bit
25 GB
20 GB
Graphics card
Direct 9 or later with WDDM 1.0 driver
Display
800×600
1024×768
https://www.microsoft.com/en‐US/windows/windows‐10‐specifications
https://help.ubuntu.com/community/Installation/SystemRequirements
https://kali.training/topic/minimum‐installation‐requirements/
Just like any environment, there will be pros and cons. Some of the pros of running Kali in a VM are that you can run more than one OS at a time; you can install, reinstall, or back up any time you want quite easily; and you can manage the allocation of resources. The cons would be that performance may not be as robust as if you were on bare metal, USB drives can cause issues, and some of us would rather roll back than actually troubleshoot the issue. I've been guilty of that because I was in a time crunch.
For demonstration purposes, in Lab 14.1, I walk you through installing VMware Workstation Player on my Windows computer and then importing a Kali Linux VM. Let's get started.
LAB 14.1: INSTALLING VM WORKSTATION
Download VMware Workstation Player for the Windows computer (if you did not already do so in Chapter 10, “Metasploit’’). As of the writing of this book, the link to Workstation Player is https://my.vmware.com/en/web/vmware/free#desktop_end_user_computing/vmware_workstation_player/15_0, which you see in Figure 14.1.
Figure 14.1: Download VM Workstation Player page
After you have VM Workstation downloaded, open the install file and double‐click. A User Account Control (UAC) window will be displayed where you will need to click Yes to allow the program, as shown in Figure 14.2.
Figure 14.2: VMware UAC
Click Next to advance to the Setup Wizard. You can click Next five times to accept the EULA, install at the default location, accept the User Experience Settings, add shortcuts, and then finally click Install. The next window you see is the installation starting, as shown in Figure 14.3.
Figure 14.3: Installing VMware Workstation 15 Player page
The VMware Workstation player icon will be on your desktop. Double‐click the icon to access the Welcome screen. You have two options at this point of installation. If this is for noncommercial use, as you see in Figure 14.4, leave the default and click Continue and on the next screen Finish.
Figure 14.4: Accepting the free noncommercial license
When you open the player, it will prompt you if you have any updates. As you see in Figure 14.5, you will make the educated decision to download the update, especially if you read Chapter 12, “Patch and Configuration Management.” You are not too busy to make sure you have the latest updates and patches and bug improvements.
Figure 14.5: VMware Workstation Player software updates
With VMware Workstation 15 Player, you have the ability to create a new VM from scratch or open one that already exists.
The next level of this process will be to download the Kali Linux VMware image.
There are several Kali Linux distributions to choose from. You have the WSL version that can be pulled directly into a Windows OS. From www.kali.org, every few months there is a new Kali image you can download. From www.offensive‐security.com, the VMs are already created for you. They are shared with the disclaimer that they are maintained on a “best‐effort” basis, and all future updates will be listed here:
www.offensive‐security.com/kali‐linux‐vm‐vmware‐virtualbox‐image‐download/19/
There are a few more important things I want to mention before we open Kali. Offensive Security does not supply technical support for Kali images, but support can be found on the Kali Linux Community page. Odds are if you have a question or problem, someone else has experienced the same thing. Scroll down the page until you see the Kali Linux VM for the architecture of your machine. As you see in Figure 14.6, there will be a version as well as a hash.
Figure 14.6: Downloading Kali Linux
NOTE