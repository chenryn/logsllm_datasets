title:Implementing the Intrusion Detection Exchange Protocol
author:Tim Buchheim and
Michael Erlinger and
Benjamin S. Feinstein and
Gregory A. Matthews and
Roy Pollock and
Joseph Betser and
Andy Walther
Implementing the Intrusion Detection Exchange Protocol
Tim Buchheim,
Ben Feinstein,
Harvey Mudd College, Harvey Mudd College, Guardent, Inc.
PI:EMAIL,
PI:EMAIL,
Michael Erlinger,
PI:EMAIL
∗
,
Greg Matthews
Harvey Mudd College,
PI:EMAIL,
Roy Pollock,
Harvey Mudd College
PI:EMAIL
Joseph Betser,
The Aerospace Corporation, The Aerospace Corporation
PI:EMAIL,
PI:EMAIL
Andy Walther
†
Abstract
We describe the goals of the IETF’s Intrusion Detection Working Group (IDWG) and the requirements for a trans-
port protocol to communicate among intrusion detection systems. We then describe the design and implementation of
IAP, the ﬁrst attempt at such a protocol. After a discussion of IAP’s limitations, we discuss BEEP, a new IETF general
framework for application protocols. We then describe the Intrusion Detection Exchange Protocol (IDXP), a transport
protocol designed and implemented within the BEEP framework that fulﬁlls the IDWG requirements for its transport
protocol. We conclude by discussing probable future directions for this ongoing effort.
1 Introduction
2 The IETF-IDWG
Intrusion detection is an area of increasing concern
In response to this, many
in the Internet community.
automated intrusion detection systems have been devel-
oped. However, there is no standardized way for them
to communicate. To remedy this, the Intrusion Detec-
tion Working Group was chartered under the auspices of
the Internet Engineering Task Force.
This paper gives an overview of the working group
and the task it faces. The paper then describes at-
tempts to deﬁne and implement a transport protocol for
intrusion detection alerts. The paper focuses mainly
on the Intrusion Detection Exchange Protocol and the
implementation experience of the Aerospace Corpora-
tion/Harvey Mudd College 2000-2001 clinic team.
2.1 IETF
The IETF is the engineering, development and stan-
dardization arm of the Internet Architecture Board
(IAB). The IETF is where the Internet protocol speci-
ﬁcations are developed.
The IETF’s mission includes:
(cid:127) “Identifying and proposing solutions to opera-
tional and technical problems in the Internet.
(cid:127) Specifying protocols and architecture to solve
such technical problems.
(cid:127) Making recommendations to the Internet Engi-
neering Steering Group (IESG) regarding the
∗
†
Greg Matthews now at CSC/NASA Ames
Supported by the Aerospace Institute, The Aerospace IRAD Corporate REsearch Initiative, and UC Davis Subcontract K971414-01 to US Air
Force DARPA Cyber Panel GlobalGuard contract F30602-98-I-0201.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:41 UTC from IEEE Xplore.  Restrictions apply. 
standardization of protocols and protocol usage in
the Internet
(cid:127) Providing a forum for the exchange of informa-
tion within the Internet community.” [4]
To accomplish its mission the IETF has divided itself
into various areas of interest (e.g., Security Area), with
an Area Director for each area. Each area has a num-
ber of Working Groups (WG), each dedicated to a par-
ticular issue, e.g., creation of a particular Internet pro-
tocol speciﬁcation. A working group is composed of a
chair and all interested parties. The WG charter sets the
agenda and timetable for the achievement of some goal.
Anyone may choose to join any WG. Participants, while
making their afﬁliations known, act individually.
To accomplish its mission the IETF meets three times
a year in various worldwide locations. At these meetings
the working groups meet to accomplish speciﬁc tasks as
established in their charter.
2.2 IDWG
The Intrusion Detection Working Group (IDWG) is
one of the working groups in the IETF Security Area.
Its charter is “to deﬁne data formats and exchange pro-
cedures for sharing information of interest to intrusion
detection and response systems, and to management sys-
tems which may need to interact with them.”
This working group is trying to develop a protocol
that allows the many different intrusion detection sys-
tems to communicate in a standard way. At one level this
work is a follow-on to the DARPA CIDF (Common In-
trusion Detection Framework) that produced CISL. The
major enhancements are a limitation of the type of infor-
mation communicated and the integration of the proto-
col into the TCP/IP suite of protocols.
IDWG was chartered as a working group after the
August 1998 IETF meeting and the working group met
for the ﬁrst time at the December 1998 IETF meeting.
Since that time, IDWG has met at each IETF meeting
and held interim meetings at various locations. In the
process of producing the desired protocol the IDWG has
committed to producing various speciﬁcations. The ﬁrst
is a requirements speciﬁcation detailing the set of re-
quirements for the protocol. The requirements docu-
ment, while difﬁcult to produce, was desired because
the working group wanted to ensure that a well-deﬁned
checklist existed to assist in making protocol choices.
The requirements speciﬁcation is currently an Internet
Draft and has been forwarded to the IESG for publica-
tion as an Informational RFC.
The other documents to be produced all relate di-
rectly to the protocol; a data deﬁnition of the data items
desired in the messages to be exchanged; a deﬁnition
of the message format (IDMEF) [7]; and two protocol
speciﬁcations (IAP [5] [3] and IDXP [10]) fulﬁlling the
IDWG transport protocol (IDP) requirements for com-
municating IDMEF messages.
Thus in a little over two years, IDWG has pro-
duced a ﬁnal version of a requirements document as
well as draft versions of a message format (IDMEF) and
two transport protocols (IAP and IDXP). Participation
in the IDWG activities is encouraged via idwg-public-
request@zurich.ibm.com.
3 System Description of IDS and IDWG
The activities of the IDWG are integrated closely
with Intrusion Detection Systems (IDS), so descriptions
of the IDMEF and IDP use general IDS terminology.
See [9] for additional IDWG terminology. The follow-
ing deﬁnitions will clarify the description of the IDWG
system.
3.1 Activity
IDSs monitor network usage and other types of ac-
tivity by analyzing data sources such as network packets
and system logs.
In particular, any activity that is of
concern from a security perspective is relevant for IDS
monitoring.
Event: Any activity that is potentially worthy of some
type of action or response, such as multiple failed logins
or a ping ﬂood. The degree to which an event is worthy
of a response is dictated by the security policy in place,
typically manifested in the conﬁguration of the IDS.
3.2 Communication
Once an event has been detected and deemed worthy
of further action it is necessary to communicate the ex-
istence of the event, and possibly its details, to a party
that is capable of further action.
Alert: IDS alerts contain, at a minimum, information
stating that an event occurred. Alerts may contain much
richer information about the event, in order to facilitate
an informed action or response by the receiving party.
Notiﬁcation: Once an alert has been received it may
be deemed necessary (as deﬁned in the security policy)
to notify an external actor of the alert. This can involve
sending pager or e-mail messages, creating database en-
tries, or publishing web-accessible HTML reports.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:41 UTC from IEEE Xplore.  Restrictions apply. 
3.3 Actors
Intrusion Detection (ID) actors are those ID entities
that create, consume, act upon, or respond to ID alerts.
These actors are either programs or humans.
Administrator: Human responsible for establishing
the overall security policy. This speciﬁes the way in
which other ID actors behave in response to various
types of activities.
Operator: Human responsible for initiating responses
to alerts and/or notiﬁcations. The operator may choose
to manually respond or may conﬁgure the IDS for some
automated response.
Sensor: Collects data about activity from data
sources, to be used in detecting events.
Analyzer: An analyzer detects events based on activ-
ity data, and according to the security policy possibly
generates alerts based on these events. Alerts are for-
matted and transferred to managers using the format and
transfer protocols standardized by the IDWG.
Manager: ID entity that consumes alerts, and facil-
itates control over the IDS by the operator. Managers
inform the operator through different types of notiﬁca-
tion that alerts have occurred, as per the security policy.
3.4 System Assumptions
The IDWG has made two assumptions about the de-
ployment conﬁguration of an IDS. First, it assumes that
only analyzers create and communicate ID alerts. The
same program or computer may act as both an analyzer
and a manager, but these will be two separate ID entities.
This assumption is tied to the second, that analyzers and
managers can be separate components that communicate
pairwise across a TCP/IP network. Together these as-
sumptions differentiate between creation and consump-
tion of ID alerts, and allow the acts of alert creation and
consumption to occur at different IDS components on
the network. The assumptions affect the transfer proto-
col, since alerts will be transferred from one component
over TCP/IP to another component. This communica-
tion must be done in a standard and secure fashion.
4.1 Allow Communication Between Different
IDS Elements
IDS elements may be either passive or active. Passive
elements wait to be contacted by active elements, while
active elements are capable of initiating communication
with passive elements. The active/passive distinction al-
lows for ﬂexible deployment of IDS elements, such that
some elements may only actively connect to a known
set of peers, while others may passively listen for one or
more connections from a set of known peers.
4.2 Reliable Transmission
Messages sent between IDS elements must get
through and be acknowledged, especially under difﬁcult
network conditions. The severity of an attack, and there-
fore the importance of a prompt response, may be re-
vealed in the number and frequency of messages gener-
ated by IDS analyzers. Achieving reliable transmission
in an efﬁcient manner is desirable, so as to avoid unnec-
essary duplication of messages. For these reasons the
IDWG has speciﬁed that the IDP be based on the Trans-
mission Control Protocol (TCP). This leverages the mas-
sive effort that has already been expended by the IETF
community to develop and to improve TCP.
4.3 Mutual Authentication / Assurance of Mes-
sage Origin
The party at each end of IDP must be able to ver-
ify the identity of its peer. This is important because
an attacker masquerading as an analyzer could inject
false data to mask a real attack, or an attacker mas-
querading as a manager could intercept trafﬁc and lull
the analyzer(s) into thinking that a response was being
mounted. Assurance of message origin involves having
a way to prove post facto which messages came from
which IDS element.
4 Transport Requirements
4.4 Integrity and Conﬁdentiality
A diagram outlining the core architectural elements
of IDP is shown in Figure 1. The working group has
speciﬁed requirements for how these elements should in-
teract. See [9] for these requirements. The design of IDP
must meet these requirements to successfully take its
place in a system utilizing IDS to maintain and enhance
security. The most important of these requirements are
summarized here.
IDP must guarantee both the integrity and conﬁden-
tiality of its data. Integrity of data requires that if a mes-
sage has been tampered with by someone “on the wire”
between the two elements then this tampering will be
detected. Conﬁdentiality means that a third-party inter-
cepting the trafﬁc between the two elements will be un-
able to make sense of it.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 07:04:41 UTC from IEEE Xplore.  Restrictions apply. 
4.5 Resist DoS Attacks
IDP is potentially a burden if it allows attackers to
more easily shut down the network by exhausting a re-
source. Therefore IDP should attempt to resist such
attacks by taking actions such as rejecting illegitimate
connections as early as possible, and potentially modi-
fying its behavior if it believes it is being attacked.
4.6 Further Network Speciﬁc Issues
Since IDP is designed to increase network security
it should be able to operate through ﬁrewalls without
compromising their security. This is why managers and
analyzers can both be active, allowing them to connect
outward through the ﬁrewall to the appropriate passive
element. Additionally, a proxying capability allows con-
nections between IDS elements separated by a ﬁrewall.
Proxying facilitates initiation of IDS message exchanges
regardless of the location of the initiating IDS element.
These features are desirable because any number of IDS
deployment scenarios are possible, with managers and
analyzers residing on either side of a ﬁrewall (should one
exist). A proxy can be conﬁgured to only accept con-
nections and transfer messages to known IDS elements,
reducing the potential security risk that additional trans-
fers across a ﬁrewall might pose.
Manager
Initial connection
Flow of intrusion alerts
F
I
R
E
W