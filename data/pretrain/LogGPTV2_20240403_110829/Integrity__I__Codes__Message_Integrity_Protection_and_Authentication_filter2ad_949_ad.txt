I-coded message.
(cid:2)
(cid:3)
h(m)
h(m)
(cid:3)
In this protocol, the integrity and the authenticity of the
message m is veriÔ¨Åed through the veriÔ¨Åcation of the au-
thenticity and integrity of its digest h(m). The authenticity
and the integrity of h(m) is guaranteed with I-codes if and
only if the following conditions are met: (i) the receiver B
knows that it is in the power range of the sender A, (ii) the
receiver B knows that A has started transmitting on the in-
tegrity channel (C2). The Ô¨Årst condition is the condition of
presence which ensures that the receiver is receiving sig-
nals from the sender. The second condition is the condition
of synchronization which ensures that the receiver knows at
which time is the transmission of data performed.
If the
receiver wrongly believes that the transmitter is transmit-
Proceedings of the 2006 IEEE Symposium on Security and Privacy (S&P‚Äô06) 
1081-6011/06 $20.00 ¬© 2006 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:52:17 UTC from IEEE Xplore.  Restrictions apply. 
ting, or if it wrongly believes to be in the power range of
the sender, a (malicious) entity can insert false data on the
channel and these data will be accepted as valid by the re-
ceiver. This follows from the properties of I-codes, which
assume the presence of the signal from the legitime sender
on the channel.
Remark 2 The protocol shown in Figure 5 has the draw-
back that the size of the cryptographic hash function h(¬∑)
increases over time, in order to compensate for fast (daily)
advance in computational technology and computational
power available to an adversary. Today a ‚Äútarget collision-
resistant‚Äù hash function implies the hash function size of at
least 80 bits [14]. However, according to [14], the minimum
required size increases linearly over time due to fast tech-
nological advances. It is not advisable to go below these
minimum sizes in the adversarial model where the I-coded
message in Figure 5 can be delayed sufÔ¨Åciently.
Consequently, straightforward solutions similar to the
one given in Figure 5 are said to be ‚Äútime-variant‚Äù, that is,
the number of bits to be transmitted using I-codes increases
over time. This is clearly not desirable in our context, since
the reliability of I-codes drops quickly with the size of mes-
sages (see Figure 3). In Section 5.2, we will describe the
protocol (in the context of user-friendly key establishment)
that allows us to optimally trade-off the size of messages to
be I-coded with the security, and to signiÔ¨Åcantly decrease
the size of I-coded messages.
In the following two sections, we show in which sce-
narios the conditions of presence and synchronization are
fulÔ¨Ålled and in which, therefore, I-codes can be used for
authentication and integrity protection.
5.1 Access point authentication
Here, we show that authentication through presence can
be a useful tool for the broadcast authentication of messages
from Ô¨Åxed access points (AP).
Our scenario is depicted in Figure 6. Here, I-codes are
used by the AP to advertise its public key. This key can be
later used to provide authentication and integrity protection
of all messages generated by the AP.
This enables any user that comes into the range of the AP
to know that the advertised public key of this access point is
authentic and belongs to the access point in whose range the
user is located. If the user trusts the environment in which
the access point is placed (a bank or an ofÔ¨Åce), it will trust
all information coming from that access point and will use
the public key of the AP to establish a secure connection to
the station. Here, it is important that the user knows that the
environment in which she is placed is covered by at least
one legitimate AP. If this condition is fulÔ¨Ålled, it is of little
receivers
sending AP
sender
conservative transmission region
Figure 6. Broadcast integrity and authentica-
tion with an access point. By the ‚Äúconservative
transmission region‚Äù we mean the region where the
received power of a signal transmitted by the AP ex-
ceeds some predeÔ¨Åned threshold level (which is a se-
curity parameter in our case).
importance if there are any rogue APs present in this space,
as long as the legitimate APs are active.
We assume that the sender (AP) is static. The (conserva-
tive) reach of its transmission is known to the receivers. The
receivers therefore know before they start receiving the data
if they are in the sender‚Äôs power range or not; this knowl-
edge is a publicly available information. The receivers also
know the integrity channel used by the AP to emit its public
key. In the case of, for example, IEEE 802.11a, one of the
12 orthogonal channels can be allocated for this purpose.
The AP continuously sends its key on the integrity chan-
nel (C2 in Figure 4). When it is not advertising its public
key, the AP jams the integrity channel to prevent any fake
public keys being transmitted over the same channel. As the
AP is continuously active, there is no need for synchroniza-
tion with the receivers; the receivers will start receiving the
data when they come into AP‚Äôs power range. This power
range can be estimated by the receiver (a room where the
AP is placed), or can even be marked. Furthermore, to avoid
attacks during the time when the AP fails, its status (activ-
ity) can be signalled to the receivers through some visual
channel (e.g. a blinking LED).
5.2 Key Establishment Over
Channels
Insecure
In this section we show how authentication through pres-
ence can be used for user-friendly key establishment over
an (insecure) radio link in peer-to-peer networks. We also
show how it is possible to optimally trade-off the security
of the key agreement protocol with the size of message to
be transmitted using I-codes. This is particularly important,
since I-codes are not developed with reliability in mind; as
we saw in Figure 3, the reliability of I-codes drops quickly
with the size of I-coded message.
Proceedings of the 2006 IEEE Symposium on Security and Privacy (S&P‚Äô06) 
1081-6011/06 $20.00 ¬© 2006 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:52:17 UTC from IEEE Xplore.  Restrictions apply. 
Alice
Bob
Given IDA, gXA
Pick NA ‚ààU {0, 1}k
mA ‚Üê 0(cid:6)IDA(cid:6)gXA(cid:6)NA
(cA, dA) ‚Üê commit(mA)
Given IDB, gXB
Pick NB ‚ààU {0, 1}k
mB ‚Üê 1(cid:6)IDB(cid:6)gXB(cid:6)NB
(cB, dB) ‚Üê commit(mB)
‚Äî Insecure high-bandwidth channel (e.g., a radio channel) ‚Äî
(cid:8)mB ‚Üê open(ÀÜcB, ÀÜdB)
Verify 1 in (cid:8)mB.
sA ‚Üê NA ‚äï ÀÜNB
cA -
cB
dA -
dB
(cid:8)mA ‚Üê open(ÀÜcA, ÀÜdA)
Verify 0 in (cid:8)mA.
sB ‚Üê NB ‚äï ÀÜNA
‚Äî Low-bandwidth authentication channel (e.g., I-code channel) ‚Äî
I-code (sA) - Verify sB
?= sA.
If veriÔ¨Åcation OK, Alice and Bob output ‚ÄúAccept‚Äù ÀÜmB and ÀÜmA, respectively.
Figure 7. DifÔ¨Åe-Hellman key agreement protocol based on I-codes (DH IC)
In [23], we have developed a two-party key agreement
protocol that is based on the DifÔ¨Åe-Hellman (DH) key
agreement protocol. DH key agreement is known to be
vulnerable to the man-in-the-middle attack if the two users
involved in the protocol do not share any authenticated in-
formation about each other (e.g., public keys, certiÔ¨Åcates,
passwords, shared keys, etc.) prior to the protocol execu-
tion. We solve this problem by leveraging on I-codes that
can enable message integrity protection and thus prevent
man-in-the-middle attacks.
Our protocol unfolds as shown in Figure 7. Both Alice
(A) and Bob (B) have selected their secret exponents XA
and XB, respectively, randomly from the set {1, 2, . . . , q}
(q being the order of an appropriate multiplicative group)
and calculated DH public parameters gXA and gXB , re-
spectively. A and B proceed by generating k-bit ran-
dom strings NA and NB, respectively. Finally, A and
B calculate commitment/opening pairs for the concate-
nations 0(cid:11)IDA(cid:11)gXA(cid:11)NA and 1(cid:11)IDB(cid:11)gXB(cid:11)NB, respec-
tively. Here, 0 and 1 are two public (and Ô¨Åxed) values that
are used to prevent a reÔ¨Çection attack [16]. IDA and IDB
are human readable identiÔ¨Åers belonging to parties A and B
(e.g., e-mail addresses).
The following four messages are exchanged over an in-
secure (radio) link. In the Ô¨Årst message, A sends to B the
commitment cA. B responds with his own commitment cB.
In turn, A sends out dA, by which A opens the commitment
cA. B checks the correctness of the commitment/opening
pair (ÀÜcA, ÀÜdA) and veriÔ¨Åes that 0 appears at the beginning of
ÀÜmA. If the veriÔ¨Åcation is successful, B sends, in the fourth
message, dB, by which B opens the commitment cB. A in
turn checks the commitment and veriÔ¨Åes that 1 appears at
the beginning of ÀÜmB. If this veriÔ¨Åcation is successful, A
and B proceed to the Ô¨Ånal phase (Figure 7).
In the Ô¨Ånal phase, A and B Ô¨Årst generate the authentica-
tion strings sA and sB, respectively, as shown in Figure 7 (‚äï
is the bitwise ‚Äúxor‚Äù operation). The length of each of these
strings is k. Finally, Alice sends sA over the integrity chan-
nel to Bob, which then compares it to sB. If they match,
Alice and Bob accept the DH public keys gXB and gXA,
and the corresponding identiÔ¨Åers IDB and IDA, respec-
tively, as being authentic. At this stage, Alice and Bob can
safely generate the corresponding secret DH key (gXAXB ).
A security analysis of the DHIC protocol can be found
in [23]. Here we only state the result. We denote with Œ≥
the maximum number of sessions (successful or abortive) of
the DH IC protocol that any party can participate in. Also,
we assume that the used commitment scheme is ‚Äúideal‚Äù, in
the sense that the hiding and binding properties of it always
hold.
Theorem 3 (cf. [23]) The probability that an attacker suc-
ceeds against a targeted user of the DHIC protocol is
bounded by Œ≥2‚àík.
Our key agreement protocol exhibits two unique fea-
tures: (i) it is optimal in the length of the message to be
sent using I-codes, and (ii) it is time-invariant, i.e., in spite
of the fact that the security parameters of the commit(¬∑)
function increase over time, in order to compensate for fast
(daily) advance in computational technology and computa-
tional power available to an adversary [14], the number of
bits k to be transmitted using I-codes does not change over
Proceedings of the 2006 IEEE Symposium on Security and Privacy (S&P‚Äô06) 
1081-6011/06 $20.00 ¬© 2006 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 02:52:17 UTC from IEEE Xplore.  Restrictions apply. 
time (for the Ô¨Åxed security level). Note that that the protocol
shown in Figure 5 is not time-invariant, since it relies on the
cryptographic hash function h(¬∑) whose security parameter
increases over time [14].
Let us give an example of possible values for the param-
eters k and Œ≥. Let us assume that the Ô¨Åxed user can partic-
ipate in at most Œ≥ = 220 sessions (successful or abortive)
in his/her lifetime; this corresponds to 32 sessions per day
during approximately 89 years. Then, by choosing k = 50
(bits) we obtain that the highest probability of success by
the adversary (having seen a huge number of 220 DH IC
sessions by the Ô¨Åxed user) is Œ≥2‚àík = 2‚àí30. Note that k
also represents the length of the veriÔ¨Åcation string sA to be
communicated through I-codes. From Figure 3, we can see
that with I-codes and the complementary encoding rule, in
normal circumstances, it will take on average around 2 rep-
etitions of the 50 bit long veriÔ¨Åcation string sA, before it is
successfully received by the given receiver. This is rather
negligible cost, given that all the messages are transmitted
over a radio link.
Therefore, with I-codes, the involvement of the users in
the protocol execution is rather minimal and therefore the
DH IC is indeed user-friendly.
6 Security Analysis of I-codes
In this section, we discuss security of I-codes from the
signal cancellation point of view. As we already mentioned
in Section 3.3, the security of I-codes depends on the inabil-
ity of the attacker to Ô¨Çip symbols ‚Äú1‚Äù into ‚Äú0‚Äù, by which she
breaks the integrity of the exchanged messages. By a suc-
cessful attack on I-codes, we consider that the attacker is
able to break the integrity of the transmitted message, mean-
ing that the receiver accepts a message as valid even if it has
been modiÔ¨Åed by the attacker on the channel. Note that we
reason about the security of I-codes within the system and
the attacker model described in Section 2.
We focus on the security of I-codes used over the radio
communications channel. In order to delete (cancel) a sig-
nal s(t) emitted on a radio channel, the only hope for the
(cid:2)(t) arrive at the receiver
adversary is to have its signal s
with the same amplitude as s(t) but opposite in phase, that
(cid:2)(t) = ‚àís(t). There are two main factors that make it
is, s
hard for the attacker to cancel the signal at the receiver: (1)
the unpredictability of the channel conditions (2) the unpre-
dictability of the signal generated by the sender. In order to
cancel the signal at the receiver, the attacker needs to esti-
mate the channel conditions (to know how the channel will
shape the original signal), and predict the shape of the signal
generated at the sender (to know which form to generate to
cancel the signal). Channel conditions are highly inÔ¨Çuenced
by the environment and in high-frequency communication
systems (e.g., 2.4 GHz), it is nearly impossible for the at-
tacker to predict them due to the un-predictable amplitudes
and phases, the multipath fading effects, etc.
In this section, we analyze how channel and signal un-
predictability affect the attacker‚Äôs ability to cancel-out the
signal on the channel. We show that the odds of the adver-
sary to cancel the signal s(t) are indeed negligible.
6.1 Anti-Blocking Property of the Radio
Channel
We Ô¨Årst start by showing how channel conditions affect
the attacker‚Äôs ability to cancel the radio signal.
Let us assume that the sender emits cosine signal s(t)
with unit amplitude and frequency f0, i.e., s(t) = cos(œâ0t),
where œâ0 = 2œÄf0. We assume that the adversary knows
somehow the exact value of the amplitude of the signal re-
ceived at the receiver. Furthermore, we assume that there
are no multipath fading effects and that the adversary knows
s(t). Note that with these assumptions, we only make the
task of the adversary a lot easier. In reality, multipath ef-
fects and interferences from other transmitters can easily
make the channel sufÔ¨Åciently random to forbid the attacker
to even estimate the state of the signal at the receiver r(t).
Let us deÔ¨Åne r(t) ‚â° cos(œâ0t) ‚àí cos(œâ0t ‚àí Œ∏), where
Œ∏ ‚àà [0, 2œÄ). Here, r(t) can be thought of as the signal
obtained as the superposition of the adversary‚Äôs annihilating
(cid:2)(t) = ‚àí cos(œâ0t ‚àí Œ∏) and s(t); Œ∏ accounts for the
signal s
potential phase shift. The energy Er of the signal r(t), with
duration Ts, can be calculated as follows [20]:
(cid:9) Ts
Er =
r2(t)dt
0
1
œâ0
=
sin2
(1)‚âà 2Ts sin2
Œ∏
2
(cid:10)
(cid:10)
Œ∏
2
(cid:11)
(cid:11)
(2œâ0Ts ‚àí sin(Œ∏) + sin(Œ∏ ‚àí 2œâ0))
,
(3)
where the approximation (1) is valid for high frequencies
f0 (e.g., f0 = 2.4 GHz), since ‚àí1 ‚â§ sin(¬∑) ‚â§ 1 implies
sin(¬∑)/œâ0 = sin(¬∑)/(2œÄf0) ‚Üí 0.