12
5.06
-58.02 ppm
Seattle, WA
9
15.12
-58.01 ppm
Princeton, NJ
14
36.97
-57.91 ppm
Boston, MA
13
41.09
-58.10 ppm
U. Kingdom
21
86.45
-58.18 ppm
Switzerland
21
84.07
-58.40 ppm
India
16
199.27
-59.60 ppm
Singapore
15
93.55
-58.05 ppm
CAIDA lab
5
0.24
-57.98 ppm
The skew estimates seem (relatively) independent of 
the measurer itself.
OS on laptop
NTP
TSopt clock 
skew estimate
System clock 
skew estimate
Red Hat 9.0
No
-58.20 ppm
-58.16 ppm
Red Hat 9.0
Yes
-58.16 ppm
-0.14 ppm
Windows XP
No
-85.20 ppm
-85.42 ppm
Windows XP
Yes
-84.54 ppm
1.69 ppm
Experiment with laptop running Red Hat 9.0 
and Windows XP, both with and without NTP-
based system time synchronization.
OS on laptop
NTP
TSopt clock 
skew estimate
System clock 
skew estimate
Red Hat 9.0
No
-58.20 ppm
-58.16 ppm
Red Hat 9.0
Yes
-58.16 ppm
-0.14 ppm
Windows XP
No
-85.20 ppm
-85.42 ppm
Windows XP
Yes
-84.54 ppm
1.69 ppm
NTP-based system time adjustments do not seem 
to affect the systems’ TSopt clock skews.
OS on laptop
NTP
TSopt clock 
skew estimate
System clock 
skew estimate
Red Hat 9.0
No
-58.20 ppm
-58.16 ppm
Red Hat 9.0
Yes
-58.16 ppm
-0.14 ppm
Windows XP
No
-85.20 ppm
-85.42 ppm
Windows XP
Yes
-84.54 ppm
1.69 ppm
Different operating systems running on the same 
hardware can have different TSopt clock skews.
Is there a predictable relationship?
Without NTP-based system time adjustment, a 
device will have the same TSopt and system time 
clock skews. 
OS on laptop
NTP
TSopt clock 
skew estimate
System clock 
skew estimate
Red Hat 9.0
No
-58.20 ppm
-58.16 ppm
Red Hat 9.0
Yes
-58.16 ppm
-0.14 ppm
Windows XP
No
-85.20 ppm
-85.42 ppm
Windows XP
Yes
-84.54 ppm
1.69 ppm
Study Limitations
t  (in seconds)
C - t  (in seconds)
i
i
i
Windows XP SP2 power management on 
laptop
(Additional information leakage?)
Explore 
Applications
Honeyd 0.8b
✦ Honeyd [Provos]:  “A framework for virtual 
honeypots that simulates virtual computer 
systems at the network level.”
✦ Our observation:  All virtual hosts in a honeyd 
virtual honeynet have approximately the same 
TSopt clock skew.
Honeyd 0.8b
i
Example plot for 100 honeyd virtual Windows 
XP machines on the same host.
t  (in seconds)
C - t  (in ms)
i
i
VMWare Workstation
t  (in seconds)
C - t  (in seconds)
i
i
i
Five VMWare Workstation virtual machines 
running Red Hat 9.0 and the host (also Red Hat 
9.0).
Deanonymizing anonymized 
network traces
✦ On 2004-04-21, CAIDA took a 2-hour passive 
trace on a major OC-48 link.
✦ Since the researchers wanted to use that trace 
to analyze P2P trafﬁc:
✦ The trace contained partial payload data.
✦ The IP addresses were anonymized.
✦ On 2004-04-28, CAIDA took another another 
2-hour trace on the same link.  This trace 
contained no payload data and was not 
anonymized.
Using our techniques, we believe that we 
deanonymized a number of the IP 
addresses in the 2004-04-21 trace.
But we could not verify whether we were 
successful.
Deanonymizing anonymized 
network traces
✦ On 2005-01-13 and 2005-01-21 CAIDA took 
two 2-hour passive trace on an OC-48 link.
✦ We anonymized the 2005-01-13 trace and then 
attempted to deanonymize it given the 
2005-01-21 trace.
Deanonymizing anonymized 
network traces
✦ There were a total of 11862 IP addresses 
common to both traces.
✦ Our program output 2170 candidate 
anonymous-to-real mappings, of which 1902 
(88%) were correct.
✦ Since the anonymization was preﬁx-preserving, 
we believe that the 2170 candidate mappings 
output by our program could catalyze 
additional deanonymizations.
Other possible applications
✦ Count the number of devices behind a NAT, even 
if not all the devices are up at the same time.
✦ Provide additional information for use with 
“tracking” physical devices.
✦ Provide forensics evidence about whether a given 
device was involved in some action.
Present Defenses
Possible countermeasures
✦ The TCP Timestamps Option is an option:  
disable it.
✦ The timestamps a sender includes in a packet are 
only later used by itself (they are simply echoed 
by the other party):  don’t include real 
timestamps in outgoing packets.
✦ Make a device appear to have the clock skew of a 
different device.
And Mention 
Open Problems
Some open issues
✦ Better understand the effects of (and possibly 
additional information leakage from)
✦ Temperature variation.
✦ Power management.
✦ Device load.
✦ Operating system.
✦ Further explore minimum data requirements.
Since 2005
✦ Our open problems become useful to others
✦ E.g., Steven Murdoch’s CCS 2006 paper
✦ “Hot or Not:  Revealing Hidden Services by 
their Clock Skew”
✦ Attacks Tor Hidden Services
Nike+iPod Sport Kit
Example:  Streaming Media
Internet
Home wireless
The future of personal entertainment
Apple TV
Slingbox Pro
Sony LocationFree 
LF-B20
Encryption and the Slingbox Pro
✦
Slingbox Pro uses encryption
✦
To protect privacy of user’s viewing habits
✦
Pirated or private content
✦
“Encryption” puts a sealed envelope around messages
✦
Only receiver can open
✦
Assume we cannot break encryption
Eavesdropper
Encryption and the Slingbox Pro
✦
Taking a closer look:
✦
Data sent over network (802.11, Internet)
✦
Entire movie broken into many envelopes (packets)
✦
Variable bitrate encoding:
✦
Number of packets depend on scene
✦
Fingerprint of a movie that survives encryption!
Eavesdropper
Ocean’s Eleven
Throughput/time for three traces of  Ocean’s Eleven
Accuracy
✦
26 movies, twice over wireless, twice over wired
✦
Average identiﬁcation rates for all 26 movies (compared to 
< 4% by random guessing)
✦
10 minute sample:  62%
✦
40 minute sample:  77%
✦
Some movies much better
✦
15 of 26 movies, 40 minute traces, ≥ 98% accuracy
Confusion matrix, 10 min traces
Confusion matrix, 40 min traces
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Related Work
✦ Lots of excellent related works, e.g.:
✦ Wright, Ballard, Monrose, Masson.  “Language 
Identiﬁcation of Encrypted VoIP Trafﬁc:  Alejandra 
y Roberto or Alice and Bob?”  USENIX Security 
2007
✦ Wright, Ballard, Coulls, Monrose, and Masson.  
“Spot Me If You Can:  Recovering Spoken Phrases 
in Encrypted VoIP Conversations.”  IEEE 
Symposium on Security and Privacy 2008.
Defeating Deniable File 
Systems:  A TrueCrypt 
Case Study
Alexei Czeskis (University of Washington)
David St. Hilaire University of Washington)
Karl Koscher (University of Washington)
Steven D. Gribble University of Washington)
Tadayoshi (Yoshi) Kohno (University of Washington)
Bruce Schneier (BT)
Protecting Your Data
✦ Can I just encrypt my data? .... well, no
✦ If an attacker sees that there is encrypted 
information, he’ll just ask you for your 
password.
✦ Methods of getting passwords:
✦ Algorithmic, ﬁnes, jail, extortion, torture
Executives have been told that they must hand over their laptop to be analyzed by 
border police--or be barred from boarding their ﬂight. A report from a U.S.-based 
marijuana activist says U.S. border guards browsed through her laptop's contents; 
British customs agents scan laptops for sexual material; so do their U.S. counterparts. 
Deniable File System (DFS)
✦ Idea: hide the existence of a portion of the ﬁle 
system.
✦ The attacker should not be able to distinguish 
random free space from data.
✦ "Deniable Encryption" by Canetti, et al.
(1996). 
Analyzing a DFS
✦ How do we analyze a DFS?
✦ Are there issues that all Deniable File Systems 
must overcome?
✦ Goal: Identify/formalize principles of 
information leaks in Deniable File Systems
✦ Previously: from below (media)
✦ Us: from above (OS, applications)
A DFS Implementation: 
TrueCrypt Hidden Volumes
truecrypt.org
✦ Outer Volume
✦ Non-hidden
✦ Encrypted ﬁle
✦ Free space is 
random data
✦ A container
✦ Inner Volume
✦ Stored inside a 
container
✦ Encrypted with 
different password
Threat Model
✦ One-Time Access
✦ Secret police seize computer
✦ Intermittent Access
✦ HD copied when crossing border in/out
✦ Regular Access
✦ Secret police break into apartment every day
TrueCrypt Case Study
✦ Your computer tells on you.
✦ Information leaks (in Vista):
✦ Operating system (Shortcuts, Registry)
✦ Primary Applications (MS Ofﬁce, 
Photoshop, etc...)
✦ Non-Primary Apps (Google Desktop)
✦ Used OverthrowGovernment.doc
The OS
✦ Registry mentions that a TC volume was 
mounted - not really a problem
✦ Recently used shortcuts are generated 
automatically and show:
✦ real ﬁle’s name
✦ its location
✦ its creation, modiﬁcation, access times
✦ volume type and serial number it was on
Primary Application
✦ By default MS Word auto-saves open ﬁles to a 
directory on the c: drive.
✦ Deleted when word exits successfully
✦ Issues:
✦ Remains on disk when process killed
✦ Not a clean delete
✦ Recoverable even after reboot
Non-Primary Application
✦ Google Desktop enhanced search
✦ Indexes and caches ﬁles from hidden 
volume
✦ When hidden volume is unmounted, the ﬁles 
remain and are easily recovered.
✦ Current and previous versions
The Point is...
✦ It’s hard to have a complete DFS
✦ Issue for any DFS: Every process that 
reads data could potentially store it 
somewhere else
✦ Need
✦ OS support 
✦ Hardware support
Type D: Exploring 
Attacks Against 
Future Systems  
Properties of these projects
✦ Sometimes the systems we wish to study do not 
exist yet “in the wild”
✦ In such cases, we develop and deploy our own 
systems, and then try to “attack” them
✦ The goal is to help us better improve the security 
and privacy of future systems
Exploring Privacy in the 
RFID Ecosystem
Karl Koscher (University of Washington)
Rest of the RFID Ecosystem Team (University of Washington)
About Karl
✦ Ph.D. student at the University of Washington
✦ Working on all sorts of things
✦ Many projects involve RFID and/or privacy
✦ Previously a research engineer at UW, working on:
✦ The RFID Ecosystem
✦ Embedded Systems
✦ Member of the UW Society and Technology Group
✦ Long history of hacking -- ﬁrst post to BugTraq in 
1997
The Future of RFID
✦ Old technology -- around since World War 2
✦ Drastic drops in cost are making the technology 
pervasive
✦ Readers are much less complicated than WiFi 
access points
✦ Economies of scale are the only reason they cost 
more -- this may change!
✦ Once price/tag < 5¢, it’s economical to tag 
EVERYTHING
✦ What happens when this technology is deployed 
everywhere and in everything?
The RFID Ecosystem
✦ RFID will become pervasive
✦ Before that happens, try to ﬁgure out: 
✦ What cool applications does pervasive 
RFID technology enable?
✦ What are the privacy and security issues 
that arise?
The RFID Ecosystem
✦ Building-wide deployment in the Allen Center
✦ Over 30 readers currently deployed
✦ Over 130 antennas currently deployed
✦ Covers ﬂoors 2 - 6
✦ Basement and 1st ﬂoor are coming soon
Deployment Challenges
✦ Some areas are privacy-sensitive (e.g. 
bathrooms)
✦ Exclude these areas from RFID coverage
✦ Antenna deployment must be aesthetically-
pleasing and keep 9” away from bodies
✦ Mounted on the bottom of cable trays
Deployment Map
Privacy Issues
✦ Rogue Surveillance
✦ Institutional Surveillance
✦ Setting the right access controls
✦ Gaming the system
✦ Unintended consequences of privacy controls
Rogue Surveillance
✦ Industry is rallying behind EPC Gen2
✦ Class 1 Gen 2 tags have essentially no security 
features
✦ Anyone with a Gen2 reader can read your 
tags, from potentially far away 
✦ 160+ ft in highly ideal, FCC-compliant tests
✦ We can track anyone with a Washington 
Enhanced Drivers License
Institutional 
Surveillance
✦ In today’s RFID systems, the system owner 
can track all tags everywhere they have 
readers
✦ DEMO
✦ Is this a real threat?
Worker Snooping on Customer Data Common
By RYAN J. FOLEY
MADISON, Wis. (AP) — A landlord snooped on tenants to find out information about their 
finances. A woman repeatedly accessed her ex-boyfriend's account after a difficult 
breakup. Another obtained her child's father's address so she could serve him court 
papers. …
Documents obtained by The Associated Press in an employment case involving Milwaukee-based WE Energies shine a 
light on a common practice in the utilities, telecommunications and accounting industries, privacy experts say.
Vast computer databases give curious employees the ability to look up sensitive information on people with the click of a 
mouse. The WE Energies database includes credit and banking information, payment histories, Social Security 
numbers, addresses, phone numbers, and energy usage. In some cases, it even includes income and medical 
information.
Experts say some companies do little to stop such abuses even though they could lead to identity theft, stalking and 
other privacy invasions. And companies that uncover violations can keep them quiet because in many cases it is not 
illegal to snoop, only to use the data for crimes.
Tracking customers?
Boeing bosses spy on workers
By ANDREA JAMES
P-I REPORTER
Within its bowels, The Boeing Co. holds volumes of proprietary information 
deemed so valuable that the company has entire teams dedicated to making 
sure that private information stays private.
One such team, dubbed "enterprise" investigators, has permission to read the 
private e-mails of employees, follow them and collect video footage or photos of 
them. Investigators can also secretly watch employee computer screens in real 
time and reproduce every keystroke a worker makes, the Seattle P-I has 
learned. 
For years, Boeing workers have held suspicions about being surveilled, 
according to a long history of P-I contact with sources, but at least three people 
familiar with investigation tactics have recently confirmed them.
Access Control Policies
✦ Hard to get right
✦ Time consuming even for experts
✦ One option: Reuse existing social networks
✦ Facebook application now being developed
✦ What should a usable “default” be?
Physical Access Control 
✦ Idea: Have access to tag reads that you could 
have physically seen
✦ Simple mental model
✦ Minimal level of access while still being usable
✦ Not perfect: 
✦ Assumes 360 degree vision
✦ Can potentially reveal tags through walls
Physical Access Control to Captured RFID Data (2007, Kriplean, Welbourne, 
Khoussainova, Rastogi, Balazinska, Borriello, Kohno, Suciu)
Gaming the System
✦ How do we determine your location?
✦ It’s your “person” tag!
✦ No reason why you have to keep it with you...
✦ No reason why you can’t clone it!
✦ No reason why you can’t put it on someone 
else!
Unintended 
Consequences
✦ What if we notiﬁed you when someone 
queried for your location?
✦ This reveals potentially private information 
about the requester!
✦ Implemented in an undergrad class
✦ One student felt unpopular because her 
location wasn’t being queried often by her 
friends
Part 2: Hacking in 
the Undergraduate 
Curriculum
The Security Mindset
Developing the “Security Mindset” in a University of 
Washington undergraduate computer security course
Part 3: The Industry 
Perspective
About Jon
✦ Co-founder of PGP Corporation
✦ Been involved in OS security and crypto for 
many years
✦ Past work: DEC, Apple, Counterpane
✦ Co-author of OpenPGP, DKIM standards
How do we feel?
✦ The smart people love it
✦ Part of my goal: to help people get smart
✦ Fight-or ﬂight can be powerful
Educates the market
✦ Market forces frequently punish a secure 
system
✦ People have to know about insecurities
✦ If people get used to them, it’s hard to 
upgrade
Hacking is Important
✦ It shows limitations of present thought
✦ It shows what is important
✦ It is believed people won’t buy security
✦ It is believed people don’t care about 
privacy
✦ Should we care, ourselves?
We beneﬁt as well
✦ Does a new technology work as advertised?
✦ What are its downsides?
✦ Who is doing something we don’t like?
Independent voices are needed
✦ There is no better way to test a system
✦ Practice is better than theory
Peer Review
✦ It adds weight to the results
✦ It provides safety to the scientists
✦ It can protect upsetting results
✦ It removes political debate
✦ We get people’s attention better
Hackers and Academics
✦ Some of the best hackers are academics
✦ Some of the best researchers are hackers
✦ The two communities should work more 
closely
We want to work with scientists
✦ Peer Review helps science and technology
✦ PGP source has been available on web for 
peer review for many years
✦ We also hire researchers to test us
✦ Smart industry players feel the same way
Part 4: Your Turn
Conclusions