User: In python2.7 on Windows, I need to get the name of the default microphone, which will be a string such as "Microphone (2- High Definition Audio Device)".
My first attempt was to query WMI using subprocess: wmic path Win32_SoundDevice get * /format:list. Unfortunately, this seems to return speakers as well as mics, and I can't see any property that would let me distinguish the two. Also, the name of the correct device is not in the right format, e.g. it appears as simply "High Definition Audio Device" instead of the full correct string "Microphone (2- High Definition Audio Device)".
My second attempt was to use PyAudio (the python bindings to PortAudio). Calling PyAudio().get_default_input_device_info()["name"] gets me pretty close, but unfortunately the name is getting truncated for some reason! The return value is "Microphone (2- High Definition " (truncated to 31 characters length). If I could only get a non-truncated version of this string, it would be perfect.
Any ideas for what is the simplest, most self-contained way to get the default microphone name? Thanks!
Assistant: Apparently I can get the full string from ffmpeg, as follows:
ffmpeg -list_devices true -f dshow -i dummy
And then the name of the mic will be on the line after "DirectShow audio devices"