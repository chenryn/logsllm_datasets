# The Best of Times
Category: Forensics, 150 Points
## Description
> An obscure entity, known only as "K9" has contacted the agency.
> 
> The message states that they have sniffed out a flag from right under our noses, and it is now up to you to find which integral part of our communication has been compromised and revoke its validity!
A binary file was attached.
## Solution
Let's check the binary file:
```console
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# cat dump.bin | head
45 00 00 4a 31 0e 40 00 40 11 a9 bc c0 a8 ef 84
c0 a8 ef 02 45 00 00 5a af 89 00 00 80 11 2b 31
c0 a8 ef 02 c0 a8 ef 84 45 00 00 47 b0 9d 00 00
80 06 c9 66 34 23 dc 5c c0 a8 ef 84 45 00 00 28
aa 31 40 00 40 06 cf f1 c0 a8 ef 84 34 23 dc 5c
45 00 00 4b aa 32 40 00 40 06 cf cd c0 a8 ef 84
34 23 dc 5c 45 00 00 28 b0 9e 00 00 80 06 c9 84
34 23 dc 5c c0 a8 ef 84 45 00 00 4f 61 61 40 00
40 06 69 53 c0 a8 ef 84 ac d9 12 ee 45 00 00 28
b0 9f 00 00 80 06 1a 3c ac d9 12 ee c0 a8 ef 84
```
It's an ASCII file containing what looks like a HEX dump. Let's convert it into a real binary file:
```console
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# cat dump.bin | xxd -r -p > hexdump.bin
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# xxd -g 1 hexdump.bin | head
00000000: 45 00 00 4a 31 0e 40 00 40 11 a9 bc c0 a8 ef 84  E..J1.@.@.......
00000010: c0 a8 ef 02 45 00 00 5a af 89 00 00 80 11 2b 31  ....E..Z......+1
00000020: c0 a8 ef 02 c0 a8 ef 84 45 00 00 47 b0 9d 00 00  ........E..G....
00000030: 80 06 c9 66 34 23 dc 5c c0 a8 ef 84 45 00 00 28  ...f4#.\....E..(
00000040: aa 31 40 00 40 06 cf f1 c0 a8 ef 84 34 23 dc 5c  .1@.@.......4#.\
00000050: 45 00 00 4b aa 32 40 00 40 06 cf cd c0 a8 ef 84  E..K.2@.@.......
00000060: 34 23 dc 5c 45 00 00 28 b0 9e 00 00 80 06 c9 84  4#.\E..(........
00000070: 34 23 dc 5c c0 a8 ef 84 45 00 00 4f 61 61 40 00  4#.\....E..Oaa@.
00000080: 40 06 69 53 c0 a8 ef 84 ac d9 12 ee 45 00 00 28  @.iS........E..(
00000090: b0 9f 00 00 80 06 1a 3c ac d9 12 ee c0 a8 ef 84  .......<........
```
Now let's check if it has any familiar format:
```console
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# file hexdump.bin
hexdump.bin: data
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# binwalk hexdump.bin
DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
```
Doesn't seem so.
Ok then, let's try to find a record structure. If we align the lines in groups of 20 bytes, we can see a nice pattern:
```console
root@kali:/media/sf_CTFs/matrix/The_Best_of_Times# xxd -g 1 -c 20 hexdump.bin
00000000: 45 00 00 4a 31 0e 40 00 40 11 a9 bc c0 a8 ef 84 c0 a8 ef 02  E..J1.@.@...........
00000014: 45 00 00 5a af 89 00 00 80 11 2b 31 c0 a8 ef 02 c0 a8 ef 84  E..Z......+1........
00000028: 45 00 00 47 b0 9d 00 00 80 06 c9 66 34 23 dc 5c c0 a8 ef 84  E..G.......f4#.\....
0000003c: 45 00 00 28 aa 31 40 00 40 06 cf f1 c0 a8 ef 84 34 23 dc 5c  E..(.1@.@.......4#.\
00000050: 45 00 00 4b aa 32 40 00 40 06 cf cd c0 a8 ef 84 34 23 dc 5c  E..K.2@.@.......4#.\
00000064: 45 00 00 28 b0 9e 00 00 80 06 c9 84 34 23 dc 5c c0 a8 ef 84  E..(........4#.\....
00000078: 45 00 00 4f 61 61 40 00 40 06 69 53 c0 a8 ef 84 ac d9 12 ee  E..Oaa@.@.iS........
0000008c: 45 00 00 28 b0 9f 00 00 80 06 1a 3c ac d9 12 ee c0 a8 ef 84  E..(.......<........
000000a0: 45 00 00 4f b0 a2 00 00 80 06 1a 12 ac d9 12 ee c0 a8 ef 84  E..O................
000000b4: 45 00 00 28 61 62 40 00 40 06 69 79 c0 a8 ef 84 ac d9 12 ee  E..(ab@.@.iy........
000000c8: 45 00 00 56 91 cb 40 00 40 06 df fe c0 a8 ef 84 97 65 81 45  E..V..@.@........e.E
000000dc: 45 00 00 28 b0 a5 00 00 80 06 c1 52 97 65 81 45 c0 a8 ef 84  E..(.......R.e.E....
000000f0: 45 00 00 56 b0 a6 00 00 80 06 c1 23 97 65 81 45 c0 a8 ef 84  E..V.......#.e.E....
00000104: 45 00 00 28 91 cc 40 00 40 06 e0 2b c0 a8 ef 84 97 65 81 45  E..(..@.@..+.....e.E
00000118: 45 00 00 4f 61 63 40 00 40 06 69 51 c0 a8 ef 84 ac d9 12 ee  E..Oac@.@.iQ........
0000012c: 45 00 00 28 b0 aa 00 00 80 06 1a 31 ac d9 12 ee c0 a8 ef 84  E..(.......1........
00000140: 45 00 00 4f b0 ac 00 00 80 06 1a 08 ac d9 12 ee c0 a8 ef 84  E..O................
00000154: 45 00 00 28 61 64 40 00 40 06 69 77 c0 a8 ef 84 ac d9 12 ee  E..(ad@.@.iw........
00000168: 45 00 00 56 91 cd 40 00 40 06 df fc c0 a8 ef 84 97 65 81 45  E..V..@.@........e.E
0000017c: 45 00 00 28 b0 b0 00 00 80 06 c1 47 97 65 81 45 c0 a8 ef 84  E..(.......G.e.E....
00000190: 45 00 00 56 b0 b1 00 00 80 06 c1 18 97 65 81 45 c0 a8 ef 84  E..V.........e.E....
000001a4: 45 00 00 28 91 ce 40 00 40 06 e0 29 c0 a8 ef 84 97 65 81 45  E..(..@.@..).....e.E
000001b8: 45 00 00 1c 00 01 00 00 4d 11 1c a0 1b 04 14 12 0e 07 14 14  E.......M...........
000001cc: 45 00 00 1c 00 01 00 00 43 11 26 a0 1b 04 14 12 0e 07 14 14  E.......C.&.........
000001e0: 45 00 00 71 91 cf 40 00 40 06 df df c0 a8 ef 84 97 65 81 45  E..q..@.@........e.E
000001f4: 45 00 00 28 b1 98 00 00 80 06 c0 5f 97 65 81 45 c0 a8 ef 84  E..(......._.e.E....