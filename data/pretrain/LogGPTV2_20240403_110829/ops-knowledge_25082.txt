User: Please provide a shell script to regularly check and clean up useless files on the server
Assistant: The following is an example of a simple shell script to periodically check and clean up useless files on the server. The script will search for files in the specified directory, judge whether they are useless files according to the last access time of the files, and delete them if so. ```bash #!/bin/bash # Set the directory to be checked and the retention time (unit: day) dir_to_check="/var/log/" reserved_days=30 # Get the current timestamp now=$(date +%s) # Calculate the timestamp that needs to be reserved reserved_ts=$((now - reserved_days * 24 * 3600)) # Traverse the files in the directory for file in $(find $dir_to_check -type f) do # Get the last access timestamp of the file last_access_ts=$ (stat -c %X $file) # Determine whether the current file is a useless file if [ $last_access_ts -lt $reserved_ts ] then # Delete useless files rm $file echo "Removed file: $file" fi done echo "Cleanup completed." ``` Save the above script as an executable file, and then use crontab to execute it regularly: ``` # Execute 0 2 1 * * /path/to/cleanup_script.sh at 2 am on the 1st of each month ``` In this way, every At 2 o'clock in the morning on the first day of the month, the server will automatically perform an operation to check and clean up useless files. It should be noted that the directory and retention time in the script should be modified according to actual needs.