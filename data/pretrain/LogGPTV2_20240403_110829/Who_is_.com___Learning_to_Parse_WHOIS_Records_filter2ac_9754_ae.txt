(2.8)
547,338
417,705
(2.2)
380,223
(2.0)
5255675 (27.2)
19,325,484 (100.0)
Country
United States
Japan
China
Vietnam
Canada
France
India
United Kingdom
Turkey
Russia
(Other)
(Unknown)
Total
Number (% All)
32,513 (43.8)
18,630 (25.1)
11,882 (16.0)
(1.3)
965
(1.2)
893
(1.2)
860
(0.9)
696
(0.9)
693
(0.7)
546
(0.5)
402
(5.9)
4,390
1,831
(2.5)
74,301 (100.0)
Registrar
eNom
GoDaddy
GMO Internet
Register.com
Moniker
Network Solutions
Public Domain Registry
Xinnet
Name.com
Bizcn.com
(Other)
Total
Number (% All)
21,844 (25.1)
18,085 (20.8)
17,866 (20.5)
3,880
(4.5)
(3.8)
3,298
(3.6)
3,164
(2.5)
2,189
(2.7)
2,383
2,381
(2.2)
1,991
(2.3)
12,399 (14.2)
87,099 (100.0)
Table 7: Top 10 privacy protection services
used for com domains.
Table 8: Top 10 countries of registrants of
com domains on the DBL in 2014.
Table 9: Top 10 registrars of domains on
the DBL in 2014.
6.3 Privacy Protection
From Section 6.1, we saw that the use of privacy protection ser-
vices is increasing over time and, overall, we found that 20% of all
com domains use a privacy protection service. Table 7 shows the
top 10 services as reported in the WHOIS records, both in terms of
the number of com domains registered through their service and as
the percentage of all domains using privacy protection. We identify
privacy protection services using a small set of keywords to match
against registrant name and/or organization ﬁelds in the WHOIS
records, which we crafted by looking through lists of records sorted
by registrants and organizations (they stand out because they by
deﬁnition have many domains associated with them).
The most prominent privacy protection service is Domains By
Proxy, which is owned by the founder of the GoDaddy registrar
and accounts for 36% of protected com domains. Although there
is a long tail of service names, the top 10 account for 73% of pro-
tected domains. However, the names used in the WHOIS records for
protected domains do not always correspond to organizations that
we could identify (Private Registration, Hidden by Whois Privacy
Protection Service). This behavior suggests that exploring the use,
identity, and operation of protection services in further detail, in ad-
dition to the registrants of those services [3], could be an interesting
open topic.
From a different perspective, Table 6 shows the top 10 regis-
trars through which privacy protection domains have been regis-
tered. The registrars used largely track the list of all com domains
in Table 5.11
6.4 Blacklisted Domains
Domain blacklists are a common source of identifying abusive
domains. As a ﬁnal survey, we look at the WHOIS records for com
domains that appear on the Domain Block List (DBL).12 Note that
the DBL blacklist is populated from domains that appear in spam.
Because domains in other TLDs are often cheaper than com, com
domains only represents a portion (46%) of all domains in the DBL.
But doing the analysis provides some insight into trends revealed
from looking at WHOIS features. Also, we focus on just those do-
11Note that our crawler exceeded the rate limit for Network Solu-
tions domains, so we only have their thin records and cannot report
the prevalence of privacy protection in Network Solutions.
12https://www.spamhaus.org/dbl
mains created in 2014 to minimize domain expiration; 58.8% of
com domains on the DBL were created in 2014, so this set repre-
sents the bulk of com domains on the DBL.
Table 8 shows the top 10 registrant countries for com domains on
the DBL. Comparing with the countries for all domains in Table 3,
both the percentages and rank orderings have notable differences
for domains on the blacklist: in particular, registrants from Japan,
China, and Vietnam are much more pronounced.
From another perspective, Table 9 shows the top 10 registrars
through which com domains on the DBL are registered. Similarly
comparing with the registrars for all domains in Table 5, the results
have some interesting differences. Registrars that have been impli-
cated in abuse (eNom, Xin Net) are more prominent, and new reg-
istrars appear on the top list (Moniker, evoPlus, Bizcn.com, etc.).
These results suggest that, in addition to registrar, country infor-
mation would likely be a useful feature, e.g., for predicting domains
used in abuse [6, 11].
7. CONCLUSION
In this paper we have developed a statistical parser for WHOIS
records that learns a general model from labeled examples, is easy
to maintain and achieves extremely high accuracy in practice. We
demonstrate its utility by providing an initial survey of registration
patterns in the com TLD. Finally, code and data from our study is
available at: http://www.sysnet.ucsd.edu/projects/whois.
Acknowledgments
We would like to thank our shepherd Walter Willinger for his valu-
able guidance, and the anonymous reviewers for their helpful sug-
gestions. We are also very grateful to Neha Chachra and Chris
Grier for their assistance with the proxy network, and we are par-
ticularly indebted to Paul Pearce for going above, beyond and be-
yond again in our time of need. We would also like to thank Cindy
Moore for managing the software and systems used for this project.
This work was supported by National Science Foundation grant
NSF-1237264 and by generous research, operational and/or in-kind
support from Google, Microsoft, Yahoo, and the UCSD Center for
Networked Systems (CNS).
8. REFERENCES
[1] X. Cai, J. Heidemann, B. Krishnamurthy, and W. Willinger.
Towards an AS-to-Organization Map. In Proceedings of the
10th ACM/USENIX Internet Measurement Conference
(IMC), Nov. 2010.
[2] CAUCE. Submission to ICANN WHOIS Team review.
http://www.cauce.org/2011/04/
submission-to-icann-whois-team-review.html,
Apr. 2011.
[3] R. Clayton and T. Mansﬁeld. A Study of Whois Privacy and
Proxy Service Abuse. In Proceedings of the 13th Workshop
on Economics of Information Security (WEIS), June 2014.
[4] L. Daigle. RFC 3912: WHOIS Protocol Speciﬁcation. IETF,
Sept. 2004.
[5] Z. Durumeric, E. Wustrow, and J. A. Halderman. ZMap: Fast
Internet-Wide Scanning and its Security Applications. In
Proceedings of the 22nd USENIX Security Symposium, Aug.
2013.
[6] M. Felegyhazi, C. Kreibich, and V. Paxson. On the Potential
of Proactive Domain Blacklisting. In Proceedings of the
USENIX Workshop on Large-scale Exploits and Emergent
Threats (LEET), San Jose, CA, Apr. 2010.
[7] I. Fette, N. Sadeh, and A. Tomasic. Learning to Detect
Phishing Emails. In Proceedings of the International World
Wide Web Conference, May 2007.
[8] T. Frosch. Mining DNS-related Data for Suspicious Features.
Master’s thesis, Ruhr Universitat Bochum, 2012.
[9] M. Gabielkov and A. Legout. The Complete Picture of the
Twitter Social Graph. In ACM CoNEXT 2012 Student
Workshop, Dec. 2012.
[10] H. Gao, J. Hu, C. Wilson, Z. Li, Y. Chen, and B. Y. Zhao.
Detecting and Characterizing Social Spam Campaigns. In
Proceedings of the 10th ACM SIGCOMM Conference on
Internet Measurement (IMC), 2010.
[11] S. Hao, M. Thomas, V. Paxson, N. Feamster, C. Kreibich,
C. Grier, and S. Hollenbeck. Understanding the Domain
Registration Behavior of Spammers. In Proceedings of the
13th ACM/USENIX Conference on Internet Measurement
(IMC), 2013.
[12] K. Harrenstien, M. Stahl, and E. Feinler. RFC 812:
NICNAME/WHOIS. IETF, Mar. 1982.
[18] A. Mislove, H. S. Koppula, K. P. Gummadi, P. Druschel, and
B. Bhattacharjee. Growth of the Flickr Social Network. In
Proceedings of the 1st ACM SIGCOMM Workshop on Social
Networks (WOSN), Aug. 2008.
[19] A. Mislove, M. Marcon, K. P. Gummadi, P. Druschel, and
B. Bhattacharjee. Measurement and Analysis of Online
Social Networks. In Proceedings of the 5th ACM/USENIX
Internet Measurement Conference (IMC), Oct. 2007.
[20] A. Newton and S. Hollenbeck. Registration Data Access
Protocol Query Format: Draft Standard. https://tools.
ietf.org/html/draft-ietf-weirds-rdap-query-18,
Dec. 2014.
[21] J. Nocedal and S. J. Wright. Numerical Optimization.
Springer, New York, 2nd edition, 2006.
[22] Nominet. Contact Data Disclosure in the .uk WHOIS:
Appendix I. http://www.nominet.org.uk/sites/
default/files/Appendix-I-Comparative-registry-
and-WHOIS-data-publication-review.pdf, 2015.
[23] F. Sha and F. Pereira. Shallow Parsing with Conditional
Random Fields. In Proceedings of the Conference of the
North American Chapter of the Association for
Computational Linguistics on Human Language Technology
(NAACL), 2003.
[24] T. Stallings, B. Wardman, G. Warner, and S. Thapaliya.
"WHOIS" Selling All The Pills. International Journal of
Forensic Science, 7(2):46–63, 2012.
[25] J. Szurdi. Understanding the Purpose of Domain
Registrations. Master’s thesis, Budapest University of
Technology and Economics, 2012.
[26] T. Vissers, W. Joosen, and N. Nikiforakis. Parking Sensors:
Analyzing and Detecting Parking Domains. In Proceedings
of the Network and Distributed System Security Symposum
(NDSS), Feb. 2015.
[13] ICANN. Draft Report for the Study of the Accuracy of
WHOIS Registrant Contact Information. https:
//www.icann.org/en/system/files/newsletters/
whois-accuracy-study-17jan10-en.pdf, Jan. 2010.
[14] ICANN. Policy Issue Brief — gTLD WHOIS.
https://www.icann.org/resources/pages/
whois-2012-06-14-en, June 2012.
[15] J. D. Lafferty, A. McCallum, and F. C. N. Pereira.
Conditional Random Fields: Probabilistic Models for
Segmenting and Labeling Sequence Data. In Proceedings of
the Eighteenth International Conference on Machine
Learning (ICML), 2001.
[16] A. McCallum and W. Li. Early Results for Named Entity
Recognition with Conditional Random Fields, Feature
Induction and Web-enhanced Lexicons. In Proceedings of
the Seventh Conference on Natural Language Learning
(CONLL), 2003.
[17] D. K. McGratn and M. Gupta. Behind Phishing: An
Examination of Phisher Modi Operandi. In Proceedings of
the USENIX Workshop on Large-scale Exploits and
Emergent Threats (LEET), Apr. 2008.
Then we ﬁll in the matrix elements recursively, one column at a
time, as follows:
Vjt = max
i Vi,t 1 +Xk
✓kfk(i, j, xt) .
(15)
In terms of this matrix, the most likely label at time T is simply
by y⇤T = arg maxi ViT . To derive the most likely labels at earlier
times, we only need to record the index used at each step of the
recursion in eq. (15). In particular, let
INDEXt(j) = arg max
i
Vi,t 1 +Xk
✓kfk(i, j, xt) .
(16)
Then in terms of these indices, the most likely labels at all earlier
times are derived from the backtracking procedure:
y⇤t = INDEXt+1(y⇤t+1).
(17)
Finally we note that this computation for the most likely labels y⇤t
can also be performed in O(n2T ) operations.
APPENDIX
A. PROBABILISTIC INFERENCE
In this appendix we describe the essential computations for prob-
abilistic inference in CRFs. By exploiting the Markov property in
CRFs, we can efﬁciently compute both the log-likelihood in eq. (4)
and the most likely label sequence in eq. (5).
First, we consider the normalization factor in eq. (3), whose com-
putation requires summing over the exponentially many label se-
quences of length T . Let n denote the number of states in the CRF.
As a useful shorthand, we deﬁne an n⇥n matrix Mt at each time
step t, whose elements are given by:
[Mt]ij = exp"Xk
✓kfk(yt 1 = i, yt = j, xt)# .
(9)
As previously noted, it is to be understood in eq. (9) that the sum
over k at time t = 1 only ranges over those features that do not have
any dependence on the argument yt 1. It is then a straightforward
exercise to show that the normalization factor in eq. (3) is given by:
Z✓(x) = Xij
[M1M2 . . . MT]ij .
(10)
This computation, which involves T matrix-vector products, can be
performed in O(n2T ) operations.
Once the normalization factor in eq. (10) is computed, the log-
likelihood in eq. (4) follows immediately. In particular, substituting
eq. (2) into eq. (4), we obtain:
✓kfk(yr
t 1, yr
t , xr
t )   log Z✓(xr)35 .
(11)
L(✓) =
RXr=1
24Xt,k
Eq. (11) gives the log-likelihood L(✓) explicitly as a function of the
model parameters ✓. In order to optimize these parameters, it is of
course necessary to compute the gradient @L@✓ . This can be done us-
ing the forward-backard algorithm for CRFs, which involves just a
simple extension of the procedure for computing the normalization
factor Z✓(x). In particular, the elements of the gradient are closely
related to the marginal probabilities of the distribution in eq. (2).
But these, for example, are given simply by:
Pr✓(yt 1= `, yt = m|x)
=
1
Z✓(x)Xij
[M1 . . . Mt 1]i` [Mt . . . MT]mj.
(12)
We refer the reader to the classic treatment [15] of CRFs for more
details.
Finally we show how to compute the most likely sequence of la-
bels in eq. (5). The computation is simpliﬁed by working in the
log-domain and noting that the normalization factor Z✓(x) is in-
dependent of y. From these considerations we obtain the simpler
expression:
y⇤ = arg max
y
24Xt,k
✓kfk(yt 1, yt, xt)35 .
(13)
The computation in eq. (13) is a straightforward exercise in dy-
namic programming. We introduce an n⇥ T matrix V and deﬁne
its ﬁrst column by:
Vi1 =Xk
✓kfk(y1 = i, x1).
(14)