在通信信道上可以进行一对一的双向保密通信。
从已知的 PKB 实际上不可能推导出 SKB，即从 PKB 到 SK 是"计算上不可能 
口例如：很多用户都向同一个网站发送各自的信用卡信息。
加密和解密运算可以对调，即加密和解密是互逆的：
加密密钥是公开的，
Epk, Dsk (X) = Dskg (EPk(X))= X
但不能用来解密，即
Dpk, (EpkB (X)≠ X
2.3两类密码体制的不同
2.2公钥密码体制
26
25
3
---
## Page 14
口鉴别(authentication)是网络安全中一个很重要的问题。
3.鉴别
任何加密方法的安全性取决于密钥的长度
报文鉴别通常包含：鉴别报文的发送者，鉴别报文的完整性。
也常称为端点鉴别。
实体：发信的人或进程。
鉴别发信者，防止冒充者。
以及攻破密文所需的计算量
实体鉴别
·报文未被他人篡改过。
鉴别报文的完整性
3.1报文鉴别
28
4
---
## Page 15
3.鉴别
口鉴别(authentication)是网络安全中一个很重要的问题。
口
3.鉴别
用数字签名进行鉴别 (原理)
明文
X
A的私钥SKA
B 为了核实签名，用A的公钥PKA 进行E运算，还原出明文X。
A用其私钥 SKA 对报文X 进行D运算得到的密文。
要鉴别。
但许多报文不需要加密，但需
加密可以实现鉴别。
签名
鉴别与加密不同
密文Y
鉴别发送者：
互联网
行读或写）。
允许（如是否可以对某文件进
问题是：所进行的过程是否被
授权（authorization）涉及的
密文Y
鉴别与授权不同
核实签名
A的公钥PKA
回
明文X
3.1报文鉴别
3.1报文鉴别
30
15
---
## Page 16
口
3.鉴别
3.鉴别
用数字签名进行鉴别 (原理)
用数字签名进行鉴别 (原理)
X
A的私钥SKA
A的私钥SKA
第三者很容易用PKA去证实A确实发送X给B。
△
由于无法得到并使用A 的私钥 SKA 对报文×进行D 运算，B 对收到的报文进行
A要抵赖曾发送报文给B，B可把×及DsKA（X)出示给进行公证的第三者。
签名
签名
密文Y
密文Y
不可否认：
鉴别报文：
互联网
互联网
密文Y
密文Y
运臭
核实签名
A的公钥PKA
核实签名
A的公钥PKA
3.1报文鉴别
B
明文X
3.1报文鉴别
+
T
32
31
---
## Page 17
3.鉴别
3.鉴别
用数字签名进行鉴别 (原理)
签名
A 的私钥SKAB的公钥 PKB
A的私钥SKA
不可否认：防抵赖。
报文鉴别：防篡改，保证完整性。
实体鉴别：证明来源。
签名
X
加密
运
运
密文Y
可保证机密性的数字签名
数字签名的三个功能：
加密与解密
互联网
互联网
密文
X)
CPU时间
密文Y
B的私钥 SK;A的公钥 PKA
解密
Dska (X)
运臭
核实签名
A的公钥PKA
核实签名
3.1报文鉴别
B
明文
3.1报文鉴别
明文X
B
34
33
L
---
## Page 18
口密码散列函数
3.鉴别
密码散列函数
3.鉴别
■MD5算法
口
口MD5 的设计者 Rivest 曾提出-
这暑发送的不震
任意长度的明文X
基本思想：
用足够复杂的方法，
使报文摘要
密码散列函数是单向的
逆向变换是不可能的
代码
单向散列变换
猜
X
溢
+
相同报文摘要的另一报文，其难度在计
的散列值 H(X)
输出固定长度
0...
0...
3.1报文鉴别
3.1报文鉴别
36
35
---
## Page 19
口密码散列函数
3.鉴别
口密码散列函数
3.鉴别
■MD5算法计算步骤
■MD5算法计算步骤
③分组：把追加和填充后的报文分割为多个512位的数据块，每个512位的报文数
①附加：把任意长的报文按模264计算其余数（64位），
赌码
计算：将4个128位的数据块依次送到不同的散列函数进行4轮计算。
都按32 位的小数据块进行复杂的运算。
MD5
报文，这对报文具有相同的MD5报文，而这仅需15分钟，或不到1小时。
在2004年，中国学者王小云发表了轰动世界的密码学论文，证明可以用系统的方法找出一对
最终被安全散列算法SHA标准所取代。
带填充位的长度，模512余448-
报文长度-
报文
总长度，512的整数倍
1000...00
一直到最后计算出MD5报文摘要代
64位→
余数
，追加在报文的后面。
3.1报文鉴别
3.1报文鉴别
，每一轮
38
6
---
## Page 20
口
3.鉴别
口密码散列函数
3.鉴别
■安全散列算法 SHA-1
密码散列函数
■安全散列算法 SHA-1
口SHA-3的多种变型：
口 SHA-2 的多种变型：
口SHA-1已被 SHA-2、
口和 MD5 相似，但其散列值的长度为160 位。
口安全散列算法 SHA(Secure Hash Algorithm)：日
口
SHA-1散列值的另一报文Y。
前，密码学家尚无法把一个任意已知的报文×，篡改为具有同样MD5
出散列值。
SHA-1也是先把输入报文划分为许多512位长的数据块，然后经过复杂运算后得
的一个散列算法系列。
SHA-224，SHA-256，SHA-384,SHA-512。
SHA3-224, SHA3-256, SHA3-384, SHA3-512。
SHA-3采用了与SHA-2 完全不同的散列函数。
谷歌也宣布了攻破SHA-1的消息。
SHA-1曾被王小云教授的研究团队攻破。
但 SHA-1后来也被证明其实际安全性并未达到设计要求。
、SHA-3所替代。
由美国标准与技术协会 NIST 提出
3.1报文鉴别
3.1报文鉴别
39
40
2
---
## Page 21
3.鉴别
口用报文鉴别码实现报文鉴别
3.鉴别
用报文鉴别码实现报文鉴别
口
■散列函数问题：可以防篡改，
■散列函数问题：可以防篡改，但不能防伪造，
■解决方法：采用报文鉴别码MAC。
口散列运算得出的结果为固定长度的 H(X+K)，称为报文鉴别码 MAC(Message
口把双方共享的密钥K与报文×进行拼接，然后进行散列运算。
A发送报文
伪
Authentication Code).
造报
W
H(M
M
送数据
但不能防伪造，不能真正实现报文鉴别。
H(M)
(X)H
?
H(M)
H,(M)
H(X)
H(X)
比较
H,(M)=H(M)，是 A 发送过来的
H,(X)≠H(X)，不是 A发送过来的。
不能真正实现报文鉴别。
H,(X)=H(X)，是 A 发送过来的。
3.1报文鉴别
3.1报文鉴别
42
41
Z
---
## Page 22
3.鉴别
3.鉴别
报文X
这
·没有对报文进行加密，
A
入侵者没有 A 的私钥，因此不可能伪造出 A 发出的报文。
D运算
A的私钥
这样的报文鉴别码称为数字签名或数字指纹。
鉴别过程并没有执行加密算法，消耗的计算资源少。
只要入侵者不掌握密钥K，就无法伪造A发送的报文（因为无法伪造A的MAC）。
H(X + K)
使用已签名的报文鉴别码MAC对报文鉴别
MAC
MAC
田
→MAC报文X
，而是对很短的散列H(X)进行D运算。
MAC报文
用报文鉴别码MAC鉴别报文
扩展的报文
展的报
不安全信道
互联网
不安全信道
A的公钥
MAC
MAC报文X
MAC报文X
运算
密钥K
MAC1
拼接
3.1报文鉴别
3.1报文鉴别
H(X)
44
---
## Page 23