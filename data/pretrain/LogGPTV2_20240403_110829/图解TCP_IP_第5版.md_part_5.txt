如前面所介绍，互联网是由许多独立发展的网络通信技术融合面成。能够使
它们之间不断融合并实现统一的正是TCP/IP技术。那么TCP/IP的机制究竞又是
如何呢？
TCP/IP是通信协议的统称。在学习下一章TCP/IP核心机制之前，有必要先
理清“协议”的概念。
回连接人与人的计算机网络
计算机网络最初的目的是连接一个个独立的计算机，使它们组成一
个更强有力的计算环境。简而言之，就是为了提高生产力。从批处理时
代到计算机网络时代，非庸置疑，都体现了这一目的。然而，现在却似
手有了微妙的变化。
现代计算机网络的首要目的之一，可以说是进接人与人。置身于世界
各地的人们可以通过网络建立联系、相互沟通、交流思想。然而这些在计
算机网络初期是无法实现的。这种连接人与人的计算机网络，已经逐渐给
人们的日常生活、学校教育、科学研究、公司发展带来了巨大的变革。
---
## Page 27
1.3
11
协议
71.3.1随处可见的协议
在计算机网络与信息通信领城里，人们经常提及“协议”一词。互联网中常
用的具有代表性的协议有IP、TCP、HTTP等。面LAN（局域网）中常用的协议
司开的N
有IPX/SPX”等。
“计算机网络体系结构”将这些网络协议进行了系统的归纳。TCP/IP就是
IP、TCP、HTTP等协议的集合。现在，很多设备都支持TCP/IP。除此之外，还
有很多其他类型的网络体系结构。例如，Novell公司的IPX/SPX、苹果公司的Ap
pleTalk（仅限苹果公司计算机使用）、IBM公司开发的用于构建大规模网络的
1996年被农用。
SNA”以及前DEC公司”开发的DECnet等。
各种同络体系结构及其
网络体系结构
协
议
主要用途
TCP/IP
IP, ICMP, TCP, UDP, HTTP,
TELNET, SNMP, SMTP.
互联网、局城网
IPX/SPX
(NetWare)
IPX, SPX, NPC...
个人电脑局城网
AppleTalk
DDP, RTP, AEP, ATP, ZIP..
草果公司现有产品的局域网
DECset
DPR, NSP, SCP.
前DEC小型机
IS0
FTAM, MOTIS, VT, CMIS/CMIP,
CLNP, CONP...
r Xernt Netwok Services
XNS
IDP, SPP, PEP..
施乐公司网络
 1. 3. 2
协议的必要性
通常，我们发送一封电子邮件、访问某个主页获取信息时察觉不到协议的存
在，只有在我们重新配置计算机的网络连接、修改网络设置时才有可能涉及协议。
因此只要网络设置完成、联网成功，人们通常也就会忘记协议之类的事情。只要
应用程序了解如何利用相关协议，就足以让人们顺利使用所建的网络连接。通常
也不会有一个人因为不懂某些协议导致不能上网的情况。然面在通过网络实现互
通信的过程背后，协议却起到了至关重要的作用。
简单来说，协议就是计算机与计算机之间通过网络实现通信时事先达成的一
种“约定”。这种“约定”使那些由不同厂商的设备、不同的CPU以及不同的操
作系统组成的计算机之间，只要遵循相同的协议就能够实现通信。反之，如果所
使用的协议不同，就无法实现通信。这就好比两个人使用不同国家的语言说话，
怎么也无法相互理解。协议可以分为很多种，每一种协议都明确地界定了它的行
为规范。两台计算机之间必须能够支持相同的协议，并遵循相同协议进行处理，
这样才能实现相互通信。
---
## Page 28
12
第1章同络基础知识
 CPU 与 OS
CPU（Central Procesing Unit）译作中央处理器。它如周一台计算机
的“心脏”，每个程序实际上是由它调度执行的。CPU的性能很大程度上
也决定着一台计算机的处理性能。因此人们常说计其机的发展史实际上
是CPU的发展史。
目前人们常用的CPU有Intel Core、Intel Atom 以及ARM Cortex 等
产品。
0S（Operating System）评作操作系统，是一种基础软件。它集合了
CPU管理、内存管理、计算机外国设备管理以及程序运行管理等重要功
能。本书所要介绍的TCP或IP协议的处理，很多情况下其实已经内丧到
其体的操作系统中了。如今在个人电脑申善遍使用的操作系统有UNIX、
Windows、Mac OS X、Linux 等。
一台计算机中可运行的指今，因其CPU、操作系统的不同而有所差
异。国此，如果将针对某些特定的CPU或操作系统设计的程序直接复制
到具有其他类型CPU或操作系统的计算机中，就不一定能够直接运行。
计算机中存储的数据也因CPU和操作系统的差异而有所不同。因此，若
在CPU和操作系统不同的计算机之间实现通信，则需要一个各方支持的
协议，并遵循这个协议进行数据读取。
此外：一个CPU通常在同一时间只能适行一个程序。为了让多个程
序同时运行，操作系统采用CPU时间片轮转机制，在多个程序之间进行
切换，合理调度。这种方式叫做多任务调度。前面1.2.2节中提到的分时
系统的实现，实际上就是采用了这种方式。
71.3.3协议如同人与人的对话
在此举一个简单的例子。有三个人A、B、C。A只会说汉语、B只会说英语、
面C既会说汉语又会说英语。现在A与B要聊天，他们之间该如何沟通呢？若A
与C要聊天，又会怎样？这时如果我们：
将汉语和英语当作“协议”
将聊天当作“通信”
。将说话的内容当作“数据”
那么A与B之间由于各持一种语言，恐怕说多久也无法交流。因为他们之间
的谈话所用的协议（语言）不同，双方都无法将数据（所说的话）传递给对方”。
关就起者选种翻译作用。
接下来，我们分析A与C之间聊天的情况。两人都用汉语这个“协议”就能
理解对方所要表达的具体含义了。也就是说A与C为了顺利沟通，采用同一种协
议，使得他们之间能够传递所期望的数据（想要说给对方的话）。
如此看来，协议如同人们平常说话所用的语言。虽然语言是人类才具有的特
性，但计算机与计算机之间通过网络进行通信时，也可以认为是依据类似于人类
“语言”实现了相互通信”。
---
## Page 29
1.3协
图12
协议如同人与人的对话
言不通，无法沟通。
最近可好？
挺好挺好！
协议一致，通信自如。
1.3.4
计算机中的协议
人类具有掌握知识的能力，对所学知识也有一定的应用能力和理解能力。因
此在某种程度上，人与人的沟通并不受限于太多规则。即使有任何规则之类的东
西，人们也可以通过自己的应变能力很自然地去适应规则。
然而这一切在计算机通信当中，显然无从实现。因为计算机的智能水平还没
有达到人类的高度。其实，计算机从物理连接层面到应用程序的软件层面，各个
组件都必须严格遵循着事先达成的约定才能实现真正的通信。此外，每个计算机
还必须装有实现通信最基本功能的程序。如果将前面例子中提到的A、B与C替
换到计算机中，就不难理解为什么需要明确定义协议，为什么要遵循既定的协议
来设计软件和制造计算机硬件了。
人们平常说话时根本不需要特别注意就能顺其自然地吐字、发音。并且在很
多场合，人类能够根据对方的语义、声音或表情，合理地调整自己的表达方式和
所要传达的内容，从面避免给对方造成误解。甚至有时在谈话过程中如果不小心
漏掉几个词，也能从谈话的语境和上下文中猜出对方所要表达的大体意思，不至
于影响自已的理解。然面计算机做不到这一点。因此，在设计计算机程序与硬件
时，要充分考虑通信过程中可能会遇到的各种异常以及对异常的处理。在实际遇
到问题时，正在通信的计算机之间也必须具备相应的设备和程序以应对异常。
在计算机通信中，事先达成一个详组的约定，并遵循这一约定进行处理尤为
重要。这种约定其实就是“协议”。
.03
计算机通信的议
用TCP/IP1
用TCP/IP1
ALD
计算机之间，事先达成一个详细的约定，并遵得这一约定进行
处理方可建立通信，
---
## Page 30
第1章同络基础知识
71.3.5分组交换协议
分组交换是指将大数据分割为一个个叫做包（Packet）的较小单位进行传输
的方法。这里所说的包，如同我们平常在邮局里见到的邮包。分组交换就是将大
数据分装为一个个这样的邮包交给对方。
一块大数据
分组通信
：
细分报文
刹掉报文首
（源主机
分组
（目标主机
当人们邮寄包裹时，通常会填写一个寄件单贴到包裹上再交给邮局。寄件单
上一般会有寄件人和收件人的详细地址。类似地，计算机通信也会在每一个分组
中附加上源主机地址和目标主机地址送给通信线路。这些发送端地址、接收端地
址以及分组序号写人的部分称为“报文首部”。
一个较大的数据被分为多个分组时，为了标明是原始数据中的哪一部分，就
有必要将分组的序号写人包中。接收增会根据这个序号，再将每个分组按照序号
重新装配为原始数据。
通信协议中，通常会规定报文首部应该写人哪些信息、应该如何处理这些信
息。相互通信的每一台计算机则根据协议构造报文首部、读取首部内容等。为了
双方能正确通信，分组的发送方和接收方有必要对报文首部和内容保持一致的定
文和解释。
那么，通信协议到底由谁来规定呢？为了能够让不同厂商生产的计算机相互
通信，有这么一个组织，它制定通信协议的规范，定义国际通用的标准。在下一
节，我们将详细说明协议的标准化过程。
---
## Page 31
1.4协饮由编规定
15
协议由谁规定
71.4.1计算机通信的诞生及其标准化
在计算机通信诞生之初，系统化与标准化并未得到足够的重视。每家计算机
厂商都出产各自的网络产品来实现计算机通信。对于协议的系统化、分层化等事
宜没有特别强烈的意识。
1974年，IBM公司发布了SNA，将本公司的计算机通信技术作为系统化网络
体系结构公之于众。从此，计算机厂商也纷纷发布各自的网络体系结构，引发了
众多协议的系统化进程。然而，各家厂商的各种网络体系结构、各种协议之间并
不相互兼容。即使是从物理层面上连接了两台异构的计算机，由于它们之间采用
的网络体系结构不同，支持的协议不同，仍然无法实现正常的通信。
这对用户来说极其不便。因为这意味着起初采用了哪个厂商的计算机网络产
品就只能一直使用同一厂商的产品。若相应的厂商破产或产品超过服务期限，就
得将整套网络设备全部换掉。此外，因为不同部门之间使用的网络产品互不相同，
所以就算将它们从物理上相互连接起来了也无法实现通信，这种情况亦不在少数。
灵活性和可扩展性的缺乏使得当时的用户对计算机通信难以应用自如。
?
协议中的方言与普通话
A公司
公司
TCP/IP
普通话
11
B公司
D公司
公司
C公司
C公司
每家公司都各持一家方言，无法实现通信
每家公司都用普通话，就有塑实现通信
随着计算机重要性的不断提高，很多公司逐渐意识到兼容性的重要意义。人
们开始着手研究使不同厂商生产的异构机型也能够互相通信的技术。这促进了网
络的开放性和多供性。
 1. 4. 2
协议的标准化
为了解决上述问题，ISO”制定了一个国际标准OSI”，对通信系统进行了标
准化。现在，OSI所定义的协议虽然并没有得到普及，但是在OSI协议设计之初
参考模型
作为其指导方针的OSI参考模型却常被用于网络协议的制定当中。
Inte
ngTaak
本书将要说明的TCP/IP并非ISO所制定的某种国际标准。面是由IETF所
建议的、致力于推进其标准化作业的一种协议。在当时，大学等研究机构和计算
会认的标事。
机行业作为中心力量，推动了TCP/IP的标准化进程。TCP/IP作为互联网之上的
一种标准，也作为业界标准”，严然已成为全世界所广泛应用的通信协议。那些
---
## Page 32
16
第1章网络基础知识
支持互联网的设备及软件，也正着力遵循由IETF标准化的TCP/IP协议。
协议得以标准化也使所有遵循标准协议的设备不再因计算机硬件或操作系统
的差异面无法通信。因此，协议的标准化也推动了计算机网络的普及。
标准化
所谓标准化是指使不同厂商所生产的并构产品之间具有兼客性、便
于使用的规范化过程。
除计算机通信领城之外，“标准”一词在日常用品如铅笔、周纸、电
源插应、音频、录音带等制造行业也屡见不鲜。如果这些产品的大小、
形状总是各不相网，那将会给消费者带来巨大的麻强。
制定选程通信相关国际规范的
标准化组织大致分为三类：国际级标准化机构，国家级标准化机构
员会，m
以及民间固体。目前国际级标准化机构有ISO、ITU-T”等，而国家级标
准化机构有日本的JISC（制定了日本JIS）和美国的ANSI”。民间团体则
包括促进互联网协议标准化的IETF等组织。
ineel.
在现实世界里，有很多优秀的技术，由于其开发公司没有公开相应
平会，离子美国国内的标准
的开发规范导致这些技术没有得到广泛的普及。如果企业能够将自己的
开发规范公之于众，让更多业界同行及时使用并成为行业标准，邢么一
定会有更多更好的产品可以存活下来供我们使用。
从某种程度上说，标准化是对世界具有极其重要影响的一项工作。
---
## Page 33
1.5势议分层与OSI参考模型
协议分层与OSI参考模型
71.5.1协议的分层
ISO在制定标准化OSI之前，对网络体系结构相关的问题进行了充分的讨论，
最终提出了作为通信协议设计指标的OSI参考模型。这一模型将通信协议中必要
的功能分成了7层。通过这些分层，使得那些比较复杂的网络协议更加简单化。
在这一模型中，每个分层都接收由它下一层所提供的特定服务，并且负责为
自己的上一层提供特定的服务。上下层之间进行交互时所遵循的约定叫做“接
口”。同一层之间的交互所遵循的约定叫做“协议”。
协议分层就如同计算机软件中的模块化开发。OSI参考模型的建议是比较理
想化的。它希望实现从第一层到第七层的所有模块，并将它们组合起来实现网络
通信。分层可以将每个分层独立使用，即使系统中某些分层发生变化，也不会波
及整个系统。因此，可以构造一个扩展性和灵活性都较强的系统。此外，通过分
层能够细分通信功能，更易于单独实现每个分层的协议，并界定各个分层的具体
责任和义务。这些都属于分层的优点。
面分层的劣势，可能就在于过分模块化、使处理变得更加沉重以及每个模块
都不得不实现相似的处理逻辑等问题。
图16
计算机A
计算机B
协议的分层
第N层
协议
第N层
第M-层
第N-I层
协议
...
第1层
第1层
接口
71.5.2通过对话理解分层
关于协议的分层，我们再以A与C的对话为例简单说明一下。在此，我们只