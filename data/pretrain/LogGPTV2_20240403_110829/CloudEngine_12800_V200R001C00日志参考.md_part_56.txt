原因4：主LSP建立成功后，热备份LSP的建立需要排除主LSP路过的节点。
处理步骤
步骤1 在入节点（即产生该条告警的节点）上执行命令display mpls te tunnel-interface tunnel
interface-number查看隧道的配置：通过查看Tunnel State Desc字段检查Tunnel是否处于
Down状态。执行命令display mpls te tunnel-interface last-error，查看出错提示。
l 如有以下错误提示：
– 显示“Cspf failed to calculate a path for Tunnel.”，表示入节点使能了CSPF，
但CSPF算路失败，请执行步骤2。
– 显示“Trigger Rsvp failed.”请执行步骤2。
– 显示“One LSP is deleted at smooth period.”请执行步骤6。
– 显示“One LSP is deleted at Tunnel aging period”请执行步骤6。
– 其它类型的错误，请执行步骤6。
文档版本 06 (2017-09-12) 华为专有和保密信息 511
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
l 如没有提示错误提示请执行步骤2。
步骤2 在入节点上执行ping命令检查能否Ping通Tunnel的目的地址。
l 如果不能ping通，请排除路由故障，使入节点能够Ping通Tunnel的目的地址，观察
告警是否清除。
– 是，请执行步骤7。
– 不是，请执行步骤3。
l 如果能够ping通，请执行步骤3。
步骤3 在入节点的MPLS视图下执行display this命令，检查是否配置了mpls te cspf命令，即检
查系统是否使能了CSPF。
l 是，请执行步骤4。
l 不是，请执行步骤5。
步骤4 在入节点上执行display mpls te cspf destination命令检查是否存在满足指定约束条件的
路径。如果有，则显示该TE隧道的路径，表示CSPF算路成功，否则显示结果为空，表
示算路失败。
l 如果算路成功，在入节点上执行命令display current-configuration interface
interface-type interface-number查看Tunnel的配置信息，首先需要确定主tunnel、保
护tunnel与保护接口。
确认主备Tunnel后再进行如下检查：通过检查是否存在explicit-path命令查看隧道
是否配置了显式路径；通过检查是否存在mpls te bandwidth查看隧道是否配置了
带宽。
执行命令display mpls te cspf destination并根据Tunnel的配置信息依次尝试加上对
应的约束条件的参数，包括优先级（priority setup-priority）、带宽
（bandwidth）、显式路径（explicit-path path-name）、亲和属性（affinity
properties）、hop-limit（hop-limit hop-limit-number），检查是否存在满足指定约
束条件的路径。如果有，则显示该TE隧道的路径，表示CSPF算路成功，否则显示
结果为空，表示算路失败。
a. 若显式路径算路失败，通过查看显式路径及tunnel接口下的配置，确定主路径
和备份路径。检查各显式路径沿途各个接口是否处于Up状态，是否都使能了
MPLS和MPLS TE。若显式路径算路成功，检查下面的亲和属性、带宽算路是
否成功，是否与显式路径一致。可使用如下命令：display mpls te cspf
destination ip-address bandwidth ct0 ct0-bandwidth explicit-path path-name。
b. 若带宽算路失败，执行display mpls te link-administration bandwidth-
allocation interface interface-type interface-number命令查看隧道沿途可能经过
的出接口的带宽是否足够。若带宽足够，则可能是优先级高的Tunnel抢占了
当前Tunnel的带宽，在接口下执行命令mpls te bandwidth max-reservable-
bandwidth及mpls te bandwidth命令增加带宽。
c. 若其他约束条件算路失败，请执行步骤6。
之后，观察告警是否清除。
– 是，请执行步骤7。
– 不是，请执行步骤5。
l 如果算路失败，请执行步骤5。
步骤5 执行命令display explicit-path查看在Tunnel沿途经过的各接口并在各个接口的接口视图
下执行display this命令，检查通往目的地址的接口是否使能了MPLS、MPLS TE和
RSVP-TE。
文档版本 06 (2017-09-12) 华为专有和保密信息 512
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
l 如果未使能，在接口视图下执行mpls、mpls te和mpls rsvp-te命令。
l 如果发现接口状态处于非Up状态，请重启接口。即，在接口视图执行shutdown，
然后执行undo shutdown，或在接口视图下执行restart命令。
之后，观察告警是否清除。
l 是，请执行步骤7。
l 不是，请执行步骤6。
步骤6 请收集该设备的告警信息、日志信息和配置信息，并联系技术支持人员。
步骤7 结束。
----结束
52.24 MPLS_LSPM/2/
hwMplsTunnelHotstandbyDown_clear
日志信息
MPLS_LSPM/2/hwMplsTunnelHotstandbyDown_clear: The down alarm about the hot-
standby LSP in the tunnel was cleared.(SessionTunnelId=[SessionTunnelId],
TunnelInstIndex=[TunnelInstIndex], IngressLsrId=[IngressLsrId],
EgressLsrId=[EgressLsrId], mplsTunnelIfName=[mplsTunnelIfName])
日志含义
隧道热备份LSP变为Up状态。
日志参数
参数名称 参数含义
SessionTunnelId 隧道标识。
TunnelInstIndex Tunnel的InstIndex。
IngressLsrId Tunnel入节点的LSR ID。
EgressLsrId Tunnel出节点的LSR ID。
mplsTunnelIfName Tunnel的接口名称。
可能原因
隧道Hot-standby LSP建立成功。
处理步骤
l 正常运行信息，无需处理。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 513
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
52.25 MPLS_LSPM/4/TNLHSBRESUME
日志信息
MPLS_LSPM/4/TNLHSBRESUME:Main LSP of Tunnel resumes from backup LSP in HSB.
(TunnelId=[TunnelId], LocalLspId=[LocalLspId], IngressLsrId=[IngressLsrId],
EgressLsrId=[EgressLsrId], TunnelAdminStatus=[TunnelAdminStatus],
TunnelOperStatus=[TunnelOperStatus])
日志含义
当主LSP状态变为Up，流量从备份LSP回切到主LSP时产生此Trap信息。
日志参数
参数名称 参数含义
TunnelId 主隧道标识。
LocalLspId 主隧道的LSP ID。
IngressLsrId 主隧道的入节点地址。
EgressLsrId 主隧道的出节点LSR ID。
TunnelAdminStatus 隧道的管理状态。
TunnelOperStatus 隧道的工作状态。
可能原因
当前流量从热备份LSP通过，主LSP状态由Down变为Up。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
52.26 MPLS_LSPM/4/TNLHSBSWITCH
日志信息
MPLS_LSPM/4/TNLHSBSWITCH:Main LSP of Tunnel switches to backup LSP in HSB.
(TunnelId=[TunnelId], LocalLspId=[LocalLspId], IngressLsrId=[IngressLsrId],
EgressLsrId=[EgressLsrId], TunnelAdminStatus=[TunnelAdminStatus],
TunnelOperStatus=[TunnelOperStatus])
日志含义
当主LSP状态变为Down，检测到存在备份LSP，且流量从备份LSP通过时产生此Trap信
息。
文档版本 06 (2017-09-12) 华为专有和保密信息 514
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
日志参数
参数名称 参数含义
TunnelId 主隧道标识。
LocalLspId 主隧道的LSP ID。
IngressLsrId 主隧道的入节点LSR ID。
EgressLsrId 主隧道的出节点LSR ID。
TunnelAdminStatus 隧道的管理状态。
TunnelOperStatus 隧道的工作状态。
可能原因
主LSP状态变为Down，热备份LSP处于正常状态。
处理步骤
步骤1 检查当前Tunnel接口的配置、RSVP协议和IGP协议的配置，以及整条链路及其带宽是
否满足。
l 如果配置了显式路径，则逐跳检查沿路径接口是否故障。
– 如果是，请执行步骤2
– 如果否，请执行步骤3
l 如果没有配置显式路径，查看是否有满足配置的路径存在，如存在请执行步骤3。
步骤2 修复链路故障。
l 如果是，请执行步骤5
l 如果否，请执行步骤3
步骤3 执行display mpls te tunnel-interface last-error命令，查看出错提示。
l 如有如下错误提示：
– 显示“ENUM_TEM_LSPFSM_EVENT_QUERYROUTE_FAIL”，表示入节点
使能了CSPF，但CSPF算路失败，检查显式路径是否配置正确，IGP协议是否
使能MPLS TE，路由配置是否正确。
n 如果是，请执行步骤5
n 如果否，请执行步骤4
– 显示“Receive Error-Node(192.168.1.2) at
ENUM_TEM_LSPFSM_STATE_SETUPING state.”，表示隧道192.168.1.2节点
配置有问题，需要检查该节点上TE和RSVP-TE的配置是否正确。
n 如果是，请执行步骤5
n 如果否，请执行步骤4
– 显示“Sig. reports connect timeout at
ENUM_TEM_LSPFSM_STATE_SETUPING state.”，表示该隧道下游某处入
接口或节点没使能RSVP-TE，需要检查。
n 如果是，请执行步骤5
n 如果否，请执行步骤4
文档版本 06 (2017-09-12) 华为专有和保密信息 515
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
– 显示“Crlsp receive Sig. ResvTear at
ENUM_TEM_LSPFSM_STATE_SETUPING state.”，表示该隧道下游某处链
路或者节点故障，需要排查。
n 如果是，请执行步骤5
n 如果否，请执行步骤4
– 其它类型的错误请执行步骤4。
l 如果没有错误提示请执行步骤4。
步骤4 请收集该设备的告警信息、日志信息和配置信息，并联系技术支持人员进行处理。
步骤5 结束。
----结束
52.27 MPLS_LSPM/4/TUNNELBWCHANGE
日志信息
MPLS_LSPM/4/TUNNELBWCHANGE:The bandwidth of the tunnel has changed.
(SessionTunnelId=[SessionTunnelId], LocalLspId=[LocalLspId],
IngressLsrId=[IngressLsrId], EgressLsrId=[EgressLsrId], TunnelName=[TunnelName],
TunnelIfIndex=[TunnelIfIndex], TunnelPreBandwidth=[TunnelPreBandwidth],
TunnelNextBandwidth=[TunnelNextBandwidth])
日志含义
当Tunnel的带宽发生改变时发送的trap消息。
日志参数
参数名称 参数含义
SessionTunnelId 会话Tunnel的ID。
LocalLspId 本地LSP的ID。
IngressLsrId 入口LSR的ID。
EgressLsrId 出口LSR的ID。
TunnelName 隧道名称。
TunnelIfIndex 隧道索引。
TunnelPreBandwidth 隧道原来的带宽。
TunnelNextBandwidth 隧道变化后的带宽。
文档版本 06 (2017-09-12) 华为专有和保密信息 516
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 52 MPLS_LSPM
可能原因
隧道中的某一种带宽类型的带宽发生改变。
处理步骤
步骤1 正常运行信息，无需处理。
----结束
52.28 MPLS_LSPM/6/DOWN_LSP_PATH
日志信息
MPLS_LSPM/6/DOWN_LSP_PATH:The [LspType] LSP changes to down.
(IngressLsrId=[IngressLsrId],TunnelId=[TunnelId],EgressLsrId=[EgressLsrId],LspId=[Local
LspId], LspPath=[LspPath])
日志含义
隧道下某种类型的LSP状态变为Down时，且此隧道使能了发送此日志信息。
日志参数
参数名称 参数含义
LspType LSP类型：
l primary
l hot-standby
l best-effort
IngressLsrId 隧道的头节点地址。
TunnelId 隧道标识。
EgressLsrId 隧道的目的地址。
LocalLspId 隧道的LSP ID。
LspPath LSP的路径。
可能原因
隧道下某种类型的LSP状态变为Down时，如果通过命令mpls te record-route使能隧道
的路径记录功能，将会将路径信息记录进入此日志。用户可以据此日志信息进行故障
定位。
处理步骤
l 正常运行信息，无需处理。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 517
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
53
MSDP
关于本章
53.1 MSDP/2/msdpBackwardTransition_active
53.2 MSDP/2/msdpBackwardTransition_clear
53.3 MSDP/4/MSDP_RCV_ERR_PKT
53.4 MSDP/4/MSDP_SA_LIMIT
53.5 MSDP/6/PEER_NTFDWN
53.6 MSDP/6/PEER_TIMEOUT
53.7 MSDP/6/PEER_UP
文档版本 06 (2017-09-12) 华为专有和保密信息 518
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
53.1 MSDP/2/msdpBackwardTransition_active
日志信息
MSDP/2/msdpBackwardTransition_active:MSDP peer exit the established state.
(RemoteAddr=[RemoteAddr], PeerState=[PeerState], InstanceName=[InstanceName],
ExitReason=[ExitReason])
日志含义
MSDP对等体由Established状态转移到其它状态。
日志参数
参数名称 参数含义
RemoteAddr MSDP对等体地址。
PeerState MSDP对等体的状态。
InstanceName 实例名称。
ExitReason 告警原因。
可能原因
原因1：HoldTime expired.（MSDP对等体的HoldTime定时器超时。）
原因2：Socket error.（Socket错误。）
原因3：Receive invalid TLV.（收到无效TLV。）
原因4：Receive notification TLV.（收到告警TLV。）
原因5：User operation.（用户操作。）
处理步骤
l 原因1：HoldTime expired.
a. 使用命令ping检查和对等体之间的链路是否连通。
n 如果连通，则请执行步骤3。
n 如果不连通，则请执行步骤2。
b. 使用命令display ip routing-table检查到对等体的单播路由是否正常。
n 如果路由正常，则请执行步骤3。
n 如果路由不正常，可排除单播路由故障来解决告警问题。
c. 在对等体的MSDP视图下使用display msdp peer-status命令检查对等体的状
态，即State字段。
文档版本 06 (2017-09-12) 华为专有和保密信息 519
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
日志参考 53 MSDP
n 如果状态为Up，则请执行步骤4。
n 如果状态为Shutdown，则说明MSDP对等体处于Shutdown状态，可在对
等体的MSDP视图下执行undo shutdown命令解决告警问题。
n 如果状态为Down，可检查Connect interface字段，建立TCP连接的接口地
址是否正确。
○ 如果正确，则请执行步骤4。
○ 如果不正确，可在MSDP视图下执行peer peer-address connect-
interface interface-type interface-number命令配置正确的接口地址来
解决告警问题。
n 如果为其他状态，检查对等体两端的MSDP认证配置是否相同。
○ 如果相同，则请执行步骤4。
○ 如果不相同，可为对等体两端配置相同的MSDP认证来解决告警问
题。
d. 请收集日志信息，并联系技术支持人员。