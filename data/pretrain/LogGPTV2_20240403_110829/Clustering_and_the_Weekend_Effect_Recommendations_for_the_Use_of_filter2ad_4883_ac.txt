m
%
n
a
e
M
Fig. 3. Alexa (top) and Umbrella (bottom) heatmaps showing website categories’ mean
Wednesday market share ± the diﬀerence to the mean Sunday market share (also used
to colour each cell) in exponentially increasing list intervals 1–10, 11–100, 101–1,000,
etc., from March to April 2018. Categories ordered by Wednesday top 1 M mean market
share. Sundays see fewer oﬃce-related domains, and more entertainment. For Majestic,
see Fig. 10 in the appendix. (Color ﬁgure online)
ket share threefold. Furthermore, categories appear to be slightly more evenly
distributed during the weekend. The categories of the top 10 domains (Table 4) in
Alexa, and to some extent also the top 100, remain stable between the workweek
and the weekend. In Umbrella, however, there is signiﬁcant change in the cate-
gories in the top 10 because of the addition of two new domains. Taken together,
these results conﬁrm the preliminary ﬁnding by Scheitle et al. [30] (based on
popularity changes of a handful of domains listed with many subdomains) that
Alexa and Umbrella are dominated by oﬃce traﬃc during the workweek, and
leisure traﬃc during the weekend.
3.3 Clusters
The rankings of Alexa and Umbrella contain large alphabetically sorted clusters
of domain names. (Umbrella appears to apply an atypical sorting order when
dashes and preﬁxes are involved: ab-c before ab.) We assume that these clusters
170
W. Rweyemamu et al.
s
r
e
t
s
u
c
l
n
i
i
s
n
a
m
o
D
%
100
80
60
40
20
0
100
Umbrella
Alexa
Majestic
102
101
Cluster size threshold
103
Fig. 4. Percentage of the ranking that is part of a cluster, for varying minimum length
thresholds for an alphabetically sorted sequence to be considered a cluster. Alexa and
Umbrella cluster a large fraction of their respective list, Majestic does not.
represent domains that cannot be distinguished based on their traﬃc character-
istics.
Alphabetically sorted sublists may occur coincidentally. To explore minimum
size thresholds for when a sorted sublist may be considered a cluster, we plot in
Fig. 4 the resulting percentage of domains that would be considered part of any
cluster. Majestic has only very small clusters; fewer than 0.05% of the list would
be part of clusters if they were required to be larger than 42 domains. Applying
the same threshold to the other lists, more than 54% of Alexa, and more than
91% of Umbrella appear in a cluster.
To understand the sizes and rank locations of clusters, Fig. 5 plots the length
of each alphabetically ordered sublist against its ﬁrst rank. In Alexa, larger
clusters start appearing at ranks around 49k. Clusters can grow very large, with
outliers of 40k and 87k domains, and their size does not increase monotonically.
Majestic, shown in Fig. 8 in the appendix, has no signiﬁcant clusters except for
a few outliers in the last third of the list. In Umbrella, clusters larger than 42
domains start at rank 83k (rank 126k with a threshold of 100). The size of
clusters appears to grow exponentially towards the end of the list, but the last
cluster of the list is likely truncated as it does not follow the increasing trend.
Furthermore, clusters on the two Wednesdays are one third to a half smaller
than the clusters observed on Sundays. This suggests that Umbrella’s ranking
is based on less traﬃc on Sundays, as larger clusters imply more domains that
cannot be distinguished.
These clusters have a number of important implications for users of the lists.
First, while one may expect that domains equivalent in terms of traﬃc would
receive the same rank, Alexa and Umbrella do in fact assign individual ranks to
each domain in alphabetical order. Inside a large cluster, the ﬁrst few characters
of a domain can cause a large rank diﬀerence, such as 87k in Alexa. The last
Recommendations for the Use of Top Domain Lists in Security Research
171
2018-03-04 (Sunday)
2018-03-11 (Sunday)
2018-03-07 (Wednesday)
2018-02-28 (Wednesday)
i
e
z
s
r
e
t
s
u
C
l
20 k
17.5 k
15 k
12.5 k
10 k
7.5 k
5 k
2.5 k
0
0
200 k
400 k
600 k
First rank of cluster
(a) Alexa
2018-03-04 (Sunday)
2018-03-11 (Sunday)
2018-03-07 (Wednesday)
2018-02-28 (Wednesday)
20 k
17.5 k
15 k
12.5 k
10 k
7.5 k
5 k
2.5 k
0
i
e
z
s
r
e
t
s
u
C
l
800 k
1 M
0
200 k
400 k
600 k
800 k
1 M
First rank of cluster
(b) Umbrella
Fig. 5. Scatterplots of each alphabetically sorted cluster’s size by its highest rank.
No size threshold, but clusters with 42 or fewer domains are downsampled to 1% for
printability (diﬀerence invisible). In Alexa, ten very large outlier clusters of up to 87k
domains not shown. Umbrella clusters have a trend of increasing size towards the end
of the list, except for the last (truncated) cluster; weekends tend to increase cluster
sizes.
cluster of the ranking is cut oﬀ, as including it entirely would extend the length
of the list beyond 1 M entries. Similar eﬀects can occur when researchers use a
list preﬁx without accounting for clusters. In both cases, domains are excluded
from consideration not because of their popularity, but because of their relative
lexicographical order. Furthermore, clustering eﬀects have implications on the
stability of the list. A domain with stable traﬃc may receive a worse rank when
domains with equivalent traﬃc but a lower lexicographical ordering are added
to the list. Similarly, when a domain switches to an adjacent cluster, the rank
diﬀerence can be consequential, even though the actual change in traﬃc may be
minor.
4 Discussion: Best Practices for Using Top Domain Lists
Our analysis has revealed various characteristics of the lists compiled by Alexa,
Majestic, and Umbrella. To minimise any negative impact that these character-
istics can have on measurement results, we propose the following best practices.
Avoid Direct Correlation with a Domain’s Rank. Alexa and Umbrella contain
large clusters of domains with the same popularity, yet each domain is assigned
an individual rank in alphabetical order. For example, 56% of Alexa, and 99.9%
of Umbrella entries in the bottom 900k are part of clusters. This can cause
anomalies, e.g. when looking for a linear correlation between the rank and a
security property (“do more popular websites have a higher security score?”).
Furthermore, especially the lower domain ranks can ﬂuctuate considerably on a
daily basis. Instead of using the rank directly, we suggest looking at aggregates
based on exponentially increasing rank intervals, such as 1–10, 11–100, 101–1000
etc., which perhaps results in less precision, but more robustness.
172
W. Rweyemamu et al.
Use Contemporaneous Rankings to Label Historical Datasets. A domain that
was popular in the past is not necessarily highly ranked today, and vice versa.
When labelling a dataset with domain ranks, it is important to use the rank
that was current at the time of the recorded event. For example, a Web vulner-
ability database may contain entries spanning multiple years, and a website’s
popularity should be assessed based on the ranking when the vulnerability was
discovered (“do popular websites receive more vulnerability reports?”). The fast
responsiveness of Alexa and Umbrella implies that this precaution is also neces-
sary at shorter time scales. A malicious domain, for instance, may be active and
popular for just a few days before it is blacklisted [28] and traﬃc subsides.
Measure a Static Set of Domains, if Possible. We have shown that the weekend
eﬀect in Alexa and Umbrella causes diﬀerent types of domains to be included
(e.g., changing country and content category distributions). This pattern is also
visible in multiple network, transport and application layer measurements repro-
duced daily with the newest domain lists by Scheitle et al. [30]. However, such a
measurement setup does not allow to distinguish changes due to list composition
from changes that occur on a measured domain. For example, a domain that is
present in the ranking during all days may cease to use a certain form of tracking,
or a domain that always uses this form of tracking may drop out of the ranking,
to the same overall eﬀect. We argue that short-term noise from list composition,
such as the weekend eﬀect, is usually undesirable in measurements. It makes it
challenging to interpret observed changes, and it is typically of little interest to
break down the prevalence of tracking, for instance, based on sites’ weekend or
workweek popularity. We believe that measurements can often be carried out
with a static list of domains, such as to study the evolution of tracking on a
ﬁxed set of sites. Medium and long-term list changes may be more relevant to
account for permanent popularity changes.
To create a set of domains to be measured, we suggest collecting list data
over the course of one or more weeks, and using the union or intersection of all
days, depending on the scenario. To improve comparability and reproducibility
of measurements, researchers could agree on a common list of domains that is
updated on a quarterly or yearly basis.
Account for Subdomains. Umbrella contains so many subdomains that the set
of unique registered domains is only around 28% [30], three times smaller than
in Alexa or Majestic. In some contexts, measuring all subdomains may be desir-
able. For example, subdomains may serve diﬀerent web content, and subdomains
include mail servers that may use a diﬀerent TLS conﬁguration than web servers.
In other contexts, subdomains may be aliases, or may be conﬁgured and managed
identically since they are part of the same infrastructure. For example, if they
share the same authoritative name server, they likely have identical DNSSEC
capabilities. This can result in duplicates, and bias aggregates towards services
that are listed with more subdomains. In such cases, it may be preferable to
use only one (sub)domain per unique registered domain. Similar issues exist due
to Content Distribution Networks [30]. The large diﬀerence in unique registered
Recommendations for the Use of Top Domain Lists in Security Research
173
domains also makes it challenging to compare results derived from Umbrella to
Alexa or Majestic.
For completeness, we discuss recommendations from prior work in the para-
graphs below.
Use Lists According to What They Represent. Each list uses diﬀerent data, which
implies a diﬀerent deﬁnition of popularity. Alexa contains (desktop) type-in web-
site domains, Majestic models website popularity by inbound links instead of
visitors, Umbrella ranks domains that may not host web content, and Quantcast
allows customers to hide their identity. These missing ranks are not uniformly
random (Table 2), and we recommend against the use of Quantcast when repre-
sentativity or comparability are desired.
Use Only the Highest-Ranked 100k Domains, or Fewer. The publishers of the
Alexa list caution that only the top 100k domains are statistically signiﬁcant [3,5].
The reverse conclusion is a degree of imprecision, or randomness, in the remaining
900k list entries; this could refer both to their relative ranking, and to their
presence or absence. Research results aggregated over the full 1 M list are based
on 90% “unreliable” data points.
Use Multiple Sources, Including Unranked Sets of Domains. The limitations of
individual lists could be mitigated by measuring domains selected from multiple
lists in parallel and contrasting the results, as suggested [30] and done [19] in
prior work. Researchers could base their analysis on one ranked domain list and
a random sample of the .com zone (or IPv4 address space). The ﬁrst set of
domains would be “representative” in terms of visits and mirror the security
aspects that users face, while the second set would be “representative” in terms
of sites and reﬂect security from the point of view of developers.
Do Not Assume that Ranked Domains are Benign. This paper and the previous
recommendations focus on measurement studies, where domains do not need to
be benign. In fact, several prior studies have reported evidence that malicious
domains exist in the Alexa ranking [23,24,28]. This can be an issue for security
systems using domain lists as sources of “benign” examples for model training,
validation or whitelisting [9,10,15,21,22,26].
5 Conclusion
Many security research papers utilise top domain rankings such as the ones pub-
lished by Alexa, Majestic, or Umbrella to select domains or websites to consider
in their study. Each list models popularity in a diﬀerent way. Alexa contains only
type-in website domains based on their popularity with toolbar users, Majes-
tic ranks websites based on structural properties rather than popularity with
actual visitors, and Umbrella includes any type of domain observed at a large
public DNS resolver, including many internal, non-web domains. Consequently,
174
W. Rweyemamu et al.
the lists diﬀer in the country and category distribution of their domains, and
some exhibit immediate reactivity to momentary changes in traﬃc volume and
distribution, making weekday and weekend rankings look quite distinct. If not
properly accounted for, these characteristics can hamper reproducibility, and
introduce unwanted bias into research results derived from the domains in the
rankings. To that end, we have proposed best practices for the use of top domain
lists in security measurements.
Acknowledgements. This work was supported by Secure Business Austria and
the National Science Foundation under grants CNS-1563320, CNS-1703454, and IIS-
1553088.
Appendix
02-04
02-18
03-04
03-18
04-01
04-15
04-29
05-13
05-27
)
d
d
-
m
m
-
8
1
0
2
(
t
e
a
D
02-04
02-18
03-04
03-18
04-01
04-15
04-29
05-13
05-27
90
75
60
45
e
c
n
e
r
e
f
e
r
h
t
i
w
n
o
m
m
o
c
n
i
s
n
a
m
o
D
%
i
10
100
1 k
List interval
10 k
(a) Alexa (Sunday)
100 k
1 M
10
100
1 k
10 k
List interval
100 k
1 M
(b) Umbrella (Sunday)
Fig. 6. Alexa and Umbrella changes over time in exponentially increasing list intervals,
using Sunday 4 February as the reference day. See Fig. 1 for full legend.
03-28
04-11
04-25
05-09
05-23
)
d
d
-
m
m
-
8
1
0
2
(
e
t
a
D
90
e