35.71
50.00
18.18
7.69
5.88
55.56
28.57
11.11
32.56
18.31
26.11
62.06
56.41
47.32
39.67
32.87
6.64
29.43
50.03
13.20
36.91
47.66
27.24
37.45
11.43
32.78
43.33
31.33
17.27
15.71
1.25
33.33
10.00
10.00
27.23
14.06
20.65
bare MW. work. work. clean
0.00
15.79
14.29
0.00
31.82
30.77
29.41
0.00
28.57
27.78
13.95
25.35
19.11
33.33
15.79
35.71
43.75
13.64
0.00
11.76
22.22
21.43
5.56
26.74
11.27
19.75
13.33
63.16
21.43
12.50
50.00
38.46
29.41
11.11
42.86
38.89
34.88
33.80
34.39
Table 5: Manual Analysis Results in Percent of Samples
indicate that even though they were all labeled as crack or
keygen for a speci(cid:12)c product, the binaries included did not
necessarily have this functionality. Other binaries were in
fact cracks or keygens, but for di(cid:11)erent versions or even dif-
ferent products. Some of the binaries even consisted of the
bare malware itself. Table 5 re(cid:13)ects these (cid:12)ndings in the real
C/K, wrong C/K and bare MW. columns. We divided our
extensive AV scanning results into two categories: (cid:12)le in-
fections and system infections. A (cid:12)le infections means that
the AV engine reported, that a (cid:12)le is infected with malware.
However, this does not necessarily imply that executing a
purportedly infected (cid:12)le leads to malicious activities. On
the other hand, a system infection means that during exe-
cution of the program, malicious activity could be observed
and at least one other (cid:12)le on the system was infected with
malware. In our test environment, successful malware infec-
tion was usually accompanied with infection of existing or
creation of new (cid:12)les and adding custom startup entries in
the Windows registry. These infections and modi(cid:12)cations
could then be found through the full system scan that we
performed at the end of each test run (see Section 4.3.1 for
details). Moreover, we analyzed all manual samples with the
Virustotal and Anubis environments as well. The columns
VT avg. and Anubis avg. show the average results based
on VT and Anubis scores. The setup is described in more
detail in Section 5.1.1. The column NW traf. re(cid:13)ects all
samples causing network tra(cid:14)c. The number of working
cracks and keygens is visible in column work., whereas sam-
ples with clean AV results and no malicious activity are rep-
resented by work. clean. To exemplary clarify the columns
of Table 5, we consider the Photoshop application. From all
unique binaries that we downloaded, 66:67% were indeed a
real crack or keygen (real C/K ), but out of these, 60:00%
were either not for Photoshop or for a di(cid:11)erent Photoshop
version (wrong C/K ). Scanning the binaries inside the vir-
tual environment with AVG free [30] showed that 66:67%
are infected with malware ((cid:12)le inf.), but only 13:33% man-
aged to actually infect the system (sys. inf.). The column
bare MW. shows that out of all Photoshop samples, 33:33%
were no crack or keygen at all and just consisted of the bare
malware itself. Note that the percentages of real C/K and
bare MW. do not necessarily need to add up. For instance,
if an alleged crack turns out to be a harmless malware free
decompression tool, it does not show up in the real C/K
or wrong C/K columns as it is no crack or keygen and it
also doesnâ€™t show up in the bare MW. column. Scanning the
samples with VirusTotal showed that 62:06% of the virus
scanners reported an infection (VT avg.), while the aver-
age Anubis score (i.e. the maliciousness of the binaries) was
11:43% (Anubis avg.). From all Photoshop cracks and key-
gens, 20:00% established one or more network connections to
the Internet (NW traf.). The column work. indicates that
13:33% of the cracking tools successfully unlocked Photo-
shop, but 0:0% of the tools worked and were also free from
malware (work. clean).
Our results indicate that cracks and keygens are an ef-
fective distribution channel for malware and, as a result, a
valuable source of revenue for underground entrepreneurs
like Pay Per Install (PPI) providers or other actors in the
software piracy ecosystem like PPD or One-Click hosters,
dedicated crack hosters, specialized crack search engines and
similar (see Section 3). Both, for applications and games,
the chance of manually (cid:12)nding a working crack or keygen
is roughly one third (33%). However, for all applications
we tested, only 13:95% worked and were free from malware.
Similarly, for all games, only 25:35% worked and were free
from malware. Even though not each purportedly infected
(cid:12)le leads to malicious activities, we could observe that more
than 22% of our samples managed to successfully infect the
whole system.
5.1.1 Control Analysis
We submitted all 141 manually collected unique samples
to the Virustotal and Anubis analysis environments to get
both static and dynamic analysis results. For 91:49% of our
samples, there were existing Virustotal reports indicating
that these cracks and keygens had been scanned by other
users before. Virustotal uses a set of AV scanners (Sec-
tion 4.3.2) and outputs their individual results. The more
AV scanners report infections, the higher is the probability
that a sample is indeed infected with malware. In Virustotal
reports, this ratio is commonly known as detection ratio. In
contrast, Anubis calculates a severity score (Section 4.3.2)
that re(cid:13)ects how malicious a sample behaved inside the anal-
ysis environment. Table 5 shows the average results from
these analysis environments on a per product basis. A high
average percentage indicates that a high number of samples
is very likely to be infected with malware (VT avg.) or be-
haves maliciously (Anubis avg.). For instance, the cracks
and keygens for Photoshop were more likely to contain mal-
ware than for O(cid:14)ce 2010, but the O(cid:14)ce 2010 cracks and
keygens behaved much more maliciously on average.
8155.1.2 Sample Age
Recent results of Caballero et al. [17] show that malware
is frequently repacked to avoid detection by static analysis
environments. Consequently, if cracks and keygens are used
to spread malware, a malicious uploader would frequently
upload existing tools bundled with freshly repacked mal-
ware. To determine the approximate age of our samples,
we analyzed all existing Virustotal reports for the manually
collected cracks and keygens. We distinguished between all
samples and infected samples, whereas a sample is consid-
ered to be infected if at least 30% of the Virustotal AV
scanners reported malware infections, an admittedly con-
servative threshold. The result is depicted in the Cumula-
tive Distribution Function (CDF) in Figure 4. We manually
collected cracks an keygens from May to September 2011
which can be seen from the graph as well. The graph in-
dicates that a signi(cid:12)cant amount of our samples was new,
suggesting that the samples were either freshly repacked or
even 0-day malware.
5.1.4 Malware Distribution on Download Sources
For each download source (Web, OCH and BitTorrent),
we compared the overall number of unique downloads with
the number of infected ones (i.e. samples with a Virustotal
detection percentage > 30%). Based on these percentages,
we calculated the distribution of infected samples on down-
load sources. The result is visible in Figure 5. It can be seen
that for our manually collected unique cracks and keygens,
we had slightly more infected downloads from web sources
than from BitTorrent sources or One Click Hosters (OCHs).
Since the goal of malware distributors is to spread the mal-
ware as widely as they can, we believe that they focus more
on download sources that have many users and are easy
to use with minimal e(cid:11)ort. Both is more the case for web
downloads than for OCH or BitTorrent downloads.
Figure 5: Malware Distribution for Manual Down-
loads
5.2 Automatically Collected Samples
In addition to the analysis of manually collected cracks
and keygens with small sample size, we acquired a high
number of samples through custom crawlers (Section 4.2)
and analyzed them with automated analysis environments
(Section 4.3.2). Our analysis of automatically collected sam-
ples is based on a collection of more than 43; 600 download
links for Usenet, BitTorrent and OCH downloads leading to
3; 491 unique cracks and keygen executables.
5.2.1 Results
Similar to the analysis of manually collected downloads,
we submitted our samples to the Virustotal and Anubis anal-
ysis environments to obtain both static and dynamic analy-
sis results. Surprisingly, more than 36:32% (1; 268 samples)
of our cracks and keygens were previously unknown to Virus-
total and had no existing report. Due to the large number
of games and applications, we represent the results of Virus-
total and Anubis scans as Cumulative Distribution Function
(CDF). Although we could observe that cracks and keygens
for games are slightly less likely to be infected with mal-
ware, we decided to combine the results in Figure 6 due to
the high similarity of the resulting graphs. The graph shows
both the Virustotal existing and fresh scan results for all
collected samples. For Virustotal results, the X axis repre-
sents the average Percentage of AV scanners that reported
infections with malware (i.e. the Virustotal detection per-
centage). Hence, if we consider existing reports and a sample
to be malicious if at least 30% of the employed AV scanners
reported that the sample is malware, then about 50% of
all cracks and keygens we collected would be infected with
malware. In contrast, fresh reports are based on more recent
AV signatures and, as a result, also include more malware
infections. Thus, considering fresh reports with the same
Figure 4: VirusTotal First Seen Dates for All and
Infected Manual Downloads (CDF)
5.1.3 Malware Packing
Moreover, we analyzed whether the use of packers could
be detected within our samples and which packers were the
most frequent. The results are visible in Table 6. The table
shows the packers we could identify for infected samples.
We consider a sample to be infected if at least 30% of the
VirusTotal scanners reported infections.
Packer
PECompact 2.xx
UPX 2.90 [LZMA]
Armadillo v1.71
FSG v2.0
UPX 2.93 [LZMA]
ASPack v2.12
BobSoft Mini Delphi
kkrunchy
PECompact v1.4x
Others
# Freq. % Freq.
37.04
14.81
11.11
7.41
7.41
3.70
3.70
3.70
3.70
7.41
10
4
3
2
2
1
1
1
1
2
Table 6: Most Frequent Packers in Infected Manual
Downloads
200720082009201020112012Date020406080100PercentageofSamplesAllSamplesInfectedSamples020406080100PercentageOCHBitTorrentWeb31.6232.7535.64MalwareDistribution,Min.InfectionPercentage=30816Virustotal detection percentage, about 55% of our samples
would include malware.
Moreover, the graph includes the Anubis severity percent-
age (i.e.
the percentage for Anubis severity levels in the
range f0; ::; 10g). It provides a good overview of how mali-
cious the samples behaved inside the analysis environment,
but also allows to classify the samples. As for classi(cid:12)cation,
if we consider all samples with an Anubis severity percentage
of at least 30% (i.e. an Anubis severity score of 3) to be mali-
cious, then roughly 35% of the cracks and keygens would be
malicious. The comparison between Virustotal and Anubis
results can also be seen as sanity check. If the percentage of
infected samples rises, it also means that the overall Anubis
severity increases due to the more malicious behavior of the
samples in comparison to benign ones.
5.2.2 Malware Families
Based on fresh Virustotal reports, we analyzed the most
frequent malware families for cracks and keygens. While the
most frequent malware HEUR:Trojan.Win32.Generic is not
a malware itself, but rather a heuristic covering unknown
Trojans, our results show that the majority of malware fam-
ilies are indeed Trojans. A closer look at these malware
samples reveals that they frequently connect to the Internet,
suggesting that they might act as valuable tool for Pay Per
Install (PPI) providers. That is, the samples might down-
load additional malware from remote locations or function
as remote controlled bots by connecting to command and
control (C&C) servers (i.e. Backdoor.Win32.IRCBot.tyy).
As a result, the most frequent malware families we found can
act as valuable source of revenue for underground economy.
More information regarding the most frequent malware fam-
ilies we could identify in cracks and keygens can be found in
Tables 10 and 11 in the Appendix section.
5.2.3 Sample Age
Based on existing and fresh Virustotal reports, we ana-
lyzed the First Seen Dates to get an overview of the age
of our all samples. The results can be seen in Figure 7,
whereat we consider a sample to be infected if the Virusto-
tal detection percentage is 30% or more. We automatically
collected cracks and keygens between February and March
2012. The graph reveals a similar picture as for the sample
age for manually collected samples. Especially the infected
samples are very new, suggesting that the samples might be
freshly repacked. It also closely re(cid:13)ects the fact, that more
than 36:32% of our samples were new to Virustotal.
5.2.4 Malware Packing
We analyzed Virustotal reports for detected packers that
are frequently used in malware. Table 7 gives an overview of
the most frequent packers used for infected samples, whereas
we consider a sample to be infected if the Virustotal detec-
tion percentage is 30% or more. Due to the close similarity,
the table re(cid:13)ects the combined results for cracks and key-
gens for applications and for games. Our results show that
UPX is the most frequent packer that is used in infected
cracks and keygens. However, we also need to note that
out of 2; 285 possibly infected samples, only 243 (10:63%)
used a packer that was detected by Virustotal. We suspect
that the number of malicious samples that employs packing
mechanisms that are not detected is signi(cid:12)cantly higher.
Packer
UPX 2.90 [LZMA]
FSG v2.0
PECompact 2.xx
Armadillo v1.71
BobSoft Mini Delphi
UPX 2.93 [LZMA]
ASPack v2.12
FSG v1.33 (Eng)
tElock 0.99 - 1.0 private
MEW 11 SE v1.2
ASProtect v1.23 RC1
themida 1.0.0.5
PECompact v1.56
UPX 0.72
Others
# Freq. % Freq.
37.04
13.17
12.76
10.70
7.82
6.17
3.29
1.23
0.82
0.82
0.82
0.41
0.41
0.41
4.13
90
32
31
26
19
15
8
3
2
2
2
1
1
1
10
Table 7: Most Frequent Packers in Infected Auto-