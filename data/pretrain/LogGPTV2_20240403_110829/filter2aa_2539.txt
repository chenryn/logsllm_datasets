Security)Auditing)Mobile)Apps)
!
DEF)CON)23!
Sat.,)Aug)9,)2015)9C1!
Sam)Bowne)
City)College)San)Francisco!
Slides)and)projects)at)samsclass.info)
Adding&Trojans&to&Apps&
Slides'and'projects'at'samsclass.info'
Android&is&#1&
•  80%&market&
share&in&2014&
– Link&Ch&4a&
Slides'and'projects'at'samsclass.info'
App&Signing&
•  All&apps&must&be&signed&to&be&installed,&BUT&
– Android&allows&selfEsigned&cerGﬁcates&
•  Google&Play&is&the&"oﬃcial"&app&store,&BUT&
– Google&doesn't&police&it&well&
– Apps&can&be&installed&from&email,&Web&pages,&etc.&
Slides'and'projects'at'samsclass.info'
Android&Debug&
Bridge&
•  CommandEline&tool&
•  Allows&you&to&communicate&with&a&mobile&
device&via&a&USB&cable&or&an&SVD&running&
within&an&emulator&
•  Connects&to&device's&daemon&running&on&TCP&
port&5037&
Slides'and'projects'at'samsclass.info'
Useful&ADB&Commands&
•  push&
– Copies&a&ﬁle&from&your&computer&to&the&mobile&
device&
•  pull&
– Copies&a&ﬁle&from&the&mobile&device&to&your&
computer&
•  logcat&
– Shows&logging&informaGon&on&the&console&
– Useful&to&see&if&an&app&or&the&OS&is&logging&
sensiGve&informaGon&
Slides'and'projects'at'samsclass.info'
Useful&ADB&Commands&
•  install&
– Copies&an&applicaGon&package&ﬁle&(APK)&to&the&
mobile&device&and&installs&the&app&
– Useful&for&sideEloading&apps&(so&you&don't&have&to&
use&Google&Play)&
•  shell&
– Starts&a&remote&shell&on&the&mobile&device&
– Allows&you&to&execute&arbitrary&commands&
Slides'and'projects'at'samsclass.info'
Decompiling&and&Disassembly&
Slides'and'projects'at'samsclass.info'
StaGc&Analysis&
•  Source&code&is&generally&kept&conﬁdenGal&by&
app&developers&
•  A&binary,&compiled&app&can&be&analyzed&by&
disassembling&or&decompiling&them,&into&
– Smali&assembly&code&(used&by&Dalvik&VM),&or&
– Java&code&
Slides'and'projects'at'samsclass.info'
Slides'and'projects'at'samsclass.info'
TD&Ameritrade&
•  No&obfuscaGon&
Slides'and'projects'at'samsclass.info'
Bank&of&America&
•  ProGuard&Free&Obfuscator&
– Worthless&
Slides'and'projects'at'samsclass.info'
Java&v.&Smali&Code&
Slides'and'projects'at'samsclass.info'
Building&&&Signing&an&App&
Slides'and'projects'at'samsclass.info'
Monitoring&the&Log&
Slides'and'projects'at'samsclass.info'
./adb&logcat&
•  Much&becer&way&to&monitor&log&
•  Filter&with&grep&
Slides'and'projects'at'samsclass.info'
Acacks&via&Decompiling&and&
Disassembly&
•  Insert&Trojan&code,&like&keyloggers&
•  Find&encrypGon&methods&&&keys&
•  Change&variables&to&bypass&clientEside&
authenGcaGon&or&input&validaGon&
•  Cheat&at&games&
Slides'and'projects'at'samsclass.info'
•  Link&Ch&4z43&
Slides'and'projects'at'samsclass.info'
StepEbyEStep:&Bank&of&America&
Slides'and'projects'at'samsclass.info'
StepEbyEStep:&Bank&of&America&
Slides'and'projects'at'samsclass.info'
StepEbyEStep:&Bank&of&America&
Slides'and'projects'at'samsclass.info'
StepEbyEStep:&Bank&of&America&
Slides'and'projects'at'samsclass.info'
DEMO:&Bank&of&America&
Slides'and'projects'at'samsclass.info'
DEMO:&The&Bancorp&
Slides'and'projects'at'samsclass.info'
DEMO:&Capital&One&
Slides'and'projects'at'samsclass.info'
DEMO:&SunTrust&
•  Konylabs&
•  Capture&HTTP&
Parameters&
Slides'and'projects'at'samsclass.info'
DEMO:&TradeKing&
•  App&is&patched!&
•  "Veriﬁer"&detects&the&
Trojan&
Slides'and'projects'at'samsclass.info'
DroidDream&(2011)&
•  Was&primarily&distributed&by&the&Google&Play&store&
•  LegiGmate&apps&were&repackaged&to&include&
DroidDream&and&then&put&back&in&the&Play&store&
Slides'and'projects'at'samsclass.info'
Google's&Response&
•  Google&removed&the&repackaged&apps&from&
the&Play&Store&
•  But&50,000&–&200,000&users&were&already&
infected&
Slides'and'projects'at'samsclass.info'
Google&ApplicaGon&VeriﬁcaGon&Service&
•  Launched&in&2012&
•  Tries&to&detect&malicious&apps&&
•  Much&less&eﬀecGve&than&3rdEparty&AV&
– Link&Ch&5e&
Slides'and'projects'at'samsclass.info'
Decompiling,&Disassembly,&and&
Repackaging&Countermeasures&
•  Every&binary&can&be&reverseEengineered&
– Given&enough&Gme&and&eﬀort&
•  Never&store&secrets&on&the&clientEside&
•  Never&rely&on&clientEside&authenGcaGon&or&
clientEside&validaGon&
•  Obfuscate&source&code&
– ProGuard&(free)&or&Arxan&(commercial)&
Slides'and'projects'at'samsclass.info'
DashO&–&Powerful&Obfuscator&
Slides'and'projects'at'samsclass.info'
All&Strings&Concealed&
•  BUT&it&costs&$2000&
Slides'and'projects'at'samsclass.info'
Slides'and'projects'at'samsclass.info'
Broken&SSL&
RepeaGng&Old&Work&
Slides'and'projects'at'samsclass.info'
CERT's&Test&in&2014&
•  23,667&vulnerable&apps&
•  All&warned&in&2014&&by&CERT&
Slides'and'projects'at'samsclass.info'
SGll&Vulnerable&
Slides'and'projects'at'samsclass.info'
Simple&SSL&Test&
•  Route&Android&
traﬃc&through&Burp&
Proxy&
•  Don't&install&the&
PortSwigger&root&
cerGﬁcate&
•  This&is&a&MITM&
acack&
•  The&default&
browser&detects&it&
Slides'and'projects'at'samsclass.info'
DEMO:&PicsArt&(100&Million)&
Slides'and'projects'at'samsclass.info'
DEMO:&InstaChat(100&Million)&
Slides'and'projects'at'samsclass.info'
DEMO:&OKCupid&–&FIXED!&
Slides'and'projects'at'samsclass.info'
DEMO:&Safeway&(1&Million)&
Slides'and'projects'at'samsclass.info'
Broken&SSL&
Medical&Apps&
Slides'and'projects'at'samsclass.info'
CERT&found&265&Vulnerable&
Medical&Apps&
Slides'and'projects'at'samsclass.info'
HIPAA&
Slides'and'projects'at'samsclass.info'
My&Repeat&of&CERT&Tests&
Slides'and'projects'at'samsclass.info'
DEMO:&GenieMD&
Slides'and'projects'at'samsclass.info'
DEMO:&LowestMed&corporate&
Slides'and'projects'at'samsclass.info'
LowestMed&Response&
•  Phone&call&to&President&of&CCSF&threatening&a&
lawsuit&
•  Aoer&I&contacted&their&lawyer,&he&told&me&that&
there&is&no&PII&in&the&app&beyond&this&point,&so&
it&is&not&a&covered&enGty&under&HIPAA&
Slides'and'projects'at'samsclass.info'
Broken&SSL&
TesGng&New&Apps&
Slides'and'projects'at'samsclass.info'
Responsible&Disclosure&
•  I&&need&to&give&these&guys&Gme&to&respond,&so&
most&of&them&are&sGll&conﬁdenGal&
•  I&can&discuss&one,&because&they&ﬁxed&it&really&
fast!&
Slides'and'projects'at'samsclass.info'
Blue&Cross&Blue&Shield&of&North&
Carolina&
Slides'and'projects'at'samsclass.info'
Leaked&Blue&Cross&CredenGals&
•  Also&leaked&Facebook,&
Twicer,&and&YouTube&
credenGals&
Slides'and'projects'at'samsclass.info'
Fixed&in&Two&Days&
•  New&version&refuses&to&
use&invalid&SSL&
cerGﬁcates&
Slides'and'projects'at'samsclass.info'
Security&Products&
Slides'and'projects'at'samsclass.info'
AIG&MobileGuard&
Security&app&
required&for&
insurance&
coverage&
&
Removed&
from&Google&
Play&aoer&my&
reports&
Slides'and'projects'at'samsclass.info'
Already&Trojaned&!&
Slides'and'projects'at'samsclass.info'
Local&Storage&of&SensiGve&Data&
Slides'and'projects'at'samsclass.info'
Security'Ques6on'
Security'Answer'
PIN'
DEMO:&MobileSuperHero&
(10,000)&
•  Logs&the&PIN&
•  Last&update&12E13E12&
Slides'and'projects'at'samsclass.info'
DEMO:&Virgin&Mobile&Rescue&
(100,000)&
•  Logs&the&PIN&
•  Last&update&7E22E13&
•  Must&uninstall&Mobile&
Superhero&to&use&it&
Slides'and'projects'at'samsclass.info'
DEMO:&Rebound&(50)&
•  Logs&the&PIN&
•  Last&update&7E16E13&
Slides'and'projects'at'samsclass.info'
DEMO:&Rebound&Mobile&Security&
(50)&
•  Logs&the&PIN&
•  Last&updated&11E7E2013&
Slides'and'projects'at'samsclass.info'