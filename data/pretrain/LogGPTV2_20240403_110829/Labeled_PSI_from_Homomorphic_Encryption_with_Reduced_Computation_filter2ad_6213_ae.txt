[13]
Ours
20.5
4.6
1.5
Sender online (s) Client encrypt (s) Comm. (MB)
4.92
0.77
0.05
120
17.6
11.6
Table 3: Comparison to prior work in the labeled mode for label byte-length ‚Ñì = 288. The sender uses 16 threads and the
receiver a single thread.
‚Ñì
32
16
Set sizes
|ùëã |
222
|ùëå |
4096
4096
1
1
1
1
4096
4096
220
222
220
Sender offline (s)
T=24
857
199
48.3
19.5
472
116
28.9
12.2
Sender online (s)
T=1
20.1
8.1
7.65
2.83
13.3
5.1
5.43
2.60
T=4
6.8
2.8
2.20
0.84
4.6
1.8
1.59
0.76
T=8
4.0
2.7
1.19
0.44
2.5
1.7
0.87
0.39
T=24
3.8
2.7
0.65
0.27
2.3
1.7
0.48
0.22
Comm. (MB)
S ‚Üí R
R ‚Üí S
3.9
4.1
1.7
1.6
4.3
5.2
1.24
1.19
2.4
4.0
1.0
1.6
3.2
5.2
1.24
0.79
Table 4: Computation and communication cost of our SEAL implementation in the labeled setting. The label byte-size is ‚Ñì
while the number of threads is denoted by T. The times are averaged over 10 runs of the protocol.
|ùëå |
1245*
1024 [13]
558
512 [13]
341
256 [13]
210
128 [13]
126
|ùëã | = 220
Key size (MB)
224
7.50
2.11
6.87
0.43
11.1
0.21
8.31
0.03
10.6
222
6.88
-
6.18
-
9.90
-
7.44
-
9.02
5.72
1.05
5.49
0.43
7.71
0.43
6.22
0.03
7.97
226
8.12
-
8.13
-
12.2
-
9.17
-
-
|ùëå |
1245*
1024 [13]
558
512 [13]
341
256 [13]
210
128 [13]
126
Communication (MB)
|ùëã | = 220
222
2.28
-
1.27
-
1.32
-
0.76
-
0.63
224
2.28
9.02
1.27
10.64
1.32
13.58
0.76
18.32
0.66
226
2.28
-
1.36
-
1.32
-
0.76
-
-
2.09
6.45
1.27
5.01
1.10
4.73
0.72
4.69
0.63
Table 5: Evaluation key size of our HElib implementation
and of the prior work [13] in the offline stage. The security
level of all the parameters used in these experiments is at
least 128 bits except for the parameters with ‚Äò*‚Äô where it is
at least 106 bits.
Table 6: Communication cost of our HElib implementation
and of the prior work [13] in the online stage. The security
level of all the parameters used in these experiments is at
least 128 bits except for the parameters with ‚Äò*‚Äô where it is
at least 106 bits.
but we requested the corresponding communication size [13] in
the public-key mode from the authors.
As shown in Table 6, the communication cost of our implemen-
tation grows very slowly with the sender‚Äôs set size. For example,
it remains constant for |ùëå| ‚àà {210, 341, 1245} from |ùëã| = 222 to
|ùëã| = 226. Furthermore, a 64-fold increase of the sender‚Äôs set re-
sults in a 6-20% larger communication size for all the parameters
we tested. This is a much smaller growth in comparison to [13],
where a 16-fold increase of |ùëã| leads to a 40-291% rise in commu-
nication. More results with corresponding encryption parameters
and running time can be found in Appendix D.
6 CONCLUSIONS
We have demonstrated several improvements to the protocol of [13],
reducing the communication and online computation cost signifi-
cantly. Our improvements enable very powerful communication-
computation trade-offs that can be leveraged to make the protocol
practical and scalabe in various scenarios. Finally, we showed that
homomorphic encryption can be used to enable PSI in the unbal-
anced setting, with sublogarithmic communication cost in the larger
set, although this protocol is not practical to use today. In the future,
hardware acceleration to homomorphic encryption may change
the situation.
Session 4C: Private Set Intersection CCS ‚Äô21, November 15‚Äì19, 2021, Virtual Event, Republic of Korea1146//doi.org/10.1145/3133956.3134061
ACKNOWLEDGMENTS
We would like to thank Craig Costello and Patrick Longa (Microsoft
Research) for significant help and advise regarding the hash-to-
curve algorithm for the FourQ curve and support with the FourQlib
library, as well as Hao Chen (Facebook) for helpful discussions in
preliminary phases of this work.
This work is supported by CyberSecurity Research Flanders
with reference number VR20192203. Additionally, the first author
is supported by the Defense Advanced Research Projects Agency
(DARPA) and Space and Naval Warfare Systems Center, Pacific (SSC
Pacific) under contract number FA8750-19-C-0502. The third author
is supported by ERC Advanced Grant ERC-2015-AdG-IMPaCT and
by the Flemish Government through FWO SBO project SNIPPET
S007619N. The fifth author is supported by a Junior Postdoctoral
Fellowship from the Research Foundation ‚Äì Flanders (FWO).
Any opinions, findings and conclusions or recommendations ex-
pressed in this material are those of the author(s) and do not neces-
sarily reflect the views of CyberSecurity Research Flanders, DARPA,
the US Government, the ERC or the FWO. The U.S. Government is
authorized to reproduce and distribute reprints for governmental
purposes notwithstanding any copyright annotation therein.
Finally, we would like to thank the anonymous reviewers for
their helpful comments.
REFERENCES
[1] Martin R. Albrecht, Rachel Player, and Sam Scott. 2015. On the concrete hard-
ness of Learning with Errors. J. Mathematical Cryptology 9, 3 (2015), 169‚Äì
203. http://www.degruyter.com/view/j/jmc.2015.9.issue-3/jmc-2015-0016/jmc-
2015-0016.xml
[2] Junade Ali. 2018. Validating Leaked Passwords with k-Anonymity. https://blog.
cloudflare.com/validating-leaked-passwords-with-k-anonymity/. Accessed:
2021-04-26.
[3] Sebastian Angel, Hao Chen, Kim Laine, and Srinath Setty. 2018. PIR with com-
pressed queries and amortized query processing. In 2018 IEEE Symposium on
Security and Privacy (SP). IEEE, 962‚Äì979.
[4] Giuseppe Ateniese, Emiliano De Cristofaro, and Gene Tsudik. 2011. (If) Size
Matters: Size-Hiding Private Set Intersection. In PKC 2011 (LNCS, Vol. 6571), Dario
Catalano, Nelly Fazio, Rosario Gennaro, and Antonio Nicolosi (Eds.). Springer,
Heidelberg, 156‚Äì173. https://doi.org/10.1007/978-3-642-19379-8_10
[7] Zvika Brakerski, Craig Gentry, and Vinod Vaikuntanathan. 2012.
[5] Daniel J Bernstein, Mike Hamburg, Anna Krasnova, and Tanja Lange. 2013.
Elligator: Elliptic-curve points indistinguishable from uniform random strings. In
Proceedings of the 2013 ACM SIGSAC conference on Computer & communications
security. 967‚Äì980.
[6] Zvika Brakerski. 2012. Fully Homomorphic Encryption without Modulus Switch-
ing from Classical GapSVP. In CRYPTO (Lecture Notes in Computer Science,
Vol. 7417), Reihaneh Safavi-Naini and Ran Canetti (Eds.). Springer, 868‚Äì886.
(Leveled)
fully homomorphic encryption without bootstrapping. In Proceedings of the 3rd
Innovations in Theoretical Computer Science Conference. ACM, 309‚Äì325.
[8] Zvika Brakerski and Vinod Vaikuntanathan. 2011. Fully homomorphic encryp-
tion from ring-LWE and security for key dependent messages. In Advances in
Cryptology‚ÄìCRYPTO 2011. Springer, 505‚Äì524.
[9] Zvika Brakerski and Vinod Vaikuntanathan. 2014. Efficient fully homomorphic
encryption from (standard) LWE. SIAM J. Comput. 43, 2 (2014), 831‚Äì871.
Ak. Comput. J. 36, 2 (1993), 117‚Äì126.
bases. Journal of Integer Sequences 13, 2 (2010), 3.
[12] Melissa Chase and Peihan Miao. 2020. Private Set Intersection in the Internet
Setting from Lightweight Oblivious PRF. In CRYPTO 2020, Part III (LNCS), Hovav
Shacham and Alexandra Boldyreva (Eds.). Springer, Heidelberg, 34‚Äì63.
[13] Hao Chen, Zhicong Huang, Kim Laine, and Peter Rindal. 2018. Labeled PSI
from Fully Homomorphic Encryption with Malicious Security. In ACM CCS 2018,
David Lie, Mohammad Mannan, Michael Backes, and XiaoFeng Wang (Eds.).
ACM Press, 1223‚Äì1237. https://doi.org/10.1145/3243734.3243836
[10] Michael F. Challis. 1993. Two new techniques for computing extremal h-bases
[11] Michael F Challis and John P Robinson. 2010. Some extremal postage stamp
[14] Hao Chen, Kim Laine, and Peter Rindal. 2017. Fast Private Set Intersection
from Homomorphic Encryption. In ACM CCS 2017, Bhavani M. Thuraisingham,
David Evans, Tal Malkin, and Dongyan Xu (Eds.). ACM Press, 1243‚Äì1255. https:
[15] Ilaria Chillotti, Nicolas Gama, Mariya Georgieva, and Malika Izabachene. 2016.
Faster fully homomorphic encryption: Bootstrapping in less than 0.1 seconds.
In International Conference on the Theory and Application of Cryptology and
Information Security. Springer, 3‚Äì33.
[16] Benny Chor, Niv Gilboa, and Moni Naor. 1997. Private information retrieval by
keywords. Citeseer.
[17] Craig Costello and Patrick Longa. 2015. FourQ: four-dimensional decompositions
on a Q-curve over the Mersenne prime. Cryptology ePrint Archive, Report
2015/565. https://eprint.iacr.org/2015/565.
[18] Whitfield Diffie and Martin E. Hellman. 1976. New Directions in Cryptography.
IEEE Transactions on Information Theory 22, 6 (1976), 644‚Äì654.
[19] Changyu Dong, Liqun Chen, and Zikai Wen. 2013. When private set intersection
meets big data: an efficient and scalable protocol. In ACM CCS 2013, Ahmad-Reza
Sadeghi, Virgil D. Gligor, and Moti Yung (Eds.). ACM Press, 789‚Äì800. https:
//doi.org/10.1145/2508859.2516701
[20] L√©o Ducas and Daniele Micciancio. 2015. FHEW: Bootstrapping Homomorphic
Encryption in Less Than a Second. In EUROCRYPT 2015, Part I (LNCS, Vol. 9056),
Elisabeth Oswald and Marc Fischlin (Eds.). Springer, Heidelberg, 617‚Äì640.
[21] Bin Fan, Dave G. Andersen, Michael Kaminsky, and Michael D. Mitzenmacher.
2014. Cuckoo Filter: Practically Better Than Bloom. In Proceedings of the 10th ACM
International on Conference on Emerging Networking Experiments and Technologies
(Sydney, Australia) (CoNEXT ‚Äô14). Association for Computing Machinery, New
York, NY, USA, 75‚Äì88. https://doi.org/10.1145/2674005.2674994
[22] Junfeng Fan and Frederik Vercauteren. 2012. Somewhat Practical Fully Ho-
momorphic Encryption. Cryptology ePrint Archive, Report 2012/144. http:
//eprint.iacr.org/.
[23] Michael J. Freedman, Yuval Ishai, Benny Pinkas, and Omer Reingold. 2005.
Keyword Search and Oblivious Pseudorandom Functions. In TCC 2005 (LNCS,
Vol. 3378), Joe Kilian (Ed.). Springer, Heidelberg, 303‚Äì324.
[24] Michael J. Freedman, Kobbi Nissim, and Benny Pinkas. 2004. Efficient Private
Matching and Set Intersection. In EUROCRYPT 2004 (LNCS, Vol. 3027), Christian
Cachin and Jan Camenisch (Eds.). Springer, Heidelberg, 1‚Äì19. https://doi.org/10.
1007/978-3-540-24676-3_1
[25] Craig Gentry. 2009. Fully homomorphic encryption using ideal lattices.. In STOC,
[26] Craig Gentry, Shai Halevi, and Nigel P Smart. 2012. Homomorphic evaluation of
Vol. 9. 169‚Äì178.
the AES circuit. In Advances in Cryptology‚ÄìCRYPTO 2012. Springer, 850‚Äì867.
[27] Craig Gentry, Amit Sahai, and Brent Waters. 2013. Homomorphic Encryp-
tion from Learning with Errors: Conceptually-Simpler, Asymptotically-Faster,
Attribute-Based. In CRYPTO (1) (Lecture Notes in Computer Science, Vol. 8042), Ran
Canetti and Juan A. Garay (Eds.). Springer, 75‚Äì92. https://doi.org/10.1007/978-
3-642-40041-4
[28] Christoph Hagen, Christian Weinert, Christoph Sendner, Alexandra Dmitrienko,
and Thomas Schneider. 2021. All the Numbers are US: Large-scale Abuse of
Contact Discovery in Mobile Messengers. In 28th Annual Network and Distributed
System Security Symposium, NDSS. The Internet Society.
[29] Shai Halevi and Victor Shoup. 2020. Design and implementation of HElib: a
homomorphic encryption library. Cryptology ePrint Archive, Report 2020/1481.
https://eprint.iacr.org/2020/1481.
[30] Carmit Hazay and Yehuda Lindell. 2008. Efficient Protocols for Set Intersection
and Pattern Matching with Security Against Malicious and Covert Adversaries.
In Theory of Cryptography, Ran Canetti (Ed.). Springer Berlin Heidelberg, Berlin,
Heidelberg, 155‚Äì175.