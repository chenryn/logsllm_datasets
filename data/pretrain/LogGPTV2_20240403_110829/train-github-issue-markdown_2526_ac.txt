    -> celery@query-runner-celery-datalake-687847cbb6-m8wfp: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-dgmf9: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-drdl2: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-lgstj: OK
        * {'id': '741f2751-ca24-4bcd-b78c-1d92e679952d', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_e526e7f0e7a7c28271dc8f08ee19504b', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3021 on dash 595', 'caller_json': {'queryId': 3021, 'interval': 'HOURLY', 'dashboard_id': 595, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-lgstj', 'time_start': 1606251616.69369, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 16}
    -> celery@query-runner-celery-ga-55cdb77d4-6jxzz: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-g9swh: OK
        * {'id': '650009cc-4d6b-42c4-96b1-9a3112a1e5c8', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_711f6cdfe13c22710887f00f5678baeb', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 2399 on dash 609', 'caller_json': {'queryId': 2399, 'interval': 'HOURLY', 'dashboard_id': 609, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-g9swh', 'time_start': 1606251604.6513581, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 15}
        * {'id': 'd74e3272-45f0-44ee-bcab-7b67de60b407', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_5ca350ca8b4b185ad42f94c6dd3b6fc9', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3189 on dash 624', 'caller_json': {'queryId': 3189, 'interval': 'HOURLY', 'dashboard_id': 624, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-g9swh', 'time_start': 1606251611.4904687, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 14}
        * {'id': '6f61b237-fa9e-4b30-8131-8d8ee75306c5', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_9bc92aabee38e8d6d607bbb24785d814', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 2137 on dash 557', 'caller_json': {'queryId': 2137, 'interval': 'HOURLY', 'dashboard_id': 557, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-g9swh', 'time_start': 1606248030.1126661, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 13}
    -> celery@query-runner-celery-datalake-687847cbb6-dvdpl: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-pdxsk: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-vl2t6: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-g55gl: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-7spd4: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj: OK
        * {'id': 'ab45784f-8d85-452c-b690-43ead1a010c6', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_bb8a680bab37f6bc86eb9f5c7435d656', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 2816 on dash 609', 'caller_json': {'queryId': 2816, 'interval': 'HOURLY', 'dashboard_id': 609, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj', 'time_start': 1606251605.576281, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 14}
        * {'id': '4e64157e-9356-4362-88af-318013c0c4de', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_4859064fc4b96df99eec68e94f733157', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3143 on dash 616', 'caller_json': {'queryId': 3143, 'interval': 'HOURLY', 'dashboard_id': 616, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj', 'time_start': 1606251609.5426545, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 13}
        * {'id': 'ac0c403b-ade6-4377-9a41-6d305268204b', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_b04a82ce9376c9c6618c3a300abe4182', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3109', 'caller_json': {'queryId': 3109, 'interval': 'HOURLY', 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj', 'time_start': 1606240815.8285584, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 16}
        * {'id': 'e9c368de-d47f-4a84-b05d-81cbda00a394', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_4d03e965dbd57a05d6071c0b5cbf699d', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 2398 on dash 609', 'caller_json': {'queryId': 2398, 'interval': 'HOURLY', 'dashboard_id': 609, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj', 'time_start': 1606251604.517987, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 15}
    -> celery@query-runner-celery-default-6c9bd65fd7-8zdvm: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-2zxhc: OK
        * {'id': '03e786df-44b1-412a-8354-3acbc762528f', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_0687aa16794011f4d1a0ee1023173bf8', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3105 on dash 557', 'caller_json': {'queryId': 3105, 'interval': 'HOURLY', 'dashboard_id': 557, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-2zxhc', 'time_start': 1606251618.9102547, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 16}
        * {'id': '646617ce-9835-4b60-b5fd-c4a4a5631749', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_ed09cf8c1166115a4ed1a5aa33b032c7', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 3144 on dash 616', 'caller_json': {'queryId': 3144, 'interval': 'HOURLY', 'dashboard_id': 616, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-2zxhc', 'time_start': 1606251609.6082683, 'acknowledged': True, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': 15}
    root@query-runner-celery-datalake-687847cbb6-mxrnc:/opt/workdir# celery -A tasks inspect reserved
    2020-11-24 21:04:03,851 [WARNING] datadog.api: No agent or invalid configuration file found
    2020-11-24 21:04:03,854 [INFO] tasks.datadog_helper: initialized with
    2020-11-24 21:04:03,855 [INFO] tasks.datadog_helper: {'statsd_host': '172.29.156.91', 'statsd_port': 8125, 'statsd_namespace': 'query_runner_celery_tasks'}
    -> celery@query-runner-celery-default-6c9bd65fd7-4cdz6: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-v8w22: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-mxrnc: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-68xqn: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-q82hx: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-lsk2z: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-4dx2b: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-hnrhw: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-lgstj: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-9f8r2: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-j6994: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-9jp2n: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-92hxc: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-269rc: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-nqhtk: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-4s4lz: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-94qs4: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-m8wfp: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-6xldj: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-dgmf9: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-g9swh: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-6jxzz: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-dvdpl: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-g55gl: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-drdl2: OK
        - empty -
    -> celery@query-runner-celery-ga-55cdb77d4-vl2t6: OK
        - empty -
    -> celery@query-runner-celery-default-6c9bd65fd7-8zdvm: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj: OK
        * {'id': '3f501bbe-6c56-48e2-ba64-9b1adac30695', 'name': 'tasks.query.run_query', 'args': '()', 'kwargs': "{'query_id': 'query_6eb04958c42a71ebd014f9be9e116f73', 'queue': 'datalake-interval-refresh', 'caller_info': {'caller': 'Interval refresh HOURLY for Query id 2823 on dash 557', 'caller_json': {'queryId': 2823, 'interval': 'HOURLY', 'dashboard_id': 557, 'action': 'refresh_data'}, 'user_id': '0', 'username': 'intervalRefreshUser'}}", 'type': 'tasks.query.run_query', 'hostname': 'celery@query-runner-celery-datalake-interval-refresh-784bb858c8-qskvj', 'time_start': None, 'acknowledged': False, 'delivery_info': {'exchange': '', 'routing_key': 'datalake-interval-refresh', 'priority': 0, 'redelivered': None}, 'worker_pid': None}
    -> celery@query-runner-celery-datalake-687847cbb6-7spd4: OK
        - empty -
    -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-2zxhc: OK
        - empty -
    -> celery@query-runner-celery-datalake-687847cbb6-pdxsk: OK
        - empty -
Also, here is the output of `celery inspect stats` where you can see `fair` is
getting in properly
**`celery inspect stats for worker query-runner-celery-datalake-interval-
refresh-784bb858c8-dgmf9` Output:**
``` -> celery@query-runner-celery-datalake-interval-refresh-784bb858c8-dgmf9:
OK { "broker": { "alternates": [], "connect_timeout": 4, "failover_strategy":
"round-robin", "heartbeat": 120.0, "hostname": "query-runner-redis-master",
"insist": false, "login_method": null, "port": 6379, "ssl": false,
"transport": "redis", "transport_options": {}, "uri_prefix": null, "userid":
null, "virtual_host": "0" }, "clock": "8600271", "pid": 8, "pool": { "max-
concurrency": 4, "max-tasks-per-child": "N/A", "processes": [ 13, 14, 15, 16
], "put-guarded-by-semaphore": false, "timeouts": [ 0, 0 ], "writes": { "all":
"42.86%, 42.86%, 14.29%", "avg": "33.33%", "inqueues": { "active": 0, "total":
4 }, "raw": "3, 3, 1", "strategy": "fair", "total": 7 } }, "prefetch_count":
4, "rusage": { "idrss": 0, "inblock": 72400, "isrss": 0, "ixrss": 0, "majflt":
158, "maxrss": 68800, "minflt": 69557, "msgrcv": 0, "msgsnd": 0, "nivcsw":
2942, "nsignals": 0, "nswap": 0, "nvcsw": 334278, "oublock": 1584, "stime":
7.775837, "utime": 152.889586 }, "total": { "tasks.query.run_query": 7 } } ```
Generally, we have a lot of tasks long running tasks. This issue is making our
tasks take double the amount of time because they are unnecessarily waiting
behind other tasks without utilizing the other workers.