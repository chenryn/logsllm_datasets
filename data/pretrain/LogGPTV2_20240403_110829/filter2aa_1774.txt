我是谁
姓名：董弘琛
ID：月白
90后白帽子，360网络安全专家，擅长渗透测试、
代码审计、脚本开发等相关安全技能。金融行业相
关安全服务经验丰富，希望能和各位师傅们交流学
习更多的知识。
同时也感谢我的领导、团队以及主办方对我的帮助
与支持。
先来聊聊代码审计
什么是代码审计？
为什么要代码审计？
如何进行代码审计？
什么是代码审计
检查源代码中的安全缺陷，检查程序源代码是否存在
安全隐患，或者有编码不规范的地方，通过自动化工
具或者人工审查的方式，对程序源代码逐条进行检查
和分析，发现这些源代码缺陷引发的安全漏洞，并提
供代码修订措施和建议。
什么是代码审计
就是在代码中寻找安全隐患
什么隐患？
如何寻找？
为什么代码审计
网络安全风险
白盒测试
代码审计收益
如何代码审计
代码审计的基本流程
确认审计
主体
确认系统使用的语
言、框架、版本信
息，开发文档等等。
对系统代码有清晰
的认知。
进行审计
挖掘漏洞
结合使用自动化工
具与人工审计，高
效而又细致的对系
统进行审计。
汇总并提供
修复方案
对审计出的漏洞进
行汇总，给出相应
的修复方案并协助
修复。
复测或
定期审计
代码并非一成不变，
漏洞也一样，定期
的代码审计同样重
要。
代码审计中的难点
语言繁多，组合使用
代码混乱，结构复杂
..\\..\\..\\App\\Common\\Conf\\db.php
Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGRiLnBocA==
http://127.0.0.1/xyhai.php?s=/Templets/edit/fname/
Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGRiLnBocA==
..\\..\\..\\App\\Common\\Conf\\config.php
Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGNvbmZpZy5waHA=
http://127.0.0.1/xyhai.php?s=/Templets/edit/fname/
Li5cXC4uXFwuLlxcQXBwXFxDb21tb25cXENvbmZcXGNvbmZpZy5waHA==
金融行业的安全背景
数字化进程的加快
由线下到线上的快速转变
行业监管要求日益严格细化
制度体系进一步完善
金融行业的安全风险
漏洞威胁
攻击威胁
代码本身
黑客攻击频繁、漏洞越挖越快、零DAY频出
不讲武德，网络攻击组织化与全球化
代码产出时便埋下的隐患
金融行业的安全漏洞
SQL注入
SQL注入：JDBC、Hibernate、Mybatis
跨站脚本
存储型XSS、反射型XSS、基于DOM的XSS
命令注入
不可信赖的数据导致程序执行恶意命令
HTTP响应截断
不可信赖的数据置于HTTP头文件中发出
密码管理
硬编码密码、配置文件中的明文密码、弱加密
XML注入
向XML文档中写入未经验证的数据
路径遍历
不可信赖的数据构成路径
XML外部实体注入
对非安全的外部实体数据进行处理
动态代码解析
程序运行时动态解析源代码指令受到攻击
组件漏洞
使用存在漏洞的组件
SQL注入：JDBC
拼接 SQL 语句
参数化查询
无效的参数化查询
用户输入
直接作为SQL指令的一部分
先编译带有占位符的SQL语句
将占位符替换为用户输入
SQL注入： Mybatis
在 MyBatis 中，使用 XML 文件 或 Annotation 来
进行配置和映射，将 interfaces 和 Java POJOs 
映射到 database records
•
简化绝大部分 JDBC 代码、手工设置参数和获取结果
•
灵活，使用者能够完全控制 SQL，支持高级映射
MyBatis XML
Mapper Interface
XML 配置文件
#{ }
${ }
#{ }
${ }
存在着一些不能直接使用#{ }的情况
ORDER BY
LIKE
IN
如何避免使用${ }呢？
SQL注入：Hibernate
Hibernate 它使用时只需要操纵对象，使开发更对象
化，抛弃了数据库中心的思想，是完全的面向对象思
想。同时拥有简洁的 HQL 编程。
敢把我给忘了？
HQL 注入
位置参数
命名参数
类实例
路径遍历
组件安全
开源组件带来的安全隐患
组件漏洞
难以排查，系统中存在大量的组件，版本不一
难以维护，部分组件不再更新或者更新缓慢
难以修复，部分组件漏洞很难或需要大量时间
精力进行修复
安全组件带来的安全防护
组件分类
组件名称
业务功能安全组件
文件安全上传组件
文件安全下载组件
密码找回组件
分步提交组件
数据脱敏组件
防篡改组件
攻击防护安全组件
防短信炸弹组件
防重放组件
防越权访问组件
组件分类
组件名称
安全工具组件
 Cookie保护组件
加密算法组件
Token组件
随机数生成器
业务安全日志
编码组件
攻击防护安全组件
防sql注入组件
防XSS跨站组件
防扫描器组件
防直接对象引用
代码安全解决方案
防患于未然：将代码安全融入系统整个安全生命周期。
发布
需求
设计
实施
测试
IT投入占比与网络安全领域投入占比
数据来源于《金融行业网络安全白皮书》
代码审计分析平台
代码安全解决方案
酒仙桥六号部队
个人微信
雪狼别动队