001
Speaker@YongShao
• 
• 
• 
• 
Whoami
Oauth2.0
• 
• 
• 
()!
•   
•   
•  
Web
https://facebook.com/dialog/oa
uth?response_type=code&clien
t_id=CLIENT_ID&redirect_uri=R
EDIRECT_URI&scope=email&sta
te=1234zyx
• 
• 
https://open.weixin.qq.com/connect/oauth
2/authorize?appid=wxc43*******&respon
se_type=code&scope=snsapi_base&redirec
t_uri=http://baidu.com&state=**********
*&connect_redirect=1#wechat_redirect
Token Leak
Timelime:
2018.02.13
Redirect vulnerability
2018.03.20 
Find token leak
2018.03.21
Report Vulnerability
2018.03.30
Fixed
Detail
• 
• 
Detail
Detail
POC/EXP
Write js
Write php
POC/EXP
POC/EXP
IM
Login Redirect
• 
• ➜ 
•    
Qrljacking
Qrljacking
Qrljacking
Qrljacking
Qrljacking
Qrljacking
app
app
app
CSRF
CSRF
/oauth/weibo/redirect
CSRF
CSRF
CSRF
API Leak
API Leak
API Leak
Login Google
Jetbrains Team Work
Use old poc
xss Platform got it
Demo MP4
Other
Redirect Bypass
:::25/..
#25
:::25/..
:::25
:::25
:::55.5:::25
2#5
:::55.525
:::55.525
:::55.525
:::55.5%25
:::55.525
:::55.525
Help Me(how to fixed)
Help Me(how to fixed)
!  
How$I$Hacked$[Oculus]
OAuth$+Ebay$+IBM
Stealing$Facebook
access_tokens$using$CSRF
in$device$login$flow
Internet$Explorer$has$a
URL$problem
Authentication$bypass$on
Airbnb$via$OAuth$tokens
theft
Stealing$Access$Token$of
One-drive$Integration$By
Chaining$CSRF
Vulnerability
Stealing$0Auth$Token
(MITM)
Finding$hidden$gems$vol.
1:$forging$OAuth$tokens
using$discovered$client$id
and$client$secret
Speaker@YongShao