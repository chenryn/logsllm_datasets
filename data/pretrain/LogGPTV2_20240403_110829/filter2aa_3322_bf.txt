议如下：
① 充分掌握本单位应用系统利用的开发框架，跟踪漏洞平台和安
全厂商披露的涉及本单位所用开发框架的漏洞，并根据处置建议加固
或者升级。
② 遵从最小应用原则，删除不用的应用组件。
2）主流CMS漏洞。各个单位可能会采用比较成熟的CMS管理或发布
网站内容。如果单位的CMS暴露在互联网上，且CMS名称和版本暴露的
话，攻击者就可能会在各漏洞平台搜索该CMS已被披露的利用漏洞，或
自己搭建环境挖掘该系统漏洞，挖掘成功后就可以成功攻陷目标单位
CMS。安全建议如下：
① 禁止将CMS暴露在互联网上；
② 尽量隐藏商业CMS名称和版本；
③ 删除不使用的功能模块。
3）编辑器漏洞。单位论坛、管理后台可能会引用第三方编辑器的
丰富编辑功能。某些主流编辑器或版本存在漏洞，被攻击者发现的话
也会存在较大的安全风险。解决建议如下：
① 充分掌握本单位引用的编辑器名称和版本，跟踪漏洞平台和安
全厂商披露的涉及本单位所用编辑器的漏洞，并根据处置建议加固或
者升级。
② 遵从最小应用原则，删除不用的功能组件。
4）商业系统漏洞：各个单位可能会采用比较成熟的商业Web系
统，如致远OA、帆软报表等商业系统，如果该商业系统暴露在互联网
上，且系统名称和版本暴露的话，攻击者会在各漏洞平台搜索披露的
该商业系统利用漏洞，或自己搭环境挖掘该系统漏洞，挖掘成功后攻
击目标单位商业系统。安全建议如下：
① 尽量隐藏商业系统名称和版本；
② 删除不用的功能模块；
③ 及时更新商业厂商提供的漏洞补丁。
5）开源软件系统漏洞：开源软件由于其便利性和经济性，广受开
发厂商和开发者欢迎，IT系统复杂的单位都或多或少使用了开源软
件。由于其开源性，攻击者可通过白盒测试审计代码中存在的安全漏
洞，如果所使用的开源系统被攻击者发现，则极有可能被攻陷。安全
建议如下：
① 尽量隐藏开源系统的指纹痕迹和版本；
② 删除不用的功能模块；
③ 使用开源软件之前进行代码审计。
6）Web接口漏洞：Web接口由于具有隐蔽性，在渗透测试时很容易
被忽略。不安全的接口开放在互联网上，一旦被攻击者发现则极容易
被利用。安全建议如下：
① 参演单位安全人员需要充分掌握暴露在互联网上的Web接口，
并协调安全测试人员对每个接口进行安全性测试。
② 编写Web接口安全规范，要求接口开放必须符合安全规范。
③ Web接口引用增加鉴权和身份认证。
④ 加密和签名用于确保API请求与响应在传输过程中的数据保密
性和完整性（未被篡改）。
⑤ 关闭不需要的API功能（如文件上传功能）。
⑥ 若API必须使用文件上传功能，则需要对上传文件扩展名（或
强制重命名）、内容、格式进行合规检测，同时关闭上传文件夹执行
权限。
2. 管理后台（路径）及弱密码
很多单位的运维人员为了方便会把应用管理后台发布在互联网
上，这就使得网站后台容易被攻击者盯上。一旦后台密码泄露或存在
安全漏洞，攻击者可直接获得网站管理权限，部署后门。安全建议如
下：
① 禁止后台地址对外网开放；
② 限制访问后台的IP地址；
③ 禁止默认密码、弱口令；
④ 增加验证码功能以防止暴力破解；
⑤ 测试用户名登录和密码参数是否存在SQL注入。
3. 重要集权系统
组织内的重要集权系统（攻陷即可获得组织内大部分系统权限的
系统都可以视为重要集权系统）是攻击者在进入内网后横向拓展的重
要目标，如域控、4A、堡垒机、集中管控、集中身份认证系统、终端
管理系统。重要集权系统一定要重点防护，安全建议如下：
① 制定重要集权系统访问白名单，只有受认可的IP才可以访问管
理页面或系统；
② 定期对重要集权系统进行漏洞扫描，对高危漏洞必须打补丁；
③ 对重要集权系统进行渗透测试，针对漏洞进行整改；
④ 在重要集权系统的主机上安装入侵防护软件和杀毒软件，开启
审计日志；
⑤ 清理不用的、过期的权限账号。
4. 安全设备自身安全
安全设备自身的安全性同样重要，一旦安全设备存在安全漏洞，
那么它可能就会成为攻击者逃避检测、收集信息、监控防护人员举
动、修改安全策略等的“帮凶”，使部分或全部防护和监控手段形同
虚设。安全设备自身安全的建议如下：
① 为安全设备管理入口单独划分安全域；
② 为管理入口配置白名单访问；
③ 对安全设备进行安全检测，如渗透测试、安全加固、漏洞扫
描；
④ 禁止安全设备管理入口暴露在互联网上；
⑤ 安全设备自身开启日志审计。
8.5.5 App客户端安全
由于移动互联网的普及，很多单位应用系统都会有Web和App两种
访问方式，所以App安全也应该重点考虑。如果App存在安全漏洞，攻
击者同样可以成功入侵目标单位。App安全测试目前主要分为App客户
端安全测试和App组件安全测试。
如果App客户端可以被反编译、DLL注入，配置文件存在敏感信
息，攻击者可通过App的漏洞获取App后台服务器敏感信息，从而攻击
App后台服务器并进一步进行内网渗透。
1. App客户端安全
攻击者得到目标App后，利用反编译工具可以很方便地得到App代
码，进而对App代码进行逆向分析、修改、重打包。若没有采用任何加
固保护措施，App的逻辑将完完整整地暴露给攻击者。App客户端安全
需要注意的检测点如下：
·App客户端反编译保护；
·App签名认证；
·App完整性校验；
·App任意调试检测；
·App数据任意备份；
·App敏感信息泄露。
2. App组件安全
安卓App在前端运行时会调用各种不同组件，如果开发者发生疏
忽，组件安全也会造成安全隐患。App组件安全检查点如下：
·Activity组件越权；
·BroadcastReceiver组件越权；
·Service组件越权；
·Content Provider SQL注入；
·WebView远程代码执行。
3. App其他安全
建议聘请专业的App安全检测人员对App进行安全检测。除了上述
两点外，还需要对如下安全点进行检测：
·App通信安全检测，如是否采用HTTPS、关键信息是否加密；
·运行环境安全检测，如反越狱检测、ROOT环境检测等；
·安全策略设置检测，如键盘记录保护、界面切换保护检测等；
·基于业务安全的常规渗透测试检测。
第9章 红队常用的关键安全设备
部署安全设备及系统是防守工作的必要条件之一，以下通过边界
防御设备、安全检测设备、流量监控设备、终端防护设备、威胁情报
系统这五方面帮助读者了解、熟悉红队常用的关键安全设备。
9.1 边界防御设备
9.1.1 防火墙
防火墙作为网络安全防护的基础设备，发展到现在已成为能够全
面应对传统网络攻击和高级威胁的安全防护产品，被广泛运用于网络
边界防护领域，具有网络安全域隔离、精细化访问控制、高效威胁防
护和高级威胁检测等功能。防火墙可集成威胁情报搜集、大数据分析
和安全可视化等创新安全技术，并通过与网络威胁感知中心、安全管
理分析中心、终端安全管理系统等的智能协同，在网络边界构建威胁
防御平台。
1. 设备应具有的核心功能
1）基础能力：支持多种形式灵活部署，具备负载均衡、NAT（网
络地址转换）、IPv6支持、VPN、VSYS（虚拟防火墙）、HA（双机集群
系统）等功能，并可防护扫描、泛洪、异常数据包等传统网络攻击。
2）精细化应用控制：可精确识别网络应用及用户、终端、地理位
置、传输内容等信息，并可实现应用、用户、内容多维一体的精细化
管控。
3）高性能威胁防护：深度集成一体化威胁防护引擎，可针对流行
的病毒、漏洞利用攻击和间谍软件行为等提供高性能防护。
4）智能化协同防御：支持与云端、终端安全系统智能协同，实现
病毒云查杀、威胁情报实时处置、应急响应策略推送、高风险终端管
控等高级安全功能。
5）失陷检测及处置：可对网络流量产生的行为数据进行威胁情报
检测和深度分析，实时预警本地的失陷主机，并对受害IP、威胁源执
行一键处置。
6）可视化关联分析：能够将应用、用户、内容、威胁、地理位置
等多维信息以图形化形式关联呈现，并通过递进式的数据钻取实现高
效的安全分析。
2. 产品在实战中的应用
防火墙作为最基础的安全防护设备，在实战演练中也发挥着重大