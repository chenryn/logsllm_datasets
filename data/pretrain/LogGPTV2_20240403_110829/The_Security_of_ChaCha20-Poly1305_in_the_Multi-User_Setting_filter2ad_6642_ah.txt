and Elisabeth Oswald (Eds.). Springer, Heidelberg, 327–350. https://doi.org/10.
1007/978-3-642-55220-5_19
[12] Marc Fischlin, Felix Günther, and Christian Janson. 2020. Robust Channels:
Handling Unreliable Networks in the Record Layers of QUIC and DTLS 1.3.
Cryptology ePrint Archive, Report 2020/718. https://eprint.iacr.org/2020/718.
[13] Shoni Gilboa and Shay Gueron. 2021. The advantage of truncated permutations.
Discrete Applied Mathematics 294 (2021), 214–223. https://doi.org/10.1016/j.dam.
2021.01.029
[14] Felix Günther, Martin Thomson, and Christopher A. Wood. 2021. Usage Limits
on AEAD Algorithms – draft-irtf-cfrg-aead-limits-03. https://datatracker.ietf.org/
doc/html/draft-irtf-cfrg-aead-limits-03.
[15] Viet Tung Hoang, Stefano Tessaro, and Aishwarya Thiruvengadam. 2018. The
Multi-user Security of GCM, Revisited: Tight Bounds for Nonce Randomization.
In ACM CCS 2018, David Lie, Mohammad Mannan, Michael Backes, and XiaoFeng
Wang (Eds.). ACM Press, 1429–1440. https://doi.org/10.1145/3243734.3243816
[16] Tetsu Iwata, Keisuke Ohashi, and Kazuhiko Minematsu. 2012. Breaking and
Repairing GCM Security Proofs. In CRYPTO 2012 (LNCS, Vol. 7417), Reihaneh
Safavi-Naini and Ran Canetti (Eds.). Springer, Heidelberg, 31–49. https://doi.
org/10.1007/978-3-642-32009-5_3
[17] KryptosLogic. 2021.
Kryptos
Logic Blog. https://www.kryptoslogic.com/blog/2021/01/faster-poly1305-key-
multicollisions.
Faster Poly1305 key multicollisions.
[18] A Langley. 2013. ChaCha20 and Poly1305 based Cipher suites for TLS, draft-agl-
tls-chacha20poly1305-00. IETF Internet Draft. https://tools.ietf.org/html/draft-
agl-tls-chacha20poly1305-00.
[19] Atul Luykx, Bart Mennink, and Kenneth G. Paterson. 2017. Analyzing Multi-key
Security Degradation. In ASIACRYPT 2017, Part II (LNCS, Vol. 10625), Tsuyoshi
Takagi and Thomas Peyrin (Eds.). Springer, Heidelberg, 575–605. https://doi.org/
10.1007/978-3-319-70697-9_20
[20] Atul Luykx and Kenneth G Paterson. 2015. Limits on authenticated encryption
use in TLS. Personal webpage: http://www. isg. rhul. ac. uk/˜ kp/TLS-AEbounds. pdf
(2015).
[21] David A. McGrew and John Viega. 2004. The Security and Performance of the
Galois/Counter Mode (GCM) of Operation. In INDOCRYPT 2004 (LNCS, Vol. 3348),
Anne Canteaut and Kapalee Viswanathan (Eds.). Springer, Heidelberg, 343–355.
[22] Daniele Micciancio and Shafi Goldwasser. 2012. Complexity of lattice problems: a
[23] Y. Nir and A. Langley. 2018. ChaCha20 and Poly1305 for IETF Protocols. RFC
cryptographic perspective. Vol. 671. Springer Science & Business Media.
8439 (Informational). https://doi.org/10.17487/RFC8439
[24] Yuichi Niwa, Keisuke Ohashi, Kazuhiko Minematsu, and Tetsu Iwata. 2015. GCM
Security Bounds Reconsidered. In FSE 2015 (LNCS, Vol. 9054), Gregor Leander (Ed.).
Springer, Heidelberg, 385–407. https://doi.org/10.1007/978-3-662-48116-5_19
[25] Jacques Patarin. 2009. The “Coefficients H” Technique (Invited Talk). In SAC 2008
(LNCS, Vol. 5381), Roberto Maria Avanzi, Liam Keliher, and Francesco Sica (Eds.).
Springer, Heidelberg, 328–345. https://doi.org/10.1007/978-3-642-04159-4_21
[26] Gordon Procter. 2014. A Security Analysis of the Composition of ChaCha20 and
Poly1305. Cryptology ePrint Archive, Report 2014/613. https://eprint.iacr.org/
2014/613.
[27] Gordon Procter and Carlos Cid. 2015. On Weak Keys and Forgery Attacks Against
Polynomial-Based MAC Schemes. Journal of Cryptology 28, 4 (Oct. 2015), 769–795.
https://doi.org/10.1007/s00145-014-9178-9
[28] Martin Raab and Angelika Steger. 1998. “Balls into Bins” — A Simple and Tight
Analysis. In Randomization and Approximation Techniques in Computer Science,
Michael Luby, José D. P. Rolim, and Maria Serna (Eds.). Springer Berlin Heidelberg,
Berlin, Heidelberg, 159–170.
[29] E. Rescorla. 2018. The Transport Layer Security (TLS) Protocol Version 1.3. RFC
8446 (Proposed Standard). https://doi.org/10.17487/RFC8446
[30] Eric Rescorla, Hannes Tschofenig, and Nagendra Modadugu. 2021. The Datagram
Transport Layer Security (DTLS) Protocol Version 1.3 – draft-ietf-tls-dtls13-43.
https://tools.ietf.org/html/draft-ietf-tls-dtls13-43.
[31] M. Thomson (Ed.) and S. Turner (Ed.). 2021. Using TLS to Secure QUIC. RFC
9001 (Proposed Standard). https://doi.org/10.17487/RFC9001
A PROOF OF BALLS-INTO-BINS THEOREM
We prove the Balls-Into-Bins theorem in two stages via a prelimi-
nary lemma. The improvement over [10] is a direct consequence of
this lemma. Lemma A.1 is additionally used to prove Theorem 7.7,
resulting in an improved bound for nonce randomization.
,
𝐵𝑡e
(cid:109)
(4) 𝑚 =
(1) 𝑚 =
log𝑡 ((𝑄𝐵)−1)
and 𝑄 ≤ 1
𝐵 ,
For any of the following cases:
A.1 Preliminary Lemma
The proof of Theorem 5.1 and Theorem 7.7 is based on the following
lemma.
Lemma A.1. Let 𝑚, 𝑄 ∈ N∗, 𝐵 ∈ (0, 1] and(cid:101)𝑚, 𝑡 ∈ R>0, with 𝑡 > 1.
(cid:108) log𝑡 (𝐵−1)+(cid:101)𝑚
(2) 𝑚 =(cid:6)log𝑡 (𝐵−1) +(cid:101)𝑚(cid:7) and 𝑄 ≤ log𝑡 (𝐵−1)+(cid:101)𝑚
(3) 𝑚 = ⌈𝑄𝐵𝑡e⌉ and 𝑄 ≥ log𝑡 (𝐵−1)+(cid:101)𝑚
(cid:108) max(𝑄𝐵𝑡e,log𝑡 (𝐵−1)+(cid:101)𝑚)
(cid:109)
(cid:1) · 𝐵𝑚−1 ≤ 𝑡−(cid:101)𝑚.
it holds that(cid:0)𝑄
𝑚 = ⌈max(𝑄𝐵𝑡e, log𝑡 (𝐵−1) +(cid:101)𝑚)⌉,
and if 𝑄 ≤ log𝑡 (𝐵−1)+(cid:101)𝑚
(cid:25)
(cid:24)
log𝑡 (𝐵−1) +(cid:101)𝑚
(cid:109) and 𝑄 ≤ 1
(cid:108) log𝑡 (𝐵−1)+(cid:101)𝑚
≤(cid:6)log𝑡 (𝐵−1) +(cid:101)𝑚(cid:7).
Proof. We consider the different cases in turn.
Note that Cases 2 and 3 can be combined into
max(1, log𝑡 ((𝑄𝐵)−1))
max(1,log𝑡 ((𝑄𝐵)−1))
, Case 4 gives us
𝐵𝑡e
,
𝑚 =
𝐵𝑡e
𝑚
,
= 𝐵−1 · (𝑄𝐵)𝑚 = 𝐵−1 · 𝑡−𝑚·log𝑡 ((𝑄𝐵)−1) .
𝐵 .
log𝑡 ((𝑄𝐵)−1)
Case 1: 𝑚 =
For this case,
(cid:18)𝑄
(cid:19)
As 𝑡 > 1, 𝑄𝐵 ≤ 1 and 𝑚 ≥ log𝑡 (𝐵−1)+(cid:101)𝑚
· 𝐵𝑚−1 ≤ 𝑄𝑚 · 𝐵𝑚−1
𝑚
log𝑡 ((𝑄𝐵)−1) , then
𝑡−𝑚·𝑙𝑜𝑔𝑡 ((𝑄𝐵)−1) ≤ 𝑡− log𝑡 (𝐵−1)−(cid:101)𝑚 = 𝐵 · 𝑡−(cid:101)𝑚.
· 𝐵𝑚−1 ≤ 𝑡−(cid:101)𝑚.
(cid:18)𝑄
(cid:19)
𝑚
Hence
Session 6D: Authentication and Privacy CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea1994.
𝑚
𝑚
𝑚
𝑚
 1, 𝑄𝐵 ≤ 1 and 𝑚 ≥ log𝑡 (𝐵−1)+(cid:101)𝑚
𝑚
log𝑡 ((𝑄𝐵)−1) . Hence
𝑚
· 𝐵𝑚−1 ≤ 𝑡−(cid:101)𝑚. □
A.2 Proof of Theorem 5.1
We are now ready to show how Theorem 5.1 is derived from
Lemma A.1
Since 𝑚 ≥ 1, when 𝑄 = 0 the probability that the heaviest bin
contains 𝑚 or more balls is clearly 0. Thus, we can focus on the
case where 𝑄 > 0. Let us consider the case where 𝑞 ≤ 𝑄 balls are
thrown into bins and where 𝑚 satisfies one of the conditions of the
theorem. If 𝑚 > 𝑞, the probability that the heaviest bin contains
𝑚 or more balls is 0. If 𝑚 ≤ 𝑞 and the heaviest bin contains 𝑚
or more balls, then at least one of the(cid:0) 𝑞
(cid:1) possible subsets of 𝑚
balls (from the set of 𝑞 balls thrown) is in the same bin. Hence, to
bound the probability that the heaviest bin contains 𝑚 or more balls
in this case, we only need to bound the probability that at least
one of these subsets is in the same bin. For each of these subsets,
the probability that all 𝑚 balls in that subset are thrown into the
same bin is at most 𝐵𝑚−1. Thus the probability that at least one
(cid:1) possible subsets of 𝑚 balls is in the same bin is at most
(cid:1) · 𝐵𝑚−1 ≤ 𝑡−(cid:101)𝑚 for
(cid:1) · 𝐵𝑚−1. Using Lemma A.1,(cid:0)𝑄
of the(cid:0) 𝑞
(cid:0) 𝑞
(cid:1) · 𝐵𝑚−1 ≤(cid:0)𝑄
𝑚
𝑚
𝑚
𝑚
𝑚
(cid:24)
(cid:19)
𝑚 =
(cid:18)𝑄
log𝑡 ((𝑄𝐵)−1) .
≥ log𝑡 (𝐵−1) +(cid:101)𝑚
(cid:19)
(cid:18)𝑄
the four different cases. Hence the probability that the heaviest bin
contains 𝑚 or more balls is also at most 𝑡−(cid:101)𝑚.
B MISSING COMPONENTS IN THE PROOF OF
THEOREM 6.1
In this section, we prove the remaining pieces that are necessary
to complete the proof of the multi-user security of ChaCha20-
Poly1305 outlined in Section 6. In Appendix B.1 we prove Proposi-
tion 6.2, which lower bounds the ratio of good transcripts, and in
Appendix B.2 we prove Lemmas B.2–B.7, which upper bound the
probabilities of bad transcripts in the ideal world.
B.1 Proof of Proposition 6.2 (Good Transcript
Ratio)
Let 𝜏 ∈ 𝑇good be a good transcript and let 𝐾𝜏, 𝑃𝜏, 𝐸𝜏, and 𝑉𝜏 be the
sets of revealed-key, ideal-permutation, encryption, and verification