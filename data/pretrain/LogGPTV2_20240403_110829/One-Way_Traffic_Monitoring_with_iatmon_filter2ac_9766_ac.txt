e
F
1
0
n
a
J
1
0
0
1
8
6
4
2
0
r
e
h
t
o
h
t
l
a
e
S
t
i
s
e
k
p
s
&
h
t
l
a
e
S
t
t
f
e
l
e
d
o
m
s
3
e
d
o
m
s
3
&
h
n
e
v
e
t
h
g
i
r
e
d
o
m
s
3
e
d
o
m
s
3
t
l
a
e
S
t
S
o
D
e
t
a
r
-
h
g
H
i
d
e
p
u
o
r
g
n
U
d
e
v
i
l
-
t
r
o
h
S
)
B
G
(
s
e
m
u
l
o
v
p
u
o
r
G
)
d
(
)
B
G
(
s
e
m
u
l
o
v
e
p
y
T
)
c
(
D
S
C
U
,
1
1
0
2
n
u
J
0
3
–
n
a
J
3
;
)
t
h
g
i
r
(
s
p
u
o
r
g
e
c
r
u
o
s
d
n
a
)
t
f
e
l
(
s
e
p
y
t
e
c
r
u
o
s
r
o
f
r
u
o
h
r
e
p
s
e
m
u
l
o
v
d
n
a
s
t
n
u
o
c
l
a
t
o
t
e
g
a
r
e
v
a
y
l
i
a
D
.
3
.
g
i
F
e
p
o
c
s
e
l
e
T
k
r
o
w
t
e
N
d
e
p
y
t
n
U
e
b
o
r
p
P
C
T
n
a
c
s
l
n
a
c
s
l
a
c
i
t
r
e
v
P
C
T
a
t
n
o
z
i
r
o
h
P
C
T
r
e
h
t
o
P
C
T
e
b
o
r
p
P
D
U
t
r
e
h
o
P
D
U
n
a
c
s
l
n
a
c
s
l
a
c
i
t
r
e
v
P
D
U
a
t
n
o
z
i
r
o
h
P
D
U
C
r
e
k
c
i
f
t
n
e
r
r
o
T
u
n
o
C
l
y
n
o
P
M
C
I
r
e
t
t
a
c
s
k
c
a
B
P
D
U
d
n
a
P
C
T
l
u
J
1
0
n
u
J
1
0
y
a
M
1
0
r
p
A
1
0
r
a
M
1
0
b
e
F
1
0
n
a
J
1
0
Monitoring with iatmon
187
Figure 3(c) shows the daily average hour’s traﬃc volume (in GB) for the source
types. TCP horizontal scan traﬃc accounted for about half the total volume,
around 4 GB/h. UDP probe traﬃc decreased to about 0.2 GB/h, which seems
surprising since the number of UDP probe sources increased. Also, there was
about 0.1 GB of UDP horizontal scan traﬃc each hour, even though the number
of UDP horizontal scan sources was too small to be visible in Figure 3(c).
Considering source group activity, Figure 3(b) shows that short-lived sources
dominate, accounting for about 3/4 of the sources observed. The number of
stealth 3 s mode sources (TCP and UDP) declined steadily from 100 M to 30 M
sources during these six months, while the number of sources in the other groups
remained steady. On 12 January we saw 78,000 stealth other sources, these cor-
respond with the spike in TCP probes in Figure 3(a). Similarly, in the ﬁrst week
of April we saw a rise in stealth other sources, corresponding with a similar rise
in UDP probes. Traﬃc volumes for the source groups are shown in Figure 3(d).
Although the lower four bands on the plot correspond well with their group
counts (Figure 3(b)), the next three groups – 3 s mode left, DoS and high-rate
sources – account for up to 80% of the total traﬃc volume. Again, the 3 s mode
left volumes declined from 2.5 to 1.8 GB/h over the six months, corresponding
with our observation of the fall in TCP horizontal scans.
5 Conclusions and Future Work
Building on the demonstrated utility of the activity classiﬁcation scheme in
Treurniet [12], we have developed a taxonomy for one-way traﬃc sources us-
ing two independent classifying schemes: 14 source types and 10 IAT groups.
These schemes separate the one-way traﬃc into 140 subsets, allowing us to de-
termine which source subsets were active during any hour, and to track subset
behaviour over weeks or months as the characteristics of one-way traﬃc evolve.
Using these subsets, we found that:
– Long-term plots of type and group subsets indicate distinguishable changes
in the proportions each type or group contributes to total traﬃc.
– For the ﬁrst six months of 2011, although total daily average one-way traﬃc
into the UCSD network telescope did not increase signiﬁcantly, the composition
of per-source traﬃc behavior has changed, with an increase in TCP horizontal
scan and corresponding decrease in stealth 3 s mode sources. Although we see
many stealthy (long-lived low-rate) sources, most of the telescope traﬃc comes
from short-lived (< 1
2 hour) sources.
– We have used our iatmon tool to apply this taxonomy to hourly trace ﬁles,
its implementation runs at least fast enough to be used on a live 1 Gb/s network.
iatmon also includes tools to extract trace ﬁles for sources in ‘interesting’ type +
group subsets that show interesting behaviour. Such ‘source trace’ ﬁles can then
be examined in detail, for example to determine whether they represent traﬃc
from known malware.
In the future, we plan to develop iatmon so that it can detect signiﬁcant changes
in source subset counts or volumes, experiment with the thresholds in our IAT
188
N. Brownlee
group classiﬁcation scheme, investigate other possible classiﬁcation schemes (per-
haps as ‘plug-in modules’ for iatmon), and most importantly, explore a coopera-
tive global eﬀort to compare unsolicited traﬃc across a wider diversity of address
space. We are currently operating iatmon in real-time mode on the University
of Auckland’s production Internet gateway, a 1 Gb/s link carrying about 70,000
packet/s; we ﬁnd that 3% of the total traﬃc inbound to the University each hour
is one-way, consistent with another recent study of this link [7].
Acknowledgment. Thank-you to the anonymous reviewers, and to my colleagues
at CAIDA for their helpful suggestions for improving this paper.
References
1. Aben, E.: Conﬁcker as seen from UCSD Network Telescope (February 2009),
http://www.caida.org/research/security/ms08-067/conficker.xml
2. Barford, P., Nowak, R., Willett, R., Yegneswaran, V.: Toward a Model for Source
Address of Internet Background Radiation. In: Proc. Passive and Active Measure-
ment Conference, PAM 2006, Adelaide, Australia (2006)
3. CAIDA. Ucsd network telescope data use policy and request form,
http://www.caida.org/data/passive/telescope_dataset_request.xml
4. CAIDA. UCSD Network Telescope global attack traﬃc,
http://www.caida.org/data/realtime/telescope/
5. CAIDA. UCSD Network Telescope Research,
http://www.caida.org/data/passive/network_telescope.xml
6. Cooke, E., Bailey, M., Mao, Z., Watson, D., Jahanian, F., McPherson, D.: Toward
understanding distributed blackhole placement. In: Proc. ACM Workshop on Rapid
Malcode, WORM 2004, Washington DC, USA, pp. 54–64 (2004)
7. Lee, D., Brownlee, N.: Passive Measurement of One-way and Two-way Flow Life-
times. In: ACM SIGCOMM Computer Communication Review (2007)
8. Loewenstern, A.: DHT protocol (2008),
http://www.bittorrent.org/beps/bep_0003.html
9. Moore, D., Shannon, C., Brown, D., Voelker, G., Savage, S.: Inferring Internet
Denial-of-Service Activity. ACM Transactions on Computer Systems (May 2006)
10. Pang, R., Yegneswaran, V., Barford, P., Paxson, V., Peterson, L.: Characteristics of
Internet Background Radiation. In: Proc. of the 4th ACM SIGCOMM Conference
on Internet Measurement, IMC 2004, Sicily, Italy, pp. 27–40 (2004)
11. Porras, P., Saidi, H., Yegneswaran, V.: Conﬁcker C P2P Protocol and Im-
plementation. In: SRI International Technical Report, September 21 (2009),
http://mtc.sri.com/Conficker/P2P/
12. Treurniet, J.: A network activity classiﬁcation schema and its application to scan
detection. IEEE/ACM Transactions on Networking PP(99) (2011)
13. wiki.theory.org. Bittorrent protocol speciﬁcation v1.0 (2006),
http://wiki.theory.org/BitTorrentSpecification
14. Wustrow, E., Karir, M., Bailey, M., Jahanian, F., Huston, G.: Internet background
radiation revisited. In: Proceedings of the 10th Annual Conference on Internet
Measurement, IMC 2010. ACM (2010)