### Initial Setup and Challenges

Initially, our BitTorrent crawler was unrestricted. However, the high volume of incoming traffic generated by ping replies posed a significant challenge for our network administrators. To mitigate this issue and minimize the impact on our network, we implemented rate-limiting and restricted the crawler to address spaces where blocklists are present (as detailed in Section 4). By doing so, we reduced the burden on our network and minimized disruptions for users. 

To further enhance the efficiency and coverage of our crawler, we could deploy it at multiple vantage points across different networks. This would not only reduce the burden on any single network but also provide faster and more comprehensive coverage.

### Limitations of the Crawler

Our crawler has several limitations:
1. **NATed Addresses Detection**: The crawler can only detect NATed addresses that have more than one BitTorrent user. This means we are likely to miss NATs in networks where BitTorrent is not popular or where BitTorrent traffic is filtered.
2. **User Underestimation**: We can only detect NATed addresses that are reused by more than one user simultaneously, which may lead to an underestimation of the number of users behind a NAT.

### Identifying Dynamic Addresses

The RIPE NCC’s Atlas project uses custom devices to conduct various measurement tasks. Each RIPE Atlas probe connects to a central infrastructure for instructions and data updates. The measurements include unique probe IDs and IP addresses. Probes are typically deployed within the customer premises equipment (CPE) of the user. We use these logs to infer the dynamics of IP address allocation in the covering /24 address prefix. Here are the key properties we identified:

1. **Dynamic Addressing Over Time**: We observed RIPE Atlas probe measurement logs over 16 months to determine dynamic addressing. This long observation period allowed us to understand the frequency of IP address reallocation in probes.
2. **Frequency of IP Address Change**: We focused on probes that experienced multiple IP address allocations within the same AS during the monitoring period. We excluded probes with rare IP address changes and those that changed locations. Among the remaining probes, we considered those whose average duration between IP address changes was within one day. This helps in estimating the risk of blocklisting these IP addresses, as blocklisting may be effective for only one day and can lead to unjust blocking afterward.
3. **Extent of Dynamic Addressing**: If an IP address is determined to be dynamic based on the above criteria, we consider the entire /24 prefix covering this IP address to be dynamically allocated. This is a conservative approach, as contiguous addresses are usually administered together.

### Data Analysis

We used RIPE Atlas connection logs from January 1, 2019, to May 11, 2020. During this period, we observed over 15,703 RIPE Atlas probes that were allocated 311,000 IP addresses. Approximately 13.1% (or 2,000) of the probes went through address changes but had addresses allocated across multiple autonomous systems. Figure 2 shows the distribution of the remaining 13,600 probes and the number of addresses allocated to them. The majority of the probes (59% or 9,300) did not experience any IP address change, while 27% (or 4,200) went through multiple address changes.

To identify probes that change IP addresses more frequently, we determined the knee point of the graph, which indicates the number of IP address reallocations required to differentiate frequent changers from others. Using a technique proposed by Satopää et al. [63], we found the knee point to be at eight addresses.

This leaves us with 16.6% (2,600) of the probes that had at least eight IP address allocations during our monitoring period, all within the same autonomous system. These 2,600 probes covered a total of 204,000 IP addresses, with an average of 78 IP addresses per probe. In other words, 16.6% of all RIPE Atlas probes contributed to 65.5% of all IP addresses allocated to all RIPE Atlas probes. After considering probes that regularly change addresses within one day, we ended up with 4% (629) of probes that are in dynamically allocated address spaces. We only considered probes that change IP addresses daily, as they are more likely to cause unjust blocking compared to those that rarely change addresses.

### Limitations of Dynamic Address Detection

Our detection of dynamic addresses is limited to IP prefixes that deploy a RIPE Atlas probe. RIPE Atlas probes are predominantly present in Europe and North America, limiting our insights to these regions. Additionally, our technique involves choosing RIPE probes that have been allocated IP addresses from the same autonomous system. However, ISPs may own several autonomous systems and can allocate addresses from multiple systems. Even within the IP address spaces covered by RIPE Atlas probes, our technique provides only a lower-bound estimate of dynamically allocated prefixes. For probes that change their IP addresses frequently, we consider the entire /24 prefix to be potentially dynamically allocated, but this may not always be accurate. Network operators may deploy dynamic addressing within larger or smaller prefixes, leading to underestimation or overestimation of the extent of unjust blocking.

### Blocklist Detection

Blocklists typically list IP addresses involved in spam, DDoS attacks, dictionary attacks, or malicious scans. To quantify unjust blocking by blocklists, we used 151 IPv4 public blocklists from the BLAG dataset [60]. These lists are actively maintained and monitor a variety of malicious activities. Our dataset includes popular lists like DShield [43], NixSpam [57], Spamhaus [4], Alienvault [2], and Abuse.ch [1]. We collected blocklist data over two measurement periods: August 3, 2019, to September 10, 2019 (39 days), and March 29, 2020, to May 11, 2020 (44 days). During this period, we observed 2.2 million IP addresses, with each blocklist averaging 30,000 IP addresses.

Figure 4 shows the number of reused addresses discovered by our techniques. We ran our BitTorrent crawler simultaneously with the blocklist collection period, restricting it to the blocklisted address space of 899,000 /24 prefixes. During this period, the crawler sent 1.6 billion bt_ping messages and received 779 million responses (a 48.6% response rate). The crawler identified 48.7 million unique IP addresses using BitTorrent, belonging to 203 million unique node IDs. Among the discovered BitTorrent IP addresses, 2 million were NATed, with 29,700 being blocklisted. This overlap aligns with previous work [31] that finds devices using P2P are likely to be compromised.

Using the 311,000 RIPE addresses from Section 3.2, we converted them into 90,500 /24 RIPE prefixes. About 53,700 blocklisted addresses were in RIPE prefixes. The overlap with RIPE prefixes decreased as we applied our technique. By eliminating all probes that change addresses across multiple ASes, the number of blocklisted addresses reduced to 34,400. Considering probes with at least eight address changes, the number further reduced to 33,100. Finally, after considering probes that change their addresses daily, we had 22,700 blocklisted addresses that were dynamically allocated.

### Feasibility of Reused Address Discovery

To determine the feasibility of our techniques, we estimated the overlap between the address spaces where BitTorrent or RIPE addresses are present and the address spaces where blocklisted addresses are present (Figure 3). The ASes in Figure 3 are arranged in increasing order of the number of blocklisted addresses. Blocklisted addresses are present in about 26,000 autonomous systems, so the curve for blocklisted addresses reaches up to 1. Blocklisted addresses using BitTorrent are present in 7,700 (or 29.6%) ASes, and blocklisted addresses among RIPE prefixes are present in 1,900 (or 17.1%) ASes. Since our techniques do not cover the entire blocklisted addresses, the curves for blocklisted RIPE and BitTorrent addresses plateau at 7,700 and 1,100 ASes, respectively. Our technique has significant coverage in the ten most blocklisted ASes, contributing to 606,000 (or 27.7%) of all blocklisted addresses. Among these addresses, 38,000 (6.4%) use BitTorrent and 4,400 (0.7%) are among RIPE prefixes. AS4134, belonging to China Telecom Backbone, has the highest number of blocklisted addresses (202,000 or 9%). Among the blocklisted addresses from AS4134, about 3% (or 6,200) use BitTorrent and 0.4% (or 817) are in RIPE prefixes.

### Analysis of Unjust Blocking

In this section, we estimate the potential extent of unjust blocking caused by blocklisting reused addresses. Although we identified only 29,700 blocklisted NATed addresses and 22,700 blocklisted dynamic addresses, we observed that reused addresses are present in many blocklists (up to 60%). Blocklisting reused addresses can have serious impacts on users. Blocklisting NATed addresses can lead to unjust blocking of multiple users sharing the same IP address, and dynamically allocated addresses can lead to unjust blocking of a user newly allocated a previously blocklisted address.

We found that a reused address can be present in blocklists for up to 44 days and can potentially block as many as 78 users. Reused addresses are present in many blocklists (Figures 5 and 6). There are 61 blocklists (40% of all blocklists) that do not list any NATed addresses and 72 blocklists (47% of all blocklists) that do not list any dynamic addresses. We discovered 45,100 listings that include 29,700 IP addresses that are NATed and 30,600 listings that include 22,700 IP addresses that are dynamic. On average, a blocklist lists 501 NATed IP addresses and 387 dynamic addresses. Our techniques for reused address detection are not perfect, so blocklists that do not show any reused addresses may still contain reused addresses that our techniques did not identify.

Some blocklists list more reused addresses than others. The top 10 blocklists contribute 65.9% of all listings of NATed addresses and 72.6% of all listings of dynamic addresses. This is expected, as the top 10 blocklists among NATed and dynamic addresses contribute to 53.4% and 70.3% of all blocklisted addresses. The three highest presences of NATed addresses are from spam or reputation blocklists—Stopforumspam, Nixspam, and Alienvault—listing about 3,300-8,600 (or 0.01%-0.03% of blocklists) such IP addresses. Similarly, the three highest presences of dynamic addresses are from Stopforumspam, Nixspam, and Bad IPs, primarily used to mitigate spam and identify IP addresses with a poor reputation. These blocklists list about 2,600-5,900 (or 0.01%-0.02% of blocklists) dynamic addresses.

Most reused addresses are removed quickly (Figure 7). On average, blocklisted addresses are removed within nine days, NATed IP addresses within ten days, and dynamic addresses within three days. Compared to all blocklisted addresses, reused addresses are removed much faster, and among reused addresses, dynamic addresses are removed faster than NATed IP addresses. Within two days, 77.5% of all dynamic addresses are removed from blocklists, compared to only 60% of NATed IP addresses. On the other hand, only 42% of all blocklisted IP addresses are removed in two days. In the worst case, reused addresses are present in blocklists for the entire monitoring period of 44 days.

Blocklisting NATed addresses impacts many users. The BitTorrent crawler described in Section 3.1 helps us quantify the lower bound of active users using the same IP address that would be affected by blocklisting. Figure 8 shows the CDF of NATed blocklisted addresses and the lower bound of affected users. For most of these IP addresses, we detect only two active users (68.5%). 97.8% of the IP addresses have fewer than ten active users. The remaining 2.2% of the IP addresses are shared by many more users. At the maximum, we detect 78 active users behind an IP address.

### Exploring Other Techniques

As discussed in Section 2, there are other techniques that can be explored to further enhance our detection and analysis of reused addresses.