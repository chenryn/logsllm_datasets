tially, we did not restrict our BitTorrent crawler. However, the ping
replies generated tremendous amount of incoming traffic that was
undesirable to our network administrators. Therefore, to minimize
the disturbance to users we probe and reduce burden on our net-
work due to ping replies, the crawler is rate-limited and restricted
only to address spaces where blocklists are present (Section 4). How-
ever, we could reduce this burden and have a faster coverage by
having the crawler at multiple vantage points in different networks.
Limitations: Our crawler can only detect NATed addresses that
have more than one BitTorrent user. Our NAT detection technique
is certainly biased towards BitTorrent users. We will miss the NATs
in networks where BitTorrent is not popular, or where BitTorrent
362
traffic is filtered. Moreover, we can only detect the NATed addresses
that are reused by more than one user using BitTorrent at the same
time. We are thus likely to grossly underestimate the number of
users behind a NAT.
3.2 Identifying Dynamic Addresses
The RIPE NCC’s Atlas project deploys custom devices that conduct
various measurement tasks. Every RIPE Atlas probe connects to a
central infrastructure to get instructions on new measurement tasks
and to update measurement data. All measurements are logged to
include the unique probe ID and the IP address through which
the measurement was made. Probes are usually deployed within
the customer premises equipment (CPE) of the user. We use the
measurement logs to infer the dynamics of IP address allocation
in the covering /24 address prefix. We identify three properties of
measurement logs that help us to find dynamic addresses.
1) Dynamic addressing observed over time: We observe
RIPE Atlas probe measurement logs for 16 months to determine
dynamic addressing. Observing logs for a long duration allows us
to understand the frequency of IP address reallocation in probes.
2) Frequency of IP address change: We consider probes that
have gone through multiple IP address allocations within the same
AS during the monitoring period, to eliminate probes that ex-
perienced IP address changes rarely and to remove probes that
have changed locations. Among the remaining probes, we consider
probes whose average duration between every IP address change is
within 1 day. This helps to estimate the risk involved in blocklisting
these IP addresses, since blocklisting may be effective only for one
day, and will lead to unjust blocking afterward.
3) Extent of dynamic addressing: If we detect that an IP ad-
dress is dynamic, according to the criteria we described above, we
consider that the entire /24 prefix covering this IP address is dy-
namically allocated. Usually, IP address reallocation occurs from
a pool of IP addresses. It is hard to determine this address pool,
and network operators do not make such information public. A
conservative approach is to consider the entire /24 prefix as dy-
namic as contiguous addresses are usually administered together
CrawlerPort: 2215,12281Port: 155,1821Port: 6681IP 1IP 2IP 3CrawlerPort: 2215,12281Port: 155,1821Port: 6681IP 1IP 2IP 32xbt_ping2xbt_pingCrawlerPort: 2215,12281Port: 155,1821Port: 6681IP 1IP 2IP 31xreply2xreplyCrawlerPort: 2215,12281Port: 155,1821Port: 6681IP 1IP 2IP 3NATIMC ’20, October 27–29, 2020, Virtual Event, USA
Ramanathan et al.
Figure 2: IP addresses allocated to RIPE Atlas probes.
Figure 3: CDF of blocklisted and reused addresses from each
AS.
and /24 prefixes have been previously used to identify network
characteristics [19, 28, 29, 40, 61].
We use RIPE Atlas connection logs from 1 Jan 2019 to 11 May
2020. In this period, we observe over 15,703 RIPE Atlas probes that
were allocated 311K IP addresses (referred to as RIPE addresses).
About 13.1% (or 2K) of probes go through address changes but have
addresses allocated across multiple autonomous systems. Figure 2
shows the remaining 13.6K probes and the number of addresses
allocated to them. The majority of the probes (59% or 9.3K) did not
go through any IP address change in this period and the remaining
27% (or 4.2K) of probes go through multiple address changes. We
determine probes that change IP addresses more frequently than
others by obtaining the knee point of this graph. The knee point
indicates the number of IP address reallocation required to differen-
tiate probes that change IP address more frequently when compared
to remaining probes. We use a technique proposed by Satopää et
al. [63] to determine the knee point to be at eight addresses.
This leaves us with 16.6% (2.6K) of the probes that have at least
eight IP address allocations during our monitoring period, and
where all reallocated IP addresses belong to the same autonomous
system. These 2.6K probes cover a total of 204K IP addresses, with
an average of 78 IP addresses allocated to each probe. In other
words, 16.6% of all RIPE Atlas probes contributed to 65.5% of all
IP addresses allocated to all RIPE Atlas probes. As a final step to
consider probes that regularly change addresses within one day,
we end up with 4% (629) of probes that are in dynamically allocated
address spaces. We only consider probes that change IP addresses
daily, since these probes are more likely to cause unjust blocking
than probes that rarely change addresses.
Limitations: Our detection of dynamic addresses is limited only
to IP prefixes that deploy a RIPE Atlas probe. RIPE Atlas probes are
predominantly present only in Europe and North America. There-
fore, our insights on dynamic address detection are limited to these
regions. Another limitation is that our detection technique involves
choosing RIPE probes that have been allocated IP addresses from
the same autonomous system. However, ISPs may own several
autonomous systems and can allocate addresses from multiple au-
tonomous systems. Even within the IP address spaces covered by
RIPE Atlas probes, our technique only presents a lower-bound of
Figure 4: Detecting NATed and dynamic addresses.
prefixes that are dynamically allocated. For probes that change
their IP addresses frequently, we consider the entire /24 prefix to
be potentially dynamically allocated. However, we may incorrectly
gauge these boundaries. Network operators may deploy dynamic
addressing within larger prefixes, leading us to underestimate the
extent of unjust blocking. In some cases, they may deploy dynamic
addressing within smaller prefixes, thereby overcounting the num-
ber of dynamic addresses. Estimating boundaries is difficult because
ISPs have their own private policies for dynamic addressing. This
issue is noted in previous studies as well [40, 61, 78].
4 DETECTION
Blocklists typically list IP addresses that have sent spam, DDoS
attacks, dictionary attacks, or malicious scans. To quantify unjust
blocking by blocklists, we use 151 IPv4 public blocklists shown
in Table 2 in the Appendix B taken from the BLAG dataset [60].
These lists are actively maintained and they monitor a variety of
malicious activities including Spam, DDoS, malware hosting or
general reputation of IP addresses. This dataset includes popular
lists like DShield [43], NixSpam [57], Spamhaus [4], Alienvault [2]
and Abuse.ch [1]. We collect blocklist data for 83 days over two
measurement periods from 03 Aug 2019 to 10 Sep 2019 (39 days)
and 29 Mar 2020 to 11 May 2020 (44 days). During our measure-
ment periods, we observed 2.2M IP addresses and each blocklist,
on average, has 30K IP addresses.
Figure 4 shows the number of reused addresses discovered by
our techniques. We ran our BitTorrent crawler at the same time
363
02k4k6k8k10k12k1101001000thresholdRIPE atlas probes(#) of allocated addresses110100100010k100k0.0010.010.11blocklisted addressesblocklisted BitTorrent addressesblocklisted RIPE addresses(#) of ASesCDFProbes withaddress changesin same AS(34.4K)Probes withfrequent addresschanges(33.1K)Probes thatchange addressdaily(22.7K)BitTorrentIPs(48.7M)NATed IPs(2M)NATed +blocklistedIPs(29.7K)NATed addressesDynamic addresses Blocklistedaddresses inRIPE preﬁxes(53.7K)Quantifying the Impact of Blocklisting in the Age of Address Reuse
IMC ’20, October 27–29, 2020, Virtual Event, USA
Figure 5: NATed addresses in blocklists.
Figure 6: Dynamic addresses in block-
lists.
Figure 7: Duration distribution of reused
addresses.
as the blocklist collection period. To prevent unnecessary probing,
we restrict the crawler to the blocklisted address space of 899K
/24 prefixes (as discussed in Section 3.1). During this period, the
crawler sent 1.6 billion bt_ping messages and received 779M re-
sponses (48.6% response rate). The crawler identified a total of
48.7M unique IP addresses that use BitTorrent, belonging to 203M
unique node_id’s. Among the discovered BitTorrent IP addresses,
2M are NATed; out of these, 29.7K are blocklisted. This overlap of
blocklisted addresses with BitTorrent addresses is in agreement
with previous work [31] that find devices using P2P are likely to
be compromised. We use the 311K RIPE addresses obtained from
Section 3.2, and convert them into 90.5K /24 RIPE prefixes. About
53.7K blocklisted addresses are in RIPE prefixes. The overlap with
RIPE prefixes decreases as we apply our technique. At first, by elim-
inating all probes that change addresses across multiple ASes, the
number of blocklisted addresses reduces to 34.4K. While consider-
ing probes that have at least eight address changes, the number of
blocklisted addresses further reduces to 33.1K. Finally, after con-
sidering probes that change their addresses daily, we have 22.7K
blocklisted addresses that are dynamically allocated.
To determine the feasibility of our techniques to discover reused
addresses, we estimate (shown in Figure 3) the extent of overlap
between the address spaces where BitTorrent or RIPE addresses
are present and the address spaces where blocklisted addresses are
present. The ASes in Figure 3 are arranged in increasing order of
the number of blocklisted addresses present in them. Blocklisted ad-
dresses are present in about 26K autonomous systems, therefore, the
curve for blocklisted addresses reaches upto 1. Blocklisted addresses
using BitTorrent are present in 7.7K (or 29.6%) ASes and blocklisted
addresses among RIPE prefixes are present in 1.9K (or 17.1%) ASes.
Since our techniques do not cover the entire blocklisted addresses,
the curves for blocklisted RIPE and BitTorrent addresses plateau
at 7.7K and 1.1 ASes respectively. Our technique has significant
coverage in the ten most blocklisted ASes. These ASes contribute to
606K (or 27.7%) of all blocklisted addresses. Among these addresses,
38K (6.4%) use BitTorrent and 4.4K (0.7%) are among RIPE prefixes.
AS4134, belonging to China Telecom Backbone, has the highest
number of blocklisted addresses (202K or 9%). Among the block-
listed addresses from AS4134, about 3% (or 6.2K) use BitTorrent and
0.4% (or 817) are in RIPE prefixes.
5 ANALYSIS
In this section, we estimate the potential extent of unjust blocking
caused by blocklisting reused addresses. Although we identify only
29.7K blocklisted NATed addresses and 22.7K blocklisted dynamic
addresses, we observe that reused addresses are present in many
blocklists (up to 60%). Blocklisting reused addresses can have se-
rious impact on users. Blocklisting NATed addresses can lead to
unjust blocking of multiple users having the same IP address and
dynamically allocated addresses can lead to unjust blocking of a
user that has been newly allocated a previously blocklisted address.
We find that a reused address can be present in blocklists for as
many as 44 days and can potentially block as many as 78 users.
Reused addresses are present in many blocklists: Figure 5
and Figure 6 shows blocklists that list reused addresses. There
are 61 blocklists (40% of all blocklists) that do not list any NATed
addresses and 72 blocklists (47% of all blocklists) that do not list any
dynamic addresses. We discover 45.1K listings2 that include 29.7K
IP addresses that are NATed. We also discover 30.6K listings that
include 22.7K IP addresses that are dynamic addresses. On average,
a blocklist lists 501 NATed IP addresses and 387 dynamic addresses.
Our techniques of reused address detection is not perfect, therefore,
blocklists that do not show any reused addresses can contain reused
addresses but are not identified by our techniques.
Some blocklists list more reused addresses than others:
The top 10 blocklists contribute 65.9% of all listings of NATed
addresses and 72.6% of all listings of dynamic addresses. This is
expected, as the top 10 blocklists among NATed and dynamic ad-
dresses contribute to 53.4% and 70.3% of all blocklisted addresses.
The three highest presence of NATed addresses are from spam or
reputation blocklists – Stopforumspam, Nixspam and Alienvault
listing about 3.3K-8.6K (or 0.01%–0.03% of blocklists) such IP ad-
dresses. Similarly, the three highest presence of dynamic addresses
are from Stopforumspam, Nixspam and Bad IPs, primarily used to
2An IP address can be present in different blocklists, therefore the number of listings
need not be equal to the number of reused IP addresses.
364
102030405060708090110100100010k(#) of blocklistslog(#)10203040506070110100100010kRIPECai et al.(#) of blocklistslog(#)01020304000.20.40.60.81NATed addressesblocklisted addressesdynamic addresses(#) of days in blocklistsCDF of IP addressesIMC ’20, October 27–29, 2020, Virtual Event, USA
Ramanathan et al.
Blocklist
usage
Active
defense
Issues
Question
External blocklists
Paid-for blocklists
Response
85%
Avg:2
Max:39
Avg:10
Public blocklists
Max:68
Directly block IPs
59%
Threat intelligence system 35%
Dynamic addressing*
76%
56%
Carrier-grade NATs*
Table 1: Summary of survey responses on usage of blocklists.
Questions in (*) were only taken by 34 out of 65 respondants.
Figure 8: Number of users behind NATed addresses in block-
lists.
mitigate spam and identify IP addresses with a poor reputation.
These blocklists list about 2.6K–5.9K (or 0.01%–0.02% of blocklists)
dynamic addresses.
Most reused addresses are removed quickly: Figure 7 shows
the CDF of all blocklisted addresses, blocklisted NATed/dynamic
addresses and the duration in days that they were present in a
blocklist. On average, blocklisted addresses are removed within
nine days, NATed IP addresses are removed within ten days, and
dynamic addresses are removed within three days from blocklists.
Compared to all blocklisted addresses, reused addresses are removed
much faster and among reused addresses, dynamic addresses are
removed faster than NATed IP addresses. Within two days, 77.5%
of all dynamic addresses are removed from blocklists, compared to
only 60% of NATed IP addresses. On the other hand, only 42% of all
blocklisted IP addresses are removed in two days. In the worst case,
reused addresses are present in blocklists for the entire monitoring
period of 44 days.
Blocklisting NATed addresses impact many users: The Bit-
Torrent crawler described in Section 3.1, helps us quantify the lower
bound of active users using the same IP address that would be af-
fected by blocklisting. Figure 8 shows the CDF of NATed blocklisted
addresses and the lower bound of affected users. For most of these
IP addresses, we detect only two active users (68.5%). 97.8% of the IP
addresses have fewer than ten active users. The remaining 2.2% of
the IP addresses are shared by many more users. At the maximum,
we detect 78 active users behind an IP address.
Exploring other techniques: As discussed in Section 2, there