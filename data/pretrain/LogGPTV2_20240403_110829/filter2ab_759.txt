titleblackhat:asia-22 DroidGuard: A Deep Dive into SafetyNet
SafetyNet is the Android component developed by Google to verify the devices' integrity. These checksare used by the developers to prevent running applications on devices that would not meet security requirements but it is also used by Google to prevent bots, fraud and abuse.In 2017, Collin Mulliner & John Kozyrakis made one of the first public presentations about SafetyNet anda glimpse into the internal mechanisms. Since then, the Google anti-abuse team improved the strength ofthe solution which moved most of the original Java layer of SafetyNet, into a native module called DroidGuard. This module implements a custom virtual machine that runs a proprietary bytecode provided byGoogle to perform the devices' integrity checks.The purpose of this talk is to make a state-of-the-art of the current implementation of SafetyNet. Inparticular, we aim at presenting the internal mechanisms behind SafetyNet and the DroidGuard module.This includes an overview of the VM design, its internal mechanisms, and we will introduce the securitychecks performed by SafetyNet to detect Magisk, emulators, rooted devices, and even Pegasus.