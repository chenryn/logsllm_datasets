### 7. 安全问题
本章将介绍如何解决安全问题，涵盖以下主题：
- 忘记本地恢复用户或主管用户的密码
- 无法信任SSL证书
- 服务器认证验证失败
- Samba和Apache漏洞

#### 7.1 忘记本地恢复用户或主管用户的密码
如果无法通过其他管理员账户登录系统，或者没有其他管理员账户，用户可以通过安装包含新密码配置文件的ISO镜像来重置具有`lxc-recovery`或`lxc-supervisor`权限的本地用户密码。以下是具体步骤：

**前提条件：**
- 用户必须能够访问系统主机。
- 要重置的用户名必须拥有`lxc-recovery`或`lxc-supervisor`权限。
- 新密码需遵循系统的密码策略。

**操作步骤：**
1. 关闭虚拟机电源。
2. 使用`echo`命令创建一个名为`passwordreset.properties`的配置文件。
   ```bash
   echo com.lenovo.lxca.passwordreset/passwordreset.user=admin > ./passwordreset.properties
   echo com.lenovo.lxca.passwordreset/passwordreset.password=New_Passw0rd >> ./passwordreset.properties
   ```
3. 创建一个包含上述配置文件的ISO镜像。
   - 在Windows系统中，使用常见的ISO制作软件。
   - 在Linux系统中，执行以下命令：
     ```bash
     mkisofs -V passreset -J -o ./passreset.iso ./passwordreset.properties
     ```
4. 使用数据存储浏览器将该ISO镜像上传到目标位置。
5. 将ISO镜像挂载到RedHat虚拟机。
   a. 在虚拟机管理器中选择虚拟机并点击“添加新硬件”。
   b. 选择“存储”选项卡。
   c. 选择受管存储或其他现有存储，并选择`passreset.iso`镜像。
   d. 设备类型选择“VirtIO”。对于PIM V1.4.0或更低版本，请设置磁盘总线为“IDE”。
   e. 配置缓存模式为“无”。
   f. 点击“完成”。

#### 7.2 无法信任 SSL 证书
证书链可能包含自签名证书或非由已知CA签发的证书。每个系统实例都有一个内部生成的CA，默认情况下用于用户与虚拟设备间通信的端口（如443, 3888, 9090, 50636, 50637）均使用该CA签发的证书。若系统不信任SSL证书，建议生成并部署定制的外部签名服务器证书。

在操作系统部署过程中，系统会将该CA证书添加至推送到目标服务器的操作系统镜像中。目标服务器会在连接端口3001和8443时验证这些端口提供的证书。

#### 7.3 服务器认证验证失败
当系统尝试执行某些操作时，可能会遇到服务器认证验证失败的问题，例如：
- 通过HTTPS以CIM-XML协议连接到受管设备。
- 使用安全LDAP连接到外部身份验证服务器（如果已配置）。
- 与外部SAML身份提供商建立安全连接（如果已配置）。
- 连接到远程文件服务器以导入操作系统镜像（如果已配置HTTPS镜像服务）。
- 查询联想以获取保修状态信息。

**解决措施：**
- 确保系统信任库中的证书或其签名证书有效。
- 检查证书是否被撤销。
- 核实服务器的IP地址或主机名与证书中的通用名或备用名称相匹配。
- 确认当前日期位于证书的有效期内。
- 保证证书使用SHA1或SHA256算法签名；对于Legacy或NIST严格模式，需要更复杂的算法。

#### 7.4 Samba 和 Apache 漏洞
系统在部署操作系统及更新驱动程序时，会用到Samba和Apache服务器作为只读远程共享。如果不使用系统管理操作系统，可以将网络角色设为“仅发现和管理硬件”，从而禁用这两个服务。

**禁用步骤：**
1. 在主界面点击[管理/网络访问权限]查看当前网络设置。
2. 单击“编辑网络访问权限”，弹出相应页面。
3. 在“IP设置”标签页下，将网络接口配置为“仅发现和管理硬件”。
4. 保存更改后退出。

---

以上是针对常见安全问题的解决方案概述。对于具体的实施细节和技术支持，请参考官方文档或联系技术支持团队。