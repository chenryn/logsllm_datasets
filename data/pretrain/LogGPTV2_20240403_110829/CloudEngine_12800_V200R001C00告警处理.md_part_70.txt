际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority、undo stp [ instance instance-id ] root将桥优先级还原成缺省值。查看
告警是否消除。如果未消除，请执行步骤3。
c. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.16 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.21
hwMstpProNewPortRootGuarded
Trap Buffer 信息解释
The root protection port of the instance of the MSTP process received a superior message.
(ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2],
PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag], PortState=[PortState],
IfIndex=[IfIndex], PortName=[PortName], PwName=[PwName])
MSTP进程实例中启用了根保护功能的端口上收到了较优的消息。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
文档版本 06 (2017-09-12) 华为专有和保密信息 558
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
Trap属性 描述
Mnemonic Code hwMstpProNewPortRootGuarded
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.21
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
PwName PW名称。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProNewPortState hwMstpProNewPortState
29.1.1
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpPwName hwMstpPwName
33
1.3.6.1.2.1.31.1.1.1.1 ifName ifName
文档版本 06 (2017-09-12) 华为专有和保密信息 559
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
对系统的影响
网络实际拓扑可能与组网预期不一致。
可能原因
原因1：The port enabled with the root protection function received BPDUs of a higher
priority than that of the bridge.（配置了根保护的指定端口收到了比本桥优先级高的
BPDU报文。）
原因2：The priority of some switch changed in the network.（网络拓扑有交换机优先级发
生变化。）
处理步骤
l 原因1：The port enabled with the root protection function received BPDUs of a higher
priority than that of the bridge.
a. 请检查新加入的物理链路是否是需要的物理链路。
n 如果新加入的物理链路是需要的物理链路，则请执行步骤2。
n 如果新加入的物理链路不是需要的物理链路，则请执行步骤3。
b. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看各个端口是否符合协议计算结
果。
n 如果各个端口符合协议计算结果，则无需处理。
n 如果各个端口不符合协议计算结果，则请执行步骤4。
c. 请正确部署网络拓扑，查看告警是否消除。如果未消除，则请执行步骤4。
d. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number | slot slot-id ] [ brief ]查看网络中是否有端口被
规划为根保护端口。
n 如果有端口被规划为根保护端口，则请执行步骤5。
n 如果没有端口被规划为根保护端口，则请执行步骤6。
e. 在接口视图下，执行命令undo stp root-protection去除根保护配置，查看告警
是否消除。如果未消除，则请执行步骤6。
f. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：The priority of some switch changed in the network.
a. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络拓扑中优先级的更改操作是
否是正常操作。
n 如果是正常操作，则请执行步骤3。
n 如果不是正常操作，则请执行步骤2。
b. 请在系统视图下执行命令stp [ instance instance-id ] priority priority，根据实
际需要重新配置本桥的优先级。或者执行命令undo stp [ instance instance-id ]
priority、undo stp [ instance instance-id ] root将桥优先级还原成缺省值。查看
告警是否消除。如果告警未消除，则请执行步骤3。
c. 执行命令display stp [ process process-id ] [ instance instance-id ] [ interface
interface-type interface-number ] [ brief ]查看网络中是否有端口被规划为根保
护端口。
文档版本 06 (2017-09-12) 华为专有和保密信息 560
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
n 如果有端口被规划为根保护端口，则请执行步骤4。
n 如果没有端口被规划为根保护端口，则请执行步骤5。
d. 在接口视图下，执行命令undo stp root-protection去除根保护配置，查看告警
是否消除。如果未消除，则请执行步骤5。
e. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.17 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.22
hwMstpProNewPortBpduGuarded
Trap Buffer 信息解释
The MSTP process's edge port with BPDU protection enabled will be shut down, because it
received a BPDU packet. (ProcessID=[ProcessID], InstanceID=[InstanceID],
PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4],
PortIDFlag=[PortIDFlag], PortState=[PortState], IfIndex=[IfIndex], PortName=[PortName])
MSTP进程启用了BPDU保护功能的边缘端口上收到了BPDU报文，将被shutdown。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewPortBpduGuarded
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.22
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
文档版本 06 (2017-09-12) 华为专有和保密信息 561
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
参数名称 参数含义
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
PortState 端口状态。
PortName 端口名称。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProNewPortState hwMstpProNewPortState
29.1.1
1.3.6.1.2.1.31.1.1.1.1 ifName ifName
对系统的影响
与该端口相连的用户网络中断。
可能原因
原因1：The edge port received BPDUs, and BPDU protection was enabled globally.（边缘
端口收到了BPDU报文，且全局使能了BPDU保护。）
处理步骤
l 原因1：The edge port received BPDUs, and BPDU protection was enabled globally.
a. 请查看端口是否应该被规划为边缘端口。
n 如果应该被规划为边缘端口，则请执行步骤2。
n 如果不应该被规划为边缘端口，则请执行步骤3。
b. 请检查端口上BPDU报文的来源，确认是否有恶意攻击。
n 如果有恶意攻击，则请执行步骤4。
n 如果没有恶意攻击，则请执行步骤3。
c. 在接口视图下，执行命令undo stp root-protection和undo shutdown去除边缘
端口配置，重新启用端口。查看告警是否消除。如果告警未消除，则请执行
步骤4。
d. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
文档版本 06 (2017-09-12) 华为专有和保密信息 562
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
37.18 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.23
hwMstpProNewPortLoopGuarded
Trap Buffer 信息解释
The loop protection port in the instance of the MSTP process did not receive BPDU packets
within prescriptive time. (ProcessID=[ProcessID], InstanceID=[InstanceID],
PortID1=[PortID1], PortID2=[PortID2], PortID3=[PortID3], PortID4=[PortID4],
PortIDFlag=[PortIDFlag], PortState=[PortState], IfIndex=[IfIndex], PortName=[PortName],
PwName=[PwName])
MSTP进程实例中启用了环路保护的端口在规定时间内没有收到BPDU报文。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewPortLoopGuarded
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.23
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
IfIndex 端口索引。
文档版本 06 (2017-09-12) 华为专有和保密信息 563
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
参数名称 参数含义
PortState 端口状态。
PortName 端口名称。
PwName PW名称。
VB 信息参数
VB OID VB Name VB Index
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpProNewPortState hwMstpProNewPortState
29.1.1
1.3.6.1.4.1.2011.5.25.42.4.1. hwMstpPwName hwMstpPwName
33
1.3.6.1.2.1.31.1.1.1.1 ifName ifName
对系统的影响
该端口不再转发数据。
可能原因
原因1：The spanning tree function was disabled on the peer device.（对端设备的生成树功
能被关闭。）
原因2：The links connected to the peer were congested.（与对端相连的网络链路拥塞。）
处理步骤
l 原因1：The spanning tree function was disabled on the peer device.
a. 请在相邻设备上执行命令display stp [ process process-id ] [ instance instance-
id ] [ interface interface-type interface-number | slot slot-id ] [ brief ]，检查相邻
设备端口上STP功能是否关闭。
n 如果相邻设备端口上STP功能关闭，则请执行步骤2。
n 如果相邻设备端口上STP功能未关闭，则请执行步骤3。
b. 请在接口视图下执行命令stp enable，使能STP功能，查看告警是否消除。如
果未消除，则请执行步骤3。
c. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
l 原因2：The links connected to the peer were congested.
a. 请检查本设备与相邻设备间的链路是否有链路拥塞。
n 如果拥塞，则请执行步骤2。
n 如果未拥塞，则请执行步骤3。
b. 请正确修复设备间的链路，查看告警是否消除。如果未消除，则请执行步骤
3。
文档版本 06 (2017-09-12) 华为专有和保密信息 564
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
c. 请收集告警信息、日志信息和配置信息，并联系技术支持人员。
----结束
37.19 MSTP_1.3.6.1.4.1.2011.5.25.42.4.2.24
hwMstpProNewEdgePortChanged
Trap Buffer 信息解释
After the edge port receives a BPDU packet, the port is no longer an edge port.
(ProcessID=[ProcessID], InstanceID=[InstanceID], PortID1=[PortID1], PortID2=[PortID2],
PortID3=[PortID3], PortID4=[PortID4], PortIDFlag=[PortIDFlag], PortState=[PortState],
IfIndex=[IfIndex], PortName=[PortName], PwName=[PwName])
边缘端口收到BPDU报文后将失去边缘端口属性。
Trap 属性
Trap属性 描述
Alarm or Event Event
Trap Severity Warning
Mnemonic Code hwMstpProNewEdgePortChanged
Trap OID 1.3.6.1.4.1.2011.5.25.42.4.2.24
Alarm ID 该Trap是事件Trap，不涉及告警ID。
Alarm Type 该Trap是事件Trap，不涉及告警类型。
Raise or Clear 该Trap是事件Trap，不涉及告警产生或恢复。
Match trap 该Trap是事件Trap，不涉及配对Trap。
Trap Buffer 信息参数
参数名称 参数含义
ProcessID MSTP进程ID。
InstanceID 实例ID。
PortID1 MSTP进程内端口ID1。
PortID2 MSTP进程内端口ID2。
PortID3 MSTP进程内端口ID3。
PortID4 MSTP进程内端口ID4。
PortIDFlag 端口标志位。
文档版本 06 (2017-09-12) 华为专有和保密信息 565
版权所有 © 华为技术有限公司
CloudEngine 12800系列交换机
告警处理 37 MSTP
参数名称 参数含义
IfIndex 端口索引。
PortState 端口状态。