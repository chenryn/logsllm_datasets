ğ‘š was the original commitment to âŠ¥ (tracked
by the oracle). By the hiding properties of the commitment,
this is indistinguishable to an efficient adversary.
G4: Game 4 is identical to Game 3, but during goodSend, ğ‘’ is
encrypted as (ğ‘š0,âŠ¥, ğ‘â€²
ğ‘š0, ğ‘Ÿ) rather than (ğ‘š0, fd, ğ‘âŠ¥, ğ‘Ÿ). This
is indistinguishable to an efficient adversary because of the
authenticated encryption properties of E.
The messages and associated data of Game 4 are all identically
distributed to authored messages. We now show that message con-
tents are hidden from the adversary as well.
G5:
In this game, modify Game 4 so that when messages are sent
via goodSend, the associated message identifier corresponds
to an encryption of (ğ‘š1,âŠ¥, ğ‘ğ‘š1, ğ‘Ÿ) and the commitment is
still the original commitment to ğ‘š0. The oracle keeps a ta-
ble of the corresponding (ğ‘š0,âŠ¥, ğ‘ğ‘š0, ğ‘Ÿ) that should have
been sent and evaluates the results based on that value. By
the authenticated encryption properties of E, this is indis-
tinguishable from Game 4 because all that changes is the
decryption of ğ‘’.
In this game, we switch the commitment sent in the clear,
ğ‘ğ‘š0, to instead be ğ‘ğ‘š1, the commitment contained in ğ‘’ that
commits to ğ‘š1. The message is evaluated in the standard
way using the decryption of ğ‘’. This is indistinguishable from
Game 5 by the hiding properties of the commitment.
G6:
We now note that applying the same game hops 1 - 4 starting
from the game where ğ‘ = 1 instead of 0 are each indistinguishable
by the same arguments, and result in a game identically distributed
to Game 6. Therefore we have shown that both ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ 1
ğ‘†ğ‘‡ ,E and
ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ 0
ğ‘†ğ‘‡ ,E are indistinguishable from Game 7 to an efficient ad-
versary, and so they are also indistinguishable from each other.
This means an efficient adversary can gain at most negligible
advantage in the PCONF game, and so Scheme 1 satisfies platform
confidentiality.
â–¡
B.2 Accountability â€“ Proof of Theorem 4.2
Proof. Suppose for purposes of contradiction we have an ad-
versary that can win the ğ‘ ğ‘Ÿğ‘ğµğ¼ ğ‘ ğ· game against Scheme 1 with
non-negligible probability. This means that an honest user suc-
cessfully received a message, but then the report of that message
failed.
First, we consider the conditions that would cause a report to
fail, and then show that each can happen with only negligible
probability assuming that the receipt was successful:
(1) The opening for the provided commitment was invalid.
This is checked by the receive protocol, and the protocol fails
if the opening is invalid, so this will happen with probability
zero on a message that was received successfully.
(2) The signature verification on the source and commitment
fails.
This exact check is also performed by the receive protocol,
so again there is zero probability that this check will fail on
a report of a validly received message.
(3) The decryption of the source ciphertext fails.
By definition of the scheme, the platform only ever signs
ciphertexts that it created, and can therefore be sure of their
validity. Therefore, the probability that this occurs is upper
bounded by the probability that an adversary could create a
valid signature without the keys of the platform. By the un-
forgeability properties of the signature scheme, this happens
with at most negligible probability.
We therefore conclude that the scheme satisfies accountability
because if a message is received successfully, all three possibilities
for a report failure happen with negligible probability.
â–¡
B.3 Unforgeability â€“ Proof of Theorem 4.3
Proof. First, we remind ourselves of the conditions that must
be met for an adversary to win the ğ‘¢ğ‘›ğ¹ğ‘‚ğ‘…ğºğ¸ game. After sending
some amount of messages between honest and malicious users,
the adversary must present forwarding data (ğœ, ğ‘ ğ‘Ÿğ‘, ğ‘ğ‘š, ğ‘Ÿ) and a
message ğ‘š to the platform such that:
(1) ğ‘ğ‘š is a valid commitment with opening (ğ‘š, ğ‘Ÿ)
(2) ğœ is a valid signature on ğ‘ ğ‘Ÿğ‘ and ğ‘ğ‘š
(3) ğ‘ ğ‘Ÿğ‘ decrypts to an honest user ğ‘ˆ and metadata md such that
ğ‘ˆ never sent ğ‘š with metadata md during the adversaryâ€™s
initial queries.
We show that the probability an adversary can construct such
an output is negligible via a series of hybrid games.
G0: This is identical to the original ğ‘¢ğ‘›ğ¹ğ‘‚ğ‘…ğºğ¸ game.
G1: We modify G0 to abort immediately and return 0 if ğœ was not
created by the platform oracle during the query portion of the
game. By the unforgeability of the signature, the probability
that the adversary can create a new valid signature without
the platformâ€™s secret keys is negligible, and so this game is
indistinguishable from G0 to efficient adversaries.
G2: Suppose that the ğ‘ ğ‘Ÿğ‘ value decrypts to ğ‘ˆ , md. We modify
G1 to abort immediately if ğ‘ˆ did not send some message ğ‘šâ€²
with commitment ğ‘ğ‘š and metadata md. By definition of the
scheme, the platform would only create a valid signature
linking ğ‘ˆ and md to the commitment ğ‘ğ‘š that ğ‘ˆ provided.
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1501By G1, the signature must have been created by the platform,
so this additional condition happens with zero probability,
and we conclude G2 is indistinguishable from G1.
G3: We modify G2 to immediately abort if ğ‘š was not the plaintext
of the message sent when ğ‘ˆ sent ğ‘ğ‘š and md. This can only
happen if an adversary can find a second opening (ğ‘šâ€², ğ‘Ÿâ€²)
for ğ‘ğ‘š that is different from the original opening created by
ğ‘ˆ . By the binding property of the commitment scheme, this
can happen with only negligible probability, and so G3 is
indistinguishable from G2 to an efficient adversary.
In a series of three hops, we have reached a game where if the
first two requirements described above are met and the ğ‘ˆ revealed
is honest, then ğ‘ˆ must have sent ğ‘š with metadata md at some
point during the adversaryâ€™s initial queries. This violates the third
requirement, and so we conclude that there is no way to win Game
3. We have shown that ğ‘¢ğ‘›ğ¹ğ‘‚ğ‘…ğºğ¸ is indistinguishable from Game
3 to any efficient adversary, and so we can conclude that any ef-
ficient adversary can gain at most negligible advantage against
the ğ‘¢ğ‘›ğ¹ğ‘‚ğ‘…ğºğ¸ game for Scheme 1, and therefore the scheme is
unforgeable.
â–¡
B.4 Deniability â€“ Proof of Theorem 4.4
Proof. The full proof that this scheme satisfies the deniability
requirements of a secure source-tracking scheme appears in the
full version of this paper.
This means that the only difference between G0 and G1
is that instead of seeing a re-randomization of the orig-
inal source ciphertext upon receipt, the adversary sees a
re-randomization of a fresh encryption of the same value.
These two ciphertexts follow the same distribution, and are
therefore indistinguishable to the adversary.
G2: We further modify malRec so that instead of a fresh en-
cryption of the original source ğ‘†0, we make ğ¸â€²
2 a fresh
encryption of ğ‘†1, the user/metadata pair that would have
been used in the case that ğ‘ = 1. Because the adversary does
not know the platformâ€™s secret key, this is indistinguishable
from Game 1 by the CPA security of El Gamal encryption.
G3: This is the standard ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 1 game. The only difference
in the adversaryâ€™s view between Games 2 and 3 is that the
source stored in the forwarding data used to send the mes-
sage that the adversary receives during a call to malRec is
a fresh encryption of ğ‘†1 in the case of Game 2, and a re-
randomized encryption of ğ‘†1 in the case of Game 3. By the
same argument as the hop from Game 0 to Game 1, this
difference is indistinguishable to an efficient adversary.
1, ğ¸â€²
We have shown that in each hop, the two consecutive games
are indistinguishable to an efficient adversary. We can therefore
conclude that ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 0 is indistinguishable from ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 1 to an
efficient adversary, and therefore Scheme 2 satisfies tree-unlinkable
user confidentiality.
â–¡
â–¡
C.1.2 Platform Confidentiality.
Lemma C.2. Assuming that the messaging systemâ€™s encryption
scheme E is a secure authenticated encryption scheme, the proof sys-
tem used to prove attribute values on messages is zero-knowledge, and
the algebraic MAC presented in [5] satisfies blind issuance and anony-
mous presentation properties, then the advantage of any efficient
platform-confidentiality adversary for Scheme 2 is negligible.
Note that the proof relies on the blind issuance and anonymity
properties of the algebraic MAC presented in [5]. These are for-
mally defined in [4] and discussed in [5]. Briefly, blind issuance
guarantees that when the platform and user interact to issue a MAC
on attributes known only to the user, the interaction is a secure
two-party computation against malicious adversaries in which the
user gets a valid MAC on their attributes and the platform learns
nothing about the userâ€™s hidden attributes or the MAC that they re-
ceive. Anonymity guarantees that a user can prove to the platform
they hold a valid MAC on particular attributes without revealing
the MAC or hidden attributes to the platform.
Proof. We show that the two ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ games are indistinguish-
able to an efficient adversary via a series of game hybrids.
The first few hybrids show that the adversary canâ€™t gain a non-
negligible advantage by not following the correct protocol. We
begin by using the same approach as in the proof of Lemma B.2 to
show that the adversary gains no advantage from calling goodRec
(oracle function to make an honest user recieve a message from an-
other honest user) with a message identifier ğ‘’ that is not associated
with the inputted ğ‘šğ‘–ğ‘‘ or correct platform data ğ‘ğ‘‘.
G0: This is identical to the standard ğ‘ƒğ¶ğ‘‚ğ‘ ğ¹ 0 game for ğ‘ = 0.
C SECURITY PROOFS FOR
TREE-UNLINKABLE SOURCE-TRACKING
C.1 Confidentiality â€“ Proof of Theorem 5.1
Proof. The proof follows immediately from the results of Lem-
â–¡
mas C.1 and C.2.
C.1.1 User Confidentiality.
Lemma C.1. Assuming the CPA-security of the platformâ€™s El Gamal
scheme, any efficient adversary has negligible tree-unlinkable advan-
tage against the ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ game.
Proof. We note that conditioned on the ğ‘ ğ‘Ÿğ‘ ciphertext values
(ğ¸1, ğ¸2) used in the forwarding data of messages sent via malRec,
the adversaryâ€™s view in ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 0 and ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 1 is identical.
It therefore suffices to show that the difference in ciphertexts
doesnâ€™t provide the adversary with a non-negligible advantage. We
do this below by constructing a series of hybrid games to show
that ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 0 and ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 1 are indistinguishable to an efficient
adversary.
G0: This game is identical to the standard ğ‘ˆğ¶ğ‘‚ğ‘ ğ¹ 0 game (when
ğ‘ = 0).
G1: We modify malRec (oracle function that sends one of two
messages from an honest sender to a malicious receiver) so
that if the message would normally be sent with forwarding
data that includes the source ciphertext (ğ¸1, ğ¸2), which is
an encryption of the source information ğ‘†0 âˆˆ G, we instead
replace (ğ¸1, ğ¸2) with a fresh encryption of ğ‘†0, (ğ¸â€²
2), before
sending.
1, ğ¸â€²
Session 5C: Messaging and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1502G1: We add the additional condition to goodRec to abort imme-
diately if the inputted ğ‘’ value has never been outputted by
the sender ğ‘ˆğ‘  as part of a message to the receiver ğ‘ˆğ‘Ÿ at any
point in the game. This is indistinguishable from G0 because
finding a valid ğ‘’ that was not sent from ğ‘ˆğ‘  to ğ‘ˆğ‘Ÿ contradicts
the authenticated encryption properties of the messaging
scheme, and can therefore happen with only negligible prob-
ability.
We note that otherwise, ğ‘’ must have resulted from a call to
goodSend (oracle function to make an honest user send a
message to another honest user) between ğ‘ˆğ‘  and ğ‘ˆğ‘Ÿ earlier
in the game, and so there exists some ğ‘šğ‘–ğ‘‘â€²â€² in ğ‘‡ğ‘ ğ‘’ğ‘›ğ‘‘ that
stores ğ‘’. The only difference between calling goodRec with
the correct pair (ğ‘šğ‘–ğ‘‘â€²â€², ğ‘’) instead of (ğ‘šğ‘–ğ‘‘, ğ‘’) is that the ğ‘¡ğ‘–ğ‘‘
will always be âŠ¥, which only weakens the adversaryâ€™s power
because it can no longer see the message contents by having
the message reported, so we can assume that ğ‘’ = ğ‘’â€² in all
other cases.
ğ¹) that
the platform passes to the receiver. In the correct protocol,
the platform would pass over identical ğ¶ğ´ and ğ¶â€²
ğ¹ values to
the ones that were presented by the sender (The ğ‘ ğ‘Ÿğ‘ cipher-
text is chosen by the platform and is allowed to be unique for
every new message, so it doesnâ€™t matter what this is chosen
to be). We modify G1 to immediately abort if ğ¶ğ´ and ğ¶â€²
ğ¹ are
not identical to the commitments presented by the sender.
This game is indistinguishable from Game 1, because the