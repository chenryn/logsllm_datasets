ﬁc from smart home devices at scale,” arXiv preprint
arXiv:1909.09848, 2019.
[9] C. Wampler, S. Uluagac, and R. Beyah, “Information
leakage in encrypted ip video trafﬁc,” in 2015 IEEE
Global Communications Conference (GLOBECOM).
IEEE, 2015, pp. 1–7.
[10] B. Nassi, R. Ben-Netanel, A. Shamir, and Y. Elovici,
“Drones’ cryptanalysis-smashing cryptography with a
ﬂicker,” in IEEE Symposium on Security and Privacy
(SP), Vol. 00, 2019, pp. 833–850.
[11] T. Liu, Z. Liu, J. Huang, R. Tan, and Z. Tan, “Detect-
ing wireless spy cameras via stimulating and probing,”
in Proceedings of the 16th Annual International Con-
ference on Mobile Systems, Applications, and Services.
ACM, 2018, pp. 243–255.
[12] K. Wu and B. Lagesse, “Do you see what i see? detecting hidden streaming cameras through sim-
ilarity of simultaneous observation,” in 2019 IEEE In-
ternational Conference on Pervasive Computing and
Communications (PerCom.
IEEE, 2019, pp. 1–10.
[13] Y. Cheng, X. Ji, T. Lu, and W. Xu, “Dewicam: Detecting
hidden wireless cameras via smartphones,” in Proceed-
ings of the 2018 on Asia Conference on Computer and
Communications Security. ACM, 2018, pp. 1–13.
[3] S. Fussell. (2019) Airbnb has a hidden-camera problem.
[Online]. Available:
https://www.theatlantic.com/
technology/archive/2019/03/what-happens-when-you-
ﬁnd-cameras-your-airbnb/585007/
[14] “Best sellers in surveillance
security cameras.”
[Online]. Available: https://www.amazon.com/Best-
Sellers-Electronics-Surveillance-Security-Cameras/
zgbs/electronics/898400
USENIX Association
30th USENIX Security Symposium    1843
[15] “Best sellers in home automation devices.” [Online].
https://www.amazon.com/Best-Sellers-
Available:
Home-Improvement-Automation-Devices/zgbs/hi/
6478739011
[16] D. Ding, R. A. Cooper, P. F. Pasquina, and L. Fici-
Pasquina, “Sensor technology for smart homes,” Ma-
turitas, vol. 69, no. 2, pp. 131–136, 2011.
[17] D. Sathyamoorthy, M. J. M. Jelas, and S. Shaﬁi, “Wire-
less spy devices: A review of technologies and detection
methods,” EDITORIAL BOARD, p. 130, 2014.
[18] V. Valeros and S. Garcia, “Spy vs. spy: A mod-
ern study of microphone bugs operation and
detection,” Chaos Computer Club e.V., 2017,
https://doi.org/10.5446/34936
:
26Nov2019.
Lastaccessed
[19] C. W. Granger, “Investigating causal relations by econo-
metric models and cross-spectral methods,” Economet-
rica: Journal of the Econometric Society, pp. 424–438,
1969.
[20] H. Wu, K. Tan, J. Liu, and Y. Zhang, “Footprint: cellular
assisted wi-ﬁ ap discovery on mobile phones for energy
saving,” in Proceedings of the 4th ACM international
workshop on Experimental evaluation and characteri-
zation. ACM, 2009, pp. 67–76.
[21] X. Hu, L. Song, D. Van Bruggen, and A. Striegel, “Is
there wiﬁ yet?: How aggressive probe requests deterio-
rate energy and throughput,” in Proceedings of the 2015
Internet Measurement Conference. ACM, 2015, pp.
317–323.
[22] S. Wenger, “H. 264/avc over ip,” IEEE transactions on
circuits and systems for video technology, vol. 13, no. 7,
pp. 645–656, 2003.
[23] A. D. Singh, S. S. Sandha, L. Garcia, and M. Srivas-
tava, “Radhar: Human activity recognition from point
clouds generated through a millimeter-wave radar,” in
Proceedings of the 3rd ACM Workshop on Millimeter-
wave Networks and Sensing Systems. ACM, 2019, pp.
51–56.
[24] R. Zhang and S. Cao, “Real-time human motion be-
havior detection via cnn using mmwave radar,” IEEE
Sensors Letters, vol. 3, no. 2, pp. 1–4, 2018.
[25] V. Kepuska and G. Bohouta, “Next-generation of vir-
tual personal assistants (microsoft cortana, apple siri,
amazon alexa and google home),” in 2018 IEEE 8th
Annual Computing and Communication Workshop and
Conference (CCWC).
IEEE, 2018, pp. 99–103.
[26] S. Kennedy, H. Li, C. Wang, H. Liu, B. Wang, and
W. Sun, “I can hear your alexa: Voice command ﬁn-
gerprinting on smart home speakers,” in 2019 IEEE
Conference on Communications and Network Security
(CNS).
IEEE, 2019, pp. 232–240.
[27] C. V. Wright, L. Ballard, S. E. Coull, F. Monrose, and
G. M. Masson, “Spot me if you can: Uncovering spoken
phrases in encrypted voip conversations,” in 2008 IEEE
Symposium on Security and Privacy (sp 2008).
IEEE,
2008, pp. 35–49.
[28] K. Gao, C. Corbett, and R. Beyah, “A passive approach
to wireless device ﬁngerprinting,” in 2010 IEEE/IFIP
International Conference on Dependable Systems &
Networks (DSN).
IEEE, 2010, pp. 383–392.
[29] M. Crotti, M. Dusi, F. Gringoli, and L. Salgarelli, “Traf-
ﬁc classiﬁcation through simple statistical ﬁngerprint-
ing,” ACM SIGCOMM Computer Communication Re-
view, vol. 37, no. 1, pp. 5–16, 2007.
[30] N. Apthorpe, D. Y. Huang, D. Reisman, A. Narayanan,
and N. Feamster, “Keeping the smart home private with
smart(er) iot trafﬁc shaping,” 2018.
[31] C. Zuo, H. Wen, Z. Lin, and Y. Zhang, “Automatic ﬁnger-
printing of vulnerable ble iot devices with static uuids
from mobile apps,” in Proceedings of the 2019 ACM
SIGSAC Conference on Computer and Communications
Security. ACM, 2019, pp. 1469–1483.
[32] J. Ortiz, C. Crawford, and F. Le, “Devicemien: network
device behavior modeling for identifying unknown iot
devices,” in Proceedings of the International Confer-
ence on Internet of Things Design and Implementation.
ACM, 2019, pp. 106–117.
[33] Y. Meidan, M. Bohadana, A. Shabtai, J. D. Guarnizo,
M. Ochoa, N. O. Tippenhauer, and Y. Elovici, “Proﬁliot:
a machine learning approach for iot device identiﬁcation
based on network trafﬁc analysis,” in Proceedings of the
symposium on applied computing. ACM, 2017, pp.
506–509.
[34] M. Miettinen, S. Marchal, I. Hafeez, N. Asokan, A.-
R. Sadeghi, and S. Tarkoma, “Iot sentinel: Automated
device-type identiﬁcation for security enforcement in
iot,” in 2017 IEEE 37th International Conference on
Distributed Computing Systems (ICDCS).
IEEE, 2017,
pp. 2177–2184.
[35] M. Vanhoef, C. Matte, M. Cunche, L. S. Cardoso, and
F. Piessens, “Why mac address randomization is not
enough: An analysis of wi-ﬁ network discovery mecha-
nisms,” in Proceedings of the 11th ACM on Asia Confer-
ence on Computer and Communications Security, 2016,
pp. 413–424.
1844    30th USENIX Security Symposium
USENIX Association
[36] N. Patel, “Dead reckoning, a location tracking
app for android smartphones.” [Online]. Available:
https://github.com/nisargnp/DeadReckoning
[49] P. Schmitt, F. Bronzino, R. Teixeira, T. Chattopadhyay,
and N. Feamster, “Enhancing transparency: Internet
video quality inference from network trafﬁc,” 2018.
[37] R. W. Levi and T. Judd, “Dead reckoning navigational
system using accelerometer to measure foot impacts,”
Dec. 10 1996, uS Patent 5,583,776.
[38] S. Beauregard and H. Haas, “Pedestrian dead reckon-
ing: A basis for personal positioning,” in Proceedings
of the 3rd Workshop on Positioning, Navigation and
Communication, 2006, pp. 27–35.
[39] S.-T. Sun, A. Cuadros, and K. Beznosov, “Android root-
ing: Methods, detection, and evasion,” in Proceedings
of the 5th Annual ACM CCS Workshop on Security and
Privacy in Smartphones and Mobile Devices. ACM,
2015, pp. 3–14.
[40] L. Ojeda and J. Borenstein, “Personal dead-reckoning
system for gps-denied environments,” in 2007 IEEE
International Workshop on Safety, Security and Rescue
Robotics.
IEEE, 2007, pp. 1–6.
[41] P. Kinney et al., “Zigbee technology: Wireless control
that simply works,” in Communications design confer-
ence, vol. 2, 2003, pp. 1–7.
[42] M. B. Yassein, W. Mardini, and A. Khalil, “Smart homes
automation using z-wave protocol,” in 2016 Interna-
tional Conference on Engineering & MIS (ICEMIS).
IEEE, 2016, pp. 1–6.
[43] N. J. Muller, Bluetooth demystiﬁed. McGraw-Hill New
York, 2001, vol. 1.
[44] J. C. Haartsen, “Bluetooth radio system,” Wiley Ency-
clopedia of Telecommunications, 2003.
[45] Z. Li and T. He, “Webee: Physical-layer cross-
technology communication via emulation,” in Proceed-
ings of the 23rd Annual International Conference on
Mobile Computing and Networking, 2017, pp. 2–14.
[46] S. M. Kim and T. He, “Freebee: Cross-technology com-
munication via free side-channel,” in Proceedings of
the 21st Annual International Conference on Mobile
Computing and Networking, 2015, pp. 317–330.
[47] Nbc, “How to detect hidden cameras,” Aug 2019.
[Online]. Available:
https://www.nbcmiami.com/
news/local/How-to-Detect-Hidden-Cameras-in-Your-
Vacation-Rental-530314101.html
[48] “Monitor
wi-ﬁ
trafﬁc
-
band-
Avail-
https://www.solarwinds.com/netﬂow-trafﬁc-
width monitoring
able:
analyzer/use-cases/monitor-wiﬁ-trafﬁc
wireless
[Online].
tools.”
[50] A. Steele, “Music revenue surges on streaming
subscription growth,” Sep 2019. [Online]. Available:
https://www.wsj.com/articles/music-revenue-surges-
on-streaming-subscription-growth-11567708974
[51] D. Kumar, K. Shen, B. Case, D. Garg, G. Alperovich,
D. Kuznetsov, R. Gupta, and Z. Durumeric, “All things
considered: an analysis of iot devices on home networks,”
in 28th {USENIX} Security Symposium ({USENIX} Se-
curity 19), 2019, pp. 1169–1185.
[52] Y. Sun, M. Liu, and M. Q.-H. Meng, “Wiﬁ signal
strength-based robot indoor localization,” in 2014 IEEE
International Conference on Information and Automa-
tion (ICIA).
IEEE, 2014, pp. 250–256.
[53] X. Luo, W. J. O’Brien, and C. L. Julien, “Comparative
evaluation of received signal-strength index (rssi) based
indoor localization techniques for construction jobsites,”
Advanced Engineering Informatics, vol. 25, no. 2, pp.
355–363, 2011.
[54] W. Xue, W. Qiu, X. Hua, and K. Yu, “Improved wi-ﬁ
rssi measurement for indoor localization,” IEEE Sensors
Journal, vol. 17, no. 7, pp. 2224–2230, 2017.
[55] Z. Li, Z. Xiao, Y. Zhu, I. Pattarachanyakul, B. Y. Zhao,
and H. Zheng, “Adversarial localization against wire-
less cameras,” in Proceedings of the 19th International
Workshop on Mobile Computing Systems & Applica-
tions. ACM, 2018, pp. 87–92.
[56] S. Jondhale, R. Deshpande, S. Walke, and A. Jondhale,
“Issues and challenges in rssi based target localization
and tracking in wireless sensor networks,” in 2016 Inter-
national Conference on Automatic Control and Dynamic
Optimization Techniques (ICACDOT).
IEEE, 2016, pp.
594–598.
[57] D. G. Green, “Sinusoidal ﬂicker characteristics of the
color-sensitive mechanisms of the eye,” Vision research,
vol. 9, no. 5, pp. 591–601, 1969.
Appendix A Audio-based Localization for
Personal Home Assistants
In this section, we describe the audio localization technique
step-by-step. First, we place the source of the sound (smart-
phone playing a phrase containing the wake word of the de-
vice) at different points in the room and see how it affects the
device trafﬁc. Then we go around the room while SNOOP-
DOG repeats that sound continuously and checks them for
USENIX Association
30th USENIX Security Symposium    1845
causality with device trafﬁc as shown in Figure 11. Sound
played at the points marked as green produces cause-effect
relationship with the device trafﬁc. We eliminate the regions
where we detect no causality. Next, we reduce the volume by
1 level and repeat our experiment in the left-over space till we
are left with a region of desirable size.
As discussed in the previous sections, Amazon Echo de-
vices allow the user to drop into any of their Alexa devices
and remotely listen to the audio in the room that they are
placed in. This does not require any authentication on the
device side during the drop-in. We perform 3 drop-ins on an
Amazon Echo Device and show the trafﬁc variation in Figure
12. From the trafﬁc variation, it is clear when the drop-ins
start and when they end.
Figure 11: Trial-based localization for acoustic sensors.
Appendix B Trafﬁc Variation of a Personal
Home Assistant During Drop-In
Figure 12: Trafﬁc variation of Amazon Echo Dot while
dropping-in
Appendix C Aggregation of Trafﬁc Statistics
Each device’s trafﬁc is grouped by MAC address, windowed,
and processed to compute device trafﬁc volume and variation.
SNOOPDOG monitors packet sequence number in the WLAN
layer to isolate and remove duplicate or redundant packets.
As large images are sent over multiple ﬁxed-length packets,
a sufﬁciently large window size must be used. We chose a
100 ms window to group all packets with the same image
within one interval. Cameras require a frame rate higher than
10 Hz to satisfy the ﬂicker fusion (i.e., persistence of vision)
threshold of the human eye [11, 57].
For camera encodings, we discard I-frames (through averag-
ing), as they do not encode differences in a scene and require
higher bandwidth, thereby adversely affecting the causality
analysis.
1846    30th USENIX Security Symposium
USENIX Association
-Causality not found-Causality found3.04 m3.04 m1.3 m2 mDrop-in startedDrop-in stopped