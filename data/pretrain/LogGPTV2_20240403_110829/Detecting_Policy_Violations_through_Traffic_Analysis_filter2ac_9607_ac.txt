distribution of sizes of packets from a single connection,
split into a client half and a server half. At any point, the
graphs reﬂect the proportion of packets from the connection
that were of a particular size or smaller.
As can be seen, these distributions are quite distinct.
However, the same could not be said for all of the distri-
butions.
Tables 2 and 3 show confusion matrices using just the
Bhattacharyya and Jensen-Shannon measures to classify
connections into a particular class. ‘XX’ denotes the un-
known class, indicating that no majority verdict could be
reached. Recall that rows are known classes, columns indi-
cate predicted class and the ﬁnal column indicates the num-
ber of instances available for classiﬁcation. Matrix entries
are % of total number of connections of each type.
Figure 1. Cumulative probability distribution
for class ‘I’, interactive SSH trafﬁc.
Figure 2. Cumulative probability distribu-
tion for class ‘H’, Web browsing forwarded
through an SSH tunnel.
F
93.86
F
0.00
H
0.00
I
IX
0.00
N 12.50
0.00
Q
S
14.29
H
0.00
100.00
0.00
1.52
0.00
0.00
0.00
I
0.88
0.00
96.48
6.06
0.00
44.44
28.57
IX
0.00
0.00
0.88
90.91
0.00
11.11
28.57
N
0.00
0.00
0.00
0.00
37.50
0.00
7.14
Q
0.00
0.00
0.88
0.00
0.00
44.44
0.00
S
0.00
0.00
0.00
0.00
0.00
0.00
14.29
XX Count
5.26
114
49
0.00
227
1.76
66
1.52
8
50.00
9
0.00
7.14
14
Table 2. Confusion Matrix: Bhattacharyya
F
93.86
F
2.04
H
0.00
I
IX
1.52
N 37.50
0.00
Q
S
14.29
H
0.88
97.96
0.00
1.52
12.50
0.00
0.00
I
0.00
0.00
96.48
6.06
0.00
55.56
28.57
IX
0.00
0.00
1.32
87.88
0.00
11.11
28.57
N
1.75
0.00
0.00
0.00
12.50
0.00
7.14
Q
0.00
0.00
1.32
0.00
0.00
33.33
0.00
S
0.00
0.00
0.00
0.00
0.00
0.00
14.29
XX Count
3.51
114
49
0.00
227
0.88
66
3.03
8
37.50
9
0.00
7.14
14
Table 3. Confusion Matrix: Jensen-Shannon
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:34:14 UTC from IEEE Xplore.  Restrictions apply. 
PSfragreplacements0200400600800100012001400Datasize(bytes)[CLIENT]0.00.10.20.30.40.50.60.70.80.91.0CumulativeDistribution0200400600800100012001400Datasize(bytes)[SERVER]0.00.10.20.30.40.50.60.70.80.91.0CumulativeDistributionPSfragreplacements0200400600800100012001400Datasize(bytes)[CLIENT]0.00.10.20.30.40.50.60.70.80.91.0CumulativeDistribution0200400600800100012001400Datasize(bytes)[SERVER]0.00.10.20.30.40.50.60.70.80.91.0CumulativeDistributionProceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006F
79.82
0.00
0.00
1.52
0.00
0.00
7.14
H
0.88
87.76
0.00
0.00
12.50
0.00
0.00
I
0.00
0.00
90.75
1.52
0.00
22.22
0.00
IX
0.00
0.00
0.00
72.73
0.00
0.00
7.14
N
0.00
0.00
0.00
0.00
50.00
0.00
0.00
Q
0.00
0.00
0.44
0.00
0.00
44.44
0.00
S
0.00
0.00
0.00
0.00
0.00
0.00
35.71
XX Count
114
49
227
66
8
9
14
19.30
12.24
8.81
24.24
37.50
33.33
50.00
F
H
I
IX
N
Q
S
Table 5. Confusion Matrix: Jensen-Shannon
+ avg. bytes/sec + threshold=0.015
I
96.48
5.00
XX Count
227
3.52
95.00
260
I
XX
Table 6. Confusion Matrix: Bhattacharyya
mitted by policy, a reasonable level of conﬁdence could be
had in this identiﬁcation. Class separation when using the
Jensen-Shannon method can be improved as well, but not
as substantially as is the case when using the Bhattacharyya
method, as Table 5 indicates.
We now consider how compliance with a policy that
speciﬁes that SSH is to be used in an interactive manner
only might be audited. In this case, interest is not so much
in what particular sort of activity is being conducted, but
in whether the session represents interactive SSH or some-
thing else. Table 6 displays the results of using only the
Bhattacharyya measure to classify connections into classes
“interactive” and “everything else”. Classiﬁcations have a
reasonably low level of false positives and false negatives,
which can be improved by including more of the statistical
measures previously described in the classiﬁcation process.
Table 7 displays the results of this classiﬁcation process. It
can be seen that both the false positive and false negative
rates have been improved.
6 Evasion
The distribution of packet sizes from an SSH connection
is an important part of the classiﬁcation performed here. It
would be possible to affect the results by altering this distri-
I
97.80
1.92
XX Count
2.20
227
260
98.08
I
XX
Table 7. Confusion Matrix: Bhattacharyya
+ maxpacketsize + modepacketsize + avg.
bytes/sec + threshold=0.9
Figure 3. Cumulative probability distribution
for class ‘H’ compressed, Web browsing for-
warded through an SSH tunnel where SSH is
performing compression prior to encrypting
the tunneled data.
F
74.56
0.00
0.00
0.00
0.00
0.00
0.00
H
0.00
85.71
0.00
0.00
0.00