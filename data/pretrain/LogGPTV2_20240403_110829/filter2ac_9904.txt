title:A Distributed Honeynet at KFUPM: A Case Study
author:Mohammed H. Sqalli and
Raed Al-Shaikh and
Ezzat Ahmed
A Distributed Honeynet at KFUPM: A Case Study 
Mohammed Sqalli, Raed AlShaikh, and Ezzat Ahmed 
Department of Computer Engineering 
King Fahd University of Petroleum and Minerals 
{sqalli,g199607190,g200804300}@kfupm.edu.sa 
1   Introduction and Design Setup 
The main objectives of this work is to present our preliminary experience in simulat-
ing a virtual distributed honeynet environment at King Fahd University of Petroleum 
and Minerals (KFUPM) using Honeywall CDROM [1], Snort, Sebek and Tcpreplay 
[3] tools. In our honeynet design, we utilized the Honeywall CDROM to act as a cen-
tralized  logging  center  for  our  distributed  high-interaction  honeypots.  All  honeypot 
servers, as  well as the Honeywall  CDROM itself,  were built on top of a virtualized 
VMWare environment, while their logs were forwarded to the centralized server. This 
setup is illustrated in figure 1. 
Fig. 1. The proposed distributed design of KFUPM honeynet 
2   Preliminary Evaluation and Results 
Since  honeypots  do  not  offer  any  useful  services  to  Internet  users  and  the  Internet 
addresses  of  the  honeypots  are  not  publicly  known,  most  traffic  on  the  honeynet  is 
suspicious. However, not all traffic is malicious. Therefore, the traffic we observed on 
our honeypots falls into three different categories: 
-  Network scans by KFUPM Information Technology Center. 
-  Traffic generated by honeypots due to normal network operations (e.g. traffic 
to maintain the network connection). 
-  Network broadcasts, such as BitTorrent requests. 
At KFUPM, more than 30,000 activities were captured in the given 30-hours interval. 
Tale 1 shows the distribution of these types of activities in more details. 
S. Jha, R. Sommer, and C. Kreibich (Eds.): RAID 2010, LNCS 6307, pp. 486–487, 2010. 
© Springer-Verlag Berlin Heidelberg 2010 
A Distributed Honeynet at KFUPM: A Case Study 
487 
Table 1. The traffic distribution as it was detected by KFUPM honeynet in a 30-hours interval 
Name 
IIS view script source code vulnerability attack 
MS Uni Plug and Play UDP 
NBT(NetBIOS) Datagram Service 
Bit Torrent requests 
DHCP requests 
Protocol 
TCP 
UDP 
UDP 
TCP 
UDP 
Severity 
Medium 
Medium 
Low 
Medium 
Low 
Total 
8 
30 
399 
19098 
9938 
In terms of severity, around 65% of the traffic was considered medium risk, while 
the  remaining  35%  was  considered  low.  The  high  percentage  of  the  medium-level 
category was due to the fact that the system classifies BitTorrents file sharing, which 
makes around 70% of the total traffic, as medium risk. This percentage is of no sur-
prise  since  BitTorrent  accounts  for  an  astounding  40-55%  of  all  the  traffic  on  the 
Internet [5], and it is expected to be high in the students’ living campuses. 
Another interesting finding is the detection of a vulnerability attack on the Internet 
Information  Service  (IIS)  that  was  installed  on  the  Windows-based  honeypots.  This 
vulnerability has the signature KFAGC165421, and indicates that IIS contains a flaw 
that allows an attacker to cause IIS to return the source code for a script file instead of 
processing  the  script.  This  vulnerability  attack  traffic  was  generated  by  one  of  the 
systems in the students’ living campus. 
3   Conclusion and Future Work 
Our experience so far shows that Honeywall CDROM proved to be a solid tool that is 
capable of capturing great deal of information and assisting in analyzing traffic on the 
distributed  honeypots.  The  honeynet  designer,  nevertheless,  needs  to  consider  few 
issues related to scalability and resource utilization. 
Out  future  work  includes  expanding  our  honeynet  network  to  include  other  col-
leges  and  campuses  in  the  university  and  have  wider  honeynet  coverage.  This  will 
also require increasing our logging disk space to allow for more logging time, longer 
logging intervals and thus broader analysis. 
References 
1.  The Honeywall CDROM, https://projects.honeynet.org/honeywall/ 
2.  Argus: The Network Activity Auditing Tool, http://www.qosient.com/argus 
3.  TCPreplay, http://tcpreplay.synfin.net/ 
4.  WireShark, http://www.wireshark.org/ 
5.  Le Blond, S., Legout, A., Dabbous, W.: Reducing BitTorrent Traffic at the Internet Scale. A 
Presentation at the Internet Research Task Force, IRTF (March 2010)