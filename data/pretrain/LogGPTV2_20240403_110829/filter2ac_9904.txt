# A Distributed Honeynet at KFUPM: A Case Study

**Authors:**  
Mohammed H. Sqalli, Raed Al-Shaikh, and Ezzat Ahmed  
Department of Computer Engineering  
King Fahd University of Petroleum and Minerals  
{sqalli, g199607190, g200804300}@kfupm.edu.sa  

## 1. Introduction and Design Setup

This paper presents our initial experience in setting up a virtual distributed honeynet environment at King Fahd University of Petroleum and Minerals (KFUPM) using tools such as the Honeywall CDROM [1], Snort, Sebek, and Tcpreplay [3]. In our design, the Honeywall CDROM serves as a centralized logging center for our distributed high-interaction honeypots. All honeypot servers, along with the Honeywall CDROM, were deployed on a VMware virtualized environment, with their logs forwarded to the central server. Figure 1 illustrates this setup.

![Figure 1: The proposed distributed design of KFUPM honeynet](figure1.png)

## 2. Preliminary Evaluation and Results

Honeypots do not provide any useful services to Internet users, and their IP addresses are not publicly known, so most traffic directed to them is suspicious. However, not all traffic is malicious. The traffic observed on our honeypots can be categorized into three types:

- Network scans by KFUPM's Information Technology Center.
- Traffic generated by honeypots due to normal network operations (e.g., maintaining network connections).
- Network broadcasts, such as BitTorrent requests.

During a 30-hour observation period, over 30,000 activities were captured. Table 1 provides a detailed breakdown of these activities.

| **Name** | **Protocol** | **Severity** | **Total** |
|----------|--------------|--------------|-----------|
| IIS view script source code vulnerability attack | TCP | Medium | 8 |
| MS Uni Plug and Play UDP | UDP | Medium | 30 |
| NBT (NetBIOS) Datagram Service | UDP | Low | 399 |
| BitTorrent requests | TCP | Medium | 19,098 |
| DHCP requests | UDP | Low | 9,938 |

In terms of severity, approximately 65% of the traffic was classified as medium risk, while the remaining 35% was considered low risk. The high percentage of medium-risk traffic is primarily due to the classification of BitTorrent file sharing, which accounts for about 70% of the total traffic. This is consistent with reports that BitTorrent constitutes 40-55% of all Internet traffic [5], and it is expected to be high in student living areas.

Another notable finding was the detection of a vulnerability attack on the Internet Information Services (IIS) installed on the Windows-based honeypots. This vulnerability, identified by the signature KFAGC165421, allows an attacker to cause IIS to return the source code of a script file instead of processing it. The attack traffic originated from one of the systems in the student living campus.

## 3. Conclusion and Future Work

Our experience demonstrates that the Honeywall CDROM is a robust tool for capturing and analyzing traffic in a distributed honeynet environment. However, the honeynet designer must consider issues related to scalability and resource utilization.

Future work will involve expanding the honeynet to include other colleges and campuses within the university, thereby increasing the coverage. This expansion will also require increasing the logging disk space to allow for longer logging intervals and more comprehensive analysis.

## References

1. The Honeywall CDROM. https://projects.honeynet.org/honeywall/
2. Argus: The Network Activity Auditing Tool. http://www.qosient.com/argus
3. TCPreplay. http://tcpreplay.synfin.net/
4. Wireshark. http://www.wireshark.org/
5. Le Blond, S., Legout, A., Dabbous, W. (March 2010). Reducing BitTorrent Traffic at the Internet Scale. A Presentation at the Internet Research Task Force, IRTF.