0
0
0
0
15
8
7
12
15
57
0
0
134
0
2
3
2
7
42
42
18
0
18
0
0
2
2
0
0
0
0
15
6
7
12
12
52
0
0
0
0
0
0
0
6
0
6
0
0
2
2
0
0
0
0
0
2
0
0
3
5
0
0
0
0
0
12
12
0
0
0
0
0
0
0
0
0
0
0
0
0
2
0
0
2
15
0
0
0
15
0
0
0
21
21
24
24
5
5
60
60
5
5
0
0
0
0
0
0
15
0
0
0
15
0
0
0
21
21
24
24
5
5
60
60
5
5
0
0
0
0
0
0
15
0
0
0
15
0
0
0
21
21
24
24
5
5
60
60
5
5
0
0
0
0
0
0
0
0
121
0
0
13
0
0
14
39
39
169
39
39
169
39
39
169
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
would increase FPs and FNs, respectively (e.g., some IRC bots use
multiple tokens in one message, while in general, FTP bots do not).
Of the 135 manually-verified 𝐿𝐿 identifiers, C3PO produced 14
FNs because of undocumented tokens resulting in 121 of 135 TPs.
The only FNs occurred during the IRC and WebDAV protocols iden-
tification via their 𝐿𝐿 implementation in the Rbot and Equationdrug
samples, respectively. Whenever we encountered undocumented
tokens, we subsequently added them to the protocol database. How-
ever, we retained our accuracy metrics results pre-modification as
it represents a more accurate depiction of C3PO’s protocol iden-
tification capability given the possibility of future undocumented
tokens. Overall, C3PO was 94% accurate in identifying protocols
making it robust enough to be applied to the large-scale study.
4.2 C&C Monitoring Capabilities Evaluation
Table 5 presents our evaluation of C3PO’s ability to identify C&C
monitoring capabilities. Columns 3-8 present the capabilities we
consider in our study, but C3PO can be extended to support other
capabilities. Their sub-columns are divided into two categories:
GT and C3PO represents the number of ground truth capabilities
identified and automatically identified, respectively. We found that
C3PO correctly identified 100 (TP) C&C monitoring capabilities.
Our GT analysis confirmed 104 capabilities, revealing 7 FPs, 4 FNs,
and an overall accuracy of over 94%.
Session 12B: Analyzing Crashes and Incidents CCS ’21, November 15–19, 2021, Virtual Event, Republic of Korea3357Table 5: Validating C&C Monitoring Capabilities Identification. 𝑉 𝑎𝑟 represents malware variants. GT and C3PO represent the number of manually verified
and automated capability identifiers per category, respectively.
Spying,
Live
Monitoring
Code
Reflection
Malware 𝑉 𝑎𝑟
Browser
Password
Stealer
Service
Password
Stealer
Victim
Profiling
File
Exfiltration
Accuracy
Metrics
GT C3PO GT C3PO GT C3PO GT C3PO GT C3PO GT C3PO TP FP FN
0
5
1
1
0
0
0
0
2
2
0
0
0
0
0
0
0
1
0
0
0
0
2
1
0
0
Total 35 11
4
20 0
0
1
2
6
0
9
0
6
3
0
6
0
4
1
0
9
8
0
4
8
12 0
8
0
100 7
Softcnapp 5
Cstealer
1
2
Ragebot
Expiro 3
2
Sathurbot
Icloader
1
Alma
2
Zbot
4
2
Rbot
4
Slackbot
Delf
4
Blackhole
3
Equationdrug 2
5
1
2
3
2
1
2
0
2
4