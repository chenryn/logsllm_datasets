Generic Server
Hosted Server
Embedded Server
Unknown
5,957,969 (43.21%)
1,795,596 (13.02%)
1,786,656 (12.95%)
4,249,417 (30.82%)
704,276 (62.66%)
174,198 (15.50%)
93,484 ( 8.32%)
151,927 (13.52%)
TABLE III.
ASES ACCOUNTING FOR 50% OF ALL FTP TYPES
AS Type
All FTP (78)
Anonymous FTP (42)
Hosting
ISP
Academic
50
25
3
29
11
2
TABLE IV.
CLASSES OF EMBEDDED DEVICES
Device Type
All FTP
Anonymous FTP
NAS
Home Router (user-deployed)
Printers
198,381
59,944
62,567
18,116
6,788
60,771
that allowed anonymous access, 268K (24%) exposed some
form of data; the remainder contained empty or inaccessible
directories. We detected robots.txt ﬁles on 11.3K servers.
Of these, 5.9K instructed our crawler to exclude the entire
ﬁlesystem, which we adhered to. On 26.7K servers, the ﬁle
structure required more than 500 requests to fully traverse,
and so our enumeration did not reach the entire accessible
ﬁlesystem.
A. Who is Deploying FTP?
We ﬁnd that FTP servers and anonymous FTP servers are
both widespread, with 34.7K ASes containing FTP servers and
16.4K ASes containing anonymous FTP servers. While FTP
servers are present in a large number of networks, a few ASes
contain the bulk of these servers: 78 ASes account for 50%
of FTP servers, and 42 ASes account for 50% of anonymous
FTP servers (see Figure 1).
To better understand why servers allow anonymous FTP
access in so many networks, we categorized the networks
that contain a large number of anonymous FTP servers and
also developed ﬁngerprints to identify speciﬁc implementations
and devices based on banner, certiﬁcate, and implementation-
speciﬁc responses. With these ﬁngerprints, we were able to
classify 69% of all FTP servers and 86% of anonymous FTP
servers into one of several broad categories: (1) large shared-
hosting providers, (2) provider-deployed embedded devices
(e.g., cable modems), (3) consumer-deployed devices (e.g.,
home NAS devices), and (4) generic servers (i.e., widespread
implementations that we were not able to categorize further).
We show the breakdown in Table II. We note that our estimates
in the “Hosted Server” and “Embedded Server” categories
are lower bounds, since some devices and services do not
expose identiﬁers that allow for more speciﬁc classiﬁcation.
505
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:19:25 UTC from IEEE Xplore.  Restrictions apply. 
However, even the lower bounds demonstrate that the problems
are systemic.
Shared Hosting Providers. As shown in Table III, IP
addresses within large hosting provider ASes account for a
substantial portion of both FTP and anonymous FTP servers. 50
of the largest 78 FTP ASes and 29 of the 42 largest anonymous
FTP ASes are owned by large hosting providers that offer
shared hosting, virtual private server (VPS), co-location, and/or
private cloud services. Table VI shows more details on the
most commonly seen ASes.
These providers appear to deploy FTP as part of their
default service offering, which, anecdotal evidence suggests, are
managed using web hosting automation software such as cPanel
or Plesk. In total—combining the hosts from the large providers
we identiﬁed and our ﬁngerprints—we estimate that at least
4.6M FTP servers (34%) and 470K anonymous FTP servers
(42%) belong to hosting providers. In the largest case, home.pl
(a large Polish hosting provider), approximately two-thirds of
all advertised IPs support FTP, and more than half support
anonymous FTP. However, despite the large raw numbers, we
ﬁnd that, in general, there is little sensitive user data exposed
on these hosts compared to personal devices.
Provider Deployed Embedded Devices. As can be seen
in Table III, all but a handful of the remaining large ASes
belong to ISPs. In many cases, service providers have deployed
embedded devices, such as DSL modems, all of which have FTP
enabled. In the most common case, more than 150K FRITZ!Box
DSL modems are found. The modems are primarily located
in Germany and have been deployed en masse by Deutsche
Telekom. We also frequently saw devices from ZyXEL, AXIS,
ZTE, and others (see Table V). A negligible fraction of the
devices had anonymous FTP enabled.
Consumer Embedded Devices. Most worryingly, we
ﬁnd that hundreds of thousands of consumer devices have
FTP enabled, and over 93K of these devices allow anonymous
access. These devices are largely network attached storage
(NAS) appliances, home wireless routers, and printers. These
home devices are from a variety of manufacturers, including
Buffalo, Asus, Xerox, Dell, Ricoh, and Synology. We present
the most common devices in Table VII.
For three of the devices we identiﬁed, more than 98% of
visible hosts have anonymous FTP enabled. While it is plausible
that a few home users are intentionally enabling anonymous
FTP to publish data to the world, that such a large fraction
are doing so seems unlikely. Instead, we suspect that these
particular devices enable anonymous FTP by default, or that
COMMON PROVIDER DEPLOYED DEVICES — WE FIND
TABLE V.
THAT INTERNET SERVICE PROVIDERS FREQUENTLY DEPLOY DEVICES WITH
FTP EN MASSE. VERY FEW HAVE ANONYMOUS ACCESS ENABLED.
Device
# Found
# Anonymous
FRITZ!Box DSL modem
ZyXEL DSL Modem
AXIS Physical Security Device
ZTE WiMax Router
Speedport DSL Modem
Dreambox Set-top Box
ZyXEL Uniﬁed Security Gateway
Alcatel Router
DrayTek Network Devices
152,520
29,376
20,002
14,245
13,677
12,298
11,964
10,383
4,161
49 (0.03%)
1 (0.00%)
58 (0.29%)
0 (0.00%)
0 (0.00%)
0 (0.00%)
0 (0.00%)
0 (0.00%)
0 (0.00%)
F
D
C
 1
 0.8
 0.6
 0.4
 0.2
 0
 1
All FTP Servers
Anonymous FTP Servers
Writable FTP Server
 10
 100
 1000
 10000
ASes
Fig. 1. Distribution of FTP servers by AS. CDF of all FTP, anonymous FTP,
and writable FTP servers with regard to aggregate number of ASes viewed.
TABLE VII.
SAMPLE OF EMBEDDED SERVER DEVICES THAT ARE
DEPLOYED AS STANDALONE
Device
# Found
# Anonymous
QNAP Turbo NAS
ASUS wireless routers
Synology NAS devices
Buffalo NAS storage
ZyXEL/MitraStar NAS
RICOH Printers
LaCie storage
Lexmark Printers
Xerox Printers
Dell Printers
Linksys Wiﬁ Routers
Lutron HomeWorks Processor
Seagate Storage devices
57,655
52,938
43,159
22,558
9,456
8,696
4,558
3,908
3,130
2,555
2,174
1,006
629
1,637 ( 2.84%)
5,891 (11.13%)
2,942 ( 6.82%)
8,870 (39.32%)
310 ( 3.28%)
7,606 (87.47%)
2,919 (64.04%)
3,896 (99.69%)
2,906 (92.84%)
2,515 (98.43%)
624 (28.72%)
1,003 (99.70%)
594 (94.44%)
they are designed in a way that leads users to misunderstand
the risks of enabling certain features.
The surprising number of servers that support anonymous
FTP raises several important questions: What data has been
inadvertently leaked on these devices? In the shared hosting
environments, code frequently contains API keys, and other
secrets; are these ﬁles accessible over anonymous FTP? Are
malicious actors taking advantage of these servers? In the next
several sections, we present case studies in which we investigate
these questions.
V. OVER EXPOSURE
With more than 1.1M FTP servers anonymously accessible,
the questions “What data is exposed?” and “Are users explicitly
posting this data?” immediately arise. We investigated the
directory listings from publicly accessible anonymous FTP
servers and found that a large amount of user data is being
exposed to the public. In this section, we discuss the ﬁles
available on anonymous servers and the devices responsible
for this data exposure.
A. Data Exposure
Within our dataset, index.html is the most common
ﬁle found with 494K instances on nearly 25K servers. This
comports with our previous analysis describing large hosting
506
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 09:19:25 UTC from IEEE Xplore.  Restrictions apply. 
TABLE VI.
TOP 10 ASES BY NUMBER OF ANONYMOUS FTP SERVERS
AS
IPs advertised
FTP servers
Anonymous FTP servers
AS12824 home.pl S.A.
AS46606 Uniﬁed Layer
AS2914 NTT America, Inc.
AS20013 CyrusOne LLC
AS40676 Psychz Networks
AS34011 domainfactory GmbH
AS4134 Chinanet
AS18978 Enzu Inc
AS18779 EGIHosting
AS4766 Korea Telecom
205,312
516,864
7,880,192
111,360
641,024
93,440
120,757,504
727,808
1,890,304
53,733,632
136,765 (66.61%)
246,470 (47.69%)
298,468 ( 3.79%)
64,790 (58.18%)
64,233 (10.02%)
21,153 (22.64%)
464,384 ( 0.39%)
73,541 (10.11%)
27,804 ( 1.43%)
211,479 ( 0.39%)
103,175 (75.44%)
44,273 (17.96%)
36,045 (12.08%)
30,772 (47.50%)
27,507 (42.82%)
19,077 (90.19%)
18,996 ( 4.09%)
17,510 (23.81%)
16,329 (58.73%)
16,222 ( 7.67%)
TABLE VIII.
MOST COMMON FILE EXTENSIONS ACROSS KNOWN
SOHO DEVICES
Extension
# Files
# Servers
.jpg
.mp3
.pdf
.avi