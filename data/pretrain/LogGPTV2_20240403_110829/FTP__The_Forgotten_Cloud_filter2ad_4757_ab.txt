### 服务器分类
- **通用服务器 (Generic Server)**
- **托管服务器 (Hosted Server)**
- **嵌入式服务器 (Embedded Server)**
- **未知 (Unknown)**

| 类别 | 数量 | 百分比 |
| --- | --- | --- |
| 通用服务器 | 5,957,969 | 43.21% |
| 托管服务器 | 1,795,596 | 13.02% |
| 嵌入式服务器 | 1,786,656 | 12.95% |
| 未知 | 4,249,417 | 30.82% |

### 表 III：占所有 FTP 类型 50% 的 AS 类型
| AS 类型 | 所有 FTP (78) | 匿名 FTP (42) |
| --- | --- | --- |
| 托管 | 50 | 25 |
| ISP | 3 | 2 |
| 学术机构 | 29 | 11 |
| 其他 | 2 | - |

### 表 IV：嵌入式设备的类别
| 设备类型 | 所有 FTP | 匿名 FTP |
| --- | --- | --- |
| NAS | 198,381 | 59,944 |
| 家用路由器（用户部署） | 62,567 | 18,116 |
| 打印机 | 6,788 | 60,771 |

允许匿名访问的服务器中，268K (24%) 暴露了某种形式的数据；其余包含空目录或无法访问的目录。我们在 11,300 台服务器上检测到了 robots.txt 文件，其中 5,900 台指示我们的爬虫排除整个文件系统，我们遵守了这些指示。在 26,700 台服务器上，文件结构需要超过 500 次请求才能完全遍历，因此我们的枚举未能覆盖整个可访问的文件系统。

### A. 谁在部署 FTP？
我们发现，FTP 服务器和匿名 FTP 服务器都非常普遍，共有 34,700 个 AS 包含 FTP 服务器，16,400 个 AS 包含匿名 FTP 服务器。虽然 FTP 服务器存在于大量网络中，但少数 AS 占据了这些服务器的大部分：78 个 AS 占据了 50% 的 FTP 服务器，42 个 AS 占据了 50% 的匿名 FTP 服务器（见图 1）。

为了更好地理解为什么这么多网络中的服务器允许匿名 FTP 访问，我们对包含大量匿名 FTP 服务器的网络进行了分类，并开发了指纹来识别基于横幅、证书和特定实现响应的具体实现和设备。通过这些指纹，我们能够将 69% 的 FTP 服务器和 86% 的匿名 FTP 服务器归类为以下几类：(1) 大型共享托管提供商，(2) 服务提供商部署的嵌入式设备（例如电缆调制解调器），(3) 消费者部署的设备（例如家用 NAS 设备），(4) 通用服务器（即广泛使用的实现，我们无法进一步分类）。表 II 显示了详细的分类。请注意，“托管服务器”和“嵌入式服务器”类别的估计值是下限，因为一些设备和服务没有暴露允许更具体分类的标识符。即使是最小估计值也表明问题具有系统性。

#### 共享托管提供商
如表 III 所示，大型托管提供商 AS 中的 IP 地址占据了 FTP 和匿名 FTP 服务器的很大一部分。78 个最大的 FTP AS 中有 50 个和 42 个最大的匿名 FTP AS 中有 29 个属于提供共享托管、虚拟专用服务器 (VPS)、共置和/或私有云服务的大型托管提供商。表 VI 显示了最常见的 AS 的更多详细信息。

这些提供商似乎在其默认服务中部署了 FTP，根据传闻证据，这些服务通常使用 cPanel 或 Plesk 等 Web 托管自动化软件进行管理。总体而言——结合我们识别的大提供商主机和指纹——我们估计至少 460 万台 FTP 服务器（34%）和 47 万台匿名 FTP 服务器（42%）属于托管提供商。在最大案例中，home.pl（一家大型波兰托管提供商）大约三分之二的所有公告 IP 支持 FTP，超过一半支持匿名 FTP。然而，尽管原始数字很大，但我们发现，与个人设备相比，这些主机上暴露的敏感用户数据很少。

#### 服务提供商部署的嵌入式设备
如表 III 所示，除少数几个大 AS 外，其余大 AS 都属于 ISP。在许多情况下，服务提供商已部署了嵌入式设备，如 DSL 调制解调器，所有这些设备都启用了 FTP。最常见的情况是，超过 15 万个 FRITZ!Box DSL 调制解调器被找到。这些调制解调器主要位于德国，并由 Deutsche Telekom 大规模部署。我们还经常看到来自 ZyXEL、AXIS、ZTE 等的设备（见表 V）。这些设备中只有极少数启用了匿名 FTP。

#### 消费者嵌入式设备
最令人担忧的是，我们发现数十万消费者设备启用了 FTP，超过 93,000 台设备允许匿名访问。这些设备主要是网络附加存储 (NAS) 设备、家用无线路由器和打印机。这些家用设备来自各种制造商，包括 Buffalo、Asus、Xerox、Dell、Ricoh 和 Synology。表 VII 列出了最常见的设备。

对于我们识别的三种设备，超过 98% 的可见主机启用了匿名 FTP。虽然有些家庭用户可能故意启用匿名 FTP 以向世界发布数据，但如此大的比例似乎不太可能。相反，我们怀疑这些特定设备默认启用了匿名 FTP，或者它们的设计让用户误解了启用某些功能的风险。

大量支持匿名 FTP 的服务器引发了一些重要问题：这些设备上无意泄露了哪些数据？在共享托管环境中，代码经常包含 API 密钥和其他秘密；这些文件是否可以通过匿名 FTP 访问？恶意行为者是否利用了这些服务器？在接下来的几节中，我们将通过案例研究探讨这些问题。

### V. 过度暴露
超过 110 万台 FTP 服务器可以匿名访问，立即引发了“暴露了哪些数据？”和“用户是否明确发布了这些数据？”的问题。我们调查了公开可访问的匿名 FTP 服务器的目录列表，发现大量用户数据被暴露给公众。在本节中，我们将讨论匿名服务器上的文件以及导致这些数据暴露的设备。

#### A. 数据暴露
在我们的数据集中，index.html 是最常见的文件，共有 494,000 个实例分布在近 25,000 台服务器上。这与我们之前关于大型托管环境的分析一致。

### 表 V：常见的服务提供商部署设备
| 设备 | 数量 | 匿名数量 |
| --- | --- | --- |
| FRITZ!Box DSL 调制解调器 | 152,520 | 49 (0.03%) |
| ZyXEL DSL 调制解调器 | 29,376 | 1 (0.00%) |
| AXIS 物理安全设备 | 20,002 | 58 (0.29%) |
| ZTE WiMax 路由器 | 14,245 | 0 (0.00%) |
| Speedport DSL 调制解调器 | 13,677 | 0 (0.00%) |
| Dreambox 机顶盒 | 12,298 | 0 (0.00%) |
| ZyXEL 统一安全网关 | 11,964 | 0 (0.00%) |
| Alcatel 路由器 | 10,383 | 0 (0.00%) |
| DrayTek 网络设备 | 4,161 | 0 (0.00%) |

### 表 VI：按匿名 FTP 服务器数量排名前十的 AS
| AS | 公告 IP 数量 | FTP 服务器数量 | 匿名 FTP 服务器数量 |
| --- | --- | --- | --- |
| AS12824 home.pl S.A. | 205,312 | 136,765 (66.61%) | 103,175 (75.44%) |
| AS46606 Unified Layer | 516,864 | 246,470 (47.69%) | 44,273 (17.96%) |
| AS2914 NTT America, Inc. | 7,880,192 | 298,468 (3.79%) | 36,045 (12.08%) |
| AS20013 CyrusOne LLC | 111,360 | 64,790 (58.18%) | 30,772 (47.50%) |
| AS40676 Psychz Networks | 641,024 | 64,233 (10.02%) | 27,507 (42.82%) |
| AS34011 domainfactory GmbH | 93,440 | 21,153 (22.64%) | 19,077 (90.19%) |
| AS4134 Chinanet | 120,757,504 | 464,384 (0.39%) | 18,996 (4.09%) |
| AS18978 Enzu Inc | 727,808 | 73,541 (10.11%) | 17,510 (23.81%) |
| AS18779 EGIHosting | 1,890,304 | 27,804 (1.43%) | 16,329 (58.73%) |
| AS4766 Korea Telecom | 53,733,632 | 211,479 (0.39%) | 16,222 (7.67%) |

### 表 VII：独立部署的嵌入式服务器设备样本
| 设备 | 数量 | 匿名数量 |
| --- | --- | --- |
| QNAP Turbo NAS | 57,655 | 1,637 (2.84%) |
| ASUS 无线路由器 | 52,938 | 5,891 (11.13%) |
| Synology NAS 设备 | 43,159 | 2,942 (6.82%) |
| Buffalo NAS 存储 | 22,558 | 8,870 (39.32%) |
| ZyXEL/MitraStar NAS | 9,456 | 310 (3.28%) |
| RICOH 打印机 | 8,696 | 7,606 (87.47%) |
| LaCie 存储 | 4,558 | 2,919 (64.04%) |
| Lexmark 打印机 | 3,908 | 3,896 (99.69%) |
| Xerox 打印机 | 3,130 | 2,906 (92.84%) |
| Dell 打印机 | 2,555 | 2,515 (98.43%) |
| Linksys Wi-Fi 路由器 | 2,174 | 624 (28.72%) |
| Lutron HomeWorks 处理器 | 1,006 | 1,003 (99.70%) |
| Seagate 存储设备 | 629 | 594 (94.44%) |

### 表 VIII：已知 SOHO 设备中最常见的文件扩展名
| 扩展名 | 文件数量 | 服务器数量 |
| --- | --- | --- |
| .jpg | - | - |
| .mp3 | - | - |
| .pdf | - | - |
| .avi | - | - |

**注：** 表 VIII 中的文件数量和服务器数量数据未提供完整信息，请补充具体数值。