entries in ğœ, respectively. Let ğ‘¢ = |ğ¾ğœ| be the number of key entries.
Let Pideal(ğœ), resp. Preal(ğœ), be the probability that if we make the
queries described in ğœ (in the same order), we receive in the ideal
game, resp. the real game, the corresponding answers recorded in ğœ.
In the ideal world, the revealed keys and the answers to the ideal
permutation, encryption, and verification queries are generated
independently. Thus Pideal(ğœ) = Pideal(ğ¾ğœ) Â· Pideal(ğ‘ƒğœ) Â· Pideal(ğ¸ğœ) Â·
Pideal(ğ‘‰ğœ). Recall that for good transcripts, the calls to the ideal
permutation ğœ‹ and random blocks induced by ideal permutation
and encryption entries are distinct. Therefore, there are exactly
|ğ‘†1(ğœ)| distinct calls to the ideal permutation in ğ‘ƒğœ and |ğ‘†2(ğœ)|
independently sampled random blocks generated in ğ¸ğœ. Hence
1
2ğ‘› . More-
over, as the ğ‘¢-many ğ‘˜-bit user keys are sampled at random and ver-
ification queries always return false, we obtain Pideal(ğ¾ğœ) = 2âˆ’ğ‘˜ğ‘¢
and Pideal(ğ‘‰ğœ) = 1. Consequently,
2ğ‘›âˆ’ğ‘– and Pideal(ğ¸ğœ) =|ğ‘†2(ğœ) |âˆ’1
|ğ‘†2(ğœ) |âˆ’1
|ğ‘†1(ğœ) |âˆ’1
Pideal(ğ‘ƒğœ) =|ğ‘†1(ğœ) |âˆ’1
ğ‘–=0
ğ‘–=0
1
Pideal(ğœ) = 2âˆ’ğ‘˜ğ‘¢ Â·
(7)
1
2ğ‘› âˆ’ ğ‘–
Â·
1
2ğ‘› .
ğ‘–=0
ğ‘–=0
In the real world, the user keys are also sampled at random and
Preal(ğ¾ğœ) = 2âˆ’ğ‘˜ğ‘¢. Once the user keys have been sampled, the prob-
ability of query outputs depends on the number of distinct ideal
permutation calls made. For good transcripts in the real world, the
calls to the ideal permutation ğœ‹ in ideal permutation and encryption
entries are distinct. Therefore, there are exactly |ğ‘†1(ğœ)| + |ğ‘†2(ğœ)|
distinct calls to the ideal permutation in ğ‘ƒğœ âˆª ğ¸ğœ, and the input-
output of these calls are also entirely determined in these sets.
Moreover, there are at most |ğ‘†3(ğœ)| more calls to the ideal permu-
tation done during verification queries and distinct from the ones
done during ideal permutation and encryption queries. However,
the input-output of these calls is not entirely determined in ğ‘‰ğœ,
only the inputs are. For the outputs, as ğœ is a good transcript, they
are required to be distinct from the ones in ğ‘ƒğœ âˆª ğ¸ğœ and not to
result in a forgery for queries in ğ‘‰ğœ. If ğ‘ is the exact number of
distinct ideal permutation calls in ğœ, the probability to get these
(cid:17), where ğ¼, ğ½ is a partition of
calls isğ‘–âˆˆğ¼
2ğ‘›âˆ’ğ‘– Â·ğ‘— âˆˆğ½
(cid:16)1 âˆ’ ğ‘“ğ‘—2ğ‘›âˆ’ğ‘—
{0, . . . , ğ‘ âˆ’ 1} fixed by the order of queries in ğœ and ğ‘“ğ‘— is the num-
ber of values that would result in a forgery while sampling the
1
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea19951
associated ideal permutation call during verification queries. ğ¼ con-
tains the index/order in which the associated ideal permutation
calls from ğ‘ƒğœ âˆª ğ¸ğœ are sampled and ğ½ contains the remaining ones
from ğ‘‰ğœ. Note that |ğ¼| = |ğ‘†1(ğœ)| + |ğ‘†2(ğœ)| and |ğ½| â‰¤ |ğ‘†3(ğœ)|. Thus,
(cid:16)1 âˆ’ ğ‘“ğ‘—2ğ‘›âˆ’ğ‘—
(cid:17). Furthermore, we can
Preal(ğœ) = 2âˆ’ğ‘˜ğ‘¢ Â·ğ‘–âˆˆğ¼
2ğ‘›âˆ’ğ‘– Â·ğ‘— âˆˆğ½
reorder and minimize the products in the following way:ğ‘–âˆˆğ¼
(cid:17), where
(cid:17) â‰¥|ğ¼ |âˆ’1
(cid:16)1 âˆ’ ğ‘“ğ‘—2ğ‘›âˆ’ğ‘—
(cid:16)1 âˆ’ ğ¹
2ğ‘›âˆ’ğ‘– Â·|ğ¼ |+|ğ‘†3(ğœ) |âˆ’1
ğ‘— âˆˆğ½
ğ¹ is a bound on the number of values that would result in a forgery
while sampling the associated ideal permutation call of one veri-
fication query, i.e. for a verification query Vf(ğ‘–, ğ‘ , ğ´ğ·, ğ¶âˆ¥ğ‘‡), the
number of (ğ‘Ÿâˆ¥ğ‘ âˆ¥ğ‘Š ) âˆˆ {0, 1}ğ‘› such that ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) (ğ‘¡)+ ğ‘  = ğ‘‡ . There
are 2ğ‘›âˆ’2ğ‘¡ possible values for ğ‘Š , and each of the 2ğ‘¡ possible val-
ues for ğ‘Ÿ yield exactly one value ğ‘  such that ğ»ğ‘Ÿ (ğ´ğ·, ğ¶) (ğ‘¡)+ ğ‘  = ğ‘‡ .
Therefore, we can consider ğ¹ = 2ğ‘›âˆ’2ğ‘¡ Â· 2ğ‘¡ = 2ğ‘›âˆ’ğ‘¡ in the previous
inequality. Consequently,
2ğ‘›âˆ’ğ‘– Â·
1
ğ‘—=|ğ¼ |
2ğ‘›âˆ’ğ‘—
ğ‘–=0
1
Preal(ğœ) â‰¥ 2âˆ’ğ‘˜ğ‘¢ Â·
1
2ğ‘› âˆ’ ğ‘–
Â·
ğ‘–=0
(cid:18)
1 âˆ’
|ğ‘†1(ğœ) |+|ğ‘†2(ğœ) |âˆ’1
|ğ‘†3(ğœ) |âˆ’1
(cid:18)
|ğ‘†3(ğœ) |âˆ’1
(cid:18)
|ğ‘†3(ğœ) |âˆ’1
1 âˆ’
ğ‘—=0
2ğ‘›âˆ’ğ‘¡
2ğ‘› âˆ’ |ğ‘†1(ğœ)| âˆ’ |ğ‘†2(ğœ)| âˆ’ ğ‘—
We can now calculate the probability ratio:
2ğ‘›âˆ’ğ‘¡
Preal(ğœ)
Pideal(ğœ) â‰¥
â‰¥
1 âˆ’
ğ‘—=0
2ğ‘›âˆ’ğ‘¡
2ğ‘› âˆ’ |ğ‘†1(ğœ)| âˆ’ |ğ‘†2(ğœ)| âˆ’ ğ‘—
2ğ‘› âˆ’ |ğ‘†1(ğœ)| âˆ’ |ğ‘†2(ğœ)| âˆ’ |ğ‘†3(ğœ)|
(cid:19)
.
(cid:19)
(cid:19)
.
(8)
ğ‘—=0
As |ğ‘†1(ğœ)| â‰¤ ğ‘ â‰¤ ğ‘›âˆ’ğ‘˜âˆ’1
|ğ‘†3(ğœ)| â‰¤ ğ‘ğ‘£ â‰¤ 2ğ‘›âˆ’2, then
6
Â· 2ğ‘›âˆ’ğ‘˜, |ğ‘†2(ğœ)| â‰¤ ğœğ‘’ + ğ‘ğ‘’ â‰¤ ğ‘›âˆ’ğ‘˜
3
Â· 2ğ‘›âˆ’ğ‘˜ and
|ğ‘†1(ğœ)| + |ğ‘†2(ğœ)| + |ğ‘†3(ğœ)| â‰¤ ğ‘ + ğœğ‘’ + ğ‘ğ‘’ + ğ‘ğ‘£
Hence,
Preal(ğœ)
Pideal(ğœ) â‰¥
â‰¤ (ğ‘› âˆ’ ğ‘˜) Â· 2ğ‘›âˆ’ğ‘˜ + 2ğ‘›âˆ’2 â‰¤ 2ğ‘›âˆ’1.
(cid:19) |ğ‘†3(ğœ) |
(cid:18)
|ğ‘†3(ğœ) |âˆ’1
ğ‘—=0
â‰¥ 1 âˆ’ |ğ‘†3(ğœ)|
2ğ‘¡âˆ’1 â‰¥ 1 âˆ’ ğ‘ğ‘£
(cid:18)
(cid:19)
1 âˆ’ 1
2ğ‘¡âˆ’1
2ğ‘¡âˆ’1 = 1 âˆ’ 2ğ‘ğ‘£
2ğ‘¡ .
1 âˆ’ 2ğ‘›âˆ’ğ‘¡
2ğ‘›âˆ’1
=
(9)
B.2 Proofs of Bad Transcript Probabilities
In this subsection, we bound the probabilities of the six sets of Bad
transcripts in the ideal world through Lemma B.2â€“B.7. However,
we first give a corollary of our balls-into-bins theorem to simplify
its application to our lemmas.
Recall that all the transcripts are generated by a valid nonce-
respecting adversary A that is ğ‘‘-repeating. We also recall here that
in the ideal world, the keys ğ¾ğ‘– are uniformly sampled at the end
of the execution, during the last oracle query to Reveal, and are
therefore independent of any other previous queries. Moreover, in
the ideal world, all the ğ‘‰ğ‘— values are independent and uniformly
distributed. As for ğ‘‰0 = (ğ‘Ÿâˆ¥(ğ‘‡ (ğ‘¡)âˆ’ ğ»ğ‘Ÿ (ğ´ğ·, ğ¶))âˆ¥ğ‘Š ), the values ğ‘Ÿ, ğ‘‡
and ğ‘Š are uniformly distributed, for ğ‘‰ğ‘— = (ğ‘€ğ‘— âŠ• ğ¶ ğ‘—), the value ğ¶ ğ‘—
is uniformly distributed and for ğ‘‰â„“ = ((ğ‘€â„“ âŠ• ğ¶â„“)âˆ¥ğ‘Š â€²), the values
ğ¶â„“ and ğ‘Š â€² are uniformly distributed.
To simplify notations in the following, we denote by [ğ‘¤]ğ¾+ the
key part of a ğ‘›-bit string ğ‘¤, i.e. ğ‘¤[|ğ‘| + 1:|ğ‘| + ğ‘˜] and by [ğ‘¤]ğ¾- the
remaining part of the string, i.e. ğ‘¤[1:|ğ‘|] âˆ¥ ğ‘¤[|ğ‘|+ğ‘˜ +1:ğ‘›]. We also
denote by [ğ‘¤]ğ‘Ÿ the part of a ğ‘›-bit string ğ‘¤ that corresponds to the
hash key ğ‘Ÿ, i.e. ğ‘¤[1:ğ‘¡] and by [ğ‘¤]ğ‘  the part that corresponds to the
blinding value ğ‘  of the string, i.e. ğ‘¤[ğ‘¡ + 1:2ğ‘¡].
B.2.1 Balls-Into-Bins Corollary. The following lemma is a direct
corollary of our balls-into-bins theorem. It will be used below to
bound bad transcript probabilities, specifically in Lemmas B.3, B.6,
and B.7. To simplify the computed bounds, we apply our gener-
alized balls-into-bins theorem in the proof of the lemma only for
a bounded number of balls. It should be noted that we could lift
some of the restrictions on the number of queries in Theorem 6.1
and 7.8 by considering an unrestricted number of balls, however at
the expense of a more complicated bound.
3
(cid:109)
max(1,log2((ğ‘„ğµ)âˆ’1))
Lemma B.1. Consider the experiment where we throw balls into
bins and where each throw may be dependent on the previous ones.
Let ğ‘„ âˆˆ N be the maximum number of balls we throw and ğµ âˆˆ ]0, 1]
be an upper bound on the probability that, when conditioning on
the result of the prior throws, a ball is placed into a specific bin. If
ğ‘„ â‰¤ ğµâˆ’1 Â· log2(ğµâˆ’1)
, the probability that the heaviest bin contains
2 log2(ğµâˆ’1)
ğ‘š =
(cid:108)
(cid:101)ğ‘š = logğ‘¡ (ğµâˆ’1) and ğ‘„ â‰¤ ğµâˆ’1 Â· log2(ğµâˆ’1)
(cid:6)2 log2(ğµâˆ’1)(cid:7).
Proof. We simply apply the Case 4 of Theorem 5.1, with ğ‘¡ = 2,
â–¡
Note that compared to [10, Lemma 11], our maximum load ğ‘š
can be smaller than log2(ğµâˆ’1), and compared to [10, Lemma 10],
our maximal number of queries can be bigger than ğµâˆ’1 (when
log2(ğµâˆ’1)
> 1) and our maximum load ğ‘š is always smaller than
or more balls is at most ğµ.
3
3
.
B.2.2 Bounding Bad1 transcripts probability.
Lemma B.2 (Bad1).
Pr[Tideal âˆˆ Bad1] â‰¤ ğ‘ğ‘‘
2ğ‘˜
.
Proof. Bad1 is the set of all attainable transcripts ğœ that contain
two entries (prim, ğ‘¥, ğ‘¦, Â·) and (enc, ğ‘–, ğ‘ , ğ´ğ·, ğ‘€, ğ¶âˆ¥ğ‘‡ , ğ‘‰0âˆ¥ Â· Â· Â· âˆ¥ğ‘‰â„“)
such that ğ‘¥ âˆˆ {ğ‘âˆ¥ğ¾âˆ¥0âˆ¥ğ‘ , . . . , ğ‘âˆ¥ğ¾âˆ¥â„“âˆ¥ğ‘} and ğ¾ğ‘– = ğ¾.
If a transcript generated by the adversary A in the ideal aug-
mented game is in Bad1, then A has made an encryption query
Enc(ğ‘–, ğ‘ , ğ´ğ·, ğ‘€) and either a query Prim(ğ‘âˆ¥ğ¾âˆ¥ Â· âˆ¥ğ‘) or a query
Primâˆ’1(ğ‘¦) with answer ğ‘âˆ¥ğ¾âˆ¥Â·âˆ¥ğ‘ , and finally a query to Reveal
that returned the key ğ¾ğ‘– to be equal to ğ¾. Hence the probability
that a transcript generated by A in the ideal augmented game is in
Bad1 is bounded by the probability that A makes the previously
described queries.
We are going to consider the case where A is just about to query
Reveal, but has already made all its other oracle queries. For
each of the at most ğ‘ ideal permutation queries Prim(ğ‘âˆ¥ğ¾âˆ¥ Â· âˆ¥ğ‘)
or Primâˆ’1(ğ‘¦) with answer ğ‘âˆ¥ğ¾âˆ¥ Â· âˆ¥ğ‘ done by A, there are at
most ğ‘‘ encryption queries Enc(ğ‘–, ğ‘ â€², ğ´ğ·, ğ‘€) with ğ‘ â€² = ğ‘ done
Session 6D: Authentication and Privacy CCS â€™21, November 15â€“19, 2021, Virtual Event, Republic of Korea1996by A. Thus there are at most ğ‘ğ‘‘ possible pairs of such queries
done by A. When querying Reveal, for each of these pairs, the
probability that ğ¾ğ‘– = ğ¾ is 1
2ğ‘˜ , as the keys are uniformly sampled,
independently from any previous queries. Hence, using a union
bound, the probability that for at least one of these pairs ğ¾ğ‘– = ğ¾, is
at most ğ‘ğ‘‘
2ğ‘˜ . Thus,
â–¡
.
Pr[Tideal âˆˆ Bad1] â‰¤ ğ‘ğ‘‘
2ğ‘˜
B.2.3 Bounding Bad2 transcripts probability.
.
Lemma B.3 (Bad2).
2ğ‘˜
+ 1