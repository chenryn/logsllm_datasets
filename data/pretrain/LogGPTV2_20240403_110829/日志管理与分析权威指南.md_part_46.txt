用日志管理工具构建一个初始基线
，因此可以使用它分类这条消息。但是，其他消息包含短句“Error getting object
，我们可以接受如上报告，作为“例行运营”基线
第16章日志管理规程217
---
## Page 239
218
息类型（Chuvakin，日期不详）。
有日志记录设备的报告来完成这一步。
步介绍如何完成这种调查。
应该标记出来（Complete PCI DSS Log ReviewProceduresPart 8，2011)。
天内记录的某些日志消息也可能触发某种行动或者补救措施。这样的消息称为“已知错误”，
的消息计数来完成。
这一步通过比较工具里的消息计数（例如上面显示日志消息计数的报告）和原始日志中
6）创建基线的同时应该执行一个附加步骤：即使我们断定卡数据没有遭到入侵，在90
6）创建基线的同时应该执行一个附加步骤：即使我们断定卡数据没有遭到人侵，在90
在第一次日志审核期间，接受其作为正常基线之前可能有必要调查一些日志事件。下一
3）为初始基线选择一个时间周期：“90天”或者在日志收集不到90天时“全时”。
2）确定工具能够“理解”（解析、标记等）消息，并标识每个日志的“事件ID”或者消
表16.2表明必要的收集已执行。
在这一步中，我们观察日志管理工具，验证来自PCI应用程序的日志。可以通过查看所
让我们来看一个上述策略的完整示例：
5）如果没有发现任何卡数据泄露，
注：时限为2009年1月1日~3月31日（90天）
表16.3中的报告指出系统运营90天内遇到的所有日志类型。
4）运行一个报告，显示每个消息类型的计数。例如，如表16.3所示的报告。
在这个例子中，因为有足够的可用日志，我们选择90天。
注：时限为2009年1月1日~3月31日（90天）
1）确保日志管理工具收集PCI应用程序中的相关日志。
TABS
TOPPS
CEMS
Windows2003
事件ID
Windows2003
550
1517
设备类型
用户证书218更新
登录成功
登录失败
注册表故障
表16.3显示消息类型计数的报告
表16.2所有日志记录设备的报告
事件描述
，我们可以接受如上报告，作为“例行运营”基线。
Tabs
Topps1server
CEMS1
Winserver2
Winserverl
设备名称
计数
忆
212
日志消息数
3334444
566
53445
215756
215762
平均计数/天
2
2.3
---
## Page 240
消息，在每日审核过程中应该首先观察：
误”，应该标记出来（Complete PCI DSS Log ReviewProcedures Part8，2011)。
DSS Log ReviewProceduresPart 8,2011)。
最早的日志时间戳确定这一点（Complete PCIDSS Log ReviewProcedures Part8，2011）。
志管理工具的情况下人工构建基线。为此，执行如下步骤（CompletePCIDSSLogReview
（内存耗尽）可能代表着一个潜在的严重问题，因此需要按照下面介绍的调查规程进行调查。
的日志记录在90天中只发生了一次。这种罕见的事件至少应该引起人们的兴趣；消息的描述
误”，应该标记出来（Complete PCIDSS Log ReviewProcedures Part 8，2011)。
天内记录的某些日志消息也可能触发某种行动或者补救措施。这样的消息被称作“已知错
天内记录的某些日志消息也可能触发某种行动或者补救措施。这样的消息被称作“已知错
CompletePCI DSSLogReviewProceduresPart 8,2011)。
据量很大的情况下不可能；CompletePCIDSSLogReviewProceduresPart8，2011）。
ProceduresPart8,2011):
16.6.3
6）创建基线的同时应该执行一个附加步骤：即使我们断定卡数据没有遭到入侵，在90
5）如果没有发现任何卡数据泄露，我们可以接受如上报告，作为“例行运营”基线
4）人工创建所有观测类型的摘要；如果现实的话，收集每条消息出现的次数（在日志数
3）从最旧的日志条目开始审核，直到最新的条目，尝试识别它们的类型（CompletePCI
1）确保来自PCI应用程序的相关日志保存在某个位置。
在日志不兼容可用工具或者可用工具不能很好地理解日志数据时，必须在不使用日
下面是创建基线的过程中将某些消息标记为“已知错误”的粗略原则。如果生成了这些
2）为初始基线选择一个时间周期：“90天”或者在日志收集不到90天时“全时”；检查
人工创建一个基线是可能的，但是较为复杂。我们将在下一小节探索这一任务。
在这个报告中，我们注意到最后一行事件ID=666的日志记录，事件名称为“内存耗尽”
90天摘要中的某些日志实际上表示问题发生，需要调查（见表16.4）。
确定“已知错误”消息的原则
事件ID
666
1517
人工构建初始基线
内存耗尽
用户证书更新
登录成功
登录失败
注册表故障
事件描述
表16.490天摘要报告
计数
忆
200
212
2
平均计数/天
N/A
第16章日志管理规程219
正常或者“错误”
行动：重启系统
---
## Page 241
220
累的基线相比较。
和过去调查中了解到的情况进行扩展。
用，而不仅仅适用于日志记录。随着时间的推移，
通常至少是令人感兴趣的。）
16.6.4
的准确性，这也需要创建一个基线。但是，
这是日志审核中非常核心的部分一
2）发生在更改窗口之外的证书和权限修改日志消息。
1）在不寻常的时间发生的登录和其他“授权访问”日志消息。（从技术上说，为了更高
遵循这个模型的每日工作流程如图16.5所示。
构建初始基线之后，我们就可以开始每天日志审核。
正如我们所看到的，这个列表对于创建“以近乎实时的方式监控什么？”的策略非常有
5）在备份窗口（如果作了定义）之外进行的数据备份／导出。
4）维护窗口（如果作了定义）之外的重启消息。
3）到期的用户账户生成的任何日志消息。
10）与安全策略违规明显相关的其他日志。
9）在过去触发了任何行动（系统配置、调查等等）的日志消息。
8）系统或者应用程序日志记录配置的任何变更。
7）系统或者应用程序日志记录终止。
日志数据删除。
主要工作流程：每天日志审核
事故响应工作流程
遵循每日基线
验证影响
常规条目：
个
图16.5
（错误）（正常）
单独日志条目审核
坏
一将最后一天产生的日志（每日审核的情况下）与积
基线之外的条目：
，发生在业务时间（在正确的时区中）之外的登录
日常工作流程
未知状态
好
调查
，该列表应该根据本地应用程序日志的知识
（没有升级到事故）
（分析之后）
升级调查
未知
已知管务目：
问题的指示
不需要任何措施
---
## Page 242
现就成为调查的理由。如果确定该消
其有效：只注意生成的新日志消息类
考虑之前没有观测到的日志类型，
审核—根据可用资源和使用的工具作出选择，如图16.6所示。
的列表包含了日志审核执行频率低于每天一次的某些理由：
相同原则，批准你采用较低的日志审核频率。批准较低的日志审核频率需要什么理由？下面
规程每天进行（AntonChuvakin博士的博客，2011）。只有QSA可以根据用于补偿性控制的
频率的问题。
息是正常的，不会触发任何行动，以后可以将其添加到基线中。
却从未出现，这种日志消息的每次出
每天都大量产生，但是ID为8的日志
客，2011)。
从性和运营（AntonChuvakin博士的博
型，通常非常有助于深人了解安全、依
它很简单，
人工进行，
在这两种方法中，第一种方法只
例如，如果ID为1-7的日志消息
■应用程序或者系统没有每天生成日志。如果日志记录没有每天添加，就没有必要每天
PCIDSS需求10.6明确规定，
该图总结了执行每天日志审核的日志分析人员的行为。在继续之前，必须处理日志审核
■应用程序没有处理或者存储信用卡数据；只因为直接连接而被列入范围（Anton
定期日志审核的频率
■基本方法：
如何真正地将今天的日志批次与基线比较？可以采用两种方法，它们都广泛地用于日志
记住，只有你的QSA的意见有约束力，其他人都没有！
■高级方法：
每天日志审核的比较方法总结如下：
Chuvakin，2011）。
进行日志审核。
日志审核使用以批模式收集日志的日志管理系统，日志批次到达频率低于每天一次。
■比基线中出现频率更高的日志类型
前所未见的日志类型(新日志消息类型)。
■前所未见的日志类型（新日志消息类型)。
但是对于许多日志类型却极
，也可以使用工具进行。尽管
，可以