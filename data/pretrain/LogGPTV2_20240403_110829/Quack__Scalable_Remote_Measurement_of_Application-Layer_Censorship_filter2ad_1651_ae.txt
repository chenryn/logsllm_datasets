show a tendency to select domains from the most popular.
Countries demonstrating the tendency to block popular
domains with greater frequency are China, Egypt, and
Turkey, with the strongest trend being that of Turkey.
This may reﬂect a reactive blocking strategy, in which
domains are added to a blacklist when they are detected
to be visited with some frequency by citizens.
While the Alexa Top 100k experiment is only one snap-
shot of the state of application-layer censorship taking
place on HTTP and HTTPS, we believe that it demon-
strates the ﬂexibility and accuracy of our tool. In the
future, it can be used to contribute valuable data to many
diverse, longitudinal, and in-depth studies of application-
layer censorship.
7 Discussion
This paper has proposed and validated a technique
for measuring application-layer interference around the
world. In this section, we discuss the limitations of the
design and what additional research our tool enables.
Limitations Our system currently relies on echo servers
to gain perspective into remote client experiences of the
Internet. Existing remote measurement techniques can be
detected and invalidated or blocked by middleboxes, and
ours is no exception.
First, the censor could block all trafﬁc through port 7.
We have no information about who or what else might
be using port 7 today, so we have very little idea of how
much collateral damage blocking port 7 would cause. For-
tunately, our system is not dependent on using the Echo
Protocol speciﬁcally; there are several other protocols
that offer an echo service, such as FTP, Telnet, and TLS.
These other protocols would be much more difﬁcult to
block entirely, as they are used much more widely on the
Internet. Many of these alternates do have the disadvan-
tage of requiring a protocol-speciﬁc header, which may
cause some middleboxes to stop responding to our probes.
Second, the censor could block our measurement ma-
chine by IP. One of the greatest advantages of our system
is that it is portable; the measurements can be run from
virtually any machine around the world. This means that
any IP-based ﬁltering of our measurements would likely
be unsuccessful, as we could quickly and easily deploy in
another location.
Figure 15: Blocking by Alexa Rank—The distributions of
blocked domains relative to their Alexa rank varies by country.
Egypt, Turkey, and China demonstrate a clear trend of blocking
lower-ranked domains at a higher frequency. In contrast, Iran
has a near uniform distribution of blocking across Alexa ranks.
USENIX Association
27th USENIX Security Symposium    199
020000400006000080000100000AlexaRank0.00.20.40.60.81.0FractionofBlockedDomainsSaudiArabiaRepublicofKoreaEgyptThailandIranTurkeyChinaFinally, a censor could watch for the direction a connec-
tion and block only connections originating from inside
their network. However, such a policy would not prevent
services pushing data to clients, as can occur in FTP. In
practice, we are not aware of directional blocking of this
nature, potentially because the complexity of AS peering
blurs the distinction of internal and external networks at a
nation-state level.
However, both distributed and remote censorship mea-
surement systems in use today are differentiable and dis-
ruptable. Even if some censors decide to disrupt measure-
ments, we will continue to have visibility into the rest of
the world.
Another limitation is the difﬁculty of detecting coun-
tries with heterogeneous deployments of keyword block-
ing, because in this work we considered only widespread
blocking. Future work can remove our ﬁnal Classify-
ing Interference step, and instead combine the raw data
with that of other network disruption measurement tech-
niques [34, 35] to increase the granularity of observations.
Another limitation of the measurements conducted in
this study, but not to our technique in general is that
we have false negatives where DPI boxes monitor only
port 80 and port 443 for web trafﬁc. We could have
conducted all of our experiments with our client port
set to the appropriate well-known port for the protocol
we would measure; however, we believed the trade-off
was best to follow the best common practice and use an
ephemeral port for our client connections.
One consideration in using this work for global de-
tection is that there are only on average 177 countries
with echo servers, and only 74 with at least 15 vantage
points. One potential way to increase the number of van-
tage points is to send our formatted requests to any server
that accepts packets. For example, this could be done
for HTTP by using all web servers. Then we would dif-
ferentiate between the web server’s error result and the
interference behavior by country. However, this removes
our ability to detect disruption that only inspects outbound
packets from the network. Based on what we have ob-
served in Section 6.3, this is a signiﬁcant number of the
countries that perform application-layer interference.
Finally, our work makes a trade-off to detecting cen-
sorship that is observed in multiple vantage points within
each country, but this comes at the price of reduced gran-
ularity of observation. This means we will not regularly
observe censorship that is heterogeneously implemented
within a given country, and will not be able to reliably
observe particular ISP policies.
Future Work This paper describes a new and useful
technique that can be used to remotely measure network
disruptions due to application-layer blocking. Disrup-
tion detection techniques can monitor DNS poisoning,
IP-based blocking, and now application-layer censorship.
When combined, these perspectives could produce valu-
able datasets for political scientists, activists, and other
members of the Internet freedom community. Addition-
ally, these remote measurement techniques complement
in-country probes, such as OONI, in order to provide
baselines and focus effort.
The system presented here is capable of continuous
measurement. Rather than regularly running a large batch
of keywords, such as the Alexa list, a different optimiza-
tion would cycle through a set of interesting domains in
each country at a reduced rate. This would enable longitu-
dinal tracking of those domains, and help illuminate how
and when application-layer censorship policies change.
Quack also stands to provide interesting insight into
censorship of other application-layer data and can be gen-
eralized to use other protocols’ echo behavior. While
we only focus on HTTP and HTTPS in this paper, the
Echo protocol’s ability to send and receive arbitrary data
could be used to explore interference in other areas, such
as the mobile web and app ecosystems. Additionally,
future work can be performed to use protocols other
than the echo protocol. This would improve coverage
of application-layer blocking measurement.
8 Conclusion
Application-layer interference is broadly deployed today,
critically limiting Internet freedom. Unlike other tech-
niques for censorship, we have not previously had broad
and detailed visibility into its deployment. In this pa-
per, we introduced Quack, a new system for remotely
detecting application-layer interference at global scale,
utilizing servers already deployed on the Internet, with-
out the need to enlist volunteers to run network probes.
We hope that this new approach will help close an im-
portant gap in censorship monitoring and move us closer
to having transparency and accountability for network
interference worldwide.
Acknowledgments
The authors are grateful to Bill Marczak and Adam Bates
for insightful discussions, and to the anonymous review-
ers for their constructive feedback. This material is based
upon work supported by the U.S. National Science Foun-
dation under grants CNS-1409505, CNS-1518888, and
CNS-1755841, and by a Google Faculty Research Award.
References
[1] S. Afroz and D. Fiﬁeld. Timeline of Tor censorship, 2007. http://
www1.icsi.berkeley.edu/~sadia/tor_timeline.pdf.
200    27th USENIX Security Symposium
USENIX Association
[2] Alexa Internet, Inc. Alexa Top 1,000,000 Sites.
amazonaws.com/alexa-static/top-1m.csv.zip.
http://s3.
[3] Anonymous. Towards a comprehensive picture of the Great Fire-
wall’s DNS censorship. In Free and Open Communications on the
Internet (FOCI). USENIX, 2014.
[4] S. Aryan, H. Aryan, and J. A. Halderman. Internet censorship
in Iran: A ﬁrst look. In Free and Open Communications on the
Internet (FOCI). USENIX, 2013.
[5] H. Asghari, M. Van Eeten, and M. Mueller. Unraveling the eco-
nomic and political drivers of deep packet inspection. In GigaNet
7th Annual Symposium, 2012.
[6] S. Burnett and N. Feamster. Encore: Lightweight measurement of
web censorship with cross-origin requests. In ACM SIGCOMM
Conference, pages 653–667, 2015.
[7] A. Chaabane, T. Chen, M. Cunche, E. D. Cristofaro, A. Friedman,
and M. A. Kaafar. Censorship in the wild: Analyzing Internet
ﬁltering in Syria. In Internet Measurement Conference (IMC).
ACM, 2014.
[8] Citizen Lab. Block test list. https://github.com/citizenlab/test-lists.
[9] R. Clayton, S. J. Murdoch, and R. N. M. Watson. Ignoring the
In Privacy Enhancing Technologies
Great Firewall of China.
(PETS), Cambridge, England, 2006. Springer.
[10] J. R. Crandall, M. Crete-Nishihata, J. Knockel, S. McKune,
A. Senft, D. Tseng, and G. Wiseman. Chat program censorship
and surveillance in China: Tracking TOM-Skype and Sina UC.
First Monday, 18(7), 2013.
[11] J. R. Crandall, D. Zinn, M. Byrd, E. T. Barr, and R. East. Con-
ceptDoppler: A weather tracker for Internet censorship. In ACM
Conference on Computer and Communications Security, pages
352–365, 2007.
[12] J. Dalek, B. Haselton, H. Noman, A. Senft, M. Crete-Nishihata,
P. Gill, and R. J. Deibert. A method for identifying and conﬁrming
In Internet
the use of URL ﬁltering products for censorship.
Measurement Conference (IMC). ACM, 2013.
[13] D. Dittrich and E. Kenneally. The Menlo Report: Ethical princi-
ples guiding information and communication technology research.
Technical report, U.S. Department of Homeland Security, 2012.
[14] L. Dixon, T. Ristenpart, and T. Shrimpton. Network trafﬁc ob-
fuscation and automated Internet censorship. IEEE Security &
Privacy, 14(6):43–53, Nov.–Dec. 2016.
[15] Z. Durumeric, E. Wustrow, and J. A. Halderman. ZMap: Fast
In 22nd
internet-wide scanning and its security applications.
USENIX Security Symposium, pages 605–620, 2013.
[16] D. Eastlake 3rd. Transport layer security (TLS) extensions: Ex-
tension deﬁnitions. RFC 6066, Jan. 2011.
[17] R. Ensaﬁ, J. Knockel, G. Alexander, and J. R. Crandall. Detecting
intentional packet drops on the Internet via TCP/IP side chan-
nels. In International Conference on Passive and Active Network
Measurement, pages 109–118. Springer, 2014.
[18] R. Ensaﬁ, P. Winter, A. Mueen, and J. R. Crandall. Analyzing
the Great Firewall of China over space and time. Proceedings on
Privacy Enhancing Technologies, 2015.
[19] A. Filastò and J. Appelbaum. OONI: Open Observatory of Net-
work Interference. In 2nd USENIX Workshop on Free and Open
Communications on the Internet (FOCI), 2012.
[20] FortiNet. Fortiguard labs web ﬁlter. https://fortiguard.com/
webﬁlter.
[21] Freedom House. Freedom on the net 2016, November 2016.
[22] K. Fu, C. Chan, and M. Chau. Assessing censorship on microblogs
in China: Discriminatory keyword analysis and the real-name
registration policy. IEEE Internet Computing, 17(3):42–50, 2013.
[23] G. Gebhart and T. Kohno. Internet censorship in Thailand: User
practices and potential threats. In IEEE European Symposium on
Security and Privacy (EuroS&P), 2017.
[24] D. Gueorguiev, L. Shao, and C. Crabtree. Blurring the lines:
Rethinking censorship under autocracy. 2017.
[25] B. Jones, R. Ensaﬁ, N. Feamster, V. Paxson, and N. Weaver. Eth-
ical concerns for censorship measurement. In ACM SIGCOMM
Conference, pages 17–19, 2015.
[26] B. Jones, T.-W. Lee, N. Feamster, and P. Gill. Automated de-
tection and ﬁngerprinting of censorship block pages. In Internet
Measurement Conference (IMC). ACM, 2014.
[27] J. Knockel, J. R. Crandall, and J. Saia. Three researchers, ﬁve
conjectures: An empirical analysis of TOM-Skype censorship and
surveillance. In FOCI, 2011.
[28] R. MacKinnon. China’s censorship 2.0: How companies censor
bloggers. First Monday, 14(2), 2009.
[29] MaxMind. https://www.maxmind.com/.
[30] National Commission for the Protection of Human Subjects of
Biomedical and Behavioral Research. The Belmont Report: Ethi-
cal Principles and Guidelines for the Protection of Human Sub-
jects of Research. 1978.
[31] OpenNet Initiative. Jordan, August 2009. https://opennet.net/
research/proﬁles/jordan.
[32] OpenNet Initiative. South Korea, August 2012. https://opennet.
net/research/proﬁles/south-korea.
[33] C. Partridge and M. Allman. Addressing ethical considerations in
network measurement papers. In Workshop on Ethics in Networked
Systems Research (NS Ethics@ SIGCOMM), 2015.
[34] P. Pearce, R. Ensaﬁ, F. Li, N. Feamster, and V. Paxson. Augur:
Internet-wide detection of connectivity disruptions. In IEEE Sym-
posium on Security and Privacy, May 2017.
[35] P. Pearce, B. Jones, F. Li, R. Ensaﬁ, N. Feamster, N. Weaver, and
In 26th
V. Paxson. Global measurement of DNS censorship.
USENIX Security Symposium, Aug. 2017.
[36] J. Postel. Discard protocol. RFC 863, May 1983.
[37] J. Postel. Echo protocol. RFC 862, May 1983.
[38] J. Postel and J. Reynolds. Telnet echo option. RFC 857, 1983.
[39] University of Oregon Route Views Project. www.routeviews.org.
[40] M. J. Salganik. Bit by Bit: Social Research in the Digital Age.
Princeton University Press, 2017.
[41] W. Scott, T. Anderson, T. Kohno, and A. Krishnamurthy. Satellite:
Joint analysis of CDNs and network-level interference. In USENIX
Annual Technical Conference (ATC), pages 195–208, 2016.
[42] R. Seggelmann, M. Tuexen, and M. Williams. Transport layer
security (TLS) and datagram transport layer security (DTLS) heart-
beat extension. RFC 6520, Feb. 2012.
[43] D. Springall, Z. Durumeric, and J. A. Halderman. FTP: The forgot-
ten cloud. In IEEE/IFIP International Conference on Dependable
Systems and Networks (DSN), pages 503–513, June 2016.
[44] The Tor Project. OONI: Open observatory of network interference.
https://ooni.torproject.org/.
[45] United States Department of State. Ghana 2016 human rights re-
port, 2016. http://www.state.gov/j/drl/rls/hrrpt/humanrightsreport/
index.htm?year=2016&dlid=265260.
[46] P. Winter and S. Lindskog. How the Great Firewall of China is
blocking Tor. In Free and Open Communications on the Internet
(FOCI). USENIX, 2012.
[47] X. Xu, Z. M. Mao, and J. A. Halderman. Internet censorship in
China: Where does the ﬁltering occur? In Intl. Conference on
Passive and Active Measurement (PAM), pages 133–142, 2011.
[48] T. Zhu, D. Phipps, A. Pridgen, J. R. Crandall, and D. S. Wallach.
The velocity of censorship: High-ﬁdelity detection of microblog
post deletions. In USENIX Security Symposium, pages 227–240,
2013.
[49] J. Zittrain and B. Edelman.
Internet ﬁltering in China.
Internet Computing, 7(2):70–77, 2003.
IEEE
USENIX Association
27th USENIX Security Symposium    201
Appendix
Countries Tested Our test of all Citizen Lab domains
completed against at least 15 servers in these countries:
Domain Classiﬁcations Below are the deﬁnitions for
website classes as speciﬁed by the CLBL [8]:
Argentina, Australia, Austria, Bangladesh, Belarus, Belgium,
Bolivia, Brazil, Bulgaria, Canada, Chile, China, Colombia, Croa-
tia, Czechia, Denmark, Ecuador, Egypt, Finland, France, Geor-
gia, Germany, Ghana, Greece, Hashemite Kingdom of Jordan,
Hong Kong, Hungary, India, Indonesia, Iran, Ireland, Israel,
Italy, Japan, Kazakhstan, Kenya, Kuwait, Malaysia, Mexico,
Mongolia, Montenegro, Netherlands, New Zealand, Nigeria,
Norway, Pakistan, Panama, Peru, Philippines, Poland, Portu-
gal, Republic of Korea, Romania, Russia, Saudi Arabia, Serbia,
Singapore, Slovak Republic, Slovenia, South Africa, Spain, Swe-
den, Switzerland, Taiwan, Thailand, Tunisia, Turkey, Ukraine,
United Arab Emirates, United Kingdom, United States, Uzbek-
istan, Venezuela, and Vietnam.
Class
ANON
COMT
DATE
FILE
GMB
GRP
HACK
LGBT
MISC
MMED
NEWS
POLR
PORN
SRCH
Deﬁnition
Tools used for anonymization, circumvention
Individual and group communications tools
Online dating services
Tools used to share ﬁles
Online gambling sites
Social networking tools and platforms
Sites dedicated to computer security
Gay-lesbian-bisexual-transgender queer issues
Miscellaneous
Video, audio or photo sharing platforms
Major, regional, and independent news outlets
Content that offers critical political viewpoints
Hard-core and soft-core pornography
Search engines and portals
202    27th USENIX Security Symposium
USENIX Association