### 网络接口信息

- **接口名称:** Intel(R) PRO/1000 MT Network Connection
- **MAC 地址:** 00:0c:29:4a:a5:c6
- **MTU:** 1500
- **IPv4 地址:** 192.168.46.129
- **子网掩码:** 255.255.255.0
- **IPv6 地址:** fe80::708e:65lc:d242:ab41
- **IPv6 子网掩码:** ffff:ffff:ffff:ffff::
- **接口编号:** 12

---

- **接口名称:** Microsoft ISATAP Adapter
- **MAC 地址:** 00:00:00:00:00:00
- **MTU:** 1280
- **接口编号:** 13

---

- **接口名称:** Teredo Tunneling Pseudo-Interface
- **MAC 地址:** 00:00:00:00:00:00
- **MTU:** 1280
- **IPv6 地址:** 2001:0:da44:fa75:180c:2a4:3f57:dl7e
- **IPv6 子网掩码:** ffff:ffff:ffff:ffff::fe80::180c:2a4:3f57:dl7e

### 攻击框架和技术

#### 一、利用公开漏洞
通过利用软件、数据库、中间件或第三方库中的已知漏洞，攻击者可以对未及时修补或升级的信息系统进行攻击。

**公开漏洞来源：**
1. CVE、CNVD、CNNVD、exploit-db 等漏洞库
2. QQ群、推特、社区、论坛等社交平台
3. GitHub

#### 二、外部远程服务
远程服务如VPN、Citrix等允许用户从外部位置连接到内部企业网络资源。通常有远程服务网关来管理这些服务的连接和凭证验证。Windows远程管理等服务也可以在外部使用。通常需要访问有效帐户来使用该服务，这可以通过凭证嫁接或在危及企业网络后从用户处获得凭证来实现。

**远程服务示例：**
- VPN
- Citrix
- SSH
- Windows 远程桌面
- TeamViewer
- EasyConnect

#### 三、渗透到其他网络介质
如果命令和控制网络是有线互联网连接，则可以通过WiFi、调制解调器、蜂窝数据连接、蓝牙或其他射频（RF）信道进行泄漏。如果攻击者具有足够的访问权限或接近度，则可以选择执行此操作，并且可能无法保护或保护连接以及主要的互联网连接通道，因为它不通过同一企业网络路由。

#### 四、硬件攻击
计算机附件或网络硬件可以作为矢量引入系统以获得执行。虽然APT组使用的公开参考很少，但许多渗透测试人员利用硬件添加进行初始访问。商业和开源产品的功能包括被动网络窃听、中间人加密破解、击键注入等。

**可添加的硬件：**
- U盘
- 鼠标
- 键盘
- 硬盘
- 智能设备
- 摄像头
- 打印机
- USB 数据线
- Pineapple

**案例：**
- [通过一根数据线控制你的苹果电脑](http://mg.lol/blog/defcon-2019/)
- DemonSeed 恶意USB数据线: [GitHub](https://github.com/O-MG/DemonSeed)

#### 五、通过可移动媒体进行复制
通过将恶意软件复制到可移动媒体并在插入系统时利用自动运行功能，攻击者可以进入系统，尤其是在断开连接或气隙网络上的系统。这可以通过修改存储在可移动媒体上的可执行文件或通过复制恶意软件并将其重命名为合法文件来欺骗用户执行它来实现。

**可移动媒体示例：**
- BadUSB
- 光碟

#### 六、鱼叉式钓鱼附件
鱼叉式钓鱼附件是鱼叉式钓鱼的一种特殊变体，发送带有恶意软件的附件。所有形式的鱼叉式网络钓鱼都是针对特定个人、公司或行业的社会工程。打开附件后，攻击者的有效负载会利用漏洞或直接在用户的系统上执行。

**附件类型：**
- Microsoft Office 文档
- 可执行文件
- PDF
- 存档文件

#### 七、鱼叉式钓鱼链接
带链接的鱼叉式网页钓鱼是鱼叉式网页钓鱼的一种特殊变种。它使用链接来下载电子邮件中包含的恶意软件，而不是将恶意文件附加到电子邮件本身，以避免可能检查电子邮件附件的防御。

**链接类型：**
- 包含社会工程文本的链接
- 要求用户主动点击或复制粘贴URL
- 利用Web浏览器漏洞
- 提示用户下载应用程序、文档、zip文件或可执行文件

#### 八、通过服务进行鱼叉式网络钓鱼
通过服务进行的鱼叉式网络钓鱼是鱼叉式钓鱼的一种特殊变种，使用第三方服务而不是直接通过企业电子邮件渠道。攻击者通过各种社交媒体服务、个人网络邮件和其他非企业控制的服务发送消息。

**常见例子：**
- 通过社交媒体与目标建立融洽关系
- 发送潜在工作机会的信息
- 通过这些服务发送恶意链接或附件

#### 九、供应链妥协
供应链妥协是指最终消费者在收到数据或系统损害之前对产品或产品交付机制的操纵。供应链的妥协可以在供应链的任何阶段进行，包括开发工具、开发环境、源代码存储库等。

**供应链妥协示例：**
- 操纵开发工具
- 操纵开发环境
- 操作源代码存储库（公共或私有）
- 在开源依赖中操作源代码
- 操纵软件更新/分发机制
- 受损/受感染的系统映像
- 用修改版本替换合法软件
- 向合法分销商销售改装/假冒产品
- 装运拦截

#### 十、利用可靠关系
攻击者可能会破坏或以其他方式利用能够接触到目标受害者的组织。通过可信的第三方关系访问利用现有的连接，与访问网络的标准机制相比，该连接可能不受保护，或者受到的审查较少。

**组织示例：**
- IT 服务承包商
- 托管安全供应商
- 基础设施承包商（例如HVAC、电梯、物理安全）

#### 十一、利用合法帐号
攻击者可以使用凭据访问技术窃取特定用户或服务帐户的凭据，或者通过社会工程在其侦察过程中更早地捕获凭据，以获得初始访问权。

**帐户类型：**
- 默认帐户
- 本地帐户
- 域帐户

**默认帐户示例：**
- Windows 系统上的访客或管理员帐户
- 网络设备和计算机应用程序的预置帐户

#### 十二、近距离通讯攻击
通过利用目标存在的近距离通讯（如WIFI、蓝牙、ZigBee、NFC、RFID等）来进行攻击。利用这些通信方式中的弱点，如加密算法问题、认证机制简单等，进行窃听和攻击。

#### 十三、未知漏洞攻击
通过模糊测试（Fuzzing）寻找未知漏洞，并利用这些漏洞进行攻击。

**可攻击点：**
- Web网站
- 服务器
- 协议
- 硬件

### 执行示例

#### 环境
- **攻击机A:** Kali (IP: 10.100.18.20)
- **被攻击机:** Windows 2012 R2 (IP: 10.100.18.21)

#### 攻击手法
1. **创建一个Empire Listener监听线程**
   - 查看设置信息
   - 开始监听
2. **生成将在目标受害机器上执行的PowerShell代码**
   - 复制PowerShell脚本并另存为一个文件
   - 将其部署于某个Web服务器中
3. **新建一个Word文档**
   - 添加域代码
   - 插入PowerShell代码
   - 保存文档并发送给目标受害者
4. **等待受害者打开文档并点击错误提示**
   - 反弹回一个Empire的控制连接，对受害者系统形成远程控制

### 总结
本文详细介绍了多种攻击技术和方法，包括利用公开漏洞、外部远程服务、渗透到其他网络介质、硬件攻击、通过可移动媒体进行复制、鱼叉式钓鱼附件、鱼叉式钓鱼链接、通过服务进行鱼叉式网络钓鱼、供应链妥协、利用可靠关系、利用合法帐号、近距离通讯攻击和未知漏洞攻击。同时，提供了一个具体的攻击示例，展示了如何通过Empire和PowerShell脚本进行远程控制。