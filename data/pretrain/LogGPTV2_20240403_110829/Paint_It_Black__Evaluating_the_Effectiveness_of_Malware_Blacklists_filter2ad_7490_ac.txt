of the domains currently resolving to each IP ip ∈ V can be found in SN S.
to be exclusively used for sinkholed domains, we check if the authoritative NS
The previous exploration mechanisms traced active sinkholes only as we re-
quire domains to resolve to the IPs of potential sinkholes. Our blacklist dataset
also includes historical data, thus we are interested in obtaining a list of sink-
holes which were active in the past. Inactive sinkholes presumably do not have
domains currently resolving to them, hence we cannot leverage the NS data as
conducted in the previous step. Instead, we examine the domains which once
resolved to each ip ∈ V in our dataset, obtain the currently most utilized name
server ns, and check if ns is covered by SN S. If ns ∈ SN S is true, the ip is either
of malicious character and the domains once resolving to ip are now sinkholed or
we identiﬁed an inactive sinkhole and the domains were relocated to other sink-
holes. To distinguish between malicious and sinkhole IP we check if (nsip, ASip)
is listed in SN S AS. If this is true, we add ip to Spot as we assume that malicious
IPs are not located in the same AS in which we found veriﬁed sinkholes.
4.2 Evaluation
We now evaluate our method on the datasets SC&C and SMal. On SC&C , the
ﬁltering step removed 1,144 IPs listed in SBenign or associated with parking
providers or Fast Flux. The resulting graph consists of 41,269 nodes and 371,187
edges. In the ﬁrst phase of the graph exploration our approach adds 20 IPs to
Spot, which we manually veriﬁed to be associated with sinkholes. In the second
phase, we identify 6 sinkholes by exploring the parent and child nodes of the
already veriﬁed sinkholes, 11 sinkholes by analyzing the actively used NS, and 8
sinkholes by exploring the NS of historically seen domains. Table 3 outlines the
operators of the veriﬁed sinkholes and the number of distinct AS. The sinkholes
listed as Others are associated with organizations such as Abuse.ch and Echo-
Source. In total, we discovered 45 sinkholes in SC&C without any false positives.
On the larger and more distributed dataset SMal, we ﬁlter 7,349 IPs, resulting
in a graph of 277,315 nodes and 4,690,369 edges. The ﬁrst phase of the graph
exploration identiﬁes 80 IPs to be potential sinkholes. We are able to verify
59 of these IPs to be associated with sinkholes and ﬁnd 10 IPs to serve 403
(Forbidden) and 404 (Not Found) HTTP error codes or empty HTTP responses
for all associated domains. Another 7 IPs do not accept HTTP requests due to
the HTTP port being closed. We assume that these 17 IPs are either associated
12
M. K¨uhrer, C. Rossow, and T. Holz
with sinkholes or hosting companies, which deactivated misbehaving accounts or
servers. The remaining 4 IPs in Spot are considered to be FPs as two IPs serve
benign content (i.e., related to adult content and the DNS provider noip.com),
one IP replies with a single string for all known domains, and the last IP is still
distributing malicious content. Based on the 59 veriﬁed sinkholes, we perform the
second phase and detect 14 sinkholes by exploring the parent and child nodes, 19
sinkholes by monitoring the actively utilized NS, and 14 sinkholes by exploring
the NS of previously seen domains. In Others, we summarize operators such as
Fitsec, Dr.Web, and the U.S. Oﬃce of Criminal Investigations.
Table 3. Sinkhole IPs identiﬁed in SC&C and SM al
SC&C
SM al
Organization
# AS Active Inactive Active Inactive
1
Anubis Networks
Cert.pl
1
GeorgiaTech/SinkDNS 5
3
Microsoft
Others
17
PublicDomainRegistry 7
1
Shadowserver
2
Torpig-Sinkhole
Zinkhole
1
1
4
0
7
4
10
0
4
4
0
0
0
2
1
7
0
1
0
4
4
8
11
18
20
5
8
7
0
0
1
2
4
11
0
2
1
Our detection technique
identiﬁed 106 IP addresses,
which we veriﬁed to be asso-
ciated with sinkholes, 17 IP
addresses of potential sink-
holes, and 4 IP addresses,
which are falsely added to
Spot in the ﬁrst exploration
phase. The second phase does
not cause any FPs but dou-
bles the number of sinkholes.
5 Blacklist Evaluation
Based on the ﬁndings in the previous sections, we now proceed to analyze the
content of the monitored malware blacklists in regards to multiple characteristics.
5.1 Classiﬁcation of Blacklist Entries
We introduced detection mechanisms for parked domains and sinkholing servers,
which are covered by blacklists. Table 4 outlines how many of the currently listed
domains (SCurrent) and IPs (SIP s) can be assigned to one of these categories.
(in %)
Sinkholed
Blacklist
Unreg. Parked Domains (% / #) # IPs
Table 4. Classiﬁcation of SCurrent and SIP s
The Abuse.ch blacklists as
well as MDL ZeuS include a
low number of parked domains.
In contrast, we observe a high
number of parked domains for
23.6
Citadel
40.1
Cybercrime
blacklists that have only a few
12.0
Malc0de
historical entries (cf. Table 1 in
18.0
MDL Hosts
41.6
MDL ZeuS
Section 2). Particularly for Shal-
52.1
MW-Domains
lalist and UrlBlacklist, we as-
0.0
Palevo Tracker
45.7
Shallalist
sume that the listed domains
Shadowserver
n/a
are not reviewed periodically
SpyEye Tracker 47.2
72.3
UrlBlacklist
as more than 57%, respectively,
Virustracker
85.1
77% of all domains are either
ZeuS Tracker
52.0
non-existent, parked, or associated to sinkholes while the number of historical
entries is almost negligible. When taking a look at Virustracker, we ﬁnd 8.7% of
3,263
45
0
6
1
659
1
190
n/a
24
2,211
426
1
70.4
4.2
0.0
0.4
8.3
2.8
2.9
0.9
n/a
19.5
1.7
3.5
0.1
0.2
1.6
1.5
3.0
0.0
2.4
0.0
10.9
n/a
0.0
3.1
8.7
0.3
n/a
0
0
n/a
0
n/a
1
1
4
2
3
n/a
0
Paint It Black: Evaluating the Eﬀectiveness of Malware Blacklists
13
the currently listed domains to be parked. Virustracker consists of DGA-based
domains next to a partition of hard-coded malware domains that are valid and
blacklisted for a longer period of time. The classiﬁcation results indicate that
the hard-coded domains are parked signiﬁcantly more often than the DGA-based
domains, i.e., when inspecting a random subset of 25 DGA-based and 25 hard-
coded domains, only a single DGA-based domain was parked while more than
40% of the hard-coded domains were associated to parking. We thus assume that
many of the persistent domains are parked to monetize the malicious traﬃc.
5.2 Blacklist Completeness
Next, we aim to answer how complete the blacklists are, i.e., we measure if they
cover all domains for popular malware families. We thus turn from analyzing
what is listed to evaluating what is not blacklisted. To the best of our knowledge,
we are the ﬁrst to analyze the completeness of malware blacklists. Estimating
the completeness is challenging as it requires to obtain a ground truth ﬁrst, i.e., a
set of domains used by each malware family. To aggregate a dataset of malicious
domains we leverage analysis reports of our dynamic malware analysis platform
Sandnet [31]. We inspect the network traﬃc of more than 300,000 malware
samples that we analyzed since Mar. 2012 and identify characteristic patterns
for the C&C communication and egg download channels of 13 popular malware
families. Our dataset includes banking trojans, droppers (e.g., Gamarue), ran-
somware (e.g., FakeRean), and DDoS bots (e.g., Dirtjumper ), thus represents a
diverse set of malware families. Per malware family, we manually identify typical
communication patterns and extract the domains for all TCP/UDP connections
that match these patterns. Next to regular expressions, we use traﬃc analy-
sis [32] and identify encrypted C&C streams using probabilistic models [33] to
classify the malware communication. We ensured that these ﬁngerprints cap-
ture generic characteristics per malware family, guaranteeing that the number
of false negatives is negligible (see [32] and [33] for details). We manually veri-
ﬁed a subset of the suspicious communication streams and did not identify any
false classiﬁcations. Admittedly, our dataset is limited to a small subset of the
overall malware population only. Given the subset of malware samples, the set
of extracted domains is thus by no means complete. However, our dataset serves
as an independent statistical sample. In addition, polymorphism creates tens
of thousands new malware samples daily, whereas the number of new malware
variants (e.g., using diﬀerent C&C domains) is much lower [30]—indicating that
our dataset achieves reasonable coverage, as also indicated in the experiments.
We evaluate the completeness of the blacklists by computing the ratio of the
malware domains observed in Sandnet that are also blacklisted. Table 5 out-
lines our evaluation results per family. The second column shows the number of
domains we obtained from Sandnet per family. The remaining columns repre-
sent the results for particular blacklist datasets as introduced in Section 2, while
SAV is deﬁned by the union of all four AV vendor blacklists. Our analysis shows
that the public blacklists detect less than 10% of the malicious domains for eight
(SC&C ) and ﬁve (SMal) malware families, respectively. As a result, the detection
14
M. K¨uhrer, C. Rossow, and T. Holz
capabilities of an IDS or AV software using these blacklists is insuﬃcient, even
when combining multiple blacklists that employ diﬀerent listing strategies. The
public blacklists do achieve detection rates higher than 50% for particular fam-
ilies because of highly specialized listing policies such as in the Abuse.ch track-
ers and Microsoft’s list of Citadel domains, yet they fail to detect the other
families—even though families such as Sality are known since 2003.
Public (%)
AV Vendors (%)
225
47
34
127
321
58