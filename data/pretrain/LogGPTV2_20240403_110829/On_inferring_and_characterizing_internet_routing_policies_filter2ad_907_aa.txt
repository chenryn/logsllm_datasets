title:On inferring and characterizing internet routing policies
author:Feng Wang and
Lixin Gao
On Inferring and Characterizing Internet Routing Policies
Feng Wang
PI:EMAIL
Lixin Gao
PI:EMAIL
Department of Electrical and Computer Engineering
University of Massachusetts, Amherst
MA 01002, USA
ABSTRACT
Border Gateway Protocol allows Autonomous Systems (ASs)
to apply diverse routing policies for selecting routes and
for propagating reachability information to other ASs. Al-
though a signiﬁcant number of studies have been focused
on the Internet topology, little is known about what routing
policies network operators employ to conﬁgure their net-
works. In this paper, we infer and characterize routing poli-
cies employed in the Internet. We ﬁnd that routes learned
from customers are preferred over those from peers and
providers, and those from peers are typically preferred over
those from providers. We present an algorithm for infer-
ring and characterizing export policies. We show that ASs
announce their preﬁxes to a selected subset of providers.
The main reasons behind the selective announcement are the
traﬃc engineering strategy for controlling incoming traﬃc.
The impact of these routing policies might be signiﬁcant.
For example, many Tier-1 ASs reach their (direct or indi-
rect) customers via their peers instead of customers. Fur-
thermore, the selective announcement routing policies imply
that there are much less available paths in the Internet than
shown in the AS connectivity graph. We hope that our ﬁnd-
ings will caution network operators in choosing the selective
announcement routing policy for traﬃc engineering. Finally,
we study export policies to peers and ﬁnd that ASs tend to
announce all of their preﬁxes to other peers. To the best
of our knowledge, this is the ﬁrst study on systematically
understanding routing policies applied in the Internet.
Categories and Subject Descriptors
C.2.2 [Computer-Communication Networks]: Network
Protocols—Routing protocols
General Terms
Measurement, Performance
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
IMC’03, October 27–29, 2003, Miami Beach, Florida, USA.
Copyright 2003 ACM 1-58113-773-7/03/0010 ...$5.00.
Keywords
Routing Policies, BGP, Traﬃc Engineering
1.
INTRODUCTION
The Internet connects thousands of Autonomous Systems
(ASs) operated by many diﬀerent administrative domains
such as Internet Service Providers (ISPs), companies and
universities. Routing between ASs is determined by the in-
terdomain routing protocol, Border Gateway Protocol (BGP)
[1]. A key feature of BGP is that it allows ASs to adopt di-
verse routing policies to control the selection of routes and
propagate reachability information to other ASs. For exam-
ple, a multihomed AS can control the in-bound traﬃc link
by propagating preﬁxes to a subset of its providers only.
Therefore, the preﬁx can be reached only through the sub-
set of its providers. As a result, connectivity does not mean
reachability in the Internet and the extent of the reachability
is determined by both connectivity and routing policies. Al-
though a signiﬁcant number of studies have been focused on
the Internet topology [2][3][4][5], little is known about what
routing policies network operators employ to conﬁgure their
networks.
Understanding routing policies applied in the Internet has
several implications. First, it is important to have a global
view of the routing policies applied. Clearly, each ISP has
information about its own routing policies. However, many
ASs are unwilling to reveal their routing policies to oth-
ers. Furthermore, the routing information stored in Internet
Routing Registry (IRR) [9] is either incomplete or out-of-
date. Therefore, there is no global view of the typical rout-
ing polices conﬁgured in an AS. Second, the global view of
routing policies might have implications on important prop-
erties of Internet. The connectivity in the Internet does not
mean reachability since routing polices might lead to less
available paths. Moreover, this can lead to implications on
robustness of the Internet. Third, being able to infer rout-
ing polices of other ASs might allow an AS to perform traﬃc
engineering eﬀectively. To control traﬃc ﬂow, network op-
erators can change their routing policies to shift traﬃc load
among multiple candidate routing paths. This task can be
performed if candidate routing paths can be predicted by
inferring routing policies of ASs involved.
In this paper, we ﬁrst infer and characterize import rout-
ing policies.
In particular, we infer the route preference
setting among routes learned from providers, customers and
peers. From a large collection of routing tables, we ﬁnd that
in most cases, route preference conforms to AS relationships.
That is, routes learned from customers are typically pre-
ferred over those from providers or peers, and routes learned
from peers are typically preferred over those from providers.
In addition, we observe that about 98% of route preference
assignments are simply based on next hop ASs.
Second, we present an algorithm for inferring export poli-
cies and characterize the export policies. We infer how an
AS announces its routes to its (direct or indirect) providers.
Our results show that a signiﬁcant number of ASs announce
their preﬁxes to a selected subset of providers. Further-
more, the selective announcement is prevalent and persis-
tently present. We investigate the cause of the selective an-
nouncement. We ﬁnd that preﬁx splitting and aggregation
are not the main reasons. The majority of the cases are due
to the traﬃc engineering practice for controlling incoming
traﬃc. That is, an AS may announce its preﬁxes only to a
subset of its direct providers, or to its direct providers with
a community tag indicating that the preﬁxes should not be
announced further. Although the selective announcement
routing policies are not surprising, the impact of these rout-
ing policies might be signiﬁcant. For example, many Tier-1
ASs reach their (direct or indirect) customers via their peers
instead of customers. That is, selective announcement might
lead to “curving” routes in which a peer route is used when
there is a customer route from the AS connectivity graph.
Furthermore, the selective announcement routing policies
imply that there are much less available paths in the Inter-
net than shown in the AS connectivity graph. We hope that
our ﬁndings will caution network operators in choosing the
selective announcement routing policy for traﬃc engineer-
ing. Finally, we study export policy to peers. We observe
that most ASs tend to export all of their preﬁxes to their
peers.
To the best of our knowledge, this is the ﬁrst study on
systematically understanding routing policies applied in the
Internet. The rest of this paper is organized as follows. In
Section 2, we describe the Internet architecture and routing
policies. Section 3 presents our data source. In Section 4, we
describe our methodology for inferring import policies and
the characteristics of the import policies. Then, in Section
5, we present algorithms for inferring export policies and
characterize the export policies. We conclude the paper with
a summary in Section 6.
2. BACKGROUND
In this section, we ﬁrst present an overview of the Internet
architecture, and then describe Internet routing policies.
2.1 Internet Architecture
Routing within ASs is achieved by the Interior Gateway
Protocols (IGP). Routing information between ASs is de-
termined by BGP, which includes interior BGP (iBGP) and
exterior BGP (eBGP). eBGP exchanges reachability infor-
mation between ASs, while iBGP exchanges exterior reach-
ability information within an AS.
ASs negotiate agreements to achieve two forms of AS re-
lationships between various networks, namely provider-to-
customer and peer-to-peer. A pair of ASs is said to have a
provider-to-customer relationship if one oﬀers Internet con-
nectivity to the other ; a pair of ASs providing connectivity
between their respective customers is said to have a peer-to-
peer relationship.
We represent AS relationships by an annotated AS graph.
An annotated AS graph is a graph G = (V, E), where the
 AS1
AS2
provider−to−customer
AS3
AS4
peer−to−peer
AS5
AS6
Figure 1: An example of an annotated AS graph.
AS2 is the provider of AS4, and AS4 is a customer
of AS2. AS3 peers with AS4.
node set V consists of ASs and the edge set E are classiﬁed
into provider-to-customer, and peer-to-peer edges. Fig. 1
shows an example of an annotated AS graph. In this exam-
ple, AS2 is the provider of AS4, and AS4 is a customer of
AS2. AS3 peers with AS4.
2.2 Routing Policies
Routing policies are a set of rules that are conﬁgured by
network operators such that one AS can determine how to
select the best routes, and whether to propagate its best
routes to neighboring ASs. Routing policies include import
policies and export policies.
2.2.1 Import Routing Policies
From each neighbor, a router receives a set of route an-
nouncements. In order to distinguish routes from diﬀerent
neighbors, we deﬁne a route received from a customer as
customer route, and the AS path the route traversed as cus-
tomer path; a route received from a provider as provider
route, and the AS path the route traversed as provider path;
a route received from a peer as peer route, and the AS
path the route traversed as peer path. We will use those
terms to help us inferring routing policies through this pa-
per. Each route announcement contains a set of attributes,
AS path, multi-exit discriminator, next hop, and commu-
nity [11]. Those attributes are used for conﬁguring routing
policies.
After receiving a route announcement, a BGP router dis-
cards the route if its own AS number is present in the AS
path to avoid a loop in AS path. The router then applies
import policies to this route which include denying, or per-
mitting a route, and assigning a local preference to indicate
how favorable the route is. The preference is a value used
to rank routes received from diﬀerent neighboring ASs.
Local preference is typically assigned based on preﬁx or
AS. For example, the following conﬁguration:
router bgp 65503
neighbor 192.1.250.23 remote-as 65504
neighbor 192.1.250.23 route-map isp1 in
access-list 1 permit 0.0.0.0 255.255.255.255
route-map isp1 permit
match ip address 1
set local-preference 90
shows setting the local preference based on the next hop AS
(AS65504). All routes received from AS65504 are assigned
with a local preference value of 90. The permit in the access-
list and route-map statements means matched routes will
be permitted to enter the BGP table or be propagated to
the neighbor. Using preﬁx-list, local preference can be set
according to the destination IP address, for example, the
following conﬁguration:
ip prefix-list 1 permit 10.1.1.1/24
route-map isp1 permit
match ip address prefix-list 1
set local-preference 80
sets local preference value to be 80 for the preﬁx 10.1.1.1/24.
BGP incorporates a sequential decision process which cal-
culates the degree of preference for various routes to a given
preﬁx. A BGP router selects the best route for each preﬁx
from a set of routes according to the following criteria:
1. Routes with the highest local preference.
2. Routes with the shortest AS path.
3. Routes with the lowest origin type, where a route orig-
inally learned from IGP is preferable to a route learned
from the BGP.
4. Routes with the smallest MED for routes with the
same next hop AS.
5. Prefer routes learned from eBGP over those from iBGP.
6. Routes with the smallest IGP metric to the egress bor-
der router.
7. Routes with the smallest router ID.
Note that the ﬁrst route selection picks the route with
the highest local preference value. In this paper, we focus
on inferring local preference setting in import policies.
2.2.2 Export Routing Policies
After selecting the best route, a BGP router will propa-
gate only the best route to its neighboring ASs. Export poli-
cies allow the router to determine whether to advertise the
best route to a neighbor. Export policies include permitting
or denying a route, assigning MED to control the inbound
traﬃc, tagging a BGP community to indicate what prefer-
ence a neighboring AS should assign to it, and prepending
AS paths or redistributing its preﬁxes to aﬀect the inbound
traﬃc. The conﬁguration of export policies is similar to that
of import policies. It can be based on the AS path or preﬁx.
The following rules are well known BGP export policies [15]:
• Exporting to provider: A customer can export to its
providers its routes and the routes learned from its
own customers, but cannot export routes learned from
other providers or peers.
• Exporting to customer: A provider can export to its
customers its routes, the routes learned from the other
customers, its providers, and its peers.
• Exporting to peer: A peer can export to another peer
its routes, the routes learned from its customers, but
cannot export the routes learned from its providers
and other peers.
We note that route selection of an AS depends on the
routes coming from its neighboring ASs after export policies
are applied , as well as on the import policies of the AS.
In the following, we assume that an AS accepts all route
announcements from its neighbors.
3. SOURCES OF DATA
We conduct our analysis using data sources from Oregon
RouteView server [16] and Looking Glass servers [17]. Ore-
gon RouteView provides a view of the global routing system
from the perspectives of several diﬀerent backbones and lo-
cations around the Internet. On Nov. 2002, it peered with
56 ASs which announce their default-free routes to it. Those
ASs include nearly all Tier-1 ASs in the Internet, such as
AS1239 (Sprint) and AS7018 (AT&T) 1.
Besides BGP tables from Oregon RouteView, we use BGP
tables from 15 ASs’ Looking Glass servers. These tables in-
clude 3 Tier-1 ASs, AS1, AS3549, and AS7018. Through
those Looking Glass servers, we can retrieve ﬁne-grained
routing information, such as Local Preference, and BGP
community. Combining BGP tables from RouteView and
ASs’ Looking Glass servers, we have 68 routing tables from
diﬀerent ASs. Table 1 shows the name, degree, and location
of each AS. Among them, 42 ASs are managed by ISPs in
North America. 33 ASs are managed by ISPs in Europe, 3
ASs in Australia, 2 ASs in Asia. The sizes of those ASs span
a large range. For example, AT&T (AS7018) has a degree
of 1330, and Lirex Net (AS8262) has a degree of 14. We be-
lieve that those data sources are suﬃcient for our study. All
BGP tables are downloaded on Nov.11, 2002, and Nov.18,
2002.
Our study relies on AS relationships. There are several
novel algorithms which can be used to infer AS relationships
from a collection of BGP routing tables [12][8][13]. Here, we
choose the one described in [12]. In Section 4.3, we show
that the potential error introduced by inferred AS relation-
ships is small.
4.
INFERRING IMPORT POLICIES
One of the most important aspects of import policies is to
set local preference. Local preference can be used to inﬂu-
ence the selection of the best route among a set of routes,
and control outgoing traﬃc. First, we infer route preference
among routes from providers, customers and peers. Then
we analyze the consistency of local preference setting with
next hop ASs.
4.1 Route Preference Among Provider, Cus-
tomer, and Peer Routes
BGP default routing policy which selects the route with
the shortest AS path length is overridden by routing policies
that set local preference. Network operators usually assign
diﬀerent local preference values to customer, provider, and
peer routes.
We use BGP routing tables shown in Table 1 to dis-
cover route preference. After knowing AS relationships be-
tween an AS and its neighbors and deriving local preference
from those tables, we associate each neighbor, or customer,
provider and peer, with one or more local preference values.
Hence, we compare local preference values among diﬀerent
routes. We deﬁne:
• Typical Local Preference: customer routes have higher
local preference than peer routes and provider routes,
and peer routes have higher local preference than provider
routes.
1We classiﬁed each AS to its tier using the method described
in [8].
Table 1: Characteristics of Oregon RouteView and
15 ASs’ Looking Glass servers. 42 ASs are managed
by ISPs in North America (NA). 33 ASs are man-
aged by ISPs in Europe (Eu), 3 in Australia (Au),
2 in Asia (As).
AS
AS name
number
AS6664 Oregon RouteView
Degree
Location
with
peering NA(40)
As (2)
Eu (12)
Au (2)
56 ASs
AS7018 AT&T
AS577
AS3549 Global Crossing
AS6539 Group Telecom Data
Bell Backbone
AS1
Core
GTE Internetworking
AS12859 Business Internet
Trends BV
AS2578 Demos, Moscow, Russia
European Organization
AS513
for Nuclear Research
France Telecom
INTELIDEAS
Jippii Group
Lirex Net
Swiss Academic and
Research Network
AS5511
AS12359
AS6667
AS8262
AS559
AS6762 Telecom Italia
international high speed
AS7474 Optus Communications
Pty Ltd
1330
89
558
157
599
109
34
39
168
31
26
14
33
120
114
NA
NA
NA
NA
NA
Eu
Eu
Eu
Eu
Eu
Eu
Eu
Eu
Eu
Au
• Atypical Local Preference: the local preference of peer
routes or provider routes is not lower than that of cus-
tomer routes, or the local preference of provider routes
is not lower than that of peer routes.
Table 2 shows the percentage of preﬁxes which have typi-
cal local preference for each AS. Our result implies that the
percentage of atypical local preference for each AS is very
small. Those 15 ASs include 3 Tier-1 ASs (AS1, AS3549,
and AS7018), 2 Tier-2 ASs (AS5511, and AS7474), and
other 10 ASs.
In order to get a more complete view of local preference
setting, we resort to the Internet Routing Registry (IRR) to
infer import policies. IRR maintains ASs’ routing informa-
tion in several public databases. The motivation of IRR is
to coordinate global routing policies, but the IRR database
may not be complete and some part of it can be out-of-date.
We downloaded public IRR database ﬁles mirrored at [10]
on Nov. 25th, 2002. First, we check each AS’s last update
time and discard those ASs which are not updated during
2002.
The IRR database expresses routing information at vari-
ous levels (e.g., individual preﬁx or AS, etc.). The following
example shows how the import policy is expressed in Rout-
ing Policy Speciﬁcation Language (RPSL).
aut-num: AS1
import: from AS2 action pref = 1; accept ANY
Table 2: Typical local preference assignment for 15
ASs. It shows the prevalence of typical local prefer-
ence.
AS
% of typical
AS
% of typical
number
local preference
number
local preference
577
5511
3549
6667
7474
12359
7018
1
94.3
96.5
99.7
99.94
99.955
99.98