### 异常触发的无线网络拒绝服务攻击

**作者**: 赵瑶, Sagar Vemuri, 陈嘉真, 陈艳, 周海, Zhi (Judy) Fu  
**单位**: 美国伊利诺伊州埃文斯顿西北大学; 摩托罗拉实验室，美国伊利诺伊州绍姆堡

#### 摘要
安全协议并不像我们所假设的那样安全。本文提出了一种通过触发异常来对安全协议发起拒绝服务（DoS）攻击的实用方法。实验表明，即使是最新的强认证协议如PEAP、EAP-TLS和EAP-TTLS也容易受到此类攻击。我们在基于TLS的EAP协议（无线局域网的主要安全协议家族）以及新兴的IPv6基础设施中的移动IPv6返回路由验证协议上实现了并测试了实际攻击。在某大型大学的无线网络中，针对PEAP协议进行了DoS攻击测试，并取得了显著的成功。我们进一步通过一系列ns-2模拟测试了攻击的可扩展性。此外，还提出了检测此类攻击的方法及改进协议以抵御这些类型DoS攻击的建议，并通过实验进行了验证。

#### 1. 引言
作为网络的基础，协议在认证和通信中发挥着至关重要的作用，因此成为各种恶意攻击的目标。一个设计良好的协议应能妥善处理异常情况，以应对意外事件。然而，大多数当前协议处理异常的方式仅仅是重新启动协议处理，这不仅浪费资源，而且可能被用于发起严重的拒绝服务（DoS）攻击。在本文中，我们将性能下降攻击视为弱DoS攻击。迄今为止，人们对这种由（伪造的）异常引起的漏洞关注较少，包括TCP RST攻击[24]，这可能是由于缺乏实际且严重的攻击案例。在有线网络中，除非网络运营商试图这样做或路由器被攻破，否则很难嗅探到数据包。类似地，在无线网络中，TCP会话通常受到较低层加密的保护，因此在实践中很难实施TCP RST攻击。因此，社区很大程度上忽视了这种漏洞。本文揭示了大多数无线安全和通信协议在处理异常时的一个严重漏洞，即通过展示一种异常触发攻击。该攻击的基本思想是嗅探协议通信，然后注入伪造的错误消息或误导性消息，触发异常处理，从而中断整个协议会话。我们假设密码算法是完美的，攻击者无法读取加密数据。这种攻击具有以下特点：
- **易于发起**：任何普通用户都可以使用廉价的商品硬件发起此类攻击。实际上，本文的重要贡献之一是通过真实世界的实验展示了此类攻击在现实生活中的易发起性。
- **高效且可扩展**：此攻击只需发送少量错误或意外消息。流量远少于正常连接建立所需的流量。因此，即使是一个节点也可以同时攻击大量客户端。
- **隐蔽**：与干扰或流氓AS攻击不同，现有入侵检测系统无法检测到这种攻击。
- **广泛适用**：这种攻击可以应用于涉及连接设置过程中的异常处理的各种安全或通信协议。例如，在我们的案例研究中，它可以应用于强大的认证协议，如TLS。

#### 2. 攻击框架
在本节中，我们描述了针对安全协议的异常触发DoS攻击框架。我们的攻击原则是利用协议异常处理机制的漏洞。虽然发起攻击有一些要求，但在现实世界中这些要求通常是通用且易于满足的，如第3节和第4节的案例研究所示。

##### 2.1 攻击要求
以下是发起攻击所需的基本要求：
- **媒介要求**：攻击者能够嗅探和欺骗数据包。
- **协议要求**：存在致命错误条件，可以在协议受强密码算法保护之前停止协议。
- **时间要求**：在正常协议通信之间存在足够的时间窗口，允许攻击者在正确位置注入数据包。

###### 2.1.1 媒介要求
嗅探和欺骗是异常触发攻击以及其他许多攻击的必要手段。嗅探有助于了解协议状态，并确定何时进行欺骗攻击。尽管现代交换机防止了以太网中的嗅探，并且通常很难在路由器上进行嗅探，但在无线网络（尤其是802.11网络）中，可以通过精心设计的软件和现成硬件轻松实现嗅探和欺骗。这也是我们专注于无线网络攻击的原因，尽管我们的攻击原则也适用于有线网络协议。

###### 2.1.2 协议要求
典型的安全协议通常会在会话密钥建立之前交换一些控制消息，以认证通信双方。所有这些消息在密钥建立之前都是未加密的。通常，协议具有异常处理程序，当发生异常时会触发错误消息通知另一方。在大多数协议中，致命或意外异常的处理方式是简单地终止协议，如果重试，则从头开始新的认证过程。这种简单的异常处理程序可能被攻击者用来发起DoS攻击。例如，在TLSv1.1中，有许多未加密且未经认证的错误消息在会话密钥建立之前可能会被任一方（客户端或服务器）发送。在TLSv1.1中，只要出现致命错误消息，认证过程就会被终止[13]。

###### 2.1.3 时间要求
如果某个协议满足上述要求，则可以通过触发异常来对该协议发起DoS攻击。但为了使攻击切实可行，欺骗的数据包必须在合适的时间到达目标，既不能过早也不能过晚。因此，对于攻击者来说，有一个所谓的“时间窗口”来发送欺骗数据包，如果这个时间窗口足够大，攻击就是切实可行的。一般来说，攻击者首先在通道上嗅探消息，以确定何时发送欺骗消息。然后，他向其中一方发送欺骗消息，使其相信发生了某种错误，从而终止认证过程。通常，如果欺骗的消息在合法预期消息之前到达目标方，攻击将生效。否则，一方将处理预期消息并进入新状态，在这种状态下，攻击消息可能已经过时并被无声丢弃。因此，攻击的时间窗口通常是从接收到触发消息到合法预期消息到达目标的时间段。

##### 2.2 攻击方法
异常触发攻击可以通过两种方式发起。首先，攻击者可以直接伪造错误消息，告知通信双方协议失败。第二种方法是发送误导性消息，诱使其中一方发送错误消息。例如，在协商过程中，欺骗的消息可以使客户端选择错误的密码套件与认证服务器通信。

#### 3. 案例研究1：基于TLS的EAP协议
在本节中，我们描述了第一个案例研究，即基于TLS的EAP协议上的异常触发攻击。我们首先简要介绍EAP协议家族和TLS协议，然后详细描述攻击过程。

##### 3.1 背景
###### 3.1.1 可扩展认证协议（EAP）
可扩展认证协议（EAP）是一种常用的认证框架，广泛应用于无线网络、点对点连接和局域网中。