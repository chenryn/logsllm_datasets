13
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
ExceptionTriggeredDoSAttacksonWirelessNetworksYaoZhao,SagarVemuri,JiazhenChen,YanChen,HaiZhouandZhi(Judy)Fu†NorthwesternUniversity,EvanstonIL,USA†MotorolaLabs,SchaumburgIL,USAAbstractSecurityprotocolsarenotassecureasweassumed.Inthispaper,weidenti(cid:2)edapracticalwaytolaunchDoSattacksonsecurityprotocolsbytriggeringexceptions.Throughexper-iments,weshowthateventhelateststronglyauthenticatedprotocolssuchasPEAP,EAP-TLSandEAP-TTLSarevul-nerabletotheseattacks.RealattackshavebeenimplementedandtestedagainstTLS-basedEAPprotocols,themajorfam-ilyofsecurityprotocolsforWirelessLAN,aswellastheReturnRoutabilityofMobileIPv6,anemerginglightweightsecurityprotocolinnewIPv6infrastructure.DoSattacksonPEAP,onepopularTLS-basedEAPprotocolwereper-formedandtestedonamajoruniversity’swirelessnetwork,andtheattackswerehighlysuccessful.Wefurthertestedthescalabilityofourattackthroughaseriesofns-2simulations.Countermeasuresfordetectionofsuchattacksandimprove-mentsoftheprotocolstoovercomethesetypesofDoSat-tacksarealsoproposedandveri(cid:2)edexperimentally.1IntroductionAsthefoundationofnetworks,protocolsplayvitalrolesinauthenticationandcommunication,andthusbecomeonepopulartargetofvariousmaliciousattacks.Toberobustforunexpectedevents,awelldesignedprotocolshouldconsiderandhandletheexceptionsproperly.Unfortunately,thewayofdealingwithexceptionsinmostcurrentprotocolsissimplytorestarttheprotocolprocessingfromthebeginning,whichcausesawasteofresourcesandpotentiallycanbeusedtolaunchseriousdenial-of-service(DoS)attacks.Noteinthispaper,wealsoconsidertheperformancedegradationattackasaweakDoSattack.Sofar,peoplehavepaidlittleattentiontosuchvulnera-bilitiescausedbythe(faked)exceptionsincludingtheTCPRSTattacks[24],probablybecauseofthelackofpracticalandsevereattacks.Inwirednetworks,itisveryhardtosniffpacketsunlessthenetworkoperatorsattempttodosooraroutergetscompromised.Similarly,inwirelessnetworks,TCPsessionsareusuallyprotectedbylowerlayerencryp-tions.Therefore,itishardtoconductTCPRSTattackinpractice,andthatiswhysuchvulnerabilitiesarelargelyig-noredbythecommunity.Inthispaper,werevealaseriousvulnerabilityofexcep-tionhandlinginmostwirelesssecurityandcommunicationprotocolsbyshowinganexceptiontriggeredattack.Theba-sicideaoftheattackistosnifftheprotocolcommunicationandtheninjectfakeerrormessagesormisleadingmessagestotriggerexceptionhandlingtobringdownthewholepro-tocolsession.Noteweassumethecryptographicalgorithmsareperfectandnoencrypteddataisreadablebytheattackers.Thisattackhasthefollowingproperties.(cid:15)Easytolaunch.Anynormalusercanlaunchsuchanattackwithcheapcommodityhardware.Actuallyoneimportantcontributionofthepaperistodemonstratetheeasinessofsuchattacksinthereallifeusingreal-worldexperiments.(cid:15)Ef(cid:2)cientandscalable.Thisattackonlyneedstosendsmallerrororunexpectedmessages.Thetraf(cid:2)cismuchlessthanthatofthenormalconnectionsetup.Thus,evenasinglenodecanattackalargenumberofclientssimultaneously.(cid:15)Stealthy.UnlikejammingorrogueASattacks,itcan-notbedetectedbyanyoftheexistingintrusiondetec-tionsystems.(cid:15)Generallyapplicabletoavarietyofprotocols.Suchattackcanbeappliedtoanysecurityorcommunicationprotocolwhichinvolvesexceptionhandlinginitscon-nectionsetup.Forexample,itcanevenbeappliedtostrongauthenticationprotocolssuchasTLSinourcasestudies.Inthispaper,weshowtwocasestudies.The(cid:2)rstoneisonTLS-basedExtensibleAuthenticationProtocols(EAP)suchasPEAP[8],EAP-TLS[29]andEAP-TTLS[15].EAPiswidelyusedasastrongauthenticationprotocolforwirelessLANsandcellularnetworks.ThesecondcasestudyisontheReturnRoutabilityprotocolofMobileIPv6.Throughbothreal-worldexperimentsandns-2simula-tions,wedemonstratetheease,ef(cid:2)ciencyandscalabilityoftheexceptiontriggeredattacks.Forexample,withacom-moditylaptop,wecaneasilylaunchDoSattacksonPEAPauthenticationstostopclientsfromjoiningthethecampuswirelessnetworkofamajoruniversity.Inaddition,weproposecountermeasurestosuchattacks.Weanalyzethesymptomsoftheexceptiontriggeredattacksandproposedetectionapproaches.Also,weproposeagame-theorybaseddesignprincipletoimproveexistingprotocolsagainstsuchattacks.WeimplementedsuchstrategyinWPAsupplicant[6](animplementationofPEAP[8])andshowthatthemodi(cid:2)edPEAPisimmunetothefakeerrormes-sagebasedattacksinrealexperiments.Last,weproposetheguidelineforthedesignoffutureauthenticationprotocolstobeinvulnerabletotheexceptiontriggeredattacks.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
14
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
Therestofthepaperisorganizedasfollows.Insection2,wedescribetherequirementsandtechniquestolaunchDoSattacksbytriggeringexceptions.Insections3and4,twocasestudiesfortheexceptiontriggeredattacksarepresented,andthentheyareevaluatedinsection5.Next,insection6,wediscussafewcountermeasurestosecureprotocolsagainsttheDoSattacks.Finally,wepresenttherelatedworkinsection7andconcludeinsection8.2AttackFrameworkInthissection,wedescribetheframeworkofourexcep-tiontriggeredDoSattackonsecurityprotocols.Ourattackprincipleistoexplorethevulnerabilityoftheprotocolexcep-tionhandlingmechanism.Thereareafewrequirementsforlaunchingtheattack,buttheyaregeneralandeasytosatisfyintherealworld,asshowninthissectionandthecasestudiesinsections3and4.2.1AttackRequirementsThefollowingbasicrequirementsarenecessarytoourat-tack.(cid:15)MediaRequirements:Theattackercansniffandspoofpackets.(cid:15)ProtocolRequirements:Existenceoffatalerrorcondi-tiontostoptheprotocolbeforetheprotocolisprotectedbystrongcryptographicalgorithms.(cid:15)TimingRequirements:Considerabletimewindowex-istsbetweennormalprotocolcommunication,allowingattackstoinjectpacketsatrightplace.2.1.1MediaRequirementsSnif(cid:2)ngandspoo(cid:2)ngarenec-essaryforourexceptiontriggeredattackaswellasmanyotherattacks.Snif(cid:2)nghelpstoknowthestatusofthepro-tocolandtodeterminewhentospooftheattackpackets.Snif(cid:2)ngandspoo(cid:2)ngarelimitednowadaysinwirednet-works.Forexample,currentswitchespreventsnif(cid:2)nginEth-ernetanditisusuallyveryhardtosniffonrouters.ISPsandenterprisesoftenuseaccesscontroltoblockIPspoof-ing.However,inwirelessnetworks,especiallyin802.11net-works,snif(cid:2)ngandspoo(cid:2)ngcanbedonewithwelldesignedsoftwareandoff-the-shelfhardware.Thisisalsothereasonthatwefocusonattacksinwirelessnetworks,althoughourattackprincipleshouldalsoworkforprotocolsforwirednet-works.2.1.2ProtocolRequirementsTypicalsecurityprotocolsusuallyexchangeafewcontrolmessagestoauthenticateoneorbothofthecommunicatingparties,beforethesessionkeysareestablished.Allthemessagesbeforetheestablishmentofthekeysareunencrypted.Normallyaprotocolhastheex-ceptionhandlingprocedures,andanerrormessageisusuallytriggeredtoinformtheotherpartnerwheneveranexceptionoccurs.Inmostprotocols,thefatalorunexpectedexcep-tionsarehandledbysimplyterminatingtheprotocol,andthenewauthenticationprocesswillrestartfromscratch,ifretried.ThissimpleexceptionhandlingprocedurecouldbeusedbyanattackertolaunchaDoSattack.Asanexample,inTLSv1.1,therearealotofunencryptedandunauthenticatederrormessagesbeforethesessionkeyisestablished,andtheycouldpotentiallybesentbyeitheroftheEAP-FASTPEAPEAP-TTLSEAP Over LAN (EAPOL)Extensible Authentication Protocol (EAP)802.11WLANEAP-TLSTLSGSMUMTS/CDMA2000EAP-AKAEAP-SIMChallenge/ResponseFigure1:EAPprotocols.parties(clientortheserver)whenanerrorconditionoccurs.InTLSv1.1,aslongasthereisafatalerrormessage,theauthenticationprocesswillbeterminated[13].2.1.3TimingRequirementsIfanyprotocolsatis(cid:2)estheaboverequirements,itispossibletolaunchaDoSattackontheprotocolbytriggeringexceptions.Butforanattacktobepractical,thespoofedpacketshouldreachthetargetattherighttime,nottooearlyandnottoolate.Sothereisasocalledtimewindowfortheattackertospoofattackpackets,andtheattackispracticaltolaunchifthetimewindowislargeenough.Generally,theattacker(cid:2)rstsniffsthemessagesonthechanneltodeterminewhentosendthespoofedmessage.Thenhesendsaspoofedmessagetooneofthepartiestomakeitbelievethatsomeerrorhappenedsoastoterminatetheauthenticationprocess.Usuallyifthespoofedmessagereachesthetargetpartybeforethelegitimateexpectedmes-sage,theattackwilltakeeffect.Otherwise,apartywillpro-cesstheexpectedmessageandthenmovetoanewstate,inwhichtheattackmessagemaybeobsoleteanddiscardedsilently.Therefore,thetimewindowforanattackusuallyisfromthemomentofreceivingthetriggermessagetothemomentalegitimateexpectedmessagereachesthetarget.2.2AttackMethodologyTheexceptiontriggeredattackcanbelaunchedintwoways.First,theattackercandirectlyspooftheerrormes-sages,whichinformsoneorbothpartiesinvolvedinthecom-municationthefailureoftheprotocol.Thesecondwayistosendsomemisleadingmessagestotriggeronepartytosendoutanerrormessage.Forexample,inanegotiationprocessthespoofedmessagecanmaketheclientchooseawrongci-phersuitetotalkwiththeauthenticationserver.3CaseStudy1:TLSbasedEAPProtocolsInthissection,wedescribeour(cid:2)rstcasestudy,exceptiontriggeredbasedattacksonTLS-basedEAPprotocols.We(cid:2)rstgiveabriefbackgroundoftheEAPprotocolfamilyandtheTLSprotocol,andthendescribeindetailstheattackpro-cedure.3.1Background3.1.1ExtensibleAuthenticationProtocol(EAP)Extensi-bleAuthenticationProtocol(EAP)isauniversalauthentica-tionframeworkthatisfrequentlyusedinwirelessnetworks,point-to-pointconnectionsandLANs.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
15
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 