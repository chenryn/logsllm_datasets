### Title: BlackHat US-22: Ret2page - The Art of Exploiting Use-After-Free Vulnerabilities in the Dedicated Cache

**Abstract:**

Heap isolation is a robust mitigation technique that significantly reduces the exploitability of certain types of vulnerabilities, particularly Use-After-Free (UAF) vulnerabilities. In the Android/Linux kernel, UAF vulnerabilities in dedicated caches are particularly challenging to exploit. This is because ideal victim objects cannot be directly allocated in the same cache, and from Android 11 (kernel 5.4), the `CONFIG_SLAB_MERGE_DEFAULT` option is not set by default. As a result, dedicated caches remain isolated, reducing memory fragmentation but also making cross-cache attacks necessary for exploitation.

However, traditional cross-cache attack techniques are often time-consuming and less deterministic, leading to many UAF vulnerabilities in dedicated caches being overlooked and considered unexploitable. In this talk, I will introduce "Ret2page," a novel and generic exploitation technique designed to address these challenges. The core idea behind Ret2page is to effectively manipulate both the SLUB and BUDDY allocators, thereby reducing the time and memory consumption while improving the success rate of physical page reuse.

To evaluate the effectiveness of Ret2page and compare it with existing cross-cache attack techniques, I will analyze two typical UAF vulnerabilities that were fixed last year. Additionally, I will detail how to exploit these vulnerabilities, bypass common mitigations such as Kernel Address Space Layout Randomization (KASLR) and Privileged Access Never (PAN), and ultimately achieve arbitrary kernel memory read/write capabilities and root privileges. I will also present a universal solution for rooting Android devices.

During the presentation, I will demonstrate the exploitation process on flagship Android devices, showcasing the practicality and efficiency of the Ret2page technique. This new approach and its underlying principles have not been thoroughly presented in any previous talks, making this session a unique and valuable resource for security researchers and practitioners.