446
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
Figure5.Asamplecyber-securitystate(Fig.5),thereareatotalof13possibletransitions,par-titionedintotwosubsets:1)responseactionsAr(s)={restart(G1),switch(HMI),NOP},and2)adversarialac-tionsAa(s)regardingleafconsequencenodes.Here,weassumethatresponsiveactionsAr(s)requiresomemanualassistancebyaSCADAoperator;hence,theycannotbeac-complishedsimultaneouslyduetolimitedhumanresources.ThesolutionforthismodelbyRREgivesswitch(HMI)astheoptimalresponseaction,sinceifrestart(G1)orNOPwaschosen,theattackercouldcauseahugeamountofdam-agetothesystemafterwardsbycompromisingtheSCOPFserver(Fig.4),leadingtocompletefailureofthecontrolsubsystemthatwouldconsequentlyaffecthowpowerloadswereprovidedandﬁnallyresultinthetopevent“SCADAcompromised.”Inotherwords,asexplainedearlier,theen-ginechoosestheresponseactionthatminimizesthemaxi-mumdamagethattheattackercancauselater.7.ComputationalEfﬁciencyAlthoughthevalueiterationalgorithmperformswellinMDPswithseveralthousandstates,RRE(likemoststate-basedmodelingtechniques)facesthestatespaceexplosionproblemwhenalargenetworkthatincludesalargenum-berofassetsistobeprotectedusingnumerousalertssentbydistributedIDSsystems.Thisexponentialgrowthofthestatespacemakesitinfeasibletocomputeanoptimalsolu-tion,i.e.,responseaction,inlarge-scaleapplications.TheproblembecomesevenworsewhenPOCMDPisemployedtoﬁndanoptimalsolution.Therefore,RREusestwostate-compactiontechniquestodealwiththisproblem.First,themostlikelystate(MLS)approximationtech-nique[5]isusedtoconvertPOMDPtoMDP,whichismoretractableforreal-timeresponsedecision-making.Todoso,wecomputethemostlikelystateusings∗=argmaxsb(s),anddeﬁnepolicyasπ(s)=πMDP(s∗),whichiscom-putedusingBellman’soptimalityequationsforthevaluefunctionV∗(s)=maxar∈Ar(s)Υ(V∗,s,ar)andpolicyπMDP(s)=argmaxar∈Ar(s)Υ(V∗,s,ar),inwhichΥ(.)isasdeﬁnedin(13).Thevalueiterationalgorithm[3]isemployedtocomputethevaluefunction,i.e.,V(s)←maxa∈A(s)Υ(V,s,a).UsingMLSinRREisquitereasonable,sincetheprob-abilityofthemostlikelystateisfargreaterthantheproba-bilityofotherstates;however,thederivedMDPisnotyetsmallenoughtodealwithinreal-time.Furthermore,duetoitslargestatespace,evenoff-linesolutiontechniquesarenotusable,sincemostofthem,e.g.,valueiteration,performiterativeupdatesovertheentirestatespace.Tofocuscom-putationsonrelevantstates,anonlineanytimealgorithm1calledenvelopeisemployed,makingRREcapableofde-cidingreal-timeresponseseveninlarge-scalecomputernet-works.Inbrief,theenvelopealgorithmperformsaﬁnite1Ananytimealgorithmcanbeinterruptedatanypointduringexecutiontoreturnananswerwhosevalue,atleastincertainclassesofstochasticprocesses,improvesinexpectationasafunctionofthecomputationtime.look-aheadsearchonasubsetofstatesreachablefromagivencurrentstate,i.e.,s∗(mentionedabove).Thissub-set,called“envelopeEπ,”initiallycontainsonlythecurrentstateandisprogressivelyexpanded.Anapproximatevaluefunction˜Visusedtoevaluatethefringestates,i.e.,thesetofstatesthatarenotintheenvelopebutmaybereachedinonestepfromsomestateintheenvelope:Fπ={s∈S−Eπ|∃s(cid:3)∈Eπ,P(s(cid:3),π(s(cid:3)),s)>0}.(14)Theenvelopeconvergestotheoptimalpolicy[7],anditsgeneralschemeisasfollows:1)Initialization:GeneratetheinitialenvelopeEπ=s∗.2)While(Eπ(cid:12)=S)and(notdeadline)do–Fringeexpansion:ExtendtheenvelopeEπ.Somes∈Fπischosen,anditsvalueisupdated.–Ancestorsupdatephase:Generateanoptimalpolicyπfortheenvelope.3)Returnπ.Usingtheenvelope,RREcansolvehugeMDPsveryef-ﬁcientlybyproducingpartialpolicy,deﬁnedonlyontheenvelope,withoutevaluatingtheentirestatespace.8.ExperimentalEvaluationInthissection,weinvestigatehowtheproposedRe-sponseandRecoveryEngineperformsinreality.WehaveimplementedRREontopofSnort2.7[22],whichisanopen-sourcesignature-basedIDS.Theexperimentswererunonacomputersystemwitha2.2GHzAMDAthlon64Processor3700+with1MBofcache,2GBofmemory,andtheUbuntu(Linux2.6.24-21)operatingsystem.8.1.ScalabilityToevaluatehowRREhandlescomplexnetworkscon-sistingoflargenumbersofhostsystems,wemeasuredthetimerequiredbyRREtocomputetheoptimalresponseac-tionvs.variousmetrics.Fig.6showstheaveragetime-to-responseovertenrunsvs.theattack-responsetreeorder,i.e.,themaximumnumberofchildrenforeachnode.Givenaﬁxednumber,e.g.,500inFig.6,oftotalnodes,theARTtreeorderdeterminesthenumberofleafnodesthatcon-tributetothesizeofthestatespaceinaMarkoviandecisionmodel.Foreachtreeorderd,abalancedtree,inwhicheachnodehasdchildren,isgenerated;gatesareassignedtobeANDorORwithequalprobability,i.e.,0.5.Inourexperiments,the-optimalityterminationcriterioninBell-man’sequationanddiscountingfactoraresetto=0.1andγ=0.99,respectively.Then,adecisionprocessisconstructedandsolved,andthetotaltimespentisrecorded(Fig.6).Asexpected,theﬁgureshowsthatincreasingtheARTorderleadstorapidgrowthoftherequiredtime-to-responsebytheengine.Inanotherscalabilityevaluationexperiment,wemea-suredtime-to-responsevs.thenumberofnodesinbalancedARTtreesoforder2.Fig.7showsaverageresultsontenrunsfortwoschemes.First,givenIDSalertsandtheARTtree,thecompletedecisionmodelconsistingofallstatesinthestatespacewasconstructed.AsshowninFig.7(a),theresponseenginecansolveforoptimalresponseactionsforARTtreeswithupto45nodeswithinabout2minutes.Sec-ond,anonlineﬁnite-lookaheadMarkoviandecisionmodelwithanexpansionlimitof2stepswasgeneratedandsolved.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
447
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
Υ(V,s,a)=(cid:5)s(cid:2)∈SP(s(cid:3)|s,a).{r(s,a,s(cid:3))+√γ.[minaa∈Aa(s(cid:2))(cid:5)s(cid:2)(cid:2)∈SP(s(cid:3)(cid:3)|s(cid:3),aa).(cid:6)r(s(cid:3),aa,s(cid:3)(cid:3))+√γ.V(s(cid:3)(cid:3))(cid:7)]}(13) 0 10 20 30 40 50 60 5 10 15 20time-to-response (sec)attack-response tree orderFigure6.Treeordervs.time-to-responseAsillustratedinFig.7(c),limitedexpansionimprovesaso-lution’sconvergencespeedandincreasesthesolvableARTsizetotreeswithupto900nodeswithin40seconds.BysolvingARTtreeswithabout900nodesinaminute,RREcanprotectlarge-scalecomputernetworks.Third,tofurtherimproveRRE’sscalability,weevaluatedhowfastadecisionprocessissolvedwithanupperexpansionlimitof2.Fig.7(b)comparestotalrecoverycostbetweentheabovemen-tionedtwoschemesforallpossiblestartingscenarios,i.e.,states(2|L|=64).8.2.ComparisonThissectionevaluateshowbeneﬁcialRREiscomparedtostaticIRSes,particularlythosethatstaticallychooseandtakeresponseactionsfromalookuptablethatstores(IDS-alert,IRS-response)mappings.Inourexperiments,bothIRSsystems,i.e.,RREandstaticIRS,weregivenasam-pleARTtreewith|L|=6leafnodesbasedonwhichtheycomputedresponseactions.RRE’sresponseactionse-lectionhasalreadybeenexplainedindetail;thestaticIRSmapseachalert,i.e.,aleafnodeinART,toaresponseactionthatresetsthatparticularleafnodewithminimumcost.Giventhecurrentnetworkstate,wecomparedhowmuchcostRREandthestaticIRSspenttowardtheendofthegame,i.e.,thepointatwhichallleafnodeshadbeencleaned.ARTparametersandgraphsareomittedduetospaceconstraints;however,ﬁnalresultsaredescribedhere.Wemodeledtheattackertobecompletelyintelligent;inotherwords,ineachstep,heorshetookthemostharmfulpossibleadversarialaction.Therewereatotalof2|L|=64startingscenarios(states)fortwodifferentgameschemes.Intheﬁrstscheme,theactionratiobetweenIRSandtheat-tackerwas1;inotherwords,foreachactiontakenbytheresponsesystem,theattackerwasallowedtopickonead-versarialaction.Asexpected,forallinitialscenarios,inpickingtheoptimalaction,RRErequiredarecoverycostlessthanorequaltowhatthestaticIRSdid.Inthesecondgamescheme,wefortiﬁedtheattacker’sstrength,andsettheactionratioto1/2,meaningthatforeachactionbytheIRS,theattackerwasallowedtotake2actions.In5sce-narios(outof64),RREcausedmorerecoverycostthanitsstaticcompetitor,thereasonbeingthatRREchoosestheop-timalresponseactionundertheassumptionthattheactionratiois1.9.RelatedWorkFLIPS[16],ahost-basedapplication-levelﬁrewall,usestheselectivetransactionaltechniquetoemulateselectedap-plicationpiecespriortotheirrealexecution,andtakesstaticresponseactionsifanyanomalousbehaviorisdetected.Musmanetal.[18]presentedSoSMARTwhichemployscase-basedreasoningtomatchthecurrentsystemstatetothesituationspreviouslyidentiﬁedasintrusive.AstaticallymappedresponseselectionschememakesFLIPSandSoS-MARTefﬁcientandeasytoimplement,butdiminishestheirﬂexibilitywhendeployedinadynamicallychangingreal-worldenvironment.EMERALD[20]isadynamiccooperativeresponsesys-teminwhichtheresponsecomponents,inadditiontoana-lyzingIDSalerts,areabletocommunicatewiththeirpeersatothernetworklayers.AAIRS[21]providesadaptationthroughaconﬁdencemetricassociatedwithIDSalertsandthroughasuccessmetriccorrespondingtoresponseactions.AlthoughEMERALDandAAIRSoffergreatinfrastructureforautomaticIRS,theydonotattempttobalanceintrusiondamageandrecoverycost.αLADS[13]usesaPOMDPtoaccountforimperfectstateinformation;however,αLADSisnotapplicableingeneral-purposedistributedsystemsduetoitsrelianceonlocalresponsesandspeciﬁcproﬁle-basedIDS.Balepinetal.[2]addressanautomatedIRSthatusesaresourcetypehierarchytreeandthesystemmap.BothαLADSandtheIRSin[2]canbeexploitedbytheadversary,sinceneitherofthemtakesintoaccountthemaliciousattacker’spotentialnextactionswhilechoosingresponseactions.GametheoryinanIRS-relatedcontexthasalsobeenuti-lizedinpreviouspapers.Lyeetal.[17]modeltheinterac-tionsbetweenanattackerandtheadministratorasatwo-playersimultaneousgameinwhicheachplayermakesde-cisionswithoutknowledgeofthestrategiesbeingchosenbytheotherplayer;however,inreality,IDSeshelpadministra-torsﬁgureoutwhattheattackerhasdonebeforetheydecideuponresponseactions,asinsequentialgames.AOAR[4],createdbyBloemetal.,isusedtodecidewhethereachat-tackshouldbeforwardedtotheadministratorortakencareofbytheautomatedresponsesystem.Useofasingle-stepgamemodelmakestheAOARvulnerabletomulti-stepse-curityattacksinwhichtheattackersigniﬁcantlydamagesthesystemwithanintelligentlychosensequenceofindi-viduallynegligibleadversarialactions.ADEPTS[10]usesI-GRAPH,i.e.,graphsofintrusiongoals,todeterminethespreadoftheintrusionandtheap-propriateresponse.Asubtle,yetsigniﬁcant,differencebe-tweenI-GRAPHSandtheARTisthattheformerisde-signedaccordingtointrusionscenarios,whilethelatterisbasedonconsequencesregardlessoftheattackscenariosthatcausethem.SARA[15]consistsofseveralcompo-nentsthatfunctionassensors,detectors,arbitrators(deci-sionengines),andresponders(responseimplementation);however,itdoesnotstudyaparticularresponsestrategy.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
448
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:14 UTC from IEEE Xplore.  Restrictions apply. 
 0 20 40 60 80 100 120 140 0 5 10 15 20 25 30 35 40 45time-to-response (sec)# nodes in attack-response tree(a)Completestatespacegenerated 0 5 10 15 20 25 30 35 40 0 100 200 300 400 500 600 700 800 900time-to-response (sec)# nodes in attack-response tree(b)Finitelookahead:2steps 0 20 40 60 80 100 120Recovery costStarting scenarios (64)Complete state spaceFinite lookahead: 2 steps(c)RecoverycostcomparisonFigure7.Scalabilityimprovementandrecoverycostoverheadusingﬁnitelookaheadsolution10.ConclusionsAgame-theoreticintrusionresponseengine,calledtheResponseandRecoveryEngine(RRE),waspresented.WemodeledthesecuritymaintenanceofcomputernetworksasaStackelbergstochastictwo-playergameinwhichtheat-tackerandresponseenginetrytomaximizetheirownben-eﬁtsbytakingoptimaladversaryandresponseactions,re-spectively.UsinganextendedattacktreestructurecalledtheAttack-ResponseTree(ART),RREexplicitlytakesintoaccountinaccuraciesassociatedwithIDSalertsinestimat-ingthesecuritystateofthesystem.Moreover,RREex-plorestheintentionalmaliciousattacker’snextpossibleac-tionspacebeforedecidingupontheoptimalresponseac-tion,sothatitisguaranteedthattheattackercannotcausegreaterdamagethanwhatRREpredicts.ExperimentsshowthatRREtakesappropriatecountermeasureactionsagainstongoingattacks,andbringsaninsecurenetworktoitsnor-maloperationalmodewiththeminimumpossiblecost.AcknowledgmentsThismaterialisbaseduponworksupportedbytheNa-tionalScienceFoundationunderGrantNo.CNS-0524695,aspartoftheNSF/DOE/DHSTrustworthyCyberInfras-tructureforPowerCenter(http://tcip.iti.illinois.edu).References[1]A.Avizienis,J.Laprie,B.Randell,andC.Landwehr.Basicconceptsandtaxonomyofdependableandsecurecomputing.IEEETrans.onDep.andSec.Comp.,1:11–33,2004.[2]I.Balepin,S.Maltsev,J.Rowe,andK.Levitt.Us-ingspeciﬁcation-basedintrusiondetectionforautomatedre-sponse.Proc.oftheInt’lSymp.onRecentAdvancesinIntru-sionDetection,pages136–54,2003.[3]R.Bellman.DynamicProgramming.PrincetonUniversityPress,1957;republished2003.[4]M.Bloem,T.Alpcan,andT.Basar.Intrusionresponseasaresourceallocationproblem.Proc.ofConf.onDecisionandControl,pages6283–8,2006.[5]A.Cassandra.ExactandApproximateAlgorithmsforPar-tiallyObservableMarkovDecisionProcesses.PhDthesis:BrownUniversity,1998.[6]F.Cohen.Simulatingcyberattacks,defenses,andconse-quences.JournalofComp.andSec.,18:479–518,1999.[7]T.Dean,L.Kaelbling,J.Kirman,andA.Nicholson.Plan-ningundertimeconstraintsinstochasticdomains.ArtiﬁcialIntelligence,76:35–74,1995.[8]J.FilarandK.Vrieze.CompetitiveMarkovDecisionPro-cesses.Springer-Verlag,1997.[9]B.Foo,M.Glause,G.Howard,Y.Wu,S.Bagchi,andE.Spafford.Informationassurance:DependabilityandSe-curityinNetworkedSystems.MorganKaufmann,2007.[10]B.Foo,Y.Wu,Y.Mao,S.Bagchi,andE.Spafford.Adepts:adaptiveintrusionresponseusingattackgraphsinane-commerceenvironment.Proc.ofDependableSystemsandNetworks,pages508–17,2005.[11]S.HsuandA.Arapostathis.CompetitiveMarkovdecisionprocesseswithpartialobservation.Proc.ofIEEElnt.Conf.onSystems,ManandCybemetics,1:236–41,2004.[12]L.Kaelbling,M.Littman,andA.Cassandra.Partiallyob-servableMarkovdecisionprocessesforartiﬁcialintelligence.Proc.oftheGermanConferenceonArtiﬁcialIntelligence:AdvancesinArtiﬁcialIntelligence,981:1–17,1995.[13]O.P.KreidlandT.M.Frazier.Feedbackcontrolappliedtosurvivability:Ahost-basedautonomicdefensesystem.IEEETrans.onReliability,53:148–66,2004.[14]C.Kruegel,W.Robertson,andG.Vigna.Usingalertveri-ﬁcationtoidentifysuccessfulintrusionattempts.Info.Pro-cessingandCommunication,27:220–8,2004.[15]S.Lewandowski,D.Hook,G.O’Leary,J.Haines,andM.Rossey.SARA:Survivableautonomicresponsearchi-tecture.Proc.oftheDARPAInfo.SurvivabilityConf.andExpositionII,1:77–88,2001.[16]M.Locasto,K.Wang,A.Keromytis,andS.Stolfo.FLIPS:Hybridadaptiveintrusionprevention.Proc.oftheSymp.onRecentAdvancesinIntrusionDetection,pages82–101,2005.[17]K.LyeandJ.Wing.Gamestrategiesinnetworksecurity.Int’lJournalofInfo.Security,4:71–86,2005.[18]S.MusmanandP.Flesher.Systemorsecuritymanagersadaptiveresponsetool.Proc.oftheDARPAInfo.Survivabil-ityConf.andExposition,2:56–68,2000.[19]G.Owen.GameTheory.AcademicPress,1995.[20]P.PorrasandP.Neumann.EMERALD:Eventmonitoringenablingresponsestoanomalouslivedisturbances.Proc.oftheInfo.SystemsSecurityConf.,pages353–65,1997.[21]D.Ragsdale,C.Carver,J.Humphries,andU.Pooch.Adap-tationtechniquesforintrusiondetectionandintrusionre-sponsesystem.Proc.oftheIEEEInt’lConf.onSystems,Man,andCybernetics,pages2344–9,2000.[22]R.Rehman.IntrusionDetectionSystemswithSnort.Prentice-Hall,2003.[23]B.Schneier.Secrets&Lies:DigitalSecurityinaNetworkedWorld.JohnWiley&Sons,2000.[24]A.SomayajiandS.Forrest.Automatedresponseusingsys-temcalldelay.Proc.oftheUSENIXSecuritySymp.,pages185–97,2000.[25]E.Sondik.TheOptimalControlofPartiallyObservableMarkovProcesses.PhDThesis:StandfordUniversity,1971.[26]N.Stakhanova,S.Basu,andJ.Wong.Ataxonomyofintru-sionresponsesystems.Int’lJournalonInfo.andComputerSecurity,pages169–84,2007.[27]A.ValdesandK.Skinner.Adaptive,model-basedmonitor-ingforcyberattackdetection.Proc.oftheRecentAdvancesinIntrusionDetection,pages80–92,2000.[28]G.White,E.Fisch,andU.Pooch.Cooperatingsecuritymanagers:Apeer-basedintrusiondetectionsystem.IEEENetwork,pages20–3,1996.