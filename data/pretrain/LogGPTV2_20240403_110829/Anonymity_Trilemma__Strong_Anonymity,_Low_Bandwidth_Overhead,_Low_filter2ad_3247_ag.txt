### Computing the Advantage of a Sophisticated Attacker Against the Protocol

To compute the advantage of a more sophisticated attacker against this protocol, we need to analyze the potential vulnerabilities and the effectiveness of the attacker's strategies. This involves a detailed examination of the protocol's security properties and the attacker's capabilities.

### Acknowledgments

We extend our gratitude to the reviewers for their insightful and valuable comments. This work has been partially supported by the Zurich Information Security Center (ZISC), the European Commission through H2020-DS-2014-653497 PANORAMIX, the EPSRC Grant EP/M013-286/1, and the National Science Foundation (NSF) under grant CNS-1719196.

### References

1. **The Tor Project**  
   - URL: https://www.torproject.org/  
   - Accessed: November 2017

2. **A. Johnson, C. Wacek, R. Jansen, M. Sherr, and P. Syverson**  
   - Title: "Users get routed: Traffic correlation on Tor by realistic adversaries"  
   - Conference: Proc. ACM SIGSAC Conference on Computer & Communications Security 2013  
   - Year: 2013  
   - Pages: 337–348

3. **L. Øverlier and P. F. Syverson**  
   - Title: "Locating Hidden Servers"  
   - Conference: Proc. 27th IEEE Symposium on Security and Privacy  
   - Year: 2006  
   - Pages: 100–114

4. **S. J. Murdoch and G. Danezis**  
   - Title: "Low-cost traffic analysis of Tor"  
   - Conference: Proc. IEEE Symposium on Security and Privacy 2005  
   - Year: 2005

5. **K. S. Bauer, D. McCoy, D. Grunwald, T. Kohno, and D. C. Sicker**  
   - Title: "Low-resource routing attacks against Tor"  
   - Conference: Proc. 6th ACM Workshop on Privacy in the Electronic Society (WPES)  
   - Year: 2007  
   - Pages: 11–20

6. **Y. Sun, A. Edmundson, L. Vanbever, O. Li, J. Rexford, M. Chiang, and P. Mittal**  
   - Title: "RAPTOR: Routing attacks on privacy in Tor"  
   - Conference: Proc. 24th USENIX Security Symposium  
   - Year: 2015

7. **R. Jansen, F. Tschorsch, A. Johnson, and B. Scheuermann**  
   - Title: "The sniper attack: Anonymously deanonymizing and disabling the Tor network"  
   - Conference: Proc. Network and Distributed Security Symposium - NDSS '14  
   - Year: 2014

8. **Y. Gilad and A. Herzberg**  
   - Title: "Spying in the Dark: TCP and Tor Traffic Analysis"  
   - Conference: Proc. 12th Privacy Enhancing Technologies Symposium (PETS 2012)  
   - Year: 2012

9. **The Tor Blog**  
   - Title: "One cell is enough to break Tor’s anonymity"  
   - URL: https://blog.torproject.org/blog/one-cell-enough  
   - Accessed: November 2017

10. **R. Dingledine, N. Mathewson, and P. Syverson**  
    - Title: "Tor: The Second-Generation Onion Router"  
    - Conference: Proc. 13th USENIX Security Symposium (USENIX)  
    - Year: 2004  
    - Pages: 303–320

11. **S. Chakravarty, M. V. Barbera, G. Portokalidis, M. Polychronakis, and A. D. Keromytis**  
    - Title: "On the effectiveness of traffic analysis against anonymity networks using flow records"  
    - Conference: Proc. 15th International Conference on Passive and Active Measurement  
    - Year: 2014  
    - Pages: 247–257

12. **N. Gelernter and A. Herzberg**  
    - Title: "On the limits of provable anonymity"  
    - Conference: Proc. Workshop on Privacy in the Electronic Society (WPES 2013)  
    - Year: 2013  
    - Pages: 225–236

13. **A. Hevia and D. Micciancio**  
    - Title: "An indistinguishability-based characterization of anonymous channels"  
    - Conference: Proc. Eighth International Symposium on Privacy Enhancing Technologies (PETS 2008)  
    - Editors: N. Borisov and I. Goldberg  
    - Year: 2008  
    - Pages: 24–43

14. **A. Serjantov, R. Dingledine, and P. Syverson**  
    - Title: "From a trickle to a flood: Active attacks on several mix types"  
    - Conference: 5th Information Hiding Workshop (IH 2002)  
    - Year: 2003  
    - Pages: 36–52

15. **D. Chaum**  
    - Title: "The dining cryptographers problem: Unconditional sender and recipient untraceability"  
    - Journal: Journal of Cryptology  
    - Volume: 1  
    - Issue: 1  
    - Pages: 65–75  
    - Year: 1988

16. **T. Ruffing, P. Moreno-Sanchez, and A. Kate**  
    - Title: "P2P Mixing and Unlinkable Bitcoin Transactions"  
    - Conference: Proc. 25th Annual Network & Distributed System Security Symposium (NDSS)  
    - Year: 2017

17. **H. Corrigan-Gibbs and B. Ford**  
    - Title: "Dissent: Accountable Anonymous Group Messaging"  
    - Conference: Proc. 17th ACM Conference on Computer and Communication Security (CCS)  
    - Year: 2010  
    - Pages: 340–350

18. **P. Golle and A. Juels**  
    - Title: "Dining cryptographers revisited"  
    - Conference: Proc. of Eurocrypt 2004  
    - Year: 2004

19. **H. Corrigan-Gibbs, D. I. Wolinsky, and B. Ford**  
    - Title: "Proactively Accountable Anonymous Messaging in Verdict"  
    - Conference: Proc. 22nd USENIX Security Symposium  
    - Year: 2013  
    - Pages: 147–162

20. **J. van den Hooff, D. Lazar, M. Zaharia, and N. Zeldovich**  
    - Title: "Vuvuzela: Scalable private messaging resistant to traffic analysis"  
    - Conference: Proc. 25th ACM Symposium on Operating Systems Principles (SOSP 2015)  
    - Year: 2015

21. **A. Kwon, D. Lazar, S. Devadas, and B. Ford**  
    - Title: "Riffle: An Efficient Communication System With Strong Anonymity"  
    - Conference: Proc. Privacy Enhancing Technologies Symposium (PETS 2016)  
    - Year: 2016  
    - Pages: 115–134

22. **D. I. Wolinsky, H. Corrigan-Gibbs, B. Ford, and A. Johnson**  
    - Title: "Dissent in Numbers: Making Strong Anonymity Scale"  
    - Conference: 10th USENIX Symposium on Operating Systems Design and Implementation (OSDI 12)  
    - Year: 2012  
    - Pages: 179–182

23. **S. Le Blond, D. Choffnes, W. Zhou, P. Druschel, H. Ballani, and P. Francis**  
    - Title: "Towards Efficient Traffic-analysis Resistant Anonymity Networks"  
    - Conference: Proc. ACM SIGCOMM 2013  
    - Year: 2013  
    - Pages: 303–314

24. **A. Piotrowska, J. Hayes, T. Elahi, S. Meiser, and G. Danezis**  
    - Title: "The loopix anonymity system"  
    - Conference: Proc. 26th USENIX Security Symposium  
    - Year: 2017

25. **S. Le Blond, D. Choffnes, W. Caldwell, P. Druschel, and N. Merritt**  
    - Title: "Herd: A Scalable, Traffic Analysis Resistant Anonymity Network for VoIP Systems"  
    - Conference: Proc. ACM Conference on Special Interest Group on Data Communication (SIGCOMM 2015)  
    - Year: 2015  
    - Pages: 639–652

26. **M. Backes, A. Kate, P. Manoharan, S. Meiser, and E. Mohammadi**  
    - Title: "AnoA: A Framework For Analyzing Anonymous Communication Protocols"  
    - Conference: Proc. 26th IEEE Computer Security Foundations Symposium (CSF 2013)  
    - Year: 2013  
    - Pages: 163–178

27. **M. Backes, A. Kate, P. Manoharan, S. Meiser, and E. Mohammadi**  
    - Title: "AnoA: A Framework For Analyzing Anonymous Communication Protocols"  
    - Journal: Journal of Privacy and Confidentiality (JPC)  
    - Volume: 7  
    - Issue: 2  
    - Number: 5  
    - Year: 2016

28. **K. Jensen**  
    - Title: Colored Petri Nets. Basic Concepts, Analysis Methods and Practical Use.  
    - Year: 1997  
    - Volume: 3

29. **W. Reisig**  
    - Title: Primer in Petri Net Design  
    - Edition: 1st  
    - Year: 1992

30. **L. M. Kristensen, S. Christensen, and K. Jensen**  
    - Title: "The practitioners guide to coloured petri nets"  
    - Journal: International Journal on Software Tools for Technology Transfer (STTT)  
    - Volume: 2  
    - Issue: 2  
    - Pages: 98–132  
    - Year: 1998

31. **T. K. Srikanth and S. Toueg**  
    - Title: "Simulating authenticated broadcasts to derive simple fault-tolerant algorithms"  
    - Journal: Distributed Computing  
    - Volume: 2  
    - Issue: 2  
    - Pages: 80–94  
    - Year: 1987

32. **R. Gennaro, M. O. Rabin, and T. Rabin**  
    - Title: "Simplified VSS and fact-track multiparty computations with applications to threshold cryptography"  
    - Conference: Proc. ACM PODC  
    - Year: 1998  
    - Pages: 101–111

33. **D. Das, S. Meiser, E. Mohammadi, and A. Kate**  
    - Title: "Anonymity trilemma: Strong anonymity, low bandwidth, and low latency—choose two"  
    - Source: Cryptology ePrint Archive, Report 2017/954  
    - URL: https://eprint.iacr.org/2017/954  
    - Year: 2017

34. **J. Feigenbaum, A. Johnson, and P. Syverson**  
    - Title: "A probabilistic analysis of onion routing in a black-box model"  
    - Conference: Proc. Workshop on Privacy in the Electronic Society (WPES 2007)  
    - Year: 2007

35. **D. Wikström**  
    - Title: "A Universally Composable Mix-Net"  
    - Conference: Proc. 1st Theory of Cryptography Conference (TCC)  
    - Year: 2004  
    - Pages: 317–335

36. **J. Camenisch and A. Lysyanskaya**  
    - Title: "A formal treatment of onion routing"  
    - Conference: Proc. CRYPTO 2005  
    - Year: 2005  
    - Pages: 169–187

37. **N. Kiyavash, A. Houmansadr, and N. Borisov**  
    - Title: "Multi-flow Attacks Against Network Flow Watermarking Schemes"  
    - Conference: Proc. 17th USENIX Security Symposium  
    - Year: 2008

38. **S. Oya, C. Troncoso, and F. Pérez-González**  
    - Title: "Do dummies pay off? Limits of dummy traffic protection in anonymous communications"  
    - Conference: Proc. 14th Privacy Enhancing Technologies Symposium (PETS 2014)  
    - Year: 2014

39. **G. Danezis**  
    - Title: "Statistical disclosure attacks: Traffic confirmation in open environments"  
    - Conference: Proc. Security and Privacy in the Age of Uncertainty (SEC2003)  
    - Year: 2003  
    - Pages: 421–426

40. **G. Danezis and A. Serjantov**  
    - Title: "Statistical disclosure or intersection attacks on anonymity systems"  
    - Conference: Proc. 6th Information Hiding Workshop (IH 2004)  
    - Year: 2004

41. **M. J. Freedman, K. Nissim, and B. Pinkas**  
    - Title: "Efficient private matching and set intersection"  
    - Conference: Proc. EUROCRYPT 2004  
    - Year: 2004

42. **F. Pérez-González and C. Troncoso**  
    - Title: "Understanding statistical disclosure: A least squares approach"  
    - Conference: Proc. 12th Privacy Enhancing Technologies Symposium (PETS 2012)  
    - Year: 2012  
    - Pages: 38–57

43. **M. Backes, P. Manoharan, and E. Mohammadi**  
    - Title: "TUC: Time-sensitive and Modular Analysis of Anonymous Communication"  
    - Source: IACR ePrint Archive Report 2013/664  
    - URL: http://www.infsec.cs.uni-saarland.de/mohammadi/paper/tuc.pdf  
    - Year: 2013

44. **R. Dingledine, N. Mathewson, and P. Syverson**  
    - Title: "Tor: The second-generation onion router"  
    - Conference: Proc. 13th USENIX Security Symposium  
    - Year: 2004

45. **D. Dolev, R. Reischuk, and H. R. Strong**  
    - Title: "Early stopping in Byzantine agreement"  
    - Journal: J. ACM  
    - Volume: 37  
    - Issue: 4  
    - Pages: 720–741  
    - Year: 1990

46. **D. Kesdogan, J. Egner, and R. Büsskes**  
    - Title: "Stop-and-go MIXes: Providing probabilistic anonymity in an open system"  
    - Conference: Proc. Information Hiding Workshop (IH 1998)  
    - Year: 1998

47. **G. Danezis, C. Díaz, C. Troncoso, and B. Laurie**  
    - Title: "Drac: An architecture for anonymous low-volume communications"  
    - Conference: Proc. 10th Privacy Enhancing Technologies Symposium (PETS 2010)  
    - Year: 2010

48. **P. Mittal, M. Wright, and N. Borisov**  
    - Title: "Pisces: Anonymous communication using social networks"  
    - Conference: Proc. 20th Network and Distributed System Security Symposium (NDSS 2013)  
    - Year: 2013

49. **C. Chen, D. E. Asoni, D. Barrera, G. Danezis, and A. Perrig**  
    - Title: "HORNET: High-speed onion routing at the network layer"  
    - Conference: Proc. ACM Conference on Computer and Communications Security (CCS)  
    - Year: 2015  
    - Pages: 1441–1454

50. **H. Corrigan-Gibbs, D. Boneh, and D. Mazières**  
    - Title: "Riposte: An anonymous messaging system handling millions of users"  
    - Conference: Proc. 36th IEEE Symposium on Security and Privacy (S&P 2015)  
    - Year: 2015  
    - Pages: 321–338

51. **Anonymity Trilemma Project Webpage**  
    - Title: "Anonymity trilemma: Strong anonymity, low bandwidth overhead, low latency overhead—choose two"  
    - URL: https://freedom.cs.purdue.edu/projects/anonymity/trilemma/

### Table I: Latency vs. Bandwidth vs. Strong Anonymity of AC Protocols

| Protocol | Latency | Bandwidth | Strong Anonymity |
|----------|---------|-----------|------------------|
| Tor [10] | θ(1) | θ(1/N) | Impossible |
| Hornet [49] | θ(1) | θ(1/N) | Impossible |
| Herd [25] | θ(1) | θ(N/N) | Possible |
| Riposte [50] | θ(N) | θ(N/N) | Possible |
| Vuvuzula [20] | θ(K) | θ(N/N) | Possible |
| Riffle [21] | θ(K) | θ(N/N) | Possible |
| Threshold mix [14] | √θ(TK) | θ(1/N) | Impossible* |
| Loopix [24] | θ(1) | θ(β) | Possible |
| DC-Net [15], [18] | θ(1) | θ(N/N) | Possible |
| Dissent-AT [22] | θ(1) | θ(N/N) | Possible |
| DiceMix [16] | θ(1) | θ(N/N) | Possible |

*If T is in o(poly(η))

### Appendix A: Protocol Model Revisited

#### A. Validity of the Protocol Model (Continued)

**Lemma 2.** Let Π be a protocol ∈ M with K parties and parameters β and (cid:4). Then:
1. Messages are delivered within (cid:4) steps.
2. The protocol adds (for the unsynchronized case, on average) a maximum of β noise messages per user per round.
3. Whenever a party in S ∪ P sends a message to another party in P ∪ R, the adversary learns that and in which round this happens.
4. For every message that leaves the network (received by R), the adversary additionally learns whether the message is the target message.
5. For every compromised party, the adversary learns the mapping between the input messages and the output messages.

**Proof.** Let Π be a protocol ∈ M with K parties and parameters β and (cid:4).

- **Part (2):** This holds because we restrict the user distributions accordingly, and none of the transitions in the Petri net can create more tokens within the network than it consumes from its input place.

- **Part (1):** We show this via structural induction over fired transitions of the Petri net. We add to the induction invariant that all tokens not in S have a timestamp for their next transition of ts = 1 and a remaining time of tr > 0, and there are at least tr rounds left in which the token can be delivered.

  - **Induction Base:** The protocol is initialized, and no transitions have happened. Thus, no messages have been sent, and there is no message that has not been delivered within (cid:4) steps. The only transition that can fire is TS, and for (cid:4) > 0, the message introduced into the network does not need to be delivered already (0 < (cid:4)).

  - **Induction Step:** Assume the lemma holds for up to k-1 rounds. In the k-th round, if the transition is TR, it consumes a token from R, sets ts = 1, and tr > 0. If the token has tr-1 = 0, the transition delivers the token to R. Otherwise, t decreases tr by one and sets ts = 1. Since every token in any place Pi needs to be consumed in every round, the protocol delivers every message in at most (cid:4) steps.

- **Other Parts:** By definition of our Petri net, whenever a transition fires, an element (t, r) is placed into Tokens, containing the public fields of t, such as t.prev and t.next, as well as the current round number r, which fulfills part (3). Moreover, whenever the transition places the token in R, the adversary can see the field t.msg, and no transition can change the field msg, allowing the adversary to tag and recognize the challenge message, thus fulfilling part (4). Finally, if any party Pi is compromised, Pi does not modify the unique (and otherwise freshly sampled) field t.IDt, which allows the adversary to map incoming and outgoing messages, fulfilling part (5).

Since the transitions discussed here are the only way for messages to be sent to a recipient, the model correctly enforces the conditions from the lemma.

#### B. Expressing Protocols in the Petri Net Model

**Modeling DC Net.** Here we show how to model an actual DC net type protocol using our Petri net model M as defined in Section IV. Specifically, we pick up the short DC net protocol proposed by Golle and Juels [18], and present MDC, which models the aforementioned protocol.

We model a DC net protocol with N participants, where S = P, |S| = |P| = N. We denote the parties with P1, ..., PN. The protocol can be denoted by ΠDC = {paramgen, keydist, post, verify, extract} - as described below.

- **paramgen:** In protDC, paramgen is executed by a trusted entity, and the output is published. Since we are mainly interested in the anonymity game, we consider that paramgen is executed by our honest challenger and happens outside the protocol run, and the output is globally known (to all the transitions TPi).

- **keydist:** Using the output of paramgen, this step yields for each party Pi a private key xi and a corresponding public key yi. In protDC, the above key generation part is done by a trusted entity, and hence we consider that it is done by our honest challenger, and for each party Pi, the public-private keypair xi, yi is already known to the corresponding transition TPi.