September 1
301
11
108
0
3
21
18
Table 1: Natural variability in the trackers observed on different
visits to the Alexa top 100 in 2015. This variability can result
from non-static webpage content, e.g., ad auctions that result in
different winners.
4.1 Lesson (Challenge): The Wayback Machine
provides a partial view of third-party requests
A key question for using the Wayback Machine for his-
torical measurements is: how complete is the archive’s
view of the past, both for the top-level pages and for
the embedded content? In this lesson, we explore why
its view is incomplete, surfacing challenges that we will
overcome in subsequent lessons. We identify several rea-
sons for the differences between the live and Wayback
measurements, and quantify the effects of each.
Variation Between Visits. Different trackers and other
third parties may appear on a site when it is loaded a
second time, even if these views are close together; an
example of this variation would be disparity in tracking
behaviors between ads in an ad network.
To estimate the degree of variation between page
views, we compare three live runs from August-
September 2015 of the Alexa top 100 sites (Table 1).
We ﬁnd that variation between runs even a week apart
is notable (though not enough to account for all of the
differences between Wayback and live datasets). For the
number of Vanilla trackers found, the August 25th and
September 1st runs vary by 7 trackers, or 6%.
Non-Archived and Blocked Requests. There are sev-
eral reasons that the Wayback Machine may fail to
archive a response to a request, or provide a response that
TrackingExcavator must ignore (e.g., from a far different
time than the one we requested or from the live web).
We describe these conditions here, and evaluate them in
the context of a Wayback Machine crawl of the top 500
pages archived in 2015, according to the 2015 Alexa top
500 rankings; we elaborate on this dataset in Section 5.
Table 2 summarizes how often the various conditions oc-
cur in this dataset, for requests, unique URLs, and unique
domains. In the case of domains, we count only those do-
mains for which all requests are affected, since those are
the cases where we will never see a cookie or any other
subsequent tracking indicators for that domain.
Robots.txt Exclusions (403 errors).
If a domain’s
robots.txt asks that it not be crawled, the Wayback
Machine will respect that restriction and thus not archive
1002  25th USENIX Security Symposium 
USENIX Association
6
USENIX Association  
25th USENIX Security Symposium  1003
TypeofBlockingFractionMissedRequests1115/56,173(2.0%)RobotsExclusionsURLs609/27,532(2.2%)Domains18/1150(1.6%)Requests809/56,173(1.4%)NotArchivedURLs579/27,532(2.1%)Domains8/1150(0.7%)Requests9025/56,173(16.1%)WaybackEscapesURLs4730/27,532(17.2%)Domains132/1150(11.5%)Requests404/56,173(0.7%)InconsistentTimestampsURLs156/27,532(0.6%)Domains55/1150(4.8%)Table2:ForthearchivedversionsoftheAlexatop500sitesfrom2015,thefractionofrequests,uniqueURLs,anduniquedomainsaffectedbyrobotsexclusion(403errors),notarchived(404),Waybackescapes(blockedbyTrackingExcavator),orinconsistenttimestamps(ﬁlteredbyTrackingExcavator).theresponse.Asaresult,wewillnotreceiveanyin-formationaboutthatsite(includingcookies,oruseofJavascript)norwillweseeanysubsequentresourcesthatwouldhaveresultedfromthatrequest.Weﬁndthatonlyasmallfractionofallrequests,uniqueURLs,and(complete)domainsareaffectedbyrobotsexclusion(Table2).Wenotethatrobotsexclu-sionsareparticularlycommonforpopulartrackers.Ofthe20mostpopulartrackersonthe2015livedataset,12(60%)areblockedatleastoncebyrobots.txtinthe2015Waybackmeasurement.Bycontrast,thisistrueforonly74/456,or16.23%,ofallVanillatrackersseeninlive.OtherFailurestoArchive(404errors).TheWaybackMachinemayfailtoarchiveresourcesforanynumberofreasons.Forexample,thedomainservingacertainresourcemayhavebeenunavailableatthetimeofthearchive,orchangesintheWaybackMachine’scrawlermayresultindifferentarchivingbehaviorsovertime.AsshowninTable2,missingarchivesarerare.URLRewritingFailures(Wayback“Escapes”).ThoughtheWaybackMachine’sarchivedpagesexecutethecor-respondingarchivedJavaScriptwithinthebrowserwhenTrackingExcavatorvisitsthem,theWaybackMachinedoesnotexecuteJavaScriptduringitsarchivalcrawlsoftheweb.Instead,itattemptstostaticallyextractURLsfromHTMLandJavaScripttoﬁndadditionalsitestoarchive.ItthenmodiﬁesthearchivedJavaScript,rewritingtheURLsintheincludedscripttopointtothearchivedcopyoftheresource.Thisprocessmayfail,particularlyfordynamicallygeneratedURLs.Asaresult,whenTrackingExcavatorvisitsarchivedpages,dynamicallygeneratedURLsnotproperlyredirectedtotheirarchivedversionswillcausethepagetoattempttomakearequesttotheliveweb,i.e.,“escape”thearchive.TrackingExcavatorblockssuchescapes(seeSection3).Asaresult,thescriptneverrunsonthearchivedsite,neversetsacookieorleaksit,andthusTrackingExcava-Figure3:ThefractionofdomainscategorizedasVanillatrack-ersinthelive2015crawlwhich,inthearchival2015crawl,(1)setandleakedcookiesandthuswereconﬁrmedastrackers,(2)wereonlythird-partyrequests(hadatleastonethird-partyrequestbutnocookies),(3)didnotappearatall,or(4)other(e.g.,hadcookiesbutnotatthetimeofathird-partyrequest,orcookieswerenotattachedduetoacookiesimulationbug).tordoesnotwitnesstheassociatedtrackingbehavior.WeﬁndthatWayback“escapes”aremorecommonthanrobotsexclusionormissingarchives(Table2):16.1%ofallrequestsattemptedto“escape”(i.e.,werenotproperlyrewrittenbytheWaybackMachine)andwereblockedbyTrackingExcavator.InconsistentTimestamps.Asothershavedocu-mented[10],embeddedresourcesinawebpagearchivedbytheWaybackMachinemayoccasionallyhaveatimes-tampfarfromthetimestampofthetop-levelpage.Asde-scribedinSection3,weignoreresponsestorequestsforresourceswithtimestampsmorethansixmonthsaway.CascadingFailures.Anyoftheabovefailurescanleadtocascadingfailures,inthatnon-archivedresponsesorblockedrequestswillresultintheomissionofanysub-sequentrequestsorcookiesettingeventsthatwouldhaveresultedfromthesuccessoftheoriginalrequest.The“wake”ofasinglefailurecannotbemeasuredwithinanarchivaldataset,becauseeventsfollowingthatfailurearesimplymissing.Tostudytheeffectofthesecascadingfailures,wemustcompareanarchivalruntoaliverunfromthesametime;wedosointhenextsubsection.4.2Lesson(Opportunity):Considerallthird-partyrequests,inadditiontoconﬁrmedtrackersIntheprevioussection,weevaluatedtheWaybackMa-chine’sviewofthird-partyrequestswithinanarchivalmeasurement.ForrequestsaffectedbytheissuesinTa-ble2,TrackingExcavatorobservestheexistenceoftheserequests—i.e.,countsthemasthirdparties—butwith-outthecorrespondingresponsemaymissadditionalin-formation(e.g.,setcookies)thatwouldallowittocon-ﬁrmthesedomainsastrackersaccordingtothetaxonomypresentedearlier.However,thisanalysiscannotgiveusasenseofhowmanythird-partyrequestsareentirelyab-sentfromWaybackdataduetocascadingfailures,norasenseofanyotherdatamissingfromthearchive,suchas7Wayback (All Third Parties)
Wayback (Vanilla+Personal)
Live (Vanilla+Personal)
Wayback-to-Live Ratio
(Vanilla+Personal)
2011
553
47
370
2013
621
49
419
2015
749
92
493
2016
723
90
459
0.13
0.12
0.19
0.20
Table 3: We compare the prevalence of the most common track-
ing types (Vanilla and Personal) over the four years for which
we have data from the live web. Though the Wayback Machine
provides only partial data on trackers, it nevertheless illumi-
nates a general upward trend reﬂected in our ground truth data.
missing cookie headers on otherwise archived responses.
For that, we must compare directly with live results.
We focus our attention on unique trackers: we attempt
to identify which live trackers are missing in the 2015
Wayback dataset, and why. For each tracker we ob-
serve in our 2015 live measurement, Figure 3 identiﬁes
whether we (1) also observe that tracker in “Wayback
mode,” (2) observe only a third-party request (but no con-
ﬁrmed cookie-based tracking behavior, i.e., we classify it
only as a third-party domain), or (3) do not observe any
requests to that tracker at all.
We conclude two things from this analysis. First, be-
cause the Wayback Machine may fail to provide suf-
ﬁcient data about responses or miss cookies even in
archived responses, many trackers conﬁrmed in the live
dataset appear as simple third-party requests in the Way-
back data (the second column in Figure 3). For example,
doubleclick.net, one of the most popular trackers,
appears as only a third party in Wayback data because of
its robots.txt ﬁle. Thus, we learn that to study third-
party web tracking in the past, due to missing data in the
archive, we must consider all third-party requests, not
only those conﬁrmed as trackers according to the taxon-
omy. Though considering only third-party requests will
overcount tracking in general (i.e., not all third parties on
the web are trackers), we ﬁnd that it broadens our view
of tracking behaviors in the archive.
Second, we ﬁnd that a non-trivial fraction of track-
ers are missing entirely from the archive (the third col-
umn in Figure 3). In the next subsection, we show that
we can nevertheless draw conclusions about trends over
time, despite the fact that the Wayback Machine under-
represents the raw number of third parties contacted.
4.3 Lesson (Opportunity): The Wayback Machine’s
data allows us to study trends over time
As revealed above, the Wayback Machine’s view of the
past may miss the presence of some third parties entirely.
Thus, one unfortunately cannot rely on the archive to
shed light on the exact raw numbers of trackers and other
third parties over time. Instead, we ask: does the Way-
back Machine’s data reveal genuine historical trends?
To investigate trends, we compare all of our live
datasets (2011, 2013, 2015, and 2016) to their Wayback
counterparts. Table 3 compares the number of Vanilla
and Personal trackers (the most prevalent types) detected
in each dataset. For the purposes of this comparison, we
sum the two types, since their distinction depends only
on the user’s browsing behaviors. We also include the
number of all third parties in the Wayback datasets, based
on the previous lesson. Though not all of these third par-
ties represent trackers in live data, they help illuminate
trends in third party prevalence over time.
We draw two conclusions from this comparison. First,
we ﬁnd that we can rely on the archive to illuminate gen-
eral trends over time. Although conﬁrmed trackers in
“Wayback mode” (as expected from our earlier lessons)
underrepresent the number of conﬁrmed trackers found
on the live web — and third parties in the archive overes-
timate conﬁrmed trackers in the live data — we ﬁnd that
the trends we see over time are comparable in both sets of
measurements. Critically, we see that the upward trend
in our archival view is not merely the result of improve-
ments in archive quality over time or other factors — we
indeed observe this trend reﬂected in ground truth data.
We gain further conﬁdence in these trends in Section 5,
where we see a rise in tracking behaviors since 1996 that
corresponds with our intuition. The absence of any large
vertical steps in the ﬁgures in Section 5 further suggests
that the trends we identify are artifacts of the web evolv-
ing as opposed to any signiﬁcant changes in the Wayback
Machine archival process.
Second, however, we ﬁnd that — although long-term
trends appear to be meaningfully represented by the
Wayback Machine — one should not place too much
conﬁdence into small variations in trends. For exam-
ple, the Wayback Machine’s data in 2013 appears to be
worse than in other years, under-representing the num-
ber of conﬁrmed trackers more than average. Thus, in
Section 5, we do not report on results that rely on small
variations in trends unless we have other reasons to be-
lieve that these variations are meaningful.
4.4 Lesson (Opportunity): Popular trackers are
represented in the Wayback Machine’s data
Because popular trackers, by deﬁnition, appear on many
sites that users likely browse to, they have a strong effect
on user privacy and are particularly important to exam-
ine. We ﬁnd that although the Wayback Machine misses
some trackers (for reasons discussed above), it does cap-
ture a large fraction of the most popular trackers —
likely because the Wayback Machine is more likely to
have correctly archived at least one of each popular
tracker’s many appearances.
Speciﬁcally, when we examine the 2015 archival and
live datasets, we ﬁnd that 100% of the top 20 trackers
from the live dataset are represented as either conﬁrmed
1004  25th USENIX Security Symposium 
USENIX Association
8
USENIX Association  
25th USENIX Security Symposium  1005
trackersorotherthirdpartiesintheWaybackdata.Ingeneral,morepopulartrackersarebetterrepresentedinWaybackdata:75%ofthetop100livetrackers,com-paredto53%ofalllivetrackers.Trackerpopularitydropsquickly—theﬁrstlivetrackermissinginWaybackdatais#22,whichappearsononly22ofthetop500web-sites;the100thmostpopulartrackerappearsononly4sites.Bycontrast,thetoptrackerappearson208sites.Inotherwords,thosetrackersthathavethegreatestimpactonuserprivacydoappearinthearchive.Basedonthislesson,wefocuspartofSection5’sanal-ysisinonpopulartrackers,andwemanuallylabelthosethattheWaybackMachineonlyseesasthirdpartiesbutthatweknowareconﬁrmedtrackersinlivedata.4.5Lesson(Opportunity):TheWaybackMachineprovidesadditionaldatabeyondrequestsThusfar,wehaveconsideredthird-partyrequestsandconﬁrmedcookie-basedtrackers.However,theWaybackMachineprovides,andTrackingExcavatorcollects,ad-ditionaldatarelatedtowebtrackingbehaviors,particu-larlytheuseofvariousJavaScriptAPIsthatallowthirdpartiestocollectadditionalinformationaboutusersandtheirmachines(e.g.,tore-identifyusersbasedonﬁnger-prints).ForJavaScriptcorrectlyarchivedbytheWay-backMachine,TrackingExcavatorobservesaccessestothesupportedAPIs(AppendixA).Forexample,weob-serveusesofnavigator.userAgentasearlyas1997.4.6SummaryInsummary,weﬁndthattheWaybackMachine’sviewofthepastisincomplete,andthatitsweaknessespar-ticularlyaffectthethird-partyrequestscriticalforevalu-atingwebtrackingovertime.Weidentiﬁedandquanti-ﬁedthoseweaknessesinSection4.1,andthenintroducedﬁndingsandstrategiesformitigatingtheseweaknessesinSections4.2-4.5,includingconsideringthird-partyre-questsaswellasconﬁrmedtrackers,manuallylabelingknownpopulartrackers,andstudyinggeneraltrendsovertimeinsteadofrawnumbers.Weleveragethesestrate-giesinourownmeasurements.Bysurfacingandevalu-atingtheselessons,wealsointendtohelpguidefutureresearchersrelyingondatafromtheWaybackMachine.WefocusontheWaybackMachinesinceitistoourknowledgethemostcomprehensivewebarchive.Apply-ingourapproachtoother,morespecializedarchives[58],ifrelevantforotherresearchgoals,wouldnecessitateanewevaluationoftheformwepresentedhere.5HistoricalWebTrackingMeasurementsWenowturntoourlongitudinalstudyofthird-partycookie-basedwebtrackingfrom1996-2016.Datasets.Wefocusourinvestigationonthemostpop-ularwebsiteseachyear,fortworeasons:ﬁrst,trackersFigure4:Evolutionoftrackertypesovertime.Thegreybarsshowthetotalnumberoftrackingdomainspresentineachdataset,andthecoloredlinesshowthenumbersoftrackerswitheachtypeoftrackingbehavior.Asingletrackermayhavemorethanonebehaviorinthedataset(e.g.,bothVanillaandAnalyt-ics),sothesumofthelinesmightbegreaterthanthebar.onthesesitesare(orwere)abletocollectinformationaboutthegreatestnumberofusers;second,popularsitesarecrawledmorefrequentlybytheWaybackMachine(ifpermittedbyrobots.txt).Wethusneedhistoricallistsofthetopsitesgloballyontheweb.2003-2016:Alexa.For2010-2016,weuseWaybackMa-chinearchivesofAlexa’stopmillionsiteslist(acsvﬁle).For2003-2009,weapproximatethetop500byscrapingAlexa’sownhistoricalAPI(whenavailable)andarchivesofindividualAlexatop100pages.Becauseofinconsistenciesinthosesources,ourﬁnallistscontain459-500topsitesforthoseyears.1996-2002:PopularLinksfromHomepages.In2002,onlytheAlexatop100areavailable;before2002,weonlyhaveComScore’slistof20topsites[69].Thus,tobuildalistof500popularsitesfortheyears1996-2002,wetookadvantageofthestandardpracticeatthetimeofpublishinglinkstopopulardomainsonpersonalwebsites.Speciﬁcally,welocatedarchivesofthePeoplepagesoftheComputerScienceorsimilardepartmentatthetop10U.S.CSresearchuniversitiesasof1999,asreportedinthatyearbyU.S.NewsOnline[2].Weiden-tiﬁedthetop500domainslinkedtofromthehomepagesaccessiblefromthosePeoplepages,andaddedanyCom-Scoredomainsthatwerenotfoundbythisprocess.WeranthisprocessusingPeoplepagesarchivedin1996and1999;thesepersonalpageswerenotupdatedorarchivedfrequentlyenoughtogetﬁnergranularity.Weusedthe1996listasinputtoour1996,1997and1998measure-ments,andthe1999listasinputfor1999-2002.5.1PrevalenceofTrackingBehaviorsoverTimeWebeginbystudyingtheprevalenceoftrackingbehav-iorsovertime:howmanyuniquetrackersdoweobserve,whattypesoftrackingbehaviorsdothosetrackersex-hibit,andhowmanytrackersappearonsitesovertime?9Prevalence and Behaviors of Unique Trackers. Fig-
ure 4 shows the total number of unique trackers observed
over time (the grey bars) and the prevalence of different
tracking behavior types (the lines) for the top 500 sites
from 1996-2016. Note that trackers may exhibit more
than one behavior across sites or on a single site, so the
sum of the lines may be greater than the height of the bar.
We note that the particularly large bars in 2015 and 2016
may reﬂect not only a change in tracking prevalence but
also changes in the way the Wayback Machine archived
the web. See Table 3 for validation against live data
which suggest that actual growth may have been smaller
and more linear, similar to past years.