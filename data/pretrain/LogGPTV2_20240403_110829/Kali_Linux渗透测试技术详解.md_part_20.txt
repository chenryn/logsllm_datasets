OS:
Linux Kemel 3.12-kali1-686-pae
Stat time:
:Thu Apr 24 15:04:43 2014
ewg pu3
Thu Apr 24 15:04:57 2014
KB:
peOUMOg
Vulnerabilities
图5.20漏洞信息
· 127 ·
---
## Page 140
第2篇信息的收集及利用
（7）在该界面单击INFO按钮，将显示具体的漏洞信息，如图5.21所示。
INFO
netstat portscanner (SSH)
^Plugin Detalls
Description
Severty:
Info
ID:
14272
Version:
1.57
l eunB(uos o1,suogdo suqong, uogoes eg ees
Type:
remole
Family:
Port scann
Output
Published:
2004/08/15
Modified:
2013/10/30
Port 68/udp
Risk Information
Port 
Hosts
68/ udp
Risk Faetor: None
192.168.41.234
Port 
Hosts
8834/cp/wow
192.168.41.234
pn/+L.S t 2od
图5.21漏洞详细信息
（8）该界面显示了漏洞的描述信息及扫描到的信息。例如，该主机上开启了68、8834
和15774等端口。使用Nessus还可以通过导出文件的方式查看漏洞信息，导出的文件格式
包括Nessus、PDF、HTML、CSV和NessusDB。导出文件的方式如下所示：
在图5.20中单击Export按钮，选择导出文件的格式。这里选择PDF格式，单击PDF
命令，将显示如图5.22所示的界面。
PDF Chapter Selection
Avallable Content
Report Confent
Hosts Summary (Executive)
三
Drag and organize content here
Vulnerabilties By Host
Vulr
abilities By Plugin
三
图5.22可用的内容
（9）该界面分为两部分，包括AvailableContent（可用的内容）和ReportContent（报
告内容）。该界面显示了导出的PDF文件中可包括的内容有主机摘要信息、主机漏洞和插
件漏洞。在图5.22中将要导出的内容用鼠标拖到ReportContent框中，拖入内容后将显示
· 128 ·
---
## Page 141
第5章漏洞扫描
如图5.23所示的界面。
PDF Chapter Selection
Avallable Content
Report Content
ities By Hos
三
Hosts Summary (Executive)
es By Plugin
三
图5.23导出的内容
（10）在该界面显示了将要导出的内容。此时单击Export按钮，将显示如图5.24所示
的界面。
pdzagowd-uessadues bujuodo
spd'zagasd-uesadues 
which is a: PDF 文档 (23.6 KB)
from: https://127.0.0.1:8834
Would you lice to save this file?
Cance
File
图5.24下载界面
（11）在该界面单击SaveFile按钮，指定该文件的保存位置，即PDF文件导出成功。
5.1.3扫描网络漏洞
如果用户想要使用Nessus攻击一个大范围的漏洞，需要配置评估漏洞列表并指定获取
信息的评估列表。本小节将介绍配置Nessus在目标主机寻找网络漏洞，这些漏洞指目标主
机或其他网络协议。
【实例5-2】扫描网络漏洞的具体操作步骤如下所示。
（1）新建名为IntermnalNetworkScan策略。
（2）添加所需的插件程序，如表5-1所示。
表5-1所需插件程序
CISCO
扫描CISCO系统
DNS
扫描DNS服务器
Default Unix Accounts
扫描本地默认用户账户和密码
FTP
扫描FTP服务器
Firewalls
扫描代理防火墙
Gain a shell remotely
扫描远程获取的Shell
Geeral
扫描常用的服务
· 129 ·
---
## Page 142
第2篇信息的收集及利用
续表
Netware
扫描网络操作系统
Peer-To-Peer File Sharing
扫描共享文件检测
Policy Compliance
扫描PCIDSS和SCAP信息
SCADA
扫描设置管理工具
SMTP Problems
扫描SMTP问题
SNMP
扫描SNMP相关信息
Service Detection
扫描服务侦察
Settings
扫描基本设置
（3）新建名为NetworkScan扫描任务。
（4）扫描结果如图5.25所示。
Network Scan
Export
Audit Trail
Q
Hosts >192.168.41.1)
27
Hide Detalls
Severty *
Plugin Name
Counl
Host Detalls
IP:
192.168.41.1
DNS:
localhost
SSL Self-Signed Certicate
MAC:
00:50:56:c0:00:08
OS:
Microsoft Windows 7 Ultimate
INFO
Nessus SYN scannee
Start time: Fri Apr 25 13:37:33 2014
End time: Fr1 Apr 25 13:39:16 2014
INFO
Service Detection
KB:
Download
on (CPE)
图5.25网络扫描结果
该信息使用文件的形式导出。
5.1.4扫描指定Linux的系统漏洞
本小节将介绍使用Nessus扫描指定Linux系统上的漏洞。
【实例5-3】扫描指定Linux系统漏洞的具体操作步骤如下所示。
（1）使用Metasploitable2.0作为目标主机。用户也可以使用其他版本的Linux系统。
（2）新建名为LinuxVulnerabilityScan策略。
（3）添加所需的插件程序，如表5-2所示。
表5-2所需插件程序
Backdoors
扫描秘密信息
Brute Force Attacks
暴力攻击
CentOSo Local Security Checks
扫描CentOS系统的本地安全漏洞
DNS
扫描DNS服务器
· 130 ·
---
## Page 143
第5章漏洞扫描
续表
Debian Local Security Checks
扫描Debian系统的本地安全漏洞
Default Unix Accounts
扫描默认Unix用户账号
Denial of Service
扫描拒绝的服务
FTP
扫描FTP服务器
Fedora Local Security Checks
扫描Fedora系统的本地安全漏洞
Firewalls
扫描防火墙
FreeBSD Local Security Checks
扫描FreeBSD系统的本地安全漏洞
Gain a shell remotely
扫描远程获得的Shell
General
扫描漏洞
Gentoo Local Security Checks
扫描Gentoo系统的本地安全漏洞
HP-UX Local Security Checks
扫描HP-UX系统的本地安全漏洞
Mandriva Local Security Checks
扫描Mandriva系统的本地安全漏洞
Misc
扫描复杂的漏洞
Red Hat Local Security Checks
扫描RedHat系统的本地安全漏洞
SMTP Porblems
扫描SMTP问题
SNMP
扫描SNMP漏洞
Scientific Linux Local Security Checks
扫描ScientificLinux系统的本地安全漏洞
Slackware Local Security Checks
扫描Slackware系统的本地安全漏洞
Solaris Local Security Checks
扫描Solaris系统的本地安全漏洞
SuSE Local Security Checks
扫描SuSE系统的本地安全漏洞
Ubuntu Local Security Checks
扫描Ubuntu系统的本地安全漏洞
Web Servers
扫描Web服务器
（4）新建名为LinuxVulnerabilityScan扫描任务。
（5）扫描漏洞，扫描结果如图5.26所示。
Linux Vulnera...
Export
Audit Trail
Scans）Hosts 
74
3
Notes
1
Hide Details
Host
Vulnerabilities 
Scan Detalls
192.168.41.254
Name.
Linux Vuln
Foider.
My Scans
olity Scar
192.168.41.2
11
Status:
Completed
Policy:
Linux Vulnerabity Scan
192.168.41.235
Targets:
192.168.41.0/24
Start time:
Fri Apr 25 14:06:39 2014
192.168.41.234
End time:
Fri Apr 25 14:13:09 2014
Elapsed:
7 minutes
192.168.41.1
3
192.168.41.142
7
abllitles
图5.26指定Linux系统扫描结果
· 131 •
---
## Page 144
第2篇信息的收集及利用
（6）从该界面可以看到总共扫描了6台主机上的漏洞信息。其中，主机192.168.41.142
上存在7个比较严重的漏洞。关于漏洞的百分比情况，可以从右下角的扇形图中了解到。
同样，用户可以使用前面介绍过的两种方法，查看漏洞的详细信息。
5.1.5扫描指定Windows的系统漏洞
本节将介绍使用Nessus扫描指定Windows系统上的漏洞。
【实例5-4】使用Nessus扫描指定Windows系统漏洞。本例中使用Windows7系统作
为目标主机。具体扫描步骤如下所示。
（1）新建名为WindowsVulnerabilityScan策略。
（2）添加所需的插件程序，如表5-3所示。
表5-3所需插件程序
DNS
扫描DNS服务器
Databases
扫描数据库
Denial of Service
扫描拒绝的服务
FTP
扫描FTP服务器
SMTP Problems
扫描SMTP问题
SNMP
扫描SNMP
Settings
扫描设置信息
Web Servers
扫描Web Servers
Windows
扫描Windows
Windows:Microsoft Bulletins
扫描Windows中微软公告
Windows:User management
扫描Windows用户管理
（3）开始扫描漏洞。扫描结果如图5.27所示。
Nessus / Scans / Hosts - Iceweasel
-口x
FileEdit View HistoryBookmarksJoolsHelp
 Nessus / Scans / Hosts
+
< https://127.0.0.1:8834/html.5.html#/scans/56092639-fb1d-9cf5-a07
Google
 Most VisitedIlOffensive Security Kali Linux Kali Docs Exploit-DB Aircrack-ng
Windows Vul...
μodx3
Audit Tril
Q
Vulnerabilities
Hide Det.ails
Host
Vulnerabiities
Scan Details
192.168.41.1
Name:
Wind
Foidef.
My Scans
Stalus:
Completed
Policy:
Windows Vulne
rability Scan
Targets:
192.168.41.1
Start time: Fri Apr 25 14:09:15 2014
End time:
Fri Apr 25 14:10:52 2014
Elapsed:
2 minstes
图5.27扫描Windows系统的结果
· 132 ·
---
## Page 145
第5章漏洞扫描
（4）从该界面可以看到主机192.168.41.1的漏洞情况，该主机中存在一个比较严重的
漏洞。同样用户可以使用前面介绍过的两种方法查看漏洞的详细信息，进而修改主机中存
在的漏洞。
5.2使用OpenVAS
OpenVAS（开放式漏洞评估系统）是一个客户端/服务器架构，它常用来评估目标主机
上的漏洞。OpenVAS是Nessus项目的一个分支，它提供的产品是完全地免费。OpenVAS
默认安装在标准的KaliLinux上，本节将介绍配置及启动OpenVAS。
5.2.1配置OpenVAS
OpenVAS默认在KaliLinux中已经安装。如果要使用该工具，还需要进行一些配置。
配置OpenVAS具体操作步骤如下所示。
（1）在终端窗口中切换到OpenVAS目录，为OpenVAS程序创建SSL证书。执行命
令如下所示：
root@kali:~# cd /usr/share/openvas
root@kali:/usr/share/openvas# openvas-mkcert
执行以上命令后，将输出如下所示的信息：
Creation of the OpenVAS SSL Certificate