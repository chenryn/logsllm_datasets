# Malicious IoT Implants: Tampering with Serial Communication over the Internet

**Authors:**  
Philipp Morgner, Stefan Pfennig, Dennis Salzner, and Zinaida Benenson  
Friedrich-Alexander-Universität Erlangen-Nürnberg, Erlangen, Germany  
{philipp.morgner, stefan.pfennig, dennis.salzner, zinaida.benenson}@fau.de

## Abstract
The expansion of the Internet of Things (IoT) has led to the widespread deployment of low-power wide-area networks (LPWANs) globally. These networks provide internet access to regions and cities, similar to mobile telephony networks, but are specifically designed for low-power applications and small computing devices. Forecasts predict that major countries will soon be extensively covered by LPWAN connectivity. In this paper, we investigate how the expansion of LPWAN infrastructure introduces new attack vectors in hardware security. Specifically, we examine the threat of malicious modifications in electronic products during the physical distribution process in the supply chain. We explore the extent to which such modifications can allow attackers to take control of devices after deployment by tampering with serial communication between processors, sensors, and memory. To this end, we designed and built a malicious IoT implant, a small electronic system that can be inserted into various electronic products. Our evaluation on real-world products demonstrates the feasibility of using malicious IoT implants for hardware-level attacks on safety- and security-critical products.

**Keywords:** IoT, LPWAN, Implant, Serial communication, Hardware attack

## 1. Introduction
The Internet of Things (IoT) promises to optimize workflows, enhance energy efficiency, and improve our daily lives. According to recent estimates, 11.2 billion IoT devices were installed by the end of 2018. These devices are connected through mostly wireless and local networks, forming a global IoT infrastructure. Security concerns have been raised regarding this infrastructure, including issues in IoT devices, networks, and applications. The power of these billions of devices can be weaponized for targeted attacks, such as recent denial-of-service (DoS) attacks on internet infrastructure, where attacker-controlled IoT nodes form large botnets.

In this paper, we explore a new threat where the connectivity of LPWANs is leveraged as a communication channel to control malicious hardware. Our objective is to demonstrate that public IoT infrastructure can be used to perform remote hardware-level attacks, even if the target device lacks a network interface. The threat of malicious hardware arises from an untrusted supply chain, where electronic products are manufactured and distributed in large volumes. The global supply chain involves multiple steps, from design to installation, and includes entities such as manufacturers, logistics providers, distributors, retailers, and customers. Government agencies also oversee the flow of goods at borders. During distribution, an electronic product can be physically accessed and manipulated by various entities, potentially leading to tampering. This contradicts the inherent trust consumers place in new products.

Inspired by the leaked NSA ANT catalog, we experiment with inserting additional hardware, referred to as hardware implants, into existing electronic systems after the fabrication process. While the threat of hardware implants is acknowledged, previous research has focused on hardware trojans inserted during the design and fabrication phases, not during distribution.

Our major contributions in this work are:
1. **Comprehensive Exploration of a New Attack Vector:** We introduce and demonstrate the feasibility of malicious IoT implants, showing that IoT infrastructures can be abused for purposes beyond DoS attacks. We are the first in the scientific community to design and build a malicious IoT implant, a low-cost electronic implant that connects to the Internet via an IoT infrastructure.
2. **Investigation of New Vulnerabilities:** We explore vulnerabilities in serial communication on printed circuit boards (PCBs). By analyzing over 11,000 microcontroller (MCU) models, we identify de-facto serial communication standards and show that serial communication is vulnerable to malicious IoT implants. For our implementation, we focus on the widely-adopted I2C standard and introduce four attack procedures where our implant interferes with I2C bus communication. We also discuss the applicability of these attacks to other serial communication standards.

This threat is not considered in current threat models for hardware security, which primarily cover hardware trojans, side-channel attacks, reverse engineering, intellectual property piracy, and counterfeiting. Guidelines on supply chain risks, such as NIST SP 800-161, address malicious software insertion but not hardware. Our goal is to raise awareness of the feasibility and impact of internet-connected hardware implants on the security of arbitrary target devices.

## 2. Preliminaries

### 2.1 LPWAN Infrastructure
The global IoT infrastructure consists of millions of local networks interconnected via the Internet. These networks can be categorized into body-area, personal-area, local-area, and wide-area networks. We focus on LPWANs, which provide connectivity for thousands of IoT nodes across large geographical areas, with wireless ranges comparable to mobile telephony networks. Unlike mobile networks, LPWANs are designed for low-power machine-to-machine (M2M) applications with low data rates. As of June 2018, LoRa, a popular LPWAN technology, was deployed in over 100 countries. LoRa operates in three frequency bands (433/868/915 MHz) and uses chirp spread spectrum modulation, providing high resistance against wireless interference. This allows data transmission over distances of up to a few kilometers. The LoRa Alliance, a non-profit organization with over 500 member companies, maintains the LoRaWAN protocol specifications. LoRaWAN uses a star-to-star architecture, where gateways relay messages between IoT nodes or from nodes to a central network server. The cost of deploying LPWANs is significantly lower than rolling out mobile telephony networks, enabling non-profit initiatives like The Things Network (TTN) to provide coverage for entire cities and regions. TTN claims to have a fast-growing community with over 42,000 people in more than 80 countries, deploying LoRaWAN gateways worldwide. According to forecasts, LPWANs will surpass mobile telephony networks in providing wireless connectivity for IoT applications by 2023.

### 2.2 Serial Communication
Despite the diversity in function, features, and appearance, electronic products share similar underlying hardware platforms. These platforms typically consist of integrated circuits (ICs) mounted on PCBs and interconnected via on-board communication interfaces. A typical PCB includes multiple sensors and actuators, one or more MCUs for processing sensor data, memory chips for persistent storage, and network interfaces for external communication.

Serial and parallel data transmission mechanisms are used for communication between ICs. Parallel communication transmits multiple bits simultaneously over multiple channels, while serial communication sends bits sequentially over a single channel. Due to the cost of ICs, serial communication is often preferred on PCBs. Serial communication can be synchronous (with a shared clock signal) or asynchronous (without a shared clock signal). Most serial communication systems have a hierarchy of master and slave ICs, with MCUs typically acting as masters controlling communication and commanding slaves (e.g., memory and sensors).

To determine the most important serial communication interfaces on PCBs, we performed a parametric search on the product databases of six leading MCU suppliers: NXP, Renesas, Microchip, STMicroelectronics (STM), Infineon, and Texas Instruments (TI). These suppliers collectively held a 72% market share of all sold MCUs based on revenue in 2016. We analyzed over 11,000 MCU models and found that 86.7% have a UART interface, 83.5% support I2C, and 63.8% support SPI. Other interfaces, such as CAN (34.3%), USB (30.2%), and Ethernet (11.5%), are less widely supported and more application-specific. A detailed analysis is provided in Table 1.

### 2.3 I2C Communication Protocol
Although serial communication interfaces vary in synchronization, data rates, and complexity, they share architectural similarities from a security perspective. Notably, none of their specifications include cryptographic security measures. Therefore, many demonstrated attacks can be adapted to other serial communication interfaces. In our implementation and evaluation, we focus on the I2C standard, which is widely adopted and vulnerable to malicious IoT implants.