title:Malicious IoT Implants: Tampering with Serial Communication over the
Internet
author:Philipp Morgner and
Stefan Pfennig and
Dennis Salzner and
Zinaida Benenson
Malicious IoT Implants: Tampering with
Serial Communication over the Internet
Philipp Morgner(B), Stefan Pfennig, Dennis Salzner, and Zinaida Benenson
Friedrich-Alexander-Universit¨at Erlangen-N¨urnberg, Erlangen, Germany
{philipp.morgner,stefan.pfennig,dennis.salzner,zinaida.benenson}@fau.de
Abstract. The expansion of the Internet of Things (IoT) promotes the
roll-out of low-power wide-area networks (LPWANs) around the globe.
These technologies supply regions and cities with Internet access over
the air, similarly to mobile telephony networks, but they are speciﬁcally
designed for low-power applications and tiny computing devices. Fore-
casts predict that major countries will be broadly covered with LPWAN
connectivity in the near future. In this paper, we investigate how the
expansion of the LPWAN infrastructure facilitates new attack vectors in
hardware security. In particular, we investigate the threat of malicious
modiﬁcations in electronic products during the physical distribution pro-
cess in the supply chain. We explore to which extent such modiﬁcations
allow attackers to take control over devices after deployment by tam-
pering with the serial communication between processors, sensors, and
memory. To this end, we designed and built a malicious IoT implant, a
small electronic system that can be inserted in arbitrary electronic prod-
ucts. In our evaluation on real-world products, we show the feasibility of
leveraging malicious IoT implants for hardware-level attacks on safety-
and security-critical products.
Keywords: IoT · LPWAN · Implant · Serial communication
Hardware attack
1 Introduction
The Internet of Things (IoT) promises to optimize workﬂows, enhance energy
eﬃciency, and to improve our everyday life. According to a recent estimation [11],
11.2 billion IoT devices will be installed by the end of 2018. These devices are
connected in mostly wireless and local networks all over the world, comprising
together a global IoT infrastructure. In the past, security concerns have been
expressed regarding this powerful IoT infrastructure: Besides security issues in
IoT devices [28,33], IoT networks [30], and IoT applications [9], the force of
these billions of devices can be weaponized for targeted attacks with impactful
consequences. Examples are recent denial-of-service (DoS) attacks on Internet
infrastructure [3,20], in which attacker-controlled IoT nodes utilize existing IoT
infrastructure to build large botnets.
c(cid:2) Springer Nature Switzerland AG 2018
M. Bailey et al. (Eds.): RAID 2018, LNCS 11050, pp. 535–555, 2018.
https://doi.org/10.1007/978-3-030-00470-5_25
536
P. Morgner et al.
In this paper, we explore a new threat where the connectivity of low-power
wide-area networks (LPWANs) is leveraged as a communication channel to con-
trol malicious hardware. Our objective is to prove that public IoT infrastructure
can be used to perform attacks at hardware level remotely, even if the target
device does not feature a network interface. The underlying threat of malicious
hardware arises from an untrusted supply chain, in which electronic products are
manufactured and shipped in large volumes. The global supply chain of electronic
products consists of a number of sequential steps from designing a new prod-
uct, fabrication process, and distribution to the installation. Hereby, we focus
on the physical distribution process that involves entities such as manufacturers,
third-party logistics providers, distributors, retailers, and costumers. In addition,
government agencies oversee the ﬂow of goods at borders for legal and documen-
tation purposes. Thus, an electronic product can be physically accessed and
manipulated by a number of entities during distribution. These entities could
be potential attackers or cooperate with an attacker, and therefore the integrity
of an product should not be assumed in general. This contradicts the inherent
trust of consumers that new products are not tampered with.
Inspired by the leaked NSA ANT catalog [4], we experiment with the inser-
tion of additional hardware, referred to as hardware implants, into an exist-
ing electronic system after the fabrication process. Although the threat of
hardware implants seems to be acknowledged by the academic security com-
munity, previous research on malicious hardware mainly focused on hardware
trojans, i.e., diverse types of malicious hardware inserted during design phase
[2,8,12,13,18,24] and fabrication phase [5,36,42] but not during the distribution
phase.
We summarize our major contributions in this work as follows:
1. We comprehensively explore a new attack vector: malicious IoT implants. We
show that IoT infrastructures can be abused for malicious purposes other
than DoS attacks. Although the existence of hardware implants is known [4],
we are the ﬁrst in the scientiﬁc community that design and build a malicious
IoT implant, a low-cost electronic implant to facilitate hardware-level attacks,
that connects to the Internet over an IoT infrastructure.
2. We investigate new vulnerabilities on hardware level that exploit insecurities
in serial communication on printed circuit boards (PCBs). We start by iden-
tifying the de-facto serial communication standards by analyzing over 11,000
microcontroller (MCU) models. Then, we show that serial communication is
vulnerable to malicious IoT implants. For our implementation that focuses
on the widely-adopted I2C standard, we introduce four attack procedures in
which our implant directly interferes with the communication on I2C buses.
At the end, we discuss the adoption of these attacks to other serial commu-
nication standards.
The presented threat is not considered in current threat models for hardware
security [15,34] that mainly cover hardware trojans, side-channel attacks, reverse
engineering, piracy of intellectual property, and counterfeiting. Also, guidelines
on supply chain risks, such as NIST SP 800-161 [6], consider malicious software
Malicious IoT Implants
537
insertion but no malicious hardware insertion. Thus, the goal of this paper is
to demonstrate and understand the feasibility of Internet-connected hardware
implants and their eﬀects on the security of arbitrary target devices to raise
awareness for this novel threat.
2 Preliminaries
2.1 LPWAN Infrastructure
The global IoT infrastructure is split into millions of local networks that are inter-
connected via the Internet. From an application perspective, these networks can
be categorized into body-area, personal-area, local-area, and wide-area networks.
In this paper, we focus on LPWANs, which provide connectivity for thousands of
IoT nodes across large geographical areas as their wireless range competes with
the ranges of mobile telephony networks. In contrast to mobile telephony net-
works that support high data rates and bandwidths, LPWANs are speciﬁcally
designed for low-power machine-to-machine (M2M) applications that commu-
nicate at low data rates. As of June 2018, a popular LPWAN technology with
deployments in over 100 countries is LoRa [26]. LoRa operates in three frequency
bands (433/868/915 MHz) at diﬀerent channels and bandwidths, and uses a chirp
chip spectrum modulation scheme that provides a high resistance against wire-
less interference. These advanced propagation properties allow transmissions of
wireless data over distances of up to a few kilometers. The speciﬁcations of
LoRaWAN, the LoRa network protocol, are maintained by the LoRa Alliance,
a global non-proﬁt organization consisting of more than 500 member companies
[25]. From a network perspective, LoRaWAN utilizes a star-to-star architecture,
in which so-called gateways relay messages either between IoT nodes or from an
IoT node to the central network server and vice versa. The wireless transmissions
between IoT nodes and the gateway are based on the LoRa technology, while
the Internet Protocol (IP) is used for data transfers between gateways and the
central network server.
The cost of deploying LPWANs is signiﬁcant lower than the roll-out of mobile
telephony networks such that even non-proﬁt initiatives are able to provide net-
work coverage for entire cities and regions. A prominent example is The Things
Network (TTN), a crowd source initiative that claims to have a fast growing com-
munity with over 42,000 people in more than 80 countries. The TTN community
deploys LoRaWAN gateways world-wide to achieve their objective of enabling
a global network for IoT applications without subscription costs. According to
TTN, 10 gateways are enough to cover a major city like Amsterdam with wire-
less connectivity for IoT applications. Currently, almost 4,000 TTN gateways
are globally deployed. Besides non-proﬁt initiatives, the roll-out of national-wide
LPWANs driven by telecommunication companies is ongoing in many countries,
e.g., India [17], Australia [32], and the USA [38]. According to a forecast [27],
LPWANs will supersede mobile telephony networks in providing wireless con-
nectivity for IoT applications by 2023.
538
P. Morgner et al.
2.2 Serial Communication
Although electronic products provide a large diversity in function, features, and
appearance, their underlying hardware platform follows similar design principles.
Typically, the hardware platform consists of a number of integrated circuits (ICs)
that are mounted on PCBs and interconnected via on-board communication
interfaces. A typical PCB comprises multiple sensors and actuators. Generally,
one or more MCUs are present to process the data received from the sensors,
as well as memory chips to store data persistently, and network interfaces to
communicate with external entities.
For the communication between ICs exist a number of serial and parallel data
transmission mechanisms. In parallel communication, multiple bits are transmit-
ted simultaneously over multiple communication channels. This is in contrast to
serial communication, where bits are sent sequentially over a single communica-
tion channel. Since the cost of ICs is also determined by the number of input and
output pins, ICs on PCBs often use serial communication to interact with each
other. Serial communication mechanisms can be categorized into synchronous
and asynchronous systems. Synchronous systems associate a clock signal to the
data signals, which is shared by all bus participants. In asynchronous systems,
the data signals are transmitted without a shared clock signal. Most of the serial
communication systems comprise a hierarchy of master and slave ICs. MCUs
are typically masters and control the communication as well as command slaves,
e.g., memory and sensors, to send data or to execute particular tasks.
To determine the most important serial communication interfaces on PCBs,
we performed a parametric search on the product databases of six leading MCU
suppliers: NXP, Renesas, Microchip, STMicroelectronics (STM), Inﬁneon, and
Texas Instruments (TI). In 2016, these suppliers had in sum a market share
of 72% of all sold MCUs based on the revenue [16]. We analyzed more than
11,000 MCU models regarding their serial communication interfaces and found
that 86.7% have a UART interface, 83.5% support I2C and 63.8% SPI. We also
analyzed the support for further serial communication interfaces, such as CAN
(34.3%), USB (30.2%), and Ethernet (11.5%), which are mainly application-
speciﬁc and not as widely supported as SPI, I2C and UART. A detailed analysis
can be found in Table 1. Although the support of a serial interface is no war-
rant that this interface is also used in a product that features this MCU, these
numbers indicate the de-facto standards that are supported by leading MCU
suppliers.
2.3
I2C Communication Protocol
Although serial communication interfaces have diverse properties regarding syn-
chronization, data rates, and complexity, there are architectural similarities from
a security perspective. The most obvious property of these systems is that none
of their speciﬁcations deﬁne any kind of cryptographic security measure. There-
fore, the majority of the demonstrated attacks can also be adapted to other serial
communication interfaces. In the implementation and evaluation of this work,
Malicious IoT Implants
539
Table 1. Number of MCU models sorted by supplier and product families (as of
January 2018). If a database entry of an MCU model had no parameter regarding
a certain interface, we assume that this interface is not supported. Notation: ‘MS’
- market share of MCU sales by revenue in 2016, ‘Family’ - MCU product family
as advertised by the supplier (if applicable), ‘Bit’ - bit size of the MCU architecture,
‘#MCUs’ - number of MCU models, ‘ETH’ - Ethernet.
Supplier MS Family
Bit #MCUs #MCUs that support
SPI CAN USB ETH
UART
243
812
534
0
17
34
I2C
243
812
531
290
6
34
243
812
482
94
1
34
219
264
228
475
7
34
243
334
276
0
0
0
550
1
354
72
2,304 2,226
2,313 2,069 1,924 1,441 1,298
3
485
36
340
39
106
366
241
255
30
799
140
156
205
471
28
67
124
25
12
43
104
366
220
255
42
796
16
93
189
446
28
72
235
26
12
45
104
366
241
255
33
794
135
145
206
500
28