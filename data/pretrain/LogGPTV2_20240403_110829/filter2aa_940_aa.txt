Geo
Geo--IP Blocking:  A sometimes 
IP Blocking:  A sometimes 
effective Mal
effective Mal--ware deterrent
ware deterrent
DEFCON 13
Presentation
July 30, 2005
Agenda
Agenda
 What is Geo-IP Blocking?
 Why Geo-IP Block?
 Why not to Geo-IP Block
 How Geo-IP Blocking works
 Regional Internet Registries (RIRs)
 Different Geo-IP Blocking strategies
 Automation
 Caveats
Presenter AKA Shameless 
Presenter AKA Shameless 
Personal Plug
Personal Plug
Tony Howlett
 President of Network Security Services, Inc.
 CISSP, GSNA, CNA, CSSA
 Author of “Open Source Security Tools”
 17 years of experience building and 
managing networks
What is Geo
What is Geo--IP Blocking?
IP Blocking?
 Indiscriminately blocking entire sections of 
IP addresses related to geographical areas at 
your firewall or router
Spam Statistics
Spam Statistics
A recent study show that the following countries were the 
leaders in originating spam
USA
42%
South Korea
13%
China
8%
Blocking those two countries alone would take care of 21% of 
your spam
Source: SpamHaus 2005
Why Geo
Why Geo--IP Block?
IP Block?
 Quick (within minutes)
 No Cost (just entries in a router)
 Avoids almost ALL types of attacks including zero day 
and unreported exploits (at least those originating from 
the blocked countries) 
 Easily reversible
 Users can still access blocked sites outbound
 Most companies don’t need to give the ENTIRE world 
access to their network.
 Even Fortune 500 companies can use this for some 
parts of their network.
More Reasons to Geo
More Reasons to Geo--IP Block
IP Block
– May become more effective over time as more 
spam / malware moves offshore
– May force “bad actor” countries to crack down 
on spam / malware
– China recently announced a crackdown on 
spam partially due to pressure form ISPs 
blocking their IP space
Types of 
Types of malware
malware Geo
Geo--IP can 
IP can 
stop
stop
– Spam
– Email Fraud
– Phishing
– Viruses
– Worms
– Automated hacking 
tools
– Manual hacking (script 
kiddies)
– Prohibited website 
hosted offshore (porn, 
gambling, etc) 
Reasons NOT to Geo
Reasons NOT to Geo--IP block
IP block
– Not 100% effective (what is?)
– Goes against the idea of global access to the 
Internet
– Large multinational corporation (may still work 
in some limited instances)
– Doing business overseas (may still work for 
some areas)
– Will block all emails form that part of the world 
(unless you except mail traffic from your rules)
How Geo
How Geo--IP Blocking Works
IP Blocking Works
– IANA assigns address blocks out to the 
Regional Internet Registries (RIRs) for 
local assignment
– American Registry for Internet Numbers 
(ARIN) handles North America
Other 
Other RIRs
RIRs
 APNIC (Asia)
 RIPE (Europe, Middle East and Central Asia)
 LACNIC (Latin America)
 AfriNIC (new RIR for Africa)
APNIC (Asia)
APNIC (Asia)
 Asia Pacific Network Information Centre
 Takes in many of the bad actor counties (the 
#2 and #3 spammers in our example) 
 Just blocking APNIC could lower your 
malware hits by 20-30%
 Be careful; also cover Japan where a lot of 
westerners do business
APNIC 
APNIC IPs
IPs to block*
to block*
210.0.0.0/8
218.0.0.0/8
220.0.0.0/8
222.0.0.0/8
58.0.0.0/8
61.0.0.0/8
124.0.0.0/8
126.0.0.0/8
168.208.0.0/16
196.192.0.0/16
202.0.0.0/8
*List not guaranteed to be complete or accurate, caveat emptor
China Only (with APNIC and 
China Only (with APNIC and 
ARIN IP space)*
ARIN IP space)*
*List not guaranteed to be complete or accurate, caveat emptor
203.222.192.0 - 203.222.207.255  
203.223.0.0 - 203.223.15.255  
203.81.16.0 - 203.81.31.255  
203.87.224.0 - 203.88.3.255 
203.89.0.0 - 203.89.3.255 
203.90.0.0 - 203.90.3.255  
203.91.0.0 - 203.91.3.255  
203.92.0.0 - 203.92.3.255  
203.93.0.0 - 203.94.31.255  
203.95.0.0 - 203.95.7.255  
210.12.0.0 - 210.13.255.255  
210.14.160.0 - 210.15.191.255  
210.192.96.0 - 210.192.127.255  
210.21.0.0 - 210.22.255.255  
210.211.0.0 - 210.211.15.255  
210.25.0.0 - 210.47.255.255  
210.5.0.0 - 210.5.31.255  
210.5.128.0 - 210.5.143.255  
210.51.0.0 - 210.53.255.255  
210.72.0.0 - 210.78.255.255  
210.79.224.0 - 210.79.255.255  
210.82.0.0 - 210.83.255.255  
211.136.0.0 - 211.167.255.255  
211.64.0.0 - 211.71.255.255  
211.80.0.0 - 211.103.255.255  
159.226.0.0 - 159.226.255.255 
161.207.0.0 - 161.207.255.255 
162.105.0.0 - 162.105.255.255  
166.111.0.0 - 166.111.255.255  
167.139.0.0 - 167.139.255.255  
168.160.0.0 - 168.160.255.255  
192.124.154.0 - 192.124.154.255  
192.188.170.0 - 192.188.170.255  
192.83.122.0 - 192.83.122.255  
198.17.7.0 - 198.17.7.255  
198.97.132.0 - 198.97.132.255 
202.0.110.0 - 202.0.110.255 
202.0.160.0 - 202.0.179.255 
202.122.128.0 - 202.122.128.255 
202.127.0.0 - 202.127.63.255  
202.127.128.0 - 202.127.255.255 
202.130.0.0 - 202.130.31.255 
202.130.224.0 - 202.130.255.255 
202.131.208.0 - 202.131.223.255  
202.136.252.0 - 202.136.255.255 
202.14.235.0 - 202.14.238.255 
202.14.88.0 - 202.14.88.255 
202.192.0.0 - 202.207.255.255  
202.20.120.0 - 202.20.120.255  
202.22.248.0 - 202.22.255.255  
202.38.0.0 - 202.38.15.255        
202.38.140.0 - 202.38.156.255  
202.38.158.0 - 202.38.161.255  
202.38.164.0 - 202.38.176.255  
202.38.184.0 - 202.38.255.255  
202.38.32.0 - 202.38.47.255  
202.38.64.0 - 202.38.138.255  
202.4.128.0 - 202.4.159.255  
202.4.252.0 - 202.4.255.255  
202.90.0.0 - 202.90.3.255  
202.90.252.0 - 202.91.3.255  
202.91.128.0 - 202.91.131.255  
202.92.0.0 - 202.92.3.255  
202.92.252.0 - 202.93.3.255  
202.93.252.0 - 202.93.255.255  
202.94.0.0 - 202.94.31.255  
202.95.0.0 - 202.95.31.255        
202.95.252.0 - 202.122.39.255 
203.128.128.0 - 203.128.159.255  
203.184.0.0 - 203.184.3.255  
203.192.0.0 - 203.192.31.255  
203.196.0.0 - 203.196.3.255 
203.207.64.0 - 203.208.19.255  
203.212.0.0 - 203.212.15.255  
Korea Only (with APNIC and 
Korea Only (with APNIC and 
ARIN IP space)*
ARIN IP space)*
*List not guaranteed to be complete or accurate, caveat emptor
202.14.165.0 - 202.14.165.255
202.189.128.0 - 202.189.191.255
202.20.119.0 - 202.20.119.255 
202.20.128.0 - 202.20.255.255
202.20.82.0 - 202.20.86.255 
202.20.99.0 - 202.20.99.255
202.21.0.0 - 202.21.7.255 
202.30.0.0 - 202.31.255.255
202.6.95.0 - 202.6.95.255 
203.224.0.0 - 203.255.255.255 
210.178.0.0 - 210.183.255.255  
210.204.0.0 - 210.207.255.255 
210.216.0.0 - 210.223.255.255 
210.80.96.0 - 210.80.111.255 
210.90.0.0 - 210.127.255.255  
211.104.0.0 - 211.119.255.255 
211.168.0.0 - 211.255.255.255 
211.32.0.0 - 211.63.255.255  
218.144.0.0 - 218.159.255.255  
218.232.0.0 - 218.239.255.255  
218.36.0.0 - 218.39.255.255  
218.48.0.0 - 218.55.255.255  
219.240.0.0 - 219.241.255.255  
219.248.0.0 - 219.255.255.255  
220.64.0.0 - 220.92.255.255  
61.248.0.0 - 61.255.255.255  
61.32.0.0 - 61.43.255.255  
61.72.0.0 - 61.87.255.255  
128.134.0.0 - 128.134.255.255
129.254.0.0 - 129.254.255.255
132.16.0.0 - 132.16.255.255
134.75.0.0 - 134.75.255.255 
137.68.0.0 - 137.68.255.255
141.223.0.0 - 141.223.255.255
143.248.0.0 - 143.248.255.255
147.43.0.0 - 147.43.255.255 
147.46.0.0 - 147.47.255.255
147.6.0.0 - 147.6.255.255
150.150.0.0 - 150.150.255.255
150.183.0.0 - 150.183.255.255