greater than 50) [48], there are 30 countries with a combined total
of 6K I2P peers. China leads the group with more than 2K peers.
Singapore and Turkey follow with about 700 and 600 peers observed
in the network, respectively.
Since China actively blocks access to Tor [13, 69] and VPN [4, 5],
a portion of Chinese users seem to use the I2P network instead. The
number of Chinese users may be expected to increase if more out-
proxies become steadily available in the network. Although China
is one of the countries where I2P peers are configured to be in
hidden mode by default [48, 73], a router operator can always turns
off this setting to make his router more reachable, thus improving
performance.
Figure 11 shows 20 autonomous systems from which most ad-
dresses originate. AS7922 (Comcast Cable Communications, LLC)
leads the list with more than 8K peers. Together these 20 ASes make
up more than 30% of the total number of peers observed.
As mentioned in Section 5.2.2, 58.9% of peers change their ad-
dress at least once. We are also interested in analyzing this change
in terms of the geographic distribution of these peers. By mapping
their IP addresses to ASN and country, we find that most peers stay
in the same autonomous system or the same geographic region
in spite of their association with multiple IP addresses. This ob-
servation is reasonable given that although ISPs frequently rotate
different IP addresses dynamically for residential Internet connec-
tions, these addresses often belong to the same subnet. However,
USRUGBFRCAAUDENLBRITESINCNJPUASEBECHPLZA0K4K8K12K16K20K24K28KObservedpeers0102030405060Cumulativepercentage7922900970185089123891232212213215465626830285620473332020115560770122773363512000132690K1K2K3K4K5K6K7K8KObservedpeers05101520253035CumulativepercentageMeasuring the I2P Anonymity Network and its Censorship Resistance
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
of blockage, similarly to Tor’s directory servers (e.g., as was the
case when they were blocked from China in 2009 [60]). Given the
current design of I2P, a new peer cannot connect to the rest of the
network if it cannot bootstrap via some reseed servers.
In April 2017, there was a post on the I2P developer forum report-
ing that reseed servers were blocked in China [49]. We attempted to
test the reachability of hardcoded reseed servers from some of our
vantage points hosted inside China and found that some of them
were still accessible. Moreover, the analysis in Section 5.3 shows that
China is among the top-20 countries where most I2P peers reside.
A previous study [14] shows two possibilities for our observation.
First, the report could be a case of small-scale blocking conducted
at provincial ISPs, but not a uniform nationwide blockage. Second,
the Great Firewall of China (GFW) sometimes fails to block access
to destinations that it normally blocks. It is worth noting that the
current I2P network can only be used as a self-contained network
most of the time due to the intermittent availability of outproxies.
In addition, because the network is still small, it probably has not
yet become a target of censorship by the GFW. However, once the
network grows larger with more stable support of outproxies to the
Internet, large-scale blocking is unavoidable.
The I2P developers have foreseen a situation in which all reseed
servers are blocked. Thus, a built-in function of the I2P router soft-
ware is provided to allow for manual reseeding. With this feature,
every active I2P peer can become a manual reseeder. Specifically,
the function can be used to create a reseed file called i2pseeds.su3.
The file can then be shared with other peers that do not have access
to any reseed servers for the bootstrapping process. The sharing
can be done via a secondary channel, similar to how Tor distributes
bridge nodes (e.g., emails, file-sharing services). Under this circum-
stance, a censor who wants to prevent local users from accessing
I2P has to find and block all addresses of active I2P peers. How-
ever, since I2P is a distributed P2P network, it is challenging to
obtain a complete view of the whole network. We investigate the
effectiveness and the efficiency of this blocking approach next.
6.2 Probabilistic Address-Based Blocking
We begin by considering a censor who tries to monitor the network
and gather information about active peers (i.e., IP address and port),
thus being able to prevent local users from accessing the network.
We then evaluate the blocking resistance of an I2P peer and the
usability of the I2P network under aggressive blocking pressure.
Setting. The probabilistic blocking model comprises (1) a
6.2.1
group of monitoring routers operated by a censor (e.g., ISP, gov-
ernment) and (2) a victim whom the censor wants to prevent from
accessing I2P. By operating some routers in the network, the censor
can acquire information about a large portion of potential peers
that the victim may need to contact in order to access the network,
thus being able to prevent the victim from accessing the network.
The blocking rate is then calculated by the rate of peer IP addresses
seen in the netDb of the victim, which can also be found in the
netDb of routers that are controlled by the censor.
6.2.2 Blocking Resistance Assessment. We consider a long-term
I2P node who has been participating in the network and has many
RouterInfos in its netDb, which is about to be blocked. To simulate
Figure 12: Number of autonomous systems in which
multiple-IP peers reside.
we notice a small portion of peers changing their IP addresses re-
peatedly between different autonomous systems and countries. The
highest number of autonomous systems that a peer associates with
is 39, while the highest number of countries in which a peer resides
in is 25. Figure 12 shows the number of autonomous systems in
which I2P peers reside in. More than 80% of peers only associate
with one ASN, while 8.4% of peers are associated with more than
ten different ASes. Based on a discussion with one of the I2P de-
velopers, one of the possible reasons for this phenomenon is that
some I2P routers could be operated behind VPN or Tor servers,
thus being associated with multiple autonomous systems. Note that
users of Tails [57] (until version 2.11) could use I2P over Tor as one
of the supported features.
A limitation of using MaxMind is that when mapping IP ad-
dresses to ASNs and countries, there are around 2K addresses that
we could not resolve using this dataset. Nonetheless, this does not
mean that we could not identify 2K peers. Our results in Section 5.2.2
show that more than 55% of known-IP peers are associated with
more than one IP address. Therefore, the actual number of peers
whose ASN and country we could not identify are just those peers
that are associated with only one IP address we could not resolve.
As mentioned in our discussion of ethical considerations, we do not
use any of the more accurate public APIs on the Internet to resolve
these IP addresses for privacy reasons.
6 CENSORSHIP RESISTANCE
Due to the centralized network architecture of Tor, it is relatively
easy for a censor to find and block all public Tor routers. To cope
with this blocking susceptibility, several studies have aimed to
enhance the blocking resistance of Tor [13, 43, 69, 71]. Despite its
decentralized design, I2P is also susceptible to censorship, but, to
the best of our knowledge, its resistance to censorship has not been
extensively studied—we focus on this aspect in this section.
6.1 Reseed Server Blocking
Knowing the bootstrapping mechanism of I2P, a censor can easily
block access to the reseed servers to disable the I2P bootstrapping
process. As a consequence, reseed servers present a single point
12345678910Numberofautonomoussystems0K20K40K60K80K100K120KObservedpeers020406080100PercentageIMC ’18, October 31-November 2, 2018, Boston, MA, USA
NP. Hoang et al.
Figure 13: Blocking rates under different blacklist time win-
dows.
the censor, we use IP addresses of daily active peers observed by 20
routers under our control. For the victim, we run an independent
router outside the network that we use to host our 20 routers.
The blue line (lowest) in Figure 13 shows the cumulative success-
ful blocking rate of an adversary obtained by running 1–20 routers
for one day. By operating 20 routers in the network, a censor can
block more than 95% of peer IP addresses known by the victim,
while 90% can be blocked with just six routers.
The above blocking rate is calculated based on the assumption
that the censor only uses IP addresses collected on a single given
day. However, the actual situation could be even worse. Previous
studies on Tor have shown that once an IP address is found to be
joining an anonymous communication network or participating
in other types of network relays (e.g., VPN servers), it may get
blacklisted for several days, and sometimes even for more than a
month [16, 52]. We utilize the results obtained from the churn rate
analysis in Section 5.2 to examine how blocking can be more severe
if the IP blacklist time window expands to a period of 5, 10, 20, or
30 days.
We find that if the censor expands the blacklist time window
from one to five days, the blocking rate increases to more than
97% with 20 routers, or 95% with only 10 routers. Moreover, if the
blacklist time windows expands to a period of 10, 20, and 30 days,
the blocking rates increase to above 98% with 20 routers, and about
96% with only 10 routers.
As shown in Figure 13, five days would be sufficient to achieve a
high blocking rate. This is within the capabilities offered by high-
end firewalls used for nationwide censorship, which can easily keep
such a large number of rules.
6.2.3 Network Usability Evaluation. Since the address-based block-
ing implemented in the GFW of China uses the null routing tech-
nique to route unwanted packets to a black-hole router, we config-
ure our upstream router to silently drop all packets that contain
peer IP addresses that we observed from the I2P network. We then
set up three testing eepsites to test the impact of the address-based
blocking to the page load time. These eepsites are designed with a
Figure 14: Percentage of timeout requests and page load la-
tency in the presence of blockage.
simple and small html file to avoid wasting bandwidth of the overall
network. In addition, we conduct the test on our own eepsites in-
stead of publicly known eepsites to make sure that our experiment
does not disrupt legitimate users of those eepsites. We first crawl
our eepsites to test their average normal load time. The result in
Figure 13 shows that a censor can block about 65% to 98% of peer
addresses found in a victim’s netDb. We then crawl these eepsites
10 times for each blocking rate applied, measure the page load time,
and count the number of timed out requests (i.e., an HTTP 504 is
returned).
Figure 14 shows that the average load time of our eepsites is 3.4
seconds without blockage. By blocking other peers with a rate of
65%, a censor could already introduce a latency of more than 20
seconds to the page load time and make 40% of requests timed out.
Any blocking rates in the range of 70–90% could cause a signifi-
cantly higher latency in page load time (i.e., more than 40 seconds),
with the number of timed out requests occupying more than 60%
of total requests. Blocking rates higher than 90% heavily depreciate
the usability of the network, with 95–100% of requests timed out.
7 DISCUSSION
7.1 Potential Solutions to Blocking
Since more and more oppressive regimes attempt to prevent local
users from accessing the Tor network, Tor provides users in such
restricted regions with a set of special relays called bridges [61].
Similarly, I2P can adopt the use of bridges to help those restricted
users to access the network, along with a non-fingerprintable traffic
pattern currently in development [35]. While the Tor community
may have a difficult time recruiting bridges because new bridges
are often found and blocked quickly [13], I2P has a higher potential
to adopt the use of bridges because of the high churn rate of its
dynamic and decentralized network.
Despite the high blocking rates shown in Section 6.2, we notice
a portion of peer IP addresses could not be blocked. These IP ad-
dresses often belong to newly joined peers. Therefore, a potential
solution is to use these peers as bridges for restricted users. Since
these peers are newly joined, they are less likely discovered and
blocked immediately by the censor.
Utilizing newly joined peers as bridges, however, may only be
suitable for censored users who need to access I2P for a short period
2468101214161820Routersunderourcontrol6065707580859095100Blockingrate(%)1day5days10days20days30days06567697173757779818385878991939597Blockingrate(%)020406080100Timedoutrequests(%)0102030405060Pageloadtime(s)Measuring the I2P Anonymity Network and its Censorship Resistance
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
of time. If the peers stay in the network long enough, they will
be discovered by the monitoring routers of the censor and eventu-
ally will be blocked. A potential approach to remedy this problem
is to use newly joined peers in combination with the firewalled
peers discovered in Sections 5.1 for a more sustainable censorship
circumvention.
According to Figure 6, there are around 14K firewalled peers in
the network on a daily basis. Without a public IP address, the censor
cannot apply the address-based blocking technique introduced in
Section 6.2. In the current I2P design, the chance that a censor
can discover the IP address of these firewalled peers depends on
the probabilities that the routers under the censor’s control (1) are
selected to be introducers for these peers, and (2) they directly
interact with these firewalled peers.
Except for implementing an infrastructure to collect and dis-
tribute bridges, no overhead is introduced to any parties in the
aforementioned solution. Since most active peers in the network
are selected to help other peers to route traffic by default, the above
approaches only changes how censored peers pick non-blocked
peers in order to access the rest of the network. Consequently, uti-
lizing newly joined peers in combination with firewalled peers can
be a potentially sustainable solution for restricted users who need
longer access to the network.
7.2 From Blocking to Other Type of Attacks
Although this study focuses on the problem of blocking access to
I2P, the probabilistic blocking model we introduced is not simply
an effort to block access to the I2P network. If a censor cannot
completely prevent a local user from accessing the network, it can
conduct attacks such as traffic analysis to deanonymize that user
(e.g., revealing which destination is being visited by the user).
For instance, after blocking more than 95% of active peers in the
network, the attacker can inject malicious routers. He then config-
ures the local network firewall in a fashion that forces the victim
to use the attacker’s routers to connect with the rest of the I2P
network. In this case, the victim is bootstrapped into the attacker’s
network. The attacker can facilitate this process by whitelisting the
group of malicious routers under their control, while repeatedly
blocking addresses of other active peers. By narrowing down the
victim’s view of the network, the attacker is a step closer to con-
ducting several types of attacks, including the deanonymization
attack mentioned above [22, 24].
8 CONCLUSION
In this work, we conducted a measurement study to better un-
derstand the I2P anonymity network, which then allowed us to