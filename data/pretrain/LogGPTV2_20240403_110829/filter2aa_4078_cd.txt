的 媒体内容。 黑客则展示获得 AACS 加 密密钥的攻击并将它们张贴在互联网上。
电影制作商和黑客今天继续着猫捉老鼠的游戏: 媒体公司试图保护他们的 内容， 而黑客企图持
续访问未加密的拷贝 。
3 电子书 DRM
也许 D邸4 技术最成功的应用就是图书文献的出版。 当今大多数电子书使用某种形式的数字版
权管理， 这些技术也通过 DRM 功 能来保护 出 版商产生的敏感文档 。
1 75
CISSP 官方学习指南(第 7 版)
提示 :
今天， 所有使用 中 的 D邸4 方案都存在一个致命的缺陷: 用 于访问 内 容的设备必须获得解密密
钥 。 如果解密密钥存储在终端用 户 所拥有的设备上， 用 户 总是有机会操作该设备以获得访问密钥。
Adobe 系统通过 Adobe 的数字体验保护技术(Adobe Digita.l Experience Protection TI巳chnology，
ADEPT) ， 为 出售电子书提供多种格式的 D肌技术。 ADEPT 使用相结合的 AES 技术对媒体内 容进
行加密并用 RSA 加密受保护的 AES 密钥。 许多 电子书阅读器， 除了亚马逊的 白ndle， 都使用这项
技术来保护 自 己的内容。 亚马逊的 Kindle 电子阅读器使用 多种格式的图书分发版， 每个都包含自 己
的加密技术 。
4. 视频游戏 DRM
许多视频游戏使用这样一种 DRM 技术， 控制台使用 一台运行的互联网云服务器来验证游戏的
许可。 这些技术， 例如育碧的 Uplay， 需要恒定的互联网连接来激活游戏。 如果玩家失去了连接，
游戏将停止运行。
201 0 年3月， Uplay 系统受到拒绝服务攻击， 使全球的 Uplay 游戏玩家因为之前的功能设置，
使得他们的主机不能访问 Uplay 服务器， 从而不能玩游戏。 这导致公众的强烈抗议， 随后育碧取消
了 持续连接的要求， 将 DRM 方式更改为控制 台 上的游戏只 需要初始激活就 允许无限制使用 。
5. 文档 DRM
虽然 DRM 技术最常见的用途是保护娱乐 内容， 但组织还是可以使用 DRM 保护存储在 PDF 文
件、 办公文档 以及其他格式中 的敏感信息的安全性。 商业 D邸4 产品 ， 如 Vitrium 和 FileOpen ， 使用
加 密来保护源代码的内容， 并帮助组织细致地控制文件版权。
这里是一些文档 DRM 解决方案常见的权限限制 :
• 阅读文件
1 76
• 修改文件的内容
• 去除文件中的水 印
• 下 载/保存文件
• 打印文件
• 文件 内容的截图
DRM 解决方案允许组织在需要时授予他们版权， 在不再需要时进行撤消 ， 甚至是在规定的时
间 到期后版权 自 动失效。
7.5.5 网络连接
本章我们要探讨的最后一个密码学应用是使用密码学算法提供网络连接服务。 在这一节中， 我
们将简要介绍两种用于保护通信线路安全的方法: IPSec 和 网络安全关联密钥管理协议(Intemet
Security Association and Key Management Protoco!' ISAKMP) ， 此外还会讨论一些与无线网络有关的
安全 问题。
第7章 PKI 和密码学应用
1 . 链路加密
安全管理人员使用两种类型的加 密技术来保护在网络上传输的数据的安全:
• 链路加密使用软件或硬件解决方案在两个点之间建立一条安全隧道， 对进入隧道一端的所
有通信数据都进行加密， 并且对流出隧道另一端的所有通信数据都进行解密 ， 从而保护整
条通信线路的安全。 例如， 某公司通过一条数据线连接两个办公室， 可以使用链路加密技
术来防止攻击者在两个办公室之间 的某一点进行的监控活动 。
• 端到端加密用于保护双方仰的日 ， 客户 端和服务器)之间 的通信安全， 并且可以独立于链路加
密实施 。 在发送者和接收者之间传递使用 PGP 的邮件， 就是端到端加密的例子。 这种技术
可 以阻止入侵者监控加密链路安全端的传输数据或者通过未加密链路传送的数据。
链路加密和端到端加密技术之间的关键差异在于: 在链路加密中 ， 所有的数据(包括头、 尾、 地
址和路由数据)也会被加密， 因此每个数据包必须在每一跳(each hop)都被解密， 这样数据包才能被
正确地路由至下一跳， 然后数据包在继续发送之前又被重新加密， 这就降低了路由 的速度。 端到端
加密技术不加密头、 尾、 地址和路由数据， 因此数据包从一点移到另一点的速度加快了 ， 但是这种
技术更容易 遭到嗅探器和偷听者的攻击。
当加密发生在 OSI 模型的较高层时， 通常会使用端到端加密技术; 如果加密发生在 OSI 模型的
较低层， 通常会使用链路加密技术。
安全外壳(SSl却是端到端加密技术的一个很好的例子。 这组程序提供常见的网络应用服务(如
盯P、 Telnet 和 rlo自1)的加密可选方案。 SSH 实际上有两个版本: SSHl(现在被认为是不安全的)支持
DES、 3DES、 IDEA 和 Blowfish 算法， SSH2 不支持 DES 和 IDEA， 但是增加了对其他一些算法的
支持。
2. I PSec
人们 目 前使用 了 多种安全体系结构， 每一种都被设计用于解决不同环境中的安全问题。 网络协
议安全(IPSec)标准就是这样一种支持安全通信的体系结构。 IPSec 是由互联网工程任务组(IETF膊立
的标准体系结构， 并且能够在两个实体之间建立信息交换的安全信道。
通过 IPSec 进行通信的两个实体可以是两个系统、 两个路由器、 两个网关或任何实体组合。 尽
管 IPSec 一般情况下被用于连接两个网络， 但是 IPSec 也可以被用于连接单独的计算机， 例如一个
服务器和一个工作站， 或者一对工作站(可能是发送者和接收者)0 IPSec 并不规定所有的实现细节，
而是一个开放的模块化架构， 从而允许很多供应商、 软件开发人员开发能与其他供应商的产品共同
使用 的 IPSec 解决方案。
IPSec 通过公钥密码学来提供加密 、 访问控制 、 不可否认性以及消息身份认证， 井且一般使用
E 协议。 IPSec 主要被用于虚拟专用网。rpN)， 因此可 以工作在运输模式或隧道模式中。 IPSec 通常
与二层隧道协议(L2TP)在一起， 成为 L2TP/IPSec。
IPSec 协议为安全网络通信提供了 完整的基础设施。 IPSec 已经得到广泛认可， 并且现在许多商
业性的操作系统中也提供了这个协议。 IPSec 依赖于安全关联， 井且存在下列两个主要组件 :
• 身份验证头(Authentication Header， Al却提供消息完整性和不可否认性的保证。 AH 还提供身
份认证和访 问 控制 ， 并且可 以 防止重放攻击。
• 安全封装有效载荷(Encapsulating Security Payload， ESP)提供数据包内容的机密性和完整性。
ESP 还提供加密和有限的 身份认证 ， 并且可 以防止重放攻击。
1 77
1 78
CISSP 官方学 习指南(第 7 版)
注意 :
ESP 也提供某些有限的身4挝人证， 但是达不到 AH 的程度。 虽 然 ESP 有时可以在没有 AH 的情
况下使用 ， 但是在没有 ESP 的 情况下 ， AH 几乎不会羊独使用 。
IPSec 提供两种分离的操作模式。 当 IPSec 在运输模式中使用时， 只 有数据包有效载荷被加密，
这种模式为对等通信而设计。 当 IPSec 在隧道模式中使用时， 整个数据包(包括头)都会被加密， 这个
模式为网 关间通信而设计。
提示 :
IPSec 在现代计算机安全中是一个极其重要的概念。 你一定要熟悉如上所述的组成协议以及
IPSec 操作模式。
在运行时， 通过创建安全关联(SecurityAssociation， SA)来建立 IPSec 会话。 SA 表示通信会话，
井且记录与特定连接有关的任何配置和状态信息。 SA 表示单一连接。 如果期望双向信道， 那么就
需要两个 SA， 每个方向分别使用一个 SA。 此外， 如果希望支持使用 AH 和 ESP 的双向信道， 那么
就需要建立 4个SA。
某些 IPSec 的最大强度就来自于能够在每个 SA 的基础上过滤或管理通信， 这样一来， 就可以
严格管理其间存在安全关联的客户端或网关(即哪些类型的协议或服务可以使用 IPSec 连接)。 此外，
如果没有定义有效的 安全关联， 那么一对用户或网 关就无法建立 IPSec 链接。
有关 IPS巳c 算法的详细信息 ， 请参考第 1 1 章 " 安全网络架构与保护网络组件 " 中 的 内容。
3. ISAKMP
网络安全关联密钥管理协议(lSAKMP)通过协商、 建立、 修改和删除安全关联为IPSec提供后台
的安全支持服务。 正如你在前面一节中学到的那样， IPSec依赖于安全关联的系统。 这些安全关联通
过使用ISAKMP进行管理。 正如在IntemetRFC 2408 中阐述的一样， ISAKMP具有下列 4 个基本要求:
• 对通信对等方进行身份认证
• 建立并管理安全关联
• 提供密钥生成机制
• 防 止遭受威胁(例如， 重放和拒绝服务攻击)
4. 无线互联
无线网络被迅速广泛地来用 ， 并且造成了 巨大的安全风险。 许多传统网络没有为本地网络主机
之间的路由通信实施加密技术， 并且根据假设认为: 攻击者需要通过取得安全位置内 网线的物理访
问 ， 从而在网络上进行偷昕非常困难。 然而， 无线网络通过在空中传送数据， 所以非常容易遭受中
途数据拦截的攻击 。 有两个主要的无线安全类型:
有线等价隐私 安全团体最初通过引入有线等价隐私队Tired Equivalent Privacy， WEP)提供 64
和 128 位的加密边工页， 从而保护无线 LAN 内 的通信。 IEEE 802. 1 1 中将 WEP 描述为无线网络连接
标准的一个可选组件。
警告 :
现在的 密码分析攻击 已经证明 WEP 算法中存在显著的缺陷 ， 这可能导致在短时间 内 完全破坏
第 7 章 PKI 和密码学应用
使用 WEP 保护的网络的安全性. 一定不要斗却有 WEP 加密来保护无线网 络。 事实上， 在存储网络上
使用 WEP 加密会导致许多 安全事件， 例如 TJX 安全违规事件(在 2007 年广 为人知)。 再次重中 ， 一
定不要在无线 网 络上使用 WEP 加密。
WiFi 安全访问 通过实现临时密钥完整性协议(Temporal Key Integrity Protocol， TKIP)并消除危
害 W凹 的密码学弱点 ， WPA(WiFi Protected Access)改进了 WEP 加密。 通过将 TKIP 替换为 AES 加
密算法， WPA2 进一步改善了 WPA 技术。 这两种技术都是适合现代无线 网络使用 的安全算法。
警告 :
需要记住的是， WPA 并不提供端到端的安全解决方案。 WPA 只对笔记本电脑和最近的无线接