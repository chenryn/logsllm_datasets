thereby gaining many (possibly unnecessary) permissions.
Speciﬁcally, if we take into account the provenance of each app,
a different story emerges. Looking over the breakdowns in Table 3,
the modest gains over time appear to be primarily attributable to a
reduction in app overprivilege among AOSP apps; vendors appear
to be responsible for roughly the same amount of overprivileged
apps in each image (51.29% of all pre-2012 apps, vs. 52.71%
of post-2012 apps). In this sense the vendors themselves do not
appear to care signiﬁcantly more about the least privilege principle
than third-party app developers do, despite being, on average, much
larger corporate entities.
In Figure 2, we summarize the distributions of overprivileged
apps among pre-2012 devices and post-2012 devices respectively.
The majority of overprivileged apps have no more than 10 overde-
clared permissions. Note that pre-loaded apps have access to cer-
tain permissions that are not available to third-party apps. There-
fore, these overdeclared permissions, if exploited, can lead to greater
damage. For example, our results demonstrate that both REBOOT and
MASTER_CLEAR are among overdeclared permissions that can allow
for changing (important) device status or destroying user data with-
out notiﬁcation.
3.3 Vulnerability Analysis
Our vulnerability analysis led to several interesting results, espe-
cially once combined with our efforts to determine the provenance
of each app. In particular, if we consider the distribution of vul-
nerable apps across each phone image (Table 4), the percentage
of vulnerable apps of these devices varies from 1.79% to 14.97%.
Applying our horizontal analysis to each generation of devices, it
appears that the HTC Wildﬁre S and LG Optimus P880 have the
628Table 3: Permission usage analysis of representative devices
Pre-2012 devices
% of overprivileged apps among all pre-loaded apps
AOSP app 5
vendor app
third-party app
Device
Nexus S
Wildﬁre S
Optimus P350
Galaxy S2
Xperia Arc S
Average
Total
90.41%
92.52%
85.00%
88.37%
83.52%
38.36%
15.65%
23.00%
13.95%
14.20%
50.68%
57.82%
33.00%
58.14%
56.82%
87.96%
21.03%
51.29%
1.37%
19.05%
29.00%
Device
Nexus 4
One X
Optimus P880
16.28%
12.50%
Galaxy S3
Xperia SL
Average
Overall Average: 85.78%
15.64%
Post-2012 devices
% of overprivileged apps among all pre-loaded apps
Total
79.12%
78.21%
91.30%
87.57%
81.82%
AOSP app 5
vendor app
third-party app
30.77%
10.00%
20.87%
15.14%
11.96%
48.35%
50.71%
50.43%
55.68%
58.37%
0.00%
17.50%
20.00%
16.76%
11.48%
83.61%
17.75%
52.71%
13.15%
Table 4: Vulnerability analysis of representative devices (I)
Pre-2012 devices
Post-2012 devices
% of vulnerable apps among all apps
AOSP app 5
vendor app
third-party app
% of vulnerable apps among all apps
AOSP app 5
vendor app
third-party app
Device
Nexus S
Wildﬁre S
Optimus P350
Galaxy S2
Xperia Arc S
Average
Total
5.48%
14.97%
11.00%
12.21%
2.27%
8.99%
2.74%
4.76%
4.00%
3.49%
1.14%
2.74%
8.84%
1.00%
6.98%
0.00%
3.23%
3.91%
by no more than 5 permissions
by 6 to 10 permissions
by more than 10 permissions
0.00%
1.36%
6.00%
Device
Nexus 4
One X
Total
2.20%
1.79%
Optimus P880
10.43%
1.74%
1.14%
Galaxy S3
Xperia SL
Average
Overall Average: 6.77%
1.85%
n
o
i
t
a
z
i
m
o
t
s
u
c
o
t
e
u
d
s
e
i
t
i
l
i
b
a
r
e
n
l
u
v
f
o
%
  90%
  80%
  70%
  60%
  50%
  40%
  30%
  20%
  10%
  0%
6.49%
1.91%
4.56%
Wildfire S
O
ne X
1.10%
0.71%
5.22%
2.70%
0.96%
1.10%
0.71%
5.22%
3.24%
0.48%
2.14%
2.15%
0.00%
0.36%
0.00%
0.54%
0.48%
0.28%
O
ptim
O
ptim
us P350
us P880
G
alaxy S2
G
alaxy S3
X
X
peria Arc S
peria S
L
p
p
a
d
e
g
e
l
i
v
i
r
p
r
e
v
o
f
o
%
p
p
a
d
e
g
e
l
i
v
i
r
p
r
e
v
o
f
o
%
  70%
  60%
  50%
  40%
  30%
  20%
  10%
  0%
  70%
  60%
  50%
  40%
  30%
  20%
  10%
  0%
Nexus S
Wildfire S
Optimus P350
Galaxy S2
Xperia Arc S
(a) Pre-2012 devices
by no more than 5 permissions
by 6 to 10 permissions
by more than 10 permissions
Nexus 4
One X
Optimus P880
Galaxy S3
Xperia SL
(b) Post-2012 devices
Figure 2: Distributions of overprivileged apps
most vulnerable apps in each generation. Inversely, the Sony Xpe-
ria Arc S and – interestingly – the HTC One X have the least vul-
nerable apps by proportion. As one may expect, Google’s reference
phones (especially the Nexus 4) both perform well compared to
their contemporaries, as their images are designed to be a reference
baseline. Our vertical analysis has an even more impressive result
– the percentage of vulnerable apps across each generation dropped
from an average of 8.99% last generation to 4.56% this generation.
Even incorporating provenance information in the vertical analysis,
there is a dramatic improvement for all three categories of app.
However, the percentage of vulnerable apps is not necessarily
a good metric to measure the security of such devices. The com-
plexity metrics we collected as part of our provenance analysis (see
Table 1) show that the devices contain ever-increasing amounts of
code. Therefore, while fewer vulnerabilities – as a percentage –
may be introduced in newer phones, the sheer scale of their stock
Figure 3: Vulnerabilities due to vendor customizations
images works to counteract any gains. Furthermore, some vulnera-
ble apps may contain more vulnerabilities than others. As a result,
there is value in counting the absolute number of critical vulnera-
bilities as well as the proportion of vulnerable apps.
To this end, we summarize our results in that format in Table 5.
When we use this table for vertical differential analysis, it tells quite
a different story. While, indeed, the number of vulnerabilities in
each generation of devices generally decreased, the reduction is
nowhere near so dramatic. Furthermore, when considered in hor-
izontal differential analysis, different devices take the crown for
most and least secure devices in each generation. The HTC Wild-
ﬁre S is still the least secure pre-2012 device, but only by a hair
– the Samsung Galaxy S2 has only one fewer vulnerability. The
Sony Xperia Arc S is tied with the Google Nexus S for the most
secure pre-2012 device. Meanwhile, there is a complete shake-up
among the post-2012 devices: the Samsung Galaxy S3 has 40 vul-
nerabilities to the LG Optimus P880’s 26, while the HTC One X
(at 15 vulnerabilities) falls to mid-pack, behind the Nexus 4 (at 3)
and the Sony Xperia SL (at 8).
Table 5 still does not tell the complete story. Looking at the ta-
ble’s provenance analysis results, it appears that most of the vulner-
abilities stem from the AOSP. However, recall that our provenance
analysis concerns the original provenance of each app, not each
vulnerability. To gather information about the provenance of each
vulnerability, we manually examine each of the reported vulnerable
paths. Our results are shown in Figure 3 (note that Google’s phones
are not included here because the AOSP is led by Google, making
the distinction difﬁcult). For the Samsung, HTC, and LG phones,
the majority of vulnerabilities – between 64.71% and 85.00% – did
not originate from the AOSP. However, for both of Sony’s products,
629Table 5: Vulnerability analysis of representative devices (II)
Device
Nexus S
Wildﬁre S
Optimus P350
Galaxy S2
Xperia Arc S
Total
8
40
17
39
8
Pre-2012 devices
AOSP app 1
# of vulnerabilities
vendor app
third-party app
6
23
11
18
6
2
15
1
18
0
0
2
5
3
2
Device
Nexus 4
One X
Optimus P880
Galaxy S3