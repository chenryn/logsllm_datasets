compared with the only two-month period analyzed in [18].
The BrightKite website pushes users’ activity event such
as a user checkin, a location update, a photo upload, or a
note posting to a data distribution service called GNIP [13].
Each activity event is associated with a timestamp indicat-
ing when it was performed. We query these activities every
day after midnight. The dataset we use has 65,770 users,
who contributed more than 45 million activity events in to-
tal. The only data that can possibly be missing from this
dataset is those activity events that users posted earlier but
thereafter removed on the same day before we obtained them
from GNIP. We believe that such events were rare and their
impact on this study can thus be ignored. As BrightKite
introduced bi-directional friendships only lately, we obtain
a social graph represented as a directed graph instead of an
undirected one used in [18].
As the goal of this work is to study malware propaga-
tion in general online social networks, one may question the
generality of the data collected from a speciﬁc online so-
cial network like BrightKite. To address this issue, we an-
alyze both the structure of the BrightKite social graph and
its users’ activity patterns and the results reveal that many
properties of the BrightKite online social network have been
observed in other online social networks. This suggests that
BrightKite is indeed a typical online social network and our
observations made about malware propagation in it can be
translated into other social networks as well. Next, we shall
present detailed analysis of the BrightKite network.
3.1 Friendship analysis
We ﬁrst analyze the social graph formed by BrightKite
users from a graph-theoretical perspective.
A scale-free network? Many online social networks
have been found to be scale-free [22], which indicates that
their degree distributions obey a strong power law. Figure
1 depicts the log-log plot of the out-degree distribution of
the BrightKite users. We are more interested in the out-
degree distribution than the in-degree distribution because
a worm propagating in online social networks needs to ob-
tain outbound contacts to spread itself. We use the method
proposed in [6], which combines maximum likelihood estima-
tion and Kolmogorov-Smirnov statistics, and derive the best
power-law ﬁt as one with cutoﬀ (cid:12) = 68 and scaling exponent
(cid:11) = 2:92. The p-value of the model ﬁtting is 0.24. As it is
higher than the suggested threshold 0.1 [6], the power-law
distribution seems to be a reasonable ﬁt for the number of
outbound friends in the dataset. It is noted that the scaling
exponent we obtained is much higher than 1.9, which is the
value derived in [18] with the linear regression method. The
diﬀerence results from the fact that the intended model in
our analysis has an extra cutoﬀ parameter.
The implications of a scale-free structure on malware prop-
agation in Brightkite-like online social networks are two-
folds. First, as a power-law degree distribution suggests that
a few nodes in the network have high degrees, succeeding in
infecting these nodes at the early stage of the worm propaga-
tion can signiﬁcantly speed up worm spreading [38]. Second,
as the scaling exponent is less than (cid:24) 3:4875, it is possible to
have an epidemic that infects almost every vulnerable node
in scale-free networks like BrightKite [14]. This can be con-
ﬁrmed from Figure 2, which depicts the sizes of connected
components against their ranks in the social graph formed
by BrightKite users. The sizes of the largest two connected
components have 57,417 and 48 users, respectively. Here, a
connected component refers to the set of nodes that are con-
nected through edges. As in the graph edges are directed,
we found that in the largest connected component, 44 users
cannot be reached by the majority of the users and 799 users
cannot reach the majority of the users. Hence, a malware
starting from a single infection point can infect machines
used by up to 87% of BrightKite users.
Hv
A small-world network? A small-world network is
highly clustered and has a small characteristic path [34].
To measure how nodes in the BrightKite graph are clus-
tered together, we calculate its clustering coeﬃcient. Given
a directed graph G(V; E), the clustering coeﬃcient of a node
nv (nv(cid:0)1) , where Hv is the number of edges
v is deﬁned as
between the neighbors of node v and nv gives the number
of neighbors that node v has. The clustering coeﬃcient of a
graph is the average clustering coeﬃcient over all its nodes.
For the giant component of the BrightKite graph, its cluster-
ing coeﬃcient as 0.091, which is slightly higher than 0.0782,
the clustering coeﬃcient of the early counterpart [18]. For a
random graph generated from the Erdos-Renyi model with
a similar number of nodes and edges, the clustering coeﬃ-
cient is only 0.000156, which is much smaller than that of
the BrightKite graph.
The characteristic path length of a graph is deﬁned as
the average length of the shortest paths of all node pairs.
Recall that 44 users cannot be reached by the majority of
the users and 799 users cannot reach the majority of the
users in the largest connected component of the BrightKite
graph. We thus found that 1.67% of node pairs do not have
a legitimate path. For the remaining node pairs, the av-
erage shortest path has 5.768 hops, which agrees well with
the six-degrees-of-separation phenomenon observed in other
social networks [33]. The histogram of the shortest path
length among routable path lengths is given in Figure 3.
The network diameter is 18 hops, which is higher than what
was observed in the earlier BrightKite graph. On the other
side, if it is a random graph generated from the Erdos-Renyi
model with a similar number of nodes and edges, the frac-
tion of node pairs with legitimate paths is 99.93%, among
which the average shortest path has 6.5 hops (over 20 runs).
Regarding the giant component of the BrightKite graph,
as its average shortest path length is comparable to that
in the random graph and its clustering coeﬃcient is much
smaller than that in the random graph, it closely reﬂects a
small-world network structure [34], although a small frac-
tion of node pairs in it do not have a path in between.
Given that small-world networks are highly clustered and
have small characteristic path lengths, epidemic disease can
spread easily and quickly to the entire population, instead
of being limited within small regions in the network. This
suggests that from a structural perspective, it is not easy
198
Figure 1: The log-log plot of the
out-degree distribution and power-
law ﬁtting
Figure 2: Sizes of connected com-
ponents against their ranks in the
social graph
Figure 3: Histogram of the lengths
of the shortest paths among node
pairs
to mitigate malware propagation in BrightKite-like online
social networks.
3.2 Activity analysis
Besides the network structure, users’ online activities can
also aﬀect worm propagation. Even a well-connected user,
if he rarely gets online, poses little impact on malware prop-
agation in the network. In this section, we analyze activity
patterns of BrightKite users that potentially aﬀect malware
propagation. It is noted that among the 65,770 BrightKite
users, only 58,455 of them have performed at least one ac-
tivity event. We call these active users.
In the following
discussion, we are limited to only active users.
Number of activity events per user. In Figure 4, we
depict in a log-log form the number of activity events (i.e.,
location update, photo upload and note posting) that were
performed by each user against his rank in the dataset. The
largest and average number of activity events generated by
an active user is 9,684 and 77.8, respectively.
It is noted
that the average number of activity events generated by an
active BrightKite user is higher than what it was observed
in [18], suggesting that BrightKite users use the online social
network more frequently than before.
Recently Guo et al. found that contents generated by on-
line social network users obey a stretched exponential dis-
tribution, whose CCDF (Complementary Cumulative Prob-
ability Distribution Function) is given as: P(X (cid:21) x) =
(cid:0)(x=x0)c
e
[15]. Its rank distribution function can be derived
i = (cid:0)aln(i) + b, where yi denotes the number of con-
as yc
tents generated by the user of rank i. It would be interest-
ing to see whether the activity events generated by active
BrightKite users also follow this pattern. It is obvious to see
that a power-law distribution is not a good ﬁt because the
log-log plot is not linear. Using the maximum likelihood es-
timation method proposed in [15], we obtain the parameters
in the rank distribution function as follows: c = 0:341927,
a = 2:21, and b = 24:879. Using Pearson’s chi-square test,
we have conﬁrmed that the derived stretched exponential
distribution is indeed a good ﬁt.
Stretched exponential distributions imply that online ac-
tivities are not as dominated by a small group of top users as
in a network with power-law distributions [15]; that is to say,
online activities are more stretched out over the entire pop-
ulation in a stretched exponential network.
If we assume
that the number of activity events is a good indication of
how frequently a user visits the online social network, hav-
ing online activities more spread out over the entire popula-
tion is instrumental to malware propagation in online social
networks because vulnerable machines become infected only
when users get online and click on malicious links sent from
their friends.
Active time span per user. A common phenomenon in
online social networks is that some users lose interests after
trying a few times and become inactive. This is also observed
in the BrightKite dataset. We deﬁne the active time span
of a user as the duration between her ﬁrst and last activity
events in the dataset. Figure 5 gives the CCDF of the active
time spans of the active BrightKite users. We note that as
many as 35% of the active BrightKite users actually have an
active time span no greater than 10 days. Hence, machines
used by these users, even if vulnerable to a malware attack,
may not be helpful in spreading the malware due to their
inactivity.
At any given time, the number of infective machines in
the online social network is bounded by the number of ma-
chines used by active users. Figure 6 presents the number
of active users that perform at least one activity event in a
day. We conjecture that the dropoﬀ at the tail was because
the data was not collected completely from the BrightKite
server. Later in trace-driven simulation, we do not use the
activity events during this period. Interestingly, we observe
that there is a surge in the middle of the graph. As this
surge coincided with the release date of the iPhone version
of BrightKite, we conjecture that iPhone users contributed
a signiﬁcant portion of BrightKite activities after the surge.
This means that to spread malware in the BrightKite online
social network, it would pay oﬀ if the malware could ex-
ploit some vulnerabilities on iPhones. It is also evident that
BrightKite user activities exhibit strong weekly patterns.
For instance, there are usually more BrightKite users that
perform activity events on Saturday than the other days in
a week. Hence, it would help the malware to spread quickly
in the beginning if it is released on Saturday.
3.3 Friendship-activity correlation
After analyzing the friendships and activities in the BrightKite
dataset, an interesting question would be: is there any strong
correlation between the number of friends a user has and
how active he is in the online social network? Figure 7 de-
picts the relationship between the number of activity events
generated by a BrightKite user and the number of her con-
tacts. We further use the correlation coeﬃcient to measure
the linearity of this correlation. Deﬁne X = fxigi=1;:::;n,
where xi denote the number of outbound friends user i, and
199
100101102103xx = 68 1 10 100 1000 10000 100000 1 10 100 1000 10000Component sizeRank 0 0.1 0.2 0.3 0.4 0.5 0.6 0 2 4 6 8 10 12 14 16 18Fraction of node pairsNumber of hopsFigure 4: Stretched exponential
distribution of user updates
Figure 5: The CCDF of the active
time spans of the BrightKite users
Figure 6: Number of users with
activity events on each day in the
dataset
for us to prepare eﬀective defense schemes against malware
propagation in online social networks.
Ideally, we wish we could analyze traces of real-world mal-
ware propagation in online social networks such as Facebook
[11] and Twitter [32]. Like previous measurement studies
on Internet worms and botnets, the ﬁrst-hand data oﬀer
tremendous insights into operational dynamics of these mal-
ware in the reality. However, such measurement data related
to malware propagation in online social networks are still
not available. Hence, we resort to using simulation to study
malware propagation dynamics in scenarios that capture im-
portant details of the real-world counterpart. To be more
realistic, we build a malware propagation simulator that is
directly driven by the BrightKite dataset, such as the social