# USB.rc Files and AT Command Triggers

## Overview
- **USB.rc with ACM Triggers:**
  - Total counts: 330, 73, 253, 56, 144, 591, 168, 10, 581, 56, 23, 2955
  - Average ACM triggers: 2.9, 5.6, 14.3, 5, 6.7, 1.1, 4.4, 16, 5.4, 4.7, 6.9, 262
- **USB.rc with Diag Triggers:**
  - Total counts: 496, 253, 58, 100, 693, 281, 224, 509, 56, 23, 4.1, 2285
  - Average diag triggers: 2.5, 29.2, 31.3, 29.1, 25.7, 1.0, 15.1, 7.0, 19.6, 21.2, 36.5, 17.3

## Device Details
| Device | Android Version | Modem Exposed |
| --- | --- | --- |
| Samsung Galaxy Note 2 | 4.4.2 | Y |
| Samsung Galaxy S7 Edge | 7.0 | Y |
| Samsung Galaxy S8 Plus | 7.0 | Y |
| LG G3 | 6.0 | Y |
| LG G4 | 6.0 | Y |
| HTC One | 4.4.2 | Y* |
| HTC Desire 626 | 5.1 | N |
| Asus ZenPhone 2 | 5.0 | N* |
| Asus ZenPad | 5.0.2 | N |
| Google Nexus 5 | 5.1.1 | N* (root) |
| Google Nexus 5X | 6.0 | Y (root) |
| Google Nexus 6P | 7.1.1 | N (root) |
| Google Pixel | 7.1.1 | Y (root) |
| Motorola Moto X | 5.1 | N (root) |

### Table 4: Vendor-Specific Counts of USB.rc Files
- **Description:** This table provides the number of `USB.rc` files found to contain ACM and diagnostic (diag) triggers, along with the average number of triggers per vendor.
- **Total Triggers:**
  - ACM: 12,018
  - Diag: 39,605
- **Images Analyzed:** 1,564 out of 2,018 total images.

### Table 5: Modem Interface Exposure on Android Devices
- **Description:** This table lists 14 Android devices and whether they expose a USB modem interface by default or after rooting.
- **Key Findings:**
  - 6 devices expose the modem by default.
  - 4 devices can expose the modem after being rooted.

## Runtime Vulnerability Analysis

### 4.2.1 Firmware Flashing
- **Findings:**
  - AT commands that enable firmware flashing were identified.
  - Commands like `AT%RESTART`, `AT%PMRST`, `AT%POWEROFF`, `AT%DLOAD`, `AT%FRST`, `AT%MODEMRESET`, `AT+CRST=FS`, `AT+CFUN=0`, `AT+CFUN=1,1`, `AT+CFUN=6`, `AT+FACTORST=0,0`, `AT+SUDDLMOD=0,0`, `AT+FUS?`, and `ATË†RESET` can be used to reset or update the phone's firmware.
  - These commands can cause the phone to reboot, enter firmware download mode, or perform a factory reset.
  - On Samsung phones, some commands put the phone into Odin mode, but do not bypass the standard firmware authentication mechanism.
  - LG has its own firmware flashing command, which allows flashing malicious firmware using LGUP.

### 4.2.2 Android Security Bypassing
- **Findings:**
  - AT commands can bypass various Android security mechanisms such as lock screens and UI notifications.
  - Commands like `ATD`, `ATH`, `ATA`, `AT%IMEI=[param]`, `AT%USB=adb`, `AT%KEYLOCK=0`, `AT+CKPD`, `AT+CMGS`, `AT+CGDATA`, `AT+CPIN`, and `AT$QCMGD` can be used to make calls, change IMEI, enable ADB debugging, unlock the screen, send SMS messages, manage SIM PINs, and delete messages.
  - Some commands, like `AT+CFUN=1,1`, can cause different behaviors on different vendors' phones. For example, it causes Samsung phones to reboot but can brick an LG G4.
  - The USB modem interface remains exposed even in bricked states, allowing for potential un-bricking using specific AT commands.

### Summary
- **Firmware Flashing and Security Bypassing:**
  - AT commands can be used to flash firmware, reset the device, and bypass security mechanisms.
  - Different vendors' devices exhibit varying behaviors in response to these commands, highlighting the need for robust security measures.

This structured and detailed presentation aims to provide a clear and comprehensive overview of the findings related to USB.rc files, AT command triggers, and their impact on Android device security.