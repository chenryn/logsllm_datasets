7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
27
8-Bit Grayscale Bitmap
• H=6.14182
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
28
8-Bit Color Bitmap
• H=6.68248
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
29
8-Bit Wave (Speech)
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
30
8-Bit Wave (Music)
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
31
16-Bit Wave (Speech)
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
32
16-Bit Wave (Music)
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
33
Jpeg
• H=7.98698
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
34
Portable Executable (PE)
• H=6.58289
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
35
Encrypted with AES using AxCrypt
• H=7.99968
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
36
FILE TYPE IDENTIFICATION
• Knowing the characteristics of various file types is critical to 
identifying them
• Now we’ll use the tools to 
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
37
Compressed or Encrypted?
• Looking at images of the file, it’s impossible to tell
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
38
Compressed or Encrypted?
• A histogram makes it easy!
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
39
Packed or Not Packed?
• WinZip32.exe
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
40
Packed or Not Packed?
• WinZip32.exe – Histogram shows LARGE number of Zeros
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
41
Packed or Not Packed?
• WinZip32.exe – Zoomed in on Histogram
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
42
Are You Hiding Something?
• Sometimes histograms and entropy are less effective
• Original Image
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
43
H= 7.61037
Are You Hiding Something?
• Data appended to end of file - not easily noticed in statistics
• Small aberration in histogram, no entropy indication
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
44
H= 7.63532
Are You Hiding Something?
• Image of the file reveals appended 
data at end
• Remember, bitmaps start from 
bottom up
• Entropy of original image already 
fairly high 
• The larger the appended data, the 
more its entropy characteristics show
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
45
Using Steganography?
• LSB Steganography hides data in the Least Significant Bit(s) of an 
image
• Very difficult to see if number of bits  0x44 “D”
• 0x14 XOR 0x5a ----> 0x4e “N”
• Looking at textual histogram, “C”, “A”, “N”, “D” are much more 
prevalent than others
• Something XOR’d with zero is itself
• With some sleuthing, assumptions, analysis tools, and a bit of luck, 
you’ve got it!
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
66
TOOL: Statistical Analyzer
• This combines the file searching of Footprint and the file type 
identification of Write Bitmap Histogram
• It searches an entire directory structure and attempts to identify a 
file’s type
• Uses histograms and a multitude of statistics
• In its current prototype state, it does not use magic numbers as a clue
• It highlights any abnormalities
• The details are, in and of themselves, an entire 50+ min 
presentation
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
67
Wrap-Up
• Hope you have learned something useful
• Enjoy experimenting and using the tools
• Feel free to contact me by email if you have any other questions
• PI:EMAIL
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
68
Links to Relevant Harris Blogs
• http://crucialsecurityblog.harris.com/2011/07/06/decoding-data-
exfiltration-%E2%80%93-reversing-xor-encryption/
• http://crucialsecurityblog.harris.com/2012/04/16/file-type-
identification-and-its-application-for-reversing-xor-encryption/
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
69
Link to Irrelevant Harris Blogs
• I wrote this one too and it has very little to do with this 
presentation, but I’ll lay odds most of you will like it!
• http://crucialsecurityblog.harris.com/2012/04/09/on-the-difficulty-
of-autonomous-pornography-detection/
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
70
References
• Conti, Greg; Grizzard, Julian; Ahamad, Mustaque; Owen, Henry; 
Visual Exploration of Malicious Network Objects Using Semantic 
Zoom, Interactive Encoding and Dynamic Queries. Georgia Institute 
of Technology
7/9/2013
Fast Forensics Using Simple Statistics & Cool Tools
71
QUESTIONS ???
COMMENTS? COMPLAINTS?