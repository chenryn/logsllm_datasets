were sent every 20ms from different ECUs, showed a
near 0 correlation.
By the Birthday paradox, some ECUs in the vehicle
may probably have near-equivalent clock skews — as it
was for messages 0x20 and 0x2C1 in the examined Toy-
ota Camry 2010 (see Fig. 5(c)). Although clock skews
may be near-equivalent, instantaneous clock offsets of
two different ECUs cannot be near-equivalent and are
thus uncorrelated as they run different processes. The
results in Fig. 9(b) corroborate such a fact by showing
that clock offsets of messages 0x20 and 0xB2, which
were sent by the same ECU, had a high correlation of
0.9860, whereas offsets of messages 0x20 and 0x2C1 —
USENIX Association  
25th USENIX Security Symposium  923
n
o
i
t
c
e
t
e
D
f
o
y
t
i
l
i
b
a
b
o
r
P
1
0.98
0.96
0.94
0.02
0
0
Fabrication
Fabrication
Fabrication
Suspension
Suspension
Suspension
Mistimed Masquerade
Mistimed Masquerade
Mistimed Masquerade
Timed Masquerade
Timed Masquerade
Timed Masquerade
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Probability of False Alarms
2
(cid:1)10-3
n
o
i
t
c
e
t
e
D
f
o
y
t
i
l
i
b
a
b
o
r
P
1
0.98
0.96
0.94
0.02
0
0
Fabrication
Fabrication
Fabrication
Suspension
Suspension
Suspension
Mistimed Masquerade
Mistimed Masquerade
Mistimed Masquerade
Timed Masquerade
Timed Masquerade
Timed Masquerade
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
Probability of False Alarms
2
(cid:1)10-3
(a) Per-message detection.
(b) Per-message + Message-pairwise detection.
Figure 11: ROC curves of CIDS in the real vehicle.
sent by different ECUs with similar clock skews — had
a low correlation of 0.0331. Thus, for messages with
near-equivalent clock skews, CIDS can further examine
the correlation between their clock offsets, and correctly
determine their transmitters.3 These facts and observa-
tions indicate the feasibility and efﬁciency of message-
pairwise detection in CIDS.
To show that message-pairwise detection can sup-
port per-message detection in decreasing false posi-
tives/negatives by examining offset correlations, we con-
sider a scenario in which an attacker V1 has mounted
a masquerade attack on a Honda Accord ECU V2 at
tmasq = 800 secs. We refer to V2 as the ECU which orig-
inally transmits message 0x1B0. To consider the worst
case in detecting the masquerade attack, we assume that
the clock skews of V1 and V2 are nearly equivalent,
similarly to messages 0x20 and 0x2C1 in the Toyota
Camry. We replicated such a worst-case scenario by ran-
domly permuting the acquired offset values of 0x1B0 for
t > tmasq, and considering the permuted values to be out-
put from V1. As shown in Fig. 10(a), this leads to a situ-
ation where the clock skew does not change even though
the message transmitter has been changed from one ECU
to another. Although the clock skew remained equivalent
at t = tmasq, the correlation between offsets of 0x1B0 and
0x1D0 suddenly dropped from 0.9533 to 0.1201, i.e., a
linear to non-linear relationship. As a result, as shown in
Fig. 10(b), the control limits in CIDS’s message-pairwise
detection exceeded the threshold ΓL = 5. On the other
hand, since the clock skews before and after the attack
were equivalent, per-message detection was not able to
detect the intrusion.
5.5 False Alarm Rate
We also examined the false alarm rate of CIDS under the
real vehicle setting. The results obtained from the CAN
3If the two ECUs’ clock behaviors are still not distinguishable,
CIDS can be set up to exclude them for examination so that the risk
of false positives signiﬁcantly decreases. However, this may impact
CIDS’s capability of detecting attacks mounted through those ECUs.
bus prototype are omitted due to their insigniﬁcance, i.e.,
not many false alarms occurred due to its less complex
bus trafﬁc. Based on data recorded for 30 minutes from
the Honda Accord 2013 — approximately 2.25 million
messages on the CAN bus — four attack datasets were
constructed to each contain 300 different intrusions. The
intrusions either had different injection timings, suspen-
sion timings, or changes in clock skews: each in the form
of fabrication attack, suspension attack, mistimed mas-
querade attack, and timed masquerade attack. For each
dataset, we varied the κ parameter of CIDS to acquire one
false positive rate (false-alarm rate) and one false nega-
tive rate (1−detection rate).
Fig. 11(a) shows the Receiver Operating Characteris-
tic (ROC) curve of CIDS, which represents its trade-off
between false alarm and detection, executing only per-
message detection on the attack datasets. Clearly, CIDS
is shown to be able to detect fabrication, suspension, and
masquerade attacks with a high probability. Since the
timed masquerade attack is the most difﬁcult to detect,
it showed the highest false positive rate among all the at-
tack scenarios considered: a false positive rate of 0.055%
while not missing any anomalies (100% true positives).
Even for false positives < 0.055%, 97% of the anoma-
lies were detected by CIDS. However, these false pos-
itives can be of great concern for in-vehicle networks.
Therefore, to eliminate such false positives, CIDS can
additionally run message-pairwise detection. Fig. 11(b)
shows the ROC curve of CIDS executing not only per-
message detection but also message-pairwise detection
for further veriﬁcation. Accordingly, CIDS was able to
detect all types of attacks considered without having any
false positives, which is in contrast to CIDS with only
per-message detection, i.e., all false positives were elim-
inated via message-pairwise detection.
6 Discussion
Discussed below are the overhead, deployment, limita-
tions, and applications of CIDS.
924  25th USENIX Security Symposium 
USENIX Association
Identiﬁcation algorithm. To estimate clock skew,
one can also use other algorithms than RLS, such as Total
Least Squares (TLS) and Damped Least Squares (DLS),
which perform orthogonal linear and non-linear regres-
sion, respectively. Although they might identify the
clock skew with a higher accuracy than RLS, their gains
are offset by the accompanying high complexity. TLS
requires Singular Value Decomposition (SVD), which
is computationally expensive, and DLS requires a large
number of iterations for curve ﬁtting. RLS is known to
have a computation complexity of O(N2) per iteration,
where N is the size of the data matrix. However, in CIDS,
only a scalar clock offset is exploited for identiﬁcation,
and thus the computational complexity is relatively low.
Defeating CIDS. There may be several ways the ad-
versary may attempt to defeat CIDS. First, the adversary
may try to compromise the ECU running CIDS and dis-
able it. However, if cross-validation for CIDS was to be
exploited, such an attempt can be nulliﬁed. For the detec-
tion of intrusions, CIDS only requires an ECU to record
the timestamps of message arrivals. Such a low overhead
makes it feasible for CIDS to be installed distributively
across several in-vehicle ECUs for cross-validation. Sup-
pose using CIDS, ECU A monitors attacks on messages
{M1, M2}, ECU B monitors {M2, M3}, and ECU C mon-
itors {M1, M3}. Since CIDS regards the receiver’s time
clock as the true clock, cross-validation provides mul-
tiple perspectives of clock behaviors for each message
ID, e.g., two different perspectives of M2 from A and
B. Thus, even when an ECU running CIDS gets com-
promised, cross-validation via CIDS can handle such a
problem.
Another way the adversary may try to defeat CIDS is to
adapt to how its algorithm is running and thus deceive it.
The adversary may ﬁgure out the clock skew of the tar-
get ECU and then heat up or cool down the compromised
ECU so that its clock skew changes to match that of the
target. In such a case, the clock skew can be matched and
thus may bypass CIDS’s per-message detection. How-
ever, as discussed in Section 5.4, unless the adversary
also matches the instantaneous clock offset, which is af-
fected by the ECU’s momentary workload and tempera-
ture, CIDS can detect the intrusion via message-pairwise
detection.
Upon intrusion detection. False alarms for intrusion
detection systems, especially in in-vehicle networks, are
critical. Thus, CIDS should also deal with them as accu-
rately as possible. To meet this requirement, if an intru-
sion has been determined, even after going through the
veriﬁcation process, CIDS can follow the following steps
for further examination:
1. If an intrusion was detected while using only per-
message detection, examine it further via message-
pairwise detection.
2. If still alarmed as an intrusion and the attacked ECU
is a safety-critical ECU, go straight to step 4.
3. If not, communicate with other ECUs for cross-
validation as they would provide different perspec-
tives of the clock skew results.
If communicat-
ing with other ECUs incurs too much overhead (in
terms of bus load, processing overhead, etc.), send
trafﬁc data for a remote diagnosis.
4. Request re-patching of ﬁrmware and advise the
driver to stop the vehicle.
Limitation of CIDS. CIDS is shown to be effective in
detecting various types of in-vehicle network intrusions.
One limitation of CIDS might be that since it can only
extract clock skews from periodic messages, it would be
difﬁcult to ﬁngerprint ECUs which are sending aperiodic
messages. That is, if the attacker injects messages ape-
riodically, although CIDS can still detect the intrusion,
it would not be able to pinpoint where the attack mes-
sage came from, i.e., ﬁnding the root-cause of attacks
launched with or on aperiodic messages. Recall that
CIDS can achieve this only for periodic messages. In fu-
ture, we would like to ﬁnd new features other than clock
skew, which can ﬁngerprint ECUs, regardless of whether
they send messages periodically or aperiodically.
Applicability to other in-vehicle networks. Al-
though most modern in-vehicle networks are based on
CAN, some may be equipped with other protocols, such
as CAN-FD, TTCAN and FlexRay, for more complex
operations. CAN-FD is an enhanced version of CAN,
providing ﬂexible and higher data rates [5]. Since its
basic components conform to CAN and thus also lacks
synchronization, CIDS can be applied to CAN-FD. For
protocols such as TTCAN [21] and FlexRay [22], nodes
are periodically synchronized for determinative timing of
message exchanges. The interval between two consecu-
tive synchronizations depends on how each protocol is
deployed [32]. For TTCAN, it can be up to 216 = 65536
bits long, i.e., 131ms in a 500Kbps bus [37]. This lets
some messages be sent multiple times between consec-
utive synchronizations. So, if the time interval is long,
CIDS would still be able to extract clock skews from
messages which are sent multiple times, whereas, if the
period is short, CIDS may not be feasible. However, the
fact that TTCAN and FlexRay have high implementation
cost, whereas for CAN-FD it is minimal, makes CAN-
FD a favorite candidate for next-generation in-vehicle
networks [6, 39]. This means that CIDS can be applicable
to not only current but also future in-vehicle networks.
7 Conclusion
New security breaches in vehicles have made vehicle se-
curity one of the most critical issues. To defend against
USENIX Association  
25th USENIX Security Symposium  925
vehicle attacks, several security mechanisms have been
proposed in the literature. They can cope with some at-
tacks but cannot cover other safety-critical attacks, such
as the masquerade attack. To remedy this problem,
we have proposed a new IDS called CIDS, which ex-
tracts clock skews from message intervals, ﬁngerprints
the transmitter ECUs, and models their clock behaviors
using RLS. Then, based on the thus-constructed model,
CIDS detects intrusions via CUSUM analysis. Based on
our experiments on a CAN bus prototype and on real ve-
hicles, CIDS is shown to be capable of detecting various
types of in-vehicle network intrusions. CIDS can address
all attacks that existing IDSs can and cannot handle as
well as facilitates root-cause analysis. Thus, it has po-
tential for signiﬁcantly enhancing vehicle security and
safety.
8 Acknowledgments
We would like to thank the anonymous reviewers and
the shepherd, Tadayoshi Kohno, for constructive sugges-
tions. The work reported in this paper was supported in
part by the NSF/Intel Grant CNS-1505785 and the DG-
IST Global Research Laboratory Program through NRF
funded by MSIP of Korea (2013K1A1A2A02078326).
References
[1] Microchip MCP2515
www.microchip.com/MCP2515.
Datasheet.
[Online]
Available:
[2] Microchip TB078, PLL Jitter and Its Effects in the CAN Protocol.
[3] On-Board Diagnostic System [Online] http://www.obdii.com.
[4] CAN Speciﬁcation v2.0. Robert Bosch GmbH (1991).
[5] CAN with Flexible Data-Rate Speciﬁcation Version 1.0. Robert
Bosch GmbH (2012).
[6] Inﬁneon: CAN FD Success Goes at Expense of FlexRay. [Online]
http://www.eetimes.com/. EETimes (Feb. 2015).
[7] Hackers Remotely Kill a Jeep on the Highway - With Me in It.
[Online] http://www.wired.com.
[8] BASSEVILLE, M., AND NIKIFOROV, I. Detection of abrupt
changes: Theory and application. In Prentice Hall information
and system sciences series (1993).
[9] CHECKOWAY, S., MCCOY, D., KANTOR, B., ANDERSON, D.,
SHACHAM, H., SAVAGE, S., KOSCHER, K., CZESKIS, A.,
ROESNER, F., AND KOHNO, T. Comprehensive Experimental
Analyses of Automotive Attack Surfaces.
In USENIX Security
(2011).
[10] CHO, K. T., PARK, T., AND SHIN, K. G. CPS Approach to
Checking Norm Operation of a Brake-by-Wire System. In ICCPS
(2015).
[11] DAILY, J. Analysis of critical speed yaw scuffs using spiral
curves. In SAE Technical Paper 2012-01-0606 (2012).
[13] FOSTER, I., PRUDHOMME, A., KOSCHER, K., AND SAVAGE,
S. Fast and Vulnerable: A Story of Telematic Failures. In WOOT
(2015).
[14] HAYKIN, S. Adaptive ﬁlter theory.
(1991).
In 2nd ed. Prentice-Hall
[15] HERREWEGE, A., SINGELEE, D., AND VERBAUWHEDE, I. Ca-
nauth - a simple, backward compatible broadcast authentication
protocol for can bus. In ECRYPT Workshop on Lightweight Cryp-
tography (2011).
[16] HOPPE, T., KILTZ, S., AND DITTMANN, J. Security threats to
automotive can networks - practical examples and selected short-
term countermeasures.
In Reliability Engineering and System
Safety (Jan. 2011).
[17] JANA, S., AND KASERA, S. K. On fast and accurate detection of
unauthorized wireless access points using clock skews. In ACM
MobiCom (2008).
[18] KHAN, D., BRIL, R., AND NAVET, N.
Integrating hardware
limitations in can scbedulability analysis. In WFCS (May. 2010).
[19] KOHNO, T., BROIDO, A., AND CLAFFY, K. Remote physical
device ﬁngerprinting. In IEEE Symposium on Security and Pri-
vacy (2005).
[20] KOSCHER, K., CZESKIS, A., ROESNER, F., PATEL, S.,
KOHNO, T., CHECKOWAY, S., MCCOY, D., KANTOR, B., AN-
DERSON, D., SHACHAM, H., AND SAVAGE, S. Experimental
security analysis of a modern automobile. In IEEE Security and
Privacy (2010).
[21] LEEN, G., AND HEFFERNAN, D. Ttcan: a new time-triggered
In Elsevier Microprocessors and Mi-
controller area network.
crosystems (2002).
[22] MILBREDT, P., HORAUER, M., AND STEININGER, A. An in-
vestigation of the clique problem in ﬂexray. SIES (2008).
[23] MILLER, C., AND VALASEK, C. Adventures in automotive net-
works and control units. Defcon 21 (2013).
[24] MILLER, C., AND VALASEK, C. A survey of remote automotive
attack surfaces. Black Hat USA (2014).
[25] MILLER, C., AND VALASEK, C. Remote exploitation of an un-
altered passenger vehicle. Black Hat USA (2015).
[26] MILLS, D. L. Network time protocol: Speciﬁcation, impleme-
nation, and analysis. RFC 1305.
[27] MOHALIK, S., RAJEEV, A. C., DIXIT, M. G., RAMESH, S.,
SUMAN, P. V., PANDYA, P. K., AND JIANG, S. Model check-
ing based analysis of end-to-end latency in embedded, real-time
systems with clock drifts. In DAC (2008).
[28] MONTGOMERY, D. Introduction to statistical quality control. In
4th edition, Wiley (2000).
[29] MOON, S. B., SKELLY, P., AND TOWSLEY, D. Estimation and
In
removal of clock skew from network delay measurements.
INFOCOM (1999).
[30] MUTER, M., AND ASAJ, N. Entropy-based anomaly detection
for in-vehicle networks. IEEE IVS (2011).
[31] MUTER, M., GROLL, A., , AND FREILING, F. C. A structured
approach to anomaly detection for in-vehicle networks. In Infor-
mation Assurance and Security (IAS), Sixth International Confer-
ence (2010).
[32] NATALE, M. D., ZENG, H., GIUSTO, P., AND GHOSAL, A. Un-
derstanding and using the controller area network communication
protocol: Theory and practice. In Springer Science & Business
Media (2012).
[12] DAVIS, R., KOLLMANN, S., POLLEX, V., AND SLOMKA, F.
Controller area network (can) schedulability analysis with ﬁfo
queues. ECRTS (2011).
[33] NILSSON, D., LARSON, D., AND JONSSON, E. Efﬁcient In-
Vehicle Delayed Data Authentication Based on Compound Mes-
sage Authentication Codes. In VTC-Fall (2008).
926  25th USENIX Security Symposium 
USENIX Association
[34] PASZTOR, A., AND VEITCH, D. Pc based precision timing with-
out gps. In ACM SIGMETRICS (2002).
[35] PAXSON, V. On calibrating measurements of packet transit times.
In SIGMETRICS (1998).
[36] RUTH, R., BARTLETT, W., AND DAILY, J. Accuracy of event
data in the 2010 and 2011 Toyota camry during steady state and
braking conditions. In SAE International Journal on Passenger
Cars (2012).
[37] RYANA, C., HEFFERNANB, D., AND LEENA, G. Clock syn-
chronisation on multiple ttcan network channels. In Elsevier Mi-
croprocessors and Microsystems (2004).
[38] SZILAGYI, C., AND KOOPMAN, P. Low cost multicast network
authentication for embedded control systems. In Proceedings of
the 5th Workshop on Embedded Systems Security (2010).
[39] TALBOT, S. C., AND REN, S. Comparison of ﬁeldbus systems,
In ICDCSW
can, ttcan, ﬂexray and lin in passenger vehicles.
(2009).
[40] VEITCH, D., BABU, S., AND PASZTOR, A. Robust synchro-
nization of software cclock across the internet. In IMC (2004).
[41] WOODALL, W. H., AND ADAMS, B. The statistical design of
cusum charts. In Quality Engineering, 5(4), (1993).
[42] ZANDER, S., AND MURDOCH, S. An improved clock-skew
measurement technique for revealing hidden services. In USENIX
Security (2008).
USENIX Association  
25th USENIX Security Symposium  927