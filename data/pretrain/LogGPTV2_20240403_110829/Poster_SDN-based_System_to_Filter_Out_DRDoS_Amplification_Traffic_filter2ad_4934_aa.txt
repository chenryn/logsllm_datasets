title:Poster: SDN-based System to Filter Out DRDoS Amplification Traffic
in ISP Networks
author:Priyanka Dodia and
Yury Zhauniarovich
Poster: SDN-based System to Filter Out DRDoS Amplification
Traffic in ISP Networks
Qatar Computing Research Institute, HBKU
Priyanka Dodia
Doha, Qatar
PI:EMAIL
Yury Zhauniarovich
Perfect Equanimity
Minsk, Belarus
PI:EMAIL
ABSTRACT
Distributed Reflected Denial of Service (DRDoS) attacks remain one
of the most popular techniques to drain victim’s network bandwidth.
Despite the goal of disrupting network services of a particular
victim, indirectly these attacks affect a large number of benign
Internet citizens. In particular, the owners of services vulnerable
to amplification have to waste their resources to process incoming
requests. Moreover, the voluminous attack traffic generated as a
result of the amplification lavishes Internet Service Provider (ISP)
resources, bandwidth and money, causing Quality of Service (QoS)
degradation and subscription fee increase for the customers.
In this work we demonstrate a Software Defined Networking
(SDN) based system to filter out garbage traffic from an ISP network.
We employ a special type of a honeypot developed to collect infor-
mation about ongoing DRDoS attacks. The firewall rules derived
from this data are used to block incoming amplification requests
from reaching amplifiers located within the provider network rescu-
ing vulnerable services from being abused. In its turn, this prevents
garbage traffic generation saving ISP’s money and improving QoS.
CCS CONCEPTS
• Security and privacy → Denial-of-service attacks; Firewalls;
• Networks → Network architectures; Programmable networks.
KEYWORDS
Amplification attacks; SDN; garbage traffic filtering; honeypot; ISP
networks
ACM Reference Format:
Priyanka Dodia and Yury Zhauniarovich. 2019. Poster: SDN-based System
to Filter Out DRDoS Amplification Traffic in ISP Networks. In 2019 ACM
SIGSAC Conference on Computer and Communications Security (CCS ’19),
November 11–15, 2019, London, United Kingdom. ACM, New York, NY, USA,
3 pages. https://doi.org/10.1145/3319535.3363277
1 INTRODUCTION
Due to the low resource requirements from an attacker and a possi-
bility to stay stealthy, DRDoS attacks remain a major threat for the
Internet. In these attacks, crafted requests with spoofed IP addresses
Permission to make digital or hard copies of part or all of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for third-party components of this work must be honored.
For all other uses, contact the owner/author(s).
CCS ’19, November 11–15, 2019, London, United Kingdom
© 2019 Copyright held by the owner/author(s).
ACM ISBN 978-1-4503-6747-9/19/11.
https://doi.org/10.1145/3319535.3363277
of a victim are sent to genuine machines called amplifiers, which re-
turn amplified responses that can be thousands times larger in size
than the corresponding requests, completely exhausting victim’s
bandwidth. For instance, a well-known software development plat-
form called Github has experienced such attack of 1.35 Tb/sec [7]
in February, 2018.
The most effective way to combat with DRDoS attacks globally
is to apply ingress filtering of the traffic allowing only the packets
with valid source IP addresses to pass. Such recommendations have
been provided in RFC 2827 [13], also known as Best Current Practice
No. 38 (BCP 38). However, ISPs are not incentivized to apply these
recommendations. This best practice requires an ISP to spend its
resources on traffic filtering, although this does not protect the
ISP and its customers from the DRDoS traffic. ISPs also ignore the
problem of garbage traffic generated by amplifiers located in their
network. In this case, an ISP simply charges the owners of hosts
vulnerable to amplification.
Still, indirectly ISPs suffer a lot from this unwanted traffic. First,
it exhausts ISPs’ and their customers’ bandwidth affecting QoS. Sec-
ond, last-mile ISPs usually buy bandwidth from upper tier providers
paying for the traffic, especially, if it is asymmetric [2]. Indeed, the
traffic generated by amplifiers hosted within the perimeter of an
ISP network may reach substantial amounts. An ISP network may
host hundreds or even thousands of such amplifiers that if abused,
could potentially waste significant amount of ISP’s resources and
money. Third, processing of attack requests may affect negatively
the performance of vulnerable hosts.
Contributions. In this demo, we describe the SDN-based imple-
mentation of the approach proposed in our paper [16]. Unlike the
majority of the existing DRDoS mitigating solutions [11, 14, 15] that
are focused on protecting victim’s network, we aim at shielding
amplifiers from illegitimate requests. Our prototype can be used to
detect spoofed traffic and filter it out at the edge of an ISP network.
This prevents garbage traffic being generated by amplifiers located
within the network saving ISP’s and its customers resources. Whilst
the previous our paper concentrates on the idea and evaluates po-
tential gains of ISPs, this work shows viability of our approach
showing a real prototype of our system.
2 APPROACH DESCRIPTION
The large scale impact with even limited resources and the ease
of launching make DRDoS attacks very popular among criminals.
Figure 1 explains how this kind of attack works. An attacker (IP
198.51.100.1) issues requests to the hosts running vulnerable
protocols called amplifiers (in our case, a DNS server with IP
192.0.2.3 and an NTP server with IP 192.0.2.2) with a spoofed
source IP address (written in red) that corresponds to a victim
Figure 1: Amplification in DRDoS Attacks
Figure 2: System Overview
(IP 203.0.113.4). Due to the existing functional vulnerabilities in
these protocols, some types of requests (e.g., the monlist command
in NTP) may generate considerably larger responses. Upon receiv-
ing this kind of request, the service replies with a much bigger
response to the spoofed IP address of the victim. The reflective
nature of these attacks brings an additional benefit to criminals,
allowing them to stay anonymous (attacker source IP address is
not exposed).
A network of an ISP provider may contain hundreds or even
thousands of hosts vulnerable to amplification attacks. If being
abused, collectively they can generate a huge amount of unneces-
sary traffic. As garbage, we consider the amplified traffic that flows
from amplifiers to victims (bold blue arrows in Figure 1). According
to our evaluation [16], a single host vulnerable to NTP amplification
could generate more than 2 TB of garbage traffic a day).
Figure 2 describes our approach. There are four main components
in our system (marked with Roman numerals): (I) SDN Controller;
(II) DRDoS Firewall Application; (III) SDN Forwarding Device; and
(IV) Amplification Honeypot. All incoming traffic to the ISP network
passes through the SDN Forwarding Device. This edge device plays
the role of a firewall, blocking the flows that match filtering rules.
These rules are generated by the DRDoS Firewall Application based
on the data provided by the Amplification Honeypot. The DRDoS
Firewall Application uses the SDN Controller to deploy the rules on
the SDN Forwarding Device.
Our system operates in the following way. During a preliminarily
scan, an attacker discovers two hosts in ISP’s network vulnerable to
the DNS amplification attack: an open resolver with IP 192.0.2.3
and our amplification honeypot with IP 192.0.2.1 (see Figure 2).
Later, the adversary uses the discovered hosts to launch an attack
to the victim (IP 203.0.113.4). During the attack, the adversary
sends request packets to the discovered vulnerable hosts targeting
the vulnerable protocol running on a predefined UDP port (e.g., port
53 for DNS), changing source address to the victim IP (see green
arrows of Steps 1 and 2). The vulnerable host and the honeypot
replies to the victim IP with the amplified responses. However, the
honeypot also starts monitoring the traffic heading to the victim IP.
If its volume exceeds a predefined threshold, the honeypot sends an
alert to the DRDoS Firewall Application (Step 4). The application
through the SDN Controller (Step 5) issues an OpenFlow firewall
rule to the SDN Forwarding Device (Step 6) that blocks all incoming
packets with the source address and destination port matching the