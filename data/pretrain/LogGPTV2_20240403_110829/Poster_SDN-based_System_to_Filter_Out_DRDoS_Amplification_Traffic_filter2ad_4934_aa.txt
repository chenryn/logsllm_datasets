# Poster: SDN-based System to Filter Out DRDoS Amplification Traffic in ISP Networks

**Authors:**  
Priyanka Dodia  
Qatar Computing Research Institute, HBKU  
Doha, Qatar  
Email: [PI:EMAIL]

Yury Zhauniarovich  
Perfect Equanimity  
Minsk, Belarus  
Email: [PI:EMAIL]

## Abstract
Distributed Reflected Denial of Service (DRDoS) attacks continue to be a prevalent method for depleting the network bandwidth of targeted victims. Although the primary objective is to disrupt the services of a specific victim, these attacks also affect a large number of innocent internet users. Specifically, the owners of services that are vulnerable to amplification must expend resources to process incoming requests. Additionally, the voluminous attack traffic generated by amplification consumes significant Internet Service Provider (ISP) resources, including bandwidth and financial costs, leading to Quality of Service (QoS) degradation and increased subscription fees for customers.

In this work, we present a Software-Defined Networking (SDN)-based system designed to filter out malicious traffic from an ISP network. We utilize a specialized honeypot to gather information about ongoing DRDoS attacks. The firewall rules derived from this data are used to block incoming amplification requests, preventing them from reaching amplifiers within the provider network. This not only protects vulnerable services but also reduces the generation of malicious traffic, thereby saving ISP resources and improving QoS.

## CCS Concepts
- **Security and Privacy**: Denial-of-service attacks, Firewalls
- **Networks**: Network architectures, Programmable networks

## Keywords
Amplification attacks, SDN, Malicious traffic filtering, Honeypot, ISP networks

## ACM Reference Format
Dodia, P., & Zhauniarovich, Y. (2019). Poster: SDN-based System to Filter Out DRDoS Amplification Traffic in ISP Networks. In 2019 ACM SIGSAC Conference on Computer and Communications Security (CCS '19), November 11–15, 2019, London, United Kingdom. ACM, New York, NY, USA, 3 pages. https://doi.org/10.1145/3319535.3363277

## 1. Introduction
DRDoS attacks remain a significant threat to the internet due to their low resource requirements and the ability to remain stealthy. In these attacks, attackers send crafted requests with spoofed IP addresses of the victim to genuine machines called amplifiers. These amplifiers then return responses that are significantly larger than the original requests, overwhelming the victim's bandwidth. For example, in February 2018, GitHub experienced a DRDoS attack with a peak volume of 1.35 Tb/sec [7].

The most effective global strategy to combat DRDoS attacks is to implement ingress filtering, allowing only packets with valid source IP addresses to pass. This recommendation is outlined in RFC 2827 [13], also known as Best Current Practice No. 38 (BCP 38). However, ISPs are not incentivized to adopt these recommendations because they require significant resources for traffic filtering, without directly protecting the ISP or its customers from DRDoS traffic. ISPs also often overlook the problem of malicious traffic generated by amplifiers within their networks, instead charging the owners of vulnerable hosts.

Despite this, ISPs indirectly suffer from this unwanted traffic. First, it exhausts the bandwidth of both the ISP and its customers, affecting QoS. Second, last-mile ISPs typically purchase bandwidth from upper-tier providers, incurring costs for asymmetric traffic. The traffic generated by amplifiers within an ISP's network can be substantial, potentially wasting significant resources and money. Third, processing attack requests can negatively impact the performance of vulnerable hosts.

### Contributions
In this demonstration, we describe an SDN-based implementation of the approach proposed in our previous paper [16]. Unlike most existing DRDoS mitigation solutions [11, 14, 15] that focus on protecting the victim's network, our aim is to shield amplifiers from illegitimate requests. Our prototype can detect and filter out spoofed traffic at the edge of an ISP network, preventing the generation of malicious traffic and saving ISP and customer resources. While our previous paper focused on the concept and potential gains for ISPs, this work demonstrates the feasibility of our approach through a real prototype.

## 2. Approach Description
DRDoS attacks are popular among criminals due to their large-scale impact with limited resources and ease of execution. Figure 1 illustrates how such an attack works. An attacker (IP 198.51.100.1) sends requests to hosts running vulnerable protocols, known as amplifiers (e.g., a DNS server with IP 192.0.2.3 and an NTP server with IP 192.0.2.2), using a spoofed source IP address (in red) corresponding to the victim (IP 203.0.113.4). Due to functional vulnerabilities in these protocols, certain types of requests (e.g., the monlist command in NTP) generate much larger responses. The service replies with a much larger response to the spoofed IP address of the victim. The reflective nature of these attacks allows criminals to remain anonymous, as the attacker's source IP address is not exposed.

An ISP network may contain hundreds or even thousands of hosts vulnerable to amplification attacks. If abused, these hosts can collectively generate a massive amount of unnecessary traffic. We define this amplified traffic flowing from amplifiers to victims (bold blue arrows in Figure 1) as "garbage" traffic. According to our evaluation [16], a single host vulnerable to NTP amplification can generate more than 2 TB of garbage traffic per day.

Figure 2 provides an overview of our system, which consists of four main components:
1. **SDN Controller**
2. **DRDoS Firewall Application**
3. **SDN Forwarding Device**
4. **Amplification Honeypot**

All incoming traffic to the ISP network passes through the SDN Forwarding Device, which acts as a firewall, blocking flows that match the filtering rules. These rules are generated by the DRDoS Firewall Application based on data provided by the Amplification Honeypot. The DRDoS Firewall Application uses the SDN Controller to deploy the rules on the SDN Forwarding Device.

Our system operates as follows:
- During a preliminary scan, an attacker discovers two hosts in the ISP’s network that are vulnerable to DNS amplification: an open resolver with IP 192.0.2.3 and our amplification honeypot with IP 192.0.2.1 (see Figure 2).
- The attacker then uses these discovered hosts to launch an attack on the victim (IP 203.0.113.4). The attacker sends request packets to the vulnerable hosts, targeting the vulnerable protocol on a predefined UDP port (e.g., port 53 for DNS), while changing the source address to the victim's IP (green arrows in Steps 1 and 2).
- The vulnerable host and the honeypot respond to the victim's IP with amplified responses. The honeypot also monitors the traffic heading to the victim's IP.
- If the volume of traffic exceeds a predefined threshold, the honeypot sends an alert to the DRDoS Firewall Application (Step 4).
- The application, through the SDN Controller (Step 5), issues an OpenFlow firewall rule to the SDN Forwarding Device (Step 6) to block all incoming packets with the source address and destination port matching the identified pattern.

This approach effectively filters out malicious traffic, protecting both the ISP and its customers.