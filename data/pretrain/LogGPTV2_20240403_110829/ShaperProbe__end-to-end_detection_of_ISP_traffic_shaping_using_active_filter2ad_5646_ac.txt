smaller ISP B that deploys shaping (while A does not) - we
cannot distinguish A from B based on BGP preﬁx-to-ASN
mapping. We study some of these factors in ISP case studies
next. Some ISPs disclose their traﬃc shaping conﬁgurations;
in such cases, we can validate our observations.
4.1 Case Study: Comcast
Comcast oﬀers Internet connectivity to homes [5] and en-
terprises [3], and uses two types of access technologies: cable
(DOCSIS 3.0) and Ethernet. In each access category, it of-
fers multiple tiers of service. Comcast shapes traﬃc using
the PowerBoost technology [4].
Shaping proﬁles. We observed many shaping conﬁgura-
tions at Comcast between October 2009 and May 2011. Fig-
ure 4 shows the shaping conﬁguration of each run (ordered
by capacity). For each run, designated by an ”ID”, we plot
two points in the top panel for the capacity and the shap-
ing rate; and a point in the bottom panel for the burst size.
The capacities form an envelope of the shaping rate points.
We see that there are strong modes in the data; Table 2 is
a summary of these modes. For higher capacities, we see
a larger number of modes in the shaping rate. However, at
the tail of the capacity distribution there is only one shaping
rate that corresponds to the highest service tier provided by
Comcast. We veriﬁed our observations with the Comcast
website listings [3, 5]. Note that we may not observe all
service tiers in that web page, depending on the number
of ShaperProbe users at each service tier. We also observe
two or three burst sizes that are used across all tiers; the
PowerBoost FAQ mentions 10MB and 5MB burst sizes [4].
476Capacity
Shaping rate
 16000
 14000
 12000
 10000
 8000
 6000
 4000
 2000
 0
 16000
 14000
 12000
 10000
 8000
 6000
 4000
 2000
 0
)
s
p
b
K
(
e
t
a
R
)
B
K
(
i
e
z
s
t
s
r
u
B
Capacity
Shaping rate
 60000
 50000
 40000
 30000
 20000
 10000
 0
 30000
 25000
 20000
 15000
 10000
 5000
 0
)
s
p
b
K
(
e
t
a
R
)
B
K
(
i
e
z
s
t
s
r
u
B
 0
 5000
 10000
 15000
 20000
 25000
 0
 5000
 10000
 15000
 20000
Run ID
(a) Upstream.
Run ID
(b) Downstream.
Figure 4: Comcast: Shaping characteristics.
upto 03/2010
since 03/2011
upto 03/2010
since 03/2011
 0
 5000
 10000
 15000
 20000
 25000
 0
 10000  20000  30000  40000  50000  60000  70000  80000  90000
Capacity (Kbps)
Capacity (Kbps)
 0
 2000  4000  6000  8000  10000 12000 14000 16000 18000 20000
 0
 10000
 20000
 30000
 40000
 50000
 60000
Shaping rate (Kbps)
(a) Upstream.
Shaping rate (Kbps)
(b) Downstream.
Figure 5: Comcast: histogram of bandwidth with time.
Note that the capacity curves do not show strong modes,
unlike the shaping rates. This is due to the underlying DOC-
SIS access technology. The cable modem uplink is a non-
FIFO scheduler; depending on the activity of other nodes at
the CMTS, the capacity can vary due to customer schedul-
ing and DOCSIS concatenation. A DOCSIS downlink can
also inﬂuence the dispersion-based capacity estimates under
heavy traﬃc load conditions because it is a broadcast link.
Did shaping conﬁgurations change during the last
two years?. We compare data from Comcast collected in
October 2009-March 2010 and in March-May 2011. Figure
5 shows estimates of the capacity and shaping rate distribu-
tions using a Gaussian kernel density estimator. In the up-
stream direction, the capacity and shaping rates (the modes
of the corresponding distributions) have not changed signif-
icantly. The downstream links show a new capacity mode
of 30Mbps and a shaping rate mode of 22Mbps in 2011. We
did not ﬁnd signiﬁcant changes in the burst size during the
last two years.
Non-shaped runs. We examine runs in which Shaper-
Probe did not detect shaping. Figure 6 compares the capac-
ity distribution in such runs with the shaping rate distribu-
tion in shaping runs. The non-shaped capacity distributions
are similar to the shaping rate distributions. Non-shaping
runs occur due to the following two reasons. First, Comcast
provides service tiers that do not include PowerBoost, but
have capacities similar to PowerBoost service tiers (e.g., the
Ethernet 1Mbps and 10Mbps business service). Second, it is
possible that cross traﬃc resulted in an empty token bucket
at the start of the measurement, and so the capacity that
ShaperProbe estimated was equal to the shaping rate; we
would not detect shaping in that case.
4.2 Case Studies: Road Runner and Cox
Road Runner (RR) is a cable ISP. A unique aspect of
RR is that we have found evidence of downstream shaping,
but no evidence of upsteam shaping in any service tier on
their web pages. The ShaperProbe measurements for RR
support this observation - 94% of the upstream runs did
not detect shaping, while 64% of the downstream runs did.
Another interesting aspect of RR is that shaping depends on
477F
D
C
 1
 0.8
 0.6
 0.4
 0.2
 0
 0
Upstream: non-shaping
Upstream: shaping
Downstream: non-shaping
Downstream: shaping
 10000
 20000
 30000
 40000
 50000
 60000
Capacity (Kbps)
Figure 6: Comcast: distribution of capacities in non-shaping
and shaping rate in shaping runs.
the geographic region of the customer; for example, in Texas,
RR provides four service tiers: the lower two are not shaped
while the upper two are shaped [10]. Under the hypothesis
that RR does not shape upstream traﬃc, we can say that
our false positive detection rate for their upstream links is
about 6.4%. The capacity distribution of non-shaped RR
runs shows that, unlike Comcast, the downstream capacity
mode of 750Kbps is not equal to any of their shaping modes
(ﬁgure omited due to space constraints; see [17]).
Cox provides residential and business Internet access using
cable and Ethernet access. The website [7] mentions that
the residential shaping rates and capacities depend on the
location of the customer. We gathered residential shaping
conﬁgurations from the residential pages [7]. The upstream
shaping properties of Cox runs in Figure 7 agree with some
of the ground truth information we found: (C, ρ)Mbps: (1,
0.77), (1.3, 1), (2, 1.5), (2.5, 1), (2.5, 2), (3, 2), (3.5, 3),
(5, 4) and (5.5, 5). Note that the previous ground truth
was collected in October 2010, while the ShaperProbe data
covers two years. We also found a single burst size mode.
4.3 Case Study: AT&T
Our ﬁnal case study is that of an ISP for which we do
not see frequent shaping detections (10% or less). AT&T
provides Internet access to a wide range of customers, from
homes and small businesses to enterprises (including other
ISPs). Their residential service includes four DSL service
tiers [1, 2]. We did not ﬁnd any mention of traﬃc shaping
in the AT&T service descriptions [1, 2].
Capacity. We ﬁrst look at the 90% of the runs that did not
see shaping. The capacity distribution of non-shaped runs
is shown in Figure 8. Given the point-to-point nature of
DSL links, ShaperProbe estimates the narrow link capacity
more accurately than in cable links. The capacity distri-
butions show several modes: {330Kbps, 650Kbps, 1Mbps,
1.5Mbps} upstream, and {1Mbps, 2.5Mbps, 5Mbps, 6Mbps,
11Mbps, 18Mbps} downstream. We did not observe signiﬁ-
cant changes in the capacity modes between 2009-2011.
Shaping runs. We look at the 10% of AT&T runs that
were probably mis-diagnosed as shaping. We found that
about a third of these runs exhibit strong shaping rate modes
)
s
p
b
K
(
e
t
a
R
)
B
K
(
i
e
z
s
t
s
r
u
B
F
D
C
Capacity
Shaping rate
 9000
 8000
 7000
 6000
 5000
 4000
 3000
 2000
 1000
 0
 5000
 4500
 4000
 3500
 3000
 2500
 2000
 1500
 1000
 500
 0
 0
 500
 1000
 1500
 2000
 2500
 3000
 3500
Run ID
Figure 7: Cox: Upstream shaping.
 1