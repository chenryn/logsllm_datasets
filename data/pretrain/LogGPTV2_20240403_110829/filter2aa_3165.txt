Hack Mobile Games For Fun
HITCON 2015
ChienWei Hung (winest)
2
四年前被骗入趋势当研替
游戏资歷22年
• 永远的β测试玩家
你哪位？
3
四年前被骗入趋势当研替至今
游戏资歷22年
• 永远的β测试玩家
4
來聊聊手机游戏破解
5
2014年营收
6
Rank
1
2
3
4
5
6
7
8
9
10
from App Annie
Rank
10
9
8
7
6
5
4
3
2
1
iOS App Store
Taiwan
Russia
France
Germany
Canada
Australia
United Kingdom
China
Japan
United States
Google Play
Japan
United States
South Korea
Germany
Taiwan
United Kingdom
France
Hong Kong
Australia
Canada
LV. 0
7
破解 解锁 已付费
8
LV. 1
8
LV. 1 限制
Root
Memory未加密
程式的验证很弱
• Root检查
• 已安装程式检查
• 动作前后數值检查
LV. 2
Unpack apk
• java ‐jar apktool.jar d ‐f “” ‐o “”
Repack apk
• java ‐jar apktool.jar b “”
• java ‐jar signapk.jar “” “” 
“” “”
11
12
Bytecode的好处
13
可以直接看source code
• d2j‐dex2jar ‐f “” ‐o “”
• jd‐gui “”
14
LV. 2 限制
没有被obfuscated
程式没有检查checksum
主程式用Java写
LV. 3
手机游戏架构
17
简易數值修改
18
Unpack apk
Disassemble到il
• ildasm.exe  /OUT= /UTF8
修改*.il
Assemble回dll
• ilasm.exe  /DLL /OUTPUT= 
/RESOURCE=
Repack and sign apk
LV. 4
19
.NET Reflector配合Reflexil
LV. 5
20
Visual Studio客制化修改
自制Tool调整offset
• https://github.com/winest/CILTools
防御
Obfuscate
• Android有，Unity也有，就是没人用，超爽der
内容加密
合理范围检查
适可而止，否则兩败俱伤 XD
兩败俱伤 XD
兩败俱伤 XD
大家來研究
22
如果你符合
• 我讲的你都会了
• 各式Game Engine或iOS专家
• 愿意提供1G RAM以上iOS机种做研究
欢迎來聊聊不一样的东东
23
Thanks ^^
本人在此特地声明：
本人樂观开朗，身体健康，无任何使我困扰之慢性病或心理疾病，故绝不可能做出任何看似自殺之行为。
本人从无睡眠困扰，故不需服用安眠药。本人不酗酒亦不吸毒，也绝不会接近下列地点──
1. 开放性水域
2. 无救生员之游泳池
3. 有高压、危险气体，或密闭式未经抽气处理之地下室、蓄水池、水桶等
4. 无安全护欄之任何高处
5. 任何施工地点（拆政府除外），包括制作消波块之工地
6. 任何以上未提及但为一般人正常不会前往之地点
本人恪遵下列事项──
1. 車辆上路前会检查煞車部件、油门线等，并会在加油前关闭車辆电源与行动电话。
2. 绝不擅抢黄灯、闯红灯。
3. 乘坐任何轨道類交通工具一定退到警戒线后一步以上，直到車辆停妥。
4. 骑乘机車必戴安全帽；乘車必系安全带。
5. 绝不接近任何会放射对人体有立即危害的輻射之场所或设备。
6. 台风天不登山、不观浪、不泛舟。
本人将尽可能注意电器、瓦斯、火源、水源之使用。
本人居住之房屋均使用符合法规之电路电线，绝无电线走火之可能；也绝未在家中放置过量可燃性气体或液体。
浴室中除该有之照明外，不放置任何电器用品，并在睡觉前关闭除电灯、冰箱、电扇外之所有电器开关。
本人绝不会与随机的不明人士起冲突，并尽可能保护自我人身安全。
所以若各位在看完此声明之后，近期或将來发现本人不再上线，请帮我讨回公道，谢谢。