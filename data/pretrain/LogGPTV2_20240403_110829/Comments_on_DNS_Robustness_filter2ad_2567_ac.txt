8,347
6,111
5,568
5,076
4,788
4,611
204,075
Partial SLDs
3,066
328
17
3,727
3
631
375
69
648
4,820
–
/24s
2
2
2
2
2
2
3
2
2
4
23
Same Last Hop
✓
✓
✓
✓
✗
–
Table 1: Top ten SLD groups based on IP address.
Table 2: Top ten SLD groups based on /24 address prefix.
Our first exploration is via a host-based analysis of nameserver
sharing. For each fully resolved SLD in our dataset we compute the
number of other SLDs that use precisely the same set of IP addresses
as authoritative nameservers. From these per-SLD counts we obtain
a distribution across all SLDs for each month of our dataset. The
left-hand plot of Figure 4 shows the median and maximum of this
distribution over time. In April 2018 we find that half the SLDs
exactly share a set of nameservers with at least 163 other SLDs.
Further, we find the largest group contains 9K SLDs that share
the exact same set of nameservers. Additionally, the plot shows
nameserver sharing at the IP level is relatively stable over time,
with small variations but no large trends.
Table 1 lists the ten largest SLD groups that rely on the exact
same set of nameservers within the group in April 2018. The second
column shows the group size, with the largest group containing
9K SLDs. In sum, the top ten groups contain over 47K SLDs—or,
4.7% of Alexa’s list of top sites. The third column shows the num-
ber of additional SLDs that have some—but not complete—overlap
with the group’s nameserver set. The range of partial overlap is
large—from only three SLDs in Group 2 to over 1K SLDs in Groups 7
and 10. The final column shows the size of the nameserver set for
each group. Four of the groups use two nameservers—the mini-
mum requirement prescribed in RFC 1034 [8]. However, most of the
groups exceed the minimum requirements, with Group 5 utilizing
ten nameservers. Each additional nameserver an SLD leverages
decreases the chances that the SLD’s names will become unresolv-
able due to host level issues. Across the ten largest groups we find
40 nameservers (out of 96K nameservers in the WZFs). In summary,
we find 0.04% of the nameservers in our dataset are responsible for
4.7% of the popular SLDs.
We next turn to a network-based analysis of sharing. The analy-
sis is similar to the host-based analysis, whereby we first determine
the /24 address blocks that contain each fully resolved SLD’s name-
servers.6 Next, for each SLD we determine the set of other SLDs
that leverage nameservers in precisely the same /24 blocks. From
these per-SLD counts we obtain a distribution across all SLDs for
each month of our dataset. The right-hand plot in Figure 4 shows
the median and maximum of this distribution over time. We find
there is more shared infrastructure when viewed from a network
perspective than from a host perspective. Further, we find that
sharing network-level infrastructure is becoming more common
over time. The plot shows that half the SLDs belong to groups with
at least 3K other SLDs in April 2018. This is an increase of more
than 25 times when compared to April 2009. Over our dataset we
find that the maximum group size has more than doubled from 34K
SLDs in April 2009 to 71K SLDs in April 2018.
Table 2 gives information about the largest ten SLD groups in
April 2018. The largest group includes over 71K SLDs that have out-
sourced their DNS services to CloudFlare. The second largest group
has nearly 70K SLDs and is run by another DNS provider, GoDaddy.
We find a dramatic drop in the group size starting with Group 3—
which is only 22% as big as Group 2. We find nine DNS providers
across the ten groups—with the only repeat being Groups 1 and 4,
consisting of distinct sets of CloudFlare customers. In total, the ten
groups cover more than 20% of the popular SLDs.
The third column of the table shows the number of SLDs that
have some, but not all, of their nameservers in the group’s /24 blocks.
6As in § 4, using /24 prefixes as the basis of topological location provides a conservative
bound since smaller address blocks cannot be confidently routed in the Internet.
88
 10 100 1000 10000 10000020092010201120122013201420152016201720182019Number of Overlapping SLDsMaximumMedian 10 100 1000 10000 10000020092010201120122013201420152016201720182019Number of Overlapping SLDsMaximumMedianIMC ’18, October 31-November 2, 2018, Boston, MA, USA
Mark Allman
Finally, we analyze the data to determine whether shared infras-
tructure occurs more frequently in higher or lower ranked domains.
Our analysis does not point to any general results or particular
trends. Figure 5 shows the distribution of Alexa ranks for three
exemplar groups from Table 2. A group with uniform distribution
across the Alexa list would show as a straight diagonal line. The
plot shows that Group 6 (black line) is approximately uniformly
distributed. Meanwhile, Group 1 (blue line) skews towards more
popular SLDs and Group 2 (red line) skews to less popular SLDs.
Our initial analysis indicates that there is no predominant behavior
across groups.
Recommendation 5: DNS providers should increase the topologi-
cal diversity of their nameservers in terms of both servers and edge
networks.
Recommendation 6: While it is tempting to simply delegate all
responsibility to a single DNS provider, SLD owners should remain
vigilant as to the robustness of the provider. Leveraging multiple
providers or retaining a small bit of in-house DNS capability would
increase an SLD’s robustness. As future work we intend to build a
web-based tool to aid SLD owners in understanding the robustness
and connectedness of their domains.
Recommendation 7: Piggybacking on the previous suggestion,
the DNS could benefit from the notion of “backup” records. In other
words, an SLD owner could list a set of nameservers that are to be
used only when the primary nameservers are unreachable. This
would facilitate using multiple DNS providers. I.e., an SLD’s general
operation could stay as it is now—based on a single DNS provider—
but the SLD could also have a backup provider (perhaps self-hosted)
that can serve DNS responses only when problems arise.
6 SUMMARY & FUTURE WORK
While the analysis in this paper is admittedly initial and can clearly
be improved in a number of ways—e.g., using historical routing
data or a systematic understanding of anycast routing—we stress
that the analysis is conservative. We add to an understanding of
how DNS operates in the wild. Further, our goal is not to suggest
that the sky is falling within the DNS ecosystem. However, we do
highlight a number of places where the robustness of DNS could
be improved—and in some cases at little cost.
Our future work includes a deeper analysis based on more and
different data (e.g., more zone files, historical routing data). This will
naturally include a deeper understanding of how anycast routing
factors into DNS robustness. Also, we intend to tackle additional
aspects of robustness that this initial work does not consider—e.g.,
issues arising from the intersection of structural concentration and
software homogeneity.
ACKNOWLEDGMENTS
This paper benefits from the contributions of a number of people
and organizations. Verisign provided the .com, .net and .org zone
files. Emile Aben and Quirin Scheitle generously shared Alexa lists
that filled in gaps in our own collection. The IMC reviewers and
in particular our shepherd, Dina Papagiannaki, provided excellent
guidance that improved the paper. This work was partially funded
by NSF grants 1237265 and 1815876. Our thanks to all!
89
Figure 5: Dist. of Alexa ranks for 3 groups from Table 2.
Similar to our host-based results, we find this partial overlap to
in some cases be small—e.g., Group 5 has only three SLDs that
partially overlap. On the other hand, three groups each have more
than 3K SLDs that partially share infrastructure with the group.
The fourth column of the table shows the number of /24 blocks
that contain all nameservers for the group. Only Groups 7 and 10
employ more than two /24 address blocks, which represents the
minimum topological diversity assuming the prefixes are routed to
different edge networks. Across the ten groups we find all name-
servers reside in 23 /24 address blocks.
We refine our analysis by consulting our traceroute data for all
/24 blocks containing nameservers in the top ten groups. The fifth
column shows whether the nameservers in the given group all use
the same last hop router. We find four groups do in fact concen-
trate all their nameservers at a single edge network. Meanwhile,
for Group 7 traceroute indicates there is in fact topological diver-
sity. For the groups with no indication in the last column, the last
hop router did not answer traceroute queries. However, in all these
cases, inspection of the traceroute output indicates that the groups
likely do not use the same last hop router for all their nameservers.
In addition, while the /24 blocks used by Groups 1 and 4—both
representing CloudFlare customers, as we note above—are distinct,
all nameservers used by both groups share a last hop router. There-
fore, over 86K SLDs rely on a single edge network. While we find
nameservers in 23 /24 blocks, we determine that at most this repre-
sents 18 edge networks when digging more deeply into the network
topology.7 In other words, over 20% of the popular SLDs depend
on 18 edge networks.
An additional note is that we find that three of the four groups in
Table 2 that map to a single last hop router likely leverage anycast.
Specifically, as we discuss in § 3, we use traceroute looking glasses
on each continent to determine the route to each /24 used by the
four groups that share a last hop router. We find that regardless
of vantage point from which we run traceroute the nameservers
within a group share a last hop router. However, the specific last
hop router varies by where we run traceroute. This indicates that
anycast is routing traffic to different edge networks for different
source locations. As we sketch in § 3, anycast is beneficial for global
robustness, but does not solve all robustness issues.
7This is a conservative analysis that assumes all last hop routers that traceroute cannot
determine are distinct.
 0 0.2 0.4 0.6 0.8 1 0 200000 400000 600000 800000 1x106CDFAlexa Rank/24 Group 1/24 Group 6/24 Group 2Comments on DNS Robustness
IMC ’18, October 31-November 2, 2018, Boston, MA, USA
REFERENCES
[1] [n. d.]. Alexa Web Ranking. http://alexa.com.
[2] 2016.
Dyn Analysis Summary Of Friday October
21 Attack.
https://dyn.com/blog/dyn-analysis-summary-of-friday-october-21-attack/.
[3] Casey Deccio, Chao-Chih Chen, Prasant Mohapatra, Jeff Sedayao, and Krishna
Kant. 2009. Quality of Name Resolution in the Domain Name System. In Intl.
Conference on Network Protocols.
[4] R. Elz, R. Bush, S. Bradner, and M. Patton. 1997. Selection And Operation of
Secondary DNS Servers. RFC 2182.
[5] T. Hardie. 2002. Distributing Authoritative Name Servers Via Shared Unicast
Addresses. RFC 3258.
[6] Amir Herzberg and Haya Shulman. 2013. Fragmentation Considered Poisonous,
or: One-Domain-to-Rule-Them-All. In IEEE Conf. on Communications and Network
Security (CNS). 224–232.
[7] D. Kaminsky. 2008. Black Ops 2008: It’s the End of the Cache As We Know It.
Black Hat USA (2008).
[8] P.V. Mockapetris. 1987. Domain Names - Concepts And Facilities. RFC 1034.
[9] Venugopalan Ramasubramanian and Emin GÃĳn Sirer. 2005. Perils of Transitive
Trust in the Domain Name System. In ACM Internet Measurement Conference.
[10] Quirin Scheitle, Oliver Hohlfeld, Julien Gamba, Jonas Jelten, Torsten Zimmer-
mann, Stephen D. Strowes, and Narseo Vallina-Rodriguez. 2018. A Long Way
to the Top: Significance, Structure, and Stability of Internet Top Lists. In ACM
Internet Measurement Conference.
[11] Kyle Schomp, Tom Callahan, Michael Rabinovich, and Mark Allman. 2014. As-
sessing DNS Vulnerability to Record Injection. In Passive and Active Measurement
Conference.
[12] Craig Shue, Andrew Kalafut, and Minaxi Gupta. 2007. The Web is Smaller than
it Seems. In ACM Internet Measurement Conference.
90