title:Specification-Based Intrusion Detection in WLANs
author:Rupinder Gill and
Jason Smith and
Andrew J. Clark
Speciﬁcation-Based Intrusion Detection in WLANs
Rupinder Gill, Jason Smith and Andrew Clark
Information Security Institute, Queensland University of Technology
GPO Box 2434, Brisbane, 4001, QLD, Australia
{rs.gill, j4.smith, a.clark}@qut.edu.au
Abstract
Wireless networking technologies based on the IEEE
802.11 series of standards fail to authenticate man-
agement frames and network card addresses and suf-
fer from serious vulnerabilities that may lead to de-
nial of service, session hijacking, and address mas-
querading attacks. In this paper, we describe and im-
plement a speciﬁcation-based intrusion detection sys-
tem for IEEE 802.11 wireless infrastructure networks,
which not only provides attack detection, but also im-
plements policy compliance monitoring. The speciﬁca-
tion used by our intrusion detection system is derived
from network protocol state transition models and site
security policy constraints. We also perform an exper-
imental and comparative analysis of the technique to
assess its eﬀectiveness. The results indicate that the
approach is superior at successfully detecting a greater
variety of attacks than other existing approaches.
1. Introduction
The notion of monitoring computer systems and
networks for malicious activity is long-standing and
nowhere is the requirement for preventative approaches
to security to be supplemented by a monitoring and
detection capability more exigent than in wireless local
area networks (WLANs). The broadcast nature of the
physical (PHY) layer in wireless networks makes gain-
ing access to the medium a trivial undertaking. Flawed
legacy encryption schemes such as wired equivalence
privacy (WEP), the forgeabilty of management frames
and the spoofability of Media Access Control (MAC)
addresses and other frame contents combine to make
attacks like eavesdropping, session hijacking and denial
of service (DoS) a real threat for WLANs.
While recent enhancements to the IEEE 802.11 stan-
dard [8] undoubtedly improve the level of security that
preventative techniques can bring to bear on wireless
network deployments, two factors must be considered.
Firstly, transitional security deployment modes that
support the concurrent use of the obsoleted and the
current security primitives, leave the network vulnera-
ble to attacks that target the legacy algorithms. Sec-
ondly, while a large number of authentication protocols
are supported via the extensible authentication proto-
col (EAP) framework adopted by IEEE 802.11i, few are
suitable for use in wireless environments [14]. Both of
these factors serve to increase the conﬁguration burden
associated with deploying secure wireless networks and
motivate the need for techniques to monitor for policy
compliance as well as intrusions when wireless networks
are deployed in security sensitive environments.
Intrusion detection systems (IDSs) monitor either
for evidence of intrusions or for deviations from ex-
pected behaviour. When the events of interest to an
IDS deﬁne the undesirable behaviour, or intrusions,
the system is said to be a misuse-based IDS. When the
events of interest to an IDS are the expected or nor-
mal behaviours of the monitored system, with intru-
sions deﬁned as deviation of the monitored behaviour
from this baseline, the system is said to be an anomaly-
based IDS. Misuse-based IDSs use signatures for attack
detection, while anomaly-based systems rely on iden-
tifying attacks by detecting deviations from learned
normal behaviour. Misuse-based systems enjoy the
reputation of having a low false positive rate, while
anomaly-based systems can generate a large number
of false positives. However, unlike anomaly-based sys-
tems, misuse-based systems cannot detect novel attacks
or attacks for which no signatures are available.
More recently (and as discussed in related work in
Section 3), the construction of anomaly-based systems
that deﬁne models of correct behaviour from explicit
policy declarations [4], referred to as speciﬁcations 1, in-
1While some authors will refer to speciﬁcation-based intrusion
detection as a separate category of detection technique to misuse
and anomaly detection, we view the speciﬁcation-based approach
as a useful technique for constructing anomaly-based IDSs.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:34:02 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006stead of observing and learning correct behaviour dur-
ing a training phase, represent a promising direction
for improving the utility of anomaly-based IDSs and
reducing their false positive/false negative rate.
1.1. Our Contribution
In this paper we describe the construction of an
IDS, using the speciﬁcation-based approach, for IEEE
802.11 infrastructure wireless LANs. The correct
model of behaviour used by our IDS is formed from
a speciﬁcation that is derived by combining a model of
the underlying protocol state machines with the con-
straints imposed by the security policy of the system.
We report on our implementation and demonstrate
its eﬀectiveness via experimentation and comparative
analysis. In summary, the contributions of this work
include:
1. the description of an approach for constructing
an anomaly-based IDS, in which the underlying
model of correct behaviour is derived from an ex-
tensible speciﬁcation;
2. the application of the anomaly-based IDS to IEEE
802.11 infrastructure wireless LANs; and
3. an experimental and comparative analysis of the
technique to assess its eﬀectiveness.
The remainder of the paper is structured as follows.
Section 2 describes infrastructure wireless LANs and
details the speciﬁc threats to them. Related work is
covered in Section 3. Our approach to implementing
a speciﬁcation-based IDS and application of this ap-
proach to infrastructure wireless LANs is presented in
Section 4. Experimental analysis and comparison of
our technique with other wireless IDSs is discussed in
Section 5. Finally, conclusions and directions for future
work are presented in Section 6.
2. Security of Infrastructure WLANs
The technique we describe in this paper has been
applied to detect a variety of attacks that are possible
in infrastructure WLANs. An infrastructure WLAN
is one in which the wireless nodes (STAs) communi-
cate via an access point (AP) which is connected to a
wider ﬁxed (or infrastructure) network. Our technique
focuses on modelling the protocols used between the
STAs and the AP.
Numerous security weaknesses existed in early im-
plementations of IEEE 802.11 wireless network com-
ponents (some of these weaknesses are inherent in
the protocols and algorithms speciﬁed in the 802.11
standard). The more recent 802.11i enhancements to
the MAC layer protocols address many of the orig-
inal weaknesses. The IEEE 802.11i standard intro-
duces the notion of a robust security network associ-
ation (RSNA) which allows mutual authentication, in-
troduces key management protocols and new data en-
cryption and integrity protocols. RSNA uses 802.1X
and EAP for authentication and access control. How-
ever, 802.1X and EAP were not designed speciﬁcally for
wireless environments and many of the authentication
protocols supported by EAP are unsuitable for use in
WLANs [14]. The 802.11i standard allows RSNA and
pre-RSNA (i.e., WEP and the original 802.11 authen-
tication) to co-exist in what is referred to as atran-
sitional security network (TSN). This means that an
STA may be conﬁgured to connect to both RSNA and
pre-RSNA networks. In this case, a security roll-back
attack may be employed by an adversary to trick the
STA into using pre-RSNA by impersonating associa-
tion frames from an RSNA-conﬁgured AP [7]. An-
other signiﬁcant problem that remains, even in 802.11i
networks, is that the management frames used by the
MAC layer are not authenticated. Neither the original
IEEE 802.11 standards, nor the recent IEEE 802.11i
standard specify mechanisms for protecting the in-
tegrity of management frames,
leaving IEEE 802.11
based WLANs vulnerable to management frame spoof-
ing and the associated DoS attacks that such spooﬁng
permits [1]. Even the EAP frames used for authenti-
cation in 802.11i networks are unprotected and can be
easily used as a means to launch similar attacks against
wireless LANs [12].
In this paper we demonstrate that by using a spec-
iﬁcation based upon the state model of the 802.11,
802.1X and EAP protocols we are able to detect a sig-
niﬁcant number of the DoS attacks which arise due
to unauthenticated management and EAP frames. In
addition, we show that by monitoring protocol execu-
tions to ensure that certain constraints are met (for
example, constraints on the algorithms or authentica-
tion protocols used) it is possible to detect violations
of organisational security policy.
3. Related Work
Our work combines state transition modelling with
constraints derived from a security policy to construct
a speciﬁcation of correct behaviour that can be used in
an anomaly-based IDS. The relevance of previous work
in the areas of state transition modelling, speciﬁcation-
based intrusion detection, and wireless intrusion detec-
tion to our current work is now discussed.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 25,2021 at 12:34:02 UTC from IEEE Xplore.  Restrictions apply. 
Proceedings of the 22nd Annual Computer Security Applications Conference (ACSAC'06)0-7695-2716-7/06 $20.00  © 2006Ilgun et al. [9] proposed the use of state transition
analysis for intrusion detection. The work currently
presented obviously draws on the foundational ideas
presented by Ilgun et al. [9] but instead of using state
transitions to model attacks, we use state transitions
as the foundation for a speciﬁcation-based anomaly de-
tection scheme. Speciﬁcation-based intrusion detection
was ﬁrst suggested by Ko [10] and required the deﬁni-
tion of desirable application behaviour (with respect to
a site security policy) and the subsequent monitoring
of the execution of the application for violations of the
speciﬁcation. Sekar et al. [13] generated a speciﬁcation-
based model of the internet protocol (IP) state machine
and combined this with more traditional statistical ma-
chine learning techniques for anomaly detection. Our
work is similar, in that we use the network protocol
speciﬁcation as the starting point to simplify the gen-
eration of our state transition speciﬁcation, but dif-
fers in that we have no need to superimpose statis-
tically based techniques to achieve accurate detection
of intrusions. Tseng et al. [2] applied the speciﬁcation-
based approach to detecting intrusions targetting rout-
ing protocols in ad hoc networks. The speciﬁcation
of the correct behaviours expected are created from
a ﬁnite state machine model of the routing protocol.
While this work serves as a potent stimulant for our
work, which applies the speciﬁcation technique to in-
frastructure, rather than ad hoc networks, our work
diﬀers in that it does not require the use of such strong
assumptions. For example, there is no assumption in
our work that MAC addresses cannot be forged and in
fact, our approach allows us to detect MAC address
spooﬁng attacks.
Current approaches for detecting address spooﬁng
attacks include:
the monitoring of MAC frame se-
quence numbers [15] and veriﬁcation of MAC addresses
against lists of valid users or valid wireless network
card vendors [3]. As both MAC addresses and frame
sequence numbers can be arbitrarily changed, such
approaches are insuﬃciently robust. While Guo and
Chiueh [6] describe how monitoring patterns of se-
quence number changes can improve the robustness
of sequence number monitoring for attack detection,
the technique remains unsuitable for policy compliance
monitoring.
Techniques based on monitoring the physical char-
acteristics, as viewed by the receiver of radio transmis-
sions, have also been proposed and implemented. Two
parameters appear to be useful, including the received
signal strength indication (RSSI), which provides a nu-
meric indication of the strength of a received signal,
and round trip time (RTT) measurements. Approaches
based on RSSI monitoring have been reported by Lim
et al. [11] and Gill et al. [5]. Gill et al. also report pre-
liminary success on implementing RTT monitoring [5].
A signiﬁcant advantage of using physical layer param-
eters in an IDS is that they are much more diﬃcult to
accurately predict, and therefore fabricate (as an at-
tacker may wish to do), given the dynamic nature of
the wireless environment. The use of such parameters,
however, requires considerable ﬁne-tuning of the de-
ployment environment so that appropriate thresholds
can be selected in order to minimise false positives and
reduce the likelihood of false negatives.
A signiﬁcant observation that can be made regarding
existing wireless intrusion detection approaches is that
all the techniques, unreliable and ineﬀective as they
may be, are focused on attack detection only. None
of the techniques surveyed support policy compliance
monitoring, an essential and signiﬁcant contribution of
the work presented in this paper.
4. Speciﬁcation-Based Approach
In this section, we describe how a speciﬁcation is
constructed for our IDS and how such a speciﬁcation
can be used by a wireless sensor to monitor a network
for both attacks and compliance with the network se-
curity policy.
At a high level, a passive wireless sensor monitors
the radio frequency (RF) spectrum and constructs a
state transition model for each STA and associated AP
that it senses. The sensor is conﬁgured with a spec-
iﬁcation, which encapsulates both the expected state
transitions and the constraints of the network security
policy. Each frame received by the sensor is evaluated
against the speciﬁcation. If this evaluation reveals that
a security constraint is violated, or unexpected state
transitions occured, an alert is raised by the sensor.
To motivate and explain our approach in concrete
detail, we consider the example of a security sensitive
WLAN deployment within an organisation. Given the
sensitivity of the deployment and following a risk as-
sessment, an organisational security policy for the use
of WLANs is established. In summary, this policy re-
quires that: the wireless network implement a robust
security network (RSN), utilising the advanced encryp-
tion standard (AES) for link layer integrity and conﬁ-
dentiality protection; port-based network access con-
trol is implemented using 802.1X; and the STAs must
mutually authenticate with the network using EAP-
TLS.
The speciﬁcation used by our IDS consists of two