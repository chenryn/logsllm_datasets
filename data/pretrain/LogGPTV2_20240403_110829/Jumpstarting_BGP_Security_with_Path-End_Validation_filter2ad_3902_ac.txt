success rate of an attacker drawn uniformly at random. Our
results show that path-end validation provides signiﬁcant se-
curity beneﬁts, reducing the attacker’s success rate with his
best strategy (2-hop attack) to 5.8% with only 20 adopters,
improving over RPKI (8.3%) and partial deployment of BG-
Psec (8.2% when all top 100 ISPs adopt). In fact, path-end
validation almost reaches the best we could hope for before
BGP is deprecated, i.e., 5.3% attacker success rate when BG-
Psec is fully deployed (but the attacker can still advertise
legacy BGP routes).
Results for speciﬁc classes of attackers and victims. Our
results above are for the scenario of random attackers and/or
victims. Since most ASes on the Internet (over 85%) are
stubs, i.e., ASes with no customer ASes, this greatly biases
the results towards stub attackers and victims. To see how an
attacker/victim’s size and location within the ISP hierarchy
affect the results we ran the same simulations for different
classes of attackers and victims. We consider four classes:
(1) large ISPs (250+ customers), (2) medium ISPs (250 >
customers ≥ 25), (3) small ISPs (25 > customers ≥ 1), and
(4) stubs (no customers). We generated results, similarly to
the results in Figure 2a, for all 16 combinations of attackers
and victims in these categories.
Our results for all 16 attacker-victim scenarios reveal that
347
Figure 4: Attacker success rate as a function of hops in ma-
licious BGP advertisement
with relatively few adopters (the numbers vary from less than
10 to 100, depending on the categories of attacker and vic-
tim), path-end validation renders the next-AS attack less ef-
fective than the 2-hop attack, as before. We present, due
space constraints, our results for the two extremes: the most
central ASes (transit-wise), namely the large ISPs, and the
least central ASes, i.e., stubs. See Figures 3a and 3b for re-
sults in the scenario that the attacker is a large ISP and the
victim is a stub, and vice versa, respectively. Not surpris-
ingly, large ISPs are very powerful attackers, as indicated by
the attacker’s success rate, whereas stubs are quite weak at-
tackers. Observe, however, that path-end validation has the
same qualitative effect in both scenarios: the attacker is bet-
ter off, even with quite few adopters, bypassing path-end val-
idation and announcing a longer (2-hop) path.
Effectiveness of k-hop attacks. Figure 4 plots the success
rate of an attacker launching a “k-hop” path-manipulation
attack when no defense is deployed, i.e., the attacker an-
nounces a bogus k-hop path to the victim, for different val-
ues of k (attacker and victim pairs picked uniformly at ran-
dom). The x-axis speciﬁes the number of hops k and the
y-axis speciﬁes the average success rate of a randomly se-
lected attacker launching a k-hop attack on a randomly se-
lected victim. We also show, as reference, the success rate of
the attacker when BGPsec is fully deployed but legacy BGP
advertisements are allowed [33] (line 2).
We view this ﬁgure as capturing the key idea behind path-
end validation. When k = 0, the attacker is simply launching
00.20.40.60.810102030405060708090100Attacker’s Success RateDeployment (top ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. BGPsec (full deployment, legacy allowed)5. RPKI (full Deployment)00.10.20.30.40.50102030405060708090100Attacker’s Success RateDeployment (top ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. BGPsec (full deployment, legacy allowed)5. RPKI (full Deployment)00.10.20.30.40.50.6012345678910Attacker’s Success RateHops1. k-hop attacker2. BGPsec (full deployment, legacy allowed)(a) Internal attackers
(b) External attackers
Figure 5: Protection for North-American ASes by local adopters
(a) Internal attackers
(b) External attackers
Figure 6: Protection for European ASes by local adopters
a preﬁx hijack (i.e., announcing itself to be the destination of
the preﬁx). Observe, that this is much more effective than
the 1-hop attack, i.e., the next-AS attack. Indeed, this attack
(and subpreﬁx hijacking) is precisely what RPKI is meant
to prevent. Observe also that while the 1-hop attack, i.e.,
the next-AS attack, is signiﬁcantly more beneﬁcial to the at-
tacker than the 2-hop attack, the 2-hop attack does not fare
signiﬁcantly better than the 3-hop attack. We conclude that
path-end validation indeed gets the most “bang for the buck”
in terms of security against path-manipulation attacks, strik-
ing the right balance between deployability and efﬁciency.
4.3 Geography-Based Deployment
One possible strategy for boosting initial deployment of
path validation mechanisms is for governments to incentivize
large ISPs in their countries to adopt (i.e., install the cor-
responding ﬁltering rules in their routers). We investigate
whether such local adoption can protect local communica-
tion, i.e., protect the ASes in that geographical region, and
compare between path-end validation and BGPsec as poten-
tial mechanisms to perform path validation. This is impor-
tant, for instance, since many end-users retrieve content from
servers in their geographic region due to the popularity of
content delivery networks, and communicate with local ser-
vices (banking, healthcare etc.), and also to ensure the avail-
ability of critical national infrastructures.
We used the Regional Internet Registries (RIRs) division
of the world into ﬁve geographic regions and considered adop-
tion only by ISPs in a particular region. We then measured
348
how many benign ASes in the region are fooled to take a ma-
licious route to a victim in the region advertised by attackers
(internal and external to the region).
Figure 5 shows the fraction of North-American ASes that
an attacker can attract when trying to capture trafﬁc to a
North-American AS. We ﬁnd that with only 10 adopters,
path-end validation protects the communication between two
ASes in North America, even if the attacker is co-located
in North America (Figure 5a), reducing the attacker’s suc-
cess rate to just above 13% with his best strategy (2-hop at-
tack). The corresponding results for Europe, presented in
Figure 6, show that the top 20 European ISPs need to adopt
the protocol to achieve a similar effect. We also ﬁnd that
RPKI provides relatively a high level of security for Euro-
pean ASes against external attackers (see Figure 6b), yet
Europe still beneﬁts from deployment of path-end valida-
tion, which gradually decreases the attacker’s success rate
until eventually when the top 100 ISPs adopt the defense the
attacker’s best strategy becomes the 2-hop attack, yielding
11.2% success rate. These results provide signiﬁcant moti-
vation for adoption, considering recent attacks on ASes from
Iceland and Belarus [2], and the emphasis on routing secu-
rity of the European Union. We also contrast them with the
results for BGPsec under the same partial deployment which
provides only marginal beneﬁts over RPKI, line 2 in both
ﬁgures.
Intuitively, these positive results are not at all surprising
since much of path-end validation’s success can be attributed
to the shortness of BGP routes, and routes within a particular
00.10.20.30.40.5020406080100Attacker’s Success RateDeployment (top north American ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)00.10.20.30.40.5020406080100Attacker’s Success RateDeployment (top north American ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)00.10.20.30.40.5020406080100Attacker’s Success RateDeployment (top European ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)00.10.20.30.40.5020406080100Attacker’s Success RateDeployment (top European ISPs)1. Next-AS2. BGPsec in partial deployment3. 2-hop4. RPKI (full Deployment)5. BGPsec (full deployment, legacy allowed)(a) Path-end validation
(b) BGPsec
(c) Best strategy against path-end validation
Figure 7: High proﬁle past incidents: attacker’s success rate
as function of the number of adopters.
region are expected to be shorter on average (in our AS-level
graph [8] simulations, routes within North-America and Eu-
rope regions are, on average, 3.2 and 3.6 hops long, respec-
tively, while routes on the global Internet are about 4-hops
long on average [35]). Also, trafﬁc within country-/region-
level geographies is likely to traverse fewer large and central
ISPs, and so adoption of path-end validation by the region’s
largest ISPs can yield signiﬁcant beneﬁts.
4.4 Revisiting High-Proﬁle Past Incidents
Our results in Section 4.2 quantify the average success
rate of random attackers and victims. What about speciﬁc
attacker-victim cases?
We revisit four fairly recent high-proﬁle preﬁx-hijack in-
cidents to illustrate the immediate security beneﬁts of de-
ploying path-end validation with RPKI: (1) Syria-Telecom
hijacks YouTube [9] on December 9th, 2014 (2) Indosat hi-
jacks over 400,000 preﬁxes on April 3rd, 2014 [1]; (3) Turk-
Telecom hijacks DNS resolvers in Google, OpenDNS and
Level3 on March 29, 2014 [5]; and (4) Opin Kerﬁ’s (an ISP
in Iceland) repeated preﬁx-hijacks [2] in December 2013.
Some of these incidents are attributed to benign conﬁgu-
ration errors while others are suspected attacks. Because
this section considers the scenario that RPKI is fully de-
ployed, such preﬁx-hijacks can be detected and mitigated.
We thus consider the next-AS attack, which is not prevented
by RPKI, with respect to the same attacker-victim pairs.
Clearly, no simulation framework is rich enough to cap-
ture all intricacies of interdomain routing (e.g., ASes’ ac-
tual routing policies). Our aim is therefore not to predict
the routing outcome, but to get a high-level idea of path-end
validation’s potential inﬂuence in these concrete scenarios.
We computed, for every attacker-victim pair, a next-AS at-
tacker’s success rate with X adopters from the largest ISPs,
where X = 0, 5, . . . , 100. Figure 7 describes the attacker’s
success rate for path-end validation and for BGPsec in par-
tial deployment. Observe that even with a modest number of
path-end validation adopters, the attacker’s best strategy is to
launch the 2-hop attack and avoid detection by the path-end
validation mechanism (see Figure 7a). In contrast, BGPsec
exhibits far inferior security beneﬁts (see Figure 7b).
Figure 7c plots the attacker’s success rate in each deploy-
ment scenario (X = 0, 5 . . . , 100 adopters) for his best at-
tack strategy among the two (next-AS and 2-hop) against
the path-end validation defense. Consider, for example, the
Turk-Telecom case. Before any AS adopts path-end val-
idation, the attacker’s best strategy is the next-AS attack,
resulting in a success rate of almost 25%, i.e., attracting
nearly a quarter of the Internet. As more and more large
ISPs adopt the path-end validation defense, the success of
the next-AS attack is signiﬁcantly decreased. Indeed, even
with 15 adopters, the attacker is better off switching to the
2-hop attack to bypass the path-end validation mechanism,
and so the attacker’s success rate remains ﬁxed at about 5%
henceforth.
4.5 Robustness Tests
Our evaluation thus far considered deployment by a small
set of the very top ISPs. We now turn to evaluate the secu-
rity beneﬁts where path-end validation or BGPsec are only
adopted by some of the top ISPs. The results in Figure 8
compare path-end validation to BGPsec under probabilistic
deployment scenarios. The x-axis describes 11 deployment
scenarios, where for each value x the corresponding deploy-
ment scenario is as follows: We consider, for a speciﬁed
probability p (p = 0.25, 0.5, 0.75) the set of x
p top ISPs. We
then select each of these ISPs as an adopter with probabil-
ity p. Hence, in deployment scenario x, the expected number
p · p = x. The measurement for each deploy-
of adopters is x
ment scenario is repeated 20 times and Figure 8 plots the
averaged results.
We observe that as path-end validation beneﬁts from the
adoption of the top ISPs on the Internet, the attacker’s suc-
cess rate naturally grows as the probability for adoption re-
duces. However, even in this probabilistic deployment sce-
nario path-end validation yields good results, signiﬁcantly
outperforming BGPsec. For example, for adoption rate of
50%, path-end validation still provides signiﬁcant beneﬁts
349
00.050.10.150.20.250.30.350.40.45020406080100Attacker’s Next-AS AttackSuccess RateDeployment (top ISPs)1. Syria Telecom attacks YouTube2. Indosat attacks various ASes3. Turk-Telecom attacks DNS servers4. Opin Kerfi attacks CenturyTel0.050.10.150.20.250.30.350.40.45020406080100Attacker’s Next-AS AttackSuccess RateDeployment (top ISPs)1. Syria Telecom attacks YouTube2. Indosat attacks various ASes3. Turk-Telecom attacks DNS servers4. Opin Kerfi attacks CenturyTel00.050.10.150.20.250.30.350.40.45020406080100Attacker’s Next-AS AttackSuccess RateDeployment (top ISPs)1. Syria Telecom attacks YouTube2. Indosat attacks various ASes3. Turk-Telecom attacks DNS servers4. Opin Kerfi attacks CenturyTel(a) 75% adoption rate
(b) 50% adoption rate
(c) 25% adoption rate
Figure 8: Security beneﬁts under probabilistic adoption by
the top ISPs
and the attacker is better off switching to the 2-hop attack
with only 60 adopters. BGPsec under a similar scenario pro-
vides only marginal 0.2% improvement over RPKI.
This difference between the two defenses against path-
manipulation attacks under probabilistic adoption is particu-
larly important when considering the difference in effort re-
quired for deployment (see discussion in Section 2): while
path-end validation was designed to be very easy to deploy
and only introduces changes the BGP router’s conﬁguration,
BGPsec requires new hardware and is therefore expected to
have a long period until it is extensively deployed [21].
5. RPKI IN PARTIAL DEPLOYMENT
RPKI deployment is still far from ubiquitous. Indeed, only
about 6% of IP preﬁxes advertised in BGP are in the RPKI
repository [37]. Understanding the root causes for RPKI’s
slow adoption is beyond the scope of this work and is an
important direction for future research. Our focus in this
section is on showing that path end validation can provide
beneﬁts without waiting for extensive deployment of RPKI.
We use the simulation framework presented in Section 4 to
evaluate interdomain routing security when adopters deploy
RPKI with path-end validation, but all other ASes deploy
neither mechanism.
Preﬁx hijacks. Since in this section we consider the case
where RPKI is very partially deployed, attackers may per-
form preﬁx hijacks, i.e., advertise the same preﬁx as the vic-
tim AS, with the plausible excuse of benign misconﬁguration
error (when detected) [7]. Although hijacking attacks are
blocked by RPKI adopters, they can be very effective when
RPKI is insufﬁciently deployed.
Security evaluation. In Figure 9 we plot the attacker’s suc-
cess rates when launching a preﬁx hijack, which is ﬁltered by
adopters. (We already quantiﬁed path-end validation’s effec-
tiveness against next-AS attacks in Section 4.) The dashed
reference line describes next-AS attacker’s success when RPKI
is fully deployed, but with no path-end validation deploy-
ment. Figure 9a plots the average attacker’s success rate
for uniformly chosen attacker and victim pairs. We ﬁnd
that when 20 large ISPs adopt RPKI, the attacker is better
off launching a next-hop attack than a preﬁx hijack so as
to circumvent RPKI. This is precisely where the beneﬁts of
path-end validation start to kick in. We conclude that even
in early stages of RPKI adoption, path-end validation can
already provide tangible security beneﬁts over RPKI. This
should be contrasted with deployment of BGPsec, which re-
lies on extensive deployment of RPKI [33]. Similar measure-
ments focusing only on the security beneﬁts for large content
providers, described in Figure 9b, show the same trends.
6. HANDLING OTHER ATTACKS
Path-end validation focuses on authentication of the 1-AS-
hop sufﬁx of a BGP advertisement so as to protect against
next-AS attacks. We next describe two simple extensions to
RPKI, designed to defend against other path-manipulation