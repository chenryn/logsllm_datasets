For example, if there are 5 million logs in one table of a database file generated in the last 10 hours,
and if you want to take a report, you should spend more than half an hour. From Junos OS Release
19.3R1, one table is separated into multiple tables, and each table has 0.5 million of logs. To generate
the same report, one table information is sufficient.
We recommend you to query with a shorter time for better performance.
• Database table definition—For session logs, the data types are source-address, destination-
address, application, user, and so on. For logs related to security features, the data types are
attack-name, URL, profile protocol, and so on. Therefore, different tables are designed to store
different types of logs to help improve the performance and save disk space. SRX Series Firewall
creates a database table for each log type, when log data is recorded.
Each type of database table has its maximum record number that is device specific. When the
table record number reaches the limitation, new logs replace the oldest logs. Junos OS stores log
in an SRX Series Firewall in which active traffic is passed.
Starting in Junos OS Release 19.3R1, you can create multiple tables in a database file to store
logs. You can define the capacity to store logs in a table.
If the limit of log number exceeds the table capacity, Junos OS stores the logs in the second table.
For example, if the limit of logs in table 1 exceeds the table capacity, Junos OS stores logs in table
2.
If the limit of the log number exceeds the last table of file 1, Junos OS stores the logs in table 1 of
file 2. For example, table n is the last table of file 1. When the logs exceed the table capacity,
Junos OS stores the logs in table 1 of file 2.
To make immediate effect after you change the table number, use clear security log report
operational command.
• Database table rotation—Each type of database table has its maximum record number that is
device specific. When the table record number reaches the limitation, new logs replace the oldest
logs.
Following Table 146 on page 1340 describes the database file size capacity:
1340
Table 146: Database File Size Capacity
Devices Session Screen IDP Content Security IPsec-VPN SKY
SRX300, SRX320, SRX340, 1.8G 0.18G 0.18G 0.18G 0.06G 0.18G
SRX345, and SRX550M
SRX1500 12G 2.25G 2.25G 2.25G 0.75G 2.25G
SRX4100 and SRX4200 15G 2.25G 2.25G 2.25G 0.75G 2.25G
SRX4600 22.5G 6G 6G 6G 0.75G 2.25G
vSRX Virtual Firewall 1.8G 0.18G 0.18G 0.18G 0.06G 0.18G
• Calculating and displaying the reports that are triggered by CLI—The reports from the database are
received from the CLI as the interface. Using the CLI, you can calculate and display the reporting
details.
Table Selection
When you want to generate a report from multiple tables, llmd sorts tables based on timestamp and
selects tables as per the requested start-time and stop-time.
For example, there are three tables that is table 1 (1 to 3), table 2 (3 to 5) and table 3 (6 to 8). 1 to 3, 3 to
6, and 6 to 8 denotes time stamp of latest and oldest logs. If you request a report from 4 to 6, Junos OS
generates report from table 2 and table 3.
Table Lifetime
You can decide table lifetime by configuring set security log report table-lifetime command. Junos OS
removes the table after the table identify time exceeds the table lifetime. For example, if you configure
table lifetime as 2, and the current date is 26-July-2019, then it means on 24-July-2019 00:00:00 logs
are removed.
If you change the date and time manually on a device, the table lifetime changes. For example, if a table
identify time is 19-July-2019, and you configure table lifetime as 10, Junos OS should remove the table
on 29-July-2019. If you change the device date as 18-July-2019, then the table real lifetime becomes
30-July-2019.
1341
Table Dense Mode
In Junos OS Release 19.4R1, we've upgraded the default storage and search mechanism in the on-box
logging database to manage logs. You can now customize log storage and search mechanism results. For
example, if you expect fewer traffic logs, you can use the default configuration with a start time and a
stop time.
However, if you expect a large number of traffic logs and greater time intervals for which the logs will be
generated, then enable dense mode. To enable dense mode, use the set security log report table-mode
dense configuration command.
Chassis Cluster Scenario
For on-box reporting in a chassis cluster, the logs are stored in the local disk on which the device is
processing active traffic. These logs are not synchronized to the chassis cluster peer.
Each node is responsible to store logs when each node is processing active traffic. In case of active/
passive mode, only the active node processes the traffic and logs are also stored only in the active node.
In case of failover, the new active node is processes the traffic and stores logs in its local disk. In case of
active/active mode, each node processes its own traffic and logs are stored in the respective nodes.
SEE ALSO
report
Monitor Reports
IN THIS SECTION
Threats Monitoring Report | 1342
Traffic Monitoring Report | 1350
On-box reporting offers a comprehensive reporting facility where your security management team can
spot a security event when it occurs, immediately access and review pertinent details about the event,
and quickly decide appropriate remedial action. The J-Web reporting feature provides one- or two-page
reports that are equivalent to a compilation of numerous log entries.
1342
This section contains the following topics:
Threats Monitoring Report
IN THIS SECTION
Purpose | 1342
Action | 1342
Purpose
Use the Threats Report to monitor general statistics and activity reports of current threats to the
network. You can analyze logging data for threat type, source and destination details, and threat
frequency information. The report calculates, displays, and refreshes the statistics, providing graphic
presentations of the current state of the network.
Action
To view the Threats Report:
1. Click Threats Report in the bottom right of the Dashboard, or select Monitor>Reports>Threats in the
J-Web user interface. The Threats Report appears.
2. Select one of the following tabs:
• Statistics tab. See Table 4 for a description of the page content.
• Activities tab. See Table 5 for a description of the page content.
Table 147: Statistics Tab Output in the Threats Report
Field Description
General Statistics Pane
1343
Table 147: Statistics Tab Output in the Threats Report (Continued)
Field Description
Threat Category One of the following categories of threats:
• Traffic
• IDP
• Content Security
• Antivirus
• Antispam
• Web Filter—Click the Web filter category to display counters for 39
subcategories.
• Content Filter
• Firewall Event
• DNS
Severity Severity level of the threat:
• emerg
• alert
• crit
• err
• warning
• notice
• info
• debug
Hits in past 24 hours Number of threats encountered per category in the past 24 hours.
Hits in current hour Number of threats encountered per category in the last hour.
1344
Table 147: Statistics Tab Output in the Threats Report (Continued)
Field Description
Threat Counts in the Past 24 Hours
By Severity Graph representing the number of threats received each hour for the past 24
hours sorted by severity level.
By Category Graph representing the number of threats received each hour for the past 24
hours sorted by category.
X Axis Twenty-four hour span with the current hour occupying the right-most column of
the display. The graph shifts to the left every hour.
Y Axis Number of threats encountered. The axis automatically scales based on the
number of threats encountered.
Most Recent Threats
Threat Name Names of the most recent threats. Depending on the threat category, you can
click the threat name to go to a scan engine site for a threat description.
Category Category of each threat:
• Traffic
• IDP
• Content Security
• Antivirus
• Antispam
• Web Filter
• Content Filter
• Firewall Event
• DNS
1345
Table 147: Statistics Tab Output in the Threats Report (Continued)
Field Description
Source IP/Port Source IP address (and port number, if applicable) of the threat.
Destination IP/Port Destination IP address (and port number, if applicable) of the threat.
Protocol Protocol name of the threat.
Description Threat identification based on the category type:
• Antivirus—URL
• Web filter—category
• Content filter—reason
• Antispam—sender e-mail
Action Action taken in response to the threat.
Hit Time Time the threat occurred.
Threat Trend in past 24 hours
1346
Table 147: Statistics Tab Output in the Threats Report (Continued)
Field Description
Category Pie chart graphic representing comparative threat counts by category:
• Traffic
• IDP
• Content Security
• Antivirus
• Antispam
• Web Filter
• Content Filter
• Firewall Event
• DNS
Web Filter Counters Summary
Category Web filter count broken down by up to 39 subcategories. Clicking on the Web
filter listing in the General Statistics pane opens the Web Filter Counters
Summary pane.
Hits in past 24 hours Number of threats per subcategory in the last 24 hours.
Hits in current hour Number of threats per subcategory in the last hour.
Table 148: Activities Tab Output in the Threats Report
Field Function
Most Recent Virus Hits
Threat Name Name of the virus threat. Viruses can be based on services, like Web, FTP, or e-
mail, or based on severity level.
1347
Table 148: Activities Tab Output in the Threats Report (Continued)
Field Function
Severity Severity level of each threat:
• emerg
• alert
• crit
• err
• warning
• notice
• info
• debug
Source IP/Port IP address (and port number, if applicable) of the source of the threat.
Destination IP/Port IP address (and port number, if applicable) of the destination of the threat.
Protocol Protocol name of the threat.
Description Threat identification based on the category type:
• Antivirus—URL
• Web filter—category
• Content filter—reason
• Antispam—sender e-mail
Action Action taken in response to the threat.
Last Hit Time Last time the threat occurred.
1348
Table 148: Activities Tab Output in the Threats Report (Continued)
Field Function
Most Recent Spam E-Mail Senders
From e-mail E-mail address that was the source of the spam.
Severity Severity level of the threat:
• emerg
• alert
• crit
• err
• warning
• notice
• info
• debug
Source IP IP address of the source of the threat.
Action Action taken in response to the threat.
Last Send Time Last time that the spam e-mail was sent.
Recently Blocked URL Requests
URL URL request that was blocked.
Source IP/Port IP address (and port number, if applicable) of the source.
Destination IP/Port IP address (and port number, if applicable) of the destination.
1349
Table 148: Activities Tab Output in the Threats Report (Continued)
Field Function
Hits in current hour Number of threats encountered in the last hour.
Most Recent IDP Attacks
Attack
Severity Severity of each threat:
• emerg
• alert
• crit
• err
• warning
• notice
• info
• debug
Source IP/Port IP address (and port number, if applicable) of the source.
Destination IP/Port IP address (and port number, if applicable) of the destination.
Protocol Protocol name of the threat.
Action Action taken in response to the threat.
Last Send Time Last time the IDP threat was sent.
1350
Traffic Monitoring Report
IN THIS SECTION
Purpose | 1350
Action | 1350
Purpose
Monitor network traffic by reviewing reports of flow sessions over the past 24 hours. You can analyze
logging data for connection statistics and session usage by a transport protocol.
Action
To view network traffic in the past 24 hours, select Monitor>Reports>Traffic in the J-Web user interface.
See Table 6 for a description of the report.
Table 149: Traffic Report Output
Field Description
Sessions in Past 24 Hours per Protocol
Protocol Name Name of the protocol. To see hourly activity by protocol, click the protocol name
and review the “Protocol activities chart” in the lower pane.
• TCP
• UDP
• ICMP
Total Session Total number of sessions for the protocol in the past 24 hours.
Bytes In (KB) Total number of incoming bytes in KB.
Bytes Out (KB) Total number of outgoing bytes in KB.
1351
Table 149: Traffic Report Output (Continued)
Field Description
Packets In Total number of incoming packets.
Packets Out Total number of outgoing packets.
Most Recently Closed Sessions
Source IP/Port Source IP address (and port number, if applicable) of the closed session.
Destination IP/Port Destination IP address (and port number, if applicable) of the closed session.
Protocol Protocol of the closed session.
• TCP
• UDP
• ICMP
Bytes In (KB) Total number of incoming bytes in KB.
Bytes Out (KB) Total number of outgoing bytes in KB.
Packets In Total number of incoming packets.
Packets Out Total number of outgoing packets.
Timestamp The time the session was closed.
Protocol Activities Chart
Bytes In/Out Graphic representation of traffic as incoming and outgoing bytes per hour. The
byte count is for the protocol selected in the Sessions in Past 24 Hours per
Protocol pane. Changing the selection causes this chart to refresh immediately.
1352
Table 149: Traffic Report Output (Continued)
Field Description
Packets In/Out Graphic representation of traffic as incoming and outgoing packets per hour. The
packet count is for the protocol selected in the Sessions in Past 24 Hours per
Protocol pane. Changing the selection causes this chart to refresh immediately.
Sessions Graphic representation of traffic as the number of sessions per hour. The session
count is for the protocol selected in the Sessions in Past 24 Hours per Protocol
pane. Changing the selection causes this chart to refresh immediately.
X Axis One hour per column for 24 hours.
Y Axis Byte, packet, or session count.
Protocol Session Chart
Sessions by Protocol Graphic representation of the traffic as the current session count per protocol.
The protocols displayed are TCP, UDP, and ICMP.
Configure On-Box Binary Security Log Files
SRX Series Firewalls use two types of logs—system logs and security logs—to record system events.
System logs record control plane events—for example, when an admin user logs in. Security logs, also
known as traffic logs, record data plane events regarding specific traffic handling. For example, Junos OS
generates a security log if a security policy denies certain traffic because of a policy violation. For more
about system logs, see "Junos OS System Log Overview" on page 1254. For more information about
security logs, see "Understanding System Logging for Security Devices" on page 1331.
You can collect and save both system and security logs in binary format either on-box (that is, stored
locally on the SRX Series Firewall) or off-box (streamed to a remote device). Using binary format ensures
that log files are efficiently stored, which in turn improves CPU utilization.
You can configure security files in binary format using the log statement at the [security] hierarchy level.
On-box logging is also known as event-mode logging. For stream-mode, off-box security logging, see
"Configuring Off-Box Binary Security Log Files" on page 1354. When you configure security logs in
1353
binary format for event-mode logging, you can optionally define the log filename, file path, and other
characteristics, as detailed in the following procedure:
1. Specify the logging mode and format for on-box logging.
[edit security]
user@host# set log mode event
user@host# set log format binary
NOTE: If you configure system logging to send system logs to an external destination (that is,
off-box or stream-mode), security logs are also sent to that destination even if you are using
event-mode security logging. For more information about sending system logs to an external
destination, see "Examples: Configuring System Logging" on page 1286.
NOTE: Off-box and on-box security logging modes cannot be enabled simultaneously.
2. (Optional) Define a name and path for the log file.
NOTE: Security log filename is not mandatory. If security log filename is not configured, by
default the bin_messages file is created in the /var/log directory.
[edit security]
user@host# set log file name security-binary-log
user@host# set log file path security/log-folder
3. (Optional) Change the maximum size of the log file and the maximum number of log files that can be
archived.
NOTE: By default, the maximum size of the log file is 3 MB, and a total of three log files can
be archived.
1354
In the following sample commands, you set a value of 5 MB and 5 archived files, respectively:
[edit security]
user@host# set log file size 5
user@host# set log file files 5
4. (Optional) Configure the hpl flag to enable diagnostic traces for the binary security log files. The
smf_hpl prefix identifies all binary logging traces.
[edit security]
user@host# set log traceoptions flag hpl
5. For the default-permit security policy, traffic logs for RT_FLOW are generated when a session ends.
[edit security]
user@host# set policies from-zone trust to-zone untrust policy default-permit then log
session-close
6. (Optional) Traffic logs for RT_FlOW are generated when a session starts.
[edit security]
user@host# set policies from-zone trust to-zone untrust policy default-permit then log
session-init
View the content of the event-mode log file stored on the device using show security log file command
and use clear security log file command to clear the content of the binary event-mode security log file.
NOTE: The show security log command displays event-mode security log messages if they are in a
text-based format and the show security log file command displays event-mode security log
messages if they are in binary format (on-box). Off-box binary logging is read by Juniper Secure