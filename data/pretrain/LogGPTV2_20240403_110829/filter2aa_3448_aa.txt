© 2021 TXOne Networks Inc.
Taking Apart and Taking Over ICS-SCADA Ecosystems
A Case Study of Mitsubishi Electric
Mars Cheng
Selmon Yang
August, 2021
@DEF CON 29
© 2021 TXOne Networks Inc.
Who are we?
A subsidiary company under
Keep the Operation Running
Threat 
Defense 
Expertise
Industry 
Adaptive 
Solution
OT-Focused 
Technology
Trend Micro Inc
© 2021 TXOne Networks Inc.
x
Who are we?
x
Mars Cheng
•
Spoke at Black Hat, HITB, HITCON, SecTor, ICS
Cyber Security Conference, InfoSec Taiwan and etc.
•
Instructor of Ministry of National Defense, Ministry 
of Education, Ministry of Economic Affairs and etc.
•
General Coordinator of HITCON 2021
•
Vice General Coordinator of HITCON 2020
Threat Researcher at TXOne Networks
Selmon Yang
Staff Engineer at TXOne Networks
•
IT/SCADA Protocol Parsing
•
Linux Kernel Programming
•
Honeypot Deployment & Optimization
•
In-depth ICS research specialist
•
Has spoken at CYBERSEC, HITB, and HITCON
© 2021 TXOne Networks Inc.
Outline
• Modern ICS/SCADA Ecosystems Overview
• Dissect and Compromise Mitsubishi Ecosystems
• A Story of Reporting the Vulnerability
• Mitigation and Closing Remarks
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
• Market Share
• Mitsubishi Electric 
•
Largest in Asia Pacific 
•
Top 3 in Global Market 
https://ipcsautomation.com/blog-post/market-share-of-different-plcs/
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
• PLC Manufacturers Ranked in Order of Industrial Automation 
Net Annual Sales Revenue
Rank
PLC Manufacturers
Industrial 
Automation Revenue
(millions of USD)
Consolidated Revenue
(millions of USD)
1
Siemens (Simatic)
$18,281
$98,636
2
Mitsubishi Electric (Melsec)
$13,346
$41,120
3
Emerson (GE Fanuc)
$12,202
$18,372
4
Hitachi
$8,654
$86,250
5
Bosch (Rexroth)
$8,523
$88,319
6
Schneider Electric (Modicon)
$7,172
$30,861
7
Eaton (Cutler-Hammer)
$7,148
$21,390
8
Rockwell Automation (Allen Bradley)
$6,694
$6,694
9
ABB (B&R Automation)
$6,273
$27,978
10
Keyence
$5,341
$5,341
https://ladderlogicworld.com/plc-manufacturers/
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
• Most Popular PLCs – Top 3 Mitsubishi Electric
Market Share Ranking
PLC Manufacturers
PLC Brand Name/s
1
Siemens
Simatic
2
Rockwell Automation
Allen Bradley
3
Mitsubishi Electric
Melsec
4
Schneider Electric
Modicon
5
Omron
Sysmac
6
Emerson Electric (GE)
RX3i & VersaMax (GE Fanuc)
7
Keyence
KV & V-8000
8
ABB (B&R Automation)
AC500 X20 & X90
9
Bosch
Rexroth ICL
10
Hitachi
EH & H
https://ladderlogicworld.com/plc-manufacturers/
© 2021 TXOne Networks Inc.
Mitsubishi Ecosystem - Scope
MELSEC iQ-R
MELSEC Q
MELSEC L
MELSEC iQ-F
MELSEC-F
iQ-R
Q
iQ-F
L
F
System Size
Optimum Automation 
Control Area
https://www.mitsubishielectric.com/fa/products/cnt/plc/pmerit/index.html
© 2021 TXOne Networks Inc.
Mitsubishi PLCs Application
https://www.mitsubishielectric.com/fa/products/cnt/plc/pmerit/case.html
Automotive
iQ-R
Q
Food and Beverage, CPG 
iQ-R
F
Q
L
iQ-F
Automated Warehouse 
iQ-R
F
Q
iQ-F
Semiconductor
iQ-R
Q
© 2021 TXOne Networks Inc.
Mitsubishi PLCs Application (Cont.)
https://www.mitsubishielectric.com/fa/products/cnt/plc/pmerit/case.html
General Automation 
iQ-R
Q
iQ-F
Flat Panel Display(FPD) 
iQ-R
Q
Chemical
iQ-R
Q
Inspection Machine
iQ-R
L
F
© 2021 TXOne Networks Inc.
Mitsubishi PLCs Application (Cont.)
https://www.mitsubishielectric.com/fa/products/cnt/plc/pmerit/case.html
Building Automation
iQ-R
Printing
iQ-R
Q
Injection Molding
iQ-R
F
Q
iQ-F
Machine Tool
iQ-R
Q
L
iQ-F
F
Q
iQ-F
L
F
© 2021 TXOne Networks Inc.
Related Work
• Most ICS research focuses on Siemens-related topics:
•
[BH Europe 2019] Doors of Durin: The Veiled Gate to Siemens S7 
Silicon
•
[BH USA 2019] Rogue7: Rogue Engineering Station Attacks on Simatic 
S7 PLCs
•
[BH Europe 2017] The spear to break the security wall of S7CommPlus
•
[BH USA/Asia 2016] PLC-blaster: A worm living solely in the PLC
•
[BH USA 2011 ] Exploiting Siemens Simatic S7 PLCs
© 2021 TXOne Networks Inc.
Relate Work
• Other common topics include 
•
[BU USA 2021] A Broken Chain: Discovering OPC UA Attack Surface 
and Exploiting the Supply Chain
•
TRITON, Industroyer, protocols used in building management
•
Attack vectors in different industries including chemical and power 
plants
•
Security research into ICS-related devices …
• Even though the Mitsubishi ecosystem plays a pivotal role, 
we have yet to see any powerful research that gives it focus
© 2021 TXOne Networks Inc.
Reviewed 
Mitsubishi
Vulnerabilities 
CVE
Advisories_Number
Advisories_Name
CVE-2021-20591
ICSA-21-147-05
Mitsubishi Electric MELSEC iQ-R Series
CVE-2021-20590
ICSA-21-112-02
Mitsubishi Electric GOT
CVE-2021-20589
ICSA-21-131-02
Mitsubishi Electric GOT and Tension Controller
CVE-2021-20588
ICSA-21-049-02
Mitsubishi Electric FA engineering software products (Update A)
CVE-2021-20587
ICSA-21-049-02
Mitsubishi Electric FA engineering software products (Update A)
CVE-2021-20586
ICSA-21-021-04
Mitsubishi Electric MELFA (Update A)
CVE-2020-5675
ICSA-20-343-02
Mitsubishi Electric GOT and Tension Controller (Update A)
CVE-2020-5668
ICSA-20-324-05
Mitsubishi Electric MELSEC iQ-R Series (Update A)
CVE-2020-5666
ICSA-20-317-01
Mitsubishi Electric MELSEC iQ-R Series
CVE-2020-5665
ICSA-20-345-01
Mitsubishi Electric MELSEC iQ-F Series
CVE-2020-5658
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5657
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5656
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5655
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5654
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5653
ICSA-20-303-02
Mitsubishi Electric MELSEC iQ-R
CVE-2020-5652
ICSA-20-303-01
Mitsubishi Electric MELSEC iQ-R, Q and L Series (Update A)
CVE-2020-5649
ICSA-20-310-02
Mitsubishi Electric GT14 Model of GOT1000 Series
CVE-2020-5648
ICSA-20-310-02
Mitsubishi Electric GT14 Model of GOT1000 Series
CVE-2020-5647
ICSA-20-310-02
Mitsubishi Electric GT14 Model of GOT1000 Series
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
HMI
EWS
Historian
PLC
Field Devices
Modbus/TCP
Modbus/TCP
Modbus/RTU
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
HMI
EWS
Historian
PLC
Field Devices
Siemens S7/S7+
Siemens S7/S7+
PROFINET
© 2021 TXOne Networks Inc.
Modern ICS/SCADA Ecosystems Overview
HMI
EWS
Historian
PLC
Field Devices
MELSEC-SLMP
Modbus/TCP
EtherNet/IP
…
MELSOFT
CC-Link
© 2021 TXOne Networks Inc.
Dissect and Compromise Mitsubishi Ecosystems
© 2021 TXOne Networks Inc.
How to Compromise Mitsubishi Ecosystems 
HMI
EWS
Historian
PLC
Field Devices
MELSEC-SLMP
Modbus/TCP
EhterNet/IP
…
MELSOFT
CC-Link
MELSOFT
Attacker
© 2021 TXOne Networks Inc.
Melsoft Authentication 