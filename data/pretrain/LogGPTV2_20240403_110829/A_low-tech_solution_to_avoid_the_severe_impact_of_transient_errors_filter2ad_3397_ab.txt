•minimalareaoverheadWeexplorewhatcanbedoneundertheseconstraintsandaimforalow-techsolutiontodetecttheserareeventsbe-causelowoverheadswilldecreasethefrictionforadoptionandahighlycomplexschememayactuallymakethedevicemoreunreliable.Webelievethattheautomotiveandnetworking,specif-icallystoragenetworking,willbemostlikelyinterestedinthisworkastheybothcareaboutdependability,butindif-ferentways:safetyandavailability,respectively.Thisaf-fectstheirrequirementswhereautomotivearesensitivetolatencybutlesssotoperformanceandareaandasexem-pliﬁedinISO26262,theautomotiveversionofIEC61508[6]indevelopment,errordetectionissatisfactory.Fornet-working,performanceiscriticalandcanhaveextraregisterstagestokeepthroughputhigh,butarelikelytorequireer-rorcorrection.3AXIOverviewTheAXIbusprotocol[3]isburstbasedandhasﬁvein-dependentunidirectionalchannels–threeforwritingandtwoforreading–thatcarrytheaddress/controlanddataphases.Everytransactionhasaddressandcontrolinforma-tionontheaddresschannel(AWforthewritechannelandARforthereadchannel)thatdescribesthenatureofthedatatobetransferred.Thedataistransferredbetweenmas-terandslaveusingawritedatachannel(W)totheslaveorareaddatachannel(R)tothemaster.Inwritetransactions,inwhichallthedataﬂowsfromthemastertotheslave,theAXIprotocolhasanadditionalwriteresponsechannel(B)toallowtheslavetosignaltothemasterthecompletionofthewritetransactionoranerror.Aburstismadeupofanumberoftransfers,whichisaunitofdatawhosewidthisspeciﬁedontheAWorARchannel.SeeTable1forade-scriptionofsignalsoneachchannel.Thesignalshavebeengroupedintotypesastheymayfeatureonmorethanonechannel,e.g.thesignaltypeispreﬁxedwiththechannelabbreviationsoIDfeaturesonallchannels:AWID,ARID,WID,BID,andRID.Thosesignalstypeswitha*sufﬁxarereferredtoasthe“controlsignals”.AXIusesatwowirehandshake,usingtheVALIDandREADYsignals,toexchangeinformationbetweenthesenderandreceiver.VALIDisusedtoshowwhenvaliddataorcontrolinformationisavailableandthedestinationusestheREADYsignaltoshowwhenitcanacceptthedata.BoththereaddatachannelandthewritedatachannelalsoincludeaLASTsignaltoindicatewhenthetransferoftheﬁnaldataitemwithinatransactiontakesplace.Thestandardalsofeaturesasidebandsignal,USER,upto32bitsoneachchannelthatallowstheSoCdesignertoextendtheprotocoltocarryimplementationspeciﬁcinfor-mation.4ImpactofErrorsontheAXIBusMatrixWecanclassifytheimpactofanerroroneachAXIsig-nalintothosethatcausedeadlock(DL),memorycorruption(MC),andundeﬁnedbehaviour(UB)(sofailuremayresultdependingontheapplication).Memorycorruptioncouldcausefailurelaterintime,ifthedataisusedatsomepointorifitincorrectlycontrolsanactuator.ThiswastestedbyinjectingfaultsattheRTLandobservingtheconsequences.Linetal.[7]performfaultinjectionontheAMBAAHBprotocol(targetedforlowerperformance)andsimilarlycat-egorisederrors.Theyalsoinventedaschemetopredicttheeffectofasinglebiterroronasignalforanyapplicationwithhighaccuracy.Table1showstheimpactforeachsignalandtwoexam-plesaregivenbelow.ThesecasesweretestedbyinjectingfaultsintotheRTLofthebusmatrix.4.1LENTheLENsignalspeciﬁesthenumberoftransfers(i.e.datachunks)withinaburst.Wehavetoconsidertheef-fectofanerrorchangingLENtoahighervalueoralowervalue.Intheformercase,itwillcausedeadlockbecausetheslaveexpectsmoretransfersthanthemasterwillsendsotheslaveblockswhichcausesthemastertoblockasitiswaitingonawriteresponseontheBchannel.Thispre-ventsanyothermasterfromaccessingthatslaveandthusblocksitself,whichcancausethewholebustodeadlock.Inthelattercase,theslaveusestheLASTsignaltodeter-minehowmanytransferstoconsumesoitstillreceivesthecorrectamount.However,theslaveusesLENtocalculatetheaddress(whichisonlysampledonceatthebeginingofatransaction)socancausememorycorruption.Inthetestsetup,wewrotetwo32-bittransferstoa64-bitwidemem-oryandchangedLENfromtwotoone,whichdidnotcor-ruptmemorybecauseofthesizeofthetransferandmemoryalignment.Thishighlightsthesubtlemaskingthatdependsonthepropertiesofthetransferandconﬁgurationofthebusmatrix.4.2VALIDTheVALIDsignalisonepartofthetwo-wayhandshake,whichinformsthereceiverthatdataisavailable.AnerroronVALIDcancausedeadlockifittransitionsfromhightolow.Forexample,iftheslavehasAWREADYhigh(i.e.theslaveisreadytoacceptinformationontheaddresswritechannel)andthemasterdrivesvaliddata,butanerrorcausestheslavetomissAWVALIDhighonthefollowingclockcyclethenthemasterthinkstherehasbeenahand-shakeandde-assertsAWVALIDsothattheslaveneverre-alisestherewasatransfer.Themasterblocksbecauseit978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
480
Table1.Source:M=Master,S=Slave.Impact:DL=Deadlock,MC=MemoryCorruption,UB=UndeﬁnedBehaviour.Thosesignalstypeswitha*sufﬁxarereferredtoasthecontrolsignals.AXISignalTypeOnChannelSourceDescriptionImpactID*AllM,STheidentiﬁcationtagforthemasterDLADDRAW,ARMThereadorwriteaddressAllLEN*AW,ARMThenumberoftransferswithinaburstDL,MCSIZE*AW,ARMThewidthofeachtransferintheburstMCBURST*AW,ARMSpeciﬁeshowtheaddressforeachtransferiscalcu-latedMCLOCK*AW,ARMAdditionalinformationabouttheatomiccharacter-isticsofthetransferDL,UBCACHE*AW,ARMAdditionalinformationaboutthecacheablecharac-teristicsofthetransferUB,MCPROT*AW,ARMProtectionunitinformationforthetransactionUB,MCVALID*AllM,SWhetherinformationisavailablefromthesenderAllREADY*AllM,SIndicatesthattherecipientisreadytoaccepttheinforma-tionDLDATAW,RM,STheactualreadorwritepay-loaddataMC,UBSTRB*WMWhichbytelanestoupdateinmemoryMCLAST*W,RM,SIndicatesthelasttransferwithinaburstAllRESPB,RSIndicatesthestatusofthewriteorreadtransactionUB978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
481
doesn’tgetawritecompletionresponse.IfanerrorcausesatransitiononVALIDfromlowtohighandtheslaveiswaitingonahandshakethenitwillsamplegarbagefromthebuswhichcouldcorruptmemoryorleadtoundeﬁnedbehaviour.5ProposalAddressingreliabilityissuescanbetackledusingredun-dancyinthreemainways:space,time,andinformationre-dundancy.Timeredundancyisdisregardedbecauseofthenoextralatencyandlowperformanceoverheadconstraints.Lookingforthesimplesttechniques,weﬁrstseehowspaceredundancycan’tbeusedandthenhowweconcludewithamixofinformationredundancythroughthreetechniques.Sinceweprimarilycareaboutdetection,inthesimplestcaseforspaceredundancywecan’tduplicatetheentirebusmatrixasthisobviouslydoublestheareaandwillincreasethechanceofanerroroccurringintheﬁrstplace.Ifacus-tomerbelievesthatonlythetrafﬁcbetweencertainmasterandslaveIPisimportant,thenwecansaveareabydupli-catingthosecommunicationsbyinstantiatinganotherma-trixconnectedtoonlythoseIP.However,thereisalimitonthesizeofthissmallerduplicatedbusmatrixrelativetotheoriginaltoensurethatareaoverheadrequirementsaremetand,moreimportantly,anerrorthatoccursbetweentheotherIP–whosetrafﬁcisnotduplicated–cancausethewholebusmatrixtodeadlock.Anotherapproachwouldbetoduplicateonlythecontrolsignalsonwhichanerrorcancausedeadlock,however,theareaincreaseistoomuch:usingthesidebandsignalsoftheAMBAstandardtocarrytheseduplicatedsignals–whichhasamaximumwidthof32bits–increasestheareaofarealisticallysizedbusma-trixwitheightmastersandsixslavesby42%,soit’snotscalable.Threetechniquesareproposed,1)forthecontrolsignals,2)addresssignals,and3)thedatapayloads.Thesedifferentapproachescomeaboutbecauseplacingtheparityencodersinlinereducesthemaximumfrequencytoofarforthewideaddress(32bits)anddata(upto1024bits)signals.Eventhoughthelikelihoodoffailureinsomeofthesecasesisrare,theseverityisstillhighandtheproposalisthatparityandECCcandetectthematalowcost.5.1ControlSchemeThesemeasurementsaremadeonbusmatrixwithtwomastersandtwoslaveswithbothmastersabletoaccessbothslaves.Thisisintentionallysmallbecauseiftheoverheadsareacceptableonthis,thentheywillbeacceptableonlargermatricessincethegrowthinareaduetothesizewilldomi-natethegrowthinareaneededforcoveringmorechannelswithparity.Figure1.Addresssplitintothenbitswhichspecifywhichregionandthembitswhichad-dresswithinaregionFigure2.ThememorymapfortwoslavessplitintosmallerregionsandthenremappedtobeseparatedbyaHammingdistanceoftwo1-bitinlineparityonthecontrolsignals(14ontheAWchannel)resultsinanegligibleareaoverheadandnofre-quencydrop.However,appliedonthe32-bitaddresssignalthereisdropinthemaximumsynthesisablefrequencyof60%,whichisclearlytoohigh.Iffourbitsofparityareusedthemaximumfrequencyhalveswitha25%increaseinareamainlyduetotheextrasidebandsignalsthatareneededtoaccommodatetheextrawiresneededforeachparitybit.5.2AddressSchemeAnerroneousvalueontheaddresssignalcancausethetransactiontoaddressadifferentlocationwithinthesameslaveorre-routeittoadifferentone,thuscausingmemorycorruptionandpossiblyfurthersevereconsequenceslater.Thisrequiresthattheerrorcodetodetectanerrormustbesentwiththeaddress.Sincetheoverheadsforprotectingtheentireaddresswidthwithinlineparityistoogreat,itisproposedthatonlyaportionoftheleastsigniﬁcantbitsareparityprotected(whichdeﬁnesthememoryregionsize-bits’m’inFigure1)andthememorymapisrearrangedsothatabiterrorinthemostsigniﬁcantbits(whichspeciﬁestheregion-bits’n’inFigure1)causesthetransactiontoberoutedtoanunmappedregion,whichaccordingtotheAXIprotocolwillcauseanerrorresponsetobereturnedtothe978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
482
master.AlthoughthislimitstheSoCtohalfoftheoriginalmemory,inrealautomotivesafetysystemsmorethanhalfisrarelyused.Thiswilllikelynotbethecaseinnetworkingsystems,butthentheextracycleoflatencyintroducedwitharegisterslicecanbetolerated,thereforethistechniqueisnotneeded.Thefollowingschemeisusedtodeterminewhichre-gionstouse.InFigure2wehavesplitthememorymapfortwoslavesintoeightregions,sothetopthreebitsoftheaddress,n,indexthem.Theremainingbits,m,areprotectedwithparity.OnlythoseregionindexesseparatedbyaHam-mingdistanceoftwoaremapped,whichmeansthata1-biterrorinanyofthetopthreebitswillcausethemastertoaddressanunmappedregion,whichwillautomaticallyin-duceanerrorresponsetothesender.ThistechniquecanbeexpandedtouseaHammingdistanceofthree,sothat1-biterrorsarecorrected,butatthecostofquarteringtheavail-ablememoryspace.Consequently,thisschemerequiresaminimalchangetothesoftwaretoaltertheheaderﬁletousethenewmemorymapandatworstare-compile,butnotanychangetothefunctionality.Theareaandfrequencyoverheadsareacceptableonrealisticallysizedbusmatri-ces.Thus,1-biterrorsontheaddresssignalcanbedetectedwithoutaddingextralatency,butatthecostofhalvingtheaddressablememoryandare-compileofthesoftware.5.3DataPayloadSchemeTheconstraintontheaddresswasthattheerrorhadtobedetectedbeforeitreacheditsdestination.Withthedatapay-loaditisproposedthatthisisrelaxedsothatthedataisal-lowedtopassthroughwithoutbeingcheckedimmediately.AnECCissentonthesidebandsignalsinthesubsequentcyclesothatitcancorrectthevalueiftherewasanerror,whichisthenre-written.ItissentonthefollowingcyclebecausetheECCtakessometimetodecodeandcheckandwedon’twanttointroducelatency.Insomecases,thepayloadwillbecheckedbythedes-tination,forexamplewhenitistransmittedacrossanex-ternaltransmissionlinetoanotherprocessor,howevertherearecaseswhereitwon’tbeasitisnotexpectedthatanerrorcanoccuronthedatawhensentacrossthebus.AlthoughmemorymayhaveECC,itisonlytoprotecterrorsthatoc-curwhilethatvalueisheldthere.Anincorrectdatapayloadcanincorrectlyconﬁgureaperipheral,suchasabrakecon-troller,orsenditawrongcommand.Theassumptionhereisthattheerroneousdatavaluewrittenwillnothaveanim-mediateimpact.Thereasonwecanmakethisassumptionisthatsomeperipheralsoperatefarslower,sothereistimetocorrecteitherbyre-writingthevalueorbysimplyreset-tingtheperipheral.Thismaynotbeapplicabletoalltypesofmemory,e.g.aFIFO,butatleastresettingthedeviceallowsthefailuretobecontrolled.Figure3.Datapayloadschemetimingwithnoerror.TheaddressisonlysentatthestartsoA1(addressone)inadottedoutlineisonlyforillustrationpurposes.Thetupleatthebot-tomofthediagramshowswhatinformationtheslavehasreceived,i.e.thedataandthechecksum(φfornull)Figure4.DatapayloadschemetimingwithanerroronD1(datavalue1)indicatedbythe*sufﬁx978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
483
Figure3showsanexampleofthetiminginthecaseofnoerror,whileFigure4highlightswhathappenswhenthereisanerror.ThereneedstobeanextratransferattheendofthetransactionforthelastECC,butthisextracyclewillonlyimpactthelatencyofthesubsequenttransactionifitoccursimmediatelyafterthelast.Whenanerrorisdetectedthemasterissimplystalledbyonecycletoallowforcorrect,sothatlatencyisonlyintroducedwhenthereisanerror.Theaddressoftheuncheckedpayloadisbufferedun-tiltheECCcheckismade.Ifitpassesthenthevalueisclearedfromthebuffer,butifitdoesn’tthenthemasterisstalled,andthecorrectdataiswrittentothestoredaddressbeforeitiscleared.Theareaoverheadissmallsinceitin-cludestheECCdecodeandabufferwhichneedstostoretwo32-bitaddressesatmost(onefortheaddressofthenewuncheckedpayloadandtheotherforlastpayloadwhosead-dressisneededtore-writethedatavalueiftherewasanerror).Thusanerrorcanbecorrectedonthedatapay-loadwithlowcostandwithoutintroducingextralatency,butonlywhereitisdeemedsafethattheerrorwillnothaveanimmediateimpact.6ConclusionTheimpactthat1-bittransientfaultsontheAMBAAXIbusmatrixcanhavewasexaminedanditwasfoundthattheconsequencescanbesevere,possiblyleadingtodeadlock,memorycorruption,orundeﬁnedbehaviour.Underthecon-straintsthatthemasterandslaveIPthatconnecttothebusmatrixcan’tbechangednortheAMBAstandard,thatnoextralatencyshouldbeintroduced,andthefrequencyandareaoverheadsminimised,acombinationofthreelow-techschemeswereproposed:parityonthecontrolsignals,re-arrangingthememorymapusingaHammingdistanceoftwo,anddelayedECConthedatapayload.ThisaﬁrststepinimprovingthereliabilityoftheAXIinterconnectwhichrepresentsanattractivechoicenowforthetargetmarkets,automotiveandnetworking,andwithincreasingsiliconun-reliabilityduetoshrinkingmayleadtofurthertechniquesinthefuture.References[1]H.Ando,K.Seki,S.Sakashita,M.Aihara,R.Kan.,andK.Imada.Acceleratedtestingofa90nmsparc64vmicro-processorforneutronser.IEEEWorkshoponSiliconErrorsinLogic-SystemEffects(SELSE),2007.[2]H.Ando,Y.Yoshida,A.Inoue,I.Sugiyama,T.Asakawa,K.Morita,T.Muta,T.Motokurumada,S.Okada,H.Ya-mashita,Y.Satsukawa,A.Konmoto,R.Yamashita,andH.Sugiyama.A1.3-ghzﬁfth-generationsparc64micro-processor.IEEEJournalSolidStateCircuits,38(11):1896–1905,2003.[3]ARM.Amba3axispeciﬁcation.(http://tinyurl.com/dfxt62).[4]R.Baumann.Radiation-inducedsofterrorsinadvancedsemiconductortechnologies.DeviceandMaterialsRelia-bility,IEEETransactionson,5(3):305–316,Sept.2005.[5]D.BradleyandJ.Penton.Aperspectiveondevelopingipforembeddedreliability.IEEEWorkshoponSiliconErrorsinLogic-SystemEffects(SELSE),2007.[6]IEC.Functionalsafetyandiec61508.[7]I.Lin,S.Srinivasan,andN.Vijaykrishnan.Transactionlevelerrorsusceptibilitymodelforbusbasedsocarchitectures.InQualityElectronicDesign,2006.ISQED’06.7thInterna-tionalSymposiumon,pages6pp.–780,27-29March2006.[8]M.Mack,W.Sauer,S.Swaney,andB.Mealey.IBMPOWER6reliability.IBMJournalofResearchandDevel-opment,51(6):763–774,2007.[9]D.Marsh.Siliconsafeguardsautomotivecircuits.EDNEu-rope,http://tinyurl.com/d3bl5c(retrieved2008/12/15).[10]T.MayandM.Woods.Alpha-particle-inducedsofterrorsindynamicmemories.ElectronDevices,IEEETransactionson,26(1):2–9,Jan1979.[11]P.Sanda,J.Kellington,P.Kudva,R.Kalla,R.McBeth,J.Ackaret,R.Lockwood,J.Schumann,andC.Jones.Soft-errorresilienceoftheibmpower6processor.IBMJOUR-NALOFRESEARCHANDDEVELOPMENT,52(3):275,2008.[12]D.SchroderandJ.Babcock.Negativebiastemperaturein-stability:Roadtocrossindeepsubmicronsiliconsemicon-ductormanufacturing.JournalofAppliedPhysics,94:1,2003.[13]N.Seifert,P.Slankard,M.Kirsch,B.Narasimham,V.Zia,C.Brookreson,A.Vo,S.Mitra,B.Gill,andJ.Maiz.Radiation-inducedsofterrorratesofadvancedcmosbulkdevices.InIEEEInternationalReliabilityPhysicsSympo-siumProceedings,2006,pages217–225,March2006.[14]K.L.ShepardandV.Narayanan.Noiseindeepsubmicrondigitaldesign.InProc.IEEE/ACMInternationalConfer-enceonComputer-AidedDesignICCAD-96.DigestofTech-nicalPapers,pages524–531,1996.[15]J.Ziegler.Terrestrialcosmicrays.InIBMJournalofRe-searchandDevelopment,volume40,pages19–39,January1996.