### 2016年制马人活动分析

#### 一、制马人活动时间线

**2016年1月1日**
- 新年伊始，制马人继续其恶意软件开发工作。当天，制马人开始尝试制作勒索软件的测试Demo程序。
- **图2.3** 勒索软件测试Demo程序

**2016年1月10日**
- 制马人转向钓鱼软件的开发，制作了一个用于窃取QQ账号和密码的钓鱼软件测试Demo程序。
- **图2.4** 钓鱼软件正在发送QQ账号密码信息

**2016年1月12日**
- 制马人通过篡改正常软件，制作了一款全屏不响应触摸事件的勒索软件。这一样本表明制马人从测试阶段逐步进入正式的勒索软件制作。
- **图2.5** 正常软件(左)与被篡改后的软件(右)对比

**总结：**
- 一月份，制马人不仅制作了“相册”、“移动积分”、“双倍抢红包(秒抢)”等FakeTaobao木马家族恶意样本，还涉足了钓鱼和勒索软件的开发。

**2016年2月4日**
- 二月份，制马人的活动明显减少。2月4日，制马人在勒索软件中加入了所谓的“免杀”手段，通过构造异常的ZIP包结构，导致分析工具解压时报错，以对抗常见的分析工具。
- **图2.6** 异常的ZIP包结构

**2016年2月5日至2月22日**
- 制马人在此期间没有进行任何恶意软件的开发，这段时间恰逢中国农历腊月二十七到正月十五。

**2016年2月25日**
- 制马人开始制作新型勒索软件，该软件将勒索软件隐藏在另一个软件的子包中。安装运行后，通过文字提示诱导用户授予Root权限，并将勒索软件安装到手机系统目录中，这种锁机方式被称为“Root锁”。
- **图2.7** 执行拷贝到系统软件目录的shell命令

**2016年3月1日**
- 三月份是制马人近半年内最为活跃的月份。3月1日，制马人制作了名为“QQ百宝箱”的恶意软件。
- **图2.8** QQ百宝箱安装图标
- 该恶意软件不仅会在用户不知情的情况下强制设置手机解锁PIN码，还会诱导用户输入QQ账号和密码进行钓鱼。
- **图2.9** 窃取QQ账号密码信息代码片段
- 此外，“QQ百宝箱”恶意软件还加入了遍历手机通讯录群发短信的功能，进行自我传播。与最新捕获的恶意软件相比，除了短信内容未加密外，两者代码结构几乎完全相同，我们认为这是后者的早期版本。
- **图2.10** “QQ百宝箱”遍历通讯录群发短信代码片段

**2016年3月19日**
- 从3月19日开始，在连续一周多的时间里，制马人每天都在制作恶意软件，甚至一天内制作多个恶意软件。
- **图2.11** 制马人同一天制作的三个恶意软件

**2016年四月**
- 四月份，制马人的活动频率有所下降，但所有制作的恶意软件均为勒索软件。

**总结：**
- 通过对制马人在近六个月内的活动频率和类型进行回溯和分析，我们可以看出以下特点：
  1. 2015年年底，制马人并不活跃，仅制作FakeTaobao木马家族恶意样本。
  2. 2016年1月，制马人尝试制作勒索和钓鱼软件，制作方向开始转变，制作了一批测试Demo程序。
  3. 2016年2月，制马人增加了恶意样本的对抗分析手段，并加强了勒索软件的恶意功能。
  4. 2016年3月，制马人增加了恶意软件的传播方式，开始群发短信进行裂变式传播，活动频率达到高峰。
  5. 2016年4月，制马人对已有代码进行了加密保护，并增加了不同类型恶意软件间的交叉式传播方式。
  6. 制马人的制马方向从FakeTaobao木马家族逐渐转向勒索软件，勒索软件受到了制马人的“青睐”。

#### 二、制马人信息

我们通过查询恶意软件中制马人留下的QQ信息，发现该QQ号码指向一个显示年龄为15岁的少年。此人是QQ群“AIDE – Android lockphone”的群主，该群目前有超过200人。此人群名片显示“赞我十赞截图，送root锁”，所谓的Root锁即为制马人在二月制作的利用Root的勒索软件恶意样本。
- **图2.12** QQ号码查询信息

此外，此人的QQ个性签名历史中曾出现“flaw的人生”，“flaw”这个词也出现在群发的短信链接中。根据这些信息，我们认为此人与制马人为同一人。
- **图2.13** 制马人历史个性签名信息

#### 第三章 影响与趋势

**一、关联样本**

我们通过已知的信息，关联出其他具有相似行为的勒索软件。这些勒索软件主要通过网盘和第三方网站进行传播。
- **图3.1** 关联样本中的短信内容与链接归属

从链接传播的对象来看，传播的恶意软件不仅是勒索软件本身，还包括其他恶意木马家族，例如FakeTaobao木马家族。
- **图3.2** 勒索软件传播的FakeTaobao木马家族

**二、收益情况**

经过调查，制马人制马方向的转变和多元化主要是出于经济利益考虑。据聊天记录显示，制马人主要制作“拦截马”即FakeTaobao木马家族，月收益约为1.3万元。同时，制马人也在制作勒索软件，每月能额外带来约1500元的收益。
- **图3.3** 制马人的聊天对话内容

制马人“青睐”勒索软件的原因一方面是因为勒索软件制作门槛低，多元化的制马方向能带来额外收益；另一方面，与FakeTaobao木马家族洗劫用户资金财产相比，勒索软件每次勒索的数额较小，相对制马人来说风险较低。

**三、裂变式传播**

制马人擅长使用群发带有恶意下载链接的短信方式进行恶意软件传播。受害者点击短信中的网址链接下载安装后，手机会被植入恶意软件，该软件会遍历受害者的通讯录，并继续向获取到的通讯录名单发送同样的恶意链接短信，从而实现裂变式传播。这种传播方式利用熟人间的信任关系，加之文字诱导，传播感染成功率极高。

**四、交叉式传播**

制马人制马类型的多元化带来了移动平台传播的新趋势。制马人将不同类型的恶意软件进行交叉式传播，这不仅为制马人带来了多种收益来源，同时也给用户带来了更多的安全威胁。一旦用户中招，木马会形成攻击链条，用户的损失会出现叠加，对手机防护软件提出了更高的要求。

#### 附录一: 参考资料

[1] FakeTaobao家族变种演变  
http://blogs.360.cn/360mobile/2014/09/16/analysis_of_faketaobao_family/

[2] Android Trojan Used To Create Simple SMS Spam Botnet  
http://blog.cloudmark.com/2012/12/16/android-trojan-used-to-create-simple-sms-spam-botnet/

[3] XX神器  
http://baike.so.com/doc/7486655-7756521.html