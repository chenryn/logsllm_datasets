0
0
1
0
1
0
1
0
1
1
1
1
1
1
1
1
1
8
→ RF Symbol Value
Preamble Correlation Value
XOR Result
→ Shift Register →
Hamming Distance
Hamming Distance
● # bits that are different between two values
● If , values are equal
When Hamming Distance > ..
RF Fuzzing // River Loop Security
Introducing Orthrus
RF Fuzzing // River Loop Security
Orthrus (/)
Spiritual successor to the ApiMote
Named for -headed dog from Greek mythology
● Why?  Because Orthrus has two heads!
61
RF Fuzzing // River Loop Security
Orthrus (/)
NXP LPC ARM MCU
● Host communication via USB
● Controlling radios
● RF state machine implementation and control
x ADF radios
● ADF has a slow re-tune time
○  allows for pre-emptive re-tune!
●  can listen while the other sits ready to transmit
○ High-speed responsive jamming
62
RF Fuzzing // River Loop Security
Initial Prototype
ADF dev board wired to Teensy:
Custom PCB is in progress
63
RF Fuzzing // River Loop Security
Orthrus RF Design Flow
Implement event loop in firmware
Blue-Green frontends for fast retuning / channel hopping
TODO: State machine abstraction language?
● e.g. XASM / ASML / SCXML
● Implement PHYs via config definitions rather than code
64
RF Fuzzing // River Loop Security
Packet-in-Packet Detection
.. Frame Structure:
Packet-in-Packet frame structure:
Traditional radio chipset would see the outer packet only
Software-defined decoder in Orthrus can be written to see both
65
PHY Header
PHY Data Unit
Preamble
SFD
Length
Data
CRC
PHY Header
PHY Data Unit
Preamble
SFD
Length
Preamble
SFD
Length
Data
CRC
RF Fuzzing // River Loop Security
Interested? Get Involved!
Contribute something to TumbleRF:
• Generator for some cool new fuzzing idea you have
• Harness to check the state of a device you care about testing
• Interface to transmit with your favorite radio
Contribute to Orthrus:
• Firmware development
• State machine abstraction definitions
66
RF Fuzzing // River Loop Security
Thank You!
DEF CON 26 Crew
River Loop Security
Cruise Automation
Ionic Security
River Loop Security
https://github.com/riverloopsec/tumblerf
RF Fuzzing // River Loop Security
Questions?
@embeddedsec
@rmspeers
[matt|ryan]@riverloopsecurity.com
River Loop Security
https://github.com/riverloopsec/tumblerf