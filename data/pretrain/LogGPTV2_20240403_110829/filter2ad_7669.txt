title:Scanning Traffic at the Edge of a Cellular Network
author:Fabio Ricciato and
Eduard Hasenleithner
Scanning Traﬃc at the Edge of a Cellular
Network
Fabio Ricciato and Eduard Hasenleithner
Telecommunications Research Center Vienna (ftw.)
Donau-City Straße. 1, 1220 Vienna, Austria
{ricciato,hasenleithner}@ftw.at
Abstract. We report on the traﬃc and delay patterns observed at short
time-scales at the edge of a cellular mobile network. We ﬁnd that high-
rate sequential scanners in the Internet are a common source of traﬃc
impulses and introduce “noise” in the one-way delay measurements.
1 Introduction
The originary motivation for this work was to use one-way delay measurements
as a basis to detect drifts and hidden problems between the measurement points:
the emergence of delay values higher than the “physiological” level observed in
the past can be taken as the symptom of capacity shortage or misfunctioning of
some intermediate network element. We analyzed the one-way delays in the Core
Network of an operational 3G mobile network in Austria, EU. We monitored all
the GGSNs and the Edge Routers (ER) co-located at a single physical site. For a
description of the network structure and the monitoring setting refer to [1]. We
consider here only the downlink traﬃc, i.e. towards the Mobile Stations (MS).
The one-way delay was extracted in post-processing with a similar methodology
as in [2]: selected ﬁelds in the TCP/IP headers are hashed and matchings are
seeked across diﬀerent sections. Here we summarize our initial ﬁndings.
2 Findings
In Fig. 1 we plot the delay samples through the Gi section (from the peering
links to the GGSNs, ref. [1, Fig. 1]) measured during 1 hour of moderate load 1.
As expected most of the samples take very low values, below 1 ms. However we
observe also large delay values, up to 200 ms, concentrated into vertical lines
(spikes) that are scattered uniformly across the whole day. The delay patterns
internal to the GGSN looks similar (not reported here for space constraints,
see [1, Fig. 3]). The simplest explanation is that delay spikes are associated to
traﬃc bursts. In fact, the downlink traﬃc rate measured in bins of 1 sec yields
1 Quantitative values are considered business-sensitive by the operator and subject
to non-disclosure, e.g. absolute traﬃc volumes. For this reason the following graphs
reporting absolute values have been rescaled by an arbitrary undisclosed factor.
S. Uhlig, K. Papagiannaki, and O. Bonaventure (Eds.): PAM 2007, LNCS 4427, pp. 269–272, 2007.
c(cid:2) Springer-Verlag Berlin Heidelberg 2007
270
F. Ricciato and E. Hasenleithner
spikes (positive impulses) scattered across the whole day. By manual inspection
we found that the primary cause for traﬃc spike are sequential scanners.
The probe packets originated by a sequential high-rate scanning source arrive
to the local peering links in a pattern that is shaped by the address space alloca-
tion of the local network (see [1] for a detailed description). In Fig. 2 we report
the packet rate measured at diﬀerent network sections for the traﬃc originated
by a single external IP address identiﬁed as a high-rate sequential scanner (call
it “S”). The probe packets were arriving clustered into bursts of very short du-
ration, corresponding to a relatively high bitrate (undisclosed). We found several
active scanners, persistent and not, using diﬀerent packet types (e.g. TCP SYN,
UDP). When non-blocked ports are used the scanning bursts penetrate into the
Core Network - note that public addressing is used for the MS.
3:00-3:59
15:00-15:59
 1
 0.1
 0.01
 0.001
 1e-04
l
y
a
e
d
>
s
e
p
m
a
s
f
l
o
n
o
i
t
c
a
r
f
 1e-05
 1e-04
 0.001
 0.01
 0.1
delay/seconds
Fig. 1. One-way downlink delays on Gi, from peering links to GGSNs
Comparing Figg. 2(a) and 2(b) we see that a sensible fraction of the probe
packets (up to 80%) is lost in the Gi path (ER → GGSN) due to micro-congestion
caused by the the scanning traﬃc itself (discussed below). Comparing 2(b) and
2(c) we see that in each timebin only a fraction of the packets seen on Gi reach
the Gn links, i.e. passes the GGSN. In fact the latter forwards only the pack-
ets directed to active IP addresses, i.e. currently assigned to MS within active
connections (PDP-contexts), hence the penetration of scanning traﬃc into Gn is
subject to time-of-day eﬀect: low in the night, maximum at the peak hour when
 1.6
 1.4
 1.2
 1
 0.8
 0.6
 0.4
 0.2
l
)
d
e
a
c
s
e
r
(
e
t
i
u
n
m
/
s
t
e
k
c
a
p
 0.25
 0.2
 0.15
 0.1
 0.05
l
)
d
e
a
c
s
e
r
(
e
t
i
u
n
m
/
s
t
e
k
c
a
p
 0
 0
 200
 400
 800
 600
 1000
seconds since 00:00
 1200
 1400
 1600
 0
 0
 200
 400
 800
 600
seconds since 00:00
 1000  1200  1400  1600
 0.09
 0.08
 0.07
 0.06
 0.05
 0.04
 0.03
 0.02
 0.01
l
)
d
e
a
c
s
e
r
(
e
t
i
u
n
m
/
s
t
e
k
c
a
p
 0
 0
 200
 400
 800
 600
seconds since 00:00
 1000  1200  1400  1600
(a) Peering links
(b) Gi links
(c) Gn links
Fig. 2. Daily packet rate (rescaled) for one scanning source, 1 min bins
Scanning Traﬃc at the Edge of a Cellular Network
271
 1
 0.1
 0.01
 0.001
]
s
d
n
o
c
e
s
[
y
a
e
d
l
scanning
filtered
 0.01
 0.008
 0.006
 0.004
 0.002
 0
-0.002
l
)
d
e
a
c
s
e
r
(
c
e
s
m
/
s
t
e
k
c
a
p
uplink MS traffic
scanning downlink
 1e-04
 59573
 59573.2
 59573.4
 59573.6
 59573.8
 59574
-0.004
 54487  54487.1  54487.2  54487.3  54487.4  54487.5  54487.6  54487.7  54487.8  54487.9  54488
seconds since 00:00
(a) Gi delays.
(b) Packet rate on peering links.
seconds since 00:00
Fig. 3. Microscopic patterns during scanning bursts
more MS are active. Notably a fraction of MS respond to incoming probes (e.g.
with ICMP “port unreachable”) thus causing backscatter traﬃc in uplink.
Micro-congestion. Scanning bursts were clipped inside the Gi section because
hitting the capacity limit of some internal link. To see that we zoom into a
sample scanning burst from source S. We divide the delay samples into two
groups: scanning packets (identiﬁed by the IP address of S) and other traﬃc
(“ﬁltered”). We plot them separately in Fig. 3(a) against the time-axis. Let us
focus on the “scanning” samples: the delay pattern is consistent with the pres-
ence of a buﬀer that ﬁlls up rapidly (initial slope) and then remains persistently
saturated (plateau). After the ﬁll-up phase most arriving packets are lost, while
those entering the buﬀer experience an approximately constant delay equal to
the buﬀer depletion time (≈ 20 ms in this case). After this phase we observe
a cluster of delay samples considerably larger, around 200 ms, followed by an
empty period of ≈ 200 ms wherein no packets are seen at all. This pattern is
consistent with the so-called “coﬀee-break” event [2], i.e. a temporary interrup-
tion of the packet forwarding process at some intermediate router. In our traces
such events only occurr during large scanning bursts, suggesting that the ob-
served coﬀee-breaks are not to due to “normal” router dynamics as in [2] but
rather a symptom of short-term CPU congestion. Note also that in Fig. 3(a)
the whole delay pattern described for the scanning packets is followed by the
other traﬃc as well (“ﬁltered” series). This indicates that the micro-congested
resources (buﬀer, CPU) are shared by all traﬃc. In other words, the scanning
traﬃc is causing a small impairment to the other legitimate traﬃc.
Besides micro-congestion we observed a number of other interesting phenom-
ena somehow related to the presence of scanning traﬃc.
Traﬃc Notches. The total traﬃc rate observed in the core network (Gi, Gn
links) displays some notches, i.e. negative impulses, when measured at small
timescales (1 sec bins, see [1, Fig. 4]). Further investigations into a few sample
cases revealed a close correlation with the scanning process, suggesting that
high-rate scanning bursts can locally reduce the arrival rate of legitimate traﬃc.
272
F. Ricciato and E. Hasenleithner
Uplink packing. The microscopic analysis revealed that the presence of scan-
ning traﬃc in downlink has an impact on the traﬃc pattern in uplink as well.
In Fig. 3(b) we draw the uplink traﬃc originated by all the MS as observed
at the peering links, measured as packet counts in timebins of 1 ms. On the
negative axis we draw the count of scanning packets seen in downlink. Note
that during the scanning periods the uplink packets are transmitted into dis-
continuous bursts, corresponding to large distinct spikes in the packet count.
A possible explanation is that the CPU at some internal node is kept busy by
the scanning traﬃc for a few milliseconds, thus starving the uplink forwarding
process. During such vacancy periods the arriving uplink packets are buﬀered,
then when the CPU returns available for the uplink stream they are forwarded
at once, “packed” into a single burst. Notably most of uplink packets are TCP
ACK, which might in principle lead to some sort of TCP synchronization eﬀect
at small time-scale.
3 Conclusions and Future Work
We found that Internet traﬃc contains large bursts of packets originated by
high-rate sequential scanning activities. Large access network employing public
IP addressing, including 3G cellular networks, are permeable to scanning bursts.
The impact of such activities - and of unwanted traﬃc in general [3] - onto the
underlying network infrastructure might be not yet well understood. The initial
observations reported here, still speciﬁc to the particular network under study,
suggest that the network dynamics triggered by such traﬃc are non-trivial and
worth further investigations. We showed that scanning traﬃc causes a sort of
“shot-noise” into the delay measurements due to micro-congestion events. Such
noise complicates the task of using the delay statistics to validate the health
status of the network elements, and in general should be taken into account
when interpreting delay measurements from the real-world.
References
1. F. Ricciato, E. Hasenleithner. Observations at short time-scales from the edge
of a cellular data network. Technical Report FTW-TR-2007-001, January 2007.
Available online from [4].
2. K. Papagiannaki, S. Moon, C. Fraleigh, P. Thiran, C. Diot. Measurement and
IEEE JSAC, 21(6),
Analysis of Single-Hop Delay on an IP Backbone Network.
August 2003.
3. F. Ricciato. Unwanted Traﬃc in 3G Networks. ACM Computer Communication
Review, 36(2), April 2006.
4. DARWIN home page http://userver.ftw.at/∼ricciato/darwin.