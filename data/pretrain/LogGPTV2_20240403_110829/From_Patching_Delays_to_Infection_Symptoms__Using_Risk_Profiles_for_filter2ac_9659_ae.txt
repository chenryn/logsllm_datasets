ity disclosure and it was shown that accurate prediction
can be made to gain a few days in advance of disclosure
announcements as an effective means of mitigating zero-
day attacks. The focus of this study by contrast is the
detection of exploits post-disclosure by using two dis-
tinct datasets, one capturing end-host patching behavior,
the other IP level malicious activities. Allodi [2] con-
ducts an empirical study on the economics of vulnera-
bility exploitation, by analyzing data collected from an
underground cybercrime market.
Prior studies on end-host patching behavior heavily fo-
cus on understanding the patching behavior itself and its
implication on user vulnerability and how it decays/e-
volves over time; these include e.g., observing patching
patterns at different stages [35], the decay rate [15, 53],
patching behavior across different update mechanisms
[13, 19], vulnerability decay and threat by shared li-
braries [30], among others. To the best our knowledge,
ours is the ﬁrst study that attempts to to detect active ex-
ploitation by correlating patching behavior and vulnera-
bility data with host infection data inferred from a set of
spam blacklists.
Detection of community structures in graphs or net-
works is an increasingly active ﬁeld in graph mining
and has seen extensive work, see e.g., [17].
It has
found wide applications in sociology [23, 51, 52], bi-
ology [18, 43, 52], computer science [31, 51, 52], and
many other disciplines, where data is often modeled as
a graph, using community detection as a tool for visu-
alization, to reduce graph size, and to ﬁnd hidden pat-
terns. As an example, the notion of similarity graphs is
a commonly used technique to represent data. For in-
USENIX Association
27th USENIX Security Symposium    915
stance, Holm et al. built similarity protein graphs where
nodes represent protein structures and edges represent
structural alignments for efﬁcient search in the protein
structure databases [22]. Similarly, to ﬁnd disjoint sub-
sets of data, E. Hartuv et al. created similarity graphs on
pairs of elements, where similarity is determined by the
set of features for each element, and then perform clus-
tering on them [21].
In this study, we build similarity
graphs among ISPs by measuring the similarity between
their time series data.
9 Conclusion
In this paper we presented a novel method based on the
notion of community detection to perform early detec-
tion of vulnerability exploitation. We used symptomatic
botnet data to discover a community structure revealing
how similar network entities behave in terms of their ma-
licious activities. We then analyzed the risk behavior of
end-hosts through a set of patching data that allows us
to assess their risk to different vulnerabilities. The latter
was then compared to the former to quantify whether the
underlying risks are consistent with the observed global
symptomatic community structure, which then allowed
us to statistically determine whether a given vulnerability
is being actively exploited. Our results show that by ob-
serving up to 10 days worth of data post-disclosure, we
can successfully detect the presence of exploits at 90%
accuracy. This is much earlier than the recorded times of
detection for most vulnerabilities. This early detection
capability provides signiﬁcant time advantage in patch
development and deployment, among other preventative
and protective measures. The community structure gen-
erated during the feature extraction can also be used to
identify groups of hosts at risk to speciﬁc vulnerabili-
ties currently being exploited, adding to our ability to
strengthen preventative and protective measures.
Acknowledgments
We thank Xueru Zhang, Parinaz Naghizadeh, Pin-Yu
Chen, and Ziyun Zhu for their valuable discussions on
this work. This work was supported by the NSF under
grants CNS-1422211, CNS-1616575, CNS-1739517,
and CNS-1464163, and by the DHS via contract num-
ber FA8750-18-2-0011.
References
[1] ADOBE. Security advisory for Adobe Reader and
https://www.adobe.com/support/
Acrobat.
security/advisories/apsa13-02.html.
[2] ALLODI, L. Economic factors of vulnerability
In ACM SIGSAC Confer-
trade and exploitation.
ence on Computer and Communications Security
(2017), ACM, pp. 1483–1499.
[3] ANTONAKAKIS, M., APRIL, T., BAILEY, M.,
BERNHARD, M., BURSZTEIN, E., COCHRAN,
J., DURUMERIC, Z., HALDERMAN, J. A., INV-
ERNIZZI, L., KALLITSIS, M., ET AL. Understand-
ing the Mirai botnet. In USENIX Security Sympo-
sium (2017).
[4] Symantec attack signatures.
1hCw1TL.
http://bit.ly/
[5] BASTIAN, M., HEYMANN, S., JACOMY, M.,
ET AL. Gephi: An open source software for explor-
ing and manipulating networks. ICWSM 8 (2009),
361–362.
[6] BELLOVIN, S. M.
Patching is hard.
https:
//www.cs.columbia.edu/~smb/blog/2017-
05/2017-05-12.html.
[7] BENNETT,
J. T.
It’s a kind of magic.
https://www.fireeye.com/blog/threat-
research/2013/02/its-a-kind-of-magic-
1.html.
[8] BOZORGI, M., SAUL, L. K., SAVAGE, S., AND
VOELKER, G. M. Beyond heuristics: Learn-
ing to classify vulnerabilities and predict exploits.
In ACM SIGKDD International Conference on
Knowledge Discovery and Data Mining (2010),
ACM, pp. 105–114.
[9] CBL. https://www.abuseat.org.
[10] COSCIA, M., ROSSETTI, G., GIANNOTTI, F.,
AND PEDRESCHI, D. DEMON: A local-ﬁrst
discovery method for overlapping communities.
In ACM SIGKDD International Conference on
Knowledge Discovery and Data Mining (2012),
ACM, pp. 615–623.
[11] CVE-2013-5330 (Flash) in an unknown exploit
kit fed by high rank websites. http://malware.
dontneedcoffee.com/2014/02/cve-2013-
5330-flash-in-unknown-exploit.html.
[12] CVE ID syntax change. https://cve.mitre.
org/cve/identifiers/syntaxchange.html.
[13] DUEBENDORFER, T., AND FREI, S. Web browser
In International
security update effectiveness.
Workshop on Critical Information Infrastructures
Security (2009), Springer, pp. 124–137.
916    27th USENIX Security Symposium
USENIX Association
[14] DUMITRAS, , T., AND SHOU, D. Toward a stan-
dard benchmark for computer security research:
The Worldwide Intelligence Network Environment
In Workshop on Building Analysis
(WINE).
Datasets and Gathering Experience Returns for Se-
curity (2011), ACM, pp. 89–96.
[15] DURUMERIC, Z., KASTEN, J., ADRIAN, D.,
HALDERMAN,
J. A., BAILEY, M., LI, F.,
WEAVER, N., AMANN, J., BEEKMAN, J., PAYER,
M., ET AL. The matter of Heartbleed. In Internet
Measurement Conference (2014), ACM, pp. 475–
488.
[16] EYKHOLT, K., EVTIMOV, I., FERNANDES, E.,
LI, B., RAHMATI, A., XIAO, C., PRAKASH, A.,
KOHNO, T., AND SONG, D. Robust physical-
world attacks on deep learning visual classiﬁca-
In Proceedings of the IEEE Conference on
tion.
Computer Vision and Pattern Recognition (2018),
pp. 1625–1634.
[17] FORTUNATO, S. Community detection in graphs.
Physics Reports 486, 3 (2010), 75–174.
[18] GIRVAN, M., AND NEWMAN, M. E. Community
structure in social and biological networks. Pro-
ceedings of the National Academy of Sciences 99,
12 (2002), 7821–7826.
[19] GKANTSIDIS, C., KARAGIANNIS, T., RO-
DRIGUEZ, P., AND VOJNOVIC, M. Planet scale
In ACM SIGCOMM Computer
software updates.
Communication Review (2006).
[20] GOODIN, D.
led
bug
Failure to patch two-month-
breach.
to massive Equifax
old
https://arstechnica.com/information-
technology/2017/09/massive-equifax-
breach-caused-by-failure-to-patch-two-
month-old-bug.
[21] HARTUV, E., AND SHAMIR, R. A clustering al-
gorithm based on graph connectivity. Information
Processing Letters 76, 4 (2000), 175–181.
[22] HOLM, L., K ¨A ¨ARI ¨AINEN, S., ROSENSTR ¨OM, P.,
AND SCHENKEL, A. Searching protein structure
databases with DaliLite v. 3. Bioinformatics 24, 23
(2008), 2780–2781.
[23] HUI, P., YONEKI, E., CHAN, S. Y., AND
CROWCROFT, J. Distributed community detection
in delay tolerant networks. In ACM/IEEE Interna-
tional Workshop on Mobility in the Evolving Inter-
net Architecture (2007), ACM, p. 7.
[24] JACOMY, M., VENTURINI, T., HEYMANN, S.,
AND BASTIAN, M.
ForceAtlas2, a continuous
graph layout algorithm for handy network visual-
ization designed for the Gephi software. PloS one
9, 6 (2014), e98679.
[25] KHALILI, M. M., NAGHIZADEH, P., AND LIU,
M. Designing cyber insurance policies: Mitigat-
ing moral hazard through security pre-screening. In
International Conference on Game Theory for Net-
works (2017), Springer, pp. 63–73.
[26] KHALILI, M. M., NAGHIZADEH, P., AND LIU,
M. Designing cyber insurance policies: The role of
pre-screening and security interdependence. IEEE
Transactions on Information Forensics and Secu-
rity 13, 9 (2018), 2226–2239.
[27] LANCICHINETTI, A., AND FORTUNATO, S. Com-
munity detection algorithms: A comparative analy-
sis. Physical Review E 80, 5 (2009), 056117.
[28] LIN, S., YEH, M., AND LI, C. Common vulnera-
bility scoring system version 2 calculator. PAKDD
2013 Tutorial (2013).
[29] MaxMind. http://www.maxmind.com/.
[30] NAPPA, A., JOHNSON, R., BILGE, L., CA-
BALLERO, J., AND DUMITRAS, , T. The attack of
the clones: A study of the impact of shared code
on vulnerability patching. In IEEE Symposium on
Security and Privacy (2015).
[31] NATARAJAN, N., SEN, P., AND CHAOJI, V.
Community detection in content-sharing social net-
works. In IEEE/ACM International Conference on
Advances in Social Networks Analysis and Mining
(2013), ACM, pp. 82–89.
[32] NAYAK, K., MARINO, D., EFSTATHOPOULOS, P.,
AND DUMITRAS, , T. Some vulnerabilities are dif-
ferent than others: Studying vulnerabilities and at-
tack surfaces in the wild. In International Sympo-
sium on Research in Attacks, Intrusions and De-
fenses (Sep 2014).
[33] NIST. National Vulnerability Database. https:
//nvd.nist.gov.
[34] PEDREGOSA, F., VAROQUAUX, G., GRAMFORT,
A., MICHEL, V., THIRION, B., GRISEL, O.,
BLONDEL, M., PRETTENHOFER, P., WEISS, R.,
DUBOURG, V., ET AL.
Scikit-learn: Machine
learning in Python. Journal of Machine Learning
Research 12 (2011), 2825–2830.
USENIX Association
27th USENIX Security Symposium    917
[50] XIAO, C., ZHU, J.-Y., LI, B., HE, W., LIU,
M., AND SONG, D. Spatially transformed adver-
sarial examples. arXiv preprint arXiv:1801.02612
(2018).
[51] YANG, J., AND LESKOVEC, J. Overlapping com-
munity detection at scale: A nonnegative matrix
factorization approach. In ACM International Con-
ference on Web Search and Data Mining (2013),
ACM, pp. 587–596.
[52] YANG, J., MCAULEY, J., AND LESKOVEC, J.
Community detection in networks with node at-
tributes. In IEEE International Conference on Data
Mining (2013), IEEE, pp. 1151–1156.
[53] YILEK, S., RESCORLA, E., SHACHAM, H., EN-
RIGHT, B., AND SAVAGE, S. When private keys
are public: Results from the 2008 Debian OpenSSL
vulnerability. In Internet Measurement Conference
(2009), pp. 15–27.
[35] RAMOS, T. The laws of vulnerabilities.
Conference (2006).
In RSA
[36] SABOTTKE, C., SUCIU, O., AND DUMITRAS, , T.
Vulnerability disclosure in the age of social me-
dia: Exploiting Twitter for predicting real-world
exploits. In USENIX Security Symposium (2015).
[37] SAEYS, Y., INZA, I., AND LARRA ˜NAGA, P. A
review of feature selection techniques in bioinfor-
matics. Bioinformatics 23, 19 (2007), 2507–2517.
[38] SARABI, A., ZHU, Z., XIAO, C., LIU, M., AND
DUMITRAS, , T. Patch me if you can: A study on the
effects of individual user behavior on the end-host
vulnerability state. In International Conference on
Passive and Active Network Measurement (2017),
Springer, pp. 113–125.
[39] The Spamhaus project: SBL, XBL, PBL, ZEN.
http://www.spamhaus.org.
[40] Symantec security focus community.
www.securityfocus.com.
http://
[41] SpamCop blocking list. http://www.spamcop.
net.
[42] SYMANTEC CORPORATION. Symantec threat ex-
plorer. http://www.symantec.com/security_
response/threatexplorer/azlisting.jsp.
[43] THAKUR, G. S. Community detection in biologi-
cal networks. Applied Statistics for Network Biol-
ogy: Methods in Systems Biology, 299–327.
[44] TONG, L., LI, B., HAJAJ, C., AND VOROB-
EYCHIK, Y. Feature conservation in adversarial
classiﬁer evasion: A case study. arXiv preprint
arXiv:1708.08327 (2017).
[45] UCEPROTECT
uceprotect.net.
network.
http://www.
[46] US-CERT.
Indicators associated with Wan-
https://www.us-cert.
naCry ransomware.
gov/ncas/alerts/TA17-132A.
[47] US-CERT. Petya ransomware. https://www.
us-cert.gov/ncas/alerts/TA17-181A.
[48] WPBL: Weighted private block list. http://www.
wpbl.info.
[49] XIAO, C., LI, B., ZHU, J.-Y., HE, W., LIU,
M., AND SONG, D. Generating adversarial ex-
amples with adversarial networks. arXiv preprint
arXiv:1801.02610 (2018).
918    27th USENIX Security Symposium
USENIX Association