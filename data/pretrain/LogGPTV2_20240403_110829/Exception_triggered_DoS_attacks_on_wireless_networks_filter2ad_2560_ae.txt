Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
TLSAttack.Thisdelayaidstheattackerbygivingitamuchlargertimewindowandhencetheattackerhashighersuc-cessrate.Sowecanseethatthesmallertheserverdelay,thelargertheauthenticationsuccessrate.Considertheextremecasewhentheserverdelayis0msandCWMinissettobe31.Itisclearthatasthenumberofclientsincrease,thepacketsqueuedattheAPplayanimportantrole,andhencedecreasestheauthenticationsuccessratewhentherearemoreandmoresimultaneousauthentications.Still,whenCWMin=1,noau-thenticationcan(cid:2)nishatall.5.2EvaluationonMIPv6RouteOptimizationProtocolBeingtheemergingnewinfrastructure,MIPv6aswellasIPv6isnotwidelydeployedcurrently.Soweconductedatestbedexperimenttodemonstratethepracticalityofthisat-tack.Duetothespacelimit,webrie(cid:3)ydescribeourtestbedexperimentandresultsinthispaper,leavingthedetailsinourtechniquereport[32].WebuilttheMobileIPv6networkusingtheMobileIPv6ImplementationforLinux(MIPLv2.0.2)[4],themostpopu-laropensourceMIPv6implementation.Theunderlyingnet-workisallIPv4,andalllogicalinterfaceswereGRE-based(GenericRoutingEncapsulationdevelopedbyCisco),totun-nelIPv6-over-IPv4.Intheexperiment,theMobileNodewas(cid:2)rstintheHomeNetwork,anditkeptpingingtheCorrespondentNodecon-tinuously.ThenwemovedittotheForeignNetwork.Aftercon(cid:2)guringthenewcare-ofaddressandregisteringitwiththeHomeAgent,theMobileNodestartedreturnroutability.Weconductedtheexperimentfor100runs.Everytimeweobservedthat,withtheattackerinaction,thereturnroutabil-ityprocedurewasdisruptedandtheMobileNoderepeatedlytriedtocompletetheprocedure.Whiletheretryattemptswerebeingmade,noneoftheICMPv6echorequests(Ping)reachedtheCorrespondentNode.Hence,intheMIPLim-plementation[4],theeffectoftheattackincreasedandmadeitaDoSattackinsteadofaperformancedegradationattack.6CountermeasurestoExceptionTrig-geredDoSAttacksInthissection,wediscusscountermeasurestotheexcep-tiontriggeredattacks.First,weconsiderhowtodetectsuchattacks,whichisnotsupportedgenerallybyintrusiondetec-tionsystems,tothebestofourknowledge.Sinceitisusu-allymoredesirabletosecureasystemagainstsuchattacks,weproposeageneralapproachthatcanbeeasilyadoptedbyprotocolstogainrobustnessagainsttheexceptiontriggeredattacks.Third,weproposethedesignguidelineforfutureauthenticationprotocolstobeinvulnerabletosuchattacks.6.1AttackDetectionThedetectionoftheexceptiontriggeredattackscannotbedonebythegeneralsignaturebasedIDSsuchassnort[28]ornetworkIDSsuchasbro[27].Thedetectionmustunderstandtheprotocolandidentifythesymptomsoftheattack.We(cid:2)ndtherearetwosymptomsofsuchattacks:1)Therearemulti-ple(contradictory)responsemessageswithdifferentcontentsinthesamestageoftheprotocol’sstatemachine.Thissymp-tomcanruleoutmost‘normal’exceptions,suchaswrongpassword.2)Theprotocol(cid:2)nallyendsabnormally.Ifsuchtwosymptomshappenmanytimesinacertaintimeperiod,itisanindicationthattheexceptiontriggeredattackisinac-tion.Whilethetwosymptomsseemtobesimple,therealimplementationinanIDSmaynotbetrivial.TheIDShastobestatefulandabletounderstandeveryprotocol.Itwouldbeinterestingto(cid:2)ndageneralapproachforallprotocols.6.2ProtocolImprovementagainsttheAttacksToimproveandsecureexistingprotocolsagainstsuchat-tacks,weproposeagame-theorybaseddesignprinciple.Foraprotocolentity,theprocessingofareceivedmessagewillbedelayedifitsconsequenceiscostly,andtheamountofde-laytimewillbeproportionaltothecostoftheconsequence.Whenmultiplecon(cid:3)ictingmessagesarereceived,theonewiththeleastcostofconsequenceshouldbetaken.Thispreferenceisparticularhelpfultodealwithattacksdirectlyusingerrormessages.Incasethatmultiplemessagesareofthesameconsequencebutdifferoncontentssuchasau-thenticationparameters(e.g.themisleadingmessagebasedattack),thereceiveracceptsallthemessagesandstartsdif-ferentbranchestodealwiththem.Theauthenticationbe-tweenthelegitimateclientandseverwill(cid:2)nallysucceedandallotherfakeonescannot.TakeourcasestudyonTLS-basedEAPprotocolasanexample.Thefatalerrormessagesandtheirtriggeringmes-sagescausetheworstconsequence,i.e.,aterminationoftheauthentication.Sothesemessageswilltakelongestdelayinprocessing(e.g.,1secinourcountermeasureimplementationdescribedinSection6.2),andsuchintroducedlatencyhasonlylimitedeffectontheprotocolperformance.Fornormalmessages,thedelaytimewillbeverysmall(e.g.,hundredsofmilliseconds)inordertomaintaintheperformance.Iftheentityreceivesbothafatalerrormessageandanormalmes-sagethatadvancestheauthenticationstage,theentitywillselectthelatterone,whichobviouslyhasaconsequenceofleastcost.Theremaybeaconcernthatsmartattackerswillutilizethecountermeasuresfornewattacks.Forexample,anat-tackermayspoof(cid:147)correct(cid:148)messagestoadvanceanauthen-ticationeveniftheauthenticationhasrealerrorsandshouldterminate.However,theattackcannotproceedwiththefakeauthenticationforalongtimewithoutpayingaproportionalcost,andcannever(cid:2)nishitbecauseofthelackofthese-crecy.Sopotentiallytheattackcandelaytherestartoftheauthenticationshortly,butthisconsequenceisnotsevere.ImplementationandExperimentsofCountermeasuresWeimplementedtheaboveproposalsintotheTLSproto-coltotestitseffectiveness.Sinceweonlyhavethecontrolofclients,wemodi(cid:2)edtheclientsoftware,WPASupplicantv0.5.10[6]softwaretoincorporatetheaboveapproachesintheclientside.First,WPASupplicantwasmodi(cid:2)edsothatnormalmes-sagesarepreferredovertheerrormessages.WhenevertheclientreceivesaTLSALERTmessageitwaitsforamax-imumof1secondbeforeprocessingthealertmessage.Iftheclientgetsalegitimatemessagethat(cid:2)tsthecurrentstateoftheauthenticationprocess,thenitdiscardsthealertmes-sageandprocessestheothermessages.Second,themislead-ingmessageattackcanonlysendmultipleSERVERHELLO978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
21
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
 0 2 4 6 8 10 0 5 10 15 20 25 30 35 40 45 50% of success authenticationNumber of clientsCWMin=1CWMin=11CWMin=21CWMin=31Figure8:Authenticationsuccessratewithdif-ferentCWMin. 0 20 40 60 80 100 0 5 10 15 20 25 30 35 40 45 50% of success authenticationNumber of clientsCWMin=31, delay=0msCWMin=31, delay=5msCWMin=31, delay=10msCWMin=31, delay=20msCWMin=1, delay=0msFigure9:Authenticationsuccessratewithvar-iousserverdelays.ServerClientServer certificate (including server’s public key Ks+)Ks+(Randomstring S, Identity)HelloFigure10:Thedesignofrobustsecurityprotocol.andServerKeyExchangemessages,buttheservercerti(cid:2)-catecannotbespoofed.Themodi(cid:2)edWPASupplicantwillgeneratemultiplekeysand(cid:2)nallyonlythecorrectonecanworkinthefollowingcommunications.Thetestswereper-formedinthesameexperimentalsetupasdescribedin5.1.1.Theexperimentswereconducted10timesandtheattackerwasneversuccessfulinanyoftheruns.Itisbecausethattheclientalwaysreceivestherealserverresponsemessagebeforetheonesecondthreshold.Also,sincetheclientwillprocesstherealpositivemessagesimmediately,thereisnodelayontheauthenticationtime.Ourexperimentsshowthattheaveragedelayofauthenticationremainsthesameasthatoftheclientswithoutbeingattacked.Inshort,theexperimentsandresultsshowthatourcoun-termeasuresareeasytobeadoptedbyexistingprotocols,andareeffectiveagainsttheexceptiontriggeredattacksinprac-tice.6.3DesignofRobustSecurityProtocolsInthissection,wepresentaguidelinefordesigningnewprotocolstoberobusttotheexceptiontriggeredattack.Thehigh-levelideais:Getpacketsencryptedorauthenticatedasearlyaspossible.Anddonothavecomplexstatesandpa-rametersbeforepacketsareencryptedorauthenticated.Figure10illustratesanexampleofthedesignphilosophy.First,theclientsendsaHELLOmessagetorequestforau-thentication.TheHELLOmessageonlynoti(cid:2)estheserverforauthenticationanddoesnotincludeanyparticularinfor-mationsuchastheidentityoftheclient.Second,theserversendsbackitscerti(cid:2)cate,signedbythewell-knowncerti(cid:2)-cateauthorities.Inthecerti(cid:2)cate,theclientobtainsthever-i(cid:2)edpublickeyK+softheserver.Third,theclientusesthepublickeyK+stoencryptarandomsessionidentityIandarandomstringSandsendsbacktheencryptedpacket.Inthefollowingcommunications,theserverandtheclienttakeIasthesessionIDanduseStoauthenticatepackets.BecauseSishiddenfromthesniffer,theattackhasnowaytointerferethelegitimateauthenticationprocedureoncethesessionIDIandsharedkeySareestablished.NotethatwecanalsouseDif(cid:2)e-Hellmankeyexchangealgorithm[14]intheplaceoftheservercerti(cid:2)catetoexchangeSagainsteavesdroppers,ifservercerti(cid:2)cateisnotavailable.Let’sconsiderifattackercanattackduringthecommuni-cationofthe(cid:2)rstthreemessages.The(cid:2)rstHELLOmessagehasnousefulinformationfortheattacker,andtheserverevendoesnotneedtoallocateanewsession.Thesecondmessageisserver’scerti(cid:2)cate,whichcannotbespoofed.Afterget-tingtheservercerti(cid:2)cate,theattackermaysendbackanerrormessage,e.g.,sayingthecerti(cid:2)cateiswrong,orsendbackamisleadingmessage,e.g.,withguessedidentityI0andaran-domstringS0.Neithertheattackwillworkactually.Theserversimplyignorestheerrormessageandonlywaitsforencryptedmessageswiththeserver’spublickey.Themis-leadingmessagewillbeacceptedbytheserver,butsincetheattacker’sI0andS0aredifferentfromtheclient’s,theat-tackercannotinterferewiththeclient’sauthentication.7RelatedWorkWirelessnetworksseemtobemorevulnerablethanthewirednetworks,simplybecauseoftheopenmedianatureofthewirelessnetworks.SincethethriveofthewirelessLAN,cellularnetworks,adhocandsensornetworks,thereareagreatnumberoffreshvulnerabilitiesandnovelattacksdis-coveredondifferentwirelessnetworks[1,11,17,19,23,26,31].ThispapermainlyfocusesontheDoSattacks,especiallyonprotocolsofwirelessLAN.DenialofServiceattackisanotoriousprobleminwirelessnetworks.Sincetheearlytimeofradionetworks,jamminghasbeenapowerfulmethodtodisablewirelesscommuni-cations.Recentlyin[31],Xuetal.studiedthefeasibilityoflaunchinganddetectingjammingattacksinwirelessnet-works.Theyproposedfourdifferentjammingattackmodelsthatcanbeusedbyanattackertodisabletheoperationofawirelessnetwork,andevaluatedtheeffectivenessofeachat-tackmodel.Noubiretal.investigatedtheresiliencytojam-mingondataprotocols,suchasIP,overWLAN[26].Theyconcludedthatwithoutgoodcoding,thejammingattackcanbeveryef(cid:2)cientbyonlyinjectingasinglebittodisruptapacketincurrentWLAN.Otherthanjamming,peoplealsofoundmanyotherstealthyandpracticalattacksonwirelessnetworks,espe-ciallyonWLAN.In[11],Bellardoetal.describedsomevulnerabilitiesinthe802.11managementandmediaaccessservices,andmoreimportantly,implementedthemtoshowthepractice.Theydemonstratedwiththedeauthenticationandvirtualcarriersenseattacks,whichcaneasilydisablethewirelessconnectionswithPDAs.Martinovicetal.proposedtwodifferentandnovelattacksagainstweb-basedauthenti-cationinwirelessenvironment[20].The(cid:2)rstattackissimi-lartotherogueAPattackinordertohijackwirelessclients,whiletheotherattackwasbasedonthewell-knownARP978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
22
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:58:48 UTC from IEEE Xplore.  Restrictions apply. 
spoo(cid:2)ng.Itisapopulardirectiontousemodelcheckerstoau-tomatically(cid:2)ndvulnerabilitiesinprotocols[21(cid:150)23,25].Narayanaetal.usedTLA+toautomatically(cid:2)ndvulnera-bilitiesinWiMaxinitialrangingandauthenticationprocess.Mitchelletal.usedthe(cid:2)nite-stateveri(cid:2)cationtools,Murφ,toanalyzeauthenticationprotocolssuchasSSL,EAP-GPSKandothers[21(cid:150)23].Amongthem,EAP-GPSKanalysis[23]ismostrelatedtoourwork.TheDenial-of-Serviceattackin[23]alsospoofsmessagestoconfusetheauthenticationentitiesandstopstheauthenticationprocess.ItissimilarinprincipletoourattacksonTLSbasedEAPprotocols,butdiffersmuchintherealimplementation.WhileMitchelletal.mainlyworkedonthetheoreticalanalysisandproof,ourworkfocusmoreonthepracticalsideanduserealexperi-mentstodemonstratetheeffectivenessoftheattacks.Mean-while,insteadofstudyingprotocolscasebycasewiththesamemethodology,wetendtoidentifyonepotentialvulner-ablecomponentindifferentprotocols,i.e.,theexceptionhan-dlewitherrormessages.8ConclusionInthispaper,weproposetheexceptiontriggereddenial-of-serviceattacksonwirelesssecurityprotocols.Theattacksexplorethevulnerabilitiesintheexceptionhandlingprocessinsecurityprotocols,i.e.,blindlyacceptingerrormessagesandterminatingthecommunicationimprudently.Wedemon-stratedtheeffectoftheseattacksontwocasestudies:TLS-basedEAPprotocolsandtheReturnRoutabilityprocedureofMobileIPv6protocol.Usingreal-worldexperimentsandtestbedexperimentsweprovethesuccessandthepracti-calityoftheattacks,withoff-the-shelfhardwaresandwell-writtensoftwaresavailableonline.Wealsoproposeadetec-tionschemeandprotocolimprovementprincipleagainsttheexceptiontriggeredbasedattacks.Realimplementationandexperimentsdemonstratetheeffectoftheproposedcounter-measures.9AcknowledgmentWewouldliketothankanonymousreviewersfortheirvaluablecomments.ThisworkwasmainlysupportedbyagrantfromNU-MotorolaCenterforSeamlessCommunica-tionandtwoNSFawardsCT-0627715andCNS-0613967.Anyopinions,(cid:2)ndings,andconclusionsorrecommendationsexpressedinthismaterialarethoseoftheauthorsanddonotnecessarilyre(cid:3)ecttheviewsofthefundingsources.References[1]Aircrack-ng.http://aircrack-ng.org.[2]LORCONlibrary-LOssofRadioConnectivity.http://802.11ninja.net/lorcon.[3]Madwi(cid:2)OpenSourceDriver.http://madwifi.org/.[4]MIPL:Mobileipv6forlinux.http://www.mipl.mediapoli.com/.[5]TheNetworkSimulator-ns-2.http://www.isi.edu/nsnam/ns/.[6]WPASupplicant.http://hostap.epitest.fi/wpa_supplicant/.[7]IEEEStandardforWirelessLANMediumAccessControl(MAC)andPhysicalLayer(PHY)Speci(cid:2)cations,1999.[8]MicrosoftPEAPversion0,2002.http://www.watersprings.org/pub/id/draft-kamath-pppext-peapv0-00.txt.[9]B.Aboba,L.Blunk,J.Vollbrecht,J.Carlson,andE.H.Lev-kowetz.ExtensibleAuthenticationProtocol(EAP).RFC3748,Jun.2004.[10]J.ArkkoandH.Haverinen.ExtensibleAuthenticationPro-tocolMethodfor3rdGenerationAuthenticationandKeyAgreement(EAP-AKA).RFC4187,Jan.2006.[11]J.BellardoandS.Savage.802.11denial-of-serviceattacks:Realvulnerabilitiesandpracticalsolutions.InUSENIXSecu-ritySymposium,2003.[12]N.Cam-Wingetandet.al.TheFlexibleAuthenticationviaSecureTunnelingExtensibleAuthenticationProtocolMethod(EAP-FAST).RFC4851,May.2007.[13]T.DierksandE.Rescorla.TheTransportLayerSecurity(TLS)ProtocolVersion1.1.RFC4346,Apr.2006.[14]W.Dif(cid:2)eandM.E.Hellman.Newdirectionsincryptography.IEEETransactionsonInformationTheory,22(6),1976.[15]P.FunkandS.Blake-Wilson.ExtensibleAuthenticationPro-tocolTunneledTransportLayerSecurityAuthenticatedPro-tocolVersion0(EAP-TTLSv0).RFC5281,Aug.2008.[16]E.H.HaverinenandE.J.Salowey.ExtensibleAuthenticationProtocolMethodforGlobalSystemforMobileCommunica-tions(GSM)SubscriberIdentityModules(EAP-SIM).RFC4186,Jan.2006.[17]Y.Hu,A.Perrig,andD.J.P.leashes.Adefenseagainstworm-holeattacksinwirelessnetwork.InIEEEInfocom,2003.[18]D.Johnson,C.Perkins,andJ.Arkko.MobilitySupportinIPv6.RFC3775,Jun.2004.[19]C.LiuandJ.T.Yu.AnanalysisofdosattacksonwirelessLAN.InIASTEDInternationalConferencesonWirelessNet-worksandEmergingTechnologies(WNET2006),2006.[20]I.Martinovicandet.al.Phishinginthewireless:Implementa-tionandanalysis.InIFIPInternationalInformationSecurityConference,2007.[21]J.Mitchell,V.Shmatikov,andU.Stern.Finite-stateanalysisofSSL3.0.InUSENIXSecuritySymposium,1998.[22]J.C.Mitchell,M.Mitchell,andU.Stern.Automatedanaly-sisofcryptographicprotocolsusingmurphi.InIEEESymp.SecurityandPrivacy,1997.[23]J.C.Mitchell,A.Roy,P.Rowe,andA.Scedrov.AnalysisofEAP-GPSKauthenticationprotocol.InACNS,2008.[24]A.MondalandA.Kuzmanovic.Apoisoning-resilienttcpstack.InIEEEICNP2007,Beijing,China,2007.[25]P.Narayanaandet.al.AutomaticvulnerabilitycheckingofIEEE802.16WiMAXprotocolsthroughTLA+.InWorkshoponSecureNetworkProtocols(NPSec),2006.[26]G.NoubirandG.Lin.LowpowerDoSattacksindatawire-lessLANsandcountermeasures.ACMSIGMOBILEMobileComputingandCommunicationsReview,7(3),2003.[27]V.Paxson.Bro:Asystemfordetectingnetworkintrudersinreal-time.ComputerNetworks,31,1999.[28]M.Roesch.Snort:Thelightweightnetworkintrusiondetec-tionsystem,2001.http://www.snort.org/.[29]D.Simon,B.Aboba,andR.Hurst.TheEAP-TLSAuthenti-cationProtocol.RFC5216,Mar.2008.[30]H.Tschofenigandet.al.TheExtensibleAuthenticationProtocol-InternetKeyExchangeProtocolversion2(EAP-IKEv2)Method.RFC5106,Jan.2008.[31]W.Xu,W.Trappe,Y.Zhang,andT.Wood.Thefeasibilityoflaunchinganddetectingjammingattacksinwirelessnet-works.InMobiHoc,2005.[32]Y.Zhao,S.Vemuri,J.Chen,Y.Chen,H.Zhou,andZ.J.Fu.Exceptiontriggeddosattacksonwirelessnetworks.Techni-calReportNWU-EECS-08-13,Univ.ofNorthwestern,Dec.2008.http://cs.northwestern.edu/∼yzhao/.