bined in arbitrary ways; JFK, in contrast, takes the approach
of using ciphersuites, similar to the SSL/TLS protocols[10].
(cid:15) IKEv2 supports legacy authentication mechanisms (in par-
ticular, pre-shared keys). JFK does not, by design, support
other authentication mechanisms, as discussed in Section 3;
while it is easy to do so (and we have a variant of JFKr that
can do this without loss of security), we feel that the added
value compared to the incurred complexity does not justify
the inclusion of this feature in JFK.
Apart from these main differences, there are a number of superﬁ-
cial ones (e.g., the “wire” format) which are more a matter of taste
than of difference in protocol design philosophy. The authors of
the two proposals have helped create a joint draft[19], submitted
to the IETF IPsec Working Group. In that draft, a set of design
options reﬂecting the differences in the two protocols is presented
to the working group. Concurrent with the writing of this paper,
and based on this draft, a uniﬁed proposal is being written. This
uniﬁed proposal combines properties from both JFK and IKEv2. It
adopts the approach of setting up a security association within two
round trips, while providing DoS protection for the responder (and,
in particular, allowing the responder to be almost completely state-
less between the sending of message 2 and the receipt of message
3.)
565.3 Other Protocols
The predecessor to IKE, Photuris[24], ﬁrst introduced the con-
cept of cookies to counter “blind” denial of service attacks. The
protocol itself is a 6-message variation of the Station to Station
protocol. It is similar to IKE in the message layout and purpose,
except that the SA information has been moved to the third mes-
sage. For re-keying, a two-message exchange can be used to re-
quest a uni-directional SPI (thus, to completely re-key, 4 messages
are needed). Photuris is vulnerable to the same computation-based
DoS attack as IKE, mentioned above. Nonetheless, one of the vari-
ants of this protocol has 4 messages and provided DoS protection
via stateless cookies.
SKEME[27] shares many of the requirements for JFK, and many
aspects of its design were adopted in IKE. It serves more as a set of
protocol building blocks, rather than a speciﬁc protocol instance.
Depending on the speciﬁc requirements for the key management
protocol, these blocks could be combined in several ways. An in-
teresting aspect of SKEME is its avoidance of digital signatures;
public key encryption is used instead, to provide authentication as-
surances. The reason behind this was to allow both parties of the
protocol to be able to repudiate the exchange.
SKIP[5] was an early proposal for an IPsec key management
mechanism. It uses long-term Difﬁe-Hellman public keys to derive
long-term shared keys between parties, which is used to distribute
session keys between the two parties. The distribution of the ses-
sion key occurs in-band, i.e., the session key is encrypted with the
long-term key and is injected in the encrypted packet header. While
this scheme has good synchronization properties in terms of re-
keying, the base version lacks any provision for PFS. It was later
provided via an extension [4]. However, as the authors admit, this
extension detracts from the original properties of SKIP. Further-
more, there is no identity protection provided, since the certiﬁcates
used to verify the Difﬁe-Hellman public keys are (by design) pub-
licly available, and the source/destination master identities are con-
tained in each packet (so that a receiver can retrieve the sender’s
Difﬁe-Hellman certiﬁcate). The latter can be used to mount a DoS
attack on a receiver, by forcing them to retrieve and verify a Difﬁe-
Hellman certiﬁcate, and then compute the Difﬁe-Hellman shared
secret.
The Host Identity Payload (HIP)[38] uses cryptographic public
keys as the host identiﬁers, and introduces a set of protocols for es-
tablishing SAs for use in IPsec. The HIP protocol is a four-packet
exchange, and uses client puzzles to limit the number of sessions
an attacker can initiate. HIP also allows for reuse of the Difﬁe-
Hellman value over a period of time, to handle a high rate of ses-
sions. For re-keying, a HIP packet protected by an existing IPsec
session is used. HIP does not provide identity protection, and it de-
pends on the existence of an out-of-band mechanism for distribut-
ing keys and certiﬁcates, or on extra HIP messages for exchanging
this information (thus, the message count is effectively 6, or even
8, for most common usage scenarios).
6. CONCLUSION
Over the years, many different key exchange protocols have been
proposed. Some have had security ﬂaws; others have not met cer-
tain requirements.
JFK addresses the ﬁrst issue by simplicity, and by a proof of
correctness. (Again, full details of this are deferred to the analy-
sis paper.) We submit that proof techniques have advanced enough
that new protocols should not be deployed without such an anal-
ysis. We also note that the details of the JFK protocol changed in
order to accommodate the proof: tossing a protocol over the wall to
the theoreticians is not a recipe for success. But even a proof of cor-
rectness is not a substitute for simplicity of design; apart from the
chance of errors in the formal analysis, a complex protocol implies
a complex implementation, with all the attendant issues of buggy
code and interoperability problems.
The requirements issue is less tractable, because it is not possi-
ble to foresee how threat models or operational needs will change
over time. Thus, StS is not suitable for an environment where de-
nial of service attacks are a concern. Another comparatively-recent
requirement is identity protection. But the precise need — whose
identity should be protected, and under what threat model — is still
unclear, hence the need for both JFKi and JFKr.
Finally, and perhaps most important, we show that some attributes
often touted as necessities are, in fact, susceptible to a cost-beneﬁt
analysis. Everyone understands that cryptographic primitives are
not arbitrarily strong, and that cost considerations are often used in
deciding on algorithms, key lengths, block sizes, etc. We show that
DoS-resistance and perfect forward secrecy have similar character-
istics, and that it is possible to improve some aspects of a protocol
(most notably the number of round trips required) by treating others
as parameters of the system, rather than as absolutes.
7. ACKNOWLEDGEMENTS
Ran Atkinson, Matt Crawford, Paul Hoffman, and Eric Rescorla
provided useful comments, and discussions with Hugo Krawczyk
proved very useful. Dan Harkins suggested the inclusion of IPI
in the authenticator. David Wagner made useful suggestions on the
format of Message (2) in JFKi. The design of the JFKr protocol
was inﬂuenced by the SIGMA and IKEv2 protocols.
8. REFERENCES
[1] A. Arsenault and S. Farrell. Securely available credentials -
requirements. Request for Comments 3157, Internet
Engineering Task Force, Aug. 2001.
[2] T. Aura and P. Nikander. Stateless connections. In Proc. of
International Conferenec on Information and
Communications Security (ICICS ’97), Lecture Notes in
Computer Science volume 1334, pages 87–97. Springer,
November 1997.
[3] T. Aura, P. Nikander, and J. Leiwo. DOS-resistant
authentication with client puzzles. In Proc. of the 8th
International Workshop on Security Protocols, April 2000.
[4] A. Aziz. SKIP extension for perfect forward secrecy (PFS).
Internet Draft, Internet Engineering Task Force, August
1996.
[5] A. Aziz and M. Patterson. Simple Key Management for
Internet Protocols (SKIP). In Proc. of the 1995 INET
conference, 1995.
[6] M. Bellare and P. Rogaway. Entity Authentication and Key
Distribution. In Proc. of the Crypto conference, August 1993.
[7] R. Canetti and H. Krawczyk. Analysis of Key-Exchange
Protocols and Their Use for Building Secure Channels. In
Proc. of the Eurocrypt conference, May 2001.
[8] R. Canetti and H. Krawczyk. Security Analysis of IKE’s
Signature-based Key-Exchange Protocol. In Proc. of the
Crypto conference, August 2002.
[9] CERT. Advisory CA-96.21: TCP SYN Flooding, September
1996. ftp://info.cert.org/pub/cert advisories/CA-
96.21.tcp syn ﬂooding
[10] T. Dierks and C. Allen. The TLS protocol version 1.0.
Request for Comments (Proposed Standard) 2246, Internet
Engineering Task Force, January 1999.
57[11] W. Difﬁe, P. van Oorschot, and M. Wiener. Authentication
[28] H. Krawczyk. The IKE-SIGMA Protocol.
and Authenticated Key Exchanges. Designs, Codes and
Cryptography, 2:107–125, 1992.
http://www.ee.technion.ac.il/˜hugo/sigma.html, November
2001.
[12] N. Ferguson and B. Schneier. A Cryptographic Evaluation of
[29] H. Krawczyk, M. Bellare, and R. Canetti. HMAC:
IPSec.
http://www.counterpane.com/ipsec.html.
[13] L. Gong. Efﬁcient Network Authentication Protocols: Lower
Bounds and Optimal Implementations. Distributed
Computing, 9(3):131–145, 1995.
[14] D. Gustafson, M. Just, and M. Nystrom. Securely available
credentials - credential server framework. Internet Draft,
Internet Engineering Task Force, Aug. 2001. Work in
progress.
[15] D. Harkins and D. Carrel. The Internet Key Exchange (IKE).
Request for Comments (Proposed Standard) 2409, Internet
Engineering Task Force, November 1998.
[16] D. Harkins, C. Kaufman, S. Kent, T. Kivinen, and
R. Perlman. Proposal for the IKEv2 Protocol. Internet Draft,
Internet Engineering Task Force, April 2002. Work in
progress.
[17] L. Heberlein and M. Bishop. Attack Class: Address
Spooﬁng. In Proceedings of the 19th National Information
Systems Security Conference, pages 371–377, October 1996.
[18] S. Hirose and K. Matsuura. Enhancing the resistance of a
provably secure key agreement protocol to a
denial-of-service attack. In Proc. of the 2nd International
Conference on Information and Communication Security
(ICICS ’99), pages 169–182, November 1999.
[19] P. Hoffman. Features of Proposed Successors to IKE.
Internet Draft, Internet Engineering Task Force, April 2002.
Work in progress.
[20] IEEE. Entity authentication mechanisms — part 3: Entity
authentication using asymmetric techniques. Technical
Report ISO/IEC IS 9798-3, ISO/IEC, 1993.
[21] M. Jakobsson and A. Juels. Proofs of work and bread
pudding protocols. In Proc. of the IFIP TC6 and TC11 Joint
Working Conference on Communications and Multimedia
Security, September 1999.
[22] P. Janson, G. Tsudik, and M. Yung. Scalability and ﬂexibility
in authentication services: the KryptoKnight approach. In
Proc. of IEEE INFOCOM, pages 725–736, April 1997.
[23] A. Juels and J. Brainard. Client puzzles: A cryptographic
countermeasure against connection depletion attacks. In
Proc. of the Network and Distributed Systems Security
Symposium (NDSS ’99), pages 151–165, February 1999.
[24] P. Karn and W. Simpson. Photuris: Session-key management
protocol. Request for Comments 2522, Internet Engineering
Task Force, Mar. 1999.
[25] C. Kaufman et al. Code-preserving Simpliﬁcations and
Improvements to IKE. Internet Draft, Internet Engineering
Task Force, July 2001. Work in progress.
[26] C. Kaufman and R. Perlman. Analysis of IKE. In IEEE
Transactions on Network Computing,, November 2000.
[27] H. Krawczyk. SKEME: A Versatile Secure Key Exchange
Mechanism for Internet. In Proc. of Network and Distributed
System Security Symposium (NDSS), February 1996.
keyed-hashing for message authentication. Request for
Comments 2104, Internet Engineering Task Force, February
1997.
[30] J. Leiwo, P. Nikander, and T. Aura. Towards network denial
of service resistant protocols. In Proc. of the 15th
International Information Security Conference (IFIP/SEC),
August 2000.
[31] K. Matsuura and H. Imai. Resolution of ISAKMP/Oakley
key-agreement protocol resistant against denial-of-service
attack. In Proc. of Internet Workshop (IWS ’99), pages
17–24, February 1999.
[32] K. Matsuura and H. Imai. Modiﬁed aggressive mode of
Internet key exchange resistant against denial-of-service
attacks. IEICE Transactions on Information and Systems,
E83-D(5):972–979, May 2000.
[33] D. Maughan, M. Schertler, M. Schneider, and J. Turner.
Internet security association and key management protocol
(ISAKMP). Request for Comments (Proposed Standard)
2408, Internet Engineering Task Force, Nov. 1998.
[34] C. Meadows. Analysis of the Internet Key Exchange
protocol using the NRL protocol analyzer. In Proc. of the
IEEE Symposium on Security and Privacy, pages 216–231,
May 1999.
[35] C. Meadows. A formal framework and evaluation method for
network denial of service. In Proc. of the 12th IEEE
Computer Security Foundations Workshop, pages 4–13, June
1999.
[36] C. Meadows. Open issues in formal methods for
cryptographic protocol analysis. In Proc. of DARPA
Information Survivability Conference and Exposition
(DISCEX 2000), pages 237–250. IEEE Computer Society
Press, January 2000.
[37] S. P. Miller, B. C. Neuman, J. I. Schiller, and J. H. Saltzer.
Kerberos Authentication and Authorization System.
Technical report, MIT, December 1987.
[38] R. Moskowitz. The Host Identity Payload. Internet Draft,
Internet Engineering Task Force, July 2001. Work in
progress.
[39] R. Oppliger. Protecting key exchange and management
protocols against resource clogging attacks. In Proc. of the
IFIP TC6 and TC11 Joint Working Conference on
Communications and Multimedia Security (CMS ’99), pages
163–175, September 1999.
[40] C. Schuba, I. Krsul, M. Kuhn, E. Spafford, A. Sundaram, and
D. Zamboni. Analysis of a denial of service attack on tcp. In
IEEE Security and Privacy Conference, pages 208–223, May
1997.
[41] Y. Sheffer, H. Krawczyk, and B. Aboba. PIC, a pre-IKE
credential provisioning protocol. Internet Draft, Internet
Engineering Task Force, Nov. 2001. Work in progress.
[42] W. A. Simpson. IKE/ISAKMP Considered Harmful.
USENIX ;login:, December 1999.
58