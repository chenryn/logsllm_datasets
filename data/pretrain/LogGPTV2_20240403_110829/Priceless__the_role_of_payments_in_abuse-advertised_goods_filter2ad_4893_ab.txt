a bank, sometimes working with a merchant account broker) and
then sell a payment processing service that launders transactions
through this network of shell accounts. In practice, all these and
many other combinations of relationships exist (and different rules
can apply in different operating regions as well), but the underlying
ﬁve-party transaction is consistent across all embodiments.
Merchant costs
From the merchant’s point of view, the goal is to obtain the lowest
overhead and highest reliability they can in their risk class. Over-
head is described in terms of the discount rate charged by the ser-
vice provider in exchange for processing services and is a percent-
age charged against all revenue. Thus, while a low-risk retail mer-
chant processing cards at the point of sale might be able to ﬁnd
an ISO willing to provide service for a discount rate of under 2%,
a third-party aggregator catering to high-risk clients might charge
10% or more. Providers will frequently have different discount rate
structures for different kinds of transactions based on their risk pro-
ﬁle, but in the high-risk category it is common to ignore these dis-
tinctions. In addition to the discount rate, the merchant typically
pays monthly fees (e.g., for access to an Internet-based payment
5In some cases, the acquiring bank may even “rent” BINs to a large
ISO (so-called super-ISOs) who then act as de facto acquirers.
gateway, for individual virtual terminals for entering card numbers,
etc.) plus per-transaction fees (up to $2 in the high-risk category).
As well, providers differ in how quickly they make payments
available to merchants and in the high-risk category most will “hold
back” a percentage of revenue as a residual hedge against future li-
ability. These holdbacks are particularly important since most card
associations allow cardholders to contest a transaction many months
after settlement and if a merchant “disappears” the acquiring bank
is responsible for the cost of this chargeback and the associated
fees. Thus, it is common practice for high-risk account providers
to hold back 10% of revenue for between 90 to 180 days to cover
unforeseen losses. The provider in turn can use this money to cover
any ﬁnes or assessments and, should there be a complaint of crimi-
nality, a merchant can stand to lose this sum entirely.
Thus, a merchant must also be careful to minimize the number
of chargebacks (both for the chargeback fees incurred as well as
the additional scrutiny imposed on accounts with high chargeback
rates). For example, in a recent study of several fake anti-virus pro-
grams, Stone-Gross et al. document how refund requests are ma-
nipulated to keep the monthly chargeback rate underneath “trig-
ger” levels [15]. As well, sellers of goods must be careful to ﬁlter
out fraudulent customers and thus even merchants selling strictly il-
legal goods such as counterfeit software will employ sophisticated
fraud screening before processing a payment.6
2.3 Payment interventions
In our 2011 paper on the spam value chain, we empirically doc-
umented that for many of the most popular spam-advertised mar-
ket niches (pharmaceuticals, replica luxury goods and counterfeit
software) payments were handled by a small number of acquiring
banks (just three were used to monetize the sites advertised by over
95% of spam e-mails in the study [10]). This concentration, in ad-
dition to the small number of acquirers accepting high-risk mer-
chants, the long setup time for new banking relationships, and the
liability on revenue holdback, makes the payment tier an attractive
target for those seeking to combat such actions. To wit: a miscreant
can replace a suspended domain name within minutes at a cost of
a few dollars, but if a banking relationship is shuttered they may
lose hundreds of thousands of dollars in holdback and spend weeks
developing a suitable replacement. This observation has been in-
ternalized and made independently by a number of stakeholders,
culminating in a series of commercial interventions that motivate
this paper.
Regulatory tightening
Effective in June of 2011, Visa made a series of changes to their
operating regulations in support of their Global Brand Protection
Program (GBPP) that seem designed to speciﬁcally target on-line
pharmacies and sellers of counterfeit goods. First, pharmaceutical-
related MCC’s (5122 and 5912) were explicitly classiﬁed as “high
risk” (along with gambling and various kinds of direct marketing
services), acquirers issuing new contracts for high-risk e-commerce
merchants required signiﬁcant due diligence (including $100M in
equity capital and good standing in risk management programs)
and, starting in December 2011, additional registration of PSPs and
ISOs dealing in high-risk products and services. As well, the new
documents explicitly call out examples of illegal transactions in-
cluding “Unlawful sale of prescription drugs” and “Sale of coun-
6This screening includes matching geo-located consumer IP ad-
dress, shipping address and credit card address, proﬁling on e-mail
address, country of access and so on (see [5] for one treatment of
these issues). In our experience, the most common fraud scoring
software among such shops is that provided by MaxMind.
847terfeit or trademark-infringing products or services”, among oth-
ers [17]. Finally, these changes include a more aggressive ﬁne sched-
ule and, implicitly, represent a statement of more aggressive en-
forcement actions to be forthcoming.
Targeted complaints
As per the above regulations (and similar regulations at Master-
Card), acquiring banks in violation of these rules can be subject to
a range of ﬁnes (greatly increased in the new GBPP, and increasing
with each additional round of violations). As the ultimate threat,
non-compliant banks, ISOs and PSPs could have their ability to is-
sue merchant accounts and services taken away completely.
At roughly the same time (mid to late 2010), a series of nego-
tiations between brand holders, payment providers and the White
House’s Intellectual Property Enforcement Coordinator established
agreements to streamline targeted actions against merchant accounts
used to monetize counterfeit goods and services [1, 7]. Through this
effort, individual brand holders can submit evidence of infringe-
ment (e.g., from undercover purchases of their products placed via
online sites) to the card networks, who then identify the associated
acquiring bank and request remediation (on penalty of ﬁnes and
further action for continued or additional non-compliance). More-
over, in addition to the independent actions of brand holders, the
International Anti-Counterfeiting Coalition (IACC) announced a
larger-scale initiative in September of 2011 [3, 13]. This program,
open to all IACC members, provides a standard portal by which
brandholders can report infringing e-commerce sites. IACC, with
their contractors and the card networks, implements the legwork of
identifying merchant accounts used to monetize reported sites and
managing the formal complaint process through the card networks.
In the remainder of this paper, we characterize the longitudinal
relation between afﬁliate programs and their acquiring banks as
well as the impact of the interventions discussed above—both in
the large and in individual campaigns diligently driven by speciﬁc
brand holders.
3. METHODOLOGY
Our work builds on our previous efforts in Levchenko et al. [10],
in which we actively identiﬁed the acquiring banks used to pro-
cess consumer orders from Web sites sponsored by particular afﬁli-
ate programs. This task thus comprises two parts: afﬁliate program
identiﬁcation and payment tracking.
In contrast to this previous work, we are not concerned with au-
tomatically classifying arbitrary Web pages and thus it is sufﬁcient
for us to identify a small number of reference sites sponsored by
each program.7 While there is still no “silver bullet” approach for
identifying such sites, the combination of our own domain knowl-
edge and the open nature of most afﬁliate programs substantially
helped our efforts. For each program identiﬁed in Levchenko et al.,
we already have a long list of reference sites as well as a hand-
crafted classiﬁer for identifying the template structure of the sites
advertised by each program [10].8 We also identiﬁed a number of
7In principle, one might be concerned that different sites advertis-
ing the same program might process payments differently, but mul-
tiple studies conﬁrm that the afﬁliate program sponsor centralizes
payment handling in such arrangements [6, 10, 11].
8For example, trustedtablets-online.com is a well-known site be-
longing to the RXPartners afﬁliate program, identiﬁed by name on
its afﬁliate forum, but also via a range of features including the
brand name (trusted tablets), the phone support numbers, structural
elements in the HTML code, the live-support referrer ﬁelds, the
structure of its cookies and its offsite billing page (checkoutpage-
secure.com) among others.
new programs by monitoring underground forums [12], since new
programs must advertise to acquire new afﬁliates [11]. From these
we then identiﬁed representative sites either from forum-documen-
ted “public” sites or by joining the program as an afﬁliate (and thus
obtaining reference templates that can be matched against search
or spam-advertised sites). Finally, we beneﬁt from the efforts of in-
dependent researchers such as XyliBox [19] and members of the
criminal and civil investigations community who have shared data
with us on request. Taken together, we were able to identify 40 dif-
ferent programs (25 focused on pharmaceutical sales and 15 on the
sale of counterfeit “OEM” software). We try to use the “ofﬁcial”
names for each program, but when we could not make this deter-
mination we instead use the most predominant storefront “brand”
advertised as a proxy.
Having obtained these representative sites, we are next inter-
ested in tying the afﬁliate program to a particular acquiring bank
at a particular point in time. Here too we continue the approach of
Levchenko et al., where we placed 76 credit card purchases over
three months and then worked with the issuing bank to identify
the individual acquirers used in each transaction. We build on this
dataset working in partnership with multiple payment card issuing
institutions who have provided us with full transactional data for
each purchase. Thus, in addition to the Bank Identiﬁcation Number
(BIN) for the acquiring institution on both authorization and settle-
ment, we also receive the textual order descriptor, the Card Accep-
tor ID (an acquirer-unique identiﬁer for the merchant) and the coun-
try in which the acquirer resides (among other quantities). We fol-
low closely the operational guidelines outlined in Kanich et al. [5]
for successfully placing such orders (e.g., distinct IP addresses,
geo-located to match shipping address, geo-located to match dis-
tinct phone numbers, etc.).9
For this paper, we focus on a subset of this dataset comprising
pharmaceutical and OEM software afﬁliate programs.10 Together,
this combined dataset includes 676 ordering attempts, of which 429
were successful, covering over two years of activity. Table 1 lists
the afﬁliate programs we engaged with and our purchasing activity
with them.
Our dataset has a number of limitations, which we make clear
here. First, all of our orders (both the original 76 from Levchenko
et al. and the subsequent purchases) are obtained using the Visa
card network. Thus, our results do not capture information relating
to the other major open loop card player, MasterCard. However,
for reasons that are not completely clear, MasterCard merchant
accounts appear much harder to obtain for pharmaceutical afﬁli-
ates [11]. Indeed, at any given point in time only a small minority
of the programs we studied had working MasterCard processing
available. The second major limitation is that our samples are nei-
ther uniform nor do they always cover the same period of time. In
particular, we did not start our recent study for some time after the
original 76 purchases and thus there is a large gap between roughly
April of 2011 and August of 2011 during which few orders were
placed. Similarly, we examine a number of additional programs for
which we, by deﬁnition, have no prior history. As well, while we
attempted to place orders at least once a month for each program,
this was not always possible due to the operational complexities
of obtaining new credit cards, IP addresses and phone numbers as
9Our purchasing activity has been explicitly reviewed and ap-
proved by our institution and we believe that the value of our work
outweighs the relatively minor ethical concerns resulting from the
small ﬁnancial support provided to these programs through the few
thousand dollars worth of our purchases.
10We also explored a range of fake anti-virus and replica goods pro-
grams, but with insufﬁcient ﬁdelity to include in this analysis.
848well as churn in program sites and temporary interruptions in pro-
cessing. Finally, as we will describe later, it is clear that a subset of
the programs have become far better at counter-intelligence on such
undercover purchases and thus some subset of our refusals may not
be due to true payment processing problems but an active attempt
to “blind” such measurements.
In addition to our own ordering data set, we also have the beneﬁt
of third-party information as well. In particular, we became aware
of targeted complaint activity driven by particular brand holders
starting in November of 2011. In a large number of these instances
we have been able to obtain key information (combining data from
brand holders and ﬁnancial services) about when particular com-
plaints were made—providing an empirical basis for a natural ex-
periment examining the impact of these payment-oriented interven-
tions. We present a subset of this data, consisting of roughly 170
complaints against the merchant accounts of over 25 distinct afﬁli-
ate programs.
Finally, we also obtained qualitative data by continuously mon-
itoring related underground forums focused on the pharmaceutical
and OEM software niches, as well as the afﬁliate “news” pages for
roughly a dozen of the programs that we joined. These sources al-
lowed us to capture anecdotal reports both from individual afﬁliates
concerning their revenue impact and from afﬁliate program man-
agers who would inform their afﬁliates about the challenges that
they were experiencing. Thus, this data provides a form of validity
check on the conclusions we reach from analyzing the empirical
purchasing and complaint data alone.
4. ANALYSIS
Using the data we have described, we now examine how afﬁli-
ate programs rely upon the global banking infrastructure to process
payment card transactions. Speciﬁcally, we examine which banks
are used to support these activities over time, how the afﬁliate pro-
grams are distributed and concentrated among the banks, the strate-
gies that the programs employ in using banking resources while
balancing risk and overhead, and how the programs react to pres-
sure such as active takedown interventions.
4.1 Aggregate bank activity
In aggregate, we executed 429 orders from 25 pharmaceutical
and 15 software afﬁliate programs. These in turn were processed
through 30 acquiring banks: 25 distinct banks processing for phar-
maceutical programs, 15 banks processing for software programs,
and 10 banks processing for both. Five of the banks we saw only
processed one or two purchases in less than a month, and appear to
be banks that the afﬁliate programs used on a trial basis but where
the business relationship was not successful.11 Discounting these
banks, we found 25 banks supporting the card processing activities
of the 40 programs combined.
Examining how these banks are used over time reveals some in-