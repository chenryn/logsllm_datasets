24 (NIST, 2022), https://csrc.nist.gov/glossary/term/cyber_threat
25 (NIST, 2022), https://csrc.nist.gov/glossary/term/threat_actor
26 (NIST, 2022), https://csrc.nist.gov/glossary/term/vulnerability
27 (NakedSecurity - Sophos, 2021), https://nakedsecurity.sophos.com/2021/12/10/log4shell-java-vulnerability-how-to-safeguard-your-
servers/
28 (Apache, 2022), https://logging.apache.org/log4j/2.x/
29 (NIST, 2022), https://nvd.nist.gov/vuln-metrics/cvss
30 (Webopedia, 2021), https://www.webopedia.com/definitions/input-sanitization/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 35
Made in Morocco
Penetration Testing with Kali Linux
provide the user with access or privileges that they aren’t supposed to have, and when they are
pursued deliberately and maliciously, the user’s actions become an exploit.31
The word exploit in cybersecurity can be used as both a noun and as a verb. As a noun, an exploit
is a procedure for abusing a particular vulnerability. As a verb, to exploit a vulnerability is to
perform the procedure that reliably abuses it.
Let’s wrap up this section by exploring attack surfaces and vectors. An attack surface32 describes
all the points of contact on our system or network that could be vulnerable to exploitation. An
attack vector33 is a specific vulnerability and exploitation combination that can further a threat
actor’s objectives. Defenders attempt to reduce their attack surfaces as much as possible, while
attackers try to probe a given attack surface to locate promising attack vectors.
3.2.3 Threat Actor Classifications
y
The previous section introduced threats and threat actors. Cybersecurity professionals are chiefly
interested in threat actors since typically, most threats that our systems, networks, and
k
enterprises are vulnerable to are human. Some key attributes of cybercrime compared to physical
crime include its relative anonymity, the ability to execute attacks at a distance, and (typically) a
lack of physical danger and monetary cost. s
There are a wide variety of threat actors. Different people and groups have various levels of
o
technical sophistication, different resources, personal motivations, and a variety of legal and
moral systems guiding their behavior. While we cannot list out every kind of threat actor, there are
several high-level classifications to keep in nmind:
Individual Malicious Actors: On the most superficial level, anyone attempting to do something that
they are not supposed to do fits intoi this category. In cybersecurity, malicious actors can explore
digital tactics that are unintendezd by developers, such as authenticating to restricted services,
stealing credentials, and defacing websites.
D
The case of Paige Thompson34 is an example of how an individual attacker can cause extreme
amounts of damage and loss. In July 2019, Thompson was arrested for exploiting a router which
had unnecessarily high privileges to download the private information of 100 million people from
Capital One. This attack lead to the loss of personal information including SSNs, account
numbers, addresses, phone numbers, email addresses, etc.
This attack35 was partly enabled by a misconfigured Web Application Firewall (WAF) that had
excessive permissions allowing it to list and read files. The attack could have been prevented36 by
applying the principle of least privilege and verifying correct configuration of the WAF. Since the
attacker posted about their actions on social media, another mitigation could have been social
media monitoring.
31 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Exploit_(computer_security)
32 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Attack_surface
33 (Wikipedia, 2022), https://en.wikipedia.org/wiki/Attack_vector
34 (DOJ, 2019), https://www.justice.gov/usao-wdwa/pr/former-seattle-tech-worker-convicted-wire-fraud-and-computer-intrusions
35 (Krebs, 2019), https://krebsonsecurity.com/2019/08/what-we-can-learn-from-the-capital-one-hack/
36 (EJJ, 2019), https://ejj.io/blog/capital-one
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 36
Made in Morocco
Penetration Testing with Kali Linux
Malicious Groups: When individuals band together to form groups, they often become stronger
than their individual group members. This can be even more true online because the ability to
communicate instantly and at vast distances enables people to achieve goals that would have
been impossible without such powerful communication tools. For example, the ability to quickly
coordinate on who-does-what over a instant messaging services is just as valuable to malicious
cyber groups as it is to modern businesses. Malicious groups can have any number of goals, but
are usually more purposeful, organized, and resourceful than individuals. Thus, they are often
considered to be one of the more dangerous threat actors.
Let’s examine an example of a group-led attack. Over the span of a number of months, the
“Lapsus$”37 group performed a number of attacks on a wide range of companies, stealing
proprietary information and engaging in extortion. These attacks resulted in a loss of corporate
data - including proprietary data such as source code, schematics, and other documentation. The
attacks further resulted in the public exposure of data, and financial losses for companies that
y
submitted to extortion.
The variety and sophistication of techniques used by the group show how this kind of malicious
k
actor can be so dangerous. In particular, individuals within a group can bring their own specialties
to the table that people working alone wouldn’t be able to leverage. In addition, they can launch
s
many different types of attacks at targets at a volume and velocity that an individual wouldn’t be
able to. There’s a common truism in the cybersecurity industry that the attacker only needs to
succeed once, while the defender must succeed oevery time. The efficacy of groups of attackers
highlights this asymmetry.
n
There are also only a few targeted mitigations available for such a wide variety of attack vectors.
Because recruiting employees was one of the techniques used, awareness of internal threat
actors and anomaly detection are key. Palo Alto Networks38 additionally suggests focusing on
i
security best practices such as MFA, access control, and network segmentation.
z
Insider Threats: Perhaps one of the most dangerous types of threat actor, an insider threat is
anyone who already has prDivileged access to a system and can abuse their privileges to attack it.
Often, insider threats are individuals or groups of employees or ex-employees of an enterprise
that become motivated to harm it in some capacity. Insider threats can be so treacherous
because they are usually assumed to have a certain level of trust. That trust can be exploited to
gain further access to resources, or these actors may simply have access to internal knowledge
that isn’t meant to be public.
During a PPE shortage in March 202039 at the beginning of the COVID-19 pandemic, Christopher
Dobbins, who had just been fired as Vice President of a medical packaging company, used a fake
account that he had created during his employment to access company systems and
change/delete data that was critical to the company’s distribution of medical supplies.
This attack resulted40 in the delayed delivery of critical medical supplies at a crucial stage of the
pandemic and the disruption of the company’s broader shipment operations. The danger of an
insider threat is showcased clearly here. The attack was enabled by a fake account created by a
37 (Avertium, 2022), https://www.avertium.com/resources/threat-reports/in-depth-look-at-lapsus
38 (Palo Alto Networks, 2022), https://unit42.paloaltonetworks.com/lapsus-group/#Mitigation-Actions
39 (DOJ, 2020), https://www.justice.gov/usao-ndga/pr/former-employee-medical-packaging-company-sentenced-federal-prison-
disrupting-ppe
40 (ZDnet, 2021), https://www.zdnet.com/article/disgruntled-former-vp-hacks-company-disrupts-ppe-supply-earns-jail-term/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 37
Made in Morocco
Penetration Testing with Kali Linux
vice-president, who may have had access to more permissions than what might be considered
best practice for a VP of Finance.
This attack likely could have been prevented by applying the principle of least privilege, which we’ll
explore in a later section. Since the attack was enabled by a fake account, it also could have been
prevented by rigorously auditing accounts. Lastly, since this activity was performed after the VPs
termination, better monitoring of anomalous activity may have also prevented or mitigated the
attack.
Nation States: Although international cyber politics, cyber war, and digital intelligence are vast
subjects and significantly beyond the scope of this Module, we should recognize that some of the
most proficient, resourceful, and well-financed operators of cyber attacks exist at the nation-state
level within many different countries across the globe.
Since 2009, North Korean threat actors, usually grouped under the name Lazarus,41 have engaged
y
in a number of different attacks ranging from data theft (Sony, 2014), to ransomware (WannaCry,
2017) to financial theft targeting banks (Bangladesh Bank, 2016) and cryptocurrencies - notably,
k
the 2022 Axie Infinity attack. These attacks have resulted in the loss and leak of corporate data,
including proprietary data (Sony) and financial losses for companies that paid a ransom.
s
An information assurance firm called NCC Group42 suggests the following steps to prevent or
mitigate attacks from the Lazarus group: network segmentation, patching and updating internet
o
facing resources, ensuring the correct implementation of MFA, monitoring for anomalous user
behavior (example: multiple, concurrent sessions from different locations), ensuring sufficient
logging, and log analysis. n
3.2.4 Recent Cybersecurity Breaches
i
While the above section focusedz on who performs attacks, in this section we’ll cover different
kinds of breaches that have occured in the last few years. We’ll analyze some more recent
cybersecurity attacks, discuDss the impact they had on enterprises, users, and victims, and then
consider how they could have been prevented or mitigated.
There are many examples of recent breaches to choose from. For each breach, we’ll indicate the
kind of attack that allowed the breach to occur. This list by no means represents a complete
survey of all types of attacks, so instead we’ll aim to provide a survey highlighting the scope and
impact of cybersecurity breaches.
Social Engineering: Social Engineering represents a broad class of attacks where an attacker
persuades or manipulates human victims to provide them with information or access that they
shouldn’t have.
In July 2021, attackers used a social engineering technique called spearphishing43 to gain access
to44 an internal Twitter45 tool that allowed them to reset the passwords of a number of high-profile
accounts. They used these accounts to tweet promotions of a Bitcoin scam. The impacts of this
41 (NCCGroup, 2022), https://www.nccgroup.com/us/the-lazarus-group-north-korean-scourge-for-10-years/
42 (NCCGroup, 2022), https://www.nccgroup.com/us/the-lazarus-group-5-measures-to-reduce-the-risk-of-an-attack/
43 (CrowdStrike, 2022), https://www.crowdstrike.com/cybersecurity-101/phishing/spear-phishing/
44 (BBC, 2020), https://www.bbc.com/news/technology-53607374
45 (Twitter, 2020), https://blog.twitter.com/en_us/Modules/company/2020/an-update-on-our-security-incident
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 38
Made in Morocco
Penetration Testing with Kali Linux
attack included financial losses for specific Twitter users, data exposure for a number of high-
profile accounts, and reputational damage to Twitter itself.
To understand potential prevention and mitigation, we need to understand how and why the
attack occurred. The attack began with phone spearphishing and social engineering, which
allowed attackers to obtain employee credentials and access to Twitter’s internal network. This
could have been prevented had employees been better equipped to recognize social engineering
and spearphishing attacks. Additional protections that could have prevented or mitigated this
attack include limiting access to sensitive internal tools using the principle of least privilege and
increased monitoring for anomalous user activity.
Phishing: Phishing is a more general class of attack relative to spearphishing. While
spearphishing attacks are targeted to specific individuals, phishing is usually done in broad
sweeps. Phishing strategy is usually to try to send a malicious communication to as many people
as possible, inreasing the likelihood of a victim clicking a link or othyerwise doing something that
would compromise security.
k
In September 2021, a subsidiary of Toyota acknowledged that they had fallen prey to a Business
Email Compromise (BEC)46 phishing scam. The scam resulted in a transfer of ¥ 4 billion (JPY),
equivalent to roughly 37 million USD, to the scammer’s asccount. This attack occurred because an
employee was persuaded to change account information associated with a series of payments.
o
The United States Federal Bureau of Investigation (FBI)47 recommends these and other steps be
taken to prevent BEC:
n
• Verify the legitimacy of any request for payment, purchase or changes to account
information or payment policies in person.
i
• If this is not possible, verify legitimacy over the phone.
z
• Be wary of requests that indicate urgency.
• Carefully inspect emaiDl addresses and URLs in email communications.
• Do not open email attachments from people that you do not know.
• Carefully inspect the email address of the sender before responding.
Ransomware: Ransomware is a type of malware that infects computer systems and then locks a
legitimate user from accessing it properly. Often, users are contacted by the attacker and asked
for a ransom in order to unlock their machine or documents.
In May 2021, a ransomware incident48 occurred at Colonial Pipeline, a major American oil
company. The attack lead to the disruption of fuel distribution for multiple days. This attack
resulted in a loss of corporate data, the halting of fuel distribution, millions of dollars in
ransomware payments, increased fuel prices, and fuel shortage fears.
46 (Forbes, 2019), https://www.forbes.com/sites/leemathews/2019/09/06/toyota-parts-supplier-hit-by-37-million-email-
scam/?sh=30c5dafa5856
47 (FBI, 2022), https://www.fbi.gov/scams-and-safety/common-scams-and-crimes/business-email-compromise
48 (ZDNet, 2021), https://www.zdnet.com/article/colonial-pipeline-ransomware-attack-everything-you-need-to-know/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 39
Made in Morocco
Penetration Testing with Kali Linux
In this attack, hackers gained access to Colonial Pipeline’s network with a single compromised
password. This attack could have been prevented49 or at least made less likely by ensuring that
MFA was enabled on all internet-facing resources, as well as by prohibiting password reuse.
Credential Abuse: Credential Abuse can occur when an attacker acquires legitimate credentials,
allowing them to log into machines or services that they otherwise would not be able to. Often,
attackers are able to guess user passwords because they are predictable or weak.
In December 2020,50 a series of malicious updates had been discovered in the SolarWinds Orion
platform, an infrastructure monitoring and management tool. These malicious updates allowed
malware to be installed on the environment of any SolarWinds customer that installed this update
and led to the compromise of a number of these customers, including universities, US
government agencies, and other major organizations.
As a supply-chain attack, this attack affected approximately 18,000 SolarWinds customers and
y
led to the breach of a subset of customers including government agencies and other major
companies. According to former SolarWinds CEO Kevin Thompson, this attack resulted from a
k
weak password51 that was accidentally exposed publicly on Github. This attack could have been
prevented52 by ensuring that passwords are sufficiently strong and by monitoring the internet for
leaked secrets. CISA has also stated that this attack scould have been mitigated by blocking
outbound internet traffic from SolarWinds Orion servers.
o
Authentication Bypass: While Credential Abuse allows attackers to log in to services by legitimate
means, Authentication Bypasses can allow attackers to ignore or step-around intended
authentication protocols. n
Similar to the above SolarWinds attack, on July 2 202153 an attack was detected that took
advantage of a vulnerability in sioftware vendor Kaseya’s VSA remote management tool.
Attackers were able to bypass thze authentication system of the remote tool to eventually push
REvil ransomware from compromised customer Virtual System Administrator (VSA) servers to
endpoints via a malicious uDpdate.
Since this attack targeted a number of Managed Service Providers (MSPs), its potential scope
encompassed not only the MSP customers of Kaseya, but also the customers of those MSPs.
According to Brian Krebs,54 this vulnerability had been known about for at least three months
before this ransomware incident. This attack could have been prevented by prioritizing and fixing
known vulnerabilities in an urgent and timely manner.
3.3 The CIA Triad
This Learning Unit covers the following Learning Objectives:
• Understand why it’s important to protect the confidentiality of information
49 (CISA, 2022), https://www.cisa.gov/stopransomware/how-can-i-protect-against-ransomware
50 (BBC, 2020), https://www.bbc.com/news/technology-55321643
51 (ZDNet, 2021), https://www.zdnet.com/article/solarwinds-security-fiasco-may-have-started-with-simple-password-blunders/
52 (SC Media, 2021), https://www.scmagazine.com/news/security-news/could-better-cyber-hygiene-have-prevented-the-solarwinds-
attack
53 (ZDNet, 2021), https://www.zdnet.com/article/updated-kaseya-ransomware-attack-faq-what-we-know-now/
54 (Krebs, 2021), https://krebsonsecurity.com/2021/07/kaseya-left-customer-portal-vulnerable-to-2015-flaw-in-its-own-software/
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 40
Made in Morocco
Penetration Testing with Kali Linux
• Learn why it’s important to protect the integrity of information
• Explore why it’s important to protect the availability of information
In order to understand offensive techniques, we need to understand the principles defenders
should follow so that we can quickly identify opportunities to exploit their mistakes. Similarly,
good defenders will benefit from understanding how attackers operate, including what kinds of
biases and errors they are prone to.
One of the models often used to describe the relationship between security and its objects is
known the CIA triad. CIA stands for Confidentiality, Integrity, and Availability. Each of these is a
desirable property of the things we might want to secure, and each of these three properties can
be attacked. Most (though not all) attacks against computer systems and networks will threaten
one of these attributes. Let’s begin with a high level overview before we dive into each one:
• Confidentiality: Can actors who should not have access to the syystem or information access
the system or information?
k
• Integrity: Can the data or the system be modified in some way that is not intended?
• Availability: Are the data or the system accessible when and how they are intended to be?
s
It is also important to note that in some cases, we may be far more concerned with one aspect of
the CIA triad than others. For instance, if someoneo has a personal journal that contains their most
secret thoughts, the confidentiality of the journal may be far more important to the owner than its
integrity or its availability. In other words, they may not be as concerned about whether someone
n
can write to the journal (as opposed to reading it) or whether or not the journal is always
accessible.
i
On the other hand, if we are securing a system that tracks medical prescriptions, the integrity of
z
the data will be most critical. While it is important to prevent other people from reading what
medications someone uses and it is important that the right people can access this list of
medications, if someone wDere able to change the contents of the system, it could lead to life-
threatening results.
When we are securing a system and an issue is discovered, we will want to consider which of
these three concepts, or which combination of them, the issue impacts. This helps us understand
the problem in a more comprehensive manner and allows us to categorize the issues and
respond accordingly.
3.3.1 Confidentiality
A system is Confidential if the only people that can access it are the people explicitly permitted to
do so. A person’s social media account credentials are considered confidential as long as the
user’s password is known only to the owner. If a hacker steals or guesses the password and they
can access the account, this would constitute an attack against confidentiality. Common attacks
against confidentiality include network eavesdropping55 and credential stuffing.56
55 (Wikipedia, 2021), https://en.wikipedia.org/wiki/Network_eavesdropping
56 (Wikipedia, 2021), https://en.wikipedia.org/wiki/Credential_stuffing
PWK - Copyright © 2023 OffSec Services Limited. All rights reserved. 41
Made in Morocco
Penetration Testing with Kali Linux