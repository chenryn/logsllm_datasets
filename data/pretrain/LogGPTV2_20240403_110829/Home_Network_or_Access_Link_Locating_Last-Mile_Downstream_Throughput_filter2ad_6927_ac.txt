a
r
F
1.0
0.8
0.6
0.4
0.2
0.0
0
Access link
Wireless
20
90
10
Downstream access link throughput bins (Mbps)
60
40
50
30
70
80
s
t
s
e
t
e
v
i
t
i
s
o
p
f
o
n
o
i
t
c
a
r
F
1.0
0.8
0.6
0.4
0.2
0.0
0
Access link
Wireless
20
90
10
Downstream access link throughput bins (Mbps)
70
30
60
80
40
50
(a) BISmark deployment.
(b) FCC deployment.
Fig. 6. Prevalence of access link and wireless bottlenecks home networks the two
deployments deployment. When downstream access-link throughput exceeds about
20 Mbps, only about 20 % of last-mile bottlenecks occur on the access link.
3.1 Prevalence of Last-Mile Bottlenecks
In this section, we explore the prevalence of downstream throughput bottlenecks
in access links versus home wireless networks using HoA. Speciﬁcally, we study
the fraction of tests for which HoA identiﬁes downstream throughput bottle-
necks, and to what extent these bottlenecks are caused by the access link versus
the home wireless network.
We perform more than 50,000 tests over a wide range operating conditions
in the ﬁeld. HoA identiﬁes downstream throughput bottlenecks in 55 % of tests
in the BISmark deployment and 47 % of tests in the FCC deployment. When
HoA does not detect a bottleneck, the underlying cause may be low demand
or bottlenecks being elsewhere in the network (e.g., at a peering point). As
expected, homes with access-link throughput less than 10 Mbps experience the
largest fraction of throughput bottlenecks; 55 % of tests detect a bottleneck.
The fraction of tests where HoA detects a bottleneck, however, remains close to
40 % even for homes with access-link throughput above 90 Mbps. In the rest of
this section, we further characterize the tests where HoA detects a downstream
throughput bottleneck.
Figure 6a plots the fraction of downstream throughput bottlenecks in the
BISmark deployment that are located either in the access link or in the home
wireless network. We group home networks into bins of 10 Mbps according to
120
S. Sundaresan et al.
the measured downstream throughput of their access links. The results show
that many throughput bottlenecks in the BISmark deployment are due to the
wireless network. Our analysis of the bottlenecks per home in the BISmark
deployment shows that the fraction of wireless bottlenecks varies signiﬁcantly
across homes even for homes with similar access-link throughput. For example,
homes with access-link throughput less than 20 Mbps had wireless bottlenecks in
between 3–58 % of downstream throughput bottlenecks, and 11–83 % of down-
stream throughput bottlenecks. By default, we conﬁgured these home routers to
use 802.11n, which can support signiﬁcantly higher rates. The default 802.11n
conﬁguration supports frame rates of up to 130 Mbps (we observed about 85–
90 Mbps over TCP), while 802.11 g supports only framerates up to 54 Mbps.
The fact that these networks are experiencing throughput bottlenecks suggests
persistent problems with home wireless network deployments in practice.
Figure 6b shows the same results for the FCC deployment. First, access-link
bottlenecks only occur frequently for home networks with downstream access
throughput less than 20 Mbps. Homes with access throughput less than 10 Mbps
experience access-link bottlenecks in about 66 % of cases; however this fraction
drops rapidly as access throughput increases: for homes with access through-
put between 10 and 20 Mbps about 40 % of downstream throughput bottlenecks
are due to access-link bottlenecks, whereas for homes with access links exceed-
ing 20 Mbps access-link bottlenecks explain only about 20 % of downstream
throughput bottlenecks. Conversely, wireless throughput bottlenecks become
more prevalent in homes with higher access throughput: 33 % of downstream
throughput bottlenecks for homes with throughput less than 10 Mbps are due
to wireless bottlenecks; 40 % of the bottlenecks are in the wireless network for
homes with 10–20 Mbps access throughput; and, nearly 80 % of the bottlenecks
are in the wireless network when access throughput exceeds 20 Mbps. That wire-
less throughput bottlenecks occur even for access links with such low speeds is
surprising: the FCC access points support 802.11n, with default frame bitrates
of up to 130 Mbps and a maximum frame bitrate of 300 Mbps. Some users had
conﬁgured their routers to 802.11g, and those users did experience lower through-
put. Yet, 802.11g comprised only 10 % of all tests, so most of the problems that
we observed occurred even with 802.11n.
In about 8 % of downstream throughput bottlenecks in homes with access-link
throughput less than 10 Mbps, HoA indicates that both the wireless network and
the access link are introducing throughput bottlenecks. In principle, this should
not occur as, by deﬁnition, there can be only one bottleneck. The prevalence of
this result for primarily low-throughput access links suggests that in these cases,
at least one device in the home network may be experiencing poor wireless
conditions in conjunction with an access-link bottleneck.
3.2 Wireless Bottlenecks Within a Home
The previous section demonstrated that wireless bottlenecks are common; in
cases where wireless bottlenecks exist, at least one device in the home experi-
ences a wireless throughput bottleneck during the tests. For about 75 % of tests
Locating Last-Mile Downstream Throughput Bottlenecks
121
when HoA detects a wireless bottleneck, we only observe traﬃc for one device in
the home. For the remaining 25 % of tests with a wireless bottleneck, we investi-
gate whether the active devices experience a downstream throughput bottleneck
in the wireless network simultaneously. Simultaneous throughput bottlenecks in
the wireless network to independent devices might indicate a more systemic prob-
lem (e.g., pervasive interference, poor signal from the access point, contention),
whereas isolated throughput bottlenecks are more likely to indicate a problem
with a particular device. About half of the cases we observed involve throughput
bottlenecks that are isolated to a single device; in another 45 % of cases, all of
the devices in the home simultaneously experience a throughput bottleneck.
4 Related Work
HoA draws inspiration from several previous diagnosis techniques. Zhang
et al. developed T-RAT [22] to analyze TCP performance. T-RAT estimates
TCP parameters such as maximum segment size, round-trip time, and loss to
understand ﬂow behavior. Katabi et al. [11], used entropy in packet interarrival
time to estimate shared bottlenecks. Biaz et al. [3] used packet interarrival times
for distinguishing between diﬀerent kinds of losses. HoA is similar to some of the
approaches used in these papers (e.g., it uses packet interarrival time as input
to a detector for access link bottlenecks), but we tailor our approach so that
it only relies on data that can be easily collected from a home router. Previ-
ous work has studied broadband access performance [4,8,9,20]. In particular,
Sundaresan et al. [20] study residential access performance from home routers
(also using the FCC Broadband America dataset). There have also been many
previous approaches to diagnosing wireless networks. One approach is to deploy
passive traﬃc monitors throughout the network to diagnose wireless patholo-
gies [1,2,6,15,16] or to study wireless performance [14]. Kanuparthy et al. [10]
developed a tool to detect common wireless pathologies (such as low signal-to-
noise ratio, congestion, and hidden terminals) by using both active probes and an
additional passive monitor deployed within the network. Kim et al. [12] analyze
wireless metrics such as frame bitrates, frame ACKs and retransmission rates to
identify root causes of wireless performance problems. Other approaches have
monitored wireless networks with custom hardware [5,13,16–18]. Unfortunately,
it is diﬃcult to deploy multiple monitoring points or custom hardware in many
home networks, since it requires deploying equipment beyond what a normal user
is typically willing to install or have installed in their home. Other eﬀorts have
characterized home networks in terms of connected devices and usage [7,19].
None of these studies, however, have studied how often the home network
constraint downstream throughput.
5 Conclusion
To identify performance bottlenecks in home networks, we developed an algo-
rithm and tool, HoA, that passively observes traﬃc ﬂows between the home net-
work and the access network to determine the location of last-mile downstream
122
S. Sundaresan et al.
throughput bottlenecks. Our prototype deployment of HoA in 2,652 home net-
works shed new light on the prevalence of downstream throughput bottlenecks
in both home networks and access networks. We ﬁnd that when the downstream
throughput of a user’s access link exceeds about 20 Mbps, a high fraction of
throughput bottlenecks are caused by the user’s home wireless network. This
ﬁnding is signiﬁcant in light of recent proposed regulations to change the def-
inition of broadband Internet access to increasingly higher speeds. Our study
opens several avenues for future work. First, we need methods to identify root
causes that explain why various wireless performance problems exist in addi-
tion to where they are. Second, a follow-up to HoA could attribute problems
that home network users experience to a more complete and more speciﬁc set of
causes.
Acknowledgments. We thank the FCC and SamKnows for helping us develop and
deploy HoA in the Measuring Broadband America (MBA) platform. We also acknowl-
edge the participants of the MBA platform. We would like to thank our shepherd,
Mahesh K. Marina, and the reviewers for their helpful comments. This work was
supported by NSF awards CNS-1535796, CNS-1539906, and CNS-1213157, and the
European Communitys Seventh Framework Programme (FP7/2007–2013) no. 611001
(User-Centric Networking).
References
1. Adya, A., Bahl, P., Chandra, R., Qiu, L.: Architecture and techniques for diag-
nosing faults in IEEE 802.11 infrastructure networks. In: MobiCom, pp. 30–44,
Philadelphia, PA (2004)
2. Ahmed, N., Ismail, U., Keshav, S., Papagiannaki, K.: Online estimation of RF
interference. In: ACM CoNEXT, Madrid, Spain, December 2008
3. Biaz, S., Vaidya, N.H.: Discriminating congestion losses from wireless losses using
inter-arrival times at the receiver. In: IEEE Symposium on Application - Speciﬁc
Systems and Software Engineering and Technology (ASSET), Washington, DC,
USA (1999)
4. Canadi, I., Barford, P., Sommers, J.: Revisiting broadband performance. In: ACM
SIGCOMM Internet Measurement Conference (IMC), October 2012
5. Cheng, Y., Bellardo, J., Benko, P., Snoeren, A.C., Voelker, G.M., Savage, S.: Jigsaw:
solving the puzzle of enterprise 802.11 analysis. In: Proceedings of ACM SIGCOMM,
Pisa, Italy, August 2006
6. Cheng, Y.C., Afanasyev, M., Verkaik, P., Benk¨o, P., Chiang, J., Snoeren, A.C.,
Savage, S., Voelker, G.M.: Automating cross-layer diagnosis of enterprise wireless
networks. SIGCOMM Comput. Commun. Rev. 37(4), 25–36 (2007)
7. Cioccio, L.D., Teixeira, R., Rosenberg, C.: Measuring home networks with Home-
Net proﬁler. In: Roughan, M., Chang, R. (eds.) PAM 2013. LNCS, vol. 7799,
pp. 176–186. Springer, Heidelberg (2013)
8. Croce, D., En-Najjary, T., Urvoy-Keller, G., Biersack, E.: Capacity estimation of
ADSL links. In: Proceedings of CoNEXT, December 2008
9. Dischinger, M., Haeberlen, A., Gummadi, K.P., Saroiu, S.: Characterizing residen-
tial broadband networks. In: Proceedings of ACM SIGCOMM Internet Measure-
ment Conference, San Diego, CA, USA, October 2007
Locating Last-Mile Downstream Throughput Bottlenecks
123
10. Kanuparthy, P., Dovrolis, C., Papagiannaki, K., Seshan, S., Steenkiste, P.: Can
user-level probing detect and diagnose common home-WLAN pathologies. SIG-
COMM Comput. Commun. Rev. 42(1), 7–15 (2012)
11. Katabi, D., Blake, C.: Inferring congestion sharing and path characteristics from
packet interarrival times. Technical report MIT-LCS-TR-828, Massachusetts Insti-
tute of Technology (2002)
12. Kim, K.H., Nam, H., Schulzrinne, H.: WiSlow: a Wi-Fi network performance trou-
bleshooting tool for end users. In: IEEE INFOCOM, pp. 862–870 (2014)
13. Lakshminarayanan, K., Sapra, S., Seshan, S., Steenkiste, P.: RFdump: an architec-
ture for monitoring the wireless ether. In: Proceedings of the 5th International Con-
ference on Emerging Networking Experiments and Technologies, CoNEXT 2009,
pp. 253–264 (2009)
14. Mahajan, R., Rodrig, M., Wetherall, D., Zahorjan, J.: Analyzing the mac-level
behavior of wireless networks in the wild. In: SIGCOMM 2006, pp. 75–86 (2006)
15. Niculescu, D.: Interference map for 802.11 networks. In: ACM SIGCOMM Internet
Measurement Conference, pp. 339–350, San Diego, California, USA, October 2007
16. Rayanchu, S., Mishra, A., Agrawal, D., Saha, S., Banerjee, S.: Diagnosing wireless
packet losses in 802.11: separating collision from weak signal. In: INFOCOM 2008,
The 27th Conference on Computer Communications, April 2008, pp. 735–743.
IEEE (2008)
17. Rayanchu, S., Patro, A., Banerjee, S.: Catching whales and minnows using
WiFiNet: deconstructing non-WiFi interference using wiﬁ hardware. In: USENIX
NSDI, San Jose, CA
18. Rayanchu, S., Patro, A., Banerjee, S.: Airshark: detecting non-WiFi RF devices
using commodity wiﬁ hardware. In: ACM SIGCOMM Internet Measurement Con-
ference, pp. 137–154, Berlin, Germany (2011)
19. S´anchez, M.A., Otto, J.S., Bischof, Z.S., Bustamante, F.E.: Trying broadband char-
acterization at home. In: Roughan, M., Chang, R. (eds.) PAM 2013. LNCS, vol.
7799, pp. 198–207. Springer, Heidelberg (2013)
20. Sundaresan, S., de Donato, W., Feamster, N., Teixeira, R., Crawford, S., Pescap`e,
A.: Broadband internet performance: a view from the gateway. In: ACM SIG-
COMM, Toronto, Ontario, Canada, August 2011
21. tcptrace: A TCP connection analysis tool. http://irg.cs.ohiou.edu/software/
tcptrace/
22. Zhang, Y., Breslau, L., Paxson, V., Shenker, S.: On the characteristics and origins
of internet ﬂow rates. In: Proceedings of ACM SIGCOMM, Pittsburgh, PA, August
2002