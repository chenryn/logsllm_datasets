scope, which can be expanded outside the EU. Speciﬁcally,
the GDPR applies to “the processing of personal data of
data subjects who are in the (European) Union”, regardless of
whether the processing takes place in the (European) Union,
or whether the processor locates in the (European) Union.
C. GDPR’s Impact on Domain Registration
Due to its wide protection scope, the GDPR has introduced
a profound impact on Internet applications relying on personal
data. For example, websites are required to ask for explicit
consent before setting browser cookies [42]. Because domain
registration collects information of registrants and other per-
sonnel, it is within the scope of the GDPR.
ICANN Temporary Speciﬁcation. To ﬁll the gap between the
GDPR’s high-level requirement and low-level implementation
of data protection, ICANN released a Temporary Speciﬁcation
for gTLD Registration Data [11] on 17 May 2018, which is one
week before the GDPR effective date. The document applies to
all gTLD registry operators and ICANN-accredited registrars,
and aims to maintain the accessibility of the current WHOIS
system “to the greatest extent possible”. It retains the current
registration data collection procedure, thus domain holders still
provide their personal information to registrars. However, a
WHOIS provider must take additional steps when releasing
domain registration data (e.g., replying to WHOIS queries),
if it is: 1) located in the European Economic Area (EEA),
2) located outside the EEA but offers registration services to
registrants in the EEA, or 3) engaging a data processor in
the EEA. Table I provides a summary of the requirements,
covering data subjects of registrants, admin, tech and other2.
Particularly, before the GDPR, WHOIS privacy protection
services (e.g., WhoisGuard [15]) have been used by plenty
of registrars to hide registrants’ information from spammers,
marketing ﬁrms and online fraudsters. Such services install
an anonymous proxy identity for a registrant in the WHOIS
database. When all ﬁelds in Table I are masked by the proxy,
no additional changes are needed to comply with GDPR.
Regarding the scope, the ICANN Temporary Speciﬁcation
gives WHOIS providers ﬂexibility to choose whether the
2Billing contact is not mentioned in the speciﬁcation (it is different from
“other”). We ﬁnd it is rarely released in WHOIS records, so we neglect it in
the following analysis.
3
Fig. 2: Overview of WHOIS data collection and GCChecker
protection applies in a global basis or GDPR-governed regions
only. In other words, it is acceptable if a provider chooses
to release the original WHOIS data of domain holders living
outside the EEA. In the remainder of this paper, we use EEA
domains and EEA records to refer to domains registered by
EEA registrants and WHOIS records associated with these
domains. Non-EEA domains and records are deﬁned similarly.
III. METHODOLOGY
In this study, we aim to assess at scale whether WHOIS
providers comply with the GDPR, in particular the ICANN
Temporary Speciﬁcation. We are also interested in how data
protection is actually enforced. However, answering those
research questions is non-trivial, as WHOIS data is not well
structured and WHOIS providers can apply any data redaction
method. In this section, we elaborate on our methodology of
WHOIS data collection and GDPR compliance analysis (i.e.,
GCChecker). Figure 2 overviews the key steps.
A. WHOIS Data Collection
We aim to provide a longitudinal (before and after the
GDPR effective date) and latitudinal (covering a wide range of
WHOIS providers) view of the GDPR’s impact on domain reg-
istration. To this end, we collaborate with an Internet security
company and leverage its historical WHOIS dataset for this
study. The company maintains a passive DNS service (similar
to Farsight DNSDB [48]) for threat hunting, which aggregates
DNS requests and responses logged by afﬁliated DNS resolvers
across regions. When a domain name is newly observed (i.e.,
being queried by an Internet user), the system will attempt to
fetch its WHOIS record. For domain names under TLDs using
the “thin WHOIS” model (i.e., .com, .net and .jobs), their
WHOIS records are collected from registrars. For domains
under other TLDs, the WHOIS records are collected from
registries. Occasionally, for example when domains are about
to expire, the system re-fetches their WHOIS records to obtain
updates. The WHOIS data collection system has been in
operation since 2016, and we use the data spanning from Jan
2018 to Dec 2019 (2 years).
Parsing WHOIS records. The standard document of
WHOIS [40] only speciﬁes its transport mechanisms, yet in
practice providers do not agree on the format of WHOIS
records [34]. The lack of consensus signiﬁcantly hampers
large-scale analysis of WHOIS data [70], especially for TLDs
adopting the “thin WHOIS” model. To address this issue,
open-source and commercial WHOIS parsers have proposed
template-based (e.g., Ruby Whois [10]),
rule-based (e.g.,
pythonwhois [17]) and statistical approaches (e.g., [70]). Our
industrial partner uses a template-based method, where hun-
dreds of WHOIS templates are manually created for different
WHOIS providers. The templates are also regularly reviewed
Fig. 3: (a) A WHOIS record after parsing (only technical
and registrant ﬁelds are shown), (b) the WHOIS string after
preprocessing (Steps I and II described in Section III-B).
to accommodate format changes. Figure 3(a) shows a snippet
of a parsed WHOIS record.
Based on our deﬁnitions of (non-)EEA records (in Sec-
tion II), a WHOIS record is identiﬁed as a (non-)EEA record,
if its registrant country is one of the (non-)EEA countries. The
ICANN Temporary Speciﬁcation does not suggest redaction of
registrant country information, and we ﬁnd that most WHOIS
providers are following this rule based on empirical analysis3.
Before the next steps, we remove all WHOIS records without
registrant country information (e.g., being redacted or having
format errors, which cover around 12.7% records).
Table II presents the statistics of our parsed WHOIS
dataset, after removing records without registrant country
information. The dataset contains 1.2 billion WHOIS records
of 267 million domain names. Both newly-registered and
older domains (e.g., 13% domains are created before 2010)
are included. Around 12% domains are EEA domains and over
67% records are collected from registrar WHOIS servers.
Limitations. Our industrial partner collects WHOIS records of
domains observed in its passive DNS dataset, which might be
biased due to the geo-location of the afﬁliated resolvers. While
we acknowledge this limitation, our evaluation shows that the
dataset has a satisfactory coverage of domain names globally
(219 countries and 12% EEA domains) and a wide range of
TLDs (783 in total). We believe the results obtained from
this dataset are representative. Another limitation is that the
records are only collected from WHOIS servers by querying
port 43. In the meantime, web interfaces of providers are
not examined and there is a chance that WHOIS data is
not sanitized there. However, web-based WHOIS are often
protected by CAPTCHA which prevents data collection [54],
[64], thus in this paper we focus on port-43 WHOIS services.
3We check all 194.6M WHOIS records collected in Jan, Apr, Jul and Oct
2019, which belong to 726 WHOIS providers. Only 10 providers (e.g., the
.name registry) prevent us to extract registrant country from any of their
WHOIS record. Among 632 (87%) providers we extract registrant country
information from over 90% records.
4
Year
2018
2019
Total
Count of
Record
Domain
659,184,231
583,179,357
1,242,363,588
211,614,203
215,772,034
267,634,833
TABLE II: Statistics of the parsed WHOIS dataset
∼’09
Domain Creation Date
’10∼’17
’18∼’19
#
758
15.7%
14.5%
754
13.4% 49.7% 36.9% 783
58.5%
42.4%
25.8%
44.1%
.net
Domain TLD
.com
#
64.2% 6.58% 5.28% 218
66.5% 6.19% 4.71% 219
63.8% 6.19% 4.74% 219
.org
Registrant Region
Data Source
non-EEA Registrars Registries
EEA
87.1%
12.9%
12.4%
87.5%
12.2% 87.8%
35.3%
29.9%
32.8%
64.7%
70.1%
67.2%
Fig. 4: Cumulative distribution of 50 selected WHOIS
providers and ratio of unprotected WHOIS records in DG.
B. GDPR Compliance Analysis
The major goal of this study is to assess whether the EEA
records released by WHOIS providers follow the requirements
of the GDPR and ICANN Temporary Speciﬁcation. To this
end, we take the EEA records collected from each provider as
a whole and analyze its degree of compliance.
Dataset for empirical analysis. We inspect a sample of 50
WHOIS providers (40 registrars and 10 registries) to gain
insights into how they process WHOIS data. The providers are
selected by their share of registered domains (see Appendix A,
they account for over 50% of the total share) and by having a
large number of EEA records (over 1,000 records collected per
month). For each provider, we randomly sample 1,000 EEA
records collected in Dec 2019 (50,000 records in total) and
manually label each record by whether its contact information
(i.e., all ﬁelds listed in Table I) is protected. This dataset
(termed as DG) serves as ground truth for our system design.
Among the 50,000 records in DG, 5,647 (11.3%) are
labeled as unprotected. Figure 4 shows the cumulative dis-
tribution of the 50 providers’ ratio of unprotected records in
DG. We ﬁnd a knee around 5% unprotected records – 84%
(42 of 50) providers have a lower ratio, and we can spot clear
data protection measures in their released records. Later we use
this observation to assign three compliance levels to WHOIS
providers (described in Step IV).
Technical Challenge. To protect personal data, instructions
of the ICANN Temporary Speciﬁcation are not strict: it asks
the redacted ﬁelds to be replaced by values substantially
similar to “redacted for privacy”,
instead of requiring the
use of the exact string. From DG we also ﬁnd redacted
ﬁelds under different wording and languages, which deters
automated textual analysis. Below are some examples:
● “privacidad WHOIS” (in Spanish)
● “obfuscated WHOIS”
● “statutory masking enabled”
As a result, learning whether a WHOIS ﬁeld is redacted
under the GDPR becomes a difﬁcult task. Simply matching
keywords in each ﬁeld will lead to a high error rate.
Fig. 5: Outlier ratio and GDPR compliance. The ratio is an
indicator of WHOIS records containing unprotected data.
Insight on WHOIS textual similarity. While scanning each
individual WHOIS record and checking its compliance is error-
prone and time-consuming, we ﬁnd that by computing the
statistical distribution of WHOIS record values per provider,
we can tell whether it complies with the GDPR and the
level of compliance. Our key observation from DG is that
a GDPR-compliant WHOIS provider prefers to use simple
and automated approaches to replace record values at scale,
resulting in high homogeneity of the values, especially on EEA
domains. Otherwise, the values are expected to be diversiﬁed
because they contain information of different registrants. As a
result, the redacted records should form big clusters with zero
or a small number of outliers (i.e., samples that do not belong
to any cluster). Figure 5 illustrates this insight, where each
dot represents a WHOIS record after vectorization. Inspired
by this observation, we leverage clustering algorithm and use
outlier ratio as an indicator of GDPR compliance. We ﬁnd that
this approach works generally well but sometimes a domain
holder can register a bulk of domains which can also form a
cluster. We apply a lightweight NLP-based approach to ﬁlter
such clusters (described in Step III). We design GCChecker
based on this insight, which contains the following steps.
Step I: Grouping WHOIS records. We ﬁrst group the
WHOIS records according to their providers. If the provider
is a registry, we group them by their WHOIS servers4. If
the provider is a registrar, we group them by their regis-
trar IDs. For each accredited registrar, ICANN assigns a
unique numerical ID [18], which is included in every WHOIS
record (see Figure 3, ﬁeld “iana_id”). In this step we also
remove records under drop-catch registrars (e.g., ID-17565
DropCatch.com LLC and ID-1008 SnapNames, LLC). The
main reason is that drop-catch registrars will put their domains
on auction or proactively register domains without getting a
back-order [61]. As a result, their WHOIS records can be
intentionally ﬁlled with similar values (e.g., “domain on sale”)
without any relation to a real registrant.
4We obtain a list of registry WHOIS servers from the IANA Root Zone
Database [19]. The ﬁeld “whois_server” of parsed WHOIS records is
checked against the list.
5We use ID-1756 to refer to the registrar whose ID is 1756.
5
0.00.20.40.60.81.00.40.60.81.0Ratio of WHOIS providersRatio of unprotected WHOIS recordsNext, we separate each group by time windows (e.g.,
weeks) to study its changing dynamics. The WHOIS records
within each window are further grouped according to their
registrants’ regions (i.e., EEA and non-EEA) and data subjects
(i.e., registrant, admin and tech contacts). In the end, each
WHOIS record is associated with a main key, and records
under different keys are analyzed separately. The main key
is a quadruple:
(provider, registrant region, data subject, time window)
Under a main key, we only ﬁll
to the embedded data subject. Note that
in the ﬁelds that are
relevant
in each
time window we only use the “current” version of WHOIS
records (i.e., records collected in this time window) to identify
their registrant region and provider. Because WHOIS records
in each time window are analyzed separately, the system is
not affected by the drift of domain ownership (e.g., domain
transferring).
Step II: Preprocessing ﬁeld values. Before clustering WHOIS
records and assessing their homogeneity, we preprocess the
ﬁelds of each record to make clustering more efﬁcient and
effective. In detail, we concatenate the values of ﬁelds that
should be masked (e.g., registrant name, phone and email,
listed in Table I) using tab characters to produce a single string
and convert it to lower case. Figure 3(b) shows an example of
the output string, which we call WHOIS string. If the value