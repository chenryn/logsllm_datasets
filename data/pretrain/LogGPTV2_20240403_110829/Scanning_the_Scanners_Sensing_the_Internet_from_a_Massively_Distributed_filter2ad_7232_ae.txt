### 6.3 Scanner Origins

In this section, we examine the top contributors of scan traffic and source addresses, and evaluate the impact of sharded scans on our inferences.

#### Scanner Origin Countries
Table 3 presents the top-5 origin countries of scans. Internet-wide full scans are highly concentrated, with Ukraine accounting for approximately 41% of scan packets, followed by the United States with around 14%. In contrast, partial Internet-wide scans are more distributed, and localized scans are even more spread across different origin countries, with the Netherlands contributing about 19% of localized scan traffic. When analyzing unique scan source IP addresses (Table 3b), we observe similar distributions for Internet-wide scans. However, localized scanner IP addresses show a higher concentration in Brazil, Russia, and India—countries that exhibit less pronounced scanning activity when considering only Internet-wide scans. We note that these findings are based on the CDN’s proprietary geolocation database, which maps scanner IP addresses to their respective countries.

#### Port Distributions
The most frequent port combinations for Internet-wide partial scans are two-port tuples 23 and 2323 (TCP) as well as 23 and 8080 (TCP), together accounting for 64% of all multi-port scans. These port combinations can be attributed to variants of the Mirai botnet [8]. In contrast, only 26% of localized scans probe multiple port numbers, with the most common combination being the 4-tuple of 23, 8080, 7547, and 8291 (TCP), which accounts for 19% of all localized multi-port scans. The ports 8291 and 7547 are related to critical vulnerabilities in home routers [26, 27], and they show significant activity in localized scans. This suggests that actors are specifically targeting these ports, likely due to the presence of many CDN servers within end-user ISPs, making these ASes prime candidates for scanning home router vulnerabilities. Generally, localized scans exhibit a higher port diversity, with the top 5 ports accounting for only 17% of all scan traffic, while Internet-wide partial scans are more concentrated, with the top 5 ports accounting for 33% of all scanning traffic.

#### CDN-Targeted Scans
CDN-targeted scans show distinct behavior, with the most frequently targeted port numbers being 500/UDP (IPsec) and 137/UDP (NetBIOS name resolution). These ports appear with much higher frequency in our dataset compared to the UCSD telescope (Figure 10a). Since these connection artifacts, such as IPsec, are frequently reported in firewall logs in production networks [4], it is not surprising to see them in our dataset.

#### Sharded Scans
Some scanning tools, like ZMap, allow sharding, which involves distributing and executing scans using multiple machines and IP addresses. To determine if our Internet-wide partial and localized scans are actually sharded scans of the full IPv4 space, we re-evaluated our scan target selection strategies, aggregating scan traffic from source IP addresses if they (i) belong to the same /24 prefix and (ii) conduct only Internet-wide partial or only localized scans. Our findings indicate that the overall proportion of scans changes only marginally, but the fraction of packets categorized as Internet-wide full scans increases from 27.6% to 37.7%, and the fraction of packets categorized as Internet-wide partial scans decreases from 39.3% to 30.3%. This suggests that some large Internet-wide partial scans are indeed sharded scans of the full IPv4 space. Localized scans, however, show minimal aggregation, with the fraction of packets categorized as localized decreasing only slightly from 29.0% to 27.9%, indicating that the majority of localized scans are not artifacts of sharded scans.

### 7. On Scanning Visibility

In this section, we compare the visibility into scanning activity as seen from our distributed telescope and the UCSD network telescope, a centralized /8 darknet. We assess baseline activity in both datasets and proceed to dissect baseline activity in our dataset.

#### Comparison with a Darknet
We compare the source visibility and background radiation observed in our CDN logs with the data from the CAIDA/UC San Diego darknet, which is available to the research community [2].

##### CDN Telescope vs. UCSD-NT
The UCSD darknet consists of an entire routed /8 prefix (with a small number of subdelegated blocks), providing a surface area of approximately 15.3M addresses, about 86 times larger than our telescope. Therefore, a random probe is 86 times more likely to hit the UCSD telescope. During the first week of November 2018, our telescope logged about 4.5B packets, while the UCSD-NT logged about 345B packets, which is 77 times the number of packets we logged. Thus, on average, the CDN telescope logs more packets per IP address compared to the UCSD-NT.

##### Per Source Comparison
Figure 11a shows the number of destination IPs hit by all source IP addresses in both telescopes. We can segment this plot into three groups:
1. **Proportional Hits**: Source IP addresses hitting destinations in both telescopes proportionally, shown by the concentration on the diagonal line. These addresses have high Pearson correlation in our dataset.
2. **UCSD-Telescope Dominance**: A group of IP addresses that show up more frequently in the UCSD telescope, indicated by the area below the diagonal. This is expected because sources probing on port 80, 443, or ICMP are not logged by the CDN telescope, and many small-scale scans are only visible in the larger UCSD-NT.
3. **CDN-Telescope Dominance**: A concentration of source IP addresses that hit exclusively or predominantly the CDN telescope, shown along the y-axis. These addresses are likely conducting localized scans.

##### Per Destination Comparison
Figure 11b provides a histogram of the number of packets per destination IP address for the first day of November 2018. We group the addresses into CDN client-facing IPs (N=86K), CDN operations IPs (N=86K), and UCSD-NT IPs (N=15.3M). The histogram is normalized to show the largest bin as 1 for all datasets. The UCSD-NT IP addresses show a pronounced concentration at approximately 3000 packets per day (median = 3091 pkts), with very few IP addresses receiving significantly more packets daily (90th percentile = 3292 pkts, 95th percentile = 4552 pkts). This confirms our earlier observation of a baseline of roughly 3000 packets received daily. The IP addresses of our CDN telescope also show a peak at the baseline (median operations IPs = 3092 pkts, median client-facing IPs = 3331 pkts). Some IP addresses receive fewer packets than typical UCSD-NT IP addresses, likely due to network filtering and the exclusion of port 80, 443, and ICMP traffic. More interestingly, CDN IP addresses show a heavier tail (operations IP 90th percentile = 4509 pkts, 95th percentile = 5595 pkts), indicating a higher variability in packet reception.

This analysis highlights the complementary nature of our distributed CDN telescope and the centralized UCSD-NT, providing a more comprehensive view of scanning activities.