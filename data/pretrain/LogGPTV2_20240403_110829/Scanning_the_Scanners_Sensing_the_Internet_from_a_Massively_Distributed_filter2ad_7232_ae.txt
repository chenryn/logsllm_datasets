ber. 66% of Internet-wide partial scans send packets on multiple
port numbers and the most frequent combinations are two-port
tuple 23 and 2323 (TCP) as well as 23 and 8080 (TCP), together
accounting for 64% of all Internet-wide multi-port scans. These
port combinations can be attributed to incarnations of the Mirai
botnet [8]. In contrast, only 26% of localized scans probe multiple
port numbers, with the most common combination of ports being
the 4-tuple of 23, 8080, 7547, 8291 (TCP), accounting for only 19%
of all localized multi-port scans.
6.3 Scanner Origins
In this section, we inspect top contributors of scan traffic and source
addresses, and assess the effect of sharded scans on our inferences.
Scanner origin countries: Table 3 shows the top-5 origin coun-
tries of scans.9 While Internet-wide full scans are highly concen-
trated, with Ukraine accounting for some 41% of scan packets, fol-
lowed by the US with some 14%, we see that partial Internet-wide
scans are more spread out, and find that localized scans are even
more spread across different origin countries, with the Netherlands
accounting for some 19% of localized scan traffic. When looking at
unique scan source IP addresses (Table 3b), we see similar distri-
butions for Internet-wide scans, but notice that localized scanner
IP addresses show a much higher concentration in Brazil, Russia,
and India; countries that show less-pronounced scanning activity
when considering only Internet-wide scans. We note that a large
8Such connection artifacts, e.g., IPsec, are frequently reported to appear in firewall
logs in production networks [4].
9We leverage the CDN’s proprietary geolocation database to map scanner IP addresses
to countries.
(b) Top-5 port numbers seen for scans, where we show all scans as well as
the contributions of individual scan types.
Figure 10: Top-5 port numbers in our dataset, UCSD net-
work telescope, and contribution by individual scan types.
All ports are TCP unless tagged as UDP.
port distribution, and these are the most popular ports for partial
Internet-wide scans. This makes sense given that these two ports
are frequently targeted by worms and botnets, which commonly
exhibit random scanning behavior [8]. Localized scans, on the other
hand, contribute much less to this class of ports, but show signifi-
cant activity on ports 8291 and 7547, both ports related to critical
vulnerabilities in home routers [26, 27]. In contrast, port 8291 is
the 273th most targeted port in the UCSD darknet, and port 7547
the 48th most targeted port by packets. This hints towards actors
scanning particular ranges for these ports (recall that many of the
CDN servers are located within end-user ISPs, making these ASes
prime candidates for scanning for home router vulnerabilities). Gen-
erally, we note that localized scans show a higher port diversity
(top 5 ports only account for some 17% of all scan traffic), whereas
Internet-wide partial scans are more concentrated on a smaller
number of ports (top 5 ports account for some 33% of all scanning
traffic). We note that when looking at aggregate port statistics, po-
tentially dangerous, localized scans such as on ports 8291 and 7547,
would not stand out, since they are masked by the sheer volume of
Internet-wide scans on popular port numbers.
CDN-targeted scans: We note that CDN-targeted scans show
wildly different behavior, with the two port numbers being 500/UDP
(IPsec) and 137/UDP (NetBIOS name resolution). These two port
numbers also show up with much higher frequency in our overall
dataset, as compared with the UCSD telescope (Figure 10a). Since
153
23445137/UDP500/UDP143305101520all CDN23804452281051015UCSD−NT% packets2344514338122051015all scans812280888545230246810Internet−widefull500/UDP137/UDP55336445250102030405060CDN23445143355558080051015202530Internet−widepartial238291445227547051015localized% packetsScanning the Scanners
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
rank
1
2
3
4
5
rank
1
2
3
4
5
Internet-wide partial
localized
Internet-wide full
Hoster (UA)
Hoster (US)
Hoster (NL)
Research (US)
Hoster (NL)
40.8% Hoster (UA)
5.7% Hoster (MD)
3.6% ISP (CN)
3.0% Hoster (BG)
2.4% ISP (RU)
18.5% Hoster (NL)
4.9% Hoster (BG)
4.6% Hoster (UA)
3.3% Hoster (NL)
3.2% Hoster (NL)
8.3%
4.2%
4.1%
3.4%
3.1%
(a) Scan packets.
Internet-wide partial
localized
Internet-wide full
Hoster (NL)
Hoster (US)
Research (US)
Hoster (UK)
Hoster (IT)
26.7% ISP (CN)
5.3% ISP (CN)
5.0% ISP (EG)
3.8% ISP (RU)
2.9% ISP (TW)
8.5% ISP (BR)
8.4% ISP (RU)
4.2% ISP (IN)
5.4% ISP (TW)
2.7% ISP (CN)
9.5%
7.9%
6.1%
5.5%
4.3%
(b) Scan source IP addresses.
Table 4: Top origin ASes of scan traffic and sources.
fraction of localized scans in Brazil corresponds to scans on port
number 8219, and point out that Brazil was reported to be a key
contributor of Internet-wide scan traffic on port 8219 caused by
infections by the Hajime botnet [3, 23]. While Brazil still emits
significant Internet-wide partial scans (accounting for some 7% of
source addresses), we now see much more pronounced localized
scanning activity. We plan to investigate potential links between
these scanning behaviors and related events in future work.
Scanner origin networks: In Table 4, we show the types of the
top-5 origin ASes of scan traffic, qualified by their respective coun-
try code. Indeed, we find that almost all scan traffic from Ukraine
can be mapped to a single hoster in this country, accounting for
more than 40% of all full scan packets. Eyeballing localized scans,
we find them to be much less concentrated on individual ASes,
with the top-5 only accounting for some 23% of scan packets, com-
pared to more than 50% for full scans, and 32% for Internet-wide
partial scans. The observation that most scanning traffic originates
from (bulletproof) hosting ASes is largely consistent with findings
in [18]. However, when counting by the number of scanner source
IP addresses (Table 4b), the picture changes: ISPs connecting end
users to the Internet host a majority of partial as well as localized
scanner IP addresses, hinting towards scans originating from, e.g.,
infected devices as opposed to large-scale measurement campaigns.
Sharded scans: Some scanning tools, such as ZMap, allow shard-
ing, i.e., to distribute and execute scans using multiple machines and,
more importantly, multiple IP addresses. To assess if our Internet-
wide partial and localized scans are in fact sharded scans of, e.g., the
full IPv4 space, we re-computed our scan target selection strategies,
but aggregate scan traffic from source IP addresses, if (i) they are
in the same /24 prefix, and (ii) they carry out only Internet-wide
partial or only localized scans. We find that the overall proportion
of scans only marginally changes, but the fraction of packets catego-
rized as Internet-wide full scans increases from 27.6% to 37.7%, and
the fraction of packets categorized as Internet-wide partial scans
decreases from 39.3% down to 30.3%. This finding suggests that
some of the large Internet-wide partial scans are in fact sharded
scans of the full IPv4 space. Localized scans barely aggregate, with
the fraction of packets categorized as localized decreasing only
marginally from some 29.0% down to 27.9%, suggesting that the
vast majority of localized scans are not artifacts of sharded scans.
154
7 ON SCANNING VISIBILITY
In this section, we compare the visibility into scanning activity
as seen from our distributed telescope, and the UCSD network
telescope, a centralized /8 darknet. We assess baseline activity in
both datasets, and proceed to dissect baseline activity in our dataset.
7.1 Comparison with a Darknet
In this section, we compare source visibility and background ra-
diation seen in our CDN logs with a major darknet operated by
CAIDA/UC San Diego, who make their data available to the re-
search community [2].
CDN telescope vs. UCSD-NT: The UCSD darknet consists of an
entire routed /8 prefix (with a small number of subdelegated blocks).
I.e., the surface of UCSD-NT is some 15.3M addresses, about 86 times
larger than our telescope, and thus a random probe is 86 times
more likely to hit the UCSD telescope. We compare the first week
of November 2018. During this time period, our telescope logged
some 4.5B packets, while UCSD-NT logged some 345B packets,
which is 77 times (i.e. less than 86 times) the packets we log. Thus,
on average, the CDN telescope logs more packets per IP address
when compared to UCSD-NT.
Per source comparison: Figure 11a shows for all source IP ad-
dresses (here we show the entire dataset) the number of destination
IPs hit in both telescopes. We can segment this plot in three groups:
(i) source IP addresses hitting destinations in both telescopes pro-
portionally, see concentration on diagonal line. These are source
IP addresses that show up with high Pearson correlation in our
dataset, and we expect this pattern, since a random scan of the IPv4
space will hit, on average, about 86 times more IP addresses in the
UCSD telescope, when compared to the CDN. The dashed red line
shows source IP addresses that hit a ratio of 1:86 IPv4 addresses
in CDN/UCSD-NT. (ii) A second group of IP addresses that show
up proportionally more frequently in the UCSD telescope, see area
below the diagonal. Recall that sources that probe on port 80 or 443
or ICMP are not logged by the CDN telescope, and given the size
difference of the telescope, a large number of small-scale scans will
only be visible in this much larger telescope, (iii) Lastly, we see a
concentration of source IP addresses that hit exclusively (i.e. along
the y-axis), or predominantly the CDN telescope. We expect these
source IP addresses to carry out localized scans, and will follow up
on this observation in the next section.
Per destination comparison: The picture sharpens when study-
ing the number of packets per destination IP in either dataset.
Figure 11b shows a histogram of the number of packets per tele-
scope destination IP address for the 1st day of November 2018
(other days look similar). We group the addresses into CDN client-
facing IPs (N=86K), CDN operations IPs (N=86K), and UCSD-NT IPs
(N=15.3M). To allow comparison given the vastly different counts,
we normalize the histogram by showing the largest bin as 1 for
all datasets. We see that the UCSD-NT IP addresses show a very
pronounced concentration at x ≈ 3000 packets per day (median
= 3091 pkts), and that only very few IP addresses in this darknet
receive significantly more packets on a daily basis (90th percentile
= 3292 pkts, 95th percentile = 4552 pkts). This confirms our earlier
observation of a baseline of roughly 3000 packets that our machines
receive on a daily basis (recall Figure 2). The IP addresses of our
IMC ’19, October 21–23, 2019, Amsterdam, Netherlands
Richter and Berger
(a) Per source IP: Destination IP addresses hit in the CDN telescope and
UCSD telescope in the first week of November 2018. We see random and
full scans hitting both telescope proportionally (red dashed line), and
traffic components only visible in either of the two telescopes.
(b) Packets per destination IP on November 1st for CDN telescope and
UCSD-NT. The CDN IP addresses have a heavier tail, while UCSD tele-
scope IPs are heavily concentrated at the baseline value of around 3000
packets.
Figure 11: Visibility of CDN telescope vs. UCSD-NT darknet.
CDN telescope also show the peak at the baseline (median opera-
tions IPs = 3092 pkts, median client-facing IPs = 3331 pkts). Some
IP addresses receive less than a typical UCSD-NT IP address, and
we recall that some of our servers are located in networks that filter
traffic on specific port numbers, and that we do not log traffic on
port 80, 443, nor ICMP traffic. More interestingly, however, we note
that CDN IP addresses show a much heavier tail (operations IP 90th
percentile = 4509 pkts, 95th percentile = 5595 pkts) which is even