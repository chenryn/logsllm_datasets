editors. Volume 7778. Springer, Heidelberg, 352â€“368. doi:
10.1007/978-3-642-36362-7_22.
[9] Amos Fiat and Adi Shamir. 1987. How to prove yourself: Prac-
tical solutions to identification and signature problems. In
CRYPTOâ€™86 (LNCS). Andrew M. Odlyzko, editor. Volume 263.
Springer, Heidelberg, (August 1987), 186â€“194. doi: 10.1007/3-
540-47721-7_12.
[8]
[10] Yael Gertner, Yuval Ishai, Eyal Kushilevitz, and Tal Malkin.
2000. Protecting data privacy in private information retrieval
schemes. J. Comput. Syst. Sci., 60, 3, 592â€“629. doi: 10.1006/
jcss.1999.1689. https://doi.org/10.1006/jcss.1999.1689.
[11] Mauricio Karchmer and Avi Wigderson. 1993. On span pro-
grams. In Proceedings of Structures in Complexity Theory,
102â€“111.
[12] Russell W. F. Lai, Christoph Egger, Manuel Reinert, Sherman
S. M. Chow, Matteo Maffei, and Dominique SchrÃ¶der. 2018.
Simple password-hardened encryption services. In USENIX
Security 2018. William Enck and Adrienne Porter Felt, editors.
USENIX Association, (August 2018), 1405â€“1421.
[13] Russell W. F. Lai, Christoph Egger, Dominique SchrÃ¶der, and
Sherman S. M. Chow. 2017. Phoenix: rebirth of a crypto-
graphic password-hardening service. In USENIX Security
2017. Engin Kirda and Thomas Ristenpart, editors. USENIX
Association, (August 2017), 899â€“916.
[14] Allec Muffet. 2015. Facebook: password hashing and authen-
tication. https://www.youtube.com/watch?v=7dPRFoKteIU.
Video. (2015).
[15]
[16]
PCI Security Standards Council. 2016. Requirements and
security assessment procedures. PCI DSS v3.2. (2016).
Jonas Schneider, Nils Fleischhacker, Dominique SchrÃ¶der,
and Michael Backes. 2016. Efficient cryptographic password
hardening services from partially oblivious commitments.
In ACM CCS 2016. Edgar R. Weippl, Stefan Katzenbeisser,
Christopher Kruegel, Andrew C. Myers, and Shai Halevi,
editors. ACM Press, (October 2016), 1192â€“1203. doi: 10 .
1145/2976749.2978375.
[17] Claus-Peter Schnorr. 1990. Efficient identification and signa-
tures for smart cards. In CRYPTOâ€™89 (LNCS). Gilles Brassard,
editor. Volume 435. Springer, Heidelberg, (August 1990), 239â€“
252. doi: 10.1007/0-387-34805-0_22.
[18] Adi Shamir. 1979. How to share a secret. Communications of
the Association for Computing Machinery, 22, 11, (November
1979), 612â€“613.
John Steven and Jim Manico. 2016. A password storage cheat
sheet. https : / / www. owasp . org / index . php / Password _
Storage_Cheat_Sheet. (2016).
[19]
A PRELIMINARIES
A.1 Computational Assumption
We recall the discrete logarithm and decisional Diffie-Hellman as-
sumptions.
Definition A.1 (Discrete Logarithm). We say that the discrete
logarithm assumption holds with respect to GGen if for all PPT
adversaries A
Definition A.2 (DDH). We say that the decisional Diffie-Hellman
assumption holds with respect to GGen if for all PPT adversaries
Pr
ğ‘¥ = ğ‘¥â€² :
ğ‘ = 1 :
ğ‘ = 1 :
A (cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
Pr
âˆ’Pr
(G, ğ‘, ğº) â† GGen(1ğœ†)
ğ‘¥â€² â† A(G, ğ‘, ğº, ğºğ‘¥)
ğ‘¥ â†$ Zğ‘
(G, ğ‘, ğº) â† GGen(1ğœ†)
ğ‘¥, ğ‘¦ â†$ Zğ‘
ğ‘ â† A(G, ğ‘, ğº, ğºğ‘¥, ğº ğ‘¦, ğºğ‘¥ ğ‘¦)
(G, ğ‘, ğº) â† GGen(1ğœ†)
ğ‘¥, ğ‘¦, ğ‘§ â†$ Zğ‘
ğ‘ â† A(G, ğ‘, ğº, ğºğ‘¥, ğº ğ‘¦, ğºğ‘§)
 â‰¤ negl(ğœ†) .
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) â‰¤ negl(ğœ†) .
â€¢ (Perfect Completeness) For all non-uniform polynomial-time
Pr
algorithms A,
(crs, ğ‘¥, ğ‘¤) âˆ‰ ğ‘… âˆ¨ ğ‘ = 1 :
(crs, ğ‘¥, ğ‘¤) âˆ‰ ğ‘… âˆ§ ğ‘ = 1 :
Pr
crs â† Gen(1ğœ†)
(ğ‘¥, ğ‘¤) â† A(crs)
ğœ‹ â† Prove(crs, ğ‘¥, ğ‘¤)
ğ‘ â† Vf(crs, ğ‘¥, ğœ‹)
crs â† Gen(1ğœ†)
(ğ‘¥, ğœ‹) â† A(crs)
ğ‘¤ â† E(crs, ğ‘¥, ğœ‹)
ğ‘ â† Vf(crs, ğ‘¥, ğœ‹)
 = 1.
 â‰¤ negl(ğœ†) .
â€¢ (Statistical Proof of Knowledge) There exists a probabilistic
polynomial time extractor E such that, for all (unbounded)
adversaries A,
Note that schemes satisfying this property in the common-
reference-string model cannot be zero-knowledge, as the
extractor E does not have secret inputs. This is however not
an issue in the random oracle model, where E has black-
box access to further copies of A with the randomness used
to define (ğ‘¥, ğœ‹), and simulates responses to random oracle
queries made by A. Furthermore, A is restricted to make
only a polynomial number of random oracle queries.
â€¢ (Computational Zero-Knowledge) There exists a probabilis-
tic polynomial time simulatorS, such that for all probabilistic
polynomial time adversaries A1 and non-uniform polyno-
mial time algorithms A2,
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)
A1(crs, ğ‘¥, ğœ‹) = 1 :
 (crs, ğ‘¥, ğ‘¤) âˆˆ ğ‘…âˆ§
 (crs, ğ‘¥, ğ‘¤) âˆˆ ğ‘…âˆ§
A1(crs, ğ‘¥, ğœ‹) = 1 :
Pr
âˆ’Pr
crs â† Gen(1ğœ†)
(ğ‘¥, ğ‘¤) â† A2(crs)
ğœ‹ â† Prove(crs, ğ‘¥, ğ‘¤)
crs â† Gen(1ğœ†)
(ğ‘¥, ğ‘¤) â† A2(crs)
ğœ‹ â† S(crs, ğ‘¥)
(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12)(cid:12) â‰¤ negl(ğœ†) .
In the random oracle model, S simulates responses to ran-
dom oracle queries made by A1 and A2. Furthermore, A2
is restricted to make only a polynomial number of random
oracle queries.
Let GGen : 1ğœ† â†¦â†’ crs = (G, ğº, ğ‘) be a group generator which
generates a cyclic group G of order ğ‘ with generator ğº. Let ğ» :
{0, 1}âˆ— â†’ Zğ‘ be a hash function. We recall in Figure 7 a generalized
Schnorr protocol [17] (Prove, Vf) which is made non-interactive
using the Fiat-Shamir transformation [9]. It is well known that the
scheme (GGen, Prove, Vf) is (unconditionally) a NIZKPoK for the
relation ğ‘…GDL if ğ» is modeled as a random oracle.
A.2 Non-Interactive Zero-Knowledge Proof of
Knowledge (NIZKPoK)
We recall the notion of non-interactive zero-knowledge proof of
knowledge (NIZKPoK) and a construction for generalized discrete
logarithm relations.
Let ğ‘… âŠ† {0, 1}âˆ— Ã— {0, 1}âˆ— Ã— {0, 1}âˆ— be a ternary relation decidable
in polynomial time. Given a common reference string (CRS) crs, we
say that ğ‘¤ is a witness of a statement ğ‘¥ if (crs, ğ‘¥, ğ‘¤) âˆˆ ğ‘….
A tuple of PPT algorithms (Gen, Prove, Vf) is said to be a non-
interactive proof of knowledge (NIZKPoK) scheme for the relation
ğ‘… if the following properties hold:
B DISCUSSION
In this section we discuss miscellaneous topics related to our con-
struction, including different variants, an optimization, a general-
ization, extensions, and applications.
B.1 Fine-Grained Rate-Limiting
Our construction leads to two slightly different variants of (ğ‘¡, ğ‘š)-
PHE â€“ one which supports fine-grained rate-limiting and one which
only supports coarse-grained rate-limiting. The former requires a
7-round decryption protocol while the latter requires only 6 rounds.
Apart from saving communication costs, the coarse-grained variant
13
Prove(crs, ğ‘¥, ğ‘¤)
ğ´1,1
...
ğ´ğ‘š,1
parse ğ‘¥ as
(cid:169)(cid:173)(cid:173)(cid:173)(cid:171)
parse ğ‘¤ as (ğ‘¥1, . . . , ğ‘¥ğ‘›)
(ğ‘Ÿ1, . . . , ğ‘Ÿğ‘›) â†$ Zğ‘
ğ‘…ğ‘– :=ğ‘›
ğ´1,ğ‘›
. . .
...
. . .
. . . ğ´ğ‘š,ğ‘›
(cid:170)(cid:174)(cid:174)(cid:174)(cid:172)
ğµ1
...
ğµğ‘š
ğ‘Ÿ ğ‘—
ğ‘—=1ğ´
ğ‘–,ğ‘— , âˆ€ğ‘– âˆˆ [ğ‘š]
ğ‘ := ğ» (crs, ğ‘¥, ğ‘…1, . . . , ğ‘…ğ‘š)
(ğ‘¦1, . . . , ğ‘¦ğ‘›) := ğ‘ Â· (ğ‘¥1, . . . , ğ‘¥ğ‘›) + (ğ‘Ÿ1, . . . , ğ‘Ÿğ‘›)
return (ğ‘…1, . . . , ğ‘…ğ‘š, ğ‘¦1, . . . , ğ‘¦ğ‘›)
ğ´1,ğ‘›
. . .
...
. . .
. . . ğ´ğ‘š,ğ‘›
parse ğ‘¥ as
ğ´1,1
...
ğ´ğ‘š,1
Vf(crs, ğ‘¥, ğœ‹)
(cid:169)(cid:173)(cid:173)(cid:173)(cid:171)
ğ‘ := (âˆ€ğ‘– âˆˆ [ğ‘š],ğ‘›
parse ğœ‹ as (ğ‘…1, . . . , ğ‘…ğ‘š, ğ‘¦1, . . . , ğ‘¦ğ‘›)
ğ‘ := ğ» (crs, ğ‘¥, ğ‘…1, . . . , ğ‘…ğ‘š)
ğ‘¦ ğ‘—
ğ‘–,ğ‘— = ğµğ‘
ğ‘—=1ğ´
ğ‘– Â· ğ‘…ğ‘–)
ğµ1
...
ğµğ‘š
(cid:170)(cid:174)(cid:174)(cid:174)(cid:172)
return ğ‘
Figure 7: A NIZKPoK for the relation ğ‘…GDL
Joint Decryption
Server S(â€œdecâ€, sk0, pw, ğ‘›, ğ¶)
ğ‘‡0 := Ëœğ‘ˆ ğ‘˜0 , ğ‘‡â€²
â„“=0 Â¯ğ¾ ğ‘—â„“
0 := Ëœğ‘ˆ â€²ğ‘˜0
, âˆ€ğ‘— âˆˆ ğ‘ƒ
ğ¾ğ‘— :=ğ‘¡âˆ’1
â„“
(cid:18)
Ëœğ‘ˆ
, ğ‘˜0
(cid:19)
crs,
(cid:18)ğº
(cid:18)
(cid:18)
ğ¾0
ğ‘‡0
(cid:19)
(cid:19)
(cid:18)ğº
(cid:19)
(cid:18) ğº
, ğ‘‡â€² :=ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‡
ğ¾ğ‘—
ğ‘‡â€²
ğ‘—
ğ¾ğ‘—
ğ‘‡ğ‘—
, ğœ‹3,ğ‘—
Ëœğ‘ˆ â€²
crs,
Ëœğ‘ˆ
, ğœ‹â€²
3,ğ‘—
(cid:19)
(cid:19)
â€²ğœ†ğ‘ƒ,ğ‘—
ğ‘—
ğœ‹3,0 â† Prove
crs,
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf
ensure âˆ€ğ‘— âˆˆ ğ‘ƒ : Vf
ğ‘‡ :=ğ‘—âˆˆğ‘ƒâˆª{0}ğ‘‡
ğœ†ğ‘ƒ,ğ‘—
ğ‘—
ğ‘‡ğ‘– , ğœ‹3,ğ‘– ,ğ‘‡â€²
ğ‘– , ğœ‹â€²
3,ğ‘–
{( ğ‘—,ğ‘‡ğ‘— , ğœ‹3,ğ‘—)} ğ‘—âˆˆ(ğ‘ƒâˆª{0})\{ğ‘–}
to ğ‘– âˆˆ ğ‘ƒ
Rate-limiter Rğ‘– (â€œdecâ€, skğ‘–), âˆ€ğ‘– âˆˆ [ğ‘š]
ğ‘‡ğ‘– := Ëœğ‘ˆ ğ‘˜ğ‘– , ğ‘‡â€²
ğ‘– := Ëœğ‘ˆ â€²ğ‘˜ğ‘–
ğ¾ğ‘– := ğºğ‘˜ğ‘– , ğ¾ğ‘— :=ğ‘¡âˆ’1
(cid:18)ğº
(cid:18) ğº
ğœ‹3,ğ‘– â† Prove
(cid:18)
(cid:18)
crs,
â„“=0
ğœ‹â€²
3,ğ‘– â† Prove
crs,
Ëœğ‘ˆ
Ëœğ‘ˆ â€²
(cid:18)
ğ‘ğ‘– :=
âˆ€ğ‘— âˆˆ ğ‘ƒ \ {ğ‘–} : Vf
crs,