|  **披露**
**时间**
|  **披露**
**机构**
|  **攻击** **手法** |  **载荷投递**
**方式**
|  **投递载荷**
**内容**  
---|---|---|---|---|---  
**法国大选候选人马克龙** | 2017.5 | ESET，FireEye | 鱼叉攻击 | Office和Windows的0day漏洞 |
Seduploader  
**欧洲和中东地区的酒店** | 2017.8 | FireEye | 鱼叉攻击 | VBA脚本EternalBlue漏洞 |
EternalBlue漏洞利用工具
开源Responder工具  
**CyCon** **参会人员** | 2017.10 | Cisco Talos | 鱼叉攻击 | VBA脚本 | Seduploader  
**欧洲与美国政府机构和航空航天私营部门** | 2017.10 | Proofpoint | 鱼叉攻击 | Flash Nday漏洞 |
DealersChoice  
**未公开** | 2017.11 | McAfee | 鱼叉攻击 | DDE技术 | Seduploader  
表4 2017年安全厂商披露的APT28组织部分活动
此外，2017年1月，FireEye发布了报告《APT28: At The Center for The
Storm》。FireEye在报告中认定著名的APT28组织为俄罗斯政府支持的黑客组织。并称一年以来APT28的变化不仅表明了其技能的提升，资源的丰富和对维持作战能力的渴望，而且突出了集团使命的长久性以及在可预见的将来继续其活动的意图。
2017年12月，ESET发布了报告《Sednit update: How Fancy Bear Spent the
Year》，对APT28的攻击方式进行了一些总结。综合其他一些关于APT28的研究成果可以发现，APT28在目标系统上获得初始立足点的方式主要有三种：
  * **Sedkit**
Sedkit是APT28独家使用的一个漏洞攻击工具包，主要包含Flash和Internet
Explorer中的漏洞，首次被发现时的使用方法是通过水坑攻击将潜在的受害者重定向到恶意页面。在此之后，APT28首选的方法是将恶意链接嵌入到发送给目标的电子邮件中。
2016年10月是最后一次发现Sedkit被使用。Sedkit的消失遵循了其它漏洞攻击工具包中看到的趋势：它们都依赖于老版本的Adobe
Flash和Internet
Explorer中的漏洞实现恶意程序的下载。2016年包括Sednit在内的大部分漏洞攻击工具包使用次数的下降可能是因为Microsoft和Adobe软件的安全性不断增强。
  * **DealersChoice**
2016年8月，Palo Alto
Networks发布了一篇关于APT28使用的新平台的博客。这个被称为DealersChoice的平台能够生成嵌入了Flash漏洞的恶意文档。这个平台有两个变种。第一个变种会检查系统上安装了哪个Flash
Player版本，然后选择三个不同的漏洞中的一个进行攻击。第二个变种则会首先连接C2服务器（Command &
Control服务器，指木马程序的控制端或控制木马的服务器），该服务器将提供选定的漏洞利用和最终的恶意负载。
APT28今天仍然在使用这个平台，其针对欧洲与美国的政府机构和航空航天私营部门的攻击，就是在DealersChoice平台上使用了一个新的Flash
Nday漏洞（Nday漏洞是指软件厂商已经提供了补丁的安全漏洞，但使用者可能由于各种原因并未给软件打上相关补丁）。这表明这个平台仍在使用，并在不断发展。
  * **宏，VBA和DDE**
除了传统的宏和VBA（Visual
Basic的一种宏语言）之外，APT28在针对法国大选的攻击中也利用了Windows内核和Office的0day漏洞（软件厂商尚未提供补丁的安全漏洞）。2017年10月，SensePost（一家欧洲安全公司）发布了一篇关于DDE（Dynamic
Data Exchange，动态数据交换）的文章，其中介绍的相关方法在11月就被APT28用于攻击中。
木马程序Seduploader仍然被APT28频繁使用。Seduploader由两个不同的组件组成：一个dropper（一种木马程序），一个是由该dropper安装的负载。在2017年4月，Seduploader的新版本增加了一些新功能，例如截图功能或从C2服务器直接加载到内存中执行。2017年底，Seduploader
dropper被投递Seduploader 负载的PowerShell命令所取代。
###  海莲花（APT-C-00）
基于对样本及更多其他来源数据的整合分析和历史活动的长期跟踪，360威胁情报中心发现海莲花团伙活动的一些变化：
  * **木马对抗性更强更复杂**
海莲花先后使用过多种形态的专用木马，虽然均是以窃取感染目标电脑中的机密数据为目的，但从攻击原理和攻击方式来看，却有着很大的区别。特别是针对Windows系统的专用木马，其出现时间有先有后，危险程度不断升级，攻击方式从简单到复杂、从本地到云控，可以让我们清楚的看到该组织木马的技术发展脉络和攻击思路的不断转变。我们将其分别命名为：海莲花
Tester，海莲花 Encryptor，海莲花 Cloudrunner，海莲花 MAC等。
在2017年360威胁情报中心截获的样本中，部分较新的恶意代码利用了系统白程序MSBuild.exe来执行恶意代码以绕过查杀。这种加载恶意代码的方式本质上与利用带正常签名的PE程序加载位于数据文件中的恶意代码的方法相同。原因在于：一、MSBuild是微软的进程，不会被杀软查杀，实现防病毒工具的Bypass；二、很多Win7电脑自带MSBuild，有足够大的运行环境基础，恶意代码被设置在XML文件中，以数据文件的形式存在不易被发现明显的异常。除了通常的可执行程序附件Payload以外，360威胁情报中心还发现了利用CVE-2017-8759漏洞和Office
Word机制的鱼叉邮件。
在2017年11月截获的最新样本中，我们发现样本捆绑了Firefox浏览器等程序执行了多个阶段的ShellCode，资源文件加密运行时解密下一阶段的ShellCode，采用白利用过杀软的方式，并且代码中还加入大量花指令和乱序，对抗能力进一步增强。
  * **攻击面收窄更具针对性**
与去年相比，海莲花团伙的攻击活动面有所收窄，但攻击目标的针对性加强，鱼叉邮件的社工特性突出，体现为对攻击目标的深度了解。有用户反馈到威胁情报中心的样本使用了如下的附件名：
invitation letter-zhejiang ***** working group.doc
星号是非常具体的目标所在组织的简称，目标人物在浙江省，所以附件名里加了zhejiang字样，暗示这是完全对目标定制的攻击木马。这体现了攻击者对攻击目标的专注度。
  * **服务器更加隐蔽更难追踪**
为了隐藏自己的真实身份，海莲花组织经常变换下载服务器和C2服务器的域名和IP。而且大多数域名为了抵抗溯源都开启了Whois域名隐藏，使得分析人员很难知道恶意域名背后的注册者是谁。在2017年11月最新的样本中还使用了DGA算法以进一步逃避检测。
DGA算法，即Domain Generation
Algorithms，译为域名生成算法，是一种利用随机字符来生成C2服务器域名，从而逃避域名黑名单检测的技术手段。如，某些木马会向随机生成的成千上万个域名发送消息，但其中只有极少数会真正被攻击者使用，并用来完成后续攻击环节。不过在APT攻击中，DGA算法一般不会生成海量域名，但却会时常根据算法动态更换新的域名，这就大大增加了安全分析人员定位有效服务器难度。
此外，在海莲花组织的最新攻击中，攻击者对采用的网络基础设施也做了更彻底的隔离，使之更不容易做关联溯源分析。在以往的攻击活动中，海莲花组织所使用的IP偏爱193.169.*.*网段。但2017年截获的海莲花组织新近样本中，其使用的相关IP地址与既往IP几乎没有重叠，非常“干净”。这就导致分析人员需要耗费更大的精力去对抗加强后的样本以获取关联点，追踪溯源的难度进一步加大。
  * **即使暴露仍瞄准高价值客户**
海莲花攻击者似乎不甘心丢掉之前已经攻陷的“目标”而选择“卷土重来”。例如，对之前已经攻击过的目标会进行反复攻击，发送新版本的鱼叉邮件，并尝试再次获取控制。
在处理用户反馈的过程中，我们发现：尽管某些曾经遭到海莲花攻击的高价值用户的电脑已经进行了特殊保护，清除了以往感染的海莲花组织专用木马，但他们还是会不断遭到海莲花组织的攻击，如收到新的鱼叉邮件，受到新型专用木马的攻击。
此外，在某些仍然被控制着的电脑终端上，海莲花组织的攻击者也会通过推送新的木马程序，将木马的C2服务器转换到新的IP或域名下。
所有上述现象均表明，海莲花组织攻击的“持续性”之强：没有暴露，未被发现的情况下，就要保证持续更新；已经暴露，已被发现的情况下，也还要继续不断的攻击。如此猖獗的攻击，在APT组织中并不多见。
##  APT组织对特定地域的攻击
如果说，2016年APT组织的攻击主要体现在对金融、工业和政治这三大领域的攻击；那么，2017年，APT组织的攻击则主要体现在对欧美、东亚和中东三大地区的攻击。
###  针对欧美地区的攻击