User: 请解答这个和日志有关的问题CentOS 6.4 iSCSI Target - crm shell error I try to make a iSCSI Target on CentOS 6.4 with DRBD, Pacemaker, Open-iSCSI and LVM2.

Now I need to prepare the HA iSCSI Target configuration on the crm shell, but if I enter the configure mode, there's a error message:

[root@centos ~]# crm
crm(live)# configure
ERROR: running cibadmin -Q1: Could not establish cib_rw connection: Connection refused (111)
Signon to CIB failed: Transport endpoint is not connected
Init failed, could not perform requested operations


Because crm is not included in the newest pacemaker-cli package, I added this OpenSUSE Repo, before I installed the package crmsh.x86_64. 

cat /var/log/messages | grep corosync:

corosync[1052]:   [MAIN  ] Compatibility mode set to whitetank. Using V1 and V2 of the synchronization engine.
corosync[1052]:   [TOTEM ] A processor joined or left the membership and a new membership was formed.
corosync[1052]:   [CPG   ] chosen downlist: sender r(0) ip(127.0.0.1) ; members(old:0 left:0)
pacemakerd[1259]:   error: find_corosync_variant: Corosync is running, but Pacemaker could not find the CMAN or Pacemaker plugin loaded 
corosync[1052]:   [TOTEM ] The network interface [192.168.1.101] is now up.
corosync[1052]:   [TOTEM ] A processor joined or left the membership and a new membership was formed.
corosync[1052]:   [CPG   ] chosen downlist: sender r(0) ip(127.0.0.1) ; members(old:0 left:0)
corosync[1052]:   [MAIN  ] Completed service synchronization, ready to provide service.


cat /var/log/messages | grep pacemaker:

pacemakerd[1251]:   error: find_corosync_variant: Corosync is running, but Pacemaker could not find the CMAN or Pacemaker plugin loaded
pacemakerd[1251]:   notice: get_cluster_type: This installation does not support the ´(null)´ cluster infrastructure: terminating.

Assistant: You should not use anything from the Suse repo except crmsh and pssh so you should add a line to the repo file which says includepkgs=crmsh,pssh so that it does not overwrite the CentOS supplied corosync etc.

The only supported method of using corosync on CentOS 6.4 is to use it via cman so you no longer start corosync directly, you start cman and then you start pacemaker. Configuration is done via /etc/cluster/cluster.conf and this tells cman how to start corosync.

You should see these pages for more details: Pacemaker on RHEL6.4 and Pacemaker and RHEL 6.4 (Redux)