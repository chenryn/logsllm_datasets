.
0
.
4
2
/
n
h
i
t
i
w
y
t
i
v
i
t
c
a
s
s
e
r
d
d
a
P
I
5
5
2
.
7
2
1
.
0
.
4
2
/
n
h
t
i
i
w
y
t
i
v
i
t
c
a
s
s
e
r
d
d
a
P
I
5
5
2
.
7
2
1
.
0
.
4
2
/
n
h
t
i
i
w
y
t
i
v
i
t
c
a
s
s
e
r
d
d
a
P
I
5
5
2
.
7
2
1
.
0
.
0
1
2
3
4
0
1
2
3
4
0
1
2
3
4
0
1
2
3
4
time [months]
time [months]
time [months]
time [months]
(a) Statically assigned ad-
dress block (German Univer-
sity, FD=29, STU=0.04).
assigned
(b) Dynamically
address block (US Univer-
sity, FD=254, STU=0.18).
assigned
(c) Dynamically
address block with residen-
tial users (US ISP, FD=175,
STU=0.26).
assigned
(d) Dynamically
address block with resi-
dential users (German ISP,
FD=254, STU=0.75)
Figure 6: Regular activity patterns: Interplay between address assignment practice and user-behavior.
4
2
/
n
h
i
t
i
w
y
t
i
v
i
t
c
a
s
s
e
r
d
d
a
P
I
5
5
2
.
7
2
1
.
0
.
4
2
/
n
h
i
t
i
w
y
t
i
v
i
t
c
a
s
s
e
r
d
d
a
P
I
5
5
2
.
7
2
1
.
0
.
0
1
2
3
4
0
1
2
3
4
time [months]
time [months]
(a) German
FD=256, STU=0.32.
University,
(b) German
FD=187, STU=0.38.
University,
Figure 7: Modiﬁed assignment practice.
ber of active IPs within an address block within a window of
time. There is not a single address block size that is ideal, but
we chose a /24 Classless Inter-Domain Routing (CIDR) pre-
ﬁx, i.e., the smallest distinct, globally-routed entity. This is
a compromise, since we recognize that both smaller preﬁxes
are sometimes more appropriate, as in Figure 7(b), and that
larger preﬁxes sometimes exhibit uniform patterns of activ-
ity, e.g., Figure 6(b). Values of this metric range from 1 to
256. We will later see that this metric is particularly helpful
in dissecting static from dynamic addressing mechanisms.
Spatio-temporal utilization (STU): this metric captures the
aggregate activity of active IPs over time. We deﬁne uti-
lization as the fraction: spatio-temporal activity divided by
the maximum spatio-temporal activity, for a given block and
window of observation (time). Relying on our four months
worth (112 days) of daily activity data, the spatio-temporal
activity can range from 1, where one single IP address was
active for one day, up to 112 ⇥ 256 = 28672, where all ad-
dresses in a block were active every day, which would be the
maximum spatio-temporal activity. STU is this value nor-
malized as a fraction with range 0 to 1.
Figures 6 and 7 are annotated with their respective val-
ues for ﬁlling degree (FD) and spatio-temporal utilization
(STU). In these examples, FD varies from values as low as
29 to as high as 256. The STU varies from 0.04 up to 0.75.
5.2 Detecting Change
As a ﬁrst-order partitioning of the active IPv4 address
space, we are interested in identifying address blocks with a
signiﬁcant change in address assignment practice during our
observation interval. Per Section 4.2, we know that some
portion of address churn on longer timescales affects larger
address ranges (“bulky changes”) than do short-term changes.
To quantify changes in address assignment, we rely on our
spatio-temporal utilization metric. In particular, Figure 8(a)
shows the maximum change in spatio-temporal utilization
on a month-to-month basis for each active /24 block. Here,
we observe that the majority (90%) of the /24 blocks cluster
around the origin, i.e., they do not show a major change in
their utilization. Another 10% of the active address blocks,
on the other hand, are located more closely to the tails of
the CDF, these are blocks for which we observe signiﬁcant
changes in address activity.
To dissect address blocks into major change and minor
change blocks, we set a threshold at X = ±0.25. We de-
cided to use this value, as it retains cases of heavy in situ
change, e.g., Figure 6(b), but excludes of major conﬁgura-
tion change, e.g., Figure 7. Based on this threshold, we ﬁnd
that as many as 9.8% of the active /24 blocks show major
change in their address activity within our four months pe-
riod, while 90.2% of the blocks show no more than minor
change. Thus, we separate blocks that likely underwent re-
allocation or change in address assignment practice (major
change, Figure 7) from those that did not (Figure 6).7
5.3 Addressing Matters
Having culled out those blocks with major changes, we
next focus on the activity characteristics of steady address
blocks. Since we have observed that the address assignment
policy greatly inﬂuences its activity patterns, we would like
to identify speciﬁc assignment practices. We pay particular
7We acknowledge that some changes in address assignment
might result in only minor STU change and that others might
result in larger STU change. We chose a threshold based on
anecdotal examination of activity patterns.
s
k
c
o
b
4
2
l
/
e
v
i
t
c
a
:
F
D
C
0
1
.
8
.
0
6
0
.
4
0
.
2
0
.
0
0
.
s
k
c
o
b
l
4
2
/
e
v
i
t
c
a
:
F
D
C
0
.
1
8
.
0
6
.
0
4
.
0
2
.
0
0
.
0
static
all
dynamic
s
k
c
o
b
l
4
2
/
e
v
i
t
c
a
K
0
2
1
K
0
8
K
0
4
0
0.5
0.0
−0.5
−1.0
1.0
max. diff in monthly spatio−temporal utilization
(a) Maximum monthly change in spatio-
temporal utilization per /24 block. We
select 90% of the blocks in the stable re-
gion.
1
64
128
192
256
active IP addresses within /24
(b) Filling degree of active /24 blocks,
where we dissect
some identiﬁable
blocks to be static or dynamic using re-
verse DNS.
60
40
20
0
100
% of max possible spatio−temporal utilization
(c) Spatio-temporal utilization within /24
blocks with >250 active IP addresses.
80
Figure 8: Spatio-temporal aggregate views of IP address activity.
attention to utilization characteristics associated with these
practices. We argue that an address block’s utilization is de-
termined by (a) its address assignment policy and (b) the
behavior of its users and their hosts.
Static vs. dynamic addressing: As a ﬁrst cut, we are in-
terested in how static and dynamic addressing mechanisms
compare when it comes to address space utilization. In the
static case, the ISP assigns a ﬁxed IP address for each de-
vice/subscriber. Dynamic addressing, on the other hand,
automatically assigns IP addresses from predeﬁned ranges.
In order to apply our metrics, we wanted an initial set of
blocks that are known to be likely statically or dynamically
assigned. To this end, we used PTR (reverse DNS) records
and tagged /24 blocks containing addresses with consistent
names that suggest static (keyword static) as well as dy-
namic (keyword dynamic, pool) assignment, a well-known
methodology [24, 30, 35]. In total, we ﬁnd 456K dynamic
/24 address blocks and 262K static address blocks. We then
compare their activity based on our dataset. Figure 8(b)
shows a CDF of the ﬁlling degree (active IPs per /24) for
the two subsets of static or dynamic /24s, as well as for the
entirety of our dataset. Comparing the curves for dynami-
cally and statically assigned address blocks, we see a stark
difference: While 75% of static /24s show a ﬁlling degree
lower than 64 IPs, more than 80% of the dynamic /24s show
a very high ﬁlling degree, i.e., higher than 250 IP addresses.
When comparing these observations to our entire dataset, we
observe that about 50% of the entire visible address space