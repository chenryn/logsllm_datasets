AS1AS2AS3Victim AS0Attacker M00:01AS0|ph(s)  i(a) Replay attack00:02AS0|ph(s)  i00:03M|ph(s)  iPollutedAS4AS500:02AS0|ph(s)  i00:04M|ph(s)  iAS1AS2AS3Victim AS0Attacker M00:01AS0|ph(s)  i(b) Route propagation under guideline00:06M|ph(s)  iAS4AS500:02AS0|ph(s)  i00:05M|ph(s)  i00:03AS0|ph(s)  i00:04AS0|ph(s)  i00:05AS0|ph(s)  iFig.6.Replayattackexampleandprevention.AS-levelpathbetweenanyASandtheTier-1ASesisonly3-4hopslong.TheadditionaldelayisonlyproportionaltothehierarchicalleveloftheInternettopology.6IncrementaldeploymentIn§5weprovedthat,byimposingpartialordering,theen-tireBGPsystemreachesasecurestate,assumingfulldeploy-ment.However,incrementaldeployabilityisanimportantpropertyforpracticaladoption.WeenhanceHC-BGPunderpartialdeploymentbytwoadditionalrules.ConstructingmonitoringbarrierbyparticipatingASes.ThecurrentdesignofHC-BGPunderpartialdeploymentisnotguaranteedtobesecurebecausethelegacyASesmightsendthehashvaluetoattackerbeforethelegitimateroutepropa-gatestotheTier-1ASes.IntheexampleshowninFigure6,ifAS1doesnotdeployHC-BGP,thenMreceivestheupdateviaAS1attime00:02topolluteAS3andAS4.Inthiscase,thevalueisleakedfromAS1toM.Toovercomethisproblem,wedeveloponemorerulethatusesallparticipatingASestomonitorandpreventleakinghashvaluetoattackerfromtheirlegacyneighbors.Weﬁrstas-sumethateachASknowswhetheritsneighborhasdeployedHC-BGP.Speciﬁcally,whenASireceivesanupdatedroutefromitsnon-providerlegacyneighborASi+1,ASiwillﬁrstcheckiftheupdatedvaluehaspropagatedtoTier-1ASesbasedonguideline(3).Ifnot,ASidelayspropagatingtheroutefromASi+1untilthevalueispropagatedtoTier-1ASes.Thus,alltheparticipatingASeslikeASiconstructamonitor-ingbarrierwhicheffectivelydelaysthepropagationofup-datedhashvaluetotheattacker.Thisruleenablesthede-ployedASestostopleakingthehashvaluethroughthelegacyASestotheattacker.Conﬂictdetection.Evenwithmonitoringbarrier,wecannotguaranteeallASesarefreefrompollutionunderpartialde-ployment.Thus,werelyonparticipatingASestodetectcon-ﬂictinghashvalues.InthesameexampleinFigure6,AS4re-ceivestwoinconsistentroutes,i.e.,twodifferentoriginASesannouncingpwiththesamehi(s),indicatingtheoccurrenceofhijacking.TherearemultiplewaysthatAS4canidentifytheattackerASusingtheknowledgeofthetopology.Forex-ample,thepresenceofalinkbetweenAS1andMbutnolinkbetweenAS3andAS0indicatesthatMlearnsthemessagefromAS1.Weleavedetailsofsuchaschemeasfuturework. 0 5 10 15 20 25 30 35 40 45 0 10 20 30 40 50 60Fraction of ASes polluted (%)Number of deployed ASes 0 5 10 15 20 25 30 35 40 45 0 10 20 30 40 50 60Fraction of ASes polluted (%)Number of deployed ASesresiliencevictim-centricrandomFig.7.Efﬁciencyofpartialdeployments.7DiscussionWediscusstwocornercasesandtheirsolutions.Resiliencetomessageloss.Lostmessagescouldcausein-consistencyinHC-BGP.SinceBGPusesthereliabletransportprotocolTCP,BGPpacketlossisunlikelytohappen.How-ever,routerscangodowntemporarilyduetomaintenanceorfailure.Ifanymessage,i.e.,bothinitializationandhashchainupdate,arrivesinbetween,thentheroutermaymissit.Oursolutionisthattheneighborroutertemporarilycachesthemessagesandresendsitwhenevertherouterisup.NotethataftertheBGPsessionisre-established,aneighborneedstoexchangetheentireroutingtablewhichincludethehashval-ues.Dealingwiththeorderingoftheinitialannouncement.Comparedwithpreviousapproaches,HC-BGPdoesnothaveacentraltrustentity(PKI)toanswerthewhocanannouncewhatquestion.Therefore,atanytime,theattackercanstarttheinitializationprocessindependentlytocreatetheinitialhashvalueofpreﬁxp.Assuminganattackerannouncespattimet1,andtheownerannouncespattimet2.Weanalyzetheoutcomedependingontheorderingofevents.Ift1(cid:9)t2,i.e.,attackerannouncesaftertheowner,otherASescanrejectthebogusrouteduetomismatchinhashvalues.Ift1≈t2,thepartialorderingalgorithmcanensuremostASesacceptthevalidroute.Ift1(cid:11)t2,i.e.,theattackerannouncespmuchearlier,wediscusstwocasesdependingonthepreﬁxtype.Ifpisunallocated,i.e.,abogonpreﬁx,suchroutescanbeﬁl-teredusingabogonﬁlterlist.Ifpreﬁxpisallocatedtotheownerbutisneverannounced,theattackercansuccessfullyhijackit.However,sincethesepreﬁxesareunused,thereisnolegitimatetrafﬁcdestinedtoit,leadingtominimalimpact.Moreover,itisveryeasyfortheownertodetectitsincetheownerwillalsoreceivethebogusroute.8EvaluationInthissection,weﬁrstdemonstratethatHC-BGP’spartialorderingalgorithmintroducesnegligiblepropagationdelaysforroutingupdates.Wethenevaluatethebeneﬁtofpartialdeployment.8.1ExperimentalevaluationWeextendanexistingsimulator[24]usedtostudyde-fensesagainstgeneralpreﬁxhijackingattacks,includingsub-preﬁxhijacking.ThesimulatortakesasinputtheAS-leveltopologyfromthepublicrouterepository[2],containing23,289ASesand55,352edges.Thetopologyislabeledwith978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
31
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:20 UTC from IEEE Xplore.  Restrictions apply. 
theinferredASrelationshipfromGao’salgorithm[9].Thesimulatormodelsroutepropagationwiththerouteselectionguidedbytheroutingdecisionprocessdrivenbyrelationship-basedroutingpolicies.Thesimulatorisabletosimulatedif-ferentpreﬁxhijackingscenariosandgenerateasetofpollutedASesandtheAS-levelpathstoreachhijackedpreﬁxes.Forthecryptographicone-wayhashfunctionH[x],wechoosetouseAESblockcipherinthehashconstruction[15],whichisalsousedinSPV[11].Thehashfunctioniscompu-tationallyinfeasiblefortheattackertoderivethekeyxnortoﬁndanyotherx(cid:2)suchthatH[x]=H[x(cid:2)].Weusethedefault-freeroutingtablefromonevantagepointinaTier-1networkfromRouteViews.Eachpreﬁxinthetableisassignedaninitialhashchainvalue,whichisprop-agatedtootherASes.Thefollowingsimulationfocusesonsub-preﬁxhijackingbecauseitismostdifﬁculttopreventandhaslargeimpactontheInternet.8.2RoutepropagationdelayTheguidelinesofpartialorderingin§5imposesadditionalpropagationdelaytotheBGPsystem,whichwequantifyhere.Weﬁrstconducttheanalysisusing3-dayBGPdatafromRouteViews/RIPE.Foreachpreﬁxupdateannouncedbyamonitornon-Tier-1AS,wecomputetheadditionalwaittimeneededforTier-1ASestoreceivetheupdate.Weﬁrstgroupallupdatesforthesamepreﬁxacrossmultiplevantagepointsusingapreviouslyestablishedmethod[22]andthencomputethetimedifferencebetweentheﬁrstupdatefromanon-Tier-1vantagepointandthelastupdatefromanyTier-1vantagepoint.Thetimedifferenceconservativelyestimatestheaddi-tionaldelayduetopartialordering.Figure8showsthatin85%casestheadditionallatencyiswithin30seconds.Thisstudygivesanaccurateestimateofpropagationdelayincreaseusingreal-worlddata.WealsoanalyzethepropagationdelayperceivedbyanyASintheInternet.Tostudythis,wefurthersimulatetheef-fectofimposingpartialorderingusingSSFNet[1]withthetopologyof830nodesprovidedbySSFNet.Weshowtheav-eragedelayincreasetopropagateonepreﬁxacrossallASesbeforeandafterimplementingourpartialorderingalgorithm.Figure9showsthat80%ofthecasesarewithin40seconds.ItisslightlylargerinSSFNetsimulationthanthatinFigure8asallASesarestudiedinsteadofjusttheTier-1ASes.8.3EﬃciencyunderpartialdeploymentQuantifyingtheincrementalbeneﬁtisimportantforunder-standingtheadoptabilityoftheprotocol.Wesimulatethese-curityguaranteesunderpartialdeployment.Thisbeneﬁtistwo-fold.First,theparticipatingASesconstructabarriertostoppropagatingthenewhashvaluetotheattacker.Second,theydetecthijackingbyobservingtheconﬂicts.First,wesimulatethesub-preﬁxhijacking,whichismuchmoredifﬁculttoprevent,byanalyzingtheeffectofmonitor-ingbarrierunderdifferentpartialdeploymentscenarios.InFigure7,westudyhowthedegreeofpollutionchangeswithmoredeployedASes.Foreachexperiment,weﬁrstrandomlyselectapairofASesastheattackerandvictim.ThenweselecttheASestodeploytheschemeusingthefollowingstrategies.1.Re-silience:selectthenon-Tier-1ASeswhichappearmosttimesonthepathfromotherASestoanyTier-1AS.TheseASesareimportantforpreventingpollutingTier-1ASes.2.Victim-centric:selecttheASesnearesttothevictimintermsofASpathlength.3.Random:selecttheASesrandomly.WecanseeinFigure7thatvictim-centricperformsbestasitguaranteestheroutepropagatedtoASeswhilepreventingthehashvaluefromleakingtotheattacker.Wealsosimulatethelikelihoodofinconsistencydetection.Weﬁrstrandomlyselect50victims.Foreachvictim,50at-tackersareselectedrandomly.Theattackercanperformthreetypesofattacks.Foreachattacktype,wedeﬁnethedetectionasfollows.(1)Theattackermodiﬁesp’sinitialvaluehn(sp).AnASde-tectsthisiftworoutesreceivedcarrydifferenthnvalues.(2)Tolaunchfull-preﬁxhijacking,theattackerinterceptsp,hc−1(sp)announcedbytheneworigin,andannouncesitwithitsownoriginAS.AnASdetectsthisifthetworoutesforpreceivedusethesamehc−1(sp),butdifferentoriginASes.(3)Tolaunchthesub-preﬁxhijacking,theattackerreplacesthelegitimatesub-preﬁxp1withanothersub-preﬁxp2.Simi-larly,anASdetectsitifthetworoutesreceivedfortwodiffer-entsub-preﬁxeshavethesamehashvalueofthecover-preﬁx.Fortypes1and2,certainASesmaynotdetecttheincon-sistencyastheASesalongthepropagationpathmayselectoneofthemasthebestrouteandpropagateit.Wefocusonsimulatingtheﬁrsttwotypes.Type3caneasilybedetectedbyanyASesbecausep1andp2aredisjointpreﬁxessothatbothofthemarealwayspropagated.WestudythefractionofASescapableofobservingcon-ﬂictsunderpartialdeployment.Inthesimulation,theASesobservingtheconﬂictsactsasalegacyASandpropagatethebestrouteofthetwo.Figure10showsthefractionofASesob-servingtheinconsistencies.Theupperbound60%iscausedbythesetofsingle-homedASesthatneverobservetworoutestoonedestination.Oncedetected,theAScantracebacktothemaliciousAShop-by-hop.ThemaliciousASisusuallydetectedveryquicklywithinfewhops.9PerformanceEvaluationInthissection,weevaluatetheefﬁciencyofourprotocolintermsofcomputationandstorageresourceconsumptions.WecompareoursolutionwithS-BGPanditsvariants.Computationalcomplexity.Asstatedin§4.3,HC-BGPiscomputationallyefﬁcientbecauseoftwokeycharacteristics:useofinexpensivecryptographicprimitive(hashchain)andrequiringcryptographiccomputationsinuncommoncases.Toaccuratelyassessthecomputationoverheadofoural-gorithm,weproﬁletheCPUoverheadforkeygenerationandveriﬁcationseparately.Forobjectivecomparison,wealsoimplementthegenerationandveriﬁcationprocessofthead-dressattestationinS-BGP.Notethatweonlycomparewiththeﬁrstphase,addressattestationofS-BGPforfairness.We978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
32
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 09:59:20 UTC from IEEE Xplore.  Restrictions apply. 
 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 10 20 30 40 50 60CDFPropagation delay (seconds)Fig.8.PropagationdelayincreasefromRouteViews/RIPE. 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 20 40 60 80 100 120CDFPropagation delay (seconds)Fig.9.Propagationdelayincrease(SSFNetsimulation). 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7CDFThe fraction of ASes detecting conflicts 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7CDFThe fraction of ASes detecting conflictsAllT1-T1T2-T2T3-T3T1-T2T2-T3T3-T2Fig.10.FractionofASesobservingconﬂicts.ﬁrstanalyzethecomputationaloverheadofindividualop-erationsonthesetwoprotocols.ForS-BGP,thecomputa-tionaloverheadoftheaddressattestationpartisproportionaltothenumberofupdates.ItsUpdateNum×Time(encrypt)forownerandUpdateNum×Time(decrypt)forreceiver,whereUpdateNumisthetotalnumberofupdatesperdayandtheTime()istheexpensiveasymmetriccrypto-graphicprimitives.Inourscheme,thecomputationalcostfortheowneris(RateoriginChange+RatenewPrefix)×UpdateNum×Time(sign).Forthereceiver,thecostis(RateoriginChange+RatenewPrefix)×UpdateNum×Time(verify).TheTime()hereisthecomplexityofmoreefﬁcientone-wayhashchainprimitives.Evenwithoutcon-sideringthecomplexitydifferenceofcryptographictech-niques,HC-BGPisalready1(RateoriginChange+RatenewPrefix)timesmoreefﬁcientthanS-BGP.Fromthethree-monthdata,weestimatethebeneﬁtis2.6×104.Theveriﬁcationinvolvesonlyonehashoperation.10ConclusionInthispaper,weproposeHC-BGP,anewarchitectureforsecuringpreﬁxownership.HC-BGPusesanefﬁcientcrypto-graphicprimitive,one-wayhashchain,toverifythatthecur-rentmessageissentfromtheauthenticatedidentityassociatedwiththepreviousmessage.WedemonstratehowHC-BGPcanpreventbothfullpreﬁxaswellassub-preﬁxhijackingattacks.Tofurtherimproveefﬁciency,HC-BGPonlyrequiresveriﬁca-tionwhentheoriginchanges.Insteadofrequiringacentral-izedPKI,HC-BGPreliesontheexistinghop-by-hoptrustre-lationship.Itprovidesapartialorderingalgorithmtopreventanymaliciousnetworkfromtamperingthemessages.References[1]ScalableSimulationFramework(SSF).http://www.ssfnet.org/homePage.html.[2]UniversityofOregonRouteViewsArchiveProject.http://www.routeviews.org.[3]W.Aiello,J.Ioannidis,andP.McDaniel.Originauthenticationininterdomainrouting.InCCS’03:Proceedingsofthe10thACMconferenceonComputerandcommunicationssecurity,pages165–178,NewYork,NY,USA,2003.ACM.[4]H.Ballani,P.Francis,andX.Zhang.AStudyofPreﬁxHijack-ingandInterceptionintheInternet.InProc.ACMSIGCOMM,August2007.[5]V.J.Bono.7007ExplanationandApology.NANOGemailonApr26,1997.[6]P.Boothe,J.Hiebert,andR.Bush.HowPrevalentisPreﬁxHijackingontheInternet.NANOG36Talk,February2006.[7]K.Butler,P.McDaniel,andW.Aiello.OptimizingBGPsecu-ritybyexploitingpathstability.InProc.CCS,NewYork,NY,USA,2006.ACM.[8]H.Chan,D.Dash,A.Perrig,andH.Zhang.ModelingAdopt-abilityofSecureBGPProtocol.InProc.ACMSIGCOMM,2006.[9]L.Gao.OnInferringAutonomousSystemRelationshipsintheInternet.InProc.IEEEGlobalInternetSymposium,2000.[10]X.HuandZ.M.Mao.AccurateReal-timeIdentiﬁcationofIPPreﬁxHijacking.InProc.IEEESecurityandPrivacy,2007.[11]Y.-C.Hu,A.Perrig,andM.Sirbu.SPV:ASecurePathVectorSchemeforSecuringBGP.InProc.ACMSIGCOMM,2004.[12]M.Lad,D.Massey,D.Pei,Y.Wu,B.Zhang,andL.Zhang.PHAS:APreﬁxHijackAlertSystem.InProc.USENIXSecu-ritySymposium,2006.[13]M.Lad,R.Oliveira,B.Zhang,andL.Zhang.Understandingresiliencyofinternettopologyagainstpreﬁxhijackattacks.InProc.DSN,2007.[14]L.Lamport.Passwordauthenticationwithinsecurecommuni-cation.Commun.ACM,24(11):770–772,1981.[15]S.Matyas,C.Meyer,andJ.Oseas.GeneratingStrongOne-WayFunctionswithCryptographicAlgorithm,1985.[16]NANOG.YouTubeIPHijacking,Febrary2008.[17]J.Ng.ExtensionstoBGPtoSupportSecureOriginBGP(soBGP).IETFDraft:draft-ng-sobgp-bgp-extensions-01.txt,November2002.[18]J.QiuandL.Gao.Hi-BGP:ALightweightHijack-proofInter-domainRoutingProtocol.Technicalreport,UniversityofMas-sachusettsAmherst,2006.[19]StephenKentandCharlesLynnandKarenSeo.SecureBorderGatewayProtocol(Secure-BGP).IEEEJ.SelectedAreasinCommunications,2000.[20]L.Subramanian,V.Roth,I.Stoica,S.Shenker,andR.H.Katz.ListenandWhisper:SecurityMechanismsforBGP.InSym-posiumonNSDI,2004.[21]D.Wendlandt,I.Avramopoulos,D.Andersen,andJ.Rexford.Don’tSecureRoutingProtocols,SecureDataDelivery.InProc.ACMWorkshoponHotTopicsinNetworks(HotNets),2006.[22]J.Wu,Z.M.Mao,J.Rexford,andJ.Wang.Findinganeedleinahaystack:PinpointingsigniﬁcantBGProutingchangesinanIPnetwork.InProc.NSDI,2005.[23]H.Yin,B.Sheng,H.Wang,andJ.Pan.SecuringBGPthroughkeychain-basedsignatures.InProceedingsofthe15thIWQoS’07,June2007.[24]Z.Zhang,Y.Zhang,Y.C.Hu,andZ.M.Mao.PracticalDe-fensesAgainstBGPPreﬁxHijacking.InProc.ACMCoNEXT,2007.[25]X.Zhao,D.Pei,L.Wang,D.Massey,A.Mankin,S.F.Wu,andL.Zhang.AnanalysisofBGPmultipleoriginAS(MOAS)conﬂicts.InProc.IMW,pages31–35,NewYork,NY,USA,2001.ACM.