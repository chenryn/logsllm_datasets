3
4
5
6
18
19,802
(67.16%)
587
(1.99%)
1,274
(4.32%)
1,508
(5.11%)
4,232
(14.35%)
1,513
(5.13%)
23
(0.08%) (1.85%)
545
Table 6: The number of files and percentage (relative to all unex-
pected content files) (bottom row) flagged as malicious by varying
number of antivirus systems (top row) used by VirusTotal.
Table 6 shows the number of unexpected responses that are
flagged as malicious, broken down by the number of antivirus tools
used by VirusTotal that classified it as malicious. At the extreme, for
example, we find 545 retrieved files that are considered malicious
by 18 different antivirus systems.
7.1 Detailed Findings
In what follows, we discuss in more detail our findings of malicious
proxy activity, organized by file type.
Windows Executables (.exe). Almost all (98.5%) of unexpected
responses for .exe files are classified as malicious. We find that
1.93% (413/21,385) of the proxies maliciously modified the
.exe file at least once during our measurement period. The
infections include malware from the Expiro malware family that
can be used to steal personal information and provide remote access
to the attacker [1], and flavors of malware from the Crypt and
Artemis trojan families [2, 13]. Table 9 in Appendix C lists the top
10 reported infections for .exe files.
Flash and .jar Files. VirusTotal did not flag any of the modi-
fied Flash or Java .jar files as malicious. We are unsure of whether
this indicates (i) benign (but unexplained) instances in which prox-
ies rewrite these files, or (ii) a limitation of the scanners used by
VirusTotal.
For ZIP file responses with unexpected content, only
ZIP Files.
a single antivirus system (McAfee-GW-Edition, v2017.2786) flagged
0.28% (14/4562) of them as malicious. VirusTotal did not provide
any details about the infection.
HTML Files. We received HTML responses from proxies (as
determined by VirusTotal) irrespective of the requested content
type. Roughly 0.2% (44/21,385) of the proxies returned unexpected
content at least once, with 43 of them returning malicious content
as well. Almost 97% (2,472/2,551) of these HTML responses were
labeled as malicious. Table 10 in Appendix C shows the reported
infections and the number of HTML responses with malicious
No. Malicious Proxies
AS Number
AS Name
72
45
25
14
9
4134
14061
4837
17974
56046
No.31,Jin-rong Street
DigitalOcean, LLC
China Mobile communications corporation
CHINA UNICOM China169 Backbone
PT Telekomunikasi Indonesia
Table 7: The five ASes with the most number of malicious proxies.
code. Upon further manual examination, we found that all of the
2,472 malicious responses detected by VirusTotal contain the same
Monero cryptocurrency [8] mining Javascript shown in Figure 9.
Surprisingly, on 545 occasions, we received ISO files
ISO Files.
when requesting a 1MiB text file. All of the 545 ISO responses were
exactly 1MiB in size, but were flagged as malicious by VirusTotal.
Table 11 in Appendix C shows the various infections reported
by VirusTotal. We note that all 545 files were infected with the
Vittalia Trojan, a rootkit for Windows. The content of 520 of the
545 ISO images was identical while the remaining 25 responses
were identical to one another. Although the ISO files were clearly
malicious, only 0.04% (9/21,385) of the proxies returned a malicious
ISO response at least once.
Shell Scripts. We fetched shell scripts to determine if malicious
proxies would modify (or replace) the scripts in transit. We find
that 22.75% (211,288/928,431) of the requests for shell scripts result
in responses with unexpected content. To hone-in on malicious
activity, we discarded responses whose MIME-type was not “text/x-
shellscript”; we found 1,020 instances in which the responses were
unexpected but were determined to be shell scripts. Oddly, all 1,020
instances of unexpected content correspond to just four unique
responses, summarized in Table 12 in Appendix C. All of these
modifications appear to be non-malicious (strangely, one frequent
modification inserts the text “Pop HerePop HerePop HerePop Here-
Pop HerePop HerePop HerePop Here” and little else) and are most
likely due to misconfiguration. Overall, we did not find any evidence
of malicious shell script manipulation during our measurements.
7.2 Network Diversity and Consistency of
Malicious Proxies
For the responses that we deemed malicious, we also looked at
the distribution of responsible proxies. Table 7 shows the top five
ASes with the most number of proxies that performed malicious
manipulations.
259An Extensive Evaluation of the Internet’s Open Proxies
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
Figure 11: Consistency of malicious proxy behavior.
We also looked at the daily behavior of the top three malicious
proxies over the duration of our measurement, as determined by the
number of malicious responses returned. The most malicious proxy
returned malicious content 100% of the time. The second and third
most malicious proxies returned malicious responses 97.7% and
87.9% of the time, respectively, when they were reachable. This trend
is apparent in Figure 11, which plots (in log-scale) the cumulative
distribution of the number of times that malicious proxies (defined
as a proxy that ever behaves maliciously) exhibit misbehavior. Here,
we see that half of proxies that return malicious content do so at
least twice. More than 25% of malicious proxies return at least 10
files with malicious content, while the top 10% of malicious proxies
return 56 or more malicious files.
Surprisingly, none of the 469 discovered proxies that return ma-
licious content (§7.1) are listed on the service run by Tsirantonakis
et al. [46] that reports misbehaving proxies. This suggests that cor-
rectly identifying misbehaving proxies is very challenging, since
proxy misbehavior may be transient and may take different forms.
8 SSL/TLS ANALYSIS
We find that 70% (14,607/20,893) of the proxies that fetch expected
content at least once allow TLS traffic to pass through them. We
emphasize that supporting HTTPS incurs no overhead on behalf
of the proxy, since the proxy is not involved in the (end-to-end)
cryptography and is merely transporting the ciphertext. It is worth
noting that as of early June 2018, more than 70% of loaded web pages
were retrieved using HTTPS [35]. The lack of universal HTTPS
support among the open proxies effectively forces some users to
downgrade their security, bucking the trend of moving towards a
more secure web.
We consider misbehavior among two dimensions: attempts at
decreasing the security of the communication through TLS MitM
or downgrade attacks, and alteration of the content.
SSL/TLS Stripping. We first examine whether any of the prox-
ies rewrite HTML  link tags to downgrade the transport from
HTTPS to HTTP. For example, a malicious proxy could attempt
to increase its ability to eavesdrop and modify unencrypted com-
munication by replacing all links to https://example.com with http:
//example.com on all webpages retrieved over HTTP. To perform
this test, we fetched via each proxy a HTML page hosted on a web
server at Georgetown University over HTTP. This HTML page
contained six HTTPS links. We did not find evidence of proxies
stripping SSL by replacing the included links.
In this experiment, we search
SSL Certificate Manipulation.
for instances of SSL/TLS certificate manipulation. While interfering
Figure 12: Percentage of proxies that return expected content but
perform TLS/SSL MitM, for websites that use revoked (top), self-
signed (middle), and valid and unexpired certificates (bottom).
with an HTTPS connection would cause browser warning messages,
numerous studies have shown that even security-conscious users
regularly ignore such warnings [17, 42].
We test the proxies against two categories of domains: one with a
valid and verifiable SSL certificate hosted on a web server at George-
town University; and domains with incorrect or invalid SSL certifi-
cates (https://revoked.badssl.com, https://self-signed.badssl.com/).
We include the latter category since we posit that a smart attacker
might perform SSL MitM only in instances in which the connection
would otherwise use revoked or self-signed certificates; in such
cases, the browser would issue a warning even in the absence of
the proxy’s manipulation.
To detect SSL/TLS certificate manipulation, we fetch the three
domains (listed above) via the open proxies each day between
2018-04-12 and 2018-05-31. For simplicity, we focus on the pages
fetched through the client at Georgetown University.
Overall, we find that 1.06% (102/9,625) of proxies that sup-
port HTTPS perform TLS/SSL MitM by inserting a modified
certificate. To determine whether any of the proxies performing
SSL/TLS MitM might belong to a known botnet, we searched the SSL
Fingerprint Blacklist and Dyre SSL Fingerprint Blacklist [12] for the
modified certificates’ fingerprints. We did not find any blacklisted
certificates.
We next consider proxies that fetch the expected content but
modify the SSL/TLS certificate. Such behavior suggests that the
proxy is eavesdropping on HTTPS connections. The percentage of
such eavesdropping proxies, per day, for the different categories
of certificates is plotted in Figure 12. Overall, 0.85% (82/9,607) of
the proxies that return expected responses appear to be eavesdrop-
ping. We did not find any evidence of proxies selectively targeting
incorrect or invalid SSL certificates.
proxies when
Finally, we analyze the modified TLS certificates inserted by the
eavesdropping
is
https://revoked.badssl.com or https://self-signed.badssl.com/ (i.e.,
when the genuine certificate is revoked or self-signed, respectively).
We find that there were 435 modified certificates from 21 unique
issuers. The issuer common name (CN) strongly suggests that 19%
(4/21) of the issuers were schools. We posit that the proxies that
requested
site
the
12510251002500.20.40.60.81Number of malicious responses, per malicious proxyCDF01234PercentageRevoked01234PercentageSelf-signedApr12,18Apr19,18Apr26,18May03,18May10,18May17,18May24,18May31,1801234PercentageValid260ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
A. Mani et al.
modified these certificates were operated by schools and were in-
correctly configured to serve requests from any network location.
Interestingly, all of the certificates inserted by these school proxies
had the expected subject common name and were valid (but not
normally verifiable, since the school is not a root CA). This leads to
an interesting result: if the schools pre-installed root CA certificates
on students’ or employees’ computers, then they are significantly
degrading the security of their users. That is, they are masking the
fact that requested webpages have expired or revoked certificates
by replacing these invalid certificates with ones that would be veri-
fied. This is similar to the effects observed by Durumeric et al. [25]
in their examination of enterprise middleware boxes, which also
degraded security by replacing invalid certificates with valid ones
signed by the enterprise’s CA.
Performing TLS MitM also allows a malicious proxy to modify
page content. To detect such behavior, using the same approach as
described in §6, we analyzed HTML pages fetched over TLS via the
open proxies. We did not find any malicious activity.
9 COMPARISON WITH TOR
Tor [23] provides anonymous TCP communication by routing user
traffic through multiple relays (typically three) using layered en-
cryption. The first relay in the path (or circuit) is the guard relay,
and the final relay through which traffic exits is the exit relay. The
original data transmitted is visible only at the exit relays. There-
fore, unless e2e encryption is used, data can be eavesdropped by
malicious or compromised exits. Prior research studies have found
evidence of malicious behavior such as interception of credentials,
etc., by a small fraction of Tor exit relays, especially when the traffic
was not e2e encrypted [20, 37, 54]. We now compare the level of
manipulation as observed using open proxies to that when content
is fetched over Tor.
We modify Exitmap [54], a fast scanner that fetches files through
all Tor exit relays. To maintain consistency with our earlier experi-
ments, we fetched the same set of files (e.g., HTML, .exe, etc.) as
described in §6 and §7 over HTTP, and accessed the same HTTPS
URLs as described in §8. We fetched these files each day through
every available Tor exit relay between 2018-05-06 and 2018-05-31,
during which the median number of available exit relays was 722.
Approximately 13.8% of connections and 1.8% of fetches timed
out when using Exitmap. This is unsurprising since Exitmap does
not perform the same (and necessary) bandwidth-weighted relay
selection as the standard Tor client [23, 54].
Over our 26 day Tor experiment, we found no instance in
which a Tor exit relay manipulated either file contents or
SSL/TLS certificates. Comparing our results to §6-8, this strongly
suggests that Tor is a more trustworthy network for retrieving
forwarded content. However, since Tor exits may still passively
eavesdrop (which we would not detect), we concur with the con-
ventional wisdom that e2e encryption (i.e., HTTPS) is appropriate
when using Tor.
We also compare the performance of Tor to that of the open prox-
ies. We compute the open proxies throughput as described in §5.1.
For Tor, we rely on data from the Tor Metrics Portal [45]; specifically,
we use the median time taken per day to download a static file of
size 1 MiB and derive Tor’s median throughput between 2018-05-06
and 2018-05-31. Figure 13 shows the Tor and open proxies’ median
Figure 13: Tor vs. open proxy median throughput per day while
fetching a static file of size 1 MiB.
throughput per day. We find that the Tor median throughput is
roughly twice the open proxy throughput. This suggests that Tor
performs relatively faster than the open proxies.
10 ETHICAL CONSIDERATIONS
We designed and conducted our measurements to minimize risk. In
particular, we believe our study’s design and implementation meet
the criteria described in the Menlo Report [24], an ethical frame-
work for conducting network measurements that has been widely
adopted by the networking and computer security communities.
The Menlo Report describes four principles of ethical research.
We achieve the principle of Respect for Persons by avoiding the
collection of data belonging to individual users. In our experiments,
we use open proxies largely as they are intended: we issue stan-
dard well-formed proxy requests and request only benign (non-
malicious) traffic from non-controversial websites. We record only
our own traffic, and in no instance do we monitor or capture the
behavior of other proxy users. We do not attempt to discover non-
publicly listed proxies by scanning the Internet. By focusing exclu-
sively on proxies that are already publicly listed, we do not risk
disclosing the existence of any previously unknown proxy.
We achieve Beneficience by minimizing potential harms while
providing societal benefits (i.e., exposing the dangers of using open
proxies). Unlike other studies that explicitly probe for instances of
Internet censorship by requesting potentially objectionable con-
tent [18, 19, 48, 53], our measurements avoid exposing proxy oper-
ators to risk (e.g., government sanction) by retrieving only URLs
that are very unlikely to be censored. Nor do our measurements
consume significant resources: we request a small handful of URLs
from each proxy; the average size of the content is just 177 KiB.
Our study meets the Menlo Report’s Justice criterion by distribut-
ing our measurements equally across all identified open proxies.
Finally, we achieve the Respect for Law and Public Interest crite-
rion by (i) conducting only legal queries (i.e., we are not requesting
any content that is likely to be illegal or censored) and (ii) being
transparent in our methods (see §4).
11 CONCLUSION
Open proxies provide a free and simple way to bypass regional con-
tent filters and achieve a limited degree of anonymity. However, the
absence of any security guarantees for traffic passing through these
proxies makes their use highly risky: users may unintentionally
expose their traffic to malicious manipulations, especially when no
end-to-end security mechanisms (e.g., TLS) are present.
May08,18May15,18May22,18May29,180.51.52.53.5MedianThroughput(bytes/sec)×105TorProxy261An Extensive Evaluation of the Internet’s Open Proxies
ACSAC ’18, December 3–7, 2018, San Juan, PR, USA
Our study of the Internet’s open proxies—the largest conducted
to date—discloses and quantifies new forms of misbehavior, rein-
forcing the notion that open proxies should be used with extreme
caution. We found numerous instances of misbehavior, including
the insertion of spurious ads and cryptocurrency-mining Javascript,
TLS MitM, and the injection of RATs and other forms of malware.
Moreover, we found that 92% of advertised proxies listed on open
proxy aggregator sites are nonfunctional. In contrast, our nearly
monthlong study of the Tor network found zero instances of mis-