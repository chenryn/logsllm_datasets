ticast DNS (mDNS) to prevent their attack, which is based on
the assumption that “disrupting two parties’ communication
through a Wi-Fi direct link or a local network is difﬁcult for
the adversary without access to the routing infrastructure of
the network.” In this work, we show that it is indeed practical
to mount a DoS on the link layer since AWDL does not em-
ploy any security mechanisms. An earlier work [27] targeted a
vulnerability in AirDrop’s implementation which allowed the
attacker to install ﬁles in arbitrary directories on the target’s
system. Apple ﬁxed this bug in 2015.
8 Implementation Security
During our AWDL analysis and building an AWDL prototype,
we found two implementation ﬂaws in Apple’s OSes that
allow an attacker to crash devices in proximity.
DoS: Kernel Panic and System Crash. These ﬂaws can be
exploited by sending corrupt AFs. In particular, we can trigger
kernel panics by setting invalid values in the synchronization
parameters (affecting macOS 10.12) and the channel sequence
(affecting macOS 10.14, iOS 12, watchOS 12, and tvOS 5),
respectively. To showcase our ﬁndings, we provide a video
of our PoC which exploits the second vulnerability on iOS
devices [75]. The video demonstrates how an attacker mounts
a targeted DoS attack that crashes a single device and a black-
out DoS attack that crashes all devices in range of the attacker
at the same time.
Outlook: Remote Code Execution. While not critical by
themselves, the mere existence of these vulnerabilities creates
a new class of threats to Wi-Fi devices as an attacker can
exploit them without any authentication towards the target,
i. e., they do not have to be on the same network. In light of
past discovered remote code execution in implementations
of standardized Wi-Fi procedures [8, 14], we think that a
determined attacker can ﬁnd similar ﬂaws for AWDL.
9 Conclusion
The deployment of open Wi-Fi interfaces enables new types
of applications for mobile devices. They allow devices in
proximity to communicate with each other without being con-
nected to the same Wi-Fi network. On the downside, this also
opens new opportunities for an attacker as they no longer have
to provide any kind of authentication (e. g., access to a secure
Wi-Fi network). In this paper, we investigate the ﬁrst protocol
of this kind, i. e., Apple’s proprietary AWDL. In particular, we
ﬁnd three distinct protocol-level vulnerabilities that allow for
DoS, user tracking, and MitM attacks. In addition, we dis-
covered two implementation bugs in Apple’s OSes that cause
DoS. Given the complexity of the protocol and implementa-
tions, we conjecture that more severe vulnerabilities will be
found in the future. To build PoCs for these attacks, we have
reverse-engineered AirDrop, a system service that runs on
top of AWDL, and have implemented open versions of both
AWDL and AirDrop which we make available as open source
software. Finally, our ﬁndings have implications for the non-
Apple world: NAN, commonly known as Wi-Fi Aware, is a
new standard supported by Android which draws on AWDL’s
design and, thus, might be vulnerable to the similar attacks as
presented in this work. This is pending further investigation.
Responsible Disclosure
We have contacted Apple about our ﬁndings on December 17,
2018. We have shared a draft of this paper as well as our PoC
code and support Apple in ﬁxing the privacy leaks (Section 5)
and desynchronization issue (Section 6) in AWDL as well as
the ambiguous authentication state in AirDrop (Section 7).
We have reported the two implementation vulnerabilities (Sec-
tion 8) earlier on August 14 and 27, 2018, respectively. Apple
will not ﬁx the ﬁrst one affecting only macOS 10.12, but
USENIX Association
28th USENIX Security Symposium    49
has released software updates addressing the second one on
October 30, 2018, for all Apple OSes [4].
Acknowledgements
This work is funded by the LOEWE initiative (Hesse, Ger-
many) within the NICER project and by the German Federal
Ministry of Education and Research (BMBF) and the State of
Hesse within CRISP-DA. The work was partially supported
by NSF grant 1740907. We thank the Apple Product Security
team for feedback on the paper.
Availability
We release the source code of our AWDL [76] and Air-
Drop [78] implementations as part of the Open Wireless Link
project [81] (https://owlink.org).
References
[1] Miguel E. Andrés, Nicolás E. Bordenabe, Konstanti-
nos Chatzikokolakis, and Catuscia Palamidessi. Geo-
indistinguishability: Differential Privacy for Location-
based Systems. In ACM SIGSAC Conference on Com-
puter and Communications Security (CCS), November
2013. doi: 10.1145/2508859.2516735.
[2] Apple Inc. Use AirDrop on your iPhone, iPad, or
iPod touch, June 2018. URL https://support.
apple.com/en-us/HT204144. [Accessed September
20, 2018].
[3] Apple Inc. Change the name of your iPhone, iPad,
or iPod, October 2018.
URL https://support.
apple.com/en-us/HT201997. [Accessed November
14, 2018].
[4] Apple Inc. About the security content of iOS 12.1,
2018. URL https://support.apple.com/en-in/
HT209192. [Accessed Feburary 14, 2019].
[5] Myrto Arapinis, Loretta Ilaria Mancini, Eike Ritter, and
Mark Dermot Ryan. Analysis of Privacy in Mobile Tele-
phony Systems. International Journal of Information Se-
curity, October 2017. doi: 10.1007/s10207-016-0338-9.
[6] Claudio A. Ardagna, Marco Cremonini, Sabrina De Cap-
itani di Vimercati, and Pierangela Samarati.
An
Obfuscation-Based Approach for Protecting Location
Privacy. IEEE Transactions on Dependable and Secure
Computing, 8, January 2011. doi: 10.1109/TDSC.2009.
25.
[7] Armis Inc. BlueBorne, 2018. URL https://armis.
com/blueborne/. [Accessed November 14, 2018].
[8] Nitay Artenstein.
Broadpwn: Remotely Compro-
mising Android and iOS via a Bug in Broadcom’s
Wi-Fi Chipsets, July 2017. URL https://blog.
exodusintel.com/2017/07/26/broadpwn/.
cessed June 28, 2018].
[Ac-
[9] Michael Backes, Sven Bugiel, Christian Hammer, Oliver
Schranz, and Philipp von Styp-Rekowsky. Boxify: Full-
ﬂedged App Sandboxing for Stock Android. In USENIX
Security Symposium, August 2015.
[10] Xiaolong Bai, Luyi Xing, Nan Zhang, Xiaofeng Wang,
Xiaojing Liao, Tongxin Li, and Shi-Min Hu. Staying
Secure and Unprepared: Understanding and Mitigating
the Security Risks of Apple ZeroConf. In IEEE Sympo-
sium on Security and Privacy (S&P), May 2016. doi:
10.1109/SP.2016.45.
[11] Marco V. Barbera, Alessandro Epasto, Alessandro Mei,
Vasile C. Perta, and Julinda Stefa. Signals from the
Crowd: Uncovering Social Relationships through Smart-
In ACM Internet Measurement Con-
phone Probes.
ference (IMC), October 2013. doi: 10.1145/2504730.
2504742.
[12] Elad Barkan, Eli Biham, and Nathan Keller.
Instant
Ciphertext-Only Cryptanalysis of GSM Encrypted Com-
In Advances in Cryptology (CRYPTO),
munication.
August 2003. doi: 10.1007/978-3-540-45146-4_35.
[13] Sarah Bell. Police investigate ’ﬁrst cyber-ﬂashing’
URL https://www.bbc.com/news/
[Accessed September 25,
case, 2015.
technology-33889225.
2018].
[14] Gal Beniamini. Over The Air: Exploiting Broad-
URL
com’s Wi-Fi Stack (Part 2), April 2017.
https://googleprojectzero.blogspot.com/
2017/04/over-air-exploiting-broadcoms-wi-
fi_11.html. [Accessed June 28, 2018].
[15] Laurent Bindschaedler, Murtuza Jadliwala, Igor Bilogre-
vic, Imad Aad, Philip Ginzboorg, Valtteri Niemi, and
Jean-Pierre Hubaux. Track Me If You Can: On the
Effectiveness of Context-based Identiﬁer Changes in
Deployed Mobile Networks. In Network & Distributed
System Security Symposium (NDSS), 2012.
[16] Vincent Bindschaedler and Reza Shokri. Synthesizing
Plausible Privacy-Preserving Location Traces. In IEEE
Symposium on Security and Privacy (S&P), May 2016.
doi: 10.1109/SP.2016.39.
[17] Bluetooth Special Interest Group (SIG). Bluetooth Spec-
iﬁcation Version 4.1. Technical report, December 2013.
[18] Nicolás E. Bordenabe, Konstantinos Chatzikoko-
lakis, and Catuscia Palamidessi.
Optimal Geo-
Indistinguishable Mechanisms for Location Privacy.
In ACM SIGSAC Conference on Computer and Com-
munications Security (CCS), November 2014.
doi:
10.1145/2660267.2660345.
50    28th USENIX Security Symposium
USENIX Association
[19] Stuart D. Cheshire.
U.S.
Patent Application, (US 2018/0083858 A1), March
2018. URL https://patents.google.com/patent/
US20180083858A1.
Proximity Wi-Fi.
[29] Kassem Fawaz and Kang G. Shin. Location Privacy Pro-
tection for Smartphone Users. In ACM SIGSAC Confer-
ence on Computer and Communications Security (CCS),
November 2014. doi: 10.1145/2660267.2660270.
[20] Aldo Cortesi, Maximilian Hils, Thomas Kriechbaumer,
and contributors. mitmproxy: A free and open source
interactive HTTPS proxy, 2010–. URL https://
mitmproxy.org. [Version 3].
[30] Kassem Fawaz, Huan Feng, and Kang G. Shin. Anato-
mization and Protection of Mobile Apps’ Location Pri-
vacy Threats. In USENIX Security Symposium, August
2015.
[21] Mathieu Cunche. I Know Your MAC Address: Targeted
Tracking of Individual Using Wi-Fi. Journal of Com-
puter Virology and Hacking Techniques, 10, November
2013.
[22] Anupam Das, Nikita Borisov, and Matthew Caesar.
Tracking Mobile Web Users Through Motion Sensors:
Attacks and Defenses. In Network and Distributed Sys-
tem Security Symposium (NDSS), February 2016.
[23] Anupam Das, Nikita Borisov, and Edward Chou. Every
Move You Make: Exploring Practical Issues in Smart-
phone Motion Sensor Fingerprinting and Countermea-
sures. Proceedings on Privacy Enhancing Technologies
(PoPETs), 2018, January 2018. doi: 10.1515/popets-
2018-0005.
[24] Aveek K. Das, Parth H. Pathak, Chen-Nee Chuah,
and Prasant Mohapatra. Uncovering Privacy Leakage
in BLE Network Trafﬁc of Wearable Fitness Track-
In ACM Workshop on Mobile Computing Sys-
ers.
tems and Applications (HotMobile), February 2016. doi:
10.1145/2873587.2873594.
[25] Sanorita Dey, Nirupam Roy, Wenyuan Xu, Romit Roy
Choudhury, and Srihari Nelakuditi. AccelPrint: Imper-
fections of Accelerometers Make Smartphones Track-
able. In Network and Distributed System Security Sym-
posium (NDSS), February 2014.
[26] Adriano Di Luzio, Alessandro Mei, and Julinda Stefa.
Mind Your Probes: De-Anonymization of Large Crowds
Through Smartphone WiFi Probe Requests. In IEEE In-
ternational Conference on Computer Communications
(INFOCOM), April 2016. doi: 10.1109/INFOCOM.
2016.7524459.
[27] Mark Dowd. MalwAirDrop: Compromising iDevices
via AirDrop. In Ruxcon, October 2015. URL http:
//2015.ruxcon.org.au/slides/.
[28] William Enck, Peter Gilbert, Byung-Gon Chun, Lan-
don P. Cox, Jaeyeon Jung, Patrick McDaniel, and An-
mol N. Sheth. TaintDroid: An Information-ﬂow Track-
ing System for Realtime Privacy Monitoring on Smart-
phones. In USENIX Conference on Operating Systems
Design and Implementation (OSDI), October 2010.
[31] Kassem Fawaz, Kyu-Han Kim, and Kang G. Shin. Pro-
tecting Privacy of BLE Device Users. In USENIX Secu-
rity Symposium, August 2016.
[32] Adrienne Porter Felt, Erika Chin, Steve Hanna, Dawn
Song, and David Wagner. Android Permissions De-
In ACM Conference on Computer and
mystiﬁed.
Communications Security (CCS), October 2011. doi:
10.1145/2046707.2046779.
[33] Julien Freudiger. How Talkative is Your Mobile Device?:
An Experimental Study of Wi-Fi Probe Requests. In
ACM Conference on Security & Privacy in Wireless and
Mobile Networks (WiSec), June 2015. doi: 10.1145/
2766498.2766517.
[34] Sébastien Gambs, Marc-Olivier Killijian, and Miguel
Núñez del Prado Cortez. Show Me How You Move and I
Will Tell You Who You Are. In ACM SIGSPATIAL Inter-
national Workshop on Security and Privacy in GIS and
LBS (SPRINGL), 2010. doi: 10.1145/1868470.1868479.
[35] Sébastien Gambs, Marc-Olivier Killijian, and Miguel
Núñez Del Prado Cortez. De-anonymization Attack
on Geolocated Data. Journal of Computer and System
Sciences, 80, December 2014. doi: 10.1016/j.jcss.2014.
04.024.
[36] Clint Gibler, Jonathan Crussell, Jeremy Erickson, and
Hao Chen. AndroidLeaks: Automatically Detecting
Potential Privacy Leaks in Android Applications on a
Large Scale. In International Conference on Trust and
Trustworthy Computing (TRUST). Springer, June 2012.
doi: 10.1007/978-3-642-30921-2_17.
[37] Shyamnath Gollakota, Haitham Hassanieh, Benjamin
Ransford, Dina Katabi, and Kevin Fu.
They Can
Hear Your Heartbeats: Non-Invasive Security for Im-
plantable Medical Devices. In ACM SIGCOMM Com-
puter Communication Review, October 2011.
doi:
10.1145/2043164.2018438.
[38] Google.
Wi-Fi Aware, 2017.
URL https:
//developer.android.com/guide/topics/
connectivity/wifi-aware.
28, 2018].
[Accessed June
USENIX Association
28th USENIX Security Symposium    51
[39] Jun Han, Emmanuel Owusu, Le T. Nguyen, Adrian
Perrig, and Joy Zhang. ACComplice: Location In-
ference Using Accelerometers on Smartphones.
In
IEEE International Conference on Communication Sys-
tems and Networks (COMSNETS), January 2012. doi:
10.1109/COMSNETS.2012.6151305.
[40] Xiuping Han, Zhi Wang, and Dan Pei. Preventing Wi-
Fi Privacy Leakage: A User Behavioral Similarity Ap-
proach. In IEEE International Conference on Commu-
nications (ICC), May 2018. doi: 10.1109/ICC.2018.
8422764.
[41] Harry Harris. Oakland-Maui ﬂight: Pepper spray