Don’t Whisper My Chips
ColinOFlynn.com – DEFCON 2015.
1
Colin O’Flynn – Dalhousie University – Halifax, NS. Canada.
Objective: Learn about all sorts of ‘physical’ layer attacks. 
Critical Difference: Everything I’m showing you is open 
source and freely available. Most of the hardware is 
commercially available (it’s difficult for hardware to be 
free), but you can DIY it too if you wish, or use existing 
tools (e.g. oscilloscope).
www.NewAE.com
Open Source Tools Posted to:
www.ChipWhisperer.com
ColinOFlynn.com – DEFCON 2015.
2
ColinOFlynn.com – DEFCON 2015.
3
ColinOFlynn.com – DEFCON 2015.
4
ColinOFlynn.com – DEFCON 2015.
5
ColinOFlynn.com – DEFCON 2015.
6
Embedded System:
ColinOFlynn.com – DEFCON 2015.
8
Not an Embedded System:
unsigned char correctpin[6] = {1,2,3,4,5,6};
unsigned char enteredpin[6];
read_pin_from_buttons(enteredpin);
for (i = 0; i  okay
rcall Receivebyte
; else receive next character
chpw2:
cp tmp3, tmp1                   ; compare with password
breq chpw1                      ; if equal check next character
cpi tmp1, 0
; or was it 0 (emergency erase)
chpwl:  brne chpwl
; if not, loop infinitely
rcall RequestConfirmation
; if yes, request confirm
brts chpa
; not confirmed, leave
rcall RequestConfirmation
; request 2nd confirm
brts chpa
; can't be mistake now
rcall EmergencyErase
; go, emergency erase!
rjmp Mainloop
chpa:
rjmp APPJUMP                    ; start application
chpwx:
;        rcall SendDeviceInfo
ColinOFlynn.com – DEFCON 2015.
18
ColinOFlynn.com – DEFCON 2015.
19
ColinOFlynn.com – DEFCON 2015.
20
ColinOFlynn.com – DEFCON 2015.
21
• 256 x N guesses required, can reduce this if 
password comes from ASCII-printable characters
• Even if N=256 (very long password!), and can attempt  
only 1/second, still breakable in 
*
*   this program is free software.  you can redistribute it and
*   modify it under the terms of the gnu general public license.
*   there is no warranty.
*
*/
#include "auth.h"
#include "pamfail.h"
int auth_pam(const char *service_name, uid_t uid, const char *username)
{
if (uid != 0) {
pam_handle_t *pamh = NULL;
struct pam_conv conv = { misc_conv, NULL };
int retcode;
retcode = pam_start(service_name, username, &conv, &pamh);
if (pam_fail_check(pamh, retcode))
return FALSE;
retcode = pam_authenticate(pamh, 0);
if (pam_fail_check(pamh, retcode))
return FALSE;
retcode = pam_acct_mgmt(pamh, 0);
if (retcode == PAM_NEW_AUTHTOK_REQD)
retcode =
pam_chauthtok(pamh, PAM_CHANGE_EXPIRED_AUTHTOK);
if (pam_fail_check(pamh, retcode))
return FALSE;
retcode = pam_setcred(pamh, 0);
if (pam_fail_check(pamh, retcode))
return FALSE;
pam_end(pamh, 0);
/* no need to establish a session; this isn't a
* session-oriented activity...  */
}
return TRUE;
}
ColinOFlynn.com – DEFCON 2015.
56
ColinOFlynn.com – DEFCON 2015.
57
ColinOFlynn.com – DEFCON 2015.
59
int i,j,count;
while(1){
count = 0;
for (j = 0; j 
ColinOFlynn.com – DEFCON 2015.
67
ColinOFlynn.com – DEFCON 2015.
68
ColinOFlynn.com – DEFCON 2015.
70
ColinOFlynn.com – DEFCON 2015.
72
ColinOFlynn.com – DEFCON 2015.
73
ColinOFlynn.com – DEFCON 2015.
74
ColinOFlynn.com – DEFCON 2015.
75
ColinOFlynn.com – DEFCON 2015.
76
ColinOFlynn.com - HTCIA 2014. Halifax, NS
77
ColinOFlynn.com – DEFCON 2015.
78
ColinOFlynn.com – DEFCON 2015.
79
ColinOFlynn.com – DEFCON 2015.
80
ColinOFlynn.com – DEFCON 2015.
81
ColinOFlynn.com – DEFCON 2015.
82
Find those tools:
www.ChipWhisperer.com
Find me:
www.OFlynn.com
Buy Stuff:
www.newae.com
Twitter: @colinoflynn
Email: PI:EMAIL
ColinOFlynn.com – DEFCON 2015.
83