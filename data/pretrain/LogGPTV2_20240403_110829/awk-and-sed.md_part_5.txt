7
有3种方式可以指定命令行上的多重指令：
代两字母缩写词前面的空格。
为了在城市（city)和（state）之间放置逗号，指令用一个逗号和一个空格取
换命令中包含空格：
例如，
用空格决定提交给程序独立参数，特殊的 shel字符在调用之前被展开）。
并不是在任何情况下都需要将指令用单引号包围起来，
键
该指令只影响了3行，但显示出了所有行。
.C
list
，就会出现多行输入的提示符(>).
。使用单引号可以阻止 shelI解释编辑指令中的特殊字符或空格（shel丨使
使用 Bourne shel丨的分行指令功能（注1）。在输入单引号后按 return
 sed -e ′ s/ MA/, Massachusetts/'
 sed ′ s/ MA/, Massachusetts/; s/ PA/, Pennsylvania/' list 
用分号分隔指令。
√
 在每个指令前放置-e．
Sal Carpenter, 73 6th Street,
Amy Wilde, 334 Bayshore Pkwy,
Terry Kalkas, 402 Lans Road, Beaver Falls PA 
Orville Thomas, 11345 0ak Bridge Road, Tulsa 0K
Alice Ford, 22 East Broadway, Richmond VA 
John Daggett, 341 King Road, Plymouth, 
$ sed ’ s/ MA/, Massachusetts/’ list
√
Hubert Sims, 328A Brook Road, Roanoke VA
Eric Adams, 20 Post Road, Sudbury, Massachusetts
Sal Carpenter, 73 6th Street,
Hubert Sims, 328A Brook Road, Roanoke VA 
Terry Kalkas, 402 Lans Road, Beaver Falls PA 
Orville Thomas, 11345 0ak Bridge Road, Tulsa 0K
s/ CA/, California/'
以上例子可以不使用单引号，但下一个例子就需要使用单引号，因为替
S/ PA/,
S/ MA/,
Massachusetts/
 Pennsylvania/
QQ群：
50192241
list
- 30
Boston,
Mountain View CA 
Boston Massachusetts
Mountain View CA
-e ′ s/ PA/, Pennsylvania/'
Massachusetts
 Massachusetts
第二章
但是你应该养成这个习
了解基本操作
---
## Page 31
sedscr.
将想要执行的所有编辑命令都放置在文件中。我们按照惯例创建临时脚本文件
式使用-F选项来指定命令行上的脚本文件的名字，格式如下：
令的脚本文件的原因。编辑脚本只是一系列要依次的简单的 sed 命令。这种形
在命令行上输入较长的编辑脚本是不实际的。这就是通常最好创建包含编辑指
脚本文件
以下 GNU sed 给出了更清楚的提示:
Sed 通常会显示任何它不能执行的行，
的
注意输入以下不完整的语法将发生的情况：
Sed 命令的语法可以被细化，
失误的命令
注
命
尾
这
错误是什么（注2）。在上述情况下，
1:
令(或者通过输入 sh 临时进行 Bourne shell，然后用心上方法键入命令。
使用分号，
种技术在C shell中不能使用。C shell中采用的方法是，
s/ MA/, Massachusetts/
$ cat sedscr 
sed
 gsed: Unterminated
$ gsed -e ’ s/MA/Massachusetts’ list
$ sed -e ′ s/MA/Massachusetts’
Sal Carpenter,
Hubert Sims, 328A Brook Road,
Terry Kalkas, 402 Lans Road, Beaver Falls, Pennsylvania
Alice Ford, 22 East Broadway, Richmond 
John Daggett, 341 King Road, Plymouth, 
-f scriptfile file
目前，
样工作，
 并且通过用反斜杠作为每一行的结束，从而可以输入跨越多行的
，有许多与 Bourne shell 兼容的 shell，能够像这里描述的那
QQ群:
如 ksh, bash, pdksh 和 zsh 等。
73 6th Street,
‘s’command
50192241
在使用时很容易犯错误或者忽略掉需要的元素。
但是它不会告诉你使用这个命令所发生
 Boston, 
 Mountain View, California
Roanoke VA 
，标记搜索和替换命令末尾的斜杠丢失
 list
 Massachusetts
Tulsa OK
VA
 Massachusetts
第二章
在每个指令的结
了解基本操作
---
## Page 32
创建临时文件并使用mv 改写原始文件。
在第四章“编写 sed脚本”中将看到名为 runsed 的 shelI脚本，它能够自动的
文件，那么可以采用mv 命令并将它做为单独的步骤来处理。但是首先要确保编
操作符在 she做任何其他事情之前截取文件）。如果想用输出文件取代输入
这项工作需要在一个文件名后面指定一个shelI的1/0重定向符号。例如：
只有将 sed 的输出重定向到另一个程序中，才能够捕获文件中的输出。要完成
保存输出
可以保存在个人的或系统共享库中。
如果 sed 脚本能再次使用，那么应该重新命名这个脚本并保存它。有用的脚本
再说一次，显示在屏幕上的结果是临时的，输入文件中没有发生改变。
list 中的每一行：
下面的命令读取 sedscr 中的所有替换命令，并将这些命令应用于输入文件
注2:
阻止输入行的自动显示
辑的脚本是正确的！
不要将输出重定向到正在编辑的文件中，
Hubert Sims, 328A Brook Road,
Orville Thomas, 11345 0ak Bridge Road, Tulsa, 0klahoma
Alice Ford, 22 East Broadway, Richmond, Virginia 
John Daggett, 341 King Road,
$ sed -f sedscr list 
s/ OK/, Oklahoma/
$ sed -f sedscr list > newlist
Sal Carpenter,
Amy Wi lde, 334 Bayshore Pkwy,
Eric Adams, 20 Post Road, Sudbury, Massachusetts 
Terry Kalkas, 402 Lans Road, Beaver Falls, Pennsylvania
S
S
s/
VA/ ,
CA/ ,
PA/,
missing on substitution :s/MA/Massachusetts"
例如:在 sunos 4.1.X上，sed 可以报告“sed:Ending delimiter
Virginia/
California/
些厂商在这方面似乎已经做了改进。
Pennsylvania/
QQ群：
73 6th Street,
50192241
Pl ymouth, 
Boston, 
 Mountain View, California
否则就会使它变成乱码（“>”重定向
 Massachusetts
 Massachusetts
第二章
了解基本操作
---
## Page 33
awk 的语法如下：
awk 程序通常被放置在可以对它们进行测式和修改的文件中。用脚本文件调用
分号分隔命令或使用 Borune shell的多行输入功能。
shelI将它们解释为特殊符号)。可以用与 sed 相同的方式输入多重命令行：用
单引号中，
每次从一个或多个文件中读入一行或从标准输入中读入一行。指令必须包含在
命令行的语法是：
运行 awk 
使用awk
F
选项
表 2-1：sed 的命令行选项
表 2-1 汇总了 sed 的命令行选项。
选项总结 
令的给出顺序组合起来的。在 sed 的unix版本中似乎支持这项功能，但是这种
通过合并命令行上的-e 和-F 选项可以构建一个脚本。该脚本是所有命令按命
混合选项（POSIX)
将这一输出与本节中的第一个示例进行比较。这里只会显示受命令影响的行。
时，每个要生成输出的指令都必须包含打印命令p。请看下面的示例。
sed 的默认操作是输出每个输入行。-n 选项可以阻止自动输出。当指定该选项
与
re
特征在帮助页中没有明确给出。POSIX标准明确地要求这种特征。
脚本文件。
 sed 相似，awk 为每个输入行执行一套指令。可以在命令行上指定指令或创
awk
 Sal Carpenter, 73 6th Street, Boston Massachusetts
Eric Adams, 20 Post Road, Sudbury Massachusetts 
John Daggett,
$ sed -n -e ′
，从而与 shell区别开（指令几乎总是包含大括号和/或美元符号，
’instructions'
QQ群：
阻止输入行的自动输出
跟随脚本中的文件名
编辑随后的指令
描述 
 341 King Road, Plymouth Massachusetts
 s/MA/Massachusetts/p' list
50192241
 files
第二章
了解基本操作
---
## Page 34
每条记录的第一个字段。
记录的哪些部分要包括在报表中。下一个示例使用一条print 语句限制只输出
括在报表中的记录，
从文件中提取有用的信息。可以认为惟上模式指定了一种条件，用于选择要
程。这个默认操作是打印匹配这种模式的每一行。
印语句应用于所有的行。下一个示例指定了“/MA/”模式，但是其中没有过
“$1”表示每个输入行上的第一个字段的值。
第一个示例包含单个指令，用于打印输入文件中每行的第一个字段。
段。$O 代表整个记录。我们来看几个示例，使用样本输入文件list.
连续的空格或制表符看做一个定界符。awk 允许在模式或过程中引用这些字
空格或制表符分隔）解释为每一个字段(可以改变这些默认设置)。一个或多个
-f 选项的工作方式与在 sed 中相同。
本例打印了3行。
在通常情况下，
表达式的值或打印当前输入行的内容。
数
身
尽管 awk 指令与 sed 指令的结构相同，都由模式和过程两部分组成，但过程本
取代了使用一个或两二个字符组成的命令序列。例如，使用 print语句打印
有很大的不同。awk看上去不像编辑器而更像一种程序设计语言。语句和函
$ awk’/MA/↓print $1}’list
Sal Carpenter, 73 6th Street, Boston MA 
$ awk ’ /MA/'
Amy
Alice
$ awk’{print $1}’list
Eric
John
Hubert
Eric
Terry
Orville 
awk -f script files
Eric Adams, 20 Post Road, Sudbury MA 
John Daggett,
S
John
，awk 将每个输入行解释为一条记录而将一行上的每个单词（由
正如在第一章所提到的那样，
QQ群：
，也就是这些记录必须包含字符串“MA”。现在还可以指定
 341 King Road, Plymouth MA
list
50192241
34
。因为这里没有指定模式，
 awk 程序更像一种查询语言,
第二章 
了解基本操作
，所以打
包
---
## Page 35
下一个示例将每个字段单独打印在这一行上。多重命令由分号隔开。
不要改变字段分隔符的-F 选项与指定脚本文件名的-F选项弄混。
字段中的任一个：全称、街道地址或城市和州。
在下一示例中，使用-F选项将字段分隔符改变为逗号。它使我们能够检索3个
分隔符将输入分隔成字段。
成“word（单词）”，
如果尝试着大声音阅读这一句话：print the first word of each line 
73 6th Street
Mountain View CA
Sudbury MA 
20 Post Road
341 King Road
$ awk -F,
Sal Carpenter
Eric Adams 
 Sal
Boston MA
Sal Carpenter
334 Bayshore Pkwy
Amy Wilde
Roanoke VA
328A Brook Road
Hubert Sims 
Eric Adams
Beaver Falls PA
402 Lans Road
Terry Kalkas
Tulsa OK 
11345 0ak Br idge Road
Orville Thomas 
Richmond  VA 
22 East Broadway
Alice Ford  
Plymouth MA
John Daggett
John Daggett 
′print $1; print $2; print $3”′ list
QQ群：
这是因为在默认情况下，awk 使用空格或制表作为字段
50192241
53
list
第二章 
了解基本操作
可以把它说
---
## Page 36
每条记录中提取州的名字。
中，由 nameState 产生的输出被输送到一个 awk 程序中，这个 awk 程序用于从
该程序(使用输入文件list)的输出，
执行这些命令，
本通常已经足够，它可被再次用做名为 nameState 的脚本文件：
个综合使用 sed 和 awk 来产生报表的示例。用州的全名代替邮政编码的 sed 脚
在unix中,
同时使用 sed和 awk
表
表 2-2 汇总了 awk 命令行的选项同。
选项总结
会产生消息：
里不引用特殊版本的消息;当出现问题时它是显而易见的。下面任何一种情况都
当遇到程序中的问题时，
出错信息
的 awk 示例中，注意如何将前导空白看做是第二个和第三个字段的一部分。
前面的示例使用 sed 改变了输入数据的内容。使用 awk 重新排列数据。在上面
乐
1
●
然，要处理所有的州，
2-2：awk 的命令行选项
S/
S
$ cat nameState
S
S
没有用斜杠（//）中将正则表达式括起来
VA/,
没有用大括号（Ⅱ）将过程括起来
PA/,
MA/ ,
CA/,
OK/,
管道可用于将一个程序的输出作为输入传递给另一个程序。参看几
 Virginia/
 Okl ahoma/
 California/
Pennsylvania/
Massachusetts/
，则要确保不会生成不必要的替换。
跟随var=value
跟随脚本的文本名
改变字段分隔符