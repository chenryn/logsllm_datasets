title:blackhat:asia-21 How Did the Adversaries Abusing the Bitcoin Blockchain Evade Our Takeover?
Cyber security has been a game of cat-and-mouse. In the past, we have seen the malware ecosystem adopt concepts such as code obfuscation, polymorphism, domain-generation algorithms (DGAs), as well as virtual machine and sandbox evasion whenever defenses were able to perform consistent and pervasive suppression of these threats.Some adversaries have recently started to use the Bitcoin blockchain for communicating command & control (C&C) information. As no one can block or remove transactions from the blockchain once the transactions are confirmed by miners, this means that adversaries do not have to fear that transactions with their C&C location are taken down. This latest innovation in malware tactics, techniques, and procedures (TTPs) means that existing common defenses such as DGA precomputation or sinkhole domains no longer work.We have monitored the malicious activity by one of the malware authors abusing Bitcoin blockchain for hiding their C&C location for over one year from mid-2019. During our monitoring, they repeatedly conducted trial-and-error and evolved TTPs since they did not understand the best solution to this new attack. Based on the insights from the observation, we realized temporal takeover of the IP address which malware communicates to from the adversary's C&C server to our sinkhole server. However, they implemented the evasive mechanism against our takeover. In this presentation, we will provide the audience with the way of analyzing Bitcoin and C&C operation, searching malware samples that communicate to the C&C IPs from transactions in the blockchain, and detecting the change of TTPs based on our experience of confrontation with the actual adversaries. In addition, we will show both our takeover and the evasive mechanism by the adversaries. Since transactions in the blockchain are open data, the audience will be able to deep dive into the malicious behavior soon after our presentation.