title:A First Look at the Misuse and Abuse of the IPv4 Transfer Market
author:Vasileios Giotsas and
Ioana Livadariu and
Petros Gigis
A First Look at the Misuse and Abuse
of the IPv4 Transfer Market
Vasileios Giotsas1(B), Ioana Livadariu2, and Petros Gigis3,4
1 Lancaster University, Lancaster, UK
PI:EMAIL
2 Simula Metropolitan, Oslo, Norway
3 University College London, London, UK
4 Foundation for Research and Technology-Hellas (FORTH-ICS), Patras, Greece
Abstract. The depletion of the unallocated IPv4 addresses and the slow
pace of IPv6 deployment have given rise to the IPv4 transfer market,
the trading of allocated IPv4 preﬁxes between organizations. Despite
the policies established by RIRs to regulate the IPv4 transfer market,
IPv4 transfers pose an opportunity for malicious networks, such as spam-
mers and bulletproof ASes, to bypass reputational penalties by obtaining
“clean” IPv4 address space or by oﬄoading blacklisted addresses. Addi-
tionally, IP transfers create a window of uncertainty about the legitimate
ownership of preﬁxes, which leads to inconsistencies in WHOIS records
and routing advertisements. In this paper we provide the ﬁrst detailed
study of how transferred IPv4 preﬁxes are misused in the wild, by syn-
thesizing an array of longitudinal IP blacklists, honeypot data, and AS
reputation lists. Our ﬁndings yield evidence that transferred IPv4 address
blocks are used by malicious networks to address botnets and fraudulent
sites in much higher rates compared to non-transferred addresses, while
the timing of the attacks indicate eﬀorts to evade ﬁltering mechanisms.
Keywords: IPv4 transfers · Routing · BGP · Blacklists
1 Introduction
The depletion of the unallocated IPv4 addresses combined with the slow tran-
sition to IPv6 has led to the emergence of a secondary market for ownership
transfers of IPv4 addresses. However, the IPv4 market has been poorly reg-
ulated due to the lack of widely adopted IP preﬁx ownership authentication
mechanisms, inconsistent contractual requirements between legacy and allocated
address space [44], and policy incongruences among Regional Internet Registries
(RIRs). As a result, IPv4 transfers have become target of fraud and abuse by
malefactors who try to bypass the legal IP ownership processes [19]. RIRs have
responded to the emergence of the IPv4 market by establishing policy frame-
works that aim to safeguard the hygiene of the accuracy of registered IP blocks
and provide oversight and transparency on how organizations trade IPv4 address
c(cid:2) Springer Nature Switzerland AG 2020
A. Sperotto et al. (Eds.): PAM 2020, LNCS 12048, pp. 88–103, 2020.
https://doi.org/10.1007/978-3-030-44081-7_6
A First Look at the Misuse and Abuse of the IPv4 Transfer Market
89
blocks [19,38]. However, the eﬀectiveness of these policies in preventing abuse of
the IPv4 market remains unclear. Additionally, these policies focus only owner-
ship and utilization issues, and they do not have provisions for malicious usage of
the transferred space, for instance by bulletproof hosters who seek clean address
space to address botnets and fraudulent sites. Exchanges between operators in
mailing lists and messaging boards show that the operational community is wor-
ried about these dangers but still face signiﬁcant diﬃculties when purchasing or
selling address space [32,43].
In this paper we aim to shed light on the misuse and abuse of the IP transfer
market. To this end, we combine a large collection of longitudinal control-plane
and data-plane data to analyze and verify the information reported by RIRs on
IP transfers. We ﬁnd that the reported transfer dates and recipient organizations
do not reﬂect the state of WHOIS registries and BGP routing for more than
65% of the transferred preﬁxes. Additionally, 6% of the preﬁxes covered with
ROAs have an inconsistent origin ASN. We then compile and analyze a large-
scale dataset of malicious activities that covers a period of more than a decade,
derived from IP traﬃc traces and control-plane paths, including IP blacklists,
honeypots, preﬁx hijacking detection and AS reputation mechanisms. Our ﬁnd-
ings reveal that the transferred IP space is between 4x to 25x more likely to be
blacklisted depending on the type of malicious activity, while the majority of the
transferred IPs are blacklisted after the transfer date, even when the transferred
address space was deployed and visible to IP scans at least a month before the
transfer. The disproportionate representation of transferred preﬁxes in blacklists
persists even when we ﬁlter-out the address space used by well-known legitimate
networks, such as cloud platforms (e.g. Amazon Web Services, Google Cloud)
whose Infrastructure-as-a-Serive (IaaS) is often abused to host malware in short-
lived Virtual Machines (VMs). Finally, we provide evidence that ASes detected
to be serial BGP hijackers or bulletproof hosters are over-represented in the IPv4
market and exhibit suspicious patterns of transactions both as buyers and sell-
ers. These results oﬀer new insights on agile blacklist evasion techniques that can
inform the development of more timely and accurate blacklisting mechanisms.
Additionally, our work can inform debates on developing and evaluating RIR
policies on IP transfers to improve the hygiene of the ecosystem.
2 Background and Related Work
2.1 IP Transfer Market
Today, the available IPv4 address space of all Regional Internet Registries (RIRs)
except AFRINIC has been depleted [21]. Despite increasing pressure on network
operators to enable IPv6, less than 30% of the ASes are currently originating
IPv6 preﬁxes [22]. Since RIRs are unable to allocate additional IPv4 addresses,
many network operators try to prolong the lifespan of IPv4 by buying address
space allocated to other networks, which has led to the emergence of a secondary
IP market. This market has been characterized as murky [44], due to the lack of
transparency and mechanisms to authenticate the ownership of IP space.
90
V. Giotsas et al.
In an eﬀort to prevent abuse of this secondary IP market, all RIRs have
devised intra-registry transfer policies, starting with RIPE in 2008 [3,6,9,29,51,
51]. All RIRs, except RIPE, have imposed restrictions on IP transactions, that
require a minimum size of transferred address space and adequate justiﬁcation
of need from the side of buyers. Inter-regional transfers have been approved by
ARIN, APNIC and RIPE. Organizations involved in such transactions have to
comply with the inter-RIR transfer policies of their local registry [10,52]. ARIN
and APNIC follow the same need-based policy for intra-RIR and inter-RIR trans-
actions. RIPE, in contrast to its intra-RIR policy, requires inter-RIR buyers to
document the utilization of at least 50% of the transferred address space for
ﬁve years. However, these regulations do not apply in the case of transfers that
occur due to mergers and acquisitions. Under these policies, the ﬁrst intra-RIR
and inter-RIR transfers occurred October 2009 and October 2012, respectively.
The IPv4 transfer market size has signiﬁcantly increased over the years, from
17, 408 to 40, 463, 872 IPs for intra-RIR transfers, and from 1, 792 to 1, 885, 440
IPs for inter-RIR transfers, with the highest activity occurring within RIPE and
ARIN. Moreover, 96% of the IPv4 addresses are exchanged within the same reg-
istry and most of these IP transactions occur within the North America region,
while 85% of the inter-RIR transfers originate from ARIN. Despite the increas-
ing prominence of the IPv4 market, there are only a few studies of its ecosystem.
Periodically, RIRs and IPv4 address brokers report on the trends and evolution
of the IP transactions [1,8,47–50,58], but also a portion of buyers have reported
their experiences [7,19,37]. Early academic studies [17,30] discussed the possi-
ble implications of market-based mechanisms for reallocating IPv4 addresses.
Mueller et al. [34,35] used the list of published transfers to analyze the emerging
IPv4 transfer market by quantifying the amount of legacy allocations exchanged
on the markets and the impact of the need-based policies on the utilization of
the transferred blocks. Livadariu et al. [23] provided a comprehensive study on
the IPv4 transfer market evolution, the exchanged IPv4 blocks, and the impact
on the routing table and IPv6 adoption. The authors also proposed a method for
inferring IP transfers from publicly available data, i.e., routing advertisements,
DNS names, RIR allocation and assignment data. To the best of our knowl-
edge, no prior work has studied the IPv4 transfer market from the perspective
of fraudulent behavior and misuse.
2.2 Malicious Internet Activities
An IP blacklist is an access control mechanism that aims to block traﬃc from
IP addresses which have been detected to originate fraudulent activities, such
as spamming, denial of service, malware or phishing. Such blacklists are com-
piled using spamming sinkholes, honeypots, logs from ﬁrewalls, Intrusion Detec-
tion Systems (IDS), and anti-virus tools distributed across the Internet. Several
works have studied malicious Internet activities based on IP blacklists [4,65].
Ramachandran et al. [39] provided one of the ﬁrst studies, by analyzing over
10 million messages received by a spam sinkhole over a period of 18 months,
and by correlating them with lookups to 8 blacklists. Their results showed that
A First Look at the Misuse and Abuse of the IPv4 Transfer Market
91
Fig. 1. Overview of datasets and measurement methodology.
combined use of blacklists detects 80% of the spamming hosts. Moreover, the
network behavior of serial spammers has distinctive characteristics which can be
exploited to develop behavioral and predictive blacklisting [40]. Shina et al. [56]
evaluated the accuracy of four spamming blacklists, and found that blacklists
have a very low False-Positive Rate, with 2 of the blacklists having less than 1%
FPR, but high false-negative rate (above 36%) when used individually. A similar
study by K¨uhrer et al. [28] evaluated the eﬀectiveness of 18 blacklists, 15 public
and 3 by AntiVirus (AV) vendors. The authors found that blacklists derived
from AntiVirus vendors are able to detect at least 70% of the malicious domains
for 13 types of malware, and at least 90% for 7 of these types, outperforming
signiﬁcantly public blacklists. Zhao et al. [64] compiled an extensive historical
blacklist dataset to analyze the trends and evolution of malicious activity over
the span of a decade.
In addition to detecting malicious activity through monitoring data-plane
traﬃc, an array of studies developed techniques to detect attacks through
control-plane data. Shue et al. [55] studied the connectivity of ASes that are
over-represented in 10 popular blacklists. They found that a small number of
ASes with a disproportionate fraction of blacklisted address space are more
likely to have dense peering connectivity and exhibit higher frequency of peering
changes. Konte et al. proposed ASwatch [27], a system that aims to identify
bulletproof hosting ASes by inferring irregularities in the routing and connec-
tivity patterns. Testart et al. [60] proﬁled serial preﬁx hijackers by developing
a supervised machine learning model, based on which they analyzed 5 years of
BGP data to infer 934 ASes that exhibit persistent misbehavior.
We utilize insights and data from the above works to conduct a comprehensive
analysis of malicious activity involving transferred IP preﬁxes and organizations
that participate in the transfer market. We combine both data-plane and control-
plane data to compile an extensive dataset of attacks. Our blacklist dataset
combines a large number of blacklists compiled by AV vendors, which was found
to be the best approach to maximize coverage and minimize false-positives.
92
V. Giotsas et al.
3 Datasets and Methodology
In this section we present the data and methods that we employ to analyze
malicious activities and misuse of transferred IP address space. Figure 1 shows
how we synthesize and process an array of chosen datasets.
3.1 Processing of IPv4 Transfers
Collection of Reported IP Transfers. As a ﬁrst step of our methodology
we collect the list of reported intra-RIR and inter-RIR IP transfers, as published
by the RIRs. For each transferred resource, we extract the IPv4 address block,
the transfer date, and the names of the seller and buyer organizations. Note that
none of the RIRs provides the AS Number (ASN) of the organizations involved
in the transfer. In the case of inter-RIR IP transactions we also retrieve the
RIR for both the seller and the buyer organizations. For intra-RIR IP transfers,
ARIN and RIPE also indicate the transfer type, namely if a transfer occurred
due to changes within an organization (merger and acquisitions), or as a sale
of address space between distinct organizations. However, this information is
not available for inter-RIR transfers and for transfers within the APNIC and
LACNIC regions. Overall, we collected 30, 335 transfers involving 28, 974 preﬁxes
between 2009-10-12 and 2019-08-24. Of these transfers, 9, 564 (31.5%) are labeled
as Mergers/Acquisitions, 17, 934 (59.1%) as IP sales, while the rest 2, 837 (9.4%)
are not labeled.
Mapping of Organization Names to ASNs. We aim next to ﬁnd the ASes
that map to the organizations active on the IP transfer markets. To this end,
we collect historical WHOIS records every 3 months throughout the IP transfers
collection period, i.e., from October 2009 to August 2019. For each allocated ASN
we extract the AS name and the corresponding organization name, and we try
to match the organization names in the RIR transfer lists against the extracted
WHOIS ﬁelds. We were able to map 8, 413 out of the 15, 666 organizations
involved in the transfer market, 54% of the buyers and 57% of the sellers. Overall,
for 48% of the transfers we managed to map both the seller and the buyer, for
68% only the seller, and for 64% of the transfer only the buyers. Organizations
may not be mapped to an ASN for multiple reasons: an organization may not
have an ASN and instead advertise the transferred address space through its
upstream providers, some Local Internet Registries (LIRs) may have operate no
ASNs, while other organizations may operate ASNs under diﬀerent names [54].
Inference of Transfer Types. For the 9.4% of the transfers without reported
transfer type (merger/acquisition, or IP preﬁx sale), we try to infer if the trans-
fer occurred between siblings. For organizations which we successfully mapped
to ASNs, we use CAIDA’s AS-to-Organization inference [14] closest to the date
of the transfer. Additionally, for inter-RIR transfers and for organizations not
A First Look at the Misuse and Abuse of the IPv4 Transfer Market
93
Only Before
Only After
Only Before
Before and After
Before and After
 20000
 15000
 10000
 5000
s
e
x
i
f
e
r
p
f
o
r
e
b
m
u
N
s
e
s
s
e
r
d
d
a
P
I
f
o