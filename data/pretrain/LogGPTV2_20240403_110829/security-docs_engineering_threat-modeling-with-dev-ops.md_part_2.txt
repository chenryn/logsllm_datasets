>
> Start using the WITHOUT clause within your user stories.
>
> Map the threats you identify to user stories with WITHOUT clauses, and vice versa.
### An integrated experience
You can apply the same idea to other scenarios. For example, the threat model could link the Security Requirements with artifacts inside the threat model itself – like threats and mitigations – and those in the Track & Bug Tracking tool. For example, the requirement to implement monitoring for identifying attacks in progress should be mapped to all those mitigations related to monitoring and then to the corresponding artifacts in the Task & Bug Tracking tool. As a result, it would be easy to identify situations where a Security Requirement is not realized: in fact, it would not be linked to anything.
You can use the same links between the artifacts in the Task & Bug Tracking tool and the threats and mitigations identified by the threat model to facilitate the prioritization of the security activities. Security is usually implemented last, sometimes to address reactively vulnerabilities identified by some tool or a Penetration Test. On the contrary, it would be most effective to implement the mitigations along with the related user stories or features. Why wait to implement the controls to secure the credit card details when you should implement them along with the related payment functions? The threat model should highlight those relationships and provide a simple way to determine when implementing some feature during a Sprint requires the implementation of some related security feature. This information could be used, for example, during the Sprint Planning meeting to have a meaningful discussion and drive an informed prioritization. The mechanism is simple. Let's suppose that the Product Owner for a project we work on decides to plan a user story for the next Sprint. The said user story has a WITHOUT clause that is linked to threat. The threat model identifies several mitigations for the same threat. Therefore, we can immediately deduce that we should prioritize one or more of the identified mitigations.   
![A diagram showing how the link between threats and mitigations can be used for prioritizing security.](media\prioritizingsecurity.png)   
_Figure 2: Prioritizing security_
For example, in the picture above, we can see that User Story 1 is linked to threat 1, which in turn is linked to mitigations A and B. Therefore, we should also consider implementing one or both of those mitigations.
> **What can you do today?**
>
> Link user stories with WITHOUT clauses to the work items corresponding to the selected mitigations using the threat model as a reference. When planning the next Sprint, be sure to prioritize the linked security activities when you implement one of those user stories with WITHOUT clauses.
### Integration to highlight misalignments
Once we start thinking about how we could link the artifacts composing the threat model with those in the Task & Bug Tracking tool, it becomes easier to identify opportunities for improving the quality of both. The key is to leverage their relationships to highlight discrepancies and leverage the information present in one to supplement, integrate, and interpret what is present in the other. As discussed above, you can do that without significantly impacting how the team already works. That is because the approach relies on existing information and creates relationships between the various objects in the various worlds. Therefore, the Threat Model would become the source of truth for the solution's security. At the same time, the Backlog is continuously aligned with the solution's status.
> **What can you do today?**
>
> Regularly verify that there are no unmapped threats or user stories with WITHOUT clauses.
### Threat modeling and the operations
All those ideas are mainly focused on the development side of DevOps. Can we do something to improve Operations as well? We do think so. For example, it would be possible to use threat modeling as a tool to facilitate Root Cause Analysis because it provides a comprehensive view of the system from a security perspective and thus can provide a better understanding of the implications of some attacks. To achieve that, it would be necessary to integrate the threat model with the existing feeds from the chosen Monitoring tools. This approach may represent a complement for the chosen SIEM.
Another idea for integrating threat modeling with Operations is to use the first to drive the design of how the latter could happen. An example of that is the design of events for the solution. Threat modeling identifies possible attacks, and we can use that knowledge to identify events that the solution in scope may raise when those attacks fail. If you do strict input validation, a malicious attacker would need a few attempts before succeeding. Initially, the attempts fail, and one of them eventually succeeds. By raising events for each failure and triggering alerts when some threshold is reached, you may be able to detect attacks and take actions to remediate them. Those situations are rarely detected if you limit yourself to monitoring the infrastructure. Therefore, it is necessary to include custom events, which the team must design and implement before the SOC can leverage them.
Moreover, the latter may not know much about the solution. Therefore, the SOC may not be able to determine how to react when input validation fails. Unfortunately, when a data breach occurs, it is imperative to react fast to reduce the direct damage and the probability and entity of eventual fines.
Therefore, we need to plan in advance what needs to be monitored, under what conditions we may have a problem, and what to do when that happens. The best way to identify those events is to rely on a threat model. Therefore, it would be helpful to leverage it to generate standardized artifacts to guide and accelerate the implementation of the necessary configurations to drive Monitoring and Auditing and facilitate Incident Response.
> **What can you do today?**
>
> Actively use threat model to identify events you can raise for each threat. Those events may be provided by the infrastructure, or something that the application must raise. Include work items in your backlog to ensure that those events are implemented.
>
> Work actively with your Operations and Security teams, including the SOC team, to ensure that the events are leveraged to raise alerts and identify Security Incidents.
### The impact on the ROI
You may wonder why those techniques may positively impact the ROI of threat modeling. From our point of view, they are crucial for increasing the value of threat modeling for the DevOps teams. The problem we have seen repeatedly is that those teams perceive security as a cost that provides limited value and requires much unforeseen work. Sometimes, it is unclear why they should invest so much of their time fixing security. As a result, security becomes a problem instead of being an opportunity. Threat modeling has the potential to overcome those issues because it provides the reasons to implement security. Moreover, it can be started early in the development process and avoid design mistakes that may cost dearly if not detected soon. The techniques above aim to better integrate threat modeling with DevOps. This ensures that business decision-makers and developers perceive threat modeling as a natural complement to the development and operations process. Therefore, the value received by adopting threat modeling increases, and its costs decrease because of the integration with the various tools already in use.
## Simplifying the work for threat modelers
Another important aspect necessary to improve the ROI of threat modeling is related to reducing its cost and increasing the number of people able to deliver it while maintaining more homogeneous quality levels.
There are many attempts to address the shortage of competent people. Some of them are based on the active involvement of the whole DevOps team in the threat modeling exercise. The idea is to identify a leader of the initiative, that is someone with intermediate knowledge about the process but is not necessarily an expert, and have her lead the discussion among the other team members. This approach is actively endorsed by the signatories of the Threat Modeling Manifesto.
We do agree that this approach allows to get good value and represents an improvement over the current situation. It also provides good insights and enables the team to grow its security culture. Nevertheless, it is not without downsides because it covers just a few issues, leaving out a lot. This creates a consistency problem because it would be too easy to go down the rabbit hole and waste precious time on secondary issues, missing important ones. The leader's experience would play a significant role in preventing those situations from happening. Moreover, this approach requires much time from all team members to discuss each issue.
For this reason, even spending a couple of hours per Sprint for this exercise may represent a significant investment. Everyone knows that most teams tend to waste time on big meetings involving everyone, and those threat modeling sessions would not make an exception. Still, this approach is excellent for small products, where the team comprises a handful of senior members.
### A different approach
Given the limitations of the previous approach, we prefer to limit the number of meetings, their length, and the number of participants. Therefore, the responsibility of the threat modeler would be more significant: not only to lead the interviews but also to create and maintain the threat model itself. This approach requires more significant competencies and expertise. Threat modelers may be represented by Security Champions or by members of the internal Security team. Most organizations would go for the first because the Security team is typically fully booked.
Security Champions are members of the DevOps teams with a particular interest in security. They are not experts by any means, but they have a basic knowledge and the willingness to improve the security posture of their team. The idea is to create a privileged connection between the Security Champions and the internal Security team so that the first are empowered to assist their teams in doing the right thing, while the Security team can reduce its workload. With threat modeling, the Security Champions would act as threat modelers, and the internal Security team would have the responsibility to guide them and review their work.
> **What can you do today?**
>
> Investigate the possibility to adopt a Security Champions program and to leverage it to further strengthen your Secure Software Development Lifecycle.
### The role of knowledge bases
A significant problem with threat modeling is ensuring that the quality of the experience and the value for the DevOps team is high no matter who performs the threat model. With Security Champions, this problem becomes even more urgent. An idea to address this is to provide knowledge bases to drive the creation of the threat model. Knowledge Bases for threat modeling are packages of information about a specific context: they contain a definition of the entities related to that context, the possible attack patterns over those entities, and the standard mitigations which can be applied. Knowledge bases enable the organization to get better and more consistent results because they represent reference material that guides the threat modelers in a prescriptive way. Knowledge bases should have rules that allow us to apply threats and mitigations to a system automatically. This automation would allow us to overcome the fact that some threat modelers may not have the experience required to determine if a threat should be applied or if some mitigation is effective.
Knowledge bases are not a new idea: many current threat modeling tools already support them in some form. But many current implementations have significant downsides. For example, you should be able to maintain knowledge bases easily. Their maintainability is a problem that is still unsolved. For instance, it's not easy to identify the best sources of information to use for building them. Moreover, maintenance is typically manual. The creation and maintenance of the knowledge bases should be the organization's internal Security team's responsibility. We hope that companies will start providing knowledge bases for the most common threat modeling tools to lift some of the burdens from their customers in the future. Those knowledge bases should be flexible to support and facilitate their adoption even by the most mature organizations, which need to adapt the said knowledge bases to their practices, policies, and regulations.
> **What can you do today?**
>
> Consider the possibility to devote part of the effort of the centralized Security Team for developing knowledge bases that can be used by the various development teams to accelerate threat modeling.
### Consuming knowledge bases
Another problem with knowledge bases is that sometimes they are too complex to consume. Many of them try to be comprehensive by including essential and less critical issues. Unfortunately, not all of them are required by all systems. You would want to adopt a simpler approach when the system you are analyzing is small and does not handle sensitive data. On the contrary, you would want to go more in-depth if the system is complex and processes PII and high-Business value data. Therefore, it should be possible to apply different versions of the knowledge depending on the context or mark some attack patterns and associated mitigations as "TOP". As a result, the threat modelers would be able to decide if they want a comprehensive experience or to go easy and minimize the work required.
Speaking of efficiency, it is imperative to ensure that the activities are streamlined and automated as much as possible to reduce the amount of work required. We do think that a sweet spot to perform a Threat Model of an average-sized solution should be 1 day of work for the threat modeler. Such results are possible only if the tool of choice provides accelerators to allow cutting the time required. For example, if the tool applies 20 different types of mitigations in 100 different places, and you are requested to specify for each one of them their status, you would be 5 times more efficient by focusing on the first instead of the latter. The tool of choice should provide this capability while still granting the possibility to do a more thorough job when required.
> **What can you do today?**
>
> If the knowledge bases you use today do not support the concept of “TOP” threats and mitigations, consider the possibility to remove what is rarely necessary or useful, to allow focusing only on what really matters.
>
> Sometimes the problem is that the adopted knowledge bases try to be generic and cover multiple scenarios. You may improve the situation by specializing them.
### Asking the right questions
During our analysis, we have considered the possibility of using a tool to support a Questions framework to drive the first phases of the analysis. We have noticed that most inexperienced threat modelers cannot ask the right questions to get the information required for their analysis. Some of our Experts have demonstrated that it is possible to determine some crucial questions based on a system diagram in scope. Those questions can even be applied automatically, with some generation rules. The problem is that this approach may not provide the value it seems to promise. That would be because you need to understand the rationale behind each question. Otherwise, you would not be able to evaluate the answer and determine if it is satisfactory. Still, automated questions generation may provide significant value to the less expert threat modelers, improving their understanding of the systems in scope.
> **What can you do today?**
>
> Adopt a structured approach to asking questions. For example, our team has had good results by adopting Microsoft STRIDE as a reference. You can do that by asking for each component of the solution questions like:
>
> - **Spoofing**: how does the component authenticates towards the services and resources it uses?
>
> - **Tampering**: does the component validate the messages it receives? Is the validation loose or strict?
>
> - **Repudiation**: is the component logging the interactions in an audit log?
>
> - **Information Disclosure**: is the traffic incoming and outgoing the component encrypted? What protocols and algorithms are allowed?
>
> - **Denial of Service**: is the component configured in high availability? Is it protected against DDoS attacks?
>
> - **Elevation of Privilege**: are users assigned the least privileges required? Does the solution mix code targeted to normal users with that for high privileged users?
>
> Techniques like this one can be taught and can be improved with experience. Therefore, it’s important to implement a Continuous Learning approach designed to collect learnings and spread them within the organization.
### The impact on the ROI
Bottom line, it is possible to identify many ideas to improve the efficiency of the threat modeling experience, its quality, and ultimately increase the ROI. This effort should be considered an ongoing process, though, which should be directed to the continuous improvement of the practice.
## Conclusions
Threat modeling is an excellent methodology for improving your organization's security. If done correctly, it can provide value for a very reasonable cost. We have already identified various techniques that may prove essential for improving the value of threat modeling for securing modern solutions, including:
- Align the threat model with your DevOps practice by
  - Focusing on the mitigations
  - Link mitigations with user stories
  - Highlight discrepancies between the threat model and the backlog
  - Use the threat Model to drive a more comprehensive Monitoring and auditing for security
- Simplify the creation of threat models and increase the consistency of the results
  - Rely on Security Champions
  - Adopt knowledge bases to automate the identification of threats and mitigations
  - Creating better knowledge bases
  - Provide a question framework supported by automation
Hopefully, some of them can already be found in your threat modeling tool of choice. Others will be included in the future. We know that maximizing the ROI for threat modeling is a long-term effort that requires answers we do not have yet. We also know that some questions are still unknown. This paper should provide some food for thought and hopefully may assist you in improving how you do threat modeling. We hope it can be a lighthouse for you and us, and that it will be useful to direct our efforts for the years to come.