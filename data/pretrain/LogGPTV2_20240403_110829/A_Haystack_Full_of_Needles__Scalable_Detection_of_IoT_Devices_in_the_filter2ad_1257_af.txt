end-user manual upgrades, e.g., to mitigate threats. Such signatures
may also be used to move from DDoS a(cid:138)acks towards identifying
culprits. Our approach is potentially scalable further using MUD
pro(cid:128)les [37], where devices will signal to the network what sort of
domains, access and network functionality they require to properly
function. It is also possible to extend the list of signatures of IoT
devices using crowdsourcing [38].
8 RELATED WORK
(cid:140)ere have been some recent papers in understanding home IoT
tra(cid:129)c pa(cid:138)erns and identifying devices based on their signatures,
trackers, and network tra(cid:129)c [39]. (cid:140)ese approaches o(cid:137)en rely on
testbed data [4, 40], or tools for the active discovery of the household
devices and their network tra(cid:129)c [41]. (cid:140)e authors in [40] use a
broad range of network features from packet captures, including
domain names to train a machine learning model and detect IoT
devices in a lab environment. However, they do not further study
the backend infrastructure supporting IoT devices. (cid:140)ere have
also been a few early a(cid:138)empts at mitigating against these device
discoveries using tra(cid:129)c padding [42] or blocking techniques [33].
A number of recent e(cid:130)orts focused on inferring IoT device types
from network tra(cid:129)c [6, 43]. In [15] the authors used instrumented
home gateways to look at IoT traces from over 200 households
in a US city. (cid:140)eir analysis revealed that while the IoT space is
fragmented, few popular cloud and DNS services act as a central
hub for the majority of the devices and their data.
Generally, many IoT devices periodically connect to speci(cid:128)c
servers on the Internet. Authors in [26] and [34] proposed a method
to identify IoT devices by observing passive DNS tra(cid:129)c and unique
IP addresses that the device connects to. Unfortunately, many
IoT devices rely on shared infrastructures and o(cid:137)en di(cid:130)erent IoT
devices from the same vendor connect to the same servers, therefore
detection at the scale of ISP/IXP, based on the IP addresses and
port numbers without considering the important role of shared
infrastructures, cannot be very reliable.
Complementing the approaches based on testbeds and home
gateways, there have been e(cid:130)orts in understanding IoT tra(cid:129)c pat-
terns using data from transit networks [44], though it has been
challenging to successfully validate the derived signatures. Similar
13
works relied on speci(cid:128)c port numbers [45] that may also be used
for specialized industrial IoT systems [46], though the approach
used cannot be easily extended to general-purpose IoT devices and
smart home systems that utilize popular ports, e.g., 443, 80.
(cid:140)ese related works indicate that o(cid:137)en, neither data from core
networks subject to sampling and middleboxes, nor data from few
devices using home gateways or testbeds are enough for rapidly and
accurately detecting IoT devices, and understanding their anomalies
and miscon(cid:128)gurations [10].
In this paper, for the (cid:128)rst time we have complemented detailed
ground truth data from testbeds and a particular subscriber, with
large-scale data from an ISP and an IXP, to reveal the aggregate be-
havior of these devices, alongside the ability to isolate and identify
speci(cid:128)c subscriber devices using sampled data at an ISP.
9 CONCLUSION
Home IoT devices are already popular, and their usage is expected
to grow further. (cid:140)us, we need to track their deployment without
deep packet inspection or active measurements, both intrusive and
unscalable methods for large deployments. Our insight is that
many IoT devices contact a small number of domains, and, thus, it
is possible to detect such devices at scale from sampled network
(cid:131)ow measurements in very large networks, even when they are in
idle mode. We show that our method is able to detect millions of
such devices in a large ISP and in an IXP that connects hundreds of
networks.
Our technique is able to detect 4 IoT platforms, 20 manufacturers
and 11 products–both popular and less popular ones–at vendor level
and in many cases even at product granularity. While this detection
may be useful to understand the penetration of IoT devices at home,
it raises concerns about the general detectability of such devices
and the corresponding human activity.
In light of our alarming observations, as part of our future work,
we would like to investigate how to minimize the harm of potential
a(cid:138)acks and surveillance using IoT devices. We also want to use our
insights to help ISPs to tackle security and performance problems
caused by IoT devices, e.g., by detecting them, redirecting their
tra(cid:129)c, or blocking their tra(cid:129)c.
ACKNOWLEDGEMENTS
We thank the anonymous reviewers and our shepherd Kensuke
Fukuda for their constructive feedback. (cid:140)is work was supported
in part by the European Research Council (ERC) Starting Grant
ResolutioNet (ERC-StG-679158), the EPSRC Defence Against Dark
Artefacts (EP/R03351X/1), the EPSRC Databox (EP/N028260/1), and
the NSF (CNS-1909020).
REFERENCES
[1]
[4]
IoT Analytics. IoT 2019 in Review: (cid:140)e 10 Most Relevant IoT Developments of
the Year. h(cid:138)ps://iot-analytics.com/iot-2019-in-review/, 2020.
[2] S. Greengard. Deep Insecurities: (cid:140)e Internet of (cid:140)ings Shi(cid:137)s Technology Risk.
Comm. of the ACM, 62(5), 2019.
[3] D. J. Dubois, R. Kolcun, A. M. Mandalari, M. T. Paracha, D. Cho(cid:130)nes, and H. Had-
dadi. When Speakers Are All Ears: Characterizing Misactivations of IoT Smart
Speakers. In Privacy Enhancing Technologies Symposium (PETS), 2020.
J. Ren, D. J. Dubois, D. Cho(cid:130)nes, A. M. Mandalari, R. Kolcun, and H. Had-
dadi. Information Exposure From Consumer IoT Devices: A Multidimensional,
Network-Informed Measurement Approach. In ACM IMC, 2019.
[5] L. F. DeKoven, A. Randall, A. Mirian, G. Akiwate, A. Blume, L.K. Saul, A. Schul-
man, G.M. Voelker, and S. Savage. Measuring Security Practices and How (cid:140)ey
Impact Security. In ACM IMC, 2019.
[6] S. Marchal, M. Mie(cid:138)inen, T. D. Nguyen, A.-R. Sadeghi, and N. Asokan. AUDI:
Towards Autonomous IoT Device-Type Identi(cid:128)cation using Periodic Communi-
cation. IEEE Journal on Sel. Areas in Comm., 37(6), 2019.
[7] D. Kumar and K. Shen and B. Case and D. Garg and G. Alperovich and
D. Kuznetsov and R. Gupta and Z. Durumeric. All (cid:140)ings Considered: An
Analysis of IoT Devices on Home Networks. In USENIX Security Symposium,
2019.
[8] Z. Durumeric, E. Wustrow, and J. A. Halderman. ZMap: Fast Internet-Wide
Scanning and its Security Applications. In USENIX Security Symposium, 2013.
[9] Z. Durumeric, D. Adrian, A. Mirian, M. Bailey, and J. A. Halderman. A Search
Engine Backed by Internet-Wide Scanning. In ACM CCS, 2015.
[10] H. Haddadi, V. Christophides, R. Teixeira, K. Cho, S. Suzuki, and A. Perrig.
Siotome: An edge-isp collaborative architecture for iot security. In 1st Inter-
national Workshop on Security and Privacy for the Internet-of-(cid:138)ings (IoTSec),
2018.
[11] B. Claise. RFC 3954: Cisco Systems NetFlow Services Export Version 9, 2004.
[12] B. Claise, B. Trammell, and P. Aitken. RFC 7011: Speci(cid:128)cation of the IPFIX
Protocol for the Exchange of Flow Information, 2013.
[13] Amazon.
Alexa Voice Service Endpoints (accessed 2019-11).
h(cid:138)ps:
//developer.amazon.com/en-US/docs/alexa/alexa-voice-service/api-overview.
html#endpoints.
[14] P. Patel, G. Srinivasan, S. Rahaman, and I. Neamtiu. On the E(cid:130)ectiveness of
Random Testing for Android: Or How I Learned to Stop Worrying and Love
the Monkey. In Proceedings of the 13th International Workshop on Automation of
So(cid:135)ware Test, 2018.
[15] M. Hammad Mazhar and Z. Sha(cid:128)q. Characterizing Smart Home IoT Tra(cid:129)c in the
Wild. In ACM/IEEE Conference on Internet of (cid:138)ings Design and Implementation,
2020.
[16] Farsight Security. DNSDB. h(cid:138)ps://www.dnsdb.info/, 2017.
[17] C. Iordanou, G. Smaragdakis, I. Poese, and N. Laoutaris. Tracing cross border
web tracking. In ACM IMC, 2018.
[18] F. Weimer. Passive DNS Replication. In 17th Annual FIRST Conference, 2005.
[19] Amazon AWS. What is Amazon VPC? (accessed 2019-11). h(cid:138)ps://docs.aws.
amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html.
[20] Amazon AWS.
cessed 2019-11).
using-instance-addressing.html#concepts-public-addresses.
Public IPv4 addresses and external DNS hostnames (ac-
h(cid:138)ps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/
[21] Microso(cid:137). Public IP addresses (accessed 2019-11). h(cid:138)ps://docs.microso(cid:137).com/
en-us/azure/virtual-network/virtual-network-ip-addresses-overview-arm#
public-ip-addresses.
[22] Tuya Inc. Tuya Platform and Services (accessed 2019-12). h(cid:138)ps://www.tuya.
com/platform.
com/platform/how-it-works/.
[23] Electric Imp. Electric imp Platform (accessed 2019-12). h(cid:138)ps://www.electricimp.
[24] Amazon. AWS IoT Platform (accessed 2019-12). h(cid:138)ps://aws.amazon.com/iot/.
[25] AuraK, Samsung Community Moderator. Backgroundverbindungen (auch
Standby), Datenschutz - in German(accessed 2019-11). h(cid:138)ps://eu.community.
samsung.com/t5/TV/Backgroundverbindungen-auch-Standby-Datenschutz/
m-p/625473/highlight/true\#M24445, July 2018.
[26] R. Perdisci, T. Papastergiou, O. Alrawi, and M. Antonakakis. IoTFinder: E(cid:129)cient
Large-Scale Identi(cid:128)cation of IoT Devices via Passive DNS Tra(cid:129)c Analysis. In
IEEE European Symposium of Security and Privacy, 2020.
[27] Bitkom e.V. Zukun(cid:137) der Consumer Technology (cid:128)(cid:147) 2019 - in German (accessed
2019-11). h(cid:138)ps://www.bitkom.org/sites/default/(cid:128)les/2019-09/190903 ct studie
2019 online.pdf, 2019.
IDC. Google Overtakes Amazon to Lead the European Smart Home Market in
1Q19, says IDC (accessed 2019-11). h(cid:138)ps://www.idc.com/getdoc.jsp?containerId=
prEUR145337319, 2019.
[28]
[29] Deutsche Welle. Voice Assistants on the rise in Germany (accessed 2019-11).
h(cid:138)ps://www.dw.com/en/voice-assistants-on-the-rise-in-germany/a-45269599.
[30] Amir H Rasti, Nazanin Magharei, Reza Rejaie, and Walter Willinger. Eyeball
ASes: from Geography to Connectivity. In ACM IMC, 2010.
[31] M. Antonakakis, T. April, M. Bailey, M. Bernhard, E. Bursztein, J. Cochran,
Z. Durumeric, J. A. Halderman, L. Invernizzi, M. Kallitsis, D. Kumar, C. Lever,
Z. Ma, J. Mason, D. Menscher, C. Seaman, N. Sullivan, K. (cid:140)omas, and Y. Zhou.
Understanding the Mirai Botnet. In USENIX Security Symposium, 2017.
[32] O. C¸etin, C. Ga˜n´an, L. Altena, T. Kasama, D. Inoue, K. Tamiya, Y. Tie, K. Yoshioka,
and M. van Eeten. Cleaning Up the Internet of Evil (cid:140)ings: Real-World Evidence
on ISP and Consumer E(cid:130)orts to Remove Mirai. In NDSS, 2019.
[33] A. M. Mandalari, R. Kolcun, H. Haddadi, D. J. Dubois, and D. Cho(cid:130)nes. Towards
Automatic Identi(cid:128)cation and Blocking of Non-Critical IoT Tra(cid:129)c Destinations.
In IEEE S & P Workshop on Technology and Consumer Protection, 2020.
Transactions on Networking, 2020. [to appear].
dns-over-tls, 2020.
[34] H. Guo and J. Heidemann. Detecting IoT Devices in the Internet. IEEE/ACM
[35] Google. DNS-over-TLS. h(cid:138)ps://developers.google.com/speed/public-dns/docs/
[36] F. Chen, R. K. Sitaraman, and M. Torres. End-User Mapping: Next Generation
[37] E. Lear, R. Droms, and D. Romascanu. RFC 8520: Manufacturer Usage Description
Request Routing for Content Delivery. In ACM SIGCOMM, 2015.
Speci(cid:128)cation, 2019.
[38] D. A. Popescu, V. Safronov, P. Yadav, R. Kolcun, A. M. Mandalari, H. Haddadi,
D. McAuley, and R. Mortier. Sensing the IoT network: Ethical capture of domestic
IoT network tra(cid:129)c: poster abstract. In ACM SenSys posters, 2019.
[39] N. Apthorpe, D. Reisman, and N. Feamster. A Smart Home is No Castle: Privacy
Vulnerabilities of Encrypted IoT Tra(cid:129)c. Data and Algorithmic Transparency
Workshop, 2016.
[40] A. Sivanathan, H. H. Gharakheili, F. Loi, A. Radford, C. Wijenayake, A. Vish-
wanath, and V. Sivaraman. Classifying IoT Devices in Smart Environments Using
Network Tra(cid:129)c Characteristics. IEEE Transactions on Mobile Computing, 18(8),
2019.
[41] D. Y. Huang, N. Apthorpe, G. Acar, F. Li, and N. Feamster. IoTInspector: Crowd-
sourcing Labeled Network Tra(cid:129)c from Smart Home Devices at Scale. In ACM
IMWUT / Ubicomp, 2020.
[42] N. Apthorpe, D. Y. Huang, D. Reisman, A. Narayanan, and N. Feamster. Keeping
the Smart Home Private with Smart(er) IoT Tra(cid:129)c Shaping. Proceedings on
Privacy Enhancing Technologies, 2019.
[43] A. Sivanathan, H. H. Gharakheili, and V. Sivaraman. Inferring IoT Device Types
from Network Behavior Using Unsupervised Clustering. In IEEE Conference on
Local Computer Networks (LCN), 2019.
[44] G. Hu and K. Fukuda. Toward Detecting IoT Device Tra(cid:129)c in Transit Net-
works. In International Conference on Arti(cid:128)cial Intelligence in Information and
Communication (ICAIIC), 2020.
[45] A. Sivanathan, H. H. Gharakheili, and V. Sivaraman. Can We Classify an IoT
Device using TCP Port Scan? In 2018 IEEE International Conference on Information
and Automation for Sustainability (ICIAfS), pages 1–4, 2018.
[46] M. Nawrocki, T. C. Schmidt, and M W¨ahlisch. Uncovering Vulnerable Industrial
Control Systems from the Internet Core. In IEEE/IFIP Network Operations and
Management Symposium (NOMS), 2020.
14