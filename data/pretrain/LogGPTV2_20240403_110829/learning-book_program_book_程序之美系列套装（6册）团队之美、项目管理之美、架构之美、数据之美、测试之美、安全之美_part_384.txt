1.2.4正确理解功能
随着LOpht对安全的成功破坏以及像LOphtCrack这样的工具变得广为
人知，政府不得不对我们的队伍勉强产生了一点兴趣，希望理解我
们能够做些什么。我勉强答应邀请白营的一群人参观我们的工作，
并向他们简单介绍了我们的情况。不得不说，LOph成员们对于一大
群政府代表的来访感到不安，但最终我和其他成员成功说服了每个
人，允许这些“政府人员"来到我们的“秘密”地点。
当晚，在会议结束并共进晚餐之后，我陪同政府代表们走到停车场
并向他们道别，然后看着他们走向自已的汽车，以确保他们全都离
开。当我看到他们停下来悄悄谈话时，心里就疑神疑鬼的。
我快步走到人群中，冲着他们哦道：“你们不能这样！回到办公室以
后，你们想说什么秘密都可以。我们之所以让你们参观，是因为对
2215
---
## Page 2217
你们抱有极大的信任。因此，我想知道你们刚才在讨论什么！”这打
断了他们的谈话。也许是酒精的作用，使我有勇气对这群颇有身份
的人们说出这番话。也许，当时我不知道更好的做法是什么。
我想这番话让他们呆住了。这五个人都是政府高级职员，每个人都
把目光投向其中一个人，这个人看上去像是其中地位最高的。他回
过头直接注视着我，并解释道：“我们只是在讨论你们是怎么做出这
些东西的..
“您的意思是？”我继续追问。
他回答道：“我们收到的所有报告都表示，你们在这里所完成的功
能，如果没有国家的财政支持，是不可能成功的。"我的答复是我们
已经向他们证明，我们在没有得到任何资助的情况下已经完成了这
些工作（应当注意，低估那些失去面子的好奇的人们的能量是极大
的疏忽）。“我们进一步怀疑，”他说道：“有没有任何政府已经采纳
道：“没有。至少我还没有注意到。但是您如果愿意，可以成为第一
个，我们愿意接受邀请.....
即使我试图摆出幽默的架势，但我们还是不欢而散。
尽管双方都心怀疑虑，并且双方由于立场差异巨大而导致沟通困
滩，但政府还是明百了我们的成果确实是一些业余发烧发在儿乎没
有得到任何资助的情况下在业余时间完成的。
这些访问者就是从各个三字母机构接受报告的人。他们意识到这些
机构的职业阶梯很容易导致确认偏见。他们被这些机构的官员所说
服，以为我们的成果需要大量的资助，只有特定类型的对手才可能
实现。因此，他们采取了大胆的步骤，对我们进行了登门拜访，这
样他们可能会抵制向他们所灌输的一些基本信仰。他们的步子迈得
真是够大的，竞然造访我们隐秘的L0ph基地。但是，他们最终修正
了对手发动恐怖的网络攻击真正所需要的条件的假设。
遗憾的是，很多人并不是像他们一样能够或愿意寻找令自己不安的
证据来否定自己的假设。在测试软件和系统时，考虑工程师、开发
人员和测试人员可能工作的环境以及他们可能具有的先入为主的想
法是非常重要的。当涉及应用程序要求做什么以及什么样的输入可
能会有意或出乎意料地对它们造成威胁时，这方面的考虑就显得格
外重要。
2216
---
## Page 2218
1.3功能锁定
功能锁定表示无法看到超出某些东西的常见用法范围的其他用法。
这与第一印象的概念有点相似，即第一次接触到信息时（例如一篇
新闻报告的偏向性标题或起诉方对案件的陈述）所留下的印象，常
常会永远地影响听众对这种信息接下来的感知。
当有人提到“锤子"时，一般人首先想到的是一种用于造房子的实用
工具。很少有人在听到锤子时立即把它与一种攻击性武器联系在一
起。类似，人们在听到“火焰喷射器"这个词时脑海里立即会浮现一
幅军事武器的图像，很晚（即使有的话）才有可能想到它是一种通
过先发制人的燃烧策略防止火势蔓延的消防工具。
功能锁定就是指不能理解一种工具的最常见用法或“默认"用法之外
的其他用法。如果一个人认为一种工具只有一种可能的用法时，我
们就把它称为“锁定”。
考虑口袋里的一把零钱中的一枚二角五分硬币。如果有人问你打算
怎么使用这枚硬币，你首先的想法很可能是用它来买东西。但是，
人们当然也可以把它派到其他用场：
用来抛硬币，以决定应该怎么做某样事情。
把它当做起子，例如撬开蛤。
投掷物，用来击中别人。
防止门关闭的垫片。
作为具有美学价值和历史价值的收藏品。
如果忽略这些其他功能，很可能会通过想不到的方式让你感到吃
惊，例如有人可能会提出购买你的旧硬币，或者当你把一个硬币送
给你家的小孩之后，他却用力把它砸在你的后脑上。
1.3.1安全位置的潜在风险
既然对功能锁定已经有了一个基本的理解，现在读者可能会疑惑它
是如何与计算机和网络产生关联的。
2217
---
## Page 2219
许多人把诸如漏洞扫描器和反病毒软件这样的安全产品看成是能够
增加系统或组织安全性的工具。但是，如果这只是你的唯一观点，
就有可能遇到功能锁定问题。这类技术的每一个都可能非常复杂，
由数千行代码组成。在一个环境中引进它们同时也引进了很大的出
现新的漏洞和攻击表面的可能性。
以早年的漏洞扫描器为例，我在自己所在公司的内部网络上设置了
一些特殊的系统。这些系统是恶意服务器，目的是攻击当前大多数
漏洞攻击在几年后的恶意软件感染中将会非常频繁地出现。例如，
ISS扫描器将连接到一个远程系统上的指名服务（fingerservice），
以收集远程系统信息。但是，这个扫描软件在它的其中一个安全测
试中出现了一个典型问题：这个程序没有检查返回信息的长度，而
是盲目地把它复制到一个固定长度的缓冲区。这就在程序堆栈上产
生了一种很普通的缓冲区溢出。知道了这个扫描器的这个弱点，并
且知道了这个扫描器所运行的系统架构之后，我对恶意服务器进行
了设置，以攻击这个漏洞。当我所在的公司将要接受年度审核时，
作为审核者的评估工作的一部分，将从审核者所带入并连接到公司
内部网络的笔记本电脑上运行网络漏洞扫描。当这个扫描器最终遇
到我的其中一个恶意服务器时，扫描系统本身由于扫描软件的这个
漏洞而遭到攻击。
这常常导致很幽默的场景，它为公司的领导层提供了一些借口回应
审核人员。由于被攻击的审核系统通常要对多个客户进行审核，因
此我们可以用这个审核系统所暴露的其他公司的审核信息来忽悠他
们。公司的领导层可以理直气壮地声称，在我们的内部系统中所找
到的漏洞（隐藏在防火墙和其他防御技术的后面）相比审核人员向
竞争对手泄露敏感信息而言实在算不上什么风险，而且它本身很司
能是审核人员所使用的“安全软件"所造成的。功能锁定可能导致人
们忘了安全检查软件本身的安全。
遗憾的是，现代的反病毒软件已经被发现包含了各种类型的常见编
程漏洞，例如局部缓冲区溢出、未检查的执行功能以及在自动更新
活动中缺乏认证等。因此，安全软件也可能为攻击者并启大门，而
不是起到防御作用。
前面的例子是功能锁定的简单例子，可以归结于我在习得性无助这
一节中所讨论的无从选择。但是，还存在更为微妙的例子。
2218
---
## Page 2220
1.3.2降低成本与未来收益：ISP实例
安全的最大阻碍来自公司高层对安全需求的负面认识。其中有些认
识代表了功能锁定。几个月前，在著名的分布式拒绝服务攻击
Internet上主要服务供应商和商业实体（包括eBay、CNN、
Yahoo！），并导致它们临时关闭前，山我曾有机会为一家一级ISP
分析骨干路由器配置。经过这些核心路由器的IP流量的主体是TCP流
量，特别是HTTP通信。UDP所占据的比例要少得多，至于ICMP则少
得可伶。我很惊奇地发现，这些路由器对流量缺乏任何控制，只是
采用了一些最低限度的过滤器，以防止某些形式的对这些路由器本
身的未授权访问。但是，当我建议对核心路由器的配置进行更改，
侧重于保护这家ISP的顾客时，这下轮到公司的领导感到惊奇了，他
们立即告诉我此事绝不可行。
两种思维在这里发生了冲突。ISP并不想冒着减少它们的核心路由器
吞吐量的风险，如果它们使用了任何类型的具有实质意义的包过滤
器，就会发生这种情况。总之，ISP的业务是销售带宽，顾客把它看
成是吞吐量。当系统把数据包从A点移动到B点时，就不得不花费额
外的时间决定如何处理每个数据包，因此路由器的行为和最终的吞
吐量会受到负面影响。
而且，此时不论是ISP还是它的顾客都无法忍受任何负面效果。管理
层可以理解可能会发生针对它们的路由器的攻击，但他们愿意等
待，在发生这种情况时再对它进行处理。他们觉得在没有出现问题
的时候花钱是件浪费的事情，虽然未来出现问题时所需要的花费可
能大于现在积极预防问题发生所需要的开销。此外，对顾客的攻击
则不在他们的考虑范围。
相反，站在我的角度，尽管当时还没有发生广泛的DDoS攻击事件
（事实上，当时还不存在DDoS这个词），但我还是意识到了不仅针
对ISP的服务器而且针对背后的顾客的网络资源饿死型攻击的可能
性。我知道对顾客的攻击将很难被诊断，并且难以快速作出反应，
但是我完全无法说服ISP。事实上，我不得不从商业的角度理解他们
的想法。他们对自己的系统不需要进一步采取安全措施的理由多少
是符合逻辑的。
（RandyVSabett所编写的第12章也讨论了安全是成本而不是收益的
问题。）
2219
---
## Page 2221
在大规模的DDoS攻击之后的某个时刻，我有幸被邀请参加在白宫的
椭圆办公室所举行的圆桌会议，所坐的位置距离克林顿总统只有几
个座位之遥。这个会议的目的是讨论政府和行业如何应对最近的
DDoS攻击以及接下来应该做些什么？
在会议上，我再次感到吃惊。商业部门的领导层所表达的主要担心
是这些攻击可能会导致政府介入，并对它们的行业进行调控。看上
去，他们实际上对于理解或处理当前的技术问题并没有什么兴趣。
我开始渐渐明白，ISP固守一种概念，他们觉得政府在这些事物上的
十预很可能会对他们的收益产生负面影响。他们与我在前儿个月所
遇到的那家拒绝在它们的核心路由器上采用包过滤器的大型ISP具有
相同的概念：安全需要花钱，并且只能预防未来潜在的损失。他们
从来没有从安全也可能制造收益这个角度去思考问题。
在会议之后，我重新约见了几个月前打过交道的那家大型ISP的执行
官。我告诉他，我理解他为什么做出这样的安全决策，并要求他真
心回答后来在我脑海里索绕的一个问题。我要求他假设我并不是站
在安全的角度问这个问题的。反之，假设我已经指出ISP可以协商承
诺访问速率（CommitedAccessRate），根据这些新的确定性更好地
规划利用率，并最终使每台关键服务器服务更多的顾客。而且，他
们可以使用这个方案为他们所销售的新类型的服务提供不同的记账
和报告功能。过滤和测量可以防止用户不合理地占用带宽，但任何
客户端所发现有用的网路被封锁或变慢是可以通过不同服务水平来
满意解决的。但是，作为回报，这种过滤可以极大地降低外部恶意
因素对带宽的不正当占用。我的问题是一—这会不会是一个更好的
方法？
他的回答是一声响亮的“是”，因为这家公司把这个方法看成是一个
机会，认识到它可能带来的更多收益，而不仅仅是把它看成是与安
全姿态相关联的日常开支。
我从这个事情中认识到，我（包括安全领域的绝大多数实干家）受
到“安全只是它自己的事情，它并没有被看成是一个不同目标的副产
品”这个功能锁定的困扰。正如经常被事实所证明的那样，构建高效
和具有良好定义的需求也可以增强安全。
[1]"Clinton fights hackers,with a hacker,"CNN,February 15,
m/2000/TECH/computing/02/15/hacker.security/).
2220
---