│ xxx  │ xxx   |   xxx  │ 2502班  │ 浙江省萧山中学     │  925.5 │        6 │ … │  132.0 │   94.5 │  100.0 │   94.0 │   85.5 │   88.5 │   86.0 │  
│ xxx  │ xxx   |   xxx  │ 1班     │ 桐庐中学           │  923.0 │        7 │ … │  124.0 │   99.0 │   93.0 │   93.0 │   89.0 │   92.0 │   76.0 │  
│ xxx  │ xxx   |   xxx  │ 5班     │ 杭州市余杭高级中学 │ 922.25 │        8 │ … │  138.0 │   97.5 │   97.0 │   97.5 │  83.75 │   87.5 │   79.0 │  
│ xxx  │ xxx   |   xxx  │ 12班    │ 杭州市余杭高级中学 │ 922.25 │        8 │ … │  140.5 │   80.0 │   91.0 │   92.0 │  90.75 │   87.0 │   88.0 │  
│ xxx  │ xxx   |   xxx  │ 2505班  │ 浙江省萧山中学     │ 922.25 │        8 │ … │  130.0 │   98.0 │   98.5 │   96.5 │  85.75 │   90.5 │   87.0 │  
├─────────┴──────────┴────────────┴─────────┴────────────────────┴────────┴──────────┴───┴────────┴────────┴────────┴────────┴────────┴────────┴────────┤  
│ 10 rows                                                                                                                         20 columns (14 shown) │  
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  
```  
2、下面是一些分析过程  
我们的情况是高一大多数的时间放在主科和理科, 考试前补一补文科. 虽然投入时间偏理, 文理和总成绩排名几乎差不多.    
```  
select * from (  
  select   
    row_number() over (order by coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("政治",0)+coalesce("历史",0)+coalesce("地理",0) desc nulls last) as wen_rn,   
    row_number() over (order by coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("物理",0)+coalesce("化学",0)+coalesce("生物",0) desc nulls last) as li_rn,   
    "总分排名",   
    coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("政治",0)+coalesce("历史",0)+coalesce("地理",0) as wen,  
    coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("物理",0)+coalesce("化学",0)+coalesce("生物",0) as li,  
    COLUMNS(* EXCLUDE ("总分排名", "准考证号", "自定义考号")) from st_read('/Users/digoal/Downloads/总分.xlsx', layer='Sheet1')   
) t  
where "姓名"='xxx';  
┌────────┬───────┬──────────┬────────┬────────┬─────────┬─────────┬──────────────────────┬───┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐  
│ wen_rn │ li_rn │ 总分排名 │  wen   │   li   │  姓名   │  班级   │         学校         │ … │  英语  │  物理  │  化学  │  生物  │  政治  │  历史  │  地理  │  
│ int64  │ int64 │  int32   │ double │ double │ varchar │ varchar │       varchar        │   │ double │ double │ double │ double │ double │ double │ double │  
├────────┼───────┼──────────┼────────┼────────┼─────────┼─────────┼──────────────────────┼───┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤  
│   1948 │  1917 │     1700 │  537.0 │  565.0 │ xxx  │ 14班       │ 杭州市余杭中学       │ … │  105.5 │   81.0 │   87.0 │   78.0 │   78.5 │   63.5 │   76.0 │  
```  
3、按纯文和纯理的选课, 得到纯文纯理的排名如下:   
```  
select * from (  
  select   
    row_number() over (order by coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("政治",0)+coalesce("历史",0)+coalesce("地理",0) desc nulls last) as wen_rn,   
    row_number() over (order by coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("物理",0)+coalesce("化学",0)+coalesce("生物",0) desc nulls last) as li_rn,   
    "总分排名",   
    coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("政治",0)+coalesce("历史",0)+coalesce("地理",0) as wen,  
    coalesce("语文",0)+coalesce("数学",0)+coalesce("英语",0)+coalesce("物理",0)+coalesce("化学",0)+coalesce("生物",0) as li,  
    COLUMNS(* EXCLUDE ("总分排名", "准考证号", "自定义考号")) from st_read('/Users/digoal/Downloads/总分.xlsx', layer='Sheet1')   
) t  
where "学校"='杭州市余杭中学' order by "总分排名" limit 20;   
┌────────┬───────┬──────────┬────────┬────────┬──────────┬─────────┬────────────────┬───┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐  
│ wen_rn │ li_rn │ 总分排名 │  wen   │   li   │   姓名   │  班级   │      学校      │ … │  英语  │  物理  │  化学  │  生物  │  政治  │  历史  │  地理  │  
│ int64  │ int64 │  int32   │ double │ double │ varchar  │ varchar │    varchar     │   │ double │ double │ double │ double │ double │ double │ double │  
├────────┼───────┼──────────┼────────┼────────┼──────────┼─────────┼────────────────┼───┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤  
│    698 │   944 │      814 │  570.5 │  595.0 │          │ 13班    │ 杭州市余杭中学 │ … │  127.5 │   75.5 │   87.5 │   88.0 │   79.0 │   74.5 │   73.0 │  
│    966 │  1303 │      969 │  561.0 │  582.0 │          │ 14班    │ 杭州市余杭中学 │ … │  108.5 │   84.0 │   87.0 │   81.0 │   77.0 │   85.0 │   69.0 │  
│   1155 │  2755 │     1190 │  555.0 │  547.0 │          │ 11班    │ 杭州市余杭中学 │ … │  119.0 │   76.5 │   90.0 │   81.5 │   86.0 │   85.0 │   85.0 │  
│   1994 │  2050 │     1417 │  536.0 │  562.0 │          │ 11班    │ 杭州市余杭中学 │ … │   97.5 │   76.0 │   89.5 │   91.5 │   73.0 │   80.0 │   78.0 │  
│   1899 │  1339 │     1424 │  538.0 │  581.0 │          │ 11班    │ 杭州市余杭中学 │ … │  117.5 │   77.5 │   90.0 │   87.0 │   72.5 │   73.0 │   66.0 │  
│   1425 │  2625 │     1441 │  547.5 │  550.0 │          │ 10班    │ 杭州市余杭中学 │ … │  111.5 │   79.5 │   82.5 │   82.5 │   79.0 │   81.0 │   82.0 │  
│   2213 │  1716 │     1495 │  531.5 │  570.5 │          │ 10班    │ 杭州市余杭中学 │ … │  104.0 │   75.0 │   93.0 │   90.5 │   86.5 │   63.0 │   70.0 │  
│   2504 │  1936 │     1529 │  526.5 │  564.5 │          │ 11班    │ 杭州市余杭中学 │ … │   78.5 │   85.0 │   81.5 │   96.0 │   62.0 │   77.5 │   85.0 │  
│   2165 │  1111 │     1606 │  532.5 │  589.0 │          │ 14班    │ 杭州市余杭中学 │ … │  125.5 │   84.5 │   90.5 │   79.0 │   63.5 │   71.0 │   63.0 │  
│   1948 │  1917 │     1700 │  537.0 │  565.0 │   xxx    │ 14班    │ 杭州市余杭中学 │ … │  105.5 │   81.0 │   87.0 │   78.0 │   78.5 │   63.5 │   76.0 │  
│   1829 │  1763 │     1717 │ 539.25 │  569.0 │          │ 14班    │ 杭州市余杭中学 │ … │  123.0 │   68.0 │   90.0 │   85.5 │  81.25 │   73.5 │   59.0 │  
│   3293 │  1774 │     1731 │  514.5 │  569.0 │          │ 12班    │ 杭州市余杭中学 │ … │   95.0 │   78.5 │   97.0 │   92.0 │   66.5 │   72.5 │   74.0 │  
│   1689 │  2291 │     1785 │  542.0 │  556.5 │          │ 11班    │ 杭州市余杭中学 │ … │  106.5 │   72.5 │   89.0 │   76.5 │   75.0 │   81.5 │   67.0 │  
│   1221 │  3101 │     1802 │  553.5 │  540.5 │          │ 8班     │ 杭州市余杭中学 │ … │  118.0 │   61.0 │   87.0 │   78.0 │   83.0 │   85.0 │   71.0 │  
│   2249 │  2385 │     1868 │  531.0 │  554.5 │          │ 13班    │ 杭州市余杭中学 │ … │  126.0 │   76.5 │   83.0 │   87.0 │   79.5 │   72.5 │   71.0 │  
│   3360 │  2439 │     1953 │  513.5 │  553.5 │          │ 10班    │ 杭州市余杭中学 │ … │   87.5 │   88.5 │   94.0 │   79.0 │   73.0 │   77.5 │   71.0 │  
│   1396 │  2507 │     2016 │  548.5 │  552.0 │          │ 13班    │ 杭州市余杭中学 │ … │  128.0 │   67.5 │   84.0 │   73.5 │   81.5 │   67.0 │   73.0 │  
│   1691 │  2809 │     2044 │  542.0 │  546.0 │          │ 11班    │ 杭州市余杭中学 │ … │  116.5 │   62.5 │   85.5 │   82.5 │   79.0 │   68.5 │   79.0 │  
│   3112 │  2634 │     2056 │  517.0 │  550.0 │          │ 8班     │ 杭州市余杭中学 │ … │   94.0 │   75.0 │   97.5 │   82.5 │   63.0 │   85.0 │   74.0 │  
│   2481 │  2671 │     2074 │  527.0 │  549.0 │          │ 14班    │ 杭州市余杭中学 │ … │   88.0 │   85.5 │   86.0 │   73.0 │   76.0 │   75.5 │   71.0 │  
├────────┴───────┴──────────┴────────┴────────┴──────────┴─────────┴────────────────┴───┴────────┴────────┴────────┴────────┴────────┴────────┴────────┤  
│ 20 rows                                                                                                                        22 columns (15 shown) │  
└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘  
```  
4、和前面说的文理排名几乎一样.  结果未偏科,  平时投入时间偏理.  文科成绩有较大提升空间.    
选课后的排名预估逻辑:     
- 假设选理科, 由于平时已经花了更多时间在理科, 容易被那些平时没花多少时间在理科, 但是理科成绩依旧很不错(文科排名远前理科排名, 假设相差500名)的同学超越, 这类学生理科升500名. 同时再假设对于文理相差小与100名的同学, 具备理科在现有成绩上升300名的潜力.     
- 假设选文科, 由于平时已经花了更多时间在理科, 容易超越平时花了很多时间在文科, 并且理科成绩比较差的偏文科生(文科排名远前于理科排名, 假设相差500名), 这类学生文科降500名. 同时再假设对于文理相差小与100名的同学,  
具备文科在现有成绩上升300名的潜力.     
根据这两个逻辑, 看一下选什么比较靠谱.    
5、假设选理科:     
```  
select * from (  
  select row_number() over (order by case when li_rn - wen_rn >= 500 then li_rn-500 when abs(li_rn - wen_rn) <= 100 then li_rn-300 else li_rn end) as li_rn1 , * from (  