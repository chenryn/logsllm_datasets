(cid:14)(cid:14)(cid:14)(cid:14)
4
8
3
xx
xx
1
(cid:14)(cid:14)(cid:14)(cid:14)
16
5
3
12
xxx
x
(cid:14)(cid:14)x
20
117
x
(cid:14)(cid:14)(cid:14)(cid:14)
2
7
x
x
x
1
(cid:14)(cid:14)x
13
28
x
(cid:14)(cid:14)x
12
29
x
(cid:14)(cid:14)x
31
13
x
(cid:14)(cid:14)(cid:14)(cid:14)
22
2
x
x
x
1
32
x
- 
28 
150 
202 
368 
349 
359 
452 
747 
2,253 
3,362 
3,595 
3,683 
4,015 
3,996 
4,000 
4,133 
4,756 
AREAD
OVERHEA
D (%) 
0 
49 
59 
63 
78 
77
77 
83 
111 
FREQ.
(MHz)
19.67 
15.92 
15.41 
15.21 
14.91 
17.02 
16.13 
16.76 
15.72 
THROUG
SPEED
PROB. OF AN 
HPUT
(Mb/s)
228 
185 
179 
177 
173 
198 
187 
195 
182 
OVERHEA
UNDETECTABLE 
D (%) 
ERROR * 
- 
19 
21 
22 
24 
13
18 
14 
20 
162(cid:16)
322(cid:16)
402(cid:16)
482(cid:16)
562(cid:16)
582(cid:16)
622(cid:16)
642(cid:16)
* Estimated, based on Table 1.  Assumes all errors at the extended output are equiprobable. 
only  about  a  50%  hardware  overhead  in  a  FPGA 
implementation when compared to the unprotected design. 
case  provided 
compromise.  
the  best  area 
to  error  protection 
6. FPGA implementations 
5.2 
tools. 
design 
  The 
  We have implemented AES-128 (AES with 128-bit 
key)  on  a  Xilinx  XCV1000E  FPGA  using  Xilinx 
Foundation 
included 
encryption/decryption  capability  with  dynamic  key 
expansion  for  both  encryption  and  decryption.    A  simple 
control unit was implemented to control the whole circuit.   
That  design  was  then  protected  by  the  proposed  robust 
codes  with  different  lengths  of  cubic  signatures  r.  The 
required  overheads  are  summarized  in  Table  2.    Table  2 
represents the relative size and speed of the circuit in post 
synthesis estimations only (not after place and route).   
From the cube size column in Table 2 it is evident that 
the complexity of the network computing cubic signatures 
  growth  behavior  (even 
does  not  have  uniform 
( 2rO
)
though  the  sizes  are  presented  in  slices,  the  same 
characteristic would still be evident for the corresponding 
gate-counts).   In some instances it is absent such as in the 
cubes  where  r=24  and  r=28.    In  that  case,  the  larger  r
corresponds to a smaller complexity of the cubic network.  
This abnormality is a result of the selection of primitive 
polynomials of degree r defining GF(2r ) for each r.  The 
size  and  the  complexity  of  the  cubic  network  are  largely 
dependent  on 
the  primitive 
polynomial.    In  general,  less  terms  in  the  polynomial  are 
and smaller the degree of the non-leading term the better.  
These  polynomial  characteristics  also  explain  the  large 
cost  of  the  32-bit  cubic  network.    The  best  primitive 
polynomial for the 32-bit case is relatively bad since it has 
5 terms and it has a large order term ( 22x ).
the  characteristics  of 
Based  on  the  results  in  Table  II,  we  had  chosen 
an r=28 for out test FPGA design.  We felt that the r=28  
Table 3. Relative sizes of components for robust 
cubic architectures. 
AES
ENC/DEC
KEY
EXPANSIO
N CORE 
CONT
ROL
LINEAR
PREDIC
TOR
28 BIT 
CUBE
31 
2,201 
1,000 
349 
EDN
WITH 28 
BIT
CUBE
404 
0.7 % 
55.3 % 
25 % 
8.8 % 
10.2 % 
SIZE
(SLICES)
RELATI
VE SIZE 
%
Table 3 represents the relative size of each component 
in the design where r=28.
7. Simulation results 
The  error  coverage  of  the  robust  protection  scheme 
with r=28  was  simulated  and  compared  to  the  error 
coverage  of  the  corresponding  linear  protection  scheme 
with the same redundancy.  The 28-bit signature was then 
calculated  from  the  128-bit  random  input.    In  the  robust 
simulation 
to 
produce  the  156-bit  extended  output  of  the  device  (see 
Figure 4).    It was  in    the  extended 156-bit  output  that  an 
error was injected.  The same random inputs and the same 
error  patterns  were  injected  into  the  linear  and  robust 
cubic  architectures.    For  each  error  pattern  injected,  five 
random inputs were simulated.   
the  signature  was  additionally  cubed 
The 
results 
random  uniformly  distributed 
symmetrical error pattern (componentwise XOR) injection 
are presented in Table 4. 
for 
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 12:30:51 UTC from IEEE Xplore.  Restrictions apply. 
  The  manifestation  of  unidirectional  errors  is  data 
dependant.    Thus,  even  the  linear  code  exhibited  some 
robust  behavior.    The  data  dependant  error  detection 
property  of  the  linear  code  in  the  case  of  unidirectional 
errors  caused  the  linear  protection  to  be  more  closely 
matched to the robust protection (Table 5). 
  Errors,  which  were  missed  by  the  linear  architecture, 
were  also  considered.    In  this  simulation  random  128-bit 
errors  in  information  bits  were  generated.    The  28 
additional  redundant  error  pattern  bits  were  generated  in 
such a way that the error pattern itself was a codeword of 
the  corresponding  (156,128)  linear  code.    The  results  of 
the simulation are presented in Table 6. 
The  simulation  results  presented  in  Tables  4,  5  and  6 
support  the  estimations  for  robust  codes  presented  in 
Section  2.    The  simulation  results  support  the  claim  that 
the  number  of  undetectable  errors  for  robust  codes  is 
considerably lower than that of the linear counterparts.
Table 6. Protection against errors missed by 
linear architecture 
ERRORS
ERRORS
ERROR
MISSED AFTER 
MISSED AFTER 
PATTERNS
INJECTED 
1 RANDOM 
INPUT
5 RANDOM 
INPUTS
LINEAR
PROTECTION
ROBUST
CUBIC
PROTECTION
28.1 
billion
28.1 
billion
28.1 billion 
28.1 billion 
157 
84 
8. Advantages of proposed robust 
architecture and future tasks 
  When  attempting  to protect  a  device  against  naturally 
occurring  faults,  assumptions  and  statistical  analyses  are 
made to determine the most probable errors.  With natural 
errors  in  devices  and  communication  channels  there  are 
often well-defined classes of errors, which appear  the vast 
majority of the time.  Protection schemes are then focused 
on  protecting  against  that  class  of  errors.    However, 
statistical assumptions cannot, and should not be made for 
devices  which  can  be  subjected  to  an  organized  fault 
analysis  attack.    An  attacker  could  potentially  inject  any 
type  or  kind  of  fault.    An  approach  should  be  taken  to 
minimize the number of total undetectable errors for such 
a device as to limit an attacker’s chances of success.   
  The probability of injecting an undetectable error into 
a  device  is  an  important  criterion  to  characterize  a 
resistance to DFA attacks.  The proposed robust codes can 
be  used  to  extend  the  error  coverage  of  existing  linear 
codes.    They  have  a  hardware  cost,  but  their  increased 
error  coverage  advantage  outweighs  those  costs  when  it 
comes  to  DFA  resistant  AES  applications  such  as  smart 
cards.    As  summarized  in  Table  I,  the  number  of 
(a)
(b)
Figure 4 .  Bit flip error model  simulation test 
benches (a) linear; (b) robust cubic.
Table 4. Results of the injection of symmetrical 
errors
ERROR PATTERNS 
AFTER 5 
INJECTED 
RANDOM INPUTS 
ERRORS MISSED 
29.7 billion 
29.7 billion 
118 
0 
LINEAR
PROTECTION
ROBUST CUBIC 
PROTECTION
Results in Table 4 support our calculations (see Table 
1).  As expected, for symmetrical errors the probability of 
an undetectable error in the linear error detection scheme 
r(cid:16)2 and  much  less  in  the  robust  case  (calculated  to  be 
is
r22(cid:16)
, hence no missed errors). 
Similarly,  random  unidirectional  (1  to  0  only)  errors 
were  injected  at  the  extended  output.    The  results  of  the 
simulation are presented in Table 5. 
Table 5. Results of the injection of unidirectional 
errors
ERROR
MISSED AFTER 
MISSED AFTER 
ERRORS
ERRORS
PATTERNS 
INJECTED
12.2 billion 
12.2 billion 
1 RANDOM 
2 RANDOM 
INPUT
160 
43 
INPUTS
0 
0 
LINEAR
PROTECTION
ROBUST
CUBIC
PROTECTION
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 12:30:51 UTC from IEEE Xplore.  Restrictions apply. 
r2  times smaller 
undetectable errors for the robust code is 
than  for  the  corresponding  linear  code.    When  the 
redundancy is as large as in our example where r=28, the 
difference is enormous.  
to
282(cid:16)
In our robust design we had chosen an r=28.  With the 
introduction  of  the  nonlinear  cubic  we  reduced  the 
562(cid:16) without 
fraction  of  undetectable  errors  from 
increasing the redundancy r of the original linear code and 
with  relatively  small  hardware  overhead  (75%  over 
unprotected  AES).    To  achieve  the  same  probability  of 
562(cid:16) with linear codes only, the redundancy r would need 
to  be  extended  to  56  bits.    A  linear  predictor  which  can 
generate r=56 bit signatures would result in duplication of 
hardware.    Thus,  the  robust  nonlinear  codes  allow  larger 
error coverage at a lower cost.  
power 
through 
operations 
It is become clear now that tamper-resistance must be 
integral and a countermeasure against one physical attack 
must  not  benefit  another  attack  [20].  The  AES  algorithm 
does not contain arithmetic operations, only table lookups, 
bitwise “XOR”, and fixed byte rotation. Thus, AES is not 
particularly  susceptible  to  leaking  information  during 
cryptographic 
and 
electromagnetic  side-channels.    Of  course,  now  that  new 
more  effective  attacks  (e.g. [8, 21]) have  been  developed 
it  is  become  clear  that  the  algorithm  itself  can’t  be  safe 
enough  against  all  possible  attacks  and  any  reliable 
implementation  must 
reasonable 
countermeasures  to  side-channel    attacks.  However,  it  is 
still  very  important  to  preserve  good  properties  of  AES 
related  to  resistance  against  power  and  timing  analysis 
attacks  when  one  is  suggesting  a  countermeasure  to  fault 
injection based attacks. Error detection procedures should 
be  based  on  the  same  finite  field  operations  as  the  AES 
algorithm,  the  proposed  robust  protection  satisfy  this 
criterion.
done  with 
be 
Our  future  research  will  combine  protection  against 
fault-injection  with  countermeasures  against  power  and 
timing  analysis  attacks.  There  are  two  relatively  new 
approaches  that  are  fighting  with  the  sources  of  data-
dependent  variations  of  power,  timing  and  erroneous 
behavior  [22,  23].  The  first  makes  power  consumption 
almost data-independent by balancing the capacitive loads 
of  differential  nodes.  The  second  uses  self-timed  circuits 
with  dual-rail  logic  to  resist  power  analysis  and  single-
point  fault  induction.  These  approaches  (combined  with 
methods  proposed  in  [23]  and  [22])  seem  to  be  very 
attractive  countermeasure  against  power-analysis  attacks. 
Self-timed  circuitry  because  of  absence  of  clocks  makes 
glitch  attack  practically  impossible.  However,  dual-rail 
encoding with alarm state from [23] is effective only for a 
limited  class  of  induced  errors  (a  single  point  fault 
induction, i.e. affecting only one wire). It is rather easy to 
imagine  an  attacker  that  can  modify  symmetrically  both 
wires  from  dual-rail  pair  using  e.g.  attack  from  [17,18]. 
Such  error  induction  will  not  be  visible  for  the  alarm 
of 
“classical” 
weaknesses 
generators  from  [23].  More  developed  error  detection 
techniques,  such  as  robust  protection,  need  to  be  used. 
Other 
self-timed 
in  [18]  could  be 
implementations  [23]  discovered 
effectively  dealt  with  by  asynchronous 
fine-grain 
multidimensional  pipelined  structures  [24].  We  are  now 
starting  development  of  robust  asynchronous  fine-grain 
pipelined implementations of AES using EDA tools under 
development in Boston University. 
References: 
[1] C.E. Landwehr, Computer Security. International Journal of  
Information Security (2001) 1: 3-13. 
[2] E. Hess, N. Janssen, B. Meyer, and T. Schütze Information
Leakage Attacks Against Smart Card Implementations of
Cryptographic Algorithms and Countermeasures - A Survey.
Proceedings of EUROSMART Security Conference, 2000 
[3] J. Kelsey, B. Schneier, D. Wagner, and C. Hall, Side Channel  
'98 
of  Product  Ciphers,  ESORICS 
Cryptanalysis 
Proceedings, 1998, pp. 97-110. 
[4] C. D. Walter,  Montgomery’s Multiplication Technique: How  
to make it Smaller and Faster, Proc. Workshop on  
Cryptographic  Hardware  and  Embedded  Systems,  (CHES 
99), 1999, Lecture Notes in Computer Science, vol. 1717, pp 
80-93.
[5] M.Joye, J.-J.Quisquater, S.-M. Yen  and  M.Yung   
Observability  Analysis  - 
  Detecting  when  Improved 
Cryptosystems  Fail.  Topic  in  Cryptology  –CT-RSA  2002, 
vol. 2271 in Lecture Notes in Computer Science, pp 17-29. 
[6] S. Micali and L. Reyzin,  Physically Observable  
Cryptography, Cryptology ePrint Archive of IACR, No. 120, 
2003,  available at http://eprint.iacr.org/2003/120 
[7] E. Biham and A. Shamir, Differential fault analysis of  
secret key cryptosystems, CRYPTO 97, LNCS 1294, pp.513-
525
[8] C.N. Chen and S.-M.Yen, Differential Fault Analysis on  
AES  Key  Schedule  and  Some  Countermeasures,  ACISP 
2003, LNCS 2727, pp.118-129, 2003 
[9]  P. Dusart, G. Letourneux, O. Vivolo, Differential Fault  
Analysis  on  AES,  Cryptology  ePrint  Archive,        Report 
2003/010. Available:  http://eprint.iacr.org/2003/010.pdf 
[10]C. Giraud. DFA on AES. Cryptology ePrint Archive, Report  
2003/008. Available:
http://eprint.iacr.org 
http://citeseer.nj.nec.com/558158.html 
and 
[11]J. Blomer and J.P. Seifert, Fault based cryptanalysis of the
advanced  encryption  standard  (AES),    Cryptology  ePrint 
Archive: 
at: 
Report 
http://eprint.iacr.org. 
2002/075. 
Available 
[12]Ramesh Karri, Kaijie Wu, Piyush Mishra, Yongkook Kim,  
Concurrent  Error  Detection  of  Fault  Based  Side-Channel 
Cryptanalysis  of  128-Bit  Symmetric  Block  Ciphers.    IEEE
Transactions 
of 
Integrated  Circuits  and  Systems,  Vol.21,  No.12,  pp.  1509-
1517, 2002 
on  COMPUTER-AIDED  DESIGN 
[13]G. Bertoni, L. Breveglieri, I. Koren, P. Maistri and V. Piuri,  
Error  Analysis  and  Detection  Procedures  for  a  Hardware 
Implementation of the Advanced Encryption Standard, IEEE 
Transactions on Computers, VOL. 52, NO. 4, 2003 
[14]M. G. Karpovsky, P. Nagvajara, "Optimal Robust  
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 12:30:51 UTC from IEEE Xplore.  Restrictions apply. 
Compression  of  Test  Responses," 
Computers, Vol. 39, No. 1, pp. 138-141, January 1990. 
IEEE  Trans.  on 
[15]M. G. Karpovsky, P. Nagvajara, "Optimal Codes for the  
Minimax  Criterion  on  Error  Detection,"  IEEE  Trans.  on 
Information Theory, November 1989. 
[16]FIPS PUB 197: Advanced Encryption Standard,
http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf 
[17]S. Skorobogatov and R. Anderson. Optical Fault Induction  
Attacks.  IEEE  Symposium  on  Security  and  Privacy,  May 
2002.
[18]J.J.A. Fournier, S. Moore, H.Li, R. Mullins, and G. Taylor.  
Security  Evaluation  of  Asynchronous  Circuits.  Proc. 
Workshop  on  Cryptographic  Hardware  and  Embedded 
Systems, (CHES 2003). 
[19] F.J. McWilliams and N.J.A. Sloane, The Theory of Error- 
Correcting Codes, North Holland, 1978 
[20]S.-M.Yen, S.Kim, S.Lim and S.Moon A Countermeasure  
against  One  Physical  Cryptanalysis  May  Benefit  Another 
Attack: ICICS 2001, LNCS 2288, pp. 414-427 
[21]S.-M.Yen Amplified differential power cryptanalysis of  
some  enhanced  Rijndael  implementations.  ACISP  2003, 
LNCS 2727, pp.106-117, 2003 
[22]Kris Tiri, Moonmoon Akmal, Ingrid Verbauwhede, "A
Dynamic  and  Differential  CMOS  Logic  with  Signal 
Independent  Power  Consumption  to  Withstand  Differential 
Power Analysis on Smart Cards", 28th European Solid-State 
Circuits Conference (ESSCIRC 2002) 
[23]Simon Moore, Ross Anderson, Robert Mullins, George  
Jacques 
Self-Checking 
Taylor, 
for  Smart  Card  Applications
Asynchronous  Logic 
Microprocessors and Microsystems, 27 (2003) pp. 421-430. 
Fournier,  Balanced 
[24]A.Taubin, K. Fant, J. McCardle Design of Delay-Insensitive  
Three  Dimension  Pipeline  Array  Multiplier  for  Image 
Processing. 
International 
Conference  on  Computer  Design:  VLSI  in  Computers  and 
Processors. ICCD’2002, p.p.104-111. 
  Proceedings,  2002 
IEEE 
Proceedings of the 2004 International Conference on Dependable Systems and Networks (DSN’04) 
0-7695-2052-9/04 $ 20.00 © 2004 IEEE 
Authorized licensed use limited to: Tsinghua University. Downloaded on March 19,2021 at 12:30:51 UTC from IEEE Xplore.  Restrictions apply.