title:On The Unforkability of Monero
author:Dimaz Ankaa Wijaya and
Joseph K. Liu and
Ron Steinfeld and
Dongxi Liu and
Jiangshan Yu
On The Unforkability of Monero
Dimaz Ankaa Wijaya∗
Monash University
Melbourne, Australia
PI:EMAIL
Joseph K. Liu+
Monash University
Melbourne, Australia
PI:EMAIL
Ron Steinfeld
Monash University
Melbourne, Australia
PI:EMAIL
Dongxi Liu
Data61, CSIRO
Sydney, Australia
PI:EMAIL
Jiangshan Yu
Monash University
Melbourne, Australia
PI:EMAIL
ABSTRACT
Monero, ranked as one of the top privacy-preserving cryptocur-
rencies by market cap, introduced semi-annual hard fork in 2018.
Although hard fork is not an uncommon event in the cryptocur-
rency industry, the two hard forks in 2018 caused an anonymity
risk to Monero where transactions became traceable due to the
problem of key reuse. This problem was triggered by the existence
of multiple copies of the same coin on different Monero blockchain
branches such that the users spent the coins multiple times without
preemptive action. We investigate the Monero hard fork events by
analysing the transaction data on three different branches of the
Monero blockchain. Although we have discovered an insignificant
portion of traceable inputs compared to the total available inputs
in our dataset, our analyses show that the scalability of the event
depends on external factors such as market price and market avail-
ability. We propose a cheap, easy to implement strategy to prevent
the problem of key reuse, should in the future stronger Monero
forks emerge in the market.
CCS CONCEPTS
• Security and privacy → Pseudonymity, anonymity and untrace-
ability;
KEYWORDS
Monero, key reuse, hard fork, traceability, anonymity, ring signa-
ture, cryptocurrency
ACM Reference Format:
Dimaz Ankaa Wijaya, Joseph K. Liu+, Ron Steinfeld, Dongxi Liu, and Jiang-
shan Yu. 2019. On The Unforkability of Monero. In ACM Asia Confer-
ence on Computer and Communications Security (AsiaCCS ’19), July 9–12,
2019, Auckland, New Zealand. ACM, Auckland, New Zealand, 12 pages.
https://doi.org/10.1145/3321705.3329823
∗Also with Data61, CSIRO, Melbourne, Australia. +Corresponding author..
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
AsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand
© 2019 Association for Computing Machinery.
ACM ISBN 978-1-4503-6752-3/19/07...$15.00
https://doi.org/10.1145/3321705.3329823
1 INTRODUCTION
Cryptocurrency has become a global phenomenon. The first of
its kind, Bitcoin, was created by Satoshi Nakamoto [22]. Bitcoin
was launched in 3 January 2009 as a peer-to-peer payment system
employing a shared ledger called blockchain, where a consensus
method is employed such that the system is not controlled by any
central party. In the published whitepaper, Satoshi describes Bitcoin
as an anonymous, where no information links the public keys to
the real identity of the owners [22]. However, the anonymity of
the public keys is insufficient to protect the privacy of the users.
Researchers have developed analysis methods to reveal informa-
tion about the users from external sources [18]. The transparent
blockchain data was also utilised to reveal the transaction patterns
such that the users’ behaviours are identified [27].
Much research has been conducted in the blockchain privacy
area, where privacy-preserving cryptocurrencies such as Monero
try to address the problem. Monero is one of the most successful
privacy-preserving cryptocurrencies and has been one of the most
valuable cryptocurrencies according to Coinmarketcap.com1. Mon-
ero is based on CryptoNote protocol [34], where the untraceability
of the sender and the unlinkability of the receiver are protected
by cryptographic methods such as Linkable Ring Signature (LRS)
and one-time public key (OTPK) which makes transactions more
anonymous compared to other cryptocurrencies such as Bitcoin
[34]. Although anonymity features were implemented, research
results show that the transactions in Monero can still be traced due
to the problem of zero mixin transactions [14, 21].
In a blockchain ecosystem, a fork is an event where the proto-
col changes [40]. Zamyatin et al. [40] classified the changes into
several possibilities: protocol expansion, reduction, conflicting (bi-
lateral), and conditionally reduction (velvet). There are generally
two types of blockchain fork, namely hard fork and soft fork. Hard
fork is related to either protocol expansion or bilateral which results
in a blockchain split or chain split. Soft fork, including protocol
reduction and velvet, does not produce any chain split [40].
Blockchain fork in the cryptocurrency setting usually benefits
the users financially [26]. For example, a user had one Bitcoin
before the Bitcoin Cash fork. After the forking event happened, the
same user will double his/her money: one Bitcoin in the original
blockchain and one Bitcoin Cash in the newly created blockchain
1The total market cap for Monero is US$1.7B on 26 October 2018
Session 8: Blockchain SecurityAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand621AsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand
Wijaya et al.
Figure 1: The Monero hard fork timeline which shows two
hard forks resulting in three different chains by October
2018.
branch. The price of Bitcoin was US$2,808 (open price)2 while
Bitcoin Cash was traded at the rate US$555.89 (open price) each3,
so the user received a coin worth US$555.89 for every bitcoin he/she
held by doing nothing.
As a part of the attempt to keep its system updated, Monero has
a regular hard fork which is scheduled semi-annually. The hard
fork of Monero mostly aims to improve the privacy solutions. How-
ever, Monero also aims to become an ASIC-proof cryptocurrency,
where the software developers discourage the development of ASIC
machines for participating in Monero mining through the existing
Proof-of-Work (PoW) mechanism [6, 34]. For this purpose, on 6
April 2018 Monero updated its mining algorithm to render exist-
ing ASIC machines’ efficient computing void. The event created a
new Monero fork as Monero upgraded from protocol version six to
version seven.
The hard fork happened due to the incompatibility between two
protocol versions. The protocol version seven started from block
number 1,546,0004 which was on 6 April 2018. There were several
independent parties claiming that they still wanted to run version
six protocol. These independent parties rebranded the blockchain
system running Monero protocol version six into three different
names: Monero Original (XMO), Monero 0 (Monero Zero or ZMR),
and Monero Classic (XMC)[19]. Although there are three different
names, in reality there is only one blockchain [2]. After the Monero
hardfork, another project was also forked from the Monero ver-
sion seven, called MoneroV (XMV), starting from block number
1,564,9665 which was on 3 May 2018. MoneroV runs a modified
version of protocol seven. One of the modifications on MoneroV’s
protocol from Monero version seven is the reduction of the decimal
places from 12 to 11. This causes all coin values to be multiplied
ten fold. The fork history is shown in Figure 1.
Similar to other blockchain fork events, the Monero users dou-
bled their Monero coins on each event, where they receive the same
amount or even more coins in the newly created cryptocurrencies.
However, when the users decide to use the same coins without extra
caution, the anonymity of the transactions is potentially reduced.
The traceability could be compromised in a Monero hard fork
event. The hard fork event creates new coins which will be spend-
able by the pre-fork users. The problem occurs when the Monero
2https://coinmarketcap.com/currencies/bitcoin/historical-
data/?start=20170723&end=20170723
3https://coinmarketcap.com/currencies/bitcoin-cash/historical-
data/?start=20170723&end=20170723
4https://github.com/monero-project/monero
5https://github.com/monerov/monerov
users spend the newly created coins, such that the traceability of the
transaction’s sender can be deduced. We denote this as the problem
of key reuse. The problem of key reuse reduces the anonymity of a
transaction because the users reuse the same keys when spending
the same coins. This traceability problem was known to Monero
developers [6], where the existing strategies are not sufficient to
completely mitigate the problem.
Contributions. We summarise our contributions as follows.
• We investigate the impact of two Monero hard forks which
occurred in 2018. We collected the data of each blockchain
branch and cross-reference the transaction data on all of
the blockchain branches to determine traceable inputs. We
discover over 55K distinct traceable inputs, where 90% of
them are found on two blockchain branches running version
six and seven. About 19% of all inputs in Monero version six
of our dataset are traceable. However, the percentage of the
traceable inputs is insignificant compared to the total inputs
in Monero version seven (or the main branch). Unlike exist-
ing attacks [14, 21, 35, 37, 39], the analysis on the problem
of key reuse is able to identify traceable inputs in Monero’s
RingCT. None of the traceable inputs of our findings can be
discovered by existing attacks.
• We analyse the correlation between the identified traceable
inputs and market prices by using statistical analyses, namely
correlation coefficients and linear regression. The results on
the correlation coefficients show that there is a strong corre-
lation (0.553 to 0.761) between the two factors in Monero6,
whereas a weak correlation (0.242 to 0.32) is found in Mon-
eroV. Likewise, the linear regression results show a medium
relationship in Monero6 but a small relationship in MoneroV.
A bigger support from cryptocurrency exchanges to Mon-
ero6 compared to the support to MoneroV also explains the
huge gap of traceable inputs on both blockchain branches.
These findings also show that the scalability of the problem
of key reuse depends on the identified external factors.
• We propose a mitigation strategy for the problem of key
reuse caused by hard forks in Monero. Scalable Bloom
Filters [1] provide an inexpensive checking mechanism
of existing key images and mixins. By adding the check-
ing mechanism prior submitting new transactions to the
network, transactions spending the same coins will main-
tain the same level of anonymity. A new service node called
joint node is proposed such that the mitigation strategy
can be deployed in the current Monero protocol without any
significant changes.
Organisation. The rest of the paper is organised as follows. Sec-
tion 2 contains technical background about Linkable Ring Signature
(LRS) and Monero protocol. In Section 3, related work about exist-
ing anonymity attacks to Monero, an alternative strategy to hard
fork, and replay protection. A threat model is presented in Section
4. Section 5 describes our analysis methods. Section 6 covers cur-
rent mitigation strategies to the identified problems, where our
mitigation strategy proposal is also presented in this section. Sec-
tion 7 provides discussions on the security and the performance
of the proposed mitigation strategy, while Section 8 concludes the
findings and describes future work.
Session 8: Blockchain SecurityAsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand622On The Unforkability of Monero
AsiaCCS ’19, July 9–12, 2019, Auckland, New Zealand
2 BACKGROUND
2.1 Linkable Ring Signature
Linkable Ring Signature (LRS) [15, 16] was developed based on Ring
Signature (RS) technique. LRS enables the users to take advantage of
RS. In RS, a signer cannot be identified over a set of potential signers
even if the signer creates many signatures, but in LRS, the signature
creator can only create one signature for every private key she
holds if she wants to maintain the signature anonymity. A tagging
system is employed in LRS. If the same signer reuses the same
private key to create more than one signature, then a verifier will
be able to link the signatures and determine that they are created
by using the same private key, because the same tag will appear
in both signatures. As the same tag is only known by the signer,
this implies that the signatures are created by the same person. LRS
limits the anonymity in RS. However, this limitation is useful in
many scenarios such as e-voting [5, 38] and cryptocurrency system
[31], where a double-vote or double-spending of a coin should be
prevented.
2.2 Monero Transaction Structure and Protocol
The structure of a Monero transaction is shown in Figure 2. An input
I contains a ring signature R which uses of an output set O of size
r. The output set O contains an output to be spent oi ∈ O and r − 1
outputs as decoys. The decoys are usually chosen at random from
the public blockchain B such that the probability of guessing the
real output being spent is not more than 1/r . A Monero transaction
can produce zero or more new outputs which will then be added to
the output database in the blockchain B. These new outputs will be
available to be spent or can also be chosen as decoys in the next