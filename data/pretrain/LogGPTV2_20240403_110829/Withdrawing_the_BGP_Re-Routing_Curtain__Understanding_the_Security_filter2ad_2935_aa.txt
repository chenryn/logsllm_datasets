title:Withdrawing the BGP Re-Routing Curtain: Understanding the Security
Impact of BGP Poisoning through Real-World Measurements
author:Jared M. Smith and
Kyle Birkeland and
Tyler McDaniel and
Max Schuchard
Withdrawing the BGP Re-Routing Curtain:
Understanding the Security Impact of BGP Poisoning via Real-World Measurements
Jared M. Smith, Kyle Birkeland, Tyler McDaniel, and Max Schuchard
University of Tennessee, Knoxville
{jms,kbirkela,bmcdan16,mschucha}@utk.edu
Abstract—The security of the Internet’s routing infrastructure 
has  underpinned  much  of  the  past  two  decades  of  distributed 
systems  security  research.  However, the  converse  is  increasingly 
true.  Routing  and  path  decisions  are  now  important  for  the 
security  properties  of  systems  built  on  top  of  the  Internet.  In 
particular, BGP poisoning leverages the de facto routing protocol 
between  Autonomous  Systems  (ASes)  to  maneuver  the  return 
paths of upstream networks onto previously unusable, new paths. 
These  new  paths  can  be  used  to  avoid  congestion,  censors,  geo-
political  boundaries,  or  any  feature  of  the  topology  which  can 
be  expressed  at  an  AS-level.  Given  the  increase  in  use  of  BGP 
poisoning as a security primitive for security systems, we set out 
to  evaluate  the  feasibility  of  poisoning  in  practice,  going  beyond 
simulation.
To that end, using a multi-country and multi-router Internet-
scale  measurement  infrastructure,  we  capture  and  analyze  over 
1,400  instances  of  BGP  poisoning  across  thousands  of  ASes  as 
a  mechanism  to  maneuver  return  paths  of  trafﬁc.  We  analyze 
in  detail  the  performance  of  steering  paths,  the  graph-theoretic 
aspects of available paths, and re-evaluate simulated systems with 
this data. We ﬁnd that the real-world evidence does not completely 
support  the  ﬁndings  from  simulated  systems  published  in  the 
literature. We also analyze ﬁltering of BGP poisoning across types 
of  ASes  and  ISP  working  groups.  We  explore  the  connectivity 
concerns when poisoning by reproducing a decade old experiment 
to  uncover  the  current  state  of  an  Internet  triple  the  size.  We 
build predictive models for understanding an ASes’ vulnerability 
to  poisoning.  Finally,  an  exhaustive  measurement  of  an  upper 
bound on the maximum path length of the Internet is presented, 
detailing how recent and future security research should react to 
ASes  leveraging  poisoning  with  long  paths.  In  total,  our  results 
and  analysis  attempt  to  expose  the  real-world  impact  of  BGP 
poisoning  on  past  and  future  security  research.
I. 
INTRODUCTION
Responsible  for  ensuring  packets  ﬁnd  their  home  once 
they  begin  their  journey,  the  Internet  routing  infrastructure 
serves  a  key  role  in  ensuring  the  reachability,  availability, 
and  reliability  of  online  services.  Given  the  importance  of 
its  fundamental  role,  the  security  of  the  routing  infrastructure 
as  a  set  of  protocols  and  routing  process  has  underpinned 
much  of  the  past  two  decades  of  distributed  systems  security 
research. However, the converse is becoming increasingly true. 
Routing and path decisions are now important for the security 
properties  of  systems  built  on  top  of  the  Internet.
Network  and  Distributed  Systems  Security  (NDSS)  Symposium  2020
23-26  February  2020,  San  Diego,  CA,  USA
ISBN  1-891562-61-4
https://dx.doi.org/10.14722/ndss.2020.24240
www.ndss-symposium.org
In particular, research has begun to harness the de facto
routing protocol on the Internet, the Border Gateway Protocol
(BGP)[44] and the functionality it provides to implement
new offensive, defensive, and analytical systems. Growing in
use, a method known as BGP poisoning has been leveraged
by censorship circumvention, DDoS defense, and topology
discovery. Rooted in the BGP RFC, BGP poisoning can be
used by routing-capable entities. These entities are known on
the Internet as Autonomous Systems, or ASes [16]. Fundamen-
tally, BGP poisoning is now being used to maneuver an ASes’
return trafﬁc around speciﬁc AS-to-AS links, new regions of
the Internet topology previously not visible to certain ASes,
and other regions of interest. Critically, BGP poisoning and the
re-routing it provides is being employed for security purposes.
For example, Smith et. al. presented Nyx, a DDoS defense
system that leveraged the ability to manipulate inbound trafﬁc
paths with BGP for a security purpose: to route around attacked
links on the Internet [52]. Nyx relies on altering paths on
the Internet to circumvent links affected by DDoS, and is
evaluated on the entire Internet via simulation. Prior to Nyx,
Katz-Basset et. al. demonstrated the use of BGP poisoning in
practice for single link-failures, as opposed to DDoS-inﬂicted
failures, with LIFEGUARD [23]. In the domain of censorship
circumvention, decoy routing (DR) has become a standard
means to avoid censoring eyes [64], [63], [21], [19], [6];
though, Schuchard et. al. presented the Routing Around Decoys
(RAD) attack and follow-on E-Embargos [50], [51], which
utilized the routing infrastructure to circumvent decoy routers
by re-routing both outbound and return paths to completely
avoid decoy routers. In general, these security systems rely
on the real-world feasibility of BGP poisoning to carry out
defensive security goals.
Yet other systems rely on the opposite assumption to
provide security guarantees or to attack poisoning-enabled
defenses, that BGP poisoning is infeasible in the real-world.
In response to Schuchard et al.’s RAD attack on decoy routing
systems, Houmansadr et. al presented the Waterfall of Liberty
system, which demonstrated that RAD could be prevented
with downstream decoys [20], relying on altering return paths
via BGP poisoning to be infeasible, and Goldberg et. al.
added additional security guarantees to Waterfall [7]. In the
world of DDoS, Tran & Kang et al. presented an adaptive
Crossﬁre/Link-Flooding Attack (LFA) [60] that challenged
Nyx, which we term Feasible Nyx, yet their approach is only
measured in simulation, supported by passive observations
gathered by a single major network. Additionally, Tran’s
claims about how ASes ﬁlter poisoned paths are supported by
passive, not active, measurements. These particular security
systems rely on the infeasibility of BGP poisoning to carry
out both offensive and defensive security goals.
We recognize that the lack of evidence exposing BGP
poisoning’s real-world feasibility has given rise to diverging
claims in the research community. Worse, even the network
operator community is being affected, as multiple NANOG
mailing list threads have led to long, heated debates regarding
the feasibility, positives, and negatives of BGP poisoning as a
re-routing mechanism [40], [39], [38]. While some published
research claims re-routing based on poisoning is feasible,
like Nyx, RAD, and LIFEGUARD, other research, such as
Waterfall and Adaptive LFA attacks, assumes the opposite
claim is true when presenting their experiments and analysis.
While this problem is unaddressed, network operators can not
reasonably depend on BGP poisoning for defensive purposes,
or refute the feasibility of and leave out BGP poisoning when
designing threat models, pushing critical networks to lose out
on the beneﬁts of any of the systems described above. While
deployment of poisoning is still possible without a ground
truth of Internet behavior, no prior study outlines with real-
world active measurements 1) how feasible re-routing with
BGP poisoning is in practice, 2) how networks and ASes
treat poisoned AS paths propagated by a Nyx defender, RAD
adversary, or network operator, and 3) clariﬁes the security
implications of 1 and 2. This paper serves as that study.
Understanding and Analyzing Re-Routing Feasibility
We present the ﬁrst self-contained collection of novel, real-
world, Internet-scale measurements that validate or refute
assumptions made in simulation or passively in recent secu-
rity literature, such as RAD, Waterfall, Nyx, and Adaptive
CrossFire/Link-Flooding Attacks. We provide insight into uti-
lizing BGP poisoning as a topology and congestion discovery
tool. We re-evaluate the Nyx DDoS defense platform, examine
the graph-theoretic aspects of return paths available to ASes,
and build predictive models for ASes wishing to understand
their vulnerability to poisoning. We examine not only the
ﬁltering of BGP advertisements using poisoning, but also what
ASes and what policies are deployed by such ASes that ﬁlter.
To understand whether routing operator groups walk the walk
when it comes to poison ﬁltering, we measure their behavior
against ASes not in a popular security-ﬁrst ISP consortium.
These ﬁndings were uncovered via a 6-month long series
of active measurements, beginning in January 2018 until July
2018. These measurements employed an array of control-plane
and data-plane Internet infrastructure. This infrastructure in-
cluded a collection of ASes from our own organization and the
broader Internet via PEERING [49], a real-world BGP testbed,
nearly all responsive and one-per-AS 5k traceroute sources
from RIPE Atlas [45], and live streams of BGP announcements
from RouteViews [47] and the RIPE Routing Information Ser-
vice [46]. In practice, we found that the Internet’s treatment of
BGP poisoning lies on a spectrum of behavior when evaluated
across 1,400+ experiments, conducted with permission and
guidance from 5 geographically and topologically diverse ASes
on the Internet.
Speciﬁcally, we ﬁnd that for 1,460 instances of BGP poi-
soning, over 77% of the distinct instances could be successfully
maneuvered onto new, previously unreachable AS-links at
some point in the original path. An average of 8 new links
were discovered per path, for a total of 3 completely new paths
on average. In 20% of cases, more than 5 completely new
paths were discovered, with a maximum of 19 unique paths
in one particular case and 23 total new links in another case.
Beyond enumerating new paths, we found that BGP poisoning
can be used to route around 80% of ASes with less than 2,500
customers, considered small to medium-sized transit ASes. By
further reﬁning these measurements, we uncovered additional
cases of poison ﬁltering for highly connected ASes such as
L3 and Cogent. When poisoning downstream ASes in systems
such as Nyx, RAD, and others, connectivity can be lost to
the poisoned ASes if a less speciﬁc IP block is not advertised
to cover for the poisoned AS. In our work, we conducted an
assessment of the ability of a poisoning AS without a less spe-
ciﬁc covering preﬁx to maintain reachability to the poisoned
ASes, ﬁnding that 30% of all ASes on the Internet can reach a
/25 preﬁx advertised by an AS with only a /24, which is critical
to effective BGP poisoning in an IPv4-dominated Internet.
Next, we investigated default routing on the Internet and found
that for 36% of ASes with only 2 providers (that is, multi-
homed in the simplest case), even when the primary provider is
poisoned, the AS will continue to route through it. This ﬁnding
hints that placing Waterfall resistors nearest the last-mile yields
beneﬁts even in the presence of routing-capable censors. We
set out to uncover the raw amount of poisoning that a routing-
capable AS can carry out, which has direct implications for
the effectiveness of systems such as Nyx in practice. We ﬁnd
that ASes can propagate paths up to 251 in length that are
accepted by 99% of the Internet via customer cone inference.
Critically, we also ﬁnd that the Nyx system performs roughly
30% worse in practice than in simulation, and that routing
working groups do "walk the walk", and do not only "talk the
talk". Perhaps intuitively, the larger the AS or ISP, the more
ﬁltering of poisons occurs, and the smaller, the less ﬁltering.
Throughout the rest of this paper, we dive deeper into these
and additional analysis of BGP poisoning’s feasibility on the
Internet. We summarize our results, key takeaways, impacts on
existing security systems, and security ramiﬁcations in Table I.
Our Contributions
• We conducted the largest measurement study on BGP
poisoning to date, comprising 1,460 successful/1,888
total poisoning cases. We publish our dataset, source
code, and data analysis from the ﬁnal results of this
paper. 1 See Section V.
reproduce
recent
• We
in-
simulation or passively, but now with active BGP
poisoning on the live Internet. See Sections V-B1 and
VI-C.
security papers done
• We constructed statistical models that serve as a
ﬁrst-step towards utilizing BGP poisoning as an AS
operator without requiring active tests or convincing
senior IT administrators. See Section V-C.
• We assess the extent and impact of poisoned path
ﬁltering from several perspectives. For this analysis,
see Section VI.
• We reassessed the Internet’s behavior with respect to
default routes and /25 reachability 1 decade after the
ﬁrst exploration. See Sections VII-A and VII-B for
these ﬁndings.
1https://github.com/VolSec/active-bgp-measurement
2
TABLE I: Experiment summaries and their takeaways, impacted security systems, and ramiﬁcations for Internet routing security in general.
Experiment
Conducted
Section V: Steering
Return Paths
Section V-B1:
Re-Evaluation of
Nyx
High-Level Description
Key Takeaways
Explores which ASes can effectively
conduct poisoning, as well as the
properties of alternative paths
77% of cases with successful path steering,
Avg. 3 new unique traversed paths,
minimal poisons needed, < 1% latency
increase for alternate paths
Re-evaluates the Nyx DDoS defense
system with active measurements directly
compared to simulated results
Nyx performs 30% less effective in
practice, the inferred topology of the
Internet used in simulation often does not
match the topology and policies in practice
Section VI-A:
Filtering of Poisoned
Advertisements
Investigates the ASes that ﬁlter BGP
poisoned advertisements as well as their
relative size and other metadata
80% of ASes with less than 2,500
customers can be poisoned to 99% of the
Internet
Existing Security
Systems Impacted
Waterfall of Liberty,
RAD, Nyx, Feasible
Nyx, LIFEGUARD
Nyx, Feasible Nyx,
LIFEGUARD
Waterfall of Liberty,
RAD, Nyx, Feasible
Nyx, LIFEGUARD
Security Ramiﬁcations
Real-world evidence supports the
claims of poisoning-enabled
systems, with caveats for speciﬁc
topological cases
Success of a system in simulation
and/or passive measurement does
not guarantee success (or the
same ﬁndings) in the real-world
For speciﬁc parts of the Internet
topology, poisoning does not work
very effectively, allowing systems
that would otherwise be hampered
by poisoning to thrive in speciﬁc
regions of the Internet
Section VI-B, VI-C:
Filtering of Long
Poisoned Paths
Establishes an upper bound for the
maximum path length able to be advertised
on the Internet with BGP poisoning
Max path length of up to 255 ASes
propagated to 99% of the Internet
RAD, Nyx, Feasible
Nyx, LIFEGUARD
Security systems which use
poisoning have a ﬁxed budget of
poisons in reality, speciﬁcally 245
when factoring in the length of a