campaign and the domains it uses can be complex: a domain
may be used in multiple campaigns, and a campaign may
continuously cycle through several domains.
In fact, there is another level of structure beyond domains
and campaigns: aﬃliate programs. Today, spammers operate
primarily as advertisers, working with an aﬃliate program
and earning a commission (typically 30–50%). The aﬃli-
ate program handles Web site design, payment processing,
customer service and fulﬁllment [33].
The prior Click Trajectories measurement eﬀort [18] iden-
tiﬁed 45 leading aﬃliate programs specializing in pharmaceu-
tical sales, replica luxury goods, and “OEM” software (this
classiﬁcation includes all the major players in each category
that advertise via spam). We use the classiﬁcation results
of this project to deﬁne the tagged domains (Section 4.1).
Here, we explore the tags themselves, that is, the aﬃliate
programs associated with domains. Speciﬁcally, we consider
the coverage of each feed with respect to aﬃliate programs.
Figure 4 shows the proportion of programs covered by each
feed, relative to other feeds and all feeds combined. The
representation is the same as Figure 2: each cell indicates
the number of programs represented by the two feeds given
BotHybAc2Ac1MX3MX2MX1URIBLDBLHuAllBotHybAc2Ac1MX3MX2MX1URIBLDBLHu100%1593%14100%1593%14100%15100%15100%15100%15100%1537%1585%3585%3568%28 95%3990%3793%38 98%40100%4138%1495%3589%3368%25 97%36 97%36100%37100%37100%3742%15 97%3592%3372%26100%36100%36 97%35100%36100%3650%14100%2889%2593%26100%28 96%27100%28100%28100%2837%15 95%3988%3688%3668%28 95%39 95%39100%41100%4138%1595%3792%3692%3669%27100%39 97%38100%39100%3936%1590%3888%3783%3567%2893%3990%38100%42100%4234%1591%4084%3782%3664%2893%4189%39 95%42100%4433%1591%4182%3780%3662%2891%4187%3993%42 98%4433%1591%4182%3780%3662%2891%4187%3993%42 98%44100%45BotHybAc2Ac1MX3MX2MX1URIBLDBLHuAllBotHybAc2Ac1MX3MX2MX1URIBLDBLHu33%167%267%267%267%267%267%2100%3100%32%135%1542%1812%533%1447%2086%37 98%42 98%4211%279%1558%1121%474%1479%15100%19100%19100%1910%290%1855%1135%780%16 95%19100%20100%20100%2029%271%557%4100%7100%7100%7100%7100%7100%710%270%1470%1480%1635%790%18100%20100%20100%208%277%2058%1573%1927%769%18 96%25100%26100%263%258%3730%1931%2011%731%2039%25100%64100%640.6%38%424%194%201%74%205%2613%64100%4990.4%35%422%192%200.8%72%203%268%6459%4990.4%35%432%192%200.8%72%203%268%6459%499100%844435Figure 6: RX-Promotion aﬃliate coverage of each
feed weighted by each aﬃliate’s 2010 revenue.
Figure 7: Pairwise variational distance of tagged do-
mains frequency across all feeds. Shading is inverted
(larger values are darker).
age shown in Figure 5, although the revenue-weighted results
indicate a bias toward higher-revenue aﬃliates. While dbl
covers only 59% of Hu aﬃliates, these aﬃliates represent over
78% of revenue covered by Hu.
4.3 Proportionality
An anti-spam system seeks to identify as many spam mes-
sages as possible, and in this context volume is a natural
measure of a domain’s importance. A blacklist that identiﬁes
the top 100 spammed domains by volume will identify more
spam than a list of the same size consisting of infrequent do-
mains. Similarly, domain take-downs are best prioritized to
target high-volume domains ﬁrst. To make these judgments,
a spam domain feed must contain not only the domains
themselves, but also their observed volume.
It happens that some of our feeds do provide volume
information: each domain is listed with the number of times
a domain was seen in spam, allowing relative domain volume
and rank to be estimated. This section considers only feeds
with volume information; the Hyb feed, Hu feed and both
blacklist feeds (dbl and uribl) have no associated volume
information and are thus excluded from this analysis.
The vol-
Empirical domain distribution and rank.
umes associated with each domain deﬁne an empirical dis-
tribution on domains. That is, if a domain i has reported
volume ci in a feed, then the empirical domain probability
distribution is ci/m, where m is the total volume of the feed
(i.e., m =(cid:80)
i ci).
Variation distance.
Variation distance (also called “sta-
tistical diﬀerence” in some areas of Computer Science) is a
straightforward metric frequently used to compare distribu-
tions. Formally, given two probability distributions (feeds)
P and Q, let pi be the empirical probability of domain i in
P , and qi the probability of the same domain in Q. (If a
domain does not occur in a feed, its empirical probability is
0.) The variation distance is given by:
|pi − qi|.
(cid:88)
δ =
1
2
i
Variation distance takes on values between 0 and 1, where
δ = 0 if and only if P = Q (domains have the same probability
in both), and δ = 1 if P and Q are disjoint (no domains
in common). Figure 7 shows pairwise measures of variation
distance of tagged domains. (Because we round values to
two decimal places, a variational distance of 1 in the ﬁgure
may still allow for some domain overlap.)
Kendall rank correlation coeﬃcient.
Variation dis-
tance places more weight on more frequently occurring do-
mains. In some cases, only the relative ranks of domains are
of interest, and not the magnitudes of the empirical proba-
bilities. The Kendall rank correlation coeﬃcient (also called
Kendall’s tau-b) allows us to compare the relative ranking
of domains between two distributions. In the case where all
probabilities are distinct,
sgn(cid:2)(pi − pj)(qi − qj)(cid:3).
(cid:88)
i(cid:54)=j
τ =
1
n(n − 1)
where sgn(x) is the familiar signum function. The sum is
over all domains common to both feeds being compared,
and n is the number of such domains. The Kendall rank
correlation coeﬃcient takes on values between −1 and 1,
with 0 indicating no correlation, 1 indicating perfect positive
correlation, and −1 indicating perfect negative correlation.
If there are ties, i.e., pi = pj or qi = qj for some i (cid:54)= j,
the denominator n(n − 1) must be adjusted to keep the full
range between −1 to 1; we refer the reader to an appropriate
Statistics textbook for details.
Figure 8 shows the pairwise tagged domain Kendall rank
correlation coeﬃcient between all feed pairs.
Figures 7 and 8 show how well
Pairwise comparison.
each pair of feeds agree in domain volume and rank. (The
Mail column will be described shortly.) Qualitatively, both
variation distance and Kendall rank correlation coeﬃcient
show similar results. The MX honeypot feeds and the Ac1
honey account feeds exhibit similar domain distributions;
these four also have many domains in common as seen in
Figure 2.
The Bot feed brings a small number of domains, many
of which also occur in the MX honeypot feeds and the Ac1
feed (Figure 2). The volume of these domains, however, is
signiﬁcant; so much so, that in terms of domain proportions,
the mx3 feed is more like the Bot feed than any other feed,
including the remaining MX honeypots.
The similarity in coverage and empirical domain probabil-
ity distributions indicates that, roughly speaking, one MX
honeypot feed is as good as another. By their nature, MX
honeypots are targets of high-volume spammers who spam
BotHybAc2Ac1MX3MX2MX1URIBLDBLHu01234567Total revenue (in millions USD)BotAc2Ac1MX3MX2MX1MailBotAc2Ac1MX3MX2MX1Mail0100.680.9700.410.600.560.960.380.4200.630.970.40.490.1900.80.930.750.790.730.780436Figure 8: Pairwise Kendall rank correlation coef-
ﬁcient of tagged domain frequency across all feed
pairs.
Figure 9: Relative ﬁrst appearance time of domains
in each feed. Campaign start time calculated from
all feeds except Bot. Solid lines are medians; boxes
range from the 25th to the 75th percentile.
randomly-generated names at all registered domains. By this
process, it is just as easy to stumble upon one MX honeypot
as another.
Comparison to real mail.
In Section 4.2.2 we reported
on the fraction of incoming spam—as seen by a major Web
mail provider—covered by each feed. Here we use the same
incoming mail oracle to determine the real-world relative
volumes of spam domains, and compare those numbers to
the relative domain volumes reported by each feed. We use
only tagged domains appearing in at least one spam feed in
the comparison: in the calculation of δ and τ , we set pi = 0
for any domain i not appearing in the union of all spam
feeds.
The Mail column in Figures 7 and 8 shows these results.
The mx2 feed comes closest to approximating the domain
volume distribution of live mail, with Ac1 coming close be-
hind. As with coverage, the Ac2 feed stands out as being
most unlike the rest.
4.4 Timing
For both sides of the spam conﬂict, time is of the essence.
For a spammer, the clock starts ticking as soon as a domain
is advertised. It is only a matter of time before the domain
is blacklisted, drastically reducing the deliverability of spam.
While a domain is still clean, the spammer must maximize
the number of messages delivered to potential customers. On
the other side, blacklist maintainers strive to identify and
blacklist spam domains as quickly as possible to maximize
the volume of spam captured.
In this section we consider how well each spam feed cap-
tures the timing of spam campaigns. Speciﬁcally, we identify
how quickly each feed lists spam domains, and, for feeds
driven by live mail, how accurately they identify the end
of a spam campaign. Unless noted otherwise, we restrict
our analysis to tagged domains because we have the most
conﬁdence in their provenance.
Ideally, we would like to compare the time a domain ﬁrst
appears in spam with the time it ﬁrst appears in a spam feed.
Lacking such perfect knowledge about the start of each spam
campaign, we instead take the earliest appearance time of a
domain across all feeds as the campaign start time, and the
last appearance time of a domain in live mail-based feeds
as the campaign end time. For this analysis, we exclude the
Bot feed because its domains have little overlap with the
other feeds. As a result, including them greatly diminishes
the number of domains that appear in the intersection of
the feeds, and hence the number of domains that we can
consider.
Taking the campaign start time and end time as described
above, we deﬁne the relative ﬁrst appearance time for a
domain in a particular feed to the time between campaign
start and its ﬁrst appearance in the feed. In other words,
we take campaign start time as “time zero” and calculate
the relative ﬁrst appearance time relative to this time. Put
another way, the relative ﬁrst appearance time is thus the
latency of a feed with respect to a domain.
4.4.1 First Appearance Time
Figure 9 shows the distribution of relative ﬁrst appearance
times of domains in each feed. The bottom of the box
corresponds to the 25th percentile, the top denotes the 75th
percentile, and the solid bar inside the box denotes the
median.
Both Hu and dbl are excellent early warnings of spam
campaigns since they see most domains soon after they are
used. The Hu feed sees over 75% of the domains within a
day after they appear in any feed, and 95% within three
days; dbl is delayed even less, with over 95% appearing
on the blacklist within a day. Once again, the nature of
these feeds lends themselves to observing wide-spread spam
activity quickly: Hu has an enormous net for capturing spam,
while dbl combines domain information from many sources.
In contrast, the other feeds have much later ﬁrst appearance
times: they do not see roughly half of the domains until two
days have passed, 75% until after four days, and 95% after
ten. Operationally, by the time many of the domains appear
in these feeds, spammers have already had multiple days to
monetize their campaigns.
Of course, these results depend on both the set of domains
that we consider and the sets of feeds we use to deﬁne
campaign start times. When performing the same analysis
on the larger set of live domains that appear in the same set
of feeds, the ﬁrst appearance times remain very similar to
Figure 9: even for the broader set of domains, Hu and dbl
see the domains multiple days earlier than the other feeds.
However, changing the set of feeds we consider does change
relative ﬁrst appearance times. Figure 10 shows similar
BotAc2Ac1MX3MX2MX1MailBotAc2Ac1MX3MX2MX1Mail10.110.02−0.110.1−0.30.410.20.040.50.710.20.060.50.50.71−0.2−0.0090.080.10.070.021HybAc2Ac1MX3MX2MX1URIBLDBLHu012345Days437Figure 10: Relative ﬁrst appearance time of domains
in each feed. Campaign start time calculated from
MX honeypot and honey account feeds only. Solid
lines are medians; boxes range from the 25th to the
75th percentile.
Figure 12: Distribution of diﬀerences between do-
main lifetime estimated using each feed and the do-
main campaign duration computed from an aggre-
gate of those same ﬁve feeds. Solid lines are medians;
boxes range from the 25th to the 75th percentile.
likely corresponds to when a spammer stopped sending mes-
sages using the domain: the MX honeypots and honeypot
account feeds. Feeds like Hu, Hyb, and the blacklists all have
domains reported by users. Since user reports fundamentally
depend on when users read their mail and report spam, they
may report spam long after a spammer has sent it.
Consistent with the ﬁrst appearance times for the honeypot
feeds, the feeds are similar to each other for last appearance
times as well. The diﬀerence with the baseline are rela-
tively short (a day or less), but have longer tails (the 95th
percentiles for most are over a week).
4.4.3 Duration
Another common metric for spam campaigns is their du-
ration: how long spammers advertise domains to attract
customers. Figure 12 shows the diﬀerences in time dura-
tions of domains advertised in spam as observed by each
feed relative to estimated campaign duration (campaign end
time minus campaign start time). For each feed we calculate
the lifetime of a domain in the feed using the ﬁrst and last
appearance of a domain just in that feed. Then we compute
the diﬀerence between the domain lifetime in a feed and
the estimated campaign duration. (Campaign duration is
computed from the same ﬁve feeds and is always at least as
long as the domain lifetime in any feed.) The box plots in
the graph summarize the distributions of these diﬀerences
across all domains in each feed.
The diﬀerences in duration estimates for the honeypot
feeds are also consistent with their ﬁrst and last appearance
time estimates. The duration estimates across feeds are
similar to each other, the duration estimates diﬀer from
the baseline by less than a day for half of the domains and
roughly a day for 75% of the domains. The distribution tails
are longer, though, with outliers underestimating durations
by multiple weeks.
5. CONCLUSION
Most measurement studies focus on using data to infer new
facts about the world. This goal is why we measure things—
to put truth on an empirical footing. However, occasionally
Figure 11: Distribution of diﬀerences between the