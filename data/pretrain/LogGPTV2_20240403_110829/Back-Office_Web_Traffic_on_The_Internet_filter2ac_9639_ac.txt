Along with the methodology previously described, we also ex-
ploit a list of servers provided to us from a large CDN. Henceforth,
we distinguish three different classiﬁcations of IP addresses, IPs-
CDN, IPs-DPI, and IPs-ZMap, based on our conﬁdence in their
accuracy. We are most conﬁdent in the accuracy of the classiﬁ-
cations of the CDN addresses. Based on the DPI performed on a
trace, we can also be very sure that an IP at that point in time was
used in the identiﬁed fashion. The ZMap data set comes with the
largest degree of uncertainty, but covers a wide range of IPs. Note
that the same IP address may appear in more than one of these sets
of classiﬁcations.
4.3 IP activity
Figure 3(a) shows a scatter plot for all IPs seen in the L-IXP
trace, where we plot each IP according to the number of sampled
Web requests it sent vs. received on a log-log scale. This plot high-
lights the different classes of IPs. The server-only IPs only receive
requests and are scattered along the y-axis. The client-only IPs are
scattered along the x-axis. The dual-role IPs are scattered across
both axes. While the IPs with signiﬁcant activity in both roles are
likely to be intermediaries/proxies, we ﬁrst take a closer look at
some of the other heavy-hitters, i.e., those that only act as clients.
Figure 3(b) shows the cumulative percentage of the number of
sampled GET and POST requests issued per IP, sorted by the num-
ber of observed requests. The most striking observation from this
plot is that less than 1% of all the IPs are responsible for more
than 30% of all requests across the IXP and backbone vantage
points.
Indeed, we estimate from the sampled data that the IP
that contributes most requests at the L-IXP contributes more than
5M requests per hour on average, while at BBone-2 this number
is roughly 310K requests per hour. These are unlikely to be hu-
mans — rather this behavior points towards a crawler, a proxy, or
an auctioneer.
Accordingly, Figure 3(c) shows for each IP the number of sam-
pled requests it sent vs. the number of IPs to which these are sent,
namely the fan-out, on a log-log scale. While some of these clients
contact a huge number of servers, there are also clients that send
an enormous number of requests to a rather small set of server IPs
(bottom right). As shown in Table 3, when inspecting the types
of the requests we ﬁnd an unexpectedly large number of POST re-
Name
L-IXP
M-IXP
BBone-1
BBone-2
GETs
Total
76.36M 71.6% 11.5%
3.7%
2.65M 78.9%
5.2%
1.81M 88.3%
2.92M 58.1%
8.2%
POSTs CHellos
16.9%
17.4%
6.5%
33.7%
Table 3: Web IP activity: sampled HTTP/HTTPS requests.
quests. These can be attributed to the intensive use of protocols for
Web services (e.g., SOAP). Closer inspection shows that for clients
with an extraordinary high number of requests the fraction of POST
requests is larger when compared to clients with low numbers of re-
quests. Based on these observations, we now differentiate between
proxies, auctioneers, crawlers, and bidders.
4.4 CDNs, proxies, and other intermediaries
Typical examples of dual-behavior hosts are proxies such as those
deployed by some institutions and forward and reverse proxies such
as those operated by CDNs and content providers (CPs). How-
ever, intermediaries can, in fact, serve many other purposes. For
instance, there are many kinds of proxies in the wild that affect a
signiﬁcant number of connections [58] and which are not operated
by CDNs or CPs. In addition, intermediaries at hosting or or cloud
service provider networks may not necessarily operate for the sin-
gle purpose of request forwarding. While keeping this in mind, we
focus on identifying some of the intermediaries that are operated
by CPs or CDNs, which we hereafter refer to as Content Delivery
Proxies (CDPs).
These are the steps we follow to classify CDPs. Along with the
IPs in the IPs-CDN set, we select as potential candidates those in-
termediaries for which we sampled more than 5 requests (heavy-
hitters).3 We then check the origin AS of the corresponding subnet,
and manually inspect if the WHOIS information reveals that the
address is registered to a known CP or CDN. Since this check is
not sufﬁcient to reveal cases in which front-end servers and caches
are embedded in ISP networks and use the address space registered
to those networks, e.g., Akamai and Google Global Cache, we also
check for DNS host-names and use the techniques reported in [18,
56] to attribute IPs to content providers and CDNs.
Based on the previous manual identiﬁcation, we are able to clas-
sify among the list of intermediaries some of the front-ends of 8
well-known organizations such as Google, Akamai, Limelight or
EdgeCast. We ﬁnd more than 36K (15K) IPs in the L-IXP (M-IXP)
3Note that 5 sampled requests correspond to an estimated number
of roughly 80K requests per week for the IXP traces and to 5K
requests per week in the BBone links, respectively.
261traces. We also ﬁnd CDPs that are active on the transatlantic links
i.e., 9K and 19K for the BBone-1 and BBone-2 traces.
4.5 RTB: Auctioneers and bidders
The bidding process between auctioneers and bidders is gener-
ally done using Web services, such as Google AdExchange or Face-
book Exchange. Bidders register with the auctioneer and provide
a URI on which they accept offers from the auctioneer and reply
with their corresponding bid after a maximum time threshold, of-
ten around 100ms [1].
Thus, one of the distinguishing characteristics of auctioneers is
that they typically send their offers via POST to the potential bid-
ders. The bidders, in turn, receive a large number of POST requests
from a relatively small number of hosts (the auctioneers). This
ﬁts nicely with our earlier observation that there are many more
POST requests in today’s Internet than were observed in the past.
In particular, an examination of traces from L-IXP over the past
three years shows that the fraction of requests of type POST has in-
creased by 80% over that time. Indeed, for each user request which
involves an advertisement there may be multiple bidders contacted.
Given that the market for real-time bidding (RTB) is heavily con-
centrated among a relatively small number of players accounting
for the major share of the RTB activity [59], prime candidates for
auctioneers are IPs sending large numbers of requests to a compa-
rably small set of IPs (bidders), which in turn receive a large num-
ber of requests from a relatively small number of IPs. As bidders
can provide customized URIs to auctioneers, we cannot identify
auctioneers and bidders in a straightforward manner using payload
signatures. Instead, we identify auctioneers and bidders based on
partially available URL strings as follows: we ﬁrst obtain a list of
partial URLs sent by the heavy-hitters and select those IPs whose
HTTP requests contain in the absolute path and/or query parts of
the URL strings such as ad, bid, or rtb. Then, for each of
these IPs, we check if its corresponding subset of requests has a
ﬁxed structure, i.e., we observe many repetitions of the same par-
tial URL (only the value ﬁelds in the query part change), and we
mark these IPs as candidates for potential auctioneers. We then
manually validate that these IPs are operated by organizations of-
fering RTB services by relying on meta-information such as reverse
DNS, WHOIS, and publicly available API documentation of some
Ad exchanges. Having a list of auctioneers, we now inspect the
corresponding destination IPs, further manually verify the corre-
sponding URL strings to be bidding-related, and mark these IPs as
bidders.
With this method we are able to manually identify 316 IPs used
by auctioneers and 282 IPs used by bidders in the L-IXP trace. We
were not able to identify bidding activity in the M-IXP trace, and
also did not identify any ad exchanges co-located at M-IXP. Nor
did we ﬁnd any bidding activity in the backbone traces, perhaps
because of the high delay in transatlantic links.
4.6 Web crawlers
One of the distinguishing characteristics of Web crawlers is that
they issue many Web queries and then upload their results to the
search infrastructure. The queries constitute a large number of GET
requests sent to a diverse set of servers belonging to different orga-
nizations.
For each data set we use the heavy hitters, in terms of GET re-
quests, as candidates. Speciﬁcally, we pre-select IPs for which we
sample at least ﬁve queries and then try to verify that they are Web
crawlers as follows. It is a best common practice to make crawlers
clearly identiﬁable by setting up reverse DNS entries and including
Name
L-IXP
M-IXP
BBone-1
BBone-2
CDPs
36054
15116
9330
19890
Bidders Auctioneers Crawlers
282
0
0
0
316
0
0
0
3920
541
81
894
Other
151095
4417
1214
2669
Table 4: Back-ofﬁce: IP classiﬁcation.
an appropriate user-agent with each request.4 Thus, we search for
host-names that include indicative strings such as bot, crawl, spider
and select those that can be either automatically validated via the
user-agent or validated with a manual inspection of the correspond-
ing reverse DNS entry. scp
With this method, we identify 3920 and 541 crawlers in the L-
IXP and M-IXP traces. Surprisingly, we also ﬁnd crawlers in the
backbone traces: 81 and 894 for the BBone-1 and –respectively–
BBone-2 traces. We see activity from well-known search engines
e.g., Google, Bing, Yandex, and Baidu, as well as from smaller
search engines and research institutions. To put these numbers
into perspective, we use the ZMap reverse DNS data set (i.e., all
IPv4 PTR records) and search for host-names of crawlers belong-
ing to three major search engines, which are well-deﬁned in pub-
licly available documents provided by these engines. The percent-
age of crawler IPs for which we see activity in the L-IXP trace is
7%, 23%, and 51% for three of the major search engines.
Summary
We ﬁnd that most IPs that are part of the Web ecosystem are clients,
but there are a substantial number of Web intermediaries across the
vantage points e.g., just by inspecting the L-IXP trace with DPI, we
ﬁnd that 11% of the Web servers also act as Web clients. However,
after combining our passive data with active measurements, we dis-
cover that many of the client IPs in the traces also act as servers,
which is not visible when purely relying on passive data. As a con-
sequence, the number of IPs with dual behavior increases e.g., for
the L-IXP trace more than 50% of the server IPs exhibit also client
behavior. As shown in Table 4, after we inspect the heavy-hitter
IPs, we are able to ﬁnd activity from content delivery proxies, ad
auctioneers, ad bidders, and crawlers in the L-IXP trace, as well as
crawling and intermediary activity as seen from the other vantage
points.
5. WEB BACK OFFICE: A CLOSE LOOK
To better understand which players are involved in back-ofﬁce
services, we next take a closer look at its components in the L-IXP
trace.
Auctioneers and bidders: We identify more than 300 IPs that
are auctioneers. These IPs are operated by four different organi-
zations that offer real-time bidding: Two search engines, an online
social network, and a major Web portal. Each of these organiza-
tions operates at least one AS and the IPs are hosted in the corre-
sponding AS. With regards to the number of IPs per AS we see a
rather uneven distribution: The top one hosts 83% of the IPs. The
same holds for the distribution of the number of requests: the top
organization is involved in 55% of the bids, the others in 32%, 10%,
and 3%.
These auctioneers communicate with a rather small set of bid-
ders (282 IPs). The IXP data shows that many of the auctioneers
4See,
for example Google https://support.google.
com/webmasters/answer/80553?hl=en,
and for Mi-
crosoft Bing http://www.bing.com/webmaster/help/
how-to-verify-bingbot-3905dc26
262are co-located with the bidders (both the AS of the auctioneer and
the AS hosting the bidder are members of the IXP), with the bid-
ders residing in 42 different ASes. This conﬁrms that bidders are
following the recommendations by the auctioneers to locate their
servers close by in order to adhere to the strict deadlines of auction-
based advertisements. Bidder IPs are typically contacted from all
four identiﬁed auctioneering organizations. Thus, bidders do not
use different IPs for different auctioneers and often cooperate with
all of them. The likely motivation is that advertisers try to maxi-
mize their bidding opportunities (i.e., receiving offers from all or-
ganizations). Moreover, at ﬁrst glance the number of bidders may
appear small but this is mainly due to aggregation. Indeed, most
IPs belong to advertisement aggregators.
With regards to the ASes that host the bidders, we ﬁnd, surpris-
ingly, that a very large hosting service provider dominates with a
share of 34%. Indeed, even the remaining bidders are mainly lo-
cated in the ASes of other Web hosting providers. This ﬁnding
indicates that today’s major players in the Web ecosystem often
do not operate their own infrastructure either in terms of an AS
or in terms of a data center. They rely instead on cloud services
and Web hosting companies. The second AS with the most bidders
belongs to, surprisingly, a company that operates a search engine.
Indeed, this search engine is involved in all services: it is a search
engine, an auctioneer, and even bids on other ad-network auctions.
This ﬁnding illustrates the complexity of the advertising ecosys-
tem, where different types of business relationships exist between
organizations that offer multiple services to both advertisers and
publishers, and who may also partner with some of them.5
Crawlers: We identify more than 3K crawler IPs from 120 dif-
ferent ASes. Among the ASes, there are two hosting more than
72% of the crawler IPs. These are related to two popular Web
search engines. We also see crawlers of 3 other well-known search
engines, each with roughly 100 crawlers. Then there is a gap with
regards to the number of crawlers per AS as the remaining crawler
IPs are hosted in many different ASes. Inspecting the user agent
and the reverse DNS entries allows us to conclude that these are
mainly associated with specialized search engines.
With regards to the number of requests, the four top contribu-
tors all belong to major search engines. The top three/four account
for 94/96% of the requests. The fourth accounts for only 2% of
the requests. Even though the crawling activity is directed towards
more than 4.2K ASes, a single AS receives more than 43% of the
requests — a Web hosting provider. The second most popular AS is
another hosting provider and both are members of the IXP. Overall,
the members account for more than 80% of the received crawling
requests.
In terms of request popularity, the ﬁrst AS that is not
a member of this IXP is yet another hosting provider and receives
roughly 1% of the requests. Overall, the top crawling search engine
AS and the top receiving hosting provider AS account for more than
20% of all crawling-related requests.
Content delivery proxies: We identify more than 30K inter-
mediary IPs from 8 well-known CPs and CDNs, scattered across
hundreds of different ASes, interacting with IPs from more than
1K different ASes. The CDPs are responsible for roughly 17%
of the requests from heavy-hitter IPs. While one expects many of
the front ends to be located in ISP networks, a close inspection of
destination IPs reveals that some of the back-end servers are also
located within the ASes of ISPs, and not in the AS of the CDN. In
fact, we observe requests for the content of a major online social
network (OSN) where both source and destination IPs are operated
an example of
5For
http://ir.yandex.com/releasedetail.cfm?
releaseid=828337
such a
complex relationship see
by a major CDN, but neither of the endpoints is located within the
AS of the CDN or OSN. We also ﬁnd other more typical scenar-
ios, such as CDNs fetching content directly from OSNs and from
large-scale hosting provider ASes.
Other intermediaries: The rest of IPs in the intermediary list
(roughly 151K) are located in more than 7K ASes. They contact
399K servers in 10K different ASes. While we strongly suspect
that most of these are indeed Web proxies, we cannot be certain.
Indeed, on the one hand, one of the heavy-hitters IPs in this set
— an oddball — is hosted in an unexpected AS. This oddball IP
is serving both ad-related images to a CDN and acting as a Web
auctioneer. On the other hand, we see several organizations that use
resources from cloud services to set up their own virtual CDNs. A
close analysis of which ASes are hosting the heavy hitters shows
that most of these ASes are hosting and/or cloud service providers
(8 out of 10). There is, however, more diversity in the destination
ASes: we ﬁnd hosting providers, CPs, OSNs and CDNs. We see
that a single hosting/cloud service provider is responsible for 21%
of the requests issued by IPs in this set. This observation highlights
the importance of cloud service providers in the back ofﬁce of the