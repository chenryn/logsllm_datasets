variables that are not of particular interest (i.e., the datasets
used or different skill levels of our workers), while the ﬁxed
effects incorporate the variables that are of interest (i.e.,
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:32:40 UTC from IEEE Xplore.  Restrictions apply. 
502α
F
0.8
0.7
0.6
0.5
0.4
0.3
1
0.95
0.9
0.85
α
F
0.8
0.75
0.7
0.65
0.6
I
Clustering
+Aligment
I
Clustering
+Aligment
II
Aligment
+NoClustering
III
Clustering
+NoAlignment
(a) UNV-DNS
II
Aligment
+NoClustering
III
Clustering
+NoAlignment
IV
NoClustering
+NoAlignment
IV
NoClustering
+NoAlignment
(b) KDDCup-FTP
Figure 6. F-scores (𝛼 = 1.2) of the best workers
clustering, alignment, and the interaction between the two).
The model can be formulated as:
𝑦 = 𝛽𝑐 ⋅ 𝑥𝑐 + 𝛽𝑎 ⋅ 𝑥𝑎 + 𝛽𝑐𝑎 ⋅ 𝑥𝑐 ⋅ 𝑥𝑎 + 𝜖
(2)
where 𝑥𝑐, 𝑥𝑎 are booleans indicating whether clustering or
alignment is used, and 𝑦 is the performance measure under
consideration (i.e., F𝛼 or efﬁciency). The interaction effect
of clustering and alignment, i.e., the effect of clustering after
alignment is used, or vice versa, is expressed by the product
of 𝑥𝑐 and 𝑥𝑎 (𝑥𝑐 ⋅ 𝑥𝑎). The random effects derived from
workers and datasets are included in term 𝜖.
F-Score:
In the analysis that follows, we ﬁrst test
the null hypotheses 𝛽𝑐 = 𝛽𝑎 = 𝛽𝑐𝑎 = 0, by ﬁtting all
observations of F𝛼 of the best workers using (2), the results
of which are presented in Table II(a) with 𝛼 set to 1.2. We
consider 𝑝-value < 0.05 as the requirement for rejecting
a null hypothesis. As Table II(a) shows, F𝛼 is positively
related to the clustering, since the hypothesis 𝛽𝑐 = 0 is
rejected and the estimate of coefﬁcient 𝛽𝑐 is positive (0.217).
Similarly, the alignment signiﬁcantly increases F𝛼 by 0.197.
There is little evidence of an interaction effect 𝑥𝑐 ⋅ 𝑥𝑎 since
𝑝-value = 0.123, i.e., the hypothesis 𝛽𝑐𝑎 = 0 stands. Even
if the hypothesis had been rejected, the estimate of 𝛽𝑐𝑎 in
(a) F𝛼, 𝛼 = 1.2
Effect
𝛽𝑐
𝛽𝑎
𝛽𝑐𝑎
Estimate
0.217
0.197
−0.160
𝑝-value
0.011
0.017
0.123
(b) Efﬁciency
Effect
𝛽𝑐
𝛽𝑎
𝛽𝑐𝑎
Estimate
3.311
1.092
−2.097
𝑝-value
0.007
0.271
0.147
RESULTS OF MIXED-MODEL TESTS (SECTION IV-B3)
Table II
Table II(a) is smaller (in absolute value) than both 𝛽𝑐 and
𝛽𝑎, suggesting that there is an additive effect of these two
factors in improving F𝛼.
𝑡
Efﬁciency: Yet another important consideration is how
clustering and alignment inﬂuence efﬁciency; that is, do
they impede or advance a worker’s ability to complete the
∣{identiﬁed ﬁelds}∣
,
task at hand? Let “efﬁciency” be deﬁned as
where 𝑡 represents the total time to completion in each trial.
Table II(b) shows the results for a similar hypothesis test for
efﬁciency. The estimate for the clustering term, 3.311, shows
that there is a strong, statistically signiﬁcant, correlation
between efﬁciency and clustering. Although no statistically
signiﬁcant effect of the alignment or the interaction term
is found (𝑝-values of 0.271 for 𝛽𝑎 and 0.147 for 𝛽𝑐𝑎), our
tests still indicate that a user’s efﬁciency beneﬁts from both
clustering and alignment together, due to the strong positive
inﬂuence of the clustering.
V. DISCUSSION
The fact that our methodology yielded recall of 0.9 and
even better precision for the UNV-DNS dataset (see Table I)
is, we believe, a very encouraging result, particularly con-
sidering the complexity of the DNS protocol. We note that
it might be tempting to argue that the results herein could be
improved by permitting workers more time to mark packets;
recall that each trial lasted roughly 30 minutes. We believe,
however, that permitting more time would yield diminishing
returns. Our perception was that packet inspection was a
tiresome process for the workers, an observation supported
by the fact that none of our participants chose to continue a
trial past 30 minutes, though they were given the opportunity
to do so. We thus expect that additional innovations will be
required to assist workers in identifying sensitive ﬁelds more
accurately; it is not clear that more time will help.
We note that our methodology provides a framework only
for identifying sensitive ﬁelds in packets. Once applied,
additional steps must be taken to anonymize those ﬁelds
using whatever policies the data publisher desires, e.g.,
consistently mapping sensitive values to others in a one-way
fashion, and perhaps in ways that preserve certain structures
(such as a preﬁx-preserving mapping of IP addresses).
Lastly, a natural question is whether the workers’ F-scores
were “good enough” to provide a basis for sanitizing the full
datasets. Answering this question depends ultimately on the
data owner’s goals for sanitization, which are notoriously
difﬁcult to specify or measure [6]. Nevertheless, to provide
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:32:40 UTC from IEEE Xplore.  Restrictions apply. 
503a degree of insight, we performed a cursory evaluation of the
ability of an adversary to infer the contents of sanitized ﬁelds
by comparing packets after sanitization to the packets in the
original dataset, before sanitization. The details can be found
in our accompanying technical report [13] that suggests, in
short, that the aforementioned approach works well when
applied to trace sanitization.
VI. CONCLUSION
In this paper we presented a methodology for supporting
the daunting task of sanitizing network packet payloads.
Our approach is inspired by studies in cognitive science
that suggests perceptual grouping of similar patterns can
accelerate visual detection. The need for involving humans
during the sanitization process is motivated by the com-
plexity of many of today’s protocols, and is compounded
by the possibility that such protocols may be incompletely
documented. However, due to the sheer number of diverse
packet formats and the size of a typical network trace, it
is unrealistic to expect that an expert will have the time
available to accurately sanitize them all. For this reason,
our methodology adopts a hierarchical approach in which an
expert’s input on a small subset of packets is used to select
additional workers to examine a larger subset. These selected
workers’ markings are then used to mark sensitive ﬁelds in
the (typically much) larger dataset in an automated fashion.
At the heart of our methodology is an approach for selecting
from the dataset relatively few representative packets for
workers to inspect, and presenting these representatives to
workers in a way that helps them identify sensitive ﬁelds.
Our evaluation demonstrated the factors that inﬂuence the
effectiveness of our methodology, and showed through a user
study that our methodology can be effective in supporting
sanitization of large network datasets.
Acknowledgements: We thank the participants in our
user study and the anonymous reviewers. Thanks also to Ni
Zhao for valuable discussions on statistical analysis for the
user study. This work was supported by the U.S. Department
of Homeland Security Science & Technology Directorate
under Contract No. FA8750-08-2-0147.
REFERENCES
[1] T. Avraham and M. Lindenbaum. Dynamic visual
search using inner-scene similarity: Algorithms and
inherent limitations. In European Conf. on Computer
Vision, 2004.
[2] M. Barros, J. Shiau, C. Shang, K. Gidewall, H. Shi,
and J. Forsmann. Web services wind tunnel: On
performance testing large-scale stateful web services.
In IEEE/IFIP International Conference on Dependable
Systems and Networks (DSN), 2007.
[3] M. Beddoe. The protocol
informatics project.
In
Toorcon, 2004.
[4] J. Chen. Visual inquiry of spatio-temporal multivariate
patterns. In IEEE Sym. on Visual Analytics Science and
Technology, 2006.
[5] W. G. Cochran. Sampling Techniques.
John Wiley
Sons, Inc., New York, NY, 1977.
[6] S. Coull, F. Monrose, M. K. Reiter, and M. Bailey. The
challenges of effectively anonymizing network data. In
Cybersecurity Applications and Technology Conference
for Homeland Security, pages 230 – 236, 2009.
[7] W. Cui, J. Kannan, and H. Wang. Discoverer: Au-
tomatic protocol reverse engineering from network
traces. In USENIX Security, pages 199–212, 2007.
[8] C. Dai, G. Ghinita, E. Bertino, J.-W. Byun, and N. Li.
TIAMAT: a tool for interactive analysis of microdata
anonymization techniques. In International Conference
on Very Large Data Bases (demo track), 2009.
[9] J. Duncan and G. Humphreys. Visual search and
stimulus similarity. Psych. Review, 96:433–458, 1989.
[10] J. Fan, J. Xu, M. H. Ammar, and S. Moon. Preﬁx-
preserving IP address anonymization. Computer. Net-
works, 46(2):253 – 272, 2004.
[11] M. Foukarakis, D. Antoniades, and M. Polychronakis.
Deep packet anonymization. In European Workshop on
System Security, pages 16–21, Mar. 2009.
[12] T. Gamer, C. Mayer, M. Scholler, T. Gamer, and
PktAnon: A Generic Framework for
C. Sciences.
Proﬁle-based Trafﬁc Anonymization. PIK Praxis der
Informationsverarbeitung und Kommunikation, 2:76–
81, 2008.
[13] X. Huang, F. Monrose, and M. K. Reiter. Amplifying
limited expert input to sanitize large network traces.
Technical Report 11-001, Dept. of Computer Science,
University of North Carolina at Chapel Hill, 2011.
[14] N. Jones and P. Pevzner. An Introduction to Bioinfor-
matics Algorithms. MIT Press, 2004.
[15] L. Kaufman and P. Rousseeuw. Finding Groups in
Data. An Introduction to Cluster Analysis. Wiley,
Chichester, 1990.
[16] D. Koukis, S. Antonatos, D. Antoniades, E. P.
Markatos, and P. Trimintzios. A generic anonymization
framework for network trafﬁc. In IEEE International
Conference on Communications, 2006.
[17] G. Kuenning and E. L. Miller. Anonymization tech-
niques for URLs and ﬁlenames. TR UCSC-CRL-03-
05, University of California at Santa Cruz, Sept. 2003.
[18] N. Laird and J. Ware. Random-effects models for
longitudinal data. Biometrics, 38:963–974, 1982.
[19] C. Leita, K. Mermoud, and M. Dacier. ScriptGen:
In
An automated script generation tool for Honeyd.
Computer Security Applications Conf., Dec. 2005.
[20] Z. Lin, X. Jiang, D. Xu, and X. Zhang. Automatic
protocol format reverse engineering through context-
aware monitored execution. In Network & Distributed
System Security Symposium, Feb. 2008.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:32:40 UTC from IEEE Xplore.  Restrictions apply. 
504[21] J. McHugh. Testing intrusion detection systems: A
critique of the 1998 and 1998 DARPA intrusion de-
tection system evaluations as performed by Lincoln
Laboratory. ACM Transactions on Information and
Systems Security, 3(4), 2000.
[22] S. Needleman and C. Wunsch. A general method
applicable to the search for similarities in the amino
acid sequence of two proteins. Journal of Molecular
Biology, 48(3):443–453, 1970.
[23] J. Neyman. On two different aspects of the represen-
tative method: The method of stratiﬁed sampling and
the method of purposive selection. J. Royal Stat. Soc.
B., 97:558–606, 1934.
[24] F. Pan, W. Wang, A. Tung, and J. Yang. Finding repre-
sentative set from massive data. In IEEE International
Conference on Data Mining, 2005.
[25] R. Pang, M. Allman, V. Paxson, and J. Lee. The devil
and packet trace anonymization. SIGCOMM Comput.
Commun. Rev., 36(1):29–38, 2006.
[26] R. Pang and V. Paxson. A high-level programming
environment for packet trace anonymization and trans-
formation. In ACM SIGCOMM, pages 339–351, 2003.
[27] J. Ponce, M. Loebl, and L. Kencl. Packet content
In IEEE Infocom
anonymization by hiding words.
(Demo), 2006.
[28] R. C. Prim.
Shortest connection networks and
some generalizations. Bell System Technical Journal,
36:1389–1401, 1957.
[29] C. J. V. Rijsbergen.
Information Retrieval(2nd ed.).
Figure 7. An example GUI for identifying potentially sensitive data
The two sub-panels display the raw bytes of the packet
currently in focus (i.e., that the worker last clicked); one
sub-panel shows hexadecimal format, and the other shows
printable ASCII. The raw bytes for the token on which the
worker actually clicked are highlighted in each of these sub-
panels. The two sub-panels allow the worker to focus on one
particular token and to view it in different formats.
Through the ﬂexible marking facilities provided by the
tool, a worker can interactively mark the tokens of the
representatives she considers sensitive. Figure 7 shows an
example of the sensitive ﬁelds identiﬁed (in red) by a
particular user while using our graphical interface.
Butterworth, London, UK, 1979.
[30] B. Shneiderman. The eyes have it: A task by data type
taxonomy of information visualizations. In IEEE Symp.
on Visual Languages, pages 336 – 343, 1996.
[31] A. Slagell, K. Lakkaraju, and K. Luo. FLAIM: A
multi-level anonymization framework for computer and
network logs.
In USENIX Large Installation System
Administration Conference, pages 63–77, 2006.
[32] K. Wang, G. Cretu, and S. J. Stolfo. Anomalous
payload-based worm detection and signature genera-
tion. In International Symposium on Recent Advances
in Intrusion Detection, 2005.
[33] X. Xiao, G. Wang, and J. Gehrke.
Interactive
anonymization of sensitive data. In SIGMOD Confer-
ence (Demo track), pages 1051–1054, 2009.
APPENDIX
In what follows, we brieﬂy describe our prototype graph-
ical user interface (GUI) used in the user study described in
Section IV-B. The GUI (shown in Figure 7) is composed
of one main panel and two sub-panels. The main panel is
used to display the representative packets from one cluster.
Each row corresponds to one representative and each column
corresponds to one token in the tokenization of the packet,
after alignment with the other packets in its cluster.
Authorized licensed use limited to: Tsinghua University. Downloaded on March 18,2021 at 14:32:40 UTC from IEEE Xplore.  Restrictions apply. 
505