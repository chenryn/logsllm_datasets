作；还有本书的责编晓菲，她为本书的编辑和校对做了大量细致而深人的工作。
另外我还要感谢东北师范大学文学院的王确老师，在我求学期间，王老师给予我诸多指点，
离校时间愈长，愈是怀念和庆幸那段经历，可以说，没有与他的相识，便没有我的今天。
翻译过程中，我虽力求把握原文，语言通畅，但翻译中的错误或许是在所难免的，对此本
人愿负全部责任。希望广大读者发现错误能及时与我和出版社联系以便重印时修正，或是
以勘误的形式公布出来以惠及其他读者。如果读者有任何想法或建议，欢迎给我写信，我
的邮件地址是：PI:EMAIL。
如今正则表达式已经成为几乎所有主流编程语言中的必备元素：Java、Perl、Python、PHP、
Ruby.…...莫不如此，甚至功能稍强大一些的文本编辑工具，都支持正则表达式。尤其是在
Web兴起之后，开发任务中的一大部分甚至全部，都是对字符串的处理。相比简单的字符
串比较、查找、替换，正则表达式提供了强大得多的处理能力（最重要的是，它能够处理
“符合某种抽象模式”的字符串，而不是固化的、具体的字符串）。熟练运用它们，能够节
本书是讲解正则表达式的经典之作。其他介绍正则表达式的资料，往往局限于具体的语法
和函数的讲解，于语法细节处着墨太多，忽略了正则表达式本身。这样，读者虽然对关于
正则表达式的具体规定有所了解，但终究是只见树木不见森林，遇上复杂的情况，往往束
regularexpression）”，向读者讲授正则表达式的精髓（正则表达式的各种流派、匹配原理、
优化原则，等等），而不拘泥于具体的规定和形式。了解这些精髓，再辅以具体操作的文档，
---
## Page 10
译者序
Xi
读者便可做到“胸中有丘整，下笔如有神”，即便问题无法以正则表达式来解决，读者也能
很快作出判断，而不必盲目尝试，徒费工夫。
不了解正则表达式的读者，可循序渐进，依次阅读各章，即使之前完全未接触过正则表达
式，读过前两章，也能在心中描绘出概略的图谱。第3、4、5、6章是本书的重点，也是核
心价值所在，它们分别介绍了正则表达式的特性和流派、匹配原理、实用诀窍以及调校措
施。这样的知识与具体语言无关，适用于儿乎所有的语言和工具（当然，如果使用DFA引
擎，第6章的价值要打些折扣），所谓“大象无形”，便是如此。读者如能仔细研读，悉心
揣摩，之后解决各种问题时，必定获益匪浅。第7、8、9、10章分别讲解了Perl、Java、.NET、
PHP中正则表达式的用法，看来类似参考手册，其实是对前面4章知识的包装，将抽象的
知识辅以具体的语言规定，以具体的形式表现出来。所以，心急的读者，在阅读这些章节
之前，最好先通读第3、4、5、6章，以便更好地理解其中的逻辑和思路。
相信仔细阅读完本书的读者，定会有登堂入室的感觉。不但能见识到正则表达式各种令人
眼花缭乱的特性，更能够深人了解表达式、匹配、引擎背后的原理，从而写出复杂、神奇
而又高效的正则表达式，快速地解决工作中的各种问题。
余晟
2007年6月于北京
---
## Page 11
前言
Preface
本书关注的是一种强大的工具一“正则表达式”。它将教会读者如何使用正则表达式解决
各种问题，以及如何充分使用支持正则表达式的工具和语言。许多关于正则表达式的文档
都没有介绍这种工具的能力，而本书的目的正是让读者“精通”正则表达式。
许多种工具都支持正则表达式（文本编辑器、文字处理软件、系统工具、数据库引擎，等
等），不过，要想充分挖掘正则表达式的能力，还是应当将它作为编程语言的一部分。例如
Java、JScript、Visual Basic、VBScript、JavaScript、ECMAScript、C、C++、C#、elisp、Perl、
Python、Tcl、Ruby、PHP、sed和awk。事实上，在一些用上述语言编写的程序中，正则表
达式扮演了极其重要的角色。
正则表达式能够得到众多语言和工具的支持是有原因的：它们极其有用。从较低的层面上
来说，正则表达式描述的是一串文本（achunkoftext）的特征。读者可以用它来验证用户
输人的数据，或者也可以用它来检索大量的文本。从较高的层面上来说，正则表达式容许
用户掌控他们自己的数据一控制这些数据，让它们为自己服务。掌握正则表达式，就是
掌握自己的数据。
本书的价值
The Need for This Book
本书的第1版写于1996年，以满足当时存在的需求。那时还没有关于正则表达式的详尽文
档、所以它的大部分能力还没有被发掘出来。正则表达式文档倒是存在，但它们都立足于
“低层次视角”。我认为，那种情况就好像是教些人英文字母，然后就指望他们会说话。
---
## Page 12
前言
第2版与第1版间隔了五年半的时间，这期间，互联网迅速流行起来，正则表达式的形式
也有了极大的扩张，这或许并不是巧合。几乎所有工具软件和程序语言支持的正则表达式
也变得更加强大和易于使用。Perl、Python、Tcl、Java和VisualBasic都提供了薪的正则支
持。新出现的支持内建正则表达式的语言，例如PHP、Ruby、C#，也已经发展壮大，流行
并来。在这段时间里，本书的核心一一如何真正理解正则表达式，以及如何使用正则表达
式一一仍然保持着它的重要性和参考价值。
不过，第1版已经逐渐脱离了时代，必须加以修订，才能适应薪的语言和特性，也才能对
应正则表达式在互联网世界中越来越重要的地位。第2版出版于2002年，这一年的里程碑
是java.util.regex、Microsoft.NETFramework和Perl5.8的诞生。第2版全面覆盖了这
些内容。关于第2版，我唯一的遗憾就是，它没有提及PHP。自第2版诞生以来的4年里，
PHP的重要性一直在增加，所以，弥补这一缺憾是非常迫切的。
第3版在前面的章节中增加了PHP的相关内容，并专门为理解和应用PHP的正则表达式
增加了一章全新的内容。另外，该版对Java的章节也进行了修订，做了可观的扩充，反映
了Javal.5和Javal.6的新特性。
目标读者
IntendedAindience
任何有机会使用正则表达式的人，都会对本书感兴趣。如果您还不了解正则表达式能提供
的强大功能，这本书展示的全新世界将会让您受益匪浅。即使您认为自己已经是掌握正则
表达式的高手了，这本书也能够深化您的认识。第1版面世后，我时常会收到读者的电子
邮件反映说“读这本书之前，我以为自己了解正则表达式，但现在我才真正了解”。
以与文本打交道为工作（如Web开发）的程序员将会发现，这本书绝对称得上是座金矿，
因为其中蕴藏了各种细节、暗示、讲解，以及能够立刻投入到实用中的知识。在其他任何
地方都难以找到这样丰富的细节。
正则表达式是一种思想一一各种工具以各种方式（数目远远超过本书的列举）来实现它。
如果读者理解了正则表达式的基本思想，掌握某种特殊的实现就是易如反掌的事情。本书
关注的就是这种思想，所以其中的许多知识并不受例子中所用的工具软件和语言的束缚。
---
## Page 13
前言
如何阅读
Hou fo Rend Tlhis Boo
这本书既是教程，又是参考手册，还可以当故事看，这取决于读者的阅读方式。熟悉正则
表达式的读者可能会觉得，这本书马上就能当作一本详细的参考手册，读者可以直接跳到
自己需要的章节。不过，我并不鼓励这样做。
要想充分利用这本书，可以把前6章作为故事来读。我发现，某些思维习惯和思维方式的
几张列表。
故事是这样的，前6章是后面4章——包括Perl、Java、.NET和PHP—的基础。为了帮
助读者理解每一部分，我交叉使用各章的知识，为了提供尽可能方便的索引1，我投入了大
量的精力（全书中有超过1200处交叉引用，它们以符号加页码的形式标注）。
在读完整个故事以前，最好不要把本书作为参考手册。在开始阅读之前，读者可以参考其
中的表格，例如第92页的图表，想象它代表了需要掌握的相关信息。但是，还有大量背景
信息没有包含在图表中，而是隐藏在故事里。读者阅读完整个故事之后，会对这些问题有
个清晰的概念，哪些能够记起来，哪些需要温习。
组织结构
Organization
全书共10章，可以从逻辑上粗略地分为三类，下面是总体概览：
第1章：介绍正则表达式的基本概念。
第2章：考察利用正则表达式进行文本处理的过程。
第3章：提供对于特性和工具软件的概述以及简史。
细节
第4章：揭示了正则表达式的工作原理的细节。
第5章：利用第4章的知识，继续学习各种例子。
第6章：详细讨论效率问题。
特定工具的知识
第7章：详细讲解Perl的正则表达式。
第8章：讲解Sun提供的java.util.regex包。
第9章：讲解.NET的语言中立的正则表达式包。
第10章：讲解PHP中提供正则功能的preg套件。
---
## Page 14
V
前言
导引部分会把完全的门外汉变成“对问题有感觉”的新手。对正则表达式有一定经验的读
者完全可以快速翻阅这些章节，不过，即使是对于相当有经验的读者来说，我仍然要特别
推荐第3章。
·第1章正则表达式入门．是为完全的门外汉准备的。我以应用相当广泛的程序egrep
为例来介绍正则表达式，我也提供了我的视角：如何“理解”正则表达式，来为后面
章节所包括的高级概念打下坚实的基础。即使是有经验的读者，浏览本章也会有所收
获。
第2章入门示例拓展，考察了支持正则表达式的程序设计语言的真实文本处理过程。
附加的示例提供了后面章节详细讨论的基础，也展示了高级正则表达式调校背后的重
要思考过程。为了让读者学会“正则表达式的套路”，这章出现了一个复杂问题，并讲
解了两种全然不相关的工具如何分别通过正则表达式来解决它。
第3章正则表达式的特性和流派概览，提供了当前经常使用的工具的多种正则表达式
的概览。因为历史的混乱，当前常用的正则表达式的类型可能差异巨大。此章同时介
绍了正则表达式以及使用正则表达式的工具的历史和演化历程。本章末尾也提供了“高
级话题引导”。此引导是读者学习此后高级内容的路线图。
细节
The Details
了解了基础知识之后，读者需要弄明白“如何使用”及“这么做的原因”。就像“授人以渔”
的典故一样，真正懂得正则表达式的读者，能够在任何时间、任何地点应用关于它的知识。
·第4章表达式的匹配原理，循序渐进地导人本书的核心。它从实践的角度出发，考察
了正则引擎真实工作的重要的内在机制。懂得正则表达式如何处理工作细节，对读者
掌握它们大有神益。
第5章正则表达式实用技巧，教育读者在高层次和实际的运用中应用知识。这一章会
详细讲解常见（但复杂）的问题，目的在于拓展和深化读者对于正则表达式的认识。
---
## Page 15
前言
V
第6章打造高效正则表达式，考察真实生活中大多数程序设计语言提供的正则表达式
的高效结果。本章运用第4章和第5章详细讲解的知识，来开发引擎的能力，并避免
其中的缺陷。
特定工具的知识
Tool-SpecificInformation
学习完第4、5、6章的读者，不太需要知道特定的实现。不过，我还是用了4个整章来讲
解4种流行的语言。
·第7章Perl，详细讲解了Perl的正则表达式，Perl大概是目前最流行的主要的正则表
达式编程语言。在Perl中，与正则表达式相关的操作符只有四个，但它们组合出的选
项和特殊情形带来了大量的程序选项一一同时还有陷阱。对没有经验的开发人员来说，
这种极其丰富的选项能够让他们迅速从概念转向程序，当然也可能是雷场。本章的详
细介绍有助于给读者指出一条光明大道。
第8章Java，详细介绍了java.uti1.regex包，从Java1.4以后，它已经成为了Java
语言的标准部分。本章主要关注的是Java1.5，但也提及了它与Java1.4.2和Java1.6
的差别。
第9章.NET，是微软尚未提供的.NET正则表达式库的文档。无论使用VB.NET、C#、
C++、JScript、VBScript、ECMAScript还是使用.NET组件的其他语言，本章都提供了
详细内容，让读者能够充分利用.NET的正则表达式。
第10章PHP，简要介绍了PHP内嵌的多个正则引擎，并详细介绍了preg正则表达式
套件（regexengine）的类型和API，这些是由PCRE正则表达式库提供的。
体例说明
TypograplicalConventions
在进行（或者谈论）详细的和复杂的文本处理时，保持精确性是很重要的。差一个空格字
符，可能导致截然不同的结果，所以我会在本书中使用下面的惯例：
表达式文字（例如用来检索的表达式）以‘this’的形式出现。有时候，省略两端的
符号和单引号也不会造成歧义，此时我会省略它们。同样，屏幕截图通常以原来的样
子出现，而不会用到上面两种符号。
---
## Page 16
VI
前言
在文字文本和表达式内部的省略号会被特别标出。例如，[]表示一对方括号，之间
的内容无关紧要，而[1表示一对方括号，其中包含三个句点。
如果没有明确数字，可能很难判断“ab”之间有多少空格，所以出现在正则表达式
和文字文本中的空格以“”表示。这样“ab”就清楚多了。
我使用可见的制表符，换行符和回车字符：
空格宇符
国
制表符
换行符
国
回年宇舟
有时候，我会使用下画线或有色背景高亮标注文字文本或正则表达式的一部分。下面
这句话中，下画线的部分表示表达式真正匹配的部分：
werealize...
这个例子中，下画线的部分高亮标记了表达式中添加的字符：
To make this useful, we can wrap‘SubjectIDate) with parentheses,and append a
colon and a space.This yields‘(Subject |Date)
·本书包含了大量的细节和例子，所以我设置了超过1200处的交叉引用，帮助读者理
解。它们通常表示为“123”，意思是“请参阅第123页”。举个例子：“的说明在
表8-2中（367）”。
练习
E.xercises
有时候我会问个问题，帮助读者理解正在讲解的概念，尤其是在前几章这种问题更多。它
们并不是摆设，我希望读者在继续阅读之前认真想想。请记住我的话，不要忽略它们的重
要意义，本书中这样的问题并不多。它们可以当作自我测试题：如果不是几句话就能说明
白的问题，最好是在复习相关章节之后再继续阅读。
为了避免读者直接看到问题的答案，我使用了一点技巧：向题的答案都必须翻页才能看到。
通常你必须翻过一页才能看到标着的答案。这样答案在你思考问题的时候没法直接看到，
但又很容易获得。
---
## Page 17
前言
VII
链接、代码、勘误及联系方式
Links, Coie Frrata, and Contacts
写第1版时，我发现修改书本上的URL，保持与实际一致是件很费工夫的事情，所以，我
没有在书后罗列一个URL附录，而是提供统一的地址：
http://regex.info
在这里你可以找到与正则表达式相关的链接，书中的所有代码，可检索的索引以及其他资
源。本书也可能存在错误，所以我提供了勘误。
如果你找到书中的错误，或者仅仅是希望给我写几句话，请写邮件到：PI:EMAIL。
我们已尽力核验本书所提供的信息，尽管如此，仍不能保证本书完全没有瑕疵，而网络世
界的变化之快，也使得本书永不过时的保证成为不可能。如果读者发现本书内容上的错误，
不管是费字、错字、语意不清，甚至是技术错误，我们都竭诚虚心接受读者指教。如果您
有任何问题，请按照以下的联系方式与我们联系。
奥莱理软件（北京）有限公司
北京市海淀区知春路49号希格玛公寓B座809室