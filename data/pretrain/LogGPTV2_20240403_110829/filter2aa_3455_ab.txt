glass, by requesting an ICMP echo request to one pub-
lic IP address under our control. We then looked for
IP addresses publicly exposing an admin service (telnet
or SSH). We performed this test by checking for pub-
licly routable loopbacks or services listening on rout-
ing interfaces. These actions were easy to automate, as
4
Looking glass
Number of ASes
Custom/Unknown
515
Unreachable
184
Cougar-LG
175
Cistron-LG
15
MRLG4PHP
12
MRLG
11
Telephone
7
Table 2: Looking-glass software deployments.
none of the open-source looking-glass software employ
CAPTCHAs.
At the end of our experiments, we identiﬁed a subset
of vulnerable ASes, for which an attacker could be capa-
ble of directly injecting commands on the router or could
be able to recover the credentials required to remotely log
in in a publicly accessible interface.
We then correlated this list of ASes with histori-
cal records of BGP announces collected by RIPE RIS
through several probes and peers, all over the world. The
results suggest that by compromising some of these ASes
it would probably be possible for an attacker to announce
routes that would not be properly ﬁltered by neighbour-
ing ASes.
We acknowledge that this methodology may result in
several false-negatives (URLs not in the original list,
unavailable at the time of the experiment, or missed
while ﬁngerprinting) and few false-positives (updated
and well-conﬁgured routers with proper ACL).
For the former, one could repeat the experiments in the
future to compare the results. Unfortunately, it is impos-
sible to remove the false positives without performing a
real test on the routers – action that we could not perform
for ethical reasons.
6
Results
After an initial ﬁngerprinting phase, we collected 919
unique URLs of looking-glass applications, out of which
220 were running one of open-source software listed in
Table 1. The remaining ones were either unreachable
(184 cases), or running a custom code we were not able
to identify with our signatures (515).
6.1
Impacted ASes
An initial lookup on web search engines already proved
fruitful, with at least 4 conﬁguration ﬁles crawled by in-
dexing bots.
Vulnerabilities
Affected ASes
Exposed conﬁguration ﬁles
28
Remote command injection
12
Misconﬁgured CGI
4
Exposed SSH private keys
2
Table 3: Number of vulnerable ASes.
Looking for misconﬁgurations, we observed a large
number of exposed credentials by just visiting the default
conﬁguration paths for each software, as gathered from
the source code. At least 28 conﬁguration ﬁles contain-
ing IPs and credentials can be directly downloaded by
malicious attackers, and in two cases we also observed
private SSH keys exposed on the web server.
Focusing on the source-code, we observed a general
lack of basic security practices. As already said, none
of above software make use of anti-automation mecha-
nisms. The most worrisome result of our review was one
case of missing input sanitation mechanism which allows
injection of arbitrary commands to the router console
(CVE-2014-3927 [19]). We also observed three cases
of insecure default paths and permissions, mostly the
cause of the exposed credentials mentioned above (CVE-
2014-3928 [20], CVE-2014-3929 [21] and CVE-2014-
3930 [22]). In one case, the result page was vulnerable
to a XSS attack (CVE-2014-3926 [23]).
On the host side, an interesting ﬁnding was a re-
mote memory corruption related to the parsing of ICMP-
response ﬁelds in a bundled ping-like utility, meant to
be run as SUID on the looking-glass web server (CVE-
2014-3931 [24]).
To summarize, we detected a total of 46 vulnerable
ASes, which could be targeted by attackers in order to
gain access to the Internet infrastructure. A quick sum-
mary of the issues is shown in Table 3.
Figure 2 plots the number of affects ASes by country.
The most vulnerable nation is Russia with six ASes, fol-
lowed by Poland with four. Then there are 16 countries
with a vulnerable AS. However, none of these ASes are
known tier-1 provider.
Through the use of looking-glasses and network
probes, we globally identiﬁed 53 routers across 20 ASes
publicly exposing telnet or SSH services. This ﬁgure
does not include known public route servers, typically
accessed over telnet, which have been ﬁltered out from
this set.
Finally, by combining all this data, we were able
to correlate two leaked conﬁgurations to ASes whose
routers administration services were listening on routable
IPs.
In total, we observed six routers connected to
looking-glass instances which are directly reachable over
5
Figure 2: Geographical distribution of vulnerable ASes.
telnet and for which credentials are publicly exposed.
As the ﬁnal result of our experiments, we identiﬁed at
least 14 ASes which are highly interesting for attackers
targeting the Internet infrastructure: 12 of them run soft-
ware that is vulnerable to arbitrary commands injection,
while the remaining 2 have a largely exposed infrastruc-
ture.
6.2
BGP injection feasibility
A malicious attacker capable of manipulating BGP ses-
sions may affect the network trafﬁc across the world.
Fortunately, several mechanisms exist to limit wordlwide
issues, most notably preﬁx ﬁltering in which upstreams
and peers ﬁlter a neighbouring AS to only announcing
known routes, effectively preventing malicious injection.
However, several past hijacks [25] and academic stud-
ies [26] have shown how often BGP announces are not
properly ﬁltered, resulting in misconﬁgurations and hi-
jacks being observed in the wild.
While BGP anomaly analysis is a complex subject out-
side of the scope of this paper, we tried to assess if it is
possible for an attacker controlling any of the above vul-
nerable ASes to announce unﬁltered routes. At this point,
we are interested in knowing if some peers of those ASes
were not applying proper ﬁlters, by looking into anoma-
lies detected by the RIPE RIS.
By manually analysing historical data, we spotted
at least three such cases where anomalous announces
where recorded by BGP collectors over the low-visibility
threshold (i.e., relied by multiple peers).
In two cases, overlong preﬁxes (more speciﬁc than
/24) where observed by multiple participating peers,
while in the remaining case an event lasting 8h occurred
where one AS brieﬂy announced an unrelated preﬁxes al-
ready in use (a short multi-origin AS event, possibly due
to a temporary misconﬁguration).
Such unﬁltered preﬁxes hint at the possibility for a re-
mote attacker to distribute bogus BGP routes, by com-
promising one of above ASes.
7
Related Work
Backbone routers are the main players of the Internet
core infrastructure, and they are considered key points
for cyberspace security. For these reasons, these devices
have been studied from several perspectives.
Remote exploitation of routers has been studied in the
past, with Lindner showing the feasibility and the tech-
nical challenges for Cisco IOS [27, 28, 29] as well as
for Huawei VRP [30]. Since then, other researchers fo-
cused their attention on the remote exploitation of Cisco
routers [31, 32] and the ﬁrmware diversity problem [33].
Despite the importance of these devices, serious local
ﬂaws are still being found [34], allowing an attacker with
console access to escalate his privileges. The impact of
these local ﬂaws could be exacerbated by network engi-
neers not following security best-practices, as shown in
this paper.
Researchers also focused their attention on the de-
facto interdomain routing protocol, BGP. In this case,
the threat model consists in taking control of a BGP
device and announcing false routes or hijacking pre-
ﬁxes [35, 36, 26]. This is possible because BGP has been
designed with the concept of trust, at a time in which se-
curity was not a real concern [1]. Several solutions have
been proposed in the literature, ranging from the use of
cryptography (e.g. PKI for a root of trust) [37, 38] to
anomaly detection [39, 40]. Unfortunately, they are not
widely used by network providers.
More speciﬁc to looking-glass applications,
re-
searchers have found some vulnerabilities in the past, but
their focus was on the execution of code on the server
running the looking-glass software [41]. Some concerns
related to information leakage were also raised on public
mailing lists [42, 43]. However, to the best of our knowl-
edge, no comprehensive studies had been conducted so
far on this class of applications.
8
Conclusions
We believe that our study shows how basic best-practices
are not uniformly applied by operators across the world,
and how an attacker can target several ASes to disrupt
the Internet without much effort.
Just by looking at public information gathered on the
web and applying simple heuristics, we have been able
to detect a large number of attack surfaces in this critical
infrastructure. In particular, we directly identiﬁed at least
45 exposed ASes, we found six routers across two ASes
which could be remotely accessed by malicious attackers
via exposed credentials, and at least 12 additional ASes
vulnerable to arbitrary commands injection through the
web interface. Moreover, we have spotted unﬁltered pre-
ﬁxes originating from at least three of these ASes in the
6
past.
Acknowledgements
We would like to thank Pierre-Antoine Vervier and
Quentin Jacquemart for patiently discussing and advis-
ing us on the complex topic of BGP analysis. Moreover,
we would like to thank Thijs Kinkhorst and ANSSI per-
sonnel for directing us in the initial disclosure steps.
References
[1] S. Murphy. BGP Security Vulnerabilities Analysis. RFC 4272
(Informational), January 2006.
[2] Y. Rekhter, T. Li, and S. Hares. A Border Gateway Protocol 4
(BGP-4). RFC 4271 (Draft Standard), January 2006. Updated by
RFCs 6286, 6608, 6793.
[3] Quagga Routing Suite. http://www.nongnu.org/quagga/.
[4] Xorp - eXtensible Open Router Platform. http://www.xorp.
org/.
[5] University of Oregon Route Views Project.
http://www.
routeviews.org/.
[6] Cougar LG. https://github.com/Cougar/lg.
[7] Cistron
LG.
http://www.tux.org/pub/people/
miquel-van-smoorenburg/net/.
[8] MRLG. http://mrlg.op-sec.us/.
[9] MRLG4PHP. http://freecode.com/projects/mrlg4php.
[10] Telephone
LG.
https://github.com/telephone/
LookingGlass.
[11] Hristo Bojinov, Elie Bursztein, and Dan Boneh. XCS: cross chan-
nel scripting and its impact on web applications. In ACM Con-
ference on Computer and Communications Security, pages 420–
431, 2009.
[12] Johnny Long. Google Hacking for Penetration Testers. Black Hat
USA, 2005.
[13] Cisco on Cisco Best Practices – IP Addressing Policies.
https://www.cisco.com/web/about/ciscoitatwork/
downloads/ciscoitatwork/pdf/Cisco_IT_IP_
Addressing_Best_Practices.pdf, 2010.
[14] Ahn, Luis Von and Blum, Manuel and Hopper, Nicholas J. and
Langford, John. CAPTCHA: Using Hard AI Problems for Se-
curity. In Proceedings of the 22Nd International Conference on
Theory and Applications of Cryptographic Techniques, EURO-
CRYPT’03, 2003.
[15] Cisco
IOS
Password
Encryption
Facts.
http://www.
cisco.com/c/en/us/support/docs/security-vpn/
remote-authentication-dial-user-service-radius/
107614-64.html.
[16] Cisco
PSIRT.
Cisco
IOS
and
Cisco
IOS
XE
Type
4
Passwords
Issue
.
http://tools.cisco.com/
security/center/content/CiscoSecurityResponse/
cisco-sr-20130318-type4.
[17] Cisco
PSIRT.
AAA
Command
Authorization
by-pass
. http://tools.cisco.com/security/center/content/
CiscoSecurityResponse/cisco-sr-20060125-aaatcl.
[18] Juniper Networks SIRT. Unauthorized user can obtain root access
using cli.
http://kb.juniper.net/InfoCenter/index?
page=content&id=JSA10420&actp=search&viewlocale=
en_US&searchid=1400663655904, 2010.
[19] mrlg4php: remote command injection to router’s console via
”argument” parameter.
http://www.s3.eurecom.fr/cve/
CVE-2014-3927.txt, 2014.
[20] Cougar-LG: Unsafe conﬁguration ﬁle path/ACL. http://www.
s3.eurecom.fr/cve/CVE-2014-3928.txt, 2014.
[21] Cougar-LG: Unsafe SSH keypairs path in default conﬁg. http:
//www.s3.eurecom.fr/cve/CVE-2014-3929.txt, 2014.
[22] Cistron-LG: Unsafe conﬁguration ﬁle path/ACL. http://www.
s3.eurecom.fr/cve/CVE-2014-3930.txt, 2014.
[23] Cougar-LG: XSS in title via ”addr” parameter. http://www.
s3.eurecom.fr/cve/CVE-2014-3926.txt, 2014.
[24] MRLG: remote memory corruption in fastping (SUID bi-
nary). http://www.s3.eurecom.fr/cve/CVE-2014-3931.
txt, 2014.
[25] Earl Zmijewski. Indonesia Hijacks the World. http://www.
renesys.com/2014/04/indonesia-hijacks-world/.
[26] Ballani, Hitesh and Francis, Paul and Zhang, Xinyang. A Study
of Preﬁx Hijacking and Interception in the Internet. In Proceed-
ings of the 2007 Conference on Applications, Technologies, Ar-
chitectures, and Protocols for Computer Communications, SIG-
COMM ’07, New York, NY, USA, 2007.
[27] FX, FtR and kim0.
Attacking networked embedded systems.
Black Hat USA, 2002.
[28] Felix ”FX” Lindner. Cisco Vulnerabilities - Yesterday, Today and
Tomorrow. Black Hat USA, 2003.
[29] Felix ”FX” Lindner. Cisco IOS Router Exploitation. Black Hat
USA, 2009.
[30] Felix ”FX” Lindner. Hacking Huawei Routers. DEFCON XX,
2012.
[31] Michael Lynn. Cisco IOS Shellcode. Black Hat USA, 2005.
[32] Andy Davis. Remote Cisco IOS FTP exploit, 2007.
[33] Ang Cui and Jatin Kataria and Salvatore J. Stolfo. Killing the
Myth of Cisco IOS Diversity: Recent Advances in Reliable Shell-
code Design. In WOOT, pages 19–27, 2011.
[34] Juniper
Networks
SIRT.
Multiple
privilege
escala-
tion
vulnerabilities
in
Junos
CLI
(CVE-2014-0615).
http://kb.juniper.net/InfoCenter/index?page=
content&id=JSA10608&actp=search&viewlocale=en_
US&searchid=1400663655904, 2014.
[35] Butler, Kevin R. B. and Farley, Toni R. and McDaniel, Patrick
and Rexford, Jennifer.
A Survey of BGP Security Issues and
Solutions. Proceedings of the IEEE, 98:100–122, 2010.
[36] Ramachandran, Anirudh and Feamster, Nick. Understanding the
Network-level Behavior of Spammers.
In Proceedings of the
2006 Conference on Applications, Technologies, Architectures,
and Protocols for Computer Communications, SIGCOMM ’06,
2006.
[37] Public-key infrastructure for the Secure Border Gateway Protocol
(S-BGP), 2001.
[38] RFC 2385 - Protection of BGP Sessions via the TCP MD5 Sig-
nature Option.
http://www.ietf.org/rfc/rfc2385.txt,
1998.
[39] Caesar, M. and Rexford, J. BGP Routing Policies in ISP Net-
works. Netwrk. Mag. of Global Internetwkg., 2005.
[40] Nordstr¨om, Ola and Dovrolis, Constantinos. Beware of BGP At-
tacks. SIGCOMM Comput. Commun. Rev.
[41] rgod. Looking Glass v20040427 arbitrary commands execution
/ cross site scripting.
http://retrogod.altervista.org/
lookingglass.html, 2005.
7
[42] BGP vulnerability?
http://www.gossamer-threads.
com/lists/cisco/nsp/11323?do=post_view_threaded#
11323, 2004.
[43] TCP BGP vulnerability looking glass and route server issues.
http://www.nanog.org/mailinglist/mailarchives/
old_archive/2004-04/msg00684.html, 2004.
8