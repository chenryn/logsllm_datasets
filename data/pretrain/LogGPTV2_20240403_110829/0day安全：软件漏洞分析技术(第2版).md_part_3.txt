.258
8.4.5XSS的检测与防范
.259
8.5路径回溯漏洞…
..260
8.5.1路径回溯的基本原理·
.260
8.5.2范式化与路径回溯·
.261
第2篇漏洞利用原理（高级）
第9章Windows安全机制概述
264
第10章栈中的守护天使：GS
.267
10.1
GS安全编译选项的保护原理
.267
10.2
利用未被保护的内存突破GS.
.271
10.3
覆盖虚函数突破GS
.273
10.4
攻击异常处理突破GS…
.276
10.5
同时替换栈中和.data中的Cookie突破GS.
.280
第11章
亡羊补牢：SafeSEH
284
11.1
SafeSEH对异常处理的保护原理·
284
11.2
攻击返回地址绕过SafeSEH.
.288
11.3
利用虚函数绕过SafeSEH
.288
11.4
从堆中绕过SafeSEH
.288
11.5
利用未启用SafeSEH模块绕过SafeSEH.
*292
11.6
利用加载模块之外的地址绕过SafeSEH
.299
11.7
利用AdobeFlashPlayerActiveX控件绕过SafeSEH
..305
第12章
数据与程序的分水岭：DEP
·313
12.1DEP机制的保护原理..
.31.3
12.2攻击未启用DEP的程序
.316
12.3利用Ret2Libc挑战DEP
.317
12.3.1Ret2Libc实战之利用ZwSetlnformationProcess
.318
12.3..2Ret2Libc实战之利用VirtualProtect.……
330
12.3.3Ret2Libc实战之利用VirtualAlloc
39
12.4利用可执行内存挑战DEP.
.348
12.5利用.NET挑战DEP.
.352
12.6利用Javaapplet挑战DEP
*359
·XVIII·
---
## Page 20
第13章在内存中躲猫猫：ASLR
·.363
13.1内存随机化保护机制的原理
.363
13.2
攻击未启用ASLR的模块
.367
13.3
利用部分覆盖进行定位内存地址
.372
13.4
利用Heapspray技术定位内存地址·
.376
13.5
利用Javaappletheap spray技术定位内存地址
379
13.6
为.NET控件禁用ASLR
..382
第14章
S.E.H终极防护：SEHOP
386
14.1
SEHOP的原理
.386
14.2
攻击返回地址
..388
14.3
攻击虚函数
.388
14.4
利用未启用SEHOP的模块
88...
14.5
伪造S.E.H链表
.390
第15章
重重保护下的堆
-396
15.1
堆保护机制的原理…
.396
15.2
攻击堆中存储的变量·
397
15.3
利用chunk重设大小攻击堆·
398
15.4
利用Lookaside表进行堆溢出
.407
第3篇
漏洞挖掘技术
第16章漏洞挖掘技术简介
414
16.1漏洞挖掘概述
..414
16.2动态测试技术
.415
16.2.1SPIKE简介.
.415
16.2.2beSTORM简介
.421
16.3静态代码审计
.429
第17章文件类型漏洞挖掘与SmartFuzz.
·431
17.1Smart Fuzz概述
.431
17.1.1文件格式Fuzz的基本方法.
.431
17.1.2Blind Fuzz和Smart Fuzz“
.432
17.2用Peach挖掘文件漏洞
433
17.2.1Peach介绍及安装
.433
17.2.2XML介绍·
.434
17.2.3定义简单的PeachPit
·XIX·
---
## Page 21
17.2.4定义数据之间的依存关系
440
17.2.5用PeachFuzzPNG文件
441
17.3010脚本，复杂文件解析的瑞士军刀
.446
17.3.1010Editor简介.
.46
17.3.2010脚本编写入门.
.447
17.3.3010脚本编写提高一PNG文件解析
17.3.4深入解析，深入挖掘一一PPT文件解析
..452
第18章FTP的漏洞挖掘
457
18.1FTP协议简介·
*.457
18.2
漏洞挖掘手记1：DOS.
.457
18.3
漏洞挖掘手记2：访问权限
466
18.4
漏洞挖掘手记3：缓冲区溢出
468
18.5
漏洞挖掘手记4：FuzzDIY…….
.472
第19章
E-mail的漏洞挖掘
.477
19.1挖掘SMTP漏洞
.477
19.1.1SMTP协议简介
.477
19.1.2SMTP漏洞挖掘手记
.478
19.2挖掘POP3漏洞
.480
19.2.1POP3协议简介…
.480
19.2.2POP3漏洞挖掘手记
.481
19.3挖掘IMAP4漏洞
*489
19.3.1IMAP4协议简介"
489
19.3.2IMAP4漏洞挖掘手记.
.490
19.4其他E-mail漏洞.…
.491
19.4.1URL中的路径回溯.
.491
19.4.2内存中的路径回溯
.494
19.4.3邮件中的XSS…
.500
第20章ActiveX控件的漏洞挖掘
502
20.1ActiveX控件简介
502
20.1.1浏览器与ActiveX控件的关系
.. 502
20.1.2控件的属性.
.503
20.2手工测试ActiveX控件
OS....
20.2.1建立测试模板
.504
20.2.2获取控件的接口信息
.505
20.3用工具测试ActiveX控件：COMRaider
509
·XX·
---
## Page 22
20.4挖掘ActiveX漏洞·
..516
20.4.1ActiveX漏洞的分类
.516
20.4.2漏洞挖掘手记1：超星阅读器溢出
517
20.4.3漏洞挖掘手记2：目录操作权限
..521
20.4.4
漏洞挖掘手记3：文件读权限
523
20.4.5漏洞挖掘手记3：文件删除权限
..525
第4篇操作系统内核安全
第21章探索ring0
528
21.1内核基础知识介绍
528
21.1.1内核概述
.528
21.1.2驱动编写之HelloWorld
528
21.1.3
派遣例程与IRP结构
533
21.1.4
Ring3打开驱动设备
537
21.1.5DeviceloControl函数与IoControlCode
.538
21.1.6Ring3/Ring0的四种通信方式.
539
21.2内核调试入门
.541
21.2.1创建内核调试环境
.541
21.2.2蓝屏分析
.549
21.3内核漏洞概述
51
21.3.1内核漏洞的分类
51
21.3.2内核漏洞的研究过程
53
21.4编写安全的驱动程序
.555
21.4.1输入输出检查
.55
21.4.2验证驱动的调用者
56
21.4.3白名单机制的挑战
56
第22章内核漏洞利用技术
557
22.1
利用实验之exploitme.sys.
557
22.2
内核漏洞利用思路
59
22.3
内核漏洞利用方法
.560
22.4
内核漏洞利用实战与编程·
565
22.5
RingO Shellcode的编写·
.570
第23章
FUZZ驱动程序
579
23.1
内核FUZZ思路
.579
23.2内核FUZZ工具介绍·
581
·XXI·
---
## Page 23
23.3内核FUZZ工具DIY
..583
23.3.1Fuzz对象、Fuzz策略、Fuzz项
..583
23.3.2IoControlMITM Fuzz
23.3.3IoControlDriverFuzz
.585
23.3.4MyloControlFuzzer界面
586
23.4内核漏洞挖掘实战·
588
23.4.1超级巡警ASTDriver.sys本地提权漏洞
.588
23.4.2
：东方微点mp110013.sys本地提权漏洞
·594
23.4.3瑞星HookCont.sys驱动本地拒绝服务漏洞…
109.
第24章内核漏洞案例分析
605
24.1
远程拒绝服务内核漏洞
605
24.2
本地拒绝服务内核漏洞
119...
24.3