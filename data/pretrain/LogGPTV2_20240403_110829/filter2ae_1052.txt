# 【木马分析】能够逃避机器学习检测的 Cerber 勒索软件变种

#### 译文声明
本文为翻译文章，原文来源：安全客。译文仅供参考，具体内容及含义请以原文为准。

#### 作者信息
- 作者：[黑鸟](http://bobao.360.cn/member/contribute?uid=2730021436)
- 预估稿费：200 RMB
- 投稿方式：发送邮件至 linwei#360.cn 或登录网页版在线投稿

---

### 摘要
Cerber 勒索软件家族近期被发现采用了一种新技术来规避检测。这种技术通过将恶意代码注入到一个看似正常的二进制文件中，并使用其他手段加载和运行，从而逃避基于机器学习的检测机制。

### 行为分析
这类勒索软件通常通过电子邮件传播，新的 Cerber 变体也不例外。攻击者会向受害者发送包含恶意链接的电子邮件，这些链接指向存储在 Dropbox 等云服务上的自解压文件。一旦用户下载并打开该文件，系统即会被感染。

以下是新变种的大致工作流程：
1. 自解压文件内含三个组件：VBS 脚本、DLL 文件以及一个大小为 1454KB 的配置文件。
2. 当用户双击执行此 EXE 文件时，VBS 脚本首先启动并通过 `rundll32.exe` 加载 DLL 文件。
3. DLL 文件负责读取并解密配置文件中的特定部分，进而触发后续操作。

值得注意的是，尽管 DLL 文件本身并不携带恶意代码，但其解密后的配置文件却含有用于进一步攻击的关键指令。

### 检测与防护
为了确保自身不被发现，该变体会检查目标环境是否存在以下特征：
- **分析工具**：如 Msconfig, Sandboxes, Regedit, Task Manager, Virtual Machines 和 Wireshark。
- **杀毒软件**：包括 360, AVG, Bitdefender, Dr. Web, Kaspersky, Norton 和 Trend Micro。

如果检测到上述任一项目，则程序将自动终止执行。

### 机器学习逃逸策略
面对传统的安全解决方案，Cerber 已经发展出一种新方法——利用压缩包和独立加载器来绕过静态分析。这种方法特别针对依赖于文件特征而非签名识别的机器学习模型设计而成。

具体来说，由于所有自解压文件在结构上具有相似性，仅凭简单的二进制提取无法准确判断其性质。因此，Cerber 通过这种方式成功地避开了许多基于机器学习的安全产品。

然而，对于多层防御体系而言，仍存在有效的对抗措施。例如，当遇到可疑压缩包时，可以尝试对其内部内容进行深度解析或模拟运行以揭示潜在威胁。

### 样本哈希值
- VBS: 09ef4c6b8a297bf4cf161d4c12260ca58cc7b05eb4de6e728d55a4acd94606d4a61eb7c8D
- 配置文件: 7a6bc9e3eb2b42e7038a0850c56e68f3fec0378b2738fe3632a7e4c
- DLL: e3e5d9f1bacc4f43af3fab28a905fa4559f98e4dadede376e199360d14b39153
- 自解压: f4dbbb2c4d83c2bbdf4faa4cf6b78780b01c2a2c59bc399e5b746567ce6367dd

### 结语
这是本人首次发表此类技术文章，若有任何错误敬请指正。同时提醒各位读者切勿随意点击不明链接或下载未知来源的文件，以免遭受损失。希望未来能有更多先进的安全技术涌现，共同抵御勒索软件等网络安全威胁。