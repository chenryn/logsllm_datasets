a successful attack harder. The network administrators can deploy
countermeasures to make such information difficult to leak, e.g.,
DNS resolvers should use multiple caches with different DNS soft-
ware on each, resolvers should not send ICMP errors, nameservers
should randomise records in responses.
Preventing queries. Server operators might choose to config-
ure systems to do less (or no) DNS lookups, ie. in the case of email
servers. This reduces the chance an attacker can trigger a query to
start the poisoning.
Blocking fragmentation. Resolver operators can block frag-
mented responses in firewalls to reduce the applicability of FragDNS
attacks. Some operators only implement filtering of small fragments
(i.e., Google’s 8.8.8.8) which can prevent the attack since the attacker
might not be able to cause a nameserver response of the size needed
to reach the filtering limit.
Randomise DNS responses. Randomising nameserver responses
complicates the FragDNS attack as the attacker needs to predict
the UDP checksum of the original nameserver’s response.
0x20 Encoding. 0x20 Encoding adds entropy to the DNS query
which must be matched by the response. This complicates the
SadDNS attack to a point where it is no longer viable (ie. adding
0x20 Encoding to a domain with 16 alphanumeric characters adds
16 bits of entropy to the query). Since this randomness is only
contained in the question section of the DNS packet, it cannot
prevent the FragDNS attack as it will be in the first fragment along
with the TXID.
Securing BGP. Full deployment of RPKI (together with BGPSec)
would prevent the HijackDNS attack. However, because of several
deployment barriers, most of the prefixes are not protected by
RPKI and most ASes do not enforce Route Origin Validation (ROV)
[36, 40, 62]. We refer to [39] for a comprehensive discussion of the
deployment issues.
6.2 Applications
In the rest of this section we provide recommendations for prevent-
ing cross-layer attacks that use DNS cache poisoning.
Separate resolvers and caches. It is common in networks to
use one DNS resolver for multiple services and servers. Our attacks
exploit that. We recommend using different DNS resolvers (each
with a distinct cache) for each system.
Third party authentication (TLS). Third party authentication,
like TLS, can mitigate the attacks against all DNS use-cases which
aim to locate a server (i.e.m federation and address lookup use-
cases). However, even such mechanisms can only reduce the harm
of DNS poisoning, but not completely mitigate it, e.g., adversaries
can use DNS cache poisoning to subvert the security of DV during
certificates issuance. Furthermore, an attacker can still use cache-
poisoning for DoS attacks.
Two factor authentication. Should be enabled by default (and
not optional as it is now). This would prevent the attacker from
getting access to the account even if it has acquired the login cre-
dentials for the victim.
Secure fallback. Instead of allowing a transaction when no in-
formation about its authorisation state can be gathered (like done
currently in SPF and RPKI) a security-mechanism could decide to
not allow it. This however would mean that attacking the availabil-
ity of DNS for a certain domain would allow DoS attacks instead,
preventing a resolver from looking up a domain’s SPF records would
prevent that domain from sending any emails to the servers using
this resolver.
7 CONCLUSIONS
We evaluated methodologies for launching practical DNS cache
poisoning attacks and derived insights on the applicability, effective-
ness and stealth of these attacks. We then applied the methodologies
for a systematic evaluation of cross-layer attacks against popular
applications.
Our work demonstrates the significant role that DNS plays
in the Internet for ensuring security and stability of the applica-
tions and clients. If DNS is vulnerable, our work shows that in
addition to traditional attacks, such as redirection to adversarial
hosts, weak off-path adversaries can even downgrade protection
of security mechanisms, such as RPKI or DV. We provide recom-
mendations for mitigations and developed a public tool at https:
//crosslayerattacks.sit.fraunhofer.de to enable clients to
identify vulnerabilities in DNS platforms on their networks.
ACKNOWLEDGEMENTS
We thank the anonymous referees for thoughtful feedback on our
work. This work has been co-funded by the German Federal Min-
istry of Education and Research and the Hessen State Ministry for
Higher Education, Research and Arts within their joint support of
the National Research Center for Applied Cybersecurity ATHENE
and by the Deutsche Forschungsgemeinschaft (DFG, German Re-
search Foundation) SFB 1119.
847
From IP to Transport and Beyond:
Cross-Layer Attacks Against Applications
SIGCOMM ’21, August 23–28, 2021, Virtual Event, USA
REFERENCES
[1] [n.d.]. Best Infrastructure as a Service (IaaS) Providers. https://www.g2.com/
categories/infrastructure-as-a-service-iaas. Accessed: 2020-10-09.
[2] [n.d.].
Market Share Analysis:
IaaS and IUS, Worldwide, 2018.
https://www.gartner.com/en/newsroom/press-releases/2019-07-29-gartner-
says-worldwide-iaas-public-cloud-services-market-grew-31point3-percent-
in-2018. Accessed: 2020-10-09.
[3] [n.d.]. Market share trends for SSL certificate authorities. https://w3techs.com/
technologies/history_overview/ssl_certificate. Accessed: 2020-10-09.
[4] [n.d.]. Quarterly Cloud Spending Blows Past $30B; Incremental Growth Continues
to Rise. https://www.srgresearch.com/articles/quarterly-cloud-spending-blows-
past-30b-incremental-growth-continues-rise. Accessed: 2020-10-09.
[5] [n.d.]. Top IaaS Providers: 42 Leading Infrastructure-as-a-Service Providers to
Streamline Your Operations. https://stackify.com/top-iaas-providers/. Accessed:
2020-10-09.
The
CAIDA
AS
Relationships
Dataset,
2011.
[6] 2011.
http://www.caida.org/data/active/as-relationships/.
[7] 2015. Hacked or Spoofed: Digging into the Malaysia Airlines Website Incident.
https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/hacked-or-
spoofed-digging-into-the-malaysia-airlines-website-compromise. Accessed:
2021-1-19.
[8] 2015.
mains.
hijack-of-lenovo-google-domains/. Accessed: 2021-1-19.
Webnic Registrar Blamed for Hijack of Lenovo, Google Do-
https://krebsonsecurity.com/2015/02/webnic-registrar-blamed-for-
[9] 2018. DNSpionage Campaign Targets Middle East. https://blog.talosintelligence.
com/2018/11/dnspionage-campaign-targets-middle-east.html. Accessed: 2021-
01-19.
[10] 2019.
Global DNS Hijacking Campaign: DNS Record Manipulation
at Scale. https://www.fireeye.com/blog/threat-research/2019/01/global-dns-
hijacking-campaign-dns-record-manipulation-at-scale.html. Accessed: 2021-1-
19.
Sea Turtle keeps on swimming, finds new victims, DNS hijacking
https://blog.talosintelligence.com/2019/07/sea-turtle-keeps-on-
techniques.
swimming.html. Accessed: 2021-01-19.
[12] 2019. ‘Unprecedented’ DNS Hijacking Attacks Linked to Iran. https://threatpost.
com/unprecedented-dns-hijacking-attacks-linked-to-iran/140737/
[13] 2020. Security Incident on November 13, 2020. https://blog.liquid.com/security-
[11] 2019.
incident-november-13-2020. Accessed: 2021-01-19.
[14] 2021. The Hijackers Guide To The Galaxy: Off-Path Taking Over Internet Re-
sources. In 30th USENIX Security Symposium (USENIX Security 21). USENIX Asso-
ciation. https://www.usenix.org/conference/usenixsecurity21/presentation/dai
[15] aconet. [n.d.]. eduroam-Teilnehmer in Österreich. https://www.aco.net/eduroam_
teilnehmer.html. Accessed: 2020-12-02.
[16] F. Alharbi, J. Chang, Y. Zhou, F. Qian, Z. Qian, and N. Abu-Ghazaleh. 2019.
Collaborative Client-Side DNS Cache Poisoning Attack. In IEEE INFOCOM 2019 -
IEEE Conference on Computer Communications. 1153–1161. https://doi.org/10.
1109/INFOCOM.2019.8737514
[17] Maria Apostolaki, Aviv Zohar, and Laurent Vanbever. 2017. Hijacking bitcoin:
Routing attacks on cryptocurrencies. In 2017 IEEE Symposium on Security and
Privacy (SP). IEEE, 375–392.
[18] Dan J. Bernstein. 2002.
Internet publication at
DNS Forgery.
http://cr.yp.to/djbdns/forgery.html.
[19] Robert Beverly and Steven Bauer. 2005. The Spoofer project: Inferring the extent
of source address filtering on the Internet. In Usenix Sruti, Vol. 5. 53–59.
[20] Robert Beverly, Arthur Berger, Young Hyun, and K Claffy. 2009. Understanding
the efficacy of deployed internet source address validation filtering. In Proceedings
of the 9th ACM SIGCOMM conference on Internet measurement. 356–369.
[21] Robert Beverly, Ryan Koga, and KC Claffy. 2013. Initial longitudinal analysis of
IP source spoofing capability on the Internet. Internet Society (2013), 313.
[22] Henry Birge-Lee, Yixin Sun, Anne Edmundson, Jennifer Rexford, and Prateek
Mittal. 2018. Bamboozling Certificate Authorities with BGP. In 27th USENIX
Security Symposium (USENIX Security 18). 833–849.
[23] Peter Boothe, James Hiebert, and Randy Bush. 2006. Short-lived prefix hijacking
on the Internet. In Proc. of the NANOG 36 (2006).
[24] Markus Brandt, Tianxiang Dai, Amit Klein, Haya Shulman, and Michael Waidner.
2018. Domain Validation++ For MitM-Resilient PKI. In Proceedings of the 2018
ACM SIGSAC Conference on Computer and Communications Security. ACM, 2060–
2076.
[25] R Bush and R Austein. 2013. RFC 6810: The Resource Public Key Infrastructure
(RPKI) to Router Protocol.
[26] Taejoong Chung, Roland van Rijswijk-Deij, Balakrishnan Chandrasekaran, David
Choffnes, Dave Levin, Bruce M Maggs, Alan Mislove, and Christo Wilson. 2017.
A Longitudinal, End-to-End View of the DNSSEC Ecosystem. In 26th USENIX
Security Symposium (USENIX Security 17). 1307–1322.
[27] Taejoong Chung, Roland van Rijswijk-Deij, David Choffnes, Dave Levin, Bruce M
Maggs, Alan Mislove, and Christo Wilson. 2017. Understanding the role of
registrars in DNSSEC deployment. In Proceedings of the 2017 Internet Measurement
848
Conference. 369–383.
[28] D. Madory. 2018. Recent Routing Incidents: Using BGP to Hijack DNS and
more. https://www.lacnic.net/innovaportal/file/3207/1/dougmadory_lacnic_30_
rosario.pdf
[29] David Dagon, Manos Antonakakis, Paul Vixie, Tatuya Jinmei, and Wenke Lee.
2008.
Increased DNS forgery resistance through 0x20-bit encoding: security
via leet queries. In ACM Conference on Computer and Communications Security,
Peng Ning, Paul F. Syverson, and Somesh Jha (Eds.). ACM, 211–222.
http:
//doi.acm.org/10.1145/1455770.1455798
[30] DFN-Verein. [n.d.]. Karte der aktuellen eduroam Standorte in Deutschland.
https://www.dfn.de/dienstleistungen/eduroam/. Accessed: 2020-12-02.
[31] Roger Dingledine, Nick Mathewson, and Paul Syverson. 2004. Tor: The second-
generation onion router. Technical Report. Naval Research Lab Washington DC.
[32] Zakir Durumeric, David Adrian, Ariana Mirian, Michael Bailey, and J. Alex
Halderman. 2015. A Search Engine Backed by Internet-Wide Scanning. In 22nd
ACM Conference on Computer and Communications Security.
[33] Tony Finch, Evan Hunt, Peter van Dijk, Anthony Eden, and Willem Mekking.
2019. Address-specific DNS aliases (ANAME). Internet-Draft draft-ietf-dnsop-
aname-03. IETF Secretariat. http://www.ietf.org/internet-drafts/draft-ietf-dnsop-
aname-03.txt.
[34] Pedro Franco. 2014. Understanding bitcoin. Wiley Online Library.
[35] Lixin Gao and Jennifer Rexford. 2001. Stable Internet routing without global
coordination. IEEE/ACM Transactions on networking 9, 6 (2001), 681–692.
[36] Yossi Gilad, Avichai Cohen, Amir Herzberg, Michael Schapira, and Haya Shulman.
2017. Are We There Yet? On RPKI’s Deployment and Security.. In NDSS.
[37] Amir Herzberg and Haya Shulman. 2012. Security of Patched DNS. In Computer
Security - ESORICS 2012 - 17th European Symposium on Research in Computer
Security, Pisa, Italy, September 10-12, 2012. Proceedings. 271–288.
[38] Amir Herzberg and Haya Shulman. 2013. Fragmentation Considered Poisonous:
or one-domain-to-rule-them-all.org. In IEEE CNS 2013. The Conference on Com-
munications and Network Security, Washington, D.C., U.S. IEEE.
[39] Tomas Hlavacek, Italo Cunha, Yossi Gilad, Amir Herzberg, Ethan Katz-Bassett,
Michael Schapira, and Haya Shulman. 2020. DISCO: Sidestepping RPKI’s Deploy-
ment Barriers. In Network and Distributed System Security Symposium (NDSS).
[40] Tomas Hlavacek, Amir Herzberg, Haya Shulman, and Michael Waidner. 2018.
Practical Experience: Methodologies for Measuring Route Origin Validation.
In 48th Annual IEEE/IFIP International Conference on Dependable Systems and
Networks, DSN 2018, Luxembourg City, Luxembourg, June 25-28, 2018. 634–641.
https://doi.org/10.1109/DSN.2018.00070
[41] P Hoffman and P McManus. 2018. RFC 8484: DNS Queries over HTTPS (DoH).
[42] Z Hu, L Zhu, J Heidemann, A Mankin, D Wessels, and P Hoffman. 2016. RFC
7858-Specification for DNS over Transport Layer Security (TLS).
[43] A. Hubert and R. van Mook. 2009. Measures for Making DNS More Resilient against
Forged Answers. RFC 5452. RFC Editor.
[44] Philipp Jeitner and Haya Shulman. 2021. Injection Attacks Reloaded: Tunnelling
Malicious Payloads over DNS. In 30th USENIX Security Symposium (USENIX
Security 21).
[45] Philipp Jeitner, Haya Shulman, and Michael Waidner. 2020. The Impact of DNS
Insecurity on Time. In 2020 50th Annual IEEE/IFIP International Conference on
Dependable Systems and Networks (DSN). IEEE, 266–277.
[46] Jisc. [n.d.]. Organisations participating in eduroam in the UK. https://www.jisc.
ac.uk/eduroam/participating-organisations. Accessed: 2020-12-02.
[47] Dan Kaminsky. 2008. It’s the End of the Cache As We Know It. Presentation at
Blackhat Briefings.
[48] Josh Karlin, Stephanie Forrest, and Jennifer Rexford. 2008. Autonomous security
for autonomous systems. Computer Networks 52, 15 (2008), 2908–2923.
[49] Varun Khare, Qing Ju, and Beichuan Zhang. 2012. Concurrent prefix hijacks: Oc-
currence and impacts. In Proceedings of the 2012 Internet Measurement Conference.
ACM, 29–36.
[50] Amit Klein. 2007. BIND 9 DNS cache poisoning. Report, Trusteer, Ltd 3 (2007).
[51] Amit Klein. 2007. Windows DNS Server Cache Poisoning,”.
[52] Amit Klein. 2020. Cross Layer Attacks and How to Use Them (for DNS Cache
Poisoning, Device Tracking and More). arXiv preprint arXiv:2012.07432 (2020).
[53] Amit Klein, Haya Shulman, and Michael Waidner. 2017. Internet-wide study
of DNS cache injections. In IEEE INFOCOM 2017-IEEE Conference on Computer
Communications. IEEE, 1–9.
[54] Matt Lepinski, Stephen Kent, and Derrick Kong. 2012. A profile for route origin
authorizations (ROAs). IETF, RFC 6482 (2012).
[55] Qasim Lone, Matthew Luckie, Maciej Korczyński, Hadi Asghari, Mobin Javed,
and Michel van Eeten. 2018. Using Crowdsourcing Marketplaces for Network
Measurements: The Case of Spoofer. In 2018 Network Traffic Measurement and
Analysis Conference (TMA). IEEE, 1–8.
[56] Matthew Luckie, Robert Beverly, Ryan Koga, Ken Keys, Joshua A Kroll, and
k claffy. 2019. Network Hygiene, Incentives, and Regulation: Deployment of
Source Address Validation in the Internet. In Proceedings of the 2019 ACM SIGSAC
Conference on Computer and Communications Security. 465–480.
[57] Keyu Man, Zhiyun Qian, Zhongjie Wang, Xiaofeng Zheng, Youjun Huang, and
Haixin Duan. 2020. DNS Cache Poisoning Attack Reloaded: Revolutions with
SIGCOMM ’21, August 23–28, 2021, Virtual Event, USA
Tianxiang Dai, Philipp Jeitner, Haya Shulman, and Michael Waidner
Side Channels. In Proceedings of the 2020 ACM SIGSAC Conference on Computer
and Communications Security (Virtual Event, USA) (CCS ’20). Association for
Computing Machinery, New York, NY, USA, 1337–1350. https://doi.org/10.1145/
3372297.3417280
[58] Jared Mauch. 2013. Open resolver project. In Presentation, DNS-OARC Spring
2013 Workshop (Dublin).
[59] P. Mockapetris. 1987. Domain names - concepts and facilities. STD 13. RFC Editor.
http://www.rfc-editor.org/rfc/rfc1034.txt http://www.rfc-editor.org/rfc/rfc1034.
txt.
[60] P. Mockapetris. 1987. Domain names - implementation and specification. STD 13.
RFC Editor. http://www.rfc-editor.org/rfc/rfc1035.txt http://www.rfc-editor.org/
rfc/rfc1035.txt.
[61] Pradosh Mohapatra, John Scudder, David Ward, Randy Bush, and Rob Austein.
2013. BGP prefix origin validation. In IETF RFC 6811.
[62] Andreas Reuter, Randy Bush, Ítalo Cunha, Ethan Katz-Bassett, Thomas C. Schmidt,
and Matthias Wählisch. 2017. Towards a Rigorous Methodology for Measuring
Adoption of RPKI Route Validation and Filtering. CoRR abs/1706.04263 (2017).
arXiv:1706.04263 http://arxiv.org/abs/1706.04263
[63] RIPE NCC. 2021. RIS Raw Data.
https://www.ripe.net/analyse/internet-
measurements/routing-information-service-ris/ris-raw-data
[64] S. Goldberg. 2018. The myetherwallet.com hijack and why it’s risky to hold cryp-
tocurrency in a webapp. https://medium.com/@goldbe/the-myetherwallet-com-
hijack-and-why-its-risky-to-hold-cryptocurrency-in-a-webapp-261131fad278
[65] Haya Shulman. 2014. Pretty bad privacy: Pitfalls of DNS encryption. In Proceedings
of the 13th Workshop on Privacy in the Electronic Society. 191–200.
[66] Haya Shulman and Michael Waidner. 2015. Towards security of internet naming
infrastructure. In European Symposium on Research in Computer Security. Springer,
3–22.
[67] Haya Shulman and Michael Waidner. 2017. One Key to Sign Them All Considered
Vulnerable: Evaluation of DNSSEC in the Internet.. In NSDI. 131–144.
[68] Sandra Siby, Marc Juarez, Claudia Diaz, Narseo Vallina-Rodriguez, and Carmela
Troncoso. 2019. Encrypted DNS–> Privacy? A Traffic Analysis Perspective. arXiv
preprint arXiv:1906.09682 (2019).
[69] Jonathan Spring. [n.d.]. Probable Cache Poisoning of Mail Handling Do-
mains. https://insights.sei.cmu.edu/cert/2014/09/-probable-cache-poisoning-of-
mail-handling-domains.html.
[70] Yixin Sun, Maria Apostolaki, Henry Birge-Lee, Laurent Vanbever, Jennifer Rex-
ford, Mung Chiang, and Prateek Mittal. 2021. Securing internet applications from
routing attacks. Commun. ACM 64, 6 (2021), 86–96.
[71] University of Oregon. 2012. Route Views Project. http://bgplay.routeviews.org/.
[72] Paul Vixie. 1995. DNS and BIND Security Issues. In Proceedings of the 5th Sympo-
sium on UNIX Security. USENIX Association, Berkeley, CA, USA, 209–216.
[73] S Weiler and D Blacka. 2013. RFC 6840: Clarifications and Implementation Notes
for DNS Security (DNSSEC). IETF Standard (2013).
[74] Xiaofeng Zheng, Chaoyi Lu, Jian Peng, Qiushi Yang, Dongjie Zhou, Baojun Liu,
Keyu Man, Shuang Hao, Haixin Duan, and Zhiyun Qian. 2020. Poison Over
Troubled Forwarders: A Cache Poisoning Attack Targeting DNS Forwarding
Devices. In 29th USENIX Security Symposium (USENIX Security 20). 577–593.
849