acknowledgment (ACK) signal to inform the receiver to move to
the next phase.
PingID & CSelectionPTTransmitterObject DetectedConfiguredReceiver DetectedEnd Power / Error / Time outACKSignalID&C InformationSignal StrengthEnd PowerControl ErrorEnd PowerSelectionPTID & CPingReceiverEnd Power / Signal LostSecondary CoilPrimary CoilPreambleChecksumMessageHeader11 bits11 bits1 â€“27 bytes11 â€“25 bitsSynchronizationType & SizeQi MessageIntegrity Checking1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 0 0 0 0 1 10 1 1 1 . . . . 0 0 0 10 0 0 1 0 1 1 0 0 0 10Start1ð‘!1ð‘"00000011Stopð‘#ð‘$ð‘%ð‘&ð‘â€™ð‘(8 Data bitsParityValue = 0x03(Type: Control Error; Size: 1)0.5ms918ACSAC â€™21, December 6â€“10, 2021, Virtual Event, USA
Yi Wu, Zhuohang Li, Nicholas Van Nostrand, and Jian Liu
â–½ Â·D = Ïf ,
â–½ Ã—E = âˆ’ âˆ‚B
âˆ‚t
,
â–½ Â·B = 0,
(1a)
(1c) â–½ Ã—B = Âµ0 J + ÂµoÏµ0 âˆ‚E
âˆ‚t
(1b)
, (1d)
is shown in Figure 3(b)1, with the messages being transmitted
using AM modulation by switching a resistive dummy load on the
power receiver side. The carrier voltage signal of AM modulation
is operated at around 125 kHz.
Among all types of Qi messages, the control error message is
the most critical for adaptively controlling power transfer. The
transmitter uses the received control error value Ci in the ith control
error packet to adjust its primary coilâ€™s alternating current: I i =
I iâˆ’1 Â· (1 + Ci/128), where I i is the new primary coil current, and
I iâˆ’1 is the previous primary coil current constrained by both I iâˆ’2
and Ciâˆ’1.
2.3 Electromagnetic Induction
Based on electromagnetic induction, a wireless charging system
can be represented using Maxwell Equations (differential form):
where D is the electric displacement field, E is the electric field
), B is the magnetic field, Ïf is the electric charge density,
(E = D
Ïµ0
Âµ0 is the magnetic permeability, Ïµ0 is the electric permittivity, and
J is the charging current density. Since Qi messages are transmit-
ted via AM modulation, a change on the primary coil voltage will
influence Ïf and thereby further change the electric field strength.
According to Equation 1d, a changing electric field will also gener-
ate an induced magnetic field and further produce induced voltage
on a nearby coil. Since ZERO and ONE in Qi messages are trans-
mitted using differential coding (as shown in Figure 3 (b)), they
would exhibit different patterns on the induced voltage on the ad-
versarial coil. On the other side, adding an external magnetic field
to the charging system will change the strength of its magnet field
and further influence the electric field, according to Equation 1c.
The primary coil voltage of the charger would thus be affected,
thereby interfering with or even fully controlling the Qi message
transmission channel.
3 THREAT MODEL
3.1 Possible Attack Scenarios
Due to the open propagation properties of oscillating magnetic
signals, Qi wireless charging gives attackers various opportunities
to inject adversarial magnetic signals on the power transmitter
to hijack the communication channel and further alter the power
transfer. Moreover, the current design of the Qi wireless charging
does not provide any encryption or authentication mechanisms to
protect the transmitted Qi messages, which in turn can be easily
snooped by the adversary. It thus incurs potential privacy concerns
of monitoring smartphone activity while being charged. Given
these fundamental vulnerabilities, we consider the following two
attack scenarios:
(1) Hijacking Attack: In this scenario, the adversary can hijack
the Qi communication channel by injecting adversarial magnetic
signals using a disguised adversarial coil to alter the power transfer
as desired. Through modulating the alternating current flowing
1The data bits (LSB first) 0x03 indicates the packet type is control error, and the message
size can be calculated as 1 + (H eader âˆ’ 0)/32=1 [7].
through the adversarial coil, the coil can produce well-crafted mag-
netic signals to perturb the electromagnetic field between the power
transmitter and receiver, which serves as the medium for power
transfer and the Qi message transmission. In consequence, the ad-
versary can reduce the power transfer efficiency (e.g., increasing
charging time) or directly terminate the charging process. One step
further, the adversary can even take control of the power transmis-
sion, such as intentionally manipulating the values of Qi messages,
making the transmitter transmit any amount of power they want.
This charging process may cause significant damage to the battery
(e.g., overheating, reducing battery life, or even an explosion). Itâ€™s
important to note that an adversary may be capable of directly
adding power to the receiver via coupling energy in an analog man-
ner leveraging the adversarial coil. However, the charging system
may become much more unstable in the presence of two â€œpower
transmittersâ€, making the receiver reverse back to the selection
phase and end up power transfer. We leave this scenario as our
future work.
(2) Eavesdropping Attack: In this scenario, the adversary can
non-intrusively and passively derive Qi messages using a nearby
hidden adversarial coil (e.g., stuck underneath the table) and fur-
ther infer the activities of the power receiver (e.g., a smartphone)
while being charged. Due to the sudden increase in the power con-
sumption associated with phone notifications (e.g., receiving a SMS
message, or receiving an incoming phone call), the gap between the
desired and actual operating point during the power transfer (PT)
phase would have to be changed accordingly. Through capturing
the values of the control error messages, the adversary can detect
the exact time when the smartphone receives these notifications.
More importantly, different types of notifications (e.g., receiving a
SMS message, receiving an incoming phone call, and turning on the
screen by the user himself) or even the same type of notifications
from different apps would have a unique impact on the power trans-
fer control as they all rely on different set of hardware modules
(e.g., vibration motor, screen on/off, WiFi module, cellular module,
and sensor module). Therefore, when a notification is received,
different apps would show a discriminative power consumption
pattern and have distinguishable reflections on the biasing of the
operating point, further leading to different control error messages
and primary coil voltage patterns. Additionally, by deriving Qi ID &
C messages carried on the inductive coil voltage, the adversary can
obtain the basic device identifier, which can be further used to iden-
tify users. The potential security & privacy threats we discovered
are summarized in Table 1.
3.2 Assumptions & Adversaryâ€™s Capability
Given a charging pad that the victim might use in a coffee shop,
hotel, airport, library, commercial office, or home, we assume the
adversary should have the following capabilities as per each attack
scenario:
(1) Hijacking Attack: In this scenario, the adversary is assumed
to be able to stealthily place an adversarial coil between the charging
pad and the charging device. For instance, the add-on adversarial
coil could be stuck on the surface of the charger and made to
resemble a lookalike sticker, such as the one shown in Figure 4(a)
which looks like an ultra-thin film (i.e., 0.7 mm thickness) and can be
attached on the charging padâ€™s surface without drawing suspicion.
919Security and Privacy Vulnerability Analysis of Qi Wireless Charging
ACSAC â€™21, December 6â€“10, 2021, Virtual Event, USA
Table 1: Potential security and privacy threats of Qi wireless charging.
Attack Scenario
Hijacking attack
Information/Action Needed
Inject adversarial magnetic signals
Eavesdropping attack
Inductive voltage on a nearby hidden coil
Manipulate the amount of power being transferred (e.g., overcharging/undercharging)
Security&Privacy Threats
Start/stop charging
Reduce charging efficiency, cause overheating and battery damage
Recognize basic device identifier and manufacturer ID
Detect & identify the basic phone activities (e.g., Phone is unlocked and the screen is on)
Detect & identify the category of incoming notifications (e.g., phone calls or messages)
Identify the specific app triggering the notification (e.g., WhatsApp, and Messenger)
(a) Stealthily sticking an ultra-thin ad-
versarial coil on the surface of the
charger
(b) Hiding the adversarial coil under-
neath the surface
Figure 4: Examples of Possible attack scenarios: (a) [Hijack-
ing] sticking an ultra-thin adversarial coil to the chargerâ€™s
surface; and (b) [Eavesdropping] sticking the adversarial
coil underneath the surface on which the charging device
is placed.
In practice, the adversary can make the color of the sticker closer
to the chargerâ€™s color to make it even more unnoticeable. The
voltage of the controlled adversarial coil can be provided by a signal
generation back end, which could be concealed in an instrumented
power outlet.
(2) Eavesdropping Attack: In this scenario, as the adversary
only needs to passively receive the magnetic signals, he/she can
place the ultra-thin adversary coil farther away, such as hiding the
coil underneath the surface on which the charging pad is placed,
as shown in Figure 4 (b). The coil also requires a logging back end
to capture the inductive voltage. We used a 312 kHz sample rate
with 8-bit samples in this work, showing a reasonable throughput
of 2.5 Mbps for logging via a modern cellular network, WiFi, or a
local SD card.
For both attack scenarios, the adversary is not required to get
physical access to the charger. In other words, the adversary does
not need to disassemble the charger or modify the internal cir-
cuit board. We believe that these non-intrusive attacks are under
very practical threat models and can be surreptitiously and easily
launched in practice.
4 SNOOPING QI MESSAGE THROUGH A
NEARBY HIDDEN ADVERSARIAL COIL
In this section, we describe how an adversary can snoop Qi mes-
sages through a nearby hidden adversarial coil. Specifically, once
the adversary gets access to the inductive voltage of the adversar-
ial coil, the time-series voltage readings need to be fed into the
following components to derive Qi message data bits: Voltage De-
noising & Filtering, Packet Detection & Segmentation, and Data Bits
Demodulation.
(b) Signal denoising & filtering
(a) EVALSTWBC-EP charg-
ing board [31] and the ad-
versarial coil
Figure 5: Illustration of signal collection and filtering using
an EVALSTWBC-EP evaluation board.
4.1 Voltage Denoising & Filtering
In order to isolate Qi-message-relevant signals from the adversarial
coil voltage, we apply a moving-average filter and a low-pass filter
to smooth the signal and eliminate irrelevant frequency compo-
nents, respectively. Figure 5 shows a segment of the measured ad-
versarial coil voltage (raw signal) and the corresponding denoising
and filtering processing (filtered signal) in our eavesdropping attack
scenario. In the experiment, the wireless charger (i.e., EVALSTWBC-
EP provided by STMicroelectronics [31]) is placed on a wooden
table which has a thickness of 3.2 cm. To snoop Qi messages, a tiny
and ultra-thin adversarial coil (Figure 5(a)) is stuck underneath the
table, and the horizontal distance between the charger and the coil
is around 2 cm. A logging backend (e.g., a digital oscilloscope) is
connected to the adversarial coil for measuring inductive voltage.
To extract the modulated data bits, we first apply a moving-
average filter which only keeps the average value within a sliding
window. We set the window length as âŒˆfs/fcâŒ‰, where fs and fc
are the sampling rate of our logging backend (i.e., 312 kHz) and
the measured carrier frequency (around 4 kHz), respectively. We
then apply a third-order low-pass Butterworth filter with a cut-off
frequency at 2 kHz (modulation frequency) to further eliminate
irrelevant frequency components, . After filtering, only the packet
segments carrying the data bits are preserved. Figure 5(b) illustrates
a fragment of the raw signal and the filtered signal in a packet
segment for visualization purposes. Qi message data can then be
detected and decoded according to the modulating frequency (i.e.,
ZERO is 1kHz, ONE is 2kHz).
4.2 Packet Detection & Segmentation
After filtering, the carrier signal can be filtered out and the signal
that does not contain Qi packets would approximately become a
Wireless ChargerAdversarial CoilAdversarial CoilWireless ChargerSmartphone & Wireless ChargerAdversarial CoilAdversarial CoilCharger: EVALS-TWBC-EP41 mm29 mm920ACSAC â€™21, December 6â€“10, 2021, Virtual Event, USA
Yi Wu, Zhuohang Li, Nicholas Van Nostrand, and Jian Liu
Figure 6: Filtered waveform on different tables.
(a) Experimental setup
(b) Side view
Figure 7: Experimental setup for hijacking attack: the adver-
sarial coil is stuck on the charger surface.
constant DC wave. To detect and separate each Qi packet segment,
we apply a sliding window on the filtered signal and calculate the
variance of each sliding window centered at time t, which is rep-
resented as winV ar(t). The length of the sliding window is set to
âŒˆfs/2000âŒ‰ to ensure the difference is sufficiently distinct. Therefore,
by setting a threshold Ï„, we can easily determine whether t is in
a packet segment or not. As the duration of a single packet trans-
mission (i.e.,~30 ms) is significantly shorter than the gap between
two adjacent packets (i.e.,~150 ms), we can detect the start time ts
and end time te of each segment by solving the following objective
function:
arg max
ts,te
te âˆ’ ts ,
(2)
s.t ., winV ar(ts), winV ar(te) > Ï„ , tp  200 mV) of the charger [44]. To verify