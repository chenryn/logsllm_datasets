> height="9.679899387576553e-2in"}
> 基于拓扑的情境关联：根据网络故障沿网络拓扑水平传播的特性，
> 通过对大量网
> 络告警事件在拓扑空间中的分布，以及传播时间上的顺序，自动进行网络根本故
> 障源(Root Cause)诊断。
>
> **4.5.4.3** 基于行为的关联分析
>
> 传统的安管平台强调事件关联分析的重要性，尤其是基于规则的关联分析引擎，
> 以期通 过该技术将最关键的安全事件从海量信息中挖掘出来。
>
> 但是，基于规则的关联分析必须依靠规则才能起作用，
> 如果没有规则，或者规则设置不 合理， 就无法发现安全问题。 同时，
> 规则只能描述所已知的安全问题， 无法对未知的安全问 题进行描述。
>
> 基于行为的事件分析的定位在于使安全分析实现向基于异常检测的主动分析模型逆转，
> 从而安管平台的主流分析方式不再强依赖关联引擎。
>
> 关联规则分析依赖于专家经验定义的攻击签名或已知的攻击方法。高级威胁经常没有签
> 名，并且确切的攻击者行为也难以实现预测。事件行为分析是基于异常检测的主动分析模式，
> 它并不是基于静态的关联规则，
> 而是建立被观测对象正常基准行为，通过对实时活动与基准
> 行为的对比来揭示可疑的攻击活动。事件行为分析可以智能发现隐藏的攻击行为，
> 加速确定 没有签名的威胁，减少管理人员必须调查的事故数量。
>
> 下表展示了基于规则的关联分析和基于行为的关联分析的区别：
+----------------------------------+-----------------------------------+
| > 基于规则的关联分析             | > 基于异常行为的关联分析          |
+----------------------------------+-----------------------------------+
| > 模式匹配，准确性较高           | > 推测分析，需要人工核实          |
+----------------------------------+-----------------------------------+
| > 需要预先定义规则               | > 无                              |
|                                  | 需预先定义规则，仅需设定学习参数  |
+----------------------------------+-----------------------------------+
| > 知所已知                       | > 知所未知                        |
+----------------------------------+-----------------------------------+
> 事件行为分析使组织建立各自具体的基线，为他们的 IT
> 计算环境提供更好的信息和更
> 快的异常活动的检测。管理员可以自定义事件基线，更有针对性地观察事件行为趋势，对可
> 疑行为进行预警。
>
> 系统支持两种行为分析技术：
>
> ![](media/image96.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 动态基线技术：采用了周期性基线分析的方法。周期性基线根据历史数据计算得出，
>
> 通常是一个单周期数据库轮廓线。这条曲线由若干数据轮廓点组成。每个轮廓点代
>
> 表一个采样时点。一个新的实际测量值如果没有超过基线范围，则通过加权平均算
> 法更新旧的轮廓值。如果新的实际测量值超过基线范围则丢弃，不参与新轮廓值计
> 算。如此往复循环， 基线始终处于动态变化中。
>
> ![](media/image97.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 预测分析技术：采用了基于时间窗置信区间的检测模型和方法。可以在实际运行中
>
> 不断自我调整和逼近，自动剔除历史时间窗内的异常历史数据，实现历史时间窗数
> 据与网络实际正常流量行为特征的高度吻合，
> 从而提高了对异常行为报警的准确 性。
>
> 在使用方式上，系统采用了基于场景的分析方式。场景定义了行为分析的主体、在该主
> 体上采用的分析指标以及触发行为预警的阈值。行为分析主体就是资产
> IP；行为分析指标表 征某种行为的关键指标，
> 通过对这些指标的监控与分析发现可疑的行为。一般地，将某种类
> 型或特征的事件的数量或比例作为特征指标。例如：用户会关注 Apache
> 服务器日志的数量
> 突变，关注路由器日志数量的突变，关注配置变更类日志的数量突变，
> 关注登录类日志的数 量突变。
>
> 系统内置 14 种行为分析场景的模板，
> 用户可以根据自身需求对模板进行实例化，建立 []{#_bookmark51
> .anchor}任意数量的分析场景实例。
>
> **4.5.5** 可视化安全事件分析
>
> 系统为用户提供了丰富的可视化安全事件分析视图，充分提升了分析效率。
![](media/image98.png){width="4.65625in" height="2.3868055555555556in"}
> 系统可以为用户展示一幅管理对象的拓扑图，反映管理对象的网络拓扑关系，并且在拓
> 扑节点上标注出每个管理对象的日志量和告警事件量。用户点击拓扑节点可以查询事件和告
> 警信息详情。
>
> 针对安全事件， 用户可以对其源目的 IP
> 地址进行追踪，并在世界地图上标注出来。安
> 全分析人员也可以对一段时间内的安全事件进行行为分析，通过生成一幅事件拓扑图形象化
> 地展示海量安全事件之间的关联关系，从宏观的角度来协助定位安全问题。系统能够实时地
> 绘制事件分时图，动态显示不同时段内各种等级事件的数量分布，点击每个分时柱子都能够
> 进行事件钻取和过滤。系统提供了针对事件的多维分析图，可以通过平行坐标轴显示大量事
> 件相对于事件属性的聚合关系，分析人员还能够对分析维度进行自定义。系统提供了针对事
> 件的视网膜分析图， 可以形象地展示事件源目的 IP
> 之间的关系和事件数量。系统提供了事
> 件分析图，可实时展示事件的各类摘要信息和详细信息，
> 可以对用户指定区域或类型的事件
> 进行可视化展示，帮助安全分析师发现行为异常。
>
> 系统提供可视化人机交互界面，安全分析人员可通过可视化方式创建安全关联分析规
> 则、编写算法、生成统计规则， 处理威胁情报等，
> 使日常安全管理和分析工作简单、方便。
> 主要提供可视化关联规则编辑工具、可视化分析算法编辑工具、可视化查询仪表板。
>
> 系统提供针对信息安全风险及价值、威胁和漏洞的可视化分析手段，可视化展示各安全
>
> 域或业务系统的安全态势及风险，威胁变化情况， 并支持数据下钻。
>
> 传统的关联分析以事件为主要分析对象。事件是对 IT 设施的工作过程的记录。
>
> 由于事件自身存在很多局限性，分析出来的结果也难以准确：一方面，透过事件难以还
> 原攻击/违规的事发现场；另一方面，
> 出于各种原因，事件记录可能不全，导致难以作出准 确的研判。因此，
> 对于安全管理系统而言，仅仅分析事件以及与事件相关的情境信息是不够 的。
>
> 要进行更加全面的安全分析，还需要对网络中的流信息进行分析。流(Flow)是
> IP 节 点之间会话信息的记录。
> 流信息能更加详实地再现攻击/违规的事发现场，流分析可以作为
> 事件分析的有力补充。
>
> 系统可以直接接收并分析网络中的流信息，也可以主动的抓取并生成流信息。
>
> 系统的智能化流安全分析主要体现在以下几个方面：
>
> ![](media/image103.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 流分布可视化分析：通过对流信息的统计分析，以可视化的方式展示特定网络访问
>
> 关系下的流量信息，譬如重要业务系统或者服务器的进出流量、各协议流量分布和
> 流量趋势、到办公区的工作日进出流量， 以及重要资产的业务流量可视化，
> 等等。
>
> ![](media/image104.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"} 流行为轮廓建模：借助创新的 vFlow
> 流描述语言， 采用基于行为的分析算法，对流
>
> 信息建立行为轮廓模型， 为后续的流行为合规分析和异常检测奠定基础。
>
> ![](media/image105.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 流行为合规性分析：系统采用基于黑白灰规则集的模式进行流行为合规性分析，帮
>
> 助用户识别违规流行为。流行为可以看作网络中
> IP/业务系统/安全域之间，一段时
> 间内的相互网络连接关系的集合。流行为合规分析就是判定网络节点间的连接关系
> (包括端点 IP/端口、时间、协议、流量等)是否合规。
>
> ![](media/image106.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 流行为异常检测：通过对流行为轮廓的分析，有助于实现对未知攻击行为的辅助研
>
> 判。系统对特定网络流量的分布进行可视化展示与分析，
> 通过内网流行为建模与分 析(而非基于特征) ，发现网络通讯异常，进行 APT
> 攻击辅助研判。系统可以帮
> 助用户识别网络中的异常行为，例如在一台应用服务器上发现 FTP
> 服务且有大量数 据外传、某台 HTTP 服务器的 404
> 错误骤增、来自罕见源地址的访问、罕见的访问 协议、超量的 SSH2
> 数据外传、隐藏 IP 使用，等等。此外， 通过对海量的、大时间
> 跨度的流信息进行数据挖据分析，还可以帮助感知未知安全威胁2
> ，譬如僵尸网络 心跳连接、 DNS 异常，等等。
>
> ![](media/image107.png){width="8.4919072615923e-2in"
> height="9.679899387576553e-2in"}
> 流与安全事件的协同分析：通过将流安全分析技术与安全事件分析技术有机地整合
>
> 到一起，系统能够实现从关联告警事件到原始事件的钻取，再到原始事件发生时段
> 的原始流信息的回溯分析，甚至到原始包数据的回溯3。
>
> 系统通过与 TSOC-NBA (即流采集器)
> 集成，可实现对流和安全事件的协同分析，以及 对 NBA
> 的统一管理和分析，并丰富了系统的分析对象和方法，
> 通过智能化流安全分析功能
>
> 帮助安全管理人员更加有效的发现网络中的违规访问、网络行为异常和安全威胁。
>
> 随着 IT 技术的不断发展和应用， 攻击变得越来越隐蔽和难以发现， 诸如 APT
> 之类的攻
> 击很难被发现和防止，层出不穷的数据泄漏事件和攻击对组织的声誉和财产，乃至国家安全
>
> 2 这里提到的未知威胁检测功能需要另外定制。
>
> 3 要实现包数据回溯，需要另购包捕获和存储设施。
>
> 造成了十分恶劣的影响。大多数组织没有足够的人员、时间、资金、和精力来应对威胁。因
> 此，威胁情报在频繁受到攻击的高风险的重点行业大型企业和政府事业单位中，将会明显提
> 升关联分析的准确性和目标性， 帮助组织有效发现隐藏的威胁。
>
> 根据 Gartner
> 的定义，威胁情报描述了现存的、或者是即将出现针对资产的威胁或危险，
> 并可以用于通知主体针对相关威胁或危险采取某种响应。威胁情报是一种基于证据的知识，
> 包括了情境、机制、 指示器、隐含和实际可行的建议。
>
> 系统集成了威胁情报的功能。系统能够自动同步/导入/抓取来自内外部的威胁情报和漏
> 洞情报并予以利用，提高威胁分析的实效性和准确性。威胁情报主要包括恶意
> IP 和恶意URL，
> 可来自公开的外部安全机构和社区。针对大型企业，可建立自己的情报中心，系统可直接采
> 集来自企业内部情报中心的威胁情报。同时，系统也可以自己产生威胁情报，例如安全分析
> 师发现隐藏的攻击威胁后，可将威胁源的 IP
> 手工添加至动态威胁库中。漏洞情报也可来源
> 于公开的漏洞情报库。系统对采集来的威胁情报形成动态威胁库，将漏洞情报汇入统一漏洞
> 库，一方面进行威胁和漏洞的预警通报与处置，另一方面还能将这些威胁情报用于事件关联