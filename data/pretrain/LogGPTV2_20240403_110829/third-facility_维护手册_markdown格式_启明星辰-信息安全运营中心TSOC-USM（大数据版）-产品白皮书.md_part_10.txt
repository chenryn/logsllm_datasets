### 基于拓扑的情境关联

基于网络故障沿网络拓扑水平传播的特性，通过对大量网络告警事件在拓扑空间中的分布及传播时间顺序进行分析，可以自动诊断出网络的根本故障源（Root Cause）。

### 4.5.4.3 基于行为的关联分析

传统的安全管理平台强调事件关联分析的重要性，特别是基于规则的关联分析引擎。通过该技术，可以从海量信息中挖掘出最关键的安全事件。然而，基于规则的关联分析依赖于预定义的规则。如果没有规则或规则设置不合理，则无法发现安全问题。此外，规则只能描述已知的安全问题，对于未知的安全威胁则无能为力。

基于行为的事件分析旨在实现从基于规则的被动分析向基于异常检测的主动分析模型转变，从而减少对关联引擎的强依赖性。关联规则分析依赖于专家经验定义的攻击签名或已知攻击方法。高级威胁通常没有签名，并且确切的攻击者行为也难以预测。事件行为分析采用异常检测的主动模式，不依赖于静态的关联规则，而是通过建立被观测对象的正常基准行为，对比实时活动与基准行为来揭示可疑攻击活动。这种方法能够智能地发现隐藏的攻击行为，加速识别无签名的威胁，并减少管理人员需要调查的事故数量。

下表展示了基于规则的关联分析和基于行为的关联分析的区别：

| **基于规则的关联分析** | **基于异常行为的关联分析** |
|-------------------------|-----------------------------|
| 模式匹配，准确性较高    | 推测分析，需要人工核实      |
| 需要预先定义规则        | 无需预先定义规则，仅需设定学习参数 |
| 只能发现已知威胁        | 能够发现未知威胁            |

事件行为分析使组织能够为其IT计算环境建立具体的基线，提供更好的信息和更快的异常活动检测。管理员可以自定义事件基线，更有针对性地观察事件行为趋势，并对可疑行为进行预警。

系统支持两种行为分析技术：

1. **动态基线技术**：采用周期性基线分析的方法。周期性基线根据历史数据计算得出，由若干数据轮廓点组成。每个轮廓点代表一个采样时点。新的实际测量值如果没有超过基线范围，则通过加权平均算法更新旧的轮廓值；如果超过基线范围，则丢弃，不参与新轮廓值计算。这样，基线始终处于动态变化中。
   
2. **预测分析技术**：采用基于时间窗置信区间的检测模型和方法。在实际运行中不断自我调整和逼近，自动剔除历史时间窗内的异常历史数据，实现历史时间窗数据与网络实际正常流量行为特征的高度吻合，从而提高异常行为报警的准确性。

在使用方式上，系统采用了基于场景的分析方式。场景定义了行为分析的主体、在该主体上采用的分析指标以及触发行为预警的阈值。行为分析主体通常是资产IP；行为分析指标是某种行为的关键指标，通过对这些指标的监控与分析，可以发现可疑行为。例如，用户会关注Apache服务器日志的数量突变、路由器日志数量突变、配置变更类日志的数量突变以及登录类日志的数量突变等。

系统内置了14种行为分析场景的模板，用户可以根据自身需求对模板进行实例化，建立任意数量的分析场景实例。

### 4.5.5 可视化安全事件分析

系统提供了丰富的可视化安全事件分析视图，以提升分析效率。系统可以展示管理对象的拓扑图，反映其网络拓扑关系，并在拓扑节点上标注每个管理对象的日志量和告警事件量。用户点击拓扑节点可以查询事件和告警信息详情。

针对安全事件，用户可以追踪其源目的IP地址，并在世界地图上标注出来。安全分析人员还可以对一段时间内的安全事件进行行为分析，通过生成事件拓扑图形象地展示海量安全事件之间的关联关系，从宏观角度协助定位安全问题。系统能够实时绘制事件分时图，动态显示不同时段内各种等级事件的数量分布，点击每个分时柱子可以进行事件钻取和过滤。系统还提供了多维分析图和平行坐标轴，用于显示大量事件相对于事件属性的聚合关系，分析人员可以自定义分析维度。系统提供的视网膜分析图可以形象地展示事件源目的IP之间的关系和事件数量。此外，系统还提供了事件分析图，实时展示事件的各类摘要信息和详细信息，帮助安全分析师发现行为异常。

系统提供可视化人机交互界面，安全分析人员可以通过可视化方式创建安全关联分析规则、编写算法、生成统计规则，处理威胁情报等，使日常安全管理和分析工作变得简单、方便。主要工具包括可视化关联规则编辑工具、可视化分析算法编辑工具和可视化查询仪表板。

系统还提供了针对信息安全风险、威胁和漏洞的可视化分析手段，可视化展示各安全域或业务系统的安全态势及风险，威胁变化情况，并支持数据下钻。

### 流安全分析

传统的关联分析主要以事件为主要分析对象。由于事件记录存在局限性，分析结果难以准确。一方面，透过事件难以还原攻击/违规的事发现场；另一方面，事件记录可能不全，导致难以作出准确研判。因此，仅分析事件及其相关情境信息是不够的。

为了进行更全面的安全分析，还需要对网络中的流信息进行分析。流（Flow）是IP节点之间会话信息的记录，能够更加详实地再现攻击/违规的事发现场，是对事件分析的有力补充。系统可以直接接收并分析网络中的流信息，也可以主动抓取并生成流信息。

系统的智能化流安全分析主要体现在以下几个方面：

1. **流分布可视化分析**：通过对流信息的统计分析，以可视化的方式展示特定网络访问关系下的流量信息，如重要业务系统或服务器的进出流量、各协议流量分布和流量趋势、办公区的工作日进出流量，以及重要资产的业务流量可视化等。

2. **流行为轮廓建模**：借助创新的vFlow流描述语言，采用基于行为的分析算法，对流信息建立行为轮廓模型，为后续的流行为合规分析和异常检测奠定基础。

3. **流行为合规性分析**：系统采用基于黑白灰规则集的模式进行流行为合规性分析，帮助用户识别违规流行为。流行为可以看作网络中IP/业务系统/安全域之间，在一段时间内的相互网络连接关系的集合。流行为合规分析就是判定网络节点间的连接关系（包括端点IP/端口、时间、协议、流量等）是否合规。

4. **流行为异常检测**：通过对流行为轮廓的分析，有助于实现对未知攻击行为的辅助研判。系统对特定网络流量的分布进行可视化展示与分析，通过内网流行为建模与分析（而非基于特征），发现网络通讯异常，进行APT攻击辅助研判。系统可以帮助用户识别网络中的异常行为，如在应用服务器上发现FTP服务且有大量数据外传、HTTP服务器的404错误骤增、来自罕见源地址的访问、罕见的访问协议、超量的SSH2数据外传、隐藏IP使用等。此外，通过对海量、大时间跨度的流信息进行数据分析，还可以帮助感知未知安全威胁，如僵尸网络心跳连接、DNS异常等。

5. **流与安全事件的协同分析**：通过将流安全分析技术与安全事件分析技术有机整合，系统能够实现从关联告警事件到原始事件的钻取，再到原始事件发生时段的原始流信息的回溯分析，甚至到原始包数据的回溯。

系统通过与TSOC-NBA（即流采集器）集成，实现对流和安全事件的协同分析，以及对NBA的统一管理和分析，丰富了系统的分析对象和方法，通过智能化流安全分析功能帮助安全管理人员更有效地发现网络中的违规访问、网络行为异常和安全威胁。

### 威胁情报

随着IT技术的不断发展和应用，攻击变得越来越隐蔽和难以发现。诸如APT之类的攻击很难被发现和防止，层出不穷的数据泄漏事件和攻击对组织的声誉和财产乃至国家安全造成了恶劣影响。大多数组织没有足够的人员、时间、资金和精力来应对这些威胁。因此，威胁情报在频繁受到攻击的高风险的重点行业大型企业和政府事业单位中，将会明显提升关联分析的准确性和目标性，帮助组织有效发现隐藏的威胁。

根据Gartner的定义，威胁情报描述了现存的或即将出现的针对资产的威胁或危险，并可以用于通知主体针对相关威胁或危险采取某种响应。威胁情报是一种基于证据的知识，包括情境、机制、指示器、隐含和实际可行的建议。

系统集成了威胁情报的功能。系统能够自动同步、导入或抓取来自内外部的威胁情报和漏洞情报并予以利用，提高威胁分析的实效性和准确性。威胁情报主要包括恶意IP和恶意URL，可来自公开的外部安全机构和社区。针对大型企业，可以建立自己的情报中心，系统可以直接采集来自企业内部情报中心的威胁情报。同时，系统也可以自己产生威胁情报，例如安全分析师发现隐藏的攻击威胁后，可将威胁源的IP手工添加至动态威胁库中。漏洞情报也可来源于公开的漏洞情报库。系统对采集来的威胁情报形成动态威胁库，将漏洞情报汇入统一漏洞库，一方面进行威胁和漏洞的预警通报与处置，另一方面还能将这些威胁情报用于事件关联分析。