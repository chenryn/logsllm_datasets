---
## Page 55
第四章SHELL内部命令
4.3改变SHELL的行为
-t
读取并执行一条命令后就退出。助记词：eαiT，退出
=1
在进行参数扩展时，如果变量没有设置就报错。把错误信息写入到标准错误输出中，并退出非交互
运行的 shell.助记词：Ust，未定义的
=V
在shell读取输入行时把它打印出来。功记词：Vrboas，评细
对于简单命令，for命令，case 命令，Belect命令，命令与其参数或者关联的单词列表里面的算术
运算，则在扩展以后、执行之前，打印跟踪信息。在打印命令及其扩展过的参数之前，先打印扩展后
的 PS4变量。助记词：x，跟踪
进行大括号扩展（参见53.5.1[大括号扩展]，p15）.这个选项默认是打开的。助记词：Brace，大括号
=C
防止使用">”，“>&”和“<>”的重定向覆盖已经存在的文件。时记词：cli=icn，文件冲突
如果打开，则shell函数、命令替换、以及子shell环境中执行的命令会继承ERR陷阱。通常，这些
情况下不会继承ERR陷阱。助记司：ER，错误陷陕
-H
打开"风格的历史替换（参见59[历史的交互使用]，p90）。在交互式的shell中，这个选项默认是打
开的。助记词：Hiotory，历史
助记词：Pbaical，物理路径如果打开，执行诸如cd等改变当前目录的命令时不跟踪符号链接，而使用物理
路径。默认情况下，Bash执行能够改变当前目录的命令时会使用逻辑路径。例如，如果“/usr/eya”是
指向"/usr/local/eys的符号链接，则
$ cd /usr/eye; echo $PWD
/usr/sys
$ cd ..; pwd
/usr
如果打开-P，则
$ cd /usr/sys; echo $PWD
/usr/local/sys
$cd..；pwd
/usr/local
如果打开，则shell函数、命令替换、以及子shell环境中执行的命令，会继承DEBUG和RETURN陷
阱。通常，这些情况下不会继承DEBUG和RETURN陷阱。
如果后面没有其它参数，则重置位置参数：否则，把它们赋值给位置参数，即使它们开头是“”。
表示选项结束，后续参数都会赋值给位置参数。这会关闭"-x”和“v"选项。如果没有后续参数，则不
改变位置参数。
项保存在变量$-中.
剩余的N个参数是位置参数，它们会按顺序分别赋给$1，$2.SN。特殊变量S#设为N.
返回状态总是零，除非指定了无效的选项。
BASH 中文文档
目录
P44
---
## Page 56
4.3改变SHELL的行为
第四章SHELL内部命令
S4.3.2内部命令shopt
本内部命令可以改变shell额外选项的行为。
shopt[-pqeu][-o][选项名称-·]
打开或关闭shell选项以控制shell 的行为。如果没有选项，或者有“p”选项助记词：Pratty-Print，式输出，则显
示所有可以设置的选项，并指示每个选项是否打开。“p”选项使输出的形式可以重新用于输入，其它选项有
下列含义：
设置（打开）选项名称。助记司：Bot，设置
重置（关闭）选项名称。助记司：Dst，重置
9
禁止正常输出，它的返回状态可以提示选项名称是否打开。如果“q”带有多个选项名称，则当所有
的选项名称都打开时返回零，否则返回非零。助记风：Qus，安的硬式
=0
限制选项名称为内部命令Bet（参见54.3.1[内部命令set]、p42）所定义的那些，助记词：0tioa，T的选观
如果指定了“=g”或者“-u"选项而没有选项名称，则只（分别）显示已经打开或关闭的选项。除非特别说明，
shopt选项默认都是关闭的。列出选项时，如果所有选项都打开了，则返回零，否则返回非零。设置或重置
选项时返回零，除非遇到无效的shell选项。shopt有下列选项：
autocd
如果打开，则使用目录名称作为命令就和把这个目录作为cd命令的参数一样。这个选项只在交
互式的 shell 中使用。
cdable_vars
如果打开，并且内部命令cd的参数不是个目录，就把这个参数当成值为目录的变量，并
进入该目录。
cdspel1
如果打开，则自动改正cd命令中对目录名轻微的拼写错误。这些错误包括颠倒的字符，缺少
一个字符，或者多一个字符，如果改正了错误，则打印改正后的路径，并继续处理命令，这个选项只
在交互式的shell 中使用。
Checkhash
如果打开，Bash会在执行命令前检查散列表中的命令是否存在。如果已经不存在，则进行
正常搜索。
checkjobs
如果打开，Bash 会在退出交互式的shell前列出所有正在运行或已经停止的作业状态。如果
有作业正在运行，则延迟退出，直到使用干涉命令（参见57[作业控制]，p69）再次尝试退出。如果有已
经停止的作业，shell 总会延迟退出。
checkvinsize
如果打开，Bash会在执行每个命令以后都检查（终端）窗口大小：如果必要，就更新
LINES 和 COLUMNS 的值.
cndhist
如果打开，Bash会试图把多行的命令的所有行都保存在同样的历史文件中。这使得再次编辑
多行命令变得容易。
conpat31
如果打开，Bash会在处理条件命令的=-时，以第3.1版的方式处理引用。
dirspell
如果打开，Bash会在单词补全时遇到原本不存在的目录后试图改正目录名的拼写。
dotglob
如果打开，Bash会在文件名扩展的结果中包含以"."开头的文件名。
execfail
如果打开，则非交互式运行的shell在用内部命令exec不能执行指定的文件时不会退出。
exec失败时，交互式的shell都不会退出。
p45
目录
BASH 中文文
---
## Page 57
第四章SHELL内部命令
4.3改变SHELL的行为
expand.aliases
如果打开，则按照56.6别名]，p62中所说的对别名进行扩展。这个选项在交互式的
shell中默认就是打开的。
extdebug
如果打开，则启动用于调试的行为：
了
内部命令declare的“-F选项（参见54.2[Bash的内部命令declare]，p36）会显示与每个参数
所指定的函数名对应的源文件名和行号。
2
如果DEBUG陷阱运行的命令返回的值为非零，则忽略下一条命令的执行。
?
如果DEBUG陷阱运行的命令返回的值为2，并且shell正在执行子程序（即shell函数，或者用内
部命令，或source 执行的 shell 脚本)，则模拟return 的调用。
4更新BASH_ARGC和BASH_ARGV变量（参见&5.2|Bash的变量]，p49）-
5
启用函数跟踪：通过“（命令）”而执行的命令替换，shell函数和子shell都会继承DEBUG和RETURN
陷阱。
6启用错误跟踪：通过"（命令)"而执行的命令替换，shell函数和子shell都会继承ERUOR陷阱。
extglob
如果打开，则使用扩展的模式匹配（参见53.5.8.1[模式匹配），p20）。
extquote
如果打开，则对于双引号之间的“$参数}”，还会处理参数里面的“s"字符串"和“$字符
串"引用。这个选项默认就是打开的。
failglob
如果打开，则在文件名扩展中如果模式与文件名不匹配就会导致扩展错误。
force_fignore
如果打开，则在单词补全时会忽略shell变量FIGNORE指定的后缀，即使被忽略的单词
是唯一可以补全的（参见55.2[Bash的变量]，p51）.这个选项默认就是打开的。
globstar
如果打开，则在文件名扩展中“"字符会匹配文件以及零个或多个文件夹和子文件夹。如果这
个模式后面有个"”，则只匹配文件夹和子文件夹。
gnu_errfnt
如果打开，则用标准的GNU错误信息格式输出shell错误信息。
histappend
如果打开，则当shell退出时，把历史记录添加到HISTFILE变量指定的文件中，而不是覆
盖这个文件。
histreedit
如果打开，并且使用了Readlline，则当历史替换失败时给用户提供重新编辑的机会。
histverify
如果打开，并且使用了Readlline，则历史替换的结果不会立即传给shell来解释，而是把结
果的文本加载到Readlline的编辑缓存中以便进一步修改。
hostconplete
如果打开，并且使用了Readlline，则当补全一个含有“的单词时，Bash会试图进行主
机名补全（参见58.4.6[补全命令]，p84）.这个选项默认就是打开的。
huponexit
如果打开，则在交互式的登录shell退出时，Bash会向每个作业发送SIGHUP（参见≤3.7.6[信
号]，p26).
interactive_comments
打开的。
lithist
如果打开，并且打开了cndhist选项，则保存在历史中的多行命令就带有内部换行符，而不是
在必要时使用分号分隔，
1ogin_shell
如果作为登录shell启动就打开它（参见g6.1[Bash的启动]，p55）。这个选项不可以更改。
++++++++++++++++++++******++++++++++++++++++*
BASH 中文文档
目录
p46
---
## Page 58
54.4特殊内部命令
第四章SHELL内部命令
mailwarn
如果打开，并且Bash用来检查新邮件的文件在它上次检查过后已经被访问，则打印邮箱文
件已经被读取过”。
no-enpty-cnd_completion
如果打开，并且使用了Readline，则Bash 不会为补全空行而试图搜索
PATH.
nocaseglob
如果打开，则Bash在进行文件名扩展时对文件名的大小写不敏感。
nocasenatch
如果打开，则Bash在执行caBe命令或[L条件命令并进行模式匹配时对模式的大小写不
敏感。
nullglob
如果打开，则Bash允许不匹配任何文件的模式扩展为空字符串，而不是扩展成自身。
progconp
如果打开，则启用可编程的补全功能（参见多8.6[可编程的补全]，p86），这个选项默认就是打
开的。
pronptvars
如果打开，则对提示符按下述方法扩展以后（参见56.9[提示符的控制]：p64）还要进行参数
扩展，命令替换，算术扩展和引用去除。这个选项默认就是打开的。
restricted shell
如果shell以受限制的模式（参见56.10[受限制的shell]，p66）启动就打开它。这个选
项不可以更改。在执行初始化文件时也不会重置它，这使得初始化文件可以检测一个shell是不是受
限制的。
shift_verbose
如果打开，则当移动的数目超过位置参数的数目时，内部命令Bhift会打印一条错误信
息。
sourcepath
如果打开，则内部命令Bource会用PATH会搜索参数中指定文件所在的目录。这个选项默
认就是打开的。
xpg.echo
如果打开，则内部命令echo默认会扩展转义字符序列。
列出选项时，如果所有选项都打开了，则返回零，否则返回非零，设置或重置选项时返回零，除非遇到无效
的 shell 选项。
$4.4
特殊内部命令
由于历史的原因，POSIX标准把几个内部命令归入到特殊的类别。当Bash在POSIX模式下运行时，
这些特殊的内部命令和其它内部命令有三个不同的方面：
①在搜索命令时，特殊命令的搜索先于shell函数。
②如果特殊命令返回错误状态，则非交互运行的shell就会退出。
③命令前面的赋值语句在命令结束以后仍然对shell环境有影响。
当Bash不是在POSIX模式下运行时，这些内部命令和其它内部命令的行为没有什么不同。Bash的POSIX
模式在g6.11[Bash的POSIX模式]，p67中详细介绍。
下面是POSIX规定的特殊内部命令：
break
continue
eval
exec
exit
export
readonly
return
Bet
shift
trap
unset
P47
目录
BASH 中文文
---
## Page 59
第五章SHELL变量
第五章Shell 变量
本章介绍shell中所使用的变量，Bash会自动给其中一些变量赋默认值。
$5.1
波恩Shell的变量
Bash使用一些和波恩shell同样的变量。有时，Bash会给它赋默认值。
CDPATH
冒号分隔的一组目录名，用作内部命令cd的搜索路径。