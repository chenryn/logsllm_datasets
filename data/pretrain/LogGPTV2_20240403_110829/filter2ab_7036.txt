### Title: Reverse Engineering the Customized Pointer Authentication Hardware on Apple M1: Four Years Later

Since 2018, Apple has integrated Pointer Authentication (PA) into all of its silicon-based products to enhance system security. Numerous security researchers have conducted in-depth analyses of the PA mechanisms deployed by Apple. Notably, in a 2019 blog post titled "Examining Pointer Authentication on the iPhone XS," Brandon Azad from Project Zero highlighted that Apple employs some unspecified "dark magic" in their PA hardware. This custom implementation allows the PA on Apple Silicon to defend against cross-EL/Key attacks without requiring additional software support.

Despite the passage of four years, the specific details behind these cross-attack mitigations remain largely unexplored. Our research reveals that this customized PA (referred to as Apple PA) is also present in the Apple M1 chip. Additionally, we discovered that Apple has implemented hardware-level read/write protection for the PA key registers. This protection makes it challenging to reverse-engineer the Apple PA, as it prevents direct control over the values of the PA key registers once the PA is enabled.

To circumvent this protection, we developed new techniques leveraging another hardware feature of the Apple M1: the Virtualization Host Extension (VHE). Using these techniques, we successfully uncovered the new PA hardware, including the registers and instruction behaviors introduced by Apple. Specifically, we found that Apple introduces three new diversifiers and a per-key-type key transformation. These enhancements enable the implementation of four types of cross-attack mitigations (Cross-VM, Cross-Key, Cross-Boot, and Cross-EL) at the hardware level.

This research provides valuable insights into the sophisticated security measures embedded in the Apple M1, contributing to a better understanding of the advanced PA mechanisms and their role in protecting modern computing systems.