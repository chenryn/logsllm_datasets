2010 through September 2013), corresponding to Datasets 2 and
3.3 We start with an analysis of the whole interval, before looking
into the dynamics of the search results.
5.1 Overview
We focus here on pharmaceutical goods, where we identify sev-
eral different categories of search results issued in response to queries
containing drug names. For the sake of comparison, we use some
of the deﬁnitions provided in our earlier work [15], extending this
taxonomy whenever required.
Licensed pharmacies, are those having been veriﬁed by Legit-
script [19].
3Recall that the information available from Dataset 1 is too coarse
to be useful in this section.
Health resources, associated with (usually benign) websites, and
providing information about drugs. We use information from the
Open Directory Project [8] to make that determination.
Unlicensed pharmacies, characterized as such by Legitscript and
directly appearing in the organic search results.
Content injection (blog and forum spam), which point to discus-
sion websites with drug-related spam posts. We identify such sites
through URL parameter names they commonly use—containing
terms such as “blog,” or “forum” for instance.
Search-redirections, as deﬁned in Section 3. Domains in this cat-
egory have generally nothing to do with prescription drugs and are
merely used as a feed to online pharmacies.
Content injection (compromised), which represent websites other
than blogs and forums, in which an attacker injected drug-related
content, but never exhibit signs of search-redirection. For this cat-
egory, we consider the characteristics of URLs that are search-
redirecting with embedded storefronts; the FQDNs contain no drug-
or pharmacy-related keywords, while the trailing paths do. We then
apply this heuristic to the set of results not placed in any of the pre-
cious ﬁve categories.
Finally, we mark as unclassiﬁed sites that do not ﬁt into any of
the above categories.
Result category
Active search-redirection
Unclassiﬁed
Unlicensed pharmacies
Health resources
Blog & forum spam
Content injection (compromised)
Future search-redirection
Inactive search-redirection
Licensed pharmacies
Total
% of results Range (%)
[8.7, 61.7]
[6.3, 35.4]
[12.1, 30.1]
[4.2, 14.5]
[3.0, 16.4]
[1.9, 10.0]
[0.0, 6.7]
[0.0, 10.6]
[0.0, 0.9]
38.8
18.8
16.9
7.7
7.1
4.7
4.1
1.8
0.2
# of results
621 623
300 427
271 045
123 883
113 250
74 556
65 548
28 976
2 779
1 602 087
Table 3: Search-result composition. Results collected between
November 2010 and September 2013.
Table 3 shows the breakdown of results in each category over the
roughly three years that T2 and T3 span. We combine Datasets 2
and 3 by sampling Dataset 2 as described in Section 4. In the end,
we examine 1 602 087 search results over the entire interval. Out of
those, more than 38% are active redirections; on any given day be-
tween 8.7% and 61.7% of the obtained results actively redirect. In-
active and future redirects represent another 5.9% altogether, while
blog and forum spam, and compromised sites, taken together, ac-
count for another 11.8%. Shortly stated, the vast majority of results
are illicit or abusive. Particularly telling is the fact that legitimate
pharmacies only consist of 0.2% of the entire results!
The fairly large proportion of “unclassiﬁed” results (18.8% of all
results) led us to further examine them. Unclassiﬁed results may
be (i) benign websites with information about drugs, (ii) malicious
websites (compromised or redirections) that we failed to identify
as such, or (iii) results only marginally related to the search query.
We need to obtain the contents of these sites rather than their mere
URL to make this determination. By using the Internet Archive
Wayback Machine [26], we attempted to access the content of all
45 213 unclassiﬁed results collected in 2013. We managed to ﬁnd
matches archived roughly at the time of our own crawls for 41 547
of them. 14 993 (33.1%) of the examined unclassiﬁed results did in
fact contain drug-related terms. Given that they were not legitimate
pharmacies or health resources (otherwise they would have been
classiﬁed as such), this is a strong indication that a non-negligible
number of unclassiﬁed results may actually present some form of
illicit behavior.
5.2 Search result dynamics
In Figure 2, we examine how search results, which appear to be
dominated by malicious links, dynamically evolve over time. The
graph shows, as a function of time, the proportion of results be-
longing to each category, averaged over a 7-day sliding window.
Vertical lines denote events of interest that occur during data col-
lection. In particular, C1 corresponds to the switch from Dataset 2
to Dataset 3, and C2 corresponds to an update in our crawler to
detect more advanced types of search-redirections. From late 2010
through late 2012 active redirects have not only been dominating
the search results, but they have also been steadily growing to a
peak of nearly 60%. Meanwhile, unclassiﬁed results are decreas-
ing overall, unlicensed pharmacies remain stable around 15–20%,
and licensed pharmacies constantly hover near zero. Spam contents
seems to marginally decrease until late 2012 as well.
Then, in early 2013 we notice a change in trends: active redi-
rections seem to ﬁnally decrease somewhat steadily, while, on the
other hand content injection (both spam and compromised web-
sites), as well as unclassiﬁed results enjoy a bit of a resurgence.
Even more interestingly, we also observe that unlicensed pharma-
cies mirror very closely the trend of active redirections in 2013.
Whenever redirections become more frequent, direct links to unli-
censed pharmacies become rarer, and vice versa. This suggests that
attackers use direct links to pharmacies as a kind of alternative to
search redirections.
Search-engine interventions. The lines marked G1, G2 and G3
correspond to documented changes in search-engine behavior. We
examine their impact on the search results using the Mann-Whitney
non-parametric U-test of signiﬁcance, and data we collected within
30 days before and after each event.
On February 23, 2011 (G1) Google deployed an improved rank-
ing algorithm to demote low quality search results [24]. This ap-
parently caused a statistically-signiﬁcant drop in redirecting results
by 2.3% (p = 0.003), and by 2.7% for spam websites (p < 0.001).
However, the improvement was only transient: Starting in May
2011 we observe a sharp increase until August 2011 in the propor-
tion of results that are actively redirecting. Speciﬁcally, the median
difference in the proportions of redirecting results collected in April
and in June of 2011 shows an increase by 15.5% (p < 0.001). Ap-
parently, after being initially impacted, attackers managed to ﬁnd
countermeasures to defeat Google’s improved ranking algorithm.
Between October 2011 (G2, [12]) and March 2012 (G3, [23]),
Google updated its service again to gradually remove information
from the HTTP Referrer ﬁeld about the query that produced the re-
sult.
In theory, this should have reduced active redirects, which
originally relied primarily on the Referrer information to deter-
mine how to handle incoming trafﬁc. In practice, the effect was
non-existent, as redirects continued increasing in the time interval
G2–G3. Indeed, comparing the proportion of results identiﬁed as
redirecting within 30 days before G2 and 30 days after G3, we ﬁnd
a statistically-signiﬁcant median increase by 9.9% (p < 0.001).
Here again, attackers seem to have been able to adapt to a coun-
termeasure from the search engine. Furthermore, since Google an-
nounced the change well in advance of its implementation in or-
der to accommodate the many legitimate websites affected by the
change, those perpetrating poisoning attacks also had plenty of time
to adapt before being adversely impacted.
Browser evolution. A series of major changes to Internet browsers
occurred in the second half of 2012 and beginning of 2013. On July
17, 2012 (B1) Firefox 14 was released. This was the ﬁrst major
browser (roughly 25% of reported market share at the time accord-
ing to StatCounter) to use HTTPS search by default, which only
lists the previous domain (but no URL parameters) in the Referrer.
On September 19, 2012, Safari followed suit (B2); and on January
13, 2013, Google Chrome, the browser with the dominant mar-
ket share also switched to HTTPS search (B3). At that point, the
majority of desktop browsers were using HTTPS search by default.
Perhaps coincidentally, we started observing a stagnation and even-
tual decrease in the number of active redirections. While we em-
phasize we cannot afﬁrm causality, a plausible explanation is that
traditional, simple Referrer-based redirection techniques, by early
2013, stopped working for a large proportion of the population,
which led to alternative techniques being used (e.g., cookie-based
redirections). We periodically still see some large spikes (e.g., in
early Summer 2013), perhaps attributable to short-lived campaigns.
We conversely observe an increase in “direct advertising” of unli-
censed pharmacies.
Top-10 search results. The previous discussion deals with the
overall evolution of search results. However, Joachims et al. [9]
have shown that 98.8% of users click on results that appear in the
ﬁrst 10 positions. To verify that malicious search results are posi-
tioned high enough in the search results to drive signiﬁcant trafﬁc,
we focus in Figure 3 on the evolution of the top-10 search results
to our queries.
While the previous observations are still valid at a high-level for
the top-10 results, we point out that the actively redirecting results
occur about 10% less frequently on a daily basis; unfortunately,
organic results pointing directly to unlicensed pharmacies are con-
versely 10% more frequent.
Among the top-10 results, we also brieﬂy examine the top search
result (not represented in the ﬁgure), and observe that here too, an
overwhelming proportion of the results consist of direct links to
unlicensed pharmacies and active search redirections. Direct links
to unlicensed pharmacies appear to occur slightly more often at the
top result than in the rest of the top-10 results overall.
Undetected infections. An alternative explanation for the plateau-
ing and decrease of search-redirections observed since early 2013
might be that attackers’ tactics have evolved, and are not captured
by our crawlers anymore. To determine whether that is the case, we
take a closer look at the “unclassiﬁed” category. Recall, that from
April 2012 (C2) through the end of our measurement interval, we
record the ﬁrst 200 lines of HTML code of each source infection,
posing both as a search-engine spider, and as a regular browser.
When we observe a difference in the HTML returned between the
two treatments, we infer there might have been cloaking.
In February 2014, we submitted to VirusTotal [27] the 213 705
unique samples we had collected (based on their SHA1 hash) for
examination. The idea was that evidence of malicious injections
in webpages (e.g., JavaScript redirects as used by RedKit [18] or
other variants described earlier [2]) would likely be detected by at
least some malware URL blacklists.
Figure 4 presents the proportion of unclassiﬁed results detected
as malicious by VirusTotal. Typically, the malicious websites con-
tain trojans (such as JS/Redirector.GR), backdoors (such as
PHP/WebShell.J, or C99), and exploits (for instance, the no-
torious HTML/IframeRef.AS). Overall, 19.5% of unclassiﬁed
results appear as malicious. We see that websites with malicious
content are relatively infrequent when search-redirection attack is
experiencing its peak towards the end of 2012 (Figure 2). How-
ever, in 2013 we observe an increase of malicious websites among
unclassiﬁed results. This may be an indication that miscreants are
Figure 2: Percentage of search results per category, averaged over a 7-day sliding window. Minor categories are excluded. The
vertical lines correspond to documented changes in search-engine behavior (G1, G2, G3), browser behavior (B1, B2, B3) and in our
own collection infrastructure (C1, C2).
Figure 3: Similar to Figure 2, but examining only the top-10 search results.
rections still constitute the largest proportion of results for the query
set we used.
5.3 User intentions
Our measurements appear to point at a large amount of mali-
cious search results overall. A natural question is then whether or
not users are actively looking for questionable results.
If that is
the case, it would then be hard to fault search engines for actually
providing the users with what they are seeking.
To answer this question, we assess the impact of user intentions
on search results by plotting, in Figure 5, the proportion of results
we get for illicit, gray, and benign queries over time. The key take-
away is that regardless of the type of query, active redirects dom-
inate results. Unlicensed pharmacies also appear signiﬁcantly not
only in the results for illicit queries, but also for gray queries. We
therefore reject the notion that active redirects only appear in search
engines because users are seeking access to unlicensed pharmacies.
Rather, unlicensed pharmacies appear to be successfully poisoning
search results regardless of the queries’ intent.
6. CLEANUP-CAMPAIGN EVOLUTION
Thus far we have examined how the proportion of search results
with search-redirection attacks has changed over time. This helps
in understanding the overall attack impact, and gives us a sense of
Figure 4: Percentage of unclassiﬁed search results detected
as malicious based on the content by VirusTotal (May 2012–
August 2013).
increasingly using other forms of manipulation our crawler did not
detect, like JavaScript-based compromises. However, returning to
Figure 2, this potential increase in infections does not compensate
for the decrease observed in redirections overall. At most one third
of all unclassiﬁed results (up to 7% of all results in 2013) are com-
promised in this way, whereas the active redirections have them-
selves dropped by roughly 20 percentage points.
Despite the decrease observed in 2013, claiming success in solv-
ing the search-redirection problem would be a stretch. Indeed, redi-
2011201220130102030405060Evolution of search resultsDate% of search resultsG1G2G3C1C2B1B2B3Active redirectsContent injection (blog/forum)Content injection (compromised)Unlicensed pharmaciesLicensed pharmaciesHealth resourcesUnclassified20112012201301020304050Evolution of top 10 search resultsDate% of search resultsG1G2G3C1C2B1B2B3Active redirectsContent injection (blog/forum)Content injection (compromised)Unlicensed pharmaciesLicensed pharmaciesHealth resourcesUnclassified2013101520253035Detected infections in unclassified results% of unclassified resultsing in the search results.4 Thus, source infections can be “cleaned”
in two ways: either the responsible webmaster removes the infec-
tion that triggers the redirection or the website gets demoted from
the search results because the search engine detects foul play.