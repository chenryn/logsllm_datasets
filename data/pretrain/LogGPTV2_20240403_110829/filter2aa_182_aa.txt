Advancing Video Attacks
with video interception, recording, and replay
Defcon 17
July 31st, 2009
Jason Ostrom
Arjun Sambamoorthy
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Agenda
Introduction
Overview of UC
Live demo of Video Eavesdropping
Live demo of Video Replay and Video Hijack
VoIP Pentesting trick
Conclusion
DefCon 17
2
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Introduction
 About VIPER Lab 
 VIPER ~ Voice over IP Exploit Research
 Security research lab dedicated to finding 
 New UC / VoIP attack vectors
 Structural vulnerabilities in insecure protocol / deployment / 
configuration
 Penetration testing team specialized in VoIP / UC Security
 Passionate about VoIP / UC Security
 Replicated a production, enterprise network in VIPER Lab
 Security assessment professionals supported by research and 
exploit developers
DefCon 17
3
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Introduction
 Who we are
• Jason
• Arjun
DefCon 17
4
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Agenda
Introduction
 Overview of UC
 UC Definition
 UC Business Cases
 New UC Attacks
Live demo of Video Eavesdropping
Live demo of Video Replay and Video Hijack
VoIP Pentesting trick
Conclusion
DefCon 17
5
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
What is UC?
 Unified Communications
Voice (VoIP)
Video (IP Video)
Presence and IM
CTI (Computer Telephony Integration) –
Desktop Integration
 Unified Messaging
Voice mail and Email in the same Inbox!
DefCon 17
6
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
The Business Risk
Today our presentation will focus on IP Video exploits
Low awareness as to security threats
• Security practitioners and IT managers are being pulled into projects 
to support these new video deployments.  But until now, no tools 
have existed for carrying out testing of IP video vulnerabilities.
Video application rollouts as a business driver and ROI
But what about security?
• Can an attacker gain privileged access to IP data network through 
Video infrastructure?
• How can the IP network be exploited through addition of new video 
applications?
• How can the video applications themselves be attacked?
DefCon 17
7
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Real-world Business Examples 
 IP Video 
Private IP Video Calling
Video Conferencing, or “Telepresence”
 IP Video Surveillance
 Video Streaming Applications
 IP TV
 Others?
DefCon 17
8
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
IP Video Business Case
 IP Video 
 Private IP Video calls between individuals
 IP Video Handsets (hard phones)
 IP Video soft phone applications
 Many drivers for enabling the business with increased 
productivity, cost-savings, and enhanced features
 Allows remote workers to communicate “in person”
DefCon 17
9
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Telepresence Business Case
 Telepresence
 HSBC rollout:  Saved company US $604,000 in air travel bills
DefCon 17
10
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Telepresence Business Case
 Telepresence
 Wachovia:  Reduced air travel bills as a result of Telepresence solution
DefCon 17
11
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
IP Video Surveillance Case
 IP Video Surveillance
 IP-based Video Surveillance systems
 Video Analytics applications
 Government, Military, Banks, Casinos, Museums
DefCon 17
12
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
IP Video Streaming Applications:  
Business Case
 IP Video Streaming Applications
 Entertainment venues
 Professional sports stadiums
 Real-world examples
 “America’s Team”
DefCon 17
13
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Cowboys Stadium
DefCon 17
14
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Cowboys Stadium
DefCon 17
15
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Cowboys Stadium
DefCon 17
16
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Cowboys Stadium Details
 Price Tag:  US $1.1 Billion Dollars
 Cisco Connected Sports Technologies
 Cisco StadiumVision
 Integrates hi-def video, audio, and digital content into interactive services for fans
 New revenue streams in advertising with targeted and tailored promotions to HDTV
 All video traffic carried over IP Network
 240 miles of fiber optic cable
 2,800 TV Monitors
 Each TV Monitor has an IP address
 Concession stand menus
 TVs in suites
 Electronic advertising signs
DefCon 17
17
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Cowboys Stadium Details
 180 Wireless Access Points
 Technology Conference Room, Technology Auditorium
 Technology providers can bring their clients to hold meetings and demo products
 Enough bandwidth to send Hi-Def video from the game to 
Cowboys Valley Ranch video editing studio, then back to Arlington 
during halftime.  The highlights will be played on the new 
stadium’s video screens.
 (2) 60-yard-long HDTV Video boards are largest in the world
 Manufactured by Mitsubishi
 US $40 Million dollar price tag
 RFID imbedded bracelets for children, so parents can quickly 
locate them
DefCon 17
18
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Yankee Stadium
DefCon 17
19
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Toronto Blue Jays
DefCon 17
20
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
New UC Attacks
 Video Replay
 Example 1:  Video replay against an IP video surveillance system by 
playing a safe video stream, creating a “blind camera” scenario.  
Malicious events transpire while human operator can’t see what is 
really happening.
 Example 2:  An attacker can intercept a live video conference 
presented by the CEO, and replay the CEO’s previous conference, 
or a private video session he had with the CFO, in which he told the 
CFO that they would have layoffs.
DefCon 17
21
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
New UC Attacks
 IP Video Hijack (Video interception)
 A Video interception DoS attack in which we can target a uni-
directional RTP video stream, or target specific video endpoints in 
the middle of a SIP or SCCP video call.
 Example 1:  In the middle of a high-profile sporting event, the 
attacker can play a random movie clip (including porn).
 Example 2:  In the middle of an important video conference, the 
attacker intercepts the video stream to play a random movie clip, 
(including porn).
DefCon 17
22
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
New UC Attacks
 Video Eavesdropping (Video Recording)
 Example 1:  Eavesdropping on a private IP video call between the 
CFO and CEO.
 Example 2:  Eavesdropping on a video conference.
 Example 3:  Re-constructing a safe video stream to play in a loop 
against a video surveillance camera.
DefCon 17
23
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
Agenda
Introduction
Overview of UC
 Live demo of Video Eavesdropping
 Overview
 Requirements
 Live Demo:  UCSniff Version 3.0
Live demo of Video Replay and Video Hijack
VoIP Pentesting trick
Conclusion
DefCon 17
24
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
UCSniff 1.0
Released November 2008
• Website:  http://ucsniff.sourceforge.net
• Follow UCSniff on Twitter:  http://twitter.com/ucsniff
First Sniffer software to support new G.722 audio codec 
Combined the following features together, to more rapidly test for 
eavesdropping:
• MitM ARP Poisoning
• Automated VLAN Discovery and VLAN Hop
• Auto re-construction of forward, reverse media into single WAV file
Target Mode
• We can intercept and log Skinny keypad messages
• Theft of voice mail passwords
DefCon 17
25
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
UCSniff 1.0
Code design links signaling (SIP, SCCP) and RTP media together
• Recording starts via SIP or SCCP message
• Dynamically adds an RTP dissector when call starts
• Closes RTP dissector when call ends
Result of this Design:  We can tell who is calling, not just a random 
IP address or media stream.  I don’t like to spend a lot of time 
looking through media files.  We log who and when into the file.
In security testing, time is money; therefore, you have to move 
fast.  UCSniff wraps all necessary features into a single tool.
DefCon 17
26
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
UCSniff 1.0
ACE Corporate Directory download feature
• Can target VoIP users based on name and extension
DefCon 17
27
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
UCSniff 2.0
Released February 2009
First IP Video Sniffer / IP Video eavesdropping security tool
Supports H.264 Video Codec
DefCon 17
28
Sipera Confidential - Do not reproduce or distribute without express written consent
© 2008 Sipera Systems, Inc. All Rights Reserved. 
UCSniff 2.1
Released April 2009
Eavesdropping on Microsoft OCS IM Conversations
Support for Avaya SIP 
Enhanced ARP Poisoning with Unicast ARP Requests
Support for G.711 a-law Codec