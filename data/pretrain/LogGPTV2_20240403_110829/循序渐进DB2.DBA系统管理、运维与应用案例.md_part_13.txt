是否条带化
SMS表空间可以简化管理，
特
尽管下面的表3-1并不全面，但是它包含在DMS、
那么，应该选择哪种表空间设计呢？下面我们来看看这几种表空间的比较。
SMS表空间需要的维护非常少。但是，与DMS表空间相比，SMS表空间提供的优化
1.DMS、SMS与DMS自动存储比较
·数据库管理的空间（Database-Managed Space，DMS）：在这里，由DB2数据库管理
DMS的自动存储（AutomaticStorageWithDMS）：自动存储实际上不是一种单独的
以简化表空间管理。
需要比较多的维护（见后面的3.2.2节），在DB2V8.2.2中引I入了DMS自动存储
表空间类型，而是一种处理DMS存储的不同方式。因为数据库管理的空间DMS
程序控制存储空间。表空间容器可使用文件系统或裸设备。
64GB（4KB页面）
不太好
甚至不需要
最好：很少需要调优，
按需增长/收缩
操作系统
Version8
是
SMS
表3-1DMS、
，DMS可以提高性能，除此之外，
2TB（4KB页面）
很好：可通过利用裸设备多获得5%
好，但是需要一些调优（例如
到10%的收益
EXTENTSIZEPREFETCHSIZE)
是需要DBA干预
预先分配；大小可以收缩和增长，但预先分配：可以自动
DB2
无
是
自动存储和SMS表空间的比较
DMS
自动存储和SMS表空间之间进行
，这两种存储模型之间最显
2TB（4KB页面）
用裸设备
最好：但是，不可以使
甚至不需
最好：很少需要调优
DB2
Version9
是
更多资源请访问www.ckook.com
自动存储
要
---
## Page 82
的简化管理获益。
的时候DBA必须定义使用的表空间的所有特征，但是许多应用程序都会从自动存储提供
于在最初启用了自动存储的数据库，也不能在以后禁用这个特性。
自动存储。对于在最初没有启用自动存储的数据库，不能在以后启用这个特性。同样，
存储进行管理”，它的容器由DB2根据这些存储路径进行分配。数据库只能在创建时启用
盖这个设置。
地分配表空间。在DB2V9中，数据库在创建时默认将启用自动存储，除非DBA显式地覆
空间容器时可以使用的存储路径。DBA不必显式地定义表空间的位置和大小，系统将自动
限制的其他方法，但是最简单的方法可能是一开始就使用DMS表空间。
初始大小
下）。如果将页面大小改为32KB，可用空间可以增长到16TB。尽管还有让表大小突破64GB
简便性
管理的
容器的修改
调整
容器大小的在默认情况下，表空间大小的自动调整是关在默认情况下，表空间大小的自动调整是打
容器的创建
特
启用自动存储的数据库有一个或多个相关联的存储路径。表空间可以定义为“由自动
引入自动存储模型的主要目的是简化DMS表空间的管理，同时保持其性能特征。有
下面的表3-2总结了管理DMS非自动存储和DMS自动存储之间的一些差异。
DB2V8.2.2引入了自动存储的概念。自动存储允许DBA为数据库设置在创建所有表
2.DMS与自动存储
必须在创建表空间时显式地提供容器
间相关联的容器
可以使用重定向的恢复操作重新定义与表空
等等）执行容器修改操作
(ADD、DROP、BEGINNEWSTRIPESET
可以使用ALTERTABLESPACE语句
始大小
不能使用INITIALSIZE子句指定表空间的初
闭的（AUTORESIZENO)
表3-2管理DMS非自动存储和DMS自动存储间的差异
非自动存储
空间相关联的容器，因为由DB2控制空间
管理
不能使用重定向的恢复操作重新定义与表
空间管理
不能执行容器修改操作，因为由DB2控制
使用INITIALSIZE子句指定表空间的初始
开的(AUTORESIZEYES)
DB2自动地分配
不能在创建表空间时提供容器：它们将由
第3章
自动存储
创建数据库和表空间
更多资源请访问www.ckook.com
对
---
## Page 83
的选项就是数据库的名称。数据库的命名规则是：
CREATEDATABASEMYDB
文件夹中选择CommandLineProcessor，或者从操作系统命令行执行命令db2cmddb2。
程序（CommandLineProcessor，CLP)。调用方法是在DB2程序组的CommandLineTools
命令和创建数据库向导来创建数据库，下面我们分别讲解如何使用这两种方法创建数据库。
数据库，这个我们已经在第1章讲过了。除此之外我们还可以通过CREATEDATABASE
3.1.3创建数据库
建数据库。
循序渐进DB2——DBA系统管理、运维与应用案例
您会问“就这么简单？”，是的，就这么简单！CREATEDATABASE语句中唯一必需
创建DB2数据库的语法如下：
从命令行创建DB2数据库是相当简单的。要创建数据库，必须调用DB2命令行处理
创建数据库有很多方法，我们可以选择在安装后打开“DB2第一步”启动面板来创建
·数据库名称或数据库别名是一个唯一的字符串，包含前面描述的1个到8个字母、
·数据库名称可以由以下字符组成：a-z、A-Z、0-9、@、#和S。
1.使用命令创建数据库
既然已经熟悉了不同类型的表空间，就该创建第一个数据库了。下面我们讲解如何创
3.DB2存储模型小结
·数据库是一个对象集合，包括表、索引、视图、大对象和触发器等；
经过上面的讲解，我们对数据库、表空间、容器和数据库对象做个总结：
DBM或IBM。注意，数据库名称不能超过8个字母。
名称中的第一个字符必须是字母表字符、@、#或S：不能是数字或字母序列SYS、
大小和容器类型。
数字或键盘字符。
应该主要根据性能和维护因素决定要使用的表空间类型、扩展数据库大小、数据页
定义）个数据页（datapage）组成的，数据页是最小的存储单位；
表空间是由很多扩展数据块（extent）组成的，而extent又是由extentsize（我们可自己
表空间容器可以选择使用底层存储一文件系统、裸设备或操作系统目录；
表空间可以由操作系统管理（SMS），也可以由DB2管理（DMS、自动存储）
这些对象存储在表空间中，表空间由表空间容器组成；
更多资源请访问www.ckook.com
---
## Page 84
选项。
时表空间外，所有表空间默认都将定义为自动存储（DMS）表空间。
DATABASE命令会为上面列出的所有对象创建SMS表空间。在DB2V9中，除了系统临
CREATEDATABASE命令。
据库文件的位置，或者改变DB2管理这些对象的方式。接下来，我们将更详细地研究
品的路径。
配置信息、历史文件和3个默认的表空间。这些表空间是：
致什么情况。
对于从DB2V8进行迁移的用户，有一个特殊的注意事项：在DB2V9之前，CREATE
对于简单的应用程序，这个默认配置应该可以满足需要。但是，
数据库选项
DB2CREATEDATABASE命令的完整语法很复杂，下面说明了DBA感兴趣的大多数
2)CREATEDATABASE命令
·SYSCATSPACE：这是保存DB2系统编目的地方，系统编目跟踪与DB2对象相关
CREATE DATABASE 选项：
所有这些文件都放在默认安装路径的DB2目录中。默认安装路径通常是安装DB2产
在发出CREATEDATABASE命令时，DB2会创建许多文件。这些文件包括日志文件、
1）DB2创建了什么
当然，有很多选项可供使用；不必只输入名称。我们来研究一下这个命令实际上会导
USERSPACE1：默认情况下存放所有用户对象（表、索引I）的地方。
-AUTOMATICSTORAGE--NOIYES--I
TEMPSPACE1：DB2用来放置分组、排序、连接和重组中间结果的临时工作区域。
联的所有元数据，即通常所说的“数据字典”。
-CREATE-
ALIAS--database-alias-
ON-
-DB
-drive-
t-path--
+-DATABASE-+-database-name-+
-DBPATH,ON-
-dr1
-lDatabaseoptions1-A
第3章创建数据库和表空间
，我们可能希望改变数
更多资源请访问www.ckook.com
-->
->
---
## Page 85
60
在哪里创建数据库。如果没有指定路径，就会在数据库管理程序设置(DFTDBPATH参数）
循序渐进DB2——DBA系统管理、运维与应用案例
STORAGE--
-UsINGcODESETcodeset-TERRITORY--territory-
CREATEDATABASE命令的参数之一是ONpath/drive选项。这个选项告诉DB2希望
--MANAGEDBY------
tblspace-defn:
数据库位置
下面我们将学习这些选项以及如何使用它们。
表空间选项
+-SYSTEM
-AUTORESIZE--+-NO-
I-PREFETCHSIZE--number-of-pages-
-AUTOMATIC
+-DATABASE
-COLLATEUSING--+-COMPATIBILITY--+-
-MAXSIZE-
-integer---KIM|G-
+-NONE-
-YES-.
+-IDENTITY--
.-SYSTEM--
+-K|M|G-
-INITIALSIZE-
2十
integer
+-K|M丨G-+-!
更多资源请访问www.ckook.com
-+->
---
## Page 86
在这两种情况下，都必须提供容器的显式列表。
MANAGEDBYDATABASE子句。使用这些子句会分别创建SMS表空间和DMS表空间。
化日常的表空间维护，但是与重要的大型生产表相关联的表空间可能需要DBA更多地干预。
CREATETABLESPACE TESTMANAGED BYAUTOMATICSTORAGE
是表空间的容器的位置。其他的选项是：
例如，下面的数据库创建语句将为数据库中的所有表空间设置自动存储。
以使用的存储路径。DBA不必显式地定义表空间的位置和大小，系统将自动地分配表空间
CREATEDATABASEMYDBNDDATA
上的DATA目录中：
中指定的默认数据库路径上创建数据库。
在没有启用自动存储的数据库中创建表空间时，必须指定MANAGEDBYSYSTEM或
在这个命令中，可以提供与表空间相关联的任何参数；虽然使用自动存储可以大大简
选择Automaticstorage（默认设置）允许DBA为数据库设置在创建所有表空间容器时可
例如，以下的CREATEDATABASE命令将数据库放在Windows操作系统的D驱动器
C:\IBM\SOLLIB\BIN>db2 get dbmCfg1find/"DFTDBPATH"
当使用AUTOMATICSTORAGE定义表空间时，不需要提供其他参数：
·MAXSIZENONE：表空间的最大大小没有限制。如果DBA希望限制一个表空间可
·AUTORESIZEYES：当表空间用光空间时，系统将自动地扩展容器的大小。
在AUTOMATEDSTORAGEON选项后面，给出了3个文件目录（路径）。这3个路径
CREATE DATABASEMYDBAUTOMATICSTORAGE ON
默认数据库路径
/db2/mydbpath001,/db2/mydbpath002,/db2/mydbpath003
以占用的存储空间，那么可以指定一个最大值。
INITIALSIZE300M：没有定义初始大小的任何表空间的大小默认为300MB。每个
分数。假如为20%，表示会比原来的空间增加20%。
75MB。还可以指定一个百分数，在这种情况下，表空间会增长它的当前大小的百
INCREASESIZE75M（或百分数）：当表空间用光空间时，表空间的总空间增加
容器是100MB（因为有3个存储路径）。
(DETDBPATH)=C:
第3章
创建数据库和表空间
更多资源请访问www.ckook.com
---
## Page 87
建的（ON关键字），除非指定它们的位置。对于每个表空间，DBA可以指定表空间应该使
来使DB2能够以它自身分层的格式存储XML数据和关系数据。
create databasexmldb using codesetUTF-8territoryus
数据。如果数据库在创建时没有启用Unicode支持，就不能在其中创建XML列。
/时间、变长字符串等等。随后，您将在这个数据库中创建对象来管理XML和其他类型的
为Unicode数据库才能同时存储XML文档和SQL数据的更多传统格式，比如整数、日期
果客户端访问数据库服务器代码页不一样，将无法访问。
选择合适的代码页，这些参数在数据库创建好后都不能再进行修改，
用二进制表示来比较所有值。
对数据值进行比较。如果使用选项COLLATEUSINGIDENTITY，那么以逐字节的方式使
字节代码页DBCS)。
韩文等）需要超过256个元素才能表示所有的独特字符，因此需要多字节代码页（通常是双
特字符相当少，因此单字节代码页（SBCS）对于存储数据足够了。东亚国家语言（中文、日文、
字字符（单一字节可以表示256个独特元素），也可以使用多个字节。英语等语言包含的独
中使用CODESET和TERRITORY选项设置的。代码页可以使用单一字节表示一个字母数
进制数据。一个DB2数据库只能使用一个代码页。代码页是在CREATEDATABASE命令
符代码页。可以认为代码页是一个对照表，用来将字母数字数据转换为数据库中存储的二
着自动存储）。在这种情况下，不提供容器定义，因为DB2会自动地分配容器。
行定义。如果指定选项COLLATEUSINGSYSTEM，就根据为数据库指定的TERRITORY
循序渐进DB2—DBA系统管理、运维与应用案例