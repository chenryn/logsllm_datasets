title:New privacy issues in mobile telephony: fix and verification
author:Myrto Arapinis and
Loretta Ilaria Mancini and
Eike Ritter and
Mark Ryan and
Nico Golde and
Kevin Redon and
Ravishankar Borgaonkar
New Privacy Issues in Mobile Telephony:
Fix and Veriﬁcation
Myrto Arapinis, Loretta Mancini,
Eike Ritter, Mark Ryan
University of Birmingham
School of Computer Science
Birmingham, UK
m.d.arapinis, l.mancini, e.ritter,
PI:EMAIL
Nico Golde, Kevin Redon,
Ravishankar Borgaonkar
Technische Universität Berlin and
Deutsche Telekom Laboratories
Berlin, DE
nico, kredon,
PI:EMAIL
ABSTRACT
Mobile telephony equipment is daily carried by billions of
subscribers everywhere they go. Avoiding linkability of sub-
scribers by third parties, and protecting the privacy of those
subscribers is one of the goals of mobile telecommunication
protocols. We use formal methods to model and analyse the
security properties of 3G protocols. We expose two novel
threats to the user privacy in 3G telephony systems, which
make it possible to trace and identify mobile telephony sub-
scribers, and we demonstrate the feasibility of a low cost
implementation of these attacks. We propose ﬁxes to these
privacy issues, which also take into account and solve other
privacy attacks known from the literature. We successfully
prove that our privacy-friendly ﬁxes satisfy the desired un-
linkability and anonymity properties using the automatic
veriﬁcation tool ProVerif.
Categories and Subject Descriptors
D.2.4 [Software Program Veriﬁcation]: Formal Methods
General Terms
Security, Veriﬁcation
Keywords
Unlinkability, Anonymity, ProVerif, Mobile Telephony
1.
INTRODUCTION
While most mobile phone users accept that the network
operator can track their geographical movements, few would
be happy if an arbitrary third party could do so. Such a
possibility would enable all kinds of undesirable behaviour,
ranging from criminal stalking and harassment to more mun-
dane monitoring of spouse or employee movements, as well
as proﬁling for commercial and advertisement purposes. For
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
CCS’12, October 16–18, 2012, Raleigh, North Carolina, USA.
Copyright 2012 ACM 978-1-4503-1651-4/12/10 ...$15.00.
this reason, 3G (Third Generation) mobile phone proto-
cols have been designed to prevent third parties, eavesdrop-
ping on the radio link, from identifying wireless messages as
coming from a particular mobile phone. Therefore, mobile
phones identify themselves, whenever possible, by means of
temporary identiﬁers (TMSIs) instead of using their long
term unique identities (IMSIs). Temporary identities are
periodically updated by the network. To avoid linkability,
the assignment of a new temporary identity is encrypted us-
ing a session key established through the 3G Authentication
and Key Agreement (AKA) protocol.
When 3G protocols were ﬁrst introduced in 1999, ac-
tive attack scenarios were a remote possibility because of
the high cost of the equipment required, the closedness of
the hardware design and the lack of open source imple-
mentations of the protocol stack. This scenario has re-
cently changed. Cheap base stations [19] can be produced by
programming USRP (Universal Software Radio Peripheral)
boards [21]. These lower the cost of producing radio devices
thanks to software emulation of specialized functions once
executed by expensive hardware. The increasing popular-
ity of USRPs led for example to a cheap implementation of
fake base station attacks on GSM (Global System for Mo-
bile Communication) [31], which were considered suﬃciently
costly to prevent wide-scale attacks. Shorter range base sta-
tions, available at aﬀordable prices, have been targeted as
well by open source developers (e.g. openBSC project [33]),
security researchers [23]. Certain old mobile phones based on
the Ti Calypso GSM baseband chips, can be reprogrammed
by ﬂashing an open source version of the protocol stack (de-
veloped by the osmocom-BB project [34]). These new devel-
opments open at the same time the way for the exploration
of new uses of mobile telephony technology [1, 30] and for
the exploitation of its weaknesses [20, 23, 31, 29], making
active attack scenarios an increasingly likely reality.
Hence, we believe active attackers should now be consid-
ered when analysing mobile systems in order to obtain con-
vincing and reliable results on their security. From this per-
spective we present a formal analysis of the 3G subscribers
privacy. We expose two novel threats and we demonstrate
that these threats can lead to real implementations which
make use of cheap equipment. Furthermore, we propose pri-
vacy friendly ﬁxes to thwart the detected privacy issues and
we formally verify that our ﬁxes achieve the desired privacy
goals.
205Our Contributions. Linkability of transactions has been
identiﬁed and often reported by the media as an impor-
tant threat for user privacy [14, 17, 24] though it has been
overlooked so far by most of the existing studies of mobile
telecommunication protocols which instead focus on conﬁ-
dentiality and authentication requirements (Section 2.2). In
this paper, we present the ﬁrst formal analysis of 3G proto-
cols w.r.t. privacy of mobile phone users from third party at-
tackers and in particular w.r.t. unlinkability and anonymity
of 3G subscribers. For our analysis we use automated formal
methods. The use of formal methods allows us to: (i) pre-
cisely and unambiguously deﬁne the desired privacy prop-
erties in terms of third-party strong anonymity and strong
unlinkability; (ii) identify new vulnerabilities with respect
to subscriber privacy thanks to a rigorous speciﬁcation of
the protocols and of the analysed properties.
However, the currently available automated tools are still
quite limited and cannot straightforwardly be used to ver-
ify unlinkability and anonymity properties [11]. Here we de-
velop ways to model the protocols and the desired properties
as biprocesses in order to use the ProVerif tool on our 3G
case study. The automatic veriﬁcation with the ProVerif
tool allows us to: (i) verify strong unlinkability and strong
anonymity. To the best of our knowledge, it is the ﬁrst
time these deﬁnitions of privacy properties have been suc-
cessfully used for veriﬁcation using an automated tool; (ii)
verify that the ﬁxes we propose do preserve the privacy of
the mobile phone users from third parties in terms of un-
linkability and anonymity; (iii) automatically verify privacy
properties expressed as equivalence relations between sys-
tems consisting of an unbounded number of agents execut-
ing an unbounded number of sessions;(iv) obtain a higher
level of conﬁdence in the resulting proofs than the ones pro-
vided by more error-prone manual techniques. With our
method ProVerif successfully detects the privacy vulnera-
bilities (described in Section 3) and also successfully proves
that the ﬁxed protocols (presented in Section 5) satisfy both
unlinkability and anonymity (Section 6).
Moreover, we demonstrate how these vulnerabilities can
lead to practical attacks, by implementing them in real 3G
networks in Germany (Vodafone, O2, T-Mobile) and in France
(SFR) (Section 4).
2. BACKGROUND AND RELATED WORK
Third Generation telecommunications systems (3G) is a
mobile telephony standard speciﬁed and maintained by the
Third Generation Partnership Project (3GPP). It was in-
troduced in 1999, with the birth of UMTS, to oﬀer better
support for mobile data applications, increased data rates
and to lower costs of mobile data communications. Fur-
thermore, 3G oﬀers an improved security architecture with
respect to previous mobile telecommunication systems such
as GSM (Global System for Mobile Communication).
2.1 3G Security Requirements
3G aims to provide authentication, conﬁdentiality of data
and voice communication, as well as user privacy [6]. In par-
ticular, 3G privacy goals include the following [6]:
User identity conﬁdentiality: the property that the per-
manent user identity (IMSI) of a user to whom a service is
delivered cannot be eavesdropped on the radio access link;
User untraceability: the property that an intruder cannot
deduce whether diﬀerent services are delivered to the same
user by eavesdropping on the radio access link.
In order to achieve these two privacy-related properties,
3G (and GSM) relies on the use of temporary identities TM-
SIs (Temporary Mobile Subscriber Identities) for identifying
and paging mobile phones (more precisely mobile stations,
MSs) instead of using their long-term identities IMSIs (In-
ternational Mobile Subscriber Identities). Indeed, the eaves-
dropping of the IMSI in plaintext communications would
allow the identiﬁcation of mobile telephony users by third
parties. Moreover, the 3G standard requires periodic up-
dates of the temporary identity, to avoid the traceability of
a mobile station by third parties. New temporary identi-
ties are periodically assigned by the network through the
TMSI reallocation procedure. The newly assigned TMSI is
encrypted using a session key which is established by exe-
cuting the 3G Authentication and Key Agreement protocol
(AKA). The 3G AKA protocol allows MS and network to
achieve mutual authentication and establish a pair of shared
session keys, namely a ciphering key and an integrity key.
These keys are used to ensure the secrecy and integrity of
the subsequent communications.
2.2 Related Work
Known 3G Vulnerabilities. Three categories of attacks
on mobile telephony systems have been described in the past.
IMSI Catcher. The identiﬁcation procedure, consisting in
the request of the user identity by the network followed by a
cleartext reply containing the user identity, is acknowledged
in the 3G standard as a breach of the user identity conﬁden-
tiality [6, p. 19, s. 6.2]. This procedure is exploited by the
well-known “IMSI catcher” attack, which is the best known
attack to mobile telephony users’ privacy. It consists in forc-
ing a mobile phone to reveal its identity (IMSI) [22, 32] by
triggering the identiﬁcation procedure from a fake opera-
tor base station (conﬁgured with the corresponding mobile
network and country code settings). Until fairly recently,
implementing an IMSI catcher required specialised software
and equipment such as base stations. However, such devices
have become more and more aﬀordable thanks to software
emulation [31]. To the best of our knowledge the only imple-
mentation of a 3G IMSI catcher is the one presented in [23]
and is realised using a modiﬁed femtocell.
3G/GSM-interoperability. Previously proposed attacks on
3G security exploit the vulnerabilities which are propagated
from GSM to 3G when providing interoperability between
the two systems. Most of the reported attacks of this kind
take advantage of well-known weaknesses of the GSM au-
thentication and key agreement protocol, such as the lack
of mutual authentication and the use of weak encryption.
These attacks allow an active attacker to violate the user
identity conﬁdentiality, to eavesdrop on outbound commu-
nications [28] and to masquerade as a legitimate subscriber
obtaining services which will be billed on the victim’s ac-
count [10]. However, these attacks cannot be carried out
on pure 3G networks, which are the scope of our analysis,
because they rely on the lack of mutual authentication in
GSM and on the possibility of downgrading the communi-
cation from 3G to GSM.
3G speciﬁc. To the best of our knowledge, the only attack
that does not rely on GSM/3G interoperability has been pre-
sented by Zhang and Fang in [36]. This attack is a variant of
206the false base station attack and takes advantage of the fact
that the mobile station does not authenticate the serving
network. It allows the redirection of the victim’s outgoing
traﬃc to a diﬀerent network, for example a network which
uses a weaker encryption algorithm or one which charges
higher rates than the victim’s one. Zhang and Fang’s attack
concerns impersonation, service theft and data conﬁdential-
ity, while our work exhibits privacy issues arising in 3G.
Our work is based on the formal analysis of pure 3G proto-
cols. It relies on the study and modelling of the 3G standard
and does not make assumptions about interoperability be-
tween GSM and 3G. We focus on subscriber privacy and
discover further breaches other than the ones caused by the
identiﬁcation procedure and the propagation of GSM weak-
nesses to 3G.
Previous Formal Analysis The 3G AKA protocol in its
pure form (i.e. with no GSM support) has been formally
proved to meet some of the speciﬁed security requirements [3],
such as authentication and conﬁdentiality of data and voice
communication. However, privacy related properties such
as unlinkability and anonymity, which are the focus of our
work, are not analysed in [3]. The framework applied in [3]
cannot be used to specify unlinkability and anonymity prop-
erties, let alone reason about them. The formal framework
used in our paper allows us to precisely deﬁne and verify pri-
vacy related properties. Hence, we can discover privacy at-
tacks on the modelled protocols and propose solutions which
are formally proved to satisfy the desired privacy properties.
Other Work on 3G Privacy Enhancement A new frame-
work for authentication has been proposed to provide sub-
scriber privacy with respect to the network [26]. In particu-
lar, the authors aim to achieve MSs anonymity with respect
to the serving network, and location privacy with respect to
the home network. To achieve this purpose, they propose
a new mechanism for the location update and a three way
handshake protocol, to be used for authentication instead of
the currently used 3G AKA protocol. However, unlike our
work, this work is not supported by a formal model of the
AKA protocol, nor does it provide a formal veriﬁcation of
the properties of the proposed protocols. Moreover, their
attacker model considers the network as not fully trusted,
while we are only concerned about third party attackers con-
trolling the radio link communications.
3. NOVEL PRIVACY THREATS
In this section we describe two breaches of privacy, which
expose a subscriber’s identity and allow an attacker capa-
ble of sending and receiving messages on the air to identify
the presence of a target mobile phone (MS) in a monitored
area, or even track its movements across a set of monitored
areas. As we will see, the attacker does not need to know
any keys, nor perform any cryptographic operation. This
kind of vulnerabilities usually look trivial once uncovered
but often remain unnoticed for long time, since they do not
involve fancy cryptography but are caused by errors in the
protocol logic.
As argued in Section 1 and as witnessed by the attacks
implementation presented in Section 4, a convincing analysis
of 3G privacy and security should consider active attackers
instead of passive ones. For this reason, we assume that the
attacker has unlimited access to the radio link between the
mobile station and the base station. He can sniﬀ, inject,
MS
KIMSI , IMSI , TMSI
Network
KIMSI , IMSI
Pag Req, IMSI
Pag Res, TMSI
Figure 1: 3G IMSI Paging Procedure
replay, and modify messages. This attacker model is the
same considered in most of the previous work on GSM/3G
security [28, 10, 36].