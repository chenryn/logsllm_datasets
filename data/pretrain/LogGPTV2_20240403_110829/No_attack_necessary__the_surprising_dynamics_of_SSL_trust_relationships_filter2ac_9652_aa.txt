title:No attack necessary: the surprising dynamics of SSL trust relationships
author:B. Amann and
Robin Sommer and
Matthias Vallentin and
Seth Hall
The Surprising Dynamics of SSL Trust Relationships
No Attack Necessary:
Bernhard Amann1, Robin Sommer1,3, Matthias Vallentin2, Seth Hall1
1International Computer Science Institute
2UC Berkeley
3Lawrence Berkeley National Laboratory
ABSTRACT
Much of the Internet’s end-to-end security relies on the
SSL/TLS protocol along with its underlying X.509 certiﬁcate
infrastructure. However, the system remains quite brittle due
to its liberal delegation of signing authority: a single com-
promised certiﬁcation authority undermines trust globally.
Several recent high-proﬁle incidents have demonstrated this
shortcoming convincingly. Over time, the security commu-
nity has proposed a number of counter measures to increase
the security of the certiﬁcate ecosystem; many of these eﬀorts
monitor for what they consider tell-tale signs of man-in-the-
middle attacks. In this work we set out to understand to
which degree benign changes to the certiﬁcate ecosystem
share structural properties with attacks, based on a large-
scale data set of more than 17 billion SSL sessions. We ﬁnd
that common intuition falls short in assessing the malicious-
ness of an unknown certiﬁcate, since their typical artifacts
routinely occur in benign contexts as well. We also discuss
what impact our observations have on proposals aiming to
improve the security of the SSL ecosystem.
1.
INTRODUCTION
As a key building block of today’s Internet security, the
Secure Sockets Layer (SSL1) protocol provides secure end-to-
end channels and authentication through its underlying X.509
certiﬁcate infrastructure. In a nutshell, certiﬁcate authori-
ties (CAs) sign server certiﬁcates, which clients then verify
against a list of trusted root CA certiﬁcates shipping with
their operating system or client software. In most cases, root
CAs do not sign server certiﬁcates directly, but instead dele-
gate signing authority to intermediate CAs. When validating
a certiﬁcate, a client attempts to build a valid certiﬁcate
chain from the server certiﬁcate to one of the root certiﬁcates
it knows, including intermediates as necessary. However,
since all root and intermediate CAs share the authority to
1We will refer to either SSL or TLS as “SSL.”
Permission to make digital or hard copies of all or part of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for proﬁt or commercial advantage and that copies
bear this notice and the full citation on the ﬁrst page. To copy otherwise, to
republish, to post on servers or to redistribute to lists, requires prior speciﬁc
permission and/or a fee.
ACSAC ’13 Dec. 9-13, 2013, New Orleans, Louisiana USA
Copyright 2013 ACM 978-1-4503-2015-3/13/12 ...$15.00.
http://dx.doi.org/10.1145/2523649.2523665
sign any certiﬁcate Internet-wide,2 the global trust in the sys-
tem breaks with the weakest link: the compromise of a single
CA undermines the entire X.509 certiﬁcate infrastructure.
Consequently, CAs represent an attractive target for attack-
ers: numerous CA compromises [32] and questionable issuing
practices [24, 31] have demonstrated that adversaries can
obtain rogue certiﬁcates for well-known identities to launch
transparent man-in-the-middle (MITM) attacks where vic-
tims do not see a warning because the injected certiﬁcate
validates correctly.
Over time, the security community has proposed a num-
ber of counter measures to increase the security of the cer-
tiﬁcate ecosystem, including TACK [26], DANE [17], and
pinning extensions for HSTS [12]. None of them have yet
seen widespread adoption, although Chrome’s internal cer-
tiﬁcate pinning has proven eﬀective in speciﬁc scenarios [24].
Many of the existing eﬀorts suggest to monitor for what they
consider tell-tale signs of MITM attacks, notifying the user,
for example, when encountering certiﬁcates not yet seen for
a particular target domain [7], or when a certiﬁcate’s issuer
changes to a CA in a diﬀerent country [36]. We notice, how-
ever, a striking gap in virtually all of these proposals: none
of them systematically analyzes how often corresponding
activity occurs in benign circumstances. Doing so however
constitutes a crucial step in assessing their eﬃcacy since the
setting imposes a classic base-rate fallacy [4]: the probability
that users fall victim to an actual MITM attack remains
extremely low, and hence even small false positive rates will
quickly train them to ignore any security-related warnings.
In this work we set out to understand this eﬀect by pur-
suing a large-scale study of the trust graph induced by the
SSL certiﬁcate infrastructure. We ﬁrst survey known MITM
attacks and analyze the impact of the deployed malicious
certiﬁcates on the global trust relationships. We then exam-
ine a month’s worth of all daily changes to the certiﬁcate
graph for similar patterns. Surprisingly, we ﬁnd that com-
mon intuition falls short in assessing the maliciousness of
an unknown certiﬁcate, since in practice all such artifacts
routinely occur in benign contexts as well. As one example,
for 1.3K of the certiﬁcates that changed in January 2013, the
country of the issuing CA changed. We conclude from our
study that global trust relationships—which involve a large
number of independent actors driven by diﬀerent interests
and incentives—hardly provide a robust basis for detecting
patterns of abuse. Speciﬁcally, our results have concrete
implications for Certiﬁcate Transparency (CT) [22], a recent
2Individual CAs can be technically constrained but this rarely
occurs in practice today (see §3.3).
179
proposal to improve the security of the PKI infrastructure.
The key ingredient for conducting this study constitutes
a comprehensive data set tracking global certiﬁcate changes
over an extensive period of time. For more than a year
now, we have been collecting SSL certiﬁcates (and other
session-level SSL features) from upstream network traﬃc at
currently 8 large-scale institutions on an ongoing basis. As
of mid September 2013, our data set comprises 1.4M unique
certiﬁcates, extracted from about 37 billion SSL sessions of
more than 314K users in total. The collection provides us
with a uniquely broad vantage point for understanding the
global SSL ecosystem.
We structure the remainder of this paper as follows: We
introduce our measurement infrastructure and data set in
§2. After presenting known attacks on the CA ecosystem in
§3, we examine daily changes to the global certiﬁcate system
in §4 in relation to these attacks. We discuss our results
in §5, assessing their impact on diﬀerent ideas and ongoing
eﬀorts that aim to improve the security of the SSL ecosystem,
and suggesting remedies for some of the newfound problems.
After summarizing related work in §6 we conclude in §7.
2. DATA COLLECTION
For more than a year we have been collecting SSL session
and certiﬁcate information from currently 8 research and
university networks, covering activity of approximately 314K
active users in total. In this section we describe our collection
eﬀort as well as the resulting data set in more detail.
2.1 Setup
All our data providers run the open-source system Bro [33,
6] on their gateway links. We we provide them with a custom
Bro analysis script that collects details from each outgoing
SSL connection, including its timestamp, certiﬁcates, TLS
extension information, and more. Every hour, the script
uploads ASCII-formatted log ﬁles to a database located at
our research institute. Due to privacy concerns our script
does not record any information that would identify a client
system directly. All our data collection sites posses the
complete source code of the data collector, and they have
used their internal review processes to approve the speciﬁcs
of the collection.
Our data set exhibits artifacts of the collection process that
are beyond our control. As we leverage operational setups
that run our analysis on top of their normal duties, we must
accept occasional outages, packets drops (e.g., due to CPU
overload) and misconﬁgurations. As such, we deliberately
design our data collection as a “best eﬀort” process: we
take what we get but generally cannot quantify what we
miss. Nonetheless, given the large total volume across the
8 sites, we consider the aggregate as representative of many
properties that real-world SSL activity exhibits, including
the most commonly seen certiﬁcates.
2.2 Data Sets
Table 1 summarizes the data we have collected from each
participating site. Our contributors requested to remain
anonymous. Most of them represent research environments.
Nearly all of them are located in the US (non-US sites include
“X” in their labels). As we added the sites incrementally to
our eﬀort, the individual sets span diﬀerent time periods. For
comparison, we list the total hours observed at each site (non-
continuous due to occasional outages). Two of the sites that
Figure 1: Map view of server IP addresses. Each dot
represents one IP. Color encodes number of connections,
where green means  100, orange > 1, 000,
and red > 10, 000.
originally joined our data collection eﬀort eventually had
to leave because of staﬀ changes. As Table 1 shows, our
data set contains a total of 57.4M certiﬁcates. Of those, over
47 million originate from Grid traﬃc and Tor servers. Due
to the highly dynamic and specialized nature of these two
applications, we exclude them from the further discussion in
this paper. The ﬁltered column in Table 1 shows the number
of remaining certiﬁcates.
To keep the data analysis manageable, we limit our further
discussion to changes in the SSL infrastructure occurring
during January 2013. Out of the 842.7K ﬁltered certiﬁcates
that we had seen in the 17.5B connection observed as of
February 1, 2013, 622K were not expired. Of those, we could
validate 489.6K against the Mozilla root-store. For certiﬁcate
validation, we aim to match the results a typical browser
would give. To this end, we deploy the NSS library, which
Firefox and Chrome use to validate certiﬁcates, and retrieve
missing intermediate CA certiﬁcates using the Authority
Information Access (AIA) X.509v3 extension.
For the remainder of this paper, we only consider certiﬁ-
cates we could validate at the time of the corresponding
SSL connection. The connection counts of Table 1 only in-
clude successfully established SSL connections, ignoring cases
where our monitors reported traﬃc loss. Even though most
of our providers are based in the US, our data exhibits a
geographically diverse perspective of SSL servers: Figure 1
shows a map of the server locations based on IP address.
3. ATTACK SURVEY
In this section we survey known attacks and analyze them
through the lens of our global trust graph in which vertices
correspond to certiﬁcates and edges to globally valid trust
relationships. To set the stage, we begin by brieﬂy summa-
rizing a set of basic properties of the overall graph, and then
proceed to examine the speciﬁcs of recent high-proﬁle attacks
for understanding what facilitated their success.
In our discussion we only consider attacks on CAs per-
taining to the web infrastructure while excluding alternate
trust hierarchies that also deploy SSL (such as Grids). We
neither cover attacks on client/server implementations or
on the SSL protocol itself, as our primary focus concerns
adversaries launching transparent MITM attacks using a
malicious certiﬁcate that validates correctly.
3.1 Trust Graph
Our data collection provides us with a comprehensive set
of certiﬁcates seen “in the wild”, which we use to derive a
180
Site
Certiﬁcates
Connections
Time
Label Type
Est. Users Total
Filtered
Total
Hours
Start (– End)
90,000
250
4,000
50,000
3,000
50,000
30,000
100,000
30,000
10,000
13,046
11,383
12,229
11,092
3,392
7,355
7,790
7,904
3,282
7,426
University
Research site
Research site
University
University
Gov. Network
University
University
Backbone Network 2
University
US1
US2
US3
US4
X1
US5
US6
US7
US8
X2
All 1
1 The total reﬂects the number of unique items across all sites.
2 At the moment only a small fraction of the total backbone traﬃc is examined, representing about 30,000 users.
3 Only counting active sites.
15,029,983,518
203,095,274
1,330,286,118
7,605,351,160
10,591,869
787,579,602
942,039,166
9,067,412,407
636,405,991
1,336,627,826
02/12
02/12
02/12
02/12
03/12 – 09/12
04/12 – 09/13
08/12
08/12
01/13
11/12
54,883,526
643,992
316,190
1,708,874
13,798
186,928
350,928
835,283
33,747
127,104
1,064,786
46,560
150,871
418,689
8,755
171,269
196,482
370,775
32,256
74,227
314,250 3 57,359,391
1,384,255
36,949,381,778 —
—
Table 1: Summary of data set properties from contributing sites.
Root Certiﬁcates
Owners
% Root
Owner
% Roots Owner
Attacked clients' view
World view
Symantec
19% GeoTrust
GoDaddy
18% Go Daddy
Comodo
14% AddTrust
GlobalSign
9.6% GlobalSign
Symantec
8.6% VeriSign(1)
Symantec
6.3% Thawte
4.4% DigiCert
DigiCert
4.1% USERTRUST Comodo
2.8% VeriSign (2)
2.2% Starﬁeld
Symantec
GoDaddy
38%
20%
16%
9.8%
4.5%
2.6 %
1.7%
1.4 %
0.78%
0.47%
14
Symantec
5 GoDaddy
4 Comodo
3 GlobalSign
3 DigiCert
3 Entrust
1
3 Verizon
2 Trustwave
1 DTAG
StartCom
Table 2: Top 10 root-certiﬁcates and owners.
directed graph of global trust relationships. In this trust
graph, nodes represent certiﬁcates of either CAs or end hosts,
and incoming edges indicate the CAs that signed them. The
trust graph changes over time due to certiﬁcate expiration
and addition of new certiﬁcates.
Table 2 lists the diﬀerent root certiﬁcates we encounter,
their owners, and the percentage of the total certiﬁcates that
we can trace back to them. Symantec is by far the largest CA
represented in our data set, having issued 38% of the total
certiﬁcates under a number of diﬀerent CA brands, and using
14 diﬀerent root certiﬁcates. The certiﬁcates in our data are
derived from a total of 84 of the 156 roots included in the
Mozilla root store. In total, we see certiﬁcates issued by 44
diﬀerent organizations. Notably, we see certiﬁcates signed
by government-controlled roots, including Turkey, France,
Spain, Hong Kong, the Netherlands, China, and Denmark
(which owns the Nationalbank).
3.2 Notable Attacks and Incidents
The last few years have witnessed numerous CA attacks
and incidents, each of which involved an adversary attempt-
ing to inject a new certiﬁcate into the global trust graph
such that victims would accept it without facing a warning.
To do so, the attackers employed diﬀerent strategies which
we showcase below.
3.2.1 Türktrust
At the beginning of 2013, T¨urktrust accidentally marked
two certiﬁcates issued to customers as CA certiﬁcates, which
in principle enabled their owners to generate globally valid
signatures for any certiﬁcate Internet-wide. One of the cus-
tomers noticed the nature of the certiﬁcate at a later point in
181
TÜRKTRUST Root
TÜRKTRUST 
Intermediate
*.ego.gov.tr
*.google.com
Equifax Root
Google CA
…bankasi.org
*.google.com
Figure 2: T¨urktrust attack.
time and installed it on a network gateway for intercepting
encrypted traﬃc of local users. Google eventually detected
the attack when Chrome’s certiﬁcate pinning reported an