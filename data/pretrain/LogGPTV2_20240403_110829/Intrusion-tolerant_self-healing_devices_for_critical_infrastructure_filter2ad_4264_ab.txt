217
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
Intrusion-TolerantSelf-HealingDevicesforCriticalInfrastructureProtection∗PauloSousa,AlyssonN.Bessani,WagnerS.Dantas,F´abioSouto,MiguelCorreia,NunoF.NevesUniversityofLisboa,FaculdadedeCiˆencias,LASIGE–Portugal{pjsousa,bessani}@di.fc.ul.pt,{wagners,fsouto}@lasige.di.fc.ul.pt,{mpc,nuno}@di.fc.ul.ptAbstractCriticalinfrastructureslikethepowergridareessen-tiallyphysicalprocessescontrolledbyelectronicdevices.Inthelastdecades,theseelectronicdevicesstartedtobecontrolledremotelythroughcommoditycomputers,oftendi-rectlyorindirectlyconnectedtotheInternet.Therefore,manyofthesesystemsarecurrentlyexposedtothreatssim-ilartothoseenduredbynormalcomputer-basednetworksontheInternet,buttheimpactoffailureoftheformercanbemuchhighertosociety.Thispaperpresentsademonstra-tionofafamilyofprotectiondevicesforcriticalinformationinfrastructuresdevelopedinthecontextoftheEUCRU-TIALproject.Thesedevices,calledCRUTIALInformationSwitches(CIS),enforcesophisticatedaccesscontrolpoli-ciesofincoming/outgoingtrafﬁc,andarethemselvesde-signedwitharangeofdifferentlevelsofintrusion-toleranceandself-healing,toservedifferentresiliencerequirements.1.IntroductionCriticalinfrastructures(CI)likethepowergridarees-sentiallyphysicalprocessescontrolledbyelectronicde-vices.Inrecentdecades,theseelectronicdevicesstartedtobecontrolledremotelywithoff-the-shelfcomputerscon-nectedbycommonnetworktechnologies,oftendirectlyorindirectlyconnectedtotheInternet[6,7,8].Therefore,to-daymanyofthosesystemsthatarecriticaltooursocietyareexposedtoalevelofthreatsimilartootherInternetservices,whichareconstantlyplaguedwithcyber-attacks.Thissitua-tionhasbeenrecognizedbygovernmentsandindustry,whoarepromotingresearch,standardsandguidelinestoaddresstheproblem(e.g.,[11,14]).Althoughthereisconsider-ablereluctanceaboutdisclosinginformationaboutattacksandintrusions,therearealreadynewsaboutsomeincidents[6,12],andmuchspeculationaboutmanyothers.Atleastonetoolspeciﬁcallydesignedtoﬁndvulnerabilitiesintheseinfrastructuresisknowntoexist[4].∗SupportedbytheEUthroughprojectIST-4-027513-STP(CRUTIAL)andtheFCTthroughtheMultiannualandCMU-PortugalProgrammes.InthecontextoftheEU-ISTCRUTIALproject1,were-centlyproposedareferencearchitectureforprotectingcrit-icalinfrastructures[17].Inouropinion,thisproblemhastobesolvedatanarchitecturallevelmainlybecauseitscom-plexityderivesfromthehybridcompositionofseveralin-frastructures[6,7,8]:(1)theoperationalnetwork,usuallycalledSCADAorPCS2,containscomputersandelectronicdevicesthatmonitorandactuateonthephysicalprocesses(e.g.,electricitygeneration,transformationandtransmis-sion);(2)thecorporateintranetcontainstheusualenter-priseservices(email,databases,etc.)andworkstationsofpersonnel,suchasengineerswhoaccesstheSCADA/PCSsystemsthroughad-hocinterconnections;(3)theInternet,throughwhichCIusersgettootherintranets(e.g.,businesspartners,regulators)and/orsimplytotheoutsideworld.TheinterconnectionofthesethreeinfrastructuresleadstoanundesirablelinkbetweentheInternetandtheSCADA/PCSnetworks,facilitatingthepropagationofat-tacksfromanyplaceintheworldtothecontrolsystems.Additionally,webelievethatCIprotectionismorecom-plexthanclassicalnetworksecurityforotherreasons:ﬁrst,CIsfeaturealotoflegacysubsystemsandnon-computer-standardcomponents(controllers,sensors,actuators,etc.),whichweredeployedwhensecuritywasnotamajorcon-cern;second,conventionalsecuritypracticeswhendirectlyappliedtocontroldevicessometimesstandinthewayoftheireffectiveoperation.Thesetwocharacteristicsimplythatweshouldbeverycarefulwhenproposingnewprotec-tionmechanisms,sinceinmostscenariostheyhavetobeimplementedwithoutchangingtheexistingSCADA/PCSsystems,atleastinthemedium-termfuture,andtheycannotinterferewithsystemoperation,speciallyinemergencysituations.TheapproachbeingfollowedinCRUTIALisbasedonsecuringtheinterconnectionsbetweenthedifferentrealmsoftheinfrastructuresusingCRUTIALInformationSwitches(CIS)[17].Inanutshell,CISareprotectiondevicesthat1CriticalUTilityInfrastructurALResilience:http://crutial.cesiricerca.it.2SupervisoryControlandDataAcquisition/ProcessControlSystem.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
218
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
enforcesophisticatedaccesscontrolpoliciesonincom-ing/outgoingtrafﬁc.Ourpointisthatinterferenceandat-tacksstartatthelevelofthemacroscopicdataﬂowsbe-tweentheserealms,soprotectingthesedataﬂowsusingproperaccesscontrolpoliciesisafundamentalsteptowardssecurity.Furthermore,thesepoliciesmustbeenforcedbyhighlydependabledevices,theCIS,whicharedesignedwitharangeofdifferentlevelsofintrusion-toleranceandself-healingtoservedistinctresiliencerequirements.Thepaperdescribesademonstrationofaremotelyman-agedpowergenerationcontrolscenario.Itincludesanum-berofcomputersthatemulatebothapowergenerationin-frastructureandattackscomingfromtheInternet,andsev-eralprototypesoftheCISdesign.Themainobjectivesare:(1)toillustratewhatkindofattackscancompromisecur-rentpowersystemfacilitiesprotectedbytraditionalﬁre-walls;(2)topresentafamilyofmechanismsthatcanbeemployedtomakeprotectiondevicesincrementallymoreresilient;and(3)toshowthataCIScanofferamorecom-pleteandsecuresolutionfortheprotectionofcriticalsys-temsthantraditionalﬁrewalls.2.CRUTIALInformationSwitchesInCRUTIAL,theinterconnectionofrealmsofacriticalinfrastructureismodeledasaWAN-of-LANs[17]–realmscorrespondtoaLAN,andLANsareconnectedbyaWAN.ConnectionsofLANstotheWANaresecuredbydifferentCIS,whichenforceaccesscontrolpoliciesonincomingandoutgoingmessages.ThiscouldsuggestthatCISaresimplyﬁrewalls.Althoughtheyshare,ofcourse,somecommonfeatures,CISareinfactmorethantraditionalﬁrewalls,andthedifferencesarefundamentallytwo:First,althoughCISaredevicesthatareplacedatnet-workboundaries(justlikeﬁrewalls),theyplayaglobalroleofenforcingaccesscontrolpoliciesofmacroscopicdataﬂowsamongrealmsofaCIorinterconnectedinfrastruc-tures.Therefore,policiesarenotexpressedsimplyasasetoflocalrules,butgloballyusinganorganization-basedac-cesscontrolmodel,PolyOrBAC[9],capableofexpressingpoliciesinvolvingseveralorganizations(e.g.,CIsrelatedtotheproduction,transmission,distributionandregulationofthepowergrid).Inthissense,CISarealsomorealiketodistributedﬁrewalls[1]thantotraditionalﬁrewalls,andtoapplication-levelﬁrewallsthantopacket-ﬁlters.Second,thecriticalityoftheinfrastructuresthatweareconsideringrequiresprotectiondevicesmuchmoreresilientthantraditionalﬁrewalls,whichareknowntohavevulnera-bilities[10]3.TogivetheCIdesignersatradeoffwithcost3Forexample,thenumbersofseriousvulnerabilitiesincommercialﬁrewallsthatallowedintrusions,reportedbytheNationalVulnerabilityDatabasefor2005,2006,and2007,wererespectively9,15,and15.Thevulnerabilitiesthatalloweddenialofserviceattacks,whichhaveanim-CISSigned message3IncommingCIS12WgTrafficHUBHUBWCISWFigure1.TheITCISarchitecture.andcomplexity,wehaveproposedafamilyofincreasinglymoreresilientCIS,wherethestrongestdevicesofthefamilyarebothintrusion-tolerantandself-healing.Intherestofthissection,webrieﬂydescribetheCISinstantiations.Moretechnicaldetailsaboutthesedevicescanbefoundat[2,3,13,16].Intrusion-TolerantCISTheintrusion-tolerantCIS(IT-CIS)isreplicatedinasetofcomputersinordertomaskintrusionsinsomeofitscomponents.Moreprecisely,theCISaccesscontrolfunctionalityisreplicatedacross2f+1machinestotolerateuptofmaliciousoraccidentalfaults.Areplicainwhichthereisanintrusionoracrashissaidtobefaulty.AnITCISrepresentationforf=1isshowninFig.1.TheITCISiscomposedbythreereplicas/computersandtwohubs(i.e.,devicesthatbroadcastthetrafﬁctheyreceiveinoneporttotheotherports).Theideaofintrusiontoler-anceisthatifuptof(1inthiscase)ofthereplicasintheﬁgureareattacked,intrudedandentirelycontrolledbytheattacker,theITCISwillstillperformitsservicecorrectly.Forthisapproachtomakesense,replicashavetobediverse,i.e.,theyshouldhaveatleastdifferentoperatingsystemsandsoftware.Thisneedofdiversitylimitsthemaximumnumberofreplicas.Forexample,thenumberofdiverseop-eratingsystemsforPCsandPC-likeserversisreasonablysmall.ForthesakeofsimplicityweexplainhowITCISworksconsideringonlytheincomingmessageﬂows,becauseforoutgoingtrafﬁctheexplanationisidentical.WhenapacketarrivestotheITCIS:1.itisforwardedbythelefthubtothereplicas(step(1)intheﬁgure);2.eachreplicachecksifthepacketsatisﬁesthesecuritypolicyoftheorganization(speciﬁedusingPolyOrBAC);3.iff+1replicasvoteinfavorofacceptingthepacket(step2),thepacketisforwardedbythecurrentleaderreplica(step3),otherwiseitisdiscarded.Thisbasicmechanismraisestwoissues.First,howdowepreventafaultyreplicafromforwardingapacketthatportantimpactonCIssettingsduetotimelinessrequirements,werere-spectively11,8,and21.978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE
219
Authorized licensed use limited to: Tsinghua University. Downloaded on March 20,2021 at 05:36:36 UTC from IEEE Xplore.  Restrictions apply. 
doesnotsatisfythepolicy?Thesolutionisbasedonthefollowingidea:weconsiderthattrafﬁcforwardedbytheCISmustfollowtheIPSec/AHprotocol,andthatthekeyKusedtosignthepacketswithaMACisstoredinasecuresubsystem(genericallycalledawormhole[15])insideeachreplica;awormholeonlyreturnsasignatureforapacketifthereplicashowsthatf+1replicasgavetheirapproval,byprovidingthecorrespondingvotes.ITCISissaidtobeintrusion-tolerantbecauseanyofthereplicascanfail,al-beitonlyuptof,andthesystemstillbehavescorrectly.Onthecontrary,thewormholecannotfailmaliciouslyforthesystemtobehavecorrectly(althoughitcancrash).Moreprecisely,thewormholehastobeconstructedinsuchawaythatitisnotpossiblefortheattackertotamperwiththeoperationofthewormhole(integrity)ordisclosethekeysstoredinsideit(conﬁdentiality).Thisinvolvesacarefulde-signprocess,possiblywithanimplementationinhardware(likeinaTrustedPlatformModule)orusinganhypervisorandvirtualmachines(whichiswhatweuseinthecurrentprototype).Second,howdowedealwithafaultyleaderthatdoesnotforwardapacketthatsatisﬁesthepolicy?Toaddressthisproblem,allreplicasmonitorwhatistransmittedbytheleader(thehubontherighthandsideoftheﬁgurebroad-caststhepacketsbacktoall);whenaleaderisdetectedtobehaveerroneously,anelectionprotocolrunstonominateanewleader.Overall,theextraresilienceoftheITCIScomesfromthefactthatitisimpossibletosubvertcorrectoperationevenifthereareintrusionsinfreplicas.Noticeforexamplethatatraditionalﬁrewallcanbeunderminedwithasingleintru-sion,sotheITCISisfarmoreresilient.Thereis,however,stillathreatagainsttheITCIS:givenenoughtime,anat-tackermaybeabletotakecontrolofmorethanfmachines,andcontroltheprotectionsystem.ThisproblemissolvedbythenextCISdesign.Intrusion-TolerantCISwithProactiveRecoveryTheITCISwithproactiverecovery(ITCIS-PR)worksbasicallyastheITCIS,buthasaself-healingcapability.Thiscapa-bilityisimplementedbyrecovering(orrejuvenating)peri-odicallyeachreplicatoremovetheeffectsofanyintrusionthatmighthaveoccurred.Therecoveryprocedureinvolvesfourtasks:(1)shutdownoftheCISreplica;(2)selectionofacleansystemimageforthereplica;(3)copyingthesys-temimagetothereplicaﬁle-system;(4)bootingthenewsystem.Inordertoensurethetimelinessandcorrectexecu-tionoftheseactions,recoveriesaremanagedbythesecurewormholes,whichenforcecorrectnessoftheprocessevenunderattack.Additionally,theITCIS-PRneedsmorerepli-castoguaranteethatsystemavailabilityispreservedduringtherecoveryofreplicas(atleast2f+k+1,wherekisthemaximumthatcanrecoveratthesametime).Intru-sionsinreplicasaretheresultofthecombinationofattacksandvulnerabilities,sothelattershouldberemovedoratleastmodiﬁedwhenarecoveryisdone.Thisisanissuethatrequiresfurtherresearchbutthatcanbetackledtodayusingmechanismslikememorylayoutrandomization[18].Mostattacksthatallowtheexecutionofarbitrarycodeinthevictimmachinearedoneusingbufferoverﬂowattacksthatrequiresomeknowledgeabouttheorganizationofthememoryofthatmachine(e.g.,oftheanaddressofthelibctowhichtheattackerwantstoforceajump,inthecaseofanarc-injectionattack).Memorylayoutrandomizationmakestheseattacksextremelydifﬁcultbychanginghowthemem-oryisorganized,i.e.,the(virtual)memoryaddresseswheretheapplicationcode,DLLsandotherthird-partysoftwarearestoredwheneverthemachinereboots.ITCIS-PRisperpetually-resilientinthesensethatittol-eratesintrusionsthatmayoccurindeﬁnitelyduringthesys-temlifetime.However,fromthemomentofasuccessfulreplicaintrusionanduntilitstotalrejuvenation,thefaultyreplicacansendmaliciouspacketstotheinsidesystems,tryingtoﬁndandexploitsome(knownorunknown)vul-nerability.NoticethatthesevulnerabilitiesdoexistandthattheyaresimilartovulnerabilitiesinInternetsystems.TheUS-CERTlistsseveralbufferoverﬂows,authenticationproblemsandimpropermessagehandlingvulnerabilitiesinproductsfromseveralcontrolsystemsmanufacturers4.ThisproblemissolvedbythenextCISdesign.Intrusion-TolerantCISwithProactiveandReactiveRe-coveryThisCIS(ITCIS-PRR)issimilartoITCIS-PRbutaddsanotherprotectionlayer.Besidestheperiodicrejuve-nationofreplicas,eachreplicamonitorsthebehaviorofallothers(forexample,bylookingatthevotingdecisionsandthepacketsforwardedbytheleader).Ifasetofreplicasdis-coverthatanotheroneismisbehaving,theyforcetherecov-eryofthisreplicawiththeassistanceofthesecureworm-hole[13].Thiswormholeprovidesaservicethatschedulesbothtypesofrecoveries(periodicandduetofaultdetec-tions)inordertomaintaintheavailabilityoftheCIS.Itusesaprivatenetworktoexchangeinformationandsupportco-ordinatedactions.CISPerformanceandResilienceAbovewedescribedthedifferencesandbeneﬁtsthateachCISinstantiationbrings.However,wewanttoquantifythesebeneﬁtsintermsofpercentageoffailedtimeofeachoftheseinstances(andatraditionalﬁrewall)inunattendedmissions.Thisas-sessmentwasmadeusingtheMobiustoolandasummaryisthefollowing[16].Weconsiderthatthemissiontimeis10,000hours(approximately1year)andwevariedhosts’minimuminter-failuretime(mift)from1to1000hours.For4Seehttp://www.us-cert.gov/controlsystems/csdocuments.html#vuls978-1-4244-4421-2/09/$25.00 c(cid:13)2009 IEEE